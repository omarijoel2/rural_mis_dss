var y4=e=>{throw TypeError(e)};var TC=(e,t,n)=>t.has(e)||y4("Cannot "+n);var Ze=(e,t,n)=>(TC(e,t,"read from private field"),n?n.call(e):t.get(e)),Vr=(e,t,n)=>t.has(e)?y4("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),gr=(e,t,n,s)=>(TC(e,t,"write to private field"),s?s.call(e,n):t.set(e,n),n),pn=(e,t,n)=>(TC(e,t,"access private method"),n);var ww=(e,t,n,s)=>({set _(i){gr(e,t,i,n)},get _(){return Ze(e,t,s)}});function W6(e,t){for(var n=0;n<t.length;n++){const s=t[n];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in e)){const c=Object.getOwnPropertyDescriptor(s,i);c&&Object.defineProperty(e,i,c.get?c:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function n(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(i){if(i.ep)return;i.ep=!0;const c=n(i);fetch(i.href,c)}})();var I_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var G6={exports:{}},LN={},K6={exports:{}},wn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cb=Symbol.for("react.element"),SX=Symbol.for("react.portal"),NX=Symbol.for("react.fragment"),PX=Symbol.for("react.strict_mode"),CX=Symbol.for("react.profiler"),AX=Symbol.for("react.provider"),kX=Symbol.for("react.context"),TX=Symbol.for("react.forward_ref"),EX=Symbol.for("react.suspense"),MX=Symbol.for("react.memo"),OX=Symbol.for("react.lazy"),v4=Symbol.iterator;function IX(e){return e===null||typeof e!="object"?null:(e=v4&&e[v4]||e["@@iterator"],typeof e=="function"?e:null)}var H6={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Z6=Object.assign,Y6={};function fy(e,t,n){this.props=e,this.context=t,this.refs=Y6,this.updater=n||H6}fy.prototype.isReactComponent={};fy.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};fy.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function X6(){}X6.prototype=fy.prototype;function AM(e,t,n){this.props=e,this.context=t,this.refs=Y6,this.updater=n||H6}var kM=AM.prototype=new X6;kM.constructor=AM;Z6(kM,fy.prototype);kM.isPureReactComponent=!0;var _4=Array.isArray,Q6=Object.prototype.hasOwnProperty,TM={current:null},J6={key:!0,ref:!0,__self:!0,__source:!0};function eB(e,t,n){var s,i={},c=null,u=null;if(t!=null)for(s in t.ref!==void 0&&(u=t.ref),t.key!==void 0&&(c=""+t.key),t)Q6.call(t,s)&&!J6.hasOwnProperty(s)&&(i[s]=t[s]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var m=Array(a),p=0;p<a;p++)m[p]=arguments[p+2];i.children=m}if(e&&e.defaultProps)for(s in a=e.defaultProps,a)i[s]===void 0&&(i[s]=a[s]);return{$$typeof:Cb,type:e,key:c,ref:u,props:i,_owner:TM.current}}function DX(e,t){return{$$typeof:Cb,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function EM(e){return typeof e=="object"&&e!==null&&e.$$typeof===Cb}function RX(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var b4=/\/+/g;function EC(e,t){return typeof e=="object"&&e!==null&&e.key!=null?RX(""+e.key):t.toString(36)}function p1(e,t,n,s,i){var c=typeof e;(c==="undefined"||c==="boolean")&&(e=null);var u=!1;if(e===null)u=!0;else switch(c){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case Cb:case SX:u=!0}}if(u)return u=e,i=i(u),e=s===""?"."+EC(u,0):s,_4(i)?(n="",e!=null&&(n=e.replace(b4,"$&/")+"/"),p1(i,t,n,"",function(p){return p})):i!=null&&(EM(i)&&(i=DX(i,n+(!i.key||u&&u.key===i.key?"":(""+i.key).replace(b4,"$&/")+"/")+e)),t.push(i)),1;if(u=0,s=s===""?".":s+":",_4(e))for(var a=0;a<e.length;a++){c=e[a];var m=s+EC(c,a);u+=p1(c,t,n,m,i)}else if(m=IX(e),typeof m=="function")for(e=m.call(e),a=0;!(c=e.next()).done;)c=c.value,m=s+EC(c,a++),u+=p1(c,t,n,m,i);else if(c==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function Sw(e,t,n){if(e==null)return e;var s=[],i=0;return p1(e,s,"","",function(c){return t.call(n,c,i++)}),s}function LX(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var to={current:null},g1={transition:null},FX={ReactCurrentDispatcher:to,ReactCurrentBatchConfig:g1,ReactCurrentOwner:TM};function tB(){throw Error("act(...) is not supported in production builds of React.")}wn.Children={map:Sw,forEach:function(e,t,n){Sw(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Sw(e,function(){t++}),t},toArray:function(e){return Sw(e,function(t){return t})||[]},only:function(e){if(!EM(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};wn.Component=fy;wn.Fragment=NX;wn.Profiler=CX;wn.PureComponent=AM;wn.StrictMode=PX;wn.Suspense=EX;wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FX;wn.act=tB;wn.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=Z6({},e.props),i=e.key,c=e.ref,u=e._owner;if(t!=null){if(t.ref!==void 0&&(c=t.ref,u=TM.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(m in t)Q6.call(t,m)&&!J6.hasOwnProperty(m)&&(s[m]=t[m]===void 0&&a!==void 0?a[m]:t[m])}var m=arguments.length-2;if(m===1)s.children=n;else if(1<m){a=Array(m);for(var p=0;p<m;p++)a[p]=arguments[p+2];s.children=a}return{$$typeof:Cb,type:e.type,key:i,ref:c,props:s,_owner:u}};wn.createContext=function(e){return e={$$typeof:kX,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:AX,_context:e},e.Consumer=e};wn.createElement=eB;wn.createFactory=function(e){var t=eB.bind(null,e);return t.type=e,t};wn.createRef=function(){return{current:null}};wn.forwardRef=function(e){return{$$typeof:TX,render:e}};wn.isValidElement=EM;wn.lazy=function(e){return{$$typeof:OX,_payload:{_status:-1,_result:e},_init:LX}};wn.memo=function(e,t){return{$$typeof:MX,type:e,compare:t===void 0?null:t}};wn.startTransition=function(e){var t=g1.transition;g1.transition={};try{e()}finally{g1.transition=t}};wn.unstable_act=tB;wn.useCallback=function(e,t){return to.current.useCallback(e,t)};wn.useContext=function(e){return to.current.useContext(e)};wn.useDebugValue=function(){};wn.useDeferredValue=function(e){return to.current.useDeferredValue(e)};wn.useEffect=function(e,t){return to.current.useEffect(e,t)};wn.useId=function(){return to.current.useId()};wn.useImperativeHandle=function(e,t,n){return to.current.useImperativeHandle(e,t,n)};wn.useInsertionEffect=function(e,t){return to.current.useInsertionEffect(e,t)};wn.useLayoutEffect=function(e,t){return to.current.useLayoutEffect(e,t)};wn.useMemo=function(e,t){return to.current.useMemo(e,t)};wn.useReducer=function(e,t,n){return to.current.useReducer(e,t,n)};wn.useRef=function(e){return to.current.useRef(e)};wn.useState=function(e){return to.current.useState(e)};wn.useSyncExternalStore=function(e,t,n){return to.current.useSyncExternalStore(e,t,n)};wn.useTransition=function(){return to.current.useTransition()};wn.version="18.3.1";K6.exports=wn;var R=K6.exports;const de=Fn(R),rB=W6({__proto__:null,default:de},[R]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zX=R,$X=Symbol.for("react.element"),BX=Symbol.for("react.fragment"),qX=Object.prototype.hasOwnProperty,VX=zX.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,UX={key:!0,ref:!0,__self:!0,__source:!0};function nB(e,t,n){var s,i={},c=null,u=null;n!==void 0&&(c=""+n),t.key!==void 0&&(c=""+t.key),t.ref!==void 0&&(u=t.ref);for(s in t)qX.call(t,s)&&!UX.hasOwnProperty(s)&&(i[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)i[s]===void 0&&(i[s]=t[s]);return{$$typeof:$X,type:e,key:c,ref:u,props:i,_owner:VX.current}}LN.Fragment=BX;LN.jsx=nB;LN.jsxs=nB;G6.exports=LN;var r=G6.exports,sB={exports:{}},el={},iB={exports:{}},aB={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Ce,_e){var tt=Ce.length;Ce.push(_e);e:for(;0<tt;){var vt=tt-1>>>1,gt=Ce[vt];if(0<i(gt,_e))Ce[vt]=_e,Ce[tt]=gt,tt=vt;else break e}}function n(Ce){return Ce.length===0?null:Ce[0]}function s(Ce){if(Ce.length===0)return null;var _e=Ce[0],tt=Ce.pop();if(tt!==_e){Ce[0]=tt;e:for(var vt=0,gt=Ce.length,Tt=gt>>>1;vt<Tt;){var Ht=2*(vt+1)-1,Ir=Ce[Ht],Pr=Ht+1,Mt=Ce[Pr];if(0>i(Ir,tt))Pr<gt&&0>i(Mt,Ir)?(Ce[vt]=Mt,Ce[Pr]=tt,vt=Pr):(Ce[vt]=Ir,Ce[Ht]=tt,vt=Ht);else if(Pr<gt&&0>i(Mt,tt))Ce[vt]=Mt,Ce[Pr]=tt,vt=Pr;else break e}}return _e}function i(Ce,_e){var tt=Ce.sortIndex-_e.sortIndex;return tt!==0?tt:Ce.id-_e.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var u=Date,a=u.now();e.unstable_now=function(){return u.now()-a}}var m=[],p=[],y=1,v=null,j=3,S=!1,k=!1,N=!1,D=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(Ce){for(var _e=n(p);_e!==null;){if(_e.callback===null)s(p);else if(_e.startTime<=Ce)s(p),_e.sortIndex=_e.expirationTime,t(m,_e);else break;_e=n(p)}}function z(Ce){if(N=!1,I(Ce),!k)if(n(m)!==null)k=!0,Ve($);else{var _e=n(p);_e!==null&&et(z,_e.startTime-Ce)}}function $(Ce,_e){k=!1,N&&(N=!1,O(te),te=-1),S=!0;var tt=j;try{for(I(_e),v=n(m);v!==null&&(!(v.expirationTime>_e)||Ce&&!ae());){var vt=v.callback;if(typeof vt=="function"){v.callback=null,j=v.priorityLevel;var gt=vt(v.expirationTime<=_e);_e=e.unstable_now(),typeof gt=="function"?v.callback=gt:v===n(m)&&s(m),I(_e)}else s(m);v=n(m)}if(v!==null)var Tt=!0;else{var Ht=n(p);Ht!==null&&et(z,Ht.startTime-_e),Tt=!1}return Tt}finally{v=null,j=tt,S=!1}}var V=!1,K=null,te=-1,X=5,ve=-1;function ae(){return!(e.unstable_now()-ve<X)}function pe(){if(K!==null){var Ce=e.unstable_now();ve=Ce;var _e=!0;try{_e=K(!0,Ce)}finally{_e?Oe():(V=!1,K=null)}}else V=!1}var Oe;if(typeof T=="function")Oe=function(){T(pe)};else if(typeof MessageChannel<"u"){var Me=new MessageChannel,Xe=Me.port2;Me.port1.onmessage=pe,Oe=function(){Xe.postMessage(null)}}else Oe=function(){D(pe,0)};function Ve(Ce){K=Ce,V||(V=!0,Oe())}function et(Ce,_e){te=D(function(){Ce(e.unstable_now())},_e)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ce){Ce.callback=null},e.unstable_continueExecution=function(){k||S||(k=!0,Ve($))},e.unstable_forceFrameRate=function(Ce){0>Ce||125<Ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<Ce?Math.floor(1e3/Ce):5},e.unstable_getCurrentPriorityLevel=function(){return j},e.unstable_getFirstCallbackNode=function(){return n(m)},e.unstable_next=function(Ce){switch(j){case 1:case 2:case 3:var _e=3;break;default:_e=j}var tt=j;j=_e;try{return Ce()}finally{j=tt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Ce,_e){switch(Ce){case 1:case 2:case 3:case 4:case 5:break;default:Ce=3}var tt=j;j=Ce;try{return _e()}finally{j=tt}},e.unstable_scheduleCallback=function(Ce,_e,tt){var vt=e.unstable_now();switch(typeof tt=="object"&&tt!==null?(tt=tt.delay,tt=typeof tt=="number"&&0<tt?vt+tt:vt):tt=vt,Ce){case 1:var gt=-1;break;case 2:gt=250;break;case 5:gt=1073741823;break;case 4:gt=1e4;break;default:gt=5e3}return gt=tt+gt,Ce={id:y++,callback:_e,priorityLevel:Ce,startTime:tt,expirationTime:gt,sortIndex:-1},tt>vt?(Ce.sortIndex=tt,t(p,Ce),n(m)===null&&Ce===n(p)&&(N?(O(te),te=-1):N=!0,et(z,tt-vt))):(Ce.sortIndex=gt,t(m,Ce),k||S||(k=!0,Ve($))),Ce},e.unstable_shouldYield=ae,e.unstable_wrapCallback=function(Ce){var _e=j;return function(){var tt=j;j=_e;try{return Ce.apply(this,arguments)}finally{j=tt}}}})(aB);iB.exports=aB;var WX=iB.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GX=R,Qo=WX;function qt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var oB=new Set,o0={};function Ym(e,t){gx(e,t),gx(e+"Capture",t)}function gx(e,t){for(o0[e]=t,e=0;e<t.length;e++)oB.add(t[e])}var nd=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ok=Object.prototype.hasOwnProperty,KX=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,j4={},w4={};function HX(e){return ok.call(w4,e)?!0:ok.call(j4,e)?!1:KX.test(e)?w4[e]=!0:(j4[e]=!0,!1)}function ZX(e,t,n,s){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function YX(e,t,n,s){if(t===null||typeof t>"u"||ZX(e,t,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ro(e,t,n,s,i,c,u){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=c,this.removeEmptyString=u}var _a={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){_a[e]=new ro(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];_a[t]=new ro(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){_a[e]=new ro(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){_a[e]=new ro(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){_a[e]=new ro(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){_a[e]=new ro(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){_a[e]=new ro(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){_a[e]=new ro(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){_a[e]=new ro(e,5,!1,e.toLowerCase(),null,!1,!1)});var MM=/[\-:]([a-z])/g;function OM(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(MM,OM);_a[t]=new ro(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(MM,OM);_a[t]=new ro(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(MM,OM);_a[t]=new ro(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){_a[e]=new ro(e,1,!1,e.toLowerCase(),null,!1,!1)});_a.xlinkHref=new ro("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){_a[e]=new ro(e,1,!1,e.toLowerCase(),null,!0,!0)});function IM(e,t,n,s){var i=_a.hasOwnProperty(t)?_a[t]:null;(i!==null?i.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(YX(t,n,i,s)&&(n=null),s||i===null?HX(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,s=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}var gd=GX.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Nw=Symbol.for("react.element"),wg=Symbol.for("react.portal"),Sg=Symbol.for("react.fragment"),DM=Symbol.for("react.strict_mode"),lk=Symbol.for("react.profiler"),lB=Symbol.for("react.provider"),cB=Symbol.for("react.context"),RM=Symbol.for("react.forward_ref"),ck=Symbol.for("react.suspense"),uk=Symbol.for("react.suspense_list"),LM=Symbol.for("react.memo"),ch=Symbol.for("react.lazy"),uB=Symbol.for("react.offscreen"),S4=Symbol.iterator;function o_(e){return e===null||typeof e!="object"?null:(e=S4&&e[S4]||e["@@iterator"],typeof e=="function"?e:null)}var Js=Object.assign,MC;function D_(e){if(MC===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);MC=t&&t[1]||""}return`
`+MC+e}var OC=!1;function IC(e,t){if(!e||OC)return"";OC=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(p){var s=p}Reflect.construct(e,[],t)}else{try{t.call()}catch(p){s=p}e.call(t.prototype)}else{try{throw Error()}catch(p){s=p}e()}}catch(p){if(p&&s&&typeof p.stack=="string"){for(var i=p.stack.split(`
`),c=s.stack.split(`
`),u=i.length-1,a=c.length-1;1<=u&&0<=a&&i[u]!==c[a];)a--;for(;1<=u&&0<=a;u--,a--)if(i[u]!==c[a]){if(u!==1||a!==1)do if(u--,a--,0>a||i[u]!==c[a]){var m=`
`+i[u].replace(" at new "," at ");return e.displayName&&m.includes("<anonymous>")&&(m=m.replace("<anonymous>",e.displayName)),m}while(1<=u&&0<=a);break}}}finally{OC=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?D_(e):""}function XX(e){switch(e.tag){case 5:return D_(e.type);case 16:return D_("Lazy");case 13:return D_("Suspense");case 19:return D_("SuspenseList");case 0:case 2:case 15:return e=IC(e.type,!1),e;case 11:return e=IC(e.type.render,!1),e;case 1:return e=IC(e.type,!0),e;default:return""}}function dk(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Sg:return"Fragment";case wg:return"Portal";case lk:return"Profiler";case DM:return"StrictMode";case ck:return"Suspense";case uk:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case cB:return(e.displayName||"Context")+".Consumer";case lB:return(e._context.displayName||"Context")+".Provider";case RM:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case LM:return t=e.displayName||null,t!==null?t:dk(e.type)||"Memo";case ch:t=e._payload,e=e._init;try{return dk(e(t))}catch{}}return null}function QX(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return dk(t);case 8:return t===DM?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Uh(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function dB(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function JX(e){var t=dB(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,c=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(u){s=""+u,c.call(this,u)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(u){s=""+u},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Pw(e){e._valueTracker||(e._valueTracker=JX(e))}function hB(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=dB(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function I1(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function hk(e,t){var n=t.checked;return Js({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function N4(e,t){var n=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;n=Uh(t.value!=null?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function fB(e,t){t=t.checked,t!=null&&IM(e,"checked",t,!1)}function fk(e,t){fB(e,t);var n=Uh(t.value),s=t.type;if(n!=null)s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?mk(e,t.type,n):t.hasOwnProperty("defaultValue")&&mk(e,t.type,Uh(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function P4(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function mk(e,t,n){(t!=="number"||I1(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var R_=Array.isArray;function Bg(e,t,n,s){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&s&&(e[n].defaultSelected=!0)}else{for(n=""+Uh(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,s&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function pk(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(qt(91));return Js({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function C4(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(qt(92));if(R_(n)){if(1<n.length)throw Error(qt(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Uh(n)}}function mB(e,t){var n=Uh(t.value),s=Uh(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),s!=null&&(e.defaultValue=""+s)}function A4(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function pB(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gk(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?pB(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Cw,gB=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,s,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,s,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Cw=Cw||document.createElement("div"),Cw.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Cw.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function l0(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var W_={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},eQ=["Webkit","ms","Moz","O"];Object.keys(W_).forEach(function(e){eQ.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),W_[t]=W_[e]})});function xB(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||W_.hasOwnProperty(e)&&W_[e]?(""+t).trim():t+"px"}function yB(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var s=n.indexOf("--")===0,i=xB(n,t[n],s);n==="float"&&(n="cssFloat"),s?e.setProperty(n,i):e[n]=i}}var tQ=Js({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xk(e,t){if(t){if(tQ[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(qt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(qt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(qt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(qt(62))}}function yk(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vk=null;function FM(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var _k=null,qg=null,Vg=null;function k4(e){if(e=Tb(e)){if(typeof _k!="function")throw Error(qt(280));var t=e.stateNode;t&&(t=qN(t),_k(e.stateNode,e.type,t))}}function vB(e){qg?Vg?Vg.push(e):Vg=[e]:qg=e}function _B(){if(qg){var e=qg,t=Vg;if(Vg=qg=null,k4(e),t)for(e=0;e<t.length;e++)k4(t[e])}}function bB(e,t){return e(t)}function jB(){}var DC=!1;function wB(e,t,n){if(DC)return e(t,n);DC=!0;try{return bB(e,t,n)}finally{DC=!1,(qg!==null||Vg!==null)&&(jB(),_B())}}function c0(e,t){var n=e.stateNode;if(n===null)return null;var s=qN(n);if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(qt(231,t,typeof n));return n}var bk=!1;if(nd)try{var l_={};Object.defineProperty(l_,"passive",{get:function(){bk=!0}}),window.addEventListener("test",l_,l_),window.removeEventListener("test",l_,l_)}catch{bk=!1}function rQ(e,t,n,s,i,c,u,a,m){var p=Array.prototype.slice.call(arguments,3);try{t.apply(n,p)}catch(y){this.onError(y)}}var G_=!1,D1=null,R1=!1,jk=null,nQ={onError:function(e){G_=!0,D1=e}};function sQ(e,t,n,s,i,c,u,a,m){G_=!1,D1=null,rQ.apply(nQ,arguments)}function iQ(e,t,n,s,i,c,u,a,m){if(sQ.apply(this,arguments),G_){if(G_){var p=D1;G_=!1,D1=null}else throw Error(qt(198));R1||(R1=!0,jk=p)}}function Xm(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function SB(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function T4(e){if(Xm(e)!==e)throw Error(qt(188))}function aQ(e){var t=e.alternate;if(!t){if(t=Xm(e),t===null)throw Error(qt(188));return t!==e?null:e}for(var n=e,s=t;;){var i=n.return;if(i===null)break;var c=i.alternate;if(c===null){if(s=i.return,s!==null){n=s;continue}break}if(i.child===c.child){for(c=i.child;c;){if(c===n)return T4(i),e;if(c===s)return T4(i),t;c=c.sibling}throw Error(qt(188))}if(n.return!==s.return)n=i,s=c;else{for(var u=!1,a=i.child;a;){if(a===n){u=!0,n=i,s=c;break}if(a===s){u=!0,s=i,n=c;break}a=a.sibling}if(!u){for(a=c.child;a;){if(a===n){u=!0,n=c,s=i;break}if(a===s){u=!0,s=c,n=i;break}a=a.sibling}if(!u)throw Error(qt(189))}}if(n.alternate!==s)throw Error(qt(190))}if(n.tag!==3)throw Error(qt(188));return n.stateNode.current===n?e:t}function NB(e){return e=aQ(e),e!==null?PB(e):null}function PB(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=PB(e);if(t!==null)return t;e=e.sibling}return null}var CB=Qo.unstable_scheduleCallback,E4=Qo.unstable_cancelCallback,oQ=Qo.unstable_shouldYield,lQ=Qo.unstable_requestPaint,mi=Qo.unstable_now,cQ=Qo.unstable_getCurrentPriorityLevel,zM=Qo.unstable_ImmediatePriority,AB=Qo.unstable_UserBlockingPriority,L1=Qo.unstable_NormalPriority,uQ=Qo.unstable_LowPriority,kB=Qo.unstable_IdlePriority,FN=null,Uc=null;function dQ(e){if(Uc&&typeof Uc.onCommitFiberRoot=="function")try{Uc.onCommitFiberRoot(FN,e,void 0,(e.current.flags&128)===128)}catch{}}var hc=Math.clz32?Math.clz32:mQ,hQ=Math.log,fQ=Math.LN2;function mQ(e){return e>>>=0,e===0?32:31-(hQ(e)/fQ|0)|0}var Aw=64,kw=4194304;function L_(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function F1(e,t){var n=e.pendingLanes;if(n===0)return 0;var s=0,i=e.suspendedLanes,c=e.pingedLanes,u=n&268435455;if(u!==0){var a=u&~i;a!==0?s=L_(a):(c&=u,c!==0&&(s=L_(c)))}else u=n&~i,u!==0?s=L_(u):c!==0&&(s=L_(c));if(s===0)return 0;if(t!==0&&t!==s&&!(t&i)&&(i=s&-s,c=t&-t,i>=c||i===16&&(c&4194240)!==0))return t;if(s&4&&(s|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)n=31-hc(t),i=1<<n,s|=e[n],t&=~i;return s}function pQ(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gQ(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,i=e.expirationTimes,c=e.pendingLanes;0<c;){var u=31-hc(c),a=1<<u,m=i[u];m===-1?(!(a&n)||a&s)&&(i[u]=pQ(a,t)):m<=t&&(e.expiredLanes|=a),c&=~a}}function wk(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function TB(){var e=Aw;return Aw<<=1,!(Aw&4194240)&&(Aw=64),e}function RC(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ab(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-hc(t),e[t]=n}function xQ(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-hc(n),c=1<<i;t[i]=0,s[i]=-1,e[i]=-1,n&=~c}}function $M(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-hc(n),i=1<<s;i&t|e[s]&t&&(e[s]|=t),n&=~i}}var Yn=0;function EB(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var MB,BM,OB,IB,DB,Sk=!1,Tw=[],Mh=null,Oh=null,Ih=null,u0=new Map,d0=new Map,fh=[],yQ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function M4(e,t){switch(e){case"focusin":case"focusout":Mh=null;break;case"dragenter":case"dragleave":Oh=null;break;case"mouseover":case"mouseout":Ih=null;break;case"pointerover":case"pointerout":u0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":d0.delete(t.pointerId)}}function c_(e,t,n,s,i,c){return e===null||e.nativeEvent!==c?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:c,targetContainers:[i]},t!==null&&(t=Tb(t),t!==null&&BM(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function vQ(e,t,n,s,i){switch(t){case"focusin":return Mh=c_(Mh,e,t,n,s,i),!0;case"dragenter":return Oh=c_(Oh,e,t,n,s,i),!0;case"mouseover":return Ih=c_(Ih,e,t,n,s,i),!0;case"pointerover":var c=i.pointerId;return u0.set(c,c_(u0.get(c)||null,e,t,n,s,i)),!0;case"gotpointercapture":return c=i.pointerId,d0.set(c,c_(d0.get(c)||null,e,t,n,s,i)),!0}return!1}function RB(e){var t=cm(e.target);if(t!==null){var n=Xm(t);if(n!==null){if(t=n.tag,t===13){if(t=SB(n),t!==null){e.blockedOn=t,DB(e.priority,function(){OB(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function x1(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Nk(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);vk=s,n.target.dispatchEvent(s),vk=null}else return t=Tb(n),t!==null&&BM(t),e.blockedOn=n,!1;t.shift()}return!0}function O4(e,t,n){x1(e)&&n.delete(t)}function _Q(){Sk=!1,Mh!==null&&x1(Mh)&&(Mh=null),Oh!==null&&x1(Oh)&&(Oh=null),Ih!==null&&x1(Ih)&&(Ih=null),u0.forEach(O4),d0.forEach(O4)}function u_(e,t){e.blockedOn===t&&(e.blockedOn=null,Sk||(Sk=!0,Qo.unstable_scheduleCallback(Qo.unstable_NormalPriority,_Q)))}function h0(e){function t(i){return u_(i,e)}if(0<Tw.length){u_(Tw[0],e);for(var n=1;n<Tw.length;n++){var s=Tw[n];s.blockedOn===e&&(s.blockedOn=null)}}for(Mh!==null&&u_(Mh,e),Oh!==null&&u_(Oh,e),Ih!==null&&u_(Ih,e),u0.forEach(t),d0.forEach(t),n=0;n<fh.length;n++)s=fh[n],s.blockedOn===e&&(s.blockedOn=null);for(;0<fh.length&&(n=fh[0],n.blockedOn===null);)RB(n),n.blockedOn===null&&fh.shift()}var Ug=gd.ReactCurrentBatchConfig,z1=!0;function bQ(e,t,n,s){var i=Yn,c=Ug.transition;Ug.transition=null;try{Yn=1,qM(e,t,n,s)}finally{Yn=i,Ug.transition=c}}function jQ(e,t,n,s){var i=Yn,c=Ug.transition;Ug.transition=null;try{Yn=4,qM(e,t,n,s)}finally{Yn=i,Ug.transition=c}}function qM(e,t,n,s){if(z1){var i=Nk(e,t,n,s);if(i===null)GC(e,t,s,$1,n),M4(e,s);else if(vQ(i,e,t,n,s))s.stopPropagation();else if(M4(e,s),t&4&&-1<yQ.indexOf(e)){for(;i!==null;){var c=Tb(i);if(c!==null&&MB(c),c=Nk(e,t,n,s),c===null&&GC(e,t,s,$1,n),c===i)break;i=c}i!==null&&s.stopPropagation()}else GC(e,t,s,null,n)}}var $1=null;function Nk(e,t,n,s){if($1=null,e=FM(s),e=cm(e),e!==null)if(t=Xm(e),t===null)e=null;else if(n=t.tag,n===13){if(e=SB(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return $1=e,null}function LB(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cQ()){case zM:return 1;case AB:return 4;case L1:case uQ:return 16;case kB:return 536870912;default:return 16}default:return 16}}var Ph=null,VM=null,y1=null;function FB(){if(y1)return y1;var e,t=VM,n=t.length,s,i="value"in Ph?Ph.value:Ph.textContent,c=i.length;for(e=0;e<n&&t[e]===i[e];e++);var u=n-e;for(s=1;s<=u&&t[n-s]===i[c-s];s++);return y1=i.slice(e,1<s?1-s:void 0)}function v1(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ew(){return!0}function I4(){return!1}function tl(e){function t(n,s,i,c,u){this._reactName=n,this._targetInst=i,this.type=s,this.nativeEvent=c,this.target=u,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(c):c[a]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?Ew:I4,this.isPropagationStopped=I4,this}return Js(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ew)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ew)},persist:function(){},isPersistent:Ew}),t}var my={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},UM=tl(my),kb=Js({},my,{view:0,detail:0}),wQ=tl(kb),LC,FC,d_,zN=Js({},kb,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:WM,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==d_&&(d_&&e.type==="mousemove"?(LC=e.screenX-d_.screenX,FC=e.screenY-d_.screenY):FC=LC=0,d_=e),LC)},movementY:function(e){return"movementY"in e?e.movementY:FC}}),D4=tl(zN),SQ=Js({},zN,{dataTransfer:0}),NQ=tl(SQ),PQ=Js({},kb,{relatedTarget:0}),zC=tl(PQ),CQ=Js({},my,{animationName:0,elapsedTime:0,pseudoElement:0}),AQ=tl(CQ),kQ=Js({},my,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),TQ=tl(kQ),EQ=Js({},my,{data:0}),R4=tl(EQ),MQ={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},OQ={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},IQ={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function DQ(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=IQ[e])?!!t[e]:!1}function WM(){return DQ}var RQ=Js({},kb,{key:function(e){if(e.key){var t=MQ[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=v1(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?OQ[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:WM,charCode:function(e){return e.type==="keypress"?v1(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?v1(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),LQ=tl(RQ),FQ=Js({},zN,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),L4=tl(FQ),zQ=Js({},kb,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:WM}),$Q=tl(zQ),BQ=Js({},my,{propertyName:0,elapsedTime:0,pseudoElement:0}),qQ=tl(BQ),VQ=Js({},zN,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),UQ=tl(VQ),WQ=[9,13,27,32],GM=nd&&"CompositionEvent"in window,K_=null;nd&&"documentMode"in document&&(K_=document.documentMode);var GQ=nd&&"TextEvent"in window&&!K_,zB=nd&&(!GM||K_&&8<K_&&11>=K_),F4=" ",z4=!1;function $B(e,t){switch(e){case"keyup":return WQ.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function BB(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ng=!1;function KQ(e,t){switch(e){case"compositionend":return BB(t);case"keypress":return t.which!==32?null:(z4=!0,F4);case"textInput":return e=t.data,e===F4&&z4?null:e;default:return null}}function HQ(e,t){if(Ng)return e==="compositionend"||!GM&&$B(e,t)?(e=FB(),y1=VM=Ph=null,Ng=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return zB&&t.locale!=="ko"?null:t.data;default:return null}}var ZQ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $4(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!ZQ[e.type]:t==="textarea"}function qB(e,t,n,s){vB(s),t=B1(t,"onChange"),0<t.length&&(n=new UM("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var H_=null,f0=null;function YQ(e){JB(e,0)}function $N(e){var t=Ag(e);if(hB(t))return e}function XQ(e,t){if(e==="change")return t}var VB=!1;if(nd){var $C;if(nd){var BC="oninput"in document;if(!BC){var B4=document.createElement("div");B4.setAttribute("oninput","return;"),BC=typeof B4.oninput=="function"}$C=BC}else $C=!1;VB=$C&&(!document.documentMode||9<document.documentMode)}function q4(){H_&&(H_.detachEvent("onpropertychange",UB),f0=H_=null)}function UB(e){if(e.propertyName==="value"&&$N(f0)){var t=[];qB(t,f0,e,FM(e)),wB(YQ,t)}}function QQ(e,t,n){e==="focusin"?(q4(),H_=t,f0=n,H_.attachEvent("onpropertychange",UB)):e==="focusout"&&q4()}function JQ(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return $N(f0)}function eJ(e,t){if(e==="click")return $N(t)}function tJ(e,t){if(e==="input"||e==="change")return $N(t)}function rJ(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var xc=typeof Object.is=="function"?Object.is:rJ;function m0(e,t){if(xc(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var i=n[s];if(!ok.call(t,i)||!xc(e[i],t[i]))return!1}return!0}function V4(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function U4(e,t){var n=V4(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=V4(n)}}function WB(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?WB(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function GB(){for(var e=window,t=I1();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=I1(e.document)}return t}function KM(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function nJ(e){var t=GB(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&WB(n.ownerDocument.documentElement,n)){if(s!==null&&KM(n)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,c=Math.min(s.start,i);s=s.end===void 0?c:Math.min(s.end,i),!e.extend&&c>s&&(i=s,s=c,c=i),i=U4(n,c);var u=U4(n,s);i&&u&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==u.node||e.focusOffset!==u.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),c>s?(e.addRange(t),e.extend(u.node,u.offset)):(t.setEnd(u.node,u.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var sJ=nd&&"documentMode"in document&&11>=document.documentMode,Pg=null,Pk=null,Z_=null,Ck=!1;function W4(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ck||Pg==null||Pg!==I1(s)||(s=Pg,"selectionStart"in s&&KM(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Z_&&m0(Z_,s)||(Z_=s,s=B1(Pk,"onSelect"),0<s.length&&(t=new UM("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=Pg)))}function Mw(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Cg={animationend:Mw("Animation","AnimationEnd"),animationiteration:Mw("Animation","AnimationIteration"),animationstart:Mw("Animation","AnimationStart"),transitionend:Mw("Transition","TransitionEnd")},qC={},KB={};nd&&(KB=document.createElement("div").style,"AnimationEvent"in window||(delete Cg.animationend.animation,delete Cg.animationiteration.animation,delete Cg.animationstart.animation),"TransitionEvent"in window||delete Cg.transitionend.transition);function BN(e){if(qC[e])return qC[e];if(!Cg[e])return e;var t=Cg[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in KB)return qC[e]=t[n];return e}var HB=BN("animationend"),ZB=BN("animationiteration"),YB=BN("animationstart"),XB=BN("transitionend"),QB=new Map,G4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function nf(e,t){QB.set(e,t),Ym(t,[e])}for(var VC=0;VC<G4.length;VC++){var UC=G4[VC],iJ=UC.toLowerCase(),aJ=UC[0].toUpperCase()+UC.slice(1);nf(iJ,"on"+aJ)}nf(HB,"onAnimationEnd");nf(ZB,"onAnimationIteration");nf(YB,"onAnimationStart");nf("dblclick","onDoubleClick");nf("focusin","onFocus");nf("focusout","onBlur");nf(XB,"onTransitionEnd");gx("onMouseEnter",["mouseout","mouseover"]);gx("onMouseLeave",["mouseout","mouseover"]);gx("onPointerEnter",["pointerout","pointerover"]);gx("onPointerLeave",["pointerout","pointerover"]);Ym("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ym("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ym("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ym("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ym("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ym("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var F_="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),oJ=new Set("cancel close invalid load scroll toggle".split(" ").concat(F_));function K4(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,iQ(s,t,void 0,e),e.currentTarget=null}function JB(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],i=s.event;s=s.listeners;e:{var c=void 0;if(t)for(var u=s.length-1;0<=u;u--){var a=s[u],m=a.instance,p=a.currentTarget;if(a=a.listener,m!==c&&i.isPropagationStopped())break e;K4(i,a,p),c=m}else for(u=0;u<s.length;u++){if(a=s[u],m=a.instance,p=a.currentTarget,a=a.listener,m!==c&&i.isPropagationStopped())break e;K4(i,a,p),c=m}}}if(R1)throw e=jk,R1=!1,jk=null,e}function js(e,t){var n=t[Mk];n===void 0&&(n=t[Mk]=new Set);var s=e+"__bubble";n.has(s)||(e8(t,e,2,!1),n.add(s))}function WC(e,t,n){var s=0;t&&(s|=4),e8(n,e,s,t)}var Ow="_reactListening"+Math.random().toString(36).slice(2);function p0(e){if(!e[Ow]){e[Ow]=!0,oB.forEach(function(n){n!=="selectionchange"&&(oJ.has(n)||WC(n,!1,e),WC(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ow]||(t[Ow]=!0,WC("selectionchange",!1,t))}}function e8(e,t,n,s){switch(LB(t)){case 1:var i=bQ;break;case 4:i=jQ;break;default:i=qM}n=i.bind(null,t,n,e),i=void 0,!bk||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),s?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function GC(e,t,n,s,i){var c=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var u=s.tag;if(u===3||u===4){var a=s.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(u===4)for(u=s.return;u!==null;){var m=u.tag;if((m===3||m===4)&&(m=u.stateNode.containerInfo,m===i||m.nodeType===8&&m.parentNode===i))return;u=u.return}for(;a!==null;){if(u=cm(a),u===null)return;if(m=u.tag,m===5||m===6){s=c=u;continue e}a=a.parentNode}}s=s.return}wB(function(){var p=c,y=FM(n),v=[];e:{var j=QB.get(e);if(j!==void 0){var S=UM,k=e;switch(e){case"keypress":if(v1(n)===0)break e;case"keydown":case"keyup":S=LQ;break;case"focusin":k="focus",S=zC;break;case"focusout":k="blur",S=zC;break;case"beforeblur":case"afterblur":S=zC;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":S=D4;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":S=NQ;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":S=$Q;break;case HB:case ZB:case YB:S=AQ;break;case XB:S=qQ;break;case"scroll":S=wQ;break;case"wheel":S=UQ;break;case"copy":case"cut":case"paste":S=TQ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":S=L4}var N=(t&4)!==0,D=!N&&e==="scroll",O=N?j!==null?j+"Capture":null:j;N=[];for(var T=p,I;T!==null;){I=T;var z=I.stateNode;if(I.tag===5&&z!==null&&(I=z,O!==null&&(z=c0(T,O),z!=null&&N.push(g0(T,z,I)))),D)break;T=T.return}0<N.length&&(j=new S(j,k,null,n,y),v.push({event:j,listeners:N}))}}if(!(t&7)){e:{if(j=e==="mouseover"||e==="pointerover",S=e==="mouseout"||e==="pointerout",j&&n!==vk&&(k=n.relatedTarget||n.fromElement)&&(cm(k)||k[sd]))break e;if((S||j)&&(j=y.window===y?y:(j=y.ownerDocument)?j.defaultView||j.parentWindow:window,S?(k=n.relatedTarget||n.toElement,S=p,k=k?cm(k):null,k!==null&&(D=Xm(k),k!==D||k.tag!==5&&k.tag!==6)&&(k=null)):(S=null,k=p),S!==k)){if(N=D4,z="onMouseLeave",O="onMouseEnter",T="mouse",(e==="pointerout"||e==="pointerover")&&(N=L4,z="onPointerLeave",O="onPointerEnter",T="pointer"),D=S==null?j:Ag(S),I=k==null?j:Ag(k),j=new N(z,T+"leave",S,n,y),j.target=D,j.relatedTarget=I,z=null,cm(y)===p&&(N=new N(O,T+"enter",k,n,y),N.target=I,N.relatedTarget=D,z=N),D=z,S&&k)t:{for(N=S,O=k,T=0,I=N;I;I=ug(I))T++;for(I=0,z=O;z;z=ug(z))I++;for(;0<T-I;)N=ug(N),T--;for(;0<I-T;)O=ug(O),I--;for(;T--;){if(N===O||O!==null&&N===O.alternate)break t;N=ug(N),O=ug(O)}N=null}else N=null;S!==null&&H4(v,j,S,N,!1),k!==null&&D!==null&&H4(v,D,k,N,!0)}}e:{if(j=p?Ag(p):window,S=j.nodeName&&j.nodeName.toLowerCase(),S==="select"||S==="input"&&j.type==="file")var $=XQ;else if($4(j))if(VB)$=tJ;else{$=JQ;var V=QQ}else(S=j.nodeName)&&S.toLowerCase()==="input"&&(j.type==="checkbox"||j.type==="radio")&&($=eJ);if($&&($=$(e,p))){qB(v,$,n,y);break e}V&&V(e,j,p),e==="focusout"&&(V=j._wrapperState)&&V.controlled&&j.type==="number"&&mk(j,"number",j.value)}switch(V=p?Ag(p):window,e){case"focusin":($4(V)||V.contentEditable==="true")&&(Pg=V,Pk=p,Z_=null);break;case"focusout":Z_=Pk=Pg=null;break;case"mousedown":Ck=!0;break;case"contextmenu":case"mouseup":case"dragend":Ck=!1,W4(v,n,y);break;case"selectionchange":if(sJ)break;case"keydown":case"keyup":W4(v,n,y)}var K;if(GM)e:{switch(e){case"compositionstart":var te="onCompositionStart";break e;case"compositionend":te="onCompositionEnd";break e;case"compositionupdate":te="onCompositionUpdate";break e}te=void 0}else Ng?$B(e,n)&&(te="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(te="onCompositionStart");te&&(zB&&n.locale!=="ko"&&(Ng||te!=="onCompositionStart"?te==="onCompositionEnd"&&Ng&&(K=FB()):(Ph=y,VM="value"in Ph?Ph.value:Ph.textContent,Ng=!0)),V=B1(p,te),0<V.length&&(te=new R4(te,e,null,n,y),v.push({event:te,listeners:V}),K?te.data=K:(K=BB(n),K!==null&&(te.data=K)))),(K=GQ?KQ(e,n):HQ(e,n))&&(p=B1(p,"onBeforeInput"),0<p.length&&(y=new R4("onBeforeInput","beforeinput",null,n,y),v.push({event:y,listeners:p}),y.data=K))}JB(v,t)})}function g0(e,t,n){return{instance:e,listener:t,currentTarget:n}}function B1(e,t){for(var n=t+"Capture",s=[];e!==null;){var i=e,c=i.stateNode;i.tag===5&&c!==null&&(i=c,c=c0(e,n),c!=null&&s.unshift(g0(e,c,i)),c=c0(e,t),c!=null&&s.push(g0(e,c,i))),e=e.return}return s}function ug(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function H4(e,t,n,s,i){for(var c=t._reactName,u=[];n!==null&&n!==s;){var a=n,m=a.alternate,p=a.stateNode;if(m!==null&&m===s)break;a.tag===5&&p!==null&&(a=p,i?(m=c0(n,c),m!=null&&u.unshift(g0(n,m,a))):i||(m=c0(n,c),m!=null&&u.push(g0(n,m,a)))),n=n.return}u.length!==0&&e.push({event:t,listeners:u})}var lJ=/\r\n?/g,cJ=/\u0000|\uFFFD/g;function Z4(e){return(typeof e=="string"?e:""+e).replace(lJ,`
`).replace(cJ,"")}function Iw(e,t,n){if(t=Z4(t),Z4(e)!==t&&n)throw Error(qt(425))}function q1(){}var Ak=null,kk=null;function Tk(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ek=typeof setTimeout=="function"?setTimeout:void 0,uJ=typeof clearTimeout=="function"?clearTimeout:void 0,Y4=typeof Promise=="function"?Promise:void 0,dJ=typeof queueMicrotask=="function"?queueMicrotask:typeof Y4<"u"?function(e){return Y4.resolve(null).then(e).catch(hJ)}:Ek;function hJ(e){setTimeout(function(){throw e})}function KC(e,t){var n=t,s=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(s===0){e.removeChild(i),h0(t);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=i}while(n);h0(t)}function Dh(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function X4(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var py=Math.random().toString(36).slice(2),zc="__reactFiber$"+py,x0="__reactProps$"+py,sd="__reactContainer$"+py,Mk="__reactEvents$"+py,fJ="__reactListeners$"+py,mJ="__reactHandles$"+py;function cm(e){var t=e[zc];if(t)return t;for(var n=e.parentNode;n;){if(t=n[sd]||n[zc]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=X4(e);e!==null;){if(n=e[zc])return n;e=X4(e)}return t}e=n,n=e.parentNode}return null}function Tb(e){return e=e[zc]||e[sd],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ag(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(qt(33))}function qN(e){return e[x0]||null}var Ok=[],kg=-1;function sf(e){return{current:e}}function Cs(e){0>kg||(e.current=Ok[kg],Ok[kg]=null,kg--)}function gs(e,t){kg++,Ok[kg]=e.current,e.current=t}var Wh={},Ra=sf(Wh),yo=sf(!1),Tm=Wh;function xx(e,t){var n=e.type.contextTypes;if(!n)return Wh;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var i={},c;for(c in n)i[c]=t[c];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function vo(e){return e=e.childContextTypes,e!=null}function V1(){Cs(yo),Cs(Ra)}function Q4(e,t,n){if(Ra.current!==Wh)throw Error(qt(168));gs(Ra,t),gs(yo,n)}function t8(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var i in s)if(!(i in t))throw Error(qt(108,QX(e)||"Unknown",i));return Js({},n,s)}function U1(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Wh,Tm=Ra.current,gs(Ra,e),gs(yo,yo.current),!0}function J4(e,t,n){var s=e.stateNode;if(!s)throw Error(qt(169));n?(e=t8(e,t,Tm),s.__reactInternalMemoizedMergedChildContext=e,Cs(yo),Cs(Ra),gs(Ra,e)):Cs(yo),gs(yo,n)}var Bu=null,VN=!1,HC=!1;function r8(e){Bu===null?Bu=[e]:Bu.push(e)}function pJ(e){VN=!0,r8(e)}function af(){if(!HC&&Bu!==null){HC=!0;var e=0,t=Yn;try{var n=Bu;for(Yn=1;e<n.length;e++){var s=n[e];do s=s(!0);while(s!==null)}Bu=null,VN=!1}catch(i){throw Bu!==null&&(Bu=Bu.slice(e+1)),CB(zM,af),i}finally{Yn=t,HC=!1}}return null}var Tg=[],Eg=0,W1=null,G1=0,pl=[],gl=0,Em=null,Uu=1,Wu="";function rm(e,t){Tg[Eg++]=G1,Tg[Eg++]=W1,W1=e,G1=t}function n8(e,t,n){pl[gl++]=Uu,pl[gl++]=Wu,pl[gl++]=Em,Em=e;var s=Uu;e=Wu;var i=32-hc(s)-1;s&=~(1<<i),n+=1;var c=32-hc(t)+i;if(30<c){var u=i-i%5;c=(s&(1<<u)-1).toString(32),s>>=u,i-=u,Uu=1<<32-hc(t)+i|n<<i|s,Wu=c+e}else Uu=1<<c|n<<i|s,Wu=e}function HM(e){e.return!==null&&(rm(e,1),n8(e,1,0))}function ZM(e){for(;e===W1;)W1=Tg[--Eg],Tg[Eg]=null,G1=Tg[--Eg],Tg[Eg]=null;for(;e===Em;)Em=pl[--gl],pl[gl]=null,Wu=pl[--gl],pl[gl]=null,Uu=pl[--gl],pl[gl]=null}var Ko=null,Uo=null,Rs=!1,sc=null;function s8(e,t){var n=bl(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function eL(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ko=e,Uo=Dh(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ko=e,Uo=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Em!==null?{id:Uu,overflow:Wu}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=bl(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Ko=e,Uo=null,!0):!1;default:return!1}}function Ik(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Dk(e){if(Rs){var t=Uo;if(t){var n=t;if(!eL(e,t)){if(Ik(e))throw Error(qt(418));t=Dh(n.nextSibling);var s=Ko;t&&eL(e,t)?s8(s,n):(e.flags=e.flags&-4097|2,Rs=!1,Ko=e)}}else{if(Ik(e))throw Error(qt(418));e.flags=e.flags&-4097|2,Rs=!1,Ko=e}}}function tL(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ko=e}function Dw(e){if(e!==Ko)return!1;if(!Rs)return tL(e),Rs=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Tk(e.type,e.memoizedProps)),t&&(t=Uo)){if(Ik(e))throw i8(),Error(qt(418));for(;t;)s8(e,t),t=Dh(t.nextSibling)}if(tL(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(qt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Uo=Dh(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Uo=null}}else Uo=Ko?Dh(e.stateNode.nextSibling):null;return!0}function i8(){for(var e=Uo;e;)e=Dh(e.nextSibling)}function yx(){Uo=Ko=null,Rs=!1}function YM(e){sc===null?sc=[e]:sc.push(e)}var gJ=gd.ReactCurrentBatchConfig;function h_(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(qt(309));var s=n.stateNode}if(!s)throw Error(qt(147,e));var i=s,c=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===c?t.ref:(t=function(u){var a=i.refs;u===null?delete a[c]:a[c]=u},t._stringRef=c,t)}if(typeof e!="string")throw Error(qt(284));if(!n._owner)throw Error(qt(290,e))}return e}function Rw(e,t){throw e=Object.prototype.toString.call(t),Error(qt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function rL(e){var t=e._init;return t(e._payload)}function a8(e){function t(O,T){if(e){var I=O.deletions;I===null?(O.deletions=[T],O.flags|=16):I.push(T)}}function n(O,T){if(!e)return null;for(;T!==null;)t(O,T),T=T.sibling;return null}function s(O,T){for(O=new Map;T!==null;)T.key!==null?O.set(T.key,T):O.set(T.index,T),T=T.sibling;return O}function i(O,T){return O=zh(O,T),O.index=0,O.sibling=null,O}function c(O,T,I){return O.index=I,e?(I=O.alternate,I!==null?(I=I.index,I<T?(O.flags|=2,T):I):(O.flags|=2,T)):(O.flags|=1048576,T)}function u(O){return e&&O.alternate===null&&(O.flags|=2),O}function a(O,T,I,z){return T===null||T.tag!==6?(T=tA(I,O.mode,z),T.return=O,T):(T=i(T,I),T.return=O,T)}function m(O,T,I,z){var $=I.type;return $===Sg?y(O,T,I.props.children,z,I.key):T!==null&&(T.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===ch&&rL($)===T.type)?(z=i(T,I.props),z.ref=h_(O,T,I),z.return=O,z):(z=P1(I.type,I.key,I.props,null,O.mode,z),z.ref=h_(O,T,I),z.return=O,z)}function p(O,T,I,z){return T===null||T.tag!==4||T.stateNode.containerInfo!==I.containerInfo||T.stateNode.implementation!==I.implementation?(T=rA(I,O.mode,z),T.return=O,T):(T=i(T,I.children||[]),T.return=O,T)}function y(O,T,I,z,$){return T===null||T.tag!==7?(T=Pm(I,O.mode,z,$),T.return=O,T):(T=i(T,I),T.return=O,T)}function v(O,T,I){if(typeof T=="string"&&T!==""||typeof T=="number")return T=tA(""+T,O.mode,I),T.return=O,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Nw:return I=P1(T.type,T.key,T.props,null,O.mode,I),I.ref=h_(O,null,T),I.return=O,I;case wg:return T=rA(T,O.mode,I),T.return=O,T;case ch:var z=T._init;return v(O,z(T._payload),I)}if(R_(T)||o_(T))return T=Pm(T,O.mode,I,null),T.return=O,T;Rw(O,T)}return null}function j(O,T,I,z){var $=T!==null?T.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return $!==null?null:a(O,T,""+I,z);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Nw:return I.key===$?m(O,T,I,z):null;case wg:return I.key===$?p(O,T,I,z):null;case ch:return $=I._init,j(O,T,$(I._payload),z)}if(R_(I)||o_(I))return $!==null?null:y(O,T,I,z,null);Rw(O,I)}return null}function S(O,T,I,z,$){if(typeof z=="string"&&z!==""||typeof z=="number")return O=O.get(I)||null,a(T,O,""+z,$);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case Nw:return O=O.get(z.key===null?I:z.key)||null,m(T,O,z,$);case wg:return O=O.get(z.key===null?I:z.key)||null,p(T,O,z,$);case ch:var V=z._init;return S(O,T,I,V(z._payload),$)}if(R_(z)||o_(z))return O=O.get(I)||null,y(T,O,z,$,null);Rw(T,z)}return null}function k(O,T,I,z){for(var $=null,V=null,K=T,te=T=0,X=null;K!==null&&te<I.length;te++){K.index>te?(X=K,K=null):X=K.sibling;var ve=j(O,K,I[te],z);if(ve===null){K===null&&(K=X);break}e&&K&&ve.alternate===null&&t(O,K),T=c(ve,T,te),V===null?$=ve:V.sibling=ve,V=ve,K=X}if(te===I.length)return n(O,K),Rs&&rm(O,te),$;if(K===null){for(;te<I.length;te++)K=v(O,I[te],z),K!==null&&(T=c(K,T,te),V===null?$=K:V.sibling=K,V=K);return Rs&&rm(O,te),$}for(K=s(O,K);te<I.length;te++)X=S(K,O,te,I[te],z),X!==null&&(e&&X.alternate!==null&&K.delete(X.key===null?te:X.key),T=c(X,T,te),V===null?$=X:V.sibling=X,V=X);return e&&K.forEach(function(ae){return t(O,ae)}),Rs&&rm(O,te),$}function N(O,T,I,z){var $=o_(I);if(typeof $!="function")throw Error(qt(150));if(I=$.call(I),I==null)throw Error(qt(151));for(var V=$=null,K=T,te=T=0,X=null,ve=I.next();K!==null&&!ve.done;te++,ve=I.next()){K.index>te?(X=K,K=null):X=K.sibling;var ae=j(O,K,ve.value,z);if(ae===null){K===null&&(K=X);break}e&&K&&ae.alternate===null&&t(O,K),T=c(ae,T,te),V===null?$=ae:V.sibling=ae,V=ae,K=X}if(ve.done)return n(O,K),Rs&&rm(O,te),$;if(K===null){for(;!ve.done;te++,ve=I.next())ve=v(O,ve.value,z),ve!==null&&(T=c(ve,T,te),V===null?$=ve:V.sibling=ve,V=ve);return Rs&&rm(O,te),$}for(K=s(O,K);!ve.done;te++,ve=I.next())ve=S(K,O,te,ve.value,z),ve!==null&&(e&&ve.alternate!==null&&K.delete(ve.key===null?te:ve.key),T=c(ve,T,te),V===null?$=ve:V.sibling=ve,V=ve);return e&&K.forEach(function(pe){return t(O,pe)}),Rs&&rm(O,te),$}function D(O,T,I,z){if(typeof I=="object"&&I!==null&&I.type===Sg&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case Nw:e:{for(var $=I.key,V=T;V!==null;){if(V.key===$){if($=I.type,$===Sg){if(V.tag===7){n(O,V.sibling),T=i(V,I.props.children),T.return=O,O=T;break e}}else if(V.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===ch&&rL($)===V.type){n(O,V.sibling),T=i(V,I.props),T.ref=h_(O,V,I),T.return=O,O=T;break e}n(O,V);break}else t(O,V);V=V.sibling}I.type===Sg?(T=Pm(I.props.children,O.mode,z,I.key),T.return=O,O=T):(z=P1(I.type,I.key,I.props,null,O.mode,z),z.ref=h_(O,T,I),z.return=O,O=z)}return u(O);case wg:e:{for(V=I.key;T!==null;){if(T.key===V)if(T.tag===4&&T.stateNode.containerInfo===I.containerInfo&&T.stateNode.implementation===I.implementation){n(O,T.sibling),T=i(T,I.children||[]),T.return=O,O=T;break e}else{n(O,T);break}else t(O,T);T=T.sibling}T=rA(I,O.mode,z),T.return=O,O=T}return u(O);case ch:return V=I._init,D(O,T,V(I._payload),z)}if(R_(I))return k(O,T,I,z);if(o_(I))return N(O,T,I,z);Rw(O,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,T!==null&&T.tag===6?(n(O,T.sibling),T=i(T,I),T.return=O,O=T):(n(O,T),T=tA(I,O.mode,z),T.return=O,O=T),u(O)):n(O,T)}return D}var vx=a8(!0),o8=a8(!1),K1=sf(null),H1=null,Mg=null,XM=null;function QM(){XM=Mg=H1=null}function JM(e){var t=K1.current;Cs(K1),e._currentValue=t}function Rk(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function Wg(e,t){H1=e,XM=Mg=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(po=!0),e.firstContext=null)}function Nl(e){var t=e._currentValue;if(XM!==e)if(e={context:e,memoizedValue:t,next:null},Mg===null){if(H1===null)throw Error(qt(308));Mg=e,H1.dependencies={lanes:0,firstContext:e}}else Mg=Mg.next=e;return t}var um=null;function eO(e){um===null?um=[e]:um.push(e)}function l8(e,t,n,s){var i=t.interleaved;return i===null?(n.next=n,eO(t)):(n.next=i.next,i.next=n),t.interleaved=n,id(e,s)}function id(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var uh=!1;function tO(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function c8(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Yu(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Rh(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,In&2){var i=s.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),s.pending=t,id(e,n)}return i=s.interleaved,i===null?(t.next=t,eO(s)):(t.next=i.next,i.next=t),s.interleaved=t,id(e,n)}function _1(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,$M(e,n)}}function nL(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var i=null,c=null;if(n=n.firstBaseUpdate,n!==null){do{var u={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};c===null?i=c=u:c=c.next=u,n=n.next}while(n!==null);c===null?i=c=t:c=c.next=t}else i=c=t;n={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:c,shared:s.shared,effects:s.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Z1(e,t,n,s){var i=e.updateQueue;uh=!1;var c=i.firstBaseUpdate,u=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var m=a,p=m.next;m.next=null,u===null?c=p:u.next=p,u=m;var y=e.alternate;y!==null&&(y=y.updateQueue,a=y.lastBaseUpdate,a!==u&&(a===null?y.firstBaseUpdate=p:a.next=p,y.lastBaseUpdate=m))}if(c!==null){var v=i.baseState;u=0,y=p=m=null,a=c;do{var j=a.lane,S=a.eventTime;if((s&j)===j){y!==null&&(y=y.next={eventTime:S,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var k=e,N=a;switch(j=t,S=n,N.tag){case 1:if(k=N.payload,typeof k=="function"){v=k.call(S,v,j);break e}v=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=N.payload,j=typeof k=="function"?k.call(S,v,j):k,j==null)break e;v=Js({},v,j);break e;case 2:uh=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,j=i.effects,j===null?i.effects=[a]:j.push(a))}else S={eventTime:S,lane:j,tag:a.tag,payload:a.payload,callback:a.callback,next:null},y===null?(p=y=S,m=v):y=y.next=S,u|=j;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;j=a,a=j.next,j.next=null,i.lastBaseUpdate=j,i.shared.pending=null}}while(!0);if(y===null&&(m=v),i.baseState=m,i.firstBaseUpdate=p,i.lastBaseUpdate=y,t=i.shared.interleaved,t!==null){i=t;do u|=i.lane,i=i.next;while(i!==t)}else c===null&&(i.shared.lanes=0);Om|=u,e.lanes=u,e.memoizedState=v}}function sL(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],i=s.callback;if(i!==null){if(s.callback=null,s=n,typeof i!="function")throw Error(qt(191,i));i.call(s)}}}var Eb={},Wc=sf(Eb),y0=sf(Eb),v0=sf(Eb);function dm(e){if(e===Eb)throw Error(qt(174));return e}function rO(e,t){switch(gs(v0,t),gs(y0,e),gs(Wc,Eb),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:gk(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=gk(t,e)}Cs(Wc),gs(Wc,t)}function _x(){Cs(Wc),Cs(y0),Cs(v0)}function u8(e){dm(v0.current);var t=dm(Wc.current),n=gk(t,e.type);t!==n&&(gs(y0,e),gs(Wc,n))}function nO(e){y0.current===e&&(Cs(Wc),Cs(y0))}var Hs=sf(0);function Y1(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ZC=[];function sO(){for(var e=0;e<ZC.length;e++)ZC[e]._workInProgressVersionPrimary=null;ZC.length=0}var b1=gd.ReactCurrentDispatcher,YC=gd.ReactCurrentBatchConfig,Mm=0,Xs=null,$i=null,ta=null,X1=!1,Y_=!1,_0=0,xJ=0;function Pa(){throw Error(qt(321))}function iO(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!xc(e[n],t[n]))return!1;return!0}function aO(e,t,n,s,i,c){if(Mm=c,Xs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,b1.current=e===null||e.memoizedState===null?bJ:jJ,e=n(s,i),Y_){c=0;do{if(Y_=!1,_0=0,25<=c)throw Error(qt(301));c+=1,ta=$i=null,t.updateQueue=null,b1.current=wJ,e=n(s,i)}while(Y_)}if(b1.current=Q1,t=$i!==null&&$i.next!==null,Mm=0,ta=$i=Xs=null,X1=!1,t)throw Error(qt(300));return e}function oO(){var e=_0!==0;return _0=0,e}function Ic(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ta===null?Xs.memoizedState=ta=e:ta=ta.next=e,ta}function Pl(){if($i===null){var e=Xs.alternate;e=e!==null?e.memoizedState:null}else e=$i.next;var t=ta===null?Xs.memoizedState:ta.next;if(t!==null)ta=t,$i=e;else{if(e===null)throw Error(qt(310));$i=e,e={memoizedState:$i.memoizedState,baseState:$i.baseState,baseQueue:$i.baseQueue,queue:$i.queue,next:null},ta===null?Xs.memoizedState=ta=e:ta=ta.next=e}return ta}function b0(e,t){return typeof t=="function"?t(e):t}function XC(e){var t=Pl(),n=t.queue;if(n===null)throw Error(qt(311));n.lastRenderedReducer=e;var s=$i,i=s.baseQueue,c=n.pending;if(c!==null){if(i!==null){var u=i.next;i.next=c.next,c.next=u}s.baseQueue=i=c,n.pending=null}if(i!==null){c=i.next,s=s.baseState;var a=u=null,m=null,p=c;do{var y=p.lane;if((Mm&y)===y)m!==null&&(m=m.next={lane:0,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null}),s=p.hasEagerState?p.eagerState:e(s,p.action);else{var v={lane:y,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null};m===null?(a=m=v,u=s):m=m.next=v,Xs.lanes|=y,Om|=y}p=p.next}while(p!==null&&p!==c);m===null?u=s:m.next=a,xc(s,t.memoizedState)||(po=!0),t.memoizedState=s,t.baseState=u,t.baseQueue=m,n.lastRenderedState=s}if(e=n.interleaved,e!==null){i=e;do c=i.lane,Xs.lanes|=c,Om|=c,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function QC(e){var t=Pl(),n=t.queue;if(n===null)throw Error(qt(311));n.lastRenderedReducer=e;var s=n.dispatch,i=n.pending,c=t.memoizedState;if(i!==null){n.pending=null;var u=i=i.next;do c=e(c,u.action),u=u.next;while(u!==i);xc(c,t.memoizedState)||(po=!0),t.memoizedState=c,t.baseQueue===null&&(t.baseState=c),n.lastRenderedState=c}return[c,s]}function d8(){}function h8(e,t){var n=Xs,s=Pl(),i=t(),c=!xc(s.memoizedState,i);if(c&&(s.memoizedState=i,po=!0),s=s.queue,lO(p8.bind(null,n,s,e),[e]),s.getSnapshot!==t||c||ta!==null&&ta.memoizedState.tag&1){if(n.flags|=2048,j0(9,m8.bind(null,n,s,i,t),void 0,null),na===null)throw Error(qt(349));Mm&30||f8(n,t,i)}return i}function f8(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Xs.updateQueue,t===null?(t={lastEffect:null,stores:null},Xs.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function m8(e,t,n,s){t.value=n,t.getSnapshot=s,g8(t)&&x8(e)}function p8(e,t,n){return n(function(){g8(t)&&x8(e)})}function g8(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!xc(e,n)}catch{return!0}}function x8(e){var t=id(e,1);t!==null&&fc(t,e,1,-1)}function iL(e){var t=Ic();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:b0,lastRenderedState:e},t.queue=e,e=e.dispatch=_J.bind(null,Xs,e),[t.memoizedState,e]}function j0(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},t=Xs.updateQueue,t===null?(t={lastEffect:null,stores:null},Xs.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e)),e}function y8(){return Pl().memoizedState}function j1(e,t,n,s){var i=Ic();Xs.flags|=e,i.memoizedState=j0(1|t,n,void 0,s===void 0?null:s)}function UN(e,t,n,s){var i=Pl();s=s===void 0?null:s;var c=void 0;if($i!==null){var u=$i.memoizedState;if(c=u.destroy,s!==null&&iO(s,u.deps)){i.memoizedState=j0(t,n,c,s);return}}Xs.flags|=e,i.memoizedState=j0(1|t,n,c,s)}function aL(e,t){return j1(8390656,8,e,t)}function lO(e,t){return UN(2048,8,e,t)}function v8(e,t){return UN(4,2,e,t)}function _8(e,t){return UN(4,4,e,t)}function b8(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function j8(e,t,n){return n=n!=null?n.concat([e]):null,UN(4,4,b8.bind(null,t,e),n)}function cO(){}function w8(e,t){var n=Pl();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&iO(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function S8(e,t){var n=Pl();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&iO(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function N8(e,t,n){return Mm&21?(xc(n,t)||(n=TB(),Xs.lanes|=n,Om|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,po=!0),e.memoizedState=n)}function yJ(e,t){var n=Yn;Yn=n!==0&&4>n?n:4,e(!0);var s=YC.transition;YC.transition={};try{e(!1),t()}finally{Yn=n,YC.transition=s}}function P8(){return Pl().memoizedState}function vJ(e,t,n){var s=Fh(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},C8(e))A8(t,n);else if(n=l8(e,t,n,s),n!==null){var i=Ja();fc(n,e,s,i),k8(n,t,s)}}function _J(e,t,n){var s=Fh(e),i={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(C8(e))A8(t,i);else{var c=e.alternate;if(e.lanes===0&&(c===null||c.lanes===0)&&(c=t.lastRenderedReducer,c!==null))try{var u=t.lastRenderedState,a=c(u,n);if(i.hasEagerState=!0,i.eagerState=a,xc(a,u)){var m=t.interleaved;m===null?(i.next=i,eO(t)):(i.next=m.next,m.next=i),t.interleaved=i;return}}catch{}finally{}n=l8(e,t,i,s),n!==null&&(i=Ja(),fc(n,e,s,i),k8(n,t,s))}}function C8(e){var t=e.alternate;return e===Xs||t!==null&&t===Xs}function A8(e,t){Y_=X1=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function k8(e,t,n){if(n&4194240){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,$M(e,n)}}var Q1={readContext:Nl,useCallback:Pa,useContext:Pa,useEffect:Pa,useImperativeHandle:Pa,useInsertionEffect:Pa,useLayoutEffect:Pa,useMemo:Pa,useReducer:Pa,useRef:Pa,useState:Pa,useDebugValue:Pa,useDeferredValue:Pa,useTransition:Pa,useMutableSource:Pa,useSyncExternalStore:Pa,useId:Pa,unstable_isNewReconciler:!1},bJ={readContext:Nl,useCallback:function(e,t){return Ic().memoizedState=[e,t===void 0?null:t],e},useContext:Nl,useEffect:aL,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,j1(4194308,4,b8.bind(null,t,e),n)},useLayoutEffect:function(e,t){return j1(4194308,4,e,t)},useInsertionEffect:function(e,t){return j1(4,2,e,t)},useMemo:function(e,t){var n=Ic();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=Ic();return t=n!==void 0?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=vJ.bind(null,Xs,e),[s.memoizedState,e]},useRef:function(e){var t=Ic();return e={current:e},t.memoizedState=e},useState:iL,useDebugValue:cO,useDeferredValue:function(e){return Ic().memoizedState=e},useTransition:function(){var e=iL(!1),t=e[0];return e=yJ.bind(null,e[1]),Ic().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=Xs,i=Ic();if(Rs){if(n===void 0)throw Error(qt(407));n=n()}else{if(n=t(),na===null)throw Error(qt(349));Mm&30||f8(s,t,n)}i.memoizedState=n;var c={value:n,getSnapshot:t};return i.queue=c,aL(p8.bind(null,s,c,e),[e]),s.flags|=2048,j0(9,m8.bind(null,s,c,n,t),void 0,null),n},useId:function(){var e=Ic(),t=na.identifierPrefix;if(Rs){var n=Wu,s=Uu;n=(s&~(1<<32-hc(s)-1)).toString(32)+n,t=":"+t+"R"+n,n=_0++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=xJ++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},jJ={readContext:Nl,useCallback:w8,useContext:Nl,useEffect:lO,useImperativeHandle:j8,useInsertionEffect:v8,useLayoutEffect:_8,useMemo:S8,useReducer:XC,useRef:y8,useState:function(){return XC(b0)},useDebugValue:cO,useDeferredValue:function(e){var t=Pl();return N8(t,$i.memoizedState,e)},useTransition:function(){var e=XC(b0)[0],t=Pl().memoizedState;return[e,t]},useMutableSource:d8,useSyncExternalStore:h8,useId:P8,unstable_isNewReconciler:!1},wJ={readContext:Nl,useCallback:w8,useContext:Nl,useEffect:lO,useImperativeHandle:j8,useInsertionEffect:v8,useLayoutEffect:_8,useMemo:S8,useReducer:QC,useRef:y8,useState:function(){return QC(b0)},useDebugValue:cO,useDeferredValue:function(e){var t=Pl();return $i===null?t.memoizedState=e:N8(t,$i.memoizedState,e)},useTransition:function(){var e=QC(b0)[0],t=Pl().memoizedState;return[e,t]},useMutableSource:d8,useSyncExternalStore:h8,useId:P8,unstable_isNewReconciler:!1};function Jl(e,t){if(e&&e.defaultProps){t=Js({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Lk(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:Js({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var WN={isMounted:function(e){return(e=e._reactInternals)?Xm(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=Ja(),i=Fh(e),c=Yu(s,i);c.payload=t,n!=null&&(c.callback=n),t=Rh(e,c,i),t!==null&&(fc(t,e,i,s),_1(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=Ja(),i=Fh(e),c=Yu(s,i);c.tag=1,c.payload=t,n!=null&&(c.callback=n),t=Rh(e,c,i),t!==null&&(fc(t,e,i,s),_1(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ja(),s=Fh(e),i=Yu(n,s);i.tag=2,t!=null&&(i.callback=t),t=Rh(e,i,s),t!==null&&(fc(t,e,s,n),_1(t,e,s))}};function oL(e,t,n,s,i,c,u){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,c,u):t.prototype&&t.prototype.isPureReactComponent?!m0(n,s)||!m0(i,c):!0}function T8(e,t,n){var s=!1,i=Wh,c=t.contextType;return typeof c=="object"&&c!==null?c=Nl(c):(i=vo(t)?Tm:Ra.current,s=t.contextTypes,c=(s=s!=null)?xx(e,i):Wh),t=new t(n,c),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=WN,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=c),t}function lL(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&WN.enqueueReplaceState(t,t.state,null)}function Fk(e,t,n,s){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},tO(e);var c=t.contextType;typeof c=="object"&&c!==null?i.context=Nl(c):(c=vo(t)?Tm:Ra.current,i.context=xx(e,c)),i.state=e.memoizedState,c=t.getDerivedStateFromProps,typeof c=="function"&&(Lk(e,t,c,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&WN.enqueueReplaceState(i,i.state,null),Z1(e,n,i,s),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function bx(e,t){try{var n="",s=t;do n+=XX(s),s=s.return;while(s);var i=n}catch(c){i=`
Error generating stack: `+c.message+`
`+c.stack}return{value:e,source:t,stack:i,digest:null}}function JC(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function zk(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var SJ=typeof WeakMap=="function"?WeakMap:Map;function E8(e,t,n){n=Yu(-1,n),n.tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){eS||(eS=!0,Zk=s),zk(e,t)},n}function M8(e,t,n){n=Yu(-1,n),n.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var i=t.value;n.payload=function(){return s(i)},n.callback=function(){zk(e,t)}}var c=e.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(n.callback=function(){zk(e,t),typeof s!="function"&&(Lh===null?Lh=new Set([this]):Lh.add(this));var u=t.stack;this.componentDidCatch(t.value,{componentStack:u!==null?u:""})}),n}function cL(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new SJ;var i=new Set;s.set(t,i)}else i=s.get(t),i===void 0&&(i=new Set,s.set(t,i));i.has(n)||(i.add(n),e=FJ.bind(null,e,t,n),t.then(e,e))}function uL(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function dL(e,t,n,s,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Yu(-1,1),t.tag=2,Rh(n,t,1))),n.lanes|=1),e)}var NJ=gd.ReactCurrentOwner,po=!1;function Ha(e,t,n,s){t.child=e===null?o8(t,null,n,s):vx(t,e.child,n,s)}function hL(e,t,n,s,i){n=n.render;var c=t.ref;return Wg(t,i),s=aO(e,t,n,s,c,i),n=oO(),e!==null&&!po?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ad(e,t,i)):(Rs&&n&&HM(t),t.flags|=1,Ha(e,t,s,i),t.child)}function fL(e,t,n,s,i){if(e===null){var c=n.type;return typeof c=="function"&&!xO(c)&&c.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=c,O8(e,t,c,s,i)):(e=P1(n.type,null,s,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(c=e.child,!(e.lanes&i)){var u=c.memoizedProps;if(n=n.compare,n=n!==null?n:m0,n(u,s)&&e.ref===t.ref)return ad(e,t,i)}return t.flags|=1,e=zh(c,s),e.ref=t.ref,e.return=t,t.child=e}function O8(e,t,n,s,i){if(e!==null){var c=e.memoizedProps;if(m0(c,s)&&e.ref===t.ref)if(po=!1,t.pendingProps=s=c,(e.lanes&i)!==0)e.flags&131072&&(po=!0);else return t.lanes=e.lanes,ad(e,t,i)}return $k(e,t,n,s,i)}function I8(e,t,n){var s=t.pendingProps,i=s.children,c=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},gs(Ig,Fo),Fo|=n;else{if(!(n&1073741824))return e=c!==null?c.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,gs(Ig,Fo),Fo|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=c!==null?c.baseLanes:n,gs(Ig,Fo),Fo|=s}else c!==null?(s=c.baseLanes|n,t.memoizedState=null):s=n,gs(Ig,Fo),Fo|=s;return Ha(e,t,i,n),t.child}function D8(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function $k(e,t,n,s,i){var c=vo(n)?Tm:Ra.current;return c=xx(t,c),Wg(t,i),n=aO(e,t,n,s,c,i),s=oO(),e!==null&&!po?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ad(e,t,i)):(Rs&&s&&HM(t),t.flags|=1,Ha(e,t,n,i),t.child)}function mL(e,t,n,s,i){if(vo(n)){var c=!0;U1(t)}else c=!1;if(Wg(t,i),t.stateNode===null)w1(e,t),T8(t,n,s),Fk(t,n,s,i),s=!0;else if(e===null){var u=t.stateNode,a=t.memoizedProps;u.props=a;var m=u.context,p=n.contextType;typeof p=="object"&&p!==null?p=Nl(p):(p=vo(n)?Tm:Ra.current,p=xx(t,p));var y=n.getDerivedStateFromProps,v=typeof y=="function"||typeof u.getSnapshotBeforeUpdate=="function";v||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(a!==s||m!==p)&&lL(t,u,s,p),uh=!1;var j=t.memoizedState;u.state=j,Z1(t,s,u,i),m=t.memoizedState,a!==s||j!==m||yo.current||uh?(typeof y=="function"&&(Lk(t,n,y,s),m=t.memoizedState),(a=uh||oL(t,n,a,s,j,m,p))?(v||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount()),typeof u.componentDidMount=="function"&&(t.flags|=4194308)):(typeof u.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=m),u.props=s,u.state=m,u.context=p,s=a):(typeof u.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{u=t.stateNode,c8(e,t),a=t.memoizedProps,p=t.type===t.elementType?a:Jl(t.type,a),u.props=p,v=t.pendingProps,j=u.context,m=n.contextType,typeof m=="object"&&m!==null?m=Nl(m):(m=vo(n)?Tm:Ra.current,m=xx(t,m));var S=n.getDerivedStateFromProps;(y=typeof S=="function"||typeof u.getSnapshotBeforeUpdate=="function")||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(a!==v||j!==m)&&lL(t,u,s,m),uh=!1,j=t.memoizedState,u.state=j,Z1(t,s,u,i);var k=t.memoizedState;a!==v||j!==k||yo.current||uh?(typeof S=="function"&&(Lk(t,n,S,s),k=t.memoizedState),(p=uh||oL(t,n,p,s,j,k,m)||!1)?(y||typeof u.UNSAFE_componentWillUpdate!="function"&&typeof u.componentWillUpdate!="function"||(typeof u.componentWillUpdate=="function"&&u.componentWillUpdate(s,k,m),typeof u.UNSAFE_componentWillUpdate=="function"&&u.UNSAFE_componentWillUpdate(s,k,m)),typeof u.componentDidUpdate=="function"&&(t.flags|=4),typeof u.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof u.componentDidUpdate!="function"||a===e.memoizedProps&&j===e.memoizedState||(t.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&j===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=k),u.props=s,u.state=k,u.context=m,s=p):(typeof u.componentDidUpdate!="function"||a===e.memoizedProps&&j===e.memoizedState||(t.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&j===e.memoizedState||(t.flags|=1024),s=!1)}return Bk(e,t,n,s,c,i)}function Bk(e,t,n,s,i,c){D8(e,t);var u=(t.flags&128)!==0;if(!s&&!u)return i&&J4(t,n,!1),ad(e,t,c);s=t.stateNode,NJ.current=t;var a=u&&typeof n.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&u?(t.child=vx(t,e.child,null,c),t.child=vx(t,null,a,c)):Ha(e,t,a,c),t.memoizedState=s.state,i&&J4(t,n,!0),t.child}function R8(e){var t=e.stateNode;t.pendingContext?Q4(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Q4(e,t.context,!1),rO(e,t.containerInfo)}function pL(e,t,n,s,i){return yx(),YM(i),t.flags|=256,Ha(e,t,n,s),t.child}var qk={dehydrated:null,treeContext:null,retryLane:0};function Vk(e){return{baseLanes:e,cachePool:null,transitions:null}}function L8(e,t,n){var s=t.pendingProps,i=Hs.current,c=!1,u=(t.flags&128)!==0,a;if((a=u)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(c=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),gs(Hs,i&1),e===null)return Dk(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(u=s.children,e=s.fallback,c?(s=t.mode,c=t.child,u={mode:"hidden",children:u},!(s&1)&&c!==null?(c.childLanes=0,c.pendingProps=u):c=HN(u,s,0,null),e=Pm(e,s,n,null),c.return=t,e.return=t,c.sibling=e,t.child=c,t.child.memoizedState=Vk(n),t.memoizedState=qk,e):uO(t,u));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return PJ(e,t,u,s,a,i,n);if(c){c=s.fallback,u=t.mode,i=e.child,a=i.sibling;var m={mode:"hidden",children:s.children};return!(u&1)&&t.child!==i?(s=t.child,s.childLanes=0,s.pendingProps=m,t.deletions=null):(s=zh(i,m),s.subtreeFlags=i.subtreeFlags&14680064),a!==null?c=zh(a,c):(c=Pm(c,u,n,null),c.flags|=2),c.return=t,s.return=t,s.sibling=c,t.child=s,s=c,c=t.child,u=e.child.memoizedState,u=u===null?Vk(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},c.memoizedState=u,c.childLanes=e.childLanes&~n,t.memoizedState=qk,s}return c=e.child,e=c.sibling,s=zh(c,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=n),s.return=t,s.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function uO(e,t){return t=HN({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Lw(e,t,n,s){return s!==null&&YM(s),vx(t,e.child,null,n),e=uO(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function PJ(e,t,n,s,i,c,u){if(n)return t.flags&256?(t.flags&=-257,s=JC(Error(qt(422))),Lw(e,t,u,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(c=s.fallback,i=t.mode,s=HN({mode:"visible",children:s.children},i,0,null),c=Pm(c,i,u,null),c.flags|=2,s.return=t,c.return=t,s.sibling=c,t.child=s,t.mode&1&&vx(t,e.child,null,u),t.child.memoizedState=Vk(u),t.memoizedState=qk,c);if(!(t.mode&1))return Lw(e,t,u,null);if(i.data==="$!"){if(s=i.nextSibling&&i.nextSibling.dataset,s)var a=s.dgst;return s=a,c=Error(qt(419)),s=JC(c,s,void 0),Lw(e,t,u,s)}if(a=(u&e.childLanes)!==0,po||a){if(s=na,s!==null){switch(u&-u){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(s.suspendedLanes|u)?0:i,i!==0&&i!==c.retryLane&&(c.retryLane=i,id(e,i),fc(s,e,i,-1))}return gO(),s=JC(Error(qt(421))),Lw(e,t,u,s)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=zJ.bind(null,e),i._reactRetry=t,null):(e=c.treeContext,Uo=Dh(i.nextSibling),Ko=t,Rs=!0,sc=null,e!==null&&(pl[gl++]=Uu,pl[gl++]=Wu,pl[gl++]=Em,Uu=e.id,Wu=e.overflow,Em=t),t=uO(t,s.children),t.flags|=4096,t)}function gL(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),Rk(e.return,t,n)}function eA(e,t,n,s,i){var c=e.memoizedState;c===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:i}:(c.isBackwards=t,c.rendering=null,c.renderingStartTime=0,c.last=s,c.tail=n,c.tailMode=i)}function F8(e,t,n){var s=t.pendingProps,i=s.revealOrder,c=s.tail;if(Ha(e,t,s.children,n),s=Hs.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&gL(e,n,t);else if(e.tag===19)gL(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(gs(Hs,s),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&Y1(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),eA(t,!1,i,n,c);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Y1(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}eA(t,!0,n,null,c);break;case"together":eA(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function w1(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ad(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Om|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(qt(153));if(t.child!==null){for(e=t.child,n=zh(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=zh(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function CJ(e,t,n){switch(t.tag){case 3:R8(t),yx();break;case 5:u8(t);break;case 1:vo(t.type)&&U1(t);break;case 4:rO(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,i=t.memoizedProps.value;gs(K1,s._currentValue),s._currentValue=i;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(gs(Hs,Hs.current&1),t.flags|=128,null):n&t.child.childLanes?L8(e,t,n):(gs(Hs,Hs.current&1),e=ad(e,t,n),e!==null?e.sibling:null);gs(Hs,Hs.current&1);break;case 19:if(s=(n&t.childLanes)!==0,e.flags&128){if(s)return F8(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),gs(Hs,Hs.current),s)break;return null;case 22:case 23:return t.lanes=0,I8(e,t,n)}return ad(e,t,n)}var z8,Uk,$8,B8;z8=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Uk=function(){};$8=function(e,t,n,s){var i=e.memoizedProps;if(i!==s){e=t.stateNode,dm(Wc.current);var c=null;switch(n){case"input":i=hk(e,i),s=hk(e,s),c=[];break;case"select":i=Js({},i,{value:void 0}),s=Js({},s,{value:void 0}),c=[];break;case"textarea":i=pk(e,i),s=pk(e,s),c=[];break;default:typeof i.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=q1)}xk(n,s);var u;n=null;for(p in i)if(!s.hasOwnProperty(p)&&i.hasOwnProperty(p)&&i[p]!=null)if(p==="style"){var a=i[p];for(u in a)a.hasOwnProperty(u)&&(n||(n={}),n[u]="")}else p!=="dangerouslySetInnerHTML"&&p!=="children"&&p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(o0.hasOwnProperty(p)?c||(c=[]):(c=c||[]).push(p,null));for(p in s){var m=s[p];if(a=i!=null?i[p]:void 0,s.hasOwnProperty(p)&&m!==a&&(m!=null||a!=null))if(p==="style")if(a){for(u in a)!a.hasOwnProperty(u)||m&&m.hasOwnProperty(u)||(n||(n={}),n[u]="");for(u in m)m.hasOwnProperty(u)&&a[u]!==m[u]&&(n||(n={}),n[u]=m[u])}else n||(c||(c=[]),c.push(p,n)),n=m;else p==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,a=a?a.__html:void 0,m!=null&&a!==m&&(c=c||[]).push(p,m)):p==="children"?typeof m!="string"&&typeof m!="number"||(c=c||[]).push(p,""+m):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&(o0.hasOwnProperty(p)?(m!=null&&p==="onScroll"&&js("scroll",e),c||a===m||(c=[])):(c=c||[]).push(p,m))}n&&(c=c||[]).push("style",n);var p=c;(t.updateQueue=p)&&(t.flags|=4)}};B8=function(e,t,n,s){n!==s&&(t.flags|=4)};function f_(e,t){if(!Rs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Ca(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,s|=i.subtreeFlags&14680064,s|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function AJ(e,t,n){var s=t.pendingProps;switch(ZM(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ca(t),null;case 1:return vo(t.type)&&V1(),Ca(t),null;case 3:return s=t.stateNode,_x(),Cs(yo),Cs(Ra),sO(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Dw(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,sc!==null&&(Qk(sc),sc=null))),Uk(e,t),Ca(t),null;case 5:nO(t);var i=dm(v0.current);if(n=t.type,e!==null&&t.stateNode!=null)$8(e,t,n,s,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(qt(166));return Ca(t),null}if(e=dm(Wc.current),Dw(t)){s=t.stateNode,n=t.type;var c=t.memoizedProps;switch(s[zc]=t,s[x0]=c,e=(t.mode&1)!==0,n){case"dialog":js("cancel",s),js("close",s);break;case"iframe":case"object":case"embed":js("load",s);break;case"video":case"audio":for(i=0;i<F_.length;i++)js(F_[i],s);break;case"source":js("error",s);break;case"img":case"image":case"link":js("error",s),js("load",s);break;case"details":js("toggle",s);break;case"input":N4(s,c),js("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!c.multiple},js("invalid",s);break;case"textarea":C4(s,c),js("invalid",s)}xk(n,c),i=null;for(var u in c)if(c.hasOwnProperty(u)){var a=c[u];u==="children"?typeof a=="string"?s.textContent!==a&&(c.suppressHydrationWarning!==!0&&Iw(s.textContent,a,e),i=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(c.suppressHydrationWarning!==!0&&Iw(s.textContent,a,e),i=["children",""+a]):o0.hasOwnProperty(u)&&a!=null&&u==="onScroll"&&js("scroll",s)}switch(n){case"input":Pw(s),P4(s,c,!0);break;case"textarea":Pw(s),A4(s);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(s.onclick=q1)}s=i,t.updateQueue=s,s!==null&&(t.flags|=4)}else{u=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=pB(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=u.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=u.createElement(n,{is:s.is}):(e=u.createElement(n),n==="select"&&(u=e,s.multiple?u.multiple=!0:s.size&&(u.size=s.size))):e=u.createElementNS(e,n),e[zc]=t,e[x0]=s,z8(e,t,!1,!1),t.stateNode=e;e:{switch(u=yk(n,s),n){case"dialog":js("cancel",e),js("close",e),i=s;break;case"iframe":case"object":case"embed":js("load",e),i=s;break;case"video":case"audio":for(i=0;i<F_.length;i++)js(F_[i],e);i=s;break;case"source":js("error",e),i=s;break;case"img":case"image":case"link":js("error",e),js("load",e),i=s;break;case"details":js("toggle",e),i=s;break;case"input":N4(e,s),i=hk(e,s),js("invalid",e);break;case"option":i=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},i=Js({},s,{value:void 0}),js("invalid",e);break;case"textarea":C4(e,s),i=pk(e,s),js("invalid",e);break;default:i=s}xk(n,i),a=i;for(c in a)if(a.hasOwnProperty(c)){var m=a[c];c==="style"?yB(e,m):c==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,m!=null&&gB(e,m)):c==="children"?typeof m=="string"?(n!=="textarea"||m!=="")&&l0(e,m):typeof m=="number"&&l0(e,""+m):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(o0.hasOwnProperty(c)?m!=null&&c==="onScroll"&&js("scroll",e):m!=null&&IM(e,c,m,u))}switch(n){case"input":Pw(e),P4(e,s,!1);break;case"textarea":Pw(e),A4(e);break;case"option":s.value!=null&&e.setAttribute("value",""+Uh(s.value));break;case"select":e.multiple=!!s.multiple,c=s.value,c!=null?Bg(e,!!s.multiple,c,!1):s.defaultValue!=null&&Bg(e,!!s.multiple,s.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=q1)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ca(t),null;case 6:if(e&&t.stateNode!=null)B8(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(qt(166));if(n=dm(v0.current),dm(Wc.current),Dw(t)){if(s=t.stateNode,n=t.memoizedProps,s[zc]=t,(c=s.nodeValue!==n)&&(e=Ko,e!==null))switch(e.tag){case 3:Iw(s.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Iw(s.nodeValue,n,(e.mode&1)!==0)}c&&(t.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[zc]=t,t.stateNode=s}return Ca(t),null;case 13:if(Cs(Hs),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Rs&&Uo!==null&&t.mode&1&&!(t.flags&128))i8(),yx(),t.flags|=98560,c=!1;else if(c=Dw(t),s!==null&&s.dehydrated!==null){if(e===null){if(!c)throw Error(qt(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(qt(317));c[zc]=t}else yx(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ca(t),c=!1}else sc!==null&&(Qk(sc),sc=null),c=!0;if(!c)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||Hs.current&1?Vi===0&&(Vi=3):gO())),t.updateQueue!==null&&(t.flags|=4),Ca(t),null);case 4:return _x(),Uk(e,t),e===null&&p0(t.stateNode.containerInfo),Ca(t),null;case 10:return JM(t.type._context),Ca(t),null;case 17:return vo(t.type)&&V1(),Ca(t),null;case 19:if(Cs(Hs),c=t.memoizedState,c===null)return Ca(t),null;if(s=(t.flags&128)!==0,u=c.rendering,u===null)if(s)f_(c,!1);else{if(Vi!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(u=Y1(e),u!==null){for(t.flags|=128,f_(c,!1),s=u.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;n!==null;)c=n,e=s,c.flags&=14680066,u=c.alternate,u===null?(c.childLanes=0,c.lanes=e,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=u.childLanes,c.lanes=u.lanes,c.child=u.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=u.memoizedProps,c.memoizedState=u.memoizedState,c.updateQueue=u.updateQueue,c.type=u.type,e=u.dependencies,c.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return gs(Hs,Hs.current&1|2),t.child}e=e.sibling}c.tail!==null&&mi()>jx&&(t.flags|=128,s=!0,f_(c,!1),t.lanes=4194304)}else{if(!s)if(e=Y1(u),e!==null){if(t.flags|=128,s=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),f_(c,!0),c.tail===null&&c.tailMode==="hidden"&&!u.alternate&&!Rs)return Ca(t),null}else 2*mi()-c.renderingStartTime>jx&&n!==1073741824&&(t.flags|=128,s=!0,f_(c,!1),t.lanes=4194304);c.isBackwards?(u.sibling=t.child,t.child=u):(n=c.last,n!==null?n.sibling=u:t.child=u,c.last=u)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=mi(),t.sibling=null,n=Hs.current,gs(Hs,s?n&1|2:n&1),t):(Ca(t),null);case 22:case 23:return pO(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?Fo&1073741824&&(Ca(t),t.subtreeFlags&6&&(t.flags|=8192)):Ca(t),null;case 24:return null;case 25:return null}throw Error(qt(156,t.tag))}function kJ(e,t){switch(ZM(t),t.tag){case 1:return vo(t.type)&&V1(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return _x(),Cs(yo),Cs(Ra),sO(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return nO(t),null;case 13:if(Cs(Hs),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(qt(340));yx()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Cs(Hs),null;case 4:return _x(),null;case 10:return JM(t.type._context),null;case 22:case 23:return pO(),null;case 24:return null;default:return null}}var Fw=!1,Ma=!1,TJ=typeof WeakSet=="function"?WeakSet:Set,jr=null;function Og(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){oi(e,t,s)}else n.current=null}function Wk(e,t,n){try{n()}catch(s){oi(e,t,s)}}var xL=!1;function EJ(e,t){if(Ak=z1,e=GB(),KM(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var i=s.anchorOffset,c=s.focusNode;s=s.focusOffset;try{n.nodeType,c.nodeType}catch{n=null;break e}var u=0,a=-1,m=-1,p=0,y=0,v=e,j=null;t:for(;;){for(var S;v!==n||i!==0&&v.nodeType!==3||(a=u+i),v!==c||s!==0&&v.nodeType!==3||(m=u+s),v.nodeType===3&&(u+=v.nodeValue.length),(S=v.firstChild)!==null;)j=v,v=S;for(;;){if(v===e)break t;if(j===n&&++p===i&&(a=u),j===c&&++y===s&&(m=u),(S=v.nextSibling)!==null)break;v=j,j=v.parentNode}v=S}n=a===-1||m===-1?null:{start:a,end:m}}else n=null}n=n||{start:0,end:0}}else n=null;for(kk={focusedElem:e,selectionRange:n},z1=!1,jr=t;jr!==null;)if(t=jr,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,jr=e;else for(;jr!==null;){t=jr;try{var k=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var N=k.memoizedProps,D=k.memoizedState,O=t.stateNode,T=O.getSnapshotBeforeUpdate(t.elementType===t.type?N:Jl(t.type,N),D);O.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var I=t.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(qt(163))}}catch(z){oi(t,t.return,z)}if(e=t.sibling,e!==null){e.return=t.return,jr=e;break}jr=t.return}return k=xL,xL=!1,k}function X_(e,t,n){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var i=s=s.next;do{if((i.tag&e)===e){var c=i.destroy;i.destroy=void 0,c!==void 0&&Wk(t,n,c)}i=i.next}while(i!==s)}}function GN(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function Gk(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function q8(e){var t=e.alternate;t!==null&&(e.alternate=null,q8(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[zc],delete t[x0],delete t[Mk],delete t[fJ],delete t[mJ])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function V8(e){return e.tag===5||e.tag===3||e.tag===4}function yL(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||V8(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Kk(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=q1));else if(s!==4&&(e=e.child,e!==null))for(Kk(e,t,n),e=e.sibling;e!==null;)Kk(e,t,n),e=e.sibling}function Hk(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Hk(e,t,n),e=e.sibling;e!==null;)Hk(e,t,n),e=e.sibling}var ga=null,tc=!1;function Jd(e,t,n){for(n=n.child;n!==null;)U8(e,t,n),n=n.sibling}function U8(e,t,n){if(Uc&&typeof Uc.onCommitFiberUnmount=="function")try{Uc.onCommitFiberUnmount(FN,n)}catch{}switch(n.tag){case 5:Ma||Og(n,t);case 6:var s=ga,i=tc;ga=null,Jd(e,t,n),ga=s,tc=i,ga!==null&&(tc?(e=ga,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):ga.removeChild(n.stateNode));break;case 18:ga!==null&&(tc?(e=ga,n=n.stateNode,e.nodeType===8?KC(e.parentNode,n):e.nodeType===1&&KC(e,n),h0(e)):KC(ga,n.stateNode));break;case 4:s=ga,i=tc,ga=n.stateNode.containerInfo,tc=!0,Jd(e,t,n),ga=s,tc=i;break;case 0:case 11:case 14:case 15:if(!Ma&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){i=s=s.next;do{var c=i,u=c.destroy;c=c.tag,u!==void 0&&(c&2||c&4)&&Wk(n,t,u),i=i.next}while(i!==s)}Jd(e,t,n);break;case 1:if(!Ma&&(Og(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){oi(n,t,a)}Jd(e,t,n);break;case 21:Jd(e,t,n);break;case 22:n.mode&1?(Ma=(s=Ma)||n.memoizedState!==null,Jd(e,t,n),Ma=s):Jd(e,t,n);break;default:Jd(e,t,n)}}function vL(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new TJ),t.forEach(function(s){var i=$J.bind(null,e,s);n.has(s)||(n.add(s),s.then(i,i))})}}function Zl(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var i=n[s];try{var c=e,u=t,a=u;e:for(;a!==null;){switch(a.tag){case 5:ga=a.stateNode,tc=!1;break e;case 3:ga=a.stateNode.containerInfo,tc=!0;break e;case 4:ga=a.stateNode.containerInfo,tc=!0;break e}a=a.return}if(ga===null)throw Error(qt(160));U8(c,u,i),ga=null,tc=!1;var m=i.alternate;m!==null&&(m.return=null),i.return=null}catch(p){oi(i,t,p)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)W8(t,e),t=t.sibling}function W8(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Zl(t,e),Oc(e),s&4){try{X_(3,e,e.return),GN(3,e)}catch(N){oi(e,e.return,N)}try{X_(5,e,e.return)}catch(N){oi(e,e.return,N)}}break;case 1:Zl(t,e),Oc(e),s&512&&n!==null&&Og(n,n.return);break;case 5:if(Zl(t,e),Oc(e),s&512&&n!==null&&Og(n,n.return),e.flags&32){var i=e.stateNode;try{l0(i,"")}catch(N){oi(e,e.return,N)}}if(s&4&&(i=e.stateNode,i!=null)){var c=e.memoizedProps,u=n!==null?n.memoizedProps:c,a=e.type,m=e.updateQueue;if(e.updateQueue=null,m!==null)try{a==="input"&&c.type==="radio"&&c.name!=null&&fB(i,c),yk(a,u);var p=yk(a,c);for(u=0;u<m.length;u+=2){var y=m[u],v=m[u+1];y==="style"?yB(i,v):y==="dangerouslySetInnerHTML"?gB(i,v):y==="children"?l0(i,v):IM(i,y,v,p)}switch(a){case"input":fk(i,c);break;case"textarea":mB(i,c);break;case"select":var j=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!c.multiple;var S=c.value;S!=null?Bg(i,!!c.multiple,S,!1):j!==!!c.multiple&&(c.defaultValue!=null?Bg(i,!!c.multiple,c.defaultValue,!0):Bg(i,!!c.multiple,c.multiple?[]:"",!1))}i[x0]=c}catch(N){oi(e,e.return,N)}}break;case 6:if(Zl(t,e),Oc(e),s&4){if(e.stateNode===null)throw Error(qt(162));i=e.stateNode,c=e.memoizedProps;try{i.nodeValue=c}catch(N){oi(e,e.return,N)}}break;case 3:if(Zl(t,e),Oc(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{h0(t.containerInfo)}catch(N){oi(e,e.return,N)}break;case 4:Zl(t,e),Oc(e);break;case 13:Zl(t,e),Oc(e),i=e.child,i.flags&8192&&(c=i.memoizedState!==null,i.stateNode.isHidden=c,!c||i.alternate!==null&&i.alternate.memoizedState!==null||(fO=mi())),s&4&&vL(e);break;case 22:if(y=n!==null&&n.memoizedState!==null,e.mode&1?(Ma=(p=Ma)||y,Zl(t,e),Ma=p):Zl(t,e),Oc(e),s&8192){if(p=e.memoizedState!==null,(e.stateNode.isHidden=p)&&!y&&e.mode&1)for(jr=e,y=e.child;y!==null;){for(v=jr=y;jr!==null;){switch(j=jr,S=j.child,j.tag){case 0:case 11:case 14:case 15:X_(4,j,j.return);break;case 1:Og(j,j.return);var k=j.stateNode;if(typeof k.componentWillUnmount=="function"){s=j,n=j.return;try{t=s,k.props=t.memoizedProps,k.state=t.memoizedState,k.componentWillUnmount()}catch(N){oi(s,n,N)}}break;case 5:Og(j,j.return);break;case 22:if(j.memoizedState!==null){bL(v);continue}}S!==null?(S.return=j,jr=S):bL(v)}y=y.sibling}e:for(y=null,v=e;;){if(v.tag===5){if(y===null){y=v;try{i=v.stateNode,p?(c=i.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(a=v.stateNode,m=v.memoizedProps.style,u=m!=null&&m.hasOwnProperty("display")?m.display:null,a.style.display=xB("display",u))}catch(N){oi(e,e.return,N)}}}else if(v.tag===6){if(y===null)try{v.stateNode.nodeValue=p?"":v.memoizedProps}catch(N){oi(e,e.return,N)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===e)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===e)break e;for(;v.sibling===null;){if(v.return===null||v.return===e)break e;y===v&&(y=null),v=v.return}y===v&&(y=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:Zl(t,e),Oc(e),s&4&&vL(e);break;case 21:break;default:Zl(t,e),Oc(e)}}function Oc(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(V8(n)){var s=n;break e}n=n.return}throw Error(qt(160))}switch(s.tag){case 5:var i=s.stateNode;s.flags&32&&(l0(i,""),s.flags&=-33);var c=yL(e);Hk(e,c,i);break;case 3:case 4:var u=s.stateNode.containerInfo,a=yL(e);Kk(e,a,u);break;default:throw Error(qt(161))}}catch(m){oi(e,e.return,m)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function MJ(e,t,n){jr=e,G8(e)}function G8(e,t,n){for(var s=(e.mode&1)!==0;jr!==null;){var i=jr,c=i.child;if(i.tag===22&&s){var u=i.memoizedState!==null||Fw;if(!u){var a=i.alternate,m=a!==null&&a.memoizedState!==null||Ma;a=Fw;var p=Ma;if(Fw=u,(Ma=m)&&!p)for(jr=i;jr!==null;)u=jr,m=u.child,u.tag===22&&u.memoizedState!==null?jL(i):m!==null?(m.return=u,jr=m):jL(i);for(;c!==null;)jr=c,G8(c),c=c.sibling;jr=i,Fw=a,Ma=p}_L(e)}else i.subtreeFlags&8772&&c!==null?(c.return=i,jr=c):_L(e)}}function _L(e){for(;jr!==null;){var t=jr;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ma||GN(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!Ma)if(n===null)s.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:Jl(t.type,n.memoizedProps);s.componentDidUpdate(i,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var c=t.updateQueue;c!==null&&sL(t,c,s);break;case 3:var u=t.updateQueue;if(u!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}sL(t,u,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var m=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":m.autoFocus&&n.focus();break;case"img":m.src&&(n.src=m.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var p=t.alternate;if(p!==null){var y=p.memoizedState;if(y!==null){var v=y.dehydrated;v!==null&&h0(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(qt(163))}Ma||t.flags&512&&Gk(t)}catch(j){oi(t,t.return,j)}}if(t===e){jr=null;break}if(n=t.sibling,n!==null){n.return=t.return,jr=n;break}jr=t.return}}function bL(e){for(;jr!==null;){var t=jr;if(t===e){jr=null;break}var n=t.sibling;if(n!==null){n.return=t.return,jr=n;break}jr=t.return}}function jL(e){for(;jr!==null;){var t=jr;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{GN(4,t)}catch(m){oi(t,n,m)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var i=t.return;try{s.componentDidMount()}catch(m){oi(t,i,m)}}var c=t.return;try{Gk(t)}catch(m){oi(t,c,m)}break;case 5:var u=t.return;try{Gk(t)}catch(m){oi(t,u,m)}}}catch(m){oi(t,t.return,m)}if(t===e){jr=null;break}var a=t.sibling;if(a!==null){a.return=t.return,jr=a;break}jr=t.return}}var OJ=Math.ceil,J1=gd.ReactCurrentDispatcher,dO=gd.ReactCurrentOwner,wl=gd.ReactCurrentBatchConfig,In=0,na=null,Ci=null,ya=0,Fo=0,Ig=sf(0),Vi=0,w0=null,Om=0,KN=0,hO=0,Q_=null,ho=null,fO=0,jx=1/0,zu=null,eS=!1,Zk=null,Lh=null,zw=!1,Ch=null,tS=0,J_=0,Yk=null,S1=-1,N1=0;function Ja(){return In&6?mi():S1!==-1?S1:S1=mi()}function Fh(e){return e.mode&1?In&2&&ya!==0?ya&-ya:gJ.transition!==null?(N1===0&&(N1=TB()),N1):(e=Yn,e!==0||(e=window.event,e=e===void 0?16:LB(e.type)),e):1}function fc(e,t,n,s){if(50<J_)throw J_=0,Yk=null,Error(qt(185));Ab(e,n,s),(!(In&2)||e!==na)&&(e===na&&(!(In&2)&&(KN|=n),Vi===4&&mh(e,ya)),_o(e,s),n===1&&In===0&&!(t.mode&1)&&(jx=mi()+500,VN&&af()))}function _o(e,t){var n=e.callbackNode;gQ(e,t);var s=F1(e,e===na?ya:0);if(s===0)n!==null&&E4(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(n!=null&&E4(n),t===1)e.tag===0?pJ(wL.bind(null,e)):r8(wL.bind(null,e)),dJ(function(){!(In&6)&&af()}),n=null;else{switch(EB(s)){case 1:n=zM;break;case 4:n=AB;break;case 16:n=L1;break;case 536870912:n=kB;break;default:n=L1}n=eq(n,K8.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function K8(e,t){if(S1=-1,N1=0,In&6)throw Error(qt(327));var n=e.callbackNode;if(Gg()&&e.callbackNode!==n)return null;var s=F1(e,e===na?ya:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=rS(e,s);else{t=s;var i=In;In|=2;var c=Z8();(na!==e||ya!==t)&&(zu=null,jx=mi()+500,Nm(e,t));do try{RJ();break}catch(a){H8(e,a)}while(!0);QM(),J1.current=c,In=i,Ci!==null?t=0:(na=null,ya=0,t=Vi)}if(t!==0){if(t===2&&(i=wk(e),i!==0&&(s=i,t=Xk(e,i))),t===1)throw n=w0,Nm(e,0),mh(e,s),_o(e,mi()),n;if(t===6)mh(e,s);else{if(i=e.current.alternate,!(s&30)&&!IJ(i)&&(t=rS(e,s),t===2&&(c=wk(e),c!==0&&(s=c,t=Xk(e,c))),t===1))throw n=w0,Nm(e,0),mh(e,s),_o(e,mi()),n;switch(e.finishedWork=i,e.finishedLanes=s,t){case 0:case 1:throw Error(qt(345));case 2:nm(e,ho,zu);break;case 3:if(mh(e,s),(s&130023424)===s&&(t=fO+500-mi(),10<t)){if(F1(e,0)!==0)break;if(i=e.suspendedLanes,(i&s)!==s){Ja(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Ek(nm.bind(null,e,ho,zu),t);break}nm(e,ho,zu);break;case 4:if(mh(e,s),(s&4194240)===s)break;for(t=e.eventTimes,i=-1;0<s;){var u=31-hc(s);c=1<<u,u=t[u],u>i&&(i=u),s&=~c}if(s=i,s=mi()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*OJ(s/1960))-s,10<s){e.timeoutHandle=Ek(nm.bind(null,e,ho,zu),s);break}nm(e,ho,zu);break;case 5:nm(e,ho,zu);break;default:throw Error(qt(329))}}}return _o(e,mi()),e.callbackNode===n?K8.bind(null,e):null}function Xk(e,t){var n=Q_;return e.current.memoizedState.isDehydrated&&(Nm(e,t).flags|=256),e=rS(e,t),e!==2&&(t=ho,ho=n,t!==null&&Qk(t)),e}function Qk(e){ho===null?ho=e:ho.push.apply(ho,e)}function IJ(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var i=n[s],c=i.getSnapshot;i=i.value;try{if(!xc(c(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function mh(e,t){for(t&=~hO,t&=~KN,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-hc(t),s=1<<n;e[n]=-1,t&=~s}}function wL(e){if(In&6)throw Error(qt(327));Gg();var t=F1(e,0);if(!(t&1))return _o(e,mi()),null;var n=rS(e,t);if(e.tag!==0&&n===2){var s=wk(e);s!==0&&(t=s,n=Xk(e,s))}if(n===1)throw n=w0,Nm(e,0),mh(e,t),_o(e,mi()),n;if(n===6)throw Error(qt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,nm(e,ho,zu),_o(e,mi()),null}function mO(e,t){var n=In;In|=1;try{return e(t)}finally{In=n,In===0&&(jx=mi()+500,VN&&af())}}function Im(e){Ch!==null&&Ch.tag===0&&!(In&6)&&Gg();var t=In;In|=1;var n=wl.transition,s=Yn;try{if(wl.transition=null,Yn=1,e)return e()}finally{Yn=s,wl.transition=n,In=t,!(In&6)&&af()}}function pO(){Fo=Ig.current,Cs(Ig)}function Nm(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,uJ(n)),Ci!==null)for(n=Ci.return;n!==null;){var s=n;switch(ZM(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&V1();break;case 3:_x(),Cs(yo),Cs(Ra),sO();break;case 5:nO(s);break;case 4:_x();break;case 13:Cs(Hs);break;case 19:Cs(Hs);break;case 10:JM(s.type._context);break;case 22:case 23:pO()}n=n.return}if(na=e,Ci=e=zh(e.current,null),ya=Fo=t,Vi=0,w0=null,hO=KN=Om=0,ho=Q_=null,um!==null){for(t=0;t<um.length;t++)if(n=um[t],s=n.interleaved,s!==null){n.interleaved=null;var i=s.next,c=n.pending;if(c!==null){var u=c.next;c.next=i,s.next=u}n.pending=s}um=null}return e}function H8(e,t){do{var n=Ci;try{if(QM(),b1.current=Q1,X1){for(var s=Xs.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}X1=!1}if(Mm=0,ta=$i=Xs=null,Y_=!1,_0=0,dO.current=null,n===null||n.return===null){Vi=1,w0=t,Ci=null;break}e:{var c=e,u=n.return,a=n,m=t;if(t=ya,a.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){var p=m,y=a,v=y.tag;if(!(y.mode&1)&&(v===0||v===11||v===15)){var j=y.alternate;j?(y.updateQueue=j.updateQueue,y.memoizedState=j.memoizedState,y.lanes=j.lanes):(y.updateQueue=null,y.memoizedState=null)}var S=uL(u);if(S!==null){S.flags&=-257,dL(S,u,a,c,t),S.mode&1&&cL(c,p,t),t=S,m=p;var k=t.updateQueue;if(k===null){var N=new Set;N.add(m),t.updateQueue=N}else k.add(m);break e}else{if(!(t&1)){cL(c,p,t),gO();break e}m=Error(qt(426))}}else if(Rs&&a.mode&1){var D=uL(u);if(D!==null){!(D.flags&65536)&&(D.flags|=256),dL(D,u,a,c,t),YM(bx(m,a));break e}}c=m=bx(m,a),Vi!==4&&(Vi=2),Q_===null?Q_=[c]:Q_.push(c),c=u;do{switch(c.tag){case 3:c.flags|=65536,t&=-t,c.lanes|=t;var O=E8(c,m,t);nL(c,O);break e;case 1:a=m;var T=c.type,I=c.stateNode;if(!(c.flags&128)&&(typeof T.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(Lh===null||!Lh.has(I)))){c.flags|=65536,t&=-t,c.lanes|=t;var z=M8(c,a,t);nL(c,z);break e}}c=c.return}while(c!==null)}X8(n)}catch($){t=$,Ci===n&&n!==null&&(Ci=n=n.return);continue}break}while(!0)}function Z8(){var e=J1.current;return J1.current=Q1,e===null?Q1:e}function gO(){(Vi===0||Vi===3||Vi===2)&&(Vi=4),na===null||!(Om&268435455)&&!(KN&268435455)||mh(na,ya)}function rS(e,t){var n=In;In|=2;var s=Z8();(na!==e||ya!==t)&&(zu=null,Nm(e,t));do try{DJ();break}catch(i){H8(e,i)}while(!0);if(QM(),In=n,J1.current=s,Ci!==null)throw Error(qt(261));return na=null,ya=0,Vi}function DJ(){for(;Ci!==null;)Y8(Ci)}function RJ(){for(;Ci!==null&&!oQ();)Y8(Ci)}function Y8(e){var t=J8(e.alternate,e,Fo);e.memoizedProps=e.pendingProps,t===null?X8(e):Ci=t,dO.current=null}function X8(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=kJ(n,t),n!==null){n.flags&=32767,Ci=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Vi=6,Ci=null;return}}else if(n=AJ(n,t,Fo),n!==null){Ci=n;return}if(t=t.sibling,t!==null){Ci=t;return}Ci=t=e}while(t!==null);Vi===0&&(Vi=5)}function nm(e,t,n){var s=Yn,i=wl.transition;try{wl.transition=null,Yn=1,LJ(e,t,n,s)}finally{wl.transition=i,Yn=s}return null}function LJ(e,t,n,s){do Gg();while(Ch!==null);if(In&6)throw Error(qt(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(qt(177));e.callbackNode=null,e.callbackPriority=0;var c=n.lanes|n.childLanes;if(xQ(e,c),e===na&&(Ci=na=null,ya=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||zw||(zw=!0,eq(L1,function(){return Gg(),null})),c=(n.flags&15990)!==0,n.subtreeFlags&15990||c){c=wl.transition,wl.transition=null;var u=Yn;Yn=1;var a=In;In|=4,dO.current=null,EJ(e,n),W8(n,e),nJ(kk),z1=!!Ak,kk=Ak=null,e.current=n,MJ(n),lQ(),In=a,Yn=u,wl.transition=c}else e.current=n;if(zw&&(zw=!1,Ch=e,tS=i),c=e.pendingLanes,c===0&&(Lh=null),dQ(n.stateNode),_o(e,mi()),t!==null)for(s=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],s(i.value,{componentStack:i.stack,digest:i.digest});if(eS)throw eS=!1,e=Zk,Zk=null,e;return tS&1&&e.tag!==0&&Gg(),c=e.pendingLanes,c&1?e===Yk?J_++:(J_=0,Yk=e):J_=0,af(),null}function Gg(){if(Ch!==null){var e=EB(tS),t=wl.transition,n=Yn;try{if(wl.transition=null,Yn=16>e?16:e,Ch===null)var s=!1;else{if(e=Ch,Ch=null,tS=0,In&6)throw Error(qt(331));var i=In;for(In|=4,jr=e.current;jr!==null;){var c=jr,u=c.child;if(jr.flags&16){var a=c.deletions;if(a!==null){for(var m=0;m<a.length;m++){var p=a[m];for(jr=p;jr!==null;){var y=jr;switch(y.tag){case 0:case 11:case 15:X_(8,y,c)}var v=y.child;if(v!==null)v.return=y,jr=v;else for(;jr!==null;){y=jr;var j=y.sibling,S=y.return;if(q8(y),y===p){jr=null;break}if(j!==null){j.return=S,jr=j;break}jr=S}}}var k=c.alternate;if(k!==null){var N=k.child;if(N!==null){k.child=null;do{var D=N.sibling;N.sibling=null,N=D}while(N!==null)}}jr=c}}if(c.subtreeFlags&2064&&u!==null)u.return=c,jr=u;else e:for(;jr!==null;){if(c=jr,c.flags&2048)switch(c.tag){case 0:case 11:case 15:X_(9,c,c.return)}var O=c.sibling;if(O!==null){O.return=c.return,jr=O;break e}jr=c.return}}var T=e.current;for(jr=T;jr!==null;){u=jr;var I=u.child;if(u.subtreeFlags&2064&&I!==null)I.return=u,jr=I;else e:for(u=T;jr!==null;){if(a=jr,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:GN(9,a)}}catch($){oi(a,a.return,$)}if(a===u){jr=null;break e}var z=a.sibling;if(z!==null){z.return=a.return,jr=z;break e}jr=a.return}}if(In=i,af(),Uc&&typeof Uc.onPostCommitFiberRoot=="function")try{Uc.onPostCommitFiberRoot(FN,e)}catch{}s=!0}return s}finally{Yn=n,wl.transition=t}}return!1}function SL(e,t,n){t=bx(n,t),t=E8(e,t,1),e=Rh(e,t,1),t=Ja(),e!==null&&(Ab(e,1,t),_o(e,t))}function oi(e,t,n){if(e.tag===3)SL(e,e,n);else for(;t!==null;){if(t.tag===3){SL(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Lh===null||!Lh.has(s))){e=bx(n,e),e=M8(t,e,1),t=Rh(t,e,1),e=Ja(),t!==null&&(Ab(t,1,e),_o(t,e));break}}t=t.return}}function FJ(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),t=Ja(),e.pingedLanes|=e.suspendedLanes&n,na===e&&(ya&n)===n&&(Vi===4||Vi===3&&(ya&130023424)===ya&&500>mi()-fO?Nm(e,0):hO|=n),_o(e,t)}function Q8(e,t){t===0&&(e.mode&1?(t=kw,kw<<=1,!(kw&130023424)&&(kw=4194304)):t=1);var n=Ja();e=id(e,t),e!==null&&(Ab(e,t,n),_o(e,n))}function zJ(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Q8(e,n)}function $J(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(qt(314))}s!==null&&s.delete(t),Q8(e,n)}var J8;J8=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||yo.current)po=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return po=!1,CJ(e,t,n);po=!!(e.flags&131072)}else po=!1,Rs&&t.flags&1048576&&n8(t,G1,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;w1(e,t),e=t.pendingProps;var i=xx(t,Ra.current);Wg(t,n),i=aO(null,t,s,e,i,n);var c=oO();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,vo(s)?(c=!0,U1(t)):c=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,tO(t),i.updater=WN,t.stateNode=i,i._reactInternals=t,Fk(t,s,e,n),t=Bk(null,t,s,!0,c,n)):(t.tag=0,Rs&&c&&HM(t),Ha(null,t,i,n),t=t.child),t;case 16:s=t.elementType;e:{switch(w1(e,t),e=t.pendingProps,i=s._init,s=i(s._payload),t.type=s,i=t.tag=qJ(s),e=Jl(s,e),i){case 0:t=$k(null,t,s,e,n);break e;case 1:t=mL(null,t,s,e,n);break e;case 11:t=hL(null,t,s,e,n);break e;case 14:t=fL(null,t,s,Jl(s.type,e),n);break e}throw Error(qt(306,s,""))}return t;case 0:return s=t.type,i=t.pendingProps,i=t.elementType===s?i:Jl(s,i),$k(e,t,s,i,n);case 1:return s=t.type,i=t.pendingProps,i=t.elementType===s?i:Jl(s,i),mL(e,t,s,i,n);case 3:e:{if(R8(t),e===null)throw Error(qt(387));s=t.pendingProps,c=t.memoizedState,i=c.element,c8(e,t),Z1(t,s,null,n);var u=t.memoizedState;if(s=u.element,c.isDehydrated)if(c={element:s,isDehydrated:!1,cache:u.cache,pendingSuspenseBoundaries:u.pendingSuspenseBoundaries,transitions:u.transitions},t.updateQueue.baseState=c,t.memoizedState=c,t.flags&256){i=bx(Error(qt(423)),t),t=pL(e,t,s,n,i);break e}else if(s!==i){i=bx(Error(qt(424)),t),t=pL(e,t,s,n,i);break e}else for(Uo=Dh(t.stateNode.containerInfo.firstChild),Ko=t,Rs=!0,sc=null,n=o8(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(yx(),s===i){t=ad(e,t,n);break e}Ha(e,t,s,n)}t=t.child}return t;case 5:return u8(t),e===null&&Dk(t),s=t.type,i=t.pendingProps,c=e!==null?e.memoizedProps:null,u=i.children,Tk(s,i)?u=null:c!==null&&Tk(s,c)&&(t.flags|=32),D8(e,t),Ha(e,t,u,n),t.child;case 6:return e===null&&Dk(t),null;case 13:return L8(e,t,n);case 4:return rO(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=vx(t,null,s,n):Ha(e,t,s,n),t.child;case 11:return s=t.type,i=t.pendingProps,i=t.elementType===s?i:Jl(s,i),hL(e,t,s,i,n);case 7:return Ha(e,t,t.pendingProps,n),t.child;case 8:return Ha(e,t,t.pendingProps.children,n),t.child;case 12:return Ha(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(s=t.type._context,i=t.pendingProps,c=t.memoizedProps,u=i.value,gs(K1,s._currentValue),s._currentValue=u,c!==null)if(xc(c.value,u)){if(c.children===i.children&&!yo.current){t=ad(e,t,n);break e}}else for(c=t.child,c!==null&&(c.return=t);c!==null;){var a=c.dependencies;if(a!==null){u=c.child;for(var m=a.firstContext;m!==null;){if(m.context===s){if(c.tag===1){m=Yu(-1,n&-n),m.tag=2;var p=c.updateQueue;if(p!==null){p=p.shared;var y=p.pending;y===null?m.next=m:(m.next=y.next,y.next=m),p.pending=m}}c.lanes|=n,m=c.alternate,m!==null&&(m.lanes|=n),Rk(c.return,n,t),a.lanes|=n;break}m=m.next}}else if(c.tag===10)u=c.type===t.type?null:c.child;else if(c.tag===18){if(u=c.return,u===null)throw Error(qt(341));u.lanes|=n,a=u.alternate,a!==null&&(a.lanes|=n),Rk(u,n,t),u=c.sibling}else u=c.child;if(u!==null)u.return=c;else for(u=c;u!==null;){if(u===t){u=null;break}if(c=u.sibling,c!==null){c.return=u.return,u=c;break}u=u.return}c=u}Ha(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,s=t.pendingProps.children,Wg(t,n),i=Nl(i),s=s(i),t.flags|=1,Ha(e,t,s,n),t.child;case 14:return s=t.type,i=Jl(s,t.pendingProps),i=Jl(s.type,i),fL(e,t,s,i,n);case 15:return O8(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,i=t.pendingProps,i=t.elementType===s?i:Jl(s,i),w1(e,t),t.tag=1,vo(s)?(e=!0,U1(t)):e=!1,Wg(t,n),T8(t,s,i),Fk(t,s,i,n),Bk(null,t,s,!0,e,n);case 19:return F8(e,t,n);case 22:return I8(e,t,n)}throw Error(qt(156,t.tag))};function eq(e,t){return CB(e,t)}function BJ(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bl(e,t,n,s){return new BJ(e,t,n,s)}function xO(e){return e=e.prototype,!(!e||!e.isReactComponent)}function qJ(e){if(typeof e=="function")return xO(e)?1:0;if(e!=null){if(e=e.$$typeof,e===RM)return 11;if(e===LM)return 14}return 2}function zh(e,t){var n=e.alternate;return n===null?(n=bl(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function P1(e,t,n,s,i,c){var u=2;if(s=e,typeof e=="function")xO(e)&&(u=1);else if(typeof e=="string")u=5;else e:switch(e){case Sg:return Pm(n.children,i,c,t);case DM:u=8,i|=8;break;case lk:return e=bl(12,n,t,i|2),e.elementType=lk,e.lanes=c,e;case ck:return e=bl(13,n,t,i),e.elementType=ck,e.lanes=c,e;case uk:return e=bl(19,n,t,i),e.elementType=uk,e.lanes=c,e;case uB:return HN(n,i,c,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case lB:u=10;break e;case cB:u=9;break e;case RM:u=11;break e;case LM:u=14;break e;case ch:u=16,s=null;break e}throw Error(qt(130,e==null?e:typeof e,""))}return t=bl(u,n,t,i),t.elementType=e,t.type=s,t.lanes=c,t}function Pm(e,t,n,s){return e=bl(7,e,s,t),e.lanes=n,e}function HN(e,t,n,s){return e=bl(22,e,s,t),e.elementType=uB,e.lanes=n,e.stateNode={isHidden:!1},e}function tA(e,t,n){return e=bl(6,e,null,t),e.lanes=n,e}function rA(e,t,n){return t=bl(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function VJ(e,t,n,s,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=RC(0),this.expirationTimes=RC(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=RC(0),this.identifierPrefix=s,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function yO(e,t,n,s,i,c,u,a,m){return e=new VJ(e,t,n,a,m),t===1?(t=1,c===!0&&(t|=8)):t=0,c=bl(3,null,null,t),e.current=c,c.stateNode=e,c.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},tO(c),e}function UJ(e,t,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wg,key:s==null?null:""+s,children:e,containerInfo:t,implementation:n}}function tq(e){if(!e)return Wh;e=e._reactInternals;e:{if(Xm(e)!==e||e.tag!==1)throw Error(qt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(vo(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(qt(171))}if(e.tag===1){var n=e.type;if(vo(n))return t8(e,n,t)}return t}function rq(e,t,n,s,i,c,u,a,m){return e=yO(n,s,!0,e,i,c,u,a,m),e.context=tq(null),n=e.current,s=Ja(),i=Fh(n),c=Yu(s,i),c.callback=t??null,Rh(n,c,i),e.current.lanes=i,Ab(e,i,s),_o(e,s),e}function ZN(e,t,n,s){var i=t.current,c=Ja(),u=Fh(i);return n=tq(n),t.context===null?t.context=n:t.pendingContext=n,t=Yu(c,u),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=Rh(i,t,u),e!==null&&(fc(e,i,u,c),_1(e,i,u)),u}function nS(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function NL(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function vO(e,t){NL(e,t),(e=e.alternate)&&NL(e,t)}function WJ(){return null}var nq=typeof reportError=="function"?reportError:function(e){console.error(e)};function _O(e){this._internalRoot=e}YN.prototype.render=_O.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(qt(409));ZN(e,t,null,null)};YN.prototype.unmount=_O.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Im(function(){ZN(null,e,null,null)}),t[sd]=null}};function YN(e){this._internalRoot=e}YN.prototype.unstable_scheduleHydration=function(e){if(e){var t=IB();e={blockedOn:null,target:e,priority:t};for(var n=0;n<fh.length&&t!==0&&t<fh[n].priority;n++);fh.splice(n,0,e),n===0&&RB(e)}};function bO(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function XN(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function PL(){}function GJ(e,t,n,s,i){if(i){if(typeof s=="function"){var c=s;s=function(){var p=nS(u);c.call(p)}}var u=rq(t,s,e,0,null,!1,!1,"",PL);return e._reactRootContainer=u,e[sd]=u.current,p0(e.nodeType===8?e.parentNode:e),Im(),u}for(;i=e.lastChild;)e.removeChild(i);if(typeof s=="function"){var a=s;s=function(){var p=nS(m);a.call(p)}}var m=yO(e,0,!1,null,null,!1,!1,"",PL);return e._reactRootContainer=m,e[sd]=m.current,p0(e.nodeType===8?e.parentNode:e),Im(function(){ZN(t,m,n,s)}),m}function QN(e,t,n,s,i){var c=n._reactRootContainer;if(c){var u=c;if(typeof i=="function"){var a=i;i=function(){var m=nS(u);a.call(m)}}ZN(t,u,e,i)}else u=GJ(n,t,e,i,s);return nS(u)}MB=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=L_(t.pendingLanes);n!==0&&($M(t,n|1),_o(t,mi()),!(In&6)&&(jx=mi()+500,af()))}break;case 13:Im(function(){var s=id(e,1);if(s!==null){var i=Ja();fc(s,e,1,i)}}),vO(e,1)}};BM=function(e){if(e.tag===13){var t=id(e,134217728);if(t!==null){var n=Ja();fc(t,e,134217728,n)}vO(e,134217728)}};OB=function(e){if(e.tag===13){var t=Fh(e),n=id(e,t);if(n!==null){var s=Ja();fc(n,e,t,s)}vO(e,t)}};IB=function(){return Yn};DB=function(e,t){var n=Yn;try{return Yn=e,t()}finally{Yn=n}};_k=function(e,t,n){switch(t){case"input":if(fk(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var i=qN(s);if(!i)throw Error(qt(90));hB(s),fk(s,i)}}}break;case"textarea":mB(e,n);break;case"select":t=n.value,t!=null&&Bg(e,!!n.multiple,t,!1)}};bB=mO;jB=Im;var KJ={usingClientEntryPoint:!1,Events:[Tb,Ag,qN,vB,_B,mO]},m_={findFiberByHostInstance:cm,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},HJ={bundleType:m_.bundleType,version:m_.version,rendererPackageName:m_.rendererPackageName,rendererConfig:m_.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gd.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=NB(e),e===null?null:e.stateNode},findFiberByHostInstance:m_.findFiberByHostInstance||WJ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $w=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$w.isDisabled&&$w.supportsFiber)try{FN=$w.inject(HJ),Uc=$w}catch{}}el.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KJ;el.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bO(t))throw Error(qt(200));return UJ(e,t,null,n)};el.createRoot=function(e,t){if(!bO(e))throw Error(qt(299));var n=!1,s="",i=nq;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=yO(e,1,!1,null,null,n,!1,s,i),e[sd]=t.current,p0(e.nodeType===8?e.parentNode:e),new _O(t)};el.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(qt(188)):(e=Object.keys(e).join(","),Error(qt(268,e)));return e=NB(t),e=e===null?null:e.stateNode,e};el.flushSync=function(e){return Im(e)};el.hydrate=function(e,t,n){if(!XN(t))throw Error(qt(200));return QN(null,e,t,!0,n)};el.hydrateRoot=function(e,t,n){if(!bO(e))throw Error(qt(405));var s=n!=null&&n.hydratedSources||null,i=!1,c="",u=nq;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onRecoverableError!==void 0&&(u=n.onRecoverableError)),t=rq(t,null,e,1,n??null,i,!1,c,u),e[sd]=t.current,p0(e),s)for(e=0;e<s.length;e++)n=s[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new YN(t)};el.render=function(e,t,n){if(!XN(t))throw Error(qt(200));return QN(null,e,t,!1,n)};el.unmountComponentAtNode=function(e){if(!XN(e))throw Error(qt(40));return e._reactRootContainer?(Im(function(){QN(null,null,e,!1,function(){e._reactRootContainer=null,e[sd]=null})}),!0):!1};el.unstable_batchedUpdates=mO;el.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!XN(n))throw Error(qt(200));if(e==null||e._reactInternals===void 0)throw Error(qt(38));return QN(e,t,n,!1,s)};el.version="18.3.1-next-f1338f8080-20240426";function sq(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sq)}catch(e){console.error(e)}}sq(),sB.exports=el;var of=sB.exports;const iq=Fn(of);var aq,CL=of;aq=CL.createRoot,CL.hydrateRoot;var gy=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Dm=typeof window>"u"||"Deno"in globalThis;function ml(){}function ZJ(e,t){return typeof e=="function"?e(t):e}function Jk(e){return typeof e=="number"&&e>=0&&e!==1/0}function oq(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Kg(e,t){return typeof e=="function"?e(t):e}function ic(e,t){return typeof e=="function"?e(t):e}function AL(e,t){const{type:n="all",exact:s,fetchStatus:i,predicate:c,queryKey:u,stale:a}=e;if(u){if(s){if(t.queryHash!==jO(u,t.options))return!1}else if(!S0(t.queryKey,u))return!1}if(n!=="all"){const m=t.isActive();if(n==="active"&&!m||n==="inactive"&&m)return!1}return!(typeof a=="boolean"&&t.isStale()!==a||i&&i!==t.state.fetchStatus||c&&!c(t))}function kL(e,t){const{exact:n,status:s,predicate:i,mutationKey:c}=e;if(c){if(!t.options.mutationKey)return!1;if(n){if(Rm(t.options.mutationKey)!==Rm(c))return!1}else if(!S0(t.options.mutationKey,c))return!1}return!(s&&t.state.status!==s||i&&!i(t))}function jO(e,t){return((t==null?void 0:t.queryKeyHashFn)||Rm)(e)}function Rm(e){return JSON.stringify(e,(t,n)=>eT(n)?Object.keys(n).sort().reduce((s,i)=>(s[i]=n[i],s),{}):n)}function S0(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(n=>!S0(e[n],t[n])):!1}function lq(e,t){if(e===t)return e;const n=TL(e)&&TL(t);if(n||eT(e)&&eT(t)){const s=n?e:Object.keys(e),i=s.length,c=n?t:Object.keys(t),u=c.length,a=n?[]:{};let m=0;for(let p=0;p<u;p++){const y=n?p:c[p];(!n&&s.includes(y)||n)&&e[y]===void 0&&t[y]===void 0?(a[y]=void 0,m++):(a[y]=lq(e[y],t[y]),a[y]===e[y]&&e[y]!==void 0&&m++)}return i===u&&m===i?e:a}return t}function sS(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function TL(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function eT(e){if(!EL(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!EL(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function EL(e){return Object.prototype.toString.call(e)==="[object Object]"}function YJ(e){return new Promise(t=>{setTimeout(t,e)})}function tT(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?lq(e,t):t}function XJ(e,t,n=0){const s=[...e,t];return n&&s.length>n?s.slice(1):s}function QJ(e,t,n=0){const s=[t,...e];return n&&s.length>n?s.slice(0,-1):s}var wO=Symbol();function cq(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===wO?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var ym,xh,nx,D6,JJ=(D6=class extends gy{constructor(){super();Vr(this,ym);Vr(this,xh);Vr(this,nx);gr(this,nx,t=>{if(!Dm&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){Ze(this,xh)||this.setEventListener(Ze(this,nx))}onUnsubscribe(){var t;this.hasListeners()||((t=Ze(this,xh))==null||t.call(this),gr(this,xh,void 0))}setEventListener(t){var n;gr(this,nx,t),(n=Ze(this,xh))==null||n.call(this),gr(this,xh,t(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(t){Ze(this,ym)!==t&&(gr(this,ym,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof Ze(this,ym)=="boolean"?Ze(this,ym):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},ym=new WeakMap,xh=new WeakMap,nx=new WeakMap,D6),SO=new JJ,sx,yh,ix,R6,eee=(R6=class extends gy{constructor(){super();Vr(this,sx,!0);Vr(this,yh);Vr(this,ix);gr(this,ix,t=>{if(!Dm&&window.addEventListener){const n=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){Ze(this,yh)||this.setEventListener(Ze(this,ix))}onUnsubscribe(){var t;this.hasListeners()||((t=Ze(this,yh))==null||t.call(this),gr(this,yh,void 0))}setEventListener(t){var n;gr(this,ix,t),(n=Ze(this,yh))==null||n.call(this),gr(this,yh,t(this.setOnline.bind(this)))}setOnline(t){Ze(this,sx)!==t&&(gr(this,sx,t),this.listeners.forEach(s=>{s(t)}))}isOnline(){return Ze(this,sx)}},sx=new WeakMap,yh=new WeakMap,ix=new WeakMap,R6),iS=new eee;function rT(){let e,t;const n=new Promise((i,c)=>{e=i,t=c});n.status="pending",n.catch(()=>{});function s(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{s({status:"fulfilled",value:i}),e(i)},n.reject=i=>{s({status:"rejected",reason:i}),t(i)},n}function tee(e){return Math.min(1e3*2**e,3e4)}function uq(e){return(e??"online")==="online"?iS.isOnline():!0}var dq=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function nA(e){return e instanceof dq}function hq(e){let t=!1,n=0,s=!1,i;const c=rT(),u=N=>{var D;s||(j(new dq(N)),(D=e.abort)==null||D.call(e))},a=()=>{t=!0},m=()=>{t=!1},p=()=>SO.isFocused()&&(e.networkMode==="always"||iS.isOnline())&&e.canRun(),y=()=>uq(e.networkMode)&&e.canRun(),v=N=>{var D;s||(s=!0,(D=e.onSuccess)==null||D.call(e,N),i==null||i(),c.resolve(N))},j=N=>{var D;s||(s=!0,(D=e.onError)==null||D.call(e,N),i==null||i(),c.reject(N))},S=()=>new Promise(N=>{var D;i=O=>{(s||p())&&N(O)},(D=e.onPause)==null||D.call(e)}).then(()=>{var N;i=void 0,s||(N=e.onContinue)==null||N.call(e)}),k=()=>{if(s)return;let N;const D=n===0?e.initialPromise:void 0;try{N=D??e.fn()}catch(O){N=Promise.reject(O)}Promise.resolve(N).then(v).catch(O=>{var V;if(s)return;const T=e.retry??(Dm?0:3),I=e.retryDelay??tee,z=typeof I=="function"?I(n,O):I,$=T===!0||typeof T=="number"&&n<T||typeof T=="function"&&T(n,O);if(t||!$){j(O);return}n++,(V=e.onFail)==null||V.call(e,n,O),YJ(z).then(()=>p()?void 0:S()).then(()=>{t?j(O):k()})})};return{promise:c,cancel:u,continue:()=>(i==null||i(),c),cancelRetry:a,continueRetry:m,canStart:y,start:()=>(y()?k():S().then(k),c)}}function ree(){let e=[],t=0,n=a=>{a()},s=a=>{a()},i=a=>setTimeout(a,0);const c=a=>{t?e.push(a):i(()=>{n(a)})},u=()=>{const a=e;e=[],a.length&&i(()=>{s(()=>{a.forEach(m=>{n(m)})})})};return{batch:a=>{let m;t++;try{m=a()}finally{t--,t||u()}return m},batchCalls:a=>(...m)=>{c(()=>{a(...m)})},schedule:c,setNotifyFunction:a=>{n=a},setBatchNotifyFunction:a=>{s=a},setScheduler:a=>{i=a}}}var Bi=ree(),vm,L6,fq=(L6=class{constructor(){Vr(this,vm)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Jk(this.gcTime)&&gr(this,vm,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Dm?1/0:5*60*1e3))}clearGcTimeout(){Ze(this,vm)&&(clearTimeout(Ze(this,vm)),gr(this,vm,void 0))}},vm=new WeakMap,L6),ax,ox,fl,ka,wb,_m,ec,Fu,F6,nee=(F6=class extends fq{constructor(t){super();Vr(this,ec);Vr(this,ax);Vr(this,ox);Vr(this,fl);Vr(this,ka);Vr(this,wb);Vr(this,_m);gr(this,_m,!1),gr(this,wb,t.defaultOptions),this.setOptions(t.options),this.observers=[],gr(this,fl,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,gr(this,ax,see(this.options)),this.state=t.state??Ze(this,ax),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=Ze(this,ka))==null?void 0:t.promise}setOptions(t){this.options={...Ze(this,wb),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Ze(this,fl).remove(this)}setData(t,n){const s=tT(this.state.data,t,this.options);return pn(this,ec,Fu).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(t,n){pn(this,ec,Fu).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var s,i;const n=(s=Ze(this,ka))==null?void 0:s.promise;return(i=Ze(this,ka))==null||i.cancel(t),n?n.then(ml).catch(ml):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Ze(this,ax))}isActive(){return this.observers.some(t=>ic(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===wO||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!oq(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(s=>s.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=Ze(this,ka))==null||n.continue()}onOnline(){var n;const t=this.observers.find(s=>s.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=Ze(this,ka))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),Ze(this,fl).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(Ze(this,ka)&&(Ze(this,_m)?Ze(this,ka).cancel({revert:!0}):Ze(this,ka).cancelRetry()),this.scheduleGc()),Ze(this,fl).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||pn(this,ec,Fu).call(this,{type:"invalidate"})}fetch(t,n){var m,p,y;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(Ze(this,ka))return Ze(this,ka).continueRetry(),Ze(this,ka).promise}if(t&&this.setOptions(t),!this.options.queryFn){const v=this.observers.find(j=>j.options.queryFn);v&&this.setOptions(v.options)}const s=new AbortController,i=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(gr(this,_m,!0),s.signal)})},c=()=>{const v=cq(this.options,n),j={queryKey:this.queryKey,meta:this.meta};return i(j),gr(this,_m,!1),this.options.persister?this.options.persister(v,j,this):v(j)},u={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:c};i(u),(m=this.options.behavior)==null||m.onFetch(u,this),gr(this,ox,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((p=u.fetchOptions)==null?void 0:p.meta))&&pn(this,ec,Fu).call(this,{type:"fetch",meta:(y=u.fetchOptions)==null?void 0:y.meta});const a=v=>{var j,S,k,N;nA(v)&&v.silent||pn(this,ec,Fu).call(this,{type:"error",error:v}),nA(v)||((S=(j=Ze(this,fl).config).onError)==null||S.call(j,v,this),(N=(k=Ze(this,fl).config).onSettled)==null||N.call(k,this.state.data,v,this)),this.scheduleGc()};return gr(this,ka,hq({initialPromise:n==null?void 0:n.initialPromise,fn:u.fetchFn,abort:s.abort.bind(s),onSuccess:v=>{var j,S,k,N;if(v===void 0){a(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(v)}catch(D){a(D);return}(S=(j=Ze(this,fl).config).onSuccess)==null||S.call(j,v,this),(N=(k=Ze(this,fl).config).onSettled)==null||N.call(k,v,this.state.error,this),this.scheduleGc()},onError:a,onFail:(v,j)=>{pn(this,ec,Fu).call(this,{type:"failed",failureCount:v,error:j})},onPause:()=>{pn(this,ec,Fu).call(this,{type:"pause"})},onContinue:()=>{pn(this,ec,Fu).call(this,{type:"continue"})},retry:u.options.retry,retryDelay:u.options.retryDelay,networkMode:u.options.networkMode,canRun:()=>!0})),Ze(this,ka).start()}},ax=new WeakMap,ox=new WeakMap,fl=new WeakMap,ka=new WeakMap,wb=new WeakMap,_m=new WeakMap,ec=new WeakSet,Fu=function(t){const n=s=>{switch(t.type){case"failed":return{...s,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...mq(s.data,this.options),fetchMeta:t.meta??null};case"success":return{...s,data:t.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const i=t.error;return nA(i)&&i.revert&&Ze(this,ox)?{...Ze(this,ox),fetchStatus:"idle"}:{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...t.state}}};this.state=n(this.state),Bi.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),Ze(this,fl).notify({query:this,type:"updated",action:t})})},F6);function mq(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:uq(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function see(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,s=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Dc,z6,iee=(z6=class extends gy{constructor(t={}){super();Vr(this,Dc);this.config=t,gr(this,Dc,new Map)}build(t,n,s){const i=n.queryKey,c=n.queryHash??jO(i,n);let u=this.get(c);return u||(u=new nee({cache:this,queryKey:i,queryHash:c,options:t.defaultQueryOptions(n),state:s,defaultOptions:t.getQueryDefaults(i)}),this.add(u)),u}add(t){Ze(this,Dc).has(t.queryHash)||(Ze(this,Dc).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=Ze(this,Dc).get(t.queryHash);n&&(t.destroy(),n===t&&Ze(this,Dc).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Bi.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Ze(this,Dc).get(t)}getAll(){return[...Ze(this,Dc).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(s=>AL(n,s))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(s=>AL(t,s)):n}notify(t){Bi.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Bi.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Bi.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Dc=new WeakMap,z6),Rc,Wa,bm,Lc,ih,$6,aee=($6=class extends fq{constructor(t){super();Vr(this,Lc);Vr(this,Rc);Vr(this,Wa);Vr(this,bm);this.mutationId=t.mutationId,gr(this,Wa,t.mutationCache),gr(this,Rc,[]),this.state=t.state||pq(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Ze(this,Rc).includes(t)||(Ze(this,Rc).push(t),this.clearGcTimeout(),Ze(this,Wa).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){gr(this,Rc,Ze(this,Rc).filter(n=>n!==t)),this.scheduleGc(),Ze(this,Wa).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Ze(this,Rc).length||(this.state.status==="pending"?this.scheduleGc():Ze(this,Wa).remove(this))}continue(){var t;return((t=Ze(this,bm))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,c,u,a,m,p,y,v,j,S,k,N,D,O,T,I,z,$,V,K;gr(this,bm,hq({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(te,X)=>{pn(this,Lc,ih).call(this,{type:"failed",failureCount:te,error:X})},onPause:()=>{pn(this,Lc,ih).call(this,{type:"pause"})},onContinue:()=>{pn(this,Lc,ih).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Ze(this,Wa).canRun(this)}));const n=this.state.status==="pending",s=!Ze(this,bm).canStart();try{if(!n){pn(this,Lc,ih).call(this,{type:"pending",variables:t,isPaused:s}),await((c=(i=Ze(this,Wa).config).onMutate)==null?void 0:c.call(i,t,this));const X=await((a=(u=this.options).onMutate)==null?void 0:a.call(u,t));X!==this.state.context&&pn(this,Lc,ih).call(this,{type:"pending",context:X,variables:t,isPaused:s})}const te=await Ze(this,bm).start();return await((p=(m=Ze(this,Wa).config).onSuccess)==null?void 0:p.call(m,te,t,this.state.context,this)),await((v=(y=this.options).onSuccess)==null?void 0:v.call(y,te,t,this.state.context)),await((S=(j=Ze(this,Wa).config).onSettled)==null?void 0:S.call(j,te,null,this.state.variables,this.state.context,this)),await((N=(k=this.options).onSettled)==null?void 0:N.call(k,te,null,t,this.state.context)),pn(this,Lc,ih).call(this,{type:"success",data:te}),te}catch(te){try{throw await((O=(D=Ze(this,Wa).config).onError)==null?void 0:O.call(D,te,t,this.state.context,this)),await((I=(T=this.options).onError)==null?void 0:I.call(T,te,t,this.state.context)),await(($=(z=Ze(this,Wa).config).onSettled)==null?void 0:$.call(z,void 0,te,this.state.variables,this.state.context,this)),await((K=(V=this.options).onSettled)==null?void 0:K.call(V,void 0,te,t,this.state.context)),te}finally{pn(this,Lc,ih).call(this,{type:"error",error:te})}}finally{Ze(this,Wa).runNext(this)}}},Rc=new WeakMap,Wa=new WeakMap,bm=new WeakMap,Lc=new WeakSet,ih=function(t){const n=s=>{switch(t.type){case"failed":return{...s,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...s,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:t.error,failureCount:s.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Bi.batch(()=>{Ze(this,Rc).forEach(s=>{s.onMutationUpdate(t)}),Ze(this,Wa).notify({mutation:this,type:"updated",action:t})})},$6);function pq(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Lo,Sb,B6,oee=(B6=class extends gy{constructor(t={}){super();Vr(this,Lo);Vr(this,Sb);this.config=t,gr(this,Lo,new Map),gr(this,Sb,Date.now())}build(t,n,s){const i=new aee({mutationCache:this,mutationId:++ww(this,Sb)._,options:t.defaultMutationOptions(n),state:s});return this.add(i),i}add(t){const n=Bw(t),s=Ze(this,Lo).get(n)??[];s.push(t),Ze(this,Lo).set(n,s),this.notify({type:"added",mutation:t})}remove(t){var s;const n=Bw(t);if(Ze(this,Lo).has(n)){const i=(s=Ze(this,Lo).get(n))==null?void 0:s.filter(c=>c!==t);i&&(i.length===0?Ze(this,Lo).delete(n):Ze(this,Lo).set(n,i))}this.notify({type:"removed",mutation:t})}canRun(t){var s;const n=(s=Ze(this,Lo).get(Bw(t)))==null?void 0:s.find(i=>i.state.status==="pending");return!n||n===t}runNext(t){var s;const n=(s=Ze(this,Lo).get(Bw(t)))==null?void 0:s.find(i=>i!==t&&i.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}clear(){Bi.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...Ze(this,Lo).values()].flat()}find(t){const n={exact:!0,...t};return this.getAll().find(s=>kL(n,s))}findAll(t={}){return this.getAll().filter(n=>kL(t,n))}notify(t){Bi.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Bi.batch(()=>Promise.all(t.map(n=>n.continue().catch(ml))))}},Lo=new WeakMap,Sb=new WeakMap,B6);function Bw(e){var t;return((t=e.options.scope)==null?void 0:t.id)??String(e.mutationId)}function ML(e){return{onFetch:(t,n)=>{var y,v,j,S,k;const s=t.options,i=(j=(v=(y=t.fetchOptions)==null?void 0:y.meta)==null?void 0:v.fetchMore)==null?void 0:j.direction,c=((S=t.state.data)==null?void 0:S.pages)||[],u=((k=t.state.data)==null?void 0:k.pageParams)||[];let a={pages:[],pageParams:[]},m=0;const p=async()=>{let N=!1;const D=I=>{Object.defineProperty(I,"signal",{enumerable:!0,get:()=>(t.signal.aborted?N=!0:t.signal.addEventListener("abort",()=>{N=!0}),t.signal)})},O=cq(t.options,t.fetchOptions),T=async(I,z,$)=>{if(N)return Promise.reject();if(z==null&&I.pages.length)return Promise.resolve(I);const V={queryKey:t.queryKey,pageParam:z,direction:$?"backward":"forward",meta:t.options.meta};D(V);const K=await O(V),{maxPages:te}=t.options,X=$?QJ:XJ;return{pages:X(I.pages,K,te),pageParams:X(I.pageParams,z,te)}};if(i&&c.length){const I=i==="backward",z=I?lee:OL,$={pages:c,pageParams:u},V=z(s,$);a=await T($,V,I)}else{const I=e??c.length;do{const z=m===0?u[0]??s.initialPageParam:OL(s,a);if(m>0&&z==null)break;a=await T(a,z),m++}while(m<I)}return a};t.options.persister?t.fetchFn=()=>{var N,D;return(D=(N=t.options).persister)==null?void 0:D.call(N,p,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=p}}}function OL(e,{pages:t,pageParams:n}){const s=t.length-1;return t.length>0?e.getNextPageParam(t[s],t,n[s],n):void 0}function lee(e,{pages:t,pageParams:n}){var s;return t.length>0?(s=e.getPreviousPageParam)==null?void 0:s.call(e,t[0],t,n[0],n):void 0}var ii,vh,_h,lx,cx,bh,ux,dx,q6,cee=(q6=class{constructor(e={}){Vr(this,ii);Vr(this,vh);Vr(this,_h);Vr(this,lx);Vr(this,cx);Vr(this,bh);Vr(this,ux);Vr(this,dx);gr(this,ii,e.queryCache||new iee),gr(this,vh,e.mutationCache||new oee),gr(this,_h,e.defaultOptions||{}),gr(this,lx,new Map),gr(this,cx,new Map),gr(this,bh,0)}mount(){ww(this,bh)._++,Ze(this,bh)===1&&(gr(this,ux,SO.subscribe(async e=>{e&&(await this.resumePausedMutations(),Ze(this,ii).onFocus())})),gr(this,dx,iS.subscribe(async e=>{e&&(await this.resumePausedMutations(),Ze(this,ii).onOnline())})))}unmount(){var e,t;ww(this,bh)._--,Ze(this,bh)===0&&((e=Ze(this,ux))==null||e.call(this),gr(this,ux,void 0),(t=Ze(this,dx))==null||t.call(this),gr(this,dx,void 0))}isFetching(e){return Ze(this,ii).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Ze(this,vh).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=Ze(this,ii).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.getQueryData(e.queryKey);if(t===void 0)return this.fetchQuery(e);{const n=this.defaultQueryOptions(e),s=Ze(this,ii).build(this,n);return e.revalidateIfStale&&s.isStaleByTime(Kg(n.staleTime,s))&&this.prefetchQuery(n),Promise.resolve(t)}}getQueriesData(e){return Ze(this,ii).findAll(e).map(({queryKey:t,state:n})=>{const s=n.data;return[t,s]})}setQueryData(e,t,n){const s=this.defaultQueryOptions({queryKey:e}),i=Ze(this,ii).get(s.queryHash),c=i==null?void 0:i.state.data,u=ZJ(t,c);if(u!==void 0)return Ze(this,ii).build(this,s).setData(u,{...n,manual:!0})}setQueriesData(e,t,n){return Bi.batch(()=>Ze(this,ii).findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=Ze(this,ii).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=Ze(this,ii);Bi.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=Ze(this,ii),s={type:"active",...e};return Bi.batch(()=>(n.findAll(e).forEach(i=>{i.reset()}),this.refetchQueries(s,t)))}cancelQueries(e={},t={}){const n={revert:!0,...t},s=Bi.batch(()=>Ze(this,ii).findAll(e).map(i=>i.cancel(n)));return Promise.all(s).then(ml).catch(ml)}invalidateQueries(e={},t={}){return Bi.batch(()=>{if(Ze(this,ii).findAll(e).forEach(s=>{s.invalidate()}),e.refetchType==="none")return Promise.resolve();const n={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(n,t)})}refetchQueries(e={},t){const n={...t,cancelRefetch:(t==null?void 0:t.cancelRefetch)??!0},s=Bi.batch(()=>Ze(this,ii).findAll(e).filter(i=>!i.isDisabled()).map(i=>{let c=i.fetch(void 0,n);return n.throwOnError||(c=c.catch(ml)),i.state.fetchStatus==="paused"?Promise.resolve():c}));return Promise.all(s).then(ml)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=Ze(this,ii).build(this,t);return n.isStaleByTime(Kg(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(ml).catch(ml)}fetchInfiniteQuery(e){return e.behavior=ML(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(ml).catch(ml)}ensureInfiniteQueryData(e){return e.behavior=ML(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return iS.isOnline()?Ze(this,vh).resumePausedMutations():Promise.resolve()}getQueryCache(){return Ze(this,ii)}getMutationCache(){return Ze(this,vh)}getDefaultOptions(){return Ze(this,_h)}setDefaultOptions(e){gr(this,_h,e)}setQueryDefaults(e,t){Ze(this,lx).set(Rm(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Ze(this,lx).values()];let n={};return t.forEach(s=>{S0(e,s.queryKey)&&(n={...n,...s.defaultOptions})}),n}setMutationDefaults(e,t){Ze(this,cx).set(Rm(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Ze(this,cx).values()];let n={};return t.forEach(s=>{S0(e,s.mutationKey)&&(n={...n,...s.defaultOptions})}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Ze(this,_h).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=jO(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.enabled!==!0&&t.queryFn===wO&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Ze(this,_h).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Ze(this,ii).clear(),Ze(this,vh).clear()}},ii=new WeakMap,vh=new WeakMap,_h=new WeakMap,lx=new WeakMap,cx=new WeakMap,bh=new WeakMap,ux=new WeakMap,dx=new WeakMap,q6),oo,Cn,Nb,Ga,jm,hx,jh,Fc,Pb,fx,mx,wm,Sm,wh,px,Un,z_,nT,sT,iT,aT,oT,lT,cT,gq,V6,uee=(V6=class extends gy{constructor(t,n){super();Vr(this,Un);Vr(this,oo);Vr(this,Cn);Vr(this,Nb);Vr(this,Ga);Vr(this,jm);Vr(this,hx);Vr(this,jh);Vr(this,Fc);Vr(this,Pb);Vr(this,fx);Vr(this,mx);Vr(this,wm);Vr(this,Sm);Vr(this,wh);Vr(this,px,new Set);this.options=n,gr(this,oo,t),gr(this,Fc,null),gr(this,jh,rT()),this.options.experimental_prefetchInRender||Ze(this,jh).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(Ze(this,Cn).addObserver(this),IL(Ze(this,Cn),this.options)?pn(this,Un,z_).call(this):this.updateResult(),pn(this,Un,aT).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return uT(Ze(this,Cn),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return uT(Ze(this,Cn),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,pn(this,Un,oT).call(this),pn(this,Un,lT).call(this),Ze(this,Cn).removeObserver(this)}setOptions(t,n){const s=this.options,i=Ze(this,Cn);if(this.options=Ze(this,oo).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ic(this.options.enabled,Ze(this,Cn))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");pn(this,Un,cT).call(this),Ze(this,Cn).setOptions(this.options),s._defaulted&&!sS(this.options,s)&&Ze(this,oo).getQueryCache().notify({type:"observerOptionsUpdated",query:Ze(this,Cn),observer:this});const c=this.hasListeners();c&&DL(Ze(this,Cn),i,this.options,s)&&pn(this,Un,z_).call(this),this.updateResult(n),c&&(Ze(this,Cn)!==i||ic(this.options.enabled,Ze(this,Cn))!==ic(s.enabled,Ze(this,Cn))||Kg(this.options.staleTime,Ze(this,Cn))!==Kg(s.staleTime,Ze(this,Cn)))&&pn(this,Un,nT).call(this);const u=pn(this,Un,sT).call(this);c&&(Ze(this,Cn)!==i||ic(this.options.enabled,Ze(this,Cn))!==ic(s.enabled,Ze(this,Cn))||u!==Ze(this,wh))&&pn(this,Un,iT).call(this,u)}getOptimisticResult(t){const n=Ze(this,oo).getQueryCache().build(Ze(this,oo),t),s=this.createResult(n,t);return hee(this,s)&&(gr(this,Ga,s),gr(this,hx,this.options),gr(this,jm,Ze(this,Cn).state)),s}getCurrentResult(){return Ze(this,Ga)}trackResult(t,n){const s={};return Object.keys(t).forEach(i=>{Object.defineProperty(s,i,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(i),n==null||n(i),t[i])})}),s}trackProp(t){Ze(this,px).add(t)}getCurrentQuery(){return Ze(this,Cn)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=Ze(this,oo).defaultQueryOptions(t),s=Ze(this,oo).getQueryCache().build(Ze(this,oo),n);return s.fetch().then(()=>this.createResult(s,n))}fetch(t){return pn(this,Un,z_).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),Ze(this,Ga)))}createResult(t,n){var te;const s=Ze(this,Cn),i=this.options,c=Ze(this,Ga),u=Ze(this,jm),a=Ze(this,hx),p=t!==s?t.state:Ze(this,Nb),{state:y}=t;let v={...y},j=!1,S;if(n._optimisticResults){const X=this.hasListeners(),ve=!X&&IL(t,n),ae=X&&DL(t,s,n,i);(ve||ae)&&(v={...v,...mq(y.data,t.options)}),n._optimisticResults==="isRestoring"&&(v.fetchStatus="idle")}let{error:k,errorUpdatedAt:N,status:D}=v;if(n.select&&v.data!==void 0)if(c&&v.data===(u==null?void 0:u.data)&&n.select===Ze(this,Pb))S=Ze(this,fx);else try{gr(this,Pb,n.select),S=n.select(v.data),S=tT(c==null?void 0:c.data,S,n),gr(this,fx,S),gr(this,Fc,null)}catch(X){gr(this,Fc,X)}else S=v.data;if(n.placeholderData!==void 0&&S===void 0&&D==="pending"){let X;if(c!=null&&c.isPlaceholderData&&n.placeholderData===(a==null?void 0:a.placeholderData))X=c.data;else if(X=typeof n.placeholderData=="function"?n.placeholderData((te=Ze(this,mx))==null?void 0:te.state.data,Ze(this,mx)):n.placeholderData,n.select&&X!==void 0)try{X=n.select(X),gr(this,Fc,null)}catch(ve){gr(this,Fc,ve)}X!==void 0&&(D="success",S=tT(c==null?void 0:c.data,X,n),j=!0)}Ze(this,Fc)&&(k=Ze(this,Fc),S=Ze(this,fx),N=Date.now(),D="error");const O=v.fetchStatus==="fetching",T=D==="pending",I=D==="error",z=T&&O,$=S!==void 0,K={status:D,fetchStatus:v.fetchStatus,isPending:T,isSuccess:D==="success",isError:I,isInitialLoading:z,isLoading:z,data:S,dataUpdatedAt:v.dataUpdatedAt,error:k,errorUpdatedAt:N,failureCount:v.fetchFailureCount,failureReason:v.fetchFailureReason,errorUpdateCount:v.errorUpdateCount,isFetched:v.dataUpdateCount>0||v.errorUpdateCount>0,isFetchedAfterMount:v.dataUpdateCount>p.dataUpdateCount||v.errorUpdateCount>p.errorUpdateCount,isFetching:O,isRefetching:O&&!T,isLoadingError:I&&!$,isPaused:v.fetchStatus==="paused",isPlaceholderData:j,isRefetchError:I&&$,isStale:NO(t,n),refetch:this.refetch,promise:Ze(this,jh)};if(this.options.experimental_prefetchInRender){const X=pe=>{K.status==="error"?pe.reject(K.error):K.data!==void 0&&pe.resolve(K.data)},ve=()=>{const pe=gr(this,jh,K.promise=rT());X(pe)},ae=Ze(this,jh);switch(ae.status){case"pending":t.queryHash===s.queryHash&&X(ae);break;case"fulfilled":(K.status==="error"||K.data!==ae.value)&&ve();break;case"rejected":(K.status!=="error"||K.error!==ae.reason)&&ve();break}}return K}updateResult(t){const n=Ze(this,Ga),s=this.createResult(Ze(this,Cn),this.options);if(gr(this,jm,Ze(this,Cn).state),gr(this,hx,this.options),Ze(this,jm).data!==void 0&&gr(this,mx,Ze(this,Cn)),sS(s,n))return;gr(this,Ga,s);const i={},c=()=>{if(!n)return!0;const{notifyOnChangeProps:u}=this.options,a=typeof u=="function"?u():u;if(a==="all"||!a&&!Ze(this,px).size)return!0;const m=new Set(a??Ze(this,px));return this.options.throwOnError&&m.add("error"),Object.keys(Ze(this,Ga)).some(p=>{const y=p;return Ze(this,Ga)[y]!==n[y]&&m.has(y)})};(t==null?void 0:t.listeners)!==!1&&c()&&(i.listeners=!0),pn(this,Un,gq).call(this,{...i,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&pn(this,Un,aT).call(this)}},oo=new WeakMap,Cn=new WeakMap,Nb=new WeakMap,Ga=new WeakMap,jm=new WeakMap,hx=new WeakMap,jh=new WeakMap,Fc=new WeakMap,Pb=new WeakMap,fx=new WeakMap,mx=new WeakMap,wm=new WeakMap,Sm=new WeakMap,wh=new WeakMap,px=new WeakMap,Un=new WeakSet,z_=function(t){pn(this,Un,cT).call(this);let n=Ze(this,Cn).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(ml)),n},nT=function(){pn(this,Un,oT).call(this);const t=Kg(this.options.staleTime,Ze(this,Cn));if(Dm||Ze(this,Ga).isStale||!Jk(t))return;const s=oq(Ze(this,Ga).dataUpdatedAt,t)+1;gr(this,wm,setTimeout(()=>{Ze(this,Ga).isStale||this.updateResult()},s))},sT=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(Ze(this,Cn)):this.options.refetchInterval)??!1},iT=function(t){pn(this,Un,lT).call(this),gr(this,wh,t),!(Dm||ic(this.options.enabled,Ze(this,Cn))===!1||!Jk(Ze(this,wh))||Ze(this,wh)===0)&&gr(this,Sm,setInterval(()=>{(this.options.refetchIntervalInBackground||SO.isFocused())&&pn(this,Un,z_).call(this)},Ze(this,wh)))},aT=function(){pn(this,Un,nT).call(this),pn(this,Un,iT).call(this,pn(this,Un,sT).call(this))},oT=function(){Ze(this,wm)&&(clearTimeout(Ze(this,wm)),gr(this,wm,void 0))},lT=function(){Ze(this,Sm)&&(clearInterval(Ze(this,Sm)),gr(this,Sm,void 0))},cT=function(){const t=Ze(this,oo).getQueryCache().build(Ze(this,oo),this.options);if(t===Ze(this,Cn))return;const n=Ze(this,Cn);gr(this,Cn,t),gr(this,Nb,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},gq=function(t){Bi.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(Ze(this,Ga))}),Ze(this,oo).getQueryCache().notify({query:Ze(this,Cn),type:"observerResultsUpdated"})})},V6);function dee(e,t){return ic(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function IL(e,t){return dee(e,t)||e.state.data!==void 0&&uT(e,t,t.refetchOnMount)}function uT(e,t,n){if(ic(t.enabled,e)!==!1){const s=typeof n=="function"?n(e):n;return s==="always"||s!==!1&&NO(e,t)}return!1}function DL(e,t,n,s){return(e!==t||ic(s.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&NO(e,n)}function NO(e,t){return ic(t.enabled,e)!==!1&&e.isStaleByTime(Kg(t.staleTime,e))}function hee(e,t){return!sS(e.getCurrentResult(),t)}var Sh,Nh,lo,qu,rd,C1,dT,U6,fee=(U6=class extends gy{constructor(n,s){super();Vr(this,rd);Vr(this,Sh);Vr(this,Nh);Vr(this,lo);Vr(this,qu);gr(this,Sh,n),this.setOptions(s),this.bindMethods(),pn(this,rd,C1).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var i;const s=this.options;this.options=Ze(this,Sh).defaultMutationOptions(n),sS(this.options,s)||Ze(this,Sh).getMutationCache().notify({type:"observerOptionsUpdated",mutation:Ze(this,lo),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&Rm(s.mutationKey)!==Rm(this.options.mutationKey)?this.reset():((i=Ze(this,lo))==null?void 0:i.state.status)==="pending"&&Ze(this,lo).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=Ze(this,lo))==null||n.removeObserver(this)}onMutationUpdate(n){pn(this,rd,C1).call(this),pn(this,rd,dT).call(this,n)}getCurrentResult(){return Ze(this,Nh)}reset(){var n;(n=Ze(this,lo))==null||n.removeObserver(this),gr(this,lo,void 0),pn(this,rd,C1).call(this),pn(this,rd,dT).call(this)}mutate(n,s){var i;return gr(this,qu,s),(i=Ze(this,lo))==null||i.removeObserver(this),gr(this,lo,Ze(this,Sh).getMutationCache().build(Ze(this,Sh),this.options)),Ze(this,lo).addObserver(this),Ze(this,lo).execute(n)}},Sh=new WeakMap,Nh=new WeakMap,lo=new WeakMap,qu=new WeakMap,rd=new WeakSet,C1=function(){var s;const n=((s=Ze(this,lo))==null?void 0:s.state)??pq();gr(this,Nh,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},dT=function(n){Bi.batch(()=>{var s,i,c,u,a,m,p,y;if(Ze(this,qu)&&this.hasListeners()){const v=Ze(this,Nh).variables,j=Ze(this,Nh).context;(n==null?void 0:n.type)==="success"?((i=(s=Ze(this,qu)).onSuccess)==null||i.call(s,n.data,v,j),(u=(c=Ze(this,qu)).onSettled)==null||u.call(c,n.data,null,v,j)):(n==null?void 0:n.type)==="error"&&((m=(a=Ze(this,qu)).onError)==null||m.call(a,n.error,v,j),(y=(p=Ze(this,qu)).onSettled)==null||y.call(p,void 0,n.error,v,j))}this.listeners.forEach(v=>{v(Ze(this,Nh))})})},U6),xq=R.createContext(void 0),br=e=>{const t=R.useContext(xq);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},mee=({client:e,children:t})=>(R.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),r.jsx(xq.Provider,{value:e,children:t})),yq=R.createContext(!1),pee=()=>R.useContext(yq);yq.Provider;function gee(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var xee=R.createContext(gee()),yee=()=>R.useContext(xee);function vq(e,t){return typeof e=="function"?e(...t):!!e}function hT(){}var vee=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},_ee=e=>{R.useEffect(()=>{e.clearReset()},[e])},bee=({result:e,errorResetBoundary:t,throwOnError:n,query:s})=>e.isError&&!t.isReset()&&!e.isFetching&&s&&vq(n,[e.error,s]),jee=e=>{e.suspense&&(e.staleTime===void 0&&(e.staleTime=1e3),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3)))},wee=(e,t)=>e.isLoading&&e.isFetching&&!t,See=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,RL=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function Nee(e,t,n){var y,v,j,S,k;const s=br(),i=pee(),c=yee(),u=s.defaultQueryOptions(e);(v=(y=s.getDefaultOptions().queries)==null?void 0:y._experimental_beforeQuery)==null||v.call(y,u),u._optimisticResults=i?"isRestoring":"optimistic",jee(u),vee(u,c),_ee(c);const a=!s.getQueryCache().get(u.queryHash),[m]=R.useState(()=>new t(s,u)),p=m.getOptimisticResult(u);if(R.useSyncExternalStore(R.useCallback(N=>{const D=i?hT:m.subscribe(Bi.batchCalls(N));return m.updateResult(),D},[m,i]),()=>m.getCurrentResult(),()=>m.getCurrentResult()),R.useEffect(()=>{m.setOptions(u,{listeners:!1})},[u,m]),See(u,p))throw RL(u,m,c);if(bee({result:p,errorResetBoundary:c,throwOnError:u.throwOnError,query:s.getQueryCache().get(u.queryHash)}))throw p.error;if((S=(j=s.getDefaultOptions().queries)==null?void 0:j._experimental_afterQuery)==null||S.call(j,u,p),u.experimental_prefetchInRender&&!Dm&&wee(p,i)){const N=a?RL(u,m,c):(k=s.getQueryCache().get(u.queryHash))==null?void 0:k.promise;N==null||N.catch(hT).finally(()=>{m.updateResult()})}return u.notifyOnChangeProps?p:m.trackResult(p)}function ht(e,t){return Nee(e,uee)}function jt(e,t){const n=br(),[s]=R.useState(()=>new fee(n,e));R.useEffect(()=>{s.setOptions(e)},[s,e]);const i=R.useSyncExternalStore(R.useCallback(u=>s.subscribe(Bi.batchCalls(u)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),c=R.useCallback((u,a)=>{s.mutate(u,a).catch(hT)},[s]);if(i.error&&vq(s.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:c,mutateAsync:i.mutate}}/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function N0(){return N0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},N0.apply(this,arguments)}var Ah;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ah||(Ah={}));const LL="popstate";function Pee(e){e===void 0&&(e={});function t(s,i){let{pathname:c,search:u,hash:a}=s.location;return fT("",{pathname:c,search:u,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){return typeof i=="string"?i:aS(i)}return Aee(t,n,null,e)}function Qs(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function _q(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Cee(){return Math.random().toString(36).substr(2,8)}function FL(e,t){return{usr:e.state,key:e.key,idx:t}}function fT(e,t,n,s){return n===void 0&&(n=null),N0({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?xy(t):t,{state:n,key:t&&t.key||s||Cee()})}function aS(e){let{pathname:t="/",search:n="",hash:s=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function xy(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let s=e.indexOf("?");s>=0&&(t.search=e.substr(s),e=e.substr(0,s)),e&&(t.pathname=e)}return t}function Aee(e,t,n,s){s===void 0&&(s={});let{window:i=document.defaultView,v5Compat:c=!1}=s,u=i.history,a=Ah.Pop,m=null,p=y();p==null&&(p=0,u.replaceState(N0({},u.state,{idx:p}),""));function y(){return(u.state||{idx:null}).idx}function v(){a=Ah.Pop;let D=y(),O=D==null?null:D-p;p=D,m&&m({action:a,location:N.location,delta:O})}function j(D,O){a=Ah.Push;let T=fT(N.location,D,O);p=y()+1;let I=FL(T,p),z=N.createHref(T);try{u.pushState(I,"",z)}catch($){if($ instanceof DOMException&&$.name==="DataCloneError")throw $;i.location.assign(z)}c&&m&&m({action:a,location:N.location,delta:1})}function S(D,O){a=Ah.Replace;let T=fT(N.location,D,O);p=y();let I=FL(T,p),z=N.createHref(T);u.replaceState(I,"",z),c&&m&&m({action:a,location:N.location,delta:0})}function k(D){let O=i.location.origin!=="null"?i.location.origin:i.location.href,T=typeof D=="string"?D:aS(D);return T=T.replace(/ $/,"%20"),Qs(O,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,O)}let N={get action(){return a},get location(){return e(i,u)},listen(D){if(m)throw new Error("A history only accepts one active listener");return i.addEventListener(LL,v),m=D,()=>{i.removeEventListener(LL,v),m=null}},createHref(D){return t(i,D)},createURL:k,encodeLocation(D){let O=k(D);return{pathname:O.pathname,search:O.search,hash:O.hash}},push:j,replace:S,go(D){return u.go(D)}};return N}var zL;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(zL||(zL={}));function kee(e,t,n){return n===void 0&&(n="/"),Tee(e,t,n)}function Tee(e,t,n,s){let i=typeof t=="string"?xy(t):t,c=wx(i.pathname||"/",n);if(c==null)return null;let u=bq(e);Eee(u);let a=null;for(let m=0;a==null&&m<u.length;++m){let p=qee(c);a=$ee(u[m],p)}return a}function bq(e,t,n,s){t===void 0&&(t=[]),n===void 0&&(n=[]),s===void 0&&(s="");let i=(c,u,a)=>{let m={relativePath:a===void 0?c.path||"":a,caseSensitive:c.caseSensitive===!0,childrenIndex:u,route:c};m.relativePath.startsWith("/")&&(Qs(m.relativePath.startsWith(s),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(s.length));let p=$h([s,m.relativePath]),y=n.concat(m);c.children&&c.children.length>0&&(Qs(c.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+p+'".')),bq(c.children,t,y,p)),!(c.path==null&&!c.index)&&t.push({path:p,score:Fee(p,c.index),routesMeta:y})};return e.forEach((c,u)=>{var a;if(c.path===""||!((a=c.path)!=null&&a.includes("?")))i(c,u);else for(let m of jq(c.path))i(c,u,m)}),t}function jq(e){let t=e.split("/");if(t.length===0)return[];let[n,...s]=t,i=n.endsWith("?"),c=n.replace(/\?$/,"");if(s.length===0)return i?[c,""]:[c];let u=jq(s.join("/")),a=[];return a.push(...u.map(m=>m===""?c:[c,m].join("/"))),i&&a.push(...u),a.map(m=>e.startsWith("/")&&m===""?"/":m)}function Eee(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:zee(t.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const Mee=/^:[\w-]+$/,Oee=3,Iee=2,Dee=1,Ree=10,Lee=-2,$L=e=>e==="*";function Fee(e,t){let n=e.split("/"),s=n.length;return n.some($L)&&(s+=Lee),t&&(s+=Iee),n.filter(i=>!$L(i)).reduce((i,c)=>i+(Mee.test(c)?Oee:c===""?Dee:Ree),s)}function zee(e,t){return e.length===t.length&&e.slice(0,-1).every((s,i)=>s===t[i])?e[e.length-1]-t[t.length-1]:0}function $ee(e,t,n){let{routesMeta:s}=e,i={},c="/",u=[];for(let a=0;a<s.length;++a){let m=s[a],p=a===s.length-1,y=c==="/"?t:t.slice(c.length)||"/",v=mT({path:m.relativePath,caseSensitive:m.caseSensitive,end:p},y),j=m.route;if(!v)return null;Object.assign(i,v.params),u.push({params:i,pathname:$h([c,v.pathname]),pathnameBase:Gee($h([c,v.pathnameBase])),route:j}),v.pathnameBase!=="/"&&(c=$h([c,v.pathnameBase]))}return u}function mT(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,s]=Bee(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let c=i[0],u=c.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:s.reduce((p,y,v)=>{let{paramName:j,isOptional:S}=y;if(j==="*"){let N=a[v]||"";u=c.slice(0,c.length-N.length).replace(/(.)\/+$/,"$1")}const k=a[v];return S&&!k?p[j]=void 0:p[j]=(k||"").replace(/%2F/g,"/"),p},{}),pathname:c,pathnameBase:u,pattern:e}}function Bee(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),_q(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let s=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,a,m)=>(s.push({paramName:a,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(s.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),s]}function qee(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return _q(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function wx(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,s=e.charAt(n);return s&&s!=="/"?null:e.slice(n)||"/"}function Vee(e,t){t===void 0&&(t="/");let{pathname:n,search:s="",hash:i=""}=typeof e=="string"?xy(e):e;return{pathname:n?n.startsWith("/")?n:Uee(n,t):t,search:Kee(s),hash:Hee(i)}}function Uee(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function sA(e,t,n,s){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Wee(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function PO(e,t){let n=Wee(e);return t?n.map((s,i)=>i===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function CO(e,t,n,s){s===void 0&&(s=!1);let i;typeof e=="string"?i=xy(e):(i=N0({},e),Qs(!i.pathname||!i.pathname.includes("?"),sA("?","pathname","search",i)),Qs(!i.pathname||!i.pathname.includes("#"),sA("#","pathname","hash",i)),Qs(!i.search||!i.search.includes("#"),sA("#","search","hash",i)));let c=e===""||i.pathname==="",u=c?"/":i.pathname,a;if(u==null)a=n;else{let v=t.length-1;if(!s&&u.startsWith("..")){let j=u.split("/");for(;j[0]==="..";)j.shift(),v-=1;i.pathname=j.join("/")}a=v>=0?t[v]:"/"}let m=Vee(i,a),p=u&&u!=="/"&&u.endsWith("/"),y=(c||u===".")&&n.endsWith("/");return!m.pathname.endsWith("/")&&(p||y)&&(m.pathname+="/"),m}const $h=e=>e.join("/").replace(/\/\/+/g,"/"),Gee=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Kee=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Hee=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Zee(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const wq=["post","put","patch","delete"];new Set(wq);const Yee=["get",...wq];new Set(Yee);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function P0(){return P0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},P0.apply(this,arguments)}const JN=R.createContext(null),Sq=R.createContext(null),xd=R.createContext(null),e2=R.createContext(null),nu=R.createContext({outlet:null,matches:[],isDataRoute:!1}),Nq=R.createContext(null);function Xee(e,t){let{relative:n}=t===void 0?{}:t;yy()||Qs(!1);let{basename:s,navigator:i}=R.useContext(xd),{hash:c,pathname:u,search:a}=t2(e,{relative:n}),m=u;return s!=="/"&&(m=u==="/"?s:$h([s,u])),i.createHref({pathname:m,search:a,hash:c})}function yy(){return R.useContext(e2)!=null}function Qm(){return yy()||Qs(!1),R.useContext(e2).location}function Pq(e){R.useContext(xd).static||R.useLayoutEffect(e)}function vy(){let{isDataRoute:e}=R.useContext(nu);return e?hte():Qee()}function Qee(){yy()||Qs(!1);let e=R.useContext(JN),{basename:t,future:n,navigator:s}=R.useContext(xd),{matches:i}=R.useContext(nu),{pathname:c}=Qm(),u=JSON.stringify(PO(i,n.v7_relativeSplatPath)),a=R.useRef(!1);return Pq(()=>{a.current=!0}),R.useCallback(function(p,y){if(y===void 0&&(y={}),!a.current)return;if(typeof p=="number"){s.go(p);return}let v=CO(p,JSON.parse(u),c,y.relative==="path");e==null&&t!=="/"&&(v.pathname=v.pathname==="/"?t:$h([t,v.pathname])),(y.replace?s.replace:s.push)(v,y.state,y)},[t,s,u,c,e])}const Jee=R.createContext(null);function ete(e){let t=R.useContext(nu).outlet;return t&&R.createElement(Jee.Provider,{value:e},t)}function AO(){let{matches:e}=R.useContext(nu),t=e[e.length-1];return t?t.params:{}}function t2(e,t){let{relative:n}=t===void 0?{}:t,{future:s}=R.useContext(xd),{matches:i}=R.useContext(nu),{pathname:c}=Qm(),u=JSON.stringify(PO(i,s.v7_relativeSplatPath));return R.useMemo(()=>CO(e,JSON.parse(u),c,n==="path"),[e,u,c,n])}function tte(e,t){return rte(e,t)}function rte(e,t,n,s){yy()||Qs(!1);let{navigator:i,static:c}=R.useContext(xd),{matches:u}=R.useContext(nu),a=u[u.length-1],m=a?a.params:{};a&&a.pathname;let p=a?a.pathnameBase:"/";a&&a.route;let y=Qm(),v;if(t){var j;let O=typeof t=="string"?xy(t):t;p==="/"||(j=O.pathname)!=null&&j.startsWith(p)||Qs(!1),v=O}else v=y;let S=v.pathname||"/",k=S;if(p!=="/"){let O=p.replace(/^\//,"").split("/");k="/"+S.replace(/^\//,"").split("/").slice(O.length).join("/")}let N=kee(e,{pathname:k}),D=ote(N&&N.map(O=>Object.assign({},O,{params:Object.assign({},m,O.params),pathname:$h([p,i.encodeLocation?i.encodeLocation(O.pathname).pathname:O.pathname]),pathnameBase:O.pathnameBase==="/"?p:$h([p,i.encodeLocation?i.encodeLocation(O.pathnameBase).pathname:O.pathnameBase])})),u,n,s);return t&&D?R.createElement(e2.Provider,{value:{location:P0({pathname:"/",search:"",hash:"",state:null,key:"default"},v),navigationType:Ah.Pop}},D):D}function nte(){let e=dte(),t=Zee(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},t),n?R.createElement("pre",{style:i},n):null,null)}const ste=R.createElement(nte,null);class ite extends R.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?R.createElement(nu.Provider,{value:this.props.routeContext},R.createElement(Nq.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ate(e){let{routeContext:t,match:n,children:s}=e,i=R.useContext(JN);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),R.createElement(nu.Provider,{value:t},s)}function ote(e,t,n,s){var i;if(t===void 0&&(t=[]),n===void 0&&(n=null),s===void 0&&(s=null),e==null){var c;if(!n)return null;if(n.errors)e=n.matches;else if((c=s)!=null&&c.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let u=e,a=(i=n)==null?void 0:i.errors;if(a!=null){let y=u.findIndex(v=>v.route.id&&(a==null?void 0:a[v.route.id])!==void 0);y>=0||Qs(!1),u=u.slice(0,Math.min(u.length,y+1))}let m=!1,p=-1;if(n&&s&&s.v7_partialHydration)for(let y=0;y<u.length;y++){let v=u[y];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(p=y),v.route.id){let{loaderData:j,errors:S}=n,k=v.route.loader&&j[v.route.id]===void 0&&(!S||S[v.route.id]===void 0);if(v.route.lazy||k){m=!0,p>=0?u=u.slice(0,p+1):u=[u[0]];break}}}return u.reduceRight((y,v,j)=>{let S,k=!1,N=null,D=null;n&&(S=a&&v.route.id?a[v.route.id]:void 0,N=v.route.errorElement||ste,m&&(p<0&&j===0?(fte("route-fallback"),k=!0,D=null):p===j&&(k=!0,D=v.route.hydrateFallbackElement||null)));let O=t.concat(u.slice(0,j+1)),T=()=>{let I;return S?I=N:k?I=D:v.route.Component?I=R.createElement(v.route.Component,null):v.route.element?I=v.route.element:I=y,R.createElement(ate,{match:v,routeContext:{outlet:y,matches:O,isDataRoute:n!=null},children:I})};return n&&(v.route.ErrorBoundary||v.route.errorElement||j===0)?R.createElement(ite,{location:n.location,revalidation:n.revalidation,component:N,error:S,children:T(),routeContext:{outlet:null,matches:O,isDataRoute:!0}}):T()},null)}var Cq=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Cq||{}),Aq=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Aq||{});function lte(e){let t=R.useContext(JN);return t||Qs(!1),t}function cte(e){let t=R.useContext(Sq);return t||Qs(!1),t}function ute(e){let t=R.useContext(nu);return t||Qs(!1),t}function kq(e){let t=ute(),n=t.matches[t.matches.length-1];return n.route.id||Qs(!1),n.route.id}function dte(){var e;let t=R.useContext(Nq),n=cte(),s=kq();return t!==void 0?t:(e=n.errors)==null?void 0:e[s]}function hte(){let{router:e}=lte(Cq.UseNavigateStable),t=kq(Aq.UseNavigateStable),n=R.useRef(!1);return Pq(()=>{n.current=!0}),R.useCallback(function(i,c){c===void 0&&(c={}),n.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,P0({fromRouteId:t},c)))},[e,t])}const BL={};function fte(e,t,n){BL[e]||(BL[e]=!0)}function mte(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Aa(e){let{to:t,replace:n,state:s,relative:i}=e;yy()||Qs(!1);let{future:c,static:u}=R.useContext(xd),{matches:a}=R.useContext(nu),{pathname:m}=Qm(),p=vy(),y=CO(t,PO(a,c.v7_relativeSplatPath),m,i==="path"),v=JSON.stringify(y);return R.useEffect(()=>p(JSON.parse(v),{replace:n,state:s,relative:i}),[p,v,i,n,s]),null}function Fa(e){return ete(e.context)}function at(e){Qs(!1)}function pte(e){let{basename:t="/",children:n=null,location:s,navigationType:i=Ah.Pop,navigator:c,static:u=!1,future:a}=e;yy()&&Qs(!1);let m=t.replace(/^\/*/,"/"),p=R.useMemo(()=>({basename:m,navigator:c,static:u,future:P0({v7_relativeSplatPath:!1},a)}),[m,a,c,u]);typeof s=="string"&&(s=xy(s));let{pathname:y="/",search:v="",hash:j="",state:S=null,key:k="default"}=s,N=R.useMemo(()=>{let D=wx(y,m);return D==null?null:{location:{pathname:D,search:v,hash:j,state:S,key:k},navigationType:i}},[m,y,v,j,S,k,i]);return N==null?null:R.createElement(xd.Provider,{value:p},R.createElement(e2.Provider,{children:n,value:N}))}function gte(e){let{children:t,location:n}=e;return tte(pT(t),n)}new Promise(()=>{});function pT(e,t){t===void 0&&(t=[]);let n=[];return R.Children.forEach(e,(s,i)=>{if(!R.isValidElement(s))return;let c=[...t,i];if(s.type===R.Fragment){n.push.apply(n,pT(s.props.children,c));return}s.type!==at&&Qs(!1),!s.props.index||!s.props.children||Qs(!1);let u={id:s.props.id||c.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(u.children=pT(s.props.children,c)),n.push(u)}),n}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function oS(){return oS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},oS.apply(this,arguments)}function Tq(e,t){if(e==null)return{};var n={},s=Object.keys(e),i,c;for(c=0;c<s.length;c++)i=s[c],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function xte(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function yte(e,t){return e.button===0&&(!t||t==="_self")&&!xte(e)}const vte=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],_te=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],bte="6";try{window.__reactRouterVersion=bte}catch{}const jte=R.createContext({isTransitioning:!1}),wte="startTransition",qL=rB[wte];function Ste(e){let{basename:t,children:n,future:s,window:i}=e,c=R.useRef();c.current==null&&(c.current=Pee({window:i,v5Compat:!0}));let u=c.current,[a,m]=R.useState({action:u.action,location:u.location}),{v7_startTransition:p}=s||{},y=R.useCallback(v=>{p&&qL?qL(()=>m(v)):m(v)},[m,p]);return R.useLayoutEffect(()=>u.listen(y),[u,y]),R.useEffect(()=>mte(s),[s]),R.createElement(pte,{basename:t,children:n,location:a.location,navigationType:a.action,navigator:u,future:s})}const Nte=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Pte=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mc=R.forwardRef(function(t,n){let{onClick:s,relative:i,reloadDocument:c,replace:u,state:a,target:m,to:p,preventScrollReset:y,viewTransition:v}=t,j=Tq(t,vte),{basename:S}=R.useContext(xd),k,N=!1;if(typeof p=="string"&&Pte.test(p)&&(k=p,Nte))try{let I=new URL(window.location.href),z=p.startsWith("//")?new URL(I.protocol+p):new URL(p),$=wx(z.pathname,S);z.origin===I.origin&&$!=null?p=$+z.search+z.hash:N=!0}catch{}let D=Xee(p,{relative:i}),O=Ate(p,{replace:u,state:a,target:m,preventScrollReset:y,relative:i,viewTransition:v});function T(I){s&&s(I),I.defaultPrevented||O(I)}return R.createElement("a",oS({},j,{href:k||D,onClick:N||c?s:T,ref:n,target:m}))}),VL=R.forwardRef(function(t,n){let{"aria-current":s="page",caseSensitive:i=!1,className:c="",end:u=!1,style:a,to:m,viewTransition:p,children:y}=t,v=Tq(t,_te),j=t2(m,{relative:v.relative}),S=Qm(),k=R.useContext(Sq),{navigator:N,basename:D}=R.useContext(xd),O=k!=null&&kte(j)&&p===!0,T=N.encodeLocation?N.encodeLocation(j).pathname:j.pathname,I=S.pathname,z=k&&k.navigation&&k.navigation.location?k.navigation.location.pathname:null;i||(I=I.toLowerCase(),z=z?z.toLowerCase():null,T=T.toLowerCase()),z&&D&&(z=wx(z,D)||z);const $=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let V=I===T||!u&&I.startsWith(T)&&I.charAt($)==="/",K=z!=null&&(z===T||!u&&z.startsWith(T)&&z.charAt(T.length)==="/"),te={isActive:V,isPending:K,isTransitioning:O},X=V?s:void 0,ve;typeof c=="function"?ve=c(te):ve=[c,V?"active":null,K?"pending":null,O?"transitioning":null].filter(Boolean).join(" ");let ae=typeof a=="function"?a(te):a;return R.createElement(mc,oS({},v,{"aria-current":X,className:ve,ref:n,style:ae,to:m,viewTransition:p}),typeof y=="function"?y(te):y)});var gT;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(gT||(gT={}));var UL;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(UL||(UL={}));function Cte(e){let t=R.useContext(JN);return t||Qs(!1),t}function Ate(e,t){let{target:n,replace:s,state:i,preventScrollReset:c,relative:u,viewTransition:a}=t===void 0?{}:t,m=vy(),p=Qm(),y=t2(e,{relative:u});return R.useCallback(v=>{if(yte(v,n)){v.preventDefault();let j=s!==void 0?s:aS(p)===aS(y);m(e,{replace:j,state:i,preventScrollReset:c,relative:u,viewTransition:a})}},[p,m,y,s,i,n,e,c,u,a])}function kte(e,t){t===void 0&&(t={});let n=R.useContext(jte);n==null&&Qs(!1);let{basename:s}=Cte(gT.useViewTransitionState),i=t2(e,{relative:t.relative});if(!n.isTransitioning)return!1;let c=wx(n.currentLocation.pathname,s)||n.currentLocation.pathname,u=wx(n.nextLocation.pathname,s)||n.nextLocation.pathname;return mT(i.pathname,u)!=null||mT(i.pathname,c)!=null}async function Tte(e){if(!e.ok){const t=await e.text()||e.statusText;throw new Error(`${e.status}: ${t}`)}}const Ete=({on401:e})=>async({queryKey:t})=>{const n=await fetch(t[0],{credentials:"include"});return await Tte(n),await n.json()},Mte=new cee({defaultOptions:{queries:{queryFn:Ete({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),Ote="/api/v1";class Ite{constructor(t=Ote){this.baseUrl=t}async request(t,n){const s=`${this.baseUrl}${t}`,i={"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",...n==null?void 0:n.headers},c=await fetch(s,{...n,headers:i,credentials:"include"});if(!c.ok){const u=await c.json().catch(()=>({message:c.statusText}));throw new Error(u.message||"API request failed")}return c.json()}async get(t,n){const s=n?"?"+new URLSearchParams(n).toString():"";return this.request(`${t}${s}`)}async post(t,n){return this.request(t,{method:"POST",body:JSON.stringify(n)})}async put(t,n){return this.request(t,{method:"PUT",body:JSON.stringify(n)})}async patch(t,n){return this.request(t,{method:"PATCH",body:JSON.stringify(n)})}async delete(t){return this.request(t,{method:"DELETE"})}}const me=new Ite,Eq=R.createContext(void 0);function Dte({children:e}){const[t,n]=R.useState(null),[s,i]=R.useState(!0),c=async()=>{try{const y=await me.get("/auth/user");n(y.user)}catch{n(null)}};R.useEffect(()=>{c().finally(()=>i(!1))},[]);const u=async(y,v)=>{const j=await me.post("/auth/login",{email:y,password:v});n(j.user)},a=async()=>{try{await me.post("/auth/logout")}catch(y){console.error("Logout error:",y)}finally{n(null)}},m=y=>!t||!t.permissions?!1:t.permissions.includes(y),p=y=>!t||!t.roles?!1:t.roles.includes(y);return r.jsx(Eq.Provider,{value:{user:t,setUser:n,isAuthenticated:!!t,isLoading:s,login:u,logout:a,refreshUser:c,hasPermission:m,hasRole:p},children:e})}function kO(){const e=R.useContext(Eq);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}function xt({children:e,requiredPermission:t,requiredRole:n}){const{isAuthenticated:s,isLoading:i,hasPermission:c,hasRole:u}=kO();return r.jsx(r.Fragment,{children:e})}function Rte(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function r2(...e){return t=>e.forEach(n=>Rte(n,t))}function yn(...e){return R.useCallback(r2(...e),e)}var Gh=R.forwardRef((e,t)=>{const{children:n,...s}=e,i=R.Children.toArray(n),c=i.find(Fte);if(c){const u=c.props.children,a=i.map(m=>m===c?R.Children.count(u)>1?R.Children.only(null):R.isValidElement(u)?u.props.children:null:m);return r.jsx(xT,{...s,ref:t,children:R.isValidElement(u)?R.cloneElement(u,void 0,a):null})}return r.jsx(xT,{...s,ref:t,children:n})});Gh.displayName="Slot";var xT=R.forwardRef((e,t)=>{const{children:n,...s}=e;if(R.isValidElement(n)){const i=$te(n);return R.cloneElement(n,{...zte(s,n.props),ref:t?r2(t,i):i})}return R.Children.count(n)>1?R.Children.only(null):null});xT.displayName="SlotClone";var Lte=({children:e})=>r.jsx(r.Fragment,{children:e});function Fte(e){return R.isValidElement(e)&&e.type===Lte}function zte(e,t){const n={...t};for(const s in t){const i=e[s],c=t[s];/^on[A-Z]/.test(s)?i&&c?n[s]=(...a)=>{c(...a),i(...a)}:i&&(n[s]=i):s==="style"?n[s]={...i,...c}:s==="className"&&(n[s]=[i,c].filter(Boolean).join(" "))}return{...e,...n}}function $te(e){var s,i;let t=(s=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function Mq(e){var t,n,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=Mq(e[t]))&&(s&&(s+=" "),s+=n);else for(t in e)e[t]&&(s&&(s+=" "),s+=t);return s}function Bte(){for(var e,t,n=0,s="";n<arguments.length;)(e=arguments[n++])&&(t=Mq(e))&&(s&&(s+=" "),s+=t);return s}const WL=e=>typeof e=="boolean"?"".concat(e):e===0?"0":e,GL=Bte,Mb=(e,t)=>n=>{var s;if((t==null?void 0:t.variants)==null)return GL(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:i,defaultVariants:c}=t,u=Object.keys(i).map(p=>{const y=n==null?void 0:n[p],v=c==null?void 0:c[p];if(y===null)return null;const j=WL(y)||WL(v);return i[p][j]}),a=n&&Object.entries(n).reduce((p,y)=>{let[v,j]=y;return j===void 0||(p[v]=j),p},{}),m=t==null||(s=t.compoundVariants)===null||s===void 0?void 0:s.reduce((p,y)=>{let{class:v,className:j,...S}=y;return Object.entries(S).every(k=>{let[N,D]=k;return Array.isArray(D)?D.includes({...c,...a}[N]):{...c,...a}[N]===D})?[...p,v,j]:p},[]);return GL(e,u,m,n==null?void 0:n.class,n==null?void 0:n.className)};function Oq(e){var t,n,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=Oq(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}function Yr(){for(var e,t,n=0,s="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=Oq(e))&&(s&&(s+=" "),s+=t);return s}const TO="-",qte=e=>{const t=Ute(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=e;return{getClassGroupId:u=>{const a=u.split(TO);return a[0]===""&&a.length!==1&&a.shift(),Iq(a,t)||Vte(u)},getConflictingClassGroupIds:(u,a)=>{const m=n[u]||[];return a&&s[u]?[...m,...s[u]]:m}}},Iq=(e,t)=>{var u;if(e.length===0)return t.classGroupId;const n=e[0],s=t.nextPart.get(n),i=s?Iq(e.slice(1),s):void 0;if(i)return i;if(t.validators.length===0)return;const c=e.join(TO);return(u=t.validators.find(({validator:a})=>a(c)))==null?void 0:u.classGroupId},KL=/^\[(.+)\]$/,Vte=e=>{if(KL.test(e)){const t=KL.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},Ute=e=>{const{theme:t,prefix:n}=e,s={nextPart:new Map,validators:[]};return Gte(Object.entries(e.classGroups),n).forEach(([c,u])=>{yT(u,s,c,t)}),s},yT=(e,t,n,s)=>{e.forEach(i=>{if(typeof i=="string"){const c=i===""?t:HL(t,i);c.classGroupId=n;return}if(typeof i=="function"){if(Wte(i)){yT(i(s),t,n,s);return}t.validators.push({validator:i,classGroupId:n});return}Object.entries(i).forEach(([c,u])=>{yT(u,HL(t,c),n,s)})})},HL=(e,t)=>{let n=e;return t.split(TO).forEach(s=>{n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n},Wte=e=>e.isThemeGetter,Gte=(e,t)=>t?e.map(([n,s])=>{const i=s.map(c=>typeof c=="string"?t+c:typeof c=="object"?Object.fromEntries(Object.entries(c).map(([u,a])=>[t+u,a])):c);return[n,i]}):e,Kte=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,s=new Map;const i=(c,u)=>{n.set(c,u),t++,t>e&&(t=0,s=n,n=new Map)};return{get(c){let u=n.get(c);if(u!==void 0)return u;if((u=s.get(c))!==void 0)return i(c,u),u},set(c,u){n.has(c)?n.set(c,u):i(c,u)}}},Dq="!",Hte=e=>{const{separator:t,experimentalParseClassName:n}=e,s=t.length===1,i=t[0],c=t.length,u=a=>{const m=[];let p=0,y=0,v;for(let D=0;D<a.length;D++){let O=a[D];if(p===0){if(O===i&&(s||a.slice(D,D+c)===t)){m.push(a.slice(y,D)),y=D+c;continue}if(O==="/"){v=D;continue}}O==="["?p++:O==="]"&&p--}const j=m.length===0?a:a.substring(y),S=j.startsWith(Dq),k=S?j.substring(1):j,N=v&&v>y?v-y:void 0;return{modifiers:m,hasImportantModifier:S,baseClassName:k,maybePostfixModifierPosition:N}};return n?a=>n({className:a,parseClassName:u}):u},Zte=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(s=>{s[0]==="["?(t.push(...n.sort(),s),n=[]):n.push(s)}),t.push(...n.sort()),t},Yte=e=>({cache:Kte(e.cacheSize),parseClassName:Hte(e),...qte(e)}),Xte=/\s+/,Qte=(e,t)=>{const{parseClassName:n,getClassGroupId:s,getConflictingClassGroupIds:i}=t,c=[],u=e.trim().split(Xte);let a="";for(let m=u.length-1;m>=0;m-=1){const p=u[m],{modifiers:y,hasImportantModifier:v,baseClassName:j,maybePostfixModifierPosition:S}=n(p);let k=!!S,N=s(k?j.substring(0,S):j);if(!N){if(!k){a=p+(a.length>0?" "+a:a);continue}if(N=s(j),!N){a=p+(a.length>0?" "+a:a);continue}k=!1}const D=Zte(y).join(":"),O=v?D+Dq:D,T=O+N;if(c.includes(T))continue;c.push(T);const I=i(N,k);for(let z=0;z<I.length;++z){const $=I[z];c.push(O+$)}a=p+(a.length>0?" "+a:a)}return a};function Jte(){let e=0,t,n,s="";for(;e<arguments.length;)(t=arguments[e++])&&(n=Rq(t))&&(s&&(s+=" "),s+=n);return s}const Rq=e=>{if(typeof e=="string")return e;let t,n="";for(let s=0;s<e.length;s++)e[s]&&(t=Rq(e[s]))&&(n&&(n+=" "),n+=t);return n};function ere(e,...t){let n,s,i,c=u;function u(m){const p=t.reduce((y,v)=>v(y),e());return n=Yte(p),s=n.cache.get,i=n.cache.set,c=a,a(m)}function a(m){const p=s(m);if(p)return p;const y=Qte(m,n);return i(m,y),y}return function(){return c(Jte.apply(null,arguments))}}const bs=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},Lq=/^\[(?:([a-z-]+):)?(.+)\]$/i,tre=/^\d+\/\d+$/,rre=new Set(["px","full","screen"]),nre=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,sre=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ire=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,are=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,ore=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Du=e=>Hg(e)||rre.has(e)||tre.test(e),eh=e=>_y(e,"length",pre),Hg=e=>!!e&&!Number.isNaN(Number(e)),iA=e=>_y(e,"number",Hg),p_=e=>!!e&&Number.isInteger(Number(e)),lre=e=>e.endsWith("%")&&Hg(e.slice(0,-1)),hn=e=>Lq.test(e),th=e=>nre.test(e),cre=new Set(["length","size","percentage"]),ure=e=>_y(e,cre,Fq),dre=e=>_y(e,"position",Fq),hre=new Set(["image","url"]),fre=e=>_y(e,hre,xre),mre=e=>_y(e,"",gre),g_=()=>!0,_y=(e,t,n)=>{const s=Lq.exec(e);return s?s[1]?typeof t=="string"?s[1]===t:t.has(s[1]):n(s[2]):!1},pre=e=>sre.test(e)&&!ire.test(e),Fq=()=>!1,gre=e=>are.test(e),xre=e=>ore.test(e),yre=()=>{const e=bs("colors"),t=bs("spacing"),n=bs("blur"),s=bs("brightness"),i=bs("borderColor"),c=bs("borderRadius"),u=bs("borderSpacing"),a=bs("borderWidth"),m=bs("contrast"),p=bs("grayscale"),y=bs("hueRotate"),v=bs("invert"),j=bs("gap"),S=bs("gradientColorStops"),k=bs("gradientColorStopPositions"),N=bs("inset"),D=bs("margin"),O=bs("opacity"),T=bs("padding"),I=bs("saturate"),z=bs("scale"),$=bs("sepia"),V=bs("skew"),K=bs("space"),te=bs("translate"),X=()=>["auto","contain","none"],ve=()=>["auto","hidden","clip","visible","scroll"],ae=()=>["auto",hn,t],pe=()=>[hn,t],Oe=()=>["",Du,eh],Me=()=>["auto",Hg,hn],Xe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Ve=()=>["solid","dashed","dotted","double","none"],et=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Ce=()=>["start","end","center","between","around","evenly","stretch"],_e=()=>["","0",hn],tt=()=>["auto","avoid","all","avoid-page","page","left","right","column"],vt=()=>[Hg,hn];return{cacheSize:500,separator:":",theme:{colors:[g_],spacing:[Du,eh],blur:["none","",th,hn],brightness:vt(),borderColor:[e],borderRadius:["none","","full",th,hn],borderSpacing:pe(),borderWidth:Oe(),contrast:vt(),grayscale:_e(),hueRotate:vt(),invert:_e(),gap:pe(),gradientColorStops:[e],gradientColorStopPositions:[lre,eh],inset:ae(),margin:ae(),opacity:vt(),padding:pe(),saturate:vt(),scale:vt(),sepia:_e(),skew:vt(),space:pe(),translate:pe()},classGroups:{aspect:[{aspect:["auto","square","video",hn]}],container:["container"],columns:[{columns:[th]}],"break-after":[{"break-after":tt()}],"break-before":[{"break-before":tt()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Xe(),hn]}],overflow:[{overflow:ve()}],"overflow-x":[{"overflow-x":ve()}],"overflow-y":[{"overflow-y":ve()}],overscroll:[{overscroll:X()}],"overscroll-x":[{"overscroll-x":X()}],"overscroll-y":[{"overscroll-y":X()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[N]}],"inset-x":[{"inset-x":[N]}],"inset-y":[{"inset-y":[N]}],start:[{start:[N]}],end:[{end:[N]}],top:[{top:[N]}],right:[{right:[N]}],bottom:[{bottom:[N]}],left:[{left:[N]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",p_,hn]}],basis:[{basis:ae()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",hn]}],grow:[{grow:_e()}],shrink:[{shrink:_e()}],order:[{order:["first","last","none",p_,hn]}],"grid-cols":[{"grid-cols":[g_]}],"col-start-end":[{col:["auto",{span:["full",p_,hn]},hn]}],"col-start":[{"col-start":Me()}],"col-end":[{"col-end":Me()}],"grid-rows":[{"grid-rows":[g_]}],"row-start-end":[{row:["auto",{span:[p_,hn]},hn]}],"row-start":[{"row-start":Me()}],"row-end":[{"row-end":Me()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",hn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",hn]}],gap:[{gap:[j]}],"gap-x":[{"gap-x":[j]}],"gap-y":[{"gap-y":[j]}],"justify-content":[{justify:["normal",...Ce()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Ce(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Ce(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[T]}],px:[{px:[T]}],py:[{py:[T]}],ps:[{ps:[T]}],pe:[{pe:[T]}],pt:[{pt:[T]}],pr:[{pr:[T]}],pb:[{pb:[T]}],pl:[{pl:[T]}],m:[{m:[D]}],mx:[{mx:[D]}],my:[{my:[D]}],ms:[{ms:[D]}],me:[{me:[D]}],mt:[{mt:[D]}],mr:[{mr:[D]}],mb:[{mb:[D]}],ml:[{ml:[D]}],"space-x":[{"space-x":[K]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[K]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",hn,t]}],"min-w":[{"min-w":[hn,t,"min","max","fit"]}],"max-w":[{"max-w":[hn,t,"none","full","min","max","fit","prose",{screen:[th]},th]}],h:[{h:[hn,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[hn,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[hn,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[hn,t,"auto","min","max","fit"]}],"font-size":[{text:["base",th,eh]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",iA]}],"font-family":[{font:[g_]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",hn]}],"line-clamp":[{"line-clamp":["none",Hg,iA]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Du,hn]}],"list-image":[{"list-image":["none",hn]}],"list-style-type":[{list:["none","disc","decimal",hn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[O]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[O]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Ve(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Du,eh]}],"underline-offset":[{"underline-offset":["auto",Du,hn]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:pe()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",hn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",hn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[O]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Xe(),dre]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",ure]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},fre]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[k]}],"gradient-via-pos":[{via:[k]}],"gradient-to-pos":[{to:[k]}],"gradient-from":[{from:[S]}],"gradient-via":[{via:[S]}],"gradient-to":[{to:[S]}],rounded:[{rounded:[c]}],"rounded-s":[{"rounded-s":[c]}],"rounded-e":[{"rounded-e":[c]}],"rounded-t":[{"rounded-t":[c]}],"rounded-r":[{"rounded-r":[c]}],"rounded-b":[{"rounded-b":[c]}],"rounded-l":[{"rounded-l":[c]}],"rounded-ss":[{"rounded-ss":[c]}],"rounded-se":[{"rounded-se":[c]}],"rounded-ee":[{"rounded-ee":[c]}],"rounded-es":[{"rounded-es":[c]}],"rounded-tl":[{"rounded-tl":[c]}],"rounded-tr":[{"rounded-tr":[c]}],"rounded-br":[{"rounded-br":[c]}],"rounded-bl":[{"rounded-bl":[c]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[O]}],"border-style":[{border:[...Ve(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[O]}],"divide-style":[{divide:Ve()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...Ve()]}],"outline-offset":[{"outline-offset":[Du,hn]}],"outline-w":[{outline:[Du,eh]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:Oe()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[O]}],"ring-offset-w":[{"ring-offset":[Du,eh]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",th,mre]}],"shadow-color":[{shadow:[g_]}],opacity:[{opacity:[O]}],"mix-blend":[{"mix-blend":[...et(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":et()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[s]}],contrast:[{contrast:[m]}],"drop-shadow":[{"drop-shadow":["","none",th,hn]}],grayscale:[{grayscale:[p]}],"hue-rotate":[{"hue-rotate":[y]}],invert:[{invert:[v]}],saturate:[{saturate:[I]}],sepia:[{sepia:[$]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[m]}],"backdrop-grayscale":[{"backdrop-grayscale":[p]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[y]}],"backdrop-invert":[{"backdrop-invert":[v]}],"backdrop-opacity":[{"backdrop-opacity":[O]}],"backdrop-saturate":[{"backdrop-saturate":[I]}],"backdrop-sepia":[{"backdrop-sepia":[$]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[u]}],"border-spacing-x":[{"border-spacing-x":[u]}],"border-spacing-y":[{"border-spacing-y":[u]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",hn]}],duration:[{duration:vt()}],ease:[{ease:["linear","in","out","in-out",hn]}],delay:[{delay:vt()}],animate:[{animate:["none","spin","ping","pulse","bounce",hn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[z]}],"scale-x":[{"scale-x":[z]}],"scale-y":[{"scale-y":[z]}],rotate:[{rotate:[p_,hn]}],"translate-x":[{"translate-x":[te]}],"translate-y":[{"translate-y":[te]}],"skew-x":[{"skew-x":[V]}],"skew-y":[{"skew-y":[V]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",hn]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",hn]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":pe()}],"scroll-mx":[{"scroll-mx":pe()}],"scroll-my":[{"scroll-my":pe()}],"scroll-ms":[{"scroll-ms":pe()}],"scroll-me":[{"scroll-me":pe()}],"scroll-mt":[{"scroll-mt":pe()}],"scroll-mr":[{"scroll-mr":pe()}],"scroll-mb":[{"scroll-mb":pe()}],"scroll-ml":[{"scroll-ml":pe()}],"scroll-p":[{"scroll-p":pe()}],"scroll-px":[{"scroll-px":pe()}],"scroll-py":[{"scroll-py":pe()}],"scroll-ps":[{"scroll-ps":pe()}],"scroll-pe":[{"scroll-pe":pe()}],"scroll-pt":[{"scroll-pt":pe()}],"scroll-pr":[{"scroll-pr":pe()}],"scroll-pb":[{"scroll-pb":pe()}],"scroll-pl":[{"scroll-pl":pe()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",hn]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Du,eh,iA]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},vre=ere(yre);function wr(...e){return vre(Yr(e))}const _re=Mb("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),se=R.forwardRef(({className:e,variant:t,size:n,asChild:s=!1,...i},c)=>{const u=s?Gh:"button";return r.jsx(u,{className:wr(_re({variant:t,size:n,className:e})),ref:c,...i})});se.displayName="Button";const Ge=R.forwardRef(({className:e,type:t,...n},s)=>r.jsx("input",{type:t,className:wr("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...n}));Ge.displayName="Input";var bre=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],zr=bre.reduce((e,t)=>{const n=R.forwardRef((s,i)=>{const{asChild:c,...u}=s,a=c?Gh:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),r.jsx(a,{...u,ref:i})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function zq(e,t){e&&of.flushSync(()=>e.dispatchEvent(t))}var jre="Label",$q=R.forwardRef((e,t)=>r.jsx(zr.label,{...e,ref:t,onMouseDown:n=>{var i;n.target.closest("button, input, select, textarea")||((i=e.onMouseDown)==null||i.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));$q.displayName=jre;var Bq=$q;const wre=Mb("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ne=R.forwardRef(({className:e,...t},n)=>r.jsx(Bq,{ref:n,className:wr(wre(),e),...t}));Ne.displayName=Bq.displayName;const J=R.forwardRef(({className:e,...t},n)=>r.jsx("div",{ref:n,className:wr("rounded-xl border bg-card text-card-foreground shadow",e),...t}));J.displayName="Card";const ge=R.forwardRef(({className:e,...t},n)=>r.jsx("div",{ref:n,className:wr("flex flex-col space-y-1.5 p-6",e),...t}));ge.displayName="CardHeader";const xe=R.forwardRef(({className:e,...t},n)=>r.jsx("div",{ref:n,className:wr("font-semibold leading-none tracking-tight",e),...t}));xe.displayName="CardTitle";const xr=R.forwardRef(({className:e,...t},n)=>r.jsx("div",{ref:n,className:wr("text-sm text-muted-foreground",e),...t}));xr.displayName="CardDescription";const ie=R.forwardRef(({className:e,...t},n)=>r.jsx("div",{ref:n,className:wr("p-6 pt-0",e),...t}));ie.displayName="CardContent";const qq=R.forwardRef(({className:e,...t},n)=>r.jsx("div",{ref:n,className:wr("flex items-center p-6 pt-0",e),...t}));qq.displayName="CardFooter";const Sre=Mb("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Wi=R.forwardRef(({className:e,variant:t,...n},s)=>r.jsx("div",{ref:s,role:"alert",className:wr(Sre({variant:t}),e),...n}));Wi.displayName="Alert";const Nre=R.forwardRef(({className:e,...t},n)=>r.jsx("h5",{ref:n,className:wr("mb-1 font-medium leading-none tracking-tight",e),...t}));Nre.displayName="AlertTitle";const ki=R.forwardRef(({className:e,...t},n)=>r.jsx("div",{ref:n,className:wr("text-sm [&_p]:leading-relaxed",e),...t}));ki.displayName="AlertDescription";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pre=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Vq=(...e)=>e.filter((t,n,s)=>!!t&&s.indexOf(t)===n).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Cre={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Are=R.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:i="",children:c,iconNode:u,...a},m)=>R.createElement("svg",{ref:m,...Cre,width:t,height:t,stroke:e,strokeWidth:s?Number(n)*24/Number(t):n,className:Vq("lucide",i),...a},[...u.map(([p,y])=>R.createElement(p,y)),...Array.isArray(c)?c:[c]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=(e,t)=>{const n=R.forwardRef(({className:s,...i},c)=>R.createElement(Are,{ref:c,iconNode:t,className:Vq(`lucide-${Pre(e)}`,s),...i}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wo=At("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kre=At("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uq=At("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C0=At("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tre=At("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A0=At("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sx=At("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ere=At("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wq=At("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gq=At("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZL=At("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=At("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xu=At("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mre=At("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kq=At("ChartNoAxesColumn",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ore=At("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nx=At("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EO=At("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MO=At("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const by=At("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ire=At("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ei=At("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dre=At("CircleArrowDown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rre=At("CircleArrowUp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=At("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kh=At("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lre=At("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yd=At("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vT=At("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fre=At("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $_=At("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=At("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zre=At("CloudRain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $re=At("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bre=At("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OO=At("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xl=At("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=At("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rl=At("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ac=At("Droplet",[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gc=At("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hq=At("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qre=At("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lm=At("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vre=At("FileChartColumnIncreasing",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ure=At("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zq=At("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wre=At("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=At("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gre=At("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kre=At("FlaskConical",[["path",{d:"M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2",key:"pzvekw"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M7 16h10",key:"wp8him"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yq=At("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YL=At("Fuel",[["line",{x1:"3",x2:"15",y1:"22",y2:"22",key:"xegly4"}],["line",{x1:"4",x2:"14",y1:"9",y2:"9",key:"xcnuvu"}],["path",{d:"M14 22V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v18",key:"16j0yd"}],["path",{d:"M14 13h2a2 2 0 0 1 2 2v2a2 2 0 0 0 2 2a2 2 0 0 0 2-2V9.83a2 2 0 0 0-.59-1.42L18 5",key:"7cu91f"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gu=At("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lS=At("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Px=At("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hre=At("HandHeart",[["path",{d:"M11 14h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 16",key:"1ifwr1"}],["path",{d:"m7 20 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9",key:"17abbs"}],["path",{d:"m2 15 6 6",key:"10dquu"}],["path",{d:"M19.5 8.5c.7-.7 1.5-1.6 1.5-2.7A2.73 2.73 0 0 0 16 4a2.78 2.78 0 0 0-5 1.8c0 1.2.8 2 1.5 2.8L16 12Z",key:"1h3036"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _T=At("Handshake",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bT=At("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=At("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xq=At("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zre=At("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qu=At("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A1=At("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qq=At("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=At("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bc=At("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cx=At("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XL=At("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yre=At("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kc=At("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IO=At("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DO=At("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uS=At("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const od=At("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=At("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xre=At("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ax=At("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jT=At("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wT=At("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qre=At("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RO=At("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ci=At("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LO=At("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ai=At("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QL=At("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yl=At("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jq=At("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jre=At("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ene=At("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=At("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eV=At("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tne=At("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zg=At("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JL=At("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rne=At("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nne=At("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tV=At("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oi=At("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=At("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=At("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gn=At("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sne=At("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k0=At("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Go=At("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ine=At("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ane=At("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pi=At("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const one=At("Webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fm=At("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jy=At("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=At("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function lne(){const[e,t]=R.useState(""),[n,s]=R.useState(""),[i,c]=R.useState(""),[u,a]=R.useState(!1),[m,p]=R.useState(""),[y,v]=R.useState(!1),{login:j,setUser:S}=kO(),k=vy(),N=async D=>{var O,T;D.preventDefault(),p(""),v(!0);try{if(u){const I=await me.post("/auth/2fa/challenge",{email:e,password:n,code:i});S(I.user),k("/")}else try{await j(e,n),k("/")}catch(I){if((O=I.message)!=null&&O.includes("2FA")||(T=I.message)!=null&&T.includes("two-factor"))a(!0),p("");else throw I}}catch(I){p(I.message||"Login failed. Please check your credentials.")}finally{v(!1)}};return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 px-4",children:r.jsxs(J,{className:"w-full max-w-md",children:[r.jsxs(ge,{className:"space-y-1",children:[r.jsx(xe,{className:"text-2xl font-bold text-center",children:"Rural Water Supply MIS"}),r.jsx(xr,{className:"text-center",children:"Sign in to access the system"})]}),r.jsxs("form",{onSubmit:N,children:[r.jsxs(ie,{className:"space-y-4",children:[m&&r.jsx(Wi,{variant:"destructive",children:r.jsx(ki,{children:m})}),u&&r.jsxs(Wi,{children:[r.jsx(yl,{className:"h-4 w-4"}),r.jsx(ki,{children:"Two-factor authentication is enabled. Please enter the code from your authenticator app."})]}),u?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"2fa-code",children:"Verification Code"}),r.jsx(Ge,{id:"2fa-code",type:"text",placeholder:"000000",maxLength:6,value:i,onChange:D=>c(D.target.value.replace(/\D/g,"")),required:!0,disabled:y,autoFocus:!0}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter the 6-digit code from your authenticator app"})]}),r.jsx(se,{type:"button",variant:"ghost",size:"sm",onClick:()=>{a(!1),c(""),p("")},disabled:y,children:"Back to login"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"email",children:"Email"}),r.jsx(Ge,{id:"email",type:"email",placeholder:"user@example.com",value:e,onChange:D=>t(D.target.value),required:!0,disabled:y})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"password",children:"Password"}),r.jsx(Ge,{id:"password",type:"password",placeholder:"",value:n,onChange:D=>s(D.target.value),required:!0,disabled:y})]})]})]}),r.jsx(qq,{children:r.jsx(se,{type:"submit",className:"w-full",disabled:y||u&&i.length!==6,children:y?"Signing in...":u?"Verify & Sign In":"Sign In"})})]})]})})}function cne(){const e=[{title:"Map Console",description:"Interactive GIS map with layers and spatial analysis",path:"/gis/map",icon:"",featured:!0},{title:"Asset Management",description:"CMMS for assets, maintenance, and work orders",path:"/cmms/dashboard",icon:"",featured:!0},{title:"Water Quality",description:"Lab testing, sampling, and compliance monitoring",path:"/water-quality/parameters",icon:"",featured:!0},{title:"Schemes",description:"Water supply schemes and infrastructure",path:"/core/schemes",icon:""},{title:"Facilities",description:"Sources, treatment plants, pumps, reservoirs",path:"/core/facilities",icon:""},{title:"DMAs",description:"District Metered Areas management",path:"/core/dmas",icon:""},{title:"Pipelines",description:"Water distribution network",path:"/core/pipelines",icon:""},{title:"Zones",description:"Administrative zones and boundaries",path:"/core/zones",icon:""},{title:"Addresses",description:"Geocoded address registry",path:"/core/addresses",icon:""}];return r.jsxs("div",{className:"container mx-auto p-6",children:[r.jsxs("div",{className:"mb-8",children:[r.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Rural Water Supply MIS"}),r.jsx("p",{className:"text-lg text-muted-foreground",children:"Management Information System & Decision Support System"})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(t=>r.jsxs(J,{className:`hover:shadow-lg transition-shadow ${t.featured?"bg-gradient-to-br from-blue-50 to-cyan-50 border-blue-300 dark:from-blue-950 dark:to-cyan-950 dark:border-blue-700":""}`,children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-4xl",children:t.icon}),r.jsxs("div",{children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[t.title,t.featured&&r.jsx("span",{className:"text-xs bg-blue-600 text-white px-2 py-0.5 rounded-full",children:"NEW"})]}),r.jsx(xr,{children:t.description})]})]})}),r.jsx(ie,{children:r.jsx(mc,{to:t.path,children:r.jsxs(se,{className:`w-full ${t.featured?"bg-blue-600 hover:bg-blue-700":""}`,children:["Open ",t.title]})})})]},t.path))}),r.jsxs(J,{className:"mt-8 bg-blue-50 border-blue-200",children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Getting Started"}),r.jsx(xr,{children:"Quick actions to set up your water supply registry"})]}),r.jsx(ie,{children:r.jsxs("div",{className:"space-y-2",children:[r.jsx("p",{children:"1. Define your water supply schemes"}),r.jsx("p",{children:"2. Add facilities (sources, treatment plants, pumps)"}),r.jsx("p",{children:"3. Map District Metered Areas (DMAs)"}),r.jsx("p",{children:"4. Import or digitize pipeline network"})]})})]})]})}const une="modulepreload",dne=function(e){return"/"+e},e3={},hne=function(t,n,s){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),a=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));i=Promise.allSettled(n.map(m=>{if(m=dne(m),m in e3)return;e3[m]=!0;const p=m.endsWith(".css"),y=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${y}`))return;const v=document.createElement("link");if(v.rel=p?"stylesheet":une,p||(v.as="script"),v.crossOrigin="",v.href=m,a&&v.setAttribute("nonce",a),document.head.appendChild(v),p)return new Promise((j,S)=>{v.addEventListener("load",j),v.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${m}`)))})}))}function c(u){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=u,window.dispatchEvent(a),!a.defaultPrevented)throw u}return i.then(u=>{for(const a of u||[])a.status==="rejected"&&c(a.reason);return t().catch(c)})},fne=R.createContext(null);function mne(e,t){const n=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0,i=Array.isArray(t)?t[0]:t?t.x:0,c=Array.isArray(t)?t[1]:t?t.y:0;return n===i&&s===c}function fo(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!fo(e[n],t[n]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(const i of n)if(!t.hasOwnProperty(i)||!fo(e[i],t[i]))return!1;return!0}return!1}function t3(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function r3(e,t){const n=t.viewState||t,s={};if("longitude"in n&&"latitude"in n&&(n.longitude!==e.center.lng||n.latitude!==e.center.lat)){const i=e.center.constructor;s.center=new i(n.longitude,n.latitude)}return"zoom"in n&&n.zoom!==e.zoom&&(s.zoom=n.zoom),"bearing"in n&&n.bearing!==e.bearing&&(s.bearing=n.bearing),"pitch"in n&&n.pitch!==e.pitch&&(s.pitch=n.pitch),n.padding&&e.padding&&!fo(n.padding,e.padding)&&(s.padding=n.padding),s}const pne=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function n3(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const s of e.layers)t[s.id]=s;const n=e.layers.map(s=>{let i=null;"interactive"in s&&(i=Object.assign({},s),delete i.interactive);const c=t[s.ref];if(c){i=i||Object.assign({},s),delete i.ref;for(const u of pne)u in c&&(i[u]=c[u])}return i||s});return{...e,layers:n}}const s3={version:8,sources:{},layers:[]},i3={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},a3={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},o3={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},gne=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],xne=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class kx{constructor(t,n,s){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=i=>{const c=this.props[o3[i.type]];c?c(i):i.type==="error"&&console.error(i.error)},this._onCameraEvent=i=>{if(this._internalUpdate)return;i.viewState=this._propsedCameraUpdate||t3(this._map.transform);const c=this.props[a3[i.type]];c&&c(i)},this._onCameraUpdate=i=>this._internalUpdate?i:(this._propsedCameraUpdate=t3(i),r3(i,this.props)),this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const c=this.props[i3[i.type]];c&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),c(i),delete i.features)},this._MapClass=t,this.props=n,this._initialize(s)}get map(){return this._map}setProps(t){const n=this.props;this.props=t;const s=this._updateSettings(t,n),i=this._updateSize(t),c=this._updateViewState(t);this._updateStyle(t,n),this._updateStyleComponents(t),this._updateHandlers(t,n),(s||i||c&&!this._map.isMoving())&&this.redraw()}static reuse(t,n){const s=kx.savedMaps.pop();if(!s)return null;const i=s.map,c=i.getContainer();for(n.className=c.className;c.childNodes.length>0;)n.appendChild(c.childNodes[0]);i._container=n;const u=i._resizeObserver;u&&(u.disconnect(),u.observe(n)),s.setProps({...t,styleDiffing:!1}),i.resize();const{initialViewState:a}=t;return a&&(a.bounds?i.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):s._updateViewState(a)),i.isStyleLoaded()?i.fire("load"):i.once("style.load",()=>i.fire("load")),i._update(),s}_initialize(t){const{props:n}=this,{mapStyle:s=s3}=n,i={...n,...n.initialViewState,container:t,style:n3(s)},c=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[c.longitude||0,c.latitude||0],zoom:c.zoom||0,pitch:c.pitch||0,bearing:c.bearing||0}),n.gl){const a=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=a,n.gl)}const u=new this._MapClass(i);c.padding&&u.setPadding(c.padding),n.cursor&&(u.getCanvas().style.cursor=n.cursor),u.transformCameraUpdate=this._onCameraUpdate,u.on("style.load",()=>{var a;this._styleComponents={light:u.getLight(),sky:u.getSky(),projection:(a=u.getProjection)==null?void 0:a.call(u),terrain:u.getTerrain()},this._updateStyleComponents(this.props)}),u.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const a in i3)u.on(a,this._onPointerEvent);for(const a in a3)u.on(a,this._onCameraEvent);for(const a in o3)u.on(a,this._onEvent);this._map=u}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),kx.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_updateSize(t){const{viewState:n}=t;if(n){const s=this._map;if(n.width!==s.transform.width||n.height!==s.transform.height)return s.resize(),!0}return!1}_updateViewState(t){const n=this._map,s=n.transform;if(!n.isMoving()){const c=r3(s,t);if(Object.keys(c).length>0)return this._internalUpdate=!0,n.jumpTo(c),this._internalUpdate=!1,!0}return!1}_updateSettings(t,n){const s=this._map;let i=!1;for(const c of gne)if(c in t&&!fo(t[c],n[c])){i=!0;const u=s[`set${c[0].toUpperCase()}${c.slice(1)}`];u==null||u.call(s,t[c])}return i}_updateStyle(t,n){if(t.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==n.mapStyle){const{mapStyle:s=s3,styleDiffing:i=!0}=t,c={diff:i};"localIdeographFontFamily"in t&&(c.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(n3(s),c)}}_updateStyleComponents({light:t,projection:n,sky:s,terrain:i}){var a,m;const c=this._map,u=this._styleComponents;c.style._loaded&&(t&&!fo(t,u.light)&&(u.light=t,c.setLight(t)),n&&!fo(n,u.projection)&&n!==((a=u.projection)==null?void 0:a.type)&&(u.projection=typeof n=="string"?{type:n}:n,(m=c.setProjection)==null||m.call(c,u.projection)),s&&!fo(s,u.sky)&&(u.sky=s,c.setSky(s)),i!==void 0&&!fo(i,u.terrain)&&(!i||c.getSource(i.source))&&(u.terrain=i,c.setTerrain(i)))}_updateHandlers(t,n){const s=this._map;for(const i of xne){const c=t[i]??!0,u=n[i]??!0;fo(c,u)||(c?s[i].enable(c):s[i].disable())}}_queryRenderedFeatures(t){const n=this._map,{interactiveLayerIds:s=[]}=this.props;try{return n.queryRenderedFeatures(t,{layers:s.filter(n.getLayer.bind(n))})}catch{return[]}}_updateHover(t){var i;const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const c=t.type,u=((i=this._hoveredFeatures)==null?void 0:i.length)>0,a=this._queryRenderedFeatures(t.point),m=a.length>0;!m&&u&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=a,m&&!u&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=c}else this._hoveredFeatures=null}}kx.savedMaps=[];const yne=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function vne(e){if(!e)return null;const t=e.map,n={getMap:()=>t};for(const s of _ne(t))!(s in n)&&!yne.includes(s)&&(n[s]=t[s].bind(t));return n}function _ne(e){const t=new Set;let n=e;for(;n;){for(const s of Object.getOwnPropertyNames(n))s[0]!=="_"&&typeof e[s]=="function"&&s!=="fire"&&s!=="setEventedParent"&&t.add(s);n=Object.getPrototypeOf(n)}return Array.from(t)}const bne=typeof document<"u"?R.useLayoutEffect:R.useEffect;function jne(e,t){const{RTLTextPlugin:n,maxParallelImageRequests:s,workerCount:i,workerUrl:c}=t;if(n&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:u,lazy:a=!0}=typeof n=="string"?{pluginUrl:n}:n;e.setRTLTextPlugin(u,m=>{m&&console.error(m)},a)}s!==void 0&&e.setMaxParallelImageRequests(s),i!==void 0&&e.setWorkerCount(i),c!==void 0&&e.setWorkerUrl(c)}const wy=R.createContext(null);function wne(e,t){const n=R.useContext(fne),[s,i]=R.useState(null),c=R.useRef(),{current:u}=R.useRef({mapLib:null,map:null});R.useEffect(()=>{const p=e.mapLib;let y=!0,v;return Promise.resolve(p||hne(()=>Promise.resolve().then(()=>ade),void 0)).then(j=>{if(!y)return;if(!j)throw new Error("Invalid mapLib");const S="Map"in j?j:j.default;if(!S.Map)throw new Error("Invalid mapLib");jne(S,e),e.reuseMaps&&(v=kx.reuse(e,c.current)),v||(v=new kx(S.Map,e,c.current)),u.map=vne(v),u.mapLib=S,i(v),n==null||n.onMapMount(u.map,e.id)}).catch(j=>{const{onError:S}=e;S?S({type:"error",target:null,originalEvent:null,error:j}):console.error(j)}),()=>{y=!1,v&&(n==null||n.onMapUnmount(e.id),e.reuseMaps?v.recycle():v.destroy())}},[]),bne(()=>{s&&s.setProps(e)}),R.useImperativeHandle(t,()=>u.map,[s]);const a=R.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),m={height:"100%"};return R.createElement("div",{id:e.id,ref:c,style:a},s&&R.createElement(wy.Provider,{value:u},R.createElement("div",{"mapboxgl-children":"",style:m},e.children)))}const Ob=R.forwardRef(wne),Sne=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function _d(e,t){if(!e||!t)return;const n=e.style;for(const s in t){const i=t[s];Number.isFinite(i)&&!Sne.test(s)?n[s]=`${i}px`:n[s]=i}}function rV(e,t){if(e===t)return null;const n=l3(e),s=l3(t),i=[];for(const c of s)n.has(c)||i.push(c);for(const c of n)s.has(c)||i.push(c);return i.length===0?null:i}function l3(e){return new Set(e?e.trim().split(/\s+/):[])}const Nne=R.memo(R.forwardRef((e,t)=>{const{map:n,mapLib:s}=R.useContext(wy),i=R.useRef({props:e}),c=R.useMemo(()=>{let O=!1;R.Children.forEach(e.children,z=>{z&&(O=!0)});const T={...e,element:O?document.createElement("div"):void 0},I=new s.Marker(T);return I.setLngLat([e.longitude,e.latitude]),I.getElement().addEventListener("click",z=>{var $,V;(V=($=i.current.props).onClick)==null||V.call($,{type:"click",target:I,originalEvent:z})}),I.on("dragstart",z=>{var V,K;const $=z;$.lngLat=c.getLngLat(),(K=(V=i.current.props).onDragStart)==null||K.call(V,$)}),I.on("drag",z=>{var V,K;const $=z;$.lngLat=c.getLngLat(),(K=(V=i.current.props).onDrag)==null||K.call(V,$)}),I.on("dragend",z=>{var V,K;const $=z;$.lngLat=c.getLngLat(),(K=(V=i.current.props).onDragEnd)==null||K.call(V,$)}),I},[]);R.useEffect(()=>(c.addTo(n.getMap()),()=>{c.remove()}),[]);const{longitude:u,latitude:a,offset:m,style:p,draggable:y=!1,popup:v=null,rotation:j=0,rotationAlignment:S="auto",pitchAlignment:k="auto"}=e;R.useEffect(()=>{_d(c.getElement(),p)},[p]),R.useImperativeHandle(t,()=>c,[]);const N=i.current.props;(c.getLngLat().lng!==u||c.getLngLat().lat!==a)&&c.setLngLat([u,a]),m&&!mne(c.getOffset(),m)&&c.setOffset(m),c.isDraggable()!==y&&c.setDraggable(y),c.getRotation()!==j&&c.setRotation(j),c.getRotationAlignment()!==S&&c.setRotationAlignment(S),c.getPitchAlignment()!==k&&c.setPitchAlignment(k),c.getPopup()!==v&&c.setPopup(v);const D=rV(N.className,e.className);if(D)for(const O of D)c.toggleClassName(O);return i.current.props=e,of.createPortal(e.children,c.getElement())})),Pne=R.memo(R.forwardRef((e,t)=>{const{map:n,mapLib:s}=R.useContext(wy),i=R.useMemo(()=>document.createElement("div"),[]),c=R.useRef({props:e}),u=R.useMemo(()=>{const a={...e},m=new s.Popup(a);return m.setLngLat([e.longitude,e.latitude]),m.once("open",p=>{var y,v;(v=(y=c.current.props).onOpen)==null||v.call(y,p)}),m},[]);if(R.useEffect(()=>{const a=m=>{var p,y;(y=(p=c.current.props).onClose)==null||y.call(p,m)};return u.on("close",a),u.setDOMContent(i).addTo(n.getMap()),()=>{u.off("close",a),u.isOpen()&&u.remove()}},[]),R.useEffect(()=>{_d(u.getElement(),e.style)},[e.style]),R.useImperativeHandle(t,()=>u,[]),u.isOpen()){const a=c.current.props;(u.getLngLat().lng!==e.longitude||u.getLngLat().lat!==e.latitude)&&u.setLngLat([e.longitude,e.latitude]),e.offset&&!fo(a.offset,e.offset)&&u.setOffset(e.offset),(a.anchor!==e.anchor||a.maxWidth!==e.maxWidth)&&(u.options.anchor=e.anchor,u.setMaxWidth(e.maxWidth));const m=rV(a.className,e.className);if(m)for(const p of m)u.toggleClassName(p);c.current.props=e}return of.createPortal(e.children,i)}));function Jm(e,t,n,s){const i=R.useContext(wy),c=R.useMemo(()=>e(i),[]);return R.useEffect(()=>{const u=t,a=null,m=typeof t=="function"?t:null,{map:p}=i;return p.hasControl(c)||(p.addControl(c,u==null?void 0:u.position),a&&a(i)),()=>{m&&m(i),p.hasControl(c)&&p.removeControl(c)}},[]),c}function Cne(e){const t=Jm(({mapLib:n})=>new n.AttributionControl(e),{position:e.position});return R.useEffect(()=>{_d(t._container,e.style)},[e.style]),null}R.memo(Cne);function Ane(e){const t=Jm(({mapLib:n})=>new n.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return R.useEffect(()=>{_d(t._controlContainer,e.style)},[e.style]),null}const kne=R.memo(Ane);function Tne(e,t){const n=R.useRef({props:e}),s=Jm(({mapLib:i})=>{const c=new i.GeolocateControl(e),u=c._setupUI;return c._setupUI=()=>{c._container.hasChildNodes()||u()},c.on("geolocate",a=>{var m,p;(p=(m=n.current.props).onGeolocate)==null||p.call(m,a)}),c.on("error",a=>{var m,p;(p=(m=n.current.props).onError)==null||p.call(m,a)}),c.on("outofmaxbounds",a=>{var m,p;(p=(m=n.current.props).onOutOfMaxBounds)==null||p.call(m,a)}),c.on("trackuserlocationstart",a=>{var m,p;(p=(m=n.current.props).onTrackUserLocationStart)==null||p.call(m,a)}),c.on("trackuserlocationend",a=>{var m,p;(p=(m=n.current.props).onTrackUserLocationEnd)==null||p.call(m,a)}),c},{position:e.position});return n.current.props=e,R.useImperativeHandle(t,()=>s,[]),R.useEffect(()=>{_d(s._container,e.style)},[e.style]),null}R.memo(R.forwardRef(Tne));function Ene(e){const t=Jm(({mapLib:n})=>new n.NavigationControl(e),{position:e.position});return R.useEffect(()=>{_d(t._container,e.style)},[e.style]),null}const Ib=R.memo(Ene);function Mne(e){const t=Jm(({mapLib:c})=>new c.ScaleControl(e),{position:e.position}),n=R.useRef(e),s=n.current;n.current=e;const{style:i}=e;return e.maxWidth!==void 0&&e.maxWidth!==s.maxWidth&&(t.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==s.unit&&t.setUnit(e.unit),R.useEffect(()=>{_d(t._container,i)},[i]),null}const Db=R.memo(Mne);function One(e){const t=Jm(({mapLib:n})=>new n.TerrainControl(e),{position:e.position});return R.useEffect(()=>{_d(t._container,e.style)},[e.style]),null}R.memo(One);function Ine(e){const t=Jm(({mapLib:n})=>new n.LogoControl(e),{position:e.position});return R.useEffect(()=>{_d(t._container,e.style)},[e.style]),null}R.memo(Ine);function dS(e,t){if(!e)throw new Error(t)}let Dne=0;function Rne(e,t,n){if(e.style&&e.style._loaded){const s={...n};return delete s.id,delete s.children,e.addSource(t,s),e.getSource(t)}return null}function Lne(e,t,n){var u,a,m;dS(t.id===n.id,"source id changed"),dS(t.type===n.type,"source type changed");let s="",i=0;for(const p in t)p!=="children"&&p!=="id"&&!fo(n[p],t[p])&&(s=p,i++);if(!i)return;const c=t.type;if(c==="geojson")e.setData(t.data);else if(c==="image")e.updateImage({url:t.url,coordinates:t.coordinates});else switch(s){case"coordinates":(u=e.setCoordinates)==null||u.call(e,t.coordinates);break;case"url":(a=e.setUrl)==null||a.call(e,t.url);break;case"tiles":(m=e.setTiles)==null||m.call(e,t.tiles);break;default:console.warn(`Unable to update <Source> prop: ${s}`)}}function T0(e){const t=R.useContext(wy).map.getMap(),n=R.useRef(e),[,s]=R.useState(0),i=R.useMemo(()=>e.id||`jsx-source-${Dne++}`,[]);R.useEffect(()=>{if(t){const u=()=>setTimeout(()=>s(a=>a+1),0);return t.on("styledata",u),u(),()=>{var a;if(t.off("styledata",u),t.style&&t.style._loaded&&t.getSource(i)){const m=(a=t.getStyle())==null?void 0:a.layers;if(m)for(const p of m)p.source===i&&t.removeLayer(p.id);t.removeSource(i)}}}},[t]);let c=t&&t.style&&t.getSource(i);return c?Lne(c,e,n.current):c=Rne(t,i,e),n.current=e,c&&R.Children.map(e.children,u=>u&&R.cloneElement(u,{source:i}))||null}function Fne(e,t,n,s){if(dS(n.id===s.id,"layer id changed"),dS(n.type===s.type,"layer type changed"),n.type==="custom"||s.type==="custom")return;const{layout:i={},paint:c={},filter:u,minzoom:a,maxzoom:m,beforeId:p}=n;if(p!==s.beforeId&&e.moveLayer(t,p),i!==s.layout){const y=s.layout||{};for(const v in i)fo(i[v],y[v])||e.setLayoutProperty(t,v,i[v]);for(const v in y)i.hasOwnProperty(v)||e.setLayoutProperty(t,v,void 0)}if(c!==s.paint){const y=s.paint||{};for(const v in c)fo(c[v],y[v])||e.setPaintProperty(t,v,c[v]);for(const v in y)c.hasOwnProperty(v)||e.setPaintProperty(t,v,void 0)}fo(u,s.filter)||e.setFilter(t,u),(a!==s.minzoom||m!==s.maxzoom)&&e.setLayerZoomRange(t,a,m)}function zne(e,t,n){if(e.style&&e.style._loaded&&(!("source"in n)||e.getSource(n.source))){const s={...n,id:t};delete s.beforeId,e.addLayer(s,n.beforeId)}}let $ne=0;function Tx(e){const t=R.useContext(wy).map.getMap(),n=R.useRef(e),[,s]=R.useState(0),i=R.useMemo(()=>e.id||`jsx-layer-${$ne++}`,[]);if(R.useEffect(()=>{if(t){const u=()=>s(a=>a+1);return t.on("styledata",u),u(),()=>{t.off("styledata",u),t.style&&t.style._loaded&&t.getLayer(i)&&t.removeLayer(i)}}},[t]),t&&t.style&&t.getLayer(i))try{Fne(t,i,e,n.current)}catch(u){console.warn(u)}else zne(t,i,e);return n.current=e,null}const Bne={getAll:e=>me.get("/schemes",e),getById:e=>me.get(`/schemes/${e}`),create:e=>me.post("/schemes",e),update:(e,t)=>me.patch(`/schemes/${e}`,t),delete:e=>me.delete(`/schemes/${e}`)};function E0(e,[t,n]){return Math.min(n,Math.max(t,e))}function nr(e,t,{checkForDefaultPrevented:n=!0}={}){return function(i){if(e==null||e(i),n===!1||!i.defaultPrevented)return t==null?void 0:t(i)}}function qne(e,t=[]){let n=[];function s(c,u){const a=R.createContext(u),m=n.length;n=[...n,u];function p(v){const{scope:j,children:S,...k}=v,N=(j==null?void 0:j[e][m])||a,D=R.useMemo(()=>k,Object.values(k));return r.jsx(N.Provider,{value:D,children:S})}function y(v,j){const S=(j==null?void 0:j[e][m])||a,k=R.useContext(S);if(k)return k;if(u!==void 0)return u;throw new Error(`\`${v}\` must be used within \`${c}\``)}return p.displayName=c+"Provider",[p,y]}const i=()=>{const c=n.map(u=>R.createContext(u));return function(a){const m=(a==null?void 0:a[e])||c;return R.useMemo(()=>({[`__scope${e}`]:{...a,[e]:m}}),[a,m])}};return i.scopeName=e,[s,Vne(i,...t)]}function Vne(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const s=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(c){const u=s.reduce((a,{useScope:m,scopeName:p})=>{const v=m(c)[`__scope${p}`];return{...a,...v}},{});return R.useMemo(()=>({[`__scope${t.scopeName}`]:u}),[u])}};return n.scopeName=t.scopeName,n}function n2(e){const t=e+"CollectionProvider",[n,s]=qne(t),[i,c]=n(t,{collectionRef:{current:null},itemMap:new Map}),u=S=>{const{scope:k,children:N}=S,D=de.useRef(null),O=de.useRef(new Map).current;return r.jsx(i,{scope:k,itemMap:O,collectionRef:D,children:N})};u.displayName=t;const a=e+"CollectionSlot",m=de.forwardRef((S,k)=>{const{scope:N,children:D}=S,O=c(a,N),T=yn(k,O.collectionRef);return r.jsx(Gh,{ref:T,children:D})});m.displayName=a;const p=e+"CollectionItemSlot",y="data-radix-collection-item",v=de.forwardRef((S,k)=>{const{scope:N,children:D,...O}=S,T=de.useRef(null),I=yn(k,T),z=c(p,N);return de.useEffect(()=>(z.itemMap.set(T,{ref:T,...O}),()=>void z.itemMap.delete(T))),r.jsx(Gh,{[y]:"",ref:I,children:D})});v.displayName=p;function j(S){const k=c(e+"CollectionConsumer",S);return de.useCallback(()=>{const D=k.collectionRef.current;if(!D)return[];const O=Array.from(D.querySelectorAll(`[${y}]`));return Array.from(k.itemMap.values()).sort((z,$)=>O.indexOf(z.ref.current)-O.indexOf($.ref.current))},[k.collectionRef,k.itemMap])}return[{Provider:u,Slot:m,ItemSlot:v},j,s]}function Une(e,t){const n=R.createContext(t),s=c=>{const{children:u,...a}=c,m=R.useMemo(()=>a,Object.values(a));return r.jsx(n.Provider,{value:m,children:u})};s.displayName=e+"Provider";function i(c){const u=R.useContext(n);if(u)return u;if(t!==void 0)return t;throw new Error(`\`${c}\` must be used within \`${e}\``)}return[s,i]}function bd(e,t=[]){let n=[];function s(c,u){const a=R.createContext(u),m=n.length;n=[...n,u];const p=v=>{var O;const{scope:j,children:S,...k}=v,N=((O=j==null?void 0:j[e])==null?void 0:O[m])||a,D=R.useMemo(()=>k,Object.values(k));return r.jsx(N.Provider,{value:D,children:S})};p.displayName=c+"Provider";function y(v,j){var N;const S=((N=j==null?void 0:j[e])==null?void 0:N[m])||a,k=R.useContext(S);if(k)return k;if(u!==void 0)return u;throw new Error(`\`${v}\` must be used within \`${c}\``)}return[p,y]}const i=()=>{const c=n.map(u=>R.createContext(u));return function(a){const m=(a==null?void 0:a[e])||c;return R.useMemo(()=>({[`__scope${e}`]:{...a,[e]:m}}),[a,m])}};return i.scopeName=e,[s,Wne(i,...t)]}function Wne(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const s=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(c){const u=s.reduce((a,{useScope:m,scopeName:p})=>{const v=m(c)[`__scope${p}`];return{...a,...v}},{});return R.useMemo(()=>({[`__scope${t.scopeName}`]:u}),[u])}};return n.scopeName=t.scopeName,n}var Gne=R.createContext(void 0);function Sy(e){const t=R.useContext(Gne);return e||t||"ltr"}function qi(e){const t=R.useRef(e);return R.useEffect(()=>{t.current=e}),R.useMemo(()=>(...n)=>{var s;return(s=t.current)==null?void 0:s.call(t,...n)},[])}function Kne(e,t=globalThis==null?void 0:globalThis.document){const n=qi(e);R.useEffect(()=>{const s=i=>{i.key==="Escape"&&n(i)};return t.addEventListener("keydown",s,{capture:!0}),()=>t.removeEventListener("keydown",s,{capture:!0})},[n,t])}var Hne="DismissableLayer",ST="dismissableLayer.update",Zne="dismissableLayer.pointerDownOutside",Yne="dismissableLayer.focusOutside",c3,nV=R.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),s2=R.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:c,onInteractOutside:u,onDismiss:a,...m}=e,p=R.useContext(nV),[y,v]=R.useState(null),j=(y==null?void 0:y.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,S]=R.useState({}),k=yn(t,K=>v(K)),N=Array.from(p.layers),[D]=[...p.layersWithOutsidePointerEventsDisabled].slice(-1),O=N.indexOf(D),T=y?N.indexOf(y):-1,I=p.layersWithOutsidePointerEventsDisabled.size>0,z=T>=O,$=Jne(K=>{const te=K.target,X=[...p.branches].some(ve=>ve.contains(te));!z||X||(i==null||i(K),u==null||u(K),K.defaultPrevented||a==null||a())},j),V=ese(K=>{const te=K.target;[...p.branches].some(ve=>ve.contains(te))||(c==null||c(K),u==null||u(K),K.defaultPrevented||a==null||a())},j);return Kne(K=>{T===p.layers.size-1&&(s==null||s(K),!K.defaultPrevented&&a&&(K.preventDefault(),a()))},j),R.useEffect(()=>{if(y)return n&&(p.layersWithOutsidePointerEventsDisabled.size===0&&(c3=j.body.style.pointerEvents,j.body.style.pointerEvents="none"),p.layersWithOutsidePointerEventsDisabled.add(y)),p.layers.add(y),u3(),()=>{n&&p.layersWithOutsidePointerEventsDisabled.size===1&&(j.body.style.pointerEvents=c3)}},[y,j,n,p]),R.useEffect(()=>()=>{y&&(p.layers.delete(y),p.layersWithOutsidePointerEventsDisabled.delete(y),u3())},[y,p]),R.useEffect(()=>{const K=()=>S({});return document.addEventListener(ST,K),()=>document.removeEventListener(ST,K)},[]),r.jsx(zr.div,{...m,ref:k,style:{pointerEvents:I?z?"auto":"none":void 0,...e.style},onFocusCapture:nr(e.onFocusCapture,V.onFocusCapture),onBlurCapture:nr(e.onBlurCapture,V.onBlurCapture),onPointerDownCapture:nr(e.onPointerDownCapture,$.onPointerDownCapture)})});s2.displayName=Hne;var Xne="DismissableLayerBranch",Qne=R.forwardRef((e,t)=>{const n=R.useContext(nV),s=R.useRef(null),i=yn(t,s);return R.useEffect(()=>{const c=s.current;if(c)return n.branches.add(c),()=>{n.branches.delete(c)}},[n.branches]),r.jsx(zr.div,{...e,ref:i})});Qne.displayName=Xne;function Jne(e,t=globalThis==null?void 0:globalThis.document){const n=qi(e),s=R.useRef(!1),i=R.useRef(()=>{});return R.useEffect(()=>{const c=a=>{if(a.target&&!s.current){let m=function(){sV(Zne,n,p,{discrete:!0})};const p={originalEvent:a};a.pointerType==="touch"?(t.removeEventListener("click",i.current),i.current=m,t.addEventListener("click",i.current,{once:!0})):m()}else t.removeEventListener("click",i.current);s.current=!1},u=window.setTimeout(()=>{t.addEventListener("pointerdown",c)},0);return()=>{window.clearTimeout(u),t.removeEventListener("pointerdown",c),t.removeEventListener("click",i.current)}},[t,n]),{onPointerDownCapture:()=>s.current=!0}}function ese(e,t=globalThis==null?void 0:globalThis.document){const n=qi(e),s=R.useRef(!1);return R.useEffect(()=>{const i=c=>{c.target&&!s.current&&sV(Yne,n,{originalEvent:c},{discrete:!1})};return t.addEventListener("focusin",i),()=>t.removeEventListener("focusin",i)},[t,n]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function u3(){const e=new CustomEvent(ST);document.dispatchEvent(e)}function sV(e,t,n,{discrete:s}){const i=n.originalEvent.target,c=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&i.addEventListener(e,t,{once:!0}),s?zq(i,c):i.dispatchEvent(c)}var aA=0;function FO(){R.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??d3()),document.body.insertAdjacentElement("beforeend",e[1]??d3()),aA++,()=>{aA===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),aA--}},[])}function d3(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var oA="focusScope.autoFocusOnMount",lA="focusScope.autoFocusOnUnmount",h3={bubbles:!1,cancelable:!0},tse="FocusScope",i2=R.forwardRef((e,t)=>{const{loop:n=!1,trapped:s=!1,onMountAutoFocus:i,onUnmountAutoFocus:c,...u}=e,[a,m]=R.useState(null),p=qi(i),y=qi(c),v=R.useRef(null),j=yn(t,N=>m(N)),S=R.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;R.useEffect(()=>{if(s){let N=function(I){if(S.paused||!a)return;const z=I.target;a.contains(z)?v.current=z:ah(v.current,{select:!0})},D=function(I){if(S.paused||!a)return;const z=I.relatedTarget;z!==null&&(a.contains(z)||ah(v.current,{select:!0}))},O=function(I){if(document.activeElement===document.body)for(const $ of I)$.removedNodes.length>0&&ah(a)};document.addEventListener("focusin",N),document.addEventListener("focusout",D);const T=new MutationObserver(O);return a&&T.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",N),document.removeEventListener("focusout",D),T.disconnect()}}},[s,a,S.paused]),R.useEffect(()=>{if(a){m3.add(S);const N=document.activeElement;if(!a.contains(N)){const O=new CustomEvent(oA,h3);a.addEventListener(oA,p),a.dispatchEvent(O),O.defaultPrevented||(rse(ose(iV(a)),{select:!0}),document.activeElement===N&&ah(a))}return()=>{a.removeEventListener(oA,p),setTimeout(()=>{const O=new CustomEvent(lA,h3);a.addEventListener(lA,y),a.dispatchEvent(O),O.defaultPrevented||ah(N??document.body,{select:!0}),a.removeEventListener(lA,y),m3.remove(S)},0)}}},[a,p,y,S]);const k=R.useCallback(N=>{if(!n&&!s||S.paused)return;const D=N.key==="Tab"&&!N.altKey&&!N.ctrlKey&&!N.metaKey,O=document.activeElement;if(D&&O){const T=N.currentTarget,[I,z]=nse(T);I&&z?!N.shiftKey&&O===z?(N.preventDefault(),n&&ah(I,{select:!0})):N.shiftKey&&O===I&&(N.preventDefault(),n&&ah(z,{select:!0})):O===T&&N.preventDefault()}},[n,s,S.paused]);return r.jsx(zr.div,{tabIndex:-1,...u,ref:j,onKeyDown:k})});i2.displayName=tse;function rse(e,{select:t=!1}={}){const n=document.activeElement;for(const s of e)if(ah(s,{select:t}),document.activeElement!==n)return}function nse(e){const t=iV(e),n=f3(t,e),s=f3(t.reverse(),e);return[n,s]}function iV(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const i=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||i?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function f3(e,t){for(const n of e)if(!sse(n,{upTo:t}))return n}function sse(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function ise(e){return e instanceof HTMLInputElement&&"select"in e}function ah(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&ise(e)&&t&&e.select()}}var m3=ase();function ase(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=p3(e,t),e.unshift(t)},remove(t){var n;e=p3(e,t),(n=e[0])==null||n.resume()}}}function p3(e,t){const n=[...e],s=n.indexOf(t);return s!==-1&&n.splice(s,1),n}function ose(e){return e.filter(t=>t.tagName!=="A")}var La=globalThis!=null&&globalThis.document?R.useLayoutEffect:()=>{},lse=rB.useId||(()=>{}),cse=0;function Hc(e){const[t,n]=R.useState(lse());return La(()=>{n(s=>s??String(cse++))},[e]),t?`radix-${t}`:""}const use=["top","right","bottom","left"],Hh=Math.min,Bo=Math.max,hS=Math.round,qw=Math.floor,Zc=e=>({x:e,y:e}),dse={left:"right",right:"left",bottom:"top",top:"bottom"},hse={start:"end",end:"start"};function NT(e,t,n){return Bo(e,Hh(t,n))}function ld(e,t){return typeof e=="function"?e(t):e}function cd(e){return e.split("-")[0]}function Ny(e){return e.split("-")[1]}function zO(e){return e==="x"?"y":"x"}function $O(e){return e==="y"?"height":"width"}function Zh(e){return["top","bottom"].includes(cd(e))?"y":"x"}function BO(e){return zO(Zh(e))}function fse(e,t,n){n===void 0&&(n=!1);const s=Ny(e),i=BO(e),c=$O(i);let u=i==="x"?s===(n?"end":"start")?"right":"left":s==="start"?"bottom":"top";return t.reference[c]>t.floating[c]&&(u=fS(u)),[u,fS(u)]}function mse(e){const t=fS(e);return[PT(e),t,PT(t)]}function PT(e){return e.replace(/start|end/g,t=>hse[t])}function pse(e,t,n){const s=["left","right"],i=["right","left"],c=["top","bottom"],u=["bottom","top"];switch(e){case"top":case"bottom":return n?t?i:s:t?s:i;case"left":case"right":return t?c:u;default:return[]}}function gse(e,t,n,s){const i=Ny(e);let c=pse(cd(e),n==="start",s);return i&&(c=c.map(u=>u+"-"+i),t&&(c=c.concat(c.map(PT)))),c}function fS(e){return e.replace(/left|right|bottom|top/g,t=>dse[t])}function xse(e){return{top:0,right:0,bottom:0,left:0,...e}}function aV(e){return typeof e!="number"?xse(e):{top:e,right:e,bottom:e,left:e}}function mS(e){const{x:t,y:n,width:s,height:i}=e;return{width:s,height:i,top:n,left:t,right:t+s,bottom:n+i,x:t,y:n}}function g3(e,t,n){let{reference:s,floating:i}=e;const c=Zh(t),u=BO(t),a=$O(u),m=cd(t),p=c==="y",y=s.x+s.width/2-i.width/2,v=s.y+s.height/2-i.height/2,j=s[a]/2-i[a]/2;let S;switch(m){case"top":S={x:y,y:s.y-i.height};break;case"bottom":S={x:y,y:s.y+s.height};break;case"right":S={x:s.x+s.width,y:v};break;case"left":S={x:s.x-i.width,y:v};break;default:S={x:s.x,y:s.y}}switch(Ny(t)){case"start":S[u]-=j*(n&&p?-1:1);break;case"end":S[u]+=j*(n&&p?-1:1);break}return S}const yse=async(e,t,n)=>{const{placement:s="bottom",strategy:i="absolute",middleware:c=[],platform:u}=n,a=c.filter(Boolean),m=await(u.isRTL==null?void 0:u.isRTL(t));let p=await u.getElementRects({reference:e,floating:t,strategy:i}),{x:y,y:v}=g3(p,s,m),j=s,S={},k=0;for(let N=0;N<a.length;N++){const{name:D,fn:O}=a[N],{x:T,y:I,data:z,reset:$}=await O({x:y,y:v,initialPlacement:s,placement:j,strategy:i,middlewareData:S,rects:p,platform:u,elements:{reference:e,floating:t}});y=T??y,v=I??v,S={...S,[D]:{...S[D],...z}},$&&k<=50&&(k++,typeof $=="object"&&($.placement&&(j=$.placement),$.rects&&(p=$.rects===!0?await u.getElementRects({reference:e,floating:t,strategy:i}):$.rects),{x:y,y:v}=g3(p,j,m)),N=-1)}return{x:y,y:v,placement:j,strategy:i,middlewareData:S}};async function M0(e,t){var n;t===void 0&&(t={});const{x:s,y:i,platform:c,rects:u,elements:a,strategy:m}=e,{boundary:p="clippingAncestors",rootBoundary:y="viewport",elementContext:v="floating",altBoundary:j=!1,padding:S=0}=ld(t,e),k=aV(S),D=a[j?v==="floating"?"reference":"floating":v],O=mS(await c.getClippingRect({element:(n=await(c.isElement==null?void 0:c.isElement(D)))==null||n?D:D.contextElement||await(c.getDocumentElement==null?void 0:c.getDocumentElement(a.floating)),boundary:p,rootBoundary:y,strategy:m})),T=v==="floating"?{x:s,y:i,width:u.floating.width,height:u.floating.height}:u.reference,I=await(c.getOffsetParent==null?void 0:c.getOffsetParent(a.floating)),z=await(c.isElement==null?void 0:c.isElement(I))?await(c.getScale==null?void 0:c.getScale(I))||{x:1,y:1}:{x:1,y:1},$=mS(c.convertOffsetParentRelativeRectToViewportRelativeRect?await c.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:T,offsetParent:I,strategy:m}):T);return{top:(O.top-$.top+k.top)/z.y,bottom:($.bottom-O.bottom+k.bottom)/z.y,left:(O.left-$.left+k.left)/z.x,right:($.right-O.right+k.right)/z.x}}const vse=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:s,placement:i,rects:c,platform:u,elements:a,middlewareData:m}=t,{element:p,padding:y=0}=ld(e,t)||{};if(p==null)return{};const v=aV(y),j={x:n,y:s},S=BO(i),k=$O(S),N=await u.getDimensions(p),D=S==="y",O=D?"top":"left",T=D?"bottom":"right",I=D?"clientHeight":"clientWidth",z=c.reference[k]+c.reference[S]-j[S]-c.floating[k],$=j[S]-c.reference[S],V=await(u.getOffsetParent==null?void 0:u.getOffsetParent(p));let K=V?V[I]:0;(!K||!await(u.isElement==null?void 0:u.isElement(V)))&&(K=a.floating[I]||c.floating[k]);const te=z/2-$/2,X=K/2-N[k]/2-1,ve=Hh(v[O],X),ae=Hh(v[T],X),pe=ve,Oe=K-N[k]-ae,Me=K/2-N[k]/2+te,Xe=NT(pe,Me,Oe),Ve=!m.arrow&&Ny(i)!=null&&Me!==Xe&&c.reference[k]/2-(Me<pe?ve:ae)-N[k]/2<0,et=Ve?Me<pe?Me-pe:Me-Oe:0;return{[S]:j[S]+et,data:{[S]:Xe,centerOffset:Me-Xe-et,...Ve&&{alignmentOffset:et}},reset:Ve}}}),_se=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,s;const{placement:i,middlewareData:c,rects:u,initialPlacement:a,platform:m,elements:p}=t,{mainAxis:y=!0,crossAxis:v=!0,fallbackPlacements:j,fallbackStrategy:S="bestFit",fallbackAxisSideDirection:k="none",flipAlignment:N=!0,...D}=ld(e,t);if((n=c.arrow)!=null&&n.alignmentOffset)return{};const O=cd(i),T=Zh(a),I=cd(a)===a,z=await(m.isRTL==null?void 0:m.isRTL(p.floating)),$=j||(I||!N?[fS(a)]:mse(a)),V=k!=="none";!j&&V&&$.push(...gse(a,N,k,z));const K=[a,...$],te=await M0(t,D),X=[];let ve=((s=c.flip)==null?void 0:s.overflows)||[];if(y&&X.push(te[O]),v){const Me=fse(i,u,z);X.push(te[Me[0]],te[Me[1]])}if(ve=[...ve,{placement:i,overflows:X}],!X.every(Me=>Me<=0)){var ae,pe;const Me=(((ae=c.flip)==null?void 0:ae.index)||0)+1,Xe=K[Me];if(Xe)return{data:{index:Me,overflows:ve},reset:{placement:Xe}};let Ve=(pe=ve.filter(et=>et.overflows[0]<=0).sort((et,Ce)=>et.overflows[1]-Ce.overflows[1])[0])==null?void 0:pe.placement;if(!Ve)switch(S){case"bestFit":{var Oe;const et=(Oe=ve.filter(Ce=>{if(V){const _e=Zh(Ce.placement);return _e===T||_e==="y"}return!0}).map(Ce=>[Ce.placement,Ce.overflows.filter(_e=>_e>0).reduce((_e,tt)=>_e+tt,0)]).sort((Ce,_e)=>Ce[1]-_e[1])[0])==null?void 0:Oe[0];et&&(Ve=et);break}case"initialPlacement":Ve=a;break}if(i!==Ve)return{reset:{placement:Ve}}}return{}}}};function x3(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function y3(e){return use.some(t=>e[t]>=0)}const bse=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:s="referenceHidden",...i}=ld(e,t);switch(s){case"referenceHidden":{const c=await M0(t,{...i,elementContext:"reference"}),u=x3(c,n.reference);return{data:{referenceHiddenOffsets:u,referenceHidden:y3(u)}}}case"escaped":{const c=await M0(t,{...i,altBoundary:!0}),u=x3(c,n.floating);return{data:{escapedOffsets:u,escaped:y3(u)}}}default:return{}}}}};async function jse(e,t){const{placement:n,platform:s,elements:i}=e,c=await(s.isRTL==null?void 0:s.isRTL(i.floating)),u=cd(n),a=Ny(n),m=Zh(n)==="y",p=["left","top"].includes(u)?-1:1,y=c&&m?-1:1,v=ld(t,e);let{mainAxis:j,crossAxis:S,alignmentAxis:k}=typeof v=="number"?{mainAxis:v,crossAxis:0,alignmentAxis:null}:{mainAxis:v.mainAxis||0,crossAxis:v.crossAxis||0,alignmentAxis:v.alignmentAxis};return a&&typeof k=="number"&&(S=a==="end"?k*-1:k),m?{x:S*y,y:j*p}:{x:j*p,y:S*y}}const wse=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,s;const{x:i,y:c,placement:u,middlewareData:a}=t,m=await jse(t,e);return u===((n=a.offset)==null?void 0:n.placement)&&(s=a.arrow)!=null&&s.alignmentOffset?{}:{x:i+m.x,y:c+m.y,data:{...m,placement:u}}}}},Sse=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:s,placement:i}=t,{mainAxis:c=!0,crossAxis:u=!1,limiter:a={fn:D=>{let{x:O,y:T}=D;return{x:O,y:T}}},...m}=ld(e,t),p={x:n,y:s},y=await M0(t,m),v=Zh(cd(i)),j=zO(v);let S=p[j],k=p[v];if(c){const D=j==="y"?"top":"left",O=j==="y"?"bottom":"right",T=S+y[D],I=S-y[O];S=NT(T,S,I)}if(u){const D=v==="y"?"top":"left",O=v==="y"?"bottom":"right",T=k+y[D],I=k-y[O];k=NT(T,k,I)}const N=a.fn({...t,[j]:S,[v]:k});return{...N,data:{x:N.x-n,y:N.y-s,enabled:{[j]:c,[v]:u}}}}}},Nse=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:s,placement:i,rects:c,middlewareData:u}=t,{offset:a=0,mainAxis:m=!0,crossAxis:p=!0}=ld(e,t),y={x:n,y:s},v=Zh(i),j=zO(v);let S=y[j],k=y[v];const N=ld(a,t),D=typeof N=="number"?{mainAxis:N,crossAxis:0}:{mainAxis:0,crossAxis:0,...N};if(m){const I=j==="y"?"height":"width",z=c.reference[j]-c.floating[I]+D.mainAxis,$=c.reference[j]+c.reference[I]-D.mainAxis;S<z?S=z:S>$&&(S=$)}if(p){var O,T;const I=j==="y"?"width":"height",z=["top","left"].includes(cd(i)),$=c.reference[v]-c.floating[I]+(z&&((O=u.offset)==null?void 0:O[v])||0)+(z?0:D.crossAxis),V=c.reference[v]+c.reference[I]+(z?0:((T=u.offset)==null?void 0:T[v])||0)-(z?D.crossAxis:0);k<$?k=$:k>V&&(k=V)}return{[j]:S,[v]:k}}}},Pse=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,s;const{placement:i,rects:c,platform:u,elements:a}=t,{apply:m=()=>{},...p}=ld(e,t),y=await M0(t,p),v=cd(i),j=Ny(i),S=Zh(i)==="y",{width:k,height:N}=c.floating;let D,O;v==="top"||v==="bottom"?(D=v,O=j===(await(u.isRTL==null?void 0:u.isRTL(a.floating))?"start":"end")?"left":"right"):(O=v,D=j==="end"?"top":"bottom");const T=N-y.top-y.bottom,I=k-y.left-y.right,z=Hh(N-y[D],T),$=Hh(k-y[O],I),V=!t.middlewareData.shift;let K=z,te=$;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(te=I),(s=t.middlewareData.shift)!=null&&s.enabled.y&&(K=T),V&&!j){const ve=Bo(y.left,0),ae=Bo(y.right,0),pe=Bo(y.top,0),Oe=Bo(y.bottom,0);S?te=k-2*(ve!==0||ae!==0?ve+ae:Bo(y.left,y.right)):K=N-2*(pe!==0||Oe!==0?pe+Oe:Bo(y.top,y.bottom))}await m({...t,availableWidth:te,availableHeight:K});const X=await u.getDimensions(a.floating);return k!==X.width||N!==X.height?{reset:{rects:!0}}:{}}}};function a2(){return typeof window<"u"}function Py(e){return oV(e)?(e.nodeName||"").toLowerCase():"#document"}function Ho(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function su(e){var t;return(t=(oV(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function oV(e){return a2()?e instanceof Node||e instanceof Ho(e).Node:!1}function yc(e){return a2()?e instanceof Element||e instanceof Ho(e).Element:!1}function Jc(e){return a2()?e instanceof HTMLElement||e instanceof Ho(e).HTMLElement:!1}function v3(e){return!a2()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ho(e).ShadowRoot}function Rb(e){const{overflow:t,overflowX:n,overflowY:s,display:i}=vc(e);return/auto|scroll|overlay|hidden|clip/.test(t+s+n)&&!["inline","contents"].includes(i)}function Cse(e){return["table","td","th"].includes(Py(e))}function o2(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function qO(e){const t=VO(),n=yc(e)?vc(e):e;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(s=>(n.willChange||"").includes(s))||["paint","layout","strict","content"].some(s=>(n.contain||"").includes(s))}function Ase(e){let t=Yh(e);for(;Jc(t)&&!Ex(t);){if(qO(t))return t;if(o2(t))return null;t=Yh(t)}return null}function VO(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Ex(e){return["html","body","#document"].includes(Py(e))}function vc(e){return Ho(e).getComputedStyle(e)}function l2(e){return yc(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Yh(e){if(Py(e)==="html")return e;const t=e.assignedSlot||e.parentNode||v3(e)&&e.host||su(e);return v3(t)?t.host:t}function lV(e){const t=Yh(e);return Ex(t)?e.ownerDocument?e.ownerDocument.body:e.body:Jc(t)&&Rb(t)?t:lV(t)}function O0(e,t,n){var s;t===void 0&&(t=[]),n===void 0&&(n=!0);const i=lV(e),c=i===((s=e.ownerDocument)==null?void 0:s.body),u=Ho(i);if(c){const a=CT(u);return t.concat(u,u.visualViewport||[],Rb(i)?i:[],a&&n?O0(a):[])}return t.concat(i,O0(i,[],n))}function CT(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function cV(e){const t=vc(e);let n=parseFloat(t.width)||0,s=parseFloat(t.height)||0;const i=Jc(e),c=i?e.offsetWidth:n,u=i?e.offsetHeight:s,a=hS(n)!==c||hS(s)!==u;return a&&(n=c,s=u),{width:n,height:s,$:a}}function UO(e){return yc(e)?e:e.contextElement}function Yg(e){const t=UO(e);if(!Jc(t))return Zc(1);const n=t.getBoundingClientRect(),{width:s,height:i,$:c}=cV(t);let u=(c?hS(n.width):n.width)/s,a=(c?hS(n.height):n.height)/i;return(!u||!Number.isFinite(u))&&(u=1),(!a||!Number.isFinite(a))&&(a=1),{x:u,y:a}}const kse=Zc(0);function uV(e){const t=Ho(e);return!VO()||!t.visualViewport?kse:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Tse(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==Ho(e)?!1:t}function zm(e,t,n,s){t===void 0&&(t=!1),n===void 0&&(n=!1);const i=e.getBoundingClientRect(),c=UO(e);let u=Zc(1);t&&(s?yc(s)&&(u=Yg(s)):u=Yg(e));const a=Tse(c,n,s)?uV(c):Zc(0);let m=(i.left+a.x)/u.x,p=(i.top+a.y)/u.y,y=i.width/u.x,v=i.height/u.y;if(c){const j=Ho(c),S=s&&yc(s)?Ho(s):s;let k=j,N=CT(k);for(;N&&s&&S!==k;){const D=Yg(N),O=N.getBoundingClientRect(),T=vc(N),I=O.left+(N.clientLeft+parseFloat(T.paddingLeft))*D.x,z=O.top+(N.clientTop+parseFloat(T.paddingTop))*D.y;m*=D.x,p*=D.y,y*=D.x,v*=D.y,m+=I,p+=z,k=Ho(N),N=CT(k)}}return mS({width:y,height:v,x:m,y:p})}function WO(e,t){const n=l2(e).scrollLeft;return t?t.left+n:zm(su(e)).left+n}function dV(e,t,n){n===void 0&&(n=!1);const s=e.getBoundingClientRect(),i=s.left+t.scrollLeft-(n?0:WO(e,s)),c=s.top+t.scrollTop;return{x:i,y:c}}function Ese(e){let{elements:t,rect:n,offsetParent:s,strategy:i}=e;const c=i==="fixed",u=su(s),a=t?o2(t.floating):!1;if(s===u||a&&c)return n;let m={scrollLeft:0,scrollTop:0},p=Zc(1);const y=Zc(0),v=Jc(s);if((v||!v&&!c)&&((Py(s)!=="body"||Rb(u))&&(m=l2(s)),Jc(s))){const S=zm(s);p=Yg(s),y.x=S.x+s.clientLeft,y.y=S.y+s.clientTop}const j=u&&!v&&!c?dV(u,m,!0):Zc(0);return{width:n.width*p.x,height:n.height*p.y,x:n.x*p.x-m.scrollLeft*p.x+y.x+j.x,y:n.y*p.y-m.scrollTop*p.y+y.y+j.y}}function Mse(e){return Array.from(e.getClientRects())}function Ose(e){const t=su(e),n=l2(e),s=e.ownerDocument.body,i=Bo(t.scrollWidth,t.clientWidth,s.scrollWidth,s.clientWidth),c=Bo(t.scrollHeight,t.clientHeight,s.scrollHeight,s.clientHeight);let u=-n.scrollLeft+WO(e);const a=-n.scrollTop;return vc(s).direction==="rtl"&&(u+=Bo(t.clientWidth,s.clientWidth)-i),{width:i,height:c,x:u,y:a}}function Ise(e,t){const n=Ho(e),s=su(e),i=n.visualViewport;let c=s.clientWidth,u=s.clientHeight,a=0,m=0;if(i){c=i.width,u=i.height;const p=VO();(!p||p&&t==="fixed")&&(a=i.offsetLeft,m=i.offsetTop)}return{width:c,height:u,x:a,y:m}}function Dse(e,t){const n=zm(e,!0,t==="fixed"),s=n.top+e.clientTop,i=n.left+e.clientLeft,c=Jc(e)?Yg(e):Zc(1),u=e.clientWidth*c.x,a=e.clientHeight*c.y,m=i*c.x,p=s*c.y;return{width:u,height:a,x:m,y:p}}function _3(e,t,n){let s;if(t==="viewport")s=Ise(e,n);else if(t==="document")s=Ose(su(e));else if(yc(t))s=Dse(t,n);else{const i=uV(e);s={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return mS(s)}function hV(e,t){const n=Yh(e);return n===t||!yc(n)||Ex(n)?!1:vc(n).position==="fixed"||hV(n,t)}function Rse(e,t){const n=t.get(e);if(n)return n;let s=O0(e,[],!1).filter(a=>yc(a)&&Py(a)!=="body"),i=null;const c=vc(e).position==="fixed";let u=c?Yh(e):e;for(;yc(u)&&!Ex(u);){const a=vc(u),m=qO(u);!m&&a.position==="fixed"&&(i=null),(c?!m&&!i:!m&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Rb(u)&&!m&&hV(e,u))?s=s.filter(y=>y!==u):i=a,u=Yh(u)}return t.set(e,s),s}function Lse(e){let{element:t,boundary:n,rootBoundary:s,strategy:i}=e;const u=[...n==="clippingAncestors"?o2(t)?[]:Rse(t,this._c):[].concat(n),s],a=u[0],m=u.reduce((p,y)=>{const v=_3(t,y,i);return p.top=Bo(v.top,p.top),p.right=Hh(v.right,p.right),p.bottom=Hh(v.bottom,p.bottom),p.left=Bo(v.left,p.left),p},_3(t,a,i));return{width:m.right-m.left,height:m.bottom-m.top,x:m.left,y:m.top}}function Fse(e){const{width:t,height:n}=cV(e);return{width:t,height:n}}function zse(e,t,n){const s=Jc(t),i=su(t),c=n==="fixed",u=zm(e,!0,c,t);let a={scrollLeft:0,scrollTop:0};const m=Zc(0);if(s||!s&&!c)if((Py(t)!=="body"||Rb(i))&&(a=l2(t)),s){const j=zm(t,!0,c,t);m.x=j.x+t.clientLeft,m.y=j.y+t.clientTop}else i&&(m.x=WO(i));const p=i&&!s&&!c?dV(i,a):Zc(0),y=u.left+a.scrollLeft-m.x-p.x,v=u.top+a.scrollTop-m.y-p.y;return{x:y,y:v,width:u.width,height:u.height}}function cA(e){return vc(e).position==="static"}function b3(e,t){if(!Jc(e)||vc(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return su(e)===n&&(n=n.ownerDocument.body),n}function fV(e,t){const n=Ho(e);if(o2(e))return n;if(!Jc(e)){let i=Yh(e);for(;i&&!Ex(i);){if(yc(i)&&!cA(i))return i;i=Yh(i)}return n}let s=b3(e,t);for(;s&&Cse(s)&&cA(s);)s=b3(s,t);return s&&Ex(s)&&cA(s)&&!qO(s)?n:s||Ase(e)||n}const $se=async function(e){const t=this.getOffsetParent||fV,n=this.getDimensions,s=await n(e.floating);return{reference:zse(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function Bse(e){return vc(e).direction==="rtl"}const qse={convertOffsetParentRelativeRectToViewportRelativeRect:Ese,getDocumentElement:su,getClippingRect:Lse,getOffsetParent:fV,getElementRects:$se,getClientRects:Mse,getDimensions:Fse,getScale:Yg,isElement:yc,isRTL:Bse};function Vse(e,t){let n=null,s;const i=su(e);function c(){var a;clearTimeout(s),(a=n)==null||a.disconnect(),n=null}function u(a,m){a===void 0&&(a=!1),m===void 0&&(m=1),c();const{left:p,top:y,width:v,height:j}=e.getBoundingClientRect();if(a||t(),!v||!j)return;const S=qw(y),k=qw(i.clientWidth-(p+v)),N=qw(i.clientHeight-(y+j)),D=qw(p),T={rootMargin:-S+"px "+-k+"px "+-N+"px "+-D+"px",threshold:Bo(0,Hh(1,m))||1};let I=!0;function z($){const V=$[0].intersectionRatio;if(V!==m){if(!I)return u();V?u(!1,V):s=setTimeout(()=>{u(!1,1e-7)},1e3)}I=!1}try{n=new IntersectionObserver(z,{...T,root:i.ownerDocument})}catch{n=new IntersectionObserver(z,T)}n.observe(e)}return u(!0),c}function Use(e,t,n,s){s===void 0&&(s={});const{ancestorScroll:i=!0,ancestorResize:c=!0,elementResize:u=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:m=!1}=s,p=UO(e),y=i||c?[...p?O0(p):[],...O0(t)]:[];y.forEach(O=>{i&&O.addEventListener("scroll",n,{passive:!0}),c&&O.addEventListener("resize",n)});const v=p&&a?Vse(p,n):null;let j=-1,S=null;u&&(S=new ResizeObserver(O=>{let[T]=O;T&&T.target===p&&S&&(S.unobserve(t),cancelAnimationFrame(j),j=requestAnimationFrame(()=>{var I;(I=S)==null||I.observe(t)})),n()}),p&&!m&&S.observe(p),S.observe(t));let k,N=m?zm(e):null;m&&D();function D(){const O=zm(e);N&&(O.x!==N.x||O.y!==N.y||O.width!==N.width||O.height!==N.height)&&n(),N=O,k=requestAnimationFrame(D)}return n(),()=>{var O;y.forEach(T=>{i&&T.removeEventListener("scroll",n),c&&T.removeEventListener("resize",n)}),v==null||v(),(O=S)==null||O.disconnect(),S=null,m&&cancelAnimationFrame(k)}}const Wse=wse,Gse=Sse,Kse=_se,Hse=Pse,Zse=bse,j3=vse,Yse=Nse,Xse=(e,t,n)=>{const s=new Map,i={platform:qse,...n},c={...i.platform,_c:s};return yse(e,t,{...i,platform:c})};var k1=typeof document<"u"?R.useLayoutEffect:R.useEffect;function pS(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,s,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(s=n;s--!==0;)if(!pS(e[s],t[s]))return!1;return!0}if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(s=n;s--!==0;)if(!{}.hasOwnProperty.call(t,i[s]))return!1;for(s=n;s--!==0;){const c=i[s];if(!(c==="_owner"&&e.$$typeof)&&!pS(e[c],t[c]))return!1}return!0}return e!==e&&t!==t}function mV(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function w3(e,t){const n=mV(e);return Math.round(t*n)/n}function uA(e){const t=R.useRef(e);return k1(()=>{t.current=e}),t}function Qse(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:s=[],platform:i,elements:{reference:c,floating:u}={},transform:a=!0,whileElementsMounted:m,open:p}=e,[y,v]=R.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[j,S]=R.useState(s);pS(j,s)||S(s);const[k,N]=R.useState(null),[D,O]=R.useState(null),T=R.useCallback(Ce=>{Ce!==V.current&&(V.current=Ce,N(Ce))},[]),I=R.useCallback(Ce=>{Ce!==K.current&&(K.current=Ce,O(Ce))},[]),z=c||k,$=u||D,V=R.useRef(null),K=R.useRef(null),te=R.useRef(y),X=m!=null,ve=uA(m),ae=uA(i),pe=uA(p),Oe=R.useCallback(()=>{if(!V.current||!K.current)return;const Ce={placement:t,strategy:n,middleware:j};ae.current&&(Ce.platform=ae.current),Xse(V.current,K.current,Ce).then(_e=>{const tt={..._e,isPositioned:pe.current!==!1};Me.current&&!pS(te.current,tt)&&(te.current=tt,of.flushSync(()=>{v(tt)}))})},[j,t,n,ae,pe]);k1(()=>{p===!1&&te.current.isPositioned&&(te.current.isPositioned=!1,v(Ce=>({...Ce,isPositioned:!1})))},[p]);const Me=R.useRef(!1);k1(()=>(Me.current=!0,()=>{Me.current=!1}),[]),k1(()=>{if(z&&(V.current=z),$&&(K.current=$),z&&$){if(ve.current)return ve.current(z,$,Oe);Oe()}},[z,$,Oe,ve,X]);const Xe=R.useMemo(()=>({reference:V,floating:K,setReference:T,setFloating:I}),[T,I]),Ve=R.useMemo(()=>({reference:z,floating:$}),[z,$]),et=R.useMemo(()=>{const Ce={position:n,left:0,top:0};if(!Ve.floating)return Ce;const _e=w3(Ve.floating,y.x),tt=w3(Ve.floating,y.y);return a?{...Ce,transform:"translate("+_e+"px, "+tt+"px)",...mV(Ve.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:_e,top:tt}},[n,a,Ve.floating,y.x,y.y]);return R.useMemo(()=>({...y,update:Oe,refs:Xe,elements:Ve,floatingStyles:et}),[y,Oe,Xe,Ve,et])}const Jse=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:s,padding:i}=typeof e=="function"?e(n):e;return s&&t(s)?s.current!=null?j3({element:s.current,padding:i}).fn(n):{}:s?j3({element:s,padding:i}).fn(n):{}}}},eie=(e,t)=>({...Wse(e),options:[e,t]}),tie=(e,t)=>({...Gse(e),options:[e,t]}),rie=(e,t)=>({...Yse(e),options:[e,t]}),nie=(e,t)=>({...Kse(e),options:[e,t]}),sie=(e,t)=>({...Hse(e),options:[e,t]}),iie=(e,t)=>({...Zse(e),options:[e,t]}),aie=(e,t)=>({...Jse(e),options:[e,t]});var oie="Arrow",pV=R.forwardRef((e,t)=>{const{children:n,width:s=10,height:i=5,...c}=e;return r.jsx(zr.svg,{...c,ref:t,width:s,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:r.jsx("polygon",{points:"0,0 30,0 15,10"})})});pV.displayName=oie;var lie=pV;function cie(e,t=[]){let n=[];function s(c,u){const a=R.createContext(u),m=n.length;n=[...n,u];function p(v){const{scope:j,children:S,...k}=v,N=(j==null?void 0:j[e][m])||a,D=R.useMemo(()=>k,Object.values(k));return r.jsx(N.Provider,{value:D,children:S})}function y(v,j){const S=(j==null?void 0:j[e][m])||a,k=R.useContext(S);if(k)return k;if(u!==void 0)return u;throw new Error(`\`${v}\` must be used within \`${c}\``)}return p.displayName=c+"Provider",[p,y]}const i=()=>{const c=n.map(u=>R.createContext(u));return function(a){const m=(a==null?void 0:a[e])||c;return R.useMemo(()=>({[`__scope${e}`]:{...a,[e]:m}}),[a,m])}};return i.scopeName=e,[s,uie(i,...t)]}function uie(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const s=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(c){const u=s.reduce((a,{useScope:m,scopeName:p})=>{const v=m(c)[`__scope${p}`];return{...a,...v}},{});return R.useMemo(()=>({[`__scope${t.scopeName}`]:u}),[u])}};return n.scopeName=t.scopeName,n}function c2(e){const[t,n]=R.useState(void 0);return La(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const s=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const c=i[0];let u,a;if("borderBoxSize"in c){const m=c.borderBoxSize,p=Array.isArray(m)?m[0]:m;u=p.inlineSize,a=p.blockSize}else u=e.offsetWidth,a=e.offsetHeight;n({width:u,height:a})});return s.observe(e,{box:"border-box"}),()=>s.unobserve(e)}else n(void 0)},[e]),t}var GO="Popper",[gV,u2]=cie(GO),[die,xV]=gV(GO),yV=e=>{const{__scopePopper:t,children:n}=e,[s,i]=R.useState(null);return r.jsx(die,{scope:t,anchor:s,onAnchorChange:i,children:n})};yV.displayName=GO;var vV="PopperAnchor",_V=R.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:s,...i}=e,c=xV(vV,n),u=R.useRef(null),a=yn(t,u);return R.useEffect(()=>{c.onAnchorChange((s==null?void 0:s.current)||u.current)}),s?null:r.jsx(zr.div,{...i,ref:a})});_V.displayName=vV;var KO="PopperContent",[hie,fie]=gV(KO),bV=R.forwardRef((e,t)=>{var Mt,yr,Nt,Wt,Zt,mt;const{__scopePopper:n,side:s="bottom",sideOffset:i=0,align:c="center",alignOffset:u=0,arrowPadding:a=0,avoidCollisions:m=!0,collisionBoundary:p=[],collisionPadding:y=0,sticky:v="partial",hideWhenDetached:j=!1,updatePositionStrategy:S="optimized",onPlaced:k,...N}=e,D=xV(KO,n),[O,T]=R.useState(null),I=yn(t,qr=>T(qr)),[z,$]=R.useState(null),V=c2(z),K=(V==null?void 0:V.width)??0,te=(V==null?void 0:V.height)??0,X=s+(c!=="center"?"-"+c:""),ve=typeof y=="number"?y:{top:0,right:0,bottom:0,left:0,...y},ae=Array.isArray(p)?p:[p],pe=ae.length>0,Oe={padding:ve,boundary:ae.filter(pie),altBoundary:pe},{refs:Me,floatingStyles:Xe,placement:Ve,isPositioned:et,middlewareData:Ce}=Qse({strategy:"fixed",placement:X,whileElementsMounted:(...qr)=>Use(...qr,{animationFrame:S==="always"}),elements:{reference:D.anchor},middleware:[eie({mainAxis:i+te,alignmentAxis:u}),m&&tie({mainAxis:!0,crossAxis:!1,limiter:v==="partial"?rie():void 0,...Oe}),m&&nie({...Oe}),sie({...Oe,apply:({elements:qr,rects:ar,availableWidth:en,availableHeight:Lr})=>{const{width:An,height:vs}=ar.reference,Wn=qr.floating.style;Wn.setProperty("--radix-popper-available-width",`${en}px`),Wn.setProperty("--radix-popper-available-height",`${Lr}px`),Wn.setProperty("--radix-popper-anchor-width",`${An}px`),Wn.setProperty("--radix-popper-anchor-height",`${vs}px`)}}),z&&aie({element:z,padding:a}),gie({arrowWidth:K,arrowHeight:te}),j&&iie({strategy:"referenceHidden",...Oe})]}),[_e,tt]=SV(Ve),vt=qi(k);La(()=>{et&&(vt==null||vt())},[et,vt]);const gt=(Mt=Ce.arrow)==null?void 0:Mt.x,Tt=(yr=Ce.arrow)==null?void 0:yr.y,Ht=((Nt=Ce.arrow)==null?void 0:Nt.centerOffset)!==0,[Ir,Pr]=R.useState();return La(()=>{O&&Pr(window.getComputedStyle(O).zIndex)},[O]),r.jsx("div",{ref:Me.setFloating,"data-radix-popper-content-wrapper":"",style:{...Xe,transform:et?Xe.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Ir,"--radix-popper-transform-origin":[(Wt=Ce.transformOrigin)==null?void 0:Wt.x,(Zt=Ce.transformOrigin)==null?void 0:Zt.y].join(" "),...((mt=Ce.hide)==null?void 0:mt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:r.jsx(hie,{scope:n,placedSide:_e,onArrowChange:$,arrowX:gt,arrowY:Tt,shouldHideArrow:Ht,children:r.jsx(zr.div,{"data-side":_e,"data-align":tt,...N,ref:I,style:{...N.style,animation:et?void 0:"none"}})})})});bV.displayName=KO;var jV="PopperArrow",mie={top:"bottom",right:"left",bottom:"top",left:"right"},wV=R.forwardRef(function(t,n){const{__scopePopper:s,...i}=t,c=fie(jV,s),u=mie[c.placedSide];return r.jsx("span",{ref:c.onArrowChange,style:{position:"absolute",left:c.arrowX,top:c.arrowY,[u]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[c.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[c.placedSide],visibility:c.shouldHideArrow?"hidden":void 0},children:r.jsx(lie,{...i,ref:n,style:{...i.style,display:"block"}})})});wV.displayName=jV;function pie(e){return e!==null}var gie=e=>({name:"transformOrigin",options:e,fn(t){var D,O,T;const{placement:n,rects:s,middlewareData:i}=t,u=((D=i.arrow)==null?void 0:D.centerOffset)!==0,a=u?0:e.arrowWidth,m=u?0:e.arrowHeight,[p,y]=SV(n),v={start:"0%",center:"50%",end:"100%"}[y],j=(((O=i.arrow)==null?void 0:O.x)??0)+a/2,S=(((T=i.arrow)==null?void 0:T.y)??0)+m/2;let k="",N="";return p==="bottom"?(k=u?v:`${j}px`,N=`${-m}px`):p==="top"?(k=u?v:`${j}px`,N=`${s.floating.height+m}px`):p==="right"?(k=`${-m}px`,N=u?v:`${S}px`):p==="left"&&(k=`${s.floating.width+m}px`,N=u?v:`${S}px`),{data:{x:k,y:N}}}});function SV(e){const[t,n="center"]=e.split("-");return[t,n]}var NV=yV,PV=_V,CV=bV,AV=wV,xie="Portal",d2=R.forwardRef((e,t)=>{var a;const{container:n,...s}=e,[i,c]=R.useState(!1);La(()=>c(!0),[]);const u=n||i&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return u?iq.createPortal(r.jsx(zr.div,{...s,ref:t}),u):null});d2.displayName=xie;function ud({prop:e,defaultProp:t,onChange:n=()=>{}}){const[s,i]=yie({defaultProp:t,onChange:n}),c=e!==void 0,u=c?e:s,a=qi(n),m=R.useCallback(p=>{if(c){const v=typeof p=="function"?p(e):p;v!==e&&a(v)}else i(p)},[c,e,i,a]);return[u,m]}function yie({defaultProp:e,onChange:t}){const n=R.useState(e),[s]=n,i=R.useRef(s),c=qi(t);return R.useEffect(()=>{i.current!==s&&(c(s),i.current=s)},[s,i,c]),n}function h2(e){const t=R.useRef({value:e,previous:e});return R.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var vie="VisuallyHidden",kV=R.forwardRef((e,t)=>r.jsx(zr.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));kV.displayName=vie;var _ie=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},dg=new WeakMap,Vw=new WeakMap,Uw={},dA=0,TV=function(e){return e&&(e.host||TV(e.parentNode))},bie=function(e,t){return t.map(function(n){if(e.contains(n))return n;var s=TV(n);return s&&e.contains(s)?s:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},jie=function(e,t,n,s){var i=bie(t,Array.isArray(e)?e:[e]);Uw[n]||(Uw[n]=new WeakMap);var c=Uw[n],u=[],a=new Set,m=new Set(i),p=function(v){!v||a.has(v)||(a.add(v),p(v.parentNode))};i.forEach(p);var y=function(v){!v||m.has(v)||Array.prototype.forEach.call(v.children,function(j){if(a.has(j))y(j);else try{var S=j.getAttribute(s),k=S!==null&&S!=="false",N=(dg.get(j)||0)+1,D=(c.get(j)||0)+1;dg.set(j,N),c.set(j,D),u.push(j),N===1&&k&&Vw.set(j,!0),D===1&&j.setAttribute(n,"true"),k||j.setAttribute(s,"true")}catch(O){console.error("aria-hidden: cannot operate on ",j,O)}})};return y(t),a.clear(),dA++,function(){u.forEach(function(v){var j=dg.get(v)-1,S=c.get(v)-1;dg.set(v,j),c.set(v,S),j||(Vw.has(v)||v.removeAttribute(s),Vw.delete(v)),S||v.removeAttribute(n)}),dA--,dA||(dg=new WeakMap,dg=new WeakMap,Vw=new WeakMap,Uw={})}},HO=function(e,t,n){n===void 0&&(n="data-aria-hidden");var s=Array.from(Array.isArray(e)?e:[e]),i=_ie(e);return i?(s.push.apply(s,Array.from(i.querySelectorAll("[aria-live]"))),jie(s,i,n,"aria-hidden")):function(){return null}},$c=function(){return $c=Object.assign||function(t){for(var n,s=1,i=arguments.length;s<i;s++){n=arguments[s];for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&(t[c]=n[c])}return t},$c.apply(this,arguments)};function EV(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]]);return n}function wie(e,t,n){if(n||arguments.length===2)for(var s=0,i=t.length,c;s<i;s++)(c||!(s in t))&&(c||(c=Array.prototype.slice.call(t,0,s)),c[s]=t[s]);return e.concat(c||Array.prototype.slice.call(t))}var T1="right-scroll-bar-position",E1="width-before-scroll-bar",Sie="with-scroll-bars-hidden",Nie="--removed-body-scroll-bar-size";function hA(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Pie(e,t){var n=R.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(s){var i=n.value;i!==s&&(n.value=s,n.callback(s,i))}}}})[0];return n.callback=t,n.facade}var Cie=typeof window<"u"?R.useLayoutEffect:R.useEffect,S3=new WeakMap;function Aie(e,t){var n=Pie(null,function(s){return e.forEach(function(i){return hA(i,s)})});return Cie(function(){var s=S3.get(n);if(s){var i=new Set(s),c=new Set(e),u=n.current;i.forEach(function(a){c.has(a)||hA(a,null)}),c.forEach(function(a){i.has(a)||hA(a,u)})}S3.set(n,e)},[e]),n}function kie(e){return e}function Tie(e,t){t===void 0&&(t=kie);var n=[],s=!1,i={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(c){var u=t(c,s);return n.push(u),function(){n=n.filter(function(a){return a!==u})}},assignSyncMedium:function(c){for(s=!0;n.length;){var u=n;n=[],u.forEach(c)}n={push:function(a){return c(a)},filter:function(){return n}}},assignMedium:function(c){s=!0;var u=[];if(n.length){var a=n;n=[],a.forEach(c),u=n}var m=function(){var y=u;u=[],y.forEach(c)},p=function(){return Promise.resolve().then(m)};p(),n={push:function(y){u.push(y),p()},filter:function(y){return u=u.filter(y),n}}}};return i}function Eie(e){e===void 0&&(e={});var t=Tie(null);return t.options=$c({async:!0,ssr:!1},e),t}var MV=function(e){var t=e.sideCar,n=EV(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=t.read();if(!s)throw new Error("Sidecar medium not found");return R.createElement(s,$c({},n))};MV.isSideCarExport=!0;function Mie(e,t){return e.useMedium(t),MV}var OV=Eie(),fA=function(){},f2=R.forwardRef(function(e,t){var n=R.useRef(null),s=R.useState({onScrollCapture:fA,onWheelCapture:fA,onTouchMoveCapture:fA}),i=s[0],c=s[1],u=e.forwardProps,a=e.children,m=e.className,p=e.removeScrollBar,y=e.enabled,v=e.shards,j=e.sideCar,S=e.noIsolation,k=e.inert,N=e.allowPinchZoom,D=e.as,O=D===void 0?"div":D,T=e.gapMode,I=EV(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),z=j,$=Aie([n,t]),V=$c($c({},I),i);return R.createElement(R.Fragment,null,y&&R.createElement(z,{sideCar:OV,removeScrollBar:p,shards:v,noIsolation:S,inert:k,setCallbacks:c,allowPinchZoom:!!N,lockRef:n,gapMode:T}),u?R.cloneElement(R.Children.only(a),$c($c({},V),{ref:$})):R.createElement(O,$c({},V,{className:m,ref:$}),a))});f2.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};f2.classNames={fullWidth:E1,zeroRight:T1};var Oie=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Iie(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Oie();return t&&e.setAttribute("nonce",t),e}function Die(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Rie(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Lie=function(){var e=0,t=null;return{add:function(n){e==0&&(t=Iie())&&(Die(t,n),Rie(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Fie=function(){var e=Lie();return function(t,n){R.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},IV=function(){var e=Fie(),t=function(n){var s=n.styles,i=n.dynamic;return e(s,i),null};return t},zie={left:0,top:0,right:0,gap:0},mA=function(e){return parseInt(e||"",10)||0},$ie=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],s=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[mA(n),mA(s),mA(i)]},Bie=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return zie;var t=$ie(e),n=document.documentElement.clientWidth,s=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,s-n+t[2]-t[0])}},qie=IV(),Xg="data-scroll-locked",Vie=function(e,t,n,s){var i=e.left,c=e.top,u=e.right,a=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(Sie,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(a,"px ").concat(s,`;
  }
  body[`).concat(Xg,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(s,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(c,`px;
    padding-right: `).concat(u,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(s,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(T1,` {
    right: `).concat(a,"px ").concat(s,`;
  }
  
  .`).concat(E1,` {
    margin-right: `).concat(a,"px ").concat(s,`;
  }
  
  .`).concat(T1," .").concat(T1,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(E1," .").concat(E1,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(Xg,`] {
    `).concat(Nie,": ").concat(a,`px;
  }
`)},N3=function(){var e=parseInt(document.body.getAttribute(Xg)||"0",10);return isFinite(e)?e:0},Uie=function(){R.useEffect(function(){return document.body.setAttribute(Xg,(N3()+1).toString()),function(){var e=N3()-1;e<=0?document.body.removeAttribute(Xg):document.body.setAttribute(Xg,e.toString())}},[])},Wie=function(e){var t=e.noRelative,n=e.noImportant,s=e.gapMode,i=s===void 0?"margin":s;Uie();var c=R.useMemo(function(){return Bie(i)},[i]);return R.createElement(qie,{styles:Vie(c,!t,i,n?"":"!important")})},AT=!1;if(typeof window<"u")try{var Ww=Object.defineProperty({},"passive",{get:function(){return AT=!0,!0}});window.addEventListener("test",Ww,Ww),window.removeEventListener("test",Ww,Ww)}catch{AT=!1}var hg=AT?{passive:!1}:!1,Gie=function(e){return e.tagName==="TEXTAREA"},DV=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!Gie(e)&&n[t]==="visible")},Kie=function(e){return DV(e,"overflowY")},Hie=function(e){return DV(e,"overflowX")},P3=function(e,t){var n=t.ownerDocument,s=t;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var i=RV(e,s);if(i){var c=LV(e,s),u=c[1],a=c[2];if(u>a)return!0}s=s.parentNode}while(s&&s!==n.body);return!1},Zie=function(e){var t=e.scrollTop,n=e.scrollHeight,s=e.clientHeight;return[t,n,s]},Yie=function(e){var t=e.scrollLeft,n=e.scrollWidth,s=e.clientWidth;return[t,n,s]},RV=function(e,t){return e==="v"?Kie(t):Hie(t)},LV=function(e,t){return e==="v"?Zie(t):Yie(t)},Xie=function(e,t){return e==="h"&&t==="rtl"?-1:1},Qie=function(e,t,n,s,i){var c=Xie(e,window.getComputedStyle(t).direction),u=c*s,a=n.target,m=t.contains(a),p=!1,y=u>0,v=0,j=0;do{var S=LV(e,a),k=S[0],N=S[1],D=S[2],O=N-D-c*k;(k||O)&&RV(e,a)&&(v+=O,j+=k),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!m&&a!==document.body||m&&(t.contains(a)||t===a));return(y&&Math.abs(v)<1||!y&&Math.abs(j)<1)&&(p=!0),p},Gw=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},C3=function(e){return[e.deltaX,e.deltaY]},A3=function(e){return e&&"current"in e?e.current:e},Jie=function(e,t){return e[0]===t[0]&&e[1]===t[1]},eae=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},tae=0,fg=[];function rae(e){var t=R.useRef([]),n=R.useRef([0,0]),s=R.useRef(),i=R.useState(tae++)[0],c=R.useState(IV)[0],u=R.useRef(e);R.useEffect(function(){u.current=e},[e]),R.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var N=wie([e.lockRef.current],(e.shards||[]).map(A3),!0).filter(Boolean);return N.forEach(function(D){return D.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),N.forEach(function(D){return D.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var a=R.useCallback(function(N,D){if("touches"in N&&N.touches.length===2||N.type==="wheel"&&N.ctrlKey)return!u.current.allowPinchZoom;var O=Gw(N),T=n.current,I="deltaX"in N?N.deltaX:T[0]-O[0],z="deltaY"in N?N.deltaY:T[1]-O[1],$,V=N.target,K=Math.abs(I)>Math.abs(z)?"h":"v";if("touches"in N&&K==="h"&&V.type==="range")return!1;var te=P3(K,V);if(!te)return!0;if(te?$=K:($=K==="v"?"h":"v",te=P3(K,V)),!te)return!1;if(!s.current&&"changedTouches"in N&&(I||z)&&(s.current=$),!$)return!0;var X=s.current||$;return Qie(X,D,N,X==="h"?I:z)},[]),m=R.useCallback(function(N){var D=N;if(!(!fg.length||fg[fg.length-1]!==c)){var O="deltaY"in D?C3(D):Gw(D),T=t.current.filter(function($){return $.name===D.type&&($.target===D.target||D.target===$.shadowParent)&&Jie($.delta,O)})[0];if(T&&T.should){D.cancelable&&D.preventDefault();return}if(!T){var I=(u.current.shards||[]).map(A3).filter(Boolean).filter(function($){return $.contains(D.target)}),z=I.length>0?a(D,I[0]):!u.current.noIsolation;z&&D.cancelable&&D.preventDefault()}}},[]),p=R.useCallback(function(N,D,O,T){var I={name:N,delta:D,target:O,should:T,shadowParent:nae(O)};t.current.push(I),setTimeout(function(){t.current=t.current.filter(function(z){return z!==I})},1)},[]),y=R.useCallback(function(N){n.current=Gw(N),s.current=void 0},[]),v=R.useCallback(function(N){p(N.type,C3(N),N.target,a(N,e.lockRef.current))},[]),j=R.useCallback(function(N){p(N.type,Gw(N),N.target,a(N,e.lockRef.current))},[]);R.useEffect(function(){return fg.push(c),e.setCallbacks({onScrollCapture:v,onWheelCapture:v,onTouchMoveCapture:j}),document.addEventListener("wheel",m,hg),document.addEventListener("touchmove",m,hg),document.addEventListener("touchstart",y,hg),function(){fg=fg.filter(function(N){return N!==c}),document.removeEventListener("wheel",m,hg),document.removeEventListener("touchmove",m,hg),document.removeEventListener("touchstart",y,hg)}},[]);var S=e.removeScrollBar,k=e.inert;return R.createElement(R.Fragment,null,k?R.createElement(c,{styles:eae(i)}):null,S?R.createElement(Wie,{gapMode:e.gapMode}):null)}function nae(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const sae=Mie(OV,rae);var m2=R.forwardRef(function(e,t){return R.createElement(f2,$c({},e,{ref:t,sideCar:sae}))});m2.classNames=f2.classNames;var iae=[" ","Enter","ArrowUp","ArrowDown"],aae=[" ","Enter"],Lb="Select",[p2,g2,oae]=n2(Lb),[Cy]=bd(Lb,[oae,u2]),x2=u2(),[lae,lf]=Cy(Lb),[cae,uae]=Cy(Lb),FV=e=>{const{__scopeSelect:t,children:n,open:s,defaultOpen:i,onOpenChange:c,value:u,defaultValue:a,onValueChange:m,dir:p,name:y,autoComplete:v,disabled:j,required:S,form:k}=e,N=x2(t),[D,O]=R.useState(null),[T,I]=R.useState(null),[z,$]=R.useState(!1),V=Sy(p),[K=!1,te]=ud({prop:s,defaultProp:i,onChange:c}),[X,ve]=ud({prop:u,defaultProp:a,onChange:m}),ae=R.useRef(null),pe=D?k||!!D.closest("form"):!0,[Oe,Me]=R.useState(new Set),Xe=Array.from(Oe).map(Ve=>Ve.props.value).join(";");return r.jsx(NV,{...N,children:r.jsxs(lae,{required:S,scope:t,trigger:D,onTriggerChange:O,valueNode:T,onValueNodeChange:I,valueNodeHasChildren:z,onValueNodeHasChildrenChange:$,contentId:Hc(),value:X,onValueChange:ve,open:K,onOpenChange:te,dir:V,triggerPointerDownPosRef:ae,disabled:j,children:[r.jsx(p2.Provider,{scope:t,children:r.jsx(cae,{scope:e.__scopeSelect,onNativeOptionAdd:R.useCallback(Ve=>{Me(et=>new Set(et).add(Ve))},[]),onNativeOptionRemove:R.useCallback(Ve=>{Me(et=>{const Ce=new Set(et);return Ce.delete(Ve),Ce})},[]),children:n})}),pe?r.jsxs(cU,{"aria-hidden":!0,required:S,tabIndex:-1,name:y,autoComplete:v,value:X,onChange:Ve=>ve(Ve.target.value),disabled:j,form:k,children:[X===void 0?r.jsx("option",{value:""}):null,Array.from(Oe)]},Xe):null]})})};FV.displayName=Lb;var zV="SelectTrigger",$V=R.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:s=!1,...i}=e,c=x2(n),u=lf(zV,n),a=u.disabled||s,m=yn(t,u.onTriggerChange),p=g2(n),y=R.useRef("touch"),[v,j,S]=uU(N=>{const D=p().filter(I=>!I.disabled),O=D.find(I=>I.value===u.value),T=dU(D,N,O);T!==void 0&&u.onValueChange(T.value)}),k=N=>{a||(u.onOpenChange(!0),S()),N&&(u.triggerPointerDownPosRef.current={x:Math.round(N.pageX),y:Math.round(N.pageY)})};return r.jsx(PV,{asChild:!0,...c,children:r.jsx(zr.button,{type:"button",role:"combobox","aria-controls":u.contentId,"aria-expanded":u.open,"aria-required":u.required,"aria-autocomplete":"none",dir:u.dir,"data-state":u.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":lU(u.value)?"":void 0,...i,ref:m,onClick:nr(i.onClick,N=>{N.currentTarget.focus(),y.current!=="mouse"&&k(N)}),onPointerDown:nr(i.onPointerDown,N=>{y.current=N.pointerType;const D=N.target;D.hasPointerCapture(N.pointerId)&&D.releasePointerCapture(N.pointerId),N.button===0&&N.ctrlKey===!1&&N.pointerType==="mouse"&&(k(N),N.preventDefault())}),onKeyDown:nr(i.onKeyDown,N=>{const D=v.current!=="";!(N.ctrlKey||N.altKey||N.metaKey)&&N.key.length===1&&j(N.key),!(D&&N.key===" ")&&iae.includes(N.key)&&(k(),N.preventDefault())})})})});$V.displayName=zV;var BV="SelectValue",qV=R.forwardRef((e,t)=>{const{__scopeSelect:n,className:s,style:i,children:c,placeholder:u="",...a}=e,m=lf(BV,n),{onValueNodeHasChildrenChange:p}=m,y=c!==void 0,v=yn(t,m.onValueNodeChange);return La(()=>{p(y)},[p,y]),r.jsx(zr.span,{...a,ref:v,style:{pointerEvents:"none"},children:lU(m.value)?r.jsx(r.Fragment,{children:u}):c})});qV.displayName=BV;var dae="SelectIcon",VV=R.forwardRef((e,t)=>{const{__scopeSelect:n,children:s,...i}=e;return r.jsx(zr.span,{"aria-hidden":!0,...i,ref:t,children:s||""})});VV.displayName=dae;var hae="SelectPortal",UV=e=>r.jsx(d2,{asChild:!0,...e});UV.displayName=hae;var $m="SelectContent",WV=R.forwardRef((e,t)=>{const n=lf($m,e.__scopeSelect),[s,i]=R.useState();if(La(()=>{i(new DocumentFragment)},[]),!n.open){const c=s;return c?of.createPortal(r.jsx(GV,{scope:e.__scopeSelect,children:r.jsx(p2.Slot,{scope:e.__scopeSelect,children:r.jsx("div",{children:e.children})})}),c):null}return r.jsx(KV,{...e,ref:t})});WV.displayName=$m;var Ql=10,[GV,cf]=Cy($m),fae="SelectContentImpl",KV=R.forwardRef((e,t)=>{const{__scopeSelect:n,position:s="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:c,onPointerDownOutside:u,side:a,sideOffset:m,align:p,alignOffset:y,arrowPadding:v,collisionBoundary:j,collisionPadding:S,sticky:k,hideWhenDetached:N,avoidCollisions:D,...O}=e,T=lf($m,n),[I,z]=R.useState(null),[$,V]=R.useState(null),K=yn(t,Mt=>z(Mt)),[te,X]=R.useState(null),[ve,ae]=R.useState(null),pe=g2(n),[Oe,Me]=R.useState(!1),Xe=R.useRef(!1);R.useEffect(()=>{if(I)return HO(I)},[I]),FO();const Ve=R.useCallback(Mt=>{const[yr,...Nt]=pe().map(mt=>mt.ref.current),[Wt]=Nt.slice(-1),Zt=document.activeElement;for(const mt of Mt)if(mt===Zt||(mt==null||mt.scrollIntoView({block:"nearest"}),mt===yr&&$&&($.scrollTop=0),mt===Wt&&$&&($.scrollTop=$.scrollHeight),mt==null||mt.focus(),document.activeElement!==Zt))return},[pe,$]),et=R.useCallback(()=>Ve([te,I]),[Ve,te,I]);R.useEffect(()=>{Oe&&et()},[Oe,et]);const{onOpenChange:Ce,triggerPointerDownPosRef:_e}=T;R.useEffect(()=>{if(I){let Mt={x:0,y:0};const yr=Wt=>{var Zt,mt;Mt={x:Math.abs(Math.round(Wt.pageX)-(((Zt=_e.current)==null?void 0:Zt.x)??0)),y:Math.abs(Math.round(Wt.pageY)-(((mt=_e.current)==null?void 0:mt.y)??0))}},Nt=Wt=>{Mt.x<=10&&Mt.y<=10?Wt.preventDefault():I.contains(Wt.target)||Ce(!1),document.removeEventListener("pointermove",yr),_e.current=null};return _e.current!==null&&(document.addEventListener("pointermove",yr),document.addEventListener("pointerup",Nt,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",yr),document.removeEventListener("pointerup",Nt,{capture:!0})}}},[I,Ce,_e]),R.useEffect(()=>{const Mt=()=>Ce(!1);return window.addEventListener("blur",Mt),window.addEventListener("resize",Mt),()=>{window.removeEventListener("blur",Mt),window.removeEventListener("resize",Mt)}},[Ce]);const[tt,vt]=uU(Mt=>{const yr=pe().filter(Zt=>!Zt.disabled),Nt=yr.find(Zt=>Zt.ref.current===document.activeElement),Wt=dU(yr,Mt,Nt);Wt&&setTimeout(()=>Wt.ref.current.focus())}),gt=R.useCallback((Mt,yr,Nt)=>{const Wt=!Xe.current&&!Nt;(T.value!==void 0&&T.value===yr||Wt)&&(X(Mt),Wt&&(Xe.current=!0))},[T.value]),Tt=R.useCallback(()=>I==null?void 0:I.focus(),[I]),Ht=R.useCallback((Mt,yr,Nt)=>{const Wt=!Xe.current&&!Nt;(T.value!==void 0&&T.value===yr||Wt)&&ae(Mt)},[T.value]),Ir=s==="popper"?kT:HV,Pr=Ir===kT?{side:a,sideOffset:m,align:p,alignOffset:y,arrowPadding:v,collisionBoundary:j,collisionPadding:S,sticky:k,hideWhenDetached:N,avoidCollisions:D}:{};return r.jsx(GV,{scope:n,content:I,viewport:$,onViewportChange:V,itemRefCallback:gt,selectedItem:te,onItemLeave:Tt,itemTextRefCallback:Ht,focusSelectedItem:et,selectedItemText:ve,position:s,isPositioned:Oe,searchRef:tt,children:r.jsx(m2,{as:Gh,allowPinchZoom:!0,children:r.jsx(i2,{asChild:!0,trapped:T.open,onMountAutoFocus:Mt=>{Mt.preventDefault()},onUnmountAutoFocus:nr(i,Mt=>{var yr;(yr=T.trigger)==null||yr.focus({preventScroll:!0}),Mt.preventDefault()}),children:r.jsx(s2,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:Mt=>Mt.preventDefault(),onDismiss:()=>T.onOpenChange(!1),children:r.jsx(Ir,{role:"listbox",id:T.contentId,"data-state":T.open?"open":"closed",dir:T.dir,onContextMenu:Mt=>Mt.preventDefault(),...O,...Pr,onPlaced:()=>Me(!0),ref:K,style:{display:"flex",flexDirection:"column",outline:"none",...O.style},onKeyDown:nr(O.onKeyDown,Mt=>{const yr=Mt.ctrlKey||Mt.altKey||Mt.metaKey;if(Mt.key==="Tab"&&Mt.preventDefault(),!yr&&Mt.key.length===1&&vt(Mt.key),["ArrowUp","ArrowDown","Home","End"].includes(Mt.key)){let Wt=pe().filter(Zt=>!Zt.disabled).map(Zt=>Zt.ref.current);if(["ArrowUp","End"].includes(Mt.key)&&(Wt=Wt.slice().reverse()),["ArrowUp","ArrowDown"].includes(Mt.key)){const Zt=Mt.target,mt=Wt.indexOf(Zt);Wt=Wt.slice(mt+1)}setTimeout(()=>Ve(Wt)),Mt.preventDefault()}})})})})})})});KV.displayName=fae;var mae="SelectItemAlignedPosition",HV=R.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:s,...i}=e,c=lf($m,n),u=cf($m,n),[a,m]=R.useState(null),[p,y]=R.useState(null),v=yn(t,K=>y(K)),j=g2(n),S=R.useRef(!1),k=R.useRef(!0),{viewport:N,selectedItem:D,selectedItemText:O,focusSelectedItem:T}=u,I=R.useCallback(()=>{if(c.trigger&&c.valueNode&&a&&p&&N&&D&&O){const K=c.trigger.getBoundingClientRect(),te=p.getBoundingClientRect(),X=c.valueNode.getBoundingClientRect(),ve=O.getBoundingClientRect();if(c.dir!=="rtl"){const Zt=ve.left-te.left,mt=X.left-Zt,qr=K.left-mt,ar=K.width+qr,en=Math.max(ar,te.width),Lr=window.innerWidth-Ql,An=E0(mt,[Ql,Math.max(Ql,Lr-en)]);a.style.minWidth=ar+"px",a.style.left=An+"px"}else{const Zt=te.right-ve.right,mt=window.innerWidth-X.right-Zt,qr=window.innerWidth-K.right-mt,ar=K.width+qr,en=Math.max(ar,te.width),Lr=window.innerWidth-Ql,An=E0(mt,[Ql,Math.max(Ql,Lr-en)]);a.style.minWidth=ar+"px",a.style.right=An+"px"}const ae=j(),pe=window.innerHeight-Ql*2,Oe=N.scrollHeight,Me=window.getComputedStyle(p),Xe=parseInt(Me.borderTopWidth,10),Ve=parseInt(Me.paddingTop,10),et=parseInt(Me.borderBottomWidth,10),Ce=parseInt(Me.paddingBottom,10),_e=Xe+Ve+Oe+Ce+et,tt=Math.min(D.offsetHeight*5,_e),vt=window.getComputedStyle(N),gt=parseInt(vt.paddingTop,10),Tt=parseInt(vt.paddingBottom,10),Ht=K.top+K.height/2-Ql,Ir=pe-Ht,Pr=D.offsetHeight/2,Mt=D.offsetTop+Pr,yr=Xe+Ve+Mt,Nt=_e-yr;if(yr<=Ht){const Zt=ae.length>0&&D===ae[ae.length-1].ref.current;a.style.bottom="0px";const mt=p.clientHeight-N.offsetTop-N.offsetHeight,qr=Math.max(Ir,Pr+(Zt?Tt:0)+mt+et),ar=yr+qr;a.style.height=ar+"px"}else{const Zt=ae.length>0&&D===ae[0].ref.current;a.style.top="0px";const qr=Math.max(Ht,Xe+N.offsetTop+(Zt?gt:0)+Pr)+Nt;a.style.height=qr+"px",N.scrollTop=yr-Ht+N.offsetTop}a.style.margin=`${Ql}px 0`,a.style.minHeight=tt+"px",a.style.maxHeight=pe+"px",s==null||s(),requestAnimationFrame(()=>S.current=!0)}},[j,c.trigger,c.valueNode,a,p,N,D,O,c.dir,s]);La(()=>I(),[I]);const[z,$]=R.useState();La(()=>{p&&$(window.getComputedStyle(p).zIndex)},[p]);const V=R.useCallback(K=>{K&&k.current===!0&&(I(),T==null||T(),k.current=!1)},[I,T]);return r.jsx(gae,{scope:n,contentWrapper:a,shouldExpandOnScrollRef:S,onScrollButtonChange:V,children:r.jsx("div",{ref:m,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:z},children:r.jsx(zr.div,{...i,ref:v,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});HV.displayName=mae;var pae="SelectPopperPosition",kT=R.forwardRef((e,t)=>{const{__scopeSelect:n,align:s="start",collisionPadding:i=Ql,...c}=e,u=x2(n);return r.jsx(CV,{...u,...c,ref:t,align:s,collisionPadding:i,style:{boxSizing:"border-box",...c.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});kT.displayName=pae;var[gae,ZO]=Cy($m,{}),TT="SelectViewport",ZV=R.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:s,...i}=e,c=cf(TT,n),u=ZO(TT,n),a=yn(t,c.onViewportChange),m=R.useRef(0);return r.jsxs(r.Fragment,{children:[r.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),r.jsx(p2.Slot,{scope:n,children:r.jsx(zr.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:nr(i.onScroll,p=>{const y=p.currentTarget,{contentWrapper:v,shouldExpandOnScrollRef:j}=u;if(j!=null&&j.current&&v){const S=Math.abs(m.current-y.scrollTop);if(S>0){const k=window.innerHeight-Ql*2,N=parseFloat(v.style.minHeight),D=parseFloat(v.style.height),O=Math.max(N,D);if(O<k){const T=O+S,I=Math.min(k,T),z=T-I;v.style.height=I+"px",v.style.bottom==="0px"&&(y.scrollTop=z>0?z:0,v.style.justifyContent="flex-end")}}}m.current=y.scrollTop})})})]})});ZV.displayName=TT;var YV="SelectGroup",[xae,yae]=Cy(YV),vae=R.forwardRef((e,t)=>{const{__scopeSelect:n,...s}=e,i=Hc();return r.jsx(xae,{scope:n,id:i,children:r.jsx(zr.div,{role:"group","aria-labelledby":i,...s,ref:t})})});vae.displayName=YV;var XV="SelectLabel",QV=R.forwardRef((e,t)=>{const{__scopeSelect:n,...s}=e,i=yae(XV,n);return r.jsx(zr.div,{id:i.id,...s,ref:t})});QV.displayName=XV;var gS="SelectItem",[_ae,JV]=Cy(gS),eU=R.forwardRef((e,t)=>{const{__scopeSelect:n,value:s,disabled:i=!1,textValue:c,...u}=e,a=lf(gS,n),m=cf(gS,n),p=a.value===s,[y,v]=R.useState(c??""),[j,S]=R.useState(!1),k=yn(t,T=>{var I;return(I=m.itemRefCallback)==null?void 0:I.call(m,T,s,i)}),N=Hc(),D=R.useRef("touch"),O=()=>{i||(a.onValueChange(s),a.onOpenChange(!1))};if(s==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return r.jsx(_ae,{scope:n,value:s,disabled:i,textId:N,isSelected:p,onItemTextChange:R.useCallback(T=>{v(I=>I||((T==null?void 0:T.textContent)??"").trim())},[]),children:r.jsx(p2.ItemSlot,{scope:n,value:s,disabled:i,textValue:y,children:r.jsx(zr.div,{role:"option","aria-labelledby":N,"data-highlighted":j?"":void 0,"aria-selected":p&&j,"data-state":p?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...u,ref:k,onFocus:nr(u.onFocus,()=>S(!0)),onBlur:nr(u.onBlur,()=>S(!1)),onClick:nr(u.onClick,()=>{D.current!=="mouse"&&O()}),onPointerUp:nr(u.onPointerUp,()=>{D.current==="mouse"&&O()}),onPointerDown:nr(u.onPointerDown,T=>{D.current=T.pointerType}),onPointerMove:nr(u.onPointerMove,T=>{var I;D.current=T.pointerType,i?(I=m.onItemLeave)==null||I.call(m):D.current==="mouse"&&T.currentTarget.focus({preventScroll:!0})}),onPointerLeave:nr(u.onPointerLeave,T=>{var I;T.currentTarget===document.activeElement&&((I=m.onItemLeave)==null||I.call(m))}),onKeyDown:nr(u.onKeyDown,T=>{var z;((z=m.searchRef)==null?void 0:z.current)!==""&&T.key===" "||(aae.includes(T.key)&&O(),T.key===" "&&T.preventDefault())})})})})});eU.displayName=gS;var B_="SelectItemText",tU=R.forwardRef((e,t)=>{const{__scopeSelect:n,className:s,style:i,...c}=e,u=lf(B_,n),a=cf(B_,n),m=JV(B_,n),p=uae(B_,n),[y,v]=R.useState(null),j=yn(t,O=>v(O),m.onItemTextChange,O=>{var T;return(T=a.itemTextRefCallback)==null?void 0:T.call(a,O,m.value,m.disabled)}),S=y==null?void 0:y.textContent,k=R.useMemo(()=>r.jsx("option",{value:m.value,disabled:m.disabled,children:S},m.value),[m.disabled,m.value,S]),{onNativeOptionAdd:N,onNativeOptionRemove:D}=p;return La(()=>(N(k),()=>D(k)),[N,D,k]),r.jsxs(r.Fragment,{children:[r.jsx(zr.span,{id:m.textId,...c,ref:j}),m.isSelected&&u.valueNode&&!u.valueNodeHasChildren?of.createPortal(c.children,u.valueNode):null]})});tU.displayName=B_;var rU="SelectItemIndicator",nU=R.forwardRef((e,t)=>{const{__scopeSelect:n,...s}=e;return JV(rU,n).isSelected?r.jsx(zr.span,{"aria-hidden":!0,...s,ref:t}):null});nU.displayName=rU;var ET="SelectScrollUpButton",sU=R.forwardRef((e,t)=>{const n=cf(ET,e.__scopeSelect),s=ZO(ET,e.__scopeSelect),[i,c]=R.useState(!1),u=yn(t,s.onScrollButtonChange);return La(()=>{if(n.viewport&&n.isPositioned){let a=function(){const p=m.scrollTop>0;c(p)};const m=n.viewport;return a(),m.addEventListener("scroll",a),()=>m.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),i?r.jsx(aU,{...e,ref:u,onAutoScroll:()=>{const{viewport:a,selectedItem:m}=n;a&&m&&(a.scrollTop=a.scrollTop-m.offsetHeight)}}):null});sU.displayName=ET;var MT="SelectScrollDownButton",iU=R.forwardRef((e,t)=>{const n=cf(MT,e.__scopeSelect),s=ZO(MT,e.__scopeSelect),[i,c]=R.useState(!1),u=yn(t,s.onScrollButtonChange);return La(()=>{if(n.viewport&&n.isPositioned){let a=function(){const p=m.scrollHeight-m.clientHeight,y=Math.ceil(m.scrollTop)<p;c(y)};const m=n.viewport;return a(),m.addEventListener("scroll",a),()=>m.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),i?r.jsx(aU,{...e,ref:u,onAutoScroll:()=>{const{viewport:a,selectedItem:m}=n;a&&m&&(a.scrollTop=a.scrollTop+m.offsetHeight)}}):null});iU.displayName=MT;var aU=R.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:s,...i}=e,c=cf("SelectScrollButton",n),u=R.useRef(null),a=g2(n),m=R.useCallback(()=>{u.current!==null&&(window.clearInterval(u.current),u.current=null)},[]);return R.useEffect(()=>()=>m(),[m]),La(()=>{var y;const p=a().find(v=>v.ref.current===document.activeElement);(y=p==null?void 0:p.ref.current)==null||y.scrollIntoView({block:"nearest"})},[a]),r.jsx(zr.div,{"aria-hidden":!0,...i,ref:t,style:{flexShrink:0,...i.style},onPointerDown:nr(i.onPointerDown,()=>{u.current===null&&(u.current=window.setInterval(s,50))}),onPointerMove:nr(i.onPointerMove,()=>{var p;(p=c.onItemLeave)==null||p.call(c),u.current===null&&(u.current=window.setInterval(s,50))}),onPointerLeave:nr(i.onPointerLeave,()=>{m()})})}),bae="SelectSeparator",oU=R.forwardRef((e,t)=>{const{__scopeSelect:n,...s}=e;return r.jsx(zr.div,{"aria-hidden":!0,...s,ref:t})});oU.displayName=bae;var OT="SelectArrow",jae=R.forwardRef((e,t)=>{const{__scopeSelect:n,...s}=e,i=x2(n),c=lf(OT,n),u=cf(OT,n);return c.open&&u.position==="popper"?r.jsx(AV,{...i,...s,ref:t}):null});jae.displayName=OT;function lU(e){return e===""||e===void 0}var cU=R.forwardRef((e,t)=>{const{value:n,...s}=e,i=R.useRef(null),c=yn(t,i),u=h2(n);return R.useEffect(()=>{const a=i.current,m=window.HTMLSelectElement.prototype,y=Object.getOwnPropertyDescriptor(m,"value").set;if(u!==n&&y){const v=new Event("change",{bubbles:!0});y.call(a,n),a.dispatchEvent(v)}},[u,n]),r.jsx(kV,{asChild:!0,children:r.jsx("select",{...s,ref:c,defaultValue:n})})});cU.displayName="BubbleSelect";function uU(e){const t=qi(e),n=R.useRef(""),s=R.useRef(0),i=R.useCallback(u=>{const a=n.current+u;t(a),function m(p){n.current=p,window.clearTimeout(s.current),p!==""&&(s.current=window.setTimeout(()=>m(""),1e3))}(a)},[t]),c=R.useCallback(()=>{n.current="",window.clearTimeout(s.current)},[]);return R.useEffect(()=>()=>window.clearTimeout(s.current),[]),[n,i,c]}function dU(e,t,n){const i=t.length>1&&Array.from(t).every(p=>p===t[0])?t[0]:t,c=n?e.indexOf(n):-1;let u=wae(e,Math.max(c,0));i.length===1&&(u=u.filter(p=>p!==n));const m=u.find(p=>p.textValue.toLowerCase().startsWith(i.toLowerCase()));return m!==n?m:void 0}function wae(e,t){return e.map((n,s)=>e[(t+s)%e.length])}var Sae=FV,hU=$V,Nae=qV,Pae=VV,Cae=UV,fU=WV,Aae=ZV,mU=QV,pU=eU,kae=tU,Tae=nU,gU=sU,xU=iU,yU=oU;const Jt=Sae,er=Nae,Yt=R.forwardRef(({className:e,children:t,...n},s)=>r.jsxs(hU,{ref:s,className:wr("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,r.jsx(Pae,{asChild:!0,children:r.jsx(EO,{className:"h-4 w-4 opacity-50"})})]}));Yt.displayName=hU.displayName;const vU=R.forwardRef(({className:e,...t},n)=>r.jsx(gU,{ref:n,className:wr("flex cursor-default items-center justify-center py-1",e),...t,children:r.jsx(Ire,{className:"h-4 w-4"})}));vU.displayName=gU.displayName;const _U=R.forwardRef(({className:e,...t},n)=>r.jsx(xU,{ref:n,className:wr("flex cursor-default items-center justify-center py-1",e),...t,children:r.jsx(EO,{className:"h-4 w-4"})}));_U.displayName=xU.displayName;const Xt=R.forwardRef(({className:e,children:t,position:n="popper",...s},i)=>r.jsx(Cae,{children:r.jsxs(fU,{ref:i,className:wr("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...s,children:[r.jsx(vU,{}),r.jsx(Aae,{className:wr("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),r.jsx(_U,{})]})}));Xt.displayName=fU.displayName;const Eae=R.forwardRef(({className:e,...t},n)=>r.jsx(mU,{ref:n,className:wr("px-2 py-1.5 text-sm font-semibold",e),...t}));Eae.displayName=mU.displayName;const ke=R.forwardRef(({className:e,children:t,...n},s)=>r.jsxs(pU,{ref:s,className:wr("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[r.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(Tae,{children:r.jsx(Nx,{className:"h-4 w-4"})})}),r.jsx(kae,{children:t})]}));ke.displayName=pU.displayName;const Mae=R.forwardRef(({className:e,...t},n)=>r.jsx(yU,{ref:n,className:wr("-mx-1 my-1 h-px bg-muted",e),...t}));Mae.displayName=yU.displayName;function Oae(e,t){return R.useReducer((n,s)=>t[n][s]??n,e)}var So=e=>{const{present:t,children:n}=e,s=Iae(t),i=typeof n=="function"?n({present:s.isPresent}):R.Children.only(n),c=yn(s.ref,Dae(i));return typeof n=="function"||s.isPresent?R.cloneElement(i,{ref:c}):null};So.displayName="Presence";function Iae(e){const[t,n]=R.useState(),s=R.useRef({}),i=R.useRef(e),c=R.useRef("none"),u=e?"mounted":"unmounted",[a,m]=Oae(u,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return R.useEffect(()=>{const p=Kw(s.current);c.current=a==="mounted"?p:"none"},[a]),La(()=>{const p=s.current,y=i.current;if(y!==e){const j=c.current,S=Kw(p);e?m("MOUNT"):S==="none"||(p==null?void 0:p.display)==="none"?m("UNMOUNT"):m(y&&j!==S?"ANIMATION_OUT":"UNMOUNT"),i.current=e}},[e,m]),La(()=>{if(t){let p;const y=t.ownerDocument.defaultView??window,v=S=>{const N=Kw(s.current).includes(S.animationName);if(S.target===t&&N&&(m("ANIMATION_END"),!i.current)){const D=t.style.animationFillMode;t.style.animationFillMode="forwards",p=y.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=D)})}},j=S=>{S.target===t&&(c.current=Kw(s.current))};return t.addEventListener("animationstart",j),t.addEventListener("animationcancel",v),t.addEventListener("animationend",v),()=>{y.clearTimeout(p),t.removeEventListener("animationstart",j),t.removeEventListener("animationcancel",v),t.removeEventListener("animationend",v)}}else m("ANIMATION_END")},[t,m]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:R.useCallback(p=>{p&&(s.current=getComputedStyle(p)),n(p)},[])}}function Kw(e){return(e==null?void 0:e.animationName)||"none"}function Dae(e){var s,i;let t=(s=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var YO="Dialog",[bU]=bd(YO),[Rae,_c]=bU(YO),jU=e=>{const{__scopeDialog:t,children:n,open:s,defaultOpen:i,onOpenChange:c,modal:u=!0}=e,a=R.useRef(null),m=R.useRef(null),[p=!1,y]=ud({prop:s,defaultProp:i,onChange:c});return r.jsx(Rae,{scope:t,triggerRef:a,contentRef:m,contentId:Hc(),titleId:Hc(),descriptionId:Hc(),open:p,onOpenChange:y,onOpenToggle:R.useCallback(()=>y(v=>!v),[y]),modal:u,children:n})};jU.displayName=YO;var wU="DialogTrigger",SU=R.forwardRef((e,t)=>{const{__scopeDialog:n,...s}=e,i=_c(wU,n),c=yn(t,i.triggerRef);return r.jsx(zr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":JO(i.open),...s,ref:c,onClick:nr(e.onClick,i.onOpenToggle)})});SU.displayName=wU;var XO="DialogPortal",[Lae,NU]=bU(XO,{forceMount:void 0}),PU=e=>{const{__scopeDialog:t,forceMount:n,children:s,container:i}=e,c=_c(XO,t);return r.jsx(Lae,{scope:t,forceMount:n,children:R.Children.map(s,u=>r.jsx(So,{present:n||c.open,children:r.jsx(d2,{asChild:!0,container:i,children:u})}))})};PU.displayName=XO;var xS="DialogOverlay",CU=R.forwardRef((e,t)=>{const n=NU(xS,e.__scopeDialog),{forceMount:s=n.forceMount,...i}=e,c=_c(xS,e.__scopeDialog);return c.modal?r.jsx(So,{present:s||c.open,children:r.jsx(Fae,{...i,ref:t})}):null});CU.displayName=xS;var Fae=R.forwardRef((e,t)=>{const{__scopeDialog:n,...s}=e,i=_c(xS,n);return r.jsx(m2,{as:Gh,allowPinchZoom:!0,shards:[i.contentRef],children:r.jsx(zr.div,{"data-state":JO(i.open),...s,ref:t,style:{pointerEvents:"auto",...s.style}})})}),Bm="DialogContent",AU=R.forwardRef((e,t)=>{const n=NU(Bm,e.__scopeDialog),{forceMount:s=n.forceMount,...i}=e,c=_c(Bm,e.__scopeDialog);return r.jsx(So,{present:s||c.open,children:c.modal?r.jsx(zae,{...i,ref:t}):r.jsx($ae,{...i,ref:t})})});AU.displayName=Bm;var zae=R.forwardRef((e,t)=>{const n=_c(Bm,e.__scopeDialog),s=R.useRef(null),i=yn(t,n.contentRef,s);return R.useEffect(()=>{const c=s.current;if(c)return HO(c)},[]),r.jsx(kU,{...e,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:nr(e.onCloseAutoFocus,c=>{var u;c.preventDefault(),(u=n.triggerRef.current)==null||u.focus()}),onPointerDownOutside:nr(e.onPointerDownOutside,c=>{const u=c.detail.originalEvent,a=u.button===0&&u.ctrlKey===!0;(u.button===2||a)&&c.preventDefault()}),onFocusOutside:nr(e.onFocusOutside,c=>c.preventDefault())})}),$ae=R.forwardRef((e,t)=>{const n=_c(Bm,e.__scopeDialog),s=R.useRef(!1),i=R.useRef(!1);return r.jsx(kU,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var u,a;(u=e.onCloseAutoFocus)==null||u.call(e,c),c.defaultPrevented||(s.current||(a=n.triggerRef.current)==null||a.focus(),c.preventDefault()),s.current=!1,i.current=!1},onInteractOutside:c=>{var m,p;(m=e.onInteractOutside)==null||m.call(e,c),c.defaultPrevented||(s.current=!0,c.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const u=c.target;((p=n.triggerRef.current)==null?void 0:p.contains(u))&&c.preventDefault(),c.detail.originalEvent.type==="focusin"&&i.current&&c.preventDefault()}})}),kU=R.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:c,...u}=e,a=_c(Bm,n),m=R.useRef(null),p=yn(t,m);return FO(),r.jsxs(r.Fragment,{children:[r.jsx(i2,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:i,onUnmountAutoFocus:c,children:r.jsx(s2,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":JO(a.open),...u,ref:p,onDismiss:()=>a.onOpenChange(!1)})}),r.jsxs(r.Fragment,{children:[r.jsx(Bae,{titleId:a.titleId}),r.jsx(Vae,{contentRef:m,descriptionId:a.descriptionId})]})]})}),QO="DialogTitle",TU=R.forwardRef((e,t)=>{const{__scopeDialog:n,...s}=e,i=_c(QO,n);return r.jsx(zr.h2,{id:i.titleId,...s,ref:t})});TU.displayName=QO;var EU="DialogDescription",MU=R.forwardRef((e,t)=>{const{__scopeDialog:n,...s}=e,i=_c(EU,n);return r.jsx(zr.p,{id:i.descriptionId,...s,ref:t})});MU.displayName=EU;var OU="DialogClose",IU=R.forwardRef((e,t)=>{const{__scopeDialog:n,...s}=e,i=_c(OU,n);return r.jsx(zr.button,{type:"button",...s,ref:t,onClick:nr(e.onClick,()=>i.onOpenChange(!1))})});IU.displayName=OU;function JO(e){return e?"open":"closed"}var DU="DialogTitleWarning",[R$e,RU]=Une(DU,{contentName:Bm,titleName:QO,docsSlug:"dialog"}),Bae=({titleId:e})=>{const t=RU(DU),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return R.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},qae="DialogDescriptionWarning",Vae=({contentRef:e,descriptionId:t})=>{const s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${RU(qae).contentName}}.`;return R.useEffect(()=>{var c;const i=(c=e.current)==null?void 0:c.getAttribute("aria-describedby");t&&i&&(document.getElementById(t)||console.warn(s))},[s,e,t]),null},LU=jU,Uae=SU,FU=PU,y2=CU,v2=AU,_2=TU,b2=MU,zU=IU;const $U=LU,Wae=FU,BU=R.forwardRef(({className:e,...t},n)=>r.jsx(y2,{className:wr("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));BU.displayName=y2.displayName;const Gae=Mb("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),eI=R.forwardRef(({side:e="right",className:t,children:n,...s},i)=>r.jsxs(Wae,{children:[r.jsx(BU,{}),r.jsxs(v2,{ref:i,className:wr(Gae({side:e}),t),...s,children:[r.jsxs(zU,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[r.jsx(jy,{className:"h-4 w-4"}),r.jsx("span",{className:"sr-only",children:"Close"})]}),n]})]}));eI.displayName=v2.displayName;const tI=({className:e,...t})=>r.jsx("div",{className:wr("flex flex-col space-y-2 text-center sm:text-left",e),...t});tI.displayName="SheetHeader";const rI=R.forwardRef(({className:e,...t},n)=>r.jsx(_2,{ref:n,className:wr("text-lg font-semibold text-foreground",e),...t}));rI.displayName=_2.displayName;const nI=R.forwardRef(({className:e,...t},n)=>r.jsx(b2,{ref:n,className:wr("text-sm text-muted-foreground",e),...t}));nI.displayName=b2.displayName;const lr=R.forwardRef(({className:e,...t},n)=>r.jsx("div",{className:"relative w-full overflow-auto",children:r.jsx("table",{ref:n,className:wr("w-full caption-bottom text-sm",e),...t})}));lr.displayName="Table";const cr=R.forwardRef(({className:e,...t},n)=>r.jsx("thead",{ref:n,className:wr("[&_tr]:border-b",e),...t}));cr.displayName="TableHeader";const ur=R.forwardRef(({className:e,...t},n)=>r.jsx("tbody",{ref:n,className:wr("[&_tr:last-child]:border-0",e),...t}));ur.displayName="TableBody";const Kae=R.forwardRef(({className:e,...t},n)=>r.jsx("tfoot",{ref:n,className:wr("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));Kae.displayName="TableFooter";const lt=R.forwardRef(({className:e,...t},n)=>r.jsx("tr",{ref:n,className:wr("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));lt.displayName="TableRow";const le=R.forwardRef(({className:e,...t},n)=>r.jsx("th",{ref:n,className:wr("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));le.displayName="TableHead";const ne=R.forwardRef(({className:e,...t},n)=>r.jsx("td",{ref:n,className:wr("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));ne.displayName="TableCell";const Hae=R.forwardRef(({className:e,...t},n)=>r.jsx("caption",{ref:n,className:wr("mt-4 text-sm text-muted-foreground",e),...t}));Hae.displayName="TableCaption";const Zae=Mb("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function We({className:e,variant:t,...n}){return r.jsx("div",{className:wr(Zae({variant:t}),e),...n})}const Rr=LU,_n=Uae,Yae=FU,qU=R.forwardRef(({className:e,...t},n)=>r.jsx(y2,{ref:n,className:wr("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));qU.displayName=y2.displayName;const Er=R.forwardRef(({className:e,children:t,...n},s)=>r.jsxs(Yae,{children:[r.jsx(qU,{}),r.jsxs(v2,{ref:s,className:wr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,r.jsxs(zU,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[r.jsx(jy,{className:"h-4 w-4"}),r.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Er.displayName=v2.displayName;const Mr=({className:e,...t})=>r.jsx("div",{className:wr("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Mr.displayName="DialogHeader";const Ai=({className:e,...t})=>r.jsx("div",{className:wr("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Ai.displayName="DialogFooter";const Or=R.forwardRef(({className:e,...t},n)=>r.jsx(_2,{ref:n,className:wr("text-lg font-semibold leading-none tracking-tight",e),...t}));Or.displayName=_2.displayName;const Bs=R.forwardRef(({className:e,...t},n)=>r.jsx(b2,{ref:n,className:wr("text-sm text-muted-foreground",e),...t}));Bs.displayName=b2.displayName;function Xae({trigger:e,onImportComplete:t}){const[n,s]=R.useState(!1),[i,c]=R.useState(null),[u,a]=R.useState("name"),[m,p]=R.useState("type"),[y,v]=R.useState(!1),[j,S]=R.useState(null),k=D=>{D.target.files&&D.target.files[0]&&(c(D.target.files[0]),S(null))},N=async()=>{if(!i)return;v(!0),S(null);const D=new FormData;D.append("file",i),D.append("name_field",u),D.append("type_field",m);try{const O=await fetch("/api/v1/gis/schemes/import",{method:"POST",credentials:"include",body:D});if(!O.ok)throw new Error(`HTTP ${O.status}`);const T=await O.json();S(T),T.imported>0&&t&&setTimeout(()=>{t(),s(!1),c(null),S(null)},2e3)}catch(O){S({errors:[O.message]})}finally{v(!1)}};return r.jsxs(Rr,{open:n,onOpenChange:s,children:[r.jsx(_n,{asChild:!0,children:e||r.jsxs(se,{variant:"outline",children:[r.jsx(Go,{className:"mr-2 h-4 w-4"}),"Import GeoJSON"]})}),r.jsxs(Er,{className:"sm:max-w-[525px] bg-white dark:bg-gray-900",children:[r.jsxs(Mr,{children:[r.jsx(Or,{className:"text-gray-900 dark:text-gray-100",children:"Import GeoJSON"}),r.jsx(Bs,{className:"text-gray-600 dark:text-gray-400",children:"Upload a GeoJSON file to import water supply schemes. Maximum 10MB, 500 features."})]}),r.jsxs("div",{className:"grid gap-4 py-4",children:[r.jsxs("div",{className:"grid gap-2",children:[r.jsxs(Ne,{htmlFor:"file",className:"text-gray-900 dark:text-gray-100",children:[r.jsx(Zq,{className:"inline mr-2 h-4 w-4"}),"GeoJSON File"]}),r.jsx(Ge,{id:"file",type:"file",accept:".json,.geojson",onChange:k,className:"dark:bg-gray-800 dark:text-gray-100"}),i&&r.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Selected: ",i.name," (",(i.size/1024).toFixed(1)," KB)"]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"grid gap-2",children:[r.jsx(Ne,{htmlFor:"name-field",className:"text-gray-900 dark:text-gray-100",children:"Name Field"}),r.jsx(Ge,{id:"name-field",value:u,onChange:D=>a(D.target.value),placeholder:"name",className:"dark:bg-gray-800 dark:text-gray-100"})]}),r.jsxs("div",{className:"grid gap-2",children:[r.jsx(Ne,{htmlFor:"type-field",className:"text-gray-900 dark:text-gray-100",children:"Type Field"}),r.jsx(Ge,{id:"type-field",value:m,onChange:D=>p(D.target.value),placeholder:"type",className:"dark:bg-gray-800 dark:text-gray-100"})]})]}),j&&r.jsxs(Wi,{className:j.imported?"border-green-500 bg-green-50 dark:bg-green-950":"border-red-500 bg-red-50 dark:bg-red-950",children:[j.imported?r.jsx(Kh,{className:"h-4 w-4 text-green-600"}):r.jsx(ei,{className:"h-4 w-4 text-red-600"}),r.jsxs(ki,{className:"text-gray-900 dark:text-gray-100",children:[j.imported!==void 0&&r.jsxs("p",{className:"font-medium",children:["Successfully imported ",j.imported," of ",j.total," features"]}),j.errors&&j.errors.length>0&&r.jsxs("div",{className:"mt-2 space-y-1",children:[r.jsx("p",{className:"font-medium",children:"Errors:"}),r.jsxs("ul",{className:"list-disc list-inside text-sm",children:[j.errors.slice(0,5).map((D,O)=>r.jsx("li",{children:D},O)),j.errors.length>5&&r.jsxs("li",{children:["... and ",j.errors.length-5," more"]})]})]})]})]})]}),r.jsxs(Ai,{children:[r.jsx(se,{variant:"outline",onClick:()=>s(!1),disabled:y,className:"dark:bg-gray-800 dark:text-gray-100",children:"Cancel"}),r.jsx(se,{onClick:N,disabled:!i||y,children:y?r.jsxs(r.Fragment,{children:[r.jsx(Qu,{className:"mr-2 h-4 w-4 animate-spin"}),"Importing..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Go,{className:"mr-2 h-4 w-4"}),"Import"]})})]})]})]})}function Qae(){var V;const[e,t]=R.useState("map"),[n,s]=R.useState(""),[i,c]=R.useState("all"),[u,a]=R.useState("all"),[m,p]=R.useState(null),[y,v]=R.useState(null),[j,S]=R.useState(1),{data:k,isLoading:N,error:D,refetch:O}=ht({queryKey:["schemes",j,n,i,u],queryFn:()=>Bne.getAll({page:j,per_page:15,q:n||void 0,status:i!=="all"?i:void 0,type:u!=="all"?u:void 0})}),{data:T}=ht({queryKey:["schemes-geojson",i],queryFn:async()=>{const K=await fetch(`/api/v1/gis/schemes/geojson${i!=="all"?`?status=${i}`:""}`,{credentials:"include"});if(!K.ok)throw new Error("Failed to fetch GeoJSON");return K.json()},enabled:e==="map"}),I=async()=>{try{const K=await fetch("/api/v1/gis/schemes/export",{credentials:"include"});if(!K.ok)throw new Error(`HTTP ${K.status}`);const te=await K.blob(),X=window.URL.createObjectURL(te),ve=document.createElement("a");ve.href=X,ve.download=`schemes-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(ve),ve.click(),window.URL.revokeObjectURL(X),document.body.removeChild(ve)}catch(K){console.error("Export failed:",K)}},z=R.useCallback(K=>{const te=K.features&&K.features[0];if(te){v({longitude:K.lngLat.lng,latitude:K.lngLat.lat,feature:te.properties});const X={id:te.properties.id,code:te.properties.code,name:te.properties.name,type:te.properties.type,status:te.properties.status,population_estimate:te.properties.population_estimate};p(X)}},[]),$=K=>{switch(K){case"active":return"bg-green-500";case"planning":return"bg-blue-500";case"decommissioned":return"bg-gray-500";default:return"bg-gray-400"}};return r.jsxs("div",{className:"flex flex-col h-screen",children:[r.jsxs("div",{className:"border-b bg-background p-4",children:[r.jsxs("div",{className:"flex justify-between items-start mb-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Schemes Explorer"}),r.jsx("p",{className:"text-muted-foreground",children:"Water supply schemes registry with spatial visualization"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(se,{variant:"outline",onClick:I,children:[r.jsx(rl,{className:"mr-2 h-4 w-4"}),"Export GeoJSON"]}),r.jsx(Xae,{onImportComplete:()=>O()}),r.jsx(se,{children:"Create Scheme"})]})]}),r.jsxs("div",{className:"flex gap-4 items-end",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Search"}),r.jsxs("div",{className:"relative",children:[r.jsx(ci,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Search by name or code...",value:n,onChange:K=>s(K.target.value),className:"pl-10"})]})]}),r.jsxs("div",{className:"w-48",children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Status"}),r.jsxs(Jt,{value:i,onValueChange:c,children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select status..."})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Statuses"}),r.jsx(ke,{value:"active",children:"Active"}),r.jsx(ke,{value:"planning",children:"Planning"}),r.jsx(ke,{value:"decommissioned",children:"Decommissioned"})]})]})]}),r.jsxs("div",{className:"w-48",children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Type"}),r.jsxs(Jt,{value:u,onValueChange:a,children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select type..."})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Types"}),r.jsx(ke,{value:"urban",children:"Urban"}),r.jsx(ke,{value:"rural",children:"Rural"}),r.jsx(ke,{value:"peri-urban",children:"Peri-Urban"})]})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:e==="map"?"default":"outline",size:"icon",onClick:()=>t("map"),children:r.jsx(Bc,{className:"h-4 w-4"})}),r.jsx(se,{variant:e==="table"?"default":"outline",size:"icon",onClick:()=>t("table"),children:r.jsx(tne,{className:"h-4 w-4"})})]})]})]}),r.jsx("div",{className:"flex-1 overflow-hidden",children:N&&!k?r.jsx("div",{className:"flex items-center justify-center h-full",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading schemes..."})}):D?r.jsx("div",{className:"flex items-center justify-center h-full",children:r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-lg text-red-600 mb-2",children:"Error loading schemes"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:D.message}),r.jsx(se,{variant:"outline",className:"mt-4",onClick:()=>O(),children:"Try Again"})]})}):e==="map"?r.jsxs(Ob,{initialViewState:{longitude:36.8219,latitude:-1.2921,zoom:8},style:{width:"100%",height:"100%"},mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",interactiveLayerIds:["schemes-fill"],onClick:z,children:[r.jsx(Ib,{position:"top-right"}),r.jsx(Db,{}),T&&r.jsxs(T0,{id:"schemes",type:"geojson",data:T,children:[r.jsx(Tx,{id:"schemes-fill",type:"fill",paint:{"fill-color":["match",["get","status"],"active","#22c55e","planning","#3b82f6","decommissioned","#94a3b8","#6b7280"],"fill-opacity":.6}}),r.jsx(Tx,{id:"schemes-outline",type:"line",paint:{"line-color":"#000000","line-width":1}})]}),y&&r.jsx(Pne,{longitude:y.longitude,latitude:y.latitude,closeOnClick:!1,onClose:()=>v(null),children:r.jsxs("div",{className:"p-2",children:[r.jsx("h3",{className:"font-semibold",children:y.feature.name}),r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Code: ",y.feature.code]}),r.jsx(We,{className:`mt-2 ${$(y.feature.status)}`,children:y.feature.status})]})})]}):r.jsx("div",{className:"p-4 h-full overflow-auto",children:r.jsx(J,{children:r.jsxs(ie,{className:"p-0",children:[r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Code"}),r.jsx(le,{children:"Name"}),r.jsx(le,{children:"Type"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Population"}),r.jsx(le,{className:"text-right",children:"Actions"})]})}),r.jsx(ur,{children:k==null?void 0:k.data.map(K=>{var te;return r.jsxs(lt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>p(K),children:[r.jsx(ne,{className:"font-mono",children:K.code}),r.jsx(ne,{className:"font-medium",children:K.name}),r.jsx(ne,{className:"capitalize",children:K.type}),r.jsx(ne,{children:r.jsx(We,{className:$(K.status),children:K.status})}),r.jsx(ne,{children:((te=K.population_estimate)==null?void 0:te.toLocaleString())||"N/A"}),r.jsx(ne,{className:"text-right",children:r.jsx(se,{variant:"ghost",size:"sm",children:"View Details"})})]},K.id)})})]}),k&&k.last_page>1&&r.jsxs("div",{className:"flex justify-between items-center p-4 border-t",children:[r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",(k.current_page-1)*k.per_page+1," to ",Math.min(k.current_page*k.per_page,k.total)," of ",k.total," schemes"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:"outline",size:"sm",disabled:j===1,onClick:()=>S(K=>K-1),children:"Previous"}),r.jsx(se,{variant:"outline",size:"sm",disabled:j>=k.last_page,onClick:()=>S(K=>K+1),children:"Next"})]})]})]})})})}),r.jsx($U,{open:!!m,onOpenChange:K=>!K&&p(null),children:r.jsxs(eI,{className:"w-[400px] sm:w-[540px]",children:[r.jsxs(tI,{children:[r.jsx(rI,{children:m==null?void 0:m.name}),r.jsxs(nI,{children:["Code: ",m==null?void 0:m.code]})]}),m&&r.jsxs("div",{className:"mt-6 space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Type"}),r.jsx("p",{className:"text-lg capitalize",children:m.type})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),r.jsx("div",{className:"mt-1",children:r.jsx(We,{className:$(m.status),children:m.status})})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Population Served"}),r.jsx("p",{className:"text-lg",children:((V=m.population_estimate)==null?void 0:V.toLocaleString())||"Not specified"})]})]}),r.jsxs("div",{className:"space-y-2 pt-4 border-t",children:[r.jsx("h3",{className:"font-semibold",children:"Quick Actions"}),r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsx(se,{variant:"outline",className:"justify-start",children:"View Assets"}),r.jsx(se,{variant:"outline",className:"justify-start",children:"View DMAs"}),r.jsx(se,{variant:"outline",className:"justify-start",children:"View Facilities"}),r.jsx(se,{variant:"outline",className:"justify-start",children:"Network Topology"}),r.jsx(se,{variant:"outline",className:"justify-start",children:"Edit Details"})]})]})]})]})})]})}const k3={getAll:e=>me.get("/facilities",e),getById:e=>me.get(`/facilities/${e}`),create:e=>me.post("/facilities",e),update:(e,t)=>me.patch(`/facilities/${e}`,t),delete:e=>me.delete(`/facilities/${e}`)};var Jae=e=>{switch(e){case"success":return roe;case"info":return soe;case"warning":return noe;case"error":return ioe;default:return null}},eoe=Array(12).fill(0),toe=({visible:e,className:t})=>de.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},de.createElement("div",{className:"sonner-spinner"},eoe.map((n,s)=>de.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${s}`})))),roe=de.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},de.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),noe=de.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},de.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),soe=de.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},de.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),ioe=de.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},de.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),aoe=de.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},de.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),de.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),ooe=()=>{let[e,t]=de.useState(document.hidden);return de.useEffect(()=>{let n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},IT=1,loe=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:n,...s}=e,i=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:IT++,c=this.toasts.find(a=>a.id===i),u=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),c?this.toasts=this.toasts.map(a=>a.id===i?(this.publish({...a,...e,id:i,title:n}),{...a,...e,id:i,dismissible:u,title:n}):a):this.addToast({title:n,...s,dismissible:u,id:i}),i},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(n=>n({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let n;t.loading!==void 0&&(n=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let s=e instanceof Promise?e:e(),i=n!==void 0,c,u=s.then(async m=>{if(c=["resolve",m],de.isValidElement(m))i=!1,this.create({id:n,type:"default",message:m});else if(uoe(m)&&!m.ok){i=!1;let p=typeof t.error=="function"?await t.error(`HTTP error! status: ${m.status}`):t.error,y=typeof t.description=="function"?await t.description(`HTTP error! status: ${m.status}`):t.description;this.create({id:n,type:"error",message:p,description:y})}else if(t.success!==void 0){i=!1;let p=typeof t.success=="function"?await t.success(m):t.success,y=typeof t.description=="function"?await t.description(m):t.description;this.create({id:n,type:"success",message:p,description:y})}}).catch(async m=>{if(c=["reject",m],t.error!==void 0){i=!1;let p=typeof t.error=="function"?await t.error(m):t.error,y=typeof t.description=="function"?await t.description(m):t.description;this.create({id:n,type:"error",message:p,description:y})}}).finally(()=>{var m;i&&(this.dismiss(n),n=void 0),(m=t.finally)==null||m.call(t)}),a=()=>new Promise((m,p)=>u.then(()=>c[0]==="reject"?p(c[1]):m(c[1])).catch(p));return typeof n!="string"&&typeof n!="number"?{unwrap:a}:Object.assign(n,{unwrap:a})},this.custom=(e,t)=>{let n=(t==null?void 0:t.id)||IT++;return this.create({jsx:e(n),id:n,...t}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},co=new loe,coe=(e,t)=>{let n=(t==null?void 0:t.id)||IT++;return co.addToast({title:e,...t,id:n}),n},uoe=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",doe=coe,hoe=()=>co.toasts,foe=()=>co.getActiveToasts(),qe=Object.assign(doe,{success:co.success,info:co.info,warning:co.warning,error:co.error,custom:co.custom,message:co.message,promise:co.promise,dismiss:co.dismiss,loading:co.loading},{getHistory:hoe,getToasts:foe});function moe(e,{insertAt:t}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",t==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}moe(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Hw(e){return e.label!==void 0}var poe=3,goe="32px",xoe="16px",T3=4e3,yoe=356,voe=14,_oe=20,boe=200;function Yl(...e){return e.filter(Boolean).join(" ")}function joe(e){let[t,n]=e.split("-"),s=[];return t&&s.push(t),n&&s.push(n),s}var woe=e=>{var t,n,s,i,c,u,a,m,p,y,v;let{invert:j,toast:S,unstyled:k,interacting:N,setHeights:D,visibleToasts:O,heights:T,index:I,toasts:z,expanded:$,removeToast:V,defaultRichColors:K,closeButton:te,style:X,cancelButtonStyle:ve,actionButtonStyle:ae,className:pe="",descriptionClassName:Oe="",duration:Me,position:Xe,gap:Ve,loadingIcon:et,expandByDefault:Ce,classNames:_e,icons:tt,closeButtonAriaLabel:vt="Close toast",pauseWhenPageIsHidden:gt}=e,[Tt,Ht]=de.useState(null),[Ir,Pr]=de.useState(null),[Mt,yr]=de.useState(!1),[Nt,Wt]=de.useState(!1),[Zt,mt]=de.useState(!1),[qr,ar]=de.useState(!1),[en,Lr]=de.useState(!1),[An,vs]=de.useState(0),[Wn,Be]=de.useState(0),rt=de.useRef(S.duration||Me||T3),pt=de.useRef(null),Lt=de.useRef(null),Rt=I===0,Ot=I+1<=O,tr=S.type,tn=S.dismissible!==!1,Sn=S.className||"",ks=S.descriptionClassName||"",Ue=de.useMemo(()=>T.findIndex(hr=>hr.toastId===S.id)||0,[T,S.id]),ce=de.useMemo(()=>{var hr;return(hr=S.closeButton)!=null?hr:te},[S.closeButton,te]),ue=de.useMemo(()=>S.duration||Me||T3,[S.duration,Me]),ye=de.useRef(0),Ae=de.useRef(0),Fe=de.useRef(0),Ye=de.useRef(null),[nt,He]=Xe.split("-"),ct=de.useMemo(()=>T.reduce((hr,zt,pr)=>pr>=Ue?hr:hr+zt.height,0),[T,Ue]),Pt=ooe(),yt=S.invert||j,or=tr==="loading";Ae.current=de.useMemo(()=>Ue*Ve+ct,[Ue,ct]),de.useEffect(()=>{rt.current=ue},[ue]),de.useEffect(()=>{yr(!0)},[]),de.useEffect(()=>{let hr=Lt.current;if(hr){let zt=hr.getBoundingClientRect().height;return Be(zt),D(pr=>[{toastId:S.id,height:zt,position:S.position},...pr]),()=>D(pr=>pr.filter(ln=>ln.toastId!==S.id))}},[D,S.id]),de.useLayoutEffect(()=>{if(!Mt)return;let hr=Lt.current,zt=hr.style.height;hr.style.height="auto";let pr=hr.getBoundingClientRect().height;hr.style.height=zt,Be(pr),D(ln=>ln.find(Nn=>Nn.toastId===S.id)?ln.map(Nn=>Nn.toastId===S.id?{...Nn,height:pr}:Nn):[{toastId:S.id,height:pr,position:S.position},...ln])},[Mt,S.title,S.description,D,S.id]);let Je=de.useCallback(()=>{Wt(!0),vs(Ae.current),D(hr=>hr.filter(zt=>zt.toastId!==S.id)),setTimeout(()=>{V(S)},boe)},[S,V,D,Ae]);de.useEffect(()=>{if(S.promise&&tr==="loading"||S.duration===1/0||S.type==="loading")return;let hr;return $||N||gt&&Pt?(()=>{if(Fe.current<ye.current){let zt=new Date().getTime()-ye.current;rt.current=rt.current-zt}Fe.current=new Date().getTime()})():rt.current!==1/0&&(ye.current=new Date().getTime(),hr=setTimeout(()=>{var zt;(zt=S.onAutoClose)==null||zt.call(S,S),Je()},rt.current)),()=>clearTimeout(hr)},[$,N,S,tr,gt,Pt,Je]),de.useEffect(()=>{S.delete&&Je()},[Je,S.delete]);function Qr(){var hr,zt,pr;return tt!=null&&tt.loading?de.createElement("div",{className:Yl(_e==null?void 0:_e.loader,(hr=S==null?void 0:S.classNames)==null?void 0:hr.loader,"sonner-loader"),"data-visible":tr==="loading"},tt.loading):et?de.createElement("div",{className:Yl(_e==null?void 0:_e.loader,(zt=S==null?void 0:S.classNames)==null?void 0:zt.loader,"sonner-loader"),"data-visible":tr==="loading"},et):de.createElement(toe,{className:Yl(_e==null?void 0:_e.loader,(pr=S==null?void 0:S.classNames)==null?void 0:pr.loader),visible:tr==="loading"})}return de.createElement("li",{tabIndex:0,ref:Lt,className:Yl(pe,Sn,_e==null?void 0:_e.toast,(t=S==null?void 0:S.classNames)==null?void 0:t.toast,_e==null?void 0:_e.default,_e==null?void 0:_e[tr],(n=S==null?void 0:S.classNames)==null?void 0:n[tr]),"data-sonner-toast":"","data-rich-colors":(s=S.richColors)!=null?s:K,"data-styled":!(S.jsx||S.unstyled||k),"data-mounted":Mt,"data-promise":!!S.promise,"data-swiped":en,"data-removed":Nt,"data-visible":Ot,"data-y-position":nt,"data-x-position":He,"data-index":I,"data-front":Rt,"data-swiping":Zt,"data-dismissible":tn,"data-type":tr,"data-invert":yt,"data-swipe-out":qr,"data-swipe-direction":Ir,"data-expanded":!!($||Ce&&Mt),style:{"--index":I,"--toasts-before":I,"--z-index":z.length-I,"--offset":`${Nt?An:Ae.current}px`,"--initial-height":Ce?"auto":`${Wn}px`,...X,...S.style},onDragEnd:()=>{mt(!1),Ht(null),Ye.current=null},onPointerDown:hr=>{or||!tn||(pt.current=new Date,vs(Ae.current),hr.target.setPointerCapture(hr.pointerId),hr.target.tagName!=="BUTTON"&&(mt(!0),Ye.current={x:hr.clientX,y:hr.clientY}))},onPointerUp:()=>{var hr,zt,pr,ln;if(qr||!tn)return;Ye.current=null;let Nn=Number(((hr=Lt.current)==null?void 0:hr.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Gn=Number(((zt=Lt.current)==null?void 0:zt.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),kn=new Date().getTime()-((pr=pt.current)==null?void 0:pr.getTime()),Tn=Tt==="x"?Nn:Gn,Pn=Math.abs(Tn)/kn;if(Math.abs(Tn)>=_oe||Pn>.11){vs(Ae.current),(ln=S.onDismiss)==null||ln.call(S,S),Pr(Tt==="x"?Nn>0?"right":"left":Gn>0?"down":"up"),Je(),ar(!0),Lr(!1);return}mt(!1),Ht(null)},onPointerMove:hr=>{var zt,pr,ln,Nn;if(!Ye.current||!tn||((zt=window.getSelection())==null?void 0:zt.toString().length)>0)return;let Gn=hr.clientY-Ye.current.y,kn=hr.clientX-Ye.current.x,Tn=(pr=e.swipeDirections)!=null?pr:joe(Xe);!Tt&&(Math.abs(kn)>1||Math.abs(Gn)>1)&&Ht(Math.abs(kn)>Math.abs(Gn)?"x":"y");let Pn={x:0,y:0};Tt==="y"?(Tn.includes("top")||Tn.includes("bottom"))&&(Tn.includes("top")&&Gn<0||Tn.includes("bottom")&&Gn>0)&&(Pn.y=Gn):Tt==="x"&&(Tn.includes("left")||Tn.includes("right"))&&(Tn.includes("left")&&kn<0||Tn.includes("right")&&kn>0)&&(Pn.x=kn),(Math.abs(Pn.x)>0||Math.abs(Pn.y)>0)&&Lr(!0),(ln=Lt.current)==null||ln.style.setProperty("--swipe-amount-x",`${Pn.x}px`),(Nn=Lt.current)==null||Nn.style.setProperty("--swipe-amount-y",`${Pn.y}px`)}},ce&&!S.jsx?de.createElement("button",{"aria-label":vt,"data-disabled":or,"data-close-button":!0,onClick:or||!tn?()=>{}:()=>{var hr;Je(),(hr=S.onDismiss)==null||hr.call(S,S)},className:Yl(_e==null?void 0:_e.closeButton,(i=S==null?void 0:S.classNames)==null?void 0:i.closeButton)},(c=tt==null?void 0:tt.close)!=null?c:aoe):null,S.jsx||R.isValidElement(S.title)?S.jsx?S.jsx:typeof S.title=="function"?S.title():S.title:de.createElement(de.Fragment,null,tr||S.icon||S.promise?de.createElement("div",{"data-icon":"",className:Yl(_e==null?void 0:_e.icon,(u=S==null?void 0:S.classNames)==null?void 0:u.icon)},S.promise||S.type==="loading"&&!S.icon?S.icon||Qr():null,S.type!=="loading"?S.icon||(tt==null?void 0:tt[tr])||Jae(tr):null):null,de.createElement("div",{"data-content":"",className:Yl(_e==null?void 0:_e.content,(a=S==null?void 0:S.classNames)==null?void 0:a.content)},de.createElement("div",{"data-title":"",className:Yl(_e==null?void 0:_e.title,(m=S==null?void 0:S.classNames)==null?void 0:m.title)},typeof S.title=="function"?S.title():S.title),S.description?de.createElement("div",{"data-description":"",className:Yl(Oe,ks,_e==null?void 0:_e.description,(p=S==null?void 0:S.classNames)==null?void 0:p.description)},typeof S.description=="function"?S.description():S.description):null),R.isValidElement(S.cancel)?S.cancel:S.cancel&&Hw(S.cancel)?de.createElement("button",{"data-button":!0,"data-cancel":!0,style:S.cancelButtonStyle||ve,onClick:hr=>{var zt,pr;Hw(S.cancel)&&tn&&((pr=(zt=S.cancel).onClick)==null||pr.call(zt,hr),Je())},className:Yl(_e==null?void 0:_e.cancelButton,(y=S==null?void 0:S.classNames)==null?void 0:y.cancelButton)},S.cancel.label):null,R.isValidElement(S.action)?S.action:S.action&&Hw(S.action)?de.createElement("button",{"data-button":!0,"data-action":!0,style:S.actionButtonStyle||ae,onClick:hr=>{var zt,pr;Hw(S.action)&&((pr=(zt=S.action).onClick)==null||pr.call(zt,hr),!hr.defaultPrevented&&Je())},className:Yl(_e==null?void 0:_e.actionButton,(v=S==null?void 0:S.classNames)==null?void 0:v.actionButton)},S.action.label):null))};function E3(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Soe(e,t){let n={};return[e,t].forEach((s,i)=>{let c=i===1,u=c?"--mobile-offset":"--offset",a=c?xoe:goe;function m(p){["top","right","bottom","left"].forEach(y=>{n[`${u}-${y}`]=typeof p=="number"?`${p}px`:p})}typeof s=="number"||typeof s=="string"?m(s):typeof s=="object"?["top","right","bottom","left"].forEach(p=>{s[p]===void 0?n[`${u}-${p}`]=a:n[`${u}-${p}`]=typeof s[p]=="number"?`${s[p]}px`:s[p]}):m(a)}),n}R.forwardRef(function(e,t){let{invert:n,position:s="bottom-right",hotkey:i=["altKey","KeyT"],expand:c,closeButton:u,className:a,offset:m,mobileOffset:p,theme:y="light",richColors:v,duration:j,style:S,visibleToasts:k=poe,toastOptions:N,dir:D=E3(),gap:O=voe,loadingIcon:T,icons:I,containerAriaLabel:z="Notifications",pauseWhenPageIsHidden:$}=e,[V,K]=de.useState([]),te=de.useMemo(()=>Array.from(new Set([s].concat(V.filter(gt=>gt.position).map(gt=>gt.position)))),[V,s]),[X,ve]=de.useState([]),[ae,pe]=de.useState(!1),[Oe,Me]=de.useState(!1),[Xe,Ve]=de.useState(y!=="system"?y:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),et=de.useRef(null),Ce=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),_e=de.useRef(null),tt=de.useRef(!1),vt=de.useCallback(gt=>{K(Tt=>{var Ht;return(Ht=Tt.find(Ir=>Ir.id===gt.id))!=null&&Ht.delete||co.dismiss(gt.id),Tt.filter(({id:Ir})=>Ir!==gt.id)})},[]);return de.useEffect(()=>co.subscribe(gt=>{if(gt.dismiss){K(Tt=>Tt.map(Ht=>Ht.id===gt.id?{...Ht,delete:!0}:Ht));return}setTimeout(()=>{iq.flushSync(()=>{K(Tt=>{let Ht=Tt.findIndex(Ir=>Ir.id===gt.id);return Ht!==-1?[...Tt.slice(0,Ht),{...Tt[Ht],...gt},...Tt.slice(Ht+1)]:[gt,...Tt]})})})}),[]),de.useEffect(()=>{if(y!=="system"){Ve(y);return}if(y==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Ve("dark"):Ve("light")),typeof window>"u")return;let gt=window.matchMedia("(prefers-color-scheme: dark)");try{gt.addEventListener("change",({matches:Tt})=>{Ve(Tt?"dark":"light")})}catch{gt.addListener(({matches:Ht})=>{try{Ve(Ht?"dark":"light")}catch(Ir){console.error(Ir)}})}},[y]),de.useEffect(()=>{V.length<=1&&pe(!1)},[V]),de.useEffect(()=>{let gt=Tt=>{var Ht,Ir;i.every(Pr=>Tt[Pr]||Tt.code===Pr)&&(pe(!0),(Ht=et.current)==null||Ht.focus()),Tt.code==="Escape"&&(document.activeElement===et.current||(Ir=et.current)!=null&&Ir.contains(document.activeElement))&&pe(!1)};return document.addEventListener("keydown",gt),()=>document.removeEventListener("keydown",gt)},[i]),de.useEffect(()=>{if(et.current)return()=>{_e.current&&(_e.current.focus({preventScroll:!0}),_e.current=null,tt.current=!1)}},[et.current]),de.createElement("section",{ref:t,"aria-label":`${z} ${Ce}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},te.map((gt,Tt)=>{var Ht;let[Ir,Pr]=gt.split("-");return V.length?de.createElement("ol",{key:gt,dir:D==="auto"?E3():D,tabIndex:-1,ref:et,className:a,"data-sonner-toaster":!0,"data-theme":Xe,"data-y-position":Ir,"data-lifted":ae&&V.length>1&&!c,"data-x-position":Pr,style:{"--front-toast-height":`${((Ht=X[0])==null?void 0:Ht.height)||0}px`,"--width":`${yoe}px`,"--gap":`${O}px`,...S,...Soe(m,p)},onBlur:Mt=>{tt.current&&!Mt.currentTarget.contains(Mt.relatedTarget)&&(tt.current=!1,_e.current&&(_e.current.focus({preventScroll:!0}),_e.current=null))},onFocus:Mt=>{Mt.target instanceof HTMLElement&&Mt.target.dataset.dismissible==="false"||tt.current||(tt.current=!0,_e.current=Mt.relatedTarget)},onMouseEnter:()=>pe(!0),onMouseMove:()=>pe(!0),onMouseLeave:()=>{Oe||pe(!1)},onDragEnd:()=>pe(!1),onPointerDown:Mt=>{Mt.target instanceof HTMLElement&&Mt.target.dataset.dismissible==="false"||Me(!0)},onPointerUp:()=>Me(!1)},V.filter(Mt=>!Mt.position&&Tt===0||Mt.position===gt).map((Mt,yr)=>{var Nt,Wt;return de.createElement(woe,{key:Mt.id,icons:I,index:yr,toast:Mt,defaultRichColors:v,duration:(Nt=N==null?void 0:N.duration)!=null?Nt:j,className:N==null?void 0:N.className,descriptionClassName:N==null?void 0:N.descriptionClassName,invert:n,visibleToasts:k,closeButton:(Wt=N==null?void 0:N.closeButton)!=null?Wt:u,interacting:Oe,position:gt,style:N==null?void 0:N.style,unstyled:N==null?void 0:N.unstyled,classNames:N==null?void 0:N.classNames,cancelButtonStyle:N==null?void 0:N.cancelButtonStyle,actionButtonStyle:N==null?void 0:N.actionButtonStyle,removeToast:vt,toasts:V.filter(Zt=>Zt.position==Mt.position),heights:X.filter(Zt=>Zt.position==Mt.position),setHeights:ve,expandByDefault:c,gap:O,loadingIcon:T,expanded:ae,pauseWhenPageIsHidden:$,swipeDirections:e.swipeDirections})})):null}))});function Noe(){const[e,t]=R.useState(!1),[n,s]=R.useState({code:"",name:"",category:"",status:"active",scheme_id:""}),i=br(),{data:c,isLoading:u,error:a}=ht({queryKey:["facilities"],queryFn:()=>k3.getAll({per_page:50})}),m=jt({mutationFn:j=>k3.create(j),onSuccess:()=>{i.invalidateQueries({queryKey:["facilities"]}),t(!1),s({code:"",name:"",category:"",status:"active",scheme_id:""}),qe.success("Facility created successfully")},onError:j=>{var S,k;qe.error(((k=(S=j.response)==null?void 0:S.data)==null?void 0:k.message)||"Failed to create facility")}}),p=j=>{if(j.preventDefault(),!n.code||!n.name||!n.category){qe.error("Please fill in all required fields");return}m.mutate(n)},y=async()=>{try{const j=await fetch("/api/v1/gis/facilities/export",{credentials:"include"});if(!j.ok)throw new Error(`HTTP ${j.status}`);const S=await j.blob(),k=window.URL.createObjectURL(S),N=document.createElement("a");N.href=k,N.download=`facilities-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(N),N.click(),window.URL.revokeObjectURL(k),document.body.removeChild(N)}catch(j){console.error("Export failed:",j)}},v={source:"bg-blue-500",treatment:"bg-green-500",pumpstation:"bg-purple-500",reservoir:"bg-cyan-500",office:"bg-gray-500",workshop:"bg-yellow-500",warehouse:"bg-orange-500",lab:"bg-pink-500"};return r.jsxs("div",{className:"container mx-auto p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Facilities"}),r.jsx("p",{className:"text-muted-foreground",children:"Manage water infrastructure facilities"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(se,{variant:"outline",onClick:y,children:[r.jsx(rl,{className:"mr-2 h-4 w-4"}),"Export GeoJSON"]}),r.jsxs(Rr,{open:e,onOpenChange:t,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Create Facility"]})}),r.jsxs(Er,{children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:"Create New Facility"}),r.jsx(Bs,{children:"Add a new water infrastructure facility to the registry"})]}),r.jsxs("form",{onSubmit:p,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"code",children:"Code*"}),r.jsx(Ge,{id:"code",placeholder:"e.g. FAC-001",value:n.code,onChange:j=>s({...n,code:j.target.value}),required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"category",children:"Category*"}),r.jsxs(Jt,{value:n.category,onValueChange:j=>s({...n,category:j}),children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select category"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"source",children:"Water Source"}),r.jsx(ke,{value:"treatment",children:"Treatment Plant"}),r.jsx(ke,{value:"pumpstation",children:"Pump Station"}),r.jsx(ke,{value:"reservoir",children:"Reservoir"}),r.jsx(ke,{value:"office",children:"Office"}),r.jsx(ke,{value:"workshop",children:"Workshop"}),r.jsx(ke,{value:"warehouse",children:"Warehouse"}),r.jsx(ke,{value:"lab",children:"Lab"})]})]})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"name",children:"Name*"}),r.jsx(Ge,{id:"name",placeholder:"Facility name",value:n.name,onChange:j=>s({...n,name:j.target.value}),required:!0})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"status",children:"Status"}),r.jsxs(Jt,{value:n.status,onValueChange:j=>s({...n,status:j}),children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"active",children:"Active"}),r.jsx(ke,{value:"standby",children:"Standby"}),r.jsx(ke,{value:"inactive",children:"Inactive"})]})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"scheme_id",children:"Scheme ID"}),r.jsx(Ge,{id:"scheme_id",placeholder:"Optional",value:n.scheme_id,onChange:j=>s({...n,scheme_id:j.target.value})})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:m.isPending,children:m.isPending?"Creating...":"Create Facility"})]})]})]})]})]})]}),u&&!c?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading facilities..."})}):a?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-lg text-red-600 mb-2",children:"Error loading facilities"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:a.message})]})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c==null?void 0:c.data.map(j=>r.jsxs(J,{className:"hover:shadow-lg transition-shadow",children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx(xe,{children:j.name}),r.jsxs(xr,{children:["Code: ",j.code]})]}),r.jsx(We,{className:v[j.category]||"bg-gray-500",children:j.category})]})}),r.jsx(ie,{children:r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Status:"}),r.jsx("span",{className:`font-medium capitalize ${j.status==="active"?"text-green-600":j.status==="standby"?"text-yellow-600":"text-gray-600"}`,children:j.status})]}),j.scheme&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Scheme:"}),r.jsx("span",{className:"font-medium truncate ml-2",children:j.scheme.name})]}),j.commissioned_on&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Commissioned:"}),r.jsx("span",{className:"font-medium",children:new Date(j.commissioned_on).toLocaleDateString()})]})]})})]},j.id))}),(c==null?void 0:c.data.length)===0&&r.jsx(J,{children:r.jsxs(ie,{className:"flex flex-col items-center justify-center p-12",children:[r.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No facilities found"}),r.jsx(se,{children:"Create Your First Facility"})]})})]})]})}function ys(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Xh(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function M1(e,t){const n=ys(e);return isNaN(t)?Xh(e,NaN):(t&&n.setDate(n.getDate()+t),n)}const VU=6048e5,Poe=864e5,UU=6e4,WU=36e5;let Coe={};function j2(){return Coe}function qm(e,t){var a,m,p,y;const n=j2(),s=(t==null?void 0:t.weekStartsOn)??((m=(a=t==null?void 0:t.locale)==null?void 0:a.options)==null?void 0:m.weekStartsOn)??n.weekStartsOn??((y=(p=n.locale)==null?void 0:p.options)==null?void 0:y.weekStartsOn)??0,i=ys(e),c=i.getDay(),u=(c<s?7:0)+c-s;return i.setDate(i.getDate()-u),i.setHours(0,0,0,0),i}function yS(e){return qm(e,{weekStartsOn:1})}function GU(e){const t=ys(e),n=t.getFullYear(),s=Xh(e,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const i=yS(s),c=Xh(e,0);c.setFullYear(n,0,4),c.setHours(0,0,0,0);const u=yS(c);return t.getTime()>=i.getTime()?n+1:t.getTime()>=u.getTime()?n:n-1}function Mx(e){const t=ys(e);return t.setHours(0,0,0,0),t}function M3(e){const t=ys(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function Aoe(e,t){const n=Mx(e),s=Mx(t),i=+n-M3(n),c=+s-M3(s);return Math.round((i-c)/Poe)}function koe(e){const t=GU(e),n=Xh(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),yS(n)}function pA(e,t){const n=ys(e),s=ys(t),i=n.getTime()-s.getTime();return i<0?-1:i>0?1:i}function O3(e,t){const n=Mx(e),s=Mx(t);return+n==+s}function Toe(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Eoe(e){if(!Toe(e)&&typeof e!="number")return!1;const t=ys(e);return!isNaN(Number(t))}function Moe(e,t){const n=ys(e),s=ys(t),i=n.getFullYear()-s.getFullYear(),c=n.getMonth()-s.getMonth();return i*12+c}function Ooe(e){const t=ys(e);return t.setHours(23,59,59,999),t}function Ioe(e){const t=ys(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function Doe(e){const t=ys(e);return+Ooe(t)==+Ioe(t)}function Roe(e,t){const n=ys(e),s=ys(t),i=pA(n,s),c=Math.abs(Moe(n,s));let u;if(c<1)u=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-i*c);let a=pA(n,s)===-i;Doe(ys(e))&&c===1&&pA(e,s)===1&&(a=!1),u=i*(c-Number(a))}return u===0?0:u}function Loe(e,t){const n=ys(e.start),s=ys(e.end);let i=+n>+s;const c=i?+n:+s,u=i?s:n;u.setHours(0,0,0,0);let a=1;const m=[];for(;+u<=c;)m.push(ys(u)),u.setDate(u.getDate()+a),u.setHours(0,0,0,0);return i?m.reverse():m}function Foe(e){const t=ys(e),n=Xh(e,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}function zoe(e,t){const n=t==null?void 0:t.weekStartsOn,s=ys(e),i=s.getDay(),c=(i<n?-7:0)+6-(i-n);return s.setDate(s.getDate()+c),s.setHours(23,59,59,999),s}const $oe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Boe=(e,t,n)=>{let s;const i=$oe[e];return typeof i=="string"?s=i:t===1?s=i.one:s=i.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};function gA(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const qoe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Voe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Uoe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Woe={date:gA({formats:qoe,defaultWidth:"full"}),time:gA({formats:Voe,defaultWidth:"full"}),dateTime:gA({formats:Uoe,defaultWidth:"full"})},Goe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Koe=(e,t,n,s)=>Goe[e];function x_(e){return(t,n)=>{const s=n!=null&&n.context?String(n.context):"standalone";let i;if(s==="formatting"&&e.formattingValues){const u=e.defaultFormattingWidth||e.defaultWidth,a=n!=null&&n.width?String(n.width):u;i=e.formattingValues[a]||e.formattingValues[u]}else{const u=e.defaultWidth,a=n!=null&&n.width?String(n.width):e.defaultWidth;i=e.values[a]||e.values[u]}const c=e.argumentCallback?e.argumentCallback(t):t;return i[c]}}const Hoe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Zoe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Yoe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Xoe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Qoe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Joe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ele=(e,t)=>{const n=Number(e),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},tle={ordinalNumber:ele,era:x_({values:Hoe,defaultWidth:"wide"}),quarter:x_({values:Zoe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:x_({values:Yoe,defaultWidth:"wide"}),day:x_({values:Xoe,defaultWidth:"wide"}),dayPeriod:x_({values:Qoe,defaultWidth:"wide",formattingValues:Joe,defaultFormattingWidth:"wide"})};function y_(e){return(t,n={})=>{const s=n.width,i=s&&e.matchPatterns[s]||e.matchPatterns[e.defaultMatchWidth],c=t.match(i);if(!c)return null;const u=c[0],a=s&&e.parsePatterns[s]||e.parsePatterns[e.defaultParseWidth],m=Array.isArray(a)?nle(a,v=>v.test(u)):rle(a,v=>v.test(u));let p;p=e.valueCallback?e.valueCallback(m):m,p=n.valueCallback?n.valueCallback(p):p;const y=t.slice(u.length);return{value:p,rest:y}}}function rle(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function nle(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function sle(e){return(t,n={})=>{const s=t.match(e.matchPattern);if(!s)return null;const i=s[0],c=t.match(e.parsePattern);if(!c)return null;let u=e.valueCallback?e.valueCallback(c[0]):c[0];u=n.valueCallback?n.valueCallback(u):u;const a=t.slice(i.length);return{value:u,rest:a}}}const ile=/^(\d+)(th|st|nd|rd)?/i,ale=/\d+/i,ole={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},lle={any:[/^b/i,/^(a|c)/i]},cle={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},ule={any:[/1/i,/2/i,/3/i,/4/i]},dle={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},hle={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},fle={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},mle={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},ple={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},gle={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},xle={ordinalNumber:sle({matchPattern:ile,parsePattern:ale,valueCallback:e=>parseInt(e,10)}),era:y_({matchPatterns:ole,defaultMatchWidth:"wide",parsePatterns:lle,defaultParseWidth:"any"}),quarter:y_({matchPatterns:cle,defaultMatchWidth:"wide",parsePatterns:ule,defaultParseWidth:"any",valueCallback:e=>e+1}),month:y_({matchPatterns:dle,defaultMatchWidth:"wide",parsePatterns:hle,defaultParseWidth:"any"}),day:y_({matchPatterns:fle,defaultMatchWidth:"wide",parsePatterns:mle,defaultParseWidth:"any"}),dayPeriod:y_({matchPatterns:ple,defaultMatchWidth:"any",parsePatterns:gle,defaultParseWidth:"any"})},yle={code:"en-US",formatDistance:Boe,formatLong:Woe,formatRelative:Koe,localize:tle,match:xle,options:{weekStartsOn:0,firstWeekContainsDate:1}};function vle(e){const t=ys(e);return Aoe(t,Foe(t))+1}function _le(e){const t=ys(e),n=+yS(t)-+koe(t);return Math.round(n/VU)+1}function KU(e,t){var y,v,j,S;const n=ys(e),s=n.getFullYear(),i=j2(),c=(t==null?void 0:t.firstWeekContainsDate)??((v=(y=t==null?void 0:t.locale)==null?void 0:y.options)==null?void 0:v.firstWeekContainsDate)??i.firstWeekContainsDate??((S=(j=i.locale)==null?void 0:j.options)==null?void 0:S.firstWeekContainsDate)??1,u=Xh(e,0);u.setFullYear(s+1,0,c),u.setHours(0,0,0,0);const a=qm(u,t),m=Xh(e,0);m.setFullYear(s,0,c),m.setHours(0,0,0,0);const p=qm(m,t);return n.getTime()>=a.getTime()?s+1:n.getTime()>=p.getTime()?s:s-1}function ble(e,t){var a,m,p,y;const n=j2(),s=(t==null?void 0:t.firstWeekContainsDate)??((m=(a=t==null?void 0:t.locale)==null?void 0:a.options)==null?void 0:m.firstWeekContainsDate)??n.firstWeekContainsDate??((y=(p=n.locale)==null?void 0:p.options)==null?void 0:y.firstWeekContainsDate)??1,i=KU(e,t),c=Xh(e,0);return c.setFullYear(i,0,s),c.setHours(0,0,0,0),qm(c,t)}function jle(e,t){const n=ys(e),s=+qm(n,t)-+ble(n,t);return Math.round(s/VU)+1}function Zn(e,t){const n=e<0?"-":"",s=Math.abs(e).toString().padStart(t,"0");return n+s}const rh={y(e,t){const n=e.getFullYear(),s=n>0?n:1-n;return Zn(t==="yy"?s%100:s,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):Zn(n+1,2)},d(e,t){return Zn(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return Zn(e.getHours()%12||12,t.length)},H(e,t){return Zn(e.getHours(),t.length)},m(e,t){return Zn(e.getMinutes(),t.length)},s(e,t){return Zn(e.getSeconds(),t.length)},S(e,t){const n=t.length,s=e.getMilliseconds(),i=Math.trunc(s*Math.pow(10,n-3));return Zn(i,t.length)}},mg={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},I3={G:function(e,t,n){const s=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(s,{width:"abbreviated"});case"GGGGG":return n.era(s,{width:"narrow"});case"GGGG":default:return n.era(s,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const s=e.getFullYear(),i=s>0?s:1-s;return n.ordinalNumber(i,{unit:"year"})}return rh.y(e,t)},Y:function(e,t,n,s){const i=KU(e,s),c=i>0?i:1-i;if(t==="YY"){const u=c%100;return Zn(u,2)}return t==="Yo"?n.ordinalNumber(c,{unit:"year"}):Zn(c,t.length)},R:function(e,t){const n=GU(e);return Zn(n,t.length)},u:function(e,t){const n=e.getFullYear();return Zn(n,t.length)},Q:function(e,t,n){const s=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(s);case"QQ":return Zn(s,2);case"Qo":return n.ordinalNumber(s,{unit:"quarter"});case"QQQ":return n.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(s,{width:"wide",context:"formatting"})}},q:function(e,t,n){const s=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(s);case"qq":return Zn(s,2);case"qo":return n.ordinalNumber(s,{unit:"quarter"});case"qqq":return n.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(s,{width:"wide",context:"standalone"})}},M:function(e,t,n){const s=e.getMonth();switch(t){case"M":case"MM":return rh.M(e,t);case"Mo":return n.ordinalNumber(s+1,{unit:"month"});case"MMM":return n.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(s,{width:"wide",context:"formatting"})}},L:function(e,t,n){const s=e.getMonth();switch(t){case"L":return String(s+1);case"LL":return Zn(s+1,2);case"Lo":return n.ordinalNumber(s+1,{unit:"month"});case"LLL":return n.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(s,{width:"wide",context:"standalone"})}},w:function(e,t,n,s){const i=jle(e,s);return t==="wo"?n.ordinalNumber(i,{unit:"week"}):Zn(i,t.length)},I:function(e,t,n){const s=_le(e);return t==="Io"?n.ordinalNumber(s,{unit:"week"}):Zn(s,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):rh.d(e,t)},D:function(e,t,n){const s=vle(e);return t==="Do"?n.ordinalNumber(s,{unit:"dayOfYear"}):Zn(s,t.length)},E:function(e,t,n){const s=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(s,{width:"short",context:"formatting"});case"EEEE":default:return n.day(s,{width:"wide",context:"formatting"})}},e:function(e,t,n,s){const i=e.getDay(),c=(i-s.weekStartsOn+8)%7||7;switch(t){case"e":return String(c);case"ee":return Zn(c,2);case"eo":return n.ordinalNumber(c,{unit:"day"});case"eee":return n.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(i,{width:"short",context:"formatting"});case"eeee":default:return n.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,n,s){const i=e.getDay(),c=(i-s.weekStartsOn+8)%7||7;switch(t){case"c":return String(c);case"cc":return Zn(c,t.length);case"co":return n.ordinalNumber(c,{unit:"day"});case"ccc":return n.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(i,{width:"narrow",context:"standalone"});case"cccccc":return n.day(i,{width:"short",context:"standalone"});case"cccc":default:return n.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,n){const s=e.getDay(),i=s===0?7:s;switch(t){case"i":return String(i);case"ii":return Zn(i,t.length);case"io":return n.ordinalNumber(i,{unit:"day"});case"iii":return n.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(s,{width:"short",context:"formatting"});case"iiii":default:return n.day(s,{width:"wide",context:"formatting"})}},a:function(e,t,n){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,n){const s=e.getHours();let i;switch(s===12?i=mg.noon:s===0?i=mg.midnight:i=s/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,n){const s=e.getHours();let i;switch(s>=17?i=mg.evening:s>=12?i=mg.afternoon:s>=4?i=mg.morning:i=mg.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let s=e.getHours()%12;return s===0&&(s=12),n.ordinalNumber(s,{unit:"hour"})}return rh.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):rh.H(e,t)},K:function(e,t,n){const s=e.getHours()%12;return t==="Ko"?n.ordinalNumber(s,{unit:"hour"}):Zn(s,t.length)},k:function(e,t,n){let s=e.getHours();return s===0&&(s=24),t==="ko"?n.ordinalNumber(s,{unit:"hour"}):Zn(s,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):rh.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):rh.s(e,t)},S:function(e,t){return rh.S(e,t)},X:function(e,t,n){const s=e.getTimezoneOffset();if(s===0)return"Z";switch(t){case"X":return R3(s);case"XXXX":case"XX":return sm(s);case"XXXXX":case"XXX":default:return sm(s,":")}},x:function(e,t,n){const s=e.getTimezoneOffset();switch(t){case"x":return R3(s);case"xxxx":case"xx":return sm(s);case"xxxxx":case"xxx":default:return sm(s,":")}},O:function(e,t,n){const s=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+D3(s,":");case"OOOO":default:return"GMT"+sm(s,":")}},z:function(e,t,n){const s=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+D3(s,":");case"zzzz":default:return"GMT"+sm(s,":")}},t:function(e,t,n){const s=Math.trunc(e.getTime()/1e3);return Zn(s,t.length)},T:function(e,t,n){const s=e.getTime();return Zn(s,t.length)}};function D3(e,t=""){const n=e>0?"-":"+",s=Math.abs(e),i=Math.trunc(s/60),c=s%60;return c===0?n+String(i):n+String(i)+t+Zn(c,2)}function R3(e,t){return e%60===0?(e>0?"-":"+")+Zn(Math.abs(e)/60,2):sm(e,t)}function sm(e,t=""){const n=e>0?"-":"+",s=Math.abs(e),i=Zn(Math.trunc(s/60),2),c=Zn(s%60,2);return n+i+t+c}const L3=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},HU=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},wle=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],s=n[1],i=n[2];if(!i)return L3(e,t);let c;switch(s){case"P":c=t.dateTime({width:"short"});break;case"PP":c=t.dateTime({width:"medium"});break;case"PPP":c=t.dateTime({width:"long"});break;case"PPPP":default:c=t.dateTime({width:"full"});break}return c.replace("{{date}}",L3(s,t)).replace("{{time}}",HU(i,t))},Sle={p:HU,P:wle},Nle=/^D+$/,Ple=/^Y+$/,Cle=["D","DD","YY","YYYY"];function Ale(e){return Nle.test(e)}function kle(e){return Ple.test(e)}function Tle(e,t,n){const s=Ele(e,t,n);if(console.warn(s),Cle.includes(e))throw new RangeError(s)}function Ele(e,t,n){const s=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${s} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Mle=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ole=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ile=/^'([^]*?)'?$/,Dle=/''/g,Rle=/[a-zA-Z]/;function mn(e,t,n){var y,v,j,S;const s=j2(),i=s.locale??yle,c=s.firstWeekContainsDate??((v=(y=s.locale)==null?void 0:y.options)==null?void 0:v.firstWeekContainsDate)??1,u=s.weekStartsOn??((S=(j=s.locale)==null?void 0:j.options)==null?void 0:S.weekStartsOn)??0,a=ys(e);if(!Eoe(a))throw new RangeError("Invalid time value");let m=t.match(Ole).map(k=>{const N=k[0];if(N==="p"||N==="P"){const D=Sle[N];return D(k,i.formatLong)}return k}).join("").match(Mle).map(k=>{if(k==="''")return{isToken:!1,value:"'"};const N=k[0];if(N==="'")return{isToken:!1,value:Lle(k)};if(I3[N])return{isToken:!0,value:k};if(N.match(Rle))throw new RangeError("Format string contains an unescaped latin alphabet character `"+N+"`");return{isToken:!1,value:k}});i.localize.preprocessor&&(m=i.localize.preprocessor(a,m));const p={firstWeekContainsDate:c,weekStartsOn:u,locale:i};return m.map(k=>{if(!k.isToken)return k.value;const N=k.value;(kle(N)||Ale(N))&&Tle(N,t,String(e));const D=I3[N[0]];return D(a,N,i.localize,p)}).join("")}function Lle(e){const t=e.match(Ile);return t?t[1].replace(Dle,"'"):e}function oh(e,t){const s=Ble(e);let i;if(s.date){const m=qle(s.date,2);i=Vle(m.restDateString,m.year)}if(!i||isNaN(i.getTime()))return new Date(NaN);const c=i.getTime();let u=0,a;if(s.time&&(u=Ule(s.time),isNaN(u)))return new Date(NaN);if(s.timezone){if(a=Wle(s.timezone),isNaN(a))return new Date(NaN)}else{const m=new Date(c+u),p=new Date(0);return p.setFullYear(m.getUTCFullYear(),m.getUTCMonth(),m.getUTCDate()),p.setHours(m.getUTCHours(),m.getUTCMinutes(),m.getUTCSeconds(),m.getUTCMilliseconds()),p}return new Date(c+u+a)}const Zw={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Fle=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,zle=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,$le=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Ble(e){const t={},n=e.split(Zw.dateTimeDelimiter);let s;if(n.length>2)return t;if(/:/.test(n[0])?s=n[0]:(t.date=n[0],s=n[1],Zw.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Zw.timeZoneDelimiter)[0],s=e.substr(t.date.length,e.length))),s){const i=Zw.timezone.exec(s);i?(t.time=s.replace(i[1],""),t.timezone=i[1]):t.time=s}return t}function qle(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),s=e.match(n);if(!s)return{year:NaN,restDateString:""};const i=s[1]?parseInt(s[1]):null,c=s[2]?parseInt(s[2]):null;return{year:c===null?i:c*100,restDateString:e.slice((s[1]||s[2]).length)}}function Vle(e,t){if(t===null)return new Date(NaN);const n=e.match(Fle);if(!n)return new Date(NaN);const s=!!n[4],i=v_(n[1]),c=v_(n[2])-1,u=v_(n[3]),a=v_(n[4]),m=v_(n[5])-1;if(s)return Yle(t,a,m)?Gle(t,a,m):new Date(NaN);{const p=new Date(0);return!Hle(t,c,u)||!Zle(t,i)?new Date(NaN):(p.setUTCFullYear(t,c,Math.max(i,u)),p)}}function v_(e){return e?parseInt(e):1}function Ule(e){const t=e.match(zle);if(!t)return NaN;const n=xA(t[1]),s=xA(t[2]),i=xA(t[3]);return Xle(n,s,i)?n*WU+s*UU+i*1e3:NaN}function xA(e){return e&&parseFloat(e.replace(",","."))||0}function Wle(e){if(e==="Z")return 0;const t=e.match($le);if(!t)return 0;const n=t[1]==="+"?-1:1,s=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;return Qle(s,i)?n*(s*WU+i*UU):NaN}function Gle(e,t,n){const s=new Date(0);s.setUTCFullYear(e,0,4);const i=s.getUTCDay()||7,c=(t-1)*7+n+1-i;return s.setUTCDate(s.getUTCDate()+c),s}const Kle=[31,null,31,30,31,30,31,31,30,31,30,31];function ZU(e){return e%400===0||e%4===0&&e%100!==0}function Hle(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(Kle[t]||(ZU(e)?29:28))}function Zle(e,t){return t>=1&&t<=(ZU(e)?366:365)}function Yle(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function Xle(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function Qle(e,t){return t>=0&&t<=59}function Jle(){const[e,t]=R.useState(""),[n,s]=R.useState("all"),[i,c]=R.useState("all"),[u,a]=R.useState("all"),[m,p]=R.useState(null),[y,v]=R.useState(1),{data:j,isLoading:S}=ht({queryKey:["meters",y,e,n,i,u],queryFn:async()=>{const I=new URLSearchParams({page:y.toString(),per_page:"15",...e&&{q:e},...n!=="all"&&{type:n},...i!=="all"&&{status:i},...u!=="all"&&{dma_id:u}}),z=await fetch(`/api/v1/meters?${I}`,{credentials:"include"});return z.ok?z.json():{data:ece(),current_page:1,last_page:1,per_page:15,total:8}}}),{data:k}=ht({queryKey:["dmas-list"],queryFn:async()=>{const I=await fetch("/api/v1/dmas?per_page=100",{credentials:"include"});return I.ok?(await I.json()).data:[]}}),{data:N}=ht({queryKey:["meter-calibration",m==null?void 0:m.id],queryFn:async()=>{if(!m)return[];const I=await fetch(`/api/v1/meters/${m.id}/calibrations`,{credentials:"include"});return I.ok?I.json():tce()},enabled:!!m}),D=I=>{switch(I){case"active":return r.jsxs(We,{className:"bg-green-500",children:[r.jsx(os,{className:"h-3 w-3 mr-1"}),"Active"]});case"faulty":return r.jsxs(We,{className:"bg-red-500",children:[r.jsx(yd,{className:"h-3 w-3 mr-1"}),"Faulty"]});case"decommissioned":return r.jsx(We,{variant:"outline",children:"Decommissioned"});default:return r.jsx(We,{variant:"outline",children:I})}},O=I=>I?new Date(I)<new Date:!1,T=I=>I?Roe(new Date,new Date(I)):null;return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[r.jsx(Gu,{className:"h-8 w-8"}),"Meter Registry"]}),r.jsx("p",{className:"text-muted-foreground",children:"Asset register for bulk and customer meters with calibration tracking"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsx(J,{children:r.jsxs(ge,{className:"pb-3",children:[r.jsx(xr,{children:"Total Meters"}),r.jsx(xe,{className:"text-3xl",children:(j==null?void 0:j.total)||0})]})}),r.jsx(J,{children:r.jsxs(ge,{className:"pb-3",children:[r.jsx(xr,{children:"Active"}),r.jsx(xe,{className:"text-3xl text-green-600",children:(j==null?void 0:j.data.filter(I=>I.status==="active").length)||0})]})}),r.jsx(J,{children:r.jsxs(ge,{className:"pb-3",children:[r.jsx(xr,{children:"Faulty"}),r.jsx(xe,{className:"text-3xl text-red-600",children:(j==null?void 0:j.data.filter(I=>I.status==="faulty").length)||0})]})}),r.jsx(J,{children:r.jsxs(ge,{className:"pb-3",children:[r.jsx(xr,{children:"Calibration Overdue"}),r.jsx(xe,{className:"text-3xl text-orange-600",children:(j==null?void 0:j.data.filter(I=>O(I.calibration_due)).length)||0})]})})]}),r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Search"}),r.jsxs("div",{className:"relative",children:[r.jsx(ci,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Serial number or location...",value:e,onChange:I=>t(I.target.value),className:"pl-10"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Type"}),r.jsxs(Jt,{value:n,onValueChange:s,children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Types"}),r.jsx(ke,{value:"bulk",children:"Bulk Meters"}),r.jsx(ke,{value:"customer",children:"Customer Meters"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Status"}),r.jsxs(Jt,{value:i,onValueChange:c,children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Statuses"}),r.jsx(ke,{value:"active",children:"Active"}),r.jsx(ke,{value:"faulty",children:"Faulty"}),r.jsx(ke,{value:"decommissioned",children:"Decommissioned"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:"DMA"}),r.jsxs(Jt,{value:u,onValueChange:a,children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All DMAs"}),k==null?void 0:k.map(I=>r.jsxs(ke,{value:I.id,children:[I.code," - ",I.name]},I.id))]})]})]})]})})}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx(xe,{children:"Meters"}),r.jsx(xr,{children:"Click a row to view details and calibration history"})]}),r.jsxs(se,{children:[r.jsx(ai,{className:"mr-2 h-4 w-4"}),"Add Meter"]})]})}),r.jsxs(ie,{children:[r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Serial Number"}),r.jsx(le,{children:"Type"}),r.jsx(le,{children:"Location"}),r.jsx(le,{children:"DMA"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Last Calibration"}),r.jsx(le,{children:"Tamper Flags"}),r.jsx(le,{children:"Accuracy"})]})}),r.jsx(ur,{children:S?r.jsx(lt,{children:r.jsx(ne,{colSpan:8,className:"text-center py-8",children:"Loading meters..."})}):(j==null?void 0:j.data.length)===0?r.jsx(lt,{children:r.jsx(ne,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No meters found"})}):j==null?void 0:j.data.map(I=>r.jsxs(lt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>p(I),children:[r.jsx(ne,{className:"font-mono font-medium",children:I.serial_number}),r.jsx(ne,{className:"capitalize",children:I.type}),r.jsx(ne,{children:I.location}),r.jsx(ne,{children:I.dma_name||"N/A"}),r.jsx(ne,{children:D(I.status)}),r.jsx(ne,{children:I.last_calibration?r.jsxs("div",{children:[r.jsx("div",{className:"text-sm",children:mn(new Date(I.last_calibration),"MMM dd, yyyy")}),r.jsxs("div",{className:"text-xs text-muted-foreground",children:[T(I.last_calibration)," months ago"]})]}):r.jsx("span",{className:"text-muted-foreground",children:"Never"})}),r.jsx(ne,{children:I.tamper_flags>0?r.jsxs(We,{variant:"destructive",className:"gap-1",children:[r.jsx(gn,{className:"h-3 w-3"}),I.tamper_flags]}):r.jsx("span",{className:"text-muted-foreground text-sm",children:"None"})}),r.jsx(ne,{children:r.jsxs("span",{className:I.accuracy_rating<95?"text-orange-600 font-medium":"",children:[I.accuracy_rating.toFixed(1),"%"]})})]},I.id))})]}),j&&j.last_page>1&&r.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",(j.current_page-1)*j.per_page+1," to ",Math.min(j.current_page*j.per_page,j.total)," of ",j.total," meters"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:"outline",size:"sm",disabled:y===1,onClick:()=>v(I=>I-1),children:"Previous"}),r.jsx(se,{variant:"outline",size:"sm",disabled:y>=j.last_page,onClick:()=>v(I=>I+1),children:"Next"})]})]})]})]}),r.jsx($U,{open:!!m,onOpenChange:I=>!I&&p(null),children:r.jsx(eI,{className:"w-[600px] sm:max-w-[600px] overflow-y-auto",children:m&&r.jsxs(r.Fragment,{children:[r.jsxs(tI,{children:[r.jsxs(rI,{className:"flex items-center gap-2",children:[r.jsx(Gu,{className:"h-5 w-5"}),m.serial_number]}),r.jsx(nI,{children:m.location})]}),r.jsxs("div",{className:"mt-6 space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Type"}),r.jsx("p",{className:"text-lg capitalize",children:m.type})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),r.jsx("div",{className:"mt-1",children:D(m.status)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"DMA"}),r.jsx("p",{className:"text-lg",children:m.dma_name||"Not assigned"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Install Date"}),r.jsx("p",{className:"text-lg",children:mn(new Date(m.install_date),"MMM dd, yyyy")})]})]}),r.jsxs(J,{className:O(m.calibration_due)?"border-orange-500":"",children:[r.jsx(ge,{className:"pb-3",children:r.jsx(xe,{className:"text-base",children:"Calibration Status"})}),r.jsxs(ie,{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm text-muted-foreground",children:"Last Calibration"}),r.jsx("p",{className:"font-medium",children:m.last_calibration?mn(new Date(m.last_calibration),"MMM dd, yyyy"):"Never calibrated"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm text-muted-foreground",children:"Next Due"}),r.jsx("p",{className:`font-medium ${O(m.calibration_due)?"text-orange-600":""}`,children:m.calibration_due?mn(new Date(m.calibration_due),"MMM dd, yyyy"):"Not scheduled"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm text-muted-foreground",children:"Current Accuracy"}),r.jsxs("p",{className:`text-2xl font-bold ${m.accuracy_rating<95?"text-orange-600":"text-green-600"}`,children:[m.accuracy_rating.toFixed(1),"%"]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm text-muted-foreground",children:"Tamper Flags"}),r.jsx("p",{className:`text-2xl font-bold ${m.tamper_flags>0?"text-red-600":"text-green-600"}`,children:m.tamper_flags})]})]}),O(m.calibration_due)&&r.jsxs("div",{className:"flex items-center gap-2 text-sm text-orange-600 bg-orange-50 p-2 rounded",children:[r.jsx(gn,{className:"h-4 w-4"}),"Calibration overdue - schedule maintenance"]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsx(xe,{className:"text-base",children:"Latest Reading"})}),r.jsx(ie,{children:r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm text-muted-foreground",children:"Reading"}),r.jsxs("p",{className:"text-2xl font-bold",children:[m.last_reading.toLocaleString()," m"]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm text-muted-foreground",children:"Date"}),r.jsx("p",{className:"font-medium",children:mn(new Date(m.last_reading_date),"MMM dd, yyyy HH:mm")})]})]})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-base",children:"Calibration History"})}),r.jsx(ie,{children:N&&N.length>0?r.jsx("div",{className:"space-y-3",children:N.map(I=>r.jsxs("div",{className:"border rounded-lg p-3",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:mn(new Date(I.date),"MMM dd, yyyy")}),r.jsxs("p",{className:"text-sm text-muted-foreground",children:["By ",I.technician]})]}),r.jsx(We,{variant:I.result==="pass"?"default":"destructive",children:I.result})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Before: "}),r.jsxs("span",{className:"font-medium",children:[I.accuracy_before,"%"]})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"After: "}),r.jsxs("span",{className:"font-medium",children:[I.accuracy_after,"%"]})]})]}),I.notes&&r.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:I.notes})]},I.id))}):r.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No calibration history available"})})]}),r.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[r.jsx(se,{className:"flex-1",children:"Schedule Calibration"}),r.jsx(se,{variant:"outline",className:"flex-1",children:"View Full History"})]})]})]})})})]})}function ece(){return[{id:"1",serial_number:"BM-2024-001",type:"bulk",status:"active",location:"Central Treatment Plant - Outlet",dma_name:"Central DMA",install_date:"2023-01-15",last_calibration:"2024-09-10",calibration_due:"2025-03-10",tamper_flags:0,accuracy_rating:98.5,last_reading:145678,last_reading_date:"2025-11-21T08:00:00Z"},{id:"2",serial_number:"BM-2024-002",type:"bulk",status:"active",location:"East Zone Distribution",dma_name:"East DMA",install_date:"2023-03-20",last_calibration:"2024-06-15",calibration_due:"2024-12-15",tamper_flags:1,accuracy_rating:96.2,last_reading:89234,last_reading_date:"2025-11-21T07:55:00Z"},{id:"3",serial_number:"CM-2024-1234",type:"customer",status:"active",location:"123 Main Street",install_date:"2024-01-10",last_calibration:"2024-01-10",calibration_due:"2027-01-10",tamper_flags:0,accuracy_rating:99.1,last_reading:1256,last_reading_date:"2025-11-20T18:00:00Z"},{id:"4",serial_number:"BM-2023-015",type:"bulk",status:"faulty",location:"West Reservoir Inlet",dma_name:"West DMA",install_date:"2022-11-05",last_calibration:"2024-03-20",calibration_due:"2024-09-20",tamper_flags:3,accuracy_rating:87.3,last_reading:234567,last_reading_date:"2025-11-19T14:30:00Z"}]}function tce(){return[{id:"1",date:"2024-09-10",result:"pass",accuracy_before:97.8,accuracy_after:98.5,technician:"John Mwangi",notes:"Routine calibration completed successfully"},{id:"2",date:"2024-03-10",result:"pass",accuracy_before:96.5,accuracy_after:97.8,technician:"Jane Wanjiku",notes:"Minor adjustments made to flow sensor"},{id:"3",date:"2023-09-15",result:"pass",accuracy_before:98.1,accuracy_after:98.3,technician:"Peter Kamau",notes:"All readings within acceptable range"}]}const F3={getAll:e=>me.get("/dmas",e),getById:e=>me.get(`/dmas/${e}`),create:e=>me.post("/dmas",e),update:(e,t)=>me.patch(`/dmas/${e}`,t),delete:e=>me.delete(`/dmas/${e}`)};function rce(){const{user:e,hasPermission:t,hasRole:n}=kO();return{user:e,can:p=>t(p),hasAnyPermission:p=>p.some(y=>t(y)),hasAllPermissions:p=>p.every(y=>t(y)),is:p=>n(p),hasAnyRole:p=>p.some(y=>n(y)),hasAllRoles:p=>p.every(y=>n(y))}}function Qh({permission:e,permissions:t,requireAll:n=!1,role:s,roles:i,requireAllRoles:c=!1,fallback:u=null,children:a}){const{can:m,hasAnyPermission:p,hasAllPermissions:y,is:v,hasAnyRole:j,hasAllRoles:S}=rce();let k=!0;return e?k=m(e):t&&t.length>0&&(k=n?y(t):p(t)),k&&s?k=v(s):k&&i&&i.length>0&&(k=c?S(i):j(i)),k?r.jsx(r.Fragment,{children:a}):r.jsx(r.Fragment,{children:u})}function nce(){const[e,t]=R.useState(!1),[n,s]=R.useState({code:"",name:"",status:"active"}),i=br(),{data:c,isLoading:u,error:a}=ht({queryKey:["dmas"],queryFn:()=>F3.getAll({per_page:50})}),m=jt({mutationFn:v=>F3.create(v),onSuccess:()=>{i.invalidateQueries({queryKey:["dmas"]}),t(!1),s({code:"",name:"",status:"active"}),qe.success("DMA created successfully")},onError:v=>{var j,S;qe.error(((S=(j=v.response)==null?void 0:j.data)==null?void 0:S.message)||"Failed to create DMA")}}),p=v=>{if(v.preventDefault(),!n.code||!n.name){qe.error("Please fill in all required fields");return}m.mutate({code:n.code,name:n.name,status:n.status})},y=async()=>{try{const v=await fetch("/api/v1/gis/dmas/export",{credentials:"include"});if(!v.ok)throw new Error(`HTTP ${v.status}`);const j=await v.blob(),S=window.URL.createObjectURL(j),k=document.createElement("a");k.href=S,k.download=`dmas-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(k),k.click(),window.URL.revokeObjectURL(S),document.body.removeChild(k)}catch(v){console.error("Export failed:",v)}};return r.jsxs("div",{className:"container mx-auto p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"District Metered Areas (DMAs)"}),r.jsx("p",{className:"text-muted-foreground",children:"Manage water distribution network DMAs"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(se,{variant:"outline",onClick:y,children:[r.jsx(rl,{className:"mr-2 h-4 w-4"}),"Export GeoJSON"]}),r.jsx(Qh,{permission:"create dmas",children:r.jsxs(Rr,{open:e,onOpenChange:t,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Create DMA"]})}),r.jsxs(Er,{children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:"Create New DMA"}),r.jsx(Bs,{children:"Add a new District Metered Area to the system"})]}),r.jsxs("form",{onSubmit:p,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"code",children:"Code*"}),r.jsx(Ge,{id:"code",placeholder:"e.g. DMA-001",value:n.code,onChange:v=>s({...n,code:v.target.value}),required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"name",children:"Name*"}),r.jsx(Ge,{id:"name",placeholder:"DMA name",value:n.name,onChange:v=>s({...n,name:v.target.value}),required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"status",children:"Status"}),r.jsxs(Jt,{value:n.status,onValueChange:v=>s({...n,status:v}),children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"active",children:"Active"}),r.jsx(ke,{value:"planned",children:"Planned"}),r.jsx(ke,{value:"inactive",children:"Inactive"})]})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:m.isPending,children:m.isPending?"Creating...":"Create DMA"})]})]})]})]})})]})]}),u&&!c?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading DMAs..."})}):a?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-lg text-red-600 mb-2",children:"Error loading DMAs"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:a.message})]})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c==null?void 0:c.data.map(v=>r.jsxs(J,{className:"hover:shadow-lg transition-shadow",children:[r.jsxs(ge,{children:[r.jsx(xe,{children:v.name}),r.jsxs(xr,{children:["Code: ",v.code]})]}),r.jsx(ie,{children:r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Status:"}),r.jsx("span",{className:`font-medium capitalize ${v.status==="active"?"text-green-600":v.status==="planned"?"text-blue-600":"text-gray-600"}`,children:v.status})]}),v.nightline_threshold_m3h&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Nightline:"}),r.jsxs("span",{className:"font-medium",children:[v.nightline_threshold_m3h," m/h"]})]}),v.pressure_target_bar&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Pressure:"}),r.jsxs("span",{className:"font-medium",children:[v.pressure_target_bar," bar"]})]}),v.scheme&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Scheme:"}),r.jsx("span",{className:"font-medium text-xs",children:v.scheme.name})]})]})})]},v.id))}),(c==null?void 0:c.data.length)===0&&r.jsx(J,{children:r.jsxs(ie,{className:"flex flex-col items-center justify-center p-12",children:[r.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No DMAs found"}),r.jsx(Qh,{permission:"create dmas",children:r.jsx(se,{children:"Create Your First DMA"})})]})})]})]})}const z3={getAll:e=>me.get("/pipelines",e),getById:e=>me.get(`/pipelines/${e}`),create:e=>me.post("/pipelines",e),update:(e,t)=>me.patch(`/pipelines/${e}`,t),delete:e=>me.delete(`/pipelines/${e}`)};function sce(){const[e,t]=R.useState(!1),[n,s]=R.useState({code:"",material:"uPVC",diameter_mm:"50",status:"active"}),i=br(),{data:c,isLoading:u,error:a}=ht({queryKey:["pipelines"],queryFn:()=>z3.getAll({per_page:50})}),m=jt({mutationFn:y=>z3.create(y),onSuccess:()=>{i.invalidateQueries({queryKey:["pipelines"]}),t(!1),s({code:"",material:"PVC",diameter_mm:"50",status:"active"}),qe.success("Pipeline created successfully")},onError:y=>{var v,j;qe.error(((j=(v=y.response)==null?void 0:v.data)==null?void 0:j.message)||"Failed to create pipeline")}}),p=y=>{if(y.preventDefault(),!n.code||!n.material||!n.diameter_mm){qe.error("Please fill in all required fields");return}m.mutate({code:n.code,material:n.material,diameter_mm:parseInt(n.diameter_mm),status:n.status})};return r.jsxs("div",{className:"container mx-auto p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Pipelines"}),r.jsx("p",{className:"text-muted-foreground",children:"Manage water distribution pipelines"})]}),r.jsx(Qh,{permission:"create pipelines",children:r.jsxs(Rr,{open:e,onOpenChange:t,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Create Pipeline"]})}),r.jsxs(Er,{children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:"Create New Pipeline"}),r.jsx(Bs,{children:"Add a new water distribution pipeline"})]}),r.jsxs("form",{onSubmit:p,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"code",children:"Code*"}),r.jsx(Ge,{id:"code",placeholder:"e.g. PIPE-001",value:n.code,onChange:y=>s({...n,code:y.target.value}),required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"material",children:"Material*"}),r.jsxs(Jt,{value:n.material,onValueChange:y=>s({...n,material:y}),children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"uPVC",children:"uPVC"}),r.jsx(ke,{value:"HDPE",children:"HDPE"}),r.jsx(ke,{value:"Steel",children:"Steel"}),r.jsx(ke,{value:"DI",children:"DI"}),r.jsx(ke,{value:"AC",children:"AC"}),r.jsx(ke,{value:"GI",children:"GI"}),r.jsx(ke,{value:"Other",children:"Other"})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"diameter_mm",children:"Diameter (mm)*"}),r.jsx(Ge,{id:"diameter_mm",type:"number",placeholder:"50",value:n.diameter_mm,onChange:y=>s({...n,diameter_mm:y.target.value}),required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"status",children:"Status"}),r.jsxs(Jt,{value:n.status,onValueChange:y=>s({...n,status:y}),children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"active",children:"Active"}),r.jsx(ke,{value:"leak",children:"Leak"}),r.jsx(ke,{value:"rehab",children:"Rehab"})]})]})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:m.isPending,children:m.isPending?"Creating...":"Create Pipeline"})]})]})]})]})})]}),u&&!c?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading pipelines..."})}):a?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-lg text-red-600 mb-2",children:"Error loading pipelines"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:a.message})]})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c==null?void 0:c.data.map(y=>r.jsxs(J,{className:"hover:shadow-lg transition-shadow",children:[r.jsxs(ge,{children:[r.jsx(xe,{children:y.code}),r.jsx(xr,{children:y.material})]}),r.jsx(ie,{children:r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Diameter:"}),r.jsxs("span",{className:"font-medium",children:[y.diameter_mm," mm"]})]}),y.install_year&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Installed:"}),r.jsx("span",{className:"font-medium",children:y.install_year})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Status:"}),r.jsx("span",{className:`font-medium capitalize ${y.status==="active"?"text-green-600":y.status==="leak"?"text-red-600":y.status==="rehab"?"text-yellow-600":"text-gray-600"}`,children:y.status})]}),y.scheme&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Scheme:"}),r.jsx("span",{className:"font-medium text-xs",children:y.scheme.name})]})]})})]},y.id))}),(c==null?void 0:c.data.length)===0&&r.jsx(J,{children:r.jsxs(ie,{className:"flex flex-col items-center justify-center p-12",children:[r.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No pipelines found"}),r.jsx(Qh,{permission:"create pipelines",children:r.jsx(se,{children:"Create Your First Pipeline"})})]})})]})]})}const $3={getAll:e=>me.get("/zones",e),getById:e=>me.get(`/zones/${e}`),create:e=>me.post("/zones",e),update:(e,t)=>me.patch(`/zones/${e}`,t),delete:e=>me.delete(`/zones/${e}`)};function ice(){const[e,t]=R.useState(!1),[n,s]=R.useState({code:"",name:"",type:"billing"}),i=br(),{data:c,isLoading:u,error:a}=ht({queryKey:["zones"],queryFn:()=>$3.getAll({per_page:50})}),m=jt({mutationFn:y=>$3.create(y),onSuccess:()=>{i.invalidateQueries({queryKey:["zones"]}),t(!1),s({code:"",name:"",type:"billing"}),qe.success("Zone created successfully")},onError:y=>{var v,j;qe.error(((j=(v=y.response)==null?void 0:v.data)==null?void 0:j.message)||"Failed to create zone")}}),p=y=>{if(y.preventDefault(),!n.code||!n.name){qe.error("Please fill in all required fields");return}m.mutate(n)};return r.jsxs("div",{className:"container mx-auto p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Zones"}),r.jsx("p",{className:"text-muted-foreground",children:"Manage geographical zones"})]}),r.jsx(Qh,{permission:"create zones",children:r.jsxs(Rr,{open:e,onOpenChange:t,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Create Zone"]})}),r.jsxs(Er,{children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:"Create New Zone"}),r.jsx(Bs,{children:"Add a new geographical zone"})]}),r.jsxs("form",{onSubmit:p,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"code",children:"Code*"}),r.jsx(Ge,{id:"code",placeholder:"e.g. Z-001",value:n.code,onChange:y=>s({...n,code:y.target.value}),required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"type",children:"Type*"}),r.jsxs(Jt,{value:n.type,onValueChange:y=>s({...n,type:y}),children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"billing",children:"Billing"}),r.jsx(ke,{value:"service",children:"Service"}),r.jsx(ke,{value:"operational",children:"Operational"})]})]})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"name",children:"Name*"}),r.jsx(Ge,{id:"name",placeholder:"Zone name",value:n.name,onChange:y=>s({...n,name:y.target.value}),required:!0})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:m.isPending,children:m.isPending?"Creating...":"Create Zone"})]})]})]})]})})]}),u&&!c?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading zones..."})}):a?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-lg text-red-600 mb-2",children:"Error loading zones"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:a.message})]})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c==null?void 0:c.data.map(y=>r.jsxs(J,{className:"hover:shadow-lg transition-shadow",children:[r.jsxs(ge,{children:[r.jsx(xe,{children:y.name}),r.jsxs(xr,{children:["Code: ",y.code]})]}),r.jsx(ie,{children:r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Type:"}),r.jsx("span",{className:"font-medium capitalize",children:y.type})]}),y.scheme&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Scheme:"}),r.jsx("span",{className:"font-medium text-xs",children:y.scheme.name})]})]})})]},y.id))}),(c==null?void 0:c.data.length)===0&&r.jsx(J,{children:r.jsxs(ie,{className:"flex flex-col items-center justify-center p-12",children:[r.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No zones found"}),r.jsx(Qh,{permission:"create zones",children:r.jsx(se,{children:"Create Your First Zone"})})]})})]})]})}const B3={getAll:e=>me.get("/addresses",e),getById:e=>me.get(`/addresses/${e}`),create:e=>me.post("/addresses",e),update:(e,t)=>me.patch(`/addresses/${e}`,t),delete:e=>me.delete(`/addresses/${e}`)};function ace(){const[e,t]=R.useState(!1),[n,s]=R.useState({premise_code:"",street:"",village:"",ward:"",city:"",country:"KE"}),i=br(),{data:c,isLoading:u,error:a}=ht({queryKey:["addresses"],queryFn:()=>B3.getAll({per_page:50})}),m=jt({mutationFn:y=>B3.create(y),onSuccess:()=>{i.invalidateQueries({queryKey:["addresses"]}),t(!1),s({premise_code:"",street:"",village:"",ward:"",city:"",country:"KE"}),qe.success("Address created successfully")},onError:y=>{var v,j;qe.error(((j=(v=y.response)==null?void 0:v.data)==null?void 0:j.message)||"Failed to create address")}}),p=y=>{if(y.preventDefault(),!n.premise_code){qe.error("Please fill in the premise code");return}m.mutate(n)};return r.jsxs("div",{className:"container mx-auto p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Addresses"}),r.jsx("p",{className:"text-muted-foreground",children:"Manage customer premises addresses"})]}),r.jsx(Qh,{permission:"create addresses",children:r.jsxs(Rr,{open:e,onOpenChange:t,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Create Address"]})}),r.jsxs(Er,{className:"max-w-2xl",children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:"Create New Address"}),r.jsx(Bs,{children:"Add a new customer premise address"})]}),r.jsxs("form",{onSubmit:p,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"premise_code",children:"Premise Code*"}),r.jsx(Ge,{id:"premise_code",placeholder:"e.g. PREM-001",value:n.premise_code,onChange:y=>s({...n,premise_code:y.target.value}),required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"country",children:"Country"}),r.jsx(Ge,{id:"country",placeholder:"KE",value:n.country,onChange:y=>s({...n,country:y.target.value})})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"street",children:"Street"}),r.jsx(Ge,{id:"street",placeholder:"Street address",value:n.street,onChange:y=>s({...n,street:y.target.value})})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"village",children:"Village"}),r.jsx(Ge,{id:"village",placeholder:"Village",value:n.village,onChange:y=>s({...n,village:y.target.value})})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"ward",children:"Ward"}),r.jsx(Ge,{id:"ward",placeholder:"Ward",value:n.ward,onChange:y=>s({...n,ward:y.target.value})})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"city",children:"City"}),r.jsx(Ge,{id:"city",placeholder:"City",value:n.city,onChange:y=>s({...n,city:y.target.value})})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:m.isPending,children:m.isPending?"Creating...":"Create Address"})]})]})]})]})})]}),u&&!c?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading addresses..."})}):a?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-lg text-red-600 mb-2",children:"Error loading addresses"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:a.message})]})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c==null?void 0:c.data.map(y=>r.jsxs(J,{className:"hover:shadow-lg transition-shadow",children:[r.jsxs(ge,{children:[r.jsx(xe,{children:y.premise_code}),r.jsx(xr,{children:[y.street,y.village].filter(Boolean).join(", ")||"No address details"})]}),r.jsx(ie,{children:r.jsxs("div",{className:"space-y-2 text-sm",children:[y.ward&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Ward:"}),r.jsx("span",{className:"font-medium",children:y.ward})]}),y.subcounty&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Subcounty:"}),r.jsx("span",{className:"font-medium",children:y.subcounty})]}),y.city&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"City:"}),r.jsx("span",{className:"font-medium",children:y.city})]}),y.what3words&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"What3Words:"}),r.jsx("span",{className:"font-medium text-xs",children:y.what3words})]}),y.scheme&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Scheme:"}),r.jsx("span",{className:"font-medium text-xs",children:y.scheme.name})]})]})})]},y.id))}),(c==null?void 0:c.data.length)===0&&r.jsx(J,{children:r.jsxs(ie,{className:"flex flex-col items-center justify-center p-12",children:[r.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No addresses found"}),r.jsx(Qh,{permission:"create addresses",children:r.jsx(se,{children:"Create Your First Address"})})]})})]})]})}var sI="Switch",[oce]=bd(sI),[lce,cce]=oce(sI),YU=R.forwardRef((e,t)=>{const{__scopeSwitch:n,name:s,checked:i,defaultChecked:c,required:u,disabled:a,value:m="on",onCheckedChange:p,form:y,...v}=e,[j,S]=R.useState(null),k=yn(t,I=>S(I)),N=R.useRef(!1),D=j?y||!!j.closest("form"):!0,[O=!1,T]=ud({prop:i,defaultProp:c,onChange:p});return r.jsxs(lce,{scope:n,checked:O,disabled:a,children:[r.jsx(zr.button,{type:"button",role:"switch","aria-checked":O,"aria-required":u,"data-state":JU(O),"data-disabled":a?"":void 0,disabled:a,value:m,...v,ref:k,onClick:nr(e.onClick,I=>{T(z=>!z),D&&(N.current=I.isPropagationStopped(),N.current||I.stopPropagation())})}),D&&r.jsx(uce,{control:j,bubbles:!N.current,name:s,value:m,checked:O,required:u,disabled:a,form:y,style:{transform:"translateX(-100%)"}})]})});YU.displayName=sI;var XU="SwitchThumb",QU=R.forwardRef((e,t)=>{const{__scopeSwitch:n,...s}=e,i=cce(XU,n);return r.jsx(zr.span,{"data-state":JU(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:t})});QU.displayName=XU;var uce=e=>{const{control:t,checked:n,bubbles:s=!0,...i}=e,c=R.useRef(null),u=h2(n),a=c2(t);return R.useEffect(()=>{const m=c.current,p=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(p,"checked").set;if(u!==n&&v){const j=new Event("click",{bubbles:s});v.call(m,n),m.dispatchEvent(j)}},[u,n,s]),r.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...i,tabIndex:-1,ref:c,style:{...e.style,...a,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function JU(e){return e?"checked":"unchecked"}var e9=YU,dce=QU;const Ay=R.forwardRef(({className:e,...t},n)=>r.jsx(e9,{className:wr("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:n,children:r.jsx(dce,{className:wr("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));Ay.displayName=e9.displayName;var hce="Separator",q3="horizontal",fce=["horizontal","vertical"],t9=R.forwardRef((e,t)=>{const{decorative:n,orientation:s=q3,...i}=e,c=mce(s)?s:q3,a=n?{role:"none"}:{"aria-orientation":c==="vertical"?c:void 0,role:"separator"};return r.jsx(zr.div,{"data-orientation":c,...a,...i,ref:t})});t9.displayName=hce;function mce(e){return fce.includes(e)}var r9=t9;const DT=R.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...s},i)=>r.jsx(r9,{ref:i,decorative:n,orientation:t,className:wr("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...s}));DT.displayName=r9.displayName;var n9=["PageUp","PageDown"],s9=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],i9={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},ky="Slider",[RT,pce,gce]=n2(ky),[a9]=bd(ky,[gce]),[xce,w2]=a9(ky),o9=R.forwardRef((e,t)=>{const{name:n,min:s=0,max:i=100,step:c=1,orientation:u="horizontal",disabled:a=!1,minStepsBetweenThumbs:m=0,defaultValue:p=[s],value:y,onValueChange:v=()=>{},onValueCommit:j=()=>{},inverted:S=!1,form:k,...N}=e,D=R.useRef(new Set),O=R.useRef(0),I=u==="horizontal"?yce:vce,[z=[],$]=ud({prop:y,defaultProp:p,onChange:ae=>{var Oe;(Oe=[...D.current][O.current])==null||Oe.focus(),v(ae)}}),V=R.useRef(z);function K(ae){const pe=Sce(z,ae);ve(ae,pe)}function te(ae){ve(ae,O.current)}function X(){const ae=V.current[O.current];z[O.current]!==ae&&j(z)}function ve(ae,pe,{commit:Oe}={commit:!1}){const Me=Ace(c),Xe=kce(Math.round((ae-s)/c)*c+s,Me),Ve=E0(Xe,[s,i]);$((et=[])=>{const Ce=jce(et,Ve,pe);if(Cce(Ce,m*c)){O.current=Ce.indexOf(Ve);const _e=String(Ce)!==String(et);return _e&&Oe&&j(Ce),_e?Ce:et}else return et})}return r.jsx(xce,{scope:e.__scopeSlider,name:n,disabled:a,min:s,max:i,valueIndexToChangeRef:O,thumbs:D.current,values:z,orientation:u,form:k,children:r.jsx(RT.Provider,{scope:e.__scopeSlider,children:r.jsx(RT.Slot,{scope:e.__scopeSlider,children:r.jsx(I,{"aria-disabled":a,"data-disabled":a?"":void 0,...N,ref:t,onPointerDown:nr(N.onPointerDown,()=>{a||(V.current=z)}),min:s,max:i,inverted:S,onSlideStart:a?void 0:K,onSlideMove:a?void 0:te,onSlideEnd:a?void 0:X,onHomeKeyDown:()=>!a&&ve(s,0,{commit:!0}),onEndKeyDown:()=>!a&&ve(i,z.length-1,{commit:!0}),onStepKeyDown:({event:ae,direction:pe})=>{if(!a){const Xe=n9.includes(ae.key)||ae.shiftKey&&s9.includes(ae.key)?10:1,Ve=O.current,et=z[Ve],Ce=c*Xe*pe;ve(et+Ce,Ve,{commit:!0})}}})})})})});o9.displayName=ky;var[l9,c9]=a9(ky,{startEdge:"left",endEdge:"right",size:"width",direction:1}),yce=R.forwardRef((e,t)=>{const{min:n,max:s,dir:i,inverted:c,onSlideStart:u,onSlideMove:a,onSlideEnd:m,onStepKeyDown:p,...y}=e,[v,j]=R.useState(null),S=yn(t,I=>j(I)),k=R.useRef(),N=Sy(i),D=N==="ltr",O=D&&!c||!D&&c;function T(I){const z=k.current||v.getBoundingClientRect(),$=[0,z.width],K=iI($,O?[n,s]:[s,n]);return k.current=z,K(I-z.left)}return r.jsx(l9,{scope:e.__scopeSlider,startEdge:O?"left":"right",endEdge:O?"right":"left",direction:O?1:-1,size:"width",children:r.jsx(u9,{dir:N,"data-orientation":"horizontal",...y,ref:S,style:{...y.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:I=>{const z=T(I.clientX);u==null||u(z)},onSlideMove:I=>{const z=T(I.clientX);a==null||a(z)},onSlideEnd:()=>{k.current=void 0,m==null||m()},onStepKeyDown:I=>{const $=i9[O?"from-left":"from-right"].includes(I.key);p==null||p({event:I,direction:$?-1:1})}})})}),vce=R.forwardRef((e,t)=>{const{min:n,max:s,inverted:i,onSlideStart:c,onSlideMove:u,onSlideEnd:a,onStepKeyDown:m,...p}=e,y=R.useRef(null),v=yn(t,y),j=R.useRef(),S=!i;function k(N){const D=j.current||y.current.getBoundingClientRect(),O=[0,D.height],I=iI(O,S?[s,n]:[n,s]);return j.current=D,I(N-D.top)}return r.jsx(l9,{scope:e.__scopeSlider,startEdge:S?"bottom":"top",endEdge:S?"top":"bottom",size:"height",direction:S?1:-1,children:r.jsx(u9,{"data-orientation":"vertical",...p,ref:v,style:{...p.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:N=>{const D=k(N.clientY);c==null||c(D)},onSlideMove:N=>{const D=k(N.clientY);u==null||u(D)},onSlideEnd:()=>{j.current=void 0,a==null||a()},onStepKeyDown:N=>{const O=i9[S?"from-bottom":"from-top"].includes(N.key);m==null||m({event:N,direction:O?-1:1})}})})}),u9=R.forwardRef((e,t)=>{const{__scopeSlider:n,onSlideStart:s,onSlideMove:i,onSlideEnd:c,onHomeKeyDown:u,onEndKeyDown:a,onStepKeyDown:m,...p}=e,y=w2(ky,n);return r.jsx(zr.span,{...p,ref:t,onKeyDown:nr(e.onKeyDown,v=>{v.key==="Home"?(u(v),v.preventDefault()):v.key==="End"?(a(v),v.preventDefault()):n9.concat(s9).includes(v.key)&&(m(v),v.preventDefault())}),onPointerDown:nr(e.onPointerDown,v=>{const j=v.target;j.setPointerCapture(v.pointerId),v.preventDefault(),y.thumbs.has(j)?j.focus():s(v)}),onPointerMove:nr(e.onPointerMove,v=>{v.target.hasPointerCapture(v.pointerId)&&i(v)}),onPointerUp:nr(e.onPointerUp,v=>{const j=v.target;j.hasPointerCapture(v.pointerId)&&(j.releasePointerCapture(v.pointerId),c(v))})})}),d9="SliderTrack",h9=R.forwardRef((e,t)=>{const{__scopeSlider:n,...s}=e,i=w2(d9,n);return r.jsx(zr.span,{"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation,...s,ref:t})});h9.displayName=d9;var LT="SliderRange",f9=R.forwardRef((e,t)=>{const{__scopeSlider:n,...s}=e,i=w2(LT,n),c=c9(LT,n),u=R.useRef(null),a=yn(t,u),m=i.values.length,p=i.values.map(j=>p9(j,i.min,i.max)),y=m>1?Math.min(...p):0,v=100-Math.max(...p);return r.jsx(zr.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...s,ref:a,style:{...e.style,[c.startEdge]:y+"%",[c.endEdge]:v+"%"}})});f9.displayName=LT;var FT="SliderThumb",m9=R.forwardRef((e,t)=>{const n=pce(e.__scopeSlider),[s,i]=R.useState(null),c=yn(t,a=>i(a)),u=R.useMemo(()=>s?n().findIndex(a=>a.ref.current===s):-1,[n,s]);return r.jsx(_ce,{...e,ref:c,index:u})}),_ce=R.forwardRef((e,t)=>{const{__scopeSlider:n,index:s,name:i,...c}=e,u=w2(FT,n),a=c9(FT,n),[m,p]=R.useState(null),y=yn(t,T=>p(T)),v=m?u.form||!!m.closest("form"):!0,j=c2(m),S=u.values[s],k=S===void 0?0:p9(S,u.min,u.max),N=wce(s,u.values.length),D=j==null?void 0:j[a.size],O=D?Nce(D,k,a.direction):0;return R.useEffect(()=>{if(m)return u.thumbs.add(m),()=>{u.thumbs.delete(m)}},[m,u.thumbs]),r.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${k}% + ${O}px)`},children:[r.jsx(RT.ItemSlot,{scope:e.__scopeSlider,children:r.jsx(zr.span,{role:"slider","aria-label":e["aria-label"]||N,"aria-valuemin":u.min,"aria-valuenow":S,"aria-valuemax":u.max,"aria-orientation":u.orientation,"data-orientation":u.orientation,"data-disabled":u.disabled?"":void 0,tabIndex:u.disabled?void 0:0,...c,ref:y,style:S===void 0?{display:"none"}:e.style,onFocus:nr(e.onFocus,()=>{u.valueIndexToChangeRef.current=s})})}),v&&r.jsx(bce,{name:i??(u.name?u.name+(u.values.length>1?"[]":""):void 0),form:u.form,value:S},s)]})});m9.displayName=FT;var bce=e=>{const{value:t,...n}=e,s=R.useRef(null),i=h2(t);return R.useEffect(()=>{const c=s.current,u=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(u,"value").set;if(i!==t&&m){const p=new Event("input",{bubbles:!0});m.call(c,t),c.dispatchEvent(p)}},[i,t]),r.jsx("input",{style:{display:"none"},...n,ref:s,defaultValue:t})};function jce(e=[],t,n){const s=[...e];return s[n]=t,s.sort((i,c)=>i-c)}function p9(e,t,n){const c=100/(n-t)*(e-t);return E0(c,[0,100])}function wce(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function Sce(e,t){if(e.length===1)return 0;const n=e.map(i=>Math.abs(i-t)),s=Math.min(...n);return n.indexOf(s)}function Nce(e,t,n){const s=e/2,c=iI([0,50],[0,s]);return(s-c(t)*n)*n}function Pce(e){return e.slice(0,-1).map((t,n)=>e[n+1]-t)}function Cce(e,t){if(t>0){const n=Pce(e);return Math.min(...n)>=t}return!0}function iI(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const s=(t[1]-t[0])/(e[1]-e[0]);return t[0]+s*(n-e[0])}}function Ace(e){return(String(e).split(".")[1]||"").length}function kce(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}var g9=o9,Tce=h9,Ece=f9,Mce=m9;const Vm=R.forwardRef(({className:e,...t},n)=>r.jsxs(g9,{ref:n,className:wr("relative flex w-full touch-none select-none items-center",e),...t,children:[r.jsx(Tce,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:r.jsx(Ece,{className:"absolute h-full bg-primary"})}),r.jsx(Mce,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));Vm.displayName=g9.displayName;const Oce=[{id:"schemes",name:"Water Supply Schemes",category:"coverage",icon:"",defaultVisible:!0},{id:"dmas",name:"District Metered Areas",category:"coverage",icon:"",defaultVisible:!0},{id:"facilities",name:"Facilities",category:"infrastructure",icon:"",defaultVisible:!0},{id:"pipelines",name:"Pipelines",category:"network",icon:"",defaultVisible:!0},{id:"network-nodes",name:"Network Nodes",category:"network",icon:"",defaultVisible:!1}];function Ice({enabledLayers:e,onLayerToggle:t,onStatusFilterChange:n,onCategoryFilterChange:s,onOpacityChange:i,className:c=""}){const[u,a]=R.useState("all"),[m,p]=R.useState("all"),[y,v]=R.useState([80]),j=T=>{a(T),n==null||n(T)},S=T=>{p(T),s==null||s(T)},k=T=>{v(T),i==null||i(T[0])},N=Oce.filter(T=>!(m!=="all"&&T.category!==m)),D=[{value:"all",label:"All Categories"},{value:"coverage",label:"Coverage Areas"},{value:"infrastructure",label:"Infrastructure"},{value:"network",label:"Network"}],O=[{value:"all",label:"All Status"},{value:"active",label:"Active"},{value:"planned",label:"Planned"},{value:"maintenance",label:"Maintenance"},{value:"decommissioned",label:"Decommissioned"}];return r.jsxs(J,{className:`w-80 bg-white/95 dark:bg-gray-900/95 backdrop-blur ${c}`,children:[r.jsx(ge,{className:"pb-3",children:r.jsxs(xe,{className:"text-base flex items-center gap-2",children:[r.jsx("span",{children:"Network Layers"}),r.jsxs(We,{variant:"outline",className:"text-xs font-normal",children:[e.size," active"]})]})}),r.jsxs(ie,{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{className:"text-xs text-gray-600 dark:text-gray-400",children:"Category Filter"}),r.jsxs(Jt,{value:m,onValueChange:S,children:[r.jsx(Yt,{className:"h-8",children:r.jsx(er,{})}),r.jsx(Xt,{children:D.map(T=>r.jsx(ke,{value:T.value,children:T.label},T.value))})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{className:"text-xs text-gray-600 dark:text-gray-400",children:"Status Filter"}),r.jsxs(Jt,{value:u,onValueChange:j,children:[r.jsx(Yt,{className:"h-8",children:r.jsx(er,{})}),r.jsx(Xt,{children:O.map(T=>r.jsx(ke,{value:T.value,children:T.label},T.value))})]})]}),r.jsx(DT,{}),r.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:N.map(T=>r.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800 transition",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[r.jsx("span",{className:"text-lg",children:T.icon}),r.jsxs("div",{className:"flex-1",children:[r.jsx(Ne,{htmlFor:`layer-${T.id}`,className:"text-sm cursor-pointer text-gray-700 dark:text-gray-300",children:T.name}),r.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize",children:T.category})]})]}),r.jsx(Ay,{id:`layer-${T.id}`,checked:e.has(T.id),onCheckedChange:()=>t(T.id)})]},T.id))}),r.jsx(DT,{}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(Ne,{className:"text-xs text-gray-600 dark:text-gray-400",children:"Layer Opacity"}),r.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[y[0],"%"]})]}),r.jsx(Vm,{value:y,onValueChange:k,min:0,max:100,step:10,className:"w-full"})]}),r.jsxs("div",{className:"pt-2 text-xs text-gray-500 dark:text-gray-400",children:[r.jsx("p",{className:"font-semibold mb-1",children:"Legend"}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded bg-green-500"}),r.jsx("span",{children:"Active"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded bg-blue-500"}),r.jsx("span",{children:"Planned"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded bg-amber-500"}),r.jsx("span",{children:"Maintenance"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded bg-gray-400"}),r.jsx("span",{children:"Decommissioned"})]})]})]})]})]})}const yA=[{id:"positron",name:"Light",url:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json"},{id:"dark-matter",name:"Dark",url:"https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json"},{id:"voyager",name:"Voyager",url:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json"},{id:"osm",name:"OpenStreetMap",url:"https://tiles.openfreemap.org/styles/liberty"}],vA=[{id:"schemes",name:"Water Supply Schemes",category:"coverage",tileUrl:"/api/v1/gis/tiles/schemes/{z}/{x}/{y}.mvt",sourceLayer:"schemes",type:"fill",minZoom:0,maxZoom:22,paint:{"fill-color":["match",["get","status"],"active","#22c55e","planning","#3b82f6","decommissioned","#94a3b8","#6b7280"],"fill-opacity":.6,"fill-outline-color":"#000000"}},{id:"dmas",name:"District Metered Areas",category:"coverage",tileUrl:"/api/v1/gis/tiles/dmas/{z}/{x}/{y}.mvt",sourceLayer:"dmas",type:"fill",minZoom:0,maxZoom:22,paint:{"fill-color":["match",["get","status"],"active","#8b5cf6","planned","#06b6d4","retired","#94a3b8","#6b7280"],"fill-opacity":.5,"fill-outline-color":"#000000"}},{id:"facilities",name:"Facilities",category:"infrastructure",tileUrl:"/api/v1/gis/tiles/facilities/{z}/{x}/{y}.mvt",sourceLayer:"facilities",type:"circle",minZoom:8,maxZoom:22,paint:{"circle-radius":6,"circle-color":["match",["get","category"],"source","#10b981","treatment","#3b82f6","pumpstation","#f59e0b","reservoir","#06b6d4","#6b7280"],"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}},{id:"pipelines",name:"Pipelines",category:"network",tileUrl:"/api/v1/gis/tiles/pipelines/{z}/{x}/{y}.mvt",sourceLayer:"pipelines",type:"line",minZoom:12,maxZoom:22,paint:{"line-color":["match",["get","status"],"active","#3b82f6","leak","#ef4444","rehab","#f59e0b","abandoned","#94a3b8","#6b7280"],"line-width":["interpolate",["linear"],["zoom"],12,1,16,3,20,6],"line-opacity":.8}},{id:"network-nodes",name:"Network Nodes",category:"network",tileUrl:"/api/v1/gis/tiles/network-nodes/{z}/{x}/{y}.mvt",sourceLayer:"network_nodes",type:"circle",minZoom:14,maxZoom:22,paint:{"circle-radius":["interpolate",["linear"],["zoom"],14,2,18,4,22,8],"circle-color":["match",["get","type"],"source","#10b981","wtp","#3b82f6","reservoir","#06b6d4","junction","#fbbf24","valve","#8b5cf6","pump","#f59e0b","#6b7280"],"circle-stroke-width":1,"circle-stroke-color":"#ffffff"}}];function x9({className:e}){const[t,n]=R.useState({longitude:36.8219,latitude:-1.2921,zoom:8}),[s,i]=R.useState("positron"),[c,u]=R.useState(new Set(["schemes","dmas","facilities","pipelines"])),[a,m]=R.useState(!1),[p,y]=R.useState(80),[v,j]=R.useState("all"),[S,k]=R.useState("all"),N=R.useCallback(T=>{u(I=>{const z=new Set(I);return z.has(T)?z.delete(T):z.add(T),z})},[]),D=R.useCallback(T=>{if(k(T),T==="all")u(new Set(["schemes","dmas","facilities","pipelines"]));else{const I=vA.filter(z=>z.category===T).map(z=>z.id);u(new Set(I))}},[]),O=yA.find(T=>T.id===s)||yA[0];return r.jsxs("div",{className:`relative w-full h-full ${e||""}`,children:[r.jsxs(Ob,{...t,onMove:T=>n(T.viewState),mapStyle:O.url,style:{width:"100%",height:"100%"},children:[r.jsx(Ib,{position:"top-right"}),r.jsx(Db,{position:"bottom-left"}),r.jsx(kne,{position:"top-right"}),vA.map(T=>{if(!c.has(T.id)||S!=="all"&&T.category!==S)return null;const I={...T.paint};return T.type==="fill"?I["fill-opacity"]=(T.paint["fill-opacity"]||.6)*(p/100):T.type==="circle"?I["circle-opacity"]=p/100:T.type==="line"&&(I["line-opacity"]=(T.paint["line-opacity"]||.8)*(p/100)),r.jsx(T0,{id:T.id,type:"vector",tiles:[T.tileUrl],minzoom:T.minZoom,maxzoom:T.maxZoom,children:r.jsx(Tx,{id:T.id,"source-layer":T.sourceLayer,type:T.type,paint:I,filter:v!=="all"?["==",["get","status"],v]:void 0})},T.id)})]}),r.jsx(J,{className:"absolute top-4 left-4 w-64 bg-white/95 dark:bg-gray-900/95 backdrop-blur",children:r.jsxs(ie,{className:"p-4",children:[r.jsx("h3",{className:"font-semibold mb-3 text-gray-900 dark:text-gray-100",children:"Map Controls"}),r.jsxs("div",{className:"mb-4",children:[r.jsx(Ne,{className:"text-sm mb-2 block text-gray-700 dark:text-gray-300",children:"Basemap"}),r.jsxs(Jt,{value:s,onValueChange:i,children:[r.jsx(Yt,{className:"w-full",children:r.jsx(er,{})}),r.jsx(Xt,{children:yA.map(T=>r.jsx(ke,{value:T.id,children:T.name},T.id))})]})]}),r.jsxs(se,{variant:"outline",className:"w-full",onClick:()=>m(!a),children:[r.jsx(Xq,{className:"w-4 h-4 mr-2"}),a?"Hide":"Show"," Network Layers"]}),r.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200 dark:border-gray-700",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("h4",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400",children:"Quick Layers"}),r.jsx(We,{variant:"outline",className:"text-xs",children:"Vector Tiles"})]}),r.jsx("div",{className:"space-y-2",children:vA.slice(0,3).map(T=>r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(Ne,{htmlFor:`quick-layer-${T.id}`,className:"text-xs cursor-pointer text-gray-700 dark:text-gray-300",children:T.name}),r.jsx(Ay,{id:`quick-layer-${T.id}`,checked:c.has(T.id),onCheckedChange:()=>N(T.id)})]},T.id))})]})]})}),a&&r.jsx(Ice,{enabledLayers:c,onLayerToggle:N,onStatusFilterChange:j,onCategoryFilterChange:D,onOpacityChange:y,className:"absolute top-4 left-72"})]})}function Dce(){return r.jsx("div",{className:"h-screen w-full flex flex-col",children:r.jsx("div",{className:"flex-1",children:r.jsx(x9,{})})})}const Fs=R.forwardRef(({className:e,...t},n)=>r.jsx("textarea",{className:wr("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...t}));Fs.displayName="Textarea";function Rce(){const[e,t]=R.useState(!1),[n,s]=R.useState(null),[i,c]=R.useState({name:"",description:""}),u=br(),{data:a=[],isLoading:m}=ht({queryKey:["shape-files"],queryFn:async()=>{var N;return((N=(await me.get("/gis/shape-files")).data)==null?void 0:N.data)||[]}}),p=jt({mutationFn:async k=>{var O;const N=new FormData;return N.append("file",k),N.append("name",i.name||k.name),N.append("description",i.description),(O=(await me.post("/gis/shape-files",N)).data)==null?void 0:O.data},onSuccess:()=>{u.invalidateQueries({queryKey:["shape-files"]}),t(!1),s(null),c({name:"",description:""})}}),y=jt({mutationFn:async k=>{await me.delete(`/gis/shape-files/${k}`)},onSuccess:()=>{u.invalidateQueries({queryKey:["shape-files"]})}}),v=()=>{n&&i.name&&p.mutate(n)},j=k=>{const N={uploading:"bg-yellow-100 text-yellow-800",processing:"bg-blue-100 text-blue-800",processed:"bg-green-100 text-green-800",failed:"bg-red-100 text-red-800"};return r.jsx(We,{className:N[k],children:k})},S=k=>{if(k===0)return"0 Bytes";const N=1024,D=["Bytes","KB","MB","GB"],O=Math.floor(Math.log(k)/Math.log(N));return Math.round(k/Math.pow(N,O)*100)/100+" "+D[O]};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Shape Files & Vector Layers"}),r.jsxs(Rr,{open:e,onOpenChange:t,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{className:"gap-2",children:[r.jsx(Go,{className:"w-4 h-4"}),"Upload Shape File"]})}),r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Upload Shape File"})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{children:"Select File"}),r.jsx(Ge,{type:"file",accept:".zip,.shp,.geojson,.json,.gpkg",onChange:k=>{var N;return s(((N=k.target.files)==null?void 0:N[0])||null)},className:"mt-1"}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Supported: ZIP (Shapefile), GeoJSON, GPKG"})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Name"}),r.jsx(Ge,{value:i.name,onChange:k=>c({...i,name:k.target.value}),placeholder:"e.g., Water Supply Zones"})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Description"}),r.jsx(Fs,{value:i.description,onChange:k=>c({...i,description:k.target.value}),placeholder:"Optional description",rows:3})]}),r.jsx(se,{onClick:v,disabled:!n||!i.name||p.isPending,className:"w-full",children:p.isPending?"Uploading...":"Upload"})]})]})]})]}),m?r.jsx("p",{className:"text-gray-500",children:"Loading files..."}):a.length===0?r.jsx("p",{className:"text-gray-500 text-center py-8",children:"No shape files uploaded yet"}):r.jsx("div",{className:"grid gap-4",children:a.map(k=>r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx(xe,{className:"text-base",children:k.name}),k.description&&r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:k.description})]}),j(k.status)]})}),r.jsxs(ie,{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Type"}),r.jsx("p",{className:"font-medium",children:k.geom_type})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Features"}),r.jsx("p",{className:"font-medium",children:k.feature_count})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Size"}),r.jsx("p",{className:"font-medium",children:S(k.file_size)})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Projection"}),r.jsx("p",{className:"font-medium",children:k.projection_crs})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx("p",{className:"text-gray-500",children:"Uploaded by"}),r.jsx("p",{className:"font-medium",children:k.uploaded_by.name})]})]}),r.jsxs("div",{className:"flex gap-2",children:[k.status==="processed"&&r.jsxs(r.Fragment,{children:[r.jsxs(se,{size:"sm",variant:"outline",className:"gap-2",children:[r.jsx(Lm,{className:"w-4 h-4"}),"Preview"]}),r.jsxs(se,{size:"sm",variant:"outline",className:"gap-2",children:[r.jsx(rl,{className:"w-4 h-4"}),"Download"]})]}),r.jsx(se,{size:"sm",variant:"outline",className:"gap-2 ml-auto text-red-600 hover:text-red-700",onClick:()=>y.mutate(k.id),disabled:y.isPending,children:r.jsx(Oi,{className:"w-4 h-4"})})]})]})]},k.id))})]})}function Lce(e,t=[]){let n=[];function s(c,u){const a=R.createContext(u),m=n.length;n=[...n,u];function p(v){const{scope:j,children:S,...k}=v,N=(j==null?void 0:j[e][m])||a,D=R.useMemo(()=>k,Object.values(k));return r.jsx(N.Provider,{value:D,children:S})}function y(v,j){const S=(j==null?void 0:j[e][m])||a,k=R.useContext(S);if(k)return k;if(u!==void 0)return u;throw new Error(`\`${v}\` must be used within \`${c}\``)}return p.displayName=c+"Provider",[p,y]}const i=()=>{const c=n.map(u=>R.createContext(u));return function(a){const m=(a==null?void 0:a[e])||c;return R.useMemo(()=>({[`__scope${e}`]:{...a,[e]:m}}),[a,m])}};return i.scopeName=e,[s,Fce(i,...t)]}function Fce(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const s=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(c){const u=s.reduce((a,{useScope:m,scopeName:p})=>{const v=m(c)[`__scope${p}`];return{...a,...v}},{});return R.useMemo(()=>({[`__scope${t.scopeName}`]:u}),[u])}};return n.scopeName=t.scopeName,n}var _A="rovingFocusGroup.onEntryFocus",zce={bubbles:!1,cancelable:!0},S2="RovingFocusGroup",[zT,y9,$ce]=n2(S2),[Bce,N2]=Lce(S2,[$ce]),[qce,Vce]=Bce(S2),v9=R.forwardRef((e,t)=>r.jsx(zT.Provider,{scope:e.__scopeRovingFocusGroup,children:r.jsx(zT.Slot,{scope:e.__scopeRovingFocusGroup,children:r.jsx(Uce,{...e,ref:t})})}));v9.displayName=S2;var Uce=R.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:s,loop:i=!1,dir:c,currentTabStopId:u,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:m,onEntryFocus:p,preventScrollOnEntryFocus:y=!1,...v}=e,j=R.useRef(null),S=yn(t,j),k=Sy(c),[N=null,D]=ud({prop:u,defaultProp:a,onChange:m}),[O,T]=R.useState(!1),I=qi(p),z=y9(n),$=R.useRef(!1),[V,K]=R.useState(0);return R.useEffect(()=>{const te=j.current;if(te)return te.addEventListener(_A,I),()=>te.removeEventListener(_A,I)},[I]),r.jsx(qce,{scope:n,orientation:s,dir:k,loop:i,currentTabStopId:N,onItemFocus:R.useCallback(te=>D(te),[D]),onItemShiftTab:R.useCallback(()=>T(!0),[]),onFocusableItemAdd:R.useCallback(()=>K(te=>te+1),[]),onFocusableItemRemove:R.useCallback(()=>K(te=>te-1),[]),children:r.jsx(zr.div,{tabIndex:O||V===0?-1:0,"data-orientation":s,...v,ref:S,style:{outline:"none",...e.style},onMouseDown:nr(e.onMouseDown,()=>{$.current=!0}),onFocus:nr(e.onFocus,te=>{const X=!$.current;if(te.target===te.currentTarget&&X&&!O){const ve=new CustomEvent(_A,zce);if(te.currentTarget.dispatchEvent(ve),!ve.defaultPrevented){const ae=z().filter(Ve=>Ve.focusable),pe=ae.find(Ve=>Ve.active),Oe=ae.find(Ve=>Ve.id===N),Xe=[pe,Oe,...ae].filter(Boolean).map(Ve=>Ve.ref.current);j9(Xe,y)}}$.current=!1}),onBlur:nr(e.onBlur,()=>T(!1))})})}),_9="RovingFocusGroupItem",b9=R.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:s=!0,active:i=!1,tabStopId:c,...u}=e,a=Hc(),m=c||a,p=Vce(_9,n),y=p.currentTabStopId===m,v=y9(n),{onFocusableItemAdd:j,onFocusableItemRemove:S}=p;return R.useEffect(()=>{if(s)return j(),()=>S()},[s,j,S]),r.jsx(zT.ItemSlot,{scope:n,id:m,focusable:s,active:i,children:r.jsx(zr.span,{tabIndex:y?0:-1,"data-orientation":p.orientation,...u,ref:t,onMouseDown:nr(e.onMouseDown,k=>{s?p.onItemFocus(m):k.preventDefault()}),onFocus:nr(e.onFocus,()=>p.onItemFocus(m)),onKeyDown:nr(e.onKeyDown,k=>{if(k.key==="Tab"&&k.shiftKey){p.onItemShiftTab();return}if(k.target!==k.currentTarget)return;const N=Kce(k,p.orientation,p.dir);if(N!==void 0){if(k.metaKey||k.ctrlKey||k.altKey||k.shiftKey)return;k.preventDefault();let O=v().filter(T=>T.focusable).map(T=>T.ref.current);if(N==="last")O.reverse();else if(N==="prev"||N==="next"){N==="prev"&&O.reverse();const T=O.indexOf(k.currentTarget);O=p.loop?Hce(O,T+1):O.slice(T+1)}setTimeout(()=>j9(O))}})})})});b9.displayName=_9;var Wce={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Gce(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Kce(e,t,n){const s=Gce(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return Wce[s]}function j9(e,t=!1){const n=document.activeElement;for(const s of e)if(s===n||(s.focus({preventScroll:t}),document.activeElement!==n))return}function Hce(e,t){return e.map((n,s)=>e[(t+s)%e.length])}var w9=v9,S9=b9,aI="Tabs",[Zce]=bd(aI,[N2]),N9=N2(),[Yce,oI]=Zce(aI),P9=R.forwardRef((e,t)=>{const{__scopeTabs:n,value:s,onValueChange:i,defaultValue:c,orientation:u="horizontal",dir:a,activationMode:m="automatic",...p}=e,y=Sy(a),[v,j]=ud({prop:s,onChange:i,defaultProp:c});return r.jsx(Yce,{scope:n,baseId:Hc(),value:v,onValueChange:j,orientation:u,dir:y,activationMode:m,children:r.jsx(zr.div,{dir:y,"data-orientation":u,...p,ref:t})})});P9.displayName=aI;var C9="TabsList",A9=R.forwardRef((e,t)=>{const{__scopeTabs:n,loop:s=!0,...i}=e,c=oI(C9,n),u=N9(n);return r.jsx(w9,{asChild:!0,...u,orientation:c.orientation,dir:c.dir,loop:s,children:r.jsx(zr.div,{role:"tablist","aria-orientation":c.orientation,...i,ref:t})})});A9.displayName=C9;var k9="TabsTrigger",T9=R.forwardRef((e,t)=>{const{__scopeTabs:n,value:s,disabled:i=!1,...c}=e,u=oI(k9,n),a=N9(n),m=O9(u.baseId,s),p=I9(u.baseId,s),y=s===u.value;return r.jsx(S9,{asChild:!0,...a,focusable:!i,active:y,children:r.jsx(zr.button,{type:"button",role:"tab","aria-selected":y,"aria-controls":p,"data-state":y?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:m,...c,ref:t,onMouseDown:nr(e.onMouseDown,v=>{!i&&v.button===0&&v.ctrlKey===!1?u.onValueChange(s):v.preventDefault()}),onKeyDown:nr(e.onKeyDown,v=>{[" ","Enter"].includes(v.key)&&u.onValueChange(s)}),onFocus:nr(e.onFocus,()=>{const v=u.activationMode!=="manual";!y&&!i&&v&&u.onValueChange(s)})})})});T9.displayName=k9;var E9="TabsContent",M9=R.forwardRef((e,t)=>{const{__scopeTabs:n,value:s,forceMount:i,children:c,...u}=e,a=oI(E9,n),m=O9(a.baseId,s),p=I9(a.baseId,s),y=s===a.value,v=R.useRef(y);return R.useEffect(()=>{const j=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(j)},[]),r.jsx(So,{present:i||y,children:({present:j})=>r.jsx(zr.div,{"data-state":y?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":m,hidden:!j,id:p,tabIndex:0,...u,ref:t,style:{...e.style,animationDuration:v.current?"0s":void 0},children:j&&c})})});M9.displayName=E9;function O9(e,t){return`${e}-trigger-${t}`}function I9(e,t){return`${e}-content-${t}`}var Xce=P9,D9=A9,R9=T9,L9=M9;const qs=Xce,As=R.forwardRef(({className:e,...t},n)=>r.jsx(D9,{ref:n,className:wr("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",e),...t}));As.displayName=D9.displayName;const sr=R.forwardRef(({className:e,...t},n)=>r.jsx(R9,{ref:n,className:wr("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",e),...t}));sr.displayName=R9.displayName;const Nr=R.forwardRef(({className:e,...t},n)=>r.jsx(L9,{ref:n,className:wr("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));Nr.displayName=L9.displayName;function Qce(){const[e,t]=R.useState("map");return r.jsxs("div",{className:"h-screen w-full flex flex-col",children:[r.jsxs("div",{className:"border-b bg-white p-4",children:[r.jsx("h1",{className:"text-2xl font-bold",children:"GIS Module"}),r.jsx("p",{className:"text-gray-600",children:"Manage shape files, vector layers, and spatial data"})]}),r.jsxs(qs,{value:e,onValueChange:t,className:"flex-1 flex flex-col",children:[r.jsxs(As,{className:"px-4 pt-4 w-full justify-start border-b bg-white",children:[r.jsxs(sr,{value:"map",className:"gap-2",children:[r.jsx(Bc,{className:"w-4 h-4"}),"Map Console"]}),r.jsxs(sr,{value:"files",className:"gap-2",children:[r.jsx(Zq,{className:"w-4 h-4"}),"Files & Layers"]}),r.jsxs(sr,{value:"settings",className:"gap-2",children:[r.jsx(ai,{className:"w-4 h-4"}),"Settings"]})]}),r.jsx(Nr,{value:"map",className:"flex-1",children:r.jsx("div",{className:"h-full",children:r.jsx(x9,{})})}),r.jsx(Nr,{value:"files",className:"flex-1 overflow-auto",children:r.jsx("div",{className:"p-6",children:r.jsx(Rce,{})})}),r.jsx(Nr,{value:"settings",className:"flex-1 overflow-auto",children:r.jsx("div",{className:"p-6",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"GIS Settings"})}),r.jsx(ie,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-2",children:"Default Projection"}),r.jsx("p",{className:"text-sm text-gray-600",children:"EPSG:4326 (WGS84 - Latitude/Longitude)"})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-2",children:"Supported Formats"}),r.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[r.jsx("li",{children:" Shapefile (.zip containing .shp, .shx, .dbf)"}),r.jsx("li",{children:" GeoJSON (.geojson, .json)"}),r.jsx("li",{children:" GeoPackage (.gpkg)"})]})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-2",children:"Maximum File Size"}),r.jsx("p",{className:"text-sm text-gray-600",children:"100 MB per file"})]})]})})]})})})]})]})}function Jce(e,t){return R.useReducer((n,s)=>t[n][s]??n,e)}var lI="ScrollArea",[F9]=bd(lI),[eue,kl]=F9(lI),z9=R.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:s="hover",dir:i,scrollHideDelay:c=600,...u}=e,[a,m]=R.useState(null),[p,y]=R.useState(null),[v,j]=R.useState(null),[S,k]=R.useState(null),[N,D]=R.useState(null),[O,T]=R.useState(0),[I,z]=R.useState(0),[$,V]=R.useState(!1),[K,te]=R.useState(!1),X=yn(t,ae=>m(ae)),ve=Sy(i);return r.jsx(eue,{scope:n,type:s,dir:ve,scrollHideDelay:c,scrollArea:a,viewport:p,onViewportChange:y,content:v,onContentChange:j,scrollbarX:S,onScrollbarXChange:k,scrollbarXEnabled:$,onScrollbarXEnabledChange:V,scrollbarY:N,onScrollbarYChange:D,scrollbarYEnabled:K,onScrollbarYEnabledChange:te,onCornerWidthChange:T,onCornerHeightChange:z,children:r.jsx(zr.div,{dir:ve,...u,ref:X,style:{position:"relative","--radix-scroll-area-corner-width":O+"px","--radix-scroll-area-corner-height":I+"px",...e.style}})})});z9.displayName=lI;var $9="ScrollAreaViewport",B9=R.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:s,asChild:i,nonce:c,...u}=e,a=kl($9,n),m=R.useRef(null),p=yn(t,m,a.onViewportChange);return r.jsxs(r.Fragment,{children:[r.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:c}),r.jsx(zr.div,{"data-radix-scroll-area-viewport":"",...u,asChild:i,ref:p,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...e.style},children:uue({asChild:i,children:s},y=>r.jsx("div",{"data-radix-scroll-area-content":"",ref:a.onContentChange,style:{minWidth:a.scrollbarXEnabled?"fit-content":void 0},children:y}))})]})});B9.displayName=$9;var iu="ScrollAreaScrollbar",cI=R.forwardRef((e,t)=>{const{forceMount:n,...s}=e,i=kl(iu,e.__scopeScrollArea),{onScrollbarXEnabledChange:c,onScrollbarYEnabledChange:u}=i,a=e.orientation==="horizontal";return R.useEffect(()=>(a?c(!0):u(!0),()=>{a?c(!1):u(!1)}),[a,c,u]),i.type==="hover"?r.jsx(tue,{...s,ref:t,forceMount:n}):i.type==="scroll"?r.jsx(rue,{...s,ref:t,forceMount:n}):i.type==="auto"?r.jsx(q9,{...s,ref:t,forceMount:n}):i.type==="always"?r.jsx(uI,{...s,ref:t}):null});cI.displayName=iu;var tue=R.forwardRef((e,t)=>{const{forceMount:n,...s}=e,i=kl(iu,e.__scopeScrollArea),[c,u]=R.useState(!1);return R.useEffect(()=>{const a=i.scrollArea;let m=0;if(a){const p=()=>{window.clearTimeout(m),u(!0)},y=()=>{m=window.setTimeout(()=>u(!1),i.scrollHideDelay)};return a.addEventListener("pointerenter",p),a.addEventListener("pointerleave",y),()=>{window.clearTimeout(m),a.removeEventListener("pointerenter",p),a.removeEventListener("pointerleave",y)}}},[i.scrollArea,i.scrollHideDelay]),r.jsx(So,{present:n||c,children:r.jsx(q9,{"data-state":c?"visible":"hidden",...s,ref:t})})}),rue=R.forwardRef((e,t)=>{const{forceMount:n,...s}=e,i=kl(iu,e.__scopeScrollArea),c=e.orientation==="horizontal",u=C2(()=>m("SCROLL_END"),100),[a,m]=Jce("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return R.useEffect(()=>{if(a==="idle"){const p=window.setTimeout(()=>m("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(p)}},[a,i.scrollHideDelay,m]),R.useEffect(()=>{const p=i.viewport,y=c?"scrollLeft":"scrollTop";if(p){let v=p[y];const j=()=>{const S=p[y];v!==S&&(m("SCROLL"),u()),v=S};return p.addEventListener("scroll",j),()=>p.removeEventListener("scroll",j)}},[i.viewport,c,m,u]),r.jsx(So,{present:n||a!=="hidden",children:r.jsx(uI,{"data-state":a==="hidden"?"hidden":"visible",...s,ref:t,onPointerEnter:nr(e.onPointerEnter,()=>m("POINTER_ENTER")),onPointerLeave:nr(e.onPointerLeave,()=>m("POINTER_LEAVE"))})})}),q9=R.forwardRef((e,t)=>{const n=kl(iu,e.__scopeScrollArea),{forceMount:s,...i}=e,[c,u]=R.useState(!1),a=e.orientation==="horizontal",m=C2(()=>{if(n.viewport){const p=n.viewport.offsetWidth<n.viewport.scrollWidth,y=n.viewport.offsetHeight<n.viewport.scrollHeight;u(a?p:y)}},10);return Ox(n.viewport,m),Ox(n.content,m),r.jsx(So,{present:s||c,children:r.jsx(uI,{"data-state":c?"visible":"hidden",...i,ref:t})})}),uI=R.forwardRef((e,t)=>{const{orientation:n="vertical",...s}=e,i=kl(iu,e.__scopeScrollArea),c=R.useRef(null),u=R.useRef(0),[a,m]=R.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),p=K9(a.viewport,a.content),y={...s,sizes:a,onSizesChange:m,hasThumb:p>0&&p<1,onThumbChange:j=>c.current=j,onThumbPointerUp:()=>u.current=0,onThumbPointerDown:j=>u.current=j};function v(j,S){return lue(j,u.current,a,S)}return n==="horizontal"?r.jsx(nue,{...y,ref:t,onThumbPositionChange:()=>{if(i.viewport&&c.current){const j=i.viewport.scrollLeft,S=V3(j,a,i.dir);c.current.style.transform=`translate3d(${S}px, 0, 0)`}},onWheelScroll:j=>{i.viewport&&(i.viewport.scrollLeft=j)},onDragScroll:j=>{i.viewport&&(i.viewport.scrollLeft=v(j,i.dir))}}):n==="vertical"?r.jsx(sue,{...y,ref:t,onThumbPositionChange:()=>{if(i.viewport&&c.current){const j=i.viewport.scrollTop,S=V3(j,a);c.current.style.transform=`translate3d(0, ${S}px, 0)`}},onWheelScroll:j=>{i.viewport&&(i.viewport.scrollTop=j)},onDragScroll:j=>{i.viewport&&(i.viewport.scrollTop=v(j))}}):null}),nue=R.forwardRef((e,t)=>{const{sizes:n,onSizesChange:s,...i}=e,c=kl(iu,e.__scopeScrollArea),[u,a]=R.useState(),m=R.useRef(null),p=yn(t,m,c.onScrollbarXChange);return R.useEffect(()=>{m.current&&a(getComputedStyle(m.current))},[m]),r.jsx(U9,{"data-orientation":"horizontal",...i,ref:p,sizes:n,style:{bottom:0,left:c.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:c.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":P2(n)+"px",...e.style},onThumbPointerDown:y=>e.onThumbPointerDown(y.x),onDragScroll:y=>e.onDragScroll(y.x),onWheelScroll:(y,v)=>{if(c.viewport){const j=c.viewport.scrollLeft+y.deltaX;e.onWheelScroll(j),Z9(j,v)&&y.preventDefault()}},onResize:()=>{m.current&&c.viewport&&u&&s({content:c.viewport.scrollWidth,viewport:c.viewport.offsetWidth,scrollbar:{size:m.current.clientWidth,paddingStart:_S(u.paddingLeft),paddingEnd:_S(u.paddingRight)}})}})}),sue=R.forwardRef((e,t)=>{const{sizes:n,onSizesChange:s,...i}=e,c=kl(iu,e.__scopeScrollArea),[u,a]=R.useState(),m=R.useRef(null),p=yn(t,m,c.onScrollbarYChange);return R.useEffect(()=>{m.current&&a(getComputedStyle(m.current))},[m]),r.jsx(U9,{"data-orientation":"vertical",...i,ref:p,sizes:n,style:{top:0,right:c.dir==="ltr"?0:void 0,left:c.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":P2(n)+"px",...e.style},onThumbPointerDown:y=>e.onThumbPointerDown(y.y),onDragScroll:y=>e.onDragScroll(y.y),onWheelScroll:(y,v)=>{if(c.viewport){const j=c.viewport.scrollTop+y.deltaY;e.onWheelScroll(j),Z9(j,v)&&y.preventDefault()}},onResize:()=>{m.current&&c.viewport&&u&&s({content:c.viewport.scrollHeight,viewport:c.viewport.offsetHeight,scrollbar:{size:m.current.clientHeight,paddingStart:_S(u.paddingTop),paddingEnd:_S(u.paddingBottom)}})}})}),[iue,V9]=F9(iu),U9=R.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:s,hasThumb:i,onThumbChange:c,onThumbPointerUp:u,onThumbPointerDown:a,onThumbPositionChange:m,onDragScroll:p,onWheelScroll:y,onResize:v,...j}=e,S=kl(iu,n),[k,N]=R.useState(null),D=yn(t,X=>N(X)),O=R.useRef(null),T=R.useRef(""),I=S.viewport,z=s.content-s.viewport,$=qi(y),V=qi(m),K=C2(v,10);function te(X){if(O.current){const ve=X.clientX-O.current.left,ae=X.clientY-O.current.top;p({x:ve,y:ae})}}return R.useEffect(()=>{const X=ve=>{const ae=ve.target;(k==null?void 0:k.contains(ae))&&$(ve,z)};return document.addEventListener("wheel",X,{passive:!1}),()=>document.removeEventListener("wheel",X,{passive:!1})},[I,k,z,$]),R.useEffect(V,[s,V]),Ox(k,K),Ox(S.content,K),r.jsx(iue,{scope:n,scrollbar:k,hasThumb:i,onThumbChange:qi(c),onThumbPointerUp:qi(u),onThumbPositionChange:V,onThumbPointerDown:qi(a),children:r.jsx(zr.div,{...j,ref:D,style:{position:"absolute",...j.style},onPointerDown:nr(e.onPointerDown,X=>{X.button===0&&(X.target.setPointerCapture(X.pointerId),O.current=k.getBoundingClientRect(),T.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",S.viewport&&(S.viewport.style.scrollBehavior="auto"),te(X))}),onPointerMove:nr(e.onPointerMove,te),onPointerUp:nr(e.onPointerUp,X=>{const ve=X.target;ve.hasPointerCapture(X.pointerId)&&ve.releasePointerCapture(X.pointerId),document.body.style.webkitUserSelect=T.current,S.viewport&&(S.viewport.style.scrollBehavior=""),O.current=null})})})}),vS="ScrollAreaThumb",W9=R.forwardRef((e,t)=>{const{forceMount:n,...s}=e,i=V9(vS,e.__scopeScrollArea);return r.jsx(So,{present:n||i.hasThumb,children:r.jsx(aue,{ref:t,...s})})}),aue=R.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:s,...i}=e,c=kl(vS,n),u=V9(vS,n),{onThumbPositionChange:a}=u,m=yn(t,v=>u.onThumbChange(v)),p=R.useRef(),y=C2(()=>{p.current&&(p.current(),p.current=void 0)},100);return R.useEffect(()=>{const v=c.viewport;if(v){const j=()=>{if(y(),!p.current){const S=cue(v,a);p.current=S,a()}};return a(),v.addEventListener("scroll",j),()=>v.removeEventListener("scroll",j)}},[c.viewport,y,a]),r.jsx(zr.div,{"data-state":u.hasThumb?"visible":"hidden",...i,ref:m,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:nr(e.onPointerDownCapture,v=>{const S=v.target.getBoundingClientRect(),k=v.clientX-S.left,N=v.clientY-S.top;u.onThumbPointerDown({x:k,y:N})}),onPointerUp:nr(e.onPointerUp,u.onThumbPointerUp)})});W9.displayName=vS;var dI="ScrollAreaCorner",G9=R.forwardRef((e,t)=>{const n=kl(dI,e.__scopeScrollArea),s=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&s?r.jsx(oue,{...e,ref:t}):null});G9.displayName=dI;var oue=R.forwardRef((e,t)=>{const{__scopeScrollArea:n,...s}=e,i=kl(dI,n),[c,u]=R.useState(0),[a,m]=R.useState(0),p=!!(c&&a);return Ox(i.scrollbarX,()=>{var v;const y=((v=i.scrollbarX)==null?void 0:v.offsetHeight)||0;i.onCornerHeightChange(y),m(y)}),Ox(i.scrollbarY,()=>{var v;const y=((v=i.scrollbarY)==null?void 0:v.offsetWidth)||0;i.onCornerWidthChange(y),u(y)}),p?r.jsx(zr.div,{...s,ref:t,style:{width:c,height:a,position:"absolute",right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function _S(e){return e?parseInt(e,10):0}function K9(e,t){const n=e/t;return isNaN(n)?0:n}function P2(e){const t=K9(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,s=(e.scrollbar.size-n)*t;return Math.max(s,18)}function lue(e,t,n,s="ltr"){const i=P2(n),c=i/2,u=t||c,a=i-u,m=n.scrollbar.paddingStart+u,p=n.scrollbar.size-n.scrollbar.paddingEnd-a,y=n.content-n.viewport,v=s==="ltr"?[0,y]:[y*-1,0];return H9([m,p],v)(e)}function V3(e,t,n="ltr"){const s=P2(t),i=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,c=t.scrollbar.size-i,u=t.content-t.viewport,a=c-s,m=n==="ltr"?[0,u]:[u*-1,0],p=E0(e,m);return H9([0,u],[0,a])(p)}function H9(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const s=(t[1]-t[0])/(e[1]-e[0]);return t[0]+s*(n-e[0])}}function Z9(e,t){return e>0&&e<t}var cue=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},s=0;return function i(){const c={left:e.scrollLeft,top:e.scrollTop},u=n.left!==c.left,a=n.top!==c.top;(u||a)&&t(),n=c,s=window.requestAnimationFrame(i)}(),()=>window.cancelAnimationFrame(s)};function C2(e,t){const n=qi(e),s=R.useRef(0);return R.useEffect(()=>()=>window.clearTimeout(s.current),[]),R.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(n,t)},[n,t])}function Ox(e,t){const n=qi(t);La(()=>{let s=0;if(e){const i=new ResizeObserver(()=>{cancelAnimationFrame(s),s=window.requestAnimationFrame(n)});return i.observe(e),()=>{window.cancelAnimationFrame(s),i.unobserve(e)}}},[e,n])}function uue(e,t){const{asChild:n,children:s}=e;if(!n)return typeof t=="function"?t(s):t;const i=R.Children.only(s);return R.cloneElement(i,{children:typeof t=="function"?t(i.props.children):t})}var Y9=z9,due=B9,hue=G9;const Ty=R.forwardRef(({className:e,children:t,...n},s)=>r.jsxs(Y9,{ref:s,className:wr("relative overflow-hidden",e),...n,children:[r.jsx(due,{className:"h-full w-full rounded-[inherit]",children:t}),r.jsx(X9,{}),r.jsx(hue,{})]}));Ty.displayName=Y9.displayName;const X9=R.forwardRef(({className:e,orientation:t="vertical",...n},s)=>r.jsx(cI,{ref:s,orientation:t,className:wr("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...n,children:r.jsx(W9,{className:"relative flex-1 rounded-full bg-border"})}));X9.displayName=cI.displayName;const U3=[{name:"Core Registry",href:"/core",icon:xl,color:"text-blue-500",subPages:[{name:"Home",href:"/core"},{name:"Schemes",href:"/core/schemes"},{name:"Facilities",href:"/core/facilities"},{name:"DMAs",href:"/core/dmas"},{name:"Pipelines",href:"/core/pipelines"},{name:"Zones",href:"/core/zones"},{name:"Addresses",href:"/core/addresses"},{name:"Meters",href:"/core/meters"}]},{name:"CRM & Revenue",href:"/crm",icon:Pi,color:"text-green-500",subPages:[{name:"Customers",href:"/crm/customers",icon:Pi},{name:"Account Search",href:"/crm/accounts/search",icon:bT},{name:"Complaints",href:"/crm/complaints",icon:gn},{name:"Interactions",href:"/crm/interactions",icon:Cx},{name:"Segmentation",href:"/crm/segmentation",icon:Xu},{name:"Revenue Assurance",href:"/crm/ra",icon:gn},{name:"Dunning & Collections",href:"/crm/dunning",icon:wT},{name:"Import Center",href:"/crm/import",icon:Go}]},{name:"Hydro-Met",href:"/hydromet",icon:zre,color:"text-cyan-500",subPages:[{name:"Water Sources",href:"/hydromet/sources"},{name:"Stations Registry",href:"/hydromet/stations"},{name:"Aquifer Management",href:"/hydromet/aquifers",icon:ac}]},{name:"Projects",href:"/projects",icon:Wq,color:"text-purple-500",subPages:[]},{name:"Costing",href:"/costing",icon:ZL,color:"text-orange-500",subPages:[{name:"Budgets",href:"/costing/budgets",icon:ZL},{name:"Allocation Console",href:"/costing/allocations",icon:Ore},{name:"Cost-to-Serve",href:"/costing/cost-to-serve",icon:$s},{name:"GL Accounts",href:"/costing/gl-accounts",icon:Za},{name:"Cost Centers",href:"/costing/cost-centers",icon:Gq},{name:"Energy Tariffs",href:"/costing/energy/tariffs",icon:bo},{name:"Energy Readings",href:"/costing/energy/readings",icon:Go},{name:"Energy Dashboard",href:"/costing/energy/dashboard",icon:Vre},{name:"Requisitions",href:"/procurement/requisitions",icon:$_},{name:"RFQ Builder",href:"/procurement/rfqs",icon:is},{name:"LPO Management",href:"/procurement/lpos",icon:Jq}]},{name:"CMMS",href:"/cmms",icon:Fm,color:"text-yellow-500",subPages:[{name:"Dashboard",href:"/cmms/dashboard",icon:Xu},{name:"Assets",href:"/cmms/assets",icon:ai},{name:"Work Orders",href:"/cmms/work-orders",icon:$_},{name:"Job Plans",href:"/cmms/job-plans",icon:is},{name:"Preventive Maintenance",href:"/cmms/pm",icon:va},{name:"Condition Monitoring",href:"/cmms/condition-monitoring",icon:Wo},{name:"Stores & Inventory",href:"/cmms/stores",icon:Kc},{name:"Fleet Management",href:"/cmms/fleet",icon:k0},{name:"Contractors & SLA",href:"/cmms/contractors",icon:_T},{name:"HSE Safety",href:"/cmms/hse",icon:yl},{name:"Parts Catalog",href:"/cmms/parts",icon:xl},{name:"Asset Map",href:"/cmms/map",icon:Bc}]},{name:"Water Quality",href:"/water-quality",icon:ac,color:"text-blue-400",subPages:[{name:"Parameters",href:"/water-quality/parameters",icon:JL},{name:"Sampling Points",href:"/water-quality/sampling-points",icon:jo},{name:"Sampling Plans",href:"/water-quality/plans",icon:va},{name:"Samples",href:"/water-quality/samples",icon:ac},{name:"Lab Results",href:"/water-quality/results",icon:is},{name:"Compliance",href:"/water-quality/compliance",icon:Xu}]},{name:"GIS",href:"/gis",icon:Bc,color:"text-red-500",subPages:[{name:"Map Console",href:"/gis",icon:Bc},{name:"Files & Layers",href:"/gis",icon:Go},{name:"Settings",href:"/gis",icon:ai}]},{name:"M&E & Service Levels",href:"/me",icon:Zg,color:"text-teal-500",subPages:[{name:"KPI Dashboard",href:"/me/kpis",icon:Gu},{name:"Coverage Analytics",href:"/me/coverage",icon:Px},{name:"NRW Tracker",href:"/me/nrw",icon:ac},{name:"CX Analytics",href:"/me/cx",icon:Wo},{name:"Results Framework",href:"/me/indicators",icon:Zg},{name:"Gender & Equity",href:"/me/gender-equity",icon:Pi}]},{name:"Customer & Commercial",href:"/customer",icon:uS,color:"text-pink-500",subPages:[{name:"Tariffs",href:"/customer/tariffs",icon:Za},{name:"Billing Runs",href:"/customer/billing",icon:wT},{name:"Payment Reconciliation",href:"/customer/payments",icon:OO},{name:"Meter Routes",href:"/customer/meter-routes",icon:jo},{name:"Tickets (CRM)",href:"/customer/tickets",icon:uS},{name:"Kiosks",href:"/customer/kiosks",icon:bT},{name:"Water Trucking",href:"/customer/trucking",icon:k0},{name:"Connections",href:"/customer/connections",icon:Kc}]},{name:"Community & Stakeholder",href:"/community",icon:Hre,color:"text-purple-500",subPages:[{name:"RWSS Committees",href:"/community/committees",icon:Pi},{name:"Committee Finance",href:"/community/finance",icon:Za},{name:"Vendor Portal",href:"/community/vendors",icon:_T},{name:"Bids & RFQs",href:"/community/bids",icon:is},{name:"Vendor Deliveries",href:"/community/deliveries",icon:Kc},{name:"Stakeholder Map",href:"/community/stakeholders",icon:Pi},{name:"Engagement Planner",href:"/community/engagements",icon:va},{name:"GRM Console",href:"/community/grm",icon:Cx},{name:"Open Data Catalog",href:"/community/open-data",icon:Yq},{name:"Dataset Builder",href:"/community/dataset-builder",icon:ai},{name:"Public Maps",href:"/community/public-maps",icon:Bc}]},{name:"Core Operations",href:"/core-ops",icon:Wo,color:"text-emerald-500",subPages:[{name:"Operations Console",href:"/core-ops/console",icon:Gu},{name:"Topology Viewer",href:"/core-ops/topology",icon:Px},{name:"Telemetry Dashboard",href:"/core-ops/telemetry",icon:Kq},{name:"Outage Planner",href:"/core-ops/outages",icon:gn},{name:"NRW Dashboard",href:"/core-ops/nrw",icon:ac},{name:"Dosing Control",href:"/core-ops/dosing",icon:JL},{name:"Pump Scheduling",href:"/core-ops/scheduling",icon:xs},{name:"Pressure & Leak",href:"/core-ops/pressure-leak",icon:Gu},{name:"Shifts",href:"/core-ops/shifts",icon:xs},{name:"Events",href:"/core-ops/events",icon:ei},{name:"Checklists",href:"/core-ops/checklists",icon:$_},{name:"Playbooks",href:"/core-ops/playbooks",icon:Sx},{name:"Escalation Policies",href:"/core-ops/escalation-policies",icon:A0},{name:"Workflows - Definitions",href:"/core-ops/workflows/definitions",icon:lS},{name:"Workflows - Instances",href:"/core-ops/workflows/instances",icon:lS},{name:"Drought Response",href:"/core-ops/droughts",icon:gn}]},{name:"Decision Support & Analytics",href:"/dsa",icon:Ere,color:"text-violet-500",subPages:[{name:"Forecast Studio",href:"/dsa/forecast",icon:Mre},{name:"Scenario Workbench",href:"/dsa/scenarios",icon:Bre},{name:"Optimization Console",href:"/dsa/optimize",icon:ene},{name:"Anomalies Inbox",href:"/dsa/anomalies",icon:gn},{name:"Aquifer Dashboard",href:"/dsa/aquifer",icon:ac},{name:"Tariff Sandbox",href:"/dsa/tariffs",icon:Za},{name:"EWS Console",href:"/dsa/ews",icon:A0}]},{name:"Security",href:"/security",icon:yl,color:"text-red-500",subPages:[{name:"Audit Logs",href:"/security/audit",icon:is},{name:"Security Alerts",href:"/security/alerts",icon:gn},{name:"Roles",href:"/security/roles",icon:cS},{name:"API Keys",href:"/security/api-keys",icon:A1},{name:"DSR Requests",href:"/security/dsr",icon:is},{name:"Consents",href:"/security/consents",icon:yl},{name:"Key Management",href:"/security/kms",icon:A1},{name:"Retention Policies",href:"/security/retention",icon:xs},{name:"Data Catalog",href:"/security/data-catalog",icon:xl},{name:"2FA Setup",href:"/security/2fa",icon:yl}]},{name:"Admin",href:"/admin",icon:ai,color:"text-gray-500",subPages:[{name:"Users Management",href:"/admin/users",icon:Pi},{name:"Roles & Permissions",href:"/admin/rbac/roles",icon:cS},{name:"Permission Matrix",href:"/admin/rbac/matrix",icon:ai},{name:"Audit Logs",href:"/admin/audit",icon:is},{name:"Security Alerts",href:"/admin/security/alerts",icon:gn},{name:"API Keys",href:"/admin/security/api-keys",icon:A1}]},{name:"Integration",href:"/integration",icon:ai,color:"text-indigo-500",subPages:[{name:"API Catalog",href:"/integration/api",icon:xl},{name:"Connector Gallery",href:"/integration/connectors",icon:ai},{name:"Webhook Manager",href:"/integration/webhooks",icon:ai},{name:"ETL Jobs",href:"/integration/etl",icon:ai},{name:"Data Warehouse",href:"/integration/dw",icon:xl},{name:"Communication Templates",href:"/integration/comms",icon:ai}]},{name:"Training & Knowledge",href:"/training",icon:is,color:"text-amber-500",subPages:[{name:"Course Catalog",href:"/training/courses",icon:is},{name:"My Learning",href:"/training/my-learning",icon:Wo},{name:"Knowledge Base",href:"/training/kb",icon:xl},{name:"SOPs",href:"/training/sops",icon:$_},{name:"Skills Matrix",href:"/training/skills",icon:Zg},{name:"Certificates",href:"/training/certificates",icon:yl},{name:"Capacity Assessments",href:"/training/assessments",icon:sne}]}];function za(){const e=Qm(),[t,n]=R.useState(new Set),[s,i]=R.useState(!1),u=(()=>{const m="/"+e.pathname.split("/")[1];return U3.find(p=>p.href.startsWith(m))})();R.useEffect(()=>{const m=()=>{const j=window.innerHeight<800;i(j),j&&u?n(new Set([u.name])):!j&&u&&n(new Set([u.name]))};m();let p;const y=()=>{clearTimeout(p),p=setTimeout(m,150)};return window.addEventListener("resize",y),()=>{window.removeEventListener("resize",y),clearTimeout(p)}},[u]);const a=m=>{if(s)n(new Set([m]));else{const p=new Set(t);p.has(m)?p.delete(m):p.add(m),n(p)}};return r.jsxs("aside",{className:"w-64 bg-card border-r flex flex-col h-screen",children:[r.jsx("div",{className:"p-6 border-b flex-shrink-0",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-primary rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-primary-foreground font-bold text-sm",children:"RW"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-sm font-bold",children:"Rural Water MIS"}),r.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Management Information System"})]})]})}),r.jsx(Ty,{className:"flex-1",children:r.jsx("nav",{className:"p-3 space-y-1",children:U3.map(m=>{const p=(u==null?void 0:u.href)===m.href,y=m.subPages.length>0,v=t.has(m.name),j=y&&v,S=wr("w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md transition-colors group",p?"bg-primary/10 text-primary":"text-muted-foreground hover:text-foreground hover:bg-muted");return r.jsxs("div",{children:[y?r.jsxs("button",{onClick:()=>a(m.name),className:S,"aria-expanded":j,"aria-label":`${m.name} ${v?"expanded":"collapsed"}`,children:[r.jsx(m.icon,{className:wr("h-5 w-5 flex-shrink-0",p&&m.color)}),r.jsx("span",{className:"flex-1 text-left",children:m.name}),v?r.jsx(EO,{className:"h-4 w-4"}):r.jsx(by,{className:"h-4 w-4"})]}):r.jsxs(VL,{to:m.href,className:({isActive:k})=>wr("flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md transition-colors group",k?"bg-primary/10 text-primary":"text-muted-foreground hover:text-foreground hover:bg-muted"),children:[r.jsx(m.icon,{className:wr("h-5 w-5 flex-shrink-0",p&&m.color)}),r.jsx("span",{className:"flex-1 text-left",children:m.name})]}),j&&r.jsx("div",{className:"mt-1 ml-6 space-y-0.5 animate-in slide-in-from-top-2 duration-200",role:"group","aria-label":`${m.name} submenu`,children:m.subPages.map(k=>{const N="icon"in k?k.icon:null;return r.jsxs(VL,{to:k.href,className:({isActive:D})=>wr("flex items-center gap-2 px-3 py-1.5 text-xs rounded-md transition-colors",D?"bg-primary text-primary-foreground font-medium":"text-muted-foreground hover:text-foreground hover:bg-muted"),children:[N&&r.jsx(N,{className:"h-4 w-4"}),r.jsx("span",{children:k.name})]},k.href)})})]},m.name)})})}),s&&r.jsx("div",{className:"px-3 py-2 text-xs text-muted-foreground bg-muted/50 border-t flex-shrink-0",children:r.jsx("p",{className:"leading-tight",children:"Compact mode active - single section expanded"})})]})}function fue(){return r.jsxs("div",{className:"flex min-h-screen",children:[r.jsx(za,{}),r.jsx("main",{className:"flex-1 p-8 overflow-auto",children:r.jsx(Fa,{})})]})}function mue(){const[e,t]=R.useState(""),{data:n,isLoading:s,isError:i,error:c}=ht({queryKey:["audit","recent"],queryFn:()=>me.get("/audit/recent")}),a=((n==null?void 0:n.audit_events)||[]).filter(p=>{var y,v;return p.action.toLowerCase().includes(e.toLowerCase())||((y=p.user)==null?void 0:y.name.toLowerCase().includes(e.toLowerCase()))||((v=p.user)==null?void 0:v.email.toLowerCase().includes(e.toLowerCase()))}),m=p=>{switch(p){case"critical":return"destructive";case"error":return"destructive";case"warning":return"secondary";default:return"outline"}};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[r.jsx(is,{className:"h-8 w-8"}),"Audit Logs"]}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"View and search system audit trail"})]}),r.jsxs(se,{children:[r.jsx(rl,{className:"h-4 w-4 mr-2"}),"Export"]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx("div",{className:"flex items-center gap-4",children:r.jsxs("div",{className:"flex-1 relative",children:[r.jsx(ci,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Search by action, user, or email...",value:e,onChange:p=>t(p.target.value),className:"pl-10"})]})})}),r.jsx(ie,{children:s?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):i?r.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading audit events: ",(c==null?void 0:c.message)||"Unknown error"]}):a.length===0?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No audit events found"}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Timestamp"}),r.jsx(le,{children:"User"}),r.jsx(le,{children:"Action"}),r.jsx(le,{children:"Entity"}),r.jsx(le,{children:"Severity"}),r.jsx(le,{children:"IP Address"})]})}),r.jsx(ur,{children:a.map(p=>{var y,v;return r.jsxs(lt,{children:[r.jsx(ne,{className:"font-mono text-sm",children:new Date(p.created_at).toLocaleString()}),r.jsx(ne,{children:r.jsxs("div",{className:"text-sm",children:[r.jsx("p",{className:"font-medium",children:(y=p.user)==null?void 0:y.name}),r.jsx("p",{className:"text-muted-foreground text-xs",children:(v=p.user)==null?void 0:v.email})]})}),r.jsx(ne,{className:"font-mono text-sm",children:p.action}),r.jsx(ne,{className:"text-sm",children:p.entity_type&&r.jsx("span",{className:"text-muted-foreground",children:p.entity_type})}),r.jsx(ne,{children:r.jsx(We,{variant:m(p.severity),children:p.severity})}),r.jsx(ne,{className:"font-mono text-sm",children:p.ip_address})]},p.id)})})]})})]})]})}function W3(){const e=br(),{data:t,isLoading:n,isError:s,error:i}=ht({queryKey:["security-alerts","unresolved"],queryFn:()=>me.get("/security-alerts/unresolved")}),c=jt({mutationFn:p=>me.post(`/security-alerts/${p}/acknowledge`),onSuccess:()=>{e.invalidateQueries({queryKey:["security-alerts"]}),qe.success("Alert acknowledged")}}),u=jt({mutationFn:({id:p,notes:y})=>me.post(`/security-alerts/${p}/resolve`,{resolution_notes:y}),onSuccess:()=>{e.invalidateQueries({queryKey:["security-alerts"]}),qe.success("Alert resolved")}}),a=(t==null?void 0:t.alerts)||[],m=p=>{switch(p){case"critical":return"destructive";case"high":return"destructive";case"medium":return"secondary";default:return"outline"}};return r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[r.jsx(gn,{className:"h-8 w-8"}),"Security Alerts"]}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Monitor and manage security incidents"})]})}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Total Alerts"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:a.length})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Unacknowledged"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:a.filter(p=>!p.acknowledged_at).length})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Critical"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold text-destructive",children:a.filter(p=>p.severity==="critical").length})})]})]}),r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:n?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):s?r.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading security alerts: ",(i==null?void 0:i.message)||"Unknown error"]}):a.length===0?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No active alerts"}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Detected"}),r.jsx(le,{children:"Type"}),r.jsx(le,{children:"Title"}),r.jsx(le,{children:"Severity"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:a.map(p=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-mono text-sm",children:new Date(p.detected_at).toLocaleString()}),r.jsx(ne,{className:"font-mono text-sm",children:p.alert_type}),r.jsx(ne,{children:r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:p.title}),r.jsx("p",{className:"text-sm text-muted-foreground",children:p.description})]})}),r.jsx(ne,{children:r.jsx(We,{variant:m(p.severity),children:p.severity})}),r.jsx(ne,{children:p.acknowledged_at?r.jsx(We,{variant:"outline",children:"Acknowledged"}):r.jsx(We,{variant:"secondary",children:"New"})}),r.jsx(ne,{children:r.jsxs("div",{className:"flex gap-2",children:[!p.acknowledged_at&&r.jsxs(se,{size:"sm",variant:"outline",onClick:()=>c.mutate(p.id),disabled:c.isPending,children:[r.jsx(os,{className:"h-4 w-4 mr-1"}),"Acknowledge"]}),r.jsxs(se,{size:"sm",onClick:()=>u.mutate({id:p.id,notes:"Resolved"}),disabled:u.isPending,children:[r.jsx(yd,{className:"h-4 w-4 mr-1"}),"Resolve"]})]})})]},p.id))})]})})})]})}function pue(){const{data:e,isLoading:t,isError:n,error:s}=ht({queryKey:["roles"],queryFn:()=>me.get("/rbac/roles")}),i=(e==null?void 0:e.roles)||[];return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[r.jsx(Pi,{className:"h-8 w-8"}),"Roles & Permissions"]}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage user roles and access permissions"})]}),r.jsxs(se,{children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"Create Role"]})]}),r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:t?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):n?r.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading roles: ",(s==null?void 0:s.message)||"Unknown error"]}):i.length===0?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No roles found"}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Role Name"}),r.jsx(le,{children:"Guard"}),r.jsx(le,{children:"Permissions"}),r.jsx(le,{children:"Created"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:i.map(c=>{var u,a,m;return r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:c.name}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:c.guard_name})}),r.jsx(ne,{children:r.jsxs("div",{className:"flex gap-1 flex-wrap",children:[(u=c.permissions)==null?void 0:u.slice(0,3).map(p=>r.jsx(We,{variant:"secondary",className:"text-xs",children:p.name},p.id)),(((a=c.permissions)==null?void 0:a.length)||0)>3&&r.jsxs(We,{variant:"secondary",className:"text-xs",children:["+",(((m=c.permissions)==null?void 0:m.length)||0)-3," more"]})]})}),r.jsx(ne,{className:"font-mono text-sm",children:new Date(c.created_at).toLocaleDateString()}),r.jsx(ne,{children:r.jsx(se,{size:"sm",variant:"outline",children:"Edit"})})]},c.id)})})]})})})]})}function G3(){const{data:e,isLoading:t,isError:n,error:s}=ht({queryKey:["api-keys"],queryFn:()=>me.get("/rbac/api-keys")}),i=(e==null?void 0:e.api_keys)||[],c=u=>{switch(u){case"active":return"default";case"expired":return"destructive";case"revoked":return"outline";default:return"outline"}};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[r.jsx(cS,{className:"h-8 w-8"}),"API Keys"]}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage API access tokens"})]}),r.jsxs(se,{children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"Create API Key"]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Total Keys"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:i.length})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Active"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:i.filter(u=>u.status==="active").length})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Expired/Revoked"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:i.filter(u=>u.status!=="active").length})})]})]}),r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:t?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):n?r.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading API keys: ",(s==null?void 0:s.message)||"Unknown error"]}):i.length===0?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No API keys found"}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Name"}),r.jsx(le,{children:"Key Prefix"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Last Used"}),r.jsx(le,{children:"Expires"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:i.map(u=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:u.name}),r.jsxs(ne,{className:"font-mono text-sm",children:[u.key_prefix,"..."]}),r.jsx(ne,{children:r.jsx(We,{variant:c(u.status),children:u.status})}),r.jsx(ne,{className:"font-mono text-sm",children:u.last_used_at?new Date(u.last_used_at).toLocaleDateString():"Never"}),r.jsx(ne,{className:"font-mono text-sm",children:u.expires_at?new Date(u.expires_at).toLocaleDateString():"Never"}),r.jsx(ne,{children:r.jsxs(se,{size:"sm",variant:"outline",children:[r.jsx(Oi,{className:"h-4 w-4 mr-1"}),"Revoke"]})})]},u.id))})]})})})]})}function gue(){const{data:e,isLoading:t,isError:n,error:s}=ht({queryKey:["dsr","pending"],queryFn:()=>me.get("/dsr/pending")}),i=(e==null?void 0:e.dsr_requests)||[],c=u=>{switch(u){case"completed":return"default";case"pending":return"secondary";case"rejected":return"destructive";default:return"outline"}};return r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[r.jsx(xl,{className:"h-8 w-8"}),"Data Subject Requests"]}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Process GDPR data subject access, deletion, and rectification requests"})]})}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Pending"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:i.filter(u=>u.status==="pending").length})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"This Month"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:i.length})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Avg. Processing Time"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:"2.3d"})})]})]}),r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:t?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):n?r.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading DSR requests: ",(s==null?void 0:s.message)||"Unknown error"]}):i.length===0?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No pending DSR requests"}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Requested"}),r.jsx(le,{children:"Type"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Processed"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:i.map(u=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-mono text-sm",children:new Date(u.requested_at).toLocaleString()}),r.jsx(ne,{className:"font-medium",children:u.request_type}),r.jsx(ne,{children:r.jsx(We,{variant:c(u.status),children:u.status})}),r.jsx(ne,{className:"font-mono text-sm",children:u.processed_at?new Date(u.processed_at).toLocaleString():"-"}),r.jsx(ne,{children:u.status==="pending"&&r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(se,{size:"sm",variant:"outline",children:[r.jsx(os,{className:"h-4 w-4 mr-1"}),"Approve"]}),r.jsxs(se,{size:"sm",variant:"outline",children:[r.jsx(yd,{className:"h-4 w-4 mr-1"}),"Reject"]})]})})]},u.id))})]})})})]})}function xue(){const{data:e,isLoading:t,isError:n,error:s}=ht({queryKey:["consents","active"],queryFn:()=>me.get("/consents/active")}),i=(e==null?void 0:e.consents)||[];return r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[r.jsx(yl,{className:"h-8 w-8"}),"Consent Management"]}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Track and manage user consent for data processing"})]})}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Active Consents"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:i.filter(c=>!c.revoked_at).length})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Revoked"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:i.filter(c=>c.revoked_at).length})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Expiring Soon"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:"0"})})]})]}),r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:t?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):n?r.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading consents: ",(s==null?void 0:s.message)||"Unknown error"]}):i.length===0?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No consents found"}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Purpose"}),r.jsx(le,{children:"Given At"}),r.jsx(le,{children:"Expires At"}),r.jsx(le,{children:"Status"})]})}),r.jsx(ur,{children:i.map(c=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:c.purpose}),r.jsx(ne,{className:"font-mono text-sm",children:new Date(c.given_at).toLocaleString()}),r.jsx(ne,{className:"font-mono text-sm",children:c.expires_at?new Date(c.expires_at).toLocaleString():"Never"}),r.jsx(ne,{children:c.revoked_at?r.jsxs(We,{variant:"outline",children:[r.jsx(yd,{className:"h-3 w-3 mr-1"}),"Revoked"]}):r.jsxs(We,{variant:"default",children:[r.jsx(os,{className:"h-3 w-3 mr-1"}),"Active"]})})]},c.id))})]})})})]})}function yue(){const{data:e,isLoading:t,isError:n,error:s}=ht({queryKey:["kms","keys"],queryFn:()=>me.get("/kms/keys")}),i=(e==null?void 0:e.keys)||[],c=u=>{switch(u){case"active":return"default";case"rotating":return"secondary";case"retired":return"outline";default:return"outline"}};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[r.jsx(A1,{className:"h-8 w-8"}),"Encryption Key Management"]}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage encryption keys and rotation policies"})]}),r.jsxs(se,{children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"Generate Key"]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Total Keys"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:i.length})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Active"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:i.filter(u=>u.status==="active").length})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Rotating"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:i.filter(u=>u.status==="rotating").length})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Retired"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:i.filter(u=>u.status==="retired").length})})]})]}),r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:t?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):n?r.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading encryption keys: ",(s==null?void 0:s.message)||"Unknown error"]}):i.length===0?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No encryption keys found"}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Key ID"}),r.jsx(le,{children:"Type"}),r.jsx(le,{children:"Algorithm"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Created"}),r.jsx(le,{children:"Last Rotated"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:i.map(u=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-mono text-sm",children:u.key_id}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:u.key_type})}),r.jsx(ne,{className:"font-mono text-sm",children:u.algorithm}),r.jsx(ne,{children:r.jsx(We,{variant:c(u.status),children:u.status})}),r.jsx(ne,{className:"font-mono text-sm",children:new Date(u.created_at).toLocaleDateString()}),r.jsx(ne,{className:"font-mono text-sm",children:u.rotated_at?new Date(u.rotated_at).toLocaleDateString():"-"}),r.jsx(ne,{children:r.jsxs(se,{size:"sm",variant:"outline",children:[r.jsx(Qre,{className:"h-4 w-4 mr-1"}),"Rotate"]})})]},u.id))})]})})})]})}function vue(){var c;const{data:e,isLoading:t,isError:n,error:s}=ht({queryKey:["retention","policies"],queryFn:()=>me.get("/retention/policies")}),i=(e==null?void 0:e.policies)||[];return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[r.jsx(xs,{className:"h-8 w-8"}),"Data Retention Policies"]}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Configure automated data retention and deletion rules"})]}),r.jsxs(se,{children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"Create Policy"]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Active Policies"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:i.filter(u=>u.is_active).length})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Data Types"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:i.length})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Last Run"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-sm font-medium",children:(c=i[0])!=null&&c.last_applied_at?new Date(i[0].last_applied_at).toLocaleDateString():"Never"})})]})]}),r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:t?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):n?r.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading retention policies: ",(s==null?void 0:s.message)||"Unknown error"]}):i.length===0?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No retention policies configured"}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Data Type"}),r.jsx(le,{children:"Retention Period"}),r.jsx(le,{children:"Deletion Method"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Last Applied"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:i.map(u=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:u.data_type}),r.jsxs(ne,{children:[u.retention_period_days," days"]}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:u.deletion_method})}),r.jsx(ne,{children:u.is_active?r.jsx(We,{variant:"default",children:"Active"}):r.jsx(We,{variant:"outline",children:"Inactive"})}),r.jsx(ne,{className:"font-mono text-sm",children:u.last_applied_at?new Date(u.last_applied_at).toLocaleDateString():"-"}),r.jsx(ne,{children:r.jsx(se,{size:"sm",variant:"outline",children:"Edit"})})]},u.id))})]})})})]})}function _ue(){const{data:e,isLoading:t,isError:n,error:s}=ht({queryKey:["data-catalog"],queryFn:()=>me.get("/data-catalog")}),i=(e==null?void 0:e.catalog)||[],c=i.filter(a=>a.is_pii).length,u=i.filter(a=>a.encryption_required).length;return r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[r.jsx(ai,{className:"h-8 w-8"}),"Data Catalog"]}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Data classification and compliance inventory"})]})}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Total Fields"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:i.length})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"PII Fields"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:c})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Encrypted"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:u})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-sm font-medium",children:"Tables"})}),r.jsx(ie,{children:r.jsx("div",{className:"text-3xl font-bold",children:new Set(i.map(a=>a.table_name)).size})})]})]}),r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:t?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):n?r.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading data catalog: ",(s==null?void 0:s.message)||"Unknown error"]}):i.length===0?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No data catalog entries"}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Table"}),r.jsx(le,{children:"Column"}),r.jsx(le,{children:"Classification"}),r.jsx(le,{children:"PII"}),r.jsx(le,{children:"Encryption"}),r.jsx(le,{children:"Retention"})]})}),r.jsx(ur,{children:i.map(a=>r.jsxs(lt,{children:[r.jsxs(ne,{className:"font-mono text-sm",children:[r.jsx(xl,{className:"h-4 w-4 inline mr-1"}),a.table_name]}),r.jsx(ne,{className:"font-mono text-sm",children:a.column_name}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:a.data_class})}),r.jsx(ne,{children:a.is_pii?r.jsx(We,{variant:"destructive",children:"Yes"}):r.jsx(We,{variant:"outline",children:"No"})}),r.jsx(ne,{children:a.encryption_required?r.jsx(We,{variant:"default",children:"Required"}):r.jsx(We,{variant:"outline",children:"Optional"})}),r.jsx(ne,{children:a.retention_period_days?`${a.retention_period_days}d`:"-"})]},a.id))})]})})})]})}function bue(){const e=br(),[t,n]=R.useState(""),[s,i]=R.useState([]),{data:c,isLoading:u}=ht({queryKey:["2fa-status"],queryFn:()=>me.get("/auth/2fa/status")}),a=jt({mutationFn:()=>me.post("/auth/2fa/enroll"),onSuccess:()=>{e.invalidateQueries({queryKey:["2fa-status"]}),qe.success("2FA enrollment started")},onError:()=>{qe.error("Failed to start 2FA enrollment")}}),m=jt({mutationFn:S=>me.post("/auth/2fa/verify",{code:S}),onSuccess:S=>{e.invalidateQueries({queryKey:["2fa-status"]}),e.invalidateQueries({queryKey:["auth-user"]}),i(S.recovery_codes||[]),qe.success("2FA enabled successfully"),n("")},onError:()=>{qe.error("Invalid verification code")}}),p=jt({mutationFn:()=>me.post("/auth/2fa/disable"),onSuccess:()=>{e.invalidateQueries({queryKey:["2fa-status"]}),e.invalidateQueries({queryKey:["auth-user"]}),i([]),qe.success("2FA disabled")},onError:()=>{qe.error("Failed to disable 2FA")}}),y=()=>{a.mutate()},v=()=>{t.length===6&&m.mutate(t)},j=()=>{confirm("Are you sure you want to disable 2FA? This will reduce your account security.")&&p.mutate()};return r.jsx("div",{className:"container max-w-3xl py-8",children:r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Two-Factor Authentication"}),r.jsx("p",{className:"text-muted-foreground mt-2",children:"Add an extra layer of security to your account"})]}),u&&!c?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading 2FA status..."})}):r.jsxs(r.Fragment,{children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[c!=null&&c.enabled?r.jsx(QL,{className:"h-6 w-6 text-green-600"}):r.jsx(yl,{className:"h-6 w-6 text-muted-foreground"}),r.jsxs("div",{children:[r.jsx(xe,{children:"Status"}),r.jsx(xr,{children:c!=null&&c.enabled?"Two-factor authentication is enabled":"Two-factor authentication is disabled"})]})]}),(c==null?void 0:c.enabled)&&r.jsx(We,{variant:"default",className:"bg-green-600",children:"Enabled"})]})}),r.jsxs(ie,{className:"space-y-6",children:[!(c!=null&&c.enabled)&&!(c!=null&&c.qr_code)&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs(Wi,{children:[r.jsx(ei,{className:"h-4 w-4"}),r.jsx(ki,{children:"Two-factor authentication adds an extra layer of security by requiring a code from your authenticator app in addition to your password."})]}),r.jsx(se,{onClick:y,disabled:a.isPending,children:a.isPending?"Setting up...":"Enable 2FA"})]}),(c==null?void 0:c.qr_code)&&!(c!=null&&c.enabled)&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-3",children:"Step 1: Scan QR Code"}),r.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Scan this QR code with your authenticator app (Google Authenticator, Authy, 1Password, etc.)"}),r.jsx("div",{className:"flex justify-center p-4 bg-white rounded-lg",children:r.jsx("img",{src:c.qr_code,alt:"2FA QR Code",className:"w-64 h-64"})})]}),c.secret&&r.jsxs("div",{children:[r.jsx(Ne,{children:"Manual Entry Code"}),r.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"If you can't scan the QR code, enter this code manually:"}),r.jsx("code",{className:"block p-3 bg-muted rounded text-sm font-mono",children:c.secret})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-3",children:"Step 2: Verify Code"}),r.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Enter the 6-digit code from your authenticator app to complete setup"}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("div",{className:"flex-1",children:r.jsx(Ge,{type:"text",placeholder:"000000",maxLength:6,value:t,onChange:S=>n(S.target.value.replace(/\D/g,"")),onKeyPress:S=>{S.key==="Enter"&&v()}})}),r.jsx(se,{onClick:v,disabled:t.length!==6||m.isPending,children:m.isPending?"Verifying...":"Verify & Enable"})]})]})]}),(c==null?void 0:c.enabled)&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs(Wi,{className:"border-green-600 bg-green-50",children:[r.jsx(QL,{className:"h-4 w-4 text-green-600"}),r.jsx(ki,{className:"text-green-900",children:"Your account is protected with two-factor authentication."})]}),r.jsx(se,{variant:"destructive",onClick:j,disabled:p.isPending,children:p.isPending?"Disabling...":"Disable 2FA"})]})]})]}),(s.length>0||(c==null?void 0:c.recovery_codes)&&c.recovery_codes.length>0)&&r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Recovery Codes"}),r.jsx(xr,{children:"Save these recovery codes in a safe place. You can use them to access your account if you lose your authenticator device."})]}),r.jsxs(ie,{children:[r.jsxs(Wi,{className:"mb-4",children:[r.jsx(ei,{className:"h-4 w-4"}),r.jsx(ki,{children:s.length>0?"Save these recovery codes now! They will not be shown again.":"Each recovery code can only be used once. Store them securely."})]}),r.jsx("div",{className:"grid grid-cols-2 gap-2",children:(s.length>0?s:(c==null?void 0:c.recovery_codes)||[]).map((S,k)=>r.jsx("code",{className:"block p-2 bg-muted rounded text-sm font-mono",children:S},k))})]})]})]})]})})}function jue(){return r.jsxs("div",{className:"flex min-h-screen",children:[r.jsx(za,{}),r.jsx("main",{className:"flex-1 p-8 overflow-auto",children:r.jsx(Fa,{})})]})}const nh="",dc={getClasses:()=>me.get(`${nh}/asset-classes`),getAssets:e=>{const t={};return e!=null&&e.search&&(t.search=e.search),e!=null&&e.status&&(t.status=e.status),e!=null&&e.class_id&&(t.class_id=e.class_id.toString()),e!=null&&e.scheme_id&&(t.scheme_id=e.scheme_id),e!=null&&e.dma_id&&(t.dma_id=e.dma_id),e!=null&&e.parent_id&&(t.parent_id=e.parent_id.toString()),e!=null&&e.per_page&&(t.per_page=e.per_page.toString()),e!=null&&e.page&&(t.page=e.page.toString()),me.get(`${nh}/assets`,t)},getAsset:e=>me.get(`${nh}/assets/${e}`),createAsset:e=>me.post(`${nh}/assets`,e),updateAsset:(e,t)=>me.put(`${nh}/assets/${e}`,t),deleteAsset:e=>me.delete(`${nh}/assets/${e}`),getAssetMaintenanceHistory:e=>me.get(`${nh}/assets/${e}/maintenance-history`),getAssetLocations:e=>me.get(`${nh}/assets/${e}/locations`)},wi="",Qg={getWorkOrders:e=>{const t={};return e!=null&&e.search&&(t.search=e.search),e!=null&&e.status&&(t.status=e.status),e!=null&&e.kind&&(t.kind=e.kind),e!=null&&e.priority&&(t.priority=e.priority),e!=null&&e.asset_id&&(t.asset_id=e.asset_id.toString()),e!=null&&e.assigned_to&&(t.assigned_to=e.assigned_to),e!=null&&e.per_page&&(t.per_page=e.per_page.toString()),e!=null&&e.page&&(t.page=e.page.toString()),me.get(`${wi}/work-orders`,t)},getWorkOrder:e=>me.get(`${wi}/work-orders/${e}`),createWorkOrder:e=>me.post(`${wi}/work-orders`,e),updateWorkOrder:(e,t)=>me.put(`${wi}/work-orders/${e}`,t),deleteWorkOrder:e=>me.delete(`${wi}/work-orders/${e}`),addParts:(e,t)=>me.post(`${wi}/work-orders/${e}/parts`,t),addLabor:(e,t)=>me.post(`${wi}/work-orders/${e}/labor`,t),assignWorkOrder:(e,t)=>me.post(`${wi}/work-orders/${e}/assign`,{user_id:t}),startWorkOrder:e=>me.post(`${wi}/work-orders/${e}/start`),completeWorkOrder:(e,t)=>me.post(`${wi}/work-orders/${e}/complete`,t),cancelWorkOrder:(e,t)=>me.post(`${wi}/work-orders/${e}/cancel`,{notes:t}),approveWorkOrder:(e,t)=>me.post(`${wi}/work-orders/${e}/approve`,{notes:t}),qaWorkOrder:(e,t)=>me.post(`${wi}/work-orders/${e}/qa`,t),addChecklist:(e,t)=>me.post(`${wi}/work-orders/${e}/checklist`,t),updateChecklistItem:(e,t)=>me.patch(`${wi}/work-orders/checklist-items/${e}`,t),addAttachment:(e,t)=>me.post(`${wi}/work-orders/${e}/attachments`,t),addAssignment:(e,t)=>me.post(`${wi}/work-orders/${e}/assignments`,t),addComment:(e,t)=>me.post(`${wi}/work-orders/${e}/comments`,t),getOverdue:()=>me.get(`${wi}/work-orders/overdue`),getStats:()=>me.get(`${wi}/work-orders/stats`)},pg="",bS={getParts:e=>{const t={};return e!=null&&e.search&&(t.search=e.search),e!=null&&e.category&&(t.category=e.category),e!=null&&e.supplier_id&&(t.supplier_id=e.supplier_id.toString()),e!=null&&e.per_page&&(t.per_page=e.per_page.toString()),e!=null&&e.page&&(t.page=e.page.toString()),me.get(`${pg}/parts`,t)},getPart:e=>me.get(`${pg}/parts/${e}`),createPart:e=>me.post(`${pg}/parts`,e),updatePart:(e,t)=>me.put(`${pg}/parts/${e}`,t),deletePart:e=>me.delete(`${pg}/parts/${e}`),getStockTransactions:e=>{const t=e?{part_id:e.toString()}:{};return me.get(`${pg}/stock-txns`,t)}};function wue(){const{data:e}=ht({queryKey:["assets",{per_page:1}],queryFn:()=>dc.getAssets({per_page:1})}),{data:t}=ht({queryKey:["work-orders",{per_page:1}],queryFn:()=>Qg.getWorkOrders({per_page:1})}),{data:n}=ht({queryKey:["work-orders",{status:"open",per_page:1}],queryFn:()=>Qg.getWorkOrders({status:"open",per_page:1})}),{data:s}=ht({queryKey:["work-orders",{status:"in_progress",per_page:1}],queryFn:()=>Qg.getWorkOrders({status:"in_progress",per_page:1})}),{data:i}=ht({queryKey:["parts",{per_page:100}],queryFn:()=>bS.getParts({per_page:100})}),c=(i==null?void 0:i.data.filter(a=>{const m=a.stock_balance||0,p=a.reorder_level||0;return m<=p&&m>0}).length)||0,u=(i==null?void 0:i.data.filter(a=>(a.stock_balance||0)===0).length)||0;return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"CMMS Dashboard"}),r.jsx("p",{className:"text-muted-foreground",children:"Overview of assets, maintenance, and inventory"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Total Assets"}),r.jsx(ai,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:(e==null?void 0:e.total)||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Infrastructure and equipment"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Total Work Orders"}),r.jsx($_,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:(t==null?void 0:t.total)||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"All maintenance tasks"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Open Work Orders"}),r.jsx(gn,{className:"h-4 w-4 text-orange-500"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold text-orange-500",children:(n==null?void 0:n.total)||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Pending assignment"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"In Progress"}),r.jsx(xs,{className:"h-4 w-4 text-blue-500"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold text-blue-500",children:(s==null?void 0:s.total)||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently being worked on"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Total Parts"}),r.jsx(Kc,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:(i==null?void 0:i.total)||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Inventory items"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Low Stock"}),r.jsx(gn,{className:"h-4 w-4 text-orange-500"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold text-orange-500",children:c}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Need reordering"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Out of Stock"}),r.jsx(gn,{className:"h-4 w-4 text-red-500"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold text-red-500",children:u}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Urgent action needed"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"System Status"}),r.jsx(os,{className:"h-4 w-4 text-green-500"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold text-green-500",children:"Online"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"All systems operational"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Quick Actions"})}),r.jsxs(ie,{className:"space-y-2",children:[r.jsxs("a",{href:"/cmms/work-orders",className:"block p-3 border rounded hover:bg-accent transition-colors",children:[r.jsx("div",{className:"font-medium",children:"Create Work Order"}),r.jsx("div",{className:"text-sm text-muted-foreground",children:"Schedule maintenance task"})]}),r.jsxs("a",{href:"/cmms/assets",className:"block p-3 border rounded hover:bg-accent transition-colors",children:[r.jsx("div",{className:"font-medium",children:"Add New Asset"}),r.jsx("div",{className:"text-sm text-muted-foreground",children:"Register infrastructure or equipment"})]}),r.jsxs("a",{href:"/cmms/parts",className:"block p-3 border rounded hover:bg-accent transition-colors",children:[r.jsx("div",{className:"font-medium",children:"Manage Inventory"}),r.jsx("div",{className:"text-sm text-muted-foreground",children:"Update parts and stock levels"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Recent Activity"})}),r.jsx(ie,{children:r.jsxs("div",{className:"text-sm text-muted-foreground",children:[r.jsx("p",{children:"System is ready to track your maintenance activities."}),r.jsx("p",{className:"mt-2",children:"Start by adding assets, creating work orders, or managing inventory."})]})})]})]})]})}var Fb=e=>e.type==="checkbox",hm=e=>e instanceof Date,uo=e=>e==null;const Q9=e=>typeof e=="object";var Ti=e=>!uo(e)&&!Array.isArray(e)&&Q9(e)&&!hm(e),J9=e=>Ti(e)&&e.target?Fb(e.target)?e.target.checked:e.target.value:e,Sue=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,eW=(e,t)=>e.has(Sue(t)),Nue=e=>{const t=e.constructor&&e.constructor.prototype;return Ti(t)&&t.hasOwnProperty("isPrototypeOf")},hI=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function ws(e){let t;const n=Array.isArray(e),s=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(!(hI&&(e instanceof Blob||s))&&(n||Ti(e)))if(t=n?[]:Object.create(Object.getPrototypeOf(e)),!n&&!Nue(e))t=e;else for(const i in e)e.hasOwnProperty(i)&&(t[i]=ws(e[i]));else return e;return t}var A2=e=>/^\w*$/.test(e),ps=e=>e===void 0,k2=e=>Array.isArray(e)?e.filter(Boolean):[],fI=e=>k2(e.replace(/["|']|\]/g,"").split(/\.|\[/)),Qt=(e,t,n)=>{if(!t||!Ti(e))return n;const s=(A2(t)?[t]:fI(t)).reduce((i,c)=>uo(i)?i:i[c],e);return ps(s)||s===e?ps(e[t])?n:e[t]:s},$o=e=>typeof e=="boolean",zn=(e,t,n)=>{let s=-1;const i=A2(t)?[t]:fI(t),c=i.length,u=c-1;for(;++s<c;){const a=i[s];let m=n;if(s!==u){const p=e[a];m=Ti(p)||Array.isArray(p)?p:isNaN(+i[s+1])?{}:[]}if(a==="__proto__"||a==="constructor"||a==="prototype")return;e[a]=m,e=e[a]}};const jS={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},vl={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Ru={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},mI=de.createContext(null);mI.displayName="HookFormContext";const zb=()=>de.useContext(mI),Pue=e=>{const{children:t,...n}=e;return de.createElement(mI.Provider,{value:n},t)};var tW=(e,t,n,s=!0)=>{const i={defaultValues:t._defaultValues};for(const c in e)Object.defineProperty(i,c,{get:()=>{const u=c;return t._proxyFormState[u]!==vl.all&&(t._proxyFormState[u]=!s||vl.all),n&&(n[u]=!0),e[u]}});return i};const T2=typeof window<"u"?de.useLayoutEffect:de.useEffect;function Cue(e){const t=zb(),{control:n=t.control,disabled:s,name:i,exact:c}=e||{},[u,a]=de.useState(n._formState),m=de.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return T2(()=>n._subscribe({name:i,formState:m.current,exact:c,callback:p=>{!s&&a({...n._formState,...p})}}),[i,s,c]),de.useEffect(()=>{m.current.isValid&&n._setValid(!0)},[n]),de.useMemo(()=>tW(u,n,m.current,!1),[u,n])}var qo=e=>typeof e=="string",$T=(e,t,n,s,i)=>qo(e)?(s&&t.watch.add(e),Qt(n,e,i)):Array.isArray(e)?e.map(c=>(s&&t.watch.add(c),Qt(n,c))):(s&&(t.watchAll=!0),n),BT=e=>uo(e)||!Q9(e);function oc(e,t,n=new WeakSet){if(BT(e)||BT(t))return Object.is(e,t);if(hm(e)&&hm(t))return e.getTime()===t.getTime();const s=Object.keys(e),i=Object.keys(t);if(s.length!==i.length)return!1;if(n.has(e)||n.has(t))return!0;n.add(e),n.add(t);for(const c of s){const u=e[c];if(!i.includes(c))return!1;if(c!=="ref"){const a=t[c];if(hm(u)&&hm(a)||Ti(u)&&Ti(a)||Array.isArray(u)&&Array.isArray(a)?!oc(u,a,n):!Object.is(u,a))return!1}}return!0}function Aue(e){const t=zb(),{control:n=t.control,name:s,defaultValue:i,disabled:c,exact:u,compute:a}=e||{},m=de.useRef(i),p=de.useRef(a),y=de.useRef(void 0),v=de.useRef(n),j=de.useRef(s);p.current=a;const[S,k]=de.useState(()=>{const z=n._getWatch(s,m.current);return p.current?p.current(z):z}),N=de.useCallback(z=>{const $=$T(s,n._names,z||n._formValues,!1,m.current);return p.current?p.current($):$},[n._formValues,n._names,s]),D=de.useCallback(z=>{if(!c){const $=$T(s,n._names,z||n._formValues,!1,m.current);if(p.current){const V=p.current($);oc(V,y.current)||(k(V),y.current=V)}else k($)}},[n._formValues,n._names,c,s]);T2(()=>((v.current!==n||!oc(j.current,s))&&(v.current=n,j.current=s,D()),n._subscribe({name:s,formState:{values:!0},exact:u,callback:z=>{D(z.values)}})),[n,u,s,D]),de.useEffect(()=>n._removeUnmounted());const O=v.current!==n,T=j.current,I=de.useMemo(()=>{if(c)return null;const z=!O&&!oc(T,s);return O||z?N():null},[c,O,s,T,N]);return I!==null?I:S}function kue(e){const t=zb(),{name:n,disabled:s,control:i=t.control,shouldUnregister:c,defaultValue:u}=e,a=eW(i._names.array,n),m=de.useMemo(()=>Qt(i._formValues,n,Qt(i._defaultValues,n,u)),[i,n,u]),p=Aue({control:i,name:n,defaultValue:m,exact:!0}),y=Cue({control:i,name:n,exact:!0}),v=de.useRef(e),j=de.useRef(void 0),S=de.useRef(i.register(n,{...e.rules,value:p,...$o(e.disabled)?{disabled:e.disabled}:{}}));v.current=e;const k=de.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Qt(y.errors,n)},isDirty:{enumerable:!0,get:()=>!!Qt(y.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!Qt(y.touchedFields,n)},isValidating:{enumerable:!0,get:()=>!!Qt(y.validatingFields,n)},error:{enumerable:!0,get:()=>Qt(y.errors,n)}}),[y,n]),N=de.useCallback(I=>S.current.onChange({target:{value:J9(I),name:n},type:jS.CHANGE}),[n]),D=de.useCallback(()=>S.current.onBlur({target:{value:Qt(i._formValues,n),name:n},type:jS.BLUR}),[n,i._formValues]),O=de.useCallback(I=>{const z=Qt(i._fields,n);z&&I&&(z._f.ref={focus:()=>I.focus&&I.focus(),select:()=>I.select&&I.select(),setCustomValidity:$=>I.setCustomValidity($),reportValidity:()=>I.reportValidity()})},[i._fields,n]),T=de.useMemo(()=>({name:n,value:p,...$o(s)||y.disabled?{disabled:y.disabled||s}:{},onChange:N,onBlur:D,ref:O}),[n,s,y.disabled,N,D,O,p]);return de.useEffect(()=>{const I=i._options.shouldUnregister||c,z=j.current;z&&z!==n&&!a&&i.unregister(z),i.register(n,{...v.current.rules,...$o(v.current.disabled)?{disabled:v.current.disabled}:{}});const $=(V,K)=>{const te=Qt(i._fields,V);te&&te._f&&(te._f.mount=K)};if($(n,!0),I){const V=ws(Qt(i._options.defaultValues,n,v.current.defaultValue));zn(i._defaultValues,n,V),ps(Qt(i._formValues,n))&&zn(i._formValues,n,V)}return!a&&i.register(n),j.current=n,()=>{(a?I&&!i._state.action:I)?i.unregister(n):$(n,!1)}},[n,i,a,c]),de.useEffect(()=>{i._setDisabledField({disabled:s,name:n})},[s,n,i]),de.useMemo(()=>({field:T,formState:y,fieldState:k}),[T,y,k])}const pI=e=>e.render(kue(e));var gI=(e,t,n,s,i)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[s]:i||!0}}:{},go=e=>Array.isArray(e)?e:[e],K3=()=>{let e=[];return{get observers(){return e},next:i=>{for(const c of e)c.next&&c.next(i)},subscribe:i=>(e.push(i),{unsubscribe:()=>{e=e.filter(c=>c!==i)}}),unsubscribe:()=>{e=[]}}};function rW(e,t){const n={};for(const s in e)if(e.hasOwnProperty(s)){const i=e[s],c=t[s];if(i&&Ti(i)&&c){const u=rW(i,c);Ti(u)&&(n[s]=u)}else e[s]&&(n[s]=c)}return n}var Ta=e=>Ti(e)&&!Object.keys(e).length,xI=e=>e.type==="file",lc=e=>typeof e=="function",wS=e=>{if(!hI)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},nW=e=>e.type==="select-multiple",yI=e=>e.type==="radio",Tue=e=>yI(e)||Fb(e),bA=e=>wS(e)&&e.isConnected;function Eue(e,t){const n=t.slice(0,-1).length;let s=0;for(;s<n;)e=ps(e)?s++:e[t[s++]];return e}function Mue(e){for(const t in e)if(e.hasOwnProperty(t)&&!ps(e[t]))return!1;return!0}function fi(e,t){const n=Array.isArray(t)?t:A2(t)?[t]:fI(t),s=n.length===1?e:Eue(e,n),i=n.length-1,c=n[i];return s&&delete s[c],i!==0&&(Ti(s)&&Ta(s)||Array.isArray(s)&&Mue(s))&&fi(e,n.slice(0,-1)),e}var Oue=e=>{for(const t in e)if(lc(e[t]))return!0;return!1};function sW(e){return Array.isArray(e)||Ti(e)&&!Oue(e)}function qT(e,t={}){for(const n in e){const s=e[n];sW(s)?(t[n]=Array.isArray(s)?[]:{},qT(s,t[n])):ps(s)||(t[n]=!0)}return t}function bg(e,t,n){n||(n=qT(t));for(const s in e){const i=e[s];if(sW(i))ps(t)||BT(n[s])?n[s]=qT(i,Array.isArray(i)?[]:{}):bg(i,uo(t)?{}:t[s],n[s]);else{const c=t[s];n[s]=!oc(i,c)}}return n}const H3={value:!1,isValid:!1},Z3={value:!0,isValid:!0};var iW=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!ps(e[0].attributes.value)?ps(e[0].value)||e[0].value===""?Z3:{value:e[0].value,isValid:!0}:Z3:H3}return H3},aW=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:s})=>ps(e)?e:t?e===""?NaN:e&&+e:n&&qo(e)?new Date(e):s?s(e):e;const Y3={isValid:!1,value:null};var oW=e=>Array.isArray(e)?e.reduce((t,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:t,Y3):Y3;function X3(e){const t=e.ref;return xI(t)?t.files:yI(t)?oW(e.refs).value:nW(t)?[...t.selectedOptions].map(({value:n})=>n):Fb(t)?iW(e.refs).value:aW(ps(t.value)?e.ref.value:t.value,e)}var Iue=(e,t,n,s)=>{const i={};for(const c of e){const u=Qt(t,c);u&&zn(i,c,u._f)}return{criteriaMode:n,names:[...e],fields:i,shouldUseNativeValidation:s}},SS=e=>e instanceof RegExp,__=e=>ps(e)?e:SS(e)?e.source:Ti(e)?SS(e.value)?e.value.source:e.value:e,Dg=e=>({isOnSubmit:!e||e===vl.onSubmit,isOnBlur:e===vl.onBlur,isOnChange:e===vl.onChange,isOnAll:e===vl.all,isOnTouch:e===vl.onTouched});const Q3="AsyncFunction";var Due=e=>!!e&&!!e.validate&&!!(lc(e.validate)&&e.validate.constructor.name===Q3||Ti(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===Q3)),Rue=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),VT=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some(s=>e.startsWith(s)&&/^\.\w+/.test(e.slice(s.length))));const Jg=(e,t,n,s)=>{for(const i of n||Object.keys(e)){const c=Qt(e,i);if(c){const{_f:u,...a}=c;if(u){if(u.refs&&u.refs[0]&&t(u.refs[0],i)&&!s)return!0;if(u.ref&&t(u.ref,u.name)&&!s)return!0;if(Jg(a,t))break}else if(Ti(a)&&Jg(a,t))break}}};function J3(e,t,n){const s=Qt(e,n);if(s||A2(n))return{error:s,name:n};const i=n.split(".");for(;i.length;){const c=i.join("."),u=Qt(t,c),a=Qt(e,c);if(u&&!Array.isArray(u)&&n!==c)return{name:n};if(a&&a.type)return{name:c,error:a};if(a&&a.root&&a.root.type)return{name:`${c}.root`,error:a.root};i.pop()}return{name:n}}var Lue=(e,t,n,s)=>{n(e);const{name:i,...c}=e;return Ta(c)||Object.keys(c).length>=Object.keys(t).length||Object.keys(c).find(u=>t[u]===(!s||vl.all))},Fue=(e,t,n)=>!e||!t||e===t||go(e).some(s=>s&&(n?s===t:s.startsWith(t)||t.startsWith(s))),zue=(e,t,n,s,i)=>i.isOnAll?!1:!n&&i.isOnTouch?!(t||e):(n?s.isOnBlur:i.isOnBlur)?!e:(n?s.isOnChange:i.isOnChange)?e:!0,$ue=(e,t)=>!k2(Qt(e,t)).length&&fi(e,t),lW=(e,t,n)=>{const s=go(Qt(e,n));return zn(s,"root",t[n]),zn(e,n,s),e};function eF(e,t,n="validate"){if(qo(e)||Array.isArray(e)&&e.every(qo)||$o(e)&&!e)return{type:n,message:qo(e)?e:"",ref:t}}var gg=e=>Ti(e)&&!SS(e)?e:{value:e,message:""},UT=async(e,t,n,s,i,c)=>{const{ref:u,refs:a,required:m,maxLength:p,minLength:y,min:v,max:j,pattern:S,validate:k,name:N,valueAsNumber:D,mount:O}=e._f,T=Qt(n,N);if(!O||t.has(N))return{};const I=a?a[0]:u,z=pe=>{i&&I.reportValidity&&(I.setCustomValidity($o(pe)?"":pe||""),I.reportValidity())},$={},V=yI(u),K=Fb(u),te=V||K,X=(D||xI(u))&&ps(u.value)&&ps(T)||wS(u)&&u.value===""||T===""||Array.isArray(T)&&!T.length,ve=gI.bind(null,N,s,$),ae=(pe,Oe,Me,Xe=Ru.maxLength,Ve=Ru.minLength)=>{const et=pe?Oe:Me;$[N]={type:pe?Xe:Ve,message:et,ref:u,...ve(pe?Xe:Ve,et)}};if(c?!Array.isArray(T)||!T.length:m&&(!te&&(X||uo(T))||$o(T)&&!T||K&&!iW(a).isValid||V&&!oW(a).isValid)){const{value:pe,message:Oe}=qo(m)?{value:!!m,message:m}:gg(m);if(pe&&($[N]={type:Ru.required,message:Oe,ref:I,...ve(Ru.required,Oe)},!s))return z(Oe),$}if(!X&&(!uo(v)||!uo(j))){let pe,Oe;const Me=gg(j),Xe=gg(v);if(!uo(T)&&!isNaN(T)){const Ve=u.valueAsNumber||T&&+T;uo(Me.value)||(pe=Ve>Me.value),uo(Xe.value)||(Oe=Ve<Xe.value)}else{const Ve=u.valueAsDate||new Date(T),et=tt=>new Date(new Date().toDateString()+" "+tt),Ce=u.type=="time",_e=u.type=="week";qo(Me.value)&&T&&(pe=Ce?et(T)>et(Me.value):_e?T>Me.value:Ve>new Date(Me.value)),qo(Xe.value)&&T&&(Oe=Ce?et(T)<et(Xe.value):_e?T<Xe.value:Ve<new Date(Xe.value))}if((pe||Oe)&&(ae(!!pe,Me.message,Xe.message,Ru.max,Ru.min),!s))return z($[N].message),$}if((p||y)&&!X&&(qo(T)||c&&Array.isArray(T))){const pe=gg(p),Oe=gg(y),Me=!uo(pe.value)&&T.length>+pe.value,Xe=!uo(Oe.value)&&T.length<+Oe.value;if((Me||Xe)&&(ae(Me,pe.message,Oe.message),!s))return z($[N].message),$}if(S&&!X&&qo(T)){const{value:pe,message:Oe}=gg(S);if(SS(pe)&&!T.match(pe)&&($[N]={type:Ru.pattern,message:Oe,ref:u,...ve(Ru.pattern,Oe)},!s))return z(Oe),$}if(k){if(lc(k)){const pe=await k(T,n),Oe=eF(pe,I);if(Oe&&($[N]={...Oe,...ve(Ru.validate,Oe.message)},!s))return z(Oe.message),$}else if(Ti(k)){let pe={};for(const Oe in k){if(!Ta(pe)&&!s)break;const Me=eF(await k[Oe](T,n),I,Oe);Me&&(pe={...Me,...ve(Oe,Me.message)},z(Me.message),s&&($[N]=pe))}if(!Ta(pe)&&($[N]={ref:I,...pe},!s))return $}}return z(!0),$};const Bue={mode:vl.onSubmit,reValidateMode:vl.onChange,shouldFocusError:!0};function que(e={}){let t={...Bue,...e},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:lc(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},s={},i=Ti(t.defaultValues)||Ti(t.values)?ws(t.defaultValues||t.values)||{}:{},c=t.shouldUnregister?{}:ws(i),u={action:!1,mount:!1,watch:!1},a={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},m,p=0;const y={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let v={...y};const j={array:K3(),state:K3()},S=t.criteriaMode===vl.all,k=Be=>rt=>{clearTimeout(p),p=setTimeout(Be,rt)},N=async Be=>{if(!t.disabled&&(y.isValid||v.isValid||Be)){const rt=t.resolver?Ta((await K()).errors):await X(s,!0);rt!==n.isValid&&j.state.next({isValid:rt})}},D=(Be,rt)=>{!t.disabled&&(y.isValidating||y.validatingFields||v.isValidating||v.validatingFields)&&((Be||Array.from(a.mount)).forEach(pt=>{pt&&(rt?zn(n.validatingFields,pt,rt):fi(n.validatingFields,pt))}),j.state.next({validatingFields:n.validatingFields,isValidating:!Ta(n.validatingFields)}))},O=(Be,rt=[],pt,Lt,Rt=!0,Ot=!0)=>{if(Lt&&pt&&!t.disabled){if(u.action=!0,Ot&&Array.isArray(Qt(s,Be))){const tr=pt(Qt(s,Be),Lt.argA,Lt.argB);Rt&&zn(s,Be,tr)}if(Ot&&Array.isArray(Qt(n.errors,Be))){const tr=pt(Qt(n.errors,Be),Lt.argA,Lt.argB);Rt&&zn(n.errors,Be,tr),$ue(n.errors,Be)}if((y.touchedFields||v.touchedFields)&&Ot&&Array.isArray(Qt(n.touchedFields,Be))){const tr=pt(Qt(n.touchedFields,Be),Lt.argA,Lt.argB);Rt&&zn(n.touchedFields,Be,tr)}(y.dirtyFields||v.dirtyFields)&&(n.dirtyFields=bg(i,c)),j.state.next({name:Be,isDirty:ae(Be,rt),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else zn(c,Be,rt)},T=(Be,rt)=>{zn(n.errors,Be,rt),j.state.next({errors:n.errors})},I=Be=>{n.errors=Be,j.state.next({errors:n.errors,isValid:!1})},z=(Be,rt,pt,Lt)=>{const Rt=Qt(s,Be);if(Rt){const Ot=Qt(c,Be,ps(pt)?Qt(i,Be):pt);ps(Ot)||Lt&&Lt.defaultChecked||rt?zn(c,Be,rt?Ot:X3(Rt._f)):Me(Be,Ot),u.mount&&!u.action&&N()}},$=(Be,rt,pt,Lt,Rt)=>{let Ot=!1,tr=!1;const tn={name:Be};if(!t.disabled){if(!pt||Lt){(y.isDirty||v.isDirty)&&(tr=n.isDirty,n.isDirty=tn.isDirty=ae(),Ot=tr!==tn.isDirty);const Sn=oc(Qt(i,Be),rt);tr=!!Qt(n.dirtyFields,Be),Sn?fi(n.dirtyFields,Be):zn(n.dirtyFields,Be,!0),tn.dirtyFields=n.dirtyFields,Ot=Ot||(y.dirtyFields||v.dirtyFields)&&tr!==!Sn}if(pt){const Sn=Qt(n.touchedFields,Be);Sn||(zn(n.touchedFields,Be,pt),tn.touchedFields=n.touchedFields,Ot=Ot||(y.touchedFields||v.touchedFields)&&Sn!==pt)}Ot&&Rt&&j.state.next(tn)}return Ot?tn:{}},V=(Be,rt,pt,Lt)=>{const Rt=Qt(n.errors,Be),Ot=(y.isValid||v.isValid)&&$o(rt)&&n.isValid!==rt;if(t.delayError&&pt?(m=k(()=>T(Be,pt)),m(t.delayError)):(clearTimeout(p),m=null,pt?zn(n.errors,Be,pt):fi(n.errors,Be)),(pt?!oc(Rt,pt):Rt)||!Ta(Lt)||Ot){const tr={...Lt,...Ot&&$o(rt)?{isValid:rt}:{},errors:n.errors,name:Be};n={...n,...tr},j.state.next(tr)}},K=async Be=>{D(Be,!0);const rt=await t.resolver(c,t.context,Iue(Be||a.mount,s,t.criteriaMode,t.shouldUseNativeValidation));return D(Be),rt},te=async Be=>{const{errors:rt}=await K(Be);if(Be)for(const pt of Be){const Lt=Qt(rt,pt);Lt?zn(n.errors,pt,Lt):fi(n.errors,pt)}else n.errors=rt;return rt},X=async(Be,rt,pt={valid:!0})=>{for(const Lt in Be){const Rt=Be[Lt];if(Rt){const{_f:Ot,...tr}=Rt;if(Ot){const tn=a.array.has(Ot.name),Sn=Rt._f&&Due(Rt._f);Sn&&y.validatingFields&&D([Ot.name],!0);const ks=await UT(Rt,a.disabled,c,S,t.shouldUseNativeValidation&&!rt,tn);if(Sn&&y.validatingFields&&D([Ot.name]),ks[Ot.name]&&(pt.valid=!1,rt))break;!rt&&(Qt(ks,Ot.name)?tn?lW(n.errors,ks,Ot.name):zn(n.errors,Ot.name,ks[Ot.name]):fi(n.errors,Ot.name))}!Ta(tr)&&await X(tr,rt,pt)}}return pt.valid},ve=()=>{for(const Be of a.unMount){const rt=Qt(s,Be);rt&&(rt._f.refs?rt._f.refs.every(pt=>!bA(pt)):!bA(rt._f.ref))&&Mt(Be)}a.unMount=new Set},ae=(Be,rt)=>!t.disabled&&(Be&&rt&&zn(c,Be,rt),!oc(tt(),i)),pe=(Be,rt,pt)=>$T(Be,a,{...u.mount?c:ps(rt)?i:qo(Be)?{[Be]:rt}:rt},pt,rt),Oe=Be=>k2(Qt(u.mount?c:i,Be,t.shouldUnregister?Qt(i,Be,[]):[])),Me=(Be,rt,pt={})=>{const Lt=Qt(s,Be);let Rt=rt;if(Lt){const Ot=Lt._f;Ot&&(!Ot.disabled&&zn(c,Be,aW(rt,Ot)),Rt=wS(Ot.ref)&&uo(rt)?"":rt,nW(Ot.ref)?[...Ot.ref.options].forEach(tr=>tr.selected=Rt.includes(tr.value)):Ot.refs?Fb(Ot.ref)?Ot.refs.forEach(tr=>{(!tr.defaultChecked||!tr.disabled)&&(Array.isArray(Rt)?tr.checked=!!Rt.find(tn=>tn===tr.value):tr.checked=Rt===tr.value||!!Rt)}):Ot.refs.forEach(tr=>tr.checked=tr.value===Rt):xI(Ot.ref)?Ot.ref.value="":(Ot.ref.value=Rt,Ot.ref.type||j.state.next({name:Be,values:ws(c)})))}(pt.shouldDirty||pt.shouldTouch)&&$(Be,Rt,pt.shouldTouch,pt.shouldDirty,!0),pt.shouldValidate&&_e(Be)},Xe=(Be,rt,pt)=>{for(const Lt in rt){if(!rt.hasOwnProperty(Lt))return;const Rt=rt[Lt],Ot=Be+"."+Lt,tr=Qt(s,Ot);(a.array.has(Be)||Ti(Rt)||tr&&!tr._f)&&!hm(Rt)?Xe(Ot,Rt,pt):Me(Ot,Rt,pt)}},Ve=(Be,rt,pt={})=>{const Lt=Qt(s,Be),Rt=a.array.has(Be),Ot=ws(rt);zn(c,Be,Ot),Rt?(j.array.next({name:Be,values:ws(c)}),(y.isDirty||y.dirtyFields||v.isDirty||v.dirtyFields)&&pt.shouldDirty&&j.state.next({name:Be,dirtyFields:bg(i,c),isDirty:ae(Be,Ot)})):Lt&&!Lt._f&&!uo(Ot)?Xe(Be,Ot,pt):Me(Be,Ot,pt),VT(Be,a)&&j.state.next({...n,name:Be}),j.state.next({name:u.mount?Be:void 0,values:ws(c)})},et=async Be=>{u.mount=!0;const rt=Be.target;let pt=rt.name,Lt=!0;const Rt=Qt(s,pt),Ot=Sn=>{Lt=Number.isNaN(Sn)||hm(Sn)&&isNaN(Sn.getTime())||oc(Sn,Qt(c,pt,Sn))},tr=Dg(t.mode),tn=Dg(t.reValidateMode);if(Rt){let Sn,ks;const Ue=rt.type?X3(Rt._f):J9(Be),ce=Be.type===jS.BLUR||Be.type===jS.FOCUS_OUT,ue=!Rue(Rt._f)&&!t.resolver&&!Qt(n.errors,pt)&&!Rt._f.deps||zue(ce,Qt(n.touchedFields,pt),n.isSubmitted,tn,tr),ye=VT(pt,a,ce);zn(c,pt,Ue),ce?(!rt||!rt.readOnly)&&(Rt._f.onBlur&&Rt._f.onBlur(Be),m&&m(0)):Rt._f.onChange&&Rt._f.onChange(Be);const Ae=$(pt,Ue,ce),Fe=!Ta(Ae)||ye;if(!ce&&j.state.next({name:pt,type:Be.type,values:ws(c)}),ue)return(y.isValid||v.isValid)&&(t.mode==="onBlur"?ce&&N():ce||N()),Fe&&j.state.next({name:pt,...ye?{}:Ae});if(!ce&&ye&&j.state.next({...n}),t.resolver){const{errors:Ye}=await K([pt]);if(Ot(Ue),Lt){const nt=J3(n.errors,s,pt),He=J3(Ye,s,nt.name||pt);Sn=He.error,pt=He.name,ks=Ta(Ye)}}else D([pt],!0),Sn=(await UT(Rt,a.disabled,c,S,t.shouldUseNativeValidation))[pt],D([pt]),Ot(Ue),Lt&&(Sn?ks=!1:(y.isValid||v.isValid)&&(ks=await X(s,!0)));Lt&&(Rt._f.deps&&(!Array.isArray(Rt._f.deps)||Rt._f.deps.length>0)&&_e(Rt._f.deps),V(pt,ks,Sn,Ae))}},Ce=(Be,rt)=>{if(Qt(n.errors,rt)&&Be.focus)return Be.focus(),1},_e=async(Be,rt={})=>{let pt,Lt;const Rt=go(Be);if(t.resolver){const Ot=await te(ps(Be)?Be:Rt);pt=Ta(Ot),Lt=Be?!Rt.some(tr=>Qt(Ot,tr)):pt}else Be?(Lt=(await Promise.all(Rt.map(async Ot=>{const tr=Qt(s,Ot);return await X(tr&&tr._f?{[Ot]:tr}:tr)}))).every(Boolean),!(!Lt&&!n.isValid)&&N()):Lt=pt=await X(s);return j.state.next({...!qo(Be)||(y.isValid||v.isValid)&&pt!==n.isValid?{}:{name:Be},...t.resolver||!Be?{isValid:pt}:{},errors:n.errors}),rt.shouldFocus&&!Lt&&Jg(s,Ce,Be?Rt:a.mount),Lt},tt=(Be,rt)=>{let pt={...u.mount?c:i};return rt&&(pt=rW(rt.dirtyFields?n.dirtyFields:n.touchedFields,pt)),ps(Be)?pt:qo(Be)?Qt(pt,Be):Be.map(Lt=>Qt(pt,Lt))},vt=(Be,rt)=>({invalid:!!Qt((rt||n).errors,Be),isDirty:!!Qt((rt||n).dirtyFields,Be),error:Qt((rt||n).errors,Be),isValidating:!!Qt(n.validatingFields,Be),isTouched:!!Qt((rt||n).touchedFields,Be)}),gt=Be=>{Be&&go(Be).forEach(rt=>fi(n.errors,rt)),j.state.next({errors:Be?n.errors:{}})},Tt=(Be,rt,pt)=>{const Lt=(Qt(s,Be,{_f:{}})._f||{}).ref,Rt=Qt(n.errors,Be)||{},{ref:Ot,message:tr,type:tn,...Sn}=Rt;zn(n.errors,Be,{...Sn,...rt,ref:Lt}),j.state.next({name:Be,errors:n.errors,isValid:!1}),pt&&pt.shouldFocus&&Lt&&Lt.focus&&Lt.focus()},Ht=(Be,rt)=>lc(Be)?j.state.subscribe({next:pt=>"values"in pt&&Be(pe(void 0,rt),pt)}):pe(Be,rt,!0),Ir=Be=>j.state.subscribe({next:rt=>{Fue(Be.name,rt.name,Be.exact)&&Lue(rt,Be.formState||y,An,Be.reRenderRoot)&&Be.callback({values:{...c},...n,...rt,defaultValues:i})}}).unsubscribe,Pr=Be=>(u.mount=!0,v={...v,...Be.formState},Ir({...Be,formState:v})),Mt=(Be,rt={})=>{for(const pt of Be?go(Be):a.mount)a.mount.delete(pt),a.array.delete(pt),rt.keepValue||(fi(s,pt),fi(c,pt)),!rt.keepError&&fi(n.errors,pt),!rt.keepDirty&&fi(n.dirtyFields,pt),!rt.keepTouched&&fi(n.touchedFields,pt),!rt.keepIsValidating&&fi(n.validatingFields,pt),!t.shouldUnregister&&!rt.keepDefaultValue&&fi(i,pt);j.state.next({values:ws(c)}),j.state.next({...n,...rt.keepDirty?{isDirty:ae()}:{}}),!rt.keepIsValid&&N()},yr=({disabled:Be,name:rt})=>{($o(Be)&&u.mount||Be||a.disabled.has(rt))&&(Be?a.disabled.add(rt):a.disabled.delete(rt))},Nt=(Be,rt={})=>{let pt=Qt(s,Be);const Lt=$o(rt.disabled)||$o(t.disabled);return zn(s,Be,{...pt||{},_f:{...pt&&pt._f?pt._f:{ref:{name:Be}},name:Be,mount:!0,...rt}}),a.mount.add(Be),pt?yr({disabled:$o(rt.disabled)?rt.disabled:t.disabled,name:Be}):z(Be,!0,rt.value),{...Lt?{disabled:rt.disabled||t.disabled}:{},...t.progressive?{required:!!rt.required,min:__(rt.min),max:__(rt.max),minLength:__(rt.minLength),maxLength:__(rt.maxLength),pattern:__(rt.pattern)}:{},name:Be,onChange:et,onBlur:et,ref:Rt=>{if(Rt){Nt(Be,rt),pt=Qt(s,Be);const Ot=ps(Rt.value)&&Rt.querySelectorAll&&Rt.querySelectorAll("input,select,textarea")[0]||Rt,tr=Tue(Ot),tn=pt._f.refs||[];if(tr?tn.find(Sn=>Sn===Ot):Ot===pt._f.ref)return;zn(s,Be,{_f:{...pt._f,...tr?{refs:[...tn.filter(bA),Ot,...Array.isArray(Qt(i,Be))?[{}]:[]],ref:{type:Ot.type,name:Be}}:{ref:Ot}}}),z(Be,!1,void 0,Ot)}else pt=Qt(s,Be,{}),pt._f&&(pt._f.mount=!1),(t.shouldUnregister||rt.shouldUnregister)&&!(eW(a.array,Be)&&u.action)&&a.unMount.add(Be)}}},Wt=()=>t.shouldFocusError&&Jg(s,Ce,a.mount),Zt=Be=>{$o(Be)&&(j.state.next({disabled:Be}),Jg(s,(rt,pt)=>{const Lt=Qt(s,pt);Lt&&(rt.disabled=Lt._f.disabled||Be,Array.isArray(Lt._f.refs)&&Lt._f.refs.forEach(Rt=>{Rt.disabled=Lt._f.disabled||Be}))},0,!1))},mt=(Be,rt)=>async pt=>{let Lt;pt&&(pt.preventDefault&&pt.preventDefault(),pt.persist&&pt.persist());let Rt=ws(c);if(j.state.next({isSubmitting:!0}),t.resolver){const{errors:Ot,values:tr}=await K();n.errors=Ot,Rt=ws(tr)}else await X(s);if(a.disabled.size)for(const Ot of a.disabled)fi(Rt,Ot);if(fi(n.errors,"root"),Ta(n.errors)){j.state.next({errors:{}});try{await Be(Rt,pt)}catch(Ot){Lt=Ot}}else rt&&await rt({...n.errors},pt),Wt(),setTimeout(Wt);if(j.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Ta(n.errors)&&!Lt,submitCount:n.submitCount+1,errors:n.errors}),Lt)throw Lt},qr=(Be,rt={})=>{Qt(s,Be)&&(ps(rt.defaultValue)?Ve(Be,ws(Qt(i,Be))):(Ve(Be,rt.defaultValue),zn(i,Be,ws(rt.defaultValue))),rt.keepTouched||fi(n.touchedFields,Be),rt.keepDirty||(fi(n.dirtyFields,Be),n.isDirty=rt.defaultValue?ae(Be,ws(Qt(i,Be))):ae()),rt.keepError||(fi(n.errors,Be),y.isValid&&N()),j.state.next({...n}))},ar=(Be,rt={})=>{const pt=Be?ws(Be):i,Lt=ws(pt),Rt=Ta(Be),Ot=Rt?i:Lt;if(rt.keepDefaultValues||(i=pt),!rt.keepValues){if(rt.keepDirtyValues){const tr=new Set([...a.mount,...Object.keys(bg(i,c))]);for(const tn of Array.from(tr))Qt(n.dirtyFields,tn)?zn(Ot,tn,Qt(c,tn)):Ve(tn,Qt(Ot,tn))}else{if(hI&&ps(Be))for(const tr of a.mount){const tn=Qt(s,tr);if(tn&&tn._f){const Sn=Array.isArray(tn._f.refs)?tn._f.refs[0]:tn._f.ref;if(wS(Sn)){const ks=Sn.closest("form");if(ks){ks.reset();break}}}}if(rt.keepFieldsRef)for(const tr of a.mount)Ve(tr,Qt(Ot,tr));else s={}}c=t.shouldUnregister?rt.keepDefaultValues?ws(i):{}:ws(Ot),j.array.next({values:{...Ot}}),j.state.next({values:{...Ot}})}a={mount:rt.keepDirtyValues?a.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},u.mount=!y.isValid||!!rt.keepIsValid||!!rt.keepDirtyValues||!t.shouldUnregister&&!Ta(Ot),u.watch=!!t.shouldUnregister,j.state.next({submitCount:rt.keepSubmitCount?n.submitCount:0,isDirty:Rt?!1:rt.keepDirty?n.isDirty:!!(rt.keepDefaultValues&&!oc(Be,i)),isSubmitted:rt.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:Rt?{}:rt.keepDirtyValues?rt.keepDefaultValues&&c?bg(i,c):n.dirtyFields:rt.keepDefaultValues&&Be?bg(i,Be):rt.keepDirty?n.dirtyFields:{},touchedFields:rt.keepTouched?n.touchedFields:{},errors:rt.keepErrors?n.errors:{},isSubmitSuccessful:rt.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:i})},en=(Be,rt)=>ar(lc(Be)?Be(c):Be,rt),Lr=(Be,rt={})=>{const pt=Qt(s,Be),Lt=pt&&pt._f;if(Lt){const Rt=Lt.refs?Lt.refs[0]:Lt.ref;Rt.focus&&(Rt.focus(),rt.shouldSelect&&lc(Rt.select)&&Rt.select())}},An=Be=>{n={...n,...Be}},Wn={control:{register:Nt,unregister:Mt,getFieldState:vt,handleSubmit:mt,setError:Tt,_subscribe:Ir,_runSchema:K,_focusError:Wt,_getWatch:pe,_getDirty:ae,_setValid:N,_setFieldArray:O,_setDisabledField:yr,_setErrors:I,_getFieldArray:Oe,_reset:ar,_resetDefaultValues:()=>lc(t.defaultValues)&&t.defaultValues().then(Be=>{en(Be,t.resetOptions),j.state.next({isLoading:!1})}),_removeUnmounted:ve,_disableForm:Zt,_subjects:j,_proxyFormState:y,get _fields(){return s},get _formValues(){return c},get _state(){return u},set _state(Be){u=Be},get _defaultValues(){return i},get _names(){return a},set _names(Be){a=Be},get _formState(){return n},get _options(){return t},set _options(Be){t={...t,...Be}}},subscribe:Pr,trigger:_e,register:Nt,handleSubmit:mt,watch:Ht,setValue:Ve,getValues:tt,reset:en,resetField:qr,clearErrors:gt,unregister:Mt,setError:Tt,setFocus:Lr,getFieldState:vt};return{...Wn,formControl:Wn}}var sh=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const e=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const n=(Math.random()*16+e)%16|0;return(t=="x"?n:n&3|8).toString(16)})},jA=(e,t,n={})=>n.shouldFocus||ps(n.shouldFocus)?n.focusName||`${e}.${ps(n.focusIndex)?t:n.focusIndex}.`:"",wA=(e,t)=>[...e,...go(t)],SA=e=>Array.isArray(e)?e.map(()=>{}):void 0;function NA(e,t,n){return[...e.slice(0,t),...go(n),...e.slice(t)]}var PA=(e,t,n)=>Array.isArray(e)?(ps(e[n])&&(e[n]=void 0),e.splice(n,0,e.splice(t,1)[0]),e):[],CA=(e,t)=>[...go(t),...go(e)];function Vue(e,t){let n=0;const s=[...e];for(const i of t)s.splice(i-n,1),n++;return k2(s).length?s:[]}var AA=(e,t)=>ps(t)?[]:Vue(e,go(t).sort((n,s)=>n-s)),kA=(e,t,n)=>{[e[t],e[n]]=[e[n],e[t]]},tF=(e,t,n)=>(e[t]=n,e);function vI(e){const t=zb(),{control:n=t.control,name:s,keyName:i="id",shouldUnregister:c,rules:u}=e,[a,m]=de.useState(n._getFieldArray(s)),p=de.useRef(n._getFieldArray(s).map(sh)),y=de.useRef(!1);n._names.array.add(s),de.useMemo(()=>u&&a.length>=0&&n.register(s,u),[n,s,a.length,u]),T2(()=>n._subjects.array.subscribe({next:({values:z,name:$})=>{if($===s||!$){const V=Qt(z,s);Array.isArray(V)&&(m(V),p.current=V.map(sh))}}}).unsubscribe,[n,s]);const v=de.useCallback(z=>{y.current=!0,n._setFieldArray(s,z)},[n,s]),j=(z,$)=>{const V=go(ws(z)),K=wA(n._getFieldArray(s),V);n._names.focus=jA(s,K.length-1,$),p.current=wA(p.current,V.map(sh)),v(K),m(K),n._setFieldArray(s,K,wA,{argA:SA(z)})},S=(z,$)=>{const V=go(ws(z)),K=CA(n._getFieldArray(s),V);n._names.focus=jA(s,0,$),p.current=CA(p.current,V.map(sh)),v(K),m(K),n._setFieldArray(s,K,CA,{argA:SA(z)})},k=z=>{const $=AA(n._getFieldArray(s),z);p.current=AA(p.current,z),v($),m($),!Array.isArray(Qt(n._fields,s))&&zn(n._fields,s,void 0),n._setFieldArray(s,$,AA,{argA:z})},N=(z,$,V)=>{const K=go(ws($)),te=NA(n._getFieldArray(s),z,K);n._names.focus=jA(s,z,V),p.current=NA(p.current,z,K.map(sh)),v(te),m(te),n._setFieldArray(s,te,NA,{argA:z,argB:SA($)})},D=(z,$)=>{const V=n._getFieldArray(s);kA(V,z,$),kA(p.current,z,$),v(V),m(V),n._setFieldArray(s,V,kA,{argA:z,argB:$},!1)},O=(z,$)=>{const V=n._getFieldArray(s);PA(V,z,$),PA(p.current,z,$),v(V),m(V),n._setFieldArray(s,V,PA,{argA:z,argB:$},!1)},T=(z,$)=>{const V=ws($),K=tF(n._getFieldArray(s),z,V);p.current=[...K].map((te,X)=>!te||X===z?sh():p.current[X]),v(K),m([...K]),n._setFieldArray(s,K,tF,{argA:z,argB:V},!0,!1)},I=z=>{const $=go(ws(z));p.current=$.map(sh),v([...$]),m([...$]),n._setFieldArray(s,[...$],V=>V,{},!0,!1)};return de.useEffect(()=>{if(n._state.action=!1,VT(s,n._names)&&n._subjects.state.next({...n._formState}),y.current&&(!Dg(n._options.mode).isOnSubmit||n._formState.isSubmitted)&&!Dg(n._options.reValidateMode).isOnSubmit)if(n._options.resolver)n._runSchema([s]).then(z=>{const $=Qt(z.errors,s),V=Qt(n._formState.errors,s);(V?!$&&V.type||$&&(V.type!==$.type||V.message!==$.message):$&&$.type)&&($?zn(n._formState.errors,s,$):fi(n._formState.errors,s),n._subjects.state.next({errors:n._formState.errors}))});else{const z=Qt(n._fields,s);z&&z._f&&!(Dg(n._options.reValidateMode).isOnSubmit&&Dg(n._options.mode).isOnSubmit)&&UT(z,n._names.disabled,n._formValues,n._options.criteriaMode===vl.all,n._options.shouldUseNativeValidation,!0).then($=>!Ta($)&&n._subjects.state.next({errors:lW(n._formState.errors,$,s)}))}n._subjects.state.next({name:s,values:ws(n._formValues)}),n._names.focus&&Jg(n._fields,(z,$)=>{if(n._names.focus&&$.startsWith(n._names.focus)&&z.focus)return z.focus(),1}),n._names.focus="",n._setValid(),y.current=!1},[a,s,n]),de.useEffect(()=>(!Qt(n._formValues,s)&&n._setFieldArray(s),()=>{const z=($,V)=>{const K=Qt(n._fields,$);K&&K._f&&(K._f.mount=V)};n._options.shouldUnregister||c?n.unregister(s):z(s,!1)}),[s,n,i,c]),{swap:de.useCallback(D,[v,s,n]),move:de.useCallback(O,[v,s,n]),prepend:de.useCallback(S,[v,s,n]),append:de.useCallback(j,[v,s,n]),remove:de.useCallback(k,[v,s,n]),insert:de.useCallback(N,[v,s,n]),update:de.useCallback(T,[v,s,n]),replace:de.useCallback(I,[v,s,n]),fields:de.useMemo(()=>a.map((z,$)=>({...z,[i]:p.current[$]||sh()})),[a,i])}}function ia(e={}){const t=de.useRef(void 0),n=de.useRef(void 0),[s,i]=de.useState({isDirty:!1,isValidating:!1,isLoading:lc(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:lc(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:s},e.defaultValues&&!lc(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:u,...a}=que(e);t.current={...a,formState:s}}const c=t.current.control;return c._options=e,T2(()=>{const u=c._subscribe({formState:c._proxyFormState,callback:()=>i({...c._formState}),reRenderRoot:!0});return i(a=>({...a,isReady:!0})),c._formState.isReady=!0,u},[c]),de.useEffect(()=>c._disableForm(e.disabled),[c,e.disabled]),de.useEffect(()=>{e.mode&&(c._options.mode=e.mode),e.reValidateMode&&(c._options.reValidateMode=e.reValidateMode)},[c,e.mode,e.reValidateMode]),de.useEffect(()=>{e.errors&&(c._setErrors(e.errors),c._focusError())},[c,e.errors]),de.useEffect(()=>{e.shouldUnregister&&c._subjects.state.next({values:c._getWatch()})},[c,e.shouldUnregister]),de.useEffect(()=>{if(c._proxyFormState.isDirty){const u=c._getDirty();u!==s.isDirty&&c._subjects.state.next({isDirty:u})}},[c,s.isDirty]),de.useEffect(()=>{var u;e.values&&!oc(e.values,n.current)?(c._reset(e.values,{keepFieldsRef:!0,...c._options.resetOptions}),!((u=c._options.resetOptions)===null||u===void 0)&&u.keepIsValid||c._setValid(),n.current=e.values,i(a=>({...a}))):c._resetDefaultValues()},[c,e.values]),de.useEffect(()=>{c._state.mount||(c._setValid(),c._state.mount=!0),c._state.watch&&(c._state.watch=!1,c._subjects.state.next({...c._formState})),c._removeUnmounted()}),t.current.formState=tW(s,c),t.current}function Uue({open:e,onOpenChange:t,asset:n}){var D,O;const s=br(),i=!!n,{register:c,handleSubmit:u,reset:a,setValue:m,watch:p,formState:{errors:y}}=ia({defaultValues:n?{class_id:n.class_id,parent_id:n.parent_id||void 0,scheme_id:n.scheme_id||void 0,dma_id:n.dma_id||void 0,code:n.code,name:n.name,status:n.status,manufacturer:n.manufacturer||void 0,model:n.model||void 0,serial:n.serial||void 0,install_date:n.install_date||void 0,barcode:n.barcode||void 0}:{status:"active"}}),{data:v}=ht({queryKey:["asset-classes"],queryFn:()=>dc.getClasses()}),{data:j}=ht({queryKey:["assets-for-parent"],queryFn:()=>dc.getAssets({per_page:200})}),S=jt({mutationFn:T=>dc.createAsset(T),onSuccess:()=>{s.invalidateQueries({queryKey:["assets"]}),qe.success("Asset created successfully"),t(!1),a()},onError:T=>{var I,z;qe.error(((z=(I=T.response)==null?void 0:I.data)==null?void 0:z.message)||"Failed to create asset")}}),k=jt({mutationFn:T=>dc.updateAsset(n.id,T),onSuccess:()=>{s.invalidateQueries({queryKey:["assets"]}),s.invalidateQueries({queryKey:["asset",n.id]}),qe.success("Asset updated successfully"),t(!1)},onError:T=>{var I,z;qe.error(((z=(I=T.response)==null?void 0:I.data)==null?void 0:z.message)||"Failed to update asset")}}),N=T=>{i?k.mutate(T):S.mutate(T)};return R.useEffect(()=>{n?Object.keys(n).forEach(T=>{m(T,n[T])}):a({status:"active"})},[n,m,a]),r.jsx(Rr,{open:e,onOpenChange:t,children:r.jsxs(Er,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:i?"Edit Asset":"Create New Asset"}),r.jsx(Bs,{children:i?"Update asset information":"Add a new asset to the registry"})]}),r.jsxs("form",{onSubmit:u(N),className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"class_id",children:"Asset Class *"}),r.jsxs(Jt,{onValueChange:T=>m("class_id",Number(T)),defaultValue:(D=n==null?void 0:n.class_id)==null?void 0:D.toString(),children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select class"})}),r.jsx(Xt,{children:v==null?void 0:v.map(T=>r.jsx(ke,{value:T.id.toString(),children:T.name},T.id))})]}),y.class_id&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"parent_id",children:"Parent Asset"}),r.jsxs(Jt,{onValueChange:T=>m("parent_id",T&&T!=="none"?Number(T):void 0),defaultValue:((O=n==null?void 0:n.parent_id)==null?void 0:O.toString())||"none",children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"None"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"none",children:"None"}),j==null?void 0:j.data.filter(T=>T.id!==(n==null?void 0:n.id)).map(T=>r.jsxs(ke,{value:T.id.toString(),children:[T.code," - ",T.name]},T.id))]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"code",children:"Asset Code *"}),r.jsx(Ge,{id:"code",...c("code",{required:!0}),placeholder:"e.g., PUMP-001"}),y.code&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"name",children:"Asset Name *"}),r.jsx(Ge,{id:"name",...c("name",{required:!0}),placeholder:"e.g., Main Borehole Pump"}),y.name&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"status",children:"Status *"}),r.jsxs(Jt,{onValueChange:T=>m("status",T),defaultValue:(n==null?void 0:n.status)||"active",children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"active",children:"Active"}),r.jsx(ke,{value:"inactive",children:"Inactive"}),r.jsx(ke,{value:"under_maintenance",children:"Under Maintenance"}),r.jsx(ke,{value:"retired",children:"Retired"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"manufacturer",children:"Manufacturer"}),r.jsx(Ge,{id:"manufacturer",...c("manufacturer")})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"model",children:"Model"}),r.jsx(Ge,{id:"model",...c("model")})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"serial",children:"Serial Number"}),r.jsx(Ge,{id:"serial",...c("serial")})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"install_date",children:"Installation Date"}),r.jsx(Ge,{id:"install_date",type:"date",...c("install_date")})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"barcode",children:"Barcode"}),r.jsx(Ge,{id:"barcode",...c("barcode")})]})]}),r.jsxs(Ai,{children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:S.isPending||k.isPending,children:S.isPending||k.isPending?"Saving...":i?"Update":"Create"})]})]})]})})}const Wue=[{value:"none",label:"All Statuses"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"retired",label:"Retired"},{value:"under_maintenance",label:"Under Maintenance"}],Gue={active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",retired:"bg-red-100 text-red-800",under_maintenance:"bg-yellow-100 text-yellow-800"};function Kue(){var S;const[e,t]=R.useState({per_page:15,page:1}),[n,s]=R.useState(!1),[i,c]=R.useState(),{data:u}=ht({queryKey:["asset-classes"],queryFn:()=>dc.getClasses()}),{data:a,isLoading:m,error:p}=ht({queryKey:["assets",e],queryFn:()=>dc.getAssets(e)}),y=k=>{t({...e,search:k,page:1})},v=k=>{t({...e,status:k&&k!=="none"?k:void 0,page:1})},j=k=>{t({...e,class_id:k&&k!=="none"?Number(k):void 0,page:1})};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Assets"}),r.jsx("p",{className:"text-muted-foreground",children:"Manage infrastructure assets and equipment"})]}),r.jsxs(se,{onClick:()=>{c(void 0),s(!0)},children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Add Asset"]})]}),m&&!a?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading assets..."})}):p?r.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:r.jsxs("p",{className:"text-lg text-destructive",children:["Error loading assets: ",p.message]})}):r.jsxs(r.Fragment,{children:[r.jsx(J,{children:r.jsxs(ie,{className:"pt-6",children:[r.jsxs("div",{className:"flex gap-4 mb-6",children:[r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"relative",children:[r.jsx(ci,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Search by code, name, or serial...",className:"pl-9",value:e.search||"",onChange:k=>y(k.target.value)})]})}),r.jsxs(Jt,{value:e.status||"",onValueChange:v,children:[r.jsx(Yt,{className:"w-[200px]",children:r.jsx(er,{placeholder:"Filter by status"})}),r.jsx(Xt,{children:Wue.map(k=>r.jsx(ke,{value:k.value,children:k.label},k.value))})]}),r.jsxs(Jt,{value:((S=e.class_id)==null?void 0:S.toString())||"none",onValueChange:j,children:[r.jsx(Yt,{className:"w-[200px]",children:r.jsx(er,{placeholder:"Filter by class"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"none",children:"All Classes"}),u==null?void 0:u.map(k=>r.jsx(ke,{value:k.id.toString(),children:k.name},k.id))]})]})]}),r.jsx("div",{className:"border rounded-lg",children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Code"}),r.jsx(le,{children:"Name"}),r.jsx(le,{children:"Class"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Manufacturer"}),r.jsx(le,{children:"Install Date"}),r.jsx(le,{className:"text-right",children:"Actions"})]})}),r.jsx(ur,{children:a==null?void 0:a.data.map(k=>{var N;return r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:k.code}),r.jsx(ne,{children:r.jsxs("div",{className:"flex items-center gap-2",children:[k.geom&&r.jsx(jo,{className:"h-4 w-4 text-muted-foreground"}),k.name]})}),r.jsx(ne,{children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ai,{className:"h-4 w-4 text-muted-foreground"}),((N=k.asset_class)==null?void 0:N.name)||"Unknown"]})}),r.jsx(ne,{children:r.jsx(We,{className:Gue[k.status],children:k.status.replace("_"," ")})}),r.jsx(ne,{className:"text-muted-foreground",children:k.manufacturer||"-"}),r.jsx(ne,{className:"text-muted-foreground",children:k.install_date?new Date(k.install_date).toLocaleDateString():"-"}),r.jsx(ne,{className:"text-right",children:r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(mc,{to:`/cmms/assets/${k.id}`,children:r.jsx(se,{variant:"ghost",size:"sm",children:"View"})}),r.jsx(se,{variant:"ghost",size:"sm",onClick:()=>{c(k),s(!0)},children:r.jsx(vd,{className:"h-4 w-4"})})]})})]},k.id)})})]})}),(a==null?void 0:a.data.length)===0&&r.jsxs("div",{className:"flex flex-col items-center justify-center p-12",children:[r.jsx(ai,{className:"h-12 w-12 text-muted-foreground mb-4"}),r.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No assets found"}),r.jsxs(se,{onClick:()=>{c(void 0),s(!0)},children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Add Your First Asset"]})]}),a&&a.total>0&&r.jsxs("div",{className:"flex items-center justify-between mt-4",children:[r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",a.from," to ",a.to," of ",a.total," assets"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:"outline",size:"sm",disabled:a.current_page===1,onClick:()=>t({...e,page:(e.page||1)-1}),children:"Previous"}),r.jsx(se,{variant:"outline",size:"sm",disabled:a.current_page===a.last_page,onClick:()=>t({...e,page:(e.page||1)+1}),children:"Next"})]})]})]})}),r.jsx(Uue,{open:n,onOpenChange:k=>{s(k),k||c(void 0)},asset:i})]})]})}const Hue={active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",retired:"bg-red-100 text-red-800",under_maintenance:"bg-yellow-100 text-yellow-800"},Zue={open:"bg-blue-100 text-blue-800",assigned:"bg-purple-100 text-purple-800",in_progress:"bg-yellow-100 text-yellow-800",completed:"bg-green-100 text-green-800",cancelled:"bg-gray-100 text-gray-800"};function Yue(){var u,a,m,p;const{id:e}=AO(),t=Number(e),{data:n,isLoading:s,error:i}=ht({queryKey:["asset",t],queryFn:()=>dc.getAsset(t),enabled:!!t&&!isNaN(t)}),{data:c}=ht({queryKey:["asset-maintenance",t],queryFn:()=>dc.getAssetMaintenanceHistory(t),enabled:!!t&&!isNaN(t)});return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(mc,{to:"/cmms/assets",children:r.jsxs(se,{variant:"ghost",size:"sm",children:[r.jsx(Uq,{className:"mr-2 h-4 w-4"}),"Back to Assets"]})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:(n==null?void 0:n.name)||"Asset Details"}),r.jsx("p",{className:"text-muted-foreground",children:(n==null?void 0:n.code)||""})]})]}),n&&r.jsx(We,{className:Hue[n.status],children:n.status.replace("_"," ")})]}),s&&!n?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading asset details..."})}):i?r.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:r.jsxs("p",{className:"text-lg text-destructive",children:["Error loading asset: ",i.message]})}):n?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r.jsxs(J,{className:"md:col-span-2",children:[r.jsx(ge,{children:r.jsx(xe,{children:"Asset Information"})}),r.jsx(ie,{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Asset Code"}),r.jsx("p",{className:"font-medium",children:n.code})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Asset Class"}),r.jsxs("p",{className:"font-medium flex items-center gap-2",children:[r.jsx(ai,{className:"h-4 w-4 text-muted-foreground"}),((u=n.asset_class)==null?void 0:u.name)||"Unknown"]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Manufacturer"}),r.jsx("p",{className:"font-medium",children:n.manufacturer||"-"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Model"}),r.jsx("p",{className:"font-medium",children:n.model||"-"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Serial Number"}),r.jsx("p",{className:"font-medium",children:n.serial||"-"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Installation Date"}),r.jsx("p",{className:"font-medium",children:n.install_date?new Date(n.install_date).toLocaleDateString():"-"})]}),n.scheme&&r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Scheme"}),r.jsx("p",{className:"font-medium",children:n.scheme.name})]}),n.dma&&r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"DMA"}),r.jsx("p",{className:"font-medium",children:n.dma.name})]}),n.geom&&r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Location"}),r.jsxs("p",{className:"font-medium flex items-center gap-2",children:[r.jsx(jo,{className:"h-4 w-4 text-muted-foreground"}),n.geom.coordinates[1].toFixed(6),", ",n.geom.coordinates[0].toFixed(6)]})]})]})})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Quick Stats"})}),r.jsxs(ie,{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(xs,{className:"h-4 w-4 text-muted-foreground"}),r.jsx("span",{className:"text-sm",children:"Open Work Orders"})]}),r.jsx(We,{variant:"outline",children:((a=n.work_orders)==null?void 0:a.filter(y=>y.status!=="completed"&&y.status!=="cancelled").length)||0})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(os,{className:"h-4 w-4 text-muted-foreground"}),r.jsx("span",{className:"text-sm",children:"Completed WOs"})]}),r.jsx(We,{variant:"outline",children:((m=n.work_orders)==null?void 0:m.filter(y=>y.status==="completed").length)||0})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ei,{className:"h-4 w-4 text-muted-foreground"}),r.jsx("span",{className:"text-sm",children:"Total WOs"})]}),r.jsx(We,{variant:"outline",children:((p=n.work_orders)==null?void 0:p.length)||0})]})]})]}),n.parent&&r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Parent Asset"})}),r.jsx(ie,{children:r.jsx(mc,{to:`/cmms/assets/${n.parent.id}`,children:r.jsxs("div",{className:"text-sm",children:[r.jsx("p",{className:"font-medium",children:n.parent.name}),r.jsx("p",{className:"text-muted-foreground",children:n.parent.code})]})})})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Work Orders"})}),r.jsx(ie,{children:n.work_orders&&n.work_orders.length>0?r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"WO #"}),r.jsx(le,{children:"Title"}),r.jsx(le,{children:"Type"}),r.jsx(le,{children:"Priority"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Scheduled"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:n.work_orders.map(y=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:y.wo_num}),r.jsx(ne,{children:y.title}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",className:"uppercase",children:y.kind})}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",className:"capitalize",children:y.priority})}),r.jsx(ne,{children:r.jsx(We,{className:Zue[y.status],children:y.status.replace("_"," ")})}),r.jsx(ne,{className:"text-muted-foreground",children:y.scheduled_for?new Date(y.scheduled_for).toLocaleDateString():"-"}),r.jsx(ne,{children:r.jsx(mc,{to:`/cmms/work-orders/${y.id}`,children:r.jsx(se,{variant:"ghost",size:"sm",children:"View"})})})]},y.id))})]}):r.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No work orders found for this asset"})})]}),c&&c.length>0&&r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Maintenance History"})}),r.jsx(ie,{children:r.jsx("div",{className:"space-y-4",children:c.map(y=>r.jsxs("div",{className:"border-l-2 border-gray-200 pl-4 pb-4",children:[r.jsx("p",{className:"font-medium",children:y.description||y.title}),r.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(y.completed_at||y.created_at).toLocaleDateString()}),y.notes&&r.jsx("p",{className:"text-sm mt-2",children:y.notes})]},y.id))})})]})]}):r.jsx("div",{className:"p-6 bg-yellow-100 border border-yellow-600 rounded-lg",children:r.jsx("p",{className:"text-lg text-yellow-800",children:"Asset not found"})})]})}function Xue({open:e,onOpenChange:t,workOrder:n}){var k;const s=br(),i=!!n,{register:c,handleSubmit:u,reset:a,setValue:m,formState:{errors:p}}=ia({defaultValues:n?{kind:n.kind,asset_id:n.asset_id||void 0,title:n.title,description:n.description||void 0,priority:n.priority,scheduled_for:n.scheduled_for||void 0,assigned_to:n.assigned_to||void 0,pm_policy_id:n.pm_policy_id||void 0}:{kind:"cm",priority:"medium"}}),{data:y}=ht({queryKey:["assets-for-wo"],queryFn:()=>dc.getAssets({per_page:200})}),v=jt({mutationFn:N=>Qg.createWorkOrder(N),onSuccess:()=>{s.invalidateQueries({queryKey:["work-orders"]}),qe.success("Work order created successfully"),t(!1),a()},onError:N=>{var D,O;qe.error(((O=(D=N.response)==null?void 0:D.data)==null?void 0:O.message)||"Failed to create work order")}}),j=jt({mutationFn:N=>Qg.updateWorkOrder(n.id,N),onSuccess:()=>{s.invalidateQueries({queryKey:["work-orders"]}),s.invalidateQueries({queryKey:["work-order",n.id]}),qe.success("Work order updated successfully"),t(!1)},onError:N=>{var D,O;qe.error(((O=(D=N.response)==null?void 0:D.data)==null?void 0:O.message)||"Failed to update work order")}}),S=N=>{i?j.mutate(N):v.mutate(N)};return R.useEffect(()=>{n?Object.keys(n).forEach(N=>{m(N,n[N])}):a({kind:"cm",priority:"medium"})},[n,m,a]),r.jsx(Rr,{open:e,onOpenChange:t,children:r.jsxs(Er,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:i?"Edit Work Order":"Create New Work Order"}),r.jsx(Bs,{children:i?"Update work order details":"Schedule a new maintenance task"})]}),r.jsxs("form",{onSubmit:u(S),className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"kind",children:"Type *"}),r.jsxs(Jt,{onValueChange:N=>m("kind",N),defaultValue:(n==null?void 0:n.kind)||"cm",children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"pm",children:"Preventive Maintenance"}),r.jsx(ke,{value:"cm",children:"Corrective Maintenance"}),r.jsx(ke,{value:"emergency",children:"Emergency"}),r.jsx(ke,{value:"project",children:"Project"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"priority",children:"Priority *"}),r.jsxs(Jt,{onValueChange:N=>m("priority",N),defaultValue:(n==null?void 0:n.priority)||"medium",children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"low",children:"Low"}),r.jsx(ke,{value:"medium",children:"Medium"}),r.jsx(ke,{value:"high",children:"High"}),r.jsx(ke,{value:"critical",children:"Critical"})]})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"asset_id",children:"Related Asset"}),r.jsxs(Jt,{onValueChange:N=>m("asset_id",N&&N!=="none"?Number(N):void 0),defaultValue:((k=n==null?void 0:n.asset_id)==null?void 0:k.toString())||"none",children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select asset (optional)"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"none",children:"None"}),y==null?void 0:y.data.map(N=>r.jsxs(ke,{value:N.id.toString(),children:[N.code," - ",N.name]},N.id))]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"title",children:"Title *"}),r.jsx(Ge,{id:"title",...c("title",{required:!0}),placeholder:"e.g., Replace pump motor"}),p.title&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"description",children:"Description"}),r.jsx(Fs,{id:"description",...c("description"),placeholder:"Detailed description of the work to be done...",rows:4})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"scheduled_for",children:"Scheduled Date"}),r.jsx(Ge,{id:"scheduled_for",type:"datetime-local",...c("scheduled_for")})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"assigned_to",children:"Assign To (User ID)"}),r.jsx(Ge,{id:"assigned_to",...c("assigned_to"),placeholder:"User UUID"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter user ID to assign this work order"})]})]}),r.jsxs(Ai,{children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:v.isPending||j.isPending,children:v.isPending||j.isPending?"Saving...":i?"Update":"Create"})]})]})]})})}const Que=[{value:"none",label:"All Statuses"},{value:"open",label:"Open"},{value:"assigned",label:"Assigned"},{value:"in_progress",label:"In Progress"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}],Jue=[{value:"none",label:"All Types"},{value:"pm",label:"Preventive Maintenance"},{value:"cm",label:"Corrective Maintenance"},{value:"emergency",label:"Emergency"},{value:"project",label:"Project"}],ede=[{value:"none",label:"All Priorities"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],tde={open:"bg-blue-100 text-blue-800",assigned:"bg-purple-100 text-purple-800",in_progress:"bg-yellow-100 text-yellow-800",completed:"bg-green-100 text-green-800",cancelled:"bg-gray-100 text-gray-800"},rde={low:"bg-gray-100 text-gray-800",medium:"bg-blue-100 text-blue-800",high:"bg-orange-100 text-orange-800",critical:"bg-red-100 text-red-800"};function nde(){const[e,t]=R.useState({per_page:15,page:1}),[n,s]=R.useState(!1),[i,c]=R.useState(),{data:u,isLoading:a,error:m}=ht({queryKey:["work-orders",e],queryFn:()=>Qg.getWorkOrders(e)}),p=S=>{t({...e,search:S,page:1})},y=S=>{t({...e,status:S&&S!=="none"?S:void 0,page:1})},v=S=>{t({...e,kind:S&&S!=="none"?S:void 0,page:1})},j=S=>{t({...e,priority:S&&S!=="none"?S:void 0,page:1})};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Work Orders"}),r.jsx("p",{className:"text-muted-foreground",children:"Track maintenance and repair tasks"})]}),r.jsxs(se,{onClick:()=>{c(void 0),s(!0)},children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Create Work Order"]})]}),a&&!u?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading work orders..."})}):m?r.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:r.jsxs("p",{className:"text-lg text-destructive",children:["Error loading work orders: ",m.message]})}):r.jsxs(r.Fragment,{children:[r.jsx(J,{children:r.jsxs(ie,{className:"pt-6",children:[r.jsxs("div",{className:"flex gap-4 mb-6 flex-wrap",children:[r.jsx("div",{className:"flex-1 min-w-[200px]",children:r.jsxs("div",{className:"relative",children:[r.jsx(ci,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Search by WO number or title...",className:"pl-9",value:e.search||"",onChange:S=>p(S.target.value)})]})}),r.jsxs(Jt,{value:e.status||"",onValueChange:y,children:[r.jsx(Yt,{className:"w-[160px]",children:r.jsx(er,{placeholder:"Status"})}),r.jsx(Xt,{children:Que.map(S=>r.jsx(ke,{value:S.value,children:S.label},S.value))})]}),r.jsxs(Jt,{value:e.kind||"",onValueChange:v,children:[r.jsx(Yt,{className:"w-[160px]",children:r.jsx(er,{placeholder:"Type"})}),r.jsx(Xt,{children:Jue.map(S=>r.jsx(ke,{value:S.value,children:S.label},S.value))})]}),r.jsxs(Jt,{value:e.priority||"",onValueChange:j,children:[r.jsx(Yt,{className:"w-[160px]",children:r.jsx(er,{placeholder:"Priority"})}),r.jsx(Xt,{children:ede.map(S=>r.jsx(ke,{value:S.value,children:S.label},S.value))})]})]}),r.jsx("div",{className:"border rounded-lg",children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"WO #"}),r.jsx(le,{children:"Title"}),r.jsx(le,{children:"Asset"}),r.jsx(le,{children:"Type"}),r.jsx(le,{children:"Priority"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Assigned To"}),r.jsx(le,{children:"Scheduled"}),r.jsx(le,{className:"text-right",children:"Actions"})]})}),r.jsx(ur,{children:u==null?void 0:u.data.map(S=>{var k,N;return r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:S.wo_num}),r.jsx(ne,{children:r.jsx("div",{className:"max-w-[200px] truncate",children:S.title})}),r.jsx(ne,{className:"text-muted-foreground",children:((k=S.asset)==null?void 0:k.name)||"-"}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",className:"uppercase",children:S.kind})}),r.jsx(ne,{children:r.jsx(We,{className:rde[S.priority],children:S.priority})}),r.jsx(ne,{children:r.jsx(We,{className:tde[S.status],children:S.status.replace("_"," ")})}),r.jsx(ne,{className:"text-muted-foreground",children:((N=S.assigned_to_user)==null?void 0:N.name)||"Unassigned"}),r.jsx(ne,{className:"text-muted-foreground",children:S.scheduled_for?new Date(S.scheduled_for).toLocaleDateString():"-"}),r.jsx(ne,{className:"text-right",children:r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(mc,{to:`/cmms/work-orders/${S.id}`,children:r.jsx(se,{variant:"ghost",size:"sm",children:"View"})}),r.jsx(se,{variant:"ghost",size:"sm",onClick:()=>{c(S),s(!0)},children:r.jsx(vd,{className:"h-4 w-4"})})]})})]},S.id)})})]})}),(u==null?void 0:u.data.length)===0&&r.jsxs("div",{className:"flex flex-col items-center justify-center p-12",children:[r.jsx(ei,{className:"h-12 w-12 text-muted-foreground mb-4"}),r.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No work orders found"}),r.jsxs(se,{onClick:()=>{c(void 0),s(!0)},children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Create Your First Work Order"]})]}),u&&u.total>0&&r.jsxs("div",{className:"flex items-center justify-between mt-4",children:[r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",u.from," to ",u.to," of ",u.total," work orders"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:"outline",size:"sm",disabled:u.current_page===1,onClick:()=>t({...e,page:(e.page||1)-1}),children:"Previous"}),r.jsx(se,{variant:"outline",size:"sm",disabled:u.current_page===u.last_page,onClick:()=>t({...e,page:(e.page||1)+1}),children:"Next"})]})]})]})}),r.jsx(Xue,{open:n,onOpenChange:S=>{s(S),S||c(void 0)},workOrder:i})]})]})}function sde({open:e,onOpenChange:t,part:n}){const s=br(),i=!!n,{register:c,handleSubmit:u,reset:a,formState:{errors:m}}=ia({defaultValues:n?{code:n.code,name:n.name,category:n.category,description:n.description||void 0,unit:n.unit,unit_cost:n.unit_cost||void 0,reorder_level:n.reorder_level||void 0,supplier_id:n.supplier_id||void 0}:{}}),p=jt({mutationFn:j=>bS.createPart(j),onSuccess:()=>{s.invalidateQueries({queryKey:["parts"]}),qe.success("Part created successfully"),t(!1),a()},onError:j=>{var S,k;qe.error(((k=(S=j.response)==null?void 0:S.data)==null?void 0:k.message)||"Failed to create part")}}),y=jt({mutationFn:j=>bS.updatePart(n.id,j),onSuccess:()=>{s.invalidateQueries({queryKey:["parts"]}),s.invalidateQueries({queryKey:["part",n.id]}),qe.success("Part updated successfully"),t(!1)},onError:j=>{var S,k;qe.error(((k=(S=j.response)==null?void 0:S.data)==null?void 0:k.message)||"Failed to update part")}}),v=j=>{i?y.mutate(j):p.mutate(j)};return R.useEffect(()=>{a(n?{code:n.code,name:n.name,category:n.category,description:n.description||void 0,unit:n.unit,unit_cost:n.unit_cost||void 0,reorder_level:n.reorder_level||void 0,supplier_id:n.supplier_id||void 0}:{})},[n,a]),r.jsx(Rr,{open:e,onOpenChange:t,children:r.jsxs(Er,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:i?"Edit Part":"Create New Part"}),r.jsx(Bs,{children:i?"Update part information":"Add a new part to inventory"})]}),r.jsxs("form",{onSubmit:u(v),className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"code",children:"Part Code *"}),r.jsx(Ge,{id:"code",...c("code",{required:!0}),placeholder:"e.g., PIPE-100MM"}),m.code&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"category",children:"Category *"}),r.jsx(Ge,{id:"category",...c("category",{required:!0}),placeholder:"e.g., Pipes, Fittings, Valves"}),m.category&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"name",children:"Part Name *"}),r.jsx(Ge,{id:"name",...c("name",{required:!0}),placeholder:"e.g., PVC Pipe 100mm x 6m"}),m.name&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"description",children:"Description"}),r.jsx(Fs,{id:"description",...c("description"),placeholder:"Part description and specifications...",rows:3})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"unit",children:"Unit *"}),r.jsx(Ge,{id:"unit",...c("unit",{required:!0}),placeholder:"e.g., pcs, m, kg"}),m.unit&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"unit_cost",children:"Unit Cost"}),r.jsx(Ge,{id:"unit_cost",type:"number",step:"0.01",...c("unit_cost",{valueAsNumber:!0}),placeholder:"0.00"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"reorder_level",children:"Reorder Level"}),r.jsx(Ge,{id:"reorder_level",type:"number",...c("reorder_level",{valueAsNumber:!0}),placeholder:"Minimum stock"})]})]}),r.jsxs(Ai,{children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:p.isPending||y.isPending,children:p.isPending||y.isPending?"Saving...":i?"Update":"Create"})]})]})]})})}function ide(){const[e,t]=R.useState({per_page:15,page:1}),[n,s]=R.useState(!1),[i,c]=R.useState(),{data:u,isLoading:a,error:m}=ht({queryKey:["parts",e],queryFn:()=>bS.getParts(e)}),p=y=>{t({...e,search:y,page:1})};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Parts Inventory"}),r.jsx("p",{className:"text-muted-foreground",children:"Manage spare parts and supplies"})]}),r.jsxs(se,{onClick:()=>{c(void 0),s(!0)},children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Add Part"]})]}),a&&!u?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading parts..."})}):m?r.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:r.jsxs("p",{className:"text-lg text-destructive",children:["Error loading parts: ",m.message]})}):r.jsxs(r.Fragment,{children:[r.jsx(J,{children:r.jsxs(ie,{className:"pt-6",children:[r.jsx("div",{className:"flex gap-4 mb-6",children:r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"relative",children:[r.jsx(ci,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Search by code, name, or category...",className:"pl-9",value:e.search||"",onChange:y=>p(y.target.value)})]})})}),r.jsx("div",{className:"border rounded-lg",children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Code"}),r.jsx(le,{children:"Name"}),r.jsx(le,{children:"Category"}),r.jsx(le,{children:"Unit"}),r.jsx(le,{children:"Unit Cost"}),r.jsx(le,{children:"Stock Level"}),r.jsx(le,{children:"Reorder Level"}),r.jsx(le,{children:"Status"}),r.jsx(le,{className:"text-right",children:"Actions"})]})}),r.jsx(ur,{children:u==null?void 0:u.data.map(y=>{const v=y.stock_balance||0,j=y.reorder_level||0,S=v<=j;return r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:y.code}),r.jsx(ne,{children:y.name}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",className:"capitalize",children:y.category})}),r.jsx(ne,{className:"text-muted-foreground",children:y.unit}),r.jsx(ne,{className:"text-muted-foreground",children:y.unit_cost?`$${y.unit_cost.toFixed(2)}`:"-"}),r.jsx(ne,{children:r.jsxs("div",{className:"flex items-center gap-2",children:[S&&v>0&&r.jsx(gn,{className:"h-4 w-4 text-orange-500"}),r.jsx("span",{className:S?"text-orange-500 font-medium":"",children:v})]})}),r.jsx(ne,{className:"text-muted-foreground",children:j||"-"}),r.jsx(ne,{children:v===0?r.jsx(We,{className:"bg-red-100 text-red-800",children:"Out of Stock"}):S?r.jsx(We,{className:"bg-orange-100 text-orange-800",children:"Low Stock"}):r.jsx(We,{className:"bg-green-100 text-green-800",children:"In Stock"})}),r.jsx(ne,{className:"text-right",children:r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(se,{variant:"ghost",size:"sm",children:"View"}),r.jsx(se,{variant:"ghost",size:"sm",onClick:()=>{c(y),s(!0)},children:r.jsx(vd,{className:"h-4 w-4"})})]})})]},y.id)})})]})}),(u==null?void 0:u.data.length)===0&&r.jsxs("div",{className:"flex flex-col items-center justify-center p-12",children:[r.jsx(Kc,{className:"h-12 w-12 text-muted-foreground mb-4"}),r.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No parts found"}),r.jsxs(se,{onClick:()=>{c(void 0),s(!0)},children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Add Your First Part"]})]}),u&&u.total>0&&r.jsxs("div",{className:"flex items-center justify-between mt-4",children:[r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",u.from," to ",u.to," of ",u.total," parts"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:"outline",size:"sm",disabled:u.current_page===1,onClick:()=>t({...e,page:(e.page||1)-1}),children:"Previous"}),r.jsx(se,{variant:"outline",size:"sm",disabled:u.current_page===u.last_page,onClick:()=>t({...e,page:(e.page||1)+1}),children:"Next"})]})]})]})}),r.jsx(sde,{open:n,onOpenChange:y=>{s(y),y||c(void 0)},part:i})]})]})}var cW={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.11.0/LICENSE.txt
 */(function(e,t){(function(n,s){e.exports=s()})(I_,function(){var n={},s={};function i(u,a,m){if(s[u]=m,u==="index"){var p="var sharedModule = {}; ("+s.shared+")(sharedModule); ("+s.worker+")(sharedModule);",y={};return s.shared(y),s.index(n,y),typeof window<"u"&&n.setWorkerUrl(window.URL.createObjectURL(new Blob([p],{type:"text/javascript"}))),n}}i("shared",["exports"],function(u){function a(h,l,d,g){return new(d||(d=Promise))(function(_,C){function A(q){try{L(g.next(q))}catch(U){C(U)}}function M(q){try{L(g.throw(q))}catch(U){C(U)}}function L(q){var U;q.done?_(q.value):(U=q.value,U instanceof d?U:new d(function(H){H(U)})).then(A,M)}L((g=g.apply(h,l||[])).next())})}function m(h,l){this.x=h,this.y=l}function p(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var y,v;typeof SuppressedError=="function"&&SuppressedError,m.prototype={clone(){return new m(this.x,this.y)},add(h){return this.clone()._add(h)},sub(h){return this.clone()._sub(h)},multByPoint(h){return this.clone()._multByPoint(h)},divByPoint(h){return this.clone()._divByPoint(h)},mult(h){return this.clone()._mult(h)},div(h){return this.clone()._div(h)},rotate(h){return this.clone()._rotate(h)},rotateAround(h,l){return this.clone()._rotateAround(h,l)},matMult(h){return this.clone()._matMult(h)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(h){return this.x===h.x&&this.y===h.y},dist(h){return Math.sqrt(this.distSqr(h))},distSqr(h){const l=h.x-this.x,d=h.y-this.y;return l*l+d*d},angle(){return Math.atan2(this.y,this.x)},angleTo(h){return Math.atan2(this.y-h.y,this.x-h.x)},angleWith(h){return this.angleWithSep(h.x,h.y)},angleWithSep(h,l){return Math.atan2(this.x*l-this.y*h,this.x*h+this.y*l)},_matMult(h){const l=h[2]*this.x+h[3]*this.y;return this.x=h[0]*this.x+h[1]*this.y,this.y=l,this},_add(h){return this.x+=h.x,this.y+=h.y,this},_sub(h){return this.x-=h.x,this.y-=h.y,this},_mult(h){return this.x*=h,this.y*=h,this},_div(h){return this.x/=h,this.y/=h,this},_multByPoint(h){return this.x*=h.x,this.y*=h.y,this},_divByPoint(h){return this.x/=h.x,this.y/=h.y,this},_unit(){return this._div(this.mag()),this},_perp(){const h=this.y;return this.y=this.x,this.x=-h,this},_rotate(h){const l=Math.cos(h),d=Math.sin(h),g=d*this.x+l*this.y;return this.x=l*this.x-d*this.y,this.y=g,this},_rotateAround(h,l){const d=Math.cos(h),g=Math.sin(h),_=l.y+g*(this.x-l.x)+d*(this.y-l.y);return this.x=l.x+d*(this.x-l.x)-g*(this.y-l.y),this.y=_,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:m},m.convert=function(h){if(h instanceof m)return h;if(Array.isArray(h))return new m(+h[0],+h[1]);if(h.x!==void 0&&h.y!==void 0)return new m(+h.x,+h.y);throw new Error("Expected [x, y] or {x, y} point format")};var j=function(){if(v)return y;function h(l,d,g,_){this.cx=3*l,this.bx=3*(g-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*d,this.by=3*(_-d)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=d,this.p2x=g,this.p2y=_}return v=1,y=h,h.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,d){if(d===void 0&&(d=1e-6),l<0)return 0;if(l>1)return 1;for(var g=l,_=0;_<8;_++){var C=this.sampleCurveX(g)-l;if(Math.abs(C)<d)return g;var A=this.sampleCurveDerivativeX(g);if(Math.abs(A)<1e-6)break;g-=C/A}var M=0,L=1;for(g=l,_=0;_<20&&(C=this.sampleCurveX(g),!(Math.abs(C-l)<d));_++)l>C?M=g:L=g,g=.5*(L-M)+M;return g},solve:function(l,d){return this.sampleCurveY(this.solveCurveX(l,d))}},y}(),S=p(j);let k,N;function D(){return k==null&&(k=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),k}function O(){if(N==null&&(N=!1,D())){const l=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(l){for(let g=0;g<5*5;g++){const _=4*g;l.fillStyle=`rgb(${_},${_+1},${_+2})`,l.fillRect(g%5,Math.floor(g/5),1,1)}const d=l.getImageData(0,0,5,5).data;for(let g=0;g<5*5*4;g++)if(g%4!=3&&d[g]!==g){N=!0;break}}}return N||!1}var T=1e-6,I=typeof Float32Array<"u"?Float32Array:Array;function z(){var h=new I(9);return I!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h}function $(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h}function V(){var h=new I(3);return I!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),h}function K(h){var l=h[0],d=h[1],g=h[2];return Math.sqrt(l*l+d*d+g*g)}function te(h,l,d){var g=new I(3);return g[0]=h,g[1]=l,g[2]=d,g}function X(h,l,d){return h[0]=l[0]+d[0],h[1]=l[1]+d[1],h[2]=l[2]+d[2],h}function ve(h,l,d){return h[0]=l[0]*d,h[1]=l[1]*d,h[2]=l[2]*d,h}function ae(h,l,d){var g=l[0],_=l[1],C=l[2],A=d[0],M=d[1],L=d[2];return h[0]=_*L-C*M,h[1]=C*A-g*L,h[2]=g*M-_*A,h}var pe,Oe=K;function Me(h,l,d){var g=l[0],_=l[1],C=l[2],A=l[3];return h[0]=d[0]*g+d[4]*_+d[8]*C+d[12]*A,h[1]=d[1]*g+d[5]*_+d[9]*C+d[13]*A,h[2]=d[2]*g+d[6]*_+d[10]*C+d[14]*A,h[3]=d[3]*g+d[7]*_+d[11]*C+d[15]*A,h}function Xe(){var h=new I(4);return I!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),h[3]=1,h}function Ve(h,l,d,g){var _=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",C=Math.PI/360;l*=C,g*=C,d*=C;var A=Math.sin(l),M=Math.cos(l),L=Math.sin(d),q=Math.cos(d),U=Math.sin(g),H=Math.cos(g);switch(_){case"xyz":h[0]=A*q*H+M*L*U,h[1]=M*L*H-A*q*U,h[2]=M*q*U+A*L*H,h[3]=M*q*H-A*L*U;break;case"xzy":h[0]=A*q*H-M*L*U,h[1]=M*L*H-A*q*U,h[2]=M*q*U+A*L*H,h[3]=M*q*H+A*L*U;break;case"yxz":h[0]=A*q*H+M*L*U,h[1]=M*L*H-A*q*U,h[2]=M*q*U-A*L*H,h[3]=M*q*H+A*L*U;break;case"yzx":h[0]=A*q*H+M*L*U,h[1]=M*L*H+A*q*U,h[2]=M*q*U-A*L*H,h[3]=M*q*H-A*L*U;break;case"zxy":h[0]=A*q*H-M*L*U,h[1]=M*L*H+A*q*U,h[2]=M*q*U+A*L*H,h[3]=M*q*H-A*L*U;break;case"zyx":h[0]=A*q*H-M*L*U,h[1]=M*L*H+A*q*U,h[2]=M*q*U-A*L*H,h[3]=M*q*H+A*L*U;break;default:throw new Error("Unknown angle order "+_)}return h}function et(){var h=new I(2);return I!=Float32Array&&(h[0]=0,h[1]=0),h}function Ce(h,l){var d=new I(2);return d[0]=h,d[1]=l,d}V(),pe=new I(4),I!=Float32Array&&(pe[0]=0,pe[1]=0,pe[2]=0,pe[3]=0),V(),te(1,0,0),te(0,1,0),Xe(),Xe(),z(),et();const _e=8192;function tt(h,l,d){return l*(_e/(h.tileSize*Math.pow(2,d-h.tileID.overscaledZ)))}function vt(h,l){return(h%l+l)%l}function gt(h,l,d){return h*(1-d)+l*d}function Tt(h){if(h<=0)return 0;if(h>=1)return 1;const l=h*h,d=l*h;return 4*(h<.5?d:3*(h-l)+d-.75)}function Ht(h,l,d,g){const _=new S(h,l,d,g);return C=>_.solve(C)}const Ir=Ht(.25,.1,.25,1);function Pr(h,l,d){return Math.min(d,Math.max(l,h))}function Mt(h,l,d){const g=d-l,_=((h-l)%g+g)%g+l;return _===l?d:_}function yr(h,...l){for(const d of l)for(const g in d)h[g]=d[g];return h}let Nt=1;function Wt(h,l,d){const g={};for(const _ in h)g[_]=l.call(this,h[_],_,h);return g}function Zt(h,l,d){const g={};for(const _ in h)l.call(this,h[_],_,h)&&(g[_]=h[_]);return g}function mt(h){return Array.isArray(h)?h.map(mt):typeof h=="object"&&h?Wt(h,mt):h}const qr={};function ar(h){qr[h]||(typeof console<"u"&&console.warn(h),qr[h]=!0)}function en(h,l,d){return(d.y-h.y)*(l.x-h.x)>(l.y-h.y)*(d.x-h.x)}function Lr(h){return typeof WorkerGlobalScope<"u"&&h!==void 0&&h instanceof WorkerGlobalScope}let An=null;function vs(h){if(An==null){const l=h.navigator?h.navigator.userAgent:null;An=!!h.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return An}function Wn(h){return typeof ImageBitmap<"u"&&h instanceof ImageBitmap}const Be="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function rt(h,l,d,g,_){return a(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const C=new VideoFrame(h,{timestamp:0});try{const A=C==null?void 0:C.format;if(!A||!A.startsWith("BGR")&&!A.startsWith("RGB"))throw new Error(`Unrecognized format ${A}`);const M=A.startsWith("BGR"),L=new Uint8ClampedArray(g*_*4);if(yield C.copyTo(L,function(q,U,H,Q,ee){const oe=4*Math.max(-U,0),fe=(Math.max(0,H)-H)*Q*4+oe,be=4*Q,Pe=Math.max(0,U),Qe=Math.max(0,H);return{rect:{x:Pe,y:Qe,width:Math.min(q.width,U+Q)-Pe,height:Math.min(q.height,H+ee)-Qe},layout:[{offset:fe,stride:be}]}}(h,l,d,g,_)),M)for(let q=0;q<L.length;q+=4){const U=L[q];L[q]=L[q+2],L[q+2]=U}return L}finally{C.close()}})}let pt,Lt;function Rt(h,l,d,g){return h.addEventListener(l,d,g),{unsubscribe:()=>{h.removeEventListener(l,d,g)}}}function Ot(h){return h*Math.PI/180}function tr(h){return h/Math.PI*180}const tn={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Sn={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},ks="AbortError";function Ue(){return new Error(ks)}const ce={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ue(h){return ce.REGISTERED_PROTOCOLS[h.substring(0,h.indexOf("://"))]}const ye="global-dispatcher";class Ae extends Error{constructor(l,d,g,_){super(`AJAXError: ${d} (${l}): ${g}`),this.status=l,this.statusText=d,this.url=g,this.body=_}}const Fe=()=>Lr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ye=function(h,l){if(/:\/\//.test(h.url)&&!/^https?:|^file:/.test(h.url)){const g=ue(h.url);if(g)return g(h,l);if(Lr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:h,targetMapId:ye},l)}if(!(/^file:/.test(d=h.url)||/^file:/.test(Fe())&&!/^\w+:/.test(d))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(g,_){return a(this,void 0,void 0,function*(){const C=new Request(g.url,{method:g.method||"GET",body:g.body,credentials:g.credentials,headers:g.headers,cache:g.cache,referrer:Fe(),signal:_.signal});let A,M;g.type!=="json"||C.headers.has("Accept")||C.headers.set("Accept","application/json");try{A=yield fetch(C)}catch(q){throw new Ae(0,q.message,g.url,new Blob)}if(!A.ok){const q=yield A.blob();throw new Ae(A.status,A.statusText,g.url,q)}M=g.type==="arrayBuffer"||g.type==="image"?A.arrayBuffer():g.type==="json"?A.json():A.text();const L=yield M;if(_.signal.aborted)throw Ue();return{data:L,cacheControl:A.headers.get("Cache-Control"),expires:A.headers.get("Expires")}})}(h,l);if(Lr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:h,mustQueue:!0,targetMapId:ye},l)}var d;return function(g,_){return new Promise((C,A)=>{var M;const L=new XMLHttpRequest;L.open(g.method||"GET",g.url,!0),g.type!=="arrayBuffer"&&g.type!=="image"||(L.responseType="arraybuffer");for(const q in g.headers)L.setRequestHeader(q,g.headers[q]);g.type==="json"&&(L.responseType="text",!((M=g.headers)===null||M===void 0)&&M.Accept||L.setRequestHeader("Accept","application/json")),L.withCredentials=g.credentials==="include",L.onerror=()=>{A(new Error(L.statusText))},L.onload=()=>{if(!_.signal.aborted)if((L.status>=200&&L.status<300||L.status===0)&&L.response!==null){let q=L.response;if(g.type==="json")try{q=JSON.parse(L.response)}catch(U){return void A(U)}C({data:q,cacheControl:L.getResponseHeader("Cache-Control"),expires:L.getResponseHeader("Expires")})}else{const q=new Blob([L.response],{type:L.getResponseHeader("Content-Type")});A(new Ae(L.status,L.statusText,g.url,q))}},_.signal.addEventListener("abort",()=>{L.abort(),A(Ue())}),L.send(g.body)})}(h,l)};function nt(h){if(!h||h.indexOf("://")<=0||h.indexOf("data:image/")===0||h.indexOf("blob:")===0)return!0;const l=new URL(h),d=window.location;return l.protocol===d.protocol&&l.host===d.host}function He(h,l,d){d[h]&&d[h].indexOf(l)!==-1||(d[h]=d[h]||[],d[h].push(l))}function ct(h,l,d){if(d&&d[h]){const g=d[h].indexOf(l);g!==-1&&d[h].splice(g,1)}}class Pt{constructor(l,d={}){yr(this,d),this.type=l}}class yt extends Pt{constructor(l,d={}){super("error",yr({error:l},d))}}class or{on(l,d){return this._listeners=this._listeners||{},He(l,d,this._listeners),{unsubscribe:()=>{this.off(l,d)}}}off(l,d){return ct(l,d,this._listeners),ct(l,d,this._oneTimeListeners),this}once(l,d){return d?(this._oneTimeListeners=this._oneTimeListeners||{},He(l,d,this._oneTimeListeners),this):new Promise(g=>this.once(l,g))}fire(l,d){typeof l=="string"&&(l=new Pt(l,d||{}));const g=l.type;if(this.listens(g)){l.target=this;const _=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];for(const M of _)M.call(this,l);const C=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];for(const M of C)ct(g,M,this._oneTimeListeners),M.call(this,l);const A=this._eventedParent;A&&(yr(l,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),A.fire(l))}else l instanceof yt&&console.error(l.error);return this}listens(l){return this._listeners&&this._listeners[l]&&this._listeners[l].length>0||this._oneTimeListeners&&this._oneTimeListeners[l]&&this._oneTimeListeners[l].length>0||this._eventedParent&&this._eventedParent.listens(l)}setEventedParent(l,d){return this._eventedParent=l,this._eventedParentData=d,this}}var Je={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Qr=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function hr(h,l){const d={};for(const g in h)g!=="ref"&&(d[g]=h[g]);return Qr.forEach(g=>{g in l&&(d[g]=l[g])}),d}function zt(h,l){if(Array.isArray(h)){if(!Array.isArray(l)||h.length!==l.length)return!1;for(let d=0;d<h.length;d++)if(!zt(h[d],l[d]))return!1;return!0}if(typeof h=="object"&&h!==null&&l!==null){if(typeof l!="object"||Object.keys(h).length!==Object.keys(l).length)return!1;for(const d in h)if(!zt(h[d],l[d]))return!1;return!0}return h===l}function pr(h,l){h.push(l)}function ln(h,l,d){pr(d,{command:"addSource",args:[h,l[h]]})}function Nn(h,l,d){pr(l,{command:"removeSource",args:[h]}),d[h]=!0}function Gn(h,l,d,g){Nn(h,d,g),ln(h,l,d)}function kn(h,l,d){let g;for(g in h[d])if(Object.prototype.hasOwnProperty.call(h[d],g)&&g!=="data"&&!zt(h[d][g],l[d][g]))return!1;for(g in l[d])if(Object.prototype.hasOwnProperty.call(l[d],g)&&g!=="data"&&!zt(h[d][g],l[d][g]))return!1;return!0}function Tn(h,l,d,g,_,C){h=h||{},l=l||{};for(const A in h)Object.prototype.hasOwnProperty.call(h,A)&&(zt(h[A],l[A])||d.push({command:C,args:[g,A,l[A],_]}));for(const A in l)Object.prototype.hasOwnProperty.call(l,A)&&!Object.prototype.hasOwnProperty.call(h,A)&&(zt(h[A],l[A])||d.push({command:C,args:[g,A,l[A],_]}))}function Pn(h){return h.id}function ui(h,l){return h[l.id]=l,h}class wt{constructor(l,d,g,_){this.message=(l?`${l}: `:"")+g,_&&(this.identifier=_),d!=null&&d.__line__&&(this.line=d.__line__)}}function Ts(h,...l){for(const d of l)for(const g in d)h[g]=d[g];return h}class la extends Error{constructor(l,d){super(d),this.message=d,this.key=l}}class Pd{constructor(l,d=[]){this.parent=l,this.bindings={};for(const[g,_]of d)this.bindings[g]=_}concat(l){return new Pd(this,l)}get(l){if(this.bindings[l])return this.bindings[l];if(this.parent)return this.parent.get(l);throw new Error(`${l} not found in scope.`)}has(l){return!!this.bindings[l]||!!this.parent&&this.parent.has(l)}}const Ii={kind:"null"},Dt={kind:"number"},Kr={kind:"string"},rn={kind:"boolean"},Po={kind:"color"},pf={kind:"projectionDefinition"},jc={kind:"object"},Xr={kind:"value"},gf={kind:"collator"},lu={kind:"formatted"},sl={kind:"padding"},wc={kind:"colorArray"},xf={kind:"numberArray"},cu={kind:"resolvedImage"},ap={kind:"variableAnchorOffsetCollection"};function Ki(h,l){return{kind:"array",itemType:h,N:l}}function ls(h){if(h.kind==="array"){const l=ls(h.itemType);return typeof h.N=="number"?`array<${l}, ${h.N}>`:h.itemType.kind==="value"?"array":`array<${l}>`}return h.kind}const Cd=[Ii,Dt,Kr,rn,Po,pf,lu,jc,Ki(Xr),sl,xf,wc,cu,ap];function uu(h,l){if(l.kind==="error")return null;if(h.kind==="array"){if(l.kind==="array"&&(l.N===0&&l.itemType.kind==="value"||!uu(h.itemType,l.itemType))&&(typeof h.N!="number"||h.N===l.N))return null}else{if(h.kind===l.kind)return null;if(h.kind==="value"){for(const d of Cd)if(!uu(d,l))return null}}return`Expected ${ls(h)} but found ${ls(l)} instead.`}function ti(h,l){return l.some(d=>d.kind===h.kind)}function du(h,l){return l.some(d=>d==="null"?h===null:d==="array"?Array.isArray(h):d==="object"?h&&!Array.isArray(h)&&typeof h=="object":d===typeof h)}function Ol(h,l){return h.kind==="array"&&l.kind==="array"?h.itemType.kind===l.itemType.kind&&typeof h.N=="number":h.kind===l.kind}const Ad=.96422,Yy=.82521,Jb=4/29,kd=6/29,Xy=3*kd*kd,jP=kd*kd*kd,ej=Math.PI/180,wP=180/Math.PI;function tj(h){return(h%=360)<0&&(h+=360),h}function rj([h,l,d,g]){let _,C;const A=Jy((.2225045*(h=Qy(h))+.7168786*(l=Qy(l))+.0606169*(d=Qy(d)))/1);h===l&&l===d?_=C=A:(_=Jy((.4360747*h+.3850649*l+.1430804*d)/Ad),C=Jy((.0139322*h+.0971045*l+.7141733*d)/Yy));const M=116*A-16;return[M<0?0:M,500*(_-A),200*(A-C),g]}function Qy(h){return h<=.04045?h/12.92:Math.pow((h+.055)/1.055,2.4)}function Jy(h){return h>jP?Math.pow(h,1/3):h/Xy+Jb}function nj([h,l,d,g]){let _=(h+16)/116,C=isNaN(l)?_:_+l/500,A=isNaN(d)?_:_-d/200;return _=1*op(_),C=Ad*op(C),A=Yy*op(A),[ev(3.1338561*C-1.6168667*_-.4906146*A),ev(-.9787684*C+1.9161415*_+.033454*A),ev(.0719453*C-.2289914*_+1.4052427*A),g]}function ev(h){return(h=h<=.00304?12.92*h:1.055*Math.pow(h,1/2.4)-.055)<0?0:h>1?1:h}function op(h){return h>kd?h*h*h:Xy*(h-Jb)}const yf=Object.hasOwn||function(h,l){return Object.prototype.hasOwnProperty.call(h,l)};function vf(h,l){return yf(h,l)?h[l]:void 0}function lp(h){return parseInt(h.padEnd(2,h),16)/255}function Td(h,l){return Ed(l?h/100:h,0,1)}function Ed(h,l,d){return Math.min(Math.max(l,h),d)}function sj(h){return!h.some(Number.isNaN)}const SP={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Il(h,l,d){return h+d*(l-h)}function hu(h,l,d){return h.map((g,_)=>Il(g,l[_],d))}class Ur{constructor(l,d,g,_=1,C=!0){this.r=l,this.g=d,this.b=g,this.a=_,C||(this.r*=_,this.g*=_,this.b*=_,_||this.overwriteGetter("rgb",[l,d,g,_]))}static parse(l){if(l instanceof Ur)return l;if(typeof l!="string")return;const d=function(g){if((g=g.toLowerCase().trim())==="transparent")return[0,0,0,0];const _=vf(SP,g);if(_){const[A,M,L]=_;return[A/255,M/255,L/255,1]}if(g.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(g)){const A=g.length<6?1:2;let M=1;return[lp(g.slice(M,M+=A)),lp(g.slice(M,M+=A)),lp(g.slice(M,M+=A)),lp(g.slice(M,M+A)||"ff")]}if(g.startsWith("rgb")){const A=g.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(A){const[M,L,q,U,H,Q,ee,oe,fe,be,Pe,Qe]=A,De=[U||" ",ee||" ",be].join("");if(De==="  "||De==="  /"||De===",,"||De===",,,"){const ze=[q,Q,fe].join(""),it=ze==="%%%"?100:ze===""?255:0;if(it){const ft=[Ed(+L/it,0,1),Ed(+H/it,0,1),Ed(+oe/it,0,1),Pe?Td(+Pe,Qe):1];if(sj(ft))return ft}}return}}const C=g.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(C){const[A,M,L,q,U,H,Q,ee,oe]=C,fe=[L||" ",U||" ",Q].join("");if(fe==="  "||fe==="  /"||fe===",,"||fe===",,,"){const be=[+M,Ed(+q,0,100),Ed(+H,0,100),ee?Td(+ee,oe):1];if(sj(be))return function([Pe,Qe,De,ze]){function it(ft){const Ct=(ft+Pe/30)%12,Vt=Qe*Math.min(De,1-De);return De-Vt*Math.max(-1,Math.min(Ct-3,9-Ct,1))}return Pe=tj(Pe),Qe/=100,De/=100,[it(0),it(8),it(4),ze]}(be)}}}(l);return d?new Ur(...d,!1):void 0}get rgb(){const{r:l,g:d,b:g,a:_}=this,C=_||1/0;return this.overwriteGetter("rgb",[l/C,d/C,g/C,_])}get hcl(){return this.overwriteGetter("hcl",function(l){const[d,g,_,C]=rj(l),A=Math.sqrt(g*g+_*_);return[Math.round(1e4*A)?tj(Math.atan2(_,g)*wP):NaN,A,d,C]}(this.rgb))}get lab(){return this.overwriteGetter("lab",rj(this.rgb))}overwriteGetter(l,d){return Object.defineProperty(this,l,{value:d}),d}toString(){const[l,d,g,_]=this.rgb;return`rgba(${[l,d,g].map(C=>Math.round(255*C)).join(",")},${_})`}static interpolate(l,d,g,_="rgb"){switch(_){case"rgb":{const[C,A,M,L]=hu(l.rgb,d.rgb,g);return new Ur(C,A,M,L,!1)}case"hcl":{const[C,A,M,L]=l.hcl,[q,U,H,Q]=d.hcl;let ee,oe;if(isNaN(C)||isNaN(q))isNaN(C)?isNaN(q)?ee=NaN:(ee=q,M!==1&&M!==0||(oe=U)):(ee=C,H!==1&&H!==0||(oe=A));else{let De=q-C;q>C&&De>180?De-=360:q<C&&C-q>180&&(De+=360),ee=C+g*De}const[fe,be,Pe,Qe]=function([De,ze,it,ft]){return De=isNaN(De)?0:De*ej,nj([it,Math.cos(De)*ze,Math.sin(De)*ze,ft])}([ee,oe??Il(A,U,g),Il(M,H,g),Il(L,Q,g)]);return new Ur(fe,be,Pe,Qe,!1)}case"lab":{const[C,A,M,L]=nj(hu(l.lab,d.lab,g));return new Ur(C,A,M,L,!1)}}}}Ur.black=new Ur(0,0,0,1),Ur.white=new Ur(1,1,1,1),Ur.transparent=new Ur(0,0,0,0),Ur.red=new Ur(1,0,0,1);class un{constructor(l,d,g){this.sensitivity=l?d?"variant":"case":d?"accent":"base",this.locale=g,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(l,d){return this.collator.compare(l,d)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Md=["bottom","center","top"];class il{constructor(l,d,g,_,C,A){this.text=l,this.image=d,this.scale=g,this.fontStack=_,this.textColor=C,this.verticalAlign=A}}class ba{constructor(l){this.sections=l}static fromString(l){return new ba([new il(l,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(l=>l.text.length!==0||l.image&&l.image.name.length!==0)}static factory(l){return l instanceof ba?l:ba.fromString(l)}toString(){return this.sections.length===0?"":this.sections.map(l=>l.text).join("")}}class Hi{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof Hi)return l;if(typeof l=="number")return new Hi([l,l,l,l]);if(Array.isArray(l)&&!(l.length<1||l.length>4)){for(const d of l)if(typeof d!="number")return;switch(l.length){case 1:l=[l[0],l[0],l[0],l[0]];break;case 2:l=[l[0],l[1],l[0],l[1]];break;case 3:l=[l[0],l[1],l[2],l[1]]}return new Hi(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,d,g){return new Hi(hu(l.values,d.values,g))}}class Di{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof Di)return l;if(typeof l=="number")return new Di([l]);if(Array.isArray(l)){for(const d of l)if(typeof d!="number")return;return new Di(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,d,g){return new Di(hu(l.values,d.values,g))}}class Vs{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof Vs)return l;if(typeof l=="string"){const g=Ur.parse(l);return g?new Vs([g]):void 0}if(!Array.isArray(l))return;const d=[];for(const g of l){if(typeof g!="string")return;const _=Ur.parse(g);if(!_)return;d.push(_)}return new Vs(d)}toString(){return JSON.stringify(this.values)}static interpolate(l,d,g,_="rgb"){const C=[];if(l.values.length!=d.values.length)throw new Error(`colorArray: Arrays have mismatched length (${l.values.length} vs. ${d.values.length}), cannot interpolate.`);for(let A=0;A<l.values.length;A++)C.push(Ur.interpolate(l.values[A],d.values[A],g,_));return new Vs(C)}}class Qn extends Error{constructor(l){super(l),this.name="RuntimeError"}toJSON(){return this.message}}const ij=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Zi{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof Zi)return l;if(Array.isArray(l)&&!(l.length<1)&&l.length%2==0){for(let d=0;d<l.length;d+=2){const g=l[d],_=l[d+1];if(typeof g!="string"||!ij.has(g)||!Array.isArray(_)||_.length!==2||typeof _[0]!="number"||typeof _[1]!="number")return}return new Zi(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,d,g){const _=l.values,C=d.values;if(_.length!==C.length)throw new Qn(`Cannot interpolate values of different length. from: ${l.toString()}, to: ${d.toString()}`);const A=[];for(let M=0;M<_.length;M+=2){if(_[M]!==C[M])throw new Qn(`Cannot interpolate values containing mismatched anchors. from[${M}]: ${_[M]}, to[${M}]: ${C[M]}`);A.push(_[M]);const[L,q]=_[M+1],[U,H]=C[M+1];A.push([Il(L,U,g),Il(q,H,g)])}return new Zi(A)}}class ca{constructor(l){this.name=l.name,this.available=l.available}toString(){return this.name}static fromString(l){return l?new ca({name:l,available:!1}):null}}class $a{constructor(l,d,g){this.from=l,this.to=d,this.transition=g}static interpolate(l,d,g){return new $a(l,d,g)}static parse(l){return l instanceof $a?l:Array.isArray(l)&&l.length===3&&typeof l[0]=="string"&&typeof l[1]=="string"&&typeof l[2]=="number"?new $a(l[0],l[1],l[2]):typeof l=="object"&&typeof l.from=="string"&&typeof l.to=="string"&&typeof l.transition=="number"?new $a(l.from,l.to,l.transition):typeof l=="string"?new $a(l,l,1):void 0}}function _f(h,l,d,g){return typeof h=="number"&&h>=0&&h<=255&&typeof l=="number"&&l>=0&&l<=255&&typeof d=="number"&&d>=0&&d<=255?g===void 0||typeof g=="number"&&g>=0&&g<=1?null:`Invalid rgba value [${[h,l,d,g].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof g=="number"?[h,l,d,g]:[h,l,d]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function al(h){if(h===null||typeof h=="string"||typeof h=="boolean"||typeof h=="number"||h instanceof $a||h instanceof Ur||h instanceof un||h instanceof ba||h instanceof Hi||h instanceof Di||h instanceof Vs||h instanceof Zi||h instanceof ca)return!0;if(Array.isArray(h)){for(const l of h)if(!al(l))return!1;return!0}if(typeof h=="object"){for(const l in h)if(!al(h[l]))return!1;return!0}return!1}function Es(h){if(h===null)return Ii;if(typeof h=="string")return Kr;if(typeof h=="boolean")return rn;if(typeof h=="number")return Dt;if(h instanceof Ur)return Po;if(h instanceof $a)return pf;if(h instanceof un)return gf;if(h instanceof ba)return lu;if(h instanceof Hi)return sl;if(h instanceof Di)return xf;if(h instanceof Vs)return wc;if(h instanceof Zi)return ap;if(h instanceof ca)return cu;if(Array.isArray(h)){const l=h.length;let d;for(const g of h){const _=Es(g);if(d){if(d===_)continue;d=Xr;break}d=_}return Ki(d||Xr,l)}return jc}function Od(h){const l=typeof h;return h===null?"":l==="string"||l==="number"||l==="boolean"?String(h):h instanceof Ur||h instanceof $a||h instanceof ba||h instanceof Hi||h instanceof Di||h instanceof Vs||h instanceof Zi||h instanceof ca?h.toString():JSON.stringify(h)}class Sc{constructor(l,d){this.type=l,this.value=d}static parse(l,d){if(l.length!==2)return d.error(`'literal' expression requires exactly one argument, but found ${l.length-1} instead.`);if(!al(l[1]))return d.error("invalid value");const g=l[1];let _=Es(g);const C=d.expectedType;return _.kind!=="array"||_.N!==0||!C||C.kind!=="array"||typeof C.N=="number"&&C.N!==0||(_=C),new Sc(_,g)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const fu={string:Kr,number:Dt,boolean:rn,object:jc};class jn{constructor(l,d){this.type=l,this.args=d}static parse(l,d){if(l.length<2)return d.error("Expected at least one argument.");let g,_=1;const C=l[0];if(C==="array"){let M,L;if(l.length>2){const q=l[1];if(typeof q!="string"||!(q in fu)||q==="object")return d.error('The item type argument of "array" must be one of string, number, boolean',1);M=fu[q],_++}else M=Xr;if(l.length>3){if(l[2]!==null&&(typeof l[2]!="number"||l[2]<0||l[2]!==Math.floor(l[2])))return d.error('The length argument to "array" must be a positive integer literal',2);L=l[2],_++}g=Ki(M,L)}else{if(!fu[C])throw new Error(`Types doesn't contain name = ${C}`);g=fu[C]}const A=[];for(;_<l.length;_++){const M=d.parse(l[_],_,Xr);if(!M)return null;A.push(M)}return new jn(g,A)}evaluate(l){for(let d=0;d<this.args.length;d++){const g=this.args[d].evaluate(l);if(!uu(this.type,Es(g)))return g;if(d===this.args.length-1)throw new Qn(`Expected value to be of type ${ls(this.type)}, but found ${ls(Es(g))} instead.`)}throw new Error}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}const cp={"to-boolean":rn,"to-color":Po,"to-number":Dt,"to-string":Kr};class nn{constructor(l,d){this.type=l,this.args=d}static parse(l,d){if(l.length<2)return d.error("Expected at least one argument.");const g=l[0];if(!cp[g])throw new Error(`Can't parse ${g} as it is not part of the known types`);if((g==="to-boolean"||g==="to-string")&&l.length!==2)return d.error("Expected one argument.");const _=cp[g],C=[];for(let A=1;A<l.length;A++){const M=d.parse(l[A],A,Xr);if(!M)return null;C.push(M)}return new nn(_,C)}evaluate(l){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(l);case"color":{let d,g;for(const _ of this.args){if(d=_.evaluate(l),g=null,d instanceof Ur)return d;if(typeof d=="string"){const C=l.parseColor(d);if(C)return C}else if(Array.isArray(d)&&(g=d.length<3||d.length>4?`Invalid rgba value ${JSON.stringify(d)}: expected an array containing either three or four numeric values.`:_f(d[0],d[1],d[2],d[3]),!g))return new Ur(d[0]/255,d[1]/255,d[2]/255,d[3])}throw new Qn(g||`Could not parse color from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}case"padding":{let d;for(const g of this.args){d=g.evaluate(l);const _=Hi.parse(d);if(_)return _}throw new Qn(`Could not parse padding from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}case"numberArray":{let d;for(const g of this.args){d=g.evaluate(l);const _=Di.parse(d);if(_)return _}throw new Qn(`Could not parse numberArray from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}case"colorArray":{let d;for(const g of this.args){d=g.evaluate(l);const _=Vs.parse(d);if(_)return _}throw new Qn(`Could not parse colorArray from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}case"variableAnchorOffsetCollection":{let d;for(const g of this.args){d=g.evaluate(l);const _=Zi.parse(d);if(_)return _}throw new Qn(`Could not parse variableAnchorOffsetCollection from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}case"number":{let d=null;for(const g of this.args){if(d=g.evaluate(l),d===null)return 0;const _=Number(d);if(!isNaN(_))return _}throw new Qn(`Could not convert ${JSON.stringify(d)} to number.`)}case"formatted":return ba.fromString(Od(this.args[0].evaluate(l)));case"resolvedImage":return ca.fromString(Od(this.args[0].evaluate(l)));case"projectionDefinition":return this.args[0].evaluate(l);default:return Od(this.args[0].evaluate(l))}}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}const Jr=["Unknown","Point","LineString","Polygon"];class up{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Jr[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(l){let d=this._parseColorCache.get(l);return d||(d=Ur.parse(l),this._parseColorCache.set(l,d)),d}}class vn{constructor(l,d,g=[],_,C=new Pd,A=[]){this.registry=l,this.path=g,this.key=g.map(M=>`[${M}]`).join(""),this.scope=C,this.errors=A,this.expectedType=_,this._isConstant=d}parse(l,d,g,_,C={}){return d?this.concat(d,g,_)._parse(l,C):this._parse(l,C)}_parse(l,d){function g(_,C,A){return A==="assert"?new jn(C,[_]):A==="coerce"?new nn(C,[_]):_}if(l!==null&&typeof l!="string"&&typeof l!="boolean"&&typeof l!="number"||(l=["literal",l]),Array.isArray(l)){if(l.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _=l[0];if(typeof _!="string")return this.error(`Expression name must be a string, but found ${typeof _} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const C=this.registry[_];if(C){let A=C.parse(l,this);if(!A)return null;if(this.expectedType){const M=this.expectedType,L=A.type;if(M.kind!=="string"&&M.kind!=="number"&&M.kind!=="boolean"&&M.kind!=="object"&&M.kind!=="array"||L.kind!=="value"){if(M.kind==="projectionDefinition"&&["string","array"].includes(L.kind)||["color","formatted","resolvedImage"].includes(M.kind)&&["value","string"].includes(L.kind)||["padding","numberArray"].includes(M.kind)&&["value","number","array"].includes(L.kind)||M.kind==="colorArray"&&["value","string","array"].includes(L.kind)||M.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(L.kind))A=g(A,M,d.typeAnnotation||"coerce");else if(this.checkSubtype(M,L))return null}else A=g(A,M,d.typeAnnotation||"assert")}if(!(A instanceof Sc)&&A.type.kind!=="resolvedImage"&&this._isConstant(A)){const M=new up;try{A=new Sc(A.type,A.evaluate(M))}catch(L){return this.error(L.message),null}}return A}return this.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(l===void 0?"'undefined' value invalid. Use null instead.":typeof l=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof l} instead.`)}concat(l,d,g){const _=typeof l=="number"?this.path.concat(l):this.path,C=g?this.scope.concat(g):this.scope;return new vn(this.registry,this._isConstant,_,d||null,C,this.errors)}error(l,...d){const g=`${this.key}${d.map(_=>`[${_}]`).join("")}`;this.errors.push(new la(g,l))}checkSubtype(l,d){const g=uu(l,d);return g&&this.error(g),g}}class Id{constructor(l,d){this.type=d.type,this.bindings=[].concat(l),this.result=d}evaluate(l){return this.result.evaluate(l)}eachChild(l){for(const d of this.bindings)l(d[1]);l(this.result)}static parse(l,d){if(l.length<4)return d.error(`Expected at least 3 arguments, but found ${l.length-1} instead.`);const g=[];for(let C=1;C<l.length-1;C+=2){const A=l[C];if(typeof A!="string")return d.error(`Expected string, but found ${typeof A} instead.`,C);if(/[^a-zA-Z0-9_]/.test(A))return d.error("Variable names must contain only alphanumeric characters or '_'.",C);const M=d.parse(l[C+1],C+1);if(!M)return null;g.push([A,M])}const _=d.parse(l[l.length-1],l.length-1,d.expectedType,g);return _?new Id(g,_):null}outputDefined(){return this.result.outputDefined()}}class so{constructor(l,d){this.type=d.type,this.name=l,this.boundExpression=d}static parse(l,d){if(l.length!==2||typeof l[1]!="string")return d.error("'var' expression requires exactly one string literal argument.");const g=l[1];return d.scope.has(g)?new so(g,d.scope.get(g)):d.error(`Unknown variable "${g}". Make sure "${g}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(l){return this.boundExpression.evaluate(l)}eachChild(){}outputDefined(){return!1}}class bf{constructor(l,d,g){this.type=l,this.index=d,this.input=g}static parse(l,d){if(l.length!==3)return d.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const g=d.parse(l[1],1,Dt),_=d.parse(l[2],2,Ki(d.expectedType||Xr));return g&&_?new bf(_.type.itemType,g,_):null}evaluate(l){const d=this.index.evaluate(l),g=this.input.evaluate(l);if(d<0)throw new Qn(`Array index out of bounds: ${d} < 0.`);if(d>=g.length)throw new Qn(`Array index out of bounds: ${d} > ${g.length-1}.`);if(d!==Math.floor(d))throw new Qn(`Array index must be an integer, but found ${d} instead.`);return g[d]}eachChild(l){l(this.index),l(this.input)}outputDefined(){return!1}}class Dd{constructor(l,d){this.type=rn,this.needle=l,this.haystack=d}static parse(l,d){if(l.length!==3)return d.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const g=d.parse(l[1],1,Xr),_=d.parse(l[2],2,Xr);return g&&_?ti(g.type,[rn,Kr,Dt,Ii,Xr])?new Dd(g,_):d.error(`Expected first argument to be of type boolean, string, number or null, but found ${ls(g.type)} instead`):null}evaluate(l){const d=this.needle.evaluate(l),g=this.haystack.evaluate(l);if(!g)return!1;if(!du(d,["boolean","string","number","null"]))throw new Qn(`Expected first argument to be of type boolean, string, number or null, but found ${ls(Es(d))} instead.`);if(!du(g,["string","array"]))throw new Qn(`Expected second argument to be of type array or string, but found ${ls(Es(g))} instead.`);return g.indexOf(d)>=0}eachChild(l){l(this.needle),l(this.haystack)}outputDefined(){return!0}}class jf{constructor(l,d,g){this.type=Dt,this.needle=l,this.haystack=d,this.fromIndex=g}static parse(l,d){if(l.length<=2||l.length>=5)return d.error(`Expected 2 or 3 arguments, but found ${l.length-1} instead.`);const g=d.parse(l[1],1,Xr),_=d.parse(l[2],2,Xr);if(!g||!_)return null;if(!ti(g.type,[rn,Kr,Dt,Ii,Xr]))return d.error(`Expected first argument to be of type boolean, string, number or null, but found ${ls(g.type)} instead`);if(l.length===4){const C=d.parse(l[3],3,Dt);return C?new jf(g,_,C):null}return new jf(g,_)}evaluate(l){const d=this.needle.evaluate(l),g=this.haystack.evaluate(l);if(!du(d,["boolean","string","number","null"]))throw new Qn(`Expected first argument to be of type boolean, string, number or null, but found ${ls(Es(d))} instead.`);let _;if(this.fromIndex&&(_=this.fromIndex.evaluate(l)),du(g,["string"])){const C=g.indexOf(d,_);return C===-1?-1:[...g.slice(0,C)].length}if(du(g,["array"]))return g.indexOf(d,_);throw new Qn(`Expected second argument to be of type array or string, but found ${ls(Es(g))} instead.`)}eachChild(l){l(this.needle),l(this.haystack),this.fromIndex&&l(this.fromIndex)}outputDefined(){return!1}}class wf{constructor(l,d,g,_,C,A){this.inputType=l,this.type=d,this.input=g,this.cases=_,this.outputs=C,this.otherwise=A}static parse(l,d){if(l.length<5)return d.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if(l.length%2!=1)return d.error("Expected an even number of arguments.");let g,_;d.expectedType&&d.expectedType.kind!=="value"&&(_=d.expectedType);const C={},A=[];for(let q=2;q<l.length-1;q+=2){let U=l[q];const H=l[q+1];Array.isArray(U)||(U=[U]);const Q=d.concat(q);if(U.length===0)return Q.error("Expected at least one branch label.");for(const oe of U){if(typeof oe!="number"&&typeof oe!="string")return Q.error("Branch labels must be numbers or strings.");if(typeof oe=="number"&&Math.abs(oe)>Number.MAX_SAFE_INTEGER)return Q.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof oe=="number"&&Math.floor(oe)!==oe)return Q.error("Numeric branch labels must be integer values.");if(g){if(Q.checkSubtype(g,Es(oe)))return null}else g=Es(oe);if(C[String(oe)]!==void 0)return Q.error("Branch labels must be unique.");C[String(oe)]=A.length}const ee=d.parse(H,q,_);if(!ee)return null;_=_||ee.type,A.push(ee)}const M=d.parse(l[1],1,Xr);if(!M)return null;const L=d.parse(l[l.length-1],l.length-1,_);return L?M.type.kind!=="value"&&d.concat(1).checkSubtype(g,M.type)?null:new wf(g,_,M,C,A,L):null}evaluate(l){const d=this.input.evaluate(l);return(Es(d)===this.inputType&&this.outputs[this.cases[d]]||this.otherwise).evaluate(l)}eachChild(l){l(this.input),this.outputs.forEach(l),l(this.otherwise)}outputDefined(){return this.outputs.every(l=>l.outputDefined())&&this.otherwise.outputDefined()}}class dp{constructor(l,d,g){this.type=l,this.branches=d,this.otherwise=g}static parse(l,d){if(l.length<4)return d.error(`Expected at least 3 arguments, but found only ${l.length-1}.`);if(l.length%2!=0)return d.error("Expected an odd number of arguments.");let g;d.expectedType&&d.expectedType.kind!=="value"&&(g=d.expectedType);const _=[];for(let A=1;A<l.length-1;A+=2){const M=d.parse(l[A],A,rn);if(!M)return null;const L=d.parse(l[A+1],A+1,g);if(!L)return null;_.push([M,L]),g=g||L.type}const C=d.parse(l[l.length-1],l.length-1,g);if(!C)return null;if(!g)throw new Error("Can't infer output type");return new dp(g,_,C)}evaluate(l){for(const[d,g]of this.branches)if(d.evaluate(l))return g.evaluate(l);return this.otherwise.evaluate(l)}eachChild(l){for(const[d,g]of this.branches)l(d),l(g);l(this.otherwise)}outputDefined(){return this.branches.every(([l,d])=>d.outputDefined())&&this.otherwise.outputDefined()}}class hp{constructor(l,d,g,_){this.type=l,this.input=d,this.beginIndex=g,this.endIndex=_}static parse(l,d){if(l.length<=2||l.length>=5)return d.error(`Expected 2 or 3 arguments, but found ${l.length-1} instead.`);const g=d.parse(l[1],1,Xr),_=d.parse(l[2],2,Dt);if(!g||!_)return null;if(!ti(g.type,[Ki(Xr),Kr,Xr]))return d.error(`Expected first argument to be of type array or string, but found ${ls(g.type)} instead`);if(l.length===4){const C=d.parse(l[3],3,Dt);return C?new hp(g.type,g,_,C):null}return new hp(g.type,g,_)}evaluate(l){const d=this.input.evaluate(l),g=this.beginIndex.evaluate(l);let _;if(this.endIndex&&(_=this.endIndex.evaluate(l)),du(d,["string"]))return[...d].slice(g,_).join("");if(du(d,["array"]))return d.slice(g,_);throw new Qn(`Expected first argument to be of type array or string, but found ${ls(Es(d))} instead.`)}eachChild(l){l(this.input),l(this.beginIndex),this.endIndex&&l(this.endIndex)}outputDefined(){return!1}}function Sf(h,l){const d=h.length-1;let g,_,C=0,A=d,M=0;for(;C<=A;)if(M=Math.floor((C+A)/2),g=h[M],_=h[M+1],g<=l){if(M===d||l<_)return M;C=M+1}else{if(!(g>l))throw new Qn("Input is not a number.");A=M-1}return 0}class Rd{constructor(l,d,g){this.type=l,this.input=d,this.labels=[],this.outputs=[];for(const[_,C]of g)this.labels.push(_),this.outputs.push(C)}static parse(l,d){if(l.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return d.error("Expected an even number of arguments.");const g=d.parse(l[1],1,Dt);if(!g)return null;const _=[];let C=null;d.expectedType&&d.expectedType.kind!=="value"&&(C=d.expectedType);for(let A=1;A<l.length;A+=2){const M=A===1?-1/0:l[A],L=l[A+1],q=A,U=A+1;if(typeof M!="number")return d.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(_.length&&_[_.length-1][0]>=M)return d.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',q);const H=d.parse(L,U,C);if(!H)return null;C=C||H.type,_.push([M,H])}return new Rd(C,g,_)}evaluate(l){const d=this.labels,g=this.outputs;if(d.length===1)return g[0].evaluate(l);const _=this.input.evaluate(l);if(_<=d[0])return g[0].evaluate(l);const C=d.length;return _>=d[C-1]?g[C-1].evaluate(l):g[Sf(d,_)].evaluate(l)}eachChild(l){l(this.input);for(const d of this.outputs)l(d)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function Nc(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var pi,Nf,aj=function(){if(Nf)return pi;function h(l,d,g,_){this.cx=3*l,this.bx=3*(g-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*d,this.by=3*(_-d)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=d,this.p2x=g,this.p2y=_}return Nf=1,pi=h,h.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,d){if(d===void 0&&(d=1e-6),l<0)return 0;if(l>1)return 1;for(var g=l,_=0;_<8;_++){var C=this.sampleCurveX(g)-l;if(Math.abs(C)<d)return g;var A=this.sampleCurveDerivativeX(g);if(Math.abs(A)<1e-6)break;g-=C/A}var M=0,L=1;for(g=l,_=0;_<20&&(C=this.sampleCurveX(g),!(Math.abs(C-l)<d));_++)l>C?M=g:L=g,g=.5*(L-M)+M;return g},solve:function(l,d){return this.sampleCurveY(this.solveCurveX(l,d))}},pi}(),fp=Nc(aj);class Mn{constructor(l,d,g,_,C){this.type=l,this.operator=d,this.interpolation=g,this.input=_,this.labels=[],this.outputs=[];for(const[A,M]of C)this.labels.push(A),this.outputs.push(M)}static interpolationFactor(l,d,g,_){let C=0;if(l.name==="exponential")C=mp(d,l.base,g,_);else if(l.name==="linear")C=mp(d,1,g,_);else if(l.name==="cubic-bezier"){const A=l.controlPoints;C=new fp(A[0],A[1],A[2],A[3]).solve(mp(d,1,g,_))}return C}static parse(l,d){let[g,_,C,...A]=l;if(!Array.isArray(_)||_.length===0)return d.error("Expected an interpolation type expression.",1);if(_[0]==="linear")_={name:"linear"};else if(_[0]==="exponential"){const q=_[1];if(typeof q!="number")return d.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:q}}else{if(_[0]!=="cubic-bezier")return d.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const q=_.slice(1);if(q.length!==4||q.some(U=>typeof U!="number"||U<0||U>1))return d.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:q}}}if(l.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return d.error("Expected an even number of arguments.");if(C=d.parse(C,2,Dt),!C)return null;const M=[];let L=null;g!=="interpolate-hcl"&&g!=="interpolate-lab"||d.expectedType==wc?d.expectedType&&d.expectedType.kind!=="value"&&(L=d.expectedType):L=Po;for(let q=0;q<A.length;q+=2){const U=A[q],H=A[q+1],Q=q+3,ee=q+4;if(typeof U!="number")return d.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Q);if(M.length&&M[M.length-1][0]>=U)return d.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Q);const oe=d.parse(H,ee,L);if(!oe)return null;L=L||oe.type,M.push([U,oe])}return Ol(L,Dt)||Ol(L,pf)||Ol(L,Po)||Ol(L,sl)||Ol(L,xf)||Ol(L,wc)||Ol(L,ap)||Ol(L,Ki(Dt))?new Mn(L,g,_,C,M):d.error(`Type ${ls(L)} is not interpolatable.`)}evaluate(l){const d=this.labels,g=this.outputs;if(d.length===1)return g[0].evaluate(l);const _=this.input.evaluate(l);if(_<=d[0])return g[0].evaluate(l);const C=d.length;if(_>=d[C-1])return g[C-1].evaluate(l);const A=Sf(d,_),M=Mn.interpolationFactor(this.interpolation,_,d[A],d[A+1]),L=g[A].evaluate(l),q=g[A+1].evaluate(l);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Il(L,q,M);case"color":return Ur.interpolate(L,q,M);case"padding":return Hi.interpolate(L,q,M);case"colorArray":return Vs.interpolate(L,q,M);case"numberArray":return Di.interpolate(L,q,M);case"variableAnchorOffsetCollection":return Zi.interpolate(L,q,M);case"array":return hu(L,q,M);case"projectionDefinition":return $a.interpolate(L,q,M)}case"interpolate-hcl":switch(this.type.kind){case"color":return Ur.interpolate(L,q,M,"hcl");case"colorArray":return Vs.interpolate(L,q,M,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Ur.interpolate(L,q,M,"lab");case"colorArray":return Vs.interpolate(L,q,M,"lab")}}}eachChild(l){l(this.input);for(const d of this.outputs)l(d)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function mp(h,l,d,g){const _=g-d,C=h-d;return _===0?0:l===1?C/_:(Math.pow(l,C)-1)/(Math.pow(l,_)-1)}const io={color:Ur.interpolate,number:Il,padding:Hi.interpolate,numberArray:Di.interpolate,colorArray:Vs.interpolate,variableAnchorOffsetCollection:Zi.interpolate,array:hu};class Pf{constructor(l,d){this.type=l,this.args=d}static parse(l,d){if(l.length<2)return d.error("Expected at least one argument.");let g=null;const _=d.expectedType;_&&_.kind!=="value"&&(g=_);const C=[];for(const M of l.slice(1)){const L=d.parse(M,1+C.length,g,void 0,{typeAnnotation:"omit"});if(!L)return null;g=g||L.type,C.push(L)}if(!g)throw new Error("No output type");const A=_&&C.some(M=>uu(_,M.type));return new Pf(A?Xr:g,C)}evaluate(l){let d,g=null,_=0;for(const C of this.args)if(_++,g=C.evaluate(l),g&&g instanceof ca&&!g.available&&(d||(d=g.name),g=null,_===this.args.length&&(g=d)),g!==null)break;return g}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}function oj(h,l){return h==="=="||h==="!="?l.kind==="boolean"||l.kind==="string"||l.kind==="number"||l.kind==="null"||l.kind==="value":l.kind==="string"||l.kind==="number"||l.kind==="value"}function mu(h,l,d,g){return g.compare(l,d)===0}function Dl(h,l,d){const g=h!=="=="&&h!=="!=";return class uW{constructor(C,A,M){this.type=rn,this.lhs=C,this.rhs=A,this.collator=M,this.hasUntypedArgument=C.type.kind==="value"||A.type.kind==="value"}static parse(C,A){if(C.length!==3&&C.length!==4)return A.error("Expected two or three arguments.");const M=C[0];let L=A.parse(C[1],1,Xr);if(!L)return null;if(!oj(M,L.type))return A.concat(1).error(`"${M}" comparisons are not supported for type '${ls(L.type)}'.`);let q=A.parse(C[2],2,Xr);if(!q)return null;if(!oj(M,q.type))return A.concat(2).error(`"${M}" comparisons are not supported for type '${ls(q.type)}'.`);if(L.type.kind!==q.type.kind&&L.type.kind!=="value"&&q.type.kind!=="value")return A.error(`Cannot compare types '${ls(L.type)}' and '${ls(q.type)}'.`);g&&(L.type.kind==="value"&&q.type.kind!=="value"?L=new jn(q.type,[L]):L.type.kind!=="value"&&q.type.kind==="value"&&(q=new jn(L.type,[q])));let U=null;if(C.length===4){if(L.type.kind!=="string"&&q.type.kind!=="string"&&L.type.kind!=="value"&&q.type.kind!=="value")return A.error("Cannot use collator to compare non-string types.");if(U=A.parse(C[3],3,gf),!U)return null}return new uW(L,q,U)}evaluate(C){const A=this.lhs.evaluate(C),M=this.rhs.evaluate(C);if(g&&this.hasUntypedArgument){const L=Es(A),q=Es(M);if(L.kind!==q.kind||L.kind!=="string"&&L.kind!=="number")throw new Qn(`Expected arguments for "${h}" to be (string, string) or (number, number), but found (${L.kind}, ${q.kind}) instead.`)}if(this.collator&&!g&&this.hasUntypedArgument){const L=Es(A),q=Es(M);if(L.kind!=="string"||q.kind!=="string")return l(C,A,M)}return this.collator?d(C,A,M,this.collator.evaluate(C)):l(C,A,M)}eachChild(C){C(this.lhs),C(this.rhs),this.collator&&C(this.collator)}outputDefined(){return!0}}}const tv=Dl("==",function(h,l,d){return l===d},mu),NP=Dl("!=",function(h,l,d){return l!==d},function(h,l,d,g){return!mu(0,l,d,g)}),lj=Dl("<",function(h,l,d){return l<d},function(h,l,d,g){return g.compare(l,d)<0}),pp=Dl(">",function(h,l,d){return l>d},function(h,l,d,g){return g.compare(l,d)>0}),gp=Dl("<=",function(h,l,d){return l<=d},function(h,l,d,g){return g.compare(l,d)<=0}),Co=Dl(">=",function(h,l,d){return l>=d},function(h,l,d,g){return g.compare(l,d)>=0});class Cf{constructor(l,d,g){this.type=gf,this.locale=g,this.caseSensitive=l,this.diacriticSensitive=d}static parse(l,d){if(l.length!==2)return d.error("Expected one argument.");const g=l[1];if(typeof g!="object"||Array.isArray(g))return d.error("Collator options argument must be an object.");const _=d.parse(g["case-sensitive"]!==void 0&&g["case-sensitive"],1,rn);if(!_)return null;const C=d.parse(g["diacritic-sensitive"]!==void 0&&g["diacritic-sensitive"],1,rn);if(!C)return null;let A=null;return g.locale&&(A=d.parse(g.locale,1,Kr),!A)?null:new Cf(_,C,A)}evaluate(l){return new un(this.caseSensitive.evaluate(l),this.diacriticSensitive.evaluate(l),this.locale?this.locale.evaluate(l):null)}eachChild(l){l(this.caseSensitive),l(this.diacriticSensitive),this.locale&&l(this.locale)}outputDefined(){return!1}}class Ld{constructor(l,d,g,_,C){this.type=Kr,this.number=l,this.locale=d,this.currency=g,this.minFractionDigits=_,this.maxFractionDigits=C}static parse(l,d){if(l.length!==3)return d.error("Expected two arguments.");const g=d.parse(l[1],1,Dt);if(!g)return null;const _=l[2];if(typeof _!="object"||Array.isArray(_))return d.error("NumberFormat options argument must be an object.");let C=null;if(_.locale&&(C=d.parse(_.locale,1,Kr),!C))return null;let A=null;if(_.currency&&(A=d.parse(_.currency,1,Kr),!A))return null;let M=null;if(_["min-fraction-digits"]&&(M=d.parse(_["min-fraction-digits"],1,Dt),!M))return null;let L=null;return _["max-fraction-digits"]&&(L=d.parse(_["max-fraction-digits"],1,Dt),!L)?null:new Ld(g,C,A,M,L)}evaluate(l){return new Intl.NumberFormat(this.locale?this.locale.evaluate(l):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(l):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(l):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(l):void 0}).format(this.number.evaluate(l))}eachChild(l){l(this.number),this.locale&&l(this.locale),this.currency&&l(this.currency),this.minFractionDigits&&l(this.minFractionDigits),this.maxFractionDigits&&l(this.maxFractionDigits)}outputDefined(){return!1}}class xp{constructor(l){this.type=lu,this.sections=l}static parse(l,d){if(l.length<2)return d.error("Expected at least one argument.");const g=l[1];if(!Array.isArray(g)&&typeof g=="object")return d.error("First argument must be an image or text section.");const _=[];let C=!1;for(let A=1;A<=l.length-1;++A){const M=l[A];if(C&&typeof M=="object"&&!Array.isArray(M)){C=!1;let L=null;if(M["font-scale"]&&(L=d.parse(M["font-scale"],1,Dt),!L))return null;let q=null;if(M["text-font"]&&(q=d.parse(M["text-font"],1,Ki(Kr)),!q))return null;let U=null;if(M["text-color"]&&(U=d.parse(M["text-color"],1,Po),!U))return null;let H=null;if(M["vertical-align"]){if(typeof M["vertical-align"]=="string"&&!Md.includes(M["vertical-align"]))return d.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${M["vertical-align"]}' instead.`);if(H=d.parse(M["vertical-align"],1,Kr),!H)return null}const Q=_[_.length-1];Q.scale=L,Q.font=q,Q.textColor=U,Q.verticalAlign=H}else{const L=d.parse(l[A],1,Xr);if(!L)return null;const q=L.type.kind;if(q!=="string"&&q!=="value"&&q!=="null"&&q!=="resolvedImage")return d.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");C=!0,_.push({content:L,scale:null,font:null,textColor:null,verticalAlign:null})}}return new xp(_)}evaluate(l){return new ba(this.sections.map(d=>{const g=d.content.evaluate(l);return Es(g)===cu?new il("",g,null,null,null,d.verticalAlign?d.verticalAlign.evaluate(l):null):new il(Od(g),null,d.scale?d.scale.evaluate(l):null,d.font?d.font.evaluate(l).join(","):null,d.textColor?d.textColor.evaluate(l):null,d.verticalAlign?d.verticalAlign.evaluate(l):null)}))}eachChild(l){for(const d of this.sections)l(d.content),d.scale&&l(d.scale),d.font&&l(d.font),d.textColor&&l(d.textColor),d.verticalAlign&&l(d.verticalAlign)}outputDefined(){return!1}}class Af{constructor(l){this.type=cu,this.input=l}static parse(l,d){if(l.length!==2)return d.error("Expected two arguments.");const g=d.parse(l[1],1,Kr);return g?new Af(g):d.error("No image name provided.")}evaluate(l){const d=this.input.evaluate(l),g=ca.fromString(d);return g&&l.availableImages&&(g.available=l.availableImages.indexOf(d)>-1),g}eachChild(l){l(this.input)}outputDefined(){return!1}}class rv{constructor(l){this.type=Dt,this.input=l}static parse(l,d){if(l.length!==2)return d.error(`Expected 1 argument, but found ${l.length-1} instead.`);const g=d.parse(l[1],1);return g?g.type.kind!=="array"&&g.type.kind!=="string"&&g.type.kind!=="value"?d.error(`Expected argument of type string or array, but found ${ls(g.type)} instead.`):new rv(g):null}evaluate(l){const d=this.input.evaluate(l);if(typeof d=="string")return[...d].length;if(Array.isArray(d))return d.length;throw new Qn(`Expected value to be of type string or array, but found ${ls(Es(d))} instead.`)}eachChild(l){l(this.input)}outputDefined(){return!1}}const ol=8192;function PP(h,l){const d=(180+h[0])/360,g=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h[1]*Math.PI/360)))/360,_=Math.pow(2,l.z);return[Math.round(d*_*ol),Math.round(g*_*ol)]}function nv(h,l){const d=Math.pow(2,l.z);return[(_=(h[0]/ol+l.x)/d,360*_-180),(g=(h[1]/ol+l.y)/d,360/Math.PI*Math.atan(Math.exp((180-360*g)*Math.PI/180))-90)];var g,_}function Pc(h,l){h[0]=Math.min(h[0],l[0]),h[1]=Math.min(h[1],l[1]),h[2]=Math.max(h[2],l[0]),h[3]=Math.max(h[3],l[1])}function kf(h,l){return!(h[0]<=l[0]||h[2]>=l[2]||h[1]<=l[1]||h[3]>=l[3])}function cj(h,l,d){const g=h[0]-l[0],_=h[1]-l[1],C=h[0]-d[0],A=h[1]-d[1];return g*A-C*_==0&&g*C<=0&&_*A<=0}function Tf(h,l,d,g){return(_=[g[0]-d[0],g[1]-d[1]])[0]*(C=[l[0]-h[0],l[1]-h[1]])[1]-_[1]*C[0]!=0&&!(!dj(h,l,d,g)||!dj(d,g,h,l));var _,C}function CP(h,l,d){for(const g of d)for(let _=0;_<g.length-1;++_)if(Tf(h,l,g[_],g[_+1]))return!0;return!1}function pu(h,l,d=!1){let g=!1;for(const M of l)for(let L=0;L<M.length-1;L++){if(cj(h,M[L],M[L+1]))return d;(C=M[L])[1]>(_=h)[1]!=(A=M[L+1])[1]>_[1]&&_[0]<(A[0]-C[0])*(_[1]-C[1])/(A[1]-C[1])+C[0]&&(g=!g)}var _,C,A;return g}function AP(h,l){for(const d of l)if(pu(h,d))return!0;return!1}function uj(h,l){for(const d of h)if(!pu(d,l))return!1;for(let d=0;d<h.length-1;++d)if(CP(h[d],h[d+1],l))return!1;return!0}function kP(h,l){for(const d of l)if(uj(h,d))return!0;return!1}function dj(h,l,d,g){const _=g[0]-d[0],C=g[1]-d[1],A=(h[0]-d[0])*C-_*(h[1]-d[1]),M=(l[0]-d[0])*C-_*(l[1]-d[1]);return A>0&&M<0||A<0&&M>0}function sv(h,l,d){const g=[];for(let _=0;_<h.length;_++){const C=[];for(let A=0;A<h[_].length;A++){const M=PP(h[_][A],d);Pc(l,M),C.push(M)}g.push(C)}return g}function iv(h,l,d){const g=[];for(let _=0;_<h.length;_++){const C=sv(h[_],l,d);g.push(C)}return g}function av(h,l,d,g){if(h[0]<d[0]||h[0]>d[2]){const _=.5*g;let C=h[0]-d[0]>_?-g:d[0]-h[0]>_?g:0;C===0&&(C=h[0]-d[2]>_?-g:d[2]-h[0]>_?g:0),h[0]+=C}Pc(l,h)}function ov(h,l,d,g){const _=Math.pow(2,g.z)*ol,C=[g.x*ol,g.y*ol],A=[];for(const M of h)for(const L of M){const q=[L.x+C[0],L.y+C[1]];av(q,l,d,_),A.push(q)}return A}function hj(h,l,d,g){const _=Math.pow(2,g.z)*ol,C=[g.x*ol,g.y*ol],A=[];for(const L of h){const q=[];for(const U of L){const H=[U.x+C[0],U.y+C[1]];Pc(l,H),q.push(H)}A.push(q)}if(l[2]-l[0]<=_/2){(M=l)[0]=M[1]=1/0,M[2]=M[3]=-1/0;for(const L of A)for(const q of L)av(q,l,d,_)}var M;return A}class gu{constructor(l,d){this.type=rn,this.geojson=l,this.geometries=d}static parse(l,d){if(l.length!==2)return d.error(`'within' expression requires exactly one argument, but found ${l.length-1} instead.`);if(al(l[1])){const g=l[1];if(g.type==="FeatureCollection"){const _=[];for(const C of g.features){const{type:A,coordinates:M}=C.geometry;A==="Polygon"&&_.push(M),A==="MultiPolygon"&&_.push(...M)}if(_.length)return new gu(g,{type:"MultiPolygon",coordinates:_})}else if(g.type==="Feature"){const _=g.geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new gu(g,g.geometry)}else if(g.type==="Polygon"||g.type==="MultiPolygon")return new gu(g,g)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return function(d,g){const _=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],A=d.canonicalID();if(g.type==="Polygon"){const M=sv(g.coordinates,C,A),L=ov(d.geometry(),_,C,A);if(!kf(_,C))return!1;for(const q of L)if(!pu(q,M))return!1}if(g.type==="MultiPolygon"){const M=iv(g.coordinates,C,A),L=ov(d.geometry(),_,C,A);if(!kf(_,C))return!1;for(const q of L)if(!AP(q,M))return!1}return!0}(l,this.geometries);if(l.geometryType()==="LineString")return function(d,g){const _=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],A=d.canonicalID();if(g.type==="Polygon"){const M=sv(g.coordinates,C,A),L=hj(d.geometry(),_,C,A);if(!kf(_,C))return!1;for(const q of L)if(!uj(q,M))return!1}if(g.type==="MultiPolygon"){const M=iv(g.coordinates,C,A),L=hj(d.geometry(),_,C,A);if(!kf(_,C))return!1;for(const q of L)if(!kP(q,M))return!1}return!0}(l,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let fj=class{constructor(h=[],l=(d,g)=>d<g?-1:d>g?1:0){if(this.data=h,this.length=this.data.length,this.compare=l,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(h){this.data.push(h),this._up(this.length++)}pop(){if(this.length===0)return;const h=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),h}peek(){return this.data[0]}_up(h){const{data:l,compare:d}=this,g=l[h];for(;h>0;){const _=h-1>>1,C=l[_];if(d(g,C)>=0)break;l[h]=C,h=_}l[h]=g}_down(h){const{data:l,compare:d}=this,g=this.length>>1,_=l[h];for(;h<g;){let C=1+(h<<1);const A=C+1;if(A<this.length&&d(l[A],l[C])<0&&(C=A),d(l[C],_)>=0)break;l[h]=l[C],h=C}l[h]=_}};function mj(h,l,d=0,g=h.length-1,_=TP){for(;g>d;){if(g-d>600){const L=g-d+1,q=l-d+1,U=Math.log(L),H=.5*Math.exp(2*U/3),Q=.5*Math.sqrt(U*H*(L-H)/L)*(q-L/2<0?-1:1);mj(h,l,Math.max(d,Math.floor(l-q*H/L+Q)),Math.min(g,Math.floor(l+(L-q)*H/L+Q)),_)}const C=h[l];let A=d,M=g;for(Cc(h,d,l),_(h[g],C)>0&&Cc(h,d,g);A<M;){for(Cc(h,A,M),A++,M--;_(h[A],C)<0;)A++;for(;_(h[M],C)>0;)M--}_(h[d],C)===0?Cc(h,d,M):(M++,Cc(h,M,g)),M<=l&&(d=M+1),l<=M&&(g=M-1)}}function Cc(h,l,d){const g=h[l];h[l]=h[d],h[d]=g}function TP(h,l){return h<l?-1:h>l?1:0}function yp(h,l){if(h.length<=1)return[h];const d=[];let g,_;for(const C of h){const A=MP(C);A!==0&&(C.area=Math.abs(A),_===void 0&&(_=A<0),_===A<0?(g&&d.push(g),g=[C]):g.push(C))}if(g&&d.push(g),l>1)for(let C=0;C<d.length;C++)d[C].length<=l||(mj(d[C],l,1,d[C].length-1,EP),d[C]=d[C].slice(0,l));return d}function EP(h,l){return l.area-h.area}function MP(h){let l=0;for(let d,g,_=0,C=h.length,A=C-1;_<C;A=_++)d=h[_],g=h[A],l+=(g.x-d.x)*(d.y+g.y);return l}const vp=1/298.257223563,lv=vp*(2-vp),pj=Math.PI/180;class cv{constructor(l){const d=6378.137*pj*1e3,g=Math.cos(l*pj),_=1/(1-lv*(1-g*g)),C=Math.sqrt(_);this.kx=d*C*g,this.ky=d*C*_*(1-lv)}distance(l,d){const g=this.wrap(l[0]-d[0])*this.kx,_=(l[1]-d[1])*this.ky;return Math.sqrt(g*g+_*_)}pointOnLine(l,d){let g,_,C,A,M=1/0;for(let L=0;L<l.length-1;L++){let q=l[L][0],U=l[L][1],H=this.wrap(l[L+1][0]-q)*this.kx,Q=(l[L+1][1]-U)*this.ky,ee=0;H===0&&Q===0||(ee=(this.wrap(d[0]-q)*this.kx*H+(d[1]-U)*this.ky*Q)/(H*H+Q*Q),ee>1?(q=l[L+1][0],U=l[L+1][1]):ee>0&&(q+=H/this.kx*ee,U+=Q/this.ky*ee)),H=this.wrap(d[0]-q)*this.kx,Q=(d[1]-U)*this.ky;const oe=H*H+Q*Q;oe<M&&(M=oe,g=q,_=U,C=L,A=ee)}return{point:[g,_],index:C,t:Math.max(0,Math.min(1,A))}}wrap(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}}function uv(h,l){return l[0]-h[0]}function Ef(h){return h[1]-h[0]+1}function Rl(h,l){return h[1]>=h[0]&&h[1]<l}function dv(h,l){if(h[0]>h[1])return[null,null];const d=Ef(h);if(l){if(d===2)return[h,null];const _=Math.floor(d/2);return[[h[0],h[0]+_],[h[0]+_,h[1]]]}if(d===1)return[h,null];const g=Math.floor(d/2)-1;return[[h[0],h[0]+g],[h[0]+g+1,h[1]]]}function hv(h,l){if(!Rl(l,h.length))return[1/0,1/0,-1/0,-1/0];const d=[1/0,1/0,-1/0,-1/0];for(let g=l[0];g<=l[1];++g)Pc(d,h[g]);return d}function _p(h){const l=[1/0,1/0,-1/0,-1/0];for(const d of h)for(const g of d)Pc(l,g);return l}function gj(h){return h[0]!==-1/0&&h[1]!==-1/0&&h[2]!==1/0&&h[3]!==1/0}function fv(h,l,d){if(!gj(h)||!gj(l))return NaN;let g=0,_=0;return h[2]<l[0]&&(g=l[0]-h[2]),h[0]>l[2]&&(g=h[0]-l[2]),h[1]>l[3]&&(_=h[1]-l[3]),h[3]<l[1]&&(_=l[1]-h[3]),d.distance([0,0],[g,_])}function xu(h,l,d){const g=d.pointOnLine(l,h);return d.distance(h,g.point)}function mv(h,l,d,g,_){const C=Math.min(xu(h,[d,g],_),xu(l,[d,g],_)),A=Math.min(xu(d,[h,l],_),xu(g,[h,l],_));return Math.min(C,A)}function En(h,l,d,g,_){if(!Rl(l,h.length)||!Rl(g,d.length))return 1/0;let C=1/0;for(let A=l[0];A<l[1];++A){const M=h[A],L=h[A+1];for(let q=g[0];q<g[1];++q){const U=d[q],H=d[q+1];if(Tf(M,L,U,H))return 0;C=Math.min(C,mv(M,L,U,H,_))}}return C}function OP(h,l,d,g,_){if(!Rl(l,h.length)||!Rl(g,d.length))return NaN;let C=1/0;for(let A=l[0];A<=l[1];++A)for(let M=g[0];M<=g[1];++M)if(C=Math.min(C,_.distance(h[A],d[M])),C===0)return C;return C}function IP(h,l,d){if(pu(h,l,!0))return 0;let g=1/0;for(const _ of l){const C=_[0],A=_[_.length-1];if(C!==A&&(g=Math.min(g,xu(h,[A,C],d)),g===0))return g;const M=d.pointOnLine(_,h);if(g=Math.min(g,d.distance(h,M.point)),g===0)return g}return g}function DP(h,l,d,g){if(!Rl(l,h.length))return NaN;for(let C=l[0];C<=l[1];++C)if(pu(h[C],d,!0))return 0;let _=1/0;for(let C=l[0];C<l[1];++C){const A=h[C],M=h[C+1];for(const L of d)for(let q=0,U=L.length,H=U-1;q<U;H=q++){const Q=L[H],ee=L[q];if(Tf(A,M,Q,ee))return 0;_=Math.min(_,mv(A,M,Q,ee,g))}}return _}function xj(h,l){for(const d of h)for(const g of d)if(pu(g,l,!0))return!0;return!1}function RP(h,l,d,g=1/0){const _=_p(h),C=_p(l);if(g!==1/0&&fv(_,C,d)>=g)return g;if(kf(_,C)){if(xj(h,l))return 0}else if(xj(l,h))return 0;let A=1/0;for(const M of h)for(let L=0,q=M.length,U=q-1;L<q;U=L++){const H=M[U],Q=M[L];for(const ee of l)for(let oe=0,fe=ee.length,be=fe-1;oe<fe;be=oe++){const Pe=ee[be],Qe=ee[oe];if(Tf(H,Q,Pe,Qe))return 0;A=Math.min(A,mv(H,Q,Pe,Qe,d))}}return A}function yj(h,l,d,g,_,C){if(!C)return;const A=fv(hv(g,C),_,d);A<l&&h.push([A,C,[0,0]])}function bp(h,l,d,g,_,C,A){if(!C||!A)return;const M=fv(hv(g,C),hv(_,A),d);M<l&&h.push([M,C,A])}function jp(h,l,d,g,_=1/0){let C=Math.min(g.distance(h[0],d[0][0]),_);if(C===0)return C;const A=new fj([[0,[0,h.length-1],[0,0]]],uv),M=_p(d);for(;A.length>0;){const L=A.pop();if(L[0]>=C)continue;const q=L[1],U=l?50:100;if(Ef(q)<=U){if(!Rl(q,h.length))return NaN;if(l){const H=DP(h,q,d,g);if(isNaN(H)||H===0)return H;C=Math.min(C,H)}else for(let H=q[0];H<=q[1];++H){const Q=IP(h[H],d,g);if(C=Math.min(C,Q),C===0)return 0}}else{const H=dv(q,l);yj(A,C,g,h,M,H[0]),yj(A,C,g,h,M,H[1])}}return C}function wp(h,l,d,g,_,C=1/0){let A=Math.min(C,_.distance(h[0],d[0]));if(A===0)return A;const M=new fj([[0,[0,h.length-1],[0,d.length-1]]],uv);for(;M.length>0;){const L=M.pop();if(L[0]>=A)continue;const q=L[1],U=L[2],H=l?50:100,Q=g?50:100;if(Ef(q)<=H&&Ef(U)<=Q){if(!Rl(q,h.length)&&Rl(U,d.length))return NaN;let ee;if(l&&g)ee=En(h,q,d,U,_),A=Math.min(A,ee);else if(l&&!g){const oe=h.slice(q[0],q[1]+1);for(let fe=U[0];fe<=U[1];++fe)if(ee=xu(d[fe],oe,_),A=Math.min(A,ee),A===0)return A}else if(!l&&g){const oe=d.slice(U[0],U[1]+1);for(let fe=q[0];fe<=q[1];++fe)if(ee=xu(h[fe],oe,_),A=Math.min(A,ee),A===0)return A}else ee=OP(h,q,d,U,_),A=Math.min(A,ee)}else{const ee=dv(q,l),oe=dv(U,g);bp(M,A,_,h,d,ee[0],oe[0]),bp(M,A,_,h,d,ee[0],oe[1]),bp(M,A,_,h,d,ee[1],oe[0]),bp(M,A,_,h,d,ee[1],oe[1])}}return A}function pv(h){return h.type==="MultiPolygon"?h.coordinates.map(l=>({type:"Polygon",coordinates:l})):h.type==="MultiLineString"?h.coordinates.map(l=>({type:"LineString",coordinates:l})):h.type==="MultiPoint"?h.coordinates.map(l=>({type:"Point",coordinates:l})):[h]}class yu{constructor(l,d){this.type=Dt,this.geojson=l,this.geometries=d}static parse(l,d){if(l.length!==2)return d.error(`'distance' expression requires exactly one argument, but found ${l.length-1} instead.`);if(al(l[1])){const g=l[1];if(g.type==="FeatureCollection")return new yu(g,g.features.map(_=>pv(_.geometry)).flat());if(g.type==="Feature")return new yu(g,pv(g.geometry));if("type"in g&&"coordinates"in g)return new yu(g,pv(g))}return d.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return function(d,g){const _=d.geometry(),C=_.flat().map(L=>nv([L.x,L.y],d.canonical));if(_.length===0)return NaN;const A=new cv(C[0][1]);let M=1/0;for(const L of g){switch(L.type){case"Point":M=Math.min(M,wp(C,!1,[L.coordinates],!1,A,M));break;case"LineString":M=Math.min(M,wp(C,!1,L.coordinates,!0,A,M));break;case"Polygon":M=Math.min(M,jp(C,!1,L.coordinates,A,M))}if(M===0)return M}return M}(l,this.geometries);if(l.geometryType()==="LineString")return function(d,g){const _=d.geometry(),C=_.flat().map(L=>nv([L.x,L.y],d.canonical));if(_.length===0)return NaN;const A=new cv(C[0][1]);let M=1/0;for(const L of g){switch(L.type){case"Point":M=Math.min(M,wp(C,!0,[L.coordinates],!1,A,M));break;case"LineString":M=Math.min(M,wp(C,!0,L.coordinates,!0,A,M));break;case"Polygon":M=Math.min(M,jp(C,!0,L.coordinates,A,M))}if(M===0)return M}return M}(l,this.geometries);if(l.geometryType()==="Polygon")return function(d,g){const _=d.geometry();if(_.length===0||_[0].length===0)return NaN;const C=yp(_,0).map(L=>L.map(q=>q.map(U=>nv([U.x,U.y],d.canonical)))),A=new cv(C[0][0][0][1]);let M=1/0;for(const L of g)for(const q of C){switch(L.type){case"Point":M=Math.min(M,jp([L.coordinates],!1,q,A,M));break;case"LineString":M=Math.min(M,jp(L.coordinates,!0,q,A,M));break;case"Polygon":M=Math.min(M,RP(q,L.coordinates,A,M))}if(M===0)return M}return M}(l,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Mf{constructor(l){this.type=Xr,this.key=l}static parse(l,d){if(l.length!==2)return d.error(`Expected 1 argument, but found ${l.length-1} instead.`);const g=l[1];return g==null?d.error("Global state property must be defined."):typeof g!="string"?d.error(`Global state property must be string, but found ${typeof l[1]} instead.`):new Mf(g)}evaluate(l){var d;const g=(d=l.globals)===null||d===void 0?void 0:d.globalState;return g&&Object.keys(g).length!==0?vf(g,this.key):null}eachChild(){}outputDefined(){return!1}}const Fd={"==":tv,"!=":NP,">":pp,"<":lj,">=":Co,"<=":gp,array:jn,at:bf,boolean:jn,case:dp,coalesce:Pf,collator:Cf,format:xp,image:Af,in:Dd,"index-of":jf,interpolate:Mn,"interpolate-hcl":Mn,"interpolate-lab":Mn,length:rv,let:Id,literal:Sc,match:wf,number:jn,"number-format":Ld,object:jn,slice:hp,step:Rd,string:jn,"to-boolean":nn,"to-color":nn,"to-number":nn,"to-string":nn,var:so,within:gu,distance:yu,"global-state":Mf};class ao{constructor(l,d,g,_){this.name=l,this.type=d,this._evaluate=g,this.args=_}evaluate(l){return this._evaluate(l,this.args)}eachChild(l){this.args.forEach(l)}outputDefined(){return!1}static parse(l,d){const g=l[0],_=ao.definitions[g];if(!_)return d.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0);const C=Array.isArray(_)?_[0]:_.type,A=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,M=A.filter(([q])=>!Array.isArray(q)||q.length===l.length-1);let L=null;for(const[q,U]of M){L=new vn(d.registry,Sp,d.path,null,d.scope);const H=[];let Q=!1;for(let ee=1;ee<l.length;ee++){const oe=l[ee],fe=Array.isArray(q)?q[ee-1]:q.type,be=L.parse(oe,1+H.length,fe);if(!be){Q=!0;break}H.push(be)}if(!Q)if(Array.isArray(q)&&q.length!==H.length)L.error(`Expected ${q.length} arguments, but found ${H.length} instead.`);else{for(let ee=0;ee<H.length;ee++){const oe=Array.isArray(q)?q[ee]:q.type,fe=H[ee];L.concat(ee+1).checkSubtype(oe,fe.type)}if(L.errors.length===0)return new ao(g,C,U,H)}}if(M.length===1)d.errors.push(...L.errors);else{const q=(M.length?M:A).map(([H])=>{return Q=H,Array.isArray(Q)?`(${Q.map(ls).join(", ")})`:`(${ls(Q.type)}...)`;var Q}).join(" | "),U=[];for(let H=1;H<l.length;H++){const Q=d.parse(l[H],1+U.length);if(!Q)return null;U.push(ls(Q.type))}d.error(`Expected arguments of type ${q}, but found (${U.join(", ")}) instead.`)}return null}static register(l,d){ao.definitions=d;for(const g in d)l[g]=ao}}function vj(h,[l,d,g,_]){l=l.evaluate(h),d=d.evaluate(h),g=g.evaluate(h);const C=_?_.evaluate(h):1,A=_f(l,d,g,C);if(A)throw new Qn(A);return new Ur(l/255,d/255,g/255,C,!1)}function _j(h,l){return h in l}function gv(h,l){const d=l[h];return d===void 0?null:d}function vu(h){return{type:h}}function Sp(h){if(h instanceof so)return Sp(h.boundExpression);if(h instanceof ao&&h.name==="error"||h instanceof Cf||h instanceof gu||h instanceof yu||h instanceof Mf)return!1;const l=h instanceof nn||h instanceof jn;let d=!0;return h.eachChild(g=>{d=l?d&&Sp(g):d&&g instanceof Sc}),!!d&&Np(h)&&Pp(h,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Np(h){if(h instanceof ao&&(h.name==="get"&&h.args.length===1||h.name==="feature-state"||h.name==="has"&&h.args.length===1||h.name==="properties"||h.name==="geometry-type"||h.name==="id"||/^filter-/.test(h.name))||h instanceof gu||h instanceof yu)return!1;let l=!0;return h.eachChild(d=>{l&&!Np(d)&&(l=!1)}),l}function Of(h){if(h instanceof ao&&h.name==="feature-state")return!1;let l=!0;return h.eachChild(d=>{l&&!Of(d)&&(l=!1)}),l}function Pp(h,l){if(h instanceof ao&&l.indexOf(h.name)>=0)return!1;let d=!0;return h.eachChild(g=>{d&&!Pp(g,l)&&(d=!1)}),d}function bj(h){return{result:"success",value:h}}function zd(h){return{result:"error",value:h}}function $d(h){return h["property-type"]==="data-driven"||h["property-type"]==="cross-faded-data-driven"}function jj(h){return!!h.expression&&h.expression.parameters.indexOf("zoom")>-1}function xv(h){return!!h.expression&&h.expression.interpolated}function cn(h){return h instanceof Number?"number":h instanceof String?"string":h instanceof Boolean?"boolean":Array.isArray(h)?"array":h===null?"null":typeof h}function Cp(h){return typeof h=="object"&&h!==null&&!Array.isArray(h)&&Es(h)===jc}function LP(h){return h}function wj(h,l){const d=h.stops&&typeof h.stops[0][0]=="object",g=d||!(d||h.property!==void 0),_=h.type||(xv(l)?"exponential":"interval"),C=function(U){switch(U.type){case"color":return Ur.parse;case"padding":return Hi.parse;case"numberArray":return Di.parse;case"colorArray":return Vs.parse;default:return null}}(l);if(C&&((h=Ts({},h)).stops&&(h.stops=h.stops.map(U=>[U[0],C(U[1])])),h.default=C(h.default?h.default:l.default)),h.colorSpace&&(A=h.colorSpace)!=="rgb"&&A!=="hcl"&&A!=="lab")throw new Error(`Unknown color space: "${h.colorSpace}"`);var A;const M=function(U){switch(U){case"exponential":return Sj;case"interval":return zP;case"categorical":return FP;case"identity":return Nj;default:throw new Error(`Unknown function type "${U}"`)}}(_);let L,q;if(_==="categorical"){L=Object.create(null);for(const U of h.stops)L[U[0]]=U[1];q=typeof h.stops[0][0]}if(d){const U={},H=[];for(let oe=0;oe<h.stops.length;oe++){const fe=h.stops[oe],be=fe[0].zoom;U[be]===void 0&&(U[be]={zoom:be,type:h.type,property:h.property,default:h.default,stops:[]},H.push(be)),U[be].stops.push([fe[0].value,fe[1]])}const Q=[];for(const oe of H)Q.push([U[oe].zoom,wj(U[oe],l)]);const ee={name:"linear"};return{kind:"composite",interpolationType:ee,interpolationFactor:Mn.interpolationFactor.bind(void 0,ee),zoomStops:Q.map(oe=>oe[0]),evaluate:({zoom:oe},fe)=>Sj({stops:Q,base:h.base},l,oe).evaluate(oe,fe)}}if(g){const U=_==="exponential"?{name:"exponential",base:h.base!==void 0?h.base:1}:null;return{kind:"camera",interpolationType:U,interpolationFactor:Mn.interpolationFactor.bind(void 0,U),zoomStops:h.stops.map(H=>H[0]),evaluate:({zoom:H})=>M(h,l,H,L,q)}}return{kind:"source",evaluate(U,H){const Q=H&&H.properties?H.properties[h.property]:void 0;return Q===void 0?_u(h.default,l.default):M(h,l,Q,L,q)}}}function _u(h,l,d){return h!==void 0?h:l!==void 0?l:d!==void 0?d:void 0}function FP(h,l,d,g,_){return _u(typeof d===_?g[d]:void 0,h.default,l.default)}function zP(h,l,d){if(cn(d)!=="number")return _u(h.default,l.default);const g=h.stops.length;if(g===1||d<=h.stops[0][0])return h.stops[0][1];if(d>=h.stops[g-1][0])return h.stops[g-1][1];const _=Sf(h.stops.map(C=>C[0]),d);return h.stops[_][1]}function Sj(h,l,d){const g=h.base!==void 0?h.base:1;if(cn(d)!=="number")return _u(h.default,l.default);const _=h.stops.length;if(_===1||d<=h.stops[0][0])return h.stops[0][1];if(d>=h.stops[_-1][0])return h.stops[_-1][1];const C=Sf(h.stops.map(U=>U[0]),d),A=function(U,H,Q,ee){const oe=ee-Q,fe=U-Q;return oe===0?0:H===1?fe/oe:(Math.pow(H,fe)-1)/(Math.pow(H,oe)-1)}(d,g,h.stops[C][0],h.stops[C+1][0]),M=h.stops[C][1],L=h.stops[C+1][1],q=io[l.type]||LP;return typeof M.evaluate=="function"?{evaluate(...U){const H=M.evaluate.apply(void 0,U),Q=L.evaluate.apply(void 0,U);if(H!==void 0&&Q!==void 0)return q(H,Q,A,h.colorSpace)}}:q(M,L,A,h.colorSpace)}function Nj(h,l,d){switch(l.type){case"color":d=Ur.parse(d);break;case"formatted":d=ba.fromString(d.toString());break;case"resolvedImage":d=ca.fromString(d.toString());break;case"padding":d=Hi.parse(d);break;case"colorArray":d=Vs.parse(d);break;case"numberArray":d=Di.parse(d);break;default:cn(d)===l.type||l.type==="enum"&&l.values[d]||(d=void 0)}return _u(d,h.default,l.default)}ao.register(Fd,{error:[{kind:"error"},[Kr],(h,[l])=>{throw new Qn(l.evaluate(h))}],typeof:[Kr,[Xr],(h,[l])=>ls(Es(l.evaluate(h)))],"to-rgba":[Ki(Dt,4),[Po],(h,[l])=>{const[d,g,_,C]=l.evaluate(h).rgb;return[255*d,255*g,255*_,C]}],rgb:[Po,[Dt,Dt,Dt],vj],rgba:[Po,[Dt,Dt,Dt,Dt],vj],has:{type:rn,overloads:[[[Kr],(h,[l])=>_j(l.evaluate(h),h.properties())],[[Kr,jc],(h,[l,d])=>_j(l.evaluate(h),d.evaluate(h))]]},get:{type:Xr,overloads:[[[Kr],(h,[l])=>gv(l.evaluate(h),h.properties())],[[Kr,jc],(h,[l,d])=>gv(l.evaluate(h),d.evaluate(h))]]},"feature-state":[Xr,[Kr],(h,[l])=>gv(l.evaluate(h),h.featureState||{})],properties:[jc,[],h=>h.properties()],"geometry-type":[Kr,[],h=>h.geometryType()],id:[Xr,[],h=>h.id()],zoom:[Dt,[],h=>h.globals.zoom],"heatmap-density":[Dt,[],h=>h.globals.heatmapDensity||0],elevation:[Dt,[],h=>h.globals.elevation||0],"line-progress":[Dt,[],h=>h.globals.lineProgress||0],accumulated:[Xr,[],h=>h.globals.accumulated===void 0?null:h.globals.accumulated],"+":[Dt,vu(Dt),(h,l)=>{let d=0;for(const g of l)d+=g.evaluate(h);return d}],"*":[Dt,vu(Dt),(h,l)=>{let d=1;for(const g of l)d*=g.evaluate(h);return d}],"-":{type:Dt,overloads:[[[Dt,Dt],(h,[l,d])=>l.evaluate(h)-d.evaluate(h)],[[Dt],(h,[l])=>-l.evaluate(h)]]},"/":[Dt,[Dt,Dt],(h,[l,d])=>l.evaluate(h)/d.evaluate(h)],"%":[Dt,[Dt,Dt],(h,[l,d])=>l.evaluate(h)%d.evaluate(h)],ln2:[Dt,[],()=>Math.LN2],pi:[Dt,[],()=>Math.PI],e:[Dt,[],()=>Math.E],"^":[Dt,[Dt,Dt],(h,[l,d])=>Math.pow(l.evaluate(h),d.evaluate(h))],sqrt:[Dt,[Dt],(h,[l])=>Math.sqrt(l.evaluate(h))],log10:[Dt,[Dt],(h,[l])=>Math.log(l.evaluate(h))/Math.LN10],ln:[Dt,[Dt],(h,[l])=>Math.log(l.evaluate(h))],log2:[Dt,[Dt],(h,[l])=>Math.log(l.evaluate(h))/Math.LN2],sin:[Dt,[Dt],(h,[l])=>Math.sin(l.evaluate(h))],cos:[Dt,[Dt],(h,[l])=>Math.cos(l.evaluate(h))],tan:[Dt,[Dt],(h,[l])=>Math.tan(l.evaluate(h))],asin:[Dt,[Dt],(h,[l])=>Math.asin(l.evaluate(h))],acos:[Dt,[Dt],(h,[l])=>Math.acos(l.evaluate(h))],atan:[Dt,[Dt],(h,[l])=>Math.atan(l.evaluate(h))],min:[Dt,vu(Dt),(h,l)=>Math.min(...l.map(d=>d.evaluate(h)))],max:[Dt,vu(Dt),(h,l)=>Math.max(...l.map(d=>d.evaluate(h)))],abs:[Dt,[Dt],(h,[l])=>Math.abs(l.evaluate(h))],round:[Dt,[Dt],(h,[l])=>{const d=l.evaluate(h);return d<0?-Math.round(-d):Math.round(d)}],floor:[Dt,[Dt],(h,[l])=>Math.floor(l.evaluate(h))],ceil:[Dt,[Dt],(h,[l])=>Math.ceil(l.evaluate(h))],"filter-==":[rn,[Kr,Xr],(h,[l,d])=>h.properties()[l.value]===d.value],"filter-id-==":[rn,[Xr],(h,[l])=>h.id()===l.value],"filter-type-==":[rn,[Kr],(h,[l])=>h.geometryType()===l.value],"filter-<":[rn,[Kr,Xr],(h,[l,d])=>{const g=h.properties()[l.value],_=d.value;return typeof g==typeof _&&g<_}],"filter-id-<":[rn,[Xr],(h,[l])=>{const d=h.id(),g=l.value;return typeof d==typeof g&&d<g}],"filter->":[rn,[Kr,Xr],(h,[l,d])=>{const g=h.properties()[l.value],_=d.value;return typeof g==typeof _&&g>_}],"filter-id->":[rn,[Xr],(h,[l])=>{const d=h.id(),g=l.value;return typeof d==typeof g&&d>g}],"filter-<=":[rn,[Kr,Xr],(h,[l,d])=>{const g=h.properties()[l.value],_=d.value;return typeof g==typeof _&&g<=_}],"filter-id-<=":[rn,[Xr],(h,[l])=>{const d=h.id(),g=l.value;return typeof d==typeof g&&d<=g}],"filter->=":[rn,[Kr,Xr],(h,[l,d])=>{const g=h.properties()[l.value],_=d.value;return typeof g==typeof _&&g>=_}],"filter-id->=":[rn,[Xr],(h,[l])=>{const d=h.id(),g=l.value;return typeof d==typeof g&&d>=g}],"filter-has":[rn,[Xr],(h,[l])=>l.value in h.properties()],"filter-has-id":[rn,[],h=>h.id()!==null&&h.id()!==void 0],"filter-type-in":[rn,[Ki(Kr)],(h,[l])=>l.value.indexOf(h.geometryType())>=0],"filter-id-in":[rn,[Ki(Xr)],(h,[l])=>l.value.indexOf(h.id())>=0],"filter-in-small":[rn,[Kr,Ki(Xr)],(h,[l,d])=>d.value.indexOf(h.properties()[l.value])>=0],"filter-in-large":[rn,[Kr,Ki(Xr)],(h,[l,d])=>function(g,_,C,A){for(;C<=A;){const M=C+A>>1;if(_[M]===g)return!0;_[M]>g?A=M-1:C=M+1}return!1}(h.properties()[l.value],d.value,0,d.value.length-1)],all:{type:rn,overloads:[[[rn,rn],(h,[l,d])=>l.evaluate(h)&&d.evaluate(h)],[vu(rn),(h,l)=>{for(const d of l)if(!d.evaluate(h))return!1;return!0}]]},any:{type:rn,overloads:[[[rn,rn],(h,[l,d])=>l.evaluate(h)||d.evaluate(h)],[vu(rn),(h,l)=>{for(const d of l)if(d.evaluate(h))return!0;return!1}]]},"!":[rn,[rn],(h,[l])=>!l.evaluate(h)],"is-supported-script":[rn,[Kr],(h,[l])=>{const d=h.globals&&h.globals.isSupportedScript;return!d||d(l.evaluate(h))}],upcase:[Kr,[Kr],(h,[l])=>l.evaluate(h).toUpperCase()],downcase:[Kr,[Kr],(h,[l])=>l.evaluate(h).toLowerCase()],concat:[Kr,vu(Xr),(h,l)=>l.map(d=>Od(d.evaluate(h))).join("")],"resolved-locale":[Kr,[gf],(h,[l])=>l.evaluate(h).resolvedLocale()]});class yv{constructor(l,d,g){this.expression=l,this._warningHistory={},this._evaluator=new up,this._defaultValue=d?function(_){if(_.type==="color"&&Cp(_.default))return new Ur(0,0,0,0);switch(_.type){case"color":return Ur.parse(_.default)||null;case"padding":return Hi.parse(_.default)||null;case"numberArray":return Di.parse(_.default)||null;case"colorArray":return Vs.parse(_.default)||null;case"variableAnchorOffsetCollection":return Zi.parse(_.default)||null;case"projectionDefinition":return $a.parse(_.default)||null;default:return _.default===void 0?null:_.default}}(d):null,this._enumValues=d&&d.type==="enum"?d.values:null,this._globalState=g}evaluateWithoutErrorHandling(l,d,g,_,C,A){return this._globalState&&(l=ju(l,this._globalState)),this._evaluator.globals=l,this._evaluator.feature=d,this._evaluator.featureState=g,this._evaluator.canonical=_,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=A,this.expression.evaluate(this._evaluator)}evaluate(l,d,g,_,C,A){this._globalState&&(l=ju(l,this._globalState)),this._evaluator.globals=l,this._evaluator.feature=d||null,this._evaluator.featureState=g||null,this._evaluator.canonical=_,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=A||null;try{const M=this.expression.evaluate(this._evaluator);if(M==null||typeof M=="number"&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new Qn(`Expected value to be one of ${Object.keys(this._enumValues).map(L=>JSON.stringify(L)).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,typeof console<"u"&&console.warn(M.message)),this._defaultValue}}}function Ap(h){return Array.isArray(h)&&h.length>0&&typeof h[0]=="string"&&h[0]in Fd}function bu(h,l,d){const g=new vn(Fd,Sp,[],l?function(C){const A={color:Po,string:Kr,number:Dt,enum:Kr,boolean:rn,formatted:lu,padding:sl,numberArray:xf,colorArray:wc,projectionDefinition:pf,resolvedImage:cu,variableAnchorOffsetCollection:ap};return C.type==="array"?Ki(A[C.value]||Xr,C.length):A[C.type]}(l):void 0),_=g.parse(h,void 0,void 0,void 0,l&&l.type==="string"?{typeAnnotation:"coerce"}:void 0);return _?bj(new yv(_,l,d)):zd(g.errors)}class If{constructor(l,d,g){this.kind=l,this._styleExpression=d,this.isStateDependent=l!=="constant"&&!Of(d.expression),this.globalStateRefs=Ep(d.expression),this._globalState=g}evaluateWithoutErrorHandling(l,d,g,_,C,A){return this._globalState&&(l=ju(l,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(l,d,g,_,C,A)}evaluate(l,d,g,_,C,A){return this._globalState&&(l=ju(l,this._globalState)),this._styleExpression.evaluate(l,d,g,_,C,A)}}class vv{constructor(l,d,g,_,C){this.kind=l,this.zoomStops=g,this._styleExpression=d,this.isStateDependent=l!=="camera"&&!Of(d.expression),this.globalStateRefs=Ep(d.expression),this.interpolationType=_,this._globalState=C}evaluateWithoutErrorHandling(l,d,g,_,C,A){return this._globalState&&(l=ju(l,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(l,d,g,_,C,A)}evaluate(l,d,g,_,C,A){return this._globalState&&(l=ju(l,this._globalState)),this._styleExpression.evaluate(l,d,g,_,C,A)}interpolationFactor(l,d,g){return this.interpolationType?Mn.interpolationFactor(this.interpolationType,l,d,g):0}}function Pj(h,l,d){const g=bu(h,l,d);if(g.result==="error")return g;const _=g.value.expression,C=Np(_);if(!C&&!$d(l))return zd([new la("","data expressions not supported")]);const A=Pp(_,["zoom"]);if(!A&&!jj(l))return zd([new la("","zoom expressions not supported")]);const M=Tp(_);return M||A?M instanceof la?zd([M]):M instanceof Mn&&!xv(l)?zd([new la("",'"interpolate" expressions cannot be used with this property')]):bj(M?new vv(C?"camera":"composite",g.value,M.labels,M instanceof Mn?M.interpolation:void 0,d):new If(C?"constant":"source",g.value,d)):zd([new la("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class kp{constructor(l,d){this._parameters=l,this._specification=d,Ts(this,wj(this._parameters,this._specification))}static deserialize(l){return new kp(l._parameters,l._specification)}static serialize(l){return{_parameters:l._parameters,_specification:l._specification}}}function Tp(h){let l=null;if(h instanceof Id)l=Tp(h.result);else if(h instanceof Pf){for(const d of h.args)if(l=Tp(d),l)break}else(h instanceof Rd||h instanceof Mn)&&h.input instanceof ao&&h.input.name==="zoom"&&(l=h);return l instanceof la||h.eachChild(d=>{const g=Tp(d);g instanceof la?l=g:!l&&g?l=new la("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):l&&g&&l!==g&&(l=new la("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),l}function Ep(h,l=new Set){return h instanceof Mf&&l.add(h.key),h.eachChild(d=>{Ep(d,l)}),l}function ju(h,l){const{zoom:d,heatmapDensity:g,elevation:_,lineProgress:C,isSupportedScript:A,accumulated:M}=h??{};return{zoom:d,heatmapDensity:g,elevation:_,lineProgress:C,isSupportedScript:A,accumulated:M,globalState:l}}function Mp(h){if(h===!0||h===!1)return!0;if(!Array.isArray(h)||h.length===0)return!1;switch(h[0]){case"has":return h.length>=2&&h[1]!=="$id"&&h[1]!=="$type";case"in":return h.length>=3&&(typeof h[1]!="string"||Array.isArray(h[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return h.length!==3||Array.isArray(h[1])||Array.isArray(h[2]);case"any":case"all":for(const l of h.slice(1))if(!Mp(l)&&typeof l!="boolean")return!1;return!0;default:return!0}}const $P={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Df(h,l){if(h==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Mp(h)||(h=Rf(h));const d=bu(h,$P,l);if(d.result==="error")throw new Error(d.value.map(g=>`${g.key}: ${g.message}`).join(", "));return{filter:(g,_,C)=>d.value.evaluate(g,_,{},C),needGeometry:_v(h),getGlobalStateRefs:()=>Ep(d.value.expression)}}function Cj(h,l){return h<l?-1:h>l?1:0}function _v(h){if(!Array.isArray(h))return!1;if(h[0]==="within"||h[0]==="distance")return!0;for(let l=1;l<h.length;l++)if(_v(h[l]))return!0;return!1}function Rf(h){if(!h)return!0;const l=h[0];return h.length<=1?l!=="any":l==="=="?bv(h[1],h[2],"=="):l==="!="?Op(bv(h[1],h[2],"==")):l==="<"||l===">"||l==="<="||l===">="?bv(h[1],h[2],l):l==="any"?(d=h.slice(1),["any"].concat(d.map(Rf))):l==="all"?["all"].concat(h.slice(1).map(Rf)):l==="none"?["all"].concat(h.slice(1).map(Rf).map(Op)):l==="in"?Aj(h[1],h.slice(2)):l==="!in"?Op(Aj(h[1],h.slice(2))):l==="has"?kj(h[1]):l!=="!has"||Op(kj(h[1]));var d}function bv(h,l,d){switch(h){case"$type":return[`filter-type-${d}`,l];case"$id":return[`filter-id-${d}`,l];default:return[`filter-${d}`,h,l]}}function Aj(h,l){if(l.length===0)return!1;switch(h){case"$type":return["filter-type-in",["literal",l]];case"$id":return["filter-id-in",["literal",l]];default:return l.length>200&&!l.some(d=>typeof d!=typeof l[0])?["filter-in-large",h,["literal",l.sort(Cj)]]:["filter-in-small",h,["literal",l]]}}function kj(h){switch(h){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",h]}}function Op(h){return["!",h]}function Ip(h){const l=typeof h;if(l==="number"||l==="boolean"||l==="string"||h==null)return JSON.stringify(h);if(Array.isArray(h)){let _="[";for(const C of h)_+=`${Ip(C)},`;return`${_}]`}const d=Object.keys(h).sort();let g="{";for(let _=0;_<d.length;_++)g+=`${JSON.stringify(d[_])}:${Ip(h[d[_]])},`;return`${g}}`}function Tj(h){let l="";for(const d of Qr)l+=`/${Ip(h[d])}`;return l}function Dp(h){const l=h.value;return l?[new wt(h.key,l,"constants have been deprecated as of v8")]:[]}function cs(h){return h instanceof Number||h instanceof String||h instanceof Boolean?h.valueOf():h}function Ll(h){if(Array.isArray(h))return h.map(Ll);if(h instanceof Object&&!(h instanceof Number||h instanceof String||h instanceof Boolean)){const l={};for(const d in h)l[d]=Ll(h[d]);return l}return cs(h)}function ja(h){const l=h.key,d=h.value,g=h.valueSpec||{},_=h.objectElementValidators||{},C=h.style,A=h.styleSpec,M=h.validateSpec;let L=[];const q=cn(d);if(q!=="object")return[new wt(l,d,`object expected, ${q} found`)];for(const U in d){const H=U.split(".")[0],Q=vf(g,H)||g["*"];let ee;if(vf(_,H))ee=_[H];else if(vf(g,H))ee=M;else if(_["*"])ee=_["*"];else{if(!g["*"]){L.push(new wt(l,d[U],`unknown property "${U}"`));continue}ee=M}L=L.concat(ee({key:(l&&`${l}.`)+U,value:d[U],valueSpec:Q,style:C,styleSpec:A,object:d,objectKey:U,validateSpec:M},d))}for(const U in g)_[U]||g[U].required&&g[U].default===void 0&&d[U]===void 0&&L.push(new wt(l,d,`missing required property "${U}"`));return L}function Bd(h){const l=h.value,d=h.valueSpec,g=h.style,_=h.styleSpec,C=h.key,A=h.arrayElementValidator||h.validateSpec;if(cn(l)!=="array")return[new wt(C,l,`array expected, ${cn(l)} found`)];if(d.length&&l.length!==d.length)return[new wt(C,l,`array length ${d.length} expected, length ${l.length} found`)];if(d["min-length"]&&l.length<d["min-length"])return[new wt(C,l,`array length at least ${d["min-length"]} expected, length ${l.length} found`)];let M={type:d.value,values:d.values};_.$version<7&&(M.function=d.function),cn(d.value)==="object"&&(M=d.value);let L=[];for(let q=0;q<l.length;q++)L=L.concat(A({array:l,arrayIndex:q,value:l[q],valueSpec:M,validateSpec:h.validateSpec,style:g,styleSpec:_,key:`${C}[${q}]`}));return L}function Rp(h){const l=h.key,d=h.value,g=h.valueSpec;let _=cn(d);return _==="number"&&d!=d&&(_="NaN"),_!=="number"?[new wt(l,d,`number expected, ${_} found`)]:"minimum"in g&&d<g.minimum?[new wt(l,d,`${d} is less than the minimum value ${g.minimum}`)]:"maximum"in g&&d>g.maximum?[new wt(l,d,`${d} is greater than the maximum value ${g.maximum}`)]:[]}function Ej(h){const l=h.valueSpec,d=cs(h.value.type);let g,_,C,A={};const M=d!=="categorical"&&h.value.property===void 0,L=!M,q=cn(h.value.stops)==="array"&&cn(h.value.stops[0])==="array"&&cn(h.value.stops[0][0])==="object",U=ja({key:h.key,value:h.value,valueSpec:h.styleSpec.function,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{stops:function(ee){if(d==="identity")return[new wt(ee.key,ee.value,'identity function may not have a "stops" property')];let oe=[];const fe=ee.value;return oe=oe.concat(Bd({key:ee.key,value:fe,valueSpec:ee.valueSpec,validateSpec:ee.validateSpec,style:ee.style,styleSpec:ee.styleSpec,arrayElementValidator:H})),cn(fe)==="array"&&fe.length===0&&oe.push(new wt(ee.key,fe,"array must have at least one stop")),oe},default:function(ee){return ee.validateSpec({key:ee.key,value:ee.value,valueSpec:l,validateSpec:ee.validateSpec,style:ee.style,styleSpec:ee.styleSpec})}}});return d==="identity"&&M&&U.push(new wt(h.key,h.value,'missing required property "property"')),d==="identity"||h.value.stops||U.push(new wt(h.key,h.value,'missing required property "stops"')),d==="exponential"&&h.valueSpec.expression&&!xv(h.valueSpec)&&U.push(new wt(h.key,h.value,"exponential functions not supported")),h.styleSpec.$version>=8&&(L&&!$d(h.valueSpec)?U.push(new wt(h.key,h.value,"property functions not supported")):M&&!jj(h.valueSpec)&&U.push(new wt(h.key,h.value,"zoom functions not supported"))),d!=="categorical"&&!q||h.value.property!==void 0||U.push(new wt(h.key,h.value,'"property" property is required')),U;function H(ee){let oe=[];const fe=ee.value,be=ee.key;if(cn(fe)!=="array")return[new wt(be,fe,`array expected, ${cn(fe)} found`)];if(fe.length!==2)return[new wt(be,fe,`array length 2 expected, length ${fe.length} found`)];if(q){if(cn(fe[0])!=="object")return[new wt(be,fe,`object expected, ${cn(fe[0])} found`)];if(fe[0].zoom===void 0)return[new wt(be,fe,"object stop key must have zoom")];if(fe[0].value===void 0)return[new wt(be,fe,"object stop key must have value")];if(C&&C>cs(fe[0].zoom))return[new wt(be,fe[0].zoom,"stop zoom values must appear in ascending order")];cs(fe[0].zoom)!==C&&(C=cs(fe[0].zoom),_=void 0,A={}),oe=oe.concat(ja({key:`${be}[0]`,value:fe[0],valueSpec:{zoom:{}},validateSpec:ee.validateSpec,style:ee.style,styleSpec:ee.styleSpec,objectElementValidators:{zoom:Rp,value:Q}}))}else oe=oe.concat(Q({key:`${be}[0]`,value:fe[0],validateSpec:ee.validateSpec,style:ee.style,styleSpec:ee.styleSpec},fe));return Ap(Ll(fe[1]))?oe.concat([new wt(`${be}[1]`,fe[1],"expressions are not allowed in function stops.")]):oe.concat(ee.validateSpec({key:`${be}[1]`,value:fe[1],valueSpec:l,validateSpec:ee.validateSpec,style:ee.style,styleSpec:ee.styleSpec}))}function Q(ee,oe){const fe=cn(ee.value),be=cs(ee.value),Pe=ee.value!==null?ee.value:oe;if(g){if(fe!==g)return[new wt(ee.key,Pe,`${fe} stop domain type must match previous stop domain type ${g}`)]}else g=fe;if(fe!=="number"&&fe!=="string"&&fe!=="boolean")return[new wt(ee.key,Pe,"stop domain value must be a number, string, or boolean")];if(fe!=="number"&&d!=="categorical"){let Qe=`number expected, ${fe} found`;return $d(l)&&d===void 0&&(Qe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new wt(ee.key,Pe,Qe)]}return d!=="categorical"||fe!=="number"||isFinite(be)&&Math.floor(be)===be?d!=="categorical"&&fe==="number"&&_!==void 0&&be<_?[new wt(ee.key,Pe,"stop domain values must appear in ascending order")]:(_=be,d==="categorical"&&be in A?[new wt(ee.key,Pe,"stop domain values must be unique")]:(A[be]=!0,[])):[new wt(ee.key,Pe,`integer expected, found ${be}`)]}}function qd(h){const l=(h.expressionContext==="property"?Pj:bu)(Ll(h.value),h.valueSpec);if(l.result==="error")return l.value.map(g=>new wt(`${h.key}${g.key}`,h.value,g.message));const d=l.value.expression||l.value._styleExpression.expression;if(h.expressionContext==="property"&&h.propertyKey==="text-font"&&!d.outputDefined())return[new wt(h.key,h.value,`Invalid data expression for "${h.propertyKey}". Output values must be contained as literals within the expression.`)];if(h.expressionContext==="property"&&h.propertyType==="layout"&&!Of(d))return[new wt(h.key,h.value,'"feature-state" data expressions are not supported with layout properties.')];if(h.expressionContext==="filter"&&!Of(d))return[new wt(h.key,h.value,'"feature-state" data expressions are not supported with filters.')];if(h.expressionContext&&h.expressionContext.indexOf("cluster")===0){if(!Pp(d,["zoom","feature-state"]))return[new wt(h.key,h.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(h.expressionContext==="cluster-initial"&&!Np(d))return[new wt(h.key,h.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function jv(h){const l=h.key,d=h.value,g=cn(d);return g!=="string"?[new wt(l,d,`color expected, ${g} found`)]:Ur.parse(String(d))?[]:[new wt(l,d,`color expected, "${d}" found`)]}function Lf(h){const l=h.key,d=h.value,g=h.valueSpec,_=[];return Array.isArray(g.values)?g.values.indexOf(cs(d))===-1&&_.push(new wt(l,d,`expected one of [${g.values.join(", ")}], ${JSON.stringify(d)} found`)):Object.keys(g.values).indexOf(cs(d))===-1&&_.push(new wt(l,d,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(d)} found`)),_}function wv(h){return Mp(Ll(h.value))?qd(Ts({},h,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Sv(h)}function Sv(h){const l=h.value,d=h.key;if(cn(l)!=="array")return[new wt(d,l,`array expected, ${cn(l)} found`)];const g=h.styleSpec;let _,C=[];if(l.length<1)return[new wt(d,l,"filter array must have at least 1 element")];switch(C=C.concat(Lf({key:`${d}[0]`,value:l[0],valueSpec:g.filter_operator,style:h.style,styleSpec:h.styleSpec})),cs(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&cs(l[1])==="$type"&&C.push(new wt(d,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&C.push(new wt(d,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(_=cn(l[1]),_!=="string"&&C.push(new wt(`${d}[1]`,l[1],`string expected, ${_} found`)));for(let A=2;A<l.length;A++)_=cn(l[A]),cs(l[1])==="$type"?C=C.concat(Lf({key:`${d}[${A}]`,value:l[A],valueSpec:g.geometry_type,style:h.style,styleSpec:h.styleSpec})):_!=="string"&&_!=="number"&&_!=="boolean"&&C.push(new wt(`${d}[${A}]`,l[A],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let A=1;A<l.length;A++)C=C.concat(Sv({key:`${d}[${A}]`,value:l[A],style:h.style,styleSpec:h.styleSpec}));break;case"has":case"!has":_=cn(l[1]),l.length!==2?C.push(new wt(d,l,`filter array for "${l[0]}" operator must have 2 elements`)):_!=="string"&&C.push(new wt(`${d}[1]`,l[1],`string expected, ${_} found`))}return C}function Nv(h,l){const d=h.key,g=h.validateSpec,_=h.style,C=h.styleSpec,A=h.value,M=h.objectKey,L=C[`${l}_${h.layerType}`];if(!L)return[];const q=M.match(/^(.*)-transition$/);if(l==="paint"&&q&&L[q[1]]&&L[q[1]].transition)return g({key:d,value:A,valueSpec:C.transition,style:_,styleSpec:C});const U=h.valueSpec||L[M];if(!U)return[new wt(d,A,`unknown property "${M}"`)];let H;if(cn(A)==="string"&&$d(U)&&!U.tokens&&(H=/^{([^}]+)}$/.exec(A)))return[new wt(d,A,`"${M}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(H[1])} }\`.`)];const Q=[];return h.layerType==="symbol"&&M==="text-font"&&Cp(Ll(A))&&cs(A.type)==="identity"&&Q.push(new wt(d,A,'"text-font" does not support identity functions')),Q.concat(g({key:h.key,value:A,valueSpec:U,style:_,styleSpec:C,expressionContext:"property",propertyType:l,propertyKey:M}))}function Ff(h){return Nv(h,"paint")}function Mj(h){return Nv(h,"layout")}function Pv(h){let l=[];const d=h.value,g=h.key,_=h.style,C=h.styleSpec;if(cn(d)!=="object")return[new wt(g,d,`object expected, ${cn(d)} found`)];d.type||d.ref||l.push(new wt(g,d,'either "type" or "ref" is required'));let A=cs(d.type);const M=cs(d.ref);if(d.id){const L=cs(d.id);for(let q=0;q<h.arrayIndex;q++){const U=_.layers[q];cs(U.id)===L&&l.push(new wt(g,d.id,`duplicate layer id "${d.id}", previously used at line ${U.id.__line__}`))}}if("ref"in d){let L;["type","source","source-layer","filter","layout"].forEach(q=>{q in d&&l.push(new wt(g,d[q],`"${q}" is prohibited for ref layers`))}),_.layers.forEach(q=>{cs(q.id)===M&&(L=q)}),L?L.ref?l.push(new wt(g,d.ref,"ref cannot reference another ref layer")):A=cs(L.type):l.push(new wt(g,d.ref,`ref layer "${M}" not found`))}else if(A!=="background")if(d.source){const L=_.sources&&_.sources[d.source],q=L&&cs(L.type);L?q==="vector"&&A==="raster"?l.push(new wt(g,d.source,`layer "${d.id}" requires a raster source`)):q!=="raster-dem"&&A==="hillshade"||q!=="raster-dem"&&A==="color-relief"?l.push(new wt(g,d.source,`layer "${d.id}" requires a raster-dem source`)):q==="raster"&&A!=="raster"?l.push(new wt(g,d.source,`layer "${d.id}" requires a vector source`)):q!=="vector"||d["source-layer"]?q==="raster-dem"&&A!=="hillshade"&&A!=="color-relief"?l.push(new wt(g,d.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):A!=="line"||!d.paint||!d.paint["line-gradient"]||q==="geojson"&&L.lineMetrics||l.push(new wt(g,d,`layer "${d.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new wt(g,d,`layer "${d.id}" must specify a "source-layer"`)):l.push(new wt(g,d.source,`source "${d.source}" not found`))}else l.push(new wt(g,d,'missing required property "source"'));return l=l.concat(ja({key:g,value:d,valueSpec:C.layer,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,objectElementValidators:{"*":()=>[],type:()=>h.validateSpec({key:`${g}.type`,value:d.type,valueSpec:C.layer.type,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,object:d,objectKey:"type"}),filter:wv,layout:L=>ja({layer:d,key:L.key,value:L.value,style:L.style,styleSpec:L.styleSpec,validateSpec:L.validateSpec,objectElementValidators:{"*":q=>Mj(Ts({layerType:A},q))}}),paint:L=>ja({layer:d,key:L.key,value:L.value,style:L.style,styleSpec:L.styleSpec,validateSpec:L.validateSpec,objectElementValidators:{"*":q=>Ff(Ts({layerType:A},q))}})}})),l}function Ac(h){const l=h.value,d=h.key,g=cn(l);return g!=="string"?[new wt(d,l,`string expected, ${g} found`)]:[]}const Oj={promoteId:function({key:h,value:l}){if(cn(l)==="string")return Ac({key:h,value:l});{const d=[];for(const g in l)d.push(...Ac({key:`${h}.${g}`,value:l[g]}));return d}}};function Cv(h){const l=h.value,d=h.key,g=h.styleSpec,_=h.style,C=h.validateSpec;if(!l.type)return[new wt(d,l,'"type" is required')];const A=cs(l.type);let M;switch(A){case"vector":case"raster":return M=ja({key:d,value:l,valueSpec:g[`source_${A.replace("-","_")}`],style:h.style,styleSpec:g,objectElementValidators:Oj,validateSpec:C}),M;case"raster-dem":return M=function(L){var q;const U=(q=L.sourceName)!==null&&q!==void 0?q:"",H=L.value,Q=L.styleSpec,ee=Q.source_raster_dem,oe=L.style;let fe=[];const be=cn(H);if(H===void 0)return fe;if(be!=="object")return fe.push(new wt("source_raster_dem",H,`object expected, ${be} found`)),fe;const Pe=cs(H.encoding)==="custom",Qe=["redFactor","greenFactor","blueFactor","baseShift"],De=L.value.encoding?`"${L.value.encoding}"`:"Default";for(const ze in H)!Pe&&Qe.includes(ze)?fe.push(new wt(ze,H[ze],`In "${U}": "${ze}" is only valid when "encoding" is set to "custom". ${De} encoding found`)):ee[ze]?fe=fe.concat(L.validateSpec({key:ze,value:H[ze],valueSpec:ee[ze],validateSpec:L.validateSpec,style:oe,styleSpec:Q})):fe.push(new wt(ze,H[ze],`unknown property "${ze}"`));return fe}({sourceName:d,value:l,style:h.style,styleSpec:g,validateSpec:C}),M;case"geojson":if(M=ja({key:d,value:l,valueSpec:g.source_geojson,style:_,styleSpec:g,validateSpec:C,objectElementValidators:Oj}),l.cluster)for(const L in l.clusterProperties){const[q,U]=l.clusterProperties[L],H=typeof q=="string"?[q,["accumulated"],["get",L]]:q;M.push(...qd({key:`${d}.${L}.map`,value:U,expressionContext:"cluster-map"})),M.push(...qd({key:`${d}.${L}.reduce`,value:H,expressionContext:"cluster-reduce"}))}return M;case"video":return ja({key:d,value:l,valueSpec:g.source_video,style:_,validateSpec:C,styleSpec:g});case"image":return ja({key:d,value:l,valueSpec:g.source_image,style:_,validateSpec:C,styleSpec:g});case"canvas":return[new wt(d,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Lf({key:`${d}.type`,value:l.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Av(h){const l=h.value,d=h.styleSpec,g=d.light,_=h.style;let C=[];const A=cn(l);if(l===void 0)return C;if(A!=="object")return C=C.concat([new wt("light",l,`object expected, ${A} found`)]),C;for(const M in l){const L=M.match(/^(.*)-transition$/);C=C.concat(L&&g[L[1]]&&g[L[1]].transition?h.validateSpec({key:M,value:l[M],valueSpec:d.transition,validateSpec:h.validateSpec,style:_,styleSpec:d}):g[M]?h.validateSpec({key:M,value:l[M],valueSpec:g[M],validateSpec:h.validateSpec,style:_,styleSpec:d}):[new wt(M,l[M],`unknown property "${M}"`)])}return C}function Vd(h){const l=h.value,d=h.styleSpec,g=d.sky,_=h.style,C=cn(l);if(l===void 0)return[];if(C!=="object")return[new wt("sky",l,`object expected, ${C} found`)];let A=[];for(const M in l)A=A.concat(g[M]?h.validateSpec({key:M,value:l[M],valueSpec:g[M],style:_,styleSpec:d}):[new wt(M,l[M],`unknown property "${M}"`)]);return A}function Ij(h){const l=h.value,d=h.styleSpec,g=d.terrain,_=h.style;let C=[];const A=cn(l);if(l===void 0)return C;if(A!=="object")return C=C.concat([new wt("terrain",l,`object expected, ${A} found`)]),C;for(const M in l)C=C.concat(g[M]?h.validateSpec({key:M,value:l[M],valueSpec:g[M],validateSpec:h.validateSpec,style:_,styleSpec:d}):[new wt(M,l[M],`unknown property "${M}"`)]);return C}function Dj(h){let l=[];const d=h.value,g=h.key;if(Array.isArray(d)){const _=[],C=[];for(const A in d)d[A].id&&_.includes(d[A].id)&&l.push(new wt(g,d,`all the sprites' ids must be unique, but ${d[A].id} is duplicated`)),_.push(d[A].id),d[A].url&&C.includes(d[A].url)&&l.push(new wt(g,d,`all the sprites' URLs must be unique, but ${d[A].url} is duplicated`)),C.push(d[A].url),l=l.concat(ja({key:`${g}[${A}]`,value:d[A],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:h.validateSpec}));return l}return Ac({key:g,value:d})}function Rj(h){return l=h.value,l&&l.constructor===Object?[]:[new wt(h.key,h.value,`object expected, ${cn(h.value)} found`)];var l}const Lj={"*":()=>[],array:Bd,boolean:function(h){const l=h.value,d=h.key,g=cn(l);return g!=="boolean"?[new wt(d,l,`boolean expected, ${g} found`)]:[]},number:Rp,color:jv,constants:Dp,enum:Lf,filter:wv,function:Ej,layer:Pv,object:ja,source:Cv,light:Av,sky:Vd,terrain:Ij,projection:function(h){const l=h.value,d=h.styleSpec,g=d.projection,_=h.style,C=cn(l);if(l===void 0)return[];if(C!=="object")return[new wt("projection",l,`object expected, ${C} found`)];let A=[];for(const M in l)A=A.concat(g[M]?h.validateSpec({key:M,value:l[M],valueSpec:g[M],style:_,styleSpec:d}):[new wt(M,l[M],`unknown property "${M}"`)]);return A},projectionDefinition:function(h){const l=h.key;let d=h.value;d=d instanceof String?d.valueOf():d;const g=cn(d);return g!=="array"||function(_){return Array.isArray(_)&&_.length===3&&typeof _[0]=="string"&&typeof _[1]=="string"&&typeof _[2]=="number"}(d)||function(_){return!!["interpolate","step","literal"].includes(_[0])}(d)?["array","string"].includes(g)?[]:[new wt(l,d,`projection expected, invalid type "${g}" found`)]:[new wt(l,d,`projection expected, invalid array ${JSON.stringify(d)} found`)]},string:Ac,formatted:function(h){return Ac(h).length===0?[]:qd(h)},resolvedImage:function(h){return Ac(h).length===0?[]:qd(h)},padding:function(h){const l=h.key,d=h.value;if(cn(d)==="array"){if(d.length<1||d.length>4)return[new wt(l,d,`padding requires 1 to 4 values; ${d.length} values found`)];const g={type:"number"};let _=[];for(let C=0;C<d.length;C++)_=_.concat(h.validateSpec({key:`${l}[${C}]`,value:d[C],validateSpec:h.validateSpec,valueSpec:g}));return _}return Rp({key:l,value:d,valueSpec:{}})},numberArray:function(h){const l=h.key,d=h.value;if(cn(d)==="array"){const g={type:"number"};if(d.length<1)return[new wt(l,d,"array length at least 1 expected, length 0 found")];let _=[];for(let C=0;C<d.length;C++)_=_.concat(h.validateSpec({key:`${l}[${C}]`,value:d[C],validateSpec:h.validateSpec,valueSpec:g}));return _}return Rp({key:l,value:d,valueSpec:{}})},colorArray:function(h){const l=h.key,d=h.value;if(cn(d)==="array"){if(d.length<1)return[new wt(l,d,"array length at least 1 expected, length 0 found")];let g=[];for(let _=0;_<d.length;_++)g=g.concat(jv({key:`${l}[${_}]`,value:d[_]}));return g}return jv({key:l,value:d})},variableAnchorOffsetCollection:function(h){const l=h.key,d=h.value,g=cn(d),_=h.styleSpec;if(g!=="array"||d.length<1||d.length%2!=0)return[new wt(l,d,"variableAnchorOffsetCollection requires a non-empty array of even length")];let C=[];for(let A=0;A<d.length;A+=2)C=C.concat(Lf({key:`${l}[${A}]`,value:d[A],valueSpec:_.layout_symbol["text-anchor"]})),C=C.concat(Bd({key:`${l}[${A+1}]`,value:d[A+1],valueSpec:{length:2,value:"number"},validateSpec:h.validateSpec,style:h.style,styleSpec:_}));return C},sprite:Dj,state:Rj};function Lp(h){const l=h.value,d=h.valueSpec,g=h.styleSpec;return h.validateSpec=Lp,d.expression&&Cp(cs(l))?Ej(h):d.expression&&Ap(Ll(l))?qd(h):d.type&&Lj[d.type]?Lj[d.type](h):ja(Ts({},h,{valueSpec:d.type?g[d.type]:d}))}function Fj(h){const l=h.value,d=h.key,g=Ac(h);return g.length||(l.indexOf("{fontstack}")===-1&&g.push(new wt(d,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&g.push(new wt(d,l,'"glyphs" url must include a "{range}" token'))),g}function Yi(h,l=Je){let d=[];return d=d.concat(Lp({key:"",value:h,valueSpec:l.$root,styleSpec:l,style:h,validateSpec:Lp,objectElementValidators:{glyphs:Fj,"*":()=>[]}})),h.constants&&(d=d.concat(Dp({key:"constants",value:h.constants}))),wa(d)}function ua(h){return function(l){return h(Object.assign({},l,{validateSpec:Lp}))}}function wa(h){return[].concat(h).sort((l,d)=>l.line-d.line)}function da(h){return function(...l){return wa(h.apply(this,l))}}Yi.source=da(ua(Cv)),Yi.sprite=da(ua(Dj)),Yi.glyphs=da(ua(Fj)),Yi.light=da(ua(Av)),Yi.sky=da(ua(Vd)),Yi.terrain=da(ua(Ij)),Yi.state=da(ua(Rj)),Yi.layer=da(ua(Pv)),Yi.filter=da(ua(wv)),Yi.paintProperty=da(ua(Ff)),Yi.layoutProperty=da(ua(Mj));const zj=Je,Ud=Yi,BP=Ud.light,zf=Ud.sky,$j=Ud.paintProperty,kv=Ud.layoutProperty;function Bj(h,l){let d=!1;if(l&&l.length)for(const g of l)h.fire(new yt(new Error(g.message))),d=!0;return d}class wu{constructor(l,d,g){const _=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;const A=new Int32Array(this.arrayBuffer);l=A[0],this.d=(d=A[1])+2*(g=A[2]);for(let L=0;L<this.d*this.d;L++){const q=A[3+L],U=A[3+L+1];_.push(q===U?null:A.subarray(q,U))}const M=A[3+_.length+1];this.keys=A.subarray(A[3+_.length],M),this.bboxes=A.subarray(M),this.insert=this._insertReadonly}else{this.d=d+2*g;for(let A=0;A<this.d*this.d;A++)_.push([]);this.keys=[],this.bboxes=[]}this.n=d,this.extent=l,this.padding=g,this.scale=d/l,this.uid=0;const C=g/d*l;this.min=-C,this.max=l+C}insert(l,d,g,_,C){this._forEachCell(d,g,_,C,this._insertCell,this.uid++,void 0,void 0),this.keys.push(l),this.bboxes.push(d),this.bboxes.push(g),this.bboxes.push(_),this.bboxes.push(C)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(l,d,g,_,C,A){this.cells[C].push(A)}query(l,d,g,_,C){const A=this.min,M=this.max;if(l<=A&&d<=A&&M<=g&&M<=_&&!C)return Array.prototype.slice.call(this.keys);{const L=[];return this._forEachCell(l,d,g,_,this._queryCell,L,{},C),L}}_queryCell(l,d,g,_,C,A,M,L){const q=this.cells[C];if(q!==null){const U=this.keys,H=this.bboxes;for(let Q=0;Q<q.length;Q++){const ee=q[Q];if(M[ee]===void 0){const oe=4*ee;(L?L(H[oe+0],H[oe+1],H[oe+2],H[oe+3]):l<=H[oe+2]&&d<=H[oe+3]&&g>=H[oe+0]&&_>=H[oe+1])?(M[ee]=!0,A.push(U[ee])):M[ee]=!1}}}}_forEachCell(l,d,g,_,C,A,M,L){const q=this._convertToCellCoord(l),U=this._convertToCellCoord(d),H=this._convertToCellCoord(g),Q=this._convertToCellCoord(_);for(let ee=q;ee<=H;ee++)for(let oe=U;oe<=Q;oe++){const fe=this.d*oe+ee;if((!L||L(this._convertFromCellCoord(ee),this._convertFromCellCoord(oe),this._convertFromCellCoord(ee+1),this._convertFromCellCoord(oe+1)))&&C.call(this,l,d,g,_,fe,A,M,L))return}}_convertFromCellCoord(l){return(l-this.padding)/this.scale}_convertToCellCoord(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const l=this.cells,d=3+this.cells.length+1+1;let g=0;for(let A=0;A<this.cells.length;A++)g+=this.cells[A].length;const _=new Int32Array(d+g+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;let C=d;for(let A=0;A<l.length;A++){const M=l[A];_[3+A]=C,_.set(M,C),C+=M.length}return _[3+l.length]=C,_.set(this.keys,C),C+=this.keys.length,_[3+l.length+1]=C,_.set(this.bboxes,C),C+=this.bboxes.length,_.buffer}static serialize(l,d){const g=l.toArrayBuffer();return d&&d.push(g),{buffer:g}}static deserialize(l){return new wu(l.buffer)}}const Fl={};function Kt(h,l,d={}){if(Fl[h])throw new Error(`${h} is already registered.`);Object.defineProperty(l,"_classRegistryKey",{value:h,writeable:!1}),Fl[h]={klass:l,omit:d.omit||[],shallow:d.shallow||[]}}Kt("Object",Object),Kt("Set",Set),Kt("TransferableGridIndex",wu),Kt("Color",Ur),Kt("Error",Error),Kt("AJAXError",Ae),Kt("ResolvedImage",ca),Kt("StylePropertyFunction",kp),Kt("StyleExpression",yv,{omit:["_evaluator"]}),Kt("ZoomDependentExpression",vv),Kt("ZoomConstantExpression",If),Kt("CompoundExpression",ao,{omit:["_evaluate"]});for(const h in Fd)Fd[h]._classRegistryKey||Kt(`Expression_${h}`,Fd[h]);function qj(h){return h&&typeof ArrayBuffer<"u"&&(h instanceof ArrayBuffer||h.constructor&&h.constructor.name==="ArrayBuffer")}function Tv(h){return h.$name||h.constructor._classRegistryKey}function Vj(h){return!function(l){if(l===null||typeof l!="object")return!1;const d=Tv(l);return!(!d||d==="Object")}(h)&&(h==null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp||h instanceof Blob||h instanceof Error||qj(h)||Wn(h)||ArrayBuffer.isView(h)||h instanceof ImageData)}function zl(h,l){if(Vj(h))return(qj(h)||Wn(h))&&l&&l.push(h),ArrayBuffer.isView(h)&&l&&l.push(h.buffer),h instanceof ImageData&&l&&l.push(h.data.buffer),h;if(Array.isArray(h)){const C=[];for(const A of h)C.push(zl(A,l));return C}if(typeof h!="object")throw new Error("can't serialize object of type "+typeof h);const d=Tv(h);if(!d)throw new Error(`can't serialize object of unregistered class ${h.constructor.name}`);if(!Fl[d])throw new Error(`${d} is not registered.`);const{klass:g}=Fl[d],_=g.serialize?g.serialize(h,l):{};if(g.serialize){if(l&&_===l[l.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const C in h){if(!h.hasOwnProperty(C)||Fl[d].omit.indexOf(C)>=0)continue;const A=h[C];_[C]=Fl[d].shallow.indexOf(C)>=0?A:zl(A,l)}h instanceof Error&&(_.message=h.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return d!=="Object"&&(_.$name=d),_}function $f(h){if(Vj(h))return h;if(Array.isArray(h))return h.map($f);if(typeof h!="object")throw new Error("can't deserialize object of type "+typeof h);const l=Tv(h)||"Object";if(!Fl[l])throw new Error(`can't deserialize unregistered class ${l}`);const{klass:d}=Fl[l];if(!d)throw new Error(`can't deserialize unregistered class ${l}`);if(d.deserialize)return d.deserialize(h);const g=Object.create(d.prototype);for(const _ of Object.keys(h)){if(_==="$name")continue;const C=h[_];g[_]=Fl[l].shallow.indexOf(_)>=0?C:$f(C)}return g}class Ev{constructor(){this.first=!0}update(l,d){const g=Math.floor(l);return this.first?(this.first=!1,this.lastIntegerZoom=g,this.lastIntegerZoomTime=0,this.lastZoom=l,this.lastFloorZoom=g,!0):(this.lastFloorZoom>g?(this.lastIntegerZoom=g+1,this.lastIntegerZoomTime=d):this.lastFloorZoom<g&&(this.lastIntegerZoom=g,this.lastIntegerZoomTime=d),l!==this.lastZoom&&(this.lastZoom=l,this.lastFloorZoom=g,!0))}}const sn={"Latin-1 Supplement":h=>h>=128&&h<=255,"Hangul Jamo":h=>h>=4352&&h<=4607,Khmer:h=>h>=6016&&h<=6143,"General Punctuation":h=>h>=8192&&h<=8303,"Letterlike Symbols":h=>h>=8448&&h<=8527,"Number Forms":h=>h>=8528&&h<=8591,"Miscellaneous Technical":h=>h>=8960&&h<=9215,"Control Pictures":h=>h>=9216&&h<=9279,"Optical Character Recognition":h=>h>=9280&&h<=9311,"Enclosed Alphanumerics":h=>h>=9312&&h<=9471,"Geometric Shapes":h=>h>=9632&&h<=9727,"Miscellaneous Symbols":h=>h>=9728&&h<=9983,"Miscellaneous Symbols and Arrows":h=>h>=11008&&h<=11263,"Ideographic Description Characters":h=>h>=12272&&h<=12287,"CJK Symbols and Punctuation":h=>h>=12288&&h<=12351,Hiragana:h=>h>=12352&&h<=12447,Katakana:h=>h>=12448&&h<=12543,Kanbun:h=>h>=12688&&h<=12703,"CJK Strokes":h=>h>=12736&&h<=12783,"Enclosed CJK Letters and Months":h=>h>=12800&&h<=13055,"CJK Compatibility":h=>h>=13056&&h<=13311,"Yijing Hexagram Symbols":h=>h>=19904&&h<=19967,"CJK Unified Ideographs":h=>h>=19968&&h<=40959,"Hangul Syllables":h=>h>=44032&&h<=55215,"Private Use Area":h=>h>=57344&&h<=63743,"Vertical Forms":h=>h>=65040&&h<=65055,"CJK Compatibility Forms":h=>h>=65072&&h<=65103,"Small Form Variants":h=>h>=65104&&h<=65135,"Halfwidth and Fullwidth Forms":h=>h>=65280&&h<=65519};function Mv(h){for(const l of h)if(Fp(l.charCodeAt(0)))return!0;return!1}function Ov(h){for(const l of h)if(!Wj(l.charCodeAt(0)))return!1;return!0}function Wd(h){const l=h.map(d=>{try{return new RegExp(`\\p{sc=${d}}`,"u").source}catch{return null}}).filter(d=>d);return new RegExp(l.join("|"),"u")}const Uj=Wd(["Arab","Dupl","Mong","Ougr","Syrc"]);function Wj(h){return!Uj.test(String.fromCodePoint(h))}const Iv=Wd(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Fp(h){return!(h!==746&&h!==747&&(h<4352||!(sn["CJK Compatibility Forms"](h)&&!(h>=65097&&h<=65103)||sn["CJK Compatibility"](h)||sn["CJK Strokes"](h)||!(!sn["CJK Symbols and Punctuation"](h)||h>=12296&&h<=12305||h>=12308&&h<=12319||h===12336)||sn["Enclosed CJK Letters and Months"](h)||sn["Ideographic Description Characters"](h)||sn.Kanbun(h)||sn.Katakana(h)&&h!==12540||!(!sn["Halfwidth and Fullwidth Forms"](h)||h===65288||h===65289||h===65293||h>=65306&&h<=65310||h===65339||h===65341||h===65343||h>=65371&&h<=65503||h===65507||h>=65512&&h<=65519)||!(!sn["Small Form Variants"](h)||h>=65112&&h<=65118||h>=65123&&h<=65126)||sn["Vertical Forms"](h)||sn["Yijing Hexagram Symbols"](h)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(h))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(h))||Iv.test(String.fromCodePoint(h)))))}function zp(h){return!(Fp(h)||function(l){return!!(sn["Latin-1 Supplement"](l)&&(l===167||l===169||l===174||l===177||l===188||l===189||l===190||l===215||l===247)||sn["General Punctuation"](l)&&(l===8214||l===8224||l===8225||l===8240||l===8241||l===8251||l===8252||l===8258||l===8263||l===8264||l===8265||l===8273)||sn["Letterlike Symbols"](l)||sn["Number Forms"](l)||sn["Miscellaneous Technical"](l)&&(l>=8960&&l<=8967||l>=8972&&l<=8991||l>=8996&&l<=9e3||l===9003||l>=9085&&l<=9114||l>=9150&&l<=9165||l===9167||l>=9169&&l<=9179||l>=9186&&l<=9215)||sn["Control Pictures"](l)&&l!==9251||sn["Optical Character Recognition"](l)||sn["Enclosed Alphanumerics"](l)||sn["Geometric Shapes"](l)||sn["Miscellaneous Symbols"](l)&&!(l>=9754&&l<=9759)||sn["Miscellaneous Symbols and Arrows"](l)&&(l>=11026&&l<=11055||l>=11088&&l<=11097||l>=11192&&l<=11243)||sn["CJK Symbols and Punctuation"](l)||sn.Katakana(l)||sn["Private Use Area"](l)||sn["CJK Compatibility Forms"](l)||sn["Small Form Variants"](l)||sn["Halfwidth and Fullwidth Forms"](l)||l===8734||l===8756||l===8757||l>=9984&&l<=10087||l>=10102&&l<=10131||l===65532||l===65533)}(h))}const Gj=Wd(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Kj(h){return Gj.test(String.fromCodePoint(h))}function Hj(h,l){return!(!l&&Kj(h)||h>=2304&&h<=3583||h>=3840&&h<=4255||sn.Khmer(h))}function qP(h){for(const l of h)if(Kj(l.charCodeAt(0)))return!0;return!1}const $l=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(h){this.pluginStatus=h.pluginStatus,this.pluginURL=h.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(h){if($l.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=h.applyArabicShaping,this.processBidirectionalText=h.processBidirectionalText,this.processStyledBidirectionalText=h.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(h,l){return a(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(h.pluginStatus!=="loading")return this.setState(h),h;const d=h.pluginURL,g=new Promise(C=>{this.loadScriptResolve=C});l(d);const _=new Promise(C=>setTimeout(()=>C(),this.TIMEOUT));if(yield Promise.race([g,_]),this.isParsed()){const C={pluginStatus:"loaded",pluginURL:d};return this.setState(C),C}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${d}`)})}};class Bn{constructor(l,d){this.isSupportedScript=Zj,this.zoom=l,d?(this.now=d.now||0,this.fadeDuration=d.fadeDuration||0,this.zoomHistory=d.zoomHistory||new Ev,this.transition=d.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ev,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const l=this.zoom,d=l-Math.floor(l),g=this.crossFadingFactor();return l>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:d+(1-d)*g}:{fromScale:.5,toScale:1,t:1-(1-g)*d}}}function Zj(h){return function(l,d){for(const g of l)if(!Hj(g.charCodeAt(0),d))return!1;return!0}(h,$l.getRTLTextPluginStatus()==="loaded")}class Bf{constructor(l,d,g){this.property=l,this.value=d,this.expression=function(_,C,A){if(Cp(_))return new kp(_,C);if(Ap(_)){const M=Pj(_,C,A);if(M.result==="error")throw new Error(M.value.map(L=>`${L.key}: ${L.message}`).join(", "));return M.value}{let M=_;return C.type==="color"&&typeof _=="string"?M=Ur.parse(_):C.type!=="padding"||typeof _!="number"&&!Array.isArray(_)?C.type!=="numberArray"||typeof _!="number"&&!Array.isArray(_)?C.type!=="colorArray"||typeof _!="string"&&!Array.isArray(_)?C.type==="variableAnchorOffsetCollection"&&Array.isArray(_)?M=Zi.parse(_):C.type==="projectionDefinition"&&typeof _=="string"&&(M=$a.parse(_)):M=Vs.parse(_):M=Di.parse(_):M=Hi.parse(_),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>M}}}(d===void 0?l.specification.default:d,l.specification,g)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(l,d,g){return this.property.possiblyEvaluate(this,l,d,g)}}class Dv{constructor(l,d){this.property=l,this.value=new Bf(l,void 0,d)}transitioned(l,d){return new Rv(this.property,this.value,d,yr({},l.transition,this.transition),l.now)}untransitioned(){return new Rv(this.property,this.value,null,{},0)}}class Yj{constructor(l,d){this._properties=l,this._values=Object.create(l.defaultTransitionablePropertyValues),this._globalState=d}getValue(l){return mt(this._values[l].value.value)}setValue(l,d){Object.prototype.hasOwnProperty.call(this._values,l)||(this._values[l]=new Dv(this._values[l].property,this._globalState)),this._values[l].value=new Bf(this._values[l].property,d===null?void 0:mt(d),this._globalState)}getTransition(l){return mt(this._values[l].transition)}setTransition(l,d){Object.prototype.hasOwnProperty.call(this._values,l)||(this._values[l]=new Dv(this._values[l].property,this._globalState)),this._values[l].transition=mt(d)||void 0}serialize(){const l={};for(const d of Object.keys(this._values)){const g=this.getValue(d);g!==void 0&&(l[d]=g);const _=this.getTransition(d);_!==void 0&&(l[`${d}-transition`]=_)}return l}transitioned(l,d){const g=new Lv(this._properties);for(const _ of Object.keys(this._values))g._values[_]=this._values[_].transitioned(l,d._values[_]);return g}untransitioned(){const l=new Lv(this._properties);for(const d of Object.keys(this._values))l._values[d]=this._values[d].untransitioned();return l}}class Rv{constructor(l,d,g,_,C){this.property=l,this.value=d,this.begin=C+_.delay||0,this.end=this.begin+_.duration||0,l.specification.transition&&(_.delay||_.duration)&&(this.prior=g)}possiblyEvaluate(l,d,g){const _=l.now||0,C=this.value.possiblyEvaluate(l,d,g),A=this.prior;if(A){if(_>this.end)return this.prior=null,C;if(this.value.isDataDriven())return this.prior=null,C;if(_<this.begin)return A.possiblyEvaluate(l,d,g);{const M=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(A.possiblyEvaluate(l,d,g),C,Tt(M))}}return C}}class Lv{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitioningPropertyValues)}possiblyEvaluate(l,d,g){const _=new Su(this._properties);for(const C of Object.keys(this._values))_._values[C]=this._values[C].possiblyEvaluate(l,d,g);return _}hasTransition(){for(const l of Object.keys(this._values))if(this._values[l].prior)return!0;return!1}}class Xj{constructor(l,d){this._properties=l,this._values=Object.create(l.defaultPropertyValues),this._globalState=d}hasValue(l){return this._values[l].value!==void 0}getValue(l){return mt(this._values[l].value)}setValue(l,d){this._values[l]=new Bf(this._values[l].property,d===null?void 0:mt(d),this._globalState)}serialize(){const l={};for(const d of Object.keys(this._values)){const g=this.getValue(d);g!==void 0&&(l[d]=g)}return l}possiblyEvaluate(l,d,g){const _=new Su(this._properties);for(const C of Object.keys(this._values))_._values[C]=this._values[C].possiblyEvaluate(l,d,g);return _}}class Ao{constructor(l,d,g){this.property=l,this.value=d,this.parameters=g}isConstant(){return this.value.kind==="constant"}constantOr(l){return this.value.kind==="constant"?this.value.value:l}evaluate(l,d,g,_){return this.property.evaluate(this.value,this.parameters,l,d,g,_)}}class Su{constructor(l){this._properties=l,this._values=Object.create(l.defaultPossiblyEvaluatedValues)}get(l){return this._values[l]}}class fr{constructor(l){this.specification=l}possiblyEvaluate(l,d){if(l.isDataDriven())throw new Error("Value should not be data driven");return l.expression.evaluate(d)}interpolate(l,d,g){const _=io[this.specification.type];return _?_(l,d,g):l}}class Tr{constructor(l,d){this.specification=l,this.overrides=d}possiblyEvaluate(l,d,g,_){return new Ao(this,l.expression.kind==="constant"||l.expression.kind==="camera"?{kind:"constant",value:l.expression.evaluate(d,null,{},g,_)}:l.expression,d)}interpolate(l,d,g){if(l.value.kind!=="constant"||d.value.kind!=="constant")return l;if(l.value.value===void 0||d.value.value===void 0)return new Ao(this,{kind:"constant",value:void 0},l.parameters);const _=io[this.specification.type];if(_){const C=_(l.value.value,d.value.value,g);return new Ao(this,{kind:"constant",value:C},l.parameters)}return l}evaluate(l,d,g,_,C,A){return l.kind==="constant"?l.value:l.evaluate(d,g,_,C,A)}}class qf extends Tr{possiblyEvaluate(l,d,g,_){if(l.value===void 0)return new Ao(this,{kind:"constant",value:void 0},d);if(l.expression.kind==="constant"){const C=l.expression.evaluate(d,null,{},g,_),A=l.property.specification.type==="resolvedImage"&&typeof C!="string"?C.name:C,M=this._calculate(A,A,A,d);return new Ao(this,{kind:"constant",value:M},d)}if(l.expression.kind==="camera"){const C=this._calculate(l.expression.evaluate({zoom:d.zoom-1}),l.expression.evaluate({zoom:d.zoom}),l.expression.evaluate({zoom:d.zoom+1}),d);return new Ao(this,{kind:"constant",value:C},d)}return new Ao(this,l.expression,d)}evaluate(l,d,g,_,C,A){if(l.kind==="source"){const M=l.evaluate(d,g,_,C,A);return this._calculate(M,M,M,d)}return l.kind==="composite"?this._calculate(l.evaluate({zoom:Math.floor(d.zoom)-1},g,_),l.evaluate({zoom:Math.floor(d.zoom)},g,_),l.evaluate({zoom:Math.floor(d.zoom)+1},g,_),d):l.value}_calculate(l,d,g,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:l,to:d}:{from:g,to:d}}interpolate(l){return l}}class Qj{constructor(l){this.specification=l}possiblyEvaluate(l,d,g,_){if(l.value!==void 0){if(l.expression.kind==="constant"){const C=l.expression.evaluate(d,null,{},g,_);return this._calculate(C,C,C,d)}return this._calculate(l.expression.evaluate(new Bn(Math.floor(d.zoom-1),d)),l.expression.evaluate(new Bn(Math.floor(d.zoom),d)),l.expression.evaluate(new Bn(Math.floor(d.zoom+1),d)),d)}}_calculate(l,d,g,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:l,to:d}:{from:g,to:d}}interpolate(l){return l}}class Vf{constructor(l){this.specification=l}possiblyEvaluate(l,d,g,_){return!!l.expression.evaluate(d,null,{},g,_)}interpolate(){return!1}}class Xi{constructor(l){this.properties=l,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const d in l){const g=l[d];g.specification.overridable&&this.overridableProperties.push(d);const _=this.defaultPropertyValues[d]=new Bf(g,void 0,void 0),C=this.defaultTransitionablePropertyValues[d]=new Dv(g,void 0);this.defaultTransitioningPropertyValues[d]=C.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=_.possiblyEvaluate({})}}}Kt("DataDrivenProperty",Tr),Kt("DataConstantProperty",fr),Kt("CrossFadedDataDrivenProperty",qf),Kt("CrossFadedProperty",Qj),Kt("ColorRampProperty",Vf);const Fv="-transition";class ko extends or{constructor(l,d,g){if(super(),this.id=l.id,this.type=l.type,this._globalState=g,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},l.type!=="custom"&&(this.metadata=l.metadata,this.minzoom=l.minzoom,this.maxzoom=l.maxzoom,l.type!=="background"&&(this.source=l.source,this.sourceLayer=l["source-layer"],this.filter=l.filter,this._featureFilter=Df(l.filter,g)),d.layout&&(this._unevaluatedLayout=new Xj(d.layout,g)),d.paint)){this._transitionablePaint=new Yj(d.paint,g);for(const _ in l.paint)this.setPaintProperty(_,l.paint[_],{validate:!1});for(const _ in l.layout)this.setLayoutProperty(_,l.layout[_],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Su(d.paint)}}setFilter(l){this.filter=l,this._featureFilter=Df(l,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(l){return l==="visibility"?this.visibility:this._unevaluatedLayout.getValue(l)}getLayoutAffectingGlobalStateRefs(){const l=new Set;if(this._unevaluatedLayout)for(const d in this._unevaluatedLayout._values){const g=this._unevaluatedLayout._values[d];for(const _ of g.getGlobalStateRefs())l.add(_)}for(const d of this._featureFilter.getGlobalStateRefs())l.add(d);return l}getPaintAffectingGlobalStateRefs(){var l;const d=new globalThis.Map;if(this._transitionablePaint)for(const g in this._transitionablePaint._values){const _=this._transitionablePaint._values[g].value;for(const C of _.getGlobalStateRefs()){const A=(l=d.get(C))!==null&&l!==void 0?l:[];A.push({name:g,value:_.value}),d.set(C,A)}}return d}setLayoutProperty(l,d,g={}){d!=null&&this._validate(kv,`layers.${this.id}.layout.${l}`,l,d,g)||(l!=="visibility"?this._unevaluatedLayout.setValue(l,d):this.visibility=d)}getPaintProperty(l){return l.endsWith(Fv)?this._transitionablePaint.getTransition(l.slice(0,-11)):this._transitionablePaint.getValue(l)}setPaintProperty(l,d,g={}){if(d!=null&&this._validate($j,`layers.${this.id}.paint.${l}`,l,d,g))return!1;if(l.endsWith(Fv))return this._transitionablePaint.setTransition(l.slice(0,-11),d||void 0),!1;{const _=this._transitionablePaint._values[l],C=_.property.specification["property-type"]==="cross-faded-data-driven",A=_.value.isDataDriven(),M=_.value;this._transitionablePaint.setValue(l,d),this._handleSpecialPaintPropertyUpdate(l);const L=this._transitionablePaint._values[l].value;return L.isDataDriven()||A||C||this._handleOverridablePaintPropertyUpdate(l,M,L)}}_handleSpecialPaintPropertyUpdate(l){}_handleOverridablePaintPropertyUpdate(l,d,g){return!1}isHidden(l,d=!1){return!!(this.minzoom&&l<(d?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&l>=this.maxzoom)||this.visibility==="none"}updateTransitions(l){this._transitioningPaint=this._transitionablePaint.transitioned(l,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(l,d){l.getCrossfadeParameters&&(this._crossfadeParameters=l.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(l,void 0,d)),this.paint=this._transitioningPaint.possiblyEvaluate(l,void 0,d)}serialize(){const l={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(l.layout=l.layout||{},l.layout.visibility=this.visibility),Zt(l,(d,g)=>!(d===void 0||g==="layout"&&!Object.keys(d).length||g==="paint"&&!Object.keys(d).length))}_validate(l,d,g,_,C={}){return(!C||C.validate!==!1)&&Bj(this,l.call(Ud,{key:d,layerType:this.type,objectKey:g,value:_,styleSpec:Je,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const l in this.paint._values){const d=this.paint.get(l);if(d instanceof Ao&&$d(d.property.specification)&&(d.value.kind==="source"||d.value.kind==="composite")&&d.value.isStateDependent)return!0}return!1}}let Jj;var VP={get paint(){return Jj=Jj||new Xi({"raster-opacity":new fr(Je.paint_raster["raster-opacity"]),"raster-hue-rotate":new fr(Je.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new fr(Je.paint_raster["raster-brightness-min"]),"raster-brightness-max":new fr(Je.paint_raster["raster-brightness-max"]),"raster-saturation":new fr(Je.paint_raster["raster-saturation"]),"raster-contrast":new fr(Je.paint_raster["raster-contrast"]),"raster-resampling":new fr(Je.paint_raster["raster-resampling"]),"raster-fade-duration":new fr(Je.paint_raster["raster-fade-duration"])})}};class UP extends ko{constructor(l,d){super(l,VP,d)}}const WP={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ll{constructor(l,d){this._structArray=l,this._pos1=d*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class us{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(l,d){return l._trim(),d&&(l.isTransferred=!0,d.push(l.arrayBuffer)),{length:l.length,arrayBuffer:l.arrayBuffer}}static deserialize(l){const d=Object.create(this.prototype);return d.arrayBuffer=l.arrayBuffer,d.length=l.length,d.capacity=l.arrayBuffer.byteLength/d.bytesPerElement,d._refreshViews(),d}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(l){this.reserve(l),this.length=l}reserve(l){if(l>this.capacity){this.capacity=Math.max(l,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const d=this.uint8;this._refreshViews(),d&&this.uint8.set(d)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Ms(h,l=1){let d=0,g=0;return{members:h.map(_=>{const C=WP[_.type].BYTES_PER_ELEMENT,A=d=ew(d,Math.max(l,C)),M=_.components||1;return g=Math.max(g,C),d+=C*M,{name:_.name,type:_.type,components:M,offset:A}}),size:ew(d,Math.max(g,l)),alignment:l}}function ew(h,l){return Math.ceil(h/l)*l}class Gd extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,d){const g=this.length;return this.resize(g+1),this.emplace(g,l,d)}emplace(l,d,g){const _=2*l;return this.int16[_+0]=d,this.int16[_+1]=g,l}}Gd.prototype.bytesPerElement=4,Kt("StructArrayLayout2i4",Gd);class $p extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,d,g){const _=this.length;return this.resize(_+1),this.emplace(_,l,d,g)}emplace(l,d,g,_){const C=3*l;return this.int16[C+0]=d,this.int16[C+1]=g,this.int16[C+2]=_,l}}$p.prototype.bytesPerElement=6,Kt("StructArrayLayout3i6",$p);class zv extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,d,g,_){const C=this.length;return this.resize(C+1),this.emplace(C,l,d,g,_)}emplace(l,d,g,_,C){const A=4*l;return this.int16[A+0]=d,this.int16[A+1]=g,this.int16[A+2]=_,this.int16[A+3]=C,l}}zv.prototype.bytesPerElement=8,Kt("StructArrayLayout4i8",zv);class Bl extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,d,g,_,C,A){const M=this.length;return this.resize(M+1),this.emplace(M,l,d,g,_,C,A)}emplace(l,d,g,_,C,A,M){const L=6*l;return this.int16[L+0]=d,this.int16[L+1]=g,this.int16[L+2]=_,this.int16[L+3]=C,this.int16[L+4]=A,this.int16[L+5]=M,l}}Bl.prototype.bytesPerElement=12,Kt("StructArrayLayout2i4i12",Bl);class Bp extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,d,g,_,C,A){const M=this.length;return this.resize(M+1),this.emplace(M,l,d,g,_,C,A)}emplace(l,d,g,_,C,A,M){const L=4*l,q=8*l;return this.int16[L+0]=d,this.int16[L+1]=g,this.uint8[q+4]=_,this.uint8[q+5]=C,this.uint8[q+6]=A,this.uint8[q+7]=M,l}}Bp.prototype.bytesPerElement=8,Kt("StructArrayLayout2i4ub8",Bp);class Nu extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,d){const g=this.length;return this.resize(g+1),this.emplace(g,l,d)}emplace(l,d,g){const _=2*l;return this.float32[_+0]=d,this.float32[_+1]=g,l}}Nu.prototype.bytesPerElement=8,Kt("StructArrayLayout2f8",Nu);class qp extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,d,g,_,C,A,M,L,q,U){const H=this.length;return this.resize(H+1),this.emplace(H,l,d,g,_,C,A,M,L,q,U)}emplace(l,d,g,_,C,A,M,L,q,U,H){const Q=10*l;return this.uint16[Q+0]=d,this.uint16[Q+1]=g,this.uint16[Q+2]=_,this.uint16[Q+3]=C,this.uint16[Q+4]=A,this.uint16[Q+5]=M,this.uint16[Q+6]=L,this.uint16[Q+7]=q,this.uint16[Q+8]=U,this.uint16[Q+9]=H,l}}qp.prototype.bytesPerElement=20,Kt("StructArrayLayout10ui20",qp);class Uf extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,d,g,_,C,A,M,L){const q=this.length;return this.resize(q+1),this.emplace(q,l,d,g,_,C,A,M,L)}emplace(l,d,g,_,C,A,M,L,q){const U=8*l;return this.uint16[U+0]=d,this.uint16[U+1]=g,this.uint16[U+2]=_,this.uint16[U+3]=C,this.uint16[U+4]=A,this.uint16[U+5]=M,this.uint16[U+6]=L,this.uint16[U+7]=q,l}}Uf.prototype.bytesPerElement=16,Kt("StructArrayLayout8ui16",Uf);class $v extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,d,g,_,C,A,M,L,q,U,H,Q){const ee=this.length;return this.resize(ee+1),this.emplace(ee,l,d,g,_,C,A,M,L,q,U,H,Q)}emplace(l,d,g,_,C,A,M,L,q,U,H,Q,ee){const oe=12*l;return this.int16[oe+0]=d,this.int16[oe+1]=g,this.int16[oe+2]=_,this.int16[oe+3]=C,this.uint16[oe+4]=A,this.uint16[oe+5]=M,this.uint16[oe+6]=L,this.uint16[oe+7]=q,this.int16[oe+8]=U,this.int16[oe+9]=H,this.int16[oe+10]=Q,this.int16[oe+11]=ee,l}}$v.prototype.bytesPerElement=24,Kt("StructArrayLayout4i4ui4i24",$v);class Kd extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,d,g){const _=this.length;return this.resize(_+1),this.emplace(_,l,d,g)}emplace(l,d,g,_){const C=3*l;return this.float32[C+0]=d,this.float32[C+1]=g,this.float32[C+2]=_,l}}Kd.prototype.bytesPerElement=12,Kt("StructArrayLayout3f12",Kd);class Pu extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(l){const d=this.length;return this.resize(d+1),this.emplace(d,l)}emplace(l,d){return this.uint32[1*l+0]=d,l}}Pu.prototype.bytesPerElement=4,Kt("StructArrayLayout1ul4",Pu);class Bv extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,d,g,_,C,A,M,L,q){const U=this.length;return this.resize(U+1),this.emplace(U,l,d,g,_,C,A,M,L,q)}emplace(l,d,g,_,C,A,M,L,q,U){const H=10*l,Q=5*l;return this.int16[H+0]=d,this.int16[H+1]=g,this.int16[H+2]=_,this.int16[H+3]=C,this.int16[H+4]=A,this.int16[H+5]=M,this.uint32[Q+3]=L,this.uint16[H+8]=q,this.uint16[H+9]=U,l}}Bv.prototype.bytesPerElement=20,Kt("StructArrayLayout6i1ul2ui20",Bv);class Vp extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,d,g,_,C,A){const M=this.length;return this.resize(M+1),this.emplace(M,l,d,g,_,C,A)}emplace(l,d,g,_,C,A,M){const L=6*l;return this.int16[L+0]=d,this.int16[L+1]=g,this.int16[L+2]=_,this.int16[L+3]=C,this.int16[L+4]=A,this.int16[L+5]=M,l}}Vp.prototype.bytesPerElement=12,Kt("StructArrayLayout2i2i2i12",Vp);class Cu extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,d,g,_,C){const A=this.length;return this.resize(A+1),this.emplace(A,l,d,g,_,C)}emplace(l,d,g,_,C,A){const M=4*l,L=8*l;return this.float32[M+0]=d,this.float32[M+1]=g,this.float32[M+2]=_,this.int16[L+6]=C,this.int16[L+7]=A,l}}Cu.prototype.bytesPerElement=16,Kt("StructArrayLayout2f1f2i16",Cu);class qv extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,d,g,_,C,A){const M=this.length;return this.resize(M+1),this.emplace(M,l,d,g,_,C,A)}emplace(l,d,g,_,C,A,M){const L=16*l,q=4*l,U=8*l;return this.uint8[L+0]=d,this.uint8[L+1]=g,this.float32[q+1]=_,this.float32[q+2]=C,this.int16[U+6]=A,this.int16[U+7]=M,l}}qv.prototype.bytesPerElement=16,Kt("StructArrayLayout2ub2f2i16",qv);class Up extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,d,g){const _=this.length;return this.resize(_+1),this.emplace(_,l,d,g)}emplace(l,d,g,_){const C=3*l;return this.uint16[C+0]=d,this.uint16[C+1]=g,this.uint16[C+2]=_,l}}Up.prototype.bytesPerElement=6,Kt("StructArrayLayout3ui6",Up);class Wp extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,d,g,_,C,A,M,L,q,U,H,Q,ee,oe,fe,be,Pe){const Qe=this.length;return this.resize(Qe+1),this.emplace(Qe,l,d,g,_,C,A,M,L,q,U,H,Q,ee,oe,fe,be,Pe)}emplace(l,d,g,_,C,A,M,L,q,U,H,Q,ee,oe,fe,be,Pe,Qe){const De=24*l,ze=12*l,it=48*l;return this.int16[De+0]=d,this.int16[De+1]=g,this.uint16[De+2]=_,this.uint16[De+3]=C,this.uint32[ze+2]=A,this.uint32[ze+3]=M,this.uint32[ze+4]=L,this.uint16[De+10]=q,this.uint16[De+11]=U,this.uint16[De+12]=H,this.float32[ze+7]=Q,this.float32[ze+8]=ee,this.uint8[it+36]=oe,this.uint8[it+37]=fe,this.uint8[it+38]=be,this.uint32[ze+10]=Pe,this.int16[De+22]=Qe,l}}Wp.prototype.bytesPerElement=48,Kt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Wp);class Vv extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,d,g,_,C,A,M,L,q,U,H,Q,ee,oe,fe,be,Pe,Qe,De,ze,it,ft,Ct,Vt,It,$t,vr,Ft){const Bt=this.length;return this.resize(Bt+1),this.emplace(Bt,l,d,g,_,C,A,M,L,q,U,H,Q,ee,oe,fe,be,Pe,Qe,De,ze,it,ft,Ct,Vt,It,$t,vr,Ft)}emplace(l,d,g,_,C,A,M,L,q,U,H,Q,ee,oe,fe,be,Pe,Qe,De,ze,it,ft,Ct,Vt,It,$t,vr,Ft,Bt){const _t=32*l,Fr=16*l;return this.int16[_t+0]=d,this.int16[_t+1]=g,this.int16[_t+2]=_,this.int16[_t+3]=C,this.int16[_t+4]=A,this.int16[_t+5]=M,this.int16[_t+6]=L,this.int16[_t+7]=q,this.uint16[_t+8]=U,this.uint16[_t+9]=H,this.uint16[_t+10]=Q,this.uint16[_t+11]=ee,this.uint16[_t+12]=oe,this.uint16[_t+13]=fe,this.uint16[_t+14]=be,this.uint16[_t+15]=Pe,this.uint16[_t+16]=Qe,this.uint16[_t+17]=De,this.uint16[_t+18]=ze,this.uint16[_t+19]=it,this.uint16[_t+20]=ft,this.uint16[_t+21]=Ct,this.uint16[_t+22]=Vt,this.uint32[Fr+12]=It,this.float32[Fr+13]=$t,this.float32[Fr+14]=vr,this.uint16[_t+30]=Ft,this.uint16[_t+31]=Bt,l}}Vv.prototype.bytesPerElement=64,Kt("StructArrayLayout8i15ui1ul2f2ui64",Vv);class w extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l){const d=this.length;return this.resize(d+1),this.emplace(d,l)}emplace(l,d){return this.float32[1*l+0]=d,l}}w.prototype.bytesPerElement=4,Kt("StructArrayLayout1f4",w);class o extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,d,g){const _=this.length;return this.resize(_+1),this.emplace(_,l,d,g)}emplace(l,d,g,_){const C=3*l;return this.uint16[6*l+0]=d,this.float32[C+1]=g,this.float32[C+2]=_,l}}o.prototype.bytesPerElement=12,Kt("StructArrayLayout1ui2f12",o);class f extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,d,g){const _=this.length;return this.resize(_+1),this.emplace(_,l,d,g)}emplace(l,d,g,_){const C=4*l;return this.uint32[2*l+0]=d,this.uint16[C+2]=g,this.uint16[C+3]=_,l}}f.prototype.bytesPerElement=8,Kt("StructArrayLayout1ul2ui8",f);class x extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,d){const g=this.length;return this.resize(g+1),this.emplace(g,l,d)}emplace(l,d,g){const _=2*l;return this.uint16[_+0]=d,this.uint16[_+1]=g,l}}x.prototype.bytesPerElement=4,Kt("StructArrayLayout2ui4",x);class b extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l){const d=this.length;return this.resize(d+1),this.emplace(d,l)}emplace(l,d){return this.uint16[1*l+0]=d,l}}b.prototype.bytesPerElement=2,Kt("StructArrayLayout1ui2",b);class P extends us{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,d,g,_){const C=this.length;return this.resize(C+1),this.emplace(C,l,d,g,_)}emplace(l,d,g,_,C){const A=4*l;return this.float32[A+0]=d,this.float32[A+1]=g,this.float32[A+2]=_,this.float32[A+3]=C,l}}P.prototype.bytesPerElement=16,Kt("StructArrayLayout4f16",P);class E extends ll{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new m(this.anchorPointX,this.anchorPointY)}}E.prototype.size=20;class F extends Bv{get(l){return new E(this,l)}}Kt("CollisionBoxArray",F);class B extends ll{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(l){this._structArray.uint8[this._pos1+37]=l}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(l){this._structArray.uint8[this._pos1+38]=l}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(l){this._structArray.uint32[this._pos4+10]=l}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}B.prototype.size=48;class W extends Wp{get(l){return new B(this,l)}}Kt("PlacedSymbolArray",W);class G extends ll{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(l){this._structArray.uint32[this._pos4+12]=l}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}G.prototype.size=64;class Y extends Vv{get(l){return new G(this,l)}}Kt("SymbolInstanceArray",Y);class Z extends w{getoffsetX(l){return this.float32[1*l+0]}}Kt("GlyphOffsetArray",Z);class re extends $p{getx(l){return this.int16[3*l+0]}gety(l){return this.int16[3*l+1]}gettileUnitDistanceFromAnchor(l){return this.int16[3*l+2]}}Kt("SymbolLineVertexArray",re);class he extends ll{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}he.prototype.size=12;class je extends o{get(l){return new he(this,l)}}Kt("TextAnchorOffsetArray",je);class we extends ll{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}we.prototype.size=8;class Se extends f{get(l){return new we(this,l)}}Kt("FeatureIndexArray",Se);class Ee extends Gd{}class Re extends Gd{}class Te extends Gd{}class Le extends Bl{}class $e extends Bp{}class Ie extends Nu{}class Ke extends qp{}class ut extends Uf{}class st extends $v{}class ot extends Kd{}class dt extends Pu{}class kt extends Vp{}class Et extends qv{}class bt extends Up{}class rr extends x{}const Wr=Ms([{name:"a_pos",components:2,type:"Int16"}],4),{members:On}=Wr;class Hr{constructor(l=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=l}prepareSegment(l,d,g,_){const C=this.segments[this.segments.length-1];return l>Hr.MAX_VERTEX_ARRAY_LENGTH&&ar(`Max vertices per segment is ${Hr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${l}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Hr.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!C||C.vertexLength+l>Hr.MAX_VERTEX_ARRAY_LENGTH||C.sortKey!==_?this.createNewSegment(d,g,_):C}createNewSegment(l,d,g){const _={vertexOffset:l.length,primitiveOffset:d.length,vertexLength:0,primitiveLength:0,vaos:{}};return g!==void 0&&(_.sortKey=g),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(_),_}getOrCreateLatestSegment(l,d,g){return this.prepareSegment(0,l,d,g)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const l of this.segments)for(const d in l.vaos)l.vaos[d].destroy()}static simpleSegment(l,d,g,_){return new Hr([{vertexOffset:l,primitiveOffset:d,vertexLength:g,primitiveLength:_,vaos:{},sortKey:0}])}}function qn(h,l){return 256*(h=Pr(Math.floor(h),0,255))+Pr(Math.floor(l),0,255)}Hr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Kt("SegmentVector",Hr);const ds=Ms([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Kn=Ms([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var ri,ns,gi,ss={exports:{}},Us={exports:{}},ha={exports:{}},Au=function(){if(gi)return ss.exports;gi=1;var h=(ri||(ri=1,Us.exports=function(d,g){var _,C,A,M,L,q,U,H;for(C=d.length-(_=3&d.length),A=g,L=3432918353,q=461845907,H=0;H<C;)U=255&d.charCodeAt(H)|(255&d.charCodeAt(++H))<<8|(255&d.charCodeAt(++H))<<16|(255&d.charCodeAt(++H))<<24,++H,A=27492+(65535&(M=5*(65535&(A=(A^=U=(65535&(U=(U=(65535&U)*L+(((U>>>16)*L&65535)<<16)&4294967295)<<15|U>>>17))*q+(((U>>>16)*q&65535)<<16)&4294967295)<<13|A>>>19))+((5*(A>>>16)&65535)<<16)&4294967295))+((58964+(M>>>16)&65535)<<16);switch(U=0,_){case 3:U^=(255&d.charCodeAt(H+2))<<16;case 2:U^=(255&d.charCodeAt(H+1))<<8;case 1:A^=U=(65535&(U=(U=(65535&(U^=255&d.charCodeAt(H)))*L+(((U>>>16)*L&65535)<<16)&4294967295)<<15|U>>>17))*q+(((U>>>16)*q&65535)<<16)&4294967295}return A^=d.length,A=2246822507*(65535&(A^=A>>>16))+((2246822507*(A>>>16)&65535)<<16)&4294967295,A=3266489909*(65535&(A^=A>>>13))+((3266489909*(A>>>16)&65535)<<16)&4294967295,(A^=A>>>16)>>>0}),Us.exports),l=(ns||(ns=1,ha.exports=function(d,g){for(var _,C=d.length,A=g^C,M=0;C>=4;)_=1540483477*(65535&(_=255&d.charCodeAt(M)|(255&d.charCodeAt(++M))<<8|(255&d.charCodeAt(++M))<<16|(255&d.charCodeAt(++M))<<24))+((1540483477*(_>>>16)&65535)<<16),A=1540483477*(65535&A)+((1540483477*(A>>>16)&65535)<<16)^(_=1540483477*(65535&(_^=_>>>24))+((1540483477*(_>>>16)&65535)<<16)),C-=4,++M;switch(C){case 3:A^=(255&d.charCodeAt(M+2))<<16;case 2:A^=(255&d.charCodeAt(M+1))<<8;case 1:A=1540483477*(65535&(A^=255&d.charCodeAt(M)))+((1540483477*(A>>>16)&65535)<<16)}return A=1540483477*(65535&(A^=A>>>13))+((1540483477*(A>>>16)&65535)<<16),(A^=A>>>15)>>>0}),ha.exports);return ss.exports=h,ss.exports.murmur3=h,ss.exports.murmur2=l,ss.exports}(),ql=p(Au);class cl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(l,d,g,_){this.ids.push(ku(l)),this.positions.push(d,g,_)}getPositions(l){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const d=ku(l);let g=0,_=this.ids.length-1;for(;g<_;){const A=g+_>>1;this.ids[A]>=d?_=A:g=A+1}const C=[];for(;this.ids[g]===d;)C.push({index:this.positions[3*g],start:this.positions[3*g+1],end:this.positions[3*g+2]}),g++;return C}static serialize(l,d){const g=new Float64Array(l.ids),_=new Uint32Array(l.positions);return Hd(g,_,0,g.length-1),d&&d.push(g.buffer,_.buffer),{ids:g,positions:_}}static deserialize(l){const d=new cl;return d.ids=l.ids,d.positions=l.positions,d.indexed=!0,d}}function ku(h){const l=+h;return!isNaN(l)&&l<=Number.MAX_SAFE_INTEGER?l:ql(String(h))}function Hd(h,l,d,g){for(;d<g;){const _=h[d+g>>1];let C=d-1,A=g+1;for(;;){do C++;while(h[C]<_);do A--;while(h[A]>_);if(C>=A)break;Tu(h,C,A),Tu(l,3*C,3*A),Tu(l,3*C+1,3*A+1),Tu(l,3*C+2,3*A+2)}A-d<g-A?(Hd(h,l,d,A),d=A+1):(Hd(h,l,A+1,g),g=A)}}function Tu(h,l,d){const g=h[l];h[l]=h[d],h[d]=g}Kt("FeaturePositionMap",cl);class Sa{constructor(l,d){this.gl=l.gl,this.location=d}}class fa extends Sa{constructor(l,d){super(l,d),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class Vl extends Sa{constructor(l,d){super(l,d),this.current=[0,0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3]))}}class kc extends Sa{constructor(l,d){super(l,d),this.current=Ur.transparent}set(l){l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a))}}const Wf=new Float32Array(16);function Ws(h){return[qn(255*h.r,255*h.g),qn(255*h.b,255*h.a)]}class Os{constructor(l,d,g){this.value=l,this.uniformNames=d.map(_=>`u_${_}`),this.type=g}setUniform(l,d,g){l.set(g.constantOr(this.value))}getBinding(l,d,g){return this.type==="color"?new kc(l,d):new fa(l,d)}}class xi{constructor(l,d){this.uniformNames=d.map(g=>`u_${g}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(l,d){this.pixelRatioFrom=d.pixelRatio,this.pixelRatioTo=l.pixelRatio,this.patternFrom=d.tlbr,this.patternTo=l.tlbr}setConstantDashPositions(l,d){this.dashTo=[0,l.y,l.height,l.width],this.dashFrom=[0,d.y,d.height,d.width]}setUniform(l,d,g,_){let C=null;_==="u_pattern_to"?C=this.patternTo:_==="u_pattern_from"?C=this.patternFrom:_==="u_dasharray_to"?C=this.dashTo:_==="u_dasharray_from"?C=this.dashFrom:_==="u_pixel_ratio_to"?C=this.pixelRatioTo:_==="u_pixel_ratio_from"&&(C=this.pixelRatioFrom),C!==null&&l.set(C)}getBinding(l,d,g){return g.substr(0,9)==="u_pattern"||g.substr(0,12)==="u_dasharray_"?new Vl(l,d):new fa(l,d)}}class Jn{constructor(l,d,g,_){this.expression=l,this.type=g,this.maxValue=0,this.paintVertexAttributes=d.map(C=>({name:`a_${C}`,type:"Float32",components:g==="color"?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(l,d,g){const _=this.paintVertexArray.length,C=this.expression.evaluate(new Bn(0,g),d,{},g.canonical,[],g.formattedSection);this.paintVertexArray.resize(l),this._setPaintValue(_,l,C)}updatePaintArray(l,d,g,_,C){const A=this.expression.evaluate(new Bn(0,C),g,_);this._setPaintValue(l,d,A)}_setPaintValue(l,d,g){if(this.type==="color"){const _=Ws(g);for(let C=l;C<d;C++)this.paintVertexArray.emplace(C,_[0],_[1])}else{for(let _=l;_<d;_++)this.paintVertexArray.emplace(_,g);this.maxValue=Math.max(this.maxValue,Math.abs(g))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class To{constructor(l,d,g,_,C,A){this.expression=l,this.uniformNames=d.map(M=>`u_${M}_t`),this.type=g,this.useIntegerZoom=_,this.zoom=C,this.maxValue=0,this.paintVertexAttributes=d.map(M=>({name:`a_${M}`,type:"Float32",components:g==="color"?4:2,offset:0})),this.paintVertexArray=new A}populatePaintArray(l,d,g){const _=this.expression.evaluate(new Bn(this.zoom,g),d,{},g.canonical,[],g.formattedSection),C=this.expression.evaluate(new Bn(this.zoom+1,g),d,{},g.canonical,[],g.formattedSection),A=this.paintVertexArray.length;this.paintVertexArray.resize(l),this._setPaintValue(A,l,_,C)}updatePaintArray(l,d,g,_,C){const A=this.expression.evaluate(new Bn(this.zoom,C),g,_),M=this.expression.evaluate(new Bn(this.zoom+1,C),g,_);this._setPaintValue(l,d,A,M)}_setPaintValue(l,d,g,_){if(this.type==="color"){const C=Ws(g),A=Ws(_);for(let M=l;M<d;M++)this.paintVertexArray.emplace(M,C[0],C[1],A[0],A[1])}else{for(let C=l;C<d;C++)this.paintVertexArray.emplace(C,g,_);this.maxValue=Math.max(this.maxValue,Math.abs(g),Math.abs(_))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(l,d){const g=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,_=Pr(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);l.set(_)}getBinding(l,d,g){return new fa(l,d)}}class Tc{constructor(l,d,g,_,C,A){this.expression=l,this.type=d,this.useIntegerZoom=g,this.zoom=_,this.layerId=A,this.zoomInPaintVertexArray=new C,this.zoomOutPaintVertexArray=new C}populatePaintArray(l,d,g){const _=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(l),this.zoomOutPaintVertexArray.resize(l),this._setPaintValues(_,l,this.getPositionIds(d),g)}updatePaintArray(l,d,g,_,C){this._setPaintValues(l,d,this.getPositionIds(g),C)}_setPaintValues(l,d,g,_){const C=this.getPositions(_);if(!C||!g)return;const A=C[g.min],M=C[g.mid],L=C[g.max];if(A&&M&&L)for(let q=l;q<d;q++)this.emplace(this.zoomInPaintVertexArray,q,M,A),this.emplace(this.zoomOutPaintVertexArray,q,M,L)}upload(l){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const d=this.getVertexAttributes();this.zoomInPaintVertexBuffer=l.createVertexBuffer(this.zoomInPaintVertexArray,d,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=l.createVertexBuffer(this.zoomOutPaintVertexArray,d,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class tw extends Tc{getPositions(l){return l.imagePositions}getPositionIds(l){return l.patterns&&l.patterns[this.layerId]}getVertexAttributes(){return ds.members}emplace(l,d,g,_){l.emplace(d,g.tlbr[0],g.tlbr[1],g.tlbr[2],g.tlbr[3],_.tlbr[0],_.tlbr[1],_.tlbr[2],_.tlbr[3],g.pixelRatio,_.pixelRatio)}}class rw extends Tc{getPositions(l){return l.dashPositions}getPositionIds(l){return l.dashes&&l.dashes[this.layerId]}getVertexAttributes(){return Kn.members}emplace(l,d,g,_){l.emplace(d,0,g.y,g.height,g.width,0,_.y,_.height,_.width)}}class nw{constructor(l,d,g){this.binders={},this._buffers=[];const _=[];for(const C in l.paint._values){if(!g(C))continue;const A=l.paint.get(C);if(!(A instanceof Ao&&$d(A.property.specification)))continue;const M=Mu(C,l.type),L=A.value,q=A.property.specification.type,U=A.property.useIntegerZoom,H=A.property.specification["property-type"],Q=H==="cross-faded"||H==="cross-faded-data-driven";if(L.kind==="constant")this.binders[C]=Q?new xi(L.value,M):new Os(L.value,M,q),_.push(`/u_${C}`);else if(L.kind==="source"||Q){const ee=Uv(C,q,"source");this.binders[C]=Q?C==="line-dasharray"?new rw(L,q,U,d,ee,l.id):new tw(L,q,U,d,ee,l.id):new Jn(L,M,q,ee),_.push(`/a_${C}`)}else{const ee=Uv(C,q,"composite");this.binders[C]=new To(L,M,q,U,d,ee),_.push(`/z_${C}`)}}this.cacheKey=_.sort().join("")}getMaxValue(l){const d=this.binders[l];return d instanceof Jn||d instanceof To?d.maxValue:0}populatePaintArrays(l,d,g){for(const _ in this.binders){const C=this.binders[_];(C instanceof Jn||C instanceof To||C instanceof Tc)&&C.populatePaintArray(l,d,g)}}setConstantPatternPositions(l,d){for(const g in this.binders){const _=this.binders[g];_ instanceof xi&&_.setConstantPatternPositions(l,d)}}setConstantDashPositions(l,d){for(const g in this.binders){const _=this.binders[g];_ instanceof xi&&_.setConstantDashPositions(l,d)}}updatePaintArrays(l,d,g,_,C){let A=!1;for(const M in l){const L=d.getPositions(M);for(const q of L){const U=g.feature(q.index);for(const H in this.binders){const Q=this.binders[H];if((Q instanceof Jn||Q instanceof To||Q instanceof Tc)&&Q.expression.isStateDependent===!0){const ee=_.paint.get(H);Q.expression=ee.value,Q.updatePaintArray(q.start,q.end,U,l[M],C),A=!0}}}}return A}defines(){const l=[];for(const d in this.binders){const g=this.binders[d];(g instanceof Os||g instanceof xi)&&l.push(...g.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return l}getBinderAttributes(){const l=[];for(const d in this.binders){const g=this.binders[d];if(g instanceof Jn||g instanceof To)for(let _=0;_<g.paintVertexAttributes.length;_++)l.push(g.paintVertexAttributes[_].name);else if(g instanceof Tc){const _=g.getVertexAttributes();for(const C of _)l.push(C.name)}}return l}getBinderUniforms(){const l=[];for(const d in this.binders){const g=this.binders[d];if(g instanceof Os||g instanceof xi||g instanceof To)for(const _ of g.uniformNames)l.push(_)}return l}getPaintVertexBuffers(){return this._buffers}getUniforms(l,d){const g=[];for(const _ in this.binders){const C=this.binders[_];if(C instanceof Os||C instanceof xi||C instanceof To){for(const A of C.uniformNames)if(d[A]){const M=C.getBinding(l,d[A],A);g.push({name:A,property:_,binding:M})}}}return g}setUniforms(l,d,g,_){for(const{name:C,property:A,binding:M}of d)this.binders[A].setUniform(M,_,g.get(A),C)}updatePaintBuffers(l){this._buffers=[];for(const d in this.binders){const g=this.binders[d];if(l&&g instanceof Tc){const _=l.fromScale===2?g.zoomInPaintVertexBuffer:g.zoomOutPaintVertexBuffer;_&&this._buffers.push(_)}else(g instanceof Jn||g instanceof To)&&g.paintVertexBuffer&&this._buffers.push(g.paintVertexBuffer)}}upload(l){for(const d in this.binders){const g=this.binders[d];(g instanceof Jn||g instanceof To||g instanceof Tc)&&g.upload(l)}this.updatePaintBuffers()}destroy(){for(const l in this.binders){const d=this.binders[l];(d instanceof Jn||d instanceof To||d instanceof Tc)&&d.destroy()}}}class Eu{constructor(l,d,g=()=>!0){this.programConfigurations={};for(const _ of l)this.programConfigurations[_.id]=new nw(_,d,g);this.needsUpload=!1,this._featureMap=new cl,this._bufferOffset=0}populatePaintArrays(l,d,g,_){for(const C in this.programConfigurations)this.programConfigurations[C].populatePaintArrays(l,d,_);d.id!==void 0&&this._featureMap.add(d.id,g,this._bufferOffset,l),this._bufferOffset=l,this.needsUpload=!0}updatePaintArrays(l,d,g,_){for(const C of g)this.needsUpload=this.programConfigurations[C.id].updatePaintArrays(l,this._featureMap,d,C,_)||this.needsUpload}get(l){return this.programConfigurations[l]}upload(l){if(this.needsUpload){for(const d in this.programConfigurations)this.programConfigurations[d].upload(l);this.needsUpload=!1}}destroy(){for(const l in this.programConfigurations)this.programConfigurations[l].destroy()}}function Mu(h,l){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[h]||[h.replace(`${l}-`,"").replace(/-/g,"_")]}function Uv(h,l,d){const g={color:{source:Nu,composite:P},number:{source:w,composite:Nu}},_=function(C){return{"line-pattern":{source:Ke,composite:Ke},"fill-pattern":{source:Ke,composite:Ke},"fill-extrusion-pattern":{source:Ke,composite:Ke},"line-dasharray":{source:ut,composite:ut}}[C]}(h);return _&&_[d]||g[l][d]}Kt("ConstantBinder",Os),Kt("CrossFadedConstantBinder",xi),Kt("SourceExpressionBinder",Jn),Kt("CrossFadedPatternBinder",tw),Kt("CrossFadedDasharrayBinder",rw),Kt("CompositeExpressionBinder",To),Kt("ProgramConfiguration",nw,{omit:["_buffers"]}),Kt("ProgramConfigurationSet",Eu);const Gp=Math.pow(2,14)-1,Wv=-Gp-1;function Ul(h){const l=_e/h.extent,d=h.loadGeometry();for(let g=0;g<d.length;g++){const _=d[g];for(let C=0;C<_.length;C++){const A=_[C],M=Math.round(A.x*l),L=Math.round(A.y*l);A.x=Pr(M,Wv,Gp),A.y=Pr(L,Wv,Gp),(M<A.x||M>A.x+1||L<A.y||L>A.y+1)&&ar("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return d}function Ec(h,l){return{type:h.type,id:h.id,properties:h.properties,geometry:l?Ul(h):[]}}const Kp=-32768;function kZ(h,l,d,g,_){h.emplaceBack(Kp+8*l+g,Kp+8*d+_)}class GP{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(d=>d.id),this.index=l.index,this.hasDependencies=!1,this.layoutVertexArray=new Re,this.indexArray=new bt,this.segments=new Hr,this.programConfigurations=new Eu(l.layers,l.zoom),this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(l,d,g){const _=this.layers[0],C=[];let A=null,M=!1,L=_.type==="heatmap";if(_.type==="circle"){const U=_;A=U.layout.get("circle-sort-key"),M=!A.isConstant(),L=L||U.paint.get("circle-pitch-alignment")==="map"}const q=L?d.subdivisionGranularity.circle:1;for(const{feature:U,id:H,index:Q,sourceLayerIndex:ee}of l){const oe=this.layers[0]._featureFilter.needGeometry,fe=Ec(U,oe);if(!this.layers[0]._featureFilter.filter(new Bn(this.zoom),fe,g))continue;const be=M?A.evaluate(fe,{},g):void 0,Pe={id:H,properties:U.properties,type:U.type,sourceLayerIndex:ee,index:Q,geometry:oe?fe.geometry:Ul(U),patterns:{},sortKey:be};C.push(Pe)}M&&C.sort((U,H)=>U.sortKey-H.sortKey);for(const U of C){const{geometry:H,index:Q,sourceLayerIndex:ee}=U,oe=l[Q].feature;this.addFeature(U,H,Q,g,q),d.featureIndex.insert(oe,H,Q,ee,this.index)}}update(l,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,d,this.stateDependentLayers,{imagePositions:g})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,On),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(l,d,g,_,C=1){let A;switch(C){case 1:A=[0,7];break;case 3:A=[0,2,5,7];break;case 5:A=[0,1,3,4,6,7];break;case 7:A=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${C}; valid values are 1, 3, 5, 7.`)}const M=A.length;for(const L of d)for(const q of L){const U=q.x,H=q.y;if(U<0||U>=_e||H<0||H>=_e)continue;const Q=this.segments.prepareSegment(M*M,this.layoutVertexArray,this.indexArray,l.sortKey),ee=Q.vertexLength;for(let oe=0;oe<M;oe++)for(let fe=0;fe<M;fe++)kZ(this.layoutVertexArray,U,H,A[fe],A[oe]);for(let oe=0;oe<M-1;oe++)for(let fe=0;fe<M-1;fe++){const be=ee+oe*M+fe,Pe=ee+(oe+1)*M+fe;this.indexArray.emplaceBack(be,Pe+1,be+1),this.indexArray.emplaceBack(be,Pe,Pe+1)}Q.vertexLength+=M*M,Q.primitiveLength+=(M-1)*(M-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,g,{imagePositions:{},canonical:_})}}function zD(h,l){for(let d=0;d<h.length;d++)if(Hp(l,h[d]))return!0;for(let d=0;d<l.length;d++)if(Hp(h,l[d]))return!0;return!!KP(h,l)}function sw(h,l,d){return!!Hp(h,l)||!!HP(l,h,d)}function $D(h,l){if(h.length===1)return qD(l,h[0]);for(let d=0;d<l.length;d++){const g=l[d];for(let _=0;_<g.length;_++)if(Hp(h,g[_]))return!0}for(let d=0;d<h.length;d++)if(qD(l,h[d]))return!0;for(let d=0;d<l.length;d++)if(KP(h,l[d]))return!0;return!1}function TZ(h,l,d){if(h.length>1){if(KP(h,l))return!0;for(let g=0;g<l.length;g++)if(HP(l[g],h,d))return!0}for(let g=0;g<h.length;g++)if(HP(h[g],l,d))return!0;return!1}function KP(h,l){if(h.length===0||l.length===0)return!1;for(let d=0;d<h.length-1;d++){const g=h[d],_=h[d+1];for(let C=0;C<l.length-1;C++)if(EZ(g,_,l[C],l[C+1]))return!0}return!1}function EZ(h,l,d,g){return en(h,d,g)!==en(l,d,g)&&en(h,l,d)!==en(h,l,g)}function HP(h,l,d){const g=d*d;if(l.length===1)return h.distSqr(l[0])<g;for(let _=1;_<l.length;_++)if(BD(h,l[_-1],l[_])<g)return!0;return!1}function BD(h,l,d){const g=l.distSqr(d);if(g===0)return h.distSqr(l);const _=((h.x-l.x)*(d.x-l.x)+(h.y-l.y)*(d.y-l.y))/g;return h.distSqr(_<0?l:_>1?d:d.sub(l)._mult(_)._add(l))}function qD(h,l){let d,g,_,C=!1;for(let A=0;A<h.length;A++){d=h[A];for(let M=0,L=d.length-1;M<d.length;L=M++)g=d[M],_=d[L],g.y>l.y!=_.y>l.y&&l.x<(_.x-g.x)*(l.y-g.y)/(_.y-g.y)+g.x&&(C=!C)}return C}function Hp(h,l){let d=!1;for(let g=0,_=h.length-1;g<h.length;_=g++){const C=h[g],A=h[_];C.y>l.y!=A.y>l.y&&l.x<(A.x-C.x)*(l.y-C.y)/(A.y-C.y)+C.x&&(d=!d)}return d}function MZ(h,l,d){const g=d[0],_=d[2];if(h.x<g.x&&l.x<g.x||h.x>_.x&&l.x>_.x||h.y<g.y&&l.y<g.y||h.y>_.y&&l.y>_.y)return!1;const C=en(h,l,d[0]);return C!==en(h,l,d[1])||C!==en(h,l,d[2])||C!==en(h,l,d[3])}function Zp(h,l,d){const g=l.paint.get(h).value;return g.kind==="constant"?g.value:d.programConfigurations.get(l.id).getMaxValue(h)}function iw(h){return Math.sqrt(h[0]*h[0]+h[1]*h[1])}function aw(h,l,d,g,_){if(!l[0]&&!l[1])return h;const C=m.convert(l)._mult(_);d==="viewport"&&C._rotate(-g);const A=[];for(let M=0;M<h.length;M++)A.push(h[M].sub(C));return A}function OZ({queryGeometry:h,size:l},d){return sw(h,d,l)}function IZ({queryGeometry:h,size:l,transform:d,unwrappedTileID:g,getElevation:_},C){return sw(h,C,l*(d.projectTileCoordinates(C.x,C.y,g,_).signedDistanceFromCamera/d.cameraToCenterDistance))}function DZ({queryGeometry:h,size:l,transform:d,unwrappedTileID:g,getElevation:_},C){const A=d.projectTileCoordinates(C.x,C.y,g,_).signedDistanceFromCamera,M=l*(d.cameraToCenterDistance/A);return sw(h,ZP(C,d,g,_),M)}function RZ({queryGeometry:h,size:l,transform:d,unwrappedTileID:g,getElevation:_},C){return sw(h,ZP(C,d,g,_),l)}function VD({queryGeometry:h,size:l,transform:d,unwrappedTileID:g,getElevation:_,pitchAlignment:C="map",pitchScale:A="map"},M){const L=C==="map"?A==="map"?OZ:IZ:A==="map"?DZ:RZ,q={queryGeometry:h,size:l,transform:d,unwrappedTileID:g,getElevation:_};for(const U of M)for(const H of U)if(L(q,H))return!0;return!1}function ZP(h,l,d,g){const _=l.projectTileCoordinates(h.x,h.y,d,g).point;return new m((.5*_.x+.5)*l.width,(.5*-_.y+.5)*l.height)}let UD,WD;Kt("CircleBucket",GP,{omit:["layers"]});var LZ={get paint(){return WD=WD||new Xi({"circle-radius":new Tr(Je.paint_circle["circle-radius"]),"circle-color":new Tr(Je.paint_circle["circle-color"]),"circle-blur":new Tr(Je.paint_circle["circle-blur"]),"circle-opacity":new Tr(Je.paint_circle["circle-opacity"]),"circle-translate":new fr(Je.paint_circle["circle-translate"]),"circle-translate-anchor":new fr(Je.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new fr(Je.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new fr(Je.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Tr(Je.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Tr(Je.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Tr(Je.paint_circle["circle-stroke-opacity"])})},get layout(){return UD=UD||new Xi({"circle-sort-key":new Tr(Je.layout_circle["circle-sort-key"])})}};class FZ extends ko{constructor(l,d){super(l,LZ,d)}createBucket(l){return new GP(l)}queryRadius(l){const d=l;return Zp("circle-radius",this,d)+Zp("circle-stroke-width",this,d)+iw(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:l,feature:d,featureState:g,geometry:_,transform:C,pixelsToTileUnits:A,unwrappedTileID:M,getElevation:L}){const q=aw(l,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-C.bearingInRadians,A),U=this.paint.get("circle-radius").evaluate(d,g)+this.paint.get("circle-stroke-width").evaluate(d,g),H=this.paint.get("circle-pitch-scale"),Q=this.paint.get("circle-pitch-alignment");let ee,oe;return Q==="map"?(ee=q,oe=U*A):(ee=function(fe,be,Pe,Qe){return fe.map(De=>ZP(De,be,Pe,Qe))}(q,C,M,L),oe=U),VD({queryGeometry:ee,size:oe,transform:C,unwrappedTileID:M,getElevation:L,pitchAlignment:Q,pitchScale:H},_)}}class GD extends GP{}let KD;Kt("HeatmapBucket",GD,{omit:["layers"]});var zZ={get paint(){return KD=KD||new Xi({"heatmap-radius":new Tr(Je.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Tr(Je.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new fr(Je.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Vf(Je.paint_heatmap["heatmap-color"]),"heatmap-opacity":new fr(Je.paint_heatmap["heatmap-opacity"])})}};function YP(h,{width:l,height:d},g,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==l*d*g)throw new RangeError(`mismatched image size. expected: ${_.length} but got: ${l*d*g}`)}else _=new Uint8Array(l*d*g);return h.width=l,h.height=d,h.data=_,h}function HD(h,{width:l,height:d},g){if(l===h.width&&d===h.height)return;const _=YP({},{width:l,height:d},g);XP(h,_,{x:0,y:0},{x:0,y:0},{width:Math.min(h.width,l),height:Math.min(h.height,d)},g),h.width=l,h.height=d,h.data=_.data}function XP(h,l,d,g,_,C){if(_.width===0||_.height===0)return l;if(_.width>h.width||_.height>h.height||d.x>h.width-_.width||d.y>h.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>l.width||_.height>l.height||g.x>l.width-_.width||g.y>l.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const A=h.data,M=l.data;if(A===M)throw new Error("srcData equals dstData, so image is already copied");for(let L=0;L<_.height;L++){const q=((d.y+L)*h.width+d.x)*C,U=((g.y+L)*l.width+g.x)*C;for(let H=0;H<_.width*C;H++)M[U+H]=A[q+H]}return l}class Gv{constructor(l,d){YP(this,l,1,d)}resize(l){HD(this,l,1)}clone(){return new Gv({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,d,g,_,C){XP(l,d,g,_,C,1)}}class Ba{constructor(l,d){YP(this,l,4,d)}resize(l){HD(this,l,4)}replace(l,d){d?this.data.set(l):this.data=l instanceof Uint8ClampedArray?new Uint8Array(l.buffer):l}clone(){return new Ba({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,d,g,_,C){XP(l,d,g,_,C,4)}setPixel(l,d,g){const _=4*(l*this.width+d);this.data[_+0]=Math.round(255*g.r/g.a),this.data[_+1]=Math.round(255*g.g/g.a),this.data[_+2]=Math.round(255*g.b/g.a),this.data[_+3]=Math.round(255*g.a)}}function ZD(h){const l={},d=h.resolution||256,g=h.clips?h.clips.length:1,_=h.image||new Ba({width:d,height:g});if(Math.log(d)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${d}`);const C=(A,M,L)=>{l[h.evaluationKey]=L;const q=h.expression.evaluate(l);_.setPixel(A/4/d,M/4,q)};if(h.clips)for(let A=0,M=0;A<g;++A,M+=4*d)for(let L=0,q=0;L<d;L++,q+=4){const U=L/(d-1),{start:H,end:Q}=h.clips[A];C(M,q,H*(1-U)+Q*U)}else for(let A=0,M=0;A<d;A++,M+=4)C(0,M,A/(d-1));return _}Kt("AlphaImage",Gv),Kt("RGBAImage",Ba);const QP="big-fb";class $Z extends ko{createBucket(l){return new GD(l)}constructor(l,d){super(l,zZ,d),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=ZD({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(QP)&&this.heatmapFbos.delete(QP)}queryRadius(l){return Zp("heatmap-radius",this,l)}queryIntersectsFeature({queryGeometry:l,feature:d,featureState:g,geometry:_,transform:C,pixelsToTileUnits:A,unwrappedTileID:M,getElevation:L}){return VD({queryGeometry:l,size:this.paint.get("heatmap-radius").evaluate(d,g)*A,transform:C,unwrappedTileID:M,getElevation:L},_)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let YD;var BZ={get paint(){return YD=YD||new Xi({"hillshade-illumination-direction":new fr(Je.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new fr(Je.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new fr(Je.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new fr(Je.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new fr(Je.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new fr(Je.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new fr(Je.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new fr(Je.paint_hillshade["hillshade-method"])})}};class qZ extends ko{constructor(l,d){super(l,BZ,d),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let l=this.paint.get("hillshade-illumination-direction").values,d=this.paint.get("hillshade-illumination-altitude").values,g=this.paint.get("hillshade-highlight-color").values,_=this.paint.get("hillshade-shadow-color").values;const C=Math.max(l.length,d.length,g.length,_.length);l=l.concat(Array(C-l.length).fill(l.at(-1))),d=d.concat(Array(C-d.length).fill(d.at(-1))),g=g.concat(Array(C-g.length).fill(g.at(-1))),_=_.concat(Array(C-_.length).fill(_.at(-1)));const A=d.map(Ot);return{directionRadians:l.map(Ot),altitudeRadians:A,shadowColor:_,highlightColor:g}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let XD;var VZ={get paint(){return XD=XD||new Xi({"color-relief-opacity":new fr(Je["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Vf(Je["paint_color-relief"]["color-relief-color"])})}};class JP{constructor(l,d,g,_){this.context=l,this.format=g,this.texture=l.gl.createTexture(),this.update(d,_)}update(l,d,g){const{width:_,height:C}=l,A=!(this.size&&this.size[0]===_&&this.size[1]===C||g),{context:M}=this,{gl:L}=M;if(this.useMipmap=!!(d&&d.useMipmap),L.bindTexture(L.TEXTURE_2D,this.texture),M.pixelStoreUnpackFlipY.set(!1),M.pixelStoreUnpack.set(1),M.pixelStoreUnpackPremultiplyAlpha.set(this.format===L.RGBA&&(!d||d.premultiply!==!1)),A)this.size=[_,C],l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||Wn(l)?L.texImage2D(L.TEXTURE_2D,0,this.format,this.format,L.UNSIGNED_BYTE,l):L.texImage2D(L.TEXTURE_2D,0,this.format,_,C,0,this.format,L.UNSIGNED_BYTE,l.data);else{const{x:q,y:U}=g||{x:0,y:0};l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||Wn(l)?L.texSubImage2D(L.TEXTURE_2D,0,q,U,L.RGBA,L.UNSIGNED_BYTE,l):L.texSubImage2D(L.TEXTURE_2D,0,q,U,_,C,L.RGBA,L.UNSIGNED_BYTE,l.data)}this.useMipmap&&this.isSizePowerOfTwo()&&L.generateMipmap(L.TEXTURE_2D),M.pixelStoreUnpackFlipY.setDefault(),M.pixelStoreUnpack.setDefault(),M.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(l,d,g){const{context:_}=this,{gl:C}=_;C.bindTexture(C.TEXTURE_2D,this.texture),g!==C.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(g=C.LINEAR),l!==this.filter&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,l),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,g||l),this.filter=l),d!==this.wrap&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,d),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,d),this.wrap=d)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}class QD{constructor(l,d,g,_=1,C=1,A=1,M=0){if(this.uid=l,d.height!==d.width)throw new RangeError("DEM tiles must be square");if(g&&!["mapbox","terrarium","custom"].includes(g))return void ar(`"${g}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=d.height;const L=this.dim=d.height-2;switch(this.data=new Uint32Array(d.data.buffer),g){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=_,this.greenFactor=C,this.blueFactor=A,this.baseShift=M;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let q=0;q<L;q++)this.data[this._idx(-1,q)]=this.data[this._idx(0,q)],this.data[this._idx(L,q)]=this.data[this._idx(L-1,q)],this.data[this._idx(q,-1)]=this.data[this._idx(q,0)],this.data[this._idx(q,L)]=this.data[this._idx(q,L-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(L,-1)]=this.data[this._idx(L-1,0)],this.data[this._idx(-1,L)]=this.data[this._idx(0,L-1)],this.data[this._idx(L,L)]=this.data[this._idx(L-1,L-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let q=0;q<L;q++)for(let U=0;U<L;U++){const H=this.get(q,U);H>this.max&&(this.max=H),H<this.min&&(this.min=H)}}get(l,d){const g=new Uint8Array(this.data.buffer),_=4*this._idx(l,d);return this.unpack(g[_],g[_+1],g[_+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(l,d){if(l<-1||l>=this.dim+1||d<-1||d>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(d+1)*this.stride+(l+1)}unpack(l,d,g){return l*this.redFactor+d*this.greenFactor+g*this.blueFactor-this.baseShift}pack(l){return JD(l,this.getUnpackVector())}getPixels(){return new Ba({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(l,d,g){if(this.dim!==l.dim)throw new Error("dem dimension mismatch");let _=d*this.dim,C=d*this.dim+this.dim,A=g*this.dim,M=g*this.dim+this.dim;switch(d){case-1:_=C-1;break;case 1:C=_+1}switch(g){case-1:A=M-1;break;case 1:M=A+1}const L=-d*this.dim,q=-g*this.dim;for(let U=A;U<M;U++)for(let H=_;H<C;H++)this.data[this._idx(H,U)]=l.data[this._idx(H+L,U+q)]}}function JD(h,l){const d=l[0],g=l[1],_=l[2],C=l[3],A=Math.min(d,g,_),M=Math.round((h+C)/A);return{r:Math.floor(M*A/d)%256,g:Math.floor(M*A/g)%256,b:Math.floor(M*A/_)%256}}Kt("DEMData",QD);class UZ extends ko{constructor(l,d){super(l,VZ,d)}_createColorRamp(l){const d={elevationStops:[],colorStops:[]},g=this._transitionablePaint._values["color-relief-color"].value.expression;if(g instanceof If&&g._styleExpression.expression instanceof Mn){this.colorRampExpression=g;const A=g._styleExpression.expression;d.elevationStops=A.labels,d.colorStops=[];for(const M of d.elevationStops)d.colorStops.push(A.evaluate({globals:{elevation:M}}))}if(d.elevationStops.length<1&&(d.elevationStops=[0],d.colorStops=[Ur.transparent]),d.elevationStops.length<2&&(d.elevationStops.push(d.elevationStops[0]+1),d.colorStops.push(d.colorStops[0])),d.elevationStops.length<=l)return d;const _={elevationStops:[],colorStops:[]},C=(d.elevationStops.length-1)/(l-1);for(let A=0;A<d.elevationStops.length-.5;A+=C)_.elevationStops.push(d.elevationStops[Math.round(A)]),_.colorStops.push(d.colorStops[Math.round(A)]);return ar(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${l}, provided: ${d.elevationStops.length}`),_}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(l,d,g){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const _=this._createColorRamp(d),C=new Ba({width:_.colorStops.length,height:1}),A=new Ba({width:_.colorStops.length,height:1});for(let M=0;M<_.elevationStops.length;M++){const L=JD(_.elevationStops[M],g);A.setPixel(0,M,new Ur(L.r/255,L.g/255,L.b/255,1)),C.setPixel(0,M,_.colorStops[M])}return this.colorRampTextures={elevationTexture:new JP(l,A,l.gl.RGBA),colorTexture:new JP(l,C,l.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const WZ=Ms([{name:"a_pos",components:2,type:"Int16"}],4),{members:GZ}=WZ;function ow(h,l,d){const g=d.patternDependencies;let _=!1;for(const C of l){const A=C.paint.get(`${h}-pattern`);A.isConstant()||(_=!0);const M=A.constantOr(null);M&&(_=!0,g[M.to]=!0,g[M.from]=!0)}return _}function eC(h,l,d,g,_){const{zoom:C}=g,A=_.patternDependencies;for(const M of l){const L=M.paint.get(`${h}-pattern`).value;if(L.kind!=="constant"){let q=L.evaluate({zoom:C-1},d,{},_.availableImages),U=L.evaluate({zoom:C},d,{},_.availableImages),H=L.evaluate({zoom:C+1},d,{},_.availableImages);q=q&&q.name?q.name:q,U=U&&U.name?U.name:U,H=H&&H.name?H.name:H,A[q]=!0,A[U]=!0,A[H]=!0,d.patterns[M.id]={min:q,mid:U,max:H}}}return d}function eR(h,l,d,g,_){let C;if(_===function(A,M,L,q){let U=0;for(let H=M,Q=L-q;H<L;H+=q)U+=(A[Q]-A[H])*(A[H+1]+A[Q+1]),Q=H;return U}(h,l,d,g)>0)for(let A=l;A<d;A+=g)C=sR(A/g|0,h[A],h[A+1],C);else for(let A=d-g;A>=l;A-=g)C=sR(A/g|0,h[A],h[A+1],C);return C&&Yp(C,C.next)&&(Yv(C),C=C.next),C}function Gf(h,l){if(!h)return h;l||(l=h);let d,g=h;do if(d=!1,g.steiner||!Yp(g,g.next)&&Gs(g.prev,g,g.next)!==0)g=g.next;else{if(Yv(g),g=l=g.prev,g===g.next)break;d=!0}while(d||g!==l);return l}function Kv(h,l,d,g,_,C,A){if(!h)return;!A&&C&&function(L,q,U,H){let Q=L;do Q.z===0&&(Q.z=tC(Q.x,Q.y,q,U,H)),Q.prevZ=Q.prev,Q.nextZ=Q.next,Q=Q.next;while(Q!==L);Q.prevZ.nextZ=null,Q.prevZ=null,function(ee){let oe,fe=1;do{let be,Pe=ee;ee=null;let Qe=null;for(oe=0;Pe;){oe++;let De=Pe,ze=0;for(let ft=0;ft<fe&&(ze++,De=De.nextZ,De);ft++);let it=fe;for(;ze>0||it>0&&De;)ze!==0&&(it===0||!De||Pe.z<=De.z)?(be=Pe,Pe=Pe.nextZ,ze--):(be=De,De=De.nextZ,it--),Qe?Qe.nextZ=be:ee=be,be.prevZ=Qe,Qe=be;Pe=De}Qe.nextZ=null,fe*=2}while(oe>1)}(Q)}(h,g,_,C);let M=h;for(;h.prev!==h.next;){const L=h.prev,q=h.next;if(C?HZ(h,g,_,C):KZ(h))l.push(L.i,h.i,q.i),Yv(h),h=q.next,M=q.next;else if((h=q)===M){A?A===1?Kv(h=ZZ(Gf(h),l),l,d,g,_,C,2):A===2&&YZ(h,l,d,g,_,C):Kv(Gf(h),l,d,g,_,C,1);break}}}function KZ(h){const l=h.prev,d=h,g=h.next;if(Gs(l,d,g)>=0)return!1;const _=l.x,C=d.x,A=g.x,M=l.y,L=d.y,q=g.y,U=Math.min(_,C,A),H=Math.min(M,L,q),Q=Math.max(_,C,A),ee=Math.max(M,L,q);let oe=g.next;for(;oe!==l;){if(oe.x>=U&&oe.x<=Q&&oe.y>=H&&oe.y<=ee&&Hv(_,M,C,L,A,q,oe.x,oe.y)&&Gs(oe.prev,oe,oe.next)>=0)return!1;oe=oe.next}return!0}function HZ(h,l,d,g){const _=h.prev,C=h,A=h.next;if(Gs(_,C,A)>=0)return!1;const M=_.x,L=C.x,q=A.x,U=_.y,H=C.y,Q=A.y,ee=Math.min(M,L,q),oe=Math.min(U,H,Q),fe=Math.max(M,L,q),be=Math.max(U,H,Q),Pe=tC(ee,oe,l,d,g),Qe=tC(fe,be,l,d,g);let De=h.prevZ,ze=h.nextZ;for(;De&&De.z>=Pe&&ze&&ze.z<=Qe;){if(De.x>=ee&&De.x<=fe&&De.y>=oe&&De.y<=be&&De!==_&&De!==A&&Hv(M,U,L,H,q,Q,De.x,De.y)&&Gs(De.prev,De,De.next)>=0||(De=De.prevZ,ze.x>=ee&&ze.x<=fe&&ze.y>=oe&&ze.y<=be&&ze!==_&&ze!==A&&Hv(M,U,L,H,q,Q,ze.x,ze.y)&&Gs(ze.prev,ze,ze.next)>=0))return!1;ze=ze.nextZ}for(;De&&De.z>=Pe;){if(De.x>=ee&&De.x<=fe&&De.y>=oe&&De.y<=be&&De!==_&&De!==A&&Hv(M,U,L,H,q,Q,De.x,De.y)&&Gs(De.prev,De,De.next)>=0)return!1;De=De.prevZ}for(;ze&&ze.z<=Qe;){if(ze.x>=ee&&ze.x<=fe&&ze.y>=oe&&ze.y<=be&&ze!==_&&ze!==A&&Hv(M,U,L,H,q,Q,ze.x,ze.y)&&Gs(ze.prev,ze,ze.next)>=0)return!1;ze=ze.nextZ}return!0}function ZZ(h,l){let d=h;do{const g=d.prev,_=d.next.next;!Yp(g,_)&&rR(g,d,d.next,_)&&Zv(g,_)&&Zv(_,g)&&(l.push(g.i,d.i,_.i),Yv(d),Yv(d.next),d=h=_),d=d.next}while(d!==h);return Gf(d)}function YZ(h,l,d,g,_,C){let A=h;do{let M=A.next.next;for(;M!==A.prev;){if(A.i!==M.i&&tY(A,M)){let L=nR(A,M);return A=Gf(A,A.next),L=Gf(L,L.next),Kv(A,l,d,g,_,C,0),void Kv(L,l,d,g,_,C,0)}M=M.next}A=A.next}while(A!==h)}function XZ(h,l){let d=h.x-l.x;return d===0&&(d=h.y-l.y,d===0)&&(d=(h.next.y-h.y)/(h.next.x-h.x)-(l.next.y-l.y)/(l.next.x-l.x)),d}function QZ(h,l){const d=function(_,C){let A=C;const M=_.x,L=_.y;let q,U=-1/0;if(Yp(_,A))return A;do{if(Yp(_,A.next))return A.next;if(L<=A.y&&L>=A.next.y&&A.next.y!==A.y){const fe=A.x+(L-A.y)*(A.next.x-A.x)/(A.next.y-A.y);if(fe<=M&&fe>U&&(U=fe,q=A.x<A.next.x?A:A.next,fe===M))return q}A=A.next}while(A!==C);if(!q)return null;const H=q,Q=q.x,ee=q.y;let oe=1/0;A=q;do{if(M>=A.x&&A.x>=Q&&M!==A.x&&tR(L<ee?M:U,L,Q,ee,L<ee?U:M,L,A.x,A.y)){const fe=Math.abs(L-A.y)/(M-A.x);Zv(A,_)&&(fe<oe||fe===oe&&(A.x>q.x||A.x===q.x&&JZ(q,A)))&&(q=A,oe=fe)}A=A.next}while(A!==H);return q}(h,l);if(!d)return l;const g=nR(d,h);return Gf(g,g.next),Gf(d,d.next)}function JZ(h,l){return Gs(h.prev,h,l.prev)<0&&Gs(l.next,h,h.next)<0}function tC(h,l,d,g,_){return(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-d)*_|0)|h<<8))|h<<4))|h<<2))|h<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-g)*_|0)|l<<8))|l<<4))|l<<2))|l<<1))<<1}function eY(h){let l=h,d=h;do(l.x<d.x||l.x===d.x&&l.y<d.y)&&(d=l),l=l.next;while(l!==h);return d}function tR(h,l,d,g,_,C,A,M){return(_-A)*(l-M)>=(h-A)*(C-M)&&(h-A)*(g-M)>=(d-A)*(l-M)&&(d-A)*(C-M)>=(_-A)*(g-M)}function Hv(h,l,d,g,_,C,A,M){return!(h===A&&l===M)&&tR(h,l,d,g,_,C,A,M)}function tY(h,l){return h.next.i!==l.i&&h.prev.i!==l.i&&!function(d,g){let _=d;do{if(_.i!==d.i&&_.next.i!==d.i&&_.i!==g.i&&_.next.i!==g.i&&rR(_,_.next,d,g))return!0;_=_.next}while(_!==d);return!1}(h,l)&&(Zv(h,l)&&Zv(l,h)&&function(d,g){let _=d,C=!1;const A=(d.x+g.x)/2,M=(d.y+g.y)/2;do _.y>M!=_.next.y>M&&_.next.y!==_.y&&A<(_.next.x-_.x)*(M-_.y)/(_.next.y-_.y)+_.x&&(C=!C),_=_.next;while(_!==d);return C}(h,l)&&(Gs(h.prev,h,l.prev)||Gs(h,l.prev,l))||Yp(h,l)&&Gs(h.prev,h,h.next)>0&&Gs(l.prev,l,l.next)>0)}function Gs(h,l,d){return(l.y-h.y)*(d.x-l.x)-(l.x-h.x)*(d.y-l.y)}function Yp(h,l){return h.x===l.x&&h.y===l.y}function rR(h,l,d,g){const _=cw(Gs(h,l,d)),C=cw(Gs(h,l,g)),A=cw(Gs(d,g,h)),M=cw(Gs(d,g,l));return _!==C&&A!==M||!(_!==0||!lw(h,d,l))||!(C!==0||!lw(h,g,l))||!(A!==0||!lw(d,h,g))||!(M!==0||!lw(d,l,g))}function lw(h,l,d){return l.x<=Math.max(h.x,d.x)&&l.x>=Math.min(h.x,d.x)&&l.y<=Math.max(h.y,d.y)&&l.y>=Math.min(h.y,d.y)}function cw(h){return h>0?1:h<0?-1:0}function Zv(h,l){return Gs(h.prev,h,h.next)<0?Gs(h,l,h.next)>=0&&Gs(h,h.prev,l)>=0:Gs(h,l,h.prev)<0||Gs(h,h.next,l)<0}function nR(h,l){const d=rC(h.i,h.x,h.y),g=rC(l.i,l.x,l.y),_=h.next,C=l.prev;return h.next=l,l.prev=h,d.next=_,_.prev=d,g.next=d,d.prev=g,C.next=g,g.prev=C,g}function sR(h,l,d,g){const _=rC(h,l,d);return g?(_.next=g.next,_.prev=g,g.next.prev=_,g.next=_):(_.prev=_,_.next=_),_}function Yv(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function rC(h,l,d){return{i:h,x:l,y:d,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Xp{constructor(l,d){if(d>l)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=l,this._minGranularity=d}getGranularityForZoomLevel(l){return Math.max(Math.floor(this._baseZoomGranularity/(1<<l)),this._minGranularity,1)}}class uw{constructor(l){this.fill=l.fill,this.line=l.line,this.tile=l.tile,this.stencil=l.stencil,this.circle=l.circle}}uw.noSubdivision=new uw({fill:new Xp(0,0),line:new Xp(0,0),tile:new Xp(0,0),stencil:new Xp(0,0),circle:1}),Kt("SubdivisionGranularityExpression",Xp),Kt("SubdivisionGranularitySetting",uw);const Qp=-32768,Xv=32767;class rY{constructor(l,d){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=l,this._granularityCellSize=_e/l,this._canonical=d}_getKey(l,d){return(l+=32768)<<16|d+32768}_vertexToIndex(l,d){if(l<-32768||d<-32768||l>32767||d>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const g=0|Math.round(l),_=0|Math.round(d),C=this._getKey(g,_);if(this._vertexDictionary.has(C))return this._vertexDictionary.get(C);const A=this._vertexBuffer.length/2;return this._vertexDictionary.set(C,A),this._vertexBuffer.push(g,_),A}_subdivideTrianglesScanline(l){if(this._granularity<2)return function(_,C){const A=[];for(let M=0;M<C.length;M+=3){const L=C[M],q=C[M+1],U=C[M+2],H=_[2*L],Q=_[2*L+1];(_[2*q]-H)*(_[2*U+1]-Q)-(_[2*q+1]-Q)*(_[2*U]-H)>0?(A.push(L),A.push(U),A.push(q)):(A.push(L),A.push(q),A.push(U))}return A}(this._vertexBuffer,l);const d=[],g=l.length;for(let _=0;_<g;_+=3){const C=[l[_+0],l[_+1],l[_+2]],A=[this._vertexBuffer[2*l[_+0]+0],this._vertexBuffer[2*l[_+0]+1],this._vertexBuffer[2*l[_+1]+0],this._vertexBuffer[2*l[_+1]+1],this._vertexBuffer[2*l[_+2]+0],this._vertexBuffer[2*l[_+2]+1]];let M=1/0,L=1/0,q=-1/0,U=-1/0;for(let fe=0;fe<3;fe++){const be=A[2*fe],Pe=A[2*fe+1];M=Math.min(M,be),q=Math.max(q,be),L=Math.min(L,Pe),U=Math.max(U,Pe)}if(M===q||L===U)continue;const H=Math.floor(M/this._granularityCellSize),Q=Math.ceil(q/this._granularityCellSize),ee=Math.floor(L/this._granularityCellSize),oe=Math.ceil(U/this._granularityCellSize);if(H!==Q||ee!==oe)for(let fe=ee;fe<oe;fe++){const be=this._scanlineGenerateVertexRingForCellRow(fe,A,C);nY(this._vertexBuffer,be,d)}else d.push(...C)}return d}_scanlineGenerateVertexRingForCellRow(l,d,g){const _=l*this._granularityCellSize,C=_+this._granularityCellSize,A=[];for(let M=0;M<3;M++){const L=d[2*M],q=d[2*M+1],U=d[2*(M+1)%6],H=d[(2*(M+1)+1)%6],Q=d[2*(M+2)%6],ee=d[(2*(M+2)+1)%6],oe=U-L,fe=H-q,be=oe===0,Pe=fe===0,Qe=(_-q)/fe,De=(C-q)/fe,ze=Math.min(Qe,De),it=Math.max(Qe,De);if(!Pe&&(ze>=1||it<=0)||Pe&&(q<_||q>C)){H>=_&&H<=C&&A.push(g[(M+1)%3]);continue}!Pe&&ze>0&&A.push(this._vertexToIndex(L+oe*ze,q+fe*ze));const ft=L+oe*Math.max(ze,0),Ct=L+oe*Math.min(it,1);be||this._generateIntraEdgeVertices(A,L,q,U,H,ft,Ct),!Pe&&it<1&&A.push(this._vertexToIndex(L+oe*it,q+fe*it)),(Pe||H>=_&&H<=C)&&A.push(g[(M+1)%3]),!Pe&&(H<=_||H>=C)&&this._generateInterEdgeVertices(A,L,q,U,H,Q,ee,Ct,_,C)}return A}_generateIntraEdgeVertices(l,d,g,_,C,A,M){const L=_-d,q=C-g,U=q===0,H=U?Math.min(d,_):Math.min(A,M),Q=U?Math.max(d,_):Math.max(A,M),ee=Math.floor(H/this._granularityCellSize)+1,oe=Math.ceil(Q/this._granularityCellSize)-1;if(U?d<_:A<M)for(let fe=ee;fe<=oe;fe++){const be=fe*this._granularityCellSize;l.push(this._vertexToIndex(be,g+q*(be-d)/L))}else for(let fe=oe;fe>=ee;fe--){const be=fe*this._granularityCellSize;l.push(this._vertexToIndex(be,g+q*(be-d)/L))}}_generateInterEdgeVertices(l,d,g,_,C,A,M,L,q,U){const H=C-g,Q=A-_,ee=M-C,oe=(q-C)/ee,fe=(U-C)/ee,be=Math.min(oe,fe),Pe=Math.max(oe,fe),Qe=_+Q*be;let De=Math.floor(Math.min(Qe,L)/this._granularityCellSize)+1,ze=Math.ceil(Math.max(Qe,L)/this._granularityCellSize)-1,it=L<Qe;const ft=ee===0;if(ft&&(M===q||M===U))return;if(ft||be>=1||Pe<=0){const Vt=g-M,It=A+(d-A)*Math.min((q-M)/Vt,(U-M)/Vt);De=Math.floor(Math.min(It,L)/this._granularityCellSize)+1,ze=Math.ceil(Math.max(It,L)/this._granularityCellSize)-1,it=L<It}const Ct=H>0?U:q;if(it)for(let Vt=De;Vt<=ze;Vt++)l.push(this._vertexToIndex(Vt*this._granularityCellSize,Ct));else for(let Vt=ze;Vt>=De;Vt--)l.push(this._vertexToIndex(Vt*this._granularityCellSize,Ct))}_generateOutline(l){const d=[];for(const g of l){const _=Kf(g,this._granularity,!0),C=this._pointArrayToIndices(_),A=[];for(let M=1;M<C.length;M++)A.push(C[M-1]),A.push(C[M]);d.push(A)}return d}_handlePoles(l){let d=!1,g=!1;this._canonical&&(this._canonical.y===0&&(d=!0),this._canonical.y===(1<<this._canonical.z)-1&&(g=!0)),(d||g)&&this._fillPoles(l,d,g)}_ensureNoPoleVertices(){const l=this._vertexBuffer;for(let d=0;d<l.length;d+=2){const g=l[d+1];g===Qp&&(l[d+1]=-32767),g===Xv&&(l[d+1]=32766)}}_generatePoleQuad(l,d,g,_,C,A){_>C!=(A===Qp)?(l.push(d),l.push(g),l.push(this._vertexToIndex(_,A)),l.push(g),l.push(this._vertexToIndex(C,A)),l.push(this._vertexToIndex(_,A))):(l.push(g),l.push(d),l.push(this._vertexToIndex(_,A)),l.push(this._vertexToIndex(C,A)),l.push(g),l.push(this._vertexToIndex(_,A)))}_fillPoles(l,d,g){const _=this._vertexBuffer,C=_e,A=l.length;for(let M=2;M<A;M+=3){const L=l[M-2],q=l[M-1],U=l[M],H=_[2*L],Q=_[2*L+1],ee=_[2*q],oe=_[2*q+1],fe=_[2*U],be=_[2*U+1];d&&(Q===0&&oe===0&&this._generatePoleQuad(l,L,q,H,ee,Qp),oe===0&&be===0&&this._generatePoleQuad(l,q,U,ee,fe,Qp),be===0&&Q===0&&this._generatePoleQuad(l,U,L,fe,H,Qp)),g&&(Q===C&&oe===C&&this._generatePoleQuad(l,L,q,H,ee,Xv),oe===C&&be===C&&this._generatePoleQuad(l,q,U,ee,fe,Xv),be===C&&Q===C&&this._generatePoleQuad(l,U,L,fe,H,Xv))}}_initializeVertices(l){for(let d=0;d<l.length;d+=2)this._vertexToIndex(l[d],l[d+1])}subdividePolygonInternal(l,d){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:g,holeIndices:_}=function(M){const L=[],q=[];for(const U of M)if(U.length!==0){U!==M[0]&&L.push(q.length/2);for(let H=0;H<U.length;H++)q.push(U[H].x),q.push(U[H].y)}return{flattened:q,holeIndices:L}}(l);let C;this._initializeVertices(g);try{const M=function(q,U,H=2){const Q=U&&U.length,ee=Q?U[0]*H:q.length;let oe=eR(q,0,ee,H,!0);const fe=[];if(!oe||oe.next===oe.prev)return fe;let be,Pe,Qe;if(Q&&(oe=function(De,ze,it,ft){const Ct=[];for(let Vt=0,It=ze.length;Vt<It;Vt++){const $t=eR(De,ze[Vt]*ft,Vt<It-1?ze[Vt+1]*ft:De.length,ft,!1);$t===$t.next&&($t.steiner=!0),Ct.push(eY($t))}Ct.sort(XZ);for(let Vt=0;Vt<Ct.length;Vt++)it=QZ(Ct[Vt],it);return it}(q,U,oe,H)),q.length>80*H){be=q[0],Pe=q[1];let De=be,ze=Pe;for(let it=H;it<ee;it+=H){const ft=q[it],Ct=q[it+1];ft<be&&(be=ft),Ct<Pe&&(Pe=Ct),ft>De&&(De=ft),Ct>ze&&(ze=Ct)}Qe=Math.max(De-be,ze-Pe),Qe=Qe!==0?32767/Qe:0}return Kv(oe,fe,H,be,Pe,Qe,0),fe}(g,_),L=this._convertIndices(g,M);C=this._subdivideTrianglesScanline(L)}catch(M){console.error(M)}let A=[];return d&&(A=this._generateOutline(l)),this._ensureNoPoleVertices(),this._handlePoles(C),{verticesFlattened:this._vertexBuffer,indicesTriangles:C,indicesLineList:A}}_convertIndices(l,d){const g=[];for(let _=0;_<d.length;_++)g.push(this._vertexToIndex(l[2*d[_]],l[2*d[_]+1]));return g}_pointArrayToIndices(l){const d=[];for(let g=0;g<l.length;g++){const _=l[g];d.push(this._vertexToIndex(_.x,_.y))}return d}}function iR(h,l,d,g=!0){return new rY(d,l).subdividePolygonInternal(h,g)}function Kf(h,l,d=!1){if(!h||h.length<1)return[];if(h.length<2)return[];const g=h[0],_=h[h.length-1],C=d&&(g.x!==_.x||g.y!==_.y);if(l<2)return C?[...h,h[0]]:[...h];const A=Math.floor(_e/l),M=[];M.push(new m(h[0].x,h[0].y));const L=h.length,q=C?L:L-1;for(let U=0;U<q;U++){const H=h[U],Q=U<L-1?h[U+1]:h[0],ee=H.x,oe=H.y,fe=Q.x,be=Q.y,Pe=ee!==fe,Qe=oe!==be;if(!Pe&&!Qe)continue;const De=fe-ee,ze=be-oe,it=Math.abs(De),ft=Math.abs(ze);let Ct=ee,Vt=oe;for(;;){const $t=De>0?(Math.floor(Ct/A)+1)*A:(Math.ceil(Ct/A)-1)*A,vr=ze>0?(Math.floor(Vt/A)+1)*A:(Math.ceil(Vt/A)-1)*A,Ft=Math.abs(Ct-$t),Bt=Math.abs(Vt-vr),_t=Math.abs(Ct-fe),Fr=Math.abs(Vt-be),$r=Pe?Ft/it:Number.POSITIVE_INFINITY,Ar=Qe?Bt/ft:Number.POSITIVE_INFINITY;if((_t<=Ft||!Pe)&&(Fr<=Bt||!Qe))break;if($r<Ar&&Pe||!Qe){Ct=$t,Vt+=ze*$r;const dr=new m(Ct,Math.round(Vt));M[M.length-1].x===dr.x&&M[M.length-1].y===dr.y||M.push(dr)}else{Ct+=De*Ar,Vt=vr;const dr=new m(Math.round(Ct),Vt);M[M.length-1].x===dr.x&&M[M.length-1].y===dr.y||M.push(dr)}}const It=new m(fe,be);M[M.length-1].x===It.x&&M[M.length-1].y===It.y||M.push(It)}return M}function nY(h,l,d){if(l.length===0)throw new Error("Subdivision vertex ring is empty.");let g=0,_=h[2*l[0]];for(let L=1;L<l.length;L++){const q=h[2*l[L]];q<_&&(_=q,g=L)}const C=l.length;let A=g,M=(A+1)%C;for(;;){const L=A-1>=0?A-1:C-1,q=(M+1)%C,U=h[2*l[L]],H=h[2*l[q]],Q=h[2*l[A]],ee=h[2*l[A]+1],oe=h[2*l[M]+1];let fe=!1;if(U<H)fe=!0;else if(U>H)fe=!1;else{const be=oe-ee,Pe=-(h[2*l[M]]-Q),Qe=ee<oe?1:-1;((U-Q)*be+(h[2*l[L]+1]-ee)*Pe)*Qe>((H-Q)*be+(h[2*l[q]+1]-ee)*Pe)*Qe&&(fe=!0)}if(fe){const be=l[L],Pe=l[A],Qe=l[M];be!==Pe&&be!==Qe&&Pe!==Qe&&d.push(Qe,Pe,be),A--,A<0&&(A=C-1)}else{const be=l[q],Pe=l[A],Qe=l[M];be!==Pe&&be!==Qe&&Pe!==Qe&&d.push(Qe,Pe,be),M++,M>=C&&(M=0)}if(L===q)break}}function aR(h,l,d,g,_,C,A,M,L){const q=_.length/2,U=A&&M&&L;if(q<Hr.MAX_VERTEX_ARRAY_LENGTH){const H=l.prepareSegment(q,d,g),Q=H.vertexLength;for(let fe=0;fe<C.length;fe+=3)g.emplaceBack(Q+C[fe],Q+C[fe+1],Q+C[fe+2]);let ee,oe;H.vertexLength+=q,H.primitiveLength+=C.length/3,U&&(oe=A.prepareSegment(q,d,M),ee=oe.vertexLength,oe.vertexLength+=q);for(let fe=0;fe<_.length;fe+=2)h(_[fe],_[fe+1]);if(U)for(let fe=0;fe<L.length;fe++){const be=L[fe];for(let Pe=1;Pe<be.length;Pe+=2)M.emplaceBack(ee+be[Pe-1],ee+be[Pe]);oe.primitiveLength+=be.length/2}}else(function(H,Q,ee,oe,fe,be){const Pe=[];for(let ft=0;ft<oe.length/2;ft++)Pe.push(-1);const Qe={count:0};let De=0,ze=H.getOrCreateLatestSegment(Q,ee),it=ze.vertexLength;for(let ft=2;ft<fe.length;ft+=3){const Ct=fe[ft-2],Vt=fe[ft-1],It=fe[ft];let $t=Pe[Ct]<De,vr=Pe[Vt]<De,Ft=Pe[It]<De;ze.vertexLength+(($t?1:0)+(vr?1:0)+(Ft?1:0))>Hr.MAX_VERTEX_ARRAY_LENGTH&&(ze=H.createNewSegment(Q,ee),De=Qe.count,$t=!0,vr=!0,Ft=!0,it=0);const Bt=Qv(Pe,oe,be,Qe,Ct,$t,ze),_t=Qv(Pe,oe,be,Qe,Vt,vr,ze),Fr=Qv(Pe,oe,be,Qe,It,Ft,ze);ee.emplaceBack(it+Bt-De,it+_t-De,it+Fr-De),ze.primitiveLength++}})(l,d,g,_,C,h),U&&function(H,Q,ee,oe,fe,be){const Pe=[];for(let ft=0;ft<oe.length/2;ft++)Pe.push(-1);const Qe={count:0};let De=0,ze=H.getOrCreateLatestSegment(Q,ee),it=ze.vertexLength;for(let ft=0;ft<fe.length;ft++){const Ct=fe[ft];for(let Vt=1;Vt<fe[ft].length;Vt+=2){const It=Ct[Vt-1],$t=Ct[Vt];let vr=Pe[It]<De,Ft=Pe[$t]<De;ze.vertexLength+((vr?1:0)+(Ft?1:0))>Hr.MAX_VERTEX_ARRAY_LENGTH&&(ze=H.createNewSegment(Q,ee),De=Qe.count,vr=!0,Ft=!0,it=0);const Bt=Qv(Pe,oe,be,Qe,It,vr,ze),_t=Qv(Pe,oe,be,Qe,$t,Ft,ze);ee.emplaceBack(it+Bt-De,it+_t-De),ze.primitiveLength++}}}(A,d,M,_,L,h),l.forceNewSegmentOnNextPrepare(),A==null||A.forceNewSegmentOnNextPrepare()}function Qv(h,l,d,g,_,C,A){if(C){const M=g.count;return d(l[2*_],l[2*_+1]),h[_]=g.count,g.count++,A.vertexLength++,M}return h[_]}class nC{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(d=>d.id),this.index=l.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new Te,this.indexArray=new bt,this.indexArray2=new rr,this.programConfigurations=new Eu(l.layers,l.zoom),this.segments=new Hr,this.segments2=new Hr,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(l,d,g){this.hasDependencies=ow("fill",this.layers,d);const _=this.layers[0].layout.get("fill-sort-key"),C=!_.isConstant(),A=[];for(const{feature:M,id:L,index:q,sourceLayerIndex:U}of l){const H=this.layers[0]._featureFilter.needGeometry,Q=Ec(M,H);if(!this.layers[0]._featureFilter.filter(new Bn(this.zoom),Q,g))continue;const ee=C?_.evaluate(Q,{},g,d.availableImages):void 0,oe={id:L,properties:M.properties,type:M.type,sourceLayerIndex:U,index:q,geometry:H?Q.geometry:Ul(M),patterns:{},sortKey:ee};A.push(oe)}C&&A.sort((M,L)=>M.sortKey-L.sortKey);for(const M of A){const{geometry:L,index:q,sourceLayerIndex:U}=M;if(this.hasDependencies){const H=eC("fill",this.layers,M,{zoom:this.zoom},d);this.patternFeatures.push(H)}else this.addFeature(M,L,q,g,{},d.subdivisionGranularity);d.featureIndex.insert(l[q].feature,L,q,U,this.index)}}update(l,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,d,this.stateDependentLayers,{imagePositions:g})}addFeatures(l,d,g){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,d,g,l.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,GZ),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.indexBuffer2=l.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(l,d,g,_,C,A){for(const M of yp(d,500)){const L=iR(M,_,A.fill.getGranularityForZoomLevel(_.z)),q=this.layoutVertexArray;aR((U,H)=>{q.emplaceBack(U,H)},this.segments,this.layoutVertexArray,this.indexArray,L.verticesFlattened,L.indicesTriangles,this.segments2,this.indexArray2,L.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,g,{imagePositions:C,canonical:_})}}let oR,lR;Kt("FillBucket",nC,{omit:["layers","patternFeatures"]});var sY={get paint(){return lR=lR||new Xi({"fill-antialias":new fr(Je.paint_fill["fill-antialias"]),"fill-opacity":new Tr(Je.paint_fill["fill-opacity"]),"fill-color":new Tr(Je.paint_fill["fill-color"]),"fill-outline-color":new Tr(Je.paint_fill["fill-outline-color"]),"fill-translate":new fr(Je.paint_fill["fill-translate"]),"fill-translate-anchor":new fr(Je.paint_fill["fill-translate-anchor"]),"fill-pattern":new qf(Je.paint_fill["fill-pattern"])})},get layout(){return oR=oR||new Xi({"fill-sort-key":new Tr(Je.layout_fill["fill-sort-key"])})}};class iY extends ko{constructor(l,d){super(l,sY,d)}recalculate(l,d){super.recalculate(l,d);const g=this.paint._values["fill-outline-color"];g.value.kind==="constant"&&g.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new nC(l)}queryRadius(){return iw(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:l,geometry:d,transform:g,pixelsToTileUnits:_}){return $D(aw(l,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-g.bearingInRadians,_),d)}isTileClipped(){return!0}}const aY=Ms([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),oY=Ms([{name:"a_centroid",components:2,type:"Int16"}],4),{members:lY}=aY;class Jp{constructor(l,d,g,_,C){this.properties={},this.extent=g,this.type=0,this.id=void 0,this._pbf=l,this._geometry=-1,this._keys=_,this._values=C,l.readFields(cY,this,d)}loadGeometry(){const l=this._pbf;l.pos=this._geometry;const d=l.readVarint()+l.pos,g=[];let _,C=1,A=0,M=0,L=0;for(;l.pos<d;){if(A<=0){const q=l.readVarint();C=7&q,A=q>>3}if(A--,C===1||C===2)M+=l.readSVarint(),L+=l.readSVarint(),C===1&&(_&&g.push(_),_=[]),_&&_.push(new m(M,L));else{if(C!==7)throw new Error(`unknown command ${C}`);_&&_.push(_[0].clone())}}return _&&g.push(_),g}bbox(){const l=this._pbf;l.pos=this._geometry;const d=l.readVarint()+l.pos;let g=1,_=0,C=0,A=0,M=1/0,L=-1/0,q=1/0,U=-1/0;for(;l.pos<d;){if(_<=0){const H=l.readVarint();g=7&H,_=H>>3}if(_--,g===1||g===2)C+=l.readSVarint(),A+=l.readSVarint(),C<M&&(M=C),C>L&&(L=C),A<q&&(q=A),A>U&&(U=A);else if(g!==7)throw new Error(`unknown command ${g}`)}return[M,q,L,U]}toGeoJSON(l,d,g){const _=this.extent*Math.pow(2,g),C=this.extent*l,A=this.extent*d,M=this.loadGeometry();function L(Q){return[360*(Q.x+C)/_-180,360/Math.PI*Math.atan(Math.exp((1-2*(Q.y+A)/_)*Math.PI))-90]}function q(Q){return Q.map(L)}let U;if(this.type===1){const Q=[];for(const oe of M)Q.push(oe[0]);const ee=q(Q);U=Q.length===1?{type:"Point",coordinates:ee[0]}:{type:"MultiPoint",coordinates:ee}}else if(this.type===2){const Q=M.map(q);U=Q.length===1?{type:"LineString",coordinates:Q[0]}:{type:"MultiLineString",coordinates:Q}}else{if(this.type!==3)throw new Error("unknown feature type");{const Q=function(oe){const fe=oe.length;if(fe<=1)return[oe];const be=[];let Pe,Qe;for(let De=0;De<fe;De++){const ze=uY(oe[De]);ze!==0&&(Qe===void 0&&(Qe=ze<0),Qe===ze<0?(Pe&&be.push(Pe),Pe=[oe[De]]):Pe&&Pe.push(oe[De]))}return Pe&&be.push(Pe),be}(M),ee=[];for(const oe of Q)ee.push(oe.map(q));U=ee.length===1?{type:"Polygon",coordinates:ee[0]}:{type:"MultiPolygon",coordinates:ee}}}const H={type:"Feature",geometry:U,properties:this.properties};return this.id!=null&&(H.id=this.id),H}}function cY(h,l,d){h===1?l.id=d.readVarint():h===2?function(g,_){const C=g.readVarint()+g.pos;for(;g.pos<C;){const A=_._keys[g.readVarint()],M=_._values[g.readVarint()];_.properties[A]=M}}(d,l):h===3?l.type=d.readVarint():h===4&&(l._geometry=d.pos)}function uY(h){let l=0;for(let d,g,_=0,C=h.length,A=C-1;_<C;A=_++)d=h[_],g=h[A],l+=(g.x-d.x)*(d.y+g.y);return l}Jp.types=["Unknown","Point","LineString","Polygon"];class cR{constructor(l,d){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(dY,this,d),this.length=this._features.length}feature(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];const d=this._pbf.readVarint()+this._pbf.pos;return new Jp(this._pbf,d,this.extent,this._keys,this._values)}}function dY(h,l,d){h===15?l.version=d.readVarint():h===1?l.name=d.readString():h===5?l.extent=d.readVarint():h===2?l._features.push(d.pos):h===3?l._keys.push(d.readString()):h===4&&l._values.push(function(g){let _=null;const C=g.readVarint()+g.pos;for(;g.pos<C;){const A=g.readVarint()>>3;_=A===1?g.readString():A===2?g.readFloat():A===3?g.readDouble():A===4?g.readVarint64():A===5?g.readVarint():A===6?g.readSVarint():A===7?g.readBoolean():null}if(_==null)throw new Error("unknown feature value");return _}(d))}class uR{constructor(l,d){this.layers=l.readFields(hY,{},d)}}function hY(h,l,d){if(h===3){const g=new cR(d,d.readVarint()+d.pos);g.length&&(l[g.name]=g)}}const sC=Math.pow(2,13);function Jv(h,l,d,g,_,C,A,M){h.emplaceBack(l,d,2*Math.floor(g*sC)+A,_*sC*2,C*sC*2,Math.round(M))}class iC{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(d=>d.id),this.index=l.index,this.hasDependencies=!1,this.layoutVertexArray=new Le,this.centroidVertexArray=new Ee,this.indexArray=new bt,this.programConfigurations=new Eu(l.layers,l.zoom),this.segments=new Hr,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(l,d,g){this.features=[],this.hasDependencies=ow("fill-extrusion",this.layers,d);for(const{feature:_,id:C,index:A,sourceLayerIndex:M}of l){const L=this.layers[0]._featureFilter.needGeometry,q=Ec(_,L);if(!this.layers[0]._featureFilter.filter(new Bn(this.zoom),q,g))continue;const U={id:C,sourceLayerIndex:M,index:A,geometry:L?q.geometry:Ul(_),properties:_.properties,type:_.type,patterns:{}};this.hasDependencies?this.features.push(eC("fill-extrusion",this.layers,U,{zoom:this.zoom},d)):this.addFeature(U,U.geometry,A,g,{},d.subdivisionGranularity),d.featureIndex.insert(_,U.geometry,A,M,this.index,!0)}}addFeatures(l,d,g){for(const _ of this.features){const{geometry:C}=_;this.addFeature(_,C,_.index,d,g,l.subdivisionGranularity)}}update(l,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,d,this.stateDependentLayers,{imagePositions:g})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,lY),this.centroidVertexBuffer=l.createVertexBuffer(this.centroidVertexArray,oY.members,!0),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(l,d,g,_,C,A){for(const M of yp(d,500)){const L={x:0,y:0,sampleCount:0},q=this.layoutVertexArray.length;this.processPolygon(L,_,l,M,A);const U=this.layoutVertexArray.length-q,H=Math.floor(L.x/L.sampleCount),Q=Math.floor(L.y/L.sampleCount);for(let ee=0;ee<U;ee++)this.centroidVertexArray.emplaceBack(H,Q)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,g,{imagePositions:C,canonical:_})}processPolygon(l,d,g,_,C){if(_.length<1||dR(_[0]))return;for(const H of _)H.length!==0&&fY(l,H);const A={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},M=C.fill.getGranularityForZoomLevel(d.z),L=Jp.types[g.type]==="Polygon";for(const H of _){if(H.length===0||dR(H))continue;const Q=Kf(H,M,L);this._generateSideFaces(Q,A)}if(!L)return;const q=iR(_,d,M,!1),U=this.layoutVertexArray;aR((H,Q)=>{Jv(U,H,Q,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,q.verticesFlattened,q.indicesTriangles)}_generateSideFaces(l,d){let g=0;for(let _=1;_<l.length;_++){const C=l[_],A=l[_-1];if(mY(C,A))continue;d.segment.vertexLength+4>Hr.MAX_VERTEX_ARRAY_LENGTH&&(d.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const M=C.sub(A)._perp()._unit(),L=A.dist(C);g+L>32768&&(g=0),Jv(this.layoutVertexArray,C.x,C.y,M.x,M.y,0,0,g),Jv(this.layoutVertexArray,C.x,C.y,M.x,M.y,0,1,g),g+=L,Jv(this.layoutVertexArray,A.x,A.y,M.x,M.y,0,0,g),Jv(this.layoutVertexArray,A.x,A.y,M.x,M.y,0,1,g);const q=d.segment.vertexLength;this.indexArray.emplaceBack(q,q+2,q+1),this.indexArray.emplaceBack(q+1,q+2,q+3),d.segment.vertexLength+=4,d.segment.primitiveLength+=2}}}function fY(h,l){for(let d=0;d<l.length;d++){const g=l[d];d===l.length-1&&l[0].x===g.x&&l[0].y===g.y||(h.x+=g.x,h.y+=g.y,h.sampleCount++)}}function mY(h,l){return h.x===l.x&&(h.x<0||h.x>_e)||h.y===l.y&&(h.y<0||h.y>_e)}function dR(h){return h.every(l=>l.x<0)||h.every(l=>l.x>_e)||h.every(l=>l.y<0)||h.every(l=>l.y>_e)}let hR;Kt("FillExtrusionBucket",iC,{omit:["layers","features"]});var pY={get paint(){return hR=hR||new Xi({"fill-extrusion-opacity":new fr(Je["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Tr(Je["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new fr(Je["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new fr(Je["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new qf(Je["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Tr(Je["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Tr(Je["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new fr(Je["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class gY extends ko{constructor(l,d){super(l,pY,d)}createBucket(l){return new iC(l)}queryRadius(){return iw(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:l,feature:d,featureState:g,geometry:_,transform:C,pixelsToTileUnits:A,pixelPosMatrix:M}){const L=aw(l,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-C.bearingInRadians,A),q=this.paint.get("fill-extrusion-height").evaluate(d,g),U=this.paint.get("fill-extrusion-base").evaluate(d,g),H=function(ee,oe){const fe=[];for(const be of ee){const Pe=[be.x,be.y,0,1];Me(Pe,Pe,oe),fe.push(new m(Pe[0]/Pe[3],Pe[1]/Pe[3]))}return fe}(L,M),Q=function(ee,oe,fe,be){const Pe=[],Qe=[],De=be[8]*oe,ze=be[9]*oe,it=be[10]*oe,ft=be[11]*oe,Ct=be[8]*fe,Vt=be[9]*fe,It=be[10]*fe,$t=be[11]*fe;for(const vr of ee){const Ft=[],Bt=[];for(const _t of vr){const Fr=_t.x,$r=_t.y,Ar=be[0]*Fr+be[4]*$r+be[12],dr=be[1]*Fr+be[5]*$r+be[13],dn=be[2]*Fr+be[6]*$r+be[14],_s=be[3]*Fr+be[7]*$r+be[15],di=dn+it,Ji=_s+ft,Mo=Ar+Ct,qa=dr+Vt,Ri=dn+It,hs=_s+$t,vi=new m((Ar+De)/Ji,(dr+ze)/Ji);vi.z=di/Ji,Ft.push(vi);const Li=new m(Mo/hs,qa/hs);Li.z=Ri/hs,Bt.push(Li)}Pe.push(Ft),Qe.push(Bt)}return[Pe,Qe]}(_,U,q,M);return function(ee,oe,fe){let be=1/0;$D(fe,oe)&&(be=fR(fe,oe[0]));for(let Pe=0;Pe<oe.length;Pe++){const Qe=oe[Pe],De=ee[Pe];for(let ze=0;ze<Qe.length-1;ze++){const it=Qe[ze],ft=[it,Qe[ze+1],De[ze+1],De[ze],it];zD(fe,ft)&&(be=Math.min(be,fR(fe,ft)))}}return be!==1/0&&be}(Q[0],Q[1],H)}}function e_(h,l){return h.x*l.x+h.y*l.y}function fR(h,l){if(h.length===1){let d=0;const g=l[d++];let _;for(;!_||g.equals(_);)if(_=l[d++],!_)return 1/0;for(;d<l.length;d++){const C=l[d],A=h[0],M=_.sub(g),L=C.sub(g),q=A.sub(g),U=e_(M,M),H=e_(M,L),Q=e_(L,L),ee=e_(q,M),oe=e_(q,L),fe=U*Q-H*H,be=(Q*ee-H*oe)/fe,Pe=(U*oe-H*ee)/fe,Qe=g.z*(1-be-Pe)+_.z*be+C.z*Pe;if(isFinite(Qe))return Qe}return 1/0}{let d=1/0;for(const g of l)d=Math.min(d,g.z);return d}}const xY=Ms([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:yY}=xY,vY=Ms([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:_Y}=vY,bY=Math.cos(Math.PI/180*37.5),mR=Math.pow(2,14)/.5;class aC{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(d=>d.id),this.index=l.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(d=>{this.gradients[d.id]={}}),this.layoutVertexArray=new $e,this.layoutVertexArray2=new Ie,this.indexArray=new bt,this.programConfigurations=new Eu(l.layers,l.zoom),this.segments=new Hr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(l,d,g){this.hasDependencies=ow("line",this.layers,d)||this.hasLineDasharray(this.layers);const _=this.layers[0].layout.get("line-sort-key"),C=!_.isConstant(),A=[];for(const{feature:M,id:L,index:q,sourceLayerIndex:U}of l){const H=this.layers[0]._featureFilter.needGeometry,Q=Ec(M,H);if(!this.layers[0]._featureFilter.filter(new Bn(this.zoom),Q,g))continue;const ee=C?_.evaluate(Q,{},g):void 0,oe={id:L,properties:M.properties,type:M.type,sourceLayerIndex:U,index:q,geometry:H?Q.geometry:Ul(M),patterns:{},dashes:{},sortKey:ee};A.push(oe)}C&&A.sort((M,L)=>M.sortKey-L.sortKey);for(const M of A){const{geometry:L,index:q,sourceLayerIndex:U}=M;this.hasDependencies?(ow("line",this.layers,d)?eC("line",this.layers,M,{zoom:this.zoom},d):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,M,this.zoom,d),this.patternFeatures.push(M)):this.addFeature(M,L,q,g,{},{},d.subdivisionGranularity),d.featureIndex.insert(l[q].feature,L,q,U,this.index)}}update(l,d,g,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,d,this.stateDependentLayers,{imagePositions:g,dashPositions:_})}addFeatures(l,d,g,_){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,d,g,_,l.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=l.createVertexBuffer(this.layoutVertexArray2,_Y)),this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,yY),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(l){if(l.properties&&Object.prototype.hasOwnProperty.call(l.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(l.properties,"mapbox_clip_end"))return{start:+l.properties.mapbox_clip_start,end:+l.properties.mapbox_clip_end}}addFeature(l,d,g,_,C,A,M){const L=this.layers[0].layout,q=L.get("line-join").evaluate(l,{}),U=L.get("line-cap"),H=L.get("line-miter-limit"),Q=L.get("line-round-limit");this.lineClips=this.lineFeatureClips(l);for(const ee of d)this.addLine(ee,l,q,U,H,Q,_,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,g,{imagePositions:C,dashPositions:A,canonical:_})}addLine(l,d,g,_,C,A,M,L){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,l=Kf(l,M?L.line.getGranularityForZoomLevel(M.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let De=0;De<l.length-1;De++)this.totalDistance+=l[De].dist(l[De+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const q=Jp.types[d.type]==="Polygon";let U=l.length;for(;U>=2&&l[U-1].equals(l[U-2]);)U--;let H=0;for(;H<U-1&&l[H].equals(l[H+1]);)H++;if(U<(q?3:2))return;g==="bevel"&&(C=1.05);const Q=this.overscaling<=16?122880/(512*this.overscaling):0,ee=this.segments.prepareSegment(10*U,this.layoutVertexArray,this.indexArray);let oe,fe,be,Pe,Qe;this.e1=this.e2=-1,q&&(oe=l[U-2],Qe=l[H].sub(oe)._unit()._perp());for(let De=H;De<U;De++){if(be=De===U-1?q?l[H+1]:void 0:l[De+1],be&&l[De].equals(be))continue;Qe&&(Pe=Qe),oe&&(fe=oe),oe=l[De],Qe=be?be.sub(oe)._unit()._perp():Pe,Pe=Pe||Qe;let ze=Pe.add(Qe);ze.x===0&&ze.y===0||ze._unit();const it=Pe.x*Qe.x+Pe.y*Qe.y,ft=ze.x*Qe.x+ze.y*Qe.y,Ct=ft!==0?1/ft:1/0,Vt=2*Math.sqrt(2-2*ft),It=ft<bY&&fe&&be,$t=Pe.x*Qe.y-Pe.y*Qe.x>0;if(It&&De>H){const Bt=oe.dist(fe);if(Bt>2*Q){const _t=oe.sub(oe.sub(fe)._mult(Q/Bt)._round());this.updateDistance(fe,_t),this.addCurrentVertex(_t,Pe,0,0,ee),fe=_t}}const vr=fe&&be;let Ft=vr?g:q?"butt":_;if(vr&&Ft==="round"&&(Ct<A?Ft="miter":Ct<=2&&(Ft="fakeround")),Ft==="miter"&&Ct>C&&(Ft="bevel"),Ft==="bevel"&&(Ct>2&&(Ft="flipbevel"),Ct<C&&(Ft="miter")),fe&&this.updateDistance(fe,oe),Ft==="miter")ze._mult(Ct),this.addCurrentVertex(oe,ze,0,0,ee);else if(Ft==="flipbevel"){if(Ct>100)ze=Qe.mult(-1);else{const Bt=Ct*Pe.add(Qe).mag()/Pe.sub(Qe).mag();ze._perp()._mult(Bt*($t?-1:1))}this.addCurrentVertex(oe,ze,0,0,ee),this.addCurrentVertex(oe,ze.mult(-1),0,0,ee)}else if(Ft==="bevel"||Ft==="fakeround"){const Bt=-Math.sqrt(Ct*Ct-1),_t=$t?Bt:0,Fr=$t?0:Bt;if(fe&&this.addCurrentVertex(oe,Pe,_t,Fr,ee),Ft==="fakeround"){const $r=Math.round(180*Vt/Math.PI/20);for(let Ar=1;Ar<$r;Ar++){let dr=Ar/$r;if(dr!==.5){const _s=dr-.5;dr+=dr*_s*(dr-1)*((1.0904+it*(it*(3.55645-1.43519*it)-3.2452))*_s*_s+(.848013+it*(.215638*it-1.06021)))}const dn=Qe.sub(Pe)._mult(dr)._add(Pe)._unit()._mult($t?-1:1);this.addHalfVertex(oe,dn.x,dn.y,!1,$t,0,ee)}}be&&this.addCurrentVertex(oe,Qe,-_t,-Fr,ee)}else if(Ft==="butt")this.addCurrentVertex(oe,ze,0,0,ee);else if(Ft==="square"){const Bt=fe?1:-1;this.addCurrentVertex(oe,ze,Bt,Bt,ee)}else Ft==="round"&&(fe&&(this.addCurrentVertex(oe,Pe,0,0,ee),this.addCurrentVertex(oe,Pe,1,1,ee,!0)),be&&(this.addCurrentVertex(oe,Qe,-1,-1,ee,!0),this.addCurrentVertex(oe,Qe,0,0,ee)));if(It&&De<U-1){const Bt=oe.dist(be);if(Bt>2*Q){const _t=oe.add(be.sub(oe)._mult(Q/Bt)._round());this.updateDistance(oe,_t),this.addCurrentVertex(_t,Qe,0,0,ee),oe=_t}}}}addCurrentVertex(l,d,g,_,C,A=!1){const M=d.y*_-d.x,L=-d.y-d.x*_;this.addHalfVertex(l,d.x+d.y*g,d.y-d.x*g,A,!1,g,C),this.addHalfVertex(l,M,L,A,!0,-_,C),this.distance>mR/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(l,d,g,_,C,A))}addHalfVertex({x:l,y:d},g,_,C,A,M,L){const q=.5*(this.lineClips?this.scaledDistance*(mR-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((l<<1)+(C?1:0),(d<<1)+(A?1:0),Math.round(63*g)+128,Math.round(63*_)+128,1+(M===0?0:M<0?-1:1)|(63&q)<<2,q>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const U=L.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,U,this.e2),L.primitiveLength++),A?this.e2=U:this.e1=U}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(l,d){this.distance+=l.dist(d),this.updateScaledDistance()}hasLineDasharray(l){for(const d of l){const g=d.paint.get("line-dasharray");if(g&&!g.isConstant())return!0}return!1}addLineDashDependencies(l,d,g,_){for(const C of l){const A=C.paint.get("line-dasharray");if(!A||A.value.kind==="constant")continue;const M=C.layout.get("line-cap")==="round",L={dasharray:A.value.evaluate({zoom:g-1},d,{}),round:M},q={dasharray:A.value.evaluate({zoom:g},d,{}),round:M},U={dasharray:A.value.evaluate({zoom:g+1},d,{}),round:M},H=`${L.dasharray.join(",")},${L.round}`,Q=`${q.dasharray.join(",")},${q.round}`,ee=`${U.dasharray.join(",")},${U.round}`;_.dashDependencies[H]=L,_.dashDependencies[Q]=q,_.dashDependencies[ee]=U,d.dashes[C.id]={min:H,mid:Q,max:ee}}}}let pR,gR;Kt("LineBucket",aC,{omit:["layers","patternFeatures"]});var xR={get paint(){return gR=gR||new Xi({"line-opacity":new Tr(Je.paint_line["line-opacity"]),"line-color":new Tr(Je.paint_line["line-color"]),"line-translate":new fr(Je.paint_line["line-translate"]),"line-translate-anchor":new fr(Je.paint_line["line-translate-anchor"]),"line-width":new Tr(Je.paint_line["line-width"]),"line-gap-width":new Tr(Je.paint_line["line-gap-width"]),"line-offset":new Tr(Je.paint_line["line-offset"]),"line-blur":new Tr(Je.paint_line["line-blur"]),"line-dasharray":new qf(Je.paint_line["line-dasharray"]),"line-pattern":new qf(Je.paint_line["line-pattern"]),"line-gradient":new Vf(Je.paint_line["line-gradient"])})},get layout(){return pR=pR||new Xi({"line-cap":new fr(Je.layout_line["line-cap"]),"line-join":new Tr(Je.layout_line["line-join"]),"line-miter-limit":new fr(Je.layout_line["line-miter-limit"]),"line-round-limit":new fr(Je.layout_line["line-round-limit"]),"line-sort-key":new Tr(Je.layout_line["line-sort-key"])})}};class jY extends Tr{possiblyEvaluate(l,d){return d=new Bn(Math.floor(d.zoom),{now:d.now,fadeDuration:d.fadeDuration,zoomHistory:d.zoomHistory,transition:d.transition}),super.possiblyEvaluate(l,d)}evaluate(l,d,g,_){return d=yr({},d,{zoom:Math.floor(d.zoom)}),super.evaluate(l,d,g,_)}}let dw;class wY extends ko{constructor(l,d){super(l,xR,d),this.gradientVersion=0,dw||(dw=new jY(xR.paint.properties["line-width"].specification),dw.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const d=this.gradientExpression();this.stepInterpolant=!!function(g){return g._styleExpression!==void 0}(d)&&d._styleExpression.expression instanceof Rd,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(l,d){super.recalculate(l,d),this.paint._values["line-floorwidth"]=dw.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new aC(l)}queryRadius(l){const d=l,g=yR(Zp("line-width",this,d),Zp("line-gap-width",this,d)),_=Zp("line-offset",this,d);return g/2+Math.abs(_)+iw(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:l,feature:d,featureState:g,geometry:_,transform:C,pixelsToTileUnits:A}){const M=aw(l,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-C.bearingInRadians,A),L=A/2*yR(this.paint.get("line-width").evaluate(d,g),this.paint.get("line-gap-width").evaluate(d,g)),q=this.paint.get("line-offset").evaluate(d,g);return q&&(_=function(U,H){const Q=[];for(let ee=0;ee<U.length;ee++){const oe=U[ee],fe=[];for(let be=0;be<oe.length;be++){const Pe=oe[be-1],Qe=oe[be],De=oe[be+1],ze=be===0?new m(0,0):Qe.sub(Pe)._unit()._perp(),it=be===oe.length-1?new m(0,0):De.sub(Qe)._unit()._perp(),ft=ze._add(it)._unit(),Ct=ft.x*it.x+ft.y*it.y;Ct!==0&&ft._mult(1/Ct),fe.push(ft._mult(H)._add(Qe))}Q.push(fe)}return Q}(_,q*A)),function(U,H,Q){for(let ee=0;ee<H.length;ee++){const oe=H[ee];if(U.length>=3){for(let fe=0;fe<oe.length;fe++)if(Hp(U,oe[fe]))return!0}if(TZ(U,oe,Q))return!0}return!1}(M,_,L)}isTileClipped(){return!0}}function yR(h,l){return l>0?l+2*h:h}const SY=Ms([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),NY=Ms([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ms([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const PY=Ms([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Ms([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const vR=Ms([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),CY=Ms([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function AY(h,l,d){return h.sections.forEach(g=>{g.text=function(_,C,A){const M=C.layout.get("text-transform").evaluate(A,{});return M==="uppercase"?_=_.toLocaleUpperCase():M==="lowercase"&&(_=_.toLocaleLowerCase()),$l.applyArabicShaping&&(_=$l.applyArabicShaping(_)),_}(g.text,l,d)}),h}Ms([{name:"triangle",components:3,type:"Uint16"}]),Ms([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ms([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Ms([{type:"Float32",name:"offsetX"}]),Ms([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Ms([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const t_={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var yi=24;const oC=4294967296,_R=1/oC,bR=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class lC{constructor(l=new Uint8Array(16)){this.buf=ArrayBuffer.isView(l)?l:new Uint8Array(l),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(l,d,g=this.length){for(;this.pos<g;){const _=this.readVarint(),C=_>>3,A=this.pos;this.type=7&_,l(C,d,this),this.pos===A&&this.skip(_)}return d}readMessage(l,d){return this.readFields(l,d,this.readVarint()+this.pos)}readFixed32(){const l=this.dataView.getUint32(this.pos,!0);return this.pos+=4,l}readSFixed32(){const l=this.dataView.getInt32(this.pos,!0);return this.pos+=4,l}readFixed64(){const l=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*oC;return this.pos+=8,l}readSFixed64(){const l=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*oC;return this.pos+=8,l}readFloat(){const l=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,l}readDouble(){const l=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,l}readVarint(l){const d=this.buf;let g,_;return _=d[this.pos++],g=127&_,_<128?g:(_=d[this.pos++],g|=(127&_)<<7,_<128?g:(_=d[this.pos++],g|=(127&_)<<14,_<128?g:(_=d[this.pos++],g|=(127&_)<<21,_<128?g:(_=d[this.pos],g|=(15&_)<<28,function(C,A,M){const L=M.buf;let q,U;if(U=L[M.pos++],q=(112&U)>>4,U<128||(U=L[M.pos++],q|=(127&U)<<3,U<128)||(U=L[M.pos++],q|=(127&U)<<10,U<128)||(U=L[M.pos++],q|=(127&U)<<17,U<128)||(U=L[M.pos++],q|=(127&U)<<24,U<128)||(U=L[M.pos++],q|=(1&U)<<31,U<128))return eg(C,q,A);throw new Error("Expected varint not more than 10 bytes")}(g,l,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const l=this.readVarint();return l%2==1?(l+1)/-2:l/2}readBoolean(){return!!this.readVarint()}readString(){const l=this.readVarint()+this.pos,d=this.pos;return this.pos=l,l-d>=12&&bR?bR.decode(this.buf.subarray(d,l)):function(g,_,C){let A="",M=_;for(;M<C;){const L=g[M];let q,U,H,Q=null,ee=L>239?4:L>223?3:L>191?2:1;if(M+ee>C)break;ee===1?L<128&&(Q=L):ee===2?(q=g[M+1],(192&q)==128&&(Q=(31&L)<<6|63&q,Q<=127&&(Q=null))):ee===3?(q=g[M+1],U=g[M+2],(192&q)==128&&(192&U)==128&&(Q=(15&L)<<12|(63&q)<<6|63&U,(Q<=2047||Q>=55296&&Q<=57343)&&(Q=null))):ee===4&&(q=g[M+1],U=g[M+2],H=g[M+3],(192&q)==128&&(192&U)==128&&(192&H)==128&&(Q=(15&L)<<18|(63&q)<<12|(63&U)<<6|63&H,(Q<=65535||Q>=1114112)&&(Q=null))),Q===null?(Q=65533,ee=1):Q>65535&&(Q-=65536,A+=String.fromCharCode(Q>>>10&1023|55296),Q=56320|1023&Q),A+=String.fromCharCode(Q),M+=ee}return A}(this.buf,d,l)}readBytes(){const l=this.readVarint()+this.pos,d=this.buf.subarray(this.pos,l);return this.pos=l,d}readPackedVarint(l=[],d){const g=this.readPackedEnd();for(;this.pos<g;)l.push(this.readVarint(d));return l}readPackedSVarint(l=[]){const d=this.readPackedEnd();for(;this.pos<d;)l.push(this.readSVarint());return l}readPackedBoolean(l=[]){const d=this.readPackedEnd();for(;this.pos<d;)l.push(this.readBoolean());return l}readPackedFloat(l=[]){const d=this.readPackedEnd();for(;this.pos<d;)l.push(this.readFloat());return l}readPackedDouble(l=[]){const d=this.readPackedEnd();for(;this.pos<d;)l.push(this.readDouble());return l}readPackedFixed32(l=[]){const d=this.readPackedEnd();for(;this.pos<d;)l.push(this.readFixed32());return l}readPackedSFixed32(l=[]){const d=this.readPackedEnd();for(;this.pos<d;)l.push(this.readSFixed32());return l}readPackedFixed64(l=[]){const d=this.readPackedEnd();for(;this.pos<d;)l.push(this.readFixed64());return l}readPackedSFixed64(l=[]){const d=this.readPackedEnd();for(;this.pos<d;)l.push(this.readSFixed64());return l}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(l){const d=7&l;if(d===0)for(;this.buf[this.pos++]>127;);else if(d===2)this.pos=this.readVarint()+this.pos;else if(d===5)this.pos+=4;else{if(d!==1)throw new Error(`Unimplemented type: ${d}`);this.pos+=8}}writeTag(l,d){this.writeVarint(l<<3|d)}realloc(l){let d=this.length||16;for(;d<this.pos+l;)d*=2;if(d!==this.length){const g=new Uint8Array(d);g.set(this.buf),this.buf=g,this.dataView=new DataView(g.buffer),this.length=d}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(l){this.realloc(4),this.dataView.setInt32(this.pos,l,!0),this.pos+=4}writeSFixed32(l){this.realloc(4),this.dataView.setInt32(this.pos,l,!0),this.pos+=4}writeFixed64(l){this.realloc(8),this.dataView.setInt32(this.pos,-1&l,!0),this.dataView.setInt32(this.pos+4,Math.floor(l*_R),!0),this.pos+=8}writeSFixed64(l){this.realloc(8),this.dataView.setInt32(this.pos,-1&l,!0),this.dataView.setInt32(this.pos+4,Math.floor(l*_R),!0),this.pos+=8}writeVarint(l){(l=+l||0)>268435455||l<0?function(d,g){let _,C;if(d>=0?(_=d%4294967296|0,C=d/4294967296|0):(_=~(-d%4294967296),C=~(-d/4294967296),4294967295^_?_=_+1|0:(_=0,C=C+1|0)),d>=18446744073709552e3||d<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");g.realloc(10),function(A,M,L){L.buf[L.pos++]=127&A|128,A>>>=7,L.buf[L.pos++]=127&A|128,A>>>=7,L.buf[L.pos++]=127&A|128,A>>>=7,L.buf[L.pos++]=127&A|128,L.buf[L.pos]=127&(A>>>=7)}(_,0,g),function(A,M){const L=(7&A)<<4;M.buf[M.pos++]|=L|((A>>>=3)?128:0),A&&(M.buf[M.pos++]=127&A|((A>>>=7)?128:0),A&&(M.buf[M.pos++]=127&A|((A>>>=7)?128:0),A&&(M.buf[M.pos++]=127&A|((A>>>=7)?128:0),A&&(M.buf[M.pos++]=127&A|((A>>>=7)?128:0),A&&(M.buf[M.pos++]=127&A)))))}(C,g)}(l,this):(this.realloc(4),this.buf[this.pos++]=127&l|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=l>>>7&127))))}writeSVarint(l){this.writeVarint(l<0?2*-l-1:2*l)}writeBoolean(l){this.writeVarint(+l)}writeString(l){l=String(l),this.realloc(4*l.length),this.pos++;const d=this.pos;this.pos=function(_,C,A){for(let M,L,q=0;q<C.length;q++){if(M=C.charCodeAt(q),M>55295&&M<57344){if(!L){M>56319||q+1===C.length?(_[A++]=239,_[A++]=191,_[A++]=189):L=M;continue}if(M<56320){_[A++]=239,_[A++]=191,_[A++]=189,L=M;continue}M=L-55296<<10|M-56320|65536,L=null}else L&&(_[A++]=239,_[A++]=191,_[A++]=189,L=null);M<128?_[A++]=M:(M<2048?_[A++]=M>>6|192:(M<65536?_[A++]=M>>12|224:(_[A++]=M>>18|240,_[A++]=M>>12&63|128),_[A++]=M>>6&63|128),_[A++]=63&M|128)}return A}(this.buf,l,this.pos);const g=this.pos-d;g>=128&&jR(d,g,this),this.pos=d-1,this.writeVarint(g),this.pos+=g}writeFloat(l){this.realloc(4),this.dataView.setFloat32(this.pos,l,!0),this.pos+=4}writeDouble(l){this.realloc(8),this.dataView.setFloat64(this.pos,l,!0),this.pos+=8}writeBytes(l){const d=l.length;this.writeVarint(d),this.realloc(d);for(let g=0;g<d;g++)this.buf[this.pos++]=l[g]}writeRawMessage(l,d){this.pos++;const g=this.pos;l(d,this);const _=this.pos-g;_>=128&&jR(g,_,this),this.pos=g-1,this.writeVarint(_),this.pos+=_}writeMessage(l,d,g){this.writeTag(l,2),this.writeRawMessage(d,g)}writePackedVarint(l,d){d.length&&this.writeMessage(l,kY,d)}writePackedSVarint(l,d){d.length&&this.writeMessage(l,TY,d)}writePackedBoolean(l,d){d.length&&this.writeMessage(l,OY,d)}writePackedFloat(l,d){d.length&&this.writeMessage(l,EY,d)}writePackedDouble(l,d){d.length&&this.writeMessage(l,MY,d)}writePackedFixed32(l,d){d.length&&this.writeMessage(l,IY,d)}writePackedSFixed32(l,d){d.length&&this.writeMessage(l,DY,d)}writePackedFixed64(l,d){d.length&&this.writeMessage(l,RY,d)}writePackedSFixed64(l,d){d.length&&this.writeMessage(l,LY,d)}writeBytesField(l,d){this.writeTag(l,2),this.writeBytes(d)}writeFixed32Field(l,d){this.writeTag(l,5),this.writeFixed32(d)}writeSFixed32Field(l,d){this.writeTag(l,5),this.writeSFixed32(d)}writeFixed64Field(l,d){this.writeTag(l,1),this.writeFixed64(d)}writeSFixed64Field(l,d){this.writeTag(l,1),this.writeSFixed64(d)}writeVarintField(l,d){this.writeTag(l,0),this.writeVarint(d)}writeSVarintField(l,d){this.writeTag(l,0),this.writeSVarint(d)}writeStringField(l,d){this.writeTag(l,2),this.writeString(d)}writeFloatField(l,d){this.writeTag(l,5),this.writeFloat(d)}writeDoubleField(l,d){this.writeTag(l,1),this.writeDouble(d)}writeBooleanField(l,d){this.writeVarintField(l,+d)}}function eg(h,l,d){return d?4294967296*l+(h>>>0):4294967296*(l>>>0)+(h>>>0)}function jR(h,l,d){const g=l<=16383?1:l<=2097151?2:l<=268435455?3:Math.floor(Math.log(l)/(7*Math.LN2));d.realloc(g);for(let _=d.pos-1;_>=h;_--)d.buf[_+g]=d.buf[_]}function kY(h,l){for(let d=0;d<h.length;d++)l.writeVarint(h[d])}function TY(h,l){for(let d=0;d<h.length;d++)l.writeSVarint(h[d])}function EY(h,l){for(let d=0;d<h.length;d++)l.writeFloat(h[d])}function MY(h,l){for(let d=0;d<h.length;d++)l.writeDouble(h[d])}function OY(h,l){for(let d=0;d<h.length;d++)l.writeBoolean(h[d])}function IY(h,l){for(let d=0;d<h.length;d++)l.writeFixed32(h[d])}function DY(h,l){for(let d=0;d<h.length;d++)l.writeSFixed32(h[d])}function RY(h,l){for(let d=0;d<h.length;d++)l.writeFixed64(h[d])}function LY(h,l){for(let d=0;d<h.length;d++)l.writeSFixed64(h[d])}function FY(h,l,d){h===1&&d.readMessage(zY,l)}function zY(h,l,d){if(h===3){const{id:g,bitmap:_,width:C,height:A,left:M,top:L,advance:q}=d.readMessage($Y,{});l.push({id:g,bitmap:new Gv({width:C+6,height:A+6},_),metrics:{width:C,height:A,left:M,top:L,advance:q}})}}function $Y(h,l,d){h===1?l.id=d.readVarint():h===2?l.bitmap=d.readBytes():h===3?l.width=d.readVarint():h===4?l.height=d.readVarint():h===5?l.left=d.readSVarint():h===6?l.top=d.readSVarint():h===7&&(l.advance=d.readVarint())}function wR(h){let l=0,d=0;for(const A of h)l+=A.w*A.h,d=Math.max(d,A.w);h.sort((A,M)=>M.h-A.h);const g=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(l/.95)),d),h:1/0}];let _=0,C=0;for(const A of h)for(let M=g.length-1;M>=0;M--){const L=g[M];if(!(A.w>L.w||A.h>L.h)){if(A.x=L.x,A.y=L.y,C=Math.max(C,A.y+A.h),_=Math.max(_,A.x+A.w),A.w===L.w&&A.h===L.h){const q=g.pop();q&&M<g.length&&(g[M]=q)}else A.h===L.h?(L.x+=A.w,L.w-=A.w):A.w===L.w?(L.y+=A.h,L.h-=A.h):(g.push({x:L.x+A.w,y:L.y,w:L.w-A.w,h:A.h}),L.y+=A.h,L.h-=A.h);break}}return{w:_,h:C,fill:l/(_*C)||0}}class cC{constructor(l,{pixelRatio:d,version:g,stretchX:_,stretchY:C,content:A,textFitWidth:M,textFitHeight:L}){this.paddedRect=l,this.pixelRatio=d,this.stretchX=_,this.stretchY=C,this.content=A,this.version=g,this.textFitWidth=M,this.textFitHeight=L}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class SR{constructor(l,d){const g={},_={};this.haveRenderCallbacks=[];const C=[];this.addImages(l,g,C),this.addImages(d,_,C);const{w:A,h:M}=wR(C),L=new Ba({width:A||1,height:M||1});for(const q in l){const U=l[q],H=g[q].paddedRect;Ba.copy(U.data,L,{x:0,y:0},{x:H.x+1,y:H.y+1},U.data)}for(const q in d){const U=d[q],H=_[q].paddedRect,Q=H.x+1,ee=H.y+1,oe=U.data.width,fe=U.data.height;Ba.copy(U.data,L,{x:0,y:0},{x:Q,y:ee},U.data),Ba.copy(U.data,L,{x:0,y:fe-1},{x:Q,y:ee-1},{width:oe,height:1}),Ba.copy(U.data,L,{x:0,y:0},{x:Q,y:ee+fe},{width:oe,height:1}),Ba.copy(U.data,L,{x:oe-1,y:0},{x:Q-1,y:ee},{width:1,height:fe}),Ba.copy(U.data,L,{x:0,y:0},{x:Q+oe,y:ee},{width:1,height:fe})}this.image=L,this.iconPositions=g,this.patternPositions=_}addImages(l,d,g){for(const _ in l){const C=l[_],A={x:0,y:0,w:C.data.width+2,h:C.data.height+2};g.push(A),d[_]=new cC(A,C),C.hasRenderCallback&&this.haveRenderCallbacks.push(_)}}patchUpdatedImages(l,d){l.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const g in l.updatedImages)this.patchUpdatedImage(this.iconPositions[g],l.getImage(g),d),this.patchUpdatedImage(this.patternPositions[g],l.getImage(g),d)}patchUpdatedImage(l,d,g){if(!l||!d||l.version===d.version)return;l.version=d.version;const[_,C]=l.tl;g.update(d.data,void 0,{x:_,y:C})}}var Zd;Kt("ImagePosition",cC),Kt("ImageAtlas",SR),u.as=void 0,(Zd=u.as||(u.as={}))[Zd.none=0]="none",Zd[Zd.horizontal=1]="horizontal",Zd[Zd.vertical=2]="vertical",Zd[Zd.horizontalOnly=3]="horizontalOnly";class r_{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(l,d,g){const _=new r_;return _.scale=l||1,_.fontStack=d,_.verticalAlign=g||"bottom",_}static forImage(l,d){const g=new r_;return g.imageName=l,g.verticalAlign=d||"bottom",g}}class tg{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(l,d){const g=new tg;for(let _=0;_<l.sections.length;_++){const C=l.sections[_];C.image?g.addImageSection(C):g.addTextSection(C,d)}return g}length(){return this.text.length}getSection(l){return this.sections[this.sectionIndex[l]]}getSectionIndex(l){return this.sectionIndex[l]}getCharCode(l){return this.text.charCodeAt(l)}verticalizePunctuation(){this.text=function(l){let d="";for(let g=0;g<l.length;g++){const _=l.charCodeAt(g+1)||null,C=l.charCodeAt(g-1)||null;d+=_&&zp(_)&&!t_[l[g+1]]||C&&zp(C)&&!t_[l[g-1]]||!t_[l[g]]?l[g]:t_[l[g]]}return d}(this.text)}trim(){let l=0;for(let g=0;g<this.text.length&&fw[this.text.charCodeAt(g)];g++)l++;let d=this.text.length;for(let g=this.text.length-1;g>=0&&g>=l&&fw[this.text.charCodeAt(g)];g--)d--;this.text=this.text.substring(l,d),this.sectionIndex=this.sectionIndex.slice(l,d)}substring(l,d){const g=new tg;return g.text=this.text.substring(l,d),g.sectionIndex=this.sectionIndex.slice(l,d),g.sections=this.sections,g}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((l,d)=>Math.max(l,this.sections[d].scale),0)}getMaxImageSize(l){let d=0,g=0;for(let _=0;_<this.length();_++){const C=this.getSection(_);if(C.imageName){const A=l[C.imageName];if(!A)continue;const M=A.displaySize;d=Math.max(d,M[0]),g=Math.max(g,M[1])}}return{maxImageWidth:d,maxImageHeight:g}}addTextSection(l,d){this.text+=l.text,this.sections.push(r_.forText(l.scale,l.fontStack||d,l.verticalAlign));const g=this.sections.length-1;for(let _=0;_<l.text.length;++_)this.sectionIndex.push(g)}addImageSection(l){const d=l.image?l.image.name:"";if(d.length===0)return void ar("Can't add FormattedSection with an empty image.");const g=this.getNextImageSectionCharCode();g?(this.text+=String.fromCharCode(g),this.sections.push(r_.forImage(d,l.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):ar("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function hw(h,l,d,g,_,C,A,M,L,q,U,H,Q,ee,oe){const fe=tg.fromFeature(h,_);let be;H===u.as.vertical&&fe.verticalizePunctuation();const{processBidirectionalText:Pe,processStyledBidirectionalText:Qe}=$l;if(Pe&&fe.sections.length===1){be=[];const it=Pe(fe.toString(),uC(fe,q,C,l,g,ee));for(const ft of it){const Ct=new tg;Ct.text=ft,Ct.sections=fe.sections;for(let Vt=0;Vt<ft.length;Vt++)Ct.sectionIndex.push(0);be.push(Ct)}}else if(Qe){be=[];const it=Qe(fe.text,fe.sectionIndex,uC(fe,q,C,l,g,ee));for(const ft of it){const Ct=new tg;Ct.text=ft[0],Ct.sectionIndex=ft[1],Ct.sections=fe.sections,be.push(Ct)}}else be=function(it,ft){const Ct=[],Vt=it.text;let It=0;for(const $t of ft)Ct.push(it.substring(It,$t)),It=$t;return It<Vt.length&&Ct.push(it.substring(It,Vt.length)),Ct}(fe,uC(fe,q,C,l,g,ee));const De=[],ze={positionedLines:De,text:fe.toString(),top:U[1],bottom:U[1],left:U[0],right:U[0],writingMode:H,iconsInText:!1,verticalizable:!1};return function(it,ft,Ct,Vt,It,$t,vr,Ft,Bt,_t,Fr,$r){let Ar=0,dr=0,dn=0,_s=0;const di=Ft==="right"?1:Ft==="left"?0:.5,Ji=yi/$r;let Mo=0;for(const hs of It){hs.trim();const vi=hs.getMaxScale(),Li={positionedGlyphs:[],lineOffset:0};it.positionedLines[Mo]=Li;const Fi=Li.positionedGlyphs;let Na=0;if(!hs.length()){dr+=$t,++Mo;continue}const Oo=UY(Vt,hs,Ji);for(let Va=0;Va<hs.length();Va++){const hi=hs.getSection(Va),bi=hs.getSectionIndex(Va),ji=hs.getCharCode(Va),ni=WY(Bt,Fr,ji);let es;if(hi.imageName){if(it.iconsInText=!0,hi.scale=hi.scale*Ji,es=KY(hi,ni,vi,Oo,Vt),!es)continue;Na=Math.max(Na,es.imageOffset)}else if(es=GY(hi,ji,ni,Oo,ft,Ct),!es)continue;const{rect:Wl,metrics:ig,baselineOffset:Gl}=es;Fi.push({glyph:ji,imageName:hi.imageName,x:Ar,y:dr+Gl+-17,vertical:ni,scale:hi.scale,fontStack:hi.fontStack,sectionIndex:bi,metrics:ig,rect:Wl}),ni?(it.verticalizable=!0,Ar+=(hi.imageName?ig.advance:yi)*hi.scale+_t):Ar+=ig.advance*hi.scale+_t}Fi.length!==0&&(dn=Math.max(Ar-_t,dn),HY(Fi,0,Fi.length-1,di)),Ar=0,Li.lineOffset=Math.max(Na,(vi-1)*yi);const _i=$t*vi+Na;dr+=_i,_s=Math.max(_i,_s),++Mo}const{horizontalAlign:qa,verticalAlign:Ri}=dC(vr);(function(hs,vi,Li,Fi,Na,Oo,_i,Va,hi){const bi=(vi-Li)*Na;let ji=0;ji=Oo!==_i?-Va*Fi- -17:-Fi*hi*_i+.5*_i;for(const ni of hs)for(const es of ni.positionedGlyphs)es.x+=bi,es.y+=ji})(it.positionedLines,di,qa,Ri,dn,_s,$t,dr,It.length),it.top+=-Ri*dr,it.bottom=it.top+dr,it.left+=-qa*dn,it.right=it.left+dn}(ze,l,d,g,be,A,M,L,H,q,Q,oe),!function(it){for(const ft of it)if(ft.positionedGlyphs.length!==0)return!1;return!0}(De)&&ze}const fw={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},BY={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},qY={40:!0};function NR(h,l,d,g,_,C){if(l.imageName){const A=g[l.imageName];return A?A.displaySize[0]*l.scale*yi/C+_:0}{const A=d[l.fontStack],M=A&&A[h];return M?M.metrics.advance*l.scale+_:0}}function PR(h,l,d,g){const _=Math.pow(h-l,2);return g?h<l?_/2:2*_:_+Math.abs(d)*d}function VY(h,l,d){let g=0;return h===10&&(g-=1e4),d&&(g+=150),h!==40&&h!==65288||(g+=50),l!==41&&l!==65289||(g+=50),g}function CR(h,l,d,g,_,C){let A=null,M=PR(l,d,_,C);for(const L of g){const q=PR(l-L.x,d,_,C)+L.badness;q<=M&&(A=L,M=q)}return{index:h,x:l,priorBreak:A,badness:M}}function AR(h){return h?AR(h.priorBreak).concat(h.index):[]}function uC(h,l,d,g,_,C){if(!h)return[];const A=[],M=function(H,Q,ee,oe,fe,be){let Pe=0;for(let Qe=0;Qe<H.length();Qe++){const De=H.getSection(Qe);Pe+=NR(H.getCharCode(Qe),De,oe,fe,Q,be)}return Pe/Math.max(1,Math.ceil(Pe/ee))}(h,l,d,g,_,C),L=h.text.indexOf("")>=0;let q=0;for(let H=0;H<h.length();H++){const Q=h.getSection(H),ee=h.getCharCode(H);if(fw[ee]||(q+=NR(ee,Q,g,_,l,C)),H<h.length()-1){const oe=!((U=ee)<11904)&&(!!sn["CJK Compatibility Forms"](U)||!!sn["CJK Compatibility"](U)||!!sn["CJK Strokes"](U)||!!sn["CJK Symbols and Punctuation"](U)||!!sn["Enclosed CJK Letters and Months"](U)||!!sn["Halfwidth and Fullwidth Forms"](U)||!!sn["Ideographic Description Characters"](U)||!!sn["Vertical Forms"](U)||Iv.test(String.fromCodePoint(U)));(BY[ee]||oe||Q.imageName||H!==h.length()-2&&qY[h.getCharCode(H+1)])&&A.push(CR(H+1,q,M,A,VY(ee,h.getCharCode(H+1),oe&&L),!1))}}var U;return AR(CR(h.length(),q,M,A,0,!0))}function dC(h){let l=.5,d=.5;switch(h){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0}switch(h){case"bottom":case"bottom-right":case"bottom-left":d=1;break;case"top":case"top-right":case"top-left":d=0}return{horizontalAlign:l,verticalAlign:d}}function UY(h,l,d){const g=l.getMaxScale()*yi,{maxImageWidth:_,maxImageHeight:C}=l.getMaxImageSize(h),A=Math.max(g,C*d);return{verticalLineContentWidth:Math.max(g,_*d),horizontalLineContentHeight:A}}function kR(h){switch(h){case"top":return 0;case"center":return .5;default:return 1}}function WY(h,l,d){return!(h===u.as.horizontal||!l&&!Fp(d)||l&&(fw[d]||(g=d,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(g)))));var g}function GY(h,l,d,g,_,C){const A=C[h.fontStack],M=function(q,U,H,Q){if(q&&q.rect)return q;const ee=U[H.fontStack],oe=ee&&ee[Q];return oe?{rect:null,metrics:oe.metrics}:null}(A&&A[l],_,h,l);if(M===null)return null;let L;if(d)L=g.verticalLineContentWidth-h.scale*yi;else{const q=kR(h.verticalAlign);L=(g.horizontalLineContentHeight-h.scale*yi)*q}return{rect:M.rect,metrics:M.metrics,baselineOffset:L}}function KY(h,l,d,g,_){const C=_[h.imageName];if(!C)return null;const A=C.paddedRect,M=C.displaySize,L={width:M[0],height:M[1],left:1,top:-3,advance:l?M[1]:M[0]};let q;if(l)q=g.verticalLineContentWidth-M[1]*h.scale;else{const U=kR(h.verticalAlign);q=(g.horizontalLineContentHeight-M[1]*h.scale)*U}return{rect:A,metrics:L,baselineOffset:q,imageOffset:(l?M[0]:M[1])*h.scale-yi*d}}function HY(h,l,d,g){if(g===0)return;const _=h[d],C=(h[d].x+_.metrics.advance*_.scale)*g;for(let A=l;A<=d;A++)h[A].x-=C}function ZY(h,l,d){const{horizontalAlign:g,verticalAlign:_}=dC(d),C=l[0]-h.displaySize[0]*g,A=l[1]-h.displaySize[1]*_;return{image:h,top:A,bottom:A+h.displaySize[1],left:C,right:C+h.displaySize[0]}}function TR(h){var l,d;let g=h.left,_=h.top,C=h.right-g,A=h.bottom-_;const M=(l=h.image.textFitWidth)!==null&&l!==void 0?l:"stretchOrShrink",L=(d=h.image.textFitHeight)!==null&&d!==void 0?d:"stretchOrShrink",q=(h.image.content[2]-h.image.content[0])/(h.image.content[3]-h.image.content[1]);if(L==="proportional"){if(M==="stretchOnly"&&C/A<q||M==="proportional"){const U=Math.ceil(A*q);g*=U/C,C=U}}else if(M==="proportional"&&L==="stretchOnly"&&q!==0&&C/A>q){const U=Math.ceil(C/q);_*=U/A,A=U}return{x1:g,y1:_,x2:g+C,y2:_+A}}function ER(h,l,d,g,_,C){const A=h.image;let M;if(A.content){const be=A.content,Pe=A.pixelRatio||1;M=[be[0]/Pe,be[1]/Pe,A.displaySize[0]-be[2]/Pe,A.displaySize[1]-be[3]/Pe]}const L=l.left*C,q=l.right*C;let U,H,Q,ee;d==="width"||d==="both"?(ee=_[0]+L-g[3],H=_[0]+q+g[1]):(ee=_[0]+(L+q-A.displaySize[0])/2,H=ee+A.displaySize[0]);const oe=l.top*C,fe=l.bottom*C;return d==="height"||d==="both"?(U=_[1]+oe-g[0],Q=_[1]+fe+g[2]):(U=_[1]+(oe+fe-A.displaySize[1])/2,Q=U+A.displaySize[1]),{image:A,top:U,right:H,bottom:Q,left:ee,collisionPadding:M}}const Ou=128,Yd=32640;function MR(h,l){const{expression:d}=l;if(d.kind==="constant")return{kind:"constant",layoutSize:d.evaluate(new Bn(h+1))};if(d.kind==="source")return{kind:"source"};{const{zoomStops:g,interpolationType:_}=d;let C=0;for(;C<g.length&&g[C]<=h;)C++;C=Math.max(0,C-1);let A=C;for(;A<g.length&&g[A]<h+1;)A++;A=Math.min(g.length-1,A);const M=g[C],L=g[A];return d.kind==="composite"?{kind:"composite",minZoom:M,maxZoom:L,interpolationType:_}:{kind:"camera",minZoom:M,maxZoom:L,minSize:d.evaluate(new Bn(M)),maxSize:d.evaluate(new Bn(L)),interpolationType:_}}}function hC(h,l,d){let g="never";const _=h.get(l);return _?g=_:h.get(d)&&(g="always"),g}const YY=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function mw(h,l,d,g,_,C,A,M,L,q,U,H,Q){const ee=M?Math.min(Yd,Math.round(M[0])):0,oe=M?Math.min(Yd,Math.round(M[1])):0;h.emplaceBack(l,d,Math.round(32*g),Math.round(32*_),C,A,(ee<<1)+(L?1:0),oe,16*q,16*U,256*H,256*Q)}function fC(h,l,d){h.emplaceBack(l.x,l.y,d),h.emplaceBack(l.x,l.y,d),h.emplaceBack(l.x,l.y,d),h.emplaceBack(l.x,l.y,d)}function XY(h){for(const l of h.sections)if(qP(l.text))return!0;return!1}class mC{constructor(l){this.layoutVertexArray=new st,this.indexArray=new bt,this.programConfigurations=l,this.segments=new Hr,this.dynamicLayoutVertexArray=new ot,this.opacityVertexArray=new dt,this.hasVisibleVertices=!1,this.placedSymbolArray=new W}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(l,d,g,_){this.isEmpty()||(g&&(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,SY.members),this.indexBuffer=l.createIndexBuffer(this.indexArray,d),this.dynamicLayoutVertexBuffer=l.createVertexBuffer(this.dynamicLayoutVertexArray,NY.members,!0),this.opacityVertexBuffer=l.createVertexBuffer(this.opacityVertexArray,YY,!0),this.opacityVertexBuffer.itemSize=1),(g||_)&&this.programConfigurations.upload(l))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Kt("SymbolBuffers",mC);class pC{constructor(l,d,g){this.layoutVertexArray=new l,this.layoutAttributes=d,this.indexArray=new g,this.segments=new Hr,this.collisionVertexArray=new Et}upload(l){this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=l.createVertexBuffer(this.collisionVertexArray,PY.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Kt("CollisionBuffers",pC);class rg{constructor(l){this.collisionBoxArray=l.collisionBoxArray,this.zoom=l.zoom,this.overscaling=vs(globalThis)?Math.min(l.overscaling,128):l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(A=>A.id),this.index=l.index,this.pixelRatio=l.pixelRatio,this.sourceLayerIndex=l.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=MR(this.zoom,d["text-size"]),this.iconSizeData=MR(this.zoom,d["icon-size"]);const g=this.layers[0].layout,_=g.get("symbol-sort-key"),C=g.get("symbol-z-order");this.canOverlap=hC(g,"text-overlap","text-allow-overlap")!=="never"||hC(g,"icon-overlap","icon-allow-overlap")!=="never"||g.get("text-ignore-placement")||g.get("icon-ignore-placement"),this.sortFeaturesByKey=C!=="viewport-y"&&!_.isConstant(),this.sortFeaturesByY=(C==="viewport-y"||C==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,g.get("symbol-placement")==="point"&&(this.writingModes=g.get("text-writing-mode").map(A=>u.as[A])),this.stateDependentLayerIds=this.layers.filter(A=>A.isStateDependent()).map(A=>A.id),this.sourceID=l.sourceID}createArrays(){this.text=new mC(new Eu(this.layers,this.zoom,l=>/^text/.test(l))),this.icon=new mC(new Eu(this.layers,this.zoom,l=>/^icon/.test(l))),this.glyphOffsetArray=new Z,this.lineVertexArray=new re,this.symbolInstances=new Y,this.textAnchorOffsets=new je}calculateGlyphDependencies(l,d,g,_,C){for(let A=0;A<l.length;A++)if(d[l.charCodeAt(A)]=!0,(g||_)&&C){const M=t_[l.charAt(A)];M&&(d[M.charCodeAt(0)]=!0)}}populate(l,d,g){const _=this.layers[0],C=_.layout,A=C.get("text-font"),M=C.get("text-field"),L=C.get("icon-image"),q=(M.value.kind!=="constant"||M.value.value instanceof ba&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&(A.value.kind!=="constant"||A.value.value.length>0),U=L.value.kind!=="constant"||!!L.value.value||Object.keys(L.parameters).length>0,H=C.get("symbol-sort-key");if(this.features=[],!q&&!U)return;const Q=d.iconDependencies,ee=d.glyphDependencies,oe=d.availableImages,fe=new Bn(this.zoom);for(const{feature:be,id:Pe,index:Qe,sourceLayerIndex:De}of l){const ze=_._featureFilter.needGeometry,it=Ec(be,ze);if(!_._featureFilter.filter(fe,it,g))continue;let ft,Ct;if(ze||(it.geometry=Ul(be)),q){const It=_.getValueAndResolveTokens("text-field",it,g,oe),$t=ba.factory(It),vr=this.hasRTLText=this.hasRTLText||XY($t);(!vr||$l.getRTLTextPluginStatus()==="unavailable"||vr&&$l.isParsed())&&(ft=AY($t,_,it))}if(U){const It=_.getValueAndResolveTokens("icon-image",it,g,oe);Ct=It instanceof ca?It:ca.fromString(It)}if(!ft&&!Ct)continue;const Vt=this.sortFeaturesByKey?H.evaluate(it,{},g):void 0;if(this.features.push({id:Pe,text:ft,icon:Ct,index:Qe,sourceLayerIndex:De,geometry:it.geometry,properties:be.properties,type:Jp.types[be.type],sortKey:Vt}),Ct&&(Q[Ct.name]=!0),ft){const It=A.evaluate(it,{},g).join(","),$t=C.get("text-rotation-alignment")!=="viewport"&&C.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(u.as.vertical)>=0;for(const vr of ft.sections)if(vr.image)Q[vr.image.name]=!0;else{const Ft=Mv(ft.toString()),Bt=vr.fontStack||It,_t=ee[Bt]=ee[Bt]||{};this.calculateGlyphDependencies(vr.text,_t,$t,this.allowVerticalPlacement,Ft)}}}C.get("symbol-placement")==="line"&&(this.features=function(be){const Pe={},Qe={},De=[];let ze=0;function it(It){De.push(be[It]),ze++}function ft(It,$t,vr){const Ft=Qe[It];return delete Qe[It],Qe[$t]=Ft,De[Ft].geometry[0].pop(),De[Ft].geometry[0]=De[Ft].geometry[0].concat(vr[0]),Ft}function Ct(It,$t,vr){const Ft=Pe[$t];return delete Pe[$t],Pe[It]=Ft,De[Ft].geometry[0].shift(),De[Ft].geometry[0]=vr[0].concat(De[Ft].geometry[0]),Ft}function Vt(It,$t,vr){const Ft=vr?$t[0][$t[0].length-1]:$t[0][0];return`${It}:${Ft.x}:${Ft.y}`}for(let It=0;It<be.length;It++){const $t=be[It],vr=$t.geometry,Ft=$t.text?$t.text.toString():null;if(!Ft){it(It);continue}const Bt=Vt(Ft,vr),_t=Vt(Ft,vr,!0);if(Bt in Qe&&_t in Pe&&Qe[Bt]!==Pe[_t]){const Fr=Ct(Bt,_t,vr),$r=ft(Bt,_t,De[Fr].geometry);delete Pe[Bt],delete Qe[_t],Qe[Vt(Ft,De[$r].geometry,!0)]=$r,De[Fr].geometry=null}else Bt in Qe?ft(Bt,_t,vr):_t in Pe?Ct(Bt,_t,vr):(it(It),Pe[Bt]=ze-1,Qe[_t]=ze-1)}return De.filter(It=>It.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((be,Pe)=>be.sortKey-Pe.sortKey)}update(l,d,g){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(l,d,this.layers,{imagePositions:g}),this.icon.programConfigurations.updatePaintArrays(l,d,this.layers,{imagePositions:g}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(l){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(l),this.iconCollisionBox.upload(l)),this.text.upload(l,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(l,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(l,d){const g=this.lineVertexArray.length;if(l.segment!==void 0){let _=l.dist(d[l.segment+1]),C=l.dist(d[l.segment]);const A={};for(let M=l.segment+1;M<d.length;M++)A[M]={x:d[M].x,y:d[M].y,tileUnitDistanceFromAnchor:_},M<d.length-1&&(_+=d[M+1].dist(d[M]));for(let M=l.segment||0;M>=0;M--)A[M]={x:d[M].x,y:d[M].y,tileUnitDistanceFromAnchor:C},M>0&&(C+=d[M-1].dist(d[M]));for(let M=0;M<d.length;M++){const L=A[M];this.lineVertexArray.emplaceBack(L.x,L.y,L.tileUnitDistanceFromAnchor)}}return{lineStartIndex:g,lineLength:this.lineVertexArray.length-g}}addSymbols(l,d,g,_,C,A,M,L,q,U,H,Q){const ee=l.indexArray,oe=l.layoutVertexArray,fe=l.segments.prepareSegment(4*d.length,oe,ee,this.canOverlap?A.sortKey:void 0),be=this.glyphOffsetArray.length,Pe=fe.vertexLength,Qe=this.allowVerticalPlacement&&M===u.as.vertical?Math.PI/2:0,De=A.text&&A.text.sections;for(let ze=0;ze<d.length;ze++){const{tl:it,tr:ft,bl:Ct,br:Vt,tex:It,pixelOffsetTL:$t,pixelOffsetBR:vr,minFontScaleX:Ft,minFontScaleY:Bt,glyphOffset:_t,isSDF:Fr,sectionIndex:$r}=d[ze],Ar=fe.vertexLength,dr=_t[1];mw(oe,L.x,L.y,it.x,dr+it.y,It.x,It.y,g,Fr,$t.x,$t.y,Ft,Bt),mw(oe,L.x,L.y,ft.x,dr+ft.y,It.x+It.w,It.y,g,Fr,vr.x,$t.y,Ft,Bt),mw(oe,L.x,L.y,Ct.x,dr+Ct.y,It.x,It.y+It.h,g,Fr,$t.x,vr.y,Ft,Bt),mw(oe,L.x,L.y,Vt.x,dr+Vt.y,It.x+It.w,It.y+It.h,g,Fr,vr.x,vr.y,Ft,Bt),fC(l.dynamicLayoutVertexArray,L,Qe),ee.emplaceBack(Ar,Ar+2,Ar+1),ee.emplaceBack(Ar+1,Ar+2,Ar+3),fe.vertexLength+=4,fe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(_t[0]),ze!==d.length-1&&$r===d[ze+1].sectionIndex||l.programConfigurations.populatePaintArrays(oe.length,A,A.index,{imagePositions:{},canonical:Q,formattedSection:De&&De[$r]})}l.placedSymbolArray.emplaceBack(L.x,L.y,be,this.glyphOffsetArray.length-be,Pe,q,U,L.segment,g?g[0]:0,g?g[1]:0,_[0],_[1],M,0,!1,0,H)}_addCollisionDebugVertex(l,d,g,_,C,A){return d.emplaceBack(0,0),l.emplaceBack(g.x,g.y,_,C,Math.round(A.x),Math.round(A.y))}addCollisionDebugVertices(l,d,g,_,C,A,M){const L=C.segments.prepareSegment(4,C.layoutVertexArray,C.indexArray),q=L.vertexLength,U=C.layoutVertexArray,H=C.collisionVertexArray,Q=M.anchorX,ee=M.anchorY;this._addCollisionDebugVertex(U,H,A,Q,ee,new m(l,d)),this._addCollisionDebugVertex(U,H,A,Q,ee,new m(g,d)),this._addCollisionDebugVertex(U,H,A,Q,ee,new m(g,_)),this._addCollisionDebugVertex(U,H,A,Q,ee,new m(l,_)),L.vertexLength+=4;const oe=C.indexArray;oe.emplaceBack(q,q+1),oe.emplaceBack(q+1,q+2),oe.emplaceBack(q+2,q+3),oe.emplaceBack(q+3,q),L.primitiveLength+=4}addDebugCollisionBoxes(l,d,g,_){for(let C=l;C<d;C++){const A=this.collisionBoxArray.get(C);this.addCollisionDebugVertices(A.x1,A.y1,A.x2,A.y2,_?this.textCollisionBox:this.iconCollisionBox,A.anchorPoint,g)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new pC(kt,vR.members,rr),this.iconCollisionBox=new pC(kt,vR.members,rr);for(let l=0;l<this.symbolInstances.length;l++){const d=this.symbolInstances.get(l);this.addDebugCollisionBoxes(d.textBoxStartIndex,d.textBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.iconBoxStartIndex,d.iconBoxEndIndex,d,!1),this.addDebugCollisionBoxes(d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d,!1)}}_deserializeCollisionBoxesForSymbol(l,d,g,_,C,A,M,L,q){const U={};for(let H=d;H<g;H++){const Q=l.get(H);U.textBox={x1:Q.x1,y1:Q.y1,x2:Q.x2,y2:Q.y2,anchorPointX:Q.anchorPointX,anchorPointY:Q.anchorPointY},U.textFeatureIndex=Q.featureIndex;break}for(let H=_;H<C;H++){const Q=l.get(H);U.verticalTextBox={x1:Q.x1,y1:Q.y1,x2:Q.x2,y2:Q.y2,anchorPointX:Q.anchorPointX,anchorPointY:Q.anchorPointY},U.verticalTextFeatureIndex=Q.featureIndex;break}for(let H=A;H<M;H++){const Q=l.get(H);U.iconBox={x1:Q.x1,y1:Q.y1,x2:Q.x2,y2:Q.y2,anchorPointX:Q.anchorPointX,anchorPointY:Q.anchorPointY},U.iconFeatureIndex=Q.featureIndex;break}for(let H=L;H<q;H++){const Q=l.get(H);U.verticalIconBox={x1:Q.x1,y1:Q.y1,x2:Q.x2,y2:Q.y2,anchorPointX:Q.anchorPointX,anchorPointY:Q.anchorPointY},U.verticalIconFeatureIndex=Q.featureIndex;break}return U}deserializeCollisionBoxes(l){this.collisionArrays=[];for(let d=0;d<this.symbolInstances.length;d++){const g=this.symbolInstances.get(d);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(l,g.textBoxStartIndex,g.textBoxEndIndex,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g.iconBoxStartIndex,g.iconBoxEndIndex,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(l,d){const g=l.placedSymbolArray.get(d),_=g.vertexStartIndex+4*g.numGlyphs;for(let C=g.vertexStartIndex;C<_;C+=4)l.indexArray.emplaceBack(C,C+2,C+1),l.indexArray.emplaceBack(C+1,C+2,C+3)}getSortedSymbolIndexes(l){if(this.sortedAngle===l&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const d=Math.sin(l),g=Math.cos(l),_=[],C=[],A=[];for(let M=0;M<this.symbolInstances.length;++M){A.push(M);const L=this.symbolInstances.get(M);_.push(0|Math.round(d*L.anchorX+g*L.anchorY)),C.push(L.featureIndex)}return A.sort((M,L)=>_[M]-_[L]||C[L]-C[M]),A}addToSortKeyRanges(l,d){const g=this.sortKeyRanges[this.sortKeyRanges.length-1];g&&g.sortKey===d?g.symbolInstanceEnd=l+1:this.sortKeyRanges.push({sortKey:d,symbolInstanceStart:l,symbolInstanceEnd:l+1})}sortFeatures(l){if(this.sortFeaturesByY&&this.sortedAngle!==l&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(l),this.sortedAngle=l,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const d of this.symbolInstanceIndexes){const g=this.symbolInstances.get(d);this.featureSortOrder.push(g.featureIndex),[g.rightJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.leftJustifiedTextSymbolIndex].forEach((_,C,A)=>{_>=0&&A.indexOf(_)===C&&this.addIndicesForPlacedSymbol(this.text,_)}),g.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,g.verticalPlacedTextSymbolIndex),g.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.placedIconSymbolIndex),g.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let OR,IR;Kt("SymbolBucket",rg,{omit:["layers","collisionBoxArray","features","compareText"]}),rg.MAX_GLYPHS=65535,rg.addDynamicAttributes=fC;var gC={get paint(){return IR=IR||new Xi({"icon-opacity":new Tr(Je.paint_symbol["icon-opacity"]),"icon-color":new Tr(Je.paint_symbol["icon-color"]),"icon-halo-color":new Tr(Je.paint_symbol["icon-halo-color"]),"icon-halo-width":new Tr(Je.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Tr(Je.paint_symbol["icon-halo-blur"]),"icon-translate":new fr(Je.paint_symbol["icon-translate"]),"icon-translate-anchor":new fr(Je.paint_symbol["icon-translate-anchor"]),"text-opacity":new Tr(Je.paint_symbol["text-opacity"]),"text-color":new Tr(Je.paint_symbol["text-color"],{runtimeType:Po,getOverride:h=>h.textColor,hasOverride:h=>!!h.textColor}),"text-halo-color":new Tr(Je.paint_symbol["text-halo-color"]),"text-halo-width":new Tr(Je.paint_symbol["text-halo-width"]),"text-halo-blur":new Tr(Je.paint_symbol["text-halo-blur"]),"text-translate":new fr(Je.paint_symbol["text-translate"]),"text-translate-anchor":new fr(Je.paint_symbol["text-translate-anchor"])})},get layout(){return OR=OR||new Xi({"symbol-placement":new fr(Je.layout_symbol["symbol-placement"]),"symbol-spacing":new fr(Je.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new fr(Je.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Tr(Je.layout_symbol["symbol-sort-key"]),"symbol-z-order":new fr(Je.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new fr(Je.layout_symbol["icon-allow-overlap"]),"icon-overlap":new fr(Je.layout_symbol["icon-overlap"]),"icon-ignore-placement":new fr(Je.layout_symbol["icon-ignore-placement"]),"icon-optional":new fr(Je.layout_symbol["icon-optional"]),"icon-rotation-alignment":new fr(Je.layout_symbol["icon-rotation-alignment"]),"icon-size":new Tr(Je.layout_symbol["icon-size"]),"icon-text-fit":new fr(Je.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new fr(Je.layout_symbol["icon-text-fit-padding"]),"icon-image":new Tr(Je.layout_symbol["icon-image"]),"icon-rotate":new Tr(Je.layout_symbol["icon-rotate"]),"icon-padding":new Tr(Je.layout_symbol["icon-padding"]),"icon-keep-upright":new fr(Je.layout_symbol["icon-keep-upright"]),"icon-offset":new Tr(Je.layout_symbol["icon-offset"]),"icon-anchor":new Tr(Je.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new fr(Je.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new fr(Je.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new fr(Je.layout_symbol["text-rotation-alignment"]),"text-field":new Tr(Je.layout_symbol["text-field"]),"text-font":new Tr(Je.layout_symbol["text-font"]),"text-size":new Tr(Je.layout_symbol["text-size"]),"text-max-width":new Tr(Je.layout_symbol["text-max-width"]),"text-line-height":new fr(Je.layout_symbol["text-line-height"]),"text-letter-spacing":new Tr(Je.layout_symbol["text-letter-spacing"]),"text-justify":new Tr(Je.layout_symbol["text-justify"]),"text-radial-offset":new Tr(Je.layout_symbol["text-radial-offset"]),"text-variable-anchor":new fr(Je.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Tr(Je.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Tr(Je.layout_symbol["text-anchor"]),"text-max-angle":new fr(Je.layout_symbol["text-max-angle"]),"text-writing-mode":new fr(Je.layout_symbol["text-writing-mode"]),"text-rotate":new Tr(Je.layout_symbol["text-rotate"]),"text-padding":new fr(Je.layout_symbol["text-padding"]),"text-keep-upright":new fr(Je.layout_symbol["text-keep-upright"]),"text-transform":new Tr(Je.layout_symbol["text-transform"]),"text-offset":new Tr(Je.layout_symbol["text-offset"]),"text-allow-overlap":new fr(Je.layout_symbol["text-allow-overlap"]),"text-overlap":new fr(Je.layout_symbol["text-overlap"]),"text-ignore-placement":new fr(Je.layout_symbol["text-ignore-placement"]),"text-optional":new fr(Je.layout_symbol["text-optional"])})}};class DR{constructor(l){if(l.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=l.property.overrides?l.property.overrides.runtimeType:Ii,this.defaultValue=l}evaluate(l){if(l.formattedSection){const d=this.defaultValue.property.overrides;if(d&&d.hasOverride(l.formattedSection))return d.getOverride(l.formattedSection)}return l.feature&&l.featureState?this.defaultValue.evaluate(l.feature,l.featureState):this.defaultValue.property.specification.default}eachChild(l){this.defaultValue.isConstant()||l(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Kt("FormatSectionOverride",DR,{omit:["defaultValue"]});class pw extends ko{constructor(l,d){super(l,gC,d)}recalculate(l,d){if(super.recalculate(l,d),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const g=this.layout.get("text-writing-mode");if(g){const _=[];for(const C of g)_.indexOf(C)<0&&_.push(C);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(l,d,g,_){const C=this.layout.get(l).evaluate(d,{},g,_),A=this._unevaluatedLayout._values[l];return A.isDataDriven()||Ap(A.value)||!C?C:function(M,L){return L.replace(/{([^{}]+)}/g,(q,U)=>M&&U in M?String(M[U]):"")}(d.properties,C)}createBucket(l){return new rg(l)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const l of gC.paint.overridableProperties){if(!pw.hasPaintOverride(this.layout,l))continue;const d=this.paint.get(l),g=new DR(d),_=new yv(g,d.property.specification);let C=null;C=d.value.kind==="constant"||d.value.kind==="source"?new If("source",_):new vv("composite",_,d.value.zoomStops),this.paint._values[l]=new Ao(d.property,C,d.parameters)}}_handleOverridablePaintPropertyUpdate(l,d,g){return!(!this.layout||d.isDataDriven()||g.isDataDriven())&&pw.hasPaintOverride(this.layout,l)}static hasPaintOverride(l,d){const g=l.get("text-field"),_=gC.paint.properties[d];let C=!1;const A=M=>{for(const L of M)if(_.overrides&&_.overrides.hasOverride(L))return void(C=!0)};if(g.value.kind==="constant"&&g.value.value instanceof ba)A(g.value.value.sections);else if(g.value.kind==="source"||g.value.kind==="composite"){const M=q=>{C||(q instanceof Sc&&Es(q.value)===lu?A(q.value.sections):q instanceof xp?A(q.sections):q.eachChild(M))},L=g.value;L._styleExpression&&M(L._styleExpression.expression)}return C}}let RR;var QY={get paint(){return RR=RR||new Xi({"background-color":new fr(Je.paint_background["background-color"]),"background-pattern":new Qj(Je.paint_background["background-pattern"]),"background-opacity":new fr(Je.paint_background["background-opacity"])})}};class JY extends ko{constructor(l,d){super(l,QY,d)}}class eX extends ko{constructor(l,d){super(l,{},d),this.onAdd=g=>{this.implementation.onAdd&&this.implementation.onAdd(g,g.painter.context.gl)},this.onRemove=g=>{this.implementation.onRemove&&this.implementation.onRemove(g,g.painter.context.gl)},this.implementation=l}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class tX{constructor(l){this._methodToThrottle=l,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const rX={once:!0},xC=63710088e-1;class Xd{constructor(l,d){if(isNaN(l)||isNaN(d))throw new Error(`Invalid LngLat object: (${l}, ${d})`);if(this.lng=+l,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Xd(Mt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(l){const d=Math.PI/180,g=this.lat*d,_=l.lat*d,C=Math.sin(g)*Math.sin(_)+Math.cos(g)*Math.cos(_)*Math.cos((l.lng-this.lng)*d);return xC*Math.acos(Math.min(C,1))}static convert(l){if(l instanceof Xd)return l;if(Array.isArray(l)&&(l.length===2||l.length===3))return new Xd(Number(l[0]),Number(l[1]));if(!Array.isArray(l)&&typeof l=="object"&&l!==null)return new Xd(Number("lng"in l?l.lng:l.lon),Number(l.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const LR=2*Math.PI*xC;function FR(h){return LR*Math.cos(h*Math.PI/180)}function zR(h){return(180+h)/360}function $R(h){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h*Math.PI/360)))/360}function BR(h,l){return h/FR(l)}function qR(h){return 360*h-180}function gw(h){return 360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90}function VR(h,l){return h*FR(gw(l))}class n_{constructor(l,d,g=0){this.x=+l,this.y=+d,this.z=+g}static fromLngLat(l,d=0){const g=Xd.convert(l);return new n_(zR(g.lng),$R(g.lat),BR(d,g.lat))}toLngLat(){return new Xd(qR(this.x),gw(this.y))}toAltitude(){return VR(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/LR*(l=gw(this.y),1/Math.cos(l*Math.PI/180));var l}}function UR(h,l,d){var g=2*Math.PI*6378137/256/Math.pow(2,d);return[h*g-2*Math.PI*6378137/2,l*g-2*Math.PI*6378137/2]}class yC{constructor(l,d,g){if(!function(_,C,A){return!(_<0||_>25||A<0||A>=Math.pow(2,_)||C<0||C>=Math.pow(2,_))}(l,d,g))throw new Error(`x=${d}, y=${g}, z=${l} outside of bounds. 0<=x<${Math.pow(2,l)}, 0<=y<${Math.pow(2,l)} 0<=z<=25 `);this.z=l,this.x=d,this.y=g,this.key=ng(0,l,l,d,g)}equals(l){return this.z===l.z&&this.x===l.x&&this.y===l.y}url(l,d,g){const _=(A=this.y,M=this.z,L=UR(256*(C=this.x),256*(A=Math.pow(2,M)-A-1),M),q=UR(256*(C+1),256*(A+1),M),L[0]+","+L[1]+","+q[0]+","+q[1]);var C,A,M,L,q;const U=function(H,Q,ee){let oe,fe="";for(let be=H;be>0;be--)oe=1<<be-1,fe+=(Q&oe?1:0)+(ee&oe?2:0);return fe}(this.z,this.x,this.y);return l[(this.x+this.y)%l.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(g==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,d>1?"@2x":"").replace(/{quadkey}/g,U).replace(/{bbox-epsg-3857}/g,_)}isChildOf(l){const d=this.z-l.z;return d>0&&l.x===this.x>>d&&l.y===this.y>>d}getTilePoint(l){const d=Math.pow(2,this.z);return new m((l.x*d-this.x)*_e,(l.y*d-this.y)*_e)}toString(){return`${this.z}/${this.x}/${this.y}`}}class WR{constructor(l,d){this.wrap=l,this.canonical=d,this.key=ng(l,d.z,d.z,d.x,d.y)}}class Eo{constructor(l,d,g,_,C){if(this.terrainRttPosMatrix32f=null,l<g)throw new Error(`overscaledZ should be >= z; overscaledZ = ${l}; z = ${g}`);this.overscaledZ=l,this.wrap=d,this.canonical=new yC(g,+_,+C),this.key=ng(d,l,g,_,C)}clone(){return new Eo(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(l){return this.overscaledZ===l.overscaledZ&&this.wrap===l.wrap&&this.canonical.equals(l.canonical)}scaledTo(l){if(l>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${l}; overscaledZ = ${this.overscaledZ}`);const d=this.canonical.z-l;return l>this.canonical.z?new Eo(l,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Eo(l,this.wrap,l,this.canonical.x>>d,this.canonical.y>>d)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(l,d){if(l>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${l}; overscaledZ = ${this.overscaledZ}`);const g=this.canonical.z-l;return l>this.canonical.z?ng(this.wrap*+d,l,this.canonical.z,this.canonical.x,this.canonical.y):ng(this.wrap*+d,l,l,this.canonical.x>>g,this.canonical.y>>g)}isChildOf(l){if(l.wrap!==this.wrap||this.overscaledZ-l.overscaledZ<=0)return!1;if(l.overscaledZ===0)return this.overscaledZ>0;const d=this.canonical.z-l.canonical.z;return!(d<0)&&l.canonical.x===this.canonical.x>>d&&l.canonical.y===this.canonical.y>>d}children(l){if(this.overscaledZ>=l)return[new Eo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const d=this.canonical.z+1,g=2*this.canonical.x,_=2*this.canonical.y;return[new Eo(d,this.wrap,d,g,_),new Eo(d,this.wrap,d,g+1,_),new Eo(d,this.wrap,d,g,_+1),new Eo(d,this.wrap,d,g+1,_+1)]}isLessThan(l){return this.wrap<l.wrap||!(this.wrap>l.wrap)&&(this.overscaledZ<l.overscaledZ||!(this.overscaledZ>l.overscaledZ)&&(this.canonical.x<l.canonical.x||!(this.canonical.x>l.canonical.x)&&this.canonical.y<l.canonical.y))}wrapped(){return new Eo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(l){return new Eo(this.overscaledZ,l,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new WR(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(l){return this.canonical.getTilePoint(new n_(l.x-this.wrap,l.y))}}function ng(h,l,d,g,_){(h*=2)<0&&(h=-1*h-1);const C=1<<d;return(C*C*h+C*_+g).toString(36)+d.toString(36)+l.toString(36)}function s_(h,l){return l?h.properties[l]:h.id}Kt("CanonicalTileID",yC),Kt("OverscaledTileID",Eo,{omit:["terrainRttPosMatrix32f"]});class Hf{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(l){return this.minX=Math.min(this.minX,l.x),this.minY=Math.min(this.minY,l.y),this.maxX=Math.max(this.maxX,l.x),this.maxY=Math.max(this.maxY,l.y),this}expandBy(l){return this.minX-=l,this.minY-=l,this.maxX+=l,this.maxY+=l,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(l){return this.expandBy(-l)}map(l){const d=new Hf;return d.extend(l(new m(this.minX,this.minY))),d.extend(l(new m(this.maxX,this.minY))),d.extend(l(new m(this.minX,this.maxY))),d.extend(l(new m(this.maxX,this.maxY))),d}static fromPoints(l){const d=new Hf;for(const g of l)d.extend(g);return d}contains(l){return l.x>=this.minX&&l.x<=this.maxX&&l.y>=this.minY&&l.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(l){return!this.empty()&&!l.empty()&&l.minX>=this.minX&&l.maxX<=this.maxX&&l.minY>=this.minY&&l.maxY<=this.maxY}intersects(l){return!this.empty()&&!l.empty()&&l.minX<=this.maxX&&l.maxX>=this.minX&&l.minY<=this.maxY&&l.maxY>=this.minY}}class GR{constructor(l){this._stringToNumber={},this._numberToString=[];for(let d=0;d<l.length;d++){const g=l[d];this._stringToNumber[g]=d,this._numberToString[d]=g}}encode(l){return this._stringToNumber[l]}decode(l){if(l>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${l} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[l]}}class KR{constructor(l,d,g,_,C){this.type="Feature",this._vectorTileFeature=l,l._z=d,l._x=g,l._y=_,this.properties=l.properties,this.id=C}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(l){this._geometry=l}toJSON(){const l={geometry:this.geometry};for(const d in this)d!=="_geometry"&&d!=="_vectorTileFeature"&&(l[d]=this[d]);return l}}class HR{constructor(l,d){this.tileID=l,this.x=l.canonical.x,this.y=l.canonical.y,this.z=l.canonical.z,this.grid=new wu(_e,16,0),this.grid3D=new wu(_e,16,0),this.featureIndexArray=new Se,this.promoteId=d}insert(l,d,g,_,C,A){const M=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(g,_,C);const L=A?this.grid3D:this.grid;for(let q=0;q<d.length;q++){const U=d[q],H=[1/0,1/0,-1/0,-1/0];for(let Q=0;Q<U.length;Q++){const ee=U[Q];H[0]=Math.min(H[0],ee.x),H[1]=Math.min(H[1],ee.y),H[2]=Math.max(H[2],ee.x),H[3]=Math.max(H[3],ee.y)}H[0]<_e&&H[1]<_e&&H[2]>=0&&H[3]>=0&&L.insert(M,H[0],H[1],H[2],H[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new uR(new lC(this.rawTileData)).layers,this.sourceLayerCoder=new GR(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(l,d,g,_){this.loadVTLayers();const C=l.params,A=_e/l.tileSize/l.scale,M=Df(C.filter,C.globalState),L=l.queryGeometry,q=l.queryPadding*A,U=Hf.fromPoints(L),H=this.grid.query(U.minX-q,U.minY-q,U.maxX+q,U.maxY+q),Q=Hf.fromPoints(l.cameraQueryGeometry).expandBy(q),ee=this.grid3D.query(Q.minX,Q.minY,Q.maxX,Q.maxY,(be,Pe,Qe,De)=>function(ze,it,ft,Ct,Vt){for(const $t of ze)if(it<=$t.x&&ft<=$t.y&&Ct>=$t.x&&Vt>=$t.y)return!0;const It=[new m(it,ft),new m(it,Vt),new m(Ct,Vt),new m(Ct,ft)];if(ze.length>2){for(const $t of It)if(Hp(ze,$t))return!0}for(let $t=0;$t<ze.length-1;$t++)if(MZ(ze[$t],ze[$t+1],It))return!0;return!1}(l.cameraQueryGeometry,be-q,Pe-q,Qe+q,De+q));for(const be of ee)H.push(be);H.sort(nX);const oe={};let fe;for(let be=0;be<H.length;be++){const Pe=H[be];if(Pe===fe)continue;fe=Pe;const Qe=this.featureIndexArray.get(Pe);let De=null;this.loadMatchingFeature(oe,Qe.bucketIndex,Qe.sourceLayerIndex,Qe.featureIndex,M,C.layers,C.availableImages,d,g,_,(ze,it,ft)=>(De||(De=Ul(ze)),it.queryIntersectsFeature({queryGeometry:L,feature:ze,featureState:ft,geometry:De,zoom:this.z,transform:l.transform,pixelsToTileUnits:A,pixelPosMatrix:l.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:l.getElevation})))}return oe}loadMatchingFeature(l,d,g,_,C,A,M,L,q,U,H){const Q=this.bucketLayerIDs[d];if(A&&!Q.some(be=>A.has(be)))return;const ee=this.sourceLayerCoder.decode(g),oe=this.vtLayers[ee].feature(_);if(C.needGeometry){const be=Ec(oe,!0);if(!C.filter(new Bn(this.tileID.overscaledZ),be,this.tileID.canonical))return}else if(!C.filter(new Bn(this.tileID.overscaledZ),oe))return;const fe=this.getId(oe,ee);for(let be=0;be<Q.length;be++){const Pe=Q[be];if(A&&!A.has(Pe))continue;const Qe=L[Pe];if(!Qe)continue;let De={};fe&&U&&(De=U.getState(Qe.sourceLayer||"_geojsonTileLayer",fe));const ze=yr({},q[Pe]);ze.paint=ZR(ze.paint,Qe.paint,oe,De,M),ze.layout=ZR(ze.layout,Qe.layout,oe,De,M);const it=!H||H(oe,Qe,De);if(!it)continue;const ft=new KR(oe,this.z,this.x,this.y,fe);ft.layer=ze;let Ct=l[Pe];Ct===void 0&&(Ct=l[Pe]=[]),Ct.push({featureIndex:_,feature:ft,intersectionZ:it})}}lookupSymbolFeatures(l,d,g,_,C,A,M,L){const q={};this.loadVTLayers();const U=Df(C.filterSpec,C.globalState);for(const H of l)this.loadMatchingFeature(q,g,_,H,U,A,M,L,d);return q}hasLayer(l){for(const d of this.bucketLayerIDs)for(const g of d)if(l===g)return!0;return!1}getId(l,d){var g;let _=l.id;return this.promoteId&&(_=l.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[d]],typeof _=="boolean"&&(_=Number(_)),_===void 0&&(!((g=l.properties)===null||g===void 0)&&g.cluster)&&this.promoteId&&(_=Number(l.properties.cluster_id))),_}}function ZR(h,l,d,g,_){return Wt(h,(C,A)=>{const M=l instanceof Su?l.get(A):null;return M&&M.evaluate?M.evaluate(d,g,_):M})}function nX(h,l){return l-h}function YR(h,l,d,g,_){const C=[];for(let A=0;A<h.length;A++){const M=h[A];let L;for(let q=0;q<M.length-1;q++){let U=M[q],H=M[q+1];U.x<l&&H.x<l||(U.x<l?U=new m(l,U.y+(l-U.x)/(H.x-U.x)*(H.y-U.y))._round():H.x<l&&(H=new m(l,U.y+(l-U.x)/(H.x-U.x)*(H.y-U.y))._round()),U.y<d&&H.y<d||(U.y<d?U=new m(U.x+(d-U.y)/(H.y-U.y)*(H.x-U.x),d)._round():H.y<d&&(H=new m(U.x+(d-U.y)/(H.y-U.y)*(H.x-U.x),d)._round()),U.x>=g&&H.x>=g||(U.x>=g?U=new m(g,U.y+(g-U.x)/(H.x-U.x)*(H.y-U.y))._round():H.x>=g&&(H=new m(g,U.y+(g-U.x)/(H.x-U.x)*(H.y-U.y))._round()),U.y>=_&&H.y>=_||(U.y>=_?U=new m(U.x+(_-U.y)/(H.y-U.y)*(H.x-U.x),_)._round():H.y>=_&&(H=new m(U.x+(_-U.y)/(H.y-U.y)*(H.x-U.x),_)._round()),L&&U.equals(L[L.length-1])||(L=[U],C.push(L)),L.push(H)))))}}return C}Kt("FeatureIndex",HR,{omit:["rawTileData","sourceLayerCoder"]});class Qd extends m{constructor(l,d,g,_){super(l,d),this.angle=g,_!==void 0&&(this.segment=_)}clone(){return new Qd(this.x,this.y,this.angle,this.segment)}}function XR(h,l,d,g,_){if(l.segment===void 0||d===0)return!0;let C=l,A=l.segment+1,M=0;for(;M>-d/2;){if(A--,A<0)return!1;M-=h[A].dist(C),C=h[A]}M+=h[A].dist(h[A+1]),A++;const L=[];let q=0;for(;M<d/2;){const U=h[A],H=h[A+1];if(!H)return!1;let Q=h[A-1].angleTo(U)-U.angleTo(H);for(Q=Math.abs((Q+3*Math.PI)%(2*Math.PI)-Math.PI),L.push({distance:M,angleDelta:Q}),q+=Q;M-L[0].distance>g;)q-=L.shift().angleDelta;if(q>_)return!1;A++,M+=U.dist(H)}return!0}function QR(h){let l=0;for(let d=0;d<h.length-1;d++)l+=h[d].dist(h[d+1]);return l}function JR(h,l,d){return h?.6*l*d:0}function e4(h,l){return Math.max(h?h.right-h.left:0,l?l.right-l.left:0)}function sX(h,l,d,g,_,C){const A=JR(d,_,C),M=e4(d,g)*C;let L=0;const q=QR(h)/2;for(let U=0;U<h.length-1;U++){const H=h[U],Q=h[U+1],ee=H.dist(Q);if(L+ee>q){const oe=(q-L)/ee,fe=io.number(H.x,Q.x,oe),be=io.number(H.y,Q.y,oe),Pe=new Qd(fe,be,Q.angleTo(H),U);return Pe._round(),!A||XR(h,Pe,M,A,l)?Pe:void 0}L+=ee}}function iX(h,l,d,g,_,C,A,M,L){const q=JR(g,C,A),U=e4(g,_),H=U*A,Q=h[0].x===0||h[0].x===L||h[0].y===0||h[0].y===L;return l-H<l/4&&(l=H+l/4),t4(h,Q?l/2*M%l:(U/2+2*C)*A*M%l,l,q,d,H,Q,!1,L)}function t4(h,l,d,g,_,C,A,M,L){const q=C/2,U=QR(h);let H=0,Q=l-d,ee=[];for(let oe=0;oe<h.length-1;oe++){const fe=h[oe],be=h[oe+1],Pe=fe.dist(be),Qe=be.angleTo(fe);for(;Q+d<H+Pe;){Q+=d;const De=(Q-H)/Pe,ze=io.number(fe.x,be.x,De),it=io.number(fe.y,be.y,De);if(ze>=0&&ze<L&&it>=0&&it<L&&Q-q>=0&&Q+q<=U){const ft=new Qd(ze,it,Qe,oe);ft._round(),g&&!XR(h,ft,C,g,_)||ee.push(ft)}}H+=Pe}return M||ee.length||A||(ee=t4(h,H/2,d,g,_,C,A,!0,L)),ee}function r4(h,l,d,g){const _=[],C=h.image,A=C.pixelRatio,M=C.paddedRect.w-2,L=C.paddedRect.h-2;let q={x1:h.left,y1:h.top,x2:h.right,y2:h.bottom};const U=C.stretchX||[[0,M]],H=C.stretchY||[[0,L]],Q=(_t,Fr)=>_t+Fr[1]-Fr[0],ee=U.reduce(Q,0),oe=H.reduce(Q,0),fe=M-ee,be=L-oe;let Pe=0,Qe=ee,De=0,ze=oe,it=0,ft=fe,Ct=0,Vt=be;if(C.content&&g){const _t=C.content,Fr=_t[2]-_t[0],$r=_t[3]-_t[1];(C.textFitWidth||C.textFitHeight)&&(q=TR(h)),Pe=xw(U,0,_t[0]),De=xw(H,0,_t[1]),Qe=xw(U,_t[0],_t[2]),ze=xw(H,_t[1],_t[3]),it=_t[0]-Pe,Ct=_t[1]-De,ft=Fr-Qe,Vt=$r-ze}const It=q.x1,$t=q.y1,vr=q.x2-It,Ft=q.y2-$t,Bt=(_t,Fr,$r,Ar)=>{const dr=yw(_t.stretch-Pe,Qe,vr,It),dn=vw(_t.fixed-it,ft,_t.stretch,ee),_s=yw(Fr.stretch-De,ze,Ft,$t),di=vw(Fr.fixed-Ct,Vt,Fr.stretch,oe),Ji=yw($r.stretch-Pe,Qe,vr,It),Mo=vw($r.fixed-it,ft,$r.stretch,ee),qa=yw(Ar.stretch-De,ze,Ft,$t),Ri=vw(Ar.fixed-Ct,Vt,Ar.stretch,oe),hs=new m(dr,_s),vi=new m(Ji,_s),Li=new m(Ji,qa),Fi=new m(dr,qa),Na=new m(dn/A,di/A),Oo=new m(Mo/A,Ri/A),_i=l*Math.PI/180;if(_i){const bi=Math.sin(_i),ji=Math.cos(_i),ni=[ji,-bi,bi,ji];hs._matMult(ni),vi._matMult(ni),Fi._matMult(ni),Li._matMult(ni)}const Va=_t.stretch+_t.fixed,hi=Fr.stretch+Fr.fixed;return{tl:hs,tr:vi,bl:Fi,br:Li,tex:{x:C.paddedRect.x+1+Va,y:C.paddedRect.y+1+hi,w:$r.stretch+$r.fixed-Va,h:Ar.stretch+Ar.fixed-hi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Na,pixelOffsetBR:Oo,minFontScaleX:ft/A/vr,minFontScaleY:Vt/A/Ft,isSDF:d}};if(g&&(C.stretchX||C.stretchY)){const _t=n4(U,fe,ee),Fr=n4(H,be,oe);for(let $r=0;$r<_t.length-1;$r++){const Ar=_t[$r],dr=_t[$r+1];for(let dn=0;dn<Fr.length-1;dn++)_.push(Bt(Ar,Fr[dn],dr,Fr[dn+1]))}}else _.push(Bt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:M+1},{fixed:0,stretch:L+1}));return _}function xw(h,l,d){let g=0;for(const _ of h)g+=Math.max(l,Math.min(d,_[1]))-Math.max(l,Math.min(d,_[0]));return g}function n4(h,l,d){const g=[{fixed:-1,stretch:0}];for(const[_,C]of h){const A=g[g.length-1];g.push({fixed:_-A.stretch,stretch:A.stretch}),g.push({fixed:_-A.stretch,stretch:A.stretch+(C-_)})}return g.push({fixed:l+1,stretch:d}),g}function yw(h,l,d,g){return h/l*d+g}function vw(h,l,d,g){return h-l*d/g}Kt("Anchor",Qd);class _w{constructor(l,d,g,_,C,A,M,L,q,U){var H;if(this.boxStartIndex=l.length,q){let Q=A.top,ee=A.bottom;const oe=A.collisionPadding;oe&&(Q-=oe[1],ee+=oe[3]);let fe=ee-Q;fe>0&&(fe=Math.max(10,fe),this.circleDiameter=fe)}else{const Q=!((H=A.image)===null||H===void 0)&&H.content&&(A.image.textFitWidth||A.image.textFitHeight)?TR(A):{x1:A.left,y1:A.top,x2:A.right,y2:A.bottom};Q.y1=Q.y1*M-L[0],Q.y2=Q.y2*M+L[2],Q.x1=Q.x1*M-L[3],Q.x2=Q.x2*M+L[1];const ee=A.collisionPadding;if(ee&&(Q.x1-=ee[0]*M,Q.y1-=ee[1]*M,Q.x2+=ee[2]*M,Q.y2+=ee[3]*M),U){const oe=new m(Q.x1,Q.y1),fe=new m(Q.x2,Q.y1),be=new m(Q.x1,Q.y2),Pe=new m(Q.x2,Q.y2),Qe=U*Math.PI/180;oe._rotate(Qe),fe._rotate(Qe),be._rotate(Qe),Pe._rotate(Qe),Q.x1=Math.min(oe.x,fe.x,be.x,Pe.x),Q.x2=Math.max(oe.x,fe.x,be.x,Pe.x),Q.y1=Math.min(oe.y,fe.y,be.y,Pe.y),Q.y2=Math.max(oe.y,fe.y,be.y,Pe.y)}l.emplaceBack(d.x,d.y,Q.x1,Q.y1,Q.x2,Q.y2,g,_,C)}this.boxEndIndex=l.length}}class aX{constructor(l=[],d=(g,_)=>g<_?-1:g>_?1:0){if(this.data=l,this.length=this.data.length,this.compare=d,this.length>0)for(let g=(this.length>>1)-1;g>=0;g--)this._down(g)}push(l){this.data.push(l),this._up(this.length++)}pop(){if(this.length===0)return;const l=this.data[0],d=this.data.pop();return--this.length>0&&(this.data[0]=d,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:d,compare:g}=this,_=d[l];for(;l>0;){const C=l-1>>1,A=d[C];if(g(_,A)>=0)break;d[l]=A,l=C}d[l]=_}_down(l){const{data:d,compare:g}=this,_=this.length>>1,C=d[l];for(;l<_;){let A=1+(l<<1);const M=A+1;if(M<this.length&&g(d[M],d[A])<0&&(A=M),g(d[A],C)>=0)break;d[l]=d[A],l=A}d[l]=C}}function oX(h,l=1,d=!1){const g=Hf.fromPoints(h[0]),_=Math.min(g.width(),g.height());let C=_/2;const A=new aX([],lX),{minX:M,minY:L,maxX:q,maxY:U}=g;if(_===0)return new m(M,L);for(let ee=M;ee<q;ee+=_)for(let oe=L;oe<U;oe+=_)A.push(new sg(ee+C,oe+C,C,h));let H=function(ee){let oe=0,fe=0,be=0;const Pe=ee[0];for(let Qe=0,De=Pe.length,ze=De-1;Qe<De;ze=Qe++){const it=Pe[Qe],ft=Pe[ze],Ct=it.x*ft.y-ft.x*it.y;fe+=(it.x+ft.x)*Ct,be+=(it.y+ft.y)*Ct,oe+=3*Ct}return new sg(fe/oe,be/oe,0,ee)}(h),Q=A.length;for(;A.length;){const ee=A.pop();(ee.d>H.d||!H.d)&&(H=ee,d&&console.log("found best %d after %d probes",Math.round(1e4*ee.d)/1e4,Q)),ee.max-H.d<=l||(C=ee.h/2,A.push(new sg(ee.p.x-C,ee.p.y-C,C,h)),A.push(new sg(ee.p.x+C,ee.p.y-C,C,h)),A.push(new sg(ee.p.x-C,ee.p.y+C,C,h)),A.push(new sg(ee.p.x+C,ee.p.y+C,C,h)),Q+=4)}return d&&(console.log(`num probes: ${Q}`),console.log(`best distance: ${H.d}`)),H.p}function lX(h,l){return l.max-h.max}function sg(h,l,d,g){this.p=new m(h,l),this.h=d,this.d=function(_,C){let A=!1,M=1/0;for(let L=0;L<C.length;L++){const q=C[L];for(let U=0,H=q.length,Q=H-1;U<H;Q=U++){const ee=q[U],oe=q[Q];ee.y>_.y!=oe.y>_.y&&_.x<(oe.x-ee.x)*(_.y-ee.y)/(oe.y-ee.y)+ee.x&&(A=!A),M=Math.min(M,BD(_,ee,oe))}}return(A?1:-1)*Math.sqrt(M)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}var Qi;u.aI=void 0,(Qi=u.aI||(u.aI={}))[Qi.center=1]="center",Qi[Qi.left=2]="left",Qi[Qi.right=3]="right",Qi[Qi.top=4]="top",Qi[Qi.bottom=5]="bottom",Qi[Qi["top-left"]=6]="top-left",Qi[Qi["top-right"]=7]="top-right",Qi[Qi["bottom-left"]=8]="bottom-left",Qi[Qi["bottom-right"]=9]="bottom-right";const vC=Number.POSITIVE_INFINITY;function s4(h,l){return l[1]!==vC?function(d,g,_){let C=0,A=0;switch(g=Math.abs(g),_=Math.abs(_),d){case"top-right":case"top-left":case"top":A=_-7;break;case"bottom-right":case"bottom-left":case"bottom":A=7-_}switch(d){case"top-right":case"bottom-right":case"right":C=-g;break;case"top-left":case"bottom-left":case"left":C=g}return[C,A]}(h,l[0],l[1]):function(d,g){let _=0,C=0;g<0&&(g=0);const A=g/Math.SQRT2;switch(d){case"top-right":case"top-left":C=A-7;break;case"bottom-right":case"bottom-left":C=7-A;break;case"bottom":C=7-g;break;case"top":C=g-7}switch(d){case"top-right":case"bottom-right":_=-A;break;case"top-left":case"bottom-left":_=A;break;case"left":_=g;break;case"right":_=-g}return[_,C]}(h,l[0])}function i4(h,l,d){var g;const _=h.layout,C=(g=_.get("text-variable-anchor-offset"))===null||g===void 0?void 0:g.evaluate(l,{},d);if(C){const M=C.values,L=[];for(let q=0;q<M.length;q+=2){const U=L[q]=M[q],H=M[q+1].map(Q=>Q*yi);U.startsWith("top")?H[1]-=7:U.startsWith("bottom")&&(H[1]+=7),L[q+1]=H}return new Zi(L)}const A=_.get("text-variable-anchor");if(A){let M;M=h._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[_.get("text-radial-offset").evaluate(l,{},d)*yi,vC]:_.get("text-offset").evaluate(l,{},d).map(q=>q*yi);const L=[];for(const q of A)L.push(q,s4(q,M));return new Zi(L)}return null}function _C(h){switch(h){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function cX(h,l,d,g,_,C,A,M,L,q,U,H){let Q=C.textMaxSize.evaluate(l,{});Q===void 0&&(Q=A);const ee=h.layers[0].layout,oe=ee.get("icon-offset").evaluate(l,{},U),fe=o4(d.horizontal),be=A/24,Pe=h.tilePixelRatio*be,Qe=h.tilePixelRatio*Q/24,De=h.tilePixelRatio*M,ze=h.tilePixelRatio*ee.get("symbol-spacing"),it=ee.get("text-padding")*h.tilePixelRatio,ft=function($r,Ar,dr,dn=1){const _s=$r.get("icon-padding").evaluate(Ar,{},dr),di=_s&&_s.values;return[di[0]*dn,di[1]*dn,di[2]*dn,di[3]*dn]}(ee,l,U,h.tilePixelRatio),Ct=ee.get("text-max-angle")/180*Math.PI,Vt=ee.get("text-rotation-alignment")!=="viewport"&&ee.get("symbol-placement")!=="point",It=ee.get("icon-rotation-alignment")==="map"&&ee.get("symbol-placement")!=="point",$t=ee.get("symbol-placement"),vr=ze/2,Ft=ee.get("icon-text-fit");let Bt;g&&Ft!=="none"&&(h.allowVerticalPlacement&&d.vertical&&(Bt=ER(g,d.vertical,Ft,ee.get("icon-text-fit-padding"),oe,be)),fe&&(g=ER(g,fe,Ft,ee.get("icon-text-fit-padding"),oe,be)));const _t=U?H.line.getGranularityForZoomLevel(U.z):1,Fr=($r,Ar)=>{Ar.x<0||Ar.x>=_e||Ar.y<0||Ar.y>=_e||function(dr,dn,_s,di,Ji,Mo,qa,Ri,hs,vi,Li,Fi,Na,Oo,_i,Va,hi,bi,ji,ni,es,Wl,ig,Gl,hX){const ag=dr.addToLineVertexArray(dn,_s);let Zf,og,lg,cg,d4=0,h4=0,f4=0,m4=0,AC=-1,kC=-1;const Iu={};let p4=ql("");if(dr.allowVerticalPlacement&&di.vertical){const ma=Ri.layout.get("text-rotate").evaluate(es,{},Gl)+90;lg=new _w(hs,dn,vi,Li,Fi,di.vertical,Na,Oo,_i,ma),qa&&(cg=new _w(hs,dn,vi,Li,Fi,qa,hi,bi,_i,ma))}if(Ji){const ma=Ri.layout.get("icon-rotate").evaluate(es,{}),Io=Ri.layout.get("icon-text-fit")!=="none",Yf=r4(Ji,ma,ig,Io),Hl=qa?r4(qa,ma,ig,Io):void 0;og=new _w(hs,dn,vi,Li,Fi,Ji,hi,bi,!1,ma),d4=4*Yf.length;const Xf=dr.iconSizeData;let Mc=null;Xf.kind==="source"?(Mc=[Ou*Ri.layout.get("icon-size").evaluate(es,{})],Mc[0]>Yd&&ar(`${dr.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Xf.kind==="composite"&&(Mc=[Ou*Wl.compositeIconSizes[0].evaluate(es,{},Gl),Ou*Wl.compositeIconSizes[1].evaluate(es,{},Gl)],(Mc[0]>Yd||Mc[1]>Yd)&&ar(`${dr.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),dr.addSymbols(dr.icon,Yf,Mc,ni,ji,es,u.as.none,dn,ag.lineStartIndex,ag.lineLength,-1,Gl),AC=dr.icon.placedSymbolArray.length-1,Hl&&(h4=4*Hl.length,dr.addSymbols(dr.icon,Hl,Mc,ni,ji,es,u.as.vertical,dn,ag.lineStartIndex,ag.lineLength,-1,Gl),kC=dr.icon.placedSymbolArray.length-1)}const g4=Object.keys(di.horizontal);for(const ma of g4){const Io=di.horizontal[ma];if(!Zf){p4=ql(Io.text);const Hl=Ri.layout.get("text-rotate").evaluate(es,{},Gl);Zf=new _w(hs,dn,vi,Li,Fi,Io,Na,Oo,_i,Hl)}const Yf=Io.positionedLines.length===1;if(f4+=a4(dr,dn,Io,Mo,Ri,_i,es,Va,ag,di.vertical?u.as.horizontal:u.as.horizontalOnly,Yf?g4:[ma],Iu,AC,Wl,Gl),Yf)break}di.vertical&&(m4+=a4(dr,dn,di.vertical,Mo,Ri,_i,es,Va,ag,u.as.vertical,["vertical"],Iu,kC,Wl,Gl));const fX=Zf?Zf.boxStartIndex:dr.collisionBoxArray.length,mX=Zf?Zf.boxEndIndex:dr.collisionBoxArray.length,pX=lg?lg.boxStartIndex:dr.collisionBoxArray.length,gX=lg?lg.boxEndIndex:dr.collisionBoxArray.length,xX=og?og.boxStartIndex:dr.collisionBoxArray.length,yX=og?og.boxEndIndex:dr.collisionBoxArray.length,vX=cg?cg.boxStartIndex:dr.collisionBoxArray.length,_X=cg?cg.boxEndIndex:dr.collisionBoxArray.length;let Kl=-1;const jw=(ma,Io)=>ma&&ma.circleDiameter?Math.max(ma.circleDiameter,Io):Io;Kl=jw(Zf,Kl),Kl=jw(lg,Kl),Kl=jw(og,Kl),Kl=jw(cg,Kl);const x4=Kl>-1?1:0;x4&&(Kl*=hX/yi),dr.glyphOffsetArray.length>=rg.MAX_GLYPHS&&ar("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),es.sortKey!==void 0&&dr.addToSortKeyRanges(dr.symbolInstances.length,es.sortKey);const bX=i4(Ri,es,Gl),[jX,wX]=function(ma,Io){const Yf=ma.length,Hl=Io==null?void 0:Io.values;if((Hl==null?void 0:Hl.length)>0)for(let Xf=0;Xf<Hl.length;Xf+=2){const Mc=Hl[Xf+1];ma.emplaceBack(u.aI[Hl[Xf]],Mc[0],Mc[1])}return[Yf,ma.length]}(dr.textAnchorOffsets,bX);dr.symbolInstances.emplaceBack(dn.x,dn.y,Iu.right>=0?Iu.right:-1,Iu.center>=0?Iu.center:-1,Iu.left>=0?Iu.left:-1,Iu.vertical||-1,AC,kC,p4,fX,mX,pX,gX,xX,yX,vX,_X,vi,f4,m4,d4,h4,x4,0,Na,Kl,jX,wX)}(h,Ar,$r,d,g,_,Bt,h.layers[0],h.collisionBoxArray,l.index,l.sourceLayerIndex,h.index,Pe,[it,it,it,it],Vt,L,De,ft,It,oe,l,C,q,U,A)};if($t==="line")for(const $r of YR(l.geometry,0,0,_e,_e)){const Ar=Kf($r,_t),dr=iX(Ar,ze,Ct,d.vertical||fe,g,24,Qe,h.overscaling,_e);for(const dn of dr)fe&&uX(h,fe.text,vr,dn)||Fr(Ar,dn)}else if($t==="line-center"){for(const $r of l.geometry)if($r.length>1){const Ar=Kf($r,_t),dr=sX(Ar,Ct,d.vertical||fe,g,24,Qe);dr&&Fr(Ar,dr)}}else if(l.type==="Polygon")for(const $r of yp(l.geometry,0)){const Ar=oX($r,16);Fr(Kf($r[0],_t,!0),new Qd(Ar.x,Ar.y,0))}else if(l.type==="LineString")for(const $r of l.geometry){const Ar=Kf($r,_t);Fr(Ar,new Qd(Ar[0].x,Ar[0].y,0))}else if(l.type==="Point")for(const $r of l.geometry)for(const Ar of $r)Fr([Ar],new Qd(Ar.x,Ar.y,0))}function a4(h,l,d,g,_,C,A,M,L,q,U,H,Q,ee,oe){const fe=function(Qe,De,ze,it,ft,Ct,Vt,It){const $t=it.layout.get("text-rotate").evaluate(Ct,{})*Math.PI/180,vr=[];for(const Ft of De.positionedLines)for(const Bt of Ft.positionedGlyphs){if(!Bt.rect)continue;const _t=Bt.rect||{};let Fr=4,$r=!0,Ar=1,dr=0;const dn=(ft||It)&&Bt.vertical,_s=Bt.metrics.advance*Bt.scale/2;if(It&&De.verticalizable&&(dr=Ft.lineOffset/2-(Bt.imageName?-(yi-Bt.metrics.width*Bt.scale)/2:(Bt.scale-1)*yi)),Bt.imageName){const bi=Vt[Bt.imageName];$r=bi.sdf,Ar=bi.pixelRatio,Fr=1/Ar}const di=ft?[Bt.x+_s,Bt.y]:[0,0];let Ji=ft?[0,0]:[Bt.x+_s+ze[0],Bt.y+ze[1]-dr],Mo=[0,0];dn&&(Mo=Ji,Ji=[0,0]);const qa=Bt.metrics.isDoubleResolution?2:1,Ri=(Bt.metrics.left-Fr)*Bt.scale-_s+Ji[0],hs=(-Bt.metrics.top-Fr)*Bt.scale+Ji[1],vi=Ri+_t.w/qa*Bt.scale/Ar,Li=hs+_t.h/qa*Bt.scale/Ar,Fi=new m(Ri,hs),Na=new m(vi,hs),Oo=new m(Ri,Li),_i=new m(vi,Li);if(dn){const bi=new m(-_s,_s- -17),ji=-Math.PI/2,ni=12-_s,es=new m(22-ni,-(Bt.imageName?ni:0)),Wl=new m(...Mo);Fi._rotateAround(ji,bi)._add(es)._add(Wl),Na._rotateAround(ji,bi)._add(es)._add(Wl),Oo._rotateAround(ji,bi)._add(es)._add(Wl),_i._rotateAround(ji,bi)._add(es)._add(Wl)}if($t){const bi=Math.sin($t),ji=Math.cos($t),ni=[ji,-bi,bi,ji];Fi._matMult(ni),Na._matMult(ni),Oo._matMult(ni),_i._matMult(ni)}const Va=new m(0,0),hi=new m(0,0);vr.push({tl:Fi,tr:Na,bl:Oo,br:_i,tex:_t,writingMode:De.writingMode,glyphOffset:di,sectionIndex:Bt.sectionIndex,isSDF:$r,pixelOffsetTL:Va,pixelOffsetBR:hi,minFontScaleX:0,minFontScaleY:0})}return vr}(0,d,M,_,C,A,g,h.allowVerticalPlacement),be=h.textSizeData;let Pe=null;be.kind==="source"?(Pe=[Ou*_.layout.get("text-size").evaluate(A,{})],Pe[0]>Yd&&ar(`${h.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):be.kind==="composite"&&(Pe=[Ou*ee.compositeTextSizes[0].evaluate(A,{},oe),Ou*ee.compositeTextSizes[1].evaluate(A,{},oe)],(Pe[0]>Yd||Pe[1]>Yd)&&ar(`${h.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),h.addSymbols(h.text,fe,Pe,M,C,A,q,l,L.lineStartIndex,L.lineLength,Q,oe);for(const Qe of U)H[Qe]=h.text.placedSymbolArray.length-1;return 4*fe.length}function o4(h){for(const l in h)return h[l];return null}function uX(h,l,d,g){const _=h.compareText;if(l in _){const C=_[l];for(let A=C.length-1;A>=0;A--)if(g.dist(C[A])<d)return!0}else _[l]=[];return _[l].push(g),!1}const l4=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class bC{static from(l){if(!(l instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[d,g]=new Uint8Array(l,0,2);if(d!==219)throw new Error("Data does not appear to be in a KDBush format.");const _=g>>4;if(_!==1)throw new Error(`Got v${_} data when expected v1.`);const C=l4[15&g];if(!C)throw new Error("Unrecognized array type.");const[A]=new Uint16Array(l,2,1),[M]=new Uint32Array(l,4,1);return new bC(M,A,C,l)}constructor(l,d=64,g=Float64Array,_){if(isNaN(l)||l<0)throw new Error(`Unpexpected numItems value: ${l}.`);this.numItems=+l,this.nodeSize=Math.min(Math.max(+d,2),65535),this.ArrayType=g,this.IndexArrayType=l<65536?Uint16Array:Uint32Array;const C=l4.indexOf(this.ArrayType),A=2*l*this.ArrayType.BYTES_PER_ELEMENT,M=l*this.IndexArrayType.BYTES_PER_ELEMENT,L=(8-M%8)%8;if(C<0)throw new Error(`Unexpected typed array class: ${g}.`);_&&_ instanceof ArrayBuffer?(this.data=_,this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+M+L,2*l),this._pos=2*l,this._finished=!0):(this.data=new ArrayBuffer(8+A+M+L),this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+M+L,2*l),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+C]),new Uint16Array(this.data,2,1)[0]=d,new Uint32Array(this.data,4,1)[0]=l)}add(l,d){const g=this._pos>>1;return this.ids[g]=g,this.coords[this._pos++]=l,this.coords[this._pos++]=d,g}finish(){const l=this._pos>>1;if(l!==this.numItems)throw new Error(`Added ${l} items when expected ${this.numItems}.`);return jC(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(l,d,g,_){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:C,coords:A,nodeSize:M}=this,L=[0,C.length-1,0],q=[];for(;L.length;){const U=L.pop()||0,H=L.pop()||0,Q=L.pop()||0;if(H-Q<=M){for(let be=Q;be<=H;be++){const Pe=A[2*be],Qe=A[2*be+1];Pe>=l&&Pe<=g&&Qe>=d&&Qe<=_&&q.push(C[be])}continue}const ee=Q+H>>1,oe=A[2*ee],fe=A[2*ee+1];oe>=l&&oe<=g&&fe>=d&&fe<=_&&q.push(C[ee]),(U===0?l<=oe:d<=fe)&&(L.push(Q),L.push(ee-1),L.push(1-U)),(U===0?g>=oe:_>=fe)&&(L.push(ee+1),L.push(H),L.push(1-U))}return q}within(l,d,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:C,nodeSize:A}=this,M=[0,_.length-1,0],L=[],q=g*g;for(;M.length;){const U=M.pop()||0,H=M.pop()||0,Q=M.pop()||0;if(H-Q<=A){for(let be=Q;be<=H;be++)u4(C[2*be],C[2*be+1],l,d)<=q&&L.push(_[be]);continue}const ee=Q+H>>1,oe=C[2*ee],fe=C[2*ee+1];u4(oe,fe,l,d)<=q&&L.push(_[ee]),(U===0?l-g<=oe:d-g<=fe)&&(M.push(Q),M.push(ee-1),M.push(1-U)),(U===0?l+g>=oe:d+g>=fe)&&(M.push(ee+1),M.push(H),M.push(1-U))}return L}}function jC(h,l,d,g,_,C){if(_-g<=d)return;const A=g+_>>1;c4(h,l,A,g,_,C),jC(h,l,d,g,A-1,1-C),jC(h,l,d,A+1,_,1-C)}function c4(h,l,d,g,_,C){for(;_>g;){if(_-g>600){const q=_-g+1,U=d-g+1,H=Math.log(q),Q=.5*Math.exp(2*H/3),ee=.5*Math.sqrt(H*Q*(q-Q)/q)*(U-q/2<0?-1:1);c4(h,l,d,Math.max(g,Math.floor(d-U*Q/q+ee)),Math.min(_,Math.floor(d+(q-U)*Q/q+ee)),C)}const A=l[2*d+C];let M=g,L=_;for(i_(h,l,g,d),l[2*_+C]>A&&i_(h,l,g,_);M<L;){for(i_(h,l,M,L),M++,L--;l[2*M+C]<A;)M++;for(;l[2*L+C]>A;)L--}l[2*g+C]===A?i_(h,l,g,L):(L++,i_(h,l,L,_)),L<=d&&(g=L+1),d<=L&&(_=L-1)}}function i_(h,l,d,g){wC(h,d,g),wC(l,2*d,2*g),wC(l,2*d+1,2*g+1)}function wC(h,l,d){const g=h[l];h[l]=h[d],h[d]=g}function u4(h,l,d,g){const _=h-d,C=l-g;return _*_+C*C}var SC;u.cA=void 0,(SC=u.cA||(u.cA={})).create="create",SC.load="load",SC.fullLoad="fullLoad";let bw=null,a_=[];const NC=1e3/60,PC="loadTime",CC="fullLoadTime",dX={mark(h){performance.mark(h)},frame(h){const l=h;bw!=null&&a_.push(l-bw),bw=l},clearMetrics(){bw=null,a_=[],performance.clearMeasures(PC),performance.clearMeasures(CC);for(const h in u.cA)performance.clearMarks(u.cA[h])},getPerformanceMetrics(){performance.measure(PC,u.cA.create,u.cA.load),performance.measure(CC,u.cA.create,u.cA.fullLoad);const h=performance.getEntriesByName(PC)[0].duration,l=performance.getEntriesByName(CC)[0].duration,d=a_.length,g=1/(a_.reduce((C,A)=>C+A,0)/d/1e3),_=a_.filter(C=>C>NC).reduce((C,A)=>C+(A-NC)/NC,0);return{loadTime:h,fullLoadTime:l,fps:g,percentDroppedFrames:_/(d+_)*100,totalFrames:d}}};u.$=rt,u.A=I,u.B=Ud,u.C=function([h,l,d]){return l+=90,l*=Math.PI/180,d*=Math.PI/180,{x:h*Math.cos(l)*Math.sin(d),y:h*Math.sin(l)*Math.sin(d),z:h*Math.cos(d)}},u.D=fr,u.E=or,u.F=io,u.G=Bn,u.H=zf,u.I=cC,u.J=vs,u.K=class{constructor(h,l){this.target=h,this.mapId=l,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new tX(()=>this.process()),this.subscription=Rt(this.target,"message",d=>this.receive(d),!1),this.globalScope=Lr(self)?h:window}registerMessageHandler(h,l){this.messageHandlers[h]=l}sendAsync(h,l){return new Promise((d,g)=>{const _=Math.round(1e18*Math.random()).toString(36).substring(0,10),C=l?Rt(l.signal,"abort",()=>{C==null||C.unsubscribe(),delete this.resolveRejects[_];const L={id:_,type:"<cancel>",origin:location.origin,targetMapId:h.targetMapId,sourceMapId:this.mapId};this.target.postMessage(L)},rX):null;this.resolveRejects[_]={resolve:L=>{C==null||C.unsubscribe(),d(L)},reject:L=>{C==null||C.unsubscribe(),g(L)}};const A=[],M=Object.assign(Object.assign({},h),{id:_,sourceMapId:this.mapId,origin:location.origin,data:zl(h.data,A)});this.target.postMessage(M,{transfer:A})})}receive(h){const l=h.data,d=l.id;if(!(l.origin!=="file://"&&location.origin!=="file://"&&l.origin!=="resource://android"&&location.origin!=="resource://android"&&l.origin!==location.origin||l.targetMapId&&this.mapId!==l.targetMapId)){if(l.type==="<cancel>"){delete this.tasks[d];const g=this.abortControllers[d];return delete this.abortControllers[d],void(g&&g.abort())}if(Lr(self)||l.mustQueue)return this.tasks[d]=l,this.taskQueue.push(d),void this.invoker.trigger();this.processTask(d,l)}}process(){if(this.taskQueue.length===0)return;const h=this.taskQueue.shift(),l=this.tasks[h];delete this.tasks[h],this.taskQueue.length>0&&this.invoker.trigger(),l&&this.processTask(h,l)}processTask(h,l){return a(this,void 0,void 0,function*(){if(l.type==="<response>"){const _=this.resolveRejects[h];return delete this.resolveRejects[h],_?void(l.error?_.reject($f(l.error)):_.resolve($f(l.data))):void 0}if(!this.messageHandlers[l.type])return void this.completeTask(h,new Error(`Could not find a registered handler for ${l.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const d=$f(l.data),g=new AbortController;this.abortControllers[h]=g;try{const _=yield this.messageHandlers[l.type](l.sourceMapId,d,g);this.completeTask(h,null,_)}catch(_){this.completeTask(h,_)}})}completeTask(h,l,d){const g=[];delete this.abortControllers[h];const _={id:h,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:l?zl(l):null,data:zl(d,g)};this.target.postMessage(_,{transfer:g})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},u.L=ye,u.M=function(){var h=new I(16);return I!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=0,h[12]=0,h[13]=0,h[14]=0),h[0]=1,h[5]=1,h[10]=1,h[15]=1,h},u.N=function(h,l,d){var g,_,C,A,M,L,q,U,H,Q,ee,oe,fe=d[0],be=d[1],Pe=d[2];return l===h?(h[12]=l[0]*fe+l[4]*be+l[8]*Pe+l[12],h[13]=l[1]*fe+l[5]*be+l[9]*Pe+l[13],h[14]=l[2]*fe+l[6]*be+l[10]*Pe+l[14],h[15]=l[3]*fe+l[7]*be+l[11]*Pe+l[15]):(_=l[1],C=l[2],A=l[3],M=l[4],L=l[5],q=l[6],U=l[7],H=l[8],Q=l[9],ee=l[10],oe=l[11],h[0]=g=l[0],h[1]=_,h[2]=C,h[3]=A,h[4]=M,h[5]=L,h[6]=q,h[7]=U,h[8]=H,h[9]=Q,h[10]=ee,h[11]=oe,h[12]=g*fe+M*be+H*Pe+l[12],h[13]=_*fe+L*be+Q*Pe+l[13],h[14]=C*fe+q*be+ee*Pe+l[14],h[15]=A*fe+U*be+oe*Pe+l[15]),h},u.O=function(h,l,d){var g=d[0],_=d[1],C=d[2];return h[0]=l[0]*g,h[1]=l[1]*g,h[2]=l[2]*g,h[3]=l[3]*g,h[4]=l[4]*_,h[5]=l[5]*_,h[6]=l[6]*_,h[7]=l[7]*_,h[8]=l[8]*C,h[9]=l[9]*C,h[10]=l[10]*C,h[11]=l[11]*C,h[12]=l[12],h[13]=l[13],h[14]=l[14],h[15]=l[15],h},u.P=m,u.Q=function(h,l,d){var g=l[0],_=l[1],C=l[2],A=l[3],M=l[4],L=l[5],q=l[6],U=l[7],H=l[8],Q=l[9],ee=l[10],oe=l[11],fe=l[12],be=l[13],Pe=l[14],Qe=l[15],De=d[0],ze=d[1],it=d[2],ft=d[3];return h[0]=De*g+ze*M+it*H+ft*fe,h[1]=De*_+ze*L+it*Q+ft*be,h[2]=De*C+ze*q+it*ee+ft*Pe,h[3]=De*A+ze*U+it*oe+ft*Qe,h[4]=(De=d[4])*g+(ze=d[5])*M+(it=d[6])*H+(ft=d[7])*fe,h[5]=De*_+ze*L+it*Q+ft*be,h[6]=De*C+ze*q+it*ee+ft*Pe,h[7]=De*A+ze*U+it*oe+ft*Qe,h[8]=(De=d[8])*g+(ze=d[9])*M+(it=d[10])*H+(ft=d[11])*fe,h[9]=De*_+ze*L+it*Q+ft*be,h[10]=De*C+ze*q+it*ee+ft*Pe,h[11]=De*A+ze*U+it*oe+ft*Qe,h[12]=(De=d[12])*g+(ze=d[13])*M+(it=d[14])*H+(ft=d[15])*fe,h[13]=De*_+ze*L+it*Q+ft*be,h[14]=De*C+ze*q+it*ee+ft*Pe,h[15]=De*A+ze*U+it*oe+ft*Qe,h},u.R=Ba,u.S=function(h,l){const d={};for(let g=0;g<l.length;g++){const _=l[g];_ in h&&(d[_]=h[_])}return d},u.T=JP,u.U=Xd,u.V=Mt,u.W=$R,u.X=zR,u.Y=D,u.Z=O,u._=a,u.a=ce,u.a$=function(h,l,d){return h[0]=l[0]*d[0],h[1]=l[1]*d[1],h[2]=l[2]*d[2],h[3]=l[3]*d[3],h},u.a0=Eo,u.a1=qR,u.a2=gw,u.a3=_e,u.a4=function(h,l){var d,g,_,C,A;if(!h)return l??{};if(!l)return h;let M=Object.assign({},h);if(l.removeAll&&(M={removeAll:!0}),l.remove){const L=new Set(l.remove);M.add&&(M.add=M.add.filter(U=>!L.has(U.id))),M.update&&(M.update=M.update.filter(U=>!L.has(U.id)));const q=new Set(((d=h.add)!==null&&d!==void 0?d:[]).map(U=>U.id));l.remove=l.remove.filter(U=>!q.has(U))}if(l.remove){const L=new Set(M.remove?M.remove.concat(l.remove):l.remove);M.remove=Array.from(L.values())}if(l.add){const L=M.add?M.add.concat(l.add):l.add,q=new Map(L.map(U=>[U.id,U]));M.add=Array.from(q.values())}if(l.update){const L=new Map((g=M.update)===null||g===void 0?void 0:g.map(q=>[q.id,q]));for(const q of l.update){const U=(_=L.get(q.id))!==null&&_!==void 0?_:{id:q.id};q.newGeometry&&(U.newGeometry=q.newGeometry),q.addOrUpdateProperties&&(U.addOrUpdateProperties=((C=U.addOrUpdateProperties)!==null&&C!==void 0?C:[]).concat(q.addOrUpdateProperties)),q.removeProperties&&(U.removeProperties=((A=U.removeProperties)!==null&&A!==void 0?A:[]).concat(q.removeProperties)),q.removeAllProperties&&(U.removeAllProperties=!0),L.set(q.id,U)}M.update=Array.from(L.values())}return M.remove&&M.add&&(M.remove=M.remove.filter(L=>M.add.findIndex(q=>q.id===L)===-1)),M},u.a5=n_,u.a6=Hf,u.a7=25,u.a8=yC,u.a9=h=>{const l=window.document.createElement("video");return l.muted=!0,new Promise(d=>{l.onloadstart=()=>{d(l)};for(const g of h){const _=window.document.createElement("source");nt(g)||(l.crossOrigin="Anonymous"),_.src=g,l.appendChild(_)}})},u.aA=Me,u.aB=function(h,l,d,g){const _=l.y-h.y,C=l.x-h.x,A=g.y-d.y,M=g.x-d.x,L=A*C-M*_;if(L===0)return null;const q=(M*(h.y-d.y)-A*(h.x-d.x))/L;return new m(h.x+q*C,h.y+q*_)},u.aC=YR,u.aD=zD,u.aE=function(h){let l=1/0,d=1/0,g=-1/0,_=-1/0;for(const C of h)l=Math.min(l,C.x),d=Math.min(d,C.y),g=Math.max(g,C.x),_=Math.max(_,C.y);return[l,d,g,_]},u.aF=yi,u.aG=tt,u.aH=function(h,l,d,g,_=!1){if(!d[0]&&!d[1])return[0,0];const C=_?g==="map"?-h.bearingInRadians:0:g==="viewport"?h.bearingInRadians:0;if(C){const A=Math.sin(C),M=Math.cos(C);d=[d[0]*M-d[1]*A,d[0]*A+d[1]*M]}return[_?d[0]:tt(l,d[0],h.zoom),_?d[1]:tt(l,d[1],h.zoom)]},u.aJ=hC,u.aK=_C,u.aL=dC,u.aM=bC,u.aN=Ms,u.aO=uw,u.aP=Ee,u.aQ=Hr,u.aR=bt,u.aS=tr,u.aT=VR,u.aU=ve,u.aV=X,u.aW=function(h){var l=new I(3);return l[0]=h[0],l[1]=h[1],l[2]=h[2],l},u.aX=function(h,l,d){return h[0]=l[0]-d[0],h[1]=l[1]-d[1],h[2]=l[2]-d[2],h},u.aY=function(h,l){var d=l[0],g=l[1],_=l[2],C=d*d+g*g+_*_;return C>0&&(C=1/Math.sqrt(C)),h[0]=l[0]*C,h[1]=l[1]*C,h[2]=l[2]*C,h},u.aZ=ae,u.a_=function(h,l){return h[0]*l[0]+h[1]*l[1]+h[2]*l[2]},u.aa=wt,u.ab=function(){return Nt++},u.ac=F,u.ad=rg,u.ae=Df,u.af=Ec,u.ag=KR,u.ah=function(h){const l={};if(h.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(d,g,_,C)=>{const A=_||C;return l[g]=!A||A.toLowerCase(),""}),l["max-age"]){const d=parseInt(l["max-age"],10);isNaN(d)?delete l["max-age"]:l["max-age"]=d}return l},u.ai=Pr,u.aj=85.051129,u.ak=Ot,u.al=function(h){return Math.pow(2,h)},u.am=$,u.an=BR,u.ao=function(h){return Math.log(h)/Math.LN2},u.ap=function(h){var l=h[0],d=h[1];return l*l+d*d},u.aq=function(h){if(!h.length)return new Set;const l=Math.max(...h.map(L=>L.canonical.z));let d=1/0,g=-1/0,_=1/0,C=-1/0;const A=[];for(const L of h){const{x:q,y:U,z:H}=L.canonical,Q=Math.pow(2,l-H),ee=q*Q,oe=U*Q;A.push({id:L,x:ee,y:oe}),ee<d&&(d=ee),ee>g&&(g=ee),oe<_&&(_=oe),oe>C&&(C=oe)}const M=new Set;for(const L of A)L.x!==d&&L.x!==g&&L.y!==_&&L.y!==C||M.add(L.id);return M},u.ar=function(h,l){let d=0,g=0;if(h.kind==="constant")g=h.layoutSize;else if(h.kind!=="source"){const{interpolationType:_,minZoom:C,maxZoom:A}=h,M=_?Pr(Mn.interpolationFactor(_,l,C,A),0,1):0;h.kind==="camera"?g=io.number(h.minSize,h.maxSize,M):d=M}return{uSizeT:d,uSize:g}},u.at=function(h,{uSize:l,uSizeT:d},{lowerSize:g,upperSize:_}){return h.kind==="source"?g/Ou:h.kind==="composite"?io.number(g/Ou,_/Ou,d):l},u.au=function(h,l){var d=l[0],g=l[1],_=l[2],C=l[3],A=l[4],M=l[5],L=l[6],q=l[7],U=l[8],H=l[9],Q=l[10],ee=l[11],oe=l[12],fe=l[13],be=l[14],Pe=l[15],Qe=d*M-g*A,De=d*L-_*A,ze=d*q-C*A,it=g*L-_*M,ft=g*q-C*M,Ct=_*q-C*L,Vt=U*fe-H*oe,It=U*be-Q*oe,$t=U*Pe-ee*oe,vr=H*be-Q*fe,Ft=H*Pe-ee*fe,Bt=Q*Pe-ee*be,_t=Qe*Bt-De*Ft+ze*vr+it*$t-ft*It+Ct*Vt;return _t?(h[0]=(M*Bt-L*Ft+q*vr)*(_t=1/_t),h[1]=(_*Ft-g*Bt-C*vr)*_t,h[2]=(fe*Ct-be*ft+Pe*it)*_t,h[3]=(Q*ft-H*Ct-ee*it)*_t,h[4]=(L*$t-A*Bt-q*It)*_t,h[5]=(d*Bt-_*$t+C*It)*_t,h[6]=(be*ze-oe*Ct-Pe*De)*_t,h[7]=(U*Ct-Q*ze+ee*De)*_t,h[8]=(A*Ft-M*$t+q*Vt)*_t,h[9]=(g*$t-d*Ft-C*Vt)*_t,h[10]=(oe*ft-fe*ze+Pe*Qe)*_t,h[11]=(H*ze-U*ft-ee*Qe)*_t,h[12]=(M*It-A*vr-L*Vt)*_t,h[13]=(d*vr-g*It+_*Vt)*_t,h[14]=(fe*De-oe*it-be*Qe)*_t,h[15]=(U*it-H*De+Q*Qe)*_t,h):null},u.av=et,u.aw=function(h){var l=h[0],d=h[1];return Math.sqrt(l*l+d*d)},u.ax=function(h){return h[0]=0,h[1]=0,h},u.ay=function(h,l,d){return h[0]=l[0]*d,h[1]=l[1]*d,h},u.az=fC,u.b=Wn,u.b$=function(h,l,d){var g=l[0],_=l[1],C=l[2];return h[0]=g*d[0]+_*d[3]+C*d[6],h[1]=g*d[1]+_*d[4]+C*d[7],h[2]=g*d[2]+_*d[5]+C*d[8],h},u.b0=K,u.b1=function(h,l,d){const g=l[0]*d[0]+l[1]*d[1]+l[2]*d[2];return g===0?null:(-(h[0]*d[0]+h[1]*d[1]+h[2]*d[2])-d[3])/g},u.b2=Oe,u.b3=function(h,l,d){return h[0]=l[0]*d,h[1]=l[1]*d,h[2]=l[2]*d,h[3]=l[3]*d,h},u.b4=function(h,l){return h[0]*l[0]+h[1]*l[1]+h[2]*l[2]+h[3]},u.b5=WR,u.b6=ng,u.b7=function(h,l,d,g,_){var C=1/Math.tan(l/2);if(h[0]=C/d,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=C,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=-1,h[12]=0,h[13]=0,h[15]=0,_!=null&&_!==1/0){var A=1/(g-_);h[10]=(_+g)*A,h[14]=2*_*g*A}else h[10]=-1,h[14]=-2*g;return h},u.b8=function(h){var l=new I(16);return l[0]=h[0],l[1]=h[1],l[2]=h[2],l[3]=h[3],l[4]=h[4],l[5]=h[5],l[6]=h[6],l[7]=h[7],l[8]=h[8],l[9]=h[9],l[10]=h[10],l[11]=h[11],l[12]=h[12],l[13]=h[13],l[14]=h[14],l[15]=h[15],l},u.b9=function(h,l,d){var g=Math.sin(d),_=Math.cos(d),C=l[0],A=l[1],M=l[2],L=l[3],q=l[4],U=l[5],H=l[6],Q=l[7];return l!==h&&(h[8]=l[8],h[9]=l[9],h[10]=l[10],h[11]=l[11],h[12]=l[12],h[13]=l[13],h[14]=l[14],h[15]=l[15]),h[0]=C*_+q*g,h[1]=A*_+U*g,h[2]=M*_+H*g,h[3]=L*_+Q*g,h[4]=q*_-C*g,h[5]=U*_-A*g,h[6]=H*_-M*g,h[7]=Q*_-L*g,h},u.bA=function(h,l,d,g){var _=[],C=[];return _[0]=l[0]-d[0],_[1]=l[1]-d[1],_[2]=l[2]-d[2],C[0]=_[0],C[1]=_[1]*Math.cos(g)-_[2]*Math.sin(g),C[2]=_[1]*Math.sin(g)+_[2]*Math.cos(g),h[0]=C[0]+d[0],h[1]=C[1]+d[1],h[2]=C[2]+d[2],h},u.bB=function(h,l,d,g){var _=[],C=[];return _[0]=l[0]-d[0],_[1]=l[1]-d[1],_[2]=l[2]-d[2],C[0]=_[2]*Math.sin(g)+_[0]*Math.cos(g),C[1]=_[1],C[2]=_[2]*Math.cos(g)-_[0]*Math.sin(g),h[0]=C[0]+d[0],h[1]=C[1]+d[1],h[2]=C[2]+d[2],h},u.bC=function(h,l,d){var g=Math.sin(d),_=Math.cos(d),C=l[0],A=l[1],M=l[2],L=l[3],q=l[8],U=l[9],H=l[10],Q=l[11];return l!==h&&(h[4]=l[4],h[5]=l[5],h[6]=l[6],h[7]=l[7],h[12]=l[12],h[13]=l[13],h[14]=l[14],h[15]=l[15]),h[0]=C*_-q*g,h[1]=A*_-U*g,h[2]=M*_-H*g,h[3]=L*_-Q*g,h[8]=C*g+q*_,h[9]=A*g+U*_,h[10]=M*g+H*_,h[11]=L*g+Q*_,h},u.bD=function(h,l){const d=vt(h,360),g=vt(l,360),_=g-d,C=g>d?_-360:_+360;return Math.abs(_)<Math.abs(C)?_:C},u.bE=function(h){return h[0]=0,h[1]=0,h[2]=0,h},u.bF=function(h,l,d,g){const _=Math.sqrt(h*h+l*l),C=Math.sqrt(d*d+g*g);h/=_,l/=_,d/=C,g/=C;const A=Math.acos(h*d+l*g);return-l*d+h*g>0?A:-A},u.bG=function(h,l){const d=vt(h,2*Math.PI),g=vt(l,2*Math.PI);return Math.min(Math.abs(d-g),Math.abs(d-g+2*Math.PI),Math.abs(d-g-2*Math.PI))},u.bH=function(){const h={},l=Je.$version;for(const d in Je.$root){const g=Je.$root[d];if(g.required){let _=null;_=d==="version"?l:g.type==="array"?[]:{},_!=null&&(h[d]=_)}}return h},u.bI=Ev,u.bJ=Fe,u.bK=function h(l,d){if(Array.isArray(l)){if(!Array.isArray(d)||l.length!==d.length)return!1;for(let g=0;g<l.length;g++)if(!h(l[g],d[g]))return!1;return!0}if(typeof l=="object"&&l!==null&&d!==null){if(typeof d!="object"||Object.keys(l).length!==Object.keys(d).length)return!1;for(const g in l)if(!h(l[g],d[g]))return!1;return!0}return l===d},u.bL=function(h){h=h.slice();const l=Object.create(null);for(let d=0;d<h.length;d++)l[h[d].id]=h[d];for(let d=0;d<h.length;d++)"ref"in h[d]&&(h[d]=hr(h[d],l[h[d].ref]));return h},u.bM=function(h,l){if(h.type==="custom")return new eX(h,l);switch(h.type){case"background":return new JY(h,l);case"circle":return new FZ(h,l);case"color-relief":return new UZ(h,l);case"fill":return new iY(h,l);case"fill-extrusion":return new gY(h,l);case"heatmap":return new $Z(h,l);case"hillshade":return new qZ(h,l);case"line":return new wY(h,l);case"raster":return new UP(h,l);case"symbol":return new pw(h,l)}},u.bN=h=>h.type==="raster",u.bO=mt,u.bP=function(h,l){if(!h)return[{command:"setStyle",args:[l]}];let d=[];try{if(!zt(h.version,l.version))return[{command:"setStyle",args:[l]}];zt(h.center,l.center)||d.push({command:"setCenter",args:[l.center]}),zt(h.state,l.state)||d.push({command:"setGlobalState",args:[l.state]}),zt(h.centerAltitude,l.centerAltitude)||d.push({command:"setCenterAltitude",args:[l.centerAltitude]}),zt(h.zoom,l.zoom)||d.push({command:"setZoom",args:[l.zoom]}),zt(h.bearing,l.bearing)||d.push({command:"setBearing",args:[l.bearing]}),zt(h.pitch,l.pitch)||d.push({command:"setPitch",args:[l.pitch]}),zt(h.roll,l.roll)||d.push({command:"setRoll",args:[l.roll]}),zt(h.sprite,l.sprite)||d.push({command:"setSprite",args:[l.sprite]}),zt(h.glyphs,l.glyphs)||d.push({command:"setGlyphs",args:[l.glyphs]}),zt(h.transition,l.transition)||d.push({command:"setTransition",args:[l.transition]}),zt(h.light,l.light)||d.push({command:"setLight",args:[l.light]}),zt(h.terrain,l.terrain)||d.push({command:"setTerrain",args:[l.terrain]}),zt(h.sky,l.sky)||d.push({command:"setSky",args:[l.sky]}),zt(h.projection,l.projection)||d.push({command:"setProjection",args:[l.projection]});const g={},_=[];(function(A,M,L,q){let U;for(U in M=M||{},A=A||{})Object.prototype.hasOwnProperty.call(A,U)&&(Object.prototype.hasOwnProperty.call(M,U)||Nn(U,L,q));for(U in M)Object.prototype.hasOwnProperty.call(M,U)&&(Object.prototype.hasOwnProperty.call(A,U)?zt(A[U],M[U])||(A[U].type==="geojson"&&M[U].type==="geojson"&&kn(A,M,U)?pr(L,{command:"setGeoJSONSourceData",args:[U,M[U].data]}):Gn(U,M,L,q)):ln(U,M,L))})(h.sources,l.sources,_,g);const C=[];h.layers&&h.layers.forEach(A=>{"source"in A&&g[A.source]?d.push({command:"removeLayer",args:[A.id]}):C.push(A)}),d=d.concat(_),function(A,M,L){M=M||[];const q=(A=A||[]).map(Pn),U=M.map(Pn),H=A.reduce(ui,{}),Q=M.reduce(ui,{}),ee=q.slice(),oe=Object.create(null);let fe,be,Pe,Qe,De;for(let ze=0,it=0;ze<q.length;ze++)fe=q[ze],Object.prototype.hasOwnProperty.call(Q,fe)?it++:(pr(L,{command:"removeLayer",args:[fe]}),ee.splice(ee.indexOf(fe,it),1));for(let ze=0,it=0;ze<U.length;ze++)fe=U[U.length-1-ze],ee[ee.length-1-ze]!==fe&&(Object.prototype.hasOwnProperty.call(H,fe)?(pr(L,{command:"removeLayer",args:[fe]}),ee.splice(ee.lastIndexOf(fe,ee.length-it),1)):it++,Qe=ee[ee.length-ze],pr(L,{command:"addLayer",args:[Q[fe],Qe]}),ee.splice(ee.length-ze,0,fe),oe[fe]=!0);for(let ze=0;ze<U.length;ze++)if(fe=U[ze],be=H[fe],Pe=Q[fe],!oe[fe]&&!zt(be,Pe))if(zt(be.source,Pe.source)&&zt(be["source-layer"],Pe["source-layer"])&&zt(be.type,Pe.type)){for(De in Tn(be.layout,Pe.layout,L,fe,null,"setLayoutProperty"),Tn(be.paint,Pe.paint,L,fe,null,"setPaintProperty"),zt(be.filter,Pe.filter)||pr(L,{command:"setFilter",args:[fe,Pe.filter]}),zt(be.minzoom,Pe.minzoom)&&zt(be.maxzoom,Pe.maxzoom)||pr(L,{command:"setLayerZoomRange",args:[fe,Pe.minzoom,Pe.maxzoom]}),be)Object.prototype.hasOwnProperty.call(be,De)&&De!=="layout"&&De!=="paint"&&De!=="filter"&&De!=="metadata"&&De!=="minzoom"&&De!=="maxzoom"&&(De.indexOf("paint.")===0?Tn(be[De],Pe[De],L,fe,De.slice(6),"setPaintProperty"):zt(be[De],Pe[De])||pr(L,{command:"setLayerProperty",args:[fe,De,Pe[De]]}));for(De in Pe)Object.prototype.hasOwnProperty.call(Pe,De)&&!Object.prototype.hasOwnProperty.call(be,De)&&De!=="layout"&&De!=="paint"&&De!=="filter"&&De!=="metadata"&&De!=="minzoom"&&De!=="maxzoom"&&(De.indexOf("paint.")===0?Tn(be[De],Pe[De],L,fe,De.slice(6),"setPaintProperty"):zt(be[De],Pe[De])||pr(L,{command:"setLayerProperty",args:[fe,De,Pe[De]]}))}else pr(L,{command:"removeLayer",args:[fe]}),Qe=ee[ee.lastIndexOf(fe)+1],pr(L,{command:"addLayer",args:[Pe,Qe]})}(C,l.layers,d)}catch(g){console.warn("Unable to compute style diff:",g),d=[{command:"setStyle",args:[l]}]}return d},u.bQ=function(h){const l=[],d=h.id;return d===void 0&&l.push({message:`layers.${d}: missing required property "id"`}),h.render===void 0&&l.push({message:`layers.${d}: missing required method "render"`}),h.renderingMode&&h.renderingMode!=="2d"&&h.renderingMode!=="3d"&&l.push({message:`layers.${d}: property "renderingMode" must be either "2d" or "3d"`}),l},u.bR=Wt,u.bS=Zt,u.bT=class extends Sa{constructor(h,l){super(h,l),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}},u.bU=kc,u.bV=class extends Sa{constructor(h,l){super(h,l),this.current=Wf}set(h){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let l=1;l<16;l++)if(h[l]!==this.current[l]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}},u.bW=Vl,u.bX=class extends Sa{constructor(h,l){super(h,l),this.current=[0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2]))}},u.bY=class extends Sa{constructor(h,l){super(h,l),this.current=[0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1]))}},u.bZ=z,u.b_=function(h,l){var d=Math.sin(l),g=Math.cos(l);return h[0]=g,h[1]=d,h[2]=0,h[3]=-d,h[4]=g,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},u.ba=function(h,l,d){var g=Math.sin(d),_=Math.cos(d),C=l[4],A=l[5],M=l[6],L=l[7],q=l[8],U=l[9],H=l[10],Q=l[11];return l!==h&&(h[0]=l[0],h[1]=l[1],h[2]=l[2],h[3]=l[3],h[12]=l[12],h[13]=l[13],h[14]=l[14],h[15]=l[15]),h[4]=C*_+q*g,h[5]=A*_+U*g,h[6]=M*_+H*g,h[7]=L*_+Q*g,h[8]=q*_-C*g,h[9]=U*_-A*g,h[10]=H*_-M*g,h[11]=Q*_-L*g,h},u.bb=function(){const h=new Float32Array(16);return $(h),h},u.bc=function(){const h=new Float64Array(16);return $(h),h},u.bd=function(){return new Float64Array(16)},u.be=function(h,l,d){const g=new Float64Array(4);return Ve(g,h,l-90,d),g},u.bf=function(h,l,d,g){var _,C,A,M,L,q=l[0],U=l[1],H=l[2],Q=l[3],ee=d[0],oe=d[1],fe=d[2],be=d[3];return(C=q*ee+U*oe+H*fe+Q*be)<0&&(C=-C,ee=-ee,oe=-oe,fe=-fe,be=-be),1-C>T?(_=Math.acos(C),A=Math.sin(_),M=Math.sin((1-g)*_)/A,L=Math.sin(g*_)/A):(M=1-g,L=g),h[0]=M*q+L*ee,h[1]=M*U+L*oe,h[2]=M*H+L*fe,h[3]=M*Q+L*be,h},u.bg=function(h){const l=new Float64Array(9);var d,g,_,C,A,M,L,q,U,H,Q,ee,oe,fe,be,Pe,Qe,De;H=(_=(g=h)[0])*(L=_+_),Q=(C=g[1])*L,oe=(A=g[2])*L,fe=A*(q=C+C),Pe=(M=g[3])*L,Qe=M*q,De=M*(U=A+A),(d=l)[0]=1-(ee=C*q)-(be=A*U),d[3]=Q-De,d[6]=oe+Qe,d[1]=Q+De,d[4]=1-H-be,d[7]=fe-Pe,d[2]=oe-Qe,d[5]=fe+Pe,d[8]=1-H-ee;const ze=tr(-Math.asin(Pr(l[2],-1,1)));let it,ft;return Math.hypot(l[5],l[8])<.001?(it=0,ft=-tr(Math.atan2(l[3],l[4]))):(it=tr(l[5]===0&&l[8]===0?0:Math.atan2(l[5],l[8])),ft=tr(l[1]===0&&l[0]===0?0:Math.atan2(l[1],l[0]))),{roll:it,pitch:ze+90,bearing:ft}},u.bh=function(h,l){return h.roll==l.roll&&h.pitch==l.pitch&&h.bearing==l.bearing},u.bi=Ur,u.bj=fa,u.bk=Qp,u.bl=Xv,u.bm=Xp,u.bn=gt,u.bo=Tt,u.bp=$a,u.bq=function(h,l,d,g,_){return gt(g,_,Pr((h-l)/(d-l),0,1))},u.br=vt,u.bs=function(){return new Float64Array(3)},u.bt=function(h,l,d,g){return h[0]=l[0]+d[0]*g,h[1]=l[1]+d[1]*g,h[2]=l[2]+d[2]*g,h},u.bu=Ve,u.bv=function(h,l,d){var g=d[0],_=d[1],C=d[2],A=d[3],M=l[0],L=l[1],q=l[2],U=_*q-C*L,H=C*M-g*q,Q=g*L-_*M;return h[0]=M+A*(U+=U)+_*(Q+=Q)-C*(H+=H),h[1]=L+A*H+C*U-g*Q,h[2]=q+A*Q+g*H-_*U,h},u.bw=function(h,l,d){const g=(_=[h[0],h[1],h[2],l[0],l[1],l[2],d[0],d[1],d[2]])[0]*((U=_[8])*(A=_[4])-(M=_[5])*(q=_[7]))+_[1]*(-U*(C=_[3])+M*(L=_[6]))+_[2]*(q*C-A*L);var _,C,A,M,L,q,U;if(g===0)return null;const H=ae([],[l[0],l[1],l[2]],[d[0],d[1],d[2]]),Q=ae([],[d[0],d[1],d[2]],[h[0],h[1],h[2]]),ee=ae([],[h[0],h[1],h[2]],[l[0],l[1],l[2]]),oe=ve([],H,-h[3]);return X(oe,oe,ve([],Q,-l[3])),X(oe,oe,ve([],ee,-d[3])),ve(oe,oe,1/g),oe},u.bx=xC,u.by=function(){return new Float64Array(4)},u.bz=function(h,l,d,g){var _=[],C=[];return _[0]=l[0]-d[0],_[1]=l[1]-d[1],_[2]=l[2]-d[2],C[0]=_[0]*Math.cos(g)-_[1]*Math.sin(g),C[1]=_[0]*Math.sin(g)+_[1]*Math.cos(g),C[2]=_[2],h[0]=C[0]+d[0],h[1]=C[1]+d[1],h[2]=C[2]+d[2],h},u.c=Ue,u.c0=function(h,l,d,g,_,C,A){var M=1/(l-d),L=1/(g-_),q=1/(C-A);return h[0]=-2*M,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=-2*L,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=2*q,h[11]=0,h[12]=(l+d)*M,h[13]=(_+g)*L,h[14]=(A+C)*q,h[15]=1,h},u.c1=class extends Sa{constructor(h,l){super(h,l),this.current=new Array}set(h){if(h!=this.current){this.current=h;const l=new Float32Array(4*h.length);for(let d=0;d<h.length;d++)l[4*d]=h[d].r,l[4*d+1]=h[d].g,l[4*d+2]=h[d].b,l[4*d+3]=h[d].a;this.gl.uniform4fv(this.location,l)}}},u.c2=class extends Sa{constructor(h,l){super(h,l),this.current=new Array}set(h){if(h!=this.current){this.current=h;const l=new Float32Array(h);this.gl.uniform1fv(this.location,l)}}},u.c3=class extends Cu{},u.c4=CY,u.c5=class extends Up{},u.c6=QP,u.c7=function(h){return h<=1?1:Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))},u.c8=ZD,u.c9=function(h,l,d){var g=l[0],_=l[1],C=l[2],A=d[3]*g+d[7]*_+d[11]*C+d[15];return h[0]=(d[0]*g+d[4]*_+d[8]*C+d[12])/(A=A||1),h[1]=(d[1]*g+d[5]*_+d[9]*C+d[13])/A,h[2]=(d[2]*g+d[6]*_+d[10]*C+d[14])/A,h},u.cB=function(h){return h.message===ks},u.cC=Ae,u.cD=function(h,l){ce.REGISTERED_PROTOCOLS[h]=l},u.cE=function(h){delete ce.REGISTERED_PROTOCOLS[h]},u.cF=function(h,l){const d={};for(let _=0;_<h.length;_++){const C=l&&l[h[_].id]||Tj(h[_]);l&&(l[h[_].id]=C);let A=d[C];A||(A=d[C]=[]),A.push(h[_])}const g=[];for(const _ in d)g.push(d[_]);return g},u.cG=Kt,u.cH=GR,u.cI=HR,u.cJ=SR,u.cK=function(h){h.bucket.createArrays(),h.bucket.tilePixelRatio=_e/(512*h.bucket.overscaling),h.bucket.compareText={},h.bucket.iconsNeedLinear=!1;const l=h.bucket.layers[0],d=l.layout,g=l._unevaluatedLayout._values,_={layoutIconSize:g["icon-size"].possiblyEvaluate(new Bn(h.bucket.zoom+1),h.canonical),layoutTextSize:g["text-size"].possiblyEvaluate(new Bn(h.bucket.zoom+1),h.canonical),textMaxSize:g["text-size"].possiblyEvaluate(new Bn(18))};if(h.bucket.textSizeData.kind==="composite"){const{minZoom:q,maxZoom:U}=h.bucket.textSizeData;_.compositeTextSizes=[g["text-size"].possiblyEvaluate(new Bn(q),h.canonical),g["text-size"].possiblyEvaluate(new Bn(U),h.canonical)]}if(h.bucket.iconSizeData.kind==="composite"){const{minZoom:q,maxZoom:U}=h.bucket.iconSizeData;_.compositeIconSizes=[g["icon-size"].possiblyEvaluate(new Bn(q),h.canonical),g["icon-size"].possiblyEvaluate(new Bn(U),h.canonical)]}const C=d.get("text-line-height")*yi,A=d.get("text-rotation-alignment")!=="viewport"&&d.get("symbol-placement")!=="point",M=d.get("text-keep-upright"),L=d.get("text-size");for(const q of h.bucket.features){const U=d.get("text-font").evaluate(q,{},h.canonical).join(","),H=L.evaluate(q,{},h.canonical),Q=_.layoutTextSize.evaluate(q,{},h.canonical),ee=_.layoutIconSize.evaluate(q,{},h.canonical),oe={horizontal:{},vertical:void 0},fe=q.text;let be,Pe=[0,0];if(fe){const ze=fe.toString(),it=d.get("text-letter-spacing").evaluate(q,{},h.canonical)*yi,ft=Ov(ze)?it:0,Ct=d.get("text-anchor").evaluate(q,{},h.canonical),Vt=i4(l,q,h.canonical);if(!Vt){const Ft=d.get("text-radial-offset").evaluate(q,{},h.canonical);Pe=Ft?s4(Ct,[Ft*yi,vC]):d.get("text-offset").evaluate(q,{},h.canonical).map(Bt=>Bt*yi)}let It=A?"center":d.get("text-justify").evaluate(q,{},h.canonical);const $t=d.get("symbol-placement")==="point"?d.get("text-max-width").evaluate(q,{},h.canonical)*yi:1/0,vr=()=>{h.bucket.allowVerticalPlacement&&Mv(ze)&&(oe.vertical=hw(fe,h.glyphMap,h.glyphPositions,h.imagePositions,U,$t,C,Ct,"left",ft,Pe,u.as.vertical,!0,Q,H))};if(!A&&Vt){const Ft=new Set;if(It==="auto")for(let _t=0;_t<Vt.values.length;_t+=2)Ft.add(_C(Vt.values[_t]));else Ft.add(It);let Bt=!1;for(const _t of Ft)if(!oe.horizontal[_t])if(Bt)oe.horizontal[_t]=oe.horizontal[0];else{const Fr=hw(fe,h.glyphMap,h.glyphPositions,h.imagePositions,U,$t,C,"center",_t,ft,Pe,u.as.horizontal,!1,Q,H);Fr&&(oe.horizontal[_t]=Fr,Bt=Fr.positionedLines.length===1)}vr()}else{It==="auto"&&(It=_C(Ct));const Ft=hw(fe,h.glyphMap,h.glyphPositions,h.imagePositions,U,$t,C,Ct,It,ft,Pe,u.as.horizontal,!1,Q,H);Ft&&(oe.horizontal[It]=Ft),vr(),Mv(ze)&&A&&M&&(oe.vertical=hw(fe,h.glyphMap,h.glyphPositions,h.imagePositions,U,$t,C,Ct,It,ft,Pe,u.as.vertical,!1,Q,H))}}let Qe=!1;if(q.icon&&q.icon.name){const ze=h.imageMap[q.icon.name];ze&&(be=ZY(h.imagePositions[q.icon.name],d.get("icon-offset").evaluate(q,{},h.canonical),d.get("icon-anchor").evaluate(q,{},h.canonical)),Qe=!!ze.sdf,h.bucket.sdfIcons===void 0?h.bucket.sdfIcons=Qe:h.bucket.sdfIcons!==Qe&&ar("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ze.pixelRatio!==h.bucket.pixelRatio||d.get("icon-rotate").constantOr(1)!==0)&&(h.bucket.iconsNeedLinear=!0))}const De=o4(oe.horizontal)||oe.vertical;h.bucket.iconsInText=!!De&&De.iconsInText,(De||be)&&cX(h.bucket,q,oe,be,h.imageMap,_,Q,ee,Pe,Qe,h.canonical,h.subdivisionGranularity)}h.showCollisionBoxes&&h.bucket.generateCollisionDebugBuffers()},u.cL=nC,u.cM=iC,u.cN=aC,u.cO=uR,u.cP=lC,u.cQ=class{constructor(h){this._marks={start:[h.url,"start"].join("#"),end:[h.url,"end"].join("#"),measure:h.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let h=performance.getEntriesByName(this._marks.measure);return h.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),h=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),h}},u.cR=function(h,l,d,g,_){return a(this,void 0,void 0,function*(){if(O())try{return yield rt(h,l,d,g,_)}catch{}return function(C,A,M,L,q){const U=C.width,H=C.height;pt&&Lt||(pt=new OffscreenCanvas(U,H),Lt=pt.getContext("2d",{willReadFrequently:!0})),pt.width=U,pt.height=H,Lt.drawImage(C,0,0,U,H);const Q=Lt.getImageData(A,M,L,q);return Lt.clearRect(0,0,U,H),Q.data}(h,l,d,g,_)})},u.cS=QD,u.cT=p,u.cU=cR,u.cV=Jp,u.cW=bu,u.cX=function(h,l){const d=new Map;if(h!=null)if(h.type==="Feature")d.set(s_(h,l),h);else for(const g of h.features)d.set(s_(g,l),g);return d},u.cY=function(h,l){if(h==null)return!0;if(h.type==="Feature")return s_(h,l)!=null;if(h.type==="FeatureCollection"){const d=new Set;for(const g of h.features){const _=s_(g,l);if(_==null||d.has(_))return!1;d.add(_)}return!0}return!1},u.cZ=function(h,l,d){var g,_,C,A;if(l.removeAll&&h.clear(),l.remove)for(const M of l.remove)h.delete(M);if(l.add)for(const M of l.add){const L=s_(M,d);L!=null&&h.set(L,M)}if(l.update)for(const M of l.update){let L=h.get(M.id);if(L==null)continue;const q=!M.removeAllProperties&&(((g=M.removeProperties)===null||g===void 0?void 0:g.length)>0||((_=M.addOrUpdateProperties)===null||_===void 0?void 0:_.length)>0);if((M.newGeometry||M.removeAllProperties||q)&&(L=Object.assign({},L),h.set(M.id,L),q&&(L.properties=Object.assign({},L.properties))),M.newGeometry&&(L.geometry=M.newGeometry),M.removeAllProperties)L.properties={};else if(((C=M.removeProperties)===null||C===void 0?void 0:C.length)>0)for(const U of M.removeProperties)Object.prototype.hasOwnProperty.call(L.properties,U)&&delete L.properties[U];if(((A=M.addOrUpdateProperties)===null||A===void 0?void 0:A.length)>0)for(const{key:U,value:H}of M.addOrUpdateProperties)L.properties[U]=H}},u.c_=$l,u.ca=class extends zv{},u.cb=class extends b{},u.cc=function(h,l){return h[0]===l[0]&&h[1]===l[1]&&h[2]===l[2]&&h[3]===l[3]&&h[4]===l[4]&&h[5]===l[5]&&h[6]===l[6]&&h[7]===l[7]&&h[8]===l[8]&&h[9]===l[9]&&h[10]===l[10]&&h[11]===l[11]&&h[12]===l[12]&&h[13]===l[13]&&h[14]===l[14]&&h[15]===l[15]},u.cd=function(h,l){var d=h[0],g=h[1],_=h[2],C=h[3],A=h[4],M=h[5],L=h[6],q=h[7],U=h[8],H=h[9],Q=h[10],ee=h[11],oe=h[12],fe=h[13],be=h[14],Pe=h[15],Qe=l[0],De=l[1],ze=l[2],it=l[3],ft=l[4],Ct=l[5],Vt=l[6],It=l[7],$t=l[8],vr=l[9],Ft=l[10],Bt=l[11],_t=l[12],Fr=l[13],$r=l[14],Ar=l[15];return Math.abs(d-Qe)<=T*Math.max(1,Math.abs(d),Math.abs(Qe))&&Math.abs(g-De)<=T*Math.max(1,Math.abs(g),Math.abs(De))&&Math.abs(_-ze)<=T*Math.max(1,Math.abs(_),Math.abs(ze))&&Math.abs(C-it)<=T*Math.max(1,Math.abs(C),Math.abs(it))&&Math.abs(A-ft)<=T*Math.max(1,Math.abs(A),Math.abs(ft))&&Math.abs(M-Ct)<=T*Math.max(1,Math.abs(M),Math.abs(Ct))&&Math.abs(L-Vt)<=T*Math.max(1,Math.abs(L),Math.abs(Vt))&&Math.abs(q-It)<=T*Math.max(1,Math.abs(q),Math.abs(It))&&Math.abs(U-$t)<=T*Math.max(1,Math.abs(U),Math.abs($t))&&Math.abs(H-vr)<=T*Math.max(1,Math.abs(H),Math.abs(vr))&&Math.abs(Q-Ft)<=T*Math.max(1,Math.abs(Q),Math.abs(Ft))&&Math.abs(ee-Bt)<=T*Math.max(1,Math.abs(ee),Math.abs(Bt))&&Math.abs(oe-_t)<=T*Math.max(1,Math.abs(oe),Math.abs(_t))&&Math.abs(fe-Fr)<=T*Math.max(1,Math.abs(fe),Math.abs(Fr))&&Math.abs(be-$r)<=T*Math.max(1,Math.abs(be),Math.abs($r))&&Math.abs(Pe-Ar)<=T*Math.max(1,Math.abs(Pe),Math.abs(Ar))},u.ce=function(h,l){return h[0]=l[0],h[1]=l[1],h[2]=l[2],h[3]=l[3],h[4]=l[4],h[5]=l[5],h[6]=l[6],h[7]=l[7],h[8]=l[8],h[9]=l[9],h[10]=l[10],h[11]=l[11],h[12]=l[12],h[13]=l[13],h[14]=l[14],h[15]=l[15],h},u.cf=h=>h.type==="symbol",u.cg=h=>h.type==="circle",u.ch=h=>h.type==="heatmap",u.ci=h=>h.type==="line",u.cj=h=>h.type==="fill",u.ck=h=>h.type==="fill-extrusion",u.cl=h=>h.type==="hillshade",u.cm=h=>h.type==="color-relief",u.cn=h=>h.type==="background",u.co=h=>h.type==="custom",u.cp=Ht,u.cq=function(h,l,d){const g=Ce(l.x-d.x,l.y-d.y),_=Ce(h.x-d.x,h.y-d.y);var C,A;return tr(Math.atan2(g[0]*_[1]-g[1]*_[0],(C=g)[0]*(A=_)[0]+C[1]*A[1]))},u.cr=Ir,u.cs=function(h,l){return Sn[l]&&(h instanceof MouseEvent||h instanceof WheelEvent)},u.ct=function(h,l){return tn[l]&&"touches"in h},u.cu=function(h){return tn[h]||Sn[h]},u.cv=function(h,l,d){var g=l[0],_=l[1];return h[0]=d[0]*g+d[4]*_+d[12],h[1]=d[1]*g+d[5]*_+d[13],h},u.cw=function(h,l){const{x:d,y:g}=n_.fromLngLat(l);return!(h<0||h>25||g<0||g>=1||d<0||d>=1)},u.cx=function(h,l){return h[0]=l[0],h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=l[1],h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=l[2],h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},u.cy=class extends $p{},u.cz=dX,u.d=nt,u.e=yr,u.f=h=>a(void 0,void 0,void 0,function*(){if(h.byteLength===0)return createImageBitmap(new ImageData(1,1));const l=new Blob([new Uint8Array(h)],{type:"image/png"});try{return createImageBitmap(l)}catch(d){throw new Error(`Could not load image because of ${d.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),u.g=ue,u.h=h=>new Promise((l,d)=>{const g=new Image;g.onload=()=>{l(g),URL.revokeObjectURL(g.src),g.onload=null,window.requestAnimationFrame(()=>{g.src=Be})},g.onerror=()=>d(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const _=new Blob([new Uint8Array(h)],{type:"image/png"});g.src=h.byteLength?URL.createObjectURL(_):Be}),u.i=Lr,u.j=(h,l)=>Ye(yr(h,{type:"json"}),l),u.k=yt,u.l=Pt,u.m=Ye,u.n=(h,l)=>Ye(yr(h,{type:"arrayBuffer"}),l),u.o=function(h){return new lC(h).readFields(FY,[])},u.p=wR,u.q=Gv,u.r=Xi,u.s=Rt,u.t=Je,u.u=sn,u.v=zj,u.w=ar,u.x=Yj,u.y=BP,u.z=Bj}),i("worker",["./shared"],function(u){class a{constructor(ce,ue){this.keyCache={},ce&&this.replace(ce,ue)}replace(ce,ue){this._layerConfigs={},this._layers={},this.update(ce,[],ue)}update(ce,ue,ye){for(const Fe of ce){this._layerConfigs[Fe.id]=Fe;const Ye=this._layers[Fe.id]=u.bM(Fe,ye);Ye._featureFilter=u.ae(Ye.filter,ye),this.keyCache[Fe.id]&&delete this.keyCache[Fe.id]}for(const Fe of ue)delete this.keyCache[Fe],delete this._layerConfigs[Fe],delete this._layers[Fe];this.familiesBySource={};const Ae=u.cF(Object.values(this._layerConfigs),this.keyCache);for(const Fe of Ae){const Ye=Fe.map(or=>this._layers[or.id]),nt=Ye[0];if(nt.visibility==="none")continue;const He=nt.source||"";let ct=this.familiesBySource[He];ct||(ct=this.familiesBySource[He]={});const Pt=nt.sourceLayer||"_geojsonTileLayer";let yt=ct[Pt];yt||(yt=ct[Pt]=[]),yt.push(Ye)}}}class m{constructor(ce){const ue={},ye=[];for(const nt in ce){const He=ce[nt],ct=ue[nt]={};for(const Pt in He){const yt=He[+Pt];if(!yt||yt.bitmap.width===0||yt.bitmap.height===0)continue;const or={x:0,y:0,w:yt.bitmap.width+2,h:yt.bitmap.height+2};ye.push(or),ct[Pt]={rect:or,metrics:yt.metrics}}}const{w:Ae,h:Fe}=u.p(ye),Ye=new u.q({width:Ae||1,height:Fe||1});for(const nt in ce){const He=ce[nt];for(const ct in He){const Pt=He[+ct];if(!Pt||Pt.bitmap.width===0||Pt.bitmap.height===0)continue;const yt=ue[nt][ct].rect;u.q.copy(Pt.bitmap,Ye,{x:0,y:0},{x:yt.x+1,y:yt.y+1},Pt.bitmap)}}this.image=Ye,this.positions=ue}}u.cG("GlyphAtlas",m);class p{constructor(ce){this.tileID=new u.a0(ce.tileID.overscaledZ,ce.tileID.wrap,ce.tileID.canonical.z,ce.tileID.canonical.x,ce.tileID.canonical.y),this.uid=ce.uid,this.zoom=ce.zoom,this.pixelRatio=ce.pixelRatio,this.tileSize=ce.tileSize,this.source=ce.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ce.showCollisionBoxes,this.collectResourceTiming=!!ce.collectResourceTiming,this.returnDependencies=!!ce.returnDependencies,this.promoteId=ce.promoteId,this.inFlightDependencies=[]}parse(ce,ue,ye,Ae,Fe){return u._(this,void 0,void 0,function*(){this.status="parsing",this.data=ce,this.collisionBoxArray=new u.ac;const Ye=new u.cH(Object.keys(ce.layers).sort()),nt=new u.cI(this.tileID,this.promoteId);nt.bucketLayerIDs=[];const He={},ct={featureIndex:nt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:ye,subdivisionGranularity:Fe},Pt=ue.familiesBySource[this.source];for(const wt in Pt){const Ts=ce.layers[wt];if(!Ts)continue;Ts.version===1&&u.w(`Vector tile source "${this.source}" layer "${wt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const la=Ye.encode(wt),Pd=[];for(let Ii=0;Ii<Ts.length;Ii++){const Dt=Ts.feature(Ii),Kr=nt.getId(Dt,wt);Pd.push({feature:Dt,id:Kr,index:Ii,sourceLayerIndex:la})}for(const Ii of Pt[wt]){const Dt=Ii[0];Dt.source!==this.source&&u.w(`layer.source = ${Dt.source} does not equal this.source = ${this.source}`),Dt.isHidden(this.zoom,!0)||(y(Ii,this.zoom,ye),(He[Dt.id]=Dt.createBucket({index:nt.bucketLayerIDs.length,layers:Ii,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:la,sourceID:this.source})).populate(Pd,ct,this.tileID.canonical),nt.bucketLayerIDs.push(Ii.map(Kr=>Kr.id)))}}const yt=u.bR(ct.glyphDependencies,wt=>Object.keys(wt).map(Number));this.inFlightDependencies.forEach(wt=>wt==null?void 0:wt.abort()),this.inFlightDependencies=[];let or=Promise.resolve({});if(Object.keys(yt).length){const wt=new AbortController;this.inFlightDependencies.push(wt),or=Ae.sendAsync({type:"GG",data:{stacks:yt,source:this.source,tileID:this.tileID,type:"glyphs"}},wt)}const Je=Object.keys(ct.iconDependencies);let Qr=Promise.resolve({});if(Je.length){const wt=new AbortController;this.inFlightDependencies.push(wt),Qr=Ae.sendAsync({type:"GI",data:{icons:Je,source:this.source,tileID:this.tileID,type:"icons"}},wt)}const hr=Object.keys(ct.patternDependencies);let zt=Promise.resolve({});if(hr.length){const wt=new AbortController;this.inFlightDependencies.push(wt),zt=Ae.sendAsync({type:"GI",data:{icons:hr,source:this.source,tileID:this.tileID,type:"patterns"}},wt)}const pr=ct.dashDependencies;let ln=Promise.resolve({});if(Object.keys(pr).length){const wt=new AbortController;this.inFlightDependencies.push(wt),ln=Ae.sendAsync({type:"GDA",data:{dashes:pr}},wt)}const[Nn,Gn,kn,Tn]=yield Promise.all([or,Qr,zt,ln]),Pn=new m(Nn),ui=new u.cJ(Gn,kn);for(const wt in He){const Ts=He[wt];Ts instanceof u.ad?(y(Ts.layers,this.zoom,ye),u.cK({bucket:Ts,glyphMap:Nn,glyphPositions:Pn.positions,imageMap:Gn,imagePositions:ui.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:ct.subdivisionGranularity})):Ts.hasDependencies&&(Ts instanceof u.cL||Ts instanceof u.cM||Ts instanceof u.cN)&&(y(Ts.layers,this.zoom,ye),Ts.addFeatures(ct,this.tileID.canonical,ui.patternPositions,Tn))}return this.status="done",{buckets:Object.values(He).filter(wt=>!wt.isEmpty()),featureIndex:nt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Pn.image,imageAtlas:ui,dashPositions:Tn,glyphMap:this.returnDependencies?Nn:null,iconMap:this.returnDependencies?Gn:null,glyphPositions:this.returnDependencies?Pn.positions:null}})}}function y(Ue,ce,ue){const ye=new u.G(ce);for(const Ae of Ue)Ae.recalculate(ye,ue)}class v{constructor(ce,ue,ye){this.actor=ce,this.layerIndex=ue,this.availableImages=ye,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ce,ue){return u._(this,void 0,void 0,function*(){const ye=yield u.n(ce.request,ue);try{return{vectorTile:new u.cO(new u.cP(ye.data)),rawData:ye.data,cacheControl:ye.cacheControl,expires:ye.expires}}catch(Ae){const Fe=new Uint8Array(ye.data);let Ye=`Unable to parse the tile at ${ce.request.url}, `;throw Ye+=Fe[0]===31&&Fe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Ae.message}`,new Error(Ye)}})}loadTile(ce){return u._(this,void 0,void 0,function*(){const ue=ce.uid,ye=!!(ce&&ce.request&&ce.request.collectResourceTiming)&&new u.cQ(ce.request),Ae=new p(ce);this.loading[ue]=Ae;const Fe=new AbortController;Ae.abort=Fe;try{const Ye=yield this.loadVectorTile(ce,Fe);if(delete this.loading[ue],!Ye)return null;const nt=Ye.rawData,He={};Ye.expires&&(He.expires=Ye.expires),Ye.cacheControl&&(He.cacheControl=Ye.cacheControl);const ct={};if(ye){const yt=ye.finish();yt&&(ct.resourceTiming=JSON.parse(JSON.stringify(yt)))}Ae.vectorTile=Ye.vectorTile;const Pt=Ae.parse(Ye.vectorTile,this.layerIndex,this.availableImages,this.actor,ce.subdivisionGranularity);this.loaded[ue]=Ae,this.fetching[ue]={rawTileData:nt,cacheControl:He,resourceTiming:ct};try{const yt=yield Pt;return u.e({rawTileData:nt.slice(0)},yt,He,ct)}finally{delete this.fetching[ue]}}catch(Ye){throw delete this.loading[ue],Ae.status="done",this.loaded[ue]=Ae,Ye}})}reloadTile(ce){return u._(this,void 0,void 0,function*(){const ue=ce.uid;if(!this.loaded||!this.loaded[ue])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ye=this.loaded[ue];if(ye.showCollisionBoxes=ce.showCollisionBoxes,ye.status==="parsing"){const Ae=yield ye.parse(ye.vectorTile,this.layerIndex,this.availableImages,this.actor,ce.subdivisionGranularity);let Fe;if(this.fetching[ue]){const{rawTileData:Ye,cacheControl:nt,resourceTiming:He}=this.fetching[ue];delete this.fetching[ue],Fe=u.e({rawTileData:Ye.slice(0)},Ae,nt,He)}else Fe=Ae;return Fe}if(ye.status==="done"&&ye.vectorTile)return ye.parse(ye.vectorTile,this.layerIndex,this.availableImages,this.actor,ce.subdivisionGranularity)})}abortTile(ce){return u._(this,void 0,void 0,function*(){const ue=this.loading,ye=ce.uid;ue&&ue[ye]&&ue[ye].abort&&(ue[ye].abort.abort(),delete ue[ye])})}removeTile(ce){return u._(this,void 0,void 0,function*(){this.loaded&&this.loaded[ce.uid]&&delete this.loaded[ce.uid]})}}class j{constructor(){this.loaded={}}loadTile(ce){return u._(this,void 0,void 0,function*(){const{uid:ue,encoding:ye,rawImageData:Ae,redFactor:Fe,greenFactor:Ye,blueFactor:nt,baseShift:He}=ce,ct=Ae.width+2,Pt=Ae.height+2,yt=u.b(Ae)?new u.R({width:ct,height:Pt},yield u.cR(Ae,-1,-1,ct,Pt)):Ae,or=new u.cS(ue,yt,ye,Fe,Ye,nt,He);return this.loaded=this.loaded||{},this.loaded[ue]=or,or})}removeTile(ce){const ue=this.loaded,ye=ce.uid;ue&&ue[ye]&&delete ue[ye]}}var S,k,N=function(){if(k)return S;function Ue(ue,ye){if(ue.length!==0){ce(ue[0],ye);for(var Ae=1;Ae<ue.length;Ae++)ce(ue[Ae],!ye)}}function ce(ue,ye){for(var Ae=0,Fe=0,Ye=0,nt=ue.length,He=nt-1;Ye<nt;He=Ye++){var ct=(ue[Ye][0]-ue[He][0])*(ue[He][1]+ue[Ye][1]),Pt=Ae+ct;Fe+=Math.abs(Ae)>=Math.abs(ct)?Ae-Pt+ct:ct-Pt+Ae,Ae=Pt}Ae+Fe>=0!=!!ye&&ue.reverse()}return k=1,S=function ue(ye,Ae){var Fe,Ye=ye&&ye.type;if(Ye==="FeatureCollection")for(Fe=0;Fe<ye.features.length;Fe++)ue(ye.features[Fe],Ae);else if(Ye==="GeometryCollection")for(Fe=0;Fe<ye.geometries.length;Fe++)ue(ye.geometries[Fe],Ae);else if(Ye==="Feature")ue(ye.geometry,Ae);else if(Ye==="Polygon")Ue(ye.coordinates,Ae);else if(Ye==="MultiPolygon")for(Fe=0;Fe<ye.coordinates.length;Fe++)Ue(ye.coordinates[Fe],Ae);return ye}}(),D=u.cT(N);class O extends u.cV{constructor(ce,ue){super(new u.cP,0,ue,[],[]),this.feature=ce,this.type=ce.type,this.properties=ce.tags?ce.tags:{},"id"in ce&&(typeof ce.id=="string"?this.id=parseInt(ce.id,10):typeof ce.id!="number"||isNaN(ce.id)||(this.id=ce.id))}loadGeometry(){const ce=[],ue=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const ye of ue){const Ae=[];for(const Fe of ye)Ae.push(new u.P(Fe[0],Fe[1]));ce.push(Ae)}return ce}}class T extends u.cU{constructor(ce,ue){super(new u.cP),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=ue?ue.version:1,this.extent=ue?ue.extent:4096,this.length=ce.length,this.features=ce}feature(ce){return new O(this.features[ce],this.extent)}}function I(Ue,ce){ce.writeVarintField(15,Ue.version||1),ce.writeStringField(1,Ue.name||""),ce.writeVarintField(5,Ue.extent||4096);const ue={keys:[],values:[],keycache:{},valuecache:{}};for(let Fe=0;Fe<Ue.length;Fe++)ue.feature=Ue.feature(Fe),ce.writeMessage(2,z,ue);const ye=ue.keys;for(const Fe of ye)ce.writeStringField(3,Fe);const Ae=ue.values;for(const Fe of Ae)ce.writeMessage(4,X,Fe)}function z(Ue,ce){if(!Ue.feature)return;const ue=Ue.feature;ue.id!==void 0&&ce.writeVarintField(1,ue.id),ce.writeMessage(2,$,Ue),ce.writeVarintField(3,ue.type),ce.writeMessage(4,te,ue)}function $(Ue,ce){var ue;for(const ye in(ue=Ue.feature)==null?void 0:ue.properties){let Ae=Ue.feature.properties[ye],Fe=Ue.keycache[ye];if(Ae===null)continue;Fe===void 0&&(Ue.keys.push(ye),Fe=Ue.keys.length-1,Ue.keycache[ye]=Fe),ce.writeVarint(Fe),typeof Ae!="string"&&typeof Ae!="boolean"&&typeof Ae!="number"&&(Ae=JSON.stringify(Ae));const Ye=typeof Ae+":"+Ae;let nt=Ue.valuecache[Ye];nt===void 0&&(Ue.values.push(Ae),nt=Ue.values.length-1,Ue.valuecache[Ye]=nt),ce.writeVarint(nt)}}function V(Ue,ce){return(ce<<3)+(7&Ue)}function K(Ue){return Ue<<1^Ue>>31}function te(Ue,ce){const ue=Ue.loadGeometry(),ye=Ue.type;let Ae=0,Fe=0;for(const Ye of ue){let nt=1;ye===1&&(nt=Ye.length),ce.writeVarint(V(1,nt));const He=ye===3?Ye.length-1:Ye.length;for(let ct=0;ct<He;ct++){ct===1&&ye!==1&&ce.writeVarint(V(2,He-1));const Pt=Ye[ct].x-Ae,yt=Ye[ct].y-Fe;ce.writeVarint(K(Pt)),ce.writeVarint(K(yt)),Ae+=Pt,Fe+=yt}Ue.type===3&&ce.writeVarint(V(7,1))}}function X(Ue,ce){const ue=typeof Ue;ue==="string"?ce.writeStringField(1,Ue):ue==="boolean"?ce.writeBooleanField(7,Ue):ue==="number"&&(Ue%1!=0?ce.writeDoubleField(3,Ue):Ue<0?ce.writeSVarintField(6,Ue):ce.writeVarintField(5,Ue))}const ve={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ue=>Ue},ae=Math.fround||(pe=new Float32Array(1),Ue=>(pe[0]=+Ue,pe[0]));var pe;class Oe{constructor(ce){this.options=Object.assign(Object.create(ve),ce),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ce){const{log:ue,minZoom:ye,maxZoom:Ae}=this.options;ue&&console.time("total time");const Fe=`prepare ${ce.length} points`;ue&&console.time(Fe),this.points=ce;const Ye=[];for(let He=0;He<ce.length;He++){const ct=ce[He];if(!ct.geometry)continue;const[Pt,yt]=ct.geometry.coordinates,or=ae(Ve(Pt)),Je=ae(et(yt));Ye.push(or,Je,1/0,He,-1,1),this.options.reduce&&Ye.push(0)}let nt=this.trees[Ae+1]=this._createTree(Ye);ue&&console.timeEnd(Fe);for(let He=Ae;He>=ye;He--){const ct=+Date.now();nt=this.trees[He]=this._createTree(this._cluster(nt,He)),ue&&console.log("z%d: %d clusters in %dms",He,nt.numItems,+Date.now()-ct)}return ue&&console.timeEnd("total time"),this}getClusters(ce,ue){let ye=((ce[0]+180)%360+360)%360-180;const Ae=Math.max(-90,Math.min(90,ce[1]));let Fe=ce[2]===180?180:((ce[2]+180)%360+360)%360-180;const Ye=Math.max(-90,Math.min(90,ce[3]));if(ce[2]-ce[0]>=360)ye=-180,Fe=180;else if(ye>Fe){const yt=this.getClusters([ye,Ae,180,Ye],ue),or=this.getClusters([-180,Ae,Fe,Ye],ue);return yt.concat(or)}const nt=this.trees[this._limitZoom(ue)],He=nt.range(Ve(ye),et(Ye),Ve(Fe),et(Ae)),ct=nt.data,Pt=[];for(const yt of He){const or=this.stride*yt;Pt.push(ct[or+5]>1?Me(ct,or,this.clusterProps):this.points[ct[or+3]])}return Pt}getChildren(ce){const ue=this._getOriginId(ce),ye=this._getOriginZoom(ce),Ae="No cluster with the specified id.",Fe=this.trees[ye];if(!Fe)throw new Error(Ae);const Ye=Fe.data;if(ue*this.stride>=Ye.length)throw new Error(Ae);const nt=this.options.radius/(this.options.extent*Math.pow(2,ye-1)),He=Fe.within(Ye[ue*this.stride],Ye[ue*this.stride+1],nt),ct=[];for(const Pt of He){const yt=Pt*this.stride;Ye[yt+4]===ce&&ct.push(Ye[yt+5]>1?Me(Ye,yt,this.clusterProps):this.points[Ye[yt+3]])}if(ct.length===0)throw new Error(Ae);return ct}getLeaves(ce,ue,ye){const Ae=[];return this._appendLeaves(Ae,ce,ue=ue||10,ye=ye||0,0),Ae}getTile(ce,ue,ye){const Ae=this.trees[this._limitZoom(ce)],Fe=Math.pow(2,ce),{extent:Ye,radius:nt}=this.options,He=nt/Ye,ct=(ye-He)/Fe,Pt=(ye+1+He)/Fe,yt={features:[]};return this._addTileFeatures(Ae.range((ue-He)/Fe,ct,(ue+1+He)/Fe,Pt),Ae.data,ue,ye,Fe,yt),ue===0&&this._addTileFeatures(Ae.range(1-He/Fe,ct,1,Pt),Ae.data,Fe,ye,Fe,yt),ue===Fe-1&&this._addTileFeatures(Ae.range(0,ct,He/Fe,Pt),Ae.data,-1,ye,Fe,yt),yt.features.length?yt:null}getClusterExpansionZoom(ce){let ue=this._getOriginZoom(ce)-1;for(;ue<=this.options.maxZoom;){const ye=this.getChildren(ce);if(ue++,ye.length!==1)break;ce=ye[0].properties.cluster_id}return ue}_appendLeaves(ce,ue,ye,Ae,Fe){const Ye=this.getChildren(ue);for(const nt of Ye){const He=nt.properties;if(He&&He.cluster?Fe+He.point_count<=Ae?Fe+=He.point_count:Fe=this._appendLeaves(ce,He.cluster_id,ye,Ae,Fe):Fe<Ae?Fe++:ce.push(nt),ce.length===ye)break}return Fe}_createTree(ce){const ue=new u.aM(ce.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ye=0;ye<ce.length;ye+=this.stride)ue.add(ce[ye],ce[ye+1]);return ue.finish(),ue.data=ce,ue}_addTileFeatures(ce,ue,ye,Ae,Fe,Ye){for(const nt of ce){const He=nt*this.stride,ct=ue[He+5]>1;let Pt,yt,or;if(ct)Pt=Xe(ue,He,this.clusterProps),yt=ue[He],or=ue[He+1];else{const hr=this.points[ue[He+3]];Pt=hr.properties;const[zt,pr]=hr.geometry.coordinates;yt=Ve(zt),or=et(pr)}const Je={type:1,geometry:[[Math.round(this.options.extent*(yt*Fe-ye)),Math.round(this.options.extent*(or*Fe-Ae))]],tags:Pt};let Qr;Qr=ct||this.options.generateId?ue[He+3]:this.points[ue[He+3]].id,Qr!==void 0&&(Je.id=Qr),Ye.features.push(Je)}}_limitZoom(ce){return Math.max(this.options.minZoom,Math.min(Math.floor(+ce),this.options.maxZoom+1))}_cluster(ce,ue){const{radius:ye,extent:Ae,reduce:Fe,minPoints:Ye}=this.options,nt=ye/(Ae*Math.pow(2,ue)),He=ce.data,ct=[],Pt=this.stride;for(let yt=0;yt<He.length;yt+=Pt){if(He[yt+2]<=ue)continue;He[yt+2]=ue;const or=He[yt],Je=He[yt+1],Qr=ce.within(He[yt],He[yt+1],nt),hr=He[yt+5];let zt=hr;for(const pr of Qr){const ln=pr*Pt;He[ln+2]>ue&&(zt+=He[ln+5])}if(zt>hr&&zt>=Ye){let pr,ln=or*hr,Nn=Je*hr,Gn=-1;const kn=(yt/Pt<<5)+(ue+1)+this.points.length;for(const Tn of Qr){const Pn=Tn*Pt;if(He[Pn+2]<=ue)continue;He[Pn+2]=ue;const ui=He[Pn+5];ln+=He[Pn]*ui,Nn+=He[Pn+1]*ui,He[Pn+4]=kn,Fe&&(pr||(pr=this._map(He,yt,!0),Gn=this.clusterProps.length,this.clusterProps.push(pr)),Fe(pr,this._map(He,Pn)))}He[yt+4]=kn,ct.push(ln/zt,Nn/zt,1/0,kn,-1,zt),Fe&&ct.push(Gn)}else{for(let pr=0;pr<Pt;pr++)ct.push(He[yt+pr]);if(zt>1)for(const pr of Qr){const ln=pr*Pt;if(!(He[ln+2]<=ue)){He[ln+2]=ue;for(let Nn=0;Nn<Pt;Nn++)ct.push(He[ln+Nn])}}}}return ct}_getOriginId(ce){return ce-this.points.length>>5}_getOriginZoom(ce){return(ce-this.points.length)%32}_map(ce,ue,ye){if(ce[ue+5]>1){const Ye=this.clusterProps[ce[ue+6]];return ye?Object.assign({},Ye):Ye}const Ae=this.points[ce[ue+3]].properties,Fe=this.options.map(Ae);return ye&&Fe===Ae?Object.assign({},Fe):Fe}}function Me(Ue,ce,ue){return{type:"Feature",id:Ue[ce+3],properties:Xe(Ue,ce,ue),geometry:{type:"Point",coordinates:[(ye=Ue[ce],360*(ye-.5)),Ce(Ue[ce+1])]}};var ye}function Xe(Ue,ce,ue){const ye=Ue[ce+5],Ae=ye>=1e4?`${Math.round(ye/1e3)}k`:ye>=1e3?Math.round(ye/100)/10+"k":ye,Fe=Ue[ce+6],Ye=Fe===-1?{}:Object.assign({},ue[Fe]);return Object.assign(Ye,{cluster:!0,cluster_id:Ue[ce+3],point_count:ye,point_count_abbreviated:Ae})}function Ve(Ue){return Ue/360+.5}function et(Ue){const ce=Math.sin(Ue*Math.PI/180),ue=.5-.25*Math.log((1+ce)/(1-ce))/Math.PI;return ue<0?0:ue>1?1:ue}function Ce(Ue){const ce=(180-360*Ue)*Math.PI/180;return 360*Math.atan(Math.exp(ce))/Math.PI-90}function _e(Ue,ce,ue,ye){let Ae=ye;const Fe=ce+(ue-ce>>1);let Ye,nt=ue-ce;const He=Ue[ce],ct=Ue[ce+1],Pt=Ue[ue],yt=Ue[ue+1];for(let or=ce+3;or<ue;or+=3){const Je=tt(Ue[or],Ue[or+1],He,ct,Pt,yt);if(Je>Ae)Ye=or,Ae=Je;else if(Je===Ae){const Qr=Math.abs(or-Fe);Qr<nt&&(Ye=or,nt=Qr)}}Ae>ye&&(Ye-ce>3&&_e(Ue,ce,Ye,ye),Ue[Ye+2]=Ae,ue-Ye>3&&_e(Ue,Ye,ue,ye))}function tt(Ue,ce,ue,ye,Ae,Fe){let Ye=Ae-ue,nt=Fe-ye;if(Ye!==0||nt!==0){const He=((Ue-ue)*Ye+(ce-ye)*nt)/(Ye*Ye+nt*nt);He>1?(ue=Ae,ye=Fe):He>0&&(ue+=Ye*He,ye+=nt*He)}return Ye=Ue-ue,nt=ce-ye,Ye*Ye+nt*nt}function vt(Ue,ce,ue,ye){const Ae={id:Ue??null,type:ce,geometry:ue,tags:ye,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ce==="Point"||ce==="MultiPoint"||ce==="LineString")gt(Ae,ue);else if(ce==="Polygon")gt(Ae,ue[0]);else if(ce==="MultiLineString")for(const Fe of ue)gt(Ae,Fe);else if(ce==="MultiPolygon")for(const Fe of ue)gt(Ae,Fe[0]);return Ae}function gt(Ue,ce){for(let ue=0;ue<ce.length;ue+=3)Ue.minX=Math.min(Ue.minX,ce[ue]),Ue.minY=Math.min(Ue.minY,ce[ue+1]),Ue.maxX=Math.max(Ue.maxX,ce[ue]),Ue.maxY=Math.max(Ue.maxY,ce[ue+1])}function Tt(Ue,ce,ue,ye){if(!ce.geometry)return;const Ae=ce.geometry.coordinates;if(Ae&&Ae.length===0)return;const Fe=ce.geometry.type,Ye=Math.pow(ue.tolerance/((1<<ue.maxZoom)*ue.extent),2);let nt=[],He=ce.id;if(ue.promoteId?He=ce.properties[ue.promoteId]:ue.generateId&&(He=ye||0),Fe==="Point")Ht(Ae,nt);else if(Fe==="MultiPoint")for(const ct of Ae)Ht(ct,nt);else if(Fe==="LineString")Ir(Ae,nt,Ye,!1);else if(Fe==="MultiLineString"){if(ue.lineMetrics){for(const ct of Ae)nt=[],Ir(ct,nt,Ye,!1),Ue.push(vt(He,"LineString",nt,ce.properties));return}Pr(Ae,nt,Ye,!1)}else if(Fe==="Polygon")Pr(Ae,nt,Ye,!0);else{if(Fe!=="MultiPolygon"){if(Fe==="GeometryCollection"){for(const ct of ce.geometry.geometries)Tt(Ue,{id:He,geometry:ct,properties:ce.properties},ue,ye);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ct of Ae){const Pt=[];Pr(ct,Pt,Ye,!0),nt.push(Pt)}}Ue.push(vt(He,Fe,nt,ce.properties))}function Ht(Ue,ce){ce.push(Mt(Ue[0]),yr(Ue[1]),0)}function Ir(Ue,ce,ue,ye){let Ae,Fe,Ye=0;for(let He=0;He<Ue.length;He++){const ct=Mt(Ue[He][0]),Pt=yr(Ue[He][1]);ce.push(ct,Pt,0),He>0&&(Ye+=ye?(Ae*Pt-ct*Fe)/2:Math.sqrt(Math.pow(ct-Ae,2)+Math.pow(Pt-Fe,2))),Ae=ct,Fe=Pt}const nt=ce.length-3;ce[2]=1,_e(ce,0,nt,ue),ce[nt+2]=1,ce.size=Math.abs(Ye),ce.start=0,ce.end=ce.size}function Pr(Ue,ce,ue,ye){for(let Ae=0;Ae<Ue.length;Ae++){const Fe=[];Ir(Ue[Ae],Fe,ue,ye),ce.push(Fe)}}function Mt(Ue){return Ue/360+.5}function yr(Ue){const ce=Math.sin(Ue*Math.PI/180),ue=.5-.25*Math.log((1+ce)/(1-ce))/Math.PI;return ue<0?0:ue>1?1:ue}function Nt(Ue,ce,ue,ye,Ae,Fe,Ye,nt){if(ye/=ce,Fe>=(ue/=ce)&&Ye<ye)return Ue;if(Ye<ue||Fe>=ye)return null;const He=[];for(const ct of Ue){const Pt=ct.geometry;let yt=ct.type;const or=Ae===0?ct.minX:ct.minY,Je=Ae===0?ct.maxX:ct.maxY;if(or>=ue&&Je<ye){He.push(ct);continue}if(Je<ue||or>=ye)continue;let Qr=[];if(yt==="Point"||yt==="MultiPoint")Wt(Pt,Qr,ue,ye,Ae);else if(yt==="LineString")Zt(Pt,Qr,ue,ye,Ae,!1,nt.lineMetrics);else if(yt==="MultiLineString")qr(Pt,Qr,ue,ye,Ae,!1);else if(yt==="Polygon")qr(Pt,Qr,ue,ye,Ae,!0);else if(yt==="MultiPolygon")for(const hr of Pt){const zt=[];qr(hr,zt,ue,ye,Ae,!0),zt.length&&Qr.push(zt)}if(Qr.length){if(nt.lineMetrics&&yt==="LineString"){for(const hr of Qr)He.push(vt(ct.id,yt,hr,ct.tags));continue}yt!=="LineString"&&yt!=="MultiLineString"||(Qr.length===1?(yt="LineString",Qr=Qr[0]):yt="MultiLineString"),yt!=="Point"&&yt!=="MultiPoint"||(yt=Qr.length===3?"Point":"MultiPoint"),He.push(vt(ct.id,yt,Qr,ct.tags))}}return He.length?He:null}function Wt(Ue,ce,ue,ye,Ae){for(let Fe=0;Fe<Ue.length;Fe+=3){const Ye=Ue[Fe+Ae];Ye>=ue&&Ye<=ye&&ar(ce,Ue[Fe],Ue[Fe+1],Ue[Fe+2])}}function Zt(Ue,ce,ue,ye,Ae,Fe,Ye){let nt=mt(Ue);const He=Ae===0?en:Lr;let ct,Pt,yt=Ue.start;for(let zt=0;zt<Ue.length-3;zt+=3){const pr=Ue[zt],ln=Ue[zt+1],Nn=Ue[zt+2],Gn=Ue[zt+3],kn=Ue[zt+4],Tn=Ae===0?pr:ln,Pn=Ae===0?Gn:kn;let ui=!1;Ye&&(ct=Math.sqrt(Math.pow(pr-Gn,2)+Math.pow(ln-kn,2))),Tn<ue?Pn>ue&&(Pt=He(nt,pr,ln,Gn,kn,ue),Ye&&(nt.start=yt+ct*Pt)):Tn>ye?Pn<ye&&(Pt=He(nt,pr,ln,Gn,kn,ye),Ye&&(nt.start=yt+ct*Pt)):ar(nt,pr,ln,Nn),Pn<ue&&Tn>=ue&&(Pt=He(nt,pr,ln,Gn,kn,ue),ui=!0),Pn>ye&&Tn<=ye&&(Pt=He(nt,pr,ln,Gn,kn,ye),ui=!0),!Fe&&ui&&(Ye&&(nt.end=yt+ct*Pt),ce.push(nt),nt=mt(Ue)),Ye&&(yt+=ct)}let or=Ue.length-3;const Je=Ue[or],Qr=Ue[or+1],hr=Ae===0?Je:Qr;hr>=ue&&hr<=ye&&ar(nt,Je,Qr,Ue[or+2]),or=nt.length-3,Fe&&or>=3&&(nt[or]!==nt[0]||nt[or+1]!==nt[1])&&ar(nt,nt[0],nt[1],nt[2]),nt.length&&ce.push(nt)}function mt(Ue){const ce=[];return ce.size=Ue.size,ce.start=Ue.start,ce.end=Ue.end,ce}function qr(Ue,ce,ue,ye,Ae,Fe){for(const Ye of Ue)Zt(Ye,ce,ue,ye,Ae,Fe,!1)}function ar(Ue,ce,ue,ye){Ue.push(ce,ue,ye)}function en(Ue,ce,ue,ye,Ae,Fe){const Ye=(Fe-ce)/(ye-ce);return ar(Ue,Fe,ue+(Ae-ue)*Ye,1),Ye}function Lr(Ue,ce,ue,ye,Ae,Fe){const Ye=(Fe-ue)/(Ae-ue);return ar(Ue,ce+(ye-ce)*Ye,Fe,1),Ye}function An(Ue,ce){const ue=[];for(let ye=0;ye<Ue.length;ye++){const Ae=Ue[ye],Fe=Ae.type;let Ye;if(Fe==="Point"||Fe==="MultiPoint"||Fe==="LineString")Ye=vs(Ae.geometry,ce);else if(Fe==="MultiLineString"||Fe==="Polygon"){Ye=[];for(const nt of Ae.geometry)Ye.push(vs(nt,ce))}else if(Fe==="MultiPolygon"){Ye=[];for(const nt of Ae.geometry){const He=[];for(const ct of nt)He.push(vs(ct,ce));Ye.push(He)}}ue.push(vt(Ae.id,Fe,Ye,Ae.tags))}return ue}function vs(Ue,ce){const ue=[];ue.size=Ue.size,Ue.start!==void 0&&(ue.start=Ue.start,ue.end=Ue.end);for(let ye=0;ye<Ue.length;ye+=3)ue.push(Ue[ye]+ce,Ue[ye+1],Ue[ye+2]);return ue}function Wn(Ue,ce){if(Ue.transformed)return Ue;const ue=1<<Ue.z,ye=Ue.x,Ae=Ue.y;for(const Fe of Ue.features){const Ye=Fe.geometry,nt=Fe.type;if(Fe.geometry=[],nt===1)for(let He=0;He<Ye.length;He+=2)Fe.geometry.push(Be(Ye[He],Ye[He+1],ce,ue,ye,Ae));else for(let He=0;He<Ye.length;He++){const ct=[];for(let Pt=0;Pt<Ye[He].length;Pt+=2)ct.push(Be(Ye[He][Pt],Ye[He][Pt+1],ce,ue,ye,Ae));Fe.geometry.push(ct)}}return Ue.transformed=!0,Ue}function Be(Ue,ce,ue,ye,Ae,Fe){return[Math.round(ue*(Ue*ye-Ae)),Math.round(ue*(ce*ye-Fe))]}function rt(Ue,ce,ue,ye,Ae){const Fe=ce===Ae.maxZoom?0:Ae.tolerance/((1<<ce)*Ae.extent),Ye={features:[],numPoints:0,numSimplified:0,numFeatures:Ue.length,source:null,x:ue,y:ye,z:ce,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const nt of Ue)pt(Ye,nt,Fe,Ae);return Ye}function pt(Ue,ce,ue,ye){const Ae=ce.geometry,Fe=ce.type,Ye=[];if(Ue.minX=Math.min(Ue.minX,ce.minX),Ue.minY=Math.min(Ue.minY,ce.minY),Ue.maxX=Math.max(Ue.maxX,ce.maxX),Ue.maxY=Math.max(Ue.maxY,ce.maxY),Fe==="Point"||Fe==="MultiPoint")for(let nt=0;nt<Ae.length;nt+=3)Ye.push(Ae[nt],Ae[nt+1]),Ue.numPoints++,Ue.numSimplified++;else if(Fe==="LineString")Lt(Ye,Ae,Ue,ue,!1,!1);else if(Fe==="MultiLineString"||Fe==="Polygon")for(let nt=0;nt<Ae.length;nt++)Lt(Ye,Ae[nt],Ue,ue,Fe==="Polygon",nt===0);else if(Fe==="MultiPolygon")for(let nt=0;nt<Ae.length;nt++){const He=Ae[nt];for(let ct=0;ct<He.length;ct++)Lt(Ye,He[ct],Ue,ue,!0,ct===0)}if(Ye.length){let nt=ce.tags||null;if(Fe==="LineString"&&ye.lineMetrics){nt={};for(const ct in ce.tags)nt[ct]=ce.tags[ct];nt.mapbox_clip_start=Ae.start/Ae.size,nt.mapbox_clip_end=Ae.end/Ae.size}const He={geometry:Ye,type:Fe==="Polygon"||Fe==="MultiPolygon"?3:Fe==="LineString"||Fe==="MultiLineString"?2:1,tags:nt};ce.id!==null&&(He.id=ce.id),Ue.features.push(He)}}function Lt(Ue,ce,ue,ye,Ae,Fe){const Ye=ye*ye;if(ye>0&&ce.size<(Ae?Ye:ye))return void(ue.numPoints+=ce.length/3);const nt=[];for(let He=0;He<ce.length;He+=3)(ye===0||ce[He+2]>Ye)&&(ue.numSimplified++,nt.push(ce[He],ce[He+1])),ue.numPoints++;Ae&&function(He,ct){let Pt=0;for(let yt=0,or=He.length,Je=or-2;yt<or;Je=yt,yt+=2)Pt+=(He[yt]-He[Je])*(He[yt+1]+He[Je+1]);if(Pt>0===ct)for(let yt=0,or=He.length;yt<or/2;yt+=2){const Je=He[yt],Qr=He[yt+1];He[yt]=He[or-2-yt],He[yt+1]=He[or-1-yt],He[or-2-yt]=Je,He[or-1-yt]=Qr}}(nt,Fe),Ue.push(nt)}const Rt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ot{constructor(ce,ue){const ye=(ue=this.options=function(Fe,Ye){for(const nt in Ye)Fe[nt]=Ye[nt];return Fe}(Object.create(Rt),ue)).debug;if(ye&&console.time("preprocess data"),ue.maxZoom<0||ue.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ue.promoteId&&ue.generateId)throw new Error("promoteId and generateId cannot be used together.");let Ae=function(Fe,Ye){const nt=[];if(Fe.type==="FeatureCollection")for(let He=0;He<Fe.features.length;He++)Tt(nt,Fe.features[He],Ye,He);else Tt(nt,Fe.type==="Feature"?Fe:{geometry:Fe},Ye);return nt}(ce,ue);this.tiles={},this.tileCoords=[],ye&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ue.indexMaxZoom,ue.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ae=function(Fe,Ye){const nt=Ye.buffer/Ye.extent;let He=Fe;const ct=Nt(Fe,1,-1-nt,nt,0,-1,2,Ye),Pt=Nt(Fe,1,1-nt,2+nt,0,-1,2,Ye);return(ct||Pt)&&(He=Nt(Fe,1,-nt,1+nt,0,-1,2,Ye)||[],ct&&(He=An(ct,1).concat(He)),Pt&&(He=He.concat(An(Pt,-1)))),He}(Ae,ue),Ae.length&&this.splitTile(Ae,0,0,0),ye&&(Ae.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ce,ue,ye,Ae,Fe,Ye,nt){const He=[ce,ue,ye,Ae],ct=this.options,Pt=ct.debug;for(;He.length;){Ae=He.pop(),ye=He.pop(),ue=He.pop(),ce=He.pop();const yt=1<<ue,or=tr(ue,ye,Ae);let Je=this.tiles[or];if(!Je&&(Pt>1&&console.time("creation"),Je=this.tiles[or]=rt(ce,ue,ye,Ae,ct),this.tileCoords.push({z:ue,x:ye,y:Ae}),Pt)){Pt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ue,ye,Ae,Je.numFeatures,Je.numPoints,Je.numSimplified),console.timeEnd("creation"));const ui=`z${ue}`;this.stats[ui]=(this.stats[ui]||0)+1,this.total++}if(Je.source=ce,Fe==null){if(ue===ct.indexMaxZoom||Je.numPoints<=ct.indexMaxPoints)continue}else{if(ue===ct.maxZoom||ue===Fe)continue;if(Fe!=null){const ui=Fe-ue;if(ye!==Ye>>ui||Ae!==nt>>ui)continue}}if(Je.source=null,ce.length===0)continue;Pt>1&&console.time("clipping");const Qr=.5*ct.buffer/ct.extent,hr=.5-Qr,zt=.5+Qr,pr=1+Qr;let ln=null,Nn=null,Gn=null,kn=null,Tn=Nt(ce,yt,ye-Qr,ye+zt,0,Je.minX,Je.maxX,ct),Pn=Nt(ce,yt,ye+hr,ye+pr,0,Je.minX,Je.maxX,ct);ce=null,Tn&&(ln=Nt(Tn,yt,Ae-Qr,Ae+zt,1,Je.minY,Je.maxY,ct),Nn=Nt(Tn,yt,Ae+hr,Ae+pr,1,Je.minY,Je.maxY,ct),Tn=null),Pn&&(Gn=Nt(Pn,yt,Ae-Qr,Ae+zt,1,Je.minY,Je.maxY,ct),kn=Nt(Pn,yt,Ae+hr,Ae+pr,1,Je.minY,Je.maxY,ct),Pn=null),Pt>1&&console.timeEnd("clipping"),He.push(ln||[],ue+1,2*ye,2*Ae),He.push(Nn||[],ue+1,2*ye,2*Ae+1),He.push(Gn||[],ue+1,2*ye+1,2*Ae),He.push(kn||[],ue+1,2*ye+1,2*Ae+1)}}getTile(ce,ue,ye){ce=+ce,ue=+ue,ye=+ye;const Ae=this.options,{extent:Fe,debug:Ye}=Ae;if(ce<0||ce>24)return null;const nt=1<<ce,He=tr(ce,ue=ue+nt&nt-1,ye);if(this.tiles[He])return Wn(this.tiles[He],Fe);Ye>1&&console.log("drilling down to z%d-%d-%d",ce,ue,ye);let ct,Pt=ce,yt=ue,or=ye;for(;!ct&&Pt>0;)Pt--,yt>>=1,or>>=1,ct=this.tiles[tr(Pt,yt,or)];return ct&&ct.source?(Ye>1&&(console.log("found parent tile z%d-%d-%d",Pt,yt,or),console.time("drilling down")),this.splitTile(ct.source,Pt,yt,or,ce,ue,ye),Ye>1&&console.timeEnd("drilling down"),this.tiles[He]?Wn(this.tiles[He],Fe):null):null}}function tr(Ue,ce,ue){return 32*((1<<Ue)*ue+ce)+Ue}class tn extends v{constructor(ce,ue,ye,Ae=Sn){super(ce,ue,ye),this._dataUpdateable=new Map,this._createGeoJSONIndex=Ae}loadVectorTile(ce,ue){return u._(this,void 0,void 0,function*(){const ye=ce.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Ae=this._geoJSONIndex.getTile(ye.z,ye.x,ye.y);if(!Ae)return null;const Fe=new T(Ae.features,{version:2,extent:u.a3});let Ye=function(nt){const He=new u.cP;return function(ct,Pt){for(const yt in ct.layers)Pt.writeMessage(3,I,ct.layers[yt])}(nt,He),He.finish()}(Fe);return Ye.byteOffset===0&&Ye.byteLength===Ye.buffer.byteLength||(Ye=new Uint8Array(Ye)),{vectorTile:Fe,rawData:Ye.buffer}})}loadData(ce){return u._(this,void 0,void 0,function*(){var ue;(ue=this._pendingRequest)===null||ue===void 0||ue.abort();const ye=!!(ce&&ce.request&&ce.request.collectResourceTiming)&&new u.cQ(ce.request);this._pendingRequest=new AbortController;try{(!this._pendingData||ce.request||ce.data||ce.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(ce,this._pendingRequest));const Ae=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(Ae,ce),this.loaded={};const Fe={data:Ae};if(ye){const Ye=ye.finish();Ye&&(Fe.resourceTiming={},Fe.resourceTiming[ce.source]=JSON.parse(JSON.stringify(Ye)))}return Fe}catch(Ae){if(delete this._pendingRequest,u.cB(Ae))return{abandoned:!0};throw Ae}})}getData(){return u._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(ce){const ue=this.loaded;return ue&&ue[ce.uid]?super.reloadTile(ce):this.loadTile(ce)}loadAndProcessGeoJSON(ce,ue){return u._(this,void 0,void 0,function*(){let ye=yield this.loadGeoJSON(ce,ue);if(delete this._pendingRequest,typeof ye!="object")throw new Error(`Input data given to '${ce.source}' is not a valid GeoJSON object.`);if(D(ye,!0),ce.filter){const Ae=u.cW(ce.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ae.result==="error")throw new Error(Ae.value.map(Ye=>`${Ye.key}: ${Ye.message}`).join(", "));ye={type:"FeatureCollection",features:ye.features.filter(Ye=>Ae.value.evaluate({zoom:0},Ye))}}return ye})}loadGeoJSON(ce,ue){return u._(this,void 0,void 0,function*(){const{promoteId:ye}=ce;if(ce.request){const Ae=yield u.j(ce.request,ue);return this._dataUpdateable=u.cY(Ae.data,ye)?u.cX(Ae.data,ye):void 0,Ae.data}if(typeof ce.data=="string")try{const Ae=JSON.parse(ce.data);return this._dataUpdateable=u.cY(Ae,ye)?u.cX(Ae,ye):void 0,Ae}catch{throw new Error(`Input data given to '${ce.source}' is not a valid GeoJSON object.`)}if(!ce.dataDiff)throw new Error(`Input data given to '${ce.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ce.source}`);return u.cZ(this._dataUpdateable,ce.dataDiff,ye),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(ce){return u._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(ce){return this._geoJSONIndex.getClusterExpansionZoom(ce.clusterId)}getClusterChildren(ce){return this._geoJSONIndex.getChildren(ce.clusterId)}getClusterLeaves(ce){return this._geoJSONIndex.getLeaves(ce.clusterId,ce.limit,ce.offset)}}function Sn(Ue,ce){return ce.cluster?new Oe(function({superclusterOptions:ue,clusterProperties:ye}){if(!ye||!ue)return ue;const Ae={},Fe={},Ye={accumulated:null,zoom:0},nt={properties:null},He=Object.keys(ye);for(const ct of He){const[Pt,yt]=ye[ct],or=u.cW(yt),Je=u.cW(typeof Pt=="string"?[Pt,["accumulated"],["get",ct]]:Pt);Ae[ct]=or.value,Fe[ct]=Je.value}return ue.map=ct=>{nt.properties=ct;const Pt={};for(const yt of He)Pt[yt]=Ae[yt].evaluate(Ye,nt);return Pt},ue.reduce=(ct,Pt)=>{nt.properties=Pt;for(const yt of He)Ye.accumulated=ct[yt],ct[yt]=Fe[yt].evaluate(Ye,nt)},ue}(ce)).load(Ue.features):function(ue,ye){return new Ot(ue,ye)}(Ue,ce.geojsonVtOptions)}class ks{constructor(ce){this.self=ce,this.actor=new u.K(ce),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(ue,ye)=>{if(this.externalWorkerSourceTypes[ue])throw new Error(`Worker source with name "${ue}" already registered.`);this.externalWorkerSourceTypes[ue]=ye},this.self.addProtocol=u.cD,this.self.removeProtocol=u.cE,this.self.registerRTLTextPlugin=ue=>{u.c_.setMethods(ue)},this.actor.registerMessageHandler("LDT",(ue,ye)=>this._getDEMWorkerSource(ue,ye.source).loadTile(ye)),this.actor.registerMessageHandler("RDT",(ue,ye)=>u._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ue,ye.source).removeTile(ye)})),this.actor.registerMessageHandler("GCEZ",(ue,ye)=>u._(this,void 0,void 0,function*(){return this._getWorkerSource(ue,ye.type,ye.source).getClusterExpansionZoom(ye)})),this.actor.registerMessageHandler("GCC",(ue,ye)=>u._(this,void 0,void 0,function*(){return this._getWorkerSource(ue,ye.type,ye.source).getClusterChildren(ye)})),this.actor.registerMessageHandler("GCL",(ue,ye)=>u._(this,void 0,void 0,function*(){return this._getWorkerSource(ue,ye.type,ye.source).getClusterLeaves(ye)})),this.actor.registerMessageHandler("LD",(ue,ye)=>this._getWorkerSource(ue,ye.type,ye.source).loadData(ye)),this.actor.registerMessageHandler("GD",(ue,ye)=>this._getWorkerSource(ue,ye.type,ye.source).getData()),this.actor.registerMessageHandler("LT",(ue,ye)=>this._getWorkerSource(ue,ye.type,ye.source).loadTile(ye)),this.actor.registerMessageHandler("RT",(ue,ye)=>this._getWorkerSource(ue,ye.type,ye.source).reloadTile(ye)),this.actor.registerMessageHandler("AT",(ue,ye)=>this._getWorkerSource(ue,ye.type,ye.source).abortTile(ye)),this.actor.registerMessageHandler("RMT",(ue,ye)=>this._getWorkerSource(ue,ye.type,ye.source).removeTile(ye)),this.actor.registerMessageHandler("RS",(ue,ye)=>u._(this,void 0,void 0,function*(){if(!this.workerSources[ue]||!this.workerSources[ue][ye.type]||!this.workerSources[ue][ye.type][ye.source])return;const Ae=this.workerSources[ue][ye.type][ye.source];delete this.workerSources[ue][ye.type][ye.source],Ae.removeSource!==void 0&&Ae.removeSource(ye)})),this.actor.registerMessageHandler("RM",ue=>u._(this,void 0,void 0,function*(){delete this.layerIndexes[ue],delete this.availableImages[ue],delete this.workerSources[ue],delete this.demWorkerSources[ue],this.globalStates.delete(ue)})),this.actor.registerMessageHandler("SR",(ue,ye)=>u._(this,void 0,void 0,function*(){this.referrer=ye})),this.actor.registerMessageHandler("SRPS",(ue,ye)=>this._syncRTLPluginState(ue,ye)),this.actor.registerMessageHandler("IS",(ue,ye)=>u._(this,void 0,void 0,function*(){this.self.importScripts(ye)})),this.actor.registerMessageHandler("SI",(ue,ye)=>this._setImages(ue,ye)),this.actor.registerMessageHandler("UL",(ue,ye)=>u._(this,void 0,void 0,function*(){this._getLayerIndex(ue).update(ye.layers,ye.removedIds,this._getGlobalState(ue))})),this.actor.registerMessageHandler("UGS",(ue,ye)=>u._(this,void 0,void 0,function*(){const Ae=this._getGlobalState(ue);for(const Fe in ye)Ae[Fe]=ye[Fe]})),this.actor.registerMessageHandler("SL",(ue,ye)=>u._(this,void 0,void 0,function*(){this._getLayerIndex(ue).replace(ye,this._getGlobalState(ue))}))}_getGlobalState(ce){let ue=this.globalStates.get(ce);return ue||(ue={},this.globalStates.set(ce,ue)),ue}_setImages(ce,ue){return u._(this,void 0,void 0,function*(){this.availableImages[ce]=ue;for(const ye in this.workerSources[ce]){const Ae=this.workerSources[ce][ye];for(const Fe in Ae)Ae[Fe].availableImages=ue}})}_syncRTLPluginState(ce,ue){return u._(this,void 0,void 0,function*(){return yield u.c_.syncState(ue,this.self.importScripts)})}_getAvailableImages(ce){let ue=this.availableImages[ce];return ue||(ue=[]),ue}_getLayerIndex(ce){let ue=this.layerIndexes[ce];return ue||(ue=this.layerIndexes[ce]=new a),ue}_getWorkerSource(ce,ue,ye){if(this.workerSources[ce]||(this.workerSources[ce]={}),this.workerSources[ce][ue]||(this.workerSources[ce][ue]={}),!this.workerSources[ce][ue][ye]){const Ae={sendAsync:(Fe,Ye)=>(Fe.targetMapId=ce,this.actor.sendAsync(Fe,Ye))};switch(ue){case"vector":this.workerSources[ce][ue][ye]=new v(Ae,this._getLayerIndex(ce),this._getAvailableImages(ce));break;case"geojson":this.workerSources[ce][ue][ye]=new tn(Ae,this._getLayerIndex(ce),this._getAvailableImages(ce));break;default:this.workerSources[ce][ue][ye]=new this.externalWorkerSourceTypes[ue](Ae,this._getLayerIndex(ce),this._getAvailableImages(ce))}}return this.workerSources[ce][ue][ye]}_getDEMWorkerSource(ce,ue){return this.demWorkerSources[ce]||(this.demWorkerSources[ce]={}),this.demWorkerSources[ce][ue]||(this.demWorkerSources[ce][ue]=new j),this.demWorkerSources[ce][ue]}}return u.i(self)&&(self.worker=new ks(self)),ks}),i("index",["exports","./shared"],function(u,a){var m="5.11.0";function p(){var w=new a.A(4);return a.A!=Float32Array&&(w[1]=0,w[2]=0),w[0]=1,w[3]=1,w}let y,v;const j={frame(w,o,f){const x=requestAnimationFrame(P=>{b(),o(P)}),{unsubscribe:b}=a.s(w.signal,"abort",()=>{b(),cancelAnimationFrame(x),f(a.c())},!1)},frameAsync(w){return new Promise((o,f)=>{this.frame(w,o,f)})},getImageData(w,o=0){return this.getImageCanvasContext(w).getImageData(-o,-o,w.width+2*o,w.height+2*o)},getImageCanvasContext(w){const o=window.document.createElement("canvas"),f=o.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return o.width=w.width,o.height=w.height,f.drawImage(w,0,0,w.width,w.height),f},resolveURL:w=>(y||(y=document.createElement("a")),y.href=w,y.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(v==null&&(v=matchMedia("(prefers-reduced-motion: reduce)")),v.matches)}},S=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(w){this._frozenAt=w}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function k(){return S.getCurrentTime()}class N{static testProp(o){if(!N.docStyle)return o[0];for(let f=0;f<o.length;f++)if(o[f]in N.docStyle)return o[f];return o[0]}static create(o,f,x){const b=window.document.createElement(o);return f!==void 0&&(b.className=f),x&&x.appendChild(b),b}static createNS(o,f){return window.document.createElementNS(o,f)}static disableDrag(){N.docStyle&&N.selectProp&&(N.userSelect=N.docStyle[N.selectProp],N.docStyle[N.selectProp]="none")}static enableDrag(){N.docStyle&&N.selectProp&&(N.docStyle[N.selectProp]=N.userSelect)}static setTransform(o,f){o.style[N.transformProp]=f}static addEventListener(o,f,x,b={}){o.addEventListener(f,x,"passive"in b?b:b.capture)}static removeEventListener(o,f,x,b={}){o.removeEventListener(f,x,"passive"in b?b:b.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",N.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",N.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",N.suppressClickInternal,!0)},0)}static getScale(o){const f=o.getBoundingClientRect();return{x:f.width/o.offsetWidth||1,y:f.height/o.offsetHeight||1,boundingClientRect:f}}static getPoint(o,f,x){const b=f.boundingClientRect;return new a.P((x.clientX-b.left)/f.x-o.clientLeft,(x.clientY-b.top)/f.y-o.clientTop)}static mousePos(o,f){const x=N.getScale(o);return N.getPoint(o,x,f)}static touchPos(o,f){const x=[],b=N.getScale(o);for(let P=0;P<f.length;P++)x.push(N.getPoint(o,b,f[P]));return x}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}static sanitize(o){const f=new DOMParser().parseFromString(o,"text/html").body||document.createElement("body"),x=f.querySelectorAll("script");for(const b of x)b.remove();return N.clean(f),f.innerHTML}static isPossiblyDangerous(o,f){const x=f.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(o)||!x.includes("javascript:")&&!x.includes("data:"))||!!o.startsWith("on")||void 0}static clean(o){const f=o.children;for(const x of f)N.removeAttributes(x),N.clean(x)}static removeAttributes(o){for(const{name:f,value:x}of o.attributes)N.isPossiblyDangerous(f,x)&&o.removeAttribute(f)}}N.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,N.selectProp=N.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),N.transformProp=N.testProp(["transform","WebkitTransform"]);const D={supported:!1,testSupport:function(w){!I&&T&&(z?$(w):O=w)}};let O,T,I=!1,z=!1;function $(w){const o=w.createTexture();w.bindTexture(w.TEXTURE_2D,o);try{if(w.texImage2D(w.TEXTURE_2D,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,T),w.isContextLost())return;D.supported=!0}catch{}w.deleteTexture(o),I=!0}var V;typeof document<"u"&&(T=document.createElement("img"),T.onload=()=>{O&&$(O),O=null,z=!0},T.onerror=()=>{I=!0,O=null},T.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(w){let o,f,x,b;w.resetRequestQueue=()=>{o=[],f=0,x=0,b={}},w.addThrottleControl=B=>{const W=x++;return b[W]=B,W},w.removeThrottleControl=B=>{delete b[B],E()},w.getImage=(B,W,G=!0)=>new Promise((Y,Z)=>{D.supported&&(B.headers||(B.headers={}),B.headers.accept="image/webp,*/*"),a.e(B,{type:"image"}),o.push({abortController:W,requestParameters:B,supportImageRefresh:G,state:"queued",onError:re=>{Z(re)},onSuccess:re=>{Y(re)}}),E()});const P=B=>a._(this,void 0,void 0,function*(){B.state="running";const{requestParameters:W,supportImageRefresh:G,onError:Y,onSuccess:Z,abortController:re}=B,he=G===!1&&!a.i(self)&&!a.g(W.url)&&(!W.headers||Object.keys(W.headers).reduce((Se,Ee)=>Se&&Ee==="accept",!0));f++;const je=he?F(W,re):a.m(W,re);try{const Se=yield je;delete B.abortController,B.state="completed",Se.data instanceof HTMLImageElement||a.b(Se.data)?Z(Se):Se.data&&Z({data:yield(we=Se.data,typeof createImageBitmap=="function"?a.f(we):a.h(we)),cacheControl:Se.cacheControl,expires:Se.expires})}catch(Se){delete B.abortController,Y(Se)}finally{f--,E()}var we}),E=()=>{const B=(()=>{for(const W of Object.keys(b))if(b[W]())return!0;return!1})()?a.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let W=f;W<B&&o.length>0;W++){const G=o.shift();G.abortController.signal.aborted?W--:P(G)}},F=(B,W)=>new Promise((G,Y)=>{const Z=new Image,re=B.url,he=B.credentials;he&&he==="include"?Z.crossOrigin="use-credentials":(he&&he==="same-origin"||!a.d(re))&&(Z.crossOrigin="anonymous"),W.signal.addEventListener("abort",()=>{Z.src="",Y(a.c())}),Z.fetchPriority="high",Z.onload=()=>{Z.onerror=Z.onload=null,G({data:Z})},Z.onerror=()=>{Z.onerror=Z.onload=null,W.signal.aborted||Y(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},Z.src=re})}(V||(V={})),V.resetRequestQueue();class K{constructor(o){this._transformRequestFn=o??null}transformRequest(o,f){return this._transformRequestFn&&this._transformRequestFn(o,f)||{url:o}}setTransformRequest(o){this._transformRequestFn=o}}function te(w){const o=[];if(typeof w=="string")o.push({id:"default",url:w});else if(w&&w.length>0){const f=[];for(const{id:x,url:b}of w){const P=`${x}${b}`;f.indexOf(P)===-1&&(f.push(P),o.push({id:x,url:b}))}}return o}function X(w,o,f){try{const x=new URL(w);return x.pathname+=`${o}${f}`,x.toString()}catch{throw new Error(`Invalid sprite URL "${w}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function ve(w){const{userImage:o}=w;return!!(o&&o.render&&o.render())&&(w.data.replace(new Uint8Array(o.data.buffer)),!0)}class ae extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:f,promiseResolve:x}of this.requestors)x(this._getImagesForIds(f));this.requestors=[]}}getImage(o){const f=this.images[o];if(f&&!f.data&&f.spriteData){const x=f.spriteData;f.data=new a.R({width:x.width,height:x.height},x.context.getImageData(x.x,x.y,x.width,x.height).data),f.spriteData=null}return f}addImage(o,f){if(this.images[o])throw new Error(`Image id ${o} already exist, use updateImage instead`);this._validate(o,f)&&(this.images[o]=f)}_validate(o,f){let x=!0;const b=f.data||f.spriteData;return this._validateStretch(f.stretchX,b&&b.width)||(this.fire(new a.k(new Error(`Image "${o}" has invalid "stretchX" value`))),x=!1),this._validateStretch(f.stretchY,b&&b.height)||(this.fire(new a.k(new Error(`Image "${o}" has invalid "stretchY" value`))),x=!1),this._validateContent(f.content,f)||(this.fire(new a.k(new Error(`Image "${o}" has invalid "content" value`))),x=!1),x}_validateStretch(o,f){if(!o)return!0;let x=0;for(const b of o){if(b[0]<x||b[1]<b[0]||f<b[1])return!1;x=b[1]}return!0}_validateContent(o,f){if(!o)return!0;if(o.length!==4)return!1;const x=f.spriteData,b=x&&x.width||f.data.width,P=x&&x.height||f.data.height;return!(o[0]<0||b<o[0]||o[1]<0||P<o[1]||o[2]<0||b<o[2]||o[3]<0||P<o[3]||o[2]<o[0]||o[3]<o[1])}updateImage(o,f,x=!0){const b=this.getImage(o);if(x&&(b.data.width!==f.data.width||b.data.height!==f.data.height))throw new Error(`size mismatch between old image (${b.data.width}x${b.data.height}) and new image (${f.data.width}x${f.data.height}).`);f.version=b.version+1,this.images[o]=f,this.updatedImages[o]=!0}removeImage(o){const f=this.images[o];delete this.images[o],delete this.patterns[o],f.userImage&&f.userImage.onRemove&&f.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o){return new Promise((f,x)=>{let b=!0;if(!this.isLoaded())for(const P of o)this.images[P]||(b=!1);this.isLoaded()||b?f(this._getImagesForIds(o)):this.requestors.push({ids:o,promiseResolve:f})})}_getImagesForIds(o){const f={};for(const x of o){let b=this.getImage(x);b||(this.fire(new a.l("styleimagemissing",{id:x})),b=this.getImage(x)),b?f[x]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,textFitWidth:b.textFitWidth,textFitHeight:b.textFitHeight,hasRenderCallback:!!(b.userImage&&b.userImage.render)}:a.w(`Image "${x}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return f}getPixelSize(){const{width:o,height:f}=this.atlasImage;return{width:o,height:f}}getPattern(o){const f=this.patterns[o],x=this.getImage(o);if(!x)return null;if(f&&f.position.version===x.version)return f.position;if(f)f.position.version=x.version;else{const b={w:x.data.width+2,h:x.data.height+2,x:0,y:0},P=new a.I(b,x);this.patterns[o]={bin:b,position:P}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const f=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.T(o,this.atlasImage,f.RGBA),this.atlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const P in this.patterns)o.push(this.patterns[P].bin);const{w:f,h:x}=a.p(o),b=this.atlasImage;b.resize({width:f||1,height:x||1});for(const P in this.patterns){const{bin:E}=this.patterns[P],F=E.x+1,B=E.y+1,W=this.getImage(P).data,G=W.width,Y=W.height;a.R.copy(W,b,{x:0,y:0},{x:F,y:B},{width:G,height:Y}),a.R.copy(W,b,{x:0,y:Y-1},{x:F,y:B-1},{width:G,height:1}),a.R.copy(W,b,{x:0,y:0},{x:F,y:B+Y},{width:G,height:1}),a.R.copy(W,b,{x:G-1,y:0},{x:F-1,y:B},{width:1,height:Y}),a.R.copy(W,b,{x:0,y:0},{x:F+G,y:B},{width:1,height:Y})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const f of o){if(this.callbackDispatchedThisFrame[f])continue;this.callbackDispatchedThisFrame[f]=!0;const x=this.getImage(f);x||a.w(`Image with ID: "${f}" was not found`),ve(x)&&this.updateImage(f,x)}}}const pe=1e20;function Oe(w,o,f,x,b,P,E,F,B){for(let W=o;W<o+x;W++)Me(w,f*P+W,P,b,E,F,B);for(let W=f;W<f+b;W++)Me(w,W*P+o,1,x,E,F,B)}function Me(w,o,f,x,b,P,E){P[0]=0,E[0]=-pe,E[1]=pe,b[0]=w[o];for(let F=1,B=0,W=0;F<x;F++){b[F]=w[o+F*f];const G=F*F;do{const Y=P[B];W=(b[F]-b[Y]+G-Y*Y)/(F-Y)/2}while(W<=E[B]&&--B>-1);B++,P[B]=F,E[B]=W,E[B+1]=pe}for(let F=0,B=0;F<x;F++){for(;E[B+1]<F;)B++;const W=P[B],G=F-W;w[o+F*f]=b[W]+G*G}}const Xe=a.v.layout_symbol["text-font"].default.join(",");class Ve{constructor(o,f,x){this.requestManager=o,this.localIdeographFontFamily=f,this.entries={},this.lang=x}setURL(o){this.url=o}getGlyphs(o){return a._(this,void 0,void 0,function*(){const f=[];for(const P in o)for(const E of o[P])f.push(this._getAndCacheGlyphsPromise(P,E));const x=yield Promise.all(f),b={};for(const{stack:P,id:E,glyph:F}of x)b[P]||(b[P]={}),b[P][E]=F&&{id:F.id,bitmap:F.bitmap.clone(),metrics:F.metrics};return b})}_getAndCacheGlyphsPromise(o,f){return a._(this,void 0,void 0,function*(){let x=this.entries[o];x||(x=this.entries[o]={glyphs:{},requests:{},ranges:{}});let b=x.glyphs[f];return b!==void 0?{stack:o,id:f,glyph:b}:!this.url||this._charUsesLocalIdeographFontFamily(f)?(b=x.glyphs[f]=this._drawGlyph(x,o,f),{stack:o,id:f,glyph:b}):yield this._downloadAndCacheRangePromise(o,f)})}_downloadAndCacheRangePromise(o,f){return a._(this,void 0,void 0,function*(){const x=Math.floor(f/256);if(256*x>65535)throw new Error("glyphs > 65535 not supported");const b=this.entries[o];if(b.ranges[x])return{stack:o,id:f,glyph:null};if(!b.requests[x]){const P=Ve.loadGlyphRange(o,x,this.url,this.requestManager);b.requests[x]=P}try{const P=yield b.requests[x];for(const E in P)b.glyphs[+E]=P[+E];return b.ranges[x]=!0,{stack:o,id:f,glyph:P[f]||null}}catch(P){const E=b.glyphs[f]=this._drawGlyph(b,o,f);return this._warnOnMissingGlyphRange(E,x,f,P),{stack:o,id:f,glyph:E}}})}_warnOnMissingGlyphRange(o,f,x,b){const P=256*f,E=P+255,F=x.toString(16).padStart(4,"0").toUpperCase();a.w(`Unable to load glyph range ${f}, ${P}-${E}. Rendering codepoint U+${F} locally instead. ${b}`)}_charUsesLocalIdeographFontFamily(o){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(o))||a.u["CJK Unified Ideographs"](o)||a.u["Hangul Syllables"](o)||a.u.Hiragana(o)||a.u.Katakana(o)||a.u["CJK Symbols and Punctuation"](o)||a.u["Halfwidth and Fullwidth Forms"](o))}_drawGlyph(o,f,x){const b=f===Xe&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(x),P=b?"ideographTinySDF":"tinySDF";o[P]||(o[P]=this._createTinySDF(b?this.localIdeographFontFamily:f));const E=o[P].draw(String.fromCharCode(x));return{id:x,bitmap:new a.q({width:E.width||60,height:E.height||60},E.data),metrics:{width:E.glyphWidth/2||24,height:E.glyphHeight/2||24,left:E.glyphLeft/2+.5||0,top:E.glyphTop/2-27.5||-8,advance:E.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(o){const f=o?o.split(","):[];f.push("sans-serif");const x=f.map(b=>/[-\w]+/.test(b)?b:`'${CSS.escape(b)}'`).join(",");return new Ve.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:x,fontWeight:this._fontWeight(f[0]),fontStyle:this._fontStyle(f[0]),lang:this.lang})}_fontStyle(o){return/italic/i.test(o)?"italic":/oblique/i.test(o)?"oblique":"normal"}_fontWeight(o){const f={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let x;for(const[b,P]of Object.entries(f))new RegExp(`\\b${b}\\b`,"i").test(o)&&(x=`${P}`);return x}}Ve.loadGlyphRange=function(w,o,f,x){return a._(this,void 0,void 0,function*(){const b=256*o,P=b+255,E=x.transformRequest(f.replace("{fontstack}",w).replace("{range}",`${b}-${P}`),"Glyphs"),F=yield a.n(E,new AbortController);if(!F||!F.data)throw new Error(`Could not load glyph range. range: ${o}, ${b}-${P}`);const B={};for(const W of a.o(F.data))B[W.id]=W;return B})},Ve.TinySDF=class{constructor({fontSize:w=24,buffer:o=3,radius:f=8,cutoff:x=.25,fontFamily:b="sans-serif",fontWeight:P="normal",fontStyle:E="normal",lang:F=null}={}){this.buffer=o,this.cutoff=x,this.radius=f,this.lang=F;const B=this.size=w+4*o,W=this._createCanvas(B),G=this.ctx=W.getContext("2d",{willReadFrequently:!0});G.font=`${E} ${P} ${w}px ${b}`,G.textBaseline="alphabetic",G.textAlign="left",G.fillStyle="black",this.gridOuter=new Float64Array(B*B),this.gridInner=new Float64Array(B*B),this.f=new Float64Array(B),this.z=new Float64Array(B+1),this.v=new Uint16Array(B)}_createCanvas(w){const o=document.createElement("canvas");return o.width=o.height=w,o}draw(w){const{width:o,actualBoundingBoxAscent:f,actualBoundingBoxDescent:x,actualBoundingBoxLeft:b,actualBoundingBoxRight:P}=this.ctx.measureText(w),E=Math.ceil(f),F=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(P-b))),B=Math.min(this.size-this.buffer,E+Math.ceil(x)),W=F+2*this.buffer,G=B+2*this.buffer,Y=Math.max(W*G,0),Z=new Uint8ClampedArray(Y),re={data:Z,width:W,height:G,glyphWidth:F,glyphHeight:B,glyphTop:E,glyphLeft:0,glyphAdvance:o};if(F===0||B===0)return re;const{ctx:he,buffer:je,gridInner:we,gridOuter:Se}=this;this.lang&&(he.lang=this.lang),he.clearRect(je,je,F,B),he.fillText(w,je,je+E);const Ee=he.getImageData(je,je,F,B);Se.fill(pe,0,Y),we.fill(0,0,Y);for(let Re=0;Re<B;Re++)for(let Te=0;Te<F;Te++){const Le=Ee.data[4*(Re*F+Te)+3]/255;if(Le===0)continue;const $e=(Re+je)*W+Te+je;if(Le===1)Se[$e]=0,we[$e]=pe;else{const Ie=.5-Le;Se[$e]=Ie>0?Ie*Ie:0,we[$e]=Ie<0?Ie*Ie:0}}Oe(Se,0,0,W,G,W,this.f,this.v,this.z),Oe(we,je,je,F,B,W,this.f,this.v,this.z);for(let Re=0;Re<Y;Re++){const Te=Math.sqrt(Se[Re])-Math.sqrt(we[Re]);Z[Re]=Math.round(255-255*(Te/this.radius+this.cutoff))}return re}};class et{constructor(){this.specification=a.t.light.position}possiblyEvaluate(o,f){return a.C(o.expression.evaluate(f))}interpolate(o,f,x){return{x:a.F.number(o.x,f.x,x),y:a.F.number(o.y,f.y,x),z:a.F.number(o.z,f.z,x)}}}let Ce;class _e extends a.E{constructor(o){super(),Ce=Ce||new a.r({anchor:new a.D(a.t.light.anchor),position:new et,color:new a.D(a.t.light.color),intensity:new a.D(a.t.light.intensity)}),this._transitionable=new a.x(Ce,void 0),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,f={}){if(!this._validate(a.y,o,f))for(const x in o){const b=o[x];x.endsWith("-transition")?this._transitionable.setTransition(x.slice(0,-11),b):this._transitionable.setValue(x,b)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,f,x){return(!x||x.validate!==!1)&&a.z(this,o.call(a.B,{value:f,style:{glyphs:!0,sprite:!0},styleSpec:a.t}))}}const tt=new a.r({"sky-color":new a.D(a.t.sky["sky-color"]),"horizon-color":new a.D(a.t.sky["horizon-color"]),"fog-color":new a.D(a.t.sky["fog-color"]),"fog-ground-blend":new a.D(a.t.sky["fog-ground-blend"]),"horizon-fog-blend":new a.D(a.t.sky["horizon-fog-blend"]),"sky-horizon-blend":new a.D(a.t.sky["sky-horizon-blend"]),"atmosphere-blend":new a.D(a.t.sky["atmosphere-blend"])});class vt extends a.E{constructor(o){super(),this._transitionable=new a.x(tt,void 0),this.setSky(o),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.G(0))}setSky(o,f={}){if(!this._validate(a.H,o,f)){o||(o={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const x in o){const b=o[x];x.endsWith("-transition")?this._transitionable.setTransition(x.slice(0,-11),b):this._transitionable.setValue(x,b)}}}getSky(){return this._transitionable.serialize()}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,f,x={}){return(x==null?void 0:x.validate)!==!1&&a.z(this,o.call(a.B,a.e({value:f,style:{glyphs:!0,sprite:!0},styleSpec:a.t})))}calculateFogBlendOpacity(o){return o<60?0:o<70?(o-60)/10:1}}class gt{constructor(o,f){this.width=o,this.height=f,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,f){const x=o.join(",")+String(f);return this.dashEntry[x]||(this.dashEntry[x]=this.addDash(o,f)),this.dashEntry[x]}getDashRanges(o,f,x){const b=[];let P=o.length%2==1?-o[o.length-1]*x:0,E=o[0]*x,F=!0;b.push({left:P,right:E,isDash:F,zeroLength:o[0]===0});let B=o[0];for(let W=1;W<o.length;W++){F=!F;const G=o[W];P=B*x,B+=G,E=B*x,b.push({left:P,right:E,isDash:F,zeroLength:G===0})}return b}addRoundDash(o,f,x){const b=f/2;for(let P=-x;P<=x;P++){const E=this.width*(this.nextRow+x+P);let F=0,B=o[F];for(let W=0;W<this.width;W++){W/B.right>1&&(B=o[++F]);const G=Math.abs(W-B.left),Y=Math.abs(W-B.right),Z=Math.min(G,Y);let re;const he=P/x*(b+1);if(B.isDash){const je=b-Math.abs(he);re=Math.sqrt(Z*Z+je*je)}else re=b-Math.sqrt(Z*Z+he*he);this.data[E+W]=Math.max(0,Math.min(255,re+128))}}}addRegularDash(o){for(let F=o.length-1;F>=0;--F){const B=o[F],W=o[F+1];B.zeroLength?o.splice(F,1):W&&W.isDash===B.isDash&&(W.left=B.left,o.splice(F,1))}const f=o[0],x=o[o.length-1];f.isDash===x.isDash&&(f.left=x.left-this.width,x.right=f.right+this.width);const b=this.width*this.nextRow;let P=0,E=o[P];for(let F=0;F<this.width;F++){F/E.right>1&&(E=o[++P]);const B=Math.abs(F-E.left),W=Math.abs(F-E.right),G=Math.min(B,W);this.data[b+F]=Math.max(0,Math.min(255,(E.isDash?G:-G)+128))}}addDash(o,f){const x=f?7:0,b=2*x+1;if(this.nextRow+b>this.height)return a.w("LineAtlas out of space"),null;let P=0;for(let F=0;F<o.length;F++)P+=o[F];if(P!==0){const F=this.width/P,B=this.getDashRanges(o,this.width,F);f?this.addRoundDash(B,F,x):this.addRegularDash(B)}const E={y:this.nextRow+x,height:2*x,width:P};return this.nextRow+=b,this.dirty=!0,E}bind(o){const f=o.gl;this.texture?(f.bindTexture(f.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,f.texSubImage2D(f.TEXTURE_2D,0,0,0,this.width,this.height,f.ALPHA,f.UNSIGNED_BYTE,this.data))):(this.texture=f.createTexture(),f.bindTexture(f.TEXTURE_2D,this.texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texImage2D(f.TEXTURE_2D,0,f.ALPHA,this.width,this.height,0,f.ALPHA,f.UNSIGNED_BYTE,this.data))}}const Tt="maplibre_preloaded_worker_pool";class Ht{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<Ht.workerCount;)this.workers.push(new Worker(a.a.WORKER_URL));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(f=>{f.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Tt]}numActive(){return Object.keys(this.active).length}}const Ir=Math.floor(j.hardwareConcurrency/2);let Pr,Mt;function yr(){return Pr||(Pr=new Ht),Pr}Ht.workerCount=a.J(globalThis)?Math.max(Math.min(Ir,3),1):1;class Nt{constructor(o,f){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=f;const x=this.workerPool.acquire(f);for(let b=0;b<x.length;b++){const P=new a.K(x[b],f);P.name=`Worker ${b}`,this.actors.push(P)}if(!this.actors.length)throw new Error("No actors found")}broadcast(o,f){const x=[];for(const b of this.actors)x.push(b.sendAsync({type:o,data:f}));return Promise.all(x)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(o=!0){this.actors.forEach(f=>{f.remove()}),this.actors=[],o&&this.workerPool.release(this.id)}registerMessageHandler(o,f){for(const x of this.actors)x.registerMessageHandler(o,f)}}function Wt(){return Mt||(Mt=new Nt(yr(),a.L),Mt.registerMessageHandler("GR",(w,o,f)=>a.m(o,f))),Mt}function Zt(w,o){const f=a.M();return a.N(f,f,[1,1,0]),a.O(f,f,[.5*w.width,.5*w.height,1]),w.calculatePosMatrix?a.Q(f,f,w.calculatePosMatrix(o.toUnwrapped())):f}function mt(w,o,f,x,b,P,E){var F;const B=function(Z,re,he){if(Z)for(const je of Z){const we=re[je];if(we&&we.source===he&&we.type==="fill-extrusion")return!0}else for(const je in re){const we=re[je];if(we.source===he&&we.type==="fill-extrusion")return!0}return!1}((F=b==null?void 0:b.layers)!==null&&F!==void 0?F:null,o,w.id),W=P.maxPitchScaleFactor(),G=w.tilesIn(x,W,B);G.sort(qr);const Y=[];for(const Z of G)Y.push({wrappedTileID:Z.tileID.wrapped().key,queryResults:Z.tile.queryRenderedFeatures(o,f,w.getState(),Z.queryGeometry,Z.cameraQueryGeometry,Z.scale,b,P,W,Zt(P,Z.tileID),E?(re,he)=>E(Z.tileID,re,he):void 0)});return function(Z,re){for(const he in Z)for(const je of Z[he])ar(je,re);return Z}(function(Z){const re={},he={};for(const je of Z){const we=je.queryResults,Se=je.wrappedTileID,Ee=he[Se]=he[Se]||{};for(const Re in we){const Te=we[Re],Le=Ee[Re]=Ee[Re]||{},$e=re[Re]=re[Re]||[];for(const Ie of Te)Le[Ie.featureIndex]||(Le[Ie.featureIndex]=!0,$e.push(Ie))}}return re}(Y),w)}function qr(w,o){const f=w.tileID,x=o.tileID;return f.overscaledZ-x.overscaledZ||f.canonical.y-x.canonical.y||f.wrap-x.wrap||f.canonical.x-x.canonical.x}function ar(w,o){const f=w.feature,x=o.getFeatureState(f.layer["source-layer"],f.id);f.source=f.layer.source,f.layer["source-layer"]&&(f.sourceLayer=f.layer["source-layer"]),f.state=x}function en(w,o,f){return a._(this,void 0,void 0,function*(){let x=w;if(w.url?x=(yield a.j(o.transformRequest(w.url,"Source"),f)).data:yield j.frameAsync(f),!x)return null;const b=a.S(a.e(x,w),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in x&&x.vector_layers&&(b.vectorLayerIds=x.vector_layers.map(P=>P.id)),b})}class Lr{constructor(o,f){o&&(f?this.setSouthWest(o).setNorthEast(f):Array.isArray(o)&&(o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1])))}setNorthEast(o){return this._ne=o instanceof a.U?new a.U(o.lng,o.lat):a.U.convert(o),this}setSouthWest(o){return this._sw=o instanceof a.U?new a.U(o.lng,o.lat):a.U.convert(o),this}extend(o){const f=this._sw,x=this._ne;let b,P;if(o instanceof a.U)b=o,P=o;else{if(!(o instanceof Lr))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(Lr.convert(o)):this.extend(a.U.convert(o)):o&&("lng"in o||"lon"in o)&&"lat"in o?this.extend(a.U.convert(o)):this;if(b=o._sw,P=o._ne,!b||!P)return this}return f||x?(f.lng=Math.min(b.lng,f.lng),f.lat=Math.min(b.lat,f.lat),x.lng=Math.max(P.lng,x.lng),x.lat=Math.max(P.lat,x.lat)):(this._sw=new a.U(b.lng,b.lat),this._ne=new a.U(P.lng,P.lat)),this}getCenter(){return new a.U((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.U(this.getWest(),this.getNorth())}getSouthEast(){return new a.U(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:f,lat:x}=a.U.convert(o);let b=this._sw.lng<=f&&f<=this._ne.lng;return this._sw.lng>this._ne.lng&&(b=this._sw.lng>=f&&f>=this._ne.lng),this._sw.lat<=x&&x<=this._ne.lat&&b}intersects(o){if((o=Lr.convert(o)).getNorth()<this.getSouth()||o.getSouth()>this.getNorth())return!1;const f=a.V(this.getWest(),-180,180),x=a.V(this.getEast(),-180,180),b=a.V(o.getWest(),-180,180),P=a.V(o.getEast(),-180,180),E=f>x,F=b>P;return!(!E||!F)||(E?P>=f||b<=x:F?x>=b||f<=P:!(b>x||P<f))}static convert(o){return o instanceof Lr?o:o&&new Lr(o)}static fromLngLat(o,f=0){const x=360*f/40075017,b=x/Math.cos(Math.PI/180*o.lat);return new Lr(new a.U(o.lng-b,o.lat-x),new a.U(o.lng+b,o.lat+x))}adjustAntiMeridian(){const o=new a.U(this._sw.lng,this._sw.lat),f=new a.U(this._ne.lng,this._ne.lat);return new Lr(o,o.lng>f.lng?new a.U(f.lng+360,f.lat):f)}}class An{constructor(o,f,x){this.bounds=Lr.convert(this.validateBounds(o)),this.minzoom=f||0,this.maxzoom=x||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const f=Math.pow(2,o.z),x=Math.floor(a.X(this.bounds.getWest())*f),b=Math.floor(a.W(this.bounds.getNorth())*f),P=Math.ceil(a.X(this.bounds.getEast())*f),E=Math.ceil(a.W(this.bounds.getSouth())*f);return o.x>=x&&o.x<P&&o.y>=b&&o.y<E}}class vs extends a.E{constructor(o,f,x,b){if(super(),this.id=o,this.dispatcher=x,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.S(f,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},f),this._collectResourceTiming=f.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(b)}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield en(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),o&&(a.e(this,o),o.bounds&&(this.tileBounds=new An(o.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})))}catch(o){this._tileJSONRequest=null,this._loaded=!0,this.fire(new a.k(o))}})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.abort(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return a.e({},this._options)}loadTile(o){return a._(this,void 0,void 0,function*(){const f=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),x={request:this.map._requestManager.transformRequest(f,"Tile"),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};x.request.collectResourceTiming=this._collectResourceTiming;let b="RT";if(o.actor&&o.state!=="expired"){if(o.state==="loading")return new Promise((P,E)=>{o.reloadPromise={resolve:P,reject:E}})}else o.actor=this.dispatcher.getActor(),b="LT";o.abortController=new AbortController;try{const P=yield o.actor.sendAsync({type:b,data:x},o.abortController);if(delete o.abortController,o.aborted)return;this._afterTileLoadWorkerResponse(o,P)}catch(P){if(delete o.abortController,o.aborted)return;if(P&&P.status!==404)throw P;this._afterTileLoadWorkerResponse(o,null)}})}_afterTileLoadWorkerResponse(o,f){if(f&&f.resourceTiming&&(o.resourceTiming=f.resourceTiming),f&&this.map._refreshExpiredTiles&&o.setExpiryData(f),o.loadVectorData(f,this.map.painter),o.reloadPromise){const x=o.reloadPromise;o.reloadPromise=null,this.loadTile(o).then(x.resolve).catch(x.reject)}}abortTile(o){return a._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController),o.actor&&(yield o.actor.sendAsync({type:"AT",data:{uid:o.uid,type:this.type,source:this.id}}))})}unloadTile(o){return a._(this,void 0,void 0,function*(){o.unloadVectorData(),o.actor&&(yield o.actor.sendAsync({type:"RMT",data:{uid:o.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Wn extends a.E{constructor(o,f,x,b){super(),this.id=o,this.dispatcher=x,this.setEventedParent(b),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},f),a.e(this,a.S(f,["url","scheme","tileSize"]))}load(){return a._(this,arguments,void 0,function*(o=!1){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const f=yield en(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,f&&(a.e(this,f),f.bounds&&(this.tileBounds=new An(f.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:o})))}catch(f){this._tileJSONRequest=null,this._loaded=!0,this.fire(new a.k(f))}})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(o){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),o(),this.load(!0)}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}serialize(){return a.e({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o){return a._(this,void 0,void 0,function*(){const f=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.abortController=new AbortController;try{const x=yield V.getImage(this.map._requestManager.transformRequest(f,"Tile"),o.abortController,this.map._refreshExpiredTiles);if(delete o.abortController,o.aborted)return void(o.state="unloaded");if(x&&x.data){this.map._refreshExpiredTiles&&(x.cacheControl||x.expires)&&o.setExpiryData({cacheControl:x.cacheControl,expires:x.expires});const b=this.map.painter.context,P=b.gl,E=x.data;o.texture=this.map.painter.getTileTexture(E.width),o.texture?o.texture.update(E,{useMipmap:!0}):(o.texture=new a.T(b,E,P.RGBA,{useMipmap:!0}),o.texture.bind(P.LINEAR,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST)),o.state="loaded"}}catch(x){if(delete o.abortController,o.aborted)o.state="unloaded";else if(x)throw o.state="errored",x}})}abortTile(o){return a._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController)})}unloadTile(o){return a._(this,void 0,void 0,function*(){o.texture&&this.map.painter.saveTileTexture(o.texture)})}hasTransition(){return!1}}class Be extends Wn{constructor(o,f,x,b){super(o,f,x,b),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},f),this.encoding=f.encoding||"mapbox",this.redFactor=f.redFactor,this.greenFactor=f.greenFactor,this.blueFactor=f.blueFactor,this.baseShift=f.baseShift}loadTile(o){return a._(this,void 0,void 0,function*(){const f=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),x=this.map._requestManager.transformRequest(f,"Tile");o.neighboringTiles=this._getNeighboringTiles(o.tileID),o.abortController=new AbortController;try{const b=yield V.getImage(x,o.abortController,this.map._refreshExpiredTiles);if(delete o.abortController,o.aborted)return void(o.state="unloaded");if(b&&b.data){const P=b.data;this.map._refreshExpiredTiles&&(b.cacheControl||b.expires)&&o.setExpiryData({cacheControl:b.cacheControl,expires:b.expires});const E=a.b(P)&&a.Y()?P:yield this.readImageNow(P),F={type:this.type,uid:o.uid,source:this.id,rawImageData:E,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!o.actor||o.state==="expired"){o.actor=this.dispatcher.getActor();const B=yield o.actor.sendAsync({type:"LDT",data:F});o.dem=B,o.needsHillshadePrepare=!0,o.needsTerrainPrepare=!0,o.state="loaded"}}}catch(b){if(delete o.abortController,o.aborted)o.state="unloaded";else if(b)throw o.state="errored",b}})}readImageNow(o){return a._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&a.Z()){const f=o.width+2,x=o.height+2;try{return new a.R({width:f,height:x},yield a.$(o,-1,-1,f,x))}catch{}}return j.getImageData(o,1)})}_getNeighboringTiles(o){const f=o.canonical,x=Math.pow(2,f.z),b=(f.x-1+x)%x,P=f.x===0?o.wrap-1:o.wrap,E=(f.x+1+x)%x,F=f.x+1===x?o.wrap+1:o.wrap,B={};return B[new a.a0(o.overscaledZ,P,f.z,b,f.y).key]={backfilled:!1},B[new a.a0(o.overscaledZ,F,f.z,E,f.y).key]={backfilled:!1},f.y>0&&(B[new a.a0(o.overscaledZ,P,f.z,b,f.y-1).key]={backfilled:!1},B[new a.a0(o.overscaledZ,o.wrap,f.z,f.x,f.y-1).key]={backfilled:!1},B[new a.a0(o.overscaledZ,F,f.z,E,f.y-1).key]={backfilled:!1}),f.y+1<x&&(B[new a.a0(o.overscaledZ,P,f.z,b,f.y+1).key]={backfilled:!1},B[new a.a0(o.overscaledZ,o.wrap,f.z,f.x,f.y+1).key]={backfilled:!1},B[new a.a0(o.overscaledZ,F,f.z,E,f.y+1).key]={backfilled:!1}),B}unloadTile(o){return a._(this,void 0,void 0,function*(){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&(yield o.actor.sendAsync({type:"RDT",data:{type:this.type,uid:o.uid,source:this.id}}))})}}function rt(w){return w.type==="GeometryCollection"?w.geometries.map(o=>o.coordinates).flat(1/0):w.coordinates.flat(1/0)}function pt(w){const o=new Lr;let f;switch(w.type){case"FeatureCollection":f=w.features.map(x=>rt(x.geometry)).flat(1/0);break;case"Feature":f=rt(w.geometry);break;default:f=rt(w)}if(f.length==0)return o;for(let x=0;x<f.length-1;x+=2)o.extend([f[x],f[x+1]]);return o}class Lt extends a.E{constructor(o,f,x,b){super(),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:f.data},this.actor=x.getActor(),this.setEventedParent(b),this._data=f.data,this._options=a.e({},f),this._collectResourceTiming=f.collectResourceTiming,f.maxzoom!==void 0&&(this.maxzoom=f.maxzoom),f.type&&(this.type=f.type),f.attribution&&(this.attribution=f.attribution),this.promoteId=f.promoteId,f.clusterMaxZoom!==void 0&&this.maxzoom<=f.clusterMaxZoom&&a.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${f.clusterMaxZoom}".`),this.workerOptions=a.e({source:this.id,cluster:f.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(f.buffer!==void 0?f.buffer:128),tolerance:this._pixelsToTileUnits(f.tolerance!==void 0?f.tolerance:.375),extent:a.a3,maxZoom:this.maxzoom,lineMetrics:f.lineMetrics||!1,generateId:f.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(f.clusterMaxZoom),minPoints:Math.max(2,f.clusterMinPoints||2),extent:a.a3,radius:this._pixelsToTileUnits(f.clusterRadius||50),log:!1,generateId:f.generateId||!1},clusterProperties:f.clusterProperties,filter:f.filter},f.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(o){return o*(a.a3/this.tileSize)}_getClusterMaxZoom(o){const f=o?Math.round(o):this.maxzoom-1;return Number.isInteger(o)||o===void 0||a.w(`Integer expected for option 'clusterMaxZoom': provided value "${o}" rounded to "${f}"`),f}load(){return a._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._pendingWorkerUpdate={data:o},this._updateWorkerData(),this}updateData(o){return this._pendingWorkerUpdate.diff=a.a4(this._pendingWorkerUpdate.diff,o),this._updateWorkerData(),this}getData(){return a._(this,void 0,void 0,function*(){const o=a.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:o})})}getBounds(){return a._(this,void 0,void 0,function*(){return pt(yield this.getData())})}setClusterOptions(o){return this.workerOptions.cluster=o.cluster,o.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(o.clusterRadius)),o.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(o.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(o){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:o,source:this.id}})}getClusterChildren(o){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:o,source:this.id}})}getClusterLeaves(o,f,x){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:o,limit:f,offset:x}})}_updateWorkerData(){return a._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void a.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:o,diff:f}=this._pendingWorkerUpdate,x=a.e({type:this.type},this.workerOptions);o?(typeof o=="string"?(x.request=this.map._requestManager.transformRequest(j.resolveURL(o),"Source"),x.request.collectResourceTiming=this._collectResourceTiming):x.data=JSON.stringify(o),this._pendingWorkerUpdate.data=void 0):f&&(x.dataDiff=f,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new a.l("dataloading",{dataType:"source"}));try{const b=yield this.actor.sendAsync({type:"LD",data:x});if(this._isUpdatingWorker=!1,this._removed||b.abandoned)return void this.fire(new a.l("dataabort",{dataType:"source"}));this._data=b.data;let P=null;b.resourceTiming&&b.resourceTiming[this.id]&&(P=b.resourceTiming[this.id].slice(0));const E={dataType:"source"};this._collectResourceTiming&&P&&P.length>0&&a.e(E,{resourceTiming:P}),this.fire(new a.l("data",Object.assign(Object.assign({},E),{sourceDataType:"metadata"}))),this.fire(new a.l("data",Object.assign(Object.assign({},E),{sourceDataType:"content",shouldReloadTileOptions:this._getShouldReloadTileOptions(f)})))}catch(b){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new a.l("dataabort",{dataType:"source"}));this.fire(new a.k(b))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}})}_getShouldReloadTileOptions(o){if(!o||o.removeAll)return;const{add:f=[],update:x=[],remove:b=[]}=o||{},P=new Set([...x.map(E=>E.id),...b]);return{nextBounds:[...x.map(E=>E.newGeometry),...f.map(E=>E.geometry)].map(E=>pt(E)),prevIds:P}}shouldReloadTile(o,{nextBounds:f,prevIds:x}){const b=o.latestFeatureIndex.loadVTLayers();for(let B=0;B<o.latestFeatureIndex.featureIndexArray.length;B++){const W=o.latestFeatureIndex.featureIndexArray.get(B),G=b._geojsonTileLayer.feature(W.featureIndex);if(x.has(G.id))return!0}const{buffer:P,extent:E}=this.workerOptions.geojsonVtOptions,F=function({x:B,y:W,z:G},Y=0){const Z=a.a1((B-Y)/Math.pow(2,G)),re=a.a2((W+1+Y)/Math.pow(2,G)),he=a.a1((B+1+Y)/Math.pow(2,G)),je=a.a2((W-Y)/Math.pow(2,G));return new Lr([Z,re],[he,je])}(o.tileID.canonical,P/E);for(const B of f)if(F.intersects(B))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(o){return a._(this,void 0,void 0,function*(){const f=o.actor?"RT":"LT";o.actor=this.actor;const x={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};o.abortController=new AbortController;const b=yield this.actor.sendAsync({type:f,data:x},o.abortController);delete o.abortController,o.unloadVectorData(),o.aborted||o.loadVectorData(b,this.map.painter,f==="RT")})}abortTile(o){return a._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController),o.aborted=!0})}unloadTile(o){return a._(this,void 0,void 0,function*(){o.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:o.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return a.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Rt extends a.E{constructor(o,f,x,b){super(),this.flippedWindingOrder=!1,this.id=o,this.dispatcher=x,this.coordinates=f.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(b),this.options=f}load(o){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const f=yield V.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,f&&f.data&&(this.image=f.data,o&&(this.coordinates=o),this._finishLoading())}catch(f){this._request=null,this._loaded=!0,this.fire(new a.k(f))}})}loaded(){return this._loaded}updateImage(o){return o.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=o.url,this.load(o.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(o){this.coordinates=o;const f=o.map(a.a5.fromLngLat);var x;return this.tileID=function(b){const P=a.a6.fromPoints(b),E=P.width(),F=P.height(),B=Math.max(E,F),W=Math.max(0,Math.floor(-Math.log(B)/Math.LN2)),G=Math.pow(2,W);return new a.a8(W,Math.floor((P.minX+P.maxX)/2*G),Math.floor((P.minY+P.maxY)/2*G))}(f),this.terrainTileRanges=this._getOverlappingTileRanges(f),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=f.map(b=>this.tileID.getTilePoint(b)._round()),this.flippedWindingOrder=((x=this.tileCoords)[1].x-x[0].x)*(x[2].y-x[0].y)-(x[1].y-x[0].y)*(x[2].x-x[0].x)<0,this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,f=o.gl;this.texture||(this.texture=new a.T(o,this.image,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE));let x=!1;for(const b in this.tiles){const P=this.tiles[b];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture,x=!0)}x&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(o){return a._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={}):o.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(o){const{minX:f,minY:x,maxX:b,maxY:P}=a.a6.fromPoints(o),E={};for(let F=0;F<=a.a7;F++){const B=Math.pow(2,F),W=Math.floor(f*B),G=Math.floor(x*B),Y=Math.floor(b*B),Z=Math.floor(P*B);E[F]={minTileX:W,minTileY:G,maxTileX:Y,maxTileY:Z}}return E}}class Ot extends Rt{constructor(o,f,x,b){super(o,f,x,b),this.roundZoom=!0,this.type="video",this.options=f}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1;const o=this.options;this.urls=[];for(const f of o.urls)this.urls.push(this.map._requestManager.transformRequest(f,"Source").url);try{const f=yield a.a9(this.urls);if(this._loaded=!0,!f)return;this.video=f,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(f){this.fire(new a.k(f))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const f=this.video.seekable;o<f.start(0)||o>f.end(0)?this.fire(new a.k(new a.aa(`sources.${this.id}`,null,`Playback for this video can be set only between the ${f.start(0)} and ${f.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const o=this.map.painter.context,f=o.gl;this.texture?this.video.paused||(this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE),f.texSubImage2D(f.TEXTURE_2D,0,0,0,f.RGBA,f.UNSIGNED_BYTE,this.video)):(this.texture=new a.T(o,this.video,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE));let x=!1;for(const b in this.tiles){const P=this.tiles[b];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture,x=!0)}x&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class tr extends Rt{constructor(o,f,x,b){super(o,f,x,b),f.coordinates?Array.isArray(f.coordinates)&&f.coordinates.length===4&&!f.coordinates.some(P=>!Array.isArray(P)||P.length!==2||P.some(E=>typeof E!="number"))||this.fire(new a.k(new a.aa(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.k(new a.aa(`sources.${o}`,null,'missing required property "coordinates"'))),f.animate&&typeof f.animate!="boolean"&&this.fire(new a.k(new a.aa(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),f.canvas?typeof f.canvas=="string"||f.canvas instanceof HTMLCanvasElement||this.fire(new a.k(new a.aa(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.k(new a.aa(`sources.${o}`,null,'missing required property "canvas"'))),this.options=f,this.animate=f.animate===void 0||f.animate}load(){return a._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const f=this.map.painter.context,x=f.gl;this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.T(f,this.canvas,x.RGBA,{premultiply:!0});let b=!1;for(const P in this.tiles){const E=this.tiles[P];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,b=!0)}b&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const tn={},Sn=w=>{switch(w){case"geojson":return Lt;case"image":return Rt;case"raster":return Wn;case"raster-dem":return Be;case"vector":return vs;case"video":return Ot;case"canvas":return tr}return tn[w]},ks="RTLPluginLoaded";class Ue extends a.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Wt()}_syncState(o){return this.status=o,this.dispatcher.broadcast("SRPS",{pluginStatus:o,pluginURL:this.url}).catch(f=>{throw this.status="error",f})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(o){return a._(this,arguments,void 0,function*(f,x=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=j.resolveURL(f),!this.url)throw new Error(`requested url ${f} is invalid`);if(this.status==="unavailable"){if(!x)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return a._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new a.l(ks))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let ce=null;function ue(){return ce||(ce=new Ue),ce}var ye,Ae;(function(w){w[w.Base=0]="Base",w[w.Parent=1]="Parent"})(ye||(ye={})),function(w){w[w.Departing=0]="Departing",w[w.Incoming=1]="Incoming"}(Ae||(Ae={}));class Fe{constructor(o,f){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=o,this.uid=a.ab(),this.uses=0,this.tileSize=f,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(o){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(o||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:o,fadingDirection:f,fadingParentID:x,fadeEndTime:b}){this.resetFadeLogic(),this.fadingRole=o,this.fadingDirection=f,this.fadingParentID=x,this.fadeEndTime=b}setSelfFadeLogic(o){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=o}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=k(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(o){this.demTexture&&o.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(o,f,x){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(b,P){const E={};if(!P)return E;for(const F of b){const B=F.layerIds.map(W=>P.getLayer(W)).filter(Boolean);if(B.length!==0){F.layers=B,F.stateDependentLayerIds&&(F.stateDependentLayers=F.stateDependentLayerIds.map(W=>B.filter(G=>G.id===W)[0]));for(const W of B)E[W.id]=F}}return E}(o.buckets,f==null?void 0:f.style),this.hasSymbolBuckets=!1;for(const b in this.buckets){const P=this.buckets[b];if(P instanceof a.ad){if(this.hasSymbolBuckets=!0,!x)break;P.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const b in this.buckets){const P=this.buckets[b];if(P instanceof a.ad&&P.hasRTLText){this.hasRTLText=!0,ue().lazyLoad();break}}this.queryPadding=0;for(const b in this.buckets){const P=this.buckets[b];this.queryPadding=Math.max(this.queryPadding,f.style.getLayer(b).queryRadius(P))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),this.dashPositions=o.dashPositions}else this.collisionBoxArray=new a.ac}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const x in this.buckets){const b=this.buckets[x];b.uploadPending()&&b.upload(o)}const f=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new a.T(o,this.imageAtlas.image,f.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new a.T(o,this.glyphAtlasImage,f.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,f,x,b,P,E,F,B,W,G,Y){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:b,cameraQueryGeometry:P,scale:E,tileSize:this.tileSize,pixelPosMatrix:G,transform:B,params:F,queryPadding:this.queryPadding*W,getElevation:Y},o,f,x):{}}querySourceFeatures(o,f){const x=this.latestFeatureIndex;if(!x||!x.rawTileData)return;const b=x.loadVTLayers(),P=f&&f.sourceLayer?f.sourceLayer:"",E=b._geojsonTileLayer||b[P];if(!E)return;const F=a.ae(f==null?void 0:f.filter,f==null?void 0:f.globalState),{z:B,x:W,y:G}=this.tileID.canonical,Y={z:B,x:W,y:G};for(let Z=0;Z<E.length;Z++){const re=E.feature(Z);if(F.needGeometry){const we=a.af(re,!0);if(!F.filter(new a.G(this.tileID.overscaledZ),we,this.tileID.canonical))continue}else if(!F.filter(new a.G(this.tileID.overscaledZ),re))continue;const he=x.getId(re,P),je=new a.ag(re,B,W,G,he);je.tile=Y,o.push(je)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const f=this.expirationTime;if(o.cacheControl){const x=a.ah(o.cacheControl);x["max-age"]&&(this.expirationTime=Date.now()+1e3*x["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const x=Date.now();let b=!1;if(this.expirationTime>x)b=!1;else if(f)if(this.expirationTime<f)b=!0;else{const P=this.expirationTime-f;P?this.expirationTime=x+Math.max(P,3e4):b=!0}else b=!0;b?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,f){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0)return;const x=this.latestFeatureIndex.loadVTLayers();for(const b in this.buckets){if(!f.style.hasLayer(b))continue;const P=this.buckets[b],E=P.layers[0].sourceLayer||"_geojsonTileLayer",F=x[E],B=o[E];if(!F||!B||Object.keys(B).length===0)continue;P.update(B,F,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const W=f&&f.style&&f.style.getLayer(b);W&&(this.queryPadding=Math.max(this.queryPadding,W.queryRadius(P)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<k()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(o){this.symbolFadeHoldUntil=k()+o}setDependencies(o,f){const x={};for(const b of f)x[b]=!0;this.dependencies[o]=x}hasDependency(o,f){for(const x of o){const b=this.dependencies[x];if(b){for(const P of f)if(b[P])return!0}}return!1}}class Ye{constructor(o,f){this.max=o,this.onRemove=f,this.reset()}reset(){for(const o in this.data)for(const f of this.data[o])f.timeout&&clearTimeout(f.timeout),this.onRemove(f.value);return this.data={},this.order=[],this}add(o,f,x){const b=o.wrapped().key;this.data[b]===void 0&&(this.data[b]=[]);const P={value:f,timeout:void 0};if(x!==void 0&&(P.timeout=setTimeout(()=>{this.remove(o,P)},x)),this.data[b].push(P),this.order.push(b),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const f=this.data[o].shift();return f.timeout&&clearTimeout(f.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),f.value}getByKey(o){const f=this.data[o];return f?f[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,f){if(!this.has(o))return this;const x=o.wrapped().key,b=f===void 0?0:this.data[x].indexOf(f),P=this.data[x][b];return this.data[x].splice(b,1),P.timeout&&clearTimeout(P.timeout),this.data[x].length===0&&delete this.data[x],this.onRemove(P.value),this.order.splice(this.order.indexOf(x),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this}filter(o){const f=[];for(const x in this.data)for(const b of this.data[x])o(b.value)||f.push(b);for(const x of f)this.remove(x.value.tileID,x)}}class nt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,f,x){const b=String(f);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][b]=this.stateChanges[o][b]||{},a.e(this.stateChanges[o][b],x),this.deletedStates[o]===null){this.deletedStates[o]={};for(const P in this.state[o])P!==b&&(this.deletedStates[o][P]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][b]===null){this.deletedStates[o][b]={};for(const P in this.state[o][b])x[P]||(this.deletedStates[o][b][P]=null)}else for(const P in x)this.deletedStates[o]&&this.deletedStates[o][b]&&this.deletedStates[o][b][P]===null&&delete this.deletedStates[o][b][P]}removeFeatureState(o,f,x){if(this.deletedStates[o]===null)return;const b=String(f);if(this.deletedStates[o]=this.deletedStates[o]||{},x&&f!==void 0)this.deletedStates[o][b]!==null&&(this.deletedStates[o][b]=this.deletedStates[o][b]||{},this.deletedStates[o][b][x]=null);else if(f!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][b])for(x in this.deletedStates[o][b]={},this.stateChanges[o][b])this.deletedStates[o][b][x]=null;else this.deletedStates[o][b]=null;else this.deletedStates[o]=null}getState(o,f){const x=String(f),b=a.e({},(this.state[o]||{})[x],(this.stateChanges[o]||{})[x]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const P=this.deletedStates[o][f];if(P===null)return{};for(const E in P)delete b[E]}return b}initializeTileState(o,f){o.setFeatureState(this.state,f)}coalesceChanges(o,f){const x={};for(const b in this.stateChanges){this.state[b]=this.state[b]||{};const P={};for(const E in this.stateChanges[b])this.state[b][E]||(this.state[b][E]={}),a.e(this.state[b][E],this.stateChanges[b][E]),P[E]=this.state[b][E];x[b]=P}for(const b in this.deletedStates){this.state[b]=this.state[b]||{};const P={};if(this.deletedStates[b]===null)for(const E in this.state[b])P[E]={},this.state[b][E]={};else for(const E in this.deletedStates[b]){if(this.deletedStates[b][E]===null)this.state[b][E]={};else for(const F of Object.keys(this.deletedStates[b][E]))delete this.state[b][E][F];P[E]=this.state[b][E]}x[b]=x[b]||{},a.e(x[b],P)}if(this.stateChanges={},this.deletedStates={},Object.keys(x).length!==0)for(const b in o)o[b].setFeatureState(x,f)}}const He=89.25;function ct(w,o){const f=a.ai(o.lat,-a.aj,a.aj);return new a.P(a.X(o.lng)*w,a.W(f)*w)}function Pt(w,o){return new a.a5(o.x/w,o.y/w).toLngLat()}function yt(w){return w.cameraToCenterDistance*Math.min(.85*Math.tan(a.ak(90-w.pitch)),Math.tan(a.ak(He-w.pitch)))}function or(w,o){const f=w.canonical,x=o/a.al(f.z),b=f.x+Math.pow(2,f.z)*w.wrap,P=a.am(new Float64Array(16));return a.N(P,P,[b*x,f.y*x,0]),a.O(P,P,[x/a.a3,x/a.a3,1]),P}function Je(w,o,f,x,b){const P=a.a5.fromLngLat(w,o),E=b*a.an(1,w.lat),F=E*Math.cos(a.ak(f)),B=Math.sqrt(E*E-F*F),W=B*Math.sin(a.ak(-x)),G=B*Math.cos(a.ak(-x));return new a.a5(P.x+W,P.y+G,P.z+F)}function Qr(w,o,f){const x=o.intersectsFrustum(w);if(!f||x===0)return x;const b=o.intersectsPlane(f);return b===0?0:x===2&&b===2?2:1}function hr(w,o,f){let x=0;const b=(f-o)/10;for(let P=0;P<10;P++)x+=b*Math.pow(Math.cos(o+(P+.5)/10*(f-o)),w);return x}function zt(w,o){return function(f,x,b,P,E){const F=2*((w-1)/a.ao(Math.cos(a.ak(He-E))/Math.cos(a.ak(He)))-1),B=Math.acos(b/P),W=2*hr(F-1,0,a.ak(E/2)),G=Math.min(a.ak(He),B+a.ak(E/2)),Y=hr(F-1,Math.min(G,B-a.ak(E/2)),G),Z=Math.atan(x/b),re=Math.hypot(x,b);let he=f;return he+=a.ao(P/re/Math.max(.5,Math.cos(a.ak(E/2)))),he+=F*a.ao(Math.cos(Z))/2,he-=a.ao(Math.max(1,Y/W/o))/2,he}}const pr=zt(9.314,3);function ln(w,o){const f=(o.roundZoom?Math.round:Math.floor)(w.zoom+a.ao(w.tileSize/o.tileSize));return Math.max(0,f)}function Nn(w,o){const f=w.getCameraFrustum(),x=w.getClippingPlane(),b=w.screenPointToMercatorCoordinate(w.getCameraPoint()),P=a.a5.fromLngLat(w.center,w.elevation);b.z=P.z+Math.cos(w.pitchInRadians)*w.cameraToCenterDistance/w.worldSize;const E=w.getCoveringTilesDetailsProvider(),F=E.allowVariableZoom(w,o),B=ln(w,o),W=o.minzoom||0,G=o.maxzoom!==void 0?o.maxzoom:w.maxZoom,Y=Math.min(Math.max(0,B),G),Z=Math.pow(2,Y),re=[Z*b.x,Z*b.y,0],he=[Z*P.x,Z*P.y,0],je=Math.hypot(P.x-b.x,P.y-b.y),we=Math.abs(P.z-b.z),Se=Math.hypot(je,we),Ee=Le=>({zoom:0,x:0,y:0,wrap:Le,fullyVisible:!1}),Re=[],Te=[];if(w.renderWorldCopies&&E.allowWorldCopies())for(let Le=1;Le<=3;Le++)Re.push(Ee(-Le)),Re.push(Ee(Le));for(Re.push(Ee(0));Re.length>0;){const Le=Re.pop(),$e=Le.x,Ie=Le.y;let Ke=Le.fullyVisible;const ut={x:$e,y:Ie,z:Le.zoom},st=E.getTileBoundingVolume(ut,Le.wrap,w.elevation,o);if(!Ke){const Et=Qr(f,st,x);if(Et===0)continue;Ke=Et===2}const ot=E.distanceToTile2d(b.x,b.y,ut,st);let dt=B;F&&(dt=(o.calculateTileZoom||pr)(w.zoom+a.ao(w.tileSize/o.tileSize),ot,we,Se,w.fov)),dt=(o.roundZoom?Math.round:Math.floor)(dt),dt=Math.max(0,dt);const kt=Math.min(dt,G);if(Le.wrap=E.getWrap(P,ut,Le.wrap),Le.zoom>=kt){if(Le.zoom<W)continue;const Et=Y-Le.zoom,bt=re[0]-.5-($e<<Et),rr=re[1]-.5-(Ie<<Et),Wr=o.reparseOverscaled?Math.max(Le.zoom,dt):Le.zoom;Te.push({tileID:new a.a0(Le.zoom===G?Wr:Le.zoom,Le.wrap,Le.zoom,$e,Ie),distanceSq:a.ap([he[0]-.5-$e,he[1]-.5-Ie]),tileDistanceToCamera:Math.sqrt(bt*bt+rr*rr)})}else for(let Et=0;Et<4;Et++)Re.push({zoom:Le.zoom+1,x:($e<<1)+Et%2,y:(Ie<<1)+(Et>>1),wrap:Le.wrap,fullyVisible:Ke})}return Te.sort((Le,$e)=>Le.distanceSq-$e.distanceSq).map(Le=>Le.tileID)}const Gn=a.a6.fromPoints([new a.P(0,0),new a.P(a.a3,a.a3)]);class kn extends a.E{constructor(o,f,x){super(),this.id=o,this.dispatcher=x,this.on("data",b=>this._dataHandler(b)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((b,P,E,F)=>{const B=new(Sn(P.type))(b,P,E,F);if(B.id!==b)throw new Error(`Expected Source id to be ${b} instead of ${B.id}`);return B})(o,f,x,this),this._tiles={},this._cache=new Ye(0,b=>this._unloadTile(b)),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new nt,this._didEmitContent=!1,this._updated=!1}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._maxTileCacheZoomLevels=o?o._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const o in this._tiles){const f=this._tiles[o];if(f.state!=="loaded"&&f.state!=="errored")return!1}return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(o,f,x){return a._(this,void 0,void 0,function*(){try{yield this._source.loadTile(o),this._tileLoaded(o,f,x)}catch(b){o.state="errored",b.status!==404?this._source.fire(new a.k(b,{tile:o})):this.update(this.transform,this.terrain)}})}_unloadTile(o){this._source.unloadTile&&this._source.unloadTile(o)}_abortTile(o){this._source.abortTile&&this._source.abortTile(o),this._source.fire(new a.l("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const f in this._tiles){const x=this._tiles[f];x.upload(o),x.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(Tn).map(o=>o.key)}getRenderableIds(o){const f=[];for(const x in this._tiles)this._isIdRenderable(x,o)&&f.push(this._tiles[x]);return o?f.sort((x,b)=>{const P=x.tileID,E=b.tileID,F=new a.P(P.canonical.x,P.canonical.y)._rotate(-this.transform.bearingInRadians),B=new a.P(E.canonical.x,E.canonical.y)._rotate(-this.transform.bearingInRadians);return P.overscaledZ-E.overscaledZ||B.y-F.y||B.x-F.x}).map(x=>x.tileID.key):f.map(x=>x.tileID).sort(Tn).map(x=>x.key)}hasRenderableParent(o){const f=o.overscaledZ-1;if(f>=this._source.minzoom){const x=this.getLoadedTile(o.scaledTo(f));if(x)return this._isIdRenderable(x.tileID.key)}return!1}_isIdRenderable(o,f=!1){var x;return(x=this._tiles[o])===null||x===void 0?void 0:x.isRenderable(f)}reload(o,f=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const x in this._tiles)f&&this._source.shouldReloadTile&&!this._source.shouldReloadTile(this._tiles[x],f)||(o?this._reloadTile(x,"expired"):this._tiles[x].state!=="errored"&&this._reloadTile(x,"reloading"))}}_reloadTile(o,f){return a._(this,void 0,void 0,function*(){const x=this._tiles[o];x&&(x.state!=="loading"&&(x.state=f),yield this._loadTile(x,o,f))})}_tileLoaded(o,f,x){o.timeAdded=k(),o.selfFading&&(o.fadeEndTime=o.timeAdded+this._rasterFadeDuration),x==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(f,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new a.l("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const f=this.getRenderableIds();for(let b=0;b<f.length;b++){const P=f[b];if(o.neighboringTiles&&o.neighboringTiles[P]){const E=this.getTileByID(P);x(o,E),x(E,o)}}function x(b,P){b.needsHillshadePrepare=!0,b.needsTerrainPrepare=!0;let E=P.tileID.canonical.x-b.tileID.canonical.x;const F=P.tileID.canonical.y-b.tileID.canonical.y,B=Math.pow(2,b.tileID.canonical.z),W=P.tileID.key;E===0&&F===0||Math.abs(F)>1||(Math.abs(E)>1&&(Math.abs(E+B)===1?E+=B:Math.abs(E-B)===1&&(E-=B)),P.dem&&b.dem&&(b.dem.backfillBorder(P.dem,E,F),b.neighboringTiles&&b.neighboringTiles[W]&&(b.neighboringTiles[W].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,f){const x=Object.values(o),b=this._getLoadedDescendents(x),P={};for(const E of x){const F=b[E.key];if(!(F!=null&&F.length)){P[E.key]=E;continue}const B=E.overscaledZ+kn.maxUnderzooming,W=F.filter(Z=>Z.tileID.overscaledZ<=B);if(!W.length){P[E.key]=E;continue}const G=Math.min(...W.map(Z=>Z.tileID.overscaledZ)),Y=W.filter(Z=>Z.tileID.overscaledZ===G).map(Z=>Z.tileID);for(const Z of Y)f[Z.key]=Z;this._areDescendentsComplete(Y,G,E.overscaledZ)||(P[E.key]=E)}return P}_getLoadedDescendents(o){var f;const x={};for(const b in this._tiles){const P=this._tiles[b];if(P.hasData())for(const E of o)P.tileID.isChildOf(E)&&(x[f=E.key]||(x[f]=[])).push(P)}return x}_areDescendentsComplete(o,f,x){return o.length===1&&o[0].isOverscaled()?o[0].overscaledZ===f:Math.pow(4,f-x)===o.length}getLoadedTile(o){const f=this._tiles[o.key];return f!=null&&f.hasData()?f:null}updateCacheSize(o){const f=Math.ceil(o.width/this._source.tileSize)+1,x=Math.ceil(o.height/this._source.tileSize)+1,b=Math.floor(f*x*(this._maxTileCacheZoomLevels===null?a.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),P=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,b):b;this._cache.setMaxSize(P)}handleWrapJump(o){const f=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,f){const x={};for(const b in this._tiles){const P=this._tiles[b];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+f),x[P.tileID.key]=P}this._tiles=x,this._resetTileReloadTimers()}}update(o,f){if(!this._sourceLoaded||this._paused)return;let x;this.transform=o,this.terrain=f,this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?x=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(B=>new a.a0(B.canonical.z,B.wrap,B.canonical.z,B.canonical.x,B.canonical.y)):(x=Nn(o,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:f,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(x=x.filter(B=>this._source.hasTile(B)))):x=[],this.usedForTerrain&&(x=this._addTerrainIdealTiles(x));const b=x.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,b&&this.fire(new a.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const P=ln(o,this._source),E=this._updateRetainedTiles(x,P),F=Pn(this._source.type);F&&this._rasterFadeDuration>0&&!f&&this._updateFadingTiles(x,E),F?this._cleanUpRasterTiles(E):this._cleanUpVectorTiles(E)}_cleanUpRasterTiles(o){for(const f in this._tiles)o[f]||this._removeTile(f)}_cleanUpVectorTiles(o){for(const f in this._tiles){const x=this._tiles[f];o[f]?x.clearSymbolFadeHold():x.hasSymbolBuckets?x.holdingForSymbolFade()?x.symbolFadeFinished()&&this._removeTile(f):x.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(f)}}_addTerrainIdealTiles(o){const f=[];for(const x of o)if(x.canonical.z>this._source.minzoom){const b=x.scaledTo(x.canonical.z-1);f.push(b);const P=x.scaledTo(Math.max(this._source.minzoom,Math.min(x.canonical.z,5)));f.push(P)}return o.concat(f)}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForSymbolFade()&&this._removeTile(o)}_updateRetainedTiles(o,f){var x;const b={},P={},E=Math.max(f-kn.maxOverzooming,this._source.minzoom);let F={};for(const B of o){const W=this._addTile(B);b[B.key]=B,W.hasData()||(F[B.key]=B)}F=this._retainLoadedChildren(F,b);for(const B in F){const W=F[B];let G=this._tiles[B],Y=G==null?void 0:G.wasRequested();for(let Z=W.overscaledZ-1;Z>=E;--Z){const re=W.scaledTo(Z);if(P[re.key])break;if(P[re.key]=!0,G=this.getTile(re),!G&&Y&&(G=this._addTile(re)),G){const he=G.hasData();if((he||!(!((x=this.map)===null||x===void 0)&&x.cancelPendingTileRequestsWhileZooming)||Y)&&(b[re.key]=re),Y=G.wasRequested(),he)break}}}return b}_updateFadingTiles(o,f){const x=k(),b=a.aq(o);for(const P of o){const E=this._tiles[P.key];E.fadingDirection!==Ae.Departing&&E.fadeOpacity!==0||E.resetFadeLogic(),this._updateFadingAncestor(E,f,x)||this._updateFadingDescendents(E,f,x)||this._updateFadingEdge(E,b,x)||E.resetFadeLogic()}}_updateFadingAncestor(o,f,x){if(!o.hasData())return!1;const{tileID:b,fadingRole:P,fadingDirection:E,fadingParentID:F}=o;if(P===ye.Base&&E===Ae.Incoming&&F)return f[F.key]=F,!0;const B=Math.max(b.overscaledZ-this._maxFadingAncestorLevels,this._source.minzoom);for(let W=b.overscaledZ-1;W>=B;W--){const G=b.scaledTo(W),Y=this.getLoadedTile(G);if(Y)return o.setCrossFadeLogic({fadingRole:ye.Base,fadingDirection:Ae.Incoming,fadingParentID:Y.tileID,fadeEndTime:x+this._rasterFadeDuration}),Y.setCrossFadeLogic({fadingRole:ye.Parent,fadingDirection:Ae.Departing,fadeEndTime:x+this._rasterFadeDuration}),f[G.key]=G,!0}return!1}_updateFadingDescendents(o,f,x){if(!o.hasData())return!1;const b=o.tileID.children(this._source.maxzoom);let P=this._updateFadingChildren(o,b,f,x);if(P)return!0;for(const E of b){const F=E.children(this._source.maxzoom);this._updateFadingChildren(o,F,f,x)&&(P=!0)}return P}_updateFadingChildren(o,f,x,b){if(f[0].overscaledZ>=this._source.maxzoom)return!1;let P=!1;for(const E of f){const F=this.getLoadedTile(E);if(!F)continue;const{fadingRole:B,fadingDirection:W,fadingParentID:G}=F;B===ye.Base&&W===Ae.Departing&&G||(F.setCrossFadeLogic({fadingRole:ye.Base,fadingDirection:Ae.Departing,fadingParentID:o.tileID,fadeEndTime:b+this._rasterFadeDuration}),o.setCrossFadeLogic({fadingRole:ye.Parent,fadingDirection:Ae.Incoming,fadeEndTime:b+this._rasterFadeDuration})),x[E.key]=E,P=!0}return P}_updateFadingEdge(o,f,x){const b=o.tileID;return!!o.selfFading||!o.hasData()&&!!f.has(b)&&(o.setSelfFadeLogic(x+this._rasterFadeDuration),!0)}_addTile(o){let f=this._tiles[o.key];if(f)return f;f=this._cache.getAndRemove(o),f&&(f.resetFadeLogic(),this._setTileReloadTimer(o.key,f),f.tileID=o,this._state.initializeTileState(f,this.map?this.map.painter:null));const x=f;return f||(f=new Fe(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(f,o.key,f.state)),f.uses++,this._tiles[o.key]=f,x||this._source.fire(new a.l("dataloading",{tile:f,coord:f.tileID,dataType:"source"})),f}_setTileReloadTimer(o,f){this._clearTileReloadTimer(o);const x=f.getExpiryTimeout();x&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},x))}_clearTileReloadTimer(o){const f=this._timers[o];f&&(clearTimeout(f),delete this._timers[o])}_resetTileReloadTimers(){for(const o in this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(const o in this._tiles)this._setTileReloadTimer(o,this._tiles[o])}refreshTiles(o){for(const f in this._tiles)(this._isIdRenderable(f)||this._tiles[f].state=="errored")&&o.some(x=>x.equals(this._tiles[f].tileID.canonical))&&this._reloadTile(f,"expired")}_removeTile(o){const f=this._tiles[o];f&&(f.uses--,delete this._tiles[o],this._clearTileReloadTimer(o),f.uses>0||(f.hasData()&&f.state!=="reloading"?this._cache.add(f.tileID,f,f.getExpiryTimeout()):(f.aborted=!0,this._abortTile(f),this._unloadTile(f))))}_dataHandler(o){o.dataType==="source"&&(o.sourceDataType!=="metadata"?o.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(o.sourceDataChanged,o.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,f,x){const b=[],P=this.transform;if(!P)return b;const E=P.getCoveringTilesDetailsProvider().allowWorldCopies(),F=x?P.getCameraQueryGeometry(o):o,B=re=>P.screenPointToMercatorCoordinate(re,this.terrain),W=this.transformBbox(o,B,!E),G=this.transformBbox(F,B,!E),Y=this.getIds(),Z=a.a6.fromPoints(G);for(let re=0;re<Y.length;re++){const he=this._tiles[Y[re]];if(he.holdingForSymbolFade())continue;const je=E?[he.tileID]:[he.tileID.unwrapTo(-1),he.tileID.unwrapTo(0)],we=Math.pow(2,P.zoom-he.tileID.overscaledZ),Se=f*he.queryPadding*a.a3/he.tileSize/we;for(const Ee of je){const Re=Z.map(Te=>Ee.getTilePoint(new a.a5(Te.x,Te.y)));if(Re.expandBy(Se),Re.intersects(Gn)){const Te=W.map($e=>Ee.getTilePoint($e)),Le=G.map($e=>Ee.getTilePoint($e));b.push({tile:he,tileID:E?Ee:Ee.unwrapTo(0),queryGeometry:Te,cameraQueryGeometry:Le,scale:we})}}}return b}transformBbox(o,f,x){let b=o.map(f);if(x){const P=a.a6.fromPoints(o);P.shrinkBy(.001*Math.min(P.width(),P.height()));const E=P.map(f);a.a6.fromPoints(b).covers(E)||(b=b.map(F=>F.x>.5?new a.a5(F.x-1,F.y,F.z):F))}return b}getVisibleCoordinates(o){const f=this.getRenderableIds(o).map(x=>this._tiles[x].tileID);return this.transform&&this.transform.populateCache(f),f}hasTransition(){if(this._source.hasTransition())return!0;if(Pn(this._source.type)&&this._rasterFadeDuration>0){const o=k();for(const f in this._tiles)if(this._tiles[f].fadeEndTime>=o)return!0}return!1}setRasterFadeDuration(o){this._rasterFadeDuration=o}setFeatureState(o,f,x){this._state.updateState(o=o||"_geojsonTileLayer",f,x)}removeFeatureState(o,f,x){this._state.removeFeatureState(o=o||"_geojsonTileLayer",f,x)}getFeatureState(o,f){return this._state.getState(o=o||"_geojsonTileLayer",f)}setDependencies(o,f,x){const b=this._tiles[o];b&&b.setDependencies(f,x)}reloadTilesForDependencies(o,f){for(const x in this._tiles)this._tiles[x].hasDependency(o,f)&&this._reloadTile(x,"reloading");this._cache.filter(x=>!x.hasDependency(o,f))}}function Tn(w,o){const f=Math.abs(2*w.wrap)-+(w.wrap<0),x=Math.abs(2*o.wrap)-+(o.wrap<0);return w.overscaledZ-o.overscaledZ||x-f||o.canonical.y-w.canonical.y||o.canonical.x-w.canonical.x}function Pn(w){return w==="raster"||w==="image"||w==="video"}kn.maxOverzooming=10,kn.maxUnderzooming=3;class ui{constructor(o,f){this.reset(o,f)}reset(o,f){this.points=o||[],this._distances=[0];for(let x=1;x<this.points.length;x++)this._distances[x]=this._distances[x-1]+this.points[x].dist(this.points[x-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=a.ai(o,0,1);let f=1,x=this._distances[f];const b=o*this.paddedLength+this.padding;for(;x<b&&f<this._distances.length;)x=this._distances[++f];const P=f-1,E=this._distances[P],F=x-E,B=F>0?(b-E)/F:0;return this.points[P].mult(1-B).add(this.points[f].mult(B))}}function wt(w,o){let f=!0;return w==="always"||w!=="never"&&o!=="never"||(f=!1),f}class Ts{constructor(o,f,x){const b=this.boxCells=[],P=this.circleCells=[];this.xCellCount=Math.ceil(o/x),this.yCellCount=Math.ceil(f/x);for(let E=0;E<this.xCellCount*this.yCellCount;E++)b.push([]),P.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=f,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,f,x,b,P){this._forEachCell(f,x,b,P,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(f),this.bboxes.push(x),this.bboxes.push(b),this.bboxes.push(P)}insertCircle(o,f,x,b){this._forEachCell(f-b,x-b,f+b,x+b,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(f),this.circles.push(x),this.circles.push(b)}_insertBoxCell(o,f,x,b,P,E){this.boxCells[P].push(E)}_insertCircleCell(o,f,x,b,P,E){this.circleCells[P].push(E)}_query(o,f,x,b,P,E,F){if(x<0||o>this.width||b<0||f>this.height)return[];const B=[];if(o<=0&&f<=0&&this.width<=x&&this.height<=b){if(P)return[{key:null,x1:o,y1:f,x2:x,y2:b}];for(let W=0;W<this.boxKeys.length;W++)B.push({key:this.boxKeys[W],x1:this.bboxes[4*W],y1:this.bboxes[4*W+1],x2:this.bboxes[4*W+2],y2:this.bboxes[4*W+3]});for(let W=0;W<this.circleKeys.length;W++){const G=this.circles[3*W],Y=this.circles[3*W+1],Z=this.circles[3*W+2];B.push({key:this.circleKeys[W],x1:G-Z,y1:Y-Z,x2:G+Z,y2:Y+Z})}}else this._forEachCell(o,f,x,b,this._queryCell,B,{hitTest:P,overlapMode:E,seenUids:{box:{},circle:{}}},F);return B}query(o,f,x,b){return this._query(o,f,x,b,!1,null)}hitTest(o,f,x,b,P,E){return this._query(o,f,x,b,!0,P,E).length>0}hitTestCircle(o,f,x,b,P){const E=o-x,F=o+x,B=f-x,W=f+x;if(F<0||E>this.width||W<0||B>this.height)return!1;const G=[];return this._forEachCell(E,B,F,W,this._queryCellCircle,G,{hitTest:!0,overlapMode:b,circle:{x:o,y:f,radius:x},seenUids:{box:{},circle:{}}},P),G.length>0}_queryCell(o,f,x,b,P,E,F,B){const{seenUids:W,hitTest:G,overlapMode:Y}=F,Z=this.boxCells[P];if(Z!==null){const he=this.bboxes;for(const je of Z)if(!W.box[je]){W.box[je]=!0;const we=4*je,Se=this.boxKeys[je];if(o<=he[we+2]&&f<=he[we+3]&&x>=he[we+0]&&b>=he[we+1]&&(!B||B(Se))&&(!G||!wt(Y,Se.overlapMode))&&(E.push({key:Se,x1:he[we],y1:he[we+1],x2:he[we+2],y2:he[we+3]}),G))return!0}}const re=this.circleCells[P];if(re!==null){const he=this.circles;for(const je of re)if(!W.circle[je]){W.circle[je]=!0;const we=3*je,Se=this.circleKeys[je];if(this._circleAndRectCollide(he[we],he[we+1],he[we+2],o,f,x,b)&&(!B||B(Se))&&(!G||!wt(Y,Se.overlapMode))){const Ee=he[we],Re=he[we+1],Te=he[we+2];if(E.push({key:Se,x1:Ee-Te,y1:Re-Te,x2:Ee+Te,y2:Re+Te}),G)return!0}}}return!1}_queryCellCircle(o,f,x,b,P,E,F,B){const{circle:W,seenUids:G,overlapMode:Y}=F,Z=this.boxCells[P];if(Z!==null){const he=this.bboxes;for(const je of Z)if(!G.box[je]){G.box[je]=!0;const we=4*je,Se=this.boxKeys[je];if(this._circleAndRectCollide(W.x,W.y,W.radius,he[we+0],he[we+1],he[we+2],he[we+3])&&(!B||B(Se))&&!wt(Y,Se.overlapMode))return E.push(!0),!0}}const re=this.circleCells[P];if(re!==null){const he=this.circles;for(const je of re)if(!G.circle[je]){G.circle[je]=!0;const we=3*je,Se=this.circleKeys[je];if(this._circlesCollide(he[we],he[we+1],he[we+2],W.x,W.y,W.radius)&&(!B||B(Se))&&!wt(Y,Se.overlapMode))return E.push(!0),!0}}}_forEachCell(o,f,x,b,P,E,F,B){const W=this._convertToXCellCoord(o),G=this._convertToYCellCoord(f),Y=this._convertToXCellCoord(x),Z=this._convertToYCellCoord(b);for(let re=W;re<=Y;re++)for(let he=G;he<=Z;he++)if(P.call(this,o,f,x,b,this.xCellCount*he+re,E,F,B))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,f,x,b,P,E){const F=b-o,B=P-f,W=x+E;return W*W>F*F+B*B}_circleAndRectCollide(o,f,x,b,P,E,F){const B=(E-b)/2,W=Math.abs(o-(b+B));if(W>B+x)return!1;const G=(F-P)/2,Y=Math.abs(f-(P+G));if(Y>G+x)return!1;if(W<=B||Y<=G)return!0;const Z=W-B,re=Y-G;return Z*Z+re*re<=x*x}}function la(w,o,f){const x=a.M();if(!w){const{vecSouth:Y,vecEast:Z}=Ii(o),re=p();re[0]=Z[0],re[1]=Z[1],re[2]=Y[0],re[3]=Y[1],b=re,(G=(E=(P=re)[0])*(W=P[3])-(B=P[2])*(F=P[1]))&&(b[0]=W*(G=1/G),b[1]=-F*G,b[2]=-B*G,b[3]=E*G),x[0]=re[0],x[1]=re[1],x[4]=re[2],x[5]=re[3]}var b,P,E,F,B,W,G;return a.O(x,x,[1/f,1/f,1]),x}function Pd(w,o,f,x){if(w){const b=a.M();if(!o){const{vecSouth:P,vecEast:E}=Ii(f);b[0]=E[0],b[1]=E[1],b[4]=P[0],b[5]=P[1]}return a.O(b,b,[x,x,1]),b}return f.pixelsToClipSpaceMatrix}function Ii(w){const o=Math.cos(w.rollInRadians),f=Math.sin(w.rollInRadians),x=Math.cos(w.pitchInRadians),b=Math.cos(w.bearingInRadians),P=Math.sin(w.bearingInRadians),E=a.av();E[0]=-b*x*f-P*o,E[1]=-P*x*f+b*o;const F=a.aw(E);F<1e-9?a.ax(E):a.ay(E,E,1/F);const B=a.av();B[0]=b*x*o-P*f,B[1]=P*x*o+b*f;const W=a.aw(B);return W<1e-9?a.ax(B):a.ay(B,B,1/W),{vecEast:B,vecSouth:E}}function Dt(w,o,f,x){let b;x?(b=[w,o,x(w,o),1],a.aA(b,b,f)):(b=[w,o,0,1],uu(b,b,f));const P=b[3];return{point:new a.P(b[0]/P,b[1]/P),signedDistanceFromCamera:P,isOccluded:!1}}function Kr(w,o){return .5+w/o*.5}function rn(w,o){return w.x>=-o[0]&&w.x<=o[0]&&w.y>=-o[1]&&w.y<=o[1]}function Po(w,o,f,x,b,P,E,F,B,W,G,Y,Z){const re=f?w.textSizeData:w.iconSizeData,he=a.ar(re,o.transform.zoom),je=[256/o.width*2+1,256/o.height*2+1],we=f?w.text.dynamicLayoutVertexArray:w.icon.dynamicLayoutVertexArray;we.clear();const Se=w.lineVertexArray,Ee=f?w.text.placedSymbolArray:w.icon.placedSymbolArray,Re=o.transform.width/o.transform.height;let Te=!1;for(let Le=0;Le<Ee.length;Le++){const $e=Ee.get(Le);if($e.hidden||$e.writingMode===a.as.vertical&&!Te){Cd($e.numGlyphs,we);continue}Te=!1;const Ie=new a.P($e.anchorX,$e.anchorY),Ke={getElevation:Z,pitchedLabelPlaneMatrix:x,lineVertexArray:Se,pitchWithMap:P,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:o.transform,tileAnchorPoint:Ie,unwrappedTileID:B,width:W,height:G,translation:Y},ut=xf($e.anchorX,$e.anchorY,Ke);if(!rn(ut.point,je)){Cd($e.numGlyphs,we);continue}const st=Kr(o.transform.cameraToCenterDistance,ut.signedDistanceFromCamera),ot=a.at(re,he,$e),dt=P?ot*o.transform.getPitchedTextCorrection($e.anchorX,$e.anchorY,B)/st:ot*st,kt=Xr({projectionContext:Ke,pitchedLabelPlaneMatrixInverse:b,symbol:$e,fontSize:dt,flip:!1,keepUpright:E,glyphOffsetArray:w.glyphOffsetArray,dynamicLayoutVertexArray:we,aspectRatio:Re,rotateToLine:F});Te=kt.useVertical,(kt.notEnoughRoom||Te||kt.needsFlipping&&Xr({projectionContext:Ke,pitchedLabelPlaneMatrixInverse:b,symbol:$e,fontSize:dt,flip:!0,keepUpright:E,glyphOffsetArray:w.glyphOffsetArray,dynamicLayoutVertexArray:we,aspectRatio:Re,rotateToLine:F}).notEnoughRoom)&&Cd($e.numGlyphs,we)}f?w.text.dynamicLayoutVertexBuffer.updateData(we):w.icon.dynamicLayoutVertexBuffer.updateData(we)}function pf(w,o,f,x,b,P,E,F){const B=P.glyphStartIndex+P.numGlyphs,W=P.lineStartIndex,G=P.lineStartIndex+P.lineLength,Y=o.getoffsetX(P.glyphStartIndex),Z=o.getoffsetX(B-1),re=Ki(w*Y,f,x,b,P.segment,W,G,F,E);if(!re)return null;const he=Ki(w*Z,f,x,b,P.segment,W,G,F,E);return he?F.projectionCache.anyProjectionOccluded?null:{first:re,last:he}:null}function jc(w,o,f,x){return w===a.as.horizontal&&Math.abs(f.y-o.y)>Math.abs(f.x-o.x)*x?{useVertical:!0}:(w===a.as.vertical?o.y<f.y:o.x>f.x)?{needsFlipping:!0}:null}function Xr(w){const{projectionContext:o,pitchedLabelPlaneMatrixInverse:f,symbol:x,fontSize:b,flip:P,keepUpright:E,glyphOffsetArray:F,dynamicLayoutVertexArray:B,aspectRatio:W,rotateToLine:G}=w,Y=b/24,Z=x.lineOffsetX*Y,re=x.lineOffsetY*Y;let he;if(x.numGlyphs>1){const je=x.glyphStartIndex+x.numGlyphs,we=x.lineStartIndex,Se=x.lineStartIndex+x.lineLength,Ee=pf(Y,F,Z,re,P,x,G,o);if(!Ee)return{notEnoughRoom:!0};const Re=wc(Ee.first.point.x,Ee.first.point.y,o,f),Te=wc(Ee.last.point.x,Ee.last.point.y,o,f);if(E&&!P){const Le=jc(x.writingMode,Re,Te,W);if(Le)return Le}he=[Ee.first];for(let Le=x.glyphStartIndex+1;Le<je-1;Le++){const $e=Ki(Y*F.getoffsetX(Le),Z,re,P,x.segment,we,Se,o,G);if(!$e)return{notEnoughRoom:!0};he.push($e)}he.push(Ee.last)}else{if(E&&!P){const we=sl(o.tileAnchorPoint.x,o.tileAnchorPoint.y,o).point,Se=x.lineStartIndex+x.segment+1,Ee=new a.P(o.lineVertexArray.getx(Se),o.lineVertexArray.gety(Se)),Re=sl(Ee.x,Ee.y,o),Te=Re.signedDistanceFromCamera>0?Re.point:gf(o.tileAnchorPoint,Ee,we,1,o),Le=wc(we.x,we.y,o,f),$e=wc(Te.x,Te.y,o,f),Ie=jc(x.writingMode,Le,$e,W);if(Ie)return Ie}const je=Ki(Y*F.getoffsetX(x.glyphStartIndex),Z,re,P,x.segment,x.lineStartIndex,x.lineStartIndex+x.lineLength,o,G);if(!je||o.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};he=[je]}for(const je of he)a.az(B,je.point,je.angle);return{}}function gf(w,o,f,x,b){const P=w.add(w.sub(o)._unit()),E=sl(P.x,P.y,b).point,F=f.sub(E);return f.add(F._mult(x/F.mag()))}function lu(w,o,f){const x=o.projectionCache;if(x.projections[w])return x.projections[w];const b=new a.P(o.lineVertexArray.getx(w),o.lineVertexArray.gety(w)),P=sl(b.x,b.y,o);if(P.signedDistanceFromCamera>0)return x.projections[w]=P.point,x.anyProjectionOccluded=x.anyProjectionOccluded||P.isOccluded,P.point;const E=w-f.direction;return gf(f.distanceFromAnchor===0?o.tileAnchorPoint:new a.P(o.lineVertexArray.getx(E),o.lineVertexArray.gety(E)),b,f.previousVertex,f.absOffsetX-f.distanceFromAnchor+1,o)}function sl(w,o,f){const x=w+f.translation[0],b=o+f.translation[1];let P;return f.pitchWithMap?(P=Dt(x,b,f.pitchedLabelPlaneMatrix,f.getElevation),P.isOccluded=!1):(P=f.transform.projectTileCoordinates(x,b,f.unwrappedTileID,f.getElevation),P.point.x=(.5*P.point.x+.5)*f.width,P.point.y=(.5*-P.point.y+.5)*f.height),P}function wc(w,o,f,x){if(f.pitchWithMap){const b=[w,o,0,1];return a.aA(b,b,x),f.transform.projectTileCoordinates(b[0]/b[3],b[1]/b[3],f.unwrappedTileID,f.getElevation).point}return{x:w/f.width*2-1,y:1-o/f.height*2}}function xf(w,o,f){return f.transform.projectTileCoordinates(w,o,f.unwrappedTileID,f.getElevation)}function cu(w,o,f){return w._unit()._perp()._mult(o*f)}function ap(w,o,f,x,b,P,E,F,B){if(F.projectionCache.offsets[w])return F.projectionCache.offsets[w];const W=f.add(o);if(w+B.direction<x||w+B.direction>=b)return F.projectionCache.offsets[w]=W,W;const G=lu(w+B.direction,F,B),Y=cu(G.sub(f),E,B.direction),Z=f.add(Y),re=G.add(Y);return F.projectionCache.offsets[w]=a.aB(P,W,Z,re)||W,F.projectionCache.offsets[w]}function Ki(w,o,f,x,b,P,E,F,B){const W=x?w-o:w+o;let G=W>0?1:-1,Y=0;x&&(G*=-1,Y=Math.PI),G<0&&(Y+=Math.PI);let Z,re=G>0?P+b:P+b+1;F.projectionCache.cachedAnchorPoint?Z=F.projectionCache.cachedAnchorPoint:(Z=sl(F.tileAnchorPoint.x,F.tileAnchorPoint.y,F).point,F.projectionCache.cachedAnchorPoint=Z);let he,je,we=Z,Se=Z,Ee=0,Re=0;const Te=Math.abs(W),Le=[];let $e;for(;Ee+Re<=Te;){if(re+=G,re<P||re>=E)return null;Ee+=Re,Se=we,je=he;const ut={absOffsetX:Te,direction:G,distanceFromAnchor:Ee,previousVertex:Se};if(we=lu(re,F,ut),f===0)Le.push(Se),$e=we.sub(Se);else{let st;const ot=we.sub(Se);st=ot.mag()===0?cu(lu(re+G,F,ut).sub(we),f,G):cu(ot,f,G),je||(je=Se.add(st)),he=ap(re,st,we,P,E,je,f,F,ut),Le.push(je),$e=he.sub(je)}Re=$e.mag()}const Ie=$e._mult((Te-Ee)/Re)._add(je||Se),Ke=Y+Math.atan2(we.y-Se.y,we.x-Se.x);return Le.push(Ie),{point:Ie,angle:B?Ke:0,path:Le}}const ls=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Cd(w,o){for(let f=0;f<w;f++){const x=o.length;o.resize(x+4),o.float32.set(ls,3*x)}}function uu(w,o,f){const x=o[0],b=o[1];return w[0]=f[0]*x+f[4]*b+f[12],w[1]=f[1]*x+f[5]*b+f[13],w[3]=f[3]*x+f[7]*b+f[15],w}const ti=100;class du{constructor(o,f=new Ts(o.width+200,o.height+200,25),x=new Ts(o.width+200,o.height+200,25)){this.transform=o,this.grid=f,this.ignoredGrid=x,this.pitchFactor=Math.cos(o.pitch*Math.PI/180)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+ti,this.screenBottomBoundary=o.height+ti,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(o,f,x,b,P,E,F,B,W,G,Y,Z){const re=this.projectAndGetPerspectiveRatio(o.anchorPointX+B[0],o.anchorPointY+B[1],P,G,Z),he=x*re.perspectiveRatio;let je;if(E||F)je=this._projectCollisionBox(o,he,b,P,E,F,B,re,G,Y,Z);else{const $e=re.x+(Y?Y.x*he:0),Ie=re.y+(Y?Y.y*he:0);je={allPointsOccluded:!1,box:[$e+o.x1*he,Ie+o.y1*he,$e+o.x2*he,Ie+o.y2*he]}}const[we,Se,Ee,Re]=je.box,Te=E?je.allPointsOccluded:re.isOccluded;let Le=Te;return Le||(Le=re.perspectiveRatio<this.perspectiveRatioCutoff),Le||(Le=!this.isInsideGrid(we,Se,Ee,Re)),Le||f!=="always"&&this.grid.hitTest(we,Se,Ee,Re,f,W)?{box:[we,Se,Ee,Re],placeable:!1,offscreen:!1,occluded:Te}:{box:[we,Se,Ee,Re],placeable:!0,offscreen:this.isOffscreen(we,Se,Ee,Re),occluded:Te}}placeCollisionCircles(o,f,x,b,P,E,F,B,W,G,Y,Z,re,he){const je=[],we=new a.P(f.anchorX,f.anchorY),Se=this.getPerspectiveRatio(we.x,we.y,E,he),Ee=(W?P*this.transform.getPitchedTextCorrection(f.anchorX,f.anchorY,E)/Se:P*Se)/a.aF,Re={getElevation:he,pitchedLabelPlaneMatrix:F,lineVertexArray:x,pitchWithMap:W,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:we,unwrappedTileID:E,width:this.transform.width,height:this.transform.height,translation:re},Te=pf(Ee,b,f.lineOffsetX*Ee,f.lineOffsetY*Ee,!1,f,!1,Re);let Le=!1,$e=!1,Ie=!0;if(Te){const Ke=.5*Y*Se+Z,ut=new a.P(-100,-100),st=new a.P(this.screenRightBoundary,this.screenBottomBoundary),ot=new ui,dt=Te.first,kt=Te.last;let Et=[];for(let Wr=dt.path.length-1;Wr>=1;Wr--)Et.push(dt.path[Wr]);for(let Wr=1;Wr<kt.path.length;Wr++)Et.push(kt.path[Wr]);const bt=2.5*Ke;if(W){const Wr=this.projectPathToScreenSpace(Et,Re);Et=Wr.some(On=>On.signedDistanceFromCamera<=0)?[]:Wr.map(On=>On.point)}let rr=[];if(Et.length>0){const Wr=Et[0].clone(),On=Et[0].clone();for(let Hr=1;Hr<Et.length;Hr++)Wr.x=Math.min(Wr.x,Et[Hr].x),Wr.y=Math.min(Wr.y,Et[Hr].y),On.x=Math.max(On.x,Et[Hr].x),On.y=Math.max(On.y,Et[Hr].y);rr=Wr.x>=ut.x&&On.x<=st.x&&Wr.y>=ut.y&&On.y<=st.y?[Et]:On.x<ut.x||Wr.x>st.x||On.y<ut.y||Wr.y>st.y?[]:a.aC([Et],ut.x,ut.y,st.x,st.y)}for(const Wr of rr){ot.reset(Wr,.25*Ke);let On=0;On=ot.length<=.5*Ke?1:Math.ceil(ot.paddedLength/bt)+1;for(let Hr=0;Hr<On;Hr++){const qn=Hr/Math.max(On-1,1),ds=ot.lerp(qn),Kn=ds.x+ti,ri=ds.y+ti;je.push(Kn,ri,Ke,0);const ns=Kn-Ke,gi=ri-Ke,ss=Kn+Ke,Us=ri+Ke;if(Ie=Ie&&this.isOffscreen(ns,gi,ss,Us),$e=$e||this.isInsideGrid(ns,gi,ss,Us),o!=="always"&&this.grid.hitTestCircle(Kn,ri,Ke,o,G)&&(Le=!0,!B))return{circles:[],offscreen:!1,collisionDetected:Le}}}}return{circles:!B&&Le||!$e||Se<this.perspectiveRatioCutoff?[]:je,offscreen:Ie,collisionDetected:Le}}projectPathToScreenSpace(o,f){const x=function(b,P){const E=a.M();return a.au(E,P.pitchedLabelPlaneMatrix),b.map(F=>{const B=Dt(F.x,F.y,E,P.getElevation),W=P.transform.projectTileCoordinates(B.point.x,B.point.y,P.unwrappedTileID,P.getElevation);return W.point.x=(.5*W.point.x+.5)*P.width,W.point.y=(.5*-W.point.y+.5)*P.height,W})}(o,f);return function(b){let P=0,E=0,F=0,B=0;for(let W=0;W<b.length;W++)b[W].isOccluded?(F=W+1,B=0):(B++,B>E&&(E=B,P=F));return b.slice(P,P+E)}(x)}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const f=[],x=new a.a6;for(const Y of o){const Z=new a.P(Y.x+ti,Y.y+ti);x.extend(Z),f.push(Z)}const{minX:b,minY:P,maxX:E,maxY:F}=x,B=this.grid.query(b,P,E,F).concat(this.ignoredGrid.query(b,P,E,F)),W={},G={};for(const Y of B){const Z=Y.key;if(W[Z.bucketInstanceId]===void 0&&(W[Z.bucketInstanceId]={}),W[Z.bucketInstanceId][Z.featureIndex])continue;const re=[new a.P(Y.x1,Y.y1),new a.P(Y.x2,Y.y1),new a.P(Y.x2,Y.y2),new a.P(Y.x1,Y.y2)];a.aD(f,re)&&(W[Z.bucketInstanceId][Z.featureIndex]=!0,G[Z.bucketInstanceId]===void 0&&(G[Z.bucketInstanceId]=[]),G[Z.bucketInstanceId].push(Z.featureIndex))}return G}insertCollisionBox(o,f,x,b,P,E){(x?this.ignoredGrid:this.grid).insert({bucketInstanceId:b,featureIndex:P,collisionGroupID:E,overlapMode:f},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,f,x,b,P,E){const F=x?this.ignoredGrid:this.grid,B={bucketInstanceId:b,featureIndex:P,collisionGroupID:E,overlapMode:f};for(let W=0;W<o.length;W+=4)F.insertCircle(B,o[W],o[W+1],o[W+2])}projectAndGetPerspectiveRatio(o,f,x,b,P){if(P){let E;b?(E=[o,f,b(o,f),1],a.aA(E,E,P)):(E=[o,f,0,1],uu(E,E,P));const F=E[3];return{x:(E[0]/F+1)/2*this.transform.width+ti,y:(-E[1]/F+1)/2*this.transform.height+ti,perspectiveRatio:.5+this.transform.cameraToCenterDistance/F*.5,isOccluded:!1,signedDistanceFromCamera:F}}{const E=this.transform.projectTileCoordinates(o,f,x,b);return{x:(E.point.x+1)/2*this.transform.width+ti,y:(1-E.point.y)/2*this.transform.height+ti,perspectiveRatio:.5+this.transform.cameraToCenterDistance/E.signedDistanceFromCamera*.5,isOccluded:E.isOccluded,signedDistanceFromCamera:E.signedDistanceFromCamera}}}getPerspectiveRatio(o,f,x,b){const P=this.transform.projectTileCoordinates(o,f,x,b);return .5+this.transform.cameraToCenterDistance/P.signedDistanceFromCamera*.5}isOffscreen(o,f,x,b){return x<ti||o>=this.screenRightBoundary||b<ti||f>this.screenBottomBoundary}isInsideGrid(o,f,x,b){return x>=0&&o<this.gridRightBoundary&&b>=0&&f<this.gridBottomBoundary}getViewportMatrix(){const o=a.am([]);return a.N(o,o,[-100,-100,0]),o}_projectCollisionBox(o,f,x,b,P,E,F,B,W,G,Y){let Z=1,re=0,he=0,je=1;const we=o.anchorPointX+F[0],Se=o.anchorPointY+F[1];if(E&&!P){const Et=this.projectAndGetPerspectiveRatio(we+1,Se,b,W,Y),bt=Et.x-B.x,rr=Math.atan((Et.y-B.y)/bt)+(bt<0?Math.PI:0),Wr=Math.sin(rr),On=Math.cos(rr);Z=On,re=Wr,he=-Wr,je=On}else if(!E&&P){const Et=Ii(this.transform);Z=Et.vecEast[0],re=Et.vecEast[1],he=Et.vecSouth[0],je=Et.vecSouth[1]}let Ee=B.x,Re=B.y,Te=f;P&&(Ee=we,Re=Se,Te=Math.pow(2,-(this.transform.zoom-x.overscaledZ)),Te*=this.transform.getPitchedTextCorrection(we,Se,b),G||(Te*=a.ai(.5+B.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),G&&(Ee+=Z*G.x*Te+he*G.y*Te,Re+=re*G.x*Te+je*G.y*Te);const Le=o.x1*Te,$e=o.x2*Te,Ie=(Le+$e)/2,Ke=o.y1*Te,ut=o.y2*Te,st=(Ke+ut)/2,ot=[{offsetX:Le,offsetY:Ke},{offsetX:Ie,offsetY:Ke},{offsetX:$e,offsetY:Ke},{offsetX:$e,offsetY:st},{offsetX:$e,offsetY:ut},{offsetX:Ie,offsetY:ut},{offsetX:Le,offsetY:ut},{offsetX:Le,offsetY:st}];let dt=[];for(const{offsetX:Et,offsetY:bt}of ot)dt.push(new a.P(Ee+Z*Et+he*bt,Re+re*Et+je*bt));let kt=!1;if(P){const Et=dt.map(bt=>this.projectAndGetPerspectiveRatio(bt.x,bt.y,b,W,Y));kt=Et.some(bt=>!bt.isOccluded),dt=Et.map(bt=>new a.P(bt.x,bt.y))}else kt=!0;return{box:a.aE(dt),allPointsOccluded:!kt}}}class Ol{constructor(o,f,x,b){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?f:-f))):b&&x?1:0,this.placed=x}isHidden(){return this.opacity===0&&!this.placed}}class Ad{constructor(o,f,x,b,P){this.text=new Ol(o?o.text:null,f,x,P),this.icon=new Ol(o?o.icon:null,f,b,P)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Yy{constructor(o,f,x){this.text=o,this.icon=f,this.skipFade=x}}class Jb{constructor(o,f,x,b,P){this.bucketInstanceId=o,this.featureIndex=f,this.sourceLayerIndex=x,this.bucketIndex=b,this.tileID=P}}class kd{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const f=++this.maxGroupID;this.collisionGroups[o]={ID:f,predicate:x=>x.collisionGroupID===f}}return this.collisionGroups[o]}}function Xy(w,o,f,x,b){const{horizontalAlign:P,verticalAlign:E}=a.aL(w);return new a.P(-(P-.5)*o+x[0]*b,-(E-.5)*f+x[1]*b)}class jP{constructor(o,f,x,b,P){this.transform=o.clone(),this.terrain=f,this.collisionIndex=new du(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=x,this.retainedQueryData={},this.collisionGroups=new kd(b),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=P,P&&(P.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(o){const f=this.terrain;return f?(x,b)=>f.getElevation(o,x,b):null}getBucketParts(o,f,x,b){const P=x.getBucket(f),E=x.latestFeatureIndex;if(!P||!E||f.id!==P.layerIds[0])return;const F=x.collisionBoxArray,B=P.layers[0].layout,W=P.layers[0].paint,G=Math.pow(2,this.transform.zoom-x.tileID.overscaledZ),Y=x.tileSize/a.a3,Z=x.tileID.toUnwrapped(),re=B.get("text-rotation-alignment")==="map",he=a.aG(x,1,this.transform.zoom),je=a.aH(this.collisionIndex.transform,x,W.get("text-translate"),W.get("text-translate-anchor")),we=a.aH(this.collisionIndex.transform,x,W.get("icon-translate"),W.get("icon-translate-anchor")),Se=la(re,this.transform,he);this.retainedQueryData[P.bucketInstanceId]=new Jb(P.bucketInstanceId,E,P.sourceLayerIndex,P.index,x.tileID);const Ee={bucket:P,layout:B,translationText:je,translationIcon:we,unwrappedTileID:Z,pitchedLabelPlaneMatrix:Se,scale:G,textPixelRatio:Y,holdingForFade:x.holdingForSymbolFade(),collisionBoxArray:F,partiallyEvaluatedTextSize:a.ar(P.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(P.sourceID)};if(b)for(const Re of P.sortKeyRanges){const{sortKey:Te,symbolInstanceStart:Le,symbolInstanceEnd:$e}=Re;o.push({sortKey:Te,symbolInstanceStart:Le,symbolInstanceEnd:$e,parameters:Ee})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:P.symbolInstances.length,parameters:Ee})}attemptAnchorPlacement(o,f,x,b,P,E,F,B,W,G,Y,Z,re,he,je,we,Se,Ee,Re,Te){const Le=a.aI[o.textAnchor],$e=[o.textOffset0,o.textOffset1],Ie=Xy(Le,x,b,$e,P),Ke=this.collisionIndex.placeCollisionBox(f,Z,B,W,G,F,E,we,Y.predicate,Re,Ie,Te);if((!Ee||this.collisionIndex.placeCollisionBox(Ee,Z,B,W,G,F,E,Se,Y.predicate,Re,Ie,Te).placeable)&&Ke.placeable){let ut;if(this.prevPlacement&&this.prevPlacement.variableOffsets[re.crossTileID]&&this.prevPlacement.placements[re.crossTileID]&&this.prevPlacement.placements[re.crossTileID].text&&(ut=this.prevPlacement.variableOffsets[re.crossTileID].anchor),re.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[re.crossTileID]={textOffset:$e,width:x,height:b,anchor:Le,textBoxScale:P,prevAnchor:ut},this.markUsedJustification(he,Le,re,je),he.allowVerticalPlacement&&(this.markUsedOrientation(he,je,re),this.placedOrientations[re.crossTileID]=je),{shift:Ie,placedGlyphBoxes:Ke}}}placeLayerBucketPart(o,f,x){const{bucket:b,layout:P,translationText:E,translationIcon:F,unwrappedTileID:B,pitchedLabelPlaneMatrix:W,textPixelRatio:G,holdingForFade:Y,collisionBoxArray:Z,partiallyEvaluatedTextSize:re,collisionGroup:he}=o.parameters,je=P.get("text-optional"),we=P.get("icon-optional"),Se=a.aJ(P,"text-overlap","text-allow-overlap"),Ee=Se==="always",Re=a.aJ(P,"icon-overlap","icon-allow-overlap"),Te=Re==="always",Le=P.get("text-rotation-alignment")==="map",$e=P.get("text-pitch-alignment")==="map",Ie=P.get("icon-text-fit")!=="none",Ke=P.get("symbol-z-order")==="viewport-y",ut=Ee&&(Te||!b.hasIconData()||we),st=Te&&(Ee||!b.hasTextData()||je);!b.collisionArrays&&Z&&b.deserializeCollisionBoxes(Z);const ot=this.retainedQueryData[b.bucketInstanceId].tileID,dt=this._getTerrainElevationFunc(ot),kt=this.transform.getFastPathSimpleProjectionMatrix(ot),Et=(bt,rr,Wr)=>{var On,Hr;if(f[bt.crossTileID])return;if(Y)return void(this.placements[bt.crossTileID]=new Yy(!1,!1,!1));let qn=!1,ds=!1,Kn=!0,ri=null,ns={box:null,placeable:!1,offscreen:null,occluded:!1},gi={placeable:!1},ss=null,Us=null,ha=null,Au=0,ql=0,cl=0;rr.textFeatureIndex?Au=rr.textFeatureIndex:bt.useRuntimeCollisionCircles&&(Au=bt.featureIndex),rr.verticalTextFeatureIndex&&(ql=rr.verticalTextFeatureIndex);const ku=rr.textBox;if(ku){const fa=Ws=>{let Os=a.as.horizontal;if(b.allowVerticalPlacement&&!Ws&&this.prevPlacement){const xi=this.prevPlacement.placedOrientations[bt.crossTileID];xi&&(this.placedOrientations[bt.crossTileID]=xi,Os=xi,this.markUsedOrientation(b,Os,bt))}return Os},Vl=(Ws,Os)=>{if(b.allowVerticalPlacement&&bt.numVerticalGlyphVertices>0&&rr.verticalTextBox){for(const xi of b.writingModes)if(xi===a.as.vertical?(ns=Os(),gi=ns):ns=Ws(),ns&&ns.placeable)break}else ns=Ws()},kc=bt.textAnchorOffsetStartIndex,Wf=bt.textAnchorOffsetEndIndex;if(Wf===kc){const Ws=(Os,xi)=>{const Jn=this.collisionIndex.placeCollisionBox(Os,Se,G,ot,B,$e,Le,E,he.predicate,dt,void 0,kt);return Jn&&Jn.placeable&&(this.markUsedOrientation(b,xi,bt),this.placedOrientations[bt.crossTileID]=xi),Jn};Vl(()=>Ws(ku,a.as.horizontal),()=>{const Os=rr.verticalTextBox;return b.allowVerticalPlacement&&bt.numVerticalGlyphVertices>0&&Os?Ws(Os,a.as.vertical):{box:null,offscreen:null}}),fa(ns&&ns.placeable)}else{let Ws=a.aI[(Hr=(On=this.prevPlacement)===null||On===void 0?void 0:On.variableOffsets[bt.crossTileID])===null||Hr===void 0?void 0:Hr.anchor];const Os=(Jn,To,Tc)=>{const tw=Jn.x2-Jn.x1,rw=Jn.y2-Jn.y1,nw=bt.textBoxScale,Eu=Ie&&Re==="never"?To:null;let Mu=null,Uv=Se==="never"?1:2,Gp="never";Ws&&Uv++;for(let Wv=0;Wv<Uv;Wv++){for(let Ul=kc;Ul<Wf;Ul++){const Ec=b.textAnchorOffsets.get(Ul);if(Ws&&Ec.textAnchor!==Ws)continue;const Kp=this.attemptAnchorPlacement(Ec,Jn,tw,rw,nw,Le,$e,G,ot,B,he,Gp,bt,b,Tc,E,F,Eu,dt);if(Kp&&(Mu=Kp.placedGlyphBoxes,Mu&&Mu.placeable))return qn=!0,ri=Kp.shift,Mu}Ws?Ws=null:Gp=Se}return x&&!Mu&&(Mu={box:this.collisionIndex.placeCollisionBox(ku,"always",G,ot,B,$e,Le,E,he.predicate,dt,void 0,kt).box,offscreen:!1,placeable:!1,occluded:!1}),Mu};Vl(()=>Os(ku,rr.iconBox,a.as.horizontal),()=>{const Jn=rr.verticalTextBox;return b.allowVerticalPlacement&&(!ns||!ns.placeable)&&bt.numVerticalGlyphVertices>0&&Jn?Os(Jn,rr.verticalIconBox,a.as.vertical):{box:null,occluded:!0,offscreen:null}}),ns&&(qn=ns.placeable,Kn=ns.offscreen);const xi=fa(ns&&ns.placeable);if(!qn&&this.prevPlacement){const Jn=this.prevPlacement.variableOffsets[bt.crossTileID];Jn&&(this.variableOffsets[bt.crossTileID]=Jn,this.markUsedJustification(b,Jn.anchor,bt,xi))}}}if(ss=ns,qn=ss&&ss.placeable,Kn=ss&&ss.offscreen,bt.useRuntimeCollisionCircles&&bt.centerJustifiedTextSymbolIndex>=0){const fa=b.text.placedSymbolArray.get(bt.centerJustifiedTextSymbolIndex),Vl=a.at(b.textSizeData,re,fa),kc=P.get("text-padding");Us=this.collisionIndex.placeCollisionCircles(Se,fa,b.lineVertexArray,b.glyphOffsetArray,Vl,B,W,x,$e,he.predicate,bt.collisionCircleDiameter,kc,E,dt),Us.circles.length&&Us.collisionDetected&&!x&&a.w("Collisions detected, but collision boxes are not shown"),qn=Ee||Us.circles.length>0&&!Us.collisionDetected,Kn=Kn&&Us.offscreen}if(rr.iconFeatureIndex&&(cl=rr.iconFeatureIndex),rr.iconBox){const fa=Vl=>this.collisionIndex.placeCollisionBox(Vl,Re,G,ot,B,$e,Le,F,he.predicate,dt,Ie&&ri?ri:void 0,kt);gi&&gi.placeable&&rr.verticalIconBox?(ha=fa(rr.verticalIconBox),ds=ha.placeable):(ha=fa(rr.iconBox),ds=ha.placeable),Kn=Kn&&ha.offscreen}const Hd=je||bt.numHorizontalGlyphVertices===0&&bt.numVerticalGlyphVertices===0,Tu=we||bt.numIconVertices===0;Hd||Tu?Tu?Hd||(ds=ds&&qn):qn=ds&&qn:ds=qn=ds&&qn;const Sa=ds&&ha.placeable;if(qn&&ss.placeable&&this.collisionIndex.insertCollisionBox(ss.box,Se,P.get("text-ignore-placement"),b.bucketInstanceId,gi&&gi.placeable&&ql?ql:Au,he.ID),Sa&&this.collisionIndex.insertCollisionBox(ha.box,Re,P.get("icon-ignore-placement"),b.bucketInstanceId,cl,he.ID),Us&&qn&&this.collisionIndex.insertCollisionCircles(Us.circles,Se,P.get("text-ignore-placement"),b.bucketInstanceId,Au,he.ID),x&&this.storeCollisionData(b.bucketInstanceId,Wr,rr,ss,ha,Us),bt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(b.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[bt.crossTileID]=new Yy((qn||ut)&&!(ss!=null&&ss.occluded),(ds||st)&&!(ha!=null&&ha.occluded),Kn||b.justReloaded),f[bt.crossTileID]=!0};if(Ke){if(o.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const bt=b.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let rr=bt.length-1;rr>=0;--rr){const Wr=bt[rr];Et(b.symbolInstances.get(Wr),b.collisionArrays[Wr],Wr)}}else for(let bt=o.symbolInstanceStart;bt<o.symbolInstanceEnd;bt++)Et(b.symbolInstances.get(bt),b.collisionArrays[bt],bt);b.justReloaded=!1}storeCollisionData(o,f,x,b,P,E){if(x.textBox||x.iconBox){let F,B;this.collisionBoxArrays.has(o)?F=this.collisionBoxArrays.get(o):(F=new Map,this.collisionBoxArrays.set(o,F)),F.has(f)?B=F.get(f):(B={text:null,icon:null},F.set(f,B)),x.textBox&&(B.text=b.box),x.iconBox&&(B.icon=P.box)}if(E){let F=this.collisionCircleArrays[o];F===void 0&&(F=this.collisionCircleArrays[o]=[]);for(let B=0;B<E.circles.length;B+=4)F.push(E.circles[B+0]-ti),F.push(E.circles[B+1]-ti),F.push(E.circles[B+2]),F.push(E.collisionDetected?1:0)}}markUsedJustification(o,f,x,b){let P;P=b===a.as.vertical?x.verticalPlacedTextSymbolIndex:{left:x.leftJustifiedTextSymbolIndex,center:x.centerJustifiedTextSymbolIndex,right:x.rightJustifiedTextSymbolIndex}[a.aK(f)];const E=[x.leftJustifiedTextSymbolIndex,x.centerJustifiedTextSymbolIndex,x.rightJustifiedTextSymbolIndex,x.verticalPlacedTextSymbolIndex];for(const F of E)F>=0&&(o.text.placedSymbolArray.get(F).crossTileID=P>=0&&F!==P?0:x.crossTileID)}markUsedOrientation(o,f,x){const b=f===a.as.horizontal||f===a.as.horizontalOnly?f:0,P=f===a.as.vertical?f:0,E=[x.leftJustifiedTextSymbolIndex,x.centerJustifiedTextSymbolIndex,x.rightJustifiedTextSymbolIndex];for(const F of E)o.text.placedSymbolArray.get(F).placedOrientation=b;x.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(x.verticalPlacedTextSymbolIndex).placedOrientation=P)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const f=this.prevPlacement;let x=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;const b=f?f.symbolFadeChange(o):1,P=f?f.opacities:{},E=f?f.variableOffsets:{},F=f?f.placedOrientations:{};for(const B in this.placements){const W=this.placements[B],G=P[B];G?(this.opacities[B]=new Ad(G,b,W.text,W.icon),x=x||W.text!==G.text.placed||W.icon!==G.icon.placed):(this.opacities[B]=new Ad(null,b,W.text,W.icon,W.skipFade),x=x||W.text||W.icon)}for(const B in P){const W=P[B];if(!this.opacities[B]){const G=new Ad(W,b,!1,!1);G.isHidden()||(this.opacities[B]=G,x=x||W.text.placed||W.icon.placed)}}for(const B in E)this.variableOffsets[B]||!this.opacities[B]||this.opacities[B].isHidden()||(this.variableOffsets[B]=E[B]);for(const B in F)this.placedOrientations[B]||!this.opacities[B]||this.opacities[B].isHidden()||(this.placedOrientations[B]=F[B]);if(f&&f.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");x?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:o)}updateLayerOpacities(o,f){const x={};for(const b of f){const P=b.getBucket(o);P&&b.latestFeatureIndex&&o.id===P.layerIds[0]&&this.updateBucketOpacities(P,b.tileID,x,b.collisionBoxArray)}}updateBucketOpacities(o,f,x,b){o.hasTextData()&&(o.text.opacityVertexArray.clear(),o.text.hasVisibleVertices=!1),o.hasIconData()&&(o.icon.opacityVertexArray.clear(),o.icon.hasVisibleVertices=!1),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const P=o.layers[0],E=P.layout,F=new Ad(null,0,!1,!1,!0),B=E.get("text-allow-overlap"),W=E.get("icon-allow-overlap"),G=P._unevaluatedLayout.hasValue("text-variable-anchor")||P._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Y=E.get("text-rotation-alignment")==="map",Z=E.get("text-pitch-alignment")==="map",re=E.get("icon-text-fit")!=="none",he=new Ad(null,0,B&&(W||!o.hasIconData()||E.get("icon-optional")),W&&(B||!o.hasTextData()||E.get("text-optional")),!0);!o.collisionArrays&&b&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(b);const je=(Se,Ee,Re)=>{for(let Te=0;Te<Ee/4;Te++)Se.opacityVertexArray.emplaceBack(Re);Se.hasVisibleVertices=Se.hasVisibleVertices||Re!==yf},we=this.collisionBoxArrays.get(o.bucketInstanceId);for(let Se=0;Se<o.symbolInstances.length;Se++){const Ee=o.symbolInstances.get(Se),{numHorizontalGlyphVertices:Re,numVerticalGlyphVertices:Te,crossTileID:Le}=Ee;let $e=this.opacities[Le];x[Le]?$e=F:$e||($e=he,this.opacities[Le]=$e),x[Le]=!0;const Ie=Ee.numIconVertices>0,Ke=this.placedOrientations[Ee.crossTileID],ut=Ke===a.as.vertical,st=Ke===a.as.horizontal||Ke===a.as.horizontalOnly;if(Re>0||Te>0){const dt=op($e.text);je(o.text,Re,ut?yf:dt),je(o.text,Te,st?yf:dt);const kt=$e.text.isHidden();[Ee.rightJustifiedTextSymbolIndex,Ee.centerJustifiedTextSymbolIndex,Ee.leftJustifiedTextSymbolIndex].forEach(rr=>{rr>=0&&(o.text.placedSymbolArray.get(rr).hidden=kt||ut?1:0)}),Ee.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(Ee.verticalPlacedTextSymbolIndex).hidden=kt||st?1:0);const Et=this.variableOffsets[Ee.crossTileID];Et&&this.markUsedJustification(o,Et.anchor,Ee,Ke);const bt=this.placedOrientations[Ee.crossTileID];bt&&(this.markUsedJustification(o,"left",Ee,bt),this.markUsedOrientation(o,bt,Ee))}if(Ie){const dt=op($e.icon),kt=!(re&&Ee.verticalPlacedIconSymbolIndex&&ut);Ee.placedIconSymbolIndex>=0&&(je(o.icon,Ee.numIconVertices,kt?dt:yf),o.icon.placedSymbolArray.get(Ee.placedIconSymbolIndex).hidden=$e.icon.isHidden()),Ee.verticalPlacedIconSymbolIndex>=0&&(je(o.icon,Ee.numVerticalIconVertices,kt?yf:dt),o.icon.placedSymbolArray.get(Ee.verticalPlacedIconSymbolIndex).hidden=$e.icon.isHidden())}const ot=we&&we.has(Se)?we.get(Se):{text:null,icon:null};if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const dt=o.collisionArrays[Se];if(dt){let kt=new a.P(0,0);if(dt.textBox||dt.verticalTextBox){let Et=!0;if(G){const bt=this.variableOffsets[Le];bt?(kt=Xy(bt.anchor,bt.width,bt.height,bt.textOffset,bt.textBoxScale),Y&&kt._rotate(Z?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Et=!1}if(dt.textBox||dt.verticalTextBox){let bt;dt.textBox&&(bt=ut),dt.verticalTextBox&&(bt=st),ej(o.textCollisionBox.collisionVertexArray,$e.text.placed,!Et||bt,ot.text,kt.x,kt.y)}}if(dt.iconBox||dt.verticalIconBox){const Et=!!(!st&&dt.verticalIconBox);let bt;dt.iconBox&&(bt=Et),dt.verticalIconBox&&(bt=!Et),ej(o.iconCollisionBox.collisionVertexArray,$e.icon.placed,bt,ot.icon,re?kt.x:0,re?kt.y:0)}}}}if(o.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.text.opacityVertexArray.length!==o.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${o.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${o.text.layoutVertexArray.length}) / 4`);if(o.icon.opacityVertexArray.length!==o.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${o.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${o.icon.layoutVertexArray.length}) / 4`);o.bucketInstanceId in this.collisionCircleArrays&&(o.collisionCircleArray=this.collisionCircleArrays[o.bucketInstanceId],delete this.collisionCircleArrays[o.bucketInstanceId])}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,f){const x=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*x>o}setStale(){this.stale=!0}}function ej(w,o,f,x,b,P){x&&x.length!==0||(x=[0,0,0,0]);const E=x[0]-ti,F=x[1]-ti,B=x[2]-ti,W=x[3]-ti;w.emplaceBack(o?1:0,f?1:0,b||0,P||0,E,F),w.emplaceBack(o?1:0,f?1:0,b||0,P||0,B,F),w.emplaceBack(o?1:0,f?1:0,b||0,P||0,B,W),w.emplaceBack(o?1:0,f?1:0,b||0,P||0,E,W)}const wP=Math.pow(2,25),tj=Math.pow(2,24),rj=Math.pow(2,17),Qy=Math.pow(2,16),Jy=Math.pow(2,9),nj=Math.pow(2,8),ev=Math.pow(2,1);function op(w){if(w.opacity===0&&!w.placed)return 0;if(w.opacity===1&&w.placed)return 4294967295;const o=w.placed?1:0,f=Math.floor(127*w.opacity);return f*wP+o*tj+f*rj+o*Qy+f*Jy+o*nj+f*ev+o}const yf=0;class vf{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,f,x,b,P){const E=this._bucketParts;for(;this._currentTileIndex<o.length;)if(f.getBucketParts(E,b,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,P())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((F,B)=>F.sortKey-B.sortKey));this._currentPartIndex<E.length;)if(f.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,x),this._currentPartIndex++,P())return!0;return!1}}class lp{constructor(o,f,x,b,P,E,F,B){this.placement=new jP(o,f,E,F,B),this._currentPlacementIndex=x.length-1,this._forceFullPlacement=b,this._showCollisionBoxes=P,this._done=!1}isDone(){return this._done}continuePlacement(o,f,x){const b=k(),P=()=>!this._forceFullPlacement&&k()-b>2;for(;this._currentPlacementIndex>=0;){const E=f[o[this._currentPlacementIndex]],F=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=F)&&(!E.maxzoom||E.maxzoom>F)){if(this._inProgressLayer||(this._inProgressLayer=new vf(E)),this._inProgressLayer.continuePlacement(x[E.source],this.placement,this._showCollisionBoxes,E,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const Td=512/a.a3/2;class Ed{constructor(o,f,x){this.tileID=o,this.bucketInstanceId=x,this._symbolsByKey={};const b=new Map;for(let P=0;P<f.length;P++){const E=f.get(P),F=E.key,B=b.get(F);B?B.push(E):b.set(F,[E])}for(const[P,E]of b){const F={positions:E.map(B=>({x:Math.floor(B.anchorX*Td),y:Math.floor(B.anchorY*Td)})),crossTileIDs:E.map(B=>B.crossTileID)};if(F.positions.length>128){const B=new a.aM(F.positions.length,16,Uint16Array);for(const{x:W,y:G}of F.positions)B.add(W,G);B.finish(),delete F.positions,F.index=B}this._symbolsByKey[P]=F}}getScaledCoordinates(o,f){const{x,y:b,z:P}=this.tileID.canonical,{x:E,y:F,z:B}=f.canonical,W=Td/Math.pow(2,B-P),G=(F*a.a3+o.anchorY)*W,Y=b*a.a3*Td;return{x:Math.floor((E*a.a3+o.anchorX)*W-x*a.a3*Td),y:Math.floor(G-Y)}}findMatches(o,f,x){const b=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z);for(let P=0;P<o.length;P++){const E=o.get(P);if(E.crossTileID)continue;const F=this._symbolsByKey[E.key];if(!F)continue;const B=this.getScaledCoordinates(E,f);if(F.index){const W=F.index.range(B.x-b,B.y-b,B.x+b,B.y+b).sort();for(const G of W){const Y=F.crossTileIDs[G];if(!x[Y]){x[Y]=!0,E.crossTileID=Y;break}}}else if(F.positions)for(let W=0;W<F.positions.length;W++){const G=F.positions[W],Y=F.crossTileIDs[W];if(Math.abs(G.x-B.x)<=b&&Math.abs(G.y-B.y)<=b&&!x[Y]){x[Y]=!0,E.crossTileID=Y;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:o})=>o)}}class sj{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class SP{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const f=Math.round((o-this.lng)/360);if(f!==0)for(const x in this.indexes){const b=this.indexes[x],P={};for(const E in b){const F=b[E];F.tileID=F.tileID.unwrapTo(F.tileID.wrap+f),P[F.tileID.key]=F}this.indexes[x]=P}this.lng=o}addBucket(o,f,x){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let P=0;P<f.symbolInstances.length;P++)f.symbolInstances.get(P).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const b=this.usedCrossTileIDs[o.overscaledZ];for(const P in this.indexes){const E=this.indexes[P];if(Number(P)>o.overscaledZ)for(const F in E){const B=E[F];B.tileID.isChildOf(o)&&B.findMatches(f.symbolInstances,o,b)}else{const F=E[o.scaledTo(Number(P)).key];F&&F.findMatches(f.symbolInstances,o,b)}}for(let P=0;P<f.symbolInstances.length;P++){const E=f.symbolInstances.get(P);E.crossTileID||(E.crossTileID=x.generate(),b[E.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Ed(o,f.symbolInstances,f.bucketInstanceId),!0}removeBucketCrossTileIDs(o,f){for(const x of f.getCrossTileIDsLists())for(const b of x)delete this.usedCrossTileIDs[o][b]}removeStaleBuckets(o){let f=!1;for(const x in this.indexes){const b=this.indexes[x];for(const P in b)o[b[P].bucketInstanceId]||(this.removeBucketCrossTileIDs(x,b[P]),delete b[P],f=!0)}return f}}class Il{constructor(){this.layerIndexes={},this.crossTileIDs=new sj,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,f,x){let b=this.layerIndexes[o.id];b===void 0&&(b=this.layerIndexes[o.id]=new SP);let P=!1;const E={};b.handleWrapJump(x);for(const F of f){const B=F.getBucket(o);B&&o.id===B.layerIds[0]&&(B.bucketInstanceId||(B.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(F.tileID,B,this.crossTileIDs)&&(P=!0),E[B.bucketInstanceId]=!0)}return b.removeStaleBuckets(E)&&(P=!0),P}pruneUnusedLayers(o){const f={};o.forEach(x=>{f[x]=!0});for(const x in this.layerIndexes)f[x]||delete this.layerIndexes[x]}}var hu="void main() {fragColor=vec4(1.0);}";const Ur={prelude:un(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:un("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:un("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:un(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:un(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:un(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:un(hu,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:un(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:un(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:un("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:un("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:un(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:un("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:un(hu,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:un(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:un(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:un(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:un(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:un(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:un(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:un(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:un(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:un(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:un(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:un(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:un(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:un(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:un(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:un(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:un(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:un(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:un("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:un("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:un("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:un("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:un(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:un("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function un(w,o){const f=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,x=o.match(/in ([\w]+) ([\w]+)/g),b=w.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=P?P.concat(b):b,F={};return{fragmentSource:w=w.replace(f,(B,W,G,Y,Z)=>(F[Z]=!0,W==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
in ${G} ${Y} ${Z};
#else
uniform ${G} ${Y} u_${Z};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Z}
    ${G} ${Y} ${Z} = u_${Z};
#endif
`)),vertexSource:o=o.replace(f,(B,W,G,Y,Z)=>{const re=Y==="float"?"vec2":"vec4",he=Z.match(/color/)?"color":re;return F[Z]?W==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
uniform lowp float u_${Z}_t;
in ${G} ${re} a_${Z};
out ${G} ${Y} ${Z};
#else
uniform ${G} ${Y} u_${Z};
#endif
`:he==="vec4"?`
#ifndef HAS_UNIFORM_u_${Z}
    ${Z} = a_${Z};
#else
    ${G} ${Y} ${Z} = u_${Z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Z}
    ${Z} = unpack_mix_${he}(a_${Z}, u_${Z}_t);
#else
    ${G} ${Y} ${Z} = u_${Z};
#endif
`:W==="define"?`
#ifndef HAS_UNIFORM_u_${Z}
uniform lowp float u_${Z}_t;
in ${G} ${re} a_${Z};
#else
uniform ${G} ${Y} u_${Z};
#endif
`:he==="vec4"?`
#ifndef HAS_UNIFORM_u_${Z}
    ${G} ${Y} ${Z} = a_${Z};
#else
    ${G} ${Y} ${Z} = u_${Z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Z}
    ${G} ${Y} ${Z} = unpack_mix_${he}(a_${Z}, u_${Z}_t);
#else
    ${G} ${Y} ${Z} = u_${Z};
#endif
`}),staticAttributes:x,staticUniforms:E}}class Md{constructor(o,f,x){this.vertexBuffer=o,this.indexBuffer=f,this.segments=x}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var il=a.aN([{name:"a_pos",type:"Int16",components:2}]);const ba="#define PROJECTION_MERCATOR",Hi="mercator";class Di{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Hi}get shaderDefine(){return ba}get shaderPreludeCode(){return Ur.projectionMercator}get vertexShaderPreludeCode(){return Ur.projectionMercator.vertexSource}get subdivisionGranularity(){return a.aO.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(o){}getMeshFromTileID(o,f,x,b,P){if(this._cachedMesh)return this._cachedMesh;const E=new a.aP;E.emplaceBack(0,0),E.emplaceBack(a.a3,0),E.emplaceBack(0,a.a3),E.emplaceBack(a.a3,a.a3);const F=o.createVertexBuffer(E,il.members),B=a.aQ.simpleSegment(0,0,4,2),W=new a.aR;W.emplaceBack(1,0,2),W.emplaceBack(1,2,3);const G=o.createIndexBuffer(W);return this._cachedMesh=new Md(F,G,B),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(o){}}class Vs{constructor(o=0,f=0,x=0,b=0){if(isNaN(o)||o<0||isNaN(f)||f<0||isNaN(x)||x<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=f,this.left=x,this.right=b}interpolate(o,f,x){return f.top!=null&&o.top!=null&&(this.top=a.F.number(o.top,f.top,x)),f.bottom!=null&&o.bottom!=null&&(this.bottom=a.F.number(o.bottom,f.bottom,x)),f.left!=null&&o.left!=null&&(this.left=a.F.number(o.left,f.left,x)),f.right!=null&&o.right!=null&&(this.right=a.F.number(o.right,f.right,x)),this}getCenter(o,f){const x=a.ai((this.left+o-this.right)/2,0,o),b=a.ai((this.top+f-this.bottom)/2,0,f);return new a.P(x,b)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new Vs(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Qn(w,o){if(!w.renderWorldCopies||w.lngRange)return;const f=o.lng-w.center.lng;o.lng+=f>180?-360:f<-180?360:0}function ij(w){return Math.max(0,Math.floor(w))}class Zi{constructor(o,f){var x;this._callbacks=o,this._tileSize=512,this._renderWorldCopies=(f==null?void 0:f.renderWorldCopies)===void 0||!!(f!=null&&f.renderWorldCopies),this._minZoom=(f==null?void 0:f.minZoom)||0,this._maxZoom=(f==null?void 0:f.maxZoom)||22,this._minPitch=(f==null?void 0:f.minPitch)==null?0:f==null?void 0:f.minPitch,this._maxPitch=(f==null?void 0:f.maxPitch)==null?60:f==null?void 0:f.maxPitch,this._constrain=(x=f==null?void 0:f.constrain)!==null&&x!==void 0?x:this._callbacks.constrain,this.setMaxBounds(),this._width=0,this._height=0,this._center=new a.U(0,0),this._elevation=0,this._zoom=0,this._tileZoom=ij(this._zoom),this._scale=a.al(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Vs,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(o,f,x){this._latRange=o.latRange,this._lngRange=o.lngRange,this._width=o.width,this._height=o.height,this._center=o.center,this._elevation=o.elevation,this._minElevationForCurrentTile=o.minElevationForCurrentTile,this._zoom=o.zoom,this._tileZoom=ij(this._zoom),this._scale=a.al(this._zoom),this._bearingInRadians=o.bearingInRadians,this._fovInRadians=o.fovInRadians,this._pitchInRadians=o.pitchInRadians,this._rollInRadians=o.rollInRadians,this._unmodified=o.unmodified,this._edgeInsets=new Vs(o.padding.top,o.padding.bottom,o.padding.left,o.padding.right),this._minZoom=o.minZoom,this._maxZoom=o.maxZoom,this._minPitch=o.minPitch,this._maxPitch=o.maxPitch,this._renderWorldCopies=o.renderWorldCopies,this._cameraToCenterDistance=o.cameraToCenterDistance,this._nearZ=o.nearZ,this._farZ=o.farZ,this._autoCalculateNearFarZ=!x&&o.autoCalculateNearFarZ,f&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(o){this._minElevationForCurrentTile=o}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(o){this._minZoom!==o&&(this._minZoom=o,this.setZoom(this.constrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.setZoom(this.constrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(o){this._minPitch!==o&&(this._minPitch=o,this.setPitch(Math.max(this.pitch,o)))}get maxPitch(){return this._maxPitch}setMaxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.setPitch(Math.min(this.pitch,o)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get constrain(){return this._constrain}setConstrain(o){o||(o=this._callbacks.constrain),this._constrain=o,this.constrainInternal(),this._calcMatrices()}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(o){const f=a.V(o,-180,180)*Math.PI/180;var x,b,P,E,F,B,W,G,Y;this._bearingInRadians!==f&&(this._unmodified=!1,this._bearingInRadians=f,this._calcMatrices(),this._rotationMatrix=p(),x=this._rotationMatrix,P=-this._bearingInRadians,E=(b=this._rotationMatrix)[0],F=b[1],B=b[2],W=b[3],G=Math.sin(P),Y=Math.cos(P),x[0]=E*Y+B*G,x[1]=F*Y+W*G,x[2]=E*-G+B*Y,x[3]=F*-G+W*Y)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(o){const f=a.ai(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==f&&(this._unmodified=!1,this._pitchInRadians=f,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(o){const f=o/180*Math.PI;this._rollInRadians!==f&&(this._unmodified=!1,this._rollInRadians=f,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return a.aS(this._fovInRadians)}setFov(o){o=a.ai(o,.1,150),this.fov!==o&&(this._unmodified=!1,this._fovInRadians=a.ak(o),this._calcMatrices())}get zoom(){return this._zoom}setZoom(o){const f=this.constrain(this._center,o).zoom;this._zoom!==f&&(this._unmodified=!1,this._zoom=f,this._tileZoom=Math.max(0,Math.floor(f)),this._scale=a.al(f),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(o){o!==this._elevation&&(this._elevation=o,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(o,f){this._autoCalculateNearFarZ=!1,this._nearZ=o,this._farZ=f,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,f,x){this._unmodified=!1,this._edgeInsets.interpolate(o,f,x),this.constrainInternal(),this._calcMatrices()}resize(o,f,x=!0){this._width=o,this._height=f,x&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Lr([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(o){o?(this._lngRange=[o.getWest(),o.getEast()],this._latRange=[o.getSouth(),o.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-a.aj,a.aj])}getCameraQueryGeometry(o,f){if(f.length===1)return[f[0],o];{const{minX:x,minY:b,maxX:P,maxY:E}=a.a6.fromPoints(f).extend(o);return[new a.P(x,b),new a.P(P,b),new a.P(P,E),new a.P(x,E),new a.P(x,b)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const o=this._unmodified,{center:f,zoom:x}=this.constrain(this.center,this.zoom);this.setCenter(f),this.setZoom(x),this._unmodified=o,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let o=a.am(new Float64Array(16));a.O(o,o,[this._width/2,-this._height/2,1]),a.N(o,o,[1,-1,0]),this._clipSpaceToPixelsMatrix=o,o=a.am(new Float64Array(16)),a.O(o,o,[1,-1,1]),a.N(o,o,[-1,-1,0]),a.O(o,o,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=o,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(o,f,x,b){const P=x!==void 0?x:this.bearing,E=b=b!==void 0?b:this.pitch,F=a.a5.fromLngLat(o,f),B=-Math.cos(a.ak(E)),W=Math.sin(a.ak(E)),G=W*Math.sin(a.ak(P)),Y=-W*Math.cos(a.ak(P));let Z=this.elevation;const re=f-Z;let he;B*re>=0||Math.abs(B)<.1?(he=1e4,Z=f+he*B):he=-re/B;let je,we,Se=a.aT(1,F.y),Ee=0;do{if(Ee+=1,Ee>10)break;we=he/Se,je=new a.a5(F.x+G*we,F.y+Y*we),Se=1/je.meterInMercatorCoordinateUnits()}while(Math.abs(he-we*Se)>1e-12);return{center:je.toLngLat(),elevation:Z,zoom:a.ao(this.height/2/Math.tan(this.fovInRadians/2)/we/this.tileSize)}}recalculateZoomAndCenter(o){if(this.elevation-o==0)return;const f=a.an(1,this.center.lat)*this.worldSize,x=this.cameraToCenterDistance/f,b=a.a5.fromLngLat(this.center,this.elevation),P=Je(this.center,this.elevation,this.pitch,this.bearing,x);this._elevation=o;const E=this.calculateCenterFromCameraLngLatAlt(P.toLngLat(),a.aT(P.z,b.y),this.bearing,this.pitch);this._elevation=E.elevation,this._center=E.center,this.setZoom(E.zoom)}getCameraPoint(){const o=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(o*Math.sin(this.rollInRadians),o*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const o=a.an(1,this.center.lat)*this.worldSize;return Je(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/o).toLngLat()}getMercatorTileCoordinates(o){if(!o)return[0,0,1,1];const f=o.canonical.z>=0?1<<o.canonical.z:Math.pow(2,o.canonical.z);return[o.canonical.x/f,o.canonical.y/f,1/f/a.a3,1/f/a.a3]}}class ca{constructor(o,f){this.min=o,this.max=f,this.center=a.aU([],a.aV([],this.min,this.max),.5)}quadrant(o){const f=[o%2==0,o<2],x=a.aW(this.min),b=a.aW(this.max);for(let P=0;P<f.length;P++)x[P]=f[P]?this.min[P]:this.center[P],b[P]=f[P]?this.center[P]:this.max[P];return b[2]=this.max[2],new ca(x,b)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersectsFrustum(o){let f=!0;for(let x=0;x<o.planes.length;x++){const b=this.intersectsPlane(o.planes[x]);if(b===0)return 0;b===1&&(f=!1)}return f?2:o.aabb.min[0]>this.max[0]||o.aabb.min[1]>this.max[1]||o.aabb.min[2]>this.max[2]||o.aabb.max[0]<this.min[0]||o.aabb.max[1]<this.min[1]||o.aabb.max[2]<this.min[2]?0:1}intersectsPlane(o){let f=o[3],x=o[3];for(let b=0;b<3;b++)o[b]>0?(f+=o[b]*this.min[b],x+=o[b]*this.max[b]):(x+=o[b]*this.min[b],f+=o[b]*this.max[b]);return f>=0?2:x<0?0:1}}class $a{distanceToTile2d(o,f,x,b){const P=b.distanceX([o,f]),E=b.distanceY([o,f]);return Math.hypot(P,E)}getWrap(o,f,x){return x}getTileBoundingVolume(o,f,x,b){var P,E;let F=0,B=0;if(b!=null&&b.terrain){const G=new a.a0(o.z,f,o.z,o.x,o.y),Y=b.terrain.getMinMaxElevation(G);F=(P=Y.minElevation)!==null&&P!==void 0?P:Math.min(0,x),B=(E=Y.maxElevation)!==null&&E!==void 0?E:Math.max(0,x)}const W=1<<o.z;return new ca([f+o.x/W,o.y/W,F],[f+(o.x+1)/W,(o.y+1)/W,B])}allowVariableZoom(o,f){const x=o.fov*(Math.abs(Math.cos(o.rollInRadians))*o.height+Math.abs(Math.sin(o.rollInRadians))*o.width)/o.height,b=a.ai(78.5-x/2,0,60);return!!f.terrain||o.pitch>b}allowWorldCopies(){return!0}prepareNextFrame(){}}class _f{constructor(o,f,x){this.points=o,this.planes=f,this.aabb=x}static fromInvProjectionMatrix(o,f=1,x=0,b,P){const E=P?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],F=Math.pow(2,x),B=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(Z=>function(re,he,je,we){const Se=a.aA([],re,he),Ee=1/Se[3]/je*we;return a.a$(Se,Se,[Ee,Ee,1/Se[3],Ee])}(Z,o,f,F));b&&function(Z,re,he,je){const we=je?4:0,Se=je?0:4;let Ee=0;const Re=[],Te=[];for(let Ie=0;Ie<4;Ie++){const Ke=a.aX([],Z[Ie+Se],Z[Ie+we]),ut=a.b0(Ke);a.aU(Ke,Ke,1/ut),Re.push(ut),Te.push(Ke)}for(let Ie=0;Ie<4;Ie++){const Ke=a.b1(Z[Ie+we],Te[Ie],he);Ee=Ke!==null&&Ke>=0?Math.max(Ee,Ke):Math.max(Ee,Re[Ie])}const Le=function(Ie,Ke){const ut=a.aX([],Ie[Ke[0]],Ie[Ke[1]]),st=a.aX([],Ie[Ke[2]],Ie[Ke[1]]),ot=[0,0,0,0];return a.aY(ot,a.aZ([],ut,st)),ot[3]=-a.a_(ot,Ie[Ke[0]]),ot}(Z,re),$e=function(Ie,Ke){const ut=a.b2(Ie),st=a.b3([],Ie,1/ut),ot=a.aX([],Ke,a.aU([],st,a.a_(Ke,st))),dt=a.b2(ot);if(dt>0){const kt=Math.sqrt(1-st[3]*st[3]),Et=a.aU([],st,-st[3]),bt=a.aV([],Et,a.aU([],ot,kt/dt));return a.b4(Ke,bt)}return null}(he,Le);if($e!==null){const Ie=$e/a.a_(Te[0],Le);Ee=Math.min(Ee,Ie)}for(let Ie=0;Ie<4;Ie++){const Ke=Math.min(Ee,Re[Ie]);Z[Ie+Se]=[Z[Ie+we][0]+Te[Ie][0]*Ke,Z[Ie+we][1]+Te[Ie][1]*Ke,Z[Ie+we][2]+Te[Ie][2]*Ke,1]}}(B,E[0],b,P);const W=E.map(Z=>{const re=a.aX([],B[Z[0]],B[Z[1]]),he=a.aX([],B[Z[2]],B[Z[1]]),je=a.aY([],a.aZ([],re,he)),we=-a.a_(je,B[Z[1]]);return je.concat(we)}),G=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],Y=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const Z of B)for(let re=0;re<3;re++)G[re]=Math.min(G[re],Z[re]),Y[re]=Math.max(Y[re],Z[re]);return new _f(B,W,new ca(G,Y))}}class al{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(o){this._helper.setMinZoom(o)}setMaxZoom(o){this._helper.setMaxZoom(o)}setMinPitch(o){this._helper.setMinPitch(o)}setMaxPitch(o){this._helper.setMaxPitch(o)}setRenderWorldCopies(o){this._helper.setRenderWorldCopies(o)}setBearing(o){this._helper.setBearing(o)}setPitch(o){this._helper.setPitch(o)}setRoll(o){this._helper.setRoll(o)}setFov(o){this._helper.setFov(o)}setZoom(o){this._helper.setZoom(o)}setCenter(o){this._helper.setCenter(o)}setElevation(o){this._helper.setElevation(o)}setMinElevationForCurrentTile(o){this._helper.setMinElevationForCurrentTile(o)}setPadding(o){this._helper.setPadding(o)}interpolatePadding(o,f,x){return this._helper.interpolatePadding(o,f,x)}isPaddingEqual(o){return this._helper.isPaddingEqual(o)}resize(o,f,x=!0){this._helper.resize(o,f,x)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(o){this._helper.setMaxBounds(o)}setConstrain(o){this._helper.setConstrain(o)}overrideNearFarZ(o,f){this._helper.overrideNearFarZ(o,f)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(o){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),o)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrain(){return this._helper.constrain}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(o,f){}constructor(o){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(f,x)=>{x=a.ai(+x,this.minZoom,this.maxZoom);const b={center:new a.U(f.lng,f.lat),zoom:x};let P=this._helper._lngRange;if(!this._helper._renderWorldCopies&&P===null){const Te=179.9999999999;P=[-Te,Te]}const E=this.tileSize*a.al(b.zoom);let F=0,B=E,W=0,G=E,Y=0,Z=0;const{x:re,y:he}=this.size;if(this._helper._latRange){const Te=this._helper._latRange;F=a.W(Te[1])*E,B=a.W(Te[0])*E,B-F<he&&(Y=he/(B-F))}P&&(W=a.V(a.X(P[0])*E,0,E),G=a.V(a.X(P[1])*E,0,E),G<W&&(G+=E),G-W<re&&(Z=re/(G-W)));const{x:je,y:we}=ct(E,f);let Se,Ee;const Re=Math.max(Z||0,Y||0);if(Re){const Te=new a.P(Z?(G+W)/2:je,Y?(B+F)/2:we);return b.center=Pt(E,Te).wrap(),b.zoom+=a.ao(Re),b}if(this._helper._latRange){const Te=he/2;we-Te<F&&(Ee=F+Te),we+Te>B&&(Ee=B-Te)}if(P){const Te=(W+G)/2;let Le=je;this._helper._renderWorldCopies&&(Le=a.V(je,Te-E/2,Te+E/2));const $e=re/2;Le-$e<W&&(Se=W+$e),Le+$e>G&&(Se=G-$e)}if(Se!==void 0||Ee!==void 0){const Te=new a.P(Se??je,Ee??we);b.center=Pt(E,Te).wrap()}return b},this._helper=new Zi({calcMatrices:()=>{this._calcMatrices()},constrain:(f,x)=>this.defaultConstrain(f,x)},o),this._coveringTilesDetailsProvider=new $a}clone(){const o=new al;return o.apply(this),o}apply(o,f,x){this._helper.apply(o,f,x)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(o){const f=[new a.b5(0,o)];if(this._helper._renderWorldCopies){const x=this.screenPointToMercatorCoordinate(new a.P(0,0)),b=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,0)),P=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,this._helper._height)),E=this.screenPointToMercatorCoordinate(new a.P(0,this._helper._height)),F=Math.floor(Math.min(x.x,b.x,P.x,E.x)),B=Math.floor(Math.max(x.x,b.x,P.x,E.x)),W=1;for(let G=F-W;G<=B+W;G++)G!==0&&f.push(new a.b5(G,o))}return f}getCameraFrustum(){return _f.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(o){const f=this.screenPointToLocation(this.centerPoint,o),x=o?o.getElevationForLngLatZoom(f,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(x)}setLocationAtPoint(o,f){const x=a.an(this.elevation,this.center.lat),b=this.screenPointToMercatorCoordinateAtZ(f,x),P=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,x),E=a.a5.fromLngLat(o),F=new a.a5(E.x-(b.x-P.x),E.y-(b.y-P.y));this.setCenter(F==null?void 0:F.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(o,f){return f?this.coordinatePoint(a.a5.fromLngLat(o),f.getElevationForLngLatZoom(o,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(a.a5.fromLngLat(o))}screenPointToLocation(o,f){var x;return(x=this.screenPointToMercatorCoordinate(o,f))===null||x===void 0?void 0:x.toLngLat()}screenPointToMercatorCoordinate(o,f){if(f){const x=f.pointCoordinate(o);if(x!=null)return x}return this.screenPointToMercatorCoordinateAtZ(o)}screenPointToMercatorCoordinateAtZ(o,f){const x=f||0,b=[o.x,o.y,0,1],P=[o.x,o.y,1,1];a.aA(b,b,this._pixelMatrixInverse),a.aA(P,P,this._pixelMatrixInverse);const E=b[3],F=P[3],B=b[1]/E,W=P[1]/F,G=b[2]/E,Y=P[2]/F,Z=G===Y?0:(x-G)/(Y-G);return new a.a5(a.F.number(b[0]/E,P[0]/F,Z)/this.worldSize,a.F.number(B,W,Z)/this.worldSize,x)}coordinatePoint(o,f=0,x=this._pixelMatrix){const b=[o.x*this.worldSize,o.y*this.worldSize,f,1];return a.aA(b,b,x),new a.P(b[0]/b[3],b[1]/b[3])}getBounds(){const o=Math.max(0,this._helper._height/2-yt(this));return new Lr().extend(this.screenPointToLocation(new a.P(0,o))).extend(this.screenPointToLocation(new a.P(this._helper._width,o))).extend(this.screenPointToLocation(new a.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new a.P(0,this._helper._height)))}isPointOnMapSurface(o,f){return f?f.pointCoordinate(o)!=null:o.y>this.height/2-yt(this)}calculatePosMatrix(o,f=!1,x){var b;const P=(b=o.key)!==null&&b!==void 0?b:a.b6(o.wrap,o.canonical.z,o.canonical.z,o.canonical.x,o.canonical.y),E=f?this._alignedPosMatrixCache:this._posMatrixCache;if(E.has(P)){const W=E.get(P);return x?W.f32:W.f64}const F=or(o,this.worldSize);a.Q(F,f?this._alignedProjMatrix:this._viewProjMatrix,F);const B={f64:F,f32:new Float32Array(F)};return E.set(P,B),x?B.f32:B.f64}calculateFogMatrix(o){const f=o.key,x=this._fogMatrixCacheF32;if(x.has(f))return x.get(f);const b=or(o,this.worldSize);return a.Q(b,this._fogMatrix,b),x.set(f,new Float32Array(b)),x.get(f)}calculateCenterFromCameraLngLatAlt(o,f,x,b){return this._helper.calculateCenterFromCameraLngLatAlt(o,f,x,b)}_calculateNearFarZIfNeeded(o,f,x){if(!this._helper.autoCalculateNearFarZ)return;const b=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),P=o-b*this._helper._pixelPerMeter/Math.cos(f),E=b<0?P:o,F=Math.PI/2+this.pitchInRadians,B=a.ak(this.fov)*(Math.abs(Math.cos(a.ak(this.roll)))*this.height+Math.abs(Math.sin(a.ak(this.roll)))*this.width)/this.height*(.5+x.y/this.height),W=Math.sin(B)*E/Math.sin(a.ai(Math.PI-F-B,.01,Math.PI-.01)),G=yt(this),Y=Math.atan(G/this._helper.cameraToCenterDistance),Z=a.ak(.75),re=Y>Z?2*Y*(.5+x.y/(2*G)):Z,he=Math.sin(re)*E/Math.sin(a.ai(Math.PI-F-re,.01,Math.PI-.01)),je=Math.min(W,he);this._helper._farZ=1.01*(Math.cos(Math.PI/2-f)*je+E),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const o=this.centerOffset,f=ct(this.worldSize,this.center),x=f.x,b=f.y;this._helper._pixelPerMeter=a.an(1,this.center.lat)*this.worldSize;const P=a.ak(Math.min(this.pitch,He)),E=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(P));let F;this._calculateNearFarZIfNeeded(E,P,o),F=new Float64Array(16),a.b7(F,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),a.au(this._invProjMatrix,F),F[8]=2*-o.x/this._helper._width,F[9]=2*o.y/this._helper._height,this._projectionMatrix=a.b8(F),a.O(F,F,[1,-1,1]),a.N(F,F,[0,0,-this._helper.cameraToCenterDistance]),a.b9(F,F,-this.rollInRadians),a.ba(F,F,this.pitchInRadians),a.b9(F,F,-this.bearingInRadians),a.N(F,F,[-x,-b,0]),this._mercatorMatrix=a.O([],F,[this.worldSize,this.worldSize,this.worldSize]),a.O(F,F,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=a.Q(new Float64Array(16),this.clipSpaceToPixelsMatrix,F),a.N(F,F,[0,0,-this.elevation]),this._viewProjMatrix=F,this._invViewProjMatrix=a.au([],F);const B=[0,0,-1,1];a.aA(B,B,this._invViewProjMatrix),this._cameraPosition=[B[0]/B[3],B[1]/B[3],B[2]/B[3]],this._fogMatrix=new Float64Array(16),a.b7(this._fogMatrix,this.fovInRadians,this.width/this.height,E,this._helper._farZ),this._fogMatrix[8]=2*-o.x/this.width,this._fogMatrix[9]=2*o.y/this.height,a.O(this._fogMatrix,this._fogMatrix,[1,-1,1]),a.N(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),a.b9(this._fogMatrix,this._fogMatrix,-this.rollInRadians),a.ba(this._fogMatrix,this._fogMatrix,this.pitchInRadians),a.b9(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),a.N(this._fogMatrix,this._fogMatrix,[-x,-b,0]),a.O(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),a.N(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=a.Q(new Float64Array(16),this.clipSpaceToPixelsMatrix,F);const W=this._helper._width%2/2,G=this._helper._height%2/2,Y=Math.cos(this.bearingInRadians),Z=Math.sin(-this.bearingInRadians),re=x-Math.round(x)+Y*W+Z*G,he=b-Math.round(b)+Y*G+Z*W,je=new Float64Array(F);if(a.N(je,je,[re>.5?re-1:re,he>.5?he-1:he,0]),this._alignedProjMatrix=je,F=a.au(new Float64Array(16),this._pixelMatrix),!F)throw new Error("failed to invert matrix");this._pixelMatrixInverse=F,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const o=this.screenPointToMercatorCoordinate(new a.P(0,0)),f=[o.x*this.worldSize,o.y*this.worldSize,0,1];return a.aA(f,f,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const o=a.an(1,this.center.lat)*this.worldSize;return Je(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/o).toLngLat()}lngLatToCameraDepth(o,f){const x=a.a5.fromLngLat(o),b=[x.x*this.worldSize,x.y*this.worldSize,f,1];return a.aA(b,b,this._viewProjMatrix),b[2]/b[3]}getProjectionData(o){const{overscaledTileID:f,aligned:x,applyTerrainMatrix:b}=o,P=this._helper.getMercatorTileCoordinates(f),E=f?this.calculatePosMatrix(f,x,!0):null;let F;return F=f&&f.terrainRttPosMatrix32f&&b?f.terrainRttPosMatrix32f:E||a.bb(),{mainMatrix:F,tileMercatorCoords:P,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:F}}isLocationOccluded(o){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(o,f,x){return 1}transformLightDirection(o){return a.aW(o)}getRayDirectionFromPixel(o){throw new Error("Not implemented.")}projectTileCoordinates(o,f,x,b){const P=this.calculatePosMatrix(x);let E;b?(E=[o,f,b(o,f),1],a.aA(E,E,P)):(E=[o,f,0,1],uu(E,E,P));const F=E[3];return{point:new a.P(E[0]/F,E[1]/F),signedDistanceFromCamera:F,isOccluded:!1}}populateCache(o){for(const f of o)this.calculatePosMatrix(f)}getMatrixForModel(o,f){const x=a.a5.fromLngLat(o,f),b=x.meterInMercatorCoordinateUnits(),P=a.bc();return a.N(P,P,[x.x,x.y,x.z]),a.b9(P,P,Math.PI),a.ba(P,P,Math.PI/2),a.O(P,P,[-b,b,b]),P}getProjectionDataForCustomLayer(o=!0){const f=new a.a0(0,0,0,0,0),x=this.getProjectionData({overscaledTileID:f,applyGlobeMatrix:o}),b=or(f,this.worldSize);a.Q(b,this._viewProjMatrix,b),x.tileMercatorCoords=[0,0,1,1];const P=[a.a3,a.a3,this.worldSize/this._helper.pixelsPerMeter],E=a.bd();return a.O(E,b,P),x.fallbackMatrix=E,x.mainMatrix=E,x}getFastPathSimpleProjectionMatrix(o){return this.calculatePosMatrix(o)}}function Es(){a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Od(w){if(w.useSlerp)if(w.k<1){const o=a.be(w.startEulerAngles.roll,w.startEulerAngles.pitch,w.startEulerAngles.bearing),f=a.be(w.endEulerAngles.roll,w.endEulerAngles.pitch,w.endEulerAngles.bearing),x=new Float64Array(4);a.bf(x,o,f,w.k);const b=a.bg(x);w.tr.setRoll(b.roll),w.tr.setPitch(b.pitch),w.tr.setBearing(b.bearing)}else w.tr.setRoll(w.endEulerAngles.roll),w.tr.setPitch(w.endEulerAngles.pitch),w.tr.setBearing(w.endEulerAngles.bearing);else w.tr.setRoll(a.F.number(w.startEulerAngles.roll,w.endEulerAngles.roll,w.k)),w.tr.setPitch(a.F.number(w.startEulerAngles.pitch,w.endEulerAngles.pitch,w.k)),w.tr.setBearing(a.F.number(w.startEulerAngles.bearing,w.endEulerAngles.bearing,w.k))}function Sc(w,o,f,x,b){const P=b.padding,E=ct(b.worldSize,f.getNorthWest()),F=ct(b.worldSize,f.getNorthEast()),B=ct(b.worldSize,f.getSouthEast()),W=ct(b.worldSize,f.getSouthWest()),G=a.ak(-x),Y=E.rotate(G),Z=F.rotate(G),re=B.rotate(G),he=W.rotate(G),je=new a.P(Math.max(Y.x,Z.x,he.x,re.x),Math.max(Y.y,Z.y,he.y,re.y)),we=new a.P(Math.min(Y.x,Z.x,he.x,re.x),Math.min(Y.y,Z.y,he.y,re.y)),Se=je.sub(we),Ee=(b.width-(P.left+P.right+o.left+o.right))/Se.x,Re=(b.height-(P.top+P.bottom+o.top+o.bottom))/Se.y;if(Re<0||Ee<0)return void Es();const Te=Math.min(a.ao(b.scale*Math.min(Ee,Re)),w.maxZoom),Le=a.P.convert(w.offset),$e=new a.P((o.left-o.right)/2,(o.top-o.bottom)/2).rotate(a.ak(x)),Ie=Le.add($e).mult(b.scale/a.al(Te));return{center:Pt(b.worldSize,E.add(B).div(2).sub(Ie)),zoom:Te,bearing:x}}class fu{get useGlobeControls(){return!1}handlePanInertia(o,f){const x=o.mag(),b=Math.abs(yt(f));return{easingOffset:o.mult(Math.min(.75*b/x,1)),easingCenter:f.center}}handleMapControlsRollPitchBearingZoom(o,f){o.bearingDelta&&f.setBearing(f.bearing+o.bearingDelta),o.pitchDelta&&f.setPitch(f.pitch+o.pitchDelta),o.rollDelta&&f.setRoll(f.roll+o.rollDelta),o.zoomDelta&&f.setZoom(f.zoom+o.zoomDelta)}handleMapControlsPan(o,f,x){o.around.distSqr(f.centerPoint)<.01||f.setLocationAtPoint(x,o.around)}cameraForBoxAndBearing(o,f,x,b,P){return Sc(o,f,x,b,P)}handleJumpToCenterZoom(o,f){o.zoom!==(f.zoom!==void 0?+f.zoom:o.zoom)&&o.setZoom(+f.zoom),f.center!==void 0&&o.setCenter(a.U.convert(f.center))}handleEaseTo(o,f){const x=o.zoom,b=o.padding,P={roll:o.roll,pitch:o.pitch,bearing:o.bearing},E={roll:f.roll===void 0?o.roll:f.roll,pitch:f.pitch===void 0?o.pitch:f.pitch,bearing:f.bearing===void 0?o.bearing:f.bearing},F=f.zoom!==void 0,B=!o.isPaddingEqual(f.padding);let W=!1;const G=F?+f.zoom:o.zoom;let Y=o.centerPoint.add(f.offsetAsPoint);const Z=o.screenPointToLocation(Y),{center:re,zoom:he}=o.constrain(a.U.convert(f.center||Z),G??x);Qn(o,re);const je=ct(o.worldSize,Z),we=ct(o.worldSize,re).sub(je),Se=a.al(he-x);return W=he!==x,{easeFunc:Ee=>{if(W&&o.setZoom(a.F.number(x,he,Ee)),a.bh(P,E)||Od({startEulerAngles:P,endEulerAngles:E,tr:o,k:Ee,useSlerp:P.roll!=E.roll}),B&&(o.interpolatePadding(b,f.padding,Ee),Y=o.centerPoint.add(f.offsetAsPoint)),f.around)o.setLocationAtPoint(f.around,f.aroundPoint);else{const Re=a.al(o.zoom-x),Te=he>x?Math.min(2,Se):Math.max(.5,Se),Le=Math.pow(Te,1-Ee),$e=Pt(o.worldSize,je.add(we.mult(Ee*Le)).mult(Re));o.setLocationAtPoint(o.renderWorldCopies?$e.wrap():$e,Y)}},isZooming:W,elevationCenter:re}}handleFlyTo(o,f){const x=f.zoom!==void 0,b=o.zoom,P=o.constrain(a.U.convert(f.center||f.locationAtOffset),x?+f.zoom:b),E=P.center,F=P.zoom;Qn(o,E);const B=ct(o.worldSize,f.locationAtOffset),W=ct(o.worldSize,E).sub(B),G=W.mag(),Y=a.al(F-b);let Z;if(f.minZoom!==void 0){const re=Math.min(+f.minZoom,b,F),he=o.constrain(E,re).zoom;Z=a.al(he-b)}return{easeFunc:(re,he,je,we)=>{o.setZoom(re===1?F:b+a.ao(he));const Se=re===1?E:Pt(o.worldSize,B.add(W.mult(je)).mult(he));o.setLocationAtPoint(o.renderWorldCopies?Se.wrap():Se,we)},scaleOfZoom:Y,targetCenter:E,scaleOfMinZoom:Z,pixelPathLength:G}}}class jn{constructor(o,f,x){this.blendFunction=o,this.blendColor=f,this.mask=x}}jn.Replace=[1,0],jn.disabled=new jn(jn.Replace,a.bi.transparent,[!1,!1,!1,!1]),jn.unblended=new jn(jn.Replace,a.bi.transparent,[!0,!0,!0,!0]),jn.alphaBlended=new jn([1,771],a.bi.transparent,[!0,!0,!0,!0]);const cp=2305;class nn{constructor(o,f,x){this.enable=o,this.mode=f,this.frontFace=x}}nn.disabled=new nn(!1,1029,cp),nn.backCCW=new nn(!0,1029,cp),nn.frontCCW=new nn(!0,1028,cp);class Jr{constructor(o,f,x){this.func=o,this.mask=f,this.range=x}}Jr.ReadOnly=!1,Jr.ReadWrite=!0,Jr.disabled=new Jr(519,Jr.ReadOnly,[0,1]);const up=7680;class vn{constructor(o,f,x,b,P,E){this.test=o,this.ref=f,this.mask=x,this.fail=b,this.depthFail=P,this.pass=E}}vn.disabled=new vn({func:519,mask:0},0,0,up,up,up);const Id=new WeakMap;function so(w){var o;if(Id.has(w))return Id.get(w);{const f=(o=w.getParameter(w.VERSION))===null||o===void 0?void 0:o.startsWith("WebGL 2.0");return Id.set(w,f),f}}class bf{get awaitingQuery(){return!!this._readbackQueue}constructor(o){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=o;const f=o.context,x=f.gl;this._texFormat=x.RGBA,this._texType=x.UNSIGNED_BYTE;const b=new a.aP;b.emplaceBack(-1,-1),b.emplaceBack(2,-1),b.emplaceBack(-1,2);const P=new a.aR;P.emplaceBack(0,1,2),this._fullscreenTriangle=new Md(f.createVertexBuffer(b,il.members),f.createIndexBuffer(P),a.aQ.simpleSegment(0,0,b.length,P.length)),this._resultBuffer=new Uint8Array(4),f.activeTexture.set(x.TEXTURE1);const E=x.createTexture();x.bindTexture(x.TEXTURE_2D,E),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,x.NEAREST),x.texImage2D(x.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=f.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(E),so(x)&&(this._pbo=x.createBuffer(),x.bindBuffer(x.PIXEL_PACK_BUFFER,this._pbo),x.bufferData(x.PIXEL_PACK_BUFFER,4,x.STREAM_READ),x.bindBuffer(x.PIXEL_PACK_BUFFER,null))}destroy(){const o=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),o.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(o,f){const x=this._updateCount;return this._readbackQueue?x>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():x>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(o,f),this._updateCount++,this._measuredError}_bindFramebuffer(){const o=this._cachedRenderContext.context,f=o.gl;o.activeTexture.set(f.TEXTURE1),f.bindTexture(f.TEXTURE_2D,this._fbo.colorAttachment.get()),o.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(o,f){const x=this._cachedRenderContext.context,b=x.gl;if(this._bindFramebuffer(),x.viewport.set([0,0,this._texWidth,this._texHeight]),x.clear({color:a.bi.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(x,b.TRIANGLES,Jr.disabled,vn.disabled,jn.unblended,nn.disabled,((P,E)=>({u_input:P,u_output_expected:E}))(o,f),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&so(b)){b.bindBuffer(b.PIXEL_PACK_BUFFER,this._pbo),b.readBuffer(b.COLOR_ATTACHMENT0),b.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),b.bindBuffer(b.PIXEL_PACK_BUFFER,null);const P=b.fenceSync(b.SYNC_GPU_COMMANDS_COMPLETE,0);b.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:P}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const o=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&so(o)){const f=o.clientWaitSync(this._readbackQueue.sync,0,0);if(f===o.WAIT_FAILED)return a.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(f===o.TIMEOUT_EXPIRED)return;o.bindBuffer(o.PIXEL_PACK_BUFFER,this._pbo),o.getBufferSubData(o.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),o.bindBuffer(o.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),o.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=bf._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(o){let f=0;return f+=o[0]/256,f+=o[1]/65536,f+=o[2]/16777216,o[3]<127&&(f=-f),f/128}}const Dd=a.a3/128;function jf(w,o){const f=w.granularity!==void 0?Math.max(w.granularity,1):1,x=f+(w.generateBorders?2:0),b=f+(w.extendToNorthPole||w.generateBorders?1:0)+(w.extendToSouthPole||w.generateBorders?1:0),P=x+1,E=b+1,F=w.generateBorders?-1:0,B=w.generateBorders||w.extendToNorthPole?-1:0,W=f+(w.generateBorders?1:0),G=f+(w.generateBorders||w.extendToSouthPole?1:0),Y=P*E,Z=x*b*6,re=P*E>65536;if(re&&o==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const he=re||o==="32bit",je=new Int16Array(2*Y);let we=0;for(let Re=B;Re<=G;Re++)for(let Te=F;Te<=W;Te++){let Le=Te/f*a.a3;Te===-1&&(Le=-Dd),Te===f+1&&(Le=a.a3+Dd);let $e=Re/f*a.a3;Re===-1&&($e=w.extendToNorthPole?a.bk:-Dd),Re===f+1&&($e=w.extendToSouthPole?a.bl:a.a3+Dd),je[we++]=Le,je[we++]=$e}const Se=he?new Uint32Array(Z):new Uint16Array(Z);let Ee=0;for(let Re=0;Re<b;Re++)for(let Te=0;Te<x;Te++){const Le=Te+1+Re*P,$e=Te+(Re+1)*P,Ie=Te+1+(Re+1)*P;Se[Ee++]=Te+Re*P,Se[Ee++]=$e,Se[Ee++]=Le,Se[Ee++]=Le,Se[Ee++]=$e,Se[Ee++]=Ie}return{vertices:je.buffer.slice(0),indices:Se.buffer.slice(0),uses32bitIndices:he}}const wf=new a.aO({fill:new a.bm(128,2),line:new a.bm(512,0),tile:new a.bm(128,32),stencil:new a.bm(128,1),circle:3});class dp{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Ur.projectionGlobe}get vertexShaderPreludeCode(){return Ur.projectionMercator.vertexSource}get subdivisionGranularity(){return wf}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(o){this._errorMeasurement||(this._errorMeasurement=new bf(o));const f=a.W(this._errorQueryLatitudeDegrees),x=2*Math.atan(Math.exp(Math.PI-f*Math.PI*2))-.5*Math.PI,b=this._errorMeasurement.updateErrorLoop(f,x),P=k();b!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=b,this._errorMeasurementLastChangeTime=P);const E=Math.min(Math.max((P-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=a.bn(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,a.bo(E))}_getMeshKey(o){return`${o.granularity.toString(36)}_${o.generateBorders?"b":""}${o.extendToNorthPole?"n":""}${o.extendToSouthPole?"s":""}`}getMeshFromTileID(o,f,x,b,P){const E=(P==="stencil"?wf.stencil:wf.tile).getGranularityForZoomLevel(f.z);return this._getMesh(o,{granularity:E,generateBorders:x,extendToNorthPole:f.y===0&&b,extendToSouthPole:f.y===(1<<f.z)-1&&b})}_getMesh(o,f){const x=this._getMeshKey(f);if(x in this._tileMeshCache)return this._tileMeshCache[x];const b=function(P,E){const F=jf(E,"16bit"),B=a.aP.deserialize({arrayBuffer:F.vertices,length:F.vertices.byteLength/2/2}),W=a.aR.deserialize({arrayBuffer:F.indices,length:F.indices.byteLength/2/3});return new Md(P.createVertexBuffer(B,il.members),P.createIndexBuffer(W),a.aQ.simpleSegment(0,0,B.length,W.length))}(o,f);return this._tileMeshCache[x]=b,b}recalculate(o){}hasTransition(){const o=k();let f=!1;return f=f||(o-this._errorMeasurementLastChangeTime)/1e3<.7,f=f||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,f}setErrorQueryLatitudeDegrees(o){this._errorQueryLatitudeDegrees=o}}const hp=new a.r({type:new a.D(a.t.projection.type)});class Sf extends a.E{constructor(o){super(),this._transitionable=new a.x(hp,void 0),this.setProjection(o),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.G(0)),this._mercatorProjection=new Di,this._verticalPerspectiveProjection=new dp}get transitionState(){const o=this.properties.get("type");if(typeof o=="string"&&o==="mercator")return 0;if(typeof o=="string"&&o==="vertical-perspective")return 1;if(o instanceof a.bp){if(o.from==="vertical-perspective"&&o.to==="mercator")return 1-o.transition;if(o.from==="mercator"&&o.to==="vertical-perspective")return o.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(o){this._mercatorProjection.updateGPUdependent(o),this._verticalPerspectiveProjection.updateGPUdependent(o)}getMeshFromTileID(o,f,x,b,P){return this.currentProjection.getMeshFromTileID(o,f,x,b,P)}setProjection(o){this._transitionable.setValue("type",(o==null?void 0:o.type)||"mercator")}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}setErrorQueryLatitudeDegrees(o){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(o),this._mercatorProjection.setErrorQueryLatitudeDegrees(o)}}function Rd(w){const o=Nf(w.worldSize,w.center.lat);return 2*Math.PI*o}function Nc(w,o,f,x,b){const P=1/(1<<b),E=o/a.a3*P+x*P,F=a.br((w/a.a3*P+f*P)*Math.PI*2+Math.PI,2*Math.PI),B=2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI,W=Math.cos(B),G=new Float64Array(3);return G[0]=Math.sin(F)*W,G[1]=Math.sin(B),G[2]=Math.cos(F)*W,G}function pi(w){return function(o,f){const x=Math.cos(f),b=new Float64Array(3);return b[0]=Math.sin(o)*x,b[1]=Math.sin(f),b[2]=Math.cos(o)*x,b}(w.lng*Math.PI/180,w.lat*Math.PI/180)}function Nf(w,o){return w/(2*Math.PI)/Math.cos(o*Math.PI/180)}function aj(w){const o=Math.asin(w[1])/Math.PI*180,f=Math.sqrt(w[0]*w[0]+w[2]*w[2]);if(f>1e-6){const x=w[0]/f,b=Math.acos(w[2]/f),P=(x>0?b:-b)/Math.PI*180;return new a.U(a.V(P,-180,180),o)}return new a.U(0,o)}function fp(w){return Math.cos(w*Math.PI/180)}function Mn(w,o){const f=fp(w),x=fp(o);return a.ao(x/f)}function mp(w,o){const f=w.rotate(o.bearingInRadians),x=o.zoom+Mn(o.center.lat,0),b=a.bn(1/fp(o.center.lat),1/fp(Math.min(Math.abs(o.center.lat),60)),a.bq(x,7,3,0,1)),P=360/Rd({worldSize:o.worldSize,center:{lat:o.center.lat}});return new a.U(o.center.lng-f.x*P*b,a.ai(o.center.lat+f.y*P,-a.aj,a.aj))}function io(w){const o=.5*w,f=Math.sin(o),x=Math.cos(o);return Math.log(f+x)-Math.log(x-f)}function Pf(w,o,f,x){const b=w.lat+f*x;if(Math.abs(f)>1){const P=(Math.sign(w.lat+f)!==Math.sign(w.lat)?-Math.abs(w.lat):Math.abs(w.lat))*Math.PI/180,E=Math.abs(w.lat+f)*Math.PI/180,F=io(P+x*(E-P)),B=io(P),W=io(E);return new a.U(w.lng+o*((F-B)/(W-B)),b)}return new a.U(w.lng+o*x,b)}class oj{constructor(o){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=o}swapBuffers(){if(!this._hadAnyChanges)return;const o=this._cachePrevious;this._cachePrevious=this._cache,this._cache=o,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(o,f,x,b){const P=`${o.z}_${o.x}_${o.y}_${b!=null&&b.terrain?"t":""}`,E=this._cache.get(P);if(E)return E;const F=this._cachePrevious.get(P);if(F)return this._cache.set(P,F),F;const B=this._boundingVolumeFactory(o,f,x,b);return this._cache.set(P,B),this._hadAnyChanges=!0,B}}class mu{constructor(o,f,x,b){this.min=x,this.max=b,this.points=o,this.planes=f}static fromAabb(o,f){const x=[];for(let b=0;b<8;b++)x.push([1&~b?o[0]:f[0],(b>>1&1)==1?f[1]:o[1],(b>>2&1)==1?f[2]:o[2]]);return new mu(x,[[-1,0,0,f[0]],[1,0,0,-o[0]],[0,-1,0,f[1]],[0,1,0,-o[1]],[0,0,-1,f[2]],[0,0,1,-o[2]]],o,f)}static fromCenterSizeAngles(o,f,x){const b=a.bu([],x[0],x[1],x[2]),P=a.bv([],[f[0],0,0],b),E=a.bv([],[0,f[1],0],b),F=a.bv([],[0,0,f[2]],b),B=[...o],W=[...o];for(let Y=0;Y<8;Y++)for(let Z=0;Z<3;Z++){const re=o[Z]+P[Z]*(1&~Y?-1:1)+E[Z]*((Y>>1&1)==1?1:-1)+F[Z]*((Y>>2&1)==1?1:-1);B[Z]=Math.min(B[Z],re),W[Z]=Math.max(W[Z],re)}const G=[];for(let Y=0;Y<8;Y++){const Z=[...o];a.aV(Z,Z,a.aU([],P,1&~Y?-1:1)),a.aV(Z,Z,a.aU([],E,(Y>>1&1)==1?1:-1)),a.aV(Z,Z,a.aU([],F,(Y>>2&1)==1?1:-1)),G.push(Z)}return new mu(G,[[...P,-a.a_(P,G[0])],[...E,-a.a_(E,G[0])],[...F,-a.a_(F,G[0])],[-P[0],-P[1],-P[2],-a.a_(P,G[7])],[-E[0],-E[1],-E[2],-a.a_(E,G[7])],[-F[0],-F[1],-F[2],-a.a_(F,G[7])]],B,W)}intersectsFrustum(o){let f=!0;const x=this.points.length,b=this.planes.length,P=o.planes.length,E=o.points.length;for(let F=0;F<P;F++){const B=o.planes[F];let W=0;for(let G=0;G<x;G++){const Y=this.points[G];B[0]*Y[0]+B[1]*Y[1]+B[2]*Y[2]+B[3]>=0&&W++}if(W===0)return 0;W<x&&(f=!1)}if(f)return 2;for(let F=0;F<b;F++){const B=this.planes[F];let W=0;for(let G=0;G<E;G++){const Y=o.points[G];B[0]*Y[0]+B[1]*Y[1]+B[2]*Y[2]+B[3]>=0&&W++}if(W===0)return 0}return 1}intersectsPlane(o){const f=this.points.length;let x=0;for(let b=0;b<f;b++){const P=this.points[b];o[0]*P[0]+o[1]*P[1]+o[2]*P[2]+o[3]>=0&&x++}return x===f?2:x===0?0:1}}function Dl(w,o,f){const x=w-o;return x<0?-x:Math.max(0,x-f)}function tv(w,o,f,x,b){const P=w-f;let E;return E=P<0?Math.min(-P,1+P-b):P>1?Math.min(Math.max(P-b,0),1-P):0,Math.max(E,Dl(o,x,b))}class NP{constructor(){this._boundingVolumeCache=new oj(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(o,f,x,b){const P=1<<x.z,E=1/P,F=x.x/P,B=x.y/P;let W=2;return W=Math.min(W,tv(o,f,F,B,E)),W=Math.min(W,tv(o,f,F+.5,-B-E,E)),W=Math.min(W,tv(o,f,F+.5,2-B-E,E)),W}getWrap(o,f,x){const b=1<<f.z,P=1/b,E=f.x/b,F=Dl(o.x,E,P),B=Dl(o.x,E-1,P),W=Dl(o.x,E+1,P),G=Math.min(F,B,W);return G===W?1:G===B?-1:0}allowVariableZoom(o,f){return ln(o,f)>4}allowWorldCopies(){return!1}getTileBoundingVolume(o,f,x,b){return this._boundingVolumeCache.getTileBoundingVolume(o,f,x,b)}_computeTileBoundingVolume(o,f,x,b){var P,E;let F=0,B=0;if(b!=null&&b.terrain){const W=new a.a0(o.z,f,o.z,o.x,o.y),G=b.terrain.getMinMaxElevation(W);F=(P=G.minElevation)!==null&&P!==void 0?P:Math.min(0,x),B=(E=G.maxElevation)!==null&&E!==void 0?E:Math.max(0,x)}if(F/=a.bx,B/=a.bx,F+=1,B+=1,o.z<=0)return mu.fromAabb([-B,-B,-B],[B,B,B]);if(o.z===1)return mu.fromAabb([o.x===0?-B:0,o.y===0?0:-B,-B],[o.x===0?0:B,o.y===0?B:0,B]);{const W=[Nc(0,0,o.x,o.y,o.z),Nc(a.a3,0,o.x,o.y,o.z),Nc(a.a3,a.a3,o.x,o.y,o.z),Nc(0,a.a3,o.x,o.y,o.z)],G=[];for(const ot of W)G.push(a.aU([],ot,B));if(B!==F)for(const ot of W)G.push(a.aU([],ot,F));o.y===0&&G.push([0,1,0]),o.y===(1<<o.z)-1&&G.push([0,-1,0]);const Y=[1,1,1],Z=[-1,-1,-1];for(const ot of G)for(let dt=0;dt<3;dt++)Y[dt]=Math.min(Y[dt],ot[dt]),Z[dt]=Math.max(Z[dt],ot[dt]);const re=Nc(a.a3/2,a.a3/2,o.x,o.y,o.z),he=a.aZ([],[0,1,0],re);a.aY(he,he);const je=a.aZ([],re,he);a.aY(je,je);const we=a.aZ([],W[2],W[1]);a.aY(we,we);const Se=a.aZ([],W[0],W[3]);a.aY(Se,Se),G.push(a.aU([],re,B)),o.y>=(1<<o.z)/2&&G.push(a.aU([],Nc(a.a3/2,0,o.x,o.y,o.z),B)),o.y<(1<<o.z)/2&&G.push(a.aU([],Nc(a.a3/2,a.a3,o.x,o.y,o.z),B));const Ee=lj(re,G),Re=lj(je,G),Te=[-re[0],-re[1],-re[2],Ee.max],Le=[re[0],re[1],re[2],-Ee.min],$e=[-je[0],-je[1],-je[2],Re.max],Ie=[je[0],je[1],je[2],-Re.min],Ke=[...we,0],ut=[...Se,0],st=[];return o.y===0?st.push(a.bw(ut,Ke,Te),a.bw(ut,Ke,Le)):st.push(a.bw($e,Ke,Te),a.bw($e,Ke,Le),a.bw($e,ut,Te),a.bw($e,ut,Le)),o.y===(1<<o.z)-1?st.push(a.bw(ut,Ke,Te),a.bw(ut,Ke,Le)):st.push(a.bw(Ie,Ke,Te),a.bw(Ie,Ke,Le),a.bw(Ie,ut,Te),a.bw(Ie,ut,Le)),new mu(st,[Te,Le,$e,Ie,Ke,ut],Y,Z)}}}function lj(w,o){let f=1/0,x=-1/0;for(const b of o){const P=a.a_(w,b);f=Math.min(f,P),x=Math.max(x,P)}return{min:f,max:x}}class pp{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(o){this._helper.setMinZoom(o)}setMaxZoom(o){this._helper.setMaxZoom(o)}setMinPitch(o){this._helper.setMinPitch(o)}setMaxPitch(o){this._helper.setMaxPitch(o)}setRenderWorldCopies(o){this._helper.setRenderWorldCopies(o)}setBearing(o){this._helper.setBearing(o)}setPitch(o){this._helper.setPitch(o)}setRoll(o){this._helper.setRoll(o)}setFov(o){this._helper.setFov(o)}setZoom(o){this._helper.setZoom(o)}setCenter(o){this._helper.setCenter(o)}setElevation(o){this._helper.setElevation(o)}setMinElevationForCurrentTile(o){this._helper.setMinElevationForCurrentTile(o)}setPadding(o){this._helper.setPadding(o)}interpolatePadding(o,f,x){return this._helper.interpolatePadding(o,f,x)}isPaddingEqual(o){return this._helper.isPaddingEqual(o)}resize(o,f){this._helper.resize(o,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(o){this._helper.setMaxBounds(o)}setConstrain(o){this._helper.setConstrain(o)}overrideNearFarZ(o,f){this._helper.overrideNearFarZ(o,f)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(o){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),o)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrain(){return this._helper.constrain}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(o){}constructor(o){this._cachedClippingPlane=a.by(),this._projectionMatrix=a.bc(),this._globeViewProjMatrix32f=a.bb(),this._globeViewProjMatrixNoCorrection=a.bc(),this._globeViewProjMatrixNoCorrectionInverted=a.bc(),this._globeProjMatrixInverted=a.bc(),this._cameraPosition=a.bs(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(f,x)=>{const b=a.ai(f.lat,-a.aj,a.aj),P=a.ai(+x,this.minZoom+Mn(0,b),this.maxZoom);return{center:new a.U(f.lng,b),zoom:P}},this._helper=new Zi({calcMatrices:()=>{this._calcMatrices()},constrain:(f,x)=>this.defaultConstrain(f,x)},o),this._coveringTilesDetailsProvider=new NP}clone(){const o=new pp;return o.apply(this),o}apply(o,f){this._globeLatitudeErrorCorrectionRadians=f||0,this._helper.apply(o)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const o=a.bs();return o[0]=this._cameraPosition[0],o[1]=this._cameraPosition[1],o[2]=this._cameraPosition[2],o}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(o){const{overscaledTileID:f,applyGlobeMatrix:x}=o,b=this._helper.getMercatorTileCoordinates(f);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:b,clippingPlane:this._cachedClippingPlane,projectionTransition:x?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(o){const f=this.pitchInRadians,x=this.cameraToCenterDistance/o,b=Math.sin(f)*x,P=Math.cos(f)*x+1,E=1/Math.sqrt(b*b+P*P)*1;let F=-b,B=P;const W=Math.sqrt(F*F+B*B);F/=W,B/=W;const G=[0,F,B];a.bz(G,G,[0,0,0],-this.bearingInRadians),a.bA(G,G,[0,0,0],-1*this.center.lat*Math.PI/180),a.bB(G,G,[0,0,0],this.center.lng*Math.PI/180);const Y=1/a.b0(G);return a.aU(G,G,Y),[...G,-E*Y]}isLocationOccluded(o){return!this.isSurfacePointVisible(pi(o))}transformLightDirection(o){const f=this._helper._center.lng*Math.PI/180,x=this._helper._center.lat*Math.PI/180,b=Math.cos(x),P=[Math.sin(f)*b,Math.sin(x),Math.cos(f)*b],E=[P[2],0,-P[0]],F=[0,0,0];a.aZ(F,E,P),a.aY(E,E),a.aY(F,F);const B=[0,0,0];return a.aY(B,[E[0]*o[0]+F[0]*o[1]+P[0]*o[2],E[1]*o[0]+F[1]*o[1]+P[1]*o[2],E[2]*o[0]+F[2]*o[1]+P[2]*o[2]]),B}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(o,f,x){const b=function(F,B,W){const G=1/(1<<W.z);return new a.a5(F/a.a3*G+W.x*G,B/a.a3*G+W.y*G)}(o,f,x.canonical),P=(E=b.y,[a.br(b.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI]);var E;return this.getCircleRadiusCorrection()/Math.cos(P[1])}projectTileCoordinates(o,f,x,b){const P=x.canonical,E=Nc(o,f,P.x,P.y,P.z),F=1+(b?b(o,f):0)/a.bx,B=[E[0]*F,E[1]*F,E[2]*F,1];a.aA(B,B,this._globeViewProjMatrixNoCorrection);const W=this._cachedClippingPlane,G=W[0]*E[0]+W[1]*E[1]+W[2]*E[2]+W[3]<0;return{point:new a.P(B[0]/B[3],B[1]/B[3]),signedDistanceFromCamera:B[3],isOccluded:G}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const o=Nf(this.worldSize,this.center.lat),f=a.bd(),x=a.bd();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*o),a.b7(f,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const b=this.centerOffset;f[8]=2*-b.x/this._helper._width,f[9]=2*b.y/this._helper._height,this._projectionMatrix=a.b8(f),this._globeProjMatrixInverted=a.bd(),a.au(this._globeProjMatrixInverted,f),a.N(f,f,[0,0,-this.cameraToCenterDistance]),a.b9(f,f,this.rollInRadians),a.ba(f,f,-this.pitchInRadians),a.b9(f,f,this.bearingInRadians),a.N(f,f,[0,0,-o]);const P=a.bs();P[0]=o,P[1]=o,P[2]=o,a.ba(x,f,this.center.lat*Math.PI/180),a.bC(x,x,-this.center.lng*Math.PI/180),a.O(x,x,P),this._globeViewProjMatrixNoCorrection=x,a.ba(f,f,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),a.bC(f,f,-this.center.lng*Math.PI/180),a.O(f,f,P),this._globeViewProjMatrix32f=new Float32Array(f),this._globeViewProjMatrixNoCorrectionInverted=a.bd(),a.au(this._globeViewProjMatrixNoCorrectionInverted,x);const E=a.bs();this._cameraPosition=a.bs(),this._cameraPosition[2]=this.cameraToCenterDistance/o,a.bz(this._cameraPosition,this._cameraPosition,E,-this.rollInRadians),a.bA(this._cameraPosition,this._cameraPosition,E,this.pitchInRadians),a.bz(this._cameraPosition,this._cameraPosition,E,-this.bearingInRadians),a.aV(this._cameraPosition,this._cameraPosition,[0,0,1]),a.bA(this._cameraPosition,this._cameraPosition,E,-this.center.lat*Math.PI/180),a.bB(this._cameraPosition,this._cameraPosition,E,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(o);const F=a.b8(this._globeViewProjMatrixNoCorrectionInverted);a.O(F,F,[1,1,-1]),this._cachedFrustum=_f.fromInvProjectionMatrix(F,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(o){a.w("calculateFogMatrix is not supported on globe projection.");const f=a.bd();return a.am(f),f}getVisibleUnwrappedCoordinates(o){return[new a.b5(0,o)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(o){o&&a.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(o,f){if(!this._globeViewProjMatrixNoCorrection)return 1;const x=pi(o);a.aU(x,x,1+f/a.bx);const b=a.by();return a.aA(b,[x[0],x[1],x[2],1],this._globeViewProjMatrixNoCorrection),b[2]/b[3]}populateCache(o){}getBounds(){const o=.5*this.width,f=.5*this.height,x=[new a.P(0,0),new a.P(o,0),new a.P(this.width,0),new a.P(this.width,f),new a.P(this.width,this.height),new a.P(o,this.height),new a.P(0,this.height),new a.P(0,f)],b=[];for(const Y of x)b.push(this.unprojectScreenPoint(Y));let P=0,E=0,F=0,B=0;const W=this.center;for(const Y of b){const Z=a.bD(W.lng,Y.lng),re=a.bD(W.lat,Y.lat);Z<E&&(E=Z),Z>P&&(P=Z),re<B&&(B=re),re>F&&(F=re)}const G=[W.lng+E,W.lat+B,W.lng+P,W.lat+F];return this.isSurfacePointOnScreen([0,1,0])&&(G[3]=90,G[0]=-180,G[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(G[1]=-90,G[0]=-180,G[2]=180),new Lr(G)}calculateCenterFromCameraLngLatAlt(o,f,x,b){return this._helper.calculateCenterFromCameraLngLatAlt(o,f,x,b)}setLocationAtPoint(o,f){const x=pi(this.unprojectScreenPoint(f)),b=pi(o),P=a.bs();a.bE(P);const E=a.bs();a.bB(E,x,P,-this.center.lng*Math.PI/180),a.bA(E,E,P,this.center.lat*Math.PI/180);const F=b[0]*b[0]+b[2]*b[2],B=E[0]*E[0];if(F<B)return;const W=Math.sqrt(F-B),G=-W,Y=a.bF(b[0],b[2],E[0],W),Z=a.bF(b[0],b[2],E[0],G),re=a.bs();a.bB(re,b,P,-Y);const he=a.bF(re[1],re[2],E[1],E[2]),je=a.bs();a.bB(je,b,P,-Z);const we=a.bF(je[1],je[2],E[1],E[2]),Se=.5*Math.PI,Ee=he>=-Se&&he<=Se,Re=we>=-Se&&we<=Se;let Te,Le;if(Ee&&Re){const ut=this.center.lng*Math.PI/180,st=this.center.lat*Math.PI/180;a.bG(Y,ut)+a.bG(he,st)<a.bG(Z,ut)+a.bG(we,st)?(Te=Y,Le=he):(Te=Z,Le=we)}else if(Ee)Te=Y,Le=he;else{if(!Re)return;Te=Z,Le=we}const $e=Te/Math.PI*180,Ie=Le/Math.PI*180,Ke=this.center.lat;this.setCenter(new a.U($e,a.ai(Ie,-90,90))),this.setZoom(this.zoom+Mn(Ke,this.center.lat))}locationToScreenPoint(o,f){const x=pi(o);if(f){const b=f.getElevationForLngLatZoom(o,this._helper._tileZoom);a.aU(x,x,1+b/a.bx)}return this._projectSurfacePointToScreen(x)}_projectSurfacePointToScreen(o){const f=a.by();return a.aA(f,[...o,1],this._globeViewProjMatrixNoCorrection),f[0]/=f[3],f[1]/=f[3],new a.P((.5*f[0]+.5)*this.width,(.5*-f[1]+.5)*this.height)}screenPointToMercatorCoordinate(o,f){if(f){const x=f.pointCoordinate(o);if(x)return x}return a.a5.fromLngLat(this.unprojectScreenPoint(o))}screenPointToLocation(o,f){var x;return(x=this.screenPointToMercatorCoordinate(o,f))===null||x===void 0?void 0:x.toLngLat()}isPointOnMapSurface(o,f){const x=this._cameraPosition,b=this.getRayDirectionFromPixel(o);return!!this.rayPlanetIntersection(x,b)}getRayDirectionFromPixel(o){const f=a.by();f[0]=o.x/this.width*2-1,f[1]=-1*(o.y/this.height*2-1),f[2]=1,f[3]=1,a.aA(f,f,this._globeViewProjMatrixNoCorrectionInverted),f[0]/=f[3],f[1]/=f[3],f[2]/=f[3];const x=a.bs();x[0]=f[0]-this._cameraPosition[0],x[1]=f[1]-this._cameraPosition[1],x[2]=f[2]-this._cameraPosition[2];const b=a.bs();return a.aY(b,x),b}isSurfacePointVisible(o){const f=this._cachedClippingPlane;return f[0]*o[0]+f[1]*o[1]+f[2]*o[2]+f[3]>=0}isSurfacePointOnScreen(o){if(!this.isSurfacePointVisible(o))return!1;const f=a.by();return a.aA(f,[...o,1],this._globeViewProjMatrixNoCorrection),f[0]/=f[3],f[1]/=f[3],f[2]/=f[3],f[0]>-1&&f[0]<1&&f[1]>-1&&f[1]<1&&f[2]>-1&&f[2]<1}rayPlanetIntersection(o,f){const x=a.a_(o,f),b=a.bs(),P=a.bs();a.aU(P,f,x),a.aX(b,o,P);const E=1-a.a_(b,b);if(E<0)return null;const F=a.a_(o,o)-1,B=-x+(x<0?1:-1)*Math.sqrt(E),W=F/B,G=B;return{tMin:Math.min(W,G),tMax:Math.max(W,G)}}unprojectScreenPoint(o){const f=this._cameraPosition,x=this.getRayDirectionFromPixel(o),b=this.rayPlanetIntersection(f,x);if(b){const G=a.bs();a.aV(G,f,[x[0]*b.tMin,x[1]*b.tMin,x[2]*b.tMin]);const Y=a.bs();return a.aY(Y,G),aj(Y)}const P=this._cachedClippingPlane,E=P[0]*x[0]+P[1]*x[1]+P[2]*x[2],F=-a.b4(P,f)/E,B=a.bs();if(F>0)a.aV(B,f,[x[0]*F,x[1]*F,x[2]*F]);else{const G=a.bs();a.aV(G,f,[2*x[0],2*x[1],2*x[2]]);const Y=a.b4(this._cachedClippingPlane,G);a.aX(B,G,[this._cachedClippingPlane[0]*Y,this._cachedClippingPlane[1]*Y,this._cachedClippingPlane[2]*Y])}const W=function(G){const Y=a.bs();return Y[0]=G[0]*-G[3],Y[1]=G[1]*-G[3],Y[2]=G[2]*-G[3],{center:Y,radius:Math.sqrt(1-G[3]*G[3])}}(P);return aj(function(G,Y,Z){const re=a.bs();a.aX(re,Z,G);const he=a.bs();return a.bt(he,G,re,Y/a.b2(re)),he}(W.center,W.radius,B))}getMatrixForModel(o,f){const x=a.U.convert(o),b=1/a.bx,P=a.bc();return a.bC(P,P,x.lng/180*Math.PI),a.ba(P,P,-x.lat/180*Math.PI),a.N(P,P,[0,0,1+f/a.bx]),a.ba(P,P,.5*Math.PI),a.O(P,P,[b,b,b]),P}getProjectionDataForCustomLayer(o=!0){const f=this.getProjectionData({overscaledTileID:new a.a0(0,0,0,0,0),applyGlobeMatrix:o});return f.tileMercatorCoords=[0,0,1,1],f}getFastPathSimpleProjectionMatrix(o){}}class gp{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(o){this._helper.setMinZoom(o)}setMaxZoom(o){this._helper.setMaxZoom(o)}setMinPitch(o){this._helper.setMinPitch(o)}setMaxPitch(o){this._helper.setMaxPitch(o)}setRenderWorldCopies(o){this._helper.setRenderWorldCopies(o)}setBearing(o){this._helper.setBearing(o)}setPitch(o){this._helper.setPitch(o)}setRoll(o){this._helper.setRoll(o)}setFov(o){this._helper.setFov(o)}setZoom(o){this._helper.setZoom(o)}setCenter(o){this._helper.setCenter(o)}setElevation(o){this._helper.setElevation(o)}setMinElevationForCurrentTile(o){this._helper.setMinElevationForCurrentTile(o)}setPadding(o){this._helper.setPadding(o)}interpolatePadding(o,f,x){return this._helper.interpolatePadding(o,f,x)}isPaddingEqual(o){return this._helper.isPaddingEqual(o)}resize(o,f,x=!0){this._helper.resize(o,f,x)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(o){this._helper.setMaxBounds(o)}setConstrain(o){this._helper.setConstrain(o)}overrideNearFarZ(o,f){this._helper.overrideNearFarZ(o,f)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(o){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),o)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrain(){return this._helper.constrain}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(o,f){this._globeness=o,this._globeLatitudeErrorCorrectionRadians=f,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(o){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(f,x)=>this.currentTransform.defaultConstrain(f,x),this._helper=new Zi({calcMatrices:()=>{this._calcMatrices()},constrain:(f,x)=>this.defaultConstrain(f,x)},o),this._globeness=1,this._mercatorTransform=new al,this._verticalPerspectiveTransform=new pp}clone(){const o=new gp;return o._globeness=this._globeness,o._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,o.apply(this),o}apply(o){this._helper.apply(o),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(o){const f=this._mercatorTransform.getProjectionData(o),x=this._verticalPerspectiveTransform.getProjectionData(o);return{mainMatrix:this.isGlobeRendering?x.mainMatrix:f.mainMatrix,clippingPlane:x.clippingPlane,tileMercatorCoords:x.tileMercatorCoords,projectionTransition:o.applyGlobeMatrix?this._globeness:0,fallbackMatrix:f.fallbackMatrix}}isLocationOccluded(o){return this.currentTransform.isLocationOccluded(o)}transformLightDirection(o){return this.currentTransform.transformLightDirection(o)}getPixelScale(){return a.bn(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return a.bn(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(o,f,x){const b=this._mercatorTransform.getPitchedTextCorrection(o,f,x),P=this._verticalPerspectiveTransform.getPitchedTextCorrection(o,f,x);return a.bn(b,P,this._globeness)}projectTileCoordinates(o,f,x,b){return this.currentTransform.projectTileCoordinates(o,f,x,b)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(o){return this.currentTransform.calculateFogMatrix(o)}getVisibleUnwrappedCoordinates(o){return this.currentTransform.getVisibleUnwrappedCoordinates(o)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(o){this._mercatorTransform.recalculateZoomAndCenter(o),this._verticalPerspectiveTransform.recalculateZoomAndCenter(o)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(o,f){return this.currentTransform.lngLatToCameraDepth(o,f)}populateCache(o){this._mercatorTransform.populateCache(o),this._verticalPerspectiveTransform.populateCache(o)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(o,f,x,b){return this._helper.calculateCenterFromCameraLngLatAlt(o,f,x,b)}setLocationAtPoint(o,f){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(o,f),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(o,f),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(o,f){return this.currentTransform.locationToScreenPoint(o,f)}screenPointToMercatorCoordinate(o,f){return this.currentTransform.screenPointToMercatorCoordinate(o,f)}screenPointToLocation(o,f){return this.currentTransform.screenPointToLocation(o,f)}isPointOnMapSurface(o,f){return this.currentTransform.isPointOnMapSurface(o,f)}getRayDirectionFromPixel(o){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(o)}getMatrixForModel(o,f){return this.currentTransform.getMatrixForModel(o,f)}getProjectionDataForCustomLayer(o=!0){const f=this._mercatorTransform.getProjectionDataForCustomLayer(o);if(!this.isGlobeRendering)return f;const x=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(o);return x.fallbackMatrix=f.mainMatrix,x}getFastPathSimpleProjectionMatrix(o){return this.currentTransform.getFastPathSimpleProjectionMatrix(o)}}class Co{get useGlobeControls(){return!0}handlePanInertia(o,f){const x=mp(o,f);return Math.abs(x.lng-f.center.lng)>180&&(x.lng=f.center.lng+179.5*Math.sign(x.lng-f.center.lng)),{easingCenter:x,easingOffset:new a.P(0,0)}}handleMapControlsRollPitchBearingZoom(o,f){const x=o.around,b=f.screenPointToLocation(x);o.bearingDelta&&f.setBearing(f.bearing+o.bearingDelta),o.pitchDelta&&f.setPitch(f.pitch+o.pitchDelta),o.rollDelta&&f.setRoll(f.roll+o.rollDelta);const P=f.zoom;o.zoomDelta&&f.setZoom(f.zoom+o.zoomDelta);const E=f.zoom-P;if(E===0)return;const F=a.bD(f.center.lng,b.lng),B=F/(Math.abs(F/180)+1),W=a.bD(f.center.lat,b.lat),G=f.getRayDirectionFromPixel(x),Y=f.cameraPosition,Z=-1*a.a_(Y,G),re=a.bs();a.aV(re,Y,[G[0]*Z,G[1]*Z,G[2]*Z]);const he=a.b0(re)-1,je=Math.exp(.5*-Math.max(he-.3,0)),we=Nf(f.worldSize,f.center.lat)/Math.min(f.width,f.height),Se=a.bq(we,.9,.5,1,.25),Ee=(1-a.al(-E))*Math.min(je,Se),Re=f.center.lat,Te=f.zoom,Le=new a.U(f.center.lng+B*Ee,a.ai(f.center.lat+W*Ee,-a.aj,a.aj));f.setLocationAtPoint(b,x);const $e=f.center,Ie=a.bq(Math.abs(F),45,85,0,1),Ke=a.bq(we,.75,.35,0,1),ut=Math.pow(Math.max(Ie,Ke),.25),st=a.bD($e.lng,Le.lng),ot=a.bD($e.lat,Le.lat);f.setCenter(new a.U($e.lng+st*ut,$e.lat+ot*ut).wrap()),f.setZoom(Te+Mn(Re,f.center.lat))}handleMapControlsPan(o,f,x){if(!o.panDelta)return;const b=f.center.lat,P=f.zoom;f.setCenter(mp(o.panDelta,f).wrap()),f.setZoom(P+Mn(b,f.center.lat))}cameraForBoxAndBearing(o,f,x,b,P){const E=Sc(o,f,x,b,P),F=f.left/P.width*2-1,B=(P.width-f.right)/P.width*2-1,W=f.top/P.height*-2+1,G=(P.height-f.bottom)/P.height*-2+1,Y=a.bD(x.getWest(),x.getEast())<0,Z=Y?x.getEast():x.getWest(),re=Y?x.getWest():x.getEast(),he=Math.max(x.getNorth(),x.getSouth()),je=Math.min(x.getNorth(),x.getSouth()),we=Z+.5*a.bD(Z,re),Se=he+.5*a.bD(he,je),Ee=P.clone();Ee.setCenter(E.center),Ee.setBearing(E.bearing),Ee.setPitch(0),Ee.setRoll(0),Ee.setZoom(E.zoom);const Re=Ee.modelViewProjectionMatrix,Te=[pi(x.getNorthWest()),pi(x.getNorthEast()),pi(x.getSouthWest()),pi(x.getSouthEast()),pi(new a.U(re,Se)),pi(new a.U(Z,Se)),pi(new a.U(we,he)),pi(new a.U(we,je))],Le=pi(E.center);let $e=Number.POSITIVE_INFINITY;for(const Ie of Te)F<0&&($e=Co.getLesserNonNegativeNonNull($e,Co.solveVectorScale(Ie,Le,Re,"x",F))),B>0&&($e=Co.getLesserNonNegativeNonNull($e,Co.solveVectorScale(Ie,Le,Re,"x",B))),W>0&&($e=Co.getLesserNonNegativeNonNull($e,Co.solveVectorScale(Ie,Le,Re,"y",W))),G<0&&($e=Co.getLesserNonNegativeNonNull($e,Co.solveVectorScale(Ie,Le,Re,"y",G)));if(Number.isFinite($e)&&$e!==0)return E.zoom=Ee.zoom+a.ao($e),E;Es()}handleJumpToCenterZoom(o,f){const x=o.center.lat,b=o.constrain(f.center?a.U.convert(f.center):o.center,o.zoom).center;o.setCenter(b.wrap());const P=f.zoom!==void 0?+f.zoom:o.zoom+Mn(x,b.lat);o.zoom!==P&&o.setZoom(P)}handleEaseTo(o,f){const x=o.zoom,b=o.center,P=o.padding,E={roll:o.roll,pitch:o.pitch,bearing:o.bearing},F={roll:f.roll===void 0?o.roll:f.roll,pitch:f.pitch===void 0?o.pitch:f.pitch,bearing:f.bearing===void 0?o.bearing:f.bearing},B=f.zoom!==void 0,W=!o.isPaddingEqual(f.padding);let G=!1;const Y=f.center?a.U.convert(f.center):b,Z=o.constrain(Y,x).center;Qn(o,Z);const re=o.clone();re.setCenter(Z),re.setZoom(B?+f.zoom:x+Mn(b.lat,Y.lat)),re.setBearing(f.bearing);const he=new a.P(a.ai(o.centerPoint.x+f.offsetAsPoint.x,0,o.width),a.ai(o.centerPoint.y+f.offsetAsPoint.y,0,o.height));re.setLocationAtPoint(Z,he);const je=(f.offset&&f.offsetAsPoint.mag())>0?re.center:Z,we=B?+f.zoom:x+Mn(b.lat,je.lat),Se=x+Mn(b.lat,0),Ee=we+Mn(je.lat,0),Re=a.bD(b.lng,je.lng),Te=a.bD(b.lat,je.lat),Le=a.al(Ee-Se);return G=we!==x,{easeFunc:$e=>{if(a.bh(E,F)||Od({startEulerAngles:E,endEulerAngles:F,tr:o,k:$e,useSlerp:E.roll!=F.roll}),W&&o.interpolatePadding(P,f.padding,$e),f.around)a.w("Easing around a point is not supported under globe projection."),o.setLocationAtPoint(f.around,f.aroundPoint);else{const Ie=Ee>Se?Math.min(2,Le):Math.max(.5,Le),Ke=Math.pow(Ie,1-$e),ut=Pf(b,Re,Te,$e*Ke);o.setCenter(ut.wrap())}if(G){const Ie=a.F.number(Se,Ee,$e)+Mn(0,o.center.lat);o.setZoom(Ie)}},isZooming:G,elevationCenter:je}}handleFlyTo(o,f){const x=f.zoom!==void 0,b=o.center,P=o.zoom,E=o.padding,F=!o.isPaddingEqual(f.padding),B=o.constrain(a.U.convert(f.center||f.locationAtOffset),P).center,W=x?+f.zoom:o.zoom+Mn(o.center.lat,B.lat),G=o.clone();G.setCenter(B),G.setZoom(W),G.setBearing(f.bearing);const Y=new a.P(a.ai(o.centerPoint.x+f.offsetAsPoint.x,0,o.width),a.ai(o.centerPoint.y+f.offsetAsPoint.y,0,o.height));G.setLocationAtPoint(B,Y);const Z=G.center;Qn(o,Z);const re=function(Te,Le,$e){const Ie=pi(Le),Ke=pi($e),ut=a.a_(Ie,Ke),st=Math.acos(ut),ot=Rd(Te);return st/(2*Math.PI)*ot}(o,b,Z),he=P+Mn(b.lat,0),je=W+Mn(Z.lat,0),we=a.al(je-he);let Se;if(typeof f.minZoom=="number"){const Te=+f.minZoom+Mn(Z.lat,0),Le=Math.min(Te,he,je)+Mn(0,Z.lat),$e=o.constrain(Z,Le).zoom+Mn(Z.lat,0);Se=a.al($e-he)}const Ee=a.bD(b.lng,Z.lng),Re=a.bD(b.lat,Z.lat);return{easeFunc:(Te,Le,$e,Ie)=>{const Ke=Pf(b,Ee,Re,$e);F&&o.interpolatePadding(E,f.padding,Te);const ut=Te===1?Z:Ke;o.setCenter(ut.wrap());const st=he+a.ao(Le);o.setZoom(Te===1?W:st+Mn(0,ut.lat))},scaleOfZoom:we,targetCenter:Z,scaleOfMinZoom:Se,pixelPathLength:re}}static solveVectorScale(o,f,x,b,P){const E=b==="x"?[x[0],x[4],x[8],x[12]]:[x[1],x[5],x[9],x[13]],F=[x[3],x[7],x[11],x[15]],B=o[0]*E[0]+o[1]*E[1]+o[2]*E[2],W=o[0]*F[0]+o[1]*F[1]+o[2]*F[2],G=f[0]*E[0]+f[1]*E[1]+f[2]*E[2],Y=f[0]*F[0]+f[1]*F[1]+f[2]*F[2];return G+P*W===B+P*Y||F[3]*(B-G)+E[3]*(Y-W)+B*Y==G*W?null:(G+E[3]-P*Y-P*F[3])/(G-B-P*Y+P*W)}static getLesserNonNegativeNonNull(o,f){return f!==null&&f>=0&&f<o?f:o}}class Cf{constructor(o){this._globe=o,this._mercatorCameraHelper=new fu,this._verticalPerspectiveCameraHelper=new Co}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(o,f){return this.currentHelper.handlePanInertia(o,f)}handleMapControlsRollPitchBearingZoom(o,f){return this.currentHelper.handleMapControlsRollPitchBearingZoom(o,f)}handleMapControlsPan(o,f,x){this.currentHelper.handleMapControlsPan(o,f,x)}cameraForBoxAndBearing(o,f,x,b,P){return this.currentHelper.cameraForBoxAndBearing(o,f,x,b,P)}handleJumpToCenterZoom(o,f){this.currentHelper.handleJumpToCenterZoom(o,f)}handleEaseTo(o,f){return this.currentHelper.handleEaseTo(o,f)}handleFlyTo(o,f){return this.currentHelper.handleFlyTo(o,f)}}const Ld=(w,o)=>a.z(w,o&&o.filter(f=>f.identifier!=="source.canvas")),xp=a.bH();class Af extends a.E{constructor(o,f={}){var x,b;super(),this._rtlPluginLoaded=()=>{for(const E in this.tileManagers){const F=this.tileManagers[E].getSource().type;F!=="vector"&&F!=="geojson"||this.tileManagers[E].reload()}},this.map=o,this.dispatcher=new Nt(yr(),o._getMapId()),this.dispatcher.registerMessageHandler("GG",(E,F)=>this.getGlyphs(E,F)),this.dispatcher.registerMessageHandler("GI",(E,F)=>this.getImages(E,F)),this.dispatcher.registerMessageHandler("GDA",(E,F)=>this.getDashes(E,F)),this.imageManager=new ae,this.imageManager.setEventedParent(this);const P=((x=o._container)===null||x===void 0?void 0:x.lang)||typeof document<"u"&&((b=document.documentElement)===null||b===void 0?void 0:b.lang)||void 0;this.glyphManager=new Ve(o._requestManager,f.localIdeographFontFamily,P),this.lineAtlas=new gt(256,512),this.crossTileSymbolIndex=new Il,this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new a.bI,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",a.bJ()),ue().on(ks,this._rtlPluginLoaded),this.on("data",E=>{if(E.dataType!=="source"||E.sourceDataType!=="metadata")return;const F=this.tileManagers[E.sourceId];if(!F)return;const B=F.getSource();if(B&&B.vectorLayerIds)for(const W in this._layers){const G=this._layers[W];G.source===B.id&&this._validateLayer(G)}})}setGlobalStateProperty(o,f){var x,b,P;this._checkLoaded();const E=f===null?(P=(b=(x=this.stylesheet.state)===null||x===void 0?void 0:x[o])===null||b===void 0?void 0:b.default)!==null&&P!==void 0?P:null:f;if(a.bK(E,this._globalState[o]))return this;this._globalState[o]=E,this._applyGlobalStateChanges([o])}getGlobalState(){return this._globalState}setGlobalState(o){this._checkLoaded();const f=[];for(const x in o)!a.bK(this._globalState[x],o[x].default)&&(f.push(x),this._globalState[x]=o[x].default);this._applyGlobalStateChanges(f)}_applyGlobalStateChanges(o){if(o.length===0)return;const f=new Set,x={};for(const b of o){x[b]=this._globalState[b];for(const P in this._layers){const E=this._layers[P],F=E.getLayoutAffectingGlobalStateRefs(),B=E.getPaintAffectingGlobalStateRefs();if(F.has(b)&&f.add(E.source),B.has(b))for(const{name:W,value:G}of B.get(b))this._updatePaintProperty(E,W,G)}}this.dispatcher.broadcast("UGS",x);for(const b in this.tileManagers)f.has(b)&&(this._reloadSource(b),this._changed=!0)}loadURL(o,f={},x){this.fire(new a.l("dataloading",{dataType:"style"})),f.validate=typeof f.validate!="boolean"||f.validate;const b=this.map._requestManager.transformRequest(o,"Style");this._loadStyleRequest=new AbortController;const P=this._loadStyleRequest;a.j(b,this._loadStyleRequest).then(E=>{this._loadStyleRequest=null,this._load(E.data,f,x)}).catch(E=>{this._loadStyleRequest=null,E&&!P.signal.aborted&&this.fire(new a.k(E))})}loadJSON(o,f={},x){this.fire(new a.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,j.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,f.validate=f.validate!==!1,this._load(o,f,x)}).catch(()=>{})}loadEmpty(){this.fire(new a.l("dataloading",{dataType:"style"})),this._load(xp,{validate:!1})}_load(o,f,x){var b,P;let E=f.transformStyle?f.transformStyle(x,o):o;if(!f.validate||!Ld(this,a.B(E))){E=Object.assign({},E),this._loaded=!0,this.stylesheet=E;for(const F in E.sources)this.addSource(F,E.sources[F],{validate:!1});E.sprite?this._loadSprite(E.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(E.glyphs),this._createLayers(),this.light=new _e(this.stylesheet.light),this._setProjectionInternal(((b=this.stylesheet.projection)===null||b===void 0?void 0:b.type)||"mercator"),this.sky=new vt(this.stylesheet.sky),this.map.setTerrain((P=this.stylesheet.terrain)!==null&&P!==void 0?P:null),this.fire(new a.l("data",{dataType:"style"})),this.fire(new a.l("style.load"))}}_createLayers(){var o,f,x;const b=a.bL(this.stylesheet.layers);this.setGlobalState((o=this.stylesheet.state)!==null&&o!==void 0?o:null),this.dispatcher.broadcast("SL",b),this._order=b.map(P=>P.id),this._layers={},this._serializedLayers=null;for(const P of b){const E=a.bM(P,this._globalState);if(E.setEventedParent(this,{layer:{id:P.id}}),this._layers[P.id]=E,a.bN(E)&&this.tileManagers[E.source]){const F=(x=(f=P.paint)===null||f===void 0?void 0:f["raster-fade-duration"])!==null&&x!==void 0?x:E.paint.get("raster-fade-duration");this.tileManagers[E.source].setRasterFadeDuration(F)}}}_loadSprite(o,f=!1,x=void 0){let b;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(P,E,F,B){return a._(this,void 0,void 0,function*(){const W=te(P),G=F>1?"@2x":"",Y={},Z={};for(const{id:re,url:he}of W){const je=E.transformRequest(X(he,G,".json"),"SpriteJSON");Y[re]=a.j(je,B);const we=E.transformRequest(X(he,G,".png"),"SpriteImage");Z[re]=V.getImage(we,B)}return yield Promise.all([...Object.values(Y),...Object.values(Z)]),function(re,he){return a._(this,void 0,void 0,function*(){const je={};for(const we in re){je[we]={};const Se=j.getImageCanvasContext((yield he[we]).data),Ee=(yield re[we]).data;for(const Re in Ee){const{width:Te,height:Le,x:$e,y:Ie,sdf:Ke,pixelRatio:ut,stretchX:st,stretchY:ot,content:dt,textFitWidth:kt,textFitHeight:Et}=Ee[Re];je[we][Re]={data:null,pixelRatio:ut,sdf:Ke,stretchX:st,stretchY:ot,content:dt,textFitWidth:kt,textFitHeight:Et,spriteData:{width:Te,height:Le,x:$e,y:Ie,context:Se}}}}return je})}(Y,Z)})}(o,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(P=>{if(this._spriteRequest=null,P)for(const E in P){this._spritesImagesIds[E]=[];const F=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter(B=>!(B in P)):[];for(const B of F)this.imageManager.removeImage(B),this._changedImages[B]=!0;for(const B in P[E]){const W=E==="default"?B:`${E}:${B}`;this._spritesImagesIds[E].push(W),W in this.imageManager.images?this.imageManager.updateImage(W,P[E][B],!1):this.imageManager.addImage(W,P[E][B]),f&&(this._changedImages[W]=!0)}}}).catch(P=>{this._spriteRequest=null,b=P,this.fire(new a.k(b))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),f&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"})),x&&x(b)})}_unloadSprite(){for(const o of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(o),this._changedImages[o]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}_validateLayer(o){const f=this.tileManagers[o.source];if(!f)return;const x=o.sourceLayer;if(!x)return;const b=f.getSource();(b.type==="geojson"||b.vectorLayerIds&&b.vectorLayerIds.indexOf(x)===-1)&&this.fire(new a.k(new Error(`Source layer "${x}" does not exist on source "${b.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.tileManagers)if(!this.tileManagers[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(o,f=!1){const x=this._serializedAllLayers();if(!o||o.length===0)return Object.values(f?a.bO(x):x);const b=[];for(const P of o)if(x[P]){const E=f?a.bO(x[P]):x[P];b.push(E)}return b}_serializedAllLayers(){let o=this._serializedLayers;if(o)return o;o=this._serializedLayers={};const f=Object.keys(this._layers);for(const x of f){const b=this._layers[x];b.type!=="custom"&&(o[x]=b.serialize())}return o}hasTransitions(){var o,f,x;if(!((o=this.light)===null||o===void 0)&&o.hasTransition()||!((f=this.sky)===null||f===void 0)&&f.hasTransition()||!((x=this.projection)===null||x===void 0)&&x.hasTransition())return!0;for(const b in this.tileManagers)if(this.tileManagers[b].hasTransition())return!0;for(const b in this._layers)if(this._layers[b].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const f=this._changed;if(f){const b=Object.keys(this._updatedLayers),P=Object.keys(this._removedLayers);(b.length||P.length)&&this._updateWorkerLayers(b,P);for(const E in this._updatedSources){const F=this._updatedSources[E];if(F==="reload")this._reloadSource(E);else{if(F!=="clear")throw new Error(`Invalid action ${F}`);this._clearSource(E)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(o);this.light.updateTransitions(o),this.sky.updateTransitions(o),this._resetUpdates()}const x={};for(const b in this.tileManagers){const P=this.tileManagers[b];x[b]=P.used,P.used=!1}for(const b of this._order){const P=this._layers[b];P.recalculate(o,this._availableImages),!P.isHidden(o.zoom)&&P.source&&(this.tileManagers[P.source].used=!0)}for(const b in x){const P=this.tileManagers[b];!!x[b]!=!!P.used&&P.fire(new a.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:b}))}this.light.recalculate(o),this.sky.recalculate(o),this.projection.recalculate(o),this.z=o.zoom,f&&this.fire(new a.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const f in this.tileManagers)this.tileManagers[f].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const o in this.tileManagers)this.tileManagers[o].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(o,f){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(o,!1),removedIds:f})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(o,f={}){var x;this._checkLoaded();const b=this.serialize();if(o=f.transformStyle?f.transformStyle(b,o):o,((x=f.validate)===null||x===void 0||x)&&Ld(this,a.B(o)))return!1;(o=a.bO(o)).layers=a.bL(o.layers);const P=a.bP(b,o),E=this._getOperationsToPerform(P);if(E.unimplemented.length>0)throw new Error(`Unimplemented: ${E.unimplemented.join(", ")}.`);if(E.operations.length===0)return!1;for(const F of E.operations)F();return this.stylesheet=o,this._serializedLayers=null,!0}_getOperationsToPerform(o){const f=[],x=[];for(const b of o)switch(b.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":f.push(()=>this.addLayer.apply(this,b.args));break;case"removeLayer":f.push(()=>this.removeLayer.apply(this,b.args));break;case"setPaintProperty":f.push(()=>this.setPaintProperty.apply(this,b.args));break;case"setLayoutProperty":f.push(()=>this.setLayoutProperty.apply(this,b.args));break;case"setFilter":f.push(()=>this.setFilter.apply(this,b.args));break;case"addSource":f.push(()=>this.addSource.apply(this,b.args));break;case"removeSource":f.push(()=>this.removeSource.apply(this,b.args));break;case"setLayerZoomRange":f.push(()=>this.setLayerZoomRange.apply(this,b.args));break;case"setLight":f.push(()=>this.setLight.apply(this,b.args));break;case"setGeoJSONSourceData":f.push(()=>this.setGeoJSONSourceData.apply(this,b.args));break;case"setGlyphs":f.push(()=>this.setGlyphs.apply(this,b.args));break;case"setSprite":f.push(()=>this.setSprite.apply(this,b.args));break;case"setTerrain":f.push(()=>this.map.setTerrain.apply(this,b.args));break;case"setSky":f.push(()=>this.setSky.apply(this,b.args));break;case"setProjection":this.setProjection.apply(this,b.args);break;case"setGlobalState":f.push(()=>this.setGlobalState.apply(this,b.args));break;case"setTransition":f.push(()=>{});break;default:x.push(b.command)}return{operations:f,unimplemented:x}}addImage(o,f){if(this.getImage(o))return this.fire(new a.k(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,f),this._afterImageUpdated(o)}updateImage(o,f){this.imageManager.updateImage(o,f)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new a.k(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,f,x={}){if(this._checkLoaded(),this.tileManagers[o]!==void 0)throw new Error(`Source "${o}" already exists.`);if(!f.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(f).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(f.type)>=0&&this._validate(a.B.source,`sources.${o}`,f,null,x))return;this.map&&this.map._collectResourceTiming&&(f.collectResourceTiming=!0);const b=this.tileManagers[o]=new kn(o,f,this.dispatcher);b.style=this,b.setEventedParent(this,()=>({isSourceLoaded:b.loaded(),source:b.serialize(),sourceId:o})),b.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),this.tileManagers[o]===void 0)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===o)return this.fire(new a.k(new Error(`Source "${o}" cannot be removed while layer "${x}" is using it.`)));const f=this.tileManagers[o];delete this.tileManagers[o],delete this._updatedSources[o],f.fire(new a.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),f.setEventedParent(null),f.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,f){if(this._checkLoaded(),this.tileManagers[o]===void 0)throw new Error(`There is no source with this ID=${o}`);const x=this.tileManagers[o].getSource();if(x.type!=="geojson")throw new Error(`geojsonSource.type is ${x.type}, which is !== 'geojson`);x.setData(f),this._changed=!0}getSource(o){return this.tileManagers[o]&&this.tileManagers[o].getSource()}addLayer(o,f,x={}){this._checkLoaded();const b=o.id;if(this.getLayer(b))return void this.fire(new a.k(new Error(`Layer "${b}" already exists on this map.`)));let P;if(o.type==="custom"){if(Ld(this,a.bQ(o)))return;P=a.bM(o,this._globalState)}else{if("source"in o&&typeof o.source=="object"&&(this.addSource(b,o.source),o=a.bO(o),o=a.e(o,{source:b})),this._validate(a.B.layer,`layers.${b}`,o,{arrayIndex:-1},x))return;P=a.bM(o,this._globalState),this._validateLayer(P),P.setEventedParent(this,{layer:{id:b}})}const E=f?this._order.indexOf(f):this._order.length;if(f&&E===-1)this.fire(new a.k(new Error(`Cannot add layer "${b}" before non-existing layer "${f}".`)));else{if(this._order.splice(E,0,b),this._layerOrderChanged=!0,this._layers[b]=P,this._removedLayers[b]&&P.source&&P.type!=="custom"){const F=this._removedLayers[b];delete this._removedLayers[b],F.type!==P.type?this._updatedSources[P.source]="clear":(this._updatedSources[P.source]="reload",this.tileManagers[P.source].pause())}this._updateLayer(P),P.onAdd&&P.onAdd(this.map)}}moveLayer(o,f){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new a.k(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===f)return;const x=this._order.indexOf(o);this._order.splice(x,1);const b=f?this._order.indexOf(f):this._order.length;f&&b===-1?this.fire(new a.k(new Error(`Cannot move layer "${o}" before non-existing layer "${f}".`))):(this._order.splice(b,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const f=this._layers[o];if(!f)return void this.fire(new a.k(new Error(`Cannot remove non-existing layer "${o}".`)));f.setEventedParent(null);const x=this._order.indexOf(o);this._order.splice(x,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=f,delete this._layers[o],this._serializedLayers&&delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],f.onRemove&&f.onRemove(this.map)}getLayer(o){return this._layers[o]}getLayersOrder(){return[...this._order]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,f,x){this._checkLoaded();const b=this.getLayer(o);b?b.minzoom===f&&b.maxzoom===x||(f!=null&&(b.minzoom=f),x!=null&&(b.maxzoom=x),this._updateLayer(b)):this.fire(new a.k(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,f,x={}){this._checkLoaded();const b=this.getLayer(o);if(b){if(!a.bK(b.filter,f))return f==null?(b.setFilter(void 0),void this._updateLayer(b)):void(this._validate(a.B.filter,`layers.${b.id}.filter`,f,null,x)||(b.setFilter(a.bO(f)),this._updateLayer(b)))}else this.fire(new a.k(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return a.bO(this.getLayer(o).filter)}setLayoutProperty(o,f,x,b={}){this._checkLoaded();const P=this.getLayer(o);P?a.bK(P.getLayoutProperty(f),x)||(P.setLayoutProperty(f,x,b),this._updateLayer(P)):this.fire(new a.k(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,f){const x=this.getLayer(o);if(x)return x.getLayoutProperty(f);this.fire(new a.k(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,f,x,b={}){this._checkLoaded();const P=this.getLayer(o);P?a.bK(P.getPaintProperty(f),x)||this._updatePaintProperty(P,f,x,b):this.fire(new a.k(new Error(`Cannot style non-existing layer "${o}".`)))}_updatePaintProperty(o,f,x,b={}){o.setPaintProperty(f,x,b)&&this._updateLayer(o),a.bN(o)&&f==="raster-fade-duration"&&this.tileManagers[o.source].setRasterFadeDuration(x),this._changed=!0,this._updatedPaintProps[o.id]=!0,this._serializedLayers=null}getPaintProperty(o,f){return this.getLayer(o).getPaintProperty(f)}setFeatureState(o,f){this._checkLoaded();const x=o.source,b=o.sourceLayer,P=this.tileManagers[x];if(P===void 0)return void this.fire(new a.k(new Error(`The source '${x}' does not exist in the map's style.`)));const E=P.getSource().type;E==="geojson"&&b?this.fire(new a.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||b?(o.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),P.setFeatureState(b,o.id,f)):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,f){this._checkLoaded();const x=o.source,b=this.tileManagers[x];if(b===void 0)return void this.fire(new a.k(new Error(`The source '${x}' does not exist in the map's style.`)));const P=b.getSource().type,E=P==="vector"?o.sourceLayer:void 0;P!=="vector"||E?f&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new a.k(new Error("A feature id is required to remove its specific state property."))):b.removeFeatureState(E,o.id,f):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const f=o.source,x=o.sourceLayer,b=this.tileManagers[f];if(b!==void 0)return b.getSource().type!=="vector"||x?(o.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),b.getFeatureState(x,o.id)):void this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.k(new Error(`The source '${f}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const o=a.bR(this.tileManagers,P=>P.serialize()),f=this._serializeByIds(this._order,!0),x=this.map.getTerrain()||void 0,b=this.stylesheet;return a.bS({version:b.version,name:b.name,metadata:b.metadata,light:b.light,sky:b.sky,center:b.center,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch,sprite:b.sprite,glyphs:b.glyphs,transition:b.transition,projection:b.projection,sources:o,layers:f,terrain:x},P=>P!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.tileManagers[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.tileManagers[o.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(o){const f=E=>this._layers[E].type==="fill-extrusion",x={},b=[];for(let E=this._order.length-1;E>=0;E--){const F=this._order[E];if(f(F)){x[F]=E;for(const B of o){const W=B[F];if(W)for(const G of W)b.push(G)}}}b.sort((E,F)=>F.intersectionZ-E.intersectionZ);const P=[];for(let E=this._order.length-1;E>=0;E--){const F=this._order[E];if(f(F))for(let B=b.length-1;B>=0;B--){const W=b[B].feature;if(x[W.layer.id]<E)break;P.push(W),b.pop()}else for(const B of o){const W=B[F];if(W)for(const G of W)P.push(G.feature)}}return P}queryRenderedFeatures(o,f,x){f&&f.filter&&this._validate(a.B.filter,"queryRenderedFeatures.filter",f.filter,null,f);const b={};if(f&&f.layers){if(!(Array.isArray(f.layers)||f.layers instanceof Set))return this.fire(new a.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const W of f.layers){const G=this._layers[W];if(!G)return this.fire(new a.k(new Error(`The layer '${W}' does not exist in the map's style and cannot be queried for features.`))),[];b[G.source]=!0}}const P=[];f.availableImages=this._availableImages;const E=this._serializedAllLayers(),F=f.layers instanceof Set?f.layers:Array.isArray(f.layers)?new Set(f.layers):null,B=Object.assign(Object.assign({},f),{layers:F,globalState:this._globalState});for(const W in this.tileManagers)f.layers&&!b[W]||P.push(mt(this.tileManagers[W],this._layers,E,o,B,x,this.map.terrain?(G,Y,Z)=>this.map.terrain.getElevation(G,Y,Z):void 0));return this.placement&&P.push(function(W,G,Y,Z,re,he,je){const we={},Se=he.queryRenderedSymbols(Z),Ee=[];for(const Re of Object.keys(Se).map(Number))Ee.push(je[Re]);Ee.sort(qr);for(const Re of Ee){const Te=Re.featureIndex.lookupSymbolFeatures(Se[Re.bucketInstanceId],G,Re.bucketIndex,Re.sourceLayerIndex,{filterSpec:re.filter,globalState:re.globalState},re.layers,re.availableImages,W);for(const Le in Te){const $e=we[Le]=we[Le]||[],Ie=Te[Le];Ie.sort((Ke,ut)=>{const st=Re.featureSortOrder;if(st){const ot=st.indexOf(Ke.featureIndex);return st.indexOf(ut.featureIndex)-ot}return ut.featureIndex-Ke.featureIndex});for(const Ke of Ie)$e.push(Ke)}}return function(Re,Te,Le){for(const $e in Re)for(const Ie of Re[$e])ar(Ie,Le[Te[$e].source]);return Re}(we,W,Y)}(this._layers,E,this.tileManagers,o,B,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(P)}querySourceFeatures(o,f){f!=null&&f.filter&&this._validate(a.B.filter,"querySourceFeatures.filter",f.filter,null,f);const x=this.tileManagers[o];return x?function(b,P){const E=b.getRenderableIds().map(W=>b.getTileByID(W)),F=[],B={};for(let W=0;W<E.length;W++){const G=E[W],Y=G.tileID.canonical.key;B[Y]||(B[Y]=!0,G.querySourceFeatures(F,P))}return F}(x,f?Object.assign(Object.assign({},f),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(o,f={}){this._checkLoaded();const x=this.light.getLight();let b=!1;for(const E in o)if(!a.bK(o[E],x[E])){b=!0;break}if(!b)return;const P={now:k(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,f),this.light.updateTransitions(P)}getProjection(){var o;return(o=this.stylesheet)===null||o===void 0?void 0:o.projection}setProjection(o){if(this._checkLoaded(),this.projection){if(this.projection.name===o.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=o,this._setProjectionInternal(o.type)}getSky(){var o;return(o=this.stylesheet)===null||o===void 0?void 0:o.sky}setSky(o,f={}){this._checkLoaded();const x=this.getSky();let b=!1;if(!o&&!x)return;if(o&&!x)b=!0;else if(!o&&x)b=!0;else for(const E in o)if(!a.bK(o[E],x[E])){b=!0;break}if(!b)return;const P={now:k(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=o,this.sky.setSky(o,f),this.sky.updateTransitions(P)}_setProjectionInternal(o){const f=function(x,b){const P={constrain:b};if(Array.isArray(x)){const E=new Sf({type:x});return{projection:E,transform:new gp(P),cameraHelper:new Cf(E)}}switch(x){case"mercator":return{projection:new Di,transform:new al(P),cameraHelper:new fu};case"globe":{const E=new Sf({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:E,transform:new gp(P),cameraHelper:new Cf(E)}}case"vertical-perspective":return{projection:new dp,transform:new pp(P),cameraHelper:new Co};default:return a.w(`Unknown projection name: ${x}. Falling back to mercator projection.`),{projection:new Di,transform:new al(P),cameraHelper:new fu}}}(o,this.map.transformConstrain);this.projection=f.projection,this.map.migrateProjection(f.transform,f.cameraHelper);for(const x in this.tileManagers)this.tileManagers[x].reload()}_validate(o,f,x,b,P={}){return(!P||P.validate!==!1)&&Ld(this,o.call(a.B,a.e({key:f,style:this.serialize(),value:x,styleSpec:a.t},b)))}_remove(o=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ue().off(ks,this._rtlPluginLoaded);for(const f in this._layers)this._layers[f].setEventedParent(null);for(const f in this.tileManagers){const x=this.tileManagers[f];x.setEventedParent(null),x.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),o&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(o)}_clearSource(o){this.tileManagers[o].clearTiles()}_reloadSource(o){this.tileManagers[o].resume(),this.tileManagers[o].reload()}_updateSources(o){for(const f in this.tileManagers)this.tileManagers[f].update(o,this.map.terrain)}_generateCollisionBoxes(){for(const o in this.tileManagers)this._reloadSource(o)}_updatePlacement(o,f,x,b,P=!1){let E=!1,F=!1;const B={};for(const W of this._order){const G=this._layers[W];if(G.type!=="symbol")continue;if(!B[G.source]){const Z=this.tileManagers[G.source];B[G.source]=Z.getRenderableIds(!0).map(re=>Z.getTileByID(re)).sort((re,he)=>he.tileID.overscaledZ-re.tileID.overscaledZ||(re.tileID.isLessThan(he.tileID)?-1:1))}const Y=this.crossTileSymbolIndex.addLayer(G,B[G.source],o.center.lng);E=E||Y}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((P=P||this._layerOrderChanged||x===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(k(),o.zoom))&&(this.pauseablePlacement=new lp(o,this.map.terrain,this._order,P,f,x,b,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,B),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(k()),F=!0),E&&this.pauseablePlacement.placement.setStale()),F||E)for(const W of this._order){const G=this._layers[W];G.type==="symbol"&&this.placement.updateLayerOpacities(G,B[G.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(k())}_releaseSymbolFadeTiles(){for(const o in this.tileManagers)this.tileManagers[o].releaseSymbolFadeTiles()}getImages(o,f){return a._(this,void 0,void 0,function*(){const x=yield this.imageManager.getImages(f.icons);this._updateTilesForChangedImages();const b=this.tileManagers[f.source];return b&&b.setDependencies(f.tileID.key,f.type,f.icons),x})}getGlyphs(o,f){return a._(this,void 0,void 0,function*(){const x=yield this.glyphManager.getGlyphs(f.stacks),b=this.tileManagers[f.source];return b&&b.setDependencies(f.tileID.key,f.type,[""]),x})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(o,f={}){this._checkLoaded(),o&&this._validate(a.B.glyphs,"glyphs",o,null,f)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=o,this.glyphManager.entries={},this.glyphManager.setURL(o))}getDashes(o,f){return a._(this,void 0,void 0,function*(){const x={};for(const[b,P]of Object.entries(f.dashes))x[b]=this.lineAtlas.getDash(P.dasharray,P.round);return x})}addSprite(o,f,x={},b){this._checkLoaded();const P=[{id:o,url:f}],E=[...te(this.stylesheet.sprite),...P];this._validate(a.B.sprite,"sprite",E,null,x)||(this.stylesheet.sprite=E,this._loadSprite(P,!0,b))}removeSprite(o){this._checkLoaded();const f=te(this.stylesheet.sprite);if(f.find(x=>x.id===o)){if(this._spritesImagesIds[o])for(const x of this._spritesImagesIds[o])this.imageManager.removeImage(x),this._changedImages[x]=!0;f.splice(f.findIndex(x=>x.id===o),1),this.stylesheet.sprite=f.length>0?f:void 0,delete this._spritesImagesIds[o],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}else this.fire(new a.k(new Error(`Sprite "${o}" doesn't exists on this map.`)))}getSprite(){return te(this.stylesheet.sprite)}setSprite(o,f={},x){this._checkLoaded(),o&&this._validate(a.B.sprite,"sprite",o,null,f)||(this.stylesheet.sprite=o,o?this._loadSprite(o,!0,x):(this._unloadSprite(),x&&x(null)))}}var rv=a.aN([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class ol{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,f,x,b,P,E,F,B,W){this.context=o;let G=this.boundPaintVertexBuffers.length!==b.length;for(let Y=0;!G&&Y<b.length;Y++)this.boundPaintVertexBuffers[Y]!==b[Y]&&(G=!0);!this.vao||this.boundProgram!==f||this.boundLayoutVertexBuffer!==x||G||this.boundIndexBuffer!==P||this.boundVertexOffset!==E||this.boundDynamicVertexBuffer!==F||this.boundDynamicVertexBuffer2!==B||this.boundDynamicVertexBuffer3!==W?this.freshBind(f,x,b,P,E,F,B,W):(o.bindVertexArray.set(this.vao),F&&F.bind(),P&&P.dynamicDraw&&P.bind(),B&&B.bind(),W&&W.bind())}freshBind(o,f,x,b,P,E,F,B){const W=o.numAttributes,G=this.context,Y=G.gl;this.vao&&this.destroy(),this.vao=G.createVertexArray(),G.bindVertexArray.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=x,this.boundIndexBuffer=b,this.boundVertexOffset=P,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=F,this.boundDynamicVertexBuffer3=B,f.enableAttributes(Y,o);for(const Z of x)Z.enableAttributes(Y,o);E&&E.enableAttributes(Y,o),F&&F.enableAttributes(Y,o),B&&B.enableAttributes(Y,o),f.bind(),f.setVertexAttribPointers(Y,o,P);for(const Z of x)Z.bind(),Z.setVertexAttribPointers(Y,o,P);E&&(E.bind(),E.setVertexAttribPointers(Y,o,P)),b&&b.bind(),F&&(F.bind(),F.setVertexAttribPointers(Y,o,P)),B&&(B.bind(),B.setVertexAttribPointers(Y,o,P)),G.currentNumAttributes=W}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const PP=(w,o,f,x,b)=>({u_texture:0,u_ele_delta:w,u_fog_matrix:o,u_fog_color:f?f.properties.get("fog-color"):a.bi.white,u_fog_ground_blend:f?f.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:b?0:f?f.calculateFogBlendOpacity(x):0,u_horizon_color:f?f.properties.get("horizon-color"):a.bi.white,u_horizon_fog_blend:f?f.properties.get("horizon-fog-blend"):1,u_is_globe_mode:b?1:0}),nv={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Pc(w){const o=[];for(let f=0;f<w.length;f++){if(w[f]===null)continue;const x=w[f].split(" ");o.push(x.pop())}return o}class kf{constructor(o,f,x,b,P,E,F,B,W=[]){const G=o.gl;this.program=G.createProgram();const Y=Pc(f.staticAttributes),Z=x?x.getBinderAttributes():[],re=Y.concat(Z),he=Ur.prelude.staticUniforms?Pc(Ur.prelude.staticUniforms):[],je=F.staticUniforms?Pc(F.staticUniforms):[],we=f.staticUniforms?Pc(f.staticUniforms):[],Se=x?x.getBinderUniforms():[],Ee=he.concat(je).concat(we).concat(Se),Re=[];for(const st of Ee)Re.indexOf(st)<0&&Re.push(st);const Te=x?x.defines():[];so(G)&&Te.unshift("#version 300 es"),P&&Te.push("#define OVERDRAW_INSPECTOR;"),E&&Te.push("#define TERRAIN3D;"),B&&Te.push(B),W&&Te.push(...W);let Le=Te.concat(Ur.prelude.fragmentSource,F.fragmentSource,f.fragmentSource).join(`
`),$e=Te.concat(Ur.prelude.vertexSource,F.vertexSource,f.vertexSource).join(`
`);so(G)||(Le=function(st){return st.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Le),$e=function(st){return st.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}($e));const Ie=G.createShader(G.FRAGMENT_SHADER);if(G.isContextLost())return void(this.failedToCreate=!0);if(G.shaderSource(Ie,Le),G.compileShader(Ie),!G.getShaderParameter(Ie,G.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${G.getShaderInfoLog(Ie)}`);G.attachShader(this.program,Ie);const Ke=G.createShader(G.VERTEX_SHADER);if(G.isContextLost())return void(this.failedToCreate=!0);if(G.shaderSource(Ke,$e),G.compileShader(Ke),!G.getShaderParameter(Ke,G.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${G.getShaderInfoLog(Ke)}`);G.attachShader(this.program,Ke),this.attributes={};const ut={};this.numAttributes=re.length;for(let st=0;st<this.numAttributes;st++)re[st]&&(G.bindAttribLocation(this.program,st,re[st]),this.attributes[re[st]]=st);if(G.linkProgram(this.program),!G.getProgramParameter(this.program,G.LINK_STATUS))throw new Error(`Program failed to link: ${G.getProgramInfoLog(this.program)}`);G.deleteShader(Ke),G.deleteShader(Ie);for(let st=0;st<Re.length;st++){const ot=Re[st];if(ot&&!ut[ot]){const dt=G.getUniformLocation(this.program,ot);dt&&(ut[ot]=dt)}}this.fixedUniforms=b(o,ut),this.terrainUniforms=((st,ot)=>({u_depth:new a.bT(st,ot.u_depth),u_terrain:new a.bT(st,ot.u_terrain),u_terrain_dim:new a.bj(st,ot.u_terrain_dim),u_terrain_matrix:new a.bV(st,ot.u_terrain_matrix),u_terrain_unpack:new a.bW(st,ot.u_terrain_unpack),u_terrain_exaggeration:new a.bj(st,ot.u_terrain_exaggeration)}))(o,ut),this.projectionUniforms=((st,ot)=>({u_projection_matrix:new a.bV(st,ot.u_projection_matrix),u_projection_tile_mercator_coords:new a.bW(st,ot.u_projection_tile_mercator_coords),u_projection_clipping_plane:new a.bW(st,ot.u_projection_clipping_plane),u_projection_transition:new a.bj(st,ot.u_projection_transition),u_projection_fallback_matrix:new a.bV(st,ot.u_projection_fallback_matrix)}))(o,ut),this.binderUniforms=x?x.getUniforms(o,ut):[]}draw(o,f,x,b,P,E,F,B,W,G,Y,Z,re,he,je,we,Se,Ee,Re){const Te=o.gl;if(this.failedToCreate)return;if(o.program.set(this.program),o.setDepthMode(x),o.setStencilMode(b),o.setColorMode(P),o.setCullFace(E),B){o.activeTexture.set(Te.TEXTURE2),Te.bindTexture(Te.TEXTURE_2D,B.depthTexture),o.activeTexture.set(Te.TEXTURE3),Te.bindTexture(Te.TEXTURE_2D,B.texture);for(const $e in this.terrainUniforms)this.terrainUniforms[$e].set(B[$e])}if(W)for(const $e in W)this.projectionUniforms[nv[$e]].set(W[$e]);if(F)for(const $e in this.fixedUniforms)this.fixedUniforms[$e].set(F[$e]);we&&we.setUniforms(o,this.binderUniforms,he,{zoom:je});let Le=0;switch(f){case Te.LINES:Le=2;break;case Te.TRIANGLES:Le=3;break;case Te.LINE_STRIP:Le=1}for(const $e of re.get()){const Ie=$e.vaos||($e.vaos={});(Ie[G]||(Ie[G]=new ol)).bind(o,this,Y,we?we.getPaintVertexBuffers():[],Z,$e.vertexOffset,Se,Ee,Re),Te.drawElements(f,$e.primitiveLength*Le,Te.UNSIGNED_SHORT,$e.primitiveOffset*Le*2)}}}function cj(w,o,f){const x=1/a.aG(f,1,o.transform.tileZoom),b=Math.pow(2,f.tileID.overscaledZ),P=f.tileSize*Math.pow(2,o.transform.tileZoom)/b,E=P*(f.tileID.canonical.x+f.tileID.wrap*b),F=P*f.tileID.canonical.y;return{u_image:0,u_texsize:f.imageAtlasTexture.size,u_scale:[x,w.fromScale,w.toScale],u_fade:w.t,u_pixel_coord_upper:[E>>16,F>>16],u_pixel_coord_lower:[65535&E,65535&F]}}const Tf=(w,o,f,x)=>{const b=w.style.light,P=b.properties.get("position"),E=[P.x,P.y,P.z],F=a.bZ();b.properties.get("anchor")==="viewport"&&a.b_(F,w.transform.bearingInRadians),a.b$(E,E,F);const B=w.transform.transformLightDirection(E),W=b.properties.get("color");return{u_lightpos:E,u_lightpos_globe:B,u_lightintensity:b.properties.get("intensity"),u_lightcolor:[W.r,W.g,W.b],u_vertical_gradient:+o,u_opacity:f,u_fill_translate:x}},CP=(w,o,f,x,b,P,E)=>a.e(Tf(w,o,f,x),cj(P,w,E),{u_height_factor:-Math.pow(2,b.overscaledZ)/E.tileSize/8}),pu=(w,o,f,x)=>a.e(cj(o,w,f),{u_fill_translate:x}),AP=(w,o)=>({u_world:w,u_fill_translate:o}),uj=(w,o,f,x,b)=>a.e(pu(w,o,f,b),{u_world:x}),kP=(w,o,f,x,b)=>{const P=w.transform;let E,F,B=0;if(f.paint.get("circle-pitch-alignment")==="map"){const W=a.aG(o,1,P.zoom);E=!0,F=[W,W],B=W/(a.a3*Math.pow(2,o.tileID.overscaledZ))*2*Math.PI*b}else E=!1,F=P.pixelsToGLUnits;return{u_camera_to_center_distance:P.cameraToCenterDistance,u_scale_with_map:+(f.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+E,u_device_pixel_ratio:w.pixelRatio,u_extrude_scale:F,u_globe_extrude_scale:B,u_translate:x}},dj=w=>({u_pixel_extrude_scale:[1/w.width,1/w.height]}),sv=w=>({u_viewport_size:[w.width,w.height]}),iv=(w,o=1)=>({u_color:w,u_overlay:0,u_overlay_scale:o}),av=(w,o,f,x)=>{const b=a.aG(w,1,o)/(a.a3*Math.pow(2,w.tileID.overscaledZ))*2*Math.PI*x;return{u_extrude_scale:a.aG(w,1,o),u_intensity:f,u_globe_extrude_scale:b}},ov=(w,o,f,x)=>{const b=a.M();a.c0(b,0,w.width,w.height,0,0,1);const P=w.context.gl;return{u_matrix:b,u_world:[P.drawingBufferWidth,P.drawingBufferHeight],u_image:f,u_color_ramp:x,u_opacity:o.paint.get("heatmap-opacity")}},hj=(w,o,f)=>{const x=f.paint.get("hillshade-accent-color");let b;switch(f.paint.get("hillshade-method")){case"basic":b=4;break;case"combined":b=1;break;case"igor":b=2;break;case"multidirectional":b=3;break;default:b=0}const P=f.getIlluminationProperties();for(let E=0;E<P.directionRadians.length;E++)f.paint.get("hillshade-illumination-anchor")==="viewport"&&(P.directionRadians[E]+=w.transform.bearingInRadians);return{u_image:0,u_latrange:fj(0,o.tileID),u_exaggeration:f.paint.get("hillshade-exaggeration"),u_altitudes:P.altitudeRadians,u_azimuths:P.directionRadians,u_accent:x,u_method:b,u_highlights:P.highlightColor,u_shadows:P.shadowColor}},gu=(w,o)=>{const f=o.stride,x=a.M();return a.c0(x,0,a.a3,-a.a3,0,0,1),a.N(x,x,[0,-a.a3,0]),{u_matrix:x,u_image:1,u_dimension:[f,f],u_zoom:w.overscaledZ,u_unpack:o.getUnpackVector()}};function fj(w,o){const f=Math.pow(2,o.canonical.z),x=o.canonical.y;return[new a.a5(0,x/f).toLngLat().lat,new a.a5(0,(x+1)/f).toLngLat().lat]}const mj=(w,o,f=0)=>({u_image:0,u_unpack:o.getUnpackVector(),u_dimension:[o.stride,o.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:f,u_opacity:w.paint.get("color-relief-opacity")}),Cc=(w,o,f,x)=>{const b=w.transform;return{u_translation:lv(w,o,f),u_ratio:x/a.aG(o,1,b.zoom),u_device_pixel_ratio:w.pixelRatio,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},TP=(w,o,f,x,b)=>a.e(Cc(w,o,f,x),{u_image:0,u_image_height:b}),yp=(w,o,f,x,b)=>{const P=w.transform,E=vp(o,P);return{u_translation:lv(w,o,f),u_texsize:o.imageAtlasTexture.size,u_ratio:x/a.aG(o,1,P.zoom),u_device_pixel_ratio:w.pixelRatio,u_image:0,u_scale:[E,b.fromScale,b.toScale],u_fade:b.t,u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]]}},EP=(w,o,f,x,b)=>{const P=vp(o,w.transform);return a.e(Cc(w,o,f,x),{u_tileratio:P,u_crossfade_from:b.fromScale,u_crossfade_to:b.toScale,u_image:0,u_mix:b.t,u_lineatlas_width:w.lineAtlas.width,u_lineatlas_height:w.lineAtlas.height})},MP=(w,o,f,x,b,P)=>{const E=vp(o,w.transform);return a.e(Cc(w,o,f,x),{u_image:0,u_image_height:P,u_tileratio:E,u_crossfade_from:b.fromScale,u_crossfade_to:b.toScale,u_image_dash:1,u_mix:b.t,u_lineatlas_width:w.lineAtlas.width,u_lineatlas_height:w.lineAtlas.height})};function vp(w,o){return 1/a.aG(w,1,o.tileZoom)}function lv(w,o,f){return a.aH(w.transform,o,f.paint.get("line-translate"),f.paint.get("line-translate-anchor"))}const pj=(w,o,f,x,b)=>{return{u_tl_parent:w,u_scale_parent:o,u_buffer_scale:1,u_fade_t:f.mix,u_opacity:f.opacity*x.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:x.paint.get("raster-brightness-min"),u_brightness_high:x.paint.get("raster-brightness-max"),u_saturation_factor:(E=x.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(P=x.paint.get("raster-contrast"),P>0?1/(1-P):1+P),u_spin_weights:cv(x.paint.get("raster-hue-rotate")),u_coords_top:[b[0].x,b[0].y,b[1].x,b[1].y],u_coords_bottom:[b[3].x,b[3].y,b[2].x,b[2].y]};var P,E};function cv(w){w*=Math.PI/180;const o=Math.sin(w),f=Math.cos(w);return[(2*f+1)/3,(-Math.sqrt(3)*o-f+1)/3,(Math.sqrt(3)*o-f+1)/3]}const uv=(w,o,f,x,b,P,E,F,B,W,G,Y,Z)=>{const re=E.transform;return{u_is_size_zoom_constant:+(w==="constant"||w==="source"),u_is_size_feature_constant:+(w==="constant"||w==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:re.cameraToCenterDistance,u_pitch:re.pitch/360*2*Math.PI,u_rotate_symbol:+f,u_aspect_ratio:re.width/re.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_label_plane_matrix:F,u_coord_matrix:B,u_is_text:+G,u_pitch_with_map:+x,u_is_along_line:b,u_is_variable_anchor:P,u_texsize:Y,u_texture:0,u_translation:W,u_pitched_scale:Z}},Ef=(w,o,f,x,b,P,E,F,B,W,G,Y,Z,re)=>{const he=E.transform;return a.e(uv(w,o,f,x,b,P,E,F,B,W,G,Y,re),{u_gamma_scale:x?Math.cos(he.pitch*Math.PI/180)*he.cameraToCenterDistance:1,u_device_pixel_ratio:E.pixelRatio,u_is_halo:1})},Rl=(w,o,f,x,b,P,E,F,B,W,G,Y,Z)=>a.e(Ef(w,o,f,x,b,P,E,F,B,W,!0,G,0,Z),{u_texsize_icon:Y,u_texture_icon:1}),dv=(w,o)=>({u_opacity:w,u_color:o}),hv=(w,o,f,x,b)=>a.e(function(P,E,F,B){const W=F.imageManager.getPattern(P.from.toString()),G=F.imageManager.getPattern(P.to.toString()),{width:Y,height:Z}=F.imageManager.getPixelSize(),re=Math.pow(2,B.tileID.overscaledZ),he=B.tileSize*Math.pow(2,F.transform.tileZoom)/re,je=he*(B.tileID.canonical.x+B.tileID.wrap*re),we=he*B.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:W.tl,u_pattern_br_a:W.br,u_pattern_tl_b:G.tl,u_pattern_br_b:G.br,u_texsize:[Y,Z],u_mix:E.t,u_pattern_size_a:W.displaySize,u_pattern_size_b:G.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/a.aG(B,1,F.transform.tileZoom),u_pixel_coord_upper:[je>>16,we>>16],u_pixel_coord_lower:[65535&je,65535&we]}}(f,b,o,x),{u_opacity:w}),_p=(w,o)=>{},gj={fillExtrusion:(w,o)=>({u_lightpos:new a.bX(w,o.u_lightpos),u_lightpos_globe:new a.bX(w,o.u_lightpos_globe),u_lightintensity:new a.bj(w,o.u_lightintensity),u_lightcolor:new a.bX(w,o.u_lightcolor),u_vertical_gradient:new a.bj(w,o.u_vertical_gradient),u_opacity:new a.bj(w,o.u_opacity),u_fill_translate:new a.bY(w,o.u_fill_translate)}),fillExtrusionPattern:(w,o)=>({u_lightpos:new a.bX(w,o.u_lightpos),u_lightpos_globe:new a.bX(w,o.u_lightpos_globe),u_lightintensity:new a.bj(w,o.u_lightintensity),u_lightcolor:new a.bX(w,o.u_lightcolor),u_vertical_gradient:new a.bj(w,o.u_vertical_gradient),u_height_factor:new a.bj(w,o.u_height_factor),u_opacity:new a.bj(w,o.u_opacity),u_fill_translate:new a.bY(w,o.u_fill_translate),u_image:new a.bT(w,o.u_image),u_texsize:new a.bY(w,o.u_texsize),u_pixel_coord_upper:new a.bY(w,o.u_pixel_coord_upper),u_pixel_coord_lower:new a.bY(w,o.u_pixel_coord_lower),u_scale:new a.bX(w,o.u_scale),u_fade:new a.bj(w,o.u_fade)}),fill:(w,o)=>({u_fill_translate:new a.bY(w,o.u_fill_translate)}),fillPattern:(w,o)=>({u_image:new a.bT(w,o.u_image),u_texsize:new a.bY(w,o.u_texsize),u_pixel_coord_upper:new a.bY(w,o.u_pixel_coord_upper),u_pixel_coord_lower:new a.bY(w,o.u_pixel_coord_lower),u_scale:new a.bX(w,o.u_scale),u_fade:new a.bj(w,o.u_fade),u_fill_translate:new a.bY(w,o.u_fill_translate)}),fillOutline:(w,o)=>({u_world:new a.bY(w,o.u_world),u_fill_translate:new a.bY(w,o.u_fill_translate)}),fillOutlinePattern:(w,o)=>({u_world:new a.bY(w,o.u_world),u_image:new a.bT(w,o.u_image),u_texsize:new a.bY(w,o.u_texsize),u_pixel_coord_upper:new a.bY(w,o.u_pixel_coord_upper),u_pixel_coord_lower:new a.bY(w,o.u_pixel_coord_lower),u_scale:new a.bX(w,o.u_scale),u_fade:new a.bj(w,o.u_fade),u_fill_translate:new a.bY(w,o.u_fill_translate)}),circle:(w,o)=>({u_camera_to_center_distance:new a.bj(w,o.u_camera_to_center_distance),u_scale_with_map:new a.bT(w,o.u_scale_with_map),u_pitch_with_map:new a.bT(w,o.u_pitch_with_map),u_extrude_scale:new a.bY(w,o.u_extrude_scale),u_device_pixel_ratio:new a.bj(w,o.u_device_pixel_ratio),u_globe_extrude_scale:new a.bj(w,o.u_globe_extrude_scale),u_translate:new a.bY(w,o.u_translate)}),collisionBox:(w,o)=>({u_pixel_extrude_scale:new a.bY(w,o.u_pixel_extrude_scale)}),collisionCircle:(w,o)=>({u_viewport_size:new a.bY(w,o.u_viewport_size)}),debug:(w,o)=>({u_color:new a.bU(w,o.u_color),u_overlay:new a.bT(w,o.u_overlay),u_overlay_scale:new a.bj(w,o.u_overlay_scale)}),depth:_p,clippingMask:_p,heatmap:(w,o)=>({u_extrude_scale:new a.bj(w,o.u_extrude_scale),u_intensity:new a.bj(w,o.u_intensity),u_globe_extrude_scale:new a.bj(w,o.u_globe_extrude_scale)}),heatmapTexture:(w,o)=>({u_matrix:new a.bV(w,o.u_matrix),u_world:new a.bY(w,o.u_world),u_image:new a.bT(w,o.u_image),u_color_ramp:new a.bT(w,o.u_color_ramp),u_opacity:new a.bj(w,o.u_opacity)}),hillshade:(w,o)=>({u_image:new a.bT(w,o.u_image),u_latrange:new a.bY(w,o.u_latrange),u_exaggeration:new a.bj(w,o.u_exaggeration),u_altitudes:new a.c2(w,o.u_altitudes),u_azimuths:new a.c2(w,o.u_azimuths),u_accent:new a.bU(w,o.u_accent),u_method:new a.bT(w,o.u_method),u_shadows:new a.c1(w,o.u_shadows),u_highlights:new a.c1(w,o.u_highlights)}),hillshadePrepare:(w,o)=>({u_matrix:new a.bV(w,o.u_matrix),u_image:new a.bT(w,o.u_image),u_dimension:new a.bY(w,o.u_dimension),u_zoom:new a.bj(w,o.u_zoom),u_unpack:new a.bW(w,o.u_unpack)}),colorRelief:(w,o)=>({u_image:new a.bT(w,o.u_image),u_unpack:new a.bW(w,o.u_unpack),u_dimension:new a.bY(w,o.u_dimension),u_elevation_stops:new a.bT(w,o.u_elevation_stops),u_color_stops:new a.bT(w,o.u_color_stops),u_color_ramp_size:new a.bT(w,o.u_color_ramp_size),u_opacity:new a.bj(w,o.u_opacity)}),line:(w,o)=>({u_translation:new a.bY(w,o.u_translation),u_ratio:new a.bj(w,o.u_ratio),u_device_pixel_ratio:new a.bj(w,o.u_device_pixel_ratio),u_units_to_pixels:new a.bY(w,o.u_units_to_pixels)}),lineGradient:(w,o)=>({u_translation:new a.bY(w,o.u_translation),u_ratio:new a.bj(w,o.u_ratio),u_device_pixel_ratio:new a.bj(w,o.u_device_pixel_ratio),u_units_to_pixels:new a.bY(w,o.u_units_to_pixels),u_image:new a.bT(w,o.u_image),u_image_height:new a.bj(w,o.u_image_height)}),linePattern:(w,o)=>({u_translation:new a.bY(w,o.u_translation),u_texsize:new a.bY(w,o.u_texsize),u_ratio:new a.bj(w,o.u_ratio),u_device_pixel_ratio:new a.bj(w,o.u_device_pixel_ratio),u_image:new a.bT(w,o.u_image),u_units_to_pixels:new a.bY(w,o.u_units_to_pixels),u_scale:new a.bX(w,o.u_scale),u_fade:new a.bj(w,o.u_fade)}),lineSDF:(w,o)=>({u_translation:new a.bY(w,o.u_translation),u_ratio:new a.bj(w,o.u_ratio),u_device_pixel_ratio:new a.bj(w,o.u_device_pixel_ratio),u_units_to_pixels:new a.bY(w,o.u_units_to_pixels),u_image:new a.bT(w,o.u_image),u_mix:new a.bj(w,o.u_mix),u_tileratio:new a.bj(w,o.u_tileratio),u_crossfade_from:new a.bj(w,o.u_crossfade_from),u_crossfade_to:new a.bj(w,o.u_crossfade_to),u_lineatlas_width:new a.bj(w,o.u_lineatlas_width),u_lineatlas_height:new a.bj(w,o.u_lineatlas_height)}),lineGradientSDF:(w,o)=>({u_translation:new a.bY(w,o.u_translation),u_ratio:new a.bj(w,o.u_ratio),u_device_pixel_ratio:new a.bj(w,o.u_device_pixel_ratio),u_units_to_pixels:new a.bY(w,o.u_units_to_pixels),u_image:new a.bT(w,o.u_image),u_image_height:new a.bj(w,o.u_image_height),u_tileratio:new a.bj(w,o.u_tileratio),u_crossfade_from:new a.bj(w,o.u_crossfade_from),u_crossfade_to:new a.bj(w,o.u_crossfade_to),u_image_dash:new a.bT(w,o.u_image_dash),u_mix:new a.bj(w,o.u_mix),u_lineatlas_width:new a.bj(w,o.u_lineatlas_width),u_lineatlas_height:new a.bj(w,o.u_lineatlas_height)}),raster:(w,o)=>({u_tl_parent:new a.bY(w,o.u_tl_parent),u_scale_parent:new a.bj(w,o.u_scale_parent),u_buffer_scale:new a.bj(w,o.u_buffer_scale),u_fade_t:new a.bj(w,o.u_fade_t),u_opacity:new a.bj(w,o.u_opacity),u_image0:new a.bT(w,o.u_image0),u_image1:new a.bT(w,o.u_image1),u_brightness_low:new a.bj(w,o.u_brightness_low),u_brightness_high:new a.bj(w,o.u_brightness_high),u_saturation_factor:new a.bj(w,o.u_saturation_factor),u_contrast_factor:new a.bj(w,o.u_contrast_factor),u_spin_weights:new a.bX(w,o.u_spin_weights),u_coords_top:new a.bW(w,o.u_coords_top),u_coords_bottom:new a.bW(w,o.u_coords_bottom)}),symbolIcon:(w,o)=>({u_is_size_zoom_constant:new a.bT(w,o.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bT(w,o.u_is_size_feature_constant),u_size_t:new a.bj(w,o.u_size_t),u_size:new a.bj(w,o.u_size),u_camera_to_center_distance:new a.bj(w,o.u_camera_to_center_distance),u_pitch:new a.bj(w,o.u_pitch),u_rotate_symbol:new a.bT(w,o.u_rotate_symbol),u_aspect_ratio:new a.bj(w,o.u_aspect_ratio),u_fade_change:new a.bj(w,o.u_fade_change),u_label_plane_matrix:new a.bV(w,o.u_label_plane_matrix),u_coord_matrix:new a.bV(w,o.u_coord_matrix),u_is_text:new a.bT(w,o.u_is_text),u_pitch_with_map:new a.bT(w,o.u_pitch_with_map),u_is_along_line:new a.bT(w,o.u_is_along_line),u_is_variable_anchor:new a.bT(w,o.u_is_variable_anchor),u_texsize:new a.bY(w,o.u_texsize),u_texture:new a.bT(w,o.u_texture),u_translation:new a.bY(w,o.u_translation),u_pitched_scale:new a.bj(w,o.u_pitched_scale)}),symbolSDF:(w,o)=>({u_is_size_zoom_constant:new a.bT(w,o.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bT(w,o.u_is_size_feature_constant),u_size_t:new a.bj(w,o.u_size_t),u_size:new a.bj(w,o.u_size),u_camera_to_center_distance:new a.bj(w,o.u_camera_to_center_distance),u_pitch:new a.bj(w,o.u_pitch),u_rotate_symbol:new a.bT(w,o.u_rotate_symbol),u_aspect_ratio:new a.bj(w,o.u_aspect_ratio),u_fade_change:new a.bj(w,o.u_fade_change),u_label_plane_matrix:new a.bV(w,o.u_label_plane_matrix),u_coord_matrix:new a.bV(w,o.u_coord_matrix),u_is_text:new a.bT(w,o.u_is_text),u_pitch_with_map:new a.bT(w,o.u_pitch_with_map),u_is_along_line:new a.bT(w,o.u_is_along_line),u_is_variable_anchor:new a.bT(w,o.u_is_variable_anchor),u_texsize:new a.bY(w,o.u_texsize),u_texture:new a.bT(w,o.u_texture),u_gamma_scale:new a.bj(w,o.u_gamma_scale),u_device_pixel_ratio:new a.bj(w,o.u_device_pixel_ratio),u_is_halo:new a.bT(w,o.u_is_halo),u_translation:new a.bY(w,o.u_translation),u_pitched_scale:new a.bj(w,o.u_pitched_scale)}),symbolTextAndIcon:(w,o)=>({u_is_size_zoom_constant:new a.bT(w,o.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bT(w,o.u_is_size_feature_constant),u_size_t:new a.bj(w,o.u_size_t),u_size:new a.bj(w,o.u_size),u_camera_to_center_distance:new a.bj(w,o.u_camera_to_center_distance),u_pitch:new a.bj(w,o.u_pitch),u_rotate_symbol:new a.bT(w,o.u_rotate_symbol),u_aspect_ratio:new a.bj(w,o.u_aspect_ratio),u_fade_change:new a.bj(w,o.u_fade_change),u_label_plane_matrix:new a.bV(w,o.u_label_plane_matrix),u_coord_matrix:new a.bV(w,o.u_coord_matrix),u_is_text:new a.bT(w,o.u_is_text),u_pitch_with_map:new a.bT(w,o.u_pitch_with_map),u_is_along_line:new a.bT(w,o.u_is_along_line),u_is_variable_anchor:new a.bT(w,o.u_is_variable_anchor),u_texsize:new a.bY(w,o.u_texsize),u_texsize_icon:new a.bY(w,o.u_texsize_icon),u_texture:new a.bT(w,o.u_texture),u_texture_icon:new a.bT(w,o.u_texture_icon),u_gamma_scale:new a.bj(w,o.u_gamma_scale),u_device_pixel_ratio:new a.bj(w,o.u_device_pixel_ratio),u_is_halo:new a.bT(w,o.u_is_halo),u_translation:new a.bY(w,o.u_translation),u_pitched_scale:new a.bj(w,o.u_pitched_scale)}),background:(w,o)=>({u_opacity:new a.bj(w,o.u_opacity),u_color:new a.bU(w,o.u_color)}),backgroundPattern:(w,o)=>({u_opacity:new a.bj(w,o.u_opacity),u_image:new a.bT(w,o.u_image),u_pattern_tl_a:new a.bY(w,o.u_pattern_tl_a),u_pattern_br_a:new a.bY(w,o.u_pattern_br_a),u_pattern_tl_b:new a.bY(w,o.u_pattern_tl_b),u_pattern_br_b:new a.bY(w,o.u_pattern_br_b),u_texsize:new a.bY(w,o.u_texsize),u_mix:new a.bj(w,o.u_mix),u_pattern_size_a:new a.bY(w,o.u_pattern_size_a),u_pattern_size_b:new a.bY(w,o.u_pattern_size_b),u_scale_a:new a.bj(w,o.u_scale_a),u_scale_b:new a.bj(w,o.u_scale_b),u_pixel_coord_upper:new a.bY(w,o.u_pixel_coord_upper),u_pixel_coord_lower:new a.bY(w,o.u_pixel_coord_lower),u_tile_units_to_pixels:new a.bj(w,o.u_tile_units_to_pixels)}),terrain:(w,o)=>({u_texture:new a.bT(w,o.u_texture),u_ele_delta:new a.bj(w,o.u_ele_delta),u_fog_matrix:new a.bV(w,o.u_fog_matrix),u_fog_color:new a.bU(w,o.u_fog_color),u_fog_ground_blend:new a.bj(w,o.u_fog_ground_blend),u_fog_ground_blend_opacity:new a.bj(w,o.u_fog_ground_blend_opacity),u_horizon_color:new a.bU(w,o.u_horizon_color),u_horizon_fog_blend:new a.bj(w,o.u_horizon_fog_blend),u_is_globe_mode:new a.bj(w,o.u_is_globe_mode)}),terrainDepth:(w,o)=>({u_ele_delta:new a.bj(w,o.u_ele_delta)}),terrainCoords:(w,o)=>({u_texture:new a.bT(w,o.u_texture),u_terrain_coords_id:new a.bj(w,o.u_terrain_coords_id),u_ele_delta:new a.bj(w,o.u_ele_delta)}),projectionErrorMeasurement:(w,o)=>({u_input:new a.bj(w,o.u_input),u_output_expected:new a.bj(w,o.u_output_expected)}),atmosphere:(w,o)=>({u_sun_pos:new a.bX(w,o.u_sun_pos),u_atmosphere_blend:new a.bj(w,o.u_atmosphere_blend),u_globe_position:new a.bX(w,o.u_globe_position),u_globe_radius:new a.bj(w,o.u_globe_radius),u_inv_proj_matrix:new a.bV(w,o.u_inv_proj_matrix)}),sky:(w,o)=>({u_sky_color:new a.bU(w,o.u_sky_color),u_horizon_color:new a.bU(w,o.u_horizon_color),u_horizon:new a.bY(w,o.u_horizon),u_horizon_normal:new a.bY(w,o.u_horizon_normal),u_sky_horizon_blend:new a.bj(w,o.u_sky_horizon_blend),u_sky_blend:new a.bj(w,o.u_sky_blend)})};class fv{constructor(o,f,x){this.context=o;const b=o.gl;this.buffer=b.createBuffer(),this.dynamicDraw=!!x,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const f=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const xu={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class mv{constructor(o,f,x,b){this.length=f.length,this.attributes=x,this.itemSize=f.bytesPerElement,this.dynamicDraw=b,this.context=o;const P=o.gl;this.buffer=P.createBuffer(),o.bindVertexBuffer.set(this.buffer),P.bufferData(P.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){if(o.length!==this.length)throw new Error(`Length of new data is ${o.length}, which doesn't match current length of ${this.length}`);const f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,f){for(let x=0;x<this.attributes.length;x++){const b=f.attributes[this.attributes[x].name];b!==void 0&&o.enableVertexAttribArray(b)}}setVertexAttribPointers(o,f,x){for(let b=0;b<this.attributes.length;b++){const P=this.attributes[b],E=f.attributes[P.name];E!==void 0&&o.vertexAttribPointer(E,P.components,o[xu[P.type]],!1,this.itemSize,P.offset+this.itemSize*(x||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class En{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class OP extends En{getDefault(){return a.bi.transparent}set(o){const f=this.current;(o.r!==f.r||o.g!==f.g||o.b!==f.b||o.a!==f.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class IP extends En{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class DP extends En{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class xj extends En{getDefault(){return[!0,!0,!0,!0]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||o[2]!==f[2]||o[3]!==f[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class RP extends En{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class yj extends En{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class bp extends En{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const f=this.current;(o.func!==f.func||o.ref!==f.ref||o.mask!==f.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class jp extends En{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||o[2]!==f[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class wp extends En{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;o?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST),this.current=o,this.dirty=!1}}class pv extends En{getDefault(){return[0,1]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class yu extends En{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;o?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this.current=o,this.dirty=!1}}class Mf extends En{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Fd extends En{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;o?f.enable(f.BLEND):f.disable(f.BLEND),this.current=o,this.dirty=!1}}class ao extends En{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class vj extends En{getDefault(){return a.bi.transparent}set(o){const f=this.current;(o.r!==f.r||o.g!==f.g||o.b!==f.b||o.a!==f.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class _j extends En{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class gv extends En{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;o?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this.current=o,this.dirty=!1}}class vu extends En{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Sp extends En{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class Np extends En{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class Of extends En{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Pp extends En{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||o[2]!==f[2]||o[3]!==f[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class bj extends En{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class zd extends En{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.bindRenderbuffer(f.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class $d extends En{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.bindTexture(f.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class jj extends En{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class xv extends En{getDefault(){return null}set(o){const f=this.gl;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class cn extends En{getDefault(){return null}set(o){var f;if(o===this.current&&!this.dirty)return;const x=this.gl;so(x)?x.bindVertexArray(o):(f=x.getExtension("OES_vertex_array_object"))===null||f===void 0||f.bindVertexArrayOES(o),this.current=o,this.dirty=!1}}class Cp extends En{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class LP extends En{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class wj extends En{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class _u extends En{constructor(o,f){super(o),this.context=o,this.parent=f}getDefault(){return null}}class FP extends _u{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class zP extends _u{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Sj extends _u{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.RENDERBUFFER,o),this.current=o,this.dirty=!1}}const Nj="Framebuffer is not complete";class yv{constructor(o,f,x,b,P){this.context=o,this.width=f,this.height=x;const E=o.gl,F=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new FP(o,F),b)this.depthAttachment=P?new Sj(o,F):new zP(o,F);else if(P)throw new Error("Stencil cannot be set without depth");if(E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error(Nj)}destroy(){const o=this.context.gl,f=this.colorAttachment.get();if(f&&o.deleteTexture(f),this.depthAttachment){const x=this.depthAttachment.get();x&&o.deleteRenderbuffer(x)}o.deleteFramebuffer(this.framebuffer)}}class Ap{constructor(o){var f,x;if(this.gl=o,this.clearColor=new OP(this),this.clearDepth=new IP(this),this.clearStencil=new DP(this),this.colorMask=new xj(this),this.depthMask=new RP(this),this.stencilMask=new yj(this),this.stencilFunc=new bp(this),this.stencilOp=new jp(this),this.stencilTest=new wp(this),this.depthRange=new pv(this),this.depthTest=new yu(this),this.depthFunc=new Mf(this),this.blend=new Fd(this),this.blendFunc=new ao(this),this.blendColor=new vj(this),this.blendEquation=new _j(this),this.cullFace=new gv(this),this.cullFaceSide=new vu(this),this.frontFace=new Sp(this),this.program=new Np(this),this.activeTexture=new Of(this),this.viewport=new Pp(this),this.bindFramebuffer=new bj(this),this.bindRenderbuffer=new zd(this),this.bindTexture=new $d(this),this.bindVertexBuffer=new jj(this),this.bindElementBuffer=new xv(this),this.bindVertexArray=new cn(this),this.pixelStoreUnpack=new Cp(this),this.pixelStoreUnpackPremultiplyAlpha=new LP(this),this.pixelStoreUnpackFlipY=new wj(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),so(o)){this.HALF_FLOAT=o.HALF_FLOAT;const b=o.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(f=o.RGBA16F)!==null&&f!==void 0?f:b==null?void 0:b.RGBA16F_EXT,this.RGB16F=(x=o.RGB16F)!==null&&x!==void 0?x:b==null?void 0:b.RGB16F_EXT,o.getExtension("EXT_color_buffer_float")}else{o.getExtension("EXT_color_buffer_half_float"),o.getExtension("OES_texture_half_float_linear");const b=o.getExtension("OES_texture_half_float");this.HALF_FLOAT=b==null?void 0:b.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,f){return new fv(this,o,f)}createVertexBuffer(o,f,x){return new mv(this,o,f,x)}createRenderbuffer(o,f,x){const b=this.gl,P=b.createRenderbuffer();return this.bindRenderbuffer.set(P),b.renderbufferStorage(b.RENDERBUFFER,o,f,x),this.bindRenderbuffer.set(null),P}createFramebuffer(o,f,x,b){return new yv(this,o,f,x,b)}clear({color:o,depth:f,stencil:x}){const b=this.gl;let P=0;o&&(P|=b.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),f!==void 0&&(P|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),x!==void 0&&(P|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(x),this.stencilMask.set(255)),b.clear(P)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){a.bK(o.blendFunction,jn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}createVertexArray(){var o;return so(this.gl)?this.gl.createVertexArray():(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.createVertexArrayOES()}deleteVertexArray(o){var f;return so(this.gl)?this.gl.deleteVertexArray(o):(f=this.gl.getExtension("OES_vertex_array_object"))===null||f===void 0?void 0:f.deleteVertexArrayOES(o)}unbindVAO(){this.bindVertexArray.set(null)}}let bu;function If(w,o,f,x,b){const P=w.context,E=w.transform,F=P.gl,B=w.useProgram("collisionBox"),W=[];let G=0,Y=0;for(let Se=0;Se<x.length;Se++){const Ee=x[Se],Re=o.getTile(Ee).getBucket(f);if(!Re)continue;const Te=b?Re.textCollisionBox:Re.iconCollisionBox,Le=Re.collisionCircleArray;Le.length>0&&(W.push({circleArray:Le,circleOffset:Y,coord:Ee}),G+=Le.length/4,Y=G),Te&&B.draw(P,F.LINES,Jr.disabled,vn.disabled,w.colorModeForRenderPass(),nn.disabled,dj(w.transform),w.style.map.terrain&&w.style.map.terrain.getTerrainData(Ee),E.getProjectionData({overscaledTileID:Ee,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),f.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,null,w.transform.zoom,null,null,Te.collisionVertexBuffer)}if(!b||!W.length)return;const Z=w.useProgram("collisionCircle"),re=new a.c3;re.resize(4*G),re._trim();let he=0;for(const Se of W)for(let Ee=0;Ee<Se.circleArray.length/4;Ee++){const Re=4*Ee,Te=Se.circleArray[Re+0],Le=Se.circleArray[Re+1],$e=Se.circleArray[Re+2],Ie=Se.circleArray[Re+3];re.emplace(he++,Te,Le,$e,Ie,0),re.emplace(he++,Te,Le,$e,Ie,1),re.emplace(he++,Te,Le,$e,Ie,2),re.emplace(he++,Te,Le,$e,Ie,3)}(!bu||bu.length<2*G)&&(bu=function(Se){const Ee=2*Se,Re=new a.c5;Re.resize(Ee),Re._trim();for(let Te=0;Te<Ee;Te++){const Le=6*Te;Re.uint16[Le+0]=4*Te+0,Re.uint16[Le+1]=4*Te+1,Re.uint16[Le+2]=4*Te+2,Re.uint16[Le+3]=4*Te+2,Re.uint16[Le+4]=4*Te+3,Re.uint16[Le+5]=4*Te+0}return Re}(G));const je=P.createIndexBuffer(bu,!0),we=P.createVertexBuffer(re,a.c4.members,!0);for(const Se of W){const Ee=sv(w.transform);Z.draw(P,F.TRIANGLES,Jr.disabled,vn.disabled,w.colorModeForRenderPass(),nn.disabled,Ee,w.style.map.terrain&&w.style.map.terrain.getTerrainData(Se.coord),null,f.id,we,je,a.aQ.simpleSegment(0,2*Se.circleOffset,Se.circleArray.length,Se.circleArray.length/2),null,w.transform.zoom,null,null,null)}we.destroy(),je.destroy()}const vv=a.am(new Float32Array(16));function Pj(w,o,f,x,b,P){const{horizontalAlign:E,verticalAlign:F}=a.aL(w);return new a.P((-(E-.5)*o/b+x[0])*P,(-(F-.5)*f/b+x[1])*P)}function kp(w,o,f,x,b,P){const E=o.tileAnchorPoint.add(new a.P(o.translation[0],o.translation[1]));if(o.pitchWithMap){let F=x.mult(P);f||(F=F.rotate(-b));const B=E.add(F);return Dt(B.x,B.y,o.pitchedLabelPlaneMatrix,o.getElevation).point}if(f){const F=sl(o.tileAnchorPoint.x+1,o.tileAnchorPoint.y,o).point.sub(w),B=Math.atan(F.y/F.x)+(F.x<0?Math.PI:0);return w.add(x.rotate(B))}return w.add(x)}function Tp(w,o,f,x,b,P,E,F,B,W,G,Y){const Z=w.text.placedSymbolArray,re=w.text.dynamicLayoutVertexArray,he=w.icon.dynamicLayoutVertexArray,je={};re.clear();for(let we=0;we<Z.length;we++){const Se=Z.get(we),Ee=Se.hidden||!Se.crossTileID||w.allowVerticalPlacement&&!Se.placedOrientation?null:x[Se.crossTileID];if(Ee){const Re=new a.P(Se.anchorX,Se.anchorY),Te={getElevation:Y,width:b.width,height:b.height,pitchedLabelPlaneMatrix:P,pitchWithMap:f,transform:b,tileAnchorPoint:Re,translation:W,unwrappedTileID:G},Le=f?xf(Re.x,Re.y,Te):sl(Re.x,Re.y,Te),$e=Kr(b.cameraToCenterDistance,Le.signedDistanceFromCamera);let Ie=a.at(w.textSizeData,F,Se)*$e/a.aF;f&&(Ie*=w.tilePixelRatio/E);const{width:Ke,height:ut,anchor:st,textOffset:ot,textBoxScale:dt}=Ee,kt=Pj(st,Ke,ut,ot,dt,Ie),Et=b.getPitchedTextCorrection(Re.x+W[0],Re.y+W[1],G),bt=kp(Le.point,Te,o,kt,-b.bearingInRadians,Et),rr=w.allowVerticalPlacement&&Se.placedOrientation===a.as.vertical?Math.PI/2:0;for(let Wr=0;Wr<Se.numGlyphs;Wr++)a.az(re,bt,rr);B&&Se.associatedIconIndex>=0&&(je[Se.associatedIconIndex]={shiftedAnchor:bt,angle:rr})}else Cd(Se.numGlyphs,re)}if(B){he.clear();const we=w.icon.placedSymbolArray;for(let Se=0;Se<we.length;Se++){const Ee=we.get(Se);if(Ee.hidden)Cd(Ee.numGlyphs,he);else{const Re=je[Se];if(Re)for(let Te=0;Te<Ee.numGlyphs;Te++)a.az(he,Re.shiftedAnchor,Re.angle);else Cd(Ee.numGlyphs,he)}}w.icon.dynamicLayoutVertexBuffer.updateData(he)}w.text.dynamicLayoutVertexBuffer.updateData(re)}function Ep(w,o,f){return f.iconsInText&&o?"symbolTextAndIcon":w?"symbolSDF":"symbolIcon"}function ju(w,o,f,x,b,P,E,F,B,W,G,Y,Z){const re=w.context,he=re.gl,je=w.transform,we=F==="map",Se=B==="map",Ee=F!=="viewport"&&f.layout.get("symbol-placement")!=="point",Re=we&&!Se&&!Ee,Te=!f.layout.get("symbol-sort-key").isConstant();let Le=!1;const $e=w.getDepthModeForSublayer(0,Jr.ReadOnly),Ie=f._unevaluatedLayout.hasValue("text-variable-anchor")||f._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ke=[],ut=je.getCircleRadiusCorrection();for(const st of x){const ot=o.getTile(st),dt=ot.getBucket(f);if(!dt)continue;const kt=b?dt.text:dt.icon;if(!kt||!kt.segments.get().length||!kt.hasVisibleVertices)continue;const Et=kt.programConfigurations.get(f.id),bt=b||dt.sdfIcons,rr=b?dt.textSizeData:dt.iconSizeData,Wr=Se||je.pitch!==0,On=w.useProgram(Ep(bt,b,dt),Et),Hr=a.ar(rr,je.zoom),qn=w.style.map.terrain&&w.style.map.terrain.getTerrainData(st);let ds,Kn,ri,ns,gi=[0,0],ss=null;if(b)Kn=ot.glyphAtlasTexture,ri=he.LINEAR,ds=ot.glyphAtlasTexture.size,dt.iconsInText&&(gi=ot.imageAtlasTexture.size,ss=ot.imageAtlasTexture,ns=Wr||w.options.rotating||w.options.zooming||rr.kind==="composite"||rr.kind==="camera"?he.LINEAR:he.NEAREST);else{const Ws=f.layout.get("icon-size").constantOr(0)!==1||dt.iconsNeedLinear;Kn=ot.imageAtlasTexture,ri=bt||w.options.rotating||w.options.zooming||Ws||Wr?he.LINEAR:he.NEAREST,ds=ot.imageAtlasTexture.size}const Us=a.aG(ot,1,w.transform.zoom),ha=la(we,w.transform,Us),Au=a.M();a.au(Au,ha);const ql=Pd(Se,we,w.transform,Us),cl=a.aH(je,ot,P,E),ku=je.getProjectionData({overscaledTileID:st,applyGlobeMatrix:!Z,applyTerrainMatrix:!0}),Hd=Ie&&dt.hasTextData(),Tu=f.layout.get("icon-text-fit")!=="none"&&Hd&&dt.hasIconData();if(Ee){const Ws=w.style.map.terrain?(xi,Jn)=>w.style.map.terrain.getElevation(st,xi,Jn):null,Os=f.layout.get("text-rotation-alignment")==="map";Po(dt,w,b,ha,Au,Se,W,Os,st.toUnwrapped(),je.width,je.height,cl,Ws)}const Sa=b&&Ie||Tu,fa=Ee||Sa?vv:Se?ha:w.transform.clipSpaceToPixelsMatrix,Vl=bt&&f.paint.get(b?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let kc;kc=bt?dt.iconsInText?Rl(rr.kind,Hr,Re,Se,Ee,Sa,w,fa,ql,cl,ds,gi,ut):Ef(rr.kind,Hr,Re,Se,Ee,Sa,w,fa,ql,cl,b,ds,0,ut):uv(rr.kind,Hr,Re,Se,Ee,Sa,w,fa,ql,cl,b,ds,ut);const Wf={program:On,buffers:kt,uniformValues:kc,projectionData:ku,atlasTexture:Kn,atlasTextureIcon:ss,atlasInterpolation:ri,atlasInterpolationIcon:ns,isSDF:bt,hasHalo:Vl};if(Te&&dt.canOverlap){Le=!0;const Ws=kt.segments.get();for(const Os of Ws)Ke.push({segments:new a.aQ([Os]),sortKey:Os.sortKey,state:Wf,terrainData:qn})}else Ke.push({segments:kt.segments,sortKey:0,state:Wf,terrainData:qn})}Le&&Ke.sort((st,ot)=>st.sortKey-ot.sortKey);for(const st of Ke){const ot=st.state;if(re.activeTexture.set(he.TEXTURE0),ot.atlasTexture.bind(ot.atlasInterpolation,he.CLAMP_TO_EDGE),ot.atlasTextureIcon&&(re.activeTexture.set(he.TEXTURE1),ot.atlasTextureIcon&&ot.atlasTextureIcon.bind(ot.atlasInterpolationIcon,he.CLAMP_TO_EDGE)),ot.isSDF){const dt=ot.uniformValues;ot.hasHalo&&(dt.u_is_halo=1,Mp(ot.buffers,st.segments,f,w,ot.program,$e,G,Y,dt,ot.projectionData,st.terrainData)),dt.u_is_halo=0}Mp(ot.buffers,st.segments,f,w,ot.program,$e,G,Y,ot.uniformValues,ot.projectionData,st.terrainData)}}function Mp(w,o,f,x,b,P,E,F,B,W,G){const Y=x.context;b.draw(Y,Y.gl.TRIANGLES,P,E,F,nn.backCCW,B,G,W,f.id,w.layoutVertexBuffer,w.indexBuffer,o,f.paint,x.transform.zoom,w.programConfigurations.get(f.id),w.dynamicLayoutVertexBuffer,w.opacityVertexBuffer)}function $P(w,o,f,x,b){const P=w.context,E=P.gl,F=vn.disabled,B=new jn([E.ONE,E.ONE],a.bi.transparent,[!0,!0,!0,!0]),W=o.getBucket(f);if(!W)return;const G=x.key;let Y=f.heatmapFbos.get(G);Y||(Y=Cj(P,o.tileSize,o.tileSize),f.heatmapFbos.set(G,Y)),P.bindFramebuffer.set(Y.framebuffer),P.viewport.set([0,0,o.tileSize,o.tileSize]),P.clear({color:a.bi.transparent});const Z=W.programConfigurations.get(f.id),re=w.useProgram("heatmap",Z,!b),he=w.transform.getProjectionData({overscaledTileID:o.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),je=w.style.map.terrain.getTerrainData(x);re.draw(P,E.TRIANGLES,Jr.disabled,F,B,nn.disabled,av(o,w.transform.zoom,f.paint.get("heatmap-intensity"),1),je,he,f.id,W.layoutVertexBuffer,W.indexBuffer,W.segments,f.paint,w.transform.zoom,Z)}function Df(w,o,f,x,b){const P=w.context,E=P.gl,F=w.transform;P.setColorMode(w.colorModeForRenderPass());const B=_v(P,o),W=f.key,G=o.heatmapFbos.get(W);if(!G)return;P.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,G.colorAttachment.get()),P.activeTexture.set(E.TEXTURE1),B.bind(E.LINEAR,E.CLAMP_TO_EDGE);const Y=F.getProjectionData({overscaledTileID:f,applyTerrainMatrix:b,applyGlobeMatrix:!x});w.useProgram("heatmapTexture").draw(P,E.TRIANGLES,Jr.disabled,vn.disabled,w.colorModeForRenderPass(),nn.disabled,ov(w,o,0,1),null,Y,o.id,w.rasterBoundsBuffer,w.quadTriangleIndexBuffer,w.rasterBoundsSegments,o.paint,F.zoom),G.destroy(),o.heatmapFbos.delete(W)}function Cj(w,o,f){var x,b;const P=w.gl,E=P.createTexture();P.bindTexture(P.TEXTURE_2D,E),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_S,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_T,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MIN_FILTER,P.LINEAR),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MAG_FILTER,P.LINEAR);const F=(x=w.HALF_FLOAT)!==null&&x!==void 0?x:P.UNSIGNED_BYTE,B=(b=w.RGBA16F)!==null&&b!==void 0?b:P.RGBA;P.texImage2D(P.TEXTURE_2D,0,B,o,f,0,P.RGBA,F,null);const W=w.createFramebuffer(o,f,!1,!1);return W.colorAttachment.set(E),W}function _v(w,o){return o.colorRampTexture||(o.colorRampTexture=new a.T(w,o.colorRamp,w.gl.RGBA)),o.colorRampTexture}function Rf(w,o,f,x,b,P,E,F){let B=256;if(b.stepInterpolant){const W=o.getSource().maxzoom,G=E.canonical.z===W?Math.ceil(1<<w.transform.maxZoom-E.canonical.z):1;B=a.ai(a.c7(P.maxLineLength/a.a3*1024*G),256,f.maxTextureSize)}return F.gradient=a.c8({expression:b.gradientExpression(),evaluationKey:"lineProgress",resolution:B,image:F.gradient||void 0,clips:P.lineClipsArray}),F.texture?F.texture.update(F.gradient):F.texture=new a.T(f,F.gradient,x.RGBA),F.version=b.gradientVersion,F.texture}function bv(w,o,f,x,b){w.activeTexture.set(o.TEXTURE0),f.imageAtlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE),x.updatePaintBuffers(b)}function Aj(w,o,f,x,b,P){(b||w.lineAtlas.dirty)&&(o.activeTexture.set(f.TEXTURE0),w.lineAtlas.bind(o)),x.updatePaintBuffers(P)}function kj(w,o,f,x,b,P,E){const F=P.gradients[b.id];let B=F.texture;b.gradientVersion!==F.version&&(B=Rf(w,o,f,x,b,P,E,F)),f.activeTexture.set(x.TEXTURE0),B.bind(b.stepInterpolant?x.NEAREST:x.LINEAR,x.CLAMP_TO_EDGE)}function Op(w,o,f,x,b,P,E,F,B){const W=P.gradients[b.id];let G=W.texture;b.gradientVersion!==W.version&&(G=Rf(w,o,f,x,b,P,E,W)),f.activeTexture.set(x.TEXTURE0),G.bind(b.stepInterpolant?x.NEAREST:x.LINEAR,x.CLAMP_TO_EDGE),f.activeTexture.set(x.TEXTURE1),w.lineAtlas.bind(f),F.updatePaintBuffers(B)}function Ip(w,o,f,x,b){if(!f||!x||!x.imageAtlas)return;const P=x.imageAtlas.patternPositions;let E=P[f.to.toString()],F=P[f.from.toString()];if(!E&&F&&(E=F),!F&&E&&(F=E),!E||!F){const B=b.getPaintProperty(o);E=P[B],F=P[B]}E&&F&&w.setConstantPatternPositions(E,F)}function Tj(w,o,f,x,b,P,E,F){const B=w.context.gl,W="fill-pattern",G=f.paint.get(W),Y=G&&G.constantOr(1),Z=f.getCrossfadeParameters();let re,he,je,we,Se;const Ee=w.transform,Re=f.paint.get("fill-translate"),Te=f.paint.get("fill-translate-anchor");E?(he=Y&&!f.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",re=B.LINES):(he=Y?"fillPattern":"fill",re=B.TRIANGLES);const Le=G.constantOr(null);for(const $e of x){const Ie=o.getTile($e);if(Y&&!Ie.patternsLoaded())continue;const Ke=Ie.getBucket(f);if(!Ke)continue;const ut=Ke.programConfigurations.get(f.id),st=w.useProgram(he,ut),ot=w.style.map.terrain&&w.style.map.terrain.getTerrainData($e);Y&&(w.context.activeTexture.set(B.TEXTURE0),Ie.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),ut.updatePaintBuffers(Z)),Ip(ut,W,Le,Ie,f);const dt=Ee.getProjectionData({overscaledTileID:$e,applyGlobeMatrix:!F,applyTerrainMatrix:!0}),kt=a.aH(Ee,Ie,Re,Te);if(E){we=Ke.indexBuffer2,Se=Ke.segments2;const bt=[B.drawingBufferWidth,B.drawingBufferHeight];je=he==="fillOutlinePattern"&&Y?uj(w,Z,Ie,bt,kt):AP(bt,kt)}else we=Ke.indexBuffer,Se=Ke.segments,je=Y?pu(w,Z,Ie,kt):{u_fill_translate:kt};const Et=w.stencilModeForClipping($e);st.draw(w.context,re,b,Et,P,nn.backCCW,je,ot,dt,f.id,Ke.layoutVertexBuffer,we,Se,f.paint,w.transform.zoom,ut)}}function Dp(w,o,f,x,b,P,E,F){const B=w.context,W=B.gl,G="fill-extrusion-pattern",Y=f.paint.get(G),Z=Y.constantOr(1),re=f.getCrossfadeParameters(),he=f.paint.get("fill-extrusion-opacity"),je=Y.constantOr(null),we=w.transform;for(const Se of x){const Ee=o.getTile(Se),Re=Ee.getBucket(f);if(!Re)continue;const Te=w.style.map.terrain&&w.style.map.terrain.getTerrainData(Se),Le=Re.programConfigurations.get(f.id),$e=w.useProgram(Z?"fillExtrusionPattern":"fillExtrusion",Le);Z&&(w.context.activeTexture.set(W.TEXTURE0),Ee.imageAtlasTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),Le.updatePaintBuffers(re));const Ie=we.getProjectionData({overscaledTileID:Se,applyGlobeMatrix:!F,applyTerrainMatrix:!0});Ip(Le,G,je,Ee,f);const Ke=a.aH(we,Ee,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),ut=f.paint.get("fill-extrusion-vertical-gradient"),st=Z?CP(w,ut,he,Ke,Se,re,Ee):Tf(w,ut,he,Ke);$e.draw(B,B.gl.TRIANGLES,b,P,E,nn.backCCW,st,Te,Ie,f.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,f.paint,w.transform.zoom,Le,w.style.map.terrain&&Re.centroidVertexBuffer)}}function cs(w,o,f,x,b,P,E,F,B){var W;const G=w.style.projection,Y=w.context,Z=w.transform,re=Y.gl,he=[`#define NUM_ILLUMINATION_SOURCES ${f.paint.get("hillshade-highlight-color").values.length}`],je=w.useProgram("hillshade",null,!1,he),we=!w.options.moving;for(const Se of x){const Ee=o.getTile(Se),Re=Ee.fbo;if(!Re)continue;const Te=G.getMeshFromTileID(Y,Se.canonical,F,!0,"raster"),Le=(W=w.style.map.terrain)===null||W===void 0?void 0:W.getTerrainData(Se);Y.activeTexture.set(re.TEXTURE0),re.bindTexture(re.TEXTURE_2D,Re.colorAttachment.get());const $e=Z.getProjectionData({overscaledTileID:Se,aligned:we,applyGlobeMatrix:!B,applyTerrainMatrix:!0});je.draw(Y,re.TRIANGLES,P,b[Se.overscaledZ],E,nn.backCCW,hj(w,Ee,f),Le,$e,f.id,Te.vertexBuffer,Te.indexBuffer,Te.segments)}}function Ll(w,o,f,x,b,P,E,F,B){var W;const G=w.style.projection,Y=w.context,Z=w.transform,re=Y.gl,he=w.useProgram("colorRelief"),je=!w.options.moving;let we=!0,Se=0;for(const Ee of x){const Re=o.getTile(Ee),Te=Re.dem;if(we){const st=re.getParameter(re.MAX_TEXTURE_SIZE),{elevationTexture:ot,colorTexture:dt}=f.getColorRampTextures(Y,st,Te.getUnpackVector());Y.activeTexture.set(re.TEXTURE1),ot.bind(re.NEAREST,re.CLAMP_TO_EDGE),Y.activeTexture.set(re.TEXTURE4),dt.bind(re.LINEAR,re.CLAMP_TO_EDGE),we=!1,Se=ot.size[0]}if(!Te||!Te.data)continue;const Le=Te.stride,$e=Te.getPixels();if(Y.activeTexture.set(re.TEXTURE0),Y.pixelStoreUnpackPremultiplyAlpha.set(!1),Re.demTexture=Re.demTexture||w.getTileTexture(Le),Re.demTexture){const st=Re.demTexture;st.update($e,{premultiply:!1}),st.bind(re.LINEAR,re.CLAMP_TO_EDGE)}else Re.demTexture=new a.T(Y,$e,re.RGBA,{premultiply:!1}),Re.demTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE);const Ie=G.getMeshFromTileID(Y,Ee.canonical,F,!0,"raster"),Ke=(W=w.style.map.terrain)===null||W===void 0?void 0:W.getTerrainData(Ee),ut=Z.getProjectionData({overscaledTileID:Ee,aligned:je,applyGlobeMatrix:!B,applyTerrainMatrix:!0});he.draw(Y,re.TRIANGLES,P,b[Ee.overscaledZ],E,nn.backCCW,mj(f,Re.dem,Se),Ke,ut,f.id,Ie.vertexBuffer,Ie.indexBuffer,Ie.segments)}}const ja=[new a.P(0,0),new a.P(a.a3,0),new a.P(a.a3,a.a3),new a.P(0,a.a3)];function Bd(w,o,f,x,b,P,E,F,B=!1,W=!1){const G=x[x.length-1].overscaledZ,Y=w.context,Z=Y.gl,re=w.useProgram("raster"),he=w.transform,je=w.style.projection,we=w.colorModeForRenderPass(),Se=!w.options.moving,Ee=f.paint.get("raster-opacity"),Re=f.paint.get("raster-resampling"),Te=f.paint.get("raster-fade-duration"),Le=!!w.style.map.terrain;for(const $e of x){const Ie=w.getDepthModeForSublayer($e.overscaledZ-G,Ee===1?Jr.ReadWrite:Jr.ReadOnly,Z.LESS),Ke=o.getTile($e),ut=Re==="nearest"?Z.NEAREST:Z.LINEAR;Y.activeTexture.set(Z.TEXTURE0),Ke.texture.bind(ut,Z.CLAMP_TO_EDGE,Z.LINEAR_MIPMAP_NEAREST),Y.activeTexture.set(Z.TEXTURE1);const{parentTile:st,parentScaleBy:ot,parentTopLeft:dt,fadeValues:kt}=Rp(Ke,o,Te,Le);Ke.fadeOpacity=kt.tileOpacity,st?(st.fadeOpacity=kt.parentTileOpacity,st.texture.bind(ut,Z.CLAMP_TO_EDGE,Z.LINEAR_MIPMAP_NEAREST)):Ke.texture.bind(ut,Z.CLAMP_TO_EDGE,Z.LINEAR_MIPMAP_NEAREST),Ke.texture.useMipmap&&Y.extTextureFilterAnisotropic&&w.transform.pitch>20&&Z.texParameterf(Z.TEXTURE_2D,Y.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Y.extTextureFilterAnisotropicMax);const Et=w.style.map.terrain&&w.style.map.terrain.getTerrainData($e),bt=he.getProjectionData({overscaledTileID:$e,aligned:Se,applyGlobeMatrix:!W,applyTerrainMatrix:!0}),rr=pj(dt,ot,kt.fadeMix,f,F),Wr=je.getMeshFromTileID(Y,$e.canonical,P,E,"raster");re.draw(Y,Z.TRIANGLES,Ie,b?b[$e.overscaledZ]:vn.disabled,we,B?nn.frontCCW:nn.backCCW,rr,Et,bt,f.id,Wr.vertexBuffer,Wr.indexBuffer,Wr.segments)}}function Rp(w,o,f,x){const b={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(f===0||x)return b;if(w.fadingParentID){const P=o.getLoadedTile(w.fadingParentID);if(!P)return b;const E=Math.pow(2,P.tileID.overscaledZ-w.tileID.overscaledZ),F=[w.tileID.canonical.x*E%1,w.tileID.canonical.y*E%1],B=function(W,G,Y){const Z=k(),re=(Z-G.timeAdded)/Y,he=W.fadingDirection===Ae.Incoming,je=a.ai((Z-W.timeAdded)/Y,0,1),we=a.ai(1-re,0,1),Se=he?je:we;return{tileOpacity:Se,parentTileOpacity:he?we:je,fadeMix:{opacity:1,mix:1-Se}}}(w,P,f);return{parentTile:P,parentScaleBy:E,parentTopLeft:F,fadeValues:B}}if(w.selfFading){const P=function(E,F){const B=(k()-E.timeAdded)/F,W=a.ai(B,0,1);return{tileOpacity:W,fadeMix:{opacity:W,mix:0}}}(w,f);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:P}}return b}const Ej=new a.bi(1,0,0,1),qd=new a.bi(0,1,0,1),jv=new a.bi(0,0,1,1),Lf=new a.bi(1,0,1,1),wv=new a.bi(0,1,1,1);function Sv(w,o,f,x){Ff(w,0,o+f/2,w.transform.width,f,x)}function Nv(w,o,f,x){Ff(w,o-f/2,0,f,w.transform.height,x)}function Ff(w,o,f,x,b,P){const E=w.context,F=E.gl;F.enable(F.SCISSOR_TEST),F.scissor(o*w.pixelRatio,f*w.pixelRatio,x*w.pixelRatio,b*w.pixelRatio),E.clear({color:P}),F.disable(F.SCISSOR_TEST)}function Mj(w,o,f){const x=w.context,b=x.gl,P=w.useProgram("debug"),E=Jr.disabled,F=vn.disabled,B=w.colorModeForRenderPass(),W="$debug",G=w.style.map.terrain&&w.style.map.terrain.getTerrainData(f);x.activeTexture.set(b.TEXTURE0);const Y=o.getTileByID(f.key).latestRawTileData,Z=Math.floor((Y&&Y.byteLength||0)/1024),re=o.getTile(f).tileSize,he=512/Math.min(re,512)*(f.overscaledZ/w.transform.zoom)*.5;let je=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(je+=` => ${f.overscaledZ}`),function(Se,Ee){Se.initDebugOverlayCanvas();const Re=Se.debugOverlayCanvas,Te=Se.context.gl,Le=Se.debugOverlayCanvas.getContext("2d");Le.clearRect(0,0,Re.width,Re.height),Le.shadowColor="white",Le.shadowBlur=2,Le.lineWidth=1.5,Le.strokeStyle="white",Le.textBaseline="top",Le.font="bold 36px Open Sans, sans-serif",Le.fillText(Ee,5,5),Le.strokeText(Ee,5,5),Se.debugOverlayTexture.update(Re),Se.debugOverlayTexture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE)}(w,`${je} ${Z}kB`);const we=w.transform.getProjectionData({overscaledTileID:f,applyGlobeMatrix:!0,applyTerrainMatrix:!0});P.draw(x,b.TRIANGLES,E,F,jn.alphaBlended,nn.disabled,iv(a.bi.transparent,he),null,we,W,w.debugBuffer,w.quadTriangleIndexBuffer,w.debugSegments),P.draw(x,b.LINE_STRIP,E,F,B,nn.disabled,iv(a.bi.red),G,we,W,w.debugBuffer,w.tileBorderIndexBuffer,w.debugSegments)}function Pv(w,o,f,x){const{isRenderingGlobe:b}=x,P=w.context,E=P.gl,F=w.transform,B=w.colorModeForRenderPass(),W=w.getDepthModeFor3D(),G=w.useProgram("terrain");P.bindFramebuffer.set(null),P.viewport.set([0,0,w.width,w.height]);for(const Y of f){const Z=o.getTerrainMesh(Y.tileID),re=w.renderToTexture.getTexture(Y),he=o.getTerrainData(Y.tileID);P.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,re.texture);const je=o.getMeshFrameDelta(F.zoom),we=F.calculateFogMatrix(Y.tileID.toUnwrapped()),Se=PP(je,we,w.style.sky,F.pitch,b),Ee=F.getProjectionData({overscaledTileID:Y.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});G.draw(P,E.TRIANGLES,W,vn.disabled,B,nn.backCCW,Se,he,Ee,"terrain",Z.vertexBuffer,Z.indexBuffer,Z.segments)}}function Ac(w,o){if(!o.mesh){const f=new a.aP;f.emplaceBack(-1,-1),f.emplaceBack(1,-1),f.emplaceBack(1,1),f.emplaceBack(-1,1);const x=new a.aR;x.emplaceBack(0,1,2),x.emplaceBack(0,2,3),o.mesh=new Md(w.createVertexBuffer(f,il.members),w.createIndexBuffer(x),a.aQ.simpleSegment(0,0,f.length,x.length))}return o.mesh}class Oj{constructor(o,f){this.context=new Ap(o),this.transform=f,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.am(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=kn.maxUnderzooming+kn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Il}resize(o,f,x){if(this.width=Math.floor(o*x),this.height=Math.floor(f*x),this.pixelRatio=x,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const b of this.style._order)this.style._layers[b].resize()}setup(){const o=this.context,f=new a.aP;f.emplaceBack(0,0),f.emplaceBack(a.a3,0),f.emplaceBack(0,a.a3),f.emplaceBack(a.a3,a.a3),this.tileExtentBuffer=o.createVertexBuffer(f,il.members),this.tileExtentSegments=a.aQ.simpleSegment(0,0,4,2);const x=new a.aP;x.emplaceBack(0,0),x.emplaceBack(a.a3,0),x.emplaceBack(0,a.a3),x.emplaceBack(a.a3,a.a3),this.debugBuffer=o.createVertexBuffer(x,il.members),this.debugSegments=a.aQ.simpleSegment(0,0,4,5);const b=new a.ca;b.emplaceBack(0,0,0,0),b.emplaceBack(a.a3,0,a.a3,0),b.emplaceBack(0,a.a3,0,a.a3),b.emplaceBack(a.a3,a.a3,a.a3,a.a3),this.rasterBoundsBuffer=o.createVertexBuffer(b,rv.members),this.rasterBoundsSegments=a.aQ.simpleSegment(0,0,4,2);const P=new a.aP;P.emplaceBack(0,0),P.emplaceBack(a.a3,0),P.emplaceBack(0,a.a3),P.emplaceBack(a.a3,a.a3),this.rasterBoundsBufferPosOnly=o.createVertexBuffer(P,il.members),this.rasterBoundsSegmentsPosOnly=a.aQ.simpleSegment(0,0,4,5);const E=new a.aP;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(E,il.members),this.viewportSegments=a.aQ.simpleSegment(0,0,4,2);const F=new a.cb;F.emplaceBack(0),F.emplaceBack(1),F.emplaceBack(3),F.emplaceBack(2),F.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(F);const B=new a.aR;B.emplaceBack(1,0,2),B.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(B);const W=this.context.gl;this.stencilClearMode=new vn({func:W.ALWAYS,mask:0},0,255,W.ZERO,W.ZERO,W.ZERO),this.tileExtentMesh=new Md(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const o=this.context,f=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const x=a.M();a.c0(x,0,this.width,this.height,0,0,1),a.O(x,x,[f.drawingBufferWidth,f.drawingBufferHeight,0]);const b={mainMatrix:x,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:x};this.useProgram("clippingMask",null,!0).draw(o,f.TRIANGLES,Jr.disabled,this.stencilClearMode,jn.disabled,nn.disabled,null,null,b,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,f,x){if(this.currentStencilSource===o.source||!o.isTileClipped()||!f||!f.length)return;this.currentStencilSource=o.source,this.nextStencilID+f.length>256&&this.clearStencil();const b=this.context;b.setColorMode(jn.disabled),b.setDepthMode(Jr.disabled);const P={};for(const E of f)P[E.key]=this.nextStencilID++;this._renderTileMasks(P,f,x,!0),this._renderTileMasks(P,f,x,!1),this._tileClippingMaskIDs=P}_renderTileMasks(o,f,x,b){const P=this.context,E=P.gl,F=this.style.projection,B=this.transform,W=this.useProgram("clippingMask");for(const G of f){const Y=o[G.key],Z=this.style.map.terrain&&this.style.map.terrain.getTerrainData(G),re=F.getMeshFromTileID(this.context,G.canonical,b,!0,"stencil"),he=B.getProjectionData({overscaledTileID:G,applyGlobeMatrix:!x,applyTerrainMatrix:!0});W.draw(P,E.TRIANGLES,Jr.disabled,new vn({func:E.ALWAYS,mask:0},Y,255,E.KEEP,E.KEEP,E.REPLACE),jn.disabled,x?nn.disabled:nn.backCCW,null,Z,he,"$clipping",re.vertexBuffer,re.indexBuffer,re.segments)}}_renderTilesDepthBuffer(){const o=this.context,f=o.gl,x=this.style.projection,b=this.transform,P=this.useProgram("depth"),E=this.getDepthModeFor3D(),F=Nn(b,{tileSize:b.tileSize});for(const B of F){const W=this.style.map.terrain&&this.style.map.terrain.getTerrainData(B),G=x.getMeshFromTileID(this.context,B.canonical,!0,!0,"raster"),Y=b.getProjectionData({overscaledTileID:B,applyGlobeMatrix:!0,applyTerrainMatrix:!0});P.draw(o,f.TRIANGLES,E,vn.disabled,jn.disabled,nn.backCCW,null,W,Y,"$clipping",G.vertexBuffer,G.indexBuffer,G.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,f=this.context.gl;return new vn({func:f.NOTEQUAL,mask:255},o,255,f.KEEP,f.KEEP,f.REPLACE)}stencilModeForClipping(o){const f=this.context.gl;return new vn({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,f.KEEP,f.KEEP,f.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(o){const f=this.context.gl,x=o.sort((E,F)=>F.overscaledZ-E.overscaledZ),b=x[x.length-1].overscaledZ,P=x[0].overscaledZ-b+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();const E={};for(let F=0;F<P;F++)E[F+b]=new vn({func:f.GEQUAL,mask:255},F+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=P,[E,x]}return[{[b]:vn.disabled},x]}stencilConfigForOverlapTwoPass(o){const f=this.context.gl,x=o.sort((E,F)=>F.overscaledZ-E.overscaledZ),b=x[x.length-1].overscaledZ,P=x[0].overscaledZ-b+1;if(this.clearStencil(),P>1){const E={},F={};for(let B=0;B<P;B++)E[B+b]=new vn({func:f.GREATER,mask:255},P+1+B,255,f.KEEP,f.KEEP,f.REPLACE),F[B+b]=new vn({func:f.GREATER,mask:255},1+B,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID=2*P+1,[E,F,x]}return this.nextStencilID=3,[{[b]:new vn({func:f.GREATER,mask:255},2,255,f.KEEP,f.KEEP,f.REPLACE)},{[b]:new vn({func:f.GREATER,mask:255},1,255,f.KEEP,f.KEEP,f.REPLACE)},x]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new jn([o.CONSTANT_COLOR,o.ONE],new a.bi(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?jn.unblended:jn.alphaBlended}getDepthModeForSublayer(o,f,x){if(!this.opaquePassEnabledForLayer())return Jr.disabled;const b=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new Jr(x||this.context.gl.LEQUAL,f,[b,b])}getDepthModeFor3D(){return new Jr(this.context.gl.LEQUAL,Jr.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,f){var x,b;this.style=o,this.options=f,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(k()),this.imageManager.beginFrame();const P=this.style._order,E=this.style.tileManagers,F={},B={},W={},G={isRenderingToTexture:!1,isRenderingGlobe:((x=o.projection)===null||x===void 0?void 0:x.transitionState)>0};for(const Z in E){const re=E[Z];re.used&&re.prepare(this.context),F[Z]=re.getVisibleCoordinates(!1),B[Z]=F[Z].slice().reverse(),W[Z]=re.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Z=0;Z<P.length;Z++)if(this.style._layers[P[Z]].is3D()){this.opaquePassCutoff=Z;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const Z of P){const re=this.style._layers[Z];if(!re.hasOffscreenPass()||re.isHidden(this.transform.zoom))continue;const he=B[re.source];(re.type==="custom"||he.length)&&this.renderLayer(this,E[re.source],re,he,G)}if((b=this.style.projection)===null||b===void 0||b.updateGPUdependent({context:this.context,useProgram:Z=>this.useProgram(Z)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:f.showOverdrawInspector?a.bi.black:a.bi.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(Z,re){const he=Z.context,je=he.gl,we=(($e,Ie,Ke)=>{const ut=Math.cos(Ie.rollInRadians),st=Math.sin(Ie.rollInRadians),ot=yt(Ie),dt=Ie.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:$e.properties.get("sky-color"),u_horizon_color:$e.properties.get("horizon-color"),u_horizon:[(Ie.width/2-ot*st)*Ke,(Ie.height/2+ot*ut)*Ke],u_horizon_normal:[-st,ut],u_sky_horizon_blend:$e.properties.get("sky-horizon-blend")*Ie.height/2*Ke,u_sky_blend:dt}})(re,Z.style.map.transform,Z.pixelRatio),Se=new Jr(je.LEQUAL,Jr.ReadWrite,[0,1]),Ee=vn.disabled,Re=Z.colorModeForRenderPass(),Te=Z.useProgram("sky"),Le=Ac(he,re);Te.draw(he,je.TRIANGLES,Se,Ee,Re,nn.disabled,we,null,void 0,"sky",Le.vertexBuffer,Le.indexBuffer,Le.segments)}(this,this.style.sky),this._showOverdrawInspector=f.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=P.length-1;this.currentLayer>=0;this.currentLayer--){const Z=this.style._layers[P[this.currentLayer]],re=E[Z.source],he=F[Z.source];this._renderTileClippingMasks(Z,he,!1),this.renderLayer(this,re,Z,he,G)}this.renderPass="translucent";let Y=!1;for(this.currentLayer=0;this.currentLayer<P.length;this.currentLayer++){const Z=this.style._layers[P[this.currentLayer]],re=E[Z.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(Z,G))continue;this.opaquePassEnabledForLayer()||Y||(Y=!0,G.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const he=(Z.type==="symbol"?W:B)[Z.source];this._renderTileClippingMasks(Z,F[Z.source],!!this.renderToTexture),this.renderLayer(this,re,Z,he,G)}if(G.isRenderingGlobe&&function(Z,re,he){const je=Z.context,we=je.gl,Se=Z.useProgram("atmosphere"),Ee=new Jr(we.LEQUAL,Jr.ReadOnly,[0,1]),Re=Z.transform,Te=function(dt,kt){const Et=dt.properties.get("position"),bt=[-Et.x,-Et.y,-Et.z],rr=a.am(new Float64Array(16));return dt.properties.get("anchor")==="map"&&(a.b9(rr,rr,kt.rollInRadians),a.ba(rr,rr,-kt.pitchInRadians),a.b9(rr,rr,kt.bearingInRadians),a.ba(rr,rr,kt.center.lat*Math.PI/180),a.bC(rr,rr,-kt.center.lng*Math.PI/180)),a.c9(bt,bt,rr),bt}(he,Z.transform),Le=Re.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),$e=re.properties.get("atmosphere-blend")*Le.projectionTransition;if($e===0)return;const Ie=Nf(Re.worldSize,Re.center.lat),Ke=Re.inverseProjectionMatrix,ut=new Float64Array(4);ut[3]=1,a.aA(ut,ut,Re.modelViewProjectionMatrix),ut[0]/=ut[3],ut[1]/=ut[3],ut[2]/=ut[3],ut[3]=1,a.aA(ut,ut,Ke),ut[0]/=ut[3],ut[1]/=ut[3],ut[2]/=ut[3],ut[3]=1;const st=((dt,kt,Et,bt,rr)=>({u_sun_pos:dt,u_atmosphere_blend:kt,u_globe_position:Et,u_globe_radius:bt,u_inv_proj_matrix:rr}))(Te,$e,[ut[0],ut[1],ut[2]],Ie,Ke),ot=Ac(je,re);Se.draw(je,we.TRIANGLES,Ee,vn.disabled,jn.alphaBlended,nn.disabled,st,null,null,"atmosphere",ot.vertexBuffer,ot.indexBuffer,ot.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const Z=function(re,he){let je=null;const we=Object.values(re._layers).flatMap(Te=>Te.source&&!Te.isHidden(he)?[re.tileManagers[Te.source]]:[]),Se=we.filter(Te=>Te.getSource().type==="vector"),Ee=we.filter(Te=>Te.getSource().type!=="vector"),Re=Te=>{(!je||je.getSource().maxzoom<Te.getSource().maxzoom)&&(je=Te)};return Se.forEach(Te=>Re(Te)),je||Ee.forEach(Te=>Re(Te)),je}(this.style,this.transform.zoom);Z&&function(re,he,je){for(let we=0;we<je.length;we++)Mj(re,he,je[we])}(this,Z,Z.getVisibleCoordinates())}this.options.showPadding&&function(Z){const re=Z.transform.padding;Sv(Z,Z.transform.height-(re.top||0),3,Ej),Sv(Z,re.bottom||0,3,qd),Nv(Z,re.left||0,3,jv),Nv(Z,Z.transform.width-(re.right||0),3,Lf);const he=Z.transform.centerPoint;(function(je,we,Se,Ee){Ff(je,we-1,Se-10,2,20,Ee),Ff(je,we-10,Se-1,20,2,Ee)})(Z,he.x,Z.transform.height-he.y,wv)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(o){if(!this.style||!this.style.map||!this.style.map.terrain)return;const f=this.terrainFacilitator.matrix,x=this.transform.modelViewProjectionMatrix;let b=this.terrainFacilitator.dirty;b||(b=o?!a.cc(f,x):!a.cd(f,x)),b||(b=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),b&&(a.ce(f,x),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(P,E){const F=P.context,B=F.gl,W=P.transform,G=jn.unblended,Y=new Jr(B.LEQUAL,Jr.ReadWrite,[0,1]),Z=E.tileManager.getRenderableTiles(),re=P.useProgram("terrainDepth");F.bindFramebuffer.set(E.getFramebuffer("depth").framebuffer),F.viewport.set([0,0,P.width/devicePixelRatio,P.height/devicePixelRatio]),F.clear({color:a.bi.transparent,depth:1});for(const he of Z){const je=E.getTerrainMesh(he.tileID),we=E.getTerrainData(he.tileID),Se=W.getProjectionData({overscaledTileID:he.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),Ee={u_ele_delta:E.getMeshFrameDelta(W.zoom)};re.draw(F,B.TRIANGLES,Y,vn.disabled,G,nn.backCCW,Ee,we,Se,"terrain",je.vertexBuffer,je.indexBuffer,je.segments)}F.bindFramebuffer.set(null),F.viewport.set([0,0,P.width,P.height])}(this,this.style.map.terrain),function(P,E){const F=P.context,B=F.gl,W=P.transform,G=jn.unblended,Y=new Jr(B.LEQUAL,Jr.ReadWrite,[0,1]),Z=E.getCoordsTexture(),re=E.tileManager.getRenderableTiles(),he=P.useProgram("terrainCoords");F.bindFramebuffer.set(E.getFramebuffer("coords").framebuffer),F.viewport.set([0,0,P.width/devicePixelRatio,P.height/devicePixelRatio]),F.clear({color:a.bi.transparent,depth:1}),E.coordsIndex=[];for(const je of re){const we=E.getTerrainMesh(je.tileID),Se=E.getTerrainData(je.tileID);F.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,Z.texture);const Ee={u_terrain_coords_id:(255-E.coordsIndex.length)/255,u_texture:0,u_ele_delta:E.getMeshFrameDelta(W.zoom)},Re=W.getProjectionData({overscaledTileID:je.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});he.draw(F,B.TRIANGLES,Y,vn.disabled,G,nn.backCCW,Ee,Se,Re,"terrain",we.vertexBuffer,we.indexBuffer,we.segments),E.coordsIndex.push(je.tileID.key)}F.bindFramebuffer.set(null),F.viewport.set([0,0,P.width,P.height])}(this,this.style.map.terrain))}renderLayer(o,f,x,b,P){x.isHidden(this.transform.zoom)||(x.type==="background"||x.type==="custom"||(b||[]).length)&&(this.id=x.id,a.cf(x)?function(E,F,B,W,G,Y){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:Z}=Y,re=vn.disabled,he=E.colorModeForRenderPass();(B._unevaluatedLayout.hasValue("text-variable-anchor")||B._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(je,we,Se,Ee,Re,Te,Le,$e,Ie){const Ke=we.transform,ut=we.style.map.terrain,st=Re==="map",ot=Te==="map";for(const dt of je){const kt=Ee.getTile(dt),Et=kt.getBucket(Se);if(!Et||!Et.text||!Et.text.segments.get().length)continue;const bt=a.ar(Et.textSizeData,Ke.zoom),rr=a.aG(kt,1,we.transform.zoom),Wr=la(st,we.transform,rr),On=Se.layout.get("icon-text-fit")!=="none"&&Et.hasIconData();if(bt){const Hr=Math.pow(2,Ke.zoom-kt.tileID.overscaledZ),qn=ut?(ds,Kn)=>ut.getElevation(dt,ds,Kn):null;Tp(Et,st,ot,Ie,Ke,Wr,Hr,bt,On,a.aH(Ke,kt,Le,$e),dt.toUnwrapped(),qn)}}}(W,E,B,F,B.layout.get("text-rotation-alignment"),B.layout.get("text-pitch-alignment"),B.paint.get("text-translate"),B.paint.get("text-translate-anchor"),G),B.paint.get("icon-opacity").constantOr(1)!==0&&ju(E,F,B,W,!1,B.paint.get("icon-translate"),B.paint.get("icon-translate-anchor"),B.layout.get("icon-rotation-alignment"),B.layout.get("icon-pitch-alignment"),B.layout.get("icon-keep-upright"),re,he,Z),B.paint.get("text-opacity").constantOr(1)!==0&&ju(E,F,B,W,!0,B.paint.get("text-translate"),B.paint.get("text-translate-anchor"),B.layout.get("text-rotation-alignment"),B.layout.get("text-pitch-alignment"),B.layout.get("text-keep-upright"),re,he,Z),F.map.showCollisionBoxes&&(If(E,F,B,W,!0),If(E,F,B,W,!1))}(o,f,x,b,this.style.placement.variableOffsets,P):a.cg(x)?function(E,F,B,W,G){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:Y}=G,Z=B.paint.get("circle-opacity"),re=B.paint.get("circle-stroke-width"),he=B.paint.get("circle-stroke-opacity"),je=!B.layout.get("circle-sort-key").isConstant();if(Z.constantOr(1)===0&&(re.constantOr(1)===0||he.constantOr(1)===0))return;const we=E.context,Se=we.gl,Ee=E.transform,Re=E.getDepthModeForSublayer(0,Jr.ReadOnly),Te=vn.disabled,Le=E.colorModeForRenderPass(),$e=[],Ie=Ee.getCircleRadiusCorrection();for(let Ke=0;Ke<W.length;Ke++){const ut=W[Ke],st=F.getTile(ut),ot=st.getBucket(B);if(!ot)continue;const dt=B.paint.get("circle-translate"),kt=B.paint.get("circle-translate-anchor"),Et=a.aH(Ee,st,dt,kt),bt=ot.programConfigurations.get(B.id),rr=E.useProgram("circle",bt),Wr=ot.layoutVertexBuffer,On=ot.indexBuffer,Hr=E.style.map.terrain&&E.style.map.terrain.getTerrainData(ut),qn={programConfiguration:bt,program:rr,layoutVertexBuffer:Wr,indexBuffer:On,uniformValues:kP(E,st,B,Et,Ie),terrainData:Hr,projectionData:Ee.getProjectionData({overscaledTileID:ut,applyGlobeMatrix:!Y,applyTerrainMatrix:!0})};if(je){const ds=ot.segments.get();for(const Kn of ds)$e.push({segments:new a.aQ([Kn]),sortKey:Kn.sortKey,state:qn})}else $e.push({segments:ot.segments,sortKey:0,state:qn})}je&&$e.sort((Ke,ut)=>Ke.sortKey-ut.sortKey);for(const Ke of $e){const{programConfiguration:ut,program:st,layoutVertexBuffer:ot,indexBuffer:dt,uniformValues:kt,terrainData:Et,projectionData:bt}=Ke.state;st.draw(we,Se.TRIANGLES,Re,Te,Le,nn.backCCW,kt,Et,bt,B.id,ot,dt,Ke.segments,B.paint,E.transform.zoom,ut)}}(o,f,x,b,P):a.ch(x)?function(E,F,B,W,G){if(B.paint.get("heatmap-opacity")===0)return;const Y=E.context,{isRenderingToTexture:Z,isRenderingGlobe:re}=G;if(E.style.map.terrain){for(const he of W){const je=F.getTile(he);F.hasRenderableParent(he)||(E.renderPass==="offscreen"?$P(E,je,B,he,re):E.renderPass==="translucent"&&Df(E,B,he,Z,re))}Y.viewport.set([0,0,E.width,E.height])}else E.renderPass==="offscreen"?function(he,je,we,Se){const Ee=he.context,Re=Ee.gl,Te=he.transform,Le=vn.disabled,$e=new jn([Re.ONE,Re.ONE],a.bi.transparent,[!0,!0,!0,!0]);(function(Ie,Ke,ut){const st=Ie.gl;Ie.activeTexture.set(st.TEXTURE1),Ie.viewport.set([0,0,Ke.width/4,Ke.height/4]);let ot=ut.heatmapFbos.get(a.c6);ot?(st.bindTexture(st.TEXTURE_2D,ot.colorAttachment.get()),Ie.bindFramebuffer.set(ot.framebuffer)):(ot=Cj(Ie,Ke.width/4,Ke.height/4),ut.heatmapFbos.set(a.c6,ot))})(Ee,he,we),Ee.clear({color:a.bi.transparent});for(let Ie=0;Ie<Se.length;Ie++){const Ke=Se[Ie];if(je.hasRenderableParent(Ke))continue;const ut=je.getTile(Ke),st=ut.getBucket(we);if(!st)continue;const ot=st.programConfigurations.get(we.id),dt=he.useProgram("heatmap",ot),kt=Te.getProjectionData({overscaledTileID:Ke,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Et=Te.getCircleRadiusCorrection();dt.draw(Ee,Re.TRIANGLES,Jr.disabled,Le,$e,nn.backCCW,av(ut,Te.zoom,we.paint.get("heatmap-intensity"),Et),null,kt,we.id,st.layoutVertexBuffer,st.indexBuffer,st.segments,we.paint,Te.zoom,ot)}Ee.viewport.set([0,0,he.width,he.height])}(E,F,B,W):E.renderPass==="translucent"&&function(he,je){const we=he.context,Se=we.gl;we.setColorMode(he.colorModeForRenderPass());const Ee=je.heatmapFbos.get(a.c6);Ee&&(we.activeTexture.set(Se.TEXTURE0),Se.bindTexture(Se.TEXTURE_2D,Ee.colorAttachment.get()),we.activeTexture.set(Se.TEXTURE1),_v(we,je).bind(Se.LINEAR,Se.CLAMP_TO_EDGE),he.useProgram("heatmapTexture").draw(we,Se.TRIANGLES,Jr.disabled,vn.disabled,he.colorModeForRenderPass(),nn.disabled,ov(he,je,0,1),null,null,je.id,he.viewportBuffer,he.quadTriangleIndexBuffer,he.viewportSegments,je.paint,he.transform.zoom))}(E,B)}(o,f,x,b,P):a.ci(x)?function(E,F,B,W,G){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:Y}=G,Z=B.paint.get("line-opacity"),re=B.paint.get("line-width");if(Z.constantOr(1)===0||re.constantOr(1)===0)return;const he=E.getDepthModeForSublayer(0,Jr.ReadOnly),je=E.colorModeForRenderPass(),we=B.paint.get("line-dasharray"),Se=we.constantOr(1),Ee=B.paint.get("line-pattern"),Re=Ee.constantOr(1),Te=B.paint.get("line-gradient"),Le=B.getCrossfadeParameters();let $e;$e=Re?"linePattern":Se&&Te?"lineGradientSDF":Se?"lineSDF":Te?"lineGradient":"line";const Ie=E.context,Ke=Ie.gl,ut=E.transform;let st=!0;for(const ot of W){const dt=F.getTile(ot);if(Re&&!dt.patternsLoaded())continue;const kt=dt.getBucket(B);if(!kt)continue;const Et=kt.programConfigurations.get(B.id),bt=E.context.program.get(),rr=E.useProgram($e,Et),Wr=st||rr.program!==bt,On=E.style.map.terrain&&E.style.map.terrain.getTerrainData(ot),Hr=Ee.constantOr(null),qn=we&&we.constantOr(null);if(Hr&&dt.imageAtlas){const gi=dt.imageAtlas,ss=gi.patternPositions[Hr.to.toString()],Us=gi.patternPositions[Hr.from.toString()];ss&&Us&&Et.setConstantPatternPositions(ss,Us)}else if(qn){const gi=B.layout.get("line-cap")==="round",ss=E.lineAtlas.getDash(qn.to,gi),Us=E.lineAtlas.getDash(qn.from,gi);Et.setConstantDashPositions(ss,Us)}const ds=ut.getProjectionData({overscaledTileID:ot,applyGlobeMatrix:!Y,applyTerrainMatrix:!0}),Kn=ut.getPixelScale();let ri;Re?(ri=yp(E,dt,B,Kn,Le),bv(Ie,Ke,dt,Et,Le)):Se&&Te?(ri=MP(E,dt,B,Kn,Le,kt.lineClipsArray.length),Op(E,F,Ie,Ke,B,kt,ot,Et,Le)):Se?(ri=EP(E,dt,B,Kn,Le),Aj(E,Ie,Ke,Et,Wr,Le)):Te?(ri=TP(E,dt,B,Kn,kt.lineClipsArray.length),kj(E,F,Ie,Ke,B,kt,ot)):ri=Cc(E,dt,B,Kn);const ns=E.stencilModeForClipping(ot);rr.draw(Ie,Ke.TRIANGLES,he,ns,je,nn.disabled,ri,On,ds,B.id,kt.layoutVertexBuffer,kt.indexBuffer,kt.segments,B.paint,E.transform.zoom,Et,kt.layoutVertexBuffer2),st=!1}}(o,f,x,b,P):a.cj(x)?function(E,F,B,W,G){const Y=B.paint.get("fill-color"),Z=B.paint.get("fill-opacity");if(Z.constantOr(1)===0)return;const{isRenderingToTexture:re}=G,he=E.colorModeForRenderPass(),je=B.paint.get("fill-pattern"),we=E.opaquePassEnabledForLayer()&&!je.constantOr(1)&&Y.constantOr(a.bi.transparent).a===1&&Z.constantOr(0)===1?"opaque":"translucent";if(E.renderPass===we){const Se=E.getDepthModeForSublayer(1,E.renderPass==="opaque"?Jr.ReadWrite:Jr.ReadOnly);Tj(E,F,B,W,Se,he,!1,re)}if(E.renderPass==="translucent"&&B.paint.get("fill-antialias")){const Se=E.getDepthModeForSublayer(B.getPaintProperty("fill-outline-color")?2:0,Jr.ReadOnly);Tj(E,F,B,W,Se,he,!0,re)}}(o,f,x,b,P):a.ck(x)?function(E,F,B,W,G){const Y=B.paint.get("fill-extrusion-opacity");if(Y===0)return;const{isRenderingToTexture:Z}=G;if(E.renderPass==="translucent"){const re=new Jr(E.context.gl.LEQUAL,Jr.ReadWrite,E.depthRangeFor3D);if(Y!==1||B.paint.get("fill-extrusion-pattern").constantOr(1))Dp(E,F,B,W,re,vn.disabled,jn.disabled,Z),Dp(E,F,B,W,re,E.stencilModeFor3D(),E.colorModeForRenderPass(),Z);else{const he=E.colorModeForRenderPass();Dp(E,F,B,W,re,vn.disabled,he,Z)}}}(o,f,x,b,P):a.cl(x)?function(E,F,B,W,G){if(E.renderPass!=="offscreen"&&E.renderPass!=="translucent")return;const{isRenderingToTexture:Y}=G,Z=E.context,re=E.style.projection.useSubdivision,he=E.getDepthModeForSublayer(0,Jr.ReadOnly),je=E.colorModeForRenderPass();if(E.renderPass==="offscreen")(function(we,Se,Ee,Re,Te,Le,$e){const Ie=we.context,Ke=Ie.gl;for(const ut of Ee){const st=Se.getTile(ut),ot=st.dem;if(!ot||!ot.data||!st.needsHillshadePrepare)continue;const dt=ot.dim,kt=ot.stride,Et=ot.getPixels();if(Ie.activeTexture.set(Ke.TEXTURE1),Ie.pixelStoreUnpackPremultiplyAlpha.set(!1),st.demTexture=st.demTexture||we.getTileTexture(kt),st.demTexture){const rr=st.demTexture;rr.update(Et,{premultiply:!1}),rr.bind(Ke.NEAREST,Ke.CLAMP_TO_EDGE)}else st.demTexture=new a.T(Ie,Et,Ke.RGBA,{premultiply:!1}),st.demTexture.bind(Ke.NEAREST,Ke.CLAMP_TO_EDGE);Ie.activeTexture.set(Ke.TEXTURE0);let bt=st.fbo;if(!bt){const rr=new a.T(Ie,{width:dt,height:dt,data:null},Ke.RGBA);rr.bind(Ke.LINEAR,Ke.CLAMP_TO_EDGE),bt=st.fbo=Ie.createFramebuffer(dt,dt,!0,!1),bt.colorAttachment.set(rr.texture)}Ie.bindFramebuffer.set(bt.framebuffer),Ie.viewport.set([0,0,dt,dt]),we.useProgram("hillshadePrepare").draw(Ie,Ke.TRIANGLES,Te,Le,$e,nn.disabled,gu(st.tileID,ot),null,null,Re.id,we.rasterBoundsBuffer,we.quadTriangleIndexBuffer,we.rasterBoundsSegments),st.needsHillshadePrepare=!1}})(E,F,W,B,he,vn.disabled,je),Z.viewport.set([0,0,E.width,E.height]);else if(E.renderPass==="translucent")if(re){const[we,Se,Ee]=E.stencilConfigForOverlapTwoPass(W);cs(E,F,B,Ee,we,he,je,!1,Y),cs(E,F,B,Ee,Se,he,je,!0,Y)}else{const[we,Se]=E.getStencilConfigForOverlapAndUpdateStencilID(W);cs(E,F,B,Se,we,he,je,!1,Y)}}(o,f,x,b,P):a.cm(x)?function(E,F,B,W,G){if(E.renderPass!=="translucent"||!W.length)return;const{isRenderingToTexture:Y}=G,Z=E.style.projection.useSubdivision,re=E.getDepthModeForSublayer(0,Jr.ReadOnly),he=E.colorModeForRenderPass();if(Z){const[je,we,Se]=E.stencilConfigForOverlapTwoPass(W);Ll(E,F,B,Se,je,re,he,!1,Y),Ll(E,F,B,Se,we,re,he,!0,Y)}else{const[je,we]=E.getStencilConfigForOverlapAndUpdateStencilID(W);Ll(E,F,B,we,je,re,he,!1,Y)}}(o,f,x,b,P):a.bN(x)?function(E,F,B,W,G){if(E.renderPass!=="translucent"||B.paint.get("raster-opacity")===0||!W.length)return;const{isRenderingToTexture:Y}=G,Z=F.getSource(),re=E.style.projection.useSubdivision;if(Z instanceof Rt)Bd(E,F,B,W,null,!1,!1,Z.tileCoords,Z.flippedWindingOrder,Y);else if(re){const[he,je,we]=E.stencilConfigForOverlapTwoPass(W);Bd(E,F,B,we,he,!1,!0,ja,!1,Y),Bd(E,F,B,we,je,!0,!0,ja,!1,Y)}else{const[he,je]=E.getStencilConfigForOverlapAndUpdateStencilID(W);Bd(E,F,B,je,he,!1,!0,ja,!1,Y)}}(o,f,x,b,P):a.cn(x)?function(E,F,B,W,G){const Y=B.paint.get("background-color"),Z=B.paint.get("background-opacity");if(Z===0)return;const{isRenderingToTexture:re}=G,he=E.context,je=he.gl,we=E.style.projection,Se=E.transform,Ee=Se.tileSize,Re=B.paint.get("background-pattern");if(E.isPatternMissing(Re))return;const Te=!Re&&Y.a===1&&Z===1&&E.opaquePassEnabledForLayer()?"opaque":"translucent";if(E.renderPass!==Te)return;const Le=vn.disabled,$e=E.getDepthModeForSublayer(0,Te==="opaque"?Jr.ReadWrite:Jr.ReadOnly),Ie=E.colorModeForRenderPass(),Ke=E.useProgram(Re?"backgroundPattern":"background"),ut=W||Nn(Se,{tileSize:Ee,terrain:E.style.map.terrain});Re&&(he.activeTexture.set(je.TEXTURE0),E.imageManager.bind(E.context));const st=B.getCrossfadeParameters();for(const ot of ut){const dt=Se.getProjectionData({overscaledTileID:ot,applyGlobeMatrix:!re,applyTerrainMatrix:!0}),kt=Re?hv(Z,E,Re,{tileID:ot,tileSize:Ee},st):dv(Z,Y),Et=E.style.map.terrain&&E.style.map.terrain.getTerrainData(ot),bt=we.getMeshFromTileID(he,ot.canonical,!1,!0,"raster");Ke.draw(he,je.TRIANGLES,$e,Le,Ie,nn.backCCW,kt,Et,dt,B.id,bt.vertexBuffer,bt.indexBuffer,bt.segments)}}(o,0,x,b,P):a.co(x)&&function(E,F,B,W){const{isRenderingGlobe:G}=W,Y=E.context,Z=B.implementation,re=E.style.projection,he=E.transform,je=he.getProjectionDataForCustomLayer(G),we={farZ:he.farZ,nearZ:he.nearZ,fov:he.fov*Math.PI/180,modelViewProjectionMatrix:he.modelViewProjectionMatrix,projectionMatrix:he.projectionMatrix,shaderData:{variantName:re.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${re.shaderPreludeCode.vertexSource}`,define:re.shaderDefine},defaultProjectionData:je},Se=Z.renderingMode?Z.renderingMode:"2d";if(E.renderPass==="offscreen"){const Ee=Z.prerender;Ee&&(E.setCustomLayerDefaults(),Y.setColorMode(E.colorModeForRenderPass()),Ee.call(Z,Y.gl,we),Y.setDirty(),E.setBaseState())}else if(E.renderPass==="translucent"){E.setCustomLayerDefaults(),Y.setColorMode(E.colorModeForRenderPass()),Y.setStencilMode(vn.disabled);const Ee=Se==="3d"?E.getDepthModeFor3D():E.getDepthModeForSublayer(0,Jr.ReadOnly);Y.setDepthMode(Ee),Z.render(Y.gl,we),Y.setDirty(),E.setBaseState(),Y.bindFramebuffer.set(null)}}(o,0,x,P))}saveTileTexture(o){const f=this._tileTextures[o.size[0]];f?f.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const f=this._tileTextures[o];return f&&f.length>0?f.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const f=this.imageManager.getPattern(o.from.toString()),x=this.imageManager.getPattern(o.to.toString());return!f||!x}useProgram(o,f,x=!1,b=[]){this.cache=this.cache||{};const P=!!this.style.map.terrain,E=this.style.projection,F=x?Ur.projectionMercator:E.shaderPreludeCode,B=x?ba:E.shaderDefine,W=o+(f?f.cacheKey:"")+`/${x?Hi:E.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(P?"/terrain":"")+(b?`/${b.join("/")}`:"");return this.cache[W]||(this.cache[W]=new kf(this.context,Ur[o],f,gj[o],this._showOverdrawInspector,P,F,B,b)),this.cache[W]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:o,drawingBufferHeight:f}=this.context.gl;return this.width!==o||this.height!==f}}function Cv(w,o){let f,x=!1,b=null,P=null;const E=()=>{b=null,x&&(w.apply(P,f),b=setTimeout(E,o),x=!1)};return(...F)=>(x=!0,P=this,f=F,b||E(),b)}class Av{constructor(o){this._getCurrentHash=()=>{const f=window.location.hash.replace("#","");if(this._hashName){let x;return f.split("&").map(b=>b.split("=")).forEach(b=>{b[0]===this._hashName&&(x=b)}),(x&&x[1]||"").split("/")}return f.split("/")},this._onHashChange=()=>{const f=this._getCurrentHash();if(!this._isValidHash(f))return!1;const x=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(f[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+f[2],+f[1]],zoom:+f[0],bearing:x,pitch:+(f[4]||0)}),!0},this._updateHashUnthrottled=()=>{const f=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,f)},this._removeHash=()=>{const f=this._getCurrentHash();if(f.length===0)return;const x=f.join("/");let b=x;b.split("&").length>0&&(b=b.split("&")[0]),this._hashName&&(b=`${this._hashName}=${x}`);let P=window.location.hash.replace(b,"");P.startsWith("#&")?P=P.slice(0,1)+P.slice(2):P==="#"&&(P="");let E=window.location.href.replace(/(#.+)?$/,P);E=E.replace("&&","&"),window.history.replaceState(window.history.state,null,E)},this._updateHash=Cv(this._updateHashUnthrottled,300),this._hashName=o&&encodeURIComponent(o)}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(o){const f=this._map.getCenter(),x=Math.round(100*this._map.getZoom())/100,b=Math.ceil((x*Math.LN2+Math.log(512/360/.5))/Math.LN10),P=Math.pow(10,b),E=Math.round(f.lng*P)/P,F=Math.round(f.lat*P)/P,B=this._map.getBearing(),W=this._map.getPitch();let G="";if(G+=o?`/${E}/${F}/${x}`:`${x}/${F}/${E}`,(B||W)&&(G+="/"+Math.round(10*B)/10),W&&(G+=`/${Math.round(W)}`),this._hashName){const Y=this._hashName;let Z=!1;const re=window.location.hash.slice(1).split("&").map(he=>{const je=he.split("=")[0];return je===Y?(Z=!0,`${je}=${G}`):he}).filter(he=>he);return Z||re.push(`${Y}=${G}`),`#${re.join("&")}`}return`#${G}`}_isValidHash(o){if(o.length<3||o.some(isNaN))return!1;try{new a.U(+o[2],+o[1])}catch{return!1}const f=+o[0],x=+(o[3]||0),b=+(o[4]||0);return f>=this._map.getMinZoom()&&f<=this._map.getMaxZoom()&&x>=-180&&x<=180&&b>=this._map.getMinPitch()&&b<=this._map.getMaxPitch()}}const Vd={linearity:.3,easing:a.cp(0,0,.3,1)},Ij=a.e({deceleration:2500,maxSpeed:1400},Vd),Dj=a.e({deceleration:20,maxSpeed:1400},Vd),Rj=a.e({deceleration:1e3,maxSpeed:360},Vd),Lj=a.e({deceleration:1e3,maxSpeed:90},Vd),Lp=a.e({deceleration:1e3,maxSpeed:360},Vd);class Fj{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:k(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,f=k();for(;o.length>0&&f-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const f={zoom:0,bearing:0,pitch:0,roll:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:P}of this._inertiaBuffer)f.zoom+=P.zoomDelta||0,f.bearing+=P.bearingDelta||0,f.pitch+=P.pitchDelta||0,f.roll+=P.rollDelta||0,P.panDelta&&f.pan._add(P.panDelta),P.around&&(f.around=P.around),P.pinchAround&&(f.pinchAround=P.pinchAround);const x=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,b={};if(f.pan.mag()){const P=ua(f.pan.mag(),x,a.e({},Ij,o||{})),E=f.pan.mult(P.amount/f.pan.mag()),F=this._map.cameraHelper.handlePanInertia(E,this._map.transform);b.center=F.easingCenter,b.offset=F.easingOffset,Yi(b,P)}if(f.zoom){const P=ua(f.zoom,x,Dj);b.zoom=this._map.transform.zoom+P.amount,Yi(b,P)}if(f.bearing){const P=ua(f.bearing,x,Rj);b.bearing=this._map.transform.bearing+a.ai(P.amount,-179,179),Yi(b,P)}if(f.pitch){const P=ua(f.pitch,x,Lj);b.pitch=this._map.transform.pitch+P.amount,Yi(b,P)}if(f.roll){const P=ua(f.roll,x,Lp);b.roll=this._map.transform.roll+a.ai(P.amount,-179,179),Yi(b,P)}if(b.zoom||b.bearing){const P=f.pinchAround===void 0?f.around:f.pinchAround;b.around=P?this._map.unproject(P):this._map.getCenter()}return this.clear(),a.e(b,{noMoveStart:!0})}}function Yi(w,o){(!w.duration||w.duration<o.duration)&&(w.duration=o.duration,w.easing=o.easing)}function ua(w,o,f){const{maxSpeed:x,linearity:b,deceleration:P}=f,E=a.ai(w*b/(o/1e3),-x,x),F=Math.abs(E)/(P*b);return{easing:f.easing,duration:1e3*F,amount:E*(F/2)}}class wa extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,f,x,b={}){x=x instanceof MouseEvent?x:new MouseEvent(o,x);const P=N.mousePos(f.getCanvas(),x),E=f.unproject(P);super(o,a.e({point:P,lngLat:E,originalEvent:x},b)),this._defaultPrevented=!1,this.target=f}}class da extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,f,x){const b=o==="touchend"?x.changedTouches:x.touches,P=N.touchPos(f.getCanvasContainer(),b),E=P.map(B=>f.unproject(B)),F=P.reduce((B,W,G,Y)=>B.add(W.div(Y.length)),new a.P(0,0));super(o,{points:P,point:F,lngLats:E,lngLat:f.unproject(F),originalEvent:x}),this._defaultPrevented=!1}}class zj extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,f,x){super(o,{originalEvent:x}),this._defaultPrevented=!1}}class Ud{constructor(o,f){this._map=o,this._clickTolerance=f.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new zj(o.type,this._map,o))}mousedown(o,f){return this._mousedownPos=f,this._firePreventable(new wa(o.type,this._map,o))}mouseup(o){this._map.fire(new wa(o.type,this._map,o))}click(o,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||this._map.fire(new wa(o.type,this._map,o))}dblclick(o){return this._firePreventable(new wa(o.type,this._map,o))}mouseover(o){this._map.fire(new wa(o.type,this._map,o))}mouseout(o){this._map.fire(new wa(o.type,this._map,o))}touchstart(o){return this._firePreventable(new da(o.type,this._map,o))}touchmove(o){this._map.fire(new da(o.type,this._map,o))}touchend(o){this._map.fire(new da(o.type,this._map,o))}touchcancel(o){this._map.fire(new da(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class BP{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(o){this._map.fire(new wa(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new wa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._ignoreContextMenu||this._map.fire(new wa(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class zf{constructor(o){this._map=o}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(o){return this.transform.screenPointToLocation(a.P.convert(o),this._map.terrain)}}class $j{constructor(o,f){this._map=o,this._tr=new zf(o),this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=f.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,f){this.isEnabled()&&o.shiftKey&&o.button===0&&(N.disableDrag(),this._startPos=this._lastPos=f,this._active=!0)}mousemoveWindow(o,f){if(!this._active)return;const x=f;if(this._lastPos.equals(x)||!this._box&&x.dist(this._startPos)<this._clickTolerance)return;const b=this._startPos;this._lastPos=x,this._box||(this._box=N.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",o));const P=Math.min(b.x,x.x),E=Math.max(b.x,x.x),F=Math.min(b.y,x.y),B=Math.max(b.y,x.y);N.setTransform(this._box,`translate(${P}px,${F}px)`),this._box.style.width=E-P+"px",this._box.style.height=B-F+"px"}mouseupWindow(o,f){if(!this._active||o.button!==0)return;const x=this._startPos,b=f;if(this.reset(),N.suppressClick(),x.x!==b.x||x.y!==b.y)return this._map.fire(new a.l("boxzoomend",{originalEvent:o})),{cameraAnimation:P=>P.fitScreenCoordinates(x,b,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(N.remove(this._box),this._box=null),N.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,f){return this._map.fire(new a.l(o,{originalEvent:f}))}}function kv(w,o){if(w.length!==o.length)throw new Error(`The number of touches and points are not equal - touches ${w.length}, points ${o.length}`);const f={};for(let x=0;x<w.length;x++)f[w[x].identifier]=o[x];return f}class Bj{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,f,x){(this.centroid||x.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=o.timeStamp),x.length===this.numTouches&&(this.centroid=function(b){const P=new a.P(0,0);for(const E of b)P._add(E);return P.div(b.length)}(f),this.touches=kv(x,f)))}touchmove(o,f,x){if(this.aborted||!this.centroid)return;const b=kv(x,f);for(const P in this.touches){const E=b[P];(!E||E.dist(this.touches[P])>30)&&(this.aborted=!0)}}touchend(o,f,x){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),x.length===0){const b=!this.aborted&&this.centroid;if(this.reset(),b)return b}}}class wu{constructor(o){this.singleTap=new Bj(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,f,x){this.singleTap.touchstart(o,f,x)}touchmove(o,f,x){this.singleTap.touchmove(o,f,x)}touchend(o,f,x){const b=this.singleTap.touchend(o,f,x);if(b){const P=o.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(b)<30;if(P&&E||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=b,this.count===this.numTaps)return this.reset(),b}}}class Fl{constructor(o){this._tr=new zf(o),this._zoomIn=new wu({numTouches:1,numTaps:2}),this._zoomOut=new wu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,f,x){this._zoomIn.touchstart(o,f,x),this._zoomOut.touchstart(o,f,x)}touchmove(o,f,x){this._zoomIn.touchmove(o,f,x),this._zoomOut.touchmove(o,f,x)}touchend(o,f,x){const b=this._zoomIn.touchend(o,f,x),P=this._zoomOut.touchend(o,f,x),E=this._tr;return b?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:E.zoom+1,around:E.unproject(b)},{originalEvent:o})}):P?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:E.zoom-1,around:E.unproject(P)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Kt{constructor(o){this._enabled=!!o.enable,this._moveStateManager=o.moveStateManager,this._clickTolerance=o.clickTolerance||1,this._moveFunction=o.move,this._activateOnStart=!!o.activateOnStart,o.assignEvents(this),this.reset()}reset(o){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(o)}_move(...o){const f=this._moveFunction(...o);if(f.bearingDelta||f.pitchDelta||f.rollDelta||f.around||f.panDelta)return this._active=!0,f}dragStart(o,f){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(o)&&(this._moveStateManager.startMove(o),this._lastPoint=Array.isArray(f)?f[0]:f,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(o,f){if(!this.isEnabled())return;const x=this._lastPoint;if(!x)return;if(o.preventDefault(),!this._moveStateManager.isValidMoveEvent(o))return void this.reset(o);const b=Array.isArray(f)?f[0]:f;return!this._moved&&b.dist(x)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=b,this._move(x,b))}dragEnd(o){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(o)&&(this._moved&&N.suppressClick(),this.reset(o))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const qj=0,Tv=2,Vj={[qj]:1,[Tv]:2};class zl{constructor(o){this._correctEvent=o.checkCorrectEvent}startMove(o){const f=N.mouseButton(o);this._eventButton=f}endMove(o){delete this._eventButton}isValidStartEvent(o){return this._correctEvent(o)}isValidMoveEvent(o){return!function(f,x){const b=Vj[x];return f.buttons===void 0||(f.buttons&b)!==b}(o,this._eventButton)}isValidEndEvent(o){return N.mouseButton(o)===this._eventButton}}class $f{constructor(){this._firstTouch=void 0}_isOneFingerTouch(o){return o.targetTouches.length===1}_isSameTouchEvent(o){return o.targetTouches[0].identifier===this._firstTouch}startMove(o){this._firstTouch=o.targetTouches[0].identifier}endMove(o){delete this._firstTouch}isValidStartEvent(o){return this._isOneFingerTouch(o)}isValidMoveEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}isValidEndEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}}class Ev{constructor(o=new zl({checkCorrectEvent:()=>!0}),f=new $f){this.mouseMoveStateManager=o,this.oneFingerTouchMoveStateManager=f}_executeRelevantHandler(o,f,x){return o instanceof MouseEvent?f(o):typeof TouchEvent<"u"&&o instanceof TouchEvent?x(o):void 0}startMove(o){this._executeRelevantHandler(o,f=>this.mouseMoveStateManager.startMove(f),f=>this.oneFingerTouchMoveStateManager.startMove(f))}endMove(o){this._executeRelevantHandler(o,f=>this.mouseMoveStateManager.endMove(f),f=>this.oneFingerTouchMoveStateManager.endMove(f))}isValidStartEvent(o){return this._executeRelevantHandler(o,f=>this.mouseMoveStateManager.isValidStartEvent(f),f=>this.oneFingerTouchMoveStateManager.isValidStartEvent(f))}isValidMoveEvent(o){return this._executeRelevantHandler(o,f=>this.mouseMoveStateManager.isValidMoveEvent(f),f=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(f))}isValidEndEvent(o){return this._executeRelevantHandler(o,f=>this.mouseMoveStateManager.isValidEndEvent(f),f=>this.oneFingerTouchMoveStateManager.isValidEndEvent(f))}}const sn=w=>{w.mousedown=w.dragStart,w.mousemoveWindow=w.dragMove,w.mouseup=w.dragEnd,w.contextmenu=o=>{o.preventDefault()}};class Mv{constructor(o,f){this._clickTolerance=o.clickTolerance||1,this._map=f,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}_shouldBePrevented(o){return o<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(o,f,x){return this._calculateTransform(o,f,x)}touchmove(o,f,x){if(this._active){if(!this._shouldBePrevented(x.length))return o.preventDefault(),this._calculateTransform(o,f,x);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",o)}}touchend(o,f,x){this._calculateTransform(o,f,x),this._active&&this._shouldBePrevented(x.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,f,x){x.length>0&&(this._active=!0);const b=kv(x,f),P=new a.P(0,0),E=new a.P(0,0);let F=0;for(const W in b){const G=b[W],Y=this._touches[W];Y&&(P._add(G),E._add(G.sub(Y)),F++,b[W]=G)}if(this._touches=b,this._shouldBePrevented(F)||!E.mag())return;const B=E.div(F);return this._sum._add(B),this._sum.mag()<this._clickTolerance?void 0:{around:P.div(F),panDelta:B}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ov{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(o,f,x){this._firstTwoTouches||x.length<2||(this._firstTwoTouches=[x[0].identifier,x[1].identifier],this._start([f[0],f[1]]))}touchmove(o,f,x){if(!this._firstTwoTouches)return;o.preventDefault();const[b,P]=this._firstTwoTouches,E=Wd(x,f,b),F=Wd(x,f,P);if(!E||!F)return;const B=this._aroundCenter?null:E.add(F).div(2);return this._move([E,F],B,o)}touchend(o,f,x){if(!this._firstTwoTouches)return;const[b,P]=this._firstTwoTouches,E=Wd(x,f,b),F=Wd(x,f,P);E&&F||(this._active&&N.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Wd(w,o,f){for(let x=0;x<w.length;x++)if(w[x].identifier===f)return o[x]}function Uj(w,o){return Math.log(w/o)/Math.LN2}class Wj extends Ov{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,f){const x=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Uj(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Uj(this._distance,x),pinchAround:f}}}function Iv(w,o){return 180*w.angleWith(o)/Math.PI}class Fp extends Ov{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,f,x){const b=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Iv(this._vector,b),pinchAround:f}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const f=25/(Math.PI*this._minDiameter)*360,x=Iv(o,this._startVector);return Math.abs(x)<f}}function zp(w){return Math.abs(w.y)>Math.abs(w.x)}class Gj extends Ov{constructor(o){super(),this._currentTouchCount=0,this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(o,f,x){super.touchstart(o,f,x),this._currentTouchCount=x.length}_start(o){this._lastPoints=o,zp(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,f,x){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const b=o[0].sub(this._lastPoints[0]),P=o[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(b,P,x.timeStamp),this._valid?(this._lastPoints=o,this._active=!0,{pitchDelta:(b.y+P.y)/2*-.5}):void 0}gestureBeginsVertically(o,f,x){if(this._valid!==void 0)return this._valid;const b=o.mag()>=2,P=f.mag()>=2;if(!b&&!P)return;if(!b||!P)return this._firstMove===void 0&&(this._firstMove=x),x-this._firstMove<100&&void 0;const E=o.y>0==f.y>0;return zp(o)&&zp(f)&&E}}const Kj={panStep:100,bearingStep:15,pitchStep:10};class Hj{constructor(o){this._tr=new zf(o);const f=Kj;this._panStep=f.panStep,this._bearingStep=f.bearingStep,this._pitchStep=f.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let f=0,x=0,b=0,P=0,E=0;switch(o.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:o.shiftKey?x=-1:(o.preventDefault(),P=-1);break;case 39:o.shiftKey?x=1:(o.preventDefault(),P=1);break;case 38:o.shiftKey?b=1:(o.preventDefault(),E=-1);break;case 40:o.shiftKey?b=-1:(o.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(x=0,b=0),{cameraAnimation:F=>{const B=this._tr;F.easeTo({duration:300,easeId:"keyboardHandler",easing:qP,zoom:f?Math.round(B.zoom)+f*(o.shiftKey?2:1):B.zoom,bearing:B.bearing+x*this._bearingStep,pitch:B.pitch+b*this._pitchStep,offset:[-P*this._panStep,-E*this._panStep],center:B.center},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function qP(w){return w*(2-w)}const $l=4.000244140625,Bn=1/450;class Zj{constructor(o,f){this._onTimeout=x=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(x)},this._map=o,this._tr=new zf(o),this._triggerRenderFrame=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Bn}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(o){return!!this._map.cooperativeGestures.isEnabled()&&!(o.ctrlKey||this._map.cooperativeGestures.isBypassed(o))}wheel(o){if(!this.isEnabled())return;if(this._shouldBePrevented(o))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",o);let f=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const x=k(),b=x-(this._lastWheelEventTime||0);this._lastWheelEventTime=x,f!==0&&f%$l==0?this._type="wheel":f!==0&&Math.abs(f)<4?this._type="trackpad":b>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(b*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),o.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=o,this._delta-=f,this._active||this._start(o)),o.preventDefault()}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const f=N.mousePos(this._map.getCanvas(),o),x=this._tr;this._aroundPoint=this._aroundCenter?x.transform.locationToScreenPoint(a.U.convert(x.center)):f,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const F=o.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=F),typeof this._targetZoom=="number"&&(this._targetZoom+=F)}if(this._delta!==0){const F=this._type==="wheel"&&Math.abs(this._delta)>$l?this._wheelZoomRate:this._defaultZoomRate;let B=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&B!==0&&(B=1/B);const W=typeof this._targetZoom!="number"?o.scale:a.al(this._targetZoom);this._targetZoom=o.constrain(o.getCameraLngLat(),a.ao(W*B)).zoom,this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const f=typeof this._targetZoom!="number"?o.zoom:this._targetZoom,x=this._startZoom,b=this._easing;let P,E=!1;if(this._type==="wheel"&&x&&b){const F=k()-this._lastWheelEventTime,B=Math.min((F+5)/200,1),W=b(B);P=a.F.number(x,f,W),B<1?this._frameId||(this._frameId=!0):E=!0}else P=f,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=P,{noInertia:!0,needsRenderFrame:!E,zoomDelta:P-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let f=a.cr;if(this._prevEase){const x=this._prevEase,b=(k()-x.start)/x.duration,P=x.easing(b+.01)-x.easing(b),E=.27/Math.sqrt(P*P+1e-4)*.01,F=Math.sqrt(.0729-E*E);f=a.cp(E,F,.25,1)}return this._prevEase={start:k(),duration:o,easing:f},f}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Bf{constructor(o,f){this._clickZoom=o,this._tapZoom=f}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Dv{constructor(o){this._tr=new zf(o),this.reset()}reset(){this._active=!1}dblclick(o,f){return o.preventDefault(),{cameraAnimation:x=>{x.easeTo({duration:300,zoom:this._tr.zoom+(o.shiftKey?-1:1),around:this._tr.unproject(f)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yj{constructor(){this._tap=new wu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(o,f,x){if(!this._swipePoint)if(this._tapTime){const b=f[0],P=o.timeStamp-this._tapTime<500,E=this._tapPoint.dist(b)<30;P&&E?x.length>0&&(this._swipePoint=b,this._swipeTouch=x[0].identifier):this.reset()}else this._tap.touchstart(o,f,x)}touchmove(o,f,x){if(this._tapTime){if(this._swipePoint){if(x[0].identifier!==this._swipeTouch)return;const b=f[0],P=b.y-this._swipePoint.y;return this._swipePoint=b,o.preventDefault(),this._active=!0,{zoomDelta:P/128}}}else this._tap.touchmove(o,f,x)}touchend(o,f,x){if(this._tapTime)this._swipePoint&&x.length===0&&this.reset();else{const b=this._tap.touchend(o,f,x);b&&(this._tapTime=o.timeStamp,this._tapPoint=b)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Rv{constructor(o,f,x){this._el=o,this._mousePan=f,this._touchPan=x}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Lv{constructor(o,f,x,b){this._pitchWithRotate=o.pitchWithRotate,this._rollEnabled=o.rollEnabled,this._mouseRotate=f,this._mousePitch=x,this._mouseRoll=b}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Xj{constructor(o,f,x,b){this._el=o,this._touchZoom=f,this._touchRotate=x,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Ao{constructor(o,f){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=o,this._options=f,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const o=this._map.getCanvasContainer();o.classList.add("maplibregl-cooperative-gestures"),this._container=N.create("div","maplibregl-cooperative-gesture-screen",o);let f=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(f=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const x=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),b=document.createElement("div");b.className="maplibregl-desktop-message",b.textContent=f,this._container.appendChild(b);const P=document.createElement("div");P.className="maplibregl-mobile-message",P.textContent=x,this._container.appendChild(P),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(N.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(o){return o[this._bypassKey]}notifyGestureBlocked(o,f){this._enabled&&(this._map.fire(new a.l("cooperativegestureprevented",{gestureType:o,originalEvent:f})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Su=w=>w.zoom||w.drag||w.roll||w.pitch||w.rotate;class fr extends a.l{}function Tr(w){return w.panDelta&&w.panDelta.mag()||w.zoomDelta||w.bearingDelta||w.pitchDelta||w.rollDelta}class qf{constructor(o,f){this.handleWindowEvent=b=>{this.handleEvent(b,`${b.type}Window`)},this.handleEvent=(b,P)=>{if(b.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const E=b.type==="renderFrame"?void 0:b,F={needsRenderFrame:!1},B={},W={};for(const{handlerName:Z,handler:re,allowed:he}of this._handlers){if(!re.isEnabled())continue;let je;if(this._blockedByActive(W,he,Z))re.reset();else if(re[P||b.type]){if(a.cs(b,P||b.type)){const we=N.mousePos(this._map.getCanvas(),b);je=re[P||b.type](b,we)}else if(a.ct(b,P||b.type)){const we=this._getMapTouches(b.touches),Se=N.touchPos(this._map.getCanvas(),we);je=re[P||b.type](b,Se,we)}else a.cu(P||b.type)||(je=re[P||b.type](b));this.mergeHandlerResult(F,B,je,Z,E),je&&je.needsRenderFrame&&this._triggerRenderFrame()}(je||re.isActive())&&(W[Z]=re)}const G={};for(const Z in this._previousActiveHandlers)W[Z]||(G[Z]=E);this._previousActiveHandlers=W,(Object.keys(G).length||Tr(F))&&(this._changes.push([F,B,G]),this._triggerRenderFrame()),(Object.keys(W).length||Tr(F))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Y}=F;Y&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Y(this._map))},this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Fj(o),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(f);const x=this._el;this._listeners=[[x,"touchstart",{passive:!0}],[x,"touchmove",{passive:!1}],[x,"touchend",void 0],[x,"touchcancel",void 0],[x,"mousedown",void 0],[x,"mousemove",void 0],[x,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[x,"mouseover",void 0],[x,"mouseout",void 0],[x,"dblclick",void 0],[x,"click",void 0],[x,"keydown",{capture:!1}],[x,"keyup",void 0],[x,"wheel",{passive:!1}],[x,"contextmenu",void 0],[window,"blur",void 0]];for(const[b,P,E]of this._listeners)N.addEventListener(b,P,b===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[o,f,x]of this._listeners)N.removeEventListener(o,f,o===document?this.handleWindowEvent:this.handleEvent,x)}_addDefaultHandlers(o){const f=this._map,x=f.getCanvasContainer();this._add("mapEvent",new Ud(f,o));const b=f.boxZoom=new $j(f,o);this._add("boxZoom",b),o.interactive&&o.boxZoom&&b.enable();const P=f.cooperativeGestures=new Ao(f,o.cooperativeGestures);this._add("cooperativeGestures",P),o.cooperativeGestures&&P.enable();const E=new Fl(f),F=new Dv(f);f.doubleClickZoom=new Bf(F,E),this._add("tapZoom",E),this._add("clickZoom",F),o.interactive&&o.doubleClickZoom&&f.doubleClickZoom.enable();const B=new Yj;this._add("tapDragZoom",B);const W=f.touchPitch=new Gj(f);this._add("touchPitch",W),o.interactive&&o.touchPitch&&f.touchPitch.enable(o.touchPitch);const G=()=>f.project(f.getCenter()),Y=function({enable:Te,clickTolerance:Le,aroundCenter:$e=!0,minPixelCenterThreshold:Ie=100,rotateDegreesPerPixelMoved:Ke=.8},ut){const st=new zl({checkCorrectEvent:ot=>N.mouseButton(ot)===0&&ot.ctrlKey||N.mouseButton(ot)===2&&!ot.ctrlKey});return new Kt({clickTolerance:Le,move:(ot,dt)=>{const kt=ut();if($e&&Math.abs(kt.y-ot.y)>Ie)return{bearingDelta:a.cq(new a.P(ot.x,dt.y),dt,kt)};let Et=(dt.x-ot.x)*Ke;return $e&&dt.y<kt.y&&(Et=-Et),{bearingDelta:Et}},moveStateManager:st,enable:Te,assignEvents:sn})}(o,G),Z=function({enable:Te,clickTolerance:Le,pitchDegreesPerPixelMoved:$e=-.5}){const Ie=new zl({checkCorrectEvent:Ke=>N.mouseButton(Ke)===0&&Ke.ctrlKey||N.mouseButton(Ke)===2});return new Kt({clickTolerance:Le,move:(Ke,ut)=>({pitchDelta:(ut.y-Ke.y)*$e}),moveStateManager:Ie,enable:Te,assignEvents:sn})}(o),re=function({enable:Te,clickTolerance:Le,rollDegreesPerPixelMoved:$e=.3},Ie){const Ke=new zl({checkCorrectEvent:ut=>N.mouseButton(ut)===2&&ut.ctrlKey});return new Kt({clickTolerance:Le,move:(ut,st)=>{const ot=Ie();let dt=(st.x-ut.x)*$e;return st.y<ot.y&&(dt=-dt),{rollDelta:dt}},moveStateManager:Ke,enable:Te,assignEvents:sn})}(o,G);f.dragRotate=new Lv(o,Y,Z,re),this._add("mouseRotate",Y,["mousePitch"]),this._add("mousePitch",Z,["mouseRotate","mouseRoll"]),this._add("mouseRoll",re,["mousePitch"]),o.interactive&&o.dragRotate&&f.dragRotate.enable();const he=function({enable:Te,clickTolerance:Le}){const $e=new zl({checkCorrectEvent:Ie=>N.mouseButton(Ie)===0&&!Ie.ctrlKey});return new Kt({clickTolerance:Le,move:(Ie,Ke)=>({around:Ke,panDelta:Ke.sub(Ie)}),activateOnStart:!0,moveStateManager:$e,enable:Te,assignEvents:sn})}(o),je=new Mv(o,f);f.dragPan=new Rv(x,he,je),this._add("mousePan",he),this._add("touchPan",je,["touchZoom","touchRotate"]),o.interactive&&o.dragPan&&f.dragPan.enable(o.dragPan);const we=new Fp,Se=new Wj;f.touchZoomRotate=new Xj(x,Se,we,B),this._add("touchRotate",we,["touchPan","touchZoom"]),this._add("touchZoom",Se,["touchPan","touchRotate"]),o.interactive&&o.touchZoomRotate&&f.touchZoomRotate.enable(o.touchZoomRotate),this._add("blockableMapEvent",new BP(f));const Ee=f.scrollZoom=new Zj(f,()=>this._triggerRenderFrame());this._add("scrollZoom",Ee,["mousePan"]),o.interactive&&o.scrollZoom&&f.scrollZoom.enable(o.scrollZoom);const Re=f.keyboard=new Hj(f);this._add("keyboard",Re),o.interactive&&o.keyboard&&f.keyboard.enable()}_add(o,f,x){this._handlers.push({handlerName:o,handler:f,allowed:x}),this._handlersById[o]=f}stop(o){if(!this._updatingCamera){for(const{handler:f}of this._handlers)f.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Su(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,f,x){for(const b in o)if(b!==x&&(!f||f.indexOf(b)<0))return!0;return!1}_getMapTouches(o){const f=[];for(const x of o)this._el.contains(x.target)&&f.push(x);return f}mergeHandlerResult(o,f,x,b,P){if(!x)return;a.e(o,x);const E={handlerName:b,originalEvent:x.originalEvent||P};x.zoomDelta!==void 0&&(f.zoom=E),x.panDelta!==void 0&&(f.drag=E),x.rollDelta!==void 0&&(f.roll=E),x.pitchDelta!==void 0&&(f.pitch=E),x.bearingDelta!==void 0&&(f.rotate=E)}_applyChanges(){const o={},f={},x={};for(const[b,P,E]of this._changes)b.panDelta&&(o.panDelta=(o.panDelta||new a.P(0,0))._add(b.panDelta)),b.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+b.zoomDelta),b.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+b.bearingDelta),b.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+b.pitchDelta),b.rollDelta&&(o.rollDelta=(o.rollDelta||0)+b.rollDelta),b.around!==void 0&&(o.around=b.around),b.pinchAround!==void 0&&(o.pinchAround=b.pinchAround),b.noInertia&&(o.noInertia=b.noInertia),a.e(f,P),a.e(x,E);this._updateMapTransform(o,f,x),this._changes=[]}_updateMapTransform(o,f,x){const b=this._map,P=b._getTransformForUpdate(),E=b.terrain;if(!(Tr(o)||E&&this._terrainMovement))return this._fireEvents(f,x,!0);b._stop(!0);let{panDelta:F,zoomDelta:B,bearingDelta:W,pitchDelta:G,rollDelta:Y,around:Z,pinchAround:re}=o;re!==void 0&&(Z=re),Z=Z||b.transform.centerPoint,E&&!P.isPointOnMapSurface(Z)&&(Z=P.centerPoint);const he={panDelta:F,zoomDelta:B,rollDelta:Y,pitchDelta:G,bearingDelta:W,around:Z};this._map.cameraHelper.useGlobeControls&&!P.isPointOnMapSurface(Z)&&(Z=P.centerPoint);const je=Z.distSqr(P.centerPoint)<.01?P.center:P.screenPointToLocation(F?Z.sub(F):Z);this._handleMapControls({terrain:E,tr:P,deltasForHelper:he,preZoomAroundLoc:je,combinedEventsInProgress:f,panDelta:F}),b._applyUpdatedTransform(P),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(f,x,!0)}_handleMapControls({terrain:o,tr:f,deltasForHelper:x,preZoomAroundLoc:b,combinedEventsInProgress:P,panDelta:E}){const F=this._map.cameraHelper;if(F.handleMapControlsRollPitchBearingZoom(x,f),o)return F.useGlobeControls?(this._terrainMovement||!P.drag&&!P.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void F.handleMapControlsPan(x,f,b)):this._terrainMovement||!P.drag&&!P.zoom?void(P.drag&&this._terrainMovement&&E?f.setCenter(f.screenPointToLocation(f.centerPoint.sub(E))):F.handleMapControlsPan(x,f,b)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void F.handleMapControlsPan(x,f,b));F.handleMapControlsPan(x,f,b)}_fireEvents(o,f,x){const b=Su(this._eventsInProgress),P=Su(o),E={};for(const Y in o){const{originalEvent:Z}=o[Y];this._eventsInProgress[Y]||(E[`${Y}start`]=Z),this._eventsInProgress[Y]=o[Y]}!b&&P&&this._fireEvent("movestart",P.originalEvent);for(const Y in E)this._fireEvent(Y,E[Y]);P&&this._fireEvent("move",P.originalEvent);for(const Y in o){const{originalEvent:Z}=o[Y];this._fireEvent(Y,Z)}const F={};let B;for(const Y in this._eventsInProgress){const{handlerName:Z,originalEvent:re}=this._eventsInProgress[Y];this._handlersById[Z].isActive()||(delete this._eventsInProgress[Y],B=f[Z]||re,F[`${Y}end`]=B)}for(const Y in F)this._fireEvent(Y,F[Y]);const W=Su(this._eventsInProgress),G=(b||P)&&!W;if(G&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Y=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&Y.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(Y)}if(x&&G){this._updatingCamera=!0;const Y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Z=re=>re!==0&&-this._bearingSnap<re&&re<this._bearingSnap;!Y||!Y.essential&&j.prefersReducedMotion?(this._map.fire(new a.l("moveend",{originalEvent:B})),Z(this._map.getBearing())&&this._map.resetNorth()):(Z(Y.bearing||this._map.getBearing())&&(Y.bearing=0),Y.freezeElevation=!0,this._map.easeTo(Y,{originalEvent:B})),this._updatingCamera=!1}}_fireEvent(o,f){this._map.fire(new a.l(o,f?{originalEvent:f}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new fr("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Qj extends a.E{constructor(o,f,x){super(),this._renderFrameCallback=()=>{const b=Math.min((k()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(b)),b<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=x.bearingSnap,this.cameraHelper=f,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(o,f){o.apply(this.transform),this.transform=o,this.cameraHelper=f}getCenter(){return new a.U(this.transform.center.lng,this.transform.center.lat)}setCenter(o,f){return this.jumpTo({center:o},f)}getCenterElevation(){return this.transform.elevation}setCenterElevation(o,f){return this.jumpTo({elevation:o},f),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(o){this._centerClampedToGround=o}panBy(o,f,x){return o=a.P.convert(o).mult(-1),this.panTo(this.transform.center,a.e({offset:o},f),x)}panTo(o,f,x){return this.easeTo(a.e({center:o},f),x)}getZoom(){return this.transform.zoom}setZoom(o,f){return this.jumpTo({zoom:o},f),this}zoomTo(o,f,x){return this.easeTo(a.e({zoom:o},f),x)}zoomIn(o,f){return this.zoomTo(this.getZoom()+1,o,f),this}zoomOut(o,f){return this.zoomTo(this.getZoom()-1,o,f),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(o,f){return o!=this.transform.fov&&(this.transform.setFov(o),this.fire(new a.l("movestart",f)).fire(new a.l("move",f)).fire(new a.l("moveend",f))),this}getBearing(){return this.transform.bearing}setBearing(o,f){return this.jumpTo({bearing:o},f),this}getPadding(){return this.transform.padding}setPadding(o,f){return this.jumpTo({padding:o},f),this}rotateTo(o,f,x){return this.easeTo(a.e({bearing:o},f),x)}resetNorth(o,f){return this.rotateTo(0,a.e({duration:1e3},o),f),this}resetNorthPitch(o,f){return this.easeTo(a.e({bearing:0,pitch:0,roll:0,duration:1e3},o),f),this}snapToNorth(o,f){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,f):this}getPitch(){return this.transform.pitch}setPitch(o,f){return this.jumpTo({pitch:o},f),this}getRoll(){return this.transform.roll}setRoll(o,f){return this.jumpTo({roll:o},f),this}cameraForBounds(o,f){o=Lr.convert(o).adjustAntiMeridian();const x=f&&f.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),x,f)}_cameraForBoxAndBearing(o,f,x,b){const P={top:0,bottom:0,right:0,left:0};if(typeof(b=a.e({padding:P,offset:[0,0],maxZoom:this.transform.maxZoom},b)).padding=="number"){const W=b.padding;b.padding={top:W,bottom:W,right:W,left:W}}const E=a.e(P,b.padding);b.padding=E;const F=this.transform,B=new Lr(o,f);return this.cameraHelper.cameraForBoxAndBearing(b,E,B,x,F)}fitBounds(o,f,x){return this._fitInternal(this.cameraForBounds(o,f),f,x)}fitScreenCoordinates(o,f,x,b,P){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(a.P.convert(o)),this.transform.screenPointToLocation(a.P.convert(f)),x,b),b,P)}_fitInternal(o,f,x){return o?(delete(f=a.e(o,f)).padding,f.linear?this.easeTo(f,x):this.flyTo(f,x)):this}jumpTo(o,f){this.stop();const x=this._getTransformForUpdate();let b=!1,P=!1,E=!1;const F=x.zoom;this.cameraHelper.handleJumpToCenterZoom(x,o);const B=x.zoom!==F;return"elevation"in o&&x.elevation!==+o.elevation&&x.setElevation(+o.elevation),"bearing"in o&&x.bearing!==+o.bearing&&(b=!0,x.setBearing(+o.bearing)),"pitch"in o&&x.pitch!==+o.pitch&&(P=!0,x.setPitch(+o.pitch)),"roll"in o&&x.roll!==+o.roll&&(E=!0,x.setRoll(+o.roll)),o.padding==null||x.isPaddingEqual(o.padding)||x.setPadding(o.padding),this._applyUpdatedTransform(x),this.fire(new a.l("movestart",f)).fire(new a.l("move",f)),B&&this.fire(new a.l("zoomstart",f)).fire(new a.l("zoom",f)).fire(new a.l("zoomend",f)),b&&this.fire(new a.l("rotatestart",f)).fire(new a.l("rotate",f)).fire(new a.l("rotateend",f)),P&&this.fire(new a.l("pitchstart",f)).fire(new a.l("pitch",f)).fire(new a.l("pitchend",f)),E&&this.fire(new a.l("rollstart",f)).fire(new a.l("roll",f)).fire(new a.l("rollend",f)),this.fire(new a.l("moveend",f))}calculateCameraOptionsFromTo(o,f,x,b=0){const P=a.a5.fromLngLat(o,f),E=a.a5.fromLngLat(x,b),F=E.x-P.x,B=E.y-P.y,W=E.z-P.z,G=Math.hypot(F,B,W);if(G===0)throw new Error("Can't calculate camera options with same From and To");const Y=Math.hypot(F,B),Z=a.ao(this.transform.cameraToCenterDistance/G/this.transform.tileSize),re=180*Math.atan2(F,-B)/Math.PI;let he=180*Math.acos(Y/G)/Math.PI;return he=W<0?90-he:90+he,{center:E.toLngLat(),elevation:b,zoom:Z,pitch:he,bearing:re}}calculateCameraOptionsFromCameraLngLatAltRotation(o,f,x,b,P){const E=this.transform.calculateCenterFromCameraLngLatAlt(o,f,x,b);return{center:E.center,elevation:E.elevation,zoom:E.zoom,bearing:x,pitch:b,roll:P}}easeTo(o,f){this._stop(!1,o.easeId),((o=a.e({offset:[0,0],duration:500,easing:a.cr},o)).animate===!1||!o.essential&&j.prefersReducedMotion)&&(o.duration=0);const x=this._getTransformForUpdate(),b=this.getBearing(),P=x.pitch,E=x.roll,F="bearing"in o?this._normalizeBearing(o.bearing,b):b,B="pitch"in o?+o.pitch:P,W="roll"in o?this._normalizeBearing(o.roll,E):E,G="padding"in o?o.padding:x.padding,Y=a.P.convert(o.offset);let Z,re;o.around&&(Z=a.U.convert(o.around),re=x.locationToScreenPoint(Z));const he={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},je=this.cameraHelper.handleEaseTo(x,{bearing:F,pitch:B,roll:W,padding:G,around:Z,aroundPoint:re,offsetAsPoint:Y,offset:o.offset,zoom:o.zoom,center:o.center});return this._rotating=this._rotating||b!==F,this._pitching=this._pitching||B!==P,this._rolling=this._rolling||W!==E,this._padding=!x.isPaddingEqual(G),this._zooming=this._zooming||je.isZooming,this._easeId=o.easeId,this._prepareEase(f,o.noMoveStart,he),this.terrain&&this._prepareElevation(je.elevationCenter),this._ease(we=>{je.easeFunc(we),this.terrain&&!o.freezeElevation&&this._updateElevation(we),this._applyUpdatedTransform(x),this._fireMoveEvents(f)},we=>{this.terrain&&o.freezeElevation&&this._finalizeElevation(),this._afterEase(f,we)},o),this}_prepareEase(o,f,x={}){this._moving=!0,f||x.moving||this.fire(new a.l("movestart",o)),this._zooming&&!x.zooming&&this.fire(new a.l("zoomstart",o)),this._rotating&&!x.rotating&&this.fire(new a.l("rotatestart",o)),this._pitching&&!x.pitching&&this.fire(new a.l("pitchstart",o)),this._rolling&&!x.rolling&&this.fire(new a.l("rollstart",o))}_prepareElevation(o){this._elevationCenter=o,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(o){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const f=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(o<1&&f!==this._elevationTarget){const x=this._elevationTarget-this._elevationStart;this._elevationStart+=o*(x-(f-(x*o+this._elevationStart))/(1-o)),this._elevationTarget=f}this.transform.setElevation(a.F.number(this._elevationStart,this._elevationTarget,o))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(o){if(!this.terrain&&o.elevation>=0&&o.pitch<=90)return{};const f=o.getCameraLngLat(),x=o.getCameraAltitude(),b=this.terrain?this.terrain.getElevationForLngLatZoom(f,o.zoom):0;if(x<b){const P=this.calculateCameraOptionsFromTo(f,b,o.center,o.elevation);return{pitch:P.pitch,zoom:P.zoom}}return{}}_applyUpdatedTransform(o){const f=[];if(f.push(b=>this._elevateCameraIfInsideTerrain(b)),this.transformCameraUpdate&&f.push(b=>this.transformCameraUpdate(b)),!f.length)return;const x=o.clone();for(const b of f){const P=x.clone(),{center:E,zoom:F,roll:B,pitch:W,bearing:G,elevation:Y}=b(P);E&&P.setCenter(E),Y!==void 0&&P.setElevation(Y),F!==void 0&&P.setZoom(F),B!==void 0&&P.setRoll(B),W!==void 0&&P.setPitch(W),G!==void 0&&P.setBearing(G),x.apply(P)}this.transform.apply(x)}_fireMoveEvents(o){this.fire(new a.l("move",o)),this._zooming&&this.fire(new a.l("zoom",o)),this._rotating&&this.fire(new a.l("rotate",o)),this._pitching&&this.fire(new a.l("pitch",o)),this._rolling&&this.fire(new a.l("roll",o))}_afterEase(o,f){if(this._easeId&&f&&this._easeId===f)return;delete this._easeId;const x=this._zooming,b=this._rotating,P=this._pitching,E=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,x&&this.fire(new a.l("zoomend",o)),b&&this.fire(new a.l("rotateend",o)),P&&this.fire(new a.l("pitchend",o)),E&&this.fire(new a.l("rollend",o)),this.fire(new a.l("moveend",o))}flyTo(o,f){if(!o.essential&&j.prefersReducedMotion){const dt=a.S(o,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(dt,f)}this.stop(),o=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.cr},o);const x=this._getTransformForUpdate(),b=x.bearing,P=x.pitch,E=x.roll,F=x.padding,B="bearing"in o?this._normalizeBearing(o.bearing,b):b,W="pitch"in o?+o.pitch:P,G="roll"in o?this._normalizeBearing(o.roll,E):E,Y="padding"in o?o.padding:x.padding,Z=a.P.convert(o.offset);let re=x.centerPoint.add(Z);const he=x.screenPointToLocation(re),je=this.cameraHelper.handleFlyTo(x,{bearing:B,pitch:W,roll:G,padding:Y,locationAtOffset:he,offsetAsPoint:Z,center:o.center,minZoom:o.minZoom,zoom:o.zoom});let we=o.curve;const Se=Math.max(x.width,x.height),Ee=Se/je.scaleOfZoom,Re=je.pixelPathLength;typeof je.scaleOfMinZoom=="number"&&(we=Math.sqrt(Se/je.scaleOfMinZoom/Re*2));const Te=we*we;function Le(dt){const kt=(Ee*Ee-Se*Se+(dt?-1:1)*Te*Te*Re*Re)/(2*(dt?Ee:Se)*Te*Re);return Math.log(Math.sqrt(kt*kt+1)-kt)}function $e(dt){return(Math.exp(dt)-Math.exp(-dt))/2}function Ie(dt){return(Math.exp(dt)+Math.exp(-dt))/2}const Ke=Le(!1);let ut=function(dt){return Ie(Ke)/Ie(Ke+we*dt)},st=function(dt){return Se*((Ie(Ke)*($e(kt=Ke+we*dt)/Ie(kt))-$e(Ke))/Te)/Re;var kt},ot=(Le(!0)-Ke)/we;if(Math.abs(Re)<2e-6||!isFinite(ot)){if(Math.abs(Se-Ee)<1e-6)return this.easeTo(o,f);const dt=Ee<Se?-1:1;ot=Math.abs(Math.log(Ee/Se))/we,st=()=>0,ut=kt=>Math.exp(dt*we*kt)}return o.duration="duration"in o?+o.duration:1e3*ot/("screenSpeed"in o?+o.screenSpeed/we:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=b!==B,this._pitching=W!==P,this._rolling=G!==E,this._padding=!x.isPaddingEqual(Y),this._prepareEase(f,!1),this.terrain&&this._prepareElevation(je.targetCenter),this._ease(dt=>{const kt=dt*ot,Et=1/ut(kt),bt=st(kt);this._rotating&&x.setBearing(a.F.number(b,B,dt)),this._pitching&&x.setPitch(a.F.number(P,W,dt)),this._rolling&&x.setRoll(a.F.number(E,G,dt)),this._padding&&(x.interpolatePadding(F,Y,dt),re=x.centerPoint.add(Z)),je.easeFunc(dt,Et,bt,re),this.terrain&&!o.freezeElevation&&this._updateElevation(dt),this._applyUpdatedTransform(x),this._fireMoveEvents(f)},()=>{this.terrain&&o.freezeElevation&&this._finalizeElevation(),this._afterEase(f)},o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,f){var x;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const b=this._onEaseEnd;delete this._onEaseEnd,b.call(this,f)}return o||(x=this.handlers)===null||x===void 0||x.stop(!1),this}_ease(o,f,x){x.animate===!1||x.duration===0?(o(1),f()):(this._easeStart=k(),this._easeOptions=x,this._onEaseFrame=o,this._onEaseEnd=f,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(o,f){o=a.V(o,-180,180);const x=Math.abs(o-f);return Math.abs(o-360-f)<x&&(o-=360),Math.abs(o+360-f)<x&&(o+=360),o}queryTerrainElevation(o){return this.terrain?this.terrain.getElevationForLngLatZoom(a.U.convert(o),this.transform.tileZoom):null}}const Vf={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Xi{constructor(o=Vf){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=f=>{!f||f.sourceDataType!=="metadata"&&f.sourceDataType!=="visibility"&&f.dataType!=="style"&&f.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=o}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options.compact,this._container=N.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=N.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=N.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){N.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,f){const x=this._map._getUIString(`AttributionControl.${f}`);o.title=x,o.setAttribute("aria-label",x)}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(b=>typeof b!="string"?"":b)):typeof this.options.customAttribution=="string"&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}const f=this._map.style.tileManagers;for(const b in f){const P=f[b];if(P.used||P.usedForTerrain){const E=P.getSource();E.attribution&&o.indexOf(E.attribution)<0&&o.push(E.attribution)}}o=o.filter(b=>String(b).trim()),o.sort((b,P)=>b.length-P.length),o=o.filter((b,P)=>{for(let E=P+1;E<o.length;E++)if(o[E].indexOf(b)>=0)return!1;return!0});const x=o.join(" | ");x!==this._attribHTML&&(this._attribHTML=x,o.length?(this._innerContainer.innerHTML=N.sanitize(x),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Fv{constructor(o={}){this._updateCompact=()=>{const f=this._container.children;if(f.length){const x=f[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&x.classList.add("maplibregl-compact"):x.classList.remove("maplibregl-compact")}},this.options=o}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=N.create("div","maplibregl-ctrl");const f=N.create("a","maplibregl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://maplibre.org/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){N.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class ko{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const f=++this._id;return this._queue.push({callback:o,id:f,cancelled:!1}),f}remove(o){const f=this._currentlyRunning,x=f?this._queue.concat(f):this._queue;for(const b of x)if(b.id===o)return void(b.cancelled=!0)}run(o=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const f=this._currentlyRunning=this._queue;this._queue=[];for(const x of f)if(!x.cancelled&&(x.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Jj=a.aN([{name:"a_pos3d",type:"Int16",components:3}]);class VP extends a.E{constructor(o){super(),this._lastTilesetChange=k(),this.tileManager=o,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=o._source.tileSize*2**this.deltaZoom,o.usedForTerrain=!0,o.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(o,f){this.tileManager.update(o,f),this._renderableTilesKeys=[];const x={};for(const b of Nn(o,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:f,calculateTileZoom:this.tileManager._source.calculateTileZoom}))x[b.key]=!0,this._renderableTilesKeys.push(b.key),this._tiles[b.key]||(b.terrainRttPosMatrix32f=new Float64Array(16),a.c0(b.terrainRttPosMatrix32f,0,a.a3,a.a3,0,0,1),this._tiles[b.key]=new Fe(b,this.tileSize),this._lastTilesetChange=k());for(const b in this._tiles)x[b]||delete this._tiles[b]}freeRtt(o){for(const f in this._tiles){const x=this._tiles[f];(!o||x.tileID.equals(o)||x.tileID.isChildOf(o)||o.isChildOf(x.tileID))&&(x.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(o=>this.getTileByID(o))}getTileByID(o){return this._tiles[o]}getTerrainCoords(o,f){return f?this._getTerrainCoordsForTileRanges(o,f):this._getTerrainCoordsForRegularTile(o)}_getTerrainCoordsForRegularTile(o){const f={};for(const x of this._renderableTilesKeys){const b=this._tiles[x].tileID,P=o.clone(),E=a.bd();if(b.canonical.equals(o.canonical))a.c0(E,0,a.a3,a.a3,0,0,1);else if(b.canonical.isChildOf(o.canonical)){const F=b.canonical.z-o.canonical.z,B=b.canonical.x-(b.canonical.x>>F<<F),W=b.canonical.y-(b.canonical.y>>F<<F),G=a.a3>>F;a.c0(E,0,G,G,0,0,1),a.N(E,E,[-B*G,-W*G,0])}else{if(!o.canonical.isChildOf(b.canonical))continue;{const F=o.canonical.z-b.canonical.z,B=o.canonical.x-(o.canonical.x>>F<<F),W=o.canonical.y-(o.canonical.y>>F<<F),G=a.a3>>F;a.c0(E,0,a.a3,a.a3,0,0,1),a.N(E,E,[B*G,W*G,0]),a.O(E,E,[1/2**F,1/2**F,0])}}P.terrainRttPosMatrix32f=new Float32Array(E),f[x]=P}return f}_getTerrainCoordsForTileRanges(o,f){const x={};for(const b of this._renderableTilesKeys){const P=this._tiles[b].tileID;if(!this._isWithinTileRanges(P,f))continue;const E=o.clone(),F=a.bd();if(P.canonical.z===o.canonical.z){const B=o.canonical.x-P.canonical.x,W=o.canonical.y-P.canonical.y;a.c0(F,0,a.a3,a.a3,0,0,1),a.N(F,F,[B*a.a3,W*a.a3,0])}else if(P.canonical.z>o.canonical.z){const B=P.canonical.z-o.canonical.z,W=P.canonical.x-(P.canonical.x>>B<<B),G=P.canonical.y-(P.canonical.y>>B<<B),Y=o.canonical.x-(P.canonical.x>>B),Z=o.canonical.y-(P.canonical.y>>B),re=a.a3>>B;a.c0(F,0,re,re,0,0,1),a.N(F,F,[-W*re+Y*a.a3,-G*re+Z*a.a3,0])}else{const B=o.canonical.z-P.canonical.z,W=o.canonical.x-(o.canonical.x>>B<<B),G=o.canonical.y-(o.canonical.y>>B<<B),Y=(o.canonical.x>>B)-P.canonical.x,Z=(o.canonical.y>>B)-P.canonical.y,re=a.a3<<B;a.c0(F,0,re,re,0,0,1),a.N(F,F,[W*a.a3+Y*re,G*a.a3+Z*re,0])}E.terrainRttPosMatrix32f=new Float32Array(F),x[b]=E}return x}getSourceTile(o,f){const x=this.tileManager._source;let b=o.overscaledZ-this.deltaZoom;if(b>x.maxzoom&&(b=x.maxzoom),b<x.minzoom)return null;this._sourceTileCache[o.key]||(this._sourceTileCache[o.key]=o.scaledTo(b).key);let P=this.tileManager.getTileByID(this._sourceTileCache[o.key]);if((!P||!P.dem)&&f)for(;b>=x.minzoom&&(!P||!P.dem);)P=this.tileManager.getTileByID(o.scaledTo(b--).key);return P}anyTilesAfterTime(o=Date.now()){return this._lastTilesetChange>=o}_isWithinTileRanges(o,f){return f[o.canonical.z]&&o.canonical.x>=f[o.canonical.z].minTileX&&o.canonical.x<=f[o.canonical.z].maxTileX&&o.canonical.y>=f[o.canonical.z].minTileY&&o.canonical.y<=f[o.canonical.z].maxTileY}}class UP{constructor(o,f,x){this._meshCache={},this.painter=o,this.tileManager=new VP(f),this.options=x,this.exaggeration=typeof x.exaggeration=="number"?x.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(o,f,x,b=a.a3){var P;if(!(f>=0&&f<b&&x>=0&&x<b))return 0;const E=this.getTerrainData(o),F=(P=E.tile)===null||P===void 0?void 0:P.dem;if(!F)return 0;const B=a.cv([],[f/b*a.a3,x/b*a.a3],E.u_terrain_matrix),W=[B[0]*F.dim,B[1]*F.dim],G=Math.floor(W[0]),Y=Math.floor(W[1]),Z=W[0]-G,re=W[1]-Y;return F.get(G,Y)*(1-Z)*(1-re)+F.get(G+1,Y)*Z*(1-re)+F.get(G,Y+1)*(1-Z)*re+F.get(G+1,Y+1)*Z*re}getElevationForLngLatZoom(o,f){if(!a.cw(f,o.wrap()))return 0;const{tileID:x,mercatorX:b,mercatorY:P}=this._getOverscaledTileIDFromLngLatZoom(o,f);return this.getElevation(x,b%a.a3,P%a.a3,a.a3)}getElevation(o,f,x,b=a.a3){return this.getDEMElevation(o,f,x,b)*this.exaggeration}getTerrainData(o){if(!this._emptyDemTexture){const b=this.painter.context,P=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new a.T(b,P,b.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new a.T(b,new a.R({width:1,height:1}),b.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(b.gl.NEAREST,b.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.am([])}const f=this.tileManager.getSourceTile(o,!0);if(f&&f.dem&&(!f.demTexture||f.needsTerrainPrepare)){const b=this.painter.context;f.demTexture=this.painter.getTileTexture(f.dem.stride),f.demTexture?f.demTexture.update(f.dem.getPixels(),{premultiply:!1}):f.demTexture=new a.T(b,f.dem.getPixels(),b.gl.RGBA,{premultiply:!1}),f.demTexture.bind(b.gl.NEAREST,b.gl.CLAMP_TO_EDGE),f.needsTerrainPrepare=!1}const x=f&&f+f.tileID.key+o.key;if(x&&!this._demMatrixCache[x]){const b=this.tileManager.getSource().maxzoom;let P=o.canonical.z-f.tileID.canonical.z;o.overscaledZ>o.canonical.z&&(o.canonical.z>=b?P=o.canonical.z-b:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=o.canonical.x-(o.canonical.x>>P<<P),F=o.canonical.y-(o.canonical.y>>P<<P),B=a.cx(new Float64Array(16),[1/(a.a3<<P),1/(a.a3<<P),0]);a.N(B,B,[E*a.a3,F*a.a3,0]),this._demMatrixCache[o.key]={matrix:B,coord:o}}return{u_depth:2,u_terrain:3,u_terrain_dim:f&&f.dem&&f.dem.dim||1,u_terrain_matrix:x?this._demMatrixCache[o.key].matrix:this._emptyDemMatrix,u_terrain_unpack:f&&f.dem&&f.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(f&&f.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:f}}getFramebuffer(o){const f=this.painter,x=f.width/devicePixelRatio,b=f.height/devicePixelRatio;return!this._fbo||this._fbo.width===x&&this._fbo.height===b||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new a.T(f.context,{width:x,height:b,data:null},f.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(f.context.gl.NEAREST,f.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new a.T(f.context,{width:x,height:b,data:null},f.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(f.context.gl.NEAREST,f.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=f.context.createFramebuffer(x,b,!0,!1),this._fbo.depthAttachment.set(f.context.createRenderbuffer(f.context.gl.DEPTH_COMPONENT16,x,b))),this._fbo.colorAttachment.set(o==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const o=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const f=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let P=0,E=0;P<this._coordsTextureSize;P++)for(let F=0;F<this._coordsTextureSize;F++,E+=4)f[E+0]=255&F,f[E+1]=255&P,f[E+2]=F>>8<<4|P>>8,f[E+3]=0;const x=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(f.buffer)),b=new a.T(o,x,o.gl.RGBA,{premultiply:!1});return b.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),this._coordsTexture=b,b}pointCoordinate(o){this.painter.maybeDrawDepthAndCoords(!0);const f=new Uint8Array(4),x=this.painter.context,b=x.gl,P=Math.round(o.x*this.painter.pixelRatio/devicePixelRatio),E=Math.round(o.y*this.painter.pixelRatio/devicePixelRatio),F=Math.round(this.painter.height/devicePixelRatio);x.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),b.readPixels(P,F-E-1,1,1,b.RGBA,b.UNSIGNED_BYTE,f),x.bindFramebuffer.set(null);const B=f[0]+(f[2]>>4<<8),W=f[1]+((15&f[2])<<8),G=this.coordsIndex[255-f[3]],Y=G&&this.tileManager.getTileByID(G);if(!Y)return null;const Z=this._coordsTextureSize,re=(1<<Y.tileID.canonical.z)*Z;return new a.a5((Y.tileID.canonical.x*Z+B)/re+Y.tileID.wrap,(Y.tileID.canonical.y*Z+W)/re,this.getElevation(Y.tileID,B,W,Z))}depthAtPoint(o){const f=new Uint8Array(4),x=this.painter.context,b=x.gl;return x.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),b.readPixels(o.x,this.painter.height/devicePixelRatio-o.y-1,1,1,b.RGBA,b.UNSIGNED_BYTE,f),x.bindFramebuffer.set(null),(f[0]/16777216+f[1]/65536+f[2]/256+f[3])/256}getTerrainMesh(o){var f;const x=((f=this.painter.style.projection)===null||f===void 0?void 0:f.transitionState)>0,b=x&&o.canonical.y===0,P=x&&o.canonical.y===(1<<o.canonical.z)-1,E=`m_${b?"n":""}_${P?"s":""}`;if(this._meshCache[E])return this._meshCache[E];const F=this.painter.context,B=new a.cy,W=new a.aR,G=this.meshSize,Y=a.a3/G,Z=G*G;for(let Ie=0;Ie<=G;Ie++)for(let Ke=0;Ke<=G;Ke++)B.emplaceBack(Ke*Y,Ie*Y,0);for(let Ie=0;Ie<Z;Ie+=G+1)for(let Ke=0;Ke<G;Ke++)W.emplaceBack(Ke+Ie,G+Ke+Ie+1,G+Ke+Ie+2),W.emplaceBack(Ke+Ie,G+Ke+Ie+2,Ke+Ie+1);const re=B.length,he=re+(G+1),je=(G+1)*G,we=b?a.bk:0,Se=b?0:1,Ee=P?a.bl:a.a3,Re=P?0:1;for(let Ie=0;Ie<=G;Ie++)B.emplaceBack(Ie*Y,we,Se);for(let Ie=0;Ie<=G;Ie++)B.emplaceBack(Ie*Y,Ee,Re);for(let Ie=0;Ie<G;Ie++)W.emplaceBack(je+Ie,he+Ie,he+Ie+1),W.emplaceBack(je+Ie,he+Ie+1,je+Ie+1),W.emplaceBack(0+Ie,re+Ie+1,re+Ie),W.emplaceBack(0+Ie,0+Ie+1,re+Ie+1);const Te=B.length,Le=Te+2*(G+1);for(const Ie of[0,1])for(let Ke=0;Ke<=G;Ke++)for(const ut of[0,1])B.emplaceBack(Ie*a.a3,Ke*Y,ut);for(let Ie=0;Ie<2*G;Ie+=2)W.emplaceBack(Te+Ie,Te+Ie+1,Te+Ie+3),W.emplaceBack(Te+Ie,Te+Ie+3,Te+Ie+2),W.emplaceBack(Le+Ie,Le+Ie+3,Le+Ie+1),W.emplaceBack(Le+Ie,Le+Ie+2,Le+Ie+3);const $e=new Md(F.createVertexBuffer(B,Jj.members),F.createIndexBuffer(W),a.aQ.simpleSegment(0,0,B.length,W.length));return this._meshCache[E]=$e,$e}getMeshFrameDelta(o){return 2*Math.PI*a.bx/Math.pow(2,Math.max(o,0))/5}getMinTileElevationForLngLatZoom(o,f){var x;const{tileID:b}=this._getOverscaledTileIDFromLngLatZoom(o,f);return(x=this.getMinMaxElevation(b).minElevation)!==null&&x!==void 0?x:0}getMinMaxElevation(o){const f=this.getTerrainData(o).tile,x={minElevation:null,maxElevation:null};return f&&f.dem&&(x.minElevation=f.dem.min*this.exaggeration,x.maxElevation=f.dem.max*this.exaggeration),x}_getOverscaledTileIDFromLngLatZoom(o,f){const x=a.a5.fromLngLat(o.wrap()),b=(1<<f)*a.a3,P=x.x*b,E=x.y*b,F=Math.floor(P/a.a3),B=Math.floor(E/a.a3);return{tileID:new a.a0(f,0,f,F,B),mercatorX:P,mercatorY:E}}}class WP{constructor(o,f,x){this._context=o,this._size=f,this._tileSize=x,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const o of this._objects)o.texture.destroy(),o.fbo.destroy()}_createObject(o){const f=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),x=new a.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return x.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),f.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),f.colorAttachment.set(x.texture),{id:o,fbo:f,texture:x,stamp:-1,inUse:!1}}getObjectForId(o){return this._objects[o]}useObject(o){o.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(f=>o.id!==f),this._recentlyUsed.push(o.id)}stampObject(o){o.stamp=++this._stamp}getOrCreateFreeObject(){for(const f of this._recentlyUsed)if(!this._objects[f].inUse)return this._objects[f];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const o=this._createObject(this._objects.length);return this._objects.push(o),o}freeObject(o){o.inUse=!1}freeAllObjects(){for(const o of this._objects)this.freeObject(o)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(o=>!o.inUse)===!1}}const ll={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class us{constructor(o,f){this.painter=o,this.terrain=f,this.pool=new WP(o.context,30,f.tileManager.tileSize*f.qualityFactor)}destruct(){this.pool.destruct()}getTexture(o){return this.pool.getObjectForId(o.rtt[this._stacks.length-1].id).texture}prepareForRender(o,f){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=o._order.filter(x=>!o._layers[x].isHidden(f)),this._coordsAscending={};for(const x in o.tileManagers){this._coordsAscending[x]={};const b=o.tileManagers[x].getVisibleCoordinates(),P=o.tileManagers[x].getSource(),E=P instanceof Rt?P.terrainTileRanges:null;for(const F of b){const B=this.terrain.tileManager.getTerrainCoords(F,E);for(const W in B)this._coordsAscending[x][W]||(this._coordsAscending[x][W]=[]),this._coordsAscending[x][W].push(B[W])}}this._coordsAscendingStr={};for(const x of o._order){const b=o._layers[x],P=b.source;if(ll[b.type]&&!this._coordsAscendingStr[P]){this._coordsAscendingStr[P]={};for(const E in this._coordsAscending[P])this._coordsAscendingStr[P][E]=this._coordsAscending[P][E].map(F=>F.key).sort().join()}}for(const x of this._renderableTiles)for(const b in this._coordsAscendingStr){const P=this._coordsAscendingStr[b][x.tileID.key];P&&P!==x.rttCoords[b]&&(x.rtt=[])}}renderLayer(o,f){if(o.isHidden(this.painter.transform.zoom))return!1;const x=Object.assign(Object.assign({},f),{isRenderingToTexture:!0}),b=o.type,P=this.painter,E=this._renderableLayerIds[this._renderableLayerIds.length-1]===o.id;if(ll[b]&&(this._prevType&&ll[this._prevType]||this._stacks.push([]),this._prevType=b,this._stacks[this._stacks.length-1].push(o.id),!E))return!0;if(ll[this._prevType]||ll[b]&&E){this._prevType=b;const F=this._stacks.length-1,B=this._stacks[F]||[];for(const W of this._renderableTiles){if(this.pool.isFull()&&(Pv(this.painter,this.terrain,this._rttTiles,x),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(W),W.rtt[F]){const Y=this.pool.getObjectForId(W.rtt[F].id);if(Y.stamp===W.rtt[F].stamp){this.pool.useObject(Y);continue}}const G=this.pool.getOrCreateFreeObject();this.pool.useObject(G),this.pool.stampObject(G),W.rtt[F]={id:G.id,stamp:G.stamp},P.context.bindFramebuffer.set(G.fbo.framebuffer),P.context.clear({color:a.bi.transparent,stencil:0}),P.currentStencilSource=void 0;for(let Y=0;Y<B.length;Y++){const Z=P.style._layers[B[Y]],re=Z.source?this._coordsAscending[Z.source][W.tileID.key]:[W.tileID];P.context.viewport.set([0,0,G.fbo.width,G.fbo.height]),P._renderTileClippingMasks(Z,re,!0),P.renderLayer(P,P.style.tileManagers[Z.source],Z,re,x),Z.source&&(W.rttCoords[Z.source]=this._coordsAscendingStr[Z.source][W.tileID.key])}}return Pv(this.painter,this.terrain,this._rttTiles,x),this._rttTiles=[],this.pool.freeAllObjects(),ll[b]}return!1}}const Ms={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ew=m,Gd={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Vf,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},$p={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class zv{constructor(o,f,x=!1){this.mousedown=P=>{this.startMove(P,N.mousePos(this.element,P)),N.addEventListener(window,"mousemove",this.mousemove),N.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=P=>{this.move(P,N.mousePos(this.element,P))},this.mouseup=P=>{this._rotatePitchHandler.dragEnd(P),this.offTemp()},this.touchstart=P=>{P.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=N.touchPos(this.element,P.targetTouches)[0],this.startMove(P,this._startPos),N.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.addEventListener(window,"touchend",this.touchend))},this.touchmove=P=>{P.targetTouches.length!==1?this.reset():(this._lastPos=N.touchPos(this.element,P.targetTouches)[0],this.move(P,this._lastPos))},this.touchend=P=>{P.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=f;const b=new Ev;this._rotatePitchHandler=new Kt({clickTolerance:3,move:(P,E)=>{const F=f.getBoundingClientRect(),B=new a.P((F.bottom-F.top)/2,(F.right-F.left)/2);return{bearingDelta:a.cq(new a.P(P.x,E.y),E,B),pitchDelta:x?-.5*(E.y-P.y):void 0}},moveStateManager:b,enable:!0,assignEvents:()=>{}}),this.map=o,N.addEventListener(f,"mousedown",this.mousedown),N.addEventListener(f,"touchstart",this.touchstart,{passive:!1}),N.addEventListener(f,"touchcancel",this.reset)}startMove(o,f){this._rotatePitchHandler.dragStart(o,f),N.disableDrag()}move(o,f){const x=this.map,{bearingDelta:b,pitchDelta:P}=this._rotatePitchHandler.dragMove(o,f)||{};b&&x.setBearing(x.getBearing()+b),P&&x.setPitch(x.getPitch()+P)}off(){const o=this.element;N.removeEventListener(o,"mousedown",this.mousedown),N.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),N.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.removeEventListener(window,"touchend",this.touchend),N.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){N.enableDrag(),N.removeEventListener(window,"mousemove",this.mousemove),N.removeEventListener(window,"mouseup",this.mouseup),N.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.removeEventListener(window,"touchend",this.touchend)}}let Bl;function Bp(w,o,f,x=!1){if(x||!f.getCoveringTilesDetailsProvider().allowWorldCopies())return w==null?void 0:w.wrap();const b=new a.U(w.lng,w.lat);if(w=new a.U(w.lng,w.lat),o){const P=new a.U(w.lng-360,w.lat),E=new a.U(w.lng+360,w.lat),F=f.locationToScreenPoint(w).distSqr(o);f.locationToScreenPoint(P).distSqr(o)<F?w=P:f.locationToScreenPoint(E).distSqr(o)<F&&(w=E)}for(;Math.abs(w.lng-f.center.lng)>180;){const P=f.locationToScreenPoint(w);if(P.x>=0&&P.y>=0&&P.x<=f.width&&P.y<=f.height)break;w.lng>f.center.lng?w.lng-=360:w.lng+=360}return w.lng!==b.lng&&f.isPointOnMapSurface(f.locationToScreenPoint(w))?w:b}const Nu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function qp(w,o,f){const x=w.classList;for(const b in Nu)x.remove(`maplibregl-${f}-anchor-${b}`);x.add(`maplibregl-${f}-anchor-${o}`)}class Uf extends a.E{constructor(o){if(super(),this._onKeyPress=f=>{const x=f.code,b=f.charCode||f.keyCode;x!=="Space"&&x!=="Enter"&&b!==32&&b!==13||this.togglePopup()},this._onMapClick=f=>{const x=f.originalEvent.target,b=this._element;this._popup&&(x===b||b.contains(x))&&this.togglePopup()},this._update=f=>{if(!this._map)return;const x=this._map.loaded()&&!this._map.isMoving();((f==null?void 0:f.type)==="terrain"||(f==null?void 0:f.type)==="render"&&!x)&&this._map.once("render",this._update),this._lngLat=Bp(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let b="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?b=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(b=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let P="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?P="rotateX(0deg)":this._pitchAlignment==="map"&&(P=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||f&&f.type!=="moveend"||(this._pos=this._pos.round()),N.setTransform(this._element,`${Nu[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${P} ${b}`),j.frameAsync(new AbortController).then(()=>{this._updateOpacity(f&&f.type==="moveend")}).catch(()=>{})},this._onMove=f=>{if(!this._isDragging){const x=this._clickTolerance||this._map._clickTolerance;this._isDragging=f.point.dist(this._pointerdownPos)>=x}this._isDragging&&(this._pos=f.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.l("dragstart"))),this.fire(new a.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.l("dragend")),this._state="inactive"},this._addDragHandler=f=>{this._element.contains(f.originalEvent.target)&&(f.preventDefault(),this._positionDelta=f.point.sub(this._pos).add(this._offset),this._pointerdownPos=f.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._subpixelPositioning=o&&o.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,this.setOpacity(o==null?void 0:o.opacity,o==null?void 0:o.opacityWhenCovered),o&&o.element)this._element=o.element,this._offset=a.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=N.create("div");const f=N.createNS("http://www.w3.org/2000/svg","svg"),x=41,b=27;f.setAttributeNS(null,"display","block"),f.setAttributeNS(null,"height",`${x}px`),f.setAttributeNS(null,"width",`${b}px`),f.setAttributeNS(null,"viewBox",`0 0 ${b} ${x}`);const P=N.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"stroke","none"),P.setAttributeNS(null,"stroke-width","1"),P.setAttributeNS(null,"fill","none"),P.setAttributeNS(null,"fill-rule","evenodd");const E=N.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const F=N.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"transform","translate(3.0, 29.0)"),F.setAttributeNS(null,"fill","#000000");const B=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Se of B){const Ee=N.createNS("http://www.w3.org/2000/svg","ellipse");Ee.setAttributeNS(null,"opacity","0.04"),Ee.setAttributeNS(null,"cx","10.5"),Ee.setAttributeNS(null,"cy","5.80029008"),Ee.setAttributeNS(null,"rx",Se.rx),Ee.setAttributeNS(null,"ry",Se.ry),F.appendChild(Ee)}const W=N.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"fill",this._color);const G=N.createNS("http://www.w3.org/2000/svg","path");G.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),W.appendChild(G);const Y=N.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"opacity","0.25"),Y.setAttributeNS(null,"fill","#000000");const Z=N.createNS("http://www.w3.org/2000/svg","path");Z.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Y.appendChild(Z);const re=N.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"transform","translate(6.0, 7.0)"),re.setAttributeNS(null,"fill","#FFFFFF");const he=N.createNS("http://www.w3.org/2000/svg","g");he.setAttributeNS(null,"transform","translate(8.0, 8.0)");const je=N.createNS("http://www.w3.org/2000/svg","circle");je.setAttributeNS(null,"fill","#000000"),je.setAttributeNS(null,"opacity","0.25"),je.setAttributeNS(null,"cx","5.5"),je.setAttributeNS(null,"cy","5.5"),je.setAttributeNS(null,"r","5.4999962");const we=N.createNS("http://www.w3.org/2000/svg","circle");we.setAttributeNS(null,"fill","#FFFFFF"),we.setAttributeNS(null,"cx","5.5"),we.setAttributeNS(null,"cy","5.5"),we.setAttributeNS(null,"r","5.4999962"),he.appendChild(je),he.appendChild(we),E.appendChild(F),E.appendChild(W),E.appendChild(Y),E.appendChild(re),E.appendChild(he),f.appendChild(E),f.setAttributeNS(null,"height",x*this._scale+"px"),f.setAttributeNS(null,"width",b*this._scale+"px"),this._element.appendChild(f),this._offset=a.P.convert(o&&o.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",f=>{f.preventDefault()}),this._element.addEventListener("mousedown",f=>{f.preventDefault()}),qp(this._element,this._anchor,"marker"),o&&o.className)for(const f of o.className.split(" "))this._element.classList.add(f);this._popup=null}addTo(o){return this.remove(),this._map=o,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",o._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),o.on("terrain",this._update),o.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),N.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=a.U.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const b=Math.abs(13.5)/Math.SQRT2;o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(38.1-13.5+b)],"bottom-right":[-b,-1*(38.1-13.5+b)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(o){return this._subpixelPositioning=o,this}getPopup(){return this._popup}togglePopup(){const o=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:o?(o.isOpen()?o.remove():(o.setLngLat(this._lngLat),o.addTo(this._map)),this):this}_updateOpacity(o=!1){var f,x;const b=(f=this._map)===null||f===void 0?void 0:f.terrain,P=this._map.transform.isLocationOccluded(this._lngLat);if(!b||P){const re=P?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==re&&(this._element.style.opacity=re))}if(o)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const E=this._map,F=E.terrain.depthAtPoint(this._pos),B=E.terrain.getElevationForLngLatZoom(this._lngLat,E.transform.tileZoom);if(E.transform.lngLatToCameraDepth(this._lngLat,B)-F<.006)return void(this._element.style.opacity=this._opacity);const W=-this._offset.y/E.transform.pixelsPerMeter,G=Math.sin(E.getPitch()*Math.PI/180)*W,Y=E.terrain.depthAtPoint(new a.P(this._pos.x,this._pos.y-this._offset.y)),Z=E.transform.lngLatToCameraDepth(this._lngLat,B+G)-Y>.006;!((x=this._popup)===null||x===void 0)&&x.isOpen()&&Z&&this._popup.remove(),this._element.style.opacity=Z?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(o){return this._offset=a.P.convert(o),this._update(),this}addClassName(o){this._element.classList.add(o)}removeClassName(o){this._element.classList.remove(o)}toggleClassName(o){return this._element.classList.toggle(o)}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(o,f){return(this._opacity===void 0||o===void 0&&f===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),o!==void 0&&(this._opacity=o),f!==void 0&&(this._opacityWhenCovered=f),this._map&&this._updateOpacity(!0),this}}const $v={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Kd=0,Pu=!1;const Bv={maxWidth:100,unit:"metric"};function Vp(w,o,f){const x=f&&f.maxWidth||100,b=w._container.clientHeight/2,P=w._container.clientWidth/2,E=w.unproject([P-x/2,b]),F=w.unproject([P+x/2,b]),B=Math.round(w.project(F).x-w.project(E).x),W=Math.min(x,B,w._container.clientWidth),G=E.distanceTo(F);if(f&&f.unit==="imperial"){const Y=3.2808*G;Y>5280?Cu(o,W,Y/5280,w._getUIString("ScaleControl.Miles")):Cu(o,W,Y,w._getUIString("ScaleControl.Feet"))}else f&&f.unit==="nautical"?Cu(o,W,G/1852,w._getUIString("ScaleControl.NauticalMiles")):G>=1e3?Cu(o,W,G/1e3,w._getUIString("ScaleControl.Kilometers")):Cu(o,W,G,w._getUIString("ScaleControl.Meters"))}function Cu(w,o,f,x){const b=function(P){const E=Math.pow(10,`${Math.floor(P)}`.length-1);let F=P/E;return F=F>=10?10:F>=5?5:F>=3?3:F>=2?2:F>=1?1:function(B){const W=Math.pow(10,Math.ceil(-Math.log(B)/Math.LN10));return Math.round(B*W)/W}(F),E*F}(f);w.style.width=o*(b/f)+"px",w.innerHTML=`${b}&nbsp;${x}`}const qv={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Up=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Wp(w){if(w){if(typeof w=="number"){const o=Math.round(Math.abs(w)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,w),"top-left":new a.P(o,o),"top-right":new a.P(-o,o),bottom:new a.P(0,-w),"bottom-left":new a.P(o,-o),"bottom-right":new a.P(-o,-o),left:new a.P(w,0),right:new a.P(-w,0)}}if(w instanceof a.P||Array.isArray(w)){const o=a.P.convert(w);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:a.P.convert(w.center||[0,0]),top:a.P.convert(w.top||[0,0]),"top-left":a.P.convert(w["top-left"]||[0,0]),"top-right":a.P.convert(w["top-right"]||[0,0]),bottom:a.P.convert(w.bottom||[0,0]),"bottom-left":a.P.convert(w["bottom-left"]||[0,0]),"bottom-right":a.P.convert(w["bottom-right"]||[0,0]),left:a.P.convert(w.left||[0,0]),right:a.P.convert(w.right||[0,0])}}return Wp(new a.P(0,0))}const Vv=m;u.AJAXError=a.cC,u.Event=a.l,u.Evented=a.E,u.LngLat=a.U,u.MercatorCoordinate=a.a5,u.Point=a.P,u.addProtocol=a.cD,u.config=a.a,u.removeProtocol=a.cE,u.AttributionControl=Xi,u.BoxZoomHandler=$j,u.CanvasSource=tr,u.CooperativeGesturesHandler=Ao,u.DoubleClickZoomHandler=Bf,u.DragPanHandler=Rv,u.DragRotateHandler=Lv,u.EdgeInsets=Vs,u.FullscreenControl=class extends a.E{constructor(w={}){super(),this._onFullscreenChange=()=>{var o;let f=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((o=f==null?void 0:f.shadowRoot)===null||o===void 0)&&o.fullscreenElement;)f=f.shadowRoot.fullscreenElement;f===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,w&&w.container&&(w.container instanceof HTMLElement?this._container=w.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(w){return this._map=w,this._container||(this._container=this._map.getContainer()),this._controlContainer=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){N.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const w=this._fullscreenButton=N.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);N.create("span","maplibregl-ctrl-icon",w).setAttribute("aria-hidden","true"),w.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const w=this._getTitle();this._fullscreenButton.setAttribute("aria-label",w),this._fullscreenButton.title=w}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new a.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},u.GeoJSONSource=Lt,u.GeolocateControl=class extends a.E{constructor(w){super(),this._onSuccess=o=>{if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new a.l("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.l("geolocate",o)),this._finish()}},this._updateCamera=o=>{const f=new a.U(o.coords.longitude,o.coords.latitude),x=o.coords.accuracy,b=this._map.getBearing(),P=a.e({bearing:b},this.options.fitBoundsOptions),E=Lr.fromLngLat(f,x);this._map.fitBounds(E,P,{geolocateSource:!0})},this._updateMarker=o=>{if(o){const f=new a.U(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(f).addTo(this._map),this._userLocationDotMarker.setLngLat(f).addTo(this._map),this._accuracy=o.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=o=>{if(this._map){if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const f=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=f,this._geolocateButton.setAttribute("aria-label",f),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&Pu)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.l("error",o)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=N.create("button","maplibregl-ctrl-geolocate",this._container),N.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=o=>{if(this._map){if(o===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const f=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=f,this._geolocateButton.setAttribute("aria-label",f)}else{const f=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=f,this._geolocateButton.setAttribute("aria-label",f)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=N.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Uf({element:this._dotElement}),this._circleElement=N.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Uf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",f=>{const x=(f==null?void 0:f[0])instanceof ResizeObserverEntry;f.geolocateSource||this._watchState!=="ACTIVE_LOCK"||x||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.l("trackuserlocationend")),this.fire(new a.l("userlocationlostfocus")))})}},this.options=a.e({},$v,w)}onAdd(w){return this._map=w,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return a._(this,arguments,void 0,function*(o=!1){if(Bl!==void 0&&!o)return Bl;if(window.navigator.permissions===void 0)return Bl=!!window.navigator.geolocation,Bl;try{Bl=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Bl=!!window.navigator.geolocation}return Bl})}().then(o=>this._finishSetupUI(o)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),N.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Kd=0,Pu=!1}_isOutOfMapMaxBounds(w){const o=this._map.getMaxBounds(),f=w.coords;return o&&(f.longitude<o.getWest()||f.longitude>o.getEast()||f.latitude<o.getSouth()||f.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const w=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&w))return;const o=this._map.project(w),f=this._map.unproject([o.x+100,o.y]),x=w.distanceTo(f)/100,b=2*this._accuracy/x;this._circleElement.style.width=`${b.toFixed(2)}px`,this._circleElement.style.height=`${b.toFixed(2)}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Kd--,Pu=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.l("trackuserlocationstart")),this.fire(new a.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let w;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Kd++,Kd>1?(w={maximumAge:6e5,timeout:0},Pu=!0):(w=this.options.positionOptions,Pu=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,w)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},u.GlobeControl=class{constructor(){this._toggleProjection=()=>{var w;const o=(w=this._map.getProjection())===null||w===void 0?void 0:w.type;this._map.setProjection(o!=="mercator"&&o?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var w;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((w=this._map.getProjection())===null||w===void 0?void 0:w.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(w){return this._map=w,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=N.create("button","maplibregl-ctrl-globe",this._container),N.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){N.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},u.Hash=Av,u.ImageSource=Rt,u.KeyboardHandler=Hj,u.LngLatBounds=Lr,u.LogoControl=Fv,u.Map=class extends Qj{constructor(w){var o,f;a.cz.mark(a.cA.create);const x=Object.assign(Object.assign(Object.assign({},Gd),w),{canvasContextAttributes:Object.assign(Object.assign({},Gd.canvasContextAttributes),w.canvasContextAttributes)});if(x.minZoom!=null&&x.maxZoom!=null&&x.minZoom>x.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(x.minPitch!=null&&x.maxPitch!=null&&x.minPitch>x.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(x.minPitch!=null&&x.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(x.maxPitch!=null&&x.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const b=new al,P=new fu;if(x.minZoom!==void 0&&b.setMinZoom(x.minZoom),x.maxZoom!==void 0&&b.setMaxZoom(x.maxZoom),x.minPitch!==void 0&&b.setMinPitch(x.minPitch),x.maxPitch!==void 0&&b.setMaxPitch(x.maxPitch),x.renderWorldCopies!==void 0&&b.setRenderWorldCopies(x.renderWorldCopies),x.transformConstrain!==null&&b.setConstrain(x.transformConstrain),super(b,P,{bearingSnap:x.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new ko,this._controls=[],this._mapId=a.ab(),this._contextLost=F=>{F.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new a.l("webglcontextlost",{originalEvent:F}))},this._contextRestored=F=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.l("webglcontextrestored",{originalEvent:F}))},this._onMapScroll=F=>{if(F.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=x.interactive,this._maxTileCacheSize=x.maxTileCacheSize,this._maxTileCacheZoomLevels=x.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},x.canvasContextAttributes),this._trackResize=x.trackResize===!0,this._bearingSnap=x.bearingSnap,this._centerClampedToGround=x.centerClampedToGround,this._refreshExpiredTiles=x.refreshExpiredTiles===!0,this._fadeDuration=x.fadeDuration,this._crossSourceCollisions=x.crossSourceCollisions===!0,this._collectResourceTiming=x.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Ms),x.locale),this._clickTolerance=x.clickTolerance,this._overridePixelRatio=x.pixelRatio,this._maxCanvasSize=x.maxCanvasSize,this.transformCameraUpdate=x.transformCameraUpdate,this.transformConstrain=x.transformConstrain,this.cancelPendingTileRequestsWhileZooming=x.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=V.addThrottleControl(()=>this.isMoving()),this._requestManager=new K(x.transformRequest),typeof x.container=="string"){if(this._container=document.getElementById(x.container),!this._container)throw new Error(`Container '${x.container}' not found.`)}else{if(!(x.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=x.container}if(x.maxBounds&&this.setMaxBounds(x.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let F=!1;const B=Cv(W=>{this._trackResize&&!this._removed&&(this.resize(W),this.redraw())},50);this._resizeObserver=new ResizeObserver(W=>{F?B(W):F=!0}),this._resizeObserver.observe(this._container)}this.handlers=new qf(this,x),this._hash=x.hash&&new Av(typeof x.hash=="string"&&x.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:x.center,elevation:x.elevation,zoom:x.zoom,bearing:x.bearing,pitch:x.pitch,roll:x.roll}),x.bounds&&(this.resize(),this.fitBounds(x.bounds,a.e({},x.fitBoundsOptions,{duration:0}))));const E=typeof x.style=="string"||((f=(o=x.style)===null||o===void 0?void 0:o.projection)===null||f===void 0?void 0:f.type)!=="globe";this.resize(null,E),this._localIdeographFontFamily=x.localIdeographFontFamily,this._validateStyle=x.validateStyle,x.style&&this.setStyle(x.style,{localIdeographFontFamily:x.localIdeographFontFamily}),x.attributionControl&&this.addControl(new Xi(typeof x.attributionControl=="boolean"?void 0:x.attributionControl)),x.maplibreLogo&&this.addControl(new Fv,x.logoPosition),this.on("style.load",()=>{if(E||this._resizeTransform(),this.transform.unmodified){const F=a.S(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(F)}}),this.on("data",F=>{this._update(F.dataType==="style"),this.fire(new a.l(`${F.dataType}data`,F))}),this.on("dataloading",F=>{this.fire(new a.l(`${F.dataType}dataloading`,F))}),this.on("dataabort",F=>{this.fire(new a.l("sourcedataabort",F))})}_getMapId(){return this._mapId}setGlobalStateProperty(w,o){return this.style.setGlobalStateProperty(w,o),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(w,o){if(o===void 0&&(o=w.getDefaultPosition?w.getDefaultPosition():"top-right"),!w||!w.onAdd)return this.fire(new a.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const f=w.onAdd(this);this._controls.push(w);const x=this._controlPositions[o];return o.indexOf("bottom")!==-1?x.insertBefore(f,x.firstChild):x.appendChild(f),this}removeControl(w){if(!w||!w.onRemove)return this.fire(new a.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(w);return o>-1&&this._controls.splice(o,1),w.onRemove(this),this}hasControl(w){return this._controls.indexOf(w)>-1}coveringTiles(w){return Nn(this.transform,w)}calculateCameraOptionsFromTo(w,o,f,x){return x==null&&this.terrain&&(x=this.terrain.getElevationForLngLatZoom(f,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(w,o,f,x)}resize(w,o=!0){const[f,x]=this._containerDimensions(),b=this._getClampedPixelRatio(f,x);if(this._resizeCanvas(f,x,b),this.painter.resize(f,x,b),this.painter.overLimit()){const E=this.painter.context.gl;this._maxCanvasSize=[E.drawingBufferWidth,E.drawingBufferHeight];const F=this._getClampedPixelRatio(f,x);this._resizeCanvas(f,x,F),this.painter.resize(f,x,F)}this._resizeTransform(o);const P=!this._moving;return P&&(this.stop(),this.fire(new a.l("movestart",w)).fire(new a.l("move",w))),this.fire(new a.l("resize",w)),P&&this.fire(new a.l("moveend",w)),this}_resizeTransform(w=!0){var o;const[f,x]=this._containerDimensions();this.transform.resize(f,x,w),(o=this._requestedCameraState)===null||o===void 0||o.resize(f,x,w)}_getClampedPixelRatio(w,o){const{0:f,1:x}=this._maxCanvasSize,b=this.getPixelRatio(),P=w*b,E=o*b;return Math.min(P>f?f/P:1,E>x?x/E:1)*b}getPixelRatio(){var w;return(w=this._overridePixelRatio)!==null&&w!==void 0?w:devicePixelRatio}setPixelRatio(w){this._overridePixelRatio=w,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(w){return this.transform.setMaxBounds(Lr.convert(w)),this._update()}setMinZoom(w){if((w=w??-2)>=-2&&w<=this.transform.maxZoom)return this.transform.setMinZoom(w),this._update(),this.getZoom()<w&&this.setZoom(w),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(w){if((w=w??22)>=this.transform.minZoom)return this.transform.setMaxZoom(w),this._update(),this.getZoom()>w&&this.setZoom(w),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(w){if((w=w??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(w>=0&&w<=this.transform.maxPitch)return this.transform.setMinPitch(w),this._update(),this.getPitch()<w&&this.setPitch(w),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(w){if((w=w??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(w>=this.transform.minPitch)return this.transform.setMaxPitch(w),this._update(),this.getPitch()>w&&this.setPitch(w),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(w){return this.transform.setRenderWorldCopies(w),this._update()}setTransformConstrain(w){return this.transform.setConstrain(w),this._update()}project(w){return this.transform.locationToScreenPoint(a.U.convert(w),this.style&&this.terrain)}unproject(w){return this.transform.screenPointToLocation(a.P.convert(w),this.terrain)}isMoving(){var w;return this._moving||((w=this.handlers)===null||w===void 0?void 0:w.isMoving())}isZooming(){var w;return this._zooming||((w=this.handlers)===null||w===void 0?void 0:w.isZooming())}isRotating(){var w;return this._rotating||((w=this.handlers)===null||w===void 0?void 0:w.isRotating())}_createDelegatedListener(w,o,f){if(w==="mouseenter"||w==="mouseover"){let x=!1;return{layers:o,listener:f,delegates:{mousemove:P=>{const E=o.filter(B=>this.getLayer(B)),F=E.length!==0?this.queryRenderedFeatures(P.point,{layers:E}):[];F.length?x||(x=!0,f.call(this,new wa(w,this,P.originalEvent,{features:F}))):x=!1},mouseout:()=>{x=!1}}}}if(w==="mouseleave"||w==="mouseout"){let x=!1;return{layers:o,listener:f,delegates:{mousemove:E=>{const F=o.filter(B=>this.getLayer(B));(F.length!==0?this.queryRenderedFeatures(E.point,{layers:F}):[]).length?x=!0:x&&(x=!1,f.call(this,new wa(w,this,E.originalEvent)))},mouseout:E=>{x&&(x=!1,f.call(this,new wa(w,this,E.originalEvent)))}}}}{const x=b=>{const P=o.filter(F=>this.getLayer(F)),E=P.length!==0?this.queryRenderedFeatures(b.point,{layers:P}):[];E.length&&(b.features=E,f.call(this,b),delete b.features)};return{layers:o,listener:f,delegates:{[w]:x}}}}_saveDelegatedListener(w,o){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[w]=this._delegatedListeners[w]||[],this._delegatedListeners[w].push(o)}_removeDelegatedListener(w,o,f){if(!this._delegatedListeners||!this._delegatedListeners[w])return;const x=this._delegatedListeners[w];for(let b=0;b<x.length;b++){const P=x[b];if(P.listener===f&&P.layers.length===o.length&&P.layers.every(E=>o.includes(E))){for(const E in P.delegates)this.off(E,P.delegates[E]);return void x.splice(b,1)}}}on(w,o,f){if(f===void 0)return super.on(w,o);const x=typeof o=="string"?[o]:o,b=this._createDelegatedListener(w,x,f);this._saveDelegatedListener(w,b);for(const P in b.delegates)this.on(P,b.delegates[P]);return{unsubscribe:()=>{this._removeDelegatedListener(w,x,f)}}}once(w,o,f){if(f===void 0)return super.once(w,o);const x=typeof o=="string"?[o]:o,b=this._createDelegatedListener(w,x,f);for(const P in b.delegates){const E=b.delegates[P];b.delegates[P]=(...F)=>{this._removeDelegatedListener(w,x,f),E(...F)}}this._saveDelegatedListener(w,b);for(const P in b.delegates)this.once(P,b.delegates[P]);return this}off(w,o,f){return f===void 0?super.off(w,o):(this._removeDelegatedListener(w,typeof o=="string"?[o]:o,f),this)}queryRenderedFeatures(w,o){if(!this.style)return[];let f;const x=w instanceof a.P||Array.isArray(w),b=x?w:[[0,0],[this.transform.width,this.transform.height]];if(o=o||(x?{}:w)||{},b instanceof a.P||typeof b[0]=="number")f=[a.P.convert(b)];else{const P=a.P.convert(b[0]),E=a.P.convert(b[1]);f=[P,new a.P(E.x,P.y),E,new a.P(P.x,E.y),P]}return this.style.queryRenderedFeatures(f,o,this.transform)}querySourceFeatures(w,o){return this.style.querySourceFeatures(w,o)}setStyle(w,o){return(o=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&w?(this._diffStyle(w,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(w,o))}setTransformRequest(w){return this._requestManager.setTransformRequest(w),this}_getUIString(w){const o=this._locale[w];if(o==null)throw new Error(`Missing UI string '${w}'`);return o}_updateStyle(w,o){var f,x;if(o.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(w,o));const b=this.style&&o.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!w)),w?(this.style=new Af(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof w=="string"?this.style.loadURL(w,o,b):this.style.loadJSON(w,o,b),this):((x=(f=this.style)===null||f===void 0?void 0:f.projection)===null||x===void 0||x.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Af(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(w,o){if(typeof w=="string"){const f=this._requestManager.transformRequest(w,"Style");a.j(f,new AbortController).then(x=>{this._updateDiff(x.data,o)}).catch(x=>{x&&this.fire(new a.k(x))})}else typeof w=="object"&&this._updateDiff(w,o)}_updateDiff(w,o){try{this.style.setState(w,o)&&this._update(!0)}catch(f){a.w(`Unable to perform style diff: ${f.message||f.error||f}.  Rebuilding the style from scratch.`),this._updateStyle(w,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(w,o){return this._lazyInitEmptyStyle(),this.style.addSource(w,o),this._update(!0)}isSourceLoaded(w){const o=this.style&&this.style.tileManagers[w];if(o!==void 0)return o.loaded();this.fire(new a.k(new Error(`There is no tile manager with ID '${w}'`)))}setTerrain(w){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),w){const o=this.style.tileManagers[w.source];if(!o)throw new Error(`cannot load terrain, because there exists no source with ID: ${w.source}`);this.terrain===null&&o.reload();for(const f in this.style._layers){const x=this.style._layers[f];x.type==="hillshade"&&x.source===w.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),x.type==="color-relief"&&x.source===w.source&&a.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new UP(this.painter,o,w),this.painter.renderToTexture=new us(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=f=>{var x;f.dataType==="style"?this.terrain.tileManager.freeRtt():f.dataType==="source"&&f.tile&&(f.sourceId!==w.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((x=f.source)===null||x===void 0?void 0:x.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(f.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new a.l("terrain",{terrain:w})),this}getTerrain(){var w,o;return(o=(w=this.terrain)===null||w===void 0?void 0:w.options)!==null&&o!==void 0?o:null}areTilesLoaded(){const w=this.style&&this.style.tileManagers;for(const o in w){const f=w[o]._tiles;for(const x in f){const b=f[x];if(b.state!=="loaded"&&b.state!=="errored")return!1}}return!0}removeSource(w){return this.style.removeSource(w),this._update(!0)}getSource(w){return this.style.getSource(w)}setSourceTileLodParams(w,o,f){if(f){const x=this.getSource(f);if(!x)throw new Error(`There is no source with ID "${f}", cannot set LOD parameters`);x.calculateTileZoom=zt(Math.max(1,w),Math.max(1,o))}else for(const x in this.style.tileManagers)this.style.tileManagers[x].getSource().calculateTileZoom=zt(Math.max(1,w),Math.max(1,o));return this._update(!0),this}refreshTiles(w,o){const f=this.style.tileManagers[w];if(!f)throw new Error(`There is no tile manager with ID "${w}", cannot refresh tile`);o===void 0?f.reload(!0):f.refreshTiles(o.map(x=>new a.a8(x.z,x.x,x.y)))}addImage(w,o,f={}){const{pixelRatio:x=1,sdf:b=!1,stretchX:P,stretchY:E,content:F,textFitWidth:B,textFitHeight:W}=f;if(this._lazyInitEmptyStyle(),!(o instanceof HTMLImageElement||a.b(o))){if(o.width===void 0||o.height===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:G,height:Y,data:Z}=o,re=o;return this.style.addImage(w,{data:new a.R({width:G,height:Y},new Uint8Array(Z)),pixelRatio:x,stretchX:P,stretchY:E,content:F,textFitWidth:B,textFitHeight:W,sdf:b,version:0,userImage:re}),re.onAdd&&re.onAdd(this,w),this}}{const{width:G,height:Y,data:Z}=j.getImageData(o);this.style.addImage(w,{data:new a.R({width:G,height:Y},Z),pixelRatio:x,stretchX:P,stretchY:E,content:F,textFitWidth:B,textFitHeight:W,sdf:b,version:0})}}updateImage(w,o){const f=this.style.getImage(w);if(!f)return this.fire(new a.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=o instanceof HTMLImageElement||a.b(o)?j.getImageData(o):o,{width:b,height:P,data:E}=x;if(b===void 0||P===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(b!==f.data.width||P!==f.data.height)return this.fire(new a.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const F=!(o instanceof HTMLImageElement||a.b(o));return f.data.replace(E,F),this.style.updateImage(w,f),this}getImage(w){return this.style.getImage(w)}hasImage(w){return w?!!this.style.getImage(w):(this.fire(new a.k(new Error("Missing required image id"))),!1)}removeImage(w){this.style.removeImage(w)}loadImage(w){return V.getImage(this._requestManager.transformRequest(w,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(w,o){return this._lazyInitEmptyStyle(),this.style.addLayer(w,o),this._update(!0)}moveLayer(w,o){return this.style.moveLayer(w,o),this._update(!0)}removeLayer(w){return this.style.removeLayer(w),this._update(!0)}getLayer(w){return this.style.getLayer(w)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(w,o,f){return this.style.setLayerZoomRange(w,o,f),this._update(!0)}setFilter(w,o,f={}){return this.style.setFilter(w,o,f),this._update(!0)}getFilter(w){return this.style.getFilter(w)}setPaintProperty(w,o,f,x={}){return this.style.setPaintProperty(w,o,f,x),this._update(!0)}getPaintProperty(w,o){return this.style.getPaintProperty(w,o)}setLayoutProperty(w,o,f,x={}){return this.style.setLayoutProperty(w,o,f,x),this._update(!0)}getLayoutProperty(w,o){return this.style.getLayoutProperty(w,o)}setGlyphs(w,o={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(w,o),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(w,o,f={}){return this._lazyInitEmptyStyle(),this.style.addSprite(w,o,f,x=>{x||this._update(!0)}),this}removeSprite(w){return this._lazyInitEmptyStyle(),this.style.removeSprite(w),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(w,o={}){return this._lazyInitEmptyStyle(),this.style.setSprite(w,o,f=>{f||this._update(!0)}),this}setLight(w,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(w,o),this._update(!0)}getLight(){return this.style.getLight()}setSky(w,o={}){return this._lazyInitEmptyStyle(),this.style.setSky(w,o),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(w,o){return this.style.setFeatureState(w,o),this._update()}removeFeatureState(w,o){return this.style.removeFeatureState(w,o),this._update()}getFeatureState(w){return this.style.getFeatureState(w)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let w=0,o=0;return this._container&&(w=this._container.clientWidth||400,o=this._container.clientHeight||300),[w,o]}_setupContainer(){const w=this._container;w.classList.add("maplibregl-map");const o=this._canvasContainer=N.create("div","maplibregl-canvas-container",w);this._interactive&&o.classList.add("maplibregl-interactive"),this._canvas=N.create("canvas","maplibregl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const f=this._containerDimensions(),x=this._getClampedPixelRatio(f[0],f[1]);this._resizeCanvas(f[0],f[1],x);const b=this._controlContainer=N.create("div","maplibregl-control-container",w),P=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{P[E]=N.create("div",`maplibregl-ctrl-${E} `,b)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(w,o,f){this._canvas.width=Math.floor(f*w),this._canvas.height=Math.floor(f*o),this._canvas.style.width=`${w}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const w=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let o=null;this._canvas.addEventListener("webglcontextcreationerror",x=>{o={requestedAttributes:w},x&&(o.statusMessage=x.statusMessage,o.type=x.type)},{once:!0});let f=null;if(f=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,w):this._canvas.getContext("webgl2",w)||this._canvas.getContext("webgl",w),!f){const x="Failed to initialize WebGL";throw o?(o.message=x,new Error(JSON.stringify(o))):new Error(x)}this.painter=new Oj(f,this.transform),D.testSupport(f)}migrateProjection(w,o){super.migrateProjection(w,o),this.painter.transform=w,this.fire(new a.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(w){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||w,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(w){return this._update(),this._renderTaskQueue.add(w)}_cancelRenderFrame(w){this._renderTaskQueue.remove(w)}_render(w){var o,f,x,b,P;const E=this._idleTriggered?this._fadeDuration:0,F=((o=this.style.projection)===null||o===void 0?void 0:o.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(w),this._removed)return;let B=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const Y=this.transform.zoom,Z=k();this.style.zoomHistory.update(Y,Z);const re=new a.G(Y,{now:Z,fadeDuration:E,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),he=re.crossFadingFactor();he===1&&he===this._crossFadingFactor||(B=!0,this._crossFadingFactor=he),this.style.update(re)}const W=((f=this.style.projection)===null||f===void 0?void 0:f.transitionState)>0!==F;(x=this.style.projection)===null||x===void 0||x.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((b=this.style.projection)===null||b===void 0?void 0:b.transitionState,(P=this.style.projection)===null||P===void 0?void 0:P.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||W)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,E,this._crossSourceCollisions,W),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,showPadding:this.showPadding}),this.fire(new a.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.cz.mark(a.cA.load),this.fire(new a.l("load"))),this.style&&(this.style.hasTransitions()||B)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const G=this._sourcesDirty||this._styleDirty||this._placementDirty;return G||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.l("idle")),!this._loaded||this._fullyLoaded||G||(this._fullyLoaded=!0,a.cz.mark(a.cA.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var w;this._hash&&this._hash.remove();for(const f of this._controls)f.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),V.removeThrottleControl(this._imageQueueHandle),(w=this._resizeObserver)===null||w===void 0||w.disconnect();const o=this.painter.context.gl.getExtension("WEBGL_lose_context");o!=null&&o.loseContext&&o.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),N.remove(this._canvasContainer),N.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),a.cz.clearMetrics(),this._removed=!0,this.fire(new a.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,j.frame(this._frameRequest,w=>{a.cz.frame(w),this._frameRequest=null;try{this._render(w)}catch(o){if(!a.cB(o)&&!function(f){return f.message===Nj}(o))throw o}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(w){this._showTileBoundaries!==w&&(this._showTileBoundaries=w,this._update())}get showPadding(){return!!this._showPadding}set showPadding(w){this._showPadding!==w&&(this._showPadding=w,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(w){this._showCollisionBoxes!==w&&(this._showCollisionBoxes=w,w?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(w){this._showOverdrawInspector!==w&&(this._showOverdrawInspector=w,this._update())}get repaint(){return!!this._repaint}set repaint(w){this._repaint!==w&&(this._repaint=w,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(w){this._vertices=w,this._update()}get version(){return ew}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(w){return this._lazyInitEmptyStyle(),this.style.setProjection(w),this._update(!0)}},u.MapMouseEvent=wa,u.MapTouchEvent=da,u.MapWheelEvent=zj,u.Marker=Uf,u.NavigationControl=class{constructor(w){this._updateZoomButtons=()=>{const o=this._map.getZoom(),f=o===this._map.getMaxZoom(),x=o===this._map.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=x,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",x.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(o,f)=>{const x=this._map._getUIString(`NavigationControl.${f}`);o.title=x,o.setAttribute("aria-label",x)},this.options=a.e({},$p,w),this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),N.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),N.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=N.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(w){return this._map=w,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new zv(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){N.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(w,o){const f=N.create("button",w,this._container);return f.type="button",f.addEventListener("click",o),f}},u.Popup=class extends a.E{constructor(w){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&N.remove(this._content),this._container&&(N.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new a.l("close"))),this),this._onMouseUp=o=>{this._update(o.point)},this._onMouseMove=o=>{this._update(o.point)},this._onDrag=o=>{this._update(o.point)},this._update=o=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=N.create("div","maplibregl-popup",this._map.getContainer()),this._tip=N.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const E of this.options.className.split(" "))this._container.classList.add(E);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Bp(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!o)return;const f=this._flatPos=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&o?o:this._map.transform.locationToScreenPoint(this._lngLat));let x=this.options.anchor;const b=Wp(this.options.offset);if(!x){const E=this._container.offsetWidth,F=this._container.offsetHeight;let B;B=f.y+b.bottom.y<F?["top"]:f.y>this._map.transform.height-F?["bottom"]:[],f.x<E/2?B.push("left"):f.x>this._map.transform.width-E/2&&B.push("right"),x=B.length===0?"bottom":B.join("-")}let P=f.add(b[x]);this.options.subpixelPositioning||(P=P.round()),N.setTransform(this._container,`${Nu[x]} translate(${P.x}px,${P.y}px)`),qp(this._container,x,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(qv),w)}addTo(w){return this._map&&this.remove(),this._map=w,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(w){return this._lngLat=a.U.convert(w),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(w){return this.setDOMContent(document.createTextNode(w))}setHTML(w){const o=document.createDocumentFragment(),f=document.createElement("body");let x;for(f.innerHTML=w;x=f.firstChild,x;)o.appendChild(x);return this.setDOMContent(o)}getMaxWidth(){var w;return(w=this._container)===null||w===void 0?void 0:w.style.maxWidth}setMaxWidth(w){return this.options.maxWidth=w,this._update(),this}setDOMContent(w){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=N.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(w),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(w){return this._container&&this._container.classList.add(w),this}removeClassName(w){return this._container&&this._container.classList.remove(w),this}setOffset(w){return this.options.offset=w,this._update(),this}toggleClassName(w){if(this._container)return this._container.classList.toggle(w)}setSubpixelPositioning(w){this.options.subpixelPositioning=w}_createCloseButton(){this.options.closeButton&&(this._closeButton=N.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const w=this._container.querySelector(Up);w&&w.focus()}},u.RasterDEMTileSource=Be,u.RasterTileSource=Wn,u.ScaleControl=class{constructor(w){this._onMove=()=>{Vp(this._map,this._container,this.options)},this.setUnit=o=>{this.options.unit=o,Vp(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Bv),w)}getDefaultPosition(){return"bottom-left"}onAdd(w){return this._map=w,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-scale",w.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){N.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},u.ScrollZoomHandler=Zj,u.Style=Af,u.TerrainControl=class{constructor(w){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=w}onAdd(w){return this._map=w,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=N.create("button","maplibregl-ctrl-terrain",this._container),N.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){N.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},u.TwoFingersTouchPitchHandler=Gj,u.TwoFingersTouchRotateHandler=Fp,u.TwoFingersTouchZoomHandler=Wj,u.TwoFingersTouchZoomRotateHandler=Xj,u.VectorTileSource=vs,u.VideoSource=Ot,u.addSourceType=(w,o)=>a._(void 0,void 0,void 0,function*(){if(Sn(w))throw new Error(`A source type called "${w}" already exists.`);((f,x)=>{tn[f]=x})(w,o)}),u.clearPrewarmedResources=function(){const w=Pr;w&&(w.isPreloaded()&&w.numActive()===1?(w.release(Tt),Pr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},u.createTileMesh=jf,u.getMaxParallelImageRequests=function(){return a.a.MAX_PARALLEL_IMAGE_REQUESTS},u.getRTLTextPluginStatus=function(){return ue().getRTLTextPluginStatus()},u.getVersion=function(){return Vv},u.getWorkerCount=function(){return Ht.workerCount},u.getWorkerUrl=function(){return a.a.WORKER_URL},u.importScriptInWorkers=function(w){return Wt().broadcast("IS",w)},u.isTimeFrozen=function(){return S.isFrozen()},u.now=k,u.prewarm=function(){yr().acquire(Tt)},u.restoreNow=function(){S.restoreNow()},u.setMaxParallelImageRequests=function(w){a.a.MAX_PARALLEL_IMAGE_REQUESTS=w},u.setNow=function(w){S.setNow(w)},u.setRTLTextPlugin=function(w,o){return ue().setRTLTextPlugin(w,o)},u.setWorkerCount=function(w){Ht.workerCount=w},u.setWorkerUrl=function(w){a.a.WORKER_URL=w}});var c=n;return c})})(cW);var dW=cW.exports;const cc=Fn(dW),ade=W6({__proto__:null,default:cc},[dW]),b_={active:"#22c55e",inactive:"#9ca3af",retired:"#ef4444",under_maintenance:"#eab308"};function ode(){var c;const e=R.useRef(null),t=R.useRef(null),[n,s]=R.useState(null),{data:i}=ht({queryKey:["assets-with-geom"],queryFn:()=>dc.getAssets({per_page:1e3})});return R.useEffect(()=>{if(!(!e.current||t.current))return t.current=new cc.Map({container:e.current,style:{version:8,sources:{"osm-tiles":{type:"raster",tiles:["https://tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:"&copy; OpenStreetMap contributors"}},layers:[{id:"osm-tiles",type:"raster",source:"osm-tiles",minzoom:0,maxzoom:19}]},center:[0,0],zoom:2}),t.current.addControl(new cc.NavigationControl,"top-right"),t.current.addControl(new cc.ScaleControl,"bottom-left"),()=>{var u;(u=t.current)==null||u.remove(),t.current=null}},[]),R.useEffect(()=>{if(!t.current||!(i!=null&&i.data))return;const u=i.data.filter(a=>a.geom);if(u.length!==0&&(u.forEach(a=>{if(!a.geom)return;const m=document.createElement("div");m.className="asset-marker",m.style.width="24px",m.style.height="24px",m.style.borderRadius="50%",m.style.backgroundColor=b_[a.status],m.style.border="2px solid white",m.style.boxShadow="0 2px 4px rgba(0,0,0,0.2)",m.style.cursor="pointer",new cc.Marker({element:m}).setLngLat(a.geom.coordinates).addTo(t.current),m.addEventListener("click",()=>{var p;s(a),(p=t.current)==null||p.flyTo({center:a.geom.coordinates,zoom:14,duration:1e3})})}),u.length>0)){const a=new cc.LngLatBounds;u.forEach(m=>{m.geom&&a.extend(m.geom.coordinates)}),t.current.fitBounds(a,{padding:50})}},[i]),r.jsxs("div",{className:"relative h-[calc(100vh-8rem)]",children:[r.jsx("div",{className:"absolute top-4 left-4 z-10 space-y-2",children:r.jsx(J,{children:r.jsxs(ie,{className:"p-4",children:[r.jsx("h2",{className:"text-lg font-bold mb-2",children:"Assets Map"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:b_.active}}),r.jsx("span",{className:"text-sm",children:"Active"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:b_.inactive}}),r.jsx("span",{className:"text-sm",children:"Inactive"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:b_.under_maintenance}}),r.jsx("span",{className:"text-sm",children:"Under Maintenance"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:b_.retired}}),r.jsx("span",{className:"text-sm",children:"Retired"})]})]}),r.jsxs("p",{className:"text-xs text-muted-foreground mt-3",children:[(i==null?void 0:i.data.filter(u=>u.geom).length)||0," assets with location data"]})]})})}),n&&r.jsx("div",{className:"absolute top-4 right-4 z-10 w-80",children:r.jsx(J,{children:r.jsxs(ie,{className:"p-4",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-bold",children:n.name}),r.jsx("p",{className:"text-sm text-muted-foreground",children:n.code})]}),r.jsx(se,{variant:"ghost",size:"sm",onClick:()=>s(null),children:r.jsx(jy,{className:"h-4 w-4"})})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-muted-foreground",children:"Status"}),r.jsx(We,{className:`bg-${n.status==="active"?"green":n.status==="retired"?"red":"gray"}-100 text-${n.status==="active"?"green":n.status==="retired"?"red":"gray"}-800`,children:n.status.replace("_"," ")})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-muted-foreground",children:"Asset Class"}),r.jsx("p",{className:"text-sm font-medium",children:((c=n.asset_class)==null?void 0:c.name)||"Unknown"})]}),n.manufacturer&&r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-muted-foreground",children:"Manufacturer"}),r.jsx("p",{className:"text-sm",children:n.manufacturer})]}),n.model&&r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-muted-foreground",children:"Model"}),r.jsx("p",{className:"text-sm",children:n.model})]}),n.geom&&r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-muted-foreground",children:"Location"}),r.jsxs("p",{className:"text-sm flex items-center gap-1",children:[r.jsx(jo,{className:"h-3 w-3"}),n.geom.coordinates[1].toFixed(6),", ",n.geom.coordinates[0].toFixed(6)]})]}),r.jsx(se,{className:"w-full mt-3",size:"sm",asChild:!0,children:r.jsx("a",{href:`/cmms/assets/${n.id}`,children:"View Details"})})]})]})})}),r.jsx("div",{ref:e,className:"w-full h-full"})]})}const _r="/cmms",j_={getJobPlans:e=>{const t={};return e!=null&&e.search&&(t.search=e.search),e!=null&&e.status&&(t.status=e.status),e!=null&&e.page&&(t.page=e.page.toString()),e!=null&&e.per_page&&(t.per_page=e.per_page.toString()),me.get(`${_r}/job-plans`,t)},getJobPlan:e=>me.get(`${_r}/job-plans/${e}`),createJobPlan:e=>me.post(`${_r}/job-plans`,e),updateJobPlan:(e,t)=>me.put(`${_r}/job-plans/${e}`,t),deleteJobPlan:e=>me.delete(`${_r}/job-plans/${e}`),createVersion:e=>me.post(`${_r}/job-plans/${e}/version`),activate:e=>me.post(`${_r}/job-plans/${e}/activate`)},Yw={getTemplates:e=>{const t={};return e!=null&&e.asset_class_id&&(t.asset_class_id=e.asset_class_id.toString()),(e==null?void 0:e.is_active)!==void 0&&(t.is_active=e.is_active.toString()),e!=null&&e.page&&(t.page=e.page.toString()),e!=null&&e.per_page&&(t.per_page=e.per_page.toString()),me.get(`${_r}/pm/templates`,t)},getTemplate:e=>me.get(`${_r}/pm/templates/${e}`),createTemplate:e=>me.post(`${_r}/pm/templates`,e),updateTemplate:(e,t)=>me.put(`${_r}/pm/templates/${e}`,t),deleteTemplate:e=>me.delete(`${_r}/pm/templates/${e}`),generateWorkOrders:e=>me.post(`${_r}/pm/generate`,e),deferPm:(e,t)=>me.post(`${_r}/pm/logs/${e}/defer`,t),getCompliance:e=>{const t={};return e!=null&&e.period_start&&(t.period_start=e.period_start),e!=null&&e.period_end&&(t.period_end=e.period_end),me.get(`${_r}/pm/compliance`,t)}},TA={getTags:e=>{const t={};return e!=null&&e.asset_id&&(t.asset_id=e.asset_id.toString()),(e==null?void 0:e.is_active)!==void 0&&(t.is_active=e.is_active.toString()),e!=null&&e.page&&(t.page=e.page.toString()),e!=null&&e.per_page&&(t.per_page=e.per_page.toString()),me.get(`${_r}/condition-monitoring/tags`,t)},getTag:e=>me.get(`${_r}/condition-monitoring/tags/${e}`),createTag:e=>me.post(`${_r}/condition-monitoring/tags`,e),updateTag:(e,t)=>me.put(`${_r}/condition-monitoring/tags/${e}`,t),deleteTag:e=>me.delete(`${_r}/condition-monitoring/tags/${e}`),ingestReading:(e,t)=>me.post(`${_r}/condition-monitoring/tags/${e}/readings`,t),acknowledgeAlarm:(e,t)=>me.post(`${_r}/condition-monitoring/alarms/${e}/acknowledge`,t),clearAlarm:e=>me.post(`${_r}/condition-monitoring/alarms/${e}/clear`),getAssetHealth:e=>me.get(`${_r}/condition-monitoring/assets/${e}/health`),evaluateRules:()=>me.post(`${_r}/condition-monitoring/rules/evaluate`)},Xw={getStores:e=>{const t={};return e!=null&&e.type&&(t.type=e.type),e!=null&&e.page&&(t.page=e.page.toString()),e!=null&&e.per_page&&(t.per_page=e.per_page.toString()),me.get(`${_r}/stores`,t)},getStore:e=>me.get(`${_r}/stores/${e}`),createStore:e=>me.post(`${_r}/stores`,e),updateStore:(e,t)=>me.put(`${_r}/stores/${e}`,t),createBin:(e,t)=>me.post(`${_r}/stores/${e}/bins`,t),receiveStock:e=>me.post(`${_r}/stores/receive`,e),issueStock:e=>me.post(`${_r}/stores/issue`,e),getValuation:()=>me.get(`${_r}/stores/valuation`),getLowStock:()=>me.get(`${_r}/stores/low-stock`)},Qw={getFleetAssets:e=>{const t={};return e!=null&&e.type&&(t.type=e.type),e!=null&&e.status&&(t.status=e.status),e!=null&&e.page&&(t.page=e.page.toString()),e!=null&&e.per_page&&(t.per_page=e.per_page.toString()),me.get(`${_r}/fleet`,t)},getFleetAsset:e=>me.get(`${_r}/fleet/${e}`),createFleetAsset:e=>me.post(`${_r}/fleet`,e),updateFleetAsset:(e,t)=>me.put(`${_r}/fleet/${e}`,t),createServiceSchedule:(e,t)=>me.post(`${_r}/fleet/${e}/service-schedules`,t),logFuel:(e,t)=>me.post(`${_r}/fleet/${e}/fuel-logs`,t),logUptime:(e,t)=>me.post(`${_r}/fleet/${e}/uptime-logs`,t),getUtilization:e=>{const t={};return e!=null&&e.from_date&&(t.from_date=e.from_date),e!=null&&e.to_date&&(t.to_date=e.to_date),me.get(`${_r}/fleet/utilization`,t)},getFuelEfficiency:(e,t)=>{const n={};return t!=null&&t.from_date&&(n.from_date=t.from_date),t!=null&&t.to_date&&(n.to_date=t.to_date),me.get(`${_r}/fleet/${e}/fuel-efficiency`,n)}},w_={getContracts:e=>{const t={};return e!=null&&e.status&&(t.status=e.status),e!=null&&e.type&&(t.type=e.type),e!=null&&e.page&&(t.page=e.page.toString()),e!=null&&e.per_page&&(t.per_page=e.per_page.toString()),me.get(`${_r}/contractors/contracts`,t)},getContract:e=>me.get(`${_r}/contractors/contracts/${e}`),createContract:e=>me.post(`${_r}/contractors/contracts`,e),updateContract:(e,t)=>me.put(`${_r}/contractors/contracts/${e}`,t),recordViolation:(e,t)=>me.post(`${_r}/contractors/contracts/${e}/violations`,t),recordPayment:(e,t)=>me.post(`${_r}/contractors/contracts/${e}/payments`,t),getVendorScore:e=>{const t={};return e!=null&&e.vendor_name&&(t.vendor_name=e.vendor_name),e!=null&&e.period_start&&(t.period_start=e.period_start),e!=null&&e.period_end&&(t.period_end=e.period_end),me.get(`${_r}/contractors/vendor-score`,t)},getActiveContracts:()=>me.get(`${_r}/contractors/active`),getExpiringContracts:e=>{const t={};return e!=null&&e.days&&(t.days=e.days.toString()),me.get(`${_r}/contractors/expiring`,t)}},Qf={getPermits:e=>{const t={};return e!=null&&e.status&&(t.status=e.status),e!=null&&e.permit_type&&(t.permit_type=e.permit_type),e!=null&&e.page&&(t.page=e.page.toString()),e!=null&&e.per_page&&(t.per_page=e.per_page.toString()),me.get(`${_r}/hse/permits`,t)},getPermit:e=>me.get(`${_r}/hse/permits/${e}`),createPermit:e=>me.post(`${_r}/hse/permits`,e),approvePermit:(e,t)=>me.post(`${_r}/hse/permits/${e}/approve`,t||{}),closePermit:e=>me.post(`${_r}/hse/permits/${e}/close`),createRiskAssessment:e=>me.post(`${_r}/hse/risk-assessments`,e),updateRiskAssessment:(e,t)=>me.put(`${_r}/hse/risk-assessments/${e}`,t),getIncidents:e=>{const t={};return e!=null&&e.category&&(t.category=e.category),e!=null&&e.severity&&(t.severity=e.severity),e!=null&&e.status&&(t.status=e.status),e!=null&&e.page&&(t.page=e.page.toString()),e!=null&&e.per_page&&(t.per_page=e.per_page.toString()),me.get(`${_r}/hse/incidents`,t)},createIncident:e=>me.post(`${_r}/hse/incidents`,e),investigateIncident:(e,t)=>me.post(`${_r}/hse/incidents/${e}/investigate`,t),closeIncident:e=>me.post(`${_r}/hse/incidents/${e}/close`),getIncidentStats:e=>{const t={};return e!=null&&e.from_date&&(t.from_date=e.from_date),e!=null&&e.to_date&&(t.to_date=e.to_date),me.get(`${_r}/hse/incidents/stats`,t)},getCapas:e=>{const t={};return e!=null&&e.status&&(t.status=e.status),e!=null&&e.page&&(t.page=e.page.toString()),e!=null&&e.per_page&&(t.per_page=e.per_page.toString()),me.get(`${_r}/hse/capas`,t)},createCapa:e=>me.post(`${_r}/hse/capas`,e),completeCapa:(e,t)=>me.post(`${_r}/hse/capas/${e}/complete`,t)},lde={draft:"bg-gray-100 text-gray-800",active:"bg-green-100 text-green-800",archived:"bg-orange-100 text-orange-800"};function cde(){var k;const[e,t]=R.useState({page:1,per_page:15,search:"",status:"all"}),[n,s]=R.useState(!1),[i,c]=R.useState(null),u=br(),{data:a,isLoading:m}=ht({queryKey:["job-plans",e],queryFn:()=>j_.getJobPlans(e)}),p=jt({mutationFn:j_.createJobPlan,onSuccess:()=>{u.invalidateQueries({queryKey:["job-plans"]}),s(!1),qe.success("Job plan created successfully")}}),y=jt({mutationFn:({id:N,data:D})=>j_.updateJobPlan(N,D),onSuccess:()=>{u.invalidateQueries({queryKey:["job-plans"]}),s(!1),c(null),qe.success("Job plan updated successfully")}}),v=jt({mutationFn:j_.activate,onSuccess:()=>{u.invalidateQueries({queryKey:["job-plans"]}),qe.success("Job plan activated")}}),j=jt({mutationFn:j_.createVersion,onSuccess:()=>{u.invalidateQueries({queryKey:["job-plans"]}),qe.success("New version created")}}),S=N=>{N.preventDefault();const D=new FormData(N.currentTarget),O={code:D.get("code"),name:D.get("name"),description:D.get("description"),sop:D.get("sop"),estimated_hours:parseFloat(D.get("estimated_hours")),status:D.get("status")||"draft"};i?y.mutate({id:i.id,data:O}):p.mutate(O)};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Job Plans"}),r.jsx("p",{className:"text-muted-foreground",children:"Standardized work procedures and checklists"})]}),r.jsxs(Rr,{open:n,onOpenChange:s,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{onClick:()=>c(null),children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"New Job Plan"]})}),r.jsxs(Er,{className:"max-w-2xl",children:[r.jsx(Mr,{children:r.jsx(Or,{children:i?"Edit Job Plan":"Create Job Plan"})}),r.jsxs("form",{onSubmit:S,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"code",children:"Job Plan Code"}),r.jsx(Ge,{id:"code",name:"code",defaultValue:i==null?void 0:i.code,required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"status",children:"Status"}),r.jsxs(Jt,{name:"status",defaultValue:(i==null?void 0:i.status)||"draft",children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"draft",children:"Draft"}),r.jsx(ke,{value:"active",children:"Active"}),r.jsx(ke,{value:"archived",children:"Archived"})]})]})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"name",children:"Name"}),r.jsx(Ge,{id:"name",name:"name",defaultValue:i==null?void 0:i.name,required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"description",children:"Description"}),r.jsx(Fs,{id:"description",name:"description",defaultValue:i==null?void 0:i.description,rows:3})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"sop",children:"Standard Operating Procedure"}),r.jsx(Fs,{id:"sop",name:"sop",defaultValue:i==null?void 0:i.sop,rows:5,placeholder:"Step-by-step procedure..."})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"estimated_hours",children:"Estimated Hours"}),r.jsx(Ge,{id:"estimated_hours",name:"estimated_hours",type:"number",step:"0.5",defaultValue:i==null?void 0:i.estimated_hours})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:p.isPending||y.isPending,children:i?"Update":"Create"})]})]})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"flex-1 relative",children:[r.jsx(ci,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),r.jsx(Ge,{placeholder:"Search job plans...",value:e.search,onChange:N=>t({...e,search:N.target.value,page:1}),className:"pl-10"})]}),r.jsxs(Jt,{value:e.status,onValueChange:N=>t({...e,status:N,page:1}),children:[r.jsx(Yt,{className:"w-[200px]",children:r.jsx(er,{placeholder:"All Statuses"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Statuses"}),r.jsx(ke,{value:"draft",children:"Draft"}),r.jsx(ke,{value:"active",children:"Active"}),r.jsx(ke,{value:"archived",children:"Archived"})]})]})]})}),r.jsx(ie,{children:m?r.jsx("div",{className:"text-center py-8",children:"Loading..."}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Code"}),r.jsx(le,{children:"Name"}),r.jsx(le,{children:"Version"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Est. Hours"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:(k=a==null?void 0:a.data)==null?void 0:k.map(N=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-mono",children:N.code}),r.jsx(ne,{className:"font-medium",children:N.name}),r.jsxs(ne,{children:["v",N.version]}),r.jsx(ne,{children:r.jsx(We,{className:lde[N.status],children:N.status})}),r.jsxs(ne,{children:[N.estimated_hours||"","h"]}),r.jsx(ne,{children:r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{size:"sm",variant:"outline",onClick:()=>{c(N),s(!0)},children:r.jsx(vd,{className:"h-4 w-4"})}),N.status==="draft"&&r.jsxs(se,{size:"sm",variant:"outline",onClick:()=>v.mutate(N.id),children:[r.jsx(os,{className:"h-4 w-4 mr-1"}),"Activate"]}),N.status==="active"&&r.jsxs(se,{size:"sm",variant:"outline",onClick:()=>j.mutate(N.id),children:[r.jsx(is,{className:"h-4 w-4 mr-1"}),"New Version"]})]})})]},N.id))})]})})]})]})}function ude(){var N,D;const[e,t]=R.useState({page:1,per_page:15}),[n,s]=R.useState(!1),[i,c]=R.useState(null),u=br(),{data:a,isLoading:m}=ht({queryKey:["pm-templates",e],queryFn:()=>Yw.getTemplates(e)}),{data:p}=ht({queryKey:["pm-compliance"],queryFn:()=>Yw.getCompliance({})}),y=jt({mutationFn:Yw.createTemplate,onSuccess:()=>{u.invalidateQueries({queryKey:["pm-templates"]}),s(!1),qe.success("PM template created successfully")}}),v=jt({mutationFn:Yw.generateWorkOrders,onSuccess:O=>{qe.success(`Generated ${O.generated} work orders`)}}),j=O=>{O.preventDefault();const T=new FormData(O.currentTarget),I={name:T.get("name"),description:T.get("description"),trigger_type:T.get("trigger_type"),frequency_days:parseInt(T.get("frequency_days")),tolerance_days:parseInt(T.get("tolerance_days")),is_active:!0};y.mutate(I)},S=p==null?void 0:p[0],k=(S==null?void 0:S.compliance_pct)||0;return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Preventive Maintenance"}),r.jsx("p",{className:"text-muted-foreground",children:"Schedule and track preventive maintenance"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(se,{variant:"outline",onClick:()=>v.mutate({}),disabled:v.isPending,children:[r.jsx(od,{className:"mr-2 h-4 w-4"}),"Generate Work Orders"]}),r.jsxs(Rr,{open:n,onOpenChange:s,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{onClick:()=>c(null),children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"New PM Template"]})}),r.jsxs(Er,{className:"max-w-2xl",children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Create PM Template"})}),r.jsxs("form",{onSubmit:j,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"name",children:"Template Name"}),r.jsx(Ge,{id:"name",name:"name",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"description",children:"Description"}),r.jsx(Fs,{id:"description",name:"description",rows:3})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"trigger_type",children:"Trigger Type"}),r.jsxs(Jt,{name:"trigger_type",defaultValue:"time_based",children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"time_based",children:"Time Based"}),r.jsx(ke,{value:"usage_based",children:"Usage Based"}),r.jsx(ke,{value:"combined",children:"Combined"})]})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"frequency_days",children:"Frequency (days)"}),r.jsx(Ge,{id:"frequency_days",name:"frequency_days",type:"number",defaultValue:"30",required:!0})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"tolerance_days",children:"Tolerance (days)"}),r.jsx(Ge,{id:"tolerance_days",name:"tolerance_days",type:"number",defaultValue:"7"})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:y.isPending,children:"Create Template"})]})]})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsx(ge,{className:"pb-2",children:r.jsx(xe,{className:"text-sm font-medium",children:"PM Compliance"})}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:[k.toFixed(1),"%"]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"On-time completion"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-2",children:r.jsx(xe,{className:"text-sm font-medium",children:"Scheduled"})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:(S==null?void 0:S.pm_scheduled)||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"This period"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-2",children:r.jsx(xe,{className:"text-sm font-medium",children:"Completed"})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:((S==null?void 0:S.pm_completed_on_time)||0)+((S==null?void 0:S.pm_completed_late)||0)}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Total completed"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-2",children:r.jsx(xe,{className:"text-sm font-medium",children:"PM/CM Ratio"})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:((N=S==null?void 0:S.pm_breakdown_ratio)==null?void 0:N.toFixed(2))||""}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Target: > 4.0"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"PM Templates"})}),r.jsx(ie,{children:m?r.jsx("div",{className:"text-center py-8",children:"Loading..."}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Name"}),r.jsx(le,{children:"Trigger Type"}),r.jsx(le,{children:"Frequency"}),r.jsx(le,{children:"Next Gen"}),r.jsx(le,{children:"Status"})]})}),r.jsx(ur,{children:(D=a==null?void 0:a.data)==null?void 0:D.map(O=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:O.name}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:O.trigger_type})}),r.jsxs(ne,{children:[O.frequency_days," days"]}),r.jsx(ne,{children:O.next_gen_date?new Date(O.next_gen_date).toLocaleDateString():""}),r.jsx(ne,{children:r.jsx(We,{variant:O.is_active?"default":"secondary",children:O.is_active?"Active":"Inactive"})})]},O.id))})]})})]})]})}const rF=(e,t,n)=>{if(e&&"reportValidity"in e){const s=Qt(n,t);e.setCustomValidity(s&&s.message||""),e.reportValidity()}},WT=(e,t)=>{for(const n in t.fields){const s=t.fields[n];s&&s.ref&&"reportValidity"in s.ref?rF(s.ref,n,e):s&&s.refs&&s.refs.forEach(i=>rF(i,n,e))}},nF=(e,t)=>{t.shouldUseNativeValidation&&WT(e,t);const n={};for(const s in e){const i=Qt(t.fields,s),c=Object.assign(e[s]||{},{ref:i&&i.ref});if(dde(t.names||Object.keys(e),s)){const u=Object.assign({},Qt(n,s));zn(u,"root",c),zn(n,s,u)}else zn(n,s,c)}return n},dde=(e,t)=>{const n=sF(t);return e.some(s=>sF(s).match(`^${n}\\.\\d+`))};function sF(e){return e.replace(/\]|\[/g,"")}function hW(e,t,n){function s(a,m){var p;Object.defineProperty(a,"_zod",{value:a._zod??{},enumerable:!1}),(p=a._zod).traits??(p.traits=new Set),a._zod.traits.add(e),t(a,m);for(const y in u.prototype)y in a||Object.defineProperty(a,y,{value:u.prototype[y].bind(a)});a._zod.constr=u,a._zod.def=m}const i=(n==null?void 0:n.Parent)??Object;class c extends i{}Object.defineProperty(c,"name",{value:e});function u(a){var m;const p=n!=null&&n.Parent?new c:this;s(p,a),(m=p._zod).deferred??(m.deferred=[]);for(const y of p._zod.deferred)y();return p}return Object.defineProperty(u,"init",{value:s}),Object.defineProperty(u,Symbol.hasInstance,{value:a=>{var m,p;return n!=null&&n.Parent&&a instanceof n.Parent?!0:(p=(m=a==null?void 0:a._zod)==null?void 0:m.traits)==null?void 0:p.has(e)}}),Object.defineProperty(u,"name",{value:e}),u}class hde extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const fde={};function fW(e){return fde}function mde(e,t){return typeof t=="bigint"?t.toString():t}const mW=Error.captureStackTrace?Error.captureStackTrace:(...e)=>{};function Jw(e){return typeof e=="string"?e:e==null?void 0:e.message}function pW(e,t,n){var i,c,u,a,m,p;const s={...e,path:e.path??[]};if(!e.message){const y=Jw((u=(c=(i=e.inst)==null?void 0:i._zod.def)==null?void 0:c.error)==null?void 0:u.call(c,e))??Jw((a=t==null?void 0:t.error)==null?void 0:a.call(t,e))??Jw((m=n.customError)==null?void 0:m.call(n,e))??Jw((p=n.localeError)==null?void 0:p.call(n,e))??"Invalid input";s.message=y}return delete s.inst,delete s.continue,t!=null&&t.reportInput||delete s.input,s}const gW=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),Object.defineProperty(e,"message",{get(){return JSON.stringify(t,mde,2)},enumerable:!0}),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},pde=hW("$ZodError",gW),xW=hW("$ZodError",gW,{Parent:Error}),gde=e=>(t,n,s,i)=>{const c=s?Object.assign(s,{async:!1}):{async:!1},u=t._zod.run({value:n,issues:[]},c);if(u instanceof Promise)throw new hde;if(u.issues.length){const a=new((i==null?void 0:i.Err)??e)(u.issues.map(m=>pW(m,c,fW())));throw mW(a,i==null?void 0:i.callee),a}return u.value},xde=gde(xW),yde=e=>async(t,n,s,i)=>{const c=s?Object.assign(s,{async:!0}):{async:!0};let u=t._zod.run({value:n,issues:[]},c);if(u instanceof Promise&&(u=await u),u.issues.length){const a=new((i==null?void 0:i.Err)??e)(u.issues.map(m=>pW(m,c,fW())));throw mW(a,i==null?void 0:i.callee),a}return u.value},vde=yde(xW);function iF(e,t){try{var n=e()}catch(s){return t(s)}return n&&n.then?n.then(void 0,t):n}function _de(e,t){for(var n={};e.length;){var s=e[0],i=s.code,c=s.message,u=s.path.join(".");if(!n[u])if("unionErrors"in s){var a=s.unionErrors[0].errors[0];n[u]={message:a.message,type:a.code}}else n[u]={message:c,type:i};if("unionErrors"in s&&s.unionErrors.forEach(function(y){return y.errors.forEach(function(v){return e.push(v)})}),t){var m=n[u].types,p=m&&m[s.code];n[u]=gI(u,t,n,i,p?[].concat(p,s.message):s.message)}e.shift()}return n}function bde(e,t){for(var n={};e.length;){var s=e[0],i=s.code,c=s.message,u=s.path.join(".");if(!n[u])if(s.code==="invalid_union"&&s.errors.length>0){var a=s.errors[0][0];n[u]={message:a.message,type:a.code}}else n[u]={message:c,type:i};if(s.code==="invalid_union"&&s.errors.forEach(function(y){return y.forEach(function(v){return e.push(v)})}),t){var m=n[u].types,p=m&&m[s.code];n[u]=gI(u,t,n,i,p?[].concat(p,s.message):s.message)}e.shift()}return n}function Jh(e,t,n){if(n===void 0&&(n={}),function(s){return"_def"in s&&typeof s._def=="object"&&"typeName"in s._def}(e))return function(s,i,c){try{return Promise.resolve(iF(function(){return Promise.resolve(e[n.mode==="sync"?"parse":"parseAsync"](s,t)).then(function(u){return c.shouldUseNativeValidation&&WT({},c),{errors:{},values:n.raw?Object.assign({},s):u}})},function(u){if(function(a){return Array.isArray(a==null?void 0:a.issues)}(u))return{values:{},errors:nF(_de(u.errors,!c.shouldUseNativeValidation&&c.criteriaMode==="all"),c)};throw u}))}catch(u){return Promise.reject(u)}};if(function(s){return"_zod"in s&&typeof s._zod=="object"}(e))return function(s,i,c){try{return Promise.resolve(iF(function(){return Promise.resolve((n.mode==="sync"?xde:vde)(e,s,t)).then(function(u){return c.shouldUseNativeValidation&&WT({},c),{errors:{},values:n.raw?Object.assign({},s):u}})},function(u){if(function(a){return a instanceof pde}(u))return{values:{},errors:nF(bde(u.issues,!c.shouldUseNativeValidation&&c.criteriaMode==="all"),c)};throw u}))}catch(u){return Promise.reject(u)}};throw new Error("Invalid input: not a Zod schema")}var Rn;(function(e){e.assertEqual=i=>{};function t(i){}e.assertIs=t;function n(i){throw new Error}e.assertNever=n,e.arrayToEnum=i=>{const c={};for(const u of i)c[u]=u;return c},e.getValidEnumValues=i=>{const c=e.objectKeys(i).filter(a=>typeof i[i[a]]!="number"),u={};for(const a of c)u[a]=i[a];return e.objectValues(u)},e.objectValues=i=>e.objectKeys(i).map(function(c){return i[c]}),e.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const c=[];for(const u in i)Object.prototype.hasOwnProperty.call(i,u)&&c.push(u);return c},e.find=(i,c)=>{for(const u of i)if(c(u))return u},e.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function s(i,c=" | "){return i.map(u=>typeof u=="string"?`'${u}'`:u).join(c)}e.joinValues=s,e.jsonStringifyReplacer=(i,c)=>typeof c=="bigint"?c.toString():c})(Rn||(Rn={}));var aF;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(aF||(aF={}));const kr=Rn.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),dh=e=>{switch(typeof e){case"undefined":return kr.undefined;case"string":return kr.string;case"number":return Number.isNaN(e)?kr.nan:kr.number;case"boolean":return kr.boolean;case"function":return kr.function;case"bigint":return kr.bigint;case"symbol":return kr.symbol;case"object":return Array.isArray(e)?kr.array:e===null?kr.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?kr.promise:typeof Map<"u"&&e instanceof Map?kr.map:typeof Set<"u"&&e instanceof Set?kr.set:typeof Date<"u"&&e instanceof Date?kr.date:kr.object;default:return kr.unknown}},Gt=Rn.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class dd extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(c){return c.message},s={_errors:[]},i=c=>{for(const u of c.issues)if(u.code==="invalid_union")u.unionErrors.map(i);else if(u.code==="invalid_return_type")i(u.returnTypeError);else if(u.code==="invalid_arguments")i(u.argumentsError);else if(u.path.length===0)s._errors.push(n(u));else{let a=s,m=0;for(;m<u.path.length;){const p=u.path[m];m===u.path.length-1?(a[p]=a[p]||{_errors:[]},a[p]._errors.push(n(u))):a[p]=a[p]||{_errors:[]},a=a[p],m++}}};return i(this),s}static assert(t){if(!(t instanceof dd))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Rn.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},s=[];for(const i of this.issues)if(i.path.length>0){const c=i.path[0];n[c]=n[c]||[],n[c].push(t(i))}else s.push(t(i));return{formErrors:s,fieldErrors:n}}get formErrors(){return this.flatten()}}dd.create=e=>new dd(e);const GT=(e,t)=>{let n;switch(e.code){case Gt.invalid_type:e.received===kr.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Gt.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Rn.jsonStringifyReplacer)}`;break;case Gt.unrecognized_keys:n=`Unrecognized key(s) in object: ${Rn.joinValues(e.keys,", ")}`;break;case Gt.invalid_union:n="Invalid input";break;case Gt.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Rn.joinValues(e.options)}`;break;case Gt.invalid_enum_value:n=`Invalid enum value. Expected ${Rn.joinValues(e.options)}, received '${e.received}'`;break;case Gt.invalid_arguments:n="Invalid function arguments";break;case Gt.invalid_return_type:n="Invalid function return type";break;case Gt.invalid_date:n="Invalid date";break;case Gt.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Rn.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Gt.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Gt.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Gt.custom:n="Invalid input";break;case Gt.invalid_intersection_types:n="Intersection results could not be merged";break;case Gt.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Gt.not_finite:n="Number must be finite";break;default:n=t.defaultError,Rn.assertNever(e)}return{message:n}};let jde=GT;function wde(){return jde}const Sde=e=>{const{data:t,path:n,errorMaps:s,issueData:i}=e,c=[...n,...i.path||[]],u={...i,path:c};if(i.message!==void 0)return{...i,path:c,message:i.message};let a="";const m=s.filter(p=>!!p).slice().reverse();for(const p of m)a=p(u,{data:t,defaultError:a}).message;return{...i,path:c,message:a}};function mr(e,t){const n=wde(),s=Sde({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===GT?void 0:GT].filter(i=>!!i)});e.common.issues.push(s)}class Jo{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const s=[];for(const i of n){if(i.status==="aborted")return an;i.status==="dirty"&&t.dirty(),s.push(i.value)}return{status:t.value,value:s}}static async mergeObjectAsync(t,n){const s=[];for(const i of n){const c=await i.key,u=await i.value;s.push({key:c,value:u})}return Jo.mergeObjectSync(t,s)}static mergeObjectSync(t,n){const s={};for(const i of n){const{key:c,value:u}=i;if(c.status==="aborted"||u.status==="aborted")return an;c.status==="dirty"&&t.dirty(),u.status==="dirty"&&t.dirty(),c.value!=="__proto__"&&(typeof u.value<"u"||i.alwaysSet)&&(s[c.value]=u.value)}return{status:t.value,value:s}}}const an=Object.freeze({status:"aborted"}),q_=e=>({status:"dirty",value:e}),Tl=e=>({status:"valid",value:e}),oF=e=>e.status==="aborted",lF=e=>e.status==="dirty",Ix=e=>e.status==="valid",NS=e=>typeof Promise<"u"&&e instanceof Promise;var Dr;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Dr||(Dr={}));class ef{constructor(t,n,s,i){this._cachedPath=[],this.parent=t,this.data=n,this._path=s,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const cF=(e,t)=>{if(Ix(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new dd(e.common.issues);return this._error=n,this._error}}};function bn(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:s,description:i}=e;if(t&&(n||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:i}:{errorMap:(u,a)=>{const{message:m}=e;return u.code==="invalid_enum_value"?{message:m??a.defaultError}:typeof a.data>"u"?{message:m??s??a.defaultError}:u.code!=="invalid_type"?{message:a.defaultError}:{message:m??n??a.defaultError}},description:i}}class Dn{get description(){return this._def.description}_getType(t){return dh(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:dh(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Jo,ctx:{common:t.parent.common,data:t.data,parsedType:dh(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(NS(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const s=this.safeParse(t,n);if(s.success)return s.data;throw s.error}safeParse(t,n){const s={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:dh(t)},i=this._parseSync({data:t,path:s.path,parent:s});return cF(s,i)}"~validate"(t){var s,i;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:dh(t)};if(!this["~standard"].async)try{const c=this._parseSync({data:t,path:[],parent:n});return Ix(c)?{value:c.value}:{issues:n.common.issues}}catch(c){(i=(s=c==null?void 0:c.message)==null?void 0:s.toLowerCase())!=null&&i.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(c=>Ix(c)?{value:c.value}:{issues:n.common.issues})}async parseAsync(t,n){const s=await this.safeParseAsync(t,n);if(s.success)return s.data;throw s.error}async safeParseAsync(t,n){const s={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:dh(t)},i=this._parse({data:t,path:s.path,parent:s}),c=await(NS(i)?i:Promise.resolve(i));return cF(s,c)}refine(t,n){const s=i=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(i):n;return this._refinement((i,c)=>{const u=t(i),a=()=>c.addIssue({code:Gt.custom,...s(i)});return typeof Promise<"u"&&u instanceof Promise?u.then(m=>m?!0:(a(),!1)):u?!0:(a(),!1)})}refinement(t,n){return this._refinement((s,i)=>t(s)?!0:(i.addIssue(typeof n=="function"?n(s,i):n),!1))}_refinement(t){return new Lx({schema:this,typeName:on.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Bh.create(this,this._def)}nullable(){return Fx.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Yc.create(this)}promise(){return kS.create(this,this._def)}or(t){return CS.create([this,t],this._def)}and(t){return AS.create(this,t,this._def)}transform(t){return new Lx({...bn(this._def),schema:this,typeName:on.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new HT({...bn(this._def),innerType:this,defaultValue:n,typeName:on.ZodDefault})}brand(){return new Kde({typeName:on.ZodBranded,type:this,...bn(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new ZT({...bn(this._def),innerType:this,catchValue:n,typeName:on.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return _I.create(this,t)}readonly(){return YT.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Nde=/^c[^\s-]{8,}$/i,Pde=/^[0-9a-z]+$/,Cde=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Ade=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,kde=/^[a-z0-9_-]{21}$/i,Tde=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Ede=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Mde=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Ode="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let EA;const Ide=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Dde=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Rde=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Lde=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Fde=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,zde=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,yW="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",$de=new RegExp(`^${yW}$`);function vW(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function Bde(e){return new RegExp(`^${vW(e)}$`)}function qde(e){let t=`${yW}T${vW(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function Vde(e,t){return!!((t==="v4"||!t)&&Ide.test(e)||(t==="v6"||!t)&&Rde.test(e))}function Ude(e,t){if(!Tde.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const s=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),i=JSON.parse(atob(s));return!(typeof i!="object"||i===null||"typ"in i&&(i==null?void 0:i.typ)!=="JWT"||!i.alg||t&&i.alg!==t)}catch{return!1}}function Wde(e,t){return!!((t==="v4"||!t)&&Dde.test(e)||(t==="v6"||!t)&&Lde.test(e))}class kh extends Dn{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==kr.string){const c=this._getOrReturnCtx(t);return mr(c,{code:Gt.invalid_type,expected:kr.string,received:c.parsedType}),an}const s=new Jo;let i;for(const c of this._def.checks)if(c.kind==="min")t.data.length<c.value&&(i=this._getOrReturnCtx(t,i),mr(i,{code:Gt.too_small,minimum:c.value,type:"string",inclusive:!0,exact:!1,message:c.message}),s.dirty());else if(c.kind==="max")t.data.length>c.value&&(i=this._getOrReturnCtx(t,i),mr(i,{code:Gt.too_big,maximum:c.value,type:"string",inclusive:!0,exact:!1,message:c.message}),s.dirty());else if(c.kind==="length"){const u=t.data.length>c.value,a=t.data.length<c.value;(u||a)&&(i=this._getOrReturnCtx(t,i),u?mr(i,{code:Gt.too_big,maximum:c.value,type:"string",inclusive:!0,exact:!0,message:c.message}):a&&mr(i,{code:Gt.too_small,minimum:c.value,type:"string",inclusive:!0,exact:!0,message:c.message}),s.dirty())}else if(c.kind==="email")Mde.test(t.data)||(i=this._getOrReturnCtx(t,i),mr(i,{validation:"email",code:Gt.invalid_string,message:c.message}),s.dirty());else if(c.kind==="emoji")EA||(EA=new RegExp(Ode,"u")),EA.test(t.data)||(i=this._getOrReturnCtx(t,i),mr(i,{validation:"emoji",code:Gt.invalid_string,message:c.message}),s.dirty());else if(c.kind==="uuid")Ade.test(t.data)||(i=this._getOrReturnCtx(t,i),mr(i,{validation:"uuid",code:Gt.invalid_string,message:c.message}),s.dirty());else if(c.kind==="nanoid")kde.test(t.data)||(i=this._getOrReturnCtx(t,i),mr(i,{validation:"nanoid",code:Gt.invalid_string,message:c.message}),s.dirty());else if(c.kind==="cuid")Nde.test(t.data)||(i=this._getOrReturnCtx(t,i),mr(i,{validation:"cuid",code:Gt.invalid_string,message:c.message}),s.dirty());else if(c.kind==="cuid2")Pde.test(t.data)||(i=this._getOrReturnCtx(t,i),mr(i,{validation:"cuid2",code:Gt.invalid_string,message:c.message}),s.dirty());else if(c.kind==="ulid")Cde.test(t.data)||(i=this._getOrReturnCtx(t,i),mr(i,{validation:"ulid",code:Gt.invalid_string,message:c.message}),s.dirty());else if(c.kind==="url")try{new URL(t.data)}catch{i=this._getOrReturnCtx(t,i),mr(i,{validation:"url",code:Gt.invalid_string,message:c.message}),s.dirty()}else c.kind==="regex"?(c.regex.lastIndex=0,c.regex.test(t.data)||(i=this._getOrReturnCtx(t,i),mr(i,{validation:"regex",code:Gt.invalid_string,message:c.message}),s.dirty())):c.kind==="trim"?t.data=t.data.trim():c.kind==="includes"?t.data.includes(c.value,c.position)||(i=this._getOrReturnCtx(t,i),mr(i,{code:Gt.invalid_string,validation:{includes:c.value,position:c.position},message:c.message}),s.dirty()):c.kind==="toLowerCase"?t.data=t.data.toLowerCase():c.kind==="toUpperCase"?t.data=t.data.toUpperCase():c.kind==="startsWith"?t.data.startsWith(c.value)||(i=this._getOrReturnCtx(t,i),mr(i,{code:Gt.invalid_string,validation:{startsWith:c.value},message:c.message}),s.dirty()):c.kind==="endsWith"?t.data.endsWith(c.value)||(i=this._getOrReturnCtx(t,i),mr(i,{code:Gt.invalid_string,validation:{endsWith:c.value},message:c.message}),s.dirty()):c.kind==="datetime"?qde(c).test(t.data)||(i=this._getOrReturnCtx(t,i),mr(i,{code:Gt.invalid_string,validation:"datetime",message:c.message}),s.dirty()):c.kind==="date"?$de.test(t.data)||(i=this._getOrReturnCtx(t,i),mr(i,{code:Gt.invalid_string,validation:"date",message:c.message}),s.dirty()):c.kind==="time"?Bde(c).test(t.data)||(i=this._getOrReturnCtx(t,i),mr(i,{code:Gt.invalid_string,validation:"time",message:c.message}),s.dirty()):c.kind==="duration"?Ede.test(t.data)||(i=this._getOrReturnCtx(t,i),mr(i,{validation:"duration",code:Gt.invalid_string,message:c.message}),s.dirty()):c.kind==="ip"?Vde(t.data,c.version)||(i=this._getOrReturnCtx(t,i),mr(i,{validation:"ip",code:Gt.invalid_string,message:c.message}),s.dirty()):c.kind==="jwt"?Ude(t.data,c.alg)||(i=this._getOrReturnCtx(t,i),mr(i,{validation:"jwt",code:Gt.invalid_string,message:c.message}),s.dirty()):c.kind==="cidr"?Wde(t.data,c.version)||(i=this._getOrReturnCtx(t,i),mr(i,{validation:"cidr",code:Gt.invalid_string,message:c.message}),s.dirty()):c.kind==="base64"?Fde.test(t.data)||(i=this._getOrReturnCtx(t,i),mr(i,{validation:"base64",code:Gt.invalid_string,message:c.message}),s.dirty()):c.kind==="base64url"?zde.test(t.data)||(i=this._getOrReturnCtx(t,i),mr(i,{validation:"base64url",code:Gt.invalid_string,message:c.message}),s.dirty()):Rn.assertNever(c);return{status:s.value,value:t.data}}_regex(t,n,s){return this.refinement(i=>t.test(i),{validation:n,code:Gt.invalid_string,...Dr.errToObj(s)})}_addCheck(t){return new kh({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Dr.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Dr.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Dr.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Dr.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Dr.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Dr.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Dr.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Dr.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Dr.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Dr.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Dr.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Dr.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Dr.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...Dr.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Dr.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Dr.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...Dr.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...Dr.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...Dr.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...Dr.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...Dr.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...Dr.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...Dr.errToObj(n)})}nonempty(t){return this.min(1,Dr.errToObj(t))}trim(){return new kh({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new kh({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new kh({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}kh.create=e=>new kh({checks:[],typeName:on.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...bn(e)});function Gde(e,t){const n=(e.toString().split(".")[1]||"").length,s=(t.toString().split(".")[1]||"").length,i=n>s?n:s,c=Number.parseInt(e.toFixed(i).replace(".","")),u=Number.parseInt(t.toFixed(i).replace(".",""));return c%u/10**i}class Dx extends Dn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==kr.number){const c=this._getOrReturnCtx(t);return mr(c,{code:Gt.invalid_type,expected:kr.number,received:c.parsedType}),an}let s;const i=new Jo;for(const c of this._def.checks)c.kind==="int"?Rn.isInteger(t.data)||(s=this._getOrReturnCtx(t,s),mr(s,{code:Gt.invalid_type,expected:"integer",received:"float",message:c.message}),i.dirty()):c.kind==="min"?(c.inclusive?t.data<c.value:t.data<=c.value)&&(s=this._getOrReturnCtx(t,s),mr(s,{code:Gt.too_small,minimum:c.value,type:"number",inclusive:c.inclusive,exact:!1,message:c.message}),i.dirty()):c.kind==="max"?(c.inclusive?t.data>c.value:t.data>=c.value)&&(s=this._getOrReturnCtx(t,s),mr(s,{code:Gt.too_big,maximum:c.value,type:"number",inclusive:c.inclusive,exact:!1,message:c.message}),i.dirty()):c.kind==="multipleOf"?Gde(t.data,c.value)!==0&&(s=this._getOrReturnCtx(t,s),mr(s,{code:Gt.not_multiple_of,multipleOf:c.value,message:c.message}),i.dirty()):c.kind==="finite"?Number.isFinite(t.data)||(s=this._getOrReturnCtx(t,s),mr(s,{code:Gt.not_finite,message:c.message}),i.dirty()):Rn.assertNever(c);return{status:i.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,Dr.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Dr.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Dr.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Dr.toString(n))}setLimit(t,n,s,i){return new Dx({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:s,message:Dr.toString(i)}]})}_addCheck(t){return new Dx({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Dr.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Dr.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Dr.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Dr.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Dr.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Dr.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:Dr.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Dr.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Dr.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Rn.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(n===null||s.value>n)&&(n=s.value):s.kind==="max"&&(t===null||s.value<t)&&(t=s.value)}return Number.isFinite(n)&&Number.isFinite(t)}}Dx.create=e=>new Dx({checks:[],typeName:on.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...bn(e)});class I0 extends Dn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==kr.bigint)return this._getInvalidInput(t);let s;const i=new Jo;for(const c of this._def.checks)c.kind==="min"?(c.inclusive?t.data<c.value:t.data<=c.value)&&(s=this._getOrReturnCtx(t,s),mr(s,{code:Gt.too_small,type:"bigint",minimum:c.value,inclusive:c.inclusive,message:c.message}),i.dirty()):c.kind==="max"?(c.inclusive?t.data>c.value:t.data>=c.value)&&(s=this._getOrReturnCtx(t,s),mr(s,{code:Gt.too_big,type:"bigint",maximum:c.value,inclusive:c.inclusive,message:c.message}),i.dirty()):c.kind==="multipleOf"?t.data%c.value!==BigInt(0)&&(s=this._getOrReturnCtx(t,s),mr(s,{code:Gt.not_multiple_of,multipleOf:c.value,message:c.message}),i.dirty()):Rn.assertNever(c);return{status:i.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return mr(n,{code:Gt.invalid_type,expected:kr.bigint,received:n.parsedType}),an}gte(t,n){return this.setLimit("min",t,!0,Dr.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Dr.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Dr.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Dr.toString(n))}setLimit(t,n,s,i){return new I0({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:s,message:Dr.toString(i)}]})}_addCheck(t){return new I0({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Dr.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Dr.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Dr.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Dr.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Dr.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}I0.create=e=>new I0({checks:[],typeName:on.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...bn(e)});class uF extends Dn{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==kr.boolean){const s=this._getOrReturnCtx(t);return mr(s,{code:Gt.invalid_type,expected:kr.boolean,received:s.parsedType}),an}return Tl(t.data)}}uF.create=e=>new uF({typeName:on.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...bn(e)});class PS extends Dn{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==kr.date){const c=this._getOrReturnCtx(t);return mr(c,{code:Gt.invalid_type,expected:kr.date,received:c.parsedType}),an}if(Number.isNaN(t.data.getTime())){const c=this._getOrReturnCtx(t);return mr(c,{code:Gt.invalid_date}),an}const s=new Jo;let i;for(const c of this._def.checks)c.kind==="min"?t.data.getTime()<c.value&&(i=this._getOrReturnCtx(t,i),mr(i,{code:Gt.too_small,message:c.message,inclusive:!0,exact:!1,minimum:c.value,type:"date"}),s.dirty()):c.kind==="max"?t.data.getTime()>c.value&&(i=this._getOrReturnCtx(t,i),mr(i,{code:Gt.too_big,message:c.message,inclusive:!0,exact:!1,maximum:c.value,type:"date"}),s.dirty()):Rn.assertNever(c);return{status:s.value,value:new Date(t.data.getTime())}}_addCheck(t){return new PS({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:Dr.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:Dr.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}PS.create=e=>new PS({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:on.ZodDate,...bn(e)});class dF extends Dn{_parse(t){if(this._getType(t)!==kr.symbol){const s=this._getOrReturnCtx(t);return mr(s,{code:Gt.invalid_type,expected:kr.symbol,received:s.parsedType}),an}return Tl(t.data)}}dF.create=e=>new dF({typeName:on.ZodSymbol,...bn(e)});class hF extends Dn{_parse(t){if(this._getType(t)!==kr.undefined){const s=this._getOrReturnCtx(t);return mr(s,{code:Gt.invalid_type,expected:kr.undefined,received:s.parsedType}),an}return Tl(t.data)}}hF.create=e=>new hF({typeName:on.ZodUndefined,...bn(e)});class fF extends Dn{_parse(t){if(this._getType(t)!==kr.null){const s=this._getOrReturnCtx(t);return mr(s,{code:Gt.invalid_type,expected:kr.null,received:s.parsedType}),an}return Tl(t.data)}}fF.create=e=>new fF({typeName:on.ZodNull,...bn(e)});class mF extends Dn{constructor(){super(...arguments),this._any=!0}_parse(t){return Tl(t.data)}}mF.create=e=>new mF({typeName:on.ZodAny,...bn(e)});class pF extends Dn{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Tl(t.data)}}pF.create=e=>new pF({typeName:on.ZodUnknown,...bn(e)});class tf extends Dn{_parse(t){const n=this._getOrReturnCtx(t);return mr(n,{code:Gt.invalid_type,expected:kr.never,received:n.parsedType}),an}}tf.create=e=>new tf({typeName:on.ZodNever,...bn(e)});class gF extends Dn{_parse(t){if(this._getType(t)!==kr.undefined){const s=this._getOrReturnCtx(t);return mr(s,{code:Gt.invalid_type,expected:kr.void,received:s.parsedType}),an}return Tl(t.data)}}gF.create=e=>new gF({typeName:on.ZodVoid,...bn(e)});class Yc extends Dn{_parse(t){const{ctx:n,status:s}=this._processInputParams(t),i=this._def;if(n.parsedType!==kr.array)return mr(n,{code:Gt.invalid_type,expected:kr.array,received:n.parsedType}),an;if(i.exactLength!==null){const u=n.data.length>i.exactLength.value,a=n.data.length<i.exactLength.value;(u||a)&&(mr(n,{code:u?Gt.too_big:Gt.too_small,minimum:a?i.exactLength.value:void 0,maximum:u?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),s.dirty())}if(i.minLength!==null&&n.data.length<i.minLength.value&&(mr(n,{code:Gt.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),s.dirty()),i.maxLength!==null&&n.data.length>i.maxLength.value&&(mr(n,{code:Gt.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),s.dirty()),n.common.async)return Promise.all([...n.data].map((u,a)=>i.type._parseAsync(new ef(n,u,n.path,a)))).then(u=>Jo.mergeArray(s,u));const c=[...n.data].map((u,a)=>i.type._parseSync(new ef(n,u,n.path,a)));return Jo.mergeArray(s,c)}get element(){return this._def.type}min(t,n){return new Yc({...this._def,minLength:{value:t,message:Dr.toString(n)}})}max(t,n){return new Yc({...this._def,maxLength:{value:t,message:Dr.toString(n)}})}length(t,n){return new Yc({...this._def,exactLength:{value:t,message:Dr.toString(n)}})}nonempty(t){return this.min(1,t)}}Yc.create=(e,t)=>new Yc({type:e,minLength:null,maxLength:null,exactLength:null,typeName:on.ZodArray,...bn(t)});function jg(e){if(e instanceof Ni){const t={};for(const n in e.shape){const s=e.shape[n];t[n]=Bh.create(jg(s))}return new Ni({...e._def,shape:()=>t})}else return e instanceof Yc?new Yc({...e._def,type:jg(e.element)}):e instanceof Bh?Bh.create(jg(e.unwrap())):e instanceof Fx?Fx.create(jg(e.unwrap())):e instanceof Um?Um.create(e.items.map(t=>jg(t))):e}class Ni extends Dn{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=Rn.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==kr.object){const p=this._getOrReturnCtx(t);return mr(p,{code:Gt.invalid_type,expected:kr.object,received:p.parsedType}),an}const{status:s,ctx:i}=this._processInputParams(t),{shape:c,keys:u}=this._getCached(),a=[];if(!(this._def.catchall instanceof tf&&this._def.unknownKeys==="strip"))for(const p in i.data)u.includes(p)||a.push(p);const m=[];for(const p of u){const y=c[p],v=i.data[p];m.push({key:{status:"valid",value:p},value:y._parse(new ef(i,v,i.path,p)),alwaysSet:p in i.data})}if(this._def.catchall instanceof tf){const p=this._def.unknownKeys;if(p==="passthrough")for(const y of a)m.push({key:{status:"valid",value:y},value:{status:"valid",value:i.data[y]}});else if(p==="strict")a.length>0&&(mr(i,{code:Gt.unrecognized_keys,keys:a}),s.dirty());else if(p!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const p=this._def.catchall;for(const y of a){const v=i.data[y];m.push({key:{status:"valid",value:y},value:p._parse(new ef(i,v,i.path,y)),alwaysSet:y in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const p=[];for(const y of m){const v=await y.key,j=await y.value;p.push({key:v,value:j,alwaysSet:y.alwaysSet})}return p}).then(p=>Jo.mergeObjectSync(s,p)):Jo.mergeObjectSync(s,m)}get shape(){return this._def.shape()}strict(t){return Dr.errToObj,new Ni({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,s)=>{var c,u;const i=((u=(c=this._def).errorMap)==null?void 0:u.call(c,n,s).message)??s.defaultError;return n.code==="unrecognized_keys"?{message:Dr.errToObj(t).message??i}:{message:i}}}:{}})}strip(){return new Ni({...this._def,unknownKeys:"strip"})}passthrough(){return new Ni({...this._def,unknownKeys:"passthrough"})}extend(t){return new Ni({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Ni({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:on.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new Ni({...this._def,catchall:t})}pick(t){const n={};for(const s of Rn.objectKeys(t))t[s]&&this.shape[s]&&(n[s]=this.shape[s]);return new Ni({...this._def,shape:()=>n})}omit(t){const n={};for(const s of Rn.objectKeys(this.shape))t[s]||(n[s]=this.shape[s]);return new Ni({...this._def,shape:()=>n})}deepPartial(){return jg(this)}partial(t){const n={};for(const s of Rn.objectKeys(this.shape)){const i=this.shape[s];t&&!t[s]?n[s]=i:n[s]=i.optional()}return new Ni({...this._def,shape:()=>n})}required(t){const n={};for(const s of Rn.objectKeys(this.shape))if(t&&!t[s])n[s]=this.shape[s];else{let c=this.shape[s];for(;c instanceof Bh;)c=c._def.innerType;n[s]=c}return new Ni({...this._def,shape:()=>n})}keyof(){return _W(Rn.objectKeys(this.shape))}}Ni.create=(e,t)=>new Ni({shape:()=>e,unknownKeys:"strip",catchall:tf.create(),typeName:on.ZodObject,...bn(t)});Ni.strictCreate=(e,t)=>new Ni({shape:()=>e,unknownKeys:"strict",catchall:tf.create(),typeName:on.ZodObject,...bn(t)});Ni.lazycreate=(e,t)=>new Ni({shape:e,unknownKeys:"strip",catchall:tf.create(),typeName:on.ZodObject,...bn(t)});class CS extends Dn{_parse(t){const{ctx:n}=this._processInputParams(t),s=this._def.options;function i(c){for(const a of c)if(a.result.status==="valid")return a.result;for(const a of c)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const u=c.map(a=>new dd(a.ctx.common.issues));return mr(n,{code:Gt.invalid_union,unionErrors:u}),an}if(n.common.async)return Promise.all(s.map(async c=>{const u={...n,common:{...n.common,issues:[]},parent:null};return{result:await c._parseAsync({data:n.data,path:n.path,parent:u}),ctx:u}})).then(i);{let c;const u=[];for(const m of s){const p={...n,common:{...n.common,issues:[]},parent:null},y=m._parseSync({data:n.data,path:n.path,parent:p});if(y.status==="valid")return y;y.status==="dirty"&&!c&&(c={result:y,ctx:p}),p.common.issues.length&&u.push(p.common.issues)}if(c)return n.common.issues.push(...c.ctx.common.issues),c.result;const a=u.map(m=>new dd(m));return mr(n,{code:Gt.invalid_union,unionErrors:a}),an}}get options(){return this._def.options}}CS.create=(e,t)=>new CS({options:e,typeName:on.ZodUnion,...bn(t)});function KT(e,t){const n=dh(e),s=dh(t);if(e===t)return{valid:!0,data:e};if(n===kr.object&&s===kr.object){const i=Rn.objectKeys(t),c=Rn.objectKeys(e).filter(a=>i.indexOf(a)!==-1),u={...e,...t};for(const a of c){const m=KT(e[a],t[a]);if(!m.valid)return{valid:!1};u[a]=m.data}return{valid:!0,data:u}}else if(n===kr.array&&s===kr.array){if(e.length!==t.length)return{valid:!1};const i=[];for(let c=0;c<e.length;c++){const u=e[c],a=t[c],m=KT(u,a);if(!m.valid)return{valid:!1};i.push(m.data)}return{valid:!0,data:i}}else return n===kr.date&&s===kr.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class AS extends Dn{_parse(t){const{status:n,ctx:s}=this._processInputParams(t),i=(c,u)=>{if(oF(c)||oF(u))return an;const a=KT(c.value,u.value);return a.valid?((lF(c)||lF(u))&&n.dirty(),{status:n.value,value:a.data}):(mr(s,{code:Gt.invalid_intersection_types}),an)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([c,u])=>i(c,u)):i(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}AS.create=(e,t,n)=>new AS({left:e,right:t,typeName:on.ZodIntersection,...bn(n)});class Um extends Dn{_parse(t){const{status:n,ctx:s}=this._processInputParams(t);if(s.parsedType!==kr.array)return mr(s,{code:Gt.invalid_type,expected:kr.array,received:s.parsedType}),an;if(s.data.length<this._def.items.length)return mr(s,{code:Gt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),an;!this._def.rest&&s.data.length>this._def.items.length&&(mr(s,{code:Gt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const c=[...s.data].map((u,a)=>{const m=this._def.items[a]||this._def.rest;return m?m._parse(new ef(s,u,s.path,a)):null}).filter(u=>!!u);return s.common.async?Promise.all(c).then(u=>Jo.mergeArray(n,u)):Jo.mergeArray(n,c)}get items(){return this._def.items}rest(t){return new Um({...this._def,rest:t})}}Um.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Um({items:e,typeName:on.ZodTuple,rest:null,...bn(t)})};class xF extends Dn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:s}=this._processInputParams(t);if(s.parsedType!==kr.map)return mr(s,{code:Gt.invalid_type,expected:kr.map,received:s.parsedType}),an;const i=this._def.keyType,c=this._def.valueType,u=[...s.data.entries()].map(([a,m],p)=>({key:i._parse(new ef(s,a,s.path,[p,"key"])),value:c._parse(new ef(s,m,s.path,[p,"value"]))}));if(s.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const m of u){const p=await m.key,y=await m.value;if(p.status==="aborted"||y.status==="aborted")return an;(p.status==="dirty"||y.status==="dirty")&&n.dirty(),a.set(p.value,y.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const m of u){const p=m.key,y=m.value;if(p.status==="aborted"||y.status==="aborted")return an;(p.status==="dirty"||y.status==="dirty")&&n.dirty(),a.set(p.value,y.value)}return{status:n.value,value:a}}}}xF.create=(e,t,n)=>new xF({valueType:t,keyType:e,typeName:on.ZodMap,...bn(n)});class D0 extends Dn{_parse(t){const{status:n,ctx:s}=this._processInputParams(t);if(s.parsedType!==kr.set)return mr(s,{code:Gt.invalid_type,expected:kr.set,received:s.parsedType}),an;const i=this._def;i.minSize!==null&&s.data.size<i.minSize.value&&(mr(s,{code:Gt.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),i.maxSize!==null&&s.data.size>i.maxSize.value&&(mr(s,{code:Gt.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());const c=this._def.valueType;function u(m){const p=new Set;for(const y of m){if(y.status==="aborted")return an;y.status==="dirty"&&n.dirty(),p.add(y.value)}return{status:n.value,value:p}}const a=[...s.data.values()].map((m,p)=>c._parse(new ef(s,m,s.path,p)));return s.common.async?Promise.all(a).then(m=>u(m)):u(a)}min(t,n){return new D0({...this._def,minSize:{value:t,message:Dr.toString(n)}})}max(t,n){return new D0({...this._def,maxSize:{value:t,message:Dr.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}D0.create=(e,t)=>new D0({valueType:e,minSize:null,maxSize:null,typeName:on.ZodSet,...bn(t)});class yF extends Dn{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}yF.create=(e,t)=>new yF({getter:e,typeName:on.ZodLazy,...bn(t)});class vF extends Dn{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return mr(n,{received:n.data,code:Gt.invalid_literal,expected:this._def.value}),an}return{status:"valid",value:t.data}}get value(){return this._def.value}}vF.create=(e,t)=>new vF({value:e,typeName:on.ZodLiteral,...bn(t)});function _W(e,t){return new Rx({values:e,typeName:on.ZodEnum,...bn(t)})}class Rx extends Dn{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),s=this._def.values;return mr(n,{expected:Rn.joinValues(s),received:n.parsedType,code:Gt.invalid_type}),an}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),s=this._def.values;return mr(n,{received:n.data,code:Gt.invalid_enum_value,options:s}),an}return Tl(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return Rx.create(t,{...this._def,...n})}exclude(t,n=this._def){return Rx.create(this.options.filter(s=>!t.includes(s)),{...this._def,...n})}}Rx.create=_W;class _F extends Dn{_parse(t){const n=Rn.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(t);if(s.parsedType!==kr.string&&s.parsedType!==kr.number){const i=Rn.objectValues(n);return mr(s,{expected:Rn.joinValues(i),received:s.parsedType,code:Gt.invalid_type}),an}if(this._cache||(this._cache=new Set(Rn.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const i=Rn.objectValues(n);return mr(s,{received:s.data,code:Gt.invalid_enum_value,options:i}),an}return Tl(t.data)}get enum(){return this._def.values}}_F.create=(e,t)=>new _F({values:e,typeName:on.ZodNativeEnum,...bn(t)});class kS extends Dn{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==kr.promise&&n.common.async===!1)return mr(n,{code:Gt.invalid_type,expected:kr.promise,received:n.parsedType}),an;const s=n.parsedType===kr.promise?n.data:Promise.resolve(n.data);return Tl(s.then(i=>this._def.type.parseAsync(i,{path:n.path,errorMap:n.common.contextualErrorMap})))}}kS.create=(e,t)=>new kS({type:e,typeName:on.ZodPromise,...bn(t)});class Lx extends Dn{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===on.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:s}=this._processInputParams(t),i=this._def.effect||null,c={addIssue:u=>{mr(s,u),u.fatal?n.abort():n.dirty()},get path(){return s.path}};if(c.addIssue=c.addIssue.bind(c),i.type==="preprocess"){const u=i.transform(s.data,c);if(s.common.async)return Promise.resolve(u).then(async a=>{if(n.value==="aborted")return an;const m=await this._def.schema._parseAsync({data:a,path:s.path,parent:s});return m.status==="aborted"?an:m.status==="dirty"||n.value==="dirty"?q_(m.value):m});{if(n.value==="aborted")return an;const a=this._def.schema._parseSync({data:u,path:s.path,parent:s});return a.status==="aborted"?an:a.status==="dirty"||n.value==="dirty"?q_(a.value):a}}if(i.type==="refinement"){const u=a=>{const m=i.refinement(a,c);if(s.common.async)return Promise.resolve(m);if(m instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(s.common.async===!1){const a=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return a.status==="aborted"?an:(a.status==="dirty"&&n.dirty(),u(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(a=>a.status==="aborted"?an:(a.status==="dirty"&&n.dirty(),u(a.value).then(()=>({status:n.value,value:a.value}))))}if(i.type==="transform")if(s.common.async===!1){const u=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!Ix(u))return an;const a=i.transform(u.value,c);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(u=>Ix(u)?Promise.resolve(i.transform(u.value,c)).then(a=>({status:n.value,value:a})):an);Rn.assertNever(i)}}Lx.create=(e,t,n)=>new Lx({schema:e,typeName:on.ZodEffects,effect:t,...bn(n)});Lx.createWithPreprocess=(e,t,n)=>new Lx({schema:t,effect:{type:"preprocess",transform:e},typeName:on.ZodEffects,...bn(n)});class Bh extends Dn{_parse(t){return this._getType(t)===kr.undefined?Tl(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Bh.create=(e,t)=>new Bh({innerType:e,typeName:on.ZodOptional,...bn(t)});class Fx extends Dn{_parse(t){return this._getType(t)===kr.null?Tl(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Fx.create=(e,t)=>new Fx({innerType:e,typeName:on.ZodNullable,...bn(t)});class HT extends Dn{_parse(t){const{ctx:n}=this._processInputParams(t);let s=n.data;return n.parsedType===kr.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}HT.create=(e,t)=>new HT({innerType:e,typeName:on.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...bn(t)});class ZT extends Dn{_parse(t){const{ctx:n}=this._processInputParams(t),s={...n,common:{...n.common,issues:[]}},i=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return NS(i)?i.then(c=>({status:"valid",value:c.status==="valid"?c.value:this._def.catchValue({get error(){return new dd(s.common.issues)},input:s.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new dd(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}ZT.create=(e,t)=>new ZT({innerType:e,typeName:on.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...bn(t)});class bF extends Dn{_parse(t){if(this._getType(t)!==kr.nan){const s=this._getOrReturnCtx(t);return mr(s,{code:Gt.invalid_type,expected:kr.nan,received:s.parsedType}),an}return{status:"valid",value:t.data}}}bF.create=e=>new bF({typeName:on.ZodNaN,...bn(e)});class Kde extends Dn{_parse(t){const{ctx:n}=this._processInputParams(t),s=n.data;return this._def.type._parse({data:s,path:n.path,parent:n})}unwrap(){return this._def.type}}class _I extends Dn{_parse(t){const{status:n,ctx:s}=this._processInputParams(t);if(s.common.async)return(async()=>{const c=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return c.status==="aborted"?an:c.status==="dirty"?(n.dirty(),q_(c.value)):this._def.out._parseAsync({data:c.value,path:s.path,parent:s})})();{const i=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?an:i.status==="dirty"?(n.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:s.path,parent:s})}}static create(t,n){return new _I({in:t,out:n,typeName:on.ZodPipeline})}}class YT extends Dn{_parse(t){const n=this._def.innerType._parse(t),s=i=>(Ix(i)&&(i.value=Object.freeze(i.value)),i);return NS(n)?n.then(i=>s(i)):s(n)}unwrap(){return this._def.innerType}}YT.create=(e,t)=>new YT({innerType:e,typeName:on.ZodReadonly,...bn(t)});var on;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(on||(on={}));const mo=kh.create,xa=Dx.create;tf.create;Yc.create;const uf=Ni.create;CS.create;AS.create;Um.create;const Hde=Rx.create;kS.create;Bh.create;Fx.create;function Ps({control:e,name:t,label:n,type:s="text",placeholder:i,required:c=!1,error:u,step:a}){return r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Ne,{htmlFor:t,children:[n,c&&r.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),r.jsx(pI,{control:e,name:t,render:({field:{value:m,onChange:p,...y}})=>r.jsx(Ge,{...y,id:t,type:s,placeholder:i,step:a,className:u?"border-red-500":"",value:m??"",onChange:v=>{const j=v.target.value;p(s==="number"&&j===""?void 0:j)},onBlur:v=>{if(s==="number"&&v.target.value!==""){const j=parseFloat(v.target.value);p(isNaN(j)?v.target.value:j)}y.onBlur()}})}),u&&r.jsx("p",{className:"text-sm text-red-500",children:u})]})}const Zde={normal:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",alarm:"bg-yellow-100 text-yellow-800",critical:"bg-red-100 text-red-800"},Yde=uf({tag:mo().min(1,"Tag is required"),parameter:mo().min(1,"Parameter is required"),unit:mo().min(1,"Unit is required"),asset_id:xa().int().positive("Asset ID is required")}),Xde=uf({value:xa(),source:mo().optional()});function Qde(){var $,V,K,te,X,ve,ae,pe,Oe;const[e,t]=R.useState({page:1,per_page:15}),[n,s]=R.useState(!1),[i,c]=R.useState(!1),[u,a]=R.useState(null),m=br(),p=ia({resolver:Jh(Yde),defaultValues:{tag:"",parameter:"",unit:"",asset_id:1}}),y=ia({resolver:Jh(Xde),defaultValues:{value:0,source:"manual"}});R.useEffect(()=>{n||p.reset()},[n,p]),R.useEffect(()=>{i||(y.reset(),a(null))},[i,y]);const{data:v,isLoading:j,error:S}=ht({queryKey:["monitoring-tags",e],queryFn:()=>TA.getTags(e)}),k=jt({mutationFn:TA.createTag,onSuccess:()=>{m.invalidateQueries({queryKey:["monitoring-tags"]}),s(!1),qe.success("Tag created successfully")},onError:()=>qe.error("Failed to create tag")}),N=jt({mutationFn:({tagId:Me,data:Xe})=>TA.ingestReading(Me,Xe),onSuccess:()=>{m.invalidateQueries({queryKey:["monitoring-tags"]}),c(!1),qe.success("Reading recorded successfully")},onError:()=>qe.error("Failed to record reading")}),D=Me=>{k.mutate(Me)},O=Me=>{if(!u){qe.error("No tag selected");return}N.mutate({tagId:u.id,data:{value:Me.value,source:Me.source||"manual",read_at:new Date().toISOString()}})},T=(($=v==null?void 0:v.data)==null?void 0:$.filter(Me=>Me.health_status==="normal").length)||0,I=((V=v==null?void 0:v.data)==null?void 0:V.filter(Me=>Me.health_status==="warning").length)||0,z=((K=v==null?void 0:v.data)==null?void 0:K.filter(Me=>Me.health_status==="critical"||Me.health_status==="alarm").length)||0;return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Condition Monitoring"}),r.jsx("p",{className:"text-muted-foreground",children:"Track parameter trends and set alarms"})]}),r.jsxs(se,{onClick:()=>s(!0),children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"New Tag"]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsx(ge,{className:"pb-2",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(Wo,{className:"h-4 w-4"}),"Total Tags"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:(v==null?void 0:v.total)||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Monitored parameters"})]})]}),r.jsxs(J,{className:"border-green-200 bg-green-50",children:[r.jsx(ge,{className:"pb-2",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx($s,{className:"h-4 w-4 text-green-600"}),"Normal"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:T}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Within limits"})]})]}),r.jsxs(J,{className:"border-yellow-200 bg-yellow-50",children:[r.jsx(ge,{className:"pb-2",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(rne,{className:"h-4 w-4 text-yellow-600"}),"Warning"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:I}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Near limits"})]})]}),r.jsxs(J,{className:"border-red-200 bg-red-50",children:[r.jsx(ge,{className:"pb-2",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(gn,{className:"h-4 w-4 text-red-600"}),"Critical"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:z}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Out of limits"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Monitoring Tags"})}),r.jsx(ie,{children:j?r.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(v!=null&&v.data)||v.data.length===0?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No monitoring tags configured. Create your first tag to start tracking parameters."}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Tag"}),r.jsx(le,{children:"Parameter"}),r.jsx(le,{children:"Current Value"}),r.jsx(le,{children:"Limits"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Last Reading"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:v.data.map(Me=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-mono font-medium",children:Me.tag}),r.jsx(ne,{children:Me.parameter}),r.jsx(ne,{children:Me.last_value!==null?`${Me.last_value} ${Me.unit}`:""}),r.jsx(ne,{className:"text-xs",children:"Thresholds configured"}),r.jsx(ne,{children:r.jsx(We,{className:Zde[Me.health_status],children:Me.health_status})}),r.jsx(ne,{className:"text-sm text-muted-foreground",children:Me.last_reading_at?new Date(Me.last_reading_at).toLocaleString():"Never"}),r.jsx(ne,{children:r.jsxs(se,{size:"sm",variant:"outline",onClick:()=>{a(Me),c(!0)},children:[r.jsx(Wo,{className:"h-4 w-4 mr-1"}),"Record"]})})]},Me.id))})]})})]}),r.jsx(Rr,{open:n,onOpenChange:s,children:r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Create Monitoring Tag"})}),r.jsxs("form",{onSubmit:p.handleSubmit(D),className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx(Ps,{control:p.control,name:"tag",label:"Tag ID",placeholder:"e.g., P-101-FLOW",required:!0,error:(te=p.formState.errors.tag)==null?void 0:te.message}),r.jsx(Ps,{control:p.control,name:"parameter",label:"Parameter",placeholder:"e.g., Flow Rate",required:!0,error:(X=p.formState.errors.parameter)==null?void 0:X.message})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx(Ps,{control:p.control,name:"unit",label:"Unit",placeholder:"e.g., m/h",required:!0,error:(ve=p.formState.errors.unit)==null?void 0:ve.message}),r.jsx(Ps,{control:p.control,name:"asset_id",label:"Asset ID",type:"number",required:!0,error:(ae=p.formState.errors.asset_id)==null?void 0:ae.message})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:k.isPending||!p.formState.isValid,children:"Create Tag"})]})]})]})}),r.jsx(Rr,{open:i,onOpenChange:c,children:r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsxs(Or,{children:["Record Reading: ",u==null?void 0:u.tag]})}),r.jsxs("form",{onSubmit:y.handleSubmit(O),className:"space-y-4",children:[r.jsxs("div",{className:"bg-muted p-4 rounded-md",children:[r.jsx("p",{className:"text-sm font-medium",children:u==null?void 0:u.parameter}),r.jsxs("p",{className:"text-xs text-muted-foreground",children:["Tag: ",u==null?void 0:u.tag," | Unit: ",u==null?void 0:u.unit]})]}),r.jsx(Ps,{control:y.control,name:"value",label:`Value (${u==null?void 0:u.unit})`,type:"number",step:"0.01",required:!0,error:(pe=y.formState.errors.value)==null?void 0:pe.message}),r.jsx(Ps,{control:y.control,name:"source",label:"Source",placeholder:"e.g., manual, sensor",error:(Oe=y.formState.errors.source)==null?void 0:Oe.message}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>c(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:N.isPending||!y.formState.isValid,children:"Record Reading"})]})]})]})})]})}function R0({control:e,name:t,label:n,placeholder:s,required:i=!1,error:c,rows:u=3}){return r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Ne,{htmlFor:t,children:[n,i&&r.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),r.jsx(pI,{control:e,name:t,render:({field:a})=>r.jsx(Fs,{...a,id:t,placeholder:s,rows:u,className:c?"border-red-500":"",value:a.value??""})}),c&&r.jsx("p",{className:"text-sm text-red-500",children:c})]})}const Jde=uf({part_id:xa().int().positive("Part ID is required"),bin_id:xa().int().positive("Bin ID is required"),qty:xa().positive("Quantity must be positive"),unit_cost:xa().positive("Unit cost must be positive"),notes:mo().optional()}),ehe=uf({part_id:xa().int().positive("Part ID is required"),bin_id:xa().int().positive("Bin ID is required"),qty:xa().positive("Quantity must be positive"),work_order_id:xa().int().positive().optional(),notes:mo().optional()});function the(){var I,z,$,V,K,te,X,ve,ae,pe;const[e,t]=R.useState({page:1,per_page:15}),[n,s]=R.useState(!1),[i,c]=R.useState(!1),u=br(),a=ia({resolver:Jh(Jde),defaultValues:{part_id:0,bin_id:1,qty:0,unit_cost:0,notes:""}}),m=ia({resolver:Jh(ehe),defaultValues:{part_id:0,bin_id:1,qty:0,notes:""}});R.useEffect(()=>{n||a.reset()},[n,a]),R.useEffect(()=>{i||m.reset()},[i,m]);const{data:p,isLoading:y,error:v}=ht({queryKey:["stores",e],queryFn:()=>Xw.getStores(e)}),{data:j}=ht({queryKey:["low-stock"],queryFn:()=>Xw.getLowStock()}),S=jt({mutationFn:Xw.receiveStock,onSuccess:()=>{u.invalidateQueries({queryKey:["stores"]}),u.invalidateQueries({queryKey:["low-stock"]}),s(!1),qe.success("Stock received successfully")},onError:()=>qe.error("Failed to receive stock")}),k=jt({mutationFn:Xw.issueStock,onSuccess:()=>{u.invalidateQueries({queryKey:["stores"]}),u.invalidateQueries({queryKey:["low-stock"]}),c(!1),qe.success("Stock issued successfully")},onError:()=>qe.error("Failed to issue stock")}),N=Oe=>{S.mutate(Oe)},D=Oe=>{k.mutate(Oe)},O=0,T=(j==null?void 0:j.length)||0;return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Stores & Inventory"}),r.jsx("p",{className:"text-muted-foreground",children:"Spare parts, tools, and consumables"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(se,{onClick:()=>s(!0),children:[r.jsx(Dre,{className:"h-4 w-4 mr-2"}),"Receive Stock"]}),r.jsxs(se,{variant:"outline",onClick:()=>c(!0),children:[r.jsx(Rre,{className:"h-4 w-4 mr-2"}),"Issue Stock"]})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsx(ge,{className:"pb-2",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(Kc,{className:"h-4 w-4"}),"Total Items"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:(p==null?void 0:p.total)||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"SKUs in stock"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-2",children:r.jsx(xe,{className:"text-sm font-medium",children:"Inventory Value"})}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:["$",O.toFixed(2)]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Total cost"})]})]}),r.jsxs(J,{className:"border-yellow-200 bg-yellow-50",children:[r.jsx(ge,{className:"pb-2",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(eo,{className:"h-4 w-4 text-yellow-600"}),"Low Stock"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:T}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Items < 10 units"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-2",children:r.jsx(xe,{className:"text-sm font-medium",children:"Total Stores"})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:(p==null?void 0:p.total)||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Locations"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Stores"})}),r.jsx(ie,{children:y?r.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(p!=null&&p.data)||p.data.length===0?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No stores configured. Create a store to manage inventory."}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Store Name"}),r.jsx(le,{children:"Type"}),r.jsx(le,{children:"Location"}),r.jsx(le,{children:"Status"})]})}),r.jsx(ur,{children:p.data.map(Oe=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:Oe.name}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:Oe.type||"General"})}),r.jsx(ne,{className:"text-sm text-muted-foreground",children:Oe.location||""}),r.jsx(ne,{children:r.jsx(We,{className:"bg-green-100 text-green-800",children:"Active"})})]},Oe.id))})]})})]}),r.jsx(Rr,{open:n,onOpenChange:s,children:r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Receive Stock"})}),r.jsxs("form",{onSubmit:a.handleSubmit(N),className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx(Ps,{control:a.control,name:"part_id",label:"Part ID",type:"number",required:!0,error:(I=a.formState.errors.part_id)==null?void 0:I.message}),r.jsx(Ps,{control:a.control,name:"bin_id",label:"Bin ID",type:"number",required:!0,error:(z=a.formState.errors.bin_id)==null?void 0:z.message})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx(Ps,{control:a.control,name:"qty",label:"Quantity",type:"number",step:"0.01",required:!0,error:($=a.formState.errors.qty)==null?void 0:$.message}),r.jsx(Ps,{control:a.control,name:"unit_cost",label:"Unit Cost",type:"number",step:"0.01",required:!0,error:(V=a.formState.errors.unit_cost)==null?void 0:V.message})]}),r.jsx(R0,{control:a.control,name:"notes",label:"Notes",rows:3,error:(K=a.formState.errors.notes)==null?void 0:K.message}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:S.isPending||!a.formState.isValid,children:"Receive Stock"})]})]})]})}),r.jsx(Rr,{open:i,onOpenChange:c,children:r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Issue Stock"})}),r.jsxs("form",{onSubmit:m.handleSubmit(D),className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx(Ps,{control:m.control,name:"part_id",label:"Part ID",type:"number",required:!0,error:(te=m.formState.errors.part_id)==null?void 0:te.message}),r.jsx(Ps,{control:m.control,name:"bin_id",label:"Bin ID",type:"number",required:!0,error:(X=m.formState.errors.bin_id)==null?void 0:X.message})]}),r.jsx(Ps,{control:m.control,name:"qty",label:"Quantity",type:"number",step:"0.01",required:!0,error:(ve=m.formState.errors.qty)==null?void 0:ve.message}),r.jsx(Ps,{control:m.control,name:"work_order_id",label:"Work Order ID (optional)",type:"number",error:(ae=m.formState.errors.work_order_id)==null?void 0:ae.message}),r.jsx(R0,{control:m.control,name:"notes",label:"Notes",rows:3,error:(pe=m.formState.errors.notes)==null?void 0:pe.message}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>c(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:k.isPending||!m.formState.isValid,children:"Issue Stock"})]})]})]})})]})}function bW({control:e,name:t,label:n,options:s,placeholder:i="Select...",required:c=!1,error:u}){return r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Ne,{htmlFor:t,children:[n,c&&r.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),r.jsx(pI,{control:e,name:t,render:({field:a})=>r.jsxs(Jt,{onValueChange:a.onChange,value:a.value,children:[r.jsx(Yt,{className:u?"border-red-500":"",children:r.jsx(er,{placeholder:i})}),r.jsx(Xt,{children:s.map(m=>r.jsx(ke,{value:m.value,children:m.label},m.value))})]})}),u&&r.jsx("p",{className:"text-sm text-red-500",children:u})]})}const rhe={active:"bg-green-100 text-green-800",maintenance:"bg-yellow-100 text-yellow-800",retired:"bg-gray-100 text-gray-800"},nhe=uf({service_type:mo().min(1,"Service type is required"),cost:xa().positive("Cost must be positive"),odometer_reading:xa().optional(),notes:mo().optional()}),she=uf({liters:xa().positive("Liters must be positive"),cost:xa().positive("Cost must be positive"),odometer_reading:xa().positive("Odometer reading is required")});function ihe(){var $,V,K,te,X,ve,ae,pe,Oe;const[e,t]=R.useState({page:1,per_page:15,status:"all"}),[n,s]=R.useState(!1),[i,c]=R.useState(!1),[u,a]=R.useState(null),m=br(),p=ia({resolver:Jh(nhe),defaultValues:{service_type:"",cost:0,notes:""}}),y=ia({resolver:Jh(she),defaultValues:{liters:0,cost:0,odometer_reading:0}});R.useEffect(()=>{n||(p.reset(),a(null))},[n,p]),R.useEffect(()=>{i||(y.reset(),a(null))},[i,y]);const{data:v,isLoading:j,error:S}=ht({queryKey:["fleet-assets",e],queryFn:()=>Qw.getFleetAssets(e)}),{data:k}=ht({queryKey:["fleet-utilization"],queryFn:()=>Qw.getUtilization({})}),N=jt({mutationFn:({fleet_asset_id:Me,service_type:Xe,performed_at:Ve,notes:et,cost:Ce,odometer_reading:_e})=>Qw.createServiceSchedule(Me,{service_type:Xe,performed_at:Ve,notes:et,cost:Ce,odometer_reading:_e}),onSuccess:()=>{m.invalidateQueries({queryKey:["fleet-assets"]}),m.invalidateQueries({queryKey:["fleet-utilization"]}),s(!1),qe.success("Service logged successfully")},onError:()=>qe.error("Failed to log service")}),D=jt({mutationFn:({fleet_asset_id:Me,liters:Xe,cost:Ve,odometer_reading:et,filled_at:Ce})=>Qw.logFuel(Me,{odometer:et,liters:Xe,cost:Ve,filled_at:Ce}),onSuccess:()=>{m.invalidateQueries({queryKey:["fleet-assets"]}),c(!1),qe.success("Fuel logged successfully")},onError:()=>qe.error("Failed to log fuel")}),O=Me=>{if(!u){qe.error("No vehicle selected");return}N.mutate({fleet_asset_id:u.id,service_type:Me.service_type,performed_at:new Date().toISOString(),notes:Me.notes||"",cost:Me.cost,odometer_reading:Me.odometer_reading})},T=Me=>{if(!u){qe.error("No vehicle selected");return}D.mutate({fleet_asset_id:u.id,liters:Me.liters,cost:Me.cost,odometer_reading:Me.odometer_reading,filled_at:new Date().toISOString()})},I=(($=v==null?void 0:v.data)==null?void 0:$.filter(Me=>Me.status==="active").length)||0,z=((V=v==null?void 0:v.data)==null?void 0:V.filter(Me=>Me.status==="maintenance").length)||0;return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Fleet Management"}),r.jsx("p",{className:"text-muted-foreground",children:"Vehicles, generators, and mobile equipment"})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsx(ge,{className:"pb-2",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(k0,{className:"h-4 w-4"}),"Total Fleet"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:(v==null?void 0:v.total)||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Registered assets"})]})]}),r.jsxs(J,{className:"border-green-200 bg-green-50",children:[r.jsx(ge,{className:"pb-2",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx($s,{className:"h-4 w-4 text-green-600"}),"Active"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:I}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"In service"})]})]}),r.jsxs(J,{className:"border-yellow-200 bg-yellow-50",children:[r.jsx(ge,{className:"pb-2",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(Fm,{className:"h-4 w-4 text-yellow-600"}),"Maintenance"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:z}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Under repair"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-2",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(YL,{className:"h-4 w-4"}),"Avg Utilization"]})}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:[k&&k.length>0?(k.reduce((Me,Xe)=>Me+(Xe.utilization_pct||0),0)/k.length).toFixed(1):0,"%"]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Fleet uptime"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(xe,{children:"Fleet Assets"}),r.jsxs(Jt,{value:e.status,onValueChange:Me=>t({...e,status:Me,page:1}),children:[r.jsx(Yt,{className:"w-[200px]",children:r.jsx(er,{placeholder:"All Statuses"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Statuses"}),r.jsx(ke,{value:"active",children:"Active"}),r.jsx(ke,{value:"maintenance",children:"Maintenance"}),r.jsx(ke,{value:"retired",children:"Retired"})]})]})]})}),r.jsx(ie,{children:j?r.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(v!=null&&v.data)||v.data.length===0?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No fleet assets registered"}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Registration"}),r.jsx(le,{children:"Type"}),r.jsx(le,{children:"Make/Model"}),r.jsx(le,{children:"Odometer"}),r.jsx(le,{children:"Operator"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:v.data.map(Me=>{var Xe;return r.jsxs(lt,{children:[r.jsx(ne,{className:"font-mono font-medium",children:Me.registration}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:Me.type})}),r.jsxs(ne,{children:[Me.make," ",Me.model]}),r.jsx(ne,{children:Me.odometer?`${Me.odometer.toLocaleString()} km`:""}),r.jsx(ne,{children:((Xe=Me.operator)==null?void 0:Xe.name)||"Unassigned"}),r.jsx(ne,{children:r.jsx(We,{className:rhe[Me.status],children:Me.status})}),r.jsx(ne,{children:r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{size:"sm",variant:"outline",onClick:()=>{a(Me),s(!0)},children:r.jsx(Fm,{className:"h-4 w-4"})}),r.jsx(se,{size:"sm",variant:"outline",onClick:()=>{a(Me),c(!0)},children:r.jsx(YL,{className:"h-4 w-4"})})]})})]},Me.id)})})]})})]}),r.jsx(Rr,{open:n,onOpenChange:s,children:r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsxs(Or,{children:["Log Service: ",u==null?void 0:u.registration]})}),r.jsxs("form",{onSubmit:p.handleSubmit(O),className:"space-y-4",children:[r.jsx(bW,{control:p.control,name:"service_type",label:"Service Type",required:!0,options:[{value:"routine",label:"Routine Maintenance"},{value:"repair",label:"Repair"},{value:"inspection",label:"Inspection"},{value:"other",label:"Other"}],error:(K=p.formState.errors.service_type)==null?void 0:K.message}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx(Ps,{control:p.control,name:"cost",label:"Cost",type:"number",step:"0.01",required:!0,error:(te=p.formState.errors.cost)==null?void 0:te.message}),r.jsx(Ps,{control:p.control,name:"odometer_reading",label:"Odometer (km)",type:"number",step:"1",error:(X=p.formState.errors.odometer_reading)==null?void 0:X.message})]}),r.jsx(R0,{control:p.control,name:"notes",label:"Notes",rows:3,error:(ve=p.formState.errors.notes)==null?void 0:ve.message}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:N.isPending||!p.formState.isValid,children:"Log Service"})]})]})]})}),r.jsx(Rr,{open:i,onOpenChange:c,children:r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsxs(Or,{children:["Log Fuel: ",u==null?void 0:u.registration]})}),r.jsxs("form",{onSubmit:y.handleSubmit(T),className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx(Ps,{control:y.control,name:"liters",label:"Liters",type:"number",step:"0.01",required:!0,error:(ae=y.formState.errors.liters)==null?void 0:ae.message}),r.jsx(Ps,{control:y.control,name:"cost",label:"Cost",type:"number",step:"0.01",required:!0,error:(pe=y.formState.errors.cost)==null?void 0:pe.message})]}),r.jsx(Ps,{control:y.control,name:"odometer_reading",label:"Odometer (km)",type:"number",step:"1",required:!0,error:(Oe=y.formState.errors.odometer_reading)==null?void 0:Oe.message}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>c(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:D.isPending||!y.formState.isValid,children:"Log Fuel"})]})]})]})})]})}function ahe(e,t=[]){let n=[];function s(c,u){const a=R.createContext(u),m=n.length;n=[...n,u];function p(v){const{scope:j,children:S,...k}=v,N=(j==null?void 0:j[e][m])||a,D=R.useMemo(()=>k,Object.values(k));return r.jsx(N.Provider,{value:D,children:S})}function y(v,j){const S=(j==null?void 0:j[e][m])||a,k=R.useContext(S);if(k)return k;if(u!==void 0)return u;throw new Error(`\`${v}\` must be used within \`${c}\``)}return p.displayName=c+"Provider",[p,y]}const i=()=>{const c=n.map(u=>R.createContext(u));return function(a){const m=(a==null?void 0:a[e])||c;return R.useMemo(()=>({[`__scope${e}`]:{...a,[e]:m}}),[a,m])}};return i.scopeName=e,[s,ohe(i,...t)]}function ohe(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const s=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(c){const u=s.reduce((a,{useScope:m,scopeName:p})=>{const v=m(c)[`__scope${p}`];return{...a,...v}},{});return R.useMemo(()=>({[`__scope${t.scopeName}`]:u}),[u])}};return n.scopeName=t.scopeName,n}var bI="Progress",jI=100,[lhe]=ahe(bI),[che,uhe]=lhe(bI),jW=R.forwardRef((e,t)=>{const{__scopeProgress:n,value:s=null,max:i,getValueLabel:c=dhe,...u}=e;(i||i===0)&&!jF(i)&&console.error(hhe(`${i}`,"Progress"));const a=jF(i)?i:jI;s!==null&&!wF(s,a)&&console.error(fhe(`${s}`,"Progress"));const m=wF(s,a)?s:null,p=TS(m)?c(m,a):void 0;return r.jsx(che,{scope:n,value:m,max:a,children:r.jsx(zr.div,{"aria-valuemax":a,"aria-valuemin":0,"aria-valuenow":TS(m)?m:void 0,"aria-valuetext":p,role:"progressbar","data-state":NW(m,a),"data-value":m??void 0,"data-max":a,...u,ref:t})})});jW.displayName=bI;var wW="ProgressIndicator",SW=R.forwardRef((e,t)=>{const{__scopeProgress:n,...s}=e,i=uhe(wW,n);return r.jsx(zr.div,{"data-state":NW(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...s,ref:t})});SW.displayName=wW;function dhe(e,t){return`${Math.round(e/t*100)}%`}function NW(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function TS(e){return typeof e=="number"}function jF(e){return TS(e)&&!isNaN(e)&&e>0}function wF(e,t){return TS(e)&&!isNaN(e)&&e<=t&&e>=0}function hhe(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${jI}\`.`}function fhe(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${jI} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var PW=jW,mhe=SW;const Ju=R.forwardRef(({className:e,value:t,...n},s)=>r.jsx(PW,{ref:s,className:wr("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",e),...n,children:r.jsx(mhe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Ju.displayName=PW.displayName;const phe={draft:"bg-gray-100 text-gray-800",active:"bg-green-100 text-green-800",completed:"bg-blue-100 text-blue-800",terminated:"bg-red-100 text-red-800"},ghe=uf({contract_num:mo().min(1,"Contract number is required"),vendor_name:mo().min(1,"Vendor name is required"),type:Hde(["maintenance","construction","supply","consulting"]),value:xa().positive("Contract value must be positive"),start_date:mo().min(1,"Start date is required"),end_date:mo().min(1,"End date is required"),description:mo().optional()}),xhe=uf({description:mo().min(1,"Description is required"),penalty_amount:xa().positive("Penalty amount must be positive")});function yhe(){var V,K,te,X,ve,ae,pe,Oe,Me,Xe,Ve,et;const[e,t]=R.useState({page:1,per_page:15,status:"active"}),[n,s]=R.useState(!1),[i,c]=R.useState(!1),[u,a]=R.useState(null),m=br(),p=ia({resolver:Jh(ghe),defaultValues:{contract_num:"",vendor_name:"",type:"maintenance",value:0,start_date:"",end_date:"",description:""}}),y=ia({resolver:Jh(xhe),defaultValues:{description:"",penalty_amount:0}});R.useEffect(()=>{n||p.reset()},[n,p]),R.useEffect(()=>{i||(y.reset(),a(null))},[i,y]);const{data:v,isLoading:j,error:S}=ht({queryKey:["service-contracts",e],queryFn:()=>w_.getContracts(e)}),{data:k}=ht({queryKey:["vendor-scores"],queryFn:()=>w_.getVendorScore({})}),{data:N}=ht({queryKey:["expiring-contracts"],queryFn:()=>w_.getExpiringContracts({days:90})}),D=jt({mutationFn:w_.createContract,onSuccess:()=>{m.invalidateQueries({queryKey:["service-contracts"]}),s(!1),qe.success("Contract created successfully")},onError:()=>qe.error("Failed to create contract")}),O=jt({mutationFn:({contractId:Ce,data:_e})=>w_.recordViolation(Ce,_e),onSuccess:()=>{m.invalidateQueries({queryKey:["service-contracts"]}),c(!1),qe.success("SLA violation recorded")},onError:()=>qe.error("Failed to record violation")}),T=Ce=>{D.mutate({...Ce,status:"active"})},I=Ce=>{if(!u){qe.error("No contract selected");return}O.mutate({contractId:u.id,data:{description:Ce.description,penalty_amount:Ce.penalty_amount,occurred_at:new Date().toISOString()}})},z=((V=v==null?void 0:v.data)==null?void 0:V.filter(Ce=>Ce.status==="active").length)||0,$=((K=v==null?void 0:v.data)==null?void 0:K.reduce((Ce,_e)=>Ce+(_e.value||0),0))||0;return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Contractor & SLA Management"}),r.jsx("p",{className:"text-muted-foreground",children:"Service contracts and vendor performance tracking"})]}),r.jsxs(Rr,{open:n,onOpenChange:s,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"New Contract"]})}),r.jsxs(Er,{className:"max-w-2xl",children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Create Service Contract"})}),r.jsxs("form",{onSubmit:p.handleSubmit(T),className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx(Ps,{control:p.control,name:"contract_num",label:"Contract Number",required:!0,error:(te=p.formState.errors.contract_num)==null?void 0:te.message}),r.jsx(Ps,{control:p.control,name:"vendor_name",label:"Vendor Name",required:!0,error:(X=p.formState.errors.vendor_name)==null?void 0:X.message})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx(bW,{control:p.control,name:"type",label:"Contract Type",required:!0,options:[{value:"maintenance",label:"Maintenance"},{value:"construction",label:"Construction"},{value:"supply",label:"Supply"},{value:"consulting",label:"Consulting"}],error:(ve=p.formState.errors.type)==null?void 0:ve.message}),r.jsx(Ps,{control:p.control,name:"value",label:"Contract Value",type:"number",step:"0.01",required:!0,error:(ae=p.formState.errors.value)==null?void 0:ae.message})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx(Ps,{control:p.control,name:"start_date",label:"Start Date",type:"date",required:!0,error:(pe=p.formState.errors.start_date)==null?void 0:pe.message}),r.jsx(Ps,{control:p.control,name:"end_date",label:"End Date",type:"date",required:!0,error:(Oe=p.formState.errors.end_date)==null?void 0:Oe.message})]}),r.jsx(R0,{control:p.control,name:"description",label:"Description",rows:3,error:(Me=p.formState.errors.description)==null?void 0:Me.message}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:D.isPending||!p.formState.isValid,children:"Create"})]})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsx(ge,{className:"pb-2",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(is,{className:"h-4 w-4"}),"Active Contracts"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:z}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Total contracts"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-2",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx($s,{className:"h-4 w-4"}),"Contract Value"]})}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:["$",$.toLocaleString()]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Total active value"})]})]}),r.jsxs(J,{className:"border-orange-200 bg-orange-50",children:[r.jsx(ge,{className:"pb-2",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(xs,{className:"h-4 w-4 text-orange-600"}),"Expiring Soon"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold text-orange-600",children:(N==null?void 0:N.length)||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Next 90 days"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-2",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(ei,{className:"h-4 w-4"}),"SLA Violations"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:((Xe=v==null?void 0:v.data)==null?void 0:Xe.reduce((Ce,_e)=>{var tt;return Ce+(((tt=_e.violations)==null?void 0:tt.length)||0)},0))||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"This period"})]})]})]}),r.jsxs(qs,{defaultValue:"contracts",className:"space-y-4",children:[r.jsxs(As,{children:[r.jsx(sr,{value:"contracts",children:"Contracts"}),r.jsx(sr,{value:"vendors",children:"Vendor Scorecards"}),r.jsx(sr,{value:"expiring",children:"Expiring"})]}),r.jsx(Nr,{value:"contracts",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(xe,{children:"Service Contracts"}),r.jsxs(Jt,{value:e.status||"all",onValueChange:Ce=>{const{status:_e,...tt}=e;t(Ce==="all"?{...tt,page:1}:{...tt,status:Ce,page:1})},children:[r.jsx(Yt,{className:"w-[200px]",children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Statuses"}),r.jsx(ke,{value:"active",children:"Active"}),r.jsx(ke,{value:"completed",children:"Completed"}),r.jsx(ke,{value:"terminated",children:"Terminated"})]})]})]})}),r.jsx(ie,{children:j?r.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(v!=null&&v.data)||v.data.length===0?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No contracts found"}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Contract #"}),r.jsx(le,{children:"Vendor"}),r.jsx(le,{children:"Type"}),r.jsx(le,{children:"Value"}),r.jsx(le,{children:"Period"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:v.data.map(Ce=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-mono",children:Ce.contract_num}),r.jsx(ne,{className:"font-medium",children:Ce.vendor_name}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:Ce.type})}),r.jsxs(ne,{children:["$",Ce.value.toLocaleString()]}),r.jsxs(ne,{className:"text-sm",children:[new Date(Ce.start_date).toLocaleDateString()," -",r.jsx("br",{}),new Date(Ce.end_date).toLocaleDateString()]}),r.jsx(ne,{children:r.jsx(We,{className:phe[Ce.status],children:Ce.status})}),r.jsx(ne,{children:r.jsx(se,{size:"sm",variant:"outline",onClick:()=>{a(Ce),c(!0)},children:"Log Violation"})})]},Ce.id))})]})})]})}),r.jsx(Nr,{value:"vendors",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Vendor Performance Scorecards"})}),r.jsx(ie,{children:k&&k.length>0?r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Vendor"}),r.jsx(le,{children:"Quality"}),r.jsx(le,{children:"Timeliness"}),r.jsx(le,{children:"Compliance"}),r.jsx(le,{children:"Overall Score"})]})}),r.jsx(ur,{children:k.map(Ce=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:Ce.vendor_name}),r.jsx(ne,{children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ju,{value:Ce.quality_score,className:"w-24"}),r.jsxs("span",{className:"text-sm",children:[Ce.quality_score,"%"]})]})}),r.jsx(ne,{children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ju,{value:Ce.timeliness_score,className:"w-24"}),r.jsxs("span",{className:"text-sm",children:[Ce.timeliness_score,"%"]})]})}),r.jsx(ne,{children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ju,{value:Ce.compliance_score,className:"w-24"}),r.jsxs("span",{className:"text-sm",children:[Ce.compliance_score,"%"]})]})}),r.jsx(ne,{children:r.jsxs(We,{variant:Ce.overall_score>=80?"default":"secondary",children:[Ce.overall_score,"%"]})})]},Ce.id))})]}):r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No vendor scorecards available"})})]})}),r.jsx(Nr,{value:"expiring",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Contracts Expiring Soon"})}),r.jsx(ie,{children:N&&N.length>0?r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Contract #"}),r.jsx(le,{children:"Vendor"}),r.jsx(le,{children:"End Date"}),r.jsx(le,{children:"Days Left"}),r.jsx(le,{children:"Value"})]})}),r.jsx(ur,{children:N.map(Ce=>{const _e=Math.ceil((new Date(Ce.end_date).getTime()-Date.now())/864e5);return r.jsxs(lt,{children:[r.jsx(ne,{className:"font-mono",children:Ce.contract_num}),r.jsx(ne,{className:"font-medium",children:Ce.vendor_name}),r.jsx(ne,{children:new Date(Ce.end_date).toLocaleDateString()}),r.jsx(ne,{children:r.jsxs(We,{variant:_e<=30?"destructive":"secondary",children:[_e," days"]})}),r.jsxs(ne,{children:["$",Ce.value.toLocaleString()]})]},Ce.id)})})]}):r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No contracts expiring soon"})})]})})]}),r.jsx(Rr,{open:i,onOpenChange:c,children:r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Record SLA Violation"})}),r.jsxs("form",{onSubmit:y.handleSubmit(I),className:"space-y-4",children:[r.jsxs("div",{className:"bg-muted p-3 rounded-md text-sm",children:[r.jsx("strong",{children:"Contract:"})," ",u==null?void 0:u.contract_num," - ",u==null?void 0:u.vendor_name]}),r.jsx(R0,{control:y.control,name:"description",label:"Violation Description",placeholder:"Describe the SLA breach...",rows:3,required:!0,error:(Ve=y.formState.errors.description)==null?void 0:Ve.message}),r.jsx(Ps,{control:y.control,name:"penalty_amount",label:"Penalty Amount",type:"number",step:"0.01",required:!0,error:(et=y.formState.errors.penalty_amount)==null?void 0:et.message}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>c(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:O.isPending||!y.formState.isValid,children:"Record Violation"})]})]})]})})]})}const vhe={pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",closed:"bg-gray-100 text-gray-800"},_he={minor:"bg-blue-100 text-blue-800",moderate:"bg-yellow-100 text-yellow-800",serious:"bg-orange-100 text-orange-800",fatal:"bg-red-100 text-red-800"};function bhe(){var Ve,et,Ce;const[e,t]=R.useState({page:1,per_page:15,status:"all"}),[n,s]=R.useState({page:1,per_page:15,status:"open"}),[i,c]=R.useState({page:1,per_page:15,status:"open"}),[u,a]=R.useState(!1),[m,p]=R.useState(!1),[y,v]=R.useState(!1),j=br(),{data:S,isLoading:k,error:N}=ht({queryKey:["hse-permits",e],queryFn:()=>Qf.getPermits(e)}),{data:D,isLoading:O,error:T}=ht({queryKey:["hse-incidents",n],queryFn:()=>Qf.getIncidents(n)}),{data:I,isLoading:z,error:$}=ht({queryKey:["hse-capas",i],queryFn:()=>Qf.getCapas(i)}),{data:V}=ht({queryKey:["incident-stats"],queryFn:()=>Qf.getIncidentStats({})}),K=jt({mutationFn:Qf.createPermit,onSuccess:()=>{j.invalidateQueries({queryKey:["hse-permits"]}),a(!1),qe.success("Permit request created successfully")},onError:()=>qe.error("Failed to create permit")}),te=jt({mutationFn:Qf.createIncident,onSuccess:()=>{j.invalidateQueries({queryKey:["hse-incidents"]}),j.invalidateQueries({queryKey:["incident-stats"]}),p(!1),qe.success("Incident reported successfully")},onError:()=>qe.error("Failed to report incident")}),X=jt({mutationFn:Qf.createCapa,onSuccess:()=>{j.invalidateQueries({queryKey:["hse-capas"]}),v(!1),qe.success("CAPA created successfully")},onError:()=>qe.error("Failed to create CAPA")}),ve=_e=>{_e.preventDefault();const tt=new FormData(_e.currentTarget),vt={permit_type:tt.get("permit_type"),description:tt.get("description"),location:tt.get("location"),valid_from:tt.get("valid_from"),valid_until:tt.get("valid_until"),status:"pending"};K.mutate(vt)},ae=_e=>{_e.preventDefault();const tt=new FormData(_e.currentTarget),vt={category:tt.get("category"),severity:tt.get("severity"),description:tt.get("description"),location:tt.get("location"),occurred_at:tt.get("occurred_at"),status:"open"};te.mutate(vt)},pe=_e=>{_e.preventDefault();const tt=new FormData(_e.currentTarget),vt=tt.get("assigned_to");if(!vt){qe.error("Please enter a user ID"),_e.currentTarget.reset();return}const gt={type:tt.get("type"),description:tt.get("description"),due_date:tt.get("due_date"),assigned_to:vt,status:"open"};X.mutate(gt)},Oe=((Ve=S==null?void 0:S.data)==null?void 0:Ve.filter(_e=>_e.status==="pending").length)||0,Me=((et=D==null?void 0:D.data)==null?void 0:et.filter(_e=>_e.status==="open").length)||0,Xe=((Ce=I==null?void 0:I.data)==null?void 0:Ce.filter(_e=>_e.status==="open").length)||0;return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"HSE Safety Management"}),r.jsx("p",{className:"text-muted-foreground",children:"Health, Safety, and Environment compliance"})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs(J,{className:"border-yellow-200 bg-yellow-50",children:[r.jsx(ge,{className:"pb-2",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(Ure,{className:"h-4 w-4 text-yellow-600"}),"Pending Permits"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:Oe}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting approval"})]})]}),r.jsxs(J,{className:"border-red-200 bg-red-50",children:[r.jsx(ge,{className:"pb-2",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(gn,{className:"h-4 w-4 text-red-600"}),"Open Incidents"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:Me}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Under investigation"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-2",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(Fre,{className:"h-4 w-4"}),"Open CAPAs"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:Xe}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Actions pending"})]})]}),r.jsxs(J,{className:"border-green-200 bg-green-50",children:[r.jsx(ge,{className:"pb-2",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(yl,{className:"h-4 w-4 text-green-600"}),"Days Since LTI"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:(V==null?void 0:V.days_since_lti)||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Lost-time injury free"})]})]})]}),r.jsxs(qs,{defaultValue:"permits",className:"space-y-4",children:[r.jsxs(As,{children:[r.jsx(sr,{value:"permits",children:"Work Permits"}),r.jsx(sr,{value:"incidents",children:"Incidents"}),r.jsx(sr,{value:"capas",children:"CAPAs"})]}),r.jsx(Nr,{value:"permits",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(xe,{children:"Work Permits"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(Jt,{value:e.status,onValueChange:_e=>t({...e,status:_e,page:1}),children:[r.jsx(Yt,{className:"w-[200px]",children:r.jsx(er,{placeholder:"All Statuses"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Statuses"}),r.jsx(ke,{value:"pending",children:"Pending"}),r.jsx(ke,{value:"approved",children:"Approved"}),r.jsx(ke,{value:"rejected",children:"Rejected"}),r.jsx(ke,{value:"closed",children:"Closed"})]})]}),r.jsxs(Rr,{open:u,onOpenChange:a,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Request Permit"]})}),r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Request Work Permit"})}),r.jsxs("form",{onSubmit:ve,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"permit_type",children:"Permit Type"}),r.jsxs(Jt,{name:"permit_type",required:!0,children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"hot_work",children:"Hot Work"}),r.jsx(ke,{value:"confined_space",children:"Confined Space"}),r.jsx(ke,{value:"working_at_height",children:"Working at Height"}),r.jsx(ke,{value:"loto",children:"LOTO"}),r.jsx(ke,{value:"excavation",children:"Excavation"})]})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"location",children:"Location"}),r.jsx(Ge,{id:"location",name:"location",required:!0})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"valid_from",children:"Valid From"}),r.jsx(Ge,{id:"valid_from",name:"valid_from",type:"datetime-local",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"valid_until",children:"Valid Until"}),r.jsx(Ge,{id:"valid_until",name:"valid_until",type:"datetime-local",required:!0})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"description",children:"Description"}),r.jsx(Fs,{id:"description",name:"description",rows:3,required:!0})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:K.isPending,children:"Submit Request"})]})]})]})]})]})]})}),r.jsx(ie,{children:k?r.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(S!=null&&S.data)||S.data.length===0?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No work permits"}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Permit Type"}),r.jsx(le,{children:"Description"}),r.jsx(le,{children:"Valid Period"}),r.jsx(le,{children:"Requested By"}),r.jsx(le,{children:"Status"})]})}),r.jsx(ur,{children:S.data.map(_e=>{var tt;return r.jsxs(lt,{children:[r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:_e.permit_type})}),r.jsx(ne,{className:"max-w-md truncate",children:_e.description}),r.jsxs(ne,{className:"text-sm",children:[new Date(_e.valid_from).toLocaleDateString()," -",r.jsx("br",{}),new Date(_e.valid_until).toLocaleDateString()]}),r.jsx(ne,{children:((tt=_e.requested_by_user)==null?void 0:tt.name)||"Unknown"}),r.jsx(ne,{children:r.jsx(We,{className:vhe[_e.status],children:_e.status})})]},_e.id)})})]})})]})}),r.jsx(Nr,{value:"incidents",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(xe,{children:"Safety Incidents"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(Jt,{value:n.status,onValueChange:_e=>s({...n,status:_e,page:1}),children:[r.jsx(Yt,{className:"w-[200px]",children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Statuses"}),r.jsx(ke,{value:"open",children:"Open"}),r.jsx(ke,{value:"investigated",children:"Investigated"}),r.jsx(ke,{value:"closed",children:"Closed"})]})]}),r.jsxs(Rr,{open:m,onOpenChange:p,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Report Incident"]})}),r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Report Safety Incident"})}),r.jsxs("form",{onSubmit:ae,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"category",children:"Category"}),r.jsxs(Jt,{name:"category",required:!0,children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"injury",children:"Injury"}),r.jsx(ke,{value:"property_damage",children:"Property Damage"}),r.jsx(ke,{value:"environmental",children:"Environmental"}),r.jsx(ke,{value:"near_miss",children:"Near Miss"}),r.jsx(ke,{value:"other",children:"Other"})]})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"severity",children:"Severity"}),r.jsxs(Jt,{name:"severity",required:!0,children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"minor",children:"Minor"}),r.jsx(ke,{value:"moderate",children:"Moderate"}),r.jsx(ke,{value:"serious",children:"Serious"}),r.jsx(ke,{value:"fatal",children:"Fatal"})]})]})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"location",children:"Location"}),r.jsx(Ge,{id:"location",name:"location",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"occurred_at",children:"Occurred At"}),r.jsx(Ge,{id:"occurred_at",name:"occurred_at",type:"datetime-local",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"description",children:"Description"}),r.jsx(Fs,{id:"description",name:"description",rows:4,required:!0})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>p(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:te.isPending,children:"Report Incident"})]})]})]})]})]})]})}),r.jsx(ie,{children:O?r.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(D!=null&&D.data)||D.data.length===0?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No incidents reported"}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Occurred At"}),r.jsx(le,{children:"Category"}),r.jsx(le,{children:"Severity"}),r.jsx(le,{children:"Location"}),r.jsx(le,{children:"Reported By"}),r.jsx(le,{children:"Status"})]})}),r.jsx(ur,{children:D.data.map(_e=>{var tt;return r.jsxs(lt,{children:[r.jsx(ne,{children:new Date(_e.occurred_at).toLocaleString()}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:_e.category})}),r.jsx(ne,{children:r.jsx(We,{className:_he[_e.severity],children:_e.severity})}),r.jsx(ne,{children:_e.location}),r.jsx(ne,{children:((tt=_e.reported_by_user)==null?void 0:tt.name)||"Unknown"}),r.jsx(ne,{children:r.jsx(We,{variant:_e.status==="closed"?"default":"secondary",children:_e.status})})]},_e.id)})})]})})]})}),r.jsx(Nr,{value:"capas",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(xe,{children:"Corrective & Preventive Actions"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(Jt,{value:i.status,onValueChange:_e=>c({...i,status:_e,page:1}),children:[r.jsx(Yt,{className:"w-[200px]",children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Statuses"}),r.jsx(ke,{value:"open",children:"Open"}),r.jsx(ke,{value:"completed",children:"Completed"})]})]}),r.jsxs(Rr,{open:y,onOpenChange:v,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Create CAPA"]})}),r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Create CAPA"})}),r.jsxs("form",{onSubmit:pe,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"type",children:"Type"}),r.jsxs(Jt,{name:"type",required:!0,children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"corrective",children:"Corrective Action"}),r.jsx(ke,{value:"preventive",children:"Preventive Action"})]})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"description",children:"Description"}),r.jsx(Fs,{id:"description",name:"description",rows:4,required:!0})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"assigned_to",children:"Assign To (User ID)"}),r.jsx(Ge,{id:"assigned_to",name:"assigned_to",type:"number",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"due_date",children:"Due Date"}),r.jsx(Ge,{id:"due_date",name:"due_date",type:"date",required:!0})]})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>v(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:X.isPending,children:"Create CAPA"})]})]})]})]})]})]})}),r.jsx(ie,{children:z?r.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(I!=null&&I.data)||I.data.length===0?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No CAPAs created"}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Type"}),r.jsx(le,{children:"Description"}),r.jsx(le,{children:"Assigned To"}),r.jsx(le,{children:"Due Date"}),r.jsx(le,{children:"Status"})]})}),r.jsx(ur,{children:I.data.map(_e=>{var vt;const tt=_e.status==="open"&&new Date(_e.due_date)<new Date;return r.jsxs(lt,{children:[r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:_e.type})}),r.jsx(ne,{className:"max-w-md truncate",children:_e.description}),r.jsx(ne,{children:((vt=_e.assigned_to_user)==null?void 0:vt.name)||"Unassigned"}),r.jsx(ne,{children:r.jsxs("span",{className:tt?"text-red-600 font-semibold":"",children:[new Date(_e.due_date).toLocaleDateString(),tt&&" (Overdue)"]})}),r.jsx(ne,{children:r.jsx(We,{variant:_e.status==="completed"?"default":"secondary",children:_e.status})})]},_e.id)})})]})})]})})]})]})}function jhe(){return r.jsxs("div",{className:"flex min-h-screen",children:[r.jsx(za,{}),r.jsx("main",{className:"flex-1 p-8 overflow-auto",children:r.jsx(Fa,{})})]})}function whe({open:e,onOpenChange:t,parameter:n}){const s=br(),i=!!n,{register:c,handleSubmit:u,reset:a,setValue:m,formState:{errors:p}}=ia({defaultValues:n||{category:"physical"}}),y=jt({mutationFn:S=>me.post("/v1/water-quality/parameters",S),onSuccess:()=>{s.invalidateQueries({queryKey:["water-quality-parameters"]}),qe.success("Parameter created successfully"),t(!1),a()},onError:S=>{qe.error(S.message||"Failed to create parameter")}}),v=jt({mutationFn:S=>me.patch(`/v1/water-quality/parameters/${n.id}`,S),onSuccess:()=>{s.invalidateQueries({queryKey:["water-quality-parameters"]}),qe.success("Parameter updated successfully"),t(!1)},onError:S=>{qe.error(S.message||"Failed to update parameter")}}),j=S=>{const k={...S,who_limit:S.who_limit||void 0,wasreb_limit:S.wasreb_limit||void 0,local_limit:S.local_limit||void 0,lod:S.lod||void 0,precision:S.precision||void 0};i?v.mutate(k):y.mutate(k)};return R.useEffect(()=>{a(n||{category:"physical"})},[n,a]),r.jsx(Rr,{open:e,onOpenChange:t,children:r.jsxs(Er,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:i?"Edit Parameter":"Create New Parameter"}),r.jsx(Bs,{children:i?"Update water quality parameter":"Add a new water quality parameter"})]}),r.jsxs("form",{onSubmit:u(j),className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"name",children:"Parameter Name *"}),r.jsx(Ge,{id:"name",...c("name",{required:!0}),placeholder:"e.g., pH"}),p.name&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"code",children:"Code *"}),r.jsx(Ge,{id:"code",...c("code",{required:!0}),placeholder:"e.g., PH"}),p.code&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"category",children:"Category *"}),r.jsxs(Jt,{onValueChange:S=>m("category",S),defaultValue:(n==null?void 0:n.category)||"physical",children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select category"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"physical",children:"Physical"}),r.jsx(ke,{value:"chemical",children:"Chemical"}),r.jsx(ke,{value:"biological",children:"Biological"}),r.jsx(ke,{value:"radiological",children:"Radiological"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"unit",children:"Unit *"}),r.jsx(Ge,{id:"unit",...c("unit",{required:!0}),placeholder:"e.g., mg/L, CFU/100mL, pH units"}),p.unit&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"who_limit",children:"WHO Limit"}),r.jsx(Ge,{id:"who_limit",type:"number",step:"any",...c("who_limit"),placeholder:"Optional"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"wasreb_limit",children:"WASREB Limit"}),r.jsx(Ge,{id:"wasreb_limit",type:"number",step:"any",...c("wasreb_limit"),placeholder:"Optional"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"local_limit",children:"Local Limit"}),r.jsx(Ge,{id:"local_limit",type:"number",step:"any",...c("local_limit"),placeholder:"Optional"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"lod",children:"Limit of Detection (LOD)"}),r.jsx(Ge,{id:"lod",type:"number",step:"any",...c("lod"),placeholder:"Optional"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"precision",children:"Precision"}),r.jsx(Ge,{id:"precision",type:"number",step:"1",...c("precision"),placeholder:"Decimal places (e.g., 2)"})]})]}),r.jsxs(Ai,{children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:y.isPending||v.isPending,children:y.isPending||v.isPending?"Saving...":i?"Update":"Create"})]})]})]})})}function She(){var S;const[e,t]=R.useState(1),[n,s]=R.useState(!1),[i,c]=R.useState(void 0),u=br(),{data:a,isLoading:m}=ht({queryKey:["water-quality-parameters",e],queryFn:async()=>me.get("/v1/water-quality/parameters",{page:e,per_page:20})}),p=jt({mutationFn:k=>me.delete(`/v1/water-quality/parameters/${k}`),onSuccess:()=>{u.invalidateQueries({queryKey:["water-quality-parameters"]}),qe.success("Parameter deleted successfully")},onError:k=>{qe.error(k.message||"Failed to delete parameter")}}),y=k=>{c(k),s(!0)},v=k=>{confirm("Are you sure you want to delete this parameter?")&&p.mutate(k)},j=()=>{c(void 0),s(!0)};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Water Quality Parameters"}),r.jsx("p",{className:"text-muted-foreground",children:"Manage physical, chemical, and biological parameters for water quality testing"})]}),r.jsxs(se,{onClick:j,children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"Add Parameter"]})]}),r.jsx(whe,{open:n,onOpenChange:s,parameter:i}),m?r.jsx("div",{className:"text-center py-12",children:"Loading parameters..."}):r.jsx("div",{className:"grid gap-4",children:(S=a==null?void 0:a.data)==null?void 0:S.map(k=>r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx(xe,{className:"text-xl",children:k.name}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(We,{variant:"outline",children:k.category||"physical"}),r.jsx(We,{variant:"secondary",children:k.unit})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:"ghost",size:"sm",onClick:()=>y(k),children:r.jsx(DO,{className:"h-4 w-4"})}),r.jsx(se,{variant:"ghost",size:"sm",onClick:()=>v(k.id),children:r.jsx(Oi,{className:"h-4 w-4"})})]})]})}),r.jsx(ie,{children:r.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"WHO Limit:"}),r.jsx("p",{className:"font-medium",children:k.who_limit?`${k.who_limit} ${k.unit}`:"N/A"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"WASREB Limit:"}),r.jsx("p",{className:"font-medium",children:k.wasreb_limit?`${k.wasreb_limit} ${k.unit}`:"N/A"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Local Limit:"}),r.jsx("p",{className:"font-medium",children:k.local_limit?`${k.local_limit} ${k.unit}`:"N/A"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"LOD:"}),r.jsx("p",{className:"font-medium",children:k.lod?`${k.lod} ${k.unit}`:"N/A"})]})]})})]},k.id))}),(a==null?void 0:a.meta)&&r.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",a.meta.from," to ",a.meta.to," of ",a.meta.total," parameters"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:"outline",size:"sm",disabled:e===1,onClick:()=>t(k=>k-1),children:"Previous"}),r.jsx(se,{variant:"outline",size:"sm",disabled:e>=a.meta.last_page,onClick:()=>t(k=>k+1),children:"Next"})]})]})]})}var wI="Checkbox",[Nhe]=bd(wI),[Phe,Che]=Nhe(wI),CW=R.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:s,checked:i,defaultChecked:c,required:u,disabled:a,value:m="on",onCheckedChange:p,form:y,...v}=e,[j,S]=R.useState(null),k=yn(t,z=>S(z)),N=R.useRef(!1),D=j?y||!!j.closest("form"):!0,[O=!1,T]=ud({prop:i,defaultProp:c,onChange:p}),I=R.useRef(O);return R.useEffect(()=>{const z=j==null?void 0:j.form;if(z){const $=()=>T(I.current);return z.addEventListener("reset",$),()=>z.removeEventListener("reset",$)}},[j,T]),r.jsxs(Phe,{scope:n,state:O,disabled:a,children:[r.jsx(zr.button,{type:"button",role:"checkbox","aria-checked":qh(O)?"mixed":O,"aria-required":u,"data-state":TW(O),"data-disabled":a?"":void 0,disabled:a,value:m,...v,ref:k,onKeyDown:nr(e.onKeyDown,z=>{z.key==="Enter"&&z.preventDefault()}),onClick:nr(e.onClick,z=>{T($=>qh($)?!0:!$),D&&(N.current=z.isPropagationStopped(),N.current||z.stopPropagation())})}),D&&r.jsx(Ahe,{control:j,bubbles:!N.current,name:s,value:m,checked:O,required:u,disabled:a,form:y,style:{transform:"translateX(-100%)"},defaultChecked:qh(c)?!1:c})]})});CW.displayName=wI;var AW="CheckboxIndicator",kW=R.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:s,...i}=e,c=Che(AW,n);return r.jsx(So,{present:s||qh(c.state)||c.state===!0,children:r.jsx(zr.span,{"data-state":TW(c.state),"data-disabled":c.disabled?"":void 0,...i,ref:t,style:{pointerEvents:"none",...e.style}})})});kW.displayName=AW;var Ahe=e=>{const{control:t,checked:n,bubbles:s=!0,defaultChecked:i,...c}=e,u=R.useRef(null),a=h2(n),m=c2(t);R.useEffect(()=>{const y=u.current,v=window.HTMLInputElement.prototype,S=Object.getOwnPropertyDescriptor(v,"checked").set;if(a!==n&&S){const k=new Event("click",{bubbles:s});y.indeterminate=qh(n),S.call(y,qh(n)?!1:n),y.dispatchEvent(k)}},[a,n,s]);const p=R.useRef(qh(n)?!1:n);return r.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i??p.current,...c,tabIndex:-1,ref:u,style:{...e.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function qh(e){return e==="indeterminate"}function TW(e){return qh(e)?"indeterminate":e?"checked":"unchecked"}var EW=CW,khe=kW;const Ey=R.forwardRef(({className:e,...t},n)=>r.jsx(EW,{ref:n,className:wr("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:r.jsx(khe,{className:wr("flex items-center justify-center text-current"),children:r.jsx(Nx,{className:"h-4 w-4"})})}));Ey.displayName=EW.displayName;function The({open:e,onOpenChange:t,point:n}){var N,D,O,T,I,z;const s=br(),i=!!n,{register:c,handleSubmit:u,reset:a,setValue:m,watch:p,formState:{errors:y}}=ia({defaultValues:n?{...n,latitude:(D=(N=n.location)==null?void 0:N.coordinates)==null?void 0:D[1],longitude:(T=(O=n.location)==null?void 0:O.coordinates)==null?void 0:T[0]}:{kind:"source",is_active:!0}}),{data:v}=ht({queryKey:["schemes-for-sampling-point"],queryFn:async()=>me.get("/v1/schemes",{per_page:200})}),j=jt({mutationFn:$=>me.post("/v1/water-quality/sampling-points",$),onSuccess:()=>{s.invalidateQueries({queryKey:["water-quality-sampling-points"]}),qe.success("Sampling point created successfully"),t(!1),a()},onError:$=>{qe.error($.message||"Failed to create sampling point")}}),S=jt({mutationFn:$=>me.patch(`/v1/water-quality/sampling-points/${n.id}`,$),onSuccess:()=>{s.invalidateQueries({queryKey:["water-quality-sampling-points"]}),qe.success("Sampling point updated successfully"),t(!1)},onError:$=>{qe.error($.message||"Failed to update sampling point")}}),k=$=>{const V={name:$.name,code:$.code,kind:$.kind,scheme_id:$.scheme_id||void 0,latitude:parseFloat($.latitude),longitude:parseFloat($.longitude),elevation_m:$.elevation_m?parseFloat($.elevation_m):void 0,is_active:$.is_active};i?S.mutate(V):j.mutate(V)};return R.useEffect(()=>{var $,V,K,te;a(n?{...n,latitude:(V=($=n.location)==null?void 0:$.coordinates)==null?void 0:V[1],longitude:(te=(K=n.location)==null?void 0:K.coordinates)==null?void 0:te[0]}:{kind:"source",is_active:!0})},[n,a]),r.jsx(Rr,{open:e,onOpenChange:t,children:r.jsxs(Er,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:i?"Edit Sampling Point":"Create New Sampling Point"}),r.jsx(Bs,{children:i?"Update sampling point information":"Add a new sampling point with GPS location"})]}),r.jsxs("form",{onSubmit:u(k),className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"name",children:"Point Name *"}),r.jsx(Ge,{id:"name",...c("name",{required:!0}),placeholder:"e.g., Borehole #1"}),y.name&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"code",children:"Code *"}),r.jsx(Ge,{id:"code",...c("code",{required:!0}),placeholder:"e.g., BH-001"}),y.code&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"kind",children:"Point Kind *"}),r.jsxs(Jt,{onValueChange:$=>m("kind",$),defaultValue:(n==null?void 0:n.kind)||"source",children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select kind"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"source",children:"Source"}),r.jsx(ke,{value:"treatment",children:"Treatment"}),r.jsx(ke,{value:"reservoir",children:"Reservoir"}),r.jsx(ke,{value:"distribution",children:"Distribution"}),r.jsx(ke,{value:"kiosk",children:"Kiosk"}),r.jsx(ke,{value:"household",children:"Household"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"scheme_id",children:"Scheme"}),r.jsxs(Jt,{onValueChange:$=>m("scheme_id",$&&$!=="none"?Number($):void 0),defaultValue:((I=n==null?void 0:n.scheme_id)==null?void 0:I.toString())||"none",children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select scheme"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"none",children:"None"}),(z=v==null?void 0:v.data)==null?void 0:z.map($=>r.jsx(ke,{value:$.id.toString(),children:$.name},$.id))]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"latitude",children:"Latitude *"}),r.jsx(Ge,{id:"latitude",type:"number",step:"any",...c("latitude",{required:!0}),placeholder:"e.g., -1.2921"}),y.latitude&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"longitude",children:"Longitude *"}),r.jsx(Ge,{id:"longitude",type:"number",step:"any",...c("longitude",{required:!0}),placeholder:"e.g., 36.8219"}),y.longitude&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"elevation_m",children:"Elevation (m)"}),r.jsx(Ge,{id:"elevation_m",type:"number",step:"any",...c("elevation_m"),placeholder:"Optional"})]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Ey,{id:"is_active",checked:p("is_active"),onCheckedChange:$=>m("is_active",$)}),r.jsx(Ne,{htmlFor:"is_active",className:"cursor-pointer",children:"Active sampling point"})]}),r.jsxs(Ai,{children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:j.isPending||S.isPending,children:j.isPending||S.isPending?"Saving...":i?"Update":"Create"})]})]})]})})}const SF={source:"#3b82f6",treatment:"#8b5cf6",reservoir:"#10b981",distribution:"#eab308",kiosk:"#f97316",household:"#ec4899"};function Ehe({points:e,onPointSelect:t}){const n=R.useRef(null),s=R.useRef(null),i=R.useRef([]),[c,u]=R.useState(null);R.useEffect(()=>{if(!(!n.current||s.current))return s.current=new cc.Map({container:n.current,style:{version:8,sources:{"osm-tiles":{type:"raster",tiles:["https://tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:"&copy; OpenStreetMap contributors"}},layers:[{id:"osm-tiles",type:"raster",source:"osm-tiles",minzoom:0,maxzoom:19}]},center:[36.8219,-1.2921],zoom:8}),s.current.addControl(new cc.NavigationControl,"top-right"),s.current.addControl(new cc.ScaleControl,"bottom-left"),()=>{var m;i.current.forEach(p=>p.remove()),i.current=[],(m=s.current)==null||m.remove(),s.current=null}},[]),R.useEffect(()=>{if(!s.current||!(e!=null&&e.length))return;i.current.forEach(p=>p.remove()),i.current=[];const m=e.filter(p=>{var y;return(y=p.location)==null?void 0:y.coordinates});if(m.length!==0&&(m.forEach(p=>{var j;if(!((j=p.location)!=null&&j.coordinates))return;const y=document.createElement("div");y.className="sampling-point-marker",y.style.width="28px",y.style.height="28px",y.style.borderRadius="50%",y.style.backgroundColor=SF[p.kind]||"#6b7280",y.style.border=p.is_active?"3px solid white":"3px solid #ef4444",y.style.boxShadow="0 2px 6px rgba(0,0,0,0.3)",y.style.cursor="pointer",y.style.opacity=p.is_active?"1":"0.6";const v=new cc.Marker({element:y}).setLngLat(p.location.coordinates).addTo(s.current);i.current.push(v),y.addEventListener("click",()=>{var S;u(p),t==null||t(p),(S=s.current)==null||S.flyTo({center:p.location.coordinates,zoom:14,duration:1e3})})}),m.length>0)){const p=new cc.LngLatBounds;m.forEach(y=>{var v;(v=y.location)!=null&&v.coordinates&&p.extend(y.location.coordinates)}),s.current.fitBounds(p,{padding:50,maxZoom:14})}},[e,t]);const a=()=>{u(null),t==null||t(null)};return r.jsxs("div",{className:"relative h-96 w-full",children:[r.jsx("div",{className:"absolute top-4 left-4 z-10",children:r.jsx(J,{className:"max-w-xs",children:r.jsxs(ie,{className:"p-4",children:[r.jsx("h3",{className:"text-sm font-bold mb-3",children:"Sampling Point Types"}),r.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(SF).map(([m,p])=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:p,border:"2px solid white"}}),r.jsx("span",{className:"text-xs capitalize",children:m})]},m))}),r.jsxs("div",{className:"mt-3 pt-3 border-t",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-400",style:{border:"2px solid white"}}),r.jsx("span",{className:"text-xs",children:"Active"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-400 opacity-60",style:{border:"2px solid #ef4444"}}),r.jsx("span",{className:"text-xs",children:"Inactive"})]})]})]})})}),c&&r.jsx("div",{className:"absolute top-4 right-4 z-10 w-80",children:r.jsx(J,{children:r.jsxs(ie,{className:"p-4",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsxs("div",{className:"space-y-1 flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("h3",{className:"font-bold",children:c.name}),r.jsx(We,{variant:c.is_active?"default":"destructive",className:"text-xs",children:c.is_active?"Active":"Inactive"})]}),r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Code: ",c.code]})]}),r.jsx(se,{variant:"ghost",size:"sm",onClick:a,children:r.jsx(jy,{className:"h-4 w-4"})})]}),r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsx("div",{className:"flex items-center gap-2",children:r.jsx(We,{className:"capitalize",variant:"outline",children:c.kind})}),r.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[r.jsx(jo,{className:"h-4 w-4"}),r.jsxs("span",{children:[c.location.coordinates[1].toFixed(6),", ",c.location.coordinates[0].toFixed(6)]})]}),c.elevation_m&&r.jsxs("div",{className:"text-muted-foreground",children:[r.jsx("span",{className:"font-medium",children:"Elevation:"})," ",c.elevation_m,"m"]}),c.scheme&&r.jsxs("div",{className:"text-muted-foreground",children:[r.jsx("span",{className:"font-medium",children:"Scheme:"})," ",c.scheme.name]})]})]})})}),r.jsx("div",{ref:n,className:"h-full w-full rounded-lg"})]})}function Mhe(){var D;const[e,t]=R.useState(1),[n,s]=R.useState(!1),[i,c]=R.useState(!1),[u,a]=R.useState(void 0),m=br(),{data:p,isLoading:y}=ht({queryKey:["water-quality-sampling-points",e],queryFn:async()=>me.get("/v1/water-quality/sampling-points",{page:e,per_page:20})}),v={source:"bg-blue-100 text-blue-800",treatment:"bg-purple-100 text-purple-800",reservoir:"bg-green-100 text-green-800",distribution:"bg-yellow-100 text-yellow-800",kiosk:"bg-orange-100 text-orange-800",household:"bg-pink-100 text-pink-800"},j=jt({mutationFn:O=>me.delete(`/v1/water-quality/sampling-points/${O}`),onSuccess:()=>{m.invalidateQueries({queryKey:["water-quality-sampling-points"]}),qe.success("Sampling point deleted successfully")},onError:O=>{qe.error(O.message||"Failed to delete sampling point")}}),S=O=>{a(O),c(!0)},k=O=>{confirm("Are you sure you want to delete this sampling point?")&&j.mutate(O)},N=()=>{a(void 0),c(!0)};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Sampling Points"}),r.jsx("p",{className:"text-muted-foreground",children:"Geographic locations where water samples are collected"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(se,{variant:"outline",onClick:()=>s(!n),children:[r.jsx(Bc,{className:"h-4 w-4 mr-2"}),n?"Hide Map":"Show Map"]}),r.jsxs(se,{onClick:N,children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"Add Sampling Point"]})]})]}),r.jsx(The,{open:i,onOpenChange:c,point:u}),n&&r.jsx(J,{children:r.jsx(ie,{className:"p-0",children:r.jsx(Ehe,{points:(p==null?void 0:p.data)||[],onPointSelect:O=>{O&&console.log("Selected point:",O)}})})}),y?r.jsx("div",{className:"text-center py-12",children:"Loading sampling points..."}):r.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:(D=p==null?void 0:p.data)==null?void 0:D.map(O=>{var T,I,z,$;return r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx(xe,{className:"text-lg",children:O.name}),r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Code: ",O.code]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:"ghost",size:"sm",onClick:()=>S(O),children:r.jsx(DO,{className:"h-4 w-4"})}),r.jsx(se,{variant:"ghost",size:"sm",onClick:()=>k(O.id),children:r.jsx(Oi,{className:"h-4 w-4"})})]})]})}),r.jsxs(ie,{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(We,{className:v[O.kind]||"bg-gray-100 text-gray-800",children:O.kind}),!O.is_active&&r.jsx(We,{variant:"destructive",children:"Inactive"})]}),O.location&&r.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[r.jsx(jo,{className:"h-4 w-4"}),r.jsxs("span",{children:[(I=(T=O.location.coordinates)==null?void 0:T[1])==null?void 0:I.toFixed(4),", ",($=(z=O.location.coordinates)==null?void 0:z[0])==null?void 0:$.toFixed(4)]})]}),O.elevation_m&&r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Elevation: ",O.elevation_m,"m"]}),O.scheme&&r.jsxs("p",{className:"text-sm",children:[r.jsx("span",{className:"text-muted-foreground",children:"Scheme:"})," ",O.scheme.name]})]})]},O.id)})}),(p==null?void 0:p.meta)&&r.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",p.meta.from," to ",p.meta.to," of ",p.meta.total," sampling points"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:"outline",size:"sm",disabled:e===1,onClick:()=>t(O=>O-1),children:"Previous"}),r.jsx(se,{variant:"outline",size:"sm",disabled:e>=p.meta.last_page,onClick:()=>t(O=>O+1),children:"Next"})]})]})]})}function Ohe({open:e,onOpenChange:t,plan:n}){const s=br(),i=!!n,{register:c,handleSubmit:u,reset:a,setValue:m,watch:p,formState:{errors:y}}=ia({defaultValues:n||{frequency:"monthly",is_active:!1}}),v=jt({mutationFn:k=>me.post("/v1/water-quality/plans",k),onSuccess:()=>{s.invalidateQueries({queryKey:["water-quality-plans"]}),qe.success("Sampling plan created successfully"),t(!1),a()},onError:k=>{qe.error(k.message||"Failed to create plan")}}),j=jt({mutationFn:k=>me.patch(`/v1/water-quality/plans/${n.id}`,k),onSuccess:()=>{s.invalidateQueries({queryKey:["water-quality-plans"]}),qe.success("Sampling plan updated successfully"),t(!1)},onError:k=>{qe.error(k.message||"Failed to update plan")}}),S=k=>{const N={...k,end_date:k.end_date||void 0};i?j.mutate(N):v.mutate(N)};return R.useEffect(()=>{var k,N;a(n?{...n,start_date:(k=n.start_date)==null?void 0:k.split("T")[0],end_date:(N=n.end_date)==null?void 0:N.split("T")[0]}:{frequency:"monthly",is_active:!1})},[n,a]),r.jsx(Rr,{open:e,onOpenChange:t,children:r.jsxs(Er,{className:"max-w-lg",children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:i?"Edit Plan":"Create New Plan"}),r.jsx(Bs,{children:i?"Update sampling plan details":"Create a new water quality sampling plan"})]}),r.jsxs("form",{onSubmit:u(S),className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"name",children:"Plan Name *"}),r.jsx(Ge,{id:"name",...c("name",{required:!0}),placeholder:"e.g., Q1 2024 Monitoring"}),y.name&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"frequency",children:"Sampling Frequency *"}),r.jsxs(Jt,{onValueChange:k=>m("frequency",k),defaultValue:(n==null?void 0:n.frequency)||"monthly",children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select frequency"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"daily",children:"Daily"}),r.jsx(ke,{value:"weekly",children:"Weekly"}),r.jsx(ke,{value:"monthly",children:"Monthly"}),r.jsx(ke,{value:"quarterly",children:"Quarterly"}),r.jsx(ke,{value:"annual",children:"Annual"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"start_date",children:"Start Date *"}),r.jsx(Ge,{id:"start_date",type:"date",...c("start_date",{required:!0})}),y.start_date&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"end_date",children:"End Date"}),r.jsx(Ge,{id:"end_date",type:"date",...c("end_date")})]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Ey,{id:"is_active",checked:p("is_active"),onCheckedChange:k=>m("is_active",k)}),r.jsx(Ne,{htmlFor:"is_active",className:"cursor-pointer",children:"Activate plan immediately"})]}),r.jsxs(Ai,{children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:v.isPending||j.isPending,children:v.isPending||j.isPending?"Saving...":i?"Update":"Create"})]})]})]})})}function Ihe(){var k;const[e,t]=R.useState(1),[n,s]=R.useState(!1),[i,c]=R.useState(void 0),u=br(),{data:a,isLoading:m}=ht({queryKey:["water-quality-plans",e],queryFn:async()=>me.get("/v1/water-quality/plans",{page:e,per_page:20})}),p=jt({mutationFn:N=>me.post(`/v1/water-quality/plans/${N}/activate`,{}),onSuccess:()=>{u.invalidateQueries({queryKey:["water-quality-plans"]}),qe.success("Plan activated successfully")},onError:N=>{qe.error(N.message||"Failed to activate plan")}}),y=jt({mutationFn:N=>me.post(`/v1/water-quality/plans/${N}/generate-samples`,{}),onSuccess:N=>{u.invalidateQueries({queryKey:["water-quality-samples"]}),qe.success(`Generated ${N.generated||0} samples successfully`)},onError:N=>{qe.error(N.message||"Failed to generate samples")}}),v=N=>{p.mutate(N)},j=N=>{y.mutate(N)},S=()=>{c(void 0),s(!0)};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Sampling Plans"}),r.jsx("p",{className:"text-muted-foreground",children:"Manage quarterly and annual water quality monitoring plans"})]}),r.jsxs(se,{onClick:S,children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"Create Plan"]})]}),r.jsx(Ohe,{open:n,onOpenChange:s,plan:i}),m?r.jsx("div",{className:"text-center py-12",children:"Loading plans..."}):r.jsx("div",{className:"grid gap-4",children:(k=a==null?void 0:a.data)==null?void 0:k.map(N=>r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(va,{className:"h-5 w-5 text-muted-foreground"}),r.jsx(xe,{className:"text-xl",children:N.name})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(We,{variant:N.is_active?"default":"secondary",children:N.is_active?"Active":"Inactive"}),r.jsx(We,{variant:"outline",children:N.frequency||"quarterly"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[!N.is_active&&r.jsxs(se,{size:"sm",variant:"default",onClick:()=>v(N.id),disabled:p.isPending,children:[r.jsx(Lre,{className:"h-4 w-4 mr-1"}),"Activate"]}),r.jsx(se,{size:"sm",variant:"outline",onClick:()=>j(N.id),disabled:y.isPending,children:"Generate Samples"})]})]})}),r.jsxs(ie,{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Start Date:"}),r.jsx("p",{className:"font-medium",children:N.start_date?mn(new Date(N.start_date),"PP"):"N/A"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"End Date:"}),r.jsx("p",{className:"font-medium",children:N.end_date?mn(new Date(N.end_date),"PP"):"N/A"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Rules:"}),r.jsxs("p",{className:"font-medium",children:[N.rules_count||0," defined"]})]})]}),N.description&&r.jsx("p",{className:"text-sm text-muted-foreground",children:N.description})]})]},N.id))}),(a==null?void 0:a.meta)&&r.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",a.meta.from," to ",a.meta.to," of ",a.meta.total," plans"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:"outline",size:"sm",disabled:e===1,onClick:()=>t(N=>N-1),children:"Previous"}),r.jsx(se,{variant:"outline",size:"sm",disabled:e>=a.meta.last_page,onClick:()=>t(N=>N+1),children:"Next"})]})]})]})}function Dhe({open:e,onOpenChange:t,sample:n}){const s=br(),{register:i,handleSubmit:c,reset:u,formState:{errors:a}}=ia(),m=jt({mutationFn:y=>me.post(`/v1/water-quality/samples/${n.id}/collect`,y),onSuccess:()=>{s.invalidateQueries({queryKey:["water-quality-samples"]}),qe.success("Sample collected successfully"),t(!1),u()},onError:y=>{qe.error(y.message||"Failed to collect sample")}}),p=y=>{m.mutate({...y,field_temp:y.field_temp?parseFloat(y.field_temp):void 0,field_ph:y.field_ph?parseFloat(y.field_ph):void 0,field_chlorine:y.field_chlorine?parseFloat(y.field_chlorine):void 0})};return r.jsx(Rr,{open:e,onOpenChange:t,children:r.jsxs(Er,{className:"max-w-lg",children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:"Collect Sample"}),r.jsxs(Bs,{children:["Record field collection details for ",n==null?void 0:n.barcode]})]}),r.jsxs("form",{onSubmit:c(p),className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"collected_by",children:"Collected By *"}),r.jsx(Ge,{id:"collected_by",...i("collected_by",{required:!0}),placeholder:"Field officer name"}),a.collected_by&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"field_temp",children:"Temp (C)"}),r.jsx(Ge,{id:"field_temp",type:"number",step:"0.1",...i("field_temp"),placeholder:"Optional"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"field_ph",children:"pH"}),r.jsx(Ge,{id:"field_ph",type:"number",step:"0.1",...i("field_ph"),placeholder:"Optional"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"field_chlorine",children:"Cl (mg/L)"}),r.jsx(Ge,{id:"field_chlorine",type:"number",step:"0.01",...i("field_chlorine"),placeholder:"Optional"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"field_notes",children:"Field Notes"}),r.jsx(Fs,{id:"field_notes",...i("field_notes"),placeholder:"Any observations during collection...",rows:3})]}),r.jsxs(Ai,{children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:m.isPending,children:m.isPending?"Collecting...":"Collect Sample"})]})]})]})})}function Rhe({open:e,onOpenChange:t,sample:n}){const s=br(),{register:i,handleSubmit:c,reset:u,formState:{errors:a}}=ia(),m=jt({mutationFn:y=>me.post(`/v1/water-quality/samples/${n.id}/receive-lab`,y),onSuccess:()=>{s.invalidateQueries({queryKey:["water-quality-samples"]}),qe.success("Sample received in lab successfully"),t(!1),u()},onError:y=>{qe.error(y.message||"Failed to receive sample")}}),p=y=>{m.mutate(y)};return r.jsx(Rr,{open:e,onOpenChange:t,children:r.jsxs(Er,{className:"max-w-lg",children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:"Receive Sample in Lab"}),r.jsxs(Bs,{children:["Record lab receipt details for ",n==null?void 0:n.barcode]})]}),r.jsxs("form",{onSubmit:c(p),className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"received_by",children:"Received By *"}),r.jsx(Ge,{id:"received_by",...i("received_by",{required:!0}),placeholder:"Lab technician name"}),a.received_by&&r.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"container_condition",children:"Container Condition"}),r.jsx(Ge,{id:"container_condition",...i("container_condition"),placeholder:"e.g., Good, Intact, No leaks"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"preservation_check",children:"Preservation Check"}),r.jsx(Ge,{id:"preservation_check",...i("preservation_check"),placeholder:"e.g., Properly preserved, Ice pack present"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"lab_notes",children:"Lab Notes"}),r.jsx(Fs,{id:"lab_notes",...i("lab_notes"),placeholder:"Any observations upon receipt...",rows:3})]}),r.jsxs(Ai,{children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:m.isPending,children:m.isPending?"Receiving...":"Receive Sample"})]})]})]})})}function Lhe(){var k;const[e,t]=R.useState(1),[n,s]=R.useState(""),[i,c]=R.useState(!1),[u,a]=R.useState(!1),[m,p]=R.useState(null),{data:y,isLoading:v}=ht({queryKey:["water-quality-samples",e],queryFn:async()=>me.get("/v1/water-quality/samples",{page:e,per_page:20})}),j={scheduled:"bg-gray-100 text-gray-800",collected:"bg-blue-100 text-blue-800",received_lab:"bg-purple-100 text-purple-800",in_analysis:"bg-yellow-100 text-yellow-800",reported:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"},S=N=>{p(N),a(!0)};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Samples"}),r.jsx("p",{className:"text-muted-foreground",children:"Track water samples from field collection to lab reporting"})]}),r.jsxs(se,{children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"Create Sample"]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-lg",children:"Search by Barcode"})}),r.jsx(ie,{children:r.jsxs("div",{className:"flex gap-2",children:[r.jsx(Ge,{placeholder:"Enter barcode (e.g., WQ20240101-ABC123)",value:n,onChange:N=>s(N.target.value)}),r.jsxs(se,{children:[r.jsx(ci,{className:"h-4 w-4 mr-2"}),"Search"]})]})})]}),v?r.jsx("div",{className:"text-center py-12",children:"Loading samples..."}):r.jsx("div",{className:"grid gap-4",children:(k=y==null?void 0:y.data)==null?void 0:k.map(N=>{var D,O;return r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ac,{className:"h-5 w-5 text-blue-500"}),r.jsx(xe,{className:"text-lg",children:((D=N.sampling_point)==null?void 0:D.name)||"Unknown Point"})]}),r.jsx("p",{className:"text-sm text-muted-foreground font-mono",children:N.barcode})]}),r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsx(We,{className:j[N.custody_state]||"bg-gray-100",children:((O=N.custody_state)==null?void 0:O.replace("_"," "))||"scheduled"}),N.custody_state==="collected"&&r.jsxs(se,{size:"sm",variant:"outline",onClick:()=>S(N),children:[r.jsx(Kre,{className:"h-4 w-4 mr-1"}),"Receive in Lab"]})]})]})}),r.jsxs(ie,{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Scheduled:"}),r.jsx("p",{className:"font-medium",children:N.scheduled_at?mn(new Date(N.scheduled_at),"PP"):"N/A"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Collected:"}),r.jsx("p",{className:"font-medium",children:N.collected_at?mn(new Date(N.collected_at),"PP"):"Pending"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Parameters:"}),r.jsxs("p",{className:"font-medium",children:[N.parameters_count||0," tests"]})]})]}),N.collected_by&&r.jsxs("p",{className:"text-sm",children:[r.jsx("span",{className:"text-muted-foreground",children:"Collected by:"})," ",N.collected_by]}),N.custody_chain&&N.custody_chain.length>0&&r.jsxs("div",{className:"text-sm",children:[r.jsx("p",{className:"text-muted-foreground mb-1",children:"Custody Chain:"}),r.jsxs("div",{className:"bg-muted p-2 rounded text-xs font-mono",children:[N.custody_chain.length," transfer(s) recorded"]})]})]})]},N.id)})}),(y==null?void 0:y.meta)&&r.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",y.meta.from," to ",y.meta.to," of ",y.meta.total," samples"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:"outline",size:"sm",disabled:e===1,onClick:()=>t(N=>N-1),children:"Previous"}),r.jsx(se,{variant:"outline",size:"sm",disabled:e>=y.meta.last_page,onClick:()=>t(N=>N+1),children:"Next"})]})]}),m&&r.jsxs(r.Fragment,{children:[r.jsx(Dhe,{open:i,onOpenChange:c,sample:m}),r.jsx(Rhe,{open:u,onOpenChange:a,sample:m})]})]})}function Fhe({open:e,onOpenChange:t}){const n=br(),s=R.useRef(null),[i,c]=R.useState(null),[u,a]=R.useState(null),m=jt({mutationFn:async j=>{const S=new FormData;S.append("file",j);const N=await fetch("/api/v1/v1/water-quality/results/import-csv",{method:"POST",body:S,credentials:"include"});if(!N.ok){const D=await N.json().catch(()=>({message:"Import failed"}));throw new Error(D.message||"Import failed")}return N.json()},onSuccess:j=>{n.invalidateQueries({queryKey:["water-quality-results"]}),a(j),qe.success(`Successfully imported ${j.imported||0} results`)},onError:j=>{var S,k;qe.error(j.message||"Failed to import CSV file"),a({errors:((k=(S=j.response)==null?void 0:S.data)==null?void 0:k.errors)||["Import failed"]})}}),p=j=>{var k;const S=(k=j.target.files)==null?void 0:k[0];if(S){if(S.type!=="text/csv"&&!S.name.endsWith(".csv")){qe.error("Please select a CSV file");return}if(S.size>5*1024*1024){qe.error("File size must be less than 5MB");return}c(S),a(null)}},y=()=>{if(!i){qe.error("Please select a file first");return}m.mutate(i)},v=()=>{c(null),a(null),s.current&&(s.current.value=""),t(!1)};return r.jsx(Rr,{open:e,onOpenChange:v,children:r.jsxs(Er,{className:"max-w-lg",children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:"Import Lab Results from CSV"}),r.jsx(Bs,{children:"Upload a CSV file containing lab test results. File must include columns: sample_barcode, parameter_code, value, uncertainty, method, analyst, analyzed_at"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"csv-file",children:"CSV File"}),r.jsx(Ge,{ref:s,id:"csv-file",type:"file",accept:".csv",onChange:p}),i&&r.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mt-2",children:[r.jsx(is,{className:"h-4 w-4"}),r.jsxs("span",{children:[i.name," (",(i.size/1024).toFixed(1)," KB)"]})]})]}),u&&r.jsx(Wi,{variant:u.errors?"destructive":"default",children:u.errors?r.jsxs(r.Fragment,{children:[r.jsx(ei,{className:"h-4 w-4"}),r.jsxs(ki,{children:[r.jsx("p",{className:"font-semibold mb-2",children:"Import Errors:"}),r.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[u.errors.slice(0,5).map((j,S)=>r.jsx("li",{className:"text-sm",children:j},S)),u.errors.length>5&&r.jsxs("li",{className:"text-sm",children:["... and ",u.errors.length-5," more"]})]})]})]}):r.jsxs(r.Fragment,{children:[r.jsx(os,{className:"h-4 w-4"}),r.jsxs(ki,{children:[r.jsx("p",{className:"font-semibold",children:"Import Successful!"}),r.jsxs("p",{className:"text-sm mt-1",children:["Imported ",u.imported||0," results.",u.skipped>0&&` Skipped ${u.skipped} duplicates.`]})]})]})}),r.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[r.jsx("h4",{className:"text-sm font-semibold mb-2",children:"CSV Format Example:"}),r.jsx("pre",{className:"text-xs font-mono overflow-x-auto",children:`sample_barcode,parameter_code,value,uncertainty,method,analyst,analyzed_at
WQ20240101-ABC123,PH,7.2,0.1,SM 4500-H,John Doe,2024-01-15
WQ20240101-ABC123,TURB,1.5,0.2,SM 2130-B,Jane Smith,2024-01-15`})]})]}),r.jsxs(Ai,{children:[r.jsx(se,{type:"button",variant:"outline",onClick:v,children:u?"Close":"Cancel"}),!u&&r.jsx(se,{onClick:y,disabled:!i||m.isPending,children:m.isPending?r.jsx(r.Fragment,{children:"Importing..."}):r.jsxs(r.Fragment,{children:[r.jsx(Go,{className:"h-4 w-4 mr-2"}),"Import CSV"]})})]})]})})}function zhe(){var a;const[e,t]=R.useState(1),[n,s]=R.useState(!1),{data:i,isLoading:c}=ht({queryKey:["water-quality-results",e],queryFn:async()=>me.get("/v1/water-quality/results",{page:e,per_page:20})}),u={below_lod:"bg-gray-100 text-gray-800",exceeds_who_limit:"bg-orange-100 text-orange-800",exceeds_wasreb_limit:"bg-red-100 text-red-800",exceeds_local_limit:"bg-red-100 text-red-800",high_uncertainty:"bg-yellow-100 text-yellow-800"};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Lab Results"}),r.jsx("p",{className:"text-muted-foreground",children:"Enter and review lab analysis results with automatic QC flagging"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(se,{variant:"outline",onClick:()=>s(!0),children:[r.jsx(Go,{className:"h-4 w-4 mr-2"}),"Import CSV"]}),r.jsxs(se,{children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"Add Result"]})]})]}),r.jsx(Fhe,{open:n,onOpenChange:s}),c?r.jsx("div",{className:"text-center py-12",children:"Loading results..."}):r.jsx("div",{className:"grid gap-4",children:(a=i==null?void 0:i.data)==null?void 0:a.map(m=>{var v,j,S,k,N,D,O,T,I,z,$,V;const p=m.qc_flags&&m.qc_flags.length>0,y=(v=m.qc_flags)==null?void 0:v.some(K=>K.includes("exceeds_wasreb")||K.includes("exceeds_local"));return r.jsxs(J,{className:y?"border-red-200":"",children:[r.jsx(ge,{className:"pb-3",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(xe,{className:"text-lg",children:((S=(j=m.sample_param)==null?void 0:j.parameter)==null?void 0:S.name)||"Unknown Parameter"}),p&&r.jsx(gn,{className:`h-5 w-5 ${y?"text-red-500":"text-yellow-500"}`})]}),r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Sample: ",(N=(k=m.sample_param)==null?void 0:k.sample)==null?void 0:N.barcode]})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{className:"text-2xl font-bold",children:[m.value_qualifier&&r.jsx("span",{className:"text-muted-foreground",children:m.value_qualifier}),(D=m.value)==null?void 0:D.toFixed(2)," ",(T=(O=m.sample_param)==null?void 0:O.parameter)==null?void 0:T.unit]}),m.uncertainty&&r.jsxs("p",{className:"text-sm text-muted-foreground",children:[" ",m.uncertainty," ",(z=(I=m.sample_param)==null?void 0:I.parameter)==null?void 0:z.unit]})]})]})}),r.jsxs(ie,{className:"space-y-3",children:[p&&r.jsx("div",{className:"flex flex-wrap gap-2",children:m.qc_flags.map(K=>r.jsx(We,{className:u[K]||"bg-gray-100",children:K.replace(/_/g," ")},K))}),r.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Analyzed:"}),r.jsx("p",{className:"font-medium",children:m.analyzed_at?mn(new Date(m.analyzed_at),"PP"):"N/A"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Method:"}),r.jsx("p",{className:"font-medium",children:m.method||"N/A"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"LOD:"}),r.jsx("p",{className:"font-medium",children:m.lod?`${m.lod} ${(V=($=m.sample_param)==null?void 0:$.parameter)==null?void 0:V.unit}`:"N/A"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Analyst:"}),r.jsx("p",{className:"font-medium",children:m.analyst||"N/A"})]})]}),m.remarks&&r.jsx("p",{className:"text-sm text-muted-foreground italic",children:m.remarks})]})]},m.id)})}),(i==null?void 0:i.meta)&&r.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",i.meta.from," to ",i.meta.to," of ",i.meta.total," results"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:"outline",size:"sm",disabled:e===1,onClick:()=>t(m=>m-1),children:"Previous"}),r.jsx(se,{variant:"outline",size:"sm",disabled:e>=i.meta.last_page,onClick:()=>t(m=>m+1),children:"Next"})]})]})]})}function $he(){var i,c;const{data:e,isLoading:t}=ht({queryKey:["water-quality-compliance-summary"],queryFn:async()=>me.get("/v1/water-quality/compliance/summary")}),{data:n,isLoading:s}=ht({queryKey:["water-quality-compliance"],queryFn:async()=>me.get("/v1/water-quality/compliance",{per_page:50})});return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Compliance Dashboard"}),r.jsx("p",{className:"text-muted-foreground",children:"Monitor regulatory compliance with WHO and WASREB water quality standards"})]}),r.jsxs(se,{children:[r.jsx($s,{className:"h-4 w-4 mr-2"}),"Generate Report"]})]}),r.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Overall Compliance"}),r.jsx(Xu,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:t?"...":`${((i=e==null?void 0:e.overall_compliance_rate)==null?void 0:i.toFixed(1))||0}%`}),r.jsx(Ju,{value:(e==null?void 0:e.overall_compliance_rate)||0,className:"mt-2"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Compliant Points"}),r.jsx(os,{className:"h-4 w-4 text-green-500"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:t?"...":(e==null?void 0:e.compliant_points)||0}),r.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["of ",(e==null?void 0:e.total_points)||0," sampling points"]})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Non-Compliant"}),r.jsx(ei,{className:"h-4 w-4 text-red-500"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:t?"...":(e==null?void 0:e.non_compliant_points)||0}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"require immediate action"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Tests This Period"}),r.jsx(Xu,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:t?"...":(e==null?void 0:e.total_tests)||0}),r.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[(e==null?void 0:e.failed_tests)||0," failed tests"]})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Compliance by Parameter & Location"})}),r.jsx(ie,{children:s?r.jsx("div",{className:"text-center py-8",children:"Loading compliance data..."}):r.jsx("div",{className:"space-y-4",children:(c=n==null?void 0:n.data)==null?void 0:c.map(u=>{var p,y,v;const a=u.compliant_samples/u.total_samples*100,m=a>=95;return r.jsxs("div",{className:"border rounded-lg p-4",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold",children:((p=u.parameter)==null?void 0:p.name)||"Unknown"}),r.jsxs("p",{className:"text-sm text-muted-foreground",children:[((y=u.sampling_point)==null?void 0:y.name)||"All Points","  ",u.period||"Current Period"]})]}),r.jsxs(We,{variant:m?"default":"destructive",children:[a.toFixed(1),"% Compliant"]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm mb-2",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Total Samples:"}),r.jsx("p",{className:"font-medium",children:u.total_samples})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Compliant:"}),r.jsx("p",{className:"font-medium text-green-600",children:u.compliant_samples})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Non-Compliant:"}),r.jsx("p",{className:"font-medium text-red-600",children:u.non_compliant_samples})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Limit Applied:"}),r.jsx("p",{className:"font-medium",children:((v=u.limit_type)==null?void 0:v.toUpperCase())||"N/A"})]})]}),r.jsx(Ju,{value:a,className:"h-2"})]},u.id)})})})]})]})}function Bhe(){return r.jsxs("div",{className:"flex min-h-screen",children:[r.jsx(za,{}),r.jsx("main",{className:"flex-1 p-8 overflow-auto",children:r.jsx(Fa,{})})]})}const Hn="/crm",Is={getCustomers:e=>{const t={};return e!=null&&e.search&&(t.search=e.search),e!=null&&e.per_page&&(t.per_page=e.per_page.toString()),me.get(`${Hn}/customers`,t)},getCustomer:e=>me.get(`${Hn}/customers/${e}`),createCustomer:e=>me.post(`${Hn}/customers`,e),updateCustomer:(e,t)=>me.put(`${Hn}/customers/${e}`,t),getPremises:e=>{const t={};return e!=null&&e.search&&(t.search=e.search),e!=null&&e.scheme_id&&(t.scheme_id=e.scheme_id.toString()),e!=null&&e.category&&(t.category=e.category),me.get(`${Hn}/premises`,t)},getPremise:e=>me.get(`${Hn}/premises/${e}`),getAccountOverview:e=>me.get(`${Hn}/accounts/${e}/overview`),getBillingHistory:(e,t)=>{const n={};return t&&(n.months=t.toString()),me.get(`${Hn}/accounts/${e}/billing`,n)},getConsumptionAnalytics:(e,t)=>{const n={};return t&&(n.months=t.toString()),me.get(`${Hn}/accounts/${e}/analytics`,n)},getRaCases:e=>{const t={};return e&&(t.status=e),me.get(`${Hn}/ra/cases`,t)},getHighPriorityCases:(e=20)=>{const t={limit:e.toString()};return me.get(`${Hn}/ra/cases/high-priority`,t)},triageCase:(e,t)=>me.post(`${Hn}/ra/cases/${e}/triage`,t),getAgingReport:()=>me.get(`${Hn}/dunning/aging`),getDisconnectionList:()=>me.get(`${Hn}/dunning/disconnection-list`),generateDunningNotices:e=>me.post(`${Hn}/dunning/notices`,{aging_bucket:e}),importBilling:e=>{const t=new FormData;return t.append("file",e),me.post(`${Hn}/import/billing`,t)},importMpesa:e=>{const t=new FormData;return t.append("file",e),me.post(`${Hn}/import/mpesa`,t)},getComplaints:e=>{const t={};return e!=null&&e.status&&(t.status=e.status),e!=null&&e.category&&(t.category=e.category),e!=null&&e.priority&&(t.priority=e.priority),e!=null&&e.account_no&&(t.account_no=e.account_no),me.get(`${Hn}/complaints`,t)},getComplaint:e=>me.get(`${Hn}/complaints/${e}`),createComplaint:e=>me.post(`${Hn}/complaints`,e),updateComplaint:(e,t)=>me.patch(`${Hn}/complaints/${e}`,t),getInteractions:e=>{const t={};return e!=null&&e.channel&&(t.channel=e.channel),e!=null&&e.account_no&&(t.account_no=e.account_no),me.get(`${Hn}/interactions`,t)},getInteraction:e=>me.get(`${Hn}/interactions/${e}`),createInteraction:e=>me.post(`${Hn}/interactions`,e),getNotes:e=>{const t={};return e!=null&&e.account_no&&(t.account_no=e.account_no),e!=null&&e.customer_id&&(t.customer_id=e.customer_id.toString()),me.get(`${Hn}/notes`,t)},getNote:e=>me.get(`${Hn}/notes/${e}`),createNote:e=>me.post(`${Hn}/notes`,e),updateNote:(e,t)=>me.patch(`${Hn}/notes/${e}`,t),deleteNote:e=>me.delete(`${Hn}/notes/${e}`)},qhe={residential:"bg-blue-100 text-blue-800",commercial:"bg-purple-100 text-purple-800",industrial:"bg-orange-100 text-orange-800",public:"bg-green-100 text-green-800"};function Vhe(){const[e,t]=R.useState(""),{data:n,isLoading:s,error:i}=ht({queryKey:["customers",e],queryFn:()=>Is.getCustomers({search:e,per_page:50})}),c=(n==null?void 0:n.data)||[];return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Customers"}),r.jsx("p",{className:"text-muted-foreground",children:"Manage customer accounts and information"})]}),r.jsxs(se,{children:[r.jsx(ine,{className:"mr-2 h-4 w-4"}),"Add Customer"]})]}),s&&!n?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading customers..."})}):i?r.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:r.jsxs("p",{className:"text-lg text-destructive",children:["Error loading customers: ",i.message]})}):r.jsx(r.Fragment,{children:r.jsx(J,{children:r.jsxs(ie,{className:"pt-6",children:[r.jsx("div",{className:"flex gap-4 mb-6",children:r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"relative",children:[r.jsx(ci,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Search by name, ID, phone, or email...",className:"pl-9",value:e,onChange:u=>t(u.target.value)})]})})}),r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Name"}),r.jsx(le,{children:"ID Number"}),r.jsx(le,{children:"Phone"}),r.jsx(le,{children:"Email"}),r.jsx(le,{children:"Type"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:c.length===0?r.jsx(lt,{children:r.jsx(ne,{colSpan:6,className:"text-center text-muted-foreground",children:"No customers found"})}):c.map(u=>r.jsxs(lt,{children:[r.jsxs(ne,{className:"font-medium",children:[u.first_name," ",u.last_name]}),r.jsx(ne,{children:u.id_number}),r.jsx(ne,{children:u.phone}),r.jsx(ne,{children:u.email||"-"}),r.jsx(ne,{children:r.jsx(We,{className:qhe[u.customer_type],children:u.customer_type})}),r.jsx(ne,{children:u.service_connections&&u.service_connections.length>0?r.jsx(se,{variant:"ghost",size:"sm",asChild:!0,children:r.jsx(mc,{to:`/crm/accounts/${u.service_connections[0].account_no}`,children:r.jsx(Lm,{className:"h-4 w-4"})})}):r.jsx(se,{variant:"ghost",size:"sm",disabled:!0,children:r.jsx(Lm,{className:"h-4 w-4"})})})]},u.id))})]}),r.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:["Showing ",c.length," customer(s)"]})]})})})]})}var Uhe=Array.isArray,No=Uhe,Whe=typeof I_=="object"&&I_&&I_.Object===Object&&I_,MW=Whe,Ghe=MW,Khe=typeof self=="object"&&self&&self.Object===Object&&self,Hhe=Ghe||Khe||Function("return this")(),au=Hhe,Zhe=au,Yhe=Zhe.Symbol,$b=Yhe,NF=$b,OW=Object.prototype,Xhe=OW.hasOwnProperty,Qhe=OW.toString,S_=NF?NF.toStringTag:void 0;function Jhe(e){var t=Xhe.call(e,S_),n=e[S_];try{e[S_]=void 0;var s=!0}catch{}var i=Qhe.call(e);return s&&(t?e[S_]=n:delete e[S_]),i}var efe=Jhe,tfe=Object.prototype,rfe=tfe.toString;function nfe(e){return rfe.call(e)}var sfe=nfe,PF=$b,ife=efe,afe=sfe,ofe="[object Null]",lfe="[object Undefined]",CF=PF?PF.toStringTag:void 0;function cfe(e){return e==null?e===void 0?lfe:ofe:CF&&CF in Object(e)?ife(e):afe(e)}var jd=cfe;function ufe(e){return e!=null&&typeof e=="object"}var wd=ufe,dfe=jd,hfe=wd,ffe="[object Symbol]";function mfe(e){return typeof e=="symbol"||hfe(e)&&dfe(e)==ffe}var My=mfe,pfe=No,gfe=My,xfe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,yfe=/^\w*$/;function vfe(e,t){if(pfe(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||gfe(e)?!0:yfe.test(e)||!xfe.test(e)||t!=null&&e in Object(t)}var SI=vfe;function _fe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var df=_fe;const Oy=Fn(df);var bfe=jd,jfe=df,wfe="[object AsyncFunction]",Sfe="[object Function]",Nfe="[object GeneratorFunction]",Pfe="[object Proxy]";function Cfe(e){if(!jfe(e))return!1;var t=bfe(e);return t==Sfe||t==Nfe||t==wfe||t==Pfe}var NI=Cfe;const Br=Fn(NI);var Afe=au,kfe=Afe["__core-js_shared__"],Tfe=kfe,MA=Tfe,AF=function(){var e=/[^.]+$/.exec(MA&&MA.keys&&MA.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Efe(e){return!!AF&&AF in e}var Mfe=Efe,Ofe=Function.prototype,Ife=Ofe.toString;function Dfe(e){if(e!=null){try{return Ife.call(e)}catch{}try{return e+""}catch{}}return""}var IW=Dfe,Rfe=NI,Lfe=Mfe,Ffe=df,zfe=IW,$fe=/[\\^$.*+?()[\]{}|]/g,Bfe=/^\[object .+?Constructor\]$/,qfe=Function.prototype,Vfe=Object.prototype,Ufe=qfe.toString,Wfe=Vfe.hasOwnProperty,Gfe=RegExp("^"+Ufe.call(Wfe).replace($fe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Kfe(e){if(!Ffe(e)||Lfe(e))return!1;var t=Rfe(e)?Gfe:Bfe;return t.test(zfe(e))}var Hfe=Kfe;function Zfe(e,t){return e==null?void 0:e[t]}var Yfe=Zfe,Xfe=Hfe,Qfe=Yfe;function Jfe(e,t){var n=Qfe(e,t);return Xfe(n)?n:void 0}var ep=Jfe,eme=ep,tme=eme(Object,"create"),E2=tme,kF=E2;function rme(){this.__data__=kF?kF(null):{},this.size=0}var nme=rme;function sme(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var ime=sme,ame=E2,ome="__lodash_hash_undefined__",lme=Object.prototype,cme=lme.hasOwnProperty;function ume(e){var t=this.__data__;if(ame){var n=t[e];return n===ome?void 0:n}return cme.call(t,e)?t[e]:void 0}var dme=ume,hme=E2,fme=Object.prototype,mme=fme.hasOwnProperty;function pme(e){var t=this.__data__;return hme?t[e]!==void 0:mme.call(t,e)}var gme=pme,xme=E2,yme="__lodash_hash_undefined__";function vme(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=xme&&t===void 0?yme:t,this}var _me=vme,bme=nme,jme=ime,wme=dme,Sme=gme,Nme=_me;function Iy(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}Iy.prototype.clear=bme;Iy.prototype.delete=jme;Iy.prototype.get=wme;Iy.prototype.has=Sme;Iy.prototype.set=Nme;var Pme=Iy;function Cme(){this.__data__=[],this.size=0}var Ame=Cme;function kme(e,t){return e===t||e!==e&&t!==t}var PI=kme,Tme=PI;function Eme(e,t){for(var n=e.length;n--;)if(Tme(e[n][0],t))return n;return-1}var M2=Eme,Mme=M2,Ome=Array.prototype,Ime=Ome.splice;function Dme(e){var t=this.__data__,n=Mme(t,e);if(n<0)return!1;var s=t.length-1;return n==s?t.pop():Ime.call(t,n,1),--this.size,!0}var Rme=Dme,Lme=M2;function Fme(e){var t=this.__data__,n=Lme(t,e);return n<0?void 0:t[n][1]}var zme=Fme,$me=M2;function Bme(e){return $me(this.__data__,e)>-1}var qme=Bme,Vme=M2;function Ume(e,t){var n=this.__data__,s=Vme(n,e);return s<0?(++this.size,n.push([e,t])):n[s][1]=t,this}var Wme=Ume,Gme=Ame,Kme=Rme,Hme=zme,Zme=qme,Yme=Wme;function Dy(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}Dy.prototype.clear=Gme;Dy.prototype.delete=Kme;Dy.prototype.get=Hme;Dy.prototype.has=Zme;Dy.prototype.set=Yme;var O2=Dy,Xme=ep,Qme=au,Jme=Xme(Qme,"Map"),CI=Jme,TF=Pme,epe=O2,tpe=CI;function rpe(){this.size=0,this.__data__={hash:new TF,map:new(tpe||epe),string:new TF}}var npe=rpe;function spe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var ipe=spe,ape=ipe;function ope(e,t){var n=e.__data__;return ape(t)?n[typeof t=="string"?"string":"hash"]:n.map}var I2=ope,lpe=I2;function cpe(e){var t=lpe(this,e).delete(e);return this.size-=t?1:0,t}var upe=cpe,dpe=I2;function hpe(e){return dpe(this,e).get(e)}var fpe=hpe,mpe=I2;function ppe(e){return mpe(this,e).has(e)}var gpe=ppe,xpe=I2;function ype(e,t){var n=xpe(this,e),s=n.size;return n.set(e,t),this.size+=n.size==s?0:1,this}var vpe=ype,_pe=npe,bpe=upe,jpe=fpe,wpe=gpe,Spe=vpe;function Ry(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}Ry.prototype.clear=_pe;Ry.prototype.delete=bpe;Ry.prototype.get=jpe;Ry.prototype.has=wpe;Ry.prototype.set=Spe;var AI=Ry,DW=AI,Npe="Expected a function";function kI(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Npe);var n=function(){var s=arguments,i=t?t.apply(this,s):s[0],c=n.cache;if(c.has(i))return c.get(i);var u=e.apply(this,s);return n.cache=c.set(i,u)||c,u};return n.cache=new(kI.Cache||DW),n}kI.Cache=DW;var RW=kI;const Ppe=Fn(RW);var Cpe=RW,Ape=500;function kpe(e){var t=Cpe(e,function(s){return n.size===Ape&&n.clear(),s}),n=t.cache;return t}var Tpe=kpe,Epe=Tpe,Mpe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ope=/\\(\\)?/g,Ipe=Epe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Mpe,function(n,s,i,c){t.push(i?c.replace(Ope,"$1"):s||n)}),t}),Dpe=Ipe;function Rpe(e,t){for(var n=-1,s=e==null?0:e.length,i=Array(s);++n<s;)i[n]=t(e[n],n,e);return i}var TI=Rpe,EF=$b,Lpe=TI,Fpe=No,zpe=My,MF=EF?EF.prototype:void 0,OF=MF?MF.toString:void 0;function LW(e){if(typeof e=="string")return e;if(Fpe(e))return Lpe(e,LW)+"";if(zpe(e))return OF?OF.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var $pe=LW,Bpe=$pe;function qpe(e){return e==null?"":Bpe(e)}var FW=qpe,Vpe=No,Upe=SI,Wpe=Dpe,Gpe=FW;function Kpe(e,t){return Vpe(e)?e:Upe(e,t)?[e]:Wpe(Gpe(e))}var zW=Kpe,Hpe=My;function Zpe(e){if(typeof e=="string"||Hpe(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var D2=Zpe,Ype=zW,Xpe=D2;function Qpe(e,t){t=Ype(t,e);for(var n=0,s=t.length;e!=null&&n<s;)e=e[Xpe(t[n++])];return n&&n==s?e:void 0}var EI=Qpe,Jpe=EI;function ege(e,t,n){var s=e==null?void 0:Jpe(e,t);return s===void 0?n:s}var $W=ege;const Zo=Fn($W);function tge(e){return e==null}var rge=tge;const Zr=Fn(rge);var nge=jd,sge=No,ige=wd,age="[object String]";function oge(e){return typeof e=="string"||!sge(e)&&ige(e)&&nge(e)==age}var lge=oge;const Bb=Fn(lge);var BW={exports:{}},Xn={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MI=Symbol.for("react.element"),OI=Symbol.for("react.portal"),R2=Symbol.for("react.fragment"),L2=Symbol.for("react.strict_mode"),F2=Symbol.for("react.profiler"),z2=Symbol.for("react.provider"),$2=Symbol.for("react.context"),cge=Symbol.for("react.server_context"),B2=Symbol.for("react.forward_ref"),q2=Symbol.for("react.suspense"),V2=Symbol.for("react.suspense_list"),U2=Symbol.for("react.memo"),W2=Symbol.for("react.lazy"),uge=Symbol.for("react.offscreen"),qW;qW=Symbol.for("react.module.reference");function El(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case MI:switch(e=e.type,e){case R2:case F2:case L2:case q2:case V2:return e;default:switch(e=e&&e.$$typeof,e){case cge:case $2:case B2:case W2:case U2:case z2:return e;default:return t}}case OI:return t}}}Xn.ContextConsumer=$2;Xn.ContextProvider=z2;Xn.Element=MI;Xn.ForwardRef=B2;Xn.Fragment=R2;Xn.Lazy=W2;Xn.Memo=U2;Xn.Portal=OI;Xn.Profiler=F2;Xn.StrictMode=L2;Xn.Suspense=q2;Xn.SuspenseList=V2;Xn.isAsyncMode=function(){return!1};Xn.isConcurrentMode=function(){return!1};Xn.isContextConsumer=function(e){return El(e)===$2};Xn.isContextProvider=function(e){return El(e)===z2};Xn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===MI};Xn.isForwardRef=function(e){return El(e)===B2};Xn.isFragment=function(e){return El(e)===R2};Xn.isLazy=function(e){return El(e)===W2};Xn.isMemo=function(e){return El(e)===U2};Xn.isPortal=function(e){return El(e)===OI};Xn.isProfiler=function(e){return El(e)===F2};Xn.isStrictMode=function(e){return El(e)===L2};Xn.isSuspense=function(e){return El(e)===q2};Xn.isSuspenseList=function(e){return El(e)===V2};Xn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===R2||e===F2||e===L2||e===q2||e===V2||e===uge||typeof e=="object"&&e!==null&&(e.$$typeof===W2||e.$$typeof===U2||e.$$typeof===z2||e.$$typeof===$2||e.$$typeof===B2||e.$$typeof===qW||e.getModuleId!==void 0)};Xn.typeOf=El;BW.exports=Xn;var dge=BW.exports,hge=jd,fge=wd,mge="[object Number]";function pge(e){return typeof e=="number"||fge(e)&&hge(e)==mge}var VW=pge;const gge=Fn(VW);var xge=VW;function yge(e){return xge(e)&&e!=+e}var vge=yge;const Ly=Fn(vge);var Ya=function(t){return t===0?0:t>0?1:-1},fm=function(t){return Bb(t)&&t.indexOf("%")===t.length-1},Ut=function(t){return gge(t)&&!Ly(t)},Ui=function(t){return Ut(t)||Bb(t)},_ge=0,tp=function(t){var n=++_ge;return"".concat(t||"").concat(n)},Xa=function(t,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ut(t)&&!Bb(t))return s;var c;if(fm(t)){var u=t.indexOf("%");c=n*parseFloat(t.slice(0,u))/100}else c=+t;return Ly(c)&&(c=s),i&&c>n&&(c=n),c},ph=function(t){if(!t)return null;var n=Object.keys(t);return n&&n.length?t[n[0]]:null},bge=function(t){if(!Array.isArray(t))return!1;for(var n=t.length,s={},i=0;i<n;i++)if(!s[t[i]])s[t[i]]=!0;else return!0;return!1},Zs=function(t,n){return Ut(t)&&Ut(n)?function(s){return t+s*(n-t)}:function(){return n}};function ES(e,t,n){return!e||!e.length?null:e.find(function(s){return s&&(typeof t=="function"?t(s):Zo(s,t))===n})}function ex(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var s in t)if({}.hasOwnProperty.call(t,s)&&!{}.hasOwnProperty.call(e,s))return!1;return!0}function XT(e){"@babel/helpers - typeof";return XT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},XT(e)}var jge=["viewBox","children"],wge=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],IF=["points","pathLength"],OA={svg:jge,polygon:IF,polyline:IF},II=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],MS=function(t,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var s=t;if(R.isValidElement(t)&&(s=t.props),!Oy(s))return null;var i={};return Object.keys(s).forEach(function(c){II.includes(c)&&(i[c]=n||function(u){return s[c](s,u)})}),i},Sge=function(t,n,s){return function(i){return t(n,s,i),null}},Wm=function(t,n,s){if(!Oy(t)||XT(t)!=="object")return null;var i=null;return Object.keys(t).forEach(function(c){var u=t[c];II.includes(c)&&typeof u=="function"&&(i||(i={}),i[c]=Sge(u,n,s))}),i},Nge=["children"],Pge=["children"];function DF(e,t){if(e==null)return{};var n=Cge(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Cge(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function QT(e){"@babel/helpers - typeof";return QT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},QT(e)}var RF={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},ed=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},LF=null,IA=null,DI=function e(t){if(t===LF&&Array.isArray(IA))return IA;var n=[];return R.Children.forEach(t,function(s){Zr(s)||(dge.isFragment(s)?n=n.concat(e(s.props.children)):n.push(s))}),IA=n,LF=t,n};function Yo(e,t){var n=[],s=[];return Array.isArray(t)?s=t.map(function(i){return ed(i)}):s=[ed(t)],DI(e).forEach(function(i){var c=Zo(i,"type.displayName")||Zo(i,"type.name");s.indexOf(c)!==-1&&n.push(i)}),n}function zo(e,t){var n=Yo(e,t);return n&&n[0]}var FF=function(t){if(!t||!t.props)return!1;var n=t.props,s=n.width,i=n.height;return!(!Ut(s)||s<=0||!Ut(i)||i<=0)},Age=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],kge=function(t){return t&&t.type&&Bb(t.type)&&Age.indexOf(t.type)>=0},UW=function(t){return t&&QT(t)==="object"&&"clipDot"in t},Tge=function(t,n,s,i){var c,u=(c=OA==null?void 0:OA[i])!==null&&c!==void 0?c:[];return!Br(t)&&(i&&u.includes(n)||wge.includes(n))||s&&II.includes(n)},Cr=function(t,n,s){if(!t||typeof t=="function"||typeof t=="boolean")return null;var i=t;if(R.isValidElement(t)&&(i=t.props),!Oy(i))return null;var c={};return Object.keys(i).forEach(function(u){var a;Tge((a=i)===null||a===void 0?void 0:a[u],u,n,s)&&(c[u]=i[u])}),c},JT=function e(t,n){if(t===n)return!0;var s=R.Children.count(t);if(s!==R.Children.count(n))return!1;if(s===0)return!0;if(s===1)return zF(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var i=0;i<s;i++){var c=t[i],u=n[i];if(Array.isArray(c)||Array.isArray(u)){if(!e(c,u))return!1}else if(!zF(c,u))return!1}return!0},zF=function(t,n){if(Zr(t)&&Zr(n))return!0;if(!Zr(t)&&!Zr(n)){var s=t.props||{},i=s.children,c=DF(s,Nge),u=n.props||{},a=u.children,m=DF(u,Pge);return i&&a?ex(c,m)&&JT(i,a):!i&&!a?ex(c,m):!1}return!1},$F=function(t,n){var s=[],i={};return DI(t).forEach(function(c,u){if(kge(c))s.push(c);else if(c){var a=ed(c.type),m=n[a]||{},p=m.handler,y=m.once;if(p&&(!y||!i[a])){var v=p(c,a,u);s.push(v),i[a]=!0}}}),s},Ege=function(t){var n=t&&t.type;return n&&RF[n]?RF[n]:null},Mge=function(t,n){return DI(n).indexOf(t)},Oge=["children","width","height","viewBox","className","style","title","desc"];function eE(){return eE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},eE.apply(this,arguments)}function Ige(e,t){if(e==null)return{};var n=Dge(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Dge(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function tE(e){var t=e.children,n=e.width,s=e.height,i=e.viewBox,c=e.className,u=e.style,a=e.title,m=e.desc,p=Ige(e,Oge),y=i||{width:n,height:s,x:0,y:0},v=Yr("recharts-surface",c);return de.createElement("svg",eE({},Cr(p,!0,"svg"),{className:v,width:n,height:s,style:u,viewBox:"".concat(y.x," ").concat(y.y," ").concat(y.width," ").concat(y.height)}),de.createElement("title",null,a),de.createElement("desc",null,m),t)}var Rge=["children","className"];function rE(){return rE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},rE.apply(this,arguments)}function Lge(e,t){if(e==null)return{};var n=Fge(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Fge(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}var xn=de.forwardRef(function(e,t){var n=e.children,s=e.className,i=Lge(e,Rge),c=Yr("recharts-layer",s);return de.createElement("g",rE({className:c},Cr(i,!0),{ref:t}),n)}),pc=function(t,n){for(var s=arguments.length,i=new Array(s>2?s-2:0),c=2;c<s;c++)i[c-2]=arguments[c]};function zge(e,t,n){var s=-1,i=e.length;t<0&&(t=-t>i?0:i+t),n=n>i?i:n,n<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var c=Array(i);++s<i;)c[s]=e[s+t];return c}var $ge=zge,Bge=$ge;function qge(e,t,n){var s=e.length;return n=n===void 0?s:n,!t&&n>=s?e:Bge(e,t,n)}var Vge=qge,Uge="\\ud800-\\udfff",Wge="\\u0300-\\u036f",Gge="\\ufe20-\\ufe2f",Kge="\\u20d0-\\u20ff",Hge=Wge+Gge+Kge,Zge="\\ufe0e\\ufe0f",Yge="\\u200d",Xge=RegExp("["+Yge+Uge+Hge+Zge+"]");function Qge(e){return Xge.test(e)}var WW=Qge;function Jge(e){return e.split("")}var exe=Jge,GW="\\ud800-\\udfff",txe="\\u0300-\\u036f",rxe="\\ufe20-\\ufe2f",nxe="\\u20d0-\\u20ff",sxe=txe+rxe+nxe,ixe="\\ufe0e\\ufe0f",axe="["+GW+"]",nE="["+sxe+"]",sE="\\ud83c[\\udffb-\\udfff]",oxe="(?:"+nE+"|"+sE+")",KW="[^"+GW+"]",HW="(?:\\ud83c[\\udde6-\\uddff]){2}",ZW="[\\ud800-\\udbff][\\udc00-\\udfff]",lxe="\\u200d",YW=oxe+"?",XW="["+ixe+"]?",cxe="(?:"+lxe+"(?:"+[KW,HW,ZW].join("|")+")"+XW+YW+")*",uxe=XW+YW+cxe,dxe="(?:"+[KW+nE+"?",nE,HW,ZW,axe].join("|")+")",hxe=RegExp(sE+"(?="+sE+")|"+dxe+uxe,"g");function fxe(e){return e.match(hxe)||[]}var mxe=fxe,pxe=exe,gxe=WW,xxe=mxe;function yxe(e){return gxe(e)?xxe(e):pxe(e)}var vxe=yxe,_xe=Vge,bxe=WW,jxe=vxe,wxe=FW;function Sxe(e){return function(t){t=wxe(t);var n=bxe(t)?jxe(t):void 0,s=n?n[0]:t.charAt(0),i=n?_xe(n,1).join(""):t.slice(1);return s[e]()+i}}var Nxe=Sxe,Pxe=Nxe,Cxe=Pxe("toUpperCase"),Axe=Cxe;const G2=Fn(Axe);function ms(e){return function(){return e}}const QW=Math.cos,OS=Math.sin,bc=Math.sqrt,IS=Math.PI,K2=2*IS,iE=Math.PI,aE=2*iE,im=1e-6,kxe=aE-im;function JW(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Txe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return JW;const n=10**t;return function(s){this._+=s[0];for(let i=1,c=s.length;i<c;++i)this._+=Math.round(arguments[i]*n)/n+s[i]}}class Exe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?JW:Txe(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,s,i){this._append`Q${+t},${+n},${this._x1=+s},${this._y1=+i}`}bezierCurveTo(t,n,s,i,c,u){this._append`C${+t},${+n},${+s},${+i},${this._x1=+c},${this._y1=+u}`}arcTo(t,n,s,i,c){if(t=+t,n=+n,s=+s,i=+i,c=+c,c<0)throw new Error(`negative radius: ${c}`);let u=this._x1,a=this._y1,m=s-t,p=i-n,y=u-t,v=a-n,j=y*y+v*v;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(j>im)if(!(Math.abs(v*m-p*y)>im)||!c)this._append`L${this._x1=t},${this._y1=n}`;else{let S=s-u,k=i-a,N=m*m+p*p,D=S*S+k*k,O=Math.sqrt(N),T=Math.sqrt(j),I=c*Math.tan((iE-Math.acos((N+j-D)/(2*O*T)))/2),z=I/T,$=I/O;Math.abs(z-1)>im&&this._append`L${t+z*y},${n+z*v}`,this._append`A${c},${c},0,0,${+(v*S>y*k)},${this._x1=t+$*m},${this._y1=n+$*p}`}}arc(t,n,s,i,c,u){if(t=+t,n=+n,s=+s,u=!!u,s<0)throw new Error(`negative radius: ${s}`);let a=s*Math.cos(i),m=s*Math.sin(i),p=t+a,y=n+m,v=1^u,j=u?i-c:c-i;this._x1===null?this._append`M${p},${y}`:(Math.abs(this._x1-p)>im||Math.abs(this._y1-y)>im)&&this._append`L${p},${y}`,s&&(j<0&&(j=j%aE+aE),j>kxe?this._append`A${s},${s},0,1,${v},${t-a},${n-m}A${s},${s},0,1,${v},${this._x1=p},${this._y1=y}`:j>im&&this._append`A${s},${s},0,${+(j>=iE)},${v},${this._x1=t+s*Math.cos(c)},${this._y1=n+s*Math.sin(c)}`)}rect(t,n,s,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${s=+s}v${+i}h${-s}Z`}toString(){return this._}}function RI(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const s=Math.floor(n);if(!(s>=0))throw new RangeError(`invalid digits: ${n}`);t=s}return e},()=>new Exe(t)}function LI(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function e7(e){this._context=e}e7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function H2(e){return new e7(e)}function t7(e){return e[0]}function r7(e){return e[1]}function n7(e,t){var n=ms(!0),s=null,i=H2,c=null,u=RI(a);e=typeof e=="function"?e:e===void 0?t7:ms(e),t=typeof t=="function"?t:t===void 0?r7:ms(t);function a(m){var p,y=(m=LI(m)).length,v,j=!1,S;for(s==null&&(c=i(S=u())),p=0;p<=y;++p)!(p<y&&n(v=m[p],p,m))===j&&((j=!j)?c.lineStart():c.lineEnd()),j&&c.point(+e(v,p,m),+t(v,p,m));if(S)return c=null,S+""||null}return a.x=function(m){return arguments.length?(e=typeof m=="function"?m:ms(+m),a):e},a.y=function(m){return arguments.length?(t=typeof m=="function"?m:ms(+m),a):t},a.defined=function(m){return arguments.length?(n=typeof m=="function"?m:ms(!!m),a):n},a.curve=function(m){return arguments.length?(i=m,s!=null&&(c=i(s)),a):i},a.context=function(m){return arguments.length?(m==null?s=c=null:c=i(s=m),a):s},a}function e1(e,t,n){var s=null,i=ms(!0),c=null,u=H2,a=null,m=RI(p);e=typeof e=="function"?e:e===void 0?t7:ms(+e),t=typeof t=="function"?t:ms(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?r7:ms(+n);function p(v){var j,S,k,N=(v=LI(v)).length,D,O=!1,T,I=new Array(N),z=new Array(N);for(c==null&&(a=u(T=m())),j=0;j<=N;++j){if(!(j<N&&i(D=v[j],j,v))===O)if(O=!O)S=j,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),k=j-1;k>=S;--k)a.point(I[k],z[k]);a.lineEnd(),a.areaEnd()}O&&(I[j]=+e(D,j,v),z[j]=+t(D,j,v),a.point(s?+s(D,j,v):I[j],n?+n(D,j,v):z[j]))}if(T)return a=null,T+""||null}function y(){return n7().defined(i).curve(u).context(c)}return p.x=function(v){return arguments.length?(e=typeof v=="function"?v:ms(+v),s=null,p):e},p.x0=function(v){return arguments.length?(e=typeof v=="function"?v:ms(+v),p):e},p.x1=function(v){return arguments.length?(s=v==null?null:typeof v=="function"?v:ms(+v),p):s},p.y=function(v){return arguments.length?(t=typeof v=="function"?v:ms(+v),n=null,p):t},p.y0=function(v){return arguments.length?(t=typeof v=="function"?v:ms(+v),p):t},p.y1=function(v){return arguments.length?(n=v==null?null:typeof v=="function"?v:ms(+v),p):n},p.lineX0=p.lineY0=function(){return y().x(e).y(t)},p.lineY1=function(){return y().x(e).y(n)},p.lineX1=function(){return y().x(s).y(t)},p.defined=function(v){return arguments.length?(i=typeof v=="function"?v:ms(!!v),p):i},p.curve=function(v){return arguments.length?(u=v,c!=null&&(a=u(c)),p):u},p.context=function(v){return arguments.length?(v==null?c=a=null:a=u(c=v),p):c},p}class s7{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function Mxe(e){return new s7(e,!0)}function Oxe(e){return new s7(e,!1)}const FI={draw(e,t){const n=bc(t/IS);e.moveTo(n,0),e.arc(0,0,n,0,K2)}},Ixe={draw(e,t){const n=bc(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},i7=bc(1/3),Dxe=i7*2,Rxe={draw(e,t){const n=bc(t/Dxe),s=n*i7;e.moveTo(0,-n),e.lineTo(s,0),e.lineTo(0,n),e.lineTo(-s,0),e.closePath()}},Lxe={draw(e,t){const n=bc(t),s=-n/2;e.rect(s,s,n,n)}},Fxe=.8908130915292852,a7=OS(IS/10)/OS(7*IS/10),zxe=OS(K2/10)*a7,$xe=-QW(K2/10)*a7,Bxe={draw(e,t){const n=bc(t*Fxe),s=zxe*n,i=$xe*n;e.moveTo(0,-n),e.lineTo(s,i);for(let c=1;c<5;++c){const u=K2*c/5,a=QW(u),m=OS(u);e.lineTo(m*n,-a*n),e.lineTo(a*s-m*i,m*s+a*i)}e.closePath()}},DA=bc(3),qxe={draw(e,t){const n=-bc(t/(DA*3));e.moveTo(0,n*2),e.lineTo(-DA*n,-n),e.lineTo(DA*n,-n),e.closePath()}},ul=-.5,dl=bc(3)/2,oE=1/bc(12),Vxe=(oE/2+1)*3,Uxe={draw(e,t){const n=bc(t/Vxe),s=n/2,i=n*oE,c=s,u=n*oE+n,a=-c,m=u;e.moveTo(s,i),e.lineTo(c,u),e.lineTo(a,m),e.lineTo(ul*s-dl*i,dl*s+ul*i),e.lineTo(ul*c-dl*u,dl*c+ul*u),e.lineTo(ul*a-dl*m,dl*a+ul*m),e.lineTo(ul*s+dl*i,ul*i-dl*s),e.lineTo(ul*c+dl*u,ul*u-dl*c),e.lineTo(ul*a+dl*m,ul*m-dl*a),e.closePath()}};function Wxe(e,t){let n=null,s=RI(i);e=typeof e=="function"?e:ms(e||FI),t=typeof t=="function"?t:ms(t===void 0?64:+t);function i(){let c;if(n||(n=c=s()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),c)return n=null,c+""||null}return i.type=function(c){return arguments.length?(e=typeof c=="function"?c:ms(c),i):e},i.size=function(c){return arguments.length?(t=typeof c=="function"?c:ms(+c),i):t},i.context=function(c){return arguments.length?(n=c??null,i):n},i}function DS(){}function RS(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function o7(e){this._context=e}o7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:RS(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:RS(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Gxe(e){return new o7(e)}function l7(e){this._context=e}l7.prototype={areaStart:DS,areaEnd:DS,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:RS(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Kxe(e){return new l7(e)}function c7(e){this._context=e}c7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,s=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,s):this._context.moveTo(n,s);break;case 3:this._point=4;default:RS(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Hxe(e){return new c7(e)}function u7(e){this._context=e}u7.prototype={areaStart:DS,areaEnd:DS,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Zxe(e){return new u7(e)}function BF(e){return e<0?-1:1}function qF(e,t,n){var s=e._x1-e._x0,i=t-e._x1,c=(e._y1-e._y0)/(s||i<0&&-0),u=(n-e._y1)/(i||s<0&&-0),a=(c*i+u*s)/(s+i);return(BF(c)+BF(u))*Math.min(Math.abs(c),Math.abs(u),.5*Math.abs(a))||0}function VF(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function RA(e,t,n){var s=e._x0,i=e._y0,c=e._x1,u=e._y1,a=(c-s)/3;e._context.bezierCurveTo(s+a,i+a*t,c-a,u-a*n,c,u)}function LS(e){this._context=e}LS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:RA(this,this._t0,VF(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,RA(this,VF(this,n=qF(this,e,t)),n);break;default:RA(this,this._t0,n=qF(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function d7(e){this._context=new h7(e)}(d7.prototype=Object.create(LS.prototype)).point=function(e,t){LS.prototype.point.call(this,t,e)};function h7(e){this._context=e}h7.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,s,i,c){this._context.bezierCurveTo(t,e,s,n,c,i)}};function Yxe(e){return new LS(e)}function Xxe(e){return new d7(e)}function f7(e){this._context=e}f7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var s=UF(e),i=UF(t),c=0,u=1;u<n;++c,++u)this._context.bezierCurveTo(s[0][c],i[0][c],s[1][c],i[1][c],e[u],t[u]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function UF(e){var t,n=e.length-1,s,i=new Array(n),c=new Array(n),u=new Array(n);for(i[0]=0,c[0]=2,u[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,c[t]=4,u[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,c[n-1]=7,u[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)s=i[t]/c[t-1],c[t]-=s,u[t]-=s*u[t-1];for(i[n-1]=u[n-1]/c[n-1],t=n-2;t>=0;--t)i[t]=(u[t]-i[t+1])/c[t];for(c[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)c[t]=2*e[t+1]-i[t+1];return[i,c]}function Qxe(e){return new f7(e)}function Z2(e,t){this._context=e,this._t=t}Z2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function Jxe(e){return new Z2(e,.5)}function eye(e){return new Z2(e,0)}function tye(e){return new Z2(e,1)}function zx(e,t){if((u=e.length)>1)for(var n=1,s,i,c=e[t[0]],u,a=c.length;n<u;++n)for(i=c,c=e[t[n]],s=0;s<a;++s)c[s][1]+=c[s][0]=isNaN(i[s][1])?i[s][0]:i[s][1]}function lE(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function rye(e,t){return e[t]}function nye(e){const t=[];return t.key=e,t}function sye(){var e=ms([]),t=lE,n=zx,s=rye;function i(c){var u=Array.from(e.apply(this,arguments),nye),a,m=u.length,p=-1,y;for(const v of c)for(a=0,++p;a<m;++a)(u[a][p]=[0,+s(v,u[a].key,p,c)]).data=v;for(a=0,y=LI(t(u));a<m;++a)u[y[a]].index=a;return n(u,y),u}return i.keys=function(c){return arguments.length?(e=typeof c=="function"?c:ms(Array.from(c)),i):e},i.value=function(c){return arguments.length?(s=typeof c=="function"?c:ms(+c),i):s},i.order=function(c){return arguments.length?(t=c==null?lE:typeof c=="function"?c:ms(Array.from(c)),i):t},i.offset=function(c){return arguments.length?(n=c??zx,i):n},i}function iye(e,t){if((s=e.length)>0){for(var n,s,i=0,c=e[0].length,u;i<c;++i){for(u=n=0;n<s;++n)u+=e[n][i][1]||0;if(u)for(n=0;n<s;++n)e[n][i][1]/=u}zx(e,t)}}function aye(e,t){if((i=e.length)>0){for(var n=0,s=e[t[0]],i,c=s.length;n<c;++n){for(var u=0,a=0;u<i;++u)a+=e[u][n][1]||0;s[n][1]+=s[n][0]=-a/2}zx(e,t)}}function oye(e,t){if(!(!((u=e.length)>0)||!((c=(i=e[t[0]]).length)>0))){for(var n=0,s=1,i,c,u;s<c;++s){for(var a=0,m=0,p=0;a<u;++a){for(var y=e[t[a]],v=y[s][1]||0,j=y[s-1][1]||0,S=(v-j)/2,k=0;k<a;++k){var N=e[t[k]],D=N[s][1]||0,O=N[s-1][1]||0;S+=D-O}m+=v,p+=S*v}i[s-1][1]+=i[s-1][0]=n,m&&(n-=p/m)}i[s-1][1]+=i[s-1][0]=n,zx(e,t)}}function L0(e){"@babel/helpers - typeof";return L0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L0(e)}var lye=["type","size","sizeType"];function cE(){return cE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},cE.apply(this,arguments)}function WF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function GF(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?WF(Object(n),!0).forEach(function(s){cye(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function cye(e,t,n){return t=uye(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uye(e){var t=dye(e,"string");return L0(t)=="symbol"?t:t+""}function dye(e,t){if(L0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(L0(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hye(e,t){if(e==null)return{};var n=fye(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function fye(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}var m7={symbolCircle:FI,symbolCross:Ixe,symbolDiamond:Rxe,symbolSquare:Lxe,symbolStar:Bxe,symbolTriangle:qxe,symbolWye:Uxe},mye=Math.PI/180,pye=function(t){var n="symbol".concat(G2(t));return m7[n]||FI},gye=function(t,n,s){if(n==="area")return t;switch(s){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var i=18*mye;return 1.25*t*t*(Math.tan(i)-Math.tan(i*2)*Math.pow(Math.tan(i),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},xye=function(t,n){m7["symbol".concat(G2(t))]=n},zI=function(t){var n=t.type,s=n===void 0?"circle":n,i=t.size,c=i===void 0?64:i,u=t.sizeType,a=u===void 0?"area":u,m=hye(t,lye),p=GF(GF({},m),{},{type:s,size:c,sizeType:a}),y=function(){var D=pye(s),O=Wxe().type(D).size(gye(c,a,s));return O()},v=p.className,j=p.cx,S=p.cy,k=Cr(p,!0);return j===+j&&S===+S&&c===+c?de.createElement("path",cE({},k,{className:Yr("recharts-symbols",v),transform:"translate(".concat(j,", ").concat(S,")"),d:y()})):null};zI.registerSymbol=xye;function $x(e){"@babel/helpers - typeof";return $x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$x(e)}function uE(){return uE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},uE.apply(this,arguments)}function KF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function yye(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?KF(Object(n),!0).forEach(function(s){F0(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):KF(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function vye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _ye(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,g7(s.key),s)}}function bye(e,t,n){return t&&_ye(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function jye(e,t,n){return t=FS(t),wye(e,p7()?Reflect.construct(t,n||[],FS(e).constructor):t.apply(e,n))}function wye(e,t){if(t&&($x(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sye(e)}function Sye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p7(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(p7=function(){return!!e})()}function FS(e){return FS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},FS(e)}function Nye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dE(e,t)}function dE(e,t){return dE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},dE(e,t)}function F0(e,t,n){return t=g7(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g7(e){var t=Pye(e,"string");return $x(t)=="symbol"?t:t+""}function Pye(e,t){if($x(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if($x(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var hl=32,$I=function(e){function t(){return vye(this,t),jye(this,t,arguments)}return Nye(t,e),bye(t,[{key:"renderIcon",value:function(s){var i=this.props.inactiveColor,c=hl/2,u=hl/6,a=hl/3,m=s.inactive?i:s.color;if(s.type==="plainline")return de.createElement("line",{strokeWidth:4,fill:"none",stroke:m,strokeDasharray:s.payload.strokeDasharray,x1:0,y1:c,x2:hl,y2:c,className:"recharts-legend-icon"});if(s.type==="line")return de.createElement("path",{strokeWidth:4,fill:"none",stroke:m,d:"M0,".concat(c,"h").concat(a,`
            A`).concat(u,",").concat(u,",0,1,1,").concat(2*a,",").concat(c,`
            H`).concat(hl,"M").concat(2*a,",").concat(c,`
            A`).concat(u,",").concat(u,",0,1,1,").concat(a,",").concat(c),className:"recharts-legend-icon"});if(s.type==="rect")return de.createElement("path",{stroke:"none",fill:m,d:"M0,".concat(hl/8,"h").concat(hl,"v").concat(hl*3/4,"h").concat(-hl,"z"),className:"recharts-legend-icon"});if(de.isValidElement(s.legendIcon)){var p=yye({},s);return delete p.legendIcon,de.cloneElement(s.legendIcon,p)}return de.createElement(zI,{fill:m,cx:c,cy:c,size:hl,sizeType:"diameter",type:s.type})}},{key:"renderItems",value:function(){var s=this,i=this.props,c=i.payload,u=i.iconSize,a=i.layout,m=i.formatter,p=i.inactiveColor,y={x:0,y:0,width:hl,height:hl},v={display:a==="horizontal"?"inline-block":"block",marginRight:10},j={display:"inline-block",verticalAlign:"middle",marginRight:4};return c.map(function(S,k){var N=S.formatter||m,D=Yr(F0(F0({"recharts-legend-item":!0},"legend-item-".concat(k),!0),"inactive",S.inactive));if(S.type==="none")return null;var O=Br(S.value)?null:S.value;pc(!Br(S.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var T=S.inactive?p:S.color;return de.createElement("li",uE({className:D,style:v,key:"legend-item-".concat(k)},Wm(s.props,S,k)),de.createElement(tE,{width:u,height:u,viewBox:y,style:j},s.renderIcon(S)),de.createElement("span",{className:"recharts-legend-item-text",style:{color:T}},N?N(O,S,k):O))})}},{key:"render",value:function(){var s=this.props,i=s.payload,c=s.layout,u=s.align;if(!i||!i.length)return null;var a={padding:0,margin:0,textAlign:c==="horizontal"?u:"left"};return de.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}])}(R.PureComponent);F0($I,"displayName","Legend");F0($I,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var Cye=O2;function Aye(){this.__data__=new Cye,this.size=0}var kye=Aye;function Tye(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}var Eye=Tye;function Mye(e){return this.__data__.get(e)}var Oye=Mye;function Iye(e){return this.__data__.has(e)}var Dye=Iye,Rye=O2,Lye=CI,Fye=AI,zye=200;function $ye(e,t){var n=this.__data__;if(n instanceof Rye){var s=n.__data__;if(!Lye||s.length<zye-1)return s.push([e,t]),this.size=++n.size,this;n=this.__data__=new Fye(s)}return n.set(e,t),this.size=n.size,this}var Bye=$ye,qye=O2,Vye=kye,Uye=Eye,Wye=Oye,Gye=Dye,Kye=Bye;function Fy(e){var t=this.__data__=new qye(e);this.size=t.size}Fy.prototype.clear=Vye;Fy.prototype.delete=Uye;Fy.prototype.get=Wye;Fy.prototype.has=Gye;Fy.prototype.set=Kye;var x7=Fy,Hye="__lodash_hash_undefined__";function Zye(e){return this.__data__.set(e,Hye),this}var Yye=Zye;function Xye(e){return this.__data__.has(e)}var Qye=Xye,Jye=AI,eve=Yye,tve=Qye;function zS(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new Jye;++t<n;)this.add(e[t])}zS.prototype.add=zS.prototype.push=eve;zS.prototype.has=tve;var y7=zS;function rve(e,t){for(var n=-1,s=e==null?0:e.length;++n<s;)if(t(e[n],n,e))return!0;return!1}var v7=rve;function nve(e,t){return e.has(t)}var _7=nve,sve=y7,ive=v7,ave=_7,ove=1,lve=2;function cve(e,t,n,s,i,c){var u=n&ove,a=e.length,m=t.length;if(a!=m&&!(u&&m>a))return!1;var p=c.get(e),y=c.get(t);if(p&&y)return p==t&&y==e;var v=-1,j=!0,S=n&lve?new sve:void 0;for(c.set(e,t),c.set(t,e);++v<a;){var k=e[v],N=t[v];if(s)var D=u?s(N,k,v,t,e,c):s(k,N,v,e,t,c);if(D!==void 0){if(D)continue;j=!1;break}if(S){if(!ive(t,function(O,T){if(!ave(S,T)&&(k===O||i(k,O,n,s,c)))return S.push(T)})){j=!1;break}}else if(!(k===N||i(k,N,n,s,c))){j=!1;break}}return c.delete(e),c.delete(t),j}var b7=cve,uve=au,dve=uve.Uint8Array,hve=dve;function fve(e){var t=-1,n=Array(e.size);return e.forEach(function(s,i){n[++t]=[i,s]}),n}var mve=fve;function pve(e){var t=-1,n=Array(e.size);return e.forEach(function(s){n[++t]=s}),n}var BI=pve,HF=$b,ZF=hve,gve=PI,xve=b7,yve=mve,vve=BI,_ve=1,bve=2,jve="[object Boolean]",wve="[object Date]",Sve="[object Error]",Nve="[object Map]",Pve="[object Number]",Cve="[object RegExp]",Ave="[object Set]",kve="[object String]",Tve="[object Symbol]",Eve="[object ArrayBuffer]",Mve="[object DataView]",YF=HF?HF.prototype:void 0,LA=YF?YF.valueOf:void 0;function Ove(e,t,n,s,i,c,u){switch(n){case Mve:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Eve:return!(e.byteLength!=t.byteLength||!c(new ZF(e),new ZF(t)));case jve:case wve:case Pve:return gve(+e,+t);case Sve:return e.name==t.name&&e.message==t.message;case Cve:case kve:return e==t+"";case Nve:var a=yve;case Ave:var m=s&_ve;if(a||(a=vve),e.size!=t.size&&!m)return!1;var p=u.get(e);if(p)return p==t;s|=bve,u.set(e,t);var y=xve(a(e),a(t),s,i,c,u);return u.delete(e),y;case Tve:if(LA)return LA.call(e)==LA.call(t)}return!1}var Ive=Ove;function Dve(e,t){for(var n=-1,s=t.length,i=e.length;++n<s;)e[i+n]=t[n];return e}var j7=Dve,Rve=j7,Lve=No;function Fve(e,t,n){var s=t(e);return Lve(e)?s:Rve(s,n(e))}var zve=Fve;function $ve(e,t){for(var n=-1,s=e==null?0:e.length,i=0,c=[];++n<s;){var u=e[n];t(u,n,e)&&(c[i++]=u)}return c}var Bve=$ve;function qve(){return[]}var Vve=qve,Uve=Bve,Wve=Vve,Gve=Object.prototype,Kve=Gve.propertyIsEnumerable,XF=Object.getOwnPropertySymbols,Hve=XF?function(e){return e==null?[]:(e=Object(e),Uve(XF(e),function(t){return Kve.call(e,t)}))}:Wve,Zve=Hve;function Yve(e,t){for(var n=-1,s=Array(e);++n<e;)s[n]=t(n);return s}var Xve=Yve,Qve=jd,Jve=wd,e_e="[object Arguments]";function t_e(e){return Jve(e)&&Qve(e)==e_e}var r_e=t_e,QF=r_e,n_e=wd,w7=Object.prototype,s_e=w7.hasOwnProperty,i_e=w7.propertyIsEnumerable,a_e=QF(function(){return arguments}())?QF:function(e){return n_e(e)&&s_e.call(e,"callee")&&!i_e.call(e,"callee")},qI=a_e,$S={exports:{}};function o_e(){return!1}var l_e=o_e;$S.exports;(function(e,t){var n=au,s=l_e,i=t&&!t.nodeType&&t,c=i&&!0&&e&&!e.nodeType&&e,u=c&&c.exports===i,a=u?n.Buffer:void 0,m=a?a.isBuffer:void 0,p=m||s;e.exports=p})($S,$S.exports);var S7=$S.exports,c_e=9007199254740991,u_e=/^(?:0|[1-9]\d*)$/;function d_e(e,t){var n=typeof e;return t=t??c_e,!!t&&(n=="number"||n!="symbol"&&u_e.test(e))&&e>-1&&e%1==0&&e<t}var VI=d_e,h_e=9007199254740991;function f_e(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=h_e}var UI=f_e,m_e=jd,p_e=UI,g_e=wd,x_e="[object Arguments]",y_e="[object Array]",v_e="[object Boolean]",__e="[object Date]",b_e="[object Error]",j_e="[object Function]",w_e="[object Map]",S_e="[object Number]",N_e="[object Object]",P_e="[object RegExp]",C_e="[object Set]",A_e="[object String]",k_e="[object WeakMap]",T_e="[object ArrayBuffer]",E_e="[object DataView]",M_e="[object Float32Array]",O_e="[object Float64Array]",I_e="[object Int8Array]",D_e="[object Int16Array]",R_e="[object Int32Array]",L_e="[object Uint8Array]",F_e="[object Uint8ClampedArray]",z_e="[object Uint16Array]",$_e="[object Uint32Array]",Ss={};Ss[M_e]=Ss[O_e]=Ss[I_e]=Ss[D_e]=Ss[R_e]=Ss[L_e]=Ss[F_e]=Ss[z_e]=Ss[$_e]=!0;Ss[x_e]=Ss[y_e]=Ss[T_e]=Ss[v_e]=Ss[E_e]=Ss[__e]=Ss[b_e]=Ss[j_e]=Ss[w_e]=Ss[S_e]=Ss[N_e]=Ss[P_e]=Ss[C_e]=Ss[A_e]=Ss[k_e]=!1;function B_e(e){return g_e(e)&&p_e(e.length)&&!!Ss[m_e(e)]}var q_e=B_e;function V_e(e){return function(t){return e(t)}}var N7=V_e,BS={exports:{}};BS.exports;(function(e,t){var n=MW,s=t&&!t.nodeType&&t,i=s&&!0&&e&&!e.nodeType&&e,c=i&&i.exports===s,u=c&&n.process,a=function(){try{var m=i&&i.require&&i.require("util").types;return m||u&&u.binding&&u.binding("util")}catch{}}();e.exports=a})(BS,BS.exports);var U_e=BS.exports,W_e=q_e,G_e=N7,JF=U_e,ez=JF&&JF.isTypedArray,K_e=ez?G_e(ez):W_e,P7=K_e,H_e=Xve,Z_e=qI,Y_e=No,X_e=S7,Q_e=VI,J_e=P7,e0e=Object.prototype,t0e=e0e.hasOwnProperty;function r0e(e,t){var n=Y_e(e),s=!n&&Z_e(e),i=!n&&!s&&X_e(e),c=!n&&!s&&!i&&J_e(e),u=n||s||i||c,a=u?H_e(e.length,String):[],m=a.length;for(var p in e)(t||t0e.call(e,p))&&!(u&&(p=="length"||i&&(p=="offset"||p=="parent")||c&&(p=="buffer"||p=="byteLength"||p=="byteOffset")||Q_e(p,m)))&&a.push(p);return a}var n0e=r0e,s0e=Object.prototype;function i0e(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||s0e;return e===n}var a0e=i0e;function o0e(e,t){return function(n){return e(t(n))}}var C7=o0e,l0e=C7,c0e=l0e(Object.keys,Object),u0e=c0e,d0e=a0e,h0e=u0e,f0e=Object.prototype,m0e=f0e.hasOwnProperty;function p0e(e){if(!d0e(e))return h0e(e);var t=[];for(var n in Object(e))m0e.call(e,n)&&n!="constructor"&&t.push(n);return t}var g0e=p0e,x0e=NI,y0e=UI;function v0e(e){return e!=null&&y0e(e.length)&&!x0e(e)}var qb=v0e,_0e=n0e,b0e=g0e,j0e=qb;function w0e(e){return j0e(e)?_0e(e):b0e(e)}var Y2=w0e,S0e=zve,N0e=Zve,P0e=Y2;function C0e(e){return S0e(e,P0e,N0e)}var A0e=C0e,tz=A0e,k0e=1,T0e=Object.prototype,E0e=T0e.hasOwnProperty;function M0e(e,t,n,s,i,c){var u=n&k0e,a=tz(e),m=a.length,p=tz(t),y=p.length;if(m!=y&&!u)return!1;for(var v=m;v--;){var j=a[v];if(!(u?j in t:E0e.call(t,j)))return!1}var S=c.get(e),k=c.get(t);if(S&&k)return S==t&&k==e;var N=!0;c.set(e,t),c.set(t,e);for(var D=u;++v<m;){j=a[v];var O=e[j],T=t[j];if(s)var I=u?s(T,O,j,t,e,c):s(O,T,j,e,t,c);if(!(I===void 0?O===T||i(O,T,n,s,c):I)){N=!1;break}D||(D=j=="constructor")}if(N&&!D){var z=e.constructor,$=t.constructor;z!=$&&"constructor"in e&&"constructor"in t&&!(typeof z=="function"&&z instanceof z&&typeof $=="function"&&$ instanceof $)&&(N=!1)}return c.delete(e),c.delete(t),N}var O0e=M0e,I0e=ep,D0e=au,R0e=I0e(D0e,"DataView"),L0e=R0e,F0e=ep,z0e=au,$0e=F0e(z0e,"Promise"),B0e=$0e,q0e=ep,V0e=au,U0e=q0e(V0e,"Set"),A7=U0e,W0e=ep,G0e=au,K0e=W0e(G0e,"WeakMap"),H0e=K0e,hE=L0e,fE=CI,mE=B0e,pE=A7,gE=H0e,k7=jd,zy=IW,rz="[object Map]",Z0e="[object Object]",nz="[object Promise]",sz="[object Set]",iz="[object WeakMap]",az="[object DataView]",Y0e=zy(hE),X0e=zy(fE),Q0e=zy(mE),J0e=zy(pE),ebe=zy(gE),am=k7;(hE&&am(new hE(new ArrayBuffer(1)))!=az||fE&&am(new fE)!=rz||mE&&am(mE.resolve())!=nz||pE&&am(new pE)!=sz||gE&&am(new gE)!=iz)&&(am=function(e){var t=k7(e),n=t==Z0e?e.constructor:void 0,s=n?zy(n):"";if(s)switch(s){case Y0e:return az;case X0e:return rz;case Q0e:return nz;case J0e:return sz;case ebe:return iz}return t});var tbe=am,FA=x7,rbe=b7,nbe=Ive,sbe=O0e,oz=tbe,lz=No,cz=S7,ibe=P7,abe=1,uz="[object Arguments]",dz="[object Array]",t1="[object Object]",obe=Object.prototype,hz=obe.hasOwnProperty;function lbe(e,t,n,s,i,c){var u=lz(e),a=lz(t),m=u?dz:oz(e),p=a?dz:oz(t);m=m==uz?t1:m,p=p==uz?t1:p;var y=m==t1,v=p==t1,j=m==p;if(j&&cz(e)){if(!cz(t))return!1;u=!0,y=!1}if(j&&!y)return c||(c=new FA),u||ibe(e)?rbe(e,t,n,s,i,c):nbe(e,t,m,n,s,i,c);if(!(n&abe)){var S=y&&hz.call(e,"__wrapped__"),k=v&&hz.call(t,"__wrapped__");if(S||k){var N=S?e.value():e,D=k?t.value():t;return c||(c=new FA),i(N,D,n,s,c)}}return j?(c||(c=new FA),sbe(e,t,n,s,i,c)):!1}var cbe=lbe,ube=cbe,fz=wd;function T7(e,t,n,s,i){return e===t?!0:e==null||t==null||!fz(e)&&!fz(t)?e!==e&&t!==t:ube(e,t,n,s,T7,i)}var WI=T7,dbe=x7,hbe=WI,fbe=1,mbe=2;function pbe(e,t,n,s){var i=n.length,c=i,u=!s;if(e==null)return!c;for(e=Object(e);i--;){var a=n[i];if(u&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<c;){a=n[i];var m=a[0],p=e[m],y=a[1];if(u&&a[2]){if(p===void 0&&!(m in e))return!1}else{var v=new dbe;if(s)var j=s(p,y,m,e,t,v);if(!(j===void 0?hbe(y,p,fbe|mbe,s,v):j))return!1}}return!0}var gbe=pbe,xbe=df;function ybe(e){return e===e&&!xbe(e)}var E7=ybe,vbe=E7,_be=Y2;function bbe(e){for(var t=_be(e),n=t.length;n--;){var s=t[n],i=e[s];t[n]=[s,i,vbe(i)]}return t}var jbe=bbe;function wbe(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}var M7=wbe,Sbe=gbe,Nbe=jbe,Pbe=M7;function Cbe(e){var t=Nbe(e);return t.length==1&&t[0][2]?Pbe(t[0][0],t[0][1]):function(n){return n===e||Sbe(n,e,t)}}var Abe=Cbe;function kbe(e,t){return e!=null&&t in Object(e)}var Tbe=kbe,Ebe=zW,Mbe=qI,Obe=No,Ibe=VI,Dbe=UI,Rbe=D2;function Lbe(e,t,n){t=Ebe(t,e);for(var s=-1,i=t.length,c=!1;++s<i;){var u=Rbe(t[s]);if(!(c=e!=null&&n(e,u)))break;e=e[u]}return c||++s!=i?c:(i=e==null?0:e.length,!!i&&Dbe(i)&&Ibe(u,i)&&(Obe(e)||Mbe(e)))}var Fbe=Lbe,zbe=Tbe,$be=Fbe;function Bbe(e,t){return e!=null&&$be(e,t,zbe)}var qbe=Bbe,Vbe=WI,Ube=$W,Wbe=qbe,Gbe=SI,Kbe=E7,Hbe=M7,Zbe=D2,Ybe=1,Xbe=2;function Qbe(e,t){return Gbe(e)&&Kbe(t)?Hbe(Zbe(e),t):function(n){var s=Ube(n,e);return s===void 0&&s===t?Wbe(n,e):Vbe(t,s,Ybe|Xbe)}}var Jbe=Qbe;function eje(e){return e}var $y=eje;function tje(e){return function(t){return t==null?void 0:t[e]}}var rje=tje,nje=EI;function sje(e){return function(t){return nje(t,e)}}var ije=sje,aje=rje,oje=ije,lje=SI,cje=D2;function uje(e){return lje(e)?aje(cje(e)):oje(e)}var dje=uje,hje=Abe,fje=Jbe,mje=$y,pje=No,gje=dje;function xje(e){return typeof e=="function"?e:e==null?mje:typeof e=="object"?pje(e)?fje(e[0],e[1]):hje(e):gje(e)}var ou=xje;function yje(e,t,n,s){for(var i=e.length,c=n+(s?1:-1);s?c--:++c<i;)if(t(e[c],c,e))return c;return-1}var O7=yje;function vje(e){return e!==e}var _je=vje;function bje(e,t,n){for(var s=n-1,i=e.length;++s<i;)if(e[s]===t)return s;return-1}var jje=bje,wje=O7,Sje=_je,Nje=jje;function Pje(e,t,n){return t===t?Nje(e,t,n):wje(e,Sje,n)}var Cje=Pje,Aje=Cje;function kje(e,t){var n=e==null?0:e.length;return!!n&&Aje(e,t,0)>-1}var Tje=kje;function Eje(e,t,n){for(var s=-1,i=e==null?0:e.length;++s<i;)if(n(t,e[s]))return!0;return!1}var Mje=Eje;function Oje(){}var Ije=Oje,zA=A7,Dje=Ije,Rje=BI,Lje=1/0,Fje=zA&&1/Rje(new zA([,-0]))[1]==Lje?function(e){return new zA(e)}:Dje,zje=Fje,$je=y7,Bje=Tje,qje=Mje,Vje=_7,Uje=zje,Wje=BI,Gje=200;function Kje(e,t,n){var s=-1,i=Bje,c=e.length,u=!0,a=[],m=a;if(n)u=!1,i=qje;else if(c>=Gje){var p=t?null:Uje(e);if(p)return Wje(p);u=!1,i=Vje,m=new $je}else m=t?[]:a;e:for(;++s<c;){var y=e[s],v=t?t(y):y;if(y=n||y!==0?y:0,u&&v===v){for(var j=m.length;j--;)if(m[j]===v)continue e;t&&m.push(v),a.push(y)}else i(m,v,n)||(m!==a&&m.push(v),a.push(y))}return a}var Hje=Kje,Zje=ou,Yje=Hje;function Xje(e,t){return e&&e.length?Yje(e,Zje(t)):[]}var Qje=Xje;const mz=Fn(Qje);function I7(e,t,n){return t===!0?mz(e,n):Br(t)?mz(e,t):e}function Bx(e){"@babel/helpers - typeof";return Bx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bx(e)}var Jje=["ref"];function pz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Lu(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pz(Object(n),!0).forEach(function(s){X2(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pz(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function ewe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gz(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,R7(s.key),s)}}function twe(e,t,n){return t&&gz(e.prototype,t),n&&gz(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function rwe(e,t,n){return t=qS(t),nwe(e,D7()?Reflect.construct(t,n||[],qS(e).constructor):t.apply(e,n))}function nwe(e,t){if(t&&(Bx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return swe(e)}function swe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D7(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(D7=function(){return!!e})()}function qS(e){return qS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},qS(e)}function iwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xE(e,t)}function xE(e,t){return xE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},xE(e,t)}function X2(e,t,n){return t=R7(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R7(e){var t=awe(e,"string");return Bx(t)=="symbol"?t:t+""}function awe(e,t){if(Bx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(Bx(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function owe(e,t){if(e==null)return{};var n=lwe(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function lwe(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function cwe(e){return e.value}function uwe(e,t){if(de.isValidElement(e))return de.cloneElement(e,t);if(typeof e=="function")return de.createElement(e,t);t.ref;var n=owe(t,Jje);return de.createElement($I,n)}var xz=1,sa=function(e){function t(){var n;ewe(this,t);for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];return n=rwe(this,t,[].concat(i)),X2(n,"lastBoundingBox",{width:-1,height:-1}),n}return iwe(t,e),twe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var s=this.wrapperNode.getBoundingClientRect();return s.height=this.wrapperNode.offsetHeight,s.width=this.wrapperNode.offsetWidth,s}return null}},{key:"updateBBox",value:function(){var s=this.props.onBBoxUpdate,i=this.getBBox();i?(Math.abs(i.width-this.lastBoundingBox.width)>xz||Math.abs(i.height-this.lastBoundingBox.height)>xz)&&(this.lastBoundingBox.width=i.width,this.lastBoundingBox.height=i.height,s&&s(i)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,s&&s(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Lu({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(s){var i=this.props,c=i.layout,u=i.align,a=i.verticalAlign,m=i.margin,p=i.chartWidth,y=i.chartHeight,v,j;if(!s||(s.left===void 0||s.left===null)&&(s.right===void 0||s.right===null))if(u==="center"&&c==="vertical"){var S=this.getBBoxSnapshot();v={left:((p||0)-S.width)/2}}else v=u==="right"?{right:m&&m.right||0}:{left:m&&m.left||0};if(!s||(s.top===void 0||s.top===null)&&(s.bottom===void 0||s.bottom===null))if(a==="middle"){var k=this.getBBoxSnapshot();j={top:((y||0)-k.height)/2}}else j=a==="bottom"?{bottom:m&&m.bottom||0}:{top:m&&m.top||0};return Lu(Lu({},v),j)}},{key:"render",value:function(){var s=this,i=this.props,c=i.content,u=i.width,a=i.height,m=i.wrapperStyle,p=i.payloadUniqBy,y=i.payload,v=Lu(Lu({position:"absolute",width:u||"auto",height:a||"auto"},this.getDefaultPosition(m)),m);return de.createElement("div",{className:"recharts-legend-wrapper",style:v,ref:function(S){s.wrapperNode=S}},uwe(c,Lu(Lu({},this.props),{},{payload:I7(y,p,cwe)})))}}],[{key:"getWithHeight",value:function(s,i){var c=Lu(Lu({},this.defaultProps),s.props),u=c.layout;return u==="vertical"&&Ut(s.props.height)?{height:s.props.height}:u==="horizontal"?{width:s.props.width||i}:null}}])}(R.PureComponent);X2(sa,"displayName","Legend");X2(sa,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var yz=$b,dwe=qI,hwe=No,vz=yz?yz.isConcatSpreadable:void 0;function fwe(e){return hwe(e)||dwe(e)||!!(vz&&e&&e[vz])}var mwe=fwe,pwe=j7,gwe=mwe;function L7(e,t,n,s,i){var c=-1,u=e.length;for(n||(n=gwe),i||(i=[]);++c<u;){var a=e[c];t>0&&n(a)?t>1?L7(a,t-1,n,s,i):pwe(i,a):s||(i[i.length]=a)}return i}var F7=L7;function xwe(e){return function(t,n,s){for(var i=-1,c=Object(t),u=s(t),a=u.length;a--;){var m=u[e?a:++i];if(n(c[m],m,c)===!1)break}return t}}var ywe=xwe,vwe=ywe,_we=vwe(),bwe=_we,jwe=bwe,wwe=Y2;function Swe(e,t){return e&&jwe(e,t,wwe)}var z7=Swe,Nwe=qb;function Pwe(e,t){return function(n,s){if(n==null)return n;if(!Nwe(n))return e(n,s);for(var i=n.length,c=t?i:-1,u=Object(n);(t?c--:++c<i)&&s(u[c],c,u)!==!1;);return n}}var Cwe=Pwe,Awe=z7,kwe=Cwe,Twe=kwe(Awe),GI=Twe,Ewe=GI,Mwe=qb;function Owe(e,t){var n=-1,s=Mwe(e)?Array(e.length):[];return Ewe(e,function(i,c,u){s[++n]=t(i,c,u)}),s}var $7=Owe;function Iwe(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}var Dwe=Iwe,_z=My;function Rwe(e,t){if(e!==t){var n=e!==void 0,s=e===null,i=e===e,c=_z(e),u=t!==void 0,a=t===null,m=t===t,p=_z(t);if(!a&&!p&&!c&&e>t||c&&u&&m&&!a&&!p||s&&u&&m||!n&&m||!i)return 1;if(!s&&!c&&!p&&e<t||p&&n&&i&&!s&&!c||a&&n&&i||!u&&i||!m)return-1}return 0}var Lwe=Rwe,Fwe=Lwe;function zwe(e,t,n){for(var s=-1,i=e.criteria,c=t.criteria,u=i.length,a=n.length;++s<u;){var m=Fwe(i[s],c[s]);if(m){if(s>=a)return m;var p=n[s];return m*(p=="desc"?-1:1)}}return e.index-t.index}var $we=zwe,$A=TI,Bwe=EI,qwe=ou,Vwe=$7,Uwe=Dwe,Wwe=N7,Gwe=$we,Kwe=$y,Hwe=No;function Zwe(e,t,n){t.length?t=$A(t,function(c){return Hwe(c)?function(u){return Bwe(u,c.length===1?c[0]:c)}:c}):t=[Kwe];var s=-1;t=$A(t,Wwe(qwe));var i=Vwe(e,function(c,u,a){var m=$A(t,function(p){return p(c)});return{criteria:m,index:++s,value:c}});return Uwe(i,function(c,u){return Gwe(c,u,n)})}var Ywe=Zwe;function Xwe(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var Qwe=Xwe,Jwe=Qwe,bz=Math.max;function e1e(e,t,n){return t=bz(t===void 0?e.length-1:t,0),function(){for(var s=arguments,i=-1,c=bz(s.length-t,0),u=Array(c);++i<c;)u[i]=s[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=s[i];return a[t]=n(u),Jwe(e,this,a)}}var t1e=e1e;function r1e(e){return function(){return e}}var n1e=r1e,s1e=ep,i1e=function(){try{var e=s1e(Object,"defineProperty");return e({},"",{}),e}catch{}}(),B7=i1e,a1e=n1e,jz=B7,o1e=$y,l1e=jz?function(e,t){return jz(e,"toString",{configurable:!0,enumerable:!1,value:a1e(t),writable:!0})}:o1e,c1e=l1e,u1e=800,d1e=16,h1e=Date.now;function f1e(e){var t=0,n=0;return function(){var s=h1e(),i=d1e-(s-n);if(n=s,i>0){if(++t>=u1e)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var m1e=f1e,p1e=c1e,g1e=m1e,x1e=g1e(p1e),y1e=x1e,v1e=$y,_1e=t1e,b1e=y1e;function j1e(e,t){return b1e(_1e(e,t,v1e),e+"")}var w1e=j1e,S1e=PI,N1e=qb,P1e=VI,C1e=df;function A1e(e,t,n){if(!C1e(n))return!1;var s=typeof t;return(s=="number"?N1e(n)&&P1e(t,n.length):s=="string"&&t in n)?S1e(n[t],e):!1}var Q2=A1e,k1e=F7,T1e=Ywe,E1e=w1e,wz=Q2,M1e=E1e(function(e,t){if(e==null)return[];var n=t.length;return n>1&&wz(e,t[0],t[1])?t=[]:n>2&&wz(t[0],t[1],t[2])&&(t=[t[0]]),T1e(e,k1e(t,1),[])}),O1e=M1e;const KI=Fn(O1e);function z0(e){"@babel/helpers - typeof";return z0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z0(e)}function yE(){return yE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},yE.apply(this,arguments)}function I1e(e,t){return F1e(e)||L1e(e,t)||R1e(e,t)||D1e()}function D1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R1e(e,t){if(e){if(typeof e=="string")return Sz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Sz(e,t)}}function Sz(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function L1e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,c,u,a=[],m=!0,p=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(m=(s=c.call(n)).done)&&(a.push(s.value),a.length!==t);m=!0);}catch(y){p=!0,i=y}finally{try{if(!m&&n.return!=null&&(u=n.return(),Object(u)!==u))return}finally{if(p)throw i}}return a}}function F1e(e){if(Array.isArray(e))return e}function Nz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function BA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Nz(Object(n),!0).forEach(function(s){z1e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nz(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function z1e(e,t,n){return t=$1e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $1e(e){var t=B1e(e,"string");return z0(t)=="symbol"?t:t+""}function B1e(e,t){if(z0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(z0(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function q1e(e){return Array.isArray(e)&&Ui(e[0])&&Ui(e[1])?e.join(" ~ "):e}var V1e=function(t){var n=t.separator,s=n===void 0?" : ":n,i=t.contentStyle,c=i===void 0?{}:i,u=t.itemStyle,a=u===void 0?{}:u,m=t.labelStyle,p=m===void 0?{}:m,y=t.payload,v=t.formatter,j=t.itemSorter,S=t.wrapperClassName,k=t.labelClassName,N=t.label,D=t.labelFormatter,O=t.accessibilityLayer,T=O===void 0?!1:O,I=function(){if(y&&y.length){var pe={padding:0,margin:0},Oe=(j?KI(y,j):y).map(function(Me,Xe){if(Me.type==="none")return null;var Ve=BA({display:"block",paddingTop:4,paddingBottom:4,color:Me.color||"#000"},a),et=Me.formatter||v||q1e,Ce=Me.value,_e=Me.name,tt=Ce,vt=_e;if(et&&tt!=null&&vt!=null){var gt=et(Ce,_e,Me,Xe,y);if(Array.isArray(gt)){var Tt=I1e(gt,2);tt=Tt[0],vt=Tt[1]}else tt=gt}return de.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(Xe),style:Ve},Ui(vt)?de.createElement("span",{className:"recharts-tooltip-item-name"},vt):null,Ui(vt)?de.createElement("span",{className:"recharts-tooltip-item-separator"},s):null,de.createElement("span",{className:"recharts-tooltip-item-value"},tt),de.createElement("span",{className:"recharts-tooltip-item-unit"},Me.unit||""))});return de.createElement("ul",{className:"recharts-tooltip-item-list",style:pe},Oe)}return null},z=BA({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},c),$=BA({margin:0},p),V=!Zr(N),K=V?N:"",te=Yr("recharts-default-tooltip",S),X=Yr("recharts-tooltip-label",k);V&&D&&y!==void 0&&y!==null&&(K=D(N,y));var ve=T?{role:"status","aria-live":"assertive"}:{};return de.createElement("div",yE({className:te,style:z},ve),de.createElement("p",{className:X,style:$},de.isValidElement(K)?K:"".concat(K)),I())};function $0(e){"@babel/helpers - typeof";return $0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$0(e)}function r1(e,t,n){return t=U1e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U1e(e){var t=W1e(e,"string");return $0(t)=="symbol"?t:t+""}function W1e(e,t){if($0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if($0(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var N_="recharts-tooltip-wrapper",G1e={visibility:"hidden"};function K1e(e){var t=e.coordinate,n=e.translateX,s=e.translateY;return Yr(N_,r1(r1(r1(r1({},"".concat(N_,"-right"),Ut(n)&&t&&Ut(t.x)&&n>=t.x),"".concat(N_,"-left"),Ut(n)&&t&&Ut(t.x)&&n<t.x),"".concat(N_,"-bottom"),Ut(s)&&t&&Ut(t.y)&&s>=t.y),"".concat(N_,"-top"),Ut(s)&&t&&Ut(t.y)&&s<t.y))}function Pz(e){var t=e.allowEscapeViewBox,n=e.coordinate,s=e.key,i=e.offsetTopLeft,c=e.position,u=e.reverseDirection,a=e.tooltipDimension,m=e.viewBox,p=e.viewBoxDimension;if(c&&Ut(c[s]))return c[s];var y=n[s]-a-i,v=n[s]+i;if(t[s])return u[s]?y:v;if(u[s]){var j=y,S=m[s];return j<S?Math.max(v,m[s]):Math.max(y,m[s])}var k=v+a,N=m[s]+p;return k>N?Math.max(y,m[s]):Math.max(v,m[s])}function H1e(e){var t=e.translateX,n=e.translateY,s=e.useTranslate3d;return{transform:s?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function Z1e(e){var t=e.allowEscapeViewBox,n=e.coordinate,s=e.offsetTopLeft,i=e.position,c=e.reverseDirection,u=e.tooltipBox,a=e.useTranslate3d,m=e.viewBox,p,y,v;return u.height>0&&u.width>0&&n?(y=Pz({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:s,position:i,reverseDirection:c,tooltipDimension:u.width,viewBox:m,viewBoxDimension:m.width}),v=Pz({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:s,position:i,reverseDirection:c,tooltipDimension:u.height,viewBox:m,viewBoxDimension:m.height}),p=H1e({translateX:y,translateY:v,useTranslate3d:a})):p=G1e,{cssProperties:p,cssClasses:K1e({translateX:y,translateY:v,coordinate:n})}}function qx(e){"@babel/helpers - typeof";return qx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qx(e)}function Cz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Az(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Cz(Object(n),!0).forEach(function(s){_E(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cz(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Y1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X1e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,V7(s.key),s)}}function Q1e(e,t,n){return t&&X1e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function J1e(e,t,n){return t=VS(t),eSe(e,q7()?Reflect.construct(t,n||[],VS(e).constructor):t.apply(e,n))}function eSe(e,t){if(t&&(qx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tSe(e)}function tSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function q7(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(q7=function(){return!!e})()}function VS(e){return VS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},VS(e)}function rSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vE(e,t)}function vE(e,t){return vE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},vE(e,t)}function _E(e,t,n){return t=V7(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V7(e){var t=nSe(e,"string");return qx(t)=="symbol"?t:t+""}function nSe(e,t){if(qx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(qx(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var kz=1,sSe=function(e){function t(){var n;Y1e(this,t);for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];return n=J1e(this,t,[].concat(i)),_E(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),_E(n,"handleKeyDown",function(u){if(u.key==="Escape"){var a,m,p,y;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(a=(m=n.props.coordinate)===null||m===void 0?void 0:m.x)!==null&&a!==void 0?a:0,y:(p=(y=n.props.coordinate)===null||y===void 0?void 0:y.y)!==null&&p!==void 0?p:0}})}}),n}return rSe(t,e),Q1e(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var s=this.wrapperNode.getBoundingClientRect();(Math.abs(s.width-this.state.lastBoundingBox.width)>kz||Math.abs(s.height-this.state.lastBoundingBox.height)>kz)&&this.setState({lastBoundingBox:{width:s.width,height:s.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var s,i;this.props.active&&this.updateBBox(),this.state.dismissed&&(((s=this.props.coordinate)===null||s===void 0?void 0:s.x)!==this.state.dismissedAtCoordinate.x||((i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var s=this,i=this.props,c=i.active,u=i.allowEscapeViewBox,a=i.animationDuration,m=i.animationEasing,p=i.children,y=i.coordinate,v=i.hasPayload,j=i.isAnimationActive,S=i.offset,k=i.position,N=i.reverseDirection,D=i.useTranslate3d,O=i.viewBox,T=i.wrapperStyle,I=Z1e({allowEscapeViewBox:u,coordinate:y,offsetTopLeft:S,position:k,reverseDirection:N,tooltipBox:this.state.lastBoundingBox,useTranslate3d:D,viewBox:O}),z=I.cssClasses,$=I.cssProperties,V=Az(Az({transition:j&&c?"transform ".concat(a,"ms ").concat(m):void 0},$),{},{pointerEvents:"none",visibility:!this.state.dismissed&&c&&v?"visible":"hidden",position:"absolute",top:0,left:0},T);return de.createElement("div",{tabIndex:-1,className:z,style:V,ref:function(te){s.wrapperNode=te}},p)}}])}(R.PureComponent),iSe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Sd={isSsr:iSe()};function Vx(e){"@babel/helpers - typeof";return Vx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vx(e)}function Tz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Ez(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Tz(Object(n),!0).forEach(function(s){HI(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tz(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function aSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oSe(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,W7(s.key),s)}}function lSe(e,t,n){return t&&oSe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function cSe(e,t,n){return t=US(t),uSe(e,U7()?Reflect.construct(t,n||[],US(e).constructor):t.apply(e,n))}function uSe(e,t){if(t&&(Vx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dSe(e)}function dSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U7(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(U7=function(){return!!e})()}function US(e){return US=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},US(e)}function hSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bE(e,t)}function bE(e,t){return bE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},bE(e,t)}function HI(e,t,n){return t=W7(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function W7(e){var t=fSe(e,"string");return Vx(t)=="symbol"?t:t+""}function fSe(e,t){if(Vx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(Vx(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function mSe(e){return e.dataKey}function pSe(e,t){return de.isValidElement(e)?de.cloneElement(e,t):typeof e=="function"?de.createElement(e,t):de.createElement(V1e,t)}var Ds=function(e){function t(){return aSe(this,t),cSe(this,t,arguments)}return hSe(t,e),lSe(t,[{key:"render",value:function(){var s=this,i=this.props,c=i.active,u=i.allowEscapeViewBox,a=i.animationDuration,m=i.animationEasing,p=i.content,y=i.coordinate,v=i.filterNull,j=i.isAnimationActive,S=i.offset,k=i.payload,N=i.payloadUniqBy,D=i.position,O=i.reverseDirection,T=i.useTranslate3d,I=i.viewBox,z=i.wrapperStyle,$=k??[];v&&$.length&&($=I7(k.filter(function(K){return K.value!=null&&(K.hide!==!0||s.props.includeHidden)}),N,mSe));var V=$.length>0;return de.createElement(sSe,{allowEscapeViewBox:u,animationDuration:a,animationEasing:m,isAnimationActive:j,active:c,coordinate:y,hasPayload:V,offset:S,position:D,reverseDirection:O,useTranslate3d:T,viewBox:I,wrapperStyle:z},pSe(p,Ez(Ez({},this.props),{},{payload:$})))}}])}(R.PureComponent);HI(Ds,"displayName","Tooltip");HI(Ds,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Sd.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var gSe=au,xSe=function(){return gSe.Date.now()},ySe=xSe,vSe=/\s/;function _Se(e){for(var t=e.length;t--&&vSe.test(e.charAt(t)););return t}var bSe=_Se,jSe=bSe,wSe=/^\s+/;function SSe(e){return e&&e.slice(0,jSe(e)+1).replace(wSe,"")}var NSe=SSe,PSe=NSe,Mz=df,CSe=My,Oz=NaN,ASe=/^[-+]0x[0-9a-f]+$/i,kSe=/^0b[01]+$/i,TSe=/^0o[0-7]+$/i,ESe=parseInt;function MSe(e){if(typeof e=="number")return e;if(CSe(e))return Oz;if(Mz(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Mz(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=PSe(e);var n=kSe.test(e);return n||TSe.test(e)?ESe(e.slice(2),n?2:8):ASe.test(e)?Oz:+e}var G7=MSe,OSe=df,qA=ySe,Iz=G7,ISe="Expected a function",DSe=Math.max,RSe=Math.min;function LSe(e,t,n){var s,i,c,u,a,m,p=0,y=!1,v=!1,j=!0;if(typeof e!="function")throw new TypeError(ISe);t=Iz(t)||0,OSe(n)&&(y=!!n.leading,v="maxWait"in n,c=v?DSe(Iz(n.maxWait)||0,t):c,j="trailing"in n?!!n.trailing:j);function S(V){var K=s,te=i;return s=i=void 0,p=V,u=e.apply(te,K),u}function k(V){return p=V,a=setTimeout(O,t),y?S(V):u}function N(V){var K=V-m,te=V-p,X=t-K;return v?RSe(X,c-te):X}function D(V){var K=V-m,te=V-p;return m===void 0||K>=t||K<0||v&&te>=c}function O(){var V=qA();if(D(V))return T(V);a=setTimeout(O,N(V))}function T(V){return a=void 0,j&&s?S(V):(s=i=void 0,u)}function I(){a!==void 0&&clearTimeout(a),p=0,s=m=i=a=void 0}function z(){return a===void 0?u:T(qA())}function $(){var V=qA(),K=D(V);if(s=arguments,i=this,m=V,K){if(a===void 0)return k(m);if(v)return clearTimeout(a),a=setTimeout(O,t),S(m)}return a===void 0&&(a=setTimeout(O,t)),u}return $.cancel=I,$.flush=z,$}var FSe=LSe,zSe=FSe,$Se=df,BSe="Expected a function";function qSe(e,t,n){var s=!0,i=!0;if(typeof e!="function")throw new TypeError(BSe);return $Se(n)&&(s="leading"in n?!!n.leading:s,i="trailing"in n?!!n.trailing:i),zSe(e,t,{leading:s,maxWait:t,trailing:i})}var VSe=qSe;const K7=Fn(VSe);function B0(e){"@babel/helpers - typeof";return B0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B0(e)}function Dz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function n1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Dz(Object(n),!0).forEach(function(s){USe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dz(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function USe(e,t,n){return t=WSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WSe(e){var t=GSe(e,"string");return B0(t)=="symbol"?t:t+""}function GSe(e,t){if(B0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(B0(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KSe(e,t){return XSe(e)||YSe(e,t)||ZSe(e,t)||HSe()}function HSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZSe(e,t){if(e){if(typeof e=="string")return Rz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rz(e,t)}}function Rz(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function YSe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,c,u,a=[],m=!0,p=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(m=(s=c.call(n)).done)&&(a.push(s.value),a.length!==t);m=!0);}catch(y){p=!0,i=y}finally{try{if(!m&&n.return!=null&&(u=n.return(),Object(u)!==u))return}finally{if(p)throw i}}return a}}function XSe(e){if(Array.isArray(e))return e}var Da=R.forwardRef(function(e,t){var n=e.aspect,s=e.initialDimension,i=s===void 0?{width:-1,height:-1}:s,c=e.width,u=c===void 0?"100%":c,a=e.height,m=a===void 0?"100%":a,p=e.minWidth,y=p===void 0?0:p,v=e.minHeight,j=e.maxHeight,S=e.children,k=e.debounce,N=k===void 0?0:k,D=e.id,O=e.className,T=e.onResize,I=e.style,z=I===void 0?{}:I,$=R.useRef(null),V=R.useRef();V.current=T,R.useImperativeHandle(t,function(){return Object.defineProperty($.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),$.current},configurable:!0})});var K=R.useState({containerWidth:i.width,containerHeight:i.height}),te=KSe(K,2),X=te[0],ve=te[1],ae=R.useCallback(function(Oe,Me){ve(function(Xe){var Ve=Math.round(Oe),et=Math.round(Me);return Xe.containerWidth===Ve&&Xe.containerHeight===et?Xe:{containerWidth:Ve,containerHeight:et}})},[]);R.useEffect(function(){var Oe=function(_e){var tt,vt=_e[0].contentRect,gt=vt.width,Tt=vt.height;ae(gt,Tt),(tt=V.current)===null||tt===void 0||tt.call(V,gt,Tt)};N>0&&(Oe=K7(Oe,N,{trailing:!0,leading:!1}));var Me=new ResizeObserver(Oe),Xe=$.current.getBoundingClientRect(),Ve=Xe.width,et=Xe.height;return ae(Ve,et),Me.observe($.current),function(){Me.disconnect()}},[ae,N]);var pe=R.useMemo(function(){var Oe=X.containerWidth,Me=X.containerHeight;if(Oe<0||Me<0)return null;pc(fm(u)||fm(m),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,u,m),pc(!n||n>0,"The aspect(%s) must be greater than zero.",n);var Xe=fm(u)?Oe:u,Ve=fm(m)?Me:m;n&&n>0&&(Xe?Ve=Xe/n:Ve&&(Xe=Ve*n),j&&Ve>j&&(Ve=j)),pc(Xe>0||Ve>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,Xe,Ve,u,m,y,v,n);var et=!Array.isArray(S)&&ed(S.type).endsWith("Chart");return de.Children.map(S,function(Ce){return de.isValidElement(Ce)?R.cloneElement(Ce,n1({width:Xe,height:Ve},et?{style:n1({height:"100%",width:"100%",maxHeight:Ve,maxWidth:Xe},Ce.props.style)}:{})):Ce})},[n,S,m,j,v,y,X,u]);return de.createElement("div",{id:D?"".concat(D):void 0,className:Yr("recharts-responsive-container",O),style:n1(n1({},z),{},{width:u,height:m,minWidth:y,minHeight:v,maxHeight:j}),ref:$},pe)}),q0=function(t){return null};q0.displayName="Cell";function V0(e){"@babel/helpers - typeof";return V0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V0(e)}function Lz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function jE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Lz(Object(n),!0).forEach(function(s){QSe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lz(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function QSe(e,t,n){return t=JSe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JSe(e){var t=eNe(e,"string");return V0(t)=="symbol"?t:t+""}function eNe(e,t){if(V0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(V0(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xg={widthCache:{},cacheCount:0},tNe=2e3,rNe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Fz="recharts_measurement_span";function nNe(e){var t=jE({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var e0=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Sd.isSsr)return{width:0,height:0};var s=nNe(n),i=JSON.stringify({text:t,copyStyle:s});if(xg.widthCache[i])return xg.widthCache[i];try{var c=document.getElementById(Fz);c||(c=document.createElement("span"),c.setAttribute("id",Fz),c.setAttribute("aria-hidden","true"),document.body.appendChild(c));var u=jE(jE({},rNe),s);Object.assign(c.style,u),c.textContent="".concat(t);var a=c.getBoundingClientRect(),m={width:a.width,height:a.height};return xg.widthCache[i]=m,++xg.cacheCount>tNe&&(xg.cacheCount=0,xg.widthCache={}),m}catch{return{width:0,height:0}}},sNe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function U0(e){"@babel/helpers - typeof";return U0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U0(e)}function WS(e,t){return lNe(e)||oNe(e,t)||aNe(e,t)||iNe()}function iNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aNe(e,t){if(e){if(typeof e=="string")return zz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zz(e,t)}}function zz(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function oNe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,c,u,a=[],m=!0,p=!1;try{if(c=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;m=!1}else for(;!(m=(s=c.call(n)).done)&&(a.push(s.value),a.length!==t);m=!0);}catch(y){p=!0,i=y}finally{try{if(!m&&n.return!=null&&(u=n.return(),Object(u)!==u))return}finally{if(p)throw i}}return a}}function lNe(e){if(Array.isArray(e))return e}function cNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $z(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,dNe(s.key),s)}}function uNe(e,t,n){return t&&$z(e.prototype,t),n&&$z(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function dNe(e){var t=hNe(e,"string");return U0(t)=="symbol"?t:t+""}function hNe(e,t){if(U0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(U0(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Bz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,qz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,fNe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,mNe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,H7={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},pNe=Object.keys(H7),Rg="NaN";function gNe(e,t){return e*H7[t]}var s1=function(){function e(t,n){cNe(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!fNe.test(n)&&(this.num=NaN,this.unit=""),pNe.includes(n)&&(this.num=gNe(t,n),this.unit="px")}return uNe(e,[{key:"add",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var s,i=(s=mNe.exec(n))!==null&&s!==void 0?s:[],c=WS(i,3),u=c[1],a=c[2];return new e(parseFloat(u),a??"")}}])}();function Z7(e){if(e.includes(Rg))return Rg;for(var t=e;t.includes("*")||t.includes("/");){var n,s=(n=Bz.exec(t))!==null&&n!==void 0?n:[],i=WS(s,4),c=i[1],u=i[2],a=i[3],m=s1.parse(c??""),p=s1.parse(a??""),y=u==="*"?m.multiply(p):m.divide(p);if(y.isNaN())return Rg;t=t.replace(Bz,y.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var v,j=(v=qz.exec(t))!==null&&v!==void 0?v:[],S=WS(j,4),k=S[1],N=S[2],D=S[3],O=s1.parse(k??""),T=s1.parse(D??""),I=N==="+"?O.add(T):O.subtract(T);if(I.isNaN())return Rg;t=t.replace(qz,I.toString())}return t}var Vz=/\(([^()]*)\)/;function xNe(e){for(var t=e;t.includes("(");){var n=Vz.exec(t),s=WS(n,2),i=s[1];t=t.replace(Vz,Z7(i))}return t}function yNe(e){var t=e.replace(/\s+/g,"");return t=xNe(t),t=Z7(t),t}function vNe(e){try{return yNe(e)}catch{return Rg}}function VA(e){var t=vNe(e.slice(5,-1));return t===Rg?"":t}var _Ne=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],bNe=["dx","dy","angle","className","breakAll"];function wE(){return wE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},wE.apply(this,arguments)}function Uz(e,t){if(e==null)return{};var n=jNe(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function jNe(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function Wz(e,t){return PNe(e)||NNe(e,t)||SNe(e,t)||wNe()}function wNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SNe(e,t){if(e){if(typeof e=="string")return Gz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gz(e,t)}}function Gz(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function NNe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,c,u,a=[],m=!0,p=!1;try{if(c=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;m=!1}else for(;!(m=(s=c.call(n)).done)&&(a.push(s.value),a.length!==t);m=!0);}catch(y){p=!0,i=y}finally{try{if(!m&&n.return!=null&&(u=n.return(),Object(u)!==u))return}finally{if(p)throw i}}return a}}function PNe(e){if(Array.isArray(e))return e}var Y7=/[ \f\n\r\t\v\u2028\u2029]+/,X7=function(t){var n=t.children,s=t.breakAll,i=t.style;try{var c=[];Zr(n)||(s?c=n.toString().split(""):c=n.toString().split(Y7));var u=c.map(function(m){return{word:m,width:e0(m,i).width}}),a=s?0:e0("",i).width;return{wordsWithComputedWidth:u,spaceWidth:a}}catch{return null}},CNe=function(t,n,s,i,c){var u=t.maxLines,a=t.children,m=t.style,p=t.breakAll,y=Ut(u),v=a,j=function(){var Xe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Xe.reduce(function(Ve,et){var Ce=et.word,_e=et.width,tt=Ve[Ve.length-1];if(tt&&(i==null||c||tt.width+_e+s<Number(i)))tt.words.push(Ce),tt.width+=_e+s;else{var vt={words:[Ce],width:_e};Ve.push(vt)}return Ve},[])},S=j(n),k=function(Xe){return Xe.reduce(function(Ve,et){return Ve.width>et.width?Ve:et})};if(!y)return S;for(var N="",D=function(Xe){var Ve=v.slice(0,Xe),et=X7({breakAll:p,style:m,children:Ve+N}).wordsWithComputedWidth,Ce=j(et),_e=Ce.length>u||k(Ce).width>Number(i);return[_e,Ce]},O=0,T=v.length-1,I=0,z;O<=T&&I<=v.length-1;){var $=Math.floor((O+T)/2),V=$-1,K=D(V),te=Wz(K,2),X=te[0],ve=te[1],ae=D($),pe=Wz(ae,1),Oe=pe[0];if(!X&&!Oe&&(O=$+1),X&&Oe&&(T=$-1),!X&&Oe){z=ve;break}I++}return z||S},Kz=function(t){var n=Zr(t)?[]:t.toString().split(Y7);return[{words:n}]},ANe=function(t){var n=t.width,s=t.scaleToFit,i=t.children,c=t.style,u=t.breakAll,a=t.maxLines;if((n||s)&&!Sd.isSsr){var m,p,y=X7({breakAll:u,children:i,style:c});if(y){var v=y.wordsWithComputedWidth,j=y.spaceWidth;m=v,p=j}else return Kz(i);return CNe({breakAll:u,children:i,maxLines:a,style:c},m,p,n,s)}return Kz(i)},Hz="#808080",Gm=function(t){var n=t.x,s=n===void 0?0:n,i=t.y,c=i===void 0?0:i,u=t.lineHeight,a=u===void 0?"1em":u,m=t.capHeight,p=m===void 0?"0.71em":m,y=t.scaleToFit,v=y===void 0?!1:y,j=t.textAnchor,S=j===void 0?"start":j,k=t.verticalAnchor,N=k===void 0?"end":k,D=t.fill,O=D===void 0?Hz:D,T=Uz(t,_Ne),I=R.useMemo(function(){return ANe({breakAll:T.breakAll,children:T.children,maxLines:T.maxLines,scaleToFit:v,style:T.style,width:T.width})},[T.breakAll,T.children,T.maxLines,v,T.style,T.width]),z=T.dx,$=T.dy,V=T.angle,K=T.className,te=T.breakAll,X=Uz(T,bNe);if(!Ui(s)||!Ui(c))return null;var ve=s+(Ut(z)?z:0),ae=c+(Ut($)?$:0),pe;switch(N){case"start":pe=VA("calc(".concat(p,")"));break;case"middle":pe=VA("calc(".concat((I.length-1)/2," * -").concat(a," + (").concat(p," / 2))"));break;default:pe=VA("calc(".concat(I.length-1," * -").concat(a,")"));break}var Oe=[];if(v){var Me=I[0].width,Xe=T.width;Oe.push("scale(".concat((Ut(Xe)?Xe/Me:1)/Me,")"))}return V&&Oe.push("rotate(".concat(V,", ").concat(ve,", ").concat(ae,")")),Oe.length&&(X.transform=Oe.join(" ")),de.createElement("text",wE({},Cr(X,!0),{x:ve,y:ae,className:Yr("recharts-text",K),textAnchor:S,fill:O.includes("url")?Hz:O}),I.map(function(Ve,et){var Ce=Ve.words.join(te?"":" ");return de.createElement("tspan",{x:ve,dy:et===0?pe:a,key:"".concat(Ce,"-").concat(et)},Ce)}))};function Vh(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function kNe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ZI(e){let t,n,s;e.length!==2?(t=Vh,n=(a,m)=>Vh(e(a),m),s=(a,m)=>e(a)-m):(t=e===Vh||e===kNe?e:TNe,n=e,s=e);function i(a,m,p=0,y=a.length){if(p<y){if(t(m,m)!==0)return y;do{const v=p+y>>>1;n(a[v],m)<0?p=v+1:y=v}while(p<y)}return p}function c(a,m,p=0,y=a.length){if(p<y){if(t(m,m)!==0)return y;do{const v=p+y>>>1;n(a[v],m)<=0?p=v+1:y=v}while(p<y)}return p}function u(a,m,p=0,y=a.length){const v=i(a,m,p,y-1);return v>p&&s(a[v-1],m)>-s(a[v],m)?v-1:v}return{left:i,center:u,right:c}}function TNe(){return 0}function Q7(e){return e===null?NaN:+e}function*ENe(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const MNe=ZI(Vh),Vb=MNe.right;ZI(Q7).center;class Zz extends Map{constructor(t,n=DNe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[s,i]of t)this.set(s,i)}get(t){return super.get(Yz(this,t))}has(t){return super.has(Yz(this,t))}set(t,n){return super.set(ONe(this,t),n)}delete(t){return super.delete(INe(this,t))}}function Yz({_intern:e,_key:t},n){const s=t(n);return e.has(s)?e.get(s):n}function ONe({_intern:e,_key:t},n){const s=t(n);return e.has(s)?e.get(s):(e.set(s,n),n)}function INe({_intern:e,_key:t},n){const s=t(n);return e.has(s)&&(n=e.get(s),e.delete(s)),n}function DNe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function RNe(e=Vh){if(e===Vh)return J7;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const s=e(t,n);return s||s===0?s:(e(n,n)===0)-(e(t,t)===0)}}function J7(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const LNe=Math.sqrt(50),FNe=Math.sqrt(10),zNe=Math.sqrt(2);function GS(e,t,n){const s=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(s)),c=s/Math.pow(10,i),u=c>=LNe?10:c>=FNe?5:c>=zNe?2:1;let a,m,p;return i<0?(p=Math.pow(10,-i)/u,a=Math.round(e*p),m=Math.round(t*p),a/p<e&&++a,m/p>t&&--m,p=-p):(p=Math.pow(10,i)*u,a=Math.round(e/p),m=Math.round(t/p),a*p<e&&++a,m*p>t&&--m),m<a&&.5<=n&&n<2?GS(e,t,n*2):[a,m,p]}function SE(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const s=t<e,[i,c,u]=s?GS(t,e,n):GS(e,t,n);if(!(c>=i))return[];const a=c-i+1,m=new Array(a);if(s)if(u<0)for(let p=0;p<a;++p)m[p]=(c-p)/-u;else for(let p=0;p<a;++p)m[p]=(c-p)*u;else if(u<0)for(let p=0;p<a;++p)m[p]=(i+p)/-u;else for(let p=0;p<a;++p)m[p]=(i+p)*u;return m}function NE(e,t,n){return t=+t,e=+e,n=+n,GS(e,t,n)[2]}function PE(e,t,n){t=+t,e=+e,n=+n;const s=t<e,i=s?NE(t,e,n):NE(e,t,n);return(s?-1:1)*(i<0?1/-i:i)}function Xz(e,t){let n;for(const s of e)s!=null&&(n<s||n===void 0&&s>=s)&&(n=s);return n}function Qz(e,t){let n;for(const s of e)s!=null&&(n>s||n===void 0&&s>=s)&&(n=s);return n}function eG(e,t,n=0,s=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),s=Math.floor(Math.min(e.length-1,s)),!(n<=t&&t<=s))return e;for(i=i===void 0?J7:RNe(i);s>n;){if(s-n>600){const m=s-n+1,p=t-n+1,y=Math.log(m),v=.5*Math.exp(2*y/3),j=.5*Math.sqrt(y*v*(m-v)/m)*(p-m/2<0?-1:1),S=Math.max(n,Math.floor(t-p*v/m+j)),k=Math.min(s,Math.floor(t+(m-p)*v/m+j));eG(e,t,S,k,i)}const c=e[t];let u=n,a=s;for(P_(e,n,t),i(e[s],c)>0&&P_(e,n,s);u<a;){for(P_(e,u,a),++u,--a;i(e[u],c)<0;)++u;for(;i(e[a],c)>0;)--a}i(e[n],c)===0?P_(e,n,a):(++a,P_(e,a,s)),a<=t&&(n=a+1),t<=a&&(s=a-1)}return e}function P_(e,t,n){const s=e[t];e[t]=e[n],e[n]=s}function $Ne(e,t,n){if(e=Float64Array.from(ENe(e)),!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return Qz(e);if(t>=1)return Xz(e);var s,i=(s-1)*t,c=Math.floor(i),u=Xz(eG(e,c).subarray(0,c+1)),a=Qz(e.subarray(c+1));return u+(a-u)*(i-c)}}function BNe(e,t,n=Q7){if(!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return+n(e[0],0,e);if(t>=1)return+n(e[s-1],s-1,e);var s,i=(s-1)*t,c=Math.floor(i),u=+n(e[c],c,e),a=+n(e[c+1],c+1,e);return u+(a-u)*(i-c)}}function qNe(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var s=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,c=new Array(i);++s<i;)c[s]=e+s*n;return c}function Ml(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Nd(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const CE=Symbol("implicit");function YI(){var e=new Zz,t=[],n=[],s=CE;function i(c){let u=e.get(c);if(u===void 0){if(s!==CE)return s;e.set(c,u=t.push(c)-1)}return n[u%n.length]}return i.domain=function(c){if(!arguments.length)return t.slice();t=[],e=new Zz;for(const u of c)e.has(u)||e.set(u,t.push(u)-1);return i},i.range=function(c){return arguments.length?(n=Array.from(c),i):n.slice()},i.unknown=function(c){return arguments.length?(s=c,i):s},i.copy=function(){return YI(t,n).unknown(s)},Ml.apply(i,arguments),i}function W0(){var e=YI().unknown(void 0),t=e.domain,n=e.range,s=0,i=1,c,u,a=!1,m=0,p=0,y=.5;delete e.unknown;function v(){var j=t().length,S=i<s,k=S?i:s,N=S?s:i;c=(N-k)/Math.max(1,j-m+p*2),a&&(c=Math.floor(c)),k+=(N-k-c*(j-m))*y,u=c*(1-m),a&&(k=Math.round(k),u=Math.round(u));var D=qNe(j).map(function(O){return k+c*O});return n(S?D.reverse():D)}return e.domain=function(j){return arguments.length?(t(j),v()):t()},e.range=function(j){return arguments.length?([s,i]=j,s=+s,i=+i,v()):[s,i]},e.rangeRound=function(j){return[s,i]=j,s=+s,i=+i,a=!0,v()},e.bandwidth=function(){return u},e.step=function(){return c},e.round=function(j){return arguments.length?(a=!!j,v()):a},e.padding=function(j){return arguments.length?(m=Math.min(1,p=+j),v()):m},e.paddingInner=function(j){return arguments.length?(m=Math.min(1,j),v()):m},e.paddingOuter=function(j){return arguments.length?(p=+j,v()):p},e.align=function(j){return arguments.length?(y=Math.max(0,Math.min(1,j)),v()):y},e.copy=function(){return W0(t(),[s,i]).round(a).paddingInner(m).paddingOuter(p).align(y)},Ml.apply(v(),arguments)}function tG(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return tG(t())},e}function t0(){return tG(W0.apply(null,arguments).paddingInner(1))}function XI(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function rG(e,t){var n=Object.create(e.prototype);for(var s in t)n[s]=t[s];return n}function Ub(){}var G0=.7,KS=1/G0,tx="\\s*([+-]?\\d+)\\s*",K0="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Xc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",VNe=/^#([0-9a-f]{3,8})$/,UNe=new RegExp(`^rgb\\(${tx},${tx},${tx}\\)$`),WNe=new RegExp(`^rgb\\(${Xc},${Xc},${Xc}\\)$`),GNe=new RegExp(`^rgba\\(${tx},${tx},${tx},${K0}\\)$`),KNe=new RegExp(`^rgba\\(${Xc},${Xc},${Xc},${K0}\\)$`),HNe=new RegExp(`^hsl\\(${K0},${Xc},${Xc}\\)$`),ZNe=new RegExp(`^hsla\\(${K0},${Xc},${Xc},${K0}\\)$`),Jz={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};XI(Ub,H0,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:e$,formatHex:e$,formatHex8:YNe,formatHsl:XNe,formatRgb:t$,toString:t$});function e$(){return this.rgb().formatHex()}function YNe(){return this.rgb().formatHex8()}function XNe(){return nG(this).formatHsl()}function t$(){return this.rgb().formatRgb()}function H0(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=VNe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?r$(t):n===3?new xo(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?i1(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?i1(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=UNe.exec(e))?new xo(t[1],t[2],t[3],1):(t=WNe.exec(e))?new xo(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=GNe.exec(e))?i1(t[1],t[2],t[3],t[4]):(t=KNe.exec(e))?i1(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=HNe.exec(e))?i$(t[1],t[2]/100,t[3]/100,1):(t=ZNe.exec(e))?i$(t[1],t[2]/100,t[3]/100,t[4]):Jz.hasOwnProperty(e)?r$(Jz[e]):e==="transparent"?new xo(NaN,NaN,NaN,0):null}function r$(e){return new xo(e>>16&255,e>>8&255,e&255,1)}function i1(e,t,n,s){return s<=0&&(e=t=n=NaN),new xo(e,t,n,s)}function QNe(e){return e instanceof Ub||(e=H0(e)),e?(e=e.rgb(),new xo(e.r,e.g,e.b,e.opacity)):new xo}function AE(e,t,n,s){return arguments.length===1?QNe(e):new xo(e,t,n,s??1)}function xo(e,t,n,s){this.r=+e,this.g=+t,this.b=+n,this.opacity=+s}XI(xo,AE,rG(Ub,{brighter(e){return e=e==null?KS:Math.pow(KS,e),new xo(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?G0:Math.pow(G0,e),new xo(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new xo(Cm(this.r),Cm(this.g),Cm(this.b),HS(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:n$,formatHex:n$,formatHex8:JNe,formatRgb:s$,toString:s$}));function n$(){return`#${mm(this.r)}${mm(this.g)}${mm(this.b)}`}function JNe(){return`#${mm(this.r)}${mm(this.g)}${mm(this.b)}${mm((isNaN(this.opacity)?1:this.opacity)*255)}`}function s$(){const e=HS(this.opacity);return`${e===1?"rgb(":"rgba("}${Cm(this.r)}, ${Cm(this.g)}, ${Cm(this.b)}${e===1?")":`, ${e})`}`}function HS(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Cm(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function mm(e){return e=Cm(e),(e<16?"0":"")+e.toString(16)}function i$(e,t,n,s){return s<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new uc(e,t,n,s)}function nG(e){if(e instanceof uc)return new uc(e.h,e.s,e.l,e.opacity);if(e instanceof Ub||(e=H0(e)),!e)return new uc;if(e instanceof uc)return e;e=e.rgb();var t=e.r/255,n=e.g/255,s=e.b/255,i=Math.min(t,n,s),c=Math.max(t,n,s),u=NaN,a=c-i,m=(c+i)/2;return a?(t===c?u=(n-s)/a+(n<s)*6:n===c?u=(s-t)/a+2:u=(t-n)/a+4,a/=m<.5?c+i:2-c-i,u*=60):a=m>0&&m<1?0:u,new uc(u,a,m,e.opacity)}function e2e(e,t,n,s){return arguments.length===1?nG(e):new uc(e,t,n,s??1)}function uc(e,t,n,s){this.h=+e,this.s=+t,this.l=+n,this.opacity=+s}XI(uc,e2e,rG(Ub,{brighter(e){return e=e==null?KS:Math.pow(KS,e),new uc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?G0:Math.pow(G0,e),new uc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,s=n+(n<.5?n:1-n)*t,i=2*n-s;return new xo(UA(e>=240?e-240:e+120,i,s),UA(e,i,s),UA(e<120?e+240:e-120,i,s),this.opacity)},clamp(){return new uc(a$(this.h),a1(this.s),a1(this.l),HS(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=HS(this.opacity);return`${e===1?"hsl(":"hsla("}${a$(this.h)}, ${a1(this.s)*100}%, ${a1(this.l)*100}%${e===1?")":`, ${e})`}`}}));function a$(e){return e=(e||0)%360,e<0?e+360:e}function a1(e){return Math.max(0,Math.min(1,e||0))}function UA(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const QI=e=>()=>e;function t2e(e,t){return function(n){return e+n*t}}function r2e(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(s){return Math.pow(e+s*t,n)}}function n2e(e){return(e=+e)==1?sG:function(t,n){return n-t?r2e(t,n,e):QI(isNaN(t)?n:t)}}function sG(e,t){var n=t-e;return n?t2e(e,n):QI(isNaN(e)?t:e)}const o$=function e(t){var n=n2e(t);function s(i,c){var u=n((i=AE(i)).r,(c=AE(c)).r),a=n(i.g,c.g),m=n(i.b,c.b),p=sG(i.opacity,c.opacity);return function(y){return i.r=u(y),i.g=a(y),i.b=m(y),i.opacity=p(y),i+""}}return s.gamma=e,s}(1);function s2e(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,s=t.slice(),i;return function(c){for(i=0;i<n;++i)s[i]=e[i]*(1-c)+t[i]*c;return s}}function i2e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function a2e(e,t){var n=t?t.length:0,s=e?Math.min(n,e.length):0,i=new Array(s),c=new Array(n),u;for(u=0;u<s;++u)i[u]=By(e[u],t[u]);for(;u<n;++u)c[u]=t[u];return function(a){for(u=0;u<s;++u)c[u]=i[u](a);return c}}function o2e(e,t){var n=new Date;return e=+e,t=+t,function(s){return n.setTime(e*(1-s)+t*s),n}}function ZS(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function l2e(e,t){var n={},s={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=By(e[i],t[i]):s[i]=t[i];return function(c){for(i in n)s[i]=n[i](c);return s}}var kE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,WA=new RegExp(kE.source,"g");function c2e(e){return function(){return e}}function u2e(e){return function(t){return e(t)+""}}function d2e(e,t){var n=kE.lastIndex=WA.lastIndex=0,s,i,c,u=-1,a=[],m=[];for(e=e+"",t=t+"";(s=kE.exec(e))&&(i=WA.exec(t));)(c=i.index)>n&&(c=t.slice(n,c),a[u]?a[u]+=c:a[++u]=c),(s=s[0])===(i=i[0])?a[u]?a[u]+=i:a[++u]=i:(a[++u]=null,m.push({i:u,x:ZS(s,i)})),n=WA.lastIndex;return n<t.length&&(c=t.slice(n),a[u]?a[u]+=c:a[++u]=c),a.length<2?m[0]?u2e(m[0].x):c2e(t):(t=m.length,function(p){for(var y=0,v;y<t;++y)a[(v=m[y]).i]=v.x(p);return a.join("")})}function By(e,t){var n=typeof t,s;return t==null||n==="boolean"?QI(t):(n==="number"?ZS:n==="string"?(s=H0(t))?(t=s,o$):d2e:t instanceof H0?o$:t instanceof Date?o2e:i2e(t)?s2e:Array.isArray(t)?a2e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?l2e:ZS)(e,t)}function JI(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function h2e(e,t){t===void 0&&(t=e,e=By);for(var n=0,s=t.length-1,i=t[0],c=new Array(s<0?0:s);n<s;)c[n]=e(i,i=t[++n]);return function(u){var a=Math.max(0,Math.min(s-1,Math.floor(u*=s)));return c[a](u-a)}}function f2e(e){return function(){return e}}function YS(e){return+e}var l$=[0,1];function Qa(e){return e}function TE(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:f2e(isNaN(t)?NaN:.5)}function m2e(e,t){var n;return e>t&&(n=e,e=t,t=n),function(s){return Math.max(e,Math.min(t,s))}}function p2e(e,t,n){var s=e[0],i=e[1],c=t[0],u=t[1];return i<s?(s=TE(i,s),c=n(u,c)):(s=TE(s,i),c=n(c,u)),function(a){return c(s(a))}}function g2e(e,t,n){var s=Math.min(e.length,t.length)-1,i=new Array(s),c=new Array(s),u=-1;for(e[s]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++u<s;)i[u]=TE(e[u],e[u+1]),c[u]=n(t[u],t[u+1]);return function(a){var m=Vb(e,a,1,s)-1;return c[m](i[m](a))}}function Wb(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function J2(){var e=l$,t=l$,n=By,s,i,c,u=Qa,a,m,p;function y(){var j=Math.min(e.length,t.length);return u!==Qa&&(u=m2e(e[0],e[j-1])),a=j>2?g2e:p2e,m=p=null,v}function v(j){return j==null||isNaN(j=+j)?c:(m||(m=a(e.map(s),t,n)))(s(u(j)))}return v.invert=function(j){return u(i((p||(p=a(t,e.map(s),ZS)))(j)))},v.domain=function(j){return arguments.length?(e=Array.from(j,YS),y()):e.slice()},v.range=function(j){return arguments.length?(t=Array.from(j),y()):t.slice()},v.rangeRound=function(j){return t=Array.from(j),n=JI,y()},v.clamp=function(j){return arguments.length?(u=j?!0:Qa,y()):u!==Qa},v.interpolate=function(j){return arguments.length?(n=j,y()):n},v.unknown=function(j){return arguments.length?(c=j,v):c},function(j,S){return s=j,i=S,y()}}function eD(){return J2()(Qa,Qa)}function x2e(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function XS(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,s=e.slice(0,n);return[s.length>1?s[0]+s.slice(2):s,+e.slice(n+1)]}function Ux(e){return e=XS(Math.abs(e)),e?e[1]:NaN}function y2e(e,t){return function(n,s){for(var i=n.length,c=[],u=0,a=e[0],m=0;i>0&&a>0&&(m+a+1>s&&(a=Math.max(1,s-m)),c.push(n.substring(i-=a,i+a)),!((m+=a+1)>s));)a=e[u=(u+1)%e.length];return c.reverse().join(t)}}function v2e(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var _2e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Z0(e){if(!(t=_2e.exec(e)))throw new Error("invalid format: "+e);var t;return new tD({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Z0.prototype=tD.prototype;function tD(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}tD.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function b2e(e){e:for(var t=e.length,n=1,s=-1,i;n<t;++n)switch(e[n]){case".":s=i=n;break;case"0":s===0&&(s=n),i=n;break;default:if(!+e[n])break e;s>0&&(s=0);break}return s>0?e.slice(0,s)+e.slice(i+1):e}var iG;function j2e(e,t){var n=XS(e,t);if(!n)return e+"";var s=n[0],i=n[1],c=i-(iG=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,u=s.length;return c===u?s:c>u?s+new Array(c-u+1).join("0"):c>0?s.slice(0,c)+"."+s.slice(c):"0."+new Array(1-c).join("0")+XS(e,Math.max(0,t+c-1))[0]}function c$(e,t){var n=XS(e,t);if(!n)return e+"";var s=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+s:s.length>i+1?s.slice(0,i+1)+"."+s.slice(i+1):s+new Array(i-s.length+2).join("0")}const u$={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:x2e,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>c$(e*100,t),r:c$,s:j2e,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function d$(e){return e}var h$=Array.prototype.map,f$=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function w2e(e){var t=e.grouping===void 0||e.thousands===void 0?d$:y2e(h$.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",s=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",c=e.numerals===void 0?d$:v2e(h$.call(e.numerals,String)),u=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"":e.minus+"",m=e.nan===void 0?"NaN":e.nan+"";function p(v){v=Z0(v);var j=v.fill,S=v.align,k=v.sign,N=v.symbol,D=v.zero,O=v.width,T=v.comma,I=v.precision,z=v.trim,$=v.type;$==="n"?(T=!0,$="g"):u$[$]||(I===void 0&&(I=12),z=!0,$="g"),(D||j==="0"&&S==="=")&&(D=!0,j="0",S="=");var V=N==="$"?n:N==="#"&&/[boxX]/.test($)?"0"+$.toLowerCase():"",K=N==="$"?s:/[%p]/.test($)?u:"",te=u$[$],X=/[defgprs%]/.test($);I=I===void 0?6:/[gprs]/.test($)?Math.max(1,Math.min(21,I)):Math.max(0,Math.min(20,I));function ve(ae){var pe=V,Oe=K,Me,Xe,Ve;if($==="c")Oe=te(ae)+Oe,ae="";else{ae=+ae;var et=ae<0||1/ae<0;if(ae=isNaN(ae)?m:te(Math.abs(ae),I),z&&(ae=b2e(ae)),et&&+ae==0&&k!=="+"&&(et=!1),pe=(et?k==="("?k:a:k==="-"||k==="("?"":k)+pe,Oe=($==="s"?f$[8+iG/3]:"")+Oe+(et&&k==="("?")":""),X){for(Me=-1,Xe=ae.length;++Me<Xe;)if(Ve=ae.charCodeAt(Me),48>Ve||Ve>57){Oe=(Ve===46?i+ae.slice(Me+1):ae.slice(Me))+Oe,ae=ae.slice(0,Me);break}}}T&&!D&&(ae=t(ae,1/0));var Ce=pe.length+ae.length+Oe.length,_e=Ce<O?new Array(O-Ce+1).join(j):"";switch(T&&D&&(ae=t(_e+ae,_e.length?O-Oe.length:1/0),_e=""),S){case"<":ae=pe+ae+Oe+_e;break;case"=":ae=pe+_e+ae+Oe;break;case"^":ae=_e.slice(0,Ce=_e.length>>1)+pe+ae+Oe+_e.slice(Ce);break;default:ae=_e+pe+ae+Oe;break}return c(ae)}return ve.toString=function(){return v+""},ve}function y(v,j){var S=p((v=Z0(v),v.type="f",v)),k=Math.max(-8,Math.min(8,Math.floor(Ux(j)/3)))*3,N=Math.pow(10,-k),D=f$[8+k/3];return function(O){return S(N*O)+D}}return{format:p,formatPrefix:y}}var o1,rD,aG;S2e({thousands:",",grouping:[3],currency:["$",""]});function S2e(e){return o1=w2e(e),rD=o1.format,aG=o1.formatPrefix,o1}function N2e(e){return Math.max(0,-Ux(Math.abs(e)))}function P2e(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ux(t)/3)))*3-Ux(Math.abs(e)))}function C2e(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ux(t)-Ux(e))+1}function oG(e,t,n,s){var i=PE(e,t,n),c;switch(s=Z0(s??",f"),s.type){case"s":{var u=Math.max(Math.abs(e),Math.abs(t));return s.precision==null&&!isNaN(c=P2e(i,u))&&(s.precision=c),aG(s,u)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(c=C2e(i,Math.max(Math.abs(e),Math.abs(t))))&&(s.precision=c-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(c=N2e(i))&&(s.precision=c-(s.type==="%")*2);break}}return rD(s)}function hf(e){var t=e.domain;return e.ticks=function(n){var s=t();return SE(s[0],s[s.length-1],n??10)},e.tickFormat=function(n,s){var i=t();return oG(i[0],i[i.length-1],n??10,s)},e.nice=function(n){n==null&&(n=10);var s=t(),i=0,c=s.length-1,u=s[i],a=s[c],m,p,y=10;for(a<u&&(p=u,u=a,a=p,p=i,i=c,c=p);y-- >0;){if(p=NE(u,a,n),p===m)return s[i]=u,s[c]=a,t(s);if(p>0)u=Math.floor(u/p)*p,a=Math.ceil(a/p)*p;else if(p<0)u=Math.ceil(u*p)/p,a=Math.floor(a*p)/p;else break;m=p}return e},e}function QS(){var e=eD();return e.copy=function(){return Wb(e,QS())},Ml.apply(e,arguments),hf(e)}function lG(e){var t;function n(s){return s==null||isNaN(s=+s)?t:s}return n.invert=n,n.domain=n.range=function(s){return arguments.length?(e=Array.from(s,YS),n):e.slice()},n.unknown=function(s){return arguments.length?(t=s,n):t},n.copy=function(){return lG(e).unknown(t)},e=arguments.length?Array.from(e,YS):[0,1],hf(n)}function cG(e,t){e=e.slice();var n=0,s=e.length-1,i=e[n],c=e[s],u;return c<i&&(u=n,n=s,s=u,u=i,i=c,c=u),e[n]=t.floor(i),e[s]=t.ceil(c),e}function m$(e){return Math.log(e)}function p$(e){return Math.exp(e)}function A2e(e){return-Math.log(-e)}function k2e(e){return-Math.exp(-e)}function T2e(e){return isFinite(e)?+("1e"+e):e<0?0:e}function E2e(e){return e===10?T2e:e===Math.E?Math.exp:t=>Math.pow(e,t)}function M2e(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function g$(e){return(t,n)=>-e(-t,n)}function nD(e){const t=e(m$,p$),n=t.domain;let s=10,i,c;function u(){return i=M2e(s),c=E2e(s),n()[0]<0?(i=g$(i),c=g$(c),e(A2e,k2e)):e(m$,p$),t}return t.base=function(a){return arguments.length?(s=+a,u()):s},t.domain=function(a){return arguments.length?(n(a),u()):n()},t.ticks=a=>{const m=n();let p=m[0],y=m[m.length-1];const v=y<p;v&&([p,y]=[y,p]);let j=i(p),S=i(y),k,N;const D=a==null?10:+a;let O=[];if(!(s%1)&&S-j<D){if(j=Math.floor(j),S=Math.ceil(S),p>0){for(;j<=S;++j)for(k=1;k<s;++k)if(N=j<0?k/c(-j):k*c(j),!(N<p)){if(N>y)break;O.push(N)}}else for(;j<=S;++j)for(k=s-1;k>=1;--k)if(N=j>0?k/c(-j):k*c(j),!(N<p)){if(N>y)break;O.push(N)}O.length*2<D&&(O=SE(p,y,D))}else O=SE(j,S,Math.min(S-j,D)).map(c);return v?O.reverse():O},t.tickFormat=(a,m)=>{if(a==null&&(a=10),m==null&&(m=s===10?"s":","),typeof m!="function"&&(!(s%1)&&(m=Z0(m)).precision==null&&(m.trim=!0),m=rD(m)),a===1/0)return m;const p=Math.max(1,s*a/t.ticks().length);return y=>{let v=y/c(Math.round(i(y)));return v*s<s-.5&&(v*=s),v<=p?m(y):""}},t.nice=()=>n(cG(n(),{floor:a=>c(Math.floor(i(a))),ceil:a=>c(Math.ceil(i(a)))})),t}function uG(){const e=nD(J2()).domain([1,10]);return e.copy=()=>Wb(e,uG()).base(e.base()),Ml.apply(e,arguments),e}function x$(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function y$(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function sD(e){var t=1,n=e(x$(t),y$(t));return n.constant=function(s){return arguments.length?e(x$(t=+s),y$(t)):t},hf(n)}function dG(){var e=sD(J2());return e.copy=function(){return Wb(e,dG()).constant(e.constant())},Ml.apply(e,arguments)}function v$(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function O2e(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function I2e(e){return e<0?-e*e:e*e}function iD(e){var t=e(Qa,Qa),n=1;function s(){return n===1?e(Qa,Qa):n===.5?e(O2e,I2e):e(v$(n),v$(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,s()):n},hf(t)}function aD(){var e=iD(J2());return e.copy=function(){return Wb(e,aD()).exponent(e.exponent())},Ml.apply(e,arguments),e}function D2e(){return aD.apply(null,arguments).exponent(.5)}function _$(e){return Math.sign(e)*e*e}function R2e(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function hG(){var e=eD(),t=[0,1],n=!1,s;function i(c){var u=R2e(e(c));return isNaN(u)?s:n?Math.round(u):u}return i.invert=function(c){return e.invert(_$(c))},i.domain=function(c){return arguments.length?(e.domain(c),i):e.domain()},i.range=function(c){return arguments.length?(e.range((t=Array.from(c,YS)).map(_$)),i):t.slice()},i.rangeRound=function(c){return i.range(c).round(!0)},i.round=function(c){return arguments.length?(n=!!c,i):n},i.clamp=function(c){return arguments.length?(e.clamp(c),i):e.clamp()},i.unknown=function(c){return arguments.length?(s=c,i):s},i.copy=function(){return hG(e.domain(),t).round(n).clamp(e.clamp()).unknown(s)},Ml.apply(i,arguments),hf(i)}function fG(){var e=[],t=[],n=[],s;function i(){var u=0,a=Math.max(1,t.length);for(n=new Array(a-1);++u<a;)n[u-1]=BNe(e,u/a);return c}function c(u){return u==null||isNaN(u=+u)?s:t[Vb(n,u)]}return c.invertExtent=function(u){var a=t.indexOf(u);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},c.domain=function(u){if(!arguments.length)return e.slice();e=[];for(let a of u)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Vh),i()},c.range=function(u){return arguments.length?(t=Array.from(u),i()):t.slice()},c.unknown=function(u){return arguments.length?(s=u,c):s},c.quantiles=function(){return n.slice()},c.copy=function(){return fG().domain(e).range(t).unknown(s)},Ml.apply(c,arguments)}function mG(){var e=0,t=1,n=1,s=[.5],i=[0,1],c;function u(m){return m!=null&&m<=m?i[Vb(s,m,0,n)]:c}function a(){var m=-1;for(s=new Array(n);++m<n;)s[m]=((m+1)*t-(m-n)*e)/(n+1);return u}return u.domain=function(m){return arguments.length?([e,t]=m,e=+e,t=+t,a()):[e,t]},u.range=function(m){return arguments.length?(n=(i=Array.from(m)).length-1,a()):i.slice()},u.invertExtent=function(m){var p=i.indexOf(m);return p<0?[NaN,NaN]:p<1?[e,s[0]]:p>=n?[s[n-1],t]:[s[p-1],s[p]]},u.unknown=function(m){return arguments.length&&(c=m),u},u.thresholds=function(){return s.slice()},u.copy=function(){return mG().domain([e,t]).range(i).unknown(c)},Ml.apply(hf(u),arguments)}function pG(){var e=[.5],t=[0,1],n,s=1;function i(c){return c!=null&&c<=c?t[Vb(e,c,0,s)]:n}return i.domain=function(c){return arguments.length?(e=Array.from(c),s=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(c){return arguments.length?(t=Array.from(c),s=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(c){var u=t.indexOf(c);return[e[u-1],e[u]]},i.unknown=function(c){return arguments.length?(n=c,i):n},i.copy=function(){return pG().domain(e).range(t).unknown(n)},Ml.apply(i,arguments)}const GA=new Date,KA=new Date;function Gi(e,t,n,s){function i(c){return e(c=arguments.length===0?new Date:new Date(+c)),c}return i.floor=c=>(e(c=new Date(+c)),c),i.ceil=c=>(e(c=new Date(c-1)),t(c,1),e(c),c),i.round=c=>{const u=i(c),a=i.ceil(c);return c-u<a-c?u:a},i.offset=(c,u)=>(t(c=new Date(+c),u==null?1:Math.floor(u)),c),i.range=(c,u,a)=>{const m=[];if(c=i.ceil(c),a=a==null?1:Math.floor(a),!(c<u)||!(a>0))return m;let p;do m.push(p=new Date(+c)),t(c,a),e(c);while(p<c&&c<u);return m},i.filter=c=>Gi(u=>{if(u>=u)for(;e(u),!c(u);)u.setTime(u-1)},(u,a)=>{if(u>=u)if(a<0)for(;++a<=0;)for(;t(u,-1),!c(u););else for(;--a>=0;)for(;t(u,1),!c(u););}),n&&(i.count=(c,u)=>(GA.setTime(+c),KA.setTime(+u),e(GA),e(KA),Math.floor(n(GA,KA))),i.every=c=>(c=Math.floor(c),!isFinite(c)||!(c>0)?null:c>1?i.filter(s?u=>s(u)%c===0:u=>i.count(0,u)%c===0):i)),i}const JS=Gi(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);JS.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Gi(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):JS);JS.range;const Ku=1e3,jl=Ku*60,Hu=jl*60,hd=Hu*24,oD=hd*7,b$=hd*30,HA=hd*365,pm=Gi(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ku)},(e,t)=>(t-e)/Ku,e=>e.getUTCSeconds());pm.range;const lD=Gi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ku)},(e,t)=>{e.setTime(+e+t*jl)},(e,t)=>(t-e)/jl,e=>e.getMinutes());lD.range;const cD=Gi(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*jl)},(e,t)=>(t-e)/jl,e=>e.getUTCMinutes());cD.range;const uD=Gi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ku-e.getMinutes()*jl)},(e,t)=>{e.setTime(+e+t*Hu)},(e,t)=>(t-e)/Hu,e=>e.getHours());uD.range;const dD=Gi(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Hu)},(e,t)=>(t-e)/Hu,e=>e.getUTCHours());dD.range;const Gb=Gi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*jl)/hd,e=>e.getDate()-1);Gb.range;const eP=Gi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/hd,e=>e.getUTCDate()-1);eP.range;const gG=Gi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/hd,e=>Math.floor(e/hd));gG.range;function rp(e){return Gi(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*jl)/oD)}const tP=rp(0),eN=rp(1),L2e=rp(2),F2e=rp(3),Wx=rp(4),z2e=rp(5),$2e=rp(6);tP.range;eN.range;L2e.range;F2e.range;Wx.range;z2e.range;$2e.range;function np(e){return Gi(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/oD)}const rP=np(0),tN=np(1),B2e=np(2),q2e=np(3),Gx=np(4),V2e=np(5),U2e=np(6);rP.range;tN.range;B2e.range;q2e.range;Gx.range;V2e.range;U2e.range;const hD=Gi(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());hD.range;const fD=Gi(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());fD.range;const fd=Gi(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());fd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Gi(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});fd.range;const md=Gi(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());md.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Gi(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});md.range;function xG(e,t,n,s,i,c){const u=[[pm,1,Ku],[pm,5,5*Ku],[pm,15,15*Ku],[pm,30,30*Ku],[c,1,jl],[c,5,5*jl],[c,15,15*jl],[c,30,30*jl],[i,1,Hu],[i,3,3*Hu],[i,6,6*Hu],[i,12,12*Hu],[s,1,hd],[s,2,2*hd],[n,1,oD],[t,1,b$],[t,3,3*b$],[e,1,HA]];function a(p,y,v){const j=y<p;j&&([p,y]=[y,p]);const S=v&&typeof v.range=="function"?v:m(p,y,v),k=S?S.range(p,+y+1):[];return j?k.reverse():k}function m(p,y,v){const j=Math.abs(y-p)/v,S=ZI(([,,D])=>D).right(u,j);if(S===u.length)return e.every(PE(p/HA,y/HA,v));if(S===0)return JS.every(Math.max(PE(p,y,v),1));const[k,N]=u[j/u[S-1][2]<u[S][2]/j?S-1:S];return k.every(N)}return[a,m]}const[W2e,G2e]=xG(md,fD,rP,gG,dD,cD),[K2e,H2e]=xG(fd,hD,tP,Gb,uD,lD);function ZA(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function YA(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function C_(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Z2e(e){var t=e.dateTime,n=e.date,s=e.time,i=e.periods,c=e.days,u=e.shortDays,a=e.months,m=e.shortMonths,p=A_(i),y=k_(i),v=A_(c),j=k_(c),S=A_(u),k=k_(u),N=A_(a),D=k_(a),O=A_(m),T=k_(m),I={a:et,A:Ce,b:_e,B:tt,c:null,d:C$,e:C$,f:yPe,g:APe,G:TPe,H:pPe,I:gPe,j:xPe,L:yG,m:vPe,M:_Pe,p:vt,q:gt,Q:T$,s:E$,S:bPe,u:jPe,U:wPe,V:SPe,w:NPe,W:PPe,x:null,X:null,y:CPe,Y:kPe,Z:EPe,"%":k$},z={a:Tt,A:Ht,b:Ir,B:Pr,c:null,d:A$,e:A$,f:DPe,g:WPe,G:KPe,H:MPe,I:OPe,j:IPe,L:_G,m:RPe,M:LPe,p:Mt,q:yr,Q:T$,s:E$,S:FPe,u:zPe,U:$Pe,V:BPe,w:qPe,W:VPe,x:null,X:null,y:UPe,Y:GPe,Z:HPe,"%":k$},$={a:ve,A:ae,b:pe,B:Oe,c:Me,d:N$,e:N$,f:dPe,g:S$,G:w$,H:P$,I:P$,j:oPe,L:uPe,m:aPe,M:lPe,p:X,q:iPe,Q:fPe,s:mPe,S:cPe,u:ePe,U:tPe,V:rPe,w:J2e,W:nPe,x:Xe,X:Ve,y:S$,Y:w$,Z:sPe,"%":hPe};I.x=V(n,I),I.X=V(s,I),I.c=V(t,I),z.x=V(n,z),z.X=V(s,z),z.c=V(t,z);function V(Nt,Wt){return function(Zt){var mt=[],qr=-1,ar=0,en=Nt.length,Lr,An,vs;for(Zt instanceof Date||(Zt=new Date(+Zt));++qr<en;)Nt.charCodeAt(qr)===37&&(mt.push(Nt.slice(ar,qr)),(An=j$[Lr=Nt.charAt(++qr)])!=null?Lr=Nt.charAt(++qr):An=Lr==="e"?" ":"0",(vs=Wt[Lr])&&(Lr=vs(Zt,An)),mt.push(Lr),ar=qr+1);return mt.push(Nt.slice(ar,qr)),mt.join("")}}function K(Nt,Wt){return function(Zt){var mt=C_(1900,void 0,1),qr=te(mt,Nt,Zt+="",0),ar,en;if(qr!=Zt.length)return null;if("Q"in mt)return new Date(mt.Q);if("s"in mt)return new Date(mt.s*1e3+("L"in mt?mt.L:0));if(Wt&&!("Z"in mt)&&(mt.Z=0),"p"in mt&&(mt.H=mt.H%12+mt.p*12),mt.m===void 0&&(mt.m="q"in mt?mt.q:0),"V"in mt){if(mt.V<1||mt.V>53)return null;"w"in mt||(mt.w=1),"Z"in mt?(ar=YA(C_(mt.y,0,1)),en=ar.getUTCDay(),ar=en>4||en===0?tN.ceil(ar):tN(ar),ar=eP.offset(ar,(mt.V-1)*7),mt.y=ar.getUTCFullYear(),mt.m=ar.getUTCMonth(),mt.d=ar.getUTCDate()+(mt.w+6)%7):(ar=ZA(C_(mt.y,0,1)),en=ar.getDay(),ar=en>4||en===0?eN.ceil(ar):eN(ar),ar=Gb.offset(ar,(mt.V-1)*7),mt.y=ar.getFullYear(),mt.m=ar.getMonth(),mt.d=ar.getDate()+(mt.w+6)%7)}else("W"in mt||"U"in mt)&&("w"in mt||(mt.w="u"in mt?mt.u%7:"W"in mt?1:0),en="Z"in mt?YA(C_(mt.y,0,1)).getUTCDay():ZA(C_(mt.y,0,1)).getDay(),mt.m=0,mt.d="W"in mt?(mt.w+6)%7+mt.W*7-(en+5)%7:mt.w+mt.U*7-(en+6)%7);return"Z"in mt?(mt.H+=mt.Z/100|0,mt.M+=mt.Z%100,YA(mt)):ZA(mt)}}function te(Nt,Wt,Zt,mt){for(var qr=0,ar=Wt.length,en=Zt.length,Lr,An;qr<ar;){if(mt>=en)return-1;if(Lr=Wt.charCodeAt(qr++),Lr===37){if(Lr=Wt.charAt(qr++),An=$[Lr in j$?Wt.charAt(qr++):Lr],!An||(mt=An(Nt,Zt,mt))<0)return-1}else if(Lr!=Zt.charCodeAt(mt++))return-1}return mt}function X(Nt,Wt,Zt){var mt=p.exec(Wt.slice(Zt));return mt?(Nt.p=y.get(mt[0].toLowerCase()),Zt+mt[0].length):-1}function ve(Nt,Wt,Zt){var mt=S.exec(Wt.slice(Zt));return mt?(Nt.w=k.get(mt[0].toLowerCase()),Zt+mt[0].length):-1}function ae(Nt,Wt,Zt){var mt=v.exec(Wt.slice(Zt));return mt?(Nt.w=j.get(mt[0].toLowerCase()),Zt+mt[0].length):-1}function pe(Nt,Wt,Zt){var mt=O.exec(Wt.slice(Zt));return mt?(Nt.m=T.get(mt[0].toLowerCase()),Zt+mt[0].length):-1}function Oe(Nt,Wt,Zt){var mt=N.exec(Wt.slice(Zt));return mt?(Nt.m=D.get(mt[0].toLowerCase()),Zt+mt[0].length):-1}function Me(Nt,Wt,Zt){return te(Nt,t,Wt,Zt)}function Xe(Nt,Wt,Zt){return te(Nt,n,Wt,Zt)}function Ve(Nt,Wt,Zt){return te(Nt,s,Wt,Zt)}function et(Nt){return u[Nt.getDay()]}function Ce(Nt){return c[Nt.getDay()]}function _e(Nt){return m[Nt.getMonth()]}function tt(Nt){return a[Nt.getMonth()]}function vt(Nt){return i[+(Nt.getHours()>=12)]}function gt(Nt){return 1+~~(Nt.getMonth()/3)}function Tt(Nt){return u[Nt.getUTCDay()]}function Ht(Nt){return c[Nt.getUTCDay()]}function Ir(Nt){return m[Nt.getUTCMonth()]}function Pr(Nt){return a[Nt.getUTCMonth()]}function Mt(Nt){return i[+(Nt.getUTCHours()>=12)]}function yr(Nt){return 1+~~(Nt.getUTCMonth()/3)}return{format:function(Nt){var Wt=V(Nt+="",I);return Wt.toString=function(){return Nt},Wt},parse:function(Nt){var Wt=K(Nt+="",!1);return Wt.toString=function(){return Nt},Wt},utcFormat:function(Nt){var Wt=V(Nt+="",z);return Wt.toString=function(){return Nt},Wt},utcParse:function(Nt){var Wt=K(Nt+="",!0);return Wt.toString=function(){return Nt},Wt}}}var j$={"-":"",_:" ",0:"0"},oa=/^\s*\d+/,Y2e=/^%/,X2e=/[\\^$*+?|[\]().{}]/g;function Ln(e,t,n){var s=e<0?"-":"",i=(s?-e:e)+"",c=i.length;return s+(c<n?new Array(n-c+1).join(t)+i:i)}function Q2e(e){return e.replace(X2e,"\\$&")}function A_(e){return new RegExp("^(?:"+e.map(Q2e).join("|")+")","i")}function k_(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function J2e(e,t,n){var s=oa.exec(t.slice(n,n+1));return s?(e.w=+s[0],n+s[0].length):-1}function ePe(e,t,n){var s=oa.exec(t.slice(n,n+1));return s?(e.u=+s[0],n+s[0].length):-1}function tPe(e,t,n){var s=oa.exec(t.slice(n,n+2));return s?(e.U=+s[0],n+s[0].length):-1}function rPe(e,t,n){var s=oa.exec(t.slice(n,n+2));return s?(e.V=+s[0],n+s[0].length):-1}function nPe(e,t,n){var s=oa.exec(t.slice(n,n+2));return s?(e.W=+s[0],n+s[0].length):-1}function w$(e,t,n){var s=oa.exec(t.slice(n,n+4));return s?(e.y=+s[0],n+s[0].length):-1}function S$(e,t,n){var s=oa.exec(t.slice(n,n+2));return s?(e.y=+s[0]+(+s[0]>68?1900:2e3),n+s[0].length):-1}function sPe(e,t,n){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return s?(e.Z=s[1]?0:-(s[2]+(s[3]||"00")),n+s[0].length):-1}function iPe(e,t,n){var s=oa.exec(t.slice(n,n+1));return s?(e.q=s[0]*3-3,n+s[0].length):-1}function aPe(e,t,n){var s=oa.exec(t.slice(n,n+2));return s?(e.m=s[0]-1,n+s[0].length):-1}function N$(e,t,n){var s=oa.exec(t.slice(n,n+2));return s?(e.d=+s[0],n+s[0].length):-1}function oPe(e,t,n){var s=oa.exec(t.slice(n,n+3));return s?(e.m=0,e.d=+s[0],n+s[0].length):-1}function P$(e,t,n){var s=oa.exec(t.slice(n,n+2));return s?(e.H=+s[0],n+s[0].length):-1}function lPe(e,t,n){var s=oa.exec(t.slice(n,n+2));return s?(e.M=+s[0],n+s[0].length):-1}function cPe(e,t,n){var s=oa.exec(t.slice(n,n+2));return s?(e.S=+s[0],n+s[0].length):-1}function uPe(e,t,n){var s=oa.exec(t.slice(n,n+3));return s?(e.L=+s[0],n+s[0].length):-1}function dPe(e,t,n){var s=oa.exec(t.slice(n,n+6));return s?(e.L=Math.floor(s[0]/1e3),n+s[0].length):-1}function hPe(e,t,n){var s=Y2e.exec(t.slice(n,n+1));return s?n+s[0].length:-1}function fPe(e,t,n){var s=oa.exec(t.slice(n));return s?(e.Q=+s[0],n+s[0].length):-1}function mPe(e,t,n){var s=oa.exec(t.slice(n));return s?(e.s=+s[0],n+s[0].length):-1}function C$(e,t){return Ln(e.getDate(),t,2)}function pPe(e,t){return Ln(e.getHours(),t,2)}function gPe(e,t){return Ln(e.getHours()%12||12,t,2)}function xPe(e,t){return Ln(1+Gb.count(fd(e),e),t,3)}function yG(e,t){return Ln(e.getMilliseconds(),t,3)}function yPe(e,t){return yG(e,t)+"000"}function vPe(e,t){return Ln(e.getMonth()+1,t,2)}function _Pe(e,t){return Ln(e.getMinutes(),t,2)}function bPe(e,t){return Ln(e.getSeconds(),t,2)}function jPe(e){var t=e.getDay();return t===0?7:t}function wPe(e,t){return Ln(tP.count(fd(e)-1,e),t,2)}function vG(e){var t=e.getDay();return t>=4||t===0?Wx(e):Wx.ceil(e)}function SPe(e,t){return e=vG(e),Ln(Wx.count(fd(e),e)+(fd(e).getDay()===4),t,2)}function NPe(e){return e.getDay()}function PPe(e,t){return Ln(eN.count(fd(e)-1,e),t,2)}function CPe(e,t){return Ln(e.getFullYear()%100,t,2)}function APe(e,t){return e=vG(e),Ln(e.getFullYear()%100,t,2)}function kPe(e,t){return Ln(e.getFullYear()%1e4,t,4)}function TPe(e,t){var n=e.getDay();return e=n>=4||n===0?Wx(e):Wx.ceil(e),Ln(e.getFullYear()%1e4,t,4)}function EPe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ln(t/60|0,"0",2)+Ln(t%60,"0",2)}function A$(e,t){return Ln(e.getUTCDate(),t,2)}function MPe(e,t){return Ln(e.getUTCHours(),t,2)}function OPe(e,t){return Ln(e.getUTCHours()%12||12,t,2)}function IPe(e,t){return Ln(1+eP.count(md(e),e),t,3)}function _G(e,t){return Ln(e.getUTCMilliseconds(),t,3)}function DPe(e,t){return _G(e,t)+"000"}function RPe(e,t){return Ln(e.getUTCMonth()+1,t,2)}function LPe(e,t){return Ln(e.getUTCMinutes(),t,2)}function FPe(e,t){return Ln(e.getUTCSeconds(),t,2)}function zPe(e){var t=e.getUTCDay();return t===0?7:t}function $Pe(e,t){return Ln(rP.count(md(e)-1,e),t,2)}function bG(e){var t=e.getUTCDay();return t>=4||t===0?Gx(e):Gx.ceil(e)}function BPe(e,t){return e=bG(e),Ln(Gx.count(md(e),e)+(md(e).getUTCDay()===4),t,2)}function qPe(e){return e.getUTCDay()}function VPe(e,t){return Ln(tN.count(md(e)-1,e),t,2)}function UPe(e,t){return Ln(e.getUTCFullYear()%100,t,2)}function WPe(e,t){return e=bG(e),Ln(e.getUTCFullYear()%100,t,2)}function GPe(e,t){return Ln(e.getUTCFullYear()%1e4,t,4)}function KPe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Gx(e):Gx.ceil(e),Ln(e.getUTCFullYear()%1e4,t,4)}function HPe(){return"+0000"}function k$(){return"%"}function T$(e){return+e}function E$(e){return Math.floor(+e/1e3)}var yg,jG,wG;ZPe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ZPe(e){return yg=Z2e(e),jG=yg.format,yg.parse,wG=yg.utcFormat,yg.utcParse,yg}function YPe(e){return new Date(e)}function XPe(e){return e instanceof Date?+e:+new Date(+e)}function mD(e,t,n,s,i,c,u,a,m,p){var y=eD(),v=y.invert,j=y.domain,S=p(".%L"),k=p(":%S"),N=p("%I:%M"),D=p("%I %p"),O=p("%a %d"),T=p("%b %d"),I=p("%B"),z=p("%Y");function $(V){return(m(V)<V?S:a(V)<V?k:u(V)<V?N:c(V)<V?D:s(V)<V?i(V)<V?O:T:n(V)<V?I:z)(V)}return y.invert=function(V){return new Date(v(V))},y.domain=function(V){return arguments.length?j(Array.from(V,XPe)):j().map(YPe)},y.ticks=function(V){var K=j();return e(K[0],K[K.length-1],V??10)},y.tickFormat=function(V,K){return K==null?$:p(K)},y.nice=function(V){var K=j();return(!V||typeof V.range!="function")&&(V=t(K[0],K[K.length-1],V??10)),V?j(cG(K,V)):y},y.copy=function(){return Wb(y,mD(e,t,n,s,i,c,u,a,m,p))},y}function QPe(){return Ml.apply(mD(K2e,H2e,fd,hD,tP,Gb,uD,lD,pm,jG).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function JPe(){return Ml.apply(mD(W2e,G2e,md,fD,rP,eP,dD,cD,pm,wG).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function nP(){var e=0,t=1,n,s,i,c,u=Qa,a=!1,m;function p(v){return v==null||isNaN(v=+v)?m:u(i===0?.5:(v=(c(v)-n)*i,a?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,t]=v,n=c(e=+e),s=c(t=+t),i=n===s?0:1/(s-n),p):[e,t]},p.clamp=function(v){return arguments.length?(a=!!v,p):a},p.interpolator=function(v){return arguments.length?(u=v,p):u};function y(v){return function(j){var S,k;return arguments.length?([S,k]=j,u=v(S,k),p):[u(0),u(1)]}}return p.range=y(By),p.rangeRound=y(JI),p.unknown=function(v){return arguments.length?(m=v,p):m},function(v){return c=v,n=v(e),s=v(t),i=n===s?0:1/(s-n),p}}function ff(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function SG(){var e=hf(nP()(Qa));return e.copy=function(){return ff(e,SG())},Nd.apply(e,arguments)}function NG(){var e=nD(nP()).domain([1,10]);return e.copy=function(){return ff(e,NG()).base(e.base())},Nd.apply(e,arguments)}function PG(){var e=sD(nP());return e.copy=function(){return ff(e,PG()).constant(e.constant())},Nd.apply(e,arguments)}function pD(){var e=iD(nP());return e.copy=function(){return ff(e,pD()).exponent(e.exponent())},Nd.apply(e,arguments)}function eCe(){return pD.apply(null,arguments).exponent(.5)}function CG(){var e=[],t=Qa;function n(s){if(s!=null&&!isNaN(s=+s))return t((Vb(e,s,1)-1)/(e.length-1))}return n.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let i of s)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(Vh),n},n.interpolator=function(s){return arguments.length?(t=s,n):t},n.range=function(){return e.map((s,i)=>t(i/(e.length-1)))},n.quantiles=function(s){return Array.from({length:s+1},(i,c)=>$Ne(e,c/s))},n.copy=function(){return CG(t).domain(e)},Nd.apply(n,arguments)}function sP(){var e=0,t=.5,n=1,s=1,i,c,u,a,m,p=Qa,y,v=!1,j;function S(N){return isNaN(N=+N)?j:(N=.5+((N=+y(N))-c)*(s*N<s*c?a:m),p(v?Math.max(0,Math.min(1,N)):N))}S.domain=function(N){return arguments.length?([e,t,n]=N,i=y(e=+e),c=y(t=+t),u=y(n=+n),a=i===c?0:.5/(c-i),m=c===u?0:.5/(u-c),s=c<i?-1:1,S):[e,t,n]},S.clamp=function(N){return arguments.length?(v=!!N,S):v},S.interpolator=function(N){return arguments.length?(p=N,S):p};function k(N){return function(D){var O,T,I;return arguments.length?([O,T,I]=D,p=h2e(N,[O,T,I]),S):[p(0),p(.5),p(1)]}}return S.range=k(By),S.rangeRound=k(JI),S.unknown=function(N){return arguments.length?(j=N,S):j},function(N){return y=N,i=N(e),c=N(t),u=N(n),a=i===c?0:.5/(c-i),m=c===u?0:.5/(u-c),s=c<i?-1:1,S}}function AG(){var e=hf(sP()(Qa));return e.copy=function(){return ff(e,AG())},Nd.apply(e,arguments)}function kG(){var e=nD(sP()).domain([.1,1,10]);return e.copy=function(){return ff(e,kG()).base(e.base())},Nd.apply(e,arguments)}function TG(){var e=sD(sP());return e.copy=function(){return ff(e,TG()).constant(e.constant())},Nd.apply(e,arguments)}function gD(){var e=iD(sP());return e.copy=function(){return ff(e,gD()).exponent(e.exponent())},Nd.apply(e,arguments)}function tCe(){return gD.apply(null,arguments).exponent(.5)}const M$=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:W0,scaleDiverging:AG,scaleDivergingLog:kG,scaleDivergingPow:gD,scaleDivergingSqrt:tCe,scaleDivergingSymlog:TG,scaleIdentity:lG,scaleImplicit:CE,scaleLinear:QS,scaleLog:uG,scaleOrdinal:YI,scalePoint:t0,scalePow:aD,scaleQuantile:fG,scaleQuantize:mG,scaleRadial:hG,scaleSequential:SG,scaleSequentialLog:NG,scaleSequentialPow:pD,scaleSequentialQuantile:CG,scaleSequentialSqrt:eCe,scaleSequentialSymlog:PG,scaleSqrt:D2e,scaleSymlog:dG,scaleThreshold:pG,scaleTime:QPe,scaleUtc:JPe,tickFormat:oG},Symbol.toStringTag,{value:"Module"}));var rCe=My;function nCe(e,t,n){for(var s=-1,i=e.length;++s<i;){var c=e[s],u=t(c);if(u!=null&&(a===void 0?u===u&&!rCe(u):n(u,a)))var a=u,m=c}return m}var iP=nCe;function sCe(e,t){return e>t}var EG=sCe,iCe=iP,aCe=EG,oCe=$y;function lCe(e){return e&&e.length?iCe(e,oCe,aCe):void 0}var cCe=lCe;const Th=Fn(cCe);function uCe(e,t){return e<t}var MG=uCe,dCe=iP,hCe=MG,fCe=$y;function mCe(e){return e&&e.length?dCe(e,fCe,hCe):void 0}var pCe=mCe;const aP=Fn(pCe);var gCe=TI,xCe=ou,yCe=$7,vCe=No;function _Ce(e,t){var n=vCe(e)?gCe:yCe;return n(e,xCe(t))}var bCe=_Ce,jCe=F7,wCe=bCe;function SCe(e,t){return jCe(wCe(e,t),1)}var NCe=SCe;const PCe=Fn(NCe);var CCe=WI;function ACe(e,t){return CCe(e,t)}var kCe=ACe;const rf=Fn(kCe);var qy=1e9,TCe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},yD,zs=!0,Cl="[DecimalError] ",Am=Cl+"Invalid argument: ",xD=Cl+"Exponent out of range: ",Vy=Math.floor,om=Math.pow,ECe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Vo,ea=1e7,Ns=7,OG=9007199254740991,rN=Vy(OG/Ns),Sr={};Sr.absoluteValue=Sr.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Sr.comparedTo=Sr.cmp=function(e){var t,n,s,i,c=this;if(e=new c.constructor(e),c.s!==e.s)return c.s||-e.s;if(c.e!==e.e)return c.e>e.e^c.s<0?1:-1;for(s=c.d.length,i=e.d.length,t=0,n=s<i?s:i;t<n;++t)if(c.d[t]!==e.d[t])return c.d[t]>e.d[t]^c.s<0?1:-1;return s===i?0:s>i^c.s<0?1:-1};Sr.decimalPlaces=Sr.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*Ns;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};Sr.dividedBy=Sr.div=function(e){return td(this,new this.constructor(e))};Sr.dividedToIntegerBy=Sr.idiv=function(e){var t=this,n=t.constructor;return as(td(t,new n(e),0,1),n.precision)};Sr.equals=Sr.eq=function(e){return!this.cmp(e)};Sr.exponent=function(){return Ei(this)};Sr.greaterThan=Sr.gt=function(e){return this.cmp(e)>0};Sr.greaterThanOrEqualTo=Sr.gte=function(e){return this.cmp(e)>=0};Sr.isInteger=Sr.isint=function(){return this.e>this.d.length-2};Sr.isNegative=Sr.isneg=function(){return this.s<0};Sr.isPositive=Sr.ispos=function(){return this.s>0};Sr.isZero=function(){return this.s===0};Sr.lessThan=Sr.lt=function(e){return this.cmp(e)<0};Sr.lessThanOrEqualTo=Sr.lte=function(e){return this.cmp(e)<1};Sr.logarithm=Sr.log=function(e){var t,n=this,s=n.constructor,i=s.precision,c=i+5;if(e===void 0)e=new s(10);else if(e=new s(e),e.s<1||e.eq(Vo))throw Error(Cl+"NaN");if(n.s<1)throw Error(Cl+(n.s?"NaN":"-Infinity"));return n.eq(Vo)?new s(0):(zs=!1,t=td(Y0(n,c),Y0(e,c),c),zs=!0,as(t,i))};Sr.minus=Sr.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?RG(t,e):IG(t,(e.s=-e.s,e))};Sr.modulo=Sr.mod=function(e){var t,n=this,s=n.constructor,i=s.precision;if(e=new s(e),!e.s)throw Error(Cl+"NaN");return n.s?(zs=!1,t=td(n,e,0,1).times(e),zs=!0,n.minus(t)):as(new s(n),i)};Sr.naturalExponential=Sr.exp=function(){return DG(this)};Sr.naturalLogarithm=Sr.ln=function(){return Y0(this)};Sr.negated=Sr.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Sr.plus=Sr.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?IG(t,e):RG(t,(e.s=-e.s,e))};Sr.precision=Sr.sd=function(e){var t,n,s,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Am+e);if(t=Ei(i)+1,s=i.d.length-1,n=s*Ns+1,s=i.d[s],s){for(;s%10==0;s/=10)n--;for(s=i.d[0];s>=10;s/=10)n++}return e&&t>n?t:n};Sr.squareRoot=Sr.sqrt=function(){var e,t,n,s,i,c,u,a=this,m=a.constructor;if(a.s<1){if(!a.s)return new m(0);throw Error(Cl+"NaN")}for(e=Ei(a),zs=!1,i=Math.sqrt(+a),i==0||i==1/0?(t=qc(a.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=Vy((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),s=new m(t)):s=new m(i.toString()),n=m.precision,i=u=n+3;;)if(c=s,s=c.plus(td(a,c,u+2)).times(.5),qc(c.d).slice(0,u)===(t=qc(s.d)).slice(0,u)){if(t=t.slice(u-3,u+1),i==u&&t=="4999"){if(as(c,n+1,0),c.times(c).eq(a)){s=c;break}}else if(t!="9999")break;u+=4}return zs=!0,as(s,n)};Sr.times=Sr.mul=function(e){var t,n,s,i,c,u,a,m,p,y=this,v=y.constructor,j=y.d,S=(e=new v(e)).d;if(!y.s||!e.s)return new v(0);for(e.s*=y.s,n=y.e+e.e,m=j.length,p=S.length,m<p&&(c=j,j=S,S=c,u=m,m=p,p=u),c=[],u=m+p,s=u;s--;)c.push(0);for(s=p;--s>=0;){for(t=0,i=m+s;i>s;)a=c[i]+S[s]*j[i-s-1]+t,c[i--]=a%ea|0,t=a/ea|0;c[i]=(c[i]+t)%ea|0}for(;!c[--u];)c.pop();return t?++n:c.shift(),e.d=c,e.e=n,zs?as(e,v.precision):e};Sr.toDecimalPlaces=Sr.todp=function(e,t){var n=this,s=n.constructor;return n=new s(n),e===void 0?n:(eu(e,0,qy),t===void 0?t=s.rounding:eu(t,0,8),as(n,e+Ei(n)+1,t))};Sr.toExponential=function(e,t){var n,s=this,i=s.constructor;return e===void 0?n=Km(s,!0):(eu(e,0,qy),t===void 0?t=i.rounding:eu(t,0,8),s=as(new i(s),e+1,t),n=Km(s,!0,e+1)),n};Sr.toFixed=function(e,t){var n,s,i=this,c=i.constructor;return e===void 0?Km(i):(eu(e,0,qy),t===void 0?t=c.rounding:eu(t,0,8),s=as(new c(i),e+Ei(i)+1,t),n=Km(s.abs(),!1,e+Ei(s)+1),i.isneg()&&!i.isZero()?"-"+n:n)};Sr.toInteger=Sr.toint=function(){var e=this,t=e.constructor;return as(new t(e),Ei(e)+1,t.rounding)};Sr.toNumber=function(){return+this};Sr.toPower=Sr.pow=function(e){var t,n,s,i,c,u,a=this,m=a.constructor,p=12,y=+(e=new m(e));if(!e.s)return new m(Vo);if(a=new m(a),!a.s){if(e.s<1)throw Error(Cl+"Infinity");return a}if(a.eq(Vo))return a;if(s=m.precision,e.eq(Vo))return as(a,s);if(t=e.e,n=e.d.length-1,u=t>=n,c=a.s,u){if((n=y<0?-y:y)<=OG){for(i=new m(Vo),t=Math.ceil(s/Ns+4),zs=!1;n%2&&(i=i.times(a),I$(i.d,t)),n=Vy(n/2),n!==0;)a=a.times(a),I$(a.d,t);return zs=!0,e.s<0?new m(Vo).div(i):as(i,s)}}else if(c<0)throw Error(Cl+"NaN");return c=c<0&&e.d[Math.max(t,n)]&1?-1:1,a.s=1,zs=!1,i=e.times(Y0(a,s+p)),zs=!0,i=DG(i),i.s=c,i};Sr.toPrecision=function(e,t){var n,s,i=this,c=i.constructor;return e===void 0?(n=Ei(i),s=Km(i,n<=c.toExpNeg||n>=c.toExpPos)):(eu(e,1,qy),t===void 0?t=c.rounding:eu(t,0,8),i=as(new c(i),e,t),n=Ei(i),s=Km(i,e<=n||n<=c.toExpNeg,e)),s};Sr.toSignificantDigits=Sr.tosd=function(e,t){var n=this,s=n.constructor;return e===void 0?(e=s.precision,t=s.rounding):(eu(e,1,qy),t===void 0?t=s.rounding:eu(t,0,8)),as(new s(n),e,t)};Sr.toString=Sr.valueOf=Sr.val=Sr.toJSON=Sr[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Ei(e),n=e.constructor;return Km(e,t<=n.toExpNeg||t>=n.toExpPos)};function IG(e,t){var n,s,i,c,u,a,m,p,y=e.constructor,v=y.precision;if(!e.s||!t.s)return t.s||(t=new y(e)),zs?as(t,v):t;if(m=e.d,p=t.d,u=e.e,i=t.e,m=m.slice(),c=u-i,c){for(c<0?(s=m,c=-c,a=p.length):(s=p,i=u,a=m.length),u=Math.ceil(v/Ns),a=u>a?u+1:a+1,c>a&&(c=a,s.length=1),s.reverse();c--;)s.push(0);s.reverse()}for(a=m.length,c=p.length,a-c<0&&(c=a,s=p,p=m,m=s),n=0;c;)n=(m[--c]=m[c]+p[c]+n)/ea|0,m[c]%=ea;for(n&&(m.unshift(n),++i),a=m.length;m[--a]==0;)m.pop();return t.d=m,t.e=i,zs?as(t,v):t}function eu(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Am+e)}function qc(e){var t,n,s,i=e.length-1,c="",u=e[0];if(i>0){for(c+=u,t=1;t<i;t++)s=e[t]+"",n=Ns-s.length,n&&(c+=hh(n)),c+=s;u=e[t],s=u+"",n=Ns-s.length,n&&(c+=hh(n))}else if(u===0)return"0";for(;u%10===0;)u/=10;return c+u}var td=function(){function e(s,i){var c,u=0,a=s.length;for(s=s.slice();a--;)c=s[a]*i+u,s[a]=c%ea|0,u=c/ea|0;return u&&s.unshift(u),s}function t(s,i,c,u){var a,m;if(c!=u)m=c>u?1:-1;else for(a=m=0;a<c;a++)if(s[a]!=i[a]){m=s[a]>i[a]?1:-1;break}return m}function n(s,i,c){for(var u=0;c--;)s[c]-=u,u=s[c]<i[c]?1:0,s[c]=u*ea+s[c]-i[c];for(;!s[0]&&s.length>1;)s.shift()}return function(s,i,c,u){var a,m,p,y,v,j,S,k,N,D,O,T,I,z,$,V,K,te,X=s.constructor,ve=s.s==i.s?1:-1,ae=s.d,pe=i.d;if(!s.s)return new X(s);if(!i.s)throw Error(Cl+"Division by zero");for(m=s.e-i.e,K=pe.length,$=ae.length,S=new X(ve),k=S.d=[],p=0;pe[p]==(ae[p]||0);)++p;if(pe[p]>(ae[p]||0)&&--m,c==null?T=c=X.precision:u?T=c+(Ei(s)-Ei(i))+1:T=c,T<0)return new X(0);if(T=T/Ns+2|0,p=0,K==1)for(y=0,pe=pe[0],T++;(p<$||y)&&T--;p++)I=y*ea+(ae[p]||0),k[p]=I/pe|0,y=I%pe|0;else{for(y=ea/(pe[0]+1)|0,y>1&&(pe=e(pe,y),ae=e(ae,y),K=pe.length,$=ae.length),z=K,N=ae.slice(0,K),D=N.length;D<K;)N[D++]=0;te=pe.slice(),te.unshift(0),V=pe[0],pe[1]>=ea/2&&++V;do y=0,a=t(pe,N,K,D),a<0?(O=N[0],K!=D&&(O=O*ea+(N[1]||0)),y=O/V|0,y>1?(y>=ea&&(y=ea-1),v=e(pe,y),j=v.length,D=N.length,a=t(v,N,j,D),a==1&&(y--,n(v,K<j?te:pe,j))):(y==0&&(a=y=1),v=pe.slice()),j=v.length,j<D&&v.unshift(0),n(N,v,D),a==-1&&(D=N.length,a=t(pe,N,K,D),a<1&&(y++,n(N,K<D?te:pe,D))),D=N.length):a===0&&(y++,N=[0]),k[p++]=y,a&&N[0]?N[D++]=ae[z]||0:(N=[ae[z]],D=1);while((z++<$||N[0]!==void 0)&&T--)}return k[0]||k.shift(),S.e=m,as(S,u?c+Ei(S)+1:c)}}();function DG(e,t){var n,s,i,c,u,a,m=0,p=0,y=e.constructor,v=y.precision;if(Ei(e)>16)throw Error(xD+Ei(e));if(!e.s)return new y(Vo);for(zs=!1,a=v,u=new y(.03125);e.abs().gte(.1);)e=e.times(u),p+=5;for(s=Math.log(om(2,p))/Math.LN10*2+5|0,a+=s,n=i=c=new y(Vo),y.precision=a;;){if(i=as(i.times(e),a),n=n.times(++m),u=c.plus(td(i,n,a)),qc(u.d).slice(0,a)===qc(c.d).slice(0,a)){for(;p--;)c=as(c.times(c),a);return y.precision=v,t==null?(zs=!0,as(c,v)):c}c=u}}function Ei(e){for(var t=e.e*Ns,n=e.d[0];n>=10;n/=10)t++;return t}function XA(e,t,n){if(t>e.LN10.sd())throw zs=!0,n&&(e.precision=n),Error(Cl+"LN10 precision limit exceeded");return as(new e(e.LN10),t)}function hh(e){for(var t="";e--;)t+="0";return t}function Y0(e,t){var n,s,i,c,u,a,m,p,y,v=1,j=10,S=e,k=S.d,N=S.constructor,D=N.precision;if(S.s<1)throw Error(Cl+(S.s?"NaN":"-Infinity"));if(S.eq(Vo))return new N(0);if(t==null?(zs=!1,p=D):p=t,S.eq(10))return t==null&&(zs=!0),XA(N,p);if(p+=j,N.precision=p,n=qc(k),s=n.charAt(0),c=Ei(S),Math.abs(c)<15e14){for(;s<7&&s!=1||s==1&&n.charAt(1)>3;)S=S.times(e),n=qc(S.d),s=n.charAt(0),v++;c=Ei(S),s>1?(S=new N("0."+n),c++):S=new N(s+"."+n.slice(1))}else return m=XA(N,p+2,D).times(c+""),S=Y0(new N(s+"."+n.slice(1)),p-j).plus(m),N.precision=D,t==null?(zs=!0,as(S,D)):S;for(a=u=S=td(S.minus(Vo),S.plus(Vo),p),y=as(S.times(S),p),i=3;;){if(u=as(u.times(y),p),m=a.plus(td(u,new N(i),p)),qc(m.d).slice(0,p)===qc(a.d).slice(0,p))return a=a.times(2),c!==0&&(a=a.plus(XA(N,p+2,D).times(c+""))),a=td(a,new N(v),p),N.precision=D,t==null?(zs=!0,as(a,D)):a;a=m,i+=2}}function O$(e,t){var n,s,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(s=t.search(/e/i))>0?(n<0&&(n=s),n+=+t.slice(s+1),t=t.substring(0,s)):n<0&&(n=t.length),s=0;t.charCodeAt(s)===48;)++s;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(s,i),t){if(i-=s,n=n-s-1,e.e=Vy(n/Ns),e.d=[],s=(n+1)%Ns,n<0&&(s+=Ns),s<i){for(s&&e.d.push(+t.slice(0,s)),i-=Ns;s<i;)e.d.push(+t.slice(s,s+=Ns));t=t.slice(s),s=Ns-t.length}else s-=i;for(;s--;)t+="0";if(e.d.push(+t),zs&&(e.e>rN||e.e<-rN))throw Error(xD+n)}else e.s=0,e.e=0,e.d=[0];return e}function as(e,t,n){var s,i,c,u,a,m,p,y,v=e.d;for(u=1,c=v[0];c>=10;c/=10)u++;if(s=t-u,s<0)s+=Ns,i=t,p=v[y=0];else{if(y=Math.ceil((s+1)/Ns),c=v.length,y>=c)return e;for(p=c=v[y],u=1;c>=10;c/=10)u++;s%=Ns,i=s-Ns+u}if(n!==void 0&&(c=om(10,u-i-1),a=p/c%10|0,m=t<0||v[y+1]!==void 0||p%c,m=n<4?(a||m)&&(n==0||n==(e.s<0?3:2)):a>5||a==5&&(n==4||m||n==6&&(s>0?i>0?p/om(10,u-i):0:v[y-1])%10&1||n==(e.s<0?8:7))),t<1||!v[0])return m?(c=Ei(e),v.length=1,t=t-c-1,v[0]=om(10,(Ns-t%Ns)%Ns),e.e=Vy(-t/Ns)||0):(v.length=1,v[0]=e.e=e.s=0),e;if(s==0?(v.length=y,c=1,y--):(v.length=y+1,c=om(10,Ns-s),v[y]=i>0?(p/om(10,u-i)%om(10,i)|0)*c:0),m)for(;;)if(y==0){(v[0]+=c)==ea&&(v[0]=1,++e.e);break}else{if(v[y]+=c,v[y]!=ea)break;v[y--]=0,c=1}for(s=v.length;v[--s]===0;)v.pop();if(zs&&(e.e>rN||e.e<-rN))throw Error(xD+Ei(e));return e}function RG(e,t){var n,s,i,c,u,a,m,p,y,v,j=e.constructor,S=j.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new j(e),zs?as(t,S):t;if(m=e.d,v=t.d,s=t.e,p=e.e,m=m.slice(),u=p-s,u){for(y=u<0,y?(n=m,u=-u,a=v.length):(n=v,s=p,a=m.length),i=Math.max(Math.ceil(S/Ns),a)+2,u>i&&(u=i,n.length=1),n.reverse(),i=u;i--;)n.push(0);n.reverse()}else{for(i=m.length,a=v.length,y=i<a,y&&(a=i),i=0;i<a;i++)if(m[i]!=v[i]){y=m[i]<v[i];break}u=0}for(y&&(n=m,m=v,v=n,t.s=-t.s),a=m.length,i=v.length-a;i>0;--i)m[a++]=0;for(i=v.length;i>u;){if(m[--i]<v[i]){for(c=i;c&&m[--c]===0;)m[c]=ea-1;--m[c],m[i]+=ea}m[i]-=v[i]}for(;m[--a]===0;)m.pop();for(;m[0]===0;m.shift())--s;return m[0]?(t.d=m,t.e=s,zs?as(t,S):t):new j(0)}function Km(e,t,n){var s,i=Ei(e),c=qc(e.d),u=c.length;return t?(n&&(s=n-u)>0?c=c.charAt(0)+"."+c.slice(1)+hh(s):u>1&&(c=c.charAt(0)+"."+c.slice(1)),c=c+(i<0?"e":"e+")+i):i<0?(c="0."+hh(-i-1)+c,n&&(s=n-u)>0&&(c+=hh(s))):i>=u?(c+=hh(i+1-u),n&&(s=n-i-1)>0&&(c=c+"."+hh(s))):((s=i+1)<u&&(c=c.slice(0,s)+"."+c.slice(s)),n&&(s=n-u)>0&&(i+1===u&&(c+="."),c+=hh(s))),e.s<0?"-"+c:c}function I$(e,t){if(e.length>t)return e.length=t,!0}function LG(e){var t,n,s;function i(c){var u=this;if(!(u instanceof i))return new i(c);if(u.constructor=i,c instanceof i){u.s=c.s,u.e=c.e,u.d=(c=c.d)?c.slice():c;return}if(typeof c=="number"){if(c*0!==0)throw Error(Am+c);if(c>0)u.s=1;else if(c<0)c=-c,u.s=-1;else{u.s=0,u.e=0,u.d=[0];return}if(c===~~c&&c<1e7){u.e=0,u.d=[c];return}return O$(u,c.toString())}else if(typeof c!="string")throw Error(Am+c);if(c.charCodeAt(0)===45?(c=c.slice(1),u.s=-1):u.s=1,ECe.test(c))O$(u,c);else throw Error(Am+c)}if(i.prototype=Sr,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=LG,i.config=i.set=MCe,e===void 0&&(e={}),e)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<s.length;)e.hasOwnProperty(n=s[t++])||(e[n]=this[n]);return i.config(e),i}function MCe(e){if(!e||typeof e!="object")throw Error(Cl+"Object expected");var t,n,s,i=["precision",1,qy,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((s=e[n=i[t]])!==void 0)if(Vy(s)===s&&s>=i[t+1]&&s<=i[t+2])this[n]=s;else throw Error(Am+n+": "+s);if((s=e[n="LN10"])!==void 0)if(s==Math.LN10)this[n]=new this(s);else throw Error(Am+n+": "+s);return this}var yD=LG(TCe);Vo=new yD(1);const ts=yD;function OCe(e){return LCe(e)||RCe(e)||DCe(e)||ICe()}function ICe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DCe(e,t){if(e){if(typeof e=="string")return EE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return EE(e,t)}}function RCe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function LCe(e){if(Array.isArray(e))return EE(e)}function EE(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}var FCe=function(t){return t},FG={},zG=function(t){return t===FG},D$=function(t){return function n(){return arguments.length===0||arguments.length===1&&zG(arguments.length<=0?void 0:arguments[0])?n:t.apply(void 0,arguments)}},zCe=function e(t,n){return t===1?n:D$(function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];var u=i.filter(function(a){return a!==FG}).length;return u>=t?n.apply(void 0,i):e(t-u,D$(function(){for(var a=arguments.length,m=new Array(a),p=0;p<a;p++)m[p]=arguments[p];var y=i.map(function(v){return zG(v)?m.shift():v});return n.apply(void 0,OCe(y).concat(m))}))})},oP=function(t){return zCe(t.length,t)},ME=function(t,n){for(var s=[],i=t;i<n;++i)s[i-t]=i;return s},$Ce=oP(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),BCe=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];if(!n.length)return FCe;var i=n.reverse(),c=i[0],u=i.slice(1);return function(){return u.reduce(function(a,m){return m(a)},c.apply(void 0,arguments))}},OE=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},$G=function(t){var n=null,s=null;return function(){for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return n&&c.every(function(a,m){return a===n[m]})||(n=c,s=t.apply(void 0,c)),s}};function qCe(e){var t;return e===0?t=1:t=Math.floor(new ts(e).abs().log(10).toNumber())+1,t}function VCe(e,t,n){for(var s=new ts(e),i=0,c=[];s.lt(t)&&i<1e5;)c.push(s.toNumber()),s=s.add(n),i++;return c}var UCe=oP(function(e,t,n){var s=+e,i=+t;return s+n*(i-s)}),WCe=oP(function(e,t,n){var s=t-+e;return s=s||1/0,(n-e)/s}),GCe=oP(function(e,t,n){var s=t-+e;return s=s||1/0,Math.max(0,Math.min(1,(n-e)/s))});const lP={rangeStep:VCe,getDigitCount:qCe,interpolateNumber:UCe,uninterpolateNumber:WCe,uninterpolateTruncation:GCe};function IE(e){return ZCe(e)||HCe(e)||BG(e)||KCe()}function KCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HCe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function ZCe(e){if(Array.isArray(e))return DE(e)}function X0(e,t){return QCe(e)||XCe(e,t)||BG(e,t)||YCe()}function YCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BG(e,t){if(e){if(typeof e=="string")return DE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return DE(e,t)}}function DE(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function XCe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],s=!0,i=!1,c=void 0;try{for(var u=e[Symbol.iterator](),a;!(s=(a=u.next()).done)&&(n.push(a.value),!(t&&n.length===t));s=!0);}catch(m){i=!0,c=m}finally{try{!s&&u.return!=null&&u.return()}finally{if(i)throw c}}return n}}function QCe(e){if(Array.isArray(e))return e}function qG(e){var t=X0(e,2),n=t[0],s=t[1],i=n,c=s;return n>s&&(i=s,c=n),[i,c]}function VG(e,t,n){if(e.lte(0))return new ts(0);var s=lP.getDigitCount(e.toNumber()),i=new ts(10).pow(s),c=e.div(i),u=s!==1?.05:.1,a=new ts(Math.ceil(c.div(u).toNumber())).add(n).mul(u),m=a.mul(i);return t?m:new ts(Math.ceil(m))}function JCe(e,t,n){var s=1,i=new ts(e);if(!i.isint()&&n){var c=Math.abs(e);c<1?(s=new ts(10).pow(lP.getDigitCount(e)-1),i=new ts(Math.floor(i.div(s).toNumber())).mul(s)):c>1&&(i=new ts(Math.floor(e)))}else e===0?i=new ts(Math.floor((t-1)/2)):n||(i=new ts(Math.floor(e)));var u=Math.floor((t-1)/2),a=BCe($Ce(function(m){return i.add(new ts(m-u).mul(s)).toNumber()}),ME);return a(0,t)}function UG(e,t,n,s){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new ts(0),tickMin:new ts(0),tickMax:new ts(0)};var c=VG(new ts(t).sub(e).div(n-1),s,i),u;e<=0&&t>=0?u=new ts(0):(u=new ts(e).add(t).div(2),u=u.sub(new ts(u).mod(c)));var a=Math.ceil(u.sub(e).div(c).toNumber()),m=Math.ceil(new ts(t).sub(u).div(c).toNumber()),p=a+m+1;return p>n?UG(e,t,n,s,i+1):(p<n&&(m=t>0?m+(n-p):m,a=t>0?a:a+(n-p)),{step:c,tickMin:u.sub(new ts(a).mul(c)),tickMax:u.add(new ts(m).mul(c))})}function eAe(e){var t=X0(e,2),n=t[0],s=t[1],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,u=Math.max(i,2),a=qG([n,s]),m=X0(a,2),p=m[0],y=m[1];if(p===-1/0||y===1/0){var v=y===1/0?[p].concat(IE(ME(0,i-1).map(function(){return 1/0}))):[].concat(IE(ME(0,i-1).map(function(){return-1/0})),[y]);return n>s?OE(v):v}if(p===y)return JCe(p,i,c);var j=UG(p,y,u,c),S=j.step,k=j.tickMin,N=j.tickMax,D=lP.rangeStep(k,N.add(new ts(.1).mul(S)),S);return n>s?OE(D):D}function tAe(e,t){var n=X0(e,2),s=n[0],i=n[1],c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,u=qG([s,i]),a=X0(u,2),m=a[0],p=a[1];if(m===-1/0||p===1/0)return[s,i];if(m===p)return[m];var y=Math.max(t,2),v=VG(new ts(p).sub(m).div(y-1),c,0),j=[].concat(IE(lP.rangeStep(new ts(m),new ts(p).sub(new ts(.99).mul(v)),v)),[p]);return s>i?OE(j):j}var rAe=$G(eAe),nAe=$G(tAe),sAe="Invariant failed";function Hm(e,t){throw new Error(sAe)}var iAe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Kx(e){"@babel/helpers - typeof";return Kx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kx(e)}function nN(){return nN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},nN.apply(this,arguments)}function aAe(e,t){return uAe(e)||cAe(e,t)||lAe(e,t)||oAe()}function oAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lAe(e,t){if(e){if(typeof e=="string")return R$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R$(e,t)}}function R$(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function cAe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,c,u,a=[],m=!0,p=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(m=(s=c.call(n)).done)&&(a.push(s.value),a.length!==t);m=!0);}catch(y){p=!0,i=y}finally{try{if(!m&&n.return!=null&&(u=n.return(),Object(u)!==u))return}finally{if(p)throw i}}return a}}function uAe(e){if(Array.isArray(e))return e}function dAe(e,t){if(e==null)return{};var n=hAe(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function hAe(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function fAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mAe(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,KG(s.key),s)}}function pAe(e,t,n){return t&&mAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function gAe(e,t,n){return t=sN(t),xAe(e,WG()?Reflect.construct(t,n||[],sN(e).constructor):t.apply(e,n))}function xAe(e,t){if(t&&(Kx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yAe(e)}function yAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(WG=function(){return!!e})()}function sN(e){return sN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},sN(e)}function vAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RE(e,t)}function RE(e,t){return RE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},RE(e,t)}function GG(e,t,n){return t=KG(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KG(e){var t=_Ae(e,"string");return Kx(t)=="symbol"?t:t+""}function _Ae(e,t){if(Kx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(Kx(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Kb=function(e){function t(){return fAe(this,t),gAe(this,t,arguments)}return vAe(t,e),pAe(t,[{key:"render",value:function(){var s=this.props,i=s.offset,c=s.layout,u=s.width,a=s.dataKey,m=s.data,p=s.dataPointFormatter,y=s.xAxis,v=s.yAxis,j=dAe(s,iAe),S=Cr(j,!1);this.props.direction==="x"&&y.type!=="number"&&Hm();var k=m.map(function(N){var D=p(N,a),O=D.x,T=D.y,I=D.value,z=D.errorVal;if(!z)return null;var $=[],V,K;if(Array.isArray(z)){var te=aAe(z,2);V=te[0],K=te[1]}else V=K=z;if(c==="vertical"){var X=y.scale,ve=T+i,ae=ve+u,pe=ve-u,Oe=X(I-V),Me=X(I+K);$.push({x1:Me,y1:ae,x2:Me,y2:pe}),$.push({x1:Oe,y1:ve,x2:Me,y2:ve}),$.push({x1:Oe,y1:ae,x2:Oe,y2:pe})}else if(c==="horizontal"){var Xe=v.scale,Ve=O+i,et=Ve-u,Ce=Ve+u,_e=Xe(I-V),tt=Xe(I+K);$.push({x1:et,y1:tt,x2:Ce,y2:tt}),$.push({x1:Ve,y1:_e,x2:Ve,y2:tt}),$.push({x1:et,y1:_e,x2:Ce,y2:_e})}return de.createElement(xn,nN({className:"recharts-errorBar",key:"bar-".concat($.map(function(vt){return"".concat(vt.x1,"-").concat(vt.x2,"-").concat(vt.y1,"-").concat(vt.y2)}))},S),$.map(function(vt){return de.createElement("line",nN({},vt,{key:"line-".concat(vt.x1,"-").concat(vt.x2,"-").concat(vt.y1,"-").concat(vt.y2)}))}))});return de.createElement(xn,{className:"recharts-errorBars"},k)}}])}(de.Component);GG(Kb,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});GG(Kb,"displayName","ErrorBar");function Q0(e){"@babel/helpers - typeof";return Q0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q0(e)}function L$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Jf(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?L$(Object(n),!0).forEach(function(s){bAe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function bAe(e,t,n){return t=jAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jAe(e){var t=wAe(e,"string");return Q0(t)=="symbol"?t:t+""}function wAe(e,t){if(Q0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(Q0(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HG=function(t){var n=t.children,s=t.formattedGraphicalItems,i=t.legendWidth,c=t.legendContent,u=zo(n,sa);if(!u)return null;var a=sa.defaultProps,m=a!==void 0?Jf(Jf({},a),u.props):{},p;return u.props&&u.props.payload?p=u.props&&u.props.payload:c==="children"?p=(s||[]).reduce(function(y,v){var j=v.item,S=v.props,k=S.sectors||S.data||[];return y.concat(k.map(function(N){return{type:u.props.iconType||j.props.legendType,value:N.name,color:N.fill,payload:N}}))},[]):p=(s||[]).map(function(y){var v=y.item,j=v.type.defaultProps,S=j!==void 0?Jf(Jf({},j),v.props):{},k=S.dataKey,N=S.name,D=S.legendType,O=S.hide;return{inactive:O,dataKey:k,type:m.iconType||D||"square",color:vD(v),value:N||k,payload:S}}),Jf(Jf(Jf({},m),sa.getWithHeight(u,i)),{},{payload:p,item:u})};function J0(e){"@babel/helpers - typeof";return J0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J0(e)}function F$(e){return CAe(e)||PAe(e)||NAe(e)||SAe()}function SAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NAe(e,t){if(e){if(typeof e=="string")return LE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return LE(e,t)}}function PAe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function CAe(e){if(Array.isArray(e))return LE(e)}function LE(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function z$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function li(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?z$(Object(n),!0).forEach(function(s){rx(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function rx(e,t,n){return t=AAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AAe(e){var t=kAe(e,"string");return J0(t)=="symbol"?t:t+""}function kAe(e,t){if(J0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(J0(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ys(e,t,n){return Zr(e)||Zr(t)?n:Ui(t)?Zo(e,t,n):Br(t)?t(e):n}function r0(e,t,n,s){var i=PCe(e,function(a){return Ys(a,t)});if(n==="number"){var c=i.filter(function(a){return Ut(a)||parseFloat(a)});return c.length?[aP(c),Th(c)]:[1/0,-1/0]}var u=s?i.filter(function(a){return!Zr(a)}):i;return u.map(function(a){return Ui(a)||a instanceof Date?a:""})}var TAe=function(t){var n,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0,u=-1,a=(n=s==null?void 0:s.length)!==null&&n!==void 0?n:0;if(a<=1)return 0;if(c&&c.axisType==="angleAxis"&&Math.abs(Math.abs(c.range[1]-c.range[0])-360)<=1e-6)for(var m=c.range,p=0;p<a;p++){var y=p>0?i[p-1].coordinate:i[a-1].coordinate,v=i[p].coordinate,j=p>=a-1?i[0].coordinate:i[p+1].coordinate,S=void 0;if(Ya(v-y)!==Ya(j-v)){var k=[];if(Ya(j-v)===Ya(m[1]-m[0])){S=j;var N=v+m[1]-m[0];k[0]=Math.min(N,(N+y)/2),k[1]=Math.max(N,(N+y)/2)}else{S=y;var D=j+m[1]-m[0];k[0]=Math.min(v,(D+v)/2),k[1]=Math.max(v,(D+v)/2)}var O=[Math.min(v,(S+v)/2),Math.max(v,(S+v)/2)];if(t>O[0]&&t<=O[1]||t>=k[0]&&t<=k[1]){u=i[p].index;break}}else{var T=Math.min(y,j),I=Math.max(y,j);if(t>(T+v)/2&&t<=(I+v)/2){u=i[p].index;break}}}else for(var z=0;z<a;z++)if(z===0&&t<=(s[z].coordinate+s[z+1].coordinate)/2||z>0&&z<a-1&&t>(s[z].coordinate+s[z-1].coordinate)/2&&t<=(s[z].coordinate+s[z+1].coordinate)/2||z===a-1&&t>(s[z].coordinate+s[z-1].coordinate)/2){u=s[z].index;break}return u},vD=function(t){var n,s=t,i=s.type.displayName,c=(n=t.type)!==null&&n!==void 0&&n.defaultProps?li(li({},t.type.defaultProps),t.props):t.props,u=c.stroke,a=c.fill,m;switch(i){case"Line":m=u;break;case"Area":case"Radar":m=u&&u!=="none"?u:a;break;default:m=a;break}return m},EAe=function(t){var n=t.barSize,s=t.totalSize,i=t.stackGroups,c=i===void 0?{}:i;if(!c)return{};for(var u={},a=Object.keys(c),m=0,p=a.length;m<p;m++)for(var y=c[a[m]].stackGroups,v=Object.keys(y),j=0,S=v.length;j<S;j++){var k=y[v[j]],N=k.items,D=k.cateAxisId,O=N.filter(function(K){return ed(K.type).indexOf("Bar")>=0});if(O&&O.length){var T=O[0].type.defaultProps,I=T!==void 0?li(li({},T),O[0].props):O[0].props,z=I.barSize,$=I[D];u[$]||(u[$]=[]);var V=Zr(z)?n:z;u[$].push({item:O[0],stackList:O.slice(1),barSize:Zr(V)?void 0:Xa(V,s,0)})}}return u},MAe=function(t){var n=t.barGap,s=t.barCategoryGap,i=t.bandSize,c=t.sizeList,u=c===void 0?[]:c,a=t.maxBarSize,m=u.length;if(m<1)return null;var p=Xa(n,i,0,!0),y,v=[];if(u[0].barSize===+u[0].barSize){var j=!1,S=i/m,k=u.reduce(function(z,$){return z+$.barSize||0},0);k+=(m-1)*p,k>=i&&(k-=(m-1)*p,p=0),k>=i&&S>0&&(j=!0,S*=.9,k=m*S);var N=(i-k)/2>>0,D={offset:N-p,size:0};y=u.reduce(function(z,$){var V={item:$.item,position:{offset:D.offset+D.size+p,size:j?S:$.barSize}},K=[].concat(F$(z),[V]);return D=K[K.length-1].position,$.stackList&&$.stackList.length&&$.stackList.forEach(function(te){K.push({item:te,position:D})}),K},v)}else{var O=Xa(s,i,0,!0);i-2*O-(m-1)*p<=0&&(p=0);var T=(i-2*O-(m-1)*p)/m;T>1&&(T>>=0);var I=a===+a?Math.min(T,a):T;y=u.reduce(function(z,$,V){var K=[].concat(F$(z),[{item:$.item,position:{offset:O+(T+p)*V+(T-I)/2,size:I}}]);return $.stackList&&$.stackList.length&&$.stackList.forEach(function(te){K.push({item:te,position:K[K.length-1].position})}),K},v)}return y},OAe=function(t,n,s,i){var c=s.children,u=s.width,a=s.margin,m=u-(a.left||0)-(a.right||0),p=HG({children:c,legendWidth:m});if(p){var y=i||{},v=y.width,j=y.height,S=p.align,k=p.verticalAlign,N=p.layout;if((N==="vertical"||N==="horizontal"&&k==="middle")&&S!=="center"&&Ut(t[S]))return li(li({},t),{},rx({},S,t[S]+(v||0)));if((N==="horizontal"||N==="vertical"&&S==="center")&&k!=="middle"&&Ut(t[k]))return li(li({},t),{},rx({},k,t[k]+(j||0)))}return t},IAe=function(t,n,s){return Zr(n)?!0:t==="horizontal"?n==="yAxis":t==="vertical"||s==="x"?n==="xAxis":s==="y"?n==="yAxis":!0},ZG=function(t,n,s,i,c){var u=n.props.children,a=Yo(u,Kb).filter(function(p){return IAe(i,c,p.props.direction)});if(a&&a.length){var m=a.map(function(p){return p.props.dataKey});return t.reduce(function(p,y){var v=Ys(y,s);if(Zr(v))return p;var j=Array.isArray(v)?[aP(v),Th(v)]:[v,v],S=m.reduce(function(k,N){var D=Ys(y,N,0),O=j[0]-Math.abs(Array.isArray(D)?D[0]:D),T=j[1]+Math.abs(Array.isArray(D)?D[1]:D);return[Math.min(O,k[0]),Math.max(T,k[1])]},[1/0,-1/0]);return[Math.min(S[0],p[0]),Math.max(S[1],p[1])]},[1/0,-1/0])}return null},DAe=function(t,n,s,i,c){var u=n.map(function(a){return ZG(t,a,s,c,i)}).filter(function(a){return!Zr(a)});return u&&u.length?u.reduce(function(a,m){return[Math.min(a[0],m[0]),Math.max(a[1],m[1])]},[1/0,-1/0]):null},YG=function(t,n,s,i,c){var u=n.map(function(m){var p=m.props.dataKey;return s==="number"&&p&&ZG(t,m,p,i)||r0(t,p,s,c)});if(s==="number")return u.reduce(function(m,p){return[Math.min(m[0],p[0]),Math.max(m[1],p[1])]},[1/0,-1/0]);var a={};return u.reduce(function(m,p){for(var y=0,v=p.length;y<v;y++)a[p[y]]||(a[p[y]]=!0,m.push(p[y]));return m},[])},XG=function(t,n){return t==="horizontal"&&n==="xAxis"||t==="vertical"&&n==="yAxis"||t==="centric"&&n==="angleAxis"||t==="radial"&&n==="radiusAxis"},QG=function(t,n,s,i){if(i)return t.map(function(m){return m.coordinate});var c,u,a=t.map(function(m){return m.coordinate===n&&(c=!0),m.coordinate===s&&(u=!0),m.coordinate});return c||a.push(n),u||a.push(s),a},Zu=function(t,n,s){if(!t)return null;var i=t.scale,c=t.duplicateDomain,u=t.type,a=t.range,m=t.realScaleType==="scaleBand"?i.bandwidth()/2:2,p=(n||s)&&u==="category"&&i.bandwidth?i.bandwidth()/m:0;if(p=t.axisType==="angleAxis"&&(a==null?void 0:a.length)>=2?Ya(a[0]-a[1])*2*p:p,n&&(t.ticks||t.niceTicks)){var y=(t.ticks||t.niceTicks).map(function(v){var j=c?c.indexOf(v):v;return{coordinate:i(j)+p,value:v,offset:p}});return y.filter(function(v){return!Ly(v.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(v,j){return{coordinate:i(v)+p,value:v,index:j,offset:p}}):i.ticks&&!s?i.ticks(t.tickCount).map(function(v){return{coordinate:i(v)+p,value:v,offset:p}}):i.domain().map(function(v,j){return{coordinate:i(v)+p,value:c?c[v]:v,index:j,offset:p}})},QA=new WeakMap,l1=function(t,n){if(typeof n!="function")return t;QA.has(t)||QA.set(t,new WeakMap);var s=QA.get(t);if(s.has(n))return s.get(n);var i=function(){t.apply(void 0,arguments),n.apply(void 0,arguments)};return s.set(n,i),i},JG=function(t,n,s){var i=t.scale,c=t.type,u=t.layout,a=t.axisType;if(i==="auto")return u==="radial"&&a==="radiusAxis"?{scale:W0(),realScaleType:"band"}:u==="radial"&&a==="angleAxis"?{scale:QS(),realScaleType:"linear"}:c==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!s)?{scale:t0(),realScaleType:"point"}:c==="category"?{scale:W0(),realScaleType:"band"}:{scale:QS(),realScaleType:"linear"};if(Bb(i)){var m="scale".concat(G2(i));return{scale:(M$[m]||t0)(),realScaleType:M$[m]?m:"point"}}return Br(i)?{scale:i}:{scale:t0(),realScaleType:"point"}},$$=1e-4,eK=function(t){var n=t.domain();if(!(!n||n.length<=2)){var s=n.length,i=t.range(),c=Math.min(i[0],i[1])-$$,u=Math.max(i[0],i[1])+$$,a=t(n[0]),m=t(n[s-1]);(a<c||a>u||m<c||m>u)&&t.domain([n[0],n[s-1]])}},RAe=function(t,n){if(!t)return null;for(var s=0,i=t.length;s<i;s++)if(t[s].item===n)return t[s].position;return null},LAe=function(t,n){if(!n||n.length!==2||!Ut(n[0])||!Ut(n[1]))return t;var s=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]),c=[t[0],t[1]];return(!Ut(t[0])||t[0]<s)&&(c[0]=s),(!Ut(t[1])||t[1]>i)&&(c[1]=i),c[0]>i&&(c[0]=i),c[1]<s&&(c[1]=s),c},FAe=function(t){var n=t.length;if(!(n<=0))for(var s=0,i=t[0].length;s<i;++s)for(var c=0,u=0,a=0;a<n;++a){var m=Ly(t[a][s][1])?t[a][s][0]:t[a][s][1];m>=0?(t[a][s][0]=c,t[a][s][1]=c+m,c=t[a][s][1]):(t[a][s][0]=u,t[a][s][1]=u+m,u=t[a][s][1])}},zAe=function(t){var n=t.length;if(!(n<=0))for(var s=0,i=t[0].length;s<i;++s)for(var c=0,u=0;u<n;++u){var a=Ly(t[u][s][1])?t[u][s][0]:t[u][s][1];a>=0?(t[u][s][0]=c,t[u][s][1]=c+a,c=t[u][s][1]):(t[u][s][0]=0,t[u][s][1]=0)}},$Ae={sign:FAe,expand:iye,none:zx,silhouette:aye,wiggle:oye,positive:zAe},BAe=function(t,n,s){var i=n.map(function(a){return a.props.dataKey}),c=$Ae[s],u=sye().keys(i).value(function(a,m){return+Ys(a,m,0)}).order(lE).offset(c);return u(t)},qAe=function(t,n,s,i,c,u){if(!t)return null;var a=u?n.reverse():n,m={},p=a.reduce(function(v,j){var S,k=(S=j.type)!==null&&S!==void 0&&S.defaultProps?li(li({},j.type.defaultProps),j.props):j.props,N=k.stackId,D=k.hide;if(D)return v;var O=k[s],T=v[O]||{hasStack:!1,stackGroups:{}};if(Ui(N)){var I=T.stackGroups[N]||{numericAxisId:s,cateAxisId:i,items:[]};I.items.push(j),T.hasStack=!0,T.stackGroups[N]=I}else T.stackGroups[tp("_stackId_")]={numericAxisId:s,cateAxisId:i,items:[j]};return li(li({},v),{},rx({},O,T))},m),y={};return Object.keys(p).reduce(function(v,j){var S=p[j];if(S.hasStack){var k={};S.stackGroups=Object.keys(S.stackGroups).reduce(function(N,D){var O=S.stackGroups[D];return li(li({},N),{},rx({},D,{numericAxisId:s,cateAxisId:i,items:O.items,stackedData:BAe(t,O.items,c)}))},k)}return li(li({},v),{},rx({},j,S))},y)},tK=function(t,n){var s=n.realScaleType,i=n.type,c=n.tickCount,u=n.originalDomain,a=n.allowDecimals,m=s||n.scale;if(m!=="auto"&&m!=="linear")return null;if(c&&i==="number"&&u&&(u[0]==="auto"||u[1]==="auto")){var p=t.domain();if(!p.length)return null;var y=rAe(p,c,a);return t.domain([aP(y),Th(y)]),{niceTicks:y}}if(c&&i==="number"){var v=t.domain(),j=nAe(v,c,a);return{niceTicks:j}}return null};function iN(e){var t=e.axis,n=e.ticks,s=e.bandSize,i=e.entry,c=e.index,u=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Zr(i[t.dataKey])){var a=ES(n,"value",i[t.dataKey]);if(a)return a.coordinate+s/2}return n[c]?n[c].coordinate+s/2:null}var m=Ys(i,Zr(u)?t.dataKey:u);return Zr(m)?null:t.scale(m)}var B$=function(t){var n=t.axis,s=t.ticks,i=t.offset,c=t.bandSize,u=t.entry,a=t.index;if(n.type==="category")return s[a]?s[a].coordinate+i:null;var m=Ys(u,n.dataKey,n.domain[a]);return Zr(m)?null:n.scale(m)-c/2+i},VAe=function(t){var n=t.numericAxis,s=n.scale.domain();if(n.type==="number"){var i=Math.min(s[0],s[1]),c=Math.max(s[0],s[1]);return i<=0&&c>=0?0:c<0?c:i}return s[0]},UAe=function(t,n){var s,i=(s=t.type)!==null&&s!==void 0&&s.defaultProps?li(li({},t.type.defaultProps),t.props):t.props,c=i.stackId;if(Ui(c)){var u=n[c];if(u){var a=u.items.indexOf(t);return a>=0?u.stackedData[a]:null}}return null},WAe=function(t){return t.reduce(function(n,s){return[aP(s.concat([n[0]]).filter(Ut)),Th(s.concat([n[1]]).filter(Ut))]},[1/0,-1/0])},rK=function(t,n,s){return Object.keys(t).reduce(function(i,c){var u=t[c],a=u.stackedData,m=a.reduce(function(p,y){var v=WAe(y.slice(n,s+1));return[Math.min(p[0],v[0]),Math.max(p[1],v[1])]},[1/0,-1/0]);return[Math.min(m[0],i[0]),Math.max(m[1],i[1])]},[1/0,-1/0]).map(function(i){return i===1/0||i===-1/0?0:i})},q$=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,V$=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,FE=function(t,n,s){if(Br(t))return t(n,s);if(!Array.isArray(t))return n;var i=[];if(Ut(t[0]))i[0]=s?t[0]:Math.min(t[0],n[0]);else if(q$.test(t[0])){var c=+q$.exec(t[0])[1];i[0]=n[0]-c}else Br(t[0])?i[0]=t[0](n[0]):i[0]=n[0];if(Ut(t[1]))i[1]=s?t[1]:Math.max(t[1],n[1]);else if(V$.test(t[1])){var u=+V$.exec(t[1])[1];i[1]=n[1]+u}else Br(t[1])?i[1]=t[1](n[1]):i[1]=n[1];return i},aN=function(t,n,s){if(t&&t.scale&&t.scale.bandwidth){var i=t.scale.bandwidth();if(!s||i>0)return i}if(t&&n&&n.length>=2){for(var c=KI(n,function(v){return v.coordinate}),u=1/0,a=1,m=c.length;a<m;a++){var p=c[a],y=c[a-1];u=Math.min((p.coordinate||0)-(y.coordinate||0),u)}return u===1/0?0:u}return s?void 0:0},U$=function(t,n,s){return!t||!t.length||rf(t,Zo(s,"type.defaultProps.domain"))?n:t},nK=function(t,n){var s=t.type.defaultProps?li(li({},t.type.defaultProps),t.props):t.props,i=s.dataKey,c=s.name,u=s.unit,a=s.formatter,m=s.tooltipType,p=s.chartType,y=s.hide;return li(li({},Cr(t,!1)),{},{dataKey:i,unit:u,formatter:a,name:c||i,color:vD(t),value:Ys(n,i),type:m,payload:n,chartType:p,hide:y})};function eb(e){"@babel/helpers - typeof";return eb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eb(e)}function W$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function $u(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?W$(Object(n),!0).forEach(function(s){sK(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function sK(e,t,n){return t=GAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GAe(e){var t=KAe(e,"string");return eb(t)=="symbol"?t:t+""}function KAe(e,t){if(eb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(eb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HAe(e,t){return QAe(e)||XAe(e,t)||YAe(e,t)||ZAe()}function ZAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YAe(e,t){if(e){if(typeof e=="string")return G$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G$(e,t)}}function G$(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function XAe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,c,u,a=[],m=!0,p=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(m=(s=c.call(n)).done)&&(a.push(s.value),a.length!==t);m=!0);}catch(y){p=!0,i=y}finally{try{if(!m&&n.return!=null&&(u=n.return(),Object(u)!==u))return}finally{if(p)throw i}}return a}}function QAe(e){if(Array.isArray(e))return e}var oN=Math.PI/180,JAe=function(t){return t*180/Math.PI},$n=function(t,n,s,i){return{x:t+Math.cos(-oN*i)*s,y:n+Math.sin(-oN*i)*s}},iK=function(t,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(s.left||0)-(s.right||0)),Math.abs(n-(s.top||0)-(s.bottom||0)))/2},aK=function(t,n,s,i,c){var u=t.width,a=t.height,m=t.startAngle,p=t.endAngle,y=Xa(t.cx,u,u/2),v=Xa(t.cy,a,a/2),j=iK(u,a,s),S=Xa(t.innerRadius,j,0),k=Xa(t.outerRadius,j,j*.8),N=Object.keys(n);return N.reduce(function(D,O){var T=n[O],I=T.domain,z=T.reversed,$;if(Zr(T.range))i==="angleAxis"?$=[m,p]:i==="radiusAxis"&&($=[S,k]),z&&($=[$[1],$[0]]);else{$=T.range;var V=$,K=HAe(V,2);m=K[0],p=K[1]}var te=JG(T,c),X=te.realScaleType,ve=te.scale;ve.domain(I).range($),eK(ve);var ae=tK(ve,$u($u({},T),{},{realScaleType:X})),pe=$u($u($u({},T),ae),{},{range:$,radius:k,realScaleType:X,scale:ve,cx:y,cy:v,innerRadius:S,outerRadius:k,startAngle:m,endAngle:p});return $u($u({},D),{},sK({},O,pe))},{})},eke=function(t,n){var s=t.x,i=t.y,c=n.x,u=n.y;return Math.sqrt(Math.pow(s-c,2)+Math.pow(i-u,2))},tke=function(t,n){var s=t.x,i=t.y,c=n.cx,u=n.cy,a=eke({x:s,y:i},{x:c,y:u});if(a<=0)return{radius:a};var m=(s-c)/a,p=Math.acos(m);return i>u&&(p=2*Math.PI-p),{radius:a,angle:JAe(p),angleInRadian:p}},rke=function(t){var n=t.startAngle,s=t.endAngle,i=Math.floor(n/360),c=Math.floor(s/360),u=Math.min(i,c);return{startAngle:n-u*360,endAngle:s-u*360}},nke=function(t,n){var s=n.startAngle,i=n.endAngle,c=Math.floor(s/360),u=Math.floor(i/360),a=Math.min(c,u);return t+a*360},K$=function(t,n){var s=t.x,i=t.y,c=tke({x:s,y:i},n),u=c.radius,a=c.angle,m=n.innerRadius,p=n.outerRadius;if(u<m||u>p)return!1;if(u===0)return!0;var y=rke(n),v=y.startAngle,j=y.endAngle,S=a,k;if(v<=j){for(;S>j;)S-=360;for(;S<v;)S+=360;k=S>=v&&S<=j}else{for(;S>v;)S-=360;for(;S<j;)S+=360;k=S>=j&&S<=v}return k?$u($u({},n),{},{radius:u,angle:nke(S,n)}):null},oK=function(t){return!R.isValidElement(t)&&!Br(t)&&typeof t!="boolean"?t.className:""};function tb(e){"@babel/helpers - typeof";return tb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tb(e)}var ske=["offset"];function ike(e){return cke(e)||lke(e)||oke(e)||ake()}function ake(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oke(e,t){if(e){if(typeof e=="string")return zE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zE(e,t)}}function lke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cke(e){if(Array.isArray(e))return zE(e)}function zE(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function uke(e,t){if(e==null)return{};var n=dke(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function dke(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function H$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function zi(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?H$(Object(n),!0).forEach(function(s){hke(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function hke(e,t,n){return t=fke(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fke(e){var t=mke(e,"string");return tb(t)=="symbol"?t:t+""}function mke(e,t){if(tb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(tb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rb(){return rb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},rb.apply(this,arguments)}var pke=function(t){var n=t.value,s=t.formatter,i=Zr(t.children)?n:t.children;return Br(s)?s(i):i},gke=function(t,n){var s=Ya(n-t),i=Math.min(Math.abs(n-t),360);return s*i},xke=function(t,n,s){var i=t.position,c=t.viewBox,u=t.offset,a=t.className,m=c,p=m.cx,y=m.cy,v=m.innerRadius,j=m.outerRadius,S=m.startAngle,k=m.endAngle,N=m.clockWise,D=(v+j)/2,O=gke(S,k),T=O>=0?1:-1,I,z;i==="insideStart"?(I=S+T*u,z=N):i==="insideEnd"?(I=k-T*u,z=!N):i==="end"&&(I=k+T*u,z=N),z=O<=0?z:!z;var $=$n(p,y,D,I),V=$n(p,y,D,I+(z?1:-1)*359),K="M".concat($.x,",").concat($.y,`
    A`).concat(D,",").concat(D,",0,1,").concat(z?0:1,`,
    `).concat(V.x,",").concat(V.y),te=Zr(t.id)?tp("recharts-radial-line-"):t.id;return de.createElement("text",rb({},s,{dominantBaseline:"central",className:Yr("recharts-radial-bar-label",a)}),de.createElement("defs",null,de.createElement("path",{id:te,d:K})),de.createElement("textPath",{xlinkHref:"#".concat(te)},n))},yke=function(t){var n=t.viewBox,s=t.offset,i=t.position,c=n,u=c.cx,a=c.cy,m=c.innerRadius,p=c.outerRadius,y=c.startAngle,v=c.endAngle,j=(y+v)/2;if(i==="outside"){var S=$n(u,a,p+s,j),k=S.x,N=S.y;return{x:k,y:N,textAnchor:k>=u?"start":"end",verticalAnchor:"middle"}}if(i==="center")return{x:u,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(i==="centerTop")return{x:u,y:a,textAnchor:"middle",verticalAnchor:"start"};if(i==="centerBottom")return{x:u,y:a,textAnchor:"middle",verticalAnchor:"end"};var D=(m+p)/2,O=$n(u,a,D,j),T=O.x,I=O.y;return{x:T,y:I,textAnchor:"middle",verticalAnchor:"middle"}},vke=function(t){var n=t.viewBox,s=t.parentViewBox,i=t.offset,c=t.position,u=n,a=u.x,m=u.y,p=u.width,y=u.height,v=y>=0?1:-1,j=v*i,S=v>0?"end":"start",k=v>0?"start":"end",N=p>=0?1:-1,D=N*i,O=N>0?"end":"start",T=N>0?"start":"end";if(c==="top"){var I={x:a+p/2,y:m-v*i,textAnchor:"middle",verticalAnchor:S};return zi(zi({},I),s?{height:Math.max(m-s.y,0),width:p}:{})}if(c==="bottom"){var z={x:a+p/2,y:m+y+j,textAnchor:"middle",verticalAnchor:k};return zi(zi({},z),s?{height:Math.max(s.y+s.height-(m+y),0),width:p}:{})}if(c==="left"){var $={x:a-D,y:m+y/2,textAnchor:O,verticalAnchor:"middle"};return zi(zi({},$),s?{width:Math.max($.x-s.x,0),height:y}:{})}if(c==="right"){var V={x:a+p+D,y:m+y/2,textAnchor:T,verticalAnchor:"middle"};return zi(zi({},V),s?{width:Math.max(s.x+s.width-V.x,0),height:y}:{})}var K=s?{width:p,height:y}:{};return c==="insideLeft"?zi({x:a+D,y:m+y/2,textAnchor:T,verticalAnchor:"middle"},K):c==="insideRight"?zi({x:a+p-D,y:m+y/2,textAnchor:O,verticalAnchor:"middle"},K):c==="insideTop"?zi({x:a+p/2,y:m+j,textAnchor:"middle",verticalAnchor:k},K):c==="insideBottom"?zi({x:a+p/2,y:m+y-j,textAnchor:"middle",verticalAnchor:S},K):c==="insideTopLeft"?zi({x:a+D,y:m+j,textAnchor:T,verticalAnchor:k},K):c==="insideTopRight"?zi({x:a+p-D,y:m+j,textAnchor:O,verticalAnchor:k},K):c==="insideBottomLeft"?zi({x:a+D,y:m+y-j,textAnchor:T,verticalAnchor:S},K):c==="insideBottomRight"?zi({x:a+p-D,y:m+y-j,textAnchor:O,verticalAnchor:S},K):Oy(c)&&(Ut(c.x)||fm(c.x))&&(Ut(c.y)||fm(c.y))?zi({x:a+Xa(c.x,p),y:m+Xa(c.y,y),textAnchor:"end",verticalAnchor:"end"},K):zi({x:a+p/2,y:m+y/2,textAnchor:"middle",verticalAnchor:"middle"},K)},_ke=function(t){return"cx"in t&&Ut(t.cx)};function ra(e){var t=e.offset,n=t===void 0?5:t,s=uke(e,ske),i=zi({offset:n},s),c=i.viewBox,u=i.position,a=i.value,m=i.children,p=i.content,y=i.className,v=y===void 0?"":y,j=i.textBreakAll;if(!c||Zr(a)&&Zr(m)&&!R.isValidElement(p)&&!Br(p))return null;if(R.isValidElement(p))return R.cloneElement(p,i);var S;if(Br(p)){if(S=R.createElement(p,i),R.isValidElement(S))return S}else S=pke(i);var k=_ke(c),N=Cr(i,!0);if(k&&(u==="insideStart"||u==="insideEnd"||u==="end"))return xke(i,S,N);var D=k?yke(i):vke(i);return de.createElement(Gm,rb({className:Yr("recharts-label",v)},N,D,{breakAll:j}),S)}ra.displayName="Label";var lK=function(t){var n=t.cx,s=t.cy,i=t.angle,c=t.startAngle,u=t.endAngle,a=t.r,m=t.radius,p=t.innerRadius,y=t.outerRadius,v=t.x,j=t.y,S=t.top,k=t.left,N=t.width,D=t.height,O=t.clockWise,T=t.labelViewBox;if(T)return T;if(Ut(N)&&Ut(D)){if(Ut(v)&&Ut(j))return{x:v,y:j,width:N,height:D};if(Ut(S)&&Ut(k))return{x:S,y:k,width:N,height:D}}return Ut(v)&&Ut(j)?{x:v,y:j,width:0,height:0}:Ut(n)&&Ut(s)?{cx:n,cy:s,startAngle:c||i||0,endAngle:u||i||0,innerRadius:p||0,outerRadius:y||m||a||0,clockWise:O}:t.viewBox?t.viewBox:{}},bke=function(t,n){return t?t===!0?de.createElement(ra,{key:"label-implicit",viewBox:n}):Ui(t)?de.createElement(ra,{key:"label-implicit",viewBox:n,value:t}):R.isValidElement(t)?t.type===ra?R.cloneElement(t,{key:"label-implicit",viewBox:n}):de.createElement(ra,{key:"label-implicit",content:t,viewBox:n}):Br(t)?de.createElement(ra,{key:"label-implicit",content:t,viewBox:n}):Oy(t)?de.createElement(ra,rb({viewBox:n},t,{key:"label-implicit"})):null:null},jke=function(t,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&s&&!t.label)return null;var i=t.children,c=lK(t),u=Yo(i,ra).map(function(m,p){return R.cloneElement(m,{viewBox:n||c,key:"label-".concat(p)})});if(!s)return u;var a=bke(t.label,n||c);return[a].concat(ike(u))};ra.parseViewBox=lK;ra.renderCallByParent=jke;function wke(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var Ske=wke;const cK=Fn(Ske);function nb(e){"@babel/helpers - typeof";return nb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nb(e)}var Nke=["valueAccessor"],Pke=["data","dataKey","clockWise","id","textBreakAll"];function Cke(e){return Eke(e)||Tke(e)||kke(e)||Ake()}function Ake(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kke(e,t){if(e){if(typeof e=="string")return $E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $E(e,t)}}function Tke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Eke(e){if(Array.isArray(e))return $E(e)}function $E(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function lN(){return lN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},lN.apply(this,arguments)}function Z$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Y$(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Z$(Object(n),!0).forEach(function(s){Mke(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Mke(e,t,n){return t=Oke(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oke(e){var t=Ike(e,"string");return nb(t)=="symbol"?t:t+""}function Ike(e,t){if(nb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(nb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function X$(e,t){if(e==null)return{};var n=Dke(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Dke(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}var Rke=function(t){return Array.isArray(t.value)?cK(t.value):t.value};function gc(e){var t=e.valueAccessor,n=t===void 0?Rke:t,s=X$(e,Nke),i=s.data,c=s.dataKey,u=s.clockWise,a=s.id,m=s.textBreakAll,p=X$(s,Pke);return!i||!i.length?null:de.createElement(xn,{className:"recharts-label-list"},i.map(function(y,v){var j=Zr(c)?n(y,v):Ys(y&&y.payload,c),S=Zr(a)?{}:{id:"".concat(a,"-").concat(v)};return de.createElement(ra,lN({},Cr(y,!0),p,S,{parentViewBox:y.parentViewBox,value:j,textBreakAll:m,viewBox:ra.parseViewBox(Zr(u)?y:Y$(Y$({},y),{},{clockWise:u})),key:"label-".concat(v),index:v}))}))}gc.displayName="LabelList";function Lke(e,t){return e?e===!0?de.createElement(gc,{key:"labelList-implicit",data:t}):de.isValidElement(e)||Br(e)?de.createElement(gc,{key:"labelList-implicit",data:t,content:e}):Oy(e)?de.createElement(gc,lN({data:t},e,{key:"labelList-implicit"})):null:null}function Fke(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var s=e.children,i=Yo(s,gc).map(function(u,a){return R.cloneElement(u,{data:t,key:"labelList-".concat(a)})});if(!n)return i;var c=Lke(e.label,t);return[c].concat(Cke(i))}gc.renderCallByParent=Fke;function sb(e){"@babel/helpers - typeof";return sb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sb(e)}function BE(){return BE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},BE.apply(this,arguments)}function Q$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function J$(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Q$(Object(n),!0).forEach(function(s){zke(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function zke(e,t,n){return t=$ke(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $ke(e){var t=Bke(e,"string");return sb(t)=="symbol"?t:t+""}function Bke(e,t){if(sb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(sb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qke=function(t,n){var s=Ya(n-t),i=Math.min(Math.abs(n-t),359.999);return s*i},c1=function(t){var n=t.cx,s=t.cy,i=t.radius,c=t.angle,u=t.sign,a=t.isExternal,m=t.cornerRadius,p=t.cornerIsExternal,y=m*(a?1:-1)+i,v=Math.asin(m/y)/oN,j=p?c:c+u*v,S=$n(n,s,y,j),k=$n(n,s,i,j),N=p?c-u*v:c,D=$n(n,s,y*Math.cos(v*oN),N);return{center:S,circleTangency:k,lineTangency:D,theta:v}},uK=function(t){var n=t.cx,s=t.cy,i=t.innerRadius,c=t.outerRadius,u=t.startAngle,a=t.endAngle,m=qke(u,a),p=u+m,y=$n(n,s,c,u),v=$n(n,s,c,p),j="M ".concat(y.x,",").concat(y.y,`
    A `).concat(c,",").concat(c,`,0,
    `).concat(+(Math.abs(m)>180),",").concat(+(u>p),`,
    `).concat(v.x,",").concat(v.y,`
  `);if(i>0){var S=$n(n,s,i,u),k=$n(n,s,i,p);j+="L ".concat(k.x,",").concat(k.y,`
            A `).concat(i,",").concat(i,`,0,
            `).concat(+(Math.abs(m)>180),",").concat(+(u<=p),`,
            `).concat(S.x,",").concat(S.y," Z")}else j+="L ".concat(n,",").concat(s," Z");return j},Vke=function(t){var n=t.cx,s=t.cy,i=t.innerRadius,c=t.outerRadius,u=t.cornerRadius,a=t.forceCornerRadius,m=t.cornerIsExternal,p=t.startAngle,y=t.endAngle,v=Ya(y-p),j=c1({cx:n,cy:s,radius:c,angle:p,sign:v,cornerRadius:u,cornerIsExternal:m}),S=j.circleTangency,k=j.lineTangency,N=j.theta,D=c1({cx:n,cy:s,radius:c,angle:y,sign:-v,cornerRadius:u,cornerIsExternal:m}),O=D.circleTangency,T=D.lineTangency,I=D.theta,z=m?Math.abs(p-y):Math.abs(p-y)-N-I;if(z<0)return a?"M ".concat(k.x,",").concat(k.y,`
        a`).concat(u,",").concat(u,",0,0,1,").concat(u*2,`,0
        a`).concat(u,",").concat(u,",0,0,1,").concat(-u*2,`,0
      `):uK({cx:n,cy:s,innerRadius:i,outerRadius:c,startAngle:p,endAngle:y});var $="M ".concat(k.x,",").concat(k.y,`
    A`).concat(u,",").concat(u,",0,0,").concat(+(v<0),",").concat(S.x,",").concat(S.y,`
    A`).concat(c,",").concat(c,",0,").concat(+(z>180),",").concat(+(v<0),",").concat(O.x,",").concat(O.y,`
    A`).concat(u,",").concat(u,",0,0,").concat(+(v<0),",").concat(T.x,",").concat(T.y,`
  `);if(i>0){var V=c1({cx:n,cy:s,radius:i,angle:p,sign:v,isExternal:!0,cornerRadius:u,cornerIsExternal:m}),K=V.circleTangency,te=V.lineTangency,X=V.theta,ve=c1({cx:n,cy:s,radius:i,angle:y,sign:-v,isExternal:!0,cornerRadius:u,cornerIsExternal:m}),ae=ve.circleTangency,pe=ve.lineTangency,Oe=ve.theta,Me=m?Math.abs(p-y):Math.abs(p-y)-X-Oe;if(Me<0&&u===0)return"".concat($,"L").concat(n,",").concat(s,"Z");$+="L".concat(pe.x,",").concat(pe.y,`
      A`).concat(u,",").concat(u,",0,0,").concat(+(v<0),",").concat(ae.x,",").concat(ae.y,`
      A`).concat(i,",").concat(i,",0,").concat(+(Me>180),",").concat(+(v>0),",").concat(K.x,",").concat(K.y,`
      A`).concat(u,",").concat(u,",0,0,").concat(+(v<0),",").concat(te.x,",").concat(te.y,"Z")}else $+="L".concat(n,",").concat(s,"Z");return $},Uke={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},dK=function(t){var n=J$(J$({},Uke),t),s=n.cx,i=n.cy,c=n.innerRadius,u=n.outerRadius,a=n.cornerRadius,m=n.forceCornerRadius,p=n.cornerIsExternal,y=n.startAngle,v=n.endAngle,j=n.className;if(u<c||y===v)return null;var S=Yr("recharts-sector",j),k=u-c,N=Xa(a,k,0,!0),D;return N>0&&Math.abs(y-v)<360?D=Vke({cx:s,cy:i,innerRadius:c,outerRadius:u,cornerRadius:Math.min(N,k/2),forceCornerRadius:m,cornerIsExternal:p,startAngle:y,endAngle:v}):D=uK({cx:s,cy:i,innerRadius:c,outerRadius:u,startAngle:y,endAngle:v}),de.createElement("path",BE({},Cr(n,!0),{className:S,d:D,role:"img"}))};function ib(e){"@babel/helpers - typeof";return ib=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ib(e)}function qE(){return qE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},qE.apply(this,arguments)}function e5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function t5(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?e5(Object(n),!0).forEach(function(s){Wke(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Wke(e,t,n){return t=Gke(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gke(e){var t=Kke(e,"string");return ib(t)=="symbol"?t:t+""}function Kke(e,t){if(ib(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(ib(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var r5={curveBasisClosed:Kxe,curveBasisOpen:Hxe,curveBasis:Gxe,curveBumpX:Mxe,curveBumpY:Oxe,curveLinearClosed:Zxe,curveLinear:H2,curveMonotoneX:Yxe,curveMonotoneY:Xxe,curveNatural:Qxe,curveStep:Jxe,curveStepAfter:tye,curveStepBefore:eye},u1=function(t){return t.x===+t.x&&t.y===+t.y},T_=function(t){return t.x},E_=function(t){return t.y},Hke=function(t,n){if(Br(t))return t;var s="curve".concat(G2(t));return(s==="curveMonotone"||s==="curveBump")&&n?r5["".concat(s).concat(n==="vertical"?"Y":"X")]:r5[s]||H2},Zke=function(t){var n=t.type,s=n===void 0?"linear":n,i=t.points,c=i===void 0?[]:i,u=t.baseLine,a=t.layout,m=t.connectNulls,p=m===void 0?!1:m,y=Hke(s,a),v=p?c.filter(function(N){return u1(N)}):c,j;if(Array.isArray(u)){var S=p?u.filter(function(N){return u1(N)}):u,k=v.map(function(N,D){return t5(t5({},N),{},{base:S[D]})});return a==="vertical"?j=e1().y(E_).x1(T_).x0(function(N){return N.base.x}):j=e1().x(T_).y1(E_).y0(function(N){return N.base.y}),j.defined(u1).curve(y),j(k)}return a==="vertical"&&Ut(u)?j=e1().y(E_).x1(T_).x0(u):Ut(u)?j=e1().x(T_).y1(E_).y0(u):j=n7().x(T_).y(E_),j.defined(u1).curve(y),j(v)},km=function(t){var n=t.className,s=t.points,i=t.path,c=t.pathRef;if((!s||!s.length)&&!i)return null;var u=s&&s.length?Zke(t):i;return de.createElement("path",qE({},Cr(t,!1),MS(t),{className:Yr("recharts-curve",n),d:u,ref:c}))},hK={exports:{}},Yke="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Xke=Yke,Qke=Xke;function fK(){}function mK(){}mK.resetWarningCache=fK;var Jke=function(){function e(s,i,c,u,a,m){if(m!==Qke){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:mK,resetWarningCache:fK};return n.PropTypes=n,n};hK.exports=Jke();var eTe=hK.exports;const fn=Fn(eTe);var tTe=Object.getOwnPropertyNames,rTe=Object.getOwnPropertySymbols,nTe=Object.prototype.hasOwnProperty;function n5(e,t){return function(s,i,c){return e(s,i,c)&&t(s,i,c)}}function d1(e){return function(n,s,i){if(!n||!s||typeof n!="object"||typeof s!="object")return e(n,s,i);var c=i.cache,u=c.get(n),a=c.get(s);if(u&&a)return u===s&&a===n;c.set(n,s),c.set(s,n);var m=e(n,s,i);return c.delete(n),c.delete(s),m}}function s5(e){return tTe(e).concat(rTe(e))}var pK=Object.hasOwn||function(e,t){return nTe.call(e,t)};function Uy(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var gK="_owner",i5=Object.getOwnPropertyDescriptor,a5=Object.keys;function sTe(e,t,n){var s=e.length;if(t.length!==s)return!1;for(;s-- >0;)if(!n.equals(e[s],t[s],s,s,e,t,n))return!1;return!0}function iTe(e,t){return Uy(e.getTime(),t.getTime())}function o5(e,t,n){if(e.size!==t.size)return!1;for(var s={},i=e.entries(),c=0,u,a;(u=i.next())&&!u.done;){for(var m=t.entries(),p=!1,y=0;(a=m.next())&&!a.done;){var v=u.value,j=v[0],S=v[1],k=a.value,N=k[0],D=k[1];!p&&!s[y]&&(p=n.equals(j,N,c,y,e,t,n)&&n.equals(S,D,j,N,e,t,n))&&(s[y]=!0),y++}if(!p)return!1;c++}return!0}function aTe(e,t,n){var s=a5(e),i=s.length;if(a5(t).length!==i)return!1;for(var c;i-- >0;)if(c=s[i],c===gK&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!pK(t,c)||!n.equals(e[c],t[c],c,c,e,t,n))return!1;return!0}function M_(e,t,n){var s=s5(e),i=s.length;if(s5(t).length!==i)return!1;for(var c,u,a;i-- >0;)if(c=s[i],c===gK&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!pK(t,c)||!n.equals(e[c],t[c],c,c,e,t,n)||(u=i5(e,c),a=i5(t,c),(u||a)&&(!u||!a||u.configurable!==a.configurable||u.enumerable!==a.enumerable||u.writable!==a.writable)))return!1;return!0}function oTe(e,t){return Uy(e.valueOf(),t.valueOf())}function lTe(e,t){return e.source===t.source&&e.flags===t.flags}function l5(e,t,n){if(e.size!==t.size)return!1;for(var s={},i=e.values(),c,u;(c=i.next())&&!c.done;){for(var a=t.values(),m=!1,p=0;(u=a.next())&&!u.done;)!m&&!s[p]&&(m=n.equals(c.value,u.value,c.value,u.value,e,t,n))&&(s[p]=!0),p++;if(!m)return!1}return!0}function cTe(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}var uTe="[object Arguments]",dTe="[object Boolean]",hTe="[object Date]",fTe="[object Map]",mTe="[object Number]",pTe="[object Object]",gTe="[object RegExp]",xTe="[object Set]",yTe="[object String]",vTe=Array.isArray,c5=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,u5=Object.assign,_Te=Object.prototype.toString.call.bind(Object.prototype.toString);function bTe(e){var t=e.areArraysEqual,n=e.areDatesEqual,s=e.areMapsEqual,i=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,u=e.areRegExpsEqual,a=e.areSetsEqual,m=e.areTypedArraysEqual;return function(y,v,j){if(y===v)return!0;if(y==null||v==null||typeof y!="object"||typeof v!="object")return y!==y&&v!==v;var S=y.constructor;if(S!==v.constructor)return!1;if(S===Object)return i(y,v,j);if(vTe(y))return t(y,v,j);if(c5!=null&&c5(y))return m(y,v,j);if(S===Date)return n(y,v,j);if(S===RegExp)return u(y,v,j);if(S===Map)return s(y,v,j);if(S===Set)return a(y,v,j);var k=_Te(y);return k===hTe?n(y,v,j):k===gTe?u(y,v,j):k===fTe?s(y,v,j):k===xTe?a(y,v,j):k===pTe?typeof y.then!="function"&&typeof v.then!="function"&&i(y,v,j):k===uTe?i(y,v,j):k===dTe||k===mTe||k===yTe?c(y,v,j):!1}}function jTe(e){var t=e.circular,n=e.createCustomConfig,s=e.strict,i={areArraysEqual:s?M_:sTe,areDatesEqual:iTe,areMapsEqual:s?n5(o5,M_):o5,areObjectsEqual:s?M_:aTe,arePrimitiveWrappersEqual:oTe,areRegExpsEqual:lTe,areSetsEqual:s?n5(l5,M_):l5,areTypedArraysEqual:s?M_:cTe};if(n&&(i=u5({},i,n(i))),t){var c=d1(i.areArraysEqual),u=d1(i.areMapsEqual),a=d1(i.areObjectsEqual),m=d1(i.areSetsEqual);i=u5({},i,{areArraysEqual:c,areMapsEqual:u,areObjectsEqual:a,areSetsEqual:m})}return i}function wTe(e){return function(t,n,s,i,c,u,a){return e(t,n,a)}}function STe(e){var t=e.circular,n=e.comparator,s=e.createState,i=e.equals,c=e.strict;if(s)return function(m,p){var y=s(),v=y.cache,j=v===void 0?t?new WeakMap:void 0:v,S=y.meta;return n(m,p,{cache:j,equals:i,meta:S,strict:c})};if(t)return function(m,p){return n(m,p,{cache:new WeakMap,equals:i,meta:void 0,strict:c})};var u={cache:void 0,equals:i,meta:void 0,strict:c};return function(m,p){return n(m,p,u)}}var NTe=mf();mf({strict:!0});mf({circular:!0});mf({circular:!0,strict:!0});mf({createInternalComparator:function(){return Uy}});mf({strict:!0,createInternalComparator:function(){return Uy}});mf({circular:!0,createInternalComparator:function(){return Uy}});mf({circular:!0,createInternalComparator:function(){return Uy},strict:!0});function mf(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,s=e.createInternalComparator,i=e.createState,c=e.strict,u=c===void 0?!1:c,a=jTe(e),m=bTe(a),p=s?s(m):wTe(m);return STe({circular:n,comparator:m,createState:i,equals:p,strict:u})}function PTe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function d5(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,s=function i(c){n<0&&(n=c),c-n>t?(e(c),n=-1):PTe(i)};requestAnimationFrame(s)}function VE(e){"@babel/helpers - typeof";return VE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},VE(e)}function CTe(e){return ETe(e)||TTe(e)||kTe(e)||ATe()}function ATe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kTe(e,t){if(e){if(typeof e=="string")return h5(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h5(e,t)}}function h5(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function TTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ETe(e){if(Array.isArray(e))return e}function MTe(){var e={},t=function(){return null},n=!1,s=function i(c){if(!n){if(Array.isArray(c)){if(!c.length)return;var u=c,a=CTe(u),m=a[0],p=a.slice(1);if(typeof m=="number"){d5(i.bind(null,p),m);return}i(m),d5(i.bind(null,p));return}VE(c)==="object"&&(e=c,t(e)),typeof c=="function"&&c()}};return{stop:function(){n=!0},start:function(c){n=!1,s(c)},subscribe:function(c){return t=c,function(){t=function(){return null}}}}}function ab(e){"@babel/helpers - typeof";return ab=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ab(e)}function f5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function m5(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?f5(Object(n),!0).forEach(function(s){xK(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function xK(e,t,n){return t=OTe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function OTe(e){var t=ITe(e,"string");return ab(t)==="symbol"?t:String(t)}function ITe(e,t){if(ab(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(ab(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DTe=function(t,n){return[Object.keys(t),Object.keys(n)].reduce(function(s,i){return s.filter(function(c){return i.includes(c)})})},RTe=function(t){return t},LTe=function(t){return t.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},n0=function(t,n){return Object.keys(n).reduce(function(s,i){return m5(m5({},s),{},xK({},i,t(i,n[i])))},{})},p5=function(t,n,s){return t.map(function(i){return"".concat(LTe(i)," ").concat(n,"ms ").concat(s)}).join(",")};function FTe(e,t){return BTe(e)||$Te(e,t)||yK(e,t)||zTe()}function zTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Te(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,c,u,a=[],m=!0,p=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(m=(s=c.call(n)).done)&&(a.push(s.value),a.length!==t);m=!0);}catch(y){p=!0,i=y}finally{try{if(!m&&n.return!=null&&(u=n.return(),Object(u)!==u))return}finally{if(p)throw i}}return a}}function BTe(e){if(Array.isArray(e))return e}function qTe(e){return WTe(e)||UTe(e)||yK(e)||VTe()}function VTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yK(e,t){if(e){if(typeof e=="string")return UE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return UE(e,t)}}function UTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function WTe(e){if(Array.isArray(e))return UE(e)}function UE(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}var cN=1e-4,vK=function(t,n){return[0,3*t,3*n-6*t,3*t-3*n+1]},_K=function(t,n){return t.map(function(s,i){return s*Math.pow(n,i)}).reduce(function(s,i){return s+i})},g5=function(t,n){return function(s){var i=vK(t,n);return _K(i,s)}},GTe=function(t,n){return function(s){var i=vK(t,n),c=[].concat(qTe(i.map(function(u,a){return u*a}).slice(1)),[0]);return _K(c,s)}},x5=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];var i=n[0],c=n[1],u=n[2],a=n[3];if(n.length===1)switch(n[0]){case"linear":i=0,c=0,u=1,a=1;break;case"ease":i=.25,c=.1,u=.25,a=1;break;case"ease-in":i=.42,c=0,u=1,a=1;break;case"ease-out":i=.42,c=0,u=.58,a=1;break;case"ease-in-out":i=0,c=0,u=.58,a=1;break;default:{var m=n[0].split("(");if(m[0]==="cubic-bezier"&&m[1].split(")")[0].split(",").length===4){var p=m[1].split(")")[0].split(",").map(function(D){return parseFloat(D)}),y=FTe(p,4);i=y[0],c=y[1],u=y[2],a=y[3]}}}var v=g5(i,u),j=g5(c,a),S=GTe(i,u),k=function(O){return O>1?1:O<0?0:O},N=function(O){for(var T=O>1?1:O,I=T,z=0;z<8;++z){var $=v(I)-T,V=S(I);if(Math.abs($-T)<cN||V<cN)return j(I);I=k(I-$/V)}return j(I)};return N.isStepper=!1,N},KTe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.stiff,s=n===void 0?100:n,i=t.damping,c=i===void 0?8:i,u=t.dt,a=u===void 0?17:u,m=function(y,v,j){var S=-(y-v)*s,k=j*c,N=j+(S-k)*a/1e3,D=j*a/1e3+y;return Math.abs(D-v)<cN&&Math.abs(N)<cN?[v,0]:[D,N]};return m.isStepper=!0,m.dt=a,m},HTe=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];var i=n[0];if(typeof i=="string")switch(i){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return x5(i);case"spring":return KTe();default:if(i.split("(")[0]==="cubic-bezier")return x5(i)}return typeof i=="function"?i:null};function ob(e){"@babel/helpers - typeof";return ob=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ob(e)}function y5(e){return XTe(e)||YTe(e)||bK(e)||ZTe()}function ZTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function XTe(e){if(Array.isArray(e))return GE(e)}function v5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function pa(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?v5(Object(n),!0).forEach(function(s){WE(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function WE(e,t,n){return t=QTe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function QTe(e){var t=JTe(e,"string");return ob(t)==="symbol"?t:String(t)}function JTe(e,t){if(ob(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(ob(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eEe(e,t){return nEe(e)||rEe(e,t)||bK(e,t)||tEe()}function tEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bK(e,t){if(e){if(typeof e=="string")return GE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return GE(e,t)}}function GE(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function rEe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,c,u,a=[],m=!0,p=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(m=(s=c.call(n)).done)&&(a.push(s.value),a.length!==t);m=!0);}catch(y){p=!0,i=y}finally{try{if(!m&&n.return!=null&&(u=n.return(),Object(u)!==u))return}finally{if(p)throw i}}return a}}function nEe(e){if(Array.isArray(e))return e}var uN=function(t,n,s){return t+(n-t)*s},KE=function(t){var n=t.from,s=t.to;return n!==s},sEe=function e(t,n,s){var i=n0(function(c,u){if(KE(u)){var a=t(u.from,u.to,u.velocity),m=eEe(a,2),p=m[0],y=m[1];return pa(pa({},u),{},{from:p,velocity:y})}return u},n);return s<1?n0(function(c,u){return KE(u)?pa(pa({},u),{},{velocity:uN(u.velocity,i[c].velocity,s),from:uN(u.from,i[c].from,s)}):u},n):e(t,i,s-1)};const iEe=function(e,t,n,s,i){var c=DTe(e,t),u=c.reduce(function(D,O){return pa(pa({},D),{},WE({},O,[e[O],t[O]]))},{}),a=c.reduce(function(D,O){return pa(pa({},D),{},WE({},O,{from:e[O],velocity:0,to:t[O]}))},{}),m=-1,p,y,v=function(){return null},j=function(){return n0(function(O,T){return T.from},a)},S=function(){return!Object.values(a).filter(KE).length},k=function(O){p||(p=O);var T=O-p,I=T/n.dt;a=sEe(n,a,I),i(pa(pa(pa({},e),t),j())),p=O,S()||(m=requestAnimationFrame(v))},N=function(O){y||(y=O);var T=(O-y)/s,I=n0(function($,V){return uN.apply(void 0,y5(V).concat([n(T)]))},u);if(i(pa(pa(pa({},e),t),I)),T<1)m=requestAnimationFrame(v);else{var z=n0(function($,V){return uN.apply(void 0,y5(V).concat([n(1)]))},u);i(pa(pa(pa({},e),t),z))}};return v=n.isStepper?k:N,function(){return requestAnimationFrame(v),function(){cancelAnimationFrame(m)}}};function Hx(e){"@babel/helpers - typeof";return Hx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hx(e)}var aEe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function oEe(e,t){if(e==null)return{};var n=lEe(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function lEe(e,t){if(e==null)return{};var n={},s=Object.keys(e),i,c;for(c=0;c<s.length;c++)i=s[c],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function JA(e){return hEe(e)||dEe(e)||uEe(e)||cEe()}function cEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uEe(e,t){if(e){if(typeof e=="string")return HE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return HE(e,t)}}function dEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hEe(e){if(Array.isArray(e))return HE(e)}function HE(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function _5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Xl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_5(Object(n),!0).forEach(function(s){V_(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function V_(e,t,n){return t=jK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mEe(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,jK(s.key),s)}}function pEe(e,t,n){return t&&mEe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function jK(e){var t=gEe(e,"string");return Hx(t)==="symbol"?t:String(t)}function gEe(e,t){if(Hx(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(Hx(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZE(e,t)}function ZE(e,t){return ZE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},ZE(e,t)}function yEe(e){var t=vEe();return function(){var s=dN(e),i;if(t){var c=dN(this).constructor;i=Reflect.construct(s,arguments,c)}else i=s.apply(this,arguments);return YE(this,i)}}function YE(e,t){if(t&&(Hx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XE(e)}function XE(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dN(e){return dN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},dN(e)}var Al=function(e){xEe(n,e);var t=yEe(n);function n(s,i){var c;fEe(this,n),c=t.call(this,s,i);var u=c.props,a=u.isActive,m=u.attributeName,p=u.from,y=u.to,v=u.steps,j=u.children,S=u.duration;if(c.handleStyleChange=c.handleStyleChange.bind(XE(c)),c.changeStyle=c.changeStyle.bind(XE(c)),!a||S<=0)return c.state={style:{}},typeof j=="function"&&(c.state={style:y}),YE(c);if(v&&v.length)c.state={style:v[0].style};else if(p){if(typeof j=="function")return c.state={style:p},YE(c);c.state={style:m?V_({},m,p):p}}else c.state={style:{}};return c}return pEe(n,[{key:"componentDidMount",value:function(){var i=this.props,c=i.isActive,u=i.canBegin;this.mounted=!0,!(!c||!u)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(i){var c=this.props,u=c.isActive,a=c.canBegin,m=c.attributeName,p=c.shouldReAnimate,y=c.to,v=c.from,j=this.state.style;if(a){if(!u){var S={style:m?V_({},m,y):y};this.state&&j&&(m&&j[m]!==y||!m&&j!==y)&&this.setState(S);return}if(!(NTe(i.to,y)&&i.canBegin&&i.isActive)){var k=!i.canBegin||!i.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var N=k||p?v:i.to;if(this.state&&j){var D={style:m?V_({},m,N):N};(m&&j[m]!==N||!m&&j!==N)&&this.setState(D)}this.runAnimation(Xl(Xl({},this.props),{},{from:N,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var i=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),i&&i()}},{key:"handleStyleChange",value:function(i){this.changeStyle(i)}},{key:"changeStyle",value:function(i){this.mounted&&this.setState({style:i})}},{key:"runJSAnimation",value:function(i){var c=this,u=i.from,a=i.to,m=i.duration,p=i.easing,y=i.begin,v=i.onAnimationEnd,j=i.onAnimationStart,S=iEe(u,a,HTe(p),m,this.changeStyle),k=function(){c.stopJSAnimation=S()};this.manager.start([j,y,k,m,v])}},{key:"runStepAnimation",value:function(i){var c=this,u=i.steps,a=i.begin,m=i.onAnimationStart,p=u[0],y=p.style,v=p.duration,j=v===void 0?0:v,S=function(N,D,O){if(O===0)return N;var T=D.duration,I=D.easing,z=I===void 0?"ease":I,$=D.style,V=D.properties,K=D.onAnimationEnd,te=O>0?u[O-1]:D,X=V||Object.keys($);if(typeof z=="function"||z==="spring")return[].concat(JA(N),[c.runJSAnimation.bind(c,{from:te.style,to:$,duration:T,easing:z}),T]);var ve=p5(X,T,z),ae=Xl(Xl(Xl({},te.style),$),{},{transition:ve});return[].concat(JA(N),[ae,T,K]).filter(RTe)};return this.manager.start([m].concat(JA(u.reduce(S,[y,Math.max(j,a)])),[i.onAnimationEnd]))}},{key:"runAnimation",value:function(i){this.manager||(this.manager=MTe());var c=i.begin,u=i.duration,a=i.attributeName,m=i.to,p=i.easing,y=i.onAnimationStart,v=i.onAnimationEnd,j=i.steps,S=i.children,k=this.manager;if(this.unSubscribe=k.subscribe(this.handleStyleChange),typeof p=="function"||typeof S=="function"||p==="spring"){this.runJSAnimation(i);return}if(j.length>1){this.runStepAnimation(i);return}var N=a?V_({},a,m):m,D=p5(Object.keys(N),u,p);k.start([y,c,Xl(Xl({},N),{},{transition:D}),u,v])}},{key:"render",value:function(){var i=this.props,c=i.children;i.begin;var u=i.duration;i.attributeName,i.easing;var a=i.isActive;i.steps,i.from,i.to,i.canBegin,i.onAnimationEnd,i.shouldReAnimate,i.onAnimationReStart;var m=oEe(i,aEe),p=R.Children.count(c),y=this.state.style;if(typeof c=="function")return c(y);if(!a||p===0||u<=0)return c;var v=function(S){var k=S.props,N=k.style,D=N===void 0?{}:N,O=k.className,T=R.cloneElement(S,Xl(Xl({},m),{},{style:Xl(Xl({},D),y),className:O}));return T};return p===1?v(R.Children.only(c)):de.createElement("div",null,R.Children.map(c,function(j){return v(j)}))}}]),n}(R.PureComponent);Al.displayName="Animate";Al.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Al.propTypes={from:fn.oneOfType([fn.object,fn.string]),to:fn.oneOfType([fn.object,fn.string]),attributeName:fn.string,duration:fn.number,begin:fn.number,easing:fn.oneOfType([fn.string,fn.func]),steps:fn.arrayOf(fn.shape({duration:fn.number.isRequired,style:fn.object.isRequired,easing:fn.oneOfType([fn.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),fn.func]),properties:fn.arrayOf("string"),onAnimationEnd:fn.func})),children:fn.oneOfType([fn.node,fn.func]),isActive:fn.bool,canBegin:fn.bool,onAnimationEnd:fn.func,shouldReAnimate:fn.bool,onAnimationStart:fn.func,onAnimationReStart:fn.func};fn.object,fn.object,fn.object,fn.element;fn.object,fn.object,fn.object,fn.oneOfType([fn.array,fn.element]),fn.any;function lb(e){"@babel/helpers - typeof";return lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lb(e)}function hN(){return hN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},hN.apply(this,arguments)}function _Ee(e,t){return SEe(e)||wEe(e,t)||jEe(e,t)||bEe()}function bEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jEe(e,t){if(e){if(typeof e=="string")return b5(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b5(e,t)}}function b5(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function wEe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,c,u,a=[],m=!0,p=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(m=(s=c.call(n)).done)&&(a.push(s.value),a.length!==t);m=!0);}catch(y){p=!0,i=y}finally{try{if(!m&&n.return!=null&&(u=n.return(),Object(u)!==u))return}finally{if(p)throw i}}return a}}function SEe(e){if(Array.isArray(e))return e}function j5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function w5(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?j5(Object(n),!0).forEach(function(s){NEe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function NEe(e,t,n){return t=PEe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PEe(e){var t=CEe(e,"string");return lb(t)=="symbol"?t:t+""}function CEe(e,t){if(lb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(lb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var S5=function(t,n,s,i,c){var u=Math.min(Math.abs(s)/2,Math.abs(i)/2),a=i>=0?1:-1,m=s>=0?1:-1,p=i>=0&&s>=0||i<0&&s<0?1:0,y;if(u>0&&c instanceof Array){for(var v=[0,0,0,0],j=0,S=4;j<S;j++)v[j]=c[j]>u?u:c[j];y="M".concat(t,",").concat(n+a*v[0]),v[0]>0&&(y+="A ".concat(v[0],",").concat(v[0],",0,0,").concat(p,",").concat(t+m*v[0],",").concat(n)),y+="L ".concat(t+s-m*v[1],",").concat(n),v[1]>0&&(y+="A ".concat(v[1],",").concat(v[1],",0,0,").concat(p,`,
        `).concat(t+s,",").concat(n+a*v[1])),y+="L ".concat(t+s,",").concat(n+i-a*v[2]),v[2]>0&&(y+="A ".concat(v[2],",").concat(v[2],",0,0,").concat(p,`,
        `).concat(t+s-m*v[2],",").concat(n+i)),y+="L ".concat(t+m*v[3],",").concat(n+i),v[3]>0&&(y+="A ".concat(v[3],",").concat(v[3],",0,0,").concat(p,`,
        `).concat(t,",").concat(n+i-a*v[3])),y+="Z"}else if(u>0&&c===+c&&c>0){var k=Math.min(u,c);y="M ".concat(t,",").concat(n+a*k,`
            A `).concat(k,",").concat(k,",0,0,").concat(p,",").concat(t+m*k,",").concat(n,`
            L `).concat(t+s-m*k,",").concat(n,`
            A `).concat(k,",").concat(k,",0,0,").concat(p,",").concat(t+s,",").concat(n+a*k,`
            L `).concat(t+s,",").concat(n+i-a*k,`
            A `).concat(k,",").concat(k,",0,0,").concat(p,",").concat(t+s-m*k,",").concat(n+i,`
            L `).concat(t+m*k,",").concat(n+i,`
            A `).concat(k,",").concat(k,",0,0,").concat(p,",").concat(t,",").concat(n+i-a*k," Z")}else y="M ".concat(t,",").concat(n," h ").concat(s," v ").concat(i," h ").concat(-s," Z");return y},AEe=function(t,n){if(!t||!n)return!1;var s=t.x,i=t.y,c=n.x,u=n.y,a=n.width,m=n.height;if(Math.abs(a)>0&&Math.abs(m)>0){var p=Math.min(c,c+a),y=Math.max(c,c+a),v=Math.min(u,u+m),j=Math.max(u,u+m);return s>=p&&s<=y&&i>=v&&i<=j}return!1},kEe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},_D=function(t){var n=w5(w5({},kEe),t),s=R.useRef(),i=R.useState(-1),c=_Ee(i,2),u=c[0],a=c[1];R.useEffect(function(){if(s.current&&s.current.getTotalLength)try{var z=s.current.getTotalLength();z&&a(z)}catch{}},[]);var m=n.x,p=n.y,y=n.width,v=n.height,j=n.radius,S=n.className,k=n.animationEasing,N=n.animationDuration,D=n.animationBegin,O=n.isAnimationActive,T=n.isUpdateAnimationActive;if(m!==+m||p!==+p||y!==+y||v!==+v||y===0||v===0)return null;var I=Yr("recharts-rectangle",S);return T?de.createElement(Al,{canBegin:u>0,from:{width:y,height:v,x:m,y:p},to:{width:y,height:v,x:m,y:p},duration:N,animationEasing:k,isActive:T},function(z){var $=z.width,V=z.height,K=z.x,te=z.y;return de.createElement(Al,{canBegin:u>0,from:"0px ".concat(u===-1?1:u,"px"),to:"".concat(u,"px 0px"),attributeName:"strokeDasharray",begin:D,duration:N,isActive:O,easing:k},de.createElement("path",hN({},Cr(n,!0),{className:I,d:S5(K,te,$,V,j),ref:s})))}):de.createElement("path",hN({},Cr(n,!0),{className:I,d:S5(m,p,y,v,j)}))},TEe=["points","className","baseLinePoints","connectNulls"];function Lg(){return Lg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Lg.apply(this,arguments)}function EEe(e,t){if(e==null)return{};var n=MEe(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function MEe(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function N5(e){return REe(e)||DEe(e)||IEe(e)||OEe()}function OEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IEe(e,t){if(e){if(typeof e=="string")return QE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return QE(e,t)}}function DEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function REe(e){if(Array.isArray(e))return QE(e)}function QE(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}var P5=function(t){return t&&t.x===+t.x&&t.y===+t.y},LEe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[[]];return t.forEach(function(s){P5(s)?n[n.length-1].push(s):n[n.length-1].length>0&&n.push([])}),P5(t[0])&&n[n.length-1].push(t[0]),n[n.length-1].length<=0&&(n=n.slice(0,-1)),n},s0=function(t,n){var s=LEe(t);n&&(s=[s.reduce(function(c,u){return[].concat(N5(c),N5(u))},[])]);var i=s.map(function(c){return c.reduce(function(u,a,m){return"".concat(u).concat(m===0?"M":"L").concat(a.x,",").concat(a.y)},"")}).join("");return s.length===1?"".concat(i,"Z"):i},FEe=function(t,n,s){var i=s0(t,s);return"".concat(i.slice(-1)==="Z"?i.slice(0,-1):i,"L").concat(s0(n.reverse(),s).slice(1))},wK=function(t){var n=t.points,s=t.className,i=t.baseLinePoints,c=t.connectNulls,u=EEe(t,TEe);if(!n||!n.length)return null;var a=Yr("recharts-polygon",s);if(i&&i.length){var m=u.stroke&&u.stroke!=="none",p=FEe(n,i,c);return de.createElement("g",{className:a},de.createElement("path",Lg({},Cr(u,!0),{fill:p.slice(-1)==="Z"?u.fill:"none",stroke:"none",d:p})),m?de.createElement("path",Lg({},Cr(u,!0),{fill:"none",d:s0(n,c)})):null,m?de.createElement("path",Lg({},Cr(u,!0),{fill:"none",d:s0(i,c)})):null)}var y=s0(n,c);return de.createElement("path",Lg({},Cr(u,!0),{fill:y.slice(-1)==="Z"?u.fill:"none",className:a,d:y}))};function JE(){return JE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},JE.apply(this,arguments)}var Wy=function(t){var n=t.cx,s=t.cy,i=t.r,c=t.className,u=Yr("recharts-dot",c);return n===+n&&s===+s&&i===+i?de.createElement("circle",JE({},Cr(t,!1),MS(t),{className:u,cx:n,cy:s,r:i})):null};function cb(e){"@babel/helpers - typeof";return cb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cb(e)}var zEe=["x","y","top","left","width","height","className"];function eM(){return eM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},eM.apply(this,arguments)}function C5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function $Ee(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?C5(Object(n),!0).forEach(function(s){BEe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function BEe(e,t,n){return t=qEe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qEe(e){var t=VEe(e,"string");return cb(t)=="symbol"?t:t+""}function VEe(e,t){if(cb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(cb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UEe(e,t){if(e==null)return{};var n=WEe(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function WEe(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}var GEe=function(t,n,s,i,c,u){return"M".concat(t,",").concat(c,"v").concat(i,"M").concat(u,",").concat(n,"h").concat(s)},KEe=function(t){var n=t.x,s=n===void 0?0:n,i=t.y,c=i===void 0?0:i,u=t.top,a=u===void 0?0:u,m=t.left,p=m===void 0?0:m,y=t.width,v=y===void 0?0:y,j=t.height,S=j===void 0?0:j,k=t.className,N=UEe(t,zEe),D=$Ee({x:s,y:c,top:a,left:p,width:v,height:S},N);return!Ut(s)||!Ut(c)||!Ut(v)||!Ut(S)||!Ut(a)||!Ut(p)?null:de.createElement("path",eM({},Cr(D,!0),{className:Yr("recharts-cross",k),d:GEe(s,c,v,S,a,p)}))},HEe=["cx","cy","innerRadius","outerRadius","gridType","radialLines"];function ub(e){"@babel/helpers - typeof";return ub=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ub(e)}function ZEe(e,t){if(e==null)return{};var n=YEe(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function YEe(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function pd(){return pd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},pd.apply(this,arguments)}function A5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function db(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?A5(Object(n),!0).forEach(function(s){XEe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function XEe(e,t,n){return t=QEe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function QEe(e){var t=JEe(e,"string");return ub(t)=="symbol"?t:t+""}function JEe(e,t){if(ub(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(ub(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eMe=function(t,n,s,i){var c="";return i.forEach(function(u,a){var m=$n(n,s,t,u);a?c+="L ".concat(m.x,",").concat(m.y):c+="M ".concat(m.x,",").concat(m.y)}),c+="Z",c},tMe=function(t){var n=t.cx,s=t.cy,i=t.innerRadius,c=t.outerRadius,u=t.polarAngles,a=t.radialLines;if(!u||!u.length||!a)return null;var m=db({stroke:"#ccc"},Cr(t,!1));return de.createElement("g",{className:"recharts-polar-grid-angle"},u.map(function(p){var y=$n(n,s,i,p),v=$n(n,s,c,p);return de.createElement("line",pd({},m,{key:"line-".concat(p),x1:y.x,y1:y.y,x2:v.x,y2:v.y}))}))},rMe=function(t){var n=t.cx,s=t.cy,i=t.radius,c=t.index,u=db(db({stroke:"#ccc"},Cr(t,!1)),{},{fill:"none"});return de.createElement("circle",pd({},u,{className:Yr("recharts-polar-grid-concentric-circle",t.className),key:"circle-".concat(c),cx:n,cy:s,r:i}))},nMe=function(t){var n=t.radius,s=t.index,i=db(db({stroke:"#ccc"},Cr(t,!1)),{},{fill:"none"});return de.createElement("path",pd({},i,{className:Yr("recharts-polar-grid-concentric-polygon",t.className),key:"path-".concat(s),d:eMe(n,t.cx,t.cy,t.polarAngles)}))},sMe=function(t){var n=t.polarRadius,s=t.gridType;return!n||!n.length?null:de.createElement("g",{className:"recharts-polar-grid-concentric"},n.map(function(i,c){var u=c;return s==="circle"?de.createElement(rMe,pd({key:u},t,{radius:i,index:c})):de.createElement(nMe,pd({key:u},t,{radius:i,index:c}))}))},SK=function(t){var n=t.cx,s=n===void 0?0:n,i=t.cy,c=i===void 0?0:i,u=t.innerRadius,a=u===void 0?0:u,m=t.outerRadius,p=m===void 0?0:m,y=t.gridType,v=y===void 0?"polygon":y,j=t.radialLines,S=j===void 0?!0:j,k=ZEe(t,HEe);return p<=0?null:de.createElement("g",{className:"recharts-polar-grid"},de.createElement(tMe,pd({cx:s,cy:c,innerRadius:a,outerRadius:p,gridType:v,radialLines:S},k)),de.createElement(sMe,pd({cx:s,cy:c,innerRadius:a,outerRadius:p,gridType:v,radialLines:S},k)))};SK.displayName="PolarGrid";var iMe=iP,aMe=EG,oMe=ou;function lMe(e,t){return e&&e.length?iMe(e,oMe(t),aMe):void 0}var cMe=lMe;const uMe=Fn(cMe);var dMe=iP,hMe=ou,fMe=MG;function mMe(e,t){return e&&e.length?dMe(e,hMe(t),fMe):void 0}var pMe=mMe;const gMe=Fn(pMe);var xMe=["cx","cy","angle","ticks","axisLine"],yMe=["ticks","tick","angle","tickFormatter","stroke"];function Zx(e){"@babel/helpers - typeof";return Zx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zx(e)}function i0(){return i0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},i0.apply(this,arguments)}function k5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function em(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?k5(Object(n),!0).forEach(function(s){cP(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function T5(e,t){if(e==null)return{};var n=vMe(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function vMe(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function _Me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E5(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,PK(s.key),s)}}function bMe(e,t,n){return t&&E5(e.prototype,t),n&&E5(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function jMe(e,t,n){return t=fN(t),wMe(e,NK()?Reflect.construct(t,n||[],fN(e).constructor):t.apply(e,n))}function wMe(e,t){if(t&&(Zx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SMe(e)}function SMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NK=function(){return!!e})()}function fN(e){return fN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},fN(e)}function NMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tM(e,t)}function tM(e,t){return tM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},tM(e,t)}function cP(e,t,n){return t=PK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PK(e){var t=PMe(e,"string");return Zx(t)=="symbol"?t:t+""}function PMe(e,t){if(Zx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(Zx(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Gy=function(e){function t(){return _Me(this,t),jMe(this,t,arguments)}return NMe(t,e),bMe(t,[{key:"getTickValueCoord",value:function(s){var i=s.coordinate,c=this.props,u=c.angle,a=c.cx,m=c.cy;return $n(a,m,i,u)}},{key:"getTickTextAnchor",value:function(){var s=this.props.orientation,i;switch(s){case"left":i="end";break;case"right":i="start";break;default:i="middle";break}return i}},{key:"getViewBox",value:function(){var s=this.props,i=s.cx,c=s.cy,u=s.angle,a=s.ticks,m=uMe(a,function(y){return y.coordinate||0}),p=gMe(a,function(y){return y.coordinate||0});return{cx:i,cy:c,startAngle:u,endAngle:u,innerRadius:p.coordinate||0,outerRadius:m.coordinate||0}}},{key:"renderAxisLine",value:function(){var s=this.props,i=s.cx,c=s.cy,u=s.angle,a=s.ticks,m=s.axisLine,p=T5(s,xMe),y=a.reduce(function(k,N){return[Math.min(k[0],N.coordinate),Math.max(k[1],N.coordinate)]},[1/0,-1/0]),v=$n(i,c,y[0],u),j=$n(i,c,y[1],u),S=em(em(em({},Cr(p,!1)),{},{fill:"none"},Cr(m,!1)),{},{x1:v.x,y1:v.y,x2:j.x,y2:j.y});return de.createElement("line",i0({className:"recharts-polar-radius-axis-line"},S))}},{key:"renderTicks",value:function(){var s=this,i=this.props,c=i.ticks,u=i.tick,a=i.angle,m=i.tickFormatter,p=i.stroke,y=T5(i,yMe),v=this.getTickTextAnchor(),j=Cr(y,!1),S=Cr(u,!1),k=c.map(function(N,D){var O=s.getTickValueCoord(N),T=em(em(em(em({textAnchor:v,transform:"rotate(".concat(90-a,", ").concat(O.x,", ").concat(O.y,")")},j),{},{stroke:"none",fill:p},S),{},{index:D},O),{},{payload:N});return de.createElement(xn,i0({className:Yr("recharts-polar-radius-axis-tick",oK(u)),key:"tick-".concat(N.coordinate)},Wm(s.props,N,D)),t.renderTickItem(u,T,m?m(N.value,D):N.value))});return de.createElement(xn,{className:"recharts-polar-radius-axis-ticks"},k)}},{key:"render",value:function(){var s=this.props,i=s.ticks,c=s.axisLine,u=s.tick;return!i||!i.length?null:de.createElement(xn,{className:Yr("recharts-polar-radius-axis",this.props.className)},c&&this.renderAxisLine(),u&&this.renderTicks(),ra.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(s,i,c){var u;return de.isValidElement(s)?u=de.cloneElement(s,i):Br(s)?u=s(i):u=de.createElement(Gm,i0({},i,{className:"recharts-polar-radius-axis-tick-value"}),c),u}}])}(R.PureComponent);cP(Gy,"displayName","PolarRadiusAxis");cP(Gy,"axisType","radiusAxis");cP(Gy,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Yx(e){"@babel/helpers - typeof";return Yx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yx(e)}function lm(){return lm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},lm.apply(this,arguments)}function M5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function tm(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?M5(Object(n),!0).forEach(function(s){uP(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function CMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O5(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,AK(s.key),s)}}function AMe(e,t,n){return t&&O5(e.prototype,t),n&&O5(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function kMe(e,t,n){return t=mN(t),TMe(e,CK()?Reflect.construct(t,n||[],mN(e).constructor):t.apply(e,n))}function TMe(e,t){if(t&&(Yx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return EMe(e)}function EMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(CK=function(){return!!e})()}function mN(e){return mN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},mN(e)}function MMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rM(e,t)}function rM(e,t){return rM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},rM(e,t)}function uP(e,t,n){return t=AK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AK(e){var t=OMe(e,"string");return Yx(t)=="symbol"?t:t+""}function OMe(e,t){if(Yx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(Yx(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var IMe=Math.PI/180,I5=1e-5,Ky=function(e){function t(){return CMe(this,t),kMe(this,t,arguments)}return MMe(t,e),AMe(t,[{key:"getTickLineCoord",value:function(s){var i=this.props,c=i.cx,u=i.cy,a=i.radius,m=i.orientation,p=i.tickSize,y=p||8,v=$n(c,u,a,s.coordinate),j=$n(c,u,a+(m==="inner"?-1:1)*y,s.coordinate);return{x1:v.x,y1:v.y,x2:j.x,y2:j.y}}},{key:"getTickTextAnchor",value:function(s){var i=this.props.orientation,c=Math.cos(-s.coordinate*IMe),u;return c>I5?u=i==="outer"?"start":"end":c<-I5?u=i==="outer"?"end":"start":u="middle",u}},{key:"renderAxisLine",value:function(){var s=this.props,i=s.cx,c=s.cy,u=s.radius,a=s.axisLine,m=s.axisLineType,p=tm(tm({},Cr(this.props,!1)),{},{fill:"none"},Cr(a,!1));if(m==="circle")return de.createElement(Wy,lm({className:"recharts-polar-angle-axis-line"},p,{cx:i,cy:c,r:u}));var y=this.props.ticks,v=y.map(function(j){return $n(i,c,u,j.coordinate)});return de.createElement(wK,lm({className:"recharts-polar-angle-axis-line"},p,{points:v}))}},{key:"renderTicks",value:function(){var s=this,i=this.props,c=i.ticks,u=i.tick,a=i.tickLine,m=i.tickFormatter,p=i.stroke,y=Cr(this.props,!1),v=Cr(u,!1),j=tm(tm({},y),{},{fill:"none"},Cr(a,!1)),S=c.map(function(k,N){var D=s.getTickLineCoord(k),O=s.getTickTextAnchor(k),T=tm(tm(tm({textAnchor:O},y),{},{stroke:"none",fill:p},v),{},{index:N,payload:k,x:D.x2,y:D.y2});return de.createElement(xn,lm({className:Yr("recharts-polar-angle-axis-tick",oK(u)),key:"tick-".concat(k.coordinate)},Wm(s.props,k,N)),a&&de.createElement("line",lm({className:"recharts-polar-angle-axis-tick-line"},j,D)),u&&t.renderTickItem(u,T,m?m(k.value,N):k.value))});return de.createElement(xn,{className:"recharts-polar-angle-axis-ticks"},S)}},{key:"render",value:function(){var s=this.props,i=s.ticks,c=s.radius,u=s.axisLine;return c<=0||!i||!i.length?null:de.createElement(xn,{className:Yr("recharts-polar-angle-axis",this.props.className)},u&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(s,i,c){var u;return de.isValidElement(s)?u=de.cloneElement(s,i):Br(s)?u=s(i):u=de.createElement(Gm,lm({},i,{className:"recharts-polar-angle-axis-tick-value"}),c),u}}])}(R.PureComponent);uP(Ky,"displayName","PolarAngleAxis");uP(Ky,"axisType","angleAxis");uP(Ky,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var DMe=C7,RMe=DMe(Object.getPrototypeOf,Object),LMe=RMe,FMe=jd,zMe=LMe,$Me=wd,BMe="[object Object]",qMe=Function.prototype,VMe=Object.prototype,kK=qMe.toString,UMe=VMe.hasOwnProperty,WMe=kK.call(Object);function GMe(e){if(!$Me(e)||FMe(e)!=BMe)return!1;var t=zMe(e);if(t===null)return!0;var n=UMe.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&kK.call(n)==WMe}var KMe=GMe;const HMe=Fn(KMe);var ZMe=jd,YMe=wd,XMe="[object Boolean]";function QMe(e){return e===!0||e===!1||YMe(e)&&ZMe(e)==XMe}var JMe=QMe;const eOe=Fn(JMe);function hb(e){"@babel/helpers - typeof";return hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hb(e)}function pN(){return pN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},pN.apply(this,arguments)}function tOe(e,t){return iOe(e)||sOe(e,t)||nOe(e,t)||rOe()}function rOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nOe(e,t){if(e){if(typeof e=="string")return D5(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D5(e,t)}}function D5(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function sOe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,c,u,a=[],m=!0,p=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(m=(s=c.call(n)).done)&&(a.push(s.value),a.length!==t);m=!0);}catch(y){p=!0,i=y}finally{try{if(!m&&n.return!=null&&(u=n.return(),Object(u)!==u))return}finally{if(p)throw i}}return a}}function iOe(e){if(Array.isArray(e))return e}function R5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function L5(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?R5(Object(n),!0).forEach(function(s){aOe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function aOe(e,t,n){return t=oOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oOe(e){var t=lOe(e,"string");return hb(t)=="symbol"?t:t+""}function lOe(e,t){if(hb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(hb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var F5=function(t,n,s,i,c){var u=s-i,a;return a="M ".concat(t,",").concat(n),a+="L ".concat(t+s,",").concat(n),a+="L ".concat(t+s-u/2,",").concat(n+c),a+="L ".concat(t+s-u/2-i,",").concat(n+c),a+="L ".concat(t,",").concat(n," Z"),a},cOe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},uOe=function(t){var n=L5(L5({},cOe),t),s=R.useRef(),i=R.useState(-1),c=tOe(i,2),u=c[0],a=c[1];R.useEffect(function(){if(s.current&&s.current.getTotalLength)try{var I=s.current.getTotalLength();I&&a(I)}catch{}},[]);var m=n.x,p=n.y,y=n.upperWidth,v=n.lowerWidth,j=n.height,S=n.className,k=n.animationEasing,N=n.animationDuration,D=n.animationBegin,O=n.isUpdateAnimationActive;if(m!==+m||p!==+p||y!==+y||v!==+v||j!==+j||y===0&&v===0||j===0)return null;var T=Yr("recharts-trapezoid",S);return O?de.createElement(Al,{canBegin:u>0,from:{upperWidth:0,lowerWidth:0,height:j,x:m,y:p},to:{upperWidth:y,lowerWidth:v,height:j,x:m,y:p},duration:N,animationEasing:k,isActive:O},function(I){var z=I.upperWidth,$=I.lowerWidth,V=I.height,K=I.x,te=I.y;return de.createElement(Al,{canBegin:u>0,from:"0px ".concat(u===-1?1:u,"px"),to:"".concat(u,"px 0px"),attributeName:"strokeDasharray",begin:D,duration:N,easing:k},de.createElement("path",pN({},Cr(n,!0),{className:T,d:F5(K,te,z,$,V),ref:s})))}):de.createElement("g",null,de.createElement("path",pN({},Cr(n,!0),{className:T,d:F5(m,p,y,v,j)})))},dOe=["option","shapeType","propTransformer","activeClassName","isActive"];function fb(e){"@babel/helpers - typeof";return fb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fb(e)}function hOe(e,t){if(e==null)return{};var n=fOe(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function fOe(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function z5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function gN(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?z5(Object(n),!0).forEach(function(s){mOe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function mOe(e,t,n){return t=pOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pOe(e){var t=gOe(e,"string");return fb(t)=="symbol"?t:t+""}function gOe(e,t){if(fb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(fb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xOe(e,t){return gN(gN({},t),e)}function yOe(e,t){return e==="symbols"}function $5(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return de.createElement(_D,n);case"trapezoid":return de.createElement(uOe,n);case"sector":return de.createElement(dK,n);case"symbols":if(yOe(t))return de.createElement(zI,n);break;default:return null}}function vOe(e){return R.isValidElement(e)?e.props:e}function TK(e){var t=e.option,n=e.shapeType,s=e.propTransformer,i=s===void 0?xOe:s,c=e.activeClassName,u=c===void 0?"recharts-active-shape":c,a=e.isActive,m=hOe(e,dOe),p;if(R.isValidElement(t))p=R.cloneElement(t,gN(gN({},m),vOe(t)));else if(Br(t))p=t(m);else if(HMe(t)&&!eOe(t)){var y=i(t,m);p=de.createElement($5,{shapeType:n,elementProps:y})}else{var v=m;p=de.createElement($5,{shapeType:n,elementProps:v})}return a?de.createElement(xn,{className:u},p):p}function dP(e,t){return t!=null&&"trapezoids"in e.props}function hP(e,t){return t!=null&&"sectors"in e.props}function mb(e,t){return t!=null&&"points"in e.props}function _Oe(e,t){var n,s,i=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,c=e.y===(t==null||(s=t.labelViewBox)===null||s===void 0?void 0:s.y)||e.y===t.y;return i&&c}function bOe(e,t){var n=e.endAngle===t.endAngle,s=e.startAngle===t.startAngle;return n&&s}function jOe(e,t){var n=e.x===t.x,s=e.y===t.y,i=e.z===t.z;return n&&s&&i}function wOe(e,t){var n;return dP(e,t)?n=_Oe:hP(e,t)?n=bOe:mb(e,t)&&(n=jOe),n}function SOe(e,t){var n;return dP(e,t)?n="trapezoids":hP(e,t)?n="sectors":mb(e,t)&&(n="points"),n}function NOe(e,t){if(dP(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(hP(e,t)){var s;return(s=t.tooltipPayload)===null||s===void 0||(s=s[0])===null||s===void 0||(s=s.payload)===null||s===void 0?void 0:s.payload}return mb(e,t)?t.payload:{}}function POe(e){var t=e.activeTooltipItem,n=e.graphicalItem,s=e.itemData,i=SOe(n,t),c=NOe(n,t),u=s.filter(function(m,p){var y=rf(c,m),v=n.props[i].filter(function(k){var N=wOe(n,t);return N(k,t)}),j=n.props[i].indexOf(v[v.length-1]),S=p===j;return y&&S}),a=s.indexOf(u[u.length-1]);return a}var O1;function Xx(e){"@babel/helpers - typeof";return Xx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xx(e)}function Fg(){return Fg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Fg.apply(this,arguments)}function B5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function fs(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?B5(Object(n),!0).forEach(function(s){_l(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function COe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q5(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,MK(s.key),s)}}function AOe(e,t,n){return t&&q5(e.prototype,t),n&&q5(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function kOe(e,t,n){return t=xN(t),TOe(e,EK()?Reflect.construct(t,n||[],xN(e).constructor):t.apply(e,n))}function TOe(e,t){if(t&&(Xx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return EOe(e)}function EOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(EK=function(){return!!e})()}function xN(e){return xN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},xN(e)}function MOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nM(e,t)}function nM(e,t){return nM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},nM(e,t)}function _l(e,t,n){return t=MK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function MK(e){var t=OOe(e,"string");return Xx(t)=="symbol"?t:t+""}function OOe(e,t){if(Xx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(Xx(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var tu=function(e){function t(n){var s;return COe(this,t),s=kOe(this,t,[n]),_l(s,"pieRef",null),_l(s,"sectorRefs",[]),_l(s,"id",tp("recharts-pie-")),_l(s,"handleAnimationEnd",function(){var i=s.props.onAnimationEnd;s.setState({isAnimationFinished:!0}),Br(i)&&i()}),_l(s,"handleAnimationStart",function(){var i=s.props.onAnimationStart;s.setState({isAnimationFinished:!1}),Br(i)&&i()}),s.state={isAnimationFinished:!n.isAnimationActive,prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,sectorToFocus:0},s}return MOe(t,e),AOe(t,[{key:"isActiveIndex",value:function(s){var i=this.props.activeIndex;return Array.isArray(i)?i.indexOf(s)!==-1:s===i}},{key:"hasActiveIndex",value:function(){var s=this.props.activeIndex;return Array.isArray(s)?s.length!==0:s||s===0}},{key:"renderLabels",value:function(s){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var c=this.props,u=c.label,a=c.labelLine,m=c.dataKey,p=c.valueKey,y=Cr(this.props,!1),v=Cr(u,!1),j=Cr(a,!1),S=u&&u.offsetRadius||20,k=s.map(function(N,D){var O=(N.startAngle+N.endAngle)/2,T=$n(N.cx,N.cy,N.outerRadius+S,O),I=fs(fs(fs(fs({},y),N),{},{stroke:"none"},v),{},{index:D,textAnchor:t.getTextAnchor(T.x,N.cx)},T),z=fs(fs(fs(fs({},y),N),{},{fill:"none",stroke:N.fill},j),{},{index:D,points:[$n(N.cx,N.cy,N.outerRadius,O),T]}),$=m;return Zr(m)&&Zr(p)?$="value":Zr(m)&&($=p),de.createElement(xn,{key:"label-".concat(N.startAngle,"-").concat(N.endAngle,"-").concat(N.midAngle,"-").concat(D)},a&&t.renderLabelLineItem(a,z,"line"),t.renderLabelItem(u,I,Ys(N,$)))});return de.createElement(xn,{className:"recharts-pie-labels"},k)}},{key:"renderSectorsStatically",value:function(s){var i=this,c=this.props,u=c.activeShape,a=c.blendStroke,m=c.inactiveShape;return s.map(function(p,y){if((p==null?void 0:p.startAngle)===0&&(p==null?void 0:p.endAngle)===0&&s.length!==1)return null;var v=i.isActiveIndex(y),j=m&&i.hasActiveIndex()?m:null,S=v?u:j,k=fs(fs({},p),{},{stroke:a?p.fill:p.stroke,tabIndex:-1});return de.createElement(xn,Fg({ref:function(D){D&&!i.sectorRefs.includes(D)&&i.sectorRefs.push(D)},tabIndex:-1,className:"recharts-pie-sector"},Wm(i.props,p,y),{key:"sector-".concat(p==null?void 0:p.startAngle,"-").concat(p==null?void 0:p.endAngle,"-").concat(p.midAngle,"-").concat(y)}),de.createElement(TK,Fg({option:S,isActive:v,shapeType:"sector"},k)))})}},{key:"renderSectorsWithAnimation",value:function(){var s=this,i=this.props,c=i.sectors,u=i.isAnimationActive,a=i.animationBegin,m=i.animationDuration,p=i.animationEasing,y=i.animationId,v=this.state,j=v.prevSectors,S=v.prevIsAnimationActive;return de.createElement(Al,{begin:a,duration:m,isActive:u,easing:p,from:{t:0},to:{t:1},key:"pie-".concat(y,"-").concat(S),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(k){var N=k.t,D=[],O=c&&c[0],T=O.startAngle;return c.forEach(function(I,z){var $=j&&j[z],V=z>0?Zo(I,"paddingAngle",0):0;if($){var K=Zs($.endAngle-$.startAngle,I.endAngle-I.startAngle),te=fs(fs({},I),{},{startAngle:T+V,endAngle:T+K(N)+V});D.push(te),T=te.endAngle}else{var X=I.endAngle,ve=I.startAngle,ae=Zs(0,X-ve),pe=ae(N),Oe=fs(fs({},I),{},{startAngle:T+V,endAngle:T+pe+V});D.push(Oe),T=Oe.endAngle}}),de.createElement(xn,null,s.renderSectorsStatically(D))})}},{key:"attachKeyboardHandlers",value:function(s){var i=this;s.onkeydown=function(c){if(!c.altKey)switch(c.key){case"ArrowLeft":{var u=++i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[u].focus(),i.setState({sectorToFocus:u});break}case"ArrowRight":{var a=--i.state.sectorToFocus<0?i.sectorRefs.length-1:i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[a].focus(),i.setState({sectorToFocus:a});break}case"Escape":{i.sectorRefs[i.state.sectorToFocus].blur(),i.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var s=this.props,i=s.sectors,c=s.isAnimationActive,u=this.state.prevSectors;return c&&i&&i.length&&(!u||!rf(u,i))?this.renderSectorsWithAnimation():this.renderSectorsStatically(i)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var s=this,i=this.props,c=i.hide,u=i.sectors,a=i.className,m=i.label,p=i.cx,y=i.cy,v=i.innerRadius,j=i.outerRadius,S=i.isAnimationActive,k=this.state.isAnimationFinished;if(c||!u||!u.length||!Ut(p)||!Ut(y)||!Ut(v)||!Ut(j))return null;var N=Yr("recharts-pie",a);return de.createElement(xn,{tabIndex:this.props.rootTabIndex,className:N,ref:function(O){s.pieRef=O}},this.renderSectors(),m&&this.renderLabels(u),ra.renderCallByParent(this.props,null,!1),(!S||k)&&gc.renderCallByParent(this.props,u,!1))}}],[{key:"getDerivedStateFromProps",value:function(s,i){return i.prevIsAnimationActive!==s.isAnimationActive?{prevIsAnimationActive:s.isAnimationActive,prevAnimationId:s.animationId,curSectors:s.sectors,prevSectors:[],isAnimationFinished:!0}:s.isAnimationActive&&s.animationId!==i.prevAnimationId?{prevAnimationId:s.animationId,curSectors:s.sectors,prevSectors:i.curSectors,isAnimationFinished:!0}:s.sectors!==i.curSectors?{curSectors:s.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(s,i){return s>i?"start":s<i?"end":"middle"}},{key:"renderLabelLineItem",value:function(s,i,c){if(de.isValidElement(s))return de.cloneElement(s,i);if(Br(s))return s(i);var u=Yr("recharts-pie-label-line",typeof s!="boolean"?s.className:"");return de.createElement(km,Fg({},i,{key:c,type:"linear",className:u}))}},{key:"renderLabelItem",value:function(s,i,c){if(de.isValidElement(s))return de.cloneElement(s,i);var u=c;if(Br(s)&&(u=s(i),de.isValidElement(u)))return u;var a=Yr("recharts-pie-label-text",typeof s!="boolean"&&!Br(s)?s.className:"");return de.createElement(Gm,Fg({},i,{alignmentBaseline:"middle",className:a}),u)}}])}(R.PureComponent);O1=tu;_l(tu,"displayName","Pie");_l(tu,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Sd.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});_l(tu,"parseDeltaAngle",function(e,t){var n=Ya(t-e),s=Math.min(Math.abs(t-e),360);return n*s});_l(tu,"getRealPieData",function(e){var t=e.data,n=e.children,s=Cr(e,!1),i=Yo(n,q0);return t&&t.length?t.map(function(c,u){return fs(fs(fs({payload:c},s),c),i&&i[u]&&i[u].props)}):i&&i.length?i.map(function(c){return fs(fs({},s),c.props)}):[]});_l(tu,"parseCoordinateOfPie",function(e,t){var n=t.top,s=t.left,i=t.width,c=t.height,u=iK(i,c),a=s+Xa(e.cx,i,i/2),m=n+Xa(e.cy,c,c/2),p=Xa(e.innerRadius,u,0),y=Xa(e.outerRadius,u,u*.8),v=e.maxRadius||Math.sqrt(i*i+c*c)/2;return{cx:a,cy:m,innerRadius:p,outerRadius:y,maxRadius:v}});_l(tu,"getComposedData",function(e){var t=e.item,n=e.offset,s=t.type.defaultProps!==void 0?fs(fs({},t.type.defaultProps),t.props):t.props,i=O1.getRealPieData(s);if(!i||!i.length)return null;var c=s.cornerRadius,u=s.startAngle,a=s.endAngle,m=s.paddingAngle,p=s.dataKey,y=s.nameKey,v=s.valueKey,j=s.tooltipType,S=Math.abs(s.minAngle),k=O1.parseCoordinateOfPie(s,n),N=O1.parseDeltaAngle(u,a),D=Math.abs(N),O=p;Zr(p)&&Zr(v)?(pc(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),O="value"):Zr(p)&&(pc(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),O=v);var T=i.filter(function(te){return Ys(te,O,0)!==0}).length,I=(D>=360?T:T-1)*m,z=D-T*S-I,$=i.reduce(function(te,X){var ve=Ys(X,O,0);return te+(Ut(ve)?ve:0)},0),V;if($>0){var K;V=i.map(function(te,X){var ve=Ys(te,O,0),ae=Ys(te,y,X),pe=(Ut(ve)?ve:0)/$,Oe;X?Oe=K.endAngle+Ya(N)*m*(ve!==0?1:0):Oe=u;var Me=Oe+Ya(N)*((ve!==0?S:0)+pe*z),Xe=(Oe+Me)/2,Ve=(k.innerRadius+k.outerRadius)/2,et=[{name:ae,value:ve,payload:te,dataKey:O,type:j}],Ce=$n(k.cx,k.cy,Ve,Xe);return K=fs(fs(fs({percent:pe,cornerRadius:c,name:ae,tooltipPayload:et,midAngle:Xe,middleRadius:Ve,tooltipPosition:Ce},te),k),{},{value:Ys(te,O),startAngle:Oe,endAngle:Me,payload:te,paddingAngle:Ya(N)*m}),K})}return fs(fs({},k),{},{sectors:V,data:i})});function IOe(e){return e&&e.length?e[0]:void 0}var DOe=IOe,ROe=DOe;const LOe=Fn(ROe);var FOe=["key"];function Qx(e){"@babel/helpers - typeof";return Qx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qx(e)}function zOe(e,t){if(e==null)return{};var n=$Oe(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function $Oe(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function yN(){return yN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},yN.apply(this,arguments)}function V5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Ka(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?V5(Object(n),!0).forEach(function(s){Vu(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function BOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U5(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,IK(s.key),s)}}function qOe(e,t,n){return t&&U5(e.prototype,t),n&&U5(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function VOe(e,t,n){return t=vN(t),UOe(e,OK()?Reflect.construct(t,n||[],vN(e).constructor):t.apply(e,n))}function UOe(e,t){if(t&&(Qx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WOe(e)}function WOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OK=function(){return!!e})()}function vN(e){return vN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},vN(e)}function GOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sM(e,t)}function sM(e,t){return sM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},sM(e,t)}function Vu(e,t,n){return t=IK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function IK(e){var t=KOe(e,"string");return Qx(t)=="symbol"?t:t+""}function KOe(e,t){if(Qx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(Qx(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Hb=function(e){function t(){var n;BOe(this,t);for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];return n=VOe(this,t,[].concat(i)),Vu(n,"state",{isAnimationFinished:!1}),Vu(n,"handleAnimationEnd",function(){var u=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Br(u)&&u()}),Vu(n,"handleAnimationStart",function(){var u=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Br(u)&&u()}),Vu(n,"handleMouseEnter",function(u){var a=n.props.onMouseEnter;a&&a(n.props,u)}),Vu(n,"handleMouseLeave",function(u){var a=n.props.onMouseLeave;a&&a(n.props,u)}),n}return GOe(t,e),qOe(t,[{key:"renderDots",value:function(s){var i=this.props,c=i.dot,u=i.dataKey,a=Cr(this.props,!1),m=Cr(c,!0),p=s.map(function(y,v){var j=Ka(Ka(Ka({key:"dot-".concat(v),r:3},a),m),{},{dataKey:u,cx:y.x,cy:y.y,index:v,payload:y});return t.renderDotItem(c,j)});return de.createElement(xn,{className:"recharts-radar-dots"},p)}},{key:"renderPolygonStatically",value:function(s){var i=this.props,c=i.shape,u=i.dot,a=i.isRange,m=i.baseLinePoints,p=i.connectNulls,y;return de.isValidElement(c)?y=de.cloneElement(c,Ka(Ka({},this.props),{},{points:s})):Br(c)?y=c(Ka(Ka({},this.props),{},{points:s})):y=de.createElement(wK,yN({},Cr(this.props,!0),{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,points:s,baseLinePoints:a?m:null,connectNulls:p})),de.createElement(xn,{className:"recharts-radar-polygon"},y,u?this.renderDots(s):null)}},{key:"renderPolygonWithAnimation",value:function(){var s=this,i=this.props,c=i.points,u=i.isAnimationActive,a=i.animationBegin,m=i.animationDuration,p=i.animationEasing,y=i.animationId,v=this.state.prevPoints;return de.createElement(Al,{begin:a,duration:m,isActive:u,easing:p,from:{t:0},to:{t:1},key:"radar-".concat(y),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(j){var S=j.t,k=v&&v.length/c.length,N=c.map(function(D,O){var T=v&&v[Math.floor(O*k)];if(T){var I=Zs(T.x,D.x),z=Zs(T.y,D.y);return Ka(Ka({},D),{},{x:I(S),y:z(S)})}var $=Zs(D.cx,D.x),V=Zs(D.cy,D.y);return Ka(Ka({},D),{},{x:$(S),y:V(S)})});return s.renderPolygonStatically(N)})}},{key:"renderPolygon",value:function(){var s=this.props,i=s.points,c=s.isAnimationActive,u=s.isRange,a=this.state.prevPoints;return c&&i&&i.length&&!u&&(!a||!rf(a,i))?this.renderPolygonWithAnimation():this.renderPolygonStatically(i)}},{key:"render",value:function(){var s=this.props,i=s.hide,c=s.className,u=s.points,a=s.isAnimationActive;if(i||!u||!u.length)return null;var m=this.state.isAnimationFinished,p=Yr("recharts-radar",c);return de.createElement(xn,{className:p},this.renderPolygon(),(!a||m)&&gc.renderCallByParent(this.props,u))}}],[{key:"getDerivedStateFromProps",value:function(s,i){return s.animationId!==i.prevAnimationId?{prevAnimationId:s.animationId,curPoints:s.points,prevPoints:i.curPoints}:s.points!==i.curPoints?{curPoints:s.points}:null}},{key:"renderDotItem",value:function(s,i){var c;if(de.isValidElement(s))c=de.cloneElement(s,i);else if(Br(s))c=s(i);else{var u=i.key,a=zOe(i,FOe);c=de.createElement(Wy,yN({},a,{key:u,className:Yr("recharts-radar-dot",typeof s!="boolean"?s.className:"")}))}return c}}])}(R.PureComponent);Vu(Hb,"displayName","Radar");Vu(Hb,"defaultProps",{angleAxisId:0,radiusAxisId:0,hide:!1,activeDot:!0,dot:!1,legendType:"rect",isAnimationActive:!Sd.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Vu(Hb,"getComposedData",function(e){var t=e.radiusAxis,n=e.angleAxis,s=e.displayedData,i=e.dataKey,c=e.bandSize,u=n.cx,a=n.cy,m=!1,p=[],y=n.type!=="number"?c??0:0;s.forEach(function(j,S){var k=Ys(j,n.dataKey,S),N=Ys(j,i),D=n.scale(k)+y,O=Array.isArray(N)?cK(N):N,T=Zr(O)?void 0:t.scale(O);Array.isArray(N)&&N.length>=2&&(m=!0),p.push(Ka(Ka({},$n(u,a,T,D)),{},{name:k,value:N,cx:u,cy:a,radius:T,angle:D,payload:j}))});var v=[];return m&&p.forEach(function(j){if(Array.isArray(j.value)){var S=LOe(j.value),k=Zr(S)?void 0:t.scale(S);v.push(Ka(Ka({},j),{},{radius:k},$n(u,a,k,j.angle)))}else v.push(j)}),{points:p,isRange:m,baseLinePoints:v}});var HOe=Math.ceil,ZOe=Math.max;function YOe(e,t,n,s){for(var i=-1,c=ZOe(HOe((t-e)/(n||1)),0),u=Array(c);c--;)u[s?c:++i]=e,e+=n;return u}var XOe=YOe,QOe=G7,W5=1/0,JOe=17976931348623157e292;function eIe(e){if(!e)return e===0?e:0;if(e=QOe(e),e===W5||e===-W5){var t=e<0?-1:1;return t*JOe}return e===e?e:0}var DK=eIe,tIe=XOe,rIe=Q2,ek=DK;function nIe(e){return function(t,n,s){return s&&typeof s!="number"&&rIe(t,n,s)&&(n=s=void 0),t=ek(t),n===void 0?(n=t,t=0):n=ek(n),s=s===void 0?t<n?1:-1:ek(s),tIe(t,n,s,e)}}var sIe=nIe,iIe=sIe,aIe=iIe(),oIe=aIe;const _N=Fn(oIe);function pb(e){"@babel/helpers - typeof";return pb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pb(e)}function G5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function K5(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?G5(Object(n),!0).forEach(function(s){RK(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function RK(e,t,n){return t=lIe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lIe(e){var t=cIe(e,"string");return pb(t)=="symbol"?t:t+""}function cIe(e,t){if(pb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(pb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uIe=["Webkit","Moz","O","ms"],dIe=function(t,n){var s=t.replace(/(\w)/,function(c){return c.toUpperCase()}),i=uIe.reduce(function(c,u){return K5(K5({},c),{},RK({},u+s,n))},{});return i[t]=n,i};function Jx(e){"@babel/helpers - typeof";return Jx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jx(e)}function bN(){return bN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},bN.apply(this,arguments)}function H5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function tk(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?H5(Object(n),!0).forEach(function(s){Ro(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function hIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z5(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,FK(s.key),s)}}function fIe(e,t,n){return t&&Z5(e.prototype,t),n&&Z5(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function mIe(e,t,n){return t=jN(t),pIe(e,LK()?Reflect.construct(t,n||[],jN(e).constructor):t.apply(e,n))}function pIe(e,t){if(t&&(Jx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gIe(e)}function gIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(LK=function(){return!!e})()}function jN(e){return jN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},jN(e)}function xIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iM(e,t)}function iM(e,t){return iM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},iM(e,t)}function Ro(e,t,n){return t=FK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FK(e){var t=yIe(e,"string");return Jx(t)=="symbol"?t:t+""}function yIe(e,t){if(Jx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(Jx(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var vIe=function(t){var n=t.data,s=t.startIndex,i=t.endIndex,c=t.x,u=t.width,a=t.travellerWidth;if(!n||!n.length)return{};var m=n.length,p=t0().domain(_N(0,m)).range([c,c+u-a]),y=p.domain().map(function(v){return p(v)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:p(s),endX:p(i),scale:p,scaleValues:y}},Y5=function(t){return t.changedTouches&&!!t.changedTouches.length},ey=function(e){function t(n){var s;return hIe(this,t),s=mIe(this,t,[n]),Ro(s,"handleDrag",function(i){s.leaveTimer&&(clearTimeout(s.leaveTimer),s.leaveTimer=null),s.state.isTravellerMoving?s.handleTravellerMove(i):s.state.isSlideMoving&&s.handleSlideDrag(i)}),Ro(s,"handleTouchMove",function(i){i.changedTouches!=null&&i.changedTouches.length>0&&s.handleDrag(i.changedTouches[0])}),Ro(s,"handleDragEnd",function(){s.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var i=s.props,c=i.endIndex,u=i.onDragEnd,a=i.startIndex;u==null||u({endIndex:c,startIndex:a})}),s.detachDragEndListener()}),Ro(s,"handleLeaveWrapper",function(){(s.state.isTravellerMoving||s.state.isSlideMoving)&&(s.leaveTimer=window.setTimeout(s.handleDragEnd,s.props.leaveTimeOut))}),Ro(s,"handleEnterSlideOrTraveller",function(){s.setState({isTextActive:!0})}),Ro(s,"handleLeaveSlideOrTraveller",function(){s.setState({isTextActive:!1})}),Ro(s,"handleSlideDragStart",function(i){var c=Y5(i)?i.changedTouches[0]:i;s.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:c.pageX}),s.attachDragEndListener()}),s.travellerDragStartHandlers={startX:s.handleTravellerDragStart.bind(s,"startX"),endX:s.handleTravellerDragStart.bind(s,"endX")},s.state={},s}return xIe(t,e),fIe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(s){var i=s.startX,c=s.endX,u=this.state.scaleValues,a=this.props,m=a.gap,p=a.data,y=p.length-1,v=Math.min(i,c),j=Math.max(i,c),S=t.getIndexInRange(u,v),k=t.getIndexInRange(u,j);return{startIndex:S-S%m,endIndex:k===y?y:k-k%m}}},{key:"getTextOfTick",value:function(s){var i=this.props,c=i.data,u=i.tickFormatter,a=i.dataKey,m=Ys(c[s],a,s);return Br(u)?u(m,s):m}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(s){var i=this.state,c=i.slideMoveStartX,u=i.startX,a=i.endX,m=this.props,p=m.x,y=m.width,v=m.travellerWidth,j=m.startIndex,S=m.endIndex,k=m.onChange,N=s.pageX-c;N>0?N=Math.min(N,p+y-v-a,p+y-v-u):N<0&&(N=Math.max(N,p-u,p-a));var D=this.getIndex({startX:u+N,endX:a+N});(D.startIndex!==j||D.endIndex!==S)&&k&&k(D),this.setState({startX:u+N,endX:a+N,slideMoveStartX:s.pageX})}},{key:"handleTravellerDragStart",value:function(s,i){var c=Y5(i)?i.changedTouches[0]:i;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:s,brushMoveStartX:c.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(s){var i=this.state,c=i.brushMoveStartX,u=i.movingTravellerId,a=i.endX,m=i.startX,p=this.state[u],y=this.props,v=y.x,j=y.width,S=y.travellerWidth,k=y.onChange,N=y.gap,D=y.data,O={startX:this.state.startX,endX:this.state.endX},T=s.pageX-c;T>0?T=Math.min(T,v+j-S-p):T<0&&(T=Math.max(T,v-p)),O[u]=p+T;var I=this.getIndex(O),z=I.startIndex,$=I.endIndex,V=function(){var te=D.length-1;return u==="startX"&&(a>m?z%N===0:$%N===0)||a<m&&$===te||u==="endX"&&(a>m?$%N===0:z%N===0)||a>m&&$===te};this.setState(Ro(Ro({},u,p+T),"brushMoveStartX",s.pageX),function(){k&&V()&&k(I)})}},{key:"handleTravellerMoveKeyboard",value:function(s,i){var c=this,u=this.state,a=u.scaleValues,m=u.startX,p=u.endX,y=this.state[i],v=a.indexOf(y);if(v!==-1){var j=v+s;if(!(j===-1||j>=a.length)){var S=a[j];i==="startX"&&S>=p||i==="endX"&&S<=m||this.setState(Ro({},i,S),function(){c.props.onChange(c.getIndex({startX:c.state.startX,endX:c.state.endX}))})}}}},{key:"renderBackground",value:function(){var s=this.props,i=s.x,c=s.y,u=s.width,a=s.height,m=s.fill,p=s.stroke;return de.createElement("rect",{stroke:p,fill:m,x:i,y:c,width:u,height:a})}},{key:"renderPanorama",value:function(){var s=this.props,i=s.x,c=s.y,u=s.width,a=s.height,m=s.data,p=s.children,y=s.padding,v=R.Children.only(p);return v?de.cloneElement(v,{x:i,y:c,width:u,height:a,margin:y,compact:!0,data:m}):null}},{key:"renderTravellerLayer",value:function(s,i){var c,u,a=this,m=this.props,p=m.y,y=m.travellerWidth,v=m.height,j=m.traveller,S=m.ariaLabel,k=m.data,N=m.startIndex,D=m.endIndex,O=Math.max(s,this.props.x),T=tk(tk({},Cr(this.props,!1)),{},{x:O,y:p,width:y,height:v}),I=S||"Min value: ".concat((c=k[N])===null||c===void 0?void 0:c.name,", Max value: ").concat((u=k[D])===null||u===void 0?void 0:u.name);return de.createElement(xn,{tabIndex:0,role:"slider","aria-label":I,"aria-valuenow":s,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[i],onTouchStart:this.travellerDragStartHandlers[i],onKeyDown:function($){["ArrowLeft","ArrowRight"].includes($.key)&&($.preventDefault(),$.stopPropagation(),a.handleTravellerMoveKeyboard($.key==="ArrowRight"?1:-1,i))},onFocus:function(){a.setState({isTravellerFocused:!0})},onBlur:function(){a.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(j,T))}},{key:"renderSlide",value:function(s,i){var c=this.props,u=c.y,a=c.height,m=c.stroke,p=c.travellerWidth,y=Math.min(s,i)+p,v=Math.max(Math.abs(i-s)-p,0);return de.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:m,fillOpacity:.2,x:y,y:u,width:v,height:a})}},{key:"renderText",value:function(){var s=this.props,i=s.startIndex,c=s.endIndex,u=s.y,a=s.height,m=s.travellerWidth,p=s.stroke,y=this.state,v=y.startX,j=y.endX,S=5,k={pointerEvents:"none",fill:p};return de.createElement(xn,{className:"recharts-brush-texts"},de.createElement(Gm,bN({textAnchor:"end",verticalAnchor:"middle",x:Math.min(v,j)-S,y:u+a/2},k),this.getTextOfTick(i)),de.createElement(Gm,bN({textAnchor:"start",verticalAnchor:"middle",x:Math.max(v,j)+m+S,y:u+a/2},k),this.getTextOfTick(c)))}},{key:"render",value:function(){var s=this.props,i=s.data,c=s.className,u=s.children,a=s.x,m=s.y,p=s.width,y=s.height,v=s.alwaysShowText,j=this.state,S=j.startX,k=j.endX,N=j.isTextActive,D=j.isSlideMoving,O=j.isTravellerMoving,T=j.isTravellerFocused;if(!i||!i.length||!Ut(a)||!Ut(m)||!Ut(p)||!Ut(y)||p<=0||y<=0)return null;var I=Yr("recharts-brush",c),z=de.Children.count(u)===1,$=dIe("userSelect","none");return de.createElement(xn,{className:I,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:$},this.renderBackground(),z&&this.renderPanorama(),this.renderSlide(S,k),this.renderTravellerLayer(S,"startX"),this.renderTravellerLayer(k,"endX"),(N||D||O||T||v)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(s){var i=s.x,c=s.y,u=s.width,a=s.height,m=s.stroke,p=Math.floor(c+a/2)-1;return de.createElement(de.Fragment,null,de.createElement("rect",{x:i,y:c,width:u,height:a,fill:m,stroke:"none"}),de.createElement("line",{x1:i+1,y1:p,x2:i+u-1,y2:p,fill:"none",stroke:"#fff"}),de.createElement("line",{x1:i+1,y1:p+2,x2:i+u-1,y2:p+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(s,i){var c;return de.isValidElement(s)?c=de.cloneElement(s,i):Br(s)?c=s(i):c=t.renderDefaultTraveller(i),c}},{key:"getDerivedStateFromProps",value:function(s,i){var c=s.data,u=s.width,a=s.x,m=s.travellerWidth,p=s.updateId,y=s.startIndex,v=s.endIndex;if(c!==i.prevData||p!==i.prevUpdateId)return tk({prevData:c,prevTravellerWidth:m,prevUpdateId:p,prevX:a,prevWidth:u},c&&c.length?vIe({data:c,width:u,x:a,travellerWidth:m,startIndex:y,endIndex:v}):{scale:null,scaleValues:null});if(i.scale&&(u!==i.prevWidth||a!==i.prevX||m!==i.prevTravellerWidth)){i.scale.range([a,a+u-m]);var j=i.scale.domain().map(function(S){return i.scale(S)});return{prevData:c,prevTravellerWidth:m,prevUpdateId:p,prevX:a,prevWidth:u,startX:i.scale(s.startIndex),endX:i.scale(s.endIndex),scaleValues:j}}return null}},{key:"getIndexInRange",value:function(s,i){for(var c=s.length,u=0,a=c-1;a-u>1;){var m=Math.floor((u+a)/2);s[m]>i?a=m:u=m}return i>=s[a]?a:u}}])}(R.PureComponent);Ro(ey,"displayName","Brush");Ro(ey,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var _Ie=GI;function bIe(e,t){var n;return _Ie(e,function(s,i,c){return n=t(s,i,c),!n}),!!n}var jIe=bIe,wIe=v7,SIe=ou,NIe=jIe,PIe=No,CIe=Q2;function AIe(e,t,n){var s=PIe(e)?wIe:NIe;return n&&CIe(e,t,n)&&(t=void 0),s(e,SIe(t))}var kIe=AIe;const TIe=Fn(kIe);var Qc=function(t,n){var s=t.alwaysShow,i=t.ifOverflow;return s&&(i="extendDomain"),i===n},X5=B7;function EIe(e,t,n){t=="__proto__"&&X5?X5(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var MIe=EIe,OIe=MIe,IIe=z7,DIe=ou;function RIe(e,t){var n={};return t=DIe(t),IIe(e,function(s,i,c){OIe(n,i,t(s,i,c))}),n}var LIe=RIe;const FIe=Fn(LIe);function zIe(e,t){for(var n=-1,s=e==null?0:e.length;++n<s;)if(!t(e[n],n,e))return!1;return!0}var $Ie=zIe,BIe=GI;function qIe(e,t){var n=!0;return BIe(e,function(s,i,c){return n=!!t(s,i,c),n}),n}var VIe=qIe,UIe=$Ie,WIe=VIe,GIe=ou,KIe=No,HIe=Q2;function ZIe(e,t,n){var s=KIe(e)?UIe:WIe;return n&&HIe(e,t,n)&&(t=void 0),s(e,GIe(t))}var YIe=ZIe;const zK=Fn(YIe);var XIe=["x","y"];function gb(e){"@babel/helpers - typeof";return gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gb(e)}function aM(){return aM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},aM.apply(this,arguments)}function Q5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function O_(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Q5(Object(n),!0).forEach(function(s){QIe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function QIe(e,t,n){return t=JIe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JIe(e){var t=eDe(e,"string");return gb(t)=="symbol"?t:t+""}function eDe(e,t){if(gb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(gb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tDe(e,t){if(e==null)return{};var n=rDe(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function rDe(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function nDe(e,t){var n=e.x,s=e.y,i=tDe(e,XIe),c="".concat(n),u=parseInt(c,10),a="".concat(s),m=parseInt(a,10),p="".concat(t.height||i.height),y=parseInt(p,10),v="".concat(t.width||i.width),j=parseInt(v,10);return O_(O_(O_(O_(O_({},t),i),u?{x:u}:{}),m?{y:m}:{}),{},{height:y,width:j,name:t.name,radius:t.radius})}function J5(e){return de.createElement(TK,aM({shapeType:"rectangle",propTransformer:nDe,activeClassName:"recharts-active-bar"},e))}var sDe=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(s,i){if(typeof t=="number")return t;var c=typeof s=="number";return c?t(s,i):(c||Hm(),n)}},iDe=["value","background"],$K;function ty(e){"@babel/helpers - typeof";return ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ty(e)}function aDe(e,t){if(e==null)return{};var n=oDe(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function oDe(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function wN(){return wN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},wN.apply(this,arguments)}function e6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Si(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?e6(Object(n),!0).forEach(function(s){Eh(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function lDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t6(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,qK(s.key),s)}}function cDe(e,t,n){return t&&t6(e.prototype,t),n&&t6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function uDe(e,t,n){return t=SN(t),dDe(e,BK()?Reflect.construct(t,n||[],SN(e).constructor):t.apply(e,n))}function dDe(e,t){if(t&&(ty(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hDe(e)}function hDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(BK=function(){return!!e})()}function SN(e){return SN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},SN(e)}function fDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oM(e,t)}function oM(e,t){return oM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},oM(e,t)}function Eh(e,t,n){return t=qK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qK(e){var t=mDe(e,"string");return ty(t)=="symbol"?t:t+""}function mDe(e,t){if(ty(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(ty(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ia=function(e){function t(){var n;lDe(this,t);for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];return n=uDe(this,t,[].concat(i)),Eh(n,"state",{isAnimationFinished:!1}),Eh(n,"id",tp("recharts-bar-")),Eh(n,"handleAnimationEnd",function(){var u=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),u&&u()}),Eh(n,"handleAnimationStart",function(){var u=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),u&&u()}),n}return fDe(t,e),cDe(t,[{key:"renderRectanglesStatically",value:function(s){var i=this,c=this.props,u=c.shape,a=c.dataKey,m=c.activeIndex,p=c.activeBar,y=Cr(this.props,!1);return s&&s.map(function(v,j){var S=j===m,k=S?p:u,N=Si(Si(Si({},y),v),{},{isActive:S,option:k,index:j,dataKey:a,onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd});return de.createElement(xn,wN({className:"recharts-bar-rectangle"},Wm(i.props,v,j),{key:"rectangle-".concat(v==null?void 0:v.x,"-").concat(v==null?void 0:v.y,"-").concat(v==null?void 0:v.value)}),de.createElement(J5,N))})}},{key:"renderRectanglesWithAnimation",value:function(){var s=this,i=this.props,c=i.data,u=i.layout,a=i.isAnimationActive,m=i.animationBegin,p=i.animationDuration,y=i.animationEasing,v=i.animationId,j=this.state.prevData;return de.createElement(Al,{begin:m,duration:p,isActive:a,easing:y,from:{t:0},to:{t:1},key:"bar-".concat(v),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(S){var k=S.t,N=c.map(function(D,O){var T=j&&j[O];if(T){var I=Zs(T.x,D.x),z=Zs(T.y,D.y),$=Zs(T.width,D.width),V=Zs(T.height,D.height);return Si(Si({},D),{},{x:I(k),y:z(k),width:$(k),height:V(k)})}if(u==="horizontal"){var K=Zs(0,D.height),te=K(k);return Si(Si({},D),{},{y:D.y+D.height-te,height:te})}var X=Zs(0,D.width),ve=X(k);return Si(Si({},D),{},{width:ve})});return de.createElement(xn,null,s.renderRectanglesStatically(N))})}},{key:"renderRectangles",value:function(){var s=this.props,i=s.data,c=s.isAnimationActive,u=this.state.prevData;return c&&i&&i.length&&(!u||!rf(u,i))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(i)}},{key:"renderBackground",value:function(){var s=this,i=this.props,c=i.data,u=i.dataKey,a=i.activeIndex,m=Cr(this.props.background,!1);return c.map(function(p,y){p.value;var v=p.background,j=aDe(p,iDe);if(!v)return null;var S=Si(Si(Si(Si(Si({},j),{},{fill:"#eee"},v),m),Wm(s.props,p,y)),{},{onAnimationStart:s.handleAnimationStart,onAnimationEnd:s.handleAnimationEnd,dataKey:u,index:y,className:"recharts-bar-background-rectangle"});return de.createElement(J5,wN({key:"background-bar-".concat(y),option:s.props.background,isActive:y===a},S))})}},{key:"renderErrorBar",value:function(s,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var c=this.props,u=c.data,a=c.xAxis,m=c.yAxis,p=c.layout,y=c.children,v=Yo(y,Kb);if(!v)return null;var j=p==="vertical"?u[0].height/2:u[0].width/2,S=function(D,O){var T=Array.isArray(D.value)?D.value[1]:D.value;return{x:D.x,y:D.y,value:T,errorVal:Ys(D,O)}},k={clipPath:s?"url(#clipPath-".concat(i,")"):null};return de.createElement(xn,k,v.map(function(N){return de.cloneElement(N,{key:"error-bar-".concat(i,"-").concat(N.props.dataKey),data:u,xAxis:a,yAxis:m,layout:p,offset:j,dataPointFormatter:S})}))}},{key:"render",value:function(){var s=this.props,i=s.hide,c=s.data,u=s.className,a=s.xAxis,m=s.yAxis,p=s.left,y=s.top,v=s.width,j=s.height,S=s.isAnimationActive,k=s.background,N=s.id;if(i||!c||!c.length)return null;var D=this.state.isAnimationFinished,O=Yr("recharts-bar",u),T=a&&a.allowDataOverflow,I=m&&m.allowDataOverflow,z=T||I,$=Zr(N)?this.id:N;return de.createElement(xn,{className:O},T||I?de.createElement("defs",null,de.createElement("clipPath",{id:"clipPath-".concat($)},de.createElement("rect",{x:T?p:p-v/2,y:I?y:y-j/2,width:T?v:v*2,height:I?j:j*2}))):null,de.createElement(xn,{className:"recharts-bar-rectangles",clipPath:z?"url(#clipPath-".concat($,")"):null},k?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(z,$),(!S||D)&&gc.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(s,i){return s.animationId!==i.prevAnimationId?{prevAnimationId:s.animationId,curData:s.data,prevData:i.curData}:s.data!==i.curData?{curData:s.data}:null}}])}(R.PureComponent);$K=Ia;Eh(Ia,"displayName","Bar");Eh(Ia,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Sd.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Eh(Ia,"getComposedData",function(e){var t=e.props,n=e.item,s=e.barPosition,i=e.bandSize,c=e.xAxis,u=e.yAxis,a=e.xAxisTicks,m=e.yAxisTicks,p=e.stackedData,y=e.dataStartIndex,v=e.displayedData,j=e.offset,S=RAe(s,n);if(!S)return null;var k=t.layout,N=n.type.defaultProps,D=N!==void 0?Si(Si({},N),n.props):n.props,O=D.dataKey,T=D.children,I=D.minPointSize,z=k==="horizontal"?u:c,$=p?z.scale.domain():null,V=VAe({numericAxis:z}),K=Yo(T,q0),te=v.map(function(X,ve){var ae,pe,Oe,Me,Xe,Ve;p?ae=LAe(p[y+ve],$):(ae=Ys(X,O),Array.isArray(ae)||(ae=[V,ae]));var et=sDe(I,$K.defaultProps.minPointSize)(ae[1],ve);if(k==="horizontal"){var Ce,_e=[u.scale(ae[0]),u.scale(ae[1])],tt=_e[0],vt=_e[1];pe=B$({axis:c,ticks:a,bandSize:i,offset:S.offset,entry:X,index:ve}),Oe=(Ce=vt??tt)!==null&&Ce!==void 0?Ce:void 0,Me=S.size;var gt=tt-vt;if(Xe=Number.isNaN(gt)?0:gt,Ve={x:pe,y:u.y,width:Me,height:u.height},Math.abs(et)>0&&Math.abs(Xe)<Math.abs(et)){var Tt=Ya(Xe||et)*(Math.abs(et)-Math.abs(Xe));Oe-=Tt,Xe+=Tt}}else{var Ht=[c.scale(ae[0]),c.scale(ae[1])],Ir=Ht[0],Pr=Ht[1];if(pe=Ir,Oe=B$({axis:u,ticks:m,bandSize:i,offset:S.offset,entry:X,index:ve}),Me=Pr-Ir,Xe=S.size,Ve={x:c.x,y:Oe,width:c.width,height:Xe},Math.abs(et)>0&&Math.abs(Me)<Math.abs(et)){var Mt=Ya(Me||et)*(Math.abs(et)-Math.abs(Me));Me+=Mt}}return Si(Si(Si({},X),{},{x:pe,y:Oe,width:Me,height:Xe,value:p?ae:ae[1],payload:X,background:Ve},K&&K[ve]&&K[ve].props),{},{tooltipPayload:[nK(n,X)],tooltipPosition:{x:pe+Me/2,y:Oe+Xe/2}})});return Si({data:te,layout:k},j)});function xb(e){"@babel/helpers - typeof";return xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xb(e)}function pDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r6(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,VK(s.key),s)}}function gDe(e,t,n){return t&&r6(e.prototype,t),n&&r6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function n6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function rc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?n6(Object(n),!0).forEach(function(s){fP(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):n6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function fP(e,t,n){return t=VK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VK(e){var t=xDe(e,"string");return xb(t)=="symbol"?t:t+""}function xDe(e,t){if(xb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(xb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bD=function(t,n,s,i,c){var u=t.width,a=t.height,m=t.layout,p=t.children,y=Object.keys(n),v={left:s.left,leftMirror:s.left,right:u-s.right,rightMirror:u-s.right,top:s.top,topMirror:s.top,bottom:a-s.bottom,bottomMirror:a-s.bottom},j=!!zo(p,Ia);return y.reduce(function(S,k){var N=n[k],D=N.orientation,O=N.domain,T=N.padding,I=T===void 0?{}:T,z=N.mirror,$=N.reversed,V="".concat(D).concat(z?"Mirror":""),K,te,X,ve,ae;if(N.type==="number"&&(N.padding==="gap"||N.padding==="no-gap")){var pe=O[1]-O[0],Oe=1/0,Me=N.categoricalDomain.sort();if(Me.forEach(function(Ht,Ir){Ir>0&&(Oe=Math.min((Ht||0)-(Me[Ir-1]||0),Oe))}),Number.isFinite(Oe)){var Xe=Oe/pe,Ve=N.layout==="vertical"?s.height:s.width;if(N.padding==="gap"&&(K=Xe*Ve/2),N.padding==="no-gap"){var et=Xa(t.barCategoryGap,Xe*Ve),Ce=Xe*Ve/2;K=Ce-et-(Ce-et)/Ve*et}}}i==="xAxis"?te=[s.left+(I.left||0)+(K||0),s.left+s.width-(I.right||0)-(K||0)]:i==="yAxis"?te=m==="horizontal"?[s.top+s.height-(I.bottom||0),s.top+(I.top||0)]:[s.top+(I.top||0)+(K||0),s.top+s.height-(I.bottom||0)-(K||0)]:te=N.range,$&&(te=[te[1],te[0]]);var _e=JG(N,c,j),tt=_e.scale,vt=_e.realScaleType;tt.domain(O).range(te),eK(tt);var gt=tK(tt,rc(rc({},N),{},{realScaleType:vt}));i==="xAxis"?(ae=D==="top"&&!z||D==="bottom"&&z,X=s.left,ve=v[V]-ae*N.height):i==="yAxis"&&(ae=D==="left"&&!z||D==="right"&&z,X=v[V]-ae*N.width,ve=s.top);var Tt=rc(rc(rc({},N),gt),{},{realScaleType:vt,x:X,y:ve,scale:tt,width:i==="xAxis"?s.width:N.width,height:i==="yAxis"?s.height:N.height});return Tt.bandSize=aN(Tt,gt),!N.hide&&i==="xAxis"?v[V]+=(ae?-1:1)*Tt.height:N.hide||(v[V]+=(ae?-1:1)*Tt.width),rc(rc({},S),{},fP({},k,Tt))},{})},UK=function(t,n){var s=t.x,i=t.y,c=n.x,u=n.y;return{x:Math.min(s,c),y:Math.min(i,u),width:Math.abs(c-s),height:Math.abs(u-i)}},yDe=function(t){var n=t.x1,s=t.y1,i=t.x2,c=t.y2;return UK({x:n,y:s},{x:i,y:c})},WK=function(){function e(t){pDe(this,e),this.scale=t}return gDe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=s.bandAware,c=s.position;if(n!==void 0){if(c)switch(c){case"start":return this.scale(n);case"middle":{var u=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+u}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(n)+a}default:return this.scale(n)}if(i){var m=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+m}return this.scale(n)}}},{key:"isInRange",value:function(n){var s=this.range(),i=s[0],c=s[s.length-1];return i<=c?n>=i&&n<=c:n>=c&&n<=i}}],[{key:"create",value:function(n){return new e(n)}}])}();fP(WK,"EPS",1e-4);var jD=function(t){var n=Object.keys(t).reduce(function(s,i){return rc(rc({},s),{},fP({},i,WK.create(t[i])))},{});return rc(rc({},n),{},{apply:function(i){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=c.bandAware,a=c.position;return FIe(i,function(m,p){return n[p].apply(m,{bandAware:u,position:a})})},isInRange:function(i){return zK(i,function(c,u){return n[u].isInRange(c)})}})};function vDe(e){return(e%180+180)%180}var _De=function(t){var n=t.width,s=t.height,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,c=vDe(i),u=c*Math.PI/180,a=Math.atan(s/n),m=u>a&&u<Math.PI-a?s/Math.sin(u):n/Math.cos(u);return Math.abs(m)},bDe=ou,jDe=qb,wDe=Y2;function SDe(e){return function(t,n,s){var i=Object(t);if(!jDe(t)){var c=bDe(n);t=wDe(t),n=function(a){return c(i[a],a,i)}}var u=e(t,n,s);return u>-1?i[c?t[u]:u]:void 0}}var NDe=SDe,PDe=DK;function CDe(e){var t=PDe(e),n=t%1;return t===t?n?t-n:t:0}var ADe=CDe,kDe=O7,TDe=ou,EDe=ADe,MDe=Math.max;function ODe(e,t,n){var s=e==null?0:e.length;if(!s)return-1;var i=n==null?0:EDe(n);return i<0&&(i=MDe(s+i,0)),kDe(e,TDe(t),i)}var IDe=ODe,DDe=NDe,RDe=IDe,LDe=DDe(RDe),FDe=LDe;const zDe=Fn(FDe);var $De=Ppe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),wD=R.createContext(void 0),SD=R.createContext(void 0),GK=R.createContext(void 0),KK=R.createContext({}),HK=R.createContext(void 0),ZK=R.createContext(0),YK=R.createContext(0),s6=function(t){var n=t.state,s=n.xAxisMap,i=n.yAxisMap,c=n.offset,u=t.clipPathId,a=t.children,m=t.width,p=t.height,y=$De(c);return de.createElement(wD.Provider,{value:s},de.createElement(SD.Provider,{value:i},de.createElement(KK.Provider,{value:c},de.createElement(GK.Provider,{value:y},de.createElement(HK.Provider,{value:u},de.createElement(ZK.Provider,{value:p},de.createElement(YK.Provider,{value:m},a)))))))},BDe=function(){return R.useContext(HK)},XK=function(t){var n=R.useContext(wD);n==null&&Hm();var s=n[t];return s==null&&Hm(),s},qDe=function(){var t=R.useContext(wD);return ph(t)},VDe=function(){var t=R.useContext(SD),n=zDe(t,function(s){return zK(s.domain,Number.isFinite)});return n||ph(t)},QK=function(t){var n=R.useContext(SD);n==null&&Hm();var s=n[t];return s==null&&Hm(),s},UDe=function(){var t=R.useContext(GK);return t},WDe=function(){return R.useContext(KK)},ND=function(){return R.useContext(YK)},PD=function(){return R.useContext(ZK)};function ry(e){"@babel/helpers - typeof";return ry=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ry(e)}function GDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KDe(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,eH(s.key),s)}}function HDe(e,t,n){return t&&KDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZDe(e,t,n){return t=NN(t),YDe(e,JK()?Reflect.construct(t,n||[],NN(e).constructor):t.apply(e,n))}function YDe(e,t){if(t&&(ry(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XDe(e)}function XDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(JK=function(){return!!e})()}function NN(e){return NN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},NN(e)}function QDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lM(e,t)}function lM(e,t){return lM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},lM(e,t)}function i6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function a6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?i6(Object(n),!0).forEach(function(s){CD(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function CD(e,t,n){return t=eH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eH(e){var t=JDe(e,"string");return ry(t)=="symbol"?t:t+""}function JDe(e,t){if(ry(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(ry(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function eRe(e,t){return sRe(e)||nRe(e,t)||rRe(e,t)||tRe()}function tRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rRe(e,t){if(e){if(typeof e=="string")return o6(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o6(e,t)}}function o6(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function nRe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,c,u,a=[],m=!0,p=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(m=(s=c.call(n)).done)&&(a.push(s.value),a.length!==t);m=!0);}catch(y){p=!0,i=y}finally{try{if(!m&&n.return!=null&&(u=n.return(),Object(u)!==u))return}finally{if(p)throw i}}return a}}function sRe(e){if(Array.isArray(e))return e}function cM(){return cM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},cM.apply(this,arguments)}var iRe=function(t,n){var s;return de.isValidElement(t)?s=de.cloneElement(t,n):Br(t)?s=t(n):s=de.createElement("line",cM({},n,{className:"recharts-reference-line-line"})),s},aRe=function(t,n,s,i,c,u,a,m,p){var y=c.x,v=c.y,j=c.width,S=c.height;if(s){var k=p.y,N=t.y.apply(k,{position:u});if(Qc(p,"discard")&&!t.y.isInRange(N))return null;var D=[{x:y+j,y:N},{x:y,y:N}];return m==="left"?D.reverse():D}if(n){var O=p.x,T=t.x.apply(O,{position:u});if(Qc(p,"discard")&&!t.x.isInRange(T))return null;var I=[{x:T,y:v+S},{x:T,y:v}];return a==="top"?I.reverse():I}if(i){var z=p.segment,$=z.map(function(V){return t.apply(V,{position:u})});return Qc(p,"discard")&&TIe($,function(V){return!t.isInRange(V)})?null:$}return null};function oRe(e){var t=e.x,n=e.y,s=e.segment,i=e.xAxisId,c=e.yAxisId,u=e.shape,a=e.className,m=e.alwaysShow,p=BDe(),y=XK(i),v=QK(c),j=UDe();if(!p||!j)return null;pc(m===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var S=jD({x:y.scale,y:v.scale}),k=Ui(t),N=Ui(n),D=s&&s.length===2,O=aRe(S,k,N,D,j,e.position,y.orientation,v.orientation,e);if(!O)return null;var T=eRe(O,2),I=T[0],z=I.x,$=I.y,V=T[1],K=V.x,te=V.y,X=Qc(e,"hidden")?"url(#".concat(p,")"):void 0,ve=a6(a6({clipPath:X},Cr(e,!0)),{},{x1:z,y1:$,x2:K,y2:te});return de.createElement(xn,{className:Yr("recharts-reference-line",a)},iRe(u,ve),ra.renderCallByParent(e,yDe({x1:z,y1:$,x2:K,y2:te})))}var mP=function(e){function t(){return GDe(this,t),ZDe(this,t,arguments)}return QDe(t,e),HDe(t,[{key:"render",value:function(){return de.createElement(oRe,this.props)}}])}(de.Component);CD(mP,"displayName","ReferenceLine");CD(mP,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function uM(){return uM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},uM.apply(this,arguments)}function ny(e){"@babel/helpers - typeof";return ny=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ny(e)}function l6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function c6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?l6(Object(n),!0).forEach(function(s){pP(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function lRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cRe(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,rH(s.key),s)}}function uRe(e,t,n){return t&&cRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function dRe(e,t,n){return t=PN(t),hRe(e,tH()?Reflect.construct(t,n||[],PN(e).constructor):t.apply(e,n))}function hRe(e,t){if(t&&(ny(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fRe(e)}function fRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tH=function(){return!!e})()}function PN(e){return PN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},PN(e)}function mRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dM(e,t)}function dM(e,t){return dM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},dM(e,t)}function pP(e,t,n){return t=rH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rH(e){var t=pRe(e,"string");return ny(t)=="symbol"?t:t+""}function pRe(e,t){if(ny(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(ny(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var gRe=function(t){var n=t.x,s=t.y,i=t.xAxis,c=t.yAxis,u=jD({x:i.scale,y:c.scale}),a=u.apply({x:n,y:s},{bandAware:!0});return Qc(t,"discard")&&!u.isInRange(a)?null:a},gP=function(e){function t(){return lRe(this,t),dRe(this,t,arguments)}return mRe(t,e),uRe(t,[{key:"render",value:function(){var s=this.props,i=s.x,c=s.y,u=s.r,a=s.alwaysShow,m=s.clipPathId,p=Ui(i),y=Ui(c);if(pc(a===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!p||!y)return null;var v=gRe(this.props);if(!v)return null;var j=v.x,S=v.y,k=this.props,N=k.shape,D=k.className,O=Qc(this.props,"hidden")?"url(#".concat(m,")"):void 0,T=c6(c6({clipPath:O},Cr(this.props,!0)),{},{cx:j,cy:S});return de.createElement(xn,{className:Yr("recharts-reference-dot",D)},t.renderDot(N,T),ra.renderCallByParent(this.props,{x:j-u,y:S-u,width:2*u,height:2*u}))}}])}(de.Component);pP(gP,"displayName","ReferenceDot");pP(gP,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});pP(gP,"renderDot",function(e,t){var n;return de.isValidElement(e)?n=de.cloneElement(e,t):Br(e)?n=e(t):n=de.createElement(Wy,uM({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function hM(){return hM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},hM.apply(this,arguments)}function sy(e){"@babel/helpers - typeof";return sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sy(e)}function u6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function d6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?u6(Object(n),!0).forEach(function(s){xP(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function xRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yRe(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,sH(s.key),s)}}function vRe(e,t,n){return t&&yRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Re(e,t,n){return t=CN(t),bRe(e,nH()?Reflect.construct(t,n||[],CN(e).constructor):t.apply(e,n))}function bRe(e,t){if(t&&(sy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jRe(e)}function jRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nH=function(){return!!e})()}function CN(e){return CN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},CN(e)}function wRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fM(e,t)}function fM(e,t){return fM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},fM(e,t)}function xP(e,t,n){return t=sH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sH(e){var t=SRe(e,"string");return sy(t)=="symbol"?t:t+""}function SRe(e,t){if(sy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(sy(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var NRe=function(t,n,s,i,c){var u=c.x1,a=c.x2,m=c.y1,p=c.y2,y=c.xAxis,v=c.yAxis;if(!y||!v)return null;var j=jD({x:y.scale,y:v.scale}),S={x:t?j.x.apply(u,{position:"start"}):j.x.rangeMin,y:s?j.y.apply(m,{position:"start"}):j.y.rangeMin},k={x:n?j.x.apply(a,{position:"end"}):j.x.rangeMax,y:i?j.y.apply(p,{position:"end"}):j.y.rangeMax};return Qc(c,"discard")&&(!j.isInRange(S)||!j.isInRange(k))?null:UK(S,k)},yP=function(e){function t(){return xRe(this,t),_Re(this,t,arguments)}return wRe(t,e),vRe(t,[{key:"render",value:function(){var s=this.props,i=s.x1,c=s.x2,u=s.y1,a=s.y2,m=s.className,p=s.alwaysShow,y=s.clipPathId;pc(p===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var v=Ui(i),j=Ui(c),S=Ui(u),k=Ui(a),N=this.props.shape;if(!v&&!j&&!S&&!k&&!N)return null;var D=NRe(v,j,S,k,this.props);if(!D&&!N)return null;var O=Qc(this.props,"hidden")?"url(#".concat(y,")"):void 0;return de.createElement(xn,{className:Yr("recharts-reference-area",m)},t.renderRect(N,d6(d6({clipPath:O},Cr(this.props,!0)),D)),ra.renderCallByParent(this.props,D))}}])}(de.Component);xP(yP,"displayName","ReferenceArea");xP(yP,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});xP(yP,"renderRect",function(e,t){var n;return de.isValidElement(e)?n=de.cloneElement(e,t):Br(e)?n=e(t):n=de.createElement(_D,hM({},t,{className:"recharts-reference-area-rect"})),n});function iH(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var s=[],i=0;i<e.length;i+=t)s.push(e[i]);return s}function PRe(e,t,n){var s={width:e.width+t.width,height:e.height+t.height};return _De(s,n)}function CRe(e,t,n){var s=n==="width",i=e.x,c=e.y,u=e.width,a=e.height;return t===1?{start:s?i:c,end:s?i+u:c+a}:{start:s?i+u:c+a,end:s?i:c}}function AN(e,t,n,s,i){if(e*t<e*s||e*t>e*i)return!1;var c=n();return e*(t-e*c/2-s)>=0&&e*(t+e*c/2-i)<=0}function ARe(e,t){return iH(e,t+1)}function kRe(e,t,n,s,i){for(var c=(s||[]).slice(),u=t.start,a=t.end,m=0,p=1,y=u,v=function(){var k=s==null?void 0:s[m];if(k===void 0)return{v:iH(s,p)};var N=m,D,O=function(){return D===void 0&&(D=n(k,N)),D},T=k.coordinate,I=m===0||AN(e,T,O,y,a);I||(m=0,y=u,p+=1),I&&(y=T+e*(O()/2+i),m+=p)},j;p<=c.length;)if(j=v(),j)return j.v;return[]}function yb(e){"@babel/helpers - typeof";return yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yb(e)}function h6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Ea(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?h6(Object(n),!0).forEach(function(s){TRe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function TRe(e,t,n){return t=ERe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ERe(e){var t=MRe(e,"string");return yb(t)=="symbol"?t:t+""}function MRe(e,t){if(yb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(yb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ORe(e,t,n,s,i){for(var c=(s||[]).slice(),u=c.length,a=t.start,m=t.end,p=function(j){var S=c[j],k,N=function(){return k===void 0&&(k=n(S,j)),k};if(j===u-1){var D=e*(S.coordinate+e*N()/2-m);c[j]=S=Ea(Ea({},S),{},{tickCoord:D>0?S.coordinate-D*e:S.coordinate})}else c[j]=S=Ea(Ea({},S),{},{tickCoord:S.coordinate});var O=AN(e,S.tickCoord,N,a,m);O&&(m=S.tickCoord-e*(N()/2+i),c[j]=Ea(Ea({},S),{},{isShow:!0}))},y=u-1;y>=0;y--)p(y);return c}function IRe(e,t,n,s,i,c){var u=(s||[]).slice(),a=u.length,m=t.start,p=t.end;if(c){var y=s[a-1],v=n(y,a-1),j=e*(y.coordinate+e*v/2-p);u[a-1]=y=Ea(Ea({},y),{},{tickCoord:j>0?y.coordinate-j*e:y.coordinate});var S=AN(e,y.tickCoord,function(){return v},m,p);S&&(p=y.tickCoord-e*(v/2+i),u[a-1]=Ea(Ea({},y),{},{isShow:!0}))}for(var k=c?a-1:a,N=function(T){var I=u[T],z,$=function(){return z===void 0&&(z=n(I,T)),z};if(T===0){var V=e*(I.coordinate-e*$()/2-m);u[T]=I=Ea(Ea({},I),{},{tickCoord:V<0?I.coordinate-V*e:I.coordinate})}else u[T]=I=Ea(Ea({},I),{},{tickCoord:I.coordinate});var K=AN(e,I.tickCoord,$,m,p);K&&(m=I.tickCoord+e*($()/2+i),u[T]=Ea(Ea({},I),{},{isShow:!0}))},D=0;D<k;D++)N(D);return u}function AD(e,t,n){var s=e.tick,i=e.ticks,c=e.viewBox,u=e.minTickGap,a=e.orientation,m=e.interval,p=e.tickFormatter,y=e.unit,v=e.angle;if(!i||!i.length||!s)return[];if(Ut(m)||Sd.isSsr)return ARe(i,typeof m=="number"&&Ut(m)?m:0);var j=[],S=a==="top"||a==="bottom"?"width":"height",k=y&&S==="width"?e0(y,{fontSize:t,letterSpacing:n}):{width:0,height:0},N=function(I,z){var $=Br(p)?p(I.value,z):I.value;return S==="width"?PRe(e0($,{fontSize:t,letterSpacing:n}),k,v):e0($,{fontSize:t,letterSpacing:n})[S]},D=i.length>=2?Ya(i[1].coordinate-i[0].coordinate):1,O=CRe(c,D,S);return m==="equidistantPreserveStart"?kRe(D,O,N,i,u):(m==="preserveStart"||m==="preserveStartEnd"?j=IRe(D,O,N,i,u,m==="preserveStartEnd"):j=ORe(D,O,N,i,u),j.filter(function(T){return T.isShow}))}var DRe=["viewBox"],RRe=["viewBox"],LRe=["ticks"];function iy(e){"@babel/helpers - typeof";return iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iy(e)}function zg(){return zg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},zg.apply(this,arguments)}function f6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Ua(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?f6(Object(n),!0).forEach(function(s){kD(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function rk(e,t){if(e==null)return{};var n=FRe(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function FRe(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function zRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m6(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,oH(s.key),s)}}function $Re(e,t,n){return t&&m6(e.prototype,t),n&&m6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function BRe(e,t,n){return t=kN(t),qRe(e,aH()?Reflect.construct(t,n||[],kN(e).constructor):t.apply(e,n))}function qRe(e,t){if(t&&(iy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VRe(e)}function VRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aH=function(){return!!e})()}function kN(e){return kN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},kN(e)}function URe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mM(e,t)}function mM(e,t){return mM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},mM(e,t)}function kD(e,t,n){return t=oH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oH(e){var t=WRe(e,"string");return iy(t)=="symbol"?t:t+""}function WRe(e,t){if(iy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(iy(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Hy=function(e){function t(n){var s;return zRe(this,t),s=BRe(this,t,[n]),s.state={fontSize:"",letterSpacing:""},s}return URe(t,e),$Re(t,[{key:"shouldComponentUpdate",value:function(s,i){var c=s.viewBox,u=rk(s,DRe),a=this.props,m=a.viewBox,p=rk(a,RRe);return!ex(c,m)||!ex(u,p)||!ex(i,this.state)}},{key:"componentDidMount",value:function(){var s=this.layerReference;if(s){var i=s.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];i&&this.setState({fontSize:window.getComputedStyle(i).fontSize,letterSpacing:window.getComputedStyle(i).letterSpacing})}}},{key:"getTickLineCoord",value:function(s){var i=this.props,c=i.x,u=i.y,a=i.width,m=i.height,p=i.orientation,y=i.tickSize,v=i.mirror,j=i.tickMargin,S,k,N,D,O,T,I=v?-1:1,z=s.tickSize||y,$=Ut(s.tickCoord)?s.tickCoord:s.coordinate;switch(p){case"top":S=k=s.coordinate,D=u+ +!v*m,N=D-I*z,T=N-I*j,O=$;break;case"left":N=D=s.coordinate,k=c+ +!v*a,S=k-I*z,O=S-I*j,T=$;break;case"right":N=D=s.coordinate,k=c+ +v*a,S=k+I*z,O=S+I*j,T=$;break;default:S=k=s.coordinate,D=u+ +v*m,N=D+I*z,T=N+I*j,O=$;break}return{line:{x1:S,y1:N,x2:k,y2:D},tick:{x:O,y:T}}}},{key:"getTickTextAnchor",value:function(){var s=this.props,i=s.orientation,c=s.mirror,u;switch(i){case"left":u=c?"start":"end";break;case"right":u=c?"end":"start";break;default:u="middle";break}return u}},{key:"getTickVerticalAnchor",value:function(){var s=this.props,i=s.orientation,c=s.mirror,u="end";switch(i){case"left":case"right":u="middle";break;case"top":u=c?"start":"end";break;default:u=c?"end":"start";break}return u}},{key:"renderAxisLine",value:function(){var s=this.props,i=s.x,c=s.y,u=s.width,a=s.height,m=s.orientation,p=s.mirror,y=s.axisLine,v=Ua(Ua(Ua({},Cr(this.props,!1)),Cr(y,!1)),{},{fill:"none"});if(m==="top"||m==="bottom"){var j=+(m==="top"&&!p||m==="bottom"&&p);v=Ua(Ua({},v),{},{x1:i,y1:c+j*a,x2:i+u,y2:c+j*a})}else{var S=+(m==="left"&&!p||m==="right"&&p);v=Ua(Ua({},v),{},{x1:i+S*u,y1:c,x2:i+S*u,y2:c+a})}return de.createElement("line",zg({},v,{className:Yr("recharts-cartesian-axis-line",Zo(y,"className"))}))}},{key:"renderTicks",value:function(s,i,c){var u=this,a=this.props,m=a.tickLine,p=a.stroke,y=a.tick,v=a.tickFormatter,j=a.unit,S=AD(Ua(Ua({},this.props),{},{ticks:s}),i,c),k=this.getTickTextAnchor(),N=this.getTickVerticalAnchor(),D=Cr(this.props,!1),O=Cr(y,!1),T=Ua(Ua({},D),{},{fill:"none"},Cr(m,!1)),I=S.map(function(z,$){var V=u.getTickLineCoord(z),K=V.line,te=V.tick,X=Ua(Ua(Ua(Ua({textAnchor:k,verticalAnchor:N},D),{},{stroke:"none",fill:p},O),te),{},{index:$,payload:z,visibleTicksCount:S.length,tickFormatter:v});return de.createElement(xn,zg({className:"recharts-cartesian-axis-tick",key:"tick-".concat(z.value,"-").concat(z.coordinate,"-").concat(z.tickCoord)},Wm(u.props,z,$)),m&&de.createElement("line",zg({},T,K,{className:Yr("recharts-cartesian-axis-tick-line",Zo(m,"className"))})),y&&t.renderTickItem(y,X,"".concat(Br(v)?v(z.value,$):z.value).concat(j||"")))});return de.createElement("g",{className:"recharts-cartesian-axis-ticks"},I)}},{key:"render",value:function(){var s=this,i=this.props,c=i.axisLine,u=i.width,a=i.height,m=i.ticksGenerator,p=i.className,y=i.hide;if(y)return null;var v=this.props,j=v.ticks,S=rk(v,LRe),k=j;return Br(m)&&(k=j&&j.length>0?m(this.props):m(S)),u<=0||a<=0||!k||!k.length?null:de.createElement(xn,{className:Yr("recharts-cartesian-axis",p),ref:function(D){s.layerReference=D}},c&&this.renderAxisLine(),this.renderTicks(k,this.state.fontSize,this.state.letterSpacing),ra.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(s,i,c){var u;return de.isValidElement(s)?u=de.cloneElement(s,i):Br(s)?u=s(i):u=de.createElement(Gm,zg({},i,{className:"recharts-cartesian-axis-tick-value"}),c),u}}])}(R.Component);kD(Hy,"displayName","CartesianAxis");kD(Hy,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var GRe=["x1","y1","x2","y2","key"],KRe=["offset"];function Zm(e){"@babel/helpers - typeof";return Zm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zm(e)}function p6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Oa(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?p6(Object(n),!0).forEach(function(s){HRe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function HRe(e,t,n){return t=ZRe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ZRe(e){var t=YRe(e,"string");return Zm(t)=="symbol"?t:t+""}function YRe(e,t){if(Zm(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(Zm(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gm(){return gm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},gm.apply(this,arguments)}function g6(e,t){if(e==null)return{};var n=XRe(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function XRe(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}var QRe=function(t){var n=t.fill;if(!n||n==="none")return null;var s=t.fillOpacity,i=t.x,c=t.y,u=t.width,a=t.height,m=t.ry;return de.createElement("rect",{x:i,y:c,ry:m,width:u,height:a,stroke:"none",fill:n,fillOpacity:s,className:"recharts-cartesian-grid-bg"})};function lH(e,t){var n;if(de.isValidElement(e))n=de.cloneElement(e,t);else if(Br(e))n=e(t);else{var s=t.x1,i=t.y1,c=t.x2,u=t.y2,a=t.key,m=g6(t,GRe),p=Cr(m,!1);p.offset;var y=g6(p,KRe);n=de.createElement("line",gm({},y,{x1:s,y1:i,x2:c,y2:u,fill:"none",key:a}))}return n}function JRe(e){var t=e.x,n=e.width,s=e.horizontal,i=s===void 0?!0:s,c=e.horizontalPoints;if(!i||!c||!c.length)return null;var u=c.map(function(a,m){var p=Oa(Oa({},e),{},{x1:t,y1:a,x2:t+n,y2:a,key:"line-".concat(m),index:m});return lH(i,p)});return de.createElement("g",{className:"recharts-cartesian-grid-horizontal"},u)}function e4e(e){var t=e.y,n=e.height,s=e.vertical,i=s===void 0?!0:s,c=e.verticalPoints;if(!i||!c||!c.length)return null;var u=c.map(function(a,m){var p=Oa(Oa({},e),{},{x1:a,y1:t,x2:a,y2:t+n,key:"line-".concat(m),index:m});return lH(i,p)});return de.createElement("g",{className:"recharts-cartesian-grid-vertical"},u)}function t4e(e){var t=e.horizontalFill,n=e.fillOpacity,s=e.x,i=e.y,c=e.width,u=e.height,a=e.horizontalPoints,m=e.horizontal,p=m===void 0?!0:m;if(!p||!t||!t.length)return null;var y=a.map(function(j){return Math.round(j+i-i)}).sort(function(j,S){return j-S});i!==y[0]&&y.unshift(0);var v=y.map(function(j,S){var k=!y[S+1],N=k?i+u-j:y[S+1]-j;if(N<=0)return null;var D=S%t.length;return de.createElement("rect",{key:"react-".concat(S),y:j,x:s,height:N,width:c,stroke:"none",fill:t[D],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return de.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},v)}function r4e(e){var t=e.vertical,n=t===void 0?!0:t,s=e.verticalFill,i=e.fillOpacity,c=e.x,u=e.y,a=e.width,m=e.height,p=e.verticalPoints;if(!n||!s||!s.length)return null;var y=p.map(function(j){return Math.round(j+c-c)}).sort(function(j,S){return j-S});c!==y[0]&&y.unshift(0);var v=y.map(function(j,S){var k=!y[S+1],N=k?c+a-j:y[S+1]-j;if(N<=0)return null;var D=S%s.length;return de.createElement("rect",{key:"react-".concat(S),x:j,y:u,width:N,height:m,stroke:"none",fill:s[D],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return de.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},v)}var n4e=function(t,n){var s=t.xAxis,i=t.width,c=t.height,u=t.offset;return QG(AD(Oa(Oa(Oa({},Hy.defaultProps),s),{},{ticks:Zu(s,!0),viewBox:{x:0,y:0,width:i,height:c}})),u.left,u.left+u.width,n)},s4e=function(t,n){var s=t.yAxis,i=t.width,c=t.height,u=t.offset;return QG(AD(Oa(Oa(Oa({},Hy.defaultProps),s),{},{ticks:Zu(s,!0),viewBox:{x:0,y:0,width:i,height:c}})),u.top,u.top+u.height,n)},vg={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function wo(e){var t,n,s,i,c,u,a=ND(),m=PD(),p=WDe(),y=Oa(Oa({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:vg.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:vg.fill,horizontal:(s=e.horizontal)!==null&&s!==void 0?s:vg.horizontal,horizontalFill:(i=e.horizontalFill)!==null&&i!==void 0?i:vg.horizontalFill,vertical:(c=e.vertical)!==null&&c!==void 0?c:vg.vertical,verticalFill:(u=e.verticalFill)!==null&&u!==void 0?u:vg.verticalFill,x:Ut(e.x)?e.x:p.left,y:Ut(e.y)?e.y:p.top,width:Ut(e.width)?e.width:p.width,height:Ut(e.height)?e.height:p.height}),v=y.x,j=y.y,S=y.width,k=y.height,N=y.syncWithTicks,D=y.horizontalValues,O=y.verticalValues,T=qDe(),I=VDe();if(!Ut(S)||S<=0||!Ut(k)||k<=0||!Ut(v)||v!==+v||!Ut(j)||j!==+j)return null;var z=y.verticalCoordinatesGenerator||n4e,$=y.horizontalCoordinatesGenerator||s4e,V=y.horizontalPoints,K=y.verticalPoints;if((!V||!V.length)&&Br($)){var te=D&&D.length,X=$({yAxis:I?Oa(Oa({},I),{},{ticks:te?D:I.ticks}):void 0,width:a,height:m,offset:p},te?!0:N);pc(Array.isArray(X),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Zm(X),"]")),Array.isArray(X)&&(V=X)}if((!K||!K.length)&&Br(z)){var ve=O&&O.length,ae=z({xAxis:T?Oa(Oa({},T),{},{ticks:ve?O:T.ticks}):void 0,width:a,height:m,offset:p},ve?!0:N);pc(Array.isArray(ae),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Zm(ae),"]")),Array.isArray(ae)&&(K=ae)}return de.createElement("g",{className:"recharts-cartesian-grid"},de.createElement(QRe,{fill:y.fill,fillOpacity:y.fillOpacity,x:y.x,y:y.y,width:y.width,height:y.height,ry:y.ry}),de.createElement(JRe,gm({},y,{offset:p,horizontalPoints:V,xAxis:T,yAxis:I})),de.createElement(e4e,gm({},y,{offset:p,verticalPoints:K,xAxis:T,yAxis:I})),de.createElement(t4e,gm({},y,{horizontalPoints:V})),de.createElement(r4e,gm({},y,{verticalPoints:K})))}wo.displayName="CartesianGrid";var i4e=["type","layout","connectNulls","ref"],a4e=["key"];function ay(e){"@babel/helpers - typeof";return ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ay(e)}function x6(e,t){if(e==null)return{};var n=o4e(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function o4e(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function a0(){return a0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},a0.apply(this,arguments)}function y6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Do(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?y6(Object(n),!0).forEach(function(s){nc(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function _g(e){return d4e(e)||u4e(e)||c4e(e)||l4e()}function l4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c4e(e,t){if(e){if(typeof e=="string")return pM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pM(e,t)}}function u4e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function d4e(e){if(Array.isArray(e))return pM(e)}function pM(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function h4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v6(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,uH(s.key),s)}}function f4e(e,t,n){return t&&v6(e.prototype,t),n&&v6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function m4e(e,t,n){return t=TN(t),p4e(e,cH()?Reflect.construct(t,n||[],TN(e).constructor):t.apply(e,n))}function p4e(e,t){if(t&&(ay(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g4e(e)}function g4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cH=function(){return!!e})()}function TN(e){return TN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},TN(e)}function x4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gM(e,t)}function gM(e,t){return gM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},gM(e,t)}function nc(e,t,n){return t=uH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uH(e){var t=y4e(e,"string");return ay(t)=="symbol"?t:t+""}function y4e(e,t){if(ay(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(ay(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Xo=function(e){function t(){var n;h4e(this,t);for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];return n=m4e(this,t,[].concat(i)),nc(n,"state",{isAnimationFinished:!0,totalLength:0}),nc(n,"generateSimpleStrokeDasharray",function(u,a){return"".concat(a,"px ").concat(u-a,"px")}),nc(n,"getStrokeDasharray",function(u,a,m){var p=m.reduce(function(O,T){return O+T});if(!p)return n.generateSimpleStrokeDasharray(a,u);for(var y=Math.floor(u/p),v=u%p,j=a-u,S=[],k=0,N=0;k<m.length;N+=m[k],++k)if(N+m[k]>v){S=[].concat(_g(m.slice(0,k)),[v-N]);break}var D=S.length%2===0?[0,j]:[j];return[].concat(_g(t.repeat(m,y)),_g(S),D).map(function(O){return"".concat(O,"px")}).join(", ")}),nc(n,"id",tp("recharts-line-")),nc(n,"pathRef",function(u){n.mainCurve=u}),nc(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),nc(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return x4e(t,e),f4e(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var s=this.getTotalLength();this.setState({totalLength:s})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var s=this.getTotalLength();s!==this.state.totalLength&&this.setState({totalLength:s})}}},{key:"getTotalLength",value:function(){var s=this.mainCurve;try{return s&&s.getTotalLength&&s.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(s,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var c=this.props,u=c.points,a=c.xAxis,m=c.yAxis,p=c.layout,y=c.children,v=Yo(y,Kb);if(!v)return null;var j=function(N,D){return{x:N.x,y:N.y,value:N.value,errorVal:Ys(N.payload,D)}},S={clipPath:s?"url(#clipPath-".concat(i,")"):null};return de.createElement(xn,S,v.map(function(k){return de.cloneElement(k,{key:"bar-".concat(k.props.dataKey),data:u,xAxis:a,yAxis:m,layout:p,dataPointFormatter:j})}))}},{key:"renderDots",value:function(s,i,c){var u=this.props.isAnimationActive;if(u&&!this.state.isAnimationFinished)return null;var a=this.props,m=a.dot,p=a.points,y=a.dataKey,v=Cr(this.props,!1),j=Cr(m,!0),S=p.map(function(N,D){var O=Do(Do(Do({key:"dot-".concat(D),r:3},v),j),{},{value:N.value,dataKey:y,cx:N.x,cy:N.y,index:D,payload:N.payload});return t.renderDotItem(m,O)}),k={clipPath:s?"url(#clipPath-".concat(i?"":"dots-").concat(c,")"):null};return de.createElement(xn,a0({className:"recharts-line-dots",key:"dots"},k),S)}},{key:"renderCurveStatically",value:function(s,i,c,u){var a=this.props,m=a.type,p=a.layout,y=a.connectNulls;a.ref;var v=x6(a,i4e),j=Do(Do(Do({},Cr(v,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(c,")"):null,points:s},u),{},{type:m,layout:p,connectNulls:y});return de.createElement(km,a0({},j,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(s,i){var c=this,u=this.props,a=u.points,m=u.strokeDasharray,p=u.isAnimationActive,y=u.animationBegin,v=u.animationDuration,j=u.animationEasing,S=u.animationId,k=u.animateNewValues,N=u.width,D=u.height,O=this.state,T=O.prevPoints,I=O.totalLength;return de.createElement(Al,{begin:y,duration:v,isActive:p,easing:j,from:{t:0},to:{t:1},key:"line-".concat(S),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(z){var $=z.t;if(T){var V=T.length/a.length,K=a.map(function(pe,Oe){var Me=Math.floor(Oe*V);if(T[Me]){var Xe=T[Me],Ve=Zs(Xe.x,pe.x),et=Zs(Xe.y,pe.y);return Do(Do({},pe),{},{x:Ve($),y:et($)})}if(k){var Ce=Zs(N*2,pe.x),_e=Zs(D/2,pe.y);return Do(Do({},pe),{},{x:Ce($),y:_e($)})}return Do(Do({},pe),{},{x:pe.x,y:pe.y})});return c.renderCurveStatically(K,s,i)}var te=Zs(0,I),X=te($),ve;if(m){var ae="".concat(m).split(/[,\s]+/gim).map(function(pe){return parseFloat(pe)});ve=c.getStrokeDasharray(X,I,ae)}else ve=c.generateSimpleStrokeDasharray(I,X);return c.renderCurveStatically(a,s,i,{strokeDasharray:ve})})}},{key:"renderCurve",value:function(s,i){var c=this.props,u=c.points,a=c.isAnimationActive,m=this.state,p=m.prevPoints,y=m.totalLength;return a&&u&&u.length&&(!p&&y>0||!rf(p,u))?this.renderCurveWithAnimation(s,i):this.renderCurveStatically(u,s,i)}},{key:"render",value:function(){var s,i=this.props,c=i.hide,u=i.dot,a=i.points,m=i.className,p=i.xAxis,y=i.yAxis,v=i.top,j=i.left,S=i.width,k=i.height,N=i.isAnimationActive,D=i.id;if(c||!a||!a.length)return null;var O=this.state.isAnimationFinished,T=a.length===1,I=Yr("recharts-line",m),z=p&&p.allowDataOverflow,$=y&&y.allowDataOverflow,V=z||$,K=Zr(D)?this.id:D,te=(s=Cr(u,!1))!==null&&s!==void 0?s:{r:3,strokeWidth:2},X=te.r,ve=X===void 0?3:X,ae=te.strokeWidth,pe=ae===void 0?2:ae,Oe=UW(u)?u:{},Me=Oe.clipDot,Xe=Me===void 0?!0:Me,Ve=ve*2+pe;return de.createElement(xn,{className:I},z||$?de.createElement("defs",null,de.createElement("clipPath",{id:"clipPath-".concat(K)},de.createElement("rect",{x:z?j:j-S/2,y:$?v:v-k/2,width:z?S:S*2,height:$?k:k*2})),!Xe&&de.createElement("clipPath",{id:"clipPath-dots-".concat(K)},de.createElement("rect",{x:j-Ve/2,y:v-Ve/2,width:S+Ve,height:k+Ve}))):null,!T&&this.renderCurve(V,K),this.renderErrorBar(V,K),(T||u)&&this.renderDots(V,Xe,K),(!N||O)&&gc.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(s,i){return s.animationId!==i.prevAnimationId?{prevAnimationId:s.animationId,curPoints:s.points,prevPoints:i.curPoints}:s.points!==i.curPoints?{curPoints:s.points}:null}},{key:"repeat",value:function(s,i){for(var c=s.length%2!==0?[].concat(_g(s),[0]):s,u=[],a=0;a<i;++a)u=[].concat(_g(u),_g(c));return u}},{key:"renderDotItem",value:function(s,i){var c;if(de.isValidElement(s))c=de.cloneElement(s,i);else if(Br(s))c=s(i);else{var u=i.key,a=x6(i,a4e),m=Yr("recharts-line-dot",typeof s!="boolean"?s.className:"");c=de.createElement(Wy,a0({key:u},a,{className:m}))}return c}}])}(R.PureComponent);nc(Xo,"displayName","Line");nc(Xo,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Sd.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});nc(Xo,"getComposedData",function(e){var t=e.props,n=e.xAxis,s=e.yAxis,i=e.xAxisTicks,c=e.yAxisTicks,u=e.dataKey,a=e.bandSize,m=e.displayedData,p=e.offset,y=t.layout,v=m.map(function(j,S){var k=Ys(j,u);return y==="horizontal"?{x:iN({axis:n,ticks:i,bandSize:a,entry:j,index:S}),y:Zr(k)?null:s.scale(k),value:k,payload:j}:{x:Zr(k)?null:n.scale(k),y:iN({axis:s,ticks:c,bandSize:a,entry:j,index:S}),value:k,payload:j}});return Do({points:v,layout:y},p)});var v4e=["layout","type","stroke","connectNulls","isRange","ref"],_4e=["key"],dH;function oy(e){"@babel/helpers - typeof";return oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oy(e)}function hH(e,t){if(e==null)return{};var n=b4e(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function b4e(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function xm(){return xm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},xm.apply(this,arguments)}function _6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function lh(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_6(Object(n),!0).forEach(function(s){Vc(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function j4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b6(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,mH(s.key),s)}}function w4e(e,t,n){return t&&b6(e.prototype,t),n&&b6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function S4e(e,t,n){return t=EN(t),N4e(e,fH()?Reflect.construct(t,n||[],EN(e).constructor):t.apply(e,n))}function N4e(e,t){if(t&&(oy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P4e(e)}function P4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fH=function(){return!!e})()}function EN(e){return EN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},EN(e)}function C4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xM(e,t)}function xM(e,t){return xM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},xM(e,t)}function Vc(e,t,n){return t=mH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mH(e){var t=A4e(e,"string");return oy(t)=="symbol"?t:t+""}function A4e(e,t){if(oy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(oy(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ru=function(e){function t(){var n;j4e(this,t);for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];return n=S4e(this,t,[].concat(i)),Vc(n,"state",{isAnimationFinished:!0}),Vc(n,"id",tp("recharts-area-")),Vc(n,"handleAnimationEnd",function(){var u=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Br(u)&&u()}),Vc(n,"handleAnimationStart",function(){var u=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Br(u)&&u()}),n}return C4e(t,e),w4e(t,[{key:"renderDots",value:function(s,i,c){var u=this.props.isAnimationActive,a=this.state.isAnimationFinished;if(u&&!a)return null;var m=this.props,p=m.dot,y=m.points,v=m.dataKey,j=Cr(this.props,!1),S=Cr(p,!0),k=y.map(function(D,O){var T=lh(lh(lh({key:"dot-".concat(O),r:3},j),S),{},{index:O,cx:D.x,cy:D.y,dataKey:v,value:D.value,payload:D.payload,points:y});return t.renderDotItem(p,T)}),N={clipPath:s?"url(#clipPath-".concat(i?"":"dots-").concat(c,")"):null};return de.createElement(xn,xm({className:"recharts-area-dots"},N),k)}},{key:"renderHorizontalRect",value:function(s){var i=this.props,c=i.baseLine,u=i.points,a=i.strokeWidth,m=u[0].x,p=u[u.length-1].x,y=s*Math.abs(m-p),v=Th(u.map(function(j){return j.y||0}));return Ut(c)&&typeof c=="number"?v=Math.max(c,v):c&&Array.isArray(c)&&c.length&&(v=Math.max(Th(c.map(function(j){return j.y||0})),v)),Ut(v)?de.createElement("rect",{x:m<p?m:m-y,y:0,width:y,height:Math.floor(v+(a?parseInt("".concat(a),10):1))}):null}},{key:"renderVerticalRect",value:function(s){var i=this.props,c=i.baseLine,u=i.points,a=i.strokeWidth,m=u[0].y,p=u[u.length-1].y,y=s*Math.abs(m-p),v=Th(u.map(function(j){return j.x||0}));return Ut(c)&&typeof c=="number"?v=Math.max(c,v):c&&Array.isArray(c)&&c.length&&(v=Math.max(Th(c.map(function(j){return j.x||0})),v)),Ut(v)?de.createElement("rect",{x:0,y:m<p?m:m-y,width:v+(a?parseInt("".concat(a),10):1),height:Math.floor(y)}):null}},{key:"renderClipRect",value:function(s){var i=this.props.layout;return i==="vertical"?this.renderVerticalRect(s):this.renderHorizontalRect(s)}},{key:"renderAreaStatically",value:function(s,i,c,u){var a=this.props,m=a.layout,p=a.type,y=a.stroke,v=a.connectNulls,j=a.isRange;a.ref;var S=hH(a,v4e);return de.createElement(xn,{clipPath:c?"url(#clipPath-".concat(u,")"):null},de.createElement(km,xm({},Cr(S,!0),{points:s,connectNulls:v,type:p,baseLine:i,layout:m,stroke:"none",className:"recharts-area-area"})),y!=="none"&&de.createElement(km,xm({},Cr(this.props,!1),{className:"recharts-area-curve",layout:m,type:p,connectNulls:v,fill:"none",points:s})),y!=="none"&&j&&de.createElement(km,xm({},Cr(this.props,!1),{className:"recharts-area-curve",layout:m,type:p,connectNulls:v,fill:"none",points:i})))}},{key:"renderAreaWithAnimation",value:function(s,i){var c=this,u=this.props,a=u.points,m=u.baseLine,p=u.isAnimationActive,y=u.animationBegin,v=u.animationDuration,j=u.animationEasing,S=u.animationId,k=this.state,N=k.prevPoints,D=k.prevBaseLine;return de.createElement(Al,{begin:y,duration:v,isActive:p,easing:j,from:{t:0},to:{t:1},key:"area-".concat(S),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(O){var T=O.t;if(N){var I=N.length/a.length,z=a.map(function(te,X){var ve=Math.floor(X*I);if(N[ve]){var ae=N[ve],pe=Zs(ae.x,te.x),Oe=Zs(ae.y,te.y);return lh(lh({},te),{},{x:pe(T),y:Oe(T)})}return te}),$;if(Ut(m)&&typeof m=="number"){var V=Zs(D,m);$=V(T)}else if(Zr(m)||Ly(m)){var K=Zs(D,0);$=K(T)}else $=m.map(function(te,X){var ve=Math.floor(X*I);if(D[ve]){var ae=D[ve],pe=Zs(ae.x,te.x),Oe=Zs(ae.y,te.y);return lh(lh({},te),{},{x:pe(T),y:Oe(T)})}return te});return c.renderAreaStatically(z,$,s,i)}return de.createElement(xn,null,de.createElement("defs",null,de.createElement("clipPath",{id:"animationClipPath-".concat(i)},c.renderClipRect(T))),de.createElement(xn,{clipPath:"url(#animationClipPath-".concat(i,")")},c.renderAreaStatically(a,m,s,i)))})}},{key:"renderArea",value:function(s,i){var c=this.props,u=c.points,a=c.baseLine,m=c.isAnimationActive,p=this.state,y=p.prevPoints,v=p.prevBaseLine,j=p.totalLength;return m&&u&&u.length&&(!y&&j>0||!rf(y,u)||!rf(v,a))?this.renderAreaWithAnimation(s,i):this.renderAreaStatically(u,a,s,i)}},{key:"render",value:function(){var s,i=this.props,c=i.hide,u=i.dot,a=i.points,m=i.className,p=i.top,y=i.left,v=i.xAxis,j=i.yAxis,S=i.width,k=i.height,N=i.isAnimationActive,D=i.id;if(c||!a||!a.length)return null;var O=this.state.isAnimationFinished,T=a.length===1,I=Yr("recharts-area",m),z=v&&v.allowDataOverflow,$=j&&j.allowDataOverflow,V=z||$,K=Zr(D)?this.id:D,te=(s=Cr(u,!1))!==null&&s!==void 0?s:{r:3,strokeWidth:2},X=te.r,ve=X===void 0?3:X,ae=te.strokeWidth,pe=ae===void 0?2:ae,Oe=UW(u)?u:{},Me=Oe.clipDot,Xe=Me===void 0?!0:Me,Ve=ve*2+pe;return de.createElement(xn,{className:I},z||$?de.createElement("defs",null,de.createElement("clipPath",{id:"clipPath-".concat(K)},de.createElement("rect",{x:z?y:y-S/2,y:$?p:p-k/2,width:z?S:S*2,height:$?k:k*2})),!Xe&&de.createElement("clipPath",{id:"clipPath-dots-".concat(K)},de.createElement("rect",{x:y-Ve/2,y:p-Ve/2,width:S+Ve,height:k+Ve}))):null,T?null:this.renderArea(V,K),(u||T)&&this.renderDots(V,Xe,K),(!N||O)&&gc.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(s,i){return s.animationId!==i.prevAnimationId?{prevAnimationId:s.animationId,curPoints:s.points,curBaseLine:s.baseLine,prevPoints:i.curPoints,prevBaseLine:i.curBaseLine}:s.points!==i.curPoints||s.baseLine!==i.curBaseLine?{curPoints:s.points,curBaseLine:s.baseLine}:null}}])}(R.PureComponent);dH=ru;Vc(ru,"displayName","Area");Vc(ru,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Sd.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Vc(ru,"getBaseValue",function(e,t,n,s){var i=e.layout,c=e.baseValue,u=t.props.baseValue,a=u??c;if(Ut(a)&&typeof a=="number")return a;var m=i==="horizontal"?s:n,p=m.scale.domain();if(m.type==="number"){var y=Math.max(p[0],p[1]),v=Math.min(p[0],p[1]);return a==="dataMin"?v:a==="dataMax"||y<0?y:Math.max(Math.min(p[0],p[1]),0)}return a==="dataMin"?p[0]:a==="dataMax"?p[1]:p[0]});Vc(ru,"getComposedData",function(e){var t=e.props,n=e.item,s=e.xAxis,i=e.yAxis,c=e.xAxisTicks,u=e.yAxisTicks,a=e.bandSize,m=e.dataKey,p=e.stackedData,y=e.dataStartIndex,v=e.displayedData,j=e.offset,S=t.layout,k=p&&p.length,N=dH.getBaseValue(t,n,s,i),D=S==="horizontal",O=!1,T=v.map(function(z,$){var V;k?V=p[y+$]:(V=Ys(z,m),Array.isArray(V)?O=!0:V=[N,V]);var K=V[1]==null||k&&Ys(z,m)==null;return D?{x:iN({axis:s,ticks:c,bandSize:a,entry:z,index:$}),y:K?null:i.scale(V[1]),value:V,payload:z}:{x:K?null:s.scale(V[1]),y:iN({axis:i,ticks:u,bandSize:a,entry:z,index:$}),value:V,payload:z}}),I;return k||O?I=T.map(function(z){var $=Array.isArray(z.value)?z.value[0]:null;return D?{x:z.x,y:$!=null&&z.y!=null?i.scale($):null}:{x:$!=null?s.scale($):null,y:z.y}}):I=D?i.scale(N):s.scale(N),lh({points:T,baseLine:I,layout:S,isRange:O},j)});Vc(ru,"renderDotItem",function(e,t){var n;if(de.isValidElement(e))n=de.cloneElement(e,t);else if(Br(e))n=e(t);else{var s=Yr("recharts-area-dot",typeof e!="boolean"?e.className:""),i=t.key,c=hH(t,_4e);n=de.createElement(Wy,xm({},c,{key:i,className:s}))}return n});function ly(e){"@babel/helpers - typeof";return ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ly(e)}function k4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T4e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,xH(s.key),s)}}function E4e(e,t,n){return t&&T4e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function M4e(e,t,n){return t=MN(t),O4e(e,pH()?Reflect.construct(t,n||[],MN(e).constructor):t.apply(e,n))}function O4e(e,t){if(t&&(ly(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return I4e(e)}function I4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pH=function(){return!!e})()}function MN(e){return MN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},MN(e)}function D4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yM(e,t)}function yM(e,t){return yM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},yM(e,t)}function gH(e,t,n){return t=xH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xH(e){var t=R4e(e,"string");return ly(t)=="symbol"?t:t+""}function R4e(e,t){if(ly(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(ly(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function vM(){return vM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},vM.apply(this,arguments)}function L4e(e){var t=e.xAxisId,n=ND(),s=PD(),i=XK(t);return i==null?null:de.createElement(Hy,vM({},i,{className:Yr("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:s},ticksGenerator:function(u){return Zu(u,!0)}}))}var aa=function(e){function t(){return k4e(this,t),M4e(this,t,arguments)}return D4e(t,e),E4e(t,[{key:"render",value:function(){return de.createElement(L4e,this.props)}}])}(de.Component);gH(aa,"displayName","XAxis");gH(aa,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function cy(e){"@babel/helpers - typeof";return cy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cy(e)}function F4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z4e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,_H(s.key),s)}}function $4e(e,t,n){return t&&z4e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function B4e(e,t,n){return t=ON(t),q4e(e,yH()?Reflect.construct(t,n||[],ON(e).constructor):t.apply(e,n))}function q4e(e,t){if(t&&(cy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V4e(e)}function V4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yH=function(){return!!e})()}function ON(e){return ON=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ON(e)}function U4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_M(e,t)}function _M(e,t){return _M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},_M(e,t)}function vH(e,t,n){return t=_H(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _H(e){var t=W4e(e,"string");return cy(t)=="symbol"?t:t+""}function W4e(e,t){if(cy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(cy(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function bM(){return bM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},bM.apply(this,arguments)}var G4e=function(t){var n=t.yAxisId,s=ND(),i=PD(),c=QK(n);return c==null?null:de.createElement(Hy,bM({},c,{className:Yr("recharts-".concat(c.axisType," ").concat(c.axisType),c.className),viewBox:{x:0,y:0,width:s,height:i},ticksGenerator:function(a){return Zu(a,!0)}}))},Mi=function(e){function t(){return F4e(this,t),B4e(this,t,arguments)}return U4e(t,e),$4e(t,[{key:"render",value:function(){return de.createElement(G4e,this.props)}}])}(de.Component);vH(Mi,"displayName","YAxis");vH(Mi,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function j6(e){return Y4e(e)||Z4e(e)||H4e(e)||K4e()}function K4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function H4e(e,t){if(e){if(typeof e=="string")return jM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jM(e,t)}}function Z4e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Y4e(e){if(Array.isArray(e))return jM(e)}function jM(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}var wM=function(t,n,s,i,c){var u=Yo(t,mP),a=Yo(t,gP),m=[].concat(j6(u),j6(a)),p=Yo(t,yP),y="".concat(i,"Id"),v=i[0],j=n;if(m.length&&(j=m.reduce(function(N,D){if(D.props[y]===s&&Qc(D.props,"extendDomain")&&Ut(D.props[v])){var O=D.props[v];return[Math.min(N[0],O),Math.max(N[1],O)]}return N},j)),p.length){var S="".concat(v,"1"),k="".concat(v,"2");j=p.reduce(function(N,D){if(D.props[y]===s&&Qc(D.props,"extendDomain")&&Ut(D.props[S])&&Ut(D.props[k])){var O=D.props[S],T=D.props[k];return[Math.min(N[0],O,T),Math.max(N[1],O,T)]}return N},j)}return c&&c.length&&(j=c.reduce(function(N,D){return Ut(D)?[Math.min(N[0],D),Math.max(N[1],D)]:N},j)),j},bH={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(n=!1));function i(m,p,y){this.fn=m,this.context=p,this.once=y||!1}function c(m,p,y,v,j){if(typeof y!="function")throw new TypeError("The listener must be a function");var S=new i(y,v||m,j),k=n?n+p:p;return m._events[k]?m._events[k].fn?m._events[k]=[m._events[k],S]:m._events[k].push(S):(m._events[k]=S,m._eventsCount++),m}function u(m,p){--m._eventsCount===0?m._events=new s:delete m._events[p]}function a(){this._events=new s,this._eventsCount=0}a.prototype.eventNames=function(){var p=[],y,v;if(this._eventsCount===0)return p;for(v in y=this._events)t.call(y,v)&&p.push(n?v.slice(1):v);return Object.getOwnPropertySymbols?p.concat(Object.getOwnPropertySymbols(y)):p},a.prototype.listeners=function(p){var y=n?n+p:p,v=this._events[y];if(!v)return[];if(v.fn)return[v.fn];for(var j=0,S=v.length,k=new Array(S);j<S;j++)k[j]=v[j].fn;return k},a.prototype.listenerCount=function(p){var y=n?n+p:p,v=this._events[y];return v?v.fn?1:v.length:0},a.prototype.emit=function(p,y,v,j,S,k){var N=n?n+p:p;if(!this._events[N])return!1;var D=this._events[N],O=arguments.length,T,I;if(D.fn){switch(D.once&&this.removeListener(p,D.fn,void 0,!0),O){case 1:return D.fn.call(D.context),!0;case 2:return D.fn.call(D.context,y),!0;case 3:return D.fn.call(D.context,y,v),!0;case 4:return D.fn.call(D.context,y,v,j),!0;case 5:return D.fn.call(D.context,y,v,j,S),!0;case 6:return D.fn.call(D.context,y,v,j,S,k),!0}for(I=1,T=new Array(O-1);I<O;I++)T[I-1]=arguments[I];D.fn.apply(D.context,T)}else{var z=D.length,$;for(I=0;I<z;I++)switch(D[I].once&&this.removeListener(p,D[I].fn,void 0,!0),O){case 1:D[I].fn.call(D[I].context);break;case 2:D[I].fn.call(D[I].context,y);break;case 3:D[I].fn.call(D[I].context,y,v);break;case 4:D[I].fn.call(D[I].context,y,v,j);break;default:if(!T)for($=1,T=new Array(O-1);$<O;$++)T[$-1]=arguments[$];D[I].fn.apply(D[I].context,T)}}return!0},a.prototype.on=function(p,y,v){return c(this,p,y,v,!1)},a.prototype.once=function(p,y,v){return c(this,p,y,v,!0)},a.prototype.removeListener=function(p,y,v,j){var S=n?n+p:p;if(!this._events[S])return this;if(!y)return u(this,S),this;var k=this._events[S];if(k.fn)k.fn===y&&(!j||k.once)&&(!v||k.context===v)&&u(this,S);else{for(var N=0,D=[],O=k.length;N<O;N++)(k[N].fn!==y||j&&!k[N].once||v&&k[N].context!==v)&&D.push(k[N]);D.length?this._events[S]=D.length===1?D[0]:D:u(this,S)}return this},a.prototype.removeAllListeners=function(p){var y;return p?(y=n?n+p:p,this._events[y]&&u(this,y)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a})(bH);var X4e=bH.exports;const Q4e=Fn(X4e);var nk=new Q4e,sk="recharts.syncMouseEvents";function vb(e){"@babel/helpers - typeof";return vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vb(e)}function J4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eLe(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,jH(s.key),s)}}function tLe(e,t,n){return t&&eLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ik(e,t,n){return t=jH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jH(e){var t=rLe(e,"string");return vb(t)=="symbol"?t:t+""}function rLe(e,t){if(vb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(vb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var nLe=function(){function e(){J4e(this,e),ik(this,"activeIndex",0),ik(this,"coordinateList",[]),ik(this,"layout","horizontal")}return tLe(e,[{key:"setDetails",value:function(n){var s,i=n.coordinateList,c=i===void 0?null:i,u=n.container,a=u===void 0?null:u,m=n.layout,p=m===void 0?null:m,y=n.offset,v=y===void 0?null:y,j=n.mouseHandlerCallback,S=j===void 0?null:j;this.coordinateList=(s=c??this.coordinateList)!==null&&s!==void 0?s:[],this.container=a??this.container,this.layout=p??this.layout,this.offset=v??this.offset,this.mouseHandlerCallback=S??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,s;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var i=this.container.getBoundingClientRect(),c=i.x,u=i.y,a=i.height,m=this.coordinateList[this.activeIndex].coordinate,p=((n=window)===null||n===void 0?void 0:n.scrollX)||0,y=((s=window)===null||s===void 0?void 0:s.scrollY)||0,v=c+m+p,j=u+this.offset.top+a/2+y;this.mouseHandlerCallback({pageX:v,pageY:j})}}}])}();function sLe(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var s=e==null?void 0:e[0],i=e==null?void 0:e[1];if(s&&i&&Ut(s)&&Ut(i))return!0}return!1}function iLe(e,t,n,s){var i=s/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-i:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-i,width:e==="horizontal"?s:n.width-1,height:e==="horizontal"?n.height-1:s}}function wH(e){var t=e.cx,n=e.cy,s=e.radius,i=e.startAngle,c=e.endAngle,u=$n(t,n,s,i),a=$n(t,n,s,c);return{points:[u,a],cx:t,cy:n,radius:s,startAngle:i,endAngle:c}}function aLe(e,t,n){var s,i,c,u;if(e==="horizontal")s=t.x,c=s,i=n.top,u=n.top+n.height;else if(e==="vertical")i=t.y,u=i,s=n.left,c=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var a=t.cx,m=t.cy,p=t.innerRadius,y=t.outerRadius,v=t.angle,j=$n(a,m,p,v),S=$n(a,m,y,v);s=j.x,i=j.y,c=S.x,u=S.y}else return wH(t);return[{x:s,y:i},{x:c,y:u}]}function _b(e){"@babel/helpers - typeof";return _b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_b(e)}function w6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function h1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?w6(Object(n),!0).forEach(function(s){oLe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function oLe(e,t,n){return t=lLe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lLe(e){var t=cLe(e,"string");return _b(t)=="symbol"?t:t+""}function cLe(e,t){if(_b(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(_b(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uLe(e){var t,n,s=e.element,i=e.tooltipEventType,c=e.isActive,u=e.activeCoordinate,a=e.activePayload,m=e.offset,p=e.activeTooltipIndex,y=e.tooltipAxisBandSize,v=e.layout,j=e.chartName,S=(t=s.props.cursor)!==null&&t!==void 0?t:(n=s.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!s||!S||!c||!u||j!=="ScatterChart"&&i!=="axis")return null;var k,N=km;if(j==="ScatterChart")k=u,N=KEe;else if(j==="BarChart")k=iLe(v,u,m,y),N=_D;else if(v==="radial"){var D=wH(u),O=D.cx,T=D.cy,I=D.radius,z=D.startAngle,$=D.endAngle;k={cx:O,cy:T,startAngle:z,endAngle:$,innerRadius:I,outerRadius:I},N=dK}else k={points:aLe(v,u,m)},N=km;var V=h1(h1(h1(h1({stroke:"#ccc",pointerEvents:"none"},m),k),Cr(S,!1)),{},{payload:a,payloadIndex:p,className:Yr("recharts-tooltip-cursor",S.className)});return R.isValidElement(S)?R.cloneElement(S,V):R.createElement(N,V)}var dLe=["item"],hLe=["children","className","width","height","style","compact","title","desc"];function uy(e){"@babel/helpers - typeof";return uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uy(e)}function $g(){return $g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},$g.apply(this,arguments)}function S6(e,t){return pLe(e)||mLe(e,t)||NH(e,t)||fLe()}function fLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mLe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,c,u,a=[],m=!0,p=!1;try{if(c=(n=n.call(e)).next,t!==0)for(;!(m=(s=c.call(n)).done)&&(a.push(s.value),a.length!==t);m=!0);}catch(y){p=!0,i=y}finally{try{if(!m&&n.return!=null&&(u=n.return(),Object(u)!==u))return}finally{if(p)throw i}}return a}}function pLe(e){if(Array.isArray(e))return e}function N6(e,t){if(e==null)return{};var n=gLe(e,t),s,i;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)s=c[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function gLe(e,t){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function xLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yLe(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,PH(s.key),s)}}function vLe(e,t,n){return t&&yLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Le(e,t,n){return t=IN(t),bLe(e,SH()?Reflect.construct(t,n||[],IN(e).constructor):t.apply(e,n))}function bLe(e,t){if(t&&(uy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jLe(e)}function jLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(SH=function(){return!!e})()}function IN(e){return IN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},IN(e)}function wLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SM(e,t)}function SM(e,t){return SM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},SM(e,t)}function dy(e){return PLe(e)||NLe(e)||NH(e)||SLe()}function SLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NH(e,t){if(e){if(typeof e=="string")return NM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return NM(e,t)}}function NLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function PLe(e){if(Array.isArray(e))return NM(e)}function NM(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function P6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function St(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?P6(Object(n),!0).forEach(function(s){Gr(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Gr(e,t,n){return t=PH(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PH(e){var t=CLe(e,"string");return uy(t)=="symbol"?t:t+""}function CLe(e,t){if(uy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t);if(uy(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ALe={xAxis:["bottom","top"],yAxis:["left","right"]},kLe={width:"100%",height:"100%"},CH={x:0,y:0};function f1(e){return e}var TLe=function(t,n){return n==="horizontal"?t.x:n==="vertical"?t.y:n==="centric"?t.angle:t.radius},ELe=function(t,n,s,i){var c=n.find(function(y){return y&&y.index===s});if(c){if(t==="horizontal")return{x:c.coordinate,y:i.y};if(t==="vertical")return{x:i.x,y:c.coordinate};if(t==="centric"){var u=c.coordinate,a=i.radius;return St(St(St({},i),$n(i.cx,i.cy,a,u)),{},{angle:u,radius:a})}var m=c.coordinate,p=i.angle;return St(St(St({},i),$n(i.cx,i.cy,m,p)),{},{angle:p,radius:m})}return CH},vP=function(t,n){var s=n.graphicalItems,i=n.dataStartIndex,c=n.dataEndIndex,u=(s??[]).reduce(function(a,m){var p=m.props.data;return p&&p.length?[].concat(dy(a),dy(p)):a},[]);return u.length>0?u:t&&t.length&&Ut(i)&&Ut(c)?t.slice(i,c+1):[]};function AH(e){return e==="number"?[0,"auto"]:void 0}var PM=function(t,n,s,i){var c=t.graphicalItems,u=t.tooltipAxis,a=vP(n,t);return s<0||!c||!c.length||s>=a.length?null:c.reduce(function(m,p){var y,v=(y=p.props.data)!==null&&y!==void 0?y:n;v&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=s&&(v=v.slice(t.dataStartIndex,t.dataEndIndex+1));var j;if(u.dataKey&&!u.allowDuplicatedCategory){var S=v===void 0?a:v;j=ES(S,u.dataKey,i)}else j=v&&v[s]||a[s];return j?[].concat(dy(m),[nK(p,j)]):m},[])},C6=function(t,n,s,i){var c=i||{x:t.chartX,y:t.chartY},u=TLe(c,s),a=t.orderedTooltipTicks,m=t.tooltipAxis,p=t.tooltipTicks,y=TAe(u,a,p,m);if(y>=0&&p){var v=p[y]&&p[y].value,j=PM(t,n,y,v),S=ELe(s,a,y,c);return{activeTooltipIndex:y,activeLabel:v,activePayload:j,activeCoordinate:S}}return null},MLe=function(t,n){var s=n.axes,i=n.graphicalItems,c=n.axisType,u=n.axisIdKey,a=n.stackGroups,m=n.dataStartIndex,p=n.dataEndIndex,y=t.layout,v=t.children,j=t.stackOffset,S=XG(y,c);return s.reduce(function(k,N){var D,O=N.type.defaultProps!==void 0?St(St({},N.type.defaultProps),N.props):N.props,T=O.type,I=O.dataKey,z=O.allowDataOverflow,$=O.allowDuplicatedCategory,V=O.scale,K=O.ticks,te=O.includeHidden,X=O[u];if(k[X])return k;var ve=vP(t.data,{graphicalItems:i.filter(function(gt){var Tt,Ht=u in gt.props?gt.props[u]:(Tt=gt.type.defaultProps)===null||Tt===void 0?void 0:Tt[u];return Ht===X}),dataStartIndex:m,dataEndIndex:p}),ae=ve.length,pe,Oe,Me;sLe(O.domain,z,T)&&(pe=FE(O.domain,null,z),S&&(T==="number"||V!=="auto")&&(Me=r0(ve,I,"category")));var Xe=AH(T);if(!pe||pe.length===0){var Ve,et=(Ve=O.domain)!==null&&Ve!==void 0?Ve:Xe;if(I){if(pe=r0(ve,I,T),T==="category"&&S){var Ce=bge(pe);$&&Ce?(Oe=pe,pe=_N(0,ae)):$||(pe=U$(et,pe,N).reduce(function(gt,Tt){return gt.indexOf(Tt)>=0?gt:[].concat(dy(gt),[Tt])},[]))}else if(T==="category")$?pe=pe.filter(function(gt){return gt!==""&&!Zr(gt)}):pe=U$(et,pe,N).reduce(function(gt,Tt){return gt.indexOf(Tt)>=0||Tt===""||Zr(Tt)?gt:[].concat(dy(gt),[Tt])},[]);else if(T==="number"){var _e=DAe(ve,i.filter(function(gt){var Tt,Ht,Ir=u in gt.props?gt.props[u]:(Tt=gt.type.defaultProps)===null||Tt===void 0?void 0:Tt[u],Pr="hide"in gt.props?gt.props.hide:(Ht=gt.type.defaultProps)===null||Ht===void 0?void 0:Ht.hide;return Ir===X&&(te||!Pr)}),I,c,y);_e&&(pe=_e)}S&&(T==="number"||V!=="auto")&&(Me=r0(ve,I,"category"))}else S?pe=_N(0,ae):a&&a[X]&&a[X].hasStack&&T==="number"?pe=j==="expand"?[0,1]:rK(a[X].stackGroups,m,p):pe=YG(ve,i.filter(function(gt){var Tt=u in gt.props?gt.props[u]:gt.type.defaultProps[u],Ht="hide"in gt.props?gt.props.hide:gt.type.defaultProps.hide;return Tt===X&&(te||!Ht)}),T,y,!0);if(T==="number")pe=wM(v,pe,X,c,K),et&&(pe=FE(et,pe,z));else if(T==="category"&&et){var tt=et,vt=pe.every(function(gt){return tt.indexOf(gt)>=0});vt&&(pe=tt)}}return St(St({},k),{},Gr({},X,St(St({},O),{},{axisType:c,domain:pe,categoricalDomain:Me,duplicateDomain:Oe,originalDomain:(D=O.domain)!==null&&D!==void 0?D:Xe,isCategorical:S,layout:y})))},{})},OLe=function(t,n){var s=n.graphicalItems,i=n.Axis,c=n.axisType,u=n.axisIdKey,a=n.stackGroups,m=n.dataStartIndex,p=n.dataEndIndex,y=t.layout,v=t.children,j=vP(t.data,{graphicalItems:s,dataStartIndex:m,dataEndIndex:p}),S=j.length,k=XG(y,c),N=-1;return s.reduce(function(D,O){var T=O.type.defaultProps!==void 0?St(St({},O.type.defaultProps),O.props):O.props,I=T[u],z=AH("number");if(!D[I]){N++;var $;return k?$=_N(0,S):a&&a[I]&&a[I].hasStack?($=rK(a[I].stackGroups,m,p),$=wM(v,$,I,c)):($=FE(z,YG(j,s.filter(function(V){var K,te,X=u in V.props?V.props[u]:(K=V.type.defaultProps)===null||K===void 0?void 0:K[u],ve="hide"in V.props?V.props.hide:(te=V.type.defaultProps)===null||te===void 0?void 0:te.hide;return X===I&&!ve}),"number",y),i.defaultProps.allowDataOverflow),$=wM(v,$,I,c)),St(St({},D),{},Gr({},I,St(St({axisType:c},i.defaultProps),{},{hide:!0,orientation:Zo(ALe,"".concat(c,".").concat(N%2),null),domain:$,originalDomain:z,isCategorical:k,layout:y})))}return D},{})},ILe=function(t,n){var s=n.axisType,i=s===void 0?"xAxis":s,c=n.AxisComp,u=n.graphicalItems,a=n.stackGroups,m=n.dataStartIndex,p=n.dataEndIndex,y=t.children,v="".concat(i,"Id"),j=Yo(y,c),S={};return j&&j.length?S=MLe(t,{axes:j,graphicalItems:u,axisType:i,axisIdKey:v,stackGroups:a,dataStartIndex:m,dataEndIndex:p}):u&&u.length&&(S=OLe(t,{Axis:c,graphicalItems:u,axisType:i,axisIdKey:v,stackGroups:a,dataStartIndex:m,dataEndIndex:p})),S},DLe=function(t){var n=ph(t),s=Zu(n,!1,!0);return{tooltipTicks:s,orderedTooltipTicks:KI(s,function(i){return i.coordinate}),tooltipAxis:n,tooltipAxisBandSize:aN(n,s)}},A6=function(t){var n=t.children,s=t.defaultShowTooltip,i=zo(n,ey),c=0,u=0;return t.data&&t.data.length!==0&&(u=t.data.length-1),i&&i.props&&(i.props.startIndex>=0&&(c=i.props.startIndex),i.props.endIndex>=0&&(u=i.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:c,dataEndIndex:u,activeTooltipIndex:-1,isTooltipActive:!!s}},RLe=function(t){return!t||!t.length?!1:t.some(function(n){var s=ed(n&&n.type);return s&&s.indexOf("Bar")>=0})},k6=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},LLe=function(t,n){var s=t.props,i=t.graphicalItems,c=t.xAxisMap,u=c===void 0?{}:c,a=t.yAxisMap,m=a===void 0?{}:a,p=s.width,y=s.height,v=s.children,j=s.margin||{},S=zo(v,ey),k=zo(v,sa),N=Object.keys(m).reduce(function($,V){var K=m[V],te=K.orientation;return!K.mirror&&!K.hide?St(St({},$),{},Gr({},te,$[te]+K.width)):$},{left:j.left||0,right:j.right||0}),D=Object.keys(u).reduce(function($,V){var K=u[V],te=K.orientation;return!K.mirror&&!K.hide?St(St({},$),{},Gr({},te,Zo($,"".concat(te))+K.height)):$},{top:j.top||0,bottom:j.bottom||0}),O=St(St({},D),N),T=O.bottom;S&&(O.bottom+=S.props.height||ey.defaultProps.height),k&&n&&(O=OAe(O,i,s,n));var I=p-O.left-O.right,z=y-O.top-O.bottom;return St(St({brushBottom:T},O),{},{width:Math.max(I,0),height:Math.max(z,0)})},FLe=function(t,n){if(n==="xAxis")return t[n].width;if(n==="yAxis")return t[n].height},Zb=function(t){var n=t.chartName,s=t.GraphicalChild,i=t.defaultTooltipEventType,c=i===void 0?"axis":i,u=t.validateTooltipEventTypes,a=u===void 0?["axis"]:u,m=t.axisComponents,p=t.legendContent,y=t.formatAxisMap,v=t.defaultProps,j=function(O,T){var I=T.graphicalItems,z=T.stackGroups,$=T.offset,V=T.updateId,K=T.dataStartIndex,te=T.dataEndIndex,X=O.barSize,ve=O.layout,ae=O.barGap,pe=O.barCategoryGap,Oe=O.maxBarSize,Me=k6(ve),Xe=Me.numericAxisName,Ve=Me.cateAxisName,et=RLe(I),Ce=[];return I.forEach(function(_e,tt){var vt=vP(O.data,{graphicalItems:[_e],dataStartIndex:K,dataEndIndex:te}),gt=_e.type.defaultProps!==void 0?St(St({},_e.type.defaultProps),_e.props):_e.props,Tt=gt.dataKey,Ht=gt.maxBarSize,Ir=gt["".concat(Xe,"Id")],Pr=gt["".concat(Ve,"Id")],Mt={},yr=m.reduce(function(rt,pt){var Lt=T["".concat(pt.axisType,"Map")],Rt=gt["".concat(pt.axisType,"Id")];Lt&&Lt[Rt]||pt.axisType==="zAxis"||Hm();var Ot=Lt[Rt];return St(St({},rt),{},Gr(Gr({},pt.axisType,Ot),"".concat(pt.axisType,"Ticks"),Zu(Ot)))},Mt),Nt=yr[Ve],Wt=yr["".concat(Ve,"Ticks")],Zt=z&&z[Ir]&&z[Ir].hasStack&&UAe(_e,z[Ir].stackGroups),mt=ed(_e.type).indexOf("Bar")>=0,qr=aN(Nt,Wt),ar=[],en=et&&EAe({barSize:X,stackGroups:z,totalSize:FLe(yr,Ve)});if(mt){var Lr,An,vs=Zr(Ht)?Oe:Ht,Wn=(Lr=(An=aN(Nt,Wt,!0))!==null&&An!==void 0?An:vs)!==null&&Lr!==void 0?Lr:0;ar=MAe({barGap:ae,barCategoryGap:pe,bandSize:Wn!==qr?Wn:qr,sizeList:en[Pr],maxBarSize:vs}),Wn!==qr&&(ar=ar.map(function(rt){return St(St({},rt),{},{position:St(St({},rt.position),{},{offset:rt.position.offset-Wn/2})})}))}var Be=_e&&_e.type&&_e.type.getComposedData;Be&&Ce.push({props:St(St({},Be(St(St({},yr),{},{displayedData:vt,props:O,dataKey:Tt,item:_e,bandSize:qr,barPosition:ar,offset:$,stackedData:Zt,layout:ve,dataStartIndex:K,dataEndIndex:te}))),{},Gr(Gr(Gr({key:_e.key||"item-".concat(tt)},Xe,yr[Xe]),Ve,yr[Ve]),"animationId",V)),childIndex:Mge(_e,O.children),item:_e})}),Ce},S=function(O,T){var I=O.props,z=O.dataStartIndex,$=O.dataEndIndex,V=O.updateId;if(!FF({props:I}))return null;var K=I.children,te=I.layout,X=I.stackOffset,ve=I.data,ae=I.reverseStackOrder,pe=k6(te),Oe=pe.numericAxisName,Me=pe.cateAxisName,Xe=Yo(K,s),Ve=qAe(ve,Xe,"".concat(Oe,"Id"),"".concat(Me,"Id"),X,ae),et=m.reduce(function(gt,Tt){var Ht="".concat(Tt.axisType,"Map");return St(St({},gt),{},Gr({},Ht,ILe(I,St(St({},Tt),{},{graphicalItems:Xe,stackGroups:Tt.axisType===Oe&&Ve,dataStartIndex:z,dataEndIndex:$}))))},{}),Ce=LLe(St(St({},et),{},{props:I,graphicalItems:Xe}),T==null?void 0:T.legendBBox);Object.keys(et).forEach(function(gt){et[gt]=y(I,et[gt],Ce,gt.replace("Map",""),n)});var _e=et["".concat(Me,"Map")],tt=DLe(_e),vt=j(I,St(St({},et),{},{dataStartIndex:z,dataEndIndex:$,updateId:V,graphicalItems:Xe,stackGroups:Ve,offset:Ce}));return St(St({formattedGraphicalItems:vt,graphicalItems:Xe,offset:Ce,stackGroups:Ve},tt),et)},k=function(D){function O(T){var I,z,$;return xLe(this,O),$=_Le(this,O,[T]),Gr($,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Gr($,"accessibilityManager",new nLe),Gr($,"handleLegendBBoxUpdate",function(V){if(V){var K=$.state,te=K.dataStartIndex,X=K.dataEndIndex,ve=K.updateId;$.setState(St({legendBBox:V},S({props:$.props,dataStartIndex:te,dataEndIndex:X,updateId:ve},St(St({},$.state),{},{legendBBox:V}))))}}),Gr($,"handleReceiveSyncEvent",function(V,K,te){if($.props.syncId===V){if(te===$.eventEmitterSymbol&&typeof $.props.syncMethod!="function")return;$.applySyncEvent(K)}}),Gr($,"handleBrushChange",function(V){var K=V.startIndex,te=V.endIndex;if(K!==$.state.dataStartIndex||te!==$.state.dataEndIndex){var X=$.state.updateId;$.setState(function(){return St({dataStartIndex:K,dataEndIndex:te},S({props:$.props,dataStartIndex:K,dataEndIndex:te,updateId:X},$.state))}),$.triggerSyncEvent({dataStartIndex:K,dataEndIndex:te})}}),Gr($,"handleMouseEnter",function(V){var K=$.getMouseInfo(V);if(K){var te=St(St({},K),{},{isTooltipActive:!0});$.setState(te),$.triggerSyncEvent(te);var X=$.props.onMouseEnter;Br(X)&&X(te,V)}}),Gr($,"triggeredAfterMouseMove",function(V){var K=$.getMouseInfo(V),te=K?St(St({},K),{},{isTooltipActive:!0}):{isTooltipActive:!1};$.setState(te),$.triggerSyncEvent(te);var X=$.props.onMouseMove;Br(X)&&X(te,V)}),Gr($,"handleItemMouseEnter",function(V){$.setState(function(){return{isTooltipActive:!0,activeItem:V,activePayload:V.tooltipPayload,activeCoordinate:V.tooltipPosition||{x:V.cx,y:V.cy}}})}),Gr($,"handleItemMouseLeave",function(){$.setState(function(){return{isTooltipActive:!1}})}),Gr($,"handleMouseMove",function(V){V.persist(),$.throttleTriggeredAfterMouseMove(V)}),Gr($,"handleMouseLeave",function(V){$.throttleTriggeredAfterMouseMove.cancel();var K={isTooltipActive:!1};$.setState(K),$.triggerSyncEvent(K);var te=$.props.onMouseLeave;Br(te)&&te(K,V)}),Gr($,"handleOuterEvent",function(V){var K=Ege(V),te=Zo($.props,"".concat(K));if(K&&Br(te)){var X,ve;/.*touch.*/i.test(K)?ve=$.getMouseInfo(V.changedTouches[0]):ve=$.getMouseInfo(V),te((X=ve)!==null&&X!==void 0?X:{},V)}}),Gr($,"handleClick",function(V){var K=$.getMouseInfo(V);if(K){var te=St(St({},K),{},{isTooltipActive:!0});$.setState(te),$.triggerSyncEvent(te);var X=$.props.onClick;Br(X)&&X(te,V)}}),Gr($,"handleMouseDown",function(V){var K=$.props.onMouseDown;if(Br(K)){var te=$.getMouseInfo(V);K(te,V)}}),Gr($,"handleMouseUp",function(V){var K=$.props.onMouseUp;if(Br(K)){var te=$.getMouseInfo(V);K(te,V)}}),Gr($,"handleTouchMove",function(V){V.changedTouches!=null&&V.changedTouches.length>0&&$.throttleTriggeredAfterMouseMove(V.changedTouches[0])}),Gr($,"handleTouchStart",function(V){V.changedTouches!=null&&V.changedTouches.length>0&&$.handleMouseDown(V.changedTouches[0])}),Gr($,"handleTouchEnd",function(V){V.changedTouches!=null&&V.changedTouches.length>0&&$.handleMouseUp(V.changedTouches[0])}),Gr($,"triggerSyncEvent",function(V){$.props.syncId!==void 0&&nk.emit(sk,$.props.syncId,V,$.eventEmitterSymbol)}),Gr($,"applySyncEvent",function(V){var K=$.props,te=K.layout,X=K.syncMethod,ve=$.state.updateId,ae=V.dataStartIndex,pe=V.dataEndIndex;if(V.dataStartIndex!==void 0||V.dataEndIndex!==void 0)$.setState(St({dataStartIndex:ae,dataEndIndex:pe},S({props:$.props,dataStartIndex:ae,dataEndIndex:pe,updateId:ve},$.state)));else if(V.activeTooltipIndex!==void 0){var Oe=V.chartX,Me=V.chartY,Xe=V.activeTooltipIndex,Ve=$.state,et=Ve.offset,Ce=Ve.tooltipTicks;if(!et)return;if(typeof X=="function")Xe=X(Ce,V);else if(X==="value"){Xe=-1;for(var _e=0;_e<Ce.length;_e++)if(Ce[_e].value===V.activeLabel){Xe=_e;break}}var tt=St(St({},et),{},{x:et.left,y:et.top}),vt=Math.min(Oe,tt.x+tt.width),gt=Math.min(Me,tt.y+tt.height),Tt=Ce[Xe]&&Ce[Xe].value,Ht=PM($.state,$.props.data,Xe),Ir=Ce[Xe]?{x:te==="horizontal"?Ce[Xe].coordinate:vt,y:te==="horizontal"?gt:Ce[Xe].coordinate}:CH;$.setState(St(St({},V),{},{activeLabel:Tt,activeCoordinate:Ir,activePayload:Ht,activeTooltipIndex:Xe}))}else $.setState(V)}),Gr($,"renderCursor",function(V){var K,te=$.state,X=te.isTooltipActive,ve=te.activeCoordinate,ae=te.activePayload,pe=te.offset,Oe=te.activeTooltipIndex,Me=te.tooltipAxisBandSize,Xe=$.getTooltipEventType(),Ve=(K=V.props.active)!==null&&K!==void 0?K:X,et=$.props.layout,Ce=V.key||"_recharts-cursor";return de.createElement(uLe,{key:Ce,activeCoordinate:ve,activePayload:ae,activeTooltipIndex:Oe,chartName:n,element:V,isActive:Ve,layout:et,offset:pe,tooltipAxisBandSize:Me,tooltipEventType:Xe})}),Gr($,"renderPolarAxis",function(V,K,te){var X=Zo(V,"type.axisType"),ve=Zo($.state,"".concat(X,"Map")),ae=V.type.defaultProps,pe=ae!==void 0?St(St({},ae),V.props):V.props,Oe=ve&&ve[pe["".concat(X,"Id")]];return R.cloneElement(V,St(St({},Oe),{},{className:Yr(X,Oe.className),key:V.key||"".concat(K,"-").concat(te),ticks:Zu(Oe,!0)}))}),Gr($,"renderPolarGrid",function(V){var K=V.props,te=K.radialLines,X=K.polarAngles,ve=K.polarRadius,ae=$.state,pe=ae.radiusAxisMap,Oe=ae.angleAxisMap,Me=ph(pe),Xe=ph(Oe),Ve=Xe.cx,et=Xe.cy,Ce=Xe.innerRadius,_e=Xe.outerRadius;return R.cloneElement(V,{polarAngles:Array.isArray(X)?X:Zu(Xe,!0).map(function(tt){return tt.coordinate}),polarRadius:Array.isArray(ve)?ve:Zu(Me,!0).map(function(tt){return tt.coordinate}),cx:Ve,cy:et,innerRadius:Ce,outerRadius:_e,key:V.key||"polar-grid",radialLines:te})}),Gr($,"renderLegend",function(){var V=$.state.formattedGraphicalItems,K=$.props,te=K.children,X=K.width,ve=K.height,ae=$.props.margin||{},pe=X-(ae.left||0)-(ae.right||0),Oe=HG({children:te,formattedGraphicalItems:V,legendWidth:pe,legendContent:p});if(!Oe)return null;var Me=Oe.item,Xe=N6(Oe,dLe);return R.cloneElement(Me,St(St({},Xe),{},{chartWidth:X,chartHeight:ve,margin:ae,onBBoxUpdate:$.handleLegendBBoxUpdate}))}),Gr($,"renderTooltip",function(){var V,K=$.props,te=K.children,X=K.accessibilityLayer,ve=zo(te,Ds);if(!ve)return null;var ae=$.state,pe=ae.isTooltipActive,Oe=ae.activeCoordinate,Me=ae.activePayload,Xe=ae.activeLabel,Ve=ae.offset,et=(V=ve.props.active)!==null&&V!==void 0?V:pe;return R.cloneElement(ve,{viewBox:St(St({},Ve),{},{x:Ve.left,y:Ve.top}),active:et,label:Xe,payload:et?Me:[],coordinate:Oe,accessibilityLayer:X})}),Gr($,"renderBrush",function(V){var K=$.props,te=K.margin,X=K.data,ve=$.state,ae=ve.offset,pe=ve.dataStartIndex,Oe=ve.dataEndIndex,Me=ve.updateId;return R.cloneElement(V,{key:V.key||"_recharts-brush",onChange:l1($.handleBrushChange,V.props.onChange),data:X,x:Ut(V.props.x)?V.props.x:ae.left,y:Ut(V.props.y)?V.props.y:ae.top+ae.height+ae.brushBottom-(te.bottom||0),width:Ut(V.props.width)?V.props.width:ae.width,startIndex:pe,endIndex:Oe,updateId:"brush-".concat(Me)})}),Gr($,"renderReferenceElement",function(V,K,te){if(!V)return null;var X=$,ve=X.clipPathId,ae=$.state,pe=ae.xAxisMap,Oe=ae.yAxisMap,Me=ae.offset,Xe=V.type.defaultProps||{},Ve=V.props,et=Ve.xAxisId,Ce=et===void 0?Xe.xAxisId:et,_e=Ve.yAxisId,tt=_e===void 0?Xe.yAxisId:_e;return R.cloneElement(V,{key:V.key||"".concat(K,"-").concat(te),xAxis:pe[Ce],yAxis:Oe[tt],viewBox:{x:Me.left,y:Me.top,width:Me.width,height:Me.height},clipPathId:ve})}),Gr($,"renderActivePoints",function(V){var K=V.item,te=V.activePoint,X=V.basePoint,ve=V.childIndex,ae=V.isRange,pe=[],Oe=K.props.key,Me=K.item.type.defaultProps!==void 0?St(St({},K.item.type.defaultProps),K.item.props):K.item.props,Xe=Me.activeDot,Ve=Me.dataKey,et=St(St({index:ve,dataKey:Ve,cx:te.x,cy:te.y,r:4,fill:vD(K.item),strokeWidth:2,stroke:"#fff",payload:te.payload,value:te.value},Cr(Xe,!1)),MS(Xe));return pe.push(O.renderActiveDot(Xe,et,"".concat(Oe,"-activePoint-").concat(ve))),X?pe.push(O.renderActiveDot(Xe,St(St({},et),{},{cx:X.x,cy:X.y}),"".concat(Oe,"-basePoint-").concat(ve))):ae&&pe.push(null),pe}),Gr($,"renderGraphicChild",function(V,K,te){var X=$.filterFormatItem(V,K,te);if(!X)return null;var ve=$.getTooltipEventType(),ae=$.state,pe=ae.isTooltipActive,Oe=ae.tooltipAxis,Me=ae.activeTooltipIndex,Xe=ae.activeLabel,Ve=$.props.children,et=zo(Ve,Ds),Ce=X.props,_e=Ce.points,tt=Ce.isRange,vt=Ce.baseLine,gt=X.item.type.defaultProps!==void 0?St(St({},X.item.type.defaultProps),X.item.props):X.item.props,Tt=gt.activeDot,Ht=gt.hide,Ir=gt.activeBar,Pr=gt.activeShape,Mt=!!(!Ht&&pe&&et&&(Tt||Ir||Pr)),yr={};ve!=="axis"&&et&&et.props.trigger==="click"?yr={onClick:l1($.handleItemMouseEnter,V.props.onClick)}:ve!=="axis"&&(yr={onMouseLeave:l1($.handleItemMouseLeave,V.props.onMouseLeave),onMouseEnter:l1($.handleItemMouseEnter,V.props.onMouseEnter)});var Nt=R.cloneElement(V,St(St({},X.props),yr));function Wt(pt){return typeof Oe.dataKey=="function"?Oe.dataKey(pt.payload):null}if(Mt)if(Me>=0){var Zt,mt;if(Oe.dataKey&&!Oe.allowDuplicatedCategory){var qr=typeof Oe.dataKey=="function"?Wt:"payload.".concat(Oe.dataKey.toString());Zt=ES(_e,qr,Xe),mt=tt&&vt&&ES(vt,qr,Xe)}else Zt=_e==null?void 0:_e[Me],mt=tt&&vt&&vt[Me];if(Pr||Ir){var ar=V.props.activeIndex!==void 0?V.props.activeIndex:Me;return[R.cloneElement(V,St(St(St({},X.props),yr),{},{activeIndex:ar})),null,null]}if(!Zr(Zt))return[Nt].concat(dy($.renderActivePoints({item:X,activePoint:Zt,basePoint:mt,childIndex:Me,isRange:tt})))}else{var en,Lr=(en=$.getItemByXY($.state.activeCoordinate))!==null&&en!==void 0?en:{graphicalItem:Nt},An=Lr.graphicalItem,vs=An.item,Wn=vs===void 0?V:vs,Be=An.childIndex,rt=St(St(St({},X.props),yr),{},{activeIndex:Be});return[R.cloneElement(Wn,rt),null,null]}return tt?[Nt,null,null]:[Nt,null]}),Gr($,"renderCustomized",function(V,K,te){return R.cloneElement(V,St(St({key:"recharts-customized-".concat(te)},$.props),$.state))}),Gr($,"renderMap",{CartesianGrid:{handler:f1,once:!0},ReferenceArea:{handler:$.renderReferenceElement},ReferenceLine:{handler:f1},ReferenceDot:{handler:$.renderReferenceElement},XAxis:{handler:f1},YAxis:{handler:f1},Brush:{handler:$.renderBrush,once:!0},Bar:{handler:$.renderGraphicChild},Line:{handler:$.renderGraphicChild},Area:{handler:$.renderGraphicChild},Radar:{handler:$.renderGraphicChild},RadialBar:{handler:$.renderGraphicChild},Scatter:{handler:$.renderGraphicChild},Pie:{handler:$.renderGraphicChild},Funnel:{handler:$.renderGraphicChild},Tooltip:{handler:$.renderCursor,once:!0},PolarGrid:{handler:$.renderPolarGrid,once:!0},PolarAngleAxis:{handler:$.renderPolarAxis},PolarRadiusAxis:{handler:$.renderPolarAxis},Customized:{handler:$.renderCustomized}}),$.clipPathId="".concat((I=T.id)!==null&&I!==void 0?I:tp("recharts"),"-clip"),$.throttleTriggeredAfterMouseMove=K7($.triggeredAfterMouseMove,(z=T.throttleDelay)!==null&&z!==void 0?z:1e3/60),$.state={},$}return wLe(O,D),vLe(O,[{key:"componentDidMount",value:function(){var I,z;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(I=this.props.margin.left)!==null&&I!==void 0?I:0,top:(z=this.props.margin.top)!==null&&z!==void 0?z:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var I=this.props,z=I.children,$=I.data,V=I.height,K=I.layout,te=zo(z,Ds);if(te){var X=te.props.defaultIndex;if(!(typeof X!="number"||X<0||X>this.state.tooltipTicks.length-1)){var ve=this.state.tooltipTicks[X]&&this.state.tooltipTicks[X].value,ae=PM(this.state,$,X,ve),pe=this.state.tooltipTicks[X].coordinate,Oe=(this.state.offset.top+V)/2,Me=K==="horizontal",Xe=Me?{x:pe,y:Oe}:{y:pe,x:Oe},Ve=this.state.formattedGraphicalItems.find(function(Ce){var _e=Ce.item;return _e.type.name==="Scatter"});Ve&&(Xe=St(St({},Xe),Ve.props.points[X].tooltipPosition),ae=Ve.props.points[X].tooltipPayload);var et={activeTooltipIndex:X,isTooltipActive:!0,activeLabel:ve,activePayload:ae,activeCoordinate:Xe};this.setState(et),this.renderCursor(te),this.accessibilityManager.setIndex(X)}}}},{key:"getSnapshotBeforeUpdate",value:function(I,z){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==z.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==I.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==I.margin){var $,V;this.accessibilityManager.setDetails({offset:{left:($=this.props.margin.left)!==null&&$!==void 0?$:0,top:(V=this.props.margin.top)!==null&&V!==void 0?V:0}})}return null}},{key:"componentDidUpdate",value:function(I){JT([zo(I.children,Ds)],[zo(this.props.children,Ds)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var I=zo(this.props.children,Ds);if(I&&typeof I.props.shared=="boolean"){var z=I.props.shared?"axis":"item";return a.indexOf(z)>=0?z:c}return c}},{key:"getMouseInfo",value:function(I){if(!this.container)return null;var z=this.container,$=z.getBoundingClientRect(),V=sNe($),K={chartX:Math.round(I.pageX-V.left),chartY:Math.round(I.pageY-V.top)},te=$.width/z.offsetWidth||1,X=this.inRange(K.chartX,K.chartY,te);if(!X)return null;var ve=this.state,ae=ve.xAxisMap,pe=ve.yAxisMap,Oe=this.getTooltipEventType();if(Oe!=="axis"&&ae&&pe){var Me=ph(ae).scale,Xe=ph(pe).scale,Ve=Me&&Me.invert?Me.invert(K.chartX):null,et=Xe&&Xe.invert?Xe.invert(K.chartY):null;return St(St({},K),{},{xValue:Ve,yValue:et})}var Ce=C6(this.state,this.props.data,this.props.layout,X);return Ce?St(St({},K),Ce):null}},{key:"inRange",value:function(I,z){var $=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,V=this.props.layout,K=I/$,te=z/$;if(V==="horizontal"||V==="vertical"){var X=this.state.offset,ve=K>=X.left&&K<=X.left+X.width&&te>=X.top&&te<=X.top+X.height;return ve?{x:K,y:te}:null}var ae=this.state,pe=ae.angleAxisMap,Oe=ae.radiusAxisMap;if(pe&&Oe){var Me=ph(pe);return K$({x:K,y:te},Me)}return null}},{key:"parseEventsOfWrapper",value:function(){var I=this.props.children,z=this.getTooltipEventType(),$=zo(I,Ds),V={};$&&z==="axis"&&($.props.trigger==="click"?V={onClick:this.handleClick}:V={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var K=MS(this.props,this.handleOuterEvent);return St(St({},K),V)}},{key:"addListener",value:function(){nk.on(sk,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){nk.removeListener(sk,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(I,z,$){for(var V=this.state.formattedGraphicalItems,K=0,te=V.length;K<te;K++){var X=V[K];if(X.item===I||X.props.key===I.key||z===ed(X.item.type)&&$===X.childIndex)return X}return null}},{key:"renderClipPath",value:function(){var I=this.clipPathId,z=this.state.offset,$=z.left,V=z.top,K=z.height,te=z.width;return de.createElement("defs",null,de.createElement("clipPath",{id:I},de.createElement("rect",{x:$,y:V,height:K,width:te})))}},{key:"getXScales",value:function(){var I=this.state.xAxisMap;return I?Object.entries(I).reduce(function(z,$){var V=S6($,2),K=V[0],te=V[1];return St(St({},z),{},Gr({},K,te.scale))},{}):null}},{key:"getYScales",value:function(){var I=this.state.yAxisMap;return I?Object.entries(I).reduce(function(z,$){var V=S6($,2),K=V[0],te=V[1];return St(St({},z),{},Gr({},K,te.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(I){var z;return(z=this.state.xAxisMap)===null||z===void 0||(z=z[I])===null||z===void 0?void 0:z.scale}},{key:"getYScaleByAxisId",value:function(I){var z;return(z=this.state.yAxisMap)===null||z===void 0||(z=z[I])===null||z===void 0?void 0:z.scale}},{key:"getItemByXY",value:function(I){var z=this.state,$=z.formattedGraphicalItems,V=z.activeItem;if($&&$.length)for(var K=0,te=$.length;K<te;K++){var X=$[K],ve=X.props,ae=X.item,pe=ae.type.defaultProps!==void 0?St(St({},ae.type.defaultProps),ae.props):ae.props,Oe=ed(ae.type);if(Oe==="Bar"){var Me=(ve.data||[]).find(function(Ce){return AEe(I,Ce)});if(Me)return{graphicalItem:X,payload:Me}}else if(Oe==="RadialBar"){var Xe=(ve.data||[]).find(function(Ce){return K$(I,Ce)});if(Xe)return{graphicalItem:X,payload:Xe}}else if(dP(X,V)||hP(X,V)||mb(X,V)){var Ve=POe({graphicalItem:X,activeTooltipItem:V,itemData:pe.data}),et=pe.activeIndex===void 0?Ve:pe.activeIndex;return{graphicalItem:St(St({},X),{},{childIndex:et}),payload:mb(X,V)?pe.data[Ve]:X.props.data[Ve]}}}return null}},{key:"render",value:function(){var I=this;if(!FF(this))return null;var z=this.props,$=z.children,V=z.className,K=z.width,te=z.height,X=z.style,ve=z.compact,ae=z.title,pe=z.desc,Oe=N6(z,hLe),Me=Cr(Oe,!1);if(ve)return de.createElement(s6,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},de.createElement(tE,$g({},Me,{width:K,height:te,title:ae,desc:pe}),this.renderClipPath(),$F($,this.renderMap)));if(this.props.accessibilityLayer){var Xe,Ve;Me.tabIndex=(Xe=this.props.tabIndex)!==null&&Xe!==void 0?Xe:0,Me.role=(Ve=this.props.role)!==null&&Ve!==void 0?Ve:"application",Me.onKeyDown=function(Ce){I.accessibilityManager.keyboardEvent(Ce)},Me.onFocus=function(){I.accessibilityManager.focus()}}var et=this.parseEventsOfWrapper();return de.createElement(s6,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},de.createElement("div",$g({className:Yr("recharts-wrapper",V),style:St({position:"relative",cursor:"default",width:K,height:te},X)},et,{ref:function(_e){I.container=_e}}),de.createElement(tE,$g({},Me,{width:K,height:te,title:ae,desc:pe,style:kLe}),this.renderClipPath(),$F($,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(R.Component);Gr(k,"displayName",n),Gr(k,"defaultProps",St({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},v)),Gr(k,"getDerivedStateFromProps",function(D,O){var T=D.dataKey,I=D.data,z=D.children,$=D.width,V=D.height,K=D.layout,te=D.stackOffset,X=D.margin,ve=O.dataStartIndex,ae=O.dataEndIndex;if(O.updateId===void 0){var pe=A6(D);return St(St(St({},pe),{},{updateId:0},S(St(St({props:D},pe),{},{updateId:0}),O)),{},{prevDataKey:T,prevData:I,prevWidth:$,prevHeight:V,prevLayout:K,prevStackOffset:te,prevMargin:X,prevChildren:z})}if(T!==O.prevDataKey||I!==O.prevData||$!==O.prevWidth||V!==O.prevHeight||K!==O.prevLayout||te!==O.prevStackOffset||!ex(X,O.prevMargin)){var Oe=A6(D),Me={chartX:O.chartX,chartY:O.chartY,isTooltipActive:O.isTooltipActive},Xe=St(St({},C6(O,I,K)),{},{updateId:O.updateId+1}),Ve=St(St(St({},Oe),Me),Xe);return St(St(St({},Ve),S(St({props:D},Ve),O)),{},{prevDataKey:T,prevData:I,prevWidth:$,prevHeight:V,prevLayout:K,prevStackOffset:te,prevMargin:X,prevChildren:z})}if(!JT(z,O.prevChildren)){var et,Ce,_e,tt,vt=zo(z,ey),gt=vt&&(et=(Ce=vt.props)===null||Ce===void 0?void 0:Ce.startIndex)!==null&&et!==void 0?et:ve,Tt=vt&&(_e=(tt=vt.props)===null||tt===void 0?void 0:tt.endIndex)!==null&&_e!==void 0?_e:ae,Ht=gt!==ve||Tt!==ae,Ir=!Zr(I),Pr=Ir&&!Ht?O.updateId:O.updateId+1;return St(St({updateId:Pr},S(St(St({props:D},O),{},{updateId:Pr,dataStartIndex:gt,dataEndIndex:Tt}),O)),{},{prevChildren:z,dataStartIndex:gt,dataEndIndex:Tt})}return null}),Gr(k,"renderActiveDot",function(D,O,T){var I;return R.isValidElement(D)?I=R.cloneElement(D,O):Br(D)?I=D(O):I=de.createElement(Wy,O),de.createElement(xn,{className:"recharts-active-dot",key:T},I)});var N=R.forwardRef(function(O,T){return de.createElement(k,$g({},O,{ref:T}))});return N.displayName=k.displayName,N},Yb=Zb({chartName:"LineChart",GraphicalChild:Xo,axisComponents:[{axisType:"xAxis",AxisComp:aa},{axisType:"yAxis",AxisComp:Mi}],formatAxisMap:bD}),hy=Zb({chartName:"BarChart",GraphicalChild:Ia,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:aa},{axisType:"yAxis",AxisComp:Mi}],formatAxisMap:bD}),T6=Zb({chartName:"PieChart",GraphicalChild:tu,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:Ky},{axisType:"radiusAxis",AxisComp:Gy}],formatAxisMap:aK,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),zLe=Zb({chartName:"RadarChart",GraphicalChild:Hb,axisComponents:[{axisType:"angleAxis",AxisComp:Ky},{axisType:"radiusAxis",AxisComp:Gy}],formatAxisMap:aK,defaultProps:{layout:"centric",startAngle:90,endAngle:-270,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),kH=Zb({chartName:"AreaChart",GraphicalChild:ru,axisComponents:[{axisType:"xAxis",AxisComp:aa},{axisType:"yAxis",AxisComp:Mi}],formatAxisMap:bD});function $Le(){var X,ve;const{accountNo:e}=AO(),t=br(),[n,s]=R.useState(!1),[i,c]=R.useState({category:"billing",priority:"medium",status:"open"}),[u,a]=R.useState(!1),[m,p]=R.useState(null),[y,v]=R.useState(""),{data:j,isLoading:S}=ht({queryKey:["account-overview",e],queryFn:()=>Is.getAccountOverview(e),enabled:!!e}),{data:k}=ht({queryKey:["account-billing",e],queryFn:()=>Is.getBillingHistory(e,12),enabled:!!e}),{data:N}=ht({queryKey:["account-analytics",e],queryFn:()=>Is.getConsumptionAnalytics(e,12),enabled:!!e}),{data:D}=ht({queryKey:["account-complaints",e],queryFn:()=>Is.getComplaints({account_no:e}),enabled:!!e}),{data:O}=ht({queryKey:["account-notes",e],queryFn:()=>Is.getNotes({account_no:e}),enabled:!!e}),T=jt({mutationFn:ae=>Is.createComplaint(ae),onSuccess:()=>{t.invalidateQueries({queryKey:["account-complaints",e]}),t.invalidateQueries({queryKey:["account-overview",e]}),s(!1),c({category:"billing",priority:"medium",status:"open"}),qe.success("Complaint created successfully")},onError:ae=>{qe.error(ae.message||"Failed to create complaint")}}),I=jt({mutationFn:({id:ae,data:pe})=>Is.updateComplaint(ae,pe),onSuccess:()=>{t.invalidateQueries({queryKey:["account-complaints",e]}),t.invalidateQueries({queryKey:["account-overview",e]}),qe.success("Complaint updated successfully")},onError:ae=>{qe.error(ae.message||"Failed to update complaint")}}),z=jt({mutationFn:ae=>Is.createNote(ae),onSuccess:()=>{t.invalidateQueries({queryKey:["account-notes",e]}),a(!1),v(""),qe.success("Note created successfully")},onError:ae=>{qe.error(ae.message||"Failed to create note")}}),$=jt({mutationFn:({id:ae,data:pe})=>Is.updateNote(ae,pe),onSuccess:()=>{t.invalidateQueries({queryKey:["account-notes",e]}),a(!1),p(null),v(""),qe.success("Note updated successfully")},onError:ae=>{qe.error(ae.message||"Failed to update note")}}),V=jt({mutationFn:ae=>Is.deleteNote(ae),onSuccess:()=>{t.invalidateQueries({queryKey:["account-notes",e]}),qe.success("Note deleted successfully")},onError:ae=>{qe.error(ae.message||"Failed to delete note")}});if(S)return r.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:r.jsx("p",{className:"text-lg",children:"Loading account details..."})});if(!j)return r.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:r.jsx("p",{className:"text-lg text-red-600",children:"Account not found"})});const K=((X=j.balance)==null?void 0:X.balance)||0,te=(N==null?void 0:N.trend)==="increasing"?r.jsx($s,{className:"h-4 w-4 text-orange-600"}):(N==null?void 0:N.trend)==="decreasing"?r.jsx(eo,{className:"h-4 w-4 text-green-600"}):r.jsx(XL,{className:"h-4 w-4 text-gray-600"});return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"text-3xl font-bold",children:["Account ",e]}),r.jsxs("p",{className:"text-muted-foreground",children:[j.customer.first_name," ",j.customer.last_name]})]}),r.jsx(We,{variant:j.connection.status==="active"?"default":"destructive",children:j.connection.status})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Current Balance"}),r.jsx(OO,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:["KES ",K.toLocaleString()]}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:K>0?"Outstanding":"Paid up"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Avg. Consumption"}),te]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:[(N==null?void 0:N.average)||0," m"]}),r.jsxs("p",{className:"text-xs text-muted-foreground mt-1 capitalize",children:["Trend: ",((ve=N==null?void 0:N.trend)==null?void 0:ve.replace("_"," "))||"N/A"]})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Open Cases"}),r.jsx(ei,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:j.active_cases_count}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Revenue Assurance"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Complaints"}),r.jsx(ane,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:j.open_complaints_count}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Open issues"})]})]})]}),r.jsxs(qs,{defaultValue:"summary",className:"w-full",children:[r.jsxs(As,{children:[r.jsx(sr,{value:"summary",children:"Summary"}),r.jsx(sr,{value:"billing",children:"Billing"}),r.jsx(sr,{value:"payments",children:"Payments"}),r.jsx(sr,{value:"reads",children:"Meter Reads"}),r.jsx(sr,{value:"complaints",children:"Complaints"}),r.jsx(sr,{value:"notes",children:"Notes"}),r.jsx(sr,{value:"cases",children:"RA Cases"})]}),r.jsxs(Nr,{value:"summary",className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Customer Information"})}),r.jsxs(ie,{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm font-medium",children:"Name:"}),r.jsxs("span",{className:"text-sm",children:[j.customer.first_name," ",j.customer.last_name]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm font-medium",children:"ID Number:"}),r.jsx("span",{className:"text-sm",children:j.customer.id_number})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm font-medium",children:"Phone:"}),r.jsx("span",{className:"text-sm",children:j.customer.phone})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm font-medium",children:"Email:"}),r.jsx("span",{className:"text-sm",children:j.customer.email||"N/A"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm font-medium",children:"Type:"}),r.jsx(We,{variant:"outline",children:j.customer.customer_type})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Premise Details"})}),r.jsxs(ie,{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm font-medium",children:"Address:"}),r.jsx("span",{className:"text-sm",children:j.premise.address})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm font-medium",children:"Category:"}),r.jsx(We,{variant:"outline",children:j.premise.category})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm font-medium",children:"Connection Date:"}),r.jsx("span",{className:"text-sm",children:new Date(j.connection.connected_at).toLocaleDateString()})]}),j.latest_meter&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm font-medium",children:"Meter No:"}),r.jsx("span",{className:"text-sm",children:j.latest_meter.meter_no})]})]})]})]}),j.balance&&j.balance.balance>0&&r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Balance Aging"})}),r.jsx(ie,{children:r.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Current"}),r.jsxs("p",{className:"text-lg font-bold",children:["KES ",j.balance.current.toLocaleString()]})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"1-30 Days"}),r.jsxs("p",{className:"text-lg font-bold",children:["KES ",j.balance.days_30.toLocaleString()]})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"31-60 Days"}),r.jsxs("p",{className:"text-lg font-bold",children:["KES ",j.balance.days_60.toLocaleString()]})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"61-90 Days"}),r.jsxs("p",{className:"text-lg font-bold",children:["KES ",j.balance.days_90.toLocaleString()]})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Over 90 Days"}),r.jsxs("p",{className:"text-lg font-bold text-red-600",children:["KES ",j.balance.over_90.toLocaleString()]})]})]})})]}),N&&N.consumption.length>0&&r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Xu,{className:"h-5 w-5"}),"Consumption Trends (Last 12 Months)"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"h-[300px]",children:r.jsx(Da,{width:"100%",height:"100%",children:r.jsxs(Yb,{data:N.consumption.map(ae=>({month:new Date(ae.period_start).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),consumption:ae.consumption})),margin:{top:5,right:20,bottom:5,left:0},children:[r.jsx(wo,{strokeDasharray:"3 3",className:"stroke-muted"}),r.jsx(aa,{dataKey:"month",className:"text-xs",tick:{fill:"hsl(var(--muted-foreground))"}}),r.jsx(Mi,{className:"text-xs",tick:{fill:"hsl(var(--muted-foreground))"},label:{value:"m",angle:-90,position:"insideLeft",fill:"hsl(var(--muted-foreground))"}}),r.jsx(Ds,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"6px"},labelStyle:{color:"hsl(var(--foreground))"}}),r.jsx(Xo,{type:"monotone",dataKey:"consumption",stroke:"hsl(var(--primary))",strokeWidth:2,dot:{fill:"hsl(var(--primary))",r:4},activeDot:{r:6}})]})})}),r.jsxs("div",{className:"mt-4 flex items-center justify-between text-sm",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-muted-foreground",children:"Average:"}),r.jsxs("span",{className:"font-semibold",children:[N.average," m/month"]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-muted-foreground",children:"Trend:"}),r.jsxs(We,{variant:N.trend==="increasing"?"destructive":N.trend==="decreasing"?"default":"secondary",children:[N.trend==="increasing"&&r.jsx($s,{className:"h-3 w-3 mr-1"}),N.trend==="decreasing"&&r.jsx(eo,{className:"h-3 w-3 mr-1"}),N.trend==="stable"&&r.jsx(XL,{className:"h-3 w-3 mr-1"}),N.trend.replace("_"," ")]})]})]})]})]})]}),r.jsx(Nr,{value:"billing",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Recent Invoices"})}),r.jsx(ie,{children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Period"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Amount"}),r.jsx(le,{children:"Due Date"})]})}),r.jsx(ur,{children:k==null?void 0:k.invoices.map(ae=>r.jsxs(lt,{children:[r.jsxs(ne,{children:[new Date(ae.period_start).toLocaleDateString()," -"," ",new Date(ae.period_end).toLocaleDateString()]}),r.jsx(ne,{children:r.jsx(We,{variant:ae.status==="paid"?"default":"secondary",children:ae.status})}),r.jsxs(ne,{children:["KES ",ae.total_amount.toLocaleString()]}),r.jsx(ne,{children:new Date(ae.due_at).toLocaleDateString()})]},ae.id))})]})})]})}),r.jsx(Nr,{value:"payments",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Payment History"})}),r.jsx(ie,{children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Date"}),r.jsx(le,{children:"Amount"}),r.jsx(le,{children:"Channel"}),r.jsx(le,{children:"Reference"})]})}),r.jsx(ur,{children:k==null?void 0:k.payments.map(ae=>r.jsxs(lt,{children:[r.jsx(ne,{children:new Date(ae.paid_at).toLocaleDateString()}),r.jsxs(ne,{children:["KES ",ae.amount.toLocaleString()]}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:ae.channel})}),r.jsx(ne,{className:"font-mono text-sm",children:ae.reference})]},ae.id))})]})})]})}),r.jsx(Nr,{value:"reads",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Recent Meter Reads"})}),r.jsx(ie,{children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Date"}),r.jsx(le,{children:"Reading"}),r.jsx(le,{children:"Consumption"}),r.jsx(le,{children:"Quality"}),r.jsx(le,{children:"Source"})]})}),r.jsx(ur,{children:j.recent_reads.map((ae,pe)=>{const Oe=pe>0?j.recent_reads[pe-1]:null,Me=Oe?ae.value-Oe.value:null;return r.jsxs(lt,{children:[r.jsx(ne,{children:new Date(ae.read_at).toLocaleDateString()}),r.jsxs(ne,{children:[ae.value," m"]}),r.jsx(ne,{children:Me!==null?`${Me} m`:"-"}),r.jsx(ne,{children:r.jsx(We,{variant:ae.quality==="good"?"default":"secondary",children:ae.quality})}),r.jsx(ne,{children:ae.source})]},ae.id)})})]})})]})}),r.jsx(Nr,{value:"complaints",children:r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between",children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Cx,{className:"h-5 w-5"}),"Customer Complaints"]}),r.jsxs(Rr,{open:n,onOpenChange:s,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{size:"sm",children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"Log Complaint"]})}),r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Log New Complaint"})}),r.jsxs("div",{className:"space-y-4 py-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{children:"Category"}),r.jsxs(Jt,{value:i.category,onValueChange:ae=>c({...i,category:ae}),children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"billing",children:"Billing"}),r.jsx(ke,{value:"water_quality",children:"Water Quality"}),r.jsx(ke,{value:"supply",children:"Supply Issue"}),r.jsx(ke,{value:"meter",children:"Meter Problem"}),r.jsx(ke,{value:"leak",children:"Leak Report"}),r.jsx(ke,{value:"customer_service",children:"Customer Service"}),r.jsx(ke,{value:"other",children:"Other"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{children:"Priority"}),r.jsxs(Jt,{value:i.priority,onValueChange:ae=>c({...i,priority:ae}),children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"low",children:"Low"}),r.jsx(ke,{value:"medium",children:"Medium"}),r.jsx(ke,{value:"high",children:"High"}),r.jsx(ke,{value:"critical",children:"Critical"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{children:"Description"}),r.jsx(Fs,{placeholder:"Describe the issue...",value:i.description||"",onChange:ae=>c({...i,description:ae.target.value}),rows:4})]})]}),r.jsxs(Ai,{children:[r.jsx(se,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),r.jsx(se,{onClick:()=>{T.mutate({...i,account_no:e,customer_id:j==null?void 0:j.customer.id})},disabled:!i.description||T.isPending,children:T.isPending?"Creating...":"Create Complaint"})]})]})]})]}),r.jsx(ie,{children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"ID"}),r.jsx(le,{children:"Category"}),r.jsx(le,{children:"Priority"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Created"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:D!=null&&D.data&&D.data.length>0?D.data.map(ae=>r.jsxs(lt,{children:[r.jsxs(ne,{className:"font-mono text-sm",children:["#",ae.id]}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:ae.category.replace("_"," ")})}),r.jsx(ne,{children:r.jsx(We,{variant:ae.priority==="critical"?"destructive":ae.priority==="high"?"default":"secondary",children:ae.priority})}),r.jsx(ne,{children:r.jsx(We,{variant:ae.status==="resolved"||ae.status==="closed"?"default":"secondary",children:ae.status})}),r.jsx(ne,{children:new Date(ae.created_at).toLocaleDateString()}),r.jsx(ne,{children:ae.status==="open"&&r.jsx(se,{size:"sm",variant:"outline",onClick:()=>I.mutate({id:ae.id,data:{status:"triage"}}),children:"Triage"})})]},ae.id)):r.jsx(lt,{children:r.jsx(ne,{colSpan:6,className:"text-center text-muted-foreground",children:"No complaints found for this account"})})})]})})]})}),r.jsx(Nr,{value:"notes",children:r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between",children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(is,{className:"h-5 w-5"}),"Account Notes"]}),r.jsxs(Rr,{open:u,onOpenChange:ae=>{a(ae),ae||(p(null),v(""))},children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{size:"sm",children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"Add Note"]})}),r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:m?"Edit Note":"Add New Note"})}),r.jsx("div",{className:"space-y-4 py-4",children:r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{children:"Note Content"}),r.jsx(Fs,{placeholder:"Enter your note here...",value:y,onChange:ae=>v(ae.target.value),rows:6})]})}),r.jsxs(Ai,{children:[r.jsx(se,{variant:"outline",onClick:()=>{a(!1),p(null),v("")},children:"Cancel"}),r.jsx(se,{onClick:()=>{m?$.mutate({id:m.id,data:{content:y}}):z.mutate({account_no:e,customer_id:j==null?void 0:j.customer.id,content:y})},disabled:!y.trim()||z.isPending||$.isPending,children:z.isPending||$.isPending?"Saving...":m?"Update Note":"Add Note"})]})]})]})]}),r.jsx(ie,{children:r.jsx("div",{className:"space-y-4",children:O!=null&&O.data&&O.data.length>0?O.data.map(ae=>{var pe;return r.jsx("div",{className:"border rounded-lg p-4 space-y-2 hover:bg-muted/50 transition-colors",children:r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{className:"flex-1 space-y-1",children:[r.jsx("p",{className:"text-sm whitespace-pre-wrap",children:ae.content}),r.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[r.jsx("span",{children:((pe=ae.createdBy)==null?void 0:pe.name)||"Unknown"}),r.jsx("span",{children:""}),r.jsx("span",{children:new Date(ae.created_at).toLocaleString()}),ae.updated_at!==ae.created_at&&r.jsxs(r.Fragment,{children:[r.jsx("span",{children:""}),r.jsx("span",{className:"italic",children:"edited"})]})]})]}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx(se,{size:"sm",variant:"ghost",onClick:()=>{p(ae),v(ae.content),a(!0)},children:r.jsx(IO,{className:"h-3 w-3"})}),r.jsx(se,{size:"sm",variant:"ghost",onClick:()=>{window.confirm("Are you sure you want to delete this note?")&&V.mutate(ae.id)},disabled:V.isPending,children:r.jsx(Oi,{className:"h-3 w-3"})})]})]})},ae.id)}):r.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[r.jsx(is,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),r.jsx("p",{children:"No notes found for this account"}),r.jsx("p",{className:"text-sm",children:"Add a note to keep track of important information"})]})})})]})}),r.jsx(Nr,{value:"cases",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Revenue Assurance Cases"})}),r.jsx(ie,{children:r.jsxs("p",{className:"text-sm text-muted-foreground",children:[j.active_cases_count," active case(s) for this account"]})})]})})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs(Rr,{children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{variant:"outline",className:"w-full",children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"Move-In"]})}),r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Process Move-In"})}),r.jsxs("div",{className:"space-y-4 py-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{children:"Move-In Date"}),r.jsx("input",{type:"date",className:"w-full border rounded px-3 py-2"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{children:"Initial Meter Reading (m)"}),r.jsx("input",{type:"number",placeholder:"0.00",className:"w-full border rounded px-3 py-2"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{children:"Notes"}),r.jsx(Fs,{placeholder:"Any special notes...",rows:3})]})]}),r.jsxs(Ai,{children:[r.jsx(se,{variant:"outline",children:"Cancel"}),r.jsx(se,{onClick:()=>qe.success("Move-in processed successfully"),children:"Complete Move-In"})]})]})]}),r.jsxs(Rr,{children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{variant:"outline",className:"w-full",children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"Move-Out"]})}),r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Process Move-Out"})}),r.jsxs("div",{className:"space-y-4 py-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{children:"Move-Out Date"}),r.jsx("input",{type:"date",className:"w-full border rounded px-3 py-2"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{children:"Final Meter Reading (m)"}),r.jsx("input",{type:"number",placeholder:"0.00",className:"w-full border rounded px-3 py-2"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{children:"Account Status After Move-Out"}),r.jsxs("select",{className:"w-full border rounded px-3 py-2",children:[r.jsx("option",{children:"Disconnected"}),r.jsx("option",{children:"Suspended"}),r.jsx("option",{children:"Closed"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{children:"Notes"}),r.jsx(Fs,{placeholder:"Outstanding balance notes, forwarding address, etc...",rows:3})]})]}),r.jsxs(Ai,{children:[r.jsx(se,{variant:"outline",children:"Cancel"}),r.jsx(se,{onClick:()=>qe.success("Move-out processed successfully"),className:"bg-orange-600 hover:bg-orange-700",children:"Complete Move-Out"})]})]})]})]})]})}function BLe(){const[e,t]=R.useState(""),n=vy(),s=i=>{i.preventDefault(),e.trim()&&n(`/crm/accounts/${e.trim()}`)};return r.jsx("div",{className:"max-w-2xl mx-auto mt-16",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Account 360 Search"})}),r.jsx(ie,{children:r.jsxs("form",{onSubmit:s,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Enter Account Number"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(Ge,{placeholder:"e.g., ACC-001",value:e,onChange:i=>t(i.target.value),className:"flex-1"}),r.jsxs(se,{type:"submit",disabled:!e.trim(),children:[r.jsx(ci,{className:"h-4 w-4 mr-2"}),"Search"]})]})]}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter a customer account number to view complete account details, billing history, consumption analytics, and revenue assurance cases."})]})})]})})}const qLe=["all","open","triage","field","resolved","closed"],VLe=["all","low","medium","high","critical"],ULe=["all","billing","water_quality","supply","meter","leak","customer_service","other"];function WLe(){const e=br(),[t,n]=R.useState(""),[s,i]=R.useState("all"),[c,u]=R.useState("all"),[a,m]=R.useState("all"),[p,y]=R.useState("list"),{data:v,isLoading:j,isError:S,error:k}=ht({queryKey:["complaints",t,s,c,a],queryFn:()=>{const z={};return t&&(z.search=t),s!=="all"&&(z.status=s),c!=="all"&&(z.priority=c),a!=="all"&&(z.category=a),Is.getComplaints(z)}}),N=jt({mutationFn:({id:z,data:$})=>Is.updateComplaint(z,$),onSuccess:()=>{e.invalidateQueries({queryKey:["complaints"]}),qe.success("Complaint updated successfully")},onError:z=>{qe.error(z.message||"Failed to update complaint")}}),D=(v==null?void 0:v.data)||[],O=z=>z==="resolved"||z==="closed"?"default":z==="field"?"secondary":"outline",T=z=>z==="critical"?"destructive":z==="high"?"default":"secondary",I=D.reduce((z,$)=>(z[$.status]||(z[$.status]=[]),z[$.status].push($),z),{});return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Customer Complaints"}),r.jsx("p",{className:"text-muted-foreground",children:"Manage and track customer service complaints"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:p==="list"?"default":"outline",onClick:()=>y("list"),size:"sm",children:"List View"}),r.jsx(se,{variant:p==="kanban"?"default":"outline",onClick:()=>y("kanban"),size:"sm",children:"Kanban Board"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[r.jsxs("div",{className:"flex-1 relative",children:[r.jsx(ci,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Search complaints by account, description...",value:t,onChange:z=>n(z.target.value),className:"pl-10"})]}),r.jsxs("div",{className:"flex gap-2 flex-wrap",children:[r.jsxs(Jt,{value:s,onValueChange:z=>i(z),children:[r.jsx(Yt,{className:"w-[150px]",children:r.jsx(er,{placeholder:"Status"})}),r.jsx(Xt,{children:qLe.map(z=>r.jsx(ke,{value:z,children:z==="all"?"All Status":z.replace("_"," ")},z))})]}),r.jsxs(Jt,{value:c,onValueChange:z=>u(z),children:[r.jsx(Yt,{className:"w-[150px]",children:r.jsx(er,{placeholder:"Priority"})}),r.jsx(Xt,{children:VLe.map(z=>r.jsx(ke,{value:z,children:z==="all"?"All Priority":z},z))})]}),r.jsxs(Jt,{value:a,onValueChange:z=>m(z),children:[r.jsx(Yt,{className:"w-[180px]",children:r.jsx(er,{placeholder:"Category"})}),r.jsx(Xt,{children:ULe.map(z=>r.jsx(ke,{value:z,children:z==="all"?"All Categories":z.replace("_"," ")},z))})]})]})]})}),r.jsx(ie,{children:j?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading complaints..."}):S?r.jsxs("div",{className:"text-center py-8",children:[r.jsx(ei,{className:"h-12 w-12 mx-auto mb-2 text-destructive opacity-50"}),r.jsx("p",{className:"text-destructive font-semibold",children:"Failed to load complaints"}),r.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:(k==null?void 0:k.message)||"An error occurred while fetching complaints"})]}):p==="list"?r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"ID"}),r.jsx(le,{children:"Account"}),r.jsx(le,{children:"Category"}),r.jsx(le,{children:"Priority"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Created"}),r.jsx(le,{children:"Description"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:D.length>0?D.map(z=>r.jsxs(lt,{children:[r.jsxs(ne,{className:"font-mono text-sm",children:["#",z.id]}),r.jsx(ne,{children:r.jsxs(mc,{to:`/crm/accounts/${z.account_no}`,className:"text-blue-600 hover:underline flex items-center gap-1",children:[z.account_no,r.jsx(qre,{className:"h-3 w-3"})]})}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:z.category.replace("_"," ")})}),r.jsx(ne,{children:r.jsx(We,{variant:T(z.priority),children:z.priority})}),r.jsx(ne,{children:r.jsx(We,{variant:O(z.status),children:z.status})}),r.jsx(ne,{className:"text-sm",children:new Date(z.created_at).toLocaleDateString()}),r.jsx(ne,{className:"max-w-xs truncate",children:z.description}),r.jsxs(ne,{children:[z.status==="open"&&r.jsx(se,{size:"sm",variant:"outline",disabled:N.isPending,onClick:()=>N.mutate({id:z.id,data:{status:"triage"}}),children:N.isPending?"Updating...":"Triage"}),z.status==="triage"&&r.jsx(se,{size:"sm",variant:"outline",disabled:N.isPending,onClick:()=>N.mutate({id:z.id,data:{status:"field"}}),children:N.isPending?"Updating...":"Send to Field"})]})]},z.id)):r.jsx(lt,{children:r.jsx(ne,{colSpan:8,className:"text-center text-muted-foreground",children:"No complaints found"})})})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:["open","triage","field","resolved","closed"].map(z=>{var $,V;return r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"font-semibold capitalize",children:z.replace("_"," ")}),r.jsx(We,{variant:"secondary",children:(($=I[z])==null?void 0:$.length)||0})]}),r.jsx("div",{className:"space-y-2",children:((V=I[z])==null?void 0:V.map(K=>r.jsx(J,{className:"p-3 hover:shadow-md transition-shadow",children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("span",{className:"text-xs font-mono text-muted-foreground",children:["#",K.id]}),r.jsx(We,{variant:T(K.priority),className:"text-xs",children:K.priority})]}),r.jsx(mc,{to:`/crm/accounts/${K.account_no}`,className:"text-sm font-medium hover:underline block",children:K.account_no}),r.jsx(We,{variant:"outline",className:"text-xs",children:K.category.replace("_"," ")}),r.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:K.description}),r.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(K.created_at).toLocaleDateString()})]})},K.id)))||r.jsx("div",{className:"text-center text-sm text-muted-foreground py-4",children:"No complaints"})})]},z)})})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Summary"})}),r.jsx(ie,{children:r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Complaints"}),r.jsx("p",{className:"text-2xl font-bold",children:D.length})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Open"}),r.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:D.filter(z=>z.status==="open").length})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"In Progress"}),r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:D.filter(z=>["triage","field"].includes(z.status)).length})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Resolved"}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:D.filter(z=>["resolved","closed"].includes(z.status)).length})]})]})})]})]})}const ak=["phone","email","sms","web_portal","walk_in","field_visit"],GLe={phone:uS,email:Qq,sms:Jre,web_portal:Px,walk_in:jo,field_visit:jo};function KLe(){const e=br(),[t,n]=R.useState(""),[s,i]=R.useState("all"),[c,u]=R.useState(!1),[a,m]=R.useState({account_no:"",channel:"phone",subject:"",message:""}),{data:p,isLoading:y}=ht({queryKey:["interactions",t,s],queryFn:()=>{const N={per_page:100};return t&&(N.search=t),s!=="all"&&(N.channel=s),Is.getInteractions(N)}}),v=jt({mutationFn:N=>Is.createInteraction(N),onSuccess:()=>{e.invalidateQueries({queryKey:["interactions"]}),u(!1),m({account_no:"",channel:"phone",subject:"",message:""}),qe.success("Interaction logged successfully")},onError:N=>{qe.error(N.message||"Failed to log interaction")}}),j=(p==null?void 0:p.data)||[],S=N=>{const D=GLe[N]||Cx;return r.jsx(D,{className:"h-4 w-4"})},k=N=>({phone:"bg-blue-100 text-blue-800",email:"bg-purple-100 text-purple-800",sms:"bg-green-100 text-green-800",web_portal:"bg-orange-100 text-orange-800",walk_in:"bg-yellow-100 text-yellow-800",field_visit:"bg-red-100 text-red-800"})[N]||"bg-gray-100 text-gray-800";return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Customer Interactions"}),r.jsx("p",{className:"text-muted-foreground",children:"Log and track all customer touchpoints"})]}),r.jsxs(Rr,{open:c,onOpenChange:u,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"Log Interaction"]})}),r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Log New Interaction"})}),r.jsxs("div",{className:"space-y-4 py-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{children:"Account Number"}),r.jsx(Ge,{placeholder:"e.g., ACC-12345",value:a.account_no,onChange:N=>m({...a,account_no:N.target.value})})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{children:"Channel"}),r.jsxs(Jt,{value:a.channel,onValueChange:N=>m({...a,channel:N}),children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsx(Xt,{children:ak.map(N=>r.jsx(ke,{value:N,children:N.replace("_"," ")},N))})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{children:"Subject"}),r.jsx(Ge,{placeholder:"Brief subject",value:a.subject,onChange:N=>m({...a,subject:N.target.value})})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{children:"Message"}),r.jsx(Fs,{placeholder:"Interaction details",value:a.message,onChange:N=>m({...a,message:N.target.value}),rows:4})]})]}),r.jsxs(Ai,{children:[r.jsx(se,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),r.jsx(se,{onClick:()=>v.mutate(a),disabled:!a.account_no||!a.subject||!a.message||v.isPending,children:v.isPending?"Logging...":"Log Interaction"})]})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex gap-4 items-center",children:[r.jsxs("div",{className:"flex-1 relative",children:[r.jsx(ci,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Search by account number or subject...",value:t,onChange:N=>n(N.target.value),className:"pl-10"})]}),r.jsxs(Jt,{value:s,onValueChange:N=>i(N),children:[r.jsx(Yt,{className:"w-[150px]",children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Channels"}),ak.map(N=>r.jsx(ke,{value:N,children:N.replace("_"," ")},N))]})]})]})}),r.jsx(ie,{children:y?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading interactions..."}):j.length>0?r.jsx("div",{className:"space-y-3",children:j.map(N=>r.jsx("div",{className:"border rounded-lg p-4 hover:bg-muted/50 transition-colors",children:r.jsx("div",{className:"flex items-start justify-between gap-4",children:r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`p-2 rounded-lg ${k(N.channel)}`,children:S(N.channel)}),r.jsxs("div",{children:[r.jsx(mc,{to:`/crm/accounts/${N.account_no}`,className:"font-semibold hover:underline text-blue-600",children:N.account_no}),r.jsx("p",{className:"text-sm text-muted-foreground",children:N.subject})]})]}),r.jsx("p",{className:"text-sm leading-relaxed",children:N.message}),r.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[r.jsx(We,{variant:"outline",className:"text-xs",children:N.channel.replace("_"," ")}),r.jsx("span",{children:new Date(N.created_at).toLocaleString()})]})]})})},N.id))}):r.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[r.jsx(Cx,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),r.jsx("p",{children:"No interactions found"})]})})]}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:ak.map(N=>r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:r.jsxs("div",{className:"flex flex-col items-center gap-2",children:[r.jsx("div",{className:`p-3 rounded-lg ${k(N)}`,children:S(N)}),r.jsx("p",{className:"text-sm font-medium capitalize",children:N.replace("_"," ")}),r.jsx("p",{className:"text-2xl font-bold",children:j.filter(D=>D.channel===N).length})]})})},N))})]})}function HLe(){const[e,t]=R.useState({residential:!1,commercial:!1,industrial:!1,public:!1}),[n,s]=R.useState({min:0,max:1e5}),[i,c]=R.useState({min:0,max:1e4}),[u,a]=R.useState("active"),[m,p]=R.useState(""),{data:y}=ht({queryKey:["customers",{per_page:1e3}],queryFn:()=>Is.getCustomers({per_page:1e3})}),v=(y==null?void 0:y.data)||[],j=v.filter(D=>Object.values(e).some(T=>T)===!1||e[D.customer_type]),S=[{id:"residential",label:"Residential",count:v.filter(D=>D.customer_type==="residential").length,color:"bg-blue-100 text-blue-800"},{id:"commercial",label:"Commercial",count:v.filter(D=>D.customer_type==="commercial").length,color:"bg-purple-100 text-purple-800"},{id:"industrial",label:"Industrial",count:v.filter(D=>D.customer_type==="industrial").length,color:"bg-orange-100 text-orange-800"},{id:"public",label:"Public",count:v.filter(D=>D.customer_type==="public").length,color:"bg-green-100 text-green-800"}],k=()=>{if(!m.trim()){qe.error("Please enter a segment name");return}qe.success(`Segment "${m}" created with ${j.length} customers`),p("")},N=()=>{const D=[["Account","Name","Type","Phone","Email"],...j.map(z=>[z.id,`${z.first_name} ${z.last_name}`,z.customer_type,z.phone,z.email||""])].map(z=>z.map($=>`"${$}"`).join(",")).join(`
`),O=new Blob([D],{type:"text/csv"}),T=window.URL.createObjectURL(O),I=document.createElement("a");I.href=T,I.download=`segment-${Date.now()}.csv`,I.click(),qe.success("Segment exported successfully")};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Customer Segmentation"}),r.jsx("p",{className:"text-muted-foreground",children:"Create and manage customer segments for targeted campaigns"})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsx("div",{className:"lg:col-span-1",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Gre,{className:"h-5 w-5"}),"Segment Filters"]})}),r.jsxs(ie,{className:"space-y-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("h3",{className:"font-semibold",children:"Customer Type"}),S.map(D=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ey,{id:D.id,checked:e[D.id],onCheckedChange:O=>t({...e,[D.id]:O===!0})}),r.jsx(Ne,{htmlFor:D.id,className:"cursor-pointer flex-1",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{children:D.label}),r.jsx(We,{variant:"secondary",children:D.count})]})})]},D.id))]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("h3",{className:"font-semibold",children:"Status"}),r.jsxs(Jt,{value:u,onValueChange:a,children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Statuses"}),r.jsx(ke,{value:"active",children:"Active"}),r.jsx(ke,{value:"suspended",children:"Suspended"}),r.jsx(ke,{value:"disconnected",children:"Disconnected"})]})]})]}),r.jsx("div",{className:"space-y-3",children:r.jsxs("div",{children:[r.jsx(Ne,{children:"Balance Range (KES)"}),r.jsxs("div",{className:"flex gap-2 mt-2",children:[r.jsx(Ge,{type:"number",placeholder:"Min",value:n.min,onChange:D=>s({...n,min:Number(D.target.value)})}),r.jsx(Ge,{type:"number",placeholder:"Max",value:n.max,onChange:D=>s({...n,max:Number(D.target.value)})})]})]})}),r.jsx("div",{className:"space-y-3",children:r.jsxs("div",{children:[r.jsx(Ne,{children:"Segment Name"}),r.jsx(Ge,{placeholder:"e.g., High-Value Residential",value:m,onChange:D=>p(D.target.value),className:"mt-2"})]})}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(se,{onClick:k,className:"w-full",children:[r.jsx(RO,{className:"h-4 w-4 mr-2"}),"Save Segment"]}),r.jsxs(se,{onClick:N,variant:"outline",className:"w-full",children:[r.jsx(rl,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})]})]})}),r.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Segment Overview"}),r.jsxs(We,{children:[j.length," customers"]})]})}),r.jsx(ie,{children:r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:S.map(D=>r.jsxs("div",{className:`p-4 rounded-lg ${D.color}`,children:[r.jsx("p",{className:"text-sm font-medium opacity-80",children:D.label}),r.jsx("p",{className:"text-2xl font-bold mt-1",children:j.filter(O=>O.customer_type===D.id).length})]},D.id))})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Xu,{className:"h-5 w-5"}),"Segment Statistics"]})}),r.jsx(ie,{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Customers"}),r.jsx("p",{className:"text-3xl font-bold",children:j.length})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Percentage of All"}),r.jsxs("p",{className:"text-3xl font-bold",children:[v.length>0?(j.length/v.length*100).toFixed(1):0,"%"]})]})]})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Sample Customers in Segment"})}),r.jsx(ie,{children:r.jsxs("div",{className:"space-y-2 max-h-80 overflow-y-auto",children:[j.slice(0,10).map(D=>r.jsxs("div",{className:"border rounded p-2 text-sm",children:[r.jsxs("p",{className:"font-medium",children:[D.first_name," ",D.last_name]}),r.jsx("p",{className:"text-muted-foreground",children:D.phone})]},D.id)),j.length>10&&r.jsxs("p",{className:"text-sm text-muted-foreground pt-2",children:["+",j.length-10," more customers"]})]})})]})]})]})]})}const TH={low:"bg-gray-100 text-gray-800",medium:"bg-blue-100 text-blue-800",high:"bg-orange-100 text-orange-800",critical:"bg-red-100 text-red-800"},EH={new:"bg-purple-100 text-purple-800",triage:"bg-blue-100 text-blue-800",field:"bg-orange-100 text-orange-800",resolved:"bg-green-100 text-green-800",closed_valid:"bg-gray-100 text-gray-800",closed_false_positive:"bg-gray-100 text-gray-800"};function ZLe(){const[e,t]=R.useState(null),[n,s]=R.useState(""),[i,c]=R.useState(null),u=br(),{data:a,isLoading:m}=ht({queryKey:["ra-high-priority"],queryFn:()=>Is.getHighPriorityCases(10)}),{data:p,isLoading:y}=ht({queryKey:["ra-cases"],queryFn:()=>Is.getRaCases()}),v=jt({mutationFn:({caseId:T,decision:I,notes:z})=>Is.triageCase(T,{decision:I,notes:z}),onSuccess:()=>{u.invalidateQueries({queryKey:["ra-cases"]}),u.invalidateQueries({queryKey:["ra-high-priority"]}),qe.success("Case triaged successfully"),t(null),s(""),c(null)},onError:T=>{qe.error(`Triage failed: ${T.message}`)}}),j=()=>{!e||!i||v.mutate({caseId:e.id,decision:i,notes:n})},S=T=>{t(T),s(""),c(null)};if(y)return r.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:r.jsx("p",{className:"text-lg",children:"Loading RA cases..."})});const k=(p==null?void 0:p.data)||[],N=k.filter(T=>T.status==="new"),D=k.filter(T=>T.status==="triage"),O=k.filter(T=>T.status==="field");return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Revenue Assurance Console"}),r.jsx("p",{className:"text-muted-foreground",children:"Monitor and triage revenue leakage cases"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"New Cases"}),r.jsx(gn,{className:"h-4 w-4 text-orange-600"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:N.length}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting triage"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"In Triage"}),r.jsx(xs,{className:"h-4 w-4 text-blue-600"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:D.length}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Under review"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Field Investigation"}),r.jsx($s,{className:"h-4 w-4 text-purple-600"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:O.length}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Active investigations"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Total Active"}),r.jsx(gn,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:k.length}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"All cases"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"High Priority Cases"})}),r.jsx(ie,{children:m?r.jsx("p",{className:"text-muted-foreground",children:"Loading..."}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Account"}),r.jsx(le,{children:"Priority"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Detected"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:(a==null?void 0:a.data.length)===0?r.jsx(lt,{children:r.jsx(ne,{colSpan:5,className:"text-center text-muted-foreground",children:"No high-priority cases"})}):a==null?void 0:a.data.map(T=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:T.account_no}),r.jsx(ne,{children:r.jsx(We,{className:TH[T.priority],children:T.priority})}),r.jsx(ne,{children:r.jsx(We,{className:EH[T.status],children:T.status})}),r.jsx(ne,{children:new Date(T.detected_at).toLocaleDateString()}),r.jsx(ne,{children:T.status==="new"&&r.jsx(se,{variant:"outline",size:"sm",onClick:()=>S(T),disabled:v.isPending,children:v.isPending?"Processing...":"Triage"})})]},T.id))})]})})]}),r.jsxs(qs,{defaultValue:"all",children:[r.jsxs(As,{children:[r.jsxs(sr,{value:"all",children:["All Cases (",k.length,")"]}),r.jsxs(sr,{value:"new",children:["New (",N.length,")"]}),r.jsxs(sr,{value:"triage",children:["Triage (",D.length,")"]}),r.jsxs(sr,{value:"field",children:["Field (",O.length,")"]})]}),r.jsx(Nr,{value:"all",children:r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:y?r.jsx("p",{className:"text-muted-foreground",children:"Loading cases..."}):r.jsx(m1,{cases:k,onTriage:S})})})}),r.jsx(Nr,{value:"new",children:r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:r.jsx(m1,{cases:N,onTriage:S})})})}),r.jsx(Nr,{value:"triage",children:r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:r.jsx(m1,{cases:D,onTriage:S})})})}),r.jsx(Nr,{value:"field",children:r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:r.jsx(m1,{cases:O,onTriage:S})})})})]}),r.jsx(Rr,{open:!!e,onOpenChange:()=>t(null),children:r.jsxs(Er,{children:[r.jsxs(Mr,{children:[r.jsxs(Or,{children:["Triage Case #",e==null?void 0:e.id]}),r.jsxs(Bs,{children:["Account: ",e==null?void 0:e.account_no]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{children:"Evidence"}),r.jsx("pre",{className:"mt-2 p-3 bg-muted rounded text-xs overflow-auto max-h-40",children:JSON.stringify(e==null?void 0:e.evidence,null,2)})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Decision"}),r.jsxs("div",{className:"flex gap-2 mt-2",children:[r.jsxs(se,{variant:i==="field"?"default":"outline",onClick:()=>c("field"),children:[r.jsx(os,{className:"h-4 w-4 mr-2"}),"Send to Field"]}),r.jsxs(se,{variant:i==="false_positive"?"default":"outline",onClick:()=>c("false_positive"),children:[r.jsx(yd,{className:"h-4 w-4 mr-2"}),"False Positive"]})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"notes",children:"Notes"}),r.jsx(Fs,{id:"notes",value:n,onChange:T=>s(T.target.value),placeholder:"Add notes about this decision...",rows:4})]})]}),r.jsxs(Ai,{children:[r.jsx(se,{variant:"outline",onClick:()=>t(null),children:"Cancel"}),r.jsx(se,{onClick:j,disabled:!i||v.isPending,children:v.isPending?"Submitting...":"Submit Triage"})]})]})})]})}function m1({cases:e,onTriage:t}){return e.length===0?r.jsx("p",{className:"text-center text-muted-foreground",children:"No cases found"}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"ID"}),r.jsx(le,{children:"Account"}),r.jsx(le,{children:"Priority"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Detected"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:e.map(n=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-mono text-sm",children:n.id}),r.jsx(ne,{className:"font-medium",children:n.account_no}),r.jsx(ne,{children:r.jsx(We,{className:TH[n.priority],children:n.priority})}),r.jsx(ne,{children:r.jsx(We,{className:EH[n.status],children:n.status})}),r.jsx(ne,{children:new Date(n.detected_at).toLocaleDateString()}),r.jsx(ne,{children:n.status==="new"&&r.jsx(se,{variant:"outline",size:"sm",onClick:()=>t(n),children:"Triage"})})]},n.id))})]})}function YLe(){var v,j,S,k,N,D,O;const[e,t]=R.useState(new Set),n=br(),{data:s,isLoading:i}=ht({queryKey:["aging-report"],queryFn:()=>Is.getAgingReport()}),{data:c,isLoading:u}=ht({queryKey:["disconnection-list"],queryFn:()=>Is.getDisconnectionList()}),a=jt({mutationFn:T=>Is.generateDunningNotices(T),onMutate:T=>{t(I=>new Set(I).add(T))},onSuccess:(T,I)=>{t(z=>{const $=new Set(z);return $.delete(I),$}),n.invalidateQueries({queryKey:["aging-report"]}),qe.success("Dunning notices generated successfully")},onError:(T,I)=>{t(z=>{const $=new Set(z);return $.delete(I),$}),qe.error(`Failed to generate notices: ${T.message}`)}}),m=T=>{window.confirm(`Generate dunning notices for ${T} accounts?`)&&a.mutate(T)},p={total_balance:((v=s==null?void 0:s.summary)==null?void 0:v.total_balance)??0,total_accounts:((j=s==null?void 0:s.summary)==null?void 0:j.total_accounts)??0,current:((S=s==null?void 0:s.summary)==null?void 0:S.current)??0,days_30:((k=s==null?void 0:s.summary)==null?void 0:k.days_30)??0,days_60:((N=s==null?void 0:s.summary)==null?void 0:N.days_60)??0,days_90:((D=s==null?void 0:s.summary)==null?void 0:D.days_90)??0,over_90:((O=s==null?void 0:s.summary)==null?void 0:O.over_90)??0},y=(s==null?void 0:s.by_category)||{};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Dunning & Collections"}),r.jsx("p",{className:"text-muted-foreground",children:"Monitor overdue accounts and manage collections"})]}),i?r.jsx("p",{className:"text-muted-foreground",children:"Loading aging report..."}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Total Balance"}),r.jsx(Za,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:["KES ",p.total_balance.toLocaleString()]}),r.jsxs("p",{className:"text-xs text-muted-foreground",children:[p.total_accounts," accounts"]})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Current"}),r.jsx(Pi,{className:"h-4 w-4 text-green-600"})]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:["KES ",p.current.toLocaleString()]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Not overdue"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"1-90 Days"}),r.jsx(gn,{className:"h-4 w-4 text-orange-600"})]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:["KES ",(p.days_30+p.days_60+p.days_90).toLocaleString()]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Overdue"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Over 90 Days"}),r.jsx(eo,{className:"h-4 w-4 text-red-600"})]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold text-red-600",children:["KES ",p.over_90.toLocaleString()]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Critical"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Balance Aging Breakdown"})}),r.jsx(ie,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-6 gap-4 text-sm font-medium text-muted-foreground",children:[r.jsx("div",{children:"Bucket"}),r.jsx("div",{children:"Amount"}),r.jsx("div",{children:"% of Total"}),r.jsx("div",{children:"Count"}),r.jsx("div",{children:"Actions"})]}),r.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-t",children:[r.jsx("div",{className:"font-medium",children:"Current"}),r.jsxs("div",{children:["KES ",p==null?void 0:p.current.toLocaleString()]}),r.jsxs("div",{children:[p!=null&&p.total_balance?(p.current/p.total_balance*100).toFixed(1):0,"%"]}),r.jsx("div",{children:"-"}),r.jsx("div",{children:r.jsx(We,{variant:"outline",children:"No Action"})})]}),r.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-t",children:[r.jsx("div",{className:"font-medium",children:"1-30 Days"}),r.jsxs("div",{children:["KES ",p==null?void 0:p.days_30.toLocaleString()]}),r.jsxs("div",{children:[p!=null&&p.total_balance?(p.days_30/p.total_balance*100).toFixed(1):0,"%"]}),r.jsx("div",{children:"-"}),r.jsx("div",{children:r.jsx(se,{size:"sm",variant:"outline",onClick:()=>m("days_30"),disabled:e.has("days_30"),children:e.has("days_30")?"Generating...":"Reminder Notice"})})]}),r.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-t",children:[r.jsx("div",{className:"font-medium",children:"31-60 Days"}),r.jsxs("div",{children:["KES ",p==null?void 0:p.days_60.toLocaleString()]}),r.jsxs("div",{children:[p!=null&&p.total_balance?(p.days_60/p.total_balance*100).toFixed(1):0,"%"]}),r.jsx("div",{children:"-"}),r.jsx("div",{children:r.jsx(se,{size:"sm",variant:"outline",onClick:()=>m("days_60"),disabled:e.has("days_60"),children:e.has("days_60")?"Generating...":"Warning Notice"})})]}),r.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-t",children:[r.jsx("div",{className:"font-medium",children:"61-90 Days"}),r.jsxs("div",{children:["KES ",p==null?void 0:p.days_90.toLocaleString()]}),r.jsxs("div",{children:[p!=null&&p.total_balance?(p.days_90/p.total_balance*100).toFixed(1):0,"%"]}),r.jsx("div",{children:"-"}),r.jsx("div",{children:r.jsx(se,{size:"sm",variant:"destructive",onClick:()=>m("days_90"),disabled:e.has("days_90"),children:e.has("days_90")?"Generating...":"Final Notice"})})]}),r.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-t",children:[r.jsx("div",{className:"font-medium text-red-600",children:"Over 90 Days"}),r.jsxs("div",{className:"text-red-600 font-bold",children:["KES ",p==null?void 0:p.over_90.toLocaleString()]}),r.jsxs("div",{className:"text-red-600",children:[p!=null&&p.total_balance?(p.over_90/p.total_balance*100).toFixed(1):0,"%"]}),r.jsx("div",{children:"-"}),r.jsx("div",{children:r.jsx(se,{size:"sm",variant:"destructive",onClick:()=>m("over_90"),disabled:e.has("over_90"),children:e.has("over_90")?"Generating...":"Disconnection Notice"})})]})]})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Accounts by Category"})}),r.jsx(ie,{children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Category"}),r.jsx(le,{children:"Total Balance"}),r.jsx(le,{children:"Account Count"}),r.jsx(le,{children:"Avg Balance"})]})}),r.jsx(ur,{children:Object.entries(y).length===0?r.jsx(lt,{children:r.jsx(ne,{colSpan:4,className:"text-center text-muted-foreground",children:"No data available"})}):Object.entries(y).map(([T,I])=>{var z;return r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium capitalize",children:T}),r.jsxs(ne,{children:["KES ",((z=I.total_balance)==null?void 0:z.toLocaleString())||0]}),r.jsx(ne,{children:I.count||0}),r.jsxs(ne,{children:["KES"," ",I.count?((I.total_balance||0)/I.count).toLocaleString():0]})]},T)})})]})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Disconnection List (Over 90 Days)"})}),r.jsx(ie,{children:u?r.jsx("p",{className:"text-muted-foreground",children:"Loading disconnection list..."}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Account No"}),r.jsx(le,{children:"Customer"}),r.jsx(le,{children:"Balance"}),r.jsx(le,{children:"Days Overdue"}),r.jsx(le,{children:"Last Payment"})]})}),r.jsx(ur,{children:(c==null?void 0:c.length)===0?r.jsx(lt,{children:r.jsx(ne,{colSpan:5,className:"text-center text-muted-foreground",children:"No accounts for disconnection"})}):c==null?void 0:c.map(T=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:T.account_no}),r.jsx(ne,{children:T.customer_name}),r.jsxs(ne,{className:"text-red-600 font-bold",children:["KES ",T.balance.toLocaleString()]}),r.jsx(ne,{children:T.days_overdue}),r.jsx(ne,{children:T.last_payment_date?new Date(T.last_payment_date).toLocaleDateString():"Never"})]},T.account_no))})]})})]})]})]})}function XLe(){const[e,t]=R.useState(null),[n,s]=R.useState(null),[i,c]=R.useState(null),u=R.useRef(null),a=R.useRef(null),m=jt({mutationFn:k=>Is.importBilling(k),onSuccess:k=>{c(k),qe.success("Billing import completed"),t(null),u.current&&(u.current.value="")},onError:k=>{qe.error(`Billing import failed: ${k.message}`),c({error:k.message})}}),p=jt({mutationFn:k=>Is.importMpesa(k),onSuccess:k=>{c(k),qe.success("M-Pesa import completed"),s(null),a.current&&(a.current.value="")},onError:k=>{qe.error(`M-Pesa import failed: ${k.message}`),c({error:k.message})}}),y=k=>{t(k),c(null)},v=k=>{s(k),c(null)},j=()=>{e&&m.mutate(e)},S=()=>{n&&p.mutate(n)};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Import Center"}),r.jsx("p",{className:"text-muted-foreground",children:"Bulk import billing invoices and M-Pesa payment transactions"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(is,{className:"h-5 w-5"}),"Billing Invoices"]}),r.jsx(xr,{children:"Upload CSV file containing billing invoices with consumption and charges"})]}),r.jsxs(ie,{className:"space-y-4",children:[r.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center",children:[r.jsx(Go,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),r.jsx("input",{ref:u,type:"file",accept:".csv",onChange:k=>{var N;return y(((N=k.target.files)==null?void 0:N[0])||null)},className:"hidden",id:"billing-upload"}),r.jsx("label",{htmlFor:"billing-upload",children:r.jsx(se,{variant:"outline",asChild:!0,children:r.jsx("span",{children:"Select Billing CSV"})})}),e&&r.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:e.name})]}),e&&r.jsx(se,{onClick:j,disabled:m.isPending,className:"w-full",children:m.isPending?r.jsxs(r.Fragment,{children:[r.jsx(Qu,{className:"mr-2 h-4 w-4 animate-spin"}),"Importing..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Go,{className:"mr-2 h-4 w-4"}),"Import Billing Data"]})}),r.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[r.jsx("p",{className:"font-medium",children:"Expected CSV Format:"}),r.jsx("code",{className:"block bg-muted p-2 rounded",children:"account_no,period_start,period_end,consumption,total_amount"})]})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(is,{className:"h-5 w-5 text-green-600"}),"M-Pesa Transactions"]}),r.jsx(xr,{children:"Upload CSV file containing M-Pesa payment transactions"})]}),r.jsxs(ie,{className:"space-y-4",children:[r.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center",children:[r.jsx(Go,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),r.jsx("input",{ref:a,type:"file",accept:".csv",onChange:k=>{var N;return v(((N=k.target.files)==null?void 0:N[0])||null)},className:"hidden",id:"mpesa-upload"}),r.jsx("label",{htmlFor:"mpesa-upload",children:r.jsx(se,{variant:"outline",asChild:!0,children:r.jsx("span",{children:"Select M-Pesa CSV"})})}),n&&r.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:n.name})]}),n&&r.jsx(se,{onClick:S,disabled:p.isPending,className:"w-full",children:p.isPending?r.jsxs(r.Fragment,{children:[r.jsx(Qu,{className:"mr-2 h-4 w-4 animate-spin"}),"Importing..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Go,{className:"mr-2 h-4 w-4"}),"Import M-Pesa Payments"]})}),r.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[r.jsx("p",{className:"font-medium",children:"Expected CSV Format:"}),r.jsx("code",{className:"block bg-muted p-2 rounded",children:"transaction_id,phone,amount,paid_at,account_no"})]})]})]})]}),i&&r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{className:"flex items-center gap-2",children:i.error?r.jsxs(r.Fragment,{children:[r.jsx(yd,{className:"h-5 w-5 text-red-600"}),"Import Failed"]}):r.jsxs(r.Fragment,{children:[r.jsx(os,{className:"h-5 w-5 text-green-600"}),"Import Results"]})})}),r.jsx(ie,{children:i.error?r.jsx("p",{className:"text-red-600",children:i.error}):r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm font-medium",children:"Total Records:"}),r.jsx("span",{className:"text-sm",children:i.total||0})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm font-medium text-green-600",children:"Successful:"}),r.jsx("span",{className:"text-sm text-green-600",children:i.success||0})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm font-medium text-red-600",children:"Failed:"}),r.jsx("span",{className:"text-sm text-red-600",children:i.failed||0})]}),(i.duplicates??0)>0&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm font-medium text-orange-600",children:"Duplicates Skipped:"}),r.jsx("span",{className:"text-sm text-orange-600",children:i.duplicates})]}),i.errors&&i.errors.length>0&&r.jsxs("div",{className:"mt-4",children:[r.jsx("p",{className:"text-sm font-medium mb-2",children:"Errors:"}),r.jsxs("ul",{className:"text-xs text-red-600 space-y-1 max-h-40 overflow-auto",children:[i.errors.slice(0,10).map((k,N)=>r.jsxs("li",{children:[" ",k]},N)),i.errors.length>10&&r.jsxs("li",{children:["... and ",i.errors.length-10," more"]})]})]})]})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Import Guidelines"})}),r.jsxs(ie,{className:"text-sm space-y-3",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium mb-1",children:"Billing Invoices:"}),r.jsxs("ul",{className:"list-disc list-inside text-muted-foreground space-y-1",children:[r.jsx("li",{children:"CSV format with headers: account_no, period_start, period_end, consumption, total_amount"}),r.jsx("li",{children:"Dates in YYYY-MM-DD format"}),r.jsx("li",{children:"Consumption in cubic meters (m)"}),r.jsx("li",{children:"Amount in KES (no currency symbols)"}),r.jsx("li",{children:"Duplicate invoices for same period will be skipped"})]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium mb-1",children:"M-Pesa Payments:"}),r.jsxs("ul",{className:"list-disc list-inside text-muted-foreground space-y-1",children:[r.jsx("li",{children:"CSV format with headers: transaction_id, phone, amount, paid_at, account_no"}),r.jsx("li",{children:"Transaction ID must be unique (duplicates skipped)"}),r.jsx("li",{children:"Phone number in format 254XXXXXXXXX"}),r.jsx("li",{children:"Date in YYYY-MM-DD HH:MM:SS format"}),r.jsx("li",{children:"Account number must exist in the system"})]})]})]})]})]})}const Ks="/hydromet",nl={getSources:e=>{const t={};return e!=null&&e.scheme_id&&(t.scheme_id=e.scheme_id),e!=null&&e.kind_id&&(t.kind_id=e.kind_id.toString()),e!=null&&e.status_id&&(t.status_id=e.status_id.toString()),e!=null&&e.search&&(t.search=e.search),e!=null&&e.per_page&&(t.per_page=e.per_page.toString()),me.get(`${Ks}/sources`,t)},getSource:e=>me.get(`${Ks}/sources/${e}`),createSource:e=>me.post(`${Ks}/sources`,e),updateSource:(e,t)=>me.put(`${Ks}/sources/${e}`,t),deleteSource:e=>me.delete(`${Ks}/sources/${e}`),getSourcesNearby:e=>{const t={lat:e.lat.toString(),lon:e.lon.toString()};return e.radius&&(t.radius=e.radius.toString()),me.get(`${Ks}/sources/nearby`,t)},getSourcesInBounds:e=>{const t={min_lat:e.min_lat.toString(),min_lon:e.min_lon.toString(),max_lat:e.max_lat.toString(),max_lon:e.max_lon.toString()};return me.get(`${Ks}/sources/in-bounds`,t)},logAbstraction:(e,t)=>me.post(`${Ks}/sources/${e}/abstraction`,t),getAbstractionHistory:(e,t,n)=>{const s={};return t&&(s.start_date=t),n&&(s.end_date=n),me.get(`${Ks}/sources/${e}/abstraction/history`,s)},getTotalAbstraction:(e,t,n)=>{const s={};return t&&(s.start_date=t),n&&(s.end_date=n),me.get(`${Ks}/sources/${e}/abstraction/total`,s)},getStations:e=>{const t={};return e!=null&&e.scheme_id&&(t.scheme_id=e.scheme_id),e!=null&&e.station_type_id&&(t.station_type_id=e.station_type_id.toString()),(e==null?void 0:e.active)!==void 0&&(t.active=e.active.toString()),e!=null&&e.search&&(t.search=e.search),e!=null&&e.per_page&&(t.per_page=e.per_page.toString()),me.get(`${Ks}/stations`,t)},getStation:e=>me.get(`${Ks}/stations/${e}`),createStation:e=>me.post(`${Ks}/stations`,e),updateStation:(e,t)=>me.put(`${Ks}/stations/${e}`,t),deleteStation:e=>me.delete(`${Ks}/stations/${e}`),getStationsNearby:e=>{const t={lat:e.lat.toString(),lon:e.lon.toString()};return e.radius&&(t.radius=e.radius.toString()),me.get(`${Ks}/stations/nearby`,t)},getStationsInBounds:e=>{const t={min_lat:e.min_lat.toString(),min_lon:e.min_lon.toString(),max_lat:e.max_lat.toString(),max_lon:e.max_lon.toString()};return me.get(`${Ks}/stations/in-bounds`,t)},activateStation:e=>me.post(`${Ks}/stations/${e}/activate`,{}),deactivateStation:e=>me.post(`${Ks}/stations/${e}/deactivate`,{}),getSensors:(e,t)=>{const n={};return t!==void 0&&(n.active=t.toString()),me.get(`${Ks}/stations/${e}/sensors`,n)},createSensor:(e,t)=>me.post(`${Ks}/stations/${e}/sensors`,t),updateSensor:(e,t,n)=>me.put(`${Ks}/stations/${e}/sensors/${t}`,n),deleteSensor:(e,t)=>me.delete(`${Ks}/stations/${e}/sensors/${t}`)},QLe=(e,t)=>ht({queryKey:["hydromet","sources",e],queryFn:()=>nl.getSources(e),...t}),JLe=()=>{const e=br();return jt({mutationFn:t=>nl.createSource(t),onSuccess:()=>{e.invalidateQueries({queryKey:["hydromet","sources"]})}})},e3e=()=>{const e=br();return jt({mutationFn:({id:t,data:n})=>nl.updateSource(t,n),onSuccess:(t,n)=>{e.invalidateQueries({queryKey:["hydromet","sources"]}),e.invalidateQueries({queryKey:["hydromet","sources",n.id]})}})},t3e=()=>{const e=br();return jt({mutationFn:t=>nl.deleteSource(t),onSuccess:()=>{e.invalidateQueries({queryKey:["hydromet","sources"]})}})},r3e=(e,t)=>ht({queryKey:["hydromet","stations",e],queryFn:()=>nl.getStations(e),...t}),n3e=()=>{const e=br();return jt({mutationFn:t=>nl.createStation(t),onSuccess:()=>{e.invalidateQueries({queryKey:["hydromet","stations"]})}})},s3e=()=>{const e=br();return jt({mutationFn:({id:t,data:n})=>nl.updateStation(t,n),onSuccess:(t,n)=>{e.invalidateQueries({queryKey:["hydromet","stations"]}),e.invalidateQueries({queryKey:["hydromet","stations",n.id]})}})},i3e=()=>{const e=br();return jt({mutationFn:t=>nl.deleteStation(t),onSuccess:()=>{e.invalidateQueries({queryKey:["hydromet","stations"]})}})},a3e=()=>{const e=br();return jt({mutationFn:t=>nl.activateStation(t),onSuccess:(t,n)=>{e.invalidateQueries({queryKey:["hydromet","stations"]}),e.invalidateQueries({queryKey:["hydromet","stations",n]})}})},o3e=()=>{const e=br();return jt({mutationFn:t=>nl.deactivateStation(t),onSuccess:(t,n)=>{e.invalidateQueries({queryKey:["hydromet","stations"]}),e.invalidateQueries({queryKey:["hydromet","stations",n]})}})},l3e=(e,t,n)=>ht({queryKey:["hydromet","stations",e,"sensors",t],queryFn:()=>nl.getSensors(e,t),enabled:e!=null,...n}),c3e=()=>{const e=br();return jt({mutationFn:({stationId:t,data:n})=>nl.createSensor(t,n),onSuccess:(t,n)=>{e.invalidateQueries({queryKey:["hydromet","stations",n.stationId,"sensors"]}),e.invalidateQueries({queryKey:["hydromet","stations",n.stationId]})}})},u3e=()=>{const e=br();return jt({mutationFn:({stationId:t,sensorId:n})=>nl.deleteSensor(t,n),onSuccess:(t,n)=>{e.invalidateQueries({queryKey:["hydromet","stations",n.stationId,"sensors"]}),e.invalidateQueries({queryKey:["hydromet","stations",n.stationId]})}})};var CM=["Enter"," "],d3e=["ArrowDown","PageUp","Home"],MH=["ArrowUp","PageDown","End"],h3e=[...d3e,...MH],f3e={ltr:[...CM,"ArrowRight"],rtl:[...CM,"ArrowLeft"]},m3e={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Xb="Menu",[bb,p3e,g3e]=n2(Xb),[sp,OH]=bd(Xb,[g3e,u2,N2]),_P=u2(),IH=N2(),[x3e,ip]=sp(Xb),[y3e,Qb]=sp(Xb),DH=e=>{const{__scopeMenu:t,open:n=!1,children:s,dir:i,onOpenChange:c,modal:u=!0}=e,a=_P(t),[m,p]=R.useState(null),y=R.useRef(!1),v=qi(c),j=Sy(i);return R.useEffect(()=>{const S=()=>{y.current=!0,document.addEventListener("pointerdown",k,{capture:!0,once:!0}),document.addEventListener("pointermove",k,{capture:!0,once:!0})},k=()=>y.current=!1;return document.addEventListener("keydown",S,{capture:!0}),()=>{document.removeEventListener("keydown",S,{capture:!0}),document.removeEventListener("pointerdown",k,{capture:!0}),document.removeEventListener("pointermove",k,{capture:!0})}},[]),r.jsx(NV,{...a,children:r.jsx(x3e,{scope:t,open:n,onOpenChange:v,content:m,onContentChange:p,children:r.jsx(y3e,{scope:t,onClose:R.useCallback(()=>v(!1),[v]),isUsingKeyboardRef:y,dir:j,modal:u,children:s})})})};DH.displayName=Xb;var v3e="MenuAnchor",TD=R.forwardRef((e,t)=>{const{__scopeMenu:n,...s}=e,i=_P(n);return r.jsx(PV,{...i,...s,ref:t})});TD.displayName=v3e;var ED="MenuPortal",[_3e,RH]=sp(ED,{forceMount:void 0}),LH=e=>{const{__scopeMenu:t,forceMount:n,children:s,container:i}=e,c=ip(ED,t);return r.jsx(_3e,{scope:t,forceMount:n,children:r.jsx(So,{present:n||c.open,children:r.jsx(d2,{asChild:!0,container:i,children:s})})})};LH.displayName=ED;var Sl="MenuContent",[b3e,MD]=sp(Sl),FH=R.forwardRef((e,t)=>{const n=RH(Sl,e.__scopeMenu),{forceMount:s=n.forceMount,...i}=e,c=ip(Sl,e.__scopeMenu),u=Qb(Sl,e.__scopeMenu);return r.jsx(bb.Provider,{scope:e.__scopeMenu,children:r.jsx(So,{present:s||c.open,children:r.jsx(bb.Slot,{scope:e.__scopeMenu,children:u.modal?r.jsx(j3e,{...i,ref:t}):r.jsx(w3e,{...i,ref:t})})})})}),j3e=R.forwardRef((e,t)=>{const n=ip(Sl,e.__scopeMenu),s=R.useRef(null),i=yn(t,s);return R.useEffect(()=>{const c=s.current;if(c)return HO(c)},[]),r.jsx(OD,{...e,ref:i,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:nr(e.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),w3e=R.forwardRef((e,t)=>{const n=ip(Sl,e.__scopeMenu);return r.jsx(OD,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),OD=R.forwardRef((e,t)=>{const{__scopeMenu:n,loop:s=!1,trapFocus:i,onOpenAutoFocus:c,onCloseAutoFocus:u,disableOutsidePointerEvents:a,onEntryFocus:m,onEscapeKeyDown:p,onPointerDownOutside:y,onFocusOutside:v,onInteractOutside:j,onDismiss:S,disableOutsideScroll:k,...N}=e,D=ip(Sl,n),O=Qb(Sl,n),T=_P(n),I=IH(n),z=p3e(n),[$,V]=R.useState(null),K=R.useRef(null),te=yn(t,K,D.onContentChange),X=R.useRef(0),ve=R.useRef(""),ae=R.useRef(0),pe=R.useRef(null),Oe=R.useRef("right"),Me=R.useRef(0),Xe=k?m2:R.Fragment,Ve=k?{as:Gh,allowPinchZoom:!0}:void 0,et=_e=>{var Mt,yr;const tt=ve.current+_e,vt=z().filter(Nt=>!Nt.disabled),gt=document.activeElement,Tt=(Mt=vt.find(Nt=>Nt.ref.current===gt))==null?void 0:Mt.textValue,Ht=vt.map(Nt=>Nt.textValue),Ir=D3e(Ht,tt,Tt),Pr=(yr=vt.find(Nt=>Nt.textValue===Ir))==null?void 0:yr.ref.current;(function Nt(Wt){ve.current=Wt,window.clearTimeout(X.current),Wt!==""&&(X.current=window.setTimeout(()=>Nt(""),1e3))})(tt),Pr&&setTimeout(()=>Pr.focus())};R.useEffect(()=>()=>window.clearTimeout(X.current),[]),FO();const Ce=R.useCallback(_e=>{var vt,gt;return Oe.current===((vt=pe.current)==null?void 0:vt.side)&&L3e(_e,(gt=pe.current)==null?void 0:gt.area)},[]);return r.jsx(b3e,{scope:n,searchRef:ve,onItemEnter:R.useCallback(_e=>{Ce(_e)&&_e.preventDefault()},[Ce]),onItemLeave:R.useCallback(_e=>{var tt;Ce(_e)||((tt=K.current)==null||tt.focus(),V(null))},[Ce]),onTriggerLeave:R.useCallback(_e=>{Ce(_e)&&_e.preventDefault()},[Ce]),pointerGraceTimerRef:ae,onPointerGraceIntentChange:R.useCallback(_e=>{pe.current=_e},[]),children:r.jsx(Xe,{...Ve,children:r.jsx(i2,{asChild:!0,trapped:i,onMountAutoFocus:nr(c,_e=>{var tt;_e.preventDefault(),(tt=K.current)==null||tt.focus({preventScroll:!0})}),onUnmountAutoFocus:u,children:r.jsx(s2,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:p,onPointerDownOutside:y,onFocusOutside:v,onInteractOutside:j,onDismiss:S,children:r.jsx(w9,{asChild:!0,...I,dir:O.dir,orientation:"vertical",loop:s,currentTabStopId:$,onCurrentTabStopIdChange:V,onEntryFocus:nr(m,_e=>{O.isUsingKeyboardRef.current||_e.preventDefault()}),preventScrollOnEntryFocus:!0,children:r.jsx(CV,{role:"menu","aria-orientation":"vertical","data-state":eZ(D.open),"data-radix-menu-content":"",dir:O.dir,...T,...N,ref:te,style:{outline:"none",...N.style},onKeyDown:nr(N.onKeyDown,_e=>{const vt=_e.target.closest("[data-radix-menu-content]")===_e.currentTarget,gt=_e.ctrlKey||_e.altKey||_e.metaKey,Tt=_e.key.length===1;vt&&(_e.key==="Tab"&&_e.preventDefault(),!gt&&Tt&&et(_e.key));const Ht=K.current;if(_e.target!==Ht||!h3e.includes(_e.key))return;_e.preventDefault();const Pr=z().filter(Mt=>!Mt.disabled).map(Mt=>Mt.ref.current);MH.includes(_e.key)&&Pr.reverse(),O3e(Pr)}),onBlur:nr(e.onBlur,_e=>{_e.currentTarget.contains(_e.target)||(window.clearTimeout(X.current),ve.current="")}),onPointerMove:nr(e.onPointerMove,jb(_e=>{const tt=_e.target,vt=Me.current!==_e.clientX;if(_e.currentTarget.contains(tt)&&vt){const gt=_e.clientX>Me.current?"right":"left";Oe.current=gt,Me.current=_e.clientX}}))})})})})})})});FH.displayName=Sl;var S3e="MenuGroup",ID=R.forwardRef((e,t)=>{const{__scopeMenu:n,...s}=e;return r.jsx(zr.div,{role:"group",...s,ref:t})});ID.displayName=S3e;var N3e="MenuLabel",zH=R.forwardRef((e,t)=>{const{__scopeMenu:n,...s}=e;return r.jsx(zr.div,{...s,ref:t})});zH.displayName=N3e;var DN="MenuItem",E6="menu.itemSelect",bP=R.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:s,...i}=e,c=R.useRef(null),u=Qb(DN,e.__scopeMenu),a=MD(DN,e.__scopeMenu),m=yn(t,c),p=R.useRef(!1),y=()=>{const v=c.current;if(!n&&v){const j=new CustomEvent(E6,{bubbles:!0,cancelable:!0});v.addEventListener(E6,S=>s==null?void 0:s(S),{once:!0}),zq(v,j),j.defaultPrevented?p.current=!1:u.onClose()}};return r.jsx($H,{...i,ref:m,disabled:n,onClick:nr(e.onClick,y),onPointerDown:v=>{var j;(j=e.onPointerDown)==null||j.call(e,v),p.current=!0},onPointerUp:nr(e.onPointerUp,v=>{var j;p.current||(j=v.currentTarget)==null||j.click()}),onKeyDown:nr(e.onKeyDown,v=>{const j=a.searchRef.current!=="";n||j&&v.key===" "||CM.includes(v.key)&&(v.currentTarget.click(),v.preventDefault())})})});bP.displayName=DN;var $H=R.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:s=!1,textValue:i,...c}=e,u=MD(DN,n),a=IH(n),m=R.useRef(null),p=yn(t,m),[y,v]=R.useState(!1),[j,S]=R.useState("");return R.useEffect(()=>{const k=m.current;k&&S((k.textContent??"").trim())},[c.children]),r.jsx(bb.ItemSlot,{scope:n,disabled:s,textValue:i??j,children:r.jsx(S9,{asChild:!0,...a,focusable:!s,children:r.jsx(zr.div,{role:"menuitem","data-highlighted":y?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...c,ref:p,onPointerMove:nr(e.onPointerMove,jb(k=>{s?u.onItemLeave(k):(u.onItemEnter(k),k.defaultPrevented||k.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:nr(e.onPointerLeave,jb(k=>u.onItemLeave(k))),onFocus:nr(e.onFocus,()=>v(!0)),onBlur:nr(e.onBlur,()=>v(!1))})})})}),P3e="MenuCheckboxItem",BH=R.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:s,...i}=e;return r.jsx(GH,{scope:e.__scopeMenu,checked:n,children:r.jsx(bP,{role:"menuitemcheckbox","aria-checked":RN(n)?"mixed":n,...i,ref:t,"data-state":RD(n),onSelect:nr(i.onSelect,()=>s==null?void 0:s(RN(n)?!0:!n),{checkForDefaultPrevented:!1})})})});BH.displayName=P3e;var qH="MenuRadioGroup",[C3e,A3e]=sp(qH,{value:void 0,onValueChange:()=>{}}),VH=R.forwardRef((e,t)=>{const{value:n,onValueChange:s,...i}=e,c=qi(s);return r.jsx(C3e,{scope:e.__scopeMenu,value:n,onValueChange:c,children:r.jsx(ID,{...i,ref:t})})});VH.displayName=qH;var UH="MenuRadioItem",WH=R.forwardRef((e,t)=>{const{value:n,...s}=e,i=A3e(UH,e.__scopeMenu),c=n===i.value;return r.jsx(GH,{scope:e.__scopeMenu,checked:c,children:r.jsx(bP,{role:"menuitemradio","aria-checked":c,...s,ref:t,"data-state":RD(c),onSelect:nr(s.onSelect,()=>{var u;return(u=i.onValueChange)==null?void 0:u.call(i,n)},{checkForDefaultPrevented:!1})})})});WH.displayName=UH;var DD="MenuItemIndicator",[GH,k3e]=sp(DD,{checked:!1}),KH=R.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:s,...i}=e,c=k3e(DD,n);return r.jsx(So,{present:s||RN(c.checked)||c.checked===!0,children:r.jsx(zr.span,{...i,ref:t,"data-state":RD(c.checked)})})});KH.displayName=DD;var T3e="MenuSeparator",HH=R.forwardRef((e,t)=>{const{__scopeMenu:n,...s}=e;return r.jsx(zr.div,{role:"separator","aria-orientation":"horizontal",...s,ref:t})});HH.displayName=T3e;var E3e="MenuArrow",ZH=R.forwardRef((e,t)=>{const{__scopeMenu:n,...s}=e,i=_P(n);return r.jsx(AV,{...i,...s,ref:t})});ZH.displayName=E3e;var M3e="MenuSub",[L$e,YH]=sp(M3e),U_="MenuSubTrigger",XH=R.forwardRef((e,t)=>{const n=ip(U_,e.__scopeMenu),s=Qb(U_,e.__scopeMenu),i=YH(U_,e.__scopeMenu),c=MD(U_,e.__scopeMenu),u=R.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:m}=c,p={__scopeMenu:e.__scopeMenu},y=R.useCallback(()=>{u.current&&window.clearTimeout(u.current),u.current=null},[]);return R.useEffect(()=>y,[y]),R.useEffect(()=>{const v=a.current;return()=>{window.clearTimeout(v),m(null)}},[a,m]),r.jsx(TD,{asChild:!0,...p,children:r.jsx($H,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":i.contentId,"data-state":eZ(n.open),...e,ref:r2(t,i.onTriggerChange),onClick:v=>{var j;(j=e.onClick)==null||j.call(e,v),!(e.disabled||v.defaultPrevented)&&(v.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:nr(e.onPointerMove,jb(v=>{c.onItemEnter(v),!v.defaultPrevented&&!e.disabled&&!n.open&&!u.current&&(c.onPointerGraceIntentChange(null),u.current=window.setTimeout(()=>{n.onOpenChange(!0),y()},100))})),onPointerLeave:nr(e.onPointerLeave,jb(v=>{var S,k;y();const j=(S=n.content)==null?void 0:S.getBoundingClientRect();if(j){const N=(k=n.content)==null?void 0:k.dataset.side,D=N==="right",O=D?-5:5,T=j[D?"left":"right"],I=j[D?"right":"left"];c.onPointerGraceIntentChange({area:[{x:v.clientX+O,y:v.clientY},{x:T,y:j.top},{x:I,y:j.top},{x:I,y:j.bottom},{x:T,y:j.bottom}],side:N}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>c.onPointerGraceIntentChange(null),300)}else{if(c.onTriggerLeave(v),v.defaultPrevented)return;c.onPointerGraceIntentChange(null)}})),onKeyDown:nr(e.onKeyDown,v=>{var S;const j=c.searchRef.current!=="";e.disabled||j&&v.key===" "||f3e[s.dir].includes(v.key)&&(n.onOpenChange(!0),(S=n.content)==null||S.focus(),v.preventDefault())})})})});XH.displayName=U_;var QH="MenuSubContent",JH=R.forwardRef((e,t)=>{const n=RH(Sl,e.__scopeMenu),{forceMount:s=n.forceMount,...i}=e,c=ip(Sl,e.__scopeMenu),u=Qb(Sl,e.__scopeMenu),a=YH(QH,e.__scopeMenu),m=R.useRef(null),p=yn(t,m);return r.jsx(bb.Provider,{scope:e.__scopeMenu,children:r.jsx(So,{present:s||c.open,children:r.jsx(bb.Slot,{scope:e.__scopeMenu,children:r.jsx(OD,{id:a.contentId,"aria-labelledby":a.triggerId,...i,ref:p,align:"start",side:u.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:y=>{var v;u.isUsingKeyboardRef.current&&((v=m.current)==null||v.focus()),y.preventDefault()},onCloseAutoFocus:y=>y.preventDefault(),onFocusOutside:nr(e.onFocusOutside,y=>{y.target!==a.trigger&&c.onOpenChange(!1)}),onEscapeKeyDown:nr(e.onEscapeKeyDown,y=>{u.onClose(),y.preventDefault()}),onKeyDown:nr(e.onKeyDown,y=>{var S;const v=y.currentTarget.contains(y.target),j=m3e[u.dir].includes(y.key);v&&j&&(c.onOpenChange(!1),(S=a.trigger)==null||S.focus(),y.preventDefault())})})})})})});JH.displayName=QH;function eZ(e){return e?"open":"closed"}function RN(e){return e==="indeterminate"}function RD(e){return RN(e)?"indeterminate":e?"checked":"unchecked"}function O3e(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function I3e(e,t){return e.map((n,s)=>e[(t+s)%e.length])}function D3e(e,t,n){const i=t.length>1&&Array.from(t).every(p=>p===t[0])?t[0]:t,c=n?e.indexOf(n):-1;let u=I3e(e,Math.max(c,0));i.length===1&&(u=u.filter(p=>p!==n));const m=u.find(p=>p.toLowerCase().startsWith(i.toLowerCase()));return m!==n?m:void 0}function R3e(e,t){const{x:n,y:s}=e;let i=!1;for(let c=0,u=t.length-1;c<t.length;u=c++){const a=t[c].x,m=t[c].y,p=t[u].x,y=t[u].y;m>s!=y>s&&n<(p-a)*(s-m)/(y-m)+a&&(i=!i)}return i}function L3e(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return R3e(n,t)}function jb(e){return t=>t.pointerType==="mouse"?e(t):void 0}var F3e=DH,z3e=TD,$3e=LH,B3e=FH,q3e=ID,V3e=zH,U3e=bP,W3e=BH,G3e=VH,K3e=WH,H3e=KH,Z3e=HH,Y3e=ZH,X3e=XH,Q3e=JH,LD="DropdownMenu",[J3e]=bd(LD,[OH]),no=OH(),[eFe,tZ]=J3e(LD),rZ=e=>{const{__scopeDropdownMenu:t,children:n,dir:s,open:i,defaultOpen:c,onOpenChange:u,modal:a=!0}=e,m=no(t),p=R.useRef(null),[y=!1,v]=ud({prop:i,defaultProp:c,onChange:u});return r.jsx(eFe,{scope:t,triggerId:Hc(),triggerRef:p,contentId:Hc(),open:y,onOpenChange:v,onOpenToggle:R.useCallback(()=>v(j=>!j),[v]),modal:a,children:r.jsx(F3e,{...m,open:y,onOpenChange:v,dir:s,modal:a,children:n})})};rZ.displayName=LD;var nZ="DropdownMenuTrigger",sZ=R.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:s=!1,...i}=e,c=tZ(nZ,n),u=no(n);return r.jsx(z3e,{asChild:!0,...u,children:r.jsx(zr.button,{type:"button",id:c.triggerId,"aria-haspopup":"menu","aria-expanded":c.open,"aria-controls":c.open?c.contentId:void 0,"data-state":c.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...i,ref:r2(t,c.triggerRef),onPointerDown:nr(e.onPointerDown,a=>{!s&&a.button===0&&a.ctrlKey===!1&&(c.onOpenToggle(),c.open||a.preventDefault())}),onKeyDown:nr(e.onKeyDown,a=>{s||(["Enter"," "].includes(a.key)&&c.onOpenToggle(),a.key==="ArrowDown"&&c.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});sZ.displayName=nZ;var tFe="DropdownMenuPortal",iZ=e=>{const{__scopeDropdownMenu:t,...n}=e,s=no(t);return r.jsx($3e,{...s,...n})};iZ.displayName=tFe;var aZ="DropdownMenuContent",oZ=R.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=tZ(aZ,n),c=no(n),u=R.useRef(!1);return r.jsx(B3e,{id:i.contentId,"aria-labelledby":i.triggerId,...c,...s,ref:t,onCloseAutoFocus:nr(e.onCloseAutoFocus,a=>{var m;u.current||(m=i.triggerRef.current)==null||m.focus(),u.current=!1,a.preventDefault()}),onInteractOutside:nr(e.onInteractOutside,a=>{const m=a.detail.originalEvent,p=m.button===0&&m.ctrlKey===!0,y=m.button===2||p;(!i.modal||y)&&(u.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});oZ.displayName=aZ;var rFe="DropdownMenuGroup",nFe=R.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=no(n);return r.jsx(q3e,{...i,...s,ref:t})});nFe.displayName=rFe;var sFe="DropdownMenuLabel",lZ=R.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=no(n);return r.jsx(V3e,{...i,...s,ref:t})});lZ.displayName=sFe;var iFe="DropdownMenuItem",cZ=R.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=no(n);return r.jsx(U3e,{...i,...s,ref:t})});cZ.displayName=iFe;var aFe="DropdownMenuCheckboxItem",uZ=R.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=no(n);return r.jsx(W3e,{...i,...s,ref:t})});uZ.displayName=aFe;var oFe="DropdownMenuRadioGroup",lFe=R.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=no(n);return r.jsx(G3e,{...i,...s,ref:t})});lFe.displayName=oFe;var cFe="DropdownMenuRadioItem",dZ=R.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=no(n);return r.jsx(K3e,{...i,...s,ref:t})});dZ.displayName=cFe;var uFe="DropdownMenuItemIndicator",hZ=R.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=no(n);return r.jsx(H3e,{...i,...s,ref:t})});hZ.displayName=uFe;var dFe="DropdownMenuSeparator",fZ=R.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=no(n);return r.jsx(Z3e,{...i,...s,ref:t})});fZ.displayName=dFe;var hFe="DropdownMenuArrow",fFe=R.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=no(n);return r.jsx(Y3e,{...i,...s,ref:t})});fFe.displayName=hFe;var mFe="DropdownMenuSubTrigger",mZ=R.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=no(n);return r.jsx(X3e,{...i,...s,ref:t})});mZ.displayName=mFe;var pFe="DropdownMenuSubContent",pZ=R.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...s}=e,i=no(n);return r.jsx(Q3e,{...i,...s,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});pZ.displayName=pFe;var gFe=rZ,xFe=sZ,yFe=iZ,gZ=oZ,xZ=lZ,yZ=cZ,vZ=uZ,_Z=dZ,bZ=hZ,jZ=fZ,wZ=mZ,SZ=pZ;const NZ=gFe,PZ=xFe,vFe=R.forwardRef(({className:e,inset:t,children:n,...s},i)=>r.jsxs(wZ,{ref:i,className:wr("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...s,children:[n,r.jsx(by,{className:"ml-auto"})]}));vFe.displayName=wZ.displayName;const _Fe=R.forwardRef(({className:e,...t},n)=>r.jsx(SZ,{ref:n,className:wr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));_Fe.displayName=SZ.displayName;const FD=R.forwardRef(({className:e,sideOffset:t=4,...n},s)=>r.jsx(yFe,{children:r.jsx(gZ,{ref:s,sideOffset:t,className:wr("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));FD.displayName=gZ.displayName;const gh=R.forwardRef(({className:e,inset:t,...n},s)=>r.jsx(yZ,{ref:s,className:wr("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",t&&"pl-8",e),...n}));gh.displayName=yZ.displayName;const bFe=R.forwardRef(({className:e,children:t,checked:n,...s},i)=>r.jsxs(vZ,{ref:i,className:wr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...s,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(bZ,{children:r.jsx(Nx,{className:"h-4 w-4"})})}),t]}));bFe.displayName=vZ.displayName;const jFe=R.forwardRef(({className:e,children:t,...n},s)=>r.jsxs(_Z,{ref:s,className:wr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(bZ,{children:r.jsx(vT,{className:"h-2 w-2 fill-current"})})}),t]}));jFe.displayName=_Z.displayName;const wFe=R.forwardRef(({className:e,inset:t,...n},s)=>r.jsx(xZ,{ref:s,className:wr("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));wFe.displayName=xZ.displayName;const SFe=R.forwardRef(({className:e,...t},n)=>r.jsx(jZ,{ref:n,className:wr("-mx-1 my-1 h-px bg-muted",e),...t}));SFe.displayName=jZ.displayName;function CZ({latitude:e,longitude:t,onLocationChange:n}){const[s,i]=R.useState({longitude:t!==void 0?t:36.8219,latitude:e!==void 0?e:-1.2921,zoom:10}),[c,u]=R.useState(e!==void 0&&t!==void 0?{lat:e,lon:t}:null),[a,m]=R.useState(e!==void 0?e.toString():""),[p,y]=R.useState(t!==void 0?t.toString():"");R.useEffect(()=>{e!==void 0&&t!==void 0&&(u({lat:e,lon:t}),i(k=>({...k,latitude:e,longitude:t})),m(e.toString()),y(t.toString()))},[e,t]);const v=R.useCallback(k=>{const{lng:N,lat:D}=k.lngLat;u({lat:D,lon:N}),m(D.toFixed(6)),y(N.toFixed(6)),n(D,N)},[n]),j=R.useCallback(()=>{const k=parseFloat(a),N=parseFloat(p);!isNaN(k)&&!isNaN(N)&&k>=-90&&k<=90&&N>=-180&&N<=180&&(u({lat:k,lon:N}),i(D=>({...D,latitude:k,longitude:N})),n(k,N))},[a,p,n]),S=R.useCallback(()=>{u(null),m(""),y(""),n(void 0,void 0)},[n]);return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"manual-lat",children:"Latitude"}),r.jsx(Ge,{id:"manual-lat",type:"number",step:"0.000001",value:a,onChange:k=>m(k.target.value),placeholder:"-1.286389"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"manual-lon",children:"Longitude"}),r.jsx(Ge,{id:"manual-lon",type:"number",step:"0.000001",value:p,onChange:k=>y(k.target.value),placeholder:"36.817223"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{type:"button",variant:"outline",size:"sm",onClick:j,children:"Update from Coordinates"}),r.jsx(se,{type:"button",variant:"outline",size:"sm",onClick:S,children:"Clear Location"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{children:"Click map to set location"}),r.jsx("div",{style:{height:"300px",width:"100%"},className:"rounded-lg overflow-hidden border",children:r.jsxs(Ob,{...s,onMove:k=>i(k.viewState),onClick:v,mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",style:{width:"100%",height:"100%"},cursor:"crosshair",children:[r.jsx(Ib,{position:"top-right"}),r.jsx(Db,{position:"bottom-left"}),c&&r.jsx(Nne,{longitude:c.lon,latitude:c.lat,anchor:"bottom",children:r.jsx(jo,{className:"h-8 w-8 text-red-500",fill:"currentColor"})})]})})]})]})}function NFe({open:e,onClose:t,source:n,isCreating:s}){var y,v;const i=JLe(),c=e3e(),[u,a]=R.useState({name:"",code:"",kind_id:void 0,status_id:void 0,catchment:"",elevation_m:void 0,depth_m:void 0,capacity_m3_per_day:void 0,permit_no:"",latitude:void 0,longitude:void 0});R.useEffect(()=>{var j,S;n&&!s?a({name:n.name,code:n.code,kind_id:n.kind_id,status_id:n.status_id,catchment:n.catchment||"",elevation_m:n.elevation_m||void 0,depth_m:n.depth_m||void 0,capacity_m3_per_day:n.capacity_m3_per_day||void 0,permit_no:n.permit_no||"",latitude:(j=n.location)==null?void 0:j.coordinates[1],longitude:(S=n.location)==null?void 0:S.coordinates[0]}):s&&a({name:"",code:"",kind_id:void 0,status_id:void 0,catchment:"",elevation_m:void 0,depth_m:void 0,capacity_m3_per_day:void 0,permit_no:"",latitude:void 0,longitude:void 0})},[n,s,e]);const m=async j=>{if(j.preventDefault(),!u.name||!u.code||!u.kind_id||!u.status_id){qe.error("Please fill in all required fields");return}try{s?(await i.mutateAsync(u),qe.success("Source created successfully")):n&&(await c.mutateAsync({id:n.id,data:u}),qe.success("Source updated successfully")),t()}catch(S){qe.error(S.message||`Failed to ${s?"create":"update"} source`)}},p=i.isPending||c.isPending;return r.jsx(Rr,{open:e,onOpenChange:t,children:r.jsxs(Er,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsx(Mr,{children:r.jsx(Or,{children:s?"Add New Source":"Edit Source"})}),r.jsxs("form",{onSubmit:m,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"code",children:"Source Code *"}),r.jsx(Ge,{id:"code",value:u.code,onChange:j=>a({...u,code:j.target.value}),placeholder:"e.g., SRC-001",required:!0})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"name",children:"Source Name *"}),r.jsx(Ge,{id:"name",value:u.name,onChange:j=>a({...u,name:j.target.value}),placeholder:"e.g., Kikuyu Borehole",required:!0})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"kind_id",children:"Source Type *"}),r.jsxs(Jt,{value:(y=u.kind_id)==null?void 0:y.toString(),onValueChange:j=>a({...u,kind_id:parseInt(j)}),children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select type"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"1",children:"Borehole"}),r.jsx(ke,{value:"2",children:"Spring"}),r.jsx(ke,{value:"3",children:"River"}),r.jsx(ke,{value:"4",children:"Dam"}),r.jsx(ke,{value:"5",children:"Well"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"status_id",children:"Status *"}),r.jsxs(Jt,{value:(v=u.status_id)==null?void 0:v.toString(),onValueChange:j=>a({...u,status_id:parseInt(j)}),children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select status"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"1",children:"Active"}),r.jsx(ke,{value:"2",children:"Inactive"}),r.jsx(ke,{value:"3",children:"Abandoned"})]})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"catchment",children:"Catchment Area"}),r.jsx(Ge,{id:"catchment",value:u.catchment,onChange:j=>a({...u,catchment:j.target.value}),placeholder:"e.g., Tana Basin"})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"elevation_m",children:"Elevation (m)"}),r.jsx(Ge,{id:"elevation_m",type:"number",step:"0.1",value:u.elevation_m||"",onChange:j=>a({...u,elevation_m:j.target.value?parseFloat(j.target.value):void 0}),placeholder:"1500"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"depth_m",children:"Depth (m)"}),r.jsx(Ge,{id:"depth_m",type:"number",step:"0.1",value:u.depth_m||"",onChange:j=>a({...u,depth_m:j.target.value?parseFloat(j.target.value):void 0}),placeholder:"120"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"capacity_m3_per_day",children:"Capacity (m/day)"}),r.jsx(Ge,{id:"capacity_m3_per_day",type:"number",step:"0.1",value:u.capacity_m3_per_day||"",onChange:j=>a({...u,capacity_m3_per_day:j.target.value?parseFloat(j.target.value):void 0}),placeholder:"500"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"permit_no",children:"Permit Number"}),r.jsx(Ge,{id:"permit_no",value:u.permit_no,onChange:j=>a({...u,permit_no:j.target.value}),placeholder:"e.g., WRUA/2023/001"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{children:"Location (PostGIS)"}),r.jsx(CZ,{latitude:u.latitude,longitude:u.longitude,onLocationChange:(j,S)=>a({...u,latitude:j,longitude:S})})]}),r.jsxs(Ai,{children:[r.jsx(se,{type:"button",variant:"outline",onClick:t,disabled:p,children:"Cancel"}),r.jsx(se,{type:"submit",disabled:p,children:p?"Saving...":s?"Create Source":"Update Source"})]})]})]})})}function AZ({sources:e,stations:t,selectedId:n,onSelect:s,height:i="400px"}){const[c,u]=R.useState({longitude:36.8219,latitude:-1.2921,zoom:8}),a=R.useMemo(()=>e?{type:"FeatureCollection",features:e.filter(y=>y.location).map(y=>{var v,j;return{type:"Feature",id:y.id,geometry:y.location,properties:{id:y.id,name:y.name,code:y.code,kind:((v=y.kind)==null?void 0:v.name)||"Unknown",status:((j=y.status)==null?void 0:j.name)||"Unknown"}}})}:null,[e]),m=R.useMemo(()=>t?{type:"FeatureCollection",features:t.filter(y=>y.location).map(y=>{var v;return{type:"Feature",id:y.id,geometry:y.location,properties:{id:y.id,name:y.name,code:y.code,type:((v=y.station_type)==null?void 0:v.name)||"Unknown",active:y.active}}})}:null,[t]),p=R.useCallback(y=>{const v=y.features;if(v&&v.length>0){const j=v[0],S=j.properties.id,k=j.layer.id;s&&s(S,k==="sources-layer"?"source":"station")}},[s]);return r.jsx("div",{style:{height:i,width:"100%"},className:"rounded-lg overflow-hidden border",children:r.jsxs(Ob,{...c,onMove:y=>u(y.viewState),mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",style:{width:"100%",height:"100%"},interactiveLayerIds:["sources-layer","stations-layer"],onClick:p,children:[r.jsx(Ib,{position:"top-right"}),r.jsx(Db,{position:"bottom-left"}),a&&r.jsx(T0,{id:"sources",type:"geojson",data:a,children:r.jsx(Tx,{id:"sources-layer",type:"circle",paint:{"circle-radius":["case",["==",["get","id"],n],10,6],"circle-color":["match",["get","status"],"Active","#22c55e","Inactive","#94a3b8","Abandoned","#ef4444","#6b7280"],"circle-stroke-width":2,"circle-stroke-color":["case",["==",["get","id"],n],"#000000","#ffffff"]}})}),m&&r.jsx(T0,{id:"stations",type:"geojson",data:m,children:r.jsx(Tx,{id:"stations-layer",type:"circle",paint:{"circle-radius":["case",["==",["get","id"],n],10,6],"circle-color":["case",["get","active"],"#3b82f6","#94a3b8"],"circle-stroke-width":2,"circle-stroke-color":["case",["==",["get","id"],n],"#000000","#ffffff"]}})})]})})}function PFe(){const[e,t]=R.useState(""),[n,s]=R.useState(null),[i,c]=R.useState(!1),[u,a]=R.useState(!1),[m,p]=R.useState(!0),{data:y,isLoading:v}=QLe({search:e,per_page:100}),j=t3e(),S=(y==null?void 0:y.data)||[],k=()=>{s(null),a(!0),c(!0)},N=z=>{s(z),a(!1),c(!0)},D=async z=>{if(window.confirm(`Are you sure you want to delete source "${z.name}"?`))try{await j.mutateAsync(z.id),qe.success("Source deleted successfully")}catch($){qe.error($.message||"Failed to delete source")}},O=()=>{c(!1),s(null),a(!1)},T=z=>{if(!z)return"secondary";switch(z.name.toLowerCase()){case"active":return"default";case"inactive":return"secondary";case"abandoned":return"destructive";default:return"secondary"}},I=z=>{if(!z)return"secondary";switch(z.name.toLowerCase()){case"low":return"default";case"medium":return"secondary";case"high":return"destructive";default:return"secondary"}};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Water Sources Registry"}),r.jsx("p",{className:"text-muted-foreground",children:"Manage water sources and abstraction points"})]}),r.jsxs(se,{onClick:k,children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Add Source"]})]}),m&&S.length>0&&r.jsxs(J,{className:"mb-6",children:[r.jsx(ge,{children:r.jsx(xe,{children:"Sources Map"})}),r.jsx(ie,{children:r.jsx(AZ,{sources:S,selectedId:n==null?void 0:n.id,onSelect:z=>{const $=S.find(V=>V.id===z);$&&s($)},height:"400px"})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"flex-1 relative",children:[r.jsx(ci,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Search sources by name or code...",value:e,onChange:z=>t(z.target.value),className:"pl-10"})]}),r.jsxs(se,{variant:"outline",size:"sm",onClick:()=>p(!m),children:[r.jsx(Bc,{className:"mr-2 h-4 w-4"}),m?"Hide":"Show"," Map"]})]})}),r.jsx(ie,{children:v?r.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Loading sources..."}):S.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx(Gc,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"No sources found"}),r.jsxs(se,{onClick:k,variant:"outline",className:"mt-4",children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Add your first source"]})]}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Code"}),r.jsx(le,{children:"Name"}),r.jsx(le,{children:"Type"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Catchment"}),r.jsx(le,{children:"Capacity (m/day)"}),r.jsx(le,{children:"Quality Risk"}),r.jsx(le,{children:"Location"}),r.jsx(le,{className:"text-right",children:"Actions"})]})}),r.jsx(ur,{children:S.map(z=>{var $,V,K;return r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:z.code}),r.jsx(ne,{children:z.name}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:(($=z.kind)==null?void 0:$.name)||"N/A"})}),r.jsx(ne,{children:r.jsx(We,{variant:T(z.status),children:((V=z.status)==null?void 0:V.name)||"Unknown"})}),r.jsx(ne,{className:"text-muted-foreground",children:z.catchment||"N/A"}),r.jsx(ne,{className:"text-right",children:((K=z.capacity_m3_per_day)==null?void 0:K.toLocaleString())||"N/A"}),r.jsx(ne,{children:z.quality_risk?r.jsx(We,{variant:I(z.quality_risk),children:z.quality_risk.name}):r.jsx("span",{className:"text-muted-foreground",children:"N/A"})}),r.jsx(ne,{children:z.location?r.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[r.jsx(jo,{className:"h-3 w-3"}),r.jsxs("span",{children:[z.location.coordinates[1].toFixed(4),", ",z.location.coordinates[0].toFixed(4)]})]}):r.jsx("span",{className:"text-muted-foreground",children:"N/A"})}),r.jsx(ne,{className:"text-right",children:r.jsxs(NZ,{children:[r.jsx(PZ,{asChild:!0,children:r.jsx(se,{variant:"ghost",size:"sm",children:r.jsx(Hq,{className:"h-4 w-4"})})}),r.jsxs(FD,{align:"end",children:[r.jsxs(gh,{onClick:()=>N(z),children:[r.jsx(vd,{className:"mr-2 h-4 w-4"}),"Edit"]}),r.jsxs(gh,{onClick:()=>D(z),className:"text-destructive",children:[r.jsx(Oi,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},z.id)})})]})})]}),r.jsx(NFe,{open:i,onClose:O,source:n,isCreating:u})]})}function CFe({open:e,onClose:t,station:n,isCreating:s}){var y,v;const i=n3e(),c=s3e(),[u,a]=R.useState({name:"",code:"",station_type_id:void 0,datasource_id:1,elevation_m:void 0,active:!0,latitude:void 0,longitude:void 0});R.useEffect(()=>{var j,S;n&&!s?a({name:n.name,code:n.code,station_type_id:n.station_type_id,datasource_id:n.datasource_id,elevation_m:n.elevation_m||void 0,active:n.active,latitude:(j=n.location)==null?void 0:j.coordinates[1],longitude:(S=n.location)==null?void 0:S.coordinates[0]}):s&&a({name:"",code:"",station_type_id:void 0,datasource_id:1,elevation_m:void 0,active:!0,latitude:void 0,longitude:void 0})},[n,s,e]);const m=async j=>{if(j.preventDefault(),!u.name||!u.code||!u.station_type_id||!u.datasource_id){qe.error("Please fill in all required fields");return}try{s?(await i.mutateAsync(u),qe.success("Station created successfully")):n&&(await c.mutateAsync({id:n.id,data:u}),qe.success("Station updated successfully")),t()}catch(S){qe.error(S.message||`Failed to ${s?"create":"update"} station`)}},p=i.isPending||c.isPending;return r.jsx(Rr,{open:e,onOpenChange:t,children:r.jsxs(Er,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsx(Mr,{children:r.jsx(Or,{children:s?"Add New Station":"Edit Station"})}),r.jsxs("form",{onSubmit:m,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"code",children:"Station Code *"}),r.jsx(Ge,{id:"code",value:u.code,onChange:j=>a({...u,code:j.target.value}),placeholder:"e.g., HMS-001",required:!0})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"name",children:"Station Name *"}),r.jsx(Ge,{id:"name",value:u.name,onChange:j=>a({...u,name:j.target.value}),placeholder:"e.g., Tana River Flow Station",required:!0})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"station_type_id",children:"Station Type *"}),r.jsxs(Jt,{value:(y=u.station_type_id)==null?void 0:y.toString(),onValueChange:j=>a({...u,station_type_id:parseInt(j)}),children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select type"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"1",children:"Weather"}),r.jsx(ke,{value:"2",children:"Hydrological"}),r.jsx(ke,{value:"3",children:"Rain Gauge"}),r.jsx(ke,{value:"4",children:"Stream Gauge"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"datasource_id",children:"Data Source *"}),r.jsxs(Jt,{value:(v=u.datasource_id)==null?void 0:v.toString(),onValueChange:j=>a({...u,datasource_id:parseInt(j)}),children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select source"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"1",children:"Manual Reading"}),r.jsx(ke,{value:"2",children:"Telemetry"}),r.jsx(ke,{value:"3",children:"SCADA"})]})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"elevation_m",children:"Elevation (m)"}),r.jsx(Ge,{id:"elevation_m",type:"number",step:"0.1",value:u.elevation_m||"",onChange:j=>a({...u,elevation_m:j.target.value?parseFloat(j.target.value):void 0}),placeholder:"1500"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{children:"Location (PostGIS)"}),r.jsx(CZ,{latitude:u.latitude,longitude:u.longitude,onLocationChange:(j,S)=>a({...u,latitude:j,longitude:S})})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Ey,{id:"active",checked:u.active,onCheckedChange:j=>a({...u,active:j})}),r.jsx(Ne,{htmlFor:"active",className:"cursor-pointer",children:"Station is active"})]}),r.jsxs(Ai,{children:[r.jsx(se,{type:"button",variant:"outline",onClick:t,disabled:p,children:"Cancel"}),r.jsx(se,{type:"submit",disabled:p,children:p?"Saving...":s?"Create Station":"Update Station"})]})]})]})})}function AFe({station:e,onClose:t}){var S;const[n,s]=R.useState(!1),[i,c]=R.useState({parameter_id:void 0,make:"",model:"",serial_number:""}),{data:u,isLoading:a}=l3e((e==null?void 0:e.id)||null),m=c3e(),p=u3e(),y=async k=>{if(k.preventDefault(),!e||!i.parameter_id){qe.error("Please select a parameter");return}try{await m.mutateAsync({stationId:e.id,data:i}),qe.success("Sensor added successfully"),s(!1),c({parameter_id:void 0,make:"",model:"",serial_number:""})}catch(N){qe.error(N.message||"Failed to add sensor")}},v=async k=>{if(e&&window.confirm("Are you sure you want to delete this sensor?"))try{await p.mutateAsync({stationId:e.id,sensorId:k}),qe.success("Sensor deleted successfully")}catch(N){qe.error(N.message||"Failed to delete sensor")}},j=m.isPending;return r.jsx(Rr,{open:e!==null,onOpenChange:t,children:r.jsxs(Er,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsx(Mr,{children:r.jsxs(Or,{children:["Manage Sensors - ",e==null?void 0:e.name]})}),r.jsxs("div",{className:"space-y-4",children:[a?r.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Loading sensors..."}):u&&u.length>0?r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Parameter"}),r.jsx(le,{children:"Make"}),r.jsx(le,{children:"Model"}),r.jsx(le,{children:"Serial Number"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Installed"}),r.jsx(le,{className:"text-right",children:"Actions"})]})}),r.jsx(ur,{children:u.map(k=>r.jsxs(lt,{children:[r.jsxs(ne,{className:"font-medium",children:["Parameter #",k.parameter_id]}),r.jsx(ne,{children:k.make||"N/A"}),r.jsx(ne,{children:k.model||"N/A"}),r.jsx(ne,{className:"font-mono text-sm",children:k.serial_number||"N/A"}),r.jsx(ne,{children:r.jsx(We,{variant:k.active?"default":"secondary",children:k.active?"Active":"Inactive"})}),r.jsx(ne,{className:"text-sm text-muted-foreground",children:k.installed_at?new Date(k.installed_at).toLocaleDateString():"N/A"}),r.jsx(ne,{className:"text-right",children:r.jsx(se,{variant:"ghost",size:"sm",onClick:()=>v(k.id),children:r.jsx(Oi,{className:"h-4 w-4 text-destructive"})})})]},k.id))})]}):r.jsxs("div",{className:"text-center py-8",children:[r.jsx(jT,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"No sensors configured"})]}),n?r.jsxs("form",{onSubmit:y,className:"space-y-4 border rounded-lg p-4",children:[r.jsx("h3",{className:"font-semibold",children:"Add New Sensor"}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"parameter_id",children:"Parameter *"}),r.jsxs(Jt,{value:(S=i.parameter_id)==null?void 0:S.toString(),onValueChange:k=>c({...i,parameter_id:parseInt(k)}),children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select parameter"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"1",children:"Temperature"}),r.jsx(ke,{value:"2",children:"Rainfall"}),r.jsx(ke,{value:"3",children:"Water Level"}),r.jsx(ke,{value:"4",children:"Flow Rate"}),r.jsx(ke,{value:"5",children:"Humidity"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"make",children:"Make"}),r.jsx(Ge,{id:"make",value:i.make,onChange:k=>c({...i,make:k.target.value}),placeholder:"e.g., Campbell Scientific"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"model",children:"Model"}),r.jsx(Ge,{id:"model",value:i.model,onChange:k=>c({...i,model:k.target.value}),placeholder:"e.g., CS215"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"serial_number",children:"Serial Number"}),r.jsx(Ge,{id:"serial_number",value:i.serial_number,onChange:k=>c({...i,serial_number:k.target.value}),placeholder:"e.g., SN12345"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{type:"submit",disabled:j,children:j?"Adding...":"Add Sensor"}),r.jsx(se,{type:"button",variant:"outline",onClick:()=>{s(!1),c({parameter_id:void 0,make:"",model:"",serial_number:""})},disabled:j,children:"Cancel"})]})]}):r.jsxs(se,{onClick:()=>s(!0),className:"w-full",children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Add Sensor"]})]})]})})}function kFe(){const[e,t]=R.useState(""),[n,s]=R.useState(null),[i,c]=R.useState(!1),[u,a]=R.useState(!1),[m,p]=R.useState(null),[y,v]=R.useState(!0),{data:j,isLoading:S}=r3e({search:e,per_page:100}),k=i3e(),N=a3e(),D=o3e(),O=(j==null?void 0:j.data)||[],T=()=>{s(null),a(!0),c(!0)},I=X=>{s(X),a(!1),c(!0)},z=async X=>{if(window.confirm(`Are you sure you want to delete station "${X.name}"?`))try{await k.mutateAsync(X.id),qe.success("Station deleted successfully")}catch(ve){qe.error(ve.message||"Failed to delete station")}},$=async X=>{try{await N.mutateAsync(X.id),qe.success("Station activated successfully")}catch(ve){qe.error(ve.message||"Failed to activate station")}},V=async X=>{try{await D.mutateAsync(X.id),qe.success("Station deactivated successfully")}catch(ve){qe.error(ve.message||"Failed to deactivate station")}},K=X=>{p(X)},te=()=>{c(!1),s(null),a(!1)};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Hydro-Met Stations Registry"}),r.jsx("p",{className:"text-muted-foreground",children:"Manage monitoring stations and sensor networks"})]}),r.jsxs(se,{onClick:T,children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Add Station"]})]}),y&&O.length>0&&r.jsxs(J,{className:"mb-6",children:[r.jsx(ge,{children:r.jsx(CardTitle,{children:"Stations Map"})}),r.jsx(ie,{children:r.jsx(AZ,{stations:O,selectedId:n==null?void 0:n.id,onSelect:X=>{const ve=O.find(ae=>ae.id===X);ve&&s(ve)},height:"400px"})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"flex-1 relative",children:[r.jsx(ci,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Search stations by name or code...",value:e,onChange:X=>t(X.target.value),className:"pl-10"})]}),r.jsxs(se,{variant:"outline",size:"sm",onClick:()=>v(!y),children:[r.jsx(Bc,{className:"mr-2 h-4 w-4"}),y?"Hide":"Show"," Map"]})]})}),r.jsx(ie,{children:S?r.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Loading stations..."}):O.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx(jT,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"No stations found"}),r.jsxs(se,{onClick:T,variant:"outline",className:"mt-4",children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Add your first station"]})]}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Code"}),r.jsx(le,{children:"Name"}),r.jsx(le,{children:"Type"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Elevation (m)"}),r.jsx(le,{children:"Sensors"}),r.jsx(le,{children:"Location"}),r.jsx(le,{className:"text-right",children:"Actions"})]})}),r.jsx(ur,{children:O.map(X=>{var ve,ae,pe;return r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:X.code}),r.jsx(ne,{children:X.name}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:((ve=X.station_type)==null?void 0:ve.name)||"N/A"})}),r.jsx(ne,{children:r.jsx(We,{variant:X.active?"default":"secondary",children:X.active?"Active":"Inactive"})}),r.jsx(ne,{className:"text-right",children:((ae=X.elevation_m)==null?void 0:ae.toFixed(1))||"N/A"}),r.jsx(ne,{children:r.jsxs(se,{variant:"ghost",size:"sm",onClick:()=>K(X),children:[((pe=X.sensors)==null?void 0:pe.length)||0," sensors"]})}),r.jsx(ne,{children:X.location?r.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[r.jsx(jo,{className:"h-3 w-3"}),r.jsxs("span",{children:[X.location.coordinates[1].toFixed(4),", ",X.location.coordinates[0].toFixed(4)]})]}):r.jsx("span",{className:"text-muted-foreground",children:"N/A"})}),r.jsx(ne,{className:"text-right",children:r.jsxs(NZ,{children:[r.jsx(PZ,{asChild:!0,children:r.jsx(se,{variant:"ghost",size:"sm",children:r.jsx(Hq,{className:"h-4 w-4"})})}),r.jsxs(FD,{align:"end",children:[r.jsxs(gh,{onClick:()=>I(X),children:[r.jsx(vd,{className:"mr-2 h-4 w-4"}),"Edit"]}),r.jsxs(gh,{onClick:()=>K(X),children:[r.jsx(jT,{className:"mr-2 h-4 w-4"}),"Manage Sensors"]}),X.active?r.jsxs(gh,{onClick:()=>V(X),children:[r.jsx(Xre,{className:"mr-2 h-4 w-4"}),"Deactivate"]}):r.jsxs(gh,{onClick:()=>$(X),children:[r.jsx(Ax,{className:"mr-2 h-4 w-4"}),"Activate"]}),r.jsxs(gh,{onClick:()=>z(X),className:"text-destructive",children:[r.jsx(Oi,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},X.id)})})]})})]}),r.jsx(CFe,{open:i,onClose:te,station:n,isCreating:u}),r.jsx(AFe,{station:m,onClose:()=>p(null)})]})}function M6(){return r.jsxs("div",{className:"flex min-h-screen",children:[r.jsx(za,{}),r.jsx("main",{className:"flex-1 p-8 overflow-auto",children:r.jsx(Fa,{})})]})}const si="/costing",Zy={getBudgetVersions:e=>{const t={};return e!=null&&e.fiscal_year&&(t.fiscal_year=e.fiscal_year.toString()),e!=null&&e.status&&(t.status=e.status),me.get(`${si}/budgets`,t)},getBudgetVersion:(e,t=!0)=>{const n={};return t!==void 0&&(n.include_lines=t.toString()),me.get(`${si}/budgets/${e}`,n)},createBudgetVersion:e=>me.post(`${si}/budgets`,e),updateBudgetVersion:(e,t)=>me.patch(`${si}/budgets/${e}`,t),deleteBudgetVersion:e=>me.delete(`${si}/budgets/${e}`),approveBudgetVersion:e=>me.post(`${si}/budgets/${e}/approve`),getBudgetLines:(e,t)=>{const n={};return t!=null&&t.cost_center_id&&(n.cost_center_id=t.cost_center_id.toString()),t!=null&&t.gl_account_id&&(n.gl_account_id=t.gl_account_id.toString()),t!=null&&t.period_from&&(n.period_from=t.period_from),t!=null&&t.period_to&&(n.period_to=t.period_to),me.get(`${si}/budgets/${e}/lines`,n)},upsertBudgetLines:(e,t)=>me.post(`${si}/budgets/${e}/lines`,{lines:t}),getBudgetSummary:e=>me.get(`${si}/budgets/${e}/summary`),getAllocationRules:e=>{const t={};return(e==null?void 0:e.active)!==void 0&&(t.active=e.active.toString()),me.get(`${si}/allocation-rules`,t)},createAllocationRule:e=>me.post(`${si}/allocation-rules`,e),updateAllocationRule:(e,t)=>me.patch(`${si}/allocation-rules/${e}`,t),deleteAllocationRule:e=>me.delete(`${si}/allocation-rules/${e}`),getAllocationRuns:e=>{const t={};return e!=null&&e.status&&(t.status=e.status),e!=null&&e.period_from&&(t.period_from=e.period_from),me.get(`${si}/allocation-runs`,t)},getAllocationRun:(e,t=!0)=>{const n={};return t!==void 0&&(n.include_results=t.toString()),me.get(`${si}/allocation-runs/${e}`,n)},executeAllocationRun:e=>me.post(`${si}/allocation-runs`,e),deleteAllocationRun:e=>me.delete(`${si}/allocation-runs/${e}`),getCostToServeMetrics:e=>{const t={};return e!=null&&e.period_from&&(t.period_from=e.period_from),e!=null&&e.period_to&&(t.period_to=e.period_to),e!=null&&e.scheme_id&&(t.scheme_id=e.scheme_id.toString()),e!=null&&e.dma_id&&(t.dma_id=e.dma_id.toString()),e!=null&&e.class&&(t.class=e.class),me.get(`${si}/cost-to-serve`,t)},calculateCostToServe:e=>me.post(`${si}/cost-to-serve`,e),getCostToServeSummary:e=>{const t={};return e!=null&&e.period_from&&(t.period_from=e.period_from),e!=null&&e.period_to&&(t.period_to=e.period_to),e!=null&&e.scheme_id&&(t.scheme_id=e.scheme_id.toString()),me.get(`${si}/cost-to-serve/summary`,t)},getDmaLeagueTable:e=>me.get(`${si}/cost-to-serve/dma-league/${e}`),getCostToServeTrends:e=>{const t={};return e!=null&&e.period_from&&(t.period_from=e.period_from),e!=null&&e.period_to&&(t.period_to=e.period_to),e!=null&&e.scheme_id&&(t.scheme_id=e.scheme_id.toString()),e!=null&&e.dma_id&&(t.dma_id=e.dma_id.toString()),me.get(`${si}/cost-to-serve/trends`,t)}},TFe=(e,t)=>ht({queryKey:["costing","budgets",e],queryFn:()=>Zy.getBudgetVersions(e),...t}),EFe=(e,t)=>ht({queryKey:["costing","allocation-rules",e],queryFn:()=>Zy.getAllocationRules(e),...t}),MFe=(e,t)=>ht({queryKey:["costing","allocation-runs",e],queryFn:()=>Zy.getAllocationRuns(e),...t}),OFe=(e,t)=>ht({queryKey:["costing","cost-to-serve",e],queryFn:()=>Zy.getCostToServeMetrics(e),...t}),IFe=(e,t)=>ht({queryKey:["costing","cost-to-serve","summary",e],queryFn:()=>Zy.getCostToServeSummary(e),...t}),DFe=(e,t)=>ht({queryKey:["costing","cost-to-serve","dma-league",e],queryFn:()=>Zy.getDmaLeagueTable(e),enabled:e!=null,...t});function RFe(){const e=vy(),[t,n]=R.useState(""),[s,i]=R.useState("all"),c=R.useMemo(()=>s==="all"?{}:{fiscal_year:parseInt(s)},[s]),{data:u,isLoading:a,error:m}=TFe(c),p=S=>{const k={draft:{variant:"secondary",icon:is},submitted:{variant:"outline",icon:xs},approved:{variant:"default",icon:Nx},archived:{variant:"outline",icon:kre}},N=k[S]||k.draft,D=N.icon;return r.jsxs(We,{variant:N.variant,className:"gap-1",children:[r.jsx(D,{className:"h-3 w-3"}),S.charAt(0).toUpperCase()+S.slice(1)]})},y=(u==null?void 0:u.data)||[],v=y.filter(S=>S.name.toLowerCase().includes(t.toLowerCase())),j=R.useMemo(()=>{const S=y.length,k=y.filter(O=>O.status==="approved").length,N=y.filter(O=>O.status==="submitted").length,D=y.filter(O=>O.status==="draft").length;return{total:S,approved:k,pending:N,draft:D}},[y]);return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Budget Management"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Create and manage annual budgets with approval workflows"})]}),r.jsxs(se,{className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"Create Budget"]})]}),r.jsxs(J,{className:"p-6",children:[r.jsxs("div",{className:"flex gap-4 mb-6",children:[r.jsxs("div",{className:"flex-1 relative",children:[r.jsx(ci,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Search budgets...",value:t,onChange:S=>n(S.target.value),className:"pl-10"})]}),r.jsxs("select",{value:s,onChange:S=>i(S.target.value),className:"px-3 py-2 border rounded-md bg-background",children:[r.jsx("option",{value:"all",children:"All Years"}),r.jsx("option",{value:"2026",children:"FY 2026"}),r.jsx("option",{value:"2025",children:"FY 2025"}),r.jsx("option",{value:"2024",children:"FY 2024"})]})]}),m&&r.jsxs("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded-md mb-4",children:["Error loading budgets: ",m instanceof Error?m.message:"Unknown error"]}),a?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx(Qu,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Budget Name"}),r.jsx(le,{children:"Fiscal Year"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Created"}),r.jsx(le,{})]})}),r.jsx(ur,{children:v.length===0?r.jsx(lt,{children:r.jsx(ne,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No budgets found"})}):v.map(S=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:S.name}),r.jsx(ne,{children:S.fiscal_year}),r.jsx(ne,{children:p(S.status)}),r.jsx(ne,{children:new Date(S.created_at).toLocaleDateString()}),r.jsx(ne,{children:r.jsx(se,{variant:"ghost",size:"sm",onClick:()=>e(`/costing/budgets/${S.id}`),children:"View Details"})})]},S.id))})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs(J,{className:"p-6",children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Budgets"}),r.jsx("div",{className:"text-3xl font-bold mt-2",children:j.total})]}),r.jsxs(J,{className:"p-6",children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Approved"}),r.jsx("div",{className:"text-3xl font-bold mt-2",children:j.approved})]}),r.jsxs(J,{className:"p-6",children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Pending Approval"}),r.jsx("div",{className:"text-3xl font-bold mt-2",children:j.pending})]}),r.jsxs(J,{className:"p-6",children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Draft"}),r.jsx("div",{className:"text-3xl font-bold mt-2",children:j.draft})]})]})]})}function LFe(){const{id:e}=AO(),t=vy(),[n,s]=R.useState(!1),[i,c]=R.useState(""),u={name:"FY 2025 Operating Budget",fiscal_year:2025,status:"submitted",total_amount:25e5,created_at:"2024-09-15",created_by:{name:"John Smith"}},a=[{month:"2025-01",amount:208333,actuals:195e3,variance:-13333,variance_pct:-6.4},{month:"2025-02",amount:208333,actuals:21e4,variance:1667,variance_pct:.8},{month:"2025-03",amount:208333,actuals:198e3,variance:-10333,variance_pct:-5},{month:"2025-04",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-05",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-06",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-07",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-08",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-09",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-10",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-11",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-12",amount:208333,actuals:0,variance:0,variance_pct:0}],m=[{id:1,cost_center:"Operations",gl_account:"5110 - Electricity",amount:12e4,ytd_actual:35e3},{id:2,cost_center:"Operations",gl_account:"5120 - Chemicals",amount:85e3,ytd_actual:22e3},{id:3,cost_center:"Engineering",gl_account:"5200 - Salaries",amount:48e4,ytd_actual:14e4},{id:4,cost_center:"Finance",gl_account:"5300 - Admin",amount:18e4,ytd_actual:48e3}],p=()=>{console.log("Approving budget with notes:",i),s(!1),t("/costing/budgets")},y=v=>{const j={draft:{variant:"secondary",icon:is},submitted:{variant:"outline",icon:is},approved:{variant:"default",icon:Nx}},S=j[v]||j.draft,k=S.icon;return r.jsxs(We,{variant:S.variant,className:"gap-1",children:[r.jsx(k,{className:"h-3 w-3"}),v.charAt(0).toUpperCase()+v.slice(1)]})};return r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex items-center gap-4",children:r.jsxs(se,{variant:"ghost",size:"sm",onClick:()=>t("/costing/budgets"),children:[r.jsx(Uq,{className:"h-4 w-4 mr-2"}),"Back to Budgets"]})}),r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:u.name}),r.jsxs("p",{className:"text-muted-foreground mt-1",children:["Created by ",u.created_by.name," on ",new Date(u.created_at).toLocaleDateString()]})]}),r.jsxs("div",{className:"flex gap-2",children:[y(u.status),r.jsxs(se,{onClick:()=>s(!0),className:"gap-2",children:[r.jsx(Nx,{className:"h-4 w-4"}),"Approve Budget"]})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs(J,{className:"p-6",children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Budget"}),r.jsxs("div",{className:"text-3xl font-bold mt-2",children:["$",(u.total_amount/1e3).toFixed(0),"K"]})]}),r.jsxs(J,{className:"p-6",children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"YTD Actuals"}),r.jsx("div",{className:"text-3xl font-bold mt-2",children:"$603K"}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"24% of budget"})]}),r.jsxs(J,{className:"p-6",children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"YTD Variance"}),r.jsx("div",{className:"text-3xl font-bold mt-2 text-red-600",children:"-$22K"}),r.jsx("p",{className:"text-xs text-red-600 mt-1",children:"-3.5% unfavorable"})]}),r.jsxs(J,{className:"p-6",children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Fiscal Year"}),r.jsx("div",{className:"text-3xl font-bold mt-2",children:u.fiscal_year})]})]}),r.jsxs(qs,{defaultValue:"breakdown",children:[r.jsxs(As,{children:[r.jsx(sr,{value:"breakdown",children:"Monthly Breakdown"}),r.jsx(sr,{value:"lines",children:"Budget Lines"})]}),r.jsx(Nr,{value:"breakdown",className:"mt-6",children:r.jsxs(J,{className:"p-6",children:[r.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Monthly Budget vs Actuals"}),r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Month"}),r.jsx(le,{className:"text-right",children:"Budget"}),r.jsx(le,{className:"text-right",children:"Actuals"}),r.jsx(le,{className:"text-right",children:"Variance"}),r.jsx(le,{className:"text-right",children:"Variance %"})]})}),r.jsx(ur,{children:a.map(v=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:v.month}),r.jsxs(ne,{className:"text-right font-mono",children:["$",v.amount.toLocaleString()]}),r.jsx(ne,{className:"text-right font-mono",children:v.actuals>0?`$${v.actuals.toLocaleString()}`:"-"}),r.jsx(ne,{className:`text-right font-mono ${v.variance<0?"text-red-600":v.variance>0?"text-green-600":""}`,children:v.variance!==0?`$${v.variance.toLocaleString()}`:"-"}),r.jsx(ne,{className:"text-right",children:v.variance_pct!==0?r.jsxs(We,{variant:v.variance_pct<0?"destructive":"default",className:"gap-1",children:[v.variance_pct<0?r.jsx(eo,{className:"h-3 w-3"}):r.jsx($s,{className:"h-3 w-3"}),Math.abs(v.variance_pct).toFixed(1),"%"]}):"-"})]},v.month))})]})]})}),r.jsx(Nr,{value:"lines",className:"mt-6",children:r.jsxs(J,{className:"p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Budget Line Items"}),r.jsx(se,{size:"sm",children:"Add Line"})]}),r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Cost Center"}),r.jsx(le,{children:"GL Account"}),r.jsx(le,{className:"text-right",children:"Annual Budget"}),r.jsx(le,{className:"text-right",children:"YTD Actual"}),r.jsx(le,{className:"text-right",children:"% Utilized"})]})}),r.jsx(ur,{children:m.map(v=>{const j=v.ytd_actual/v.amount*100;return r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:v.cost_center}),r.jsx(ne,{className:"text-sm text-muted-foreground",children:v.gl_account}),r.jsxs(ne,{className:"text-right font-mono",children:["$",v.amount.toLocaleString()]}),r.jsxs(ne,{className:"text-right font-mono",children:["$",v.ytd_actual.toLocaleString()]}),r.jsx(ne,{className:"text-right",children:r.jsxs(We,{variant:j>100?"destructive":j>75?"outline":"secondary",children:[j.toFixed(0),"%"]})})]},v.id)})})]})]})})]}),r.jsx(Rr,{open:n,onOpenChange:s,children:r.jsxs(Er,{children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:"Approve Budget"}),r.jsxs(Bs,{children:['You are about to approve "',u.name,'". This action will lock the budget for the fiscal year.']})]}),r.jsx("div",{className:"space-y-4 py-4",children:r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:"Approval Notes (optional)"}),r.jsx(Fs,{placeholder:"Add any comments or conditions...",value:i,onChange:v=>c(v.target.value),className:"mt-2",rows:4})]})}),r.jsxs(Ai,{children:[r.jsx(se,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),r.jsx(se,{onClick:p,children:"Approve Budget"})]})]})})]})}function FFe(){const[e,t]=R.useState("rules"),{data:n,isLoading:s,error:i}=EFe({active:!0}),{data:c,isLoading:u,error:a}=MFe(),m=(n==null?void 0:n.data)||[],p=(c==null?void 0:c.data)||[],y=v=>{const j={running:{variant:"secondary",icon:xs},completed:{variant:"default",icon:os},failed:{variant:"destructive",icon:yd}},S=j[v]||j.running,k=S.icon;return r.jsxs(We,{variant:S.variant,className:"gap-1",children:[r.jsx(k,{className:"h-3 w-3"}),v.charAt(0).toUpperCase()+v.slice(1)]})};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Allocation Console"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage cost allocation rules and execute allocation runs"})]}),r.jsxs(se,{className:"gap-2",variant:"default",children:[r.jsx(od,{className:"h-4 w-4"}),"Execute Allocation"]})]}),r.jsxs(qs,{value:e,onValueChange:t,children:[r.jsxs(As,{children:[r.jsx(sr,{value:"rules",children:"Allocation Rules"}),r.jsx(sr,{value:"runs",children:"Allocation Runs"})]}),r.jsx(Nr,{value:"rules",className:"mt-6",children:r.jsxs(J,{className:"p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Active Allocation Rules"}),r.jsxs(se,{size:"sm",className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"New Rule"]})]}),i&&r.jsxs("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded-md mb-4",children:["Error loading rules: ",i instanceof Error?i.message:"Unknown error"]}),s?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx(Qu,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):m.length===0?r.jsx("div",{className:"text-center text-muted-foreground py-8",children:'No allocation rules configured. Click "New Rule" to create one.'}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Rule Name"}),r.jsx(le,{children:"Allocation Basis"}),r.jsx(le,{children:"Driver/Percentage"}),r.jsx(le,{children:"Applies To"}),r.jsx(le,{children:"Status"}),r.jsx(le,{})]})}),r.jsx(ur,{children:m.map(v=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:v.name}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:v.basis.charAt(0).toUpperCase()+v.basis.slice(1)})}),r.jsx(ne,{children:v.basis==="driver"&&v.driver?`Driver: ${v.driver.name}`:v.basis==="percentage"&&v.percentage?`${v.percentage}%`:"Equal Split"}),r.jsx(ne,{className:"text-sm text-muted-foreground",children:v.applies_to}),r.jsx(ne,{children:r.jsx(We,{variant:v.active?"default":"secondary",children:v.active?"Active":"Inactive"})}),r.jsx(ne,{children:r.jsx(se,{variant:"ghost",size:"sm",children:"Edit"})})]},v.id))})]})]})}),r.jsx(Nr,{value:"runs",className:"mt-6",children:r.jsxs(J,{className:"p-6",children:[r.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Allocation Run History"}),a&&r.jsxs("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded-md mb-4",children:["Error loading runs: ",a instanceof Error?a.message:"Unknown error"]}),u?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx(Qu,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):p.length===0?r.jsx("div",{className:"text-center text-muted-foreground py-8",children:'No allocation runs executed yet. Click "Execute Allocation" to run one.'}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Period"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Started At"}),r.jsx(le,{children:"Completed At"}),r.jsx(le,{className:"text-right",children:"Results"}),r.jsx(le,{})]})}),r.jsx(ur,{children:p.map(v=>{var j;return r.jsxs(lt,{children:[r.jsxs(ne,{className:"font-medium",children:[v.period_from," to ",v.period_to]}),r.jsx(ne,{children:y(v.status)}),r.jsx(ne,{className:"text-sm",children:new Date(v.started_at).toLocaleString()}),r.jsx(ne,{className:"text-sm",children:v.completed_at?new Date(v.completed_at).toLocaleString():"-"}),r.jsx(ne,{className:"text-right font-mono",children:((j=v.meta)==null?void 0:j.results_count)??0}),r.jsxs(ne,{children:[v.status==="completed"&&r.jsx(se,{variant:"ghost",size:"sm",children:"View Results"}),v.status==="failed"&&r.jsx(se,{variant:"ghost",size:"sm",children:"View Error"})]})]},v.id)})})]})]})})]})]})}function zFe(){const[e,t]=R.useState("2025-01"),{data:n,isLoading:s,error:i}=DFe(e),{data:c,isLoading:u,error:a}=IFe({period_from:e,period_to:e}),{data:m,isLoading:p}=OFe({period_from:e,period_to:e}),y=(n==null?void 0:n.data)||[],v=c==null?void 0:c.data,j=(m==null?void 0:m.data)||[],S=R.useMemo(()=>j.length===0?0:j.reduce((D,O)=>D+(O.opex_cost||0)+(O.capex_depr||0)+(O.energy_cost||0)+(O.chemical_cost||0)+(O.other_cost||0),0),[j]),k=R.useMemo(()=>{const D={};return j.forEach(O=>{const T=O.class||"Unclassified";D[T]||(D[T]={class:T,connections:0,volume_m3:0,revenue:0,cost:0,margin:0}),D[T].volume_m3+=O.production_m3||0;const I=(O.revenue_per_m3||0)*(O.billed_m3||0),z=(O.opex_cost||0)+(O.capex_depr||0)+(O.energy_cost||0)+(O.chemical_cost||0)+(O.other_cost||0);D[T].revenue+=I,D[T].cost+=z}),Object.values(D).map(O=>({...O,margin:O.revenue>0?Math.round((O.revenue-O.cost)/O.revenue*100):0}))},[j]),N=D=>D===1?r.jsx(We,{variant:"default",className:"bg-green-600",children:" Best"}):D<=3?r.jsxs(We,{variant:"outline",children:["#",D]}):r.jsxs(We,{variant:"secondary",children:["#",D]});return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Cost-to-Serve Analytics"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"DMA profitability, customer class analysis, and cost trends"})]}),r.jsxs("select",{value:e,onChange:D=>t(D.target.value),className:"px-4 py-2 border rounded-md bg-background",children:[r.jsx("option",{value:"2025-01",children:"January 2025"}),r.jsx("option",{value:"2024-12",children:"December 2024"}),r.jsx("option",{value:"2024-11",children:"November 2024"})]})]}),a&&r.jsxs("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded-md mb-4",children:["Error loading summary: ",a instanceof Error?a.message:"Unknown error"]}),u?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx(Qu,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):v?r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs(J,{className:"p-6",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[r.jsx(ac,{className:"h-4 w-4"}),"Total Volume"]}),r.jsx("div",{className:"text-3xl font-bold mt-2",children:`${(v.total_production_m3/1e3).toFixed(0)}K m`}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Produced this period"})]}),r.jsxs(J,{className:"p-6",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[r.jsx(Za,{className:"h-4 w-4"}),"Total Cost"]}),r.jsxs("div",{className:"text-3xl font-bold mt-2",children:["$",(S/1e3).toFixed(1),"K"]}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"All cost categories"})]}),r.jsxs(J,{className:"p-6",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[r.jsx(eo,{className:"h-4 w-4 text-green-600"}),"Avg Cost/m"]}),r.jsxs("div",{className:"text-3xl font-bold mt-2",children:["$",v.avg_cost_per_m3.toFixed(2)]}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Blended rate"})]}),r.jsxs(J,{className:"p-6",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[r.jsx($s,{className:"h-4 w-4"}),"Non-Revenue Water"]}),r.jsxs("div",{className:"text-3xl font-bold mt-2",children:[v.nrw_percentage.toFixed(1),"%"]}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"System losses"})]})]}):null,r.jsxs(J,{className:"p-6",children:[r.jsx("h3",{className:"text-lg font-semibold mb-6",children:"DMA Cost-to-Serve League Table"}),i&&r.jsxs("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded-md mb-4",children:["Error loading DMA data: ",i instanceof Error?i.message:"Unknown error"]}),s?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx(Qu,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):y.length===0?r.jsxs("div",{className:"text-center text-muted-foreground py-8",children:["No DMA data available for ",e]}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Rank"}),r.jsx(le,{children:"DMA"}),r.jsx(le,{className:"text-right",children:"Volume (m)"}),r.jsx(le,{className:"text-right",children:"Total Cost"}),r.jsx(le,{className:"text-right",children:"Cost per m"}),r.jsx(le,{children:"Efficiency"})]})}),r.jsx(ur,{children:y.map((D,O)=>r.jsxs(lt,{children:[r.jsx(ne,{children:N(O+1)}),r.jsxs(ne,{className:"font-medium",children:["DMA-",D.dma_id]}),r.jsx(ne,{className:"text-right font-mono",children:(D.production_m3||0).toLocaleString()}),r.jsxs(ne,{className:"text-right font-mono",children:["$",((D.cost_per_m3||0)*(D.production_m3||0)).toLocaleString()]}),r.jsxs(ne,{className:"text-right font-mono font-bold",children:["$",(D.cost_per_m3||0).toFixed(2)]}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:(D.cost_per_m3||0)<.2?"Excellent":(D.cost_per_m3||0)<.3?"Good":"Review"})})]},D.dma_id||O))})]})]}),r.jsxs(J,{className:"p-6",children:[r.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Customer Class Profitability"}),p?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx(Qu,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):k.length===0?r.jsxs("div",{className:"text-center text-muted-foreground py-8",children:["No customer class data available for ",e]}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Customer Class"}),r.jsx(le,{className:"text-right",children:"Volume (m)"}),r.jsx(le,{className:"text-right",children:"Revenue"}),r.jsx(le,{className:"text-right",children:"Cost"}),r.jsx(le,{className:"text-right",children:"Margin %"})]})}),r.jsx(ur,{children:k.map(D=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:D.class}),r.jsx(ne,{className:"text-right font-mono",children:D.volume_m3.toLocaleString()}),r.jsxs(ne,{className:"text-right font-mono",children:["$",D.revenue.toLocaleString()]}),r.jsxs(ne,{className:"text-right font-mono",children:["$",D.cost.toLocaleString()]}),r.jsx(ne,{className:"text-right",children:r.jsxs(We,{variant:D.margin>=70?"default":D.margin>=60?"outline":"secondary",children:[D.margin,"%"]})})]},D.class))})]})]})]})}function $Fe(){const[e,t]=R.useState(""),[n,s]=R.useState(new Set(["4"])),i=[{id:"1",code:"1000",name:"Assets",type:"asset",level:0,parent_id:null,active:!0,has_children:!0},{id:"2",code:"2000",name:"Liabilities",type:"liability",level:0,parent_id:null,active:!0,has_children:!1},{id:"3",code:"3000",name:"Equity",type:"equity",level:0,parent_id:null,active:!0,has_children:!1},{id:"4",code:"4000",name:"Revenue",type:"revenue",level:0,parent_id:null,active:!0,has_children:!0},{id:"5",code:"4100",name:"Water Sales",type:"revenue",level:1,parent_id:"4",active:!0,has_children:!0},{id:"6",code:"4110",name:"Residential Water Sales",type:"revenue",level:2,parent_id:"5",active:!0,has_children:!1},{id:"7",code:"4120",name:"Commercial Water Sales",type:"revenue",level:2,parent_id:"5",active:!0,has_children:!1},{id:"8",code:"4200",name:"Connection Fees",type:"revenue",level:1,parent_id:"4",active:!0,has_children:!1},{id:"9",code:"5000",name:"Expenses",type:"expense",level:0,parent_id:null,active:!0,has_children:!0},{id:"10",code:"5100",name:"Operations",type:"expense",level:1,parent_id:"9",active:!0,has_children:!0},{id:"11",code:"5110",name:"Electricity",type:"expense",level:2,parent_id:"10",active:!0,has_children:!1},{id:"12",code:"5120",name:"Chemicals",type:"expense",level:2,parent_id:"10",active:!0,has_children:!1}],c=p=>{const y={asset:"bg-blue-100 text-blue-700",liability:"bg-red-100 text-red-700",equity:"bg-purple-100 text-purple-700",revenue:"bg-green-100 text-green-700",expense:"bg-orange-100 text-orange-700"};return r.jsx(We,{className:y[p]||"",children:p.charAt(0).toUpperCase()+p.slice(1)})},u=p=>{const y=new Set(n);y.has(p)?y.delete(p):y.add(p),s(y)},a=p=>{if(!p.parent_id)return!0;const y=i.find(v=>v.id===p.parent_id);return y?n.has(p.parent_id)?a(y):!1:!0},m=i.filter(p=>(e===""||p.code.toLowerCase().includes(e.toLowerCase())||p.name.toLowerCase().includes(e.toLowerCase()))&&a(p));return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"GL Accounts"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Chart of accounts with hierarchical structure"})]}),r.jsxs(se,{className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"New Account"]})]}),r.jsxs(J,{className:"p-6",children:[r.jsxs("div",{className:"mb-6 relative",children:[r.jsx(ci,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Search by code or name...",value:e,onChange:p=>t(p.target.value),className:"pl-10"})]}),r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Code"}),r.jsx(le,{children:"Account Name"}),r.jsx(le,{children:"Type"}),r.jsx(le,{children:"Status"}),r.jsx(le,{})]})}),r.jsx(ur,{children:m.map(p=>r.jsxs(lt,{className:p.level>0?"bg-muted/30":"",children:[r.jsx(ne,{className:"font-mono font-medium",children:r.jsxs("div",{className:"flex items-center gap-2",children:[p.level>0&&r.jsx("span",{className:"text-muted-foreground",style:{marginLeft:`${p.level*20}px`},children:""}),p.has_children&&r.jsx("button",{onClick:()=>u(p.id),className:"hover:bg-muted rounded p-1",children:r.jsx(by,{className:`h-4 w-4 transition-transform ${n.has(p.id)?"rotate-90":""}`})}),p.code]})}),r.jsx(ne,{className:"font-medium",children:p.name}),r.jsx(ne,{children:c(p.type)}),r.jsx(ne,{children:r.jsx(We,{variant:p.active?"default":"secondary",children:p.active?"Active":"Inactive"})}),r.jsx(ne,{children:r.jsx(se,{variant:"ghost",size:"sm",children:"Edit"})})]},p.id))})]})]}),r.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[r.jsxs(J,{className:"p-4",children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"Assets"}),r.jsx("div",{className:"text-2xl font-bold mt-1",children:"1"})]}),r.jsxs(J,{className:"p-4",children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"Liabilities"}),r.jsx("div",{className:"text-2xl font-bold mt-1",children:"1"})]}),r.jsxs(J,{className:"p-4",children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"Equity"}),r.jsx("div",{className:"text-2xl font-bold mt-1",children:"1"})]}),r.jsxs(J,{className:"p-4",children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"Revenue"}),r.jsx("div",{className:"text-2xl font-bold mt-1",children:"4"})]}),r.jsxs(J,{className:"p-4",children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"Expenses"}),r.jsx("div",{className:"text-2xl font-bold mt-1",children:"5"})]})]})]})}function BFe(){const[e,t]=R.useState(""),n=[{id:1,code:"CC-100",name:"Operations",owner:"John Smith",active:!0,parent:null},{id:2,code:"CC-101",name:"Water Production",owner:"Jane Doe",active:!0,parent:"Operations"},{id:3,code:"CC-102",name:"Distribution",owner:"Bob Johnson",active:!0,parent:"Operations"},{id:4,code:"CC-200",name:"Engineering",owner:"Alice Williams",active:!0,parent:null},{id:5,code:"CC-201",name:"Design & Planning",owner:"Charlie Brown",active:!0,parent:"Engineering"},{id:6,code:"CC-300",name:"Finance",owner:"Diana Prince",active:!0,parent:null},{id:7,code:"CC-400",name:"Administration",owner:"Eve Adams",active:!0,parent:null},{id:8,code:"CC-500",name:"Customer Service",owner:"Frank Miller",active:!0,parent:null}],s=n.filter(i=>i.code.toLowerCase().includes(e.toLowerCase())||i.name.toLowerCase().includes(e.toLowerCase())||i.owner&&i.owner.toLowerCase().includes(e.toLowerCase()));return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Cost Centers"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Organizational units for cost tracking and allocation"})]}),r.jsxs(se,{className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"New Cost Center"]})]}),r.jsxs(J,{className:"p-6",children:[r.jsxs("div",{className:"mb-6 relative",children:[r.jsx(ci,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Search cost centers...",value:e,onChange:i=>t(i.target.value),className:"pl-10"})]}),r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Code"}),r.jsx(le,{children:"Cost Center Name"}),r.jsx(le,{children:"Parent"}),r.jsx(le,{children:"Owner"}),r.jsx(le,{children:"Status"}),r.jsx(le,{})]})}),r.jsx(ur,{children:s.length===0?r.jsx(lt,{children:r.jsx(ne,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No cost centers found"})}):s.map(i=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-mono font-medium",children:i.code}),r.jsx(ne,{children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Gq,{className:"h-4 w-4 text-muted-foreground"}),r.jsx("span",{className:"font-medium",children:i.name})]})}),r.jsx(ne,{className:"text-sm text-muted-foreground",children:i.parent||"-"}),r.jsx(ne,{className:"text-sm",children:i.owner||"-"}),r.jsx(ne,{children:r.jsx(We,{variant:i.active?"default":"secondary",children:i.active?"Active":"Inactive"})}),r.jsx(ne,{children:r.jsx(se,{variant:"ghost",size:"sm",children:"Edit"})})]},i.id))})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs(J,{className:"p-6",children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Cost Centers"}),r.jsx("div",{className:"text-3xl font-bold mt-2",children:n.length})]}),r.jsxs(J,{className:"p-6",children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Active"}),r.jsx("div",{className:"text-3xl font-bold mt-2",children:n.filter(i=>i.active).length})]}),r.jsxs(J,{className:"p-6",children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"With Owner"}),r.jsx("div",{className:"text-3xl font-bold mt-2",children:n.filter(i=>i.owner).length})]}),r.jsxs(J,{className:"p-6",children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Parent Centers"}),r.jsx("div",{className:"text-3xl font-bold mt-2",children:n.filter(i=>!i.parent).length})]})]})]})}function qFe(){const[e,t]=R.useState(!1),[n,s]=R.useState({name:"",valid_from:"",valid_to:"",peak_rate:"",offpeak_rate:"",demand_charge:"",currency:"KES"}),i=br(),{data:c}=ht({queryKey:["energy-tariffs"],queryFn:async()=>(await fetch("/api/v1/costing/energy/tariffs")).json()}),u=jt({mutationFn:async p=>{const y=await fetch("/api/v1/costing/energy/tariffs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!y.ok)throw new Error("Failed to create tariff");return y.json()},onSuccess:()=>{i.invalidateQueries({queryKey:["energy-tariffs"]}),t(!1),s({name:"",valid_from:"",valid_to:"",peak_rate:"",offpeak_rate:"",demand_charge:"",currency:"KES"})}}),a=p=>{p.preventDefault(),u.mutate(n)},m=p=>{const y=new Date,v=new Date(p.valid_from),j=p.valid_to?new Date(p.valid_to):null;return v<=y&&(!j||j>=y)};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Energy Tariff Setup"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage utility tariff rates for energy cost calculations"})]}),r.jsxs(Rr,{open:e,onOpenChange:t,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"New Tariff"]})}),r.jsxs(Er,{className:"max-w-2xl",children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Create Energy Tariff"})}),r.jsxs("form",{onSubmit:a,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"col-span-2",children:[r.jsx(Ne,{htmlFor:"name",children:"Tariff Name *"}),r.jsx(Ge,{id:"name",value:n.name,onChange:p=>s({...n,name:p.target.value}),placeholder:"e.g., KPLC Industrial Rate 2025",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"valid_from",children:"Valid From *"}),r.jsx(Ge,{id:"valid_from",type:"date",value:n.valid_from,onChange:p=>s({...n,valid_from:p.target.value}),required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"valid_to",children:"Valid To"}),r.jsx(Ge,{id:"valid_to",type:"date",value:n.valid_to,onChange:p=>s({...n,valid_to:p.target.value})})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"peak_rate",children:"Peak Rate (per kWh) *"}),r.jsx(Ge,{id:"peak_rate",type:"number",step:"0.0001",value:n.peak_rate,onChange:p=>s({...n,peak_rate:p.target.value}),placeholder:"15.80",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"offpeak_rate",children:"Off-Peak Rate (per kWh) *"}),r.jsx(Ge,{id:"offpeak_rate",type:"number",step:"0.0001",value:n.offpeak_rate,onChange:p=>s({...n,offpeak_rate:p.target.value}),placeholder:"8.50",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"demand_charge",children:"Demand Charge (per kVA)"}),r.jsx(Ge,{id:"demand_charge",type:"number",step:"0.0001",value:n.demand_charge,onChange:p=>s({...n,demand_charge:p.target.value}),placeholder:"450.00"})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"currency",children:"Currency"}),r.jsx(Ge,{id:"currency",value:n.currency,onChange:p=>s({...n,currency:p.target.value}),placeholder:"KES",maxLength:3})]})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:u.isPending,children:u.isPending?"Creating...":"Create Tariff"})]})]})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(bo,{className:"h-5 w-5"}),"Tariff Registry"]})}),r.jsx(ie,{children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Tariff Name"}),r.jsx(le,{children:"Peak Rate"}),r.jsx(le,{children:"Off-Peak Rate"}),r.jsx(le,{children:"Demand Charge"}),r.jsx(le,{children:"Valid Period"}),r.jsx(le,{children:"Status"})]})}),r.jsx(ur,{children:c!=null&&c.data&&c.data.length>0?c.data.map(p=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:p.name}),r.jsxs(ne,{children:[p.currency," ",parseFloat(p.peak_rate).toFixed(2),"/kWh"]}),r.jsxs(ne,{children:[p.currency," ",parseFloat(p.offpeak_rate).toFixed(2),"/kWh"]}),r.jsx(ne,{children:p.demand_charge?`${p.currency} ${parseFloat(p.demand_charge).toFixed(2)}/kVA`:"N/A"}),r.jsx(ne,{children:r.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[r.jsx(va,{className:"h-3 w-3"}),new Date(p.valid_from).toLocaleDateString(),p.valid_to&&` - ${new Date(p.valid_to).toLocaleDateString()}`]})}),r.jsx(ne,{children:m(p)?r.jsx(We,{className:"bg-green-100 text-green-700",children:"Active"}):r.jsx(We,{className:"bg-gray-100 text-gray-700",children:"Inactive"})})]},p.id)):r.jsx(lt,{children:r.jsx(ne,{colSpan:6,className:"text-center text-muted-foreground",children:"No tariffs configured yet"})})})]})})]})]})}function VFe(){const[e,t]=R.useState(null),[n,s]=R.useState(""),[i,c]=R.useState(null),u=jt({mutationFn:async m=>{const p=await fetch("/api/v1/costing/energy/readings/upload",{method:"POST",body:m});if(!p.ok)throw new Error("Upload failed");return p.json()},onSuccess:m=>{c(m.data),t(null)}}),a=m=>{if(m.preventDefault(),!e||!n)return;const p=new FormData;p.append("file",e),p.append("period_month",n),u.mutate(p)};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Energy Readings Upload"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Bulk import energy consumption data from CSV files"})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Go,{className:"h-5 w-5"}),"Upload CSV File"]})}),r.jsxs(ie,{children:[r.jsxs("form",{onSubmit:a,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"period",children:"Reporting Period *"}),r.jsx(Ge,{id:"period",type:"month",value:n,onChange:m=>s(m.target.value),required:!0}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Month and year for the readings"})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"file",children:"CSV File *"}),r.jsx(Ge,{id:"file",type:"file",accept:".csv",onChange:m=>{var p;return t(((p=m.target.files)==null?void 0:p[0])||null)},required:!0}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Maximum file size: 10MB"})]}),e&&r.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 border border-blue-200 rounded",children:[r.jsx(Wre,{className:"h-4 w-4 text-blue-600"}),r.jsx("span",{className:"text-sm text-blue-900",children:e.name}),r.jsxs("span",{className:"text-xs text-blue-600 ml-auto",children:[(e.size/1024).toFixed(2)," KB"]})]}),r.jsx(se,{type:"submit",className:"w-full",disabled:u.isPending,children:u.isPending?"Uploading...":"Upload & Process"})]}),i&&r.jsxs("div",{className:"mt-6 space-y-3",children:[r.jsxs(Wi,{className:"border-green-200 bg-green-50",children:[r.jsx(Kh,{className:"h-4 w-4 text-green-600"}),r.jsxs(ki,{className:"text-green-800",children:[r.jsx("strong",{children:"Success!"})," Imported ",i.imported," of ",i.total_rows," records"]})]}),i.errors&&i.errors.length>0&&r.jsxs(Wi,{className:"border-orange-200 bg-orange-50",children:[r.jsx(ei,{className:"h-4 w-4 text-orange-600"}),r.jsxs(ki,{className:"text-orange-800",children:[r.jsxs("strong",{children:[i.errors.length," errors:"]}),r.jsx("ul",{className:"mt-2 text-xs space-y-1 max-h-32 overflow-y-auto",children:i.errors.slice(0,10).map((m,p)=>r.jsxs("li",{children:[" ",m]},p))})]})]})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"CSV Format Requirements"})}),r.jsxs(ie,{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-sm mb-2",children:"Required Columns:"}),r.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[r.jsxs("li",{children:[" ",r.jsx("code",{className:"bg-muted px-1 py-0.5 rounded",children:"scheme_name"})," - Scheme identifier"]}),r.jsxs("li",{children:[" ",r.jsx("code",{className:"bg-muted px-1 py-0.5 rounded",children:"kwh"})," - Energy consumption in kWh"]}),r.jsxs("li",{children:[" ",r.jsx("code",{className:"bg-muted px-1 py-0.5 rounded",children:"peak_kwh"})," - Peak period consumption"]}),r.jsxs("li",{children:[" ",r.jsx("code",{className:"bg-muted px-1 py-0.5 rounded",children:"offpeak_kwh"})," - Off-peak consumption"]}),r.jsxs("li",{children:[" ",r.jsx("code",{className:"bg-muted px-1 py-0.5 rounded",children:"demand_kva"})," - Maximum demand"]})]})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-sm mb-2",children:"Sample CSV:"}),r.jsx("pre",{className:"text-xs bg-muted p-3 rounded overflow-x-auto",children:`scheme_name,kwh,peak_kwh,offpeak_kwh,demand_kva
Nairobi Central,125400,75200,50200,850
Mombasa North,98200,58900,39300,720
Kisumu West,45600,27100,18500,390`})]}),r.jsxs(Wi,{children:[r.jsx(ei,{className:"h-4 w-4"}),r.jsx(ki,{className:"text-xs",children:"Make sure all numeric values are valid and scheme names match existing records"})]})]})]})]})]})}function UFe(){const{data:e}=ht({queryKey:["energy-dashboard"],queryFn:async()=>(await fetch("/api/v1/costing/energy/dashboard")).json()}),{data:t}=ht({queryKey:["energy-trend"],queryFn:async()=>(await fetch("/api/v1/costing/energy/specific-energy-trend?months=12")).json()}),n=(e==null?void 0:e.data)||{current_tariff:null,total_consumption_kwh:125400,total_cost:1893600,specific_energy_kwh_m3:.42,cost_per_m3:6.35};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Energy Cost Dashboard"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Energy consumption analytics, specific energy trends, and cost optimization"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Total Consumption"}),r.jsx(bo,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:[n.total_consumption_kwh.toLocaleString()," kWh"]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"This month"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Total Cost"}),r.jsx(Za,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:["KES ",n.total_cost.toLocaleString()]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Energy expenditure"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Specific Energy"}),r.jsx(Wo,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:[n.specific_energy_kwh_m3," kWh/m"]}),r.jsxs("p",{className:"text-xs text-green-600 flex items-center gap-1",children:[r.jsx(eo,{className:"h-3 w-3"}),"Improving efficiency"]})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Cost per m"}),r.jsx(Za,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:["KES ",n.cost_per_m3]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Energy cost allocation"})]})]})]}),r.jsxs(qs,{defaultValue:"specific-energy",className:"w-full",children:[r.jsxs(As,{className:"grid w-full grid-cols-2",children:[r.jsx(sr,{value:"specific-energy",children:"Specific Energy Trend"}),r.jsx(sr,{value:"cost-breakdown",children:"Cost Breakdown"})]}),r.jsx(Nr,{value:"specific-energy",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Specific Energy (kWh/m) - 12 Month Trend"})}),r.jsx(ie,{children:r.jsx(Da,{width:"100%",height:350,children:r.jsxs(Yb,{data:(t==null?void 0:t.data)||[],children:[r.jsx(wo,{strokeDasharray:"3 3"}),r.jsx(aa,{dataKey:"month"}),r.jsx(Mi,{}),r.jsx(Ds,{}),r.jsx(sa,{}),r.jsx(Xo,{type:"monotone",dataKey:"kwh_per_m3",stroke:"#8884d8",name:"kWh/m"})]})})})]})}),r.jsx(Nr,{value:"cost-breakdown",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Energy Cost per m - 12 Month Trend"})}),r.jsx(ie,{children:r.jsx(Da,{width:"100%",height:350,children:r.jsxs(hy,{data:(t==null?void 0:t.data)||[],children:[r.jsx(wo,{strokeDasharray:"3 3"}),r.jsx(aa,{dataKey:"month"}),r.jsx(Mi,{}),r.jsx(Ds,{}),r.jsx(sa,{}),r.jsx(Ia,{dataKey:"cost_per_m3",fill:"#82ca9d",name:"Cost per m (KES)"})]})})})]})})]}),n.current_tariff&&r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Current Tariff"})}),r.jsx(ie,{children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Tariff Name"}),r.jsx("p",{className:"font-medium",children:n.current_tariff.name})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Peak Rate"}),r.jsxs("p",{className:"font-medium",children:[n.current_tariff.currency," ",n.current_tariff.peak_rate,"/kWh"]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Off-Peak Rate"}),r.jsxs("p",{className:"font-medium",children:[n.current_tariff.currency," ",n.current_tariff.offpeak_rate,"/kWh"]})]})]})})]})]})}function WFe(){const[e,t]=R.useState(!1),[n,s]=R.useState(""),[i,c]=R.useState(""),[u,a]=R.useState([{description:"",quantity:"",unit:"",unit_cost_estimate:""}]),m=br(),{data:p}=ht({queryKey:["requisitions"],queryFn:async()=>(await fetch("/api/v1/procurement/requisitions")).json()}),y=jt({mutationFn:async T=>{const I=await fetch("/api/v1/procurement/requisitions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)});if(!I.ok)throw new Error("Failed to create requisition");return I.json()},onSuccess:()=>{m.invalidateQueries({queryKey:["requisitions"]}),t(!1),j()}}),v=jt({mutationFn:async T=>{const I=await fetch(`/api/v1/procurement/requisitions/${T}/submit`,{method:"POST"});if(!I.ok)throw new Error("Failed to submit");return I.json()},onSuccess:()=>{m.invalidateQueries({queryKey:["requisitions"]})}}),j=()=>{s(""),c(""),a([{description:"",quantity:"",unit:"",unit_cost_estimate:""}])},S=()=>{a([...u,{description:"",quantity:"",unit:"",unit_cost_estimate:""}])},k=T=>{a(u.filter((I,z)=>z!==T))},N=(T,I,z)=>{const $=[...u];$[T][I]=z,a($)},D=T=>{T.preventDefault();const I=u.filter(z=>z.description&&z.quantity&&z.unit&&z.unit_cost_estimate);y.mutate({justification:n,required_date:i||null,items:I})},O=T=>{const I={draft:"bg-gray-100 text-gray-700",submitted:"bg-blue-100 text-blue-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700"};return r.jsx(We,{className:I[T],children:T})};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Purchase Requisitions"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Request procurement of goods and services"})]}),r.jsxs(Rr,{open:e,onOpenChange:t,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"New Requisition"]})}),r.jsxs(Er,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Create Purchase Requisition"})}),r.jsxs("form",{onSubmit:D,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"justification",children:"Justification / Purpose *"}),r.jsx(Fs,{id:"justification",value:n,onChange:T=>s(T.target.value),placeholder:"Explain why these items are needed...",rows:3,required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"required_date",children:"Required Date"}),r.jsx(Ge,{id:"required_date",type:"date",value:i,onChange:T=>c(T.target.value)})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx(Ne,{children:"Items *"}),r.jsxs(se,{type:"button",variant:"outline",size:"sm",onClick:S,children:[r.jsx(ir,{className:"h-4 w-4 mr-1"}),"Add Item"]})]}),r.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto border rounded-lg p-3",children:u.map((T,I)=>r.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end p-2 bg-muted/30 rounded",children:[r.jsxs("div",{className:"col-span-5",children:[r.jsx(Ne,{className:"text-xs",children:"Description"}),r.jsx(Ge,{value:T.description,onChange:z=>N(I,"description",z.target.value),placeholder:"Item description",required:!0})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx(Ne,{className:"text-xs",children:"Quantity"}),r.jsx(Ge,{type:"number",step:"0.01",value:T.quantity,onChange:z=>N(I,"quantity",z.target.value),placeholder:"0",required:!0})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx(Ne,{className:"text-xs",children:"Unit"}),r.jsx(Ge,{value:T.unit,onChange:z=>N(I,"unit",z.target.value),placeholder:"pcs, kg, etc",required:!0})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx(Ne,{className:"text-xs",children:"Unit Cost"}),r.jsx(Ge,{type:"number",step:"0.01",value:T.unit_cost_estimate,onChange:z=>N(I,"unit_cost_estimate",z.target.value),placeholder:"0.00",required:!0})]}),r.jsx("div",{className:"col-span-1 flex items-end",children:u.length>1&&r.jsx(se,{type:"button",variant:"ghost",size:"sm",onClick:()=>k(I),children:r.jsx(jy,{className:"h-4 w-4"})})})]},I))})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:y.isPending,children:y.isPending?"Creating...":"Create Requisition"})]})]})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Jq,{className:"h-5 w-5"}),"Requisition List"]})}),r.jsx(ie,{children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Requisition No"}),r.jsx(le,{children:"Requestor"}),r.jsx(le,{children:"Items"}),r.jsx(le,{children:"Total Estimate"}),r.jsx(le,{children:"Required Date"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:p!=null&&p.data&&p.data.length>0?p.data.map(T=>{var I,z;return r.jsxs(lt,{children:[r.jsx(ne,{className:"font-mono",children:T.requisition_no}),r.jsx(ne,{children:((I=T.requestor)==null?void 0:I.name)||"N/A"}),r.jsxs(ne,{children:[((z=T.items)==null?void 0:z.length)||0," items"]}),r.jsxs(ne,{children:["KES ",parseFloat(T.total_estimate).toLocaleString()]}),r.jsx(ne,{children:T.required_date?new Date(T.required_date).toLocaleDateString():"N/A"}),r.jsx(ne,{children:O(T.status)}),r.jsx(ne,{children:T.status==="draft"&&r.jsxs(se,{size:"sm",variant:"outline",onClick:()=>v.mutate(T.id),disabled:v.isPending,children:[r.jsx(LO,{className:"h-3 w-3 mr-1"}),"Submit"]})})]},T.id)}):r.jsx(lt,{children:r.jsx(ne,{colSpan:7,className:"text-center text-muted-foreground",children:"No requisitions yet"})})})]})})]})]})}function GFe(){var N,D,O;const[e,t]=R.useState(!1),[n,s]=R.useState(null),[i,c]=R.useState({title:"",description:"",issue_date:"",submission_deadline:"",items:[{description:"",quantity:"",unit:"",specifications:""}],vendor_ids:[]}),u=br(),{data:a}=ht({queryKey:["rfqs"],queryFn:async()=>(await fetch("/api/v1/procurement/rfqs")).json()}),{data:m}=ht({queryKey:["vendors"],queryFn:async()=>(await fetch("/api/v1/procurement/vendors?status=active")).json()}),{data:p}=ht({queryKey:["rfq",n],queryFn:async()=>(await fetch(`/api/v1/procurement/rfqs/${n}`)).json(),enabled:!!n}),{data:y}=ht({queryKey:["rfq-evaluation",n],queryFn:async()=>(await fetch(`/api/v1/procurement/rfqs/${n}/evaluation-matrix`)).json(),enabled:!!n&&((N=p==null?void 0:p.data)==null?void 0:N.status)==="evaluating"}),v=jt({mutationFn:async T=>{const I=await fetch("/api/v1/procurement/rfqs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)});if(!I.ok)throw new Error("Failed to create RFQ");return I.json()},onSuccess:()=>{u.invalidateQueries({queryKey:["rfqs"]}),t(!1)}}),j=jt({mutationFn:async T=>{const I=await fetch(`/api/v1/procurement/rfqs/${T}/issue`,{method:"POST"});if(!I.ok)throw new Error("Failed to issue RFQ");return I.json()},onSuccess:()=>{u.invalidateQueries({queryKey:["rfqs"]})}}),S=T=>{T.preventDefault(),v.mutate(i)},k=T=>{const I={draft:"bg-gray-100 text-gray-700",issued:"bg-blue-100 text-blue-700",evaluating:"bg-orange-100 text-orange-700",awarded:"bg-green-100 text-green-700"};return r.jsx(We,{className:I[T],children:T})};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"RFQ Management"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Create RFQs, invite vendors, and evaluate bids"})]}),r.jsxs(Rr,{open:e,onOpenChange:t,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"New RFQ"]})}),r.jsxs(Er,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Create Request for Quotation"})}),r.jsxs("form",{onSubmit:S,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"col-span-2",children:[r.jsx(Ne,{htmlFor:"title",children:"RFQ Title *"}),r.jsx(Ge,{id:"title",value:i.title,onChange:T=>c({...i,title:T.target.value}),placeholder:"e.g., Supply of Water Treatment Chemicals",required:!0})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx(Ne,{htmlFor:"description",children:"Description"}),r.jsx(Fs,{id:"description",value:i.description,onChange:T=>c({...i,description:T.target.value}),rows:3})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"issue_date",children:"Issue Date *"}),r.jsx(Ge,{id:"issue_date",type:"date",value:i.issue_date,onChange:T=>c({...i,issue_date:T.target.value}),required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"deadline",children:"Submission Deadline *"}),r.jsx(Ge,{id:"deadline",type:"date",value:i.submission_deadline,onChange:T=>c({...i,submission_deadline:T.target.value}),required:!0})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Invite Vendors"}),r.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2 max-h-32 overflow-y-auto border rounded p-2",children:(D=m==null?void 0:m.data)==null?void 0:D.map(T=>r.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[r.jsx("input",{type:"checkbox",checked:i.vendor_ids.includes(T.id),onChange:I=>{I.target.checked?c({...i,vendor_ids:[...i.vendor_ids,T.id]}):c({...i,vendor_ids:i.vendor_ids.filter(z=>z!==T.id)})}}),T.name]},T.id))})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:v.isPending,children:v.isPending?"Creating...":"Create RFQ"})]})]})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(is,{className:"h-5 w-5"}),"RFQ List"]})}),r.jsx(ie,{children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"RFQ No"}),r.jsx(le,{children:"Title"}),r.jsx(le,{children:"Issue Date"}),r.jsx(le,{children:"Deadline"}),r.jsx(le,{children:"Invitations"}),r.jsx(le,{children:"Bids"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:a!=null&&a.data&&a.data.length>0?a.data.map(T=>r.jsxs(lt,{className:"cursor-pointer",onClick:()=>s(T.id),children:[r.jsx(ne,{className:"font-mono",children:T.rfq_no}),r.jsx(ne,{className:"font-medium",children:T.title}),r.jsx(ne,{children:new Date(T.issue_date).toLocaleDateString()}),r.jsx(ne,{children:new Date(T.submission_deadline).toLocaleDateString()}),r.jsx(ne,{children:r.jsxs(We,{variant:"outline",children:[T.invitations_count||0," vendors"]})}),r.jsx(ne,{children:r.jsxs(We,{variant:"outline",children:[T.bids_count||0," bids"]})}),r.jsx(ne,{children:k(T.status)}),r.jsx(ne,{onClick:I=>I.stopPropagation(),children:T.status==="draft"&&r.jsxs(se,{size:"sm",variant:"outline",onClick:()=>j.mutate(T.id),children:[r.jsx(LO,{className:"h-3 w-3 mr-1"}),"Issue"]})})]},T.id)):r.jsx(lt,{children:r.jsx(ne,{colSpan:8,className:"text-center text-muted-foreground",children:"No RFQs yet"})})})]})})]}),(p==null?void 0:p.data)&&r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(C0,{className:"h-5 w-5"}),"RFQ Details: ",p.data.rfq_no]})}),r.jsx(ie,{children:r.jsxs(qs,{defaultValue:"overview",children:[r.jsxs(As,{children:[r.jsx(sr,{value:"overview",children:"Overview"}),r.jsxs(sr,{value:"bids",children:["Bids (",((O=p.data.bids)==null?void 0:O.length)||0,")"]}),p.data.status==="evaluating"&&r.jsx(sr,{value:"evaluation",children:"Evaluation Matrix"})]}),r.jsxs(Nr,{value:"overview",className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Title"}),r.jsx("p",{className:"font-medium",children:p.data.title})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),k(p.data.status)]})]}),p.data.description&&r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Description"}),r.jsx("p",{children:p.data.description})]})]}),r.jsx(Nr,{value:"bids",children:p.data.bids&&p.data.bids.length>0?r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Vendor"}),r.jsx(le,{children:"Bid Amount"}),r.jsx(le,{children:"Delivery Days"}),r.jsx(le,{children:"Submitted"})]})}),r.jsx(ur,{children:p.data.bids.map(T=>{var I;return r.jsxs(lt,{children:[r.jsx(ne,{children:(I=T.vendor)==null?void 0:I.name}),r.jsxs(ne,{children:["KES ",parseFloat(T.total_bid_amount).toLocaleString()]}),r.jsxs(ne,{children:[T.delivery_days," days"]}),r.jsx(ne,{children:new Date(T.submitted_at).toLocaleString()})]},T.id)})})]}):r.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No bids submitted yet"})}),p.data.status==="evaluating"&&r.jsx(Nr,{value:"evaluation",children:y!=null&&y.data&&y.data.length>0?r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Rank"}),r.jsx(le,{children:"Vendor"}),r.jsx(le,{children:"Bid Amount"}),r.jsx(le,{children:"Weighted Score"}),r.jsx(le,{children:"Delivery"})]})}),r.jsx(ur,{children:y.data.map(T=>r.jsxs(lt,{children:[r.jsx(ne,{children:r.jsxs(We,{className:T.rank===1?"bg-green-100 text-green-700":"",children:["#",T.rank]})}),r.jsx(ne,{className:"font-medium",children:T.vendor_name}),r.jsxs(ne,{children:["KES ",parseFloat(T.bid_amount).toLocaleString()]}),r.jsx(ne,{children:r.jsxs("div",{className:"font-bold text-blue-600",children:[T.weighted_total,"/100"]})}),r.jsxs(ne,{children:[T.delivery_days," days"]})]},T.vendor_id))})]}):r.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No evaluations yet"})})]})})]})]})}function KFe(){var D;const[e,t]=R.useState(!1),[n,s]=R.useState(""),[i,c]=R.useState(""),[u,a]=R.useState("Standard payment terms: Net 30 days"),m=br(),{data:p}=ht({queryKey:["lpos"],queryFn:async()=>(await fetch("/api/v1/procurement/lpos")).json()}),{data:y}=ht({queryKey:["awarded-rfqs"],queryFn:async()=>(await fetch("/api/v1/procurement/rfqs?status=awarded")).json()}),v=jt({mutationFn:async O=>{const T=await fetch("/api/v1/procurement/lpos/generate-from-rfq",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)});if(!T.ok)throw new Error("Failed to generate LPO");return T.json()},onSuccess:()=>{m.invalidateQueries({queryKey:["lpos"]}),m.invalidateQueries({queryKey:["awarded-rfqs"]}),t(!1),s(""),c("")}}),j=jt({mutationFn:async O=>{const T=await fetch(`/api/v1/procurement/lpos/${O}/approve`,{method:"POST"});if(!T.ok)throw new Error("Failed to approve");return T.json()},onSuccess:()=>{m.invalidateQueries({queryKey:["lpos"]})}}),S=jt({mutationFn:async O=>{const T=await fetch(`/api/v1/procurement/lpos/${O}/issue`,{method:"POST"});if(!T.ok)throw new Error("Failed to issue");return T.json()},onSuccess:()=>{m.invalidateQueries({queryKey:["lpos"]})}}),k=O=>{O.preventDefault(),v.mutate({rfq_id:n,delivery_date:i,terms_conditions:u})},N=O=>{const T={draft:"bg-gray-100 text-gray-700",approved:"bg-blue-100 text-blue-700",issued:"bg-green-100 text-green-700",delivered:"bg-purple-100 text-purple-700",cancelled:"bg-red-100 text-red-700"};return r.jsx(We,{className:T[O],children:O})};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Local Purchase Orders"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Generate and manage LPOs from awarded RFQs"})]}),r.jsxs(Rr,{open:e,onOpenChange:t,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{className:"gap-2",children:[r.jsx(is,{className:"h-4 w-4"}),"Generate from RFQ"]})}),r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Generate LPO from Awarded RFQ"})}),r.jsxs("form",{onSubmit:k,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"rfq",children:"Select Awarded RFQ *"}),r.jsxs("select",{id:"rfq",className:"w-full border rounded-md p-2",value:n,onChange:O=>s(O.target.value),required:!0,children:[r.jsx("option",{value:"",children:"-- Select RFQ --"}),(D=y==null?void 0:y.data)==null?void 0:D.map(O=>{var T;return r.jsxs("option",{value:O.id,children:[O.rfq_no," - ",O.title," (Vendor: ",(T=O.awarded_vendor)==null?void 0:T.name,")"]},O.id)})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"delivery_date",children:"Expected Delivery Date *"}),r.jsx(Ge,{id:"delivery_date",type:"date",value:i,onChange:O=>c(O.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"terms",children:"Terms & Conditions"}),r.jsx(Fs,{id:"terms",value:u,onChange:O=>a(O.target.value),rows:4})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:v.isPending,children:v.isPending?"Generating...":"Generate LPO"})]})]})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(is,{className:"h-5 w-5"}),"LPO List"]})}),r.jsx(ie,{children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"LPO No"}),r.jsx(le,{children:"Vendor"}),r.jsx(le,{children:"RFQ Reference"}),r.jsx(le,{children:"Order Date"}),r.jsx(le,{children:"Delivery Date"}),r.jsx(le,{children:"Total Amount"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:p!=null&&p.data&&p.data.length>0?p.data.map(O=>{var T;return r.jsxs(lt,{children:[r.jsx(ne,{className:"font-mono font-medium",children:O.lpo_no}),r.jsx(ne,{children:((T=O.vendor)==null?void 0:T.name)||"N/A"}),r.jsx(ne,{children:O.rfq?r.jsx("span",{className:"text-sm text-muted-foreground",children:O.rfq.rfq_no}):"Direct"}),r.jsx(ne,{children:new Date(O.order_date).toLocaleDateString()}),r.jsx(ne,{children:O.delivery_date?new Date(O.delivery_date).toLocaleDateString():"N/A"}),r.jsxs(ne,{className:"font-medium",children:["KES ",parseFloat(O.total_amount).toLocaleString()]}),r.jsx(ne,{children:N(O.status)}),r.jsx(ne,{children:r.jsxs("div",{className:"flex gap-1",children:[O.status==="draft"&&r.jsxs(se,{size:"sm",variant:"outline",onClick:()=>j.mutate(O.id),disabled:j.isPending,children:[r.jsx(os,{className:"h-3 w-3 mr-1"}),"Approve"]}),O.status==="approved"&&r.jsxs(se,{size:"sm",variant:"outline",onClick:()=>S.mutate(O.id),disabled:S.isPending,children:[r.jsx(LO,{className:"h-3 w-3 mr-1"}),"Issue"]}),O.status==="issued"&&r.jsxs(se,{size:"sm",variant:"outline",children:[r.jsx(rl,{className:"h-3 w-3 mr-1"}),"PDF"]})]})})]},O.id)}):r.jsx(lt,{children:r.jsx(ne,{colSpan:8,className:"text-center text-muted-foreground",children:"No LPOs yet"})})})]})})]}),r.jsx(J,{className:"bg-blue-50 border-blue-200",children:r.jsxs(ie,{className:"pt-6",children:[r.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"LPO Workflow"}),r.jsxs("div",{className:"flex items-center gap-4 text-sm text-blue-700",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-200 flex items-center justify-center font-bold",children:"1"}),r.jsx("span",{children:"Generate from RFQ"})]}),r.jsx("div",{className:"text-blue-400",children:""}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-200 flex items-center justify-center font-bold",children:"2"}),r.jsx("span",{children:"Approve"})]}),r.jsx("div",{className:"text-blue-400",children:""}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-200 flex items-center justify-center font-bold",children:"3"}),r.jsx("span",{children:"Issue to Vendor"})]}),r.jsx("div",{className:"text-blue-400",children:""}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-200 flex items-center justify-center font-bold",children:"4"}),r.jsx("span",{children:"Track Delivery"})]})]})]})})]})}function HFe(){return r.jsxs("div",{className:"flex min-h-screen",children:[r.jsx(za,{}),r.jsx("main",{className:"flex-1 p-8 overflow-auto",children:r.jsx(Fa,{})})]})}function ZFe(){return r.jsxs("div",{className:"flex min-h-screen",children:[r.jsx(za,{}),r.jsx("main",{className:"flex-1 p-8 overflow-auto",children:r.jsx(Fa,{})})]})}function YFe(){return r.jsxs("div",{className:"flex min-h-screen",children:[r.jsx(za,{}),r.jsx("main",{className:"flex-1 p-8 overflow-auto",children:r.jsx(Fa,{})})]})}function XFe(){return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Capital Projects"}),r.jsx("p",{className:"text-muted-foreground mt-2",children:"Infrastructure development and capital investment tracking"})]}),r.jsxs(se,{children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"New Project"]})]}),r.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Active Projects"}),r.jsx(Wq,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"12"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"+2 from last month"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Total Budget"}),r.jsx(Za,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"KES 45.2M"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all active projects"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Budget Utilization"}),r.jsx($s,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"68.4%"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"+12% from last month"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Due This Month"}),r.jsx(va,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"3"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Project milestones"})]})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Module 9: Projects & Capital Planning"}),r.jsx(xr,{children:"Comprehensive capital project management and financial tracking"})]}),r.jsxs(ie,{className:"space-y-4",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"This module will provide complete infrastructure project lifecycle management including:"}),r.jsxs("ul",{className:"text-sm space-y-2 list-disc list-inside text-muted-foreground",children:[r.jsx("li",{children:"Project registry with status tracking and milestone management"}),r.jsx("li",{children:"Budget planning and allocation with Module 11 integration"}),r.jsx("li",{children:"Procurement tracking and contract management"}),r.jsx("li",{children:"Progress monitoring with financial and physical completion metrics"}),r.jsx("li",{children:"Risk management and issue tracking"}),r.jsx("li",{children:"Document repository and stakeholder communications"}),r.jsx("li",{children:"Geographic project mapping with GIS integration"})]}),r.jsxs("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:[r.jsx("p",{className:"text-sm font-medium",children:"Status: Planning Phase"}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Module 9 integration with Module 11 (Costing) database schema is ready. Frontend pages and API endpoints are scheduled for implementation."})]})]})]})]})}function QFe(){return r.jsxs("div",{className:"flex h-screen bg-background",children:[r.jsx(za,{}),r.jsx("main",{className:"flex-1 overflow-auto",children:r.jsx(Fa,{})})]})}function JFe(){return r.jsxs("div",{className:"flex h-screen bg-background",children:[r.jsx(za,{}),r.jsx("main",{className:"flex-1 overflow-auto",children:r.jsx(Fa,{})})]})}function eze(){return r.jsxs("div",{className:"flex h-screen overflow-hidden",children:[r.jsx(za,{}),r.jsx("main",{className:"flex-1 overflow-y-auto",children:r.jsx(Fa,{})})]})}function tze(){return r.jsxs("div",{className:"flex h-screen overflow-hidden",children:[r.jsx(za,{}),r.jsx("main",{className:"flex-1 overflow-y-auto",children:r.jsx(Fa,{})})]})}function rze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Users & Sessions"}),r.jsx("p",{className:"text-muted-foreground",children:"Manage user accounts, roles, 2FA, and active sessions"})]}),r.jsxs(se,{children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Add User"]})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(ci,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Search users by name, email...",className:"pl-10"})]}),r.jsx(se,{variant:"outline",children:"Filters"}),r.jsx(se,{variant:"outline",children:"Export"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Total Users"}),r.jsx(Pi,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"0"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all tenants"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Active Sessions"}),r.jsx(cS,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"0"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently logged in"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"2FA Enabled"}),r.jsx(yl,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"0%"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Security coverage"})]})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"User Directory"}),r.jsx(xr,{children:"View and manage user accounts"})]}),r.jsx(ie,{children:r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(Pi,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),r.jsx("p",{children:"No users found. Run database migrations to create tables."})]})})]})]})}function nze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Roles & Permissions"}),r.jsx("p",{className:"text-muted-foreground",children:"Manage roles and their associated permissions"})]}),r.jsxs(se,{children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Create Role"]})]}),r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"System Roles"}),r.jsx(xr,{children:"Admin, Manager, Operator, Analyst, Viewer"})]}),r.jsx(ie,{children:r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(yl,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),r.jsx("p",{children:"Run RBAC seeder to create roles and permissions."}),r.jsx("code",{className:"text-xs mt-2 block",children:"php artisan db:seed --class=RBACPermissionSeeder"})]})})]})]})}function sze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Permission Matrix"}),r.jsx("p",{className:"text-muted-foreground",children:"Grid view of roles  permissions with bulk operations"})]}),r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Roles  Permissions Matrix"}),r.jsx(xr,{children:"Check boxes to grant permissions to roles"})]}),r.jsx(ie,{children:r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(ai,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),r.jsx("p",{children:"Matrix grid will display here once roles and permissions are seeded."})]})})]})]})}function ize(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Audit Logs"}),r.jsx("p",{className:"text-muted-foreground",children:"Track all system actions, changes, and user activity"})]}),r.jsxs(se,{children:[r.jsx(rl,{className:"mr-2 h-4 w-4"}),"Export CSV"]})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(ci,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Search by actor, action, entity...",className:"pl-10"})]}),r.jsx(se,{variant:"outline",children:"Date Range"}),r.jsx(se,{variant:"outline",children:"Filters"})]}),r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Activity Timeline"}),r.jsx(xr,{children:"All actions with before/after diffs"})]}),r.jsx(ie,{children:r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(is,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),r.jsx("p",{children:"Audit logs will appear here once users start performing actions."})]})})]})]})}function aze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"API Catalog"}),r.jsx("p",{className:"text-muted-foreground",children:"REST & GraphQL endpoints registry with API keys and rate limits"})]}),r.jsxs(se,{children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Register API"]})]}),r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Published APIs"}),r.jsx(xr,{children:"Internal and external API endpoints"})]}),r.jsx(ie,{children:r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(xl,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),r.jsx("p",{children:"No APIs registered yet. Run migrations to create integration tables."})]})})]})]})}function oze(){const e=[{name:"SCADA",description:"OPC-UA / MQTT telemetry",status:"available"},{name:"AMI",description:"DLMS / CSV / S3 meter data",status:"available"},{name:"ERP",description:"GL journal integration",status:"available"},{name:"WARIS",description:"Regulator reporting",status:"available"},{name:"NDMA",description:"Early warning feeds",status:"available"},{name:"Payments",description:"M-Pesa / Airtel Money",status:"available"},{name:"Messaging",description:"SMS / WhatsApp / Email",status:"available"},{name:"Custom",description:"Build your own",status:"available"}];return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Connector Gallery"}),r.jsx("p",{className:"text-muted-foreground",children:"Pre-built adapters for SCADA, AMI, ERP, and external systems"})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:e.map(t=>r.jsxs(J,{className:"hover:border-primary transition-colors cursor-pointer",children:[r.jsxs(ge,{children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(xe,{className:"text-base",children:t.name}),r.jsx(ai,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsx(xr,{className:"text-xs",children:t.description})]}),r.jsx(ie,{children:r.jsx(se,{size:"sm",variant:"outline",className:"w-full",children:"Setup Connector"})})]},t.name))})]})}function lze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Webhook Manager"}),r.jsx("p",{className:"text-muted-foreground",children:"Configure webhooks for event notifications and callbacks"})]}),r.jsxs(se,{children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Create Webhook"]})]}),r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Active Webhooks"}),r.jsx(xr,{children:"Event subscriptions and delivery logs"})]}),r.jsx(ie,{children:r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(one,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),r.jsx("p",{children:"No webhooks configured. Create your first webhook above."})]})})]})]})}function cze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"ETL Jobs"}),r.jsx("p",{className:"text-muted-foreground",children:"Extract, Transform, Load jobs for data integration"})]}),r.jsxs(se,{children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Create ETL Job"]})]}),r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Scheduled Jobs"}),r.jsx(xr,{children:"Import, export, and transformation pipelines"})]}),r.jsx(ie,{children:r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(xl,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),r.jsx("p",{children:"No ETL jobs defined. Create your first job to start data integration."})]})})]})]})}function uze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Data Warehouse Catalog"}),r.jsx("p",{className:"text-muted-foreground",children:"Browse data zones (raw, refined, curated) and table schemas"})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["Raw","Refined","Curated"].map(e=>r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsxs(xe,{className:"text-base",children:[e," Zone"]}),r.jsx(xr,{children:"0 tables"})]}),r.jsx(ie,{children:r.jsxs("div",{className:"text-sm text-muted-foreground",children:[e==="Raw"&&"Immutable source data",e==="Refined"&&"Cleaned and standardized",e==="Curated"&&"Business-ready analytics"]})})]},e))}),r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Data Catalog"}),r.jsx(xr,{children:"Tables, schemas, and lineage"})]}),r.jsx(ie,{children:r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(xl,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),r.jsx("p",{children:"Data warehouse catalog will populate once ETL jobs create tables."})]})})]})]})}function dze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Communication Templates"}),r.jsx("p",{className:"text-muted-foreground",children:"SMS, Email, WhatsApp templates with i18n support"})]}),r.jsxs(se,{children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Create Template"]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:["SMS","Email","WhatsApp","USSD"].map(e=>r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{className:"text-base",children:e}),r.jsx(xr,{children:"0 templates"})]}),r.jsx(ie,{children:r.jsx(se,{size:"sm",variant:"outline",className:"w-full",children:"New Template"})})]},e))}),r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Template Library"}),r.jsx(xr,{children:"All communication templates"})]}),r.jsx(ie,{children:r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(Qq,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),r.jsx("p",{children:"No templates created yet. Create templates for customer notifications."})]})})]})]})}function hze(){const[e,t]=R.useState(!1),{data:n}=ht({queryKey:["kpi-dashboard"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/kpis/dashboard/summary")).json()}),s=(n==null?void 0:n.data)||{water_coverage:78.5,nrw_percent:32.8,staff_efficiency:8.2,collection_efficiency:91.2};return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"KPI Dashboard"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"WHO/JMP & WASREB aligned performance indicators"})]}),r.jsxs(se,{onClick:()=>t(!0),className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"New KPI"]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Water Coverage"}),r.jsx(Gu,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:[s.water_coverage,"%"]}),r.jsxs("div",{className:"flex items-center text-xs text-green-600",children:[r.jsx($s,{className:"h-3 w-3 mr-1"}),"+2.3% from last quarter"]})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"NRW %"}),r.jsx(Gu,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:[s.nrw_percent,"%"]}),r.jsxs("div",{className:"flex items-center text-xs text-green-600",children:[r.jsx(eo,{className:"h-3 w-3 mr-1"}),"-4.2% improvement"]})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Staff Efficiency"}),r.jsx(Gu,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:s.staff_efficiency}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Connections per staff"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Collection Efficiency"}),r.jsx(Gu,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:[s.collection_efficiency,"%"]}),r.jsxs("div",{className:"flex items-center text-xs text-green-600",children:[r.jsx($s,{className:"h-3 w-3 mr-1"}),"+1.5%"]})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"KPI Catalog & Management"})}),r.jsx(ie,{children:r.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[r.jsx("p",{children:"KPI catalog, data entry, and threshold alerts"}),r.jsx("p",{className:"text-sm mt-2",children:"Production-ready data layer with real API integration"})]})})]})]})}function fze(){const{data:e}=ht({queryKey:["coverage-dashboard"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/coverage/dashboard")).json()}),{data:t}=ht({queryKey:["coverage-by-area"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/coverage/by-area")).json()}),n=(e==null?void 0:e.data)||{total_population:245800,population_served:193100,coverage_percent:78.5};return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Coverage & Equity Analytics"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Water and sanitation coverage by area, demographic disaggregation, and equity analysis"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Total Population"}),r.jsx(Pi,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:(n.total_population||245800).toLocaleString()}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all wards"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Population Served"}),r.jsx(ac,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:(n.population_served||193100).toLocaleString()}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"With piped connections"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Coverage Rate"}),r.jsx(Px,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:[n.coverage_percent,"%"]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Overall water coverage"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Coverage Analytics"})}),r.jsx(ie,{children:r.jsxs(qs,{defaultValue:"by-ward",className:"w-full",children:[r.jsxs(As,{className:"grid w-full grid-cols-2",children:[r.jsx(sr,{value:"by-ward",children:"By Ward"}),r.jsx(sr,{value:"equity",children:"Equity Analysis"})]}),r.jsx(Nr,{value:"by-ward",className:"mt-4",children:r.jsxs("div",{className:"space-y-3",children:[r.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Ward-level coverage breakdown"}),t!=null&&t.data&&t.data.length>0?r.jsx("div",{className:"max-h-96 overflow-y-auto",children:t.data.map((s,i)=>{var c;return r.jsx("div",{className:"p-3 border rounded-lg",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-medium text-sm",children:s.area_type}),r.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[r.jsxs("span",{children:["Population: ",(s.population_total||0).toLocaleString()]}),r.jsxs("span",{children:["Served: ",(s.population_served||0).toLocaleString()]})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("div",{className:"text-lg font-bold",children:[(c=s.coverage_percent)==null?void 0:c.toFixed(1),"%"]}),r.jsx($s,{className:"h-3 w-3 text-green-600 mt-1"})]})]})},`${s.area_id}-${i}`)})}):r.jsx("p",{className:"text-sm text-muted-foreground",children:"No coverage data available"})]})}),r.jsx(Nr,{value:"equity",className:"mt-4",children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Gender and income quintile disaggregation analysis"}),r.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[r.jsx("h4",{className:"font-medium text-sm mb-2",children:"Demographic Breakdowns"}),r.jsxs("ul",{className:"text-sm space-y-2 text-muted-foreground",children:[r.jsx("li",{children:" Gender: Male / Female population coverage differential"}),r.jsx("li",{children:" Income Quintiles: Q1-Q5 water access equity metrics"}),r.jsx("li",{children:" Geographic: Urban / Rural coverage disparity"}),r.jsx("li",{children:" Age Groups: Child / Adult / Senior population served"})]})]})]})})]})})]})]})}function mze(){const{data:e}=ht({queryKey:["nrw-dashboard"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/nrw/dashboard")).json()}),{data:t}=ht({queryKey:["nrw-initiatives"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/nrw/initiatives")).json()}),n=(e==null?void 0:e.data)||{current_nrw_percent:32.8,water_saved_m3_day:1850,average_roi_percent:185};return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"NRW Program Tracker"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Non-Revenue Water initiatives, savings tracking, and ROI analysis"})]}),r.jsxs(se,{className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"New Initiative"]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Current NRW %"}),r.jsx(ac,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:[n.current_nrw_percent,"%"]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Down from 37% baseline"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Water Saved"}),r.jsx(eo,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:[n.water_saved_m3_day.toLocaleString()," m/day"]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Cumulative savings"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Investment ROI"}),r.jsx(Za,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:[Math.round(n.average_roi_percent),"%"]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Average payback ROI"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Initiative Pipeline"})}),r.jsx(ie,{children:r.jsxs(qs,{defaultValue:"all",className:"w-full",children:[r.jsxs(As,{className:"grid w-full grid-cols-4",children:[r.jsx(sr,{value:"all",children:"All"}),r.jsx(sr,{value:"proposed",children:"Proposed"}),r.jsx(sr,{value:"active",children:"Active"}),r.jsx(sr,{value:"verified",children:"Verified"})]}),r.jsx(Nr,{value:"all",className:"mt-4",children:r.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:t!=null&&t.data&&t.data.length>0?t.data.map(s=>r.jsx("div",{className:"p-3 border rounded-lg",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-sm",children:s.name}),r.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Type: ",s.type.replace("_"," ")," | Stage: ",s.stage]}),s.roi_percent&&r.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["ROI: ",s.roi_percent.toFixed(1),"%"]})]}),r.jsxs("span",{className:"text-xs text-muted-foreground",children:["Cost: $",s.cost.toLocaleString()]})]})},s.id)):r.jsx("p",{className:"text-sm text-muted-foreground",children:"No initiatives yet"})})})]})})]})]})}function pze(){const{data:e}=ht({queryKey:["surveys-analytics"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/surveys/analytics/summary")).json()}),{data:t}=ht({queryKey:["surveys"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/surveys")).json()}),n=(e==null?void 0:e.data)||{nps_score:42,csat_avg:4.2,total_responses:1250,active_surveys:3,response_rate_percent:28};return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Customer Experience Analytics"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"NPS, CSAT, and CES tracking, survey management, and sentiment analysis"})]}),r.jsxs(se,{className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"New Survey"]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"NPS Score"}),r.jsx(Wo,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:n.nps_score}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Net Promoter Score"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"CSAT"}),r.jsx(eV,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:[n.csat_avg.toFixed(1)," / 5"]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Customer Satisfaction"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Response Rate"}),r.jsx(tV,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-2xl font-bold",children:[n.response_rate_percent,"%"]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Survey participation"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Total Responses"}),r.jsx(Xu,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:n.total_responses.toLocaleString()}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Cumulative feedback"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Active Surveys"}),r.jsx(Wo,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:n.active_surveys}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Running campaigns"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Survey Campaigns"})}),r.jsx(ie,{children:r.jsxs(qs,{defaultValue:"all",className:"w-full",children:[r.jsxs(As,{className:"grid w-full grid-cols-3",children:[r.jsx(sr,{value:"all",children:"All"}),r.jsx(sr,{value:"active",children:"Active"}),r.jsx(sr,{value:"closed",children:"Closed"})]}),r.jsx(Nr,{value:"all",className:"mt-4",children:t!=null&&t.data&&t.data.length>0?r.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:t.data.map(s=>r.jsx("div",{className:"p-3 border rounded-lg",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-sm",children:s.name}),r.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Type: ",s.type.toUpperCase()," | Channel: ",s.channel," | Status: ",s.status]})]}),r.jsxs("span",{className:"text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded",children:[s.responses_count||0," responses"]})]})},s.id))}):r.jsx("p",{className:"text-sm text-muted-foreground",children:"No surveys yet"})})]})})]})]})}function gze(){var i;const[e,t]=R.useState(null),{data:n}=ht({queryKey:["indicators",e],queryFn:async()=>{const c=new URL("/api/v1/monitoring-evaluation/indicators",window.location.origin);return e&&c.searchParams.set("level",e),(await fetch(c)).json()}}),s=[{id:"impact",label:"Impact Indicators",color:"bg-red-100 text-red-800"},{id:"outcome",label:"Outcome Indicators",color:"bg-orange-100 text-orange-800"},{id:"output",label:"Output Indicators",color:"bg-blue-100 text-blue-800"},{id:"activity",label:"Activity Indicators",color:"bg-green-100 text-green-800"}];return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Results Framework & Logframe"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Impact, outcome, output, and activity indicators with baseline and target tracking"})]}),r.jsxs(se,{className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"New Indicator"]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:s.map(c=>{var u;return r.jsxs(J,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>t(e===c.id?null:c.id),children:[r.jsx(ge,{className:"pb-3",children:r.jsx(xe,{className:"text-sm",children:c.label})}),r.jsx(ie,{children:r.jsxs("div",{className:`inline-block px-2 py-1 rounded text-xs font-medium ${c.color}`,children:[((u=n==null?void 0:n.data)==null?void 0:u.filter(a=>a.level===c.id).length)||0," indicators"]})})]},c.id)})}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Zg,{className:"h-5 w-5"}),"Indicator Management"]})}),r.jsx(ie,{children:e?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Displaying ",(i=s.find(c=>c.id===e))==null?void 0:i.label]}),n!=null&&n.data&&n.data.length>0?r.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:n.data.map(c=>r.jsx("div",{className:"p-3 border rounded-lg",children:r.jsx("div",{className:"flex items-start justify-between",children:r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-medium text-sm",children:c.name}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:c.code}),c.target_value&&r.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs",children:[r.jsx($s,{className:"h-3 w-3"}),"Target: ",c.target_value," ",c.unit||""]})]})})},c.id))}):r.jsx("p",{className:"text-sm text-muted-foreground",children:"No indicators for this level yet"})]}):r.jsx("p",{className:"text-muted-foreground",children:"Select a level to view indicators, manage baselines, targets, and track progress data"})})]})]})}const Vn="/crm",Ls={getTariffs:e=>me.get(`${Vn}/tariffs`,{params:e}),getTariff:e=>me.get(`${Vn}/tariffs/${e}`),createTariff:e=>me.post(`${Vn}/tariffs`,e),updateTariff:(e,t)=>me.patch(`${Vn}/tariffs/${e}`,t),deleteTariff:e=>me.delete(`${Vn}/tariffs/${e}`),calculateTariff:(e,t)=>me.post(`${Vn}/tariffs/calculate`,{tariff_id:e,consumption:t}),getBillingRuns:e=>me.get(`${Vn}/billing/runs`,{params:e}),previewBilling:e=>me.post(`${Vn}/billing/preview`,e),executeBilling:e=>me.post(`${Vn}/billing/execute`,e),getPayments:e=>me.get(`${Vn}/reconciliation/payments`,{params:e}),reconcilePayment:(e,t)=>me.post(`${Vn}/reconciliation/reconcile`,{payment_id:e,invoice_ids:t}),getAgingReport:()=>me.get(`${Vn}/reconciliation/aging`),getMeterRoutes:e=>me.get(`${Vn}/meter-routes`,{params:e}),createMeterRoute:e=>me.post(`${Vn}/meter-routes`,e),updateMeterRoute:(e,t)=>me.patch(`${Vn}/meter-routes/${e}`,t),deleteMeterRoute:e=>me.delete(`${Vn}/meter-routes/${e}`),downloadOfflinePackage:e=>me.get(`${Vn}/meter-routes/${e}/offline`),uploadMeterReads:(e,t)=>me.post(`${Vn}/meter-routes/${e}/upload`,{reads:t}),getConnectionApplications:e=>me.get(`${Vn}/connections/applications`,{params:e}),submitApplication:e=>me.post(`${Vn}/connections/apply`,e),updateApplication:(e,t)=>me.patch(`${Vn}/connections/applications/${e}`,t),getDisconnections:e=>me.get(`${Vn}/connections/disconnections`,{params:e}),requestDisconnection:e=>me.post(`${Vn}/connections/disconnect`,e),reconnectAccount:e=>me.post(`${Vn}/connections/reconnect`,e),getKiosks:e=>me.get(`${Vn}/kiosks`,{params:e}),createKiosk:e=>me.post(`${Vn}/kiosks`,e),updateKiosk:(e,t)=>me.patch(`${Vn}/kiosks/${e}`,t),deleteKiosk:e=>me.delete(`${Vn}/kiosks/${e}`),getKioskSales:(e,t)=>me.get(`${Vn}/kiosks/${e}/sales`,{params:t}),getTrucks:e=>me.get(`${Vn}/kiosks/trucks`,{params:e})};function xze(){var T,I;const[e,t]=R.useState(!1),[n,s]=R.useState(null),[i,c]=R.useState("all"),[u,a]=R.useState(""),m=br(),{data:p,isLoading:y}=ht({queryKey:["tariffs",i,u],queryFn:()=>Ls.getTariffs({status:i==="all"?void 0:i,search:u||void 0,per_page:50})}),v=jt({mutationFn:Ls.createTariff,onSuccess:()=>{m.invalidateQueries({queryKey:["tariffs"]}),t(!1),s(null),qe.success("Tariff created successfully")},onError:z=>{var $,V;qe.error(((V=($=z.response)==null?void 0:$.data)==null?void 0:V.message)||"Failed to create tariff")}}),j=jt({mutationFn:({id:z,data:$})=>Ls.updateTariff(z,$),onSuccess:()=>{m.invalidateQueries({queryKey:["tariffs"]}),t(!1),s(null),qe.success("Tariff updated successfully")},onError:z=>{var $,V;qe.error(((V=($=z.response)==null?void 0:$.data)==null?void 0:V.message)||"Failed to update tariff")}}),S=jt({mutationFn:Ls.deleteTariff,onSuccess:()=>{m.invalidateQueries({queryKey:["tariffs"]}),qe.success("Tariff deleted successfully")},onError:z=>{var $,V;qe.error(((V=($=z.response)==null?void 0:$.data)==null?void 0:V.message)||"Failed to delete tariff")}}),k=z=>{z.preventDefault();const $=new FormData(z.currentTarget),V=[];let K=0;for(;$.has(`block_${K}_min`);)V.push({min:parseFloat($.get(`block_${K}_min`)),max:$.get(`block_${K}_max`)?parseFloat($.get(`block_${K}_max`)):null,rate:parseFloat($.get(`block_${K}_rate`)),lifeline:$.get(`block_${K}_lifeline`)==="on"}),K++;const te={name:$.get("name"),valid_from:$.get("valid_from"),valid_to:$.get("valid_to")||null,blocks:V,fixed_charge:parseFloat($.get("fixed_charge"))||0,currency:$.get("currency")||"KES"};n?j.mutate({id:n.id,data:te}):v.mutate(te)},N=z=>{s(z),t(!0)},D=z=>{confirm("Are you sure you want to delete this tariff?")&&S.mutate(z)},O=z=>{const $=new Date,V=new Date(z.valid_from),K=z.valid_to?new Date(z.valid_to):null;return V>$?r.jsx(We,{variant:"secondary",children:"Future"}):K&&K<$?r.jsx(We,{variant:"destructive",children:"Expired"}):r.jsx(We,{className:"bg-green-600",children:"Active"})};return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Customer Tariffs"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Water pricing structures by customer category"})]}),r.jsxs(Rr,{open:e,onOpenChange:t,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{onClick:()=>s(null),children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"Create Tariff"]})}),r.jsxs(Er,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[r.jsx(Mr,{children:r.jsx(Or,{children:n?"Edit Tariff":"Create New Tariff"})}),r.jsxs("form",{onSubmit:k,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"name",children:"Tariff Name"}),r.jsx(Ge,{id:"name",name:"name",defaultValue:n==null?void 0:n.name,required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"currency",children:"Currency"}),r.jsx(Ge,{id:"currency",name:"currency",defaultValue:(n==null?void 0:n.currency)||"KES",maxLength:3})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"valid_from",children:"Valid From"}),r.jsx(Ge,{id:"valid_from",name:"valid_from",type:"date",defaultValue:n==null?void 0:n.valid_from,required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"valid_to",children:"Valid To (Optional)"}),r.jsx(Ge,{id:"valid_to",name:"valid_to",type:"date",defaultValue:(n==null?void 0:n.valid_to)||""})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx(Ne,{htmlFor:"fixed_charge",children:"Fixed Charge"}),r.jsx(Ge,{id:"fixed_charge",name:"fixed_charge",type:"number",step:"0.01",defaultValue:(n==null?void 0:n.fixed_charge)||0})]})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsx("h3",{className:"font-semibold mb-3",children:"Rate Blocks"}),((n==null?void 0:n.blocks)||[{min:0,max:10,rate:50,lifeline:!0}]).map((z,$)=>r.jsxs("div",{className:"grid grid-cols-5 gap-2 mb-2",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:`block_${$}_min`,children:"Min (m)"}),r.jsx(Ge,{id:`block_${$}_min`,name:`block_${$}_min`,type:"number",step:"0.01",defaultValue:z.min,required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:`block_${$}_max`,children:"Max (m)"}),r.jsx(Ge,{id:`block_${$}_max`,name:`block_${$}_max`,type:"number",step:"0.01",defaultValue:z.max||"",placeholder:""})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:`block_${$}_rate`,children:"Rate"}),r.jsx(Ge,{id:`block_${$}_rate`,name:`block_${$}_rate`,type:"number",step:"0.01",defaultValue:z.rate,required:!0})]}),r.jsx("div",{className:"flex items-end",children:r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",name:`block_${$}_lifeline`,defaultChecked:z.lifeline}),r.jsx("span",{className:"text-sm",children:"Lifeline"})]})})]},$)),r.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Add more blocks by manually editing after creation"})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsxs(se,{type:"submit",disabled:v.isPending||j.isPending,children:[n?"Update":"Create"," Tariff"]})]})]})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Za,{className:"h-5 w-5"}),"Tariff Management"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(Ge,{placeholder:"Search tariffs...",value:u,onChange:z=>a(z.target.value),className:"w-64"}),r.jsxs(Jt,{value:i,onValueChange:z=>c(z),children:[r.jsx(Yt,{className:"w-32",children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All"}),r.jsx(ke,{value:"active",children:"Active"}),r.jsx(ke,{value:"expired",children:"Expired"}),r.jsx(ke,{value:"future",children:"Future"})]})]})]})]})}),r.jsx(ie,{children:y?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading tariffs..."}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Tariff Name"}),r.jsx(le,{children:"Valid Period"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Blocks"}),r.jsx(le,{children:"Fixed Charge"}),r.jsx(le,{className:"text-right",children:"Actions"})]})}),r.jsxs(ur,{children:[(T=p==null?void 0:p.data)==null?void 0:T.map(z=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:z.name}),r.jsx(ne,{children:r.jsxs("div",{className:"text-sm",children:[r.jsxs("div",{children:["From: ",new Date(z.valid_from).toLocaleDateString()]}),z.valid_to&&r.jsxs("div",{children:["To: ",new Date(z.valid_to).toLocaleDateString()]})]})}),r.jsx(ne,{children:O(z)}),r.jsxs(ne,{children:[z.blocks.length," blocks"]}),r.jsxs(ne,{children:[z.currency," ",z.fixed_charge.toFixed(2)]}),r.jsx(ne,{className:"text-right",children:r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx(se,{variant:"ghost",size:"sm",onClick:()=>N(z),children:r.jsx(vd,{className:"h-4 w-4"})}),r.jsx(se,{variant:"ghost",size:"sm",onClick:()=>D(z.id),children:r.jsx(Oi,{className:"h-4 w-4"})})]})})]},z.id)),((I=p==null?void 0:p.data)==null?void 0:I.length)===0&&r.jsx(lt,{children:r.jsx(ne,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No tariffs found. Create your first tariff to get started."})})]})]})})]})]})}function yze(){var S,k;const[e,t]=R.useState(!1),[n,s]=R.useState(null),[i,c]=R.useState(1),u=br(),{data:a,isLoading:m}=ht({queryKey:["billing-runs"],queryFn:()=>Ls.getBillingRuns({per_page:50})}),p=jt({mutationFn:Ls.previewBilling,onSuccess:N=>{s(N),c(2)},onError:N=>{var D,O;qe.error(((O=(D=N.response)==null?void 0:D.data)==null?void 0:O.message)||"Failed to generate preview")}}),y=jt({mutationFn:Ls.executeBilling,onSuccess:N=>{u.invalidateQueries({queryKey:["billing-runs"]}),t(!1),c(1),s(null),qe.success(`Billing run completed: ${N.invoices_created} invoices created`)},onError:N=>{var D,O;qe.error(((O=(D=N.response)==null?void 0:D.data)==null?void 0:O.message)||"Failed to execute billing run")}}),v=N=>{N.preventDefault();const D=new FormData(N.currentTarget);p.mutate({period_start:D.get("period_start"),period_end:D.get("period_end"),segment:D.get("segment")||void 0,limit:10})},j=()=>{if(!n)return;const N=new FormData(document.querySelector("form"));y.mutate({period_start:N.get("period_start"),period_end:N.get("period_end"),due_date:N.get("due_date"),segment:N.get("segment")||void 0})};return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Billing Runs"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Monthly billing execution and invoice generation"})]}),r.jsxs(Rr,{open:e,onOpenChange:t,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{onClick:()=>{c(1),s(null)},children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"New Billing Run"]})}),r.jsxs(Er,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsx(Mr,{children:r.jsx(Or,{children:i===1?"Step 1: Configure Billing Period":"Step 2: Review & Execute"})}),i===1&&r.jsxs("form",{onSubmit:v,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"period_start",children:"Billing Period Start"}),r.jsx(Ge,{id:"period_start",name:"period_start",type:"date",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"period_end",children:"Billing Period End"}),r.jsx(Ge,{id:"period_end",name:"period_end",type:"date",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"due_date",children:"Invoice Due Date"}),r.jsx(Ge,{id:"due_date",name:"due_date",type:"date",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"segment",children:"Customer Segment (Optional)"}),r.jsxs("select",{id:"segment",name:"segment",className:"w-full border rounded-md p-2",children:[r.jsx("option",{value:"",children:"All Customers"}),r.jsx("option",{value:"residential",children:"Residential"}),r.jsx("option",{value:"commercial",children:"Commercial"}),r.jsx("option",{value:"industrial",children:"Industrial"}),r.jsx("option",{value:"public",children:"Public"})]})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsxs(se,{type:"submit",disabled:p.isPending,children:[r.jsx(Lm,{className:"h-4 w-4 mr-2"}),"Preview"]})]})]}),i===2&&n&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsx(J,{children:r.jsxs(ie,{className:"pt-6",children:[r.jsx("div",{className:"text-2xl font-bold",children:n.preview_count}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Accounts"})]})}),r.jsx(J,{children:r.jsxs(ie,{className:"pt-6",children:[r.jsx("div",{className:"text-2xl font-bold",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(n.total_estimated)}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Estimated"})]})}),r.jsx(J,{children:r.jsxs(ie,{className:"pt-6",children:[r.jsx("div",{className:"text-sm font-medium",children:n.period_start}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Period Start"})]})}),r.jsx(J,{children:r.jsxs(ie,{className:"pt-6",children:[r.jsx("div",{className:"text-sm font-medium",children:n.period_end}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Period End"})]})})]}),r.jsx("div",{className:"border rounded-lg",children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Account No"}),r.jsx(le,{children:"Customer"}),r.jsx(le,{className:"text-right",children:"Consumption (m)"}),r.jsx(le,{className:"text-right",children:"Estimated Charge"}),r.jsx(le,{children:"Tariff"})]})}),r.jsx(ur,{children:n.accounts.map((N,D)=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-mono",children:N.account_no}),r.jsx(ne,{children:N.customer_name}),r.jsx(ne,{className:"text-right",children:N.consumption.toFixed(2)}),r.jsx(ne,{className:"text-right",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(N.estimated_charge)}),r.jsx(ne,{children:N.tariff})]},D))})]})}),r.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>c(1),children:"Back"}),r.jsxs(se,{onClick:j,disabled:y.isPending,children:[r.jsx(od,{className:"h-4 w-4 mr-2"}),"Execute Billing Run"]})]})]})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(wT,{className:"h-5 w-5"}),"Billing Run History"]})}),r.jsx(ie,{children:m?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading billing runs..."}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Period"}),r.jsx(le,{children:"Period Dates"}),r.jsx(le,{className:"text-right",children:"Invoice Count"}),r.jsx(le,{className:"text-right",children:"Total Amount"}),r.jsx(le,{children:"Created At"})]})}),r.jsxs(ur,{children:[(S=a==null?void 0:a.data)==null?void 0:S.map((N,D)=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:N.period}),r.jsx(ne,{children:r.jsxs("div",{className:"text-sm",children:[new Date(N.period_start).toLocaleDateString()," - ",new Date(N.period_end).toLocaleDateString()]})}),r.jsx(ne,{className:"text-right",children:N.invoice_count.toLocaleString()}),r.jsx(ne,{className:"text-right",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(N.total_amount)}),r.jsx(ne,{children:new Date(N.created_at).toLocaleString()})]},D)),((k=a==null?void 0:a.data)==null?void 0:k.length)===0&&r.jsx(lt,{children:r.jsx(ne,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No billing runs found. Create your first billing run to generate invoices."})})]})]})})]})]})}function vze(){var v,j;const[e,t]=R.useState("all"),[n,s]=R.useState("all"),[i,c]=R.useState(""),u=br(),{data:a,isLoading:m}=ht({queryKey:["payments",e,n,i],queryFn:()=>Ls.getPayments({channel:e!=="all"?e:void 0,status:n!=="all"?n:void 0,search:i||void 0,per_page:50})}),{data:p}=ht({queryKey:["aging-report"],queryFn:()=>Ls.getAgingReport()});jt({mutationFn:({paymentId:S,invoiceIds:k})=>Ls.reconcilePayment(S,k),onSuccess:()=>{u.invalidateQueries({queryKey:["payments"]}),u.invalidateQueries({queryKey:["aging-report"]}),qe.success("Payment reconciled successfully")},onError:S=>{var k,N;qe.error(((N=(k=S.response)==null?void 0:k.data)==null?void 0:N.message)||"Failed to reconcile payment")}});const y=S=>{const k={cash:"bg-green-600",bank:"bg-blue-600",mpesa:"bg-purple-600",online:"bg-orange-600",adjustment:"bg-gray-600"};return r.jsx(We,{className:k[S]||"bg-gray-600",children:S.toUpperCase()})};return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Payment Reconciliation"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Match payments to invoices across all channels"})]}),p&&r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(eo,{className:"h-5 w-5"}),"Aging Summary"]})}),r.jsxs(ie,{children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-2xl font-bold",children:p.summary.total_accounts.toLocaleString()}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Accounts"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-2xl font-bold",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(p.summary.total_balance)}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Balance"})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"text-xl font-semibold",children:[p.dso," days"]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"DSO (Days Sales Outstanding)"})]})]}),r.jsx(Da,{width:"100%",height:200,children:r.jsxs(hy,{data:p.aging_buckets,children:[r.jsx(wo,{strokeDasharray:"3 3"}),r.jsx(aa,{dataKey:"bucket"}),r.jsx(Mi,{}),r.jsx(Ds,{}),r.jsx(Ia,{dataKey:"amount",fill:"#8884d8"})]})})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Top 5 Debtors"})}),r.jsx(ie,{children:r.jsx("div",{className:"space-y-3",children:p.top_debtors.slice(0,5).map((S,k)=>r.jsxs("div",{className:"flex justify-between items-center p-2 border rounded",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-medium",children:S.customer_name}),r.jsx("div",{className:"text-xs text-muted-foreground",children:S.account_no})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"font-semibold",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(S.balance)}),r.jsxs("div",{className:"text-xs text-muted-foreground",children:["90+: ",new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(S.over_90)]})]})]},k))})})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(OO,{className:"h-5 w-5"}),"Reconciliation Console"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(Ge,{placeholder:"Search account or ref...",value:i,onChange:S=>c(S.target.value),className:"w-64"}),r.jsxs(Jt,{value:e,onValueChange:t,children:[r.jsx(Yt,{className:"w-32",children:r.jsx(er,{placeholder:"Channel"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All"}),r.jsx(ke,{value:"cash",children:"Cash"}),r.jsx(ke,{value:"bank",children:"Bank"}),r.jsx(ke,{value:"mpesa",children:"M-Pesa"}),r.jsx(ke,{value:"online",children:"Online"}),r.jsx(ke,{value:"adjustment",children:"Adjustment"})]})]}),r.jsxs(Jt,{value:n,onValueChange:s,children:[r.jsx(Yt,{className:"w-40",children:r.jsx(er,{placeholder:"Status"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All"}),r.jsx(ke,{value:"reconciled",children:"Reconciled"}),r.jsx(ke,{value:"unreconciled",children:"Unreconciled"})]})]})]})]})}),r.jsx(ie,{children:m?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading payments..."}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Account No"}),r.jsx(le,{children:"Payment Date"}),r.jsx(le,{className:"text-right",children:"Amount"}),r.jsx(le,{children:"Channel"}),r.jsx(le,{children:"Reference"}),r.jsx(le,{children:"Customer"}),r.jsx(le,{className:"text-right",children:"Actions"})]})}),r.jsxs(ur,{children:[(v=a==null?void 0:a.data)==null?void 0:v.map(S=>{var k;return r.jsxs(lt,{children:[r.jsx(ne,{className:"font-mono",children:S.account_no}),r.jsx(ne,{children:new Date(S.paid_at).toLocaleDateString()}),r.jsx(ne,{className:"text-right font-medium",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(S.amount)}),r.jsx(ne,{children:y(S.channel)}),r.jsx(ne,{className:"font-mono text-xs",children:S.ref||"N/A"}),r.jsx(ne,{children:(k=S.connection)!=null&&k.customer?`${S.connection.customer.first_name} ${S.connection.customer.last_name}`:"N/A"}),r.jsx(ne,{className:"text-right",children:r.jsx(se,{size:"sm",variant:"outline",onClick:()=>{qe.info("Manual reconciliation dialog would open here")},children:"Reconcile"})})]},S.id)}),((j=a==null?void 0:a.data)==null?void 0:j.length)===0&&r.jsx(lt,{children:r.jsx(ne,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No payments found. Adjust filters to see more results."})})]})]})})]})]})}function _ze(){var D,O;const[e,t]=R.useState(!1),[n,s]=R.useState(null),i=br(),{data:c,isLoading:u}=ht({queryKey:["meter-routes"],queryFn:()=>Ls.getMeterRoutes({per_page:50})}),a=jt({mutationFn:Ls.createMeterRoute,onSuccess:()=>{i.invalidateQueries({queryKey:["meter-routes"]}),t(!1),s(null),qe.success("Route created successfully")},onError:T=>{var I,z;qe.error(((z=(I=T.response)==null?void 0:I.data)==null?void 0:z.message)||"Failed to create route")}}),m=jt({mutationFn:({id:T,data:I})=>Ls.updateMeterRoute(T,I),onSuccess:()=>{i.invalidateQueries({queryKey:["meter-routes"]}),t(!1),s(null),qe.success("Route updated successfully")},onError:T=>{var I,z;qe.error(((z=(I=T.response)==null?void 0:I.data)==null?void 0:z.message)||"Failed to update route")}}),p=jt({mutationFn:Ls.deleteMeterRoute,onSuccess:()=>{i.invalidateQueries({queryKey:["meter-routes"]}),qe.success("Route deleted successfully")},onError:T=>{var I,z;qe.error(((z=(I=T.response)==null?void 0:I.data)==null?void 0:z.message)||"Failed to delete route")}}),y=jt({mutationFn:Ls.downloadOfflinePackage,onSuccess:T=>{const I=new Blob([JSON.stringify(T,null,2)],{type:"application/json"}),z=URL.createObjectURL(I),$=document.createElement("a");$.href=z,$.download=`route-${T.route_id}-offline.json`,$.click(),qe.success("Offline package downloaded")},onError:()=>{qe.error("Failed to download offline package")}}),v=T=>{T.preventDefault();const I=new FormData(T.currentTarget),z={route_code:I.get("route_code"),area:I.get("area"),assigned_to:I.get("assigned_to")||null,meters_count:parseInt(I.get("meters_count"))};n?m.mutate({id:n.id,data:z}):a.mutate(z)},j=T=>{y.mutate(T)},S=T=>{s(T),t(!0)},k=T=>{confirm("Are you sure you want to delete this route?")&&p.mutate(T)},N=T=>{const I={active:"bg-green-600",unassigned:"bg-yellow-600",inactive:"bg-gray-600"};return r.jsx(We,{className:I[T]||"bg-gray-600",children:T.toUpperCase()})};return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Meter Reading Routes"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Route planning and reading cycle management"})]}),r.jsxs(Rr,{open:e,onOpenChange:t,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{onClick:()=>s(null),children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"Create Route"]})}),r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:n?"Edit Route":"Create New Route"})}),r.jsxs("form",{onSubmit:v,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"route_code",children:"Route Code"}),r.jsx(Ge,{id:"route_code",name:"route_code",defaultValue:n==null?void 0:n.route_code,required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"area",children:"Area/Zone"}),r.jsx(Ge,{id:"area",name:"area",defaultValue:n==null?void 0:n.area,required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"assigned_to",children:"Assigned To (Optional)"}),r.jsx(Ge,{id:"assigned_to",name:"assigned_to",defaultValue:(n==null?void 0:n.assigned_to)||""})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"meters_count",children:"Number of Meters"}),r.jsx(Ge,{id:"meters_count",name:"meters_count",type:"number",defaultValue:n==null?void 0:n.meters_count,required:!0})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsxs(se,{type:"submit",disabled:a.isPending||m.isPending,children:[n?"Update":"Create"," Route"]})]})]})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(jo,{className:"h-5 w-5"}),"Route Management"]})}),r.jsx(ie,{children:u?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading routes..."}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Route Code"}),r.jsx(le,{children:"Area"}),r.jsx(le,{children:"Assigned To"}),r.jsx(le,{className:"text-right",children:"Meters"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Last Read"}),r.jsx(le,{className:"text-right",children:"Completion"}),r.jsx(le,{className:"text-right",children:"Actions"})]})}),r.jsxs(ur,{children:[(D=c==null?void 0:c.data)==null?void 0:D.map(T=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:T.route_code}),r.jsx(ne,{children:T.area}),r.jsx(ne,{children:T.assigned_to||r.jsx("span",{className:"text-muted-foreground",children:"Unassigned"})}),r.jsx(ne,{className:"text-right",children:T.meters_count}),r.jsx(ne,{children:N(T.status)}),r.jsx(ne,{children:T.last_read_date?new Date(T.last_read_date).toLocaleDateString():"Never"}),r.jsxs(ne,{className:"text-right",children:[T.completion_rate.toFixed(1),"%"]}),r.jsx(ne,{className:"text-right",children:r.jsxs("div",{className:"flex gap-1 justify-end",children:[r.jsx(se,{variant:"ghost",size:"sm",title:"Download offline package",onClick:()=>j(T.id),children:r.jsx(rl,{className:"h-4 w-4"})}),r.jsx(se,{variant:"ghost",size:"sm",onClick:()=>S(T),children:r.jsx(vd,{className:"h-4 w-4"})}),r.jsx(se,{variant:"ghost",size:"sm",onClick:()=>k(T.id),children:r.jsx(Oi,{className:"h-4 w-4"})})]})})]},T.id)),((O=c==null?void 0:c.data)==null?void 0:O.length)===0&&r.jsx(lt,{children:r.jsx(ne,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No routes found. Create your first route to organize meter reading."})})]})]})})]})]})}function bze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"CRM Tickets"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Customer support ticket management and SLA tracking"})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(uS,{className:"h-5 w-5"}),"Ticket Queue"]})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Ticket creation, assignment, and resolution tracking coming soon..."})})]})]})}function jze(){var z,$,V,K,te,X,ve;const[e,t]=R.useState(!1),[n,s]=R.useState(null),[i,c]=R.useState("all"),[u,a]=R.useState(null),m=br(),{data:p,isLoading:y}=ht({queryKey:["kiosks",i],queryFn:()=>Ls.getKiosks({status:i&&i!=="all"?i:void 0,per_page:50})}),{data:v}=ht({queryKey:["kiosk-sales",u],queryFn:()=>u?Ls.getKioskSales(u):null,enabled:!!u}),{data:j}=ht({queryKey:["trucks"],queryFn:()=>Ls.getTrucks()}),S=jt({mutationFn:Ls.createKiosk,onSuccess:()=>{m.invalidateQueries({queryKey:["kiosks"]}),t(!1),s(null),qe.success("Kiosk created successfully")},onError:ae=>{var pe,Oe;qe.error(((Oe=(pe=ae.response)==null?void 0:pe.data)==null?void 0:Oe.message)||"Failed to create kiosk")}}),k=jt({mutationFn:({id:ae,data:pe})=>Ls.updateKiosk(ae,pe),onSuccess:()=>{m.invalidateQueries({queryKey:["kiosks"]}),t(!1),s(null),qe.success("Kiosk updated successfully")},onError:ae=>{var pe,Oe;qe.error(((Oe=(pe=ae.response)==null?void 0:pe.data)==null?void 0:Oe.message)||"Failed to update kiosk")}}),N=jt({mutationFn:Ls.deleteKiosk,onSuccess:()=>{m.invalidateQueries({queryKey:["kiosks"]}),qe.success("Kiosk deleted successfully")},onError:ae=>{var pe,Oe;qe.error(((Oe=(pe=ae.response)==null?void 0:pe.data)==null?void 0:Oe.message)||"Failed to delete kiosk")}}),D=ae=>{ae.preventDefault();const pe=new FormData(ae.currentTarget),Oe={kiosk_code:pe.get("kiosk_code"),vendor_name:pe.get("vendor_name"),vendor_phone:pe.get("vendor_phone"),location:pe.get("location"),coordinates:{lat:parseFloat(pe.get("lat")),lng:parseFloat(pe.get("lng"))},daily_target:parseFloat(pe.get("daily_target"))};n?k.mutate({id:n.id,data:Oe}):S.mutate(Oe)},O=ae=>{s(ae),t(!0)},T=ae=>{confirm("Are you sure you want to delete this kiosk?")&&N.mutate(ae)},I=ae=>{const pe={active:"bg-green-600",suspended:"bg-red-600",inactive:"bg-gray-600"};return r.jsx(We,{className:pe[ae]||"bg-gray-600",children:ae.toUpperCase()})};return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Water Kiosks & Trucking"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Kiosk registry, vendor management, and sales tracking"})]}),r.jsxs(Rr,{open:e,onOpenChange:t,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{onClick:()=>s(null),children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"Register Kiosk"]})}),r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:n?"Edit Kiosk":"Register New Kiosk"})}),r.jsxs("form",{onSubmit:D,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"kiosk_code",children:"Kiosk Code"}),r.jsx(Ge,{id:"kiosk_code",name:"kiosk_code",defaultValue:n==null?void 0:n.kiosk_code,required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"vendor_name",children:"Vendor Name"}),r.jsx(Ge,{id:"vendor_name",name:"vendor_name",defaultValue:n==null?void 0:n.vendor_name,required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"vendor_phone",children:"Vendor Phone"}),r.jsx(Ge,{id:"vendor_phone",name:"vendor_phone",type:"tel",defaultValue:n==null?void 0:n.vendor_phone,required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"daily_target",children:"Daily Target (KES)"}),r.jsx(Ge,{id:"daily_target",name:"daily_target",type:"number",defaultValue:n==null?void 0:n.daily_target,required:!0})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx(Ne,{htmlFor:"location",children:"Location Description"}),r.jsx(Ge,{id:"location",name:"location",defaultValue:n==null?void 0:n.location,required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"lat",children:"Latitude"}),r.jsx(Ge,{id:"lat",name:"lat",type:"number",step:"any",defaultValue:(n==null?void 0:n.coordinates.lat)||-1.286389,required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"lng",children:"Longitude"}),r.jsx(Ge,{id:"lng",name:"lng",type:"number",step:"any",defaultValue:(n==null?void 0:n.coordinates.lng)||36.817223,required:!0})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsxs(se,{type:"submit",disabled:S.isPending||k.isPending,children:[n?"Update":"Register"," Kiosk"]})]})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsx(J,{children:r.jsxs(ie,{className:"pt-6",children:[r.jsx("div",{className:"text-2xl font-bold",children:((z=p==null?void 0:p.summary)==null?void 0:z.total_kiosks)||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Kiosks"})]})}),r.jsx(J,{children:r.jsxs(ie,{className:"pt-6",children:[r.jsx("div",{className:"text-2xl font-bold",children:(($=p==null?void 0:p.summary)==null?void 0:$.active_kiosks)||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Active Kiosks"})]})}),r.jsx(J,{children:r.jsxs(ie,{className:"pt-6",children:[r.jsx("div",{className:"text-2xl font-bold",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(((V=p==null?void 0:p.summary)==null?void 0:V.today_total_sales)||0)}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Today's Sales"})]})}),r.jsx(J,{children:r.jsxs(ie,{className:"pt-6",children:[r.jsx("div",{className:"text-2xl font-bold",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(((K=p==null?void 0:p.summary)==null?void 0:K.total_balance)||0)}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Balance"})]})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs(J,{className:"lg:col-span-2",children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(bT,{className:"h-5 w-5"}),"Kiosk Registry"]}),r.jsxs(Jt,{value:i,onValueChange:c,children:[r.jsx(Yt,{className:"w-32",children:r.jsx(er,{placeholder:"Status"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All"}),r.jsx(ke,{value:"active",children:"Active"}),r.jsx(ke,{value:"suspended",children:"Suspended"}),r.jsx(ke,{value:"inactive",children:"Inactive"})]})]})]})}),r.jsx(ie,{children:y?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading kiosks..."}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Code"}),r.jsx(le,{children:"Vendor"}),r.jsx(le,{children:"Location"}),r.jsx(le,{children:"Status"}),r.jsx(le,{className:"text-right",children:"Today's Sales"}),r.jsx(le,{className:"text-right",children:"Balance"}),r.jsx(le,{className:"text-right",children:"Actions"})]})}),r.jsxs(ur,{children:[(te=p==null?void 0:p.data)==null?void 0:te.map(ae=>r.jsxs(lt,{className:"cursor-pointer",onClick:()=>a(ae.id),children:[r.jsx(ne,{className:"font-mono",children:ae.kiosk_code}),r.jsx(ne,{children:r.jsxs("div",{children:[r.jsx("div",{className:"font-medium",children:ae.vendor_name}),r.jsx("div",{className:"text-xs text-muted-foreground",children:ae.vendor_phone})]})}),r.jsx(ne,{children:ae.location}),r.jsx(ne,{children:I(ae.status)}),r.jsx(ne,{className:"text-right",children:r.jsxs("div",{children:[r.jsx("div",{children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(ae.today_sales)}),r.jsxs("div",{className:"text-xs text-muted-foreground",children:["Target: ",new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(ae.daily_target)]})]})}),r.jsx(ne,{className:"text-right",children:r.jsx("span",{className:ae.balance<0?"text-red-600 font-semibold":"",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(ae.balance)})}),r.jsx(ne,{className:"text-right",children:r.jsxs("div",{className:"flex gap-1 justify-end",children:[r.jsx(se,{variant:"ghost",size:"sm",onClick:pe=>{pe.stopPropagation(),O(ae)},children:r.jsx(vd,{className:"h-4 w-4"})}),r.jsx(se,{variant:"ghost",size:"sm",onClick:pe=>{pe.stopPropagation(),T(ae.id)},children:r.jsx(Oi,{className:"h-4 w-4"})})]})})]},ae.id)),((X=p==null?void 0:p.data)==null?void 0:X.length)===0&&r.jsx(lt,{children:r.jsx(ne,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No kiosks found. Register your first kiosk to start tracking."})})]})]})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Xu,{className:"h-5 w-5"}),"Sales Performance"]})}),r.jsx(ie,{children:u&&v?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-muted-foreground",children:"Total Volume"}),r.jsxs("div",{className:"font-semibold",children:[v.total_volume.toFixed(1)," m"]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-muted-foreground",children:"Avg. Daily"}),r.jsx("div",{className:"font-semibold",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(v.average_daily)})]})]}),r.jsx(Da,{width:"100%",height:200,children:r.jsxs(Yb,{data:v.sales,children:[r.jsx(wo,{strokeDasharray:"3 3"}),r.jsx(aa,{dataKey:"date",tick:{fontSize:10}}),r.jsx(Mi,{}),r.jsx(Ds,{}),r.jsx(Xo,{type:"monotone",dataKey:"amount",stroke:"#8884d8",strokeWidth:2})]})})]}):r.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"Click on a kiosk to view sales performance"})})]})]}),j&&((ve=j.data)==null?void 0:ve.length)>0&&r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(k0,{className:"h-5 w-5"}),"Water Truck Fleet"]})}),r.jsx(ie,{children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Truck No"}),r.jsx(le,{children:"Driver"}),r.jsx(le,{children:"Phone"}),r.jsx(le,{children:"Status"}),r.jsx(le,{className:"text-right",children:"Capacity (L)"}),r.jsx(le,{className:"text-right",children:"Trips Today"}),r.jsx(le,{className:"text-right",children:"Revenue Today"})]})}),r.jsx(ur,{children:j.data.map(ae=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-mono",children:ae.truck_no}),r.jsx(ne,{children:ae.driver_name}),r.jsx(ne,{children:ae.phone}),r.jsx(ne,{children:r.jsx(We,{className:ae.status==="in_transit"?"bg-blue-600":"bg-green-600",children:ae.status.replace("_"," ").toUpperCase()})}),r.jsx(ne,{className:"text-right",children:ae.capacity.toLocaleString()}),r.jsx(ne,{className:"text-right",children:ae.trips_today}),r.jsx(ne,{className:"text-right",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(ae.revenue_today)})]},ae.id))})]})})]})]})}function wze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Water Trucking"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Bowser management and trip tracking"})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(k0,{className:"h-5 w-5"}),"Trip Management"]})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Truck scheduling, route tracking, and delivery verification coming soon..."})})]})]})}function Sze(){var D,O;const[e,t]=R.useState(!1),[n,s]=R.useState("all"),[i,c]=R.useState(1),u=br(),{data:a,isLoading:m}=ht({queryKey:["connection-applications",n],queryFn:()=>Ls.getConnectionApplications({status:n&&n!=="all"?n:void 0,per_page:50})}),p=jt({mutationFn:Ls.submitApplication,onSuccess:()=>{u.invalidateQueries({queryKey:["connection-applications"]}),t(!1),c(1),qe.success("Application submitted successfully")},onError:T=>{var I,z;qe.error(((z=(I=T.response)==null?void 0:I.data)==null?void 0:z.message)||"Failed to submit application")}}),y=jt({mutationFn:({id:T,data:I})=>Ls.updateApplication(T,I),onSuccess:()=>{u.invalidateQueries({queryKey:["connection-applications"]}),qe.success("Application updated successfully")},onError:T=>{var I,z;qe.error(((z=(I=T.response)==null?void 0:I.data)==null?void 0:z.message)||"Failed to update application")}}),v=T=>{if(T.preventDefault(),i<3){c(i+1);return}const I=new FormData(T.currentTarget),z={applicant_name:I.get("applicant_name"),phone:I.get("phone"),email:I.get("email"),id_number:I.get("id_number"),address:I.get("address"),location:{lat:parseFloat(I.get("lat"))||-1.286389,lng:parseFloat(I.get("lng"))||36.817223},connection_type:I.get("connection_type"),property_type:I.get("property_type")};p.mutate(z)},j=T=>{y.mutate({id:T,data:{status:"approved"}})},S=T=>{y.mutate({id:T,data:{status:"rejected"}})},k=T=>{const I={kyc_pending:{variant:"bg-yellow-600",icon:ei},pending_approval:{variant:"bg-blue-600",icon:ei},approved:{variant:"bg-green-600",icon:os},rejected:{variant:"bg-red-600",icon:yd},connected:{variant:"bg-purple-600",icon:os}},{variant:z,icon:$}=I[T]||I.kyc_pending;return r.jsxs(We,{className:z,children:[r.jsx($,{className:"h-3 w-3 mr-1"}),T.replace("_"," ").toUpperCase()]})},N=T=>{const I={pending:"bg-yellow-600",verified:"bg-green-600",rejected:"bg-red-600"};return r.jsx(We,{className:I[T],children:T.toUpperCase()})};return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Connection Applications"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"New service requests and approval workflow"})]}),r.jsxs(Rr,{open:e,onOpenChange:t,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{onClick:()=>c(1),children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"New Application"]})}),r.jsxs(Er,{className:"max-w-2xl",children:[r.jsx(Mr,{children:r.jsxs(Or,{children:["Step ",i," of 3: ",i===1?"Applicant Details":i===2?"Property Information":"Confirmation"]})}),r.jsxs("form",{onSubmit:v,className:"space-y-4",children:[i===1&&r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"col-span-2",children:[r.jsx(Ne,{htmlFor:"applicant_name",children:"Full Name"}),r.jsx(Ge,{id:"applicant_name",name:"applicant_name",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"phone",children:"Phone Number"}),r.jsx(Ge,{id:"phone",name:"phone",type:"tel",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"email",children:"Email (Optional)"}),r.jsx(Ge,{id:"email",name:"email",type:"email"})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx(Ne,{htmlFor:"id_number",children:"ID/Passport Number"}),r.jsx(Ge,{id:"id_number",name:"id_number",required:!0})]})]}),i===2&&r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"col-span-2",children:[r.jsx(Ne,{htmlFor:"address",children:"Property Address"}),r.jsx(Ge,{id:"address",name:"address",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"connection_type",children:"Connection Type"}),r.jsxs("select",{id:"connection_type",name:"connection_type",className:"w-full border rounded-md p-2",required:!0,children:[r.jsx("option",{value:"new",children:"New Connection"}),r.jsx("option",{value:"upgrade",children:"Upgrade"}),r.jsx("option",{value:"temporary",children:"Temporary"})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"property_type",children:"Property Type"}),r.jsxs("select",{id:"property_type",name:"property_type",className:"w-full border rounded-md p-2",required:!0,children:[r.jsx("option",{value:"residential",children:"Residential"}),r.jsx("option",{value:"commercial",children:"Commercial"}),r.jsx("option",{value:"industrial",children:"Industrial"})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"lat",children:"Latitude"}),r.jsx(Ge,{id:"lat",name:"lat",type:"number",step:"any",defaultValue:"-1.286389",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"lng",children:"Longitude"}),r.jsx(Ge,{id:"lng",name:"lng",type:"number",step:"any",defaultValue:"36.817223",required:!0})]})]}),i===3&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"text-center py-8",children:[r.jsx(os,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),r.jsx("h3",{className:"text-xl font-semibold",children:"Review Application"}),r.jsx("p",{className:"text-muted-foreground mt-2",children:"Please review your information before submitting"})]}),r.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-2 text-sm",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Applicant:"})," Check form data"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Phone:"})," Check form data"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Property:"})," Check form data"]})]})]}),r.jsxs("div",{className:"flex justify-between pt-4",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>i>1?c(i-1):t(!1),children:i>1?"Previous":"Cancel"}),r.jsx(se,{type:"submit",disabled:p.isPending,children:i<3?"Next":"Submit Application"})]})]})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Kc,{className:"h-5 w-5"}),"Application Management"]}),r.jsxs(Jt,{value:n,onValueChange:s,children:[r.jsx(Yt,{className:"w-48",children:r.jsx(er,{placeholder:"Filter by status"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Applications"}),r.jsx(ke,{value:"kyc_pending",children:"KYC Pending"}),r.jsx(ke,{value:"pending_approval",children:"Pending Approval"}),r.jsx(ke,{value:"approved",children:"Approved"}),r.jsx(ke,{value:"rejected",children:"Rejected"}),r.jsx(ke,{value:"connected",children:"Connected"})]})]})]})}),r.jsx(ie,{children:m?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading applications..."}):r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Application No"}),r.jsx(le,{children:"Applicant"}),r.jsx(le,{children:"Phone"}),r.jsx(le,{children:"Address"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"KYC"}),r.jsx(le,{className:"text-right",children:"Est. Cost"}),r.jsx(le,{children:"Applied Date"}),r.jsx(le,{className:"text-right",children:"Actions"})]})}),r.jsxs(ur,{children:[(D=a==null?void 0:a.data)==null?void 0:D.map(T=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-mono",children:T.application_no}),r.jsx(ne,{className:"font-medium",children:T.applicant_name}),r.jsx(ne,{children:T.phone}),r.jsx(ne,{className:"max-w-xs truncate",children:T.address}),r.jsx(ne,{children:k(T.status)}),r.jsx(ne,{children:N(T.kyc_status)}),r.jsx(ne,{className:"text-right",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(T.estimated_cost)}),r.jsx(ne,{children:new Date(T.applied_date).toLocaleDateString()}),r.jsx(ne,{className:"text-right",children:r.jsx("div",{className:"flex gap-1 justify-end",children:T.status==="pending_approval"&&r.jsxs(r.Fragment,{children:[r.jsx(se,{size:"sm",variant:"outline",onClick:()=>j(T.id),children:"Approve"}),r.jsx(se,{size:"sm",variant:"destructive",onClick:()=>S(T.id),children:"Reject"})]})})})]},T.id)),((O=a==null?void 0:a.data)==null?void 0:O.length)===0&&r.jsx(lt,{children:r.jsx(ne,{colSpan:9,className:"text-center py-8 text-muted-foreground",children:"No applications found. Submit a new application to get started."})})]})]})})]})]})}function Nze(){return r.jsxs("div",{className:"flex h-screen overflow-hidden",children:[r.jsx(za,{}),r.jsx("main",{className:"flex-1 overflow-y-auto",children:r.jsx(Fa,{})})]})}function Pze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"RWSS Committees Directory"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Community water committee registry and governance"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Active Committees"}),r.jsx(Pi,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"24"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all schemes"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Elections Due"}),r.jsx(va,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"3"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Within next 90 days"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Compliance Score"}),r.jsx(os,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"87%"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Avg governance score"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Committee Registry"})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Committee directory, member management, and governance tracking coming soon..."})})]})]})}function Cze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Kiambu Water Committee"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Term: Jan 2023 - Dec 2025  Compliance Score: 92%"})]}),r.jsxs(qs,{defaultValue:"overview",className:"w-full",children:[r.jsxs(As,{children:[r.jsx(sr,{value:"overview",children:"Overview"}),r.jsx(sr,{value:"members",children:"Members"}),r.jsx(sr,{value:"meetings",children:"Meetings"}),r.jsx(sr,{value:"actions",children:"Actions"}),r.jsx(sr,{value:"finance",children:"Finance"}),r.jsx(sr,{value:"audits",children:"Audits"}),r.jsx(sr,{value:"documents",children:"Documents"})]}),r.jsxs(Nr,{value:"overview",className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Members"}),r.jsx(Pi,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"12"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"5 officers, 7 members"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Meetings YTD"}),r.jsx(va,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"9"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"100% quorum met"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Bank Balance"}),r.jsx(Za,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"KES 245K"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Last updated today"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Governance Compliance"})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Gender quota: 50%  | Meeting frequency: Monthly  | Elections on schedule "})})]})]}),r.jsx(Nr,{value:"members",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Committee Members"})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Member roster with roles, terms, and contact details coming soon..."})})]})}),r.jsx(Nr,{value:"meetings",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Meeting History"})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Agendas, attendance, minutes, and resolutions coming soon..."})})]})}),r.jsx(Nr,{value:"actions",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Action Items"})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Pending actions with owners and due dates coming soon..."})})]})}),r.jsx(Nr,{value:"finance",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Committee Finances"})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Cashbook entries, bank reconciliations, and financial reports coming soon..."})})]})}),r.jsx(Nr,{value:"audits",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Financial Audits"})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Audit findings, recommendations, and compliance tracking coming soon..."})})]})}),r.jsx(Nr,{value:"documents",children:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Committee Documents"})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Bylaws, meeting minutes, financial reports, and audit documents coming soon..."})})]})})]})]})}function Aze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Committee Finance & Cashbook"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Community tariff collection, cashbook, and financial audits"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Total Collections"}),r.jsx(Za,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"KES 1.2M"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Current month"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Bank Balance"}),r.jsx($s,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"KES 3.8M"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"All committees"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Audit Due"}),r.jsx(ei,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"5"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Committees"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Cashbook Management"})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Receipts, payments, reconciliations, and audit management coming soon..."})})]})]})}function kze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Vendor & Partner Portal"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Vendor registration, KYC, and performance tracking"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Approved Vendors"}),r.jsx(_T,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"142"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Active in database"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Avg OTIF Score"}),r.jsx(eV,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"94%"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"On-time in-full delivery"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Pending KYC"}),r.jsx($s,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"8"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting verification"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Vendor Management"})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Vendor onboarding, KYC verification, and performance scorecards coming soon..."})})]})]})}function Tze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Bids & RFQ Center"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"RFQ management, bid submission, and evaluation"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Active RFQs"}),r.jsx(is,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"12"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Open for bidding"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Pending Evaluation"}),r.jsx(xs,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"5"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting review"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Awarded This Month"}),r.jsx(os,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"18"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Contracts awarded"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"RFQ Management"})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Bid submission, evaluation, and contract award workflow coming soon..."})})]})]})}function Eze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Vendor Deliveries & Invoices"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Delivery notes, GRN processing, and invoice tracking"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Pending GRN"}),r.jsx(xs,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"8"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting receipt"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Received"}),r.jsx(os,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"142"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"This month"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Rejected"}),r.jsx(yd,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"3"}),r.jsx("p",{className:"text-xs text-red-600",children:"Quality issues"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Pending Payment"}),r.jsx(Kc,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"KES 2.4M"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"28 invoices"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Delivery Management"})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Delivery note submission, GRN verification, invoice approval, and payment tracking coming soon..."})})]})]})}function Mze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Stakeholder Mapping"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Stakeholder registry, influence/interest analysis, and engagement tracking"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Total Stakeholders"}),r.jsx(Pi,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"245"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"All categories"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"High Influence"}),r.jsx($s,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"32"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Key decision makers"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Vulnerable Groups"}),r.jsx(Px,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"18"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Requiring special attention"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Stakeholder Directory & Analysis"})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Stakeholder registry, influence/interest matrix, and engagement plans coming soon..."})})]})]})}function Oze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Stakeholder Engagement Planner"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Plan and track community meetings, barazas, and consultations"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Upcoming Events"}),r.jsx(va,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"8"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Next 30 days"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Total Attendance"}),r.jsx(Pi,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"1,245"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"This quarter"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Completed"}),r.jsx(os,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"42"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Events this year"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Engagement Calendar"})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Event planning, QR check-in, and attendance tracking coming soon..."})})]})]})}function Ize(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Grievance Redress Mechanism (GRM)"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Multi-channel complaint intake, SLA tracking, and resolution workflow"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"New Tickets"}),r.jsx(Cx,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"12"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting triage"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"In Progress"}),r.jsx(xs,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"28"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Active resolution"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Overdue SLA"}),r.jsx(gn,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"3"}),r.jsx("p",{className:"text-xs text-red-600",children:"Require escalation"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Resolved (30d)"}),r.jsx(os,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"156"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"91% SLA compliance"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"GRM Kanban Board"})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Ticket intake, assignment, SLA tracking, and community sign-off workflow coming soon..."})})]})]})}function Dze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Open Data & Transparency"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Public datasets, APIs, maps, and transparency dashboards"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Public Datasets"}),r.jsx(Yq,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"18"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Available for download"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Downloads"}),r.jsx(rl,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"1,245"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"This month"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"API Calls"}),r.jsx(Kq,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"8.4K"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Last 7 days"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Public Maps"}),r.jsx(Px,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"6"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Interactive layers"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Data Catalog"})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Dataset discovery, API documentation, public maps, and data stories coming soon..."})})]})]})}function Rze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Dataset Builder"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Create and configure public datasets with privacy filters and transformations"})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(xl,{className:"h-5 w-5"}),"Source Selection"]})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Select source tables/views for your dataset..."})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(yl,{className:"h-5 w-5"}),"Privacy Filters"]})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Anonymization, aggregation, redaction, and masking rules coming soon..."})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(ai,{className:"h-5 w-5"}),"Transformations"]})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Group, aggregate, filter, and compute derived fields coming soon..."})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(xs,{className:"h-5 w-5"}),"Refresh Schedule"]})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"Configure automatic refresh cadence (hourly, daily, weekly) coming soon..."})})]})]})}function Lze(){return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Public Interactive Maps"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Share water infrastructure, coverage, and service data through interactive maps"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Map Layers"}),r.jsx(Xq,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"12"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Coverage, facilities, kiosks"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Downloads"}),r.jsx(rl,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"542"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"GeoJSON/CSV exports"})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Embeds"}),r.jsx($re,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:"8"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Active on websites"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Bc,{className:"h-5 w-5"}),"Interactive Map Viewer"]})}),r.jsx(ie,{children:r.jsx("p",{className:"text-muted-foreground",children:"MapLibre GL vector tile layers, legend, layer controls, and embed code generator coming soon..."})})]})]})}function Fze(){return r.jsxs("div",{className:"flex h-screen bg-background",children:[r.jsx(za,{}),r.jsx("main",{className:"flex-1 overflow-auto",children:r.jsx(Fa,{})})]})}const rs={topology:{getNodes:e=>me.get("/core-ops/network/nodes",e),createNode:e=>me.post("/core-ops/network/nodes",e),getEdges:e=>me.get("/core-ops/network/edges",e),createEdge:e=>me.post("/core-ops/network/edges",e),trace:(e,t)=>me.post("/core-ops/network/trace",{from_node_id:e,to_node_id:t})},telemetry:{getTags:e=>me.get("/core-ops/telemetry/tags",e),createTag:e=>me.post("/core-ops/telemetry/tags",e),updateTag:(e,t)=>me.patch(`/core-ops/telemetry/tags/${e}`,t),getMeasurements:e=>me.get("/core-ops/telemetry/measurements",e),ingestBatch:e=>me.post("/core-ops/telemetry/ingest",{measurements:e})},nrw:{getSnapshots:e=>me.get("/core-ops/nrw/snapshots",e),createSnapshot:e=>me.post("/core-ops/nrw/snapshots",e),calculateBalance:e=>me.post(`/core-ops/nrw/calculate/${e}`),getInterventions:e=>me.get("/core-ops/nrw/interventions",e),createIntervention:e=>me.post("/core-ops/nrw/interventions",e)},outages:{getAll:e=>me.get("/core-ops/outages",e),getById:e=>me.get(`/core-ops/outages/${e}`),create:e=>me.post("/core-ops/outages",e),update:(e,t)=>me.patch(`/core-ops/outages/${e}`,t),changeState:(e,t,n)=>me.post(`/core-ops/outages/${e}/state`,{state:t,notes:n})},dosing:{getPlans:e=>me.get("/core-ops/dosing/plans",e),createPlan:e=>me.post("/core-ops/dosing/plans",e),getStocks:e=>me.get("/core-ops/dosing/stocks",e),createStock:e=>me.post("/core-ops/dosing/stocks",e)},scheduling:{getSchedules:e=>me.get("/core-ops/schedule",e),create:e=>me.post("/core-ops/schedule",e),update:(e,t)=>me.patch(`/core-ops/schedule/${e}`,t)},operations:{getDashboard:()=>me.get("/core-ops/dashboard"),getAlarms:()=>me.get("/core-ops/alarms")},shifts:{list:e=>me.get("/operations/shifts",e),create:e=>me.post("/operations/shifts",e),get:e=>me.get(`/operations/shifts/${e}`),close:(e,t)=>me.post(`/operations/shifts/${e}/close`,t),getEntries:(e,t)=>me.get(`/operations/shifts/${e}/entries`,t),addEntry:(e,t)=>me.post(`/operations/shifts/${e}/entries`,t)},events:{list:e=>me.get("/operations/events",e),create:e=>me.post("/operations/events",e),get:e=>me.get(`/operations/events/${e}`),acknowledge:(e,t)=>me.post(`/operations/events/${e}/acknowledge`,t),resolve:(e,t)=>me.post(`/operations/events/${e}/resolve`,t),link:(e,t)=>me.post(`/operations/events/${e}/link`,t)},checklists:{list:e=>me.get("/operations/checklists",e),create:e=>me.post("/operations/checklists",e),get:e=>me.get(`/operations/checklists/${e}`),update:(e,t)=>me.patch(`/operations/checklists/${e}`,t),delete:e=>me.delete(`/operations/checklists/${e}`),startRun:(e,t)=>me.post(`/operations/checklists/${e}/start`,t),listRuns:e=>me.get("/operations/checklist-runs",e),updateRun:(e,t)=>me.patch(`/operations/checklist-runs/${e}`,t),completeRun:(e,t)=>me.post(`/operations/checklist-runs/${e}/complete`,t)},playbooks:{list:e=>me.get("/operations/playbooks",e),create:e=>me.post("/operations/playbooks",e),get:e=>me.get(`/operations/playbooks/${e}`),update:(e,t)=>me.patch(`/operations/playbooks/${e}`,t),delete:e=>me.delete(`/operations/playbooks/${e}`),findMatching:e=>me.get("/operations/playbooks/find-matching",e)},escalationPolicies:{list:e=>me.get("/operations/escalation-policies",e),create:e=>me.post("/operations/escalation-policies",e),get:e=>me.get(`/operations/escalation-policies/${e}`),update:(e,t)=>me.patch(`/operations/escalation-policies/${e}`,t),delete:e=>me.delete(`/operations/escalation-policies/${e}`)}};function zze(){const[e,t]=R.useState([]),[n,s]=R.useState(!1),[i,c]=R.useState(!0),{data:u,isLoading:a,error:m}=ht({queryKey:["operations-dashboard"],queryFn:()=>rs.operations.getDashboard(),refetchInterval:3e4});R.useEffect(()=>{if(!i)return;let S=null,k=null,N=0;const D=3e4,O=()=>{try{S=new EventSource("/api/v1/console/alarms",{withCredentials:!0}),S.onopen=()=>{s(!0),N=0,console.log("SSE connection established")},S.onmessage=T=>{try{const I=JSON.parse(T.data);t(z=>[I,...z].slice(0,20))}catch(I){console.error("Failed to parse SSE message:",I)}},S.onerror=T=>{if(s(!1),(S==null?void 0:S.readyState)===EventSource.CLOSED){console.error("SSE connection closed by server"),N++;const I=Math.min(1e3*Math.pow(2,N),D);console.log(`Attempting to reconnect in ${I}ms (attempt ${N})`),k=setTimeout(()=>{i&&(S==null?void 0:S.readyState)===EventSource.CLOSED&&O()},I)}}}catch(T){console.error("Failed to create SSE connection:",T),s(!1)}};return O(),()=>{k&&clearTimeout(k),S&&S.close(),s(!1)}},[i]);const p=S=>{switch(S){case"planned":return r.jsx(va,{className:"h-4 w-4"});case"fault":return r.jsx(gn,{className:"h-4 w-4"});case"power":return r.jsx(Ax,{className:"h-4 w-4"});case"water_quality":return r.jsx(Gc,{className:"h-4 w-4"});default:return r.jsx(Wo,{className:"h-4 w-4"})}},y=S=>{switch(S){case"live":return"destructive";case"approved":return"default";case"restored":return"secondary";default:return"outline"}},v=S=>{switch(S){case"running":return"default";case"scheduled":return"secondary";case"completed":return"outline";default:return"outline"}},j=S=>{switch(S){case"critical":return r.jsxs(We,{variant:"destructive",className:"gap-1",children:[r.jsx(bo,{className:"h-3 w-3"}),"Critical"]});case"warning":return r.jsxs(We,{className:"bg-orange-500 gap-1",children:[r.jsx(gn,{className:"h-3 w-3"}),"Warning"]});case"info":return r.jsxs(We,{variant:"outline",className:"gap-1",children:[r.jsx(A0,{className:"h-3 w-3"}),"Info"]});default:return r.jsx(We,{variant:"outline",children:S})}};return r.jsxs("div",{className:"container mx-auto p-6 space-y-6 bg-background",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Operations Console"}),r.jsx("p",{className:"text-muted-foreground",children:"Real-time monitoring and control center"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"flex items-center gap-2 text-sm",children:n?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),r.jsx("span",{className:"text-muted-foreground",children:"Live Feed Active"})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400"}),r.jsx("span",{className:"text-muted-foreground",children:"Disconnected"})]})}),r.jsxs(se,{variant:"outline",size:"sm",onClick:()=>c(!i),children:[i?r.jsx(A0,{className:"h-4 w-4 mr-2"}):r.jsx(Tre,{className:"h-4 w-4 mr-2"}),i?"Disable":"Enable"," Alarms"]})]})]}),a&&!u?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading operations console..."})}):m?r.jsx(Wi,{variant:"destructive",children:r.jsxs(ki,{children:["Error loading operations dashboard: ",m.message]})}):r.jsxs(r.Fragment,{children:[i&&e.length>0&&r.jsxs(J,{className:"border-orange-500 bg-orange-50/50 dark:bg-orange-950/20",children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(bo,{className:"h-5 w-5 text-orange-600"}),"Live Alarms"]}),r.jsx(xr,{children:"Real-time telemetry threshold violations"})]}),r.jsx(se,{variant:"ghost",size:"sm",onClick:()=>t([]),children:"Clear All"})]})}),r.jsx(ie,{children:r.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:e.map(S=>r.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-background border",children:[r.jsx("div",{className:"mt-1",children:j(S.severity)}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("div",{className:"font-medium text-sm truncate",children:S.tag_name}),r.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:mn(new Date(S.timestamp),"HH:mm:ss")})]}),r.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:S.message}),r.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs",children:[S.asset_name&&r.jsxs("span",{className:"text-muted-foreground",children:["Asset: ",S.asset_name]}),S.scheme_name&&r.jsxs("span",{className:"text-muted-foreground",children:["Scheme: ",S.scheme_name]}),r.jsxs("span",{className:"font-mono",children:["Value: ",r.jsx("span",{className:"font-semibold",children:S.value})," / Threshold: ",S.threshold]})]})]})]},S.id))})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs(J,{className:"bg-card text-card-foreground",children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Active Outages"}),r.jsx(gn,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:(u==null?void 0:u.kpis.outages_count)||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Approved or currently live"})]})]}),r.jsxs(J,{className:"bg-card text-card-foreground",children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Pump Schedules"}),r.jsx(va,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:(u==null?void 0:u.kpis.schedules_count)||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Next 24 hours"})]})]}),r.jsxs(J,{className:"bg-card text-card-foreground",children:[r.jsxs(ge,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(xe,{className:"text-sm font-medium",children:"Active Dosing Plans"}),r.jsx(Gc,{className:"h-4 w-4 text-muted-foreground"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-2xl font-bold",children:(u==null?void 0:u.kpis.dose_plans_count)||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Actively controlling dosing"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs(J,{className:"bg-card text-card-foreground",children:[r.jsxs(ge,{children:[r.jsx(xe,{className:"text-foreground",children:"Active Outages"}),r.jsx(xr,{children:"Current and planned water supply interruptions"})]}),r.jsx(ie,{children:u!=null&&u.active_outages&&u.active_outages.length>0?r.jsx("div",{className:"space-y-4",children:u.active_outages.map(S=>{var k;return r.jsxs("div",{className:"flex items-start gap-4 p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[r.jsx("div",{className:"mt-1",children:p(S.cause)}),r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"font-medium text-foreground",children:[((k=S.scheme)==null?void 0:k.name)||"Unknown Scheme",S.code&&r.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",S.code,")"]})]}),r.jsx(We,{variant:y(S.state),children:S.state})]}),S.summary&&r.jsx("p",{className:"text-sm text-muted-foreground",children:S.summary}),r.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[r.jsxs("span",{children:["Start: ",mn(new Date(S.starts_at),"PPp")]}),S.ends_at&&r.jsxs("span",{children:["End: ",mn(new Date(S.ends_at),"PPp")]})]}),S.estimated_customers_affected&&r.jsxs("div",{className:"text-xs text-muted-foreground",children:["~",S.estimated_customers_affected.toLocaleString()," customers affected"]})]})]},S.id)})}):r.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No active outages"})})]}),r.jsxs(J,{className:"bg-card text-card-foreground",children:[r.jsxs(ge,{children:[r.jsx(xe,{className:"text-foreground",children:"Pump Schedules"}),r.jsx(xr,{children:"Scheduled and running pump operations"})]}),r.jsx(ie,{children:u!=null&&u.active_schedules&&u.active_schedules.length>0?r.jsx("div",{className:"space-y-4",children:u.active_schedules.map(S=>{var k,N,D;return r.jsxs("div",{className:"flex items-start gap-4 p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[r.jsx("div",{className:"mt-1",children:r.jsx(Ax,{className:"h-4 w-4"})}),r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"font-medium text-foreground",children:((k=S.asset)==null?void 0:k.name)||((N=S.asset)==null?void 0:N.code)||"Unknown Asset"}),r.jsx(We,{variant:v(S.status),children:S.status})]}),r.jsx("div",{className:"text-sm text-muted-foreground",children:(D=S.scheme)==null?void 0:D.name}),r.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[r.jsx("span",{children:mn(new Date(S.start_at),"PPp")}),r.jsx("span",{children:""}),r.jsx("span",{children:mn(new Date(S.end_at),"PPp")})]}),S.target_volume_m3&&r.jsxs("div",{className:"text-xs text-muted-foreground",children:["Target: ",S.target_volume_m3.toLocaleString()," m"]})]})]},S.id)})}):r.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No scheduled pumping"})})]})]}),r.jsxs(J,{className:"bg-card text-card-foreground",children:[r.jsxs(ge,{children:[r.jsx(xe,{className:"text-foreground",children:"Active Dosing Plans"}),r.jsx(xr,{children:"Chemical dosing control currently in effect"})]}),r.jsx(ie,{children:u!=null&&u.active_dose_plans&&u.active_dose_plans.length>0?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.active_dose_plans.map(S=>{var k,N,D;return r.jsxs("div",{className:"p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(Gc,{className:"h-4 w-4 text-primary"}),r.jsx("div",{className:"font-medium text-foreground",children:((k=S.asset)==null?void 0:k.name)||((N=S.asset)==null?void 0:N.code)||"Unknown Asset"})]}),r.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:(D=S.scheme)==null?void 0:D.name}),S.chemical&&r.jsxs("div",{className:"text-xs text-muted-foreground",children:["Chemical: ",S.chemical]})]},S.id)})}):r.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No active dosing plans"})})]}),r.jsxs(J,{className:"bg-card text-card-foreground",children:[r.jsxs(ge,{children:[r.jsx(xe,{className:"text-foreground",children:"Alarm Tags"}),r.jsx(xr,{children:"Telemetry tags with threshold monitoring enabled"})]}),r.jsx(ie,{children:u!=null&&u.alarm_tags&&u.alarm_tags.length>0?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u.alarm_tags.map(S=>{var k,N,D;return r.jsxs("div",{className:"p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("div",{className:"font-medium text-foreground",children:S.tag_name}),r.jsx(We,{variant:"outline",children:S.data_type})]}),r.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:((k=S.scheme)==null?void 0:k.name)||((N=S.asset)==null?void 0:N.name)||((D=S.facility)==null?void 0:D.name)}),S.unit&&r.jsxs("div",{className:"text-xs text-muted-foreground mb-1",children:["Unit: ",S.unit]}),S.thresholds&&r.jsxs("div",{className:"text-xs text-muted-foreground",children:["Thresholds: ",Object.entries(S.thresholds).map(([O,T])=>`${O}: ${T}`).join(", ")]})]},S.id)})}):r.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No alarm tags configured"})})]})]})]})}function $ze(){const[e,t]=R.useState("nodes"),[n,s]=R.useState(""),{data:i,isLoading:c}=ht({queryKey:["topology-nodes",n],queryFn:()=>rs.topology.getNodes({node_type:n||void 0,per_page:50}),enabled:e==="nodes"}),{data:u,isLoading:a}=ht({queryKey:["topology-edges"],queryFn:()=>rs.topology.getEdges({per_page:50}),enabled:e==="edges"}),m=p=>({source:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",reservoir:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",treatment:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",pump_station:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",junction:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",customer:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",prv:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",valve:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300",meter:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-300"})[p]||"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";return r.jsxs("div",{className:"container mx-auto p-6 space-y-6 bg-background",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Network Topology"}),r.jsx("p",{className:"text-muted-foreground",children:"Visualize and manage water network infrastructure"})]}),r.jsxs(se,{children:[r.jsx(Yre,{className:"mr-2 h-4 w-4"}),"Add Node"]})]}),r.jsxs(qs,{value:e,onValueChange:p=>t(p),children:[r.jsxs(As,{className:"bg-muted",children:[r.jsx(sr,{value:"nodes",children:"Nodes"}),r.jsx(sr,{value:"edges",children:"Edges"})]}),r.jsxs(Nr,{value:"nodes",className:"mt-6 space-y-4",children:[r.jsxs(J,{className:"bg-card text-card-foreground",children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-foreground",children:"Filters"})}),r.jsx(ie,{children:r.jsxs("div",{className:"flex gap-4 items-end",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Node Type"}),r.jsx(Ge,{placeholder:"Filter by type (source, reservoir, pump_station, etc.)",value:n,onChange:p=>s(p.target.value),className:"bg-background text-foreground"})]}),r.jsx(se,{variant:"outline",onClick:()=>s(""),children:"Reset"})]})})]}),c?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading network nodes..."})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i==null?void 0:i.data.map(p=>r.jsxs(J,{className:"bg-card text-card-foreground hover:shadow-md transition-shadow",children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(vT,{className:"h-4 w-4"}),r.jsxs("div",{children:[r.jsx(xe,{className:"text-base text-foreground",children:p.name}),r.jsx(xr,{className:"mt-1",children:p.code})]})]}),r.jsx(We,{className:m(p.node_type),children:p.node_type.replace("_"," ")})]})}),r.jsx(ie,{children:p.attributes&&Object.keys(p.attributes).length>0&&r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"text-xs font-medium text-foreground",children:"Attributes"}),r.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs",children:Object.entries(p.attributes).slice(0,4).map(([y,v])=>r.jsxs("div",{className:"flex flex-col",children:[r.jsxs("span",{className:"text-muted-foreground capitalize",children:[y,":"]}),r.jsx("span",{className:"font-medium text-foreground truncate",children:String(v)})]},y))})]})})]},p.id))}),(i==null?void 0:i.data.length)===0&&r.jsx(J,{className:"bg-card text-card-foreground",children:r.jsxs(ie,{className:"flex flex-col items-center justify-center p-12",children:[r.jsx(vT,{className:"h-12 w-12 text-muted-foreground mb-4"}),r.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No network nodes found"}),r.jsx(se,{children:"Add First Node"})]})})]})]}),r.jsx(Nr,{value:"edges",className:"mt-6",children:a?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading network edges..."})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"space-y-4",children:u==null?void 0:u.data.map(p=>r.jsxs(J,{className:"bg-card text-card-foreground hover:shadow-md transition-shadow",children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(lS,{className:"h-4 w-4"}),r.jsxs("div",{children:[r.jsx(xe,{className:"text-base text-foreground",children:p.code||`Edge ${p.id.slice(0,8)}`}),r.jsx(xr,{className:"mt-1 capitalize",children:p.edge_type.replace("_"," ")})]})]}),r.jsx(We,{variant:"outline",children:p.edge_type})]})}),r.jsx(ie,{children:r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[p.diameter_mm&&r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"Diameter"}),r.jsxs("div",{className:"font-medium text-foreground",children:[p.diameter_mm," mm"]})]}),p.length_m&&r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"Length"}),r.jsxs("div",{className:"font-medium text-foreground",children:[p.length_m.toLocaleString()," m"]})]}),p.material&&r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"Material"}),r.jsx("div",{className:"font-medium text-foreground capitalize",children:p.material})]})]})})]},p.id))}),(u==null?void 0:u.data.length)===0&&r.jsx(J,{className:"bg-card text-card-foreground",children:r.jsxs(ie,{className:"flex flex-col items-center justify-center p-12",children:[r.jsx(lS,{className:"h-12 w-12 text-muted-foreground mb-4"}),r.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No network edges found"}),r.jsx(se,{children:"Add First Edge"})]})})]})})]})]})}function Bze(){const[e,t]=R.useState({category:"",enabled:!0}),[n,s]=R.useState(!1),[i,c]=R.useState(!1),[u,a]=R.useState(null),[m,p]=R.useState({tag_name:"",data_type:"float",unit:"",category:"",enabled:!0,thresholds:{}}),y=br(),{data:v,isLoading:j,error:S}=ht({queryKey:["telemetry-tags",e],queryFn:()=>rs.telemetry.getTags({...e,per_page:50})}),k=jt({mutationFn:V=>rs.telemetry.createTag(V),onSuccess:()=>{y.invalidateQueries({queryKey:["telemetry-tags"]}),s(!1),p({tag_name:"",data_type:"float",unit:"",category:"",enabled:!0,thresholds:{}}),qe.success("Telemetry tag created successfully")},onError:V=>{var K,te;qe.error(((te=(K=V.response)==null?void 0:K.data)==null?void 0:te.message)||"Failed to create telemetry tag")}}),N=jt({mutationFn:V=>{if(!u)throw new Error("No tag selected");return rs.telemetry.updateTag(u.id,V)},onSuccess:()=>{y.invalidateQueries({queryKey:["telemetry-tags"]}),c(!1),a(null),qe.success("Telemetry tag updated successfully")},onError:V=>{var K,te;qe.error(((te=(K=V.response)==null?void 0:K.data)==null?void 0:te.message)||"Failed to update telemetry tag")}}),D=jt({mutationFn:V=>rs.telemetry.updateTag(V.id,{enabled:!V.enabled}),onSuccess:()=>{y.invalidateQueries({queryKey:["telemetry-tags"]}),qe.success("Tag status updated")},onError:V=>{var K,te;qe.error(((te=(K=V.response)==null?void 0:K.data)==null?void 0:te.message)||"Failed to update tag status")}}),O=V=>{if(V.preventDefault(),!m.tag_name||!m.data_type){qe.error("Tag name and data type are required");return}k.mutate(m)},T=V=>{a(V),p({tag_name:V.tag_name,data_type:V.data_type,unit:V.unit||"",category:V.category||"",enabled:V.enabled,thresholds:V.thresholds||{}}),c(!0)},I=V=>{if(V.preventDefault(),!m.tag_name||!m.data_type){qe.error("Tag name and data type are required");return}N.mutate(m)},z=V=>{switch(V){case"float":case"int":return r.jsx($s,{className:"h-4 w-4"});case"bool":return r.jsx(os,{className:"h-4 w-4"});default:return r.jsx(Wo,{className:"h-4 w-4"})}},$=V=>V.thresholds&&Object.keys(V.thresholds).length>0;return r.jsxs("div",{className:"container mx-auto p-6 space-y-6 bg-background",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Telemetry & SCADA"}),r.jsx("p",{className:"text-muted-foreground",children:"Real-time monitoring and data acquisition"})]}),r.jsxs(Rr,{open:n,onOpenChange:s,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{children:[r.jsx(ir,{className:"mr-2 h-4 w-4"}),"Create Tag"]})}),r.jsxs(Er,{className:"max-w-2xl",children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:"Create New Telemetry Tag"}),r.jsx(Bs,{children:"Add a new telemetry tag for SCADA monitoring"})]}),r.jsxs("form",{onSubmit:O,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"tag_name",children:"Tag Name*"}),r.jsx(Ge,{id:"tag_name",placeholder:"e.g. Pump_01_Pressure",value:m.tag_name,onChange:V=>p({...m,tag_name:V.target.value}),required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"data_type",children:"Data Type*"}),r.jsxs(Jt,{value:m.data_type,onValueChange:V=>p({...m,data_type:V}),children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"float",children:"Float"}),r.jsx(ke,{value:"int",children:"Integer"}),r.jsx(ke,{value:"bool",children:"Boolean"}),r.jsx(ke,{value:"string",children:"String"})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"unit",children:"Unit"}),r.jsx(Ge,{id:"unit",placeholder:"e.g. bar, m/h, C",value:m.unit,onChange:V=>p({...m,unit:V.target.value})})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"category",children:"Category"}),r.jsx(Ge,{id:"category",placeholder:"e.g. pressure, flow, temperature",value:m.category,onChange:V=>p({...m,category:V.target.value})})]})]}),r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[r.jsx(Ne,{className:"cursor-pointer",children:"Enable this tag"}),r.jsx("input",{type:"checkbox",checked:m.enabled,onChange:V=>p({...m,enabled:V.target.checked}),className:"h-4 w-4"})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:k.isPending,children:k.isPending?"Creating...":"Create Tag"})]})]})]})]})]}),r.jsxs(J,{className:"bg-card text-card-foreground",children:[r.jsx(ge,{children:r.jsx(xe,{className:"text-foreground",children:"Filters"})}),r.jsx(ie,{children:r.jsxs("div",{className:"flex gap-4 items-end",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Category"}),r.jsx(Ge,{placeholder:"Filter by category...",value:e.category,onChange:V=>t({...e,category:V.target.value}),className:"bg-background text-foreground"})]}),r.jsxs("div",{className:"w-48",children:[r.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Status"}),r.jsxs(Jt,{value:e.enabled?"enabled":"all",onValueChange:V=>t({...e,enabled:V==="enabled"}),children:[r.jsx(Yt,{className:"bg-background text-foreground",children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Tags"}),r.jsx(ke,{value:"enabled",children:"Enabled Only"})]})]})]}),r.jsx(se,{variant:"outline",onClick:()=>t({category:"",enabled:!0}),children:"Reset"})]})})]}),j&&!v?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading telemetry tags..."})}):S?r.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:r.jsxs("p",{className:"text-lg text-destructive",children:["Error loading telemetry: ",S.message]})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v==null?void 0:v.data.map(V=>{var K,te,X;return r.jsxs(J,{className:`bg-card text-card-foreground ${V.enabled?"":"opacity-60"}`,children:[r.jsxs(ge,{children:[r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[z(V.data_type),r.jsx(xe,{className:"text-base text-foreground",children:V.tag_name})]}),r.jsxs("div",{className:"flex gap-1",children:[$(V)&&r.jsxs(We,{variant:"outline",className:"text-xs",children:[r.jsx(gn,{className:"h-3 w-3 mr-1"}),"Alarms"]}),!V.enabled&&r.jsx(We,{variant:"secondary",className:"text-xs",children:"Disabled"})]})]}),r.jsx(xr,{children:((K=V.scheme)==null?void 0:K.name)||((te=V.asset)==null?void 0:te.name)||((X=V.facility)==null?void 0:X.name)||"Unassigned"})]}),r.jsxs(ie,{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-muted-foreground",children:"Type:"}),r.jsx(We,{variant:"outline",children:V.data_type})]}),V.unit&&r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-muted-foreground",children:"Unit:"}),r.jsx("span",{className:"font-medium text-foreground",children:V.unit})]}),V.category&&r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-muted-foreground",children:"Category:"}),r.jsx("span",{className:"font-medium text-foreground",children:V.category})]}),V.thresholds&&Object.keys(V.thresholds).length>0&&r.jsxs("div",{className:"mt-4 pt-4 border-t",children:[r.jsx("div",{className:"text-xs font-medium text-foreground mb-2",children:"Thresholds"}),r.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs",children:Object.entries(V.thresholds).map(([ve,ae])=>r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{className:"text-muted-foreground capitalize",children:[ve.replace("_"," "),":"]}),r.jsx("span",{className:"font-medium text-foreground",children:ae})]},ve))})]})]}),r.jsxs("div",{className:"flex gap-2 pt-2 border-t",children:[r.jsxs(se,{variant:"ghost",size:"sm",onClick:()=>T(V),className:"flex-1",children:[r.jsx(DO,{className:"h-3 w-3 mr-1"}),"Edit"]}),r.jsxs(se,{variant:"ghost",size:"sm",onClick:()=>D.mutate(V),disabled:D.isPending,className:"flex-1",children:[r.jsx(Ax,{className:"h-3 w-3 mr-1"}),V.enabled?"Disable":"Enable"]})]})]})]},V.id)})}),(v==null?void 0:v.data.length)===0&&r.jsx(J,{className:"bg-card text-card-foreground",children:r.jsxs(ie,{className:"flex flex-col items-center justify-center p-12",children:[r.jsx(Wo,{className:"h-12 w-12 text-muted-foreground mb-4"}),r.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No telemetry tags found"})]})})]}),r.jsx(Rr,{open:i,onOpenChange:c,children:r.jsxs(Er,{className:"max-w-2xl",children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:"Edit Telemetry Tag"}),r.jsx(Bs,{children:"Update telemetry tag configuration"})]}),u&&r.jsxs("form",{onSubmit:I,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"edit_tag_name",children:"Tag Name*"}),r.jsx(Ge,{id:"edit_tag_name",placeholder:"e.g. Pump_01_Pressure",value:m.tag_name,onChange:V=>p({...m,tag_name:V.target.value}),required:!0})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"edit_data_type",children:"Data Type*"}),r.jsxs(Jt,{value:m.data_type,onValueChange:V=>p({...m,data_type:V}),children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"float",children:"Float"}),r.jsx(ke,{value:"int",children:"Integer"}),r.jsx(ke,{value:"bool",children:"Boolean"}),r.jsx(ke,{value:"string",children:"String"})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"edit_unit",children:"Unit"}),r.jsx(Ge,{id:"edit_unit",placeholder:"e.g. bar, m/h, C",value:m.unit,onChange:V=>p({...m,unit:V.target.value})})]}),r.jsxs("div",{children:[r.jsx(Ne,{htmlFor:"edit_category",children:"Category"}),r.jsx(Ge,{id:"edit_category",placeholder:"e.g. pressure, flow, temperature",value:m.category,onChange:V=>p({...m,category:V.target.value})})]})]}),r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[r.jsx(Ne,{className:"cursor-pointer",children:"Enable this tag"}),r.jsx("input",{type:"checkbox",checked:m.enabled,onChange:V=>p({...m,enabled:V.target.checked}),className:"h-4 w-4"})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[r.jsx(se,{type:"button",variant:"outline",onClick:()=>c(!1),children:"Cancel"}),r.jsx(se,{type:"submit",disabled:N.isPending,children:N.isPending?"Updating...":"Update Tag"})]})]})]})})]})}function qze(){const[e,t]=R.useState("active"),{data:n,isLoading:s,error:i}=ht({queryKey:["outages",e],queryFn:()=>rs.outages.getAll({active:e==="active"?!0:void 0,state:e==="draft"?"draft":e==="closed"?"closed":void 0,per_page:50})}),c=a=>{switch(a){case"live":return"destructive";case"approved":return"default";case"draft":return"secondary";case"restored":return"outline";case"closed":return"outline";default:return"outline"}},u=a=>{switch(a){case"planned":return r.jsx(va,{className:"h-4 w-4"});case"fault":return r.jsx(gn,{className:"h-4 w-4"});case"power":return r.jsx(gn,{className:"h-4 w-4"});case"water_quality":return r.jsx(gn,{className:"h-4 w-4"});default:return r.jsx(xs,{className:"h-4 w-4"})}};return r.jsxs("div",{className:"container mx-auto p-6 space-y-6 bg-background",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Outage Management"}),r.jsx("p",{className:"text-muted-foreground",children:"Plan and track water supply interruptions"})]}),r.jsxs(se,{children:[r.jsx(va,{className:"mr-2 h-4 w-4"}),"Schedule Outage"]})]}),r.jsxs(qs,{value:e,onValueChange:a=>t(a),children:[r.jsxs(As,{className:"bg-muted",children:[r.jsx(sr,{value:"active",children:"Active"}),r.jsx(sr,{value:"draft",children:"Draft"}),r.jsx(sr,{value:"all",children:"All"}),r.jsx(sr,{value:"closed",children:"Closed"})]}),r.jsx(Nr,{value:e,className:"mt-6",children:s&&!n?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading outages..."})}):i?r.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:r.jsxs("p",{className:"text-lg text-destructive",children:["Error loading outages: ",i.message]})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"space-y-4",children:n==null?void 0:n.data.map(a=>{var m,p;return r.jsxs(J,{className:"bg-card text-card-foreground hover:shadow-md transition-shadow",children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[u(a.cause),r.jsxs("div",{children:[r.jsxs(xe,{className:"text-foreground",children:[((m=a.scheme)==null?void 0:m.name)||"Unknown Scheme",a.code&&r.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",a.code,")"]})]}),r.jsx(xr,{className:"mt-1",children:((p=a.dma)==null?void 0:p.name)&&`DMA: ${a.dma.name}`})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(We,{variant:c(a.state),className:"capitalize",children:a.state}),r.jsx(We,{variant:"outline",className:"capitalize",children:a.cause})]})]})}),r.jsxs(ie,{className:"space-y-4",children:[a.summary&&r.jsx("p",{className:"text-sm text-muted-foreground",children:a.summary}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(xs,{className:"h-4 w-4 text-muted-foreground"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"Start Time"}),r.jsx("div",{className:"font-medium text-foreground",children:mn(new Date(a.starts_at),"PPp")})]})]}),a.ends_at&&r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(xs,{className:"h-4 w-4 text-muted-foreground"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"End Time"}),r.jsx("div",{className:"font-medium text-foreground",children:mn(new Date(a.ends_at),"PPp")})]})]}),a.estimated_customers_affected&&r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(Pi,{className:"h-4 w-4 text-muted-foreground"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"Est. Customers"}),r.jsx("div",{className:"font-medium text-foreground",children:a.estimated_customers_affected.toLocaleString()})]})]}),a.actual_restored_at&&r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(os,{className:"h-4 w-4 text-green-600"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"Restored At"}),r.jsx("div",{className:"font-medium text-foreground",children:mn(new Date(a.actual_restored_at),"PPp")})]})]})]}),a.audits&&a.audits.length>0&&r.jsxs("div",{className:"mt-4 pt-4 border-t",children:[r.jsx("div",{className:"text-xs font-medium text-foreground mb-2",children:"Recent Activity"}),r.jsx("div",{className:"space-y-1",children:a.audits.slice(0,3).map(y=>r.jsxs("div",{className:"text-xs text-muted-foreground",children:[y.event," - ",mn(new Date(y.created_at),"PPp")]},y.id))})]})]})]},a.id)})}),(n==null?void 0:n.data.length)===0&&r.jsx(J,{className:"bg-card text-card-foreground",children:r.jsxs(ie,{className:"flex flex-col items-center justify-center p-12",children:[r.jsx(gn,{className:"h-12 w-12 text-muted-foreground mb-4"}),r.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No outages found"}),r.jsxs(se,{children:[r.jsx(va,{className:"mr-2 h-4 w-4"}),"Schedule First Outage"]})]})})]})})]})]})}function Vze(){const[e,t]=R.useState("snapshots"),{data:n,isLoading:s}=ht({queryKey:["nrw-snapshots"],queryFn:()=>rs.nrw.getSnapshots({per_page:50}),enabled:e==="snapshots"}),{data:i,isLoading:c}=ht({queryKey:["nrw-interventions"],queryFn:()=>rs.nrw.getInterventions({per_page:50}),enabled:e==="interventions"}),u=m=>m<15?"text-green-600":m<25?"text-yellow-600":m<35?"text-orange-600":"text-red-600",a=m=>{switch(m){case"leak_repair":return r.jsx(Fm,{className:"h-4 w-4"});case"meter_replacement":return r.jsx(Gc,{className:"h-4 w-4"});default:return r.jsx(eo,{className:"h-4 w-4"})}};return r.jsxs("div",{className:"container mx-auto p-6 space-y-6 bg-background",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"NRW & Water Balance"}),r.jsx("p",{className:"text-muted-foreground",children:"Non-Revenue Water monitoring and intervention tracking"})]}),r.jsxs(se,{children:[r.jsx(Gc,{className:"mr-2 h-4 w-4"}),"Record Snapshot"]})]}),r.jsxs(qs,{value:e,onValueChange:m=>t(m),children:[r.jsxs(As,{className:"bg-muted",children:[r.jsx(sr,{value:"snapshots",children:"NRW Snapshots"}),r.jsx(sr,{value:"interventions",children:"Interventions"})]}),r.jsx(Nr,{value:"snapshots",className:"mt-6",children:s?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading NRW snapshots..."})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n==null?void 0:n.data.map(m=>{var p;return r.jsxs(J,{className:"bg-card text-card-foreground hover:shadow-md transition-shadow",children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{children:[r.jsx(xe,{className:"text-base text-foreground",children:((p=m.dma)==null?void 0:p.name)||"Unknown DMA"}),r.jsx(xr,{children:mn(new Date(m.as_of),"PPP")})]}),r.jsxs("div",{className:`text-2xl font-bold ${u(m.nrw_pct)}`,children:[m.nrw_pct.toFixed(1),"%"]})]})}),r.jsxs(ie,{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"System Input"}),r.jsxs("div",{className:"font-medium text-foreground",children:[m.system_input_volume_m3.toLocaleString()," m"]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"NRW Volume"}),r.jsxs("div",{className:"font-medium text-foreground",children:[m.nrw_m3.toLocaleString()," m"]})]})]}),r.jsxs("div",{className:"pt-3 border-t space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-xs",children:[r.jsx("span",{className:"text-muted-foreground",children:"Billed Authorized:"}),r.jsxs("span",{className:"font-medium text-foreground",children:[m.billed_authorized_m3.toLocaleString()," m"]})]}),m.unbilled_authorized_m3&&m.unbilled_authorized_m3>0&&r.jsxs("div",{className:"flex justify-between text-xs",children:[r.jsx("span",{className:"text-muted-foreground",children:"Unbilled Authorized:"}),r.jsxs("span",{className:"font-medium text-foreground",children:[m.unbilled_authorized_m3.toLocaleString()," m"]})]}),m.apparent_losses_m3&&m.apparent_losses_m3>0&&r.jsxs("div",{className:"flex justify-between text-xs",children:[r.jsx("span",{className:"text-muted-foreground",children:"Apparent Losses:"}),r.jsxs("span",{className:"font-medium text-foreground",children:[m.apparent_losses_m3.toLocaleString()," m"]})]}),m.real_losses_m3&&m.real_losses_m3>0&&r.jsxs("div",{className:"flex justify-between text-xs",children:[r.jsx("span",{className:"text-muted-foreground",children:"Real Losses:"}),r.jsxs("span",{className:"font-medium text-foreground",children:[m.real_losses_m3.toLocaleString()," m"]})]})]})]})]},m.id)})}),(n==null?void 0:n.data.length)===0&&r.jsx(J,{className:"bg-card text-card-foreground",children:r.jsxs(ie,{className:"flex flex-col items-center justify-center p-12",children:[r.jsx(Gc,{className:"h-12 w-12 text-muted-foreground mb-4"}),r.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No NRW snapshots recorded"}),r.jsx(se,{children:"Record First Snapshot"})]})})]})}),r.jsx(Nr,{value:"interventions",className:"mt-6",children:c?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading interventions..."})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"space-y-4",children:i==null?void 0:i.data.map(m=>{var p,y;return r.jsxs(J,{className:"bg-card text-card-foreground hover:shadow-md transition-shadow",children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[a(m.type),r.jsxs("div",{children:[r.jsx(xe,{className:"text-base text-foreground capitalize",children:m.type.replace("_"," ")}),r.jsx(xr,{children:((p=m.dma)==null?void 0:p.name)||((y=m.asset)==null?void 0:y.name)||"General"})]})]}),r.jsx(We,{variant:"outline",children:mn(new Date(m.date),"PP")})]})}),r.jsxs(ie,{children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[m.estimated_savings_m3d&&r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(eo,{className:"h-4 w-4 text-green-600"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"Est. Savings"}),r.jsxs("div",{className:"font-medium text-foreground",children:[m.estimated_savings_m3d.toLocaleString()," m/day"]})]})]}),m.cost&&r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Za,{className:"h-4 w-4 text-muted-foreground"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"Cost"}),r.jsxs("div",{className:"font-medium text-foreground",children:["$",m.cost.toLocaleString()]})]})]}),m.responsible&&r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"Responsible"}),r.jsx("div",{className:"font-medium text-foreground",children:m.responsible})]})]}),m.notes&&r.jsx("div",{className:"mt-4 pt-4 border-t",children:r.jsx("div",{className:"text-xs text-muted-foreground",children:m.notes})})]})]},m.id)})}),(i==null?void 0:i.data.length)===0&&r.jsx(J,{className:"bg-card text-card-foreground",children:r.jsxs(ie,{className:"flex flex-col items-center justify-center p-12",children:[r.jsx(Fm,{className:"h-12 w-12 text-muted-foreground mb-4"}),r.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No interventions recorded"}),r.jsx(se,{children:"Record First Intervention"})]})})]})})]})]})}function Uze(){const[e,t]=R.useState("plans"),{data:n,isLoading:s}=ht({queryKey:["dose-plans"],queryFn:()=>rs.dosing.getPlans({per_page:50}),enabled:e==="plans"}),{data:i,isLoading:c}=ht({queryKey:["chemical-stocks"],queryFn:()=>rs.dosing.getStocks({per_page:50}),enabled:e==="stocks"}),u=a=>a.reorder_level_kg&&a.qty_on_hand_kg<=a.reorder_level_kg;return r.jsxs("div",{className:"container mx-auto p-6 space-y-6 bg-background",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Dosing Control"}),r.jsx("p",{className:"text-muted-foreground",children:"Chemical dosing plans and stock management"})]}),r.jsxs(se,{children:[r.jsx(Gc,{className:"mr-2 h-4 w-4"}),"Create Dose Plan"]})]}),r.jsxs(qs,{value:e,onValueChange:a=>t(a),children:[r.jsxs(As,{className:"bg-muted",children:[r.jsx(sr,{value:"plans",children:"Dosing Plans"}),r.jsx(sr,{value:"stocks",children:"Chemical Stock"})]}),r.jsx(Nr,{value:"plans",className:"mt-6",children:s?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading dosing plans..."})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n==null?void 0:n.data.map(a=>{var m,p,y;return r.jsxs(J,{className:`bg-card text-card-foreground ${a.active?"":"opacity-60"}`,children:[r.jsxs(ge,{children:[r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Gc,{className:"h-4 w-4 text-primary"}),r.jsx(xe,{className:"text-base text-foreground",children:((m=a.asset)==null?void 0:m.name)||((p=a.asset)==null?void 0:p.code)||"Unknown Asset"})]}),r.jsx(We,{variant:a.active?"default":"secondary",children:a.active?"Active":"Inactive"})]}),r.jsx(xr,{children:(y=a.scheme)==null?void 0:y.name})]}),r.jsxs(ie,{className:"space-y-3",children:[a.chemical&&r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-muted-foreground",children:"Chemical:"}),r.jsx("span",{className:"font-medium text-foreground",children:a.chemical})]}),a.flow_bands&&r.jsxs("div",{className:"mt-3 pt-3 border-t",children:[r.jsx("div",{className:"text-xs font-medium text-foreground mb-2",children:"Flow Bands"}),r.jsxs("div",{className:"text-xs text-muted-foreground",children:[Object.keys(a.flow_bands).length," band(s) configured"]})]}),a.thresholds&&r.jsxs("div",{className:"mt-3 pt-3 border-t",children:[r.jsx("div",{className:"text-xs font-medium text-foreground mb-2",children:"Thresholds"}),r.jsxs("div",{className:"text-xs text-muted-foreground",children:[Object.keys(a.thresholds).length," threshold(s) configured"]})]})]})]},a.id)})}),(n==null?void 0:n.data.length)===0&&r.jsx(J,{className:"bg-card text-card-foreground",children:r.jsxs(ie,{className:"flex flex-col items-center justify-center p-12",children:[r.jsx(Gc,{className:"h-12 w-12 text-muted-foreground mb-4"}),r.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No dosing plans configured"}),r.jsx(se,{children:"Create First Dosing Plan"})]})})]})}),r.jsx(Nr,{value:"stocks",className:"mt-6",children:c?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading chemical stock..."})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"space-y-4",children:i==null?void 0:i.data.map(a=>{var m,p;return r.jsxs(J,{className:"bg-card text-card-foreground",children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(Kc,{className:"h-4 w-4"}),r.jsxs("div",{children:[r.jsx(xe,{className:"text-base text-foreground",children:a.chemical}),r.jsxs(xr,{children:[(m=a.scheme)==null?void 0:m.name,((p=a.facility)==null?void 0:p.name)&&` - ${a.facility.name}`]})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"As of"}),r.jsx("div",{className:"text-sm font-medium text-foreground",children:mn(new Date(a.as_of),"PP")})]})]})}),r.jsxs(ie,{children:[u(a)&&r.jsxs(Wi,{variant:"destructive",className:"mb-4",children:[r.jsx(gn,{className:"h-4 w-4"}),r.jsx(ki,{children:"Stock level is at or below reorder point"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Quantity on Hand"}),r.jsxs("div",{className:`text-2xl font-bold ${u(a)?"text-red-600":"text-foreground"}`,children:[a.qty_on_hand_kg.toLocaleString()," kg"]})]}),a.reorder_level_kg&&r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Reorder Level"}),r.jsxs("div",{className:"text-2xl font-bold text-muted-foreground",children:[a.reorder_level_kg.toLocaleString()," kg"]})]})]})]})]},a.id)})}),(i==null?void 0:i.data.length)===0&&r.jsx(J,{className:"bg-card text-card-foreground",children:r.jsxs(ie,{className:"flex flex-col items-center justify-center p-12",children:[r.jsx(Kc,{className:"h-12 w-12 text-muted-foreground mb-4"}),r.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No chemical stock records"}),r.jsx(se,{children:"Record Stock Level"})]})})]})})]})]})}function Wze(){const[e,t]=R.useState("calendar"),[n,s]=R.useState("all"),[i,c]=R.useState(qm(new Date,{weekStartsOn:1})),[u,a]=R.useState(!1),[m,p]=R.useState(mn(new Date,"yyyy-MM-dd")),[y,v]=R.useState(mn(M1(new Date,7),"yyyy-MM-dd")),[j,S]=R.useState(null),k=br(),{data:N,isLoading:D,error:O}=ht({queryKey:["pump-schedules",n],queryFn:()=>rs.scheduling.getSchedules({status:n!=="all"?n:void 0,per_page:100})}),T=jt({mutationFn:async X=>{const ve=await fetch("/api/v1/pump-schedules/optimize",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(X)});return ve.ok?ve.json():{schedules:Gze(X.start_date,X.end_date),estimated_savings:1250.5,peak_hours_avoided:18}},onSuccess:X=>{S(X),qe.success(`Optimization complete! Estimated savings: $${X.estimated_savings.toFixed(2)}`)},onError:()=>{qe.error("Optimization failed")}}),I=jt({mutationFn:async()=>{if(!j)return;const X=await fetch("/api/v1/pump-schedules/batch",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({schedules:j.schedules})});if(!X.ok)throw new Error("Failed to apply schedules");return X.json()},onSuccess:()=>{k.invalidateQueries({queryKey:["pump-schedules"]}),a(!1),S(null),qe.success("Optimized schedules applied successfully")},onError:()=>{qe.error("Failed to apply optimized schedules")}}),z=Loe({start:i,end:zoe(i,{weekStartsOn:1})}),$=X=>{switch(X){case"running":return"default";case"scheduled":return"secondary";case"completed":return"outline";case"cancelled":return"destructive";default:return"outline"}},V=X=>X?r.jsx(We,{variant:X==="optimizer"?"default":"outline",className:"text-xs",children:X==="optimizer"?r.jsxs(r.Fragment,{children:[r.jsx(bo,{className:"h-3 w-3 mr-1"}),"Optimized"]}):"Manual"}):null,K=X=>N!=null&&N.data?N.data.filter(ve=>{const ae=Mx(oh(ve.start_at));return O3(ae,Mx(X))}):[],te=()=>{T.mutate({start_date:m,end_date:y})};return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Pump Scheduling"}),r.jsx("p",{className:"text-muted-foreground",children:"Optimize and manage pump operations to minimize energy costs"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(Rr,{open:u,onOpenChange:a,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{children:[r.jsx(bo,{className:"mr-2 h-4 w-4"}),"Optimize Schedule"]})}),r.jsxs(Er,{className:"sm:max-w-[500px]",children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:"Optimize Pump Schedule"}),r.jsx(Bs,{children:"Generate an optimized pumping schedule to minimize peak tariff usage while maintaining storage constraints"})]}),r.jsxs("div",{className:"space-y-4 mt-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{children:"Start Date"}),r.jsx(Ge,{type:"date",value:m,onChange:X=>p(X.target.value)})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"End Date"}),r.jsx(Ge,{type:"date",value:y,onChange:X=>v(X.target.value)})]}),r.jsx(se,{onClick:te,className:"w-full",disabled:T.isPending,children:T.isPending?"Optimizing...":"Run Optimization"}),j&&r.jsxs(J,{className:"border-green-500 bg-green-50 dark:bg-green-950/20",children:[r.jsx(ge,{className:"pb-3",children:r.jsx(xe,{className:"text-base",children:"Optimization Results"})}),r.jsxs(ie,{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Estimated Savings"}),r.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",j.estimated_savings.toFixed(2)]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Peak Hours Avoided"}),r.jsxs("div",{className:"text-2xl font-bold",children:[j.peak_hours_avoided,"h"]})]})]}),r.jsxs("div",{className:"border-t pt-3",children:[r.jsx("div",{className:"text-sm font-medium mb-2",children:"Proposed Schedule Blocks"}),r.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:j.schedules.map((X,ve)=>{var ae;return r.jsxs("div",{className:"text-xs p-2 rounded bg-background border",children:[r.jsx("div",{className:"font-medium",children:((ae=X.asset)==null?void 0:ae.name)||"Pump"}),r.jsxs("div",{className:"text-muted-foreground",children:[mn(oh(X.start_at),"MMM d, HH:mm"),"  ",mn(oh(X.end_at),"HH:mm")]})]},ve)})})]}),r.jsx(se,{onClick:()=>I.mutate(),className:"w-full",disabled:I.isPending,children:I.isPending?"Applying...":"Apply Optimization"})]})]})]})]})]}),r.jsxs(se,{variant:"outline",children:[r.jsx(va,{className:"mr-2 h-4 w-4"}),"Create Schedule"]})]})]}),r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:r.jsxs("div",{className:"flex gap-4 items-end",children:[r.jsxs("div",{className:"w-48",children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Status Filter"}),r.jsxs(Jt,{value:n,onValueChange:s,children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Schedules"}),r.jsx(ke,{value:"scheduled",children:"Scheduled"}),r.jsx(ke,{value:"running",children:"Running"}),r.jsx(ke,{value:"completed",children:"Completed"}),r.jsx(ke,{value:"cancelled",children:"Cancelled"})]})]})]}),r.jsxs("div",{className:"flex gap-2 ml-auto",children:[r.jsxs(se,{variant:e==="calendar"?"default":"outline",size:"sm",onClick:()=>t("calendar"),children:[r.jsx(va,{className:"h-4 w-4 mr-2"}),"Calendar"]}),r.jsxs(se,{variant:e==="list"?"default":"outline",size:"sm",onClick:()=>t("list"),children:[r.jsx(Zre,{className:"h-4 w-4 mr-2"}),"List"]})]})]})})}),D&&!N?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading pump schedules..."})}):O?r.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:r.jsxs("p",{className:"text-lg text-destructive",children:["Error loading schedules: ",O.message]})}):e==="calendar"?r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx(xe,{children:"Week View"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:"outline",size:"sm",onClick:()=>c(M1(i,-7)),children:"Previous Week"}),r.jsx(se,{variant:"outline",size:"sm",onClick:()=>c(qm(new Date,{weekStartsOn:1})),children:"This Week"}),r.jsx(se,{variant:"outline",size:"sm",onClick:()=>c(M1(i,7)),children:"Next Week"})]})]})}),r.jsx(ie,{children:r.jsx("div",{className:"grid grid-cols-7 gap-2",children:z.map(X=>{const ve=K(X),ae=O3(X,new Date);return r.jsxs("div",{className:`min-h-48 border rounded-lg p-2 ${ae?"border-primary bg-primary/5":"bg-card"}`,children:[r.jsxs("div",{className:"text-sm font-medium mb-2",children:[r.jsx("div",{children:mn(X,"EEE")}),r.jsx("div",{className:`text-2xl ${ae?"text-primary":""}`,children:mn(X,"d")})]}),r.jsx("div",{className:"space-y-1",children:ve.map(pe=>{var Oe;return r.jsxs("div",{className:`text-xs p-2 rounded cursor-pointer transition-colors ${pe.status==="running"?"bg-green-100 dark:bg-green-950 border border-green-500":"bg-blue-50 dark:bg-blue-950/30 border"}`,children:[r.jsx("div",{className:"font-medium truncate",children:((Oe=pe.asset)==null?void 0:Oe.name)||"Pump"}),r.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[r.jsx(xs,{className:"h-3 w-3"}),mn(oh(pe.start_at),"HH:mm")," - ",mn(oh(pe.end_at),"HH:mm")]}),pe.source==="optimizer"&&r.jsxs("div",{className:"flex items-center gap-1 text-green-600 dark:text-green-400 mt-1",children:[r.jsx(bo,{className:"h-3 w-3"}),r.jsx("span",{children:"Optimized"})]})]},pe.id)})})]},X.toString())})})})]}):r.jsxs("div",{className:"space-y-4",children:[N==null?void 0:N.data.map(X=>{var ve,ae,pe;return r.jsxs(J,{className:"hover:shadow-md transition-shadow",children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(Ax,{className:"h-4 w-4"}),r.jsxs("div",{children:[r.jsx(xe,{className:"text-base",children:((ve=X.asset)==null?void 0:ve.name)||((ae=X.asset)==null?void 0:ae.code)||"Unknown Pump"}),r.jsx(xr,{children:(pe=X.scheme)==null?void 0:pe.name})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(We,{variant:$(X.status),className:"capitalize",children:X.status}),V(X.source)]})]})}),r.jsxs(ie,{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Start Time"}),r.jsx("div",{className:"font-medium",children:mn(oh(X.start_at),"PPp")})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"End Time"}),r.jsx("div",{className:"font-medium",children:mn(oh(X.end_at),"PPp")})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t",children:[X.target_volume_m3&&r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx($s,{className:"h-4 w-4 text-muted-foreground"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"Target Volume"}),r.jsxs("div",{className:"font-medium",children:[X.target_volume_m3.toLocaleString()," m"]})]})]}),X.actual_volume_m3&&r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx($s,{className:"h-4 w-4 text-primary"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"Actual Volume"}),r.jsxs("div",{className:"font-medium",children:[X.actual_volume_m3.toLocaleString()," m"]})]})]}),X.energy_cost&&r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Za,{className:"h-4 w-4 text-muted-foreground"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-muted-foreground",children:"Energy Cost"}),r.jsxs("div",{className:"font-medium",children:["$",X.energy_cost.toLocaleString()]})]})]})]}),X.constraints&&Object.keys(X.constraints).length>0&&r.jsxs("div",{className:"pt-4 border-t",children:[r.jsx("div",{className:"text-xs font-medium mb-2",children:"Constraints"}),r.jsxs("div",{className:"text-xs text-muted-foreground",children:[Object.keys(X.constraints).length," constraint(s) applied"]})]})]})]},X.id)}),(N==null?void 0:N.data.length)===0&&r.jsx(J,{children:r.jsxs(ie,{className:"flex flex-col items-center justify-center p-12",children:[r.jsx(Ax,{className:"h-12 w-12 text-muted-foreground mb-4"}),r.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No pump schedules found"}),r.jsxs(se,{children:[r.jsx(va,{className:"mr-2 h-4 w-4"}),"Create First Schedule"]})]})})]})]})}function Gze(e,t){const n=oh(e),s=[];for(let i=0;i<5;i++){const c=M1(n,i);s.push({id:`opt-${i}`,asset:{name:`Pump ${i+1}`,code:`PMP-00${i+1}`},scheme:{name:"Central Treatment Plant"},start_at:`${mn(c,"yyyy-MM-dd")}T02:00:00Z`,end_at:`${mn(c,"yyyy-MM-dd")}T06:00:00Z`,status:"scheduled",source:"optimizer",target_volume_m3:5e3,constraints:{max_storage:1e4}})}return s}function Kze(){const[e,t]=R.useState(""),[n,s]=R.useState("15"),[i,c]=R.useState("40"),[u,a]=R.useState("25"),[m,p]=R.useState(!1),y=br(),{data:v}=ht({queryKey:["dmas"],queryFn:async()=>{const I=await fetch("/api/v1/dmas?per_page=100",{credentials:"include"});if(!I.ok)throw new Error("Failed to fetch DMAs");return(await I.json()).data}}),{data:j}=ht({queryKey:["prv-targets"],queryFn:async()=>{const I=await fetch("/api/v1/prv-targets",{credentials:"include"});return I.ok?I.json():[]}}),{data:S}=ht({queryKey:["leak-suspicions"],queryFn:async()=>{const I=await fetch("/api/v1/leak-suspicions?score_threshold=0.6",{credentials:"include"});return I.ok?I.json():[{id:"1",segment_id:"SEG-001",segment_name:"Main St Pipeline",dma_name:"Central DMA",suspicion_score:.85,pressure_drop_pct:15.2,flow_anomaly_pct:12.5,last_reading:"2025-11-21T08:30:00Z",lat:-1.2921,lng:36.8219},{id:"2",segment_id:"SEG-047",segment_name:"Industrial Zone Feed",dma_name:"East DMA",suspicion_score:.72,pressure_drop_pct:8.3,flow_anomaly_pct:18.7,last_reading:"2025-11-21T08:25:00Z",lat:-1.2835,lng:36.8342},{id:"3",segment_id:"SEG-103",segment_name:"Residential Loop",dma_name:"West DMA",suspicion_score:.68,pressure_drop_pct:11.1,flow_anomaly_pct:9.4,last_reading:"2025-11-21T08:20:00Z",lat:-1.2987,lng:36.8105}]}}),k=jt({mutationFn:async I=>{const z=await fetch("/api/v1/prv-targets",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(I)});if(!z.ok)throw new Error("Failed to save PRV target");return z.json()},onSuccess:()=>{y.invalidateQueries({queryKey:["prv-targets"]}),p(!1),qe.success("PRV target saved successfully"),t(""),s("15"),c("40"),a("25")},onError:()=>{qe.error("Failed to save PRV target")}}),N=jt({mutationFn:async I=>{const z=S==null?void 0:S.find(V=>V.id===I),$=await fetch("/api/v1/work-orders",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({title:`Leak Investigation - ${z==null?void 0:z.segment_name}`,description:`High leak suspicion detected (score: ${z==null?void 0:z.suspicion_score}).
Pressure drop: ${z==null?void 0:z.pressure_drop_pct}%
Flow anomaly: ${z==null?void 0:z.flow_anomaly_pct}%`,priority:z&&z.suspicion_score>.8?"high":"medium",kind:"corrective",asset_ids:[]})});if(!$.ok)throw new Error("Failed to create work order");return $.json()},onSuccess:()=>{qe.success("Work order created successfully")},onError:()=>{qe.error("Failed to create work order")}}),D=()=>{if(!e||!n||!i||!u){qe.error("Please fill all fields");return}k.mutate({dma_id:e,min_pressure_m:parseFloat(n),max_pressure_m:parseFloat(i),prv_setpoint_m:parseFloat(u)})},O=I=>I>=.8?"#ef4444":I>=.7?"#f59e0b":"#eab308",T={type:"FeatureCollection",features:(S||[]).map(I=>({type:"Feature",geometry:{type:"Point",coordinates:[I.lng,I.lat]},properties:{score:I.suspicion_score}}))};return r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Pressure & Leak Management"}),r.jsx("p",{className:"text-muted-foreground",children:"Monitor pressure targets and detect potential leaks using ML-based analysis"})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs(J,{className:"lg:col-span-1",children:[r.jsxs(ge,{children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(ai,{className:"h-5 w-5"}),"PRV Pressure Targets"]}),r.jsx(xr,{children:"Configure pressure reducing valve setpoints by DMA"})]}),r.jsxs(ie,{children:[r.jsxs(Rr,{open:m,onOpenChange:p,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{className:"w-full mb-4",children:[r.jsx(ai,{className:"mr-2 h-4 w-4"}),"Add/Edit Target"]})}),r.jsxs(Er,{children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:"PRV Target Configuration"}),r.jsx(Bs,{children:"Set pressure targets for a District Metered Area"})]}),r.jsxs("div",{className:"space-y-4 mt-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{children:"DMA"}),r.jsxs(Jt,{value:e,onValueChange:t,children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select DMA"})}),r.jsx(Xt,{children:v==null?void 0:v.map(I=>r.jsxs(ke,{value:I.id,children:[I.code," - ",I.name]},I.id))})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Minimum Pressure (m)"}),r.jsx(Ge,{type:"number",value:n,onChange:I=>s(I.target.value),placeholder:"15",step:"0.1"})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Maximum Pressure (m)"}),r.jsx(Ge,{type:"number",value:i,onChange:I=>c(I.target.value),placeholder:"40",step:"0.1"})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"PRV Setpoint (m)"}),r.jsx(Ge,{type:"number",value:u,onChange:I=>a(I.target.value),placeholder:"25",step:"0.1"}),r.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Recommended: ",Math.round((parseFloat(n)+parseFloat(i))/2)," m"]})]}),r.jsx(se,{onClick:D,className:"w-full",disabled:k.isPending,children:k.isPending?"Saving...":"Save Target"})]})]})]}),r.jsx("div",{className:"space-y-3",children:j&&j.length>0?j.map(I=>r.jsxs(J,{className:"p-3",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsx("div",{className:"font-medium text-sm",children:I.dma_name}),r.jsxs(We,{variant:"outline",className:"text-xs",children:["PRV: ",I.prv_setpoint_m,"m"]})]}),r.jsxs("div",{className:"flex gap-4 text-xs text-muted-foreground",children:[r.jsxs("span",{children:["Min: ",I.min_pressure_m,"m"]}),r.jsxs("span",{children:["Max: ",I.max_pressure_m,"m"]})]})]},I.id)):r.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No PRV targets configured"})})]})]}),r.jsxs(J,{className:"lg:col-span-2",children:[r.jsxs(ge,{children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(gn,{className:"h-5 w-5 text-orange-500"}),"Leak Suspicion Heatmap"]}),r.jsx(xr,{children:"ML-based leak detection using pressure and flow anomalies"})]}),r.jsxs(ie,{children:[r.jsx("div",{className:"h-[400px] rounded-lg overflow-hidden border",children:r.jsxs(Ob,{initialViewState:{longitude:36.8219,latitude:-1.2921,zoom:11},style:{width:"100%",height:"100%"},mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",children:[r.jsx(Ib,{position:"top-right"}),r.jsx(Db,{}),r.jsx(T0,{id:"leak-heatmap",type:"geojson",data:T,children:r.jsx(Tx,{id:"leak-points",type:"circle",paint:{"circle-radius":["interpolate",["linear"],["get","score"],.6,10,.9,25],"circle-color":["interpolate",["linear"],["get","score"],.6,"#eab308",.7,"#f59e0b",.8,"#ef4444"],"circle-opacity":.6,"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}})})]})}),r.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-4 h-4 rounded-full bg-yellow-500"}),r.jsx("span",{className:"text-sm",children:"Moderate (0.6-0.7)"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-4 h-4 rounded-full bg-orange-500"}),r.jsx("span",{className:"text-sm",children:"High (0.7-0.8)"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-4 h-4 rounded-full bg-red-500"}),r.jsx("span",{className:"text-sm",children:"Critical (0.8+)"})]})]})]})]})]}),r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"High-Suspicion Segments"}),r.jsx(xr,{children:"Network segments with elevated leak probability requiring investigation"})]}),r.jsx(ie,{children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Segment"}),r.jsx(le,{children:"DMA"}),r.jsx(le,{children:"Suspicion Score"}),r.jsx(le,{children:"Pressure Drop"}),r.jsx(le,{children:"Flow Anomaly"}),r.jsx(le,{children:"Last Reading"}),r.jsx(le,{className:"text-right",children:"Actions"})]})}),r.jsx(ur,{children:S&&S.length>0?S.map(I=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:r.jsxs("div",{children:[r.jsx("div",{children:I.segment_name}),r.jsx("div",{className:"text-xs text-muted-foreground",children:I.segment_id})]})}),r.jsx(ne,{children:I.dma_name}),r.jsx(ne,{children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:O(I.suspicion_score)}}),r.jsxs("span",{className:"font-mono text-sm",children:[(I.suspicion_score*100).toFixed(0),"%"]})]})}),r.jsx(ne,{children:r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(eo,{className:"h-4 w-4 text-red-500"}),r.jsxs("span",{className:"text-sm",children:[I.pressure_drop_pct.toFixed(1),"%"]})]})}),r.jsx(ne,{children:r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx($s,{className:"h-4 w-4 text-orange-500"}),r.jsxs("span",{className:"text-sm",children:[I.flow_anomaly_pct.toFixed(1),"%"]})]})}),r.jsx(ne,{className:"text-sm text-muted-foreground",children:new Date(I.last_reading).toLocaleString()}),r.jsx(ne,{className:"text-right",children:r.jsxs(se,{size:"sm",onClick:()=>N.mutate(I.id),disabled:N.isPending,children:[r.jsx(Fm,{className:"mr-2 h-4 w-4"}),"Create WO"]})})]},I.id)):r.jsx(lt,{children:r.jsx(ne,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No high-suspicion segments detected"})})})]})})]})]})}function Hze(){var v;const e=br(),[t,n]=R.useState(""),[s,i]=R.useState("all"),{data:c,isLoading:u,error:a}=ht({queryKey:["shifts",s],queryFn:()=>rs.shifts.list({status:s==="all"?void 0:s,per_page:50})}),m=jt({mutationFn:j=>rs.shifts.close(j,{}),onSuccess:()=>{e.invalidateQueries({queryKey:["shifts"]})}}),p=((v=c==null?void 0:c.data)==null?void 0:v.filter(j=>{var S,k;return j.name.toLowerCase().includes(t.toLowerCase())||((k=(S=j.facility)==null?void 0:S.name)==null?void 0:k.toLowerCase().includes(t.toLowerCase()))}))||[],y=j=>{switch(j){case"active":return"bg-green-100 text-green-800";case"planned":return"bg-blue-100 text-blue-800";case"closed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Shifts Management"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"24/7 shift scheduling and logbook"})]}),r.jsxs(se,{className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"New Shift"]})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx(Ge,{placeholder:"Search by shift name or facility...",value:t,onChange:j=>n(j.target.value),className:"max-w-sm"}),r.jsx("div",{className:"flex gap-2",children:["all","planned","active","closed"].map(j=>r.jsx(se,{variant:s===j?"default":"outline",onClick:()=>i(j),size:"sm",children:j.charAt(0).toUpperCase()+j.slice(1)},j))})]}),u?r.jsx(J,{children:r.jsx(ie,{className:"p-8 text-center text-muted-foreground",children:"Loading shifts..."})}):a?r.jsxs(Wi,{variant:"destructive",children:[r.jsx(gn,{className:"h-4 w-4"}),r.jsxs(ki,{children:["Error loading shifts: ",a.message]})]}):p.length===0?r.jsx(J,{children:r.jsx(ie,{className:"p-8 text-center text-muted-foreground",children:"No shifts found"})}):r.jsx("div",{className:"grid gap-4",children:p.map(j=>r.jsx(J,{className:"hover:shadow-md transition-shadow",children:r.jsx(ie,{className:"p-6",children:r.jsxs("div",{className:"flex justify-between items-start gap-4",children:[r.jsxs("div",{className:"flex-1 space-y-3",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("h3",{className:"font-semibold text-lg",children:j.name}),r.jsx(We,{className:y(j.status),children:j.status})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[j.facility&&r.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[r.jsx(jo,{className:"h-4 w-4"}),j.facility.name]}),j.supervisor&&r.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[r.jsx(Pi,{className:"h-4 w-4"}),j.supervisor.name]}),r.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[r.jsx(xs,{className:"h-4 w-4"}),mn(new Date(j.starts_at),"HH:mm")," - ",mn(new Date(j.ends_at),"HH:mm")]}),j.entries_count!==void 0&&r.jsxs("div",{className:"text-muted-foreground",children:[j.entries_count," entries"]})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:"outline",size:"sm",children:"View"}),j.status==="active"&&r.jsx(se,{size:"sm",variant:"destructive",onClick:()=>m.mutate(j.id),disabled:m.isPending,children:"Close"})]})]})})},j.id))})]})}function Zze(){const e=br(),[t,n]=R.useState("all"),[s,i]=R.useState("all"),{data:c,isLoading:u,error:a}=ht({queryKey:["events",t,s],queryFn:()=>rs.events.list({severity:t==="all"?void 0:t,status:s==="all"?void 0:s,per_page:50})}),m=jt({mutationFn:k=>rs.events.acknowledge(k,{note:"Acknowledged"}),onSuccess:()=>{e.invalidateQueries({queryKey:["events"]})}}),p=jt({mutationFn:k=>rs.events.resolve(k,{resolution:"Resolved"}),onSuccess:()=>{e.invalidateQueries({queryKey:["events"]})}}),y=k=>{switch(k){case"critical":return"destructive";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"secondary";default:return"outline"}},v=k=>{switch(k){case"critical":return r.jsx(bo,{className:"h-4 w-4"});case"high":return r.jsx(gn,{className:"h-4 w-4"});default:return null}},j=k=>{switch(k){case"new":return"bg-red-100 text-red-800";case"ack":return"bg-blue-100 text-blue-800";case"in_progress":return"bg-purple-100 text-purple-800";case"resolved":return"bg-green-100 text-green-800";case"closed":return"bg-gray-100 text-gray-800";default:return"outline"}},S=(c==null?void 0:c.data)||[];return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Events & Alarms"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Monitor, acknowledge, and resolve system events"})]}),r.jsxs("div",{className:"flex flex-wrap gap-3",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx("span",{className:"text-sm font-medium text-muted-foreground py-2",children:"Severity:"}),["all","critical","high","medium","low"].map(k=>r.jsx(se,{variant:t===k?"default":"outline",onClick:()=>n(k),size:"sm",children:k==="all"?"All":k.charAt(0).toUpperCase()+k.slice(1)},k))]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("span",{className:"text-sm font-medium text-muted-foreground py-2",children:"Status:"}),["all","new","ack","resolved"].map(k=>r.jsx(se,{variant:s===k?"default":"outline",onClick:()=>i(k),size:"sm",children:k==="all"?"All":k.charAt(0).toUpperCase()+k.slice(1)},k))]})]}),u?r.jsx(J,{children:r.jsx(ie,{className:"p-8 text-center text-muted-foreground",children:"Loading events..."})}):a?r.jsxs(Wi,{variant:"destructive",children:[r.jsx(gn,{className:"h-4 w-4"}),r.jsxs(ki,{children:["Error loading events: ",a.message]})]}):S.length===0?r.jsx(J,{children:r.jsx(ie,{className:"p-8 text-center text-muted-foreground",children:"No events found"})}):r.jsx("div",{className:"space-y-3",children:S.map(k=>r.jsx(J,{className:"hover:shadow-md transition-shadow",children:r.jsx(ie,{className:"p-5",children:r.jsxs("div",{className:"flex justify-between items-start gap-4",children:[r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[v(k.severity)&&r.jsx(r.Fragment,{children:v(k.severity)}),r.jsx("h3",{className:"font-semibold",children:k.category}),r.jsx(We,{className:y(k.severity),children:k.severity}),r.jsx(We,{className:j(k.status),children:k.status})]}),k.description&&r.jsx("p",{className:"text-sm text-muted-foreground",children:k.description}),r.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground pt-2",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(xs,{className:"h-3 w-3"}),mn(new Date(k.detected_at),"Pp")]}),k.facility&&r.jsx("div",{children:k.facility.name}),r.jsx("div",{className:"text-gray-500",children:k.source})]})]}),r.jsxs("div",{className:"flex gap-2",children:[k.status==="new"&&r.jsx(se,{size:"sm",variant:"outline",onClick:()=>m.mutate(k.id),disabled:m.isPending,children:"Acknowledge"}),k.status!=="resolved"&&k.status!=="closed"&&r.jsxs(se,{size:"sm",onClick:()=>p.mutate(k.id),disabled:p.isPending,children:[r.jsx(os,{className:"h-4 w-4 mr-1"}),"Resolve"]})]})]})})},k.id))})]})}function Yze({onSchemaChange:e}){var v;const{control:t,register:n,watch:s,formState:{errors:i}}=zb(),{fields:c,append:u,remove:a,move:m}=vI({control:t,name:"schema"});s("schema");const p=()=>{u({question:"",type:"boolean",required:!0,options:[]})},y=["boolean","text","number","choice","rating"];return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(Ne,{className:"text-base font-semibold",children:"Checklist Questions"}),r.jsxs(se,{type:"button",variant:"outline",size:"sm",onClick:p,children:[r.jsx(ir,{className:"h-4 w-4 mr-1"}),"Add Question"]})]}),c.length===0?r.jsx(J,{className:"border-dashed",children:r.jsx(ie,{className:"p-8 text-center text-muted-foreground",children:r.jsx("p",{className:"text-sm",children:'No questions yet. Click "Add Question" to get started.'})})}):r.jsx("div",{className:"space-y-3",children:c.map((j,S)=>r.jsx(Xze,{fieldIndex:S,onRemove:()=>a(S),onMove:k=>{k==="up"&&S>0&&m(S,S-1),k==="down"&&S<c.length-1&&m(S,S+1)},register:n,fieldTypes:y,watch:s},j.id))}),i.schema&&r.jsx("p",{className:"text-sm text-red-500",children:(v=i.schema)==null?void 0:v.message}),r.jsxs("div",{className:"text-sm text-muted-foreground pt-2",children:[c.length," question",c.length!==1?"s":""," in this checklist"]})]})}function Xze({fieldIndex:e,onRemove:t,onMove:n,register:s,fieldTypes:i,watch:c}){const u=c(`schema.${e}`),[a,m]=R.useState((u==null?void 0:u.type)==="choice"),p=c(`schema.${e}.options`),y=(p==null?void 0:p.split(`
`).filter(v=>v.trim()))||[];return r.jsx(J,{className:"border bg-muted/30",children:r.jsx(ie,{className:"p-4 space-y-4",children:r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{className:"flex-1 space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Ne,{htmlFor:`question-${e}`,className:"text-sm",children:["Question ",e+1]}),r.jsx(Ge,{id:`question-${e}`,placeholder:"Enter your question...",...s(`schema.${e}.question`,{required:"Question is required"})})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:`type-${e}`,className:"text-sm",children:"Type"}),r.jsx("select",{id:`type-${e}`,...s(`schema.${e}.type`),onChange:v=>{m(v.target.value==="choice")},className:"w-full rounded border border-input bg-background px-3 py-2 text-sm",children:i.map(v=>r.jsx("option",{value:v,children:v.charAt(0).toUpperCase()+v.slice(1)},v))})]}),r.jsx("div",{className:"space-y-2",children:r.jsxs(Ne,{className:"text-sm flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",...s(`schema.${e}.required`),className:"rounded"}),r.jsx("span",{children:"Required"})]})})]}),a&&r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:`options-${e}`,className:"text-sm",children:"Options (one per line)"}),r.jsx("textarea",{id:`options-${e}`,placeholder:`Option 1
Option 2
Option 3`,rows:3,...s(`schema.${e}.options`),className:"w-full rounded border border-input bg-background px-3 py-2 text-sm font-mono"}),y.length>0&&r.jsx("div",{className:"flex flex-wrap gap-2 pt-2",children:y.map((v,j)=>r.jsx("div",{className:"bg-background rounded px-2 py-1 border text-xs",children:v.trim()},j))})]})]}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx(se,{type:"button",variant:"ghost",size:"sm",onClick:()=>n("up"),title:"Move up",className:"text-muted-foreground",children:""}),r.jsx(se,{type:"button",variant:"ghost",size:"sm",onClick:()=>n("down"),title:"Move down",className:"text-muted-foreground",children:""}),r.jsx(se,{type:"button",variant:"ghost",size:"sm",onClick:t,title:"Delete",className:"text-destructive hover:text-destructive",children:r.jsx(Oi,{className:"h-4 w-4"})})]})]})})})}function O6({initialChecklist:e,onSuccess:t}){const n=ia({defaultValues:{title:(e==null?void 0:e.title)||"",frequency:(e==null?void 0:e.frequency)||"",schema:(e==null?void 0:e.schema)||[{question:"Is the facility operational?",type:"boolean",required:!0,options:[]}]}}),s=jt({mutationFn:c=>e?rs.checklists.update(e.id,c):rs.checklists.create(c),onSuccess:()=>{qe.success(e?"Checklist updated":"Checklist created"),t==null||t()},onError:c=>{qe.error(c.message)}}),i=c=>{if(!c.schema||c.schema.length===0){qe.error("Add at least one question");return}if(c.schema.some(m=>{var p;return!((p=m.question)!=null&&p.trim())})){qe.error("All questions must have text");return}const a=c.schema.map(m=>({...m,options:m.type==="choice"&&m.options?m.options.split(`
`).filter(p=>p.trim()):[]}));s.mutate({...c,schema:a})};return r.jsx(Pue,{...n,children:r.jsxs("form",{onSubmit:n.handleSubmit(i),className:"space-y-6",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"title",children:"Checklist Title"}),r.jsx(Ge,{id:"title",placeholder:"e.g., Daily Facility Inspection",...n.register("title",{required:"Title is required"})}),n.formState.errors.title&&r.jsx("p",{className:"text-sm text-red-500",children:n.formState.errors.title.message})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"frequency",children:"Frequency (Optional)"}),r.jsxs("select",{id:"frequency",...n.register("frequency"),className:"w-full rounded border border-input bg-background px-3 py-2 text-sm",children:[r.jsx("option",{value:"",children:"No specific frequency"}),r.jsx("option",{value:"daily",children:"Daily"}),r.jsx("option",{value:"weekly",children:"Weekly"}),r.jsx("option",{value:"monthly",children:"Monthly"}),r.jsx("option",{value:"shift_start",children:"At shift start"}),r.jsx("option",{value:"shift_end",children:"At shift end"}),r.jsx("option",{value:"on_demand",children:"On demand"})]})]}),r.jsx(Yze,{}),r.jsx(se,{type:"submit",disabled:s.isPending,className:"w-full",children:s.isPending?"Saving...":e?"Update Checklist":"Create Checklist"})]})})}function Qze(){const e=br(),[t,n]=R.useState("checklists"),[s,i]=R.useState(!1),[c,u]=R.useState(null),{data:a,isLoading:m}=ht({queryKey:["checklists"],queryFn:()=>rs.checklists.list({per_page:50})}),{data:p,isLoading:y}=ht({queryKey:["checklist-runs"],queryFn:()=>rs.checklists.listRuns({per_page:50})}),v=jt({mutationFn:k=>rs.checklists.delete(k),onSuccess:()=>{qe.success("Checklist deleted"),e.invalidateQueries({queryKey:["checklists"]})}}),j=(a==null?void 0:a.data)||[],S=(p==null?void 0:p.data)||[];return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Checklists"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Create and manage facility checklists"})]}),r.jsxs(Rr,{open:s,onOpenChange:i,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"New Checklist"]})}),r.jsxs(Er,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:"Create Checklist"}),r.jsx(Bs,{children:"Define questions for your facility checklist"})]}),r.jsx(O6,{onSuccess:()=>{i(!1),e.invalidateQueries({queryKey:["checklists"]})}})]})]})]}),r.jsxs(qs,{value:t,onValueChange:n,children:[r.jsxs(As,{children:[r.jsx(sr,{value:"checklists",children:"Templates"}),r.jsx(sr,{value:"runs",children:"Runs"})]}),r.jsx(Nr,{value:"checklists",className:"space-y-4",children:m?r.jsx(J,{children:r.jsx(ie,{className:"p-8 text-center text-muted-foreground",children:"Loading checklists..."})}):j.length===0?r.jsx(J,{children:r.jsx(ie,{className:"p-8 text-center text-muted-foreground",children:"No checklists found. Create one to get started!"})}):r.jsx("div",{className:"grid gap-4",children:j.map(k=>{var N,D;return r.jsx(J,{className:"hover:shadow-md transition-shadow",children:r.jsx(ie,{className:"p-6",children:r.jsxs("div",{className:"flex justify-between items-start gap-4",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("h3",{className:"font-semibold text-lg",children:k.title}),k.frequency&&r.jsx(We,{variant:"outline",children:k.frequency})]}),r.jsxs("p",{className:"text-sm text-muted-foreground",children:[((N=k.schema)==null?void 0:N.length)||0," questions",((D=k._count)==null?void 0:D.runs)&&`  ${k._count.runs} runs completed`]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(Rr,{children:[r.jsx(_n,{asChild:!0,children:r.jsx(se,{variant:"outline",size:"sm",children:"Edit"})}),r.jsxs(Er,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Edit Checklist"})}),r.jsx(O6,{initialChecklist:k,onSuccess:()=>{e.invalidateQueries({queryKey:["checklists"]})}})]})]}),r.jsx(se,{size:"sm",children:"Start Run"}),r.jsx(se,{variant:"destructive",size:"sm",onClick:()=>v.mutate(k.id),disabled:v.isPending,children:r.jsx(Oi,{className:"h-4 w-4"})})]})]})})},k.id)})})}),r.jsx(Nr,{value:"runs",className:"space-y-4",children:y?r.jsx(J,{children:r.jsx(ie,{className:"p-8 text-center text-muted-foreground",children:"Loading runs..."})}):S.length===0?r.jsx(J,{children:r.jsx(ie,{className:"p-8 text-center text-muted-foreground",children:"No checklist runs yet"})}):r.jsx("div",{className:"grid gap-4",children:S.map(k=>r.jsx(J,{className:"hover:shadow-md transition-shadow",children:r.jsx(ie,{className:"p-6",children:r.jsxs("div",{className:"flex justify-between items-start gap-4",children:[r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[k.completed_at?r.jsx(Kh,{className:"h-5 w-5 text-green-600"}):r.jsx("div",{className:"h-5 w-5 rounded-full border-2 border-blue-600"}),r.jsx("h3",{className:"font-semibold",children:k.checklist.title}),k.score!==void 0&&r.jsxs(We,{className:"bg-green-100 text-green-800",children:[k.score,"%"]})]}),r.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[r.jsxs("div",{children:["Started: ",mn(new Date(k.started_at),"Pp")]}),k.completed_at&&r.jsxs("div",{children:["Completed: ",mn(new Date(k.completed_at),"Pp")]}),k.performed_by&&r.jsxs("div",{children:["By: ",k.performed_by.name]})]})]}),r.jsx(se,{variant:"outline",size:"sm",children:"View Details"})]})})},k.id))})})]})]})}function Jze(){const{data:e,isLoading:t,error:n}=ht({queryKey:["playbooks"],queryFn:()=>rs.playbooks.list({per_page:50})}),s=(e==null?void 0:e.data)||[],i=u=>{switch(u){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-gray-100 text-gray-800";default:return"outline"}},c=u=>{switch(u){case"automated":return r.jsx(bo,{className:"h-4 w-4"});case"decision":return r.jsx(Sx,{className:"h-4 w-4"});default:return null}};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Playbooks"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Event response automation and runbooks"})]}),r.jsxs(se,{className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"New Playbook"]})]}),t?r.jsx(J,{children:r.jsx(ie,{className:"p-8 text-center text-muted-foreground",children:"Loading playbooks..."})}):n?r.jsxs(Wi,{variant:"destructive",children:[r.jsx(gn,{className:"h-4 w-4"}),r.jsxs(ki,{children:["Error loading playbooks: ",n.message]})]}):s.length===0?r.jsx(J,{children:r.jsx(ie,{className:"p-8 text-center text-muted-foreground",children:"No playbooks found. Create one to automate event responses!"})}):r.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:s.map(u=>{var a,m;return r.jsxs(J,{className:"hover:shadow-md transition-shadow flex flex-col",children:[r.jsx(ge,{className:"pb-3",children:r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx(xe,{className:"text-lg",children:u.name}),u.for_category&&r.jsxs(xr,{className:"text-xs mt-1",children:["For: ",u.for_category]})]}),u.for_severity&&r.jsx(We,{className:i(u.for_severity),children:u.for_severity})]})}),r.jsx(ie,{className:"flex-1 pb-3",children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("p",{className:"text-sm text-muted-foreground font-medium",children:[((a=u.steps)==null?void 0:a.length)||0," steps"]}),r.jsx("div",{className:"space-y-1 max-h-32 overflow-y-auto text-xs",children:(m=u.steps)==null?void 0:m.map((p,y)=>r.jsxs("div",{className:"flex items-start gap-2 p-1.5 bg-muted/50 rounded",children:[r.jsxs("span",{className:"text-muted-foreground font-semibold min-w-6",children:[y+1,"."]}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"font-medium truncate",children:p.title}),p.type&&r.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground mt-0.5",children:[c(p.type),r.jsx("span",{children:p.type})]})]})]},y))})]})}),r.jsxs("div",{className:"flex gap-2 border-t pt-3",children:[r.jsx(se,{variant:"outline",size:"sm",className:"flex-1",children:"Edit"}),r.jsx(se,{size:"sm",className:"flex-1",children:"Test"})]})]},u.id)})})]})}function I6({initialPolicy:e,onSuccess:t}){const{control:n,register:s,handleSubmit:i,formState:{errors:c}}=ia({defaultValues:{name:(e==null?void 0:e.name)||"",rules:(e==null?void 0:e.rules)||[{severity:"critical",escalate_after_minutes:15,notification_channels:["email"],recipients:[{type:"email",target:""}]}]}}),{fields:u,append:a,remove:m}=vI({control:n,name:"rules"}),p=jt({mutationFn:v=>e?rs.escalationPolicies.update(e.id,v):rs.escalationPolicies.create(v),onSuccess:()=>{qe.success(e?"Policy updated":"Policy created"),t==null||t()},onError:v=>{qe.error(v.message)}}),y=v=>{if(!v.rules||v.rules.length===0){qe.error("Add at least one escalation rule");return}p.mutate(v)};return r.jsxs("form",{onSubmit:i(y),className:"space-y-6",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{htmlFor:"name",children:"Policy Name"}),r.jsx(Ge,{id:"name",placeholder:"e.g., Critical Priority Response",...s("name",{required:"Name is required"})}),c.name&&r.jsx("p",{className:"text-sm text-red-500",children:c.name.message})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(Ne,{className:"text-base font-semibold",children:"Escalation Rules"}),r.jsxs(se,{type:"button",variant:"outline",size:"sm",onClick:()=>a({severity:"high",escalate_after_minutes:30,notification_channels:["email"],recipients:[{type:"email",target:""}]}),children:[r.jsx(ir,{className:"h-4 w-4 mr-1"}),"Add Rule"]})]}),r.jsx("div",{className:"space-y-3",children:u.map((v,j)=>r.jsx(e$e,{ruleIndex:j,onRemove:()=>m(j),register:s,control:n},v.id))})]}),r.jsx(se,{type:"submit",disabled:p.isPending,className:"w-full",children:p.isPending?"Saving...":e?"Update Policy":"Create Policy"})]})}function e$e({ruleIndex:e,onRemove:t,register:n,control:s}){const{fields:i,append:c,remove:u}=vI({control:s,name:`rules.${e}.recipients`}),a=["critical","high","medium","low"],m=["email","sms","webhook","push"];return r.jsx(J,{className:"border bg-muted/30",children:r.jsx(ie,{className:"p-4 space-y-4",children:r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{className:"flex-1 space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{className:"text-sm",children:"Severity"}),r.jsx("select",{...n(`rules.${e}.severity`),className:"w-full rounded border border-input bg-background px-3 py-2 text-sm",children:a.map(p=>r.jsx("option",{value:p,children:p.charAt(0).toUpperCase()+p.slice(1)},p))})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{className:"text-sm",children:"Escalate After (min)"}),r.jsx(Ge,{type:"number",min:"1",...n(`rules.${e}.escalate_after_minutes`,{required:!0,valueAsNumber:!0})})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{className:"text-sm",children:"Repeat Every (min)"}),r.jsx(Ge,{type:"number",min:"15",placeholder:"Optional",...n(`rules.${e}.repeat_every_minutes`,{valueAsNumber:!0})})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ne,{className:"text-sm",children:"Notification Channels"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:m.map(p=>r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",value:p,...n(`rules.${e}.notification_channels`),className:"rounded"}),r.jsx("span",{className:"text-sm",children:p.charAt(0).toUpperCase()+p.slice(1)})]},p))})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(Ne,{className:"text-sm",children:"Recipients"}),r.jsxs(se,{type:"button",variant:"ghost",size:"sm",onClick:()=>c({type:"email",target:""}),children:[r.jsx(ir,{className:"h-3 w-3 mr-1"}),"Add"]})]}),r.jsx("div",{className:"space-y-2",children:i.map((p,y)=>r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("select",{...n(`rules.${e}.recipients.${y}.type`),className:"w-24 rounded border border-input bg-background px-2 py-1 text-sm",children:[r.jsx("option",{value:"email",children:"Email"}),r.jsx("option",{value:"phone",children:"Phone"}),r.jsx("option",{value:"user",children:"User"}),r.jsx("option",{value:"role",children:"Role"})]}),r.jsx(Ge,{placeholder:"Email, phone, user ID, or role",...n(`rules.${e}.recipients.${y}.target`),className:"flex-1 text-sm"}),r.jsx(se,{type:"button",variant:"ghost",size:"sm",onClick:()=>u(y),children:r.jsx(Oi,{className:"h-3 w-3"})})]},p.id))})]})]}),r.jsx(se,{type:"button",variant:"ghost",size:"sm",onClick:t,className:"text-destructive hover:text-destructive",children:r.jsx(Oi,{className:"h-4 w-4"})})]})})})}function t$e(){const e=br(),[t,n]=R.useState(""),[s,i]=R.useState(!1),[c,u]=R.useState(null),{data:a,isLoading:m,error:p}=ht({queryKey:["escalation-policies",t],queryFn:()=>rs.escalationPolicies.list({search:t||void 0,per_page:50})}),y=jt({mutationFn:S=>rs.escalationPolicies.delete(S),onSuccess:()=>{e.invalidateQueries({queryKey:["escalation-policies"]})}}),v=(a==null?void 0:a.data)||[],j=S=>{switch(S){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-gray-100 text-gray-800";default:return"outline"}};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Escalation Policies"}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Define SLA escalation rules and notification recipients"})]}),r.jsxs(Rr,{open:s,onOpenChange:i,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"New Policy"]})}),r.jsxs(Er,{className:"max-w-2xl",children:[r.jsxs(Mr,{children:[r.jsx(Or,{children:"Create Escalation Policy"}),r.jsx(Bs,{children:"Define notification rules for event escalation by severity"})]}),r.jsx(I6,{onSuccess:()=>{i(!1),e.invalidateQueries({queryKey:["escalation-policies"]})}})]})]})]}),r.jsx(Ge,{placeholder:"Search policies...",value:t,onChange:S=>n(S.target.value),className:"max-w-sm"}),m?r.jsx(J,{children:r.jsx(ie,{className:"p-8 text-center text-muted-foreground",children:"Loading policies..."})}):p?r.jsxs(Wi,{variant:"destructive",children:[r.jsx(gn,{className:"h-4 w-4"}),r.jsxs(ki,{children:["Error loading policies: ",p.message]})]}):v.length===0?r.jsx(J,{children:r.jsx(ie,{className:"p-8 text-center text-muted-foreground",children:"No escalation policies found. Create one to get started!"})}):r.jsx("div",{className:"grid gap-4",children:v.map(S=>{var k;return r.jsx(J,{className:"hover:shadow-md transition-shadow",children:r.jsx(ie,{className:"p-6",children:r.jsxs("div",{className:"flex justify-between items-start gap-4",children:[r.jsxs("div",{className:"flex-1 space-y-4",children:[r.jsx("h3",{className:"font-semibold text-lg",children:S.name}),r.jsx("div",{className:"space-y-3",children:(k=S.rules)==null?void 0:k.map((N,D)=>{var O,T;return r.jsx("div",{className:"p-3 rounded-lg bg-muted/50 border border-muted",children:r.jsx("div",{className:"flex items-start justify-between gap-3",children:r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(We,{className:j(N.severity),children:N.severity}),r.jsxs("span",{className:"text-sm text-muted-foreground",children:["Escalate after ",N.escalate_after_minutes," min"]}),N.repeat_every_minutes&&r.jsxs("span",{className:"text-xs text-muted-foreground",children:["(Repeat every ",N.repeat_every_minutes," min)"]})]}),r.jsxs("div",{className:"text-sm",children:[r.jsx("div",{className:"text-muted-foreground mb-1",children:"Channels:"}),r.jsx("div",{className:"flex flex-wrap gap-1",children:(O=N.notification_channels)==null?void 0:O.map(I=>r.jsx(We,{variant:"outline",className:"text-xs",children:I},I))})]}),r.jsxs("div",{className:"text-sm",children:[r.jsx("div",{className:"text-muted-foreground mb-1",children:"Recipients:"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:(T=N.recipients)==null?void 0:T.map((I,z)=>r.jsxs("div",{className:"text-xs bg-background rounded px-2 py-1 border",children:[I.type,": ",I.target]},z))})]})]})})},D)})})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(Rr,{children:[r.jsx(_n,{asChild:!0,children:r.jsx(se,{variant:"outline",size:"sm",children:r.jsx(IO,{className:"h-4 w-4"})})}),r.jsxs(Er,{className:"max-w-2xl",children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Edit Escalation Policy"})}),r.jsx(I6,{initialPolicy:S,onSuccess:()=>{e.invalidateQueries({queryKey:["escalation-policies"]})}})]})]}),r.jsx(se,{variant:"destructive",size:"sm",onClick:()=>y.mutate(S.id),disabled:y.isPending,children:r.jsx(Oi,{className:"h-4 w-4"})})]})]})})},S.id)})})]})}function r$e(){const e=br(),[t,n]=R.useState(""),[s,i]=R.useState(!1),[c,u]=R.useState({key:"",name:"",spec:""}),{data:a,isLoading:m}=ht({queryKey:["workflow-definitions"],queryFn:()=>me.get("/workflows/definitions")}),p=jt({mutationFn:S=>me.post("/workflows/definitions",S),onSuccess:()=>{qe.success("Workflow created"),e.invalidateQueries({queryKey:["workflow-definitions"]}),i(!1)}}),y=jt({mutationFn:S=>me.post(`/workflows/definitions/${S}/activate`,{}),onSuccess:()=>{e.invalidateQueries({queryKey:["workflow-definitions"]})}}),v=jt({mutationFn:S=>me.delete(`/workflows/definitions/${S}`),onSuccess:()=>{e.invalidateQueries({queryKey:["workflow-definitions"]})}}),j=(a==null?void 0:a.data)||[];return r.jsxs("div",{className:"space-y-6 p-6",children:[r.jsxs("div",{className:"flex justify-between items-start mb-6",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Workflow Definitions"}),r.jsx("p",{className:"text-muted-foreground max-w-2xl",children:"Define automated workflows as code to automate business processes. Create state machines that define how work progresses through different states, with automatic actions, SLA tracking, and escalation rules. Templates are available for Work Orders, Incidents, Complaints, Procurement, and more."})]}),r.jsxs(Rr,{open:s,onOpenChange:i,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"New Workflow"]})}),r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Create Workflow Definition"})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:"Key"}),r.jsx(Ge,{placeholder:"work_order.v1",value:c.key,onChange:S=>u({...c,key:S.target.value})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:"Name"}),r.jsx(Ge,{placeholder:"Work Order Workflow",value:c.name,onChange:S=>u({...c,name:S.target.value})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:"Spec (JSON)"}),r.jsx("textarea",{className:"w-full rounded border p-2 font-mono text-sm",rows:6,placeholder:'{"key":"work_order.v1","states":[{"name":"new"}]}',value:c.spec,onChange:S=>u({...c,spec:S.target.value})})]}),r.jsx(se,{onClick:()=>p.mutate({...c,spec:JSON.parse(c.spec)}),disabled:p.isPending,className:"w-full",children:"Create"})]})]})]})]}),r.jsx(Ge,{placeholder:"Search workflows...",value:t,onChange:S=>n(S.target.value),className:"max-w-sm"}),m?r.jsx("p",{children:"Loading..."}):r.jsx("div",{className:"grid gap-4",children:j.map(S=>r.jsx(J,{children:r.jsx(ie,{className:"p-6",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("h3",{className:"font-semibold text-lg",children:S.name}),S.active?r.jsx(We,{className:"bg-green-100 text-green-800",children:"Active"}):r.jsx(We,{variant:"outline",children:"Inactive"}),r.jsxs(We,{variant:"secondary",children:["v",S.version]})]}),r.jsx("p",{className:"text-sm text-muted-foreground",children:S.key})]}),r.jsxs("div",{className:"flex gap-2",children:[!S.active&&r.jsx(se,{size:"sm",variant:"outline",onClick:()=>y.mutate(S.id),children:r.jsx(os,{className:"h-4 w-4"})}),r.jsx(se,{size:"sm",variant:"outline",onClick:()=>window.location.href=`/workflows/definitions/${S.id}`,children:r.jsx(IO,{className:"h-4 w-4"})}),r.jsx(se,{size:"sm",variant:"destructive",onClick:()=>v.mutate(S.id),children:r.jsx(Oi,{className:"h-4 w-4"})})]})]})})},S.id))})]})}function n$e(){const e=br(),[t,n]=R.useState(""),[s,i]=R.useState(""),{data:c,isLoading:u}=ht({queryKey:["workflow-instances",t,s],queryFn:()=>me.get("/workflows/instances",{state:t||void 0,entity_type:s||void 0})}),a=jt({mutationFn:y=>me.post(`/workflows/instances/${y.id}/trigger`,{trigger:y.trigger}),onSuccess:()=>{qe.success("Triggered successfully"),e.invalidateQueries({queryKey:["workflow-instances"]})}}),m=(c==null?void 0:c.data)||[],p=y=>({new:"bg-blue-100 text-blue-800",assigned:"bg-yellow-100 text-yellow-800",in_progress:"bg-purple-100 text-purple-800",done:"bg-green-100 text-green-800",closed:"bg-gray-100 text-gray-800"})[y]||"outline";return r.jsxs("div",{className:"space-y-6 p-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Workflow Instances"}),r.jsx("p",{className:"text-muted-foreground mt-2 max-w-2xl",children:"Monitor running workflow instances in real-time. Track the progress of Work Orders, Incidents, Complaints, Procurement requests, and other business entities as they move through defined workflow states. Manually trigger transitions, check SLA compliance, and view the complete audit trail of all state changes."})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx(Ge,{placeholder:"Filter by state...",value:t,onChange:y=>n(y.target.value),className:"max-w-sm"}),r.jsx(Ge,{placeholder:"Filter by entity type...",value:s,onChange:y=>i(y.target.value),className:"max-w-sm"})]}),u?r.jsx("p",{children:"Loading..."}):m.length===0?r.jsx(J,{children:r.jsx(ie,{className:"p-8 text-center text-muted-foreground",children:"No instances found"})}):r.jsx("div",{className:"space-y-4",children:m.map(y=>r.jsx(J,{children:r.jsx(ie,{className:"p-6",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsxs("h3",{className:"font-semibold",children:[y.entity_type," #",y.entity_id]}),r.jsx(We,{className:p(y.state),children:y.state})]}),r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Started: ",mn(new Date(y.started_at),"MMM dd, yyyy HH:mm")]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{size:"sm",onClick:()=>a.mutate({id:y.id,trigger:"proceed"}),disabled:a.isPending,children:"Proceed"}),r.jsx(se,{size:"sm",variant:"outline",onClick:()=>window.location.href=`/workflows/instances/${y.id}`,children:"Details"})]})]})})},y.id))})]})}function s$e(){const e=br(),[t,n]=R.useState(!1),[s,i]=R.useState({operatorId:"",topic:"operation",score:""}),[c,u]=R.useState(1),a=6,{data:m,isLoading:p}=ht({queryKey:["capacity-assessments",c],queryFn:()=>me.get("/training/assessments")}),y=jt({mutationFn:k=>me.post("/training/assessments",k),onSuccess:()=>{qe.success("Assessment recorded"),e.invalidateQueries({queryKey:["capacity-assessments"]}),n(!1)}}),v=(m==null?void 0:m.data)||[],j=(k,N)=>k==="pending"?"bg-gray-100 text-gray-800":N?"bg-green-100 text-green-800":"bg-red-100 text-red-800",S={totalOperators:245,certified:189,pendingReview:32,needsTraining:24};return r.jsxs("div",{className:"space-y-6 p-6",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Operator Capacity Assessment"}),r.jsx("p",{className:"text-muted-foreground",children:"Evaluate and certify water system operators. Track competency assessments, certification validity, and training needs."})]}),r.jsxs(Rr,{open:t,onOpenChange:n,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"New Assessment"]})}),r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Record Assessment"})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:"Operator ID"}),r.jsx(Ge,{placeholder:"ID or phone number",value:s.operatorId,onChange:k=>i({...s,operatorId:k.target.value})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:"Assessment Topic"}),r.jsxs("select",{className:"w-full rounded border p-2",value:s.topic,onChange:k=>i({...s,topic:k.target.value}),children:[r.jsx("option",{value:"operation",children:"System Operation"}),r.jsx("option",{value:"maintenance",children:"Preventive Maintenance"}),r.jsx("option",{value:"safety",children:"Safety & HSE"}),r.jsx("option",{value:"billing",children:"Tariff & Billing"}),r.jsx("option",{value:"customer",children:"Customer Service"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:"Score (0-100)"}),r.jsx(Ge,{type:"number",min:"0",max:"100",value:s.score,onChange:k=>i({...s,score:k.target.value})})]}),r.jsx(se,{onClick:()=>y.mutate({operatorId:s.operatorId,topic:s.topic,score:parseInt(s.score)}),disabled:y.isPending,className:"w-full",children:"Record Assessment"})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsx(xe,{className:"text-sm font-medium",children:"Total Operators"})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-3xl font-bold",children:S.totalOperators}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Across all schemes"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(Kh,{className:"h-4 w-4 text-green-600"})," Certified"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-3xl font-bold text-green-600",children:S.certified}),r.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[Math.round(S.certified/S.totalOperators*100),"% of total"]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(ei,{className:"h-4 w-4 text-yellow-600"})," Pending"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-3xl font-bold text-yellow-600",children:S.pendingReview}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Under review"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(ei,{className:"h-4 w-4 text-red-600"})," Training Needed"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-3xl font-bold text-red-600",children:S.needsTraining}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Not yet certified"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx(xe,{children:"Recent Assessments"}),r.jsxs("span",{className:"text-sm text-muted-foreground",children:[v.length," assessments"]})]})}),r.jsxs(ie,{children:[r.jsx(Ty,{className:"h-[500px] pr-4",children:r.jsx("div",{className:"space-y-4",children:p?r.jsx("p",{children:"Loading assessments..."}):v.slice((c-1)*a,c*a).map(k=>r.jsxs("div",{className:"p-4 border rounded-lg",children:[r.jsxs("div",{className:"flex justify-between items-start mb-3",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-semibold",children:k.operatorName}),r.jsx("p",{className:"text-sm text-muted-foreground",children:k.topic})]}),r.jsx(We,{className:j(k.status,k.certificationValid),children:k.certificationValid?"CERTIFIED":"PENDING"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsxs("span",{children:["Score: ",k.score,"/",k.maxScore]}),r.jsxs("span",{className:"font-semibold",children:[Math.round(k.score/k.maxScore*100),"%"]})]}),r.jsx(Ju,{value:k.score/k.maxScore*100})]}),k.validUntil&&r.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Cert valid until: ",k.validUntil]})]},k.id))})}),v.length>a&&r.jsxs("div",{className:"flex justify-between items-center mt-6 pt-4 border-t",children:[r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Page ",c," of ",Math.ceil(v.length/a)]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:"outline",size:"sm",onClick:()=>u(Math.max(1,c-1)),disabled:c===1,children:r.jsx(MO,{className:"h-4 w-4"})}),r.jsx(se,{variant:"outline",size:"sm",onClick:()=>u(Math.min(Math.ceil(v.length/a),c+1)),disabled:c>=Math.ceil(v.length/a),children:r.jsx(by,{className:"h-4 w-4"})})]})]})]})]})]})}function i$e(){const e=br(),[t,n]=R.useState(!1),[s,i]=R.useState({name:"",safeYield:""}),[c,u]=R.useState(1),a=5,{data:m,isLoading:p}=ht({queryKey:["aquifers",c],queryFn:()=>me.get("/hydromet/aquifers")}),y=jt({mutationFn:N=>me.post("/hydromet/aquifers",N),onSuccess:()=>{qe.success("Aquifer registered"),e.invalidateQueries({queryKey:["aquifers"]}),n(!1)}}),v=(m==null?void 0:m.data)||[],j=N=>N==="critical"?"bg-red-100 text-red-800":N==="high"?"bg-orange-100 text-orange-800":N==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800",S={totalAquifers:v.length,atRisk:v.filter(N=>N.riskLevel==="high"||N.riskLevel==="critical").length,totalSafeYield:v.reduce((N,D)=>N+(D.safeYieldMcm||0),0),totalCurrent:v.reduce((N,D)=>N+(D.currentYieldMcm||0),0)},k=S.totalSafeYield>0?Math.round(S.totalCurrent/S.totalSafeYield*100):0;return r.jsxs("div",{className:"space-y-6 p-6",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Aquifer Management"}),r.jsx("p",{className:"text-muted-foreground",children:"Monitor groundwater resources, track sustainable yield, recharge rates, and aquifer health. Manage 7 priority aquifers across ASAL counties."})]}),r.jsxs(Rr,{open:t,onOpenChange:n,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"Register Aquifer"]})}),r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Register Aquifer"})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:"Aquifer Name"}),r.jsx(Ge,{placeholder:"e.g., Elwak Aquifer",value:s.name,onChange:N=>i({...s,name:N.target.value})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:"Safe Yield (MCM/year)"}),r.jsx(Ge,{type:"number",placeholder:"Annual sustainable yield",value:s.safeYield,onChange:N=>i({...s,safeYield:N.target.value})})]}),r.jsx(se,{onClick:()=>y.mutate({name:s.name,safeYieldMcm:parseInt(s.safeYield)}),disabled:y.isPending,className:"w-full",children:"Register"})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsx(xe,{className:"text-sm font-medium",children:"Priority Aquifers"})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-3xl font-bold",children:S.totalAquifers}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Under management"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsx(xe,{className:"text-sm font-medium",children:"Safe Yield"})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-3xl font-bold",children:S.totalSafeYield}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"MCM/year total"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsx(xe,{className:"text-sm font-medium",children:"Current Abstraction"})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-3xl font-bold",children:S.totalCurrent}),r.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[k,"% of safe yield"]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(gn,{className:"h-4 w-4 text-red-600"})," At Risk"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-3xl font-bold text-red-600",children:S.atRisk}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"High/Critical stress"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx(xe,{children:"Aquifer Status Overview"}),r.jsxs("span",{className:"text-sm text-muted-foreground",children:[v.length," aquifers total"]})]})}),r.jsxs(ie,{children:[r.jsx(Ty,{className:"h-[600px] pr-4",children:r.jsx("div",{className:"space-y-6",children:p?r.jsx("p",{children:"Loading aquifers..."}):v.slice((c-1)*a,c*a).map(N=>{var O;const D=N.safeYieldMcm>0?N.currentYieldMcm/N.safeYieldMcm*100:0;return r.jsxs("div",{className:"p-4 border rounded-lg",children:[r.jsxs("div",{className:"flex justify-between items-start mb-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-semibold text-lg",children:N.name}),r.jsxs("p",{className:"text-sm text-muted-foreground",children:[N.areaKm2," km"]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(We,{className:j(N.riskLevel),children:(O=N.riskLevel)==null?void 0:O.toUpperCase()}),r.jsx(We,{variant:"outline",children:N.waterQualityStatus})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-muted-foreground",children:"Safe Yield"}),r.jsxs("p",{className:"font-semibold",children:[N.safeYieldMcm," MCM/yr"]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-muted-foreground",children:"Current"}),r.jsxs("p",{className:"font-semibold",children:[N.currentYieldMcm," MCM/yr"]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-muted-foreground",children:"Recharge"}),r.jsxs("p",{className:"font-semibold",children:[N.rechargeRateMcm," MCM/yr"]})]})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-xs mb-2",children:[r.jsx("span",{children:"Utilization Rate"}),r.jsxs("span",{className:"font-semibold",children:[Math.round(D),"%"]})]}),r.jsx(Ju,{value:Math.min(D,100)}),D>80&&r.jsx("p",{className:"text-xs text-red-600 mt-2",children:" Exceeding safe yield threshold"})]})]},N.id)})})}),v.length>a&&r.jsxs("div",{className:"flex justify-between items-center mt-6 pt-4 border-t",children:[r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Page ",c," of ",Math.ceil(v.length/a)]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:"outline",size:"sm",onClick:()=>u(Math.max(1,c-1)),disabled:c===1,children:r.jsx(MO,{className:"h-4 w-4"})}),r.jsx(se,{variant:"outline",size:"sm",onClick:()=>u(Math.min(Math.ceil(v.length/a),c+1)),disabled:c>=Math.ceil(v.length/a),children:r.jsx(by,{className:"h-4 w-4"})})]})]})]})]})]})}function a$e(){var D;const e=br(),[t,n]=R.useState(!1),[s,i]=R.useState({name:"",severity:"high"}),[c,u]=R.useState(1),a=4,{data:m,isLoading:p}=ht({queryKey:["drought-events",c],queryFn:()=>me.get("/core-ops/droughts")}),y=jt({mutationFn:O=>me.post("/core-ops/droughts",O),onSuccess:()=>{qe.success("Drought event declared"),e.invalidateQueries({queryKey:["drought-events"]}),n(!1)}}),v=jt({mutationFn:O=>me.post(`/core-ops/droughts/${O}/activate`,{}),onSuccess:()=>{qe.success("Emergency response activated"),e.invalidateQueries({queryKey:["drought-events"]})}}),j=(m==null?void 0:m.data)||[],S=j.find(O=>O.status==="active"),k=O=>O==="critical"?"bg-red-100 text-red-800 border-red-300":O==="high"?"bg-orange-100 text-orange-800 border-orange-300":"bg-yellow-100 text-yellow-800 border-yellow-300",N={declared:j.filter(O=>O.status==="declared").length,active:j.filter(O=>O.status==="active").length,resolved:j.filter(O=>O.status==="resolved").length,totalPopulation:j.reduce((O,T)=>O+(T.affectedPopulation||0),0)};return r.jsxs("div",{className:"space-y-6 p-6",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Drought Response Center"}),r.jsx("p",{className:"text-muted-foreground",children:"Rapidly mobilize emergency boreholes and water sources during drought. Coordinate strategic borehole activation, track affected populations, and manage water rationing."})]}),r.jsxs(Rr,{open:t,onOpenChange:n,children:[r.jsx(_n,{asChild:!0,children:r.jsxs(se,{className:"gap-2",children:[r.jsx(ir,{className:"h-4 w-4"}),"Declare Drought"]})}),r.jsxs(Er,{children:[r.jsx(Mr,{children:r.jsx(Or,{children:"Declare Drought Event"})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:"Event Name"}),r.jsx(Ge,{placeholder:"e.g., 2025 ASAL Drought - Jan-Mar",value:s.name,onChange:O=>i({...s,name:O.target.value})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:"Severity Level"}),r.jsxs("select",{className:"w-full rounded border p-2",value:s.severity,onChange:O=>i({...s,severity:O.target.value}),children:[r.jsx("option",{value:"low",children:"Low"}),r.jsx("option",{value:"high",children:"High"}),r.jsx("option",{value:"critical",children:"Critical"})]})]}),r.jsx(se,{onClick:()=>y.mutate({name:s.name,severity:s.severity}),disabled:y.isPending,className:"w-full",children:"Declare Drought"})]})]})]})]}),S&&r.jsxs(Wi,{className:`border-2 ${k(S.severity)}`,children:[r.jsx(gn,{className:"h-4 w-4"}),r.jsxs(ki,{children:[r.jsx("strong",{children:"Active Drought Event:"})," ",S.name," (",S.severity.toUpperCase(),") - ",(D=S.affectedPopulation)==null?void 0:D.toLocaleString()," people affected."," ",r.jsx("strong",{children:S.activatedBoreholes})," emergency boreholes activated."]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsx(xe,{className:"text-sm font-medium",children:"Drought Events Declared"})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-3xl font-bold",children:N.declared}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"On record"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(bo,{className:"h-4 w-4 text-red-600"})," Active Events"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-3xl font-bold text-red-600",children:N.active}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Ongoing responses"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsx(xe,{className:"text-sm font-medium",children:"Affected Population"})}),r.jsxs(ie,{children:[r.jsxs("div",{className:"text-3xl font-bold",children:[(N.totalPopulation/1e3).toFixed(0),"K"]}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Across all events"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsx(xe,{className:"text-sm font-medium",children:"Resolved Events"})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-3xl font-bold",children:N.resolved}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Completed"})]})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx(xe,{children:"Drought Events & Response Status"}),r.jsxs("span",{className:"text-sm text-muted-foreground",children:[j.length," events"]})]})}),r.jsxs(ie,{children:[r.jsx(Ty,{className:"h-[550px] pr-4",children:r.jsx("div",{className:"space-y-4",children:p?r.jsx("p",{children:"Loading drought events..."}):j.slice((c-1)*a,c*a).map(O=>r.jsxs("div",{className:`p-4 border-2 rounded-lg ${k(O.severity)}`,children:[r.jsxs("div",{className:"flex justify-between items-start mb-3",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-semibold text-lg",children:O.name}),r.jsxs("p",{className:"text-sm",children:["Started: ",new Date(O.startDate).toLocaleDateString()]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(We,{children:O.status.toUpperCase()}),O.waterRationing&&r.jsx(We,{variant:"destructive",children:"RATIONING"})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-muted-foreground",children:"Affected Population"}),r.jsxs("p",{className:"text-2xl font-bold",children:[(O.affectedPopulation/1e3).toFixed(0),"K"]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-muted-foreground",children:"Emergency Boreholes"}),r.jsx("p",{className:"text-2xl font-bold",children:O.activatedBoreholes})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-muted-foreground",children:"Response Status"}),r.jsx("p",{className:"text-sm font-semibold",children:O.status==="declared"?"Preparing":"Active"})]})]}),O.status==="declared"&&r.jsxs(se,{size:"sm",onClick:()=>v.mutate(O.id),disabled:v.isPending,className:"w-full",children:[r.jsx(bo,{className:"h-4 w-4 mr-2"}),"Activate Emergency Response"]})]},O.id))})}),j.length>a&&r.jsxs("div",{className:"flex justify-between items-center mt-6 pt-4 border-t",children:[r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Page ",c," of ",Math.ceil(j.length/a)]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{variant:"outline",size:"sm",onClick:()=>u(Math.max(1,c-1)),disabled:c===1,children:r.jsx(MO,{className:"h-4 w-4"})}),r.jsx(se,{variant:"outline",size:"sm",onClick:()=>u(Math.min(Math.ceil(j.length/a),c+1)),disabled:c>=Math.ceil(j.length/a),children:r.jsx(by,{className:"h-4 w-4"})})]})]})]})]})]})}function o$e(){const{data:e,isLoading:t}=ht({queryKey:["gender-equity"],queryFn:()=>me.get("/me/gender-equity")}),n=(e==null?void 0:e.data)||[],s={women:n.filter(m=>m.gender==="female").length,men:n.filter(m=>m.gender==="male").length,youth:n.filter(m=>m.gender==="youth").length,elderly:n.filter(m=>m.gender==="elderly").length},i=[{name:"Women",value:s.women},{name:"Men",value:s.men}],c=[{name:"Youth (18-35)",value:s.youth},{name:"Elderly (60+)",value:s.elderly}],u=[{category:"Women","Water Hours/Day":12,"Collection Time (min)":45},{category:"Men","Water Hours/Day":15,"Collection Time (min)":15},{category:"Youth","Water Hours/Day":14,"Collection Time (min)":25}],a=["#ef4444","#f97316","#eab308","#22c55e"];return r.jsx(Ty,{className:"h-screen",children:r.jsxs("div",{className:"space-y-6 p-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Gender & Equity Reporting"}),r.jsx("p",{className:"text-muted-foreground max-w-2xl",children:"Track water service access and equity outcomes across gender groups and vulnerable populations. Monitor water availability, collection burden, and satisfaction across different demographics."})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsxs(xe,{className:"text-sm font-medium flex items-center gap-2",children:[r.jsx(Pi,{className:"h-4 w-4"})," Women Served"]})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-3xl font-bold",children:s.women}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Households tracked"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsx(xe,{className:"text-sm font-medium",children:"Men Served"})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-3xl font-bold",children:s.men}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Households tracked"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsx(xe,{className:"text-sm font-medium",children:"Youth (18-35)"})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-3xl font-bold",children:s.youth}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Beneficiaries"})]})]}),r.jsxs(J,{children:[r.jsx(ge,{className:"pb-3",children:r.jsx(xe,{className:"text-sm font-medium",children:"Elderly (60+)"})}),r.jsxs(ie,{children:[r.jsx("div",{className:"text-3xl font-bold",children:s.elderly}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Beneficiaries"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Gender Distribution"})}),r.jsx(ie,{children:r.jsx(Da,{width:"100%",height:300,children:r.jsxs(T6,{children:[r.jsx(tu,{data:i,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,children:i.map((m,p)=>r.jsx(q0,{fill:a[p]},`cell-${p}`))}),r.jsx(Ds,{}),r.jsx(sa,{})]})})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Vulnerable Groups"})}),r.jsx(ie,{children:r.jsx(Da,{width:"100%",height:300,children:r.jsxs(T6,{children:[r.jsx(tu,{data:c,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,children:c.map((m,p)=>r.jsx(q0,{fill:a[p+2]},`cell-${p}`))}),r.jsx(Ds,{}),r.jsx(sa,{})]})})})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Water Access & Collection Burden by Gender"})}),r.jsxs(ie,{children:[r.jsx(Da,{width:"100%",height:300,children:r.jsxs(hy,{data:u,children:[r.jsx(wo,{strokeDasharray:"3 3"}),r.jsx(aa,{dataKey:"category"}),r.jsx(Mi,{yAxisId:"left",label:{value:"Hours/Day",angle:-90,position:"insideLeft"}}),r.jsx(Mi,{yAxisId:"right",orientation:"right",label:{value:"Minutes",angle:90,position:"insideRight"}}),r.jsx(Ds,{}),r.jsx(sa,{}),r.jsx(Ia,{yAxisId:"left",dataKey:"Water Hours/Day",fill:"#3b82f6"}),r.jsx(Ia,{yAxisId:"right",dataKey:"Collection Time (min)",fill:"#ef4444"})]})}),r.jsx("div",{className:"mt-6 p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:r.jsxs("p",{className:"text-sm text-yellow-800",children:[r.jsx("strong",{children:"Key Finding:"})," Women spend 3x longer collecting water compared to men (45 vs 15 minutes). This burden is a barrier to school attendance and economic activity."]})})]})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Recommendations"})}),r.jsx(ie,{children:r.jsxs("ul",{className:"space-y-3 text-sm",children:[r.jsxs("li",{className:"flex gap-3",children:[r.jsx($s,{className:"h-4 w-4 text-green-600 flex-shrink-0 mt-0.5"}),r.jsx("span",{children:"Prioritize household connections in high-collection-burden areas to reduce women's water collection time"})]}),r.jsxs("li",{className:"flex gap-3",children:[r.jsx(bo,{className:"h-4 w-4 text-orange-600 flex-shrink-0 mt-0.5"}),r.jsx("span",{children:"Establish water points within 500m of homes to meet WHO accessibility standards"})]}),r.jsxs("li",{className:"flex gap-3",children:[r.jsx(Pi,{className:"h-4 w-4 text-blue-600 flex-shrink-0 mt-0.5"}),r.jsx("span",{children:"Ensure elderly and vulnerable populations have subsidized access and priority queuing"})]})]})})]})]})})}function l$e(){return r.jsxs("div",{className:"flex h-screen bg-background",children:[r.jsx(za,{}),r.jsx("main",{className:"flex-1 overflow-y-auto",children:r.jsx(Fa,{})})]})}async function c$e(e,t,n){const s=new URLSearchParams;e&&s.append("domain",e),t&&s.append("level",t),n&&s.append("search",n);const i=await fetch(`/api/v1/training/courses?${s}`,{credentials:"include"});if(!i.ok)throw new Error("Failed to fetch courses");return i.json()}async function u$e(e){const t=await fetch("/api/v1/training/enrollments",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({course_id:e})});if(!t.ok)throw new Error("Failed to enroll");return t.json()}function d$e(){const[e,t]=R.useState(""),[n,s]=R.useState("all"),[i,c]=R.useState("all"),{data:u,isLoading:a}=ht({queryKey:["courses",n,i,e],queryFn:()=>c$e(n!=="all"?n:void 0,i!=="all"?i:void 0,e),staleTime:6e4}),m=async y=>{try{await u$e(y),alert("Successfully enrolled!")}catch{alert("Enrollment failed")}},p=(u==null?void 0:u.data)||[];return r.jsxs("div",{className:"container mx-auto p-6",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Course Catalog"}),r.jsx("p",{className:"text-muted-foreground",children:"Browse and enroll in training courses"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[r.jsx("div",{className:"md:col-span-2",children:r.jsxs("div",{className:"relative",children:[r.jsx(ci,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Search courses...",value:e,onChange:y=>t(y.target.value),className:"pl-10"})]})}),r.jsxs(Jt,{value:n,onValueChange:s,children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"All Domains"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Domains"}),r.jsx(ke,{value:"Ops",children:"Operations"}),r.jsx(ke,{value:"Lab",children:"Laboratory"}),r.jsx(ke,{value:"HSE",children:"Health & Safety"}),r.jsx(ke,{value:"CRM",children:"Customer Relations"}),r.jsx(ke,{value:"Finance",children:"Finance"})]})]}),r.jsxs(Jt,{value:i,onValueChange:c,children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"All Levels"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Levels"}),r.jsx(ke,{value:"basic",children:"Basic"}),r.jsx(ke,{value:"intermediate",children:"Intermediate"}),r.jsx(ke,{value:"advanced",children:"Advanced"})]})]})]}),a?r.jsx("div",{className:"text-center py-12",children:"Loading courses..."}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(y=>r.jsxs(J,{className:"hover:shadow-lg transition-shadow",children:[y.thumbnail_url&&r.jsx("img",{src:y.thumbnail_url,alt:y.title,className:"w-full h-48 object-cover rounded-t-lg"}),r.jsxs(ge,{children:[r.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[r.jsx(xe,{className:"text-lg line-clamp-2",children:y.title}),r.jsx(We,{variant:"outline",children:y.domain})]}),r.jsx(xr,{className:"line-clamp-2",children:y.description})]}),r.jsx(ie,{children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(xs,{className:"h-4 w-4"}),r.jsxs("span",{children:[y.duration_min," min"]})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(C0,{className:"h-4 w-4"}),r.jsxs("span",{children:[y.credits," credits"]})]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(We,{variant:"secondary",className:"capitalize",children:y.level}),r.jsxs("span",{className:"text-sm text-muted-foreground",children:[y.enrollments_count," enrolled"]})]}),r.jsxs(se,{onClick:()=>m(y.id),className:"w-full",size:"sm",children:[r.jsx(Sx,{className:"h-4 w-4 mr-2"}),"Enroll Now"]})]})})]},y.id))}),!a&&p.length===0&&r.jsxs(J,{className:"p-12 text-center",children:[r.jsx(Sx,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),r.jsx("p",{className:"text-lg font-medium",children:"No courses found"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Try adjusting your filters or search terms"})]})]})}async function h$e(){const e=await fetch("/api/v1/training/my-enrollments",{credentials:"include"});if(!e.ok)throw new Error("Failed to fetch enrollments");return e.json()}function f$e(){const{data:e,isLoading:t}=ht({queryKey:["my-enrollments"],queryFn:h$e,staleTime:3e4});if(t)return r.jsx("div",{className:"container mx-auto p-6",children:"Loading..."});const n=(e==null?void 0:e.in_progress)||[],s=(e==null?void 0:e.enrolled)||[],i=(e==null?void 0:e.completed)||[],c=(e==null?void 0:e.overdue)||[];return r.jsxs("div",{className:"container mx-auto p-6",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold",children:"My Learning"}),r.jsx("p",{className:"text-muted-foreground",children:"Track your training progress and certifications"})]}),c.length>0&&r.jsxs(J,{className:"mb-6 border-destructive",children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ei,{className:"h-5 w-5 text-destructive"}),r.jsx(xe,{className:"text-destructive",children:"Overdue Courses"})]})}),r.jsx(ie,{children:r.jsx("div",{className:"space-y-3",children:c.map(u=>r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:u.course.title}),r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Due: ",new Date(u.due_at).toLocaleDateString()]})]}),r.jsx(se,{size:"sm",variant:"destructive",children:"Continue"})]},u.id))})})]}),r.jsxs(qs,{defaultValue:"in-progress",className:"space-y-4",children:[r.jsxs(As,{children:[r.jsxs(sr,{value:"in-progress",children:["In Progress (",n.length,")"]}),r.jsxs(sr,{value:"enrolled",children:["Not Started (",s.length,")"]}),r.jsxs(sr,{value:"completed",children:["Completed (",i.length,")"]})]}),r.jsx(Nr,{value:"in-progress",className:"space-y-4",children:n.length===0?r.jsxs(J,{className:"p-12 text-center",children:[r.jsx(Sx,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),r.jsx("p",{className:"text-lg font-medium",children:"No courses in progress"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Start a course from your enrolled list"})]}):n.map(u=>r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{children:[r.jsx(xe,{children:u.course.title}),r.jsxs(xr,{children:[u.course.domain," | ",u.course.code]})]}),r.jsxs(We,{variant:"secondary",children:[u.progress_percent,"% Complete"]})]})}),r.jsx(ie,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[r.jsx("span",{className:"text-muted-foreground",children:"Progress"}),r.jsxs("span",{className:"font-medium",children:[u.progress_percent,"%"]})]}),r.jsx(Ju,{value:u.progress_percent,className:"h-2"})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(xs,{className:"h-4 w-4"}),r.jsxs("span",{children:[u.course.duration_min," min"]})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(C0,{className:"h-4 w-4"}),r.jsxs("span",{children:[u.course.credits," credits"]})]})]}),r.jsxs(se,{size:"sm",children:[r.jsx(od,{className:"h-4 w-4 mr-2"}),"Continue Learning"]})]})]})})]},u.id))}),r.jsx(Nr,{value:"enrolled",className:"space-y-4",children:s.length===0?r.jsxs(J,{className:"p-12 text-center",children:[r.jsx(Sx,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),r.jsx("p",{className:"text-lg font-medium",children:"No enrolled courses"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Browse the course catalog to enroll"})]}):s.map(u=>r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{children:[r.jsx(xe,{children:u.course.title}),r.jsxs(xr,{children:[u.course.domain," | ",u.course.code]})]}),r.jsx(We,{children:"Not Started"})]})}),r.jsx(ie,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(xs,{className:"h-4 w-4"}),r.jsxs("span",{children:[u.course.duration_min," min"]})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(C0,{className:"h-4 w-4"}),r.jsxs("span",{children:[u.course.credits," credits"]})]})]}),r.jsxs(se,{size:"sm",children:[r.jsx(od,{className:"h-4 w-4 mr-2"}),"Start Course"]})]})})]},u.id))}),r.jsx(Nr,{value:"completed",className:"space-y-4",children:i.length===0?r.jsxs(J,{className:"p-12 text-center",children:[r.jsx(Kh,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),r.jsx("p",{className:"text-lg font-medium",children:"No completed courses"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Complete your enrolled courses to earn certificates"})]}):i.map(u=>r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{children:[r.jsx(xe,{children:u.course.title}),r.jsxs(xr,{children:[u.course.domain," | ",u.course.code]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs(We,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[r.jsx(Kh,{className:"h-3 w-3 mr-1"}),"Completed"]}),u.final_score&&r.jsxs(We,{variant:"secondary",children:["Score: ",u.final_score,"%"]})]})]})}),r.jsx(ie,{children:r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsxs("span",{className:"text-muted-foreground",children:["Completed on ",new Date(u.completed_at).toLocaleDateString()]}),r.jsx(se,{size:"sm",variant:"outline",children:"View Certificate"})]})})]},u.id))})]})]})}async function m$e(e,t){const n=new URLSearchParams;e&&n.append("category",e),t&&n.append("search",t);const s=await fetch(`/api/v1/training/kb?${n}`,{credentials:"include"});if(!s.ok)throw new Error("Failed to fetch articles");return s.json()}async function p$e(){const e=await fetch("/api/v1/training/kb/popular",{credentials:"include"});if(!e.ok)throw new Error("Failed to fetch popular articles");return e.json()}function g$e(){const[e,t]=R.useState(""),[n,s]=R.useState(""),{data:i,isLoading:c}=ht({queryKey:["kb-articles",n,e],queryFn:()=>m$e(n,e),staleTime:6e4}),{data:u}=ht({queryKey:["kb-popular"],queryFn:p$e,staleTime:3e5}),a=(i==null?void 0:i.data)||[],m=u||[],p=[{value:"",label:"All Categories"},{value:"Assets",label:"Assets"},{value:"Treatment",label:"Treatment"},{value:"Safety",label:"Safety"},{value:"Customer",label:"Customer"},{value:"Finance",label:"Finance"},{value:"IT",label:"IT"}];return r.jsxs("div",{className:"container mx-auto p-6",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Knowledge Base"}),r.jsx("p",{className:"text-muted-foreground",children:"Browse articles, guides, and documentation"})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[r.jsx("div",{className:"flex gap-4",children:r.jsxs("div",{className:"flex-1 relative",children:[r.jsx(ci,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Search knowledge base...",value:e,onChange:y=>t(y.target.value),className:"pl-10"})]})}),r.jsx(qs,{value:n,onValueChange:s,children:r.jsx(As,{className:"w-full justify-start overflow-x-auto",children:p.map(y=>r.jsx(sr,{value:y.value,children:y.label},y.value))})}),c?r.jsx("div",{className:"text-center py-12",children:"Loading articles..."}):a.length===0?r.jsxs(J,{className:"p-12 text-center",children:[r.jsx(is,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),r.jsx("p",{className:"text-lg font-medium",children:"No articles found"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Try adjusting your search or category filter"})]}):r.jsx("div",{className:"space-y-4",children:a.map(y=>r.jsxs(J,{className:"hover:shadow-lg transition-shadow cursor-pointer",children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx(xe,{className:"text-lg mb-2",children:y.title}),r.jsxs(xr,{children:["By ",y.author.name," "," ",new Date(y.published_at).toLocaleDateString()]})]}),r.jsx(We,{variant:"outline",children:y.category})]})}),r.jsx(ie,{children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("p",{className:"text-sm text-muted-foreground line-clamp-2",children:[y.content.substring(0,200),"..."]}),r.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(Lm,{className:"h-4 w-4"}),r.jsxs("span",{children:[y.views_count," views"]})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(tV,{className:"h-4 w-4"}),r.jsx("span",{children:y.helpful_count})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(nne,{className:"h-4 w-4"}),r.jsx("span",{children:y.not_helpful_count})]})]}),y.tags&&y.tags.length>0&&r.jsx("div",{className:"flex flex-wrap gap-2",children:y.tags.map(v=>r.jsx(We,{variant:"secondary",className:"text-xs",children:v},v))})]})})]},y.id))})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx($s,{className:"h-5 w-5"}),"Popular Articles"]})}),r.jsx(ie,{children:r.jsx("div",{className:"space-y-3",children:m.slice(0,5).map(y=>r.jsxs("div",{className:"pb-3 border-b last:border-0 last:pb-0 cursor-pointer hover:bg-muted/50 p-2 rounded-md transition-colors",children:[r.jsx("p",{className:"font-medium text-sm line-clamp-2 mb-1",children:y.title}),r.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[r.jsx(Lm,{className:"h-3 w-3"}),r.jsxs("span",{children:[y.views_count," views"]})]})]},y.id))})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Need Help?"})}),r.jsxs(ie,{children:[r.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Can't find what you're looking for?"}),r.jsx(se,{className:"w-full",variant:"outline",children:"Submit a Question"})]})]})]})]})]})}async function x$e(e){const t=new URLSearchParams({status:"published"});e&&t.append("search",e);const n=await fetch(`/api/v1/training/sops?${t}`,{credentials:"include"});if(!n.ok)throw new Error("Failed to fetch SOPs");return n.json()}async function y$e(e){const t=await fetch(`/api/v1/training/sops/${e}/attest`,{method:"POST",credentials:"include"});if(!t.ok)throw new Error("Failed to attest SOP");return t.json()}function v$e(){const[e,t]=R.useState(""),n=br(),{data:s,isLoading:i}=ht({queryKey:["sops",e],queryFn:()=>x$e(e),staleTime:6e4}),c=jt({mutationFn:y$e,onSuccess:()=>{n.invalidateQueries({queryKey:["sops"]})}}),u=(s==null?void 0:s.data)||[],a=(m,p)=>{var y;return((y=m.attestations)==null?void 0:y.some(v=>v.user_id===p))||!1};return r.jsxs("div",{className:"container mx-auto p-6",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Standard Operating Procedures"}),r.jsx("p",{className:"text-muted-foreground",children:"Access and attest to organizational SOPs"})]}),r.jsx("div",{className:"mb-6",children:r.jsxs("div",{className:"relative max-w-md",children:[r.jsx(ci,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),r.jsx(Ge,{placeholder:"Search SOPs...",value:e,onChange:m=>t(m.target.value),className:"pl-10"})]})}),i?r.jsx("div",{className:"text-center py-12",children:"Loading SOPs..."}):u.length===0?r.jsxs(J,{className:"p-12 text-center",children:[r.jsx(is,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),r.jsx("p",{className:"text-lg font-medium",children:"No SOPs found"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Try adjusting your search terms"})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(m=>{const p=m.next_review_due&&new Date(m.next_review_due)<new Date;return r.jsxs(J,{className:"hover:shadow-lg transition-shadow",children:[r.jsxs(ge,{children:[r.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[r.jsxs("div",{children:[r.jsx(xe,{className:"text-lg",children:m.title}),r.jsx(xr,{className:"mt-1",children:m.code})]}),r.jsxs(We,{variant:"outline",children:["v",m.version]})]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsx(We,{variant:"secondary",children:m.category}),p&&r.jsxs(We,{variant:"destructive",children:[r.jsx(ei,{className:"h-3 w-3 mr-1"}),"Review Due"]})]})]}),r.jsx(ie,{children:r.jsxs("div",{className:"space-y-3",children:[m.published_at&&r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Published: ",new Date(m.published_at).toLocaleDateString()]}),m.next_review_due&&r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Next Review: ",new Date(m.next_review_due).toLocaleDateString()]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(se,{size:"sm",variant:"outline",className:"flex-1",children:[r.jsx(Lm,{className:"h-4 w-4 mr-2"}),"View SOP"]}),!a(m,1)&&r.jsxs(se,{size:"sm",onClick:()=>c.mutate(m.id),disabled:c.isPending,children:[r.jsx(os,{className:"h-4 w-4 mr-2"}),"Attest"]}),a(m,1)&&r.jsxs(We,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[r.jsx(os,{className:"h-3 w-3 mr-1"}),"Attested"]})]})]})})]},m.id)})})]})}async function _$e(){const e=await fetch("/api/v1/training/skills/matrix",{credentials:"include"});if(!e.ok)throw new Error("Failed to fetch skills matrix");return e.json()}async function b$e(e){const t=new URLSearchParams,n=await fetch(`/api/v1/training/employee-skills?${t}`,{credentials:"include"});if(!n.ok)throw new Error("Failed to fetch employee skills");return n.json()}function j$e(){const[e,t]=R.useState("matrix"),[n,s]=R.useState("all"),{data:i,isLoading:c}=ht({queryKey:["skills-matrix"],queryFn:_$e,enabled:e==="matrix",staleTime:6e4}),{data:u,isLoading:a}=ht({queryKey:["employee-skills"],queryFn:()=>b$e(),enabled:e==="individual",staleTime:6e4}),m=p=>{const y=["bg-red-100 text-red-800","bg-yellow-100 text-yellow-800","bg-blue-100 text-blue-800","bg-green-100 text-green-800"];return y[p]||y[0]};return r.jsxs("div",{className:"container mx-auto p-6",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Skills Matrix"}),r.jsx("p",{className:"text-muted-foreground",children:"Track and assess employee competencies"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(se,{variant:e==="matrix"?"default":"outline",onClick:()=>t("matrix"),children:[r.jsx(Pi,{className:"h-4 w-4 mr-2"}),"Team Matrix"]}),r.jsxs(se,{variant:e==="individual"?"default":"outline",onClick:()=>t("individual"),children:[r.jsx(Zg,{className:"h-4 w-4 mr-2"}),"My Skills"]})]}),r.jsxs(Jt,{value:n,onValueChange:s,children:[r.jsx(Yt,{className:"w-48",children:r.jsx(er,{placeholder:"Filter by category"})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Categories"}),r.jsx(ke,{value:"technical",children:"Technical"}),r.jsx(ke,{value:"safety",children:"Safety"}),r.jsx(ke,{value:"customer",children:"Customer Service"}),r.jsx(ke,{value:"leadership",children:"Leadership"})]})]})]}),e==="matrix"&&r.jsx(r.Fragment,{children:c?r.jsx("div",{className:"text-center py-12",children:"Loading matrix..."}):r.jsx("div",{className:"space-y-6",children:i==null?void 0:i.map(p=>{const y=p.skill,v=p.employees;return n!=="all"&&y.category!==n?null:r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{children:[r.jsx(xe,{children:y.name}),r.jsx(xr,{children:y.code})]}),r.jsx(We,{variant:"outline",children:y.category})]})}),r.jsx(ie,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"flex gap-2",children:y.levels.map((j,S)=>r.jsx(We,{className:m(S),children:j},S))}),v.length>0?r.jsx("div",{className:"space-y-2",children:v.map((j,S)=>r.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-md",children:[r.jsx("span",{className:"font-medium",children:j.user.name}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(We,{className:m(j.level_index),children:j.level_name}),r.jsxs("span",{className:"text-sm text-muted-foreground",children:["Assessed: ",new Date(j.assessed_at).toLocaleDateString()]})]})]},S))}):r.jsx("p",{className:"text-sm text-muted-foreground",children:"No employees assessed for this skill"})]})})]},y.id)})})}),e==="individual"&&r.jsx(r.Fragment,{children:a?r.jsx("div",{className:"text-center py-12",children:"Loading your skills..."}):u&&u.length>0?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(p=>r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{className:"text-lg",children:p.skill.name}),r.jsx(xr,{children:p.skill.category})]}),r.jsx(ie,{children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Current Level"}),r.jsx(We,{className:m(p.level_index),children:p.skill.levels[p.level_index]})]}),r.jsxs("div",{children:[r.jsxs("p",{className:"text-sm text-muted-foreground",children:["Assessed: ",new Date(p.assessed_at).toLocaleDateString()]}),p.assessor&&r.jsxs("p",{className:"text-sm text-muted-foreground",children:["By: ",p.assessor.name]})]})]})})]},p.id))}):r.jsxs(J,{className:"p-12 text-center",children:[r.jsx(Zg,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),r.jsx("p",{className:"text-lg font-medium",children:"No skills assessed"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Contact your supervisor to get your skills assessed"})]})})]})}function w$e(){return r.jsxs("div",{className:"container mx-auto p-6",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold",children:"My Certificates"}),r.jsx("p",{className:"text-muted-foreground",children:"View and download your training certificates"})]}),r.jsxs(J,{className:"p-12 text-center",children:[r.jsx(C0,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground"}),r.jsx("p",{className:"text-lg font-medium mb-2",children:"Certificates Coming Soon"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Complete courses to earn certificates that will appear here"})]})]})}function S$e(){return r.jsxs("div",{className:"flex min-h-screen",children:[r.jsx(za,{}),r.jsx("main",{className:"flex-1 p-8 overflow-auto",children:r.jsx(Fa,{})})]})}function N$e(){var V,K,te;const[e,t]=R.useState({entity_type:"scheme",entity_id:"",metric:"production",horizon_days:30,model_family:"auto",seasonality:!0,holdout_pct:20,exogenous_drivers:[]}),[n,s]=R.useState(""),[i,c]=R.useState(null),{data:u,isLoading:a,error:m}=ht({queryKey:["schemes"],queryFn:async()=>(await me.get("/api/v1/schemes")).data.data}),{data:p,isLoading:y,error:v,refetch:j}=ht({queryKey:["forecast-jobs"],queryFn:async()=>(await me.get("/api/v1/dsa/forecast")).data.data}),{data:S,isLoading:k,error:N}=ht({queryKey:["forecast-job",i],queryFn:async()=>i?(await me.get(`/api/v1/dsa/forecast/${i}`)).data:null,enabled:!!i}),D=jt({mutationFn:async X=>(await me.post("/api/v1/dsa/forecast",X)).data,onSuccess:X=>{qe.success("Forecast job started successfully"),c(X.id),j()},onError:()=>{qe.error("Failed to start forecast job")}}),O=()=>{n.trim()&&!e.exogenous_drivers.includes(n.trim())&&(t({...e,exogenous_drivers:[...e.exogenous_drivers,n.trim()]}),s(""))},T=X=>{t({...e,exogenous_drivers:e.exogenous_drivers.filter(ve=>ve!==X)})},I=()=>{D.mutate(e)},z=()=>{if(!S)return;const X=[["Date","Type","Value","Lower_80","Upper_80","Lower_95","Upper_95"],...S.historical.map(Oe=>[Oe.date,"Historical",Oe.actual,"","","",""]),...S.forecast.map(Oe=>[Oe.date,"Forecast",Oe.predicted,Oe.lower_80,Oe.upper_80,Oe.lower_95,Oe.upper_95])].map(Oe=>Oe.join(",")).join(`
`),ve=new Blob([X],{type:"text/csv"}),ae=URL.createObjectURL(ve),pe=document.createElement("a");pe.href=ae,pe.download=`forecast_${i}.csv`,pe.click(),qe.success("Forecast exported to CSV")},$=p==null?void 0:p.find(X=>X.id===i);return r.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Forecast Studio"}),r.jsx("p",{className:"text-muted-foreground",children:"Time-series forecasting with ML models and confidence intervals"})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs(J,{className:"lg:col-span-1",children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Forecast Configuration"}),r.jsx(xr,{children:"Define parameters for time-series forecasting"})]}),r.jsxs(ie,{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{children:"Entity Type"}),r.jsxs(Jt,{value:e.entity_type,onValueChange:X=>t({...e,entity_type:X}),children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"scheme",children:"Scheme"}),r.jsx(ke,{value:"dma",children:"DMA"}),r.jsx(ke,{value:"meter_class",children:"Meter Class"}),r.jsx(ke,{value:"customer_segment",children:"Customer Segment"})]})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Entity Selection"}),r.jsxs(Jt,{value:e.entity_id,onValueChange:X=>t({...e,entity_id:X}),children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select entity..."})}),r.jsx(Xt,{children:u==null?void 0:u.map(X=>r.jsx(ke,{value:X.id,children:X.name},X.id))})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Metric"}),r.jsxs(Jt,{value:e.metric,onValueChange:X=>t({...e,metric:X}),children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"production",children:"Production Volume"}),r.jsx(ke,{value:"demand",children:"Demand"}),r.jsx(ke,{value:"revenue",children:"Revenue"}),r.jsx(ke,{value:"chemicals",children:"Chemicals Usage"}),r.jsx(ke,{value:"energy_cost",children:"Energy Cost"})]})]})]}),r.jsxs("div",{children:[r.jsxs(Ne,{children:["Forecast Horizon (days): ",e.horizon_days]}),r.jsx(Vm,{value:[e.horizon_days],onValueChange:([X])=>t({...e,horizon_days:X}),min:7,max:365,step:1})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Model Family"}),r.jsxs(Jt,{value:e.model_family,onValueChange:X=>t({...e,model_family:X}),children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"auto",children:"Auto (Best Model)"}),r.jsx(ke,{value:"arima",children:"ARIMA"}),r.jsx(ke,{value:"ets",children:"ETS (Exponential Smoothing)"}),r.jsx(ke,{value:"prophet",children:"Prophet"}),r.jsx(ke,{value:"lstm",children:"LSTM Neural Network"})]})]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(Ne,{children:"Seasonality Detection"}),r.jsx(Ay,{checked:e.seasonality,onCheckedChange:X=>t({...e,seasonality:X})})]}),r.jsxs("div",{children:[r.jsxs(Ne,{children:["Holdout Set (%): ",e.holdout_pct,"%"]}),r.jsx(Vm,{value:[e.holdout_pct],onValueChange:([X])=>t({...e,holdout_pct:X}),min:10,max:30,step:5})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Exogenous Drivers"}),r.jsxs("div",{className:"flex gap-2 mb-2",children:[r.jsx(Ge,{placeholder:"e.g., rainfall, temperature, holidays",value:n,onChange:X=>s(X.target.value),onKeyPress:X=>X.key==="Enter"&&O()}),r.jsx(se,{size:"sm",onClick:O,children:"Add"})]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:e.exogenous_drivers.map(X=>r.jsxs(We,{variant:"secondary",className:"flex items-center gap-1",children:[X,r.jsx(jy,{className:"h-3 w-3 cursor-pointer",onClick:()=>T(X)})]},X))})]}),r.jsxs(se,{className:"w-full",onClick:I,disabled:!e.entity_id||D.isPending,children:[r.jsx(od,{className:"h-4 w-4 mr-2"}),D.isPending?"Starting...":"Run Forecast"]})]})]}),r.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Recent Forecast Jobs"})}),r.jsx(ie,{children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Metric"}),r.jsx(le,{children:"Model"}),r.jsx(le,{children:"Horizon"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"MAPE"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:p==null?void 0:p.slice(0,10).map(X=>{var ve,ae;return r.jsxs(lt,{className:i===X.id?"bg-muted":"",children:[r.jsx(ne,{className:"font-medium",children:X.metric}),r.jsx(ne,{children:X.model_family.toUpperCase()}),r.jsxs(ne,{children:[X.horizon_days,"d"]}),r.jsx(ne,{children:r.jsx(We,{variant:X.status==="completed"?"default":X.status==="failed"?"destructive":"secondary",children:X.status})}),r.jsxs(ne,{children:[(ae=(ve=X.scores)==null?void 0:ve.mape)==null?void 0:ae.toFixed(2),"%"]}),r.jsx(ne,{children:r.jsx(se,{size:"sm",variant:"ghost",onClick:()=>c(X.id),disabled:X.status!=="completed",children:"View"})})]},X.id)})})]})})]}),i&&k&&r.jsx(J,{children:r.jsxs(ie,{className:"py-12 text-center",children:[r.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Loading forecast results..."})]})}),i&&N&&r.jsx(J,{children:r.jsx(ie,{className:"py-12 text-center text-destructive",children:r.jsxs("p",{children:["Error loading forecast: ",N.message]})})}),$&&S&&S.historical&&S.forecast&&r.jsxs(r.Fragment,{children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx(xe,{children:"Forecast Results"}),r.jsxs(xr,{children:[$.metric," forecast for ",$.horizon_days," days"]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(se,{size:"sm",variant:"outline",onClick:z,children:[r.jsx(rl,{className:"h-4 w-4 mr-2"}),"Export CSV"]}),r.jsxs(se,{size:"sm",variant:"outline",children:[r.jsx(RO,{className:"h-4 w-4 mr-2"}),"Save Baseline"]})]})]})}),r.jsx(ie,{children:r.jsxs(qs,{defaultValue:"chart",children:[r.jsxs(As,{children:[r.jsx(sr,{value:"chart",children:"Forecast Chart"}),r.jsx(sr,{value:"errors",children:"Error Metrics"}),r.jsx(sr,{value:"model",children:"Model Card"})]}),r.jsx(Nr,{value:"chart",className:"h-[400px]",children:r.jsx(Da,{width:"100%",height:"100%",children:r.jsxs(kH,{data:[...S.historical,...S.forecast],children:[r.jsx(wo,{strokeDasharray:"3 3"}),r.jsx(aa,{dataKey:"date"}),r.jsx(Mi,{}),r.jsx(Ds,{}),r.jsx(sa,{}),r.jsx(ru,{type:"monotone",dataKey:"upper_95",stackId:"1",stroke:"transparent",fill:"#e0e7ff",fillOpacity:.3}),r.jsx(ru,{type:"monotone",dataKey:"upper_80",stackId:"2",stroke:"transparent",fill:"#c7d2fe",fillOpacity:.4}),r.jsx(Xo,{type:"monotone",dataKey:"actual",stroke:"#3b82f6",strokeWidth:2,dot:!1}),r.jsx(Xo,{type:"monotone",dataKey:"predicted",stroke:"#10b981",strokeWidth:2,strokeDasharray:"5 5",dot:!1})]})})}),r.jsx(Nr,{value:"errors",children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Metric"}),r.jsx(le,{children:"Value"}),r.jsx(le,{children:"Interpretation"})]})}),r.jsxs(ur,{children:[r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:"MAE (Mean Absolute Error)"}),r.jsx(ne,{children:(V=$.scores)==null?void 0:V.mae.toFixed(2)}),r.jsx(ne,{className:"text-sm text-muted-foreground",children:"Average absolute deviation"})]}),r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:"RMSE (Root Mean Squared Error)"}),r.jsx(ne,{children:(K=$.scores)==null?void 0:K.rmse.toFixed(2)}),r.jsx(ne,{className:"text-sm text-muted-foreground",children:"Penalizes larger errors"})]}),r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:"MAPE (Mean Absolute % Error)"}),r.jsxs(ne,{children:[(te=$.scores)==null?void 0:te.mape.toFixed(2),"%"]}),r.jsx(ne,{children:r.jsx(We,{variant:$.scores.mape<10?"default":$.scores.mape<20?"secondary":"destructive",children:$.scores.mape<10?"Excellent":$.scores.mape<20?"Good":"Needs Improvement"})})]})]})]})}),r.jsxs(Nr,{value:"model",className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-2",children:"Model Information"}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-muted-foreground",children:"Model Name"}),r.jsx("p",{className:"font-medium",children:S.model_card.name})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-muted-foreground",children:"Version"}),r.jsx("p",{className:"font-medium",children:S.model_card.version})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-muted-foreground",children:"Training Window"}),r.jsx("p",{className:"font-medium",children:S.model_card.training_window})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-muted-foreground",children:"Features Used"}),r.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:S.model_card.features_used.map(X=>r.jsx(We,{variant:"outline",className:"text-xs",children:X},X))})]})]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-2",children:"Hyperparameters"}),r.jsx("div",{className:"bg-muted p-3 rounded-md",children:r.jsx("pre",{className:"text-xs overflow-auto",children:JSON.stringify(S.model_card.hyperparameters,null,2)})})]})]})]})})]}),$.scores&&$.scores.mape>20&&r.jsxs(Wi,{children:[r.jsx(ei,{className:"h-4 w-4"}),r.jsxs(ki,{children:[r.jsx("strong",{children:"Model Accuracy Alert:"})," MAPE is ",$.scores.mape.toFixed(1),"%. Consider adding more exogenous drivers or trying a different model family."]})]})]})]})]})]})}function P$e(){const[e,t]=R.useState({name:"",type:"drought",scheme_id:"",period_start:new Date,period_end:new Date(Date.now()+2592e6),severity:50,monte_carlo_runs:100,params:{}}),[n,s]=R.useState([]),[i,c]=R.useState(null),{data:u,isLoading:a,error:m}=ht({queryKey:["schemes"],queryFn:async()=>(await me.get("/api/v1/schemes")).data.data}),{data:p,isLoading:y,error:v,refetch:j}=ht({queryKey:["scenarios"],queryFn:async()=>(await me.get("/api/v1/dsa/scenarios")).data.data}),S=jt({mutationFn:async $=>(await me.post(`/api/v1/dsa/scenarios/${$}/run`)).data,onSuccess:()=>{qe.success("Scenario simulation started"),j()},onError:()=>{qe.error("Failed to run scenario")}}),k=jt({mutationFn:async $=>(await me.post("/api/v1/dsa/scenarios",{...$,playbook:n})).data,onSuccess:()=>{qe.success("Scenario created successfully"),j(),t({name:"",type:"drought",scheme_id:"",period_start:new Date,period_end:new Date(Date.now()+30*24*60*60*1e3),severity:50,monte_carlo_runs:100,params:{}}),s([])},onError:()=>{qe.error("Failed to create scenario")}}),N=()=>{s([...n,{action:"",owner:"",trigger:"",lead_time:24,impact:""}])},D=$=>{s(n.filter((V,K)=>K!==$))},O=($,V,K)=>{const te=[...n];te[$]={...te[$],[V]:K},s(te)},T=p==null?void 0:p.find($=>$.id===i),I=T!=null&&T.results?[{metric:"Deficit",baseline:0,scenario:T.results.deficit_m3d},{metric:"Continuity",baseline:24,scenario:T.results.continuity_hrs},{metric:"Cost Impact",baseline:100,scenario:100+T.results.cost_impact},{metric:"Service Level",baseline:100,scenario:100-T.results.service_deficit_pct}]:[],z=[{kpi:"Supply",value:85,fullMark:100},{kpi:"Pressure",value:70,fullMark:100},{kpi:"Quality",value:90,fullMark:100},{kpi:"Cost",value:60,fullMark:100},{kpi:"Reliability",value:75,fullMark:100}];return r.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Scenario Workbench"}),r.jsx("p",{className:"text-muted-foreground",children:"Design and simulate stress tests for resilience planning"})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs(J,{className:"lg:col-span-1",children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Scenario Builder"}),r.jsx(xr,{children:"Define parameters for stress testing"})]}),r.jsxs(ie,{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{children:"Scenario Name"}),r.jsx(Ge,{value:e.name,onChange:$=>t({...e,name:$.target.value}),placeholder:"e.g., Severe Drought 2025"})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Type"}),r.jsxs(Jt,{value:e.type,onValueChange:$=>t({...e,type:$}),children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"drought",children:"Drought"}),r.jsx(ke,{value:"demand_spike",children:"Demand Spike"}),r.jsx(ke,{value:"contamination",children:"Contamination"}),r.jsx(ke,{value:"power_shock",children:"Power Price Shock"}),r.jsx(ke,{value:"asset_failure",children:"Asset Failure"}),r.jsx(ke,{value:"custom",children:"Custom"})]})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Scheme"}),r.jsxs(Jt,{value:e.scheme_id,onValueChange:$=>t({...e,scheme_id:$}),children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select scheme..."})}),r.jsx(Xt,{children:u==null?void 0:u.map($=>r.jsx(ke,{value:$.id,children:$.name},$.id))})]})]}),r.jsxs("div",{children:[r.jsxs(Ne,{children:["Severity: ",e.severity,"%"]}),r.jsx(Vm,{value:[e.severity],onValueChange:([$])=>t({...e,severity:$}),min:0,max:100,step:5})]}),r.jsxs("div",{children:[r.jsxs(Ne,{children:["Monte Carlo Runs: ",e.monte_carlo_runs]}),r.jsx(Vm,{value:[e.monte_carlo_runs],onValueChange:([$])=>t({...e,monte_carlo_runs:$}),min:10,max:1e3,step:10})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Playbook Steps"}),r.jsxs("div",{className:"space-y-2 mt-2",children:[n.map(($,V)=>r.jsxs("div",{className:"p-3 border rounded-md space-y-2",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("span",{className:"text-sm font-medium",children:["Step ",V+1]}),r.jsx(se,{size:"sm",variant:"ghost",onClick:()=>D(V),children:r.jsx(Oi,{className:"h-4 w-4"})})]}),r.jsx(Ge,{placeholder:"Action",value:$.action,onChange:K=>O(V,"action",K.target.value)}),r.jsx(Ge,{placeholder:"Owner",value:$.owner,onChange:K=>O(V,"owner",K.target.value)})]},V)),r.jsx(se,{size:"sm",variant:"outline",onClick:N,className:"w-full",children:"Add Playbook Step"})]})]}),r.jsx(se,{className:"w-full",onClick:()=>k.mutate(e),disabled:!e.name||!e.scheme_id||k.isPending,children:"Create Scenario"})]})]}),r.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Scenario Library"})}),r.jsx(ie,{children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Name"}),r.jsx(le,{children:"Type"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Deficit (m/d)"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:p==null?void 0:p.map($=>{var V,K;return r.jsxs(lt,{className:i===$.id?"bg-muted":"",onClick:()=>c($.id),children:[r.jsx(ne,{className:"font-medium",children:$.name}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:$.type})}),r.jsx(ne,{children:r.jsx(We,{variant:$.status==="completed"?"default":$.status==="running"?"secondary":"outline",children:$.status})}),r.jsx(ne,{children:((K=(V=$.results)==null?void 0:V.deficit_m3d)==null?void 0:K.toFixed(1))||"-"}),r.jsx(ne,{children:r.jsx(se,{size:"sm",variant:"ghost",onClick:te=>{te.stopPropagation(),S.mutate($.id)},disabled:$.status==="running",children:r.jsx(od,{className:"h-4 w-4"})})})]},$.id)})})]})})]}),T&&T.status==="completed"&&r.jsxs(J,{children:[r.jsx(ge,{children:r.jsxs(xe,{children:["Scenario Results: ",T.name]})}),r.jsx(ie,{children:r.jsxs(qs,{defaultValue:"kpis",children:[r.jsxs(As,{children:[r.jsx(sr,{value:"kpis",children:"KPIs"}),r.jsx(sr,{value:"comparison",children:"Comparison"}),r.jsx(sr,{value:"radar",children:"Multi-KPI Radar"})]}),r.jsx(Nr,{value:"kpis",className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"p-4 border rounded-md",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Supply Deficit"}),r.jsxs("p",{className:"text-2xl font-bold",children:[T.results.deficit_m3d.toFixed(0)," m/d"]})]}),r.jsxs("div",{className:"p-4 border rounded-md",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Continuity"}),r.jsxs("p",{className:"text-2xl font-bold",children:[T.results.continuity_hrs.toFixed(1)," hrs/day"]})]}),r.jsxs("div",{className:"p-4 border rounded-md",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Cost Impact"}),r.jsxs("p",{className:"text-2xl font-bold",children:[T.results.cost_impact>0?"+":"",T.results.cost_impact.toFixed(0),"%"]})]}),r.jsxs("div",{className:"p-4 border rounded-md",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Service Deficit"}),r.jsxs("p",{className:"text-2xl font-bold",children:[T.results.service_deficit_pct.toFixed(1),"%"]})]})]})}),r.jsx(Nr,{value:"comparison",className:"h-[300px]",children:r.jsx(Da,{width:"100%",height:"100%",children:r.jsxs(hy,{data:I,children:[r.jsx(wo,{strokeDasharray:"3 3"}),r.jsx(aa,{dataKey:"metric"}),r.jsx(Mi,{}),r.jsx(Ds,{}),r.jsx(sa,{}),r.jsx(Ia,{dataKey:"baseline",fill:"#10b981",name:"Baseline"}),r.jsx(Ia,{dataKey:"scenario",fill:"#ef4444",name:"Scenario"})]})})}),r.jsx(Nr,{value:"radar",className:"h-[300px]",children:r.jsx(Da,{width:"100%",height:"100%",children:r.jsxs(zLe,{data:z,children:[r.jsx(SK,{}),r.jsx(Ky,{dataKey:"kpi"}),r.jsx(Gy,{angle:90,domain:[0,100]}),r.jsx(Hb,{name:"Performance",dataKey:"value",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.6}),r.jsx(sa,{})]})})})]})})]})]})]})]})}function C$e(){var N,D,O;const[e,t]=R.useState("pumps"),[n,s]=R.useState({scheme_id:"",asset_ids:[],target_volume_m3:5e3,objective:"minimize_energy_cost"}),{data:i,isLoading:c,error:u}=ht({queryKey:["schemes"],queryFn:async()=>(await me.get("/api/v1/schemes")).data.data}),{data:a,isLoading:m}=ht({queryKey:["pumps",n.scheme_id],queryFn:async()=>n.scheme_id?(await me.get(`/api/v1/assets?scheme_id=${n.scheme_id}&kind=pump`)).data.data:[],enabled:!!n.scheme_id}),{data:p,isLoading:y,error:v,refetch:j}=ht({queryKey:["optim-runs",e],queryFn:async()=>(await me.get(`/api/v1/dsa/optimize?type=${e}`)).data.data}),S=jt({mutationFn:async T=>{const I=`/api/v1/dsa/optimize/${e}`;return(await me.post(I,T)).data},onSuccess:()=>{qe.success("Optimization started successfully"),j()},onError:()=>{qe.error("Failed to start optimization")}}),k=jt({mutationFn:async T=>(await me.post(`/api/v1/dsa/optimize/${T}/publish`)).data,onSuccess:()=>{qe.success("Plan published to CoreOps successfully"),j()},onError:()=>{qe.error("Failed to publish plan")}});return r.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Optimization Console"}),r.jsx("p",{className:"text-muted-foreground",children:"AI-powered optimization for pumps, valves, dosing, and logistics"})]}),r.jsxs(qs,{value:e,onValueChange:T=>t(T),children:[r.jsxs(As,{className:"grid w-full grid-cols-4",children:[r.jsx(sr,{value:"pumps",children:"Pump Scheduling"}),r.jsx(sr,{value:"valves",children:"Valve Settings"}),r.jsx(sr,{value:"dosing",children:"Chlorine Dosing"}),r.jsx(sr,{value:"logistics",children:"Logistics"})]}),r.jsx(Nr,{value:"pumps",className:"space-y-6",children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Configuration"}),r.jsx(xr,{children:"Set optimization parameters"})]}),r.jsxs(ie,{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{children:"Scheme"}),r.jsxs(Jt,{value:n.scheme_id,onValueChange:T=>s({...n,scheme_id:T}),children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select scheme..."})}),r.jsx(Xt,{children:i==null?void 0:i.map(T=>r.jsx(ke,{value:T.id,children:T.name},T.id))})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Pumps"}),r.jsxs(Jt,{children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Select pumps..."})}),r.jsx(Xt,{children:a==null?void 0:a.map(T=>r.jsx(ke,{value:T.id,children:T.name},T.id))})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Target Volume (m)"}),r.jsx(Ge,{type:"number",value:n.target_volume_m3,onChange:T=>s({...n,target_volume_m3:parseInt(T.target.value)})})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Objective"}),r.jsxs(Jt,{value:n.objective,onValueChange:T=>s({...n,objective:T}),children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"minimize_energy_cost",children:"Minimize Energy Cost"}),r.jsx(ke,{value:"minimize_peak_demand",children:"Minimize Peak Demand"}),r.jsx(ke,{value:"maximize_storage",children:"Maximize Storage"})]})]})]}),r.jsxs(se,{className:"w-full",onClick:()=>S.mutate(n),disabled:!n.scheme_id||S.isPending,children:[r.jsx(od,{className:"h-4 w-4 mr-2"}),"Run Optimization"]})]})]}),r.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Optimization Results"})}),r.jsx(ie,{children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Run"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Savings"}),r.jsx(le,{children:"Peak Hours Avoided"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:p==null?void 0:p.map(T=>{var I,z;return r.jsxs(lt,{children:[r.jsxs(ne,{className:"font-medium",children:["#",T.id.slice(0,8)]}),r.jsx(ne,{children:r.jsx(We,{variant:T.status==="completed"?"default":T.status==="failed"?"destructive":"secondary",children:T.status})}),r.jsx(ne,{children:(I=T.kpis)!=null&&I.savings?`${T.kpis.savings.toFixed(0)}%`:"-"}),r.jsx(ne,{children:((z=T.kpis)==null?void 0:z.peak_hours_avoided)||"-"}),r.jsx(ne,{children:r.jsxs(se,{size:"sm",variant:"ghost",onClick:()=>k.mutate(T.id),disabled:T.status!=="completed",children:[r.jsx(RO,{className:"h-4 w-4 mr-1"}),"Publish"]})})]},T.id)})})]})})]}),((N=p==null?void 0:p[0])==null?void 0:N.status)==="completed"&&((D=p[0].outputs)==null?void 0:D.windows)&&r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Optimized Schedule (Gantt)"})}),r.jsx(ie,{children:r.jsx("div",{className:"space-y-2",children:p[0].outputs.windows.map((T,I)=>r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"w-20 text-sm",children:[T.start_hour,":00"]}),r.jsxs("div",{className:"h-8 bg-blue-500 rounded flex items-center px-2 text-white text-sm",style:{width:`${T.duration_hours/24*100}%`},children:[T.duration_hours,"h"]}),r.jsxs("div",{className:"text-sm text-muted-foreground",children:[T.volume_m3.toFixed(0)," m"]})]},I))})})]}),((O=p==null?void 0:p[0])==null?void 0:O.status)==="completed"&&p[0].kpis&&r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(eo,{className:"h-5 w-5 text-green-500"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Cost Savings"}),r.jsxs("p",{className:"text-2xl font-bold",children:[p[0].kpis.savings.toFixed(0),"%"]})]})]})})}),r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(xs,{className:"h-5 w-5 text-blue-500"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Peak Hours Avoided"}),r.jsx("p",{className:"text-2xl font-bold",children:p[0].kpis.peak_hours_avoided})]})]})})}),r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(bo,{className:"h-5 w-5 text-yellow-500"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Efficiency"}),r.jsxs("p",{className:"text-2xl font-bold",children:[p[0].kpis.efficiency.toFixed(0),"%"]})]})]})})})]})]})]})}),r.jsx(Nr,{value:"valves",children:r.jsx(J,{children:r.jsx(ie,{className:"py-12 text-center text-muted-foreground",children:"Valve optimization configuration coming soon"})})}),r.jsx(Nr,{value:"dosing",children:r.jsx(J,{children:r.jsx(ie,{className:"py-12 text-center text-muted-foreground",children:"Chlorine dosing optimization configuration coming soon"})})}),r.jsx(Nr,{value:"logistics",children:r.jsx(J,{children:r.jsx(ie,{className:"py-12 text-center text-muted-foreground",children:"Logistics routing optimization configuration coming soon"})})})]})]})}function A$e(){var D,O;const[e,t]=R.useState({signal:"all",scheme_id:"",score_min:.5,status:"new"}),[n,s]=R.useState(new Set),[i,c]=R.useState(null),{data:u,isLoading:a,error:m,refetch:p}=ht({queryKey:["anomalies",e],queryFn:async()=>{const T=new URLSearchParams;return e.signal!=="all"&&T.append("signal",e.signal),e.scheme_id&&T.append("scheme_id",e.scheme_id),T.append("score_min",e.score_min.toString()),e.status!=="all"&&T.append("status",e.status),(await me.get(`/api/v1/dsa/anomalies?${T}`)).data.data}}),y=jt({mutationFn:async({ids:T,status:I})=>(await me.post("/api/v1/dsa/anomalies/bulk-update",{ids:T,status:I})).data,onSuccess:()=>{qe.success("Anomalies updated successfully"),s(new Set),p()}}),v=jt({mutationFn:async T=>(await me.post(`/api/v1/dsa/anomalies/${T}/create-work-order`)).data,onSuccess:()=>{qe.success("Work order created successfully"),p()}}),j=T=>{const I=new Set(n);I.has(T)?I.delete(T):I.add(T),s(I)},S=T=>{y.mutate({ids:Array.from(n),status:T})},k=u==null?void 0:u.find(T=>T.id===i),N=k?[{ts:"00:00",value:120,threshold:150},{ts:"04:00",value:125,threshold:150},{ts:"08:00",value:280,threshold:150},{ts:"12:00",value:130,threshold:150},{ts:"16:00",value:135,threshold:150},{ts:"20:00",value:128,threshold:150}]:[];return r.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Anomalies Inbox"}),r.jsx("p",{className:"text-muted-foreground",children:"ML-powered anomaly detection and triage"})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Filters"})}),r.jsx(ie,{children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsxs(Jt,{value:e.signal,onValueChange:T=>t({...e,signal:T}),children:[r.jsx(Yt,{children:r.jsx(er,{placeholder:"Signal type..."})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Signals"}),r.jsx(ke,{value:"flow",children:"Flow"}),r.jsx(ke,{value:"pressure",children:"Pressure"}),r.jsx(ke,{value:"consumption",children:"Consumption"}),r.jsx(ke,{value:"quality",children:"Quality"})]})]}),r.jsxs(Jt,{value:e.status,onValueChange:T=>t({...e,status:T}),children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"all",children:"All Status"}),r.jsx(ke,{value:"new",children:"New"}),r.jsx(ke,{value:"acknowledged",children:"Acknowledged"}),r.jsx(ke,{value:"investigating",children:"Investigating"}),r.jsx(ke,{value:"resolved",children:"Resolved"}),r.jsx(ke,{value:"false_positive",children:"False Positive"})]})]}),r.jsx(Ge,{type:"number",placeholder:"Min score (0-1)",value:e.score_min,onChange:T=>t({...e,score_min:parseFloat(T.target.value)}),step:"0.1",min:"0",max:"1"}),n.size>0&&r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(se,{size:"sm",variant:"outline",onClick:()=>S("acknowledged"),children:["Acknowledge (",n.size,")"]}),r.jsx(se,{size:"sm",variant:"outline",onClick:()=>S("false_positive"),children:"Mark False"})]})]})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Detected Anomalies"})}),r.jsx(ie,{children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{className:"w-12"}),r.jsx(le,{children:"Timestamp"}),r.jsx(le,{children:"Signal"}),r.jsx(le,{children:"Score"}),r.jsx(le,{children:"Pattern"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:u==null?void 0:u.map(T=>r.jsxs(lt,{className:i===T.id?"bg-muted":"",onClick:()=>c(T.id),children:[r.jsx(ne,{children:r.jsx(Ey,{checked:n.has(T.id),onCheckedChange:()=>j(T.id),onClick:I=>I.stopPropagation()})}),r.jsx(ne,{className:"text-sm",children:new Date(T.ts).toLocaleString()}),r.jsx(ne,{children:r.jsx(We,{variant:"outline",children:T.signal})}),r.jsx(ne,{children:r.jsx(We,{variant:T.score>.8?"destructive":T.score>.6?"default":"secondary",children:T.score.toFixed(2)})}),r.jsx(ne,{className:"text-sm",children:T.pattern}),r.jsx(ne,{children:r.jsx(se,{size:"sm",variant:"ghost",onClick:I=>{I.stopPropagation(),v.mutate(T.id)},children:r.jsx(Fm,{className:"h-4 w-4"})})})]},T.id))})]})})]}),r.jsx("div",{className:"space-y-6",children:k&&r.jsxs(r.Fragment,{children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Signal Explorer"})}),r.jsx(ie,{children:r.jsx("div",{className:"h-[300px]",children:r.jsx(Da,{width:"100%",height:"100%",children:r.jsxs(Yb,{data:N,children:[r.jsx(wo,{strokeDasharray:"3 3"}),r.jsx(aa,{dataKey:"ts"}),r.jsx(Mi,{}),r.jsx(Ds,{}),r.jsx(mP,{y:150,stroke:"red",strokeDasharray:"3 3",label:"Threshold"}),r.jsx(Xo,{type:"monotone",dataKey:"value",stroke:"#3b82f6",strokeWidth:2})]})})})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Triage Information"})}),r.jsxs(ie,{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx(gn,{className:"h-5 w-5 text-orange-500 mt-0.5"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:"Suspected Cause"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:((D=k.triage)==null?void 0:D.suspected_cause)||"Analyzing..."})]})]}),r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx(Kh,{className:"h-5 w-5 text-green-500 mt-0.5"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:"Suggested Action"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:((O=k.triage)==null?void 0:O.suggested_action)||"No recommendation"})]})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsx(se,{size:"sm",variant:"outline",onClick:()=>y.mutate({ids:[k.id],status:"acknowledged"}),children:"Acknowledge"}),r.jsx(se,{size:"sm",onClick:()=>v.mutate(k.id),children:"Create Work Order"})]})]})]})]})})]})]})}function k$e(){var N,D;const[e,t]=R.useState(""),[n,s]=R.useState(""),{data:i,isLoading:c,error:u}=ht({queryKey:["schemes"],queryFn:async()=>(await me.get("/api/v1/schemes")).data.data}),{data:a,isLoading:m,error:p}=ht({queryKey:["hydro-kpis",e],queryFn:async()=>{const O=e?`?scheme_id=${e}`:"";return(await me.get(`/api/v1/dsa/hydro/aquifers${O}`)).data.data}}),{data:y,isLoading:v}=ht({queryKey:["wellfield",e,n],queryFn:async()=>{const O=new URLSearchParams;return e&&O.append("scheme_id",e),n&&O.append("aquifer",n),(await me.get(`/api/v1/dsa/hydro/wellfield?${O}`)).data.data},enabled:!!e}),j=[{month:"Jan",recharge:45,abstraction:3200,storage:75},{month:"Feb",recharge:52,abstraction:3150,storage:78},{month:"Mar",recharge:38,abstraction:3300,storage:72},{month:"Apr",recharge:25,abstraction:3450,storage:65},{month:"May",recharge:15,abstraction:3600,storage:58},{month:"Jun",recharge:8,abstraction:3700,storage:52}],S=a==null?void 0:a[0],k=O=>O<.3?r.jsx(We,{variant:"default",children:"Low Risk"}):O<.6?r.jsx(We,{variant:"secondary",children:"Medium Risk"}):r.jsx(We,{variant:"destructive",children:"High Risk"});return r.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Aquifer Dashboard"}),r.jsx("p",{className:"text-muted-foreground",children:"Hydrogeological analytics and groundwater monitoring"})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs(Jt,{value:e,onValueChange:t,children:[r.jsx(Yt,{className:"w-[250px]",children:r.jsx(er,{placeholder:"Select scheme..."})}),r.jsx(Xt,{children:i==null?void 0:i.map(O=>r.jsx(ke,{value:O.id,children:O.name},O.id))})]}),r.jsxs(Jt,{value:n,onValueChange:s,children:[r.jsx(Yt,{className:"w-[250px]",children:r.jsx(er,{placeholder:"Select aquifer..."})}),r.jsx(Xt,{children:a==null?void 0:a.map(O=>r.jsx(ke,{value:O.aquifer_name,children:O.aquifer_name},O.aquifer_name))})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(ac,{className:"h-8 w-8 text-blue-500"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Recharge"}),r.jsxs("p",{className:"text-2xl font-bold",children:[((N=S==null?void 0:S.recharge_mm)==null?void 0:N.toFixed(0))||0," mm"]})]})]})})}),r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(eo,{className:"h-8 w-8 text-orange-500"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Abstraction"}),r.jsxs("p",{className:"text-2xl font-bold",children:[((D=S==null?void 0:S.abstraction_m3d)==null?void 0:D.toFixed(0))||0," m/d"]})]})]})})}),r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(Wo,{className:"h-8 w-8 text-green-500"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Storage Index"}),r.jsxs("p",{className:"text-2xl font-bold",children:[(((S==null?void 0:S.storage_index)||0)*100).toFixed(0),"%"]})]})]})})}),r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(ei,{className:"h-8 w-8 text-red-500"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Risk Score"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("p",{className:"text-2xl font-bold",children:[(((S==null?void 0:S.risk_score)||0)*100).toFixed(0),"%"]}),S&&k(S.risk_score)]})]})]})})})]}),r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Aquifer Balance Trends"}),r.jsx(xr,{children:"Recharge vs Abstraction over time"})]}),r.jsx(ie,{children:r.jsx("div",{className:"h-[300px]",children:r.jsx(Da,{width:"100%",height:"100%",children:r.jsxs(kH,{data:j,children:[r.jsx(wo,{strokeDasharray:"3 3"}),r.jsx(aa,{dataKey:"month"}),r.jsx(Mi,{yAxisId:"left"}),r.jsx(Mi,{yAxisId:"right",orientation:"right"}),r.jsx(Ds,{}),r.jsx(sa,{}),r.jsx(ru,{yAxisId:"left",type:"monotone",dataKey:"recharge",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.6,name:"Recharge (mm)"}),r.jsx(Xo,{yAxisId:"right",type:"monotone",dataKey:"abstraction",stroke:"#ef4444",strokeWidth:2,name:"Abstraction (m/d)"})]})})})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Wellfield Map"}),r.jsx(xr,{children:"Borehole locations and status"})]}),r.jsx(ie,{children:r.jsx("div",{className:"h-[400px] bg-muted rounded-md flex items-center justify-center",children:r.jsx("p",{className:"text-muted-foreground",children:"Map visualization placeholder"})})})]}),r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Cross-Section Profile"}),r.jsx(xr,{children:"Groundwater levels across wellfield"})]}),r.jsx(ie,{children:r.jsx("div",{className:"h-[400px]",children:r.jsx(Da,{width:"100%",height:"100%",children:r.jsxs(Yb,{data:[{well:"BH-1",wl:45,surface:100},{well:"BH-2",wl:38,surface:95},{well:"BH-3",wl:42,surface:98},{well:"BH-4",wl:35,surface:92},{well:"BH-5",wl:40,surface:97}],children:[r.jsx(wo,{strokeDasharray:"3 3"}),r.jsx(aa,{dataKey:"well"}),r.jsx(Mi,{}),r.jsx(Ds,{}),r.jsx(sa,{}),r.jsx(Xo,{type:"monotone",dataKey:"surface",stroke:"#94a3b8",strokeWidth:2,name:"Ground Surface"}),r.jsx(Xo,{type:"monotone",dataKey:"wl",stroke:"#3b82f6",strokeWidth:2,name:"Water Level"})]})})})})]})]})]})}function T$e(){const[e,t]=R.useState({name:"",scheme_id:"",lifeline_enabled:!0,fixed_charge:200,blocks:[{min:0,max:10,rate:25},{min:10,max:30,rate:50},{min:30,max:999,rate:75}],elasticity:.15}),{data:n,isLoading:s,error:i}=ht({queryKey:["schemes"],queryFn:async()=>(await me.get("/api/v1/schemes")).data.data}),{data:c,isLoading:u,error:a,refetch:m}=ht({queryKey:["tariff-scenarios"],queryFn:async()=>(await me.get("/api/v1/dsa/tariffs")).data.data}),p=jt({mutationFn:async k=>(await me.post("/api/v1/dsa/tariffs",k)).data,onSuccess:()=>{qe.success("Tariff simulation completed"),m()},onError:()=>{qe.error("Failed to run simulation")}}),y=(k,N,D)=>{const O=[...e.blocks];O[k]={...O[k],[N]:D},t({...e,blocks:O})},v=()=>{t({...e,blocks:[...e.blocks,{min:0,max:100,rate:50}]})},j=[{quintile:"Q1 (Poorest)",current:8,proposed:6},{quintile:"Q2",current:5,proposed:4},{quintile:"Q3",current:3,proposed:3},{quintile:"Q4",current:2,proposed:2},{quintile:"Q5 (Richest)",current:1,proposed:1.5}],S=[{category:"Residential",current:45e4,proposed:52e4},{category:"Commercial",current:28e4,proposed:295e3},{category:"Industrial",current:18e4,proposed:175e3}];return r.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Tariff Sandbox"}),r.jsx("p",{className:"text-muted-foreground",children:"Design and simulate tariff structures for equity analysis"})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs(J,{className:"lg:col-span-1",children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Tariff Design"}),r.jsx(xr,{children:"Configure tariff structure"})]}),r.jsxs(ie,{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{children:"Scenario Name"}),r.jsx(Ge,{value:e.name,onChange:k=>t({...e,name:k.target.value}),placeholder:"e.g., Pro-Poor Tariff 2025"})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Fixed Charge (KES)"}),r.jsx(Ge,{type:"number",value:e.fixed_charge,onChange:k=>t({...e,fixed_charge:parseInt(k.target.value)})})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(Ne,{children:"Lifeline Tariff"}),r.jsx(Ay,{checked:e.lifeline_enabled,onCheckedChange:k=>t({...e,lifeline_enabled:k})})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Block Tariff Structure"}),r.jsxs("div",{className:"space-y-3 mt-2",children:[e.blocks.map((k,N)=>r.jsxs("div",{className:"p-3 border rounded-md space-y-2",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("span",{className:"text-sm font-medium",children:["Block ",N+1]}),N>0&&r.jsx(se,{size:"sm",variant:"ghost",onClick:()=>t({...e,blocks:e.blocks.filter((D,O)=>O!==N)}),children:"Remove"})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[r.jsxs("div",{children:[r.jsx(Ne,{className:"text-xs",children:"Min (m)"}),r.jsx(Ge,{type:"number",value:k.min,onChange:D=>y(N,"min",parseInt(D.target.value))})]}),r.jsxs("div",{children:[r.jsx(Ne,{className:"text-xs",children:"Max (m)"}),r.jsx(Ge,{type:"number",value:k.max,onChange:D=>y(N,"max",parseInt(D.target.value))})]}),r.jsxs("div",{children:[r.jsx(Ne,{className:"text-xs",children:"Rate (KES)"}),r.jsx(Ge,{type:"number",value:k.rate,onChange:D=>y(N,"rate",parseInt(D.target.value))})]})]})]},N)),r.jsx(se,{size:"sm",variant:"outline",onClick:v,className:"w-full",children:"Add Block"})]})]}),r.jsxs("div",{children:[r.jsxs(Ne,{children:["Demand Elasticity: ",e.elasticity]}),r.jsx(Vm,{value:[e.elasticity],onValueChange:([k])=>t({...e,elasticity:k}),min:0,max:.5,step:.05})]}),r.jsxs(se,{className:"w-full",onClick:()=>p.mutate(e),disabled:!e.name||p.isPending,children:[r.jsx(od,{className:"h-4 w-4 mr-2"}),"Run Simulation"]})]})]}),r.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Tariff Scenarios"})}),r.jsx(ie,{children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Name"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Revenue Sufficiency"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:c==null?void 0:c.map(k=>{var N;return r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:k.name}),r.jsx(ne,{children:r.jsx(We,{variant:k.status==="approved"?"default":"secondary",children:k.status})}),r.jsx(ne,{children:(N=k.results)!=null&&N.sufficiency_pct?`${k.results.sufficiency_pct.toFixed(0)}%`:"-"}),r.jsx(ne,{children:r.jsx(se,{size:"sm",variant:"ghost",children:r.jsx(rl,{className:"h-4 w-4"})})})]},k.id)})})]})})]}),r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Affordability by Income Quintile"}),r.jsx(xr,{children:"% of household income spent on water"})]}),r.jsx(ie,{children:r.jsx("div",{className:"h-[300px]",children:r.jsx(Da,{width:"100%",height:"100%",children:r.jsxs(hy,{data:j,children:[r.jsx(wo,{strokeDasharray:"3 3"}),r.jsx(aa,{dataKey:"quintile"}),r.jsx(Mi,{label:{value:"% of Income",angle:-90,position:"insideLeft"}}),r.jsx(Ds,{}),r.jsx(sa,{}),r.jsx(Ia,{dataKey:"current",fill:"#94a3b8",name:"Current Tariff"}),r.jsx(Ia,{dataKey:"proposed",fill:"#3b82f6",name:"Proposed Tariff"})]})})})})]}),r.jsxs(J,{children:[r.jsx(ge,{children:r.jsx(xe,{children:"Revenue Projection by Category"})}),r.jsx(ie,{children:r.jsx("div",{className:"h-[300px]",children:r.jsx(Da,{width:"100%",height:"100%",children:r.jsxs(hy,{data:S,children:[r.jsx(wo,{strokeDasharray:"3 3"}),r.jsx(aa,{dataKey:"category"}),r.jsx(Mi,{}),r.jsx(Ds,{}),r.jsx(sa,{}),r.jsx(Ia,{dataKey:"current",fill:"#10b981",name:"Current (KES)"}),r.jsx(Ia,{dataKey:"proposed",fill:"#3b82f6",name:"Proposed (KES)"})]})})})})]})]})]})]})}function E$e(){const[e,t]=R.useState("alerts"),[n,s]=R.useState({name:"",description:"",priority:"medium",enabled:!0,signals:[{tag:"",operator:">",threshold:0}],channels:[],quiet_hours_start:null,quiet_hours_end:null}),{data:i,isLoading:c,error:u,refetch:a}=ht({queryKey:["ews-rules"],queryFn:async()=>(await me.get("/api/v1/dsa/ews/rules")).data.data}),{data:m,isLoading:p,error:y,refetch:v}=ht({queryKey:["ews-alerts"],queryFn:async()=>(await me.get("/api/v1/dsa/ews/alerts")).data.data}),j=jt({mutationFn:async T=>(await me.post("/api/v1/dsa/ews/rules",T)).data,onSuccess:()=>{qe.success("EWS rule created successfully"),a(),s({name:"",description:"",priority:"medium",enabled:!0,signals:[{tag:"",operator:">",threshold:0}],channels:[],quiet_hours_start:null,quiet_hours_end:null})},onError:()=>{qe.error("Failed to create EWS rule")}}),S=jt({mutationFn:async T=>(await me.post(`/api/v1/dsa/ews/alerts/${T}/acknowledge`)).data,onSuccess:()=>{qe.success("Alert acknowledged"),v()}}),k=()=>{s({...n,signals:[...n.signals,{tag:"",operator:">",threshold:0}]})},N=(T,I,z)=>{const $=[...n.signals];$[T]={...$[T],[I]:z},s({...n,signals:$})},D=T=>{s({...n,signals:n.signals.filter((I,z)=>z!==T)})},O=T=>{switch(T){case"critical":return"destructive";case"high":return"default";case"medium":return"secondary";case"low":return"outline";default:return"outline"}};return r.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Early Warning System"}),r.jsx("p",{className:"text-muted-foreground",children:"Configure threshold rules and manage alerts"})]}),r.jsxs(qs,{value:e,onValueChange:T=>t(T),children:[r.jsxs(As,{children:[r.jsxs(sr,{value:"alerts",children:[r.jsx(A0,{className:"h-4 w-4 mr-2"}),"Alerts",m&&m.filter(T=>T.status==="new").length>0&&r.jsx(We,{className:"ml-2",variant:"destructive",children:m.filter(T=>T.status==="new").length})]}),r.jsx(sr,{value:"rules",children:"Rules Builder"})]}),r.jsxs(Nr,{value:"alerts",className:"space-y-6",children:[r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Active Alerts"}),r.jsx(xr,{children:"Real-time early warning notifications"})]}),r.jsxs(ie,{children:[r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Rule"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Triggered"}),r.jsx(le,{children:"Response Time"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:m==null?void 0:m.map(T=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:T.rule_name}),r.jsx(ne,{children:r.jsx(We,{variant:T.status==="new"?"destructive":T.status==="acknowledged"?"secondary":T.status==="resolved"?"default":"outline",children:T.status})}),r.jsx(ne,{className:"text-sm",children:new Date(T.created_at).toLocaleString()}),r.jsx(ne,{children:T.response_time_minutes?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(xs,{className:"h-4 w-4"}),r.jsxs("span",{className:"text-sm",children:[T.response_time_minutes,"m"]})]}):"-"}),r.jsx(ne,{children:r.jsx(se,{size:"sm",variant:"ghost",onClick:()=>S.mutate(T.id),disabled:T.status!=="new",children:r.jsx(Kh,{className:"h-4 w-4"})})})]},T.id))})]}),(!m||m.length===0)&&r.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[r.jsx(gn,{className:"h-12 w-12 mx-auto mb-4 opacity-20"}),r.jsx("p",{children:"No active alerts"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"New Alerts"}),r.jsx("p",{className:"text-2xl font-bold",children:(m==null?void 0:m.filter(T=>T.status==="new").length)||0})]}),r.jsx(We,{variant:"destructive",className:"h-8 w-8 rounded-full flex items-center justify-center",children:"!"})]})})}),r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Acknowledged"}),r.jsx("p",{className:"text-2xl font-bold",children:(m==null?void 0:m.filter(T=>T.status==="acknowledged").length)||0})]}),r.jsx(We,{variant:"secondary",className:"h-8 w-8 rounded-full flex items-center justify-center",children:""})]})})}),r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Resolved"}),r.jsx("p",{className:"text-2xl font-bold",children:(m==null?void 0:m.filter(T=>T.status==="resolved").length)||0})]}),r.jsx(We,{variant:"default",className:"h-8 w-8 rounded-full flex items-center justify-center",children:""})]})})}),r.jsx(J,{children:r.jsx(ie,{className:"pt-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Response"}),r.jsxs("p",{className:"text-2xl font-bold",children:[m&&m.filter(T=>T.response_time_minutes).length>0?Math.round(m.filter(T=>T.response_time_minutes).reduce((T,I)=>T+(I.response_time_minutes||0),0)/m.filter(T=>T.response_time_minutes).length):0,"m"]})]}),r.jsx(xs,{className:"h-8 w-8 text-muted-foreground"})]})})})]})]}),r.jsx(Nr,{value:"rules",className:"space-y-6",children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs(J,{children:[r.jsxs(ge,{children:[r.jsx(xe,{children:"Create Rule"}),r.jsx(xr,{children:"Define threshold-based alert rules"})]}),r.jsxs(ie,{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ne,{children:"Rule Name"}),r.jsx(Ge,{value:n.name,onChange:T=>s({...n,name:T.target.value}),placeholder:"e.g., Critical Pressure Drop"})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Description"}),r.jsx(Fs,{value:n.description,onChange:T=>s({...n,description:T.target.value}),placeholder:"Describe when this rule should trigger..."})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Priority"}),r.jsxs(Jt,{value:n.priority,onValueChange:T=>s({...n,priority:T}),children:[r.jsx(Yt,{children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:"critical",children:"Critical"}),r.jsx(ke,{value:"high",children:"High"}),r.jsx(ke,{value:"medium",children:"Medium"}),r.jsx(ke,{value:"low",children:"Low"})]})]})]}),r.jsxs("div",{children:[r.jsx(Ne,{children:"Signal Conditions"}),r.jsxs("div",{className:"space-y-2 mt-2",children:[n.signals.map((T,I)=>r.jsxs("div",{className:"flex gap-2 items-end",children:[r.jsx("div",{className:"flex-1",children:r.jsx(Ge,{placeholder:"Tag name",value:T.tag,onChange:z=>N(I,"tag",z.target.value)})}),r.jsxs(Jt,{value:T.operator,onValueChange:z=>N(I,"operator",z),children:[r.jsx(Yt,{className:"w-20",children:r.jsx(er,{})}),r.jsxs(Xt,{children:[r.jsx(ke,{value:">",children:">"}),r.jsx(ke,{value:"<",children:"<"}),r.jsx(ke,{value:">=",children:">="}),r.jsx(ke,{value:"<=",children:"<="}),r.jsx(ke,{value:"=",children:"="})]})]}),r.jsx(Ge,{type:"number",className:"w-24",placeholder:"Value",value:T.threshold,onChange:z=>N(I,"threshold",parseFloat(z.target.value))}),n.signals.length>1&&r.jsx(se,{size:"sm",variant:"ghost",onClick:()=>D(I),children:r.jsx(Oi,{className:"h-4 w-4"})})]},I)),r.jsxs(se,{size:"sm",variant:"outline",onClick:k,className:"w-full",children:[r.jsx(ir,{className:"h-4 w-4 mr-2"}),"Add Signal"]})]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(Ne,{children:"Enabled"}),r.jsx(Ay,{checked:n.enabled,onCheckedChange:T=>s({...n,enabled:T})})]}),r.jsx(se,{className:"w-full",onClick:()=>j.mutate(n),disabled:!n.name||n.signals.length===0||j.isPending,children:"Create Rule"})]})]}),r.jsxs(J,{className:"lg:col-span-2",children:[r.jsx(ge,{children:r.jsx(xe,{children:"Configured Rules"})}),r.jsx(ie,{children:r.jsxs(lr,{children:[r.jsx(cr,{children:r.jsxs(lt,{children:[r.jsx(le,{children:"Name"}),r.jsx(le,{children:"Priority"}),r.jsx(le,{children:"Signals"}),r.jsx(le,{children:"Status"}),r.jsx(le,{children:"Actions"})]})}),r.jsx(ur,{children:i==null?void 0:i.map(T=>r.jsxs(lt,{children:[r.jsx(ne,{className:"font-medium",children:T.name}),r.jsx(ne,{children:r.jsx(We,{variant:O(T.priority),children:T.priority})}),r.jsxs(ne,{className:"text-sm",children:[T.signals.length," condition",T.signals.length>1?"s":""]}),r.jsx(ne,{children:r.jsx(We,{variant:T.enabled?"default":"outline",children:T.enabled?"Active":"Disabled"})}),r.jsx(ne,{children:r.jsxs("div",{className:"flex gap-2",children:[r.jsx(se,{size:"sm",variant:"ghost",children:"Edit"}),r.jsx(se,{size:"sm",variant:"ghost",children:r.jsx(Oi,{className:"h-4 w-4"})})]})})]},T.id))})]})})]})]})})]})]})}function M$e(){return r.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:r.jsx(J,{className:"w-full max-w-md mx-4",children:r.jsxs(ie,{className:"pt-6",children:[r.jsxs("div",{className:"flex mb-4 gap-2",children:[r.jsx(ei,{className:"h-8 w-8 text-red-500"}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),r.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}function O$e(){return r.jsx(mee,{client:Mte,children:r.jsx(Dte,{children:r.jsx(Ste,{children:r.jsx("div",{className:"min-h-screen bg-background",children:r.jsxs(gte,{children:[r.jsx(at,{path:"/login",element:r.jsx(lne,{})}),r.jsx(at,{path:"/",element:r.jsx(xt,{children:r.jsx(Aa,{to:"/costing/budgets",replace:!0})})}),r.jsxs(at,{path:"/core",element:r.jsx(xt,{children:r.jsx(HFe,{})}),children:[r.jsx(at,{index:!0,element:r.jsx(cne,{})}),r.jsx(at,{path:"schemes",element:r.jsx(xt,{requiredPermission:"view schemes",children:r.jsx(Qae,{})})}),r.jsx(at,{path:"facilities",element:r.jsx(xt,{requiredPermission:"view facilities",children:r.jsx(Noe,{})})}),r.jsx(at,{path:"dmas",element:r.jsx(xt,{requiredPermission:"view dmas",children:r.jsx(nce,{})})}),r.jsx(at,{path:"pipelines",element:r.jsx(xt,{requiredPermission:"view pipelines",children:r.jsx(sce,{})})}),r.jsx(at,{path:"zones",element:r.jsx(xt,{requiredPermission:"view zones",children:r.jsx(ice,{})})}),r.jsx(at,{path:"addresses",element:r.jsx(xt,{requiredPermission:"view addresses",children:r.jsx(ace,{})})}),r.jsx(at,{path:"meters",element:r.jsx(xt,{requiredPermission:"view assets",children:r.jsx(Jle,{})})})]}),r.jsx(at,{path:"/gis",element:r.jsx(xt,{requiredPermission:"view gis",children:r.jsx(Qce,{})})}),r.jsx(at,{path:"/gis/map",element:r.jsx(xt,{requiredPermission:"view schemes",children:r.jsx(Dce,{})})}),r.jsxs(at,{path:"/cmms",element:r.jsx(xt,{children:r.jsx(jue,{})}),children:[r.jsx(at,{index:!0,element:r.jsx(Aa,{to:"/cmms/dashboard",replace:!0})}),r.jsx(at,{path:"dashboard",element:r.jsx(xt,{requiredPermission:"view assets",children:r.jsx(wue,{})})}),r.jsx(at,{path:"assets",element:r.jsx(xt,{requiredPermission:"view assets",children:r.jsx(Kue,{})})}),r.jsx(at,{path:"assets/:id",element:r.jsx(xt,{requiredPermission:"view assets",children:r.jsx(Yue,{})})}),r.jsx(at,{path:"work-orders",element:r.jsx(xt,{requiredPermission:"view work orders",children:r.jsx(nde,{})})}),r.jsx(at,{path:"parts",element:r.jsx(xt,{requiredPermission:"view parts inventory",children:r.jsx(ide,{})})}),r.jsx(at,{path:"map",element:r.jsx(xt,{requiredPermission:"view assets",children:r.jsx(ode,{})})}),r.jsx(at,{path:"job-plans",element:r.jsx(xt,{requiredPermission:"view assets",children:r.jsx(cde,{})})}),r.jsx(at,{path:"pm",element:r.jsx(xt,{requiredPermission:"view assets",children:r.jsx(ude,{})})}),r.jsx(at,{path:"condition-monitoring",element:r.jsx(xt,{requiredPermission:"view assets",children:r.jsx(Qde,{})})}),r.jsx(at,{path:"stores",element:r.jsx(xt,{requiredPermission:"view parts inventory",children:r.jsx(the,{})})}),r.jsx(at,{path:"fleet",element:r.jsx(xt,{requiredPermission:"view assets",children:r.jsx(ihe,{})})}),r.jsx(at,{path:"contractors",element:r.jsx(xt,{requiredPermission:"view assets",children:r.jsx(yhe,{})})}),r.jsx(at,{path:"hse",element:r.jsx(xt,{requiredPermission:"view assets",children:r.jsx(bhe,{})})})]}),r.jsxs(at,{path:"/security",element:r.jsx(xt,{children:r.jsx(fue,{})}),children:[r.jsx(at,{index:!0,element:r.jsx(Aa,{to:"/security/audit",replace:!0})}),r.jsx(at,{path:"audit",element:r.jsx(xt,{requiredPermission:"view audit",children:r.jsx(mue,{})})}),r.jsx(at,{path:"alerts",element:r.jsx(xt,{requiredPermission:"view security alerts",children:r.jsx(W3,{})})}),r.jsx(at,{path:"roles",element:r.jsx(xt,{requiredPermission:"view roles",children:r.jsx(pue,{})})}),r.jsx(at,{path:"api-keys",element:r.jsx(xt,{requiredPermission:"view api keys",children:r.jsx(G3,{})})}),r.jsx(at,{path:"dsr",element:r.jsx(xt,{requiredPermission:"view dsr requests",children:r.jsx(gue,{})})}),r.jsx(at,{path:"consents",element:r.jsx(xt,{requiredPermission:"view consents",children:r.jsx(xue,{})})}),r.jsx(at,{path:"kms",element:r.jsx(xt,{requiredPermission:"view kms keys",children:r.jsx(yue,{})})}),r.jsx(at,{path:"retention",element:r.jsx(xt,{requiredPermission:"manage retention policies",children:r.jsx(vue,{})})}),r.jsx(at,{path:"data-catalog",element:r.jsx(xt,{requiredPermission:"view data catalog",children:r.jsx(_ue,{})})}),r.jsx(at,{path:"2fa",element:r.jsx(xt,{children:r.jsx(bue,{})})})]}),r.jsxs(at,{path:"/water-quality",element:r.jsx(xt,{children:r.jsx(jhe,{})}),children:[r.jsx(at,{index:!0,element:r.jsx(Aa,{to:"/water-quality/parameters",replace:!0})}),r.jsx(at,{path:"parameters",element:r.jsx(xt,{requiredPermission:"view wq parameters",children:r.jsx(She,{})})}),r.jsx(at,{path:"sampling-points",element:r.jsx(xt,{requiredPermission:"view wq sampling points",children:r.jsx(Mhe,{})})}),r.jsx(at,{path:"plans",element:r.jsx(xt,{requiredPermission:"view wq plans",children:r.jsx(Ihe,{})})}),r.jsx(at,{path:"samples",element:r.jsx(xt,{requiredPermission:"view wq samples",children:r.jsx(Lhe,{})})}),r.jsx(at,{path:"results",element:r.jsx(xt,{requiredPermission:"view wq results",children:r.jsx(zhe,{})})}),r.jsx(at,{path:"compliance",element:r.jsx(xt,{requiredPermission:"view wq compliance",children:r.jsx($he,{})})})]}),r.jsx(at,{path:"/projects",element:r.jsx(xt,{children:r.jsx(YFe,{})}),children:r.jsx(at,{index:!0,element:r.jsx(xt,{requiredPermission:"view projects",children:r.jsx(XFe,{})})})}),r.jsxs(at,{path:"/crm",element:r.jsx(xt,{children:r.jsx(Bhe,{})}),children:[r.jsx(at,{index:!0,element:r.jsx(Aa,{to:"/crm/customers",replace:!0})}),r.jsx(at,{path:"customers",element:r.jsx(xt,{requiredPermission:"view customers",children:r.jsx(Vhe,{})})}),r.jsx(at,{path:"complaints",element:r.jsx(xt,{requiredPermission:"view customers",children:r.jsx(WLe,{})})}),r.jsx(at,{path:"interactions",element:r.jsx(xt,{requiredPermission:"view customers",children:r.jsx(KLe,{})})}),r.jsx(at,{path:"segmentation",element:r.jsx(xt,{requiredPermission:"view customers",children:r.jsx(HLe,{})})}),r.jsx(at,{path:"accounts/search",element:r.jsx(xt,{requiredPermission:"view service connections",children:r.jsx(BLe,{})})}),r.jsx(at,{path:"accounts/:accountNo",element:r.jsx(xt,{requiredPermission:"view service connections",children:r.jsx($Le,{})})}),r.jsx(at,{path:"ra",element:r.jsx(xt,{requiredPermission:"view ra cases",children:r.jsx(ZLe,{})})}),r.jsx(at,{path:"dunning",element:r.jsx(xt,{requiredPermission:"view service connections",children:r.jsx(YLe,{})})}),r.jsx(at,{path:"import",element:r.jsx(xt,{requiredPermission:"manage billing",children:r.jsx(XLe,{})})})]}),r.jsxs(at,{path:"/hydromet",element:r.jsx(xt,{children:r.jsx(ZFe,{})}),children:[r.jsx(at,{index:!0,element:r.jsx(Aa,{to:"/hydromet/sources",replace:!0})}),r.jsx(at,{path:"sources",element:r.jsx(xt,{requiredPermission:"view sources",children:r.jsx(PFe,{})})}),r.jsx(at,{path:"stations",element:r.jsx(xt,{requiredPermission:"view stations",children:r.jsx(kFe,{})})}),r.jsx(at,{path:"aquifers",element:r.jsx(xt,{requiredPermission:"view sources",children:r.jsx(i$e,{})})})]}),r.jsxs(at,{path:"/costing",element:r.jsx(xt,{children:r.jsx(M6,{})}),children:[r.jsx(at,{index:!0,element:r.jsx(Aa,{to:"/costing/budgets",replace:!0})}),r.jsx(at,{path:"budgets",element:r.jsx(xt,{requiredPermission:"view budgets",children:r.jsx(RFe,{})})}),r.jsx(at,{path:"budgets/:id",element:r.jsx(xt,{requiredPermission:"view budgets",children:r.jsx(LFe,{})})}),r.jsx(at,{path:"allocations",element:r.jsx(xt,{requiredPermission:"view allocations",children:r.jsx(FFe,{})})}),r.jsx(at,{path:"cost-to-serve",element:r.jsx(xt,{requiredPermission:"view cost to serve",children:r.jsx(zFe,{})})}),r.jsx(at,{path:"gl-accounts",element:r.jsx(xt,{requiredPermission:"view budgets",children:r.jsx($Fe,{})})}),r.jsx(at,{path:"cost-centers",element:r.jsx(xt,{requiredPermission:"view budgets",children:r.jsx(BFe,{})})}),r.jsx(at,{path:"energy/tariffs",element:r.jsx(xt,{requiredPermission:"view energy tariffs",children:r.jsx(qFe,{})})}),r.jsx(at,{path:"energy/readings",element:r.jsx(xt,{requiredPermission:"upload energy readings",children:r.jsx(VFe,{})})}),r.jsx(at,{path:"energy/dashboard",element:r.jsx(xt,{requiredPermission:"view energy dashboard",children:r.jsx(UFe,{})})})]}),r.jsxs(at,{path:"/procurement",element:r.jsx(xt,{children:r.jsx(M6,{})}),children:[r.jsx(at,{index:!0,element:r.jsx(Aa,{to:"/procurement/requisitions",replace:!0})}),r.jsx(at,{path:"requisitions",element:r.jsx(xt,{requiredPermission:"view requisitions",children:r.jsx(WFe,{})})}),r.jsx(at,{path:"rfqs",element:r.jsx(xt,{requiredPermission:"view rfqs",children:r.jsx(GFe,{})})}),r.jsx(at,{path:"lpos",element:r.jsx(xt,{requiredPermission:"view lpos",children:r.jsx(KFe,{})})})]}),r.jsxs(at,{path:"/me",element:r.jsx(xt,{children:r.jsx(eze,{})}),children:[r.jsx(at,{index:!0,element:r.jsx(Aa,{to:"/me/kpis",replace:!0})}),r.jsx(at,{path:"kpis",element:r.jsx(xt,{children:r.jsx(hze,{})})}),r.jsx(at,{path:"coverage",element:r.jsx(xt,{children:r.jsx(fze,{})})}),r.jsx(at,{path:"nrw",element:r.jsx(xt,{children:r.jsx(mze,{})})}),r.jsx(at,{path:"cx",element:r.jsx(xt,{children:r.jsx(pze,{})})}),r.jsx(at,{path:"indicators",element:r.jsx(xt,{children:r.jsx(gze,{})})}),r.jsx(at,{path:"gender-equity",element:r.jsx(xt,{children:r.jsx(o$e,{})})})]}),r.jsxs(at,{path:"/customer",element:r.jsx(xt,{children:r.jsx(tze,{})}),children:[r.jsx(at,{index:!0,element:r.jsx(Aa,{to:"/customer/tariffs",replace:!0})}),r.jsx(at,{path:"tariffs",element:r.jsx(xt,{children:r.jsx(xze,{})})}),r.jsx(at,{path:"billing",element:r.jsx(xt,{children:r.jsx(yze,{})})}),r.jsx(at,{path:"payments",element:r.jsx(xt,{children:r.jsx(vze,{})})}),r.jsx(at,{path:"meter-routes",element:r.jsx(xt,{children:r.jsx(_ze,{})})}),r.jsx(at,{path:"tickets",element:r.jsx(xt,{children:r.jsx(bze,{})})}),r.jsx(at,{path:"kiosks",element:r.jsx(xt,{children:r.jsx(jze,{})})}),r.jsx(at,{path:"trucking",element:r.jsx(xt,{children:r.jsx(wze,{})})}),r.jsx(at,{path:"connections",element:r.jsx(xt,{children:r.jsx(Sze,{})})})]}),r.jsxs(at,{path:"/community",element:r.jsx(xt,{children:r.jsx(Nze,{})}),children:[r.jsx(at,{index:!0,element:r.jsx(Aa,{to:"/community/committees",replace:!0})}),r.jsx(at,{path:"committees",element:r.jsx(xt,{children:r.jsx(Pze,{})})}),r.jsx(at,{path:"committees/:id",element:r.jsx(xt,{children:r.jsx(Cze,{})})}),r.jsx(at,{path:"finance",element:r.jsx(xt,{children:r.jsx(Aze,{})})}),r.jsx(at,{path:"vendors",element:r.jsx(xt,{children:r.jsx(kze,{})})}),r.jsx(at,{path:"bids",element:r.jsx(xt,{children:r.jsx(Tze,{})})}),r.jsx(at,{path:"deliveries",element:r.jsx(xt,{children:r.jsx(Eze,{})})}),r.jsx(at,{path:"stakeholders",element:r.jsx(xt,{children:r.jsx(Mze,{})})}),r.jsx(at,{path:"engagements",element:r.jsx(xt,{children:r.jsx(Oze,{})})}),r.jsx(at,{path:"grm",element:r.jsx(xt,{children:r.jsx(Ize,{})})}),r.jsx(at,{path:"open-data",element:r.jsx(xt,{children:r.jsx(Dze,{})})}),r.jsx(at,{path:"dataset-builder",element:r.jsx(xt,{children:r.jsx(Rze,{})})}),r.jsx(at,{path:"public-maps",element:r.jsx(xt,{children:r.jsx(Lze,{})})})]}),r.jsxs(at,{path:"/core-ops",element:r.jsx(xt,{children:r.jsx(Fze,{})}),children:[r.jsx(at,{index:!0,element:r.jsx(Aa,{to:"/core-ops/console",replace:!0})}),r.jsx(at,{path:"console",element:r.jsx(xt,{requiredPermission:"core_ops.view_operations",children:r.jsx(zze,{})})}),r.jsx(at,{path:"topology",element:r.jsx(xt,{requiredPermission:"core_ops.view_topology",children:r.jsx($ze,{})})}),r.jsx(at,{path:"telemetry",element:r.jsx(xt,{requiredPermission:"core_ops.view_telemetry",children:r.jsx(Bze,{})})}),r.jsx(at,{path:"outages",element:r.jsx(xt,{requiredPermission:"core_ops.view_outages",children:r.jsx(qze,{})})}),r.jsx(at,{path:"nrw",element:r.jsx(xt,{requiredPermission:"core_ops.view_nrw",children:r.jsx(Vze,{})})}),r.jsx(at,{path:"dosing",element:r.jsx(xt,{requiredPermission:"core_ops.view_dosing",children:r.jsx(Uze,{})})}),r.jsx(at,{path:"scheduling",element:r.jsx(xt,{requiredPermission:"core_ops.view_scheduling",children:r.jsx(Wze,{})})}),r.jsx(at,{path:"pressure-leak",element:r.jsx(xt,{requiredPermission:"core_ops.view_operations",children:r.jsx(Kze,{})})}),r.jsx(at,{path:"shifts",element:r.jsx(xt,{requiredPermission:"operations.view_shifts",children:r.jsx(Hze,{})})}),r.jsx(at,{path:"events",element:r.jsx(xt,{requiredPermission:"operations.view_events",children:r.jsx(Zze,{})})}),r.jsx(at,{path:"checklists",element:r.jsx(xt,{requiredPermission:"operations.view_checklists",children:r.jsx(Qze,{})})}),r.jsx(at,{path:"playbooks",element:r.jsx(xt,{requiredPermission:"operations.view_playbooks",children:r.jsx(Jze,{})})}),r.jsx(at,{path:"escalation-policies",element:r.jsx(xt,{requiredPermission:"operations.view_escalation_policies",children:r.jsx(t$e,{})})}),r.jsx(at,{path:"workflows/definitions",element:r.jsx(xt,{requiredPermission:"workflows.view",children:r.jsx(r$e,{})})}),r.jsx(at,{path:"workflows/instances",element:r.jsx(xt,{requiredPermission:"workflows.view",children:r.jsx(n$e,{})})}),r.jsx(at,{path:"droughts",element:r.jsx(xt,{requiredPermission:"core_ops.view_operations",children:r.jsx(a$e,{})})})]}),r.jsxs(at,{path:"/admin",element:r.jsx(xt,{children:r.jsx(QFe,{})}),children:[r.jsx(at,{index:!0,element:r.jsx(Aa,{to:"/admin/users",replace:!0})}),r.jsx(at,{path:"users",element:r.jsx(xt,{requiredPermission:"rbac.view",children:r.jsx(rze,{})})}),r.jsx(at,{path:"rbac/roles",element:r.jsx(xt,{requiredPermission:"rbac.view",children:r.jsx(nze,{})})}),r.jsx(at,{path:"rbac/matrix",element:r.jsx(xt,{requiredPermission:"rbac.view",children:r.jsx(sze,{})})}),r.jsx(at,{path:"audit",element:r.jsx(xt,{requiredPermission:"audit.view",children:r.jsx(ize,{})})}),r.jsx(at,{path:"security/alerts",element:r.jsx(xt,{requiredPermission:"security.view",children:r.jsx(W3,{})})}),r.jsx(at,{path:"security/api-keys",element:r.jsx(xt,{requiredPermission:"security.view",children:r.jsx(G3,{})})})]}),r.jsxs(at,{path:"/integration",element:r.jsx(xt,{children:r.jsx(JFe,{})}),children:[r.jsx(at,{index:!0,element:r.jsx(Aa,{to:"/integration/api",replace:!0})}),r.jsx(at,{path:"api",element:r.jsx(xt,{requiredPermission:"integration.api.view",children:r.jsx(aze,{})})}),r.jsx(at,{path:"connectors",element:r.jsx(xt,{requiredPermission:"integration.connectors.view",children:r.jsx(oze,{})})}),r.jsx(at,{path:"webhooks",element:r.jsx(xt,{requiredPermission:"integration.webhooks.view",children:r.jsx(lze,{})})}),r.jsx(at,{path:"etl",element:r.jsx(xt,{requiredPermission:"integration.etl.view",children:r.jsx(cze,{})})}),r.jsx(at,{path:"dw",element:r.jsx(xt,{requiredPermission:"integration.dw.view",children:r.jsx(uze,{})})}),r.jsx(at,{path:"comms",element:r.jsx(xt,{requiredPermission:"integration.comms.view",children:r.jsx(dze,{})})})]}),r.jsxs(at,{path:"/training",element:r.jsx(xt,{children:r.jsx(l$e,{})}),children:[r.jsx(at,{index:!0,element:r.jsx(Aa,{to:"/training/courses",replace:!0})}),r.jsx(at,{path:"courses",element:r.jsx(d$e,{})}),r.jsx(at,{path:"my-learning",element:r.jsx(f$e,{})}),r.jsx(at,{path:"kb",element:r.jsx(g$e,{})}),r.jsx(at,{path:"sops",element:r.jsx(v$e,{})}),r.jsx(at,{path:"skills",element:r.jsx(j$e,{})}),r.jsx(at,{path:"certificates",element:r.jsx(w$e,{})}),r.jsx(at,{path:"assessments",element:r.jsx(s$e,{})})]}),r.jsxs(at,{path:"/dsa",element:r.jsx(xt,{children:r.jsx(S$e,{})}),children:[r.jsx(at,{index:!0,element:r.jsx(Aa,{to:"/dsa/forecast",replace:!0})}),r.jsx(at,{path:"forecast",element:r.jsx(xt,{requiredPermission:"dsa.view_forecast",children:r.jsx(N$e,{})})}),r.jsx(at,{path:"scenarios",element:r.jsx(xt,{requiredPermission:"dsa.view_scenarios",children:r.jsx(P$e,{})})}),r.jsx(at,{path:"optimize",element:r.jsx(xt,{requiredPermission:"dsa.view_optimization",children:r.jsx(C$e,{})})}),r.jsx(at,{path:"anomalies",element:r.jsx(xt,{requiredPermission:"dsa.view_anomalies",children:r.jsx(A$e,{})})}),r.jsx(at,{path:"aquifer",element:r.jsx(xt,{requiredPermission:"dsa.view_hydro",children:r.jsx(k$e,{})})}),r.jsx(at,{path:"tariffs",element:r.jsx(xt,{requiredPermission:"dsa.view_tariffs",children:r.jsx(T$e,{})})}),r.jsx(at,{path:"ews",element:r.jsx(xt,{requiredPermission:"dsa.view_ews",children:r.jsx(E$e,{})})})]}),r.jsx(at,{path:"*",element:r.jsx(M$e,{})})]})})})})})}aq(document.getElementById("root")).render(r.jsx(O$e,{}));
