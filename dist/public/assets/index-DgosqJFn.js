var oL=t=>{throw TypeError(t)};var Yk=(t,r,s)=>r.has(t)||oL("Cannot "+s);var st=(t,r,s)=>(Yk(t,r,"read from private field"),s?s.call(t):r.get(t)),Gr=(t,r,s)=>r.has(t)?oL("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(t):r.set(t,s),Pr=(t,r,s,n)=>(Yk(t,r,"write to private field"),n?n.call(t,s):r.set(t,s),s),js=(t,r,s)=>(Yk(t,r,"access private method"),s);var E1=(t,r,s,n)=>({set _(a){Pr(t,r,a,s)},get _(){return st(t,r,n)}});function nq(t,r){for(var s=0;s<r.length;s++){const n=r[s];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in t)){const o=Object.getOwnPropertyDescriptor(n,a);o&&Object.defineProperty(t,a,o.get?o:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function s(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=s(a);fetch(a.href,o)}})();var N0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tn(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var aq={exports:{}},Q2={},iq={exports:{}},Ms={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b_=Symbol.for("react.element"),Dee=Symbol.for("react.portal"),Ree=Symbol.for("react.fragment"),Lee=Symbol.for("react.strict_mode"),Fee=Symbol.for("react.profiler"),$ee=Symbol.for("react.provider"),zee=Symbol.for("react.context"),Bee=Symbol.for("react.forward_ref"),qee=Symbol.for("react.suspense"),Vee=Symbol.for("react.memo"),Uee=Symbol.for("react.lazy"),lL=Symbol.iterator;function Wee(t){return t===null||typeof t!="object"?null:(t=lL&&t[lL]||t["@@iterator"],typeof t=="function"?t:null)}var oq={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},lq=Object.assign,cq={};function rv(t,r,s){this.props=t,this.context=r,this.refs=cq,this.updater=s||oq}rv.prototype.isReactComponent={};rv.prototype.setState=function(t,r){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,r,"setState")};rv.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function dq(){}dq.prototype=rv.prototype;function fO(t,r,s){this.props=t,this.context=r,this.refs=cq,this.updater=s||oq}var pO=fO.prototype=new dq;pO.constructor=fO;lq(pO,rv.prototype);pO.isPureReactComponent=!0;var cL=Array.isArray,uq=Object.prototype.hasOwnProperty,xO={current:null},hq={key:!0,ref:!0,__self:!0,__source:!0};function mq(t,r,s){var n,a={},o=null,c=null;if(r!=null)for(n in r.ref!==void 0&&(c=r.ref),r.key!==void 0&&(o=""+r.key),r)uq.call(r,n)&&!hq.hasOwnProperty(n)&&(a[n]=r[n]);var i=arguments.length-2;if(i===1)a.children=s;else if(1<i){for(var f=Array(i),p=0;p<i;p++)f[p]=arguments[p+2];a.children=f}if(t&&t.defaultProps)for(n in i=t.defaultProps,i)a[n]===void 0&&(a[n]=i[n]);return{$$typeof:b_,type:t,key:o,ref:c,props:a,_owner:xO.current}}function Gee(t,r){return{$$typeof:b_,type:t.type,key:r,ref:t.ref,props:t.props,_owner:t._owner}}function gO(t){return typeof t=="object"&&t!==null&&t.$$typeof===b_}function Kee(t){var r={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(s){return r[s]})}var dL=/\/+/g;function Xk(t,r){return typeof t=="object"&&t!==null&&t.key!=null?Kee(""+t.key):r.toString(36)}function CN(t,r,s,n,a){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var c=!1;if(t===null)c=!0;else switch(o){case"string":case"number":c=!0;break;case"object":switch(t.$$typeof){case b_:case Dee:c=!0}}if(c)return c=t,a=a(c),t=n===""?"."+Xk(c,0):n,cL(a)?(s="",t!=null&&(s=t.replace(dL,"$&/")+"/"),CN(a,r,s,"",function(p){return p})):a!=null&&(gO(a)&&(a=Gee(a,s+(!a.key||c&&c.key===a.key?"":(""+a.key).replace(dL,"$&/")+"/")+t)),r.push(a)),1;if(c=0,n=n===""?".":n+":",cL(t))for(var i=0;i<t.length;i++){o=t[i];var f=n+Xk(o,i);c+=CN(o,r,s,f,a)}else if(f=Wee(t),typeof f=="function")for(t=f.call(t),i=0;!(o=t.next()).done;)o=o.value,f=n+Xk(o,i++),c+=CN(o,r,s,f,a);else if(o==="object")throw r=String(t),Error("Objects are not valid as a React child (found: "+(r==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return c}function M1(t,r,s){if(t==null)return t;var n=[],a=0;return CN(t,n,"","",function(o){return r.call(s,o,a++)}),n}function Hee(t){if(t._status===-1){var r=t._result;r=r(),r.then(function(s){(t._status===0||t._status===-1)&&(t._status=1,t._result=s)},function(s){(t._status===0||t._status===-1)&&(t._status=2,t._result=s)}),t._status===-1&&(t._status=0,t._result=r)}if(t._status===1)return t._result.default;throw t._result}var Po={current:null},PN={transition:null},Zee={ReactCurrentDispatcher:Po,ReactCurrentBatchConfig:PN,ReactCurrentOwner:xO};function fq(){throw Error("act(...) is not supported in production builds of React.")}Ms.Children={map:M1,forEach:function(t,r,s){M1(t,function(){r.apply(this,arguments)},s)},count:function(t){var r=0;return M1(t,function(){r++}),r},toArray:function(t){return M1(t,function(r){return r})||[]},only:function(t){if(!gO(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ms.Component=rv;Ms.Fragment=Ree;Ms.Profiler=Fee;Ms.PureComponent=fO;Ms.StrictMode=Lee;Ms.Suspense=qee;Ms.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Zee;Ms.act=fq;Ms.cloneElement=function(t,r,s){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=lq({},t.props),a=t.key,o=t.ref,c=t._owner;if(r!=null){if(r.ref!==void 0&&(o=r.ref,c=xO.current),r.key!==void 0&&(a=""+r.key),t.type&&t.type.defaultProps)var i=t.type.defaultProps;for(f in r)uq.call(r,f)&&!hq.hasOwnProperty(f)&&(n[f]=r[f]===void 0&&i!==void 0?i[f]:r[f])}var f=arguments.length-2;if(f===1)n.children=s;else if(1<f){i=Array(f);for(var p=0;p<f;p++)i[p]=arguments[p+2];n.children=i}return{$$typeof:b_,type:t.type,key:a,ref:o,props:n,_owner:c}};Ms.createContext=function(t){return t={$$typeof:zee,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:$ee,_context:t},t.Consumer=t};Ms.createElement=mq;Ms.createFactory=function(t){var r=mq.bind(null,t);return r.type=t,r};Ms.createRef=function(){return{current:null}};Ms.forwardRef=function(t){return{$$typeof:Bee,render:t}};Ms.isValidElement=gO;Ms.lazy=function(t){return{$$typeof:Uee,_payload:{_status:-1,_result:t},_init:Hee}};Ms.memo=function(t,r){return{$$typeof:Vee,type:t,compare:r===void 0?null:r}};Ms.startTransition=function(t){var r=PN.transition;PN.transition={};try{t()}finally{PN.transition=r}};Ms.unstable_act=fq;Ms.useCallback=function(t,r){return Po.current.useCallback(t,r)};Ms.useContext=function(t){return Po.current.useContext(t)};Ms.useDebugValue=function(){};Ms.useDeferredValue=function(t){return Po.current.useDeferredValue(t)};Ms.useEffect=function(t,r){return Po.current.useEffect(t,r)};Ms.useId=function(){return Po.current.useId()};Ms.useImperativeHandle=function(t,r,s){return Po.current.useImperativeHandle(t,r,s)};Ms.useInsertionEffect=function(t,r){return Po.current.useInsertionEffect(t,r)};Ms.useLayoutEffect=function(t,r){return Po.current.useLayoutEffect(t,r)};Ms.useMemo=function(t,r){return Po.current.useMemo(t,r)};Ms.useReducer=function(t,r,s){return Po.current.useReducer(t,r,s)};Ms.useRef=function(t){return Po.current.useRef(t)};Ms.useState=function(t){return Po.current.useState(t)};Ms.useSyncExternalStore=function(t,r,s){return Po.current.useSyncExternalStore(t,r,s)};Ms.useTransition=function(){return Po.current.useTransition()};Ms.version="18.3.1";iq.exports=Ms;var A=iq.exports;const je=tn(A),pq=nq({__proto__:null,default:je},[A]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yee=A,Xee=Symbol.for("react.element"),Qee=Symbol.for("react.fragment"),Jee=Object.prototype.hasOwnProperty,ete=Yee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,tte={key:!0,ref:!0,__self:!0,__source:!0};function xq(t,r,s){var n,a={},o=null,c=null;s!==void 0&&(o=""+s),r.key!==void 0&&(o=""+r.key),r.ref!==void 0&&(c=r.ref);for(n in r)Jee.call(r,n)&&!tte.hasOwnProperty(n)&&(a[n]=r[n]);if(t&&t.defaultProps)for(n in r=t.defaultProps,r)a[n]===void 0&&(a[n]=r[n]);return{$$typeof:Xee,type:t,key:o,ref:c,props:a,_owner:ete.current}}Q2.Fragment=Qee;Q2.jsx=xq;Q2.jsxs=xq;aq.exports=Q2;var e=aq.exports,gq={exports:{}},wl={},yq={exports:{}},vq={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function r(be,de){var Ke=be.length;be.push(de);e:for(;0<Ke;){var He=Ke-1>>>1,Ve=be[He];if(0<a(Ve,de))be[He]=de,be[Ke]=Ve,Ke=He;else break e}}function s(be){return be.length===0?null:be[0]}function n(be){if(be.length===0)return null;var de=be[0],Ke=be.pop();if(Ke!==de){be[0]=Ke;e:for(var He=0,Ve=be.length,yt=Ve>>>1;He<yt;){var Et=2*(He+1)-1,Rt=be[Et],Vt=Et+1,Ct=be[Vt];if(0>a(Rt,Ke))Vt<Ve&&0>a(Ct,Rt)?(be[He]=Ct,be[Vt]=Ke,He=Vt):(be[He]=Rt,be[Et]=Ke,He=Et);else if(Vt<Ve&&0>a(Ct,Ke))be[He]=Ct,be[Vt]=Ke,He=Vt;else break e}}return de}function a(be,de){var Ke=be.sortIndex-de.sortIndex;return Ke!==0?Ke:be.id-de.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var c=Date,i=c.now();t.unstable_now=function(){return c.now()-i}}var f=[],p=[],g=1,y=null,b=3,w=!1,T=!1,N=!1,M=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(be){for(var de=s(p);de!==null;){if(de.callback===null)n(p);else if(de.startTime<=be)n(p),de.sortIndex=de.expirationTime,r(f,de);else break;de=s(p)}}function L(be){if(N=!1,D(be),!T)if(s(f)!==null)T=!0,Se(F);else{var de=s(p);de!==null&&ae(L,de.startTime-be)}}function F(be,de){T=!1,N&&(N=!1,O(te),te=-1),w=!0;var Ke=b;try{for(D(de),y=s(f);y!==null&&(!(y.expirationTime>de)||be&&!Z());){var He=y.callback;if(typeof He=="function"){y.callback=null,b=y.priorityLevel;var Ve=He(y.expirationTime<=de);de=t.unstable_now(),typeof Ve=="function"?y.callback=Ve:y===s(f)&&n(f),D(de)}else n(f);y=s(f)}if(y!==null)var yt=!0;else{var Et=s(p);Et!==null&&ae(L,Et.startTime-de),yt=!1}return yt}finally{y=null,b=Ke,w=!1}}var B=!1,U=null,te=-1,Q=5,re=-1;function Z(){return!(t.unstable_now()-re<Q)}function ne(){if(U!==null){var be=t.unstable_now();re=be;var de=!0;try{de=U(!0,be)}finally{de?oe():(B=!1,U=null)}}else B=!1}var oe;if(typeof C=="function")oe=function(){C(ne)};else if(typeof MessageChannel<"u"){var Ce=new MessageChannel,Pe=Ce.port2;Ce.port1.onmessage=ne,oe=function(){Pe.postMessage(null)}}else oe=function(){M(ne,0)};function Se(be){U=be,B||(B=!0,oe())}function ae(be,de){te=M(function(){be(t.unstable_now())},de)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(be){be.callback=null},t.unstable_continueExecution=function(){T||w||(T=!0,Se(F))},t.unstable_forceFrameRate=function(be){0>be||125<be?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<be?Math.floor(1e3/be):5},t.unstable_getCurrentPriorityLevel=function(){return b},t.unstable_getFirstCallbackNode=function(){return s(f)},t.unstable_next=function(be){switch(b){case 1:case 2:case 3:var de=3;break;default:de=b}var Ke=b;b=de;try{return be()}finally{b=Ke}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(be,de){switch(be){case 1:case 2:case 3:case 4:case 5:break;default:be=3}var Ke=b;b=be;try{return de()}finally{b=Ke}},t.unstable_scheduleCallback=function(be,de,Ke){var He=t.unstable_now();switch(typeof Ke=="object"&&Ke!==null?(Ke=Ke.delay,Ke=typeof Ke=="number"&&0<Ke?He+Ke:He):Ke=He,be){case 1:var Ve=-1;break;case 2:Ve=250;break;case 5:Ve=1073741823;break;case 4:Ve=1e4;break;default:Ve=5e3}return Ve=Ke+Ve,be={id:g++,callback:de,priorityLevel:be,startTime:Ke,expirationTime:Ve,sortIndex:-1},Ke>He?(be.sortIndex=Ke,r(p,be),s(f)===null&&be===s(p)&&(N?(O(te),te=-1):N=!0,ae(L,Ke-He))):(be.sortIndex=Ve,r(f,be),T||w||(T=!0,Se(F))),be},t.unstable_shouldYield=Z,t.unstable_wrapCallback=function(be){var de=b;return function(){var Ke=b;b=de;try{return be.apply(this,arguments)}finally{b=Ke}}}})(vq);yq.exports=vq;var rte=yq.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ste=A,bl=rte;function nr(t){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+t,s=1;s<arguments.length;s++)r+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+t+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var jq=new Set,J0={};function Dp(t,r){ay(t,r),ay(t+"Capture",r)}function ay(t,r){for(J0[t]=r,t=0;t<r.length;t++)jq.add(r[t])}var Iu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),LT=Object.prototype.hasOwnProperty,nte=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,uL={},hL={};function ate(t){return LT.call(hL,t)?!0:LT.call(uL,t)?!1:nte.test(t)?hL[t]=!0:(uL[t]=!0,!1)}function ite(t,r,s,n){if(s!==null&&s.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return n?!1:s!==null?!s.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function ote(t,r,s,n){if(r===null||typeof r>"u"||ite(t,r,s,n))return!0;if(n)return!1;if(s!==null)switch(s.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function ko(t,r,s,n,a,o,c){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=s,this.propertyName=t,this.type=r,this.sanitizeURL=o,this.removeEmptyString=c}var Gi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Gi[t]=new ko(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var r=t[0];Gi[r]=new ko(r,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Gi[t]=new ko(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Gi[t]=new ko(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Gi[t]=new ko(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Gi[t]=new ko(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Gi[t]=new ko(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Gi[t]=new ko(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Gi[t]=new ko(t,5,!1,t.toLowerCase(),null,!1,!1)});var yO=/[\-:]([a-z])/g;function vO(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var r=t.replace(yO,vO);Gi[r]=new ko(r,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var r=t.replace(yO,vO);Gi[r]=new ko(r,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var r=t.replace(yO,vO);Gi[r]=new ko(r,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Gi[t]=new ko(t,1,!1,t.toLowerCase(),null,!1,!1)});Gi.xlinkHref=new ko("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Gi[t]=new ko(t,1,!1,t.toLowerCase(),null,!0,!0)});function jO(t,r,s,n){var a=Gi.hasOwnProperty(r)?Gi[r]:null;(a!==null?a.type!==0:n||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(ote(r,s,a,n)&&(s=null),n||a===null?ate(r)&&(s===null?t.removeAttribute(r):t.setAttribute(r,""+s)):a.mustUseProperty?t[a.propertyName]=s===null?a.type===3?!1:"":s:(r=a.attributeName,n=a.attributeNamespace,s===null?t.removeAttribute(r):(a=a.type,s=a===3||a===4&&s===!0?"":""+s,n?t.setAttributeNS(n,r,s):t.setAttribute(r,s))))}var Ku=ste.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O1=Symbol.for("react.element"),hg=Symbol.for("react.portal"),mg=Symbol.for("react.fragment"),bO=Symbol.for("react.strict_mode"),FT=Symbol.for("react.profiler"),bq=Symbol.for("react.provider"),_q=Symbol.for("react.context"),_O=Symbol.for("react.forward_ref"),$T=Symbol.for("react.suspense"),zT=Symbol.for("react.suspense_list"),wO=Symbol.for("react.memo"),Rh=Symbol.for("react.lazy"),wq=Symbol.for("react.offscreen"),mL=Symbol.iterator;function Yj(t){return t===null||typeof t!="object"?null:(t=mL&&t[mL]||t["@@iterator"],typeof t=="function"?t:null)}var pa=Object.assign,Qk;function S0(t){if(Qk===void 0)try{throw Error()}catch(s){var r=s.stack.trim().match(/\n( *(at )?)/);Qk=r&&r[1]||""}return`
`+Qk+t}var Jk=!1;function eA(t,r){if(!t||Jk)return"";Jk=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(p){var n=p}Reflect.construct(t,[],r)}else{try{r.call()}catch(p){n=p}t.call(r.prototype)}else{try{throw Error()}catch(p){n=p}t()}}catch(p){if(p&&n&&typeof p.stack=="string"){for(var a=p.stack.split(`
`),o=n.stack.split(`
`),c=a.length-1,i=o.length-1;1<=c&&0<=i&&a[c]!==o[i];)i--;for(;1<=c&&0<=i;c--,i--)if(a[c]!==o[i]){if(c!==1||i!==1)do if(c--,i--,0>i||a[c]!==o[i]){var f=`
`+a[c].replace(" at new "," at ");return t.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",t.displayName)),f}while(1<=c&&0<=i);break}}}finally{Jk=!1,Error.prepareStackTrace=s}return(t=t?t.displayName||t.name:"")?S0(t):""}function lte(t){switch(t.tag){case 5:return S0(t.type);case 16:return S0("Lazy");case 13:return S0("Suspense");case 19:return S0("SuspenseList");case 0:case 2:case 15:return t=eA(t.type,!1),t;case 11:return t=eA(t.type.render,!1),t;case 1:return t=eA(t.type,!0),t;default:return""}}function BT(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case mg:return"Fragment";case hg:return"Portal";case FT:return"Profiler";case bO:return"StrictMode";case $T:return"Suspense";case zT:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case _q:return(t.displayName||"Context")+".Consumer";case bq:return(t._context.displayName||"Context")+".Provider";case _O:var r=t.render;return t=t.displayName,t||(t=r.displayName||r.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case wO:return r=t.displayName||null,r!==null?r:BT(t.type)||"Memo";case Rh:r=t._payload,t=t._init;try{return BT(t(r))}catch{}}return null}function cte(t){var r=t.type;switch(t.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=r.render,t=t.displayName||t.name||"",r.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return BT(r);case 8:return r===bO?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function jm(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Nq(t){var r=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function dte(t){var r=Nq(t)?"checked":"value",s=Object.getOwnPropertyDescriptor(t.constructor.prototype,r),n=""+t[r];if(!t.hasOwnProperty(r)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var a=s.get,o=s.set;return Object.defineProperty(t,r,{configurable:!0,get:function(){return a.call(this)},set:function(c){n=""+c,o.call(this,c)}}),Object.defineProperty(t,r,{enumerable:s.enumerable}),{getValue:function(){return n},setValue:function(c){n=""+c},stopTracking:function(){t._valueTracker=null,delete t[r]}}}}function I1(t){t._valueTracker||(t._valueTracker=dte(t))}function Sq(t){if(!t)return!1;var r=t._valueTracker;if(!r)return!0;var s=r.getValue(),n="";return t&&(n=Nq(t)?t.checked?"true":"false":t.value),t=n,t!==s?(r.setValue(t),!0):!1}function WN(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function qT(t,r){var s=r.checked;return pa({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??t._wrapperState.initialChecked})}function fL(t,r){var s=r.defaultValue==null?"":r.defaultValue,n=r.checked!=null?r.checked:r.defaultChecked;s=jm(r.value!=null?r.value:s),t._wrapperState={initialChecked:n,initialValue:s,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function Cq(t,r){r=r.checked,r!=null&&jO(t,"checked",r,!1)}function VT(t,r){Cq(t,r);var s=jm(r.value),n=r.type;if(s!=null)n==="number"?(s===0&&t.value===""||t.value!=s)&&(t.value=""+s):t.value!==""+s&&(t.value=""+s);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}r.hasOwnProperty("value")?UT(t,r.type,s):r.hasOwnProperty("defaultValue")&&UT(t,r.type,jm(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(t.defaultChecked=!!r.defaultChecked)}function pL(t,r,s){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var n=r.type;if(!(n!=="submit"&&n!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+t._wrapperState.initialValue,s||r===t.value||(t.value=r),t.defaultValue=r}s=t.name,s!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,s!==""&&(t.name=s)}function UT(t,r,s){(r!=="number"||WN(t.ownerDocument)!==t)&&(s==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+s&&(t.defaultValue=""+s))}var C0=Array.isArray;function Eg(t,r,s,n){if(t=t.options,r){r={};for(var a=0;a<s.length;a++)r["$"+s[a]]=!0;for(s=0;s<t.length;s++)a=r.hasOwnProperty("$"+t[s].value),t[s].selected!==a&&(t[s].selected=a),a&&n&&(t[s].defaultSelected=!0)}else{for(s=""+jm(s),r=null,a=0;a<t.length;a++){if(t[a].value===s){t[a].selected=!0,n&&(t[a].defaultSelected=!0);return}r!==null||t[a].disabled||(r=t[a])}r!==null&&(r.selected=!0)}}function WT(t,r){if(r.dangerouslySetInnerHTML!=null)throw Error(nr(91));return pa({},r,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function xL(t,r){var s=r.value;if(s==null){if(s=r.children,r=r.defaultValue,s!=null){if(r!=null)throw Error(nr(92));if(C0(s)){if(1<s.length)throw Error(nr(93));s=s[0]}r=s}r==null&&(r=""),s=r}t._wrapperState={initialValue:jm(s)}}function Pq(t,r){var s=jm(r.value),n=jm(r.defaultValue);s!=null&&(s=""+s,s!==t.value&&(t.value=s),r.defaultValue==null&&t.defaultValue!==s&&(t.defaultValue=s)),n!=null&&(t.defaultValue=""+n)}function gL(t){var r=t.textContent;r===t._wrapperState.initialValue&&r!==""&&r!==null&&(t.value=r)}function kq(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function GT(t,r){return t==null||t==="http://www.w3.org/1999/xhtml"?kq(r):t==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var D1,Aq=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,s,n,a){MSApp.execUnsafeLocalFunction(function(){return t(r,s,n,a)})}:t}(function(t,r){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=r;else{for(D1=D1||document.createElement("div"),D1.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=D1.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;r.firstChild;)t.appendChild(r.firstChild)}});function eb(t,r){if(r){var s=t.firstChild;if(s&&s===t.lastChild&&s.nodeType===3){s.nodeValue=r;return}}t.textContent=r}var R0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ute=["Webkit","ms","Moz","O"];Object.keys(R0).forEach(function(t){ute.forEach(function(r){r=r+t.charAt(0).toUpperCase()+t.substring(1),R0[r]=R0[t]})});function Tq(t,r,s){return r==null||typeof r=="boolean"||r===""?"":s||typeof r!="number"||r===0||R0.hasOwnProperty(t)&&R0[t]?(""+r).trim():r+"px"}function Eq(t,r){t=t.style;for(var s in r)if(r.hasOwnProperty(s)){var n=s.indexOf("--")===0,a=Tq(s,r[s],n);s==="float"&&(s="cssFloat"),n?t.setProperty(s,a):t[s]=a}}var hte=pa({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function KT(t,r){if(r){if(hte[t]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(nr(137,t));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(nr(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(nr(61))}if(r.style!=null&&typeof r.style!="object")throw Error(nr(62))}}function HT(t,r){if(t.indexOf("-")===-1)return typeof r.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ZT=null;function NO(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var YT=null,Mg=null,Og=null;function yL(t){if(t=N_(t)){if(typeof YT!="function")throw Error(nr(280));var r=t.stateNode;r&&(r=sC(r),YT(t.stateNode,t.type,r))}}function Mq(t){Mg?Og?Og.push(t):Og=[t]:Mg=t}function Oq(){if(Mg){var t=Mg,r=Og;if(Og=Mg=null,yL(t),r)for(t=0;t<r.length;t++)yL(r[t])}}function Iq(t,r){return t(r)}function Dq(){}var tA=!1;function Rq(t,r,s){if(tA)return t(r,s);tA=!0;try{return Iq(t,r,s)}finally{tA=!1,(Mg!==null||Og!==null)&&(Dq(),Oq())}}function tb(t,r){var s=t.stateNode;if(s===null)return null;var n=sC(s);if(n===null)return null;s=n[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(s&&typeof s!="function")throw Error(nr(231,r,typeof s));return s}var XT=!1;if(Iu)try{var Xj={};Object.defineProperty(Xj,"passive",{get:function(){XT=!0}}),window.addEventListener("test",Xj,Xj),window.removeEventListener("test",Xj,Xj)}catch{XT=!1}function mte(t,r,s,n,a,o,c,i,f){var p=Array.prototype.slice.call(arguments,3);try{r.apply(s,p)}catch(g){this.onError(g)}}var L0=!1,GN=null,KN=!1,QT=null,fte={onError:function(t){L0=!0,GN=t}};function pte(t,r,s,n,a,o,c,i,f){L0=!1,GN=null,mte.apply(fte,arguments)}function xte(t,r,s,n,a,o,c,i,f){if(pte.apply(this,arguments),L0){if(L0){var p=GN;L0=!1,GN=null}else throw Error(nr(198));KN||(KN=!0,QT=p)}}function Rp(t){var r=t,s=t;if(t.alternate)for(;r.return;)r=r.return;else{t=r;do r=t,r.flags&4098&&(s=r.return),t=r.return;while(t)}return r.tag===3?s:null}function Lq(t){if(t.tag===13){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function vL(t){if(Rp(t)!==t)throw Error(nr(188))}function gte(t){var r=t.alternate;if(!r){if(r=Rp(t),r===null)throw Error(nr(188));return r!==t?null:t}for(var s=t,n=r;;){var a=s.return;if(a===null)break;var o=a.alternate;if(o===null){if(n=a.return,n!==null){s=n;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===s)return vL(a),t;if(o===n)return vL(a),r;o=o.sibling}throw Error(nr(188))}if(s.return!==n.return)s=a,n=o;else{for(var c=!1,i=a.child;i;){if(i===s){c=!0,s=a,n=o;break}if(i===n){c=!0,n=a,s=o;break}i=i.sibling}if(!c){for(i=o.child;i;){if(i===s){c=!0,s=o,n=a;break}if(i===n){c=!0,n=o,s=a;break}i=i.sibling}if(!c)throw Error(nr(189))}}if(s.alternate!==n)throw Error(nr(190))}if(s.tag!==3)throw Error(nr(188));return s.stateNode.current===s?t:r}function Fq(t){return t=gte(t),t!==null?$q(t):null}function $q(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var r=$q(t);if(r!==null)return r;t=t.sibling}return null}var zq=bl.unstable_scheduleCallback,jL=bl.unstable_cancelCallback,yte=bl.unstable_shouldYield,vte=bl.unstable_requestPaint,Aa=bl.unstable_now,jte=bl.unstable_getCurrentPriorityLevel,SO=bl.unstable_ImmediatePriority,Bq=bl.unstable_UserBlockingPriority,HN=bl.unstable_NormalPriority,bte=bl.unstable_LowPriority,qq=bl.unstable_IdlePriority,J2=null,wd=null;function _te(t){if(wd&&typeof wd.onCommitFiberRoot=="function")try{wd.onCommitFiberRoot(J2,t,void 0,(t.current.flags&128)===128)}catch{}}var Bc=Math.clz32?Math.clz32:Ste,wte=Math.log,Nte=Math.LN2;function Ste(t){return t>>>=0,t===0?32:31-(wte(t)/Nte|0)|0}var R1=64,L1=4194304;function P0(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ZN(t,r){var s=t.pendingLanes;if(s===0)return 0;var n=0,a=t.suspendedLanes,o=t.pingedLanes,c=s&268435455;if(c!==0){var i=c&~a;i!==0?n=P0(i):(o&=c,o!==0&&(n=P0(o)))}else c=s&~a,c!==0?n=P0(c):o!==0&&(n=P0(o));if(n===0)return 0;if(r!==0&&r!==n&&!(r&a)&&(a=n&-n,o=r&-r,a>=o||a===16&&(o&4194240)!==0))return r;if(n&4&&(n|=s&16),r=t.entangledLanes,r!==0)for(t=t.entanglements,r&=n;0<r;)s=31-Bc(r),a=1<<s,n|=t[s],r&=~a;return n}function Cte(t,r){switch(t){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pte(t,r){for(var s=t.suspendedLanes,n=t.pingedLanes,a=t.expirationTimes,o=t.pendingLanes;0<o;){var c=31-Bc(o),i=1<<c,f=a[c];f===-1?(!(i&s)||i&n)&&(a[c]=Cte(i,r)):f<=r&&(t.expiredLanes|=i),o&=~i}}function JT(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Vq(){var t=R1;return R1<<=1,!(R1&4194240)&&(R1=64),t}function rA(t){for(var r=[],s=0;31>s;s++)r.push(t);return r}function __(t,r,s){t.pendingLanes|=r,r!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,r=31-Bc(r),t[r]=s}function kte(t,r){var s=t.pendingLanes&~r;t.pendingLanes=r,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=r,t.mutableReadLanes&=r,t.entangledLanes&=r,r=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<s;){var a=31-Bc(s),o=1<<a;r[a]=0,n[a]=-1,t[a]=-1,s&=~o}}function CO(t,r){var s=t.entangledLanes|=r;for(t=t.entanglements;s;){var n=31-Bc(s),a=1<<n;a&r|t[n]&r&&(t[n]|=r),s&=~a}}var mn=0;function Uq(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Wq,PO,Gq,Kq,Hq,eE=!1,F1=[],im=null,om=null,lm=null,rb=new Map,sb=new Map,Bh=[],Ate="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bL(t,r){switch(t){case"focusin":case"focusout":im=null;break;case"dragenter":case"dragleave":om=null;break;case"mouseover":case"mouseout":lm=null;break;case"pointerover":case"pointerout":rb.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":sb.delete(r.pointerId)}}function Qj(t,r,s,n,a,o){return t===null||t.nativeEvent!==o?(t={blockedOn:r,domEventName:s,eventSystemFlags:n,nativeEvent:o,targetContainers:[a]},r!==null&&(r=N_(r),r!==null&&PO(r)),t):(t.eventSystemFlags|=n,r=t.targetContainers,a!==null&&r.indexOf(a)===-1&&r.push(a),t)}function Tte(t,r,s,n,a){switch(r){case"focusin":return im=Qj(im,t,r,s,n,a),!0;case"dragenter":return om=Qj(om,t,r,s,n,a),!0;case"mouseover":return lm=Qj(lm,t,r,s,n,a),!0;case"pointerover":var o=a.pointerId;return rb.set(o,Qj(rb.get(o)||null,t,r,s,n,a)),!0;case"gotpointercapture":return o=a.pointerId,sb.set(o,Qj(sb.get(o)||null,t,r,s,n,a)),!0}return!1}function Zq(t){var r=Wf(t.target);if(r!==null){var s=Rp(r);if(s!==null){if(r=s.tag,r===13){if(r=Lq(s),r!==null){t.blockedOn=r,Hq(t.priority,function(){Gq(s)});return}}else if(r===3&&s.stateNode.current.memoizedState.isDehydrated){t.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}t.blockedOn=null}function kN(t){if(t.blockedOn!==null)return!1;for(var r=t.targetContainers;0<r.length;){var s=tE(t.domEventName,t.eventSystemFlags,r[0],t.nativeEvent);if(s===null){s=t.nativeEvent;var n=new s.constructor(s.type,s);ZT=n,s.target.dispatchEvent(n),ZT=null}else return r=N_(s),r!==null&&PO(r),t.blockedOn=s,!1;r.shift()}return!0}function _L(t,r,s){kN(t)&&s.delete(r)}function Ete(){eE=!1,im!==null&&kN(im)&&(im=null),om!==null&&kN(om)&&(om=null),lm!==null&&kN(lm)&&(lm=null),rb.forEach(_L),sb.forEach(_L)}function Jj(t,r){t.blockedOn===r&&(t.blockedOn=null,eE||(eE=!0,bl.unstable_scheduleCallback(bl.unstable_NormalPriority,Ete)))}function nb(t){function r(a){return Jj(a,t)}if(0<F1.length){Jj(F1[0],t);for(var s=1;s<F1.length;s++){var n=F1[s];n.blockedOn===t&&(n.blockedOn=null)}}for(im!==null&&Jj(im,t),om!==null&&Jj(om,t),lm!==null&&Jj(lm,t),rb.forEach(r),sb.forEach(r),s=0;s<Bh.length;s++)n=Bh[s],n.blockedOn===t&&(n.blockedOn=null);for(;0<Bh.length&&(s=Bh[0],s.blockedOn===null);)Zq(s),s.blockedOn===null&&Bh.shift()}var Ig=Ku.ReactCurrentBatchConfig,YN=!0;function Mte(t,r,s,n){var a=mn,o=Ig.transition;Ig.transition=null;try{mn=1,kO(t,r,s,n)}finally{mn=a,Ig.transition=o}}function Ote(t,r,s,n){var a=mn,o=Ig.transition;Ig.transition=null;try{mn=4,kO(t,r,s,n)}finally{mn=a,Ig.transition=o}}function kO(t,r,s,n){if(YN){var a=tE(t,r,s,n);if(a===null)hA(t,r,n,XN,s),bL(t,n);else if(Tte(a,t,r,s,n))n.stopPropagation();else if(bL(t,n),r&4&&-1<Ate.indexOf(t)){for(;a!==null;){var o=N_(a);if(o!==null&&Wq(o),o=tE(t,r,s,n),o===null&&hA(t,r,n,XN,s),o===a)break;a=o}a!==null&&n.stopPropagation()}else hA(t,r,n,null,s)}}var XN=null;function tE(t,r,s,n){if(XN=null,t=NO(n),t=Wf(t),t!==null)if(r=Rp(t),r===null)t=null;else if(s=r.tag,s===13){if(t=Lq(r),t!==null)return t;t=null}else if(s===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;t=null}else r!==t&&(t=null);return XN=t,null}function Yq(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(jte()){case SO:return 1;case Bq:return 4;case HN:case bte:return 16;case qq:return 536870912;default:return 16}default:return 16}}var em=null,AO=null,AN=null;function Xq(){if(AN)return AN;var t,r=AO,s=r.length,n,a="value"in em?em.value:em.textContent,o=a.length;for(t=0;t<s&&r[t]===a[t];t++);var c=s-t;for(n=1;n<=c&&r[s-n]===a[o-n];n++);return AN=a.slice(t,1<n?1-n:void 0)}function TN(t){var r=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&r===13&&(t=13)):t=r,t===10&&(t=13),32<=t||t===13?t:0}function $1(){return!0}function wL(){return!1}function Nl(t){function r(s,n,a,o,c){this._reactName=s,this._targetInst=a,this.type=n,this.nativeEvent=o,this.target=c,this.currentTarget=null;for(var i in t)t.hasOwnProperty(i)&&(s=t[i],this[i]=s?s(o):o[i]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?$1:wL,this.isPropagationStopped=wL,this}return pa(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=$1)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=$1)},persist:function(){},isPersistent:$1}),r}var sv={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},TO=Nl(sv),w_=pa({},sv,{view:0,detail:0}),Ite=Nl(w_),sA,nA,e0,eC=pa({},w_,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:EO,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==e0&&(e0&&t.type==="mousemove"?(sA=t.screenX-e0.screenX,nA=t.screenY-e0.screenY):nA=sA=0,e0=t),sA)},movementY:function(t){return"movementY"in t?t.movementY:nA}}),NL=Nl(eC),Dte=pa({},eC,{dataTransfer:0}),Rte=Nl(Dte),Lte=pa({},w_,{relatedTarget:0}),aA=Nl(Lte),Fte=pa({},sv,{animationName:0,elapsedTime:0,pseudoElement:0}),$te=Nl(Fte),zte=pa({},sv,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Bte=Nl(zte),qte=pa({},sv,{data:0}),SL=Nl(qte),Vte={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ute={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wte={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gte(t){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(t):(t=Wte[t])?!!r[t]:!1}function EO(){return Gte}var Kte=pa({},w_,{key:function(t){if(t.key){var r=Vte[t.key]||t.key;if(r!=="Unidentified")return r}return t.type==="keypress"?(t=TN(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Ute[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:EO,charCode:function(t){return t.type==="keypress"?TN(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?TN(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Hte=Nl(Kte),Zte=pa({},eC,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),CL=Nl(Zte),Yte=pa({},w_,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:EO}),Xte=Nl(Yte),Qte=pa({},sv,{propertyName:0,elapsedTime:0,pseudoElement:0}),Jte=Nl(Qte),ere=pa({},eC,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),tre=Nl(ere),rre=[9,13,27,32],MO=Iu&&"CompositionEvent"in window,F0=null;Iu&&"documentMode"in document&&(F0=document.documentMode);var sre=Iu&&"TextEvent"in window&&!F0,Qq=Iu&&(!MO||F0&&8<F0&&11>=F0),PL=" ",kL=!1;function Jq(t,r){switch(t){case"keyup":return rre.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function eV(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var fg=!1;function nre(t,r){switch(t){case"compositionend":return eV(r);case"keypress":return r.which!==32?null:(kL=!0,PL);case"textInput":return t=r.data,t===PL&&kL?null:t;default:return null}}function are(t,r){if(fg)return t==="compositionend"||!MO&&Jq(t,r)?(t=Xq(),AN=AO=em=null,fg=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Qq&&r.locale!=="ko"?null:r.data;default:return null}}var ire={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function AL(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r==="input"?!!ire[t.type]:r==="textarea"}function tV(t,r,s,n){Mq(n),r=QN(r,"onChange"),0<r.length&&(s=new TO("onChange","change",null,s,n),t.push({event:s,listeners:r}))}var $0=null,ab=null;function ore(t){hV(t,0)}function tC(t){var r=gg(t);if(Sq(r))return t}function lre(t,r){if(t==="change")return r}var rV=!1;if(Iu){var iA;if(Iu){var oA="oninput"in document;if(!oA){var TL=document.createElement("div");TL.setAttribute("oninput","return;"),oA=typeof TL.oninput=="function"}iA=oA}else iA=!1;rV=iA&&(!document.documentMode||9<document.documentMode)}function EL(){$0&&($0.detachEvent("onpropertychange",sV),ab=$0=null)}function sV(t){if(t.propertyName==="value"&&tC(ab)){var r=[];tV(r,ab,t,NO(t)),Rq(ore,r)}}function cre(t,r,s){t==="focusin"?(EL(),$0=r,ab=s,$0.attachEvent("onpropertychange",sV)):t==="focusout"&&EL()}function dre(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return tC(ab)}function ure(t,r){if(t==="click")return tC(r)}function hre(t,r){if(t==="input"||t==="change")return tC(r)}function mre(t,r){return t===r&&(t!==0||1/t===1/r)||t!==t&&r!==r}var Gc=typeof Object.is=="function"?Object.is:mre;function ib(t,r){if(Gc(t,r))return!0;if(typeof t!="object"||t===null||typeof r!="object"||r===null)return!1;var s=Object.keys(t),n=Object.keys(r);if(s.length!==n.length)return!1;for(n=0;n<s.length;n++){var a=s[n];if(!LT.call(r,a)||!Gc(t[a],r[a]))return!1}return!0}function ML(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function OL(t,r){var s=ML(t);t=0;for(var n;s;){if(s.nodeType===3){if(n=t+s.textContent.length,t<=r&&n>=r)return{node:s,offset:r-t};t=n}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=ML(s)}}function nV(t,r){return t&&r?t===r?!0:t&&t.nodeType===3?!1:r&&r.nodeType===3?nV(t,r.parentNode):"contains"in t?t.contains(r):t.compareDocumentPosition?!!(t.compareDocumentPosition(r)&16):!1:!1}function aV(){for(var t=window,r=WN();r instanceof t.HTMLIFrameElement;){try{var s=typeof r.contentWindow.location.href=="string"}catch{s=!1}if(s)t=r.contentWindow;else break;r=WN(t.document)}return r}function OO(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r&&(r==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||r==="textarea"||t.contentEditable==="true")}function fre(t){var r=aV(),s=t.focusedElem,n=t.selectionRange;if(r!==s&&s&&s.ownerDocument&&nV(s.ownerDocument.documentElement,s)){if(n!==null&&OO(s)){if(r=n.start,t=n.end,t===void 0&&(t=r),"selectionStart"in s)s.selectionStart=r,s.selectionEnd=Math.min(t,s.value.length);else if(t=(r=s.ownerDocument||document)&&r.defaultView||window,t.getSelection){t=t.getSelection();var a=s.textContent.length,o=Math.min(n.start,a);n=n.end===void 0?o:Math.min(n.end,a),!t.extend&&o>n&&(a=n,n=o,o=a),a=OL(s,o);var c=OL(s,n);a&&c&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==c.node||t.focusOffset!==c.offset)&&(r=r.createRange(),r.setStart(a.node,a.offset),t.removeAllRanges(),o>n?(t.addRange(r),t.extend(c.node,c.offset)):(r.setEnd(c.node,c.offset),t.addRange(r)))}}for(r=[],t=s;t=t.parentNode;)t.nodeType===1&&r.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<r.length;s++)t=r[s],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var pre=Iu&&"documentMode"in document&&11>=document.documentMode,pg=null,rE=null,z0=null,sE=!1;function IL(t,r,s){var n=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;sE||pg==null||pg!==WN(n)||(n=pg,"selectionStart"in n&&OO(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),z0&&ib(z0,n)||(z0=n,n=QN(rE,"onSelect"),0<n.length&&(r=new TO("onSelect","select",null,r,s),t.push({event:r,listeners:n}),r.target=pg)))}function z1(t,r){var s={};return s[t.toLowerCase()]=r.toLowerCase(),s["Webkit"+t]="webkit"+r,s["Moz"+t]="moz"+r,s}var xg={animationend:z1("Animation","AnimationEnd"),animationiteration:z1("Animation","AnimationIteration"),animationstart:z1("Animation","AnimationStart"),transitionend:z1("Transition","TransitionEnd")},lA={},iV={};Iu&&(iV=document.createElement("div").style,"AnimationEvent"in window||(delete xg.animationend.animation,delete xg.animationiteration.animation,delete xg.animationstart.animation),"TransitionEvent"in window||delete xg.transitionend.transition);function rC(t){if(lA[t])return lA[t];if(!xg[t])return t;var r=xg[t],s;for(s in r)if(r.hasOwnProperty(s)&&s in iV)return lA[t]=r[s];return t}var oV=rC("animationend"),lV=rC("animationiteration"),cV=rC("animationstart"),dV=rC("transitionend"),uV=new Map,DL="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Om(t,r){uV.set(t,r),Dp(r,[t])}for(var cA=0;cA<DL.length;cA++){var dA=DL[cA],xre=dA.toLowerCase(),gre=dA[0].toUpperCase()+dA.slice(1);Om(xre,"on"+gre)}Om(oV,"onAnimationEnd");Om(lV,"onAnimationIteration");Om(cV,"onAnimationStart");Om("dblclick","onDoubleClick");Om("focusin","onFocus");Om("focusout","onBlur");Om(dV,"onTransitionEnd");ay("onMouseEnter",["mouseout","mouseover"]);ay("onMouseLeave",["mouseout","mouseover"]);ay("onPointerEnter",["pointerout","pointerover"]);ay("onPointerLeave",["pointerout","pointerover"]);Dp("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Dp("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Dp("onBeforeInput",["compositionend","keypress","textInput","paste"]);Dp("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Dp("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Dp("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var k0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yre=new Set("cancel close invalid load scroll toggle".split(" ").concat(k0));function RL(t,r,s){var n=t.type||"unknown-event";t.currentTarget=s,xte(n,r,void 0,t),t.currentTarget=null}function hV(t,r){r=(r&4)!==0;for(var s=0;s<t.length;s++){var n=t[s],a=n.event;n=n.listeners;e:{var o=void 0;if(r)for(var c=n.length-1;0<=c;c--){var i=n[c],f=i.instance,p=i.currentTarget;if(i=i.listener,f!==o&&a.isPropagationStopped())break e;RL(a,i,p),o=f}else for(c=0;c<n.length;c++){if(i=n[c],f=i.instance,p=i.currentTarget,i=i.listener,f!==o&&a.isPropagationStopped())break e;RL(a,i,p),o=f}}}if(KN)throw t=QT,KN=!1,QT=null,t}function Vn(t,r){var s=r[lE];s===void 0&&(s=r[lE]=new Set);var n=t+"__bubble";s.has(n)||(mV(r,t,2,!1),s.add(n))}function uA(t,r,s){var n=0;r&&(n|=4),mV(s,t,n,r)}var B1="_reactListening"+Math.random().toString(36).slice(2);function ob(t){if(!t[B1]){t[B1]=!0,jq.forEach(function(s){s!=="selectionchange"&&(yre.has(s)||uA(s,!1,t),uA(s,!0,t))});var r=t.nodeType===9?t:t.ownerDocument;r===null||r[B1]||(r[B1]=!0,uA("selectionchange",!1,r))}}function mV(t,r,s,n){switch(Yq(r)){case 1:var a=Mte;break;case 4:a=Ote;break;default:a=kO}s=a.bind(null,r,s,t),a=void 0,!XT||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(a=!0),n?a!==void 0?t.addEventListener(r,s,{capture:!0,passive:a}):t.addEventListener(r,s,!0):a!==void 0?t.addEventListener(r,s,{passive:a}):t.addEventListener(r,s,!1)}function hA(t,r,s,n,a){var o=n;if(!(r&1)&&!(r&2)&&n!==null)e:for(;;){if(n===null)return;var c=n.tag;if(c===3||c===4){var i=n.stateNode.containerInfo;if(i===a||i.nodeType===8&&i.parentNode===a)break;if(c===4)for(c=n.return;c!==null;){var f=c.tag;if((f===3||f===4)&&(f=c.stateNode.containerInfo,f===a||f.nodeType===8&&f.parentNode===a))return;c=c.return}for(;i!==null;){if(c=Wf(i),c===null)return;if(f=c.tag,f===5||f===6){n=o=c;continue e}i=i.parentNode}}n=n.return}Rq(function(){var p=o,g=NO(s),y=[];e:{var b=uV.get(t);if(b!==void 0){var w=TO,T=t;switch(t){case"keypress":if(TN(s)===0)break e;case"keydown":case"keyup":w=Hte;break;case"focusin":T="focus",w=aA;break;case"focusout":T="blur",w=aA;break;case"beforeblur":case"afterblur":w=aA;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=NL;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=Rte;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=Xte;break;case oV:case lV:case cV:w=$te;break;case dV:w=Jte;break;case"scroll":w=Ite;break;case"wheel":w=tre;break;case"copy":case"cut":case"paste":w=Bte;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=CL}var N=(r&4)!==0,M=!N&&t==="scroll",O=N?b!==null?b+"Capture":null:b;N=[];for(var C=p,D;C!==null;){D=C;var L=D.stateNode;if(D.tag===5&&L!==null&&(D=L,O!==null&&(L=tb(C,O),L!=null&&N.push(lb(C,L,D)))),M)break;C=C.return}0<N.length&&(b=new w(b,T,null,s,g),y.push({event:b,listeners:N}))}}if(!(r&7)){e:{if(b=t==="mouseover"||t==="pointerover",w=t==="mouseout"||t==="pointerout",b&&s!==ZT&&(T=s.relatedTarget||s.fromElement)&&(Wf(T)||T[Du]))break e;if((w||b)&&(b=g.window===g?g:(b=g.ownerDocument)?b.defaultView||b.parentWindow:window,w?(T=s.relatedTarget||s.toElement,w=p,T=T?Wf(T):null,T!==null&&(M=Rp(T),T!==M||T.tag!==5&&T.tag!==6)&&(T=null)):(w=null,T=p),w!==T)){if(N=NL,L="onMouseLeave",O="onMouseEnter",C="mouse",(t==="pointerout"||t==="pointerover")&&(N=CL,L="onPointerLeave",O="onPointerEnter",C="pointer"),M=w==null?b:gg(w),D=T==null?b:gg(T),b=new N(L,C+"leave",w,s,g),b.target=M,b.relatedTarget=D,L=null,Wf(g)===p&&(N=new N(O,C+"enter",T,s,g),N.target=D,N.relatedTarget=M,L=N),M=L,w&&T)t:{for(N=w,O=T,C=0,D=N;D;D=Xx(D))C++;for(D=0,L=O;L;L=Xx(L))D++;for(;0<C-D;)N=Xx(N),C--;for(;0<D-C;)O=Xx(O),D--;for(;C--;){if(N===O||O!==null&&N===O.alternate)break t;N=Xx(N),O=Xx(O)}N=null}else N=null;w!==null&&LL(y,b,w,N,!1),T!==null&&M!==null&&LL(y,M,T,N,!0)}}e:{if(b=p?gg(p):window,w=b.nodeName&&b.nodeName.toLowerCase(),w==="select"||w==="input"&&b.type==="file")var F=lre;else if(AL(b))if(rV)F=hre;else{F=dre;var B=cre}else(w=b.nodeName)&&w.toLowerCase()==="input"&&(b.type==="checkbox"||b.type==="radio")&&(F=ure);if(F&&(F=F(t,p))){tV(y,F,s,g);break e}B&&B(t,b,p),t==="focusout"&&(B=b._wrapperState)&&B.controlled&&b.type==="number"&&UT(b,"number",b.value)}switch(B=p?gg(p):window,t){case"focusin":(AL(B)||B.contentEditable==="true")&&(pg=B,rE=p,z0=null);break;case"focusout":z0=rE=pg=null;break;case"mousedown":sE=!0;break;case"contextmenu":case"mouseup":case"dragend":sE=!1,IL(y,s,g);break;case"selectionchange":if(pre)break;case"keydown":case"keyup":IL(y,s,g)}var U;if(MO)e:{switch(t){case"compositionstart":var te="onCompositionStart";break e;case"compositionend":te="onCompositionEnd";break e;case"compositionupdate":te="onCompositionUpdate";break e}te=void 0}else fg?Jq(t,s)&&(te="onCompositionEnd"):t==="keydown"&&s.keyCode===229&&(te="onCompositionStart");te&&(Qq&&s.locale!=="ko"&&(fg||te!=="onCompositionStart"?te==="onCompositionEnd"&&fg&&(U=Xq()):(em=g,AO="value"in em?em.value:em.textContent,fg=!0)),B=QN(p,te),0<B.length&&(te=new SL(te,t,null,s,g),y.push({event:te,listeners:B}),U?te.data=U:(U=eV(s),U!==null&&(te.data=U)))),(U=sre?nre(t,s):are(t,s))&&(p=QN(p,"onBeforeInput"),0<p.length&&(g=new SL("onBeforeInput","beforeinput",null,s,g),y.push({event:g,listeners:p}),g.data=U))}hV(y,r)})}function lb(t,r,s){return{instance:t,listener:r,currentTarget:s}}function QN(t,r){for(var s=r+"Capture",n=[];t!==null;){var a=t,o=a.stateNode;a.tag===5&&o!==null&&(a=o,o=tb(t,s),o!=null&&n.unshift(lb(t,o,a)),o=tb(t,r),o!=null&&n.push(lb(t,o,a))),t=t.return}return n}function Xx(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function LL(t,r,s,n,a){for(var o=r._reactName,c=[];s!==null&&s!==n;){var i=s,f=i.alternate,p=i.stateNode;if(f!==null&&f===n)break;i.tag===5&&p!==null&&(i=p,a?(f=tb(s,o),f!=null&&c.unshift(lb(s,f,i))):a||(f=tb(s,o),f!=null&&c.push(lb(s,f,i)))),s=s.return}c.length!==0&&t.push({event:r,listeners:c})}var vre=/\r\n?/g,jre=/\u0000|\uFFFD/g;function FL(t){return(typeof t=="string"?t:""+t).replace(vre,`
`).replace(jre,"")}function q1(t,r,s){if(r=FL(r),FL(t)!==r&&s)throw Error(nr(425))}function JN(){}var nE=null,aE=null;function iE(t,r){return t==="textarea"||t==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var oE=typeof setTimeout=="function"?setTimeout:void 0,bre=typeof clearTimeout=="function"?clearTimeout:void 0,$L=typeof Promise=="function"?Promise:void 0,_re=typeof queueMicrotask=="function"?queueMicrotask:typeof $L<"u"?function(t){return $L.resolve(null).then(t).catch(wre)}:oE;function wre(t){setTimeout(function(){throw t})}function mA(t,r){var s=r,n=0;do{var a=s.nextSibling;if(t.removeChild(s),a&&a.nodeType===8)if(s=a.data,s==="/$"){if(n===0){t.removeChild(a),nb(r);return}n--}else s!=="$"&&s!=="$?"&&s!=="$!"||n++;s=a}while(s);nb(r)}function cm(t){for(;t!=null;t=t.nextSibling){var r=t.nodeType;if(r===1||r===3)break;if(r===8){if(r=t.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return t}function zL(t){t=t.previousSibling;for(var r=0;t;){if(t.nodeType===8){var s=t.data;if(s==="$"||s==="$!"||s==="$?"){if(r===0)return t;r--}else s==="/$"&&r++}t=t.previousSibling}return null}var nv=Math.random().toString(36).slice(2),yd="__reactFiber$"+nv,cb="__reactProps$"+nv,Du="__reactContainer$"+nv,lE="__reactEvents$"+nv,Nre="__reactListeners$"+nv,Sre="__reactHandles$"+nv;function Wf(t){var r=t[yd];if(r)return r;for(var s=t.parentNode;s;){if(r=s[Du]||s[yd]){if(s=r.alternate,r.child!==null||s!==null&&s.child!==null)for(t=zL(t);t!==null;){if(s=t[yd])return s;t=zL(t)}return r}t=s,s=t.parentNode}return null}function N_(t){return t=t[yd]||t[Du],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function gg(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(nr(33))}function sC(t){return t[cb]||null}var cE=[],yg=-1;function Im(t){return{current:t}}function Zn(t){0>yg||(t.current=cE[yg],cE[yg]=null,yg--)}function $n(t,r){yg++,cE[yg]=t.current,t.current=r}var bm={},ho=Im(bm),Uo=Im(!1),mp=bm;function iy(t,r){var s=t.type.contextTypes;if(!s)return bm;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===r)return n.__reactInternalMemoizedMaskedChildContext;var a={},o;for(o in s)a[o]=r[o];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=a),a}function Wo(t){return t=t.childContextTypes,t!=null}function eS(){Zn(Uo),Zn(ho)}function BL(t,r,s){if(ho.current!==bm)throw Error(nr(168));$n(ho,r),$n(Uo,s)}function fV(t,r,s){var n=t.stateNode;if(r=r.childContextTypes,typeof n.getChildContext!="function")return s;n=n.getChildContext();for(var a in n)if(!(a in r))throw Error(nr(108,cte(t)||"Unknown",a));return pa({},s,n)}function tS(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||bm,mp=ho.current,$n(ho,t),$n(Uo,Uo.current),!0}function qL(t,r,s){var n=t.stateNode;if(!n)throw Error(nr(169));s?(t=fV(t,r,mp),n.__reactInternalMemoizedMergedChildContext=t,Zn(Uo),Zn(ho),$n(ho,t)):Zn(Uo),$n(Uo,s)}var ju=null,nC=!1,fA=!1;function pV(t){ju===null?ju=[t]:ju.push(t)}function Cre(t){nC=!0,pV(t)}function Dm(){if(!fA&&ju!==null){fA=!0;var t=0,r=mn;try{var s=ju;for(mn=1;t<s.length;t++){var n=s[t];do n=n(!0);while(n!==null)}ju=null,nC=!1}catch(a){throw ju!==null&&(ju=ju.slice(t+1)),zq(SO,Dm),a}finally{mn=r,fA=!1}}return null}var vg=[],jg=0,rS=null,sS=0,Rl=[],Ll=0,fp=null,Nu=1,Su="";function Rf(t,r){vg[jg++]=sS,vg[jg++]=rS,rS=t,sS=r}function xV(t,r,s){Rl[Ll++]=Nu,Rl[Ll++]=Su,Rl[Ll++]=fp,fp=t;var n=Nu;t=Su;var a=32-Bc(n)-1;n&=~(1<<a),s+=1;var o=32-Bc(r)+a;if(30<o){var c=a-a%5;o=(n&(1<<c)-1).toString(32),n>>=c,a-=c,Nu=1<<32-Bc(r)+a|s<<a|n,Su=o+t}else Nu=1<<o|s<<a|n,Su=t}function IO(t){t.return!==null&&(Rf(t,1),xV(t,1,0))}function DO(t){for(;t===rS;)rS=vg[--jg],vg[jg]=null,sS=vg[--jg],vg[jg]=null;for(;t===fp;)fp=Rl[--Ll],Rl[Ll]=null,Su=Rl[--Ll],Rl[Ll]=null,Nu=Rl[--Ll],Rl[Ll]=null}var gl=null,xl=null,ta=!1,Ec=null;function gV(t,r){var s=ql(5,null,null,0);s.elementType="DELETED",s.stateNode=r,s.return=t,r=t.deletions,r===null?(t.deletions=[s],t.flags|=16):r.push(s)}function VL(t,r){switch(t.tag){case 5:var s=t.type;return r=r.nodeType!==1||s.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(t.stateNode=r,gl=t,xl=cm(r.firstChild),!0):!1;case 6:return r=t.pendingProps===""||r.nodeType!==3?null:r,r!==null?(t.stateNode=r,gl=t,xl=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(s=fp!==null?{id:Nu,overflow:Su}:null,t.memoizedState={dehydrated:r,treeContext:s,retryLane:1073741824},s=ql(18,null,null,0),s.stateNode=r,s.return=t,t.child=s,gl=t,xl=null,!0):!1;default:return!1}}function dE(t){return(t.mode&1)!==0&&(t.flags&128)===0}function uE(t){if(ta){var r=xl;if(r){var s=r;if(!VL(t,r)){if(dE(t))throw Error(nr(418));r=cm(s.nextSibling);var n=gl;r&&VL(t,r)?gV(n,s):(t.flags=t.flags&-4097|2,ta=!1,gl=t)}}else{if(dE(t))throw Error(nr(418));t.flags=t.flags&-4097|2,ta=!1,gl=t}}}function UL(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;gl=t}function V1(t){if(t!==gl)return!1;if(!ta)return UL(t),ta=!0,!1;var r;if((r=t.tag!==3)&&!(r=t.tag!==5)&&(r=t.type,r=r!=="head"&&r!=="body"&&!iE(t.type,t.memoizedProps)),r&&(r=xl)){if(dE(t))throw yV(),Error(nr(418));for(;r;)gV(t,r),r=cm(r.nextSibling)}if(UL(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(nr(317));e:{for(t=t.nextSibling,r=0;t;){if(t.nodeType===8){var s=t.data;if(s==="/$"){if(r===0){xl=cm(t.nextSibling);break e}r--}else s!=="$"&&s!=="$!"&&s!=="$?"||r++}t=t.nextSibling}xl=null}}else xl=gl?cm(t.stateNode.nextSibling):null;return!0}function yV(){for(var t=xl;t;)t=cm(t.nextSibling)}function oy(){xl=gl=null,ta=!1}function RO(t){Ec===null?Ec=[t]:Ec.push(t)}var Pre=Ku.ReactCurrentBatchConfig;function t0(t,r,s){if(t=s.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(nr(309));var n=s.stateNode}if(!n)throw Error(nr(147,t));var a=n,o=""+t;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===o?r.ref:(r=function(c){var i=a.refs;c===null?delete i[o]:i[o]=c},r._stringRef=o,r)}if(typeof t!="string")throw Error(nr(284));if(!s._owner)throw Error(nr(290,t))}return t}function U1(t,r){throw t=Object.prototype.toString.call(r),Error(nr(31,t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t))}function WL(t){var r=t._init;return r(t._payload)}function vV(t){function r(O,C){if(t){var D=O.deletions;D===null?(O.deletions=[C],O.flags|=16):D.push(C)}}function s(O,C){if(!t)return null;for(;C!==null;)r(O,C),C=C.sibling;return null}function n(O,C){for(O=new Map;C!==null;)C.key!==null?O.set(C.key,C):O.set(C.index,C),C=C.sibling;return O}function a(O,C){return O=mm(O,C),O.index=0,O.sibling=null,O}function o(O,C,D){return O.index=D,t?(D=O.alternate,D!==null?(D=D.index,D<C?(O.flags|=2,C):D):(O.flags|=2,C)):(O.flags|=1048576,C)}function c(O){return t&&O.alternate===null&&(O.flags|=2),O}function i(O,C,D,L){return C===null||C.tag!==6?(C=bA(D,O.mode,L),C.return=O,C):(C=a(C,D),C.return=O,C)}function f(O,C,D,L){var F=D.type;return F===mg?g(O,C,D.props.children,L,D.key):C!==null&&(C.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Rh&&WL(F)===C.type)?(L=a(C,D.props),L.ref=t0(O,C,D),L.return=O,L):(L=LN(D.type,D.key,D.props,null,O.mode,L),L.ref=t0(O,C,D),L.return=O,L)}function p(O,C,D,L){return C===null||C.tag!==4||C.stateNode.containerInfo!==D.containerInfo||C.stateNode.implementation!==D.implementation?(C=_A(D,O.mode,L),C.return=O,C):(C=a(C,D.children||[]),C.return=O,C)}function g(O,C,D,L,F){return C===null||C.tag!==7?(C=lp(D,O.mode,L,F),C.return=O,C):(C=a(C,D),C.return=O,C)}function y(O,C,D){if(typeof C=="string"&&C!==""||typeof C=="number")return C=bA(""+C,O.mode,D),C.return=O,C;if(typeof C=="object"&&C!==null){switch(C.$$typeof){case O1:return D=LN(C.type,C.key,C.props,null,O.mode,D),D.ref=t0(O,null,C),D.return=O,D;case hg:return C=_A(C,O.mode,D),C.return=O,C;case Rh:var L=C._init;return y(O,L(C._payload),D)}if(C0(C)||Yj(C))return C=lp(C,O.mode,D,null),C.return=O,C;U1(O,C)}return null}function b(O,C,D,L){var F=C!==null?C.key:null;if(typeof D=="string"&&D!==""||typeof D=="number")return F!==null?null:i(O,C,""+D,L);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case O1:return D.key===F?f(O,C,D,L):null;case hg:return D.key===F?p(O,C,D,L):null;case Rh:return F=D._init,b(O,C,F(D._payload),L)}if(C0(D)||Yj(D))return F!==null?null:g(O,C,D,L,null);U1(O,D)}return null}function w(O,C,D,L,F){if(typeof L=="string"&&L!==""||typeof L=="number")return O=O.get(D)||null,i(C,O,""+L,F);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case O1:return O=O.get(L.key===null?D:L.key)||null,f(C,O,L,F);case hg:return O=O.get(L.key===null?D:L.key)||null,p(C,O,L,F);case Rh:var B=L._init;return w(O,C,D,B(L._payload),F)}if(C0(L)||Yj(L))return O=O.get(D)||null,g(C,O,L,F,null);U1(C,L)}return null}function T(O,C,D,L){for(var F=null,B=null,U=C,te=C=0,Q=null;U!==null&&te<D.length;te++){U.index>te?(Q=U,U=null):Q=U.sibling;var re=b(O,U,D[te],L);if(re===null){U===null&&(U=Q);break}t&&U&&re.alternate===null&&r(O,U),C=o(re,C,te),B===null?F=re:B.sibling=re,B=re,U=Q}if(te===D.length)return s(O,U),ta&&Rf(O,te),F;if(U===null){for(;te<D.length;te++)U=y(O,D[te],L),U!==null&&(C=o(U,C,te),B===null?F=U:B.sibling=U,B=U);return ta&&Rf(O,te),F}for(U=n(O,U);te<D.length;te++)Q=w(U,O,te,D[te],L),Q!==null&&(t&&Q.alternate!==null&&U.delete(Q.key===null?te:Q.key),C=o(Q,C,te),B===null?F=Q:B.sibling=Q,B=Q);return t&&U.forEach(function(Z){return r(O,Z)}),ta&&Rf(O,te),F}function N(O,C,D,L){var F=Yj(D);if(typeof F!="function")throw Error(nr(150));if(D=F.call(D),D==null)throw Error(nr(151));for(var B=F=null,U=C,te=C=0,Q=null,re=D.next();U!==null&&!re.done;te++,re=D.next()){U.index>te?(Q=U,U=null):Q=U.sibling;var Z=b(O,U,re.value,L);if(Z===null){U===null&&(U=Q);break}t&&U&&Z.alternate===null&&r(O,U),C=o(Z,C,te),B===null?F=Z:B.sibling=Z,B=Z,U=Q}if(re.done)return s(O,U),ta&&Rf(O,te),F;if(U===null){for(;!re.done;te++,re=D.next())re=y(O,re.value,L),re!==null&&(C=o(re,C,te),B===null?F=re:B.sibling=re,B=re);return ta&&Rf(O,te),F}for(U=n(O,U);!re.done;te++,re=D.next())re=w(U,O,te,re.value,L),re!==null&&(t&&re.alternate!==null&&U.delete(re.key===null?te:re.key),C=o(re,C,te),B===null?F=re:B.sibling=re,B=re);return t&&U.forEach(function(ne){return r(O,ne)}),ta&&Rf(O,te),F}function M(O,C,D,L){if(typeof D=="object"&&D!==null&&D.type===mg&&D.key===null&&(D=D.props.children),typeof D=="object"&&D!==null){switch(D.$$typeof){case O1:e:{for(var F=D.key,B=C;B!==null;){if(B.key===F){if(F=D.type,F===mg){if(B.tag===7){s(O,B.sibling),C=a(B,D.props.children),C.return=O,O=C;break e}}else if(B.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Rh&&WL(F)===B.type){s(O,B.sibling),C=a(B,D.props),C.ref=t0(O,B,D),C.return=O,O=C;break e}s(O,B);break}else r(O,B);B=B.sibling}D.type===mg?(C=lp(D.props.children,O.mode,L,D.key),C.return=O,O=C):(L=LN(D.type,D.key,D.props,null,O.mode,L),L.ref=t0(O,C,D),L.return=O,O=L)}return c(O);case hg:e:{for(B=D.key;C!==null;){if(C.key===B)if(C.tag===4&&C.stateNode.containerInfo===D.containerInfo&&C.stateNode.implementation===D.implementation){s(O,C.sibling),C=a(C,D.children||[]),C.return=O,O=C;break e}else{s(O,C);break}else r(O,C);C=C.sibling}C=_A(D,O.mode,L),C.return=O,O=C}return c(O);case Rh:return B=D._init,M(O,C,B(D._payload),L)}if(C0(D))return T(O,C,D,L);if(Yj(D))return N(O,C,D,L);U1(O,D)}return typeof D=="string"&&D!==""||typeof D=="number"?(D=""+D,C!==null&&C.tag===6?(s(O,C.sibling),C=a(C,D),C.return=O,O=C):(s(O,C),C=bA(D,O.mode,L),C.return=O,O=C),c(O)):s(O,C)}return M}var ly=vV(!0),jV=vV(!1),nS=Im(null),aS=null,bg=null,LO=null;function FO(){LO=bg=aS=null}function $O(t){var r=nS.current;Zn(nS),t._currentValue=r}function hE(t,r,s){for(;t!==null;){var n=t.alternate;if((t.childLanes&r)!==r?(t.childLanes|=r,n!==null&&(n.childLanes|=r)):n!==null&&(n.childLanes&r)!==r&&(n.childLanes|=r),t===s)break;t=t.return}}function Dg(t,r){aS=t,LO=bg=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&r&&($o=!0),t.firstContext=null)}function Kl(t){var r=t._currentValue;if(LO!==t)if(t={context:t,memoizedValue:r,next:null},bg===null){if(aS===null)throw Error(nr(308));bg=t,aS.dependencies={lanes:0,firstContext:t}}else bg=bg.next=t;return r}var Gf=null;function zO(t){Gf===null?Gf=[t]:Gf.push(t)}function bV(t,r,s,n){var a=r.interleaved;return a===null?(s.next=s,zO(r)):(s.next=a.next,a.next=s),r.interleaved=s,Ru(t,n)}function Ru(t,r){t.lanes|=r;var s=t.alternate;for(s!==null&&(s.lanes|=r),s=t,t=t.return;t!==null;)t.childLanes|=r,s=t.alternate,s!==null&&(s.childLanes|=r),s=t,t=t.return;return s.tag===3?s.stateNode:null}var Lh=!1;function BO(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _V(t,r){t=t.updateQueue,r.updateQueue===t&&(r.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Tu(t,r){return{eventTime:t,lane:r,tag:0,payload:null,callback:null,next:null}}function dm(t,r,s){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Ys&2){var a=n.pending;return a===null?r.next=r:(r.next=a.next,a.next=r),n.pending=r,Ru(t,s)}return a=n.interleaved,a===null?(r.next=r,zO(n)):(r.next=a.next,a.next=r),n.interleaved=r,Ru(t,s)}function EN(t,r,s){if(r=r.updateQueue,r!==null&&(r=r.shared,(s&4194240)!==0)){var n=r.lanes;n&=t.pendingLanes,s|=n,r.lanes=s,CO(t,s)}}function GL(t,r){var s=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,s===n)){var a=null,o=null;if(s=s.firstBaseUpdate,s!==null){do{var c={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};o===null?a=o=c:o=o.next=c,s=s.next}while(s!==null);o===null?a=o=r:o=o.next=r}else a=o=r;s={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:o,shared:n.shared,effects:n.effects},t.updateQueue=s;return}t=s.lastBaseUpdate,t===null?s.firstBaseUpdate=r:t.next=r,s.lastBaseUpdate=r}function iS(t,r,s,n){var a=t.updateQueue;Lh=!1;var o=a.firstBaseUpdate,c=a.lastBaseUpdate,i=a.shared.pending;if(i!==null){a.shared.pending=null;var f=i,p=f.next;f.next=null,c===null?o=p:c.next=p,c=f;var g=t.alternate;g!==null&&(g=g.updateQueue,i=g.lastBaseUpdate,i!==c&&(i===null?g.firstBaseUpdate=p:i.next=p,g.lastBaseUpdate=f))}if(o!==null){var y=a.baseState;c=0,g=p=f=null,i=o;do{var b=i.lane,w=i.eventTime;if((n&b)===b){g!==null&&(g=g.next={eventTime:w,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var T=t,N=i;switch(b=r,w=s,N.tag){case 1:if(T=N.payload,typeof T=="function"){y=T.call(w,y,b);break e}y=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=N.payload,b=typeof T=="function"?T.call(w,y,b):T,b==null)break e;y=pa({},y,b);break e;case 2:Lh=!0}}i.callback!==null&&i.lane!==0&&(t.flags|=64,b=a.effects,b===null?a.effects=[i]:b.push(i))}else w={eventTime:w,lane:b,tag:i.tag,payload:i.payload,callback:i.callback,next:null},g===null?(p=g=w,f=y):g=g.next=w,c|=b;if(i=i.next,i===null){if(i=a.shared.pending,i===null)break;b=i,i=b.next,b.next=null,a.lastBaseUpdate=b,a.shared.pending=null}}while(!0);if(g===null&&(f=y),a.baseState=f,a.firstBaseUpdate=p,a.lastBaseUpdate=g,r=a.shared.interleaved,r!==null){a=r;do c|=a.lane,a=a.next;while(a!==r)}else o===null&&(a.shared.lanes=0);xp|=c,t.lanes=c,t.memoizedState=y}}function KL(t,r,s){if(t=r.effects,r.effects=null,t!==null)for(r=0;r<t.length;r++){var n=t[r],a=n.callback;if(a!==null){if(n.callback=null,n=s,typeof a!="function")throw Error(nr(191,a));a.call(n)}}}var S_={},Nd=Im(S_),db=Im(S_),ub=Im(S_);function Kf(t){if(t===S_)throw Error(nr(174));return t}function qO(t,r){switch($n(ub,r),$n(db,t),$n(Nd,S_),t=r.nodeType,t){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:GT(null,"");break;default:t=t===8?r.parentNode:r,r=t.namespaceURI||null,t=t.tagName,r=GT(r,t)}Zn(Nd),$n(Nd,r)}function cy(){Zn(Nd),Zn(db),Zn(ub)}function wV(t){Kf(ub.current);var r=Kf(Nd.current),s=GT(r,t.type);r!==s&&($n(db,t),$n(Nd,s))}function VO(t){db.current===t&&(Zn(Nd),Zn(db))}var la=Im(0);function oS(t){for(var r=t;r!==null;){if(r.tag===13){var s=r.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if(r.flags&128)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var pA=[];function UO(){for(var t=0;t<pA.length;t++)pA[t]._workInProgressVersionPrimary=null;pA.length=0}var MN=Ku.ReactCurrentDispatcher,xA=Ku.ReactCurrentBatchConfig,pp=0,ua=null,ai=null,bi=null,lS=!1,B0=!1,hb=0,kre=0;function ro(){throw Error(nr(321))}function WO(t,r){if(r===null)return!1;for(var s=0;s<r.length&&s<t.length;s++)if(!Gc(t[s],r[s]))return!1;return!0}function GO(t,r,s,n,a,o){if(pp=o,ua=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,MN.current=t===null||t.memoizedState===null?Mre:Ore,t=s(n,a),B0){o=0;do{if(B0=!1,hb=0,25<=o)throw Error(nr(301));o+=1,bi=ai=null,r.updateQueue=null,MN.current=Ire,t=s(n,a)}while(B0)}if(MN.current=cS,r=ai!==null&&ai.next!==null,pp=0,bi=ai=ua=null,lS=!1,r)throw Error(nr(300));return t}function KO(){var t=hb!==0;return hb=0,t}function ud(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bi===null?ua.memoizedState=bi=t:bi=bi.next=t,bi}function Hl(){if(ai===null){var t=ua.alternate;t=t!==null?t.memoizedState:null}else t=ai.next;var r=bi===null?ua.memoizedState:bi.next;if(r!==null)bi=r,ai=t;else{if(t===null)throw Error(nr(310));ai=t,t={memoizedState:ai.memoizedState,baseState:ai.baseState,baseQueue:ai.baseQueue,queue:ai.queue,next:null},bi===null?ua.memoizedState=bi=t:bi=bi.next=t}return bi}function mb(t,r){return typeof r=="function"?r(t):r}function gA(t){var r=Hl(),s=r.queue;if(s===null)throw Error(nr(311));s.lastRenderedReducer=t;var n=ai,a=n.baseQueue,o=s.pending;if(o!==null){if(a!==null){var c=a.next;a.next=o.next,o.next=c}n.baseQueue=a=o,s.pending=null}if(a!==null){o=a.next,n=n.baseState;var i=c=null,f=null,p=o;do{var g=p.lane;if((pp&g)===g)f!==null&&(f=f.next={lane:0,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null}),n=p.hasEagerState?p.eagerState:t(n,p.action);else{var y={lane:g,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null};f===null?(i=f=y,c=n):f=f.next=y,ua.lanes|=g,xp|=g}p=p.next}while(p!==null&&p!==o);f===null?c=n:f.next=i,Gc(n,r.memoizedState)||($o=!0),r.memoizedState=n,r.baseState=c,r.baseQueue=f,s.lastRenderedState=n}if(t=s.interleaved,t!==null){a=t;do o=a.lane,ua.lanes|=o,xp|=o,a=a.next;while(a!==t)}else a===null&&(s.lanes=0);return[r.memoizedState,s.dispatch]}function yA(t){var r=Hl(),s=r.queue;if(s===null)throw Error(nr(311));s.lastRenderedReducer=t;var n=s.dispatch,a=s.pending,o=r.memoizedState;if(a!==null){s.pending=null;var c=a=a.next;do o=t(o,c.action),c=c.next;while(c!==a);Gc(o,r.memoizedState)||($o=!0),r.memoizedState=o,r.baseQueue===null&&(r.baseState=o),s.lastRenderedState=o}return[o,n]}function NV(){}function SV(t,r){var s=ua,n=Hl(),a=r(),o=!Gc(n.memoizedState,a);if(o&&(n.memoizedState=a,$o=!0),n=n.queue,HO(kV.bind(null,s,n,t),[t]),n.getSnapshot!==r||o||bi!==null&&bi.memoizedState.tag&1){if(s.flags|=2048,fb(9,PV.bind(null,s,n,a,r),void 0,null),Ci===null)throw Error(nr(349));pp&30||CV(s,r,a)}return a}function CV(t,r,s){t.flags|=16384,t={getSnapshot:r,value:s},r=ua.updateQueue,r===null?(r={lastEffect:null,stores:null},ua.updateQueue=r,r.stores=[t]):(s=r.stores,s===null?r.stores=[t]:s.push(t))}function PV(t,r,s,n){r.value=s,r.getSnapshot=n,AV(r)&&TV(t)}function kV(t,r,s){return s(function(){AV(r)&&TV(t)})}function AV(t){var r=t.getSnapshot;t=t.value;try{var s=r();return!Gc(t,s)}catch{return!0}}function TV(t){var r=Ru(t,1);r!==null&&qc(r,t,1,-1)}function HL(t){var r=ud();return typeof t=="function"&&(t=t()),r.memoizedState=r.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mb,lastRenderedState:t},r.queue=t,t=t.dispatch=Ere.bind(null,ua,t),[r.memoizedState,t]}function fb(t,r,s,n){return t={tag:t,create:r,destroy:s,deps:n,next:null},r=ua.updateQueue,r===null?(r={lastEffect:null,stores:null},ua.updateQueue=r,r.lastEffect=t.next=t):(s=r.lastEffect,s===null?r.lastEffect=t.next=t:(n=s.next,s.next=t,t.next=n,r.lastEffect=t)),t}function EV(){return Hl().memoizedState}function ON(t,r,s,n){var a=ud();ua.flags|=t,a.memoizedState=fb(1|r,s,void 0,n===void 0?null:n)}function aC(t,r,s,n){var a=Hl();n=n===void 0?null:n;var o=void 0;if(ai!==null){var c=ai.memoizedState;if(o=c.destroy,n!==null&&WO(n,c.deps)){a.memoizedState=fb(r,s,o,n);return}}ua.flags|=t,a.memoizedState=fb(1|r,s,o,n)}function ZL(t,r){return ON(8390656,8,t,r)}function HO(t,r){return aC(2048,8,t,r)}function MV(t,r){return aC(4,2,t,r)}function OV(t,r){return aC(4,4,t,r)}function IV(t,r){if(typeof r=="function")return t=t(),r(t),function(){r(null)};if(r!=null)return t=t(),r.current=t,function(){r.current=null}}function DV(t,r,s){return s=s!=null?s.concat([t]):null,aC(4,4,IV.bind(null,r,t),s)}function ZO(){}function RV(t,r){var s=Hl();r=r===void 0?null:r;var n=s.memoizedState;return n!==null&&r!==null&&WO(r,n[1])?n[0]:(s.memoizedState=[t,r],t)}function LV(t,r){var s=Hl();r=r===void 0?null:r;var n=s.memoizedState;return n!==null&&r!==null&&WO(r,n[1])?n[0]:(t=t(),s.memoizedState=[t,r],t)}function FV(t,r,s){return pp&21?(Gc(s,r)||(s=Vq(),ua.lanes|=s,xp|=s,t.baseState=!0),r):(t.baseState&&(t.baseState=!1,$o=!0),t.memoizedState=s)}function Are(t,r){var s=mn;mn=s!==0&&4>s?s:4,t(!0);var n=xA.transition;xA.transition={};try{t(!1),r()}finally{mn=s,xA.transition=n}}function $V(){return Hl().memoizedState}function Tre(t,r,s){var n=hm(t);if(s={lane:n,action:s,hasEagerState:!1,eagerState:null,next:null},zV(t))BV(r,s);else if(s=bV(t,r,s,n),s!==null){var a=Co();qc(s,t,n,a),qV(s,r,n)}}function Ere(t,r,s){var n=hm(t),a={lane:n,action:s,hasEagerState:!1,eagerState:null,next:null};if(zV(t))BV(r,a);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=r.lastRenderedReducer,o!==null))try{var c=r.lastRenderedState,i=o(c,s);if(a.hasEagerState=!0,a.eagerState=i,Gc(i,c)){var f=r.interleaved;f===null?(a.next=a,zO(r)):(a.next=f.next,f.next=a),r.interleaved=a;return}}catch{}finally{}s=bV(t,r,a,n),s!==null&&(a=Co(),qc(s,t,n,a),qV(s,r,n))}}function zV(t){var r=t.alternate;return t===ua||r!==null&&r===ua}function BV(t,r){B0=lS=!0;var s=t.pending;s===null?r.next=r:(r.next=s.next,s.next=r),t.pending=r}function qV(t,r,s){if(s&4194240){var n=r.lanes;n&=t.pendingLanes,s|=n,r.lanes=s,CO(t,s)}}var cS={readContext:Kl,useCallback:ro,useContext:ro,useEffect:ro,useImperativeHandle:ro,useInsertionEffect:ro,useLayoutEffect:ro,useMemo:ro,useReducer:ro,useRef:ro,useState:ro,useDebugValue:ro,useDeferredValue:ro,useTransition:ro,useMutableSource:ro,useSyncExternalStore:ro,useId:ro,unstable_isNewReconciler:!1},Mre={readContext:Kl,useCallback:function(t,r){return ud().memoizedState=[t,r===void 0?null:r],t},useContext:Kl,useEffect:ZL,useImperativeHandle:function(t,r,s){return s=s!=null?s.concat([t]):null,ON(4194308,4,IV.bind(null,r,t),s)},useLayoutEffect:function(t,r){return ON(4194308,4,t,r)},useInsertionEffect:function(t,r){return ON(4,2,t,r)},useMemo:function(t,r){var s=ud();return r=r===void 0?null:r,t=t(),s.memoizedState=[t,r],t},useReducer:function(t,r,s){var n=ud();return r=s!==void 0?s(r):r,n.memoizedState=n.baseState=r,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:r},n.queue=t,t=t.dispatch=Tre.bind(null,ua,t),[n.memoizedState,t]},useRef:function(t){var r=ud();return t={current:t},r.memoizedState=t},useState:HL,useDebugValue:ZO,useDeferredValue:function(t){return ud().memoizedState=t},useTransition:function(){var t=HL(!1),r=t[0];return t=Are.bind(null,t[1]),ud().memoizedState=t,[r,t]},useMutableSource:function(){},useSyncExternalStore:function(t,r,s){var n=ua,a=ud();if(ta){if(s===void 0)throw Error(nr(407));s=s()}else{if(s=r(),Ci===null)throw Error(nr(349));pp&30||CV(n,r,s)}a.memoizedState=s;var o={value:s,getSnapshot:r};return a.queue=o,ZL(kV.bind(null,n,o,t),[t]),n.flags|=2048,fb(9,PV.bind(null,n,o,s,r),void 0,null),s},useId:function(){var t=ud(),r=Ci.identifierPrefix;if(ta){var s=Su,n=Nu;s=(n&~(1<<32-Bc(n)-1)).toString(32)+s,r=":"+r+"R"+s,s=hb++,0<s&&(r+="H"+s.toString(32)),r+=":"}else s=kre++,r=":"+r+"r"+s.toString(32)+":";return t.memoizedState=r},unstable_isNewReconciler:!1},Ore={readContext:Kl,useCallback:RV,useContext:Kl,useEffect:HO,useImperativeHandle:DV,useInsertionEffect:MV,useLayoutEffect:OV,useMemo:LV,useReducer:gA,useRef:EV,useState:function(){return gA(mb)},useDebugValue:ZO,useDeferredValue:function(t){var r=Hl();return FV(r,ai.memoizedState,t)},useTransition:function(){var t=gA(mb)[0],r=Hl().memoizedState;return[t,r]},useMutableSource:NV,useSyncExternalStore:SV,useId:$V,unstable_isNewReconciler:!1},Ire={readContext:Kl,useCallback:RV,useContext:Kl,useEffect:HO,useImperativeHandle:DV,useInsertionEffect:MV,useLayoutEffect:OV,useMemo:LV,useReducer:yA,useRef:EV,useState:function(){return yA(mb)},useDebugValue:ZO,useDeferredValue:function(t){var r=Hl();return ai===null?r.memoizedState=t:FV(r,ai.memoizedState,t)},useTransition:function(){var t=yA(mb)[0],r=Hl().memoizedState;return[t,r]},useMutableSource:NV,useSyncExternalStore:SV,useId:$V,unstable_isNewReconciler:!1};function Cc(t,r){if(t&&t.defaultProps){r=pa({},r),t=t.defaultProps;for(var s in t)r[s]===void 0&&(r[s]=t[s]);return r}return r}function mE(t,r,s,n){r=t.memoizedState,s=s(n,r),s=s==null?r:pa({},r,s),t.memoizedState=s,t.lanes===0&&(t.updateQueue.baseState=s)}var iC={isMounted:function(t){return(t=t._reactInternals)?Rp(t)===t:!1},enqueueSetState:function(t,r,s){t=t._reactInternals;var n=Co(),a=hm(t),o=Tu(n,a);o.payload=r,s!=null&&(o.callback=s),r=dm(t,o,a),r!==null&&(qc(r,t,a,n),EN(r,t,a))},enqueueReplaceState:function(t,r,s){t=t._reactInternals;var n=Co(),a=hm(t),o=Tu(n,a);o.tag=1,o.payload=r,s!=null&&(o.callback=s),r=dm(t,o,a),r!==null&&(qc(r,t,a,n),EN(r,t,a))},enqueueForceUpdate:function(t,r){t=t._reactInternals;var s=Co(),n=hm(t),a=Tu(s,n);a.tag=2,r!=null&&(a.callback=r),r=dm(t,a,n),r!==null&&(qc(r,t,n,s),EN(r,t,n))}};function YL(t,r,s,n,a,o,c){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,o,c):r.prototype&&r.prototype.isPureReactComponent?!ib(s,n)||!ib(a,o):!0}function VV(t,r,s){var n=!1,a=bm,o=r.contextType;return typeof o=="object"&&o!==null?o=Kl(o):(a=Wo(r)?mp:ho.current,n=r.contextTypes,o=(n=n!=null)?iy(t,a):bm),r=new r(s,o),t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=iC,t.stateNode=r,r._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=o),r}function XL(t,r,s,n){t=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(s,n),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(s,n),r.state!==t&&iC.enqueueReplaceState(r,r.state,null)}function fE(t,r,s,n){var a=t.stateNode;a.props=s,a.state=t.memoizedState,a.refs={},BO(t);var o=r.contextType;typeof o=="object"&&o!==null?a.context=Kl(o):(o=Wo(r)?mp:ho.current,a.context=iy(t,o)),a.state=t.memoizedState,o=r.getDerivedStateFromProps,typeof o=="function"&&(mE(t,r,o,s),a.state=t.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(r=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),r!==a.state&&iC.enqueueReplaceState(a,a.state,null),iS(t,s,a,n),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function dy(t,r){try{var s="",n=r;do s+=lte(n),n=n.return;while(n);var a=s}catch(o){a=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:r,stack:a,digest:null}}function vA(t,r,s){return{value:t,source:null,stack:s??null,digest:r??null}}function pE(t,r){try{console.error(r.value)}catch(s){setTimeout(function(){throw s})}}var Dre=typeof WeakMap=="function"?WeakMap:Map;function UV(t,r,s){s=Tu(-1,s),s.tag=3,s.payload={element:null};var n=r.value;return s.callback=function(){uS||(uS=!0,SE=n),pE(t,r)},s}function WV(t,r,s){s=Tu(-1,s),s.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var a=r.value;s.payload=function(){return n(a)},s.callback=function(){pE(t,r)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(s.callback=function(){pE(t,r),typeof n!="function"&&(um===null?um=new Set([this]):um.add(this));var c=r.stack;this.componentDidCatch(r.value,{componentStack:c!==null?c:""})}),s}function QL(t,r,s){var n=t.pingCache;if(n===null){n=t.pingCache=new Dre;var a=new Set;n.set(r,a)}else a=n.get(r),a===void 0&&(a=new Set,n.set(r,a));a.has(s)||(a.add(s),t=Zre.bind(null,t,r,s),r.then(t,t))}function JL(t){do{var r;if((r=t.tag===13)&&(r=t.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return t;t=t.return}while(t!==null);return null}function eF(t,r,s,n,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===r?t.flags|=65536:(t.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(r=Tu(-1,1),r.tag=2,dm(s,r,1))),s.lanes|=1),t)}var Rre=Ku.ReactCurrentOwner,$o=!1;function _o(t,r,s,n){r.child=t===null?jV(r,null,s,n):ly(r,t.child,s,n)}function tF(t,r,s,n,a){s=s.render;var o=r.ref;return Dg(r,a),n=GO(t,r,s,n,o,a),s=KO(),t!==null&&!$o?(r.updateQueue=t.updateQueue,r.flags&=-2053,t.lanes&=~a,Lu(t,r,a)):(ta&&s&&IO(r),r.flags|=1,_o(t,r,n,a),r.child)}function rF(t,r,s,n,a){if(t===null){var o=s.type;return typeof o=="function"&&!sI(o)&&o.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(r.tag=15,r.type=o,GV(t,r,o,n,a)):(t=LN(s.type,null,n,r,r.mode,a),t.ref=r.ref,t.return=r,r.child=t)}if(o=t.child,!(t.lanes&a)){var c=o.memoizedProps;if(s=s.compare,s=s!==null?s:ib,s(c,n)&&t.ref===r.ref)return Lu(t,r,a)}return r.flags|=1,t=mm(o,n),t.ref=r.ref,t.return=r,r.child=t}function GV(t,r,s,n,a){if(t!==null){var o=t.memoizedProps;if(ib(o,n)&&t.ref===r.ref)if($o=!1,r.pendingProps=n=o,(t.lanes&a)!==0)t.flags&131072&&($o=!0);else return r.lanes=t.lanes,Lu(t,r,a)}return xE(t,r,s,n,a)}function KV(t,r,s){var n=r.pendingProps,a=n.children,o=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(r.mode&1))r.memoizedState={baseLanes:0,cachePool:null,transitions:null},$n(wg,cl),cl|=s;else{if(!(s&1073741824))return t=o!==null?o.baseLanes|s:s,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:t,cachePool:null,transitions:null},r.updateQueue=null,$n(wg,cl),cl|=t,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:s,$n(wg,cl),cl|=n}else o!==null?(n=o.baseLanes|s,r.memoizedState=null):n=s,$n(wg,cl),cl|=n;return _o(t,r,a,s),r.child}function HV(t,r){var s=r.ref;(t===null&&s!==null||t!==null&&t.ref!==s)&&(r.flags|=512,r.flags|=2097152)}function xE(t,r,s,n,a){var o=Wo(s)?mp:ho.current;return o=iy(r,o),Dg(r,a),s=GO(t,r,s,n,o,a),n=KO(),t!==null&&!$o?(r.updateQueue=t.updateQueue,r.flags&=-2053,t.lanes&=~a,Lu(t,r,a)):(ta&&n&&IO(r),r.flags|=1,_o(t,r,s,a),r.child)}function sF(t,r,s,n,a){if(Wo(s)){var o=!0;tS(r)}else o=!1;if(Dg(r,a),r.stateNode===null)IN(t,r),VV(r,s,n),fE(r,s,n,a),n=!0;else if(t===null){var c=r.stateNode,i=r.memoizedProps;c.props=i;var f=c.context,p=s.contextType;typeof p=="object"&&p!==null?p=Kl(p):(p=Wo(s)?mp:ho.current,p=iy(r,p));var g=s.getDerivedStateFromProps,y=typeof g=="function"||typeof c.getSnapshotBeforeUpdate=="function";y||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(i!==n||f!==p)&&XL(r,c,n,p),Lh=!1;var b=r.memoizedState;c.state=b,iS(r,n,c,a),f=r.memoizedState,i!==n||b!==f||Uo.current||Lh?(typeof g=="function"&&(mE(r,s,g,n),f=r.memoizedState),(i=Lh||YL(r,s,i,n,b,f,p))?(y||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(r.flags|=4194308)):(typeof c.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=n,r.memoizedState=f),c.props=n,c.state=f,c.context=p,n=i):(typeof c.componentDidMount=="function"&&(r.flags|=4194308),n=!1)}else{c=r.stateNode,_V(t,r),i=r.memoizedProps,p=r.type===r.elementType?i:Cc(r.type,i),c.props=p,y=r.pendingProps,b=c.context,f=s.contextType,typeof f=="object"&&f!==null?f=Kl(f):(f=Wo(s)?mp:ho.current,f=iy(r,f));var w=s.getDerivedStateFromProps;(g=typeof w=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(i!==y||b!==f)&&XL(r,c,n,f),Lh=!1,b=r.memoizedState,c.state=b,iS(r,n,c,a);var T=r.memoizedState;i!==y||b!==T||Uo.current||Lh?(typeof w=="function"&&(mE(r,s,w,n),T=r.memoizedState),(p=Lh||YL(r,s,p,n,b,T,f)||!1)?(g||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(n,T,f),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(n,T,f)),typeof c.componentDidUpdate=="function"&&(r.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof c.componentDidUpdate!="function"||i===t.memoizedProps&&b===t.memoizedState||(r.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||i===t.memoizedProps&&b===t.memoizedState||(r.flags|=1024),r.memoizedProps=n,r.memoizedState=T),c.props=n,c.state=T,c.context=f,n=p):(typeof c.componentDidUpdate!="function"||i===t.memoizedProps&&b===t.memoizedState||(r.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||i===t.memoizedProps&&b===t.memoizedState||(r.flags|=1024),n=!1)}return gE(t,r,s,n,o,a)}function gE(t,r,s,n,a,o){HV(t,r);var c=(r.flags&128)!==0;if(!n&&!c)return a&&qL(r,s,!1),Lu(t,r,o);n=r.stateNode,Rre.current=r;var i=c&&typeof s.getDerivedStateFromError!="function"?null:n.render();return r.flags|=1,t!==null&&c?(r.child=ly(r,t.child,null,o),r.child=ly(r,null,i,o)):_o(t,r,i,o),r.memoizedState=n.state,a&&qL(r,s,!0),r.child}function ZV(t){var r=t.stateNode;r.pendingContext?BL(t,r.pendingContext,r.pendingContext!==r.context):r.context&&BL(t,r.context,!1),qO(t,r.containerInfo)}function nF(t,r,s,n,a){return oy(),RO(a),r.flags|=256,_o(t,r,s,n),r.child}var yE={dehydrated:null,treeContext:null,retryLane:0};function vE(t){return{baseLanes:t,cachePool:null,transitions:null}}function YV(t,r,s){var n=r.pendingProps,a=la.current,o=!1,c=(r.flags&128)!==0,i;if((i=c)||(i=t!==null&&t.memoizedState===null?!1:(a&2)!==0),i?(o=!0,r.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),$n(la,a&1),t===null)return uE(r),t=r.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(r.mode&1?t.data==="$!"?r.lanes=8:r.lanes=1073741824:r.lanes=1,null):(c=n.children,t=n.fallback,o?(n=r.mode,o=r.child,c={mode:"hidden",children:c},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=c):o=cC(c,n,0,null),t=lp(t,n,s,null),o.return=r,t.return=r,o.sibling=t,r.child=o,r.child.memoizedState=vE(s),r.memoizedState=yE,t):YO(r,c));if(a=t.memoizedState,a!==null&&(i=a.dehydrated,i!==null))return Lre(t,r,c,n,i,a,s);if(o){o=n.fallback,c=r.mode,a=t.child,i=a.sibling;var f={mode:"hidden",children:n.children};return!(c&1)&&r.child!==a?(n=r.child,n.childLanes=0,n.pendingProps=f,r.deletions=null):(n=mm(a,f),n.subtreeFlags=a.subtreeFlags&14680064),i!==null?o=mm(i,o):(o=lp(o,c,s,null),o.flags|=2),o.return=r,n.return=r,n.sibling=o,r.child=n,n=o,o=r.child,c=t.child.memoizedState,c=c===null?vE(s):{baseLanes:c.baseLanes|s,cachePool:null,transitions:c.transitions},o.memoizedState=c,o.childLanes=t.childLanes&~s,r.memoizedState=yE,n}return o=t.child,t=o.sibling,n=mm(o,{mode:"visible",children:n.children}),!(r.mode&1)&&(n.lanes=s),n.return=r,n.sibling=null,t!==null&&(s=r.deletions,s===null?(r.deletions=[t],r.flags|=16):s.push(t)),r.child=n,r.memoizedState=null,n}function YO(t,r){return r=cC({mode:"visible",children:r},t.mode,0,null),r.return=t,t.child=r}function W1(t,r,s,n){return n!==null&&RO(n),ly(r,t.child,null,s),t=YO(r,r.pendingProps.children),t.flags|=2,r.memoizedState=null,t}function Lre(t,r,s,n,a,o,c){if(s)return r.flags&256?(r.flags&=-257,n=vA(Error(nr(422))),W1(t,r,c,n)):r.memoizedState!==null?(r.child=t.child,r.flags|=128,null):(o=n.fallback,a=r.mode,n=cC({mode:"visible",children:n.children},a,0,null),o=lp(o,a,c,null),o.flags|=2,n.return=r,o.return=r,n.sibling=o,r.child=n,r.mode&1&&ly(r,t.child,null,c),r.child.memoizedState=vE(c),r.memoizedState=yE,o);if(!(r.mode&1))return W1(t,r,c,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var i=n.dgst;return n=i,o=Error(nr(419)),n=vA(o,n,void 0),W1(t,r,c,n)}if(i=(c&t.childLanes)!==0,$o||i){if(n=Ci,n!==null){switch(c&-c){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|c)?0:a,a!==0&&a!==o.retryLane&&(o.retryLane=a,Ru(t,a),qc(n,t,a,-1))}return rI(),n=vA(Error(nr(421))),W1(t,r,c,n)}return a.data==="$?"?(r.flags|=128,r.child=t.child,r=Yre.bind(null,t),a._reactRetry=r,null):(t=o.treeContext,xl=cm(a.nextSibling),gl=r,ta=!0,Ec=null,t!==null&&(Rl[Ll++]=Nu,Rl[Ll++]=Su,Rl[Ll++]=fp,Nu=t.id,Su=t.overflow,fp=r),r=YO(r,n.children),r.flags|=4096,r)}function aF(t,r,s){t.lanes|=r;var n=t.alternate;n!==null&&(n.lanes|=r),hE(t.return,r,s)}function jA(t,r,s,n,a){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:n,tail:s,tailMode:a}:(o.isBackwards=r,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=s,o.tailMode=a)}function XV(t,r,s){var n=r.pendingProps,a=n.revealOrder,o=n.tail;if(_o(t,r,n.children,s),n=la.current,n&2)n=n&1|2,r.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=r.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&aF(t,s,r);else if(t.tag===19)aF(t,s,r);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===r)break e;for(;t.sibling===null;){if(t.return===null||t.return===r)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if($n(la,n),!(r.mode&1))r.memoizedState=null;else switch(a){case"forwards":for(s=r.child,a=null;s!==null;)t=s.alternate,t!==null&&oS(t)===null&&(a=s),s=s.sibling;s=a,s===null?(a=r.child,r.child=null):(a=s.sibling,s.sibling=null),jA(r,!1,a,s,o);break;case"backwards":for(s=null,a=r.child,r.child=null;a!==null;){if(t=a.alternate,t!==null&&oS(t)===null){r.child=a;break}t=a.sibling,a.sibling=s,s=a,a=t}jA(r,!0,s,null,o);break;case"together":jA(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function IN(t,r){!(r.mode&1)&&t!==null&&(t.alternate=null,r.alternate=null,r.flags|=2)}function Lu(t,r,s){if(t!==null&&(r.dependencies=t.dependencies),xp|=r.lanes,!(s&r.childLanes))return null;if(t!==null&&r.child!==t.child)throw Error(nr(153));if(r.child!==null){for(t=r.child,s=mm(t,t.pendingProps),r.child=s,s.return=r;t.sibling!==null;)t=t.sibling,s=s.sibling=mm(t,t.pendingProps),s.return=r;s.sibling=null}return r.child}function Fre(t,r,s){switch(r.tag){case 3:ZV(r),oy();break;case 5:wV(r);break;case 1:Wo(r.type)&&tS(r);break;case 4:qO(r,r.stateNode.containerInfo);break;case 10:var n=r.type._context,a=r.memoizedProps.value;$n(nS,n._currentValue),n._currentValue=a;break;case 13:if(n=r.memoizedState,n!==null)return n.dehydrated!==null?($n(la,la.current&1),r.flags|=128,null):s&r.child.childLanes?YV(t,r,s):($n(la,la.current&1),t=Lu(t,r,s),t!==null?t.sibling:null);$n(la,la.current&1);break;case 19:if(n=(s&r.childLanes)!==0,t.flags&128){if(n)return XV(t,r,s);r.flags|=128}if(a=r.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),$n(la,la.current),n)break;return null;case 22:case 23:return r.lanes=0,KV(t,r,s)}return Lu(t,r,s)}var QV,jE,JV,eU;QV=function(t,r){for(var s=r.child;s!==null;){if(s.tag===5||s.tag===6)t.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};jE=function(){};JV=function(t,r,s,n){var a=t.memoizedProps;if(a!==n){t=r.stateNode,Kf(Nd.current);var o=null;switch(s){case"input":a=qT(t,a),n=qT(t,n),o=[];break;case"select":a=pa({},a,{value:void 0}),n=pa({},n,{value:void 0}),o=[];break;case"textarea":a=WT(t,a),n=WT(t,n),o=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=JN)}KT(s,n);var c;s=null;for(p in a)if(!n.hasOwnProperty(p)&&a.hasOwnProperty(p)&&a[p]!=null)if(p==="style"){var i=a[p];for(c in i)i.hasOwnProperty(c)&&(s||(s={}),s[c]="")}else p!=="dangerouslySetInnerHTML"&&p!=="children"&&p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(J0.hasOwnProperty(p)?o||(o=[]):(o=o||[]).push(p,null));for(p in n){var f=n[p];if(i=a!=null?a[p]:void 0,n.hasOwnProperty(p)&&f!==i&&(f!=null||i!=null))if(p==="style")if(i){for(c in i)!i.hasOwnProperty(c)||f&&f.hasOwnProperty(c)||(s||(s={}),s[c]="");for(c in f)f.hasOwnProperty(c)&&i[c]!==f[c]&&(s||(s={}),s[c]=f[c])}else s||(o||(o=[]),o.push(p,s)),s=f;else p==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,i=i?i.__html:void 0,f!=null&&i!==f&&(o=o||[]).push(p,f)):p==="children"?typeof f!="string"&&typeof f!="number"||(o=o||[]).push(p,""+f):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&(J0.hasOwnProperty(p)?(f!=null&&p==="onScroll"&&Vn("scroll",t),o||i===f||(o=[])):(o=o||[]).push(p,f))}s&&(o=o||[]).push("style",s);var p=o;(r.updateQueue=p)&&(r.flags|=4)}};eU=function(t,r,s,n){s!==n&&(r.flags|=4)};function r0(t,r){if(!ta)switch(t.tailMode){case"hidden":r=t.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?t.tail=null:s.sibling=null;break;case"collapsed":s=t.tail;for(var n=null;s!==null;)s.alternate!==null&&(n=s),s=s.sibling;n===null?r||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function so(t){var r=t.alternate!==null&&t.alternate.child===t.child,s=0,n=0;if(r)for(var a=t.child;a!==null;)s|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)s|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=n,t.childLanes=s,r}function $re(t,r,s){var n=r.pendingProps;switch(DO(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return so(r),null;case 1:return Wo(r.type)&&eS(),so(r),null;case 3:return n=r.stateNode,cy(),Zn(Uo),Zn(ho),UO(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(V1(r)?r.flags|=4:t===null||t.memoizedState.isDehydrated&&!(r.flags&256)||(r.flags|=1024,Ec!==null&&(kE(Ec),Ec=null))),jE(t,r),so(r),null;case 5:VO(r);var a=Kf(ub.current);if(s=r.type,t!==null&&r.stateNode!=null)JV(t,r,s,n,a),t.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!n){if(r.stateNode===null)throw Error(nr(166));return so(r),null}if(t=Kf(Nd.current),V1(r)){n=r.stateNode,s=r.type;var o=r.memoizedProps;switch(n[yd]=r,n[cb]=o,t=(r.mode&1)!==0,s){case"dialog":Vn("cancel",n),Vn("close",n);break;case"iframe":case"object":case"embed":Vn("load",n);break;case"video":case"audio":for(a=0;a<k0.length;a++)Vn(k0[a],n);break;case"source":Vn("error",n);break;case"img":case"image":case"link":Vn("error",n),Vn("load",n);break;case"details":Vn("toggle",n);break;case"input":fL(n,o),Vn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},Vn("invalid",n);break;case"textarea":xL(n,o),Vn("invalid",n)}KT(s,o),a=null;for(var c in o)if(o.hasOwnProperty(c)){var i=o[c];c==="children"?typeof i=="string"?n.textContent!==i&&(o.suppressHydrationWarning!==!0&&q1(n.textContent,i,t),a=["children",i]):typeof i=="number"&&n.textContent!==""+i&&(o.suppressHydrationWarning!==!0&&q1(n.textContent,i,t),a=["children",""+i]):J0.hasOwnProperty(c)&&i!=null&&c==="onScroll"&&Vn("scroll",n)}switch(s){case"input":I1(n),pL(n,o,!0);break;case"textarea":I1(n),gL(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=JN)}n=a,r.updateQueue=n,n!==null&&(r.flags|=4)}else{c=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=kq(s)),t==="http://www.w3.org/1999/xhtml"?s==="script"?(t=c.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=c.createElement(s,{is:n.is}):(t=c.createElement(s),s==="select"&&(c=t,n.multiple?c.multiple=!0:n.size&&(c.size=n.size))):t=c.createElementNS(t,s),t[yd]=r,t[cb]=n,QV(t,r,!1,!1),r.stateNode=t;e:{switch(c=HT(s,n),s){case"dialog":Vn("cancel",t),Vn("close",t),a=n;break;case"iframe":case"object":case"embed":Vn("load",t),a=n;break;case"video":case"audio":for(a=0;a<k0.length;a++)Vn(k0[a],t);a=n;break;case"source":Vn("error",t),a=n;break;case"img":case"image":case"link":Vn("error",t),Vn("load",t),a=n;break;case"details":Vn("toggle",t),a=n;break;case"input":fL(t,n),a=qT(t,n),Vn("invalid",t);break;case"option":a=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},a=pa({},n,{value:void 0}),Vn("invalid",t);break;case"textarea":xL(t,n),a=WT(t,n),Vn("invalid",t);break;default:a=n}KT(s,a),i=a;for(o in i)if(i.hasOwnProperty(o)){var f=i[o];o==="style"?Eq(t,f):o==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,f!=null&&Aq(t,f)):o==="children"?typeof f=="string"?(s!=="textarea"||f!=="")&&eb(t,f):typeof f=="number"&&eb(t,""+f):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(J0.hasOwnProperty(o)?f!=null&&o==="onScroll"&&Vn("scroll",t):f!=null&&jO(t,o,f,c))}switch(s){case"input":I1(t),pL(t,n,!1);break;case"textarea":I1(t),gL(t);break;case"option":n.value!=null&&t.setAttribute("value",""+jm(n.value));break;case"select":t.multiple=!!n.multiple,o=n.value,o!=null?Eg(t,!!n.multiple,o,!1):n.defaultValue!=null&&Eg(t,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=JN)}switch(s){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return so(r),null;case 6:if(t&&r.stateNode!=null)eU(t,r,t.memoizedProps,n);else{if(typeof n!="string"&&r.stateNode===null)throw Error(nr(166));if(s=Kf(ub.current),Kf(Nd.current),V1(r)){if(n=r.stateNode,s=r.memoizedProps,n[yd]=r,(o=n.nodeValue!==s)&&(t=gl,t!==null))switch(t.tag){case 3:q1(n.nodeValue,s,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&q1(n.nodeValue,s,(t.mode&1)!==0)}o&&(r.flags|=4)}else n=(s.nodeType===9?s:s.ownerDocument).createTextNode(n),n[yd]=r,r.stateNode=n}return so(r),null;case 13:if(Zn(la),n=r.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ta&&xl!==null&&r.mode&1&&!(r.flags&128))yV(),oy(),r.flags|=98560,o=!1;else if(o=V1(r),n!==null&&n.dehydrated!==null){if(t===null){if(!o)throw Error(nr(318));if(o=r.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(nr(317));o[yd]=r}else oy(),!(r.flags&128)&&(r.memoizedState=null),r.flags|=4;so(r),o=!1}else Ec!==null&&(kE(Ec),Ec=null),o=!0;if(!o)return r.flags&65536?r:null}return r.flags&128?(r.lanes=s,r):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(r.child.flags|=8192,r.mode&1&&(t===null||la.current&1?li===0&&(li=3):rI())),r.updateQueue!==null&&(r.flags|=4),so(r),null);case 4:return cy(),jE(t,r),t===null&&ob(r.stateNode.containerInfo),so(r),null;case 10:return $O(r.type._context),so(r),null;case 17:return Wo(r.type)&&eS(),so(r),null;case 19:if(Zn(la),o=r.memoizedState,o===null)return so(r),null;if(n=(r.flags&128)!==0,c=o.rendering,c===null)if(n)r0(o,!1);else{if(li!==0||t!==null&&t.flags&128)for(t=r.child;t!==null;){if(c=oS(t),c!==null){for(r.flags|=128,r0(o,!1),n=c.updateQueue,n!==null&&(r.updateQueue=n,r.flags|=4),r.subtreeFlags=0,n=s,s=r.child;s!==null;)o=s,t=n,o.flags&=14680066,c=o.alternate,c===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=c.childLanes,o.lanes=c.lanes,o.child=c.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=c.memoizedProps,o.memoizedState=c.memoizedState,o.updateQueue=c.updateQueue,o.type=c.type,t=c.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s=s.sibling;return $n(la,la.current&1|2),r.child}t=t.sibling}o.tail!==null&&Aa()>uy&&(r.flags|=128,n=!0,r0(o,!1),r.lanes=4194304)}else{if(!n)if(t=oS(c),t!==null){if(r.flags|=128,n=!0,s=t.updateQueue,s!==null&&(r.updateQueue=s,r.flags|=4),r0(o,!0),o.tail===null&&o.tailMode==="hidden"&&!c.alternate&&!ta)return so(r),null}else 2*Aa()-o.renderingStartTime>uy&&s!==1073741824&&(r.flags|=128,n=!0,r0(o,!1),r.lanes=4194304);o.isBackwards?(c.sibling=r.child,r.child=c):(s=o.last,s!==null?s.sibling=c:r.child=c,o.last=c)}return o.tail!==null?(r=o.tail,o.rendering=r,o.tail=r.sibling,o.renderingStartTime=Aa(),r.sibling=null,s=la.current,$n(la,n?s&1|2:s&1),r):(so(r),null);case 22:case 23:return tI(),n=r.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(r.flags|=8192),n&&r.mode&1?cl&1073741824&&(so(r),r.subtreeFlags&6&&(r.flags|=8192)):so(r),null;case 24:return null;case 25:return null}throw Error(nr(156,r.tag))}function zre(t,r){switch(DO(r),r.tag){case 1:return Wo(r.type)&&eS(),t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 3:return cy(),Zn(Uo),Zn(ho),UO(),t=r.flags,t&65536&&!(t&128)?(r.flags=t&-65537|128,r):null;case 5:return VO(r),null;case 13:if(Zn(la),t=r.memoizedState,t!==null&&t.dehydrated!==null){if(r.alternate===null)throw Error(nr(340));oy()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 19:return Zn(la),null;case 4:return cy(),null;case 10:return $O(r.type._context),null;case 22:case 23:return tI(),null;case 24:return null;default:return null}}var G1=!1,lo=!1,Bre=typeof WeakSet=="function"?WeakSet:Set,Er=null;function _g(t,r){var s=t.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(n){ba(t,r,n)}else s.current=null}function bE(t,r,s){try{s()}catch(n){ba(t,r,n)}}var iF=!1;function qre(t,r){if(nE=YN,t=aV(),OO(t)){if("selectionStart"in t)var s={start:t.selectionStart,end:t.selectionEnd};else e:{s=(s=t.ownerDocument)&&s.defaultView||window;var n=s.getSelection&&s.getSelection();if(n&&n.rangeCount!==0){s=n.anchorNode;var a=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{s.nodeType,o.nodeType}catch{s=null;break e}var c=0,i=-1,f=-1,p=0,g=0,y=t,b=null;t:for(;;){for(var w;y!==s||a!==0&&y.nodeType!==3||(i=c+a),y!==o||n!==0&&y.nodeType!==3||(f=c+n),y.nodeType===3&&(c+=y.nodeValue.length),(w=y.firstChild)!==null;)b=y,y=w;for(;;){if(y===t)break t;if(b===s&&++p===a&&(i=c),b===o&&++g===n&&(f=c),(w=y.nextSibling)!==null)break;y=b,b=y.parentNode}y=w}s=i===-1||f===-1?null:{start:i,end:f}}else s=null}s=s||{start:0,end:0}}else s=null;for(aE={focusedElem:t,selectionRange:s},YN=!1,Er=r;Er!==null;)if(r=Er,t=r.child,(r.subtreeFlags&1028)!==0&&t!==null)t.return=r,Er=t;else for(;Er!==null;){r=Er;try{var T=r.alternate;if(r.flags&1024)switch(r.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var N=T.memoizedProps,M=T.memoizedState,O=r.stateNode,C=O.getSnapshotBeforeUpdate(r.elementType===r.type?N:Cc(r.type,N),M);O.__reactInternalSnapshotBeforeUpdate=C}break;case 3:var D=r.stateNode.containerInfo;D.nodeType===1?D.textContent="":D.nodeType===9&&D.documentElement&&D.removeChild(D.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(nr(163))}}catch(L){ba(r,r.return,L)}if(t=r.sibling,t!==null){t.return=r.return,Er=t;break}Er=r.return}return T=iF,iF=!1,T}function q0(t,r,s){var n=r.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&t)===t){var o=a.destroy;a.destroy=void 0,o!==void 0&&bE(r,s,o)}a=a.next}while(a!==n)}}function oC(t,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var n=s.create;s.destroy=n()}s=s.next}while(s!==r)}}function _E(t){var r=t.ref;if(r!==null){var s=t.stateNode;switch(t.tag){case 5:t=s;break;default:t=s}typeof r=="function"?r(t):r.current=t}}function tU(t){var r=t.alternate;r!==null&&(t.alternate=null,tU(r)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(r=t.stateNode,r!==null&&(delete r[yd],delete r[cb],delete r[lE],delete r[Nre],delete r[Sre])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function rU(t){return t.tag===5||t.tag===3||t.tag===4}function oF(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||rU(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function wE(t,r,s){var n=t.tag;if(n===5||n===6)t=t.stateNode,r?s.nodeType===8?s.parentNode.insertBefore(t,r):s.insertBefore(t,r):(s.nodeType===8?(r=s.parentNode,r.insertBefore(t,s)):(r=s,r.appendChild(t)),s=s._reactRootContainer,s!=null||r.onclick!==null||(r.onclick=JN));else if(n!==4&&(t=t.child,t!==null))for(wE(t,r,s),t=t.sibling;t!==null;)wE(t,r,s),t=t.sibling}function NE(t,r,s){var n=t.tag;if(n===5||n===6)t=t.stateNode,r?s.insertBefore(t,r):s.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(NE(t,r,s),t=t.sibling;t!==null;)NE(t,r,s),t=t.sibling}var zi=null,kc=!1;function kh(t,r,s){for(s=s.child;s!==null;)sU(t,r,s),s=s.sibling}function sU(t,r,s){if(wd&&typeof wd.onCommitFiberUnmount=="function")try{wd.onCommitFiberUnmount(J2,s)}catch{}switch(s.tag){case 5:lo||_g(s,r);case 6:var n=zi,a=kc;zi=null,kh(t,r,s),zi=n,kc=a,zi!==null&&(kc?(t=zi,s=s.stateNode,t.nodeType===8?t.parentNode.removeChild(s):t.removeChild(s)):zi.removeChild(s.stateNode));break;case 18:zi!==null&&(kc?(t=zi,s=s.stateNode,t.nodeType===8?mA(t.parentNode,s):t.nodeType===1&&mA(t,s),nb(t)):mA(zi,s.stateNode));break;case 4:n=zi,a=kc,zi=s.stateNode.containerInfo,kc=!0,kh(t,r,s),zi=n,kc=a;break;case 0:case 11:case 14:case 15:if(!lo&&(n=s.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var o=a,c=o.destroy;o=o.tag,c!==void 0&&(o&2||o&4)&&bE(s,r,c),a=a.next}while(a!==n)}kh(t,r,s);break;case 1:if(!lo&&(_g(s,r),n=s.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=s.memoizedProps,n.state=s.memoizedState,n.componentWillUnmount()}catch(i){ba(s,r,i)}kh(t,r,s);break;case 21:kh(t,r,s);break;case 22:s.mode&1?(lo=(n=lo)||s.memoizedState!==null,kh(t,r,s),lo=n):kh(t,r,s);break;default:kh(t,r,s)}}function lF(t){var r=t.updateQueue;if(r!==null){t.updateQueue=null;var s=t.stateNode;s===null&&(s=t.stateNode=new Bre),r.forEach(function(n){var a=Xre.bind(null,t,n);s.has(n)||(s.add(n),n.then(a,a))})}}function _c(t,r){var s=r.deletions;if(s!==null)for(var n=0;n<s.length;n++){var a=s[n];try{var o=t,c=r,i=c;e:for(;i!==null;){switch(i.tag){case 5:zi=i.stateNode,kc=!1;break e;case 3:zi=i.stateNode.containerInfo,kc=!0;break e;case 4:zi=i.stateNode.containerInfo,kc=!0;break e}i=i.return}if(zi===null)throw Error(nr(160));sU(o,c,a),zi=null,kc=!1;var f=a.alternate;f!==null&&(f.return=null),a.return=null}catch(p){ba(a,r,p)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)nU(r,t),r=r.sibling}function nU(t,r){var s=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(_c(r,t),dd(t),n&4){try{q0(3,t,t.return),oC(3,t)}catch(N){ba(t,t.return,N)}try{q0(5,t,t.return)}catch(N){ba(t,t.return,N)}}break;case 1:_c(r,t),dd(t),n&512&&s!==null&&_g(s,s.return);break;case 5:if(_c(r,t),dd(t),n&512&&s!==null&&_g(s,s.return),t.flags&32){var a=t.stateNode;try{eb(a,"")}catch(N){ba(t,t.return,N)}}if(n&4&&(a=t.stateNode,a!=null)){var o=t.memoizedProps,c=s!==null?s.memoizedProps:o,i=t.type,f=t.updateQueue;if(t.updateQueue=null,f!==null)try{i==="input"&&o.type==="radio"&&o.name!=null&&Cq(a,o),HT(i,c);var p=HT(i,o);for(c=0;c<f.length;c+=2){var g=f[c],y=f[c+1];g==="style"?Eq(a,y):g==="dangerouslySetInnerHTML"?Aq(a,y):g==="children"?eb(a,y):jO(a,g,y,p)}switch(i){case"input":VT(a,o);break;case"textarea":Pq(a,o);break;case"select":var b=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var w=o.value;w!=null?Eg(a,!!o.multiple,w,!1):b!==!!o.multiple&&(o.defaultValue!=null?Eg(a,!!o.multiple,o.defaultValue,!0):Eg(a,!!o.multiple,o.multiple?[]:"",!1))}a[cb]=o}catch(N){ba(t,t.return,N)}}break;case 6:if(_c(r,t),dd(t),n&4){if(t.stateNode===null)throw Error(nr(162));a=t.stateNode,o=t.memoizedProps;try{a.nodeValue=o}catch(N){ba(t,t.return,N)}}break;case 3:if(_c(r,t),dd(t),n&4&&s!==null&&s.memoizedState.isDehydrated)try{nb(r.containerInfo)}catch(N){ba(t,t.return,N)}break;case 4:_c(r,t),dd(t);break;case 13:_c(r,t),dd(t),a=t.child,a.flags&8192&&(o=a.memoizedState!==null,a.stateNode.isHidden=o,!o||a.alternate!==null&&a.alternate.memoizedState!==null||(JO=Aa())),n&4&&lF(t);break;case 22:if(g=s!==null&&s.memoizedState!==null,t.mode&1?(lo=(p=lo)||g,_c(r,t),lo=p):_c(r,t),dd(t),n&8192){if(p=t.memoizedState!==null,(t.stateNode.isHidden=p)&&!g&&t.mode&1)for(Er=t,g=t.child;g!==null;){for(y=Er=g;Er!==null;){switch(b=Er,w=b.child,b.tag){case 0:case 11:case 14:case 15:q0(4,b,b.return);break;case 1:_g(b,b.return);var T=b.stateNode;if(typeof T.componentWillUnmount=="function"){n=b,s=b.return;try{r=n,T.props=r.memoizedProps,T.state=r.memoizedState,T.componentWillUnmount()}catch(N){ba(n,s,N)}}break;case 5:_g(b,b.return);break;case 22:if(b.memoizedState!==null){dF(y);continue}}w!==null?(w.return=b,Er=w):dF(y)}g=g.sibling}e:for(g=null,y=t;;){if(y.tag===5){if(g===null){g=y;try{a=y.stateNode,p?(o=a.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(i=y.stateNode,f=y.memoizedProps.style,c=f!=null&&f.hasOwnProperty("display")?f.display:null,i.style.display=Tq("display",c))}catch(N){ba(t,t.return,N)}}}else if(y.tag===6){if(g===null)try{y.stateNode.nodeValue=p?"":y.memoizedProps}catch(N){ba(t,t.return,N)}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===t)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;g===y&&(g=null),y=y.return}g===y&&(g=null),y.sibling.return=y.return,y=y.sibling}}break;case 19:_c(r,t),dd(t),n&4&&lF(t);break;case 21:break;default:_c(r,t),dd(t)}}function dd(t){var r=t.flags;if(r&2){try{e:{for(var s=t.return;s!==null;){if(rU(s)){var n=s;break e}s=s.return}throw Error(nr(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(eb(a,""),n.flags&=-33);var o=oF(t);NE(t,o,a);break;case 3:case 4:var c=n.stateNode.containerInfo,i=oF(t);wE(t,i,c);break;default:throw Error(nr(161))}}catch(f){ba(t,t.return,f)}t.flags&=-3}r&4096&&(t.flags&=-4097)}function Vre(t,r,s){Er=t,aU(t)}function aU(t,r,s){for(var n=(t.mode&1)!==0;Er!==null;){var a=Er,o=a.child;if(a.tag===22&&n){var c=a.memoizedState!==null||G1;if(!c){var i=a.alternate,f=i!==null&&i.memoizedState!==null||lo;i=G1;var p=lo;if(G1=c,(lo=f)&&!p)for(Er=a;Er!==null;)c=Er,f=c.child,c.tag===22&&c.memoizedState!==null?uF(a):f!==null?(f.return=c,Er=f):uF(a);for(;o!==null;)Er=o,aU(o),o=o.sibling;Er=a,G1=i,lo=p}cF(t)}else a.subtreeFlags&8772&&o!==null?(o.return=a,Er=o):cF(t)}}function cF(t){for(;Er!==null;){var r=Er;if(r.flags&8772){var s=r.alternate;try{if(r.flags&8772)switch(r.tag){case 0:case 11:case 15:lo||oC(5,r);break;case 1:var n=r.stateNode;if(r.flags&4&&!lo)if(s===null)n.componentDidMount();else{var a=r.elementType===r.type?s.memoizedProps:Cc(r.type,s.memoizedProps);n.componentDidUpdate(a,s.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=r.updateQueue;o!==null&&KL(r,o,n);break;case 3:var c=r.updateQueue;if(c!==null){if(s=null,r.child!==null)switch(r.child.tag){case 5:s=r.child.stateNode;break;case 1:s=r.child.stateNode}KL(r,c,s)}break;case 5:var i=r.stateNode;if(s===null&&r.flags&4){s=i;var f=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":f.autoFocus&&s.focus();break;case"img":f.src&&(s.src=f.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var p=r.alternate;if(p!==null){var g=p.memoizedState;if(g!==null){var y=g.dehydrated;y!==null&&nb(y)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(nr(163))}lo||r.flags&512&&_E(r)}catch(b){ba(r,r.return,b)}}if(r===t){Er=null;break}if(s=r.sibling,s!==null){s.return=r.return,Er=s;break}Er=r.return}}function dF(t){for(;Er!==null;){var r=Er;if(r===t){Er=null;break}var s=r.sibling;if(s!==null){s.return=r.return,Er=s;break}Er=r.return}}function uF(t){for(;Er!==null;){var r=Er;try{switch(r.tag){case 0:case 11:case 15:var s=r.return;try{oC(4,r)}catch(f){ba(r,s,f)}break;case 1:var n=r.stateNode;if(typeof n.componentDidMount=="function"){var a=r.return;try{n.componentDidMount()}catch(f){ba(r,a,f)}}var o=r.return;try{_E(r)}catch(f){ba(r,o,f)}break;case 5:var c=r.return;try{_E(r)}catch(f){ba(r,c,f)}}}catch(f){ba(r,r.return,f)}if(r===t){Er=null;break}var i=r.sibling;if(i!==null){i.return=r.return,Er=i;break}Er=r.return}}var Ure=Math.ceil,dS=Ku.ReactCurrentDispatcher,XO=Ku.ReactCurrentOwner,Ul=Ku.ReactCurrentBatchConfig,Ys=0,Ci=null,Wa=null,Vi=0,cl=0,wg=Im(0),li=0,pb=null,xp=0,lC=0,QO=0,V0=null,Lo=null,JO=0,uy=1/0,yu=null,uS=!1,SE=null,um=null,K1=!1,tm=null,hS=0,U0=0,CE=null,DN=-1,RN=0;function Co(){return Ys&6?Aa():DN!==-1?DN:DN=Aa()}function hm(t){return t.mode&1?Ys&2&&Vi!==0?Vi&-Vi:Pre.transition!==null?(RN===0&&(RN=Vq()),RN):(t=mn,t!==0||(t=window.event,t=t===void 0?16:Yq(t.type)),t):1}function qc(t,r,s,n){if(50<U0)throw U0=0,CE=null,Error(nr(185));__(t,s,n),(!(Ys&2)||t!==Ci)&&(t===Ci&&(!(Ys&2)&&(lC|=s),li===4&&qh(t,Vi)),Go(t,n),s===1&&Ys===0&&!(r.mode&1)&&(uy=Aa()+500,nC&&Dm()))}function Go(t,r){var s=t.callbackNode;Pte(t,r);var n=ZN(t,t===Ci?Vi:0);if(n===0)s!==null&&jL(s),t.callbackNode=null,t.callbackPriority=0;else if(r=n&-n,t.callbackPriority!==r){if(s!=null&&jL(s),r===1)t.tag===0?Cre(hF.bind(null,t)):pV(hF.bind(null,t)),_re(function(){!(Ys&6)&&Dm()}),s=null;else{switch(Uq(n)){case 1:s=SO;break;case 4:s=Bq;break;case 16:s=HN;break;case 536870912:s=qq;break;default:s=HN}s=mU(s,iU.bind(null,t))}t.callbackPriority=r,t.callbackNode=s}}function iU(t,r){if(DN=-1,RN=0,Ys&6)throw Error(nr(327));var s=t.callbackNode;if(Rg()&&t.callbackNode!==s)return null;var n=ZN(t,t===Ci?Vi:0);if(n===0)return null;if(n&30||n&t.expiredLanes||r)r=mS(t,n);else{r=n;var a=Ys;Ys|=2;var o=lU();(Ci!==t||Vi!==r)&&(yu=null,uy=Aa()+500,op(t,r));do try{Kre();break}catch(i){oU(t,i)}while(!0);FO(),dS.current=o,Ys=a,Wa!==null?r=0:(Ci=null,Vi=0,r=li)}if(r!==0){if(r===2&&(a=JT(t),a!==0&&(n=a,r=PE(t,a))),r===1)throw s=pb,op(t,0),qh(t,n),Go(t,Aa()),s;if(r===6)qh(t,n);else{if(a=t.current.alternate,!(n&30)&&!Wre(a)&&(r=mS(t,n),r===2&&(o=JT(t),o!==0&&(n=o,r=PE(t,o))),r===1))throw s=pb,op(t,0),qh(t,n),Go(t,Aa()),s;switch(t.finishedWork=a,t.finishedLanes=n,r){case 0:case 1:throw Error(nr(345));case 2:Lf(t,Lo,yu);break;case 3:if(qh(t,n),(n&130023424)===n&&(r=JO+500-Aa(),10<r)){if(ZN(t,0)!==0)break;if(a=t.suspendedLanes,(a&n)!==n){Co(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=oE(Lf.bind(null,t,Lo,yu),r);break}Lf(t,Lo,yu);break;case 4:if(qh(t,n),(n&4194240)===n)break;for(r=t.eventTimes,a=-1;0<n;){var c=31-Bc(n);o=1<<c,c=r[c],c>a&&(a=c),n&=~o}if(n=a,n=Aa()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ure(n/1960))-n,10<n){t.timeoutHandle=oE(Lf.bind(null,t,Lo,yu),n);break}Lf(t,Lo,yu);break;case 5:Lf(t,Lo,yu);break;default:throw Error(nr(329))}}}return Go(t,Aa()),t.callbackNode===s?iU.bind(null,t):null}function PE(t,r){var s=V0;return t.current.memoizedState.isDehydrated&&(op(t,r).flags|=256),t=mS(t,r),t!==2&&(r=Lo,Lo=s,r!==null&&kE(r)),t}function kE(t){Lo===null?Lo=t:Lo.push.apply(Lo,t)}function Wre(t){for(var r=t;;){if(r.flags&16384){var s=r.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var n=0;n<s.length;n++){var a=s[n],o=a.getSnapshot;a=a.value;try{if(!Gc(o(),a))return!1}catch{return!1}}}if(s=r.child,r.subtreeFlags&16384&&s!==null)s.return=r,r=s;else{if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function qh(t,r){for(r&=~QO,r&=~lC,t.suspendedLanes|=r,t.pingedLanes&=~r,t=t.expirationTimes;0<r;){var s=31-Bc(r),n=1<<s;t[s]=-1,r&=~n}}function hF(t){if(Ys&6)throw Error(nr(327));Rg();var r=ZN(t,0);if(!(r&1))return Go(t,Aa()),null;var s=mS(t,r);if(t.tag!==0&&s===2){var n=JT(t);n!==0&&(r=n,s=PE(t,n))}if(s===1)throw s=pb,op(t,0),qh(t,r),Go(t,Aa()),s;if(s===6)throw Error(nr(345));return t.finishedWork=t.current.alternate,t.finishedLanes=r,Lf(t,Lo,yu),Go(t,Aa()),null}function eI(t,r){var s=Ys;Ys|=1;try{return t(r)}finally{Ys=s,Ys===0&&(uy=Aa()+500,nC&&Dm())}}function gp(t){tm!==null&&tm.tag===0&&!(Ys&6)&&Rg();var r=Ys;Ys|=1;var s=Ul.transition,n=mn;try{if(Ul.transition=null,mn=1,t)return t()}finally{mn=n,Ul.transition=s,Ys=r,!(Ys&6)&&Dm()}}function tI(){cl=wg.current,Zn(wg)}function op(t,r){t.finishedWork=null,t.finishedLanes=0;var s=t.timeoutHandle;if(s!==-1&&(t.timeoutHandle=-1,bre(s)),Wa!==null)for(s=Wa.return;s!==null;){var n=s;switch(DO(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&eS();break;case 3:cy(),Zn(Uo),Zn(ho),UO();break;case 5:VO(n);break;case 4:cy();break;case 13:Zn(la);break;case 19:Zn(la);break;case 10:$O(n.type._context);break;case 22:case 23:tI()}s=s.return}if(Ci=t,Wa=t=mm(t.current,null),Vi=cl=r,li=0,pb=null,QO=lC=xp=0,Lo=V0=null,Gf!==null){for(r=0;r<Gf.length;r++)if(s=Gf[r],n=s.interleaved,n!==null){s.interleaved=null;var a=n.next,o=s.pending;if(o!==null){var c=o.next;o.next=a,n.next=c}s.pending=n}Gf=null}return t}function oU(t,r){do{var s=Wa;try{if(FO(),MN.current=cS,lS){for(var n=ua.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}lS=!1}if(pp=0,bi=ai=ua=null,B0=!1,hb=0,XO.current=null,s===null||s.return===null){li=1,pb=r,Wa=null;break}e:{var o=t,c=s.return,i=s,f=r;if(r=Vi,i.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){var p=f,g=i,y=g.tag;if(!(g.mode&1)&&(y===0||y===11||y===15)){var b=g.alternate;b?(g.updateQueue=b.updateQueue,g.memoizedState=b.memoizedState,g.lanes=b.lanes):(g.updateQueue=null,g.memoizedState=null)}var w=JL(c);if(w!==null){w.flags&=-257,eF(w,c,i,o,r),w.mode&1&&QL(o,p,r),r=w,f=p;var T=r.updateQueue;if(T===null){var N=new Set;N.add(f),r.updateQueue=N}else T.add(f);break e}else{if(!(r&1)){QL(o,p,r),rI();break e}f=Error(nr(426))}}else if(ta&&i.mode&1){var M=JL(c);if(M!==null){!(M.flags&65536)&&(M.flags|=256),eF(M,c,i,o,r),RO(dy(f,i));break e}}o=f=dy(f,i),li!==4&&(li=2),V0===null?V0=[o]:V0.push(o),o=c;do{switch(o.tag){case 3:o.flags|=65536,r&=-r,o.lanes|=r;var O=UV(o,f,r);GL(o,O);break e;case 1:i=f;var C=o.type,D=o.stateNode;if(!(o.flags&128)&&(typeof C.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(um===null||!um.has(D)))){o.flags|=65536,r&=-r,o.lanes|=r;var L=WV(o,i,r);GL(o,L);break e}}o=o.return}while(o!==null)}dU(s)}catch(F){r=F,Wa===s&&s!==null&&(Wa=s=s.return);continue}break}while(!0)}function lU(){var t=dS.current;return dS.current=cS,t===null?cS:t}function rI(){(li===0||li===3||li===2)&&(li=4),Ci===null||!(xp&268435455)&&!(lC&268435455)||qh(Ci,Vi)}function mS(t,r){var s=Ys;Ys|=2;var n=lU();(Ci!==t||Vi!==r)&&(yu=null,op(t,r));do try{Gre();break}catch(a){oU(t,a)}while(!0);if(FO(),Ys=s,dS.current=n,Wa!==null)throw Error(nr(261));return Ci=null,Vi=0,li}function Gre(){for(;Wa!==null;)cU(Wa)}function Kre(){for(;Wa!==null&&!yte();)cU(Wa)}function cU(t){var r=hU(t.alternate,t,cl);t.memoizedProps=t.pendingProps,r===null?dU(t):Wa=r,XO.current=null}function dU(t){var r=t;do{var s=r.alternate;if(t=r.return,r.flags&32768){if(s=zre(s,r),s!==null){s.flags&=32767,Wa=s;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{li=6,Wa=null;return}}else if(s=$re(s,r,cl),s!==null){Wa=s;return}if(r=r.sibling,r!==null){Wa=r;return}Wa=r=t}while(r!==null);li===0&&(li=5)}function Lf(t,r,s){var n=mn,a=Ul.transition;try{Ul.transition=null,mn=1,Hre(t,r,s,n)}finally{Ul.transition=a,mn=n}return null}function Hre(t,r,s,n){do Rg();while(tm!==null);if(Ys&6)throw Error(nr(327));s=t.finishedWork;var a=t.finishedLanes;if(s===null)return null;if(t.finishedWork=null,t.finishedLanes=0,s===t.current)throw Error(nr(177));t.callbackNode=null,t.callbackPriority=0;var o=s.lanes|s.childLanes;if(kte(t,o),t===Ci&&(Wa=Ci=null,Vi=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||K1||(K1=!0,mU(HN,function(){return Rg(),null})),o=(s.flags&15990)!==0,s.subtreeFlags&15990||o){o=Ul.transition,Ul.transition=null;var c=mn;mn=1;var i=Ys;Ys|=4,XO.current=null,qre(t,s),nU(s,t),fre(aE),YN=!!nE,aE=nE=null,t.current=s,Vre(s),vte(),Ys=i,mn=c,Ul.transition=o}else t.current=s;if(K1&&(K1=!1,tm=t,hS=a),o=t.pendingLanes,o===0&&(um=null),_te(s.stateNode),Go(t,Aa()),r!==null)for(n=t.onRecoverableError,s=0;s<r.length;s++)a=r[s],n(a.value,{componentStack:a.stack,digest:a.digest});if(uS)throw uS=!1,t=SE,SE=null,t;return hS&1&&t.tag!==0&&Rg(),o=t.pendingLanes,o&1?t===CE?U0++:(U0=0,CE=t):U0=0,Dm(),null}function Rg(){if(tm!==null){var t=Uq(hS),r=Ul.transition,s=mn;try{if(Ul.transition=null,mn=16>t?16:t,tm===null)var n=!1;else{if(t=tm,tm=null,hS=0,Ys&6)throw Error(nr(331));var a=Ys;for(Ys|=4,Er=t.current;Er!==null;){var o=Er,c=o.child;if(Er.flags&16){var i=o.deletions;if(i!==null){for(var f=0;f<i.length;f++){var p=i[f];for(Er=p;Er!==null;){var g=Er;switch(g.tag){case 0:case 11:case 15:q0(8,g,o)}var y=g.child;if(y!==null)y.return=g,Er=y;else for(;Er!==null;){g=Er;var b=g.sibling,w=g.return;if(tU(g),g===p){Er=null;break}if(b!==null){b.return=w,Er=b;break}Er=w}}}var T=o.alternate;if(T!==null){var N=T.child;if(N!==null){T.child=null;do{var M=N.sibling;N.sibling=null,N=M}while(N!==null)}}Er=o}}if(o.subtreeFlags&2064&&c!==null)c.return=o,Er=c;else e:for(;Er!==null;){if(o=Er,o.flags&2048)switch(o.tag){case 0:case 11:case 15:q0(9,o,o.return)}var O=o.sibling;if(O!==null){O.return=o.return,Er=O;break e}Er=o.return}}var C=t.current;for(Er=C;Er!==null;){c=Er;var D=c.child;if(c.subtreeFlags&2064&&D!==null)D.return=c,Er=D;else e:for(c=C;Er!==null;){if(i=Er,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:oC(9,i)}}catch(F){ba(i,i.return,F)}if(i===c){Er=null;break e}var L=i.sibling;if(L!==null){L.return=i.return,Er=L;break e}Er=i.return}}if(Ys=a,Dm(),wd&&typeof wd.onPostCommitFiberRoot=="function")try{wd.onPostCommitFiberRoot(J2,t)}catch{}n=!0}return n}finally{mn=s,Ul.transition=r}}return!1}function mF(t,r,s){r=dy(s,r),r=UV(t,r,1),t=dm(t,r,1),r=Co(),t!==null&&(__(t,1,r),Go(t,r))}function ba(t,r,s){if(t.tag===3)mF(t,t,s);else for(;r!==null;){if(r.tag===3){mF(r,t,s);break}else if(r.tag===1){var n=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(um===null||!um.has(n))){t=dy(s,t),t=WV(r,t,1),r=dm(r,t,1),t=Co(),r!==null&&(__(r,1,t),Go(r,t));break}}r=r.return}}function Zre(t,r,s){var n=t.pingCache;n!==null&&n.delete(r),r=Co(),t.pingedLanes|=t.suspendedLanes&s,Ci===t&&(Vi&s)===s&&(li===4||li===3&&(Vi&130023424)===Vi&&500>Aa()-JO?op(t,0):QO|=s),Go(t,r)}function uU(t,r){r===0&&(t.mode&1?(r=L1,L1<<=1,!(L1&130023424)&&(L1=4194304)):r=1);var s=Co();t=Ru(t,r),t!==null&&(__(t,r,s),Go(t,s))}function Yre(t){var r=t.memoizedState,s=0;r!==null&&(s=r.retryLane),uU(t,s)}function Xre(t,r){var s=0;switch(t.tag){case 13:var n=t.stateNode,a=t.memoizedState;a!==null&&(s=a.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(nr(314))}n!==null&&n.delete(r),uU(t,s)}var hU;hU=function(t,r,s){if(t!==null)if(t.memoizedProps!==r.pendingProps||Uo.current)$o=!0;else{if(!(t.lanes&s)&&!(r.flags&128))return $o=!1,Fre(t,r,s);$o=!!(t.flags&131072)}else $o=!1,ta&&r.flags&1048576&&xV(r,sS,r.index);switch(r.lanes=0,r.tag){case 2:var n=r.type;IN(t,r),t=r.pendingProps;var a=iy(r,ho.current);Dg(r,s),a=GO(null,r,n,t,a,s);var o=KO();return r.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,Wo(n)?(o=!0,tS(r)):o=!1,r.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,BO(r),a.updater=iC,r.stateNode=a,a._reactInternals=r,fE(r,n,t,s),r=gE(null,r,n,!0,o,s)):(r.tag=0,ta&&o&&IO(r),_o(null,r,a,s),r=r.child),r;case 16:n=r.elementType;e:{switch(IN(t,r),t=r.pendingProps,a=n._init,n=a(n._payload),r.type=n,a=r.tag=Jre(n),t=Cc(n,t),a){case 0:r=xE(null,r,n,t,s);break e;case 1:r=sF(null,r,n,t,s);break e;case 11:r=tF(null,r,n,t,s);break e;case 14:r=rF(null,r,n,Cc(n.type,t),s);break e}throw Error(nr(306,n,""))}return r;case 0:return n=r.type,a=r.pendingProps,a=r.elementType===n?a:Cc(n,a),xE(t,r,n,a,s);case 1:return n=r.type,a=r.pendingProps,a=r.elementType===n?a:Cc(n,a),sF(t,r,n,a,s);case 3:e:{if(ZV(r),t===null)throw Error(nr(387));n=r.pendingProps,o=r.memoizedState,a=o.element,_V(t,r),iS(r,n,null,s);var c=r.memoizedState;if(n=c.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:c.cache,pendingSuspenseBoundaries:c.pendingSuspenseBoundaries,transitions:c.transitions},r.updateQueue.baseState=o,r.memoizedState=o,r.flags&256){a=dy(Error(nr(423)),r),r=nF(t,r,n,s,a);break e}else if(n!==a){a=dy(Error(nr(424)),r),r=nF(t,r,n,s,a);break e}else for(xl=cm(r.stateNode.containerInfo.firstChild),gl=r,ta=!0,Ec=null,s=jV(r,null,n,s),r.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(oy(),n===a){r=Lu(t,r,s);break e}_o(t,r,n,s)}r=r.child}return r;case 5:return wV(r),t===null&&uE(r),n=r.type,a=r.pendingProps,o=t!==null?t.memoizedProps:null,c=a.children,iE(n,a)?c=null:o!==null&&iE(n,o)&&(r.flags|=32),HV(t,r),_o(t,r,c,s),r.child;case 6:return t===null&&uE(r),null;case 13:return YV(t,r,s);case 4:return qO(r,r.stateNode.containerInfo),n=r.pendingProps,t===null?r.child=ly(r,null,n,s):_o(t,r,n,s),r.child;case 11:return n=r.type,a=r.pendingProps,a=r.elementType===n?a:Cc(n,a),tF(t,r,n,a,s);case 7:return _o(t,r,r.pendingProps,s),r.child;case 8:return _o(t,r,r.pendingProps.children,s),r.child;case 12:return _o(t,r,r.pendingProps.children,s),r.child;case 10:e:{if(n=r.type._context,a=r.pendingProps,o=r.memoizedProps,c=a.value,$n(nS,n._currentValue),n._currentValue=c,o!==null)if(Gc(o.value,c)){if(o.children===a.children&&!Uo.current){r=Lu(t,r,s);break e}}else for(o=r.child,o!==null&&(o.return=r);o!==null;){var i=o.dependencies;if(i!==null){c=o.child;for(var f=i.firstContext;f!==null;){if(f.context===n){if(o.tag===1){f=Tu(-1,s&-s),f.tag=2;var p=o.updateQueue;if(p!==null){p=p.shared;var g=p.pending;g===null?f.next=f:(f.next=g.next,g.next=f),p.pending=f}}o.lanes|=s,f=o.alternate,f!==null&&(f.lanes|=s),hE(o.return,s,r),i.lanes|=s;break}f=f.next}}else if(o.tag===10)c=o.type===r.type?null:o.child;else if(o.tag===18){if(c=o.return,c===null)throw Error(nr(341));c.lanes|=s,i=c.alternate,i!==null&&(i.lanes|=s),hE(c,s,r),c=o.sibling}else c=o.child;if(c!==null)c.return=o;else for(c=o;c!==null;){if(c===r){c=null;break}if(o=c.sibling,o!==null){o.return=c.return,c=o;break}c=c.return}o=c}_o(t,r,a.children,s),r=r.child}return r;case 9:return a=r.type,n=r.pendingProps.children,Dg(r,s),a=Kl(a),n=n(a),r.flags|=1,_o(t,r,n,s),r.child;case 14:return n=r.type,a=Cc(n,r.pendingProps),a=Cc(n.type,a),rF(t,r,n,a,s);case 15:return GV(t,r,r.type,r.pendingProps,s);case 17:return n=r.type,a=r.pendingProps,a=r.elementType===n?a:Cc(n,a),IN(t,r),r.tag=1,Wo(n)?(t=!0,tS(r)):t=!1,Dg(r,s),VV(r,n,a),fE(r,n,a,s),gE(null,r,n,!0,t,s);case 19:return XV(t,r,s);case 22:return KV(t,r,s)}throw Error(nr(156,r.tag))};function mU(t,r){return zq(t,r)}function Qre(t,r,s,n){this.tag=t,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ql(t,r,s,n){return new Qre(t,r,s,n)}function sI(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Jre(t){if(typeof t=="function")return sI(t)?1:0;if(t!=null){if(t=t.$$typeof,t===_O)return 11;if(t===wO)return 14}return 2}function mm(t,r){var s=t.alternate;return s===null?(s=ql(t.tag,r,t.key,t.mode),s.elementType=t.elementType,s.type=t.type,s.stateNode=t.stateNode,s.alternate=t,t.alternate=s):(s.pendingProps=r,s.type=t.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=t.flags&14680064,s.childLanes=t.childLanes,s.lanes=t.lanes,s.child=t.child,s.memoizedProps=t.memoizedProps,s.memoizedState=t.memoizedState,s.updateQueue=t.updateQueue,r=t.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},s.sibling=t.sibling,s.index=t.index,s.ref=t.ref,s}function LN(t,r,s,n,a,o){var c=2;if(n=t,typeof t=="function")sI(t)&&(c=1);else if(typeof t=="string")c=5;else e:switch(t){case mg:return lp(s.children,a,o,r);case bO:c=8,a|=8;break;case FT:return t=ql(12,s,r,a|2),t.elementType=FT,t.lanes=o,t;case $T:return t=ql(13,s,r,a),t.elementType=$T,t.lanes=o,t;case zT:return t=ql(19,s,r,a),t.elementType=zT,t.lanes=o,t;case wq:return cC(s,a,o,r);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case bq:c=10;break e;case _q:c=9;break e;case _O:c=11;break e;case wO:c=14;break e;case Rh:c=16,n=null;break e}throw Error(nr(130,t==null?t:typeof t,""))}return r=ql(c,s,r,a),r.elementType=t,r.type=n,r.lanes=o,r}function lp(t,r,s,n){return t=ql(7,t,n,r),t.lanes=s,t}function cC(t,r,s,n){return t=ql(22,t,n,r),t.elementType=wq,t.lanes=s,t.stateNode={isHidden:!1},t}function bA(t,r,s){return t=ql(6,t,null,r),t.lanes=s,t}function _A(t,r,s){return r=ql(4,t.children!==null?t.children:[],t.key,r),r.lanes=s,r.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},r}function ese(t,r,s,n,a){this.tag=r,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rA(0),this.expirationTimes=rA(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rA(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function nI(t,r,s,n,a,o,c,i,f){return t=new ese(t,r,s,i,f),r===1?(r=1,o===!0&&(r|=8)):r=0,o=ql(3,null,null,r),t.current=o,o.stateNode=t,o.memoizedState={element:n,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},BO(o),t}function tse(t,r,s){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:hg,key:n==null?null:""+n,children:t,containerInfo:r,implementation:s}}function fU(t){if(!t)return bm;t=t._reactInternals;e:{if(Rp(t)!==t||t.tag!==1)throw Error(nr(170));var r=t;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(Wo(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(nr(171))}if(t.tag===1){var s=t.type;if(Wo(s))return fV(t,s,r)}return r}function pU(t,r,s,n,a,o,c,i,f){return t=nI(s,n,!0,t,a,o,c,i,f),t.context=fU(null),s=t.current,n=Co(),a=hm(s),o=Tu(n,a),o.callback=r??null,dm(s,o,a),t.current.lanes=a,__(t,a,n),Go(t,n),t}function dC(t,r,s,n){var a=r.current,o=Co(),c=hm(a);return s=fU(s),r.context===null?r.context=s:r.pendingContext=s,r=Tu(o,c),r.payload={element:t},n=n===void 0?null:n,n!==null&&(r.callback=n),t=dm(a,r,c),t!==null&&(qc(t,a,c,o),EN(t,a,c)),c}function fS(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function fF(t,r){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var s=t.retryLane;t.retryLane=s!==0&&s<r?s:r}}function aI(t,r){fF(t,r),(t=t.alternate)&&fF(t,r)}function rse(){return null}var xU=typeof reportError=="function"?reportError:function(t){console.error(t)};function iI(t){this._internalRoot=t}uC.prototype.render=iI.prototype.render=function(t){var r=this._internalRoot;if(r===null)throw Error(nr(409));dC(t,r,null,null)};uC.prototype.unmount=iI.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var r=t.containerInfo;gp(function(){dC(null,t,null,null)}),r[Du]=null}};function uC(t){this._internalRoot=t}uC.prototype.unstable_scheduleHydration=function(t){if(t){var r=Kq();t={blockedOn:null,target:t,priority:r};for(var s=0;s<Bh.length&&r!==0&&r<Bh[s].priority;s++);Bh.splice(s,0,t),s===0&&Zq(t)}};function oI(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function hC(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function pF(){}function sse(t,r,s,n,a){if(a){if(typeof n=="function"){var o=n;n=function(){var p=fS(c);o.call(p)}}var c=pU(r,n,t,0,null,!1,!1,"",pF);return t._reactRootContainer=c,t[Du]=c.current,ob(t.nodeType===8?t.parentNode:t),gp(),c}for(;a=t.lastChild;)t.removeChild(a);if(typeof n=="function"){var i=n;n=function(){var p=fS(f);i.call(p)}}var f=nI(t,0,!1,null,null,!1,!1,"",pF);return t._reactRootContainer=f,t[Du]=f.current,ob(t.nodeType===8?t.parentNode:t),gp(function(){dC(r,f,s,n)}),f}function mC(t,r,s,n,a){var o=s._reactRootContainer;if(o){var c=o;if(typeof a=="function"){var i=a;a=function(){var f=fS(c);i.call(f)}}dC(r,c,t,a)}else c=sse(s,r,t,a,n);return fS(c)}Wq=function(t){switch(t.tag){case 3:var r=t.stateNode;if(r.current.memoizedState.isDehydrated){var s=P0(r.pendingLanes);s!==0&&(CO(r,s|1),Go(r,Aa()),!(Ys&6)&&(uy=Aa()+500,Dm()))}break;case 13:gp(function(){var n=Ru(t,1);if(n!==null){var a=Co();qc(n,t,1,a)}}),aI(t,1)}};PO=function(t){if(t.tag===13){var r=Ru(t,134217728);if(r!==null){var s=Co();qc(r,t,134217728,s)}aI(t,134217728)}};Gq=function(t){if(t.tag===13){var r=hm(t),s=Ru(t,r);if(s!==null){var n=Co();qc(s,t,r,n)}aI(t,r)}};Kq=function(){return mn};Hq=function(t,r){var s=mn;try{return mn=t,r()}finally{mn=s}};YT=function(t,r,s){switch(r){case"input":if(VT(t,s),r=s.name,s.type==="radio"&&r!=null){for(s=t;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<s.length;r++){var n=s[r];if(n!==t&&n.form===t.form){var a=sC(n);if(!a)throw Error(nr(90));Sq(n),VT(n,a)}}}break;case"textarea":Pq(t,s);break;case"select":r=s.value,r!=null&&Eg(t,!!s.multiple,r,!1)}};Iq=eI;Dq=gp;var nse={usingClientEntryPoint:!1,Events:[N_,gg,sC,Mq,Oq,eI]},s0={findFiberByHostInstance:Wf,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ase={bundleType:s0.bundleType,version:s0.version,rendererPackageName:s0.rendererPackageName,rendererConfig:s0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ku.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Fq(t),t===null?null:t.stateNode},findFiberByHostInstance:s0.findFiberByHostInstance||rse,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var H1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!H1.isDisabled&&H1.supportsFiber)try{J2=H1.inject(ase),wd=H1}catch{}}wl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nse;wl.createPortal=function(t,r){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!oI(r))throw Error(nr(200));return tse(t,r,null,s)};wl.createRoot=function(t,r){if(!oI(t))throw Error(nr(299));var s=!1,n="",a=xU;return r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(n=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),r=nI(t,1,!1,null,null,s,!1,n,a),t[Du]=r.current,ob(t.nodeType===8?t.parentNode:t),new iI(r)};wl.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var r=t._reactInternals;if(r===void 0)throw typeof t.render=="function"?Error(nr(188)):(t=Object.keys(t).join(","),Error(nr(268,t)));return t=Fq(r),t=t===null?null:t.stateNode,t};wl.flushSync=function(t){return gp(t)};wl.hydrate=function(t,r,s){if(!hC(r))throw Error(nr(200));return mC(null,t,r,!0,s)};wl.hydrateRoot=function(t,r,s){if(!oI(t))throw Error(nr(405));var n=s!=null&&s.hydratedSources||null,a=!1,o="",c=xU;if(s!=null&&(s.unstable_strictMode===!0&&(a=!0),s.identifierPrefix!==void 0&&(o=s.identifierPrefix),s.onRecoverableError!==void 0&&(c=s.onRecoverableError)),r=pU(r,null,t,1,s??null,a,!1,o,c),t[Du]=r.current,ob(t),n)for(t=0;t<n.length;t++)s=n[t],a=s._getVersion,a=a(s._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[s,a]:r.mutableSourceEagerHydrationData.push(s,a);return new uC(r)};wl.render=function(t,r,s){if(!hC(r))throw Error(nr(200));return mC(null,t,r,!1,s)};wl.unmountComponentAtNode=function(t){if(!hC(t))throw Error(nr(40));return t._reactRootContainer?(gp(function(){mC(null,null,t,!1,function(){t._reactRootContainer=null,t[Du]=null})}),!0):!1};wl.unstable_batchedUpdates=eI;wl.unstable_renderSubtreeIntoContainer=function(t,r,s,n){if(!hC(s))throw Error(nr(200));if(t==null||t._reactInternals===void 0)throw Error(nr(38));return mC(t,r,s,!1,n)};wl.version="18.3.1-next-f1338f8080-20240426";function gU(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(gU)}catch(t){console.error(t)}}gU(),gq.exports=wl;var Rm=gq.exports;const yU=tn(Rm);var vU,xF=Rm;vU=xF.createRoot,xF.hydrateRoot;var av=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},yp=typeof window>"u"||"Deno"in globalThis;function Dl(){}function ise(t,r){return typeof t=="function"?t(r):t}function AE(t){return typeof t=="number"&&t>=0&&t!==1/0}function jU(t,r){return Math.max(t+(r||0)-Date.now(),0)}function Lg(t,r){return typeof t=="function"?t(r):t}function Mc(t,r){return typeof t=="function"?t(r):t}function gF(t,r){const{type:s="all",exact:n,fetchStatus:a,predicate:o,queryKey:c,stale:i}=t;if(c){if(n){if(r.queryHash!==lI(c,r.options))return!1}else if(!xb(r.queryKey,c))return!1}if(s!=="all"){const f=r.isActive();if(s==="active"&&!f||s==="inactive"&&f)return!1}return!(typeof i=="boolean"&&r.isStale()!==i||a&&a!==r.state.fetchStatus||o&&!o(r))}function yF(t,r){const{exact:s,status:n,predicate:a,mutationKey:o}=t;if(o){if(!r.options.mutationKey)return!1;if(s){if(vp(r.options.mutationKey)!==vp(o))return!1}else if(!xb(r.options.mutationKey,o))return!1}return!(n&&r.state.status!==n||a&&!a(r))}function lI(t,r){return((r==null?void 0:r.queryKeyHashFn)||vp)(t)}function vp(t){return JSON.stringify(t,(r,s)=>TE(s)?Object.keys(s).sort().reduce((n,a)=>(n[a]=s[a],n),{}):s)}function xb(t,r){return t===r?!0:typeof t!=typeof r?!1:t&&r&&typeof t=="object"&&typeof r=="object"?!Object.keys(r).some(s=>!xb(t[s],r[s])):!1}function bU(t,r){if(t===r)return t;const s=vF(t)&&vF(r);if(s||TE(t)&&TE(r)){const n=s?t:Object.keys(t),a=n.length,o=s?r:Object.keys(r),c=o.length,i=s?[]:{};let f=0;for(let p=0;p<c;p++){const g=s?p:o[p];(!s&&n.includes(g)||s)&&t[g]===void 0&&r[g]===void 0?(i[g]=void 0,f++):(i[g]=bU(t[g],r[g]),i[g]===t[g]&&t[g]!==void 0&&f++)}return a===c&&f===a?t:i}return r}function pS(t,r){if(!r||Object.keys(t).length!==Object.keys(r).length)return!1;for(const s in t)if(t[s]!==r[s])return!1;return!0}function vF(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function TE(t){if(!jF(t))return!1;const r=t.constructor;if(r===void 0)return!0;const s=r.prototype;return!(!jF(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function jF(t){return Object.prototype.toString.call(t)==="[object Object]"}function ose(t){return new Promise(r=>{setTimeout(r,t)})}function EE(t,r,s){return typeof s.structuralSharing=="function"?s.structuralSharing(t,r):s.structuralSharing!==!1?bU(t,r):r}function lse(t,r,s=0){const n=[...t,r];return s&&n.length>s?n.slice(1):n}function cse(t,r,s=0){const n=[r,...t];return s&&n.length>s?n.slice(0,-1):n}var cI=Symbol();function _U(t,r){return!t.queryFn&&(r!=null&&r.initialPromise)?()=>r.initialPromise:!t.queryFn||t.queryFn===cI?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var ep,Wh,Gg,H8,dse=(H8=class extends av{constructor(){super();Gr(this,ep);Gr(this,Wh);Gr(this,Gg);Pr(this,Gg,r=>{if(!yp&&window.addEventListener){const s=()=>r();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){st(this,Wh)||this.setEventListener(st(this,Gg))}onUnsubscribe(){var r;this.hasListeners()||((r=st(this,Wh))==null||r.call(this),Pr(this,Wh,void 0))}setEventListener(r){var s;Pr(this,Gg,r),(s=st(this,Wh))==null||s.call(this),Pr(this,Wh,r(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(r){st(this,ep)!==r&&(Pr(this,ep,r),this.onFocus())}onFocus(){const r=this.isFocused();this.listeners.forEach(s=>{s(r)})}isFocused(){var r;return typeof st(this,ep)=="boolean"?st(this,ep):((r=globalThis.document)==null?void 0:r.visibilityState)!=="hidden"}},ep=new WeakMap,Wh=new WeakMap,Gg=new WeakMap,H8),dI=new dse,Kg,Gh,Hg,Z8,use=(Z8=class extends av{constructor(){super();Gr(this,Kg,!0);Gr(this,Gh);Gr(this,Hg);Pr(this,Hg,r=>{if(!yp&&window.addEventListener){const s=()=>r(!0),n=()=>r(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",n)}}})}onSubscribe(){st(this,Gh)||this.setEventListener(st(this,Hg))}onUnsubscribe(){var r;this.hasListeners()||((r=st(this,Gh))==null||r.call(this),Pr(this,Gh,void 0))}setEventListener(r){var s;Pr(this,Hg,r),(s=st(this,Gh))==null||s.call(this),Pr(this,Gh,r(this.setOnline.bind(this)))}setOnline(r){st(this,Kg)!==r&&(Pr(this,Kg,r),this.listeners.forEach(n=>{n(r)}))}isOnline(){return st(this,Kg)}},Kg=new WeakMap,Gh=new WeakMap,Hg=new WeakMap,Z8),xS=new use;function ME(){let t,r;const s=new Promise((a,o)=>{t=a,r=o});s.status="pending",s.catch(()=>{});function n(a){Object.assign(s,a),delete s.resolve,delete s.reject}return s.resolve=a=>{n({status:"fulfilled",value:a}),t(a)},s.reject=a=>{n({status:"rejected",reason:a}),r(a)},s}function hse(t){return Math.min(1e3*2**t,3e4)}function wU(t){return(t??"online")==="online"?xS.isOnline():!0}var NU=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function wA(t){return t instanceof NU}function SU(t){let r=!1,s=0,n=!1,a;const o=ME(),c=N=>{var M;n||(b(new NU(N)),(M=t.abort)==null||M.call(t))},i=()=>{r=!0},f=()=>{r=!1},p=()=>dI.isFocused()&&(t.networkMode==="always"||xS.isOnline())&&t.canRun(),g=()=>wU(t.networkMode)&&t.canRun(),y=N=>{var M;n||(n=!0,(M=t.onSuccess)==null||M.call(t,N),a==null||a(),o.resolve(N))},b=N=>{var M;n||(n=!0,(M=t.onError)==null||M.call(t,N),a==null||a(),o.reject(N))},w=()=>new Promise(N=>{var M;a=O=>{(n||p())&&N(O)},(M=t.onPause)==null||M.call(t)}).then(()=>{var N;a=void 0,n||(N=t.onContinue)==null||N.call(t)}),T=()=>{if(n)return;let N;const M=s===0?t.initialPromise:void 0;try{N=M??t.fn()}catch(O){N=Promise.reject(O)}Promise.resolve(N).then(y).catch(O=>{var B;if(n)return;const C=t.retry??(yp?0:3),D=t.retryDelay??hse,L=typeof D=="function"?D(s,O):D,F=C===!0||typeof C=="number"&&s<C||typeof C=="function"&&C(s,O);if(r||!F){b(O);return}s++,(B=t.onFail)==null||B.call(t,s,O),ose(L).then(()=>p()?void 0:w()).then(()=>{r?b(O):T()})})};return{promise:o,cancel:c,continue:()=>(a==null||a(),o),cancelRetry:i,continueRetry:f,canStart:g,start:()=>(g()?T():w().then(T),o)}}function mse(){let t=[],r=0,s=i=>{i()},n=i=>{i()},a=i=>setTimeout(i,0);const o=i=>{r?t.push(i):a(()=>{s(i)})},c=()=>{const i=t;t=[],i.length&&a(()=>{n(()=>{i.forEach(f=>{s(f)})})})};return{batch:i=>{let f;r++;try{f=i()}finally{r--,r||c()}return f},batchCalls:i=>(...f)=>{o(()=>{i(...f)})},schedule:o,setNotifyFunction:i=>{s=i},setBatchNotifyFunction:i=>{n=i},setScheduler:i=>{a=i}}}var ii=mse(),tp,Y8,CU=(Y8=class{constructor(){Gr(this,tp)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),AE(this.gcTime)&&Pr(this,tp,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(yp?1/0:5*60*1e3))}clearGcTimeout(){st(this,tp)&&(clearTimeout(st(this,tp)),Pr(this,tp,void 0))}},tp=new WeakMap,Y8),Zg,Yg,Il,ao,g_,rp,Pc,gu,X8,fse=(X8=class extends CU{constructor(r){super();Gr(this,Pc);Gr(this,Zg);Gr(this,Yg);Gr(this,Il);Gr(this,ao);Gr(this,g_);Gr(this,rp);Pr(this,rp,!1),Pr(this,g_,r.defaultOptions),this.setOptions(r.options),this.observers=[],Pr(this,Il,r.cache),this.queryKey=r.queryKey,this.queryHash=r.queryHash,Pr(this,Zg,pse(this.options)),this.state=r.state??st(this,Zg),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var r;return(r=st(this,ao))==null?void 0:r.promise}setOptions(r){this.options={...st(this,g_),...r},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&st(this,Il).remove(this)}setData(r,s){const n=EE(this.state.data,r,this.options);return js(this,Pc,gu).call(this,{data:n,type:"success",dataUpdatedAt:s==null?void 0:s.updatedAt,manual:s==null?void 0:s.manual}),n}setState(r,s){js(this,Pc,gu).call(this,{type:"setState",state:r,setStateOptions:s})}cancel(r){var n,a;const s=(n=st(this,ao))==null?void 0:n.promise;return(a=st(this,ao))==null||a.cancel(r),s?s.then(Dl).catch(Dl):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(st(this,Zg))}isActive(){return this.observers.some(r=>Mc(r.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===cI||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(r=>r.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(r=0){return this.state.isInvalidated||this.state.data===void 0||!jU(this.state.dataUpdatedAt,r)}onFocus(){var s;const r=this.observers.find(n=>n.shouldFetchOnWindowFocus());r==null||r.refetch({cancelRefetch:!1}),(s=st(this,ao))==null||s.continue()}onOnline(){var s;const r=this.observers.find(n=>n.shouldFetchOnReconnect());r==null||r.refetch({cancelRefetch:!1}),(s=st(this,ao))==null||s.continue()}addObserver(r){this.observers.includes(r)||(this.observers.push(r),this.clearGcTimeout(),st(this,Il).notify({type:"observerAdded",query:this,observer:r}))}removeObserver(r){this.observers.includes(r)&&(this.observers=this.observers.filter(s=>s!==r),this.observers.length||(st(this,ao)&&(st(this,rp)?st(this,ao).cancel({revert:!0}):st(this,ao).cancelRetry()),this.scheduleGc()),st(this,Il).notify({type:"observerRemoved",query:this,observer:r}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||js(this,Pc,gu).call(this,{type:"invalidate"})}fetch(r,s){var f,p,g;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(s!=null&&s.cancelRefetch))this.cancel({silent:!0});else if(st(this,ao))return st(this,ao).continueRetry(),st(this,ao).promise}if(r&&this.setOptions(r),!this.options.queryFn){const y=this.observers.find(b=>b.options.queryFn);y&&this.setOptions(y.options)}const n=new AbortController,a=y=>{Object.defineProperty(y,"signal",{enumerable:!0,get:()=>(Pr(this,rp,!0),n.signal)})},o=()=>{const y=_U(this.options,s),b={queryKey:this.queryKey,meta:this.meta};return a(b),Pr(this,rp,!1),this.options.persister?this.options.persister(y,b,this):y(b)},c={fetchOptions:s,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:o};a(c),(f=this.options.behavior)==null||f.onFetch(c,this),Pr(this,Yg,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((p=c.fetchOptions)==null?void 0:p.meta))&&js(this,Pc,gu).call(this,{type:"fetch",meta:(g=c.fetchOptions)==null?void 0:g.meta});const i=y=>{var b,w,T,N;wA(y)&&y.silent||js(this,Pc,gu).call(this,{type:"error",error:y}),wA(y)||((w=(b=st(this,Il).config).onError)==null||w.call(b,y,this),(N=(T=st(this,Il).config).onSettled)==null||N.call(T,this.state.data,y,this)),this.scheduleGc()};return Pr(this,ao,SU({initialPromise:s==null?void 0:s.initialPromise,fn:c.fetchFn,abort:n.abort.bind(n),onSuccess:y=>{var b,w,T,N;if(y===void 0){i(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(y)}catch(M){i(M);return}(w=(b=st(this,Il).config).onSuccess)==null||w.call(b,y,this),(N=(T=st(this,Il).config).onSettled)==null||N.call(T,y,this.state.error,this),this.scheduleGc()},onError:i,onFail:(y,b)=>{js(this,Pc,gu).call(this,{type:"failed",failureCount:y,error:b})},onPause:()=>{js(this,Pc,gu).call(this,{type:"pause"})},onContinue:()=>{js(this,Pc,gu).call(this,{type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0})),st(this,ao).start()}},Zg=new WeakMap,Yg=new WeakMap,Il=new WeakMap,ao=new WeakMap,g_=new WeakMap,rp=new WeakMap,Pc=new WeakSet,gu=function(r){const s=n=>{switch(r.type){case"failed":return{...n,fetchFailureCount:r.failureCount,fetchFailureReason:r.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...PU(n.data,this.options),fetchMeta:r.meta??null};case"success":return{...n,data:r.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:r.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!r.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=r.error;return wA(a)&&a.revert&&st(this,Yg)?{...st(this,Yg),fetchStatus:"idle"}:{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...r.state}}};this.state=s(this.state),ii.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),st(this,Il).notify({query:this,type:"updated",action:r})})},X8);function PU(t,r){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:wU(r.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function pse(t){const r=typeof t.initialData=="function"?t.initialData():t.initialData,s=r!==void 0,n=s?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:r,dataUpdateCount:0,dataUpdatedAt:s?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var md,Q8,xse=(Q8=class extends av{constructor(r={}){super();Gr(this,md);this.config=r,Pr(this,md,new Map)}build(r,s,n){const a=s.queryKey,o=s.queryHash??lI(a,s);let c=this.get(o);return c||(c=new fse({cache:this,queryKey:a,queryHash:o,options:r.defaultQueryOptions(s),state:n,defaultOptions:r.getQueryDefaults(a)}),this.add(c)),c}add(r){st(this,md).has(r.queryHash)||(st(this,md).set(r.queryHash,r),this.notify({type:"added",query:r}))}remove(r){const s=st(this,md).get(r.queryHash);s&&(r.destroy(),s===r&&st(this,md).delete(r.queryHash),this.notify({type:"removed",query:r}))}clear(){ii.batch(()=>{this.getAll().forEach(r=>{this.remove(r)})})}get(r){return st(this,md).get(r)}getAll(){return[...st(this,md).values()]}find(r){const s={exact:!0,...r};return this.getAll().find(n=>gF(s,n))}findAll(r={}){const s=this.getAll();return Object.keys(r).length>0?s.filter(n=>gF(r,n)):s}notify(r){ii.batch(()=>{this.listeners.forEach(s=>{s(r)})})}onFocus(){ii.batch(()=>{this.getAll().forEach(r=>{r.onFocus()})})}onOnline(){ii.batch(()=>{this.getAll().forEach(r=>{r.onOnline()})})}},md=new WeakMap,Q8),fd,vo,sp,pd,Oh,J8,gse=(J8=class extends CU{constructor(r){super();Gr(this,pd);Gr(this,fd);Gr(this,vo);Gr(this,sp);this.mutationId=r.mutationId,Pr(this,vo,r.mutationCache),Pr(this,fd,[]),this.state=r.state||kU(),this.setOptions(r.options),this.scheduleGc()}setOptions(r){this.options=r,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(r){st(this,fd).includes(r)||(st(this,fd).push(r),this.clearGcTimeout(),st(this,vo).notify({type:"observerAdded",mutation:this,observer:r}))}removeObserver(r){Pr(this,fd,st(this,fd).filter(s=>s!==r)),this.scheduleGc(),st(this,vo).notify({type:"observerRemoved",mutation:this,observer:r})}optionalRemove(){st(this,fd).length||(this.state.status==="pending"?this.scheduleGc():st(this,vo).remove(this))}continue(){var r;return((r=st(this,sp))==null?void 0:r.continue())??this.execute(this.state.variables)}async execute(r){var a,o,c,i,f,p,g,y,b,w,T,N,M,O,C,D,L,F,B,U;Pr(this,sp,SU({fn:()=>this.options.mutationFn?this.options.mutationFn(r):Promise.reject(new Error("No mutationFn found")),onFail:(te,Q)=>{js(this,pd,Oh).call(this,{type:"failed",failureCount:te,error:Q})},onPause:()=>{js(this,pd,Oh).call(this,{type:"pause"})},onContinue:()=>{js(this,pd,Oh).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>st(this,vo).canRun(this)}));const s=this.state.status==="pending",n=!st(this,sp).canStart();try{if(!s){js(this,pd,Oh).call(this,{type:"pending",variables:r,isPaused:n}),await((o=(a=st(this,vo).config).onMutate)==null?void 0:o.call(a,r,this));const Q=await((i=(c=this.options).onMutate)==null?void 0:i.call(c,r));Q!==this.state.context&&js(this,pd,Oh).call(this,{type:"pending",context:Q,variables:r,isPaused:n})}const te=await st(this,sp).start();return await((p=(f=st(this,vo).config).onSuccess)==null?void 0:p.call(f,te,r,this.state.context,this)),await((y=(g=this.options).onSuccess)==null?void 0:y.call(g,te,r,this.state.context)),await((w=(b=st(this,vo).config).onSettled)==null?void 0:w.call(b,te,null,this.state.variables,this.state.context,this)),await((N=(T=this.options).onSettled)==null?void 0:N.call(T,te,null,r,this.state.context)),js(this,pd,Oh).call(this,{type:"success",data:te}),te}catch(te){try{throw await((O=(M=st(this,vo).config).onError)==null?void 0:O.call(M,te,r,this.state.context,this)),await((D=(C=this.options).onError)==null?void 0:D.call(C,te,r,this.state.context)),await((F=(L=st(this,vo).config).onSettled)==null?void 0:F.call(L,void 0,te,this.state.variables,this.state.context,this)),await((U=(B=this.options).onSettled)==null?void 0:U.call(B,void 0,te,r,this.state.context)),te}finally{js(this,pd,Oh).call(this,{type:"error",error:te})}}finally{st(this,vo).runNext(this)}}},fd=new WeakMap,vo=new WeakMap,sp=new WeakMap,pd=new WeakSet,Oh=function(r){const s=n=>{switch(r.type){case"failed":return{...n,failureCount:r.failureCount,failureReason:r.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:r.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:r.isPaused,status:"pending",variables:r.variables,submittedAt:Date.now()};case"success":return{...n,data:r.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:r.error,failureCount:n.failureCount+1,failureReason:r.error,isPaused:!1,status:"error"}}};this.state=s(this.state),ii.batch(()=>{st(this,fd).forEach(n=>{n.onMutationUpdate(r)}),st(this,vo).notify({mutation:this,type:"updated",action:r})})},J8);function kU(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ll,y_,eq,yse=(eq=class extends av{constructor(r={}){super();Gr(this,ll);Gr(this,y_);this.config=r,Pr(this,ll,new Map),Pr(this,y_,Date.now())}build(r,s,n){const a=new gse({mutationCache:this,mutationId:++E1(this,y_)._,options:r.defaultMutationOptions(s),state:n});return this.add(a),a}add(r){const s=Z1(r),n=st(this,ll).get(s)??[];n.push(r),st(this,ll).set(s,n),this.notify({type:"added",mutation:r})}remove(r){var n;const s=Z1(r);if(st(this,ll).has(s)){const a=(n=st(this,ll).get(s))==null?void 0:n.filter(o=>o!==r);a&&(a.length===0?st(this,ll).delete(s):st(this,ll).set(s,a))}this.notify({type:"removed",mutation:r})}canRun(r){var n;const s=(n=st(this,ll).get(Z1(r)))==null?void 0:n.find(a=>a.state.status==="pending");return!s||s===r}runNext(r){var n;const s=(n=st(this,ll).get(Z1(r)))==null?void 0:n.find(a=>a!==r&&a.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}clear(){ii.batch(()=>{this.getAll().forEach(r=>{this.remove(r)})})}getAll(){return[...st(this,ll).values()].flat()}find(r){const s={exact:!0,...r};return this.getAll().find(n=>yF(s,n))}findAll(r={}){return this.getAll().filter(s=>yF(r,s))}notify(r){ii.batch(()=>{this.listeners.forEach(s=>{s(r)})})}resumePausedMutations(){const r=this.getAll().filter(s=>s.state.isPaused);return ii.batch(()=>Promise.all(r.map(s=>s.continue().catch(Dl))))}},ll=new WeakMap,y_=new WeakMap,eq);function Z1(t){var r;return((r=t.options.scope)==null?void 0:r.id)??String(t.mutationId)}function bF(t){return{onFetch:(r,s)=>{var g,y,b,w,T;const n=r.options,a=(b=(y=(g=r.fetchOptions)==null?void 0:g.meta)==null?void 0:y.fetchMore)==null?void 0:b.direction,o=((w=r.state.data)==null?void 0:w.pages)||[],c=((T=r.state.data)==null?void 0:T.pageParams)||[];let i={pages:[],pageParams:[]},f=0;const p=async()=>{let N=!1;const M=D=>{Object.defineProperty(D,"signal",{enumerable:!0,get:()=>(r.signal.aborted?N=!0:r.signal.addEventListener("abort",()=>{N=!0}),r.signal)})},O=_U(r.options,r.fetchOptions),C=async(D,L,F)=>{if(N)return Promise.reject();if(L==null&&D.pages.length)return Promise.resolve(D);const B={queryKey:r.queryKey,pageParam:L,direction:F?"backward":"forward",meta:r.options.meta};M(B);const U=await O(B),{maxPages:te}=r.options,Q=F?cse:lse;return{pages:Q(D.pages,U,te),pageParams:Q(D.pageParams,L,te)}};if(a&&o.length){const D=a==="backward",L=D?vse:_F,F={pages:o,pageParams:c},B=L(n,F);i=await C(F,B,D)}else{const D=t??o.length;do{const L=f===0?c[0]??n.initialPageParam:_F(n,i);if(f>0&&L==null)break;i=await C(i,L),f++}while(f<D)}return i};r.options.persister?r.fetchFn=()=>{var N,M;return(M=(N=r.options).persister)==null?void 0:M.call(N,p,{queryKey:r.queryKey,meta:r.options.meta,signal:r.signal},s)}:r.fetchFn=p}}}function _F(t,{pages:r,pageParams:s}){const n=r.length-1;return r.length>0?t.getNextPageParam(r[n],r,s[n],s):void 0}function vse(t,{pages:r,pageParams:s}){var n;return r.length>0?(n=t.getPreviousPageParam)==null?void 0:n.call(t,r[0],r,s[0],s):void 0}var ja,Kh,Hh,Xg,Qg,Zh,Jg,ey,tq,jse=(tq=class{constructor(t={}){Gr(this,ja);Gr(this,Kh);Gr(this,Hh);Gr(this,Xg);Gr(this,Qg);Gr(this,Zh);Gr(this,Jg);Gr(this,ey);Pr(this,ja,t.queryCache||new xse),Pr(this,Kh,t.mutationCache||new yse),Pr(this,Hh,t.defaultOptions||{}),Pr(this,Xg,new Map),Pr(this,Qg,new Map),Pr(this,Zh,0)}mount(){E1(this,Zh)._++,st(this,Zh)===1&&(Pr(this,Jg,dI.subscribe(async t=>{t&&(await this.resumePausedMutations(),st(this,ja).onFocus())})),Pr(this,ey,xS.subscribe(async t=>{t&&(await this.resumePausedMutations(),st(this,ja).onOnline())})))}unmount(){var t,r;E1(this,Zh)._--,st(this,Zh)===0&&((t=st(this,Jg))==null||t.call(this),Pr(this,Jg,void 0),(r=st(this,ey))==null||r.call(this),Pr(this,ey,void 0))}isFetching(t){return st(this,ja).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return st(this,Kh).findAll({...t,status:"pending"}).length}getQueryData(t){var s;const r=this.defaultQueryOptions({queryKey:t});return(s=st(this,ja).get(r.queryHash))==null?void 0:s.state.data}ensureQueryData(t){const r=this.getQueryData(t.queryKey);if(r===void 0)return this.fetchQuery(t);{const s=this.defaultQueryOptions(t),n=st(this,ja).build(this,s);return t.revalidateIfStale&&n.isStaleByTime(Lg(s.staleTime,n))&&this.prefetchQuery(s),Promise.resolve(r)}}getQueriesData(t){return st(this,ja).findAll(t).map(({queryKey:r,state:s})=>{const n=s.data;return[r,n]})}setQueryData(t,r,s){const n=this.defaultQueryOptions({queryKey:t}),a=st(this,ja).get(n.queryHash),o=a==null?void 0:a.state.data,c=ise(r,o);if(c!==void 0)return st(this,ja).build(this,n).setData(c,{...s,manual:!0})}setQueriesData(t,r,s){return ii.batch(()=>st(this,ja).findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,r,s)]))}getQueryState(t){var s;const r=this.defaultQueryOptions({queryKey:t});return(s=st(this,ja).get(r.queryHash))==null?void 0:s.state}removeQueries(t){const r=st(this,ja);ii.batch(()=>{r.findAll(t).forEach(s=>{r.remove(s)})})}resetQueries(t,r){const s=st(this,ja),n={type:"active",...t};return ii.batch(()=>(s.findAll(t).forEach(a=>{a.reset()}),this.refetchQueries(n,r)))}cancelQueries(t={},r={}){const s={revert:!0,...r},n=ii.batch(()=>st(this,ja).findAll(t).map(a=>a.cancel(s)));return Promise.all(n).then(Dl).catch(Dl)}invalidateQueries(t={},r={}){return ii.batch(()=>{if(st(this,ja).findAll(t).forEach(n=>{n.invalidate()}),t.refetchType==="none")return Promise.resolve();const s={...t,type:t.refetchType??t.type??"active"};return this.refetchQueries(s,r)})}refetchQueries(t={},r){const s={...r,cancelRefetch:(r==null?void 0:r.cancelRefetch)??!0},n=ii.batch(()=>st(this,ja).findAll(t).filter(a=>!a.isDisabled()).map(a=>{let o=a.fetch(void 0,s);return s.throwOnError||(o=o.catch(Dl)),a.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(n).then(Dl)}fetchQuery(t){const r=this.defaultQueryOptions(t);r.retry===void 0&&(r.retry=!1);const s=st(this,ja).build(this,r);return s.isStaleByTime(Lg(r.staleTime,s))?s.fetch(r):Promise.resolve(s.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Dl).catch(Dl)}fetchInfiniteQuery(t){return t.behavior=bF(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Dl).catch(Dl)}ensureInfiniteQueryData(t){return t.behavior=bF(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return xS.isOnline()?st(this,Kh).resumePausedMutations():Promise.resolve()}getQueryCache(){return st(this,ja)}getMutationCache(){return st(this,Kh)}getDefaultOptions(){return st(this,Hh)}setDefaultOptions(t){Pr(this,Hh,t)}setQueryDefaults(t,r){st(this,Xg).set(vp(t),{queryKey:t,defaultOptions:r})}getQueryDefaults(t){const r=[...st(this,Xg).values()];let s={};return r.forEach(n=>{xb(t,n.queryKey)&&(s={...s,...n.defaultOptions})}),s}setMutationDefaults(t,r){st(this,Qg).set(vp(t),{mutationKey:t,defaultOptions:r})}getMutationDefaults(t){const r=[...st(this,Qg).values()];let s={};return r.forEach(n=>{xb(t,n.mutationKey)&&(s={...s,...n.defaultOptions})}),s}defaultQueryOptions(t){if(t._defaulted)return t;const r={...st(this,Hh).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return r.queryHash||(r.queryHash=lI(r.queryKey,r)),r.refetchOnReconnect===void 0&&(r.refetchOnReconnect=r.networkMode!=="always"),r.throwOnError===void 0&&(r.throwOnError=!!r.suspense),!r.networkMode&&r.persister&&(r.networkMode="offlineFirst"),r.enabled!==!0&&r.queryFn===cI&&(r.enabled=!1),r}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...st(this,Hh).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){st(this,ja).clear(),st(this,Kh).clear()}},ja=new WeakMap,Kh=new WeakMap,Hh=new WeakMap,Xg=new WeakMap,Qg=new WeakMap,Zh=new WeakMap,Jg=new WeakMap,ey=new WeakMap,tq),Oo,Ls,v_,jo,np,ty,Yh,xd,j_,ry,sy,ap,ip,Xh,ny,cn,A0,OE,IE,DE,RE,LE,FE,$E,AU,rq,bse=(rq=class extends av{constructor(r,s){super();Gr(this,cn);Gr(this,Oo);Gr(this,Ls);Gr(this,v_);Gr(this,jo);Gr(this,np);Gr(this,ty);Gr(this,Yh);Gr(this,xd);Gr(this,j_);Gr(this,ry);Gr(this,sy);Gr(this,ap);Gr(this,ip);Gr(this,Xh);Gr(this,ny,new Set);this.options=s,Pr(this,Oo,r),Pr(this,xd,null),Pr(this,Yh,ME()),this.options.experimental_prefetchInRender||st(this,Yh).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(st(this,Ls).addObserver(this),wF(st(this,Ls),this.options)?js(this,cn,A0).call(this):this.updateResult(),js(this,cn,RE).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return zE(st(this,Ls),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return zE(st(this,Ls),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,js(this,cn,LE).call(this),js(this,cn,FE).call(this),st(this,Ls).removeObserver(this)}setOptions(r,s){const n=this.options,a=st(this,Ls);if(this.options=st(this,Oo).defaultQueryOptions(r),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Mc(this.options.enabled,st(this,Ls))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");js(this,cn,$E).call(this),st(this,Ls).setOptions(this.options),n._defaulted&&!pS(this.options,n)&&st(this,Oo).getQueryCache().notify({type:"observerOptionsUpdated",query:st(this,Ls),observer:this});const o=this.hasListeners();o&&NF(st(this,Ls),a,this.options,n)&&js(this,cn,A0).call(this),this.updateResult(s),o&&(st(this,Ls)!==a||Mc(this.options.enabled,st(this,Ls))!==Mc(n.enabled,st(this,Ls))||Lg(this.options.staleTime,st(this,Ls))!==Lg(n.staleTime,st(this,Ls)))&&js(this,cn,OE).call(this);const c=js(this,cn,IE).call(this);o&&(st(this,Ls)!==a||Mc(this.options.enabled,st(this,Ls))!==Mc(n.enabled,st(this,Ls))||c!==st(this,Xh))&&js(this,cn,DE).call(this,c)}getOptimisticResult(r){const s=st(this,Oo).getQueryCache().build(st(this,Oo),r),n=this.createResult(s,r);return wse(this,n)&&(Pr(this,jo,n),Pr(this,ty,this.options),Pr(this,np,st(this,Ls).state)),n}getCurrentResult(){return st(this,jo)}trackResult(r,s){const n={};return Object.keys(r).forEach(a=>{Object.defineProperty(n,a,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(a),s==null||s(a),r[a])})}),n}trackProp(r){st(this,ny).add(r)}getCurrentQuery(){return st(this,Ls)}refetch({...r}={}){return this.fetch({...r})}fetchOptimistic(r){const s=st(this,Oo).defaultQueryOptions(r),n=st(this,Oo).getQueryCache().build(st(this,Oo),s);return n.fetch().then(()=>this.createResult(n,s))}fetch(r){return js(this,cn,A0).call(this,{...r,cancelRefetch:r.cancelRefetch??!0}).then(()=>(this.updateResult(),st(this,jo)))}createResult(r,s){var te;const n=st(this,Ls),a=this.options,o=st(this,jo),c=st(this,np),i=st(this,ty),p=r!==n?r.state:st(this,v_),{state:g}=r;let y={...g},b=!1,w;if(s._optimisticResults){const Q=this.hasListeners(),re=!Q&&wF(r,s),Z=Q&&NF(r,n,s,a);(re||Z)&&(y={...y,...PU(g.data,r.options)}),s._optimisticResults==="isRestoring"&&(y.fetchStatus="idle")}let{error:T,errorUpdatedAt:N,status:M}=y;if(s.select&&y.data!==void 0)if(o&&y.data===(c==null?void 0:c.data)&&s.select===st(this,j_))w=st(this,ry);else try{Pr(this,j_,s.select),w=s.select(y.data),w=EE(o==null?void 0:o.data,w,s),Pr(this,ry,w),Pr(this,xd,null)}catch(Q){Pr(this,xd,Q)}else w=y.data;if(s.placeholderData!==void 0&&w===void 0&&M==="pending"){let Q;if(o!=null&&o.isPlaceholderData&&s.placeholderData===(i==null?void 0:i.placeholderData))Q=o.data;else if(Q=typeof s.placeholderData=="function"?s.placeholderData((te=st(this,sy))==null?void 0:te.state.data,st(this,sy)):s.placeholderData,s.select&&Q!==void 0)try{Q=s.select(Q),Pr(this,xd,null)}catch(re){Pr(this,xd,re)}Q!==void 0&&(M="success",w=EE(o==null?void 0:o.data,Q,s),b=!0)}st(this,xd)&&(T=st(this,xd),w=st(this,ry),N=Date.now(),M="error");const O=y.fetchStatus==="fetching",C=M==="pending",D=M==="error",L=C&&O,F=w!==void 0,U={status:M,fetchStatus:y.fetchStatus,isPending:C,isSuccess:M==="success",isError:D,isInitialLoading:L,isLoading:L,data:w,dataUpdatedAt:y.dataUpdatedAt,error:T,errorUpdatedAt:N,failureCount:y.fetchFailureCount,failureReason:y.fetchFailureReason,errorUpdateCount:y.errorUpdateCount,isFetched:y.dataUpdateCount>0||y.errorUpdateCount>0,isFetchedAfterMount:y.dataUpdateCount>p.dataUpdateCount||y.errorUpdateCount>p.errorUpdateCount,isFetching:O,isRefetching:O&&!C,isLoadingError:D&&!F,isPaused:y.fetchStatus==="paused",isPlaceholderData:b,isRefetchError:D&&F,isStale:uI(r,s),refetch:this.refetch,promise:st(this,Yh)};if(this.options.experimental_prefetchInRender){const Q=ne=>{U.status==="error"?ne.reject(U.error):U.data!==void 0&&ne.resolve(U.data)},re=()=>{const ne=Pr(this,Yh,U.promise=ME());Q(ne)},Z=st(this,Yh);switch(Z.status){case"pending":r.queryHash===n.queryHash&&Q(Z);break;case"fulfilled":(U.status==="error"||U.data!==Z.value)&&re();break;case"rejected":(U.status!=="error"||U.error!==Z.reason)&&re();break}}return U}updateResult(r){const s=st(this,jo),n=this.createResult(st(this,Ls),this.options);if(Pr(this,np,st(this,Ls).state),Pr(this,ty,this.options),st(this,np).data!==void 0&&Pr(this,sy,st(this,Ls)),pS(n,s))return;Pr(this,jo,n);const a={},o=()=>{if(!s)return!0;const{notifyOnChangeProps:c}=this.options,i=typeof c=="function"?c():c;if(i==="all"||!i&&!st(this,ny).size)return!0;const f=new Set(i??st(this,ny));return this.options.throwOnError&&f.add("error"),Object.keys(st(this,jo)).some(p=>{const g=p;return st(this,jo)[g]!==s[g]&&f.has(g)})};(r==null?void 0:r.listeners)!==!1&&o()&&(a.listeners=!0),js(this,cn,AU).call(this,{...a,...r})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&js(this,cn,RE).call(this)}},Oo=new WeakMap,Ls=new WeakMap,v_=new WeakMap,jo=new WeakMap,np=new WeakMap,ty=new WeakMap,Yh=new WeakMap,xd=new WeakMap,j_=new WeakMap,ry=new WeakMap,sy=new WeakMap,ap=new WeakMap,ip=new WeakMap,Xh=new WeakMap,ny=new WeakMap,cn=new WeakSet,A0=function(r){js(this,cn,$E).call(this);let s=st(this,Ls).fetch(this.options,r);return r!=null&&r.throwOnError||(s=s.catch(Dl)),s},OE=function(){js(this,cn,LE).call(this);const r=Lg(this.options.staleTime,st(this,Ls));if(yp||st(this,jo).isStale||!AE(r))return;const n=jU(st(this,jo).dataUpdatedAt,r)+1;Pr(this,ap,setTimeout(()=>{st(this,jo).isStale||this.updateResult()},n))},IE=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(st(this,Ls)):this.options.refetchInterval)??!1},DE=function(r){js(this,cn,FE).call(this),Pr(this,Xh,r),!(yp||Mc(this.options.enabled,st(this,Ls))===!1||!AE(st(this,Xh))||st(this,Xh)===0)&&Pr(this,ip,setInterval(()=>{(this.options.refetchIntervalInBackground||dI.isFocused())&&js(this,cn,A0).call(this)},st(this,Xh)))},RE=function(){js(this,cn,OE).call(this),js(this,cn,DE).call(this,js(this,cn,IE).call(this))},LE=function(){st(this,ap)&&(clearTimeout(st(this,ap)),Pr(this,ap,void 0))},FE=function(){st(this,ip)&&(clearInterval(st(this,ip)),Pr(this,ip,void 0))},$E=function(){const r=st(this,Oo).getQueryCache().build(st(this,Oo),this.options);if(r===st(this,Ls))return;const s=st(this,Ls);Pr(this,Ls,r),Pr(this,v_,r.state),this.hasListeners()&&(s==null||s.removeObserver(this),r.addObserver(this))},AU=function(r){ii.batch(()=>{r.listeners&&this.listeners.forEach(s=>{s(st(this,jo))}),st(this,Oo).getQueryCache().notify({query:st(this,Ls),type:"observerResultsUpdated"})})},rq);function _se(t,r){return Mc(r.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&r.retryOnMount===!1)}function wF(t,r){return _se(t,r)||t.state.data!==void 0&&zE(t,r,r.refetchOnMount)}function zE(t,r,s){if(Mc(r.enabled,t)!==!1){const n=typeof s=="function"?s(t):s;return n==="always"||n!==!1&&uI(t,r)}return!1}function NF(t,r,s,n){return(t!==r||Mc(n.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&uI(t,s)}function uI(t,r){return Mc(r.enabled,t)!==!1&&t.isStaleByTime(Lg(r.staleTime,t))}function wse(t,r){return!pS(t.getCurrentResult(),r)}var Qh,Jh,Io,bu,Ou,FN,BE,sq,Nse=(sq=class extends av{constructor(s,n){super();Gr(this,Ou);Gr(this,Qh);Gr(this,Jh);Gr(this,Io);Gr(this,bu);Pr(this,Qh,s),this.setOptions(n),this.bindMethods(),js(this,Ou,FN).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(s){var a;const n=this.options;this.options=st(this,Qh).defaultMutationOptions(s),pS(this.options,n)||st(this,Qh).getMutationCache().notify({type:"observerOptionsUpdated",mutation:st(this,Io),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&vp(n.mutationKey)!==vp(this.options.mutationKey)?this.reset():((a=st(this,Io))==null?void 0:a.state.status)==="pending"&&st(this,Io).setOptions(this.options)}onUnsubscribe(){var s;this.hasListeners()||(s=st(this,Io))==null||s.removeObserver(this)}onMutationUpdate(s){js(this,Ou,FN).call(this),js(this,Ou,BE).call(this,s)}getCurrentResult(){return st(this,Jh)}reset(){var s;(s=st(this,Io))==null||s.removeObserver(this),Pr(this,Io,void 0),js(this,Ou,FN).call(this),js(this,Ou,BE).call(this)}mutate(s,n){var a;return Pr(this,bu,n),(a=st(this,Io))==null||a.removeObserver(this),Pr(this,Io,st(this,Qh).getMutationCache().build(st(this,Qh),this.options)),st(this,Io).addObserver(this),st(this,Io).execute(s)}},Qh=new WeakMap,Jh=new WeakMap,Io=new WeakMap,bu=new WeakMap,Ou=new WeakSet,FN=function(){var n;const s=((n=st(this,Io))==null?void 0:n.state)??kU();Pr(this,Jh,{...s,isPending:s.status==="pending",isSuccess:s.status==="success",isError:s.status==="error",isIdle:s.status==="idle",mutate:this.mutate,reset:this.reset})},BE=function(s){ii.batch(()=>{var n,a,o,c,i,f,p,g;if(st(this,bu)&&this.hasListeners()){const y=st(this,Jh).variables,b=st(this,Jh).context;(s==null?void 0:s.type)==="success"?((a=(n=st(this,bu)).onSuccess)==null||a.call(n,s.data,y,b),(c=(o=st(this,bu)).onSettled)==null||c.call(o,s.data,null,y,b)):(s==null?void 0:s.type)==="error"&&((f=(i=st(this,bu)).onError)==null||f.call(i,s.error,y,b),(g=(p=st(this,bu)).onSettled)==null||g.call(p,void 0,s.error,y,b))}this.listeners.forEach(y=>{y(st(this,Jh))})})},sq),TU=A.createContext(void 0),yr=t=>{const r=A.useContext(TU);if(!r)throw new Error("No QueryClient set, use QueryClientProvider to set one");return r},Sse=({client:t,children:r})=>(A.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),e.jsx(TU.Provider,{value:t,children:r})),EU=A.createContext(!1),Cse=()=>A.useContext(EU);EU.Provider;function Pse(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var kse=A.createContext(Pse()),Ase=()=>A.useContext(kse);function MU(t,r){return typeof t=="function"?t(...r):!!t}function qE(){}var Tse=(t,r)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(r.isReset()||(t.retryOnMount=!1))},Ese=t=>{A.useEffect(()=>{t.clearReset()},[t])},Mse=({result:t,errorResetBoundary:r,throwOnError:s,query:n})=>t.isError&&!r.isReset()&&!t.isFetching&&n&&MU(s,[t.error,n]),Ose=t=>{t.suspense&&(t.staleTime===void 0&&(t.staleTime=1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},Ise=(t,r)=>t.isLoading&&t.isFetching&&!r,Dse=(t,r)=>(t==null?void 0:t.suspense)&&r.isPending,SF=(t,r,s)=>r.fetchOptimistic(t).catch(()=>{s.clearReset()});function Rse(t,r,s){var g,y,b,w,T;const n=yr(),a=Cse(),o=Ase(),c=n.defaultQueryOptions(t);(y=(g=n.getDefaultOptions().queries)==null?void 0:g._experimental_beforeQuery)==null||y.call(g,c),c._optimisticResults=a?"isRestoring":"optimistic",Ose(c),Tse(c,o),Ese(o);const i=!n.getQueryCache().get(c.queryHash),[f]=A.useState(()=>new r(n,c)),p=f.getOptimisticResult(c);if(A.useSyncExternalStore(A.useCallback(N=>{const M=a?qE:f.subscribe(ii.batchCalls(N));return f.updateResult(),M},[f,a]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),A.useEffect(()=>{f.setOptions(c,{listeners:!1})},[c,f]),Dse(c,p))throw SF(c,f,o);if(Mse({result:p,errorResetBoundary:o,throwOnError:c.throwOnError,query:n.getQueryCache().get(c.queryHash)}))throw p.error;if((w=(b=n.getDefaultOptions().queries)==null?void 0:b._experimental_afterQuery)==null||w.call(b,c,p),c.experimental_prefetchInRender&&!yp&&Ise(p,a)){const N=i?SF(c,f,o):(T=n.getQueryCache().get(c.queryHash))==null?void 0:T.promise;N==null||N.catch(qE).finally(()=>{f.updateResult()})}return c.notifyOnChangeProps?p:f.trackResult(p)}function it(t,r){return Rse(t,bse)}function gt(t,r){const s=yr(),[n]=A.useState(()=>new Nse(s,t));A.useEffect(()=>{n.setOptions(t)},[n,t]);const a=A.useSyncExternalStore(A.useCallback(c=>n.subscribe(ii.batchCalls(c)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),o=A.useCallback((c,i)=>{n.mutate(c,i).catch(qE)},[n]);if(a.error&&MU(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:o,mutateAsync:a.mutate}}/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gb(){return gb=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},gb.apply(this,arguments)}var rm;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(rm||(rm={}));const CF="popstate";function Lse(t){t===void 0&&(t={});function r(n,a){let{pathname:o,search:c,hash:i}=n.location;return VE("",{pathname:o,search:c,hash:i},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function s(n,a){return typeof a=="string"?a:gS(a)}return $se(r,s,null,t)}function ha(t,r){if(t===!1||t===null||typeof t>"u")throw new Error(r)}function OU(t,r){if(!t){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function Fse(){return Math.random().toString(36).substr(2,8)}function PF(t,r){return{usr:t.state,key:t.key,idx:r}}function VE(t,r,s,n){return s===void 0&&(s=null),gb({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof r=="string"?iv(r):r,{state:s,key:r&&r.key||n||Fse()})}function gS(t){let{pathname:r="/",search:s="",hash:n=""}=t;return s&&s!=="?"&&(r+=s.charAt(0)==="?"?s:"?"+s),n&&n!=="#"&&(r+=n.charAt(0)==="#"?n:"#"+n),r}function iv(t){let r={};if(t){let s=t.indexOf("#");s>=0&&(r.hash=t.substr(s),t=t.substr(0,s));let n=t.indexOf("?");n>=0&&(r.search=t.substr(n),t=t.substr(0,n)),t&&(r.pathname=t)}return r}function $se(t,r,s,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:o=!1}=n,c=a.history,i=rm.Pop,f=null,p=g();p==null&&(p=0,c.replaceState(gb({},c.state,{idx:p}),""));function g(){return(c.state||{idx:null}).idx}function y(){i=rm.Pop;let M=g(),O=M==null?null:M-p;p=M,f&&f({action:i,location:N.location,delta:O})}function b(M,O){i=rm.Push;let C=VE(N.location,M,O);p=g()+1;let D=PF(C,p),L=N.createHref(C);try{c.pushState(D,"",L)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;a.location.assign(L)}o&&f&&f({action:i,location:N.location,delta:1})}function w(M,O){i=rm.Replace;let C=VE(N.location,M,O);p=g();let D=PF(C,p),L=N.createHref(C);c.replaceState(D,"",L),o&&f&&f({action:i,location:N.location,delta:0})}function T(M){let O=a.location.origin!=="null"?a.location.origin:a.location.href,C=typeof M=="string"?M:gS(M);return C=C.replace(/ $/,"%20"),ha(O,"No window.location.(origin|href) available to create URL for href: "+C),new URL(C,O)}let N={get action(){return i},get location(){return t(a,c)},listen(M){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(CF,y),f=M,()=>{a.removeEventListener(CF,y),f=null}},createHref(M){return r(a,M)},createURL:T,encodeLocation(M){let O=T(M);return{pathname:O.pathname,search:O.search,hash:O.hash}},push:b,replace:w,go(M){return c.go(M)}};return N}var kF;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(kF||(kF={}));function zse(t,r,s){return s===void 0&&(s="/"),Bse(t,r,s)}function Bse(t,r,s,n){let a=typeof r=="string"?iv(r):r,o=hy(a.pathname||"/",s);if(o==null)return null;let c=IU(t);qse(c);let i=null;for(let f=0;i==null&&f<c.length;++f){let p=Jse(o);i=Xse(c[f],p)}return i}function IU(t,r,s,n){r===void 0&&(r=[]),s===void 0&&(s=[]),n===void 0&&(n="");let a=(o,c,i)=>{let f={relativePath:i===void 0?o.path||"":i,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};f.relativePath.startsWith("/")&&(ha(f.relativePath.startsWith(n),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(n.length));let p=fm([n,f.relativePath]),g=s.concat(f);o.children&&o.children.length>0&&(ha(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+p+'".')),IU(o.children,r,g,p)),!(o.path==null&&!o.index)&&r.push({path:p,score:Zse(p,o.index),routesMeta:g})};return t.forEach((o,c)=>{var i;if(o.path===""||!((i=o.path)!=null&&i.includes("?")))a(o,c);else for(let f of DU(o.path))a(o,c,f)}),r}function DU(t){let r=t.split("/");if(r.length===0)return[];let[s,...n]=r,a=s.endsWith("?"),o=s.replace(/\?$/,"");if(n.length===0)return a?[o,""]:[o];let c=DU(n.join("/")),i=[];return i.push(...c.map(f=>f===""?o:[o,f].join("/"))),a&&i.push(...c),i.map(f=>t.startsWith("/")&&f===""?"/":f)}function qse(t){t.sort((r,s)=>r.score!==s.score?s.score-r.score:Yse(r.routesMeta.map(n=>n.childrenIndex),s.routesMeta.map(n=>n.childrenIndex)))}const Vse=/^:[\w-]+$/,Use=3,Wse=2,Gse=1,Kse=10,Hse=-2,AF=t=>t==="*";function Zse(t,r){let s=t.split("/"),n=s.length;return s.some(AF)&&(n+=Hse),r&&(n+=Wse),s.filter(a=>!AF(a)).reduce((a,o)=>a+(Vse.test(o)?Use:o===""?Gse:Kse),n)}function Yse(t,r){return t.length===r.length&&t.slice(0,-1).every((n,a)=>n===r[a])?t[t.length-1]-r[r.length-1]:0}function Xse(t,r,s){let{routesMeta:n}=t,a={},o="/",c=[];for(let i=0;i<n.length;++i){let f=n[i],p=i===n.length-1,g=o==="/"?r:r.slice(o.length)||"/",y=UE({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},g),b=f.route;if(!y)return null;Object.assign(a,y.params),c.push({params:a,pathname:fm([o,y.pathname]),pathnameBase:sne(fm([o,y.pathnameBase])),route:b}),y.pathnameBase!=="/"&&(o=fm([o,y.pathnameBase]))}return c}function UE(t,r){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[s,n]=Qse(t.path,t.caseSensitive,t.end),a=r.match(s);if(!a)return null;let o=a[0],c=o.replace(/(.)\/+$/,"$1"),i=a.slice(1);return{params:n.reduce((p,g,y)=>{let{paramName:b,isOptional:w}=g;if(b==="*"){let N=i[y]||"";c=o.slice(0,o.length-N.length).replace(/(.)\/+$/,"$1")}const T=i[y];return w&&!T?p[b]=void 0:p[b]=(T||"").replace(/%2F/g,"/"),p},{}),pathname:o,pathnameBase:c,pattern:t}}function Qse(t,r,s){r===void 0&&(r=!1),s===void 0&&(s=!0),OU(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,i,f)=>(n.push({paramName:i,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,r?void 0:"i"),n]}function Jse(t){try{return t.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return OU(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+r+").")),t}}function hy(t,r){if(r==="/")return t;if(!t.toLowerCase().startsWith(r.toLowerCase()))return null;let s=r.endsWith("/")?r.length-1:r.length,n=t.charAt(s);return n&&n!=="/"?null:t.slice(s)||"/"}function ene(t,r){r===void 0&&(r="/");let{pathname:s,search:n="",hash:a=""}=typeof t=="string"?iv(t):t;return{pathname:s?s.startsWith("/")?s:tne(s,r):r,search:nne(n),hash:ane(a)}}function tne(t,r){let s=r.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?s.length>1&&s.pop():a!=="."&&s.push(a)}),s.length>1?s.join("/"):"/"}function NA(t,r,s,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+r+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function rne(t){return t.filter((r,s)=>s===0||r.route.path&&r.route.path.length>0)}function hI(t,r){let s=rne(t);return r?s.map((n,a)=>a===s.length-1?n.pathname:n.pathnameBase):s.map(n=>n.pathnameBase)}function mI(t,r,s,n){n===void 0&&(n=!1);let a;typeof t=="string"?a=iv(t):(a=gb({},t),ha(!a.pathname||!a.pathname.includes("?"),NA("?","pathname","search",a)),ha(!a.pathname||!a.pathname.includes("#"),NA("#","pathname","hash",a)),ha(!a.search||!a.search.includes("#"),NA("#","search","hash",a)));let o=t===""||a.pathname==="",c=o?"/":a.pathname,i;if(c==null)i=s;else{let y=r.length-1;if(!n&&c.startsWith("..")){let b=c.split("/");for(;b[0]==="..";)b.shift(),y-=1;a.pathname=b.join("/")}i=y>=0?r[y]:"/"}let f=ene(a,i),p=c&&c!=="/"&&c.endsWith("/"),g=(o||c===".")&&s.endsWith("/");return!f.pathname.endsWith("/")&&(p||g)&&(f.pathname+="/"),f}const fm=t=>t.join("/").replace(/\/\/+/g,"/"),sne=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),nne=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,ane=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function ine(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const RU=["post","put","patch","delete"];new Set(RU);const one=["get",...RU];new Set(one);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yb(){return yb=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},yb.apply(this,arguments)}const fC=A.createContext(null),LU=A.createContext(null),Hu=A.createContext(null),pC=A.createContext(null),Id=A.createContext({outlet:null,matches:[],isDataRoute:!1}),FU=A.createContext(null);function lne(t,r){let{relative:s}=r===void 0?{}:r;ov()||ha(!1);let{basename:n,navigator:a}=A.useContext(Hu),{hash:o,pathname:c,search:i}=gC(t,{relative:s}),f=c;return n!=="/"&&(f=c==="/"?n:fm([n,c])),a.createHref({pathname:f,search:i,hash:o})}function ov(){return A.useContext(pC)!=null}function Lp(){return ov()||ha(!1),A.useContext(pC).location}function $U(t){A.useContext(Hu).static||A.useLayoutEffect(t)}function Fp(){let{isDataRoute:t}=A.useContext(Id);return t?wne():cne()}function cne(){ov()||ha(!1);let t=A.useContext(fC),{basename:r,future:s,navigator:n}=A.useContext(Hu),{matches:a}=A.useContext(Id),{pathname:o}=Lp(),c=JSON.stringify(hI(a,s.v7_relativeSplatPath)),i=A.useRef(!1);return $U(()=>{i.current=!0}),A.useCallback(function(p,g){if(g===void 0&&(g={}),!i.current)return;if(typeof p=="number"){n.go(p);return}let y=mI(p,JSON.parse(c),o,g.relative==="path");t==null&&r!=="/"&&(y.pathname=y.pathname==="/"?r:fm([r,y.pathname])),(g.replace?n.replace:n.push)(y,g.state,g)},[r,n,c,o,t])}const dne=A.createContext(null);function une(t){let r=A.useContext(Id).outlet;return r&&A.createElement(dne.Provider,{value:t},r)}function xC(){let{matches:t}=A.useContext(Id),r=t[t.length-1];return r?r.params:{}}function gC(t,r){let{relative:s}=r===void 0?{}:r,{future:n}=A.useContext(Hu),{matches:a}=A.useContext(Id),{pathname:o}=Lp(),c=JSON.stringify(hI(a,n.v7_relativeSplatPath));return A.useMemo(()=>mI(t,JSON.parse(c),o,s==="path"),[t,c,o,s])}function hne(t,r){return mne(t,r)}function mne(t,r,s,n){ov()||ha(!1);let{navigator:a,static:o}=A.useContext(Hu),{matches:c}=A.useContext(Id),i=c[c.length-1],f=i?i.params:{};i&&i.pathname;let p=i?i.pathnameBase:"/";i&&i.route;let g=Lp(),y;if(r){var b;let O=typeof r=="string"?iv(r):r;p==="/"||(b=O.pathname)!=null&&b.startsWith(p)||ha(!1),y=O}else y=g;let w=y.pathname||"/",T=w;if(p!=="/"){let O=p.replace(/^\//,"").split("/");T="/"+w.replace(/^\//,"").split("/").slice(O.length).join("/")}let N=zse(t,{pathname:T}),M=yne(N&&N.map(O=>Object.assign({},O,{params:Object.assign({},f,O.params),pathname:fm([p,a.encodeLocation?a.encodeLocation(O.pathname).pathname:O.pathname]),pathnameBase:O.pathnameBase==="/"?p:fm([p,a.encodeLocation?a.encodeLocation(O.pathnameBase).pathname:O.pathnameBase])})),c,s,n);return r&&M?A.createElement(pC.Provider,{value:{location:yb({pathname:"/",search:"",hash:"",state:null,key:"default"},y),navigationType:rm.Pop}},M):M}function fne(){let t=_ne(),r=ine(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),s=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},r),s?A.createElement("pre",{style:a},s):null,null)}const pne=A.createElement(fne,null);class xne extends A.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,s){return s.location!==r.location||s.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:s.error,location:s.location,revalidation:r.revalidation||s.revalidation}}componentDidCatch(r,s){console.error("React Router caught the following error during render",r,s)}render(){return this.state.error!==void 0?A.createElement(Id.Provider,{value:this.props.routeContext},A.createElement(FU.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function gne(t){let{routeContext:r,match:s,children:n}=t,a=A.useContext(fC);return a&&a.static&&a.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=s.route.id),A.createElement(Id.Provider,{value:r},n)}function yne(t,r,s,n){var a;if(r===void 0&&(r=[]),s===void 0&&(s=null),n===void 0&&(n=null),t==null){var o;if(!s)return null;if(s.errors)t=s.matches;else if((o=n)!=null&&o.v7_partialHydration&&r.length===0&&!s.initialized&&s.matches.length>0)t=s.matches;else return null}let c=t,i=(a=s)==null?void 0:a.errors;if(i!=null){let g=c.findIndex(y=>y.route.id&&(i==null?void 0:i[y.route.id])!==void 0);g>=0||ha(!1),c=c.slice(0,Math.min(c.length,g+1))}let f=!1,p=-1;if(s&&n&&n.v7_partialHydration)for(let g=0;g<c.length;g++){let y=c[g];if((y.route.HydrateFallback||y.route.hydrateFallbackElement)&&(p=g),y.route.id){let{loaderData:b,errors:w}=s,T=y.route.loader&&b[y.route.id]===void 0&&(!w||w[y.route.id]===void 0);if(y.route.lazy||T){f=!0,p>=0?c=c.slice(0,p+1):c=[c[0]];break}}}return c.reduceRight((g,y,b)=>{let w,T=!1,N=null,M=null;s&&(w=i&&y.route.id?i[y.route.id]:void 0,N=y.route.errorElement||pne,f&&(p<0&&b===0?(Nne("route-fallback"),T=!0,M=null):p===b&&(T=!0,M=y.route.hydrateFallbackElement||null)));let O=r.concat(c.slice(0,b+1)),C=()=>{let D;return w?D=N:T?D=M:y.route.Component?D=A.createElement(y.route.Component,null):y.route.element?D=y.route.element:D=g,A.createElement(gne,{match:y,routeContext:{outlet:g,matches:O,isDataRoute:s!=null},children:D})};return s&&(y.route.ErrorBoundary||y.route.errorElement||b===0)?A.createElement(xne,{location:s.location,revalidation:s.revalidation,component:N,error:w,children:C(),routeContext:{outlet:null,matches:O,isDataRoute:!0}}):C()},null)}var zU=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(zU||{}),BU=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(BU||{});function vne(t){let r=A.useContext(fC);return r||ha(!1),r}function jne(t){let r=A.useContext(LU);return r||ha(!1),r}function bne(t){let r=A.useContext(Id);return r||ha(!1),r}function qU(t){let r=bne(),s=r.matches[r.matches.length-1];return s.route.id||ha(!1),s.route.id}function _ne(){var t;let r=A.useContext(FU),s=jne(),n=qU();return r!==void 0?r:(t=s.errors)==null?void 0:t[n]}function wne(){let{router:t}=vne(zU.UseNavigateStable),r=qU(BU.UseNavigateStable),s=A.useRef(!1);return $U(()=>{s.current=!0}),A.useCallback(function(a,o){o===void 0&&(o={}),s.current&&(typeof a=="number"?t.navigate(a):t.navigate(a,yb({fromRouteId:r},o)))},[t,r])}const TF={};function Nne(t,r,s){TF[t]||(TF[t]=!0)}function Sne(t,r){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function qa(t){let{to:r,replace:s,state:n,relative:a}=t;ov()||ha(!1);let{future:o,static:c}=A.useContext(Hu),{matches:i}=A.useContext(Id),{pathname:f}=Lp(),p=Fp(),g=mI(r,hI(i,o.v7_relativeSplatPath),f,a==="path"),y=JSON.stringify(g);return A.useEffect(()=>p(JSON.parse(y),{replace:s,state:n,relative:a}),[p,y,a,s,n]),null}function Ai(t){return une(t.context)}function tt(t){ha(!1)}function Cne(t){let{basename:r="/",children:s=null,location:n,navigationType:a=rm.Pop,navigator:o,static:c=!1,future:i}=t;ov()&&ha(!1);let f=r.replace(/^\/*/,"/"),p=A.useMemo(()=>({basename:f,navigator:o,static:c,future:yb({v7_relativeSplatPath:!1},i)}),[f,i,o,c]);typeof n=="string"&&(n=iv(n));let{pathname:g="/",search:y="",hash:b="",state:w=null,key:T="default"}=n,N=A.useMemo(()=>{let M=hy(g,f);return M==null?null:{location:{pathname:M,search:y,hash:b,state:w,key:T},navigationType:a}},[f,g,y,b,w,T,a]);return N==null?null:A.createElement(Hu.Provider,{value:p},A.createElement(pC.Provider,{children:s,value:N}))}function Pne(t){let{children:r,location:s}=t;return hne(WE(r),s)}new Promise(()=>{});function WE(t,r){r===void 0&&(r=[]);let s=[];return A.Children.forEach(t,(n,a)=>{if(!A.isValidElement(n))return;let o=[...r,a];if(n.type===A.Fragment){s.push.apply(s,WE(n.props.children,o));return}n.type!==tt&&ha(!1),!n.props.index||!n.props.children||ha(!1);let c={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(c.children=WE(n.props.children,o)),s.push(c)}),s}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yS(){return yS=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},yS.apply(this,arguments)}function VU(t,r){if(t==null)return{};var s={},n=Object.keys(t),a,o;for(o=0;o<n.length;o++)a=n[o],!(r.indexOf(a)>=0)&&(s[a]=t[a]);return s}function kne(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Ane(t,r){return t.button===0&&(!r||r==="_self")&&!kne(t)}const Tne=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ene=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Mne="6";try{window.__reactRouterVersion=Mne}catch{}const One=A.createContext({isTransitioning:!1}),Ine="startTransition",EF=pq[Ine];function Dne(t){let{basename:r,children:s,future:n,window:a}=t,o=A.useRef();o.current==null&&(o.current=Lse({window:a,v5Compat:!0}));let c=o.current,[i,f]=A.useState({action:c.action,location:c.location}),{v7_startTransition:p}=n||{},g=A.useCallback(y=>{p&&EF?EF(()=>f(y)):f(y)},[f,p]);return A.useLayoutEffect(()=>c.listen(g),[c,g]),A.useEffect(()=>Sne(n),[n]),A.createElement(Cne,{basename:r,children:s,location:i.location,navigationType:i.action,navigator:c,future:n})}const Rne=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Lne=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Pn=A.forwardRef(function(r,s){let{onClick:n,relative:a,reloadDocument:o,replace:c,state:i,target:f,to:p,preventScrollReset:g,viewTransition:y}=r,b=VU(r,Tne),{basename:w}=A.useContext(Hu),T,N=!1;if(typeof p=="string"&&Lne.test(p)&&(T=p,Rne))try{let D=new URL(window.location.href),L=p.startsWith("//")?new URL(D.protocol+p):new URL(p),F=hy(L.pathname,w);L.origin===D.origin&&F!=null?p=F+L.search+L.hash:N=!0}catch{}let M=lne(p,{relative:a}),O=$ne(p,{replace:c,state:i,target:f,preventScrollReset:g,relative:a,viewTransition:y});function C(D){n&&n(D),D.defaultPrevented||O(D)}return A.createElement("a",yS({},b,{href:T||M,onClick:N||o?n:C,ref:s,target:f}))}),SA=A.forwardRef(function(r,s){let{"aria-current":n="page",caseSensitive:a=!1,className:o="",end:c=!1,style:i,to:f,viewTransition:p,children:g}=r,y=VU(r,Ene),b=gC(f,{relative:y.relative}),w=Lp(),T=A.useContext(LU),{navigator:N,basename:M}=A.useContext(Hu),O=T!=null&&zne(b)&&p===!0,C=N.encodeLocation?N.encodeLocation(b).pathname:b.pathname,D=w.pathname,L=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;a||(D=D.toLowerCase(),L=L?L.toLowerCase():null,C=C.toLowerCase()),L&&M&&(L=hy(L,M)||L);const F=C!=="/"&&C.endsWith("/")?C.length-1:C.length;let B=D===C||!c&&D.startsWith(C)&&D.charAt(F)==="/",U=L!=null&&(L===C||!c&&L.startsWith(C)&&L.charAt(C.length)==="/"),te={isActive:B,isPending:U,isTransitioning:O},Q=B?n:void 0,re;typeof o=="function"?re=o(te):re=[o,B?"active":null,U?"pending":null,O?"transitioning":null].filter(Boolean).join(" ");let Z=typeof i=="function"?i(te):i;return A.createElement(Pn,yS({},y,{"aria-current":Q,className:re,ref:s,style:Z,to:f,viewTransition:p}),typeof g=="function"?g(te):g)});var GE;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(GE||(GE={}));var MF;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(MF||(MF={}));function Fne(t){let r=A.useContext(fC);return r||ha(!1),r}function $ne(t,r){let{target:s,replace:n,state:a,preventScrollReset:o,relative:c,viewTransition:i}=r===void 0?{}:r,f=Fp(),p=Lp(),g=gC(t,{relative:c});return A.useCallback(y=>{if(Ane(y,s)){y.preventDefault();let b=n!==void 0?n:gS(p)===gS(g);f(t,{replace:b,state:a,preventScrollReset:o,relative:c,viewTransition:i})}},[p,f,g,n,a,s,t,o,c,i])}function zne(t,r){r===void 0&&(r={});let s=A.useContext(One);s==null&&ha(!1);let{basename:n}=Fne(GE.useViewTransitionState),a=gC(t,{relative:r.relative});if(!s.isTransitioning)return!1;let o=hy(s.currentLocation.pathname,n)||s.currentLocation.pathname,c=hy(s.nextLocation.pathname,n)||s.nextLocation.pathname;return UE(a.pathname,c)!=null||UE(a.pathname,o)!=null}async function Bne(t){if(!t.ok){const r=await t.text()||t.statusText;throw new Error(`${t.status}: ${r}`)}}const qne=({on401:t})=>async({queryKey:r})=>{const s=await fetch(r[0],{credentials:"include"});return await Bne(s),await s.json()},Vne=new jse({defaultOptions:{queries:{queryFn:qne({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),Une="/api/v1";class Wne{constructor(r=Une){this.baseUrl=r}async request(r,s){const n=`${this.baseUrl}${r}`,a=localStorage.getItem("auth_token");r.includes("/auth/")||console.log(`[API] ${r} - Token: ${a?"present ("+a.substring(0,20)+"...)":"MISSING"}`);const o={"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",...a?{Authorization:`Bearer ${a}`}:{},...s==null?void 0:s.headers},c=await fetch(n,{...s,headers:o,credentials:"include"});if(!c.ok){const i=await c.json().catch(()=>({message:c.statusText}));throw new Error(i.message||"API request failed")}return c.json()}async get(r,s){const n=s?"?"+new URLSearchParams(s).toString():"";return this.request(`${r}${n}`)}async post(r,s){return this.request(r,{method:"POST",body:JSON.stringify(s)})}async put(r,s){return this.request(r,{method:"PUT",body:JSON.stringify(s)})}async patch(r,s){return this.request(r,{method:"PATCH",body:JSON.stringify(s)})}async delete(r){return this.request(r,{method:"DELETE"})}}const pe=new Wne,UU=A.createContext(void 0);function Gne({children:t}){const[r,s]=A.useState(null),[n,a]=A.useState(null),[o,c]=A.useState(!0),[i,f]=A.useState(!1),[p,g]=A.useState([]),[y,b]=A.useState(!1),w=async()=>{var L,F,B;const D=localStorage.getItem("auth_token");if(console.log("[Auth] refreshUser - token exists:",!!D),!D){console.log("[Auth] No token, skipping refresh"),s(null),a(null),f(!1),g([]),b(!1);return}try{const U=await pe.get("/auth/user");console.log("[Auth] refreshUser success:",{email:(L=U.user)==null?void 0:L.email,tenant:(F=U.tenant)==null?void 0:F.name,is_super_admin:U.is_super_admin,requires_tenant_selection:U.requires_tenant_selection}),s(U.user),a(U.tenant||null),b(U.is_super_admin||!1),U.requires_tenant_selection&&((B=U.accessible_tenants)!=null&&B.length)?(console.log("[Auth] Tenant selection required after refresh"),f(!0),g(U.accessible_tenants)):(f(!1),g([]))}catch(U){console.error("[Auth] refreshUser failed:",U),localStorage.removeItem("auth_token"),s(null),a(null),f(!1),g([]),b(!1)}};A.useEffect(()=>{w().finally(()=>c(!1))},[]);const T=async(D,L)=>{var B,U,te,Q,re;console.log("[Auth] Attempting login for:",D);const F=await pe.post("/auth/login",{email:D,password:L});return console.log("[Auth] Login response:",{hasToken:!!F.token,tokenPreview:F.token?F.token.substring(0,20)+"...":"NO TOKEN",user:(B=F.user)==null?void 0:B.email,roles:((U=F.user)==null?void 0:U.role_names)||((te=F.user)==null?void 0:te.roles),requires_tenant_selection:F.requires_tenant_selection,is_super_admin:F.is_super_admin,accessible_tenants_count:(Q=F.accessible_tenants)==null?void 0:Q.length}),F.token?(localStorage.setItem("auth_token",F.token),console.log("[Auth] Token stored in localStorage")):console.error("[Auth] NO TOKEN in response!"),s(F.user),b(F.is_super_admin||!1),F.requires_tenant_selection&&((re=F.accessible_tenants)!=null&&re.length)?(console.log("[Auth] Tenant selection required for super admin"),f(!0),g(F.accessible_tenants)):F.current_tenant&&(a(F.current_tenant),f(!1)),F},N=async D=>{var L;console.log("[Auth] Selecting tenant:",D);try{const F=await pe.post("/auth/select-tenant",{tenant_id:D});console.log("[Auth] Tenant selected:",(L=F.tenant)==null?void 0:L.name),a(F.tenant),s(F.user),f(!1),g([])}catch(F){throw console.error("[Auth] Tenant selection failed:",F),F}},M=async()=>{try{await pe.post("/auth/logout")}catch(D){console.error("Logout error:",D)}finally{localStorage.removeItem("auth_token"),s(null),a(null),f(!1),g([]),b(!1)}},O=D=>{if(!r)return!1;if(r.permission_names&&r.permission_names.length>0)return r.permission_names.includes("*")||r.permission_names.includes(D);if(r.permissions){const L=r.permissions.map(F=>typeof F=="string"?F:F.name);return L.includes("*")||L.includes(D)}return!1},C=D=>{if(!r)return!1;if(r.role_names&&r.role_names.length>0)return r.role_names.includes("Super Admin")?!0:r.role_names.includes("*")||r.role_names.includes(D);if(r.roles){const L=r.roles.map(F=>typeof F=="string"?F:F.name);return L.includes("Super Admin")?!0:L.includes("*")||L.includes(D)}return!1};return e.jsx(UU.Provider,{value:{user:r,tenant:n,setUser:s,isAuthenticated:!!r,isLoading:o,login:T,selectTenant:N,logout:M,refreshUser:w,hasPermission:O,hasRole:C,pendingTenantSelection:i,accessibleTenants:p,isSuperAdmin:y},children:t})}function Lm(){const t=A.useContext(UU);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}function ct({children:t,requiredPermission:r,requiredRole:s}){const{isAuthenticated:n,isLoading:a}=Lm();return a?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})}):n?e.jsx(e.Fragment,{children:t}):e.jsx(qa,{to:"/login",replace:!0})}function Kne(t,r){typeof t=="function"?t(r):t!=null&&(t.current=r)}function yC(...t){return r=>t.forEach(s=>Kne(s,r))}function ls(...t){return A.useCallback(yC(...t),t)}var Ad=A.forwardRef((t,r)=>{const{children:s,...n}=t,a=A.Children.toArray(s),o=a.find(Hne);if(o){const c=o.props.children,i=a.map(f=>f===o?A.Children.count(c)>1?A.Children.only(null):A.isValidElement(c)?c.props.children:null:f);return e.jsx(KE,{...n,ref:r,children:A.isValidElement(c)?A.cloneElement(c,void 0,i):null})}return e.jsx(KE,{...n,ref:r,children:s})});Ad.displayName="Slot";var KE=A.forwardRef((t,r)=>{const{children:s,...n}=t;if(A.isValidElement(s)){const a=Yne(s);return A.cloneElement(s,{...Zne(n,s.props),ref:r?yC(r,a):a})}return A.Children.count(s)>1?A.Children.only(null):null});KE.displayName="SlotClone";var WU=({children:t})=>e.jsx(e.Fragment,{children:t});function Hne(t){return A.isValidElement(t)&&t.type===WU}function Zne(t,r){const s={...r};for(const n in r){const a=t[n],o=r[n];/^on[A-Z]/.test(n)?a&&o?s[n]=(...i)=>{o(...i),a(...i)}:a&&(s[n]=a):n==="style"?s[n]={...a,...o}:n==="className"&&(s[n]=[a,o].filter(Boolean).join(" "))}return{...t,...s}}function Yne(t){var n,a;let r=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,s=r&&"isReactWarning"in r&&r.isReactWarning;return s?t.ref:(r=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,s=r&&"isReactWarning"in r&&r.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}function GU(t){var r,s,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t))for(r=0;r<t.length;r++)t[r]&&(s=GU(t[r]))&&(n&&(n+=" "),n+=s);else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function Xne(){for(var t,r,s=0,n="";s<arguments.length;)(t=arguments[s++])&&(r=GU(t))&&(n&&(n+=" "),n+=r);return n}const OF=t=>typeof t=="boolean"?"".concat(t):t===0?"0":t,IF=Xne,C_=(t,r)=>s=>{var n;if((r==null?void 0:r.variants)==null)return IF(t,s==null?void 0:s.class,s==null?void 0:s.className);const{variants:a,defaultVariants:o}=r,c=Object.keys(a).map(p=>{const g=s==null?void 0:s[p],y=o==null?void 0:o[p];if(g===null)return null;const b=OF(g)||OF(y);return a[p][b]}),i=s&&Object.entries(s).reduce((p,g)=>{let[y,b]=g;return b===void 0||(p[y]=b),p},{}),f=r==null||(n=r.compoundVariants)===null||n===void 0?void 0:n.reduce((p,g)=>{let{class:y,className:b,...w}=g;return Object.entries(w).every(T=>{let[N,M]=T;return Array.isArray(M)?M.includes({...o,...i}[N]):{...o,...i}[N]===M})?[...p,y,b]:p},[]);return IF(t,c,f,s==null?void 0:s.class,s==null?void 0:s.className)};function KU(t){var r,s,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(r=0;r<a;r++)t[r]&&(s=KU(t[r]))&&(n&&(n+=" "),n+=s)}else for(s in t)t[s]&&(n&&(n+=" "),n+=s);return n}function rs(){for(var t,r,s=0,n="",a=arguments.length;s<a;s++)(t=arguments[s])&&(r=KU(t))&&(n&&(n+=" "),n+=r);return n}const fI="-",Qne=t=>{const r=eae(t),{conflictingClassGroups:s,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:c=>{const i=c.split(fI);return i[0]===""&&i.length!==1&&i.shift(),HU(i,r)||Jne(c)},getConflictingClassGroupIds:(c,i)=>{const f=s[c]||[];return i&&n[c]?[...f,...n[c]]:f}}},HU=(t,r)=>{var c;if(t.length===0)return r.classGroupId;const s=t[0],n=r.nextPart.get(s),a=n?HU(t.slice(1),n):void 0;if(a)return a;if(r.validators.length===0)return;const o=t.join(fI);return(c=r.validators.find(({validator:i})=>i(o)))==null?void 0:c.classGroupId},DF=/^\[(.+)\]$/,Jne=t=>{if(DF.test(t)){const r=DF.exec(t)[1],s=r==null?void 0:r.substring(0,r.indexOf(":"));if(s)return"arbitrary.."+s}},eae=t=>{const{theme:r,prefix:s}=t,n={nextPart:new Map,validators:[]};return rae(Object.entries(t.classGroups),s).forEach(([o,c])=>{HE(c,n,o,r)}),n},HE=(t,r,s,n)=>{t.forEach(a=>{if(typeof a=="string"){const o=a===""?r:RF(r,a);o.classGroupId=s;return}if(typeof a=="function"){if(tae(a)){HE(a(n),r,s,n);return}r.validators.push({validator:a,classGroupId:s});return}Object.entries(a).forEach(([o,c])=>{HE(c,RF(r,o),s,n)})})},RF=(t,r)=>{let s=t;return r.split(fI).forEach(n=>{s.nextPart.has(n)||s.nextPart.set(n,{nextPart:new Map,validators:[]}),s=s.nextPart.get(n)}),s},tae=t=>t.isThemeGetter,rae=(t,r)=>r?t.map(([s,n])=>{const a=n.map(o=>typeof o=="string"?r+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([c,i])=>[r+c,i])):o);return[s,a]}):t,sae=t=>{if(t<1)return{get:()=>{},set:()=>{}};let r=0,s=new Map,n=new Map;const a=(o,c)=>{s.set(o,c),r++,r>t&&(r=0,n=s,s=new Map)};return{get(o){let c=s.get(o);if(c!==void 0)return c;if((c=n.get(o))!==void 0)return a(o,c),c},set(o,c){s.has(o)?s.set(o,c):a(o,c)}}},ZU="!",nae=t=>{const{separator:r,experimentalParseClassName:s}=t,n=r.length===1,a=r[0],o=r.length,c=i=>{const f=[];let p=0,g=0,y;for(let M=0;M<i.length;M++){let O=i[M];if(p===0){if(O===a&&(n||i.slice(M,M+o)===r)){f.push(i.slice(g,M)),g=M+o;continue}if(O==="/"){y=M;continue}}O==="["?p++:O==="]"&&p--}const b=f.length===0?i:i.substring(g),w=b.startsWith(ZU),T=w?b.substring(1):b,N=y&&y>g?y-g:void 0;return{modifiers:f,hasImportantModifier:w,baseClassName:T,maybePostfixModifierPosition:N}};return s?i=>s({className:i,parseClassName:c}):c},aae=t=>{if(t.length<=1)return t;const r=[];let s=[];return t.forEach(n=>{n[0]==="["?(r.push(...s.sort(),n),s=[]):s.push(n)}),r.push(...s.sort()),r},iae=t=>({cache:sae(t.cacheSize),parseClassName:nae(t),...Qne(t)}),oae=/\s+/,lae=(t,r)=>{const{parseClassName:s,getClassGroupId:n,getConflictingClassGroupIds:a}=r,o=[],c=t.trim().split(oae);let i="";for(let f=c.length-1;f>=0;f-=1){const p=c[f],{modifiers:g,hasImportantModifier:y,baseClassName:b,maybePostfixModifierPosition:w}=s(p);let T=!!w,N=n(T?b.substring(0,w):b);if(!N){if(!T){i=p+(i.length>0?" "+i:i);continue}if(N=n(b),!N){i=p+(i.length>0?" "+i:i);continue}T=!1}const M=aae(g).join(":"),O=y?M+ZU:M,C=O+N;if(o.includes(C))continue;o.push(C);const D=a(N,T);for(let L=0;L<D.length;++L){const F=D[L];o.push(O+F)}i=p+(i.length>0?" "+i:i)}return i};function cae(){let t=0,r,s,n="";for(;t<arguments.length;)(r=arguments[t++])&&(s=YU(r))&&(n&&(n+=" "),n+=s);return n}const YU=t=>{if(typeof t=="string")return t;let r,s="";for(let n=0;n<t.length;n++)t[n]&&(r=YU(t[n]))&&(s&&(s+=" "),s+=r);return s};function dae(t,...r){let s,n,a,o=c;function c(f){const p=r.reduce((g,y)=>y(g),t());return s=iae(p),n=s.cache.get,a=s.cache.set,o=i,i(f)}function i(f){const p=n(f);if(p)return p;const g=lae(f,s);return a(f,g),g}return function(){return o(cae.apply(null,arguments))}}const qn=t=>{const r=s=>s[t]||[];return r.isThemeGetter=!0,r},XU=/^\[(?:([a-z-]+):)?(.+)\]$/i,uae=/^\d+\/\d+$/,hae=new Set(["px","full","screen"]),mae=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,fae=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,pae=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,xae=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,gae=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,fu=t=>Fg(t)||hae.has(t)||uae.test(t),Ah=t=>lv(t,"length",Sae),Fg=t=>!!t&&!Number.isNaN(Number(t)),CA=t=>lv(t,"number",Fg),n0=t=>!!t&&Number.isInteger(Number(t)),yae=t=>t.endsWith("%")&&Fg(t.slice(0,-1)),ys=t=>XU.test(t),Th=t=>mae.test(t),vae=new Set(["length","size","percentage"]),jae=t=>lv(t,vae,QU),bae=t=>lv(t,"position",QU),_ae=new Set(["image","url"]),wae=t=>lv(t,_ae,Pae),Nae=t=>lv(t,"",Cae),a0=()=>!0,lv=(t,r,s)=>{const n=XU.exec(t);return n?n[1]?typeof r=="string"?n[1]===r:r.has(n[1]):s(n[2]):!1},Sae=t=>fae.test(t)&&!pae.test(t),QU=()=>!1,Cae=t=>xae.test(t),Pae=t=>gae.test(t),kae=()=>{const t=qn("colors"),r=qn("spacing"),s=qn("blur"),n=qn("brightness"),a=qn("borderColor"),o=qn("borderRadius"),c=qn("borderSpacing"),i=qn("borderWidth"),f=qn("contrast"),p=qn("grayscale"),g=qn("hueRotate"),y=qn("invert"),b=qn("gap"),w=qn("gradientColorStops"),T=qn("gradientColorStopPositions"),N=qn("inset"),M=qn("margin"),O=qn("opacity"),C=qn("padding"),D=qn("saturate"),L=qn("scale"),F=qn("sepia"),B=qn("skew"),U=qn("space"),te=qn("translate"),Q=()=>["auto","contain","none"],re=()=>["auto","hidden","clip","visible","scroll"],Z=()=>["auto",ys,r],ne=()=>[ys,r],oe=()=>["",fu,Ah],Ce=()=>["auto",Fg,ys],Pe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Se=()=>["solid","dashed","dotted","double","none"],ae=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],be=()=>["start","end","center","between","around","evenly","stretch"],de=()=>["","0",ys],Ke=()=>["auto","avoid","all","avoid-page","page","left","right","column"],He=()=>[Fg,ys];return{cacheSize:500,separator:":",theme:{colors:[a0],spacing:[fu,Ah],blur:["none","",Th,ys],brightness:He(),borderColor:[t],borderRadius:["none","","full",Th,ys],borderSpacing:ne(),borderWidth:oe(),contrast:He(),grayscale:de(),hueRotate:He(),invert:de(),gap:ne(),gradientColorStops:[t],gradientColorStopPositions:[yae,Ah],inset:Z(),margin:Z(),opacity:He(),padding:ne(),saturate:He(),scale:He(),sepia:de(),skew:He(),space:ne(),translate:ne()},classGroups:{aspect:[{aspect:["auto","square","video",ys]}],container:["container"],columns:[{columns:[Th]}],"break-after":[{"break-after":Ke()}],"break-before":[{"break-before":Ke()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Pe(),ys]}],overflow:[{overflow:re()}],"overflow-x":[{"overflow-x":re()}],"overflow-y":[{"overflow-y":re()}],overscroll:[{overscroll:Q()}],"overscroll-x":[{"overscroll-x":Q()}],"overscroll-y":[{"overscroll-y":Q()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[N]}],"inset-x":[{"inset-x":[N]}],"inset-y":[{"inset-y":[N]}],start:[{start:[N]}],end:[{end:[N]}],top:[{top:[N]}],right:[{right:[N]}],bottom:[{bottom:[N]}],left:[{left:[N]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",n0,ys]}],basis:[{basis:Z()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ys]}],grow:[{grow:de()}],shrink:[{shrink:de()}],order:[{order:["first","last","none",n0,ys]}],"grid-cols":[{"grid-cols":[a0]}],"col-start-end":[{col:["auto",{span:["full",n0,ys]},ys]}],"col-start":[{"col-start":Ce()}],"col-end":[{"col-end":Ce()}],"grid-rows":[{"grid-rows":[a0]}],"row-start-end":[{row:["auto",{span:[n0,ys]},ys]}],"row-start":[{"row-start":Ce()}],"row-end":[{"row-end":Ce()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ys]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ys]}],gap:[{gap:[b]}],"gap-x":[{"gap-x":[b]}],"gap-y":[{"gap-y":[b]}],"justify-content":[{justify:["normal",...be()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...be(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...be(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[C]}],px:[{px:[C]}],py:[{py:[C]}],ps:[{ps:[C]}],pe:[{pe:[C]}],pt:[{pt:[C]}],pr:[{pr:[C]}],pb:[{pb:[C]}],pl:[{pl:[C]}],m:[{m:[M]}],mx:[{mx:[M]}],my:[{my:[M]}],ms:[{ms:[M]}],me:[{me:[M]}],mt:[{mt:[M]}],mr:[{mr:[M]}],mb:[{mb:[M]}],ml:[{ml:[M]}],"space-x":[{"space-x":[U]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[U]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ys,r]}],"min-w":[{"min-w":[ys,r,"min","max","fit"]}],"max-w":[{"max-w":[ys,r,"none","full","min","max","fit","prose",{screen:[Th]},Th]}],h:[{h:[ys,r,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ys,r,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ys,r,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ys,r,"auto","min","max","fit"]}],"font-size":[{text:["base",Th,Ah]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",CA]}],"font-family":[{font:[a0]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ys]}],"line-clamp":[{"line-clamp":["none",Fg,CA]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",fu,ys]}],"list-image":[{"list-image":["none",ys]}],"list-style-type":[{list:["none","disc","decimal",ys]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[O]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[O]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Se(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",fu,Ah]}],"underline-offset":[{"underline-offset":["auto",fu,ys]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ne()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ys]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ys]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[O]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Pe(),bae]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",jae]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},wae]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[T]}],"gradient-via-pos":[{via:[T]}],"gradient-to-pos":[{to:[T]}],"gradient-from":[{from:[w]}],"gradient-via":[{via:[w]}],"gradient-to":[{to:[w]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[i]}],"border-w-x":[{"border-x":[i]}],"border-w-y":[{"border-y":[i]}],"border-w-s":[{"border-s":[i]}],"border-w-e":[{"border-e":[i]}],"border-w-t":[{"border-t":[i]}],"border-w-r":[{"border-r":[i]}],"border-w-b":[{"border-b":[i]}],"border-w-l":[{"border-l":[i]}],"border-opacity":[{"border-opacity":[O]}],"border-style":[{border:[...Se(),"hidden"]}],"divide-x":[{"divide-x":[i]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[i]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[O]}],"divide-style":[{divide:Se()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...Se()]}],"outline-offset":[{"outline-offset":[fu,ys]}],"outline-w":[{outline:[fu,Ah]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:oe()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[O]}],"ring-offset-w":[{"ring-offset":[fu,Ah]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Th,Nae]}],"shadow-color":[{shadow:[a0]}],opacity:[{opacity:[O]}],"mix-blend":[{"mix-blend":[...ae(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ae()}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[n]}],contrast:[{contrast:[f]}],"drop-shadow":[{"drop-shadow":["","none",Th,ys]}],grayscale:[{grayscale:[p]}],"hue-rotate":[{"hue-rotate":[g]}],invert:[{invert:[y]}],saturate:[{saturate:[D]}],sepia:[{sepia:[F]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[f]}],"backdrop-grayscale":[{"backdrop-grayscale":[p]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[g]}],"backdrop-invert":[{"backdrop-invert":[y]}],"backdrop-opacity":[{"backdrop-opacity":[O]}],"backdrop-saturate":[{"backdrop-saturate":[D]}],"backdrop-sepia":[{"backdrop-sepia":[F]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[c]}],"border-spacing-x":[{"border-spacing-x":[c]}],"border-spacing-y":[{"border-spacing-y":[c]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ys]}],duration:[{duration:He()}],ease:[{ease:["linear","in","out","in-out",ys]}],delay:[{delay:He()}],animate:[{animate:["none","spin","ping","pulse","bounce",ys]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[L]}],"scale-x":[{"scale-x":[L]}],"scale-y":[{"scale-y":[L]}],rotate:[{rotate:[n0,ys]}],"translate-x":[{"translate-x":[te]}],"translate-y":[{"translate-y":[te]}],"skew-x":[{"skew-x":[B]}],"skew-y":[{"skew-y":[B]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ys]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ys]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ne()}],"scroll-mx":[{"scroll-mx":ne()}],"scroll-my":[{"scroll-my":ne()}],"scroll-ms":[{"scroll-ms":ne()}],"scroll-me":[{"scroll-me":ne()}],"scroll-mt":[{"scroll-mt":ne()}],"scroll-mr":[{"scroll-mr":ne()}],"scroll-mb":[{"scroll-mb":ne()}],"scroll-ml":[{"scroll-ml":ne()}],"scroll-p":[{"scroll-p":ne()}],"scroll-px":[{"scroll-px":ne()}],"scroll-py":[{"scroll-py":ne()}],"scroll-ps":[{"scroll-ps":ne()}],"scroll-pe":[{"scroll-pe":ne()}],"scroll-pt":[{"scroll-pt":ne()}],"scroll-pr":[{"scroll-pr":ne()}],"scroll-pb":[{"scroll-pb":ne()}],"scroll-pl":[{"scroll-pl":ne()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ys]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[fu,Ah,CA]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Aae=dae(kae);function dr(...t){return Aae(rs(t))}const pI=C_("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),K=A.forwardRef(({className:t,variant:r,size:s,asChild:n=!1,...a},o)=>{const c=n?Ad:"button";return e.jsx(c,{className:dr(pI({variant:r,size:s,className:t})),ref:o,...a})});K.displayName="Button";const Ie=A.forwardRef(({className:t,type:r,...s},n)=>e.jsx("input",{type:r,className:dr("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:n,...s}));Ie.displayName="Input";var Tae=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Tr=Tae.reduce((t,r)=>{const s=A.forwardRef((n,a)=>{const{asChild:o,...c}=n,i=o?Ad:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(i,{...c,ref:a})});return s.displayName=`Primitive.${r}`,{...t,[r]:s}},{});function JU(t,r){t&&Rm.flushSync(()=>t.dispatchEvent(r))}var Eae="Label",e9=A.forwardRef((t,r)=>e.jsx(Tr.label,{...t,ref:r,onMouseDown:s=>{var a;s.target.closest("button, input, select, textarea")||((a=t.onMouseDown)==null||a.call(t,s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));e9.displayName=Eae;var t9=e9;const Mae=C_("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),we=A.forwardRef(({className:t,...r},s)=>e.jsx(t9,{ref:s,className:dr(Mae(),t),...r}));we.displayName=t9.displayName;const H=A.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:dr("rounded-xl border bg-card text-card-foreground shadow",t),...r}));H.displayName="Card";const ue=A.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:dr("flex flex-col space-y-1.5 p-6",t),...r}));ue.displayName="CardHeader";const he=A.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:dr("font-semibold leading-none tracking-tight",t),...r}));he.displayName="CardTitle";const mr=A.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:dr("text-sm text-muted-foreground",t),...r}));mr.displayName="CardDescription";const X=A.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:dr("p-6 pt-0",t),...r}));X.displayName="CardContent";const my=A.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:dr("flex items-center p-6 pt-0",t),...r}));my.displayName="CardFooter";const Oae=C_("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),zn=A.forwardRef(({className:t,variant:r,...s},n)=>e.jsx("div",{ref:n,role:"alert",className:dr(Oae({variant:r}),t),...s}));zn.displayName="Alert";const Iae=A.forwardRef(({className:t,...r},s)=>e.jsx("h5",{ref:s,className:dr("mb-1 font-medium leading-none tracking-tight",t),...r}));Iae.displayName="AlertTitle";const An=A.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:dr("text-sm [&_p]:leading-relaxed",t),...r}));An.displayName="AlertDescription";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dae=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),r9=(...t)=>t.filter((r,s,n)=>!!r&&n.indexOf(r)===s).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Rae={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lae=A.forwardRef(({color:t="currentColor",size:r=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:a="",children:o,iconNode:c,...i},f)=>A.createElement("svg",{ref:f,...Rae,width:r,height:r,stroke:t,strokeWidth:n?Number(s)*24/Number(r):s,className:r9("lucide",a),...i},[...c.map(([p,g])=>A.createElement(p,g)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=(t,r)=>{const s=A.forwardRef(({className:n,...a},o)=>A.createElement(Lae,{ref:o,iconNode:r,className:r9(`lucide-${Dae(t)}`,n),...a}));return s.displayName=`${t}`,s};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ni=Tt("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fae=Tt("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vb=Tt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qf=Tt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jb=Tt("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ae=Tt("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bb=Tt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fu=Tt("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zae=Tt("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=Tt("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $p=Tt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZE=Tt("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=Tt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wl=Tt("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bae=Tt("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jS=Tt("ChartNoAxesColumn",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qae=Tt("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kc=Tt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jp=Tt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vC=Tt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $u=Tt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s9=Tt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vae=Tt("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=Tt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uae=Tt("CircleArrowDown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wae=Tt("CircleArrowUp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=Tt("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zl=Tt("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n9=Tt("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LF=Tt("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ec=Tt("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YE=Tt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gae=Tt("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T0=Tt("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=Tt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kae=Tt("CloudRain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XE=Tt("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P_=Tt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hae=Tt("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xI=Tt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bi=Tt("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=Tt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=Tt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fl=Tt("Droplet",[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Si=Tt("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a9=Tt("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i9=Tt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _b=Tt("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mo=Tt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zae=Tt("FileChartColumnIncreasing",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yae=Tt("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xae=Tt("FileCode",[["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qae=Tt("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jae=Tt("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=Tt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eie=Tt("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o9=Tt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l9=Tt("FlaskConical",[["path",{d:"M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2",key:"pzvekw"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M7 16h10",key:"wp8him"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c9=Tt("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FF=Tt("Fuel",[["line",{x1:"3",x2:"15",y1:"22",y2:"22",key:"xegly4"}],["line",{x1:"4",x2:"14",y1:"9",y2:"9",key:"xcnuvu"}],["path",{d:"M14 22V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v18",key:"16j0yd"}],["path",{d:"M14 13h2a2 2 0 0 1 2 2v2a2 2 0 0 0 2 2a2 2 0 0 0 2-2V9.83a2 2 0 0 0-.59-1.42L18 5",key:"7cu91f"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zc=Tt("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tie=Tt("Gavel",[["path",{d:"m14.5 12.5-8 8a2.119 2.119 0 1 1-3-3l8-8",key:"15492f"}],["path",{d:"m16 16 6-6",key:"vzrcl6"}],["path",{d:"m8 8 6-6",key:"18bi4p"}],["path",{d:"m9 7 8 8",key:"5jnvq1"}],["path",{d:"m21 11-8-8",key:"z4y7zo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QE=Tt("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $F=Tt("GitMerge",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fy=Tt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rie=Tt("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sie=Tt("HandHeart",[["path",{d:"M11 14h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 16",key:"1ifwr1"}],["path",{d:"m7 20 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9",key:"17abbs"}],["path",{d:"m2 15 6 6",key:"10dquu"}],["path",{d:"M19.5 8.5c.7-.7 1.5-1.6 1.5-2.7A2.73 2.73 0 0 0 16 4a2.78 2.78 0 0 0-5 1.8c0 1.2.8 2 1.5 2.8L16 12Z",key:"1h3036"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JE=Tt("Handshake",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eM=Tt("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bS=Tt("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tM=Tt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _S=Tt("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cv=Tt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nie=Tt("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aie=Tt("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=Tt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sm=Tt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iie=Tt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fm=Tt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=Tt("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jd=Tt("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ki=Tt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zF=Tt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oie=Tt("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lie=Tt("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zo=Tt("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k_=Tt("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gI=Tt("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _m=Tt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ui=Tt("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=Tt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cie=Tt("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wb=Tt("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rM=Tt("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sM=Tt("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nM=Tt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d9=Tt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yI=Tt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const die=Tt("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vI=Tt("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=Tt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jC=Tt("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=Tt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uie=Tt("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BF=Tt("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=Tt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jI=Tt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nb=Tt("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hie=Tt("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ki=Tt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u9=Tt("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pm=Tt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qF=Tt("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mie=Tt("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fie=Tt("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h9=Tt("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VF=Tt("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=Tt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ci=Tt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=Tt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=Tt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pie=Tt("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const py=Tt("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=Tt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m9=Tt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bC=Tt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=Tt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xie=Tt("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f9=Tt("Webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gie=Tt("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yie=Tt("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vc=Tt("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=Tt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=Tt("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function xy({children:t,title:r,subtitle:s}){return e.jsxs("div",{className:"min-h-screen flex",children:[e.jsxs("div",{className:"hidden lg:flex lg:w-1/2 bg-gradient-to-br from-blue-600 via-blue-700 to-indigo-800 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMC4xIj48cGF0aCBkPSJNMzYgMzRjMC0yIDItNCAyLTRzMiAyIDIgNC0yIDQtMiA0LTItMi0yLTR6Ii8+PC9nPjwvZz48L3N2Zz4=')] opacity-30"}),e.jsxs("div",{className:"relative z-10 flex flex-col justify-center px-12 text-white",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-sm",children:e.jsx(Si,{className:"h-10 w-10"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Rural Water Supply"}),e.jsx("p",{className:"text-blue-200 text-sm",children:"Management Information System"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-4xl font-bold leading-tight",children:["Empowering Communities",e.jsx("br",{}),"with Clean Water Access"]}),e.jsx("p",{className:"text-blue-100 text-lg max-w-md leading-relaxed",children:"Comprehensive water resource management, customer relationship tools, and decision support for sustainable rural water services."})]})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-blue-900/50 to-transparent"})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"w-full max-w-md space-y-8",children:[e.jsx("div",{className:"lg:hidden text-center mb-8",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx("div",{className:"p-2 bg-blue-600 rounded-lg",children:e.jsx(Si,{className:"h-6 w-6 text-white"})}),e.jsx("span",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Rural Water MIS"})]})}),(r||s)&&e.jsxs("div",{className:"text-center",children:[r&&e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:r}),s&&e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:s})]}),t]})})]})}const vie=[{role:"Super Admin",email:"superadmin@rwmis.go.ke",password:"SuperAdmin@2025!",description:"All counties access"},{role:"Turkana Admin",email:"admin@turkana.rwmis.go.ke",password:"CountyAdmin@2025!",description:"Turkana County"},{role:"Wajir Admin",email:"admin@wajir.rwmis.go.ke",password:"CountyAdmin@2025!",description:"Wajir County"},{role:"Marsabit Admin",email:"admin@marsabit.rwmis.go.ke",password:"CountyAdmin@2025!",description:"Marsabit County"},{role:"Mandera Admin",email:"admin@mandera.rwmis.go.ke",password:"CountyAdmin@2025!",description:"Mandera County"},{role:"Garissa Admin",email:"admin@garissa.rwmis.go.ke",password:"CountyAdmin@2025!",description:"Garissa County"},{role:"Operator",email:"operator@rwmis.go.ke",password:"Demo@2025!",description:"Operations & work orders"},{role:"Technician",email:"technician@rwmis.go.ke",password:"Demo@2025!",description:"Field maintenance"},{role:"Meter Reader",email:"meterreader@rwmis.go.ke",password:"Demo@2025!",description:"Meter readings"},{role:"Billing Clerk",email:"billing@rwmis.go.ke",password:"Demo@2025!",description:"Billing & payments"},{role:"Customer Service",email:"customerservice@rwmis.go.ke",password:"Demo@2025!",description:"Customer support"}];function UF(){const[t,r]=A.useState(""),[s,n]=A.useState(""),[a,o]=A.useState(""),[c,i]=A.useState(!1),[f,p]=A.useState(""),[g,y]=A.useState(!1),[b,w]=A.useState(!1),[T,N]=A.useState(!1),[M,O]=A.useState(!1),[C,D]=A.useState([]),[L,F]=A.useState(null),{login:B,selectTenant:U,setUser:te}=Lm(),Q=Fp(),re=oe=>{r(oe.email),n(oe.password),p("")},Z=async oe=>{F(oe),y(!0),p("");try{await U(oe),Q("/")}catch(Ce){p(Ce.message||"Failed to select county. Please try again.")}finally{y(!1)}},ne=async oe=>{var Ce,Pe,Se;oe.preventDefault(),p(""),y(!0);try{if(c){const ae=await fetch("/api/v1/auth/2fa/challenge",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:s,code:a})}),be=await ae.json();if(!ae.ok)throw new Error(be.message||"2FA verification failed");te(be.user),Q("/")}else try{const ae=await B(t,s);ae.requires_tenant_selection&&((Ce=ae.accessible_tenants)!=null&&Ce.length)?(D(ae.accessible_tenants),O(!0)):Q("/")}catch(ae){if((Pe=ae.message)!=null&&Pe.includes("2FA")||(Se=ae.message)!=null&&Se.includes("two-factor"))i(!0),p("");else throw ae}}catch(ae){p(ae.message||"Login failed. Please check your credentials.")}finally{y(!1)}};return M?e.jsx(xy,{children:e.jsxs(H,{className:"border-0 shadow-xl",children:[e.jsxs(ue,{className:"space-y-1 pb-4",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mb-2",children:e.jsx($p,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsx(he,{className:"text-2xl font-bold text-center",children:"Select Your County"}),e.jsx(mr,{className:"text-center",children:"As a Super Admin, please select which county you'd like to work with"})]}),e.jsxs(X,{className:"space-y-3",children:[f&&e.jsx(zn,{variant:"destructive",className:"animate-in fade-in-50",children:e.jsx(An,{children:f})}),C.map(oe=>{var Ce;return e.jsx("button",{type:"button",onClick:()=>Z(oe.id),disabled:g,className:`w-full text-left p-4 rounded-lg border-2 transition-all ${L===oe.id?"border-blue-500 bg-blue-50 dark:bg-blue-950/30":"border-gray-200 dark:border-gray-700 hover:border-blue-300 hover:bg-gray-50 dark:hover:bg-gray-800"} ${g?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-lg flex items-center justify-center text-white font-bold text-sm",children:oe.short_code||((Ce=oe.county)==null?void 0:Ce.substring(0,2).toUpperCase())}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:oe.name}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(fn,{className:"w-3 h-3"}),oe.county," County, Kenya"]})]}),g&&L===oe.id&&e.jsx(as,{className:"w-5 h-5 animate-spin text-blue-500"})]})},oe.id)})]}),e.jsxs(my,{className:"flex flex-col gap-3 pt-4",children:[e.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"You can switch counties later from the settings menu"}),e.jsx(K,{type:"button",variant:"ghost",size:"sm",onClick:()=>{O(!1),D([]),p("")},disabled:g,className:"text-muted-foreground",children:"Back to login"})]})]})}):e.jsxs(xy,{children:[e.jsxs(H,{className:"border-0 shadow-xl",children:[e.jsxs(ue,{className:"space-y-1 pb-4",children:[e.jsx(he,{className:"text-2xl font-bold text-center",children:"Welcome Back"}),e.jsx(mr,{className:"text-center",children:"Sign in to access the Rural Water Supply MIS"})]}),e.jsxs("form",{onSubmit:ne,children:[e.jsxs(X,{className:"space-y-4",children:[f&&e.jsx(zn,{variant:"destructive",className:"animate-in fade-in-50",children:e.jsx(An,{children:f})}),c&&e.jsxs(zn,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950/30",children:[e.jsx(ka,{className:"h-4 w-4 text-blue-600"}),e.jsx(An,{className:"text-blue-800 dark:text-blue-200",children:"Two-factor authentication is enabled. Enter your verification code."})]}),c?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"2fa-code",children:"Verification Code"}),e.jsx(Ie,{id:"2fa-code",type:"text",placeholder:"000000",maxLength:6,value:a,onChange:oe=>o(oe.target.value.replace(/\D/g,"")),required:!0,disabled:g,autoFocus:!0,className:"h-11 text-center text-2xl tracking-widest font-mono"}),e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Enter the 6-digit code from your authenticator app"})]}),e.jsx(K,{type:"button",variant:"ghost",size:"sm",onClick:()=>{i(!1),o(""),p("")},disabled:g,className:"w-full",children:"Back to login"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"email",children:"Email Address"}),e.jsx(Ie,{id:"email",type:"email",placeholder:"you@example.com",value:t,onChange:oe=>r(oe.target.value),required:!0,disabled:g,className:"h-11",autoComplete:"email"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(we,{htmlFor:"password",children:"Password"}),e.jsx(Pn,{to:"/auth/forgot-password",className:"text-sm text-blue-600 hover:text-blue-500 hover:underline",children:"Forgot password?"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ie,{id:"password",type:b?"text":"password",placeholder:"Enter your password",value:s,onChange:oe=>n(oe.target.value),required:!0,disabled:g,className:"h-11 pr-10",autoComplete:"current-password"}),e.jsx("button",{type:"button",onClick:()=>w(!b),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",tabIndex:-1,children:b?e.jsx(_b,{className:"h-4 w-4"}):e.jsx(mo,{className:"h-4 w-4"})})]})]})]})]}),e.jsxs(my,{className:"flex flex-col gap-4",children:[e.jsx(K,{type:"submit",className:"w-full h-11 text-base font-medium",disabled:g||c&&a.length!==6,children:g?e.jsxs(e.Fragment,{children:[e.jsx(as,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):c?"Verify & Sign In":"Sign In"}),e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:["Don't have an account?"," ",e.jsx(Pn,{to:"/auth/register",className:"text-blue-600 hover:text-blue-500 font-medium hover:underline",children:"Create account"})]})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("button",{type:"button",onClick:()=>N(!T),className:"w-full flex items-center justify-center gap-2 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:[e.jsx(Ds,{className:"h-4 w-4"}),"Demo Credentials",T?e.jsx(s9,{className:"h-4 w-4"}):e.jsx(jp,{className:"h-4 w-4"})]}),T&&e.jsx(H,{className:"mt-3 border-dashed border-2 bg-gray-50/50 dark:bg-gray-800/50",children:e.jsxs(X,{className:"p-4 space-y-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground text-center mb-3",children:"Click to auto-fill credentials for testing"}),vie.map((oe,Ce)=>e.jsxs("button",{type:"button",onClick:()=>re(oe),className:"w-full text-left p-3 rounded-lg border bg-white dark:bg-gray-900 hover:border-blue-300 hover:bg-blue-50 dark:hover:bg-blue-950/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-sm",children:oe.role}),e.jsx("span",{className:"text-xs text-muted-foreground",children:oe.description})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1 font-mono",children:oe.email})]},Ce))]})})]})]})}function jie(){const[t,r]=A.useState(""),[s,n]=A.useState(!1),[a,o]=A.useState(""),[c,i]=A.useState(!1),f=async p=>{p.preventDefault(),o(""),n(!0);try{const g=await fetch("/api/v1/auth/password/forgot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t})});if(!g.ok){const y=await g.json();throw new Error(y.message||"Failed to send reset email")}i(!0)}catch(g){o(g.message||"Failed to send password reset email. Please try again.")}finally{n(!1)}};return c?e.jsx(xy,{children:e.jsxs(H,{className:"border-0 shadow-xl",children:[e.jsxs(X,{className:"pt-8 pb-8 text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:e.jsx(Ns,{className:"h-8 w-8 text-green-600"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Check Your Email"}),e.jsxs("p",{className:"text-muted-foreground max-w-sm mx-auto",children:["We've sent password reset instructions to ",e.jsx("span",{className:"font-medium text-foreground",children:t})]})]}),e.jsxs("div",{className:"pt-4 space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Didn't receive the email? Check your spam folder or"}),e.jsx(K,{variant:"outline",onClick:()=>{i(!1),r("")},children:"Try another email"})]})]}),e.jsx(my,{className:"justify-center pb-6",children:e.jsxs(Pn,{to:"/auth/login",className:"inline-flex items-center gap-2 text-sm text-blue-600 hover:text-blue-500 hover:underline",children:[e.jsx(vb,{className:"h-4 w-4"}),"Back to sign in"]})})]})}):e.jsx(xy,{children:e.jsxs(H,{className:"border-0 shadow-xl",children:[e.jsxs(ue,{className:"space-y-1 pb-4",children:[e.jsx("div",{className:"mx-auto w-14 h-14 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mb-2",children:e.jsx(Fm,{className:"h-7 w-7 text-blue-600"})}),e.jsx(he,{className:"text-2xl font-bold text-center",children:"Forgot Password?"}),e.jsx(mr,{className:"text-center",children:"Enter your email and we'll send you reset instructions"})]}),e.jsxs("form",{onSubmit:f,children:[e.jsxs(X,{className:"space-y-4",children:[a&&e.jsx(zn,{variant:"destructive",className:"animate-in fade-in-50",children:e.jsx(An,{children:a})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"email",children:"Email Address"}),e.jsx(Ie,{id:"email",type:"email",placeholder:"you@example.com",value:t,onChange:p=>r(p.target.value),required:!0,disabled:s,className:"h-11",autoComplete:"email",autoFocus:!0})]})]}),e.jsxs(my,{className:"flex flex-col gap-4",children:[e.jsx(K,{type:"submit",className:"w-full h-11 text-base font-medium",disabled:s||!t,children:s?e.jsxs(e.Fragment,{children:[e.jsx(as,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending..."]}):"Send Reset Link"}),e.jsxs(Pn,{to:"/auth/login",className:"inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground",children:[e.jsx(vb,{className:"h-4 w-4"}),"Back to sign in"]})]})]})]})})}const Y1=[{label:"At least 8 characters",test:t=>t.length>=8},{label:"Contains uppercase letter",test:t=>/[A-Z]/.test(t)},{label:"Contains lowercase letter",test:t=>/[a-z]/.test(t)},{label:"Contains a number",test:t=>/\d/.test(t)}];function bie(){const[t,r]=A.useState({name:"",email:"",password:"",confirmPassword:"",organization:""}),[s,n]=A.useState(!1),[a,o]=A.useState(""),[c,i]=A.useState(!1),[f,p]=A.useState(!1),[g,y]=A.useState(!1),b=Fp(),w=O=>C=>{r(D=>({...D,[O]:C.target.value})),o("")},T=Y1.filter(O=>O.test(t.password)).length,N=t.password===t.confirmPassword&&t.confirmPassword.length>0,M=async O=>{if(O.preventDefault(),o(""),t.password!==t.confirmPassword){o("Passwords do not match");return}if(T<Y1.length){o("Please ensure your password meets all requirements");return}n(!0);try{const C=await fetch("/api/v1/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t.name,email:t.email,password:t.password,organization:t.organization})});if(!C.ok){const D=await C.json();throw new Error(D.message||"Registration failed")}y(!0)}catch(C){o(C.message||"Registration failed. Please try again.")}finally{n(!1)}};return g?e.jsx(xy,{children:e.jsx(H,{className:"border-0 shadow-xl",children:e.jsxs(X,{className:"pt-8 pb-8 text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:e.jsx(Ns,{className:"h-8 w-8 text-green-600"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Account Created!"}),e.jsx("p",{className:"text-muted-foreground max-w-sm mx-auto",children:"Your account has been created successfully. You can now sign in with your credentials."})]}),e.jsx("div",{className:"pt-4",children:e.jsx(K,{onClick:()=>b("/auth/login"),className:"w-full",children:"Continue to Sign In"})})]})})}):e.jsxs(xy,{children:[e.jsxs(H,{className:"border-0 shadow-xl",children:[e.jsxs(ue,{className:"space-y-1 pb-4",children:[e.jsx(he,{className:"text-2xl font-bold text-center",children:"Create Account"}),e.jsx(mr,{className:"text-center",children:"Join the Rural Water Supply Management System"})]}),e.jsxs("form",{onSubmit:M,children:[e.jsxs(X,{className:"space-y-4",children:[a&&e.jsx(zn,{variant:"destructive",className:"animate-in fade-in-50",children:e.jsx(An,{children:a})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"name",children:"Full Name"}),e.jsx(Ie,{id:"name",type:"text",placeholder:"John Doe",value:t.name,onChange:w("name"),required:!0,disabled:s,className:"h-11",autoComplete:"name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"email",children:"Email Address"}),e.jsx(Ie,{id:"email",type:"email",placeholder:"you@example.com",value:t.email,onChange:w("email"),required:!0,disabled:s,className:"h-11",autoComplete:"email"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"organization",children:"Organization (Optional)"}),e.jsx(Ie,{id:"organization",type:"text",placeholder:"Water Utility Name",value:t.organization,onChange:w("organization"),disabled:s,className:"h-11"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ie,{id:"password",type:c?"text":"password",placeholder:"Create a strong password",value:t.password,onChange:w("password"),required:!0,disabled:s,className:"h-11 pr-10",autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>i(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",tabIndex:-1,children:c?e.jsx(_b,{className:"h-4 w-4"}):e.jsx(mo,{className:"h-4 w-4"})})]}),t.password&&e.jsxs("div",{className:"space-y-2 pt-2",children:[e.jsx("div",{className:"flex gap-1",children:[...Array(4)].map((O,C)=>e.jsx("div",{className:dr("h-1.5 flex-1 rounded-full transition-colors",C<T?T<=2?"bg-red-500":T===3?"bg-yellow-500":"bg-green-500":"bg-gray-200 dark:bg-gray-700")},C))}),e.jsx("div",{className:"grid grid-cols-2 gap-1 text-xs",children:Y1.map((O,C)=>e.jsxs("div",{className:dr("flex items-center gap-1",O.test(t.password)?"text-green-600":"text-muted-foreground"),children:[O.test(t.password)?e.jsx(Ns,{className:"h-3 w-3"}):e.jsx(ec,{className:"h-3 w-3"}),O.label]},C))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ie,{id:"confirmPassword",type:f?"text":"password",placeholder:"Confirm your password",value:t.confirmPassword,onChange:w("confirmPassword"),required:!0,disabled:s,className:dr("h-11 pr-10",t.confirmPassword&&!N&&"border-red-500 focus-visible:ring-red-500"),autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>p(!f),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",tabIndex:-1,children:f?e.jsx(_b,{className:"h-4 w-4"}):e.jsx(mo,{className:"h-4 w-4"})})]}),t.confirmPassword&&!N&&e.jsx("p",{className:"text-xs text-red-500",children:"Passwords do not match"})]})]}),e.jsxs(my,{className:"flex flex-col gap-4",children:[e.jsx(K,{type:"submit",className:"w-full h-11 text-base font-medium",disabled:s||T<Y1.length||!N,children:s?e.jsxs(e.Fragment,{children:[e.jsx(as,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating account..."]}):"Create Account"}),e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:["Already have an account?"," ",e.jsx(Pn,{to:"/auth/login",className:"text-blue-600 hover:text-blue-500 font-medium hover:underline",children:"Sign in"})]})]})]})]}),e.jsxs("p",{className:"mt-6 text-center text-xs text-muted-foreground",children:["By creating an account, you agree to our"," ",e.jsx("a",{href:"#",className:"underline hover:text-foreground",children:"Terms of Service"})," ","and"," ",e.jsx("a",{href:"#",className:"underline hover:text-foreground",children:"Privacy Policy"})]})]})}function _ie(){const{data:t}=it({queryKey:["registry-stats"],queryFn:async()=>({schemes:2,assets:3,dmas:2,meters:2})});return e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Core Registry"}),e.jsx("p",{className:"text-muted-foreground",children:"Phase 1-2: Water Infrastructure Foundation"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Water Schemes"}),e.jsx(Si,{className:"h-4 w-4 text-blue-500"})]}),e.jsx(X,{children:e.jsx("div",{className:"text-2xl font-bold",children:t==null?void 0:t.schemes})})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"DMAs"}),e.jsx(Ni,{className:"h-4 w-4 text-green-500"})]}),e.jsx(X,{children:e.jsx("div",{className:"text-2xl font-bold",children:t==null?void 0:t.dmas})})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Assets"}),e.jsx(Gn,{className:"h-4 w-4 text-orange-500"})]}),e.jsx(X,{children:e.jsx("div",{className:"text-2xl font-bold",children:t==null?void 0:t.assets})})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Meters"}),e.jsx(zc,{className:"h-4 w-4 text-purple-500"})]}),e.jsx(X,{children:e.jsx("div",{className:"text-2xl font-bold",children:t==null?void 0:t.meters})})]})]})]})}const WF={getAll:t=>pe.get("/facilities",t),getById:t=>pe.get(`/facilities/${t}`),create:t=>pe.post("/facilities",t),update:(t,r)=>pe.patch(`/facilities/${t}`,r),delete:t=>pe.delete(`/facilities/${t}`)},wie=C_("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ae({className:t,variant:r,...s}){return e.jsx("div",{className:dr(wie({variant:r}),t),...s})}function Sb(t,[r,s]){return Math.min(s,Math.max(r,t))}function gr(t,r,{checkForDefaultPrevented:s=!0}={}){return function(a){if(t==null||t(a),s===!1||!a.defaultPrevented)return r==null?void 0:r(a)}}function Nie(t,r=[]){let s=[];function n(o,c){const i=A.createContext(c),f=s.length;s=[...s,c];function p(y){const{scope:b,children:w,...T}=y,N=(b==null?void 0:b[t][f])||i,M=A.useMemo(()=>T,Object.values(T));return e.jsx(N.Provider,{value:M,children:w})}function g(y,b){const w=(b==null?void 0:b[t][f])||i,T=A.useContext(w);if(T)return T;if(c!==void 0)return c;throw new Error(`\`${y}\` must be used within \`${o}\``)}return p.displayName=o+"Provider",[p,g]}const a=()=>{const o=s.map(c=>A.createContext(c));return function(i){const f=(i==null?void 0:i[t])||o;return A.useMemo(()=>({[`__scope${t}`]:{...i,[t]:f}}),[i,f])}};return a.scopeName=t,[n,Sie(a,...r)]}function Sie(...t){const r=t[0];if(t.length===1)return r;const s=()=>{const n=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(o){const c=n.reduce((i,{useScope:f,scopeName:p})=>{const y=f(o)[`__scope${p}`];return{...i,...y}},{});return A.useMemo(()=>({[`__scope${r.scopeName}`]:c}),[c])}};return s.scopeName=r.scopeName,s}function _C(t){const r=t+"CollectionProvider",[s,n]=Nie(r),[a,o]=s(r,{collectionRef:{current:null},itemMap:new Map}),c=w=>{const{scope:T,children:N}=w,M=je.useRef(null),O=je.useRef(new Map).current;return e.jsx(a,{scope:T,itemMap:O,collectionRef:M,children:N})};c.displayName=r;const i=t+"CollectionSlot",f=je.forwardRef((w,T)=>{const{scope:N,children:M}=w,O=o(i,N),C=ls(T,O.collectionRef);return e.jsx(Ad,{ref:C,children:M})});f.displayName=i;const p=t+"CollectionItemSlot",g="data-radix-collection-item",y=je.forwardRef((w,T)=>{const{scope:N,children:M,...O}=w,C=je.useRef(null),D=ls(T,C),L=o(p,N);return je.useEffect(()=>(L.itemMap.set(C,{ref:C,...O}),()=>void L.itemMap.delete(C))),e.jsx(Ad,{[g]:"",ref:D,children:M})});y.displayName=p;function b(w){const T=o(t+"CollectionConsumer",w);return je.useCallback(()=>{const M=T.collectionRef.current;if(!M)return[];const O=Array.from(M.querySelectorAll(`[${g}]`));return Array.from(T.itemMap.values()).sort((L,F)=>O.indexOf(L.ref.current)-O.indexOf(F.ref.current))},[T.collectionRef,T.itemMap])}return[{Provider:c,Slot:f,ItemSlot:y},b,n]}function Cie(t,r){const s=A.createContext(r),n=o=>{const{children:c,...i}=o,f=A.useMemo(()=>i,Object.values(i));return e.jsx(s.Provider,{value:f,children:c})};n.displayName=t+"Provider";function a(o){const c=A.useContext(s);if(c)return c;if(r!==void 0)return r;throw new Error(`\`${o}\` must be used within \`${t}\``)}return[n,a]}function tc(t,r=[]){let s=[];function n(o,c){const i=A.createContext(c),f=s.length;s=[...s,c];const p=y=>{var O;const{scope:b,children:w,...T}=y,N=((O=b==null?void 0:b[t])==null?void 0:O[f])||i,M=A.useMemo(()=>T,Object.values(T));return e.jsx(N.Provider,{value:M,children:w})};p.displayName=o+"Provider";function g(y,b){var N;const w=((N=b==null?void 0:b[t])==null?void 0:N[f])||i,T=A.useContext(w);if(T)return T;if(c!==void 0)return c;throw new Error(`\`${y}\` must be used within \`${o}\``)}return[p,g]}const a=()=>{const o=s.map(c=>A.createContext(c));return function(i){const f=(i==null?void 0:i[t])||o;return A.useMemo(()=>({[`__scope${t}`]:{...i,[t]:f}}),[i,f])}};return a.scopeName=t,[n,Pie(a,...r)]}function Pie(...t){const r=t[0];if(t.length===1)return r;const s=()=>{const n=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(o){const c=n.reduce((i,{useScope:f,scopeName:p})=>{const y=f(o)[`__scope${p}`];return{...i,...y}},{});return A.useMemo(()=>({[`__scope${r.scopeName}`]:c}),[c])}};return s.scopeName=r.scopeName,s}var kie=A.createContext(void 0);function dv(t){const r=A.useContext(kie);return t||r||"ltr"}function oi(t){const r=A.useRef(t);return A.useEffect(()=>{r.current=t}),A.useMemo(()=>(...s)=>{var n;return(n=r.current)==null?void 0:n.call(r,...s)},[])}function Aie(t,r=globalThis==null?void 0:globalThis.document){const s=oi(t);A.useEffect(()=>{const n=a=>{a.key==="Escape"&&s(a)};return r.addEventListener("keydown",n,{capture:!0}),()=>r.removeEventListener("keydown",n,{capture:!0})},[s,r])}var Tie="DismissableLayer",aM="dismissableLayer.update",Eie="dismissableLayer.pointerDownOutside",Mie="dismissableLayer.focusOutside",GF,p9=A.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),A_=A.forwardRef((t,r)=>{const{disableOutsidePointerEvents:s=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:o,onInteractOutside:c,onDismiss:i,...f}=t,p=A.useContext(p9),[g,y]=A.useState(null),b=(g==null?void 0:g.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,w]=A.useState({}),T=ls(r,U=>y(U)),N=Array.from(p.layers),[M]=[...p.layersWithOutsidePointerEventsDisabled].slice(-1),O=N.indexOf(M),C=g?N.indexOf(g):-1,D=p.layersWithOutsidePointerEventsDisabled.size>0,L=C>=O,F=Die(U=>{const te=U.target,Q=[...p.branches].some(re=>re.contains(te));!L||Q||(a==null||a(U),c==null||c(U),U.defaultPrevented||i==null||i())},b),B=Rie(U=>{const te=U.target;[...p.branches].some(re=>re.contains(te))||(o==null||o(U),c==null||c(U),U.defaultPrevented||i==null||i())},b);return Aie(U=>{C===p.layers.size-1&&(n==null||n(U),!U.defaultPrevented&&i&&(U.preventDefault(),i()))},b),A.useEffect(()=>{if(g)return s&&(p.layersWithOutsidePointerEventsDisabled.size===0&&(GF=b.body.style.pointerEvents,b.body.style.pointerEvents="none"),p.layersWithOutsidePointerEventsDisabled.add(g)),p.layers.add(g),KF(),()=>{s&&p.layersWithOutsidePointerEventsDisabled.size===1&&(b.body.style.pointerEvents=GF)}},[g,b,s,p]),A.useEffect(()=>()=>{g&&(p.layers.delete(g),p.layersWithOutsidePointerEventsDisabled.delete(g),KF())},[g,p]),A.useEffect(()=>{const U=()=>w({});return document.addEventListener(aM,U),()=>document.removeEventListener(aM,U)},[]),e.jsx(Tr.div,{...f,ref:T,style:{pointerEvents:D?L?"auto":"none":void 0,...t.style},onFocusCapture:gr(t.onFocusCapture,B.onFocusCapture),onBlurCapture:gr(t.onBlurCapture,B.onBlurCapture),onPointerDownCapture:gr(t.onPointerDownCapture,F.onPointerDownCapture)})});A_.displayName=Tie;var Oie="DismissableLayerBranch",Iie=A.forwardRef((t,r)=>{const s=A.useContext(p9),n=A.useRef(null),a=ls(r,n);return A.useEffect(()=>{const o=n.current;if(o)return s.branches.add(o),()=>{s.branches.delete(o)}},[s.branches]),e.jsx(Tr.div,{...t,ref:a})});Iie.displayName=Oie;function Die(t,r=globalThis==null?void 0:globalThis.document){const s=oi(t),n=A.useRef(!1),a=A.useRef(()=>{});return A.useEffect(()=>{const o=i=>{if(i.target&&!n.current){let f=function(){x9(Eie,s,p,{discrete:!0})};const p={originalEvent:i};i.pointerType==="touch"?(r.removeEventListener("click",a.current),a.current=f,r.addEventListener("click",a.current,{once:!0})):f()}else r.removeEventListener("click",a.current);n.current=!1},c=window.setTimeout(()=>{r.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(c),r.removeEventListener("pointerdown",o),r.removeEventListener("click",a.current)}},[r,s]),{onPointerDownCapture:()=>n.current=!0}}function Rie(t,r=globalThis==null?void 0:globalThis.document){const s=oi(t),n=A.useRef(!1);return A.useEffect(()=>{const a=o=>{o.target&&!n.current&&x9(Mie,s,{originalEvent:o},{discrete:!1})};return r.addEventListener("focusin",a),()=>r.removeEventListener("focusin",a)},[r,s]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function KF(){const t=new CustomEvent(aM);document.dispatchEvent(t)}function x9(t,r,s,{discrete:n}){const a=s.originalEvent.target,o=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:s});r&&a.addEventListener(t,r,{once:!0}),n?JU(a,o):a.dispatchEvent(o)}var PA=0;function wC(){A.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??HF()),document.body.insertAdjacentElement("beforeend",t[1]??HF()),PA++,()=>{PA===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),PA--}},[])}function HF(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var kA="focusScope.autoFocusOnMount",AA="focusScope.autoFocusOnUnmount",ZF={bubbles:!1,cancelable:!0},Lie="FocusScope",T_=A.forwardRef((t,r)=>{const{loop:s=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...c}=t,[i,f]=A.useState(null),p=oi(a),g=oi(o),y=A.useRef(null),b=ls(r,N=>f(N)),w=A.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;A.useEffect(()=>{if(n){let N=function(D){if(w.paused||!i)return;const L=D.target;i.contains(L)?y.current=L:Ih(y.current,{select:!0})},M=function(D){if(w.paused||!i)return;const L=D.relatedTarget;L!==null&&(i.contains(L)||Ih(y.current,{select:!0}))},O=function(D){if(document.activeElement===document.body)for(const F of D)F.removedNodes.length>0&&Ih(i)};document.addEventListener("focusin",N),document.addEventListener("focusout",M);const C=new MutationObserver(O);return i&&C.observe(i,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",N),document.removeEventListener("focusout",M),C.disconnect()}}},[n,i,w.paused]),A.useEffect(()=>{if(i){XF.add(w);const N=document.activeElement;if(!i.contains(N)){const O=new CustomEvent(kA,ZF);i.addEventListener(kA,p),i.dispatchEvent(O),O.defaultPrevented||(Fie(Vie(g9(i)),{select:!0}),document.activeElement===N&&Ih(i))}return()=>{i.removeEventListener(kA,p),setTimeout(()=>{const O=new CustomEvent(AA,ZF);i.addEventListener(AA,g),i.dispatchEvent(O),O.defaultPrevented||Ih(N??document.body,{select:!0}),i.removeEventListener(AA,g),XF.remove(w)},0)}}},[i,p,g,w]);const T=A.useCallback(N=>{if(!s&&!n||w.paused)return;const M=N.key==="Tab"&&!N.altKey&&!N.ctrlKey&&!N.metaKey,O=document.activeElement;if(M&&O){const C=N.currentTarget,[D,L]=$ie(C);D&&L?!N.shiftKey&&O===L?(N.preventDefault(),s&&Ih(D,{select:!0})):N.shiftKey&&O===D&&(N.preventDefault(),s&&Ih(L,{select:!0})):O===C&&N.preventDefault()}},[s,n,w.paused]);return e.jsx(Tr.div,{tabIndex:-1,...c,ref:b,onKeyDown:T})});T_.displayName=Lie;function Fie(t,{select:r=!1}={}){const s=document.activeElement;for(const n of t)if(Ih(n,{select:r}),document.activeElement!==s)return}function $ie(t){const r=g9(t),s=YF(r,t),n=YF(r.reverse(),t);return[s,n]}function g9(t){const r=[],s=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)r.push(s.currentNode);return r}function YF(t,r){for(const s of t)if(!zie(s,{upTo:r}))return s}function zie(t,{upTo:r}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(r!==void 0&&t===r)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Bie(t){return t instanceof HTMLInputElement&&"select"in t}function Ih(t,{select:r=!1}={}){if(t&&t.focus){const s=document.activeElement;t.focus({preventScroll:!0}),t!==s&&Bie(t)&&r&&t.select()}}var XF=qie();function qie(){let t=[];return{add(r){const s=t[0];r!==s&&(s==null||s.pause()),t=QF(t,r),t.unshift(r)},remove(r){var s;t=QF(t,r),(s=t[0])==null||s.resume()}}}function QF(t,r){const s=[...t],n=s.indexOf(r);return n!==-1&&s.splice(n,1),s}function Vie(t){return t.filter(r=>r.tagName!=="A")}var Hi=globalThis!=null&&globalThis.document?A.useLayoutEffect:()=>{},Uie=pq.useId||(()=>{}),Wie=0;function Pi(t){const[r,s]=A.useState(Uie());return Hi(()=>{s(n=>n??String(Wie++))},[t]),r?`radix-${r}`:""}const Gie=["top","right","bottom","left"],wm=Math.min,hl=Math.max,wS=Math.round,X1=Math.floor,Sd=t=>({x:t,y:t}),Kie={left:"right",right:"left",bottom:"top",top:"bottom"},Hie={start:"end",end:"start"};function iM(t,r,s){return hl(t,wm(r,s))}function zu(t,r){return typeof t=="function"?t(r):t}function Bu(t){return t.split("-")[0]}function uv(t){return t.split("-")[1]}function bI(t){return t==="x"?"y":"x"}function _I(t){return t==="y"?"height":"width"}function Nm(t){return["top","bottom"].includes(Bu(t))?"y":"x"}function wI(t){return bI(Nm(t))}function Zie(t,r,s){s===void 0&&(s=!1);const n=uv(t),a=wI(t),o=_I(a);let c=a==="x"?n===(s?"end":"start")?"right":"left":n==="start"?"bottom":"top";return r.reference[o]>r.floating[o]&&(c=NS(c)),[c,NS(c)]}function Yie(t){const r=NS(t);return[oM(t),r,oM(r)]}function oM(t){return t.replace(/start|end/g,r=>Hie[r])}function Xie(t,r,s){const n=["left","right"],a=["right","left"],o=["top","bottom"],c=["bottom","top"];switch(t){case"top":case"bottom":return s?r?a:n:r?n:a;case"left":case"right":return r?o:c;default:return[]}}function Qie(t,r,s,n){const a=uv(t);let o=Xie(Bu(t),s==="start",n);return a&&(o=o.map(c=>c+"-"+a),r&&(o=o.concat(o.map(oM)))),o}function NS(t){return t.replace(/left|right|bottom|top/g,r=>Kie[r])}function Jie(t){return{top:0,right:0,bottom:0,left:0,...t}}function y9(t){return typeof t!="number"?Jie(t):{top:t,right:t,bottom:t,left:t}}function SS(t){const{x:r,y:s,width:n,height:a}=t;return{width:n,height:a,top:s,left:r,right:r+n,bottom:s+a,x:r,y:s}}function JF(t,r,s){let{reference:n,floating:a}=t;const o=Nm(r),c=wI(r),i=_I(c),f=Bu(r),p=o==="y",g=n.x+n.width/2-a.width/2,y=n.y+n.height/2-a.height/2,b=n[i]/2-a[i]/2;let w;switch(f){case"top":w={x:g,y:n.y-a.height};break;case"bottom":w={x:g,y:n.y+n.height};break;case"right":w={x:n.x+n.width,y};break;case"left":w={x:n.x-a.width,y};break;default:w={x:n.x,y:n.y}}switch(uv(r)){case"start":w[c]-=b*(s&&p?-1:1);break;case"end":w[c]+=b*(s&&p?-1:1);break}return w}const eoe=async(t,r,s)=>{const{placement:n="bottom",strategy:a="absolute",middleware:o=[],platform:c}=s,i=o.filter(Boolean),f=await(c.isRTL==null?void 0:c.isRTL(r));let p=await c.getElementRects({reference:t,floating:r,strategy:a}),{x:g,y}=JF(p,n,f),b=n,w={},T=0;for(let N=0;N<i.length;N++){const{name:M,fn:O}=i[N],{x:C,y:D,data:L,reset:F}=await O({x:g,y,initialPlacement:n,placement:b,strategy:a,middlewareData:w,rects:p,platform:c,elements:{reference:t,floating:r}});g=C??g,y=D??y,w={...w,[M]:{...w[M],...L}},F&&T<=50&&(T++,typeof F=="object"&&(F.placement&&(b=F.placement),F.rects&&(p=F.rects===!0?await c.getElementRects({reference:t,floating:r,strategy:a}):F.rects),{x:g,y}=JF(p,b,f)),N=-1)}return{x:g,y,placement:b,strategy:a,middlewareData:w}};async function Cb(t,r){var s;r===void 0&&(r={});const{x:n,y:a,platform:o,rects:c,elements:i,strategy:f}=t,{boundary:p="clippingAncestors",rootBoundary:g="viewport",elementContext:y="floating",altBoundary:b=!1,padding:w=0}=zu(r,t),T=y9(w),M=i[b?y==="floating"?"reference":"floating":y],O=SS(await o.getClippingRect({element:(s=await(o.isElement==null?void 0:o.isElement(M)))==null||s?M:M.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(i.floating)),boundary:p,rootBoundary:g,strategy:f})),C=y==="floating"?{x:n,y:a,width:c.floating.width,height:c.floating.height}:c.reference,D=await(o.getOffsetParent==null?void 0:o.getOffsetParent(i.floating)),L=await(o.isElement==null?void 0:o.isElement(D))?await(o.getScale==null?void 0:o.getScale(D))||{x:1,y:1}:{x:1,y:1},F=SS(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:i,rect:C,offsetParent:D,strategy:f}):C);return{top:(O.top-F.top+T.top)/L.y,bottom:(F.bottom-O.bottom+T.bottom)/L.y,left:(O.left-F.left+T.left)/L.x,right:(F.right-O.right+T.right)/L.x}}const toe=t=>({name:"arrow",options:t,async fn(r){const{x:s,y:n,placement:a,rects:o,platform:c,elements:i,middlewareData:f}=r,{element:p,padding:g=0}=zu(t,r)||{};if(p==null)return{};const y=y9(g),b={x:s,y:n},w=wI(a),T=_I(w),N=await c.getDimensions(p),M=w==="y",O=M?"top":"left",C=M?"bottom":"right",D=M?"clientHeight":"clientWidth",L=o.reference[T]+o.reference[w]-b[w]-o.floating[T],F=b[w]-o.reference[w],B=await(c.getOffsetParent==null?void 0:c.getOffsetParent(p));let U=B?B[D]:0;(!U||!await(c.isElement==null?void 0:c.isElement(B)))&&(U=i.floating[D]||o.floating[T]);const te=L/2-F/2,Q=U/2-N[T]/2-1,re=wm(y[O],Q),Z=wm(y[C],Q),ne=re,oe=U-N[T]-Z,Ce=U/2-N[T]/2+te,Pe=iM(ne,Ce,oe),Se=!f.arrow&&uv(a)!=null&&Ce!==Pe&&o.reference[T]/2-(Ce<ne?re:Z)-N[T]/2<0,ae=Se?Ce<ne?Ce-ne:Ce-oe:0;return{[w]:b[w]+ae,data:{[w]:Pe,centerOffset:Ce-Pe-ae,...Se&&{alignmentOffset:ae}},reset:Se}}}),roe=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(r){var s,n;const{placement:a,middlewareData:o,rects:c,initialPlacement:i,platform:f,elements:p}=r,{mainAxis:g=!0,crossAxis:y=!0,fallbackPlacements:b,fallbackStrategy:w="bestFit",fallbackAxisSideDirection:T="none",flipAlignment:N=!0,...M}=zu(t,r);if((s=o.arrow)!=null&&s.alignmentOffset)return{};const O=Bu(a),C=Nm(i),D=Bu(i)===i,L=await(f.isRTL==null?void 0:f.isRTL(p.floating)),F=b||(D||!N?[NS(i)]:Yie(i)),B=T!=="none";!b&&B&&F.push(...Qie(i,N,T,L));const U=[i,...F],te=await Cb(r,M),Q=[];let re=((n=o.flip)==null?void 0:n.overflows)||[];if(g&&Q.push(te[O]),y){const Ce=Zie(a,c,L);Q.push(te[Ce[0]],te[Ce[1]])}if(re=[...re,{placement:a,overflows:Q}],!Q.every(Ce=>Ce<=0)){var Z,ne;const Ce=(((Z=o.flip)==null?void 0:Z.index)||0)+1,Pe=U[Ce];if(Pe)return{data:{index:Ce,overflows:re},reset:{placement:Pe}};let Se=(ne=re.filter(ae=>ae.overflows[0]<=0).sort((ae,be)=>ae.overflows[1]-be.overflows[1])[0])==null?void 0:ne.placement;if(!Se)switch(w){case"bestFit":{var oe;const ae=(oe=re.filter(be=>{if(B){const de=Nm(be.placement);return de===C||de==="y"}return!0}).map(be=>[be.placement,be.overflows.filter(de=>de>0).reduce((de,Ke)=>de+Ke,0)]).sort((be,de)=>be[1]-de[1])[0])==null?void 0:oe[0];ae&&(Se=ae);break}case"initialPlacement":Se=i;break}if(a!==Se)return{reset:{placement:Se}}}return{}}}};function e5(t,r){return{top:t.top-r.height,right:t.right-r.width,bottom:t.bottom-r.height,left:t.left-r.width}}function t5(t){return Gie.some(r=>t[r]>=0)}const soe=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(r){const{rects:s}=r,{strategy:n="referenceHidden",...a}=zu(t,r);switch(n){case"referenceHidden":{const o=await Cb(r,{...a,elementContext:"reference"}),c=e5(o,s.reference);return{data:{referenceHiddenOffsets:c,referenceHidden:t5(c)}}}case"escaped":{const o=await Cb(r,{...a,altBoundary:!0}),c=e5(o,s.floating);return{data:{escapedOffsets:c,escaped:t5(c)}}}default:return{}}}}};async function noe(t,r){const{placement:s,platform:n,elements:a}=t,o=await(n.isRTL==null?void 0:n.isRTL(a.floating)),c=Bu(s),i=uv(s),f=Nm(s)==="y",p=["left","top"].includes(c)?-1:1,g=o&&f?-1:1,y=zu(r,t);let{mainAxis:b,crossAxis:w,alignmentAxis:T}=typeof y=="number"?{mainAxis:y,crossAxis:0,alignmentAxis:null}:{mainAxis:y.mainAxis||0,crossAxis:y.crossAxis||0,alignmentAxis:y.alignmentAxis};return i&&typeof T=="number"&&(w=i==="end"?T*-1:T),f?{x:w*g,y:b*p}:{x:b*p,y:w*g}}const aoe=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(r){var s,n;const{x:a,y:o,placement:c,middlewareData:i}=r,f=await noe(r,t);return c===((s=i.offset)==null?void 0:s.placement)&&(n=i.arrow)!=null&&n.alignmentOffset?{}:{x:a+f.x,y:o+f.y,data:{...f,placement:c}}}}},ioe=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(r){const{x:s,y:n,placement:a}=r,{mainAxis:o=!0,crossAxis:c=!1,limiter:i={fn:M=>{let{x:O,y:C}=M;return{x:O,y:C}}},...f}=zu(t,r),p={x:s,y:n},g=await Cb(r,f),y=Nm(Bu(a)),b=bI(y);let w=p[b],T=p[y];if(o){const M=b==="y"?"top":"left",O=b==="y"?"bottom":"right",C=w+g[M],D=w-g[O];w=iM(C,w,D)}if(c){const M=y==="y"?"top":"left",O=y==="y"?"bottom":"right",C=T+g[M],D=T-g[O];T=iM(C,T,D)}const N=i.fn({...r,[b]:w,[y]:T});return{...N,data:{x:N.x-s,y:N.y-n,enabled:{[b]:o,[y]:c}}}}}},ooe=function(t){return t===void 0&&(t={}),{options:t,fn(r){const{x:s,y:n,placement:a,rects:o,middlewareData:c}=r,{offset:i=0,mainAxis:f=!0,crossAxis:p=!0}=zu(t,r),g={x:s,y:n},y=Nm(a),b=bI(y);let w=g[b],T=g[y];const N=zu(i,r),M=typeof N=="number"?{mainAxis:N,crossAxis:0}:{mainAxis:0,crossAxis:0,...N};if(f){const D=b==="y"?"height":"width",L=o.reference[b]-o.floating[D]+M.mainAxis,F=o.reference[b]+o.reference[D]-M.mainAxis;w<L?w=L:w>F&&(w=F)}if(p){var O,C;const D=b==="y"?"width":"height",L=["top","left"].includes(Bu(a)),F=o.reference[y]-o.floating[D]+(L&&((O=c.offset)==null?void 0:O[y])||0)+(L?0:M.crossAxis),B=o.reference[y]+o.reference[D]+(L?0:((C=c.offset)==null?void 0:C[y])||0)-(L?M.crossAxis:0);T<F?T=F:T>B&&(T=B)}return{[b]:w,[y]:T}}}},loe=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(r){var s,n;const{placement:a,rects:o,platform:c,elements:i}=r,{apply:f=()=>{},...p}=zu(t,r),g=await Cb(r,p),y=Bu(a),b=uv(a),w=Nm(a)==="y",{width:T,height:N}=o.floating;let M,O;y==="top"||y==="bottom"?(M=y,O=b===(await(c.isRTL==null?void 0:c.isRTL(i.floating))?"start":"end")?"left":"right"):(O=y,M=b==="end"?"top":"bottom");const C=N-g.top-g.bottom,D=T-g.left-g.right,L=wm(N-g[M],C),F=wm(T-g[O],D),B=!r.middlewareData.shift;let U=L,te=F;if((s=r.middlewareData.shift)!=null&&s.enabled.x&&(te=D),(n=r.middlewareData.shift)!=null&&n.enabled.y&&(U=C),B&&!b){const re=hl(g.left,0),Z=hl(g.right,0),ne=hl(g.top,0),oe=hl(g.bottom,0);w?te=T-2*(re!==0||Z!==0?re+Z:hl(g.left,g.right)):U=N-2*(ne!==0||oe!==0?ne+oe:hl(g.top,g.bottom))}await f({...r,availableWidth:te,availableHeight:U});const Q=await c.getDimensions(i.floating);return T!==Q.width||N!==Q.height?{reset:{rects:!0}}:{}}}};function NC(){return typeof window<"u"}function hv(t){return v9(t)?(t.nodeName||"").toLowerCase():"#document"}function yl(t){var r;return(t==null||(r=t.ownerDocument)==null?void 0:r.defaultView)||window}function Dd(t){var r;return(r=(v9(t)?t.ownerDocument:t.document)||window.document)==null?void 0:r.documentElement}function v9(t){return NC()?t instanceof Node||t instanceof yl(t).Node:!1}function Hc(t){return NC()?t instanceof Element||t instanceof yl(t).Element:!1}function Td(t){return NC()?t instanceof HTMLElement||t instanceof yl(t).HTMLElement:!1}function r5(t){return!NC()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof yl(t).ShadowRoot}function E_(t){const{overflow:r,overflowX:s,overflowY:n,display:a}=Zc(t);return/auto|scroll|overlay|hidden|clip/.test(r+n+s)&&!["inline","contents"].includes(a)}function coe(t){return["table","td","th"].includes(hv(t))}function SC(t){return[":popover-open",":modal"].some(r=>{try{return t.matches(r)}catch{return!1}})}function NI(t){const r=SI(),s=Hc(t)?Zc(t):t;return s.transform!=="none"||s.perspective!=="none"||(s.containerType?s.containerType!=="normal":!1)||!r&&(s.backdropFilter?s.backdropFilter!=="none":!1)||!r&&(s.filter?s.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(s.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(s.contain||"").includes(n))}function doe(t){let r=Sm(t);for(;Td(r)&&!gy(r);){if(NI(r))return r;if(SC(r))return null;r=Sm(r)}return null}function SI(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function gy(t){return["html","body","#document"].includes(hv(t))}function Zc(t){return yl(t).getComputedStyle(t)}function CC(t){return Hc(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Sm(t){if(hv(t)==="html")return t;const r=t.assignedSlot||t.parentNode||r5(t)&&t.host||Dd(t);return r5(r)?r.host:r}function j9(t){const r=Sm(t);return gy(r)?t.ownerDocument?t.ownerDocument.body:t.body:Td(r)&&E_(r)?r:j9(r)}function Pb(t,r,s){var n;r===void 0&&(r=[]),s===void 0&&(s=!0);const a=j9(t),o=a===((n=t.ownerDocument)==null?void 0:n.body),c=yl(a);if(o){const i=lM(c);return r.concat(c,c.visualViewport||[],E_(a)?a:[],i&&s?Pb(i):[])}return r.concat(a,Pb(a,[],s))}function lM(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function b9(t){const r=Zc(t);let s=parseFloat(r.width)||0,n=parseFloat(r.height)||0;const a=Td(t),o=a?t.offsetWidth:s,c=a?t.offsetHeight:n,i=wS(s)!==o||wS(n)!==c;return i&&(s=o,n=c),{width:s,height:n,$:i}}function CI(t){return Hc(t)?t:t.contextElement}function $g(t){const r=CI(t);if(!Td(r))return Sd(1);const s=r.getBoundingClientRect(),{width:n,height:a,$:o}=b9(r);let c=(o?wS(s.width):s.width)/n,i=(o?wS(s.height):s.height)/a;return(!c||!Number.isFinite(c))&&(c=1),(!i||!Number.isFinite(i))&&(i=1),{x:c,y:i}}const uoe=Sd(0);function _9(t){const r=yl(t);return!SI()||!r.visualViewport?uoe:{x:r.visualViewport.offsetLeft,y:r.visualViewport.offsetTop}}function hoe(t,r,s){return r===void 0&&(r=!1),!s||r&&s!==yl(t)?!1:r}function bp(t,r,s,n){r===void 0&&(r=!1),s===void 0&&(s=!1);const a=t.getBoundingClientRect(),o=CI(t);let c=Sd(1);r&&(n?Hc(n)&&(c=$g(n)):c=$g(t));const i=hoe(o,s,n)?_9(o):Sd(0);let f=(a.left+i.x)/c.x,p=(a.top+i.y)/c.y,g=a.width/c.x,y=a.height/c.y;if(o){const b=yl(o),w=n&&Hc(n)?yl(n):n;let T=b,N=lM(T);for(;N&&n&&w!==T;){const M=$g(N),O=N.getBoundingClientRect(),C=Zc(N),D=O.left+(N.clientLeft+parseFloat(C.paddingLeft))*M.x,L=O.top+(N.clientTop+parseFloat(C.paddingTop))*M.y;f*=M.x,p*=M.y,g*=M.x,y*=M.y,f+=D,p+=L,T=yl(N),N=lM(T)}}return SS({width:g,height:y,x:f,y:p})}function PI(t,r){const s=CC(t).scrollLeft;return r?r.left+s:bp(Dd(t)).left+s}function w9(t,r,s){s===void 0&&(s=!1);const n=t.getBoundingClientRect(),a=n.left+r.scrollLeft-(s?0:PI(t,n)),o=n.top+r.scrollTop;return{x:a,y:o}}function moe(t){let{elements:r,rect:s,offsetParent:n,strategy:a}=t;const o=a==="fixed",c=Dd(n),i=r?SC(r.floating):!1;if(n===c||i&&o)return s;let f={scrollLeft:0,scrollTop:0},p=Sd(1);const g=Sd(0),y=Td(n);if((y||!y&&!o)&&((hv(n)!=="body"||E_(c))&&(f=CC(n)),Td(n))){const w=bp(n);p=$g(n),g.x=w.x+n.clientLeft,g.y=w.y+n.clientTop}const b=c&&!y&&!o?w9(c,f,!0):Sd(0);return{width:s.width*p.x,height:s.height*p.y,x:s.x*p.x-f.scrollLeft*p.x+g.x+b.x,y:s.y*p.y-f.scrollTop*p.y+g.y+b.y}}function foe(t){return Array.from(t.getClientRects())}function poe(t){const r=Dd(t),s=CC(t),n=t.ownerDocument.body,a=hl(r.scrollWidth,r.clientWidth,n.scrollWidth,n.clientWidth),o=hl(r.scrollHeight,r.clientHeight,n.scrollHeight,n.clientHeight);let c=-s.scrollLeft+PI(t);const i=-s.scrollTop;return Zc(n).direction==="rtl"&&(c+=hl(r.clientWidth,n.clientWidth)-a),{width:a,height:o,x:c,y:i}}function xoe(t,r){const s=yl(t),n=Dd(t),a=s.visualViewport;let o=n.clientWidth,c=n.clientHeight,i=0,f=0;if(a){o=a.width,c=a.height;const p=SI();(!p||p&&r==="fixed")&&(i=a.offsetLeft,f=a.offsetTop)}return{width:o,height:c,x:i,y:f}}function goe(t,r){const s=bp(t,!0,r==="fixed"),n=s.top+t.clientTop,a=s.left+t.clientLeft,o=Td(t)?$g(t):Sd(1),c=t.clientWidth*o.x,i=t.clientHeight*o.y,f=a*o.x,p=n*o.y;return{width:c,height:i,x:f,y:p}}function s5(t,r,s){let n;if(r==="viewport")n=xoe(t,s);else if(r==="document")n=poe(Dd(t));else if(Hc(r))n=goe(r,s);else{const a=_9(t);n={x:r.x-a.x,y:r.y-a.y,width:r.width,height:r.height}}return SS(n)}function N9(t,r){const s=Sm(t);return s===r||!Hc(s)||gy(s)?!1:Zc(s).position==="fixed"||N9(s,r)}function yoe(t,r){const s=r.get(t);if(s)return s;let n=Pb(t,[],!1).filter(i=>Hc(i)&&hv(i)!=="body"),a=null;const o=Zc(t).position==="fixed";let c=o?Sm(t):t;for(;Hc(c)&&!gy(c);){const i=Zc(c),f=NI(c);!f&&i.position==="fixed"&&(a=null),(o?!f&&!a:!f&&i.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||E_(c)&&!f&&N9(t,c))?n=n.filter(g=>g!==c):a=i,c=Sm(c)}return r.set(t,n),n}function voe(t){let{element:r,boundary:s,rootBoundary:n,strategy:a}=t;const c=[...s==="clippingAncestors"?SC(r)?[]:yoe(r,this._c):[].concat(s),n],i=c[0],f=c.reduce((p,g)=>{const y=s5(r,g,a);return p.top=hl(y.top,p.top),p.right=wm(y.right,p.right),p.bottom=wm(y.bottom,p.bottom),p.left=hl(y.left,p.left),p},s5(r,i,a));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}}function joe(t){const{width:r,height:s}=b9(t);return{width:r,height:s}}function boe(t,r,s){const n=Td(r),a=Dd(r),o=s==="fixed",c=bp(t,!0,o,r);let i={scrollLeft:0,scrollTop:0};const f=Sd(0);if(n||!n&&!o)if((hv(r)!=="body"||E_(a))&&(i=CC(r)),n){const b=bp(r,!0,o,r);f.x=b.x+r.clientLeft,f.y=b.y+r.clientTop}else a&&(f.x=PI(a));const p=a&&!n&&!o?w9(a,i):Sd(0),g=c.left+i.scrollLeft-f.x-p.x,y=c.top+i.scrollTop-f.y-p.y;return{x:g,y,width:c.width,height:c.height}}function TA(t){return Zc(t).position==="static"}function n5(t,r){if(!Td(t)||Zc(t).position==="fixed")return null;if(r)return r(t);let s=t.offsetParent;return Dd(t)===s&&(s=s.ownerDocument.body),s}function S9(t,r){const s=yl(t);if(SC(t))return s;if(!Td(t)){let a=Sm(t);for(;a&&!gy(a);){if(Hc(a)&&!TA(a))return a;a=Sm(a)}return s}let n=n5(t,r);for(;n&&coe(n)&&TA(n);)n=n5(n,r);return n&&gy(n)&&TA(n)&&!NI(n)?s:n||doe(t)||s}const _oe=async function(t){const r=this.getOffsetParent||S9,s=this.getDimensions,n=await s(t.floating);return{reference:boe(t.reference,await r(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function woe(t){return Zc(t).direction==="rtl"}const Noe={convertOffsetParentRelativeRectToViewportRelativeRect:moe,getDocumentElement:Dd,getClippingRect:voe,getOffsetParent:S9,getElementRects:_oe,getClientRects:foe,getDimensions:joe,getScale:$g,isElement:Hc,isRTL:woe};function Soe(t,r){let s=null,n;const a=Dd(t);function o(){var i;clearTimeout(n),(i=s)==null||i.disconnect(),s=null}function c(i,f){i===void 0&&(i=!1),f===void 0&&(f=1),o();const{left:p,top:g,width:y,height:b}=t.getBoundingClientRect();if(i||r(),!y||!b)return;const w=X1(g),T=X1(a.clientWidth-(p+y)),N=X1(a.clientHeight-(g+b)),M=X1(p),C={rootMargin:-w+"px "+-T+"px "+-N+"px "+-M+"px",threshold:hl(0,wm(1,f))||1};let D=!0;function L(F){const B=F[0].intersectionRatio;if(B!==f){if(!D)return c();B?c(!1,B):n=setTimeout(()=>{c(!1,1e-7)},1e3)}D=!1}try{s=new IntersectionObserver(L,{...C,root:a.ownerDocument})}catch{s=new IntersectionObserver(L,C)}s.observe(t)}return c(!0),o}function Coe(t,r,s,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:i=typeof IntersectionObserver=="function",animationFrame:f=!1}=n,p=CI(t),g=a||o?[...p?Pb(p):[],...Pb(r)]:[];g.forEach(O=>{a&&O.addEventListener("scroll",s,{passive:!0}),o&&O.addEventListener("resize",s)});const y=p&&i?Soe(p,s):null;let b=-1,w=null;c&&(w=new ResizeObserver(O=>{let[C]=O;C&&C.target===p&&w&&(w.unobserve(r),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var D;(D=w)==null||D.observe(r)})),s()}),p&&!f&&w.observe(p),w.observe(r));let T,N=f?bp(t):null;f&&M();function M(){const O=bp(t);N&&(O.x!==N.x||O.y!==N.y||O.width!==N.width||O.height!==N.height)&&s(),N=O,T=requestAnimationFrame(M)}return s(),()=>{var O;g.forEach(C=>{a&&C.removeEventListener("scroll",s),o&&C.removeEventListener("resize",s)}),y==null||y(),(O=w)==null||O.disconnect(),w=null,f&&cancelAnimationFrame(T)}}const Poe=aoe,koe=ioe,Aoe=roe,Toe=loe,Eoe=soe,a5=toe,Moe=ooe,Ooe=(t,r,s)=>{const n=new Map,a={platform:Noe,...s},o={...a.platform,_c:n};return eoe(t,r,{...a,platform:o})};var $N=typeof document<"u"?A.useLayoutEffect:A.useEffect;function CS(t,r){if(t===r)return!0;if(typeof t!=typeof r)return!1;if(typeof t=="function"&&t.toString()===r.toString())return!0;let s,n,a;if(t&&r&&typeof t=="object"){if(Array.isArray(t)){if(s=t.length,s!==r.length)return!1;for(n=s;n--!==0;)if(!CS(t[n],r[n]))return!1;return!0}if(a=Object.keys(t),s=a.length,s!==Object.keys(r).length)return!1;for(n=s;n--!==0;)if(!{}.hasOwnProperty.call(r,a[n]))return!1;for(n=s;n--!==0;){const o=a[n];if(!(o==="_owner"&&t.$$typeof)&&!CS(t[o],r[o]))return!1}return!0}return t!==t&&r!==r}function C9(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function i5(t,r){const s=C9(t);return Math.round(r*s)/s}function EA(t){const r=A.useRef(t);return $N(()=>{r.current=t}),r}function Ioe(t){t===void 0&&(t={});const{placement:r="bottom",strategy:s="absolute",middleware:n=[],platform:a,elements:{reference:o,floating:c}={},transform:i=!0,whileElementsMounted:f,open:p}=t,[g,y]=A.useState({x:0,y:0,strategy:s,placement:r,middlewareData:{},isPositioned:!1}),[b,w]=A.useState(n);CS(b,n)||w(n);const[T,N]=A.useState(null),[M,O]=A.useState(null),C=A.useCallback(be=>{be!==B.current&&(B.current=be,N(be))},[]),D=A.useCallback(be=>{be!==U.current&&(U.current=be,O(be))},[]),L=o||T,F=c||M,B=A.useRef(null),U=A.useRef(null),te=A.useRef(g),Q=f!=null,re=EA(f),Z=EA(a),ne=EA(p),oe=A.useCallback(()=>{if(!B.current||!U.current)return;const be={placement:r,strategy:s,middleware:b};Z.current&&(be.platform=Z.current),Ooe(B.current,U.current,be).then(de=>{const Ke={...de,isPositioned:ne.current!==!1};Ce.current&&!CS(te.current,Ke)&&(te.current=Ke,Rm.flushSync(()=>{y(Ke)}))})},[b,r,s,Z,ne]);$N(()=>{p===!1&&te.current.isPositioned&&(te.current.isPositioned=!1,y(be=>({...be,isPositioned:!1})))},[p]);const Ce=A.useRef(!1);$N(()=>(Ce.current=!0,()=>{Ce.current=!1}),[]),$N(()=>{if(L&&(B.current=L),F&&(U.current=F),L&&F){if(re.current)return re.current(L,F,oe);oe()}},[L,F,oe,re,Q]);const Pe=A.useMemo(()=>({reference:B,floating:U,setReference:C,setFloating:D}),[C,D]),Se=A.useMemo(()=>({reference:L,floating:F}),[L,F]),ae=A.useMemo(()=>{const be={position:s,left:0,top:0};if(!Se.floating)return be;const de=i5(Se.floating,g.x),Ke=i5(Se.floating,g.y);return i?{...be,transform:"translate("+de+"px, "+Ke+"px)",...C9(Se.floating)>=1.5&&{willChange:"transform"}}:{position:s,left:de,top:Ke}},[s,i,Se.floating,g.x,g.y]);return A.useMemo(()=>({...g,update:oe,refs:Pe,elements:Se,floatingStyles:ae}),[g,oe,Pe,Se,ae])}const Doe=t=>{function r(s){return{}.hasOwnProperty.call(s,"current")}return{name:"arrow",options:t,fn(s){const{element:n,padding:a}=typeof t=="function"?t(s):t;return n&&r(n)?n.current!=null?a5({element:n.current,padding:a}).fn(s):{}:n?a5({element:n,padding:a}).fn(s):{}}}},Roe=(t,r)=>({...Poe(t),options:[t,r]}),Loe=(t,r)=>({...koe(t),options:[t,r]}),Foe=(t,r)=>({...Moe(t),options:[t,r]}),$oe=(t,r)=>({...Aoe(t),options:[t,r]}),zoe=(t,r)=>({...Toe(t),options:[t,r]}),Boe=(t,r)=>({...Eoe(t),options:[t,r]}),qoe=(t,r)=>({...Doe(t),options:[t,r]});var Voe="Arrow",P9=A.forwardRef((t,r)=>{const{children:s,width:n=10,height:a=5,...o}=t;return e.jsx(Tr.svg,{...o,ref:r,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?s:e.jsx("polygon",{points:"0,0 30,0 15,10"})})});P9.displayName=Voe;var Uoe=P9;function Woe(t,r=[]){let s=[];function n(o,c){const i=A.createContext(c),f=s.length;s=[...s,c];function p(y){const{scope:b,children:w,...T}=y,N=(b==null?void 0:b[t][f])||i,M=A.useMemo(()=>T,Object.values(T));return e.jsx(N.Provider,{value:M,children:w})}function g(y,b){const w=(b==null?void 0:b[t][f])||i,T=A.useContext(w);if(T)return T;if(c!==void 0)return c;throw new Error(`\`${y}\` must be used within \`${o}\``)}return p.displayName=o+"Provider",[p,g]}const a=()=>{const o=s.map(c=>A.createContext(c));return function(i){const f=(i==null?void 0:i[t])||o;return A.useMemo(()=>({[`__scope${t}`]:{...i,[t]:f}}),[i,f])}};return a.scopeName=t,[n,Goe(a,...r)]}function Goe(...t){const r=t[0];if(t.length===1)return r;const s=()=>{const n=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(o){const c=n.reduce((i,{useScope:f,scopeName:p})=>{const y=f(o)[`__scope${p}`];return{...i,...y}},{});return A.useMemo(()=>({[`__scope${r.scopeName}`]:c}),[c])}};return s.scopeName=r.scopeName,s}function PC(t){const[r,s]=A.useState(void 0);return Hi(()=>{if(t){s({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const o=a[0];let c,i;if("borderBoxSize"in o){const f=o.borderBoxSize,p=Array.isArray(f)?f[0]:f;c=p.inlineSize,i=p.blockSize}else c=t.offsetWidth,i=t.offsetHeight;s({width:c,height:i})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else s(void 0)},[t]),r}var kI="Popper",[k9,mv]=Woe(kI),[Koe,A9]=k9(kI),T9=t=>{const{__scopePopper:r,children:s}=t,[n,a]=A.useState(null);return e.jsx(Koe,{scope:r,anchor:n,onAnchorChange:a,children:s})};T9.displayName=kI;var E9="PopperAnchor",M9=A.forwardRef((t,r)=>{const{__scopePopper:s,virtualRef:n,...a}=t,o=A9(E9,s),c=A.useRef(null),i=ls(r,c);return A.useEffect(()=>{o.onAnchorChange((n==null?void 0:n.current)||c.current)}),n?null:e.jsx(Tr.div,{...a,ref:i})});M9.displayName=E9;var AI="PopperContent",[Hoe,Zoe]=k9(AI),O9=A.forwardRef((t,r)=>{var Ct,ur,At,Ht,fr,vt;const{__scopePopper:s,side:n="bottom",sideOffset:a=0,align:o="center",alignOffset:c=0,arrowPadding:i=0,avoidCollisions:f=!0,collisionBoundary:p=[],collisionPadding:g=0,sticky:y="partial",hideWhenDetached:b=!1,updatePositionStrategy:w="optimized",onPlaced:T,...N}=t,M=A9(AI,s),[O,C]=A.useState(null),D=ls(r,Br=>C(Br)),[L,F]=A.useState(null),B=PC(L),U=(B==null?void 0:B.width)??0,te=(B==null?void 0:B.height)??0,Q=n+(o!=="center"?"-"+o:""),re=typeof g=="number"?g:{top:0,right:0,bottom:0,left:0,...g},Z=Array.isArray(p)?p:[p],ne=Z.length>0,oe={padding:re,boundary:Z.filter(Xoe),altBoundary:ne},{refs:Ce,floatingStyles:Pe,placement:Se,isPositioned:ae,middlewareData:be}=Ioe({strategy:"fixed",placement:Q,whileElementsMounted:(...Br)=>Coe(...Br,{animationFrame:w==="always"}),elements:{reference:M.anchor},middleware:[Roe({mainAxis:a+te,alignmentAxis:c}),f&&Loe({mainAxis:!0,crossAxis:!1,limiter:y==="partial"?Foe():void 0,...oe}),f&&$oe({...oe}),zoe({...oe,apply:({elements:Br,rects:vr,availableWidth:Xr,availableHeight:Dr})=>{const{width:As,height:xn}=vr.reference,Qs=Br.floating.style;Qs.setProperty("--radix-popper-available-width",`${Xr}px`),Qs.setProperty("--radix-popper-available-height",`${Dr}px`),Qs.setProperty("--radix-popper-anchor-width",`${As}px`),Qs.setProperty("--radix-popper-anchor-height",`${xn}px`)}}),L&&qoe({element:L,padding:i}),Qoe({arrowWidth:U,arrowHeight:te}),b&&Boe({strategy:"referenceHidden",...oe})]}),[de,Ke]=R9(Se),He=oi(T);Hi(()=>{ae&&(He==null||He())},[ae,He]);const Ve=(Ct=be.arrow)==null?void 0:Ct.x,yt=(ur=be.arrow)==null?void 0:ur.y,Et=((At=be.arrow)==null?void 0:At.centerOffset)!==0,[Rt,Vt]=A.useState();return Hi(()=>{O&&Vt(window.getComputedStyle(O).zIndex)},[O]),e.jsx("div",{ref:Ce.setFloating,"data-radix-popper-content-wrapper":"",style:{...Pe,transform:ae?Pe.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Rt,"--radix-popper-transform-origin":[(Ht=be.transformOrigin)==null?void 0:Ht.x,(fr=be.transformOrigin)==null?void 0:fr.y].join(" "),...((vt=be.hide)==null?void 0:vt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:e.jsx(Hoe,{scope:s,placedSide:de,onArrowChange:F,arrowX:Ve,arrowY:yt,shouldHideArrow:Et,children:e.jsx(Tr.div,{"data-side":de,"data-align":Ke,...N,ref:D,style:{...N.style,animation:ae?void 0:"none"}})})})});O9.displayName=AI;var I9="PopperArrow",Yoe={top:"bottom",right:"left",bottom:"top",left:"right"},D9=A.forwardRef(function(r,s){const{__scopePopper:n,...a}=r,o=Zoe(I9,n),c=Yoe[o.placedSide];return e.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[c]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:e.jsx(Uoe,{...a,ref:s,style:{...a.style,display:"block"}})})});D9.displayName=I9;function Xoe(t){return t!==null}var Qoe=t=>({name:"transformOrigin",options:t,fn(r){var M,O,C;const{placement:s,rects:n,middlewareData:a}=r,c=((M=a.arrow)==null?void 0:M.centerOffset)!==0,i=c?0:t.arrowWidth,f=c?0:t.arrowHeight,[p,g]=R9(s),y={start:"0%",center:"50%",end:"100%"}[g],b=(((O=a.arrow)==null?void 0:O.x)??0)+i/2,w=(((C=a.arrow)==null?void 0:C.y)??0)+f/2;let T="",N="";return p==="bottom"?(T=c?y:`${b}px`,N=`${-f}px`):p==="top"?(T=c?y:`${b}px`,N=`${n.floating.height+f}px`):p==="right"?(T=`${-f}px`,N=c?y:`${w}px`):p==="left"&&(T=`${n.floating.width+f}px`,N=c?y:`${w}px`),{data:{x:T,y:N}}}});function R9(t){const[r,s="center"]=t.split("-");return[r,s]}var TI=T9,kC=M9,EI=O9,MI=D9,Joe="Portal",M_=A.forwardRef((t,r)=>{var i;const{container:s,...n}=t,[a,o]=A.useState(!1);Hi(()=>o(!0),[]);const c=s||a&&((i=globalThis==null?void 0:globalThis.document)==null?void 0:i.body);return c?yU.createPortal(e.jsx(Tr.div,{...n,ref:r}),c):null});M_.displayName=Joe;function Yc({prop:t,defaultProp:r,onChange:s=()=>{}}){const[n,a]=ele({defaultProp:r,onChange:s}),o=t!==void 0,c=o?t:n,i=oi(s),f=A.useCallback(p=>{if(o){const y=typeof p=="function"?p(t):p;y!==t&&i(y)}else a(p)},[o,t,a,i]);return[c,f]}function ele({defaultProp:t,onChange:r}){const s=A.useState(t),[n]=s,a=A.useRef(n),o=oi(r);return A.useEffect(()=>{a.current!==n&&(o(n),a.current=n)},[n,a,o]),s}function AC(t){const r=A.useRef({value:t,previous:t});return A.useMemo(()=>(r.current.value!==t&&(r.current.previous=r.current.value,r.current.value=t),r.current.previous),[t])}var tle="VisuallyHidden",L9=A.forwardRef((t,r)=>e.jsx(Tr.span,{...t,ref:r,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));L9.displayName=tle;var rle=function(t){if(typeof document>"u")return null;var r=Array.isArray(t)?t[0]:t;return r.ownerDocument.body},Qx=new WeakMap,Q1=new WeakMap,J1={},MA=0,F9=function(t){return t&&(t.host||F9(t.parentNode))},sle=function(t,r){return r.map(function(s){if(t.contains(s))return s;var n=F9(s);return n&&t.contains(n)?n:(console.error("aria-hidden",s,"in not contained inside",t,". Doing nothing"),null)}).filter(function(s){return!!s})},nle=function(t,r,s,n){var a=sle(r,Array.isArray(t)?t:[t]);J1[s]||(J1[s]=new WeakMap);var o=J1[s],c=[],i=new Set,f=new Set(a),p=function(y){!y||i.has(y)||(i.add(y),p(y.parentNode))};a.forEach(p);var g=function(y){!y||f.has(y)||Array.prototype.forEach.call(y.children,function(b){if(i.has(b))g(b);else try{var w=b.getAttribute(n),T=w!==null&&w!=="false",N=(Qx.get(b)||0)+1,M=(o.get(b)||0)+1;Qx.set(b,N),o.set(b,M),c.push(b),N===1&&T&&Q1.set(b,!0),M===1&&b.setAttribute(s,"true"),T||b.setAttribute(n,"true")}catch(O){console.error("aria-hidden: cannot operate on ",b,O)}})};return g(r),i.clear(),MA++,function(){c.forEach(function(y){var b=Qx.get(y)-1,w=o.get(y)-1;Qx.set(y,b),o.set(y,w),b||(Q1.has(y)||y.removeAttribute(n),Q1.delete(y)),w||y.removeAttribute(s)}),MA--,MA||(Qx=new WeakMap,Qx=new WeakMap,Q1=new WeakMap,J1={})}},TC=function(t,r,s){s===void 0&&(s="data-aria-hidden");var n=Array.from(Array.isArray(t)?t:[t]),a=rle(t);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live]"))),nle(n,a,s,"aria-hidden")):function(){return null}},vd=function(){return vd=Object.assign||function(r){for(var s,n=1,a=arguments.length;n<a;n++){s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(r[o]=s[o])}return r},vd.apply(this,arguments)};function $9(t,r){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(s[n[a]]=t[n[a]]);return s}function ale(t,r,s){if(s||arguments.length===2)for(var n=0,a=r.length,o;n<a;n++)(o||!(n in r))&&(o||(o=Array.prototype.slice.call(r,0,n)),o[n]=r[n]);return t.concat(o||Array.prototype.slice.call(r))}var zN="right-scroll-bar-position",BN="width-before-scroll-bar",ile="with-scroll-bars-hidden",ole="--removed-body-scroll-bar-size";function OA(t,r){return typeof t=="function"?t(r):t&&(t.current=r),t}function lle(t,r){var s=A.useState(function(){return{value:t,callback:r,facade:{get current(){return s.value},set current(n){var a=s.value;a!==n&&(s.value=n,s.callback(n,a))}}}})[0];return s.callback=r,s.facade}var cle=typeof window<"u"?A.useLayoutEffect:A.useEffect,o5=new WeakMap;function dle(t,r){var s=lle(null,function(n){return t.forEach(function(a){return OA(a,n)})});return cle(function(){var n=o5.get(s);if(n){var a=new Set(n),o=new Set(t),c=s.current;a.forEach(function(i){o.has(i)||OA(i,null)}),o.forEach(function(i){a.has(i)||OA(i,c)})}o5.set(s,t)},[t]),s}function ule(t){return t}function hle(t,r){r===void 0&&(r=ule);var s=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return s.length?s[s.length-1]:t},useMedium:function(o){var c=r(o,n);return s.push(c),function(){s=s.filter(function(i){return i!==c})}},assignSyncMedium:function(o){for(n=!0;s.length;){var c=s;s=[],c.forEach(o)}s={push:function(i){return o(i)},filter:function(){return s}}},assignMedium:function(o){n=!0;var c=[];if(s.length){var i=s;s=[],i.forEach(o),c=s}var f=function(){var g=c;c=[],g.forEach(o)},p=function(){return Promise.resolve().then(f)};p(),s={push:function(g){c.push(g),p()},filter:function(g){return c=c.filter(g),s}}}};return a}function mle(t){t===void 0&&(t={});var r=hle(null);return r.options=vd({async:!0,ssr:!1},t),r}var z9=function(t){var r=t.sideCar,s=$9(t,["sideCar"]);if(!r)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=r.read();if(!n)throw new Error("Sidecar medium not found");return A.createElement(n,vd({},s))};z9.isSideCarExport=!0;function fle(t,r){return t.useMedium(r),z9}var B9=mle(),IA=function(){},EC=A.forwardRef(function(t,r){var s=A.useRef(null),n=A.useState({onScrollCapture:IA,onWheelCapture:IA,onTouchMoveCapture:IA}),a=n[0],o=n[1],c=t.forwardProps,i=t.children,f=t.className,p=t.removeScrollBar,g=t.enabled,y=t.shards,b=t.sideCar,w=t.noIsolation,T=t.inert,N=t.allowPinchZoom,M=t.as,O=M===void 0?"div":M,C=t.gapMode,D=$9(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),L=b,F=dle([s,r]),B=vd(vd({},D),a);return A.createElement(A.Fragment,null,g&&A.createElement(L,{sideCar:B9,removeScrollBar:p,shards:y,noIsolation:w,inert:T,setCallbacks:o,allowPinchZoom:!!N,lockRef:s,gapMode:C}),c?A.cloneElement(A.Children.only(i),vd(vd({},B),{ref:F})):A.createElement(O,vd({},B,{className:f,ref:F}),i))});EC.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};EC.classNames={fullWidth:BN,zeroRight:zN};var ple=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function xle(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var r=ple();return r&&t.setAttribute("nonce",r),t}function gle(t,r){t.styleSheet?t.styleSheet.cssText=r:t.appendChild(document.createTextNode(r))}function yle(t){var r=document.head||document.getElementsByTagName("head")[0];r.appendChild(t)}var vle=function(){var t=0,r=null;return{add:function(s){t==0&&(r=xle())&&(gle(r,s),yle(r)),t++},remove:function(){t--,!t&&r&&(r.parentNode&&r.parentNode.removeChild(r),r=null)}}},jle=function(){var t=vle();return function(r,s){A.useEffect(function(){return t.add(r),function(){t.remove()}},[r&&s])}},q9=function(){var t=jle(),r=function(s){var n=s.styles,a=s.dynamic;return t(n,a),null};return r},ble={left:0,top:0,right:0,gap:0},DA=function(t){return parseInt(t||"",10)||0},_le=function(t){var r=window.getComputedStyle(document.body),s=r[t==="padding"?"paddingLeft":"marginLeft"],n=r[t==="padding"?"paddingTop":"marginTop"],a=r[t==="padding"?"paddingRight":"marginRight"];return[DA(s),DA(n),DA(a)]},wle=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return ble;var r=_le(t),s=document.documentElement.clientWidth,n=window.innerWidth;return{left:r[0],top:r[1],right:r[2],gap:Math.max(0,n-s+r[2]-r[0])}},Nle=q9(),zg="data-scroll-locked",Sle=function(t,r,s,n){var a=t.left,o=t.top,c=t.right,i=t.gap;return s===void 0&&(s="margin"),`
  .`.concat(ile,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(i,"px ").concat(n,`;
  }
  body[`).concat(zg,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([r&&"position: relative ".concat(n,";"),s==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(c,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(i,"px ").concat(n,`;
    `),s==="padding"&&"padding-right: ".concat(i,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(zN,` {
    right: `).concat(i,"px ").concat(n,`;
  }
  
  .`).concat(BN,` {
    margin-right: `).concat(i,"px ").concat(n,`;
  }
  
  .`).concat(zN," .").concat(zN,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(BN," .").concat(BN,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(zg,`] {
    `).concat(ole,": ").concat(i,`px;
  }
`)},l5=function(){var t=parseInt(document.body.getAttribute(zg)||"0",10);return isFinite(t)?t:0},Cle=function(){A.useEffect(function(){return document.body.setAttribute(zg,(l5()+1).toString()),function(){var t=l5()-1;t<=0?document.body.removeAttribute(zg):document.body.setAttribute(zg,t.toString())}},[])},Ple=function(t){var r=t.noRelative,s=t.noImportant,n=t.gapMode,a=n===void 0?"margin":n;Cle();var o=A.useMemo(function(){return wle(a)},[a]);return A.createElement(Nle,{styles:Sle(o,!r,a,s?"":"!important")})},cM=!1;if(typeof window<"u")try{var eN=Object.defineProperty({},"passive",{get:function(){return cM=!0,!0}});window.addEventListener("test",eN,eN),window.removeEventListener("test",eN,eN)}catch{cM=!1}var Jx=cM?{passive:!1}:!1,kle=function(t){return t.tagName==="TEXTAREA"},V9=function(t,r){if(!(t instanceof Element))return!1;var s=window.getComputedStyle(t);return s[r]!=="hidden"&&!(s.overflowY===s.overflowX&&!kle(t)&&s[r]==="visible")},Ale=function(t){return V9(t,"overflowY")},Tle=function(t){return V9(t,"overflowX")},c5=function(t,r){var s=r.ownerDocument,n=r;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=U9(t,n);if(a){var o=W9(t,n),c=o[1],i=o[2];if(c>i)return!0}n=n.parentNode}while(n&&n!==s.body);return!1},Ele=function(t){var r=t.scrollTop,s=t.scrollHeight,n=t.clientHeight;return[r,s,n]},Mle=function(t){var r=t.scrollLeft,s=t.scrollWidth,n=t.clientWidth;return[r,s,n]},U9=function(t,r){return t==="v"?Ale(r):Tle(r)},W9=function(t,r){return t==="v"?Ele(r):Mle(r)},Ole=function(t,r){return t==="h"&&r==="rtl"?-1:1},Ile=function(t,r,s,n,a){var o=Ole(t,window.getComputedStyle(r).direction),c=o*n,i=s.target,f=r.contains(i),p=!1,g=c>0,y=0,b=0;do{var w=W9(t,i),T=w[0],N=w[1],M=w[2],O=N-M-o*T;(T||O)&&U9(t,i)&&(y+=O,b+=T),i instanceof ShadowRoot?i=i.host:i=i.parentNode}while(!f&&i!==document.body||f&&(r.contains(i)||r===i));return(g&&Math.abs(y)<1||!g&&Math.abs(b)<1)&&(p=!0),p},tN=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},d5=function(t){return[t.deltaX,t.deltaY]},u5=function(t){return t&&"current"in t?t.current:t},Dle=function(t,r){return t[0]===r[0]&&t[1]===r[1]},Rle=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},Lle=0,eg=[];function Fle(t){var r=A.useRef([]),s=A.useRef([0,0]),n=A.useRef(),a=A.useState(Lle++)[0],o=A.useState(q9)[0],c=A.useRef(t);A.useEffect(function(){c.current=t},[t]),A.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(a));var N=ale([t.lockRef.current],(t.shards||[]).map(u5),!0).filter(Boolean);return N.forEach(function(M){return M.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),N.forEach(function(M){return M.classList.remove("allow-interactivity-".concat(a))})}}},[t.inert,t.lockRef.current,t.shards]);var i=A.useCallback(function(N,M){if("touches"in N&&N.touches.length===2||N.type==="wheel"&&N.ctrlKey)return!c.current.allowPinchZoom;var O=tN(N),C=s.current,D="deltaX"in N?N.deltaX:C[0]-O[0],L="deltaY"in N?N.deltaY:C[1]-O[1],F,B=N.target,U=Math.abs(D)>Math.abs(L)?"h":"v";if("touches"in N&&U==="h"&&B.type==="range")return!1;var te=c5(U,B);if(!te)return!0;if(te?F=U:(F=U==="v"?"h":"v",te=c5(U,B)),!te)return!1;if(!n.current&&"changedTouches"in N&&(D||L)&&(n.current=F),!F)return!0;var Q=n.current||F;return Ile(Q,M,N,Q==="h"?D:L)},[]),f=A.useCallback(function(N){var M=N;if(!(!eg.length||eg[eg.length-1]!==o)){var O="deltaY"in M?d5(M):tN(M),C=r.current.filter(function(F){return F.name===M.type&&(F.target===M.target||M.target===F.shadowParent)&&Dle(F.delta,O)})[0];if(C&&C.should){M.cancelable&&M.preventDefault();return}if(!C){var D=(c.current.shards||[]).map(u5).filter(Boolean).filter(function(F){return F.contains(M.target)}),L=D.length>0?i(M,D[0]):!c.current.noIsolation;L&&M.cancelable&&M.preventDefault()}}},[]),p=A.useCallback(function(N,M,O,C){var D={name:N,delta:M,target:O,should:C,shadowParent:$le(O)};r.current.push(D),setTimeout(function(){r.current=r.current.filter(function(L){return L!==D})},1)},[]),g=A.useCallback(function(N){s.current=tN(N),n.current=void 0},[]),y=A.useCallback(function(N){p(N.type,d5(N),N.target,i(N,t.lockRef.current))},[]),b=A.useCallback(function(N){p(N.type,tN(N),N.target,i(N,t.lockRef.current))},[]);A.useEffect(function(){return eg.push(o),t.setCallbacks({onScrollCapture:y,onWheelCapture:y,onTouchMoveCapture:b}),document.addEventListener("wheel",f,Jx),document.addEventListener("touchmove",f,Jx),document.addEventListener("touchstart",g,Jx),function(){eg=eg.filter(function(N){return N!==o}),document.removeEventListener("wheel",f,Jx),document.removeEventListener("touchmove",f,Jx),document.removeEventListener("touchstart",g,Jx)}},[]);var w=t.removeScrollBar,T=t.inert;return A.createElement(A.Fragment,null,T?A.createElement(o,{styles:Rle(a)}):null,w?A.createElement(Ple,{gapMode:t.gapMode}):null)}function $le(t){for(var r=null;t!==null;)t instanceof ShadowRoot&&(r=t.host,t=t.host),t=t.parentNode;return r}const zle=fle(B9,Fle);var O_=A.forwardRef(function(t,r){return A.createElement(EC,vd({},t,{ref:r,sideCar:zle}))});O_.classNames=EC.classNames;var Ble=[" ","Enter","ArrowUp","ArrowDown"],qle=[" ","Enter"],I_="Select",[MC,OC,Vle]=_C(I_),[fv]=tc(I_,[Vle,mv]),IC=mv(),[Ule,$m]=fv(I_),[Wle,Gle]=fv(I_),G9=t=>{const{__scopeSelect:r,children:s,open:n,defaultOpen:a,onOpenChange:o,value:c,defaultValue:i,onValueChange:f,dir:p,name:g,autoComplete:y,disabled:b,required:w,form:T}=t,N=IC(r),[M,O]=A.useState(null),[C,D]=A.useState(null),[L,F]=A.useState(!1),B=dv(p),[U=!1,te]=Yc({prop:n,defaultProp:a,onChange:o}),[Q,re]=Yc({prop:c,defaultProp:i,onChange:f}),Z=A.useRef(null),ne=M?T||!!M.closest("form"):!0,[oe,Ce]=A.useState(new Set),Pe=Array.from(oe).map(Se=>Se.props.value).join(";");return e.jsx(TI,{...N,children:e.jsxs(Ule,{required:w,scope:r,trigger:M,onTriggerChange:O,valueNode:C,onValueNodeChange:D,valueNodeHasChildren:L,onValueNodeHasChildrenChange:F,contentId:Pi(),value:Q,onValueChange:re,open:U,onOpenChange:te,dir:B,triggerPointerDownPosRef:Z,disabled:b,children:[e.jsx(MC.Provider,{scope:r,children:e.jsx(Wle,{scope:t.__scopeSelect,onNativeOptionAdd:A.useCallback(Se=>{Ce(ae=>new Set(ae).add(Se))},[]),onNativeOptionRemove:A.useCallback(Se=>{Ce(ae=>{const be=new Set(ae);return be.delete(Se),be})},[]),children:s})}),ne?e.jsxs(gW,{"aria-hidden":!0,required:w,tabIndex:-1,name:g,autoComplete:y,value:Q,onChange:Se=>re(Se.target.value),disabled:b,form:T,children:[Q===void 0?e.jsx("option",{value:""}):null,Array.from(oe)]},Pe):null]})})};G9.displayName=I_;var K9="SelectTrigger",H9=A.forwardRef((t,r)=>{const{__scopeSelect:s,disabled:n=!1,...a}=t,o=IC(s),c=$m(K9,s),i=c.disabled||n,f=ls(r,c.onTriggerChange),p=OC(s),g=A.useRef("touch"),[y,b,w]=yW(N=>{const M=p().filter(D=>!D.disabled),O=M.find(D=>D.value===c.value),C=vW(M,N,O);C!==void 0&&c.onValueChange(C.value)}),T=N=>{i||(c.onOpenChange(!0),w()),N&&(c.triggerPointerDownPosRef.current={x:Math.round(N.pageX),y:Math.round(N.pageY)})};return e.jsx(kC,{asChild:!0,...o,children:e.jsx(Tr.button,{type:"button",role:"combobox","aria-controls":c.contentId,"aria-expanded":c.open,"aria-required":c.required,"aria-autocomplete":"none",dir:c.dir,"data-state":c.open?"open":"closed",disabled:i,"data-disabled":i?"":void 0,"data-placeholder":xW(c.value)?"":void 0,...a,ref:f,onClick:gr(a.onClick,N=>{N.currentTarget.focus(),g.current!=="mouse"&&T(N)}),onPointerDown:gr(a.onPointerDown,N=>{g.current=N.pointerType;const M=N.target;M.hasPointerCapture(N.pointerId)&&M.releasePointerCapture(N.pointerId),N.button===0&&N.ctrlKey===!1&&N.pointerType==="mouse"&&(T(N),N.preventDefault())}),onKeyDown:gr(a.onKeyDown,N=>{const M=y.current!=="";!(N.ctrlKey||N.altKey||N.metaKey)&&N.key.length===1&&b(N.key),!(M&&N.key===" ")&&Ble.includes(N.key)&&(T(),N.preventDefault())})})})});H9.displayName=K9;var Z9="SelectValue",Y9=A.forwardRef((t,r)=>{const{__scopeSelect:s,className:n,style:a,children:o,placeholder:c="",...i}=t,f=$m(Z9,s),{onValueNodeHasChildrenChange:p}=f,g=o!==void 0,y=ls(r,f.onValueNodeChange);return Hi(()=>{p(g)},[p,g]),e.jsx(Tr.span,{...i,ref:y,style:{pointerEvents:"none"},children:xW(f.value)?e.jsx(e.Fragment,{children:c}):o})});Y9.displayName=Z9;var Kle="SelectIcon",X9=A.forwardRef((t,r)=>{const{__scopeSelect:s,children:n,...a}=t;return e.jsx(Tr.span,{"aria-hidden":!0,...a,ref:r,children:n||""})});X9.displayName=Kle;var Hle="SelectPortal",Q9=t=>e.jsx(M_,{asChild:!0,...t});Q9.displayName=Hle;var _p="SelectContent",J9=A.forwardRef((t,r)=>{const s=$m(_p,t.__scopeSelect),[n,a]=A.useState();if(Hi(()=>{a(new DocumentFragment)},[]),!s.open){const o=n;return o?Rm.createPortal(e.jsx(eW,{scope:t.__scopeSelect,children:e.jsx(MC.Slot,{scope:t.__scopeSelect,children:e.jsx("div",{children:t.children})})}),o):null}return e.jsx(tW,{...t,ref:r})});J9.displayName=_p;var Sc=10,[eW,zm]=fv(_p),Zle="SelectContentImpl",tW=A.forwardRef((t,r)=>{const{__scopeSelect:s,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:o,onPointerDownOutside:c,side:i,sideOffset:f,align:p,alignOffset:g,arrowPadding:y,collisionBoundary:b,collisionPadding:w,sticky:T,hideWhenDetached:N,avoidCollisions:M,...O}=t,C=$m(_p,s),[D,L]=A.useState(null),[F,B]=A.useState(null),U=ls(r,Ct=>L(Ct)),[te,Q]=A.useState(null),[re,Z]=A.useState(null),ne=OC(s),[oe,Ce]=A.useState(!1),Pe=A.useRef(!1);A.useEffect(()=>{if(D)return TC(D)},[D]),wC();const Se=A.useCallback(Ct=>{const[ur,...At]=ne().map(vt=>vt.ref.current),[Ht]=At.slice(-1),fr=document.activeElement;for(const vt of Ct)if(vt===fr||(vt==null||vt.scrollIntoView({block:"nearest"}),vt===ur&&F&&(F.scrollTop=0),vt===Ht&&F&&(F.scrollTop=F.scrollHeight),vt==null||vt.focus(),document.activeElement!==fr))return},[ne,F]),ae=A.useCallback(()=>Se([te,D]),[Se,te,D]);A.useEffect(()=>{oe&&ae()},[oe,ae]);const{onOpenChange:be,triggerPointerDownPosRef:de}=C;A.useEffect(()=>{if(D){let Ct={x:0,y:0};const ur=Ht=>{var fr,vt;Ct={x:Math.abs(Math.round(Ht.pageX)-(((fr=de.current)==null?void 0:fr.x)??0)),y:Math.abs(Math.round(Ht.pageY)-(((vt=de.current)==null?void 0:vt.y)??0))}},At=Ht=>{Ct.x<=10&&Ct.y<=10?Ht.preventDefault():D.contains(Ht.target)||be(!1),document.removeEventListener("pointermove",ur),de.current=null};return de.current!==null&&(document.addEventListener("pointermove",ur),document.addEventListener("pointerup",At,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ur),document.removeEventListener("pointerup",At,{capture:!0})}}},[D,be,de]),A.useEffect(()=>{const Ct=()=>be(!1);return window.addEventListener("blur",Ct),window.addEventListener("resize",Ct),()=>{window.removeEventListener("blur",Ct),window.removeEventListener("resize",Ct)}},[be]);const[Ke,He]=yW(Ct=>{const ur=ne().filter(fr=>!fr.disabled),At=ur.find(fr=>fr.ref.current===document.activeElement),Ht=vW(ur,Ct,At);Ht&&setTimeout(()=>Ht.ref.current.focus())}),Ve=A.useCallback((Ct,ur,At)=>{const Ht=!Pe.current&&!At;(C.value!==void 0&&C.value===ur||Ht)&&(Q(Ct),Ht&&(Pe.current=!0))},[C.value]),yt=A.useCallback(()=>D==null?void 0:D.focus(),[D]),Et=A.useCallback((Ct,ur,At)=>{const Ht=!Pe.current&&!At;(C.value!==void 0&&C.value===ur||Ht)&&Z(Ct)},[C.value]),Rt=n==="popper"?dM:rW,Vt=Rt===dM?{side:i,sideOffset:f,align:p,alignOffset:g,arrowPadding:y,collisionBoundary:b,collisionPadding:w,sticky:T,hideWhenDetached:N,avoidCollisions:M}:{};return e.jsx(eW,{scope:s,content:D,viewport:F,onViewportChange:B,itemRefCallback:Ve,selectedItem:te,onItemLeave:yt,itemTextRefCallback:Et,focusSelectedItem:ae,selectedItemText:re,position:n,isPositioned:oe,searchRef:Ke,children:e.jsx(O_,{as:Ad,allowPinchZoom:!0,children:e.jsx(T_,{asChild:!0,trapped:C.open,onMountAutoFocus:Ct=>{Ct.preventDefault()},onUnmountAutoFocus:gr(a,Ct=>{var ur;(ur=C.trigger)==null||ur.focus({preventScroll:!0}),Ct.preventDefault()}),children:e.jsx(A_,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:c,onFocusOutside:Ct=>Ct.preventDefault(),onDismiss:()=>C.onOpenChange(!1),children:e.jsx(Rt,{role:"listbox",id:C.contentId,"data-state":C.open?"open":"closed",dir:C.dir,onContextMenu:Ct=>Ct.preventDefault(),...O,...Vt,onPlaced:()=>Ce(!0),ref:U,style:{display:"flex",flexDirection:"column",outline:"none",...O.style},onKeyDown:gr(O.onKeyDown,Ct=>{const ur=Ct.ctrlKey||Ct.altKey||Ct.metaKey;if(Ct.key==="Tab"&&Ct.preventDefault(),!ur&&Ct.key.length===1&&He(Ct.key),["ArrowUp","ArrowDown","Home","End"].includes(Ct.key)){let Ht=ne().filter(fr=>!fr.disabled).map(fr=>fr.ref.current);if(["ArrowUp","End"].includes(Ct.key)&&(Ht=Ht.slice().reverse()),["ArrowUp","ArrowDown"].includes(Ct.key)){const fr=Ct.target,vt=Ht.indexOf(fr);Ht=Ht.slice(vt+1)}setTimeout(()=>Se(Ht)),Ct.preventDefault()}})})})})})})});tW.displayName=Zle;var Yle="SelectItemAlignedPosition",rW=A.forwardRef((t,r)=>{const{__scopeSelect:s,onPlaced:n,...a}=t,o=$m(_p,s),c=zm(_p,s),[i,f]=A.useState(null),[p,g]=A.useState(null),y=ls(r,U=>g(U)),b=OC(s),w=A.useRef(!1),T=A.useRef(!0),{viewport:N,selectedItem:M,selectedItemText:O,focusSelectedItem:C}=c,D=A.useCallback(()=>{if(o.trigger&&o.valueNode&&i&&p&&N&&M&&O){const U=o.trigger.getBoundingClientRect(),te=p.getBoundingClientRect(),Q=o.valueNode.getBoundingClientRect(),re=O.getBoundingClientRect();if(o.dir!=="rtl"){const fr=re.left-te.left,vt=Q.left-fr,Br=U.left-vt,vr=U.width+Br,Xr=Math.max(vr,te.width),Dr=window.innerWidth-Sc,As=Sb(vt,[Sc,Math.max(Sc,Dr-Xr)]);i.style.minWidth=vr+"px",i.style.left=As+"px"}else{const fr=te.right-re.right,vt=window.innerWidth-Q.right-fr,Br=window.innerWidth-U.right-vt,vr=U.width+Br,Xr=Math.max(vr,te.width),Dr=window.innerWidth-Sc,As=Sb(vt,[Sc,Math.max(Sc,Dr-Xr)]);i.style.minWidth=vr+"px",i.style.right=As+"px"}const Z=b(),ne=window.innerHeight-Sc*2,oe=N.scrollHeight,Ce=window.getComputedStyle(p),Pe=parseInt(Ce.borderTopWidth,10),Se=parseInt(Ce.paddingTop,10),ae=parseInt(Ce.borderBottomWidth,10),be=parseInt(Ce.paddingBottom,10),de=Pe+Se+oe+be+ae,Ke=Math.min(M.offsetHeight*5,de),He=window.getComputedStyle(N),Ve=parseInt(He.paddingTop,10),yt=parseInt(He.paddingBottom,10),Et=U.top+U.height/2-Sc,Rt=ne-Et,Vt=M.offsetHeight/2,Ct=M.offsetTop+Vt,ur=Pe+Se+Ct,At=de-ur;if(ur<=Et){const fr=Z.length>0&&M===Z[Z.length-1].ref.current;i.style.bottom="0px";const vt=p.clientHeight-N.offsetTop-N.offsetHeight,Br=Math.max(Rt,Vt+(fr?yt:0)+vt+ae),vr=ur+Br;i.style.height=vr+"px"}else{const fr=Z.length>0&&M===Z[0].ref.current;i.style.top="0px";const Br=Math.max(Et,Pe+N.offsetTop+(fr?Ve:0)+Vt)+At;i.style.height=Br+"px",N.scrollTop=ur-Et+N.offsetTop}i.style.margin=`${Sc}px 0`,i.style.minHeight=Ke+"px",i.style.maxHeight=ne+"px",n==null||n(),requestAnimationFrame(()=>w.current=!0)}},[b,o.trigger,o.valueNode,i,p,N,M,O,o.dir,n]);Hi(()=>D(),[D]);const[L,F]=A.useState();Hi(()=>{p&&F(window.getComputedStyle(p).zIndex)},[p]);const B=A.useCallback(U=>{U&&T.current===!0&&(D(),C==null||C(),T.current=!1)},[D,C]);return e.jsx(Qle,{scope:s,contentWrapper:i,shouldExpandOnScrollRef:w,onScrollButtonChange:B,children:e.jsx("div",{ref:f,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:L},children:e.jsx(Tr.div,{...a,ref:y,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});rW.displayName=Yle;var Xle="SelectPopperPosition",dM=A.forwardRef((t,r)=>{const{__scopeSelect:s,align:n="start",collisionPadding:a=Sc,...o}=t,c=IC(s);return e.jsx(EI,{...c,...o,ref:r,align:n,collisionPadding:a,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});dM.displayName=Xle;var[Qle,OI]=fv(_p,{}),uM="SelectViewport",sW=A.forwardRef((t,r)=>{const{__scopeSelect:s,nonce:n,...a}=t,o=zm(uM,s),c=OI(uM,s),i=ls(r,o.onViewportChange),f=A.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),e.jsx(MC.Slot,{scope:s,children:e.jsx(Tr.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:i,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:gr(a.onScroll,p=>{const g=p.currentTarget,{contentWrapper:y,shouldExpandOnScrollRef:b}=c;if(b!=null&&b.current&&y){const w=Math.abs(f.current-g.scrollTop);if(w>0){const T=window.innerHeight-Sc*2,N=parseFloat(y.style.minHeight),M=parseFloat(y.style.height),O=Math.max(N,M);if(O<T){const C=O+w,D=Math.min(T,C),L=C-D;y.style.height=D+"px",y.style.bottom==="0px"&&(g.scrollTop=L>0?L:0,y.style.justifyContent="flex-end")}}}f.current=g.scrollTop})})})]})});sW.displayName=uM;var nW="SelectGroup",[Jle,ece]=fv(nW),tce=A.forwardRef((t,r)=>{const{__scopeSelect:s,...n}=t,a=Pi();return e.jsx(Jle,{scope:s,id:a,children:e.jsx(Tr.div,{role:"group","aria-labelledby":a,...n,ref:r})})});tce.displayName=nW;var aW="SelectLabel",iW=A.forwardRef((t,r)=>{const{__scopeSelect:s,...n}=t,a=ece(aW,s);return e.jsx(Tr.div,{id:a.id,...n,ref:r})});iW.displayName=aW;var PS="SelectItem",[rce,oW]=fv(PS),lW=A.forwardRef((t,r)=>{const{__scopeSelect:s,value:n,disabled:a=!1,textValue:o,...c}=t,i=$m(PS,s),f=zm(PS,s),p=i.value===n,[g,y]=A.useState(o??""),[b,w]=A.useState(!1),T=ls(r,C=>{var D;return(D=f.itemRefCallback)==null?void 0:D.call(f,C,n,a)}),N=Pi(),M=A.useRef("touch"),O=()=>{a||(i.onValueChange(n),i.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(rce,{scope:s,value:n,disabled:a,textId:N,isSelected:p,onItemTextChange:A.useCallback(C=>{y(D=>D||((C==null?void 0:C.textContent)??"").trim())},[]),children:e.jsx(MC.ItemSlot,{scope:s,value:n,disabled:a,textValue:g,children:e.jsx(Tr.div,{role:"option","aria-labelledby":N,"data-highlighted":b?"":void 0,"aria-selected":p&&b,"data-state":p?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...c,ref:T,onFocus:gr(c.onFocus,()=>w(!0)),onBlur:gr(c.onBlur,()=>w(!1)),onClick:gr(c.onClick,()=>{M.current!=="mouse"&&O()}),onPointerUp:gr(c.onPointerUp,()=>{M.current==="mouse"&&O()}),onPointerDown:gr(c.onPointerDown,C=>{M.current=C.pointerType}),onPointerMove:gr(c.onPointerMove,C=>{var D;M.current=C.pointerType,a?(D=f.onItemLeave)==null||D.call(f):M.current==="mouse"&&C.currentTarget.focus({preventScroll:!0})}),onPointerLeave:gr(c.onPointerLeave,C=>{var D;C.currentTarget===document.activeElement&&((D=f.onItemLeave)==null||D.call(f))}),onKeyDown:gr(c.onKeyDown,C=>{var L;((L=f.searchRef)==null?void 0:L.current)!==""&&C.key===" "||(qle.includes(C.key)&&O(),C.key===" "&&C.preventDefault())})})})})});lW.displayName=PS;var E0="SelectItemText",cW=A.forwardRef((t,r)=>{const{__scopeSelect:s,className:n,style:a,...o}=t,c=$m(E0,s),i=zm(E0,s),f=oW(E0,s),p=Gle(E0,s),[g,y]=A.useState(null),b=ls(r,O=>y(O),f.onItemTextChange,O=>{var C;return(C=i.itemTextRefCallback)==null?void 0:C.call(i,O,f.value,f.disabled)}),w=g==null?void 0:g.textContent,T=A.useMemo(()=>e.jsx("option",{value:f.value,disabled:f.disabled,children:w},f.value),[f.disabled,f.value,w]),{onNativeOptionAdd:N,onNativeOptionRemove:M}=p;return Hi(()=>(N(T),()=>M(T)),[N,M,T]),e.jsxs(e.Fragment,{children:[e.jsx(Tr.span,{id:f.textId,...o,ref:b}),f.isSelected&&c.valueNode&&!c.valueNodeHasChildren?Rm.createPortal(o.children,c.valueNode):null]})});cW.displayName=E0;var dW="SelectItemIndicator",uW=A.forwardRef((t,r)=>{const{__scopeSelect:s,...n}=t;return oW(dW,s).isSelected?e.jsx(Tr.span,{"aria-hidden":!0,...n,ref:r}):null});uW.displayName=dW;var hM="SelectScrollUpButton",hW=A.forwardRef((t,r)=>{const s=zm(hM,t.__scopeSelect),n=OI(hM,t.__scopeSelect),[a,o]=A.useState(!1),c=ls(r,n.onScrollButtonChange);return Hi(()=>{if(s.viewport&&s.isPositioned){let i=function(){const p=f.scrollTop>0;o(p)};const f=s.viewport;return i(),f.addEventListener("scroll",i),()=>f.removeEventListener("scroll",i)}},[s.viewport,s.isPositioned]),a?e.jsx(fW,{...t,ref:c,onAutoScroll:()=>{const{viewport:i,selectedItem:f}=s;i&&f&&(i.scrollTop=i.scrollTop-f.offsetHeight)}}):null});hW.displayName=hM;var mM="SelectScrollDownButton",mW=A.forwardRef((t,r)=>{const s=zm(mM,t.__scopeSelect),n=OI(mM,t.__scopeSelect),[a,o]=A.useState(!1),c=ls(r,n.onScrollButtonChange);return Hi(()=>{if(s.viewport&&s.isPositioned){let i=function(){const p=f.scrollHeight-f.clientHeight,g=Math.ceil(f.scrollTop)<p;o(g)};const f=s.viewport;return i(),f.addEventListener("scroll",i),()=>f.removeEventListener("scroll",i)}},[s.viewport,s.isPositioned]),a?e.jsx(fW,{...t,ref:c,onAutoScroll:()=>{const{viewport:i,selectedItem:f}=s;i&&f&&(i.scrollTop=i.scrollTop+f.offsetHeight)}}):null});mW.displayName=mM;var fW=A.forwardRef((t,r)=>{const{__scopeSelect:s,onAutoScroll:n,...a}=t,o=zm("SelectScrollButton",s),c=A.useRef(null),i=OC(s),f=A.useCallback(()=>{c.current!==null&&(window.clearInterval(c.current),c.current=null)},[]);return A.useEffect(()=>()=>f(),[f]),Hi(()=>{var g;const p=i().find(y=>y.ref.current===document.activeElement);(g=p==null?void 0:p.ref.current)==null||g.scrollIntoView({block:"nearest"})},[i]),e.jsx(Tr.div,{"aria-hidden":!0,...a,ref:r,style:{flexShrink:0,...a.style},onPointerDown:gr(a.onPointerDown,()=>{c.current===null&&(c.current=window.setInterval(n,50))}),onPointerMove:gr(a.onPointerMove,()=>{var p;(p=o.onItemLeave)==null||p.call(o),c.current===null&&(c.current=window.setInterval(n,50))}),onPointerLeave:gr(a.onPointerLeave,()=>{f()})})}),sce="SelectSeparator",pW=A.forwardRef((t,r)=>{const{__scopeSelect:s,...n}=t;return e.jsx(Tr.div,{"aria-hidden":!0,...n,ref:r})});pW.displayName=sce;var fM="SelectArrow",nce=A.forwardRef((t,r)=>{const{__scopeSelect:s,...n}=t,a=IC(s),o=$m(fM,s),c=zm(fM,s);return o.open&&c.position==="popper"?e.jsx(MI,{...a,...n,ref:r}):null});nce.displayName=fM;function xW(t){return t===""||t===void 0}var gW=A.forwardRef((t,r)=>{const{value:s,...n}=t,a=A.useRef(null),o=ls(r,a),c=AC(s);return A.useEffect(()=>{const i=a.current,f=window.HTMLSelectElement.prototype,g=Object.getOwnPropertyDescriptor(f,"value").set;if(c!==s&&g){const y=new Event("change",{bubbles:!0});g.call(i,s),i.dispatchEvent(y)}},[c,s]),e.jsx(L9,{asChild:!0,children:e.jsx("select",{...n,ref:o,defaultValue:s})})});gW.displayName="BubbleSelect";function yW(t){const r=oi(t),s=A.useRef(""),n=A.useRef(0),a=A.useCallback(c=>{const i=s.current+c;r(i),function f(p){s.current=p,window.clearTimeout(n.current),p!==""&&(n.current=window.setTimeout(()=>f(""),1e3))}(i)},[r]),o=A.useCallback(()=>{s.current="",window.clearTimeout(n.current)},[]);return A.useEffect(()=>()=>window.clearTimeout(n.current),[]),[s,a,o]}function vW(t,r,s){const a=r.length>1&&Array.from(r).every(p=>p===r[0])?r[0]:r,o=s?t.indexOf(s):-1;let c=ace(t,Math.max(o,0));a.length===1&&(c=c.filter(p=>p!==s));const f=c.find(p=>p.textValue.toLowerCase().startsWith(a.toLowerCase()));return f!==s?f:void 0}function ace(t,r){return t.map((s,n)=>t[(r+n)%t.length])}var ice=G9,jW=H9,oce=Y9,lce=X9,cce=Q9,bW=J9,dce=sW,_W=iW,wW=lW,uce=cW,hce=uW,NW=hW,SW=mW,CW=pW;const Nt=ice,St=oce,bt=A.forwardRef(({className:t,children:r,...s},n)=>e.jsxs(jW,{ref:n,className:dr("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...s,children:[r,e.jsx(lce,{asChild:!0,children:e.jsx(jp,{className:"h-4 w-4 opacity-50"})})]}));bt.displayName=jW.displayName;const PW=A.forwardRef(({className:t,...r},s)=>e.jsx(NW,{ref:s,className:dr("flex cursor-default items-center justify-center py-1",t),...r,children:e.jsx(s9,{className:"h-4 w-4"})}));PW.displayName=NW.displayName;const kW=A.forwardRef(({className:t,...r},s)=>e.jsx(SW,{ref:s,className:dr("flex cursor-default items-center justify-center py-1",t),...r,children:e.jsx(jp,{className:"h-4 w-4"})}));kW.displayName=SW.displayName;const _t=A.forwardRef(({className:t,children:r,position:s="popper",...n},a)=>e.jsx(cce,{children:e.jsxs(bW,{ref:a,className:dr("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...n,children:[e.jsx(PW,{}),e.jsx(dce,{className:dr("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),e.jsx(kW,{})]})}));_t.displayName=bW.displayName;const mce=A.forwardRef(({className:t,...r},s)=>e.jsx(_W,{ref:s,className:dr("px-2 py-1.5 text-sm font-semibold",t),...r}));mce.displayName=_W.displayName;const ge=A.forwardRef(({className:t,children:r,...s},n)=>e.jsxs(wW,{ref:n,className:dr("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...s,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(hce,{children:e.jsx(Kc,{className:"h-4 w-4"})})}),e.jsx(uce,{children:r})]}));ge.displayName=wW.displayName;const fce=A.forwardRef(({className:t,...r},s)=>e.jsx(CW,{ref:s,className:dr("-mx-1 my-1 h-px bg-muted",t),...r}));fce.displayName=CW.displayName;function pce(t,r){return A.useReducer((s,n)=>r[s][n]??s,t)}var Yi=t=>{const{present:r,children:s}=t,n=xce(r),a=typeof s=="function"?s({present:n.isPresent}):A.Children.only(s),o=ls(n.ref,gce(a));return typeof s=="function"||n.isPresent?A.cloneElement(a,{ref:o}):null};Yi.displayName="Presence";function xce(t){const[r,s]=A.useState(),n=A.useRef({}),a=A.useRef(t),o=A.useRef("none"),c=t?"mounted":"unmounted",[i,f]=pce(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return A.useEffect(()=>{const p=rN(n.current);o.current=i==="mounted"?p:"none"},[i]),Hi(()=>{const p=n.current,g=a.current;if(g!==t){const b=o.current,w=rN(p);t?f("MOUNT"):w==="none"||(p==null?void 0:p.display)==="none"?f("UNMOUNT"):f(g&&b!==w?"ANIMATION_OUT":"UNMOUNT"),a.current=t}},[t,f]),Hi(()=>{if(r){let p;const g=r.ownerDocument.defaultView??window,y=w=>{const N=rN(n.current).includes(w.animationName);if(w.target===r&&N&&(f("ANIMATION_END"),!a.current)){const M=r.style.animationFillMode;r.style.animationFillMode="forwards",p=g.setTimeout(()=>{r.style.animationFillMode==="forwards"&&(r.style.animationFillMode=M)})}},b=w=>{w.target===r&&(o.current=rN(n.current))};return r.addEventListener("animationstart",b),r.addEventListener("animationcancel",y),r.addEventListener("animationend",y),()=>{g.clearTimeout(p),r.removeEventListener("animationstart",b),r.removeEventListener("animationcancel",y),r.removeEventListener("animationend",y)}}else f("ANIMATION_END")},[r,f]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:A.useCallback(p=>{p&&(n.current=getComputedStyle(p)),s(p)},[])}}function rN(t){return(t==null?void 0:t.animationName)||"none"}function gce(t){var n,a;let r=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,s=r&&"isReactWarning"in r&&r.isReactWarning;return s?t.ref:(r=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,s=r&&"isReactWarning"in r&&r.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}var II="Dialog",[AW,TW]=tc(II),[yce,Xc]=AW(II),EW=t=>{const{__scopeDialog:r,children:s,open:n,defaultOpen:a,onOpenChange:o,modal:c=!0}=t,i=A.useRef(null),f=A.useRef(null),[p=!1,g]=Yc({prop:n,defaultProp:a,onChange:o});return e.jsx(yce,{scope:r,triggerRef:i,contentRef:f,contentId:Pi(),titleId:Pi(),descriptionId:Pi(),open:p,onOpenChange:g,onOpenToggle:A.useCallback(()=>g(y=>!y),[g]),modal:c,children:s})};EW.displayName=II;var MW="DialogTrigger",OW=A.forwardRef((t,r)=>{const{__scopeDialog:s,...n}=t,a=Xc(MW,s),o=ls(r,a.triggerRef);return e.jsx(Tr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":LI(a.open),...n,ref:o,onClick:gr(t.onClick,a.onOpenToggle)})});OW.displayName=MW;var DI="DialogPortal",[vce,IW]=AW(DI,{forceMount:void 0}),DW=t=>{const{__scopeDialog:r,forceMount:s,children:n,container:a}=t,o=Xc(DI,r);return e.jsx(vce,{scope:r,forceMount:s,children:A.Children.map(n,c=>e.jsx(Yi,{present:s||o.open,children:e.jsx(M_,{asChild:!0,container:a,children:c})}))})};DW.displayName=DI;var kS="DialogOverlay",RW=A.forwardRef((t,r)=>{const s=IW(kS,t.__scopeDialog),{forceMount:n=s.forceMount,...a}=t,o=Xc(kS,t.__scopeDialog);return o.modal?e.jsx(Yi,{present:n||o.open,children:e.jsx(jce,{...a,ref:r})}):null});RW.displayName=kS;var jce=A.forwardRef((t,r)=>{const{__scopeDialog:s,...n}=t,a=Xc(kS,s);return e.jsx(O_,{as:Ad,allowPinchZoom:!0,shards:[a.contentRef],children:e.jsx(Tr.div,{"data-state":LI(a.open),...n,ref:r,style:{pointerEvents:"auto",...n.style}})})}),wp="DialogContent",LW=A.forwardRef((t,r)=>{const s=IW(wp,t.__scopeDialog),{forceMount:n=s.forceMount,...a}=t,o=Xc(wp,t.__scopeDialog);return e.jsx(Yi,{present:n||o.open,children:o.modal?e.jsx(bce,{...a,ref:r}):e.jsx(_ce,{...a,ref:r})})});LW.displayName=wp;var bce=A.forwardRef((t,r)=>{const s=Xc(wp,t.__scopeDialog),n=A.useRef(null),a=ls(r,s.contentRef,n);return A.useEffect(()=>{const o=n.current;if(o)return TC(o)},[]),e.jsx(FW,{...t,ref:a,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:gr(t.onCloseAutoFocus,o=>{var c;o.preventDefault(),(c=s.triggerRef.current)==null||c.focus()}),onPointerDownOutside:gr(t.onPointerDownOutside,o=>{const c=o.detail.originalEvent,i=c.button===0&&c.ctrlKey===!0;(c.button===2||i)&&o.preventDefault()}),onFocusOutside:gr(t.onFocusOutside,o=>o.preventDefault())})}),_ce=A.forwardRef((t,r)=>{const s=Xc(wp,t.__scopeDialog),n=A.useRef(!1),a=A.useRef(!1);return e.jsx(FW,{...t,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var c,i;(c=t.onCloseAutoFocus)==null||c.call(t,o),o.defaultPrevented||(n.current||(i=s.triggerRef.current)==null||i.focus(),o.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:o=>{var f,p;(f=t.onInteractOutside)==null||f.call(t,o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const c=o.target;((p=s.triggerRef.current)==null?void 0:p.contains(c))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),FW=A.forwardRef((t,r)=>{const{__scopeDialog:s,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:o,...c}=t,i=Xc(wp,s),f=A.useRef(null),p=ls(r,f);return wC(),e.jsxs(e.Fragment,{children:[e.jsx(T_,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:o,children:e.jsx(A_,{role:"dialog",id:i.contentId,"aria-describedby":i.descriptionId,"aria-labelledby":i.titleId,"data-state":LI(i.open),...c,ref:p,onDismiss:()=>i.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(Nce,{titleId:i.titleId}),e.jsx(Cce,{contentRef:f,descriptionId:i.descriptionId})]})]})}),RI="DialogTitle",$W=A.forwardRef((t,r)=>{const{__scopeDialog:s,...n}=t,a=Xc(RI,s);return e.jsx(Tr.h2,{id:a.titleId,...n,ref:r})});$W.displayName=RI;var zW="DialogDescription",BW=A.forwardRef((t,r)=>{const{__scopeDialog:s,...n}=t,a=Xc(zW,s);return e.jsx(Tr.p,{id:a.descriptionId,...n,ref:r})});BW.displayName=zW;var qW="DialogClose",VW=A.forwardRef((t,r)=>{const{__scopeDialog:s,...n}=t,a=Xc(qW,s);return e.jsx(Tr.button,{type:"button",...n,ref:r,onClick:gr(t.onClick,()=>a.onOpenChange(!1))})});VW.displayName=qW;function LI(t){return t?"open":"closed"}var UW="DialogTitleWarning",[wce,WW]=Cie(UW,{contentName:wp,titleName:RI,docsSlug:"dialog"}),Nce=({titleId:t})=>{const r=WW(UW),s=`\`${r.contentName}\` requires a \`${r.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${r.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${r.docsSlug}`;return A.useEffect(()=>{t&&(document.getElementById(t)||console.error(s))},[s,t]),null},Sce="DialogDescriptionWarning",Cce=({contentRef:t,descriptionId:r})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${WW(Sce).contentName}}.`;return A.useEffect(()=>{var o;const a=(o=t.current)==null?void 0:o.getAttribute("aria-describedby");r&&a&&(document.getElementById(r)||console.warn(n))},[n,t,r]),null},DC=EW,GW=OW,RC=DW,pv=RW,xv=LW,D_=$W,R_=BW,LC=VW;const Qt=DC,qr=GW,Pce=RC,KW=A.forwardRef(({className:t,...r},s)=>e.jsx(pv,{ref:s,className:dr("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r}));KW.displayName=pv.displayName;const Zt=A.forwardRef(({className:t,children:r,...s},n)=>e.jsxs(Pce,{children:[e.jsx(KW,{}),e.jsxs(xv,{ref:n,className:dr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s,children:[r,e.jsxs(LC,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Ko,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Zt.displayName=xv.displayName;const Yt=({className:t,...r})=>e.jsx("div",{className:dr("flex flex-col space-y-1.5 text-center sm:text-left",t),...r});Yt.displayName="DialogHeader";const Ps=({className:t,...r})=>e.jsx("div",{className:dr("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r});Ps.displayName="DialogFooter";const Xt=A.forwardRef(({className:t,...r},s)=>e.jsx(D_,{ref:s,className:dr("text-lg font-semibold leading-none tracking-tight",t),...r}));Xt.displayName=D_.displayName;const Es=A.forwardRef(({className:t,...r},s)=>e.jsx(R_,{ref:s,className:dr("text-sm text-muted-foreground",t),...r}));Es.displayName=R_.displayName;var FI="Popover",[HW]=tc(FI,[mv]),L_=mv(),[kce,Bm]=HW(FI),ZW=t=>{const{__scopePopover:r,children:s,open:n,defaultOpen:a,onOpenChange:o,modal:c=!1}=t,i=L_(r),f=A.useRef(null),[p,g]=A.useState(!1),[y=!1,b]=Yc({prop:n,defaultProp:a,onChange:o});return e.jsx(TI,{...i,children:e.jsx(kce,{scope:r,contentId:Pi(),triggerRef:f,open:y,onOpenChange:b,onOpenToggle:A.useCallback(()=>b(w=>!w),[b]),hasCustomAnchor:p,onCustomAnchorAdd:A.useCallback(()=>g(!0),[]),onCustomAnchorRemove:A.useCallback(()=>g(!1),[]),modal:c,children:s})})};ZW.displayName=FI;var YW="PopoverAnchor",Ace=A.forwardRef((t,r)=>{const{__scopePopover:s,...n}=t,a=Bm(YW,s),o=L_(s),{onCustomAnchorAdd:c,onCustomAnchorRemove:i}=a;return A.useEffect(()=>(c(),()=>i()),[c,i]),e.jsx(kC,{...o,...n,ref:r})});Ace.displayName=YW;var XW="PopoverTrigger",QW=A.forwardRef((t,r)=>{const{__scopePopover:s,...n}=t,a=Bm(XW,s),o=L_(s),c=ls(r,a.triggerRef),i=e.jsx(Tr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":s7(a.open),...n,ref:c,onClick:gr(t.onClick,a.onOpenToggle)});return a.hasCustomAnchor?i:e.jsx(kC,{asChild:!0,...o,children:i})});QW.displayName=XW;var $I="PopoverPortal",[Tce,Ece]=HW($I,{forceMount:void 0}),JW=t=>{const{__scopePopover:r,forceMount:s,children:n,container:a}=t,o=Bm($I,r);return e.jsx(Tce,{scope:r,forceMount:s,children:e.jsx(Yi,{present:s||o.open,children:e.jsx(M_,{asChild:!0,container:a,children:n})})})};JW.displayName=$I;var yy="PopoverContent",e7=A.forwardRef((t,r)=>{const s=Ece(yy,t.__scopePopover),{forceMount:n=s.forceMount,...a}=t,o=Bm(yy,t.__scopePopover);return e.jsx(Yi,{present:n||o.open,children:o.modal?e.jsx(Mce,{...a,ref:r}):e.jsx(Oce,{...a,ref:r})})});e7.displayName=yy;var Mce=A.forwardRef((t,r)=>{const s=Bm(yy,t.__scopePopover),n=A.useRef(null),a=ls(r,n),o=A.useRef(!1);return A.useEffect(()=>{const c=n.current;if(c)return TC(c)},[]),e.jsx(O_,{as:Ad,allowPinchZoom:!0,children:e.jsx(t7,{...t,ref:a,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:gr(t.onCloseAutoFocus,c=>{var i;c.preventDefault(),o.current||(i=s.triggerRef.current)==null||i.focus()}),onPointerDownOutside:gr(t.onPointerDownOutside,c=>{const i=c.detail.originalEvent,f=i.button===0&&i.ctrlKey===!0,p=i.button===2||f;o.current=p},{checkForDefaultPrevented:!1}),onFocusOutside:gr(t.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1})})})}),Oce=A.forwardRef((t,r)=>{const s=Bm(yy,t.__scopePopover),n=A.useRef(!1),a=A.useRef(!1);return e.jsx(t7,{...t,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var c,i;(c=t.onCloseAutoFocus)==null||c.call(t,o),o.defaultPrevented||(n.current||(i=s.triggerRef.current)==null||i.focus(),o.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:o=>{var f,p;(f=t.onInteractOutside)==null||f.call(t,o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const c=o.target;((p=s.triggerRef.current)==null?void 0:p.contains(c))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),t7=A.forwardRef((t,r)=>{const{__scopePopover:s,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:c,onEscapeKeyDown:i,onPointerDownOutside:f,onFocusOutside:p,onInteractOutside:g,...y}=t,b=Bm(yy,s),w=L_(s);return wC(),e.jsx(T_,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:o,children:e.jsx(A_,{asChild:!0,disableOutsidePointerEvents:c,onInteractOutside:g,onEscapeKeyDown:i,onPointerDownOutside:f,onFocusOutside:p,onDismiss:()=>b.onOpenChange(!1),children:e.jsx(EI,{"data-state":s7(b.open),role:"dialog",id:b.contentId,...w,...y,ref:r,style:{...y.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),r7="PopoverClose",Ice=A.forwardRef((t,r)=>{const{__scopePopover:s,...n}=t,a=Bm(r7,s);return e.jsx(Tr.button,{type:"button",...n,ref:r,onClick:gr(t.onClick,()=>a.onOpenChange(!1))})});Ice.displayName=r7;var Dce="PopoverArrow",Rce=A.forwardRef((t,r)=>{const{__scopePopover:s,...n}=t,a=L_(s);return e.jsx(MI,{...a,...n,ref:r})});Rce.displayName=Dce;function s7(t){return t?"open":"closed"}var Lce=ZW,Fce=QW,$ce=JW,n7=e7;const zce=Lce,Bce=Fce,a7=A.forwardRef(({className:t,align:r="center",sideOffset:s=4,...n},a)=>e.jsx($ce,{children:e.jsx(n7,{ref:a,align:r,sideOffset:s,className:dr("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));a7.displayName=n7.displayName;var h5=1,qce=.9,Vce=.8,Uce=.17,RA=.1,LA=.999,Wce=.9999,Gce=.99,Kce=/[\\\/_+.#"@\[\(\{&]/,Hce=/[\\\/_+.#"@\[\(\{&]/g,Zce=/[\s-]/,i7=/[\s-]/g;function pM(t,r,s,n,a,o,c){if(o===r.length)return a===t.length?h5:Gce;var i=`${a},${o}`;if(c[i]!==void 0)return c[i];for(var f=n.charAt(o),p=s.indexOf(f,a),g=0,y,b,w,T;p>=0;)y=pM(t,r,s,n,p+1,o+1,c),y>g&&(p===a?y*=h5:Kce.test(t.charAt(p-1))?(y*=Vce,w=t.slice(a,p-1).match(Hce),w&&a>0&&(y*=Math.pow(LA,w.length))):Zce.test(t.charAt(p-1))?(y*=qce,T=t.slice(a,p-1).match(i7),T&&a>0&&(y*=Math.pow(LA,T.length))):(y*=Uce,a>0&&(y*=Math.pow(LA,p-a))),t.charAt(p)!==r.charAt(o)&&(y*=Wce)),(y<RA&&s.charAt(p-1)===n.charAt(o+1)||n.charAt(o+1)===n.charAt(o)&&s.charAt(p-1)!==n.charAt(o))&&(b=pM(t,r,s,n,p+1,o+2,c),b*RA>y&&(y=b*RA)),y>g&&(g=y),p=s.indexOf(f,p+1);return c[i]=g,g}function m5(t){return t.toLowerCase().replace(i7," ")}function Yce(t,r,s){return t=s&&s.length>0?`${t+" "+s.join(" ")}`:t,pM(t,r,m5(t),m5(r),0,0,{})}var o7={exports:{}},l7={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vy=A;function Xce(t,r){return t===r&&(t!==0||1/t===1/r)||t!==t&&r!==r}var Qce=typeof Object.is=="function"?Object.is:Xce,Jce=vy.useState,ede=vy.useEffect,tde=vy.useLayoutEffect,rde=vy.useDebugValue;function sde(t,r){var s=r(),n=Jce({inst:{value:s,getSnapshot:r}}),a=n[0].inst,o=n[1];return tde(function(){a.value=s,a.getSnapshot=r,FA(a)&&o({inst:a})},[t,s,r]),ede(function(){return FA(a)&&o({inst:a}),t(function(){FA(a)&&o({inst:a})})},[t]),rde(s),s}function FA(t){var r=t.getSnapshot;t=t.value;try{var s=r();return!Qce(t,s)}catch{return!0}}function nde(t,r){return r()}var ade=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?nde:sde;l7.useSyncExternalStore=vy.useSyncExternalStore!==void 0?vy.useSyncExternalStore:ade;o7.exports=l7;var ide=o7.exports,i0='[cmdk-group=""]',$A='[cmdk-group-items=""]',ode='[cmdk-group-heading=""]',zI='[cmdk-item=""]',f5=`${zI}:not([aria-disabled="true"])`,xM="cmdk-item-select",Vf="data-value",lde=(t,r,s)=>Yce(t,r,s),c7=A.createContext(void 0),F_=()=>A.useContext(c7),d7=A.createContext(void 0),BI=()=>A.useContext(d7),u7=A.createContext(void 0),h7=A.forwardRef((t,r)=>{let s=cg(()=>{var Ve,yt;return{search:"",value:(yt=(Ve=t.value)!=null?Ve:t.defaultValue)!=null?yt:"",filtered:{count:0,items:new Map,groups:new Set}}}),n=cg(()=>new Set),a=cg(()=>new Map),o=cg(()=>new Map),c=cg(()=>new Set),i=m7(t),{label:f,children:p,value:g,onValueChange:y,filter:b,shouldFilter:w,loop:T,disablePointerSelection:N=!1,vimBindings:M=!0,...O}=t,C=Pi(),D=Pi(),L=Pi(),F=A.useRef(null),B=vde();Np(()=>{if(g!==void 0){let Ve=g.trim();s.current.value=Ve,U.emit()}},[g]),Np(()=>{B(6,oe)},[]);let U=A.useMemo(()=>({subscribe:Ve=>(c.current.add(Ve),()=>c.current.delete(Ve)),snapshot:()=>s.current,setState:(Ve,yt,Et)=>{var Rt,Vt,Ct;if(!Object.is(s.current[Ve],yt)){if(s.current[Ve]=yt,Ve==="search")ne(),re(),B(1,Z);else if(Ve==="value"&&(Et||B(5,oe),((Rt=i.current)==null?void 0:Rt.value)!==void 0)){let ur=yt??"";(Ct=(Vt=i.current).onValueChange)==null||Ct.call(Vt,ur);return}U.emit()}},emit:()=>{c.current.forEach(Ve=>Ve())}}),[]),te=A.useMemo(()=>({value:(Ve,yt,Et)=>{var Rt;yt!==((Rt=o.current.get(Ve))==null?void 0:Rt.value)&&(o.current.set(Ve,{value:yt,keywords:Et}),s.current.filtered.items.set(Ve,Q(yt,Et)),B(2,()=>{re(),U.emit()}))},item:(Ve,yt)=>(n.current.add(Ve),yt&&(a.current.has(yt)?a.current.get(yt).add(Ve):a.current.set(yt,new Set([Ve]))),B(3,()=>{ne(),re(),s.current.value||Z(),U.emit()}),()=>{o.current.delete(Ve),n.current.delete(Ve),s.current.filtered.items.delete(Ve);let Et=Ce();B(4,()=>{ne(),(Et==null?void 0:Et.getAttribute("id"))===Ve&&Z(),U.emit()})}),group:Ve=>(a.current.has(Ve)||a.current.set(Ve,new Set),()=>{o.current.delete(Ve),a.current.delete(Ve)}),filter:()=>i.current.shouldFilter,label:f||t["aria-label"],getDisablePointerSelection:()=>i.current.disablePointerSelection,listId:C,inputId:L,labelId:D,listInnerRef:F}),[]);function Q(Ve,yt){var Et,Rt;let Vt=(Rt=(Et=i.current)==null?void 0:Et.filter)!=null?Rt:lde;return Ve?Vt(Ve,s.current.search,yt):0}function re(){if(!s.current.search||i.current.shouldFilter===!1)return;let Ve=s.current.filtered.items,yt=[];s.current.filtered.groups.forEach(Rt=>{let Vt=a.current.get(Rt),Ct=0;Vt.forEach(ur=>{let At=Ve.get(ur);Ct=Math.max(At,Ct)}),yt.push([Rt,Ct])});let Et=F.current;Pe().sort((Rt,Vt)=>{var Ct,ur;let At=Rt.getAttribute("id"),Ht=Vt.getAttribute("id");return((Ct=Ve.get(Ht))!=null?Ct:0)-((ur=Ve.get(At))!=null?ur:0)}).forEach(Rt=>{let Vt=Rt.closest($A);Vt?Vt.appendChild(Rt.parentElement===Vt?Rt:Rt.closest(`${$A} > *`)):Et.appendChild(Rt.parentElement===Et?Rt:Rt.closest(`${$A} > *`))}),yt.sort((Rt,Vt)=>Vt[1]-Rt[1]).forEach(Rt=>{var Vt;let Ct=(Vt=F.current)==null?void 0:Vt.querySelector(`${i0}[${Vf}="${encodeURIComponent(Rt[0])}"]`);Ct==null||Ct.parentElement.appendChild(Ct)})}function Z(){let Ve=Pe().find(Et=>Et.getAttribute("aria-disabled")!=="true"),yt=Ve==null?void 0:Ve.getAttribute(Vf);U.setState("value",yt||void 0)}function ne(){var Ve,yt,Et,Rt;if(!s.current.search||i.current.shouldFilter===!1){s.current.filtered.count=n.current.size;return}s.current.filtered.groups=new Set;let Vt=0;for(let Ct of n.current){let ur=(yt=(Ve=o.current.get(Ct))==null?void 0:Ve.value)!=null?yt:"",At=(Rt=(Et=o.current.get(Ct))==null?void 0:Et.keywords)!=null?Rt:[],Ht=Q(ur,At);s.current.filtered.items.set(Ct,Ht),Ht>0&&Vt++}for(let[Ct,ur]of a.current)for(let At of ur)if(s.current.filtered.items.get(At)>0){s.current.filtered.groups.add(Ct);break}s.current.filtered.count=Vt}function oe(){var Ve,yt,Et;let Rt=Ce();Rt&&(((Ve=Rt.parentElement)==null?void 0:Ve.firstChild)===Rt&&((Et=(yt=Rt.closest(i0))==null?void 0:yt.querySelector(ode))==null||Et.scrollIntoView({block:"nearest"})),Rt.scrollIntoView({block:"nearest"}))}function Ce(){var Ve;return(Ve=F.current)==null?void 0:Ve.querySelector(`${zI}[aria-selected="true"]`)}function Pe(){var Ve;return Array.from(((Ve=F.current)==null?void 0:Ve.querySelectorAll(f5))||[])}function Se(Ve){let yt=Pe()[Ve];yt&&U.setState("value",yt.getAttribute(Vf))}function ae(Ve){var yt;let Et=Ce(),Rt=Pe(),Vt=Rt.findIndex(ur=>ur===Et),Ct=Rt[Vt+Ve];(yt=i.current)!=null&&yt.loop&&(Ct=Vt+Ve<0?Rt[Rt.length-1]:Vt+Ve===Rt.length?Rt[0]:Rt[Vt+Ve]),Ct&&U.setState("value",Ct.getAttribute(Vf))}function be(Ve){let yt=Ce(),Et=yt==null?void 0:yt.closest(i0),Rt;for(;Et&&!Rt;)Et=Ve>0?gde(Et,i0):yde(Et,i0),Rt=Et==null?void 0:Et.querySelector(f5);Rt?U.setState("value",Rt.getAttribute(Vf)):ae(Ve)}let de=()=>Se(Pe().length-1),Ke=Ve=>{Ve.preventDefault(),Ve.metaKey?de():Ve.altKey?be(1):ae(1)},He=Ve=>{Ve.preventDefault(),Ve.metaKey?Se(0):Ve.altKey?be(-1):ae(-1)};return A.createElement(Tr.div,{ref:r,tabIndex:-1,...O,"cmdk-root":"",onKeyDown:Ve=>{var yt;if((yt=O.onKeyDown)==null||yt.call(O,Ve),!Ve.defaultPrevented)switch(Ve.key){case"n":case"j":{M&&Ve.ctrlKey&&Ke(Ve);break}case"ArrowDown":{Ke(Ve);break}case"p":case"k":{M&&Ve.ctrlKey&&He(Ve);break}case"ArrowUp":{He(Ve);break}case"Home":{Ve.preventDefault(),Se(0);break}case"End":{Ve.preventDefault(),de();break}case"Enter":if(!Ve.nativeEvent.isComposing&&Ve.keyCode!==229){Ve.preventDefault();let Et=Ce();if(Et){let Rt=new Event(xM);Et.dispatchEvent(Rt)}}}}},A.createElement("label",{"cmdk-label":"",htmlFor:te.inputId,id:te.labelId,style:bde},f),FC(t,Ve=>A.createElement(d7.Provider,{value:U},A.createElement(c7.Provider,{value:te},Ve))))}),cde=A.forwardRef((t,r)=>{var s,n;let a=Pi(),o=A.useRef(null),c=A.useContext(u7),i=F_(),f=m7(t),p=(n=(s=f.current)==null?void 0:s.forceMount)!=null?n:c==null?void 0:c.forceMount;Np(()=>{if(!p)return i.item(a,c==null?void 0:c.id)},[p]);let g=f7(a,o,[t.value,t.children,o],t.keywords),y=BI(),b=Sp(B=>B.value&&B.value===g.current),w=Sp(B=>p||i.filter()===!1?!0:B.search?B.filtered.items.get(a)>0:!0);A.useEffect(()=>{let B=o.current;if(!(!B||t.disabled))return B.addEventListener(xM,T),()=>B.removeEventListener(xM,T)},[w,t.onSelect,t.disabled]);function T(){var B,U;N(),(U=(B=f.current).onSelect)==null||U.call(B,g.current)}function N(){y.setState("value",g.current,!0)}if(!w)return null;let{disabled:M,value:O,onSelect:C,forceMount:D,keywords:L,...F}=t;return A.createElement(Tr.div,{ref:kb([o,r]),...F,id:a,"cmdk-item":"",role:"option","aria-disabled":!!M,"aria-selected":!!b,"data-disabled":!!M,"data-selected":!!b,onPointerMove:M||i.getDisablePointerSelection()?void 0:N,onClick:M?void 0:T},t.children)}),dde=A.forwardRef((t,r)=>{let{heading:s,children:n,forceMount:a,...o}=t,c=Pi(),i=A.useRef(null),f=A.useRef(null),p=Pi(),g=F_(),y=Sp(w=>a||g.filter()===!1?!0:w.search?w.filtered.groups.has(c):!0);Np(()=>g.group(c),[]),f7(c,i,[t.value,t.heading,f]);let b=A.useMemo(()=>({id:c,forceMount:a}),[a]);return A.createElement(Tr.div,{ref:kb([i,r]),...o,"cmdk-group":"",role:"presentation",hidden:y?void 0:!0},s&&A.createElement("div",{ref:f,"cmdk-group-heading":"","aria-hidden":!0,id:p},s),FC(t,w=>A.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":s?p:void 0},A.createElement(u7.Provider,{value:b},w))))}),ude=A.forwardRef((t,r)=>{let{alwaysRender:s,...n}=t,a=A.useRef(null),o=Sp(c=>!c.search);return!s&&!o?null:A.createElement(Tr.div,{ref:kb([a,r]),...n,"cmdk-separator":"",role:"separator"})}),hde=A.forwardRef((t,r)=>{let{onValueChange:s,...n}=t,a=t.value!=null,o=BI(),c=Sp(g=>g.search),i=Sp(g=>g.value),f=F_(),p=A.useMemo(()=>{var g;let y=(g=f.listInnerRef.current)==null?void 0:g.querySelector(`${zI}[${Vf}="${encodeURIComponent(i)}"]`);return y==null?void 0:y.getAttribute("id")},[]);return A.useEffect(()=>{t.value!=null&&o.setState("search",t.value)},[t.value]),A.createElement(Tr.input,{ref:r,...n,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":f.listId,"aria-labelledby":f.labelId,"aria-activedescendant":p,id:f.inputId,type:"text",value:a?t.value:c,onChange:g=>{a||o.setState("search",g.target.value),s==null||s(g.target.value)}})}),mde=A.forwardRef((t,r)=>{let{children:s,label:n="Suggestions",...a}=t,o=A.useRef(null),c=A.useRef(null),i=F_();return A.useEffect(()=>{if(c.current&&o.current){let f=c.current,p=o.current,g,y=new ResizeObserver(()=>{g=requestAnimationFrame(()=>{let b=f.offsetHeight;p.style.setProperty("--cmdk-list-height",b.toFixed(1)+"px")})});return y.observe(f),()=>{cancelAnimationFrame(g),y.unobserve(f)}}},[]),A.createElement(Tr.div,{ref:kb([o,r]),...a,"cmdk-list":"",role:"listbox","aria-label":n,id:i.listId},FC(t,f=>A.createElement("div",{ref:kb([c,i.listInnerRef]),"cmdk-list-sizer":""},f)))}),fde=A.forwardRef((t,r)=>{let{open:s,onOpenChange:n,overlayClassName:a,contentClassName:o,container:c,...i}=t;return A.createElement(DC,{open:s,onOpenChange:n},A.createElement(RC,{container:c},A.createElement(pv,{"cmdk-overlay":"",className:a}),A.createElement(xv,{"aria-label":t.label,"cmdk-dialog":"",className:o},A.createElement(h7,{ref:r,...i}))))}),pde=A.forwardRef((t,r)=>Sp(s=>s.filtered.count===0)?A.createElement(Tr.div,{ref:r,...t,"cmdk-empty":"",role:"presentation"}):null),xde=A.forwardRef((t,r)=>{let{progress:s,children:n,label:a="Loading...",...o}=t;return A.createElement(Tr.div,{ref:r,...o,"cmdk-loading":"",role:"progressbar","aria-valuenow":s,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},FC(t,c=>A.createElement("div",{"aria-hidden":!0},c)))}),Ho=Object.assign(h7,{List:mde,Item:cde,Input:hde,Group:dde,Separator:ude,Dialog:fde,Empty:pde,Loading:xde});function gde(t,r){let s=t.nextElementSibling;for(;s;){if(s.matches(r))return s;s=s.nextElementSibling}}function yde(t,r){let s=t.previousElementSibling;for(;s;){if(s.matches(r))return s;s=s.previousElementSibling}}function m7(t){let r=A.useRef(t);return Np(()=>{r.current=t}),r}var Np=typeof window>"u"?A.useEffect:A.useLayoutEffect;function cg(t){let r=A.useRef();return r.current===void 0&&(r.current=t()),r}function kb(t){return r=>{t.forEach(s=>{typeof s=="function"?s(r):s!=null&&(s.current=r)})}}function Sp(t){let r=BI(),s=()=>t(r.snapshot());return ide.useSyncExternalStore(r.subscribe,s,s)}function f7(t,r,s,n=[]){let a=A.useRef(),o=F_();return Np(()=>{var c;let i=(()=>{var p;for(let g of s){if(typeof g=="string")return g.trim();if(typeof g=="object"&&"current"in g)return g.current?(p=g.current.textContent)==null?void 0:p.trim():a.current}})(),f=n.map(p=>p.trim());o.value(t,i,f),(c=r.current)==null||c.setAttribute(Vf,i),a.current=i}),a}var vde=()=>{let[t,r]=A.useState(),s=cg(()=>new Map);return Np(()=>{s.current.forEach(n=>n()),s.current=new Map},[t]),(n,a)=>{s.current.set(n,a),r({})}};function jde(t){let r=t.type;return typeof r=="function"?r(t.props):"render"in r?r.render(t.props):t}function FC({asChild:t,children:r},s){return t&&A.isValidElement(r)?A.cloneElement(jde(r),{ref:r.ref},s(r.props.children)):s(r)}var bde={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const p7=A.forwardRef(({className:t,...r},s)=>e.jsx(Ho,{ref:s,className:dr("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...r}));p7.displayName=Ho.displayName;const x7=A.forwardRef(({className:t,...r},s)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(nn,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(Ho.Input,{ref:s,className:dr("flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...r})]}));x7.displayName=Ho.Input.displayName;const g7=A.forwardRef(({className:t,...r},s)=>e.jsx(Ho.List,{ref:s,className:dr("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...r}));g7.displayName=Ho.List.displayName;const y7=A.forwardRef((t,r)=>e.jsx(Ho.Empty,{ref:r,className:"py-6 text-center text-sm",...t}));y7.displayName=Ho.Empty.displayName;const gM=A.forwardRef(({className:t,...r},s)=>e.jsx(Ho.Group,{ref:s,className:dr("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...r}));gM.displayName=Ho.Group.displayName;const _de=A.forwardRef(({className:t,...r},s)=>e.jsx(Ho.Separator,{ref:s,className:dr("-mx-1 h-px bg-border",t),...r}));_de.displayName=Ho.Separator.displayName;const qN=A.forwardRef(({className:t,...r},s)=>e.jsx(Ho.Item,{ref:s,className:dr("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t),...r}));qN.displayName=Ho.Item.displayName;var wde=t=>{switch(t){case"success":return Cde;case"info":return kde;case"warning":return Pde;case"error":return Ade;default:return null}},Nde=Array(12).fill(0),Sde=({visible:t,className:r})=>je.createElement("div",{className:["sonner-loading-wrapper",r].filter(Boolean).join(" "),"data-visible":t},je.createElement("div",{className:"sonner-spinner"},Nde.map((s,n)=>je.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),Cde=je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},je.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Pde=je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},je.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),kde=je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},je.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Ade=je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},je.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Tde=je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},je.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),je.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),Ede=()=>{let[t,r]=je.useState(document.hidden);return je.useEffect(()=>{let s=()=>{r(document.hidden)};return document.addEventListener("visibilitychange",s),()=>window.removeEventListener("visibilitychange",s)},[]),t},yM=1,Mde=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let r=this.subscribers.indexOf(t);this.subscribers.splice(r,1)}),this.publish=t=>{this.subscribers.forEach(r=>r(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var r;let{message:s,...n}=t,a=typeof(t==null?void 0:t.id)=="number"||((r=t.id)==null?void 0:r.length)>0?t.id:yM++,o=this.toasts.find(i=>i.id===a),c=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),o?this.toasts=this.toasts.map(i=>i.id===a?(this.publish({...i,...t,id:a,title:s}),{...i,...t,id:a,dismissible:c,title:s}):i):this.addToast({title:s,...n,dismissible:c,id:a}),a},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(r=>{this.subscribers.forEach(s=>s({id:r.id,dismiss:!0}))}),this.subscribers.forEach(r=>r({id:t,dismiss:!0})),t),this.message=(t,r)=>this.create({...r,message:t}),this.error=(t,r)=>this.create({...r,message:t,type:"error"}),this.success=(t,r)=>this.create({...r,type:"success",message:t}),this.info=(t,r)=>this.create({...r,type:"info",message:t}),this.warning=(t,r)=>this.create({...r,type:"warning",message:t}),this.loading=(t,r)=>this.create({...r,type:"loading",message:t}),this.promise=(t,r)=>{if(!r)return;let s;r.loading!==void 0&&(s=this.create({...r,promise:t,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));let n=t instanceof Promise?t:t(),a=s!==void 0,o,c=n.then(async f=>{if(o=["resolve",f],je.isValidElement(f))a=!1,this.create({id:s,type:"default",message:f});else if(Ide(f)&&!f.ok){a=!1;let p=typeof r.error=="function"?await r.error(`HTTP error! status: ${f.status}`):r.error,g=typeof r.description=="function"?await r.description(`HTTP error! status: ${f.status}`):r.description;this.create({id:s,type:"error",message:p,description:g})}else if(r.success!==void 0){a=!1;let p=typeof r.success=="function"?await r.success(f):r.success,g=typeof r.description=="function"?await r.description(f):r.description;this.create({id:s,type:"success",message:p,description:g})}}).catch(async f=>{if(o=["reject",f],r.error!==void 0){a=!1;let p=typeof r.error=="function"?await r.error(f):r.error,g=typeof r.description=="function"?await r.description(f):r.description;this.create({id:s,type:"error",message:p,description:g})}}).finally(()=>{var f;a&&(this.dismiss(s),s=void 0),(f=r.finally)==null||f.call(r)}),i=()=>new Promise((f,p)=>c.then(()=>o[0]==="reject"?p(o[1]):f(o[1])).catch(p));return typeof s!="string"&&typeof s!="number"?{unwrap:i}:Object.assign(s,{unwrap:i})},this.custom=(t,r)=>{let s=(r==null?void 0:r.id)||yM++;return this.create({jsx:t(s),id:s,...r}),s},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Do=new Mde,Ode=(t,r)=>{let s=(r==null?void 0:r.id)||yM++;return Do.addToast({title:t,...r,id:s}),s},Ide=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",Dde=Ode,Rde=()=>Do.toasts,Lde=()=>Do.getActiveToasts(),Me=Object.assign(Dde,{success:Do.success,info:Do.info,warning:Do.warning,error:Do.error,custom:Do.custom,message:Do.message,promise:Do.promise,dismiss:Do.dismiss,loading:Do.loading},{getHistory:Rde,getToasts:Lde});function Fde(t,{insertAt:r}={}){if(typeof document>"u")return;let s=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",r==="top"&&s.firstChild?s.insertBefore(n,s.firstChild):s.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}Fde(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function sN(t){return t.label!==void 0}var $de=3,zde="32px",Bde="16px",p5=4e3,qde=356,Vde=14,Ude=20,Wde=200;function wc(...t){return t.filter(Boolean).join(" ")}function Gde(t){let[r,s]=t.split("-"),n=[];return r&&n.push(r),s&&n.push(s),n}var Kde=t=>{var r,s,n,a,o,c,i,f,p,g,y;let{invert:b,toast:w,unstyled:T,interacting:N,setHeights:M,visibleToasts:O,heights:C,index:D,toasts:L,expanded:F,removeToast:B,defaultRichColors:U,closeButton:te,style:Q,cancelButtonStyle:re,actionButtonStyle:Z,className:ne="",descriptionClassName:oe="",duration:Ce,position:Pe,gap:Se,loadingIcon:ae,expandByDefault:be,classNames:de,icons:Ke,closeButtonAriaLabel:He="Close toast",pauseWhenPageIsHidden:Ve}=t,[yt,Et]=je.useState(null),[Rt,Vt]=je.useState(null),[Ct,ur]=je.useState(!1),[At,Ht]=je.useState(!1),[fr,vt]=je.useState(!1),[Br,vr]=je.useState(!1),[Xr,Dr]=je.useState(!1),[As,xn]=je.useState(0),[Qs,De]=je.useState(0),Je=je.useRef(w.duration||Ce||p5),lt=je.useRef(null),qt=je.useRef(null),It=D===0,Bt=D+1<=O,er=w.type,Qr=w.dismissible!==!1,Ss=w.className||"",Tn=w.descriptionClassName||"",Xe=je.useMemo(()=>C.findIndex(wr=>wr.toastId===w.id)||0,[C,w.id]),ye=je.useMemo(()=>{var wr;return(wr=w.closeButton)!=null?wr:te},[w.closeButton,te]),ve=je.useMemo(()=>w.duration||Ce||p5,[w.duration,Ce]),ke=je.useRef(0),Fe=je.useRef(0),Ge=je.useRef(0),nt=je.useRef(null),[dt,rt]=Pe.split("-"),ft=je.useMemo(()=>C.reduce((wr,tr,Cr)=>Cr>=Xe?wr:wr+tr.height,0),[C,Xe]),$t=Ede(),Pt=w.invert||b,br=er==="loading";Fe.current=je.useMemo(()=>Xe*Se+ft,[Xe,ft]),je.useEffect(()=>{Je.current=ve},[ve]),je.useEffect(()=>{ur(!0)},[]),je.useEffect(()=>{let wr=qt.current;if(wr){let tr=wr.getBoundingClientRect().height;return De(tr),M(Cr=>[{toastId:w.id,height:tr,position:w.position},...Cr]),()=>M(Cr=>Cr.filter(fs=>fs.toastId!==w.id))}},[M,w.id]),je.useLayoutEffect(()=>{if(!Ct)return;let wr=qt.current,tr=wr.style.height;wr.style.height="auto";let Cr=wr.getBoundingClientRect().height;wr.style.height=tr,De(Cr),M(fs=>fs.find(Os=>Os.toastId===w.id)?fs.map(Os=>Os.toastId===w.id?{...Os,height:Cr}:Os):[{toastId:w.id,height:Cr,position:w.position},...fs])},[Ct,w.title,w.description,M,w.id]);let ot=je.useCallback(()=>{Ht(!0),xn(Fe.current),M(wr=>wr.filter(tr=>tr.toastId!==w.id)),setTimeout(()=>{B(w)},Wde)},[w,B,M,Fe]);je.useEffect(()=>{if(w.promise&&er==="loading"||w.duration===1/0||w.type==="loading")return;let wr;return F||N||Ve&&$t?(()=>{if(Ge.current<ke.current){let tr=new Date().getTime()-ke.current;Je.current=Je.current-tr}Ge.current=new Date().getTime()})():Je.current!==1/0&&(ke.current=new Date().getTime(),wr=setTimeout(()=>{var tr;(tr=w.onAutoClose)==null||tr.call(w,w),ot()},Je.current)),()=>clearTimeout(wr)},[F,N,w,er,Ve,$t,ot]),je.useEffect(()=>{w.delete&&ot()},[ot,w.delete]);function is(){var wr,tr,Cr;return Ke!=null&&Ke.loading?je.createElement("div",{className:wc(de==null?void 0:de.loader,(wr=w==null?void 0:w.classNames)==null?void 0:wr.loader,"sonner-loader"),"data-visible":er==="loading"},Ke.loading):ae?je.createElement("div",{className:wc(de==null?void 0:de.loader,(tr=w==null?void 0:w.classNames)==null?void 0:tr.loader,"sonner-loader"),"data-visible":er==="loading"},ae):je.createElement(Sde,{className:wc(de==null?void 0:de.loader,(Cr=w==null?void 0:w.classNames)==null?void 0:Cr.loader),visible:er==="loading"})}return je.createElement("li",{tabIndex:0,ref:qt,className:wc(ne,Ss,de==null?void 0:de.toast,(r=w==null?void 0:w.classNames)==null?void 0:r.toast,de==null?void 0:de.default,de==null?void 0:de[er],(s=w==null?void 0:w.classNames)==null?void 0:s[er]),"data-sonner-toast":"","data-rich-colors":(n=w.richColors)!=null?n:U,"data-styled":!(w.jsx||w.unstyled||T),"data-mounted":Ct,"data-promise":!!w.promise,"data-swiped":Xr,"data-removed":At,"data-visible":Bt,"data-y-position":dt,"data-x-position":rt,"data-index":D,"data-front":It,"data-swiping":fr,"data-dismissible":Qr,"data-type":er,"data-invert":Pt,"data-swipe-out":Br,"data-swipe-direction":Rt,"data-expanded":!!(F||be&&Ct),style:{"--index":D,"--toasts-before":D,"--z-index":L.length-D,"--offset":`${At?As:Fe.current}px`,"--initial-height":be?"auto":`${Qs}px`,...Q,...w.style},onDragEnd:()=>{vt(!1),Et(null),nt.current=null},onPointerDown:wr=>{br||!Qr||(lt.current=new Date,xn(Fe.current),wr.target.setPointerCapture(wr.pointerId),wr.target.tagName!=="BUTTON"&&(vt(!0),nt.current={x:wr.clientX,y:wr.clientY}))},onPointerUp:()=>{var wr,tr,Cr,fs;if(Br||!Qr)return;nt.current=null;let Os=Number(((wr=qt.current)==null?void 0:wr.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),dn=Number(((tr=qt.current)==null?void 0:tr.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Bs=new Date().getTime()-((Cr=lt.current)==null?void 0:Cr.getTime()),qs=yt==="x"?Os:dn,Is=Math.abs(qs)/Bs;if(Math.abs(qs)>=Ude||Is>.11){xn(Fe.current),(fs=w.onDismiss)==null||fs.call(w,w),Vt(yt==="x"?Os>0?"right":"left":dn>0?"down":"up"),ot(),vr(!0),Dr(!1);return}vt(!1),Et(null)},onPointerMove:wr=>{var tr,Cr,fs,Os;if(!nt.current||!Qr||((tr=window.getSelection())==null?void 0:tr.toString().length)>0)return;let dn=wr.clientY-nt.current.y,Bs=wr.clientX-nt.current.x,qs=(Cr=t.swipeDirections)!=null?Cr:Gde(Pe);!yt&&(Math.abs(Bs)>1||Math.abs(dn)>1)&&Et(Math.abs(Bs)>Math.abs(dn)?"x":"y");let Is={x:0,y:0};yt==="y"?(qs.includes("top")||qs.includes("bottom"))&&(qs.includes("top")&&dn<0||qs.includes("bottom")&&dn>0)&&(Is.y=dn):yt==="x"&&(qs.includes("left")||qs.includes("right"))&&(qs.includes("left")&&Bs<0||qs.includes("right")&&Bs>0)&&(Is.x=Bs),(Math.abs(Is.x)>0||Math.abs(Is.y)>0)&&Dr(!0),(fs=qt.current)==null||fs.style.setProperty("--swipe-amount-x",`${Is.x}px`),(Os=qt.current)==null||Os.style.setProperty("--swipe-amount-y",`${Is.y}px`)}},ye&&!w.jsx?je.createElement("button",{"aria-label":He,"data-disabled":br,"data-close-button":!0,onClick:br||!Qr?()=>{}:()=>{var wr;ot(),(wr=w.onDismiss)==null||wr.call(w,w)},className:wc(de==null?void 0:de.closeButton,(a=w==null?void 0:w.classNames)==null?void 0:a.closeButton)},(o=Ke==null?void 0:Ke.close)!=null?o:Tde):null,w.jsx||A.isValidElement(w.title)?w.jsx?w.jsx:typeof w.title=="function"?w.title():w.title:je.createElement(je.Fragment,null,er||w.icon||w.promise?je.createElement("div",{"data-icon":"",className:wc(de==null?void 0:de.icon,(c=w==null?void 0:w.classNames)==null?void 0:c.icon)},w.promise||w.type==="loading"&&!w.icon?w.icon||is():null,w.type!=="loading"?w.icon||(Ke==null?void 0:Ke[er])||wde(er):null):null,je.createElement("div",{"data-content":"",className:wc(de==null?void 0:de.content,(i=w==null?void 0:w.classNames)==null?void 0:i.content)},je.createElement("div",{"data-title":"",className:wc(de==null?void 0:de.title,(f=w==null?void 0:w.classNames)==null?void 0:f.title)},typeof w.title=="function"?w.title():w.title),w.description?je.createElement("div",{"data-description":"",className:wc(oe,Tn,de==null?void 0:de.description,(p=w==null?void 0:w.classNames)==null?void 0:p.description)},typeof w.description=="function"?w.description():w.description):null),A.isValidElement(w.cancel)?w.cancel:w.cancel&&sN(w.cancel)?je.createElement("button",{"data-button":!0,"data-cancel":!0,style:w.cancelButtonStyle||re,onClick:wr=>{var tr,Cr;sN(w.cancel)&&Qr&&((Cr=(tr=w.cancel).onClick)==null||Cr.call(tr,wr),ot())},className:wc(de==null?void 0:de.cancelButton,(g=w==null?void 0:w.classNames)==null?void 0:g.cancelButton)},w.cancel.label):null,A.isValidElement(w.action)?w.action:w.action&&sN(w.action)?je.createElement("button",{"data-button":!0,"data-action":!0,style:w.actionButtonStyle||Z,onClick:wr=>{var tr,Cr;sN(w.action)&&((Cr=(tr=w.action).onClick)==null||Cr.call(tr,wr),!wr.defaultPrevented&&ot())},className:wc(de==null?void 0:de.actionButton,(y=w==null?void 0:w.classNames)==null?void 0:y.actionButton)},w.action.label):null))};function x5(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function Hde(t,r){let s={};return[t,r].forEach((n,a)=>{let o=a===1,c=o?"--mobile-offset":"--offset",i=o?Bde:zde;function f(p){["top","right","bottom","left"].forEach(g=>{s[`${c}-${g}`]=typeof p=="number"?`${p}px`:p})}typeof n=="number"||typeof n=="string"?f(n):typeof n=="object"?["top","right","bottom","left"].forEach(p=>{n[p]===void 0?s[`${c}-${p}`]=i:s[`${c}-${p}`]=typeof n[p]=="number"?`${n[p]}px`:n[p]}):f(i)}),s}A.forwardRef(function(t,r){let{invert:s,position:n="bottom-right",hotkey:a=["altKey","KeyT"],expand:o,closeButton:c,className:i,offset:f,mobileOffset:p,theme:g="light",richColors:y,duration:b,style:w,visibleToasts:T=$de,toastOptions:N,dir:M=x5(),gap:O=Vde,loadingIcon:C,icons:D,containerAriaLabel:L="Notifications",pauseWhenPageIsHidden:F}=t,[B,U]=je.useState([]),te=je.useMemo(()=>Array.from(new Set([n].concat(B.filter(Ve=>Ve.position).map(Ve=>Ve.position)))),[B,n]),[Q,re]=je.useState([]),[Z,ne]=je.useState(!1),[oe,Ce]=je.useState(!1),[Pe,Se]=je.useState(g!=="system"?g:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),ae=je.useRef(null),be=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),de=je.useRef(null),Ke=je.useRef(!1),He=je.useCallback(Ve=>{U(yt=>{var Et;return(Et=yt.find(Rt=>Rt.id===Ve.id))!=null&&Et.delete||Do.dismiss(Ve.id),yt.filter(({id:Rt})=>Rt!==Ve.id)})},[]);return je.useEffect(()=>Do.subscribe(Ve=>{if(Ve.dismiss){U(yt=>yt.map(Et=>Et.id===Ve.id?{...Et,delete:!0}:Et));return}setTimeout(()=>{yU.flushSync(()=>{U(yt=>{let Et=yt.findIndex(Rt=>Rt.id===Ve.id);return Et!==-1?[...yt.slice(0,Et),{...yt[Et],...Ve},...yt.slice(Et+1)]:[Ve,...yt]})})})}),[]),je.useEffect(()=>{if(g!=="system"){Se(g);return}if(g==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Se("dark"):Se("light")),typeof window>"u")return;let Ve=window.matchMedia("(prefers-color-scheme: dark)");try{Ve.addEventListener("change",({matches:yt})=>{Se(yt?"dark":"light")})}catch{Ve.addListener(({matches:Et})=>{try{Se(Et?"dark":"light")}catch(Rt){console.error(Rt)}})}},[g]),je.useEffect(()=>{B.length<=1&&ne(!1)},[B]),je.useEffect(()=>{let Ve=yt=>{var Et,Rt;a.every(Vt=>yt[Vt]||yt.code===Vt)&&(ne(!0),(Et=ae.current)==null||Et.focus()),yt.code==="Escape"&&(document.activeElement===ae.current||(Rt=ae.current)!=null&&Rt.contains(document.activeElement))&&ne(!1)};return document.addEventListener("keydown",Ve),()=>document.removeEventListener("keydown",Ve)},[a]),je.useEffect(()=>{if(ae.current)return()=>{de.current&&(de.current.focus({preventScroll:!0}),de.current=null,Ke.current=!1)}},[ae.current]),je.createElement("section",{ref:r,"aria-label":`${L} ${be}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},te.map((Ve,yt)=>{var Et;let[Rt,Vt]=Ve.split("-");return B.length?je.createElement("ol",{key:Ve,dir:M==="auto"?x5():M,tabIndex:-1,ref:ae,className:i,"data-sonner-toaster":!0,"data-theme":Pe,"data-y-position":Rt,"data-lifted":Z&&B.length>1&&!o,"data-x-position":Vt,style:{"--front-toast-height":`${((Et=Q[0])==null?void 0:Et.height)||0}px`,"--width":`${qde}px`,"--gap":`${O}px`,...w,...Hde(f,p)},onBlur:Ct=>{Ke.current&&!Ct.currentTarget.contains(Ct.relatedTarget)&&(Ke.current=!1,de.current&&(de.current.focus({preventScroll:!0}),de.current=null))},onFocus:Ct=>{Ct.target instanceof HTMLElement&&Ct.target.dataset.dismissible==="false"||Ke.current||(Ke.current=!0,de.current=Ct.relatedTarget)},onMouseEnter:()=>ne(!0),onMouseMove:()=>ne(!0),onMouseLeave:()=>{oe||ne(!1)},onDragEnd:()=>ne(!1),onPointerDown:Ct=>{Ct.target instanceof HTMLElement&&Ct.target.dataset.dismissible==="false"||Ce(!0)},onPointerUp:()=>Ce(!1)},B.filter(Ct=>!Ct.position&&yt===0||Ct.position===Ve).map((Ct,ur)=>{var At,Ht;return je.createElement(Kde,{key:Ct.id,icons:D,index:ur,toast:Ct,defaultRichColors:y,duration:(At=N==null?void 0:N.duration)!=null?At:b,className:N==null?void 0:N.className,descriptionClassName:N==null?void 0:N.descriptionClassName,invert:s,visibleToasts:T,closeButton:(Ht=N==null?void 0:N.closeButton)!=null?Ht:c,interacting:oe,position:Ve,style:N==null?void 0:N.style,unstyled:N==null?void 0:N.unstyled,classNames:N==null?void 0:N.classNames,cancelButtonStyle:N==null?void 0:N.cancelButtonStyle,actionButtonStyle:N==null?void 0:N.actionButtonStyle,removeToast:He,toasts:B.filter(fr=>fr.position==Ct.position),heights:Q.filter(fr=>fr.position==Ct.position),setHeights:re,expandByDefault:o,gap:O,loadingIcon:C,expanded:Z,pauseWhenPageIsHidden:F,swipeDirections:t.swipeDirections})})):null}))});function Zde(){const[t,r]=A.useState(!1),[s,n]=A.useState(!1),[a,o]=A.useState(""),[c,i]=A.useState(!1),[f,p]=A.useState(""),[g,y]=A.useState({code:"",name:"",category:"",status:"active",scheme_id:""}),[b,w]=A.useState(null),T=yr(),{data:N,isLoading:M,error:O}=it({queryKey:["facilities"],queryFn:()=>WF.getAll({per_page:50})}),{data:C}=it({queryKey:["schemes-list"],queryFn:async()=>pe.get("/v1/gis/schemes",{per_page:100})}),L=((C==null?void 0:C.data)||[]).filter(Pe=>Pe.name.toLowerCase().includes(a.toLowerCase())||Pe.code.toLowerCase().includes(a.toLowerCase()));L.length>0||a.trim();const F=gt({mutationFn:Pe=>WF.create(Pe),onSuccess:()=>{T.invalidateQueries({queryKey:["facilities"]}),r(!1),y({code:"",name:"",category:"",status:"active",scheme_id:""}),w(null),Me.success("Facility created successfully")},onError:Pe=>{var Se,ae;Me.error(((ae=(Se=Pe.response)==null?void 0:Se.data)==null?void 0:ae.message)||"Failed to create facility")}}),B=gt({mutationFn:async Pe=>pe.post("/v1/gis/schemes",{name:Pe.name,code:Pe.code,type:"rural",status:"active"}),onSuccess:Pe=>{T.invalidateQueries({queryKey:["schemes-list"]}),w(Pe),y(Se=>({...Se,scheme_id:Pe.id})),i(!1),p(""),Me.success("Scheme created successfully")},onError:Pe=>{var Se,ae;Me.error(((ae=(Se=Pe.response)==null?void 0:Se.data)==null?void 0:ae.message)||"Failed to create scheme")}}),U=Pe=>{if(Pe.preventDefault(),!g.code||!g.name||!g.category){Me.error("Please fill in all required fields");return}const Se={...g,scheme_id:g.scheme_id||null};F.mutate(Se)},te=Pe=>{w(Pe),y(Se=>({...Se,scheme_id:Pe.id})),o(""),n(!1)},Q=()=>{w(null),y(Pe=>({...Pe,scheme_id:""})),o("")},re=()=>{p(a),o(""),n(!1),i(!0)},Z=Pe=>{n(Pe),Pe||o("")},ne=Pe=>{if(Pe.preventDefault(),!f.trim()){Me.error("Please enter a scheme name");return}const Se=f.toUpperCase().replace(/[^A-Z0-9]/g,"-").substring(0,10);B.mutate({name:f,code:Se})},oe=async()=>{try{const Pe=await fetch("/api/v1/gis/facilities/export",{credentials:"include"});if(!Pe.ok)throw new Error(`HTTP ${Pe.status}`);const Se=await Pe.blob(),ae=window.URL.createObjectURL(Se),be=document.createElement("a");be.href=ae,be.download=`facilities-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(be),be.click(),window.URL.revokeObjectURL(ae),document.body.removeChild(be)}catch(Pe){console.error("Export failed:",Pe)}},Ce={source:"bg-blue-500",treatment:"bg-green-500",pumpstation:"bg-purple-500",reservoir:"bg-cyan-500",office:"bg-gray-500",workshop:"bg-yellow-500",warehouse:"bg-orange-500",lab:"bg-pink-500"};return e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Facilities"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage water infrastructure facilities"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{variant:"outline",onClick:oe,children:[e.jsx(ma,{className:"mr-2 h-4 w-4"}),"Export GeoJSON"]}),e.jsxs(Qt,{open:t,onOpenChange:r,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Create Facility"]})}),e.jsxs(Zt,{children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Create New Facility"}),e.jsx(Es,{children:"Add a new water infrastructure facility to the registry"})]}),e.jsxs("form",{onSubmit:U,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"code",children:"Code*"}),e.jsx(Ie,{id:"code",placeholder:"e.g. FAC-001",value:g.code,onChange:Pe=>y({...g,code:Pe.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"category",children:"Category*"}),e.jsxs(Nt,{value:g.category,onValueChange:Pe=>y({...g,category:Pe}),children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select category"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"source",children:"Water Source"}),e.jsx(ge,{value:"treatment",children:"Treatment Plant"}),e.jsx(ge,{value:"pumpstation",children:"Pump Station"}),e.jsx(ge,{value:"reservoir",children:"Reservoir"}),e.jsx(ge,{value:"office",children:"Office"}),e.jsx(ge,{value:"workshop",children:"Workshop"}),e.jsx(ge,{value:"warehouse",children:"Warehouse"}),e.jsx(ge,{value:"lab",children:"Lab"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"name",children:"Name*"}),e.jsx(Ie,{id:"name",placeholder:"Facility name",value:g.name,onChange:Pe=>y({...g,name:Pe.target.value}),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"status",children:"Status"}),e.jsxs(Nt,{value:g.status,onValueChange:Pe=>y({...g,status:Pe}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"active",children:"Active"}),e.jsx(ge,{value:"standby",children:"Standby"}),e.jsx(ge,{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"scheme_id",children:"Scheme (Optional)"}),e.jsxs(zce,{open:s,onOpenChange:Z,children:[e.jsx(Bce,{asChild:!0,children:e.jsxs(K,{variant:"outline",role:"combobox","aria-expanded":s,className:"w-full justify-between font-normal",children:[b?e.jsx("span",{className:"truncate",children:b.name}):e.jsx("span",{className:"text-muted-foreground",children:"Select or type scheme..."}),e.jsx(Vae,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(a7,{className:"w-[300px] p-0",align:"start",children:e.jsxs(p7,{shouldFilter:!1,children:[e.jsx(x7,{placeholder:"Search or type new scheme...",value:a,onValueChange:o}),e.jsxs(g7,{children:[L.length===0&&a.trim()!==""&&e.jsxs(y7,{className:"py-2",children:[e.jsxs("div",{className:"px-2 text-sm text-muted-foreground mb-2",children:['No scheme found for "',a,'"']}),e.jsxs(K,{variant:"ghost",className:"w-full justify-start text-primary",onClick:re,children:[e.jsx(LF,{className:"mr-2 h-4 w-4"}),'Create "',a,'"']})]}),e.jsxs(gM,{children:[b&&e.jsx(qN,{onSelect:Q,className:"text-muted-foreground",children:e.jsx("span",{className:"italic",children:"Clear selection"})}),L.map(Pe=>e.jsxs(qN,{value:Pe.id,onSelect:()=>te(Pe),children:[e.jsx(Kc,{className:dr("mr-2 h-4 w-4",(b==null?void 0:b.id)===Pe.id?"opacity-100":"opacity-0")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:Pe.name}),e.jsx("span",{className:"text-xs text-muted-foreground",children:Pe.code})]})]},Pe.id))]}),a.trim()!==""&&L.length>0&&e.jsx(gM,{children:e.jsxs(qN,{onSelect:re,className:"text-primary",children:[e.jsx(LF,{className:"mr-2 h-4 w-4"}),'Create new scheme "',a,'"']})})]})]})})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:F.isPending,children:F.isPending?"Creating...":"Create Facility"})]})]})]})]})]})]}),e.jsx(Qt,{open:c,onOpenChange:i,children:e.jsxs(Zt,{children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Create New Scheme"}),e.jsx(Es,{children:"The scheme you entered doesn't exist. Would you like to create it?"})]}),e.jsxs("form",{onSubmit:ne,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"newSchemeName",children:"Scheme Name"}),e.jsx(Ie,{id:"newSchemeName",value:f,onChange:Pe=>p(Pe.target.value),placeholder:"Enter scheme name"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:B.isPending,children:B.isPending?"Creating...":"Create Scheme"})]})]})]})}),M&&!N?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading facilities..."})}):O?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-red-600 mb-2",children:"Error loading facilities"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:O.message})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N==null?void 0:N.data.map(Pe=>e.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(he,{children:Pe.name}),e.jsxs(mr,{children:["Code: ",Pe.code]})]}),e.jsx(Ae,{className:Ce[Pe.category]||"bg-gray-500",children:Pe.category})]})}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsx("span",{className:`font-medium capitalize ${Pe.status==="active"?"text-green-600":Pe.status==="standby"?"text-yellow-600":"text-gray-600"}`,children:Pe.status})]}),Pe.scheme&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Scheme:"}),e.jsx("span",{className:"font-medium truncate ml-2",children:Pe.scheme.name})]}),Pe.commissioned_on&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Commissioned:"}),e.jsx("span",{className:"font-medium",children:new Date(Pe.commissioned_on).toLocaleDateString()})]})]})})]},Pe.id))}),(N==null?void 0:N.data.length)===0&&e.jsx(H,{children:e.jsxs(X,{className:"flex flex-col items-center justify-center p-12",children:[e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No facilities found"}),e.jsx(K,{onClick:()=>r(!0),children:"Create Your First Facility"})]})})]})]})}const ir=A.forwardRef(({className:t,...r},s)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:s,className:dr("w-full caption-bottom text-sm",t),...r})}));ir.displayName="Table";const or=A.forwardRef(({className:t,...r},s)=>e.jsx("thead",{ref:s,className:dr("[&_tr]:border-b",t),...r}));or.displayName="TableHeader";const lr=A.forwardRef(({className:t,...r},s)=>e.jsx("tbody",{ref:s,className:dr("[&_tr:last-child]:border-0",t),...r}));lr.displayName="TableBody";const Yde=A.forwardRef(({className:t,...r},s)=>e.jsx("tfoot",{ref:s,className:dr("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...r}));Yde.displayName="TableFooter";const Qe=A.forwardRef(({className:t,...r},s)=>e.jsx("tr",{ref:s,className:dr("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...r}));Qe.displayName="TableRow";const se=A.forwardRef(({className:t,...r},s)=>e.jsx("th",{ref:s,className:dr("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r}));se.displayName="TableHead";const J=A.forwardRef(({className:t,...r},s)=>e.jsx("td",{ref:s,className:dr("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r}));J.displayName="TableCell";const Xde=A.forwardRef(({className:t,...r},s)=>e.jsx("caption",{ref:s,className:dr("mt-4 text-sm text-muted-foreground",t),...r}));Xde.displayName="TableCaption";const Qde=DC,Jde=RC,v7=A.forwardRef(({className:t,...r},s)=>e.jsx(pv,{className:dr("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r,ref:s}));v7.displayName=pv.displayName;const eue=C_("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),j7=A.forwardRef(({side:t="right",className:r,children:s,...n},a)=>e.jsxs(Jde,{children:[e.jsx(v7,{}),e.jsxs(xv,{ref:a,className:dr(eue({side:t}),r),...n,children:[e.jsxs(LC,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(Ko,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]}),s]})]}));j7.displayName=xv.displayName;const b7=({className:t,...r})=>e.jsx("div",{className:dr("flex flex-col space-y-2 text-center sm:text-left",t),...r});b7.displayName="SheetHeader";const _7=A.forwardRef(({className:t,...r},s)=>e.jsx(D_,{ref:s,className:dr("text-lg font-semibold text-foreground",t),...r}));_7.displayName=D_.displayName;const w7=A.forwardRef(({className:t,...r},s)=>e.jsx(R_,{ref:s,className:dr("text-sm text-muted-foreground",t),...r}));w7.displayName=R_.displayName;function Fs(t){const r=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&r==="[object Date]"?new t.constructor(+t):typeof t=="number"||r==="[object Number]"||typeof t=="string"||r==="[object String]"?new Date(t):new Date(NaN)}function Yl(t,r){return t instanceof Date?new t.constructor(r):new Date(r)}function W0(t,r){const s=Fs(t);return isNaN(r)?Yl(t,NaN):(r&&s.setDate(s.getDate()+r),s)}function tue(t,r){const s=Fs(t);if(isNaN(r))return Yl(t,NaN);if(!r)return s;const n=s.getDate(),a=Yl(t,s.getTime());a.setMonth(s.getMonth()+r+1,0);const o=a.getDate();return n>=o?a:(s.setFullYear(a.getFullYear(),a.getMonth(),n),s)}function rue(t,r){const s=+Fs(t);return Yl(t,s+r)}const N7=6048e5,sue=864e5,S7=6e4,qI=36e5,nN=43200,g5=1440;function nue(t,r){return rue(t,r*qI)}let aue={};function $_(){return aue}function Cp(t,r){var i,f,p,g;const s=$_(),n=(r==null?void 0:r.weekStartsOn)??((f=(i=r==null?void 0:r.locale)==null?void 0:i.options)==null?void 0:f.weekStartsOn)??s.weekStartsOn??((g=(p=s.locale)==null?void 0:p.options)==null?void 0:g.weekStartsOn)??0,a=Fs(t),o=a.getDay(),c=(o<n?7:0)+o-n;return a.setDate(a.getDate()-c),a.setHours(0,0,0,0),a}function AS(t){return Cp(t,{weekStartsOn:1})}function C7(t){const r=Fs(t),s=r.getFullYear(),n=Yl(t,0);n.setFullYear(s+1,0,4),n.setHours(0,0,0,0);const a=AS(n),o=Yl(t,0);o.setFullYear(s,0,4),o.setHours(0,0,0,0);const c=AS(o);return r.getTime()>=a.getTime()?s+1:r.getTime()>=c.getTime()?s:s-1}function jy(t){const r=Fs(t);return r.setHours(0,0,0,0),r}function TS(t){const r=Fs(t),s=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return s.setUTCFullYear(r.getFullYear()),+t-+s}function iue(t,r){const s=jy(t),n=jy(r),a=+s-TS(s),o=+n-TS(n);return Math.round((a-o)/sue)}function oue(t){const r=C7(t),s=Yl(t,0);return s.setFullYear(r,0,4),s.setHours(0,0,0,0),AS(s)}function VN(t,r){const s=Fs(t),n=Fs(r),a=s.getTime()-n.getTime();return a<0?-1:a>0?1:a}function lue(t){return Yl(t,Date.now())}function y5(t,r){const s=jy(t),n=jy(r);return+s==+n}function cue(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function due(t){if(!cue(t)&&typeof t!="number")return!1;const r=Fs(t);return!isNaN(Number(r))}function uue(t,r){const s=Fs(t),n=Fs(r),a=s.getFullYear()-n.getFullYear(),o=s.getMonth()-n.getMonth();return a*12+o}function hue(t){return r=>{const n=(t?Math[t]:Math.trunc)(r);return n===0?0:n}}function mue(t,r){return+Fs(t)-+Fs(r)}function fue(t){const r=Fs(t);return r.setHours(23,59,59,999),r}function pue(t){const r=Fs(t),s=r.getMonth();return r.setFullYear(r.getFullYear(),s+1,0),r.setHours(23,59,59,999),r}function xue(t){const r=Fs(t);return+fue(r)==+pue(r)}function P7(t,r){const s=Fs(t),n=Fs(r),a=VN(s,n),o=Math.abs(uue(s,n));let c;if(o<1)c=0;else{s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-a*o);let i=VN(s,n)===-a;xue(Fs(t))&&o===1&&VN(t,n)===1&&(i=!1),c=a*(o-Number(i))}return c===0?0:c}function gue(t,r,s){const n=mue(t,r)/1e3;return hue(s==null?void 0:s.roundingMethod)(n)}function yue(t,r){const s=Fs(t.start),n=Fs(t.end);let a=+s>+n;const o=a?+s:+n,c=a?n:s;c.setHours(0,0,0,0);let i=1;const f=[];for(;+c<=o;)f.push(Fs(c)),c.setDate(c.getDate()+i),c.setHours(0,0,0,0);return a?f.reverse():f}function vue(t){const r=Fs(t),s=Yl(t,0);return s.setFullYear(r.getFullYear(),0,1),s.setHours(0,0,0,0),s}function jue(t,r){const s=r==null?void 0:r.weekStartsOn,n=Fs(t),a=n.getDay(),o=(a<s?-7:0)+6-(a-s);return n.setDate(n.getDate()+o),n.setHours(23,59,59,999),n}const bue={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},_ue=(t,r,s)=>{let n;const a=bue[t];return typeof a=="string"?n=a:r===1?n=a.one:n=a.other.replace("{{count}}",r.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"in "+n:n+" ago":n};function zA(t){return(r={})=>{const s=r.width?String(r.width):t.defaultWidth;return t.formats[s]||t.formats[t.defaultWidth]}}const wue={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Nue={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Sue={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Cue={date:zA({formats:wue,defaultWidth:"full"}),time:zA({formats:Nue,defaultWidth:"full"}),dateTime:zA({formats:Sue,defaultWidth:"full"})},Pue={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},kue=(t,r,s,n)=>Pue[t];function o0(t){return(r,s)=>{const n=s!=null&&s.context?String(s.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const c=t.defaultFormattingWidth||t.defaultWidth,i=s!=null&&s.width?String(s.width):c;a=t.formattingValues[i]||t.formattingValues[c]}else{const c=t.defaultWidth,i=s!=null&&s.width?String(s.width):t.defaultWidth;a=t.values[i]||t.values[c]}const o=t.argumentCallback?t.argumentCallback(r):r;return a[o]}}const Aue={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Tue={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Eue={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Mue={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Oue={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Iue={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Due=(t,r)=>{const s=Number(t),n=s%100;if(n>20||n<10)switch(n%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},Rue={ordinalNumber:Due,era:o0({values:Aue,defaultWidth:"wide"}),quarter:o0({values:Tue,defaultWidth:"wide",argumentCallback:t=>t-1}),month:o0({values:Eue,defaultWidth:"wide"}),day:o0({values:Mue,defaultWidth:"wide"}),dayPeriod:o0({values:Oue,defaultWidth:"wide",formattingValues:Iue,defaultFormattingWidth:"wide"})};function l0(t){return(r,s={})=>{const n=s.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],o=r.match(a);if(!o)return null;const c=o[0],i=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],f=Array.isArray(i)?Fue(i,y=>y.test(c)):Lue(i,y=>y.test(c));let p;p=t.valueCallback?t.valueCallback(f):f,p=s.valueCallback?s.valueCallback(p):p;const g=r.slice(c.length);return{value:p,rest:g}}}function Lue(t,r){for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&r(t[s]))return s}function Fue(t,r){for(let s=0;s<t.length;s++)if(r(t[s]))return s}function $ue(t){return(r,s={})=>{const n=r.match(t.matchPattern);if(!n)return null;const a=n[0],o=r.match(t.parsePattern);if(!o)return null;let c=t.valueCallback?t.valueCallback(o[0]):o[0];c=s.valueCallback?s.valueCallback(c):c;const i=r.slice(a.length);return{value:c,rest:i}}}const zue=/^(\d+)(th|st|nd|rd)?/i,Bue=/\d+/i,que={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Vue={any:[/^b/i,/^(a|c)/i]},Uue={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Wue={any:[/1/i,/2/i,/3/i,/4/i]},Gue={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Kue={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Hue={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Zue={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Yue={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Xue={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Que={ordinalNumber:$ue({matchPattern:zue,parsePattern:Bue,valueCallback:t=>parseInt(t,10)}),era:l0({matchPatterns:que,defaultMatchWidth:"wide",parsePatterns:Vue,defaultParseWidth:"any"}),quarter:l0({matchPatterns:Uue,defaultMatchWidth:"wide",parsePatterns:Wue,defaultParseWidth:"any",valueCallback:t=>t+1}),month:l0({matchPatterns:Gue,defaultMatchWidth:"wide",parsePatterns:Kue,defaultParseWidth:"any"}),day:l0({matchPatterns:Hue,defaultMatchWidth:"wide",parsePatterns:Zue,defaultParseWidth:"any"}),dayPeriod:l0({matchPatterns:Yue,defaultMatchWidth:"any",parsePatterns:Xue,defaultParseWidth:"any"})},k7={code:"en-US",formatDistance:_ue,formatLong:Cue,formatRelative:kue,localize:Rue,match:Que,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Jue(t){const r=Fs(t);return iue(r,vue(r))+1}function ehe(t){const r=Fs(t),s=+AS(r)-+oue(r);return Math.round(s/N7)+1}function A7(t,r){var g,y,b,w;const s=Fs(t),n=s.getFullYear(),a=$_(),o=(r==null?void 0:r.firstWeekContainsDate)??((y=(g=r==null?void 0:r.locale)==null?void 0:g.options)==null?void 0:y.firstWeekContainsDate)??a.firstWeekContainsDate??((w=(b=a.locale)==null?void 0:b.options)==null?void 0:w.firstWeekContainsDate)??1,c=Yl(t,0);c.setFullYear(n+1,0,o),c.setHours(0,0,0,0);const i=Cp(c,r),f=Yl(t,0);f.setFullYear(n,0,o),f.setHours(0,0,0,0);const p=Cp(f,r);return s.getTime()>=i.getTime()?n+1:s.getTime()>=p.getTime()?n:n-1}function the(t,r){var i,f,p,g;const s=$_(),n=(r==null?void 0:r.firstWeekContainsDate)??((f=(i=r==null?void 0:r.locale)==null?void 0:i.options)==null?void 0:f.firstWeekContainsDate)??s.firstWeekContainsDate??((g=(p=s.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??1,a=A7(t,r),o=Yl(t,0);return o.setFullYear(a,0,n),o.setHours(0,0,0,0),Cp(o,r)}function rhe(t,r){const s=Fs(t),n=+Cp(s,r)-+the(s,r);return Math.round(n/N7)+1}function hn(t,r){const s=t<0?"-":"",n=Math.abs(t).toString().padStart(r,"0");return s+n}const Eh={y(t,r){const s=t.getFullYear(),n=s>0?s:1-s;return hn(r==="yy"?n%100:n,r.length)},M(t,r){const s=t.getMonth();return r==="M"?String(s+1):hn(s+1,2)},d(t,r){return hn(t.getDate(),r.length)},a(t,r){const s=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return s.toUpperCase();case"aaa":return s;case"aaaaa":return s[0];case"aaaa":default:return s==="am"?"a.m.":"p.m."}},h(t,r){return hn(t.getHours()%12||12,r.length)},H(t,r){return hn(t.getHours(),r.length)},m(t,r){return hn(t.getMinutes(),r.length)},s(t,r){return hn(t.getSeconds(),r.length)},S(t,r){const s=r.length,n=t.getMilliseconds(),a=Math.trunc(n*Math.pow(10,s-3));return hn(a,r.length)}},tg={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},v5={G:function(t,r,s){const n=t.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return s.era(n,{width:"abbreviated"});case"GGGGG":return s.era(n,{width:"narrow"});case"GGGG":default:return s.era(n,{width:"wide"})}},y:function(t,r,s){if(r==="yo"){const n=t.getFullYear(),a=n>0?n:1-n;return s.ordinalNumber(a,{unit:"year"})}return Eh.y(t,r)},Y:function(t,r,s,n){const a=A7(t,n),o=a>0?a:1-a;if(r==="YY"){const c=o%100;return hn(c,2)}return r==="Yo"?s.ordinalNumber(o,{unit:"year"}):hn(o,r.length)},R:function(t,r){const s=C7(t);return hn(s,r.length)},u:function(t,r){const s=t.getFullYear();return hn(s,r.length)},Q:function(t,r,s){const n=Math.ceil((t.getMonth()+1)/3);switch(r){case"Q":return String(n);case"QQ":return hn(n,2);case"Qo":return s.ordinalNumber(n,{unit:"quarter"});case"QQQ":return s.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return s.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,r,s){const n=Math.ceil((t.getMonth()+1)/3);switch(r){case"q":return String(n);case"qq":return hn(n,2);case"qo":return s.ordinalNumber(n,{unit:"quarter"});case"qqq":return s.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return s.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,r,s){const n=t.getMonth();switch(r){case"M":case"MM":return Eh.M(t,r);case"Mo":return s.ordinalNumber(n+1,{unit:"month"});case"MMM":return s.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return s.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(n,{width:"wide",context:"formatting"})}},L:function(t,r,s){const n=t.getMonth();switch(r){case"L":return String(n+1);case"LL":return hn(n+1,2);case"Lo":return s.ordinalNumber(n+1,{unit:"month"});case"LLL":return s.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return s.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(n,{width:"wide",context:"standalone"})}},w:function(t,r,s,n){const a=rhe(t,n);return r==="wo"?s.ordinalNumber(a,{unit:"week"}):hn(a,r.length)},I:function(t,r,s){const n=ehe(t);return r==="Io"?s.ordinalNumber(n,{unit:"week"}):hn(n,r.length)},d:function(t,r,s){return r==="do"?s.ordinalNumber(t.getDate(),{unit:"date"}):Eh.d(t,r)},D:function(t,r,s){const n=Jue(t);return r==="Do"?s.ordinalNumber(n,{unit:"dayOfYear"}):hn(n,r.length)},E:function(t,r,s){const n=t.getDay();switch(r){case"E":case"EE":case"EEE":return s.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return s.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(n,{width:"short",context:"formatting"});case"EEEE":default:return s.day(n,{width:"wide",context:"formatting"})}},e:function(t,r,s,n){const a=t.getDay(),o=(a-n.weekStartsOn+8)%7||7;switch(r){case"e":return String(o);case"ee":return hn(o,2);case"eo":return s.ordinalNumber(o,{unit:"day"});case"eee":return s.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return s.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(a,{width:"short",context:"formatting"});case"eeee":default:return s.day(a,{width:"wide",context:"formatting"})}},c:function(t,r,s,n){const a=t.getDay(),o=(a-n.weekStartsOn+8)%7||7;switch(r){case"c":return String(o);case"cc":return hn(o,r.length);case"co":return s.ordinalNumber(o,{unit:"day"});case"ccc":return s.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return s.day(a,{width:"narrow",context:"standalone"});case"cccccc":return s.day(a,{width:"short",context:"standalone"});case"cccc":default:return s.day(a,{width:"wide",context:"standalone"})}},i:function(t,r,s){const n=t.getDay(),a=n===0?7:n;switch(r){case"i":return String(a);case"ii":return hn(a,r.length);case"io":return s.ordinalNumber(a,{unit:"day"});case"iii":return s.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return s.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return s.day(n,{width:"short",context:"formatting"});case"iiii":default:return s.day(n,{width:"wide",context:"formatting"})}},a:function(t,r,s){const a=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return s.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,r,s){const n=t.getHours();let a;switch(n===12?a=tg.noon:n===0?a=tg.midnight:a=n/12>=1?"pm":"am",r){case"b":case"bb":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return s.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,r,s){const n=t.getHours();let a;switch(n>=17?a=tg.evening:n>=12?a=tg.afternoon:n>=4?a=tg.morning:a=tg.night,r){case"B":case"BB":case"BBB":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return s.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,r,s){if(r==="ho"){let n=t.getHours()%12;return n===0&&(n=12),s.ordinalNumber(n,{unit:"hour"})}return Eh.h(t,r)},H:function(t,r,s){return r==="Ho"?s.ordinalNumber(t.getHours(),{unit:"hour"}):Eh.H(t,r)},K:function(t,r,s){const n=t.getHours()%12;return r==="Ko"?s.ordinalNumber(n,{unit:"hour"}):hn(n,r.length)},k:function(t,r,s){let n=t.getHours();return n===0&&(n=24),r==="ko"?s.ordinalNumber(n,{unit:"hour"}):hn(n,r.length)},m:function(t,r,s){return r==="mo"?s.ordinalNumber(t.getMinutes(),{unit:"minute"}):Eh.m(t,r)},s:function(t,r,s){return r==="so"?s.ordinalNumber(t.getSeconds(),{unit:"second"}):Eh.s(t,r)},S:function(t,r){return Eh.S(t,r)},X:function(t,r,s){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(r){case"X":return b5(n);case"XXXX":case"XX":return Ff(n);case"XXXXX":case"XXX":default:return Ff(n,":")}},x:function(t,r,s){const n=t.getTimezoneOffset();switch(r){case"x":return b5(n);case"xxxx":case"xx":return Ff(n);case"xxxxx":case"xxx":default:return Ff(n,":")}},O:function(t,r,s){const n=t.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+j5(n,":");case"OOOO":default:return"GMT"+Ff(n,":")}},z:function(t,r,s){const n=t.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+j5(n,":");case"zzzz":default:return"GMT"+Ff(n,":")}},t:function(t,r,s){const n=Math.trunc(t.getTime()/1e3);return hn(n,r.length)},T:function(t,r,s){const n=t.getTime();return hn(n,r.length)}};function j5(t,r=""){const s=t>0?"-":"+",n=Math.abs(t),a=Math.trunc(n/60),o=n%60;return o===0?s+String(a):s+String(a)+r+hn(o,2)}function b5(t,r){return t%60===0?(t>0?"-":"+")+hn(Math.abs(t)/60,2):Ff(t,r)}function Ff(t,r=""){const s=t>0?"-":"+",n=Math.abs(t),a=hn(Math.trunc(n/60),2),o=hn(n%60,2);return s+a+r+o}const _5=(t,r)=>{switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},T7=(t,r)=>{switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},she=(t,r)=>{const s=t.match(/(P+)(p+)?/)||[],n=s[1],a=s[2];if(!a)return _5(t,r);let o;switch(n){case"P":o=r.dateTime({width:"short"});break;case"PP":o=r.dateTime({width:"medium"});break;case"PPP":o=r.dateTime({width:"long"});break;case"PPPP":default:o=r.dateTime({width:"full"});break}return o.replace("{{date}}",_5(n,r)).replace("{{time}}",T7(a,r))},nhe={p:T7,P:she},ahe=/^D+$/,ihe=/^Y+$/,ohe=["D","DD","YY","YYYY"];function lhe(t){return ahe.test(t)}function che(t){return ihe.test(t)}function dhe(t,r,s){const n=uhe(t,r,s);if(console.warn(n),ohe.includes(t))throw new RangeError(n)}function uhe(t,r,s){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${r}\`) for formatting ${n} to the input \`${s}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const hhe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,mhe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,fhe=/^'([^]*?)'?$/,phe=/''/g,xhe=/[a-zA-Z]/;function Ur(t,r,s){var g,y,b,w;const n=$_(),a=n.locale??k7,o=n.firstWeekContainsDate??((y=(g=n.locale)==null?void 0:g.options)==null?void 0:y.firstWeekContainsDate)??1,c=n.weekStartsOn??((w=(b=n.locale)==null?void 0:b.options)==null?void 0:w.weekStartsOn)??0,i=Fs(t);if(!due(i))throw new RangeError("Invalid time value");let f=r.match(mhe).map(T=>{const N=T[0];if(N==="p"||N==="P"){const M=nhe[N];return M(T,a.formatLong)}return T}).join("").match(hhe).map(T=>{if(T==="''")return{isToken:!1,value:"'"};const N=T[0];if(N==="'")return{isToken:!1,value:ghe(T)};if(v5[N])return{isToken:!0,value:T};if(N.match(xhe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+N+"`");return{isToken:!1,value:T}});a.localize.preprocessor&&(f=a.localize.preprocessor(i,f));const p={firstWeekContainsDate:o,weekStartsOn:c,locale:a};return f.map(T=>{if(!T.isToken)return T.value;const N=T.value;(che(N)||lhe(N))&&dhe(N,r,String(t));const M=v5[N[0]];return M(i,N,a.localize,p)}).join("")}function ghe(t){const r=t.match(fhe);return r?r[1].replace(phe,"'"):t}function yhe(t,r,s){const n=$_(),a=(s==null?void 0:s.locale)??n.locale??k7,o=2520,c=VN(t,r);if(isNaN(c))throw new RangeError("Invalid time value");const i=Object.assign({},s,{addSuffix:s==null?void 0:s.addSuffix,comparison:c});let f,p;c>0?(f=Fs(r),p=Fs(t)):(f=Fs(t),p=Fs(r));const g=gue(p,f),y=(TS(p)-TS(f))/1e3,b=Math.round((g-y)/60);let w;if(b<2)return s!=null&&s.includeSeconds?g<5?a.formatDistance("lessThanXSeconds",5,i):g<10?a.formatDistance("lessThanXSeconds",10,i):g<20?a.formatDistance("lessThanXSeconds",20,i):g<40?a.formatDistance("halfAMinute",0,i):g<60?a.formatDistance("lessThanXMinutes",1,i):a.formatDistance("xMinutes",1,i):b===0?a.formatDistance("lessThanXMinutes",1,i):a.formatDistance("xMinutes",b,i);if(b<45)return a.formatDistance("xMinutes",b,i);if(b<90)return a.formatDistance("aboutXHours",1,i);if(b<g5){const T=Math.round(b/60);return a.formatDistance("aboutXHours",T,i)}else{if(b<o)return a.formatDistance("xDays",1,i);if(b<nN){const T=Math.round(b/g5);return a.formatDistance("xDays",T,i)}else if(b<nN*2)return w=Math.round(b/nN),a.formatDistance("aboutXMonths",w,i)}if(w=P7(p,f),w<12){const T=Math.round(b/nN);return a.formatDistance("xMonths",T,i)}else{const T=w%12,N=Math.trunc(w/12);return T<3?a.formatDistance("aboutXYears",N,i):T<9?a.formatDistance("overXYears",N,i):a.formatDistance("almostXYears",N+1,i)}}function E7(t,r){return yhe(t,lue(t),r)}function vhe(t){return+Fs(t)<Date.now()}function BA(t,r){return W0(t,-r)}function hd(t,r){const n=whe(t);let a;if(n.date){const f=Nhe(n.date,2);a=She(f.restDateString,f.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const o=a.getTime();let c=0,i;if(n.time&&(c=Che(n.time),isNaN(c)))return new Date(NaN);if(n.timezone){if(i=Phe(n.timezone),isNaN(i))return new Date(NaN)}else{const f=new Date(o+c),p=new Date(0);return p.setFullYear(f.getUTCFullYear(),f.getUTCMonth(),f.getUTCDate()),p.setHours(f.getUTCHours(),f.getUTCMinutes(),f.getUTCSeconds(),f.getUTCMilliseconds()),p}return new Date(o+c+i)}const aN={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},jhe=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,bhe=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,_he=/^([+-])(\d{2})(?::?(\d{2}))?$/;function whe(t){const r={},s=t.split(aN.dateTimeDelimiter);let n;if(s.length>2)return r;if(/:/.test(s[0])?n=s[0]:(r.date=s[0],n=s[1],aN.timeZoneDelimiter.test(r.date)&&(r.date=t.split(aN.timeZoneDelimiter)[0],n=t.substr(r.date.length,t.length))),n){const a=aN.timezone.exec(n);a?(r.time=n.replace(a[1],""),r.timezone=a[1]):r.time=n}return r}function Nhe(t,r){const s=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+r)+"})|(\\d{2}|[+-]\\d{"+(2+r)+"})$)"),n=t.match(s);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,o=n[2]?parseInt(n[2]):null;return{year:o===null?a:o*100,restDateString:t.slice((n[1]||n[2]).length)}}function She(t,r){if(r===null)return new Date(NaN);const s=t.match(jhe);if(!s)return new Date(NaN);const n=!!s[4],a=c0(s[1]),o=c0(s[2])-1,c=c0(s[3]),i=c0(s[4]),f=c0(s[5])-1;if(n)return Mhe(r,i,f)?khe(r,i,f):new Date(NaN);{const p=new Date(0);return!The(r,o,c)||!Ehe(r,a)?new Date(NaN):(p.setUTCFullYear(r,o,Math.max(a,c)),p)}}function c0(t){return t?parseInt(t):1}function Che(t){const r=t.match(bhe);if(!r)return NaN;const s=qA(r[1]),n=qA(r[2]),a=qA(r[3]);return Ohe(s,n,a)?s*qI+n*S7+a*1e3:NaN}function qA(t){return t&&parseFloat(t.replace(",","."))||0}function Phe(t){if(t==="Z")return 0;const r=t.match(_he);if(!r)return 0;const s=r[1]==="+"?-1:1,n=parseInt(r[2]),a=r[3]&&parseInt(r[3])||0;return Ihe(n,a)?s*(n*qI+a*S7):NaN}function khe(t,r,s){const n=new Date(0);n.setUTCFullYear(t,0,4);const a=n.getUTCDay()||7,o=(r-1)*7+s+1-a;return n.setUTCDate(n.getUTCDate()+o),n}const Ahe=[31,null,31,30,31,30,31,31,30,31,30,31];function M7(t){return t%400===0||t%4===0&&t%100!==0}function The(t,r,s){return r>=0&&r<=11&&s>=1&&s<=(Ahe[r]||(M7(t)?29:28))}function Ehe(t,r){return r>=1&&r<=(M7(t)?366:365)}function Mhe(t,r,s){return r>=1&&r<=53&&s>=0&&s<=6}function Ohe(t,r,s){return t===24?r===0&&s===0:s>=0&&s<60&&r>=0&&r<60&&t>=0&&t<25}function Ihe(t,r){return r>=0&&r<=59}function Dhe(t,r){return tue(t,-r)}function w5(t,r){return nue(t,-r)}function Rhe(){const[t,r]=A.useState(""),[s,n]=A.useState("all"),[a,o]=A.useState("all"),[c,i]=A.useState("all"),[f,p]=A.useState(null),[g,y]=A.useState(1),{data:b,isLoading:w}=it({queryKey:["meters",g,t,s,a,c],queryFn:async()=>{const D=new URLSearchParams({page:g.toString(),per_page:"15",...t&&{q:t},...s!=="all"&&{type:s},...a!=="all"&&{status:a},...c!=="all"&&{dma_id:c}}),L=await fetch(`/api/v1/meters?${D}`,{credentials:"include"});return L.ok?L.json():{data:Lhe(),current_page:1,last_page:1,per_page:15,total:8}}}),{data:T}=it({queryKey:["dmas-list"],queryFn:async()=>{const D=await fetch("/api/v1/dmas?per_page=100",{credentials:"include"});return D.ok?(await D.json()).data:[]}}),{data:N}=it({queryKey:["meter-calibration",f==null?void 0:f.id],queryFn:async()=>{if(!f)return[];const D=await fetch(`/api/v1/meters/${f.id}/calibrations`,{credentials:"include"});return D.ok?D.json():Fhe()},enabled:!!f}),M=D=>{switch(D){case"active":return e.jsxs(Ae,{className:"bg-green-500",children:[e.jsx(Ns,{className:"h-3 w-3 mr-1"}),"Active"]});case"faulty":return e.jsxs(Ae,{className:"bg-red-500",children:[e.jsx(ec,{className:"h-3 w-3 mr-1"}),"Faulty"]});case"decommissioned":return e.jsx(Ae,{variant:"outline",children:"Decommissioned"});default:return e.jsx(Ae,{variant:"outline",children:D})}},O=D=>D?new Date(D)<new Date:!1,C=D=>D?P7(new Date,new Date(D)):null;return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(zc,{className:"h-8 w-8"}),"Meter Registry"]}),e.jsx("p",{className:"text-muted-foreground",children:"Asset register for bulk and customer meters with calibration tracking"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(H,{children:e.jsxs(ue,{className:"pb-3",children:[e.jsx(mr,{children:"Total Meters"}),e.jsx(he,{className:"text-3xl",children:(b==null?void 0:b.total)||0})]})}),e.jsx(H,{children:e.jsxs(ue,{className:"pb-3",children:[e.jsx(mr,{children:"Active"}),e.jsx(he,{className:"text-3xl text-green-600",children:(b==null?void 0:b.data.filter(D=>D.status==="active").length)||0})]})}),e.jsx(H,{children:e.jsxs(ue,{className:"pb-3",children:[e.jsx(mr,{children:"Faulty"}),e.jsx(he,{className:"text-3xl text-red-600",children:(b==null?void 0:b.data.filter(D=>D.status==="faulty").length)||0})]})}),e.jsx(H,{children:e.jsxs(ue,{className:"pb-3",children:[e.jsx(mr,{children:"Calibration Overdue"}),e.jsx(he,{className:"text-3xl text-orange-600",children:(b==null?void 0:b.data.filter(D=>O(D.calibration_due)).length)||0})]})})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Serial number or location...",value:t,onChange:D=>r(D.target.value),className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Type"}),e.jsxs(Nt,{value:s,onValueChange:n,children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Types"}),e.jsx(ge,{value:"bulk",children:"Bulk Meters"}),e.jsx(ge,{value:"customer",children:"Customer Meters"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Status"}),e.jsxs(Nt,{value:a,onValueChange:o,children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Statuses"}),e.jsx(ge,{value:"active",children:"Active"}),e.jsx(ge,{value:"faulty",children:"Faulty"}),e.jsx(ge,{value:"decommissioned",children:"Decommissioned"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"DMA"}),e.jsxs(Nt,{value:c,onValueChange:i,children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All DMAs"}),T==null?void 0:T.map(D=>e.jsxs(ge,{value:D.id,children:[D.code," - ",D.name]},D.id))]})]})]})]})})}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(he,{children:"Meters"}),e.jsx(mr,{children:"Click a row to view details and calibration history"})]}),e.jsxs(K,{children:[e.jsx(Gn,{className:"mr-2 h-4 w-4"}),"Add Meter"]})]})}),e.jsxs(X,{children:[e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Serial Number"}),e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Location"}),e.jsx(se,{children:"DMA"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Last Calibration"}),e.jsx(se,{children:"Tamper Flags"}),e.jsx(se,{children:"Accuracy"})]})}),e.jsx(lr,{children:w?e.jsx(Qe,{children:e.jsx(J,{colSpan:8,className:"text-center py-8",children:"Loading meters..."})}):(b==null?void 0:b.data.length)===0?e.jsx(Qe,{children:e.jsx(J,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No meters found"})}):b==null?void 0:b.data.map(D=>e.jsxs(Qe,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>p(D),children:[e.jsx(J,{className:"font-mono font-medium",children:D.serial_number}),e.jsx(J,{className:"capitalize",children:D.type}),e.jsx(J,{children:D.location}),e.jsx(J,{children:D.dma_name||"N/A"}),e.jsx(J,{children:M(D.status)}),e.jsx(J,{children:D.last_calibration?e.jsxs("div",{children:[e.jsx("div",{className:"text-sm",children:Ur(new Date(D.last_calibration),"MMM dd, yyyy")}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[C(D.last_calibration)," months ago"]})]}):e.jsx("span",{className:"text-muted-foreground",children:"Never"})}),e.jsx(J,{children:D.tamper_flags>0?e.jsxs(Ae,{variant:"destructive",className:"gap-1",children:[e.jsx(Fr,{className:"h-3 w-3"}),D.tamper_flags]}):e.jsx("span",{className:"text-muted-foreground text-sm",children:"None"})}),e.jsx(J,{children:e.jsxs("span",{className:D.accuracy_rating<95?"text-orange-600 font-medium":"",children:[D.accuracy_rating.toFixed(1),"%"]})})]},D.id))})]}),b&&b.last_page>1&&e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",(b.current_page-1)*b.per_page+1," to ",Math.min(b.current_page*b.per_page,b.total)," of ",b.total," meters"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{variant:"outline",size:"sm",disabled:g===1,onClick:()=>y(D=>D-1),children:"Previous"}),e.jsx(K,{variant:"outline",size:"sm",disabled:g>=b.last_page,onClick:()=>y(D=>D+1),children:"Next"})]})]})]})]}),e.jsx(Qde,{open:!!f,onOpenChange:D=>!D&&p(null),children:e.jsx(j7,{className:"w-[600px] sm:max-w-[600px] overflow-y-auto",children:f&&e.jsxs(e.Fragment,{children:[e.jsxs(b7,{children:[e.jsxs(_7,{className:"flex items-center gap-2",children:[e.jsx(zc,{className:"h-5 w-5"}),f.serial_number]}),e.jsx(w7,{children:f.location})]}),e.jsxs("div",{className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Type"}),e.jsx("p",{className:"text-lg capitalize",children:f.type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsx("div",{className:"mt-1",children:M(f.status)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"DMA"}),e.jsx("p",{className:"text-lg",children:f.dma_name||"Not assigned"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Install Date"}),e.jsx("p",{className:"text-lg",children:Ur(new Date(f.install_date),"MMM dd, yyyy")})]})]}),e.jsxs(H,{className:O(f.calibration_due)?"border-orange-500":"",children:[e.jsx(ue,{className:"pb-3",children:e.jsx(he,{className:"text-base",children:"Calibration Status"})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Last Calibration"}),e.jsx("p",{className:"font-medium",children:f.last_calibration?Ur(new Date(f.last_calibration),"MMM dd, yyyy"):"Never calibrated"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Next Due"}),e.jsx("p",{className:`font-medium ${O(f.calibration_due)?"text-orange-600":""}`,children:f.calibration_due?Ur(new Date(f.calibration_due),"MMM dd, yyyy"):"Not scheduled"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Current Accuracy"}),e.jsxs("p",{className:`text-2xl font-bold ${f.accuracy_rating<95?"text-orange-600":"text-green-600"}`,children:[f.accuracy_rating.toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Tamper Flags"}),e.jsx("p",{className:`text-2xl font-bold ${f.tamper_flags>0?"text-red-600":"text-green-600"}`,children:f.tamper_flags})]})]}),O(f.calibration_due)&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-orange-600 bg-orange-50 p-2 rounded",children:[e.jsx(Fr,{className:"h-4 w-4"}),"Calibration overdue - schedule maintenance"]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsx(he,{className:"text-base",children:"Latest Reading"})}),e.jsx(X,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Reading"}),e.jsxs("p",{className:"text-2xl font-bold",children:[f.last_reading.toLocaleString()," m"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Date"}),e.jsx("p",{className:"font-medium",children:Ur(new Date(f.last_reading_date),"MMM dd, yyyy HH:mm")})]})]})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-base",children:"Calibration History"})}),e.jsx(X,{children:N&&N.length>0?e.jsx("div",{className:"space-y-3",children:N.map(D=>e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:Ur(new Date(D.date),"MMM dd, yyyy")}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["By ",D.technician]})]}),e.jsx(Ae,{variant:D.result==="pass"?"default":"destructive",children:D.result})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Before: "}),e.jsxs("span",{className:"font-medium",children:[D.accuracy_before,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"After: "}),e.jsxs("span",{className:"font-medium",children:[D.accuracy_after,"%"]})]})]}),D.notes&&e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:D.notes})]},D.id))}):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No calibration history available"})})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsx(K,{className:"flex-1",children:"Schedule Calibration"}),e.jsx(K,{variant:"outline",className:"flex-1",children:"View Full History"})]})]})]})})})]})}function Lhe(){return[{id:"1",serial_number:"BM-2024-001",type:"bulk",status:"active",location:"Central Treatment Plant - Outlet",dma_name:"Central DMA",install_date:"2023-01-15",last_calibration:"2024-09-10",calibration_due:"2025-03-10",tamper_flags:0,accuracy_rating:98.5,last_reading:145678,last_reading_date:"2025-11-21T08:00:00Z"},{id:"2",serial_number:"BM-2024-002",type:"bulk",status:"active",location:"East Zone Distribution",dma_name:"East DMA",install_date:"2023-03-20",last_calibration:"2024-06-15",calibration_due:"2024-12-15",tamper_flags:1,accuracy_rating:96.2,last_reading:89234,last_reading_date:"2025-11-21T07:55:00Z"},{id:"3",serial_number:"CM-2024-1234",type:"customer",status:"active",location:"123 Main Street",install_date:"2024-01-10",last_calibration:"2024-01-10",calibration_due:"2027-01-10",tamper_flags:0,accuracy_rating:99.1,last_reading:1256,last_reading_date:"2025-11-20T18:00:00Z"},{id:"4",serial_number:"BM-2023-015",type:"bulk",status:"faulty",location:"West Reservoir Inlet",dma_name:"West DMA",install_date:"2022-11-05",last_calibration:"2024-03-20",calibration_due:"2024-09-20",tamper_flags:3,accuracy_rating:87.3,last_reading:234567,last_reading_date:"2025-11-19T14:30:00Z"}]}function Fhe(){return[{id:"1",date:"2024-09-10",result:"pass",accuracy_before:97.8,accuracy_after:98.5,technician:"John Mwangi",notes:"Routine calibration completed successfully"},{id:"2",date:"2024-03-10",result:"pass",accuracy_before:96.5,accuracy_after:97.8,technician:"Jane Wanjiku",notes:"Minor adjustments made to flow sensor"},{id:"3",date:"2023-09-15",result:"pass",accuracy_before:98.1,accuracy_after:98.3,technician:"Peter Kamau",notes:"All readings within acceptable range"}]}const vM={getAll:t=>pe.get("/dmas",t),getById:t=>pe.get(`/dmas/${t}`),create:t=>pe.post("/dmas",t),update:(t,r)=>pe.patch(`/dmas/${t}`,r),delete:t=>pe.delete(`/dmas/${t}`)};function $he(){const{user:t,hasPermission:r,hasRole:s}=Lm();return{user:t,can:p=>r(p),hasAnyPermission:p=>p.some(g=>r(g)),hasAllPermissions:p=>p.every(g=>r(g)),is:p=>s(p),hasAnyRole:p=>p.some(g=>s(g)),hasAllRoles:p=>p.every(g=>s(g))}}function Cm({permission:t,permissions:r,requireAll:s=!1,role:n,roles:a,requireAllRoles:o=!1,fallback:c=null,children:i}){const{can:f,hasAnyPermission:p,hasAllPermissions:g,is:y,hasAnyRole:b,hasAllRoles:w}=$he();let T=!0;return t?T=f(t):r&&r.length>0&&(T=s?g(r):p(r)),T&&n?T=y(n):T&&a&&a.length>0&&(T=o?w(a):b(a)),T?e.jsx(e.Fragment,{children:i}):e.jsx(e.Fragment,{children:c})}function zhe(){const[t,r]=A.useState(!1),[s,n]=A.useState({code:"",name:"",status:"active"}),a=yr(),{data:o,isLoading:c,error:i}=it({queryKey:["dmas"],queryFn:()=>vM.getAll({per_page:50})}),f=gt({mutationFn:y=>vM.create(y),onSuccess:()=>{a.invalidateQueries({queryKey:["dmas"]}),r(!1),n({code:"",name:"",status:"active"}),Me.success("DMA created successfully")},onError:y=>{var b,w;Me.error(((w=(b=y.response)==null?void 0:b.data)==null?void 0:w.message)||"Failed to create DMA")}}),p=y=>{if(y.preventDefault(),!s.code||!s.name){Me.error("Please fill in all required fields");return}f.mutate({code:s.code,name:s.name,status:s.status})},g=async()=>{try{const y=await fetch("/api/v1/gis/dmas/export",{credentials:"include"});if(!y.ok)throw new Error(`HTTP ${y.status}`);const b=await y.blob(),w=window.URL.createObjectURL(b),T=document.createElement("a");T.href=w,T.download=`dmas-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(T),T.click(),window.URL.revokeObjectURL(w),document.body.removeChild(T)}catch(y){console.error("Export failed:",y)}};return e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"District Metered Areas (DMAs)"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage water distribution network DMAs"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{variant:"outline",onClick:g,children:[e.jsx(ma,{className:"mr-2 h-4 w-4"}),"Export GeoJSON"]}),e.jsx(Cm,{permission:"create dmas",children:e.jsxs(Qt,{open:t,onOpenChange:r,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Create DMA"]})}),e.jsxs(Zt,{children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Create New DMA"}),e.jsx(Es,{children:"Add a new District Metered Area to the system"})]}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"code",children:"Code*"}),e.jsx(Ie,{id:"code",placeholder:"e.g. DMA-001",value:s.code,onChange:y=>n({...s,code:y.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"name",children:"Name*"}),e.jsx(Ie,{id:"name",placeholder:"DMA name",value:s.name,onChange:y=>n({...s,name:y.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"status",children:"Status"}),e.jsxs(Nt,{value:s.status,onValueChange:y=>n({...s,status:y}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"active",children:"Active"}),e.jsx(ge,{value:"planned",children:"Planned"}),e.jsx(ge,{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:f.isPending,children:f.isPending?"Creating...":"Create DMA"})]})]})]})]})})]})]}),c&&!o?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading DMAs..."})}):i?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-red-600 mb-2",children:"Error loading DMAs"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.message})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o==null?void 0:o.data.map(y=>e.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(ue,{children:[e.jsx(he,{children:y.name}),e.jsxs(mr,{children:["Code: ",y.code]})]}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsx("span",{className:`font-medium capitalize ${y.status==="active"?"text-green-600":y.status==="planned"?"text-blue-600":"text-gray-600"}`,children:y.status})]}),y.nightline_threshold_m3h&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Nightline:"}),e.jsxs("span",{className:"font-medium",children:[y.nightline_threshold_m3h," m/h"]})]}),y.pressure_target_bar&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Pressure:"}),e.jsxs("span",{className:"font-medium",children:[y.pressure_target_bar," bar"]})]}),y.scheme&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Scheme:"}),e.jsx("span",{className:"font-medium text-xs",children:y.scheme.name})]})]})})]},y.id))}),(o==null?void 0:o.data.length)===0&&e.jsx(H,{children:e.jsxs(X,{className:"flex flex-col items-center justify-center p-12",children:[e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No DMAs found"}),e.jsx(Cm,{permission:"create dmas",children:e.jsx(K,{children:"Create Your First DMA"})})]})})]})]})}const N5={getAll:t=>pe.get("/pipelines",t),getById:t=>pe.get(`/pipelines/${t}`),create:t=>pe.post("/pipelines",t),update:(t,r)=>pe.patch(`/pipelines/${t}`,r),delete:t=>pe.delete(`/pipelines/${t}`)};function Bhe(){const[t,r]=A.useState(!1),[s,n]=A.useState({code:"",material:"uPVC",diameter_mm:"50",status:"active"}),a=yr(),{data:o,isLoading:c,error:i}=it({queryKey:["pipelines"],queryFn:()=>N5.getAll({per_page:50})}),f=gt({mutationFn:g=>N5.create(g),onSuccess:()=>{a.invalidateQueries({queryKey:["pipelines"]}),r(!1),n({code:"",material:"PVC",diameter_mm:"50",status:"active"}),Me.success("Pipeline created successfully")},onError:g=>{var y,b;Me.error(((b=(y=g.response)==null?void 0:y.data)==null?void 0:b.message)||"Failed to create pipeline")}}),p=g=>{if(g.preventDefault(),!s.code||!s.material||!s.diameter_mm){Me.error("Please fill in all required fields");return}f.mutate({code:s.code,material:s.material,diameter_mm:parseInt(s.diameter_mm),status:s.status})};return e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Pipelines"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage water distribution pipelines"})]}),e.jsx(Cm,{permission:"create pipelines",children:e.jsxs(Qt,{open:t,onOpenChange:r,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Create Pipeline"]})}),e.jsxs(Zt,{children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Create New Pipeline"}),e.jsx(Es,{children:"Add a new water distribution pipeline"})]}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"code",children:"Code*"}),e.jsx(Ie,{id:"code",placeholder:"e.g. PIPE-001",value:s.code,onChange:g=>n({...s,code:g.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"material",children:"Material*"}),e.jsxs(Nt,{value:s.material,onValueChange:g=>n({...s,material:g}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"uPVC",children:"uPVC"}),e.jsx(ge,{value:"HDPE",children:"HDPE"}),e.jsx(ge,{value:"Steel",children:"Steel"}),e.jsx(ge,{value:"DI",children:"DI"}),e.jsx(ge,{value:"AC",children:"AC"}),e.jsx(ge,{value:"GI",children:"GI"}),e.jsx(ge,{value:"Other",children:"Other"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"diameter_mm",children:"Diameter (mm)*"}),e.jsx(Ie,{id:"diameter_mm",type:"number",placeholder:"50",value:s.diameter_mm,onChange:g=>n({...s,diameter_mm:g.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"status",children:"Status"}),e.jsxs(Nt,{value:s.status,onValueChange:g=>n({...s,status:g}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"active",children:"Active"}),e.jsx(ge,{value:"leak",children:"Leak"}),e.jsx(ge,{value:"rehab",children:"Rehab"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:f.isPending,children:f.isPending?"Creating...":"Create Pipeline"})]})]})]})]})})]}),c&&!o?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading pipelines..."})}):i?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-red-600 mb-2",children:"Error loading pipelines"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.message})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o==null?void 0:o.data.map(g=>e.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(ue,{children:[e.jsx(he,{children:g.code}),e.jsx(mr,{children:g.material})]}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Diameter:"}),e.jsxs("span",{className:"font-medium",children:[g.diameter_mm," mm"]})]}),g.install_year&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Installed:"}),e.jsx("span",{className:"font-medium",children:g.install_year})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsx("span",{className:`font-medium capitalize ${g.status==="active"?"text-green-600":g.status==="leak"?"text-red-600":g.status==="rehab"?"text-yellow-600":"text-gray-600"}`,children:g.status})]}),g.scheme&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Scheme:"}),e.jsx("span",{className:"font-medium text-xs",children:g.scheme.name})]})]})})]},g.id))}),(o==null?void 0:o.data.length)===0&&e.jsx(H,{children:e.jsxs(X,{className:"flex flex-col items-center justify-center p-12",children:[e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No pipelines found"}),e.jsx(Cm,{permission:"create pipelines",children:e.jsx(K,{children:"Create Your First Pipeline"})})]})})]})]})}const S5={getAll:t=>pe.get("/zones",t),getById:t=>pe.get(`/zones/${t}`),create:t=>pe.post("/zones",t),update:(t,r)=>pe.patch(`/zones/${t}`,r),delete:t=>pe.delete(`/zones/${t}`)};function qhe(){const[t,r]=A.useState(!1),[s,n]=A.useState({code:"",name:"",type:"billing"}),a=yr(),{data:o,isLoading:c,error:i}=it({queryKey:["zones"],queryFn:()=>S5.getAll({per_page:50})}),f=gt({mutationFn:g=>S5.create(g),onSuccess:()=>{a.invalidateQueries({queryKey:["zones"]}),r(!1),n({code:"",name:"",type:"billing"}),Me.success("Zone created successfully")},onError:g=>{var y,b;Me.error(((b=(y=g.response)==null?void 0:y.data)==null?void 0:b.message)||"Failed to create zone")}}),p=g=>{if(g.preventDefault(),!s.code||!s.name){Me.error("Please fill in all required fields");return}f.mutate(s)};return e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Zones"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage geographical zones"})]}),e.jsx(Cm,{permission:"create zones",children:e.jsxs(Qt,{open:t,onOpenChange:r,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Create Zone"]})}),e.jsxs(Zt,{children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Create New Zone"}),e.jsx(Es,{children:"Add a new geographical zone"})]}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"code",children:"Code*"}),e.jsx(Ie,{id:"code",placeholder:"e.g. Z-001",value:s.code,onChange:g=>n({...s,code:g.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"type",children:"Type*"}),e.jsxs(Nt,{value:s.type,onValueChange:g=>n({...s,type:g}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"billing",children:"Billing"}),e.jsx(ge,{value:"service",children:"Service"}),e.jsx(ge,{value:"operational",children:"Operational"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"name",children:"Name*"}),e.jsx(Ie,{id:"name",placeholder:"Zone name",value:s.name,onChange:g=>n({...s,name:g.target.value}),required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:f.isPending,children:f.isPending?"Creating...":"Create Zone"})]})]})]})]})})]}),c&&!o?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading zones..."})}):i?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-red-600 mb-2",children:"Error loading zones"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.message})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o==null?void 0:o.data.map(g=>e.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(ue,{children:[e.jsx(he,{children:g.name}),e.jsxs(mr,{children:["Code: ",g.code]})]}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Type:"}),e.jsx("span",{className:"font-medium capitalize",children:g.type})]}),g.scheme&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Scheme:"}),e.jsx("span",{className:"font-medium text-xs",children:g.scheme.name})]})]})})]},g.id))}),(o==null?void 0:o.data.length)===0&&e.jsx(H,{children:e.jsxs(X,{className:"flex flex-col items-center justify-center p-12",children:[e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No zones found"}),e.jsx(Cm,{permission:"create zones",children:e.jsx(K,{children:"Create Your First Zone"})})]})})]})]})}const C5={getAll:t=>pe.get("/addresses",t),getById:t=>pe.get(`/addresses/${t}`),create:t=>pe.post("/addresses",t),update:(t,r)=>pe.patch(`/addresses/${t}`,r),delete:t=>pe.delete(`/addresses/${t}`)};function Vhe(){const[t,r]=A.useState(!1),[s,n]=A.useState({premise_code:"",street:"",village:"",ward:"",city:"",country:"KE"}),a=yr(),{data:o,isLoading:c,error:i}=it({queryKey:["addresses"],queryFn:()=>C5.getAll({per_page:50})}),f=gt({mutationFn:g=>C5.create(g),onSuccess:()=>{a.invalidateQueries({queryKey:["addresses"]}),r(!1),n({premise_code:"",street:"",village:"",ward:"",city:"",country:"KE"}),Me.success("Address created successfully")},onError:g=>{var y,b;Me.error(((b=(y=g.response)==null?void 0:y.data)==null?void 0:b.message)||"Failed to create address")}}),p=g=>{if(g.preventDefault(),!s.premise_code){Me.error("Please fill in the premise code");return}f.mutate(s)};return e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Addresses"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage customer premises addresses"})]}),e.jsx(Cm,{permission:"create addresses",children:e.jsxs(Qt,{open:t,onOpenChange:r,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Create Address"]})}),e.jsxs(Zt,{className:"max-w-2xl",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Create New Address"}),e.jsx(Es,{children:"Add a new customer premise address"})]}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"premise_code",children:"Premise Code*"}),e.jsx(Ie,{id:"premise_code",placeholder:"e.g. PREM-001",value:s.premise_code,onChange:g=>n({...s,premise_code:g.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"country",children:"Country"}),e.jsx(Ie,{id:"country",placeholder:"KE",value:s.country,onChange:g=>n({...s,country:g.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"street",children:"Street"}),e.jsx(Ie,{id:"street",placeholder:"Street address",value:s.street,onChange:g=>n({...s,street:g.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"village",children:"Village"}),e.jsx(Ie,{id:"village",placeholder:"Village",value:s.village,onChange:g=>n({...s,village:g.target.value})})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"ward",children:"Ward"}),e.jsx(Ie,{id:"ward",placeholder:"Ward",value:s.ward,onChange:g=>n({...s,ward:g.target.value})})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"city",children:"City"}),e.jsx(Ie,{id:"city",placeholder:"City",value:s.city,onChange:g=>n({...s,city:g.target.value})})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:f.isPending,children:f.isPending?"Creating...":"Create Address"})]})]})]})]})})]}),c&&!o?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading addresses..."})}):i?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-red-600 mb-2",children:"Error loading addresses"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.message})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o==null?void 0:o.data.map(g=>e.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(ue,{children:[e.jsx(he,{children:g.premise_code}),e.jsx(mr,{children:[g.street,g.village].filter(Boolean).join(", ")||"No address details"})]}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-2 text-sm",children:[g.ward&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Ward:"}),e.jsx("span",{className:"font-medium",children:g.ward})]}),g.subcounty&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Subcounty:"}),e.jsx("span",{className:"font-medium",children:g.subcounty})]}),g.city&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"City:"}),e.jsx("span",{className:"font-medium",children:g.city})]}),g.what3words&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"What3Words:"}),e.jsx("span",{className:"font-medium text-xs",children:g.what3words})]}),g.scheme&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Scheme:"}),e.jsx("span",{className:"font-medium text-xs",children:g.scheme.name})]})]})})]},g.id))}),(o==null?void 0:o.data.length)===0&&e.jsx(H,{children:e.jsxs(X,{className:"flex flex-col items-center justify-center p-12",children:[e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No addresses found"}),e.jsx(Cm,{permission:"create addresses",children:e.jsx(K,{children:"Create Your First Address"})})]})})]})]})}function Uhe(t,r){return A.useReducer((s,n)=>r[s][n]??s,t)}var VI="ScrollArea",[O7]=tc(VI),[Whe,rc]=O7(VI),I7=A.forwardRef((t,r)=>{const{__scopeScrollArea:s,type:n="hover",dir:a,scrollHideDelay:o=600,...c}=t,[i,f]=A.useState(null),[p,g]=A.useState(null),[y,b]=A.useState(null),[w,T]=A.useState(null),[N,M]=A.useState(null),[O,C]=A.useState(0),[D,L]=A.useState(0),[F,B]=A.useState(!1),[U,te]=A.useState(!1),Q=ls(r,Z=>f(Z)),re=dv(a);return e.jsx(Whe,{scope:s,type:n,dir:re,scrollHideDelay:o,scrollArea:i,viewport:p,onViewportChange:g,content:y,onContentChange:b,scrollbarX:w,onScrollbarXChange:T,scrollbarXEnabled:F,onScrollbarXEnabledChange:B,scrollbarY:N,onScrollbarYChange:M,scrollbarYEnabled:U,onScrollbarYEnabledChange:te,onCornerWidthChange:C,onCornerHeightChange:L,children:e.jsx(Tr.div,{dir:re,...c,ref:Q,style:{position:"relative","--radix-scroll-area-corner-width":O+"px","--radix-scroll-area-corner-height":D+"px",...t.style}})})});I7.displayName=VI;var D7="ScrollAreaViewport",R7=A.forwardRef((t,r)=>{const{__scopeScrollArea:s,children:n,asChild:a,nonce:o,...c}=t,i=rc(D7,s),f=A.useRef(null),p=ls(r,f,i.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:o}),e.jsx(Tr.div,{"data-radix-scroll-area-viewport":"",...c,asChild:a,ref:p,style:{overflowX:i.scrollbarXEnabled?"scroll":"hidden",overflowY:i.scrollbarYEnabled?"scroll":"hidden",...t.style},children:tme({asChild:a,children:n},g=>e.jsx("div",{"data-radix-scroll-area-content":"",ref:i.onContentChange,style:{minWidth:i.scrollbarXEnabled?"fit-content":void 0},children:g}))})]})});R7.displayName=D7;var Rd="ScrollAreaScrollbar",UI=A.forwardRef((t,r)=>{const{forceMount:s,...n}=t,a=rc(Rd,t.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:c}=a,i=t.orientation==="horizontal";return A.useEffect(()=>(i?o(!0):c(!0),()=>{i?o(!1):c(!1)}),[i,o,c]),a.type==="hover"?e.jsx(Ghe,{...n,ref:r,forceMount:s}):a.type==="scroll"?e.jsx(Khe,{...n,ref:r,forceMount:s}):a.type==="auto"?e.jsx(L7,{...n,ref:r,forceMount:s}):a.type==="always"?e.jsx(WI,{...n,ref:r}):null});UI.displayName=Rd;var Ghe=A.forwardRef((t,r)=>{const{forceMount:s,...n}=t,a=rc(Rd,t.__scopeScrollArea),[o,c]=A.useState(!1);return A.useEffect(()=>{const i=a.scrollArea;let f=0;if(i){const p=()=>{window.clearTimeout(f),c(!0)},g=()=>{f=window.setTimeout(()=>c(!1),a.scrollHideDelay)};return i.addEventListener("pointerenter",p),i.addEventListener("pointerleave",g),()=>{window.clearTimeout(f),i.removeEventListener("pointerenter",p),i.removeEventListener("pointerleave",g)}}},[a.scrollArea,a.scrollHideDelay]),e.jsx(Yi,{present:s||o,children:e.jsx(L7,{"data-state":o?"visible":"hidden",...n,ref:r})})}),Khe=A.forwardRef((t,r)=>{const{forceMount:s,...n}=t,a=rc(Rd,t.__scopeScrollArea),o=t.orientation==="horizontal",c=zC(()=>f("SCROLL_END"),100),[i,f]=Uhe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return A.useEffect(()=>{if(i==="idle"){const p=window.setTimeout(()=>f("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(p)}},[i,a.scrollHideDelay,f]),A.useEffect(()=>{const p=a.viewport,g=o?"scrollLeft":"scrollTop";if(p){let y=p[g];const b=()=>{const w=p[g];y!==w&&(f("SCROLL"),c()),y=w};return p.addEventListener("scroll",b),()=>p.removeEventListener("scroll",b)}},[a.viewport,o,f,c]),e.jsx(Yi,{present:s||i!=="hidden",children:e.jsx(WI,{"data-state":i==="hidden"?"hidden":"visible",...n,ref:r,onPointerEnter:gr(t.onPointerEnter,()=>f("POINTER_ENTER")),onPointerLeave:gr(t.onPointerLeave,()=>f("POINTER_LEAVE"))})})}),L7=A.forwardRef((t,r)=>{const s=rc(Rd,t.__scopeScrollArea),{forceMount:n,...a}=t,[o,c]=A.useState(!1),i=t.orientation==="horizontal",f=zC(()=>{if(s.viewport){const p=s.viewport.offsetWidth<s.viewport.scrollWidth,g=s.viewport.offsetHeight<s.viewport.scrollHeight;c(i?p:g)}},10);return by(s.viewport,f),by(s.content,f),e.jsx(Yi,{present:n||o,children:e.jsx(WI,{"data-state":o?"visible":"hidden",...a,ref:r})})}),WI=A.forwardRef((t,r)=>{const{orientation:s="vertical",...n}=t,a=rc(Rd,t.__scopeScrollArea),o=A.useRef(null),c=A.useRef(0),[i,f]=A.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),p=q7(i.viewport,i.content),g={...n,sizes:i,onSizesChange:f,hasThumb:p>0&&p<1,onThumbChange:b=>o.current=b,onThumbPointerUp:()=>c.current=0,onThumbPointerDown:b=>c.current=b};function y(b,w){return Jhe(b,c.current,i,w)}return s==="horizontal"?e.jsx(Hhe,{...g,ref:r,onThumbPositionChange:()=>{if(a.viewport&&o.current){const b=a.viewport.scrollLeft,w=P5(b,i,a.dir);o.current.style.transform=`translate3d(${w}px, 0, 0)`}},onWheelScroll:b=>{a.viewport&&(a.viewport.scrollLeft=b)},onDragScroll:b=>{a.viewport&&(a.viewport.scrollLeft=y(b,a.dir))}}):s==="vertical"?e.jsx(Zhe,{...g,ref:r,onThumbPositionChange:()=>{if(a.viewport&&o.current){const b=a.viewport.scrollTop,w=P5(b,i);o.current.style.transform=`translate3d(0, ${w}px, 0)`}},onWheelScroll:b=>{a.viewport&&(a.viewport.scrollTop=b)},onDragScroll:b=>{a.viewport&&(a.viewport.scrollTop=y(b))}}):null}),Hhe=A.forwardRef((t,r)=>{const{sizes:s,onSizesChange:n,...a}=t,o=rc(Rd,t.__scopeScrollArea),[c,i]=A.useState(),f=A.useRef(null),p=ls(r,f,o.onScrollbarXChange);return A.useEffect(()=>{f.current&&i(getComputedStyle(f.current))},[f]),e.jsx($7,{"data-orientation":"horizontal",...a,ref:p,sizes:s,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":$C(s)+"px",...t.style},onThumbPointerDown:g=>t.onThumbPointerDown(g.x),onDragScroll:g=>t.onDragScroll(g.x),onWheelScroll:(g,y)=>{if(o.viewport){const b=o.viewport.scrollLeft+g.deltaX;t.onWheelScroll(b),U7(b,y)&&g.preventDefault()}},onResize:()=>{f.current&&o.viewport&&c&&n({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:f.current.clientWidth,paddingStart:MS(c.paddingLeft),paddingEnd:MS(c.paddingRight)}})}})}),Zhe=A.forwardRef((t,r)=>{const{sizes:s,onSizesChange:n,...a}=t,o=rc(Rd,t.__scopeScrollArea),[c,i]=A.useState(),f=A.useRef(null),p=ls(r,f,o.onScrollbarYChange);return A.useEffect(()=>{f.current&&i(getComputedStyle(f.current))},[f]),e.jsx($7,{"data-orientation":"vertical",...a,ref:p,sizes:s,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":$C(s)+"px",...t.style},onThumbPointerDown:g=>t.onThumbPointerDown(g.y),onDragScroll:g=>t.onDragScroll(g.y),onWheelScroll:(g,y)=>{if(o.viewport){const b=o.viewport.scrollTop+g.deltaY;t.onWheelScroll(b),U7(b,y)&&g.preventDefault()}},onResize:()=>{f.current&&o.viewport&&c&&n({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:f.current.clientHeight,paddingStart:MS(c.paddingTop),paddingEnd:MS(c.paddingBottom)}})}})}),[Yhe,F7]=O7(Rd),$7=A.forwardRef((t,r)=>{const{__scopeScrollArea:s,sizes:n,hasThumb:a,onThumbChange:o,onThumbPointerUp:c,onThumbPointerDown:i,onThumbPositionChange:f,onDragScroll:p,onWheelScroll:g,onResize:y,...b}=t,w=rc(Rd,s),[T,N]=A.useState(null),M=ls(r,Q=>N(Q)),O=A.useRef(null),C=A.useRef(""),D=w.viewport,L=n.content-n.viewport,F=oi(g),B=oi(f),U=zC(y,10);function te(Q){if(O.current){const re=Q.clientX-O.current.left,Z=Q.clientY-O.current.top;p({x:re,y:Z})}}return A.useEffect(()=>{const Q=re=>{const Z=re.target;(T==null?void 0:T.contains(Z))&&F(re,L)};return document.addEventListener("wheel",Q,{passive:!1}),()=>document.removeEventListener("wheel",Q,{passive:!1})},[D,T,L,F]),A.useEffect(B,[n,B]),by(T,U),by(w.content,U),e.jsx(Yhe,{scope:s,scrollbar:T,hasThumb:a,onThumbChange:oi(o),onThumbPointerUp:oi(c),onThumbPositionChange:B,onThumbPointerDown:oi(i),children:e.jsx(Tr.div,{...b,ref:M,style:{position:"absolute",...b.style},onPointerDown:gr(t.onPointerDown,Q=>{Q.button===0&&(Q.target.setPointerCapture(Q.pointerId),O.current=T.getBoundingClientRect(),C.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",w.viewport&&(w.viewport.style.scrollBehavior="auto"),te(Q))}),onPointerMove:gr(t.onPointerMove,te),onPointerUp:gr(t.onPointerUp,Q=>{const re=Q.target;re.hasPointerCapture(Q.pointerId)&&re.releasePointerCapture(Q.pointerId),document.body.style.webkitUserSelect=C.current,w.viewport&&(w.viewport.style.scrollBehavior=""),O.current=null})})})}),ES="ScrollAreaThumb",z7=A.forwardRef((t,r)=>{const{forceMount:s,...n}=t,a=F7(ES,t.__scopeScrollArea);return e.jsx(Yi,{present:s||a.hasThumb,children:e.jsx(Xhe,{ref:r,...n})})}),Xhe=A.forwardRef((t,r)=>{const{__scopeScrollArea:s,style:n,...a}=t,o=rc(ES,s),c=F7(ES,s),{onThumbPositionChange:i}=c,f=ls(r,y=>c.onThumbChange(y)),p=A.useRef(),g=zC(()=>{p.current&&(p.current(),p.current=void 0)},100);return A.useEffect(()=>{const y=o.viewport;if(y){const b=()=>{if(g(),!p.current){const w=eme(y,i);p.current=w,i()}};return i(),y.addEventListener("scroll",b),()=>y.removeEventListener("scroll",b)}},[o.viewport,g,i]),e.jsx(Tr.div,{"data-state":c.hasThumb?"visible":"hidden",...a,ref:f,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:gr(t.onPointerDownCapture,y=>{const w=y.target.getBoundingClientRect(),T=y.clientX-w.left,N=y.clientY-w.top;c.onThumbPointerDown({x:T,y:N})}),onPointerUp:gr(t.onPointerUp,c.onThumbPointerUp)})});z7.displayName=ES;var GI="ScrollAreaCorner",B7=A.forwardRef((t,r)=>{const s=rc(GI,t.__scopeScrollArea),n=!!(s.scrollbarX&&s.scrollbarY);return s.type!=="scroll"&&n?e.jsx(Qhe,{...t,ref:r}):null});B7.displayName=GI;var Qhe=A.forwardRef((t,r)=>{const{__scopeScrollArea:s,...n}=t,a=rc(GI,s),[o,c]=A.useState(0),[i,f]=A.useState(0),p=!!(o&&i);return by(a.scrollbarX,()=>{var y;const g=((y=a.scrollbarX)==null?void 0:y.offsetHeight)||0;a.onCornerHeightChange(g),f(g)}),by(a.scrollbarY,()=>{var y;const g=((y=a.scrollbarY)==null?void 0:y.offsetWidth)||0;a.onCornerWidthChange(g),c(g)}),p?e.jsx(Tr.div,{...n,ref:r,style:{width:o,height:i,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function MS(t){return t?parseInt(t,10):0}function q7(t,r){const s=t/r;return isNaN(s)?0:s}function $C(t){const r=q7(t.viewport,t.content),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,n=(t.scrollbar.size-s)*r;return Math.max(n,18)}function Jhe(t,r,s,n="ltr"){const a=$C(s),o=a/2,c=r||o,i=a-c,f=s.scrollbar.paddingStart+c,p=s.scrollbar.size-s.scrollbar.paddingEnd-i,g=s.content-s.viewport,y=n==="ltr"?[0,g]:[g*-1,0];return V7([f,p],y)(t)}function P5(t,r,s="ltr"){const n=$C(r),a=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,o=r.scrollbar.size-a,c=r.content-r.viewport,i=o-n,f=s==="ltr"?[0,c]:[c*-1,0],p=Sb(t,f);return V7([0,c],[0,i])(p)}function V7(t,r){return s=>{if(t[0]===t[1]||r[0]===r[1])return r[0];const n=(r[1]-r[0])/(t[1]-t[0]);return r[0]+n*(s-t[0])}}function U7(t,r){return t>0&&t<r}var eme=(t,r=()=>{})=>{let s={left:t.scrollLeft,top:t.scrollTop},n=0;return function a(){const o={left:t.scrollLeft,top:t.scrollTop},c=s.left!==o.left,i=s.top!==o.top;(c||i)&&r(),s=o,n=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(n)};function zC(t,r){const s=oi(t),n=A.useRef(0);return A.useEffect(()=>()=>window.clearTimeout(n.current),[]),A.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(s,r)},[s,r])}function by(t,r){const s=oi(r);Hi(()=>{let n=0;if(t){const a=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(s)});return a.observe(t),()=>{window.cancelAnimationFrame(n),a.unobserve(t)}}},[t,s])}function tme(t,r){const{asChild:s,children:n}=t;if(!s)return typeof r=="function"?r(n):r;const a=A.Children.only(n);return A.cloneElement(a,{children:typeof r=="function"?r(a.props.children):r})}var W7=I7,rme=R7,sme=B7;const qm=A.forwardRef(({className:t,children:r,...s},n)=>e.jsxs(W7,{ref:n,className:dr("relative overflow-hidden",t),...s,children:[e.jsx(rme,{className:"h-full w-full rounded-[inherit]",children:r}),e.jsx(G7,{}),e.jsx(sme,{})]}));qm.displayName=W7.displayName;const G7=A.forwardRef(({className:t,orientation:r="vertical",...s},n)=>e.jsx(UI,{ref:n,orientation:r,className:dr("flex touch-none select-none transition-colors",r==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",r==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...s,children:e.jsx(z7,{className:"relative flex-1 rounded-full bg-border"})}));G7.displayName=UI.displayName;const k5=[{name:"Core Registry",href:"/core",icon:Bi,color:"text-blue-500",category:"Infrastructure & Assets",subPages:[{name:"Home",href:"/core"},{name:"Schemes",href:"/core/schemes"},{name:"Assets",href:"/core/assets"},{name:"Asset Classes",href:"/core/asset-classes"},{name:"Facilities",href:"/core/facilities"},{name:"DMAs",href:"/core/dmas"},{name:"Pipelines",href:"/core/pipelines"},{name:"Zones",href:"/core/zones"},{name:"Addresses",href:"/core/addresses"},{name:"Meters",href:"/core/meters"}]},{name:"Maintenance Management",href:"/cmms",icon:Vc,color:"text-yellow-500",category:"Operations & Customer",subPages:[{name:"Dashboard",href:"/cmms/dashboard",icon:Wl},{name:"Work Orders",href:"/cmms/work-orders",icon:T0},{name:"Job Plans",href:"/cmms/job-plans",icon:bs},{name:"Preventive Maintenance",href:"/cmms/pm",icon:wn},{name:"Condition Monitoring",href:"/cmms/condition-monitoring",icon:Ni},{name:"Stores & Inventory",href:"/cmms/stores",icon:zo},{name:"Fleet Management",href:"/cmms/fleet",icon:py},{name:"Contractors & SLA",href:"/cmms/contractors",icon:JE},{name:"HSE Safety",href:"/cmms/hse",icon:ka},{name:"Parts Catalog",href:"/cmms/parts",icon:Bi},{name:"Asset Map",href:"/cmms/map",icon:jd}]},{name:"Water Quality",href:"/water-quality",icon:Fl,color:"text-blue-400",category:"Infrastructure & Assets",subPages:[{name:"Parameters",href:"/water-quality/parameters",icon:qF},{name:"Sampling Points",href:"/water-quality/sampling-points",icon:fn},{name:"Sampling Plans",href:"/water-quality/plans",icon:wn},{name:"Samples",href:"/water-quality/samples",icon:Fl},{name:"Lab Results",href:"/water-quality/results",icon:bs},{name:"Compliance",href:"/water-quality/compliance",icon:Wl}]},{name:"Hydro-Met",href:"/hydromet",icon:Kae,color:"text-cyan-500",category:"Infrastructure & Assets",subPages:[{name:"Water Sources",href:"/hydromet/sources"},{name:"Stations Registry",href:"/hydromet/stations"},{name:"Aquifer Management",href:"/hydromet/aquifers",icon:Fl}]},{name:"GIS",href:"/gis",icon:jd,color:"text-red-500",category:"Infrastructure & Assets",subPages:[{name:"Map Console",href:"/gis/map",icon:jd},{name:"Files & Layers",href:"/gis/files",icon:Bo},{name:"Settings",href:"/gis/settings",icon:Gn}]},{name:"CRM & Revenue",href:"/crm",icon:Ds,color:"text-green-500",category:"Operations & Customer",subPages:[{name:"Customers",href:"/crm/customers",icon:Ds},{name:"Account Search",href:"/crm/accounts/search",icon:bS},{name:"Complaints",href:"/crm/complaints",icon:Fr},{name:"Interactions",href:"/crm/interactions",icon:Ki},{name:"Segmentation",href:"/crm/segmentation",icon:Wl},{name:"Revenue Assurance",href:"/crm/ra",icon:Fr},{name:"Dunning & Collections",href:"/crm/dunning",icon:nM},{name:"Import Center",href:"/crm/import",icon:Bo}]},{name:"Customer & Commercial",href:"/customer",icon:_m,color:"text-pink-500",category:"Operations & Customer",subPages:[{name:"Tariffs",href:"/customer/tariffs",icon:Ga},{name:"Billing Runs",href:"/customer/billing",icon:nM},{name:"Payment Reconciliation",href:"/customer/payments",icon:xI},{name:"Meter Routes",href:"/customer/meter-routes",icon:fn},{name:"Tickets & Support",href:"/customer/tickets",icon:_m},{name:"Kiosks",href:"/customer/kiosks",icon:bS},{name:"Water Trucking",href:"/customer/trucking",icon:py},{name:"Connections",href:"/customer/connections",icon:zo}]},{name:"Core Operations",href:"/core-ops",icon:Ni,color:"text-emerald-500",category:"Operations & Customer",subPages:[{name:"Operations Console",href:"/core-ops/console",icon:zc},{name:"Topology Viewer",href:"/core-ops/topology",icon:fy},{name:"Telemetry Dashboard",href:"/core-ops/telemetry",icon:jS},{name:"Outage Planner",href:"/core-ops/outages",icon:Fr},{name:"NRW Dashboard",href:"/core-ops/nrw",icon:Fl},{name:"Dosing Control",href:"/core-ops/dosing",icon:qF},{name:"Pump Scheduling",href:"/core-ops/scheduling",icon:$s},{name:"Pressure & Leak",href:"/core-ops/pressure-leak",icon:zc},{name:"Shifts & Events",href:"/core-ops/shifts",icon:$s},{name:"Alerts & Events",href:"/core-ops/events",icon:Nn},{name:"Checklists",href:"/core-ops/checklists",icon:T0},{name:"Playbooks",href:"/core-ops/playbooks",icon:Fu},{name:"Escalation Policies",href:"/core-ops/escalation-policies",icon:bb},{name:"Workflows",href:"/core-ops/workflows/definitions",icon:QE,subMenu:[{name:"Definitions",href:"/core-ops/workflows/definitions"},{name:"Instances",href:"/core-ops/workflows/instances"}]},{name:"Drought Response",href:"/core-ops/droughts",icon:Fr},{name:"Predictions",href:"/core-ops/predictions",icon:zs}]},{name:"Projects",href:"/projects",icon:vS,color:"text-purple-500",category:"Planning & Finance",subPages:[]},{name:"Costing & Procurement",href:"/costing",icon:ZE,color:"text-orange-500",category:"Planning & Finance",subPages:[{name:"Budgets",href:"/costing/budgets",icon:ZE},{name:"Allocation Console",href:"/costing/allocations",icon:qae},{name:"Cost-to-Serve",href:"/costing/cost-to-serve",icon:zs},{name:"GL Accounts",href:"/costing/gl-accounts",icon:Ga},{name:"Cost Centers",href:"/costing/cost-centers",icon:$p},{name:"Energy Tariffs",href:"/costing/energy/tariffs",icon:Ta},{name:"Energy Readings",href:"/costing/energy/readings",icon:Bo},{name:"Energy Dashboard",href:"/costing/energy/dashboard",icon:Zae},{name:"Requisitions",href:"/procurement/requisitions",icon:T0},{name:"RFQ Builder",href:"/procurement/rfqs",icon:bs},{name:"LPO Management",href:"/procurement/lpos",icon:jI}]},{name:"Decision Support & Analytics",href:"/dsa",icon:zae,color:"text-violet-500",category:"Planning & Finance",subPages:[{name:"Forecast Studio",href:"/dsa/forecast",icon:Bae},{name:"Scenario Workbench",href:"/dsa/scenarios",icon:Hae},{name:"Optimization Console",href:"/dsa/optimize",icon:hie},{name:"Anomalies Inbox",href:"/dsa/anomalies",icon:Fr},{name:"Aquifer Dashboard",href:"/dsa/aquifer",icon:Fl},{name:"Tariff Sandbox",href:"/dsa/tariffs",icon:Ga},{name:"EWS Console",href:"/dsa/ews",icon:bb}]},{name:"M&E & Service Levels",href:"/me",icon:pm,color:"text-teal-500",category:"Monitoring & Reporting",subPages:[{name:"KPI Dashboard",href:"/me/kpis",icon:zc},{name:"Coverage Analytics",href:"/me/coverage",icon:fy},{name:"NRW Tracker",href:"/me/nrw",icon:Fl},{name:"CX Analytics",href:"/me/cx",icon:Ni},{name:"Results Framework",href:"/me/indicators",icon:pm},{name:"Gender & Equity",href:"/me/gender-equity",icon:Ds}]},{name:"Community & Stakeholder",href:"/community",icon:sie,color:"text-purple-500",category:"Community & Engagement",subPages:[{name:"RWSS Committees",href:"/community/committees",icon:Ds},{name:"Committee Finance",href:"/community/finance",icon:Ga},{name:"Vendor Portal",href:"/community/vendors",icon:JE},{name:"Bids & RFQs",href:"/community/bids",icon:bs},{name:"Vendor Deliveries",href:"/community/deliveries",icon:zo},{name:"Stakeholder Map",href:"/community/stakeholders",icon:Ds},{name:"Engagement Planner",href:"/community/engagements",icon:wn},{name:"GRM Console",href:"/community/grm",icon:Ki},{name:"Open Data Catalog",href:"/community/open-data",icon:c9},{name:"Dataset Builder",href:"/community/dataset-builder",icon:Gn},{name:"Public Maps",href:"/community/public-maps",icon:jd}]},{name:"Risk, Compliance & Governance",href:"/risk-compliance",icon:tie,color:"text-orange-500",category:"Governance & Security",subPages:[{name:"Dashboard",href:"/risk-compliance/home",icon:Ni},{name:"Risk Register",href:"/risk-compliance/risks",icon:Fr},{name:"Incidents & Issues",href:"/risk-compliance/incidents",icon:ka},{name:"Business Continuity",href:"/risk-compliance/bcp",icon:Zl},{name:"Regulatory Reporting",href:"/risk-compliance/regulatory-reporting",icon:bs},{name:"Policies & SOPs",href:"/risk-compliance/policies",icon:Fu},{name:"Internal Audit",href:"/risk-compliance/audit",icon:bs},{name:"HSE",href:"/risk-compliance/hse",icon:ka},{name:"Data Privacy (DPO)",href:"/risk-compliance/dpo",icon:sm}]},{name:"Security & Access",href:"/security",icon:ka,color:"text-red-500",category:"Governance & Security",subPages:[{name:"Audit Logs",href:"/security/audit",icon:bs},{name:"Security Alerts",href:"/security/alerts",icon:Fr},{name:"Roles & Permissions",href:"/security/roles",icon:_S},{name:"API Keys",href:"/security/api-keys",icon:sm},{name:"DSR Requests",href:"/security/dsr",icon:bs},{name:"Consents",href:"/security/consents",icon:ka},{name:"Key Management",href:"/security/kms",icon:sm},{name:"Retention Policies",href:"/security/retention",icon:$s},{name:"Data Catalog",href:"/security/data-catalog",icon:Bi},{name:"2FA Setup",href:"/security/2fa",icon:ka}]},{name:"Admin & Configuration",href:"/admin",icon:Gn,color:"text-gray-500",category:"Governance & Security",subPages:[{name:"Users Management",href:"/admin/users",icon:Ds},{name:"Roles & Permissions",href:"/admin/rbac/roles",icon:_S},{name:"Role & Menu Access",href:"/admin/rbac/menu-access",icon:ka},{name:"Permission Matrix",href:"/admin/rbac/matrix",icon:Gn},{name:"Module Settings",href:"/admin/settings",icon:Ta},{name:"Audit Logs",href:"/admin/audit",icon:bs},{name:"Security Alerts",href:"/admin/security/alerts",icon:Fr},{name:"API Keys",href:"/admin/security/api-keys",icon:sm}]},{name:"Integration",href:"/integration",icon:Gn,color:"text-indigo-500",category:"Integration & Enablement",subPages:[{name:"API Catalog",href:"/integration/api",icon:Bi},{name:"Connector Gallery",href:"/integration/connectors",icon:Gn},{name:"Webhook Manager",href:"/integration/webhooks",icon:Gn},{name:"ETL Jobs",href:"/integration/etl",icon:Gn},{name:"Data Warehouse",href:"/integration/dw",icon:Bi},{name:"Communication Templates",href:"/integration/comms",icon:Gn}]},{name:"Training & Knowledge",href:"/training",icon:bs,color:"text-amber-500",category:"Integration & Enablement",subPages:[{name:"Course Catalog",href:"/training/courses",icon:bs},{name:"My Learning",href:"/training/my-learning",icon:Ni},{name:"Knowledge Base",href:"/training/kb",icon:Bi},{name:"SOPs",href:"/training/sops",icon:T0},{name:"Skills Matrix",href:"/training/skills",icon:pm},{name:"Certificates",href:"/training/certificates",icon:ka},{name:"Capacity Assessments",href:"/training/assessments",icon:pie}]}];function Ti(){const t=Lp(),{logout:r}=Lm(),[s,n]=A.useState(new Set),[a,o]=A.useState(new Set),[c,i]=A.useState(!1),f=async()=>{await r(),window.location.href="/login"},g=(()=>{const T="/"+t.pathname.split("/")[1];return k5.find(N=>N.href.startsWith(T))})();A.useEffect(()=>{const T=()=>{const C=window.innerHeight<800;i(C),C&&g?n(new Set([g.name])):!C&&g&&n(new Set([g.name]))};T();let N;const M=()=>{clearTimeout(N),N=setTimeout(T,150)};return window.addEventListener("resize",M),()=>{window.removeEventListener("resize",M),clearTimeout(N)}},[g]);const y=T=>{if(c)n(new Set([T]));else{const N=new Set(s);N.has(T)?N.delete(T):N.add(T),n(N)}},b=k5.reduce((T,N)=>{const M=N.category||"Other";return T[M]||(T[M]=[]),T[M].push(N),T},{}),w=["Infrastructure & Assets","Operations & Customer","Planning & Finance","Monitoring & Reporting","Community & Engagement","Governance & Security","Integration & Enablement"];return e.jsxs("aside",{className:"w-64 bg-card border-r flex flex-col h-screen",children:[e.jsx("div",{className:"p-6 border-b flex-shrink-0",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-primary-foreground font-bold text-sm",children:"RW"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-sm font-bold",children:"Rural Water MIS"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Management Information System"})]})]})}),e.jsx(qm,{className:"flex-1",children:e.jsx("nav",{className:"p-3 space-y-4",children:w.map(T=>{const N=b[T]||[];return N.length===0?null:e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:T}),e.jsx("div",{className:"space-y-1",children:N.map(M=>{const O=(g==null?void 0:g.href)===M.href,C=M.subPages.length>0,D=s.has(M.name),L=C&&D,F=dr("w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md transition-colors group",O?"bg-primary/10 text-primary":"text-muted-foreground hover:text-foreground hover:bg-muted");return e.jsxs("div",{children:[C?e.jsxs("button",{onClick:()=>y(M.name),className:F,"aria-expanded":L,"aria-label":`${M.name} ${D?"expanded":"collapsed"}`,children:[e.jsx(M.icon,{className:dr("h-5 w-5 flex-shrink-0",O&&M.color)}),e.jsx("span",{className:"flex-1 text-left",children:M.name}),D?e.jsx(jp,{className:"h-4 w-4"}):e.jsx($u,{className:"h-4 w-4"})]}):e.jsxs(SA,{to:M.href,className:({isActive:B})=>dr("flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md transition-colors group",B?"bg-primary/10 text-primary":"text-muted-foreground hover:text-foreground hover:bg-muted"),children:[e.jsx(M.icon,{className:dr("h-5 w-5 flex-shrink-0",O&&M.color)}),e.jsx("span",{className:"flex-1 text-left",children:M.name})]}),L&&e.jsx("div",{className:"mt-1 ml-6 space-y-0.5 animate-in slide-in-from-top-2 duration-200",role:"group","aria-label":`${M.name} submenu`,children:M.subPages.map(B=>{var ne;const U="icon"in B?B.icon:null,te="subMenu"in B&&B.subMenu,Q=`${M.name}-${B.name}`,re=a.has(Q),Z=()=>{const oe=new Set(a);oe.has(Q)?oe.delete(Q):oe.add(Q),o(oe)};return e.jsxs("div",{children:[te?e.jsxs("button",{onClick:Z,className:"w-full flex items-center gap-2 px-3 py-1.5 text-xs rounded-md transition-colors text-muted-foreground hover:text-foreground hover:bg-muted",children:[U&&e.jsx(U,{className:"h-4 w-4"}),e.jsx("span",{className:"flex-1 text-left",children:B.name}),re?e.jsx(jp,{className:"h-3 w-3"}):e.jsx($u,{className:"h-3 w-3"})]}):e.jsxs(SA,{to:B.href,className:({isActive:oe})=>dr("flex items-center gap-2 px-3 py-1.5 text-xs rounded-md transition-colors",oe?"bg-primary text-primary-foreground font-medium":"text-muted-foreground hover:text-foreground hover:bg-muted"),children:[U&&e.jsx(U,{className:"h-4 w-4"}),e.jsx("span",{children:B.name})]}),te&&re&&e.jsx("div",{className:"ml-4 space-y-0.5 mt-0.5",children:(ne=B.subMenu)==null?void 0:ne.map(oe=>e.jsx(SA,{to:oe.href,className:({isActive:Ce})=>dr("block px-3 py-1 text-xs rounded-md transition-colors",Ce?"bg-primary text-primary-foreground font-medium":"text-muted-foreground hover:text-foreground hover:bg-muted"),children:oe.name},oe.href))})]},B.href)})})]},M.name)})})]},T)})})}),c&&e.jsx("div",{className:"px-3 py-2 text-xs text-muted-foreground bg-muted/50 border-t flex-shrink-0",children:e.jsx("p",{className:"leading-tight",children:"Compact mode active - single section expanded"})}),e.jsx("div",{className:"px-3 py-2 border-t flex-shrink-0",children:e.jsxs("button",{onClick:f,className:"w-full flex items-center gap-2 px-3 py-2 rounded-md transition-colors text-muted-foreground hover:text-foreground hover:bg-muted text-red-500 hover:text-red-600",children:[e.jsx(iie,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Logout"})]})})]})}function nme(){return e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx(Ti,{}),e.jsx("main",{className:"flex-1 overflow-auto",children:e.jsx(Ai,{})})]})}const ame="modulepreload",ime=function(t){return"/"+t},A5={},ome=function(r,s,n){let a=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),i=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));a=Promise.allSettled(s.map(f=>{if(f=ime(f),f in A5)return;A5[f]=!0;const p=f.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${g}`))return;const y=document.createElement("link");if(y.rel=p?"stylesheet":ame,p||(y.as="script"),y.crossOrigin="",y.href=f,i&&y.setAttribute("nonce",i),document.head.appendChild(y),p)return new Promise((b,w)=>{y.addEventListener("load",b),y.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function o(c){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=c,window.dispatchEvent(i),!i.defaultPrevented)throw c}return a.then(c=>{for(const i of c||[])i.status==="rejected"&&o(i.reason);return r().catch(o)})},lme=A.createContext(null);function cme(t,r){const s=Array.isArray(t)?t[0]:t?t.x:0,n=Array.isArray(t)?t[1]:t?t.y:0,a=Array.isArray(r)?r[0]:r?r.x:0,o=Array.isArray(r)?r[1]:r?r.y:0;return s===a&&n===o}function Fo(t,r){if(t===r)return!0;if(!t||!r)return!1;if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(!Fo(t[s],r[s]))return!1;return!0}else if(Array.isArray(r))return!1;if(typeof t=="object"&&typeof r=="object"){const s=Object.keys(t),n=Object.keys(r);if(s.length!==n.length)return!1;for(const a of s)if(!r.hasOwnProperty(a)||!Fo(t[a],r[a]))return!1;return!0}return!1}function T5(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function E5(t,r){const s=r.viewState||r,n={};if("longitude"in s&&"latitude"in s&&(s.longitude!==t.center.lng||s.latitude!==t.center.lat)){const a=t.center.constructor;n.center=new a(s.longitude,s.latitude)}return"zoom"in s&&s.zoom!==t.zoom&&(n.zoom=s.zoom),"bearing"in s&&s.bearing!==t.bearing&&(n.bearing=s.bearing),"pitch"in s&&s.pitch!==t.pitch&&(n.pitch=s.pitch),s.padding&&t.padding&&!Fo(s.padding,t.padding)&&(n.padding=s.padding),n}const dme=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function M5(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const r={};for(const n of t.layers)r[n.id]=n;const s=t.layers.map(n=>{let a=null;"interactive"in n&&(a=Object.assign({},n),delete a.interactive);const o=r[n.ref];if(o){a=a||Object.assign({},n),delete a.ref;for(const c of dme)c in o&&(a[c]=o[c])}return a||n});return{...t,layers:s}}const O5={version:8,sources:{},layers:[]},I5={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},D5={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},R5={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},ume=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],hme=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class _y{constructor(r,s,n){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=a=>{const o=this.props[R5[a.type]];o?o(a):a.type==="error"&&console.error(a.error)},this._onCameraEvent=a=>{if(this._internalUpdate)return;a.viewState=this._propsedCameraUpdate||T5(this._map.transform);const o=this.props[D5[a.type]];o&&o(a)},this._onCameraUpdate=a=>this._internalUpdate?a:(this._propsedCameraUpdate=T5(a),E5(a,this.props)),this._onPointerEvent=a=>{(a.type==="mousemove"||a.type==="mouseout")&&this._updateHover(a);const o=this.props[I5[a.type]];o&&(this.props.interactiveLayerIds&&a.type!=="mouseover"&&a.type!=="mouseout"&&(a.features=this._hoveredFeatures||this._queryRenderedFeatures(a.point)),o(a),delete a.features)},this._MapClass=r,this.props=s,this._initialize(n)}get map(){return this._map}setProps(r){const s=this.props;this.props=r;const n=this._updateSettings(r,s),a=this._updateSize(r),o=this._updateViewState(r);this._updateStyle(r,s),this._updateStyleComponents(r),this._updateHandlers(r,s),(n||a||o&&!this._map.isMoving())&&this.redraw()}static reuse(r,s){const n=_y.savedMaps.pop();if(!n)return null;const a=n.map,o=a.getContainer();for(s.className=o.className;o.childNodes.length>0;)s.appendChild(o.childNodes[0]);a._container=s;const c=a._resizeObserver;c&&(c.disconnect(),c.observe(s)),n.setProps({...r,styleDiffing:!1}),a.resize();const{initialViewState:i}=r;return i&&(i.bounds?a.fitBounds(i.bounds,{...i.fitBoundsOptions,duration:0}):n._updateViewState(i)),a.isStyleLoaded()?a.fire("load"):a.once("style.load",()=>a.fire("load")),a._update(),n}_initialize(r){const{props:s}=this,{mapStyle:n=O5}=s,a={...s,...s.initialViewState,container:r,style:M5(n)},o=a.initialViewState||a.viewState||a;if(Object.assign(a,{center:[o.longitude||0,o.latitude||0],zoom:o.zoom||0,pitch:o.pitch||0,bearing:o.bearing||0}),s.gl){const i=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=i,s.gl)}const c=new this._MapClass(a);o.padding&&c.setPadding(o.padding),s.cursor&&(c.getCanvas().style.cursor=s.cursor),c.transformCameraUpdate=this._onCameraUpdate,c.on("style.load",()=>{var i;this._styleComponents={light:c.getLight(),sky:c.getSky(),projection:(i=c.getProjection)==null?void 0:i.call(c),terrain:c.getTerrain()},this._updateStyleComponents(this.props)}),c.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const i in I5)c.on(i,this._onPointerEvent);for(const i in D5)c.on(i,this._onCameraEvent);for(const i in R5)c.on(i,this._onEvent);this._map=c}recycle(){const s=this.map.getContainer().querySelector("[mapboxgl-children]");s==null||s.remove(),_y.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const r=this._map;r.style&&(r._frame&&(r._frame.cancel(),r._frame=null),r._render())}_updateSize(r){const{viewState:s}=r;if(s){const n=this._map;if(s.width!==n.transform.width||s.height!==n.transform.height)return n.resize(),!0}return!1}_updateViewState(r){const s=this._map,n=s.transform;if(!s.isMoving()){const o=E5(n,r);if(Object.keys(o).length>0)return this._internalUpdate=!0,s.jumpTo(o),this._internalUpdate=!1,!0}return!1}_updateSettings(r,s){const n=this._map;let a=!1;for(const o of ume)if(o in r&&!Fo(r[o],s[o])){a=!0;const c=n[`set${o[0].toUpperCase()}${o.slice(1)}`];c==null||c.call(n,r[o])}return a}_updateStyle(r,s){if(r.cursor!==s.cursor&&(this._map.getCanvas().style.cursor=r.cursor||""),r.mapStyle!==s.mapStyle){const{mapStyle:n=O5,styleDiffing:a=!0}=r,o={diff:a};"localIdeographFontFamily"in r&&(o.localIdeographFontFamily=r.localIdeographFontFamily),this._map.setStyle(M5(n),o)}}_updateStyleComponents({light:r,projection:s,sky:n,terrain:a}){var i,f;const o=this._map,c=this._styleComponents;o.style._loaded&&(r&&!Fo(r,c.light)&&(c.light=r,o.setLight(r)),s&&!Fo(s,c.projection)&&s!==((i=c.projection)==null?void 0:i.type)&&(c.projection=typeof s=="string"?{type:s}:s,(f=o.setProjection)==null||f.call(o,c.projection)),n&&!Fo(n,c.sky)&&(c.sky=n,o.setSky(n)),a!==void 0&&!Fo(a,c.terrain)&&(!a||o.getSource(a.source))&&(c.terrain=a,o.setTerrain(a)))}_updateHandlers(r,s){const n=this._map;for(const a of hme){const o=r[a]??!0,c=s[a]??!0;Fo(o,c)||(o?n[a].enable(o):n[a].disable())}}_queryRenderedFeatures(r){const s=this._map,{interactiveLayerIds:n=[]}=this.props;try{return s.queryRenderedFeatures(r,{layers:n.filter(s.getLayer.bind(s))})}catch{return[]}}_updateHover(r){var a;const{props:s}=this;if(s.interactiveLayerIds&&(s.onMouseMove||s.onMouseEnter||s.onMouseLeave)){const o=r.type,c=((a=this._hoveredFeatures)==null?void 0:a.length)>0,i=this._queryRenderedFeatures(r.point),f=i.length>0;!f&&c&&(r.type="mouseleave",this._onPointerEvent(r)),this._hoveredFeatures=i,f&&!c&&(r.type="mouseenter",this._onPointerEvent(r)),r.type=o}else this._hoveredFeatures=null}}_y.savedMaps=[];const mme=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function fme(t){if(!t)return null;const r=t.map,s={getMap:()=>r};for(const n of pme(r))!(n in s)&&!mme.includes(n)&&(s[n]=r[n].bind(r));return s}function pme(t){const r=new Set;let s=t;for(;s;){for(const n of Object.getOwnPropertyNames(s))n[0]!=="_"&&typeof t[n]=="function"&&n!=="fire"&&n!=="setEventedParent"&&r.add(n);s=Object.getPrototypeOf(s)}return Array.from(r)}const xme=typeof document<"u"?A.useLayoutEffect:A.useEffect;function gme(t,r){const{RTLTextPlugin:s,maxParallelImageRequests:n,workerCount:a,workerUrl:o}=r;if(s&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:c,lazy:i=!0}=typeof s=="string"?{pluginUrl:s}:s;t.setRTLTextPlugin(c,f=>{f&&console.error(f)},i)}n!==void 0&&t.setMaxParallelImageRequests(n),a!==void 0&&t.setWorkerCount(a),o!==void 0&&t.setWorkerUrl(o)}const gv=A.createContext(null);function yme(t,r){const s=A.useContext(lme),[n,a]=A.useState(null),o=A.useRef(),{current:c}=A.useRef({mapLib:null,map:null});A.useEffect(()=>{const p=t.mapLib;let g=!0,y;return Promise.resolve(p||ome(()=>Promise.resolve().then(()=>bfe),void 0)).then(b=>{if(!g)return;if(!b)throw new Error("Invalid mapLib");const w="Map"in b?b:b.default;if(!w.Map)throw new Error("Invalid mapLib");gme(w,t),t.reuseMaps&&(y=_y.reuse(t,o.current)),y||(y=new _y(w.Map,t,o.current)),c.map=fme(y),c.mapLib=w,a(y),s==null||s.onMapMount(c.map,t.id)}).catch(b=>{const{onError:w}=t;w?w({type:"error",target:null,originalEvent:null,error:b}):console.error(b)}),()=>{g=!1,y&&(s==null||s.onMapUnmount(t.id),t.reuseMaps?y.recycle():y.destroy())}},[]),xme(()=>{n&&n.setProps(t)}),A.useImperativeHandle(r,()=>c.map,[n]);const i=A.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),f={height:"100%"};return A.createElement("div",{id:t.id,ref:o,style:i},n&&A.createElement(gv.Provider,{value:c},A.createElement("div",{"mapboxgl-children":"",style:f},t.children)))}const Pm=A.forwardRef(yme),vme=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Zu(t,r){if(!t||!r)return;const s=t.style;for(const n in r){const a=r[n];Number.isFinite(a)&&!vme.test(n)?s[n]=`${a}px`:s[n]=a}}function K7(t,r){if(t===r)return null;const s=L5(t),n=L5(r),a=[];for(const o of n)s.has(o)||a.push(o);for(const o of s)n.has(o)||a.push(o);return a.length===0?null:a}function L5(t){return new Set(t?t.trim().split(/\s+/):[])}const BC=A.memo(A.forwardRef((t,r)=>{const{map:s,mapLib:n}=A.useContext(gv),a=A.useRef({props:t}),o=A.useMemo(()=>{let O=!1;A.Children.forEach(t.children,L=>{L&&(O=!0)});const C={...t,element:O?document.createElement("div"):void 0},D=new n.Marker(C);return D.setLngLat([t.longitude,t.latitude]),D.getElement().addEventListener("click",L=>{var F,B;(B=(F=a.current.props).onClick)==null||B.call(F,{type:"click",target:D,originalEvent:L})}),D.on("dragstart",L=>{var B,U;const F=L;F.lngLat=o.getLngLat(),(U=(B=a.current.props).onDragStart)==null||U.call(B,F)}),D.on("drag",L=>{var B,U;const F=L;F.lngLat=o.getLngLat(),(U=(B=a.current.props).onDrag)==null||U.call(B,F)}),D.on("dragend",L=>{var B,U;const F=L;F.lngLat=o.getLngLat(),(U=(B=a.current.props).onDragEnd)==null||U.call(B,F)}),D},[]);A.useEffect(()=>(o.addTo(s.getMap()),()=>{o.remove()}),[]);const{longitude:c,latitude:i,offset:f,style:p,draggable:g=!1,popup:y=null,rotation:b=0,rotationAlignment:w="auto",pitchAlignment:T="auto"}=t;A.useEffect(()=>{Zu(o.getElement(),p)},[p]),A.useImperativeHandle(r,()=>o,[]);const N=a.current.props;(o.getLngLat().lng!==c||o.getLngLat().lat!==i)&&o.setLngLat([c,i]),f&&!cme(o.getOffset(),f)&&o.setOffset(f),o.isDraggable()!==g&&o.setDraggable(g),o.getRotation()!==b&&o.setRotation(b),o.getRotationAlignment()!==w&&o.setRotationAlignment(w),o.getPitchAlignment()!==T&&o.setPitchAlignment(T),o.getPopup()!==y&&o.setPopup(y);const M=K7(N.className,t.className);if(M)for(const O of M)o.toggleClassName(O);return a.current.props=t,Rm.createPortal(t.children,o.getElement())})),OS=A.memo(A.forwardRef((t,r)=>{const{map:s,mapLib:n}=A.useContext(gv),a=A.useMemo(()=>document.createElement("div"),[]),o=A.useRef({props:t}),c=A.useMemo(()=>{const i={...t},f=new n.Popup(i);return f.setLngLat([t.longitude,t.latitude]),f.once("open",p=>{var g,y;(y=(g=o.current.props).onOpen)==null||y.call(g,p)}),f},[]);if(A.useEffect(()=>{const i=f=>{var p,g;(g=(p=o.current.props).onClose)==null||g.call(p,f)};return c.on("close",i),c.setDOMContent(a).addTo(s.getMap()),()=>{c.off("close",i),c.isOpen()&&c.remove()}},[]),A.useEffect(()=>{Zu(c.getElement(),t.style)},[t.style]),A.useImperativeHandle(r,()=>c,[]),c.isOpen()){const i=o.current.props;(c.getLngLat().lng!==t.longitude||c.getLngLat().lat!==t.latitude)&&c.setLngLat([t.longitude,t.latitude]),t.offset&&!Fo(i.offset,t.offset)&&c.setOffset(t.offset),(i.anchor!==t.anchor||i.maxWidth!==t.maxWidth)&&(c.options.anchor=t.anchor,c.setMaxWidth(t.maxWidth));const f=K7(i.className,t.className);if(f)for(const p of f)c.toggleClassName(p);o.current.props=t}return Rm.createPortal(t.children,a)}));function zp(t,r,s,n){const a=A.useContext(gv),o=A.useMemo(()=>t(a),[]);return A.useEffect(()=>{const c=r,i=null,f=typeof r=="function"?r:null,{map:p}=a;return p.hasControl(o)||(p.addControl(o,c==null?void 0:c.position),i&&i(a)),()=>{f&&f(a),p.hasControl(o)&&p.removeControl(o)}},[]),o}function jme(t){const r=zp(({mapLib:s})=>new s.AttributionControl(t),{position:t.position});return A.useEffect(()=>{Zu(r._container,t.style)},[t.style]),null}A.memo(jme);function bme(t){const r=zp(({mapLib:s})=>new s.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return A.useEffect(()=>{Zu(r._controlContainer,t.style)},[t.style]),null}const H7=A.memo(bme);function _me(t,r){const s=A.useRef({props:t}),n=zp(({mapLib:a})=>{const o=new a.GeolocateControl(t),c=o._setupUI;return o._setupUI=()=>{o._container.hasChildNodes()||c()},o.on("geolocate",i=>{var f,p;(p=(f=s.current.props).onGeolocate)==null||p.call(f,i)}),o.on("error",i=>{var f,p;(p=(f=s.current.props).onError)==null||p.call(f,i)}),o.on("outofmaxbounds",i=>{var f,p;(p=(f=s.current.props).onOutOfMaxBounds)==null||p.call(f,i)}),o.on("trackuserlocationstart",i=>{var f,p;(p=(f=s.current.props).onTrackUserLocationStart)==null||p.call(f,i)}),o.on("trackuserlocationend",i=>{var f,p;(p=(f=s.current.props).onTrackUserLocationEnd)==null||p.call(f,i)}),o},{position:t.position});return s.current.props=t,A.useImperativeHandle(r,()=>n,[]),A.useEffect(()=>{Zu(n._container,t.style)},[t.style]),null}A.memo(A.forwardRef(_me));function wme(t){const r=zp(({mapLib:s})=>new s.NavigationControl(t),{position:t.position});return A.useEffect(()=>{Zu(r._container,t.style)},[t.style]),null}const km=A.memo(wme);function Nme(t){const r=zp(({mapLib:o})=>new o.ScaleControl(t),{position:t.position}),s=A.useRef(t),n=s.current;s.current=t;const{style:a}=t;return t.maxWidth!==void 0&&t.maxWidth!==n.maxWidth&&(r.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==n.unit&&r.setUnit(t.unit),A.useEffect(()=>{Zu(r._container,a)},[a]),null}const yv=A.memo(Nme);function Sme(t){const r=zp(({mapLib:s})=>new s.TerrainControl(t),{position:t.position});return A.useEffect(()=>{Zu(r._container,t.style)},[t.style]),null}A.memo(Sme);function Cme(t){const r=zp(({mapLib:s})=>new s.LogoControl(t),{position:t.position});return A.useEffect(()=>{Zu(r._container,t.style)},[t.style]),null}A.memo(Cme);function IS(t,r){if(!t)throw new Error(r)}let Pme=0;function kme(t,r,s){if(t.style&&t.style._loaded){const n={...s};return delete n.id,delete n.children,t.addSource(r,n),t.getSource(r)}return null}function Ame(t,r,s){var c,i,f;IS(r.id===s.id,"source id changed"),IS(r.type===s.type,"source type changed");let n="",a=0;for(const p in r)p!=="children"&&p!=="id"&&!Fo(s[p],r[p])&&(n=p,a++);if(!a)return;const o=r.type;if(o==="geojson")t.setData(r.data);else if(o==="image")t.updateImage({url:r.url,coordinates:r.coordinates});else switch(n){case"coordinates":(c=t.setCoordinates)==null||c.call(t,r.coordinates);break;case"url":(i=t.setUrl)==null||i.call(t,r.url);break;case"tiles":(f=t.setTiles)==null||f.call(t,r.tiles);break;default:console.warn(`Unable to update <Source> prop: ${n}`)}}function _u(t){const r=A.useContext(gv).map.getMap(),s=A.useRef(t),[,n]=A.useState(0),a=A.useMemo(()=>t.id||`jsx-source-${Pme++}`,[]);A.useEffect(()=>{if(r){const c=()=>setTimeout(()=>n(i=>i+1),0);return r.on("styledata",c),c(),()=>{var i;if(r.off("styledata",c),r.style&&r.style._loaded&&r.getSource(a)){const f=(i=r.getStyle())==null?void 0:i.layers;if(f)for(const p of f)p.source===a&&r.removeLayer(p.id);r.removeSource(a)}}}},[r]);let o=r&&r.style&&r.getSource(a);return o?Ame(o,t,s.current):o=kme(r,a,t),s.current=t,o&&A.Children.map(t.children,c=>c&&A.cloneElement(c,{source:a}))||null}function Tme(t,r,s,n){if(IS(s.id===n.id,"layer id changed"),IS(s.type===n.type,"layer type changed"),s.type==="custom"||n.type==="custom")return;const{layout:a={},paint:o={},filter:c,minzoom:i,maxzoom:f,beforeId:p}=s;if(p!==n.beforeId&&t.moveLayer(r,p),a!==n.layout){const g=n.layout||{};for(const y in a)Fo(a[y],g[y])||t.setLayoutProperty(r,y,a[y]);for(const y in g)a.hasOwnProperty(y)||t.setLayoutProperty(r,y,void 0)}if(o!==n.paint){const g=n.paint||{};for(const y in o)Fo(o[y],g[y])||t.setPaintProperty(r,y,o[y]);for(const y in g)o.hasOwnProperty(y)||t.setPaintProperty(r,y,void 0)}Fo(c,n.filter)||t.setFilter(r,c),(i!==n.minzoom||f!==n.maxzoom)&&t.setLayerZoomRange(r,i,f)}function Eme(t,r,s){if(t.style&&t.style._loaded&&(!("source"in s)||t.getSource(s.source))){const n={...s,id:r};delete n.beforeId,t.addLayer(n,s.beforeId)}}let Mme=0;function ni(t){const r=A.useContext(gv).map.getMap(),s=A.useRef(t),[,n]=A.useState(0),a=A.useMemo(()=>t.id||`jsx-layer-${Mme++}`,[]);if(A.useEffect(()=>{if(r){const c=()=>n(i=>i+1);return r.on("styledata",c),c(),()=>{r.off("styledata",c),r.style&&r.style._loaded&&r.getLayer(a)&&r.removeLayer(a)}}},[r]),r&&r.style&&r.getLayer(a))try{Tme(r,a,t,s.current)}catch(c){console.warn(c)}else Eme(r,a,t);return s.current=t,null}var KI="Switch",[Ome]=tc(KI),[Ime,Dme]=Ome(KI),Z7=A.forwardRef((t,r)=>{const{__scopeSwitch:s,name:n,checked:a,defaultChecked:o,required:c,disabled:i,value:f="on",onCheckedChange:p,form:g,...y}=t,[b,w]=A.useState(null),T=ls(r,D=>w(D)),N=A.useRef(!1),M=b?g||!!b.closest("form"):!0,[O=!1,C]=Yc({prop:a,defaultProp:o,onChange:p});return e.jsxs(Ime,{scope:s,checked:O,disabled:i,children:[e.jsx(Tr.button,{type:"button",role:"switch","aria-checked":O,"aria-required":c,"data-state":Q7(O),"data-disabled":i?"":void 0,disabled:i,value:f,...y,ref:T,onClick:gr(t.onClick,D=>{C(L=>!L),M&&(N.current=D.isPropagationStopped(),N.current||D.stopPropagation())})}),M&&e.jsx(Rme,{control:b,bubbles:!N.current,name:n,value:f,checked:O,required:c,disabled:i,form:g,style:{transform:"translateX(-100%)"}})]})});Z7.displayName=KI;var Y7="SwitchThumb",X7=A.forwardRef((t,r)=>{const{__scopeSwitch:s,...n}=t,a=Dme(Y7,s);return e.jsx(Tr.span,{"data-state":Q7(a.checked),"data-disabled":a.disabled?"":void 0,...n,ref:r})});X7.displayName=Y7;var Rme=t=>{const{control:r,checked:s,bubbles:n=!0,...a}=t,o=A.useRef(null),c=AC(s),i=PC(r);return A.useEffect(()=>{const f=o.current,p=window.HTMLInputElement.prototype,y=Object.getOwnPropertyDescriptor(p,"checked").set;if(c!==s&&y){const b=new Event("click",{bubbles:n});y.call(f,s),f.dispatchEvent(b)}},[c,s,n]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...a,tabIndex:-1,ref:o,style:{...t.style,...i,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Q7(t){return t?"checked":"unchecked"}var J7=Z7,Lme=X7;const ml=A.forwardRef(({className:t,...r},s)=>e.jsx(J7,{className:dr("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...r,ref:s,children:e.jsx(Lme,{className:dr("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));ml.displayName=J7.displayName;var HI="Collapsible",[Fme]=tc(HI),[$me,ZI]=Fme(HI),eG=A.forwardRef((t,r)=>{const{__scopeCollapsible:s,open:n,defaultOpen:a,disabled:o,onOpenChange:c,...i}=t,[f=!1,p]=Yc({prop:n,defaultProp:a,onChange:c});return e.jsx($me,{scope:s,disabled:o,contentId:Pi(),open:f,onOpenToggle:A.useCallback(()=>p(g=>!g),[p]),children:e.jsx(Tr.div,{"data-state":XI(f),"data-disabled":o?"":void 0,...i,ref:r})})});eG.displayName=HI;var tG="CollapsibleTrigger",rG=A.forwardRef((t,r)=>{const{__scopeCollapsible:s,...n}=t,a=ZI(tG,s);return e.jsx(Tr.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":XI(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...n,ref:r,onClick:gr(t.onClick,a.onOpenToggle)})});rG.displayName=tG;var YI="CollapsibleContent",sG=A.forwardRef((t,r)=>{const{forceMount:s,...n}=t,a=ZI(YI,t.__scopeCollapsible);return e.jsx(Yi,{present:s||a.open,children:({present:o})=>e.jsx(zme,{...n,ref:r,present:o})})});sG.displayName=YI;var zme=A.forwardRef((t,r)=>{const{__scopeCollapsible:s,present:n,children:a,...o}=t,c=ZI(YI,s),[i,f]=A.useState(n),p=A.useRef(null),g=ls(r,p),y=A.useRef(0),b=y.current,w=A.useRef(0),T=w.current,N=c.open||i,M=A.useRef(N),O=A.useRef();return A.useEffect(()=>{const C=requestAnimationFrame(()=>M.current=!1);return()=>cancelAnimationFrame(C)},[]),Hi(()=>{const C=p.current;if(C){O.current=O.current||{transitionDuration:C.style.transitionDuration,animationName:C.style.animationName},C.style.transitionDuration="0s",C.style.animationName="none";const D=C.getBoundingClientRect();y.current=D.height,w.current=D.width,M.current||(C.style.transitionDuration=O.current.transitionDuration,C.style.animationName=O.current.animationName),f(n)}},[c.open,n]),e.jsx(Tr.div,{"data-state":XI(c.open),"data-disabled":c.disabled?"":void 0,id:c.contentId,hidden:!N,...o,ref:g,style:{"--radix-collapsible-content-height":b?`${b}px`:void 0,"--radix-collapsible-content-width":T?`${T}px`:void 0,...t.style},children:N&&a})});function XI(t){return t?"open":"closed"}var Bme=eG;const F5=Bme,$5=rG,z5=sG;var qme="Separator",B5="horizontal",Vme=["horizontal","vertical"],nG=A.forwardRef((t,r)=>{const{decorative:s,orientation:n=B5,...a}=t,o=Ume(n)?n:B5,i=s?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return e.jsx(Tr.div,{"data-orientation":o,...i,...a,ref:r})});nG.displayName=qme;function Ume(t){return Vme.includes(t)}var aG=nG;const jM=A.forwardRef(({className:t,orientation:r="horizontal",decorative:s=!0,...n},a)=>e.jsx(aG,{ref:a,decorative:s,orientation:r,className:dr("shrink-0 bg-border",r==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...n}));jM.displayName=aG.displayName;var iG=["PageUp","PageDown"],oG=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],lG={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},vv="Slider",[bM,Wme,Gme]=_C(vv),[cG]=tc(vv,[Gme]),[Kme,qC]=cG(vv),dG=A.forwardRef((t,r)=>{const{name:s,min:n=0,max:a=100,step:o=1,orientation:c="horizontal",disabled:i=!1,minStepsBetweenThumbs:f=0,defaultValue:p=[n],value:g,onValueChange:y=()=>{},onValueCommit:b=()=>{},inverted:w=!1,form:T,...N}=t,M=A.useRef(new Set),O=A.useRef(0),D=c==="horizontal"?Hme:Zme,[L=[],F]=Yc({prop:g,defaultProp:p,onChange:Z=>{var oe;(oe=[...M.current][O.current])==null||oe.focus(),y(Z)}}),B=A.useRef(L);function U(Z){const ne=efe(L,Z);re(Z,ne)}function te(Z){re(Z,O.current)}function Q(){const Z=B.current[O.current];L[O.current]!==Z&&b(L)}function re(Z,ne,{commit:oe}={commit:!1}){const Ce=nfe(o),Pe=afe(Math.round((Z-n)/o)*o+n,Ce),Se=Sb(Pe,[n,a]);F((ae=[])=>{const be=Qme(ae,Se,ne);if(sfe(be,f*o)){O.current=be.indexOf(Se);const de=String(be)!==String(ae);return de&&oe&&b(be),de?be:ae}else return ae})}return e.jsx(Kme,{scope:t.__scopeSlider,name:s,disabled:i,min:n,max:a,valueIndexToChangeRef:O,thumbs:M.current,values:L,orientation:c,form:T,children:e.jsx(bM.Provider,{scope:t.__scopeSlider,children:e.jsx(bM.Slot,{scope:t.__scopeSlider,children:e.jsx(D,{"aria-disabled":i,"data-disabled":i?"":void 0,...N,ref:r,onPointerDown:gr(N.onPointerDown,()=>{i||(B.current=L)}),min:n,max:a,inverted:w,onSlideStart:i?void 0:U,onSlideMove:i?void 0:te,onSlideEnd:i?void 0:Q,onHomeKeyDown:()=>!i&&re(n,0,{commit:!0}),onEndKeyDown:()=>!i&&re(a,L.length-1,{commit:!0}),onStepKeyDown:({event:Z,direction:ne})=>{if(!i){const Pe=iG.includes(Z.key)||Z.shiftKey&&oG.includes(Z.key)?10:1,Se=O.current,ae=L[Se],be=o*Pe*ne;re(ae+be,Se,{commit:!0})}}})})})})});dG.displayName=vv;var[uG,hG]=cG(vv,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Hme=A.forwardRef((t,r)=>{const{min:s,max:n,dir:a,inverted:o,onSlideStart:c,onSlideMove:i,onSlideEnd:f,onStepKeyDown:p,...g}=t,[y,b]=A.useState(null),w=ls(r,D=>b(D)),T=A.useRef(),N=dv(a),M=N==="ltr",O=M&&!o||!M&&o;function C(D){const L=T.current||y.getBoundingClientRect(),F=[0,L.width],U=QI(F,O?[s,n]:[n,s]);return T.current=L,U(D-L.left)}return e.jsx(uG,{scope:t.__scopeSlider,startEdge:O?"left":"right",endEdge:O?"right":"left",direction:O?1:-1,size:"width",children:e.jsx(mG,{dir:N,"data-orientation":"horizontal",...g,ref:w,style:{...g.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:D=>{const L=C(D.clientX);c==null||c(L)},onSlideMove:D=>{const L=C(D.clientX);i==null||i(L)},onSlideEnd:()=>{T.current=void 0,f==null||f()},onStepKeyDown:D=>{const F=lG[O?"from-left":"from-right"].includes(D.key);p==null||p({event:D,direction:F?-1:1})}})})}),Zme=A.forwardRef((t,r)=>{const{min:s,max:n,inverted:a,onSlideStart:o,onSlideMove:c,onSlideEnd:i,onStepKeyDown:f,...p}=t,g=A.useRef(null),y=ls(r,g),b=A.useRef(),w=!a;function T(N){const M=b.current||g.current.getBoundingClientRect(),O=[0,M.height],D=QI(O,w?[n,s]:[s,n]);return b.current=M,D(N-M.top)}return e.jsx(uG,{scope:t.__scopeSlider,startEdge:w?"bottom":"top",endEdge:w?"top":"bottom",size:"height",direction:w?1:-1,children:e.jsx(mG,{"data-orientation":"vertical",...p,ref:y,style:{...p.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:N=>{const M=T(N.clientY);o==null||o(M)},onSlideMove:N=>{const M=T(N.clientY);c==null||c(M)},onSlideEnd:()=>{b.current=void 0,i==null||i()},onStepKeyDown:N=>{const O=lG[w?"from-bottom":"from-top"].includes(N.key);f==null||f({event:N,direction:O?-1:1})}})})}),mG=A.forwardRef((t,r)=>{const{__scopeSlider:s,onSlideStart:n,onSlideMove:a,onSlideEnd:o,onHomeKeyDown:c,onEndKeyDown:i,onStepKeyDown:f,...p}=t,g=qC(vv,s);return e.jsx(Tr.span,{...p,ref:r,onKeyDown:gr(t.onKeyDown,y=>{y.key==="Home"?(c(y),y.preventDefault()):y.key==="End"?(i(y),y.preventDefault()):iG.concat(oG).includes(y.key)&&(f(y),y.preventDefault())}),onPointerDown:gr(t.onPointerDown,y=>{const b=y.target;b.setPointerCapture(y.pointerId),y.preventDefault(),g.thumbs.has(b)?b.focus():n(y)}),onPointerMove:gr(t.onPointerMove,y=>{y.target.hasPointerCapture(y.pointerId)&&a(y)}),onPointerUp:gr(t.onPointerUp,y=>{const b=y.target;b.hasPointerCapture(y.pointerId)&&(b.releasePointerCapture(y.pointerId),o(y))})})}),fG="SliderTrack",pG=A.forwardRef((t,r)=>{const{__scopeSlider:s,...n}=t,a=qC(fG,s);return e.jsx(Tr.span,{"data-disabled":a.disabled?"":void 0,"data-orientation":a.orientation,...n,ref:r})});pG.displayName=fG;var _M="SliderRange",xG=A.forwardRef((t,r)=>{const{__scopeSlider:s,...n}=t,a=qC(_M,s),o=hG(_M,s),c=A.useRef(null),i=ls(r,c),f=a.values.length,p=a.values.map(b=>yG(b,a.min,a.max)),g=f>1?Math.min(...p):0,y=100-Math.max(...p);return e.jsx(Tr.span,{"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,...n,ref:i,style:{...t.style,[o.startEdge]:g+"%",[o.endEdge]:y+"%"}})});xG.displayName=_M;var wM="SliderThumb",gG=A.forwardRef((t,r)=>{const s=Wme(t.__scopeSlider),[n,a]=A.useState(null),o=ls(r,i=>a(i)),c=A.useMemo(()=>n?s().findIndex(i=>i.ref.current===n):-1,[s,n]);return e.jsx(Yme,{...t,ref:o,index:c})}),Yme=A.forwardRef((t,r)=>{const{__scopeSlider:s,index:n,name:a,...o}=t,c=qC(wM,s),i=hG(wM,s),[f,p]=A.useState(null),g=ls(r,C=>p(C)),y=f?c.form||!!f.closest("form"):!0,b=PC(f),w=c.values[n],T=w===void 0?0:yG(w,c.min,c.max),N=Jme(n,c.values.length),M=b==null?void 0:b[i.size],O=M?tfe(M,T,i.direction):0;return A.useEffect(()=>{if(f)return c.thumbs.add(f),()=>{c.thumbs.delete(f)}},[f,c.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[i.startEdge]:`calc(${T}% + ${O}px)`},children:[e.jsx(bM.ItemSlot,{scope:t.__scopeSlider,children:e.jsx(Tr.span,{role:"slider","aria-label":t["aria-label"]||N,"aria-valuemin":c.min,"aria-valuenow":w,"aria-valuemax":c.max,"aria-orientation":c.orientation,"data-orientation":c.orientation,"data-disabled":c.disabled?"":void 0,tabIndex:c.disabled?void 0:0,...o,ref:g,style:w===void 0?{display:"none"}:t.style,onFocus:gr(t.onFocus,()=>{c.valueIndexToChangeRef.current=n})})}),y&&e.jsx(Xme,{name:a??(c.name?c.name+(c.values.length>1?"[]":""):void 0),form:c.form,value:w},n)]})});gG.displayName=wM;var Xme=t=>{const{value:r,...s}=t,n=A.useRef(null),a=AC(r);return A.useEffect(()=>{const o=n.current,c=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(c,"value").set;if(a!==r&&f){const p=new Event("input",{bubbles:!0});f.call(o,r),o.dispatchEvent(p)}},[a,r]),e.jsx("input",{style:{display:"none"},...s,ref:n,defaultValue:r})};function Qme(t=[],r,s){const n=[...t];return n[s]=r,n.sort((a,o)=>a-o)}function yG(t,r,s){const o=100/(s-r)*(t-r);return Sb(o,[0,100])}function Jme(t,r){return r>2?`Value ${t+1} of ${r}`:r===2?["Minimum","Maximum"][t]:void 0}function efe(t,r){if(t.length===1)return 0;const s=t.map(a=>Math.abs(a-r)),n=Math.min(...s);return s.indexOf(n)}function tfe(t,r,s){const n=t/2,o=QI([0,50],[0,n]);return(n-o(r)*s)*s}function rfe(t){return t.slice(0,-1).map((r,s)=>t[s+1]-r)}function sfe(t,r){if(r>0){const s=rfe(t);return Math.min(...s)>=r}return!0}function QI(t,r){return s=>{if(t[0]===t[1]||r[0]===r[1])return r[0];const n=(r[1]-r[0])/(t[1]-t[0]);return r[0]+n*(s-t[0])}}function nfe(t){return(String(t).split(".")[1]||"").length}function afe(t,r){const s=Math.pow(10,r);return Math.round(t*s)/s}var vG=dG,ife=pG,ofe=xG,lfe=gG;const Am=A.forwardRef(({className:t,...r},s)=>e.jsxs(vG,{ref:s,className:dr("relative flex w-full touch-none select-none items-center",t),...r,children:[e.jsx(ife,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:e.jsx(ofe,{className:"absolute h-full bg-primary"})}),e.jsx(lfe,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));Am.displayName=vG.displayName;const cfe=[{id:"schemes",name:"Water Supply Schemes",category:"coverage",icon:"",defaultVisible:!0},{id:"dmas",name:"District Metered Areas",category:"coverage",icon:"",defaultVisible:!0},{id:"facilities",name:"Facilities",category:"infrastructure",icon:"",defaultVisible:!0},{id:"pipelines",name:"Pipelines",category:"network",icon:"",defaultVisible:!0},{id:"network-nodes",name:"Network Nodes",category:"network",icon:"",defaultVisible:!1}];function dfe({enabledLayers:t,onLayerToggle:r,onStatusFilterChange:s,onCategoryFilterChange:n,onOpacityChange:a,className:o=""}){const[c,i]=A.useState("all"),[f,p]=A.useState("all"),[g,y]=A.useState([80]),b=C=>{i(C),s==null||s(C)},w=C=>{p(C),n==null||n(C)},T=C=>{y(C),a==null||a(C[0])},N=cfe.filter(C=>!(f!=="all"&&C.category!==f)),M=[{value:"all",label:"All Categories"},{value:"coverage",label:"Coverage Areas"},{value:"infrastructure",label:"Infrastructure"},{value:"network",label:"Network"}],O=[{value:"all",label:"All Status"},{value:"active",label:"Active"},{value:"planned",label:"Planned"},{value:"maintenance",label:"Maintenance"},{value:"decommissioned",label:"Decommissioned"}];return e.jsxs(H,{className:`w-80 bg-white/95 dark:bg-gray-900/95 backdrop-blur ${o}`,children:[e.jsx(ue,{className:"pb-3",children:e.jsxs(he,{className:"text-base flex items-center gap-2",children:[e.jsx("span",{children:"Network Layers"}),e.jsxs(Ae,{variant:"outline",className:"text-xs font-normal",children:[t.size," active"]})]})}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{className:"text-xs text-gray-600 dark:text-gray-400",children:"Category Filter"}),e.jsxs(Nt,{value:f,onValueChange:w,children:[e.jsx(bt,{className:"h-8",children:e.jsx(St,{})}),e.jsx(_t,{children:M.map(C=>e.jsx(ge,{value:C.value,children:C.label},C.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{className:"text-xs text-gray-600 dark:text-gray-400",children:"Status Filter"}),e.jsxs(Nt,{value:c,onValueChange:b,children:[e.jsx(bt,{className:"h-8",children:e.jsx(St,{})}),e.jsx(_t,{children:O.map(C=>e.jsx(ge,{value:C.value,children:C.label},C.value))})]})]}),e.jsx(jM,{}),e.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:N.map(C=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800 transition",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("span",{className:"text-lg",children:C.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx(we,{htmlFor:`layer-${C.id}`,className:"text-sm cursor-pointer text-gray-700 dark:text-gray-300",children:C.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize",children:C.category})]})]}),e.jsx(ml,{id:`layer-${C.id}`,checked:t.has(C.id),onCheckedChange:()=>r(C.id)})]},C.id))}),e.jsx(jM,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(we,{className:"text-xs text-gray-600 dark:text-gray-400",children:"Layer Opacity"}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[g[0],"%"]})]}),e.jsx(Am,{value:g,onValueChange:T,min:0,max:100,step:10,className:"w-full"})]}),e.jsxs("div",{className:"pt-2 text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Legend"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-green-500"}),e.jsx("span",{children:"Active"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-blue-500"}),e.jsx("span",{children:"Planned"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-amber-500"}),e.jsx("span",{children:"Maintenance"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-gray-400"}),e.jsx("span",{children:"Decommissioned"})]})]})]})]})]})}const VA=[{id:"positron",name:"Light",url:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json"},{id:"dark-matter",name:"Dark",url:"https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json"},{id:"voyager",name:"Voyager",url:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json"},{id:"osm",name:"OpenStreetMap",url:"https://tiles.openfreemap.org/styles/liberty"}],UA=[{id:"schemes",name:"Water Supply Schemes",category:"coverage",tileUrl:"/api/v1/gis/tiles/schemes/{z}/{x}/{y}.mvt",sourceLayer:"schemes",type:"fill",minZoom:0,maxZoom:22,paint:{"fill-color":["match",["get","status"],"active","#22c55e","planning","#3b82f6","decommissioned","#94a3b8","#6b7280"],"fill-opacity":.6,"fill-outline-color":"#000000"}},{id:"dmas",name:"District Metered Areas",category:"coverage",tileUrl:"/api/v1/gis/tiles/dmas/{z}/{x}/{y}.mvt",sourceLayer:"dmas",type:"fill",minZoom:0,maxZoom:22,paint:{"fill-color":["match",["get","status"],"active","#8b5cf6","planned","#06b6d4","retired","#94a3b8","#6b7280"],"fill-opacity":.5,"fill-outline-color":"#000000"}},{id:"facilities",name:"Facilities",category:"infrastructure",tileUrl:"/api/v1/gis/tiles/facilities/{z}/{x}/{y}.mvt",sourceLayer:"facilities",type:"circle",minZoom:8,maxZoom:22,paint:{"circle-radius":6,"circle-color":["match",["get","category"],"source","#10b981","treatment","#3b82f6","pumpstation","#f59e0b","reservoir","#06b6d4","#6b7280"],"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}},{id:"pipelines",name:"Pipelines",category:"network",tileUrl:"/api/v1/gis/tiles/pipelines/{z}/{x}/{y}.mvt",sourceLayer:"pipelines",type:"line",minZoom:12,maxZoom:22,paint:{"line-color":["match",["get","status"],"active","#3b82f6","leak","#ef4444","rehab","#f59e0b","abandoned","#94a3b8","#6b7280"],"line-width":["interpolate",["linear"],["zoom"],12,1,16,3,20,6],"line-opacity":.8}},{id:"network-nodes",name:"Network Nodes",category:"network",tileUrl:"/api/v1/gis/tiles/network-nodes/{z}/{x}/{y}.mvt",sourceLayer:"network_nodes",type:"circle",minZoom:14,maxZoom:22,paint:{"circle-radius":["interpolate",["linear"],["zoom"],14,2,18,4,22,8],"circle-color":["match",["get","type"],"source","#10b981","wtp","#3b82f6","reservoir","#06b6d4","junction","#fbbf24","valve","#8b5cf6","pump","#f59e0b","#6b7280"],"circle-stroke-width":1,"circle-stroke-color":"#ffffff"}}];function ufe({className:t}){var fr,vt,Br,vr,Xr,Dr,As,xn,Qs;const{tenant:r}=Lm(),[s,n]=A.useState(null),[a,o]=A.useState(null),[c,i]=A.useState(null),[f,p]=A.useState(!0),[g,y]=A.useState(!0),[b,w]=A.useState(!1),[T,N]=A.useState(!0),[M,O]=A.useState(!0),[C,D]=A.useState(new Set),[L,F]=A.useState({}),B=A.useRef(null),[U,te]=A.useState(null),{data:Q=[]}=it({queryKey:["shape-files"],queryFn:async()=>(await(await fetch("/api/v1/gis/shape-files")).json()).data||[],refetchInterval:1e4}),re=A.useCallback(async De=>{D(Je=>{var qt;const lt=new Set(Je);if(lt.has(De))lt.delete(De);else if(lt.add(De),!L[De])fetch(`/api/v1/gis/shape-files/${De}/geojson`).then(It=>It.json()).then(It=>{It.data&&(F(Bt=>({...Bt,[De]:{data:It.data,bounds:It.bounds}})),It.bounds&&B.current&&B.current.fitBounds([[It.bounds.minX,It.bounds.minY],[It.bounds.maxX,It.bounds.maxY]],{padding:50,duration:1e3}))}).catch(console.error);else if((qt=L[De])!=null&&qt.bounds&&B.current){const It=L[De].bounds;B.current.fitBounds([[It.minX,It.minY],[It.maxX,It.maxY]],{padding:50,duration:1e3})}return lt})},[L]),[Z,ne]=A.useState({longitude:36.8219,latitude:-1.2921,zoom:8}),[oe,Ce]=A.useState("positron"),[Pe,Se]=A.useState(new Set(["schemes","dmas","facilities","pipelines"])),[ae,be]=A.useState(!1),[de,Ke]=A.useState(80),[He,Ve]=A.useState("all"),[yt,Et]=A.useState("all");A.useEffect(()=>{(async()=>{var Je;try{const[lt,qt,It]=await Promise.all([pe.get("/tenants/current/boundary"),pe.get("/tenants/current/sub-counties/geojson"),pe.get("/tenants/current/wards/geojson")]);if(lt.data){n(lt.data);const Bt=lt.data.geometry;if(Bt&&"coordinates"in Bt&&(Bt.type==="Polygon"||Bt.type==="MultiPolygon")){const er=Bt.type==="Polygon"?Bt.coordinates[0]:(Je=Bt.coordinates[0])==null?void 0:Je[0];if(er&&er.length>0){const Qr=er.map(ye=>ye[0]),Ss=er.map(ye=>ye[1]),Tn=(Math.min(...Qr)+Math.max(...Qr))/2,Xe=(Math.min(...Ss)+Math.max(...Ss))/2;ne(ye=>({...ye,longitude:Tn,latitude:Xe,zoom:8}))}}}qt.data&&o(qt.data),It.data&&i(It.data)}catch(lt){console.error("Failed to fetch admin boundaries:",lt)}})()},[r==null?void 0:r.id]);const Rt=De=>{var Bt;if(!De.geometry||!("coordinates"in De.geometry))return[0,0];const Je=De.geometry;let lt=[];if(Je.type==="Polygon"&&Je.coordinates[0])lt=Je.coordinates[0];else if(Je.type==="MultiPolygon"&&((Bt=Je.coordinates[0])!=null&&Bt[0]))lt=Je.coordinates[0][0];else{if(Je.type==="Point")return Je.coordinates;Je.type==="LineString"&&Je.coordinates.length>0&&(lt=Je.coordinates)}if(!lt||lt.length===0)return[0,0];const qt=lt.map(er=>er[0]),It=lt.map(er=>er[1]);return[(Math.min(...qt)+Math.max(...qt))/2,(Math.min(...It)+Math.max(...It))/2]},Vt=A.useCallback(De=>{Se(Je=>{const lt=new Set(Je);return lt.has(De)?lt.delete(De):lt.add(De),lt})},[]),Ct=A.useCallback(De=>{if(Et(De),De==="all")Se(new Set(["schemes","dmas","facilities","pipelines"]));else{const Je=UA.filter(lt=>lt.category===De).map(lt=>lt.id);Se(new Set(Je))}},[]),ur=VA.find(De=>De.id===oe)||VA[0],At=A.useCallback(De=>{var er;const Je=De.features;if(!Je||Je.length===0){te(null);return}const lt=Je[0],qt=(er=lt.layer)==null?void 0:er.id;let It="county";qt!=null&&qt.includes("ward")?It="ward":qt!=null&&qt.includes("sub-count")&&(It="sub_county");const Bt=Rt(lt);te({longitude:Bt[0],latitude:Bt[1],feature:lt,layerType:It})},[]),Ht=[...f&&s?["tenant-boundary-fill"]:[],...g&&a?["sub-counties-fill"]:[],...b&&c?["wards-fill"]:[]];return e.jsxs("div",{className:`relative w-full h-full ${t||""}`,children:[e.jsxs(Pm,{ref:B,...Z,onMove:De=>ne(De.viewState),onClick:At,interactiveLayerIds:Ht,mapStyle:ur.url,style:{width:"100%",height:"100%"},cursor:Ht.length>0?"pointer":"grab",children:[e.jsx(km,{position:"top-right"}),e.jsx(yv,{position:"bottom-left"}),e.jsx(H7,{position:"top-right"}),c&&b&&e.jsxs(_u,{id:"wards",type:"geojson",data:c,children:[e.jsx(ni,{id:"wards-fill",type:"fill",paint:{"fill-color":"#f97316","fill-opacity":.15}}),e.jsx(ni,{id:"wards-line",type:"line",paint:{"line-color":"#ea580c","line-width":1.5,"line-dasharray":[1,1]}}),e.jsx(ni,{id:"wards-label",type:"symbol",layout:{"text-field":["get","name"],"text-size":10,"text-anchor":"center","text-font":["Open Sans Regular","Arial Unicode MS Regular"]},paint:{"text-color":"#c2410c","text-halo-color":"#ffffff","text-halo-width":1.5}})]}),a&&g&&e.jsxs(_u,{id:"sub-counties",type:"geojson",data:a,children:[e.jsx(ni,{id:"sub-counties-fill",type:"fill",paint:{"fill-color":"#8b5cf6","fill-opacity":.1}}),e.jsx(ni,{id:"sub-counties-line",type:"line",paint:{"line-color":"#7c3aed","line-width":2}}),e.jsx(ni,{id:"sub-counties-label",type:"symbol",layout:{"text-field":["get","name"],"text-size":12,"text-anchor":"center","text-font":["Open Sans Bold","Arial Unicode MS Bold"]},paint:{"text-color":"#6d28d9","text-halo-color":"#ffffff","text-halo-width":2}})]}),s&&f&&e.jsxs(_u,{id:"tenant-boundary",type:"geojson",data:s,children:[e.jsx(ni,{id:"tenant-boundary-fill",type:"fill",paint:{"fill-color":"#3b82f6","fill-opacity":.05}}),e.jsx(ni,{id:"tenant-boundary-line",type:"line",paint:{"line-color":"#1d4ed8","line-width":3}}),e.jsx(ni,{id:"tenant-boundary-label",type:"symbol",layout:{"text-field":["get","name"],"text-size":16,"text-anchor":"center","text-font":["Open Sans Bold","Arial Unicode MS Bold"]},paint:{"text-color":"#1e40af","text-halo-color":"#ffffff","text-halo-width":2}})]}),U&&e.jsx(OS,{longitude:U.longitude,latitude:U.latitude,onClose:()=>te(null),closeButton:!0,closeOnClick:!1,children:e.jsxs("div",{className:"p-2 min-w-[180px]",children:[e.jsx("h4",{className:"font-semibold text-sm mb-1",children:(fr=U.feature.properties)==null?void 0:fr.name}),U.layerType==="sub_county"&&e.jsxs("div",{className:"text-xs text-gray-600 space-y-0.5",children:[e.jsxs("p",{children:["Population: ",(Br=(vt=U.feature.properties)==null?void 0:vt.population)==null?void 0:Br.toLocaleString()]}),e.jsxs("p",{children:["Area: ",(Xr=(vr=U.feature.properties)==null?void 0:vr.area_km2)==null?void 0:Xr.toLocaleString()," km"]}),e.jsxs("p",{children:["HQ: ",(Dr=U.feature.properties)==null?void 0:Dr.headquarters]})]}),U.layerType==="ward"&&e.jsxs("div",{className:"text-xs text-gray-600 space-y-0.5",children:[e.jsxs("p",{children:["Sub-county: ",(As=U.feature.properties)==null?void 0:As.sub_county_name]}),e.jsxs("p",{children:["Population: ",(Qs=(xn=U.feature.properties)==null?void 0:xn.population)==null?void 0:Qs.toLocaleString()]})]})]})}),UA.map(De=>{if(!Pe.has(De.id)||yt!=="all"&&De.category!==yt)return null;const Je={...De.paint};return De.type==="fill"?Je["fill-opacity"]=(De.paint["fill-opacity"]||.6)*(de/100):De.type==="circle"?Je["circle-opacity"]=de/100:De.type==="line"&&(Je["line-opacity"]=(De.paint["line-opacity"]||.8)*(de/100)),e.jsx(_u,{id:De.id,type:"vector",tiles:[De.tileUrl],minzoom:De.minZoom,maxzoom:De.maxZoom,children:e.jsx(ni,{id:De.id,"source-layer":De.sourceLayer,type:De.type,paint:Je,filter:He!=="all"?["==",["get","status"],He]:void 0})},De.id)}),Q.filter(De=>{var Je;return De.status==="processed"&&C.has(De.id)&&((Je=L[De.id])==null?void 0:Je.data)}).map((De,Je)=>{const lt=L[De.id];if(!(lt!=null&&lt.data))return null;const qt=["#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4"],It=qt[Je%qt.length];return e.jsxs(_u,{id:`shapefile-${De.id}`,type:"geojson",data:lt.data,children:[e.jsx(ni,{id:`shapefile-${De.id}-fill`,type:"fill",filter:["==","$type","Polygon"],paint:{"fill-color":It,"fill-opacity":.3}}),e.jsx(ni,{id:`shapefile-${De.id}-outline`,type:"line",filter:["==","$type","Polygon"],paint:{"line-color":It,"line-width":2}}),e.jsx(ni,{id:`shapefile-${De.id}-line`,type:"line",filter:["==","$type","LineString"],paint:{"line-color":It,"line-width":2}}),e.jsx(ni,{id:`shapefile-${De.id}-point`,type:"circle",filter:["==","$type","Point"],paint:{"circle-radius":6,"circle-color":It,"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}})]},De.id)})]}),e.jsx(H,{className:"absolute top-4 left-4 w-72 bg-white/95 dark:bg-gray-900/95 backdrop-blur",children:e.jsxs(X,{className:"p-4",children:[r&&e.jsxs("div",{className:"mb-3 p-2 bg-blue-50 dark:bg-blue-950/30 rounded-lg flex items-center gap-2",children:[e.jsx($p,{className:"w-4 h-4 text-blue-600"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400 font-medium",children:[r.county," County"]}),e.jsx("p",{className:"text-[10px] text-blue-500",children:r.name})]})]}),e.jsx("h3",{className:"font-semibold mb-3 text-gray-900 dark:text-gray-100",children:"Map Controls"}),e.jsxs("div",{className:"mb-4",children:[e.jsx(we,{className:"text-sm mb-2 block text-gray-700 dark:text-gray-300",children:"Basemap"}),e.jsxs(Nt,{value:oe,onValueChange:Ce,children:[e.jsx(bt,{className:"w-full",children:e.jsx(St,{})}),e.jsx(_t,{children:VA.map(De=>e.jsx(ge,{value:De.id,children:De.name},De.id))})]})]}),e.jsxs(K,{variant:"outline",className:"w-full",onClick:()=>be(!ae),children:[e.jsx(cv,{className:"w-4 h-4 mr-2"}),ae?"Hide":"Show"," Network Layers"]}),e.jsxs(F5,{open:T,onOpenChange:N,className:"mt-4 pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs($5,{className:"flex items-center justify-between w-full mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400",children:"Administrative Boundaries"}),e.jsx(Ae,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700",children:r==null?void 0:r.county})]}),e.jsx(jp,{className:`w-3 h-3 text-gray-500 transition-transform ${T?"rotate-180":""}`})]}),e.jsxs(z5,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(we,{htmlFor:"county-boundary",className:"text-xs cursor-pointer text-gray-700 dark:text-gray-300 flex items-center gap-1.5",children:[e.jsx(fn,{className:"w-3 h-3 text-blue-600"}),"County Outline"]}),e.jsx(ml,{id:"county-boundary",checked:f,onCheckedChange:p})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(we,{htmlFor:"sub-counties",className:"text-xs cursor-pointer text-gray-700 dark:text-gray-300 flex items-center gap-1.5",children:[e.jsx(rie,{className:"w-3 h-3 text-purple-600"}),"Sub-Counties",a&&e.jsxs("span",{className:"text-[10px] text-gray-400",children:["(",a.features.length,")"]})]}),e.jsx(ml,{id:"sub-counties",checked:g,onCheckedChange:y})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(we,{htmlFor:"wards",className:"text-xs cursor-pointer text-gray-700 dark:text-gray-300 flex items-center gap-1.5",children:[e.jsx(nie,{className:"w-3 h-3 text-orange-600"}),"Wards",c&&e.jsxs("span",{className:"text-[10px] text-gray-400",children:["(",c.features.length,")"]})]}),e.jsx(ml,{id:"wards",checked:b,onCheckedChange:w})]})]}),e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100 dark:border-gray-800",children:e.jsxs("div",{className:"flex gap-1 flex-wrap",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 text-[10px] text-gray-500",children:[e.jsx("span",{className:"w-2 h-2 rounded-sm bg-blue-600"}),"County"]}),e.jsxs("span",{className:"inline-flex items-center gap-1 text-[10px] text-gray-500",children:[e.jsx("span",{className:"w-2 h-2 rounded-sm bg-purple-600"}),"Sub-County"]}),e.jsxs("span",{className:"inline-flex items-center gap-1 text-[10px] text-gray-500",children:[e.jsx("span",{className:"w-2 h-2 rounded-sm bg-orange-500"}),"Ward"]})]})})]})]}),Q.filter(De=>De.status==="processed").length>0&&e.jsxs(F5,{open:M,onOpenChange:O,className:"mt-4 pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs($5,{className:"flex items-center justify-between w-full mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400",children:"Uploaded Layers"}),e.jsx(Ae,{variant:"outline",className:"text-xs bg-green-50 text-green-700",children:Q.filter(De=>De.status==="processed").length})]}),e.jsx(jp,{className:`w-3 h-3 text-gray-500 transition-transform ${M?"rotate-180":""}`})]}),e.jsx(z5,{children:e.jsx("div",{className:"space-y-2",children:Q.filter(De=>De.status==="processed").map((De,Je)=>{const lt=["#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4"],qt=lt[Je%lt.length];return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(we,{htmlFor:`shapefile-${De.id}`,className:"text-xs cursor-pointer text-gray-700 dark:text-gray-300 flex items-center gap-1.5 truncate",children:[e.jsx(eie,{className:"w-3 h-3 flex-shrink-0",style:{color:qt}}),e.jsx("span",{className:"truncate",title:De.name,children:De.name}),e.jsxs("span",{className:"text-[10px] text-gray-400 flex-shrink-0",children:["(",De.feature_count,")"]})]}),e.jsx(ml,{id:`shapefile-${De.id}`,checked:C.has(De.id),onCheckedChange:()=>re(De.id)})]},De.id)})})})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400",children:"Quick Layers"}),e.jsx(Ae,{variant:"outline",className:"text-xs",children:"Vector Tiles"})]}),e.jsx("div",{className:"space-y-2",children:UA.slice(0,3).map(De=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(we,{htmlFor:`quick-layer-${De.id}`,className:"text-xs cursor-pointer text-gray-700 dark:text-gray-300",children:De.name}),e.jsx(ml,{id:`quick-layer-${De.id}`,checked:Pe.has(De.id),onCheckedChange:()=>Vt(De.id)})]},De.id))})]})]})}),ae&&e.jsx(dfe,{enabledLayers:Pe,onLayerToggle:Vt,onStatusFilterChange:Ve,onCategoryFilterChange:Ct,onOpacityChange:Ke,className:"absolute top-4 left-72"})]})}function q5(){return e.jsxs("div",{className:"h-[calc(100vh-0px)] w-full flex flex-col",children:[e.jsxs("div",{className:"border-b bg-white p-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Map Console"}),e.jsx("p",{className:"text-gray-600",children:"Interactive map viewer with layer management"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(ufe,{})})]})}const ws=A.forwardRef(({className:t,...r},s)=>e.jsx("textarea",{className:dr("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...r}));ws.displayName="Textarea";function hfe(t,r=[]){let s=[];function n(o,c){const i=A.createContext(c),f=s.length;s=[...s,c];function p(y){const{scope:b,children:w,...T}=y,N=(b==null?void 0:b[t][f])||i,M=A.useMemo(()=>T,Object.values(T));return e.jsx(N.Provider,{value:M,children:w})}function g(y,b){const w=(b==null?void 0:b[t][f])||i,T=A.useContext(w);if(T)return T;if(c!==void 0)return c;throw new Error(`\`${y}\` must be used within \`${o}\``)}return p.displayName=o+"Provider",[p,g]}const a=()=>{const o=s.map(c=>A.createContext(c));return function(i){const f=(i==null?void 0:i[t])||o;return A.useMemo(()=>({[`__scope${t}`]:{...i,[t]:f}}),[i,f])}};return a.scopeName=t,[n,mfe(a,...r)]}function mfe(...t){const r=t[0];if(t.length===1)return r;const s=()=>{const n=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(o){const c=n.reduce((i,{useScope:f,scopeName:p})=>{const y=f(o)[`__scope${p}`];return{...i,...y}},{});return A.useMemo(()=>({[`__scope${r.scopeName}`]:c}),[c])}};return s.scopeName=r.scopeName,s}var JI="Progress",eD=100,[ffe]=hfe(JI),[pfe,xfe]=ffe(JI),jG=A.forwardRef((t,r)=>{const{__scopeProgress:s,value:n=null,max:a,getValueLabel:o=gfe,...c}=t;(a||a===0)&&!V5(a)&&console.error(yfe(`${a}`,"Progress"));const i=V5(a)?a:eD;n!==null&&!U5(n,i)&&console.error(vfe(`${n}`,"Progress"));const f=U5(n,i)?n:null,p=DS(f)?o(f,i):void 0;return e.jsx(pfe,{scope:s,value:f,max:i,children:e.jsx(Tr.div,{"aria-valuemax":i,"aria-valuemin":0,"aria-valuenow":DS(f)?f:void 0,"aria-valuetext":p,role:"progressbar","data-state":wG(f,i),"data-value":f??void 0,"data-max":i,...c,ref:r})})});jG.displayName=JI;var bG="ProgressIndicator",_G=A.forwardRef((t,r)=>{const{__scopeProgress:s,...n}=t,a=xfe(bG,s);return e.jsx(Tr.div,{"data-state":wG(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...n,ref:r})});_G.displayName=bG;function gfe(t,r){return`${Math.round(t/r*100)}%`}function wG(t,r){return t==null?"indeterminate":t===r?"complete":"loading"}function DS(t){return typeof t=="number"}function V5(t){return DS(t)&&!isNaN(t)&&t>0}function U5(t,r){return DS(t)&&!isNaN(t)&&t<=r&&t>=0}function yfe(t,r){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${r}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${eD}\`.`}function vfe(t,r){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${r}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${eD} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var NG=jG,jfe=_G;const Wi=A.forwardRef(({className:t,value:r,...s},n)=>e.jsx(NG,{ref:n,className:dr("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",t),...s,children:e.jsx(jfe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(r||0)}%)`}})}));Wi.displayName=NG.displayName;var SG={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.11.0/LICENSE.txt
 */(function(t,r){(function(s,n){t.exports=n()})(N0,function(){var s={},n={};function a(c,i,f){if(n[c]=f,c==="index"){var p="var sharedModule = {}; ("+n.shared+")(sharedModule); ("+n.worker+")(sharedModule);",g={};return n.shared(g),n.index(s,g),typeof window<"u"&&s.setWorkerUrl(window.URL.createObjectURL(new Blob([p],{type:"text/javascript"}))),s}}a("shared",["exports"],function(c){function i(h,d,u,x){return new(u||(u=Promise))(function(j,k){function E(V){try{$(x.next(V))}catch(W){k(W)}}function R(V){try{$(x.throw(V))}catch(W){k(W)}}function $(V){var W;V.done?j(V.value):(W=V.value,W instanceof u?W:new u(function(ee){ee(W)})).then(E,R)}$((x=x.apply(h,d||[])).next())})}function f(h,d){this.x=h,this.y=d}function p(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var g,y;typeof SuppressedError=="function"&&SuppressedError,f.prototype={clone(){return new f(this.x,this.y)},add(h){return this.clone()._add(h)},sub(h){return this.clone()._sub(h)},multByPoint(h){return this.clone()._multByPoint(h)},divByPoint(h){return this.clone()._divByPoint(h)},mult(h){return this.clone()._mult(h)},div(h){return this.clone()._div(h)},rotate(h){return this.clone()._rotate(h)},rotateAround(h,d){return this.clone()._rotateAround(h,d)},matMult(h){return this.clone()._matMult(h)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(h){return this.x===h.x&&this.y===h.y},dist(h){return Math.sqrt(this.distSqr(h))},distSqr(h){const d=h.x-this.x,u=h.y-this.y;return d*d+u*u},angle(){return Math.atan2(this.y,this.x)},angleTo(h){return Math.atan2(this.y-h.y,this.x-h.x)},angleWith(h){return this.angleWithSep(h.x,h.y)},angleWithSep(h,d){return Math.atan2(this.x*d-this.y*h,this.x*h+this.y*d)},_matMult(h){const d=h[2]*this.x+h[3]*this.y;return this.x=h[0]*this.x+h[1]*this.y,this.y=d,this},_add(h){return this.x+=h.x,this.y+=h.y,this},_sub(h){return this.x-=h.x,this.y-=h.y,this},_mult(h){return this.x*=h,this.y*=h,this},_div(h){return this.x/=h,this.y/=h,this},_multByPoint(h){return this.x*=h.x,this.y*=h.y,this},_divByPoint(h){return this.x/=h.x,this.y/=h.y,this},_unit(){return this._div(this.mag()),this},_perp(){const h=this.y;return this.y=this.x,this.x=-h,this},_rotate(h){const d=Math.cos(h),u=Math.sin(h),x=u*this.x+d*this.y;return this.x=d*this.x-u*this.y,this.y=x,this},_rotateAround(h,d){const u=Math.cos(h),x=Math.sin(h),j=d.y+x*(this.x-d.x)+u*(this.y-d.y);return this.x=d.x+u*(this.x-d.x)-x*(this.y-d.y),this.y=j,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:f},f.convert=function(h){if(h instanceof f)return h;if(Array.isArray(h))return new f(+h[0],+h[1]);if(h.x!==void 0&&h.y!==void 0)return new f(+h.x,+h.y);throw new Error("Expected [x, y] or {x, y} point format")};var b=function(){if(y)return g;function h(d,u,x,j){this.cx=3*d,this.bx=3*(x-d)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(j-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=d,this.p1y=u,this.p2x=x,this.p2y=j}return y=1,g=h,h.prototype={sampleCurveX:function(d){return((this.ax*d+this.bx)*d+this.cx)*d},sampleCurveY:function(d){return((this.ay*d+this.by)*d+this.cy)*d},sampleCurveDerivativeX:function(d){return(3*this.ax*d+2*this.bx)*d+this.cx},solveCurveX:function(d,u){if(u===void 0&&(u=1e-6),d<0)return 0;if(d>1)return 1;for(var x=d,j=0;j<8;j++){var k=this.sampleCurveX(x)-d;if(Math.abs(k)<u)return x;var E=this.sampleCurveDerivativeX(x);if(Math.abs(E)<1e-6)break;x-=k/E}var R=0,$=1;for(x=d,j=0;j<20&&(k=this.sampleCurveX(x),!(Math.abs(k-d)<u));j++)d>k?R=x:$=x,x=.5*($-R)+R;return x},solve:function(d,u){return this.sampleCurveY(this.solveCurveX(d,u))}},g}(),w=p(b);let T,N;function M(){return T==null&&(T=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),T}function O(){if(N==null&&(N=!1,M())){const d=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(d){for(let x=0;x<5*5;x++){const j=4*x;d.fillStyle=`rgb(${j},${j+1},${j+2})`,d.fillRect(x%5,Math.floor(x/5),1,1)}const u=d.getImageData(0,0,5,5).data;for(let x=0;x<5*5*4;x++)if(x%4!=3&&u[x]!==x){N=!0;break}}}return N||!1}var C=1e-6,D=typeof Float32Array<"u"?Float32Array:Array;function L(){var h=new D(9);return D!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h}function F(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h}function B(){var h=new D(3);return D!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),h}function U(h){var d=h[0],u=h[1],x=h[2];return Math.sqrt(d*d+u*u+x*x)}function te(h,d,u){var x=new D(3);return x[0]=h,x[1]=d,x[2]=u,x}function Q(h,d,u){return h[0]=d[0]+u[0],h[1]=d[1]+u[1],h[2]=d[2]+u[2],h}function re(h,d,u){return h[0]=d[0]*u,h[1]=d[1]*u,h[2]=d[2]*u,h}function Z(h,d,u){var x=d[0],j=d[1],k=d[2],E=u[0],R=u[1],$=u[2];return h[0]=j*$-k*R,h[1]=k*E-x*$,h[2]=x*R-j*E,h}var ne,oe=U;function Ce(h,d,u){var x=d[0],j=d[1],k=d[2],E=d[3];return h[0]=u[0]*x+u[4]*j+u[8]*k+u[12]*E,h[1]=u[1]*x+u[5]*j+u[9]*k+u[13]*E,h[2]=u[2]*x+u[6]*j+u[10]*k+u[14]*E,h[3]=u[3]*x+u[7]*j+u[11]*k+u[15]*E,h}function Pe(){var h=new D(4);return D!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),h[3]=1,h}function Se(h,d,u,x){var j=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",k=Math.PI/360;d*=k,x*=k,u*=k;var E=Math.sin(d),R=Math.cos(d),$=Math.sin(u),V=Math.cos(u),W=Math.sin(x),ee=Math.cos(x);switch(j){case"xyz":h[0]=E*V*ee+R*$*W,h[1]=R*$*ee-E*V*W,h[2]=R*V*W+E*$*ee,h[3]=R*V*ee-E*$*W;break;case"xzy":h[0]=E*V*ee-R*$*W,h[1]=R*$*ee-E*V*W,h[2]=R*V*W+E*$*ee,h[3]=R*V*ee+E*$*W;break;case"yxz":h[0]=E*V*ee+R*$*W,h[1]=R*$*ee-E*V*W,h[2]=R*V*W-E*$*ee,h[3]=R*V*ee+E*$*W;break;case"yzx":h[0]=E*V*ee+R*$*W,h[1]=R*$*ee+E*V*W,h[2]=R*V*W-E*$*ee,h[3]=R*V*ee-E*$*W;break;case"zxy":h[0]=E*V*ee-R*$*W,h[1]=R*$*ee+E*V*W,h[2]=R*V*W+E*$*ee,h[3]=R*V*ee-E*$*W;break;case"zyx":h[0]=E*V*ee-R*$*W,h[1]=R*$*ee+E*V*W,h[2]=R*V*W-E*$*ee,h[3]=R*V*ee+E*$*W;break;default:throw new Error("Unknown angle order "+j)}return h}function ae(){var h=new D(2);return D!=Float32Array&&(h[0]=0,h[1]=0),h}function be(h,d){var u=new D(2);return u[0]=h,u[1]=d,u}B(),ne=new D(4),D!=Float32Array&&(ne[0]=0,ne[1]=0,ne[2]=0,ne[3]=0),B(),te(1,0,0),te(0,1,0),Pe(),Pe(),L(),ae();const de=8192;function Ke(h,d,u){return d*(de/(h.tileSize*Math.pow(2,u-h.tileID.overscaledZ)))}function He(h,d){return(h%d+d)%d}function Ve(h,d,u){return h*(1-u)+d*u}function yt(h){if(h<=0)return 0;if(h>=1)return 1;const d=h*h,u=d*h;return 4*(h<.5?u:3*(h-d)+u-.75)}function Et(h,d,u,x){const j=new w(h,d,u,x);return k=>j.solve(k)}const Rt=Et(.25,.1,.25,1);function Vt(h,d,u){return Math.min(u,Math.max(d,h))}function Ct(h,d,u){const x=u-d,j=((h-d)%x+x)%x+d;return j===d?u:j}function ur(h,...d){for(const u of d)for(const x in u)h[x]=u[x];return h}let At=1;function Ht(h,d,u){const x={};for(const j in h)x[j]=d.call(this,h[j],j,h);return x}function fr(h,d,u){const x={};for(const j in h)d.call(this,h[j],j,h)&&(x[j]=h[j]);return x}function vt(h){return Array.isArray(h)?h.map(vt):typeof h=="object"&&h?Ht(h,vt):h}const Br={};function vr(h){Br[h]||(typeof console<"u"&&console.warn(h),Br[h]=!0)}function Xr(h,d,u){return(u.y-h.y)*(d.x-h.x)>(d.y-h.y)*(u.x-h.x)}function Dr(h){return typeof WorkerGlobalScope<"u"&&h!==void 0&&h instanceof WorkerGlobalScope}let As=null;function xn(h){if(As==null){const d=h.navigator?h.navigator.userAgent:null;As=!!h.safari||!(!d||!(/\b(iPad|iPhone|iPod)\b/.test(d)||d.match("Safari")&&!d.match("Chrome")))}return As}function Qs(h){return typeof ImageBitmap<"u"&&h instanceof ImageBitmap}const De="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Je(h,d,u,x,j){return i(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const k=new VideoFrame(h,{timestamp:0});try{const E=k==null?void 0:k.format;if(!E||!E.startsWith("BGR")&&!E.startsWith("RGB"))throw new Error(`Unrecognized format ${E}`);const R=E.startsWith("BGR"),$=new Uint8ClampedArray(x*j*4);if(yield k.copyTo($,function(V,W,ee,ce,me){const xe=4*Math.max(-W,0),Ne=(Math.max(0,ee)-ee)*ce*4+xe,Te=4*ce,Le=Math.max(0,W),at=Math.max(0,ee);return{rect:{x:Le,y:at,width:Math.min(V.width,W+ce)-Le,height:Math.min(V.height,ee+me)-at},layout:[{offset:Ne,stride:Te}]}}(h,d,u,x,j)),R)for(let V=0;V<$.length;V+=4){const W=$[V];$[V]=$[V+2],$[V+2]=W}return $}finally{k.close()}})}let lt,qt;function It(h,d,u,x){return h.addEventListener(d,u,x),{unsubscribe:()=>{h.removeEventListener(d,u,x)}}}function Bt(h){return h*Math.PI/180}function er(h){return h/Math.PI*180}const Qr={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Ss={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Tn="AbortError";function Xe(){return new Error(Tn)}const ye={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ve(h){return ye.REGISTERED_PROTOCOLS[h.substring(0,h.indexOf("://"))]}const ke="global-dispatcher";class Fe extends Error{constructor(d,u,x,j){super(`AJAXError: ${u} (${d}): ${x}`),this.status=d,this.statusText=u,this.url=x,this.body=j}}const Ge=()=>Dr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,nt=function(h,d){if(/:\/\//.test(h.url)&&!/^https?:|^file:/.test(h.url)){const x=ve(h.url);if(x)return x(h,d);if(Dr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:h,targetMapId:ke},d)}if(!(/^file:/.test(u=h.url)||/^file:/.test(Ge())&&!/^\w+:/.test(u))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(x,j){return i(this,void 0,void 0,function*(){const k=new Request(x.url,{method:x.method||"GET",body:x.body,credentials:x.credentials,headers:x.headers,cache:x.cache,referrer:Ge(),signal:j.signal});let E,R;x.type!=="json"||k.headers.has("Accept")||k.headers.set("Accept","application/json");try{E=yield fetch(k)}catch(V){throw new Fe(0,V.message,x.url,new Blob)}if(!E.ok){const V=yield E.blob();throw new Fe(E.status,E.statusText,x.url,V)}R=x.type==="arrayBuffer"||x.type==="image"?E.arrayBuffer():x.type==="json"?E.json():E.text();const $=yield R;if(j.signal.aborted)throw Xe();return{data:$,cacheControl:E.headers.get("Cache-Control"),expires:E.headers.get("Expires")}})}(h,d);if(Dr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:h,mustQueue:!0,targetMapId:ke},d)}var u;return function(x,j){return new Promise((k,E)=>{var R;const $=new XMLHttpRequest;$.open(x.method||"GET",x.url,!0),x.type!=="arrayBuffer"&&x.type!=="image"||($.responseType="arraybuffer");for(const V in x.headers)$.setRequestHeader(V,x.headers[V]);x.type==="json"&&($.responseType="text",!((R=x.headers)===null||R===void 0)&&R.Accept||$.setRequestHeader("Accept","application/json")),$.withCredentials=x.credentials==="include",$.onerror=()=>{E(new Error($.statusText))},$.onload=()=>{if(!j.signal.aborted)if(($.status>=200&&$.status<300||$.status===0)&&$.response!==null){let V=$.response;if(x.type==="json")try{V=JSON.parse($.response)}catch(W){return void E(W)}k({data:V,cacheControl:$.getResponseHeader("Cache-Control"),expires:$.getResponseHeader("Expires")})}else{const V=new Blob([$.response],{type:$.getResponseHeader("Content-Type")});E(new Fe($.status,$.statusText,x.url,V))}},j.signal.addEventListener("abort",()=>{$.abort(),E(Xe())}),$.send(x.body)})}(h,d)};function dt(h){if(!h||h.indexOf("://")<=0||h.indexOf("data:image/")===0||h.indexOf("blob:")===0)return!0;const d=new URL(h),u=window.location;return d.protocol===u.protocol&&d.host===u.host}function rt(h,d,u){u[h]&&u[h].indexOf(d)!==-1||(u[h]=u[h]||[],u[h].push(d))}function ft(h,d,u){if(u&&u[h]){const x=u[h].indexOf(d);x!==-1&&u[h].splice(x,1)}}class $t{constructor(d,u={}){ur(this,u),this.type=d}}class Pt extends $t{constructor(d,u={}){super("error",ur({error:d},u))}}class br{on(d,u){return this._listeners=this._listeners||{},rt(d,u,this._listeners),{unsubscribe:()=>{this.off(d,u)}}}off(d,u){return ft(d,u,this._listeners),ft(d,u,this._oneTimeListeners),this}once(d,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},rt(d,u,this._oneTimeListeners),this):new Promise(x=>this.once(d,x))}fire(d,u){typeof d=="string"&&(d=new $t(d,u||{}));const x=d.type;if(this.listens(x)){d.target=this;const j=this._listeners&&this._listeners[x]?this._listeners[x].slice():[];for(const R of j)R.call(this,d);const k=this._oneTimeListeners&&this._oneTimeListeners[x]?this._oneTimeListeners[x].slice():[];for(const R of k)ft(x,R,this._oneTimeListeners),R.call(this,d);const E=this._eventedParent;E&&(ur(d,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),E.fire(d))}else d instanceof Pt&&console.error(d.error);return this}listens(d){return this._listeners&&this._listeners[d]&&this._listeners[d].length>0||this._oneTimeListeners&&this._oneTimeListeners[d]&&this._oneTimeListeners[d].length>0||this._eventedParent&&this._eventedParent.listens(d)}setEventedParent(d,u){return this._eventedParent=d,this._eventedParentData=u,this}}var ot={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const is=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function wr(h,d){const u={};for(const x in h)x!=="ref"&&(u[x]=h[x]);return is.forEach(x=>{x in d&&(u[x]=d[x])}),u}function tr(h,d){if(Array.isArray(h)){if(!Array.isArray(d)||h.length!==d.length)return!1;for(let u=0;u<h.length;u++)if(!tr(h[u],d[u]))return!1;return!0}if(typeof h=="object"&&h!==null&&d!==null){if(typeof d!="object"||Object.keys(h).length!==Object.keys(d).length)return!1;for(const u in h)if(!tr(h[u],d[u]))return!1;return!0}return h===d}function Cr(h,d){h.push(d)}function fs(h,d,u){Cr(u,{command:"addSource",args:[h,d[h]]})}function Os(h,d,u){Cr(d,{command:"removeSource",args:[h]}),u[h]=!0}function dn(h,d,u,x){Os(h,u,x),fs(h,d,u)}function Bs(h,d,u){let x;for(x in h[u])if(Object.prototype.hasOwnProperty.call(h[u],x)&&x!=="data"&&!tr(h[u][x],d[u][x]))return!1;for(x in d[u])if(Object.prototype.hasOwnProperty.call(d[u],x)&&x!=="data"&&!tr(h[u][x],d[u][x]))return!1;return!0}function qs(h,d,u,x,j,k){h=h||{},d=d||{};for(const E in h)Object.prototype.hasOwnProperty.call(h,E)&&(tr(h[E],d[E])||u.push({command:k,args:[x,E,d[E],j]}));for(const E in d)Object.prototype.hasOwnProperty.call(d,E)&&!Object.prototype.hasOwnProperty.call(h,E)&&(tr(h[E],d[E])||u.push({command:k,args:[x,E,d[E],j]}))}function Is(h){return h.id}function Na(h,d){return h[d.id]=d,h}class Lt{constructor(d,u,x,j){this.message=(d?`${d}: `:"")+x,j&&(this.identifier=j),u!=null&&u.__line__&&(this.line=u.__line__)}}function Yn(h,...d){for(const u of d)for(const x in u)h[x]=u[x];return h}class Mi extends Error{constructor(d,u){super(u),this.message=u,this.key=d}}class th{constructor(d,u=[]){this.parent=d,this.bindings={};for(const[x,j]of u)this.bindings[x]=j}concat(d){return new th(this,d)}get(d){if(this.bindings[d])return this.bindings[d];if(this.parent)return this.parent.get(d);throw new Error(`${d} not found in scope.`)}has(d){return!!this.bindings[d]||!!this.parent&&this.parent.has(d)}}const Xa={kind:"null"},Kt={kind:"number"},Jr={kind:"string"},cs={kind:"boolean"},Xo={kind:"color"},Hm={kind:"projectionDefinition"},Jc={kind:"object"},ns={kind:"value"},Zm={kind:"collator"},Bd={kind:"formatted"},Sl={kind:"padding"},ed={kind:"colorArray"},Ym={kind:"numberArray"},qd={kind:"resolvedImage"},Kp={kind:"variableAnchorOffsetCollection"};function mi(h,d){return{kind:"array",itemType:h,N:d}}function En(h){if(h.kind==="array"){const d=En(h.itemType);return typeof h.N=="number"?`array<${d}, ${h.N}>`:h.itemType.kind==="value"?"array":`array<${d}>`}return h.kind}const rh=[Xa,Kt,Jr,cs,Xo,Hm,Bd,Jc,mi(ns),Sl,Ym,ed,qd,Kp];function Vd(h,d){if(d.kind==="error")return null;if(h.kind==="array"){if(d.kind==="array"&&(d.N===0&&d.itemType.kind==="value"||!Vd(h.itemType,d.itemType))&&(typeof h.N!="number"||h.N===d.N))return null}else{if(h.kind===d.kind)return null;if(h.kind==="value"){for(const u of rh)if(!Vd(u,d))return null}}return`Expected ${En(h)} but found ${En(d)} instead.`}function xa(h,d){return d.some(u=>u.kind===h.kind)}function Ud(h,d){return d.some(u=>u==="null"?h===null:u==="array"?Array.isArray(h):u==="object"?h&&!Array.isArray(h)&&typeof h=="object":u===typeof h)}function ic(h,d){return h.kind==="array"&&d.kind==="array"?h.itemType.kind===d.itemType.kind&&typeof h.N=="number":h.kind===d.kind}const sh=.96422,$v=.82521,ow=4/29,nh=6/29,zv=3*nh*nh,qP=nh*nh*nh,lw=Math.PI/180,VP=180/Math.PI;function cw(h){return(h%=360)<0&&(h+=360),h}function dw([h,d,u,x]){let j,k;const E=qv((.2225045*(h=Bv(h))+.7168786*(d=Bv(d))+.0606169*(u=Bv(u)))/1);h===d&&d===u?j=k=E:(j=qv((.4360747*h+.3850649*d+.1430804*u)/sh),k=qv((.0139322*h+.0971045*d+.7141733*u)/$v));const R=116*E-16;return[R<0?0:R,500*(j-E),200*(E-k),x]}function Bv(h){return h<=.04045?h/12.92:Math.pow((h+.055)/1.055,2.4)}function qv(h){return h>qP?Math.pow(h,1/3):h/zv+ow}function uw([h,d,u,x]){let j=(h+16)/116,k=isNaN(d)?j:j+d/500,E=isNaN(u)?j:j-u/200;return j=1*Hp(j),k=sh*Hp(k),E=$v*Hp(E),[Vv(3.1338561*k-1.6168667*j-.4906146*E),Vv(-.9787684*k+1.9161415*j+.033454*E),Vv(.0719453*k-.2289914*j+1.4052427*E),x]}function Vv(h){return(h=h<=.00304?12.92*h:1.055*Math.pow(h,1/2.4)-.055)<0?0:h>1?1:h}function Hp(h){return h>nh?h*h*h:zv*(h-ow)}const Xm=Object.hasOwn||function(h,d){return Object.prototype.hasOwnProperty.call(h,d)};function Qm(h,d){return Xm(h,d)?h[d]:void 0}function Zp(h){return parseInt(h.padEnd(2,h),16)/255}function ah(h,d){return ih(d?h/100:h,0,1)}function ih(h,d,u){return Math.min(Math.max(d,h),u)}function hw(h){return!h.some(Number.isNaN)}const UP={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function oc(h,d,u){return h+u*(d-h)}function Wd(h,d,u){return h.map((x,j)=>oc(x,d[j],u))}class Kr{constructor(d,u,x,j=1,k=!0){this.r=d,this.g=u,this.b=x,this.a=j,k||(this.r*=j,this.g*=j,this.b*=j,j||this.overwriteGetter("rgb",[d,u,x,j]))}static parse(d){if(d instanceof Kr)return d;if(typeof d!="string")return;const u=function(x){if((x=x.toLowerCase().trim())==="transparent")return[0,0,0,0];const j=Qm(UP,x);if(j){const[E,R,$]=j;return[E/255,R/255,$/255,1]}if(x.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(x)){const E=x.length<6?1:2;let R=1;return[Zp(x.slice(R,R+=E)),Zp(x.slice(R,R+=E)),Zp(x.slice(R,R+=E)),Zp(x.slice(R,R+E)||"ff")]}if(x.startsWith("rgb")){const E=x.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(E){const[R,$,V,W,ee,ce,me,xe,Ne,Te,Le,at]=E,qe=[W||" ",me||" ",Te].join("");if(qe==="  "||qe==="  /"||qe===",,"||qe===",,,"){const Ze=[V,ce,Ne].join(""),ht=Ze==="%%%"?100:Ze===""?255:0;if(ht){const jt=[ih(+$/ht,0,1),ih(+ee/ht,0,1),ih(+xe/ht,0,1),Le?ah(+Le,at):1];if(hw(jt))return jt}}return}}const k=x.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(k){const[E,R,$,V,W,ee,ce,me,xe]=k,Ne=[$||" ",W||" ",ce].join("");if(Ne==="  "||Ne==="  /"||Ne===",,"||Ne===",,,"){const Te=[+R,ih(+V,0,100),ih(+ee,0,100),me?ah(+me,xe):1];if(hw(Te))return function([Le,at,qe,Ze]){function ht(jt){const zt=(jt+Le/30)%12,ar=at*Math.min(qe,1-qe);return qe-ar*Math.max(-1,Math.min(zt-3,9-zt,1))}return Le=cw(Le),at/=100,qe/=100,[ht(0),ht(8),ht(4),Ze]}(Te)}}}(d);return u?new Kr(...u,!1):void 0}get rgb(){const{r:d,g:u,b:x,a:j}=this,k=j||1/0;return this.overwriteGetter("rgb",[d/k,u/k,x/k,j])}get hcl(){return this.overwriteGetter("hcl",function(d){const[u,x,j,k]=dw(d),E=Math.sqrt(x*x+j*j);return[Math.round(1e4*E)?cw(Math.atan2(j,x)*VP):NaN,E,u,k]}(this.rgb))}get lab(){return this.overwriteGetter("lab",dw(this.rgb))}overwriteGetter(d,u){return Object.defineProperty(this,d,{value:u}),u}toString(){const[d,u,x,j]=this.rgb;return`rgba(${[d,u,x].map(k=>Math.round(255*k)).join(",")},${j})`}static interpolate(d,u,x,j="rgb"){switch(j){case"rgb":{const[k,E,R,$]=Wd(d.rgb,u.rgb,x);return new Kr(k,E,R,$,!1)}case"hcl":{const[k,E,R,$]=d.hcl,[V,W,ee,ce]=u.hcl;let me,xe;if(isNaN(k)||isNaN(V))isNaN(k)?isNaN(V)?me=NaN:(me=V,R!==1&&R!==0||(xe=W)):(me=k,ee!==1&&ee!==0||(xe=E));else{let qe=V-k;V>k&&qe>180?qe-=360:V<k&&k-V>180&&(qe+=360),me=k+x*qe}const[Ne,Te,Le,at]=function([qe,Ze,ht,jt]){return qe=isNaN(qe)?0:qe*lw,uw([ht,Math.cos(qe)*Ze,Math.sin(qe)*Ze,jt])}([me,xe??oc(E,W,x),oc(R,ee,x),oc($,ce,x)]);return new Kr(Ne,Te,Le,at,!1)}case"lab":{const[k,E,R,$]=uw(Wd(d.lab,u.lab,x));return new Kr(k,E,R,$,!1)}}}}Kr.black=new Kr(0,0,0,1),Kr.white=new Kr(1,1,1,1),Kr.transparent=new Kr(0,0,0,0),Kr.red=new Kr(1,0,0,1);class xs{constructor(d,u,x){this.sensitivity=d?u?"variant":"case":u?"accent":"base",this.locale=x,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(d,u){return this.collator.compare(d,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const oh=["bottom","center","top"];class Cl{constructor(d,u,x,j,k,E){this.text=d,this.image=u,this.scale=x,this.fontStack=j,this.textColor=k,this.verticalAlign=E}}class Xi{constructor(d){this.sections=d}static fromString(d){return new Xi([new Cl(d,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(d=>d.text.length!==0||d.image&&d.image.name.length!==0)}static factory(d){return d instanceof Xi?d:Xi.fromString(d)}toString(){return this.sections.length===0?"":this.sections.map(d=>d.text).join("")}}class fi{constructor(d){this.values=d.slice()}static parse(d){if(d instanceof fi)return d;if(typeof d=="number")return new fi([d,d,d,d]);if(Array.isArray(d)&&!(d.length<1||d.length>4)){for(const u of d)if(typeof u!="number")return;switch(d.length){case 1:d=[d[0],d[0],d[0],d[0]];break;case 2:d=[d[0],d[1],d[0],d[1]];break;case 3:d=[d[0],d[1],d[2],d[1]]}return new fi(d)}}toString(){return JSON.stringify(this.values)}static interpolate(d,u,x){return new fi(Wd(d.values,u.values,x))}}class Qa{constructor(d){this.values=d.slice()}static parse(d){if(d instanceof Qa)return d;if(typeof d=="number")return new Qa([d]);if(Array.isArray(d)){for(const u of d)if(typeof u!="number")return;return new Qa(d)}}toString(){return JSON.stringify(this.values)}static interpolate(d,u,x){return new Qa(Wd(d.values,u.values,x))}}class na{constructor(d){this.values=d.slice()}static parse(d){if(d instanceof na)return d;if(typeof d=="string"){const x=Kr.parse(d);return x?new na([x]):void 0}if(!Array.isArray(d))return;const u=[];for(const x of d){if(typeof x!="string")return;const j=Kr.parse(x);if(!j)return;u.push(j)}return new na(u)}toString(){return JSON.stringify(this.values)}static interpolate(d,u,x,j="rgb"){const k=[];if(d.values.length!=u.values.length)throw new Error(`colorArray: Arrays have mismatched length (${d.values.length} vs. ${u.values.length}), cannot interpolate.`);for(let E=0;E<d.values.length;E++)k.push(Kr.interpolate(d.values[E],u.values[E],x,j));return new na(k)}}class gn extends Error{constructor(d){super(d),this.name="RuntimeError"}toJSON(){return this.message}}const mw=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class pi{constructor(d){this.values=d.slice()}static parse(d){if(d instanceof pi)return d;if(Array.isArray(d)&&!(d.length<1)&&d.length%2==0){for(let u=0;u<d.length;u+=2){const x=d[u],j=d[u+1];if(typeof x!="string"||!mw.has(x)||!Array.isArray(j)||j.length!==2||typeof j[0]!="number"||typeof j[1]!="number")return}return new pi(d)}}toString(){return JSON.stringify(this.values)}static interpolate(d,u,x){const j=d.values,k=u.values;if(j.length!==k.length)throw new gn(`Cannot interpolate values of different length. from: ${d.toString()}, to: ${u.toString()}`);const E=[];for(let R=0;R<j.length;R+=2){if(j[R]!==k[R])throw new gn(`Cannot interpolate values containing mismatched anchors. from[${R}]: ${j[R]}, to[${R}]: ${k[R]}`);E.push(j[R]);const[$,V]=j[R+1],[W,ee]=k[R+1];E.push([oc($,W,x),oc(V,ee,x)])}return new pi(E)}}class Oi{constructor(d){this.name=d.name,this.available=d.available}toString(){return this.name}static fromString(d){return d?new Oi({name:d,available:!1}):null}}class fo{constructor(d,u,x){this.from=d,this.to=u,this.transition=x}static interpolate(d,u,x){return new fo(d,u,x)}static parse(d){return d instanceof fo?d:Array.isArray(d)&&d.length===3&&typeof d[0]=="string"&&typeof d[1]=="string"&&typeof d[2]=="number"?new fo(d[0],d[1],d[2]):typeof d=="object"&&typeof d.from=="string"&&typeof d.to=="string"&&typeof d.transition=="number"?new fo(d.from,d.to,d.transition):typeof d=="string"?new fo(d,d,1):void 0}}function Jm(h,d,u,x){return typeof h=="number"&&h>=0&&h<=255&&typeof d=="number"&&d>=0&&d<=255&&typeof u=="number"&&u>=0&&u<=255?x===void 0||typeof x=="number"&&x>=0&&x<=1?null:`Invalid rgba value [${[h,d,u,x].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof x=="number"?[h,d,u,x]:[h,d,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Pl(h){if(h===null||typeof h=="string"||typeof h=="boolean"||typeof h=="number"||h instanceof fo||h instanceof Kr||h instanceof xs||h instanceof Xi||h instanceof fi||h instanceof Qa||h instanceof na||h instanceof pi||h instanceof Oi)return!0;if(Array.isArray(h)){for(const d of h)if(!Pl(d))return!1;return!0}if(typeof h=="object"){for(const d in h)if(!Pl(h[d]))return!1;return!0}return!1}function Xn(h){if(h===null)return Xa;if(typeof h=="string")return Jr;if(typeof h=="boolean")return cs;if(typeof h=="number")return Kt;if(h instanceof Kr)return Xo;if(h instanceof fo)return Hm;if(h instanceof xs)return Zm;if(h instanceof Xi)return Bd;if(h instanceof fi)return Sl;if(h instanceof Qa)return Ym;if(h instanceof na)return ed;if(h instanceof pi)return Kp;if(h instanceof Oi)return qd;if(Array.isArray(h)){const d=h.length;let u;for(const x of h){const j=Xn(x);if(u){if(u===j)continue;u=ns;break}u=j}return mi(u||ns,d)}return Jc}function lh(h){const d=typeof h;return h===null?"":d==="string"||d==="number"||d==="boolean"?String(h):h instanceof Kr||h instanceof fo||h instanceof Xi||h instanceof fi||h instanceof Qa||h instanceof na||h instanceof pi||h instanceof Oi?h.toString():JSON.stringify(h)}class td{constructor(d,u){this.type=d,this.value=u}static parse(d,u){if(d.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${d.length-1} instead.`);if(!Pl(d[1]))return u.error("invalid value");const x=d[1];let j=Xn(x);const k=u.expectedType;return j.kind!=="array"||j.N!==0||!k||k.kind!=="array"||typeof k.N=="number"&&k.N!==0||(j=k),new td(j,x)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Gd={string:Jr,number:Kt,boolean:cs,object:Jc};class Ts{constructor(d,u){this.type=d,this.args=u}static parse(d,u){if(d.length<2)return u.error("Expected at least one argument.");let x,j=1;const k=d[0];if(k==="array"){let R,$;if(d.length>2){const V=d[1];if(typeof V!="string"||!(V in Gd)||V==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);R=Gd[V],j++}else R=ns;if(d.length>3){if(d[2]!==null&&(typeof d[2]!="number"||d[2]<0||d[2]!==Math.floor(d[2])))return u.error('The length argument to "array" must be a positive integer literal',2);$=d[2],j++}x=mi(R,$)}else{if(!Gd[k])throw new Error(`Types doesn't contain name = ${k}`);x=Gd[k]}const E=[];for(;j<d.length;j++){const R=u.parse(d[j],j,ns);if(!R)return null;E.push(R)}return new Ts(x,E)}evaluate(d){for(let u=0;u<this.args.length;u++){const x=this.args[u].evaluate(d);if(!Vd(this.type,Xn(x)))return x;if(u===this.args.length-1)throw new gn(`Expected value to be of type ${En(this.type)}, but found ${En(Xn(x))} instead.`)}throw new Error}eachChild(d){this.args.forEach(d)}outputDefined(){return this.args.every(d=>d.outputDefined())}}const Yp={"to-boolean":cs,"to-color":Xo,"to-number":Kt,"to-string":Jr};class ds{constructor(d,u){this.type=d,this.args=u}static parse(d,u){if(d.length<2)return u.error("Expected at least one argument.");const x=d[0];if(!Yp[x])throw new Error(`Can't parse ${x} as it is not part of the known types`);if((x==="to-boolean"||x==="to-string")&&d.length!==2)return u.error("Expected one argument.");const j=Yp[x],k=[];for(let E=1;E<d.length;E++){const R=u.parse(d[E],E,ns);if(!R)return null;k.push(R)}return new ds(j,k)}evaluate(d){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(d);case"color":{let u,x;for(const j of this.args){if(u=j.evaluate(d),x=null,u instanceof Kr)return u;if(typeof u=="string"){const k=d.parseColor(u);if(k)return k}else if(Array.isArray(u)&&(x=u.length<3||u.length>4?`Invalid rgba value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:Jm(u[0],u[1],u[2],u[3]),!x))return new Kr(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new gn(x||`Could not parse color from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"padding":{let u;for(const x of this.args){u=x.evaluate(d);const j=fi.parse(u);if(j)return j}throw new gn(`Could not parse padding from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"numberArray":{let u;for(const x of this.args){u=x.evaluate(d);const j=Qa.parse(u);if(j)return j}throw new gn(`Could not parse numberArray from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"colorArray":{let u;for(const x of this.args){u=x.evaluate(d);const j=na.parse(u);if(j)return j}throw new gn(`Could not parse colorArray from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"variableAnchorOffsetCollection":{let u;for(const x of this.args){u=x.evaluate(d);const j=pi.parse(u);if(j)return j}throw new gn(`Could not parse variableAnchorOffsetCollection from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"number":{let u=null;for(const x of this.args){if(u=x.evaluate(d),u===null)return 0;const j=Number(u);if(!isNaN(j))return j}throw new gn(`Could not convert ${JSON.stringify(u)} to number.`)}case"formatted":return Xi.fromString(lh(this.args[0].evaluate(d)));case"resolvedImage":return Oi.fromString(lh(this.args[0].evaluate(d)));case"projectionDefinition":return this.args[0].evaluate(d);default:return lh(this.args[0].evaluate(d))}}eachChild(d){this.args.forEach(d)}outputDefined(){return this.args.every(d=>d.outputDefined())}}const os=["Unknown","Point","LineString","Polygon"];class Xp{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?os[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(d){let u=this._parseColorCache.get(d);return u||(u=Kr.parse(d),this._parseColorCache.set(d,u)),u}}class Cs{constructor(d,u,x=[],j,k=new th,E=[]){this.registry=d,this.path=x,this.key=x.map(R=>`[${R}]`).join(""),this.scope=k,this.errors=E,this.expectedType=j,this._isConstant=u}parse(d,u,x,j,k={}){return u?this.concat(u,x,j)._parse(d,k):this._parse(d,k)}_parse(d,u){function x(j,k,E){return E==="assert"?new Ts(k,[j]):E==="coerce"?new ds(k,[j]):j}if(d!==null&&typeof d!="string"&&typeof d!="boolean"&&typeof d!="number"||(d=["literal",d]),Array.isArray(d)){if(d.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const j=d[0];if(typeof j!="string")return this.error(`Expression name must be a string, but found ${typeof j} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const k=this.registry[j];if(k){let E=k.parse(d,this);if(!E)return null;if(this.expectedType){const R=this.expectedType,$=E.type;if(R.kind!=="string"&&R.kind!=="number"&&R.kind!=="boolean"&&R.kind!=="object"&&R.kind!=="array"||$.kind!=="value"){if(R.kind==="projectionDefinition"&&["string","array"].includes($.kind)||["color","formatted","resolvedImage"].includes(R.kind)&&["value","string"].includes($.kind)||["padding","numberArray"].includes(R.kind)&&["value","number","array"].includes($.kind)||R.kind==="colorArray"&&["value","string","array"].includes($.kind)||R.kind==="variableAnchorOffsetCollection"&&["value","array"].includes($.kind))E=x(E,R,u.typeAnnotation||"coerce");else if(this.checkSubtype(R,$))return null}else E=x(E,R,u.typeAnnotation||"assert")}if(!(E instanceof td)&&E.type.kind!=="resolvedImage"&&this._isConstant(E)){const R=new Xp;try{E=new td(E.type,E.evaluate(R))}catch($){return this.error($.message),null}}return E}return this.error(`Unknown expression "${j}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(d===void 0?"'undefined' value invalid. Use null instead.":typeof d=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof d} instead.`)}concat(d,u,x){const j=typeof d=="number"?this.path.concat(d):this.path,k=x?this.scope.concat(x):this.scope;return new Cs(this.registry,this._isConstant,j,u||null,k,this.errors)}error(d,...u){const x=`${this.key}${u.map(j=>`[${j}]`).join("")}`;this.errors.push(new Mi(x,d))}checkSubtype(d,u){const x=Vd(d,u);return x&&this.error(x),x}}class ch{constructor(d,u){this.type=u.type,this.bindings=[].concat(d),this.result=u}evaluate(d){return this.result.evaluate(d)}eachChild(d){for(const u of this.bindings)d(u[1]);d(this.result)}static parse(d,u){if(d.length<4)return u.error(`Expected at least 3 arguments, but found ${d.length-1} instead.`);const x=[];for(let k=1;k<d.length-1;k+=2){const E=d[k];if(typeof E!="string")return u.error(`Expected string, but found ${typeof E} instead.`,k);if(/[^a-zA-Z0-9_]/.test(E))return u.error("Variable names must contain only alphanumeric characters or '_'.",k);const R=u.parse(d[k+1],k+1);if(!R)return null;x.push([E,R])}const j=u.parse(d[d.length-1],d.length-1,u.expectedType,x);return j?new ch(x,j):null}outputDefined(){return this.result.outputDefined()}}class To{constructor(d,u){this.type=u.type,this.name=d,this.boundExpression=u}static parse(d,u){if(d.length!==2||typeof d[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");const x=d[1];return u.scope.has(x)?new To(x,u.scope.get(x)):u.error(`Unknown variable "${x}". Make sure "${x}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(d){return this.boundExpression.evaluate(d)}eachChild(){}outputDefined(){return!1}}class ef{constructor(d,u,x){this.type=d,this.index=u,this.input=x}static parse(d,u){if(d.length!==3)return u.error(`Expected 2 arguments, but found ${d.length-1} instead.`);const x=u.parse(d[1],1,Kt),j=u.parse(d[2],2,mi(u.expectedType||ns));return x&&j?new ef(j.type.itemType,x,j):null}evaluate(d){const u=this.index.evaluate(d),x=this.input.evaluate(d);if(u<0)throw new gn(`Array index out of bounds: ${u} < 0.`);if(u>=x.length)throw new gn(`Array index out of bounds: ${u} > ${x.length-1}.`);if(u!==Math.floor(u))throw new gn(`Array index must be an integer, but found ${u} instead.`);return x[u]}eachChild(d){d(this.index),d(this.input)}outputDefined(){return!1}}class dh{constructor(d,u){this.type=cs,this.needle=d,this.haystack=u}static parse(d,u){if(d.length!==3)return u.error(`Expected 2 arguments, but found ${d.length-1} instead.`);const x=u.parse(d[1],1,ns),j=u.parse(d[2],2,ns);return x&&j?xa(x.type,[cs,Jr,Kt,Xa,ns])?new dh(x,j):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${En(x.type)} instead`):null}evaluate(d){const u=this.needle.evaluate(d),x=this.haystack.evaluate(d);if(!x)return!1;if(!Ud(u,["boolean","string","number","null"]))throw new gn(`Expected first argument to be of type boolean, string, number or null, but found ${En(Xn(u))} instead.`);if(!Ud(x,["string","array"]))throw new gn(`Expected second argument to be of type array or string, but found ${En(Xn(x))} instead.`);return x.indexOf(u)>=0}eachChild(d){d(this.needle),d(this.haystack)}outputDefined(){return!0}}class tf{constructor(d,u,x){this.type=Kt,this.needle=d,this.haystack=u,this.fromIndex=x}static parse(d,u){if(d.length<=2||d.length>=5)return u.error(`Expected 2 or 3 arguments, but found ${d.length-1} instead.`);const x=u.parse(d[1],1,ns),j=u.parse(d[2],2,ns);if(!x||!j)return null;if(!xa(x.type,[cs,Jr,Kt,Xa,ns]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${En(x.type)} instead`);if(d.length===4){const k=u.parse(d[3],3,Kt);return k?new tf(x,j,k):null}return new tf(x,j)}evaluate(d){const u=this.needle.evaluate(d),x=this.haystack.evaluate(d);if(!Ud(u,["boolean","string","number","null"]))throw new gn(`Expected first argument to be of type boolean, string, number or null, but found ${En(Xn(u))} instead.`);let j;if(this.fromIndex&&(j=this.fromIndex.evaluate(d)),Ud(x,["string"])){const k=x.indexOf(u,j);return k===-1?-1:[...x.slice(0,k)].length}if(Ud(x,["array"]))return x.indexOf(u,j);throw new gn(`Expected second argument to be of type array or string, but found ${En(Xn(x))} instead.`)}eachChild(d){d(this.needle),d(this.haystack),this.fromIndex&&d(this.fromIndex)}outputDefined(){return!1}}class rf{constructor(d,u,x,j,k,E){this.inputType=d,this.type=u,this.input=x,this.cases=j,this.outputs=k,this.otherwise=E}static parse(d,u){if(d.length<5)return u.error(`Expected at least 4 arguments, but found only ${d.length-1}.`);if(d.length%2!=1)return u.error("Expected an even number of arguments.");let x,j;u.expectedType&&u.expectedType.kind!=="value"&&(j=u.expectedType);const k={},E=[];for(let V=2;V<d.length-1;V+=2){let W=d[V];const ee=d[V+1];Array.isArray(W)||(W=[W]);const ce=u.concat(V);if(W.length===0)return ce.error("Expected at least one branch label.");for(const xe of W){if(typeof xe!="number"&&typeof xe!="string")return ce.error("Branch labels must be numbers or strings.");if(typeof xe=="number"&&Math.abs(xe)>Number.MAX_SAFE_INTEGER)return ce.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof xe=="number"&&Math.floor(xe)!==xe)return ce.error("Numeric branch labels must be integer values.");if(x){if(ce.checkSubtype(x,Xn(xe)))return null}else x=Xn(xe);if(k[String(xe)]!==void 0)return ce.error("Branch labels must be unique.");k[String(xe)]=E.length}const me=u.parse(ee,V,j);if(!me)return null;j=j||me.type,E.push(me)}const R=u.parse(d[1],1,ns);if(!R)return null;const $=u.parse(d[d.length-1],d.length-1,j);return $?R.type.kind!=="value"&&u.concat(1).checkSubtype(x,R.type)?null:new rf(x,j,R,k,E,$):null}evaluate(d){const u=this.input.evaluate(d);return(Xn(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(d)}eachChild(d){d(this.input),this.outputs.forEach(d),d(this.otherwise)}outputDefined(){return this.outputs.every(d=>d.outputDefined())&&this.otherwise.outputDefined()}}class Qp{constructor(d,u,x){this.type=d,this.branches=u,this.otherwise=x}static parse(d,u){if(d.length<4)return u.error(`Expected at least 3 arguments, but found only ${d.length-1}.`);if(d.length%2!=0)return u.error("Expected an odd number of arguments.");let x;u.expectedType&&u.expectedType.kind!=="value"&&(x=u.expectedType);const j=[];for(let E=1;E<d.length-1;E+=2){const R=u.parse(d[E],E,cs);if(!R)return null;const $=u.parse(d[E+1],E+1,x);if(!$)return null;j.push([R,$]),x=x||$.type}const k=u.parse(d[d.length-1],d.length-1,x);if(!k)return null;if(!x)throw new Error("Can't infer output type");return new Qp(x,j,k)}evaluate(d){for(const[u,x]of this.branches)if(u.evaluate(d))return x.evaluate(d);return this.otherwise.evaluate(d)}eachChild(d){for(const[u,x]of this.branches)d(u),d(x);d(this.otherwise)}outputDefined(){return this.branches.every(([d,u])=>u.outputDefined())&&this.otherwise.outputDefined()}}class Jp{constructor(d,u,x,j){this.type=d,this.input=u,this.beginIndex=x,this.endIndex=j}static parse(d,u){if(d.length<=2||d.length>=5)return u.error(`Expected 2 or 3 arguments, but found ${d.length-1} instead.`);const x=u.parse(d[1],1,ns),j=u.parse(d[2],2,Kt);if(!x||!j)return null;if(!xa(x.type,[mi(ns),Jr,ns]))return u.error(`Expected first argument to be of type array or string, but found ${En(x.type)} instead`);if(d.length===4){const k=u.parse(d[3],3,Kt);return k?new Jp(x.type,x,j,k):null}return new Jp(x.type,x,j)}evaluate(d){const u=this.input.evaluate(d),x=this.beginIndex.evaluate(d);let j;if(this.endIndex&&(j=this.endIndex.evaluate(d)),Ud(u,["string"]))return[...u].slice(x,j).join("");if(Ud(u,["array"]))return u.slice(x,j);throw new gn(`Expected first argument to be of type array or string, but found ${En(Xn(u))} instead.`)}eachChild(d){d(this.input),d(this.beginIndex),this.endIndex&&d(this.endIndex)}outputDefined(){return!1}}function sf(h,d){const u=h.length-1;let x,j,k=0,E=u,R=0;for(;k<=E;)if(R=Math.floor((k+E)/2),x=h[R],j=h[R+1],x<=d){if(R===u||d<j)return R;k=R+1}else{if(!(x>d))throw new gn("Input is not a number.");E=R-1}return 0}class uh{constructor(d,u,x){this.type=d,this.input=u,this.labels=[],this.outputs=[];for(const[j,k]of x)this.labels.push(j),this.outputs.push(k)}static parse(d,u){if(d.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${d.length-1}.`);if((d.length-1)%2!=0)return u.error("Expected an even number of arguments.");const x=u.parse(d[1],1,Kt);if(!x)return null;const j=[];let k=null;u.expectedType&&u.expectedType.kind!=="value"&&(k=u.expectedType);for(let E=1;E<d.length;E+=2){const R=E===1?-1/0:d[E],$=d[E+1],V=E,W=E+1;if(typeof R!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(j.length&&j[j.length-1][0]>=R)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',V);const ee=u.parse($,W,k);if(!ee)return null;k=k||ee.type,j.push([R,ee])}return new uh(k,x,j)}evaluate(d){const u=this.labels,x=this.outputs;if(u.length===1)return x[0].evaluate(d);const j=this.input.evaluate(d);if(j<=u[0])return x[0].evaluate(d);const k=u.length;return j>=u[k-1]?x[k-1].evaluate(d):x[sf(u,j)].evaluate(d)}eachChild(d){d(this.input);for(const u of this.outputs)d(u)}outputDefined(){return this.outputs.every(d=>d.outputDefined())}}function rd(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var Oa,nf,fw=function(){if(nf)return Oa;function h(d,u,x,j){this.cx=3*d,this.bx=3*(x-d)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(j-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=d,this.p1y=u,this.p2x=x,this.p2y=j}return nf=1,Oa=h,h.prototype={sampleCurveX:function(d){return((this.ax*d+this.bx)*d+this.cx)*d},sampleCurveY:function(d){return((this.ay*d+this.by)*d+this.cy)*d},sampleCurveDerivativeX:function(d){return(3*this.ax*d+2*this.bx)*d+this.cx},solveCurveX:function(d,u){if(u===void 0&&(u=1e-6),d<0)return 0;if(d>1)return 1;for(var x=d,j=0;j<8;j++){var k=this.sampleCurveX(x)-d;if(Math.abs(k)<u)return x;var E=this.sampleCurveDerivativeX(x);if(Math.abs(E)<1e-6)break;x-=k/E}var R=0,$=1;for(x=d,j=0;j<20&&(k=this.sampleCurveX(x),!(Math.abs(k-d)<u));j++)d>k?R=x:$=x,x=.5*($-R)+R;return x},solve:function(d,u){return this.sampleCurveY(this.solveCurveX(d,u))}},Oa}(),ex=rd(fw);class Gs{constructor(d,u,x,j,k){this.type=d,this.operator=u,this.interpolation=x,this.input=j,this.labels=[],this.outputs=[];for(const[E,R]of k)this.labels.push(E),this.outputs.push(R)}static interpolationFactor(d,u,x,j){let k=0;if(d.name==="exponential")k=tx(u,d.base,x,j);else if(d.name==="linear")k=tx(u,1,x,j);else if(d.name==="cubic-bezier"){const E=d.controlPoints;k=new ex(E[0],E[1],E[2],E[3]).solve(tx(u,1,x,j))}return k}static parse(d,u){let[x,j,k,...E]=d;if(!Array.isArray(j)||j.length===0)return u.error("Expected an interpolation type expression.",1);if(j[0]==="linear")j={name:"linear"};else if(j[0]==="exponential"){const V=j[1];if(typeof V!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);j={name:"exponential",base:V}}else{if(j[0]!=="cubic-bezier")return u.error(`Unknown interpolation type ${String(j[0])}`,1,0);{const V=j.slice(1);if(V.length!==4||V.some(W=>typeof W!="number"||W<0||W>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);j={name:"cubic-bezier",controlPoints:V}}}if(d.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${d.length-1}.`);if((d.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(k=u.parse(k,2,Kt),!k)return null;const R=[];let $=null;x!=="interpolate-hcl"&&x!=="interpolate-lab"||u.expectedType==ed?u.expectedType&&u.expectedType.kind!=="value"&&($=u.expectedType):$=Xo;for(let V=0;V<E.length;V+=2){const W=E[V],ee=E[V+1],ce=V+3,me=V+4;if(typeof W!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ce);if(R.length&&R[R.length-1][0]>=W)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ce);const xe=u.parse(ee,me,$);if(!xe)return null;$=$||xe.type,R.push([W,xe])}return ic($,Kt)||ic($,Hm)||ic($,Xo)||ic($,Sl)||ic($,Ym)||ic($,ed)||ic($,Kp)||ic($,mi(Kt))?new Gs($,x,j,k,R):u.error(`Type ${En($)} is not interpolatable.`)}evaluate(d){const u=this.labels,x=this.outputs;if(u.length===1)return x[0].evaluate(d);const j=this.input.evaluate(d);if(j<=u[0])return x[0].evaluate(d);const k=u.length;if(j>=u[k-1])return x[k-1].evaluate(d);const E=sf(u,j),R=Gs.interpolationFactor(this.interpolation,j,u[E],u[E+1]),$=x[E].evaluate(d),V=x[E+1].evaluate(d);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return oc($,V,R);case"color":return Kr.interpolate($,V,R);case"padding":return fi.interpolate($,V,R);case"colorArray":return na.interpolate($,V,R);case"numberArray":return Qa.interpolate($,V,R);case"variableAnchorOffsetCollection":return pi.interpolate($,V,R);case"array":return Wd($,V,R);case"projectionDefinition":return fo.interpolate($,V,R)}case"interpolate-hcl":switch(this.type.kind){case"color":return Kr.interpolate($,V,R,"hcl");case"colorArray":return na.interpolate($,V,R,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Kr.interpolate($,V,R,"lab");case"colorArray":return na.interpolate($,V,R,"lab")}}}eachChild(d){d(this.input);for(const u of this.outputs)d(u)}outputDefined(){return this.outputs.every(d=>d.outputDefined())}}function tx(h,d,u,x){const j=x-u,k=h-u;return j===0?0:d===1?k/j:(Math.pow(d,k)-1)/(Math.pow(d,j)-1)}const Eo={color:Kr.interpolate,number:oc,padding:fi.interpolate,numberArray:Qa.interpolate,colorArray:na.interpolate,variableAnchorOffsetCollection:pi.interpolate,array:Wd};class af{constructor(d,u){this.type=d,this.args=u}static parse(d,u){if(d.length<2)return u.error("Expected at least one argument.");let x=null;const j=u.expectedType;j&&j.kind!=="value"&&(x=j);const k=[];for(const R of d.slice(1)){const $=u.parse(R,1+k.length,x,void 0,{typeAnnotation:"omit"});if(!$)return null;x=x||$.type,k.push($)}if(!x)throw new Error("No output type");const E=j&&k.some(R=>Vd(j,R.type));return new af(E?ns:x,k)}evaluate(d){let u,x=null,j=0;for(const k of this.args)if(j++,x=k.evaluate(d),x&&x instanceof Oi&&!x.available&&(u||(u=x.name),x=null,j===this.args.length&&(x=u)),x!==null)break;return x}eachChild(d){this.args.forEach(d)}outputDefined(){return this.args.every(d=>d.outputDefined())}}function pw(h,d){return h==="=="||h==="!="?d.kind==="boolean"||d.kind==="string"||d.kind==="number"||d.kind==="null"||d.kind==="value":d.kind==="string"||d.kind==="number"||d.kind==="value"}function Kd(h,d,u,x){return x.compare(d,u)===0}function lc(h,d,u){const x=h!=="=="&&h!=="!=";return class CG{constructor(k,E,R){this.type=cs,this.lhs=k,this.rhs=E,this.collator=R,this.hasUntypedArgument=k.type.kind==="value"||E.type.kind==="value"}static parse(k,E){if(k.length!==3&&k.length!==4)return E.error("Expected two or three arguments.");const R=k[0];let $=E.parse(k[1],1,ns);if(!$)return null;if(!pw(R,$.type))return E.concat(1).error(`"${R}" comparisons are not supported for type '${En($.type)}'.`);let V=E.parse(k[2],2,ns);if(!V)return null;if(!pw(R,V.type))return E.concat(2).error(`"${R}" comparisons are not supported for type '${En(V.type)}'.`);if($.type.kind!==V.type.kind&&$.type.kind!=="value"&&V.type.kind!=="value")return E.error(`Cannot compare types '${En($.type)}' and '${En(V.type)}'.`);x&&($.type.kind==="value"&&V.type.kind!=="value"?$=new Ts(V.type,[$]):$.type.kind!=="value"&&V.type.kind==="value"&&(V=new Ts($.type,[V])));let W=null;if(k.length===4){if($.type.kind!=="string"&&V.type.kind!=="string"&&$.type.kind!=="value"&&V.type.kind!=="value")return E.error("Cannot use collator to compare non-string types.");if(W=E.parse(k[3],3,Zm),!W)return null}return new CG($,V,W)}evaluate(k){const E=this.lhs.evaluate(k),R=this.rhs.evaluate(k);if(x&&this.hasUntypedArgument){const $=Xn(E),V=Xn(R);if($.kind!==V.kind||$.kind!=="string"&&$.kind!=="number")throw new gn(`Expected arguments for "${h}" to be (string, string) or (number, number), but found (${$.kind}, ${V.kind}) instead.`)}if(this.collator&&!x&&this.hasUntypedArgument){const $=Xn(E),V=Xn(R);if($.kind!=="string"||V.kind!=="string")return d(k,E,R)}return this.collator?u(k,E,R,this.collator.evaluate(k)):d(k,E,R)}eachChild(k){k(this.lhs),k(this.rhs),this.collator&&k(this.collator)}outputDefined(){return!0}}}const Uv=lc("==",function(h,d,u){return d===u},Kd),WP=lc("!=",function(h,d,u){return d!==u},function(h,d,u,x){return!Kd(0,d,u,x)}),xw=lc("<",function(h,d,u){return d<u},function(h,d,u,x){return x.compare(d,u)<0}),rx=lc(">",function(h,d,u){return d>u},function(h,d,u,x){return x.compare(d,u)>0}),sx=lc("<=",function(h,d,u){return d<=u},function(h,d,u,x){return x.compare(d,u)<=0}),Qo=lc(">=",function(h,d,u){return d>=u},function(h,d,u,x){return x.compare(d,u)>=0});class of{constructor(d,u,x){this.type=Zm,this.locale=x,this.caseSensitive=d,this.diacriticSensitive=u}static parse(d,u){if(d.length!==2)return u.error("Expected one argument.");const x=d[1];if(typeof x!="object"||Array.isArray(x))return u.error("Collator options argument must be an object.");const j=u.parse(x["case-sensitive"]!==void 0&&x["case-sensitive"],1,cs);if(!j)return null;const k=u.parse(x["diacritic-sensitive"]!==void 0&&x["diacritic-sensitive"],1,cs);if(!k)return null;let E=null;return x.locale&&(E=u.parse(x.locale,1,Jr),!E)?null:new of(j,k,E)}evaluate(d){return new xs(this.caseSensitive.evaluate(d),this.diacriticSensitive.evaluate(d),this.locale?this.locale.evaluate(d):null)}eachChild(d){d(this.caseSensitive),d(this.diacriticSensitive),this.locale&&d(this.locale)}outputDefined(){return!1}}class hh{constructor(d,u,x,j,k){this.type=Jr,this.number=d,this.locale=u,this.currency=x,this.minFractionDigits=j,this.maxFractionDigits=k}static parse(d,u){if(d.length!==3)return u.error("Expected two arguments.");const x=u.parse(d[1],1,Kt);if(!x)return null;const j=d[2];if(typeof j!="object"||Array.isArray(j))return u.error("NumberFormat options argument must be an object.");let k=null;if(j.locale&&(k=u.parse(j.locale,1,Jr),!k))return null;let E=null;if(j.currency&&(E=u.parse(j.currency,1,Jr),!E))return null;let R=null;if(j["min-fraction-digits"]&&(R=u.parse(j["min-fraction-digits"],1,Kt),!R))return null;let $=null;return j["max-fraction-digits"]&&($=u.parse(j["max-fraction-digits"],1,Kt),!$)?null:new hh(x,k,E,R,$)}evaluate(d){return new Intl.NumberFormat(this.locale?this.locale.evaluate(d):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(d):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(d):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(d):void 0}).format(this.number.evaluate(d))}eachChild(d){d(this.number),this.locale&&d(this.locale),this.currency&&d(this.currency),this.minFractionDigits&&d(this.minFractionDigits),this.maxFractionDigits&&d(this.maxFractionDigits)}outputDefined(){return!1}}class nx{constructor(d){this.type=Bd,this.sections=d}static parse(d,u){if(d.length<2)return u.error("Expected at least one argument.");const x=d[1];if(!Array.isArray(x)&&typeof x=="object")return u.error("First argument must be an image or text section.");const j=[];let k=!1;for(let E=1;E<=d.length-1;++E){const R=d[E];if(k&&typeof R=="object"&&!Array.isArray(R)){k=!1;let $=null;if(R["font-scale"]&&($=u.parse(R["font-scale"],1,Kt),!$))return null;let V=null;if(R["text-font"]&&(V=u.parse(R["text-font"],1,mi(Jr)),!V))return null;let W=null;if(R["text-color"]&&(W=u.parse(R["text-color"],1,Xo),!W))return null;let ee=null;if(R["vertical-align"]){if(typeof R["vertical-align"]=="string"&&!oh.includes(R["vertical-align"]))return u.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${R["vertical-align"]}' instead.`);if(ee=u.parse(R["vertical-align"],1,Jr),!ee)return null}const ce=j[j.length-1];ce.scale=$,ce.font=V,ce.textColor=W,ce.verticalAlign=ee}else{const $=u.parse(d[E],1,ns);if(!$)return null;const V=$.type.kind;if(V!=="string"&&V!=="value"&&V!=="null"&&V!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");k=!0,j.push({content:$,scale:null,font:null,textColor:null,verticalAlign:null})}}return new nx(j)}evaluate(d){return new Xi(this.sections.map(u=>{const x=u.content.evaluate(d);return Xn(x)===qd?new Cl("",x,null,null,null,u.verticalAlign?u.verticalAlign.evaluate(d):null):new Cl(lh(x),null,u.scale?u.scale.evaluate(d):null,u.font?u.font.evaluate(d).join(","):null,u.textColor?u.textColor.evaluate(d):null,u.verticalAlign?u.verticalAlign.evaluate(d):null)}))}eachChild(d){for(const u of this.sections)d(u.content),u.scale&&d(u.scale),u.font&&d(u.font),u.textColor&&d(u.textColor),u.verticalAlign&&d(u.verticalAlign)}outputDefined(){return!1}}class lf{constructor(d){this.type=qd,this.input=d}static parse(d,u){if(d.length!==2)return u.error("Expected two arguments.");const x=u.parse(d[1],1,Jr);return x?new lf(x):u.error("No image name provided.")}evaluate(d){const u=this.input.evaluate(d),x=Oi.fromString(u);return x&&d.availableImages&&(x.available=d.availableImages.indexOf(u)>-1),x}eachChild(d){d(this.input)}outputDefined(){return!1}}class Wv{constructor(d){this.type=Kt,this.input=d}static parse(d,u){if(d.length!==2)return u.error(`Expected 1 argument, but found ${d.length-1} instead.`);const x=u.parse(d[1],1);return x?x.type.kind!=="array"&&x.type.kind!=="string"&&x.type.kind!=="value"?u.error(`Expected argument of type string or array, but found ${En(x.type)} instead.`):new Wv(x):null}evaluate(d){const u=this.input.evaluate(d);if(typeof u=="string")return[...u].length;if(Array.isArray(u))return u.length;throw new gn(`Expected value to be of type string or array, but found ${En(Xn(u))} instead.`)}eachChild(d){d(this.input)}outputDefined(){return!1}}const kl=8192;function GP(h,d){const u=(180+h[0])/360,x=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h[1]*Math.PI/360)))/360,j=Math.pow(2,d.z);return[Math.round(u*j*kl),Math.round(x*j*kl)]}function Gv(h,d){const u=Math.pow(2,d.z);return[(j=(h[0]/kl+d.x)/u,360*j-180),(x=(h[1]/kl+d.y)/u,360/Math.PI*Math.atan(Math.exp((180-360*x)*Math.PI/180))-90)];var x,j}function sd(h,d){h[0]=Math.min(h[0],d[0]),h[1]=Math.min(h[1],d[1]),h[2]=Math.max(h[2],d[0]),h[3]=Math.max(h[3],d[1])}function cf(h,d){return!(h[0]<=d[0]||h[2]>=d[2]||h[1]<=d[1]||h[3]>=d[3])}function gw(h,d,u){const x=h[0]-d[0],j=h[1]-d[1],k=h[0]-u[0],E=h[1]-u[1];return x*E-k*j==0&&x*k<=0&&j*E<=0}function df(h,d,u,x){return(j=[x[0]-u[0],x[1]-u[1]])[0]*(k=[d[0]-h[0],d[1]-h[1]])[1]-j[1]*k[0]!=0&&!(!vw(h,d,u,x)||!vw(u,x,h,d));var j,k}function KP(h,d,u){for(const x of u)for(let j=0;j<x.length-1;++j)if(df(h,d,x[j],x[j+1]))return!0;return!1}function Hd(h,d,u=!1){let x=!1;for(const R of d)for(let $=0;$<R.length-1;$++){if(gw(h,R[$],R[$+1]))return u;(k=R[$])[1]>(j=h)[1]!=(E=R[$+1])[1]>j[1]&&j[0]<(E[0]-k[0])*(j[1]-k[1])/(E[1]-k[1])+k[0]&&(x=!x)}var j,k,E;return x}function HP(h,d){for(const u of d)if(Hd(h,u))return!0;return!1}function yw(h,d){for(const u of h)if(!Hd(u,d))return!1;for(let u=0;u<h.length-1;++u)if(KP(h[u],h[u+1],d))return!1;return!0}function ZP(h,d){for(const u of d)if(yw(h,u))return!0;return!1}function vw(h,d,u,x){const j=x[0]-u[0],k=x[1]-u[1],E=(h[0]-u[0])*k-j*(h[1]-u[1]),R=(d[0]-u[0])*k-j*(d[1]-u[1]);return E>0&&R<0||E<0&&R>0}function Kv(h,d,u){const x=[];for(let j=0;j<h.length;j++){const k=[];for(let E=0;E<h[j].length;E++){const R=GP(h[j][E],u);sd(d,R),k.push(R)}x.push(k)}return x}function Hv(h,d,u){const x=[];for(let j=0;j<h.length;j++){const k=Kv(h[j],d,u);x.push(k)}return x}function Zv(h,d,u,x){if(h[0]<u[0]||h[0]>u[2]){const j=.5*x;let k=h[0]-u[0]>j?-x:u[0]-h[0]>j?x:0;k===0&&(k=h[0]-u[2]>j?-x:u[2]-h[0]>j?x:0),h[0]+=k}sd(d,h)}function Yv(h,d,u,x){const j=Math.pow(2,x.z)*kl,k=[x.x*kl,x.y*kl],E=[];for(const R of h)for(const $ of R){const V=[$.x+k[0],$.y+k[1]];Zv(V,d,u,j),E.push(V)}return E}function jw(h,d,u,x){const j=Math.pow(2,x.z)*kl,k=[x.x*kl,x.y*kl],E=[];for(const $ of h){const V=[];for(const W of $){const ee=[W.x+k[0],W.y+k[1]];sd(d,ee),V.push(ee)}E.push(V)}if(d[2]-d[0]<=j/2){(R=d)[0]=R[1]=1/0,R[2]=R[3]=-1/0;for(const $ of E)for(const V of $)Zv(V,d,u,j)}var R;return E}class Zd{constructor(d,u){this.type=cs,this.geojson=d,this.geometries=u}static parse(d,u){if(d.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${d.length-1} instead.`);if(Pl(d[1])){const x=d[1];if(x.type==="FeatureCollection"){const j=[];for(const k of x.features){const{type:E,coordinates:R}=k.geometry;E==="Polygon"&&j.push(R),E==="MultiPolygon"&&j.push(...R)}if(j.length)return new Zd(x,{type:"MultiPolygon",coordinates:j})}else if(x.type==="Feature"){const j=x.geometry.type;if(j==="Polygon"||j==="MultiPolygon")return new Zd(x,x.geometry)}else if(x.type==="Polygon"||x.type==="MultiPolygon")return new Zd(x,x)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(d){if(d.geometry()!=null&&d.canonicalID()!=null){if(d.geometryType()==="Point")return function(u,x){const j=[1/0,1/0,-1/0,-1/0],k=[1/0,1/0,-1/0,-1/0],E=u.canonicalID();if(x.type==="Polygon"){const R=Kv(x.coordinates,k,E),$=Yv(u.geometry(),j,k,E);if(!cf(j,k))return!1;for(const V of $)if(!Hd(V,R))return!1}if(x.type==="MultiPolygon"){const R=Hv(x.coordinates,k,E),$=Yv(u.geometry(),j,k,E);if(!cf(j,k))return!1;for(const V of $)if(!HP(V,R))return!1}return!0}(d,this.geometries);if(d.geometryType()==="LineString")return function(u,x){const j=[1/0,1/0,-1/0,-1/0],k=[1/0,1/0,-1/0,-1/0],E=u.canonicalID();if(x.type==="Polygon"){const R=Kv(x.coordinates,k,E),$=jw(u.geometry(),j,k,E);if(!cf(j,k))return!1;for(const V of $)if(!yw(V,R))return!1}if(x.type==="MultiPolygon"){const R=Hv(x.coordinates,k,E),$=jw(u.geometry(),j,k,E);if(!cf(j,k))return!1;for(const V of $)if(!ZP(V,R))return!1}return!0}(d,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let bw=class{constructor(h=[],d=(u,x)=>u<x?-1:u>x?1:0){if(this.data=h,this.length=this.data.length,this.compare=d,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(h){this.data.push(h),this._up(this.length++)}pop(){if(this.length===0)return;const h=this.data[0],d=this.data.pop();return--this.length>0&&(this.data[0]=d,this._down(0)),h}peek(){return this.data[0]}_up(h){const{data:d,compare:u}=this,x=d[h];for(;h>0;){const j=h-1>>1,k=d[j];if(u(x,k)>=0)break;d[h]=k,h=j}d[h]=x}_down(h){const{data:d,compare:u}=this,x=this.length>>1,j=d[h];for(;h<x;){let k=1+(h<<1);const E=k+1;if(E<this.length&&u(d[E],d[k])<0&&(k=E),u(d[k],j)>=0)break;d[h]=d[k],h=k}d[h]=j}};function _w(h,d,u=0,x=h.length-1,j=YP){for(;x>u;){if(x-u>600){const $=x-u+1,V=d-u+1,W=Math.log($),ee=.5*Math.exp(2*W/3),ce=.5*Math.sqrt(W*ee*($-ee)/$)*(V-$/2<0?-1:1);_w(h,d,Math.max(u,Math.floor(d-V*ee/$+ce)),Math.min(x,Math.floor(d+($-V)*ee/$+ce)),j)}const k=h[d];let E=u,R=x;for(nd(h,u,d),j(h[x],k)>0&&nd(h,u,x);E<R;){for(nd(h,E,R),E++,R--;j(h[E],k)<0;)E++;for(;j(h[R],k)>0;)R--}j(h[u],k)===0?nd(h,u,R):(R++,nd(h,R,x)),R<=d&&(u=R+1),d<=R&&(x=R-1)}}function nd(h,d,u){const x=h[d];h[d]=h[u],h[u]=x}function YP(h,d){return h<d?-1:h>d?1:0}function ax(h,d){if(h.length<=1)return[h];const u=[];let x,j;for(const k of h){const E=QP(k);E!==0&&(k.area=Math.abs(E),j===void 0&&(j=E<0),j===E<0?(x&&u.push(x),x=[k]):x.push(k))}if(x&&u.push(x),d>1)for(let k=0;k<u.length;k++)u[k].length<=d||(_w(u[k],d,1,u[k].length-1,XP),u[k]=u[k].slice(0,d));return u}function XP(h,d){return d.area-h.area}function QP(h){let d=0;for(let u,x,j=0,k=h.length,E=k-1;j<k;E=j++)u=h[j],x=h[E],d+=(x.x-u.x)*(u.y+x.y);return d}const ix=1/298.257223563,Xv=ix*(2-ix),ww=Math.PI/180;class Qv{constructor(d){const u=6378.137*ww*1e3,x=Math.cos(d*ww),j=1/(1-Xv*(1-x*x)),k=Math.sqrt(j);this.kx=u*k*x,this.ky=u*k*j*(1-Xv)}distance(d,u){const x=this.wrap(d[0]-u[0])*this.kx,j=(d[1]-u[1])*this.ky;return Math.sqrt(x*x+j*j)}pointOnLine(d,u){let x,j,k,E,R=1/0;for(let $=0;$<d.length-1;$++){let V=d[$][0],W=d[$][1],ee=this.wrap(d[$+1][0]-V)*this.kx,ce=(d[$+1][1]-W)*this.ky,me=0;ee===0&&ce===0||(me=(this.wrap(u[0]-V)*this.kx*ee+(u[1]-W)*this.ky*ce)/(ee*ee+ce*ce),me>1?(V=d[$+1][0],W=d[$+1][1]):me>0&&(V+=ee/this.kx*me,W+=ce/this.ky*me)),ee=this.wrap(u[0]-V)*this.kx,ce=(u[1]-W)*this.ky;const xe=ee*ee+ce*ce;xe<R&&(R=xe,x=V,j=W,k=$,E=me)}return{point:[x,j],index:k,t:Math.max(0,Math.min(1,E))}}wrap(d){for(;d<-180;)d+=360;for(;d>180;)d-=360;return d}}function Jv(h,d){return d[0]-h[0]}function uf(h){return h[1]-h[0]+1}function cc(h,d){return h[1]>=h[0]&&h[1]<d}function ej(h,d){if(h[0]>h[1])return[null,null];const u=uf(h);if(d){if(u===2)return[h,null];const j=Math.floor(u/2);return[[h[0],h[0]+j],[h[0]+j,h[1]]]}if(u===1)return[h,null];const x=Math.floor(u/2)-1;return[[h[0],h[0]+x],[h[0]+x+1,h[1]]]}function tj(h,d){if(!cc(d,h.length))return[1/0,1/0,-1/0,-1/0];const u=[1/0,1/0,-1/0,-1/0];for(let x=d[0];x<=d[1];++x)sd(u,h[x]);return u}function ox(h){const d=[1/0,1/0,-1/0,-1/0];for(const u of h)for(const x of u)sd(d,x);return d}function Nw(h){return h[0]!==-1/0&&h[1]!==-1/0&&h[2]!==1/0&&h[3]!==1/0}function rj(h,d,u){if(!Nw(h)||!Nw(d))return NaN;let x=0,j=0;return h[2]<d[0]&&(x=d[0]-h[2]),h[0]>d[2]&&(x=h[0]-d[2]),h[1]>d[3]&&(j=h[1]-d[3]),h[3]<d[1]&&(j=d[1]-h[3]),u.distance([0,0],[x,j])}function Yd(h,d,u){const x=u.pointOnLine(d,h);return u.distance(h,x.point)}function sj(h,d,u,x,j){const k=Math.min(Yd(h,[u,x],j),Yd(d,[u,x],j)),E=Math.min(Yd(u,[h,d],j),Yd(x,[h,d],j));return Math.min(k,E)}function Vs(h,d,u,x,j){if(!cc(d,h.length)||!cc(x,u.length))return 1/0;let k=1/0;for(let E=d[0];E<d[1];++E){const R=h[E],$=h[E+1];for(let V=x[0];V<x[1];++V){const W=u[V],ee=u[V+1];if(df(R,$,W,ee))return 0;k=Math.min(k,sj(R,$,W,ee,j))}}return k}function JP(h,d,u,x,j){if(!cc(d,h.length)||!cc(x,u.length))return NaN;let k=1/0;for(let E=d[0];E<=d[1];++E)for(let R=x[0];R<=x[1];++R)if(k=Math.min(k,j.distance(h[E],u[R])),k===0)return k;return k}function ek(h,d,u){if(Hd(h,d,!0))return 0;let x=1/0;for(const j of d){const k=j[0],E=j[j.length-1];if(k!==E&&(x=Math.min(x,Yd(h,[E,k],u)),x===0))return x;const R=u.pointOnLine(j,h);if(x=Math.min(x,u.distance(h,R.point)),x===0)return x}return x}function tk(h,d,u,x){if(!cc(d,h.length))return NaN;for(let k=d[0];k<=d[1];++k)if(Hd(h[k],u,!0))return 0;let j=1/0;for(let k=d[0];k<d[1];++k){const E=h[k],R=h[k+1];for(const $ of u)for(let V=0,W=$.length,ee=W-1;V<W;ee=V++){const ce=$[ee],me=$[V];if(df(E,R,ce,me))return 0;j=Math.min(j,sj(E,R,ce,me,x))}}return j}function Sw(h,d){for(const u of h)for(const x of u)if(Hd(x,d,!0))return!0;return!1}function rk(h,d,u,x=1/0){const j=ox(h),k=ox(d);if(x!==1/0&&rj(j,k,u)>=x)return x;if(cf(j,k)){if(Sw(h,d))return 0}else if(Sw(d,h))return 0;let E=1/0;for(const R of h)for(let $=0,V=R.length,W=V-1;$<V;W=$++){const ee=R[W],ce=R[$];for(const me of d)for(let xe=0,Ne=me.length,Te=Ne-1;xe<Ne;Te=xe++){const Le=me[Te],at=me[xe];if(df(ee,ce,Le,at))return 0;E=Math.min(E,sj(ee,ce,Le,at,u))}}return E}function Cw(h,d,u,x,j,k){if(!k)return;const E=rj(tj(x,k),j,u);E<d&&h.push([E,k,[0,0]])}function lx(h,d,u,x,j,k,E){if(!k||!E)return;const R=rj(tj(x,k),tj(j,E),u);R<d&&h.push([R,k,E])}function cx(h,d,u,x,j=1/0){let k=Math.min(x.distance(h[0],u[0][0]),j);if(k===0)return k;const E=new bw([[0,[0,h.length-1],[0,0]]],Jv),R=ox(u);for(;E.length>0;){const $=E.pop();if($[0]>=k)continue;const V=$[1],W=d?50:100;if(uf(V)<=W){if(!cc(V,h.length))return NaN;if(d){const ee=tk(h,V,u,x);if(isNaN(ee)||ee===0)return ee;k=Math.min(k,ee)}else for(let ee=V[0];ee<=V[1];++ee){const ce=ek(h[ee],u,x);if(k=Math.min(k,ce),k===0)return 0}}else{const ee=ej(V,d);Cw(E,k,x,h,R,ee[0]),Cw(E,k,x,h,R,ee[1])}}return k}function dx(h,d,u,x,j,k=1/0){let E=Math.min(k,j.distance(h[0],u[0]));if(E===0)return E;const R=new bw([[0,[0,h.length-1],[0,u.length-1]]],Jv);for(;R.length>0;){const $=R.pop();if($[0]>=E)continue;const V=$[1],W=$[2],ee=d?50:100,ce=x?50:100;if(uf(V)<=ee&&uf(W)<=ce){if(!cc(V,h.length)&&cc(W,u.length))return NaN;let me;if(d&&x)me=Vs(h,V,u,W,j),E=Math.min(E,me);else if(d&&!x){const xe=h.slice(V[0],V[1]+1);for(let Ne=W[0];Ne<=W[1];++Ne)if(me=Yd(u[Ne],xe,j),E=Math.min(E,me),E===0)return E}else if(!d&&x){const xe=u.slice(W[0],W[1]+1);for(let Ne=V[0];Ne<=V[1];++Ne)if(me=Yd(h[Ne],xe,j),E=Math.min(E,me),E===0)return E}else me=JP(h,V,u,W,j),E=Math.min(E,me)}else{const me=ej(V,d),xe=ej(W,x);lx(R,E,j,h,u,me[0],xe[0]),lx(R,E,j,h,u,me[0],xe[1]),lx(R,E,j,h,u,me[1],xe[0]),lx(R,E,j,h,u,me[1],xe[1])}}return E}function nj(h){return h.type==="MultiPolygon"?h.coordinates.map(d=>({type:"Polygon",coordinates:d})):h.type==="MultiLineString"?h.coordinates.map(d=>({type:"LineString",coordinates:d})):h.type==="MultiPoint"?h.coordinates.map(d=>({type:"Point",coordinates:d})):[h]}class Xd{constructor(d,u){this.type=Kt,this.geojson=d,this.geometries=u}static parse(d,u){if(d.length!==2)return u.error(`'distance' expression requires exactly one argument, but found ${d.length-1} instead.`);if(Pl(d[1])){const x=d[1];if(x.type==="FeatureCollection")return new Xd(x,x.features.map(j=>nj(j.geometry)).flat());if(x.type==="Feature")return new Xd(x,nj(x.geometry));if("type"in x&&"coordinates"in x)return new Xd(x,nj(x))}return u.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(d){if(d.geometry()!=null&&d.canonicalID()!=null){if(d.geometryType()==="Point")return function(u,x){const j=u.geometry(),k=j.flat().map($=>Gv([$.x,$.y],u.canonical));if(j.length===0)return NaN;const E=new Qv(k[0][1]);let R=1/0;for(const $ of x){switch($.type){case"Point":R=Math.min(R,dx(k,!1,[$.coordinates],!1,E,R));break;case"LineString":R=Math.min(R,dx(k,!1,$.coordinates,!0,E,R));break;case"Polygon":R=Math.min(R,cx(k,!1,$.coordinates,E,R))}if(R===0)return R}return R}(d,this.geometries);if(d.geometryType()==="LineString")return function(u,x){const j=u.geometry(),k=j.flat().map($=>Gv([$.x,$.y],u.canonical));if(j.length===0)return NaN;const E=new Qv(k[0][1]);let R=1/0;for(const $ of x){switch($.type){case"Point":R=Math.min(R,dx(k,!0,[$.coordinates],!1,E,R));break;case"LineString":R=Math.min(R,dx(k,!0,$.coordinates,!0,E,R));break;case"Polygon":R=Math.min(R,cx(k,!0,$.coordinates,E,R))}if(R===0)return R}return R}(d,this.geometries);if(d.geometryType()==="Polygon")return function(u,x){const j=u.geometry();if(j.length===0||j[0].length===0)return NaN;const k=ax(j,0).map($=>$.map(V=>V.map(W=>Gv([W.x,W.y],u.canonical)))),E=new Qv(k[0][0][0][1]);let R=1/0;for(const $ of x)for(const V of k){switch($.type){case"Point":R=Math.min(R,cx([$.coordinates],!1,V,E,R));break;case"LineString":R=Math.min(R,cx($.coordinates,!0,V,E,R));break;case"Polygon":R=Math.min(R,rk(V,$.coordinates,E,R))}if(R===0)return R}return R}(d,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class hf{constructor(d){this.type=ns,this.key=d}static parse(d,u){if(d.length!==2)return u.error(`Expected 1 argument, but found ${d.length-1} instead.`);const x=d[1];return x==null?u.error("Global state property must be defined."):typeof x!="string"?u.error(`Global state property must be string, but found ${typeof d[1]} instead.`):new hf(x)}evaluate(d){var u;const x=(u=d.globals)===null||u===void 0?void 0:u.globalState;return x&&Object.keys(x).length!==0?Qm(x,this.key):null}eachChild(){}outputDefined(){return!1}}const mh={"==":Uv,"!=":WP,">":rx,"<":xw,">=":Qo,"<=":sx,array:Ts,at:ef,boolean:Ts,case:Qp,coalesce:af,collator:of,format:nx,image:lf,in:dh,"index-of":tf,interpolate:Gs,"interpolate-hcl":Gs,"interpolate-lab":Gs,length:Wv,let:ch,literal:td,match:rf,number:Ts,"number-format":hh,object:Ts,slice:Jp,step:uh,string:Ts,"to-boolean":ds,"to-color":ds,"to-number":ds,"to-string":ds,var:To,within:Zd,distance:Xd,"global-state":hf};class Mo{constructor(d,u,x,j){this.name=d,this.type=u,this._evaluate=x,this.args=j}evaluate(d){return this._evaluate(d,this.args)}eachChild(d){this.args.forEach(d)}outputDefined(){return!1}static parse(d,u){const x=d[0],j=Mo.definitions[x];if(!j)return u.error(`Unknown expression "${x}". If you wanted a literal array, use ["literal", [...]].`,0);const k=Array.isArray(j)?j[0]:j.type,E=Array.isArray(j)?[[j[1],j[2]]]:j.overloads,R=E.filter(([V])=>!Array.isArray(V)||V.length===d.length-1);let $=null;for(const[V,W]of R){$=new Cs(u.registry,ux,u.path,null,u.scope);const ee=[];let ce=!1;for(let me=1;me<d.length;me++){const xe=d[me],Ne=Array.isArray(V)?V[me-1]:V.type,Te=$.parse(xe,1+ee.length,Ne);if(!Te){ce=!0;break}ee.push(Te)}if(!ce)if(Array.isArray(V)&&V.length!==ee.length)$.error(`Expected ${V.length} arguments, but found ${ee.length} instead.`);else{for(let me=0;me<ee.length;me++){const xe=Array.isArray(V)?V[me]:V.type,Ne=ee[me];$.concat(me+1).checkSubtype(xe,Ne.type)}if($.errors.length===0)return new Mo(x,k,W,ee)}}if(R.length===1)u.errors.push(...$.errors);else{const V=(R.length?R:E).map(([ee])=>{return ce=ee,Array.isArray(ce)?`(${ce.map(En).join(", ")})`:`(${En(ce.type)}...)`;var ce}).join(" | "),W=[];for(let ee=1;ee<d.length;ee++){const ce=u.parse(d[ee],1+W.length);if(!ce)return null;W.push(En(ce.type))}u.error(`Expected arguments of type ${V}, but found (${W.join(", ")}) instead.`)}return null}static register(d,u){Mo.definitions=u;for(const x in u)d[x]=Mo}}function Pw(h,[d,u,x,j]){d=d.evaluate(h),u=u.evaluate(h),x=x.evaluate(h);const k=j?j.evaluate(h):1,E=Jm(d,u,x,k);if(E)throw new gn(E);return new Kr(d/255,u/255,x/255,k,!1)}function kw(h,d){return h in d}function aj(h,d){const u=d[h];return u===void 0?null:u}function Qd(h){return{type:h}}function ux(h){if(h instanceof To)return ux(h.boundExpression);if(h instanceof Mo&&h.name==="error"||h instanceof of||h instanceof Zd||h instanceof Xd||h instanceof hf)return!1;const d=h instanceof ds||h instanceof Ts;let u=!0;return h.eachChild(x=>{u=d?u&&ux(x):u&&x instanceof td}),!!u&&hx(h)&&mx(h,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function hx(h){if(h instanceof Mo&&(h.name==="get"&&h.args.length===1||h.name==="feature-state"||h.name==="has"&&h.args.length===1||h.name==="properties"||h.name==="geometry-type"||h.name==="id"||/^filter-/.test(h.name))||h instanceof Zd||h instanceof Xd)return!1;let d=!0;return h.eachChild(u=>{d&&!hx(u)&&(d=!1)}),d}function mf(h){if(h instanceof Mo&&h.name==="feature-state")return!1;let d=!0;return h.eachChild(u=>{d&&!mf(u)&&(d=!1)}),d}function mx(h,d){if(h instanceof Mo&&d.indexOf(h.name)>=0)return!1;let u=!0;return h.eachChild(x=>{u&&!mx(x,d)&&(u=!1)}),u}function Aw(h){return{result:"success",value:h}}function fh(h){return{result:"error",value:h}}function ph(h){return h["property-type"]==="data-driven"||h["property-type"]==="cross-faded-data-driven"}function Tw(h){return!!h.expression&&h.expression.parameters.indexOf("zoom")>-1}function ij(h){return!!h.expression&&h.expression.interpolated}function ps(h){return h instanceof Number?"number":h instanceof String?"string":h instanceof Boolean?"boolean":Array.isArray(h)?"array":h===null?"null":typeof h}function fx(h){return typeof h=="object"&&h!==null&&!Array.isArray(h)&&Xn(h)===Jc}function sk(h){return h}function Ew(h,d){const u=h.stops&&typeof h.stops[0][0]=="object",x=u||!(u||h.property!==void 0),j=h.type||(ij(d)?"exponential":"interval"),k=function(W){switch(W.type){case"color":return Kr.parse;case"padding":return fi.parse;case"numberArray":return Qa.parse;case"colorArray":return na.parse;default:return null}}(d);if(k&&((h=Yn({},h)).stops&&(h.stops=h.stops.map(W=>[W[0],k(W[1])])),h.default=k(h.default?h.default:d.default)),h.colorSpace&&(E=h.colorSpace)!=="rgb"&&E!=="hcl"&&E!=="lab")throw new Error(`Unknown color space: "${h.colorSpace}"`);var E;const R=function(W){switch(W){case"exponential":return Mw;case"interval":return ak;case"categorical":return nk;case"identity":return Ow;default:throw new Error(`Unknown function type "${W}"`)}}(j);let $,V;if(j==="categorical"){$=Object.create(null);for(const W of h.stops)$[W[0]]=W[1];V=typeof h.stops[0][0]}if(u){const W={},ee=[];for(let xe=0;xe<h.stops.length;xe++){const Ne=h.stops[xe],Te=Ne[0].zoom;W[Te]===void 0&&(W[Te]={zoom:Te,type:h.type,property:h.property,default:h.default,stops:[]},ee.push(Te)),W[Te].stops.push([Ne[0].value,Ne[1]])}const ce=[];for(const xe of ee)ce.push([W[xe].zoom,Ew(W[xe],d)]);const me={name:"linear"};return{kind:"composite",interpolationType:me,interpolationFactor:Gs.interpolationFactor.bind(void 0,me),zoomStops:ce.map(xe=>xe[0]),evaluate:({zoom:xe},Ne)=>Mw({stops:ce,base:h.base},d,xe).evaluate(xe,Ne)}}if(x){const W=j==="exponential"?{name:"exponential",base:h.base!==void 0?h.base:1}:null;return{kind:"camera",interpolationType:W,interpolationFactor:Gs.interpolationFactor.bind(void 0,W),zoomStops:h.stops.map(ee=>ee[0]),evaluate:({zoom:ee})=>R(h,d,ee,$,V)}}return{kind:"source",evaluate(W,ee){const ce=ee&&ee.properties?ee.properties[h.property]:void 0;return ce===void 0?Jd(h.default,d.default):R(h,d,ce,$,V)}}}function Jd(h,d,u){return h!==void 0?h:d!==void 0?d:u!==void 0?u:void 0}function nk(h,d,u,x,j){return Jd(typeof u===j?x[u]:void 0,h.default,d.default)}function ak(h,d,u){if(ps(u)!=="number")return Jd(h.default,d.default);const x=h.stops.length;if(x===1||u<=h.stops[0][0])return h.stops[0][1];if(u>=h.stops[x-1][0])return h.stops[x-1][1];const j=sf(h.stops.map(k=>k[0]),u);return h.stops[j][1]}function Mw(h,d,u){const x=h.base!==void 0?h.base:1;if(ps(u)!=="number")return Jd(h.default,d.default);const j=h.stops.length;if(j===1||u<=h.stops[0][0])return h.stops[0][1];if(u>=h.stops[j-1][0])return h.stops[j-1][1];const k=sf(h.stops.map(W=>W[0]),u),E=function(W,ee,ce,me){const xe=me-ce,Ne=W-ce;return xe===0?0:ee===1?Ne/xe:(Math.pow(ee,Ne)-1)/(Math.pow(ee,xe)-1)}(u,x,h.stops[k][0],h.stops[k+1][0]),R=h.stops[k][1],$=h.stops[k+1][1],V=Eo[d.type]||sk;return typeof R.evaluate=="function"?{evaluate(...W){const ee=R.evaluate.apply(void 0,W),ce=$.evaluate.apply(void 0,W);if(ee!==void 0&&ce!==void 0)return V(ee,ce,E,h.colorSpace)}}:V(R,$,E,h.colorSpace)}function Ow(h,d,u){switch(d.type){case"color":u=Kr.parse(u);break;case"formatted":u=Xi.fromString(u.toString());break;case"resolvedImage":u=Oi.fromString(u.toString());break;case"padding":u=fi.parse(u);break;case"colorArray":u=na.parse(u);break;case"numberArray":u=Qa.parse(u);break;default:ps(u)===d.type||d.type==="enum"&&d.values[u]||(u=void 0)}return Jd(u,h.default,d.default)}Mo.register(mh,{error:[{kind:"error"},[Jr],(h,[d])=>{throw new gn(d.evaluate(h))}],typeof:[Jr,[ns],(h,[d])=>En(Xn(d.evaluate(h)))],"to-rgba":[mi(Kt,4),[Xo],(h,[d])=>{const[u,x,j,k]=d.evaluate(h).rgb;return[255*u,255*x,255*j,k]}],rgb:[Xo,[Kt,Kt,Kt],Pw],rgba:[Xo,[Kt,Kt,Kt,Kt],Pw],has:{type:cs,overloads:[[[Jr],(h,[d])=>kw(d.evaluate(h),h.properties())],[[Jr,Jc],(h,[d,u])=>kw(d.evaluate(h),u.evaluate(h))]]},get:{type:ns,overloads:[[[Jr],(h,[d])=>aj(d.evaluate(h),h.properties())],[[Jr,Jc],(h,[d,u])=>aj(d.evaluate(h),u.evaluate(h))]]},"feature-state":[ns,[Jr],(h,[d])=>aj(d.evaluate(h),h.featureState||{})],properties:[Jc,[],h=>h.properties()],"geometry-type":[Jr,[],h=>h.geometryType()],id:[ns,[],h=>h.id()],zoom:[Kt,[],h=>h.globals.zoom],"heatmap-density":[Kt,[],h=>h.globals.heatmapDensity||0],elevation:[Kt,[],h=>h.globals.elevation||0],"line-progress":[Kt,[],h=>h.globals.lineProgress||0],accumulated:[ns,[],h=>h.globals.accumulated===void 0?null:h.globals.accumulated],"+":[Kt,Qd(Kt),(h,d)=>{let u=0;for(const x of d)u+=x.evaluate(h);return u}],"*":[Kt,Qd(Kt),(h,d)=>{let u=1;for(const x of d)u*=x.evaluate(h);return u}],"-":{type:Kt,overloads:[[[Kt,Kt],(h,[d,u])=>d.evaluate(h)-u.evaluate(h)],[[Kt],(h,[d])=>-d.evaluate(h)]]},"/":[Kt,[Kt,Kt],(h,[d,u])=>d.evaluate(h)/u.evaluate(h)],"%":[Kt,[Kt,Kt],(h,[d,u])=>d.evaluate(h)%u.evaluate(h)],ln2:[Kt,[],()=>Math.LN2],pi:[Kt,[],()=>Math.PI],e:[Kt,[],()=>Math.E],"^":[Kt,[Kt,Kt],(h,[d,u])=>Math.pow(d.evaluate(h),u.evaluate(h))],sqrt:[Kt,[Kt],(h,[d])=>Math.sqrt(d.evaluate(h))],log10:[Kt,[Kt],(h,[d])=>Math.log(d.evaluate(h))/Math.LN10],ln:[Kt,[Kt],(h,[d])=>Math.log(d.evaluate(h))],log2:[Kt,[Kt],(h,[d])=>Math.log(d.evaluate(h))/Math.LN2],sin:[Kt,[Kt],(h,[d])=>Math.sin(d.evaluate(h))],cos:[Kt,[Kt],(h,[d])=>Math.cos(d.evaluate(h))],tan:[Kt,[Kt],(h,[d])=>Math.tan(d.evaluate(h))],asin:[Kt,[Kt],(h,[d])=>Math.asin(d.evaluate(h))],acos:[Kt,[Kt],(h,[d])=>Math.acos(d.evaluate(h))],atan:[Kt,[Kt],(h,[d])=>Math.atan(d.evaluate(h))],min:[Kt,Qd(Kt),(h,d)=>Math.min(...d.map(u=>u.evaluate(h)))],max:[Kt,Qd(Kt),(h,d)=>Math.max(...d.map(u=>u.evaluate(h)))],abs:[Kt,[Kt],(h,[d])=>Math.abs(d.evaluate(h))],round:[Kt,[Kt],(h,[d])=>{const u=d.evaluate(h);return u<0?-Math.round(-u):Math.round(u)}],floor:[Kt,[Kt],(h,[d])=>Math.floor(d.evaluate(h))],ceil:[Kt,[Kt],(h,[d])=>Math.ceil(d.evaluate(h))],"filter-==":[cs,[Jr,ns],(h,[d,u])=>h.properties()[d.value]===u.value],"filter-id-==":[cs,[ns],(h,[d])=>h.id()===d.value],"filter-type-==":[cs,[Jr],(h,[d])=>h.geometryType()===d.value],"filter-<":[cs,[Jr,ns],(h,[d,u])=>{const x=h.properties()[d.value],j=u.value;return typeof x==typeof j&&x<j}],"filter-id-<":[cs,[ns],(h,[d])=>{const u=h.id(),x=d.value;return typeof u==typeof x&&u<x}],"filter->":[cs,[Jr,ns],(h,[d,u])=>{const x=h.properties()[d.value],j=u.value;return typeof x==typeof j&&x>j}],"filter-id->":[cs,[ns],(h,[d])=>{const u=h.id(),x=d.value;return typeof u==typeof x&&u>x}],"filter-<=":[cs,[Jr,ns],(h,[d,u])=>{const x=h.properties()[d.value],j=u.value;return typeof x==typeof j&&x<=j}],"filter-id-<=":[cs,[ns],(h,[d])=>{const u=h.id(),x=d.value;return typeof u==typeof x&&u<=x}],"filter->=":[cs,[Jr,ns],(h,[d,u])=>{const x=h.properties()[d.value],j=u.value;return typeof x==typeof j&&x>=j}],"filter-id->=":[cs,[ns],(h,[d])=>{const u=h.id(),x=d.value;return typeof u==typeof x&&u>=x}],"filter-has":[cs,[ns],(h,[d])=>d.value in h.properties()],"filter-has-id":[cs,[],h=>h.id()!==null&&h.id()!==void 0],"filter-type-in":[cs,[mi(Jr)],(h,[d])=>d.value.indexOf(h.geometryType())>=0],"filter-id-in":[cs,[mi(ns)],(h,[d])=>d.value.indexOf(h.id())>=0],"filter-in-small":[cs,[Jr,mi(ns)],(h,[d,u])=>u.value.indexOf(h.properties()[d.value])>=0],"filter-in-large":[cs,[Jr,mi(ns)],(h,[d,u])=>function(x,j,k,E){for(;k<=E;){const R=k+E>>1;if(j[R]===x)return!0;j[R]>x?E=R-1:k=R+1}return!1}(h.properties()[d.value],u.value,0,u.value.length-1)],all:{type:cs,overloads:[[[cs,cs],(h,[d,u])=>d.evaluate(h)&&u.evaluate(h)],[Qd(cs),(h,d)=>{for(const u of d)if(!u.evaluate(h))return!1;return!0}]]},any:{type:cs,overloads:[[[cs,cs],(h,[d,u])=>d.evaluate(h)||u.evaluate(h)],[Qd(cs),(h,d)=>{for(const u of d)if(u.evaluate(h))return!0;return!1}]]},"!":[cs,[cs],(h,[d])=>!d.evaluate(h)],"is-supported-script":[cs,[Jr],(h,[d])=>{const u=h.globals&&h.globals.isSupportedScript;return!u||u(d.evaluate(h))}],upcase:[Jr,[Jr],(h,[d])=>d.evaluate(h).toUpperCase()],downcase:[Jr,[Jr],(h,[d])=>d.evaluate(h).toLowerCase()],concat:[Jr,Qd(ns),(h,d)=>d.map(u=>lh(u.evaluate(h))).join("")],"resolved-locale":[Jr,[Zm],(h,[d])=>d.evaluate(h).resolvedLocale()]});class oj{constructor(d,u,x){this.expression=d,this._warningHistory={},this._evaluator=new Xp,this._defaultValue=u?function(j){if(j.type==="color"&&fx(j.default))return new Kr(0,0,0,0);switch(j.type){case"color":return Kr.parse(j.default)||null;case"padding":return fi.parse(j.default)||null;case"numberArray":return Qa.parse(j.default)||null;case"colorArray":return na.parse(j.default)||null;case"variableAnchorOffsetCollection":return pi.parse(j.default)||null;case"projectionDefinition":return fo.parse(j.default)||null;default:return j.default===void 0?null:j.default}}(u):null,this._enumValues=u&&u.type==="enum"?u.values:null,this._globalState=x}evaluateWithoutErrorHandling(d,u,x,j,k,E){return this._globalState&&(d=tu(d,this._globalState)),this._evaluator.globals=d,this._evaluator.feature=u,this._evaluator.featureState=x,this._evaluator.canonical=j,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=E,this.expression.evaluate(this._evaluator)}evaluate(d,u,x,j,k,E){this._globalState&&(d=tu(d,this._globalState)),this._evaluator.globals=d,this._evaluator.feature=u||null,this._evaluator.featureState=x||null,this._evaluator.canonical=j,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=E||null;try{const R=this.expression.evaluate(this._evaluator);if(R==null||typeof R=="number"&&R!=R)return this._defaultValue;if(this._enumValues&&!(R in this._enumValues))throw new gn(`Expected value to be one of ${Object.keys(this._enumValues).map($=>JSON.stringify($)).join(", ")}, but found ${JSON.stringify(R)} instead.`);return R}catch(R){return this._warningHistory[R.message]||(this._warningHistory[R.message]=!0,typeof console<"u"&&console.warn(R.message)),this._defaultValue}}}function px(h){return Array.isArray(h)&&h.length>0&&typeof h[0]=="string"&&h[0]in mh}function eu(h,d,u){const x=new Cs(mh,ux,[],d?function(k){const E={color:Xo,string:Jr,number:Kt,enum:Jr,boolean:cs,formatted:Bd,padding:Sl,numberArray:Ym,colorArray:ed,projectionDefinition:Hm,resolvedImage:qd,variableAnchorOffsetCollection:Kp};return k.type==="array"?mi(E[k.value]||ns,k.length):E[k.type]}(d):void 0),j=x.parse(h,void 0,void 0,void 0,d&&d.type==="string"?{typeAnnotation:"coerce"}:void 0);return j?Aw(new oj(j,d,u)):fh(x.errors)}class ff{constructor(d,u,x){this.kind=d,this._styleExpression=u,this.isStateDependent=d!=="constant"&&!mf(u.expression),this.globalStateRefs=yx(u.expression),this._globalState=x}evaluateWithoutErrorHandling(d,u,x,j,k,E){return this._globalState&&(d=tu(d,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(d,u,x,j,k,E)}evaluate(d,u,x,j,k,E){return this._globalState&&(d=tu(d,this._globalState)),this._styleExpression.evaluate(d,u,x,j,k,E)}}class lj{constructor(d,u,x,j,k){this.kind=d,this.zoomStops=x,this._styleExpression=u,this.isStateDependent=d!=="camera"&&!mf(u.expression),this.globalStateRefs=yx(u.expression),this.interpolationType=j,this._globalState=k}evaluateWithoutErrorHandling(d,u,x,j,k,E){return this._globalState&&(d=tu(d,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(d,u,x,j,k,E)}evaluate(d,u,x,j,k,E){return this._globalState&&(d=tu(d,this._globalState)),this._styleExpression.evaluate(d,u,x,j,k,E)}interpolationFactor(d,u,x){return this.interpolationType?Gs.interpolationFactor(this.interpolationType,d,u,x):0}}function Iw(h,d,u){const x=eu(h,d,u);if(x.result==="error")return x;const j=x.value.expression,k=hx(j);if(!k&&!ph(d))return fh([new Mi("","data expressions not supported")]);const E=mx(j,["zoom"]);if(!E&&!Tw(d))return fh([new Mi("","zoom expressions not supported")]);const R=gx(j);return R||E?R instanceof Mi?fh([R]):R instanceof Gs&&!ij(d)?fh([new Mi("",'"interpolate" expressions cannot be used with this property')]):Aw(R?new lj(k?"camera":"composite",x.value,R.labels,R instanceof Gs?R.interpolation:void 0,u):new ff(k?"constant":"source",x.value,u)):fh([new Mi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class xx{constructor(d,u){this._parameters=d,this._specification=u,Yn(this,Ew(this._parameters,this._specification))}static deserialize(d){return new xx(d._parameters,d._specification)}static serialize(d){return{_parameters:d._parameters,_specification:d._specification}}}function gx(h){let d=null;if(h instanceof ch)d=gx(h.result);else if(h instanceof af){for(const u of h.args)if(d=gx(u),d)break}else(h instanceof uh||h instanceof Gs)&&h.input instanceof Mo&&h.input.name==="zoom"&&(d=h);return d instanceof Mi||h.eachChild(u=>{const x=gx(u);x instanceof Mi?d=x:!d&&x?d=new Mi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):d&&x&&d!==x&&(d=new Mi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),d}function yx(h,d=new Set){return h instanceof hf&&d.add(h.key),h.eachChild(u=>{yx(u,d)}),d}function tu(h,d){const{zoom:u,heatmapDensity:x,elevation:j,lineProgress:k,isSupportedScript:E,accumulated:R}=h??{};return{zoom:u,heatmapDensity:x,elevation:j,lineProgress:k,isSupportedScript:E,accumulated:R,globalState:d}}function vx(h){if(h===!0||h===!1)return!0;if(!Array.isArray(h)||h.length===0)return!1;switch(h[0]){case"has":return h.length>=2&&h[1]!=="$id"&&h[1]!=="$type";case"in":return h.length>=3&&(typeof h[1]!="string"||Array.isArray(h[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return h.length!==3||Array.isArray(h[1])||Array.isArray(h[2]);case"any":case"all":for(const d of h.slice(1))if(!vx(d)&&typeof d!="boolean")return!1;return!0;default:return!0}}const ik={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function pf(h,d){if(h==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};vx(h)||(h=xf(h));const u=eu(h,ik,d);if(u.result==="error")throw new Error(u.value.map(x=>`${x.key}: ${x.message}`).join(", "));return{filter:(x,j,k)=>u.value.evaluate(x,j,{},k),needGeometry:cj(h),getGlobalStateRefs:()=>yx(u.value.expression)}}function Dw(h,d){return h<d?-1:h>d?1:0}function cj(h){if(!Array.isArray(h))return!1;if(h[0]==="within"||h[0]==="distance")return!0;for(let d=1;d<h.length;d++)if(cj(h[d]))return!0;return!1}function xf(h){if(!h)return!0;const d=h[0];return h.length<=1?d!=="any":d==="=="?dj(h[1],h[2],"=="):d==="!="?jx(dj(h[1],h[2],"==")):d==="<"||d===">"||d==="<="||d===">="?dj(h[1],h[2],d):d==="any"?(u=h.slice(1),["any"].concat(u.map(xf))):d==="all"?["all"].concat(h.slice(1).map(xf)):d==="none"?["all"].concat(h.slice(1).map(xf).map(jx)):d==="in"?Rw(h[1],h.slice(2)):d==="!in"?jx(Rw(h[1],h.slice(2))):d==="has"?Lw(h[1]):d!=="!has"||jx(Lw(h[1]));var u}function dj(h,d,u){switch(h){case"$type":return[`filter-type-${u}`,d];case"$id":return[`filter-id-${u}`,d];default:return[`filter-${u}`,h,d]}}function Rw(h,d){if(d.length===0)return!1;switch(h){case"$type":return["filter-type-in",["literal",d]];case"$id":return["filter-id-in",["literal",d]];default:return d.length>200&&!d.some(u=>typeof u!=typeof d[0])?["filter-in-large",h,["literal",d.sort(Dw)]]:["filter-in-small",h,["literal",d]]}}function Lw(h){switch(h){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",h]}}function jx(h){return["!",h]}function bx(h){const d=typeof h;if(d==="number"||d==="boolean"||d==="string"||h==null)return JSON.stringify(h);if(Array.isArray(h)){let j="[";for(const k of h)j+=`${bx(k)},`;return`${j}]`}const u=Object.keys(h).sort();let x="{";for(let j=0;j<u.length;j++)x+=`${JSON.stringify(u[j])}:${bx(h[u[j]])},`;return`${x}}`}function Fw(h){let d="";for(const u of is)d+=`/${bx(h[u])}`;return d}function _x(h){const d=h.value;return d?[new Lt(h.key,d,"constants have been deprecated as of v8")]:[]}function Mn(h){return h instanceof Number||h instanceof String||h instanceof Boolean?h.valueOf():h}function dc(h){if(Array.isArray(h))return h.map(dc);if(h instanceof Object&&!(h instanceof Number||h instanceof String||h instanceof Boolean)){const d={};for(const u in h)d[u]=dc(h[u]);return d}return Mn(h)}function Qi(h){const d=h.key,u=h.value,x=h.valueSpec||{},j=h.objectElementValidators||{},k=h.style,E=h.styleSpec,R=h.validateSpec;let $=[];const V=ps(u);if(V!=="object")return[new Lt(d,u,`object expected, ${V} found`)];for(const W in u){const ee=W.split(".")[0],ce=Qm(x,ee)||x["*"];let me;if(Qm(j,ee))me=j[ee];else if(Qm(x,ee))me=R;else if(j["*"])me=j["*"];else{if(!x["*"]){$.push(new Lt(d,u[W],`unknown property "${W}"`));continue}me=R}$=$.concat(me({key:(d&&`${d}.`)+W,value:u[W],valueSpec:ce,style:k,styleSpec:E,object:u,objectKey:W,validateSpec:R},u))}for(const W in x)j[W]||x[W].required&&x[W].default===void 0&&u[W]===void 0&&$.push(new Lt(d,u,`missing required property "${W}"`));return $}function xh(h){const d=h.value,u=h.valueSpec,x=h.style,j=h.styleSpec,k=h.key,E=h.arrayElementValidator||h.validateSpec;if(ps(d)!=="array")return[new Lt(k,d,`array expected, ${ps(d)} found`)];if(u.length&&d.length!==u.length)return[new Lt(k,d,`array length ${u.length} expected, length ${d.length} found`)];if(u["min-length"]&&d.length<u["min-length"])return[new Lt(k,d,`array length at least ${u["min-length"]} expected, length ${d.length} found`)];let R={type:u.value,values:u.values};j.$version<7&&(R.function=u.function),ps(u.value)==="object"&&(R=u.value);let $=[];for(let V=0;V<d.length;V++)$=$.concat(E({array:d,arrayIndex:V,value:d[V],valueSpec:R,validateSpec:h.validateSpec,style:x,styleSpec:j,key:`${k}[${V}]`}));return $}function wx(h){const d=h.key,u=h.value,x=h.valueSpec;let j=ps(u);return j==="number"&&u!=u&&(j="NaN"),j!=="number"?[new Lt(d,u,`number expected, ${j} found`)]:"minimum"in x&&u<x.minimum?[new Lt(d,u,`${u} is less than the minimum value ${x.minimum}`)]:"maximum"in x&&u>x.maximum?[new Lt(d,u,`${u} is greater than the maximum value ${x.maximum}`)]:[]}function $w(h){const d=h.valueSpec,u=Mn(h.value.type);let x,j,k,E={};const R=u!=="categorical"&&h.value.property===void 0,$=!R,V=ps(h.value.stops)==="array"&&ps(h.value.stops[0])==="array"&&ps(h.value.stops[0][0])==="object",W=Qi({key:h.key,value:h.value,valueSpec:h.styleSpec.function,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{stops:function(me){if(u==="identity")return[new Lt(me.key,me.value,'identity function may not have a "stops" property')];let xe=[];const Ne=me.value;return xe=xe.concat(xh({key:me.key,value:Ne,valueSpec:me.valueSpec,validateSpec:me.validateSpec,style:me.style,styleSpec:me.styleSpec,arrayElementValidator:ee})),ps(Ne)==="array"&&Ne.length===0&&xe.push(new Lt(me.key,Ne,"array must have at least one stop")),xe},default:function(me){return me.validateSpec({key:me.key,value:me.value,valueSpec:d,validateSpec:me.validateSpec,style:me.style,styleSpec:me.styleSpec})}}});return u==="identity"&&R&&W.push(new Lt(h.key,h.value,'missing required property "property"')),u==="identity"||h.value.stops||W.push(new Lt(h.key,h.value,'missing required property "stops"')),u==="exponential"&&h.valueSpec.expression&&!ij(h.valueSpec)&&W.push(new Lt(h.key,h.value,"exponential functions not supported")),h.styleSpec.$version>=8&&($&&!ph(h.valueSpec)?W.push(new Lt(h.key,h.value,"property functions not supported")):R&&!Tw(h.valueSpec)&&W.push(new Lt(h.key,h.value,"zoom functions not supported"))),u!=="categorical"&&!V||h.value.property!==void 0||W.push(new Lt(h.key,h.value,'"property" property is required')),W;function ee(me){let xe=[];const Ne=me.value,Te=me.key;if(ps(Ne)!=="array")return[new Lt(Te,Ne,`array expected, ${ps(Ne)} found`)];if(Ne.length!==2)return[new Lt(Te,Ne,`array length 2 expected, length ${Ne.length} found`)];if(V){if(ps(Ne[0])!=="object")return[new Lt(Te,Ne,`object expected, ${ps(Ne[0])} found`)];if(Ne[0].zoom===void 0)return[new Lt(Te,Ne,"object stop key must have zoom")];if(Ne[0].value===void 0)return[new Lt(Te,Ne,"object stop key must have value")];if(k&&k>Mn(Ne[0].zoom))return[new Lt(Te,Ne[0].zoom,"stop zoom values must appear in ascending order")];Mn(Ne[0].zoom)!==k&&(k=Mn(Ne[0].zoom),j=void 0,E={}),xe=xe.concat(Qi({key:`${Te}[0]`,value:Ne[0],valueSpec:{zoom:{}},validateSpec:me.validateSpec,style:me.style,styleSpec:me.styleSpec,objectElementValidators:{zoom:wx,value:ce}}))}else xe=xe.concat(ce({key:`${Te}[0]`,value:Ne[0],validateSpec:me.validateSpec,style:me.style,styleSpec:me.styleSpec},Ne));return px(dc(Ne[1]))?xe.concat([new Lt(`${Te}[1]`,Ne[1],"expressions are not allowed in function stops.")]):xe.concat(me.validateSpec({key:`${Te}[1]`,value:Ne[1],valueSpec:d,validateSpec:me.validateSpec,style:me.style,styleSpec:me.styleSpec}))}function ce(me,xe){const Ne=ps(me.value),Te=Mn(me.value),Le=me.value!==null?me.value:xe;if(x){if(Ne!==x)return[new Lt(me.key,Le,`${Ne} stop domain type must match previous stop domain type ${x}`)]}else x=Ne;if(Ne!=="number"&&Ne!=="string"&&Ne!=="boolean")return[new Lt(me.key,Le,"stop domain value must be a number, string, or boolean")];if(Ne!=="number"&&u!=="categorical"){let at=`number expected, ${Ne} found`;return ph(d)&&u===void 0&&(at+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Lt(me.key,Le,at)]}return u!=="categorical"||Ne!=="number"||isFinite(Te)&&Math.floor(Te)===Te?u!=="categorical"&&Ne==="number"&&j!==void 0&&Te<j?[new Lt(me.key,Le,"stop domain values must appear in ascending order")]:(j=Te,u==="categorical"&&Te in E?[new Lt(me.key,Le,"stop domain values must be unique")]:(E[Te]=!0,[])):[new Lt(me.key,Le,`integer expected, found ${Te}`)]}}function gh(h){const d=(h.expressionContext==="property"?Iw:eu)(dc(h.value),h.valueSpec);if(d.result==="error")return d.value.map(x=>new Lt(`${h.key}${x.key}`,h.value,x.message));const u=d.value.expression||d.value._styleExpression.expression;if(h.expressionContext==="property"&&h.propertyKey==="text-font"&&!u.outputDefined())return[new Lt(h.key,h.value,`Invalid data expression for "${h.propertyKey}". Output values must be contained as literals within the expression.`)];if(h.expressionContext==="property"&&h.propertyType==="layout"&&!mf(u))return[new Lt(h.key,h.value,'"feature-state" data expressions are not supported with layout properties.')];if(h.expressionContext==="filter"&&!mf(u))return[new Lt(h.key,h.value,'"feature-state" data expressions are not supported with filters.')];if(h.expressionContext&&h.expressionContext.indexOf("cluster")===0){if(!mx(u,["zoom","feature-state"]))return[new Lt(h.key,h.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(h.expressionContext==="cluster-initial"&&!hx(u))return[new Lt(h.key,h.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function uj(h){const d=h.key,u=h.value,x=ps(u);return x!=="string"?[new Lt(d,u,`color expected, ${x} found`)]:Kr.parse(String(u))?[]:[new Lt(d,u,`color expected, "${u}" found`)]}function gf(h){const d=h.key,u=h.value,x=h.valueSpec,j=[];return Array.isArray(x.values)?x.values.indexOf(Mn(u))===-1&&j.push(new Lt(d,u,`expected one of [${x.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(x.values).indexOf(Mn(u))===-1&&j.push(new Lt(d,u,`expected one of [${Object.keys(x.values).join(", ")}], ${JSON.stringify(u)} found`)),j}function hj(h){return vx(dc(h.value))?gh(Yn({},h,{expressionContext:"filter",valueSpec:{value:"boolean"}})):mj(h)}function mj(h){const d=h.value,u=h.key;if(ps(d)!=="array")return[new Lt(u,d,`array expected, ${ps(d)} found`)];const x=h.styleSpec;let j,k=[];if(d.length<1)return[new Lt(u,d,"filter array must have at least 1 element")];switch(k=k.concat(gf({key:`${u}[0]`,value:d[0],valueSpec:x.filter_operator,style:h.style,styleSpec:h.styleSpec})),Mn(d[0])){case"<":case"<=":case">":case">=":d.length>=2&&Mn(d[1])==="$type"&&k.push(new Lt(u,d,`"$type" cannot be use with operator "${d[0]}"`));case"==":case"!=":d.length!==3&&k.push(new Lt(u,d,`filter array for operator "${d[0]}" must have 3 elements`));case"in":case"!in":d.length>=2&&(j=ps(d[1]),j!=="string"&&k.push(new Lt(`${u}[1]`,d[1],`string expected, ${j} found`)));for(let E=2;E<d.length;E++)j=ps(d[E]),Mn(d[1])==="$type"?k=k.concat(gf({key:`${u}[${E}]`,value:d[E],valueSpec:x.geometry_type,style:h.style,styleSpec:h.styleSpec})):j!=="string"&&j!=="number"&&j!=="boolean"&&k.push(new Lt(`${u}[${E}]`,d[E],`string, number, or boolean expected, ${j} found`));break;case"any":case"all":case"none":for(let E=1;E<d.length;E++)k=k.concat(mj({key:`${u}[${E}]`,value:d[E],style:h.style,styleSpec:h.styleSpec}));break;case"has":case"!has":j=ps(d[1]),d.length!==2?k.push(new Lt(u,d,`filter array for "${d[0]}" operator must have 2 elements`)):j!=="string"&&k.push(new Lt(`${u}[1]`,d[1],`string expected, ${j} found`))}return k}function fj(h,d){const u=h.key,x=h.validateSpec,j=h.style,k=h.styleSpec,E=h.value,R=h.objectKey,$=k[`${d}_${h.layerType}`];if(!$)return[];const V=R.match(/^(.*)-transition$/);if(d==="paint"&&V&&$[V[1]]&&$[V[1]].transition)return x({key:u,value:E,valueSpec:k.transition,style:j,styleSpec:k});const W=h.valueSpec||$[R];if(!W)return[new Lt(u,E,`unknown property "${R}"`)];let ee;if(ps(E)==="string"&&ph(W)&&!W.tokens&&(ee=/^{([^}]+)}$/.exec(E)))return[new Lt(u,E,`"${R}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(ee[1])} }\`.`)];const ce=[];return h.layerType==="symbol"&&R==="text-font"&&fx(dc(E))&&Mn(E.type)==="identity"&&ce.push(new Lt(u,E,'"text-font" does not support identity functions')),ce.concat(x({key:h.key,value:E,valueSpec:W,style:j,styleSpec:k,expressionContext:"property",propertyType:d,propertyKey:R}))}function yf(h){return fj(h,"paint")}function zw(h){return fj(h,"layout")}function pj(h){let d=[];const u=h.value,x=h.key,j=h.style,k=h.styleSpec;if(ps(u)!=="object")return[new Lt(x,u,`object expected, ${ps(u)} found`)];u.type||u.ref||d.push(new Lt(x,u,'either "type" or "ref" is required'));let E=Mn(u.type);const R=Mn(u.ref);if(u.id){const $=Mn(u.id);for(let V=0;V<h.arrayIndex;V++){const W=j.layers[V];Mn(W.id)===$&&d.push(new Lt(x,u.id,`duplicate layer id "${u.id}", previously used at line ${W.id.__line__}`))}}if("ref"in u){let $;["type","source","source-layer","filter","layout"].forEach(V=>{V in u&&d.push(new Lt(x,u[V],`"${V}" is prohibited for ref layers`))}),j.layers.forEach(V=>{Mn(V.id)===R&&($=V)}),$?$.ref?d.push(new Lt(x,u.ref,"ref cannot reference another ref layer")):E=Mn($.type):d.push(new Lt(x,u.ref,`ref layer "${R}" not found`))}else if(E!=="background")if(u.source){const $=j.sources&&j.sources[u.source],V=$&&Mn($.type);$?V==="vector"&&E==="raster"?d.push(new Lt(x,u.source,`layer "${u.id}" requires a raster source`)):V!=="raster-dem"&&E==="hillshade"||V!=="raster-dem"&&E==="color-relief"?d.push(new Lt(x,u.source,`layer "${u.id}" requires a raster-dem source`)):V==="raster"&&E!=="raster"?d.push(new Lt(x,u.source,`layer "${u.id}" requires a vector source`)):V!=="vector"||u["source-layer"]?V==="raster-dem"&&E!=="hillshade"&&E!=="color-relief"?d.push(new Lt(x,u.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):E!=="line"||!u.paint||!u.paint["line-gradient"]||V==="geojson"&&$.lineMetrics||d.push(new Lt(x,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):d.push(new Lt(x,u,`layer "${u.id}" must specify a "source-layer"`)):d.push(new Lt(x,u.source,`source "${u.source}" not found`))}else d.push(new Lt(x,u,'missing required property "source"'));return d=d.concat(Qi({key:x,value:u,valueSpec:k.layer,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,objectElementValidators:{"*":()=>[],type:()=>h.validateSpec({key:`${x}.type`,value:u.type,valueSpec:k.layer.type,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,object:u,objectKey:"type"}),filter:hj,layout:$=>Qi({layer:u,key:$.key,value:$.value,style:$.style,styleSpec:$.styleSpec,validateSpec:$.validateSpec,objectElementValidators:{"*":V=>zw(Yn({layerType:E},V))}}),paint:$=>Qi({layer:u,key:$.key,value:$.value,style:$.style,styleSpec:$.styleSpec,validateSpec:$.validateSpec,objectElementValidators:{"*":V=>yf(Yn({layerType:E},V))}})}})),d}function ad(h){const d=h.value,u=h.key,x=ps(d);return x!=="string"?[new Lt(u,d,`string expected, ${x} found`)]:[]}const Bw={promoteId:function({key:h,value:d}){if(ps(d)==="string")return ad({key:h,value:d});{const u=[];for(const x in d)u.push(...ad({key:`${h}.${x}`,value:d[x]}));return u}}};function xj(h){const d=h.value,u=h.key,x=h.styleSpec,j=h.style,k=h.validateSpec;if(!d.type)return[new Lt(u,d,'"type" is required')];const E=Mn(d.type);let R;switch(E){case"vector":case"raster":return R=Qi({key:u,value:d,valueSpec:x[`source_${E.replace("-","_")}`],style:h.style,styleSpec:x,objectElementValidators:Bw,validateSpec:k}),R;case"raster-dem":return R=function($){var V;const W=(V=$.sourceName)!==null&&V!==void 0?V:"",ee=$.value,ce=$.styleSpec,me=ce.source_raster_dem,xe=$.style;let Ne=[];const Te=ps(ee);if(ee===void 0)return Ne;if(Te!=="object")return Ne.push(new Lt("source_raster_dem",ee,`object expected, ${Te} found`)),Ne;const Le=Mn(ee.encoding)==="custom",at=["redFactor","greenFactor","blueFactor","baseShift"],qe=$.value.encoding?`"${$.value.encoding}"`:"Default";for(const Ze in ee)!Le&&at.includes(Ze)?Ne.push(new Lt(Ze,ee[Ze],`In "${W}": "${Ze}" is only valid when "encoding" is set to "custom". ${qe} encoding found`)):me[Ze]?Ne=Ne.concat($.validateSpec({key:Ze,value:ee[Ze],valueSpec:me[Ze],validateSpec:$.validateSpec,style:xe,styleSpec:ce})):Ne.push(new Lt(Ze,ee[Ze],`unknown property "${Ze}"`));return Ne}({sourceName:u,value:d,style:h.style,styleSpec:x,validateSpec:k}),R;case"geojson":if(R=Qi({key:u,value:d,valueSpec:x.source_geojson,style:j,styleSpec:x,validateSpec:k,objectElementValidators:Bw}),d.cluster)for(const $ in d.clusterProperties){const[V,W]=d.clusterProperties[$],ee=typeof V=="string"?[V,["accumulated"],["get",$]]:V;R.push(...gh({key:`${u}.${$}.map`,value:W,expressionContext:"cluster-map"})),R.push(...gh({key:`${u}.${$}.reduce`,value:ee,expressionContext:"cluster-reduce"}))}return R;case"video":return Qi({key:u,value:d,valueSpec:x.source_video,style:j,validateSpec:k,styleSpec:x});case"image":return Qi({key:u,value:d,valueSpec:x.source_image,style:j,validateSpec:k,styleSpec:x});case"canvas":return[new Lt(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return gf({key:`${u}.type`,value:d.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function gj(h){const d=h.value,u=h.styleSpec,x=u.light,j=h.style;let k=[];const E=ps(d);if(d===void 0)return k;if(E!=="object")return k=k.concat([new Lt("light",d,`object expected, ${E} found`)]),k;for(const R in d){const $=R.match(/^(.*)-transition$/);k=k.concat($&&x[$[1]]&&x[$[1]].transition?h.validateSpec({key:R,value:d[R],valueSpec:u.transition,validateSpec:h.validateSpec,style:j,styleSpec:u}):x[R]?h.validateSpec({key:R,value:d[R],valueSpec:x[R],validateSpec:h.validateSpec,style:j,styleSpec:u}):[new Lt(R,d[R],`unknown property "${R}"`)])}return k}function yh(h){const d=h.value,u=h.styleSpec,x=u.sky,j=h.style,k=ps(d);if(d===void 0)return[];if(k!=="object")return[new Lt("sky",d,`object expected, ${k} found`)];let E=[];for(const R in d)E=E.concat(x[R]?h.validateSpec({key:R,value:d[R],valueSpec:x[R],style:j,styleSpec:u}):[new Lt(R,d[R],`unknown property "${R}"`)]);return E}function qw(h){const d=h.value,u=h.styleSpec,x=u.terrain,j=h.style;let k=[];const E=ps(d);if(d===void 0)return k;if(E!=="object")return k=k.concat([new Lt("terrain",d,`object expected, ${E} found`)]),k;for(const R in d)k=k.concat(x[R]?h.validateSpec({key:R,value:d[R],valueSpec:x[R],validateSpec:h.validateSpec,style:j,styleSpec:u}):[new Lt(R,d[R],`unknown property "${R}"`)]);return k}function Vw(h){let d=[];const u=h.value,x=h.key;if(Array.isArray(u)){const j=[],k=[];for(const E in u)u[E].id&&j.includes(u[E].id)&&d.push(new Lt(x,u,`all the sprites' ids must be unique, but ${u[E].id} is duplicated`)),j.push(u[E].id),u[E].url&&k.includes(u[E].url)&&d.push(new Lt(x,u,`all the sprites' URLs must be unique, but ${u[E].url} is duplicated`)),k.push(u[E].url),d=d.concat(Qi({key:`${x}[${E}]`,value:u[E],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:h.validateSpec}));return d}return ad({key:x,value:u})}function Uw(h){return d=h.value,d&&d.constructor===Object?[]:[new Lt(h.key,h.value,`object expected, ${ps(h.value)} found`)];var d}const Ww={"*":()=>[],array:xh,boolean:function(h){const d=h.value,u=h.key,x=ps(d);return x!=="boolean"?[new Lt(u,d,`boolean expected, ${x} found`)]:[]},number:wx,color:uj,constants:_x,enum:gf,filter:hj,function:$w,layer:pj,object:Qi,source:xj,light:gj,sky:yh,terrain:qw,projection:function(h){const d=h.value,u=h.styleSpec,x=u.projection,j=h.style,k=ps(d);if(d===void 0)return[];if(k!=="object")return[new Lt("projection",d,`object expected, ${k} found`)];let E=[];for(const R in d)E=E.concat(x[R]?h.validateSpec({key:R,value:d[R],valueSpec:x[R],style:j,styleSpec:u}):[new Lt(R,d[R],`unknown property "${R}"`)]);return E},projectionDefinition:function(h){const d=h.key;let u=h.value;u=u instanceof String?u.valueOf():u;const x=ps(u);return x!=="array"||function(j){return Array.isArray(j)&&j.length===3&&typeof j[0]=="string"&&typeof j[1]=="string"&&typeof j[2]=="number"}(u)||function(j){return!!["interpolate","step","literal"].includes(j[0])}(u)?["array","string"].includes(x)?[]:[new Lt(d,u,`projection expected, invalid type "${x}" found`)]:[new Lt(d,u,`projection expected, invalid array ${JSON.stringify(u)} found`)]},string:ad,formatted:function(h){return ad(h).length===0?[]:gh(h)},resolvedImage:function(h){return ad(h).length===0?[]:gh(h)},padding:function(h){const d=h.key,u=h.value;if(ps(u)==="array"){if(u.length<1||u.length>4)return[new Lt(d,u,`padding requires 1 to 4 values; ${u.length} values found`)];const x={type:"number"};let j=[];for(let k=0;k<u.length;k++)j=j.concat(h.validateSpec({key:`${d}[${k}]`,value:u[k],validateSpec:h.validateSpec,valueSpec:x}));return j}return wx({key:d,value:u,valueSpec:{}})},numberArray:function(h){const d=h.key,u=h.value;if(ps(u)==="array"){const x={type:"number"};if(u.length<1)return[new Lt(d,u,"array length at least 1 expected, length 0 found")];let j=[];for(let k=0;k<u.length;k++)j=j.concat(h.validateSpec({key:`${d}[${k}]`,value:u[k],validateSpec:h.validateSpec,valueSpec:x}));return j}return wx({key:d,value:u,valueSpec:{}})},colorArray:function(h){const d=h.key,u=h.value;if(ps(u)==="array"){if(u.length<1)return[new Lt(d,u,"array length at least 1 expected, length 0 found")];let x=[];for(let j=0;j<u.length;j++)x=x.concat(uj({key:`${d}[${j}]`,value:u[j]}));return x}return uj({key:d,value:u})},variableAnchorOffsetCollection:function(h){const d=h.key,u=h.value,x=ps(u),j=h.styleSpec;if(x!=="array"||u.length<1||u.length%2!=0)return[new Lt(d,u,"variableAnchorOffsetCollection requires a non-empty array of even length")];let k=[];for(let E=0;E<u.length;E+=2)k=k.concat(gf({key:`${d}[${E}]`,value:u[E],valueSpec:j.layout_symbol["text-anchor"]})),k=k.concat(xh({key:`${d}[${E+1}]`,value:u[E+1],valueSpec:{length:2,value:"number"},validateSpec:h.validateSpec,style:h.style,styleSpec:j}));return k},sprite:Vw,state:Uw};function Nx(h){const d=h.value,u=h.valueSpec,x=h.styleSpec;return h.validateSpec=Nx,u.expression&&fx(Mn(d))?$w(h):u.expression&&px(dc(d))?gh(h):u.type&&Ww[u.type]?Ww[u.type](h):Qi(Yn({},h,{valueSpec:u.type?x[u.type]:u}))}function Gw(h){const d=h.value,u=h.key,x=ad(h);return x.length||(d.indexOf("{fontstack}")===-1&&x.push(new Lt(u,d,'"glyphs" url must include a "{fontstack}" token')),d.indexOf("{range}")===-1&&x.push(new Lt(u,d,'"glyphs" url must include a "{range}" token'))),x}function xi(h,d=ot){let u=[];return u=u.concat(Nx({key:"",value:h,valueSpec:d.$root,styleSpec:d,style:h,validateSpec:Nx,objectElementValidators:{glyphs:Gw,"*":()=>[]}})),h.constants&&(u=u.concat(_x({key:"constants",value:h.constants}))),Ji(u)}function Ii(h){return function(d){return h(Object.assign({},d,{validateSpec:Nx}))}}function Ji(h){return[].concat(h).sort((d,u)=>d.line-u.line)}function Di(h){return function(...d){return Ji(h.apply(this,d))}}xi.source=Di(Ii(xj)),xi.sprite=Di(Ii(Vw)),xi.glyphs=Di(Ii(Gw)),xi.light=Di(Ii(gj)),xi.sky=Di(Ii(yh)),xi.terrain=Di(Ii(qw)),xi.state=Di(Ii(Uw)),xi.layer=Di(Ii(pj)),xi.filter=Di(Ii(hj)),xi.paintProperty=Di(Ii(yf)),xi.layoutProperty=Di(Ii(zw));const Kw=ot,vh=xi,ok=vh.light,vf=vh.sky,Hw=vh.paintProperty,yj=vh.layoutProperty;function Zw(h,d){let u=!1;if(d&&d.length)for(const x of d)h.fire(new Pt(new Error(x.message))),u=!0;return u}class ru{constructor(d,u,x){const j=this.cells=[];if(d instanceof ArrayBuffer){this.arrayBuffer=d;const E=new Int32Array(this.arrayBuffer);d=E[0],this.d=(u=E[1])+2*(x=E[2]);for(let $=0;$<this.d*this.d;$++){const V=E[3+$],W=E[3+$+1];j.push(V===W?null:E.subarray(V,W))}const R=E[3+j.length+1];this.keys=E.subarray(E[3+j.length],R),this.bboxes=E.subarray(R),this.insert=this._insertReadonly}else{this.d=u+2*x;for(let E=0;E<this.d*this.d;E++)j.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=d,this.padding=x,this.scale=u/d,this.uid=0;const k=x/u*d;this.min=-k,this.max=d+k}insert(d,u,x,j,k){this._forEachCell(u,x,j,k,this._insertCell,this.uid++,void 0,void 0),this.keys.push(d),this.bboxes.push(u),this.bboxes.push(x),this.bboxes.push(j),this.bboxes.push(k)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(d,u,x,j,k,E){this.cells[k].push(E)}query(d,u,x,j,k){const E=this.min,R=this.max;if(d<=E&&u<=E&&R<=x&&R<=j&&!k)return Array.prototype.slice.call(this.keys);{const $=[];return this._forEachCell(d,u,x,j,this._queryCell,$,{},k),$}}_queryCell(d,u,x,j,k,E,R,$){const V=this.cells[k];if(V!==null){const W=this.keys,ee=this.bboxes;for(let ce=0;ce<V.length;ce++){const me=V[ce];if(R[me]===void 0){const xe=4*me;($?$(ee[xe+0],ee[xe+1],ee[xe+2],ee[xe+3]):d<=ee[xe+2]&&u<=ee[xe+3]&&x>=ee[xe+0]&&j>=ee[xe+1])?(R[me]=!0,E.push(W[me])):R[me]=!1}}}}_forEachCell(d,u,x,j,k,E,R,$){const V=this._convertToCellCoord(d),W=this._convertToCellCoord(u),ee=this._convertToCellCoord(x),ce=this._convertToCellCoord(j);for(let me=V;me<=ee;me++)for(let xe=W;xe<=ce;xe++){const Ne=this.d*xe+me;if((!$||$(this._convertFromCellCoord(me),this._convertFromCellCoord(xe),this._convertFromCellCoord(me+1),this._convertFromCellCoord(xe+1)))&&k.call(this,d,u,x,j,Ne,E,R,$))return}}_convertFromCellCoord(d){return(d-this.padding)/this.scale}_convertToCellCoord(d){return Math.max(0,Math.min(this.d-1,Math.floor(d*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const d=this.cells,u=3+this.cells.length+1+1;let x=0;for(let E=0;E<this.cells.length;E++)x+=this.cells[E].length;const j=new Int32Array(u+x+this.keys.length+this.bboxes.length);j[0]=this.extent,j[1]=this.n,j[2]=this.padding;let k=u;for(let E=0;E<d.length;E++){const R=d[E];j[3+E]=k,j.set(R,k),k+=R.length}return j[3+d.length]=k,j.set(this.keys,k),k+=this.keys.length,j[3+d.length+1]=k,j.set(this.bboxes,k),k+=this.bboxes.length,j.buffer}static serialize(d,u){const x=d.toArrayBuffer();return u&&u.push(x),{buffer:x}}static deserialize(d){return new ru(d.buffer)}}const uc={};function pr(h,d,u={}){if(uc[h])throw new Error(`${h} is already registered.`);Object.defineProperty(d,"_classRegistryKey",{value:h,writeable:!1}),uc[h]={klass:d,omit:u.omit||[],shallow:u.shallow||[]}}pr("Object",Object),pr("Set",Set),pr("TransferableGridIndex",ru),pr("Color",Kr),pr("Error",Error),pr("AJAXError",Fe),pr("ResolvedImage",Oi),pr("StylePropertyFunction",xx),pr("StyleExpression",oj,{omit:["_evaluator"]}),pr("ZoomDependentExpression",lj),pr("ZoomConstantExpression",ff),pr("CompoundExpression",Mo,{omit:["_evaluate"]});for(const h in mh)mh[h]._classRegistryKey||pr(`Expression_${h}`,mh[h]);function Yw(h){return h&&typeof ArrayBuffer<"u"&&(h instanceof ArrayBuffer||h.constructor&&h.constructor.name==="ArrayBuffer")}function vj(h){return h.$name||h.constructor._classRegistryKey}function Xw(h){return!function(d){if(d===null||typeof d!="object")return!1;const u=vj(d);return!(!u||u==="Object")}(h)&&(h==null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp||h instanceof Blob||h instanceof Error||Yw(h)||Qs(h)||ArrayBuffer.isView(h)||h instanceof ImageData)}function hc(h,d){if(Xw(h))return(Yw(h)||Qs(h))&&d&&d.push(h),ArrayBuffer.isView(h)&&d&&d.push(h.buffer),h instanceof ImageData&&d&&d.push(h.data.buffer),h;if(Array.isArray(h)){const k=[];for(const E of h)k.push(hc(E,d));return k}if(typeof h!="object")throw new Error("can't serialize object of type "+typeof h);const u=vj(h);if(!u)throw new Error(`can't serialize object of unregistered class ${h.constructor.name}`);if(!uc[u])throw new Error(`${u} is not registered.`);const{klass:x}=uc[u],j=x.serialize?x.serialize(h,d):{};if(x.serialize){if(d&&j===d[d.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const k in h){if(!h.hasOwnProperty(k)||uc[u].omit.indexOf(k)>=0)continue;const E=h[k];j[k]=uc[u].shallow.indexOf(k)>=0?E:hc(E,d)}h instanceof Error&&(j.message=h.message)}if(j.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(j.$name=u),j}function jf(h){if(Xw(h))return h;if(Array.isArray(h))return h.map(jf);if(typeof h!="object")throw new Error("can't deserialize object of type "+typeof h);const d=vj(h)||"Object";if(!uc[d])throw new Error(`can't deserialize unregistered class ${d}`);const{klass:u}=uc[d];if(!u)throw new Error(`can't deserialize unregistered class ${d}`);if(u.deserialize)return u.deserialize(h);const x=Object.create(u.prototype);for(const j of Object.keys(h)){if(j==="$name")continue;const k=h[j];x[j]=uc[d].shallow.indexOf(j)>=0?k:jf(k)}return x}class jj{constructor(){this.first=!0}update(d,u){const x=Math.floor(d);return this.first?(this.first=!1,this.lastIntegerZoom=x,this.lastIntegerZoomTime=0,this.lastZoom=d,this.lastFloorZoom=x,!0):(this.lastFloorZoom>x?(this.lastIntegerZoom=x+1,this.lastIntegerZoomTime=u):this.lastFloorZoom<x&&(this.lastIntegerZoom=x,this.lastIntegerZoomTime=u),d!==this.lastZoom&&(this.lastZoom=d,this.lastFloorZoom=x,!0))}}const us={"Latin-1 Supplement":h=>h>=128&&h<=255,"Hangul Jamo":h=>h>=4352&&h<=4607,Khmer:h=>h>=6016&&h<=6143,"General Punctuation":h=>h>=8192&&h<=8303,"Letterlike Symbols":h=>h>=8448&&h<=8527,"Number Forms":h=>h>=8528&&h<=8591,"Miscellaneous Technical":h=>h>=8960&&h<=9215,"Control Pictures":h=>h>=9216&&h<=9279,"Optical Character Recognition":h=>h>=9280&&h<=9311,"Enclosed Alphanumerics":h=>h>=9312&&h<=9471,"Geometric Shapes":h=>h>=9632&&h<=9727,"Miscellaneous Symbols":h=>h>=9728&&h<=9983,"Miscellaneous Symbols and Arrows":h=>h>=11008&&h<=11263,"Ideographic Description Characters":h=>h>=12272&&h<=12287,"CJK Symbols and Punctuation":h=>h>=12288&&h<=12351,Hiragana:h=>h>=12352&&h<=12447,Katakana:h=>h>=12448&&h<=12543,Kanbun:h=>h>=12688&&h<=12703,"CJK Strokes":h=>h>=12736&&h<=12783,"Enclosed CJK Letters and Months":h=>h>=12800&&h<=13055,"CJK Compatibility":h=>h>=13056&&h<=13311,"Yijing Hexagram Symbols":h=>h>=19904&&h<=19967,"CJK Unified Ideographs":h=>h>=19968&&h<=40959,"Hangul Syllables":h=>h>=44032&&h<=55215,"Private Use Area":h=>h>=57344&&h<=63743,"Vertical Forms":h=>h>=65040&&h<=65055,"CJK Compatibility Forms":h=>h>=65072&&h<=65103,"Small Form Variants":h=>h>=65104&&h<=65135,"Halfwidth and Fullwidth Forms":h=>h>=65280&&h<=65519};function bj(h){for(const d of h)if(Sx(d.charCodeAt(0)))return!0;return!1}function _j(h){for(const d of h)if(!Jw(d.charCodeAt(0)))return!1;return!0}function jh(h){const d=h.map(u=>{try{return new RegExp(`\\p{sc=${u}}`,"u").source}catch{return null}}).filter(u=>u);return new RegExp(d.join("|"),"u")}const Qw=jh(["Arab","Dupl","Mong","Ougr","Syrc"]);function Jw(h){return!Qw.test(String.fromCodePoint(h))}const wj=jh(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Sx(h){return!(h!==746&&h!==747&&(h<4352||!(us["CJK Compatibility Forms"](h)&&!(h>=65097&&h<=65103)||us["CJK Compatibility"](h)||us["CJK Strokes"](h)||!(!us["CJK Symbols and Punctuation"](h)||h>=12296&&h<=12305||h>=12308&&h<=12319||h===12336)||us["Enclosed CJK Letters and Months"](h)||us["Ideographic Description Characters"](h)||us.Kanbun(h)||us.Katakana(h)&&h!==12540||!(!us["Halfwidth and Fullwidth Forms"](h)||h===65288||h===65289||h===65293||h>=65306&&h<=65310||h===65339||h===65341||h===65343||h>=65371&&h<=65503||h===65507||h>=65512&&h<=65519)||!(!us["Small Form Variants"](h)||h>=65112&&h<=65118||h>=65123&&h<=65126)||us["Vertical Forms"](h)||us["Yijing Hexagram Symbols"](h)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(h))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(h))||wj.test(String.fromCodePoint(h)))))}function Cx(h){return!(Sx(h)||function(d){return!!(us["Latin-1 Supplement"](d)&&(d===167||d===169||d===174||d===177||d===188||d===189||d===190||d===215||d===247)||us["General Punctuation"](d)&&(d===8214||d===8224||d===8225||d===8240||d===8241||d===8251||d===8252||d===8258||d===8263||d===8264||d===8265||d===8273)||us["Letterlike Symbols"](d)||us["Number Forms"](d)||us["Miscellaneous Technical"](d)&&(d>=8960&&d<=8967||d>=8972&&d<=8991||d>=8996&&d<=9e3||d===9003||d>=9085&&d<=9114||d>=9150&&d<=9165||d===9167||d>=9169&&d<=9179||d>=9186&&d<=9215)||us["Control Pictures"](d)&&d!==9251||us["Optical Character Recognition"](d)||us["Enclosed Alphanumerics"](d)||us["Geometric Shapes"](d)||us["Miscellaneous Symbols"](d)&&!(d>=9754&&d<=9759)||us["Miscellaneous Symbols and Arrows"](d)&&(d>=11026&&d<=11055||d>=11088&&d<=11097||d>=11192&&d<=11243)||us["CJK Symbols and Punctuation"](d)||us.Katakana(d)||us["Private Use Area"](d)||us["CJK Compatibility Forms"](d)||us["Small Form Variants"](d)||us["Halfwidth and Fullwidth Forms"](d)||d===8734||d===8756||d===8757||d>=9984&&d<=10087||d>=10102&&d<=10131||d===65532||d===65533)}(h))}const e1=jh(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function t1(h){return e1.test(String.fromCodePoint(h))}function r1(h,d){return!(!d&&t1(h)||h>=2304&&h<=3583||h>=3840&&h<=4255||us.Khmer(h))}function lk(h){for(const d of h)if(t1(d.charCodeAt(0)))return!0;return!1}const mc=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(h){this.pluginStatus=h.pluginStatus,this.pluginURL=h.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(h){if(mc.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=h.applyArabicShaping,this.processBidirectionalText=h.processBidirectionalText,this.processStyledBidirectionalText=h.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(h,d){return i(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(h.pluginStatus!=="loading")return this.setState(h),h;const u=h.pluginURL,x=new Promise(k=>{this.loadScriptResolve=k});d(u);const j=new Promise(k=>setTimeout(()=>k(),this.TIMEOUT));if(yield Promise.race([x,j]),this.isParsed()){const k={pluginStatus:"loaded",pluginURL:u};return this.setState(k),k}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${u}`)})}};class an{constructor(d,u){this.isSupportedScript=s1,this.zoom=d,u?(this.now=u.now||0,this.fadeDuration=u.fadeDuration||0,this.zoomHistory=u.zoomHistory||new jj,this.transition=u.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new jj,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const d=this.zoom,u=d-Math.floor(d),x=this.crossFadingFactor();return d>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:u+(1-u)*x}:{fromScale:.5,toScale:1,t:1-(1-x)*u}}}function s1(h){return function(d,u){for(const x of d)if(!r1(x.charCodeAt(0),u))return!1;return!0}(h,mc.getRTLTextPluginStatus()==="loaded")}class bf{constructor(d,u,x){this.property=d,this.value=u,this.expression=function(j,k,E){if(fx(j))return new xx(j,k);if(px(j)){const R=Iw(j,k,E);if(R.result==="error")throw new Error(R.value.map($=>`${$.key}: ${$.message}`).join(", "));return R.value}{let R=j;return k.type==="color"&&typeof j=="string"?R=Kr.parse(j):k.type!=="padding"||typeof j!="number"&&!Array.isArray(j)?k.type!=="numberArray"||typeof j!="number"&&!Array.isArray(j)?k.type!=="colorArray"||typeof j!="string"&&!Array.isArray(j)?k.type==="variableAnchorOffsetCollection"&&Array.isArray(j)?R=pi.parse(j):k.type==="projectionDefinition"&&typeof j=="string"&&(R=fo.parse(j)):R=na.parse(j):R=Qa.parse(j):R=fi.parse(j),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>R}}}(u===void 0?d.specification.default:u,d.specification,x)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(d,u,x){return this.property.possiblyEvaluate(this,d,u,x)}}class Nj{constructor(d,u){this.property=d,this.value=new bf(d,void 0,u)}transitioned(d,u){return new Sj(this.property,this.value,u,ur({},d.transition,this.transition),d.now)}untransitioned(){return new Sj(this.property,this.value,null,{},0)}}class n1{constructor(d,u){this._properties=d,this._values=Object.create(d.defaultTransitionablePropertyValues),this._globalState=u}getValue(d){return vt(this._values[d].value.value)}setValue(d,u){Object.prototype.hasOwnProperty.call(this._values,d)||(this._values[d]=new Nj(this._values[d].property,this._globalState)),this._values[d].value=new bf(this._values[d].property,u===null?void 0:vt(u),this._globalState)}getTransition(d){return vt(this._values[d].transition)}setTransition(d,u){Object.prototype.hasOwnProperty.call(this._values,d)||(this._values[d]=new Nj(this._values[d].property,this._globalState)),this._values[d].transition=vt(u)||void 0}serialize(){const d={};for(const u of Object.keys(this._values)){const x=this.getValue(u);x!==void 0&&(d[u]=x);const j=this.getTransition(u);j!==void 0&&(d[`${u}-transition`]=j)}return d}transitioned(d,u){const x=new Cj(this._properties);for(const j of Object.keys(this._values))x._values[j]=this._values[j].transitioned(d,u._values[j]);return x}untransitioned(){const d=new Cj(this._properties);for(const u of Object.keys(this._values))d._values[u]=this._values[u].untransitioned();return d}}class Sj{constructor(d,u,x,j,k){this.property=d,this.value=u,this.begin=k+j.delay||0,this.end=this.begin+j.duration||0,d.specification.transition&&(j.delay||j.duration)&&(this.prior=x)}possiblyEvaluate(d,u,x){const j=d.now||0,k=this.value.possiblyEvaluate(d,u,x),E=this.prior;if(E){if(j>this.end)return this.prior=null,k;if(this.value.isDataDriven())return this.prior=null,k;if(j<this.begin)return E.possiblyEvaluate(d,u,x);{const R=(j-this.begin)/(this.end-this.begin);return this.property.interpolate(E.possiblyEvaluate(d,u,x),k,yt(R))}}return k}}class Cj{constructor(d){this._properties=d,this._values=Object.create(d.defaultTransitioningPropertyValues)}possiblyEvaluate(d,u,x){const j=new su(this._properties);for(const k of Object.keys(this._values))j._values[k]=this._values[k].possiblyEvaluate(d,u,x);return j}hasTransition(){for(const d of Object.keys(this._values))if(this._values[d].prior)return!0;return!1}}class a1{constructor(d,u){this._properties=d,this._values=Object.create(d.defaultPropertyValues),this._globalState=u}hasValue(d){return this._values[d].value!==void 0}getValue(d){return vt(this._values[d].value)}setValue(d,u){this._values[d]=new bf(this._values[d].property,u===null?void 0:vt(u),this._globalState)}serialize(){const d={};for(const u of Object.keys(this._values)){const x=this.getValue(u);x!==void 0&&(d[u]=x)}return d}possiblyEvaluate(d,u,x){const j=new su(this._properties);for(const k of Object.keys(this._values))j._values[k]=this._values[k].possiblyEvaluate(d,u,x);return j}}class Jo{constructor(d,u,x){this.property=d,this.value=u,this.parameters=x}isConstant(){return this.value.kind==="constant"}constantOr(d){return this.value.kind==="constant"?this.value.value:d}evaluate(d,u,x,j){return this.property.evaluate(this.value,this.parameters,d,u,x,j)}}class su{constructor(d){this._properties=d,this._values=Object.create(d.defaultPossiblyEvaluatedValues)}get(d){return this._values[d]}}class Nr{constructor(d){this.specification=d}possiblyEvaluate(d,u){if(d.isDataDriven())throw new Error("Value should not be data driven");return d.expression.evaluate(u)}interpolate(d,u,x){const j=Eo[this.specification.type];return j?j(d,u,x):d}}class Lr{constructor(d,u){this.specification=d,this.overrides=u}possiblyEvaluate(d,u,x,j){return new Jo(this,d.expression.kind==="constant"||d.expression.kind==="camera"?{kind:"constant",value:d.expression.evaluate(u,null,{},x,j)}:d.expression,u)}interpolate(d,u,x){if(d.value.kind!=="constant"||u.value.kind!=="constant")return d;if(d.value.value===void 0||u.value.value===void 0)return new Jo(this,{kind:"constant",value:void 0},d.parameters);const j=Eo[this.specification.type];if(j){const k=j(d.value.value,u.value.value,x);return new Jo(this,{kind:"constant",value:k},d.parameters)}return d}evaluate(d,u,x,j,k,E){return d.kind==="constant"?d.value:d.evaluate(u,x,j,k,E)}}class _f extends Lr{possiblyEvaluate(d,u,x,j){if(d.value===void 0)return new Jo(this,{kind:"constant",value:void 0},u);if(d.expression.kind==="constant"){const k=d.expression.evaluate(u,null,{},x,j),E=d.property.specification.type==="resolvedImage"&&typeof k!="string"?k.name:k,R=this._calculate(E,E,E,u);return new Jo(this,{kind:"constant",value:R},u)}if(d.expression.kind==="camera"){const k=this._calculate(d.expression.evaluate({zoom:u.zoom-1}),d.expression.evaluate({zoom:u.zoom}),d.expression.evaluate({zoom:u.zoom+1}),u);return new Jo(this,{kind:"constant",value:k},u)}return new Jo(this,d.expression,u)}evaluate(d,u,x,j,k,E){if(d.kind==="source"){const R=d.evaluate(u,x,j,k,E);return this._calculate(R,R,R,u)}return d.kind==="composite"?this._calculate(d.evaluate({zoom:Math.floor(u.zoom)-1},x,j),d.evaluate({zoom:Math.floor(u.zoom)},x,j),d.evaluate({zoom:Math.floor(u.zoom)+1},x,j),u):d.value}_calculate(d,u,x,j){return j.zoom>j.zoomHistory.lastIntegerZoom?{from:d,to:u}:{from:x,to:u}}interpolate(d){return d}}class i1{constructor(d){this.specification=d}possiblyEvaluate(d,u,x,j){if(d.value!==void 0){if(d.expression.kind==="constant"){const k=d.expression.evaluate(u,null,{},x,j);return this._calculate(k,k,k,u)}return this._calculate(d.expression.evaluate(new an(Math.floor(u.zoom-1),u)),d.expression.evaluate(new an(Math.floor(u.zoom),u)),d.expression.evaluate(new an(Math.floor(u.zoom+1),u)),u)}}_calculate(d,u,x,j){return j.zoom>j.zoomHistory.lastIntegerZoom?{from:d,to:u}:{from:x,to:u}}interpolate(d){return d}}class wf{constructor(d){this.specification=d}possiblyEvaluate(d,u,x,j){return!!d.expression.evaluate(u,null,{},x,j)}interpolate(){return!1}}class gi{constructor(d){this.properties=d,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const u in d){const x=d[u];x.specification.overridable&&this.overridableProperties.push(u);const j=this.defaultPropertyValues[u]=new bf(x,void 0,void 0),k=this.defaultTransitionablePropertyValues[u]=new Nj(x,void 0);this.defaultTransitioningPropertyValues[u]=k.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=j.possiblyEvaluate({})}}}pr("DataDrivenProperty",Lr),pr("DataConstantProperty",Nr),pr("CrossFadedDataDrivenProperty",_f),pr("CrossFadedProperty",i1),pr("ColorRampProperty",wf);const Pj="-transition";class el extends br{constructor(d,u,x){if(super(),this.id=d.id,this.type=d.type,this._globalState=x,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},d.type!=="custom"&&(this.metadata=d.metadata,this.minzoom=d.minzoom,this.maxzoom=d.maxzoom,d.type!=="background"&&(this.source=d.source,this.sourceLayer=d["source-layer"],this.filter=d.filter,this._featureFilter=pf(d.filter,x)),u.layout&&(this._unevaluatedLayout=new a1(u.layout,x)),u.paint)){this._transitionablePaint=new n1(u.paint,x);for(const j in d.paint)this.setPaintProperty(j,d.paint[j],{validate:!1});for(const j in d.layout)this.setLayoutProperty(j,d.layout[j],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new su(u.paint)}}setFilter(d){this.filter=d,this._featureFilter=pf(d,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(d){return d==="visibility"?this.visibility:this._unevaluatedLayout.getValue(d)}getLayoutAffectingGlobalStateRefs(){const d=new Set;if(this._unevaluatedLayout)for(const u in this._unevaluatedLayout._values){const x=this._unevaluatedLayout._values[u];for(const j of x.getGlobalStateRefs())d.add(j)}for(const u of this._featureFilter.getGlobalStateRefs())d.add(u);return d}getPaintAffectingGlobalStateRefs(){var d;const u=new globalThis.Map;if(this._transitionablePaint)for(const x in this._transitionablePaint._values){const j=this._transitionablePaint._values[x].value;for(const k of j.getGlobalStateRefs()){const E=(d=u.get(k))!==null&&d!==void 0?d:[];E.push({name:x,value:j.value}),u.set(k,E)}}return u}setLayoutProperty(d,u,x={}){u!=null&&this._validate(yj,`layers.${this.id}.layout.${d}`,d,u,x)||(d!=="visibility"?this._unevaluatedLayout.setValue(d,u):this.visibility=u)}getPaintProperty(d){return d.endsWith(Pj)?this._transitionablePaint.getTransition(d.slice(0,-11)):this._transitionablePaint.getValue(d)}setPaintProperty(d,u,x={}){if(u!=null&&this._validate(Hw,`layers.${this.id}.paint.${d}`,d,u,x))return!1;if(d.endsWith(Pj))return this._transitionablePaint.setTransition(d.slice(0,-11),u||void 0),!1;{const j=this._transitionablePaint._values[d],k=j.property.specification["property-type"]==="cross-faded-data-driven",E=j.value.isDataDriven(),R=j.value;this._transitionablePaint.setValue(d,u),this._handleSpecialPaintPropertyUpdate(d);const $=this._transitionablePaint._values[d].value;return $.isDataDriven()||E||k||this._handleOverridablePaintPropertyUpdate(d,R,$)}}_handleSpecialPaintPropertyUpdate(d){}_handleOverridablePaintPropertyUpdate(d,u,x){return!1}isHidden(d,u=!1){return!!(this.minzoom&&d<(u?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&d>=this.maxzoom)||this.visibility==="none"}updateTransitions(d){this._transitioningPaint=this._transitionablePaint.transitioned(d,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(d,u){d.getCrossfadeParameters&&(this._crossfadeParameters=d.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(d,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(d,void 0,u)}serialize(){const d={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(d.layout=d.layout||{},d.layout.visibility=this.visibility),fr(d,(u,x)=>!(u===void 0||x==="layout"&&!Object.keys(u).length||x==="paint"&&!Object.keys(u).length))}_validate(d,u,x,j,k={}){return(!k||k.validate!==!1)&&Zw(this,d.call(vh,{key:u,layerType:this.type,objectKey:x,value:j,styleSpec:ot,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const d in this.paint._values){const u=this.paint.get(d);if(u instanceof Jo&&ph(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1}}let o1;var ck={get paint(){return o1=o1||new gi({"raster-opacity":new Nr(ot.paint_raster["raster-opacity"]),"raster-hue-rotate":new Nr(ot.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Nr(ot.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Nr(ot.paint_raster["raster-brightness-max"]),"raster-saturation":new Nr(ot.paint_raster["raster-saturation"]),"raster-contrast":new Nr(ot.paint_raster["raster-contrast"]),"raster-resampling":new Nr(ot.paint_raster["raster-resampling"]),"raster-fade-duration":new Nr(ot.paint_raster["raster-fade-duration"])})}};class dk extends el{constructor(d,u){super(d,ck,u)}}const uk={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Al{constructor(d,u){this._structArray=d,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class On{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(d,u){return d._trim(),u&&(d.isTransferred=!0,u.push(d.arrayBuffer)),{length:d.length,arrayBuffer:d.arrayBuffer}}static deserialize(d){const u=Object.create(this.prototype);return u.arrayBuffer=d.arrayBuffer,u.length=d.length,u.capacity=d.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(d){this.reserve(d),this.length=d}reserve(d){if(d>this.capacity){this.capacity=Math.max(d,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Qn(h,d=1){let u=0,x=0;return{members:h.map(j=>{const k=uk[j.type].BYTES_PER_ELEMENT,E=u=l1(u,Math.max(d,k)),R=j.components||1;return x=Math.max(x,k),u+=k*R,{name:j.name,type:j.type,components:R,offset:E}}),size:l1(u,Math.max(x,d)),alignment:d}}function l1(h,d){return Math.ceil(h/d)*d}class bh extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(d,u){const x=this.length;return this.resize(x+1),this.emplace(x,d,u)}emplace(d,u,x){const j=2*d;return this.int16[j+0]=u,this.int16[j+1]=x,d}}bh.prototype.bytesPerElement=4,pr("StructArrayLayout2i4",bh);class Px extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(d,u,x){const j=this.length;return this.resize(j+1),this.emplace(j,d,u,x)}emplace(d,u,x,j){const k=3*d;return this.int16[k+0]=u,this.int16[k+1]=x,this.int16[k+2]=j,d}}Px.prototype.bytesPerElement=6,pr("StructArrayLayout3i6",Px);class kj extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(d,u,x,j){const k=this.length;return this.resize(k+1),this.emplace(k,d,u,x,j)}emplace(d,u,x,j,k){const E=4*d;return this.int16[E+0]=u,this.int16[E+1]=x,this.int16[E+2]=j,this.int16[E+3]=k,d}}kj.prototype.bytesPerElement=8,pr("StructArrayLayout4i8",kj);class fc extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(d,u,x,j,k,E){const R=this.length;return this.resize(R+1),this.emplace(R,d,u,x,j,k,E)}emplace(d,u,x,j,k,E,R){const $=6*d;return this.int16[$+0]=u,this.int16[$+1]=x,this.int16[$+2]=j,this.int16[$+3]=k,this.int16[$+4]=E,this.int16[$+5]=R,d}}fc.prototype.bytesPerElement=12,pr("StructArrayLayout2i4i12",fc);class kx extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(d,u,x,j,k,E){const R=this.length;return this.resize(R+1),this.emplace(R,d,u,x,j,k,E)}emplace(d,u,x,j,k,E,R){const $=4*d,V=8*d;return this.int16[$+0]=u,this.int16[$+1]=x,this.uint8[V+4]=j,this.uint8[V+5]=k,this.uint8[V+6]=E,this.uint8[V+7]=R,d}}kx.prototype.bytesPerElement=8,pr("StructArrayLayout2i4ub8",kx);class nu extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(d,u){const x=this.length;return this.resize(x+1),this.emplace(x,d,u)}emplace(d,u,x){const j=2*d;return this.float32[j+0]=u,this.float32[j+1]=x,d}}nu.prototype.bytesPerElement=8,pr("StructArrayLayout2f8",nu);class Ax extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(d,u,x,j,k,E,R,$,V,W){const ee=this.length;return this.resize(ee+1),this.emplace(ee,d,u,x,j,k,E,R,$,V,W)}emplace(d,u,x,j,k,E,R,$,V,W,ee){const ce=10*d;return this.uint16[ce+0]=u,this.uint16[ce+1]=x,this.uint16[ce+2]=j,this.uint16[ce+3]=k,this.uint16[ce+4]=E,this.uint16[ce+5]=R,this.uint16[ce+6]=$,this.uint16[ce+7]=V,this.uint16[ce+8]=W,this.uint16[ce+9]=ee,d}}Ax.prototype.bytesPerElement=20,pr("StructArrayLayout10ui20",Ax);class Nf extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(d,u,x,j,k,E,R,$){const V=this.length;return this.resize(V+1),this.emplace(V,d,u,x,j,k,E,R,$)}emplace(d,u,x,j,k,E,R,$,V){const W=8*d;return this.uint16[W+0]=u,this.uint16[W+1]=x,this.uint16[W+2]=j,this.uint16[W+3]=k,this.uint16[W+4]=E,this.uint16[W+5]=R,this.uint16[W+6]=$,this.uint16[W+7]=V,d}}Nf.prototype.bytesPerElement=16,pr("StructArrayLayout8ui16",Nf);class Aj extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(d,u,x,j,k,E,R,$,V,W,ee,ce){const me=this.length;return this.resize(me+1),this.emplace(me,d,u,x,j,k,E,R,$,V,W,ee,ce)}emplace(d,u,x,j,k,E,R,$,V,W,ee,ce,me){const xe=12*d;return this.int16[xe+0]=u,this.int16[xe+1]=x,this.int16[xe+2]=j,this.int16[xe+3]=k,this.uint16[xe+4]=E,this.uint16[xe+5]=R,this.uint16[xe+6]=$,this.uint16[xe+7]=V,this.int16[xe+8]=W,this.int16[xe+9]=ee,this.int16[xe+10]=ce,this.int16[xe+11]=me,d}}Aj.prototype.bytesPerElement=24,pr("StructArrayLayout4i4ui4i24",Aj);class _h extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(d,u,x){const j=this.length;return this.resize(j+1),this.emplace(j,d,u,x)}emplace(d,u,x,j){const k=3*d;return this.float32[k+0]=u,this.float32[k+1]=x,this.float32[k+2]=j,d}}_h.prototype.bytesPerElement=12,pr("StructArrayLayout3f12",_h);class au extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(d){const u=this.length;return this.resize(u+1),this.emplace(u,d)}emplace(d,u){return this.uint32[1*d+0]=u,d}}au.prototype.bytesPerElement=4,pr("StructArrayLayout1ul4",au);class Tj extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(d,u,x,j,k,E,R,$,V){const W=this.length;return this.resize(W+1),this.emplace(W,d,u,x,j,k,E,R,$,V)}emplace(d,u,x,j,k,E,R,$,V,W){const ee=10*d,ce=5*d;return this.int16[ee+0]=u,this.int16[ee+1]=x,this.int16[ee+2]=j,this.int16[ee+3]=k,this.int16[ee+4]=E,this.int16[ee+5]=R,this.uint32[ce+3]=$,this.uint16[ee+8]=V,this.uint16[ee+9]=W,d}}Tj.prototype.bytesPerElement=20,pr("StructArrayLayout6i1ul2ui20",Tj);class Tx extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(d,u,x,j,k,E){const R=this.length;return this.resize(R+1),this.emplace(R,d,u,x,j,k,E)}emplace(d,u,x,j,k,E,R){const $=6*d;return this.int16[$+0]=u,this.int16[$+1]=x,this.int16[$+2]=j,this.int16[$+3]=k,this.int16[$+4]=E,this.int16[$+5]=R,d}}Tx.prototype.bytesPerElement=12,pr("StructArrayLayout2i2i2i12",Tx);class iu extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(d,u,x,j,k){const E=this.length;return this.resize(E+1),this.emplace(E,d,u,x,j,k)}emplace(d,u,x,j,k,E){const R=4*d,$=8*d;return this.float32[R+0]=u,this.float32[R+1]=x,this.float32[R+2]=j,this.int16[$+6]=k,this.int16[$+7]=E,d}}iu.prototype.bytesPerElement=16,pr("StructArrayLayout2f1f2i16",iu);class Ej extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(d,u,x,j,k,E){const R=this.length;return this.resize(R+1),this.emplace(R,d,u,x,j,k,E)}emplace(d,u,x,j,k,E,R){const $=16*d,V=4*d,W=8*d;return this.uint8[$+0]=u,this.uint8[$+1]=x,this.float32[V+1]=j,this.float32[V+2]=k,this.int16[W+6]=E,this.int16[W+7]=R,d}}Ej.prototype.bytesPerElement=16,pr("StructArrayLayout2ub2f2i16",Ej);class Ex extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(d,u,x){const j=this.length;return this.resize(j+1),this.emplace(j,d,u,x)}emplace(d,u,x,j){const k=3*d;return this.uint16[k+0]=u,this.uint16[k+1]=x,this.uint16[k+2]=j,d}}Ex.prototype.bytesPerElement=6,pr("StructArrayLayout3ui6",Ex);class Mx extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(d,u,x,j,k,E,R,$,V,W,ee,ce,me,xe,Ne,Te,Le){const at=this.length;return this.resize(at+1),this.emplace(at,d,u,x,j,k,E,R,$,V,W,ee,ce,me,xe,Ne,Te,Le)}emplace(d,u,x,j,k,E,R,$,V,W,ee,ce,me,xe,Ne,Te,Le,at){const qe=24*d,Ze=12*d,ht=48*d;return this.int16[qe+0]=u,this.int16[qe+1]=x,this.uint16[qe+2]=j,this.uint16[qe+3]=k,this.uint32[Ze+2]=E,this.uint32[Ze+3]=R,this.uint32[Ze+4]=$,this.uint16[qe+10]=V,this.uint16[qe+11]=W,this.uint16[qe+12]=ee,this.float32[Ze+7]=ce,this.float32[Ze+8]=me,this.uint8[ht+36]=xe,this.uint8[ht+37]=Ne,this.uint8[ht+38]=Te,this.uint32[Ze+10]=Le,this.int16[qe+22]=at,d}}Mx.prototype.bytesPerElement=48,pr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Mx);class Mj extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(d,u,x,j,k,E,R,$,V,W,ee,ce,me,xe,Ne,Te,Le,at,qe,Ze,ht,jt,zt,ar,Gt,rr,kr,Jt){const sr=this.length;return this.resize(sr+1),this.emplace(sr,d,u,x,j,k,E,R,$,V,W,ee,ce,me,xe,Ne,Te,Le,at,qe,Ze,ht,jt,zt,ar,Gt,rr,kr,Jt)}emplace(d,u,x,j,k,E,R,$,V,W,ee,ce,me,xe,Ne,Te,Le,at,qe,Ze,ht,jt,zt,ar,Gt,rr,kr,Jt,sr){const Ot=32*d,zr=16*d;return this.int16[Ot+0]=u,this.int16[Ot+1]=x,this.int16[Ot+2]=j,this.int16[Ot+3]=k,this.int16[Ot+4]=E,this.int16[Ot+5]=R,this.int16[Ot+6]=$,this.int16[Ot+7]=V,this.uint16[Ot+8]=W,this.uint16[Ot+9]=ee,this.uint16[Ot+10]=ce,this.uint16[Ot+11]=me,this.uint16[Ot+12]=xe,this.uint16[Ot+13]=Ne,this.uint16[Ot+14]=Te,this.uint16[Ot+15]=Le,this.uint16[Ot+16]=at,this.uint16[Ot+17]=qe,this.uint16[Ot+18]=Ze,this.uint16[Ot+19]=ht,this.uint16[Ot+20]=jt,this.uint16[Ot+21]=zt,this.uint16[Ot+22]=ar,this.uint32[zr+12]=Gt,this.float32[zr+13]=rr,this.float32[zr+14]=kr,this.uint16[Ot+30]=Jt,this.uint16[Ot+31]=sr,d}}Mj.prototype.bytesPerElement=64,pr("StructArrayLayout8i15ui1ul2f2ui64",Mj);class S extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(d){const u=this.length;return this.resize(u+1),this.emplace(u,d)}emplace(d,u){return this.float32[1*d+0]=u,d}}S.prototype.bytesPerElement=4,pr("StructArrayLayout1f4",S);class l extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(d,u,x){const j=this.length;return this.resize(j+1),this.emplace(j,d,u,x)}emplace(d,u,x,j){const k=3*d;return this.uint16[6*d+0]=u,this.float32[k+1]=x,this.float32[k+2]=j,d}}l.prototype.bytesPerElement=12,pr("StructArrayLayout1ui2f12",l);class m extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(d,u,x){const j=this.length;return this.resize(j+1),this.emplace(j,d,u,x)}emplace(d,u,x,j){const k=4*d;return this.uint32[2*d+0]=u,this.uint16[k+2]=x,this.uint16[k+3]=j,d}}m.prototype.bytesPerElement=8,pr("StructArrayLayout1ul2ui8",m);class v extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(d,u){const x=this.length;return this.resize(x+1),this.emplace(x,d,u)}emplace(d,u,x){const j=2*d;return this.uint16[j+0]=u,this.uint16[j+1]=x,d}}v.prototype.bytesPerElement=4,pr("StructArrayLayout2ui4",v);class _ extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(d){const u=this.length;return this.resize(u+1),this.emplace(u,d)}emplace(d,u){return this.uint16[1*d+0]=u,d}}_.prototype.bytesPerElement=2,pr("StructArrayLayout1ui2",_);class P extends On{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(d,u,x,j){const k=this.length;return this.resize(k+1),this.emplace(k,d,u,x,j)}emplace(d,u,x,j,k){const E=4*d;return this.float32[E+0]=u,this.float32[E+1]=x,this.float32[E+2]=j,this.float32[E+3]=k,d}}P.prototype.bytesPerElement=16,pr("StructArrayLayout4f16",P);class I extends Al{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new f(this.anchorPointX,this.anchorPointY)}}I.prototype.size=20;class z extends Tj{get(d){return new I(this,d)}}pr("CollisionBoxArray",z);class q extends Al{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(d){this._structArray.uint8[this._pos1+37]=d}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(d){this._structArray.uint8[this._pos1+38]=d}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(d){this._structArray.uint32[this._pos4+10]=d}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}q.prototype.size=48;class G extends Mx{get(d){return new q(this,d)}}pr("PlacedSymbolArray",G);class Y extends Al{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(d){this._structArray.uint32[this._pos4+12]=d}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Y.prototype.size=64;class le extends Mj{get(d){return new Y(this,d)}}pr("SymbolInstanceArray",le);class ie extends S{getoffsetX(d){return this.float32[1*d+0]}}pr("GlyphOffsetArray",ie);class fe extends Px{getx(d){return this.int16[3*d+0]}gety(d){return this.int16[3*d+1]}gettileUnitDistanceFromAnchor(d){return this.int16[3*d+2]}}pr("SymbolLineVertexArray",fe);class _e extends Al{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}_e.prototype.size=12;class Ee extends l{get(d){return new _e(this,d)}}pr("TextAnchorOffsetArray",Ee);class Oe extends Al{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Oe.prototype.size=8;class Re extends m{get(d){return new Oe(this,d)}}pr("FeatureIndexArray",Re);class ze extends bh{}class Ue extends bh{}class $e extends bh{}class We extends fc{}class Ye extends kx{}class Be extends nu{}class et extends Ax{}class pt extends Nf{}class ut extends Aj{}class mt extends _h{}class xt extends au{}class Ut extends Tx{}class Wt extends Ej{}class Dt extends Ex{}class jr extends v{}const Hr=Qn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ks}=Hr;class es{constructor(d=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=d}prepareSegment(d,u,x,j){const k=this.segments[this.segments.length-1];return d>es.MAX_VERTEX_ARRAY_LENGTH&&vr(`Max vertices per segment is ${es.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${d}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${es.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!k||k.vertexLength+d>es.MAX_VERTEX_ARRAY_LENGTH||k.sortKey!==j?this.createNewSegment(u,x,j):k}createNewSegment(d,u,x){const j={vertexOffset:d.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0,vaos:{}};return x!==void 0&&(j.sortKey=x),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(j),j}getOrCreateLatestSegment(d,u,x){return this.prepareSegment(0,d,u,x)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const d of this.segments)for(const u in d.vaos)d.vaos[u].destroy()}static simpleSegment(d,u,x,j){return new es([{vertexOffset:d,primitiveOffset:u,vertexLength:x,primitiveLength:j,vaos:{},sortKey:0}])}}function on(h,d){return 256*(h=Vt(Math.floor(h),0,255))+Vt(Math.floor(d),0,255)}es.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,pr("SegmentVector",es);const In=Qn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),un=Qn([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var ga,Sn,Ia,Cn={exports:{}},aa={exports:{}},Ri={exports:{}},ou=function(){if(Ia)return Cn.exports;Ia=1;var h=(ga||(ga=1,aa.exports=function(u,x){var j,k,E,R,$,V,W,ee;for(k=u.length-(j=3&u.length),E=x,$=3432918353,V=461845907,ee=0;ee<k;)W=255&u.charCodeAt(ee)|(255&u.charCodeAt(++ee))<<8|(255&u.charCodeAt(++ee))<<16|(255&u.charCodeAt(++ee))<<24,++ee,E=27492+(65535&(R=5*(65535&(E=(E^=W=(65535&(W=(W=(65535&W)*$+(((W>>>16)*$&65535)<<16)&4294967295)<<15|W>>>17))*V+(((W>>>16)*V&65535)<<16)&4294967295)<<13|E>>>19))+((5*(E>>>16)&65535)<<16)&4294967295))+((58964+(R>>>16)&65535)<<16);switch(W=0,j){case 3:W^=(255&u.charCodeAt(ee+2))<<16;case 2:W^=(255&u.charCodeAt(ee+1))<<8;case 1:E^=W=(65535&(W=(W=(65535&(W^=255&u.charCodeAt(ee)))*$+(((W>>>16)*$&65535)<<16)&4294967295)<<15|W>>>17))*V+(((W>>>16)*V&65535)<<16)&4294967295}return E^=u.length,E=2246822507*(65535&(E^=E>>>16))+((2246822507*(E>>>16)&65535)<<16)&4294967295,E=3266489909*(65535&(E^=E>>>13))+((3266489909*(E>>>16)&65535)<<16)&4294967295,(E^=E>>>16)>>>0}),aa.exports),d=(Sn||(Sn=1,Ri.exports=function(u,x){for(var j,k=u.length,E=x^k,R=0;k>=4;)j=1540483477*(65535&(j=255&u.charCodeAt(R)|(255&u.charCodeAt(++R))<<8|(255&u.charCodeAt(++R))<<16|(255&u.charCodeAt(++R))<<24))+((1540483477*(j>>>16)&65535)<<16),E=1540483477*(65535&E)+((1540483477*(E>>>16)&65535)<<16)^(j=1540483477*(65535&(j^=j>>>24))+((1540483477*(j>>>16)&65535)<<16)),k-=4,++R;switch(k){case 3:E^=(255&u.charCodeAt(R+2))<<16;case 2:E^=(255&u.charCodeAt(R+1))<<8;case 1:E=1540483477*(65535&(E^=255&u.charCodeAt(R)))+((1540483477*(E>>>16)&65535)<<16)}return E=1540483477*(65535&(E^=E>>>13))+((1540483477*(E>>>16)&65535)<<16),(E^=E>>>15)>>>0}),Ri.exports);return Cn.exports=h,Cn.exports.murmur3=h,Cn.exports.murmur2=d,Cn.exports}(),pc=p(ou);class Tl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(d,u,x,j){this.ids.push(lu(d)),this.positions.push(u,x,j)}getPositions(d){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const u=lu(d);let x=0,j=this.ids.length-1;for(;x<j;){const E=x+j>>1;this.ids[E]>=u?j=E:x=E+1}const k=[];for(;this.ids[x]===u;)k.push({index:this.positions[3*x],start:this.positions[3*x+1],end:this.positions[3*x+2]}),x++;return k}static serialize(d,u){const x=new Float64Array(d.ids),j=new Uint32Array(d.positions);return wh(x,j,0,x.length-1),u&&u.push(x.buffer,j.buffer),{ids:x,positions:j}}static deserialize(d){const u=new Tl;return u.ids=d.ids,u.positions=d.positions,u.indexed=!0,u}}function lu(h){const d=+h;return!isNaN(d)&&d<=Number.MAX_SAFE_INTEGER?d:pc(String(h))}function wh(h,d,u,x){for(;u<x;){const j=h[u+x>>1];let k=u-1,E=x+1;for(;;){do k++;while(h[k]<j);do E--;while(h[E]>j);if(k>=E)break;cu(h,k,E),cu(d,3*k,3*E),cu(d,3*k+1,3*E+1),cu(d,3*k+2,3*E+2)}E-u<x-E?(wh(h,d,u,E),u=E+1):(wh(h,d,E+1,x),x=E)}}function cu(h,d,u){const x=h[d];h[d]=h[u],h[u]=x}pr("FeaturePositionMap",Tl);class eo{constructor(d,u){this.gl=d.gl,this.location=u}}class Li extends eo{constructor(d,u){super(d,u),this.current=0}set(d){this.current!==d&&(this.current=d,this.gl.uniform1f(this.location,d))}}class xc extends eo{constructor(d,u){super(d,u),this.current=[0,0,0,0]}set(d){d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]&&d[3]===this.current[3]||(this.current=d,this.gl.uniform4f(this.location,d[0],d[1],d[2],d[3]))}}class id extends eo{constructor(d,u){super(d,u),this.current=Kr.transparent}set(d){d.r===this.current.r&&d.g===this.current.g&&d.b===this.current.b&&d.a===this.current.a||(this.current=d,this.gl.uniform4f(this.location,d.r,d.g,d.b,d.a))}}const Sf=new Float32Array(16);function ia(h){return[on(255*h.r,255*h.g),on(255*h.b,255*h.a)]}class Jn{constructor(d,u,x){this.value=d,this.uniformNames=u.map(j=>`u_${j}`),this.type=x}setUniform(d,u,x){d.set(x.constantOr(this.value))}getBinding(d,u,x){return this.type==="color"?new id(d,u):new Li(d,u)}}class Da{constructor(d,u){this.uniformNames=u.map(x=>`u_${x}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(d,u){this.pixelRatioFrom=u.pixelRatio,this.pixelRatioTo=d.pixelRatio,this.patternFrom=u.tlbr,this.patternTo=d.tlbr}setConstantDashPositions(d,u){this.dashTo=[0,d.y,d.height,d.width],this.dashFrom=[0,u.y,u.height,u.width]}setUniform(d,u,x,j){let k=null;j==="u_pattern_to"?k=this.patternTo:j==="u_pattern_from"?k=this.patternFrom:j==="u_dasharray_to"?k=this.dashTo:j==="u_dasharray_from"?k=this.dashFrom:j==="u_pixel_ratio_to"?k=this.pixelRatioTo:j==="u_pixel_ratio_from"&&(k=this.pixelRatioFrom),k!==null&&d.set(k)}getBinding(d,u,x){return x.substr(0,9)==="u_pattern"||x.substr(0,12)==="u_dasharray_"?new xc(d,u):new Li(d,u)}}class yn{constructor(d,u,x,j){this.expression=d,this.type=x,this.maxValue=0,this.paintVertexAttributes=u.map(k=>({name:`a_${k}`,type:"Float32",components:x==="color"?2:1,offset:0})),this.paintVertexArray=new j}populatePaintArray(d,u,x){const j=this.paintVertexArray.length,k=this.expression.evaluate(new an(0,x),u,{},x.canonical,[],x.formattedSection);this.paintVertexArray.resize(d),this._setPaintValue(j,d,k)}updatePaintArray(d,u,x,j,k){const E=this.expression.evaluate(new an(0,k),x,j);this._setPaintValue(d,u,E)}_setPaintValue(d,u,x){if(this.type==="color"){const j=ia(x);for(let k=d;k<u;k++)this.paintVertexArray.emplace(k,j[0],j[1])}else{for(let j=d;j<u;j++)this.paintVertexArray.emplace(j,x);this.maxValue=Math.max(this.maxValue,Math.abs(x))}}upload(d){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=d.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class tl{constructor(d,u,x,j,k,E){this.expression=d,this.uniformNames=u.map(R=>`u_${R}_t`),this.type=x,this.useIntegerZoom=j,this.zoom=k,this.maxValue=0,this.paintVertexAttributes=u.map(R=>({name:`a_${R}`,type:"Float32",components:x==="color"?4:2,offset:0})),this.paintVertexArray=new E}populatePaintArray(d,u,x){const j=this.expression.evaluate(new an(this.zoom,x),u,{},x.canonical,[],x.formattedSection),k=this.expression.evaluate(new an(this.zoom+1,x),u,{},x.canonical,[],x.formattedSection),E=this.paintVertexArray.length;this.paintVertexArray.resize(d),this._setPaintValue(E,d,j,k)}updatePaintArray(d,u,x,j,k){const E=this.expression.evaluate(new an(this.zoom,k),x,j),R=this.expression.evaluate(new an(this.zoom+1,k),x,j);this._setPaintValue(d,u,E,R)}_setPaintValue(d,u,x,j){if(this.type==="color"){const k=ia(x),E=ia(j);for(let R=d;R<u;R++)this.paintVertexArray.emplace(R,k[0],k[1],E[0],E[1])}else{for(let k=d;k<u;k++)this.paintVertexArray.emplace(k,x,j);this.maxValue=Math.max(this.maxValue,Math.abs(x),Math.abs(j))}}upload(d){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=d.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(d,u){const x=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,j=Vt(this.expression.interpolationFactor(x,this.zoom,this.zoom+1),0,1);d.set(j)}getBinding(d,u,x){return new Li(d,u)}}class od{constructor(d,u,x,j,k,E){this.expression=d,this.type=u,this.useIntegerZoom=x,this.zoom=j,this.layerId=E,this.zoomInPaintVertexArray=new k,this.zoomOutPaintVertexArray=new k}populatePaintArray(d,u,x){const j=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(d),this.zoomOutPaintVertexArray.resize(d),this._setPaintValues(j,d,this.getPositionIds(u),x)}updatePaintArray(d,u,x,j,k){this._setPaintValues(d,u,this.getPositionIds(x),k)}_setPaintValues(d,u,x,j){const k=this.getPositions(j);if(!k||!x)return;const E=k[x.min],R=k[x.mid],$=k[x.max];if(E&&R&&$)for(let V=d;V<u;V++)this.emplace(this.zoomInPaintVertexArray,V,R,E),this.emplace(this.zoomOutPaintVertexArray,V,R,$)}upload(d){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const u=this.getVertexAttributes();this.zoomInPaintVertexBuffer=d.createVertexBuffer(this.zoomInPaintVertexArray,u,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=d.createVertexBuffer(this.zoomOutPaintVertexArray,u,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class c1 extends od{getPositions(d){return d.imagePositions}getPositionIds(d){return d.patterns&&d.patterns[this.layerId]}getVertexAttributes(){return In.members}emplace(d,u,x,j){d.emplace(u,x.tlbr[0],x.tlbr[1],x.tlbr[2],x.tlbr[3],j.tlbr[0],j.tlbr[1],j.tlbr[2],j.tlbr[3],x.pixelRatio,j.pixelRatio)}}class d1 extends od{getPositions(d){return d.dashPositions}getPositionIds(d){return d.dashes&&d.dashes[this.layerId]}getVertexAttributes(){return un.members}emplace(d,u,x,j){d.emplace(u,0,x.y,x.height,x.width,0,j.y,j.height,j.width)}}class u1{constructor(d,u,x){this.binders={},this._buffers=[];const j=[];for(const k in d.paint._values){if(!x(k))continue;const E=d.paint.get(k);if(!(E instanceof Jo&&ph(E.property.specification)))continue;const R=uu(k,d.type),$=E.value,V=E.property.specification.type,W=E.property.useIntegerZoom,ee=E.property.specification["property-type"],ce=ee==="cross-faded"||ee==="cross-faded-data-driven";if($.kind==="constant")this.binders[k]=ce?new Da($.value,R):new Jn($.value,R,V),j.push(`/u_${k}`);else if($.kind==="source"||ce){const me=Oj(k,V,"source");this.binders[k]=ce?k==="line-dasharray"?new d1($,V,W,u,me,d.id):new c1($,V,W,u,me,d.id):new yn($,R,V,me),j.push(`/a_${k}`)}else{const me=Oj(k,V,"composite");this.binders[k]=new tl($,R,V,W,u,me),j.push(`/z_${k}`)}}this.cacheKey=j.sort().join("")}getMaxValue(d){const u=this.binders[d];return u instanceof yn||u instanceof tl?u.maxValue:0}populatePaintArrays(d,u,x){for(const j in this.binders){const k=this.binders[j];(k instanceof yn||k instanceof tl||k instanceof od)&&k.populatePaintArray(d,u,x)}}setConstantPatternPositions(d,u){for(const x in this.binders){const j=this.binders[x];j instanceof Da&&j.setConstantPatternPositions(d,u)}}setConstantDashPositions(d,u){for(const x in this.binders){const j=this.binders[x];j instanceof Da&&j.setConstantDashPositions(d,u)}}updatePaintArrays(d,u,x,j,k){let E=!1;for(const R in d){const $=u.getPositions(R);for(const V of $){const W=x.feature(V.index);for(const ee in this.binders){const ce=this.binders[ee];if((ce instanceof yn||ce instanceof tl||ce instanceof od)&&ce.expression.isStateDependent===!0){const me=j.paint.get(ee);ce.expression=me.value,ce.updatePaintArray(V.start,V.end,W,d[R],k),E=!0}}}}return E}defines(){const d=[];for(const u in this.binders){const x=this.binders[u];(x instanceof Jn||x instanceof Da)&&d.push(...x.uniformNames.map(j=>`#define HAS_UNIFORM_${j}`))}return d}getBinderAttributes(){const d=[];for(const u in this.binders){const x=this.binders[u];if(x instanceof yn||x instanceof tl)for(let j=0;j<x.paintVertexAttributes.length;j++)d.push(x.paintVertexAttributes[j].name);else if(x instanceof od){const j=x.getVertexAttributes();for(const k of j)d.push(k.name)}}return d}getBinderUniforms(){const d=[];for(const u in this.binders){const x=this.binders[u];if(x instanceof Jn||x instanceof Da||x instanceof tl)for(const j of x.uniformNames)d.push(j)}return d}getPaintVertexBuffers(){return this._buffers}getUniforms(d,u){const x=[];for(const j in this.binders){const k=this.binders[j];if(k instanceof Jn||k instanceof Da||k instanceof tl){for(const E of k.uniformNames)if(u[E]){const R=k.getBinding(d,u[E],E);x.push({name:E,property:j,binding:R})}}}return x}setUniforms(d,u,x,j){for(const{name:k,property:E,binding:R}of u)this.binders[E].setUniform(R,j,x.get(E),k)}updatePaintBuffers(d){this._buffers=[];for(const u in this.binders){const x=this.binders[u];if(d&&x instanceof od){const j=d.fromScale===2?x.zoomInPaintVertexBuffer:x.zoomOutPaintVertexBuffer;j&&this._buffers.push(j)}else(x instanceof yn||x instanceof tl)&&x.paintVertexBuffer&&this._buffers.push(x.paintVertexBuffer)}}upload(d){for(const u in this.binders){const x=this.binders[u];(x instanceof yn||x instanceof tl||x instanceof od)&&x.upload(d)}this.updatePaintBuffers()}destroy(){for(const d in this.binders){const u=this.binders[d];(u instanceof yn||u instanceof tl||u instanceof od)&&u.destroy()}}}class du{constructor(d,u,x=()=>!0){this.programConfigurations={};for(const j of d)this.programConfigurations[j.id]=new u1(j,u,x);this.needsUpload=!1,this._featureMap=new Tl,this._bufferOffset=0}populatePaintArrays(d,u,x,j){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(d,u,j);u.id!==void 0&&this._featureMap.add(u.id,x,this._bufferOffset,d),this._bufferOffset=d,this.needsUpload=!0}updatePaintArrays(d,u,x,j){for(const k of x)this.needsUpload=this.programConfigurations[k.id].updatePaintArrays(d,this._featureMap,u,k,j)||this.needsUpload}get(d){return this.programConfigurations[d]}upload(d){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(d);this.needsUpload=!1}}destroy(){for(const d in this.programConfigurations)this.programConfigurations[d].destroy()}}function uu(h,d){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[h]||[h.replace(`${d}-`,"").replace(/-/g,"_")]}function Oj(h,d,u){const x={color:{source:nu,composite:P},number:{source:S,composite:nu}},j=function(k){return{"line-pattern":{source:et,composite:et},"fill-pattern":{source:et,composite:et},"fill-extrusion-pattern":{source:et,composite:et},"line-dasharray":{source:pt,composite:pt}}[k]}(h);return j&&j[u]||x[d][u]}pr("ConstantBinder",Jn),pr("CrossFadedConstantBinder",Da),pr("SourceExpressionBinder",yn),pr("CrossFadedPatternBinder",c1),pr("CrossFadedDasharrayBinder",d1),pr("CompositeExpressionBinder",tl),pr("ProgramConfiguration",u1,{omit:["_buffers"]}),pr("ProgramConfigurationSet",du);const Ox=Math.pow(2,14)-1,Ij=-Ox-1;function gc(h){const d=de/h.extent,u=h.loadGeometry();for(let x=0;x<u.length;x++){const j=u[x];for(let k=0;k<j.length;k++){const E=j[k],R=Math.round(E.x*d),$=Math.round(E.y*d);E.x=Vt(R,Ij,Ox),E.y=Vt($,Ij,Ox),(R<E.x||R>E.x+1||$<E.y||$>E.y+1)&&vr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return u}function ld(h,d){return{type:h.type,id:h.id,properties:h.properties,geometry:d?gc(h):[]}}const Ix=-32768;function zQ(h,d,u,x,j){h.emplaceBack(Ix+8*d+x,Ix+8*u+j)}class hk{constructor(d){this.zoom=d.zoom,this.overscaling=d.overscaling,this.layers=d.layers,this.layerIds=this.layers.map(u=>u.id),this.index=d.index,this.hasDependencies=!1,this.layoutVertexArray=new Ue,this.indexArray=new Dt,this.segments=new es,this.programConfigurations=new du(d.layers,d.zoom),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(d,u,x){const j=this.layers[0],k=[];let E=null,R=!1,$=j.type==="heatmap";if(j.type==="circle"){const W=j;E=W.layout.get("circle-sort-key"),R=!E.isConstant(),$=$||W.paint.get("circle-pitch-alignment")==="map"}const V=$?u.subdivisionGranularity.circle:1;for(const{feature:W,id:ee,index:ce,sourceLayerIndex:me}of d){const xe=this.layers[0]._featureFilter.needGeometry,Ne=ld(W,xe);if(!this.layers[0]._featureFilter.filter(new an(this.zoom),Ne,x))continue;const Te=R?E.evaluate(Ne,{},x):void 0,Le={id:ee,properties:W.properties,type:W.type,sourceLayerIndex:me,index:ce,geometry:xe?Ne.geometry:gc(W),patterns:{},sortKey:Te};k.push(Le)}R&&k.sort((W,ee)=>W.sortKey-ee.sortKey);for(const W of k){const{geometry:ee,index:ce,sourceLayerIndex:me}=W,xe=d[ce].feature;this.addFeature(W,ee,ce,x,V),u.featureIndex.insert(xe,ee,ce,me,this.index)}}update(d,u,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(d,u,this.stateDependentLayers,{imagePositions:x})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(d){this.uploaded||(this.layoutVertexBuffer=d.createVertexBuffer(this.layoutVertexArray,Ks),this.indexBuffer=d.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(d),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(d,u,x,j,k=1){let E;switch(k){case 1:E=[0,7];break;case 3:E=[0,2,5,7];break;case 5:E=[0,1,3,4,6,7];break;case 7:E=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${k}; valid values are 1, 3, 5, 7.`)}const R=E.length;for(const $ of u)for(const V of $){const W=V.x,ee=V.y;if(W<0||W>=de||ee<0||ee>=de)continue;const ce=this.segments.prepareSegment(R*R,this.layoutVertexArray,this.indexArray,d.sortKey),me=ce.vertexLength;for(let xe=0;xe<R;xe++)for(let Ne=0;Ne<R;Ne++)zQ(this.layoutVertexArray,W,ee,E[Ne],E[xe]);for(let xe=0;xe<R-1;xe++)for(let Ne=0;Ne<R-1;Ne++){const Te=me+xe*R+Ne,Le=me+(xe+1)*R+Ne;this.indexArray.emplaceBack(Te,Le+1,Te+1),this.indexArray.emplaceBack(Te,Le,Le+1)}ce.vertexLength+=R*R,ce.primitiveLength+=(R-1)*(R-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,d,x,{imagePositions:{},canonical:j})}}function kR(h,d){for(let u=0;u<h.length;u++)if(Dx(d,h[u]))return!0;for(let u=0;u<d.length;u++)if(Dx(h,d[u]))return!0;return!!mk(h,d)}function h1(h,d,u){return!!Dx(h,d)||!!fk(d,h,u)}function AR(h,d){if(h.length===1)return ER(d,h[0]);for(let u=0;u<d.length;u++){const x=d[u];for(let j=0;j<x.length;j++)if(Dx(h,x[j]))return!0}for(let u=0;u<h.length;u++)if(ER(d,h[u]))return!0;for(let u=0;u<d.length;u++)if(mk(h,d[u]))return!0;return!1}function BQ(h,d,u){if(h.length>1){if(mk(h,d))return!0;for(let x=0;x<d.length;x++)if(fk(d[x],h,u))return!0}for(let x=0;x<h.length;x++)if(fk(h[x],d,u))return!0;return!1}function mk(h,d){if(h.length===0||d.length===0)return!1;for(let u=0;u<h.length-1;u++){const x=h[u],j=h[u+1];for(let k=0;k<d.length-1;k++)if(qQ(x,j,d[k],d[k+1]))return!0}return!1}function qQ(h,d,u,x){return Xr(h,u,x)!==Xr(d,u,x)&&Xr(h,d,u)!==Xr(h,d,x)}function fk(h,d,u){const x=u*u;if(d.length===1)return h.distSqr(d[0])<x;for(let j=1;j<d.length;j++)if(TR(h,d[j-1],d[j])<x)return!0;return!1}function TR(h,d,u){const x=d.distSqr(u);if(x===0)return h.distSqr(d);const j=((h.x-d.x)*(u.x-d.x)+(h.y-d.y)*(u.y-d.y))/x;return h.distSqr(j<0?d:j>1?u:u.sub(d)._mult(j)._add(d))}function ER(h,d){let u,x,j,k=!1;for(let E=0;E<h.length;E++){u=h[E];for(let R=0,$=u.length-1;R<u.length;$=R++)x=u[R],j=u[$],x.y>d.y!=j.y>d.y&&d.x<(j.x-x.x)*(d.y-x.y)/(j.y-x.y)+x.x&&(k=!k)}return k}function Dx(h,d){let u=!1;for(let x=0,j=h.length-1;x<h.length;j=x++){const k=h[x],E=h[j];k.y>d.y!=E.y>d.y&&d.x<(E.x-k.x)*(d.y-k.y)/(E.y-k.y)+k.x&&(u=!u)}return u}function VQ(h,d,u){const x=u[0],j=u[2];if(h.x<x.x&&d.x<x.x||h.x>j.x&&d.x>j.x||h.y<x.y&&d.y<x.y||h.y>j.y&&d.y>j.y)return!1;const k=Xr(h,d,u[0]);return k!==Xr(h,d,u[1])||k!==Xr(h,d,u[2])||k!==Xr(h,d,u[3])}function Rx(h,d,u){const x=d.paint.get(h).value;return x.kind==="constant"?x.value:u.programConfigurations.get(d.id).getMaxValue(h)}function m1(h){return Math.sqrt(h[0]*h[0]+h[1]*h[1])}function f1(h,d,u,x,j){if(!d[0]&&!d[1])return h;const k=f.convert(d)._mult(j);u==="viewport"&&k._rotate(-x);const E=[];for(let R=0;R<h.length;R++)E.push(h[R].sub(k));return E}function UQ({queryGeometry:h,size:d},u){return h1(h,u,d)}function WQ({queryGeometry:h,size:d,transform:u,unwrappedTileID:x,getElevation:j},k){return h1(h,k,d*(u.projectTileCoordinates(k.x,k.y,x,j).signedDistanceFromCamera/u.cameraToCenterDistance))}function GQ({queryGeometry:h,size:d,transform:u,unwrappedTileID:x,getElevation:j},k){const E=u.projectTileCoordinates(k.x,k.y,x,j).signedDistanceFromCamera,R=d*(u.cameraToCenterDistance/E);return h1(h,pk(k,u,x,j),R)}function KQ({queryGeometry:h,size:d,transform:u,unwrappedTileID:x,getElevation:j},k){return h1(h,pk(k,u,x,j),d)}function MR({queryGeometry:h,size:d,transform:u,unwrappedTileID:x,getElevation:j,pitchAlignment:k="map",pitchScale:E="map"},R){const $=k==="map"?E==="map"?UQ:WQ:E==="map"?GQ:KQ,V={queryGeometry:h,size:d,transform:u,unwrappedTileID:x,getElevation:j};for(const W of R)for(const ee of W)if($(V,ee))return!0;return!1}function pk(h,d,u,x){const j=d.projectTileCoordinates(h.x,h.y,u,x).point;return new f((.5*j.x+.5)*d.width,(.5*-j.y+.5)*d.height)}let OR,IR;pr("CircleBucket",hk,{omit:["layers"]});var HQ={get paint(){return IR=IR||new gi({"circle-radius":new Lr(ot.paint_circle["circle-radius"]),"circle-color":new Lr(ot.paint_circle["circle-color"]),"circle-blur":new Lr(ot.paint_circle["circle-blur"]),"circle-opacity":new Lr(ot.paint_circle["circle-opacity"]),"circle-translate":new Nr(ot.paint_circle["circle-translate"]),"circle-translate-anchor":new Nr(ot.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Nr(ot.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Nr(ot.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Lr(ot.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Lr(ot.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Lr(ot.paint_circle["circle-stroke-opacity"])})},get layout(){return OR=OR||new gi({"circle-sort-key":new Lr(ot.layout_circle["circle-sort-key"])})}};class ZQ extends el{constructor(d,u){super(d,HQ,u)}createBucket(d){return new hk(d)}queryRadius(d){const u=d;return Rx("circle-radius",this,u)+Rx("circle-stroke-width",this,u)+m1(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:d,feature:u,featureState:x,geometry:j,transform:k,pixelsToTileUnits:E,unwrappedTileID:R,getElevation:$}){const V=f1(d,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-k.bearingInRadians,E),W=this.paint.get("circle-radius").evaluate(u,x)+this.paint.get("circle-stroke-width").evaluate(u,x),ee=this.paint.get("circle-pitch-scale"),ce=this.paint.get("circle-pitch-alignment");let me,xe;return ce==="map"?(me=V,xe=W*E):(me=function(Ne,Te,Le,at){return Ne.map(qe=>pk(qe,Te,Le,at))}(V,k,R,$),xe=W),MR({queryGeometry:me,size:xe,transform:k,unwrappedTileID:R,getElevation:$,pitchAlignment:ce,pitchScale:ee},j)}}class DR extends hk{}let RR;pr("HeatmapBucket",DR,{omit:["layers"]});var YQ={get paint(){return RR=RR||new gi({"heatmap-radius":new Lr(ot.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Lr(ot.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Nr(ot.paint_heatmap["heatmap-intensity"]),"heatmap-color":new wf(ot.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Nr(ot.paint_heatmap["heatmap-opacity"])})}};function xk(h,{width:d,height:u},x,j){if(j){if(j instanceof Uint8ClampedArray)j=new Uint8Array(j.buffer);else if(j.length!==d*u*x)throw new RangeError(`mismatched image size. expected: ${j.length} but got: ${d*u*x}`)}else j=new Uint8Array(d*u*x);return h.width=d,h.height=u,h.data=j,h}function LR(h,{width:d,height:u},x){if(d===h.width&&u===h.height)return;const j=xk({},{width:d,height:u},x);gk(h,j,{x:0,y:0},{x:0,y:0},{width:Math.min(h.width,d),height:Math.min(h.height,u)},x),h.width=d,h.height=u,h.data=j.data}function gk(h,d,u,x,j,k){if(j.width===0||j.height===0)return d;if(j.width>h.width||j.height>h.height||u.x>h.width-j.width||u.y>h.height-j.height)throw new RangeError("out of range source coordinates for image copy");if(j.width>d.width||j.height>d.height||x.x>d.width-j.width||x.y>d.height-j.height)throw new RangeError("out of range destination coordinates for image copy");const E=h.data,R=d.data;if(E===R)throw new Error("srcData equals dstData, so image is already copied");for(let $=0;$<j.height;$++){const V=((u.y+$)*h.width+u.x)*k,W=((x.y+$)*d.width+x.x)*k;for(let ee=0;ee<j.width*k;ee++)R[W+ee]=E[V+ee]}return d}class Dj{constructor(d,u){xk(this,d,1,u)}resize(d){LR(this,d,1)}clone(){return new Dj({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(d,u,x,j,k){gk(d,u,x,j,k,1)}}class po{constructor(d,u){xk(this,d,4,u)}resize(d){LR(this,d,4)}replace(d,u){u?this.data.set(d):this.data=d instanceof Uint8ClampedArray?new Uint8Array(d.buffer):d}clone(){return new po({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(d,u,x,j,k){gk(d,u,x,j,k,4)}setPixel(d,u,x){const j=4*(d*this.width+u);this.data[j+0]=Math.round(255*x.r/x.a),this.data[j+1]=Math.round(255*x.g/x.a),this.data[j+2]=Math.round(255*x.b/x.a),this.data[j+3]=Math.round(255*x.a)}}function FR(h){const d={},u=h.resolution||256,x=h.clips?h.clips.length:1,j=h.image||new po({width:u,height:x});if(Math.log(u)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${u}`);const k=(E,R,$)=>{d[h.evaluationKey]=$;const V=h.expression.evaluate(d);j.setPixel(E/4/u,R/4,V)};if(h.clips)for(let E=0,R=0;E<x;++E,R+=4*u)for(let $=0,V=0;$<u;$++,V+=4){const W=$/(u-1),{start:ee,end:ce}=h.clips[E];k(R,V,ee*(1-W)+ce*W)}else for(let E=0,R=0;E<u;E++,R+=4)k(0,R,E/(u-1));return j}pr("AlphaImage",Dj),pr("RGBAImage",po);const yk="big-fb";class XQ extends el{createBucket(d){return new DR(d)}constructor(d,u){super(d,YQ,u),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(d){d==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=FR({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(yk)&&this.heatmapFbos.delete(yk)}queryRadius(d){return Rx("heatmap-radius",this,d)}queryIntersectsFeature({queryGeometry:d,feature:u,featureState:x,geometry:j,transform:k,pixelsToTileUnits:E,unwrappedTileID:R,getElevation:$}){return MR({queryGeometry:d,size:this.paint.get("heatmap-radius").evaluate(u,x)*E,transform:k,unwrappedTileID:R,getElevation:$},j)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let $R;var QQ={get paint(){return $R=$R||new gi({"hillshade-illumination-direction":new Nr(ot.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Nr(ot.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Nr(ot.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Nr(ot.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Nr(ot.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Nr(ot.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Nr(ot.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Nr(ot.paint_hillshade["hillshade-method"])})}};class JQ extends el{constructor(d,u){super(d,QQ,u),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let d=this.paint.get("hillshade-illumination-direction").values,u=this.paint.get("hillshade-illumination-altitude").values,x=this.paint.get("hillshade-highlight-color").values,j=this.paint.get("hillshade-shadow-color").values;const k=Math.max(d.length,u.length,x.length,j.length);d=d.concat(Array(k-d.length).fill(d.at(-1))),u=u.concat(Array(k-u.length).fill(u.at(-1))),x=x.concat(Array(k-x.length).fill(x.at(-1))),j=j.concat(Array(k-j.length).fill(j.at(-1)));const E=u.map(Bt);return{directionRadians:d.map(Bt),altitudeRadians:E,shadowColor:j,highlightColor:x}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let zR;var eJ={get paint(){return zR=zR||new gi({"color-relief-opacity":new Nr(ot["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new wf(ot["paint_color-relief"]["color-relief-color"])})}};class vk{constructor(d,u,x,j){this.context=d,this.format=x,this.texture=d.gl.createTexture(),this.update(u,j)}update(d,u,x){const{width:j,height:k}=d,E=!(this.size&&this.size[0]===j&&this.size[1]===k||x),{context:R}=this,{gl:$}=R;if(this.useMipmap=!!(u&&u.useMipmap),$.bindTexture($.TEXTURE_2D,this.texture),R.pixelStoreUnpackFlipY.set(!1),R.pixelStoreUnpack.set(1),R.pixelStoreUnpackPremultiplyAlpha.set(this.format===$.RGBA&&(!u||u.premultiply!==!1)),E)this.size=[j,k],d instanceof HTMLImageElement||d instanceof HTMLCanvasElement||d instanceof HTMLVideoElement||d instanceof ImageData||Qs(d)?$.texImage2D($.TEXTURE_2D,0,this.format,this.format,$.UNSIGNED_BYTE,d):$.texImage2D($.TEXTURE_2D,0,this.format,j,k,0,this.format,$.UNSIGNED_BYTE,d.data);else{const{x:V,y:W}=x||{x:0,y:0};d instanceof HTMLImageElement||d instanceof HTMLCanvasElement||d instanceof HTMLVideoElement||d instanceof ImageData||Qs(d)?$.texSubImage2D($.TEXTURE_2D,0,V,W,$.RGBA,$.UNSIGNED_BYTE,d):$.texSubImage2D($.TEXTURE_2D,0,V,W,j,k,$.RGBA,$.UNSIGNED_BYTE,d.data)}this.useMipmap&&this.isSizePowerOfTwo()&&$.generateMipmap($.TEXTURE_2D),R.pixelStoreUnpackFlipY.setDefault(),R.pixelStoreUnpack.setDefault(),R.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(d,u,x){const{context:j}=this,{gl:k}=j;k.bindTexture(k.TEXTURE_2D,this.texture),x!==k.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(x=k.LINEAR),d!==this.filter&&(k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,d),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,x||d),this.filter=d),u!==this.wrap&&(k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,u),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:d}=this.context;d.deleteTexture(this.texture),this.texture=null}}class BR{constructor(d,u,x,j=1,k=1,E=1,R=0){if(this.uid=d,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(x&&!["mapbox","terrarium","custom"].includes(x))return void vr(`"${x}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=u.height;const $=this.dim=u.height-2;switch(this.data=new Uint32Array(u.data.buffer),x){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=j,this.greenFactor=k,this.blueFactor=E,this.baseShift=R;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let V=0;V<$;V++)this.data[this._idx(-1,V)]=this.data[this._idx(0,V)],this.data[this._idx($,V)]=this.data[this._idx($-1,V)],this.data[this._idx(V,-1)]=this.data[this._idx(V,0)],this.data[this._idx(V,$)]=this.data[this._idx(V,$-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx($,-1)]=this.data[this._idx($-1,0)],this.data[this._idx(-1,$)]=this.data[this._idx(0,$-1)],this.data[this._idx($,$)]=this.data[this._idx($-1,$-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let V=0;V<$;V++)for(let W=0;W<$;W++){const ee=this.get(V,W);ee>this.max&&(this.max=ee),ee<this.min&&(this.min=ee)}}get(d,u){const x=new Uint8Array(this.data.buffer),j=4*this._idx(d,u);return this.unpack(x[j],x[j+1],x[j+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(d,u){if(d<-1||d>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(d+1)}unpack(d,u,x){return d*this.redFactor+u*this.greenFactor+x*this.blueFactor-this.baseShift}pack(d){return qR(d,this.getUnpackVector())}getPixels(){return new po({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(d,u,x){if(this.dim!==d.dim)throw new Error("dem dimension mismatch");let j=u*this.dim,k=u*this.dim+this.dim,E=x*this.dim,R=x*this.dim+this.dim;switch(u){case-1:j=k-1;break;case 1:k=j+1}switch(x){case-1:E=R-1;break;case 1:R=E+1}const $=-u*this.dim,V=-x*this.dim;for(let W=E;W<R;W++)for(let ee=j;ee<k;ee++)this.data[this._idx(ee,W)]=d.data[this._idx(ee+$,W+V)]}}function qR(h,d){const u=d[0],x=d[1],j=d[2],k=d[3],E=Math.min(u,x,j),R=Math.round((h+k)/E);return{r:Math.floor(R*E/u)%256,g:Math.floor(R*E/x)%256,b:Math.floor(R*E/j)%256}}pr("DEMData",BR);class tJ extends el{constructor(d,u){super(d,eJ,u)}_createColorRamp(d){const u={elevationStops:[],colorStops:[]},x=this._transitionablePaint._values["color-relief-color"].value.expression;if(x instanceof ff&&x._styleExpression.expression instanceof Gs){this.colorRampExpression=x;const E=x._styleExpression.expression;u.elevationStops=E.labels,u.colorStops=[];for(const R of u.elevationStops)u.colorStops.push(E.evaluate({globals:{elevation:R}}))}if(u.elevationStops.length<1&&(u.elevationStops=[0],u.colorStops=[Kr.transparent]),u.elevationStops.length<2&&(u.elevationStops.push(u.elevationStops[0]+1),u.colorStops.push(u.colorStops[0])),u.elevationStops.length<=d)return u;const j={elevationStops:[],colorStops:[]},k=(u.elevationStops.length-1)/(d-1);for(let E=0;E<u.elevationStops.length-.5;E+=k)j.elevationStops.push(u.elevationStops[Math.round(E)]),j.colorStops.push(u.colorStops[Math.round(E)]);return vr(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${d}, provided: ${u.elevationStops.length}`),j}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(d,u,x){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const j=this._createColorRamp(u),k=new po({width:j.colorStops.length,height:1}),E=new po({width:j.colorStops.length,height:1});for(let R=0;R<j.elevationStops.length;R++){const $=qR(j.elevationStops[R],x);E.setPixel(0,R,new Kr($.r/255,$.g/255,$.b/255,1)),k.setPixel(0,R,j.colorStops[R])}return this.colorRampTextures={elevationTexture:new vk(d,E,d.gl.RGBA),colorTexture:new vk(d,k,d.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const rJ=Qn([{name:"a_pos",components:2,type:"Int16"}],4),{members:sJ}=rJ;function p1(h,d,u){const x=u.patternDependencies;let j=!1;for(const k of d){const E=k.paint.get(`${h}-pattern`);E.isConstant()||(j=!0);const R=E.constantOr(null);R&&(j=!0,x[R.to]=!0,x[R.from]=!0)}return j}function jk(h,d,u,x,j){const{zoom:k}=x,E=j.patternDependencies;for(const R of d){const $=R.paint.get(`${h}-pattern`).value;if($.kind!=="constant"){let V=$.evaluate({zoom:k-1},u,{},j.availableImages),W=$.evaluate({zoom:k},u,{},j.availableImages),ee=$.evaluate({zoom:k+1},u,{},j.availableImages);V=V&&V.name?V.name:V,W=W&&W.name?W.name:W,ee=ee&&ee.name?ee.name:ee,E[V]=!0,E[W]=!0,E[ee]=!0,u.patterns[R.id]={min:V,mid:W,max:ee}}}return u}function VR(h,d,u,x,j){let k;if(j===function(E,R,$,V){let W=0;for(let ee=R,ce=$-V;ee<$;ee+=V)W+=(E[ce]-E[ee])*(E[ee+1]+E[ce+1]),ce=ee;return W}(h,d,u,x)>0)for(let E=d;E<u;E+=x)k=KR(E/x|0,h[E],h[E+1],k);else for(let E=u-x;E>=d;E-=x)k=KR(E/x|0,h[E],h[E+1],k);return k&&Lx(k,k.next)&&($j(k),k=k.next),k}function Cf(h,d){if(!h)return h;d||(d=h);let u,x=h;do if(u=!1,x.steiner||!Lx(x,x.next)&&oa(x.prev,x,x.next)!==0)x=x.next;else{if($j(x),x=d=x.prev,x===x.next)break;u=!0}while(u||x!==d);return d}function Rj(h,d,u,x,j,k,E){if(!h)return;!E&&k&&function($,V,W,ee){let ce=$;do ce.z===0&&(ce.z=bk(ce.x,ce.y,V,W,ee)),ce.prevZ=ce.prev,ce.nextZ=ce.next,ce=ce.next;while(ce!==$);ce.prevZ.nextZ=null,ce.prevZ=null,function(me){let xe,Ne=1;do{let Te,Le=me;me=null;let at=null;for(xe=0;Le;){xe++;let qe=Le,Ze=0;for(let jt=0;jt<Ne&&(Ze++,qe=qe.nextZ,qe);jt++);let ht=Ne;for(;Ze>0||ht>0&&qe;)Ze!==0&&(ht===0||!qe||Le.z<=qe.z)?(Te=Le,Le=Le.nextZ,Ze--):(Te=qe,qe=qe.nextZ,ht--),at?at.nextZ=Te:me=Te,Te.prevZ=at,at=Te;Le=qe}at.nextZ=null,Ne*=2}while(xe>1)}(ce)}(h,x,j,k);let R=h;for(;h.prev!==h.next;){const $=h.prev,V=h.next;if(k?aJ(h,x,j,k):nJ(h))d.push($.i,h.i,V.i),$j(h),h=V.next,R=V.next;else if((h=V)===R){E?E===1?Rj(h=iJ(Cf(h),d),d,u,x,j,k,2):E===2&&oJ(h,d,u,x,j,k):Rj(Cf(h),d,u,x,j,k,1);break}}}function nJ(h){const d=h.prev,u=h,x=h.next;if(oa(d,u,x)>=0)return!1;const j=d.x,k=u.x,E=x.x,R=d.y,$=u.y,V=x.y,W=Math.min(j,k,E),ee=Math.min(R,$,V),ce=Math.max(j,k,E),me=Math.max(R,$,V);let xe=x.next;for(;xe!==d;){if(xe.x>=W&&xe.x<=ce&&xe.y>=ee&&xe.y<=me&&Lj(j,R,k,$,E,V,xe.x,xe.y)&&oa(xe.prev,xe,xe.next)>=0)return!1;xe=xe.next}return!0}function aJ(h,d,u,x){const j=h.prev,k=h,E=h.next;if(oa(j,k,E)>=0)return!1;const R=j.x,$=k.x,V=E.x,W=j.y,ee=k.y,ce=E.y,me=Math.min(R,$,V),xe=Math.min(W,ee,ce),Ne=Math.max(R,$,V),Te=Math.max(W,ee,ce),Le=bk(me,xe,d,u,x),at=bk(Ne,Te,d,u,x);let qe=h.prevZ,Ze=h.nextZ;for(;qe&&qe.z>=Le&&Ze&&Ze.z<=at;){if(qe.x>=me&&qe.x<=Ne&&qe.y>=xe&&qe.y<=Te&&qe!==j&&qe!==E&&Lj(R,W,$,ee,V,ce,qe.x,qe.y)&&oa(qe.prev,qe,qe.next)>=0||(qe=qe.prevZ,Ze.x>=me&&Ze.x<=Ne&&Ze.y>=xe&&Ze.y<=Te&&Ze!==j&&Ze!==E&&Lj(R,W,$,ee,V,ce,Ze.x,Ze.y)&&oa(Ze.prev,Ze,Ze.next)>=0))return!1;Ze=Ze.nextZ}for(;qe&&qe.z>=Le;){if(qe.x>=me&&qe.x<=Ne&&qe.y>=xe&&qe.y<=Te&&qe!==j&&qe!==E&&Lj(R,W,$,ee,V,ce,qe.x,qe.y)&&oa(qe.prev,qe,qe.next)>=0)return!1;qe=qe.prevZ}for(;Ze&&Ze.z<=at;){if(Ze.x>=me&&Ze.x<=Ne&&Ze.y>=xe&&Ze.y<=Te&&Ze!==j&&Ze!==E&&Lj(R,W,$,ee,V,ce,Ze.x,Ze.y)&&oa(Ze.prev,Ze,Ze.next)>=0)return!1;Ze=Ze.nextZ}return!0}function iJ(h,d){let u=h;do{const x=u.prev,j=u.next.next;!Lx(x,j)&&WR(x,u,u.next,j)&&Fj(x,j)&&Fj(j,x)&&(d.push(x.i,u.i,j.i),$j(u),$j(u.next),u=h=j),u=u.next}while(u!==h);return Cf(u)}function oJ(h,d,u,x,j,k){let E=h;do{let R=E.next.next;for(;R!==E.prev;){if(E.i!==R.i&&hJ(E,R)){let $=GR(E,R);return E=Cf(E,E.next),$=Cf($,$.next),Rj(E,d,u,x,j,k,0),void Rj($,d,u,x,j,k,0)}R=R.next}E=E.next}while(E!==h)}function lJ(h,d){let u=h.x-d.x;return u===0&&(u=h.y-d.y,u===0)&&(u=(h.next.y-h.y)/(h.next.x-h.x)-(d.next.y-d.y)/(d.next.x-d.x)),u}function cJ(h,d){const u=function(j,k){let E=k;const R=j.x,$=j.y;let V,W=-1/0;if(Lx(j,E))return E;do{if(Lx(j,E.next))return E.next;if($<=E.y&&$>=E.next.y&&E.next.y!==E.y){const Ne=E.x+($-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(Ne<=R&&Ne>W&&(W=Ne,V=E.x<E.next.x?E:E.next,Ne===R))return V}E=E.next}while(E!==k);if(!V)return null;const ee=V,ce=V.x,me=V.y;let xe=1/0;E=V;do{if(R>=E.x&&E.x>=ce&&R!==E.x&&UR($<me?R:W,$,ce,me,$<me?W:R,$,E.x,E.y)){const Ne=Math.abs($-E.y)/(R-E.x);Fj(E,j)&&(Ne<xe||Ne===xe&&(E.x>V.x||E.x===V.x&&dJ(V,E)))&&(V=E,xe=Ne)}E=E.next}while(E!==ee);return V}(h,d);if(!u)return d;const x=GR(u,h);return Cf(x,x.next),Cf(u,u.next)}function dJ(h,d){return oa(h.prev,h,d.prev)<0&&oa(d.next,h,h.next)<0}function bk(h,d,u,x,j){return(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-u)*j|0)|h<<8))|h<<4))|h<<2))|h<<1))|(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=(d-x)*j|0)|d<<8))|d<<4))|d<<2))|d<<1))<<1}function uJ(h){let d=h,u=h;do(d.x<u.x||d.x===u.x&&d.y<u.y)&&(u=d),d=d.next;while(d!==h);return u}function UR(h,d,u,x,j,k,E,R){return(j-E)*(d-R)>=(h-E)*(k-R)&&(h-E)*(x-R)>=(u-E)*(d-R)&&(u-E)*(k-R)>=(j-E)*(x-R)}function Lj(h,d,u,x,j,k,E,R){return!(h===E&&d===R)&&UR(h,d,u,x,j,k,E,R)}function hJ(h,d){return h.next.i!==d.i&&h.prev.i!==d.i&&!function(u,x){let j=u;do{if(j.i!==u.i&&j.next.i!==u.i&&j.i!==x.i&&j.next.i!==x.i&&WR(j,j.next,u,x))return!0;j=j.next}while(j!==u);return!1}(h,d)&&(Fj(h,d)&&Fj(d,h)&&function(u,x){let j=u,k=!1;const E=(u.x+x.x)/2,R=(u.y+x.y)/2;do j.y>R!=j.next.y>R&&j.next.y!==j.y&&E<(j.next.x-j.x)*(R-j.y)/(j.next.y-j.y)+j.x&&(k=!k),j=j.next;while(j!==u);return k}(h,d)&&(oa(h.prev,h,d.prev)||oa(h,d.prev,d))||Lx(h,d)&&oa(h.prev,h,h.next)>0&&oa(d.prev,d,d.next)>0)}function oa(h,d,u){return(d.y-h.y)*(u.x-d.x)-(d.x-h.x)*(u.y-d.y)}function Lx(h,d){return h.x===d.x&&h.y===d.y}function WR(h,d,u,x){const j=g1(oa(h,d,u)),k=g1(oa(h,d,x)),E=g1(oa(u,x,h)),R=g1(oa(u,x,d));return j!==k&&E!==R||!(j!==0||!x1(h,u,d))||!(k!==0||!x1(h,x,d))||!(E!==0||!x1(u,h,x))||!(R!==0||!x1(u,d,x))}function x1(h,d,u){return d.x<=Math.max(h.x,u.x)&&d.x>=Math.min(h.x,u.x)&&d.y<=Math.max(h.y,u.y)&&d.y>=Math.min(h.y,u.y)}function g1(h){return h>0?1:h<0?-1:0}function Fj(h,d){return oa(h.prev,h,h.next)<0?oa(h,d,h.next)>=0&&oa(h,h.prev,d)>=0:oa(h,d,h.prev)<0||oa(h,h.next,d)<0}function GR(h,d){const u=_k(h.i,h.x,h.y),x=_k(d.i,d.x,d.y),j=h.next,k=d.prev;return h.next=d,d.prev=h,u.next=j,j.prev=u,x.next=u,u.prev=x,k.next=x,x.prev=k,x}function KR(h,d,u,x){const j=_k(h,d,u);return x?(j.next=x.next,j.prev=x,x.next.prev=j,x.next=j):(j.prev=j,j.next=j),j}function $j(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function _k(h,d,u){return{i:h,x:d,y:u,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Fx{constructor(d,u){if(u>d)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=d,this._minGranularity=u}getGranularityForZoomLevel(d){return Math.max(Math.floor(this._baseZoomGranularity/(1<<d)),this._minGranularity,1)}}class y1{constructor(d){this.fill=d.fill,this.line=d.line,this.tile=d.tile,this.stencil=d.stencil,this.circle=d.circle}}y1.noSubdivision=new y1({fill:new Fx(0,0),line:new Fx(0,0),tile:new Fx(0,0),stencil:new Fx(0,0),circle:1}),pr("SubdivisionGranularityExpression",Fx),pr("SubdivisionGranularitySetting",y1);const $x=-32768,zj=32767;class mJ{constructor(d,u){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=d,this._granularityCellSize=de/d,this._canonical=u}_getKey(d,u){return(d+=32768)<<16|u+32768}_vertexToIndex(d,u){if(d<-32768||u<-32768||d>32767||u>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const x=0|Math.round(d),j=0|Math.round(u),k=this._getKey(x,j);if(this._vertexDictionary.has(k))return this._vertexDictionary.get(k);const E=this._vertexBuffer.length/2;return this._vertexDictionary.set(k,E),this._vertexBuffer.push(x,j),E}_subdivideTrianglesScanline(d){if(this._granularity<2)return function(j,k){const E=[];for(let R=0;R<k.length;R+=3){const $=k[R],V=k[R+1],W=k[R+2],ee=j[2*$],ce=j[2*$+1];(j[2*V]-ee)*(j[2*W+1]-ce)-(j[2*V+1]-ce)*(j[2*W]-ee)>0?(E.push($),E.push(W),E.push(V)):(E.push($),E.push(V),E.push(W))}return E}(this._vertexBuffer,d);const u=[],x=d.length;for(let j=0;j<x;j+=3){const k=[d[j+0],d[j+1],d[j+2]],E=[this._vertexBuffer[2*d[j+0]+0],this._vertexBuffer[2*d[j+0]+1],this._vertexBuffer[2*d[j+1]+0],this._vertexBuffer[2*d[j+1]+1],this._vertexBuffer[2*d[j+2]+0],this._vertexBuffer[2*d[j+2]+1]];let R=1/0,$=1/0,V=-1/0,W=-1/0;for(let Ne=0;Ne<3;Ne++){const Te=E[2*Ne],Le=E[2*Ne+1];R=Math.min(R,Te),V=Math.max(V,Te),$=Math.min($,Le),W=Math.max(W,Le)}if(R===V||$===W)continue;const ee=Math.floor(R/this._granularityCellSize),ce=Math.ceil(V/this._granularityCellSize),me=Math.floor($/this._granularityCellSize),xe=Math.ceil(W/this._granularityCellSize);if(ee!==ce||me!==xe)for(let Ne=me;Ne<xe;Ne++){const Te=this._scanlineGenerateVertexRingForCellRow(Ne,E,k);fJ(this._vertexBuffer,Te,u)}else u.push(...k)}return u}_scanlineGenerateVertexRingForCellRow(d,u,x){const j=d*this._granularityCellSize,k=j+this._granularityCellSize,E=[];for(let R=0;R<3;R++){const $=u[2*R],V=u[2*R+1],W=u[2*(R+1)%6],ee=u[(2*(R+1)+1)%6],ce=u[2*(R+2)%6],me=u[(2*(R+2)+1)%6],xe=W-$,Ne=ee-V,Te=xe===0,Le=Ne===0,at=(j-V)/Ne,qe=(k-V)/Ne,Ze=Math.min(at,qe),ht=Math.max(at,qe);if(!Le&&(Ze>=1||ht<=0)||Le&&(V<j||V>k)){ee>=j&&ee<=k&&E.push(x[(R+1)%3]);continue}!Le&&Ze>0&&E.push(this._vertexToIndex($+xe*Ze,V+Ne*Ze));const jt=$+xe*Math.max(Ze,0),zt=$+xe*Math.min(ht,1);Te||this._generateIntraEdgeVertices(E,$,V,W,ee,jt,zt),!Le&&ht<1&&E.push(this._vertexToIndex($+xe*ht,V+Ne*ht)),(Le||ee>=j&&ee<=k)&&E.push(x[(R+1)%3]),!Le&&(ee<=j||ee>=k)&&this._generateInterEdgeVertices(E,$,V,W,ee,ce,me,zt,j,k)}return E}_generateIntraEdgeVertices(d,u,x,j,k,E,R){const $=j-u,V=k-x,W=V===0,ee=W?Math.min(u,j):Math.min(E,R),ce=W?Math.max(u,j):Math.max(E,R),me=Math.floor(ee/this._granularityCellSize)+1,xe=Math.ceil(ce/this._granularityCellSize)-1;if(W?u<j:E<R)for(let Ne=me;Ne<=xe;Ne++){const Te=Ne*this._granularityCellSize;d.push(this._vertexToIndex(Te,x+V*(Te-u)/$))}else for(let Ne=xe;Ne>=me;Ne--){const Te=Ne*this._granularityCellSize;d.push(this._vertexToIndex(Te,x+V*(Te-u)/$))}}_generateInterEdgeVertices(d,u,x,j,k,E,R,$,V,W){const ee=k-x,ce=E-j,me=R-k,xe=(V-k)/me,Ne=(W-k)/me,Te=Math.min(xe,Ne),Le=Math.max(xe,Ne),at=j+ce*Te;let qe=Math.floor(Math.min(at,$)/this._granularityCellSize)+1,Ze=Math.ceil(Math.max(at,$)/this._granularityCellSize)-1,ht=$<at;const jt=me===0;if(jt&&(R===V||R===W))return;if(jt||Te>=1||Le<=0){const ar=x-R,Gt=E+(u-E)*Math.min((V-R)/ar,(W-R)/ar);qe=Math.floor(Math.min(Gt,$)/this._granularityCellSize)+1,Ze=Math.ceil(Math.max(Gt,$)/this._granularityCellSize)-1,ht=$<Gt}const zt=ee>0?W:V;if(ht)for(let ar=qe;ar<=Ze;ar++)d.push(this._vertexToIndex(ar*this._granularityCellSize,zt));else for(let ar=Ze;ar>=qe;ar--)d.push(this._vertexToIndex(ar*this._granularityCellSize,zt))}_generateOutline(d){const u=[];for(const x of d){const j=Pf(x,this._granularity,!0),k=this._pointArrayToIndices(j),E=[];for(let R=1;R<k.length;R++)E.push(k[R-1]),E.push(k[R]);u.push(E)}return u}_handlePoles(d){let u=!1,x=!1;this._canonical&&(this._canonical.y===0&&(u=!0),this._canonical.y===(1<<this._canonical.z)-1&&(x=!0)),(u||x)&&this._fillPoles(d,u,x)}_ensureNoPoleVertices(){const d=this._vertexBuffer;for(let u=0;u<d.length;u+=2){const x=d[u+1];x===$x&&(d[u+1]=-32767),x===zj&&(d[u+1]=32766)}}_generatePoleQuad(d,u,x,j,k,E){j>k!=(E===$x)?(d.push(u),d.push(x),d.push(this._vertexToIndex(j,E)),d.push(x),d.push(this._vertexToIndex(k,E)),d.push(this._vertexToIndex(j,E))):(d.push(x),d.push(u),d.push(this._vertexToIndex(j,E)),d.push(this._vertexToIndex(k,E)),d.push(x),d.push(this._vertexToIndex(j,E)))}_fillPoles(d,u,x){const j=this._vertexBuffer,k=de,E=d.length;for(let R=2;R<E;R+=3){const $=d[R-2],V=d[R-1],W=d[R],ee=j[2*$],ce=j[2*$+1],me=j[2*V],xe=j[2*V+1],Ne=j[2*W],Te=j[2*W+1];u&&(ce===0&&xe===0&&this._generatePoleQuad(d,$,V,ee,me,$x),xe===0&&Te===0&&this._generatePoleQuad(d,V,W,me,Ne,$x),Te===0&&ce===0&&this._generatePoleQuad(d,W,$,Ne,ee,$x)),x&&(ce===k&&xe===k&&this._generatePoleQuad(d,$,V,ee,me,zj),xe===k&&Te===k&&this._generatePoleQuad(d,V,W,me,Ne,zj),Te===k&&ce===k&&this._generatePoleQuad(d,W,$,Ne,ee,zj))}}_initializeVertices(d){for(let u=0;u<d.length;u+=2)this._vertexToIndex(d[u],d[u+1])}subdividePolygonInternal(d,u){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:x,holeIndices:j}=function(R){const $=[],V=[];for(const W of R)if(W.length!==0){W!==R[0]&&$.push(V.length/2);for(let ee=0;ee<W.length;ee++)V.push(W[ee].x),V.push(W[ee].y)}return{flattened:V,holeIndices:$}}(d);let k;this._initializeVertices(x);try{const R=function(V,W,ee=2){const ce=W&&W.length,me=ce?W[0]*ee:V.length;let xe=VR(V,0,me,ee,!0);const Ne=[];if(!xe||xe.next===xe.prev)return Ne;let Te,Le,at;if(ce&&(xe=function(qe,Ze,ht,jt){const zt=[];for(let ar=0,Gt=Ze.length;ar<Gt;ar++){const rr=VR(qe,Ze[ar]*jt,ar<Gt-1?Ze[ar+1]*jt:qe.length,jt,!1);rr===rr.next&&(rr.steiner=!0),zt.push(uJ(rr))}zt.sort(lJ);for(let ar=0;ar<zt.length;ar++)ht=cJ(zt[ar],ht);return ht}(V,W,xe,ee)),V.length>80*ee){Te=V[0],Le=V[1];let qe=Te,Ze=Le;for(let ht=ee;ht<me;ht+=ee){const jt=V[ht],zt=V[ht+1];jt<Te&&(Te=jt),zt<Le&&(Le=zt),jt>qe&&(qe=jt),zt>Ze&&(Ze=zt)}at=Math.max(qe-Te,Ze-Le),at=at!==0?32767/at:0}return Rj(xe,Ne,ee,Te,Le,at,0),Ne}(x,j),$=this._convertIndices(x,R);k=this._subdivideTrianglesScanline($)}catch(R){console.error(R)}let E=[];return u&&(E=this._generateOutline(d)),this._ensureNoPoleVertices(),this._handlePoles(k),{verticesFlattened:this._vertexBuffer,indicesTriangles:k,indicesLineList:E}}_convertIndices(d,u){const x=[];for(let j=0;j<u.length;j++)x.push(this._vertexToIndex(d[2*u[j]],d[2*u[j]+1]));return x}_pointArrayToIndices(d){const u=[];for(let x=0;x<d.length;x++){const j=d[x];u.push(this._vertexToIndex(j.x,j.y))}return u}}function HR(h,d,u,x=!0){return new mJ(u,d).subdividePolygonInternal(h,x)}function Pf(h,d,u=!1){if(!h||h.length<1)return[];if(h.length<2)return[];const x=h[0],j=h[h.length-1],k=u&&(x.x!==j.x||x.y!==j.y);if(d<2)return k?[...h,h[0]]:[...h];const E=Math.floor(de/d),R=[];R.push(new f(h[0].x,h[0].y));const $=h.length,V=k?$:$-1;for(let W=0;W<V;W++){const ee=h[W],ce=W<$-1?h[W+1]:h[0],me=ee.x,xe=ee.y,Ne=ce.x,Te=ce.y,Le=me!==Ne,at=xe!==Te;if(!Le&&!at)continue;const qe=Ne-me,Ze=Te-xe,ht=Math.abs(qe),jt=Math.abs(Ze);let zt=me,ar=xe;for(;;){const rr=qe>0?(Math.floor(zt/E)+1)*E:(Math.ceil(zt/E)-1)*E,kr=Ze>0?(Math.floor(ar/E)+1)*E:(Math.ceil(ar/E)-1)*E,Jt=Math.abs(zt-rr),sr=Math.abs(ar-kr),Ot=Math.abs(zt-Ne),zr=Math.abs(ar-Te),Vr=Le?Jt/ht:Number.POSITIVE_INFINITY,Ir=at?sr/jt:Number.POSITIVE_INFINITY;if((Ot<=Jt||!Le)&&(zr<=sr||!at))break;if(Vr<Ir&&Le||!at){zt=rr,ar+=Ze*Vr;const _r=new f(zt,Math.round(ar));R[R.length-1].x===_r.x&&R[R.length-1].y===_r.y||R.push(_r)}else{zt+=qe*Ir,ar=kr;const _r=new f(Math.round(zt),ar);R[R.length-1].x===_r.x&&R[R.length-1].y===_r.y||R.push(_r)}}const Gt=new f(Ne,Te);R[R.length-1].x===Gt.x&&R[R.length-1].y===Gt.y||R.push(Gt)}return R}function fJ(h,d,u){if(d.length===0)throw new Error("Subdivision vertex ring is empty.");let x=0,j=h[2*d[0]];for(let $=1;$<d.length;$++){const V=h[2*d[$]];V<j&&(j=V,x=$)}const k=d.length;let E=x,R=(E+1)%k;for(;;){const $=E-1>=0?E-1:k-1,V=(R+1)%k,W=h[2*d[$]],ee=h[2*d[V]],ce=h[2*d[E]],me=h[2*d[E]+1],xe=h[2*d[R]+1];let Ne=!1;if(W<ee)Ne=!0;else if(W>ee)Ne=!1;else{const Te=xe-me,Le=-(h[2*d[R]]-ce),at=me<xe?1:-1;((W-ce)*Te+(h[2*d[$]+1]-me)*Le)*at>((ee-ce)*Te+(h[2*d[V]+1]-me)*Le)*at&&(Ne=!0)}if(Ne){const Te=d[$],Le=d[E],at=d[R];Te!==Le&&Te!==at&&Le!==at&&u.push(at,Le,Te),E--,E<0&&(E=k-1)}else{const Te=d[V],Le=d[E],at=d[R];Te!==Le&&Te!==at&&Le!==at&&u.push(at,Le,Te),R++,R>=k&&(R=0)}if($===V)break}}function ZR(h,d,u,x,j,k,E,R,$){const V=j.length/2,W=E&&R&&$;if(V<es.MAX_VERTEX_ARRAY_LENGTH){const ee=d.prepareSegment(V,u,x),ce=ee.vertexLength;for(let Ne=0;Ne<k.length;Ne+=3)x.emplaceBack(ce+k[Ne],ce+k[Ne+1],ce+k[Ne+2]);let me,xe;ee.vertexLength+=V,ee.primitiveLength+=k.length/3,W&&(xe=E.prepareSegment(V,u,R),me=xe.vertexLength,xe.vertexLength+=V);for(let Ne=0;Ne<j.length;Ne+=2)h(j[Ne],j[Ne+1]);if(W)for(let Ne=0;Ne<$.length;Ne++){const Te=$[Ne];for(let Le=1;Le<Te.length;Le+=2)R.emplaceBack(me+Te[Le-1],me+Te[Le]);xe.primitiveLength+=Te.length/2}}else(function(ee,ce,me,xe,Ne,Te){const Le=[];for(let jt=0;jt<xe.length/2;jt++)Le.push(-1);const at={count:0};let qe=0,Ze=ee.getOrCreateLatestSegment(ce,me),ht=Ze.vertexLength;for(let jt=2;jt<Ne.length;jt+=3){const zt=Ne[jt-2],ar=Ne[jt-1],Gt=Ne[jt];let rr=Le[zt]<qe,kr=Le[ar]<qe,Jt=Le[Gt]<qe;Ze.vertexLength+((rr?1:0)+(kr?1:0)+(Jt?1:0))>es.MAX_VERTEX_ARRAY_LENGTH&&(Ze=ee.createNewSegment(ce,me),qe=at.count,rr=!0,kr=!0,Jt=!0,ht=0);const sr=Bj(Le,xe,Te,at,zt,rr,Ze),Ot=Bj(Le,xe,Te,at,ar,kr,Ze),zr=Bj(Le,xe,Te,at,Gt,Jt,Ze);me.emplaceBack(ht+sr-qe,ht+Ot-qe,ht+zr-qe),Ze.primitiveLength++}})(d,u,x,j,k,h),W&&function(ee,ce,me,xe,Ne,Te){const Le=[];for(let jt=0;jt<xe.length/2;jt++)Le.push(-1);const at={count:0};let qe=0,Ze=ee.getOrCreateLatestSegment(ce,me),ht=Ze.vertexLength;for(let jt=0;jt<Ne.length;jt++){const zt=Ne[jt];for(let ar=1;ar<Ne[jt].length;ar+=2){const Gt=zt[ar-1],rr=zt[ar];let kr=Le[Gt]<qe,Jt=Le[rr]<qe;Ze.vertexLength+((kr?1:0)+(Jt?1:0))>es.MAX_VERTEX_ARRAY_LENGTH&&(Ze=ee.createNewSegment(ce,me),qe=at.count,kr=!0,Jt=!0,ht=0);const sr=Bj(Le,xe,Te,at,Gt,kr,Ze),Ot=Bj(Le,xe,Te,at,rr,Jt,Ze);me.emplaceBack(ht+sr-qe,ht+Ot-qe),Ze.primitiveLength++}}}(E,u,R,j,$,h),d.forceNewSegmentOnNextPrepare(),E==null||E.forceNewSegmentOnNextPrepare()}function Bj(h,d,u,x,j,k,E){if(k){const R=x.count;return u(d[2*j],d[2*j+1]),h[j]=x.count,x.count++,E.vertexLength++,R}return h[j]}class wk{constructor(d){this.zoom=d.zoom,this.overscaling=d.overscaling,this.layers=d.layers,this.layerIds=this.layers.map(u=>u.id),this.index=d.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new $e,this.indexArray=new Dt,this.indexArray2=new jr,this.programConfigurations=new du(d.layers,d.zoom),this.segments=new es,this.segments2=new es,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(d,u,x){this.hasDependencies=p1("fill",this.layers,u);const j=this.layers[0].layout.get("fill-sort-key"),k=!j.isConstant(),E=[];for(const{feature:R,id:$,index:V,sourceLayerIndex:W}of d){const ee=this.layers[0]._featureFilter.needGeometry,ce=ld(R,ee);if(!this.layers[0]._featureFilter.filter(new an(this.zoom),ce,x))continue;const me=k?j.evaluate(ce,{},x,u.availableImages):void 0,xe={id:$,properties:R.properties,type:R.type,sourceLayerIndex:W,index:V,geometry:ee?ce.geometry:gc(R),patterns:{},sortKey:me};E.push(xe)}k&&E.sort((R,$)=>R.sortKey-$.sortKey);for(const R of E){const{geometry:$,index:V,sourceLayerIndex:W}=R;if(this.hasDependencies){const ee=jk("fill",this.layers,R,{zoom:this.zoom},u);this.patternFeatures.push(ee)}else this.addFeature(R,$,V,x,{},u.subdivisionGranularity);u.featureIndex.insert(d[V].feature,$,V,W,this.index)}}update(d,u,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(d,u,this.stateDependentLayers,{imagePositions:x})}addFeatures(d,u,x){for(const j of this.patternFeatures)this.addFeature(j,j.geometry,j.index,u,x,d.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(d){this.uploaded||(this.layoutVertexBuffer=d.createVertexBuffer(this.layoutVertexArray,sJ),this.indexBuffer=d.createIndexBuffer(this.indexArray),this.indexBuffer2=d.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(d),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(d,u,x,j,k,E){for(const R of ax(u,500)){const $=HR(R,j,E.fill.getGranularityForZoomLevel(j.z)),V=this.layoutVertexArray;ZR((W,ee)=>{V.emplaceBack(W,ee)},this.segments,this.layoutVertexArray,this.indexArray,$.verticesFlattened,$.indicesTriangles,this.segments2,this.indexArray2,$.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,d,x,{imagePositions:k,canonical:j})}}let YR,XR;pr("FillBucket",wk,{omit:["layers","patternFeatures"]});var pJ={get paint(){return XR=XR||new gi({"fill-antialias":new Nr(ot.paint_fill["fill-antialias"]),"fill-opacity":new Lr(ot.paint_fill["fill-opacity"]),"fill-color":new Lr(ot.paint_fill["fill-color"]),"fill-outline-color":new Lr(ot.paint_fill["fill-outline-color"]),"fill-translate":new Nr(ot.paint_fill["fill-translate"]),"fill-translate-anchor":new Nr(ot.paint_fill["fill-translate-anchor"]),"fill-pattern":new _f(ot.paint_fill["fill-pattern"])})},get layout(){return YR=YR||new gi({"fill-sort-key":new Lr(ot.layout_fill["fill-sort-key"])})}};class xJ extends el{constructor(d,u){super(d,pJ,u)}recalculate(d,u){super.recalculate(d,u);const x=this.paint._values["fill-outline-color"];x.value.kind==="constant"&&x.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(d){return new wk(d)}queryRadius(){return m1(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:d,geometry:u,transform:x,pixelsToTileUnits:j}){return AR(f1(d,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-x.bearingInRadians,j),u)}isTileClipped(){return!0}}const gJ=Qn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),yJ=Qn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:vJ}=gJ;class zx{constructor(d,u,x,j,k){this.properties={},this.extent=x,this.type=0,this.id=void 0,this._pbf=d,this._geometry=-1,this._keys=j,this._values=k,d.readFields(jJ,this,u)}loadGeometry(){const d=this._pbf;d.pos=this._geometry;const u=d.readVarint()+d.pos,x=[];let j,k=1,E=0,R=0,$=0;for(;d.pos<u;){if(E<=0){const V=d.readVarint();k=7&V,E=V>>3}if(E--,k===1||k===2)R+=d.readSVarint(),$+=d.readSVarint(),k===1&&(j&&x.push(j),j=[]),j&&j.push(new f(R,$));else{if(k!==7)throw new Error(`unknown command ${k}`);j&&j.push(j[0].clone())}}return j&&x.push(j),x}bbox(){const d=this._pbf;d.pos=this._geometry;const u=d.readVarint()+d.pos;let x=1,j=0,k=0,E=0,R=1/0,$=-1/0,V=1/0,W=-1/0;for(;d.pos<u;){if(j<=0){const ee=d.readVarint();x=7&ee,j=ee>>3}if(j--,x===1||x===2)k+=d.readSVarint(),E+=d.readSVarint(),k<R&&(R=k),k>$&&($=k),E<V&&(V=E),E>W&&(W=E);else if(x!==7)throw new Error(`unknown command ${x}`)}return[R,V,$,W]}toGeoJSON(d,u,x){const j=this.extent*Math.pow(2,x),k=this.extent*d,E=this.extent*u,R=this.loadGeometry();function $(ce){return[360*(ce.x+k)/j-180,360/Math.PI*Math.atan(Math.exp((1-2*(ce.y+E)/j)*Math.PI))-90]}function V(ce){return ce.map($)}let W;if(this.type===1){const ce=[];for(const xe of R)ce.push(xe[0]);const me=V(ce);W=ce.length===1?{type:"Point",coordinates:me[0]}:{type:"MultiPoint",coordinates:me}}else if(this.type===2){const ce=R.map(V);W=ce.length===1?{type:"LineString",coordinates:ce[0]}:{type:"MultiLineString",coordinates:ce}}else{if(this.type!==3)throw new Error("unknown feature type");{const ce=function(xe){const Ne=xe.length;if(Ne<=1)return[xe];const Te=[];let Le,at;for(let qe=0;qe<Ne;qe++){const Ze=bJ(xe[qe]);Ze!==0&&(at===void 0&&(at=Ze<0),at===Ze<0?(Le&&Te.push(Le),Le=[xe[qe]]):Le&&Le.push(xe[qe]))}return Le&&Te.push(Le),Te}(R),me=[];for(const xe of ce)me.push(xe.map(V));W=me.length===1?{type:"Polygon",coordinates:me[0]}:{type:"MultiPolygon",coordinates:me}}}const ee={type:"Feature",geometry:W,properties:this.properties};return this.id!=null&&(ee.id=this.id),ee}}function jJ(h,d,u){h===1?d.id=u.readVarint():h===2?function(x,j){const k=x.readVarint()+x.pos;for(;x.pos<k;){const E=j._keys[x.readVarint()],R=j._values[x.readVarint()];j.properties[E]=R}}(u,d):h===3?d.type=u.readVarint():h===4&&(d._geometry=u.pos)}function bJ(h){let d=0;for(let u,x,j=0,k=h.length,E=k-1;j<k;E=j++)u=h[j],x=h[E],d+=(x.x-u.x)*(u.y+x.y);return d}zx.types=["Unknown","Point","LineString","Polygon"];class QR{constructor(d,u){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=d,this._keys=[],this._values=[],this._features=[],d.readFields(_J,this,u),this.length=this._features.length}feature(d){if(d<0||d>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[d];const u=this._pbf.readVarint()+this._pbf.pos;return new zx(this._pbf,u,this.extent,this._keys,this._values)}}function _J(h,d,u){h===15?d.version=u.readVarint():h===1?d.name=u.readString():h===5?d.extent=u.readVarint():h===2?d._features.push(u.pos):h===3?d._keys.push(u.readString()):h===4&&d._values.push(function(x){let j=null;const k=x.readVarint()+x.pos;for(;x.pos<k;){const E=x.readVarint()>>3;j=E===1?x.readString():E===2?x.readFloat():E===3?x.readDouble():E===4?x.readVarint64():E===5?x.readVarint():E===6?x.readSVarint():E===7?x.readBoolean():null}if(j==null)throw new Error("unknown feature value");return j}(u))}class JR{constructor(d,u){this.layers=d.readFields(wJ,{},u)}}function wJ(h,d,u){if(h===3){const x=new QR(u,u.readVarint()+u.pos);x.length&&(d[x.name]=x)}}const Nk=Math.pow(2,13);function qj(h,d,u,x,j,k,E,R){h.emplaceBack(d,u,2*Math.floor(x*Nk)+E,j*Nk*2,k*Nk*2,Math.round(R))}class Sk{constructor(d){this.zoom=d.zoom,this.overscaling=d.overscaling,this.layers=d.layers,this.layerIds=this.layers.map(u=>u.id),this.index=d.index,this.hasDependencies=!1,this.layoutVertexArray=new We,this.centroidVertexArray=new ze,this.indexArray=new Dt,this.programConfigurations=new du(d.layers,d.zoom),this.segments=new es,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(d,u,x){this.features=[],this.hasDependencies=p1("fill-extrusion",this.layers,u);for(const{feature:j,id:k,index:E,sourceLayerIndex:R}of d){const $=this.layers[0]._featureFilter.needGeometry,V=ld(j,$);if(!this.layers[0]._featureFilter.filter(new an(this.zoom),V,x))continue;const W={id:k,sourceLayerIndex:R,index:E,geometry:$?V.geometry:gc(j),properties:j.properties,type:j.type,patterns:{}};this.hasDependencies?this.features.push(jk("fill-extrusion",this.layers,W,{zoom:this.zoom},u)):this.addFeature(W,W.geometry,E,x,{},u.subdivisionGranularity),u.featureIndex.insert(j,W.geometry,E,R,this.index,!0)}}addFeatures(d,u,x){for(const j of this.features){const{geometry:k}=j;this.addFeature(j,k,j.index,u,x,d.subdivisionGranularity)}}update(d,u,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(d,u,this.stateDependentLayers,{imagePositions:x})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(d){this.uploaded||(this.layoutVertexBuffer=d.createVertexBuffer(this.layoutVertexArray,vJ),this.centroidVertexBuffer=d.createVertexBuffer(this.centroidVertexArray,yJ.members,!0),this.indexBuffer=d.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(d),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(d,u,x,j,k,E){for(const R of ax(u,500)){const $={x:0,y:0,sampleCount:0},V=this.layoutVertexArray.length;this.processPolygon($,j,d,R,E);const W=this.layoutVertexArray.length-V,ee=Math.floor($.x/$.sampleCount),ce=Math.floor($.y/$.sampleCount);for(let me=0;me<W;me++)this.centroidVertexArray.emplaceBack(ee,ce)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,d,x,{imagePositions:k,canonical:j})}processPolygon(d,u,x,j,k){if(j.length<1||e3(j[0]))return;for(const ee of j)ee.length!==0&&NJ(d,ee);const E={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},R=k.fill.getGranularityForZoomLevel(u.z),$=zx.types[x.type]==="Polygon";for(const ee of j){if(ee.length===0||e3(ee))continue;const ce=Pf(ee,R,$);this._generateSideFaces(ce,E)}if(!$)return;const V=HR(j,u,R,!1),W=this.layoutVertexArray;ZR((ee,ce)=>{qj(W,ee,ce,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,V.verticesFlattened,V.indicesTriangles)}_generateSideFaces(d,u){let x=0;for(let j=1;j<d.length;j++){const k=d[j],E=d[j-1];if(SJ(k,E))continue;u.segment.vertexLength+4>es.MAX_VERTEX_ARRAY_LENGTH&&(u.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const R=k.sub(E)._perp()._unit(),$=E.dist(k);x+$>32768&&(x=0),qj(this.layoutVertexArray,k.x,k.y,R.x,R.y,0,0,x),qj(this.layoutVertexArray,k.x,k.y,R.x,R.y,0,1,x),x+=$,qj(this.layoutVertexArray,E.x,E.y,R.x,R.y,0,0,x),qj(this.layoutVertexArray,E.x,E.y,R.x,R.y,0,1,x);const V=u.segment.vertexLength;this.indexArray.emplaceBack(V,V+2,V+1),this.indexArray.emplaceBack(V+1,V+2,V+3),u.segment.vertexLength+=4,u.segment.primitiveLength+=2}}}function NJ(h,d){for(let u=0;u<d.length;u++){const x=d[u];u===d.length-1&&d[0].x===x.x&&d[0].y===x.y||(h.x+=x.x,h.y+=x.y,h.sampleCount++)}}function SJ(h,d){return h.x===d.x&&(h.x<0||h.x>de)||h.y===d.y&&(h.y<0||h.y>de)}function e3(h){return h.every(d=>d.x<0)||h.every(d=>d.x>de)||h.every(d=>d.y<0)||h.every(d=>d.y>de)}let t3;pr("FillExtrusionBucket",Sk,{omit:["layers","features"]});var CJ={get paint(){return t3=t3||new gi({"fill-extrusion-opacity":new Nr(ot["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Lr(ot["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Nr(ot["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Nr(ot["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _f(ot["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Lr(ot["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Lr(ot["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Nr(ot["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class PJ extends el{constructor(d,u){super(d,CJ,u)}createBucket(d){return new Sk(d)}queryRadius(){return m1(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:d,feature:u,featureState:x,geometry:j,transform:k,pixelsToTileUnits:E,pixelPosMatrix:R}){const $=f1(d,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-k.bearingInRadians,E),V=this.paint.get("fill-extrusion-height").evaluate(u,x),W=this.paint.get("fill-extrusion-base").evaluate(u,x),ee=function(me,xe){const Ne=[];for(const Te of me){const Le=[Te.x,Te.y,0,1];Ce(Le,Le,xe),Ne.push(new f(Le[0]/Le[3],Le[1]/Le[3]))}return Ne}($,R),ce=function(me,xe,Ne,Te){const Le=[],at=[],qe=Te[8]*xe,Ze=Te[9]*xe,ht=Te[10]*xe,jt=Te[11]*xe,zt=Te[8]*Ne,ar=Te[9]*Ne,Gt=Te[10]*Ne,rr=Te[11]*Ne;for(const kr of me){const Jt=[],sr=[];for(const Ot of kr){const zr=Ot.x,Vr=Ot.y,Ir=Te[0]*zr+Te[4]*Vr+Te[12],_r=Te[1]*zr+Te[5]*Vr+Te[13],gs=Te[2]*zr+Te[6]*Vr+Te[14],Bn=Te[3]*zr+Te[7]*Vr+Te[15],Sa=gs+ht,vi=Bn+jt,sl=Ir+zt,xo=_r+ar,Ja=gs+Gt,Dn=Bn+rr,La=new f((Ir+qe)/vi,(_r+Ze)/vi);La.z=Sa/vi,Jt.push(La);const ei=new f(sl/Dn,xo/Dn);ei.z=Ja/Dn,sr.push(ei)}Le.push(Jt),at.push(sr)}return[Le,at]}(j,W,V,R);return function(me,xe,Ne){let Te=1/0;AR(Ne,xe)&&(Te=r3(Ne,xe[0]));for(let Le=0;Le<xe.length;Le++){const at=xe[Le],qe=me[Le];for(let Ze=0;Ze<at.length-1;Ze++){const ht=at[Ze],jt=[ht,at[Ze+1],qe[Ze+1],qe[Ze],ht];kR(Ne,jt)&&(Te=Math.min(Te,r3(Ne,jt)))}}return Te!==1/0&&Te}(ce[0],ce[1],ee)}}function Vj(h,d){return h.x*d.x+h.y*d.y}function r3(h,d){if(h.length===1){let u=0;const x=d[u++];let j;for(;!j||x.equals(j);)if(j=d[u++],!j)return 1/0;for(;u<d.length;u++){const k=d[u],E=h[0],R=j.sub(x),$=k.sub(x),V=E.sub(x),W=Vj(R,R),ee=Vj(R,$),ce=Vj($,$),me=Vj(V,R),xe=Vj(V,$),Ne=W*ce-ee*ee,Te=(ce*me-ee*xe)/Ne,Le=(W*xe-ee*me)/Ne,at=x.z*(1-Te-Le)+j.z*Te+k.z*Le;if(isFinite(at))return at}return 1/0}{let u=1/0;for(const x of d)u=Math.min(u,x.z);return u}}const kJ=Qn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:AJ}=kJ,TJ=Qn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:EJ}=TJ,MJ=Math.cos(Math.PI/180*37.5),s3=Math.pow(2,14)/.5;class Ck{constructor(d){this.zoom=d.zoom,this.overscaling=d.overscaling,this.layers=d.layers,this.layerIds=this.layers.map(u=>u.id),this.index=d.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new Ye,this.layoutVertexArray2=new Be,this.indexArray=new Dt,this.programConfigurations=new du(d.layers,d.zoom),this.segments=new es,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(d,u,x){this.hasDependencies=p1("line",this.layers,u)||this.hasLineDasharray(this.layers);const j=this.layers[0].layout.get("line-sort-key"),k=!j.isConstant(),E=[];for(const{feature:R,id:$,index:V,sourceLayerIndex:W}of d){const ee=this.layers[0]._featureFilter.needGeometry,ce=ld(R,ee);if(!this.layers[0]._featureFilter.filter(new an(this.zoom),ce,x))continue;const me=k?j.evaluate(ce,{},x):void 0,xe={id:$,properties:R.properties,type:R.type,sourceLayerIndex:W,index:V,geometry:ee?ce.geometry:gc(R),patterns:{},dashes:{},sortKey:me};E.push(xe)}k&&E.sort((R,$)=>R.sortKey-$.sortKey);for(const R of E){const{geometry:$,index:V,sourceLayerIndex:W}=R;this.hasDependencies?(p1("line",this.layers,u)?jk("line",this.layers,R,{zoom:this.zoom},u):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,R,this.zoom,u),this.patternFeatures.push(R)):this.addFeature(R,$,V,x,{},{},u.subdivisionGranularity),u.featureIndex.insert(d[V].feature,$,V,W,this.index)}}update(d,u,x,j){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(d,u,this.stateDependentLayers,{imagePositions:x,dashPositions:j})}addFeatures(d,u,x,j){for(const k of this.patternFeatures)this.addFeature(k,k.geometry,k.index,u,x,j,d.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(d){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=d.createVertexBuffer(this.layoutVertexArray2,EJ)),this.layoutVertexBuffer=d.createVertexBuffer(this.layoutVertexArray,AJ),this.indexBuffer=d.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(d),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(d){if(d.properties&&Object.prototype.hasOwnProperty.call(d.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(d.properties,"mapbox_clip_end"))return{start:+d.properties.mapbox_clip_start,end:+d.properties.mapbox_clip_end}}addFeature(d,u,x,j,k,E,R){const $=this.layers[0].layout,V=$.get("line-join").evaluate(d,{}),W=$.get("line-cap"),ee=$.get("line-miter-limit"),ce=$.get("line-round-limit");this.lineClips=this.lineFeatureClips(d);for(const me of u)this.addLine(me,d,V,W,ee,ce,j,R);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,d,x,{imagePositions:k,dashPositions:E,canonical:j})}addLine(d,u,x,j,k,E,R,$){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,d=Pf(d,R?$.line.getGranularityForZoomLevel(R.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let qe=0;qe<d.length-1;qe++)this.totalDistance+=d[qe].dist(d[qe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const V=zx.types[u.type]==="Polygon";let W=d.length;for(;W>=2&&d[W-1].equals(d[W-2]);)W--;let ee=0;for(;ee<W-1&&d[ee].equals(d[ee+1]);)ee++;if(W<(V?3:2))return;x==="bevel"&&(k=1.05);const ce=this.overscaling<=16?122880/(512*this.overscaling):0,me=this.segments.prepareSegment(10*W,this.layoutVertexArray,this.indexArray);let xe,Ne,Te,Le,at;this.e1=this.e2=-1,V&&(xe=d[W-2],at=d[ee].sub(xe)._unit()._perp());for(let qe=ee;qe<W;qe++){if(Te=qe===W-1?V?d[ee+1]:void 0:d[qe+1],Te&&d[qe].equals(Te))continue;at&&(Le=at),xe&&(Ne=xe),xe=d[qe],at=Te?Te.sub(xe)._unit()._perp():Le,Le=Le||at;let Ze=Le.add(at);Ze.x===0&&Ze.y===0||Ze._unit();const ht=Le.x*at.x+Le.y*at.y,jt=Ze.x*at.x+Ze.y*at.y,zt=jt!==0?1/jt:1/0,ar=2*Math.sqrt(2-2*jt),Gt=jt<MJ&&Ne&&Te,rr=Le.x*at.y-Le.y*at.x>0;if(Gt&&qe>ee){const sr=xe.dist(Ne);if(sr>2*ce){const Ot=xe.sub(xe.sub(Ne)._mult(ce/sr)._round());this.updateDistance(Ne,Ot),this.addCurrentVertex(Ot,Le,0,0,me),Ne=Ot}}const kr=Ne&&Te;let Jt=kr?x:V?"butt":j;if(kr&&Jt==="round"&&(zt<E?Jt="miter":zt<=2&&(Jt="fakeround")),Jt==="miter"&&zt>k&&(Jt="bevel"),Jt==="bevel"&&(zt>2&&(Jt="flipbevel"),zt<k&&(Jt="miter")),Ne&&this.updateDistance(Ne,xe),Jt==="miter")Ze._mult(zt),this.addCurrentVertex(xe,Ze,0,0,me);else if(Jt==="flipbevel"){if(zt>100)Ze=at.mult(-1);else{const sr=zt*Le.add(at).mag()/Le.sub(at).mag();Ze._perp()._mult(sr*(rr?-1:1))}this.addCurrentVertex(xe,Ze,0,0,me),this.addCurrentVertex(xe,Ze.mult(-1),0,0,me)}else if(Jt==="bevel"||Jt==="fakeround"){const sr=-Math.sqrt(zt*zt-1),Ot=rr?sr:0,zr=rr?0:sr;if(Ne&&this.addCurrentVertex(xe,Le,Ot,zr,me),Jt==="fakeround"){const Vr=Math.round(180*ar/Math.PI/20);for(let Ir=1;Ir<Vr;Ir++){let _r=Ir/Vr;if(_r!==.5){const Bn=_r-.5;_r+=_r*Bn*(_r-1)*((1.0904+ht*(ht*(3.55645-1.43519*ht)-3.2452))*Bn*Bn+(.848013+ht*(.215638*ht-1.06021)))}const gs=at.sub(Le)._mult(_r)._add(Le)._unit()._mult(rr?-1:1);this.addHalfVertex(xe,gs.x,gs.y,!1,rr,0,me)}}Te&&this.addCurrentVertex(xe,at,-Ot,-zr,me)}else if(Jt==="butt")this.addCurrentVertex(xe,Ze,0,0,me);else if(Jt==="square"){const sr=Ne?1:-1;this.addCurrentVertex(xe,Ze,sr,sr,me)}else Jt==="round"&&(Ne&&(this.addCurrentVertex(xe,Le,0,0,me),this.addCurrentVertex(xe,Le,1,1,me,!0)),Te&&(this.addCurrentVertex(xe,at,-1,-1,me,!0),this.addCurrentVertex(xe,at,0,0,me)));if(Gt&&qe<W-1){const sr=xe.dist(Te);if(sr>2*ce){const Ot=xe.add(Te.sub(xe)._mult(ce/sr)._round());this.updateDistance(xe,Ot),this.addCurrentVertex(Ot,at,0,0,me),xe=Ot}}}}addCurrentVertex(d,u,x,j,k,E=!1){const R=u.y*j-u.x,$=-u.y-u.x*j;this.addHalfVertex(d,u.x+u.y*x,u.y-u.x*x,E,!1,x,k),this.addHalfVertex(d,R,$,E,!0,-j,k),this.distance>s3/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(d,u,x,j,k,E))}addHalfVertex({x:d,y:u},x,j,k,E,R,$){const V=.5*(this.lineClips?this.scaledDistance*(s3-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((d<<1)+(k?1:0),(u<<1)+(E?1:0),Math.round(63*x)+128,Math.round(63*j)+128,1+(R===0?0:R<0?-1:1)|(63&V)<<2,V>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const W=$.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,W,this.e2),$.primitiveLength++),E?this.e2=W:this.e1=W}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(d,u){this.distance+=d.dist(u),this.updateScaledDistance()}hasLineDasharray(d){for(const u of d){const x=u.paint.get("line-dasharray");if(x&&!x.isConstant())return!0}return!1}addLineDashDependencies(d,u,x,j){for(const k of d){const E=k.paint.get("line-dasharray");if(!E||E.value.kind==="constant")continue;const R=k.layout.get("line-cap")==="round",$={dasharray:E.value.evaluate({zoom:x-1},u,{}),round:R},V={dasharray:E.value.evaluate({zoom:x},u,{}),round:R},W={dasharray:E.value.evaluate({zoom:x+1},u,{}),round:R},ee=`${$.dasharray.join(",")},${$.round}`,ce=`${V.dasharray.join(",")},${V.round}`,me=`${W.dasharray.join(",")},${W.round}`;j.dashDependencies[ee]=$,j.dashDependencies[ce]=V,j.dashDependencies[me]=W,u.dashes[k.id]={min:ee,mid:ce,max:me}}}}let n3,a3;pr("LineBucket",Ck,{omit:["layers","patternFeatures"]});var i3={get paint(){return a3=a3||new gi({"line-opacity":new Lr(ot.paint_line["line-opacity"]),"line-color":new Lr(ot.paint_line["line-color"]),"line-translate":new Nr(ot.paint_line["line-translate"]),"line-translate-anchor":new Nr(ot.paint_line["line-translate-anchor"]),"line-width":new Lr(ot.paint_line["line-width"]),"line-gap-width":new Lr(ot.paint_line["line-gap-width"]),"line-offset":new Lr(ot.paint_line["line-offset"]),"line-blur":new Lr(ot.paint_line["line-blur"]),"line-dasharray":new _f(ot.paint_line["line-dasharray"]),"line-pattern":new _f(ot.paint_line["line-pattern"]),"line-gradient":new wf(ot.paint_line["line-gradient"])})},get layout(){return n3=n3||new gi({"line-cap":new Nr(ot.layout_line["line-cap"]),"line-join":new Lr(ot.layout_line["line-join"]),"line-miter-limit":new Nr(ot.layout_line["line-miter-limit"]),"line-round-limit":new Nr(ot.layout_line["line-round-limit"]),"line-sort-key":new Lr(ot.layout_line["line-sort-key"])})}};class OJ extends Lr{possiblyEvaluate(d,u){return u=new an(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),super.possiblyEvaluate(d,u)}evaluate(d,u,x,j){return u=ur({},u,{zoom:Math.floor(u.zoom)}),super.evaluate(d,u,x,j)}}let v1;class IJ extends el{constructor(d,u){super(d,i3,u),this.gradientVersion=0,v1||(v1=new OJ(i3.paint.properties["line-width"].specification),v1.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(d){if(d==="line-gradient"){const u=this.gradientExpression();this.stepInterpolant=!!function(x){return x._styleExpression!==void 0}(u)&&u._styleExpression.expression instanceof uh,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(d,u){super.recalculate(d,u),this.paint._values["line-floorwidth"]=v1.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,d)}createBucket(d){return new Ck(d)}queryRadius(d){const u=d,x=o3(Rx("line-width",this,u),Rx("line-gap-width",this,u)),j=Rx("line-offset",this,u);return x/2+Math.abs(j)+m1(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:d,feature:u,featureState:x,geometry:j,transform:k,pixelsToTileUnits:E}){const R=f1(d,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-k.bearingInRadians,E),$=E/2*o3(this.paint.get("line-width").evaluate(u,x),this.paint.get("line-gap-width").evaluate(u,x)),V=this.paint.get("line-offset").evaluate(u,x);return V&&(j=function(W,ee){const ce=[];for(let me=0;me<W.length;me++){const xe=W[me],Ne=[];for(let Te=0;Te<xe.length;Te++){const Le=xe[Te-1],at=xe[Te],qe=xe[Te+1],Ze=Te===0?new f(0,0):at.sub(Le)._unit()._perp(),ht=Te===xe.length-1?new f(0,0):qe.sub(at)._unit()._perp(),jt=Ze._add(ht)._unit(),zt=jt.x*ht.x+jt.y*ht.y;zt!==0&&jt._mult(1/zt),Ne.push(jt._mult(ee)._add(at))}ce.push(Ne)}return ce}(j,V*E)),function(W,ee,ce){for(let me=0;me<ee.length;me++){const xe=ee[me];if(W.length>=3){for(let Ne=0;Ne<xe.length;Ne++)if(Dx(W,xe[Ne]))return!0}if(BQ(W,xe,ce))return!0}return!1}(R,j,$)}isTileClipped(){return!0}}function o3(h,d){return d>0?d+2*h:h}const DJ=Qn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),RJ=Qn([{name:"a_projected_pos",components:3,type:"Float32"}],4);Qn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const LJ=Qn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Qn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const l3=Qn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),FJ=Qn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function $J(h,d,u){return h.sections.forEach(x=>{x.text=function(j,k,E){const R=k.layout.get("text-transform").evaluate(E,{});return R==="uppercase"?j=j.toLocaleUpperCase():R==="lowercase"&&(j=j.toLocaleLowerCase()),mc.applyArabicShaping&&(j=mc.applyArabicShaping(j)),j}(x.text,d,u)}),h}Qn([{name:"triangle",components:3,type:"Uint16"}]),Qn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Qn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Qn([{type:"Float32",name:"offsetX"}]),Qn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Qn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Uj={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Ra=24;const Pk=4294967296,c3=1/Pk,d3=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class kk{constructor(d=new Uint8Array(16)){this.buf=ArrayBuffer.isView(d)?d:new Uint8Array(d),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(d,u,x=this.length){for(;this.pos<x;){const j=this.readVarint(),k=j>>3,E=this.pos;this.type=7&j,d(k,u,this),this.pos===E&&this.skip(j)}return u}readMessage(d,u){return this.readFields(d,u,this.readVarint()+this.pos)}readFixed32(){const d=this.dataView.getUint32(this.pos,!0);return this.pos+=4,d}readSFixed32(){const d=this.dataView.getInt32(this.pos,!0);return this.pos+=4,d}readFixed64(){const d=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Pk;return this.pos+=8,d}readSFixed64(){const d=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Pk;return this.pos+=8,d}readFloat(){const d=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,d}readDouble(){const d=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,d}readVarint(d){const u=this.buf;let x,j;return j=u[this.pos++],x=127&j,j<128?x:(j=u[this.pos++],x|=(127&j)<<7,j<128?x:(j=u[this.pos++],x|=(127&j)<<14,j<128?x:(j=u[this.pos++],x|=(127&j)<<21,j<128?x:(j=u[this.pos],x|=(15&j)<<28,function(k,E,R){const $=R.buf;let V,W;if(W=$[R.pos++],V=(112&W)>>4,W<128||(W=$[R.pos++],V|=(127&W)<<3,W<128)||(W=$[R.pos++],V|=(127&W)<<10,W<128)||(W=$[R.pos++],V|=(127&W)<<17,W<128)||(W=$[R.pos++],V|=(127&W)<<24,W<128)||(W=$[R.pos++],V|=(1&W)<<31,W<128))return Bx(k,V,E);throw new Error("Expected varint not more than 10 bytes")}(x,d,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const d=this.readVarint();return d%2==1?(d+1)/-2:d/2}readBoolean(){return!!this.readVarint()}readString(){const d=this.readVarint()+this.pos,u=this.pos;return this.pos=d,d-u>=12&&d3?d3.decode(this.buf.subarray(u,d)):function(x,j,k){let E="",R=j;for(;R<k;){const $=x[R];let V,W,ee,ce=null,me=$>239?4:$>223?3:$>191?2:1;if(R+me>k)break;me===1?$<128&&(ce=$):me===2?(V=x[R+1],(192&V)==128&&(ce=(31&$)<<6|63&V,ce<=127&&(ce=null))):me===3?(V=x[R+1],W=x[R+2],(192&V)==128&&(192&W)==128&&(ce=(15&$)<<12|(63&V)<<6|63&W,(ce<=2047||ce>=55296&&ce<=57343)&&(ce=null))):me===4&&(V=x[R+1],W=x[R+2],ee=x[R+3],(192&V)==128&&(192&W)==128&&(192&ee)==128&&(ce=(15&$)<<18|(63&V)<<12|(63&W)<<6|63&ee,(ce<=65535||ce>=1114112)&&(ce=null))),ce===null?(ce=65533,me=1):ce>65535&&(ce-=65536,E+=String.fromCharCode(ce>>>10&1023|55296),ce=56320|1023&ce),E+=String.fromCharCode(ce),R+=me}return E}(this.buf,u,d)}readBytes(){const d=this.readVarint()+this.pos,u=this.buf.subarray(this.pos,d);return this.pos=d,u}readPackedVarint(d=[],u){const x=this.readPackedEnd();for(;this.pos<x;)d.push(this.readVarint(u));return d}readPackedSVarint(d=[]){const u=this.readPackedEnd();for(;this.pos<u;)d.push(this.readSVarint());return d}readPackedBoolean(d=[]){const u=this.readPackedEnd();for(;this.pos<u;)d.push(this.readBoolean());return d}readPackedFloat(d=[]){const u=this.readPackedEnd();for(;this.pos<u;)d.push(this.readFloat());return d}readPackedDouble(d=[]){const u=this.readPackedEnd();for(;this.pos<u;)d.push(this.readDouble());return d}readPackedFixed32(d=[]){const u=this.readPackedEnd();for(;this.pos<u;)d.push(this.readFixed32());return d}readPackedSFixed32(d=[]){const u=this.readPackedEnd();for(;this.pos<u;)d.push(this.readSFixed32());return d}readPackedFixed64(d=[]){const u=this.readPackedEnd();for(;this.pos<u;)d.push(this.readFixed64());return d}readPackedSFixed64(d=[]){const u=this.readPackedEnd();for(;this.pos<u;)d.push(this.readSFixed64());return d}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(d){const u=7&d;if(u===0)for(;this.buf[this.pos++]>127;);else if(u===2)this.pos=this.readVarint()+this.pos;else if(u===5)this.pos+=4;else{if(u!==1)throw new Error(`Unimplemented type: ${u}`);this.pos+=8}}writeTag(d,u){this.writeVarint(d<<3|u)}realloc(d){let u=this.length||16;for(;u<this.pos+d;)u*=2;if(u!==this.length){const x=new Uint8Array(u);x.set(this.buf),this.buf=x,this.dataView=new DataView(x.buffer),this.length=u}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(d){this.realloc(4),this.dataView.setInt32(this.pos,d,!0),this.pos+=4}writeSFixed32(d){this.realloc(4),this.dataView.setInt32(this.pos,d,!0),this.pos+=4}writeFixed64(d){this.realloc(8),this.dataView.setInt32(this.pos,-1&d,!0),this.dataView.setInt32(this.pos+4,Math.floor(d*c3),!0),this.pos+=8}writeSFixed64(d){this.realloc(8),this.dataView.setInt32(this.pos,-1&d,!0),this.dataView.setInt32(this.pos+4,Math.floor(d*c3),!0),this.pos+=8}writeVarint(d){(d=+d||0)>268435455||d<0?function(u,x){let j,k;if(u>=0?(j=u%4294967296|0,k=u/4294967296|0):(j=~(-u%4294967296),k=~(-u/4294967296),4294967295^j?j=j+1|0:(j=0,k=k+1|0)),u>=18446744073709552e3||u<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");x.realloc(10),function(E,R,$){$.buf[$.pos++]=127&E|128,E>>>=7,$.buf[$.pos++]=127&E|128,E>>>=7,$.buf[$.pos++]=127&E|128,E>>>=7,$.buf[$.pos++]=127&E|128,$.buf[$.pos]=127&(E>>>=7)}(j,0,x),function(E,R){const $=(7&E)<<4;R.buf[R.pos++]|=$|((E>>>=3)?128:0),E&&(R.buf[R.pos++]=127&E|((E>>>=7)?128:0),E&&(R.buf[R.pos++]=127&E|((E>>>=7)?128:0),E&&(R.buf[R.pos++]=127&E|((E>>>=7)?128:0),E&&(R.buf[R.pos++]=127&E|((E>>>=7)?128:0),E&&(R.buf[R.pos++]=127&E)))))}(k,x)}(d,this):(this.realloc(4),this.buf[this.pos++]=127&d|(d>127?128:0),d<=127||(this.buf[this.pos++]=127&(d>>>=7)|(d>127?128:0),d<=127||(this.buf[this.pos++]=127&(d>>>=7)|(d>127?128:0),d<=127||(this.buf[this.pos++]=d>>>7&127))))}writeSVarint(d){this.writeVarint(d<0?2*-d-1:2*d)}writeBoolean(d){this.writeVarint(+d)}writeString(d){d=String(d),this.realloc(4*d.length),this.pos++;const u=this.pos;this.pos=function(j,k,E){for(let R,$,V=0;V<k.length;V++){if(R=k.charCodeAt(V),R>55295&&R<57344){if(!$){R>56319||V+1===k.length?(j[E++]=239,j[E++]=191,j[E++]=189):$=R;continue}if(R<56320){j[E++]=239,j[E++]=191,j[E++]=189,$=R;continue}R=$-55296<<10|R-56320|65536,$=null}else $&&(j[E++]=239,j[E++]=191,j[E++]=189,$=null);R<128?j[E++]=R:(R<2048?j[E++]=R>>6|192:(R<65536?j[E++]=R>>12|224:(j[E++]=R>>18|240,j[E++]=R>>12&63|128),j[E++]=R>>6&63|128),j[E++]=63&R|128)}return E}(this.buf,d,this.pos);const x=this.pos-u;x>=128&&u3(u,x,this),this.pos=u-1,this.writeVarint(x),this.pos+=x}writeFloat(d){this.realloc(4),this.dataView.setFloat32(this.pos,d,!0),this.pos+=4}writeDouble(d){this.realloc(8),this.dataView.setFloat64(this.pos,d,!0),this.pos+=8}writeBytes(d){const u=d.length;this.writeVarint(u),this.realloc(u);for(let x=0;x<u;x++)this.buf[this.pos++]=d[x]}writeRawMessage(d,u){this.pos++;const x=this.pos;d(u,this);const j=this.pos-x;j>=128&&u3(x,j,this),this.pos=x-1,this.writeVarint(j),this.pos+=j}writeMessage(d,u,x){this.writeTag(d,2),this.writeRawMessage(u,x)}writePackedVarint(d,u){u.length&&this.writeMessage(d,zJ,u)}writePackedSVarint(d,u){u.length&&this.writeMessage(d,BJ,u)}writePackedBoolean(d,u){u.length&&this.writeMessage(d,UJ,u)}writePackedFloat(d,u){u.length&&this.writeMessage(d,qJ,u)}writePackedDouble(d,u){u.length&&this.writeMessage(d,VJ,u)}writePackedFixed32(d,u){u.length&&this.writeMessage(d,WJ,u)}writePackedSFixed32(d,u){u.length&&this.writeMessage(d,GJ,u)}writePackedFixed64(d,u){u.length&&this.writeMessage(d,KJ,u)}writePackedSFixed64(d,u){u.length&&this.writeMessage(d,HJ,u)}writeBytesField(d,u){this.writeTag(d,2),this.writeBytes(u)}writeFixed32Field(d,u){this.writeTag(d,5),this.writeFixed32(u)}writeSFixed32Field(d,u){this.writeTag(d,5),this.writeSFixed32(u)}writeFixed64Field(d,u){this.writeTag(d,1),this.writeFixed64(u)}writeSFixed64Field(d,u){this.writeTag(d,1),this.writeSFixed64(u)}writeVarintField(d,u){this.writeTag(d,0),this.writeVarint(u)}writeSVarintField(d,u){this.writeTag(d,0),this.writeSVarint(u)}writeStringField(d,u){this.writeTag(d,2),this.writeString(u)}writeFloatField(d,u){this.writeTag(d,5),this.writeFloat(u)}writeDoubleField(d,u){this.writeTag(d,1),this.writeDouble(u)}writeBooleanField(d,u){this.writeVarintField(d,+u)}}function Bx(h,d,u){return u?4294967296*d+(h>>>0):4294967296*(d>>>0)+(h>>>0)}function u3(h,d,u){const x=d<=16383?1:d<=2097151?2:d<=268435455?3:Math.floor(Math.log(d)/(7*Math.LN2));u.realloc(x);for(let j=u.pos-1;j>=h;j--)u.buf[j+x]=u.buf[j]}function zJ(h,d){for(let u=0;u<h.length;u++)d.writeVarint(h[u])}function BJ(h,d){for(let u=0;u<h.length;u++)d.writeSVarint(h[u])}function qJ(h,d){for(let u=0;u<h.length;u++)d.writeFloat(h[u])}function VJ(h,d){for(let u=0;u<h.length;u++)d.writeDouble(h[u])}function UJ(h,d){for(let u=0;u<h.length;u++)d.writeBoolean(h[u])}function WJ(h,d){for(let u=0;u<h.length;u++)d.writeFixed32(h[u])}function GJ(h,d){for(let u=0;u<h.length;u++)d.writeSFixed32(h[u])}function KJ(h,d){for(let u=0;u<h.length;u++)d.writeFixed64(h[u])}function HJ(h,d){for(let u=0;u<h.length;u++)d.writeSFixed64(h[u])}function ZJ(h,d,u){h===1&&u.readMessage(YJ,d)}function YJ(h,d,u){if(h===3){const{id:x,bitmap:j,width:k,height:E,left:R,top:$,advance:V}=u.readMessage(XJ,{});d.push({id:x,bitmap:new Dj({width:k+6,height:E+6},j),metrics:{width:k,height:E,left:R,top:$,advance:V}})}}function XJ(h,d,u){h===1?d.id=u.readVarint():h===2?d.bitmap=u.readBytes():h===3?d.width=u.readVarint():h===4?d.height=u.readVarint():h===5?d.left=u.readSVarint():h===6?d.top=u.readSVarint():h===7&&(d.advance=u.readVarint())}function h3(h){let d=0,u=0;for(const E of h)d+=E.w*E.h,u=Math.max(u,E.w);h.sort((E,R)=>R.h-E.h);const x=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(d/.95)),u),h:1/0}];let j=0,k=0;for(const E of h)for(let R=x.length-1;R>=0;R--){const $=x[R];if(!(E.w>$.w||E.h>$.h)){if(E.x=$.x,E.y=$.y,k=Math.max(k,E.y+E.h),j=Math.max(j,E.x+E.w),E.w===$.w&&E.h===$.h){const V=x.pop();V&&R<x.length&&(x[R]=V)}else E.h===$.h?($.x+=E.w,$.w-=E.w):E.w===$.w?($.y+=E.h,$.h-=E.h):(x.push({x:$.x+E.w,y:$.y,w:$.w-E.w,h:E.h}),$.y+=E.h,$.h-=E.h);break}}return{w:j,h:k,fill:d/(j*k)||0}}class Ak{constructor(d,{pixelRatio:u,version:x,stretchX:j,stretchY:k,content:E,textFitWidth:R,textFitHeight:$}){this.paddedRect=d,this.pixelRatio=u,this.stretchX=j,this.stretchY=k,this.content=E,this.version=x,this.textFitWidth=R,this.textFitHeight=$}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class m3{constructor(d,u){const x={},j={};this.haveRenderCallbacks=[];const k=[];this.addImages(d,x,k),this.addImages(u,j,k);const{w:E,h:R}=h3(k),$=new po({width:E||1,height:R||1});for(const V in d){const W=d[V],ee=x[V].paddedRect;po.copy(W.data,$,{x:0,y:0},{x:ee.x+1,y:ee.y+1},W.data)}for(const V in u){const W=u[V],ee=j[V].paddedRect,ce=ee.x+1,me=ee.y+1,xe=W.data.width,Ne=W.data.height;po.copy(W.data,$,{x:0,y:0},{x:ce,y:me},W.data),po.copy(W.data,$,{x:0,y:Ne-1},{x:ce,y:me-1},{width:xe,height:1}),po.copy(W.data,$,{x:0,y:0},{x:ce,y:me+Ne},{width:xe,height:1}),po.copy(W.data,$,{x:xe-1,y:0},{x:ce-1,y:me},{width:1,height:Ne}),po.copy(W.data,$,{x:0,y:0},{x:ce+xe,y:me},{width:1,height:Ne})}this.image=$,this.iconPositions=x,this.patternPositions=j}addImages(d,u,x){for(const j in d){const k=d[j],E={x:0,y:0,w:k.data.width+2,h:k.data.height+2};x.push(E),u[j]=new Ak(E,k),k.hasRenderCallback&&this.haveRenderCallbacks.push(j)}}patchUpdatedImages(d,u){d.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const x in d.updatedImages)this.patchUpdatedImage(this.iconPositions[x],d.getImage(x),u),this.patchUpdatedImage(this.patternPositions[x],d.getImage(x),u)}patchUpdatedImage(d,u,x){if(!d||!u||d.version===u.version)return;d.version=u.version;const[j,k]=d.tl;x.update(u.data,void 0,{x:j,y:k})}}var Nh;pr("ImagePosition",Ak),pr("ImageAtlas",m3),c.as=void 0,(Nh=c.as||(c.as={}))[Nh.none=0]="none",Nh[Nh.horizontal=1]="horizontal",Nh[Nh.vertical=2]="vertical",Nh[Nh.horizontalOnly=3]="horizontalOnly";class Wj{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(d,u,x){const j=new Wj;return j.scale=d||1,j.fontStack=u,j.verticalAlign=x||"bottom",j}static forImage(d,u){const x=new Wj;return x.imageName=d,x.verticalAlign=u||"bottom",x}}class qx{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(d,u){const x=new qx;for(let j=0;j<d.sections.length;j++){const k=d.sections[j];k.image?x.addImageSection(k):x.addTextSection(k,u)}return x}length(){return this.text.length}getSection(d){return this.sections[this.sectionIndex[d]]}getSectionIndex(d){return this.sectionIndex[d]}getCharCode(d){return this.text.charCodeAt(d)}verticalizePunctuation(){this.text=function(d){let u="";for(let x=0;x<d.length;x++){const j=d.charCodeAt(x+1)||null,k=d.charCodeAt(x-1)||null;u+=j&&Cx(j)&&!Uj[d[x+1]]||k&&Cx(k)&&!Uj[d[x-1]]||!Uj[d[x]]?d[x]:Uj[d[x]]}return u}(this.text)}trim(){let d=0;for(let x=0;x<this.text.length&&b1[this.text.charCodeAt(x)];x++)d++;let u=this.text.length;for(let x=this.text.length-1;x>=0&&x>=d&&b1[this.text.charCodeAt(x)];x--)u--;this.text=this.text.substring(d,u),this.sectionIndex=this.sectionIndex.slice(d,u)}substring(d,u){const x=new qx;return x.text=this.text.substring(d,u),x.sectionIndex=this.sectionIndex.slice(d,u),x.sections=this.sections,x}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((d,u)=>Math.max(d,this.sections[u].scale),0)}getMaxImageSize(d){let u=0,x=0;for(let j=0;j<this.length();j++){const k=this.getSection(j);if(k.imageName){const E=d[k.imageName];if(!E)continue;const R=E.displaySize;u=Math.max(u,R[0]),x=Math.max(x,R[1])}}return{maxImageWidth:u,maxImageHeight:x}}addTextSection(d,u){this.text+=d.text,this.sections.push(Wj.forText(d.scale,d.fontStack||u,d.verticalAlign));const x=this.sections.length-1;for(let j=0;j<d.text.length;++j)this.sectionIndex.push(x)}addImageSection(d){const u=d.image?d.image.name:"";if(u.length===0)return void vr("Can't add FormattedSection with an empty image.");const x=this.getNextImageSectionCharCode();x?(this.text+=String.fromCharCode(x),this.sections.push(Wj.forImage(u,d.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):vr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function j1(h,d,u,x,j,k,E,R,$,V,W,ee,ce,me,xe){const Ne=qx.fromFeature(h,j);let Te;ee===c.as.vertical&&Ne.verticalizePunctuation();const{processBidirectionalText:Le,processStyledBidirectionalText:at}=mc;if(Le&&Ne.sections.length===1){Te=[];const ht=Le(Ne.toString(),Tk(Ne,V,k,d,x,me));for(const jt of ht){const zt=new qx;zt.text=jt,zt.sections=Ne.sections;for(let ar=0;ar<jt.length;ar++)zt.sectionIndex.push(0);Te.push(zt)}}else if(at){Te=[];const ht=at(Ne.text,Ne.sectionIndex,Tk(Ne,V,k,d,x,me));for(const jt of ht){const zt=new qx;zt.text=jt[0],zt.sectionIndex=jt[1],zt.sections=Ne.sections,Te.push(zt)}}else Te=function(ht,jt){const zt=[],ar=ht.text;let Gt=0;for(const rr of jt)zt.push(ht.substring(Gt,rr)),Gt=rr;return Gt<ar.length&&zt.push(ht.substring(Gt,ar.length)),zt}(Ne,Tk(Ne,V,k,d,x,me));const qe=[],Ze={positionedLines:qe,text:Ne.toString(),top:W[1],bottom:W[1],left:W[0],right:W[0],writingMode:ee,iconsInText:!1,verticalizable:!1};return function(ht,jt,zt,ar,Gt,rr,kr,Jt,sr,Ot,zr,Vr){let Ir=0,_r=0,gs=0,Bn=0;const Sa=Jt==="right"?1:Jt==="left"?0:.5,vi=Ra/Vr;let sl=0;for(const Dn of Gt){Dn.trim();const La=Dn.getMaxScale(),ei={positionedGlyphs:[],lineOffset:0};ht.positionedLines[sl]=ei;const ti=ei.positionedGlyphs;let to=0;if(!Dn.length()){_r+=rr,++sl;continue}const nl=tee(ar,Dn,vi);for(let go=0;go<Dn.length();go++){const Ca=Dn.getSection(go),$a=Dn.getSectionIndex(go),za=Dn.getCharCode(go),ya=ree(sr,zr,za);let vn;if(Ca.imageName){if(ht.iconsInText=!0,Ca.scale=Ca.scale*vi,vn=nee(Ca,ya,La,nl,ar),!vn)continue;to=Math.max(to,vn.imageOffset)}else if(vn=see(Ca,za,ya,nl,jt,zt),!vn)continue;const{rect:yc,metrics:Gx,baselineOffset:vc}=vn;ti.push({glyph:za,imageName:Ca.imageName,x:Ir,y:_r+vc+-17,vertical:ya,scale:Ca.scale,fontStack:Ca.fontStack,sectionIndex:$a,metrics:Gx,rect:yc}),ya?(ht.verticalizable=!0,Ir+=(Ca.imageName?Gx.advance:Ra)*Ca.scale+Ot):Ir+=Gx.advance*Ca.scale+Ot}ti.length!==0&&(gs=Math.max(Ir-Ot,gs),aee(ti,0,ti.length-1,Sa)),Ir=0,ei.lineOffset=Math.max(to,(La-1)*Ra);const Fa=rr*La+to;_r+=Fa,Bn=Math.max(Fa,Bn),++sl}const{horizontalAlign:xo,verticalAlign:Ja}=Ek(kr);(function(Dn,La,ei,ti,to,nl,Fa,go,Ca){const $a=(La-ei)*to;let za=0;za=nl!==Fa?-go*ti- -17:-ti*Ca*Fa+.5*Fa;for(const ya of Dn)for(const vn of ya.positionedGlyphs)vn.x+=$a,vn.y+=za})(ht.positionedLines,Sa,xo,Ja,gs,Bn,rr,_r,Gt.length),ht.top+=-Ja*_r,ht.bottom=ht.top+_r,ht.left+=-xo*gs,ht.right=ht.left+gs}(Ze,d,u,x,Te,E,R,$,ee,V,ce,xe),!function(ht){for(const jt of ht)if(jt.positionedGlyphs.length!==0)return!1;return!0}(qe)&&Ze}const b1={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},QJ={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},JJ={40:!0};function f3(h,d,u,x,j,k){if(d.imageName){const E=x[d.imageName];return E?E.displaySize[0]*d.scale*Ra/k+j:0}{const E=u[d.fontStack],R=E&&E[h];return R?R.metrics.advance*d.scale+j:0}}function p3(h,d,u,x){const j=Math.pow(h-d,2);return x?h<d?j/2:2*j:j+Math.abs(u)*u}function eee(h,d,u){let x=0;return h===10&&(x-=1e4),u&&(x+=150),h!==40&&h!==65288||(x+=50),d!==41&&d!==65289||(x+=50),x}function x3(h,d,u,x,j,k){let E=null,R=p3(d,u,j,k);for(const $ of x){const V=p3(d-$.x,u,j,k)+$.badness;V<=R&&(E=$,R=V)}return{index:h,x:d,priorBreak:E,badness:R}}function g3(h){return h?g3(h.priorBreak).concat(h.index):[]}function Tk(h,d,u,x,j,k){if(!h)return[];const E=[],R=function(ee,ce,me,xe,Ne,Te){let Le=0;for(let at=0;at<ee.length();at++){const qe=ee.getSection(at);Le+=f3(ee.getCharCode(at),qe,xe,Ne,ce,Te)}return Le/Math.max(1,Math.ceil(Le/me))}(h,d,u,x,j,k),$=h.text.indexOf("")>=0;let V=0;for(let ee=0;ee<h.length();ee++){const ce=h.getSection(ee),me=h.getCharCode(ee);if(b1[me]||(V+=f3(me,ce,x,j,d,k)),ee<h.length()-1){const xe=!((W=me)<11904)&&(!!us["CJK Compatibility Forms"](W)||!!us["CJK Compatibility"](W)||!!us["CJK Strokes"](W)||!!us["CJK Symbols and Punctuation"](W)||!!us["Enclosed CJK Letters and Months"](W)||!!us["Halfwidth and Fullwidth Forms"](W)||!!us["Ideographic Description Characters"](W)||!!us["Vertical Forms"](W)||wj.test(String.fromCodePoint(W)));(QJ[me]||xe||ce.imageName||ee!==h.length()-2&&JJ[h.getCharCode(ee+1)])&&E.push(x3(ee+1,V,R,E,eee(me,h.getCharCode(ee+1),xe&&$),!1))}}var W;return g3(x3(h.length(),V,R,E,0,!0))}function Ek(h){let d=.5,u=.5;switch(h){case"right":case"top-right":case"bottom-right":d=1;break;case"left":case"top-left":case"bottom-left":d=0}switch(h){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:d,verticalAlign:u}}function tee(h,d,u){const x=d.getMaxScale()*Ra,{maxImageWidth:j,maxImageHeight:k}=d.getMaxImageSize(h),E=Math.max(x,k*u);return{verticalLineContentWidth:Math.max(x,j*u),horizontalLineContentHeight:E}}function y3(h){switch(h){case"top":return 0;case"center":return .5;default:return 1}}function ree(h,d,u){return!(h===c.as.horizontal||!d&&!Sx(u)||d&&(b1[u]||(x=u,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(x)))));var x}function see(h,d,u,x,j,k){const E=k[h.fontStack],R=function(V,W,ee,ce){if(V&&V.rect)return V;const me=W[ee.fontStack],xe=me&&me[ce];return xe?{rect:null,metrics:xe.metrics}:null}(E&&E[d],j,h,d);if(R===null)return null;let $;if(u)$=x.verticalLineContentWidth-h.scale*Ra;else{const V=y3(h.verticalAlign);$=(x.horizontalLineContentHeight-h.scale*Ra)*V}return{rect:R.rect,metrics:R.metrics,baselineOffset:$}}function nee(h,d,u,x,j){const k=j[h.imageName];if(!k)return null;const E=k.paddedRect,R=k.displaySize,$={width:R[0],height:R[1],left:1,top:-3,advance:d?R[1]:R[0]};let V;if(d)V=x.verticalLineContentWidth-R[1]*h.scale;else{const W=y3(h.verticalAlign);V=(x.horizontalLineContentHeight-R[1]*h.scale)*W}return{rect:E,metrics:$,baselineOffset:V,imageOffset:(d?R[0]:R[1])*h.scale-Ra*u}}function aee(h,d,u,x){if(x===0)return;const j=h[u],k=(h[u].x+j.metrics.advance*j.scale)*x;for(let E=d;E<=u;E++)h[E].x-=k}function iee(h,d,u){const{horizontalAlign:x,verticalAlign:j}=Ek(u),k=d[0]-h.displaySize[0]*x,E=d[1]-h.displaySize[1]*j;return{image:h,top:E,bottom:E+h.displaySize[1],left:k,right:k+h.displaySize[0]}}function v3(h){var d,u;let x=h.left,j=h.top,k=h.right-x,E=h.bottom-j;const R=(d=h.image.textFitWidth)!==null&&d!==void 0?d:"stretchOrShrink",$=(u=h.image.textFitHeight)!==null&&u!==void 0?u:"stretchOrShrink",V=(h.image.content[2]-h.image.content[0])/(h.image.content[3]-h.image.content[1]);if($==="proportional"){if(R==="stretchOnly"&&k/E<V||R==="proportional"){const W=Math.ceil(E*V);x*=W/k,k=W}}else if(R==="proportional"&&$==="stretchOnly"&&V!==0&&k/E>V){const W=Math.ceil(k/V);j*=W/E,E=W}return{x1:x,y1:j,x2:x+k,y2:j+E}}function j3(h,d,u,x,j,k){const E=h.image;let R;if(E.content){const Te=E.content,Le=E.pixelRatio||1;R=[Te[0]/Le,Te[1]/Le,E.displaySize[0]-Te[2]/Le,E.displaySize[1]-Te[3]/Le]}const $=d.left*k,V=d.right*k;let W,ee,ce,me;u==="width"||u==="both"?(me=j[0]+$-x[3],ee=j[0]+V+x[1]):(me=j[0]+($+V-E.displaySize[0])/2,ee=me+E.displaySize[0]);const xe=d.top*k,Ne=d.bottom*k;return u==="height"||u==="both"?(W=j[1]+xe-x[0],ce=j[1]+Ne+x[2]):(W=j[1]+(xe+Ne-E.displaySize[1])/2,ce=W+E.displaySize[1]),{image:E,top:W,right:ee,bottom:ce,left:me,collisionPadding:R}}const hu=128,Sh=32640;function b3(h,d){const{expression:u}=d;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new an(h+1))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:x,interpolationType:j}=u;let k=0;for(;k<x.length&&x[k]<=h;)k++;k=Math.max(0,k-1);let E=k;for(;E<x.length&&x[E]<h+1;)E++;E=Math.min(x.length-1,E);const R=x[k],$=x[E];return u.kind==="composite"?{kind:"composite",minZoom:R,maxZoom:$,interpolationType:j}:{kind:"camera",minZoom:R,maxZoom:$,minSize:u.evaluate(new an(R)),maxSize:u.evaluate(new an($)),interpolationType:j}}}function Mk(h,d,u){let x="never";const j=h.get(d);return j?x=j:h.get(u)&&(x="always"),x}const oee=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function _1(h,d,u,x,j,k,E,R,$,V,W,ee,ce){const me=R?Math.min(Sh,Math.round(R[0])):0,xe=R?Math.min(Sh,Math.round(R[1])):0;h.emplaceBack(d,u,Math.round(32*x),Math.round(32*j),k,E,(me<<1)+($?1:0),xe,16*V,16*W,256*ee,256*ce)}function Ok(h,d,u){h.emplaceBack(d.x,d.y,u),h.emplaceBack(d.x,d.y,u),h.emplaceBack(d.x,d.y,u),h.emplaceBack(d.x,d.y,u)}function lee(h){for(const d of h.sections)if(lk(d.text))return!0;return!1}class Ik{constructor(d){this.layoutVertexArray=new ut,this.indexArray=new Dt,this.programConfigurations=d,this.segments=new es,this.dynamicLayoutVertexArray=new mt,this.opacityVertexArray=new xt,this.hasVisibleVertices=!1,this.placedSymbolArray=new G}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(d,u,x,j){this.isEmpty()||(x&&(this.layoutVertexBuffer=d.createVertexBuffer(this.layoutVertexArray,DJ.members),this.indexBuffer=d.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=d.createVertexBuffer(this.dynamicLayoutVertexArray,RJ.members,!0),this.opacityVertexBuffer=d.createVertexBuffer(this.opacityVertexArray,oee,!0),this.opacityVertexBuffer.itemSize=1),(x||j)&&this.programConfigurations.upload(d))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}pr("SymbolBuffers",Ik);class Dk{constructor(d,u,x){this.layoutVertexArray=new d,this.layoutAttributes=u,this.indexArray=new x,this.segments=new es,this.collisionVertexArray=new Wt}upload(d){this.layoutVertexBuffer=d.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=d.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=d.createVertexBuffer(this.collisionVertexArray,LJ.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}pr("CollisionBuffers",Dk);class Vx{constructor(d){this.collisionBoxArray=d.collisionBoxArray,this.zoom=d.zoom,this.overscaling=xn(globalThis)?Math.min(d.overscaling,128):d.overscaling,this.layers=d.layers,this.layerIds=this.layers.map(E=>E.id),this.index=d.index,this.pixelRatio=d.pixelRatio,this.sourceLayerIndex=d.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=b3(this.zoom,u["text-size"]),this.iconSizeData=b3(this.zoom,u["icon-size"]);const x=this.layers[0].layout,j=x.get("symbol-sort-key"),k=x.get("symbol-z-order");this.canOverlap=Mk(x,"text-overlap","text-allow-overlap")!=="never"||Mk(x,"icon-overlap","icon-allow-overlap")!=="never"||x.get("text-ignore-placement")||x.get("icon-ignore-placement"),this.sortFeaturesByKey=k!=="viewport-y"&&!j.isConstant(),this.sortFeaturesByY=(k==="viewport-y"||k==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,x.get("symbol-placement")==="point"&&(this.writingModes=x.get("text-writing-mode").map(E=>c.as[E])),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.sourceID=d.sourceID}createArrays(){this.text=new Ik(new du(this.layers,this.zoom,d=>/^text/.test(d))),this.icon=new Ik(new du(this.layers,this.zoom,d=>/^icon/.test(d))),this.glyphOffsetArray=new ie,this.lineVertexArray=new fe,this.symbolInstances=new le,this.textAnchorOffsets=new Ee}calculateGlyphDependencies(d,u,x,j,k){for(let E=0;E<d.length;E++)if(u[d.charCodeAt(E)]=!0,(x||j)&&k){const R=Uj[d.charAt(E)];R&&(u[R.charCodeAt(0)]=!0)}}populate(d,u,x){const j=this.layers[0],k=j.layout,E=k.get("text-font"),R=k.get("text-field"),$=k.get("icon-image"),V=(R.value.kind!=="constant"||R.value.value instanceof Xi&&!R.value.value.isEmpty()||R.value.value.toString().length>0)&&(E.value.kind!=="constant"||E.value.value.length>0),W=$.value.kind!=="constant"||!!$.value.value||Object.keys($.parameters).length>0,ee=k.get("symbol-sort-key");if(this.features=[],!V&&!W)return;const ce=u.iconDependencies,me=u.glyphDependencies,xe=u.availableImages,Ne=new an(this.zoom);for(const{feature:Te,id:Le,index:at,sourceLayerIndex:qe}of d){const Ze=j._featureFilter.needGeometry,ht=ld(Te,Ze);if(!j._featureFilter.filter(Ne,ht,x))continue;let jt,zt;if(Ze||(ht.geometry=gc(Te)),V){const Gt=j.getValueAndResolveTokens("text-field",ht,x,xe),rr=Xi.factory(Gt),kr=this.hasRTLText=this.hasRTLText||lee(rr);(!kr||mc.getRTLTextPluginStatus()==="unavailable"||kr&&mc.isParsed())&&(jt=$J(rr,j,ht))}if(W){const Gt=j.getValueAndResolveTokens("icon-image",ht,x,xe);zt=Gt instanceof Oi?Gt:Oi.fromString(Gt)}if(!jt&&!zt)continue;const ar=this.sortFeaturesByKey?ee.evaluate(ht,{},x):void 0;if(this.features.push({id:Le,text:jt,icon:zt,index:at,sourceLayerIndex:qe,geometry:ht.geometry,properties:Te.properties,type:zx.types[Te.type],sortKey:ar}),zt&&(ce[zt.name]=!0),jt){const Gt=E.evaluate(ht,{},x).join(","),rr=k.get("text-rotation-alignment")!=="viewport"&&k.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(c.as.vertical)>=0;for(const kr of jt.sections)if(kr.image)ce[kr.image.name]=!0;else{const Jt=bj(jt.toString()),sr=kr.fontStack||Gt,Ot=me[sr]=me[sr]||{};this.calculateGlyphDependencies(kr.text,Ot,rr,this.allowVerticalPlacement,Jt)}}}k.get("symbol-placement")==="line"&&(this.features=function(Te){const Le={},at={},qe=[];let Ze=0;function ht(Gt){qe.push(Te[Gt]),Ze++}function jt(Gt,rr,kr){const Jt=at[Gt];return delete at[Gt],at[rr]=Jt,qe[Jt].geometry[0].pop(),qe[Jt].geometry[0]=qe[Jt].geometry[0].concat(kr[0]),Jt}function zt(Gt,rr,kr){const Jt=Le[rr];return delete Le[rr],Le[Gt]=Jt,qe[Jt].geometry[0].shift(),qe[Jt].geometry[0]=kr[0].concat(qe[Jt].geometry[0]),Jt}function ar(Gt,rr,kr){const Jt=kr?rr[0][rr[0].length-1]:rr[0][0];return`${Gt}:${Jt.x}:${Jt.y}`}for(let Gt=0;Gt<Te.length;Gt++){const rr=Te[Gt],kr=rr.geometry,Jt=rr.text?rr.text.toString():null;if(!Jt){ht(Gt);continue}const sr=ar(Jt,kr),Ot=ar(Jt,kr,!0);if(sr in at&&Ot in Le&&at[sr]!==Le[Ot]){const zr=zt(sr,Ot,kr),Vr=jt(sr,Ot,qe[zr].geometry);delete Le[sr],delete at[Ot],at[ar(Jt,qe[Vr].geometry,!0)]=Vr,qe[zr].geometry=null}else sr in at?jt(sr,Ot,kr):Ot in Le?zt(sr,Ot,kr):(ht(Gt),Le[sr]=Ze-1,at[Ot]=Ze-1)}return qe.filter(Gt=>Gt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Te,Le)=>Te.sortKey-Le.sortKey)}update(d,u,x){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(d,u,this.layers,{imagePositions:x}),this.icon.programConfigurations.updatePaintArrays(d,u,this.layers,{imagePositions:x}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(d){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(d),this.iconCollisionBox.upload(d)),this.text.upload(d,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(d,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(d,u){const x=this.lineVertexArray.length;if(d.segment!==void 0){let j=d.dist(u[d.segment+1]),k=d.dist(u[d.segment]);const E={};for(let R=d.segment+1;R<u.length;R++)E[R]={x:u[R].x,y:u[R].y,tileUnitDistanceFromAnchor:j},R<u.length-1&&(j+=u[R+1].dist(u[R]));for(let R=d.segment||0;R>=0;R--)E[R]={x:u[R].x,y:u[R].y,tileUnitDistanceFromAnchor:k},R>0&&(k+=u[R-1].dist(u[R]));for(let R=0;R<u.length;R++){const $=E[R];this.lineVertexArray.emplaceBack($.x,$.y,$.tileUnitDistanceFromAnchor)}}return{lineStartIndex:x,lineLength:this.lineVertexArray.length-x}}addSymbols(d,u,x,j,k,E,R,$,V,W,ee,ce){const me=d.indexArray,xe=d.layoutVertexArray,Ne=d.segments.prepareSegment(4*u.length,xe,me,this.canOverlap?E.sortKey:void 0),Te=this.glyphOffsetArray.length,Le=Ne.vertexLength,at=this.allowVerticalPlacement&&R===c.as.vertical?Math.PI/2:0,qe=E.text&&E.text.sections;for(let Ze=0;Ze<u.length;Ze++){const{tl:ht,tr:jt,bl:zt,br:ar,tex:Gt,pixelOffsetTL:rr,pixelOffsetBR:kr,minFontScaleX:Jt,minFontScaleY:sr,glyphOffset:Ot,isSDF:zr,sectionIndex:Vr}=u[Ze],Ir=Ne.vertexLength,_r=Ot[1];_1(xe,$.x,$.y,ht.x,_r+ht.y,Gt.x,Gt.y,x,zr,rr.x,rr.y,Jt,sr),_1(xe,$.x,$.y,jt.x,_r+jt.y,Gt.x+Gt.w,Gt.y,x,zr,kr.x,rr.y,Jt,sr),_1(xe,$.x,$.y,zt.x,_r+zt.y,Gt.x,Gt.y+Gt.h,x,zr,rr.x,kr.y,Jt,sr),_1(xe,$.x,$.y,ar.x,_r+ar.y,Gt.x+Gt.w,Gt.y+Gt.h,x,zr,kr.x,kr.y,Jt,sr),Ok(d.dynamicLayoutVertexArray,$,at),me.emplaceBack(Ir,Ir+2,Ir+1),me.emplaceBack(Ir+1,Ir+2,Ir+3),Ne.vertexLength+=4,Ne.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ot[0]),Ze!==u.length-1&&Vr===u[Ze+1].sectionIndex||d.programConfigurations.populatePaintArrays(xe.length,E,E.index,{imagePositions:{},canonical:ce,formattedSection:qe&&qe[Vr]})}d.placedSymbolArray.emplaceBack($.x,$.y,Te,this.glyphOffsetArray.length-Te,Le,V,W,$.segment,x?x[0]:0,x?x[1]:0,j[0],j[1],R,0,!1,0,ee)}_addCollisionDebugVertex(d,u,x,j,k,E){return u.emplaceBack(0,0),d.emplaceBack(x.x,x.y,j,k,Math.round(E.x),Math.round(E.y))}addCollisionDebugVertices(d,u,x,j,k,E,R){const $=k.segments.prepareSegment(4,k.layoutVertexArray,k.indexArray),V=$.vertexLength,W=k.layoutVertexArray,ee=k.collisionVertexArray,ce=R.anchorX,me=R.anchorY;this._addCollisionDebugVertex(W,ee,E,ce,me,new f(d,u)),this._addCollisionDebugVertex(W,ee,E,ce,me,new f(x,u)),this._addCollisionDebugVertex(W,ee,E,ce,me,new f(x,j)),this._addCollisionDebugVertex(W,ee,E,ce,me,new f(d,j)),$.vertexLength+=4;const xe=k.indexArray;xe.emplaceBack(V,V+1),xe.emplaceBack(V+1,V+2),xe.emplaceBack(V+2,V+3),xe.emplaceBack(V+3,V),$.primitiveLength+=4}addDebugCollisionBoxes(d,u,x,j){for(let k=d;k<u;k++){const E=this.collisionBoxArray.get(k);this.addCollisionDebugVertices(E.x1,E.y1,E.x2,E.y2,j?this.textCollisionBox:this.iconCollisionBox,E.anchorPoint,x)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Dk(Ut,l3.members,jr),this.iconCollisionBox=new Dk(Ut,l3.members,jr);for(let d=0;d<this.symbolInstances.length;d++){const u=this.symbolInstances.get(d);this.addDebugCollisionBoxes(u.textBoxStartIndex,u.textBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.iconBoxStartIndex,u.iconBoxEndIndex,u,!1),this.addDebugCollisionBoxes(u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex,u,!1)}}_deserializeCollisionBoxesForSymbol(d,u,x,j,k,E,R,$,V){const W={};for(let ee=u;ee<x;ee++){const ce=d.get(ee);W.textBox={x1:ce.x1,y1:ce.y1,x2:ce.x2,y2:ce.y2,anchorPointX:ce.anchorPointX,anchorPointY:ce.anchorPointY},W.textFeatureIndex=ce.featureIndex;break}for(let ee=j;ee<k;ee++){const ce=d.get(ee);W.verticalTextBox={x1:ce.x1,y1:ce.y1,x2:ce.x2,y2:ce.y2,anchorPointX:ce.anchorPointX,anchorPointY:ce.anchorPointY},W.verticalTextFeatureIndex=ce.featureIndex;break}for(let ee=E;ee<R;ee++){const ce=d.get(ee);W.iconBox={x1:ce.x1,y1:ce.y1,x2:ce.x2,y2:ce.y2,anchorPointX:ce.anchorPointX,anchorPointY:ce.anchorPointY},W.iconFeatureIndex=ce.featureIndex;break}for(let ee=$;ee<V;ee++){const ce=d.get(ee);W.verticalIconBox={x1:ce.x1,y1:ce.y1,x2:ce.x2,y2:ce.y2,anchorPointX:ce.anchorPointX,anchorPointY:ce.anchorPointY},W.verticalIconFeatureIndex=ce.featureIndex;break}return W}deserializeCollisionBoxes(d){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const x=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(d,x.textBoxStartIndex,x.textBoxEndIndex,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x.iconBoxStartIndex,x.iconBoxEndIndex,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(d,u){const x=d.placedSymbolArray.get(u),j=x.vertexStartIndex+4*x.numGlyphs;for(let k=x.vertexStartIndex;k<j;k+=4)d.indexArray.emplaceBack(k,k+2,k+1),d.indexArray.emplaceBack(k+1,k+2,k+3)}getSortedSymbolIndexes(d){if(this.sortedAngle===d&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const u=Math.sin(d),x=Math.cos(d),j=[],k=[],E=[];for(let R=0;R<this.symbolInstances.length;++R){E.push(R);const $=this.symbolInstances.get(R);j.push(0|Math.round(u*$.anchorX+x*$.anchorY)),k.push($.featureIndex)}return E.sort((R,$)=>j[R]-j[$]||k[$]-k[R]),E}addToSortKeyRanges(d,u){const x=this.sortKeyRanges[this.sortKeyRanges.length-1];x&&x.sortKey===u?x.symbolInstanceEnd=d+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:d,symbolInstanceEnd:d+1})}sortFeatures(d){if(this.sortFeaturesByY&&this.sortedAngle!==d&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(d),this.sortedAngle=d,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const x=this.symbolInstances.get(u);this.featureSortOrder.push(x.featureIndex),[x.rightJustifiedTextSymbolIndex,x.centerJustifiedTextSymbolIndex,x.leftJustifiedTextSymbolIndex].forEach((j,k,E)=>{j>=0&&E.indexOf(j)===k&&this.addIndicesForPlacedSymbol(this.text,j)}),x.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,x.verticalPlacedTextSymbolIndex),x.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,x.placedIconSymbolIndex),x.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,x.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let _3,w3;pr("SymbolBucket",Vx,{omit:["layers","collisionBoxArray","features","compareText"]}),Vx.MAX_GLYPHS=65535,Vx.addDynamicAttributes=Ok;var Rk={get paint(){return w3=w3||new gi({"icon-opacity":new Lr(ot.paint_symbol["icon-opacity"]),"icon-color":new Lr(ot.paint_symbol["icon-color"]),"icon-halo-color":new Lr(ot.paint_symbol["icon-halo-color"]),"icon-halo-width":new Lr(ot.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Lr(ot.paint_symbol["icon-halo-blur"]),"icon-translate":new Nr(ot.paint_symbol["icon-translate"]),"icon-translate-anchor":new Nr(ot.paint_symbol["icon-translate-anchor"]),"text-opacity":new Lr(ot.paint_symbol["text-opacity"]),"text-color":new Lr(ot.paint_symbol["text-color"],{runtimeType:Xo,getOverride:h=>h.textColor,hasOverride:h=>!!h.textColor}),"text-halo-color":new Lr(ot.paint_symbol["text-halo-color"]),"text-halo-width":new Lr(ot.paint_symbol["text-halo-width"]),"text-halo-blur":new Lr(ot.paint_symbol["text-halo-blur"]),"text-translate":new Nr(ot.paint_symbol["text-translate"]),"text-translate-anchor":new Nr(ot.paint_symbol["text-translate-anchor"])})},get layout(){return _3=_3||new gi({"symbol-placement":new Nr(ot.layout_symbol["symbol-placement"]),"symbol-spacing":new Nr(ot.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Nr(ot.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Lr(ot.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Nr(ot.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Nr(ot.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Nr(ot.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Nr(ot.layout_symbol["icon-ignore-placement"]),"icon-optional":new Nr(ot.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Nr(ot.layout_symbol["icon-rotation-alignment"]),"icon-size":new Lr(ot.layout_symbol["icon-size"]),"icon-text-fit":new Nr(ot.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Nr(ot.layout_symbol["icon-text-fit-padding"]),"icon-image":new Lr(ot.layout_symbol["icon-image"]),"icon-rotate":new Lr(ot.layout_symbol["icon-rotate"]),"icon-padding":new Lr(ot.layout_symbol["icon-padding"]),"icon-keep-upright":new Nr(ot.layout_symbol["icon-keep-upright"]),"icon-offset":new Lr(ot.layout_symbol["icon-offset"]),"icon-anchor":new Lr(ot.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Nr(ot.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Nr(ot.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Nr(ot.layout_symbol["text-rotation-alignment"]),"text-field":new Lr(ot.layout_symbol["text-field"]),"text-font":new Lr(ot.layout_symbol["text-font"]),"text-size":new Lr(ot.layout_symbol["text-size"]),"text-max-width":new Lr(ot.layout_symbol["text-max-width"]),"text-line-height":new Nr(ot.layout_symbol["text-line-height"]),"text-letter-spacing":new Lr(ot.layout_symbol["text-letter-spacing"]),"text-justify":new Lr(ot.layout_symbol["text-justify"]),"text-radial-offset":new Lr(ot.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Nr(ot.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Lr(ot.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Lr(ot.layout_symbol["text-anchor"]),"text-max-angle":new Nr(ot.layout_symbol["text-max-angle"]),"text-writing-mode":new Nr(ot.layout_symbol["text-writing-mode"]),"text-rotate":new Lr(ot.layout_symbol["text-rotate"]),"text-padding":new Nr(ot.layout_symbol["text-padding"]),"text-keep-upright":new Nr(ot.layout_symbol["text-keep-upright"]),"text-transform":new Lr(ot.layout_symbol["text-transform"]),"text-offset":new Lr(ot.layout_symbol["text-offset"]),"text-allow-overlap":new Nr(ot.layout_symbol["text-allow-overlap"]),"text-overlap":new Nr(ot.layout_symbol["text-overlap"]),"text-ignore-placement":new Nr(ot.layout_symbol["text-ignore-placement"]),"text-optional":new Nr(ot.layout_symbol["text-optional"])})}};class N3{constructor(d){if(d.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=d.property.overrides?d.property.overrides.runtimeType:Xa,this.defaultValue=d}evaluate(d){if(d.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(d.formattedSection))return u.getOverride(d.formattedSection)}return d.feature&&d.featureState?this.defaultValue.evaluate(d.feature,d.featureState):this.defaultValue.property.specification.default}eachChild(d){this.defaultValue.isConstant()||d(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}pr("FormatSectionOverride",N3,{omit:["defaultValue"]});class w1 extends el{constructor(d,u){super(d,Rk,u)}recalculate(d,u){if(super.recalculate(d,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const x=this.layout.get("text-writing-mode");if(x){const j=[];for(const k of x)j.indexOf(k)<0&&j.push(k);this.layout._values["text-writing-mode"]=j}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(d,u,x,j){const k=this.layout.get(d).evaluate(u,{},x,j),E=this._unevaluatedLayout._values[d];return E.isDataDriven()||px(E.value)||!k?k:function(R,$){return $.replace(/{([^{}]+)}/g,(V,W)=>R&&W in R?String(R[W]):"")}(u.properties,k)}createBucket(d){return new Vx(d)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const d of Rk.paint.overridableProperties){if(!w1.hasPaintOverride(this.layout,d))continue;const u=this.paint.get(d),x=new N3(u),j=new oj(x,u.property.specification);let k=null;k=u.value.kind==="constant"||u.value.kind==="source"?new ff("source",j):new lj("composite",j,u.value.zoomStops),this.paint._values[d]=new Jo(u.property,k,u.parameters)}}_handleOverridablePaintPropertyUpdate(d,u,x){return!(!this.layout||u.isDataDriven()||x.isDataDriven())&&w1.hasPaintOverride(this.layout,d)}static hasPaintOverride(d,u){const x=d.get("text-field"),j=Rk.paint.properties[u];let k=!1;const E=R=>{for(const $ of R)if(j.overrides&&j.overrides.hasOverride($))return void(k=!0)};if(x.value.kind==="constant"&&x.value.value instanceof Xi)E(x.value.value.sections);else if(x.value.kind==="source"||x.value.kind==="composite"){const R=V=>{k||(V instanceof td&&Xn(V.value)===Bd?E(V.value.sections):V instanceof nx?E(V.sections):V.eachChild(R))},$=x.value;$._styleExpression&&R($._styleExpression.expression)}return k}}let S3;var cee={get paint(){return S3=S3||new gi({"background-color":new Nr(ot.paint_background["background-color"]),"background-pattern":new i1(ot.paint_background["background-pattern"]),"background-opacity":new Nr(ot.paint_background["background-opacity"])})}};class dee extends el{constructor(d,u){super(d,cee,u)}}class uee extends el{constructor(d,u){super(d,{},u),this.onAdd=x=>{this.implementation.onAdd&&this.implementation.onAdd(x,x.painter.context.gl)},this.onRemove=x=>{this.implementation.onRemove&&this.implementation.onRemove(x,x.painter.context.gl)},this.implementation=d}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class hee{constructor(d){this._methodToThrottle=d,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const mee={once:!0},Lk=63710088e-1;class Ch{constructor(d,u){if(isNaN(d)||isNaN(u))throw new Error(`Invalid LngLat object: (${d}, ${u})`);if(this.lng=+d,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ch(Ct(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(d){const u=Math.PI/180,x=this.lat*u,j=d.lat*u,k=Math.sin(x)*Math.sin(j)+Math.cos(x)*Math.cos(j)*Math.cos((d.lng-this.lng)*u);return Lk*Math.acos(Math.min(k,1))}static convert(d){if(d instanceof Ch)return d;if(Array.isArray(d)&&(d.length===2||d.length===3))return new Ch(Number(d[0]),Number(d[1]));if(!Array.isArray(d)&&typeof d=="object"&&d!==null)return new Ch(Number("lng"in d?d.lng:d.lon),Number(d.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const C3=2*Math.PI*Lk;function P3(h){return C3*Math.cos(h*Math.PI/180)}function k3(h){return(180+h)/360}function A3(h){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h*Math.PI/360)))/360}function T3(h,d){return h/P3(d)}function E3(h){return 360*h-180}function N1(h){return 360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90}function M3(h,d){return h*P3(N1(d))}class Gj{constructor(d,u,x=0){this.x=+d,this.y=+u,this.z=+x}static fromLngLat(d,u=0){const x=Ch.convert(d);return new Gj(k3(x.lng),A3(x.lat),T3(u,x.lat))}toLngLat(){return new Ch(E3(this.x),N1(this.y))}toAltitude(){return M3(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/C3*(d=N1(this.y),1/Math.cos(d*Math.PI/180));var d}}function O3(h,d,u){var x=2*Math.PI*6378137/256/Math.pow(2,u);return[h*x-2*Math.PI*6378137/2,d*x-2*Math.PI*6378137/2]}class Fk{constructor(d,u,x){if(!function(j,k,E){return!(j<0||j>25||E<0||E>=Math.pow(2,j)||k<0||k>=Math.pow(2,j))}(d,u,x))throw new Error(`x=${u}, y=${x}, z=${d} outside of bounds. 0<=x<${Math.pow(2,d)}, 0<=y<${Math.pow(2,d)} 0<=z<=25 `);this.z=d,this.x=u,this.y=x,this.key=Ux(0,d,d,u,x)}equals(d){return this.z===d.z&&this.x===d.x&&this.y===d.y}url(d,u,x){const j=(E=this.y,R=this.z,$=O3(256*(k=this.x),256*(E=Math.pow(2,R)-E-1),R),V=O3(256*(k+1),256*(E+1),R),$[0]+","+$[1]+","+V[0]+","+V[1]);var k,E,R,$,V;const W=function(ee,ce,me){let xe,Ne="";for(let Te=ee;Te>0;Te--)xe=1<<Te-1,Ne+=(ce&xe?1:0)+(me&xe?2:0);return Ne}(this.z,this.x,this.y);return d[(this.x+this.y)%d.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(x==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,u>1?"@2x":"").replace(/{quadkey}/g,W).replace(/{bbox-epsg-3857}/g,j)}isChildOf(d){const u=this.z-d.z;return u>0&&d.x===this.x>>u&&d.y===this.y>>u}getTilePoint(d){const u=Math.pow(2,this.z);return new f((d.x*u-this.x)*de,(d.y*u-this.y)*de)}toString(){return`${this.z}/${this.x}/${this.y}`}}class I3{constructor(d,u){this.wrap=d,this.canonical=u,this.key=Ux(d,u.z,u.z,u.x,u.y)}}class rl{constructor(d,u,x,j,k){if(this.terrainRttPosMatrix32f=null,d<x)throw new Error(`overscaledZ should be >= z; overscaledZ = ${d}; z = ${x}`);this.overscaledZ=d,this.wrap=u,this.canonical=new Fk(x,+j,+k),this.key=Ux(u,d,x,j,k)}clone(){return new rl(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(d){return this.overscaledZ===d.overscaledZ&&this.wrap===d.wrap&&this.canonical.equals(d.canonical)}scaledTo(d){if(d>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${d}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-d;return d>this.canonical.z?new rl(d,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new rl(d,this.wrap,d,this.canonical.x>>u,this.canonical.y>>u)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(d,u){if(d>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${d}; overscaledZ = ${this.overscaledZ}`);const x=this.canonical.z-d;return d>this.canonical.z?Ux(this.wrap*+u,d,this.canonical.z,this.canonical.x,this.canonical.y):Ux(this.wrap*+u,d,d,this.canonical.x>>x,this.canonical.y>>x)}isChildOf(d){if(d.wrap!==this.wrap||this.overscaledZ-d.overscaledZ<=0)return!1;if(d.overscaledZ===0)return this.overscaledZ>0;const u=this.canonical.z-d.canonical.z;return!(u<0)&&d.canonical.x===this.canonical.x>>u&&d.canonical.y===this.canonical.y>>u}children(d){if(this.overscaledZ>=d)return[new rl(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,x=2*this.canonical.x,j=2*this.canonical.y;return[new rl(u,this.wrap,u,x,j),new rl(u,this.wrap,u,x+1,j),new rl(u,this.wrap,u,x,j+1),new rl(u,this.wrap,u,x+1,j+1)]}isLessThan(d){return this.wrap<d.wrap||!(this.wrap>d.wrap)&&(this.overscaledZ<d.overscaledZ||!(this.overscaledZ>d.overscaledZ)&&(this.canonical.x<d.canonical.x||!(this.canonical.x>d.canonical.x)&&this.canonical.y<d.canonical.y))}wrapped(){return new rl(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(d){return new rl(this.overscaledZ,d,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new I3(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(d){return this.canonical.getTilePoint(new Gj(d.x-this.wrap,d.y))}}function Ux(h,d,u,x,j){(h*=2)<0&&(h=-1*h-1);const k=1<<u;return(k*k*h+k*j+x).toString(36)+u.toString(36)+d.toString(36)}function Kj(h,d){return d?h.properties[d]:h.id}pr("CanonicalTileID",Fk),pr("OverscaledTileID",rl,{omit:["terrainRttPosMatrix32f"]});class kf{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(d){return this.minX=Math.min(this.minX,d.x),this.minY=Math.min(this.minY,d.y),this.maxX=Math.max(this.maxX,d.x),this.maxY=Math.max(this.maxY,d.y),this}expandBy(d){return this.minX-=d,this.minY-=d,this.maxX+=d,this.maxY+=d,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(d){return this.expandBy(-d)}map(d){const u=new kf;return u.extend(d(new f(this.minX,this.minY))),u.extend(d(new f(this.maxX,this.minY))),u.extend(d(new f(this.minX,this.maxY))),u.extend(d(new f(this.maxX,this.maxY))),u}static fromPoints(d){const u=new kf;for(const x of d)u.extend(x);return u}contains(d){return d.x>=this.minX&&d.x<=this.maxX&&d.y>=this.minY&&d.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(d){return!this.empty()&&!d.empty()&&d.minX>=this.minX&&d.maxX<=this.maxX&&d.minY>=this.minY&&d.maxY<=this.maxY}intersects(d){return!this.empty()&&!d.empty()&&d.minX<=this.maxX&&d.maxX>=this.minX&&d.minY<=this.maxY&&d.maxY>=this.minY}}class D3{constructor(d){this._stringToNumber={},this._numberToString=[];for(let u=0;u<d.length;u++){const x=d[u];this._stringToNumber[x]=u,this._numberToString[u]=x}}encode(d){return this._stringToNumber[d]}decode(d){if(d>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${d} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[d]}}class R3{constructor(d,u,x,j,k){this.type="Feature",this._vectorTileFeature=d,d._z=u,d._x=x,d._y=j,this.properties=d.properties,this.id=k}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(d){this._geometry=d}toJSON(){const d={geometry:this.geometry};for(const u in this)u!=="_geometry"&&u!=="_vectorTileFeature"&&(d[u]=this[u]);return d}}class L3{constructor(d,u){this.tileID=d,this.x=d.canonical.x,this.y=d.canonical.y,this.z=d.canonical.z,this.grid=new ru(de,16,0),this.grid3D=new ru(de,16,0),this.featureIndexArray=new Re,this.promoteId=u}insert(d,u,x,j,k,E){const R=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(x,j,k);const $=E?this.grid3D:this.grid;for(let V=0;V<u.length;V++){const W=u[V],ee=[1/0,1/0,-1/0,-1/0];for(let ce=0;ce<W.length;ce++){const me=W[ce];ee[0]=Math.min(ee[0],me.x),ee[1]=Math.min(ee[1],me.y),ee[2]=Math.max(ee[2],me.x),ee[3]=Math.max(ee[3],me.y)}ee[0]<de&&ee[1]<de&&ee[2]>=0&&ee[3]>=0&&$.insert(R,ee[0],ee[1],ee[2],ee[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new JR(new kk(this.rawTileData)).layers,this.sourceLayerCoder=new D3(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(d,u,x,j){this.loadVTLayers();const k=d.params,E=de/d.tileSize/d.scale,R=pf(k.filter,k.globalState),$=d.queryGeometry,V=d.queryPadding*E,W=kf.fromPoints($),ee=this.grid.query(W.minX-V,W.minY-V,W.maxX+V,W.maxY+V),ce=kf.fromPoints(d.cameraQueryGeometry).expandBy(V),me=this.grid3D.query(ce.minX,ce.minY,ce.maxX,ce.maxY,(Te,Le,at,qe)=>function(Ze,ht,jt,zt,ar){for(const rr of Ze)if(ht<=rr.x&&jt<=rr.y&&zt>=rr.x&&ar>=rr.y)return!0;const Gt=[new f(ht,jt),new f(ht,ar),new f(zt,ar),new f(zt,jt)];if(Ze.length>2){for(const rr of Gt)if(Dx(Ze,rr))return!0}for(let rr=0;rr<Ze.length-1;rr++)if(VQ(Ze[rr],Ze[rr+1],Gt))return!0;return!1}(d.cameraQueryGeometry,Te-V,Le-V,at+V,qe+V));for(const Te of me)ee.push(Te);ee.sort(fee);const xe={};let Ne;for(let Te=0;Te<ee.length;Te++){const Le=ee[Te];if(Le===Ne)continue;Ne=Le;const at=this.featureIndexArray.get(Le);let qe=null;this.loadMatchingFeature(xe,at.bucketIndex,at.sourceLayerIndex,at.featureIndex,R,k.layers,k.availableImages,u,x,j,(Ze,ht,jt)=>(qe||(qe=gc(Ze)),ht.queryIntersectsFeature({queryGeometry:$,feature:Ze,featureState:jt,geometry:qe,zoom:this.z,transform:d.transform,pixelsToTileUnits:E,pixelPosMatrix:d.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:d.getElevation})))}return xe}loadMatchingFeature(d,u,x,j,k,E,R,$,V,W,ee){const ce=this.bucketLayerIDs[u];if(E&&!ce.some(Te=>E.has(Te)))return;const me=this.sourceLayerCoder.decode(x),xe=this.vtLayers[me].feature(j);if(k.needGeometry){const Te=ld(xe,!0);if(!k.filter(new an(this.tileID.overscaledZ),Te,this.tileID.canonical))return}else if(!k.filter(new an(this.tileID.overscaledZ),xe))return;const Ne=this.getId(xe,me);for(let Te=0;Te<ce.length;Te++){const Le=ce[Te];if(E&&!E.has(Le))continue;const at=$[Le];if(!at)continue;let qe={};Ne&&W&&(qe=W.getState(at.sourceLayer||"_geojsonTileLayer",Ne));const Ze=ur({},V[Le]);Ze.paint=F3(Ze.paint,at.paint,xe,qe,R),Ze.layout=F3(Ze.layout,at.layout,xe,qe,R);const ht=!ee||ee(xe,at,qe);if(!ht)continue;const jt=new R3(xe,this.z,this.x,this.y,Ne);jt.layer=Ze;let zt=d[Le];zt===void 0&&(zt=d[Le]=[]),zt.push({featureIndex:j,feature:jt,intersectionZ:ht})}}lookupSymbolFeatures(d,u,x,j,k,E,R,$){const V={};this.loadVTLayers();const W=pf(k.filterSpec,k.globalState);for(const ee of d)this.loadMatchingFeature(V,x,j,ee,W,E,R,$,u);return V}hasLayer(d){for(const u of this.bucketLayerIDs)for(const x of u)if(d===x)return!0;return!1}getId(d,u){var x;let j=d.id;return this.promoteId&&(j=d.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[u]],typeof j=="boolean"&&(j=Number(j)),j===void 0&&(!((x=d.properties)===null||x===void 0)&&x.cluster)&&this.promoteId&&(j=Number(d.properties.cluster_id))),j}}function F3(h,d,u,x,j){return Ht(h,(k,E)=>{const R=d instanceof su?d.get(E):null;return R&&R.evaluate?R.evaluate(u,x,j):R})}function fee(h,d){return d-h}function $3(h,d,u,x,j){const k=[];for(let E=0;E<h.length;E++){const R=h[E];let $;for(let V=0;V<R.length-1;V++){let W=R[V],ee=R[V+1];W.x<d&&ee.x<d||(W.x<d?W=new f(d,W.y+(d-W.x)/(ee.x-W.x)*(ee.y-W.y))._round():ee.x<d&&(ee=new f(d,W.y+(d-W.x)/(ee.x-W.x)*(ee.y-W.y))._round()),W.y<u&&ee.y<u||(W.y<u?W=new f(W.x+(u-W.y)/(ee.y-W.y)*(ee.x-W.x),u)._round():ee.y<u&&(ee=new f(W.x+(u-W.y)/(ee.y-W.y)*(ee.x-W.x),u)._round()),W.x>=x&&ee.x>=x||(W.x>=x?W=new f(x,W.y+(x-W.x)/(ee.x-W.x)*(ee.y-W.y))._round():ee.x>=x&&(ee=new f(x,W.y+(x-W.x)/(ee.x-W.x)*(ee.y-W.y))._round()),W.y>=j&&ee.y>=j||(W.y>=j?W=new f(W.x+(j-W.y)/(ee.y-W.y)*(ee.x-W.x),j)._round():ee.y>=j&&(ee=new f(W.x+(j-W.y)/(ee.y-W.y)*(ee.x-W.x),j)._round()),$&&W.equals($[$.length-1])||($=[W],k.push($)),$.push(ee)))))}}return k}pr("FeatureIndex",L3,{omit:["rawTileData","sourceLayerCoder"]});class Ph extends f{constructor(d,u,x,j){super(d,u),this.angle=x,j!==void 0&&(this.segment=j)}clone(){return new Ph(this.x,this.y,this.angle,this.segment)}}function z3(h,d,u,x,j){if(d.segment===void 0||u===0)return!0;let k=d,E=d.segment+1,R=0;for(;R>-u/2;){if(E--,E<0)return!1;R-=h[E].dist(k),k=h[E]}R+=h[E].dist(h[E+1]),E++;const $=[];let V=0;for(;R<u/2;){const W=h[E],ee=h[E+1];if(!ee)return!1;let ce=h[E-1].angleTo(W)-W.angleTo(ee);for(ce=Math.abs((ce+3*Math.PI)%(2*Math.PI)-Math.PI),$.push({distance:R,angleDelta:ce}),V+=ce;R-$[0].distance>x;)V-=$.shift().angleDelta;if(V>j)return!1;E++,R+=W.dist(ee)}return!0}function B3(h){let d=0;for(let u=0;u<h.length-1;u++)d+=h[u].dist(h[u+1]);return d}function q3(h,d,u){return h?.6*d*u:0}function V3(h,d){return Math.max(h?h.right-h.left:0,d?d.right-d.left:0)}function pee(h,d,u,x,j,k){const E=q3(u,j,k),R=V3(u,x)*k;let $=0;const V=B3(h)/2;for(let W=0;W<h.length-1;W++){const ee=h[W],ce=h[W+1],me=ee.dist(ce);if($+me>V){const xe=(V-$)/me,Ne=Eo.number(ee.x,ce.x,xe),Te=Eo.number(ee.y,ce.y,xe),Le=new Ph(Ne,Te,ce.angleTo(ee),W);return Le._round(),!E||z3(h,Le,R,E,d)?Le:void 0}$+=me}}function xee(h,d,u,x,j,k,E,R,$){const V=q3(x,k,E),W=V3(x,j),ee=W*E,ce=h[0].x===0||h[0].x===$||h[0].y===0||h[0].y===$;return d-ee<d/4&&(d=ee+d/4),U3(h,ce?d/2*R%d:(W/2+2*k)*E*R%d,d,V,u,ee,ce,!1,$)}function U3(h,d,u,x,j,k,E,R,$){const V=k/2,W=B3(h);let ee=0,ce=d-u,me=[];for(let xe=0;xe<h.length-1;xe++){const Ne=h[xe],Te=h[xe+1],Le=Ne.dist(Te),at=Te.angleTo(Ne);for(;ce+u<ee+Le;){ce+=u;const qe=(ce-ee)/Le,Ze=Eo.number(Ne.x,Te.x,qe),ht=Eo.number(Ne.y,Te.y,qe);if(Ze>=0&&Ze<$&&ht>=0&&ht<$&&ce-V>=0&&ce+V<=W){const jt=new Ph(Ze,ht,at,xe);jt._round(),x&&!z3(h,jt,k,x,j)||me.push(jt)}}ee+=Le}return R||me.length||E||(me=U3(h,ee/2,u,x,j,k,E,!0,$)),me}function W3(h,d,u,x){const j=[],k=h.image,E=k.pixelRatio,R=k.paddedRect.w-2,$=k.paddedRect.h-2;let V={x1:h.left,y1:h.top,x2:h.right,y2:h.bottom};const W=k.stretchX||[[0,R]],ee=k.stretchY||[[0,$]],ce=(Ot,zr)=>Ot+zr[1]-zr[0],me=W.reduce(ce,0),xe=ee.reduce(ce,0),Ne=R-me,Te=$-xe;let Le=0,at=me,qe=0,Ze=xe,ht=0,jt=Ne,zt=0,ar=Te;if(k.content&&x){const Ot=k.content,zr=Ot[2]-Ot[0],Vr=Ot[3]-Ot[1];(k.textFitWidth||k.textFitHeight)&&(V=v3(h)),Le=S1(W,0,Ot[0]),qe=S1(ee,0,Ot[1]),at=S1(W,Ot[0],Ot[2]),Ze=S1(ee,Ot[1],Ot[3]),ht=Ot[0]-Le,zt=Ot[1]-qe,jt=zr-at,ar=Vr-Ze}const Gt=V.x1,rr=V.y1,kr=V.x2-Gt,Jt=V.y2-rr,sr=(Ot,zr,Vr,Ir)=>{const _r=C1(Ot.stretch-Le,at,kr,Gt),gs=P1(Ot.fixed-ht,jt,Ot.stretch,me),Bn=C1(zr.stretch-qe,Ze,Jt,rr),Sa=P1(zr.fixed-zt,ar,zr.stretch,xe),vi=C1(Vr.stretch-Le,at,kr,Gt),sl=P1(Vr.fixed-ht,jt,Vr.stretch,me),xo=C1(Ir.stretch-qe,Ze,Jt,rr),Ja=P1(Ir.fixed-zt,ar,Ir.stretch,xe),Dn=new f(_r,Bn),La=new f(vi,Bn),ei=new f(vi,xo),ti=new f(_r,xo),to=new f(gs/E,Sa/E),nl=new f(sl/E,Ja/E),Fa=d*Math.PI/180;if(Fa){const $a=Math.sin(Fa),za=Math.cos(Fa),ya=[za,-$a,$a,za];Dn._matMult(ya),La._matMult(ya),ti._matMult(ya),ei._matMult(ya)}const go=Ot.stretch+Ot.fixed,Ca=zr.stretch+zr.fixed;return{tl:Dn,tr:La,bl:ti,br:ei,tex:{x:k.paddedRect.x+1+go,y:k.paddedRect.y+1+Ca,w:Vr.stretch+Vr.fixed-go,h:Ir.stretch+Ir.fixed-Ca},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:to,pixelOffsetBR:nl,minFontScaleX:jt/E/kr,minFontScaleY:ar/E/Jt,isSDF:u}};if(x&&(k.stretchX||k.stretchY)){const Ot=G3(W,Ne,me),zr=G3(ee,Te,xe);for(let Vr=0;Vr<Ot.length-1;Vr++){const Ir=Ot[Vr],_r=Ot[Vr+1];for(let gs=0;gs<zr.length-1;gs++)j.push(sr(Ir,zr[gs],_r,zr[gs+1]))}}else j.push(sr({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:R+1},{fixed:0,stretch:$+1}));return j}function S1(h,d,u){let x=0;for(const j of h)x+=Math.max(d,Math.min(u,j[1]))-Math.max(d,Math.min(u,j[0]));return x}function G3(h,d,u){const x=[{fixed:-1,stretch:0}];for(const[j,k]of h){const E=x[x.length-1];x.push({fixed:j-E.stretch,stretch:E.stretch}),x.push({fixed:j-E.stretch,stretch:E.stretch+(k-j)})}return x.push({fixed:d+1,stretch:u}),x}function C1(h,d,u,x){return h/d*u+x}function P1(h,d,u,x){return h-d*u/x}pr("Anchor",Ph);class k1{constructor(d,u,x,j,k,E,R,$,V,W){var ee;if(this.boxStartIndex=d.length,V){let ce=E.top,me=E.bottom;const xe=E.collisionPadding;xe&&(ce-=xe[1],me+=xe[3]);let Ne=me-ce;Ne>0&&(Ne=Math.max(10,Ne),this.circleDiameter=Ne)}else{const ce=!((ee=E.image)===null||ee===void 0)&&ee.content&&(E.image.textFitWidth||E.image.textFitHeight)?v3(E):{x1:E.left,y1:E.top,x2:E.right,y2:E.bottom};ce.y1=ce.y1*R-$[0],ce.y2=ce.y2*R+$[2],ce.x1=ce.x1*R-$[3],ce.x2=ce.x2*R+$[1];const me=E.collisionPadding;if(me&&(ce.x1-=me[0]*R,ce.y1-=me[1]*R,ce.x2+=me[2]*R,ce.y2+=me[3]*R),W){const xe=new f(ce.x1,ce.y1),Ne=new f(ce.x2,ce.y1),Te=new f(ce.x1,ce.y2),Le=new f(ce.x2,ce.y2),at=W*Math.PI/180;xe._rotate(at),Ne._rotate(at),Te._rotate(at),Le._rotate(at),ce.x1=Math.min(xe.x,Ne.x,Te.x,Le.x),ce.x2=Math.max(xe.x,Ne.x,Te.x,Le.x),ce.y1=Math.min(xe.y,Ne.y,Te.y,Le.y),ce.y2=Math.max(xe.y,Ne.y,Te.y,Le.y)}d.emplaceBack(u.x,u.y,ce.x1,ce.y1,ce.x2,ce.y2,x,j,k)}this.boxEndIndex=d.length}}class gee{constructor(d=[],u=(x,j)=>x<j?-1:x>j?1:0){if(this.data=d,this.length=this.data.length,this.compare=u,this.length>0)for(let x=(this.length>>1)-1;x>=0;x--)this._down(x)}push(d){this.data.push(d),this._up(this.length++)}pop(){if(this.length===0)return;const d=this.data[0],u=this.data.pop();return--this.length>0&&(this.data[0]=u,this._down(0)),d}peek(){return this.data[0]}_up(d){const{data:u,compare:x}=this,j=u[d];for(;d>0;){const k=d-1>>1,E=u[k];if(x(j,E)>=0)break;u[d]=E,d=k}u[d]=j}_down(d){const{data:u,compare:x}=this,j=this.length>>1,k=u[d];for(;d<j;){let E=1+(d<<1);const R=E+1;if(R<this.length&&x(u[R],u[E])<0&&(E=R),x(u[E],k)>=0)break;u[d]=u[E],d=E}u[d]=k}}function yee(h,d=1,u=!1){const x=kf.fromPoints(h[0]),j=Math.min(x.width(),x.height());let k=j/2;const E=new gee([],vee),{minX:R,minY:$,maxX:V,maxY:W}=x;if(j===0)return new f(R,$);for(let me=R;me<V;me+=j)for(let xe=$;xe<W;xe+=j)E.push(new Wx(me+k,xe+k,k,h));let ee=function(me){let xe=0,Ne=0,Te=0;const Le=me[0];for(let at=0,qe=Le.length,Ze=qe-1;at<qe;Ze=at++){const ht=Le[at],jt=Le[Ze],zt=ht.x*jt.y-jt.x*ht.y;Ne+=(ht.x+jt.x)*zt,Te+=(ht.y+jt.y)*zt,xe+=3*zt}return new Wx(Ne/xe,Te/xe,0,me)}(h),ce=E.length;for(;E.length;){const me=E.pop();(me.d>ee.d||!ee.d)&&(ee=me,u&&console.log("found best %d after %d probes",Math.round(1e4*me.d)/1e4,ce)),me.max-ee.d<=d||(k=me.h/2,E.push(new Wx(me.p.x-k,me.p.y-k,k,h)),E.push(new Wx(me.p.x+k,me.p.y-k,k,h)),E.push(new Wx(me.p.x-k,me.p.y+k,k,h)),E.push(new Wx(me.p.x+k,me.p.y+k,k,h)),ce+=4)}return u&&(console.log(`num probes: ${ce}`),console.log(`best distance: ${ee.d}`)),ee.p}function vee(h,d){return d.max-h.max}function Wx(h,d,u,x){this.p=new f(h,d),this.h=u,this.d=function(j,k){let E=!1,R=1/0;for(let $=0;$<k.length;$++){const V=k[$];for(let W=0,ee=V.length,ce=ee-1;W<ee;ce=W++){const me=V[W],xe=V[ce];me.y>j.y!=xe.y>j.y&&j.x<(xe.x-me.x)*(j.y-me.y)/(xe.y-me.y)+me.x&&(E=!E),R=Math.min(R,TR(j,me,xe))}}return(E?1:-1)*Math.sqrt(R)}(this.p,x),this.max=this.d+this.h*Math.SQRT2}var yi;c.aI=void 0,(yi=c.aI||(c.aI={}))[yi.center=1]="center",yi[yi.left=2]="left",yi[yi.right=3]="right",yi[yi.top=4]="top",yi[yi.bottom=5]="bottom",yi[yi["top-left"]=6]="top-left",yi[yi["top-right"]=7]="top-right",yi[yi["bottom-left"]=8]="bottom-left",yi[yi["bottom-right"]=9]="bottom-right";const $k=Number.POSITIVE_INFINITY;function K3(h,d){return d[1]!==$k?function(u,x,j){let k=0,E=0;switch(x=Math.abs(x),j=Math.abs(j),u){case"top-right":case"top-left":case"top":E=j-7;break;case"bottom-right":case"bottom-left":case"bottom":E=7-j}switch(u){case"top-right":case"bottom-right":case"right":k=-x;break;case"top-left":case"bottom-left":case"left":k=x}return[k,E]}(h,d[0],d[1]):function(u,x){let j=0,k=0;x<0&&(x=0);const E=x/Math.SQRT2;switch(u){case"top-right":case"top-left":k=E-7;break;case"bottom-right":case"bottom-left":k=7-E;break;case"bottom":k=7-x;break;case"top":k=x-7}switch(u){case"top-right":case"bottom-right":j=-E;break;case"top-left":case"bottom-left":j=E;break;case"left":j=x;break;case"right":j=-x}return[j,k]}(h,d[0])}function H3(h,d,u){var x;const j=h.layout,k=(x=j.get("text-variable-anchor-offset"))===null||x===void 0?void 0:x.evaluate(d,{},u);if(k){const R=k.values,$=[];for(let V=0;V<R.length;V+=2){const W=$[V]=R[V],ee=R[V+1].map(ce=>ce*Ra);W.startsWith("top")?ee[1]-=7:W.startsWith("bottom")&&(ee[1]+=7),$[V+1]=ee}return new pi($)}const E=j.get("text-variable-anchor");if(E){let R;R=h._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[j.get("text-radial-offset").evaluate(d,{},u)*Ra,$k]:j.get("text-offset").evaluate(d,{},u).map(V=>V*Ra);const $=[];for(const V of E)$.push(V,K3(V,R));return new pi($)}return null}function zk(h){switch(h){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function jee(h,d,u,x,j,k,E,R,$,V,W,ee){let ce=k.textMaxSize.evaluate(d,{});ce===void 0&&(ce=E);const me=h.layers[0].layout,xe=me.get("icon-offset").evaluate(d,{},W),Ne=Y3(u.horizontal),Te=E/24,Le=h.tilePixelRatio*Te,at=h.tilePixelRatio*ce/24,qe=h.tilePixelRatio*R,Ze=h.tilePixelRatio*me.get("symbol-spacing"),ht=me.get("text-padding")*h.tilePixelRatio,jt=function(Vr,Ir,_r,gs=1){const Bn=Vr.get("icon-padding").evaluate(Ir,{},_r),Sa=Bn&&Bn.values;return[Sa[0]*gs,Sa[1]*gs,Sa[2]*gs,Sa[3]*gs]}(me,d,W,h.tilePixelRatio),zt=me.get("text-max-angle")/180*Math.PI,ar=me.get("text-rotation-alignment")!=="viewport"&&me.get("symbol-placement")!=="point",Gt=me.get("icon-rotation-alignment")==="map"&&me.get("symbol-placement")!=="point",rr=me.get("symbol-placement"),kr=Ze/2,Jt=me.get("icon-text-fit");let sr;x&&Jt!=="none"&&(h.allowVerticalPlacement&&u.vertical&&(sr=j3(x,u.vertical,Jt,me.get("icon-text-fit-padding"),xe,Te)),Ne&&(x=j3(x,Ne,Jt,me.get("icon-text-fit-padding"),xe,Te)));const Ot=W?ee.line.getGranularityForZoomLevel(W.z):1,zr=(Vr,Ir)=>{Ir.x<0||Ir.x>=de||Ir.y<0||Ir.y>=de||function(_r,gs,Bn,Sa,vi,sl,xo,Ja,Dn,La,ei,ti,to,nl,Fa,go,Ca,$a,za,ya,vn,yc,Gx,vc,wee){const Kx=_r.addToLineVertexArray(gs,Bn);let Af,Hx,Zx,Yx,eL=0,tL=0,rL=0,sL=0,Hk=-1,Zk=-1;const mu={};let nL=pc("");if(_r.allowVerticalPlacement&&Sa.vertical){const Fi=Ja.layout.get("text-rotate").evaluate(vn,{},vc)+90;Zx=new k1(Dn,gs,La,ei,ti,Sa.vertical,to,nl,Fa,Fi),xo&&(Yx=new k1(Dn,gs,La,ei,ti,xo,Ca,$a,Fa,Fi))}if(vi){const Fi=Ja.layout.get("icon-rotate").evaluate(vn,{}),al=Ja.layout.get("icon-text-fit")!=="none",Tf=W3(vi,Fi,Gx,al),bc=xo?W3(xo,Fi,Gx,al):void 0;Hx=new k1(Dn,gs,La,ei,ti,vi,Ca,$a,!1,Fi),eL=4*Tf.length;const Ef=_r.iconSizeData;let cd=null;Ef.kind==="source"?(cd=[hu*Ja.layout.get("icon-size").evaluate(vn,{})],cd[0]>Sh&&vr(`${_r.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Ef.kind==="composite"&&(cd=[hu*yc.compositeIconSizes[0].evaluate(vn,{},vc),hu*yc.compositeIconSizes[1].evaluate(vn,{},vc)],(cd[0]>Sh||cd[1]>Sh)&&vr(`${_r.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),_r.addSymbols(_r.icon,Tf,cd,ya,za,vn,c.as.none,gs,Kx.lineStartIndex,Kx.lineLength,-1,vc),Hk=_r.icon.placedSymbolArray.length-1,bc&&(tL=4*bc.length,_r.addSymbols(_r.icon,bc,cd,ya,za,vn,c.as.vertical,gs,Kx.lineStartIndex,Kx.lineLength,-1,vc),Zk=_r.icon.placedSymbolArray.length-1)}const aL=Object.keys(Sa.horizontal);for(const Fi of aL){const al=Sa.horizontal[Fi];if(!Af){nL=pc(al.text);const bc=Ja.layout.get("text-rotate").evaluate(vn,{},vc);Af=new k1(Dn,gs,La,ei,ti,al,to,nl,Fa,bc)}const Tf=al.positionedLines.length===1;if(rL+=Z3(_r,gs,al,sl,Ja,Fa,vn,go,Kx,Sa.vertical?c.as.horizontal:c.as.horizontalOnly,Tf?aL:[Fi],mu,Hk,yc,vc),Tf)break}Sa.vertical&&(sL+=Z3(_r,gs,Sa.vertical,sl,Ja,Fa,vn,go,Kx,c.as.vertical,["vertical"],mu,Zk,yc,vc));const Nee=Af?Af.boxStartIndex:_r.collisionBoxArray.length,See=Af?Af.boxEndIndex:_r.collisionBoxArray.length,Cee=Zx?Zx.boxStartIndex:_r.collisionBoxArray.length,Pee=Zx?Zx.boxEndIndex:_r.collisionBoxArray.length,kee=Hx?Hx.boxStartIndex:_r.collisionBoxArray.length,Aee=Hx?Hx.boxEndIndex:_r.collisionBoxArray.length,Tee=Yx?Yx.boxStartIndex:_r.collisionBoxArray.length,Eee=Yx?Yx.boxEndIndex:_r.collisionBoxArray.length;let jc=-1;const T1=(Fi,al)=>Fi&&Fi.circleDiameter?Math.max(Fi.circleDiameter,al):al;jc=T1(Af,jc),jc=T1(Zx,jc),jc=T1(Hx,jc),jc=T1(Yx,jc);const iL=jc>-1?1:0;iL&&(jc*=wee/Ra),_r.glyphOffsetArray.length>=Vx.MAX_GLYPHS&&vr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),vn.sortKey!==void 0&&_r.addToSortKeyRanges(_r.symbolInstances.length,vn.sortKey);const Mee=H3(Ja,vn,vc),[Oee,Iee]=function(Fi,al){const Tf=Fi.length,bc=al==null?void 0:al.values;if((bc==null?void 0:bc.length)>0)for(let Ef=0;Ef<bc.length;Ef+=2){const cd=bc[Ef+1];Fi.emplaceBack(c.aI[bc[Ef]],cd[0],cd[1])}return[Tf,Fi.length]}(_r.textAnchorOffsets,Mee);_r.symbolInstances.emplaceBack(gs.x,gs.y,mu.right>=0?mu.right:-1,mu.center>=0?mu.center:-1,mu.left>=0?mu.left:-1,mu.vertical||-1,Hk,Zk,nL,Nee,See,Cee,Pee,kee,Aee,Tee,Eee,La,rL,sL,eL,tL,iL,0,to,jc,Oee,Iee)}(h,Ir,Vr,u,x,j,sr,h.layers[0],h.collisionBoxArray,d.index,d.sourceLayerIndex,h.index,Le,[ht,ht,ht,ht],ar,$,qe,jt,Gt,xe,d,k,V,W,E)};if(rr==="line")for(const Vr of $3(d.geometry,0,0,de,de)){const Ir=Pf(Vr,Ot),_r=xee(Ir,Ze,zt,u.vertical||Ne,x,24,at,h.overscaling,de);for(const gs of _r)Ne&&bee(h,Ne.text,kr,gs)||zr(Ir,gs)}else if(rr==="line-center"){for(const Vr of d.geometry)if(Vr.length>1){const Ir=Pf(Vr,Ot),_r=pee(Ir,zt,u.vertical||Ne,x,24,at);_r&&zr(Ir,_r)}}else if(d.type==="Polygon")for(const Vr of ax(d.geometry,0)){const Ir=yee(Vr,16);zr(Pf(Vr[0],Ot,!0),new Ph(Ir.x,Ir.y,0))}else if(d.type==="LineString")for(const Vr of d.geometry){const Ir=Pf(Vr,Ot);zr(Ir,new Ph(Ir[0].x,Ir[0].y,0))}else if(d.type==="Point")for(const Vr of d.geometry)for(const Ir of Vr)zr([Ir],new Ph(Ir.x,Ir.y,0))}function Z3(h,d,u,x,j,k,E,R,$,V,W,ee,ce,me,xe){const Ne=function(at,qe,Ze,ht,jt,zt,ar,Gt){const rr=ht.layout.get("text-rotate").evaluate(zt,{})*Math.PI/180,kr=[];for(const Jt of qe.positionedLines)for(const sr of Jt.positionedGlyphs){if(!sr.rect)continue;const Ot=sr.rect||{};let zr=4,Vr=!0,Ir=1,_r=0;const gs=(jt||Gt)&&sr.vertical,Bn=sr.metrics.advance*sr.scale/2;if(Gt&&qe.verticalizable&&(_r=Jt.lineOffset/2-(sr.imageName?-(Ra-sr.metrics.width*sr.scale)/2:(sr.scale-1)*Ra)),sr.imageName){const $a=ar[sr.imageName];Vr=$a.sdf,Ir=$a.pixelRatio,zr=1/Ir}const Sa=jt?[sr.x+Bn,sr.y]:[0,0];let vi=jt?[0,0]:[sr.x+Bn+Ze[0],sr.y+Ze[1]-_r],sl=[0,0];gs&&(sl=vi,vi=[0,0]);const xo=sr.metrics.isDoubleResolution?2:1,Ja=(sr.metrics.left-zr)*sr.scale-Bn+vi[0],Dn=(-sr.metrics.top-zr)*sr.scale+vi[1],La=Ja+Ot.w/xo*sr.scale/Ir,ei=Dn+Ot.h/xo*sr.scale/Ir,ti=new f(Ja,Dn),to=new f(La,Dn),nl=new f(Ja,ei),Fa=new f(La,ei);if(gs){const $a=new f(-Bn,Bn- -17),za=-Math.PI/2,ya=12-Bn,vn=new f(22-ya,-(sr.imageName?ya:0)),yc=new f(...sl);ti._rotateAround(za,$a)._add(vn)._add(yc),to._rotateAround(za,$a)._add(vn)._add(yc),nl._rotateAround(za,$a)._add(vn)._add(yc),Fa._rotateAround(za,$a)._add(vn)._add(yc)}if(rr){const $a=Math.sin(rr),za=Math.cos(rr),ya=[za,-$a,$a,za];ti._matMult(ya),to._matMult(ya),nl._matMult(ya),Fa._matMult(ya)}const go=new f(0,0),Ca=new f(0,0);kr.push({tl:ti,tr:to,bl:nl,br:Fa,tex:Ot,writingMode:qe.writingMode,glyphOffset:Sa,sectionIndex:sr.sectionIndex,isSDF:Vr,pixelOffsetTL:go,pixelOffsetBR:Ca,minFontScaleX:0,minFontScaleY:0})}return kr}(0,u,R,j,k,E,x,h.allowVerticalPlacement),Te=h.textSizeData;let Le=null;Te.kind==="source"?(Le=[hu*j.layout.get("text-size").evaluate(E,{})],Le[0]>Sh&&vr(`${h.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Te.kind==="composite"&&(Le=[hu*me.compositeTextSizes[0].evaluate(E,{},xe),hu*me.compositeTextSizes[1].evaluate(E,{},xe)],(Le[0]>Sh||Le[1]>Sh)&&vr(`${h.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),h.addSymbols(h.text,Ne,Le,R,k,E,V,d,$.lineStartIndex,$.lineLength,ce,xe);for(const at of W)ee[at]=h.text.placedSymbolArray.length-1;return 4*Ne.length}function Y3(h){for(const d in h)return h[d];return null}function bee(h,d,u,x){const j=h.compareText;if(d in j){const k=j[d];for(let E=k.length-1;E>=0;E--)if(x.dist(k[E])<u)return!0}else j[d]=[];return j[d].push(x),!1}const X3=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Bk{static from(d){if(!(d instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[u,x]=new Uint8Array(d,0,2);if(u!==219)throw new Error("Data does not appear to be in a KDBush format.");const j=x>>4;if(j!==1)throw new Error(`Got v${j} data when expected v1.`);const k=X3[15&x];if(!k)throw new Error("Unrecognized array type.");const[E]=new Uint16Array(d,2,1),[R]=new Uint32Array(d,4,1);return new Bk(R,E,k,d)}constructor(d,u=64,x=Float64Array,j){if(isNaN(d)||d<0)throw new Error(`Unpexpected numItems value: ${d}.`);this.numItems=+d,this.nodeSize=Math.min(Math.max(+u,2),65535),this.ArrayType=x,this.IndexArrayType=d<65536?Uint16Array:Uint32Array;const k=X3.indexOf(this.ArrayType),E=2*d*this.ArrayType.BYTES_PER_ELEMENT,R=d*this.IndexArrayType.BYTES_PER_ELEMENT,$=(8-R%8)%8;if(k<0)throw new Error(`Unexpected typed array class: ${x}.`);j&&j instanceof ArrayBuffer?(this.data=j,this.ids=new this.IndexArrayType(this.data,8,d),this.coords=new this.ArrayType(this.data,8+R+$,2*d),this._pos=2*d,this._finished=!0):(this.data=new ArrayBuffer(8+E+R+$),this.ids=new this.IndexArrayType(this.data,8,d),this.coords=new this.ArrayType(this.data,8+R+$,2*d),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+k]),new Uint16Array(this.data,2,1)[0]=u,new Uint32Array(this.data,4,1)[0]=d)}add(d,u){const x=this._pos>>1;return this.ids[x]=x,this.coords[this._pos++]=d,this.coords[this._pos++]=u,x}finish(){const d=this._pos>>1;if(d!==this.numItems)throw new Error(`Added ${d} items when expected ${this.numItems}.`);return qk(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(d,u,x,j){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:k,coords:E,nodeSize:R}=this,$=[0,k.length-1,0],V=[];for(;$.length;){const W=$.pop()||0,ee=$.pop()||0,ce=$.pop()||0;if(ee-ce<=R){for(let Te=ce;Te<=ee;Te++){const Le=E[2*Te],at=E[2*Te+1];Le>=d&&Le<=x&&at>=u&&at<=j&&V.push(k[Te])}continue}const me=ce+ee>>1,xe=E[2*me],Ne=E[2*me+1];xe>=d&&xe<=x&&Ne>=u&&Ne<=j&&V.push(k[me]),(W===0?d<=xe:u<=Ne)&&($.push(ce),$.push(me-1),$.push(1-W)),(W===0?x>=xe:j>=Ne)&&($.push(me+1),$.push(ee),$.push(1-W))}return V}within(d,u,x){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:j,coords:k,nodeSize:E}=this,R=[0,j.length-1,0],$=[],V=x*x;for(;R.length;){const W=R.pop()||0,ee=R.pop()||0,ce=R.pop()||0;if(ee-ce<=E){for(let Te=ce;Te<=ee;Te++)J3(k[2*Te],k[2*Te+1],d,u)<=V&&$.push(j[Te]);continue}const me=ce+ee>>1,xe=k[2*me],Ne=k[2*me+1];J3(xe,Ne,d,u)<=V&&$.push(j[me]),(W===0?d-x<=xe:u-x<=Ne)&&(R.push(ce),R.push(me-1),R.push(1-W)),(W===0?d+x>=xe:u+x>=Ne)&&(R.push(me+1),R.push(ee),R.push(1-W))}return $}}function qk(h,d,u,x,j,k){if(j-x<=u)return;const E=x+j>>1;Q3(h,d,E,x,j,k),qk(h,d,u,x,E-1,1-k),qk(h,d,u,E+1,j,1-k)}function Q3(h,d,u,x,j,k){for(;j>x;){if(j-x>600){const V=j-x+1,W=u-x+1,ee=Math.log(V),ce=.5*Math.exp(2*ee/3),me=.5*Math.sqrt(ee*ce*(V-ce)/V)*(W-V/2<0?-1:1);Q3(h,d,u,Math.max(x,Math.floor(u-W*ce/V+me)),Math.min(j,Math.floor(u+(V-W)*ce/V+me)),k)}const E=d[2*u+k];let R=x,$=j;for(Hj(h,d,x,u),d[2*j+k]>E&&Hj(h,d,x,j);R<$;){for(Hj(h,d,R,$),R++,$--;d[2*R+k]<E;)R++;for(;d[2*$+k]>E;)$--}d[2*x+k]===E?Hj(h,d,x,$):($++,Hj(h,d,$,j)),$<=u&&(x=$+1),u<=$&&(j=$-1)}}function Hj(h,d,u,x){Vk(h,u,x),Vk(d,2*u,2*x),Vk(d,2*u+1,2*x+1)}function Vk(h,d,u){const x=h[d];h[d]=h[u],h[u]=x}function J3(h,d,u,x){const j=h-u,k=d-x;return j*j+k*k}var Uk;c.cA=void 0,(Uk=c.cA||(c.cA={})).create="create",Uk.load="load",Uk.fullLoad="fullLoad";let A1=null,Zj=[];const Wk=1e3/60,Gk="loadTime",Kk="fullLoadTime",_ee={mark(h){performance.mark(h)},frame(h){const d=h;A1!=null&&Zj.push(d-A1),A1=d},clearMetrics(){A1=null,Zj=[],performance.clearMeasures(Gk),performance.clearMeasures(Kk);for(const h in c.cA)performance.clearMarks(c.cA[h])},getPerformanceMetrics(){performance.measure(Gk,c.cA.create,c.cA.load),performance.measure(Kk,c.cA.create,c.cA.fullLoad);const h=performance.getEntriesByName(Gk)[0].duration,d=performance.getEntriesByName(Kk)[0].duration,u=Zj.length,x=1/(Zj.reduce((k,E)=>k+E,0)/u/1e3),j=Zj.filter(k=>k>Wk).reduce((k,E)=>k+(E-Wk)/Wk,0);return{loadTime:h,fullLoadTime:d,fps:x,percentDroppedFrames:j/(u+j)*100,totalFrames:u}}};c.$=Je,c.A=D,c.B=vh,c.C=function([h,d,u]){return d+=90,d*=Math.PI/180,u*=Math.PI/180,{x:h*Math.cos(d)*Math.sin(u),y:h*Math.sin(d)*Math.sin(u),z:h*Math.cos(u)}},c.D=Nr,c.E=br,c.F=Eo,c.G=an,c.H=vf,c.I=Ak,c.J=xn,c.K=class{constructor(h,d){this.target=h,this.mapId=d,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new hee(()=>this.process()),this.subscription=It(this.target,"message",u=>this.receive(u),!1),this.globalScope=Dr(self)?h:window}registerMessageHandler(h,d){this.messageHandlers[h]=d}sendAsync(h,d){return new Promise((u,x)=>{const j=Math.round(1e18*Math.random()).toString(36).substring(0,10),k=d?It(d.signal,"abort",()=>{k==null||k.unsubscribe(),delete this.resolveRejects[j];const $={id:j,type:"<cancel>",origin:location.origin,targetMapId:h.targetMapId,sourceMapId:this.mapId};this.target.postMessage($)},mee):null;this.resolveRejects[j]={resolve:$=>{k==null||k.unsubscribe(),u($)},reject:$=>{k==null||k.unsubscribe(),x($)}};const E=[],R=Object.assign(Object.assign({},h),{id:j,sourceMapId:this.mapId,origin:location.origin,data:hc(h.data,E)});this.target.postMessage(R,{transfer:E})})}receive(h){const d=h.data,u=d.id;if(!(d.origin!=="file://"&&location.origin!=="file://"&&d.origin!=="resource://android"&&location.origin!=="resource://android"&&d.origin!==location.origin||d.targetMapId&&this.mapId!==d.targetMapId)){if(d.type==="<cancel>"){delete this.tasks[u];const x=this.abortControllers[u];return delete this.abortControllers[u],void(x&&x.abort())}if(Dr(self)||d.mustQueue)return this.tasks[u]=d,this.taskQueue.push(u),void this.invoker.trigger();this.processTask(u,d)}}process(){if(this.taskQueue.length===0)return;const h=this.taskQueue.shift(),d=this.tasks[h];delete this.tasks[h],this.taskQueue.length>0&&this.invoker.trigger(),d&&this.processTask(h,d)}processTask(h,d){return i(this,void 0,void 0,function*(){if(d.type==="<response>"){const j=this.resolveRejects[h];return delete this.resolveRejects[h],j?void(d.error?j.reject(jf(d.error)):j.resolve(jf(d.data))):void 0}if(!this.messageHandlers[d.type])return void this.completeTask(h,new Error(`Could not find a registered handler for ${d.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const u=jf(d.data),x=new AbortController;this.abortControllers[h]=x;try{const j=yield this.messageHandlers[d.type](d.sourceMapId,u,x);this.completeTask(h,null,j)}catch(j){this.completeTask(h,j)}})}completeTask(h,d,u){const x=[];delete this.abortControllers[h];const j={id:h,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:d?hc(d):null,data:hc(u,x)};this.target.postMessage(j,{transfer:x})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},c.L=ke,c.M=function(){var h=new D(16);return D!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=0,h[12]=0,h[13]=0,h[14]=0),h[0]=1,h[5]=1,h[10]=1,h[15]=1,h},c.N=function(h,d,u){var x,j,k,E,R,$,V,W,ee,ce,me,xe,Ne=u[0],Te=u[1],Le=u[2];return d===h?(h[12]=d[0]*Ne+d[4]*Te+d[8]*Le+d[12],h[13]=d[1]*Ne+d[5]*Te+d[9]*Le+d[13],h[14]=d[2]*Ne+d[6]*Te+d[10]*Le+d[14],h[15]=d[3]*Ne+d[7]*Te+d[11]*Le+d[15]):(j=d[1],k=d[2],E=d[3],R=d[4],$=d[5],V=d[6],W=d[7],ee=d[8],ce=d[9],me=d[10],xe=d[11],h[0]=x=d[0],h[1]=j,h[2]=k,h[3]=E,h[4]=R,h[5]=$,h[6]=V,h[7]=W,h[8]=ee,h[9]=ce,h[10]=me,h[11]=xe,h[12]=x*Ne+R*Te+ee*Le+d[12],h[13]=j*Ne+$*Te+ce*Le+d[13],h[14]=k*Ne+V*Te+me*Le+d[14],h[15]=E*Ne+W*Te+xe*Le+d[15]),h},c.O=function(h,d,u){var x=u[0],j=u[1],k=u[2];return h[0]=d[0]*x,h[1]=d[1]*x,h[2]=d[2]*x,h[3]=d[3]*x,h[4]=d[4]*j,h[5]=d[5]*j,h[6]=d[6]*j,h[7]=d[7]*j,h[8]=d[8]*k,h[9]=d[9]*k,h[10]=d[10]*k,h[11]=d[11]*k,h[12]=d[12],h[13]=d[13],h[14]=d[14],h[15]=d[15],h},c.P=f,c.Q=function(h,d,u){var x=d[0],j=d[1],k=d[2],E=d[3],R=d[4],$=d[5],V=d[6],W=d[7],ee=d[8],ce=d[9],me=d[10],xe=d[11],Ne=d[12],Te=d[13],Le=d[14],at=d[15],qe=u[0],Ze=u[1],ht=u[2],jt=u[3];return h[0]=qe*x+Ze*R+ht*ee+jt*Ne,h[1]=qe*j+Ze*$+ht*ce+jt*Te,h[2]=qe*k+Ze*V+ht*me+jt*Le,h[3]=qe*E+Ze*W+ht*xe+jt*at,h[4]=(qe=u[4])*x+(Ze=u[5])*R+(ht=u[6])*ee+(jt=u[7])*Ne,h[5]=qe*j+Ze*$+ht*ce+jt*Te,h[6]=qe*k+Ze*V+ht*me+jt*Le,h[7]=qe*E+Ze*W+ht*xe+jt*at,h[8]=(qe=u[8])*x+(Ze=u[9])*R+(ht=u[10])*ee+(jt=u[11])*Ne,h[9]=qe*j+Ze*$+ht*ce+jt*Te,h[10]=qe*k+Ze*V+ht*me+jt*Le,h[11]=qe*E+Ze*W+ht*xe+jt*at,h[12]=(qe=u[12])*x+(Ze=u[13])*R+(ht=u[14])*ee+(jt=u[15])*Ne,h[13]=qe*j+Ze*$+ht*ce+jt*Te,h[14]=qe*k+Ze*V+ht*me+jt*Le,h[15]=qe*E+Ze*W+ht*xe+jt*at,h},c.R=po,c.S=function(h,d){const u={};for(let x=0;x<d.length;x++){const j=d[x];j in h&&(u[j]=h[j])}return u},c.T=vk,c.U=Ch,c.V=Ct,c.W=A3,c.X=k3,c.Y=M,c.Z=O,c._=i,c.a=ye,c.a$=function(h,d,u){return h[0]=d[0]*u[0],h[1]=d[1]*u[1],h[2]=d[2]*u[2],h[3]=d[3]*u[3],h},c.a0=rl,c.a1=E3,c.a2=N1,c.a3=de,c.a4=function(h,d){var u,x,j,k,E;if(!h)return d??{};if(!d)return h;let R=Object.assign({},h);if(d.removeAll&&(R={removeAll:!0}),d.remove){const $=new Set(d.remove);R.add&&(R.add=R.add.filter(W=>!$.has(W.id))),R.update&&(R.update=R.update.filter(W=>!$.has(W.id)));const V=new Set(((u=h.add)!==null&&u!==void 0?u:[]).map(W=>W.id));d.remove=d.remove.filter(W=>!V.has(W))}if(d.remove){const $=new Set(R.remove?R.remove.concat(d.remove):d.remove);R.remove=Array.from($.values())}if(d.add){const $=R.add?R.add.concat(d.add):d.add,V=new Map($.map(W=>[W.id,W]));R.add=Array.from(V.values())}if(d.update){const $=new Map((x=R.update)===null||x===void 0?void 0:x.map(V=>[V.id,V]));for(const V of d.update){const W=(j=$.get(V.id))!==null&&j!==void 0?j:{id:V.id};V.newGeometry&&(W.newGeometry=V.newGeometry),V.addOrUpdateProperties&&(W.addOrUpdateProperties=((k=W.addOrUpdateProperties)!==null&&k!==void 0?k:[]).concat(V.addOrUpdateProperties)),V.removeProperties&&(W.removeProperties=((E=W.removeProperties)!==null&&E!==void 0?E:[]).concat(V.removeProperties)),V.removeAllProperties&&(W.removeAllProperties=!0),$.set(V.id,W)}R.update=Array.from($.values())}return R.remove&&R.add&&(R.remove=R.remove.filter($=>R.add.findIndex(V=>V.id===$)===-1)),R},c.a5=Gj,c.a6=kf,c.a7=25,c.a8=Fk,c.a9=h=>{const d=window.document.createElement("video");return d.muted=!0,new Promise(u=>{d.onloadstart=()=>{u(d)};for(const x of h){const j=window.document.createElement("source");dt(x)||(d.crossOrigin="Anonymous"),j.src=x,d.appendChild(j)}})},c.aA=Ce,c.aB=function(h,d,u,x){const j=d.y-h.y,k=d.x-h.x,E=x.y-u.y,R=x.x-u.x,$=E*k-R*j;if($===0)return null;const V=(R*(h.y-u.y)-E*(h.x-u.x))/$;return new f(h.x+V*k,h.y+V*j)},c.aC=$3,c.aD=kR,c.aE=function(h){let d=1/0,u=1/0,x=-1/0,j=-1/0;for(const k of h)d=Math.min(d,k.x),u=Math.min(u,k.y),x=Math.max(x,k.x),j=Math.max(j,k.y);return[d,u,x,j]},c.aF=Ra,c.aG=Ke,c.aH=function(h,d,u,x,j=!1){if(!u[0]&&!u[1])return[0,0];const k=j?x==="map"?-h.bearingInRadians:0:x==="viewport"?h.bearingInRadians:0;if(k){const E=Math.sin(k),R=Math.cos(k);u=[u[0]*R-u[1]*E,u[0]*E+u[1]*R]}return[j?u[0]:Ke(d,u[0],h.zoom),j?u[1]:Ke(d,u[1],h.zoom)]},c.aJ=Mk,c.aK=zk,c.aL=Ek,c.aM=Bk,c.aN=Qn,c.aO=y1,c.aP=ze,c.aQ=es,c.aR=Dt,c.aS=er,c.aT=M3,c.aU=re,c.aV=Q,c.aW=function(h){var d=new D(3);return d[0]=h[0],d[1]=h[1],d[2]=h[2],d},c.aX=function(h,d,u){return h[0]=d[0]-u[0],h[1]=d[1]-u[1],h[2]=d[2]-u[2],h},c.aY=function(h,d){var u=d[0],x=d[1],j=d[2],k=u*u+x*x+j*j;return k>0&&(k=1/Math.sqrt(k)),h[0]=d[0]*k,h[1]=d[1]*k,h[2]=d[2]*k,h},c.aZ=Z,c.a_=function(h,d){return h[0]*d[0]+h[1]*d[1]+h[2]*d[2]},c.aa=Lt,c.ab=function(){return At++},c.ac=z,c.ad=Vx,c.ae=pf,c.af=ld,c.ag=R3,c.ah=function(h){const d={};if(h.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,x,j,k)=>{const E=j||k;return d[x]=!E||E.toLowerCase(),""}),d["max-age"]){const u=parseInt(d["max-age"],10);isNaN(u)?delete d["max-age"]:d["max-age"]=u}return d},c.ai=Vt,c.aj=85.051129,c.ak=Bt,c.al=function(h){return Math.pow(2,h)},c.am=F,c.an=T3,c.ao=function(h){return Math.log(h)/Math.LN2},c.ap=function(h){var d=h[0],u=h[1];return d*d+u*u},c.aq=function(h){if(!h.length)return new Set;const d=Math.max(...h.map($=>$.canonical.z));let u=1/0,x=-1/0,j=1/0,k=-1/0;const E=[];for(const $ of h){const{x:V,y:W,z:ee}=$.canonical,ce=Math.pow(2,d-ee),me=V*ce,xe=W*ce;E.push({id:$,x:me,y:xe}),me<u&&(u=me),me>x&&(x=me),xe<j&&(j=xe),xe>k&&(k=xe)}const R=new Set;for(const $ of E)$.x!==u&&$.x!==x&&$.y!==j&&$.y!==k||R.add($.id);return R},c.ar=function(h,d){let u=0,x=0;if(h.kind==="constant")x=h.layoutSize;else if(h.kind!=="source"){const{interpolationType:j,minZoom:k,maxZoom:E}=h,R=j?Vt(Gs.interpolationFactor(j,d,k,E),0,1):0;h.kind==="camera"?x=Eo.number(h.minSize,h.maxSize,R):u=R}return{uSizeT:u,uSize:x}},c.at=function(h,{uSize:d,uSizeT:u},{lowerSize:x,upperSize:j}){return h.kind==="source"?x/hu:h.kind==="composite"?Eo.number(x/hu,j/hu,u):d},c.au=function(h,d){var u=d[0],x=d[1],j=d[2],k=d[3],E=d[4],R=d[5],$=d[6],V=d[7],W=d[8],ee=d[9],ce=d[10],me=d[11],xe=d[12],Ne=d[13],Te=d[14],Le=d[15],at=u*R-x*E,qe=u*$-j*E,Ze=u*V-k*E,ht=x*$-j*R,jt=x*V-k*R,zt=j*V-k*$,ar=W*Ne-ee*xe,Gt=W*Te-ce*xe,rr=W*Le-me*xe,kr=ee*Te-ce*Ne,Jt=ee*Le-me*Ne,sr=ce*Le-me*Te,Ot=at*sr-qe*Jt+Ze*kr+ht*rr-jt*Gt+zt*ar;return Ot?(h[0]=(R*sr-$*Jt+V*kr)*(Ot=1/Ot),h[1]=(j*Jt-x*sr-k*kr)*Ot,h[2]=(Ne*zt-Te*jt+Le*ht)*Ot,h[3]=(ce*jt-ee*zt-me*ht)*Ot,h[4]=($*rr-E*sr-V*Gt)*Ot,h[5]=(u*sr-j*rr+k*Gt)*Ot,h[6]=(Te*Ze-xe*zt-Le*qe)*Ot,h[7]=(W*zt-ce*Ze+me*qe)*Ot,h[8]=(E*Jt-R*rr+V*ar)*Ot,h[9]=(x*rr-u*Jt-k*ar)*Ot,h[10]=(xe*jt-Ne*Ze+Le*at)*Ot,h[11]=(ee*Ze-W*jt-me*at)*Ot,h[12]=(R*Gt-E*kr-$*ar)*Ot,h[13]=(u*kr-x*Gt+j*ar)*Ot,h[14]=(Ne*qe-xe*ht-Te*at)*Ot,h[15]=(W*ht-ee*qe+ce*at)*Ot,h):null},c.av=ae,c.aw=function(h){var d=h[0],u=h[1];return Math.sqrt(d*d+u*u)},c.ax=function(h){return h[0]=0,h[1]=0,h},c.ay=function(h,d,u){return h[0]=d[0]*u,h[1]=d[1]*u,h},c.az=Ok,c.b=Qs,c.b$=function(h,d,u){var x=d[0],j=d[1],k=d[2];return h[0]=x*u[0]+j*u[3]+k*u[6],h[1]=x*u[1]+j*u[4]+k*u[7],h[2]=x*u[2]+j*u[5]+k*u[8],h},c.b0=U,c.b1=function(h,d,u){const x=d[0]*u[0]+d[1]*u[1]+d[2]*u[2];return x===0?null:(-(h[0]*u[0]+h[1]*u[1]+h[2]*u[2])-u[3])/x},c.b2=oe,c.b3=function(h,d,u){return h[0]=d[0]*u,h[1]=d[1]*u,h[2]=d[2]*u,h[3]=d[3]*u,h},c.b4=function(h,d){return h[0]*d[0]+h[1]*d[1]+h[2]*d[2]+h[3]},c.b5=I3,c.b6=Ux,c.b7=function(h,d,u,x,j){var k=1/Math.tan(d/2);if(h[0]=k/u,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=k,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=-1,h[12]=0,h[13]=0,h[15]=0,j!=null&&j!==1/0){var E=1/(x-j);h[10]=(j+x)*E,h[14]=2*j*x*E}else h[10]=-1,h[14]=-2*x;return h},c.b8=function(h){var d=new D(16);return d[0]=h[0],d[1]=h[1],d[2]=h[2],d[3]=h[3],d[4]=h[4],d[5]=h[5],d[6]=h[6],d[7]=h[7],d[8]=h[8],d[9]=h[9],d[10]=h[10],d[11]=h[11],d[12]=h[12],d[13]=h[13],d[14]=h[14],d[15]=h[15],d},c.b9=function(h,d,u){var x=Math.sin(u),j=Math.cos(u),k=d[0],E=d[1],R=d[2],$=d[3],V=d[4],W=d[5],ee=d[6],ce=d[7];return d!==h&&(h[8]=d[8],h[9]=d[9],h[10]=d[10],h[11]=d[11],h[12]=d[12],h[13]=d[13],h[14]=d[14],h[15]=d[15]),h[0]=k*j+V*x,h[1]=E*j+W*x,h[2]=R*j+ee*x,h[3]=$*j+ce*x,h[4]=V*j-k*x,h[5]=W*j-E*x,h[6]=ee*j-R*x,h[7]=ce*j-$*x,h},c.bA=function(h,d,u,x){var j=[],k=[];return j[0]=d[0]-u[0],j[1]=d[1]-u[1],j[2]=d[2]-u[2],k[0]=j[0],k[1]=j[1]*Math.cos(x)-j[2]*Math.sin(x),k[2]=j[1]*Math.sin(x)+j[2]*Math.cos(x),h[0]=k[0]+u[0],h[1]=k[1]+u[1],h[2]=k[2]+u[2],h},c.bB=function(h,d,u,x){var j=[],k=[];return j[0]=d[0]-u[0],j[1]=d[1]-u[1],j[2]=d[2]-u[2],k[0]=j[2]*Math.sin(x)+j[0]*Math.cos(x),k[1]=j[1],k[2]=j[2]*Math.cos(x)-j[0]*Math.sin(x),h[0]=k[0]+u[0],h[1]=k[1]+u[1],h[2]=k[2]+u[2],h},c.bC=function(h,d,u){var x=Math.sin(u),j=Math.cos(u),k=d[0],E=d[1],R=d[2],$=d[3],V=d[8],W=d[9],ee=d[10],ce=d[11];return d!==h&&(h[4]=d[4],h[5]=d[5],h[6]=d[6],h[7]=d[7],h[12]=d[12],h[13]=d[13],h[14]=d[14],h[15]=d[15]),h[0]=k*j-V*x,h[1]=E*j-W*x,h[2]=R*j-ee*x,h[3]=$*j-ce*x,h[8]=k*x+V*j,h[9]=E*x+W*j,h[10]=R*x+ee*j,h[11]=$*x+ce*j,h},c.bD=function(h,d){const u=He(h,360),x=He(d,360),j=x-u,k=x>u?j-360:j+360;return Math.abs(j)<Math.abs(k)?j:k},c.bE=function(h){return h[0]=0,h[1]=0,h[2]=0,h},c.bF=function(h,d,u,x){const j=Math.sqrt(h*h+d*d),k=Math.sqrt(u*u+x*x);h/=j,d/=j,u/=k,x/=k;const E=Math.acos(h*u+d*x);return-d*u+h*x>0?E:-E},c.bG=function(h,d){const u=He(h,2*Math.PI),x=He(d,2*Math.PI);return Math.min(Math.abs(u-x),Math.abs(u-x+2*Math.PI),Math.abs(u-x-2*Math.PI))},c.bH=function(){const h={},d=ot.$version;for(const u in ot.$root){const x=ot.$root[u];if(x.required){let j=null;j=u==="version"?d:x.type==="array"?[]:{},j!=null&&(h[u]=j)}}return h},c.bI=jj,c.bJ=Ge,c.bK=function h(d,u){if(Array.isArray(d)){if(!Array.isArray(u)||d.length!==u.length)return!1;for(let x=0;x<d.length;x++)if(!h(d[x],u[x]))return!1;return!0}if(typeof d=="object"&&d!==null&&u!==null){if(typeof u!="object"||Object.keys(d).length!==Object.keys(u).length)return!1;for(const x in d)if(!h(d[x],u[x]))return!1;return!0}return d===u},c.bL=function(h){h=h.slice();const d=Object.create(null);for(let u=0;u<h.length;u++)d[h[u].id]=h[u];for(let u=0;u<h.length;u++)"ref"in h[u]&&(h[u]=wr(h[u],d[h[u].ref]));return h},c.bM=function(h,d){if(h.type==="custom")return new uee(h,d);switch(h.type){case"background":return new dee(h,d);case"circle":return new ZQ(h,d);case"color-relief":return new tJ(h,d);case"fill":return new xJ(h,d);case"fill-extrusion":return new PJ(h,d);case"heatmap":return new XQ(h,d);case"hillshade":return new JQ(h,d);case"line":return new IJ(h,d);case"raster":return new dk(h,d);case"symbol":return new w1(h,d)}},c.bN=h=>h.type==="raster",c.bO=vt,c.bP=function(h,d){if(!h)return[{command:"setStyle",args:[d]}];let u=[];try{if(!tr(h.version,d.version))return[{command:"setStyle",args:[d]}];tr(h.center,d.center)||u.push({command:"setCenter",args:[d.center]}),tr(h.state,d.state)||u.push({command:"setGlobalState",args:[d.state]}),tr(h.centerAltitude,d.centerAltitude)||u.push({command:"setCenterAltitude",args:[d.centerAltitude]}),tr(h.zoom,d.zoom)||u.push({command:"setZoom",args:[d.zoom]}),tr(h.bearing,d.bearing)||u.push({command:"setBearing",args:[d.bearing]}),tr(h.pitch,d.pitch)||u.push({command:"setPitch",args:[d.pitch]}),tr(h.roll,d.roll)||u.push({command:"setRoll",args:[d.roll]}),tr(h.sprite,d.sprite)||u.push({command:"setSprite",args:[d.sprite]}),tr(h.glyphs,d.glyphs)||u.push({command:"setGlyphs",args:[d.glyphs]}),tr(h.transition,d.transition)||u.push({command:"setTransition",args:[d.transition]}),tr(h.light,d.light)||u.push({command:"setLight",args:[d.light]}),tr(h.terrain,d.terrain)||u.push({command:"setTerrain",args:[d.terrain]}),tr(h.sky,d.sky)||u.push({command:"setSky",args:[d.sky]}),tr(h.projection,d.projection)||u.push({command:"setProjection",args:[d.projection]});const x={},j=[];(function(E,R,$,V){let W;for(W in R=R||{},E=E||{})Object.prototype.hasOwnProperty.call(E,W)&&(Object.prototype.hasOwnProperty.call(R,W)||Os(W,$,V));for(W in R)Object.prototype.hasOwnProperty.call(R,W)&&(Object.prototype.hasOwnProperty.call(E,W)?tr(E[W],R[W])||(E[W].type==="geojson"&&R[W].type==="geojson"&&Bs(E,R,W)?Cr($,{command:"setGeoJSONSourceData",args:[W,R[W].data]}):dn(W,R,$,V)):fs(W,R,$))})(h.sources,d.sources,j,x);const k=[];h.layers&&h.layers.forEach(E=>{"source"in E&&x[E.source]?u.push({command:"removeLayer",args:[E.id]}):k.push(E)}),u=u.concat(j),function(E,R,$){R=R||[];const V=(E=E||[]).map(Is),W=R.map(Is),ee=E.reduce(Na,{}),ce=R.reduce(Na,{}),me=V.slice(),xe=Object.create(null);let Ne,Te,Le,at,qe;for(let Ze=0,ht=0;Ze<V.length;Ze++)Ne=V[Ze],Object.prototype.hasOwnProperty.call(ce,Ne)?ht++:(Cr($,{command:"removeLayer",args:[Ne]}),me.splice(me.indexOf(Ne,ht),1));for(let Ze=0,ht=0;Ze<W.length;Ze++)Ne=W[W.length-1-Ze],me[me.length-1-Ze]!==Ne&&(Object.prototype.hasOwnProperty.call(ee,Ne)?(Cr($,{command:"removeLayer",args:[Ne]}),me.splice(me.lastIndexOf(Ne,me.length-ht),1)):ht++,at=me[me.length-Ze],Cr($,{command:"addLayer",args:[ce[Ne],at]}),me.splice(me.length-Ze,0,Ne),xe[Ne]=!0);for(let Ze=0;Ze<W.length;Ze++)if(Ne=W[Ze],Te=ee[Ne],Le=ce[Ne],!xe[Ne]&&!tr(Te,Le))if(tr(Te.source,Le.source)&&tr(Te["source-layer"],Le["source-layer"])&&tr(Te.type,Le.type)){for(qe in qs(Te.layout,Le.layout,$,Ne,null,"setLayoutProperty"),qs(Te.paint,Le.paint,$,Ne,null,"setPaintProperty"),tr(Te.filter,Le.filter)||Cr($,{command:"setFilter",args:[Ne,Le.filter]}),tr(Te.minzoom,Le.minzoom)&&tr(Te.maxzoom,Le.maxzoom)||Cr($,{command:"setLayerZoomRange",args:[Ne,Le.minzoom,Le.maxzoom]}),Te)Object.prototype.hasOwnProperty.call(Te,qe)&&qe!=="layout"&&qe!=="paint"&&qe!=="filter"&&qe!=="metadata"&&qe!=="minzoom"&&qe!=="maxzoom"&&(qe.indexOf("paint.")===0?qs(Te[qe],Le[qe],$,Ne,qe.slice(6),"setPaintProperty"):tr(Te[qe],Le[qe])||Cr($,{command:"setLayerProperty",args:[Ne,qe,Le[qe]]}));for(qe in Le)Object.prototype.hasOwnProperty.call(Le,qe)&&!Object.prototype.hasOwnProperty.call(Te,qe)&&qe!=="layout"&&qe!=="paint"&&qe!=="filter"&&qe!=="metadata"&&qe!=="minzoom"&&qe!=="maxzoom"&&(qe.indexOf("paint.")===0?qs(Te[qe],Le[qe],$,Ne,qe.slice(6),"setPaintProperty"):tr(Te[qe],Le[qe])||Cr($,{command:"setLayerProperty",args:[Ne,qe,Le[qe]]}))}else Cr($,{command:"removeLayer",args:[Ne]}),at=me[me.lastIndexOf(Ne)+1],Cr($,{command:"addLayer",args:[Le,at]})}(k,d.layers,u)}catch(x){console.warn("Unable to compute style diff:",x),u=[{command:"setStyle",args:[d]}]}return u},c.bQ=function(h){const d=[],u=h.id;return u===void 0&&d.push({message:`layers.${u}: missing required property "id"`}),h.render===void 0&&d.push({message:`layers.${u}: missing required method "render"`}),h.renderingMode&&h.renderingMode!=="2d"&&h.renderingMode!=="3d"&&d.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),d},c.bR=Ht,c.bS=fr,c.bT=class extends eo{constructor(h,d){super(h,d),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}},c.bU=id,c.bV=class extends eo{constructor(h,d){super(h,d),this.current=Sf}set(h){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let d=1;d<16;d++)if(h[d]!==this.current[d]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}},c.bW=xc,c.bX=class extends eo{constructor(h,d){super(h,d),this.current=[0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2]))}},c.bY=class extends eo{constructor(h,d){super(h,d),this.current=[0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1]))}},c.bZ=L,c.b_=function(h,d){var u=Math.sin(d),x=Math.cos(d);return h[0]=x,h[1]=u,h[2]=0,h[3]=-u,h[4]=x,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},c.ba=function(h,d,u){var x=Math.sin(u),j=Math.cos(u),k=d[4],E=d[5],R=d[6],$=d[7],V=d[8],W=d[9],ee=d[10],ce=d[11];return d!==h&&(h[0]=d[0],h[1]=d[1],h[2]=d[2],h[3]=d[3],h[12]=d[12],h[13]=d[13],h[14]=d[14],h[15]=d[15]),h[4]=k*j+V*x,h[5]=E*j+W*x,h[6]=R*j+ee*x,h[7]=$*j+ce*x,h[8]=V*j-k*x,h[9]=W*j-E*x,h[10]=ee*j-R*x,h[11]=ce*j-$*x,h},c.bb=function(){const h=new Float32Array(16);return F(h),h},c.bc=function(){const h=new Float64Array(16);return F(h),h},c.bd=function(){return new Float64Array(16)},c.be=function(h,d,u){const x=new Float64Array(4);return Se(x,h,d-90,u),x},c.bf=function(h,d,u,x){var j,k,E,R,$,V=d[0],W=d[1],ee=d[2],ce=d[3],me=u[0],xe=u[1],Ne=u[2],Te=u[3];return(k=V*me+W*xe+ee*Ne+ce*Te)<0&&(k=-k,me=-me,xe=-xe,Ne=-Ne,Te=-Te),1-k>C?(j=Math.acos(k),E=Math.sin(j),R=Math.sin((1-x)*j)/E,$=Math.sin(x*j)/E):(R=1-x,$=x),h[0]=R*V+$*me,h[1]=R*W+$*xe,h[2]=R*ee+$*Ne,h[3]=R*ce+$*Te,h},c.bg=function(h){const d=new Float64Array(9);var u,x,j,k,E,R,$,V,W,ee,ce,me,xe,Ne,Te,Le,at,qe;ee=(j=(x=h)[0])*($=j+j),ce=(k=x[1])*$,xe=(E=x[2])*$,Ne=E*(V=k+k),Le=(R=x[3])*$,at=R*V,qe=R*(W=E+E),(u=d)[0]=1-(me=k*V)-(Te=E*W),u[3]=ce-qe,u[6]=xe+at,u[1]=ce+qe,u[4]=1-ee-Te,u[7]=Ne-Le,u[2]=xe-at,u[5]=Ne+Le,u[8]=1-ee-me;const Ze=er(-Math.asin(Vt(d[2],-1,1)));let ht,jt;return Math.hypot(d[5],d[8])<.001?(ht=0,jt=-er(Math.atan2(d[3],d[4]))):(ht=er(d[5]===0&&d[8]===0?0:Math.atan2(d[5],d[8])),jt=er(d[1]===0&&d[0]===0?0:Math.atan2(d[1],d[0]))),{roll:ht,pitch:Ze+90,bearing:jt}},c.bh=function(h,d){return h.roll==d.roll&&h.pitch==d.pitch&&h.bearing==d.bearing},c.bi=Kr,c.bj=Li,c.bk=$x,c.bl=zj,c.bm=Fx,c.bn=Ve,c.bo=yt,c.bp=fo,c.bq=function(h,d,u,x,j){return Ve(x,j,Vt((h-d)/(u-d),0,1))},c.br=He,c.bs=function(){return new Float64Array(3)},c.bt=function(h,d,u,x){return h[0]=d[0]+u[0]*x,h[1]=d[1]+u[1]*x,h[2]=d[2]+u[2]*x,h},c.bu=Se,c.bv=function(h,d,u){var x=u[0],j=u[1],k=u[2],E=u[3],R=d[0],$=d[1],V=d[2],W=j*V-k*$,ee=k*R-x*V,ce=x*$-j*R;return h[0]=R+E*(W+=W)+j*(ce+=ce)-k*(ee+=ee),h[1]=$+E*ee+k*W-x*ce,h[2]=V+E*ce+x*ee-j*W,h},c.bw=function(h,d,u){const x=(j=[h[0],h[1],h[2],d[0],d[1],d[2],u[0],u[1],u[2]])[0]*((W=j[8])*(E=j[4])-(R=j[5])*(V=j[7]))+j[1]*(-W*(k=j[3])+R*($=j[6]))+j[2]*(V*k-E*$);var j,k,E,R,$,V,W;if(x===0)return null;const ee=Z([],[d[0],d[1],d[2]],[u[0],u[1],u[2]]),ce=Z([],[u[0],u[1],u[2]],[h[0],h[1],h[2]]),me=Z([],[h[0],h[1],h[2]],[d[0],d[1],d[2]]),xe=re([],ee,-h[3]);return Q(xe,xe,re([],ce,-d[3])),Q(xe,xe,re([],me,-u[3])),re(xe,xe,1/x),xe},c.bx=Lk,c.by=function(){return new Float64Array(4)},c.bz=function(h,d,u,x){var j=[],k=[];return j[0]=d[0]-u[0],j[1]=d[1]-u[1],j[2]=d[2]-u[2],k[0]=j[0]*Math.cos(x)-j[1]*Math.sin(x),k[1]=j[0]*Math.sin(x)+j[1]*Math.cos(x),k[2]=j[2],h[0]=k[0]+u[0],h[1]=k[1]+u[1],h[2]=k[2]+u[2],h},c.c=Xe,c.c0=function(h,d,u,x,j,k,E){var R=1/(d-u),$=1/(x-j),V=1/(k-E);return h[0]=-2*R,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=-2*$,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=2*V,h[11]=0,h[12]=(d+u)*R,h[13]=(j+x)*$,h[14]=(E+k)*V,h[15]=1,h},c.c1=class extends eo{constructor(h,d){super(h,d),this.current=new Array}set(h){if(h!=this.current){this.current=h;const d=new Float32Array(4*h.length);for(let u=0;u<h.length;u++)d[4*u]=h[u].r,d[4*u+1]=h[u].g,d[4*u+2]=h[u].b,d[4*u+3]=h[u].a;this.gl.uniform4fv(this.location,d)}}},c.c2=class extends eo{constructor(h,d){super(h,d),this.current=new Array}set(h){if(h!=this.current){this.current=h;const d=new Float32Array(h);this.gl.uniform1fv(this.location,d)}}},c.c3=class extends iu{},c.c4=FJ,c.c5=class extends Ex{},c.c6=yk,c.c7=function(h){return h<=1?1:Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))},c.c8=FR,c.c9=function(h,d,u){var x=d[0],j=d[1],k=d[2],E=u[3]*x+u[7]*j+u[11]*k+u[15];return h[0]=(u[0]*x+u[4]*j+u[8]*k+u[12])/(E=E||1),h[1]=(u[1]*x+u[5]*j+u[9]*k+u[13])/E,h[2]=(u[2]*x+u[6]*j+u[10]*k+u[14])/E,h},c.cB=function(h){return h.message===Tn},c.cC=Fe,c.cD=function(h,d){ye.REGISTERED_PROTOCOLS[h]=d},c.cE=function(h){delete ye.REGISTERED_PROTOCOLS[h]},c.cF=function(h,d){const u={};for(let j=0;j<h.length;j++){const k=d&&d[h[j].id]||Fw(h[j]);d&&(d[h[j].id]=k);let E=u[k];E||(E=u[k]=[]),E.push(h[j])}const x=[];for(const j in u)x.push(u[j]);return x},c.cG=pr,c.cH=D3,c.cI=L3,c.cJ=m3,c.cK=function(h){h.bucket.createArrays(),h.bucket.tilePixelRatio=de/(512*h.bucket.overscaling),h.bucket.compareText={},h.bucket.iconsNeedLinear=!1;const d=h.bucket.layers[0],u=d.layout,x=d._unevaluatedLayout._values,j={layoutIconSize:x["icon-size"].possiblyEvaluate(new an(h.bucket.zoom+1),h.canonical),layoutTextSize:x["text-size"].possiblyEvaluate(new an(h.bucket.zoom+1),h.canonical),textMaxSize:x["text-size"].possiblyEvaluate(new an(18))};if(h.bucket.textSizeData.kind==="composite"){const{minZoom:V,maxZoom:W}=h.bucket.textSizeData;j.compositeTextSizes=[x["text-size"].possiblyEvaluate(new an(V),h.canonical),x["text-size"].possiblyEvaluate(new an(W),h.canonical)]}if(h.bucket.iconSizeData.kind==="composite"){const{minZoom:V,maxZoom:W}=h.bucket.iconSizeData;j.compositeIconSizes=[x["icon-size"].possiblyEvaluate(new an(V),h.canonical),x["icon-size"].possiblyEvaluate(new an(W),h.canonical)]}const k=u.get("text-line-height")*Ra,E=u.get("text-rotation-alignment")!=="viewport"&&u.get("symbol-placement")!=="point",R=u.get("text-keep-upright"),$=u.get("text-size");for(const V of h.bucket.features){const W=u.get("text-font").evaluate(V,{},h.canonical).join(","),ee=$.evaluate(V,{},h.canonical),ce=j.layoutTextSize.evaluate(V,{},h.canonical),me=j.layoutIconSize.evaluate(V,{},h.canonical),xe={horizontal:{},vertical:void 0},Ne=V.text;let Te,Le=[0,0];if(Ne){const Ze=Ne.toString(),ht=u.get("text-letter-spacing").evaluate(V,{},h.canonical)*Ra,jt=_j(Ze)?ht:0,zt=u.get("text-anchor").evaluate(V,{},h.canonical),ar=H3(d,V,h.canonical);if(!ar){const Jt=u.get("text-radial-offset").evaluate(V,{},h.canonical);Le=Jt?K3(zt,[Jt*Ra,$k]):u.get("text-offset").evaluate(V,{},h.canonical).map(sr=>sr*Ra)}let Gt=E?"center":u.get("text-justify").evaluate(V,{},h.canonical);const rr=u.get("symbol-placement")==="point"?u.get("text-max-width").evaluate(V,{},h.canonical)*Ra:1/0,kr=()=>{h.bucket.allowVerticalPlacement&&bj(Ze)&&(xe.vertical=j1(Ne,h.glyphMap,h.glyphPositions,h.imagePositions,W,rr,k,zt,"left",jt,Le,c.as.vertical,!0,ce,ee))};if(!E&&ar){const Jt=new Set;if(Gt==="auto")for(let Ot=0;Ot<ar.values.length;Ot+=2)Jt.add(zk(ar.values[Ot]));else Jt.add(Gt);let sr=!1;for(const Ot of Jt)if(!xe.horizontal[Ot])if(sr)xe.horizontal[Ot]=xe.horizontal[0];else{const zr=j1(Ne,h.glyphMap,h.glyphPositions,h.imagePositions,W,rr,k,"center",Ot,jt,Le,c.as.horizontal,!1,ce,ee);zr&&(xe.horizontal[Ot]=zr,sr=zr.positionedLines.length===1)}kr()}else{Gt==="auto"&&(Gt=zk(zt));const Jt=j1(Ne,h.glyphMap,h.glyphPositions,h.imagePositions,W,rr,k,zt,Gt,jt,Le,c.as.horizontal,!1,ce,ee);Jt&&(xe.horizontal[Gt]=Jt),kr(),bj(Ze)&&E&&R&&(xe.vertical=j1(Ne,h.glyphMap,h.glyphPositions,h.imagePositions,W,rr,k,zt,Gt,jt,Le,c.as.vertical,!1,ce,ee))}}let at=!1;if(V.icon&&V.icon.name){const Ze=h.imageMap[V.icon.name];Ze&&(Te=iee(h.imagePositions[V.icon.name],u.get("icon-offset").evaluate(V,{},h.canonical),u.get("icon-anchor").evaluate(V,{},h.canonical)),at=!!Ze.sdf,h.bucket.sdfIcons===void 0?h.bucket.sdfIcons=at:h.bucket.sdfIcons!==at&&vr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ze.pixelRatio!==h.bucket.pixelRatio||u.get("icon-rotate").constantOr(1)!==0)&&(h.bucket.iconsNeedLinear=!0))}const qe=Y3(xe.horizontal)||xe.vertical;h.bucket.iconsInText=!!qe&&qe.iconsInText,(qe||Te)&&jee(h.bucket,V,xe,Te,h.imageMap,j,ce,me,Le,at,h.canonical,h.subdivisionGranularity)}h.showCollisionBoxes&&h.bucket.generateCollisionDebugBuffers()},c.cL=wk,c.cM=Sk,c.cN=Ck,c.cO=JR,c.cP=kk,c.cQ=class{constructor(h){this._marks={start:[h.url,"start"].join("#"),end:[h.url,"end"].join("#"),measure:h.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let h=performance.getEntriesByName(this._marks.measure);return h.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),h=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),h}},c.cR=function(h,d,u,x,j){return i(this,void 0,void 0,function*(){if(O())try{return yield Je(h,d,u,x,j)}catch{}return function(k,E,R,$,V){const W=k.width,ee=k.height;lt&&qt||(lt=new OffscreenCanvas(W,ee),qt=lt.getContext("2d",{willReadFrequently:!0})),lt.width=W,lt.height=ee,qt.drawImage(k,0,0,W,ee);const ce=qt.getImageData(E,R,$,V);return qt.clearRect(0,0,W,ee),ce.data}(h,d,u,x,j)})},c.cS=BR,c.cT=p,c.cU=QR,c.cV=zx,c.cW=eu,c.cX=function(h,d){const u=new Map;if(h!=null)if(h.type==="Feature")u.set(Kj(h,d),h);else for(const x of h.features)u.set(Kj(x,d),x);return u},c.cY=function(h,d){if(h==null)return!0;if(h.type==="Feature")return Kj(h,d)!=null;if(h.type==="FeatureCollection"){const u=new Set;for(const x of h.features){const j=Kj(x,d);if(j==null||u.has(j))return!1;u.add(j)}return!0}return!1},c.cZ=function(h,d,u){var x,j,k,E;if(d.removeAll&&h.clear(),d.remove)for(const R of d.remove)h.delete(R);if(d.add)for(const R of d.add){const $=Kj(R,u);$!=null&&h.set($,R)}if(d.update)for(const R of d.update){let $=h.get(R.id);if($==null)continue;const V=!R.removeAllProperties&&(((x=R.removeProperties)===null||x===void 0?void 0:x.length)>0||((j=R.addOrUpdateProperties)===null||j===void 0?void 0:j.length)>0);if((R.newGeometry||R.removeAllProperties||V)&&($=Object.assign({},$),h.set(R.id,$),V&&($.properties=Object.assign({},$.properties))),R.newGeometry&&($.geometry=R.newGeometry),R.removeAllProperties)$.properties={};else if(((k=R.removeProperties)===null||k===void 0?void 0:k.length)>0)for(const W of R.removeProperties)Object.prototype.hasOwnProperty.call($.properties,W)&&delete $.properties[W];if(((E=R.addOrUpdateProperties)===null||E===void 0?void 0:E.length)>0)for(const{key:W,value:ee}of R.addOrUpdateProperties)$.properties[W]=ee}},c.c_=mc,c.ca=class extends kj{},c.cb=class extends _{},c.cc=function(h,d){return h[0]===d[0]&&h[1]===d[1]&&h[2]===d[2]&&h[3]===d[3]&&h[4]===d[4]&&h[5]===d[5]&&h[6]===d[6]&&h[7]===d[7]&&h[8]===d[8]&&h[9]===d[9]&&h[10]===d[10]&&h[11]===d[11]&&h[12]===d[12]&&h[13]===d[13]&&h[14]===d[14]&&h[15]===d[15]},c.cd=function(h,d){var u=h[0],x=h[1],j=h[2],k=h[3],E=h[4],R=h[5],$=h[6],V=h[7],W=h[8],ee=h[9],ce=h[10],me=h[11],xe=h[12],Ne=h[13],Te=h[14],Le=h[15],at=d[0],qe=d[1],Ze=d[2],ht=d[3],jt=d[4],zt=d[5],ar=d[6],Gt=d[7],rr=d[8],kr=d[9],Jt=d[10],sr=d[11],Ot=d[12],zr=d[13],Vr=d[14],Ir=d[15];return Math.abs(u-at)<=C*Math.max(1,Math.abs(u),Math.abs(at))&&Math.abs(x-qe)<=C*Math.max(1,Math.abs(x),Math.abs(qe))&&Math.abs(j-Ze)<=C*Math.max(1,Math.abs(j),Math.abs(Ze))&&Math.abs(k-ht)<=C*Math.max(1,Math.abs(k),Math.abs(ht))&&Math.abs(E-jt)<=C*Math.max(1,Math.abs(E),Math.abs(jt))&&Math.abs(R-zt)<=C*Math.max(1,Math.abs(R),Math.abs(zt))&&Math.abs($-ar)<=C*Math.max(1,Math.abs($),Math.abs(ar))&&Math.abs(V-Gt)<=C*Math.max(1,Math.abs(V),Math.abs(Gt))&&Math.abs(W-rr)<=C*Math.max(1,Math.abs(W),Math.abs(rr))&&Math.abs(ee-kr)<=C*Math.max(1,Math.abs(ee),Math.abs(kr))&&Math.abs(ce-Jt)<=C*Math.max(1,Math.abs(ce),Math.abs(Jt))&&Math.abs(me-sr)<=C*Math.max(1,Math.abs(me),Math.abs(sr))&&Math.abs(xe-Ot)<=C*Math.max(1,Math.abs(xe),Math.abs(Ot))&&Math.abs(Ne-zr)<=C*Math.max(1,Math.abs(Ne),Math.abs(zr))&&Math.abs(Te-Vr)<=C*Math.max(1,Math.abs(Te),Math.abs(Vr))&&Math.abs(Le-Ir)<=C*Math.max(1,Math.abs(Le),Math.abs(Ir))},c.ce=function(h,d){return h[0]=d[0],h[1]=d[1],h[2]=d[2],h[3]=d[3],h[4]=d[4],h[5]=d[5],h[6]=d[6],h[7]=d[7],h[8]=d[8],h[9]=d[9],h[10]=d[10],h[11]=d[11],h[12]=d[12],h[13]=d[13],h[14]=d[14],h[15]=d[15],h},c.cf=h=>h.type==="symbol",c.cg=h=>h.type==="circle",c.ch=h=>h.type==="heatmap",c.ci=h=>h.type==="line",c.cj=h=>h.type==="fill",c.ck=h=>h.type==="fill-extrusion",c.cl=h=>h.type==="hillshade",c.cm=h=>h.type==="color-relief",c.cn=h=>h.type==="background",c.co=h=>h.type==="custom",c.cp=Et,c.cq=function(h,d,u){const x=be(d.x-u.x,d.y-u.y),j=be(h.x-u.x,h.y-u.y);var k,E;return er(Math.atan2(x[0]*j[1]-x[1]*j[0],(k=x)[0]*(E=j)[0]+k[1]*E[1]))},c.cr=Rt,c.cs=function(h,d){return Ss[d]&&(h instanceof MouseEvent||h instanceof WheelEvent)},c.ct=function(h,d){return Qr[d]&&"touches"in h},c.cu=function(h){return Qr[h]||Ss[h]},c.cv=function(h,d,u){var x=d[0],j=d[1];return h[0]=u[0]*x+u[4]*j+u[12],h[1]=u[1]*x+u[5]*j+u[13],h},c.cw=function(h,d){const{x:u,y:x}=Gj.fromLngLat(d);return!(h<0||h>25||x<0||x>=1||u<0||u>=1)},c.cx=function(h,d){return h[0]=d[0],h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=d[1],h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=d[2],h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},c.cy=class extends Px{},c.cz=_ee,c.d=dt,c.e=ur,c.f=h=>i(void 0,void 0,void 0,function*(){if(h.byteLength===0)return createImageBitmap(new ImageData(1,1));const d=new Blob([new Uint8Array(h)],{type:"image/png"});try{return createImageBitmap(d)}catch(u){throw new Error(`Could not load image because of ${u.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),c.g=ve,c.h=h=>new Promise((d,u)=>{const x=new Image;x.onload=()=>{d(x),URL.revokeObjectURL(x.src),x.onload=null,window.requestAnimationFrame(()=>{x.src=De})},x.onerror=()=>u(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const j=new Blob([new Uint8Array(h)],{type:"image/png"});x.src=h.byteLength?URL.createObjectURL(j):De}),c.i=Dr,c.j=(h,d)=>nt(ur(h,{type:"json"}),d),c.k=Pt,c.l=$t,c.m=nt,c.n=(h,d)=>nt(ur(h,{type:"arrayBuffer"}),d),c.o=function(h){return new kk(h).readFields(ZJ,[])},c.p=h3,c.q=Dj,c.r=gi,c.s=It,c.t=ot,c.u=us,c.v=Kw,c.w=vr,c.x=n1,c.y=ok,c.z=Zw}),a("worker",["./shared"],function(c){class i{constructor(ye,ve){this.keyCache={},ye&&this.replace(ye,ve)}replace(ye,ve){this._layerConfigs={},this._layers={},this.update(ye,[],ve)}update(ye,ve,ke){for(const Ge of ye){this._layerConfigs[Ge.id]=Ge;const nt=this._layers[Ge.id]=c.bM(Ge,ke);nt._featureFilter=c.ae(nt.filter,ke),this.keyCache[Ge.id]&&delete this.keyCache[Ge.id]}for(const Ge of ve)delete this.keyCache[Ge],delete this._layerConfigs[Ge],delete this._layers[Ge];this.familiesBySource={};const Fe=c.cF(Object.values(this._layerConfigs),this.keyCache);for(const Ge of Fe){const nt=Ge.map(br=>this._layers[br.id]),dt=nt[0];if(dt.visibility==="none")continue;const rt=dt.source||"";let ft=this.familiesBySource[rt];ft||(ft=this.familiesBySource[rt]={});const $t=dt.sourceLayer||"_geojsonTileLayer";let Pt=ft[$t];Pt||(Pt=ft[$t]=[]),Pt.push(nt)}}}class f{constructor(ye){const ve={},ke=[];for(const dt in ye){const rt=ye[dt],ft=ve[dt]={};for(const $t in rt){const Pt=rt[+$t];if(!Pt||Pt.bitmap.width===0||Pt.bitmap.height===0)continue;const br={x:0,y:0,w:Pt.bitmap.width+2,h:Pt.bitmap.height+2};ke.push(br),ft[$t]={rect:br,metrics:Pt.metrics}}}const{w:Fe,h:Ge}=c.p(ke),nt=new c.q({width:Fe||1,height:Ge||1});for(const dt in ye){const rt=ye[dt];for(const ft in rt){const $t=rt[+ft];if(!$t||$t.bitmap.width===0||$t.bitmap.height===0)continue;const Pt=ve[dt][ft].rect;c.q.copy($t.bitmap,nt,{x:0,y:0},{x:Pt.x+1,y:Pt.y+1},$t.bitmap)}}this.image=nt,this.positions=ve}}c.cG("GlyphAtlas",f);class p{constructor(ye){this.tileID=new c.a0(ye.tileID.overscaledZ,ye.tileID.wrap,ye.tileID.canonical.z,ye.tileID.canonical.x,ye.tileID.canonical.y),this.uid=ye.uid,this.zoom=ye.zoom,this.pixelRatio=ye.pixelRatio,this.tileSize=ye.tileSize,this.source=ye.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ye.showCollisionBoxes,this.collectResourceTiming=!!ye.collectResourceTiming,this.returnDependencies=!!ye.returnDependencies,this.promoteId=ye.promoteId,this.inFlightDependencies=[]}parse(ye,ve,ke,Fe,Ge){return c._(this,void 0,void 0,function*(){this.status="parsing",this.data=ye,this.collisionBoxArray=new c.ac;const nt=new c.cH(Object.keys(ye.layers).sort()),dt=new c.cI(this.tileID,this.promoteId);dt.bucketLayerIDs=[];const rt={},ft={featureIndex:dt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:ke,subdivisionGranularity:Ge},$t=ve.familiesBySource[this.source];for(const Lt in $t){const Yn=ye.layers[Lt];if(!Yn)continue;Yn.version===1&&c.w(`Vector tile source "${this.source}" layer "${Lt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Mi=nt.encode(Lt),th=[];for(let Xa=0;Xa<Yn.length;Xa++){const Kt=Yn.feature(Xa),Jr=dt.getId(Kt,Lt);th.push({feature:Kt,id:Jr,index:Xa,sourceLayerIndex:Mi})}for(const Xa of $t[Lt]){const Kt=Xa[0];Kt.source!==this.source&&c.w(`layer.source = ${Kt.source} does not equal this.source = ${this.source}`),Kt.isHidden(this.zoom,!0)||(g(Xa,this.zoom,ke),(rt[Kt.id]=Kt.createBucket({index:dt.bucketLayerIDs.length,layers:Xa,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Mi,sourceID:this.source})).populate(th,ft,this.tileID.canonical),dt.bucketLayerIDs.push(Xa.map(Jr=>Jr.id)))}}const Pt=c.bR(ft.glyphDependencies,Lt=>Object.keys(Lt).map(Number));this.inFlightDependencies.forEach(Lt=>Lt==null?void 0:Lt.abort()),this.inFlightDependencies=[];let br=Promise.resolve({});if(Object.keys(Pt).length){const Lt=new AbortController;this.inFlightDependencies.push(Lt),br=Fe.sendAsync({type:"GG",data:{stacks:Pt,source:this.source,tileID:this.tileID,type:"glyphs"}},Lt)}const ot=Object.keys(ft.iconDependencies);let is=Promise.resolve({});if(ot.length){const Lt=new AbortController;this.inFlightDependencies.push(Lt),is=Fe.sendAsync({type:"GI",data:{icons:ot,source:this.source,tileID:this.tileID,type:"icons"}},Lt)}const wr=Object.keys(ft.patternDependencies);let tr=Promise.resolve({});if(wr.length){const Lt=new AbortController;this.inFlightDependencies.push(Lt),tr=Fe.sendAsync({type:"GI",data:{icons:wr,source:this.source,tileID:this.tileID,type:"patterns"}},Lt)}const Cr=ft.dashDependencies;let fs=Promise.resolve({});if(Object.keys(Cr).length){const Lt=new AbortController;this.inFlightDependencies.push(Lt),fs=Fe.sendAsync({type:"GDA",data:{dashes:Cr}},Lt)}const[Os,dn,Bs,qs]=yield Promise.all([br,is,tr,fs]),Is=new f(Os),Na=new c.cJ(dn,Bs);for(const Lt in rt){const Yn=rt[Lt];Yn instanceof c.ad?(g(Yn.layers,this.zoom,ke),c.cK({bucket:Yn,glyphMap:Os,glyphPositions:Is.positions,imageMap:dn,imagePositions:Na.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:ft.subdivisionGranularity})):Yn.hasDependencies&&(Yn instanceof c.cL||Yn instanceof c.cM||Yn instanceof c.cN)&&(g(Yn.layers,this.zoom,ke),Yn.addFeatures(ft,this.tileID.canonical,Na.patternPositions,qs))}return this.status="done",{buckets:Object.values(rt).filter(Lt=>!Lt.isEmpty()),featureIndex:dt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Is.image,imageAtlas:Na,dashPositions:qs,glyphMap:this.returnDependencies?Os:null,iconMap:this.returnDependencies?dn:null,glyphPositions:this.returnDependencies?Is.positions:null}})}}function g(Xe,ye,ve){const ke=new c.G(ye);for(const Fe of Xe)Fe.recalculate(ke,ve)}class y{constructor(ye,ve,ke){this.actor=ye,this.layerIndex=ve,this.availableImages=ke,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ye,ve){return c._(this,void 0,void 0,function*(){const ke=yield c.n(ye.request,ve);try{return{vectorTile:new c.cO(new c.cP(ke.data)),rawData:ke.data,cacheControl:ke.cacheControl,expires:ke.expires}}catch(Fe){const Ge=new Uint8Array(ke.data);let nt=`Unable to parse the tile at ${ye.request.url}, `;throw nt+=Ge[0]===31&&Ge[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Fe.message}`,new Error(nt)}})}loadTile(ye){return c._(this,void 0,void 0,function*(){const ve=ye.uid,ke=!!(ye&&ye.request&&ye.request.collectResourceTiming)&&new c.cQ(ye.request),Fe=new p(ye);this.loading[ve]=Fe;const Ge=new AbortController;Fe.abort=Ge;try{const nt=yield this.loadVectorTile(ye,Ge);if(delete this.loading[ve],!nt)return null;const dt=nt.rawData,rt={};nt.expires&&(rt.expires=nt.expires),nt.cacheControl&&(rt.cacheControl=nt.cacheControl);const ft={};if(ke){const Pt=ke.finish();Pt&&(ft.resourceTiming=JSON.parse(JSON.stringify(Pt)))}Fe.vectorTile=nt.vectorTile;const $t=Fe.parse(nt.vectorTile,this.layerIndex,this.availableImages,this.actor,ye.subdivisionGranularity);this.loaded[ve]=Fe,this.fetching[ve]={rawTileData:dt,cacheControl:rt,resourceTiming:ft};try{const Pt=yield $t;return c.e({rawTileData:dt.slice(0)},Pt,rt,ft)}finally{delete this.fetching[ve]}}catch(nt){throw delete this.loading[ve],Fe.status="done",this.loaded[ve]=Fe,nt}})}reloadTile(ye){return c._(this,void 0,void 0,function*(){const ve=ye.uid;if(!this.loaded||!this.loaded[ve])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ke=this.loaded[ve];if(ke.showCollisionBoxes=ye.showCollisionBoxes,ke.status==="parsing"){const Fe=yield ke.parse(ke.vectorTile,this.layerIndex,this.availableImages,this.actor,ye.subdivisionGranularity);let Ge;if(this.fetching[ve]){const{rawTileData:nt,cacheControl:dt,resourceTiming:rt}=this.fetching[ve];delete this.fetching[ve],Ge=c.e({rawTileData:nt.slice(0)},Fe,dt,rt)}else Ge=Fe;return Ge}if(ke.status==="done"&&ke.vectorTile)return ke.parse(ke.vectorTile,this.layerIndex,this.availableImages,this.actor,ye.subdivisionGranularity)})}abortTile(ye){return c._(this,void 0,void 0,function*(){const ve=this.loading,ke=ye.uid;ve&&ve[ke]&&ve[ke].abort&&(ve[ke].abort.abort(),delete ve[ke])})}removeTile(ye){return c._(this,void 0,void 0,function*(){this.loaded&&this.loaded[ye.uid]&&delete this.loaded[ye.uid]})}}class b{constructor(){this.loaded={}}loadTile(ye){return c._(this,void 0,void 0,function*(){const{uid:ve,encoding:ke,rawImageData:Fe,redFactor:Ge,greenFactor:nt,blueFactor:dt,baseShift:rt}=ye,ft=Fe.width+2,$t=Fe.height+2,Pt=c.b(Fe)?new c.R({width:ft,height:$t},yield c.cR(Fe,-1,-1,ft,$t)):Fe,br=new c.cS(ve,Pt,ke,Ge,nt,dt,rt);return this.loaded=this.loaded||{},this.loaded[ve]=br,br})}removeTile(ye){const ve=this.loaded,ke=ye.uid;ve&&ve[ke]&&delete ve[ke]}}var w,T,N=function(){if(T)return w;function Xe(ve,ke){if(ve.length!==0){ye(ve[0],ke);for(var Fe=1;Fe<ve.length;Fe++)ye(ve[Fe],!ke)}}function ye(ve,ke){for(var Fe=0,Ge=0,nt=0,dt=ve.length,rt=dt-1;nt<dt;rt=nt++){var ft=(ve[nt][0]-ve[rt][0])*(ve[rt][1]+ve[nt][1]),$t=Fe+ft;Ge+=Math.abs(Fe)>=Math.abs(ft)?Fe-$t+ft:ft-$t+Fe,Fe=$t}Fe+Ge>=0!=!!ke&&ve.reverse()}return T=1,w=function ve(ke,Fe){var Ge,nt=ke&&ke.type;if(nt==="FeatureCollection")for(Ge=0;Ge<ke.features.length;Ge++)ve(ke.features[Ge],Fe);else if(nt==="GeometryCollection")for(Ge=0;Ge<ke.geometries.length;Ge++)ve(ke.geometries[Ge],Fe);else if(nt==="Feature")ve(ke.geometry,Fe);else if(nt==="Polygon")Xe(ke.coordinates,Fe);else if(nt==="MultiPolygon")for(Ge=0;Ge<ke.coordinates.length;Ge++)Xe(ke.coordinates[Ge],Fe);return ke}}(),M=c.cT(N);class O extends c.cV{constructor(ye,ve){super(new c.cP,0,ve,[],[]),this.feature=ye,this.type=ye.type,this.properties=ye.tags?ye.tags:{},"id"in ye&&(typeof ye.id=="string"?this.id=parseInt(ye.id,10):typeof ye.id!="number"||isNaN(ye.id)||(this.id=ye.id))}loadGeometry(){const ye=[],ve=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const ke of ve){const Fe=[];for(const Ge of ke)Fe.push(new c.P(Ge[0],Ge[1]));ye.push(Fe)}return ye}}class C extends c.cU{constructor(ye,ve){super(new c.cP),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=ve?ve.version:1,this.extent=ve?ve.extent:4096,this.length=ye.length,this.features=ye}feature(ye){return new O(this.features[ye],this.extent)}}function D(Xe,ye){ye.writeVarintField(15,Xe.version||1),ye.writeStringField(1,Xe.name||""),ye.writeVarintField(5,Xe.extent||4096);const ve={keys:[],values:[],keycache:{},valuecache:{}};for(let Ge=0;Ge<Xe.length;Ge++)ve.feature=Xe.feature(Ge),ye.writeMessage(2,L,ve);const ke=ve.keys;for(const Ge of ke)ye.writeStringField(3,Ge);const Fe=ve.values;for(const Ge of Fe)ye.writeMessage(4,Q,Ge)}function L(Xe,ye){if(!Xe.feature)return;const ve=Xe.feature;ve.id!==void 0&&ye.writeVarintField(1,ve.id),ye.writeMessage(2,F,Xe),ye.writeVarintField(3,ve.type),ye.writeMessage(4,te,ve)}function F(Xe,ye){var ve;for(const ke in(ve=Xe.feature)==null?void 0:ve.properties){let Fe=Xe.feature.properties[ke],Ge=Xe.keycache[ke];if(Fe===null)continue;Ge===void 0&&(Xe.keys.push(ke),Ge=Xe.keys.length-1,Xe.keycache[ke]=Ge),ye.writeVarint(Ge),typeof Fe!="string"&&typeof Fe!="boolean"&&typeof Fe!="number"&&(Fe=JSON.stringify(Fe));const nt=typeof Fe+":"+Fe;let dt=Xe.valuecache[nt];dt===void 0&&(Xe.values.push(Fe),dt=Xe.values.length-1,Xe.valuecache[nt]=dt),ye.writeVarint(dt)}}function B(Xe,ye){return(ye<<3)+(7&Xe)}function U(Xe){return Xe<<1^Xe>>31}function te(Xe,ye){const ve=Xe.loadGeometry(),ke=Xe.type;let Fe=0,Ge=0;for(const nt of ve){let dt=1;ke===1&&(dt=nt.length),ye.writeVarint(B(1,dt));const rt=ke===3?nt.length-1:nt.length;for(let ft=0;ft<rt;ft++){ft===1&&ke!==1&&ye.writeVarint(B(2,rt-1));const $t=nt[ft].x-Fe,Pt=nt[ft].y-Ge;ye.writeVarint(U($t)),ye.writeVarint(U(Pt)),Fe+=$t,Ge+=Pt}Xe.type===3&&ye.writeVarint(B(7,1))}}function Q(Xe,ye){const ve=typeof Xe;ve==="string"?ye.writeStringField(1,Xe):ve==="boolean"?ye.writeBooleanField(7,Xe):ve==="number"&&(Xe%1!=0?ye.writeDoubleField(3,Xe):Xe<0?ye.writeSVarintField(6,Xe):ye.writeVarintField(5,Xe))}const re={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Xe=>Xe},Z=Math.fround||(ne=new Float32Array(1),Xe=>(ne[0]=+Xe,ne[0]));var ne;class oe{constructor(ye){this.options=Object.assign(Object.create(re),ye),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ye){const{log:ve,minZoom:ke,maxZoom:Fe}=this.options;ve&&console.time("total time");const Ge=`prepare ${ye.length} points`;ve&&console.time(Ge),this.points=ye;const nt=[];for(let rt=0;rt<ye.length;rt++){const ft=ye[rt];if(!ft.geometry)continue;const[$t,Pt]=ft.geometry.coordinates,br=Z(Se($t)),ot=Z(ae(Pt));nt.push(br,ot,1/0,rt,-1,1),this.options.reduce&&nt.push(0)}let dt=this.trees[Fe+1]=this._createTree(nt);ve&&console.timeEnd(Ge);for(let rt=Fe;rt>=ke;rt--){const ft=+Date.now();dt=this.trees[rt]=this._createTree(this._cluster(dt,rt)),ve&&console.log("z%d: %d clusters in %dms",rt,dt.numItems,+Date.now()-ft)}return ve&&console.timeEnd("total time"),this}getClusters(ye,ve){let ke=((ye[0]+180)%360+360)%360-180;const Fe=Math.max(-90,Math.min(90,ye[1]));let Ge=ye[2]===180?180:((ye[2]+180)%360+360)%360-180;const nt=Math.max(-90,Math.min(90,ye[3]));if(ye[2]-ye[0]>=360)ke=-180,Ge=180;else if(ke>Ge){const Pt=this.getClusters([ke,Fe,180,nt],ve),br=this.getClusters([-180,Fe,Ge,nt],ve);return Pt.concat(br)}const dt=this.trees[this._limitZoom(ve)],rt=dt.range(Se(ke),ae(nt),Se(Ge),ae(Fe)),ft=dt.data,$t=[];for(const Pt of rt){const br=this.stride*Pt;$t.push(ft[br+5]>1?Ce(ft,br,this.clusterProps):this.points[ft[br+3]])}return $t}getChildren(ye){const ve=this._getOriginId(ye),ke=this._getOriginZoom(ye),Fe="No cluster with the specified id.",Ge=this.trees[ke];if(!Ge)throw new Error(Fe);const nt=Ge.data;if(ve*this.stride>=nt.length)throw new Error(Fe);const dt=this.options.radius/(this.options.extent*Math.pow(2,ke-1)),rt=Ge.within(nt[ve*this.stride],nt[ve*this.stride+1],dt),ft=[];for(const $t of rt){const Pt=$t*this.stride;nt[Pt+4]===ye&&ft.push(nt[Pt+5]>1?Ce(nt,Pt,this.clusterProps):this.points[nt[Pt+3]])}if(ft.length===0)throw new Error(Fe);return ft}getLeaves(ye,ve,ke){const Fe=[];return this._appendLeaves(Fe,ye,ve=ve||10,ke=ke||0,0),Fe}getTile(ye,ve,ke){const Fe=this.trees[this._limitZoom(ye)],Ge=Math.pow(2,ye),{extent:nt,radius:dt}=this.options,rt=dt/nt,ft=(ke-rt)/Ge,$t=(ke+1+rt)/Ge,Pt={features:[]};return this._addTileFeatures(Fe.range((ve-rt)/Ge,ft,(ve+1+rt)/Ge,$t),Fe.data,ve,ke,Ge,Pt),ve===0&&this._addTileFeatures(Fe.range(1-rt/Ge,ft,1,$t),Fe.data,Ge,ke,Ge,Pt),ve===Ge-1&&this._addTileFeatures(Fe.range(0,ft,rt/Ge,$t),Fe.data,-1,ke,Ge,Pt),Pt.features.length?Pt:null}getClusterExpansionZoom(ye){let ve=this._getOriginZoom(ye)-1;for(;ve<=this.options.maxZoom;){const ke=this.getChildren(ye);if(ve++,ke.length!==1)break;ye=ke[0].properties.cluster_id}return ve}_appendLeaves(ye,ve,ke,Fe,Ge){const nt=this.getChildren(ve);for(const dt of nt){const rt=dt.properties;if(rt&&rt.cluster?Ge+rt.point_count<=Fe?Ge+=rt.point_count:Ge=this._appendLeaves(ye,rt.cluster_id,ke,Fe,Ge):Ge<Fe?Ge++:ye.push(dt),ye.length===ke)break}return Ge}_createTree(ye){const ve=new c.aM(ye.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ke=0;ke<ye.length;ke+=this.stride)ve.add(ye[ke],ye[ke+1]);return ve.finish(),ve.data=ye,ve}_addTileFeatures(ye,ve,ke,Fe,Ge,nt){for(const dt of ye){const rt=dt*this.stride,ft=ve[rt+5]>1;let $t,Pt,br;if(ft)$t=Pe(ve,rt,this.clusterProps),Pt=ve[rt],br=ve[rt+1];else{const wr=this.points[ve[rt+3]];$t=wr.properties;const[tr,Cr]=wr.geometry.coordinates;Pt=Se(tr),br=ae(Cr)}const ot={type:1,geometry:[[Math.round(this.options.extent*(Pt*Ge-ke)),Math.round(this.options.extent*(br*Ge-Fe))]],tags:$t};let is;is=ft||this.options.generateId?ve[rt+3]:this.points[ve[rt+3]].id,is!==void 0&&(ot.id=is),nt.features.push(ot)}}_limitZoom(ye){return Math.max(this.options.minZoom,Math.min(Math.floor(+ye),this.options.maxZoom+1))}_cluster(ye,ve){const{radius:ke,extent:Fe,reduce:Ge,minPoints:nt}=this.options,dt=ke/(Fe*Math.pow(2,ve)),rt=ye.data,ft=[],$t=this.stride;for(let Pt=0;Pt<rt.length;Pt+=$t){if(rt[Pt+2]<=ve)continue;rt[Pt+2]=ve;const br=rt[Pt],ot=rt[Pt+1],is=ye.within(rt[Pt],rt[Pt+1],dt),wr=rt[Pt+5];let tr=wr;for(const Cr of is){const fs=Cr*$t;rt[fs+2]>ve&&(tr+=rt[fs+5])}if(tr>wr&&tr>=nt){let Cr,fs=br*wr,Os=ot*wr,dn=-1;const Bs=(Pt/$t<<5)+(ve+1)+this.points.length;for(const qs of is){const Is=qs*$t;if(rt[Is+2]<=ve)continue;rt[Is+2]=ve;const Na=rt[Is+5];fs+=rt[Is]*Na,Os+=rt[Is+1]*Na,rt[Is+4]=Bs,Ge&&(Cr||(Cr=this._map(rt,Pt,!0),dn=this.clusterProps.length,this.clusterProps.push(Cr)),Ge(Cr,this._map(rt,Is)))}rt[Pt+4]=Bs,ft.push(fs/tr,Os/tr,1/0,Bs,-1,tr),Ge&&ft.push(dn)}else{for(let Cr=0;Cr<$t;Cr++)ft.push(rt[Pt+Cr]);if(tr>1)for(const Cr of is){const fs=Cr*$t;if(!(rt[fs+2]<=ve)){rt[fs+2]=ve;for(let Os=0;Os<$t;Os++)ft.push(rt[fs+Os])}}}}return ft}_getOriginId(ye){return ye-this.points.length>>5}_getOriginZoom(ye){return(ye-this.points.length)%32}_map(ye,ve,ke){if(ye[ve+5]>1){const nt=this.clusterProps[ye[ve+6]];return ke?Object.assign({},nt):nt}const Fe=this.points[ye[ve+3]].properties,Ge=this.options.map(Fe);return ke&&Ge===Fe?Object.assign({},Ge):Ge}}function Ce(Xe,ye,ve){return{type:"Feature",id:Xe[ye+3],properties:Pe(Xe,ye,ve),geometry:{type:"Point",coordinates:[(ke=Xe[ye],360*(ke-.5)),be(Xe[ye+1])]}};var ke}function Pe(Xe,ye,ve){const ke=Xe[ye+5],Fe=ke>=1e4?`${Math.round(ke/1e3)}k`:ke>=1e3?Math.round(ke/100)/10+"k":ke,Ge=Xe[ye+6],nt=Ge===-1?{}:Object.assign({},ve[Ge]);return Object.assign(nt,{cluster:!0,cluster_id:Xe[ye+3],point_count:ke,point_count_abbreviated:Fe})}function Se(Xe){return Xe/360+.5}function ae(Xe){const ye=Math.sin(Xe*Math.PI/180),ve=.5-.25*Math.log((1+ye)/(1-ye))/Math.PI;return ve<0?0:ve>1?1:ve}function be(Xe){const ye=(180-360*Xe)*Math.PI/180;return 360*Math.atan(Math.exp(ye))/Math.PI-90}function de(Xe,ye,ve,ke){let Fe=ke;const Ge=ye+(ve-ye>>1);let nt,dt=ve-ye;const rt=Xe[ye],ft=Xe[ye+1],$t=Xe[ve],Pt=Xe[ve+1];for(let br=ye+3;br<ve;br+=3){const ot=Ke(Xe[br],Xe[br+1],rt,ft,$t,Pt);if(ot>Fe)nt=br,Fe=ot;else if(ot===Fe){const is=Math.abs(br-Ge);is<dt&&(nt=br,dt=is)}}Fe>ke&&(nt-ye>3&&de(Xe,ye,nt,ke),Xe[nt+2]=Fe,ve-nt>3&&de(Xe,nt,ve,ke))}function Ke(Xe,ye,ve,ke,Fe,Ge){let nt=Fe-ve,dt=Ge-ke;if(nt!==0||dt!==0){const rt=((Xe-ve)*nt+(ye-ke)*dt)/(nt*nt+dt*dt);rt>1?(ve=Fe,ke=Ge):rt>0&&(ve+=nt*rt,ke+=dt*rt)}return nt=Xe-ve,dt=ye-ke,nt*nt+dt*dt}function He(Xe,ye,ve,ke){const Fe={id:Xe??null,type:ye,geometry:ve,tags:ke,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ye==="Point"||ye==="MultiPoint"||ye==="LineString")Ve(Fe,ve);else if(ye==="Polygon")Ve(Fe,ve[0]);else if(ye==="MultiLineString")for(const Ge of ve)Ve(Fe,Ge);else if(ye==="MultiPolygon")for(const Ge of ve)Ve(Fe,Ge[0]);return Fe}function Ve(Xe,ye){for(let ve=0;ve<ye.length;ve+=3)Xe.minX=Math.min(Xe.minX,ye[ve]),Xe.minY=Math.min(Xe.minY,ye[ve+1]),Xe.maxX=Math.max(Xe.maxX,ye[ve]),Xe.maxY=Math.max(Xe.maxY,ye[ve+1])}function yt(Xe,ye,ve,ke){if(!ye.geometry)return;const Fe=ye.geometry.coordinates;if(Fe&&Fe.length===0)return;const Ge=ye.geometry.type,nt=Math.pow(ve.tolerance/((1<<ve.maxZoom)*ve.extent),2);let dt=[],rt=ye.id;if(ve.promoteId?rt=ye.properties[ve.promoteId]:ve.generateId&&(rt=ke||0),Ge==="Point")Et(Fe,dt);else if(Ge==="MultiPoint")for(const ft of Fe)Et(ft,dt);else if(Ge==="LineString")Rt(Fe,dt,nt,!1);else if(Ge==="MultiLineString"){if(ve.lineMetrics){for(const ft of Fe)dt=[],Rt(ft,dt,nt,!1),Xe.push(He(rt,"LineString",dt,ye.properties));return}Vt(Fe,dt,nt,!1)}else if(Ge==="Polygon")Vt(Fe,dt,nt,!0);else{if(Ge!=="MultiPolygon"){if(Ge==="GeometryCollection"){for(const ft of ye.geometry.geometries)yt(Xe,{id:rt,geometry:ft,properties:ye.properties},ve,ke);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ft of Fe){const $t=[];Vt(ft,$t,nt,!0),dt.push($t)}}Xe.push(He(rt,Ge,dt,ye.properties))}function Et(Xe,ye){ye.push(Ct(Xe[0]),ur(Xe[1]),0)}function Rt(Xe,ye,ve,ke){let Fe,Ge,nt=0;for(let rt=0;rt<Xe.length;rt++){const ft=Ct(Xe[rt][0]),$t=ur(Xe[rt][1]);ye.push(ft,$t,0),rt>0&&(nt+=ke?(Fe*$t-ft*Ge)/2:Math.sqrt(Math.pow(ft-Fe,2)+Math.pow($t-Ge,2))),Fe=ft,Ge=$t}const dt=ye.length-3;ye[2]=1,de(ye,0,dt,ve),ye[dt+2]=1,ye.size=Math.abs(nt),ye.start=0,ye.end=ye.size}function Vt(Xe,ye,ve,ke){for(let Fe=0;Fe<Xe.length;Fe++){const Ge=[];Rt(Xe[Fe],Ge,ve,ke),ye.push(Ge)}}function Ct(Xe){return Xe/360+.5}function ur(Xe){const ye=Math.sin(Xe*Math.PI/180),ve=.5-.25*Math.log((1+ye)/(1-ye))/Math.PI;return ve<0?0:ve>1?1:ve}function At(Xe,ye,ve,ke,Fe,Ge,nt,dt){if(ke/=ye,Ge>=(ve/=ye)&&nt<ke)return Xe;if(nt<ve||Ge>=ke)return null;const rt=[];for(const ft of Xe){const $t=ft.geometry;let Pt=ft.type;const br=Fe===0?ft.minX:ft.minY,ot=Fe===0?ft.maxX:ft.maxY;if(br>=ve&&ot<ke){rt.push(ft);continue}if(ot<ve||br>=ke)continue;let is=[];if(Pt==="Point"||Pt==="MultiPoint")Ht($t,is,ve,ke,Fe);else if(Pt==="LineString")fr($t,is,ve,ke,Fe,!1,dt.lineMetrics);else if(Pt==="MultiLineString")Br($t,is,ve,ke,Fe,!1);else if(Pt==="Polygon")Br($t,is,ve,ke,Fe,!0);else if(Pt==="MultiPolygon")for(const wr of $t){const tr=[];Br(wr,tr,ve,ke,Fe,!0),tr.length&&is.push(tr)}if(is.length){if(dt.lineMetrics&&Pt==="LineString"){for(const wr of is)rt.push(He(ft.id,Pt,wr,ft.tags));continue}Pt!=="LineString"&&Pt!=="MultiLineString"||(is.length===1?(Pt="LineString",is=is[0]):Pt="MultiLineString"),Pt!=="Point"&&Pt!=="MultiPoint"||(Pt=is.length===3?"Point":"MultiPoint"),rt.push(He(ft.id,Pt,is,ft.tags))}}return rt.length?rt:null}function Ht(Xe,ye,ve,ke,Fe){for(let Ge=0;Ge<Xe.length;Ge+=3){const nt=Xe[Ge+Fe];nt>=ve&&nt<=ke&&vr(ye,Xe[Ge],Xe[Ge+1],Xe[Ge+2])}}function fr(Xe,ye,ve,ke,Fe,Ge,nt){let dt=vt(Xe);const rt=Fe===0?Xr:Dr;let ft,$t,Pt=Xe.start;for(let tr=0;tr<Xe.length-3;tr+=3){const Cr=Xe[tr],fs=Xe[tr+1],Os=Xe[tr+2],dn=Xe[tr+3],Bs=Xe[tr+4],qs=Fe===0?Cr:fs,Is=Fe===0?dn:Bs;let Na=!1;nt&&(ft=Math.sqrt(Math.pow(Cr-dn,2)+Math.pow(fs-Bs,2))),qs<ve?Is>ve&&($t=rt(dt,Cr,fs,dn,Bs,ve),nt&&(dt.start=Pt+ft*$t)):qs>ke?Is<ke&&($t=rt(dt,Cr,fs,dn,Bs,ke),nt&&(dt.start=Pt+ft*$t)):vr(dt,Cr,fs,Os),Is<ve&&qs>=ve&&($t=rt(dt,Cr,fs,dn,Bs,ve),Na=!0),Is>ke&&qs<=ke&&($t=rt(dt,Cr,fs,dn,Bs,ke),Na=!0),!Ge&&Na&&(nt&&(dt.end=Pt+ft*$t),ye.push(dt),dt=vt(Xe)),nt&&(Pt+=ft)}let br=Xe.length-3;const ot=Xe[br],is=Xe[br+1],wr=Fe===0?ot:is;wr>=ve&&wr<=ke&&vr(dt,ot,is,Xe[br+2]),br=dt.length-3,Ge&&br>=3&&(dt[br]!==dt[0]||dt[br+1]!==dt[1])&&vr(dt,dt[0],dt[1],dt[2]),dt.length&&ye.push(dt)}function vt(Xe){const ye=[];return ye.size=Xe.size,ye.start=Xe.start,ye.end=Xe.end,ye}function Br(Xe,ye,ve,ke,Fe,Ge){for(const nt of Xe)fr(nt,ye,ve,ke,Fe,Ge,!1)}function vr(Xe,ye,ve,ke){Xe.push(ye,ve,ke)}function Xr(Xe,ye,ve,ke,Fe,Ge){const nt=(Ge-ye)/(ke-ye);return vr(Xe,Ge,ve+(Fe-ve)*nt,1),nt}function Dr(Xe,ye,ve,ke,Fe,Ge){const nt=(Ge-ve)/(Fe-ve);return vr(Xe,ye+(ke-ye)*nt,Ge,1),nt}function As(Xe,ye){const ve=[];for(let ke=0;ke<Xe.length;ke++){const Fe=Xe[ke],Ge=Fe.type;let nt;if(Ge==="Point"||Ge==="MultiPoint"||Ge==="LineString")nt=xn(Fe.geometry,ye);else if(Ge==="MultiLineString"||Ge==="Polygon"){nt=[];for(const dt of Fe.geometry)nt.push(xn(dt,ye))}else if(Ge==="MultiPolygon"){nt=[];for(const dt of Fe.geometry){const rt=[];for(const ft of dt)rt.push(xn(ft,ye));nt.push(rt)}}ve.push(He(Fe.id,Ge,nt,Fe.tags))}return ve}function xn(Xe,ye){const ve=[];ve.size=Xe.size,Xe.start!==void 0&&(ve.start=Xe.start,ve.end=Xe.end);for(let ke=0;ke<Xe.length;ke+=3)ve.push(Xe[ke]+ye,Xe[ke+1],Xe[ke+2]);return ve}function Qs(Xe,ye){if(Xe.transformed)return Xe;const ve=1<<Xe.z,ke=Xe.x,Fe=Xe.y;for(const Ge of Xe.features){const nt=Ge.geometry,dt=Ge.type;if(Ge.geometry=[],dt===1)for(let rt=0;rt<nt.length;rt+=2)Ge.geometry.push(De(nt[rt],nt[rt+1],ye,ve,ke,Fe));else for(let rt=0;rt<nt.length;rt++){const ft=[];for(let $t=0;$t<nt[rt].length;$t+=2)ft.push(De(nt[rt][$t],nt[rt][$t+1],ye,ve,ke,Fe));Ge.geometry.push(ft)}}return Xe.transformed=!0,Xe}function De(Xe,ye,ve,ke,Fe,Ge){return[Math.round(ve*(Xe*ke-Fe)),Math.round(ve*(ye*ke-Ge))]}function Je(Xe,ye,ve,ke,Fe){const Ge=ye===Fe.maxZoom?0:Fe.tolerance/((1<<ye)*Fe.extent),nt={features:[],numPoints:0,numSimplified:0,numFeatures:Xe.length,source:null,x:ve,y:ke,z:ye,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const dt of Xe)lt(nt,dt,Ge,Fe);return nt}function lt(Xe,ye,ve,ke){const Fe=ye.geometry,Ge=ye.type,nt=[];if(Xe.minX=Math.min(Xe.minX,ye.minX),Xe.minY=Math.min(Xe.minY,ye.minY),Xe.maxX=Math.max(Xe.maxX,ye.maxX),Xe.maxY=Math.max(Xe.maxY,ye.maxY),Ge==="Point"||Ge==="MultiPoint")for(let dt=0;dt<Fe.length;dt+=3)nt.push(Fe[dt],Fe[dt+1]),Xe.numPoints++,Xe.numSimplified++;else if(Ge==="LineString")qt(nt,Fe,Xe,ve,!1,!1);else if(Ge==="MultiLineString"||Ge==="Polygon")for(let dt=0;dt<Fe.length;dt++)qt(nt,Fe[dt],Xe,ve,Ge==="Polygon",dt===0);else if(Ge==="MultiPolygon")for(let dt=0;dt<Fe.length;dt++){const rt=Fe[dt];for(let ft=0;ft<rt.length;ft++)qt(nt,rt[ft],Xe,ve,!0,ft===0)}if(nt.length){let dt=ye.tags||null;if(Ge==="LineString"&&ke.lineMetrics){dt={};for(const ft in ye.tags)dt[ft]=ye.tags[ft];dt.mapbox_clip_start=Fe.start/Fe.size,dt.mapbox_clip_end=Fe.end/Fe.size}const rt={geometry:nt,type:Ge==="Polygon"||Ge==="MultiPolygon"?3:Ge==="LineString"||Ge==="MultiLineString"?2:1,tags:dt};ye.id!==null&&(rt.id=ye.id),Xe.features.push(rt)}}function qt(Xe,ye,ve,ke,Fe,Ge){const nt=ke*ke;if(ke>0&&ye.size<(Fe?nt:ke))return void(ve.numPoints+=ye.length/3);const dt=[];for(let rt=0;rt<ye.length;rt+=3)(ke===0||ye[rt+2]>nt)&&(ve.numSimplified++,dt.push(ye[rt],ye[rt+1])),ve.numPoints++;Fe&&function(rt,ft){let $t=0;for(let Pt=0,br=rt.length,ot=br-2;Pt<br;ot=Pt,Pt+=2)$t+=(rt[Pt]-rt[ot])*(rt[Pt+1]+rt[ot+1]);if($t>0===ft)for(let Pt=0,br=rt.length;Pt<br/2;Pt+=2){const ot=rt[Pt],is=rt[Pt+1];rt[Pt]=rt[br-2-Pt],rt[Pt+1]=rt[br-1-Pt],rt[br-2-Pt]=ot,rt[br-1-Pt]=is}}(dt,Ge),Xe.push(dt)}const It={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Bt{constructor(ye,ve){const ke=(ve=this.options=function(Ge,nt){for(const dt in nt)Ge[dt]=nt[dt];return Ge}(Object.create(It),ve)).debug;if(ke&&console.time("preprocess data"),ve.maxZoom<0||ve.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ve.promoteId&&ve.generateId)throw new Error("promoteId and generateId cannot be used together.");let Fe=function(Ge,nt){const dt=[];if(Ge.type==="FeatureCollection")for(let rt=0;rt<Ge.features.length;rt++)yt(dt,Ge.features[rt],nt,rt);else yt(dt,Ge.type==="Feature"?Ge:{geometry:Ge},nt);return dt}(ye,ve);this.tiles={},this.tileCoords=[],ke&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ve.indexMaxZoom,ve.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Fe=function(Ge,nt){const dt=nt.buffer/nt.extent;let rt=Ge;const ft=At(Ge,1,-1-dt,dt,0,-1,2,nt),$t=At(Ge,1,1-dt,2+dt,0,-1,2,nt);return(ft||$t)&&(rt=At(Ge,1,-dt,1+dt,0,-1,2,nt)||[],ft&&(rt=As(ft,1).concat(rt)),$t&&(rt=rt.concat(As($t,-1)))),rt}(Fe,ve),Fe.length&&this.splitTile(Fe,0,0,0),ke&&(Fe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ye,ve,ke,Fe,Ge,nt,dt){const rt=[ye,ve,ke,Fe],ft=this.options,$t=ft.debug;for(;rt.length;){Fe=rt.pop(),ke=rt.pop(),ve=rt.pop(),ye=rt.pop();const Pt=1<<ve,br=er(ve,ke,Fe);let ot=this.tiles[br];if(!ot&&($t>1&&console.time("creation"),ot=this.tiles[br]=Je(ye,ve,ke,Fe,ft),this.tileCoords.push({z:ve,x:ke,y:Fe}),$t)){$t>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ve,ke,Fe,ot.numFeatures,ot.numPoints,ot.numSimplified),console.timeEnd("creation"));const Na=`z${ve}`;this.stats[Na]=(this.stats[Na]||0)+1,this.total++}if(ot.source=ye,Ge==null){if(ve===ft.indexMaxZoom||ot.numPoints<=ft.indexMaxPoints)continue}else{if(ve===ft.maxZoom||ve===Ge)continue;if(Ge!=null){const Na=Ge-ve;if(ke!==nt>>Na||Fe!==dt>>Na)continue}}if(ot.source=null,ye.length===0)continue;$t>1&&console.time("clipping");const is=.5*ft.buffer/ft.extent,wr=.5-is,tr=.5+is,Cr=1+is;let fs=null,Os=null,dn=null,Bs=null,qs=At(ye,Pt,ke-is,ke+tr,0,ot.minX,ot.maxX,ft),Is=At(ye,Pt,ke+wr,ke+Cr,0,ot.minX,ot.maxX,ft);ye=null,qs&&(fs=At(qs,Pt,Fe-is,Fe+tr,1,ot.minY,ot.maxY,ft),Os=At(qs,Pt,Fe+wr,Fe+Cr,1,ot.minY,ot.maxY,ft),qs=null),Is&&(dn=At(Is,Pt,Fe-is,Fe+tr,1,ot.minY,ot.maxY,ft),Bs=At(Is,Pt,Fe+wr,Fe+Cr,1,ot.minY,ot.maxY,ft),Is=null),$t>1&&console.timeEnd("clipping"),rt.push(fs||[],ve+1,2*ke,2*Fe),rt.push(Os||[],ve+1,2*ke,2*Fe+1),rt.push(dn||[],ve+1,2*ke+1,2*Fe),rt.push(Bs||[],ve+1,2*ke+1,2*Fe+1)}}getTile(ye,ve,ke){ye=+ye,ve=+ve,ke=+ke;const Fe=this.options,{extent:Ge,debug:nt}=Fe;if(ye<0||ye>24)return null;const dt=1<<ye,rt=er(ye,ve=ve+dt&dt-1,ke);if(this.tiles[rt])return Qs(this.tiles[rt],Ge);nt>1&&console.log("drilling down to z%d-%d-%d",ye,ve,ke);let ft,$t=ye,Pt=ve,br=ke;for(;!ft&&$t>0;)$t--,Pt>>=1,br>>=1,ft=this.tiles[er($t,Pt,br)];return ft&&ft.source?(nt>1&&(console.log("found parent tile z%d-%d-%d",$t,Pt,br),console.time("drilling down")),this.splitTile(ft.source,$t,Pt,br,ye,ve,ke),nt>1&&console.timeEnd("drilling down"),this.tiles[rt]?Qs(this.tiles[rt],Ge):null):null}}function er(Xe,ye,ve){return 32*((1<<Xe)*ve+ye)+Xe}class Qr extends y{constructor(ye,ve,ke,Fe=Ss){super(ye,ve,ke),this._dataUpdateable=new Map,this._createGeoJSONIndex=Fe}loadVectorTile(ye,ve){return c._(this,void 0,void 0,function*(){const ke=ye.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Fe=this._geoJSONIndex.getTile(ke.z,ke.x,ke.y);if(!Fe)return null;const Ge=new C(Fe.features,{version:2,extent:c.a3});let nt=function(dt){const rt=new c.cP;return function(ft,$t){for(const Pt in ft.layers)$t.writeMessage(3,D,ft.layers[Pt])}(dt,rt),rt.finish()}(Ge);return nt.byteOffset===0&&nt.byteLength===nt.buffer.byteLength||(nt=new Uint8Array(nt)),{vectorTile:Ge,rawData:nt.buffer}})}loadData(ye){return c._(this,void 0,void 0,function*(){var ve;(ve=this._pendingRequest)===null||ve===void 0||ve.abort();const ke=!!(ye&&ye.request&&ye.request.collectResourceTiming)&&new c.cQ(ye.request);this._pendingRequest=new AbortController;try{(!this._pendingData||ye.request||ye.data||ye.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(ye,this._pendingRequest));const Fe=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(Fe,ye),this.loaded={};const Ge={data:Fe};if(ke){const nt=ke.finish();nt&&(Ge.resourceTiming={},Ge.resourceTiming[ye.source]=JSON.parse(JSON.stringify(nt)))}return Ge}catch(Fe){if(delete this._pendingRequest,c.cB(Fe))return{abandoned:!0};throw Fe}})}getData(){return c._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(ye){const ve=this.loaded;return ve&&ve[ye.uid]?super.reloadTile(ye):this.loadTile(ye)}loadAndProcessGeoJSON(ye,ve){return c._(this,void 0,void 0,function*(){let ke=yield this.loadGeoJSON(ye,ve);if(delete this._pendingRequest,typeof ke!="object")throw new Error(`Input data given to '${ye.source}' is not a valid GeoJSON object.`);if(M(ke,!0),ye.filter){const Fe=c.cW(ye.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Fe.result==="error")throw new Error(Fe.value.map(nt=>`${nt.key}: ${nt.message}`).join(", "));ke={type:"FeatureCollection",features:ke.features.filter(nt=>Fe.value.evaluate({zoom:0},nt))}}return ke})}loadGeoJSON(ye,ve){return c._(this,void 0,void 0,function*(){const{promoteId:ke}=ye;if(ye.request){const Fe=yield c.j(ye.request,ve);return this._dataUpdateable=c.cY(Fe.data,ke)?c.cX(Fe.data,ke):void 0,Fe.data}if(typeof ye.data=="string")try{const Fe=JSON.parse(ye.data);return this._dataUpdateable=c.cY(Fe,ke)?c.cX(Fe,ke):void 0,Fe}catch{throw new Error(`Input data given to '${ye.source}' is not a valid GeoJSON object.`)}if(!ye.dataDiff)throw new Error(`Input data given to '${ye.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ye.source}`);return c.cZ(this._dataUpdateable,ye.dataDiff,ke),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(ye){return c._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(ye){return this._geoJSONIndex.getClusterExpansionZoom(ye.clusterId)}getClusterChildren(ye){return this._geoJSONIndex.getChildren(ye.clusterId)}getClusterLeaves(ye){return this._geoJSONIndex.getLeaves(ye.clusterId,ye.limit,ye.offset)}}function Ss(Xe,ye){return ye.cluster?new oe(function({superclusterOptions:ve,clusterProperties:ke}){if(!ke||!ve)return ve;const Fe={},Ge={},nt={accumulated:null,zoom:0},dt={properties:null},rt=Object.keys(ke);for(const ft of rt){const[$t,Pt]=ke[ft],br=c.cW(Pt),ot=c.cW(typeof $t=="string"?[$t,["accumulated"],["get",ft]]:$t);Fe[ft]=br.value,Ge[ft]=ot.value}return ve.map=ft=>{dt.properties=ft;const $t={};for(const Pt of rt)$t[Pt]=Fe[Pt].evaluate(nt,dt);return $t},ve.reduce=(ft,$t)=>{dt.properties=$t;for(const Pt of rt)nt.accumulated=ft[Pt],ft[Pt]=Ge[Pt].evaluate(nt,dt)},ve}(ye)).load(Xe.features):function(ve,ke){return new Bt(ve,ke)}(Xe,ye.geojsonVtOptions)}class Tn{constructor(ye){this.self=ye,this.actor=new c.K(ye),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(ve,ke)=>{if(this.externalWorkerSourceTypes[ve])throw new Error(`Worker source with name "${ve}" already registered.`);this.externalWorkerSourceTypes[ve]=ke},this.self.addProtocol=c.cD,this.self.removeProtocol=c.cE,this.self.registerRTLTextPlugin=ve=>{c.c_.setMethods(ve)},this.actor.registerMessageHandler("LDT",(ve,ke)=>this._getDEMWorkerSource(ve,ke.source).loadTile(ke)),this.actor.registerMessageHandler("RDT",(ve,ke)=>c._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ve,ke.source).removeTile(ke)})),this.actor.registerMessageHandler("GCEZ",(ve,ke)=>c._(this,void 0,void 0,function*(){return this._getWorkerSource(ve,ke.type,ke.source).getClusterExpansionZoom(ke)})),this.actor.registerMessageHandler("GCC",(ve,ke)=>c._(this,void 0,void 0,function*(){return this._getWorkerSource(ve,ke.type,ke.source).getClusterChildren(ke)})),this.actor.registerMessageHandler("GCL",(ve,ke)=>c._(this,void 0,void 0,function*(){return this._getWorkerSource(ve,ke.type,ke.source).getClusterLeaves(ke)})),this.actor.registerMessageHandler("LD",(ve,ke)=>this._getWorkerSource(ve,ke.type,ke.source).loadData(ke)),this.actor.registerMessageHandler("GD",(ve,ke)=>this._getWorkerSource(ve,ke.type,ke.source).getData()),this.actor.registerMessageHandler("LT",(ve,ke)=>this._getWorkerSource(ve,ke.type,ke.source).loadTile(ke)),this.actor.registerMessageHandler("RT",(ve,ke)=>this._getWorkerSource(ve,ke.type,ke.source).reloadTile(ke)),this.actor.registerMessageHandler("AT",(ve,ke)=>this._getWorkerSource(ve,ke.type,ke.source).abortTile(ke)),this.actor.registerMessageHandler("RMT",(ve,ke)=>this._getWorkerSource(ve,ke.type,ke.source).removeTile(ke)),this.actor.registerMessageHandler("RS",(ve,ke)=>c._(this,void 0,void 0,function*(){if(!this.workerSources[ve]||!this.workerSources[ve][ke.type]||!this.workerSources[ve][ke.type][ke.source])return;const Fe=this.workerSources[ve][ke.type][ke.source];delete this.workerSources[ve][ke.type][ke.source],Fe.removeSource!==void 0&&Fe.removeSource(ke)})),this.actor.registerMessageHandler("RM",ve=>c._(this,void 0,void 0,function*(){delete this.layerIndexes[ve],delete this.availableImages[ve],delete this.workerSources[ve],delete this.demWorkerSources[ve],this.globalStates.delete(ve)})),this.actor.registerMessageHandler("SR",(ve,ke)=>c._(this,void 0,void 0,function*(){this.referrer=ke})),this.actor.registerMessageHandler("SRPS",(ve,ke)=>this._syncRTLPluginState(ve,ke)),this.actor.registerMessageHandler("IS",(ve,ke)=>c._(this,void 0,void 0,function*(){this.self.importScripts(ke)})),this.actor.registerMessageHandler("SI",(ve,ke)=>this._setImages(ve,ke)),this.actor.registerMessageHandler("UL",(ve,ke)=>c._(this,void 0,void 0,function*(){this._getLayerIndex(ve).update(ke.layers,ke.removedIds,this._getGlobalState(ve))})),this.actor.registerMessageHandler("UGS",(ve,ke)=>c._(this,void 0,void 0,function*(){const Fe=this._getGlobalState(ve);for(const Ge in ke)Fe[Ge]=ke[Ge]})),this.actor.registerMessageHandler("SL",(ve,ke)=>c._(this,void 0,void 0,function*(){this._getLayerIndex(ve).replace(ke,this._getGlobalState(ve))}))}_getGlobalState(ye){let ve=this.globalStates.get(ye);return ve||(ve={},this.globalStates.set(ye,ve)),ve}_setImages(ye,ve){return c._(this,void 0,void 0,function*(){this.availableImages[ye]=ve;for(const ke in this.workerSources[ye]){const Fe=this.workerSources[ye][ke];for(const Ge in Fe)Fe[Ge].availableImages=ve}})}_syncRTLPluginState(ye,ve){return c._(this,void 0,void 0,function*(){return yield c.c_.syncState(ve,this.self.importScripts)})}_getAvailableImages(ye){let ve=this.availableImages[ye];return ve||(ve=[]),ve}_getLayerIndex(ye){let ve=this.layerIndexes[ye];return ve||(ve=this.layerIndexes[ye]=new i),ve}_getWorkerSource(ye,ve,ke){if(this.workerSources[ye]||(this.workerSources[ye]={}),this.workerSources[ye][ve]||(this.workerSources[ye][ve]={}),!this.workerSources[ye][ve][ke]){const Fe={sendAsync:(Ge,nt)=>(Ge.targetMapId=ye,this.actor.sendAsync(Ge,nt))};switch(ve){case"vector":this.workerSources[ye][ve][ke]=new y(Fe,this._getLayerIndex(ye),this._getAvailableImages(ye));break;case"geojson":this.workerSources[ye][ve][ke]=new Qr(Fe,this._getLayerIndex(ye),this._getAvailableImages(ye));break;default:this.workerSources[ye][ve][ke]=new this.externalWorkerSourceTypes[ve](Fe,this._getLayerIndex(ye),this._getAvailableImages(ye))}}return this.workerSources[ye][ve][ke]}_getDEMWorkerSource(ye,ve){return this.demWorkerSources[ye]||(this.demWorkerSources[ye]={}),this.demWorkerSources[ye][ve]||(this.demWorkerSources[ye][ve]=new b),this.demWorkerSources[ye][ve]}}return c.i(self)&&(self.worker=new Tn(self)),Tn}),a("index",["exports","./shared"],function(c,i){var f="5.11.0";function p(){var S=new i.A(4);return i.A!=Float32Array&&(S[1]=0,S[2]=0),S[0]=1,S[3]=1,S}let g,y;const b={frame(S,l,m){const v=requestAnimationFrame(P=>{_(),l(P)}),{unsubscribe:_}=i.s(S.signal,"abort",()=>{_(),cancelAnimationFrame(v),m(i.c())},!1)},frameAsync(S){return new Promise((l,m)=>{this.frame(S,l,m)})},getImageData(S,l=0){return this.getImageCanvasContext(S).getImageData(-l,-l,S.width+2*l,S.height+2*l)},getImageCanvasContext(S){const l=window.document.createElement("canvas"),m=l.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return l.width=S.width,l.height=S.height,m.drawImage(S,0,0,S.width,S.height),m},resolveURL:S=>(g||(g=document.createElement("a")),g.href=S,g.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(y==null&&(y=matchMedia("(prefers-reduced-motion: reduce)")),y.matches)}},w=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(S){this._frozenAt=S}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function T(){return w.getCurrentTime()}class N{static testProp(l){if(!N.docStyle)return l[0];for(let m=0;m<l.length;m++)if(l[m]in N.docStyle)return l[m];return l[0]}static create(l,m,v){const _=window.document.createElement(l);return m!==void 0&&(_.className=m),v&&v.appendChild(_),_}static createNS(l,m){return window.document.createElementNS(l,m)}static disableDrag(){N.docStyle&&N.selectProp&&(N.userSelect=N.docStyle[N.selectProp],N.docStyle[N.selectProp]="none")}static enableDrag(){N.docStyle&&N.selectProp&&(N.docStyle[N.selectProp]=N.userSelect)}static setTransform(l,m){l.style[N.transformProp]=m}static addEventListener(l,m,v,_={}){l.addEventListener(m,v,"passive"in _?_:_.capture)}static removeEventListener(l,m,v,_={}){l.removeEventListener(m,v,"passive"in _?_:_.capture)}static suppressClickInternal(l){l.preventDefault(),l.stopPropagation(),window.removeEventListener("click",N.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",N.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",N.suppressClickInternal,!0)},0)}static getScale(l){const m=l.getBoundingClientRect();return{x:m.width/l.offsetWidth||1,y:m.height/l.offsetHeight||1,boundingClientRect:m}}static getPoint(l,m,v){const _=m.boundingClientRect;return new i.P((v.clientX-_.left)/m.x-l.clientLeft,(v.clientY-_.top)/m.y-l.clientTop)}static mousePos(l,m){const v=N.getScale(l);return N.getPoint(l,v,m)}static touchPos(l,m){const v=[],_=N.getScale(l);for(let P=0;P<m.length;P++)v.push(N.getPoint(l,_,m[P]));return v}static mouseButton(l){return l.button}static remove(l){l.parentNode&&l.parentNode.removeChild(l)}static sanitize(l){const m=new DOMParser().parseFromString(l,"text/html").body||document.createElement("body"),v=m.querySelectorAll("script");for(const _ of v)_.remove();return N.clean(m),m.innerHTML}static isPossiblyDangerous(l,m){const v=m.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(l)||!v.includes("javascript:")&&!v.includes("data:"))||!!l.startsWith("on")||void 0}static clean(l){const m=l.children;for(const v of m)N.removeAttributes(v),N.clean(v)}static removeAttributes(l){for(const{name:m,value:v}of l.attributes)N.isPossiblyDangerous(m,v)&&l.removeAttribute(m)}}N.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,N.selectProp=N.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),N.transformProp=N.testProp(["transform","WebkitTransform"]);const M={supported:!1,testSupport:function(S){!D&&C&&(L?F(S):O=S)}};let O,C,D=!1,L=!1;function F(S){const l=S.createTexture();S.bindTexture(S.TEXTURE_2D,l);try{if(S.texImage2D(S.TEXTURE_2D,0,S.RGBA,S.RGBA,S.UNSIGNED_BYTE,C),S.isContextLost())return;M.supported=!0}catch{}S.deleteTexture(l),D=!0}var B;typeof document<"u"&&(C=document.createElement("img"),C.onload=()=>{O&&F(O),O=null,L=!0},C.onerror=()=>{D=!0,O=null},C.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(S){let l,m,v,_;S.resetRequestQueue=()=>{l=[],m=0,v=0,_={}},S.addThrottleControl=q=>{const G=v++;return _[G]=q,G},S.removeThrottleControl=q=>{delete _[q],I()},S.getImage=(q,G,Y=!0)=>new Promise((le,ie)=>{M.supported&&(q.headers||(q.headers={}),q.headers.accept="image/webp,*/*"),i.e(q,{type:"image"}),l.push({abortController:G,requestParameters:q,supportImageRefresh:Y,state:"queued",onError:fe=>{ie(fe)},onSuccess:fe=>{le(fe)}}),I()});const P=q=>i._(this,void 0,void 0,function*(){q.state="running";const{requestParameters:G,supportImageRefresh:Y,onError:le,onSuccess:ie,abortController:fe}=q,_e=Y===!1&&!i.i(self)&&!i.g(G.url)&&(!G.headers||Object.keys(G.headers).reduce((Re,ze)=>Re&&ze==="accept",!0));m++;const Ee=_e?z(G,fe):i.m(G,fe);try{const Re=yield Ee;delete q.abortController,q.state="completed",Re.data instanceof HTMLImageElement||i.b(Re.data)?ie(Re):Re.data&&ie({data:yield(Oe=Re.data,typeof createImageBitmap=="function"?i.f(Oe):i.h(Oe)),cacheControl:Re.cacheControl,expires:Re.expires})}catch(Re){delete q.abortController,le(Re)}finally{m--,I()}var Oe}),I=()=>{const q=(()=>{for(const G of Object.keys(_))if(_[G]())return!0;return!1})()?i.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:i.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let G=m;G<q&&l.length>0;G++){const Y=l.shift();Y.abortController.signal.aborted?G--:P(Y)}},z=(q,G)=>new Promise((Y,le)=>{const ie=new Image,fe=q.url,_e=q.credentials;_e&&_e==="include"?ie.crossOrigin="use-credentials":(_e&&_e==="same-origin"||!i.d(fe))&&(ie.crossOrigin="anonymous"),G.signal.addEventListener("abort",()=>{ie.src="",le(i.c())}),ie.fetchPriority="high",ie.onload=()=>{ie.onerror=ie.onload=null,Y({data:ie})},ie.onerror=()=>{ie.onerror=ie.onload=null,G.signal.aborted||le(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},ie.src=fe})}(B||(B={})),B.resetRequestQueue();class U{constructor(l){this._transformRequestFn=l??null}transformRequest(l,m){return this._transformRequestFn&&this._transformRequestFn(l,m)||{url:l}}setTransformRequest(l){this._transformRequestFn=l}}function te(S){const l=[];if(typeof S=="string")l.push({id:"default",url:S});else if(S&&S.length>0){const m=[];for(const{id:v,url:_}of S){const P=`${v}${_}`;m.indexOf(P)===-1&&(m.push(P),l.push({id:v,url:_}))}}return l}function Q(S,l,m){try{const v=new URL(S);return v.pathname+=`${l}${m}`,v.toString()}catch{throw new Error(`Invalid sprite URL "${S}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function re(S){const{userImage:l}=S;return!!(l&&l.render&&l.render())&&(S.data.replace(new Uint8Array(l.data.buffer)),!0)}class Z extends i.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new i.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:m,promiseResolve:v}of this.requestors)v(this._getImagesForIds(m));this.requestors=[]}}getImage(l){const m=this.images[l];if(m&&!m.data&&m.spriteData){const v=m.spriteData;m.data=new i.R({width:v.width,height:v.height},v.context.getImageData(v.x,v.y,v.width,v.height).data),m.spriteData=null}return m}addImage(l,m){if(this.images[l])throw new Error(`Image id ${l} already exist, use updateImage instead`);this._validate(l,m)&&(this.images[l]=m)}_validate(l,m){let v=!0;const _=m.data||m.spriteData;return this._validateStretch(m.stretchX,_&&_.width)||(this.fire(new i.k(new Error(`Image "${l}" has invalid "stretchX" value`))),v=!1),this._validateStretch(m.stretchY,_&&_.height)||(this.fire(new i.k(new Error(`Image "${l}" has invalid "stretchY" value`))),v=!1),this._validateContent(m.content,m)||(this.fire(new i.k(new Error(`Image "${l}" has invalid "content" value`))),v=!1),v}_validateStretch(l,m){if(!l)return!0;let v=0;for(const _ of l){if(_[0]<v||_[1]<_[0]||m<_[1])return!1;v=_[1]}return!0}_validateContent(l,m){if(!l)return!0;if(l.length!==4)return!1;const v=m.spriteData,_=v&&v.width||m.data.width,P=v&&v.height||m.data.height;return!(l[0]<0||_<l[0]||l[1]<0||P<l[1]||l[2]<0||_<l[2]||l[3]<0||P<l[3]||l[2]<l[0]||l[3]<l[1])}updateImage(l,m,v=!0){const _=this.getImage(l);if(v&&(_.data.width!==m.data.width||_.data.height!==m.data.height))throw new Error(`size mismatch between old image (${_.data.width}x${_.data.height}) and new image (${m.data.width}x${m.data.height}).`);m.version=_.version+1,this.images[l]=m,this.updatedImages[l]=!0}removeImage(l){const m=this.images[l];delete this.images[l],delete this.patterns[l],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l){return new Promise((m,v)=>{let _=!0;if(!this.isLoaded())for(const P of l)this.images[P]||(_=!1);this.isLoaded()||_?m(this._getImagesForIds(l)):this.requestors.push({ids:l,promiseResolve:m})})}_getImagesForIds(l){const m={};for(const v of l){let _=this.getImage(v);_||(this.fire(new i.l("styleimagemissing",{id:v})),_=this.getImage(v)),_?m[v]={data:_.data.clone(),pixelRatio:_.pixelRatio,sdf:_.sdf,version:_.version,stretchX:_.stretchX,stretchY:_.stretchY,content:_.content,textFitWidth:_.textFitWidth,textFitHeight:_.textFitHeight,hasRenderCallback:!!(_.userImage&&_.userImage.render)}:i.w(`Image "${v}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return m}getPixelSize(){const{width:l,height:m}=this.atlasImage;return{width:l,height:m}}getPattern(l){const m=this.patterns[l],v=this.getImage(l);if(!v)return null;if(m&&m.position.version===v.version)return m.position;if(m)m.position.version=v.version;else{const _={w:v.data.width+2,h:v.data.height+2,x:0,y:0},P=new i.I(_,v);this.patterns[l]={bin:_,position:P}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const m=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new i.T(l,this.atlasImage,m.RGBA),this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const P in this.patterns)l.push(this.patterns[P].bin);const{w:m,h:v}=i.p(l),_=this.atlasImage;_.resize({width:m||1,height:v||1});for(const P in this.patterns){const{bin:I}=this.patterns[P],z=I.x+1,q=I.y+1,G=this.getImage(P).data,Y=G.width,le=G.height;i.R.copy(G,_,{x:0,y:0},{x:z,y:q},{width:Y,height:le}),i.R.copy(G,_,{x:0,y:le-1},{x:z,y:q-1},{width:Y,height:1}),i.R.copy(G,_,{x:0,y:0},{x:z,y:q+le},{width:Y,height:1}),i.R.copy(G,_,{x:Y-1,y:0},{x:z-1,y:q},{width:1,height:le}),i.R.copy(G,_,{x:0,y:0},{x:z+Y,y:q},{width:1,height:le})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const m of l){if(this.callbackDispatchedThisFrame[m])continue;this.callbackDispatchedThisFrame[m]=!0;const v=this.getImage(m);v||i.w(`Image with ID: "${m}" was not found`),re(v)&&this.updateImage(m,v)}}}const ne=1e20;function oe(S,l,m,v,_,P,I,z,q){for(let G=l;G<l+v;G++)Ce(S,m*P+G,P,_,I,z,q);for(let G=m;G<m+_;G++)Ce(S,G*P+l,1,v,I,z,q)}function Ce(S,l,m,v,_,P,I){P[0]=0,I[0]=-ne,I[1]=ne,_[0]=S[l];for(let z=1,q=0,G=0;z<v;z++){_[z]=S[l+z*m];const Y=z*z;do{const le=P[q];G=(_[z]-_[le]+Y-le*le)/(z-le)/2}while(G<=I[q]&&--q>-1);q++,P[q]=z,I[q]=G,I[q+1]=ne}for(let z=0,q=0;z<v;z++){for(;I[q+1]<z;)q++;const G=P[q],Y=z-G;S[l+z*m]=_[G]+Y*Y}}const Pe=i.v.layout_symbol["text-font"].default.join(",");class Se{constructor(l,m,v){this.requestManager=l,this.localIdeographFontFamily=m,this.entries={},this.lang=v}setURL(l){this.url=l}getGlyphs(l){return i._(this,void 0,void 0,function*(){const m=[];for(const P in l)for(const I of l[P])m.push(this._getAndCacheGlyphsPromise(P,I));const v=yield Promise.all(m),_={};for(const{stack:P,id:I,glyph:z}of v)_[P]||(_[P]={}),_[P][I]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics};return _})}_getAndCacheGlyphsPromise(l,m){return i._(this,void 0,void 0,function*(){let v=this.entries[l];v||(v=this.entries[l]={glyphs:{},requests:{},ranges:{}});let _=v.glyphs[m];return _!==void 0?{stack:l,id:m,glyph:_}:!this.url||this._charUsesLocalIdeographFontFamily(m)?(_=v.glyphs[m]=this._drawGlyph(v,l,m),{stack:l,id:m,glyph:_}):yield this._downloadAndCacheRangePromise(l,m)})}_downloadAndCacheRangePromise(l,m){return i._(this,void 0,void 0,function*(){const v=Math.floor(m/256);if(256*v>65535)throw new Error("glyphs > 65535 not supported");const _=this.entries[l];if(_.ranges[v])return{stack:l,id:m,glyph:null};if(!_.requests[v]){const P=Se.loadGlyphRange(l,v,this.url,this.requestManager);_.requests[v]=P}try{const P=yield _.requests[v];for(const I in P)_.glyphs[+I]=P[+I];return _.ranges[v]=!0,{stack:l,id:m,glyph:P[m]||null}}catch(P){const I=_.glyphs[m]=this._drawGlyph(_,l,m);return this._warnOnMissingGlyphRange(I,v,m,P),{stack:l,id:m,glyph:I}}})}_warnOnMissingGlyphRange(l,m,v,_){const P=256*m,I=P+255,z=v.toString(16).padStart(4,"0").toUpperCase();i.w(`Unable to load glyph range ${m}, ${P}-${I}. Rendering codepoint U+${z} locally instead. ${_}`)}_charUsesLocalIdeographFontFamily(l){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(l))||i.u["CJK Unified Ideographs"](l)||i.u["Hangul Syllables"](l)||i.u.Hiragana(l)||i.u.Katakana(l)||i.u["CJK Symbols and Punctuation"](l)||i.u["Halfwidth and Fullwidth Forms"](l))}_drawGlyph(l,m,v){const _=m===Pe&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(v),P=_?"ideographTinySDF":"tinySDF";l[P]||(l[P]=this._createTinySDF(_?this.localIdeographFontFamily:m));const I=l[P].draw(String.fromCharCode(v));return{id:v,bitmap:new i.q({width:I.width||60,height:I.height||60},I.data),metrics:{width:I.glyphWidth/2||24,height:I.glyphHeight/2||24,left:I.glyphLeft/2+.5||0,top:I.glyphTop/2-27.5||-8,advance:I.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(l){const m=l?l.split(","):[];m.push("sans-serif");const v=m.map(_=>/[-\w]+/.test(_)?_:`'${CSS.escape(_)}'`).join(",");return new Se.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:v,fontWeight:this._fontWeight(m[0]),fontStyle:this._fontStyle(m[0]),lang:this.lang})}_fontStyle(l){return/italic/i.test(l)?"italic":/oblique/i.test(l)?"oblique":"normal"}_fontWeight(l){const m={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let v;for(const[_,P]of Object.entries(m))new RegExp(`\\b${_}\\b`,"i").test(l)&&(v=`${P}`);return v}}Se.loadGlyphRange=function(S,l,m,v){return i._(this,void 0,void 0,function*(){const _=256*l,P=_+255,I=v.transformRequest(m.replace("{fontstack}",S).replace("{range}",`${_}-${P}`),"Glyphs"),z=yield i.n(I,new AbortController);if(!z||!z.data)throw new Error(`Could not load glyph range. range: ${l}, ${_}-${P}`);const q={};for(const G of i.o(z.data))q[G.id]=G;return q})},Se.TinySDF=class{constructor({fontSize:S=24,buffer:l=3,radius:m=8,cutoff:v=.25,fontFamily:_="sans-serif",fontWeight:P="normal",fontStyle:I="normal",lang:z=null}={}){this.buffer=l,this.cutoff=v,this.radius=m,this.lang=z;const q=this.size=S+4*l,G=this._createCanvas(q),Y=this.ctx=G.getContext("2d",{willReadFrequently:!0});Y.font=`${I} ${P} ${S}px ${_}`,Y.textBaseline="alphabetic",Y.textAlign="left",Y.fillStyle="black",this.gridOuter=new Float64Array(q*q),this.gridInner=new Float64Array(q*q),this.f=new Float64Array(q),this.z=new Float64Array(q+1),this.v=new Uint16Array(q)}_createCanvas(S){const l=document.createElement("canvas");return l.width=l.height=S,l}draw(S){const{width:l,actualBoundingBoxAscent:m,actualBoundingBoxDescent:v,actualBoundingBoxLeft:_,actualBoundingBoxRight:P}=this.ctx.measureText(S),I=Math.ceil(m),z=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(P-_))),q=Math.min(this.size-this.buffer,I+Math.ceil(v)),G=z+2*this.buffer,Y=q+2*this.buffer,le=Math.max(G*Y,0),ie=new Uint8ClampedArray(le),fe={data:ie,width:G,height:Y,glyphWidth:z,glyphHeight:q,glyphTop:I,glyphLeft:0,glyphAdvance:l};if(z===0||q===0)return fe;const{ctx:_e,buffer:Ee,gridInner:Oe,gridOuter:Re}=this;this.lang&&(_e.lang=this.lang),_e.clearRect(Ee,Ee,z,q),_e.fillText(S,Ee,Ee+I);const ze=_e.getImageData(Ee,Ee,z,q);Re.fill(ne,0,le),Oe.fill(0,0,le);for(let Ue=0;Ue<q;Ue++)for(let $e=0;$e<z;$e++){const We=ze.data[4*(Ue*z+$e)+3]/255;if(We===0)continue;const Ye=(Ue+Ee)*G+$e+Ee;if(We===1)Re[Ye]=0,Oe[Ye]=ne;else{const Be=.5-We;Re[Ye]=Be>0?Be*Be:0,Oe[Ye]=Be<0?Be*Be:0}}oe(Re,0,0,G,Y,G,this.f,this.v,this.z),oe(Oe,Ee,Ee,z,q,G,this.f,this.v,this.z);for(let Ue=0;Ue<le;Ue++){const $e=Math.sqrt(Re[Ue])-Math.sqrt(Oe[Ue]);ie[Ue]=Math.round(255-255*($e/this.radius+this.cutoff))}return fe}};class ae{constructor(){this.specification=i.t.light.position}possiblyEvaluate(l,m){return i.C(l.expression.evaluate(m))}interpolate(l,m,v){return{x:i.F.number(l.x,m.x,v),y:i.F.number(l.y,m.y,v),z:i.F.number(l.z,m.z,v)}}}let be;class de extends i.E{constructor(l){super(),be=be||new i.r({anchor:new i.D(i.t.light.anchor),position:new ae,color:new i.D(i.t.light.color),intensity:new i.D(i.t.light.intensity)}),this._transitionable=new i.x(be,void 0),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,m={}){if(!this._validate(i.y,l,m))for(const v in l){const _=l[v];v.endsWith("-transition")?this._transitionable.setTransition(v.slice(0,-11),_):this._transitionable.setValue(v,_)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,m,v){return(!v||v.validate!==!1)&&i.z(this,l.call(i.B,{value:m,style:{glyphs:!0,sprite:!0},styleSpec:i.t}))}}const Ke=new i.r({"sky-color":new i.D(i.t.sky["sky-color"]),"horizon-color":new i.D(i.t.sky["horizon-color"]),"fog-color":new i.D(i.t.sky["fog-color"]),"fog-ground-blend":new i.D(i.t.sky["fog-ground-blend"]),"horizon-fog-blend":new i.D(i.t.sky["horizon-fog-blend"]),"sky-horizon-blend":new i.D(i.t.sky["sky-horizon-blend"]),"atmosphere-blend":new i.D(i.t.sky["atmosphere-blend"])});class He extends i.E{constructor(l){super(),this._transitionable=new i.x(Ke,void 0),this.setSky(l),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new i.G(0))}setSky(l,m={}){if(!this._validate(i.H,l,m)){l||(l={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const v in l){const _=l[v];v.endsWith("-transition")?this._transitionable.setTransition(v.slice(0,-11),_):this._transitionable.setValue(v,_)}}}getSky(){return this._transitionable.serialize()}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,m,v={}){return(v==null?void 0:v.validate)!==!1&&i.z(this,l.call(i.B,i.e({value:m,style:{glyphs:!0,sprite:!0},styleSpec:i.t})))}calculateFogBlendOpacity(l){return l<60?0:l<70?(l-60)/10:1}}class Ve{constructor(l,m){this.width=l,this.height=m,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(l,m){const v=l.join(",")+String(m);return this.dashEntry[v]||(this.dashEntry[v]=this.addDash(l,m)),this.dashEntry[v]}getDashRanges(l,m,v){const _=[];let P=l.length%2==1?-l[l.length-1]*v:0,I=l[0]*v,z=!0;_.push({left:P,right:I,isDash:z,zeroLength:l[0]===0});let q=l[0];for(let G=1;G<l.length;G++){z=!z;const Y=l[G];P=q*v,q+=Y,I=q*v,_.push({left:P,right:I,isDash:z,zeroLength:Y===0})}return _}addRoundDash(l,m,v){const _=m/2;for(let P=-v;P<=v;P++){const I=this.width*(this.nextRow+v+P);let z=0,q=l[z];for(let G=0;G<this.width;G++){G/q.right>1&&(q=l[++z]);const Y=Math.abs(G-q.left),le=Math.abs(G-q.right),ie=Math.min(Y,le);let fe;const _e=P/v*(_+1);if(q.isDash){const Ee=_-Math.abs(_e);fe=Math.sqrt(ie*ie+Ee*Ee)}else fe=_-Math.sqrt(ie*ie+_e*_e);this.data[I+G]=Math.max(0,Math.min(255,fe+128))}}}addRegularDash(l){for(let z=l.length-1;z>=0;--z){const q=l[z],G=l[z+1];q.zeroLength?l.splice(z,1):G&&G.isDash===q.isDash&&(G.left=q.left,l.splice(z,1))}const m=l[0],v=l[l.length-1];m.isDash===v.isDash&&(m.left=v.left-this.width,v.right=m.right+this.width);const _=this.width*this.nextRow;let P=0,I=l[P];for(let z=0;z<this.width;z++){z/I.right>1&&(I=l[++P]);const q=Math.abs(z-I.left),G=Math.abs(z-I.right),Y=Math.min(q,G);this.data[_+z]=Math.max(0,Math.min(255,(I.isDash?Y:-Y)+128))}}addDash(l,m){const v=m?7:0,_=2*v+1;if(this.nextRow+_>this.height)return i.w("LineAtlas out of space"),null;let P=0;for(let z=0;z<l.length;z++)P+=l[z];if(P!==0){const z=this.width/P,q=this.getDashRanges(l,this.width,z);m?this.addRoundDash(q,z,v):this.addRegularDash(q)}const I={y:this.nextRow+v,height:2*v,width:P};return this.nextRow+=_,this.dirty=!0,I}bind(l){const m=l.gl;this.texture?(m.bindTexture(m.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,m.texSubImage2D(m.TEXTURE_2D,0,0,0,this.width,this.height,m.ALPHA,m.UNSIGNED_BYTE,this.data))):(this.texture=m.createTexture(),m.bindTexture(m.TEXTURE_2D,this.texture),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.REPEAT),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.REPEAT),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR),m.texImage2D(m.TEXTURE_2D,0,m.ALPHA,this.width,this.height,0,m.ALPHA,m.UNSIGNED_BYTE,this.data))}}const yt="maplibre_preloaded_worker_pool";class Et{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<Et.workerCount;)this.workers.push(new Worker(i.a.WORKER_URL));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach(m=>{m.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[yt]}numActive(){return Object.keys(this.active).length}}const Rt=Math.floor(b.hardwareConcurrency/2);let Vt,Ct;function ur(){return Vt||(Vt=new Et),Vt}Et.workerCount=i.J(globalThis)?Math.max(Math.min(Rt,3),1):1;class At{constructor(l,m){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=m;const v=this.workerPool.acquire(m);for(let _=0;_<v.length;_++){const P=new i.K(v[_],m);P.name=`Worker ${_}`,this.actors.push(P)}if(!this.actors.length)throw new Error("No actors found")}broadcast(l,m){const v=[];for(const _ of this.actors)v.push(_.sendAsync({type:l,data:m}));return Promise.all(v)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(l=!0){this.actors.forEach(m=>{m.remove()}),this.actors=[],l&&this.workerPool.release(this.id)}registerMessageHandler(l,m){for(const v of this.actors)v.registerMessageHandler(l,m)}}function Ht(){return Ct||(Ct=new At(ur(),i.L),Ct.registerMessageHandler("GR",(S,l,m)=>i.m(l,m))),Ct}function fr(S,l){const m=i.M();return i.N(m,m,[1,1,0]),i.O(m,m,[.5*S.width,.5*S.height,1]),S.calculatePosMatrix?i.Q(m,m,S.calculatePosMatrix(l.toUnwrapped())):m}function vt(S,l,m,v,_,P,I){var z;const q=function(ie,fe,_e){if(ie)for(const Ee of ie){const Oe=fe[Ee];if(Oe&&Oe.source===_e&&Oe.type==="fill-extrusion")return!0}else for(const Ee in fe){const Oe=fe[Ee];if(Oe.source===_e&&Oe.type==="fill-extrusion")return!0}return!1}((z=_==null?void 0:_.layers)!==null&&z!==void 0?z:null,l,S.id),G=P.maxPitchScaleFactor(),Y=S.tilesIn(v,G,q);Y.sort(Br);const le=[];for(const ie of Y)le.push({wrappedTileID:ie.tileID.wrapped().key,queryResults:ie.tile.queryRenderedFeatures(l,m,S.getState(),ie.queryGeometry,ie.cameraQueryGeometry,ie.scale,_,P,G,fr(P,ie.tileID),I?(fe,_e)=>I(ie.tileID,fe,_e):void 0)});return function(ie,fe){for(const _e in ie)for(const Ee of ie[_e])vr(Ee,fe);return ie}(function(ie){const fe={},_e={};for(const Ee of ie){const Oe=Ee.queryResults,Re=Ee.wrappedTileID,ze=_e[Re]=_e[Re]||{};for(const Ue in Oe){const $e=Oe[Ue],We=ze[Ue]=ze[Ue]||{},Ye=fe[Ue]=fe[Ue]||[];for(const Be of $e)We[Be.featureIndex]||(We[Be.featureIndex]=!0,Ye.push(Be))}}return fe}(le),S)}function Br(S,l){const m=S.tileID,v=l.tileID;return m.overscaledZ-v.overscaledZ||m.canonical.y-v.canonical.y||m.wrap-v.wrap||m.canonical.x-v.canonical.x}function vr(S,l){const m=S.feature,v=l.getFeatureState(m.layer["source-layer"],m.id);m.source=m.layer.source,m.layer["source-layer"]&&(m.sourceLayer=m.layer["source-layer"]),m.state=v}function Xr(S,l,m){return i._(this,void 0,void 0,function*(){let v=S;if(S.url?v=(yield i.j(l.transformRequest(S.url,"Source"),m)).data:yield b.frameAsync(m),!v)return null;const _=i.S(i.e(v,S),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in v&&v.vector_layers&&(_.vectorLayerIds=v.vector_layers.map(P=>P.id)),_})}class Dr{constructor(l,m){l&&(m?this.setSouthWest(l).setNorthEast(m):Array.isArray(l)&&(l.length===4?this.setSouthWest([l[0],l[1]]).setNorthEast([l[2],l[3]]):this.setSouthWest(l[0]).setNorthEast(l[1])))}setNorthEast(l){return this._ne=l instanceof i.U?new i.U(l.lng,l.lat):i.U.convert(l),this}setSouthWest(l){return this._sw=l instanceof i.U?new i.U(l.lng,l.lat):i.U.convert(l),this}extend(l){const m=this._sw,v=this._ne;let _,P;if(l instanceof i.U)_=l,P=l;else{if(!(l instanceof Dr))return Array.isArray(l)?l.length===4||l.every(Array.isArray)?this.extend(Dr.convert(l)):this.extend(i.U.convert(l)):l&&("lng"in l||"lon"in l)&&"lat"in l?this.extend(i.U.convert(l)):this;if(_=l._sw,P=l._ne,!_||!P)return this}return m||v?(m.lng=Math.min(_.lng,m.lng),m.lat=Math.min(_.lat,m.lat),v.lng=Math.max(P.lng,v.lng),v.lat=Math.max(P.lat,v.lat)):(this._sw=new i.U(_.lng,_.lat),this._ne=new i.U(P.lng,P.lat)),this}getCenter(){return new i.U((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new i.U(this.getWest(),this.getNorth())}getSouthEast(){return new i.U(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(l){const{lng:m,lat:v}=i.U.convert(l);let _=this._sw.lng<=m&&m<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=m&&m>=this._ne.lng),this._sw.lat<=v&&v<=this._ne.lat&&_}intersects(l){if((l=Dr.convert(l)).getNorth()<this.getSouth()||l.getSouth()>this.getNorth())return!1;const m=i.V(this.getWest(),-180,180),v=i.V(this.getEast(),-180,180),_=i.V(l.getWest(),-180,180),P=i.V(l.getEast(),-180,180),I=m>v,z=_>P;return!(!I||!z)||(I?P>=m||_<=v:z?v>=_||m<=P:!(_>v||P<m))}static convert(l){return l instanceof Dr?l:l&&new Dr(l)}static fromLngLat(l,m=0){const v=360*m/40075017,_=v/Math.cos(Math.PI/180*l.lat);return new Dr(new i.U(l.lng-_,l.lat-v),new i.U(l.lng+_,l.lat+v))}adjustAntiMeridian(){const l=new i.U(this._sw.lng,this._sw.lat),m=new i.U(this._ne.lng,this._ne.lat);return new Dr(l,l.lng>m.lng?new i.U(m.lng+360,m.lat):m)}}class As{constructor(l,m,v){this.bounds=Dr.convert(this.validateBounds(l)),this.minzoom=m||0,this.maxzoom=v||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const m=Math.pow(2,l.z),v=Math.floor(i.X(this.bounds.getWest())*m),_=Math.floor(i.W(this.bounds.getNorth())*m),P=Math.ceil(i.X(this.bounds.getEast())*m),I=Math.ceil(i.W(this.bounds.getSouth())*m);return l.x>=v&&l.x<P&&l.y>=_&&l.y<I}}class xn extends i.E{constructor(l,m,v,_){if(super(),this.id=l,this.dispatcher=v,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.e(this,i.S(m,["url","scheme","tileSize","promoteId"])),this._options=i.e({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}load(){return i._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new i.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const l=yield Xr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),l&&(i.e(this,l),l.bounds&&(this.tileBounds=new As(l.bounds,this.minzoom,this.maxzoom)),this.fire(new i.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.l("data",{dataType:"source",sourceDataType:"content"})))}catch(l){this._tileJSONRequest=null,this._loaded=!0,this.fire(new i.k(l))}})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.abort(),l(),this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return i.e({},this._options)}loadTile(l){return i._(this,void 0,void 0,function*(){const m=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),v={request:this.map._requestManager.transformRequest(m,"Tile"),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};v.request.collectResourceTiming=this._collectResourceTiming;let _="RT";if(l.actor&&l.state!=="expired"){if(l.state==="loading")return new Promise((P,I)=>{l.reloadPromise={resolve:P,reject:I}})}else l.actor=this.dispatcher.getActor(),_="LT";l.abortController=new AbortController;try{const P=yield l.actor.sendAsync({type:_,data:v},l.abortController);if(delete l.abortController,l.aborted)return;this._afterTileLoadWorkerResponse(l,P)}catch(P){if(delete l.abortController,l.aborted)return;if(P&&P.status!==404)throw P;this._afterTileLoadWorkerResponse(l,null)}})}_afterTileLoadWorkerResponse(l,m){if(m&&m.resourceTiming&&(l.resourceTiming=m.resourceTiming),m&&this.map._refreshExpiredTiles&&l.setExpiryData(m),l.loadVectorData(m,this.map.painter),l.reloadPromise){const v=l.reloadPromise;l.reloadPromise=null,this.loadTile(l).then(v.resolve).catch(v.reject)}}abortTile(l){return i._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.actor&&(yield l.actor.sendAsync({type:"AT",data:{uid:l.uid,type:this.type,source:this.id}}))})}unloadTile(l){return i._(this,void 0,void 0,function*(){l.unloadVectorData(),l.actor&&(yield l.actor.sendAsync({type:"RMT",data:{uid:l.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Qs extends i.E{constructor(l,m,v,_){super(),this.id=l,this.dispatcher=v,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.e({type:"raster"},m),i.e(this,i.S(m,["url","scheme","tileSize"]))}load(){return i._(this,arguments,void 0,function*(l=!1){this._loaded=!1,this.fire(new i.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const m=yield Xr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,m&&(i.e(this,m),m.bounds&&(this.tileBounds=new As(m.bounds,this.minzoom,this.maxzoom)),this.fire(new i.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:l})))}catch(m){this._tileJSONRequest=null,this._loaded=!0,this.fire(new i.k(m))}})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(l){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),l(),this.load(!0)}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}serialize(){return i.e({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l){return i._(this,void 0,void 0,function*(){const m=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);l.abortController=new AbortController;try{const v=yield B.getImage(this.map._requestManager.transformRequest(m,"Tile"),l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(v&&v.data){this.map._refreshExpiredTiles&&(v.cacheControl||v.expires)&&l.setExpiryData({cacheControl:v.cacheControl,expires:v.expires});const _=this.map.painter.context,P=_.gl,I=v.data;l.texture=this.map.painter.getTileTexture(I.width),l.texture?l.texture.update(I,{useMipmap:!0}):(l.texture=new i.T(_,I,P.RGBA,{useMipmap:!0}),l.texture.bind(P.LINEAR,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST)),l.state="loaded"}}catch(v){if(delete l.abortController,l.aborted)l.state="unloaded";else if(v)throw l.state="errored",v}})}abortTile(l){return i._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController)})}unloadTile(l){return i._(this,void 0,void 0,function*(){l.texture&&this.map.painter.saveTileTexture(l.texture)})}hasTransition(){return!1}}class De extends Qs{constructor(l,m,v,_){super(l,m,v,_),this.type="raster-dem",this.maxzoom=22,this._options=i.e({type:"raster-dem"},m),this.encoding=m.encoding||"mapbox",this.redFactor=m.redFactor,this.greenFactor=m.greenFactor,this.blueFactor=m.blueFactor,this.baseShift=m.baseShift}loadTile(l){return i._(this,void 0,void 0,function*(){const m=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),v=this.map._requestManager.transformRequest(m,"Tile");l.neighboringTiles=this._getNeighboringTiles(l.tileID),l.abortController=new AbortController;try{const _=yield B.getImage(v,l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(_&&_.data){const P=_.data;this.map._refreshExpiredTiles&&(_.cacheControl||_.expires)&&l.setExpiryData({cacheControl:_.cacheControl,expires:_.expires});const I=i.b(P)&&i.Y()?P:yield this.readImageNow(P),z={type:this.type,uid:l.uid,source:this.id,rawImageData:I,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!l.actor||l.state==="expired"){l.actor=this.dispatcher.getActor();const q=yield l.actor.sendAsync({type:"LDT",data:z});l.dem=q,l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0,l.state="loaded"}}}catch(_){if(delete l.abortController,l.aborted)l.state="unloaded";else if(_)throw l.state="errored",_}})}readImageNow(l){return i._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&i.Z()){const m=l.width+2,v=l.height+2;try{return new i.R({width:m,height:v},yield i.$(l,-1,-1,m,v))}catch{}}return b.getImageData(l,1)})}_getNeighboringTiles(l){const m=l.canonical,v=Math.pow(2,m.z),_=(m.x-1+v)%v,P=m.x===0?l.wrap-1:l.wrap,I=(m.x+1+v)%v,z=m.x+1===v?l.wrap+1:l.wrap,q={};return q[new i.a0(l.overscaledZ,P,m.z,_,m.y).key]={backfilled:!1},q[new i.a0(l.overscaledZ,z,m.z,I,m.y).key]={backfilled:!1},m.y>0&&(q[new i.a0(l.overscaledZ,P,m.z,_,m.y-1).key]={backfilled:!1},q[new i.a0(l.overscaledZ,l.wrap,m.z,m.x,m.y-1).key]={backfilled:!1},q[new i.a0(l.overscaledZ,z,m.z,I,m.y-1).key]={backfilled:!1}),m.y+1<v&&(q[new i.a0(l.overscaledZ,P,m.z,_,m.y+1).key]={backfilled:!1},q[new i.a0(l.overscaledZ,l.wrap,m.z,m.x,m.y+1).key]={backfilled:!1},q[new i.a0(l.overscaledZ,z,m.z,I,m.y+1).key]={backfilled:!1}),q}unloadTile(l){return i._(this,void 0,void 0,function*(){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&(yield l.actor.sendAsync({type:"RDT",data:{type:this.type,uid:l.uid,source:this.id}}))})}}function Je(S){return S.type==="GeometryCollection"?S.geometries.map(l=>l.coordinates).flat(1/0):S.coordinates.flat(1/0)}function lt(S){const l=new Dr;let m;switch(S.type){case"FeatureCollection":m=S.features.map(v=>Je(v.geometry)).flat(1/0);break;case"Feature":m=Je(S.geometry);break;default:m=Je(S)}if(m.length==0)return l;for(let v=0;v<m.length-1;v+=2)l.extend([m[v],m[v+1]]);return l}class qt extends i.E{constructor(l,m,v,_){super(),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:m.data},this.actor=v.getActor(),this.setEventedParent(_),this._data=m.data,this._options=i.e({},m),this._collectResourceTiming=m.collectResourceTiming,m.maxzoom!==void 0&&(this.maxzoom=m.maxzoom),m.type&&(this.type=m.type),m.attribution&&(this.attribution=m.attribution),this.promoteId=m.promoteId,m.clusterMaxZoom!==void 0&&this.maxzoom<=m.clusterMaxZoom&&i.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${m.clusterMaxZoom}".`),this.workerOptions=i.e({source:this.id,cluster:m.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(m.buffer!==void 0?m.buffer:128),tolerance:this._pixelsToTileUnits(m.tolerance!==void 0?m.tolerance:.375),extent:i.a3,maxZoom:this.maxzoom,lineMetrics:m.lineMetrics||!1,generateId:m.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(m.clusterMaxZoom),minPoints:Math.max(2,m.clusterMinPoints||2),extent:i.a3,radius:this._pixelsToTileUnits(m.clusterRadius||50),log:!1,generateId:m.generateId||!1},clusterProperties:m.clusterProperties,filter:m.filter},m.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(l){return l*(i.a3/this.tileSize)}_getClusterMaxZoom(l){const m=l?Math.round(l):this.maxzoom-1;return Number.isInteger(l)||l===void 0||i.w(`Integer expected for option 'clusterMaxZoom': provided value "${l}" rounded to "${m}"`),m}load(){return i._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(l){this.map=l,this.load()}setData(l){return this._data=l,this._pendingWorkerUpdate={data:l},this._updateWorkerData(),this}updateData(l){return this._pendingWorkerUpdate.diff=i.a4(this._pendingWorkerUpdate.diff,l),this._updateWorkerData(),this}getData(){return i._(this,void 0,void 0,function*(){const l=i.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:l})})}getBounds(){return i._(this,void 0,void 0,function*(){return lt(yield this.getData())})}setClusterOptions(l){return this.workerOptions.cluster=l.cluster,l.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(l.clusterRadius)),l.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(l.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(l){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:l,source:this.id}})}getClusterChildren(l){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:l,source:this.id}})}getClusterLeaves(l,m,v){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:l,limit:m,offset:v}})}_updateWorkerData(){return i._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void i.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:l,diff:m}=this._pendingWorkerUpdate,v=i.e({type:this.type},this.workerOptions);l?(typeof l=="string"?(v.request=this.map._requestManager.transformRequest(b.resolveURL(l),"Source"),v.request.collectResourceTiming=this._collectResourceTiming):v.data=JSON.stringify(l),this._pendingWorkerUpdate.data=void 0):m&&(v.dataDiff=m,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new i.l("dataloading",{dataType:"source"}));try{const _=yield this.actor.sendAsync({type:"LD",data:v});if(this._isUpdatingWorker=!1,this._removed||_.abandoned)return void this.fire(new i.l("dataabort",{dataType:"source"}));this._data=_.data;let P=null;_.resourceTiming&&_.resourceTiming[this.id]&&(P=_.resourceTiming[this.id].slice(0));const I={dataType:"source"};this._collectResourceTiming&&P&&P.length>0&&i.e(I,{resourceTiming:P}),this.fire(new i.l("data",Object.assign(Object.assign({},I),{sourceDataType:"metadata"}))),this.fire(new i.l("data",Object.assign(Object.assign({},I),{sourceDataType:"content",shouldReloadTileOptions:this._getShouldReloadTileOptions(m)})))}catch(_){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new i.l("dataabort",{dataType:"source"}));this.fire(new i.k(_))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}})}_getShouldReloadTileOptions(l){if(!l||l.removeAll)return;const{add:m=[],update:v=[],remove:_=[]}=l||{},P=new Set([...v.map(I=>I.id),..._]);return{nextBounds:[...v.map(I=>I.newGeometry),...m.map(I=>I.geometry)].map(I=>lt(I)),prevIds:P}}shouldReloadTile(l,{nextBounds:m,prevIds:v}){const _=l.latestFeatureIndex.loadVTLayers();for(let q=0;q<l.latestFeatureIndex.featureIndexArray.length;q++){const G=l.latestFeatureIndex.featureIndexArray.get(q),Y=_._geojsonTileLayer.feature(G.featureIndex);if(v.has(Y.id))return!0}const{buffer:P,extent:I}=this.workerOptions.geojsonVtOptions,z=function({x:q,y:G,z:Y},le=0){const ie=i.a1((q-le)/Math.pow(2,Y)),fe=i.a2((G+1+le)/Math.pow(2,Y)),_e=i.a1((q+1+le)/Math.pow(2,Y)),Ee=i.a2((G-le)/Math.pow(2,Y));return new Dr([ie,fe],[_e,Ee])}(l.tileID.canonical,P/I);for(const q of m)if(z.intersects(q))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(l){return i._(this,void 0,void 0,function*(){const m=l.actor?"RT":"LT";l.actor=this.actor;const v={type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};l.abortController=new AbortController;const _=yield this.actor.sendAsync({type:m,data:v},l.abortController);delete l.abortController,l.unloadVectorData(),l.aborted||l.loadVectorData(_,this.map.painter,m==="RT")})}abortTile(l){return i._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.aborted=!0})}unloadTile(l){return i._(this,void 0,void 0,function*(){l.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:l.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return i.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class It extends i.E{constructor(l,m,v,_){super(),this.flippedWindingOrder=!1,this.id=l,this.dispatcher=v,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=m}load(l){return i._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new i.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const m=yield B.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,m&&m.data&&(this.image=m.data,l&&(this.coordinates=l),this._finishLoading())}catch(m){this._request=null,this._loaded=!0,this.fire(new i.k(m))}})}loaded(){return this._loaded}updateImage(l){return l.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=l.url,this.load(l.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new i.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(l){this.coordinates=l;const m=l.map(i.a5.fromLngLat);var v;return this.tileID=function(_){const P=i.a6.fromPoints(_),I=P.width(),z=P.height(),q=Math.max(I,z),G=Math.max(0,Math.floor(-Math.log(q)/Math.LN2)),Y=Math.pow(2,G);return new i.a8(G,Math.floor((P.minX+P.maxX)/2*Y),Math.floor((P.minY+P.maxY)/2*Y))}(m),this.terrainTileRanges=this._getOverlappingTileRanges(m),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=m.map(_=>this.tileID.getTilePoint(_)._round()),this.flippedWindingOrder=((v=this.tileCoords)[1].x-v[0].x)*(v[2].y-v[0].y)-(v[1].y-v[0].y)*(v[2].x-v[0].x)<0,this.fire(new i.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const l=this.map.painter.context,m=l.gl;this.texture||(this.texture=new i.T(l,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE));let v=!1;for(const _ in this.tiles){const P=this.tiles[_];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture,v=!0)}v&&this.fire(new i.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(l){return i._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={}):l.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(l){const{minX:m,minY:v,maxX:_,maxY:P}=i.a6.fromPoints(l),I={};for(let z=0;z<=i.a7;z++){const q=Math.pow(2,z),G=Math.floor(m*q),Y=Math.floor(v*q),le=Math.floor(_*q),ie=Math.floor(P*q);I[z]={minTileX:G,minTileY:Y,maxTileX:le,maxTileY:ie}}return I}}class Bt extends It{constructor(l,m,v,_){super(l,m,v,_),this.roundZoom=!0,this.type="video",this.options=m}load(){return i._(this,void 0,void 0,function*(){this._loaded=!1;const l=this.options;this.urls=[];for(const m of l.urls)this.urls.push(this.map._requestManager.transformRequest(m,"Source").url);try{const m=yield i.a9(this.urls);if(this._loaded=!0,!m)return;this.video=m,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(m){this.fire(new i.k(m))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){const m=this.video.seekable;l<m.start(0)||l>m.end(0)?this.fire(new i.k(new i.aa(`sources.${this.id}`,null,`Playback for this video can be set only between the ${m.start(0)} and ${m.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const l=this.map.painter.context,m=l.gl;this.texture?this.video.paused||(this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE),m.texSubImage2D(m.TEXTURE_2D,0,0,0,m.RGBA,m.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(l,this.video,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE));let v=!1;for(const _ in this.tiles){const P=this.tiles[_];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture,v=!0)}v&&this.fire(new i.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class er extends It{constructor(l,m,v,_){super(l,m,v,_),m.coordinates?Array.isArray(m.coordinates)&&m.coordinates.length===4&&!m.coordinates.some(P=>!Array.isArray(P)||P.length!==2||P.some(I=>typeof I!="number"))||this.fire(new i.k(new i.aa(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.k(new i.aa(`sources.${l}`,null,'missing required property "coordinates"'))),m.animate&&typeof m.animate!="boolean"&&this.fire(new i.k(new i.aa(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),m.canvas?typeof m.canvas=="string"||m.canvas instanceof HTMLCanvasElement||this.fire(new i.k(new i.aa(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.k(new i.aa(`sources.${l}`,null,'missing required property "canvas"'))),this.options=m,this.animate=m.animate===void 0||m.animate}load(){return i._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const m=this.map.painter.context,v=m.gl;this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(m,this.canvas,v.RGBA,{premultiply:!0});let _=!1;for(const P in this.tiles){const I=this.tiles[P];I.state!=="loaded"&&(I.state="loaded",I.texture=this.texture,_=!0)}_&&this.fire(new i.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}}const Qr={},Ss=S=>{switch(S){case"geojson":return qt;case"image":return It;case"raster":return Qs;case"raster-dem":return De;case"vector":return xn;case"video":return Bt;case"canvas":return er}return Qr[S]},Tn="RTLPluginLoaded";class Xe extends i.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Ht()}_syncState(l){return this.status=l,this.dispatcher.broadcast("SRPS",{pluginStatus:l,pluginURL:this.url}).catch(m=>{throw this.status="error",m})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(l){return i._(this,arguments,void 0,function*(m,v=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=b.resolveURL(m),!this.url)throw new Error(`requested url ${m} is invalid`);if(this.status==="unavailable"){if(!v)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return i._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new i.l(Tn))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let ye=null;function ve(){return ye||(ye=new Xe),ye}var ke,Fe;(function(S){S[S.Base=0]="Base",S[S.Parent=1]="Parent"})(ke||(ke={})),function(S){S[S.Departing=0]="Departing",S[S.Incoming=1]="Incoming"}(Fe||(Fe={}));class Ge{constructor(l,m){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=l,this.uid=i.ab(),this.uses=0,this.tileSize=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(l){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(l||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:l,fadingDirection:m,fadingParentID:v,fadeEndTime:_}){this.resetFadeLogic(),this.fadingRole=l,this.fadingDirection=m,this.fadingParentID=v,this.fadeEndTime=_}setSelfFadeLogic(l){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=l}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=T(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(l){this.demTexture&&l.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(l,m,v){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=function(_,P){const I={};if(!P)return I;for(const z of _){const q=z.layerIds.map(G=>P.getLayer(G)).filter(Boolean);if(q.length!==0){z.layers=q,z.stateDependentLayerIds&&(z.stateDependentLayers=z.stateDependentLayerIds.map(G=>q.filter(Y=>Y.id===G)[0]));for(const G of q)I[G.id]=z}}return I}(l.buckets,m==null?void 0:m.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const P=this.buckets[_];if(P instanceof i.ad){if(this.hasSymbolBuckets=!0,!v)break;P.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const P=this.buckets[_];if(P instanceof i.ad&&P.hasRTLText){this.hasRTLText=!0,ve().lazyLoad();break}}this.queryPadding=0;for(const _ in this.buckets){const P=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,m.style.getLayer(_).queryRadius(P))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage),this.dashPositions=l.dashPositions}else this.collisionBoxArray=new i.ac}unloadVectorData(){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(l){return this.buckets[l.id]}upload(l){for(const v in this.buckets){const _=this.buckets[v];_.uploadPending()&&_.upload(l)}const m=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new i.T(l,this.imageAtlas.image,m.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(l,this.glyphAtlasImage,m.ALPHA),this.glyphAtlasImage=null)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,m,v,_,P,I,z,q,G,Y,le){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:P,scale:I,tileSize:this.tileSize,pixelPosMatrix:Y,transform:q,params:z,queryPadding:this.queryPadding*G,getElevation:le},l,m,v):{}}querySourceFeatures(l,m){const v=this.latestFeatureIndex;if(!v||!v.rawTileData)return;const _=v.loadVTLayers(),P=m&&m.sourceLayer?m.sourceLayer:"",I=_._geojsonTileLayer||_[P];if(!I)return;const z=i.ae(m==null?void 0:m.filter,m==null?void 0:m.globalState),{z:q,x:G,y:Y}=this.tileID.canonical,le={z:q,x:G,y:Y};for(let ie=0;ie<I.length;ie++){const fe=I.feature(ie);if(z.needGeometry){const Oe=i.af(fe,!0);if(!z.filter(new i.G(this.tileID.overscaledZ),Oe,this.tileID.canonical))continue}else if(!z.filter(new i.G(this.tileID.overscaledZ),fe))continue;const _e=v.getId(fe,P),Ee=new i.ag(fe,q,G,Y,_e);Ee.tile=le,l.push(Ee)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){const m=this.expirationTime;if(l.cacheControl){const v=i.ah(l.cacheControl);v["max-age"]&&(this.expirationTime=Date.now()+1e3*v["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){const v=Date.now();let _=!1;if(this.expirationTime>v)_=!1;else if(m)if(this.expirationTime<m)_=!0;else{const P=this.expirationTime-m;P?this.expirationTime=v+Math.max(P,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,m){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0)return;const v=this.latestFeatureIndex.loadVTLayers();for(const _ in this.buckets){if(!m.style.hasLayer(_))continue;const P=this.buckets[_],I=P.layers[0].sourceLayer||"_geojsonTileLayer",z=v[I],q=l[I];if(!z||!q||Object.keys(q).length===0)continue;P.update(q,z,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const G=m&&m.style&&m.style.getLayer(_);G&&(this.queryPadding=Math.max(this.queryPadding,G.queryRadius(P)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<T()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(l){this.symbolFadeHoldUntil=T()+l}setDependencies(l,m){const v={};for(const _ of m)v[_]=!0;this.dependencies[l]=v}hasDependency(l,m){for(const v of l){const _=this.dependencies[v];if(_){for(const P of m)if(_[P])return!0}}return!1}}class nt{constructor(l,m){this.max=l,this.onRemove=m,this.reset()}reset(){for(const l in this.data)for(const m of this.data[l])m.timeout&&clearTimeout(m.timeout),this.onRemove(m.value);return this.data={},this.order=[],this}add(l,m,v){const _=l.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);const P={value:m,timeout:void 0};if(v!==void 0&&(P.timeout=setTimeout(()=>{this.remove(l,P)},v)),this.data[_].push(P),this.order.push(_),this.order.length>this.max){const I=this._getAndRemoveByKey(this.order[0]);I&&this.onRemove(I)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){const m=this.data[l].shift();return m.timeout&&clearTimeout(m.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),m.value}getByKey(l){const m=this.data[l];return m?m[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,m){if(!this.has(l))return this;const v=l.wrapped().key,_=m===void 0?0:this.data[v].indexOf(m),P=this.data[v][_];return this.data[v].splice(_,1),P.timeout&&clearTimeout(P.timeout),this.data[v].length===0&&delete this.data[v],this.onRemove(P.value),this.order.splice(this.order.indexOf(v),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){const m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}filter(l){const m=[];for(const v in this.data)for(const _ of this.data[v])l(_.value)||m.push(_);for(const v of m)this.remove(v.value.tileID,v)}}class dt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,m,v){const _=String(m);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][_]=this.stateChanges[l][_]||{},i.e(this.stateChanges[l][_],v),this.deletedStates[l]===null){this.deletedStates[l]={};for(const P in this.state[l])P!==_&&(this.deletedStates[l][P]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][_]===null){this.deletedStates[l][_]={};for(const P in this.state[l][_])v[P]||(this.deletedStates[l][_][P]=null)}else for(const P in v)this.deletedStates[l]&&this.deletedStates[l][_]&&this.deletedStates[l][_][P]===null&&delete this.deletedStates[l][_][P]}removeFeatureState(l,m,v){if(this.deletedStates[l]===null)return;const _=String(m);if(this.deletedStates[l]=this.deletedStates[l]||{},v&&m!==void 0)this.deletedStates[l][_]!==null&&(this.deletedStates[l][_]=this.deletedStates[l][_]||{},this.deletedStates[l][_][v]=null);else if(m!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][_])for(v in this.deletedStates[l][_]={},this.stateChanges[l][_])this.deletedStates[l][_][v]=null;else this.deletedStates[l][_]=null;else this.deletedStates[l]=null}getState(l,m){const v=String(m),_=i.e({},(this.state[l]||{})[v],(this.stateChanges[l]||{})[v]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){const P=this.deletedStates[l][m];if(P===null)return{};for(const I in P)delete _[I]}return _}initializeTileState(l,m){l.setFeatureState(this.state,m)}coalesceChanges(l,m){const v={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const P={};for(const I in this.stateChanges[_])this.state[_][I]||(this.state[_][I]={}),i.e(this.state[_][I],this.stateChanges[_][I]),P[I]=this.state[_][I];v[_]=P}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const P={};if(this.deletedStates[_]===null)for(const I in this.state[_])P[I]={},this.state[_][I]={};else for(const I in this.deletedStates[_]){if(this.deletedStates[_][I]===null)this.state[_][I]={};else for(const z of Object.keys(this.deletedStates[_][I]))delete this.state[_][I][z];P[I]=this.state[_][I]}v[_]=v[_]||{},i.e(v[_],P)}if(this.stateChanges={},this.deletedStates={},Object.keys(v).length!==0)for(const _ in l)l[_].setFeatureState(v,m)}}const rt=89.25;function ft(S,l){const m=i.ai(l.lat,-i.aj,i.aj);return new i.P(i.X(l.lng)*S,i.W(m)*S)}function $t(S,l){return new i.a5(l.x/S,l.y/S).toLngLat()}function Pt(S){return S.cameraToCenterDistance*Math.min(.85*Math.tan(i.ak(90-S.pitch)),Math.tan(i.ak(rt-S.pitch)))}function br(S,l){const m=S.canonical,v=l/i.al(m.z),_=m.x+Math.pow(2,m.z)*S.wrap,P=i.am(new Float64Array(16));return i.N(P,P,[_*v,m.y*v,0]),i.O(P,P,[v/i.a3,v/i.a3,1]),P}function ot(S,l,m,v,_){const P=i.a5.fromLngLat(S,l),I=_*i.an(1,S.lat),z=I*Math.cos(i.ak(m)),q=Math.sqrt(I*I-z*z),G=q*Math.sin(i.ak(-v)),Y=q*Math.cos(i.ak(-v));return new i.a5(P.x+G,P.y+Y,P.z+z)}function is(S,l,m){const v=l.intersectsFrustum(S);if(!m||v===0)return v;const _=l.intersectsPlane(m);return _===0?0:v===2&&_===2?2:1}function wr(S,l,m){let v=0;const _=(m-l)/10;for(let P=0;P<10;P++)v+=_*Math.pow(Math.cos(l+(P+.5)/10*(m-l)),S);return v}function tr(S,l){return function(m,v,_,P,I){const z=2*((S-1)/i.ao(Math.cos(i.ak(rt-I))/Math.cos(i.ak(rt)))-1),q=Math.acos(_/P),G=2*wr(z-1,0,i.ak(I/2)),Y=Math.min(i.ak(rt),q+i.ak(I/2)),le=wr(z-1,Math.min(Y,q-i.ak(I/2)),Y),ie=Math.atan(v/_),fe=Math.hypot(v,_);let _e=m;return _e+=i.ao(P/fe/Math.max(.5,Math.cos(i.ak(I/2)))),_e+=z*i.ao(Math.cos(ie))/2,_e-=i.ao(Math.max(1,le/G/l))/2,_e}}const Cr=tr(9.314,3);function fs(S,l){const m=(l.roundZoom?Math.round:Math.floor)(S.zoom+i.ao(S.tileSize/l.tileSize));return Math.max(0,m)}function Os(S,l){const m=S.getCameraFrustum(),v=S.getClippingPlane(),_=S.screenPointToMercatorCoordinate(S.getCameraPoint()),P=i.a5.fromLngLat(S.center,S.elevation);_.z=P.z+Math.cos(S.pitchInRadians)*S.cameraToCenterDistance/S.worldSize;const I=S.getCoveringTilesDetailsProvider(),z=I.allowVariableZoom(S,l),q=fs(S,l),G=l.minzoom||0,Y=l.maxzoom!==void 0?l.maxzoom:S.maxZoom,le=Math.min(Math.max(0,q),Y),ie=Math.pow(2,le),fe=[ie*_.x,ie*_.y,0],_e=[ie*P.x,ie*P.y,0],Ee=Math.hypot(P.x-_.x,P.y-_.y),Oe=Math.abs(P.z-_.z),Re=Math.hypot(Ee,Oe),ze=We=>({zoom:0,x:0,y:0,wrap:We,fullyVisible:!1}),Ue=[],$e=[];if(S.renderWorldCopies&&I.allowWorldCopies())for(let We=1;We<=3;We++)Ue.push(ze(-We)),Ue.push(ze(We));for(Ue.push(ze(0));Ue.length>0;){const We=Ue.pop(),Ye=We.x,Be=We.y;let et=We.fullyVisible;const pt={x:Ye,y:Be,z:We.zoom},ut=I.getTileBoundingVolume(pt,We.wrap,S.elevation,l);if(!et){const Wt=is(m,ut,v);if(Wt===0)continue;et=Wt===2}const mt=I.distanceToTile2d(_.x,_.y,pt,ut);let xt=q;z&&(xt=(l.calculateTileZoom||Cr)(S.zoom+i.ao(S.tileSize/l.tileSize),mt,Oe,Re,S.fov)),xt=(l.roundZoom?Math.round:Math.floor)(xt),xt=Math.max(0,xt);const Ut=Math.min(xt,Y);if(We.wrap=I.getWrap(P,pt,We.wrap),We.zoom>=Ut){if(We.zoom<G)continue;const Wt=le-We.zoom,Dt=fe[0]-.5-(Ye<<Wt),jr=fe[1]-.5-(Be<<Wt),Hr=l.reparseOverscaled?Math.max(We.zoom,xt):We.zoom;$e.push({tileID:new i.a0(We.zoom===Y?Hr:We.zoom,We.wrap,We.zoom,Ye,Be),distanceSq:i.ap([_e[0]-.5-Ye,_e[1]-.5-Be]),tileDistanceToCamera:Math.sqrt(Dt*Dt+jr*jr)})}else for(let Wt=0;Wt<4;Wt++)Ue.push({zoom:We.zoom+1,x:(Ye<<1)+Wt%2,y:(Be<<1)+(Wt>>1),wrap:We.wrap,fullyVisible:et})}return $e.sort((We,Ye)=>We.distanceSq-Ye.distanceSq).map(We=>We.tileID)}const dn=i.a6.fromPoints([new i.P(0,0),new i.P(i.a3,i.a3)]);class Bs extends i.E{constructor(l,m,v){super(),this.id=l,this.dispatcher=v,this.on("data",_=>this._dataHandler(_)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((_,P,I,z)=>{const q=new(Ss(P.type))(_,P,I,z);if(q.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${q.id}`);return q})(l,m,v,this),this._tiles={},this._cache=new nt(0,_=>this._unloadTile(_)),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new dt,this._didEmitContent=!1,this._updated=!1}onAdd(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._maxTileCacheZoomLevels=l?l._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(l)}onRemove(l){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(l)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const l in this._tiles){const m=this._tiles[l];if(m.state!=="loaded"&&m.state!=="errored")return!1}return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(l,m,v){return i._(this,void 0,void 0,function*(){try{yield this._source.loadTile(l),this._tileLoaded(l,m,v)}catch(_){l.state="errored",_.status!==404?this._source.fire(new i.k(_,{tile:l})):this.update(this.transform,this.terrain)}})}_unloadTile(l){this._source.unloadTile&&this._source.unloadTile(l)}_abortTile(l){this._source.abortTile&&this._source.abortTile(l),this._source.fire(new i.l("dataabort",{tile:l,coord:l.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const m in this._tiles){const v=this._tiles[m];v.upload(l),v.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(l=>l.tileID).sort(qs).map(l=>l.key)}getRenderableIds(l){const m=[];for(const v in this._tiles)this._isIdRenderable(v,l)&&m.push(this._tiles[v]);return l?m.sort((v,_)=>{const P=v.tileID,I=_.tileID,z=new i.P(P.canonical.x,P.canonical.y)._rotate(-this.transform.bearingInRadians),q=new i.P(I.canonical.x,I.canonical.y)._rotate(-this.transform.bearingInRadians);return P.overscaledZ-I.overscaledZ||q.y-z.y||q.x-z.x}).map(v=>v.tileID.key):m.map(v=>v.tileID).sort(qs).map(v=>v.key)}hasRenderableParent(l){const m=l.overscaledZ-1;if(m>=this._source.minzoom){const v=this.getLoadedTile(l.scaledTo(m));if(v)return this._isIdRenderable(v.tileID.key)}return!1}_isIdRenderable(l,m=!1){var v;return(v=this._tiles[l])===null||v===void 0?void 0:v.isRenderable(m)}reload(l,m=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const v in this._tiles)m&&this._source.shouldReloadTile&&!this._source.shouldReloadTile(this._tiles[v],m)||(l?this._reloadTile(v,"expired"):this._tiles[v].state!=="errored"&&this._reloadTile(v,"reloading"))}}_reloadTile(l,m){return i._(this,void 0,void 0,function*(){const v=this._tiles[l];v&&(v.state!=="loading"&&(v.state=m),yield this._loadTile(v,l,m))})}_tileLoaded(l,m,v){l.timeAdded=T(),l.selfFading&&(l.fadeEndTime=l.timeAdded+this._rasterFadeDuration),v==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(m,l),this.getSource().type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),l.aborted||this._source.fire(new i.l("data",{dataType:"source",tile:l,coord:l.tileID}))}_backfillDEM(l){const m=this.getRenderableIds();for(let _=0;_<m.length;_++){const P=m[_];if(l.neighboringTiles&&l.neighboringTiles[P]){const I=this.getTileByID(P);v(l,I),v(I,l)}}function v(_,P){_.needsHillshadePrepare=!0,_.needsTerrainPrepare=!0;let I=P.tileID.canonical.x-_.tileID.canonical.x;const z=P.tileID.canonical.y-_.tileID.canonical.y,q=Math.pow(2,_.tileID.canonical.z),G=P.tileID.key;I===0&&z===0||Math.abs(z)>1||(Math.abs(I)>1&&(Math.abs(I+q)===1?I+=q:Math.abs(I-q)===1&&(I-=q)),P.dem&&_.dem&&(_.dem.backfillBorder(P.dem,I,z),_.neighboringTiles&&_.neighboringTiles[G]&&(_.neighboringTiles[G].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,m){const v=Object.values(l),_=this._getLoadedDescendents(v),P={};for(const I of v){const z=_[I.key];if(!(z!=null&&z.length)){P[I.key]=I;continue}const q=I.overscaledZ+Bs.maxUnderzooming,G=z.filter(ie=>ie.tileID.overscaledZ<=q);if(!G.length){P[I.key]=I;continue}const Y=Math.min(...G.map(ie=>ie.tileID.overscaledZ)),le=G.filter(ie=>ie.tileID.overscaledZ===Y).map(ie=>ie.tileID);for(const ie of le)m[ie.key]=ie;this._areDescendentsComplete(le,Y,I.overscaledZ)||(P[I.key]=I)}return P}_getLoadedDescendents(l){var m;const v={};for(const _ in this._tiles){const P=this._tiles[_];if(P.hasData())for(const I of l)P.tileID.isChildOf(I)&&(v[m=I.key]||(v[m]=[])).push(P)}return v}_areDescendentsComplete(l,m,v){return l.length===1&&l[0].isOverscaled()?l[0].overscaledZ===m:Math.pow(4,m-v)===l.length}getLoadedTile(l){const m=this._tiles[l.key];return m!=null&&m.hasData()?m:null}updateCacheSize(l){const m=Math.ceil(l.width/this._source.tileSize)+1,v=Math.ceil(l.height/this._source.tileSize)+1,_=Math.floor(m*v*(this._maxTileCacheZoomLevels===null?i.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),P=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(P)}handleWrapJump(l){const m=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,m){const v={};for(const _ in this._tiles){const P=this._tiles[_];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+m),v[P.tileID.key]=P}this._tiles=v,this._resetTileReloadTimers()}}update(l,m){if(!this._sourceLoaded||this._paused)return;let v;this.transform=l,this.terrain=m,this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?v=l.getVisibleUnwrappedCoordinates(this._source.tileID).map(q=>new i.a0(q.canonical.z,q.wrap,q.canonical.z,q.canonical.x,q.canonical.y)):(v=Os(l,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:m,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(v=v.filter(q=>this._source.hasTile(q)))):v=[],this.usedForTerrain&&(v=this._addTerrainIdealTiles(v));const _=v.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,_&&this.fire(new i.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const P=fs(l,this._source),I=this._updateRetainedTiles(v,P),z=Is(this._source.type);z&&this._rasterFadeDuration>0&&!m&&this._updateFadingTiles(v,I),z?this._cleanUpRasterTiles(I):this._cleanUpVectorTiles(I)}_cleanUpRasterTiles(l){for(const m in this._tiles)l[m]||this._removeTile(m)}_cleanUpVectorTiles(l){for(const m in this._tiles){const v=this._tiles[m];l[m]?v.clearSymbolFadeHold():v.hasSymbolBuckets?v.holdingForSymbolFade()?v.symbolFadeFinished()&&this._removeTile(m):v.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(m)}}_addTerrainIdealTiles(l){const m=[];for(const v of l)if(v.canonical.z>this._source.minzoom){const _=v.scaledTo(v.canonical.z-1);m.push(_);const P=v.scaledTo(Math.max(this._source.minzoom,Math.min(v.canonical.z,5)));m.push(P)}return l.concat(m)}releaseSymbolFadeTiles(){for(const l in this._tiles)this._tiles[l].holdingForSymbolFade()&&this._removeTile(l)}_updateRetainedTiles(l,m){var v;const _={},P={},I=Math.max(m-Bs.maxOverzooming,this._source.minzoom);let z={};for(const q of l){const G=this._addTile(q);_[q.key]=q,G.hasData()||(z[q.key]=q)}z=this._retainLoadedChildren(z,_);for(const q in z){const G=z[q];let Y=this._tiles[q],le=Y==null?void 0:Y.wasRequested();for(let ie=G.overscaledZ-1;ie>=I;--ie){const fe=G.scaledTo(ie);if(P[fe.key])break;if(P[fe.key]=!0,Y=this.getTile(fe),!Y&&le&&(Y=this._addTile(fe)),Y){const _e=Y.hasData();if((_e||!(!((v=this.map)===null||v===void 0)&&v.cancelPendingTileRequestsWhileZooming)||le)&&(_[fe.key]=fe),le=Y.wasRequested(),_e)break}}}return _}_updateFadingTiles(l,m){const v=T(),_=i.aq(l);for(const P of l){const I=this._tiles[P.key];I.fadingDirection!==Fe.Departing&&I.fadeOpacity!==0||I.resetFadeLogic(),this._updateFadingAncestor(I,m,v)||this._updateFadingDescendents(I,m,v)||this._updateFadingEdge(I,_,v)||I.resetFadeLogic()}}_updateFadingAncestor(l,m,v){if(!l.hasData())return!1;const{tileID:_,fadingRole:P,fadingDirection:I,fadingParentID:z}=l;if(P===ke.Base&&I===Fe.Incoming&&z)return m[z.key]=z,!0;const q=Math.max(_.overscaledZ-this._maxFadingAncestorLevels,this._source.minzoom);for(let G=_.overscaledZ-1;G>=q;G--){const Y=_.scaledTo(G),le=this.getLoadedTile(Y);if(le)return l.setCrossFadeLogic({fadingRole:ke.Base,fadingDirection:Fe.Incoming,fadingParentID:le.tileID,fadeEndTime:v+this._rasterFadeDuration}),le.setCrossFadeLogic({fadingRole:ke.Parent,fadingDirection:Fe.Departing,fadeEndTime:v+this._rasterFadeDuration}),m[Y.key]=Y,!0}return!1}_updateFadingDescendents(l,m,v){if(!l.hasData())return!1;const _=l.tileID.children(this._source.maxzoom);let P=this._updateFadingChildren(l,_,m,v);if(P)return!0;for(const I of _){const z=I.children(this._source.maxzoom);this._updateFadingChildren(l,z,m,v)&&(P=!0)}return P}_updateFadingChildren(l,m,v,_){if(m[0].overscaledZ>=this._source.maxzoom)return!1;let P=!1;for(const I of m){const z=this.getLoadedTile(I);if(!z)continue;const{fadingRole:q,fadingDirection:G,fadingParentID:Y}=z;q===ke.Base&&G===Fe.Departing&&Y||(z.setCrossFadeLogic({fadingRole:ke.Base,fadingDirection:Fe.Departing,fadingParentID:l.tileID,fadeEndTime:_+this._rasterFadeDuration}),l.setCrossFadeLogic({fadingRole:ke.Parent,fadingDirection:Fe.Incoming,fadeEndTime:_+this._rasterFadeDuration})),v[I.key]=I,P=!0}return P}_updateFadingEdge(l,m,v){const _=l.tileID;return!!l.selfFading||!l.hasData()&&!!m.has(_)&&(l.setSelfFadeLogic(v+this._rasterFadeDuration),!0)}_addTile(l){let m=this._tiles[l.key];if(m)return m;m=this._cache.getAndRemove(l),m&&(m.resetFadeLogic(),this._setTileReloadTimer(l.key,m),m.tileID=l,this._state.initializeTileState(m,this.map?this.map.painter:null));const v=m;return m||(m=new Ge(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(m,l.key,m.state)),m.uses++,this._tiles[l.key]=m,v||this._source.fire(new i.l("dataloading",{tile:m,coord:m.tileID,dataType:"source"})),m}_setTileReloadTimer(l,m){this._clearTileReloadTimer(l);const v=m.getExpiryTimeout();v&&(this._timers[l]=setTimeout(()=>{this._reloadTile(l,"expired"),delete this._timers[l]},v))}_clearTileReloadTimer(l){const m=this._timers[l];m&&(clearTimeout(m),delete this._timers[l])}_resetTileReloadTimers(){for(const l in this._timers)clearTimeout(this._timers[l]),delete this._timers[l];for(const l in this._tiles)this._setTileReloadTimer(l,this._tiles[l])}refreshTiles(l){for(const m in this._tiles)(this._isIdRenderable(m)||this._tiles[m].state=="errored")&&l.some(v=>v.equals(this._tiles[m].tileID.canonical))&&this._reloadTile(m,"expired")}_removeTile(l){const m=this._tiles[l];m&&(m.uses--,delete this._tiles[l],this._clearTileReloadTimer(l),m.uses>0||(m.hasData()&&m.state!=="reloading"?this._cache.add(m.tileID,m,m.getExpiryTimeout()):(m.aborted=!0,this._abortTile(m),this._unloadTile(m))))}_dataHandler(l){l.dataType==="source"&&(l.sourceDataType!=="metadata"?l.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(l.sourceDataChanged,l.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const l in this._tiles)this._removeTile(l);this._cache.reset()}tilesIn(l,m,v){const _=[],P=this.transform;if(!P)return _;const I=P.getCoveringTilesDetailsProvider().allowWorldCopies(),z=v?P.getCameraQueryGeometry(l):l,q=fe=>P.screenPointToMercatorCoordinate(fe,this.terrain),G=this.transformBbox(l,q,!I),Y=this.transformBbox(z,q,!I),le=this.getIds(),ie=i.a6.fromPoints(Y);for(let fe=0;fe<le.length;fe++){const _e=this._tiles[le[fe]];if(_e.holdingForSymbolFade())continue;const Ee=I?[_e.tileID]:[_e.tileID.unwrapTo(-1),_e.tileID.unwrapTo(0)],Oe=Math.pow(2,P.zoom-_e.tileID.overscaledZ),Re=m*_e.queryPadding*i.a3/_e.tileSize/Oe;for(const ze of Ee){const Ue=ie.map($e=>ze.getTilePoint(new i.a5($e.x,$e.y)));if(Ue.expandBy(Re),Ue.intersects(dn)){const $e=G.map(Ye=>ze.getTilePoint(Ye)),We=Y.map(Ye=>ze.getTilePoint(Ye));_.push({tile:_e,tileID:I?ze:ze.unwrapTo(0),queryGeometry:$e,cameraQueryGeometry:We,scale:Oe})}}}return _}transformBbox(l,m,v){let _=l.map(m);if(v){const P=i.a6.fromPoints(l);P.shrinkBy(.001*Math.min(P.width(),P.height()));const I=P.map(m);i.a6.fromPoints(_).covers(I)||(_=_.map(z=>z.x>.5?new i.a5(z.x-1,z.y,z.z):z))}return _}getVisibleCoordinates(l){const m=this.getRenderableIds(l).map(v=>this._tiles[v].tileID);return this.transform&&this.transform.populateCache(m),m}hasTransition(){if(this._source.hasTransition())return!0;if(Is(this._source.type)&&this._rasterFadeDuration>0){const l=T();for(const m in this._tiles)if(this._tiles[m].fadeEndTime>=l)return!0}return!1}setRasterFadeDuration(l){this._rasterFadeDuration=l}setFeatureState(l,m,v){this._state.updateState(l=l||"_geojsonTileLayer",m,v)}removeFeatureState(l,m,v){this._state.removeFeatureState(l=l||"_geojsonTileLayer",m,v)}getFeatureState(l,m){return this._state.getState(l=l||"_geojsonTileLayer",m)}setDependencies(l,m,v){const _=this._tiles[l];_&&_.setDependencies(m,v)}reloadTilesForDependencies(l,m){for(const v in this._tiles)this._tiles[v].hasDependency(l,m)&&this._reloadTile(v,"reloading");this._cache.filter(v=>!v.hasDependency(l,m))}}function qs(S,l){const m=Math.abs(2*S.wrap)-+(S.wrap<0),v=Math.abs(2*l.wrap)-+(l.wrap<0);return S.overscaledZ-l.overscaledZ||v-m||l.canonical.y-S.canonical.y||l.canonical.x-S.canonical.x}function Is(S){return S==="raster"||S==="image"||S==="video"}Bs.maxOverzooming=10,Bs.maxUnderzooming=3;class Na{constructor(l,m){this.reset(l,m)}reset(l,m){this.points=l||[],this._distances=[0];for(let v=1;v<this.points.length;v++)this._distances[v]=this._distances[v-1]+this.points[v].dist(this.points[v-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=i.ai(l,0,1);let m=1,v=this._distances[m];const _=l*this.paddedLength+this.padding;for(;v<_&&m<this._distances.length;)v=this._distances[++m];const P=m-1,I=this._distances[P],z=v-I,q=z>0?(_-I)/z:0;return this.points[P].mult(1-q).add(this.points[m].mult(q))}}function Lt(S,l){let m=!0;return S==="always"||S!=="never"&&l!=="never"||(m=!1),m}class Yn{constructor(l,m,v){const _=this.boxCells=[],P=this.circleCells=[];this.xCellCount=Math.ceil(l/v),this.yCellCount=Math.ceil(m/v);for(let I=0;I<this.xCellCount*this.yCellCount;I++)_.push([]),P.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=m,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,m,v,_,P){this._forEachCell(m,v,_,P,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(m),this.bboxes.push(v),this.bboxes.push(_),this.bboxes.push(P)}insertCircle(l,m,v,_){this._forEachCell(m-_,v-_,m+_,v+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(m),this.circles.push(v),this.circles.push(_)}_insertBoxCell(l,m,v,_,P,I){this.boxCells[P].push(I)}_insertCircleCell(l,m,v,_,P,I){this.circleCells[P].push(I)}_query(l,m,v,_,P,I,z){if(v<0||l>this.width||_<0||m>this.height)return[];const q=[];if(l<=0&&m<=0&&this.width<=v&&this.height<=_){if(P)return[{key:null,x1:l,y1:m,x2:v,y2:_}];for(let G=0;G<this.boxKeys.length;G++)q.push({key:this.boxKeys[G],x1:this.bboxes[4*G],y1:this.bboxes[4*G+1],x2:this.bboxes[4*G+2],y2:this.bboxes[4*G+3]});for(let G=0;G<this.circleKeys.length;G++){const Y=this.circles[3*G],le=this.circles[3*G+1],ie=this.circles[3*G+2];q.push({key:this.circleKeys[G],x1:Y-ie,y1:le-ie,x2:Y+ie,y2:le+ie})}}else this._forEachCell(l,m,v,_,this._queryCell,q,{hitTest:P,overlapMode:I,seenUids:{box:{},circle:{}}},z);return q}query(l,m,v,_){return this._query(l,m,v,_,!1,null)}hitTest(l,m,v,_,P,I){return this._query(l,m,v,_,!0,P,I).length>0}hitTestCircle(l,m,v,_,P){const I=l-v,z=l+v,q=m-v,G=m+v;if(z<0||I>this.width||G<0||q>this.height)return!1;const Y=[];return this._forEachCell(I,q,z,G,this._queryCellCircle,Y,{hitTest:!0,overlapMode:_,circle:{x:l,y:m,radius:v},seenUids:{box:{},circle:{}}},P),Y.length>0}_queryCell(l,m,v,_,P,I,z,q){const{seenUids:G,hitTest:Y,overlapMode:le}=z,ie=this.boxCells[P];if(ie!==null){const _e=this.bboxes;for(const Ee of ie)if(!G.box[Ee]){G.box[Ee]=!0;const Oe=4*Ee,Re=this.boxKeys[Ee];if(l<=_e[Oe+2]&&m<=_e[Oe+3]&&v>=_e[Oe+0]&&_>=_e[Oe+1]&&(!q||q(Re))&&(!Y||!Lt(le,Re.overlapMode))&&(I.push({key:Re,x1:_e[Oe],y1:_e[Oe+1],x2:_e[Oe+2],y2:_e[Oe+3]}),Y))return!0}}const fe=this.circleCells[P];if(fe!==null){const _e=this.circles;for(const Ee of fe)if(!G.circle[Ee]){G.circle[Ee]=!0;const Oe=3*Ee,Re=this.circleKeys[Ee];if(this._circleAndRectCollide(_e[Oe],_e[Oe+1],_e[Oe+2],l,m,v,_)&&(!q||q(Re))&&(!Y||!Lt(le,Re.overlapMode))){const ze=_e[Oe],Ue=_e[Oe+1],$e=_e[Oe+2];if(I.push({key:Re,x1:ze-$e,y1:Ue-$e,x2:ze+$e,y2:Ue+$e}),Y)return!0}}}return!1}_queryCellCircle(l,m,v,_,P,I,z,q){const{circle:G,seenUids:Y,overlapMode:le}=z,ie=this.boxCells[P];if(ie!==null){const _e=this.bboxes;for(const Ee of ie)if(!Y.box[Ee]){Y.box[Ee]=!0;const Oe=4*Ee,Re=this.boxKeys[Ee];if(this._circleAndRectCollide(G.x,G.y,G.radius,_e[Oe+0],_e[Oe+1],_e[Oe+2],_e[Oe+3])&&(!q||q(Re))&&!Lt(le,Re.overlapMode))return I.push(!0),!0}}const fe=this.circleCells[P];if(fe!==null){const _e=this.circles;for(const Ee of fe)if(!Y.circle[Ee]){Y.circle[Ee]=!0;const Oe=3*Ee,Re=this.circleKeys[Ee];if(this._circlesCollide(_e[Oe],_e[Oe+1],_e[Oe+2],G.x,G.y,G.radius)&&(!q||q(Re))&&!Lt(le,Re.overlapMode))return I.push(!0),!0}}}_forEachCell(l,m,v,_,P,I,z,q){const G=this._convertToXCellCoord(l),Y=this._convertToYCellCoord(m),le=this._convertToXCellCoord(v),ie=this._convertToYCellCoord(_);for(let fe=G;fe<=le;fe++)for(let _e=Y;_e<=ie;_e++)if(P.call(this,l,m,v,_,this.xCellCount*_e+fe,I,z,q))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,m,v,_,P,I){const z=_-l,q=P-m,G=v+I;return G*G>z*z+q*q}_circleAndRectCollide(l,m,v,_,P,I,z){const q=(I-_)/2,G=Math.abs(l-(_+q));if(G>q+v)return!1;const Y=(z-P)/2,le=Math.abs(m-(P+Y));if(le>Y+v)return!1;if(G<=q||le<=Y)return!0;const ie=G-q,fe=le-Y;return ie*ie+fe*fe<=v*v}}function Mi(S,l,m){const v=i.M();if(!S){const{vecSouth:le,vecEast:ie}=Xa(l),fe=p();fe[0]=ie[0],fe[1]=ie[1],fe[2]=le[0],fe[3]=le[1],_=fe,(Y=(I=(P=fe)[0])*(G=P[3])-(q=P[2])*(z=P[1]))&&(_[0]=G*(Y=1/Y),_[1]=-z*Y,_[2]=-q*Y,_[3]=I*Y),v[0]=fe[0],v[1]=fe[1],v[4]=fe[2],v[5]=fe[3]}var _,P,I,z,q,G,Y;return i.O(v,v,[1/m,1/m,1]),v}function th(S,l,m,v){if(S){const _=i.M();if(!l){const{vecSouth:P,vecEast:I}=Xa(m);_[0]=I[0],_[1]=I[1],_[4]=P[0],_[5]=P[1]}return i.O(_,_,[v,v,1]),_}return m.pixelsToClipSpaceMatrix}function Xa(S){const l=Math.cos(S.rollInRadians),m=Math.sin(S.rollInRadians),v=Math.cos(S.pitchInRadians),_=Math.cos(S.bearingInRadians),P=Math.sin(S.bearingInRadians),I=i.av();I[0]=-_*v*m-P*l,I[1]=-P*v*m+_*l;const z=i.aw(I);z<1e-9?i.ax(I):i.ay(I,I,1/z);const q=i.av();q[0]=_*v*l-P*m,q[1]=P*v*l+_*m;const G=i.aw(q);return G<1e-9?i.ax(q):i.ay(q,q,1/G),{vecEast:q,vecSouth:I}}function Kt(S,l,m,v){let _;v?(_=[S,l,v(S,l),1],i.aA(_,_,m)):(_=[S,l,0,1],Vd(_,_,m));const P=_[3];return{point:new i.P(_[0]/P,_[1]/P),signedDistanceFromCamera:P,isOccluded:!1}}function Jr(S,l){return .5+S/l*.5}function cs(S,l){return S.x>=-l[0]&&S.x<=l[0]&&S.y>=-l[1]&&S.y<=l[1]}function Xo(S,l,m,v,_,P,I,z,q,G,Y,le,ie){const fe=m?S.textSizeData:S.iconSizeData,_e=i.ar(fe,l.transform.zoom),Ee=[256/l.width*2+1,256/l.height*2+1],Oe=m?S.text.dynamicLayoutVertexArray:S.icon.dynamicLayoutVertexArray;Oe.clear();const Re=S.lineVertexArray,ze=m?S.text.placedSymbolArray:S.icon.placedSymbolArray,Ue=l.transform.width/l.transform.height;let $e=!1;for(let We=0;We<ze.length;We++){const Ye=ze.get(We);if(Ye.hidden||Ye.writingMode===i.as.vertical&&!$e){rh(Ye.numGlyphs,Oe);continue}$e=!1;const Be=new i.P(Ye.anchorX,Ye.anchorY),et={getElevation:ie,pitchedLabelPlaneMatrix:v,lineVertexArray:Re,pitchWithMap:P,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:l.transform,tileAnchorPoint:Be,unwrappedTileID:q,width:G,height:Y,translation:le},pt=Ym(Ye.anchorX,Ye.anchorY,et);if(!cs(pt.point,Ee)){rh(Ye.numGlyphs,Oe);continue}const ut=Jr(l.transform.cameraToCenterDistance,pt.signedDistanceFromCamera),mt=i.at(fe,_e,Ye),xt=P?mt*l.transform.getPitchedTextCorrection(Ye.anchorX,Ye.anchorY,q)/ut:mt*ut,Ut=ns({projectionContext:et,pitchedLabelPlaneMatrixInverse:_,symbol:Ye,fontSize:xt,flip:!1,keepUpright:I,glyphOffsetArray:S.glyphOffsetArray,dynamicLayoutVertexArray:Oe,aspectRatio:Ue,rotateToLine:z});$e=Ut.useVertical,(Ut.notEnoughRoom||$e||Ut.needsFlipping&&ns({projectionContext:et,pitchedLabelPlaneMatrixInverse:_,symbol:Ye,fontSize:xt,flip:!0,keepUpright:I,glyphOffsetArray:S.glyphOffsetArray,dynamicLayoutVertexArray:Oe,aspectRatio:Ue,rotateToLine:z}).notEnoughRoom)&&rh(Ye.numGlyphs,Oe)}m?S.text.dynamicLayoutVertexBuffer.updateData(Oe):S.icon.dynamicLayoutVertexBuffer.updateData(Oe)}function Hm(S,l,m,v,_,P,I,z){const q=P.glyphStartIndex+P.numGlyphs,G=P.lineStartIndex,Y=P.lineStartIndex+P.lineLength,le=l.getoffsetX(P.glyphStartIndex),ie=l.getoffsetX(q-1),fe=mi(S*le,m,v,_,P.segment,G,Y,z,I);if(!fe)return null;const _e=mi(S*ie,m,v,_,P.segment,G,Y,z,I);return _e?z.projectionCache.anyProjectionOccluded?null:{first:fe,last:_e}:null}function Jc(S,l,m,v){return S===i.as.horizontal&&Math.abs(m.y-l.y)>Math.abs(m.x-l.x)*v?{useVertical:!0}:(S===i.as.vertical?l.y<m.y:l.x>m.x)?{needsFlipping:!0}:null}function ns(S){const{projectionContext:l,pitchedLabelPlaneMatrixInverse:m,symbol:v,fontSize:_,flip:P,keepUpright:I,glyphOffsetArray:z,dynamicLayoutVertexArray:q,aspectRatio:G,rotateToLine:Y}=S,le=_/24,ie=v.lineOffsetX*le,fe=v.lineOffsetY*le;let _e;if(v.numGlyphs>1){const Ee=v.glyphStartIndex+v.numGlyphs,Oe=v.lineStartIndex,Re=v.lineStartIndex+v.lineLength,ze=Hm(le,z,ie,fe,P,v,Y,l);if(!ze)return{notEnoughRoom:!0};const Ue=ed(ze.first.point.x,ze.first.point.y,l,m),$e=ed(ze.last.point.x,ze.last.point.y,l,m);if(I&&!P){const We=Jc(v.writingMode,Ue,$e,G);if(We)return We}_e=[ze.first];for(let We=v.glyphStartIndex+1;We<Ee-1;We++){const Ye=mi(le*z.getoffsetX(We),ie,fe,P,v.segment,Oe,Re,l,Y);if(!Ye)return{notEnoughRoom:!0};_e.push(Ye)}_e.push(ze.last)}else{if(I&&!P){const Oe=Sl(l.tileAnchorPoint.x,l.tileAnchorPoint.y,l).point,Re=v.lineStartIndex+v.segment+1,ze=new i.P(l.lineVertexArray.getx(Re),l.lineVertexArray.gety(Re)),Ue=Sl(ze.x,ze.y,l),$e=Ue.signedDistanceFromCamera>0?Ue.point:Zm(l.tileAnchorPoint,ze,Oe,1,l),We=ed(Oe.x,Oe.y,l,m),Ye=ed($e.x,$e.y,l,m),Be=Jc(v.writingMode,We,Ye,G);if(Be)return Be}const Ee=mi(le*z.getoffsetX(v.glyphStartIndex),ie,fe,P,v.segment,v.lineStartIndex,v.lineStartIndex+v.lineLength,l,Y);if(!Ee||l.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};_e=[Ee]}for(const Ee of _e)i.az(q,Ee.point,Ee.angle);return{}}function Zm(S,l,m,v,_){const P=S.add(S.sub(l)._unit()),I=Sl(P.x,P.y,_).point,z=m.sub(I);return m.add(z._mult(v/z.mag()))}function Bd(S,l,m){const v=l.projectionCache;if(v.projections[S])return v.projections[S];const _=new i.P(l.lineVertexArray.getx(S),l.lineVertexArray.gety(S)),P=Sl(_.x,_.y,l);if(P.signedDistanceFromCamera>0)return v.projections[S]=P.point,v.anyProjectionOccluded=v.anyProjectionOccluded||P.isOccluded,P.point;const I=S-m.direction;return Zm(m.distanceFromAnchor===0?l.tileAnchorPoint:new i.P(l.lineVertexArray.getx(I),l.lineVertexArray.gety(I)),_,m.previousVertex,m.absOffsetX-m.distanceFromAnchor+1,l)}function Sl(S,l,m){const v=S+m.translation[0],_=l+m.translation[1];let P;return m.pitchWithMap?(P=Kt(v,_,m.pitchedLabelPlaneMatrix,m.getElevation),P.isOccluded=!1):(P=m.transform.projectTileCoordinates(v,_,m.unwrappedTileID,m.getElevation),P.point.x=(.5*P.point.x+.5)*m.width,P.point.y=(.5*-P.point.y+.5)*m.height),P}function ed(S,l,m,v){if(m.pitchWithMap){const _=[S,l,0,1];return i.aA(_,_,v),m.transform.projectTileCoordinates(_[0]/_[3],_[1]/_[3],m.unwrappedTileID,m.getElevation).point}return{x:S/m.width*2-1,y:1-l/m.height*2}}function Ym(S,l,m){return m.transform.projectTileCoordinates(S,l,m.unwrappedTileID,m.getElevation)}function qd(S,l,m){return S._unit()._perp()._mult(l*m)}function Kp(S,l,m,v,_,P,I,z,q){if(z.projectionCache.offsets[S])return z.projectionCache.offsets[S];const G=m.add(l);if(S+q.direction<v||S+q.direction>=_)return z.projectionCache.offsets[S]=G,G;const Y=Bd(S+q.direction,z,q),le=qd(Y.sub(m),I,q.direction),ie=m.add(le),fe=Y.add(le);return z.projectionCache.offsets[S]=i.aB(P,G,ie,fe)||G,z.projectionCache.offsets[S]}function mi(S,l,m,v,_,P,I,z,q){const G=v?S-l:S+l;let Y=G>0?1:-1,le=0;v&&(Y*=-1,le=Math.PI),Y<0&&(le+=Math.PI);let ie,fe=Y>0?P+_:P+_+1;z.projectionCache.cachedAnchorPoint?ie=z.projectionCache.cachedAnchorPoint:(ie=Sl(z.tileAnchorPoint.x,z.tileAnchorPoint.y,z).point,z.projectionCache.cachedAnchorPoint=ie);let _e,Ee,Oe=ie,Re=ie,ze=0,Ue=0;const $e=Math.abs(G),We=[];let Ye;for(;ze+Ue<=$e;){if(fe+=Y,fe<P||fe>=I)return null;ze+=Ue,Re=Oe,Ee=_e;const pt={absOffsetX:$e,direction:Y,distanceFromAnchor:ze,previousVertex:Re};if(Oe=Bd(fe,z,pt),m===0)We.push(Re),Ye=Oe.sub(Re);else{let ut;const mt=Oe.sub(Re);ut=mt.mag()===0?qd(Bd(fe+Y,z,pt).sub(Oe),m,Y):qd(mt,m,Y),Ee||(Ee=Re.add(ut)),_e=Kp(fe,ut,Oe,P,I,Ee,m,z,pt),We.push(Ee),Ye=_e.sub(Ee)}Ue=Ye.mag()}const Be=Ye._mult(($e-ze)/Ue)._add(Ee||Re),et=le+Math.atan2(Oe.y-Re.y,Oe.x-Re.x);return We.push(Be),{point:Be,angle:q?et:0,path:We}}const En=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function rh(S,l){for(let m=0;m<S;m++){const v=l.length;l.resize(v+4),l.float32.set(En,3*v)}}function Vd(S,l,m){const v=l[0],_=l[1];return S[0]=m[0]*v+m[4]*_+m[12],S[1]=m[1]*v+m[5]*_+m[13],S[3]=m[3]*v+m[7]*_+m[15],S}const xa=100;class Ud{constructor(l,m=new Yn(l.width+200,l.height+200,25),v=new Yn(l.width+200,l.height+200,25)){this.transform=l,this.grid=m,this.ignoredGrid=v,this.pitchFactor=Math.cos(l.pitch*Math.PI/180)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+xa,this.screenBottomBoundary=l.height+xa,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(l,m,v,_,P,I,z,q,G,Y,le,ie){const fe=this.projectAndGetPerspectiveRatio(l.anchorPointX+q[0],l.anchorPointY+q[1],P,Y,ie),_e=v*fe.perspectiveRatio;let Ee;if(I||z)Ee=this._projectCollisionBox(l,_e,_,P,I,z,q,fe,Y,le,ie);else{const Ye=fe.x+(le?le.x*_e:0),Be=fe.y+(le?le.y*_e:0);Ee={allPointsOccluded:!1,box:[Ye+l.x1*_e,Be+l.y1*_e,Ye+l.x2*_e,Be+l.y2*_e]}}const[Oe,Re,ze,Ue]=Ee.box,$e=I?Ee.allPointsOccluded:fe.isOccluded;let We=$e;return We||(We=fe.perspectiveRatio<this.perspectiveRatioCutoff),We||(We=!this.isInsideGrid(Oe,Re,ze,Ue)),We||m!=="always"&&this.grid.hitTest(Oe,Re,ze,Ue,m,G)?{box:[Oe,Re,ze,Ue],placeable:!1,offscreen:!1,occluded:$e}:{box:[Oe,Re,ze,Ue],placeable:!0,offscreen:this.isOffscreen(Oe,Re,ze,Ue),occluded:$e}}placeCollisionCircles(l,m,v,_,P,I,z,q,G,Y,le,ie,fe,_e){const Ee=[],Oe=new i.P(m.anchorX,m.anchorY),Re=this.getPerspectiveRatio(Oe.x,Oe.y,I,_e),ze=(G?P*this.transform.getPitchedTextCorrection(m.anchorX,m.anchorY,I)/Re:P*Re)/i.aF,Ue={getElevation:_e,pitchedLabelPlaneMatrix:z,lineVertexArray:v,pitchWithMap:G,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:Oe,unwrappedTileID:I,width:this.transform.width,height:this.transform.height,translation:fe},$e=Hm(ze,_,m.lineOffsetX*ze,m.lineOffsetY*ze,!1,m,!1,Ue);let We=!1,Ye=!1,Be=!0;if($e){const et=.5*le*Re+ie,pt=new i.P(-100,-100),ut=new i.P(this.screenRightBoundary,this.screenBottomBoundary),mt=new Na,xt=$e.first,Ut=$e.last;let Wt=[];for(let Hr=xt.path.length-1;Hr>=1;Hr--)Wt.push(xt.path[Hr]);for(let Hr=1;Hr<Ut.path.length;Hr++)Wt.push(Ut.path[Hr]);const Dt=2.5*et;if(G){const Hr=this.projectPathToScreenSpace(Wt,Ue);Wt=Hr.some(Ks=>Ks.signedDistanceFromCamera<=0)?[]:Hr.map(Ks=>Ks.point)}let jr=[];if(Wt.length>0){const Hr=Wt[0].clone(),Ks=Wt[0].clone();for(let es=1;es<Wt.length;es++)Hr.x=Math.min(Hr.x,Wt[es].x),Hr.y=Math.min(Hr.y,Wt[es].y),Ks.x=Math.max(Ks.x,Wt[es].x),Ks.y=Math.max(Ks.y,Wt[es].y);jr=Hr.x>=pt.x&&Ks.x<=ut.x&&Hr.y>=pt.y&&Ks.y<=ut.y?[Wt]:Ks.x<pt.x||Hr.x>ut.x||Ks.y<pt.y||Hr.y>ut.y?[]:i.aC([Wt],pt.x,pt.y,ut.x,ut.y)}for(const Hr of jr){mt.reset(Hr,.25*et);let Ks=0;Ks=mt.length<=.5*et?1:Math.ceil(mt.paddedLength/Dt)+1;for(let es=0;es<Ks;es++){const on=es/Math.max(Ks-1,1),In=mt.lerp(on),un=In.x+xa,ga=In.y+xa;Ee.push(un,ga,et,0);const Sn=un-et,Ia=ga-et,Cn=un+et,aa=ga+et;if(Be=Be&&this.isOffscreen(Sn,Ia,Cn,aa),Ye=Ye||this.isInsideGrid(Sn,Ia,Cn,aa),l!=="always"&&this.grid.hitTestCircle(un,ga,et,l,Y)&&(We=!0,!q))return{circles:[],offscreen:!1,collisionDetected:We}}}}return{circles:!q&&We||!Ye||Re<this.perspectiveRatioCutoff?[]:Ee,offscreen:Be,collisionDetected:We}}projectPathToScreenSpace(l,m){const v=function(_,P){const I=i.M();return i.au(I,P.pitchedLabelPlaneMatrix),_.map(z=>{const q=Kt(z.x,z.y,I,P.getElevation),G=P.transform.projectTileCoordinates(q.point.x,q.point.y,P.unwrappedTileID,P.getElevation);return G.point.x=(.5*G.point.x+.5)*P.width,G.point.y=(.5*-G.point.y+.5)*P.height,G})}(l,m);return function(_){let P=0,I=0,z=0,q=0;for(let G=0;G<_.length;G++)_[G].isOccluded?(z=G+1,q=0):(q++,q>I&&(I=q,P=z));return _.slice(P,P+I)}(v)}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const m=[],v=new i.a6;for(const le of l){const ie=new i.P(le.x+xa,le.y+xa);v.extend(ie),m.push(ie)}const{minX:_,minY:P,maxX:I,maxY:z}=v,q=this.grid.query(_,P,I,z).concat(this.ignoredGrid.query(_,P,I,z)),G={},Y={};for(const le of q){const ie=le.key;if(G[ie.bucketInstanceId]===void 0&&(G[ie.bucketInstanceId]={}),G[ie.bucketInstanceId][ie.featureIndex])continue;const fe=[new i.P(le.x1,le.y1),new i.P(le.x2,le.y1),new i.P(le.x2,le.y2),new i.P(le.x1,le.y2)];i.aD(m,fe)&&(G[ie.bucketInstanceId][ie.featureIndex]=!0,Y[ie.bucketInstanceId]===void 0&&(Y[ie.bucketInstanceId]=[]),Y[ie.bucketInstanceId].push(ie.featureIndex))}return Y}insertCollisionBox(l,m,v,_,P,I){(v?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:P,collisionGroupID:I,overlapMode:m},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,m,v,_,P,I){const z=v?this.ignoredGrid:this.grid,q={bucketInstanceId:_,featureIndex:P,collisionGroupID:I,overlapMode:m};for(let G=0;G<l.length;G+=4)z.insertCircle(q,l[G],l[G+1],l[G+2])}projectAndGetPerspectiveRatio(l,m,v,_,P){if(P){let I;_?(I=[l,m,_(l,m),1],i.aA(I,I,P)):(I=[l,m,0,1],Vd(I,I,P));const z=I[3];return{x:(I[0]/z+1)/2*this.transform.width+xa,y:(-I[1]/z+1)/2*this.transform.height+xa,perspectiveRatio:.5+this.transform.cameraToCenterDistance/z*.5,isOccluded:!1,signedDistanceFromCamera:z}}{const I=this.transform.projectTileCoordinates(l,m,v,_);return{x:(I.point.x+1)/2*this.transform.width+xa,y:(1-I.point.y)/2*this.transform.height+xa,perspectiveRatio:.5+this.transform.cameraToCenterDistance/I.signedDistanceFromCamera*.5,isOccluded:I.isOccluded,signedDistanceFromCamera:I.signedDistanceFromCamera}}}getPerspectiveRatio(l,m,v,_){const P=this.transform.projectTileCoordinates(l,m,v,_);return .5+this.transform.cameraToCenterDistance/P.signedDistanceFromCamera*.5}isOffscreen(l,m,v,_){return v<xa||l>=this.screenRightBoundary||_<xa||m>this.screenBottomBoundary}isInsideGrid(l,m,v,_){return v>=0&&l<this.gridRightBoundary&&_>=0&&m<this.gridBottomBoundary}getViewportMatrix(){const l=i.am([]);return i.N(l,l,[-100,-100,0]),l}_projectCollisionBox(l,m,v,_,P,I,z,q,G,Y,le){let ie=1,fe=0,_e=0,Ee=1;const Oe=l.anchorPointX+z[0],Re=l.anchorPointY+z[1];if(I&&!P){const Wt=this.projectAndGetPerspectiveRatio(Oe+1,Re,_,G,le),Dt=Wt.x-q.x,jr=Math.atan((Wt.y-q.y)/Dt)+(Dt<0?Math.PI:0),Hr=Math.sin(jr),Ks=Math.cos(jr);ie=Ks,fe=Hr,_e=-Hr,Ee=Ks}else if(!I&&P){const Wt=Xa(this.transform);ie=Wt.vecEast[0],fe=Wt.vecEast[1],_e=Wt.vecSouth[0],Ee=Wt.vecSouth[1]}let ze=q.x,Ue=q.y,$e=m;P&&(ze=Oe,Ue=Re,$e=Math.pow(2,-(this.transform.zoom-v.overscaledZ)),$e*=this.transform.getPitchedTextCorrection(Oe,Re,_),Y||($e*=i.ai(.5+q.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),Y&&(ze+=ie*Y.x*$e+_e*Y.y*$e,Ue+=fe*Y.x*$e+Ee*Y.y*$e);const We=l.x1*$e,Ye=l.x2*$e,Be=(We+Ye)/2,et=l.y1*$e,pt=l.y2*$e,ut=(et+pt)/2,mt=[{offsetX:We,offsetY:et},{offsetX:Be,offsetY:et},{offsetX:Ye,offsetY:et},{offsetX:Ye,offsetY:ut},{offsetX:Ye,offsetY:pt},{offsetX:Be,offsetY:pt},{offsetX:We,offsetY:pt},{offsetX:We,offsetY:ut}];let xt=[];for(const{offsetX:Wt,offsetY:Dt}of mt)xt.push(new i.P(ze+ie*Wt+_e*Dt,Ue+fe*Wt+Ee*Dt));let Ut=!1;if(P){const Wt=xt.map(Dt=>this.projectAndGetPerspectiveRatio(Dt.x,Dt.y,_,G,le));Ut=Wt.some(Dt=>!Dt.isOccluded),xt=Wt.map(Dt=>new i.P(Dt.x,Dt.y))}else Ut=!0;return{box:i.aE(xt),allPointsOccluded:!Ut}}}class ic{constructor(l,m,v,_){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?m:-m))):_&&v?1:0,this.placed=v}isHidden(){return this.opacity===0&&!this.placed}}class sh{constructor(l,m,v,_,P){this.text=new ic(l?l.text:null,m,v,P),this.icon=new ic(l?l.icon:null,m,_,P)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class $v{constructor(l,m,v){this.text=l,this.icon=m,this.skipFade=v}}class ow{constructor(l,m,v,_,P){this.bucketInstanceId=l,this.featureIndex=m,this.sourceLayerIndex=v,this.bucketIndex=_,this.tileID=P}}class nh{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const m=++this.maxGroupID;this.collisionGroups[l]={ID:m,predicate:v=>v.collisionGroupID===m}}return this.collisionGroups[l]}}function zv(S,l,m,v,_){const{horizontalAlign:P,verticalAlign:I}=i.aL(S);return new i.P(-(P-.5)*l+v[0]*_,-(I-.5)*m+v[1]*_)}class qP{constructor(l,m,v,_,P){this.transform=l.clone(),this.terrain=m,this.collisionIndex=new Ud(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=v,this.retainedQueryData={},this.collisionGroups=new nh(_),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=P,P&&(P.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(l){const m=this.terrain;return m?(v,_)=>m.getElevation(l,v,_):null}getBucketParts(l,m,v,_){const P=v.getBucket(m),I=v.latestFeatureIndex;if(!P||!I||m.id!==P.layerIds[0])return;const z=v.collisionBoxArray,q=P.layers[0].layout,G=P.layers[0].paint,Y=Math.pow(2,this.transform.zoom-v.tileID.overscaledZ),le=v.tileSize/i.a3,ie=v.tileID.toUnwrapped(),fe=q.get("text-rotation-alignment")==="map",_e=i.aG(v,1,this.transform.zoom),Ee=i.aH(this.collisionIndex.transform,v,G.get("text-translate"),G.get("text-translate-anchor")),Oe=i.aH(this.collisionIndex.transform,v,G.get("icon-translate"),G.get("icon-translate-anchor")),Re=Mi(fe,this.transform,_e);this.retainedQueryData[P.bucketInstanceId]=new ow(P.bucketInstanceId,I,P.sourceLayerIndex,P.index,v.tileID);const ze={bucket:P,layout:q,translationText:Ee,translationIcon:Oe,unwrappedTileID:ie,pitchedLabelPlaneMatrix:Re,scale:Y,textPixelRatio:le,holdingForFade:v.holdingForSymbolFade(),collisionBoxArray:z,partiallyEvaluatedTextSize:i.ar(P.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(P.sourceID)};if(_)for(const Ue of P.sortKeyRanges){const{sortKey:$e,symbolInstanceStart:We,symbolInstanceEnd:Ye}=Ue;l.push({sortKey:$e,symbolInstanceStart:We,symbolInstanceEnd:Ye,parameters:ze})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:P.symbolInstances.length,parameters:ze})}attemptAnchorPlacement(l,m,v,_,P,I,z,q,G,Y,le,ie,fe,_e,Ee,Oe,Re,ze,Ue,$e){const We=i.aI[l.textAnchor],Ye=[l.textOffset0,l.textOffset1],Be=zv(We,v,_,Ye,P),et=this.collisionIndex.placeCollisionBox(m,ie,q,G,Y,z,I,Oe,le.predicate,Ue,Be,$e);if((!ze||this.collisionIndex.placeCollisionBox(ze,ie,q,G,Y,z,I,Re,le.predicate,Ue,Be,$e).placeable)&&et.placeable){let pt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[fe.crossTileID]&&this.prevPlacement.placements[fe.crossTileID]&&this.prevPlacement.placements[fe.crossTileID].text&&(pt=this.prevPlacement.variableOffsets[fe.crossTileID].anchor),fe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[fe.crossTileID]={textOffset:Ye,width:v,height:_,anchor:We,textBoxScale:P,prevAnchor:pt},this.markUsedJustification(_e,We,fe,Ee),_e.allowVerticalPlacement&&(this.markUsedOrientation(_e,Ee,fe),this.placedOrientations[fe.crossTileID]=Ee),{shift:Be,placedGlyphBoxes:et}}}placeLayerBucketPart(l,m,v){const{bucket:_,layout:P,translationText:I,translationIcon:z,unwrappedTileID:q,pitchedLabelPlaneMatrix:G,textPixelRatio:Y,holdingForFade:le,collisionBoxArray:ie,partiallyEvaluatedTextSize:fe,collisionGroup:_e}=l.parameters,Ee=P.get("text-optional"),Oe=P.get("icon-optional"),Re=i.aJ(P,"text-overlap","text-allow-overlap"),ze=Re==="always",Ue=i.aJ(P,"icon-overlap","icon-allow-overlap"),$e=Ue==="always",We=P.get("text-rotation-alignment")==="map",Ye=P.get("text-pitch-alignment")==="map",Be=P.get("icon-text-fit")!=="none",et=P.get("symbol-z-order")==="viewport-y",pt=ze&&($e||!_.hasIconData()||Oe),ut=$e&&(ze||!_.hasTextData()||Ee);!_.collisionArrays&&ie&&_.deserializeCollisionBoxes(ie);const mt=this.retainedQueryData[_.bucketInstanceId].tileID,xt=this._getTerrainElevationFunc(mt),Ut=this.transform.getFastPathSimpleProjectionMatrix(mt),Wt=(Dt,jr,Hr)=>{var Ks,es;if(m[Dt.crossTileID])return;if(le)return void(this.placements[Dt.crossTileID]=new $v(!1,!1,!1));let on=!1,In=!1,un=!0,ga=null,Sn={box:null,placeable:!1,offscreen:null,occluded:!1},Ia={placeable:!1},Cn=null,aa=null,Ri=null,ou=0,pc=0,Tl=0;jr.textFeatureIndex?ou=jr.textFeatureIndex:Dt.useRuntimeCollisionCircles&&(ou=Dt.featureIndex),jr.verticalTextFeatureIndex&&(pc=jr.verticalTextFeatureIndex);const lu=jr.textBox;if(lu){const Li=ia=>{let Jn=i.as.horizontal;if(_.allowVerticalPlacement&&!ia&&this.prevPlacement){const Da=this.prevPlacement.placedOrientations[Dt.crossTileID];Da&&(this.placedOrientations[Dt.crossTileID]=Da,Jn=Da,this.markUsedOrientation(_,Jn,Dt))}return Jn},xc=(ia,Jn)=>{if(_.allowVerticalPlacement&&Dt.numVerticalGlyphVertices>0&&jr.verticalTextBox){for(const Da of _.writingModes)if(Da===i.as.vertical?(Sn=Jn(),Ia=Sn):Sn=ia(),Sn&&Sn.placeable)break}else Sn=ia()},id=Dt.textAnchorOffsetStartIndex,Sf=Dt.textAnchorOffsetEndIndex;if(Sf===id){const ia=(Jn,Da)=>{const yn=this.collisionIndex.placeCollisionBox(Jn,Re,Y,mt,q,Ye,We,I,_e.predicate,xt,void 0,Ut);return yn&&yn.placeable&&(this.markUsedOrientation(_,Da,Dt),this.placedOrientations[Dt.crossTileID]=Da),yn};xc(()=>ia(lu,i.as.horizontal),()=>{const Jn=jr.verticalTextBox;return _.allowVerticalPlacement&&Dt.numVerticalGlyphVertices>0&&Jn?ia(Jn,i.as.vertical):{box:null,offscreen:null}}),Li(Sn&&Sn.placeable)}else{let ia=i.aI[(es=(Ks=this.prevPlacement)===null||Ks===void 0?void 0:Ks.variableOffsets[Dt.crossTileID])===null||es===void 0?void 0:es.anchor];const Jn=(yn,tl,od)=>{const c1=yn.x2-yn.x1,d1=yn.y2-yn.y1,u1=Dt.textBoxScale,du=Be&&Ue==="never"?tl:null;let uu=null,Oj=Re==="never"?1:2,Ox="never";ia&&Oj++;for(let Ij=0;Ij<Oj;Ij++){for(let gc=id;gc<Sf;gc++){const ld=_.textAnchorOffsets.get(gc);if(ia&&ld.textAnchor!==ia)continue;const Ix=this.attemptAnchorPlacement(ld,yn,c1,d1,u1,We,Ye,Y,mt,q,_e,Ox,Dt,_,od,I,z,du,xt);if(Ix&&(uu=Ix.placedGlyphBoxes,uu&&uu.placeable))return on=!0,ga=Ix.shift,uu}ia?ia=null:Ox=Re}return v&&!uu&&(uu={box:this.collisionIndex.placeCollisionBox(lu,"always",Y,mt,q,Ye,We,I,_e.predicate,xt,void 0,Ut).box,offscreen:!1,placeable:!1,occluded:!1}),uu};xc(()=>Jn(lu,jr.iconBox,i.as.horizontal),()=>{const yn=jr.verticalTextBox;return _.allowVerticalPlacement&&(!Sn||!Sn.placeable)&&Dt.numVerticalGlyphVertices>0&&yn?Jn(yn,jr.verticalIconBox,i.as.vertical):{box:null,occluded:!0,offscreen:null}}),Sn&&(on=Sn.placeable,un=Sn.offscreen);const Da=Li(Sn&&Sn.placeable);if(!on&&this.prevPlacement){const yn=this.prevPlacement.variableOffsets[Dt.crossTileID];yn&&(this.variableOffsets[Dt.crossTileID]=yn,this.markUsedJustification(_,yn.anchor,Dt,Da))}}}if(Cn=Sn,on=Cn&&Cn.placeable,un=Cn&&Cn.offscreen,Dt.useRuntimeCollisionCircles&&Dt.centerJustifiedTextSymbolIndex>=0){const Li=_.text.placedSymbolArray.get(Dt.centerJustifiedTextSymbolIndex),xc=i.at(_.textSizeData,fe,Li),id=P.get("text-padding");aa=this.collisionIndex.placeCollisionCircles(Re,Li,_.lineVertexArray,_.glyphOffsetArray,xc,q,G,v,Ye,_e.predicate,Dt.collisionCircleDiameter,id,I,xt),aa.circles.length&&aa.collisionDetected&&!v&&i.w("Collisions detected, but collision boxes are not shown"),on=ze||aa.circles.length>0&&!aa.collisionDetected,un=un&&aa.offscreen}if(jr.iconFeatureIndex&&(Tl=jr.iconFeatureIndex),jr.iconBox){const Li=xc=>this.collisionIndex.placeCollisionBox(xc,Ue,Y,mt,q,Ye,We,z,_e.predicate,xt,Be&&ga?ga:void 0,Ut);Ia&&Ia.placeable&&jr.verticalIconBox?(Ri=Li(jr.verticalIconBox),In=Ri.placeable):(Ri=Li(jr.iconBox),In=Ri.placeable),un=un&&Ri.offscreen}const wh=Ee||Dt.numHorizontalGlyphVertices===0&&Dt.numVerticalGlyphVertices===0,cu=Oe||Dt.numIconVertices===0;wh||cu?cu?wh||(In=In&&on):on=In&&on:In=on=In&&on;const eo=In&&Ri.placeable;if(on&&Cn.placeable&&this.collisionIndex.insertCollisionBox(Cn.box,Re,P.get("text-ignore-placement"),_.bucketInstanceId,Ia&&Ia.placeable&&pc?pc:ou,_e.ID),eo&&this.collisionIndex.insertCollisionBox(Ri.box,Ue,P.get("icon-ignore-placement"),_.bucketInstanceId,Tl,_e.ID),aa&&on&&this.collisionIndex.insertCollisionCircles(aa.circles,Re,P.get("text-ignore-placement"),_.bucketInstanceId,ou,_e.ID),v&&this.storeCollisionData(_.bucketInstanceId,Hr,jr,Cn,Ri,aa),Dt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(_.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Dt.crossTileID]=new $v((on||pt)&&!(Cn!=null&&Cn.occluded),(In||ut)&&!(Ri!=null&&Ri.occluded),un||_.justReloaded),m[Dt.crossTileID]=!0};if(et){if(l.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Dt=_.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let jr=Dt.length-1;jr>=0;--jr){const Hr=Dt[jr];Wt(_.symbolInstances.get(Hr),_.collisionArrays[Hr],Hr)}}else for(let Dt=l.symbolInstanceStart;Dt<l.symbolInstanceEnd;Dt++)Wt(_.symbolInstances.get(Dt),_.collisionArrays[Dt],Dt);_.justReloaded=!1}storeCollisionData(l,m,v,_,P,I){if(v.textBox||v.iconBox){let z,q;this.collisionBoxArrays.has(l)?z=this.collisionBoxArrays.get(l):(z=new Map,this.collisionBoxArrays.set(l,z)),z.has(m)?q=z.get(m):(q={text:null,icon:null},z.set(m,q)),v.textBox&&(q.text=_.box),v.iconBox&&(q.icon=P.box)}if(I){let z=this.collisionCircleArrays[l];z===void 0&&(z=this.collisionCircleArrays[l]=[]);for(let q=0;q<I.circles.length;q+=4)z.push(I.circles[q+0]-xa),z.push(I.circles[q+1]-xa),z.push(I.circles[q+2]),z.push(I.collisionDetected?1:0)}}markUsedJustification(l,m,v,_){let P;P=_===i.as.vertical?v.verticalPlacedTextSymbolIndex:{left:v.leftJustifiedTextSymbolIndex,center:v.centerJustifiedTextSymbolIndex,right:v.rightJustifiedTextSymbolIndex}[i.aK(m)];const I=[v.leftJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.rightJustifiedTextSymbolIndex,v.verticalPlacedTextSymbolIndex];for(const z of I)z>=0&&(l.text.placedSymbolArray.get(z).crossTileID=P>=0&&z!==P?0:v.crossTileID)}markUsedOrientation(l,m,v){const _=m===i.as.horizontal||m===i.as.horizontalOnly?m:0,P=m===i.as.vertical?m:0,I=[v.leftJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.rightJustifiedTextSymbolIndex];for(const z of I)l.text.placedSymbolArray.get(z).placedOrientation=_;v.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(v.verticalPlacedTextSymbolIndex).placedOrientation=P)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const m=this.prevPlacement;let v=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;const _=m?m.symbolFadeChange(l):1,P=m?m.opacities:{},I=m?m.variableOffsets:{},z=m?m.placedOrientations:{};for(const q in this.placements){const G=this.placements[q],Y=P[q];Y?(this.opacities[q]=new sh(Y,_,G.text,G.icon),v=v||G.text!==Y.text.placed||G.icon!==Y.icon.placed):(this.opacities[q]=new sh(null,_,G.text,G.icon,G.skipFade),v=v||G.text||G.icon)}for(const q in P){const G=P[q];if(!this.opacities[q]){const Y=new sh(G,_,!1,!1);Y.isHidden()||(this.opacities[q]=Y,v=v||G.text.placed||G.icon.placed)}}for(const q in I)this.variableOffsets[q]||!this.opacities[q]||this.opacities[q].isHidden()||(this.variableOffsets[q]=I[q]);for(const q in z)this.placedOrientations[q]||!this.opacities[q]||this.opacities[q].isHidden()||(this.placedOrientations[q]=z[q]);if(m&&m.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");v?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:l)}updateLayerOpacities(l,m){const v={};for(const _ of m){const P=_.getBucket(l);P&&_.latestFeatureIndex&&l.id===P.layerIds[0]&&this.updateBucketOpacities(P,_.tileID,v,_.collisionBoxArray)}}updateBucketOpacities(l,m,v,_){l.hasTextData()&&(l.text.opacityVertexArray.clear(),l.text.hasVisibleVertices=!1),l.hasIconData()&&(l.icon.opacityVertexArray.clear(),l.icon.hasVisibleVertices=!1),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const P=l.layers[0],I=P.layout,z=new sh(null,0,!1,!1,!0),q=I.get("text-allow-overlap"),G=I.get("icon-allow-overlap"),Y=P._unevaluatedLayout.hasValue("text-variable-anchor")||P._unevaluatedLayout.hasValue("text-variable-anchor-offset"),le=I.get("text-rotation-alignment")==="map",ie=I.get("text-pitch-alignment")==="map",fe=I.get("icon-text-fit")!=="none",_e=new sh(null,0,q&&(G||!l.hasIconData()||I.get("icon-optional")),G&&(q||!l.hasTextData()||I.get("text-optional")),!0);!l.collisionArrays&&_&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(_);const Ee=(Re,ze,Ue)=>{for(let $e=0;$e<ze/4;$e++)Re.opacityVertexArray.emplaceBack(Ue);Re.hasVisibleVertices=Re.hasVisibleVertices||Ue!==Xm},Oe=this.collisionBoxArrays.get(l.bucketInstanceId);for(let Re=0;Re<l.symbolInstances.length;Re++){const ze=l.symbolInstances.get(Re),{numHorizontalGlyphVertices:Ue,numVerticalGlyphVertices:$e,crossTileID:We}=ze;let Ye=this.opacities[We];v[We]?Ye=z:Ye||(Ye=_e,this.opacities[We]=Ye),v[We]=!0;const Be=ze.numIconVertices>0,et=this.placedOrientations[ze.crossTileID],pt=et===i.as.vertical,ut=et===i.as.horizontal||et===i.as.horizontalOnly;if(Ue>0||$e>0){const xt=Hp(Ye.text);Ee(l.text,Ue,pt?Xm:xt),Ee(l.text,$e,ut?Xm:xt);const Ut=Ye.text.isHidden();[ze.rightJustifiedTextSymbolIndex,ze.centerJustifiedTextSymbolIndex,ze.leftJustifiedTextSymbolIndex].forEach(jr=>{jr>=0&&(l.text.placedSymbolArray.get(jr).hidden=Ut||pt?1:0)}),ze.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(ze.verticalPlacedTextSymbolIndex).hidden=Ut||ut?1:0);const Wt=this.variableOffsets[ze.crossTileID];Wt&&this.markUsedJustification(l,Wt.anchor,ze,et);const Dt=this.placedOrientations[ze.crossTileID];Dt&&(this.markUsedJustification(l,"left",ze,Dt),this.markUsedOrientation(l,Dt,ze))}if(Be){const xt=Hp(Ye.icon),Ut=!(fe&&ze.verticalPlacedIconSymbolIndex&&pt);ze.placedIconSymbolIndex>=0&&(Ee(l.icon,ze.numIconVertices,Ut?xt:Xm),l.icon.placedSymbolArray.get(ze.placedIconSymbolIndex).hidden=Ye.icon.isHidden()),ze.verticalPlacedIconSymbolIndex>=0&&(Ee(l.icon,ze.numVerticalIconVertices,Ut?Xm:xt),l.icon.placedSymbolArray.get(ze.verticalPlacedIconSymbolIndex).hidden=Ye.icon.isHidden())}const mt=Oe&&Oe.has(Re)?Oe.get(Re):{text:null,icon:null};if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const xt=l.collisionArrays[Re];if(xt){let Ut=new i.P(0,0);if(xt.textBox||xt.verticalTextBox){let Wt=!0;if(Y){const Dt=this.variableOffsets[We];Dt?(Ut=zv(Dt.anchor,Dt.width,Dt.height,Dt.textOffset,Dt.textBoxScale),le&&Ut._rotate(ie?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Wt=!1}if(xt.textBox||xt.verticalTextBox){let Dt;xt.textBox&&(Dt=pt),xt.verticalTextBox&&(Dt=ut),lw(l.textCollisionBox.collisionVertexArray,Ye.text.placed,!Wt||Dt,mt.text,Ut.x,Ut.y)}}if(xt.iconBox||xt.verticalIconBox){const Wt=!!(!ut&&xt.verticalIconBox);let Dt;xt.iconBox&&(Dt=Wt),xt.verticalIconBox&&(Dt=!Wt),lw(l.iconCollisionBox.collisionVertexArray,Ye.icon.placed,Dt,mt.icon,fe?Ut.x:0,fe?Ut.y:0)}}}}if(l.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.text.opacityVertexArray.length!==l.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${l.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${l.text.layoutVertexArray.length}) / 4`);if(l.icon.opacityVertexArray.length!==l.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${l.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${l.icon.layoutVertexArray.length}) / 4`);l.bucketInstanceId in this.collisionCircleArrays&&(l.collisionCircleArray=this.collisionCircleArrays[l.bucketInstanceId],delete this.collisionCircleArrays[l.bucketInstanceId])}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,m){const v=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*v>l}setStale(){this.stale=!0}}function lw(S,l,m,v,_,P){v&&v.length!==0||(v=[0,0,0,0]);const I=v[0]-xa,z=v[1]-xa,q=v[2]-xa,G=v[3]-xa;S.emplaceBack(l?1:0,m?1:0,_||0,P||0,I,z),S.emplaceBack(l?1:0,m?1:0,_||0,P||0,q,z),S.emplaceBack(l?1:0,m?1:0,_||0,P||0,q,G),S.emplaceBack(l?1:0,m?1:0,_||0,P||0,I,G)}const VP=Math.pow(2,25),cw=Math.pow(2,24),dw=Math.pow(2,17),Bv=Math.pow(2,16),qv=Math.pow(2,9),uw=Math.pow(2,8),Vv=Math.pow(2,1);function Hp(S){if(S.opacity===0&&!S.placed)return 0;if(S.opacity===1&&S.placed)return 4294967295;const l=S.placed?1:0,m=Math.floor(127*S.opacity);return m*VP+l*cw+m*dw+l*Bv+m*qv+l*uw+m*Vv+l}const Xm=0;class Qm{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&!l.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,m,v,_,P){const I=this._bucketParts;for(;this._currentTileIndex<l.length;)if(m.getBucketParts(I,_,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,P())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,I.sort((z,q)=>z.sortKey-q.sortKey));this._currentPartIndex<I.length;)if(m.placeLayerBucketPart(I[this._currentPartIndex],this._seenCrossTileIDs,v),this._currentPartIndex++,P())return!0;return!1}}class Zp{constructor(l,m,v,_,P,I,z,q){this.placement=new qP(l,m,I,z,q),this._currentPlacementIndex=v.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=P,this._done=!1}isDone(){return this._done}continuePlacement(l,m,v){const _=T(),P=()=>!this._forceFullPlacement&&T()-_>2;for(;this._currentPlacementIndex>=0;){const I=m[l[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(I.type==="symbol"&&(!I.minzoom||I.minzoom<=z)&&(!I.maxzoom||I.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new Qm(I)),this._inProgressLayer.continuePlacement(v[I.source],this.placement,this._showCollisionBoxes,I,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const ah=512/i.a3/2;class ih{constructor(l,m,v){this.tileID=l,this.bucketInstanceId=v,this._symbolsByKey={};const _=new Map;for(let P=0;P<m.length;P++){const I=m.get(P),z=I.key,q=_.get(z);q?q.push(I):_.set(z,[I])}for(const[P,I]of _){const z={positions:I.map(q=>({x:Math.floor(q.anchorX*ah),y:Math.floor(q.anchorY*ah)})),crossTileIDs:I.map(q=>q.crossTileID)};if(z.positions.length>128){const q=new i.aM(z.positions.length,16,Uint16Array);for(const{x:G,y:Y}of z.positions)q.add(G,Y);q.finish(),delete z.positions,z.index=q}this._symbolsByKey[P]=z}}getScaledCoordinates(l,m){const{x:v,y:_,z:P}=this.tileID.canonical,{x:I,y:z,z:q}=m.canonical,G=ah/Math.pow(2,q-P),Y=(z*i.a3+l.anchorY)*G,le=_*i.a3*ah;return{x:Math.floor((I*i.a3+l.anchorX)*G-v*i.a3*ah),y:Math.floor(Y-le)}}findMatches(l,m,v){const _=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z);for(let P=0;P<l.length;P++){const I=l.get(P);if(I.crossTileID)continue;const z=this._symbolsByKey[I.key];if(!z)continue;const q=this.getScaledCoordinates(I,m);if(z.index){const G=z.index.range(q.x-_,q.y-_,q.x+_,q.y+_).sort();for(const Y of G){const le=z.crossTileIDs[Y];if(!v[le]){v[le]=!0,I.crossTileID=le;break}}}else if(z.positions)for(let G=0;G<z.positions.length;G++){const Y=z.positions[G],le=z.crossTileIDs[G];if(Math.abs(Y.x-q.x)<=_&&Math.abs(Y.y-q.y)<=_&&!v[le]){v[le]=!0,I.crossTileID=le;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:l})=>l)}}class hw{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class UP{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const m=Math.round((l-this.lng)/360);if(m!==0)for(const v in this.indexes){const _=this.indexes[v],P={};for(const I in _){const z=_[I];z.tileID=z.tileID.unwrapTo(z.tileID.wrap+m),P[z.tileID.key]=z}this.indexes[v]=P}this.lng=l}addBucket(l,m,v){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let P=0;P<m.symbolInstances.length;P++)m.symbolInstances.get(P).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});const _=this.usedCrossTileIDs[l.overscaledZ];for(const P in this.indexes){const I=this.indexes[P];if(Number(P)>l.overscaledZ)for(const z in I){const q=I[z];q.tileID.isChildOf(l)&&q.findMatches(m.symbolInstances,l,_)}else{const z=I[l.scaledTo(Number(P)).key];z&&z.findMatches(m.symbolInstances,l,_)}}for(let P=0;P<m.symbolInstances.length;P++){const I=m.symbolInstances.get(P);I.crossTileID||(I.crossTileID=v.generate(),_[I.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new ih(l,m.symbolInstances,m.bucketInstanceId),!0}removeBucketCrossTileIDs(l,m){for(const v of m.getCrossTileIDsLists())for(const _ of v)delete this.usedCrossTileIDs[l][_]}removeStaleBuckets(l){let m=!1;for(const v in this.indexes){const _=this.indexes[v];for(const P in _)l[_[P].bucketInstanceId]||(this.removeBucketCrossTileIDs(v,_[P]),delete _[P],m=!0)}return m}}class oc{constructor(){this.layerIndexes={},this.crossTileIDs=new hw,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,m,v){let _=this.layerIndexes[l.id];_===void 0&&(_=this.layerIndexes[l.id]=new UP);let P=!1;const I={};_.handleWrapJump(v);for(const z of m){const q=z.getBucket(l);q&&l.id===q.layerIds[0]&&(q.bucketInstanceId||(q.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket(z.tileID,q,this.crossTileIDs)&&(P=!0),I[q.bucketInstanceId]=!0)}return _.removeStaleBuckets(I)&&(P=!0),P}pruneUnusedLayers(l){const m={};l.forEach(v=>{m[v]=!0});for(const v in this.layerIndexes)m[v]||delete this.layerIndexes[v]}}var Wd="void main() {fragColor=vec4(1.0);}";const Kr={prelude:xs(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:xs("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:xs("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:xs(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:xs(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:xs(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:xs(Wd,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:xs(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:xs(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:xs("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:xs("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:xs(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:xs("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:xs(Wd,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:xs(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:xs(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:xs(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:xs(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:xs(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:xs(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:xs(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:xs(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:xs(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:xs(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:xs(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:xs(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:xs(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:xs(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:xs(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:xs(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:xs(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:xs("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:xs("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:xs("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:xs("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:xs(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:xs("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function xs(S,l){const m=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,v=l.match(/in ([\w]+) ([\w]+)/g),_=S.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),I=P?P.concat(_):_,z={};return{fragmentSource:S=S.replace(m,(q,G,Y,le,ie)=>(z[ie]=!0,G==="define"?`
#ifndef HAS_UNIFORM_u_${ie}
in ${Y} ${le} ${ie};
#else
uniform ${Y} ${le} u_${ie};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ie}
    ${Y} ${le} ${ie} = u_${ie};
#endif
`)),vertexSource:l=l.replace(m,(q,G,Y,le,ie)=>{const fe=le==="float"?"vec2":"vec4",_e=ie.match(/color/)?"color":fe;return z[ie]?G==="define"?`
#ifndef HAS_UNIFORM_u_${ie}
uniform lowp float u_${ie}_t;
in ${Y} ${fe} a_${ie};
out ${Y} ${le} ${ie};
#else
uniform ${Y} ${le} u_${ie};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${ie}
    ${ie} = a_${ie};
#else
    ${Y} ${le} ${ie} = u_${ie};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ie}
    ${ie} = unpack_mix_${_e}(a_${ie}, u_${ie}_t);
#else
    ${Y} ${le} ${ie} = u_${ie};
#endif
`:G==="define"?`
#ifndef HAS_UNIFORM_u_${ie}
uniform lowp float u_${ie}_t;
in ${Y} ${fe} a_${ie};
#else
uniform ${Y} ${le} u_${ie};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${ie}
    ${Y} ${le} ${ie} = a_${ie};
#else
    ${Y} ${le} ${ie} = u_${ie};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ie}
    ${Y} ${le} ${ie} = unpack_mix_${_e}(a_${ie}, u_${ie}_t);
#else
    ${Y} ${le} ${ie} = u_${ie};
#endif
`}),staticAttributes:v,staticUniforms:I}}class oh{constructor(l,m,v){this.vertexBuffer=l,this.indexBuffer=m,this.segments=v}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Cl=i.aN([{name:"a_pos",type:"Int16",components:2}]);const Xi="#define PROJECTION_MERCATOR",fi="mercator";class Qa{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return fi}get shaderDefine(){return Xi}get shaderPreludeCode(){return Kr.projectionMercator}get vertexShaderPreludeCode(){return Kr.projectionMercator.vertexSource}get subdivisionGranularity(){return i.aO.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(l){}getMeshFromTileID(l,m,v,_,P){if(this._cachedMesh)return this._cachedMesh;const I=new i.aP;I.emplaceBack(0,0),I.emplaceBack(i.a3,0),I.emplaceBack(0,i.a3),I.emplaceBack(i.a3,i.a3);const z=l.createVertexBuffer(I,Cl.members),q=i.aQ.simpleSegment(0,0,4,2),G=new i.aR;G.emplaceBack(1,0,2),G.emplaceBack(1,2,3);const Y=l.createIndexBuffer(G);return this._cachedMesh=new oh(z,Y,q),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(l){}}class na{constructor(l=0,m=0,v=0,_=0){if(isNaN(l)||l<0||isNaN(m)||m<0||isNaN(v)||v<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=m,this.left=v,this.right=_}interpolate(l,m,v){return m.top!=null&&l.top!=null&&(this.top=i.F.number(l.top,m.top,v)),m.bottom!=null&&l.bottom!=null&&(this.bottom=i.F.number(l.bottom,m.bottom,v)),m.left!=null&&l.left!=null&&(this.left=i.F.number(l.left,m.left,v)),m.right!=null&&l.right!=null&&(this.right=i.F.number(l.right,m.right,v)),this}getCenter(l,m){const v=i.ai((this.left+l-this.right)/2,0,l),_=i.ai((this.top+m-this.bottom)/2,0,m);return new i.P(v,_)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new na(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function gn(S,l){if(!S.renderWorldCopies||S.lngRange)return;const m=l.lng-S.center.lng;l.lng+=m>180?-360:m<-180?360:0}function mw(S){return Math.max(0,Math.floor(S))}class pi{constructor(l,m){var v;this._callbacks=l,this._tileSize=512,this._renderWorldCopies=(m==null?void 0:m.renderWorldCopies)===void 0||!!(m!=null&&m.renderWorldCopies),this._minZoom=(m==null?void 0:m.minZoom)||0,this._maxZoom=(m==null?void 0:m.maxZoom)||22,this._minPitch=(m==null?void 0:m.minPitch)==null?0:m==null?void 0:m.minPitch,this._maxPitch=(m==null?void 0:m.maxPitch)==null?60:m==null?void 0:m.maxPitch,this._constrain=(v=m==null?void 0:m.constrain)!==null&&v!==void 0?v:this._callbacks.constrain,this.setMaxBounds(),this._width=0,this._height=0,this._center=new i.U(0,0),this._elevation=0,this._zoom=0,this._tileZoom=mw(this._zoom),this._scale=i.al(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new na,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(l,m,v){this._latRange=l.latRange,this._lngRange=l.lngRange,this._width=l.width,this._height=l.height,this._center=l.center,this._elevation=l.elevation,this._minElevationForCurrentTile=l.minElevationForCurrentTile,this._zoom=l.zoom,this._tileZoom=mw(this._zoom),this._scale=i.al(this._zoom),this._bearingInRadians=l.bearingInRadians,this._fovInRadians=l.fovInRadians,this._pitchInRadians=l.pitchInRadians,this._rollInRadians=l.rollInRadians,this._unmodified=l.unmodified,this._edgeInsets=new na(l.padding.top,l.padding.bottom,l.padding.left,l.padding.right),this._minZoom=l.minZoom,this._maxZoom=l.maxZoom,this._minPitch=l.minPitch,this._maxPitch=l.maxPitch,this._renderWorldCopies=l.renderWorldCopies,this._cameraToCenterDistance=l.cameraToCenterDistance,this._nearZ=l.nearZ,this._farZ=l.farZ,this._autoCalculateNearFarZ=!v&&l.autoCalculateNearFarZ,m&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(l){this._minElevationForCurrentTile=l}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(l){this._minZoom!==l&&(this._minZoom=l,this.setZoom(this.constrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.setZoom(this.constrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(l){this._minPitch!==l&&(this._minPitch=l,this.setPitch(Math.max(this.pitch,l)))}get maxPitch(){return this._maxPitch}setMaxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.setPitch(Math.min(this.pitch,l)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get constrain(){return this._constrain}setConstrain(l){l||(l=this._callbacks.constrain),this._constrain=l,this.constrainInternal(),this._calcMatrices()}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(l){const m=i.V(l,-180,180)*Math.PI/180;var v,_,P,I,z,q,G,Y,le;this._bearingInRadians!==m&&(this._unmodified=!1,this._bearingInRadians=m,this._calcMatrices(),this._rotationMatrix=p(),v=this._rotationMatrix,P=-this._bearingInRadians,I=(_=this._rotationMatrix)[0],z=_[1],q=_[2],G=_[3],Y=Math.sin(P),le=Math.cos(P),v[0]=I*le+q*Y,v[1]=z*le+G*Y,v[2]=I*-Y+q*le,v[3]=z*-Y+G*le)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(l){const m=i.ai(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==m&&(this._unmodified=!1,this._pitchInRadians=m,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(l){const m=l/180*Math.PI;this._rollInRadians!==m&&(this._unmodified=!1,this._rollInRadians=m,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return i.aS(this._fovInRadians)}setFov(l){l=i.ai(l,.1,150),this.fov!==l&&(this._unmodified=!1,this._fovInRadians=i.ak(l),this._calcMatrices())}get zoom(){return this._zoom}setZoom(l){const m=this.constrain(this._center,l).zoom;this._zoom!==m&&(this._unmodified=!1,this._zoom=m,this._tileZoom=Math.max(0,Math.floor(m)),this._scale=i.al(m),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(l){l!==this._elevation&&(this._elevation=l,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(l,m){this._autoCalculateNearFarZ=!1,this._nearZ=l,this._farZ=m,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,m,v){this._unmodified=!1,this._edgeInsets.interpolate(l,m,v),this.constrainInternal(),this._calcMatrices()}resize(l,m,v=!0){this._width=l,this._height=m,v&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Dr([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(l){l?(this._lngRange=[l.getWest(),l.getEast()],this._latRange=[l.getSouth(),l.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-i.aj,i.aj])}getCameraQueryGeometry(l,m){if(m.length===1)return[m[0],l];{const{minX:v,minY:_,maxX:P,maxY:I}=i.a6.fromPoints(m).extend(l);return[new i.P(v,_),new i.P(P,_),new i.P(P,I),new i.P(v,I),new i.P(v,_)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const l=this._unmodified,{center:m,zoom:v}=this.constrain(this.center,this.zoom);this.setCenter(m),this.setZoom(v),this._unmodified=l,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let l=i.am(new Float64Array(16));i.O(l,l,[this._width/2,-this._height/2,1]),i.N(l,l,[1,-1,0]),this._clipSpaceToPixelsMatrix=l,l=i.am(new Float64Array(16)),i.O(l,l,[1,-1,1]),i.N(l,l,[-1,-1,0]),i.O(l,l,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=l,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(l,m,v,_){const P=v!==void 0?v:this.bearing,I=_=_!==void 0?_:this.pitch,z=i.a5.fromLngLat(l,m),q=-Math.cos(i.ak(I)),G=Math.sin(i.ak(I)),Y=G*Math.sin(i.ak(P)),le=-G*Math.cos(i.ak(P));let ie=this.elevation;const fe=m-ie;let _e;q*fe>=0||Math.abs(q)<.1?(_e=1e4,ie=m+_e*q):_e=-fe/q;let Ee,Oe,Re=i.aT(1,z.y),ze=0;do{if(ze+=1,ze>10)break;Oe=_e/Re,Ee=new i.a5(z.x+Y*Oe,z.y+le*Oe),Re=1/Ee.meterInMercatorCoordinateUnits()}while(Math.abs(_e-Oe*Re)>1e-12);return{center:Ee.toLngLat(),elevation:ie,zoom:i.ao(this.height/2/Math.tan(this.fovInRadians/2)/Oe/this.tileSize)}}recalculateZoomAndCenter(l){if(this.elevation-l==0)return;const m=i.an(1,this.center.lat)*this.worldSize,v=this.cameraToCenterDistance/m,_=i.a5.fromLngLat(this.center,this.elevation),P=ot(this.center,this.elevation,this.pitch,this.bearing,v);this._elevation=l;const I=this.calculateCenterFromCameraLngLatAlt(P.toLngLat(),i.aT(P.z,_.y),this.bearing,this.pitch);this._elevation=I.elevation,this._center=I.center,this.setZoom(I.zoom)}getCameraPoint(){const l=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(l*Math.sin(this.rollInRadians),l*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const l=i.an(1,this.center.lat)*this.worldSize;return ot(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/l).toLngLat()}getMercatorTileCoordinates(l){if(!l)return[0,0,1,1];const m=l.canonical.z>=0?1<<l.canonical.z:Math.pow(2,l.canonical.z);return[l.canonical.x/m,l.canonical.y/m,1/m/i.a3,1/m/i.a3]}}class Oi{constructor(l,m){this.min=l,this.max=m,this.center=i.aU([],i.aV([],this.min,this.max),.5)}quadrant(l){const m=[l%2==0,l<2],v=i.aW(this.min),_=i.aW(this.max);for(let P=0;P<m.length;P++)v[P]=m[P]?this.min[P]:this.center[P],_[P]=m[P]?this.center[P]:this.max[P];return _[2]=this.max[2],new Oi(v,_)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}intersectsFrustum(l){let m=!0;for(let v=0;v<l.planes.length;v++){const _=this.intersectsPlane(l.planes[v]);if(_===0)return 0;_===1&&(m=!1)}return m?2:l.aabb.min[0]>this.max[0]||l.aabb.min[1]>this.max[1]||l.aabb.min[2]>this.max[2]||l.aabb.max[0]<this.min[0]||l.aabb.max[1]<this.min[1]||l.aabb.max[2]<this.min[2]?0:1}intersectsPlane(l){let m=l[3],v=l[3];for(let _=0;_<3;_++)l[_]>0?(m+=l[_]*this.min[_],v+=l[_]*this.max[_]):(v+=l[_]*this.min[_],m+=l[_]*this.max[_]);return m>=0?2:v<0?0:1}}class fo{distanceToTile2d(l,m,v,_){const P=_.distanceX([l,m]),I=_.distanceY([l,m]);return Math.hypot(P,I)}getWrap(l,m,v){return v}getTileBoundingVolume(l,m,v,_){var P,I;let z=0,q=0;if(_!=null&&_.terrain){const Y=new i.a0(l.z,m,l.z,l.x,l.y),le=_.terrain.getMinMaxElevation(Y);z=(P=le.minElevation)!==null&&P!==void 0?P:Math.min(0,v),q=(I=le.maxElevation)!==null&&I!==void 0?I:Math.max(0,v)}const G=1<<l.z;return new Oi([m+l.x/G,l.y/G,z],[m+(l.x+1)/G,(l.y+1)/G,q])}allowVariableZoom(l,m){const v=l.fov*(Math.abs(Math.cos(l.rollInRadians))*l.height+Math.abs(Math.sin(l.rollInRadians))*l.width)/l.height,_=i.ai(78.5-v/2,0,60);return!!m.terrain||l.pitch>_}allowWorldCopies(){return!0}prepareNextFrame(){}}class Jm{constructor(l,m,v){this.points=l,this.planes=m,this.aabb=v}static fromInvProjectionMatrix(l,m=1,v=0,_,P){const I=P?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],z=Math.pow(2,v),q=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(ie=>function(fe,_e,Ee,Oe){const Re=i.aA([],fe,_e),ze=1/Re[3]/Ee*Oe;return i.a$(Re,Re,[ze,ze,1/Re[3],ze])}(ie,l,m,z));_&&function(ie,fe,_e,Ee){const Oe=Ee?4:0,Re=Ee?0:4;let ze=0;const Ue=[],$e=[];for(let Be=0;Be<4;Be++){const et=i.aX([],ie[Be+Re],ie[Be+Oe]),pt=i.b0(et);i.aU(et,et,1/pt),Ue.push(pt),$e.push(et)}for(let Be=0;Be<4;Be++){const et=i.b1(ie[Be+Oe],$e[Be],_e);ze=et!==null&&et>=0?Math.max(ze,et):Math.max(ze,Ue[Be])}const We=function(Be,et){const pt=i.aX([],Be[et[0]],Be[et[1]]),ut=i.aX([],Be[et[2]],Be[et[1]]),mt=[0,0,0,0];return i.aY(mt,i.aZ([],pt,ut)),mt[3]=-i.a_(mt,Be[et[0]]),mt}(ie,fe),Ye=function(Be,et){const pt=i.b2(Be),ut=i.b3([],Be,1/pt),mt=i.aX([],et,i.aU([],ut,i.a_(et,ut))),xt=i.b2(mt);if(xt>0){const Ut=Math.sqrt(1-ut[3]*ut[3]),Wt=i.aU([],ut,-ut[3]),Dt=i.aV([],Wt,i.aU([],mt,Ut/xt));return i.b4(et,Dt)}return null}(_e,We);if(Ye!==null){const Be=Ye/i.a_($e[0],We);ze=Math.min(ze,Be)}for(let Be=0;Be<4;Be++){const et=Math.min(ze,Ue[Be]);ie[Be+Re]=[ie[Be+Oe][0]+$e[Be][0]*et,ie[Be+Oe][1]+$e[Be][1]*et,ie[Be+Oe][2]+$e[Be][2]*et,1]}}(q,I[0],_,P);const G=I.map(ie=>{const fe=i.aX([],q[ie[0]],q[ie[1]]),_e=i.aX([],q[ie[2]],q[ie[1]]),Ee=i.aY([],i.aZ([],fe,_e)),Oe=-i.a_(Ee,q[ie[1]]);return Ee.concat(Oe)}),Y=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],le=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const ie of q)for(let fe=0;fe<3;fe++)Y[fe]=Math.min(Y[fe],ie[fe]),le[fe]=Math.max(le[fe],ie[fe]);return new Jm(q,G,new Oi(Y,le))}}class Pl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(l){this._helper.setMinZoom(l)}setMaxZoom(l){this._helper.setMaxZoom(l)}setMinPitch(l){this._helper.setMinPitch(l)}setMaxPitch(l){this._helper.setMaxPitch(l)}setRenderWorldCopies(l){this._helper.setRenderWorldCopies(l)}setBearing(l){this._helper.setBearing(l)}setPitch(l){this._helper.setPitch(l)}setRoll(l){this._helper.setRoll(l)}setFov(l){this._helper.setFov(l)}setZoom(l){this._helper.setZoom(l)}setCenter(l){this._helper.setCenter(l)}setElevation(l){this._helper.setElevation(l)}setMinElevationForCurrentTile(l){this._helper.setMinElevationForCurrentTile(l)}setPadding(l){this._helper.setPadding(l)}interpolatePadding(l,m,v){return this._helper.interpolatePadding(l,m,v)}isPaddingEqual(l){return this._helper.isPaddingEqual(l)}resize(l,m,v=!0){this._helper.resize(l,m,v)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(l){this._helper.setMaxBounds(l)}setConstrain(l){this._helper.setConstrain(l)}overrideNearFarZ(l,m){this._helper.overrideNearFarZ(l,m)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(l){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),l)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrain(){return this._helper.constrain}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(l,m){}constructor(l){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(m,v)=>{v=i.ai(+v,this.minZoom,this.maxZoom);const _={center:new i.U(m.lng,m.lat),zoom:v};let P=this._helper._lngRange;if(!this._helper._renderWorldCopies&&P===null){const $e=179.9999999999;P=[-$e,$e]}const I=this.tileSize*i.al(_.zoom);let z=0,q=I,G=0,Y=I,le=0,ie=0;const{x:fe,y:_e}=this.size;if(this._helper._latRange){const $e=this._helper._latRange;z=i.W($e[1])*I,q=i.W($e[0])*I,q-z<_e&&(le=_e/(q-z))}P&&(G=i.V(i.X(P[0])*I,0,I),Y=i.V(i.X(P[1])*I,0,I),Y<G&&(Y+=I),Y-G<fe&&(ie=fe/(Y-G)));const{x:Ee,y:Oe}=ft(I,m);let Re,ze;const Ue=Math.max(ie||0,le||0);if(Ue){const $e=new i.P(ie?(Y+G)/2:Ee,le?(q+z)/2:Oe);return _.center=$t(I,$e).wrap(),_.zoom+=i.ao(Ue),_}if(this._helper._latRange){const $e=_e/2;Oe-$e<z&&(ze=z+$e),Oe+$e>q&&(ze=q-$e)}if(P){const $e=(G+Y)/2;let We=Ee;this._helper._renderWorldCopies&&(We=i.V(Ee,$e-I/2,$e+I/2));const Ye=fe/2;We-Ye<G&&(Re=G+Ye),We+Ye>Y&&(Re=Y-Ye)}if(Re!==void 0||ze!==void 0){const $e=new i.P(Re??Ee,ze??Oe);_.center=$t(I,$e).wrap()}return _},this._helper=new pi({calcMatrices:()=>{this._calcMatrices()},constrain:(m,v)=>this.defaultConstrain(m,v)},l),this._coveringTilesDetailsProvider=new fo}clone(){const l=new Pl;return l.apply(this),l}apply(l,m,v){this._helper.apply(l,m,v)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(l){const m=[new i.b5(0,l)];if(this._helper._renderWorldCopies){const v=this.screenPointToMercatorCoordinate(new i.P(0,0)),_=this.screenPointToMercatorCoordinate(new i.P(this._helper._width,0)),P=this.screenPointToMercatorCoordinate(new i.P(this._helper._width,this._helper._height)),I=this.screenPointToMercatorCoordinate(new i.P(0,this._helper._height)),z=Math.floor(Math.min(v.x,_.x,P.x,I.x)),q=Math.floor(Math.max(v.x,_.x,P.x,I.x)),G=1;for(let Y=z-G;Y<=q+G;Y++)Y!==0&&m.push(new i.b5(Y,l))}return m}getCameraFrustum(){return Jm.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(l){const m=this.screenPointToLocation(this.centerPoint,l),v=l?l.getElevationForLngLatZoom(m,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(v)}setLocationAtPoint(l,m){const v=i.an(this.elevation,this.center.lat),_=this.screenPointToMercatorCoordinateAtZ(m,v),P=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,v),I=i.a5.fromLngLat(l),z=new i.a5(I.x-(_.x-P.x),I.y-(_.y-P.y));this.setCenter(z==null?void 0:z.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(l,m){return m?this.coordinatePoint(i.a5.fromLngLat(l),m.getElevationForLngLatZoom(l,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(i.a5.fromLngLat(l))}screenPointToLocation(l,m){var v;return(v=this.screenPointToMercatorCoordinate(l,m))===null||v===void 0?void 0:v.toLngLat()}screenPointToMercatorCoordinate(l,m){if(m){const v=m.pointCoordinate(l);if(v!=null)return v}return this.screenPointToMercatorCoordinateAtZ(l)}screenPointToMercatorCoordinateAtZ(l,m){const v=m||0,_=[l.x,l.y,0,1],P=[l.x,l.y,1,1];i.aA(_,_,this._pixelMatrixInverse),i.aA(P,P,this._pixelMatrixInverse);const I=_[3],z=P[3],q=_[1]/I,G=P[1]/z,Y=_[2]/I,le=P[2]/z,ie=Y===le?0:(v-Y)/(le-Y);return new i.a5(i.F.number(_[0]/I,P[0]/z,ie)/this.worldSize,i.F.number(q,G,ie)/this.worldSize,v)}coordinatePoint(l,m=0,v=this._pixelMatrix){const _=[l.x*this.worldSize,l.y*this.worldSize,m,1];return i.aA(_,_,v),new i.P(_[0]/_[3],_[1]/_[3])}getBounds(){const l=Math.max(0,this._helper._height/2-Pt(this));return new Dr().extend(this.screenPointToLocation(new i.P(0,l))).extend(this.screenPointToLocation(new i.P(this._helper._width,l))).extend(this.screenPointToLocation(new i.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new i.P(0,this._helper._height)))}isPointOnMapSurface(l,m){return m?m.pointCoordinate(l)!=null:l.y>this.height/2-Pt(this)}calculatePosMatrix(l,m=!1,v){var _;const P=(_=l.key)!==null&&_!==void 0?_:i.b6(l.wrap,l.canonical.z,l.canonical.z,l.canonical.x,l.canonical.y),I=m?this._alignedPosMatrixCache:this._posMatrixCache;if(I.has(P)){const G=I.get(P);return v?G.f32:G.f64}const z=br(l,this.worldSize);i.Q(z,m?this._alignedProjMatrix:this._viewProjMatrix,z);const q={f64:z,f32:new Float32Array(z)};return I.set(P,q),v?q.f32:q.f64}calculateFogMatrix(l){const m=l.key,v=this._fogMatrixCacheF32;if(v.has(m))return v.get(m);const _=br(l,this.worldSize);return i.Q(_,this._fogMatrix,_),v.set(m,new Float32Array(_)),v.get(m)}calculateCenterFromCameraLngLatAlt(l,m,v,_){return this._helper.calculateCenterFromCameraLngLatAlt(l,m,v,_)}_calculateNearFarZIfNeeded(l,m,v){if(!this._helper.autoCalculateNearFarZ)return;const _=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),P=l-_*this._helper._pixelPerMeter/Math.cos(m),I=_<0?P:l,z=Math.PI/2+this.pitchInRadians,q=i.ak(this.fov)*(Math.abs(Math.cos(i.ak(this.roll)))*this.height+Math.abs(Math.sin(i.ak(this.roll)))*this.width)/this.height*(.5+v.y/this.height),G=Math.sin(q)*I/Math.sin(i.ai(Math.PI-z-q,.01,Math.PI-.01)),Y=Pt(this),le=Math.atan(Y/this._helper.cameraToCenterDistance),ie=i.ak(.75),fe=le>ie?2*le*(.5+v.y/(2*Y)):ie,_e=Math.sin(fe)*I/Math.sin(i.ai(Math.PI-z-fe,.01,Math.PI-.01)),Ee=Math.min(G,_e);this._helper._farZ=1.01*(Math.cos(Math.PI/2-m)*Ee+I),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const l=this.centerOffset,m=ft(this.worldSize,this.center),v=m.x,_=m.y;this._helper._pixelPerMeter=i.an(1,this.center.lat)*this.worldSize;const P=i.ak(Math.min(this.pitch,rt)),I=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(P));let z;this._calculateNearFarZIfNeeded(I,P,l),z=new Float64Array(16),i.b7(z,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),i.au(this._invProjMatrix,z),z[8]=2*-l.x/this._helper._width,z[9]=2*l.y/this._helper._height,this._projectionMatrix=i.b8(z),i.O(z,z,[1,-1,1]),i.N(z,z,[0,0,-this._helper.cameraToCenterDistance]),i.b9(z,z,-this.rollInRadians),i.ba(z,z,this.pitchInRadians),i.b9(z,z,-this.bearingInRadians),i.N(z,z,[-v,-_,0]),this._mercatorMatrix=i.O([],z,[this.worldSize,this.worldSize,this.worldSize]),i.O(z,z,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=i.Q(new Float64Array(16),this.clipSpaceToPixelsMatrix,z),i.N(z,z,[0,0,-this.elevation]),this._viewProjMatrix=z,this._invViewProjMatrix=i.au([],z);const q=[0,0,-1,1];i.aA(q,q,this._invViewProjMatrix),this._cameraPosition=[q[0]/q[3],q[1]/q[3],q[2]/q[3]],this._fogMatrix=new Float64Array(16),i.b7(this._fogMatrix,this.fovInRadians,this.width/this.height,I,this._helper._farZ),this._fogMatrix[8]=2*-l.x/this.width,this._fogMatrix[9]=2*l.y/this.height,i.O(this._fogMatrix,this._fogMatrix,[1,-1,1]),i.N(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),i.b9(this._fogMatrix,this._fogMatrix,-this.rollInRadians),i.ba(this._fogMatrix,this._fogMatrix,this.pitchInRadians),i.b9(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),i.N(this._fogMatrix,this._fogMatrix,[-v,-_,0]),i.O(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),i.N(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=i.Q(new Float64Array(16),this.clipSpaceToPixelsMatrix,z);const G=this._helper._width%2/2,Y=this._helper._height%2/2,le=Math.cos(this.bearingInRadians),ie=Math.sin(-this.bearingInRadians),fe=v-Math.round(v)+le*G+ie*Y,_e=_-Math.round(_)+le*Y+ie*G,Ee=new Float64Array(z);if(i.N(Ee,Ee,[fe>.5?fe-1:fe,_e>.5?_e-1:_e,0]),this._alignedProjMatrix=Ee,z=i.au(new Float64Array(16),this._pixelMatrix),!z)throw new Error("failed to invert matrix");this._pixelMatrixInverse=z,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const l=this.screenPointToMercatorCoordinate(new i.P(0,0)),m=[l.x*this.worldSize,l.y*this.worldSize,0,1];return i.aA(m,m,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const l=i.an(1,this.center.lat)*this.worldSize;return ot(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/l).toLngLat()}lngLatToCameraDepth(l,m){const v=i.a5.fromLngLat(l),_=[v.x*this.worldSize,v.y*this.worldSize,m,1];return i.aA(_,_,this._viewProjMatrix),_[2]/_[3]}getProjectionData(l){const{overscaledTileID:m,aligned:v,applyTerrainMatrix:_}=l,P=this._helper.getMercatorTileCoordinates(m),I=m?this.calculatePosMatrix(m,v,!0):null;let z;return z=m&&m.terrainRttPosMatrix32f&&_?m.terrainRttPosMatrix32f:I||i.bb(),{mainMatrix:z,tileMercatorCoords:P,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:z}}isLocationOccluded(l){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(l,m,v){return 1}transformLightDirection(l){return i.aW(l)}getRayDirectionFromPixel(l){throw new Error("Not implemented.")}projectTileCoordinates(l,m,v,_){const P=this.calculatePosMatrix(v);let I;_?(I=[l,m,_(l,m),1],i.aA(I,I,P)):(I=[l,m,0,1],Vd(I,I,P));const z=I[3];return{point:new i.P(I[0]/z,I[1]/z),signedDistanceFromCamera:z,isOccluded:!1}}populateCache(l){for(const m of l)this.calculatePosMatrix(m)}getMatrixForModel(l,m){const v=i.a5.fromLngLat(l,m),_=v.meterInMercatorCoordinateUnits(),P=i.bc();return i.N(P,P,[v.x,v.y,v.z]),i.b9(P,P,Math.PI),i.ba(P,P,Math.PI/2),i.O(P,P,[-_,_,_]),P}getProjectionDataForCustomLayer(l=!0){const m=new i.a0(0,0,0,0,0),v=this.getProjectionData({overscaledTileID:m,applyGlobeMatrix:l}),_=br(m,this.worldSize);i.Q(_,this._viewProjMatrix,_),v.tileMercatorCoords=[0,0,1,1];const P=[i.a3,i.a3,this.worldSize/this._helper.pixelsPerMeter],I=i.bd();return i.O(I,_,P),v.fallbackMatrix=I,v.mainMatrix=I,v}getFastPathSimpleProjectionMatrix(l){return this.calculatePosMatrix(l)}}function Xn(){i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function lh(S){if(S.useSlerp)if(S.k<1){const l=i.be(S.startEulerAngles.roll,S.startEulerAngles.pitch,S.startEulerAngles.bearing),m=i.be(S.endEulerAngles.roll,S.endEulerAngles.pitch,S.endEulerAngles.bearing),v=new Float64Array(4);i.bf(v,l,m,S.k);const _=i.bg(v);S.tr.setRoll(_.roll),S.tr.setPitch(_.pitch),S.tr.setBearing(_.bearing)}else S.tr.setRoll(S.endEulerAngles.roll),S.tr.setPitch(S.endEulerAngles.pitch),S.tr.setBearing(S.endEulerAngles.bearing);else S.tr.setRoll(i.F.number(S.startEulerAngles.roll,S.endEulerAngles.roll,S.k)),S.tr.setPitch(i.F.number(S.startEulerAngles.pitch,S.endEulerAngles.pitch,S.k)),S.tr.setBearing(i.F.number(S.startEulerAngles.bearing,S.endEulerAngles.bearing,S.k))}function td(S,l,m,v,_){const P=_.padding,I=ft(_.worldSize,m.getNorthWest()),z=ft(_.worldSize,m.getNorthEast()),q=ft(_.worldSize,m.getSouthEast()),G=ft(_.worldSize,m.getSouthWest()),Y=i.ak(-v),le=I.rotate(Y),ie=z.rotate(Y),fe=q.rotate(Y),_e=G.rotate(Y),Ee=new i.P(Math.max(le.x,ie.x,_e.x,fe.x),Math.max(le.y,ie.y,_e.y,fe.y)),Oe=new i.P(Math.min(le.x,ie.x,_e.x,fe.x),Math.min(le.y,ie.y,_e.y,fe.y)),Re=Ee.sub(Oe),ze=(_.width-(P.left+P.right+l.left+l.right))/Re.x,Ue=(_.height-(P.top+P.bottom+l.top+l.bottom))/Re.y;if(Ue<0||ze<0)return void Xn();const $e=Math.min(i.ao(_.scale*Math.min(ze,Ue)),S.maxZoom),We=i.P.convert(S.offset),Ye=new i.P((l.left-l.right)/2,(l.top-l.bottom)/2).rotate(i.ak(v)),Be=We.add(Ye).mult(_.scale/i.al($e));return{center:$t(_.worldSize,I.add(q).div(2).sub(Be)),zoom:$e,bearing:v}}class Gd{get useGlobeControls(){return!1}handlePanInertia(l,m){const v=l.mag(),_=Math.abs(Pt(m));return{easingOffset:l.mult(Math.min(.75*_/v,1)),easingCenter:m.center}}handleMapControlsRollPitchBearingZoom(l,m){l.bearingDelta&&m.setBearing(m.bearing+l.bearingDelta),l.pitchDelta&&m.setPitch(m.pitch+l.pitchDelta),l.rollDelta&&m.setRoll(m.roll+l.rollDelta),l.zoomDelta&&m.setZoom(m.zoom+l.zoomDelta)}handleMapControlsPan(l,m,v){l.around.distSqr(m.centerPoint)<.01||m.setLocationAtPoint(v,l.around)}cameraForBoxAndBearing(l,m,v,_,P){return td(l,m,v,_,P)}handleJumpToCenterZoom(l,m){l.zoom!==(m.zoom!==void 0?+m.zoom:l.zoom)&&l.setZoom(+m.zoom),m.center!==void 0&&l.setCenter(i.U.convert(m.center))}handleEaseTo(l,m){const v=l.zoom,_=l.padding,P={roll:l.roll,pitch:l.pitch,bearing:l.bearing},I={roll:m.roll===void 0?l.roll:m.roll,pitch:m.pitch===void 0?l.pitch:m.pitch,bearing:m.bearing===void 0?l.bearing:m.bearing},z=m.zoom!==void 0,q=!l.isPaddingEqual(m.padding);let G=!1;const Y=z?+m.zoom:l.zoom;let le=l.centerPoint.add(m.offsetAsPoint);const ie=l.screenPointToLocation(le),{center:fe,zoom:_e}=l.constrain(i.U.convert(m.center||ie),Y??v);gn(l,fe);const Ee=ft(l.worldSize,ie),Oe=ft(l.worldSize,fe).sub(Ee),Re=i.al(_e-v);return G=_e!==v,{easeFunc:ze=>{if(G&&l.setZoom(i.F.number(v,_e,ze)),i.bh(P,I)||lh({startEulerAngles:P,endEulerAngles:I,tr:l,k:ze,useSlerp:P.roll!=I.roll}),q&&(l.interpolatePadding(_,m.padding,ze),le=l.centerPoint.add(m.offsetAsPoint)),m.around)l.setLocationAtPoint(m.around,m.aroundPoint);else{const Ue=i.al(l.zoom-v),$e=_e>v?Math.min(2,Re):Math.max(.5,Re),We=Math.pow($e,1-ze),Ye=$t(l.worldSize,Ee.add(Oe.mult(ze*We)).mult(Ue));l.setLocationAtPoint(l.renderWorldCopies?Ye.wrap():Ye,le)}},isZooming:G,elevationCenter:fe}}handleFlyTo(l,m){const v=m.zoom!==void 0,_=l.zoom,P=l.constrain(i.U.convert(m.center||m.locationAtOffset),v?+m.zoom:_),I=P.center,z=P.zoom;gn(l,I);const q=ft(l.worldSize,m.locationAtOffset),G=ft(l.worldSize,I).sub(q),Y=G.mag(),le=i.al(z-_);let ie;if(m.minZoom!==void 0){const fe=Math.min(+m.minZoom,_,z),_e=l.constrain(I,fe).zoom;ie=i.al(_e-_)}return{easeFunc:(fe,_e,Ee,Oe)=>{l.setZoom(fe===1?z:_+i.ao(_e));const Re=fe===1?I:$t(l.worldSize,q.add(G.mult(Ee)).mult(_e));l.setLocationAtPoint(l.renderWorldCopies?Re.wrap():Re,Oe)},scaleOfZoom:le,targetCenter:I,scaleOfMinZoom:ie,pixelPathLength:Y}}}class Ts{constructor(l,m,v){this.blendFunction=l,this.blendColor=m,this.mask=v}}Ts.Replace=[1,0],Ts.disabled=new Ts(Ts.Replace,i.bi.transparent,[!1,!1,!1,!1]),Ts.unblended=new Ts(Ts.Replace,i.bi.transparent,[!0,!0,!0,!0]),Ts.alphaBlended=new Ts([1,771],i.bi.transparent,[!0,!0,!0,!0]);const Yp=2305;class ds{constructor(l,m,v){this.enable=l,this.mode=m,this.frontFace=v}}ds.disabled=new ds(!1,1029,Yp),ds.backCCW=new ds(!0,1029,Yp),ds.frontCCW=new ds(!0,1028,Yp);class os{constructor(l,m,v){this.func=l,this.mask=m,this.range=v}}os.ReadOnly=!1,os.ReadWrite=!0,os.disabled=new os(519,os.ReadOnly,[0,1]);const Xp=7680;class Cs{constructor(l,m,v,_,P,I){this.test=l,this.ref=m,this.mask=v,this.fail=_,this.depthFail=P,this.pass=I}}Cs.disabled=new Cs({func:519,mask:0},0,0,Xp,Xp,Xp);const ch=new WeakMap;function To(S){var l;if(ch.has(S))return ch.get(S);{const m=(l=S.getParameter(S.VERSION))===null||l===void 0?void 0:l.startsWith("WebGL 2.0");return ch.set(S,m),m}}class ef{get awaitingQuery(){return!!this._readbackQueue}constructor(l){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=l;const m=l.context,v=m.gl;this._texFormat=v.RGBA,this._texType=v.UNSIGNED_BYTE;const _=new i.aP;_.emplaceBack(-1,-1),_.emplaceBack(2,-1),_.emplaceBack(-1,2);const P=new i.aR;P.emplaceBack(0,1,2),this._fullscreenTriangle=new oh(m.createVertexBuffer(_,Cl.members),m.createIndexBuffer(P),i.aQ.simpleSegment(0,0,_.length,P.length)),this._resultBuffer=new Uint8Array(4),m.activeTexture.set(v.TEXTURE1);const I=v.createTexture();v.bindTexture(v.TEXTURE_2D,I),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,v.NEAREST),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,v.NEAREST),v.texImage2D(v.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=m.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(I),To(v)&&(this._pbo=v.createBuffer(),v.bindBuffer(v.PIXEL_PACK_BUFFER,this._pbo),v.bufferData(v.PIXEL_PACK_BUFFER,4,v.STREAM_READ),v.bindBuffer(v.PIXEL_PACK_BUFFER,null))}destroy(){const l=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),l.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(l,m){const v=this._updateCount;return this._readbackQueue?v>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():v>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(l,m),this._updateCount++,this._measuredError}_bindFramebuffer(){const l=this._cachedRenderContext.context,m=l.gl;l.activeTexture.set(m.TEXTURE1),m.bindTexture(m.TEXTURE_2D,this._fbo.colorAttachment.get()),l.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(l,m){const v=this._cachedRenderContext.context,_=v.gl;if(this._bindFramebuffer(),v.viewport.set([0,0,this._texWidth,this._texHeight]),v.clear({color:i.bi.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(v,_.TRIANGLES,os.disabled,Cs.disabled,Ts.unblended,ds.disabled,((P,I)=>({u_input:P,u_output_expected:I}))(l,m),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&To(_)){_.bindBuffer(_.PIXEL_PACK_BUFFER,this._pbo),_.readBuffer(_.COLOR_ATTACHMENT0),_.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),_.bindBuffer(_.PIXEL_PACK_BUFFER,null);const P=_.fenceSync(_.SYNC_GPU_COMMANDS_COMPLETE,0);_.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:P}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const l=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&To(l)){const m=l.clientWaitSync(this._readbackQueue.sync,0,0);if(m===l.WAIT_FAILED)return i.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(m===l.TIMEOUT_EXPIRED)return;l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),l.bindBuffer(l.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),l.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=ef._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(l){let m=0;return m+=l[0]/256,m+=l[1]/65536,m+=l[2]/16777216,l[3]<127&&(m=-m),m/128}}const dh=i.a3/128;function tf(S,l){const m=S.granularity!==void 0?Math.max(S.granularity,1):1,v=m+(S.generateBorders?2:0),_=m+(S.extendToNorthPole||S.generateBorders?1:0)+(S.extendToSouthPole||S.generateBorders?1:0),P=v+1,I=_+1,z=S.generateBorders?-1:0,q=S.generateBorders||S.extendToNorthPole?-1:0,G=m+(S.generateBorders?1:0),Y=m+(S.generateBorders||S.extendToSouthPole?1:0),le=P*I,ie=v*_*6,fe=P*I>65536;if(fe&&l==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const _e=fe||l==="32bit",Ee=new Int16Array(2*le);let Oe=0;for(let Ue=q;Ue<=Y;Ue++)for(let $e=z;$e<=G;$e++){let We=$e/m*i.a3;$e===-1&&(We=-dh),$e===m+1&&(We=i.a3+dh);let Ye=Ue/m*i.a3;Ue===-1&&(Ye=S.extendToNorthPole?i.bk:-dh),Ue===m+1&&(Ye=S.extendToSouthPole?i.bl:i.a3+dh),Ee[Oe++]=We,Ee[Oe++]=Ye}const Re=_e?new Uint32Array(ie):new Uint16Array(ie);let ze=0;for(let Ue=0;Ue<_;Ue++)for(let $e=0;$e<v;$e++){const We=$e+1+Ue*P,Ye=$e+(Ue+1)*P,Be=$e+1+(Ue+1)*P;Re[ze++]=$e+Ue*P,Re[ze++]=Ye,Re[ze++]=We,Re[ze++]=We,Re[ze++]=Ye,Re[ze++]=Be}return{vertices:Ee.buffer.slice(0),indices:Re.buffer.slice(0),uses32bitIndices:_e}}const rf=new i.aO({fill:new i.bm(128,2),line:new i.bm(512,0),tile:new i.bm(128,32),stencil:new i.bm(128,1),circle:3});class Qp{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Kr.projectionGlobe}get vertexShaderPreludeCode(){return Kr.projectionMercator.vertexSource}get subdivisionGranularity(){return rf}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(l){this._errorMeasurement||(this._errorMeasurement=new ef(l));const m=i.W(this._errorQueryLatitudeDegrees),v=2*Math.atan(Math.exp(Math.PI-m*Math.PI*2))-.5*Math.PI,_=this._errorMeasurement.updateErrorLoop(m,v),P=T();_!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=_,this._errorMeasurementLastChangeTime=P);const I=Math.min(Math.max((P-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=i.bn(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,i.bo(I))}_getMeshKey(l){return`${l.granularity.toString(36)}_${l.generateBorders?"b":""}${l.extendToNorthPole?"n":""}${l.extendToSouthPole?"s":""}`}getMeshFromTileID(l,m,v,_,P){const I=(P==="stencil"?rf.stencil:rf.tile).getGranularityForZoomLevel(m.z);return this._getMesh(l,{granularity:I,generateBorders:v,extendToNorthPole:m.y===0&&_,extendToSouthPole:m.y===(1<<m.z)-1&&_})}_getMesh(l,m){const v=this._getMeshKey(m);if(v in this._tileMeshCache)return this._tileMeshCache[v];const _=function(P,I){const z=tf(I,"16bit"),q=i.aP.deserialize({arrayBuffer:z.vertices,length:z.vertices.byteLength/2/2}),G=i.aR.deserialize({arrayBuffer:z.indices,length:z.indices.byteLength/2/3});return new oh(P.createVertexBuffer(q,Cl.members),P.createIndexBuffer(G),i.aQ.simpleSegment(0,0,q.length,G.length))}(l,m);return this._tileMeshCache[v]=_,_}recalculate(l){}hasTransition(){const l=T();let m=!1;return m=m||(l-this._errorMeasurementLastChangeTime)/1e3<.7,m=m||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,m}setErrorQueryLatitudeDegrees(l){this._errorQueryLatitudeDegrees=l}}const Jp=new i.r({type:new i.D(i.t.projection.type)});class sf extends i.E{constructor(l){super(),this._transitionable=new i.x(Jp,void 0),this.setProjection(l),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new i.G(0)),this._mercatorProjection=new Qa,this._verticalPerspectiveProjection=new Qp}get transitionState(){const l=this.properties.get("type");if(typeof l=="string"&&l==="mercator")return 0;if(typeof l=="string"&&l==="vertical-perspective")return 1;if(l instanceof i.bp){if(l.from==="vertical-perspective"&&l.to==="mercator")return 1-l.transition;if(l.from==="mercator"&&l.to==="vertical-perspective")return l.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(l){this._mercatorProjection.updateGPUdependent(l),this._verticalPerspectiveProjection.updateGPUdependent(l)}getMeshFromTileID(l,m,v,_,P){return this.currentProjection.getMeshFromTileID(l,m,v,_,P)}setProjection(l){this._transitionable.setValue("type",(l==null?void 0:l.type)||"mercator")}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}setErrorQueryLatitudeDegrees(l){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(l),this._mercatorProjection.setErrorQueryLatitudeDegrees(l)}}function uh(S){const l=nf(S.worldSize,S.center.lat);return 2*Math.PI*l}function rd(S,l,m,v,_){const P=1/(1<<_),I=l/i.a3*P+v*P,z=i.br((S/i.a3*P+m*P)*Math.PI*2+Math.PI,2*Math.PI),q=2*Math.atan(Math.exp(Math.PI-I*Math.PI*2))-.5*Math.PI,G=Math.cos(q),Y=new Float64Array(3);return Y[0]=Math.sin(z)*G,Y[1]=Math.sin(q),Y[2]=Math.cos(z)*G,Y}function Oa(S){return function(l,m){const v=Math.cos(m),_=new Float64Array(3);return _[0]=Math.sin(l)*v,_[1]=Math.sin(m),_[2]=Math.cos(l)*v,_}(S.lng*Math.PI/180,S.lat*Math.PI/180)}function nf(S,l){return S/(2*Math.PI)/Math.cos(l*Math.PI/180)}function fw(S){const l=Math.asin(S[1])/Math.PI*180,m=Math.sqrt(S[0]*S[0]+S[2]*S[2]);if(m>1e-6){const v=S[0]/m,_=Math.acos(S[2]/m),P=(v>0?_:-_)/Math.PI*180;return new i.U(i.V(P,-180,180),l)}return new i.U(0,l)}function ex(S){return Math.cos(S*Math.PI/180)}function Gs(S,l){const m=ex(S),v=ex(l);return i.ao(v/m)}function tx(S,l){const m=S.rotate(l.bearingInRadians),v=l.zoom+Gs(l.center.lat,0),_=i.bn(1/ex(l.center.lat),1/ex(Math.min(Math.abs(l.center.lat),60)),i.bq(v,7,3,0,1)),P=360/uh({worldSize:l.worldSize,center:{lat:l.center.lat}});return new i.U(l.center.lng-m.x*P*_,i.ai(l.center.lat+m.y*P,-i.aj,i.aj))}function Eo(S){const l=.5*S,m=Math.sin(l),v=Math.cos(l);return Math.log(m+v)-Math.log(v-m)}function af(S,l,m,v){const _=S.lat+m*v;if(Math.abs(m)>1){const P=(Math.sign(S.lat+m)!==Math.sign(S.lat)?-Math.abs(S.lat):Math.abs(S.lat))*Math.PI/180,I=Math.abs(S.lat+m)*Math.PI/180,z=Eo(P+v*(I-P)),q=Eo(P),G=Eo(I);return new i.U(S.lng+l*((z-q)/(G-q)),_)}return new i.U(S.lng+l*v,_)}class pw{constructor(l){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=l}swapBuffers(){if(!this._hadAnyChanges)return;const l=this._cachePrevious;this._cachePrevious=this._cache,this._cache=l,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(l,m,v,_){const P=`${l.z}_${l.x}_${l.y}_${_!=null&&_.terrain?"t":""}`,I=this._cache.get(P);if(I)return I;const z=this._cachePrevious.get(P);if(z)return this._cache.set(P,z),z;const q=this._boundingVolumeFactory(l,m,v,_);return this._cache.set(P,q),this._hadAnyChanges=!0,q}}class Kd{constructor(l,m,v,_){this.min=v,this.max=_,this.points=l,this.planes=m}static fromAabb(l,m){const v=[];for(let _=0;_<8;_++)v.push([1&~_?l[0]:m[0],(_>>1&1)==1?m[1]:l[1],(_>>2&1)==1?m[2]:l[2]]);return new Kd(v,[[-1,0,0,m[0]],[1,0,0,-l[0]],[0,-1,0,m[1]],[0,1,0,-l[1]],[0,0,-1,m[2]],[0,0,1,-l[2]]],l,m)}static fromCenterSizeAngles(l,m,v){const _=i.bu([],v[0],v[1],v[2]),P=i.bv([],[m[0],0,0],_),I=i.bv([],[0,m[1],0],_),z=i.bv([],[0,0,m[2]],_),q=[...l],G=[...l];for(let le=0;le<8;le++)for(let ie=0;ie<3;ie++){const fe=l[ie]+P[ie]*(1&~le?-1:1)+I[ie]*((le>>1&1)==1?1:-1)+z[ie]*((le>>2&1)==1?1:-1);q[ie]=Math.min(q[ie],fe),G[ie]=Math.max(G[ie],fe)}const Y=[];for(let le=0;le<8;le++){const ie=[...l];i.aV(ie,ie,i.aU([],P,1&~le?-1:1)),i.aV(ie,ie,i.aU([],I,(le>>1&1)==1?1:-1)),i.aV(ie,ie,i.aU([],z,(le>>2&1)==1?1:-1)),Y.push(ie)}return new Kd(Y,[[...P,-i.a_(P,Y[0])],[...I,-i.a_(I,Y[0])],[...z,-i.a_(z,Y[0])],[-P[0],-P[1],-P[2],-i.a_(P,Y[7])],[-I[0],-I[1],-I[2],-i.a_(I,Y[7])],[-z[0],-z[1],-z[2],-i.a_(z,Y[7])]],q,G)}intersectsFrustum(l){let m=!0;const v=this.points.length,_=this.planes.length,P=l.planes.length,I=l.points.length;for(let z=0;z<P;z++){const q=l.planes[z];let G=0;for(let Y=0;Y<v;Y++){const le=this.points[Y];q[0]*le[0]+q[1]*le[1]+q[2]*le[2]+q[3]>=0&&G++}if(G===0)return 0;G<v&&(m=!1)}if(m)return 2;for(let z=0;z<_;z++){const q=this.planes[z];let G=0;for(let Y=0;Y<I;Y++){const le=l.points[Y];q[0]*le[0]+q[1]*le[1]+q[2]*le[2]+q[3]>=0&&G++}if(G===0)return 0}return 1}intersectsPlane(l){const m=this.points.length;let v=0;for(let _=0;_<m;_++){const P=this.points[_];l[0]*P[0]+l[1]*P[1]+l[2]*P[2]+l[3]>=0&&v++}return v===m?2:v===0?0:1}}function lc(S,l,m){const v=S-l;return v<0?-v:Math.max(0,v-m)}function Uv(S,l,m,v,_){const P=S-m;let I;return I=P<0?Math.min(-P,1+P-_):P>1?Math.min(Math.max(P-_,0),1-P):0,Math.max(I,lc(l,v,_))}class WP{constructor(){this._boundingVolumeCache=new pw(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(l,m,v,_){const P=1<<v.z,I=1/P,z=v.x/P,q=v.y/P;let G=2;return G=Math.min(G,Uv(l,m,z,q,I)),G=Math.min(G,Uv(l,m,z+.5,-q-I,I)),G=Math.min(G,Uv(l,m,z+.5,2-q-I,I)),G}getWrap(l,m,v){const _=1<<m.z,P=1/_,I=m.x/_,z=lc(l.x,I,P),q=lc(l.x,I-1,P),G=lc(l.x,I+1,P),Y=Math.min(z,q,G);return Y===G?1:Y===q?-1:0}allowVariableZoom(l,m){return fs(l,m)>4}allowWorldCopies(){return!1}getTileBoundingVolume(l,m,v,_){return this._boundingVolumeCache.getTileBoundingVolume(l,m,v,_)}_computeTileBoundingVolume(l,m,v,_){var P,I;let z=0,q=0;if(_!=null&&_.terrain){const G=new i.a0(l.z,m,l.z,l.x,l.y),Y=_.terrain.getMinMaxElevation(G);z=(P=Y.minElevation)!==null&&P!==void 0?P:Math.min(0,v),q=(I=Y.maxElevation)!==null&&I!==void 0?I:Math.max(0,v)}if(z/=i.bx,q/=i.bx,z+=1,q+=1,l.z<=0)return Kd.fromAabb([-q,-q,-q],[q,q,q]);if(l.z===1)return Kd.fromAabb([l.x===0?-q:0,l.y===0?0:-q,-q],[l.x===0?0:q,l.y===0?q:0,q]);{const G=[rd(0,0,l.x,l.y,l.z),rd(i.a3,0,l.x,l.y,l.z),rd(i.a3,i.a3,l.x,l.y,l.z),rd(0,i.a3,l.x,l.y,l.z)],Y=[];for(const mt of G)Y.push(i.aU([],mt,q));if(q!==z)for(const mt of G)Y.push(i.aU([],mt,z));l.y===0&&Y.push([0,1,0]),l.y===(1<<l.z)-1&&Y.push([0,-1,0]);const le=[1,1,1],ie=[-1,-1,-1];for(const mt of Y)for(let xt=0;xt<3;xt++)le[xt]=Math.min(le[xt],mt[xt]),ie[xt]=Math.max(ie[xt],mt[xt]);const fe=rd(i.a3/2,i.a3/2,l.x,l.y,l.z),_e=i.aZ([],[0,1,0],fe);i.aY(_e,_e);const Ee=i.aZ([],fe,_e);i.aY(Ee,Ee);const Oe=i.aZ([],G[2],G[1]);i.aY(Oe,Oe);const Re=i.aZ([],G[0],G[3]);i.aY(Re,Re),Y.push(i.aU([],fe,q)),l.y>=(1<<l.z)/2&&Y.push(i.aU([],rd(i.a3/2,0,l.x,l.y,l.z),q)),l.y<(1<<l.z)/2&&Y.push(i.aU([],rd(i.a3/2,i.a3,l.x,l.y,l.z),q));const ze=xw(fe,Y),Ue=xw(Ee,Y),$e=[-fe[0],-fe[1],-fe[2],ze.max],We=[fe[0],fe[1],fe[2],-ze.min],Ye=[-Ee[0],-Ee[1],-Ee[2],Ue.max],Be=[Ee[0],Ee[1],Ee[2],-Ue.min],et=[...Oe,0],pt=[...Re,0],ut=[];return l.y===0?ut.push(i.bw(pt,et,$e),i.bw(pt,et,We)):ut.push(i.bw(Ye,et,$e),i.bw(Ye,et,We),i.bw(Ye,pt,$e),i.bw(Ye,pt,We)),l.y===(1<<l.z)-1?ut.push(i.bw(pt,et,$e),i.bw(pt,et,We)):ut.push(i.bw(Be,et,$e),i.bw(Be,et,We),i.bw(Be,pt,$e),i.bw(Be,pt,We)),new Kd(ut,[$e,We,Ye,Be,et,pt],le,ie)}}}function xw(S,l){let m=1/0,v=-1/0;for(const _ of l){const P=i.a_(S,_);m=Math.min(m,P),v=Math.max(v,P)}return{min:m,max:v}}class rx{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(l){this._helper.setMinZoom(l)}setMaxZoom(l){this._helper.setMaxZoom(l)}setMinPitch(l){this._helper.setMinPitch(l)}setMaxPitch(l){this._helper.setMaxPitch(l)}setRenderWorldCopies(l){this._helper.setRenderWorldCopies(l)}setBearing(l){this._helper.setBearing(l)}setPitch(l){this._helper.setPitch(l)}setRoll(l){this._helper.setRoll(l)}setFov(l){this._helper.setFov(l)}setZoom(l){this._helper.setZoom(l)}setCenter(l){this._helper.setCenter(l)}setElevation(l){this._helper.setElevation(l)}setMinElevationForCurrentTile(l){this._helper.setMinElevationForCurrentTile(l)}setPadding(l){this._helper.setPadding(l)}interpolatePadding(l,m,v){return this._helper.interpolatePadding(l,m,v)}isPaddingEqual(l){return this._helper.isPaddingEqual(l)}resize(l,m){this._helper.resize(l,m)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(l){this._helper.setMaxBounds(l)}setConstrain(l){this._helper.setConstrain(l)}overrideNearFarZ(l,m){this._helper.overrideNearFarZ(l,m)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(l){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),l)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrain(){return this._helper.constrain}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(l){}constructor(l){this._cachedClippingPlane=i.by(),this._projectionMatrix=i.bc(),this._globeViewProjMatrix32f=i.bb(),this._globeViewProjMatrixNoCorrection=i.bc(),this._globeViewProjMatrixNoCorrectionInverted=i.bc(),this._globeProjMatrixInverted=i.bc(),this._cameraPosition=i.bs(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(m,v)=>{const _=i.ai(m.lat,-i.aj,i.aj),P=i.ai(+v,this.minZoom+Gs(0,_),this.maxZoom);return{center:new i.U(m.lng,_),zoom:P}},this._helper=new pi({calcMatrices:()=>{this._calcMatrices()},constrain:(m,v)=>this.defaultConstrain(m,v)},l),this._coveringTilesDetailsProvider=new WP}clone(){const l=new rx;return l.apply(this),l}apply(l,m){this._globeLatitudeErrorCorrectionRadians=m||0,this._helper.apply(l)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const l=i.bs();return l[0]=this._cameraPosition[0],l[1]=this._cameraPosition[1],l[2]=this._cameraPosition[2],l}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(l){const{overscaledTileID:m,applyGlobeMatrix:v}=l,_=this._helper.getMercatorTileCoordinates(m);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:_,clippingPlane:this._cachedClippingPlane,projectionTransition:v?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(l){const m=this.pitchInRadians,v=this.cameraToCenterDistance/l,_=Math.sin(m)*v,P=Math.cos(m)*v+1,I=1/Math.sqrt(_*_+P*P)*1;let z=-_,q=P;const G=Math.sqrt(z*z+q*q);z/=G,q/=G;const Y=[0,z,q];i.bz(Y,Y,[0,0,0],-this.bearingInRadians),i.bA(Y,Y,[0,0,0],-1*this.center.lat*Math.PI/180),i.bB(Y,Y,[0,0,0],this.center.lng*Math.PI/180);const le=1/i.b0(Y);return i.aU(Y,Y,le),[...Y,-I*le]}isLocationOccluded(l){return!this.isSurfacePointVisible(Oa(l))}transformLightDirection(l){const m=this._helper._center.lng*Math.PI/180,v=this._helper._center.lat*Math.PI/180,_=Math.cos(v),P=[Math.sin(m)*_,Math.sin(v),Math.cos(m)*_],I=[P[2],0,-P[0]],z=[0,0,0];i.aZ(z,I,P),i.aY(I,I),i.aY(z,z);const q=[0,0,0];return i.aY(q,[I[0]*l[0]+z[0]*l[1]+P[0]*l[2],I[1]*l[0]+z[1]*l[1]+P[1]*l[2],I[2]*l[0]+z[2]*l[1]+P[2]*l[2]]),q}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(l,m,v){const _=function(z,q,G){const Y=1/(1<<G.z);return new i.a5(z/i.a3*Y+G.x*Y,q/i.a3*Y+G.y*Y)}(l,m,v.canonical),P=(I=_.y,[i.br(_.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-I*Math.PI*2))-.5*Math.PI]);var I;return this.getCircleRadiusCorrection()/Math.cos(P[1])}projectTileCoordinates(l,m,v,_){const P=v.canonical,I=rd(l,m,P.x,P.y,P.z),z=1+(_?_(l,m):0)/i.bx,q=[I[0]*z,I[1]*z,I[2]*z,1];i.aA(q,q,this._globeViewProjMatrixNoCorrection);const G=this._cachedClippingPlane,Y=G[0]*I[0]+G[1]*I[1]+G[2]*I[2]+G[3]<0;return{point:new i.P(q[0]/q[3],q[1]/q[3]),signedDistanceFromCamera:q[3],isOccluded:Y}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const l=nf(this.worldSize,this.center.lat),m=i.bd(),v=i.bd();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*l),i.b7(m,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const _=this.centerOffset;m[8]=2*-_.x/this._helper._width,m[9]=2*_.y/this._helper._height,this._projectionMatrix=i.b8(m),this._globeProjMatrixInverted=i.bd(),i.au(this._globeProjMatrixInverted,m),i.N(m,m,[0,0,-this.cameraToCenterDistance]),i.b9(m,m,this.rollInRadians),i.ba(m,m,-this.pitchInRadians),i.b9(m,m,this.bearingInRadians),i.N(m,m,[0,0,-l]);const P=i.bs();P[0]=l,P[1]=l,P[2]=l,i.ba(v,m,this.center.lat*Math.PI/180),i.bC(v,v,-this.center.lng*Math.PI/180),i.O(v,v,P),this._globeViewProjMatrixNoCorrection=v,i.ba(m,m,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),i.bC(m,m,-this.center.lng*Math.PI/180),i.O(m,m,P),this._globeViewProjMatrix32f=new Float32Array(m),this._globeViewProjMatrixNoCorrectionInverted=i.bd(),i.au(this._globeViewProjMatrixNoCorrectionInverted,v);const I=i.bs();this._cameraPosition=i.bs(),this._cameraPosition[2]=this.cameraToCenterDistance/l,i.bz(this._cameraPosition,this._cameraPosition,I,-this.rollInRadians),i.bA(this._cameraPosition,this._cameraPosition,I,this.pitchInRadians),i.bz(this._cameraPosition,this._cameraPosition,I,-this.bearingInRadians),i.aV(this._cameraPosition,this._cameraPosition,[0,0,1]),i.bA(this._cameraPosition,this._cameraPosition,I,-this.center.lat*Math.PI/180),i.bB(this._cameraPosition,this._cameraPosition,I,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(l);const z=i.b8(this._globeViewProjMatrixNoCorrectionInverted);i.O(z,z,[1,1,-1]),this._cachedFrustum=Jm.fromInvProjectionMatrix(z,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(l){i.w("calculateFogMatrix is not supported on globe projection.");const m=i.bd();return i.am(m),m}getVisibleUnwrappedCoordinates(l){return[new i.b5(0,l)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(l){l&&i.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(l,m){if(!this._globeViewProjMatrixNoCorrection)return 1;const v=Oa(l);i.aU(v,v,1+m/i.bx);const _=i.by();return i.aA(_,[v[0],v[1],v[2],1],this._globeViewProjMatrixNoCorrection),_[2]/_[3]}populateCache(l){}getBounds(){const l=.5*this.width,m=.5*this.height,v=[new i.P(0,0),new i.P(l,0),new i.P(this.width,0),new i.P(this.width,m),new i.P(this.width,this.height),new i.P(l,this.height),new i.P(0,this.height),new i.P(0,m)],_=[];for(const le of v)_.push(this.unprojectScreenPoint(le));let P=0,I=0,z=0,q=0;const G=this.center;for(const le of _){const ie=i.bD(G.lng,le.lng),fe=i.bD(G.lat,le.lat);ie<I&&(I=ie),ie>P&&(P=ie),fe<q&&(q=fe),fe>z&&(z=fe)}const Y=[G.lng+I,G.lat+q,G.lng+P,G.lat+z];return this.isSurfacePointOnScreen([0,1,0])&&(Y[3]=90,Y[0]=-180,Y[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(Y[1]=-90,Y[0]=-180,Y[2]=180),new Dr(Y)}calculateCenterFromCameraLngLatAlt(l,m,v,_){return this._helper.calculateCenterFromCameraLngLatAlt(l,m,v,_)}setLocationAtPoint(l,m){const v=Oa(this.unprojectScreenPoint(m)),_=Oa(l),P=i.bs();i.bE(P);const I=i.bs();i.bB(I,v,P,-this.center.lng*Math.PI/180),i.bA(I,I,P,this.center.lat*Math.PI/180);const z=_[0]*_[0]+_[2]*_[2],q=I[0]*I[0];if(z<q)return;const G=Math.sqrt(z-q),Y=-G,le=i.bF(_[0],_[2],I[0],G),ie=i.bF(_[0],_[2],I[0],Y),fe=i.bs();i.bB(fe,_,P,-le);const _e=i.bF(fe[1],fe[2],I[1],I[2]),Ee=i.bs();i.bB(Ee,_,P,-ie);const Oe=i.bF(Ee[1],Ee[2],I[1],I[2]),Re=.5*Math.PI,ze=_e>=-Re&&_e<=Re,Ue=Oe>=-Re&&Oe<=Re;let $e,We;if(ze&&Ue){const pt=this.center.lng*Math.PI/180,ut=this.center.lat*Math.PI/180;i.bG(le,pt)+i.bG(_e,ut)<i.bG(ie,pt)+i.bG(Oe,ut)?($e=le,We=_e):($e=ie,We=Oe)}else if(ze)$e=le,We=_e;else{if(!Ue)return;$e=ie,We=Oe}const Ye=$e/Math.PI*180,Be=We/Math.PI*180,et=this.center.lat;this.setCenter(new i.U(Ye,i.ai(Be,-90,90))),this.setZoom(this.zoom+Gs(et,this.center.lat))}locationToScreenPoint(l,m){const v=Oa(l);if(m){const _=m.getElevationForLngLatZoom(l,this._helper._tileZoom);i.aU(v,v,1+_/i.bx)}return this._projectSurfacePointToScreen(v)}_projectSurfacePointToScreen(l){const m=i.by();return i.aA(m,[...l,1],this._globeViewProjMatrixNoCorrection),m[0]/=m[3],m[1]/=m[3],new i.P((.5*m[0]+.5)*this.width,(.5*-m[1]+.5)*this.height)}screenPointToMercatorCoordinate(l,m){if(m){const v=m.pointCoordinate(l);if(v)return v}return i.a5.fromLngLat(this.unprojectScreenPoint(l))}screenPointToLocation(l,m){var v;return(v=this.screenPointToMercatorCoordinate(l,m))===null||v===void 0?void 0:v.toLngLat()}isPointOnMapSurface(l,m){const v=this._cameraPosition,_=this.getRayDirectionFromPixel(l);return!!this.rayPlanetIntersection(v,_)}getRayDirectionFromPixel(l){const m=i.by();m[0]=l.x/this.width*2-1,m[1]=-1*(l.y/this.height*2-1),m[2]=1,m[3]=1,i.aA(m,m,this._globeViewProjMatrixNoCorrectionInverted),m[0]/=m[3],m[1]/=m[3],m[2]/=m[3];const v=i.bs();v[0]=m[0]-this._cameraPosition[0],v[1]=m[1]-this._cameraPosition[1],v[2]=m[2]-this._cameraPosition[2];const _=i.bs();return i.aY(_,v),_}isSurfacePointVisible(l){const m=this._cachedClippingPlane;return m[0]*l[0]+m[1]*l[1]+m[2]*l[2]+m[3]>=0}isSurfacePointOnScreen(l){if(!this.isSurfacePointVisible(l))return!1;const m=i.by();return i.aA(m,[...l,1],this._globeViewProjMatrixNoCorrection),m[0]/=m[3],m[1]/=m[3],m[2]/=m[3],m[0]>-1&&m[0]<1&&m[1]>-1&&m[1]<1&&m[2]>-1&&m[2]<1}rayPlanetIntersection(l,m){const v=i.a_(l,m),_=i.bs(),P=i.bs();i.aU(P,m,v),i.aX(_,l,P);const I=1-i.a_(_,_);if(I<0)return null;const z=i.a_(l,l)-1,q=-v+(v<0?1:-1)*Math.sqrt(I),G=z/q,Y=q;return{tMin:Math.min(G,Y),tMax:Math.max(G,Y)}}unprojectScreenPoint(l){const m=this._cameraPosition,v=this.getRayDirectionFromPixel(l),_=this.rayPlanetIntersection(m,v);if(_){const Y=i.bs();i.aV(Y,m,[v[0]*_.tMin,v[1]*_.tMin,v[2]*_.tMin]);const le=i.bs();return i.aY(le,Y),fw(le)}const P=this._cachedClippingPlane,I=P[0]*v[0]+P[1]*v[1]+P[2]*v[2],z=-i.b4(P,m)/I,q=i.bs();if(z>0)i.aV(q,m,[v[0]*z,v[1]*z,v[2]*z]);else{const Y=i.bs();i.aV(Y,m,[2*v[0],2*v[1],2*v[2]]);const le=i.b4(this._cachedClippingPlane,Y);i.aX(q,Y,[this._cachedClippingPlane[0]*le,this._cachedClippingPlane[1]*le,this._cachedClippingPlane[2]*le])}const G=function(Y){const le=i.bs();return le[0]=Y[0]*-Y[3],le[1]=Y[1]*-Y[3],le[2]=Y[2]*-Y[3],{center:le,radius:Math.sqrt(1-Y[3]*Y[3])}}(P);return fw(function(Y,le,ie){const fe=i.bs();i.aX(fe,ie,Y);const _e=i.bs();return i.bt(_e,Y,fe,le/i.b2(fe)),_e}(G.center,G.radius,q))}getMatrixForModel(l,m){const v=i.U.convert(l),_=1/i.bx,P=i.bc();return i.bC(P,P,v.lng/180*Math.PI),i.ba(P,P,-v.lat/180*Math.PI),i.N(P,P,[0,0,1+m/i.bx]),i.ba(P,P,.5*Math.PI),i.O(P,P,[_,_,_]),P}getProjectionDataForCustomLayer(l=!0){const m=this.getProjectionData({overscaledTileID:new i.a0(0,0,0,0,0),applyGlobeMatrix:l});return m.tileMercatorCoords=[0,0,1,1],m}getFastPathSimpleProjectionMatrix(l){}}class sx{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(l){this._helper.setMinZoom(l)}setMaxZoom(l){this._helper.setMaxZoom(l)}setMinPitch(l){this._helper.setMinPitch(l)}setMaxPitch(l){this._helper.setMaxPitch(l)}setRenderWorldCopies(l){this._helper.setRenderWorldCopies(l)}setBearing(l){this._helper.setBearing(l)}setPitch(l){this._helper.setPitch(l)}setRoll(l){this._helper.setRoll(l)}setFov(l){this._helper.setFov(l)}setZoom(l){this._helper.setZoom(l)}setCenter(l){this._helper.setCenter(l)}setElevation(l){this._helper.setElevation(l)}setMinElevationForCurrentTile(l){this._helper.setMinElevationForCurrentTile(l)}setPadding(l){this._helper.setPadding(l)}interpolatePadding(l,m,v){return this._helper.interpolatePadding(l,m,v)}isPaddingEqual(l){return this._helper.isPaddingEqual(l)}resize(l,m,v=!0){this._helper.resize(l,m,v)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(l){this._helper.setMaxBounds(l)}setConstrain(l){this._helper.setConstrain(l)}overrideNearFarZ(l,m){this._helper.overrideNearFarZ(l,m)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(l){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),l)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrain(){return this._helper.constrain}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(l,m){this._globeness=l,this._globeLatitudeErrorCorrectionRadians=m,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(l){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(m,v)=>this.currentTransform.defaultConstrain(m,v),this._helper=new pi({calcMatrices:()=>{this._calcMatrices()},constrain:(m,v)=>this.defaultConstrain(m,v)},l),this._globeness=1,this._mercatorTransform=new Pl,this._verticalPerspectiveTransform=new rx}clone(){const l=new sx;return l._globeness=this._globeness,l._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,l.apply(this),l}apply(l){this._helper.apply(l),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(l){const m=this._mercatorTransform.getProjectionData(l),v=this._verticalPerspectiveTransform.getProjectionData(l);return{mainMatrix:this.isGlobeRendering?v.mainMatrix:m.mainMatrix,clippingPlane:v.clippingPlane,tileMercatorCoords:v.tileMercatorCoords,projectionTransition:l.applyGlobeMatrix?this._globeness:0,fallbackMatrix:m.fallbackMatrix}}isLocationOccluded(l){return this.currentTransform.isLocationOccluded(l)}transformLightDirection(l){return this.currentTransform.transformLightDirection(l)}getPixelScale(){return i.bn(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return i.bn(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(l,m,v){const _=this._mercatorTransform.getPitchedTextCorrection(l,m,v),P=this._verticalPerspectiveTransform.getPitchedTextCorrection(l,m,v);return i.bn(_,P,this._globeness)}projectTileCoordinates(l,m,v,_){return this.currentTransform.projectTileCoordinates(l,m,v,_)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(l){return this.currentTransform.calculateFogMatrix(l)}getVisibleUnwrappedCoordinates(l){return this.currentTransform.getVisibleUnwrappedCoordinates(l)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(l){this._mercatorTransform.recalculateZoomAndCenter(l),this._verticalPerspectiveTransform.recalculateZoomAndCenter(l)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(l,m){return this.currentTransform.lngLatToCameraDepth(l,m)}populateCache(l){this._mercatorTransform.populateCache(l),this._verticalPerspectiveTransform.populateCache(l)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(l,m,v,_){return this._helper.calculateCenterFromCameraLngLatAlt(l,m,v,_)}setLocationAtPoint(l,m){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(l,m),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(l,m),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(l,m){return this.currentTransform.locationToScreenPoint(l,m)}screenPointToMercatorCoordinate(l,m){return this.currentTransform.screenPointToMercatorCoordinate(l,m)}screenPointToLocation(l,m){return this.currentTransform.screenPointToLocation(l,m)}isPointOnMapSurface(l,m){return this.currentTransform.isPointOnMapSurface(l,m)}getRayDirectionFromPixel(l){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(l)}getMatrixForModel(l,m){return this.currentTransform.getMatrixForModel(l,m)}getProjectionDataForCustomLayer(l=!0){const m=this._mercatorTransform.getProjectionDataForCustomLayer(l);if(!this.isGlobeRendering)return m;const v=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(l);return v.fallbackMatrix=m.mainMatrix,v}getFastPathSimpleProjectionMatrix(l){return this.currentTransform.getFastPathSimpleProjectionMatrix(l)}}class Qo{get useGlobeControls(){return!0}handlePanInertia(l,m){const v=tx(l,m);return Math.abs(v.lng-m.center.lng)>180&&(v.lng=m.center.lng+179.5*Math.sign(v.lng-m.center.lng)),{easingCenter:v,easingOffset:new i.P(0,0)}}handleMapControlsRollPitchBearingZoom(l,m){const v=l.around,_=m.screenPointToLocation(v);l.bearingDelta&&m.setBearing(m.bearing+l.bearingDelta),l.pitchDelta&&m.setPitch(m.pitch+l.pitchDelta),l.rollDelta&&m.setRoll(m.roll+l.rollDelta);const P=m.zoom;l.zoomDelta&&m.setZoom(m.zoom+l.zoomDelta);const I=m.zoom-P;if(I===0)return;const z=i.bD(m.center.lng,_.lng),q=z/(Math.abs(z/180)+1),G=i.bD(m.center.lat,_.lat),Y=m.getRayDirectionFromPixel(v),le=m.cameraPosition,ie=-1*i.a_(le,Y),fe=i.bs();i.aV(fe,le,[Y[0]*ie,Y[1]*ie,Y[2]*ie]);const _e=i.b0(fe)-1,Ee=Math.exp(.5*-Math.max(_e-.3,0)),Oe=nf(m.worldSize,m.center.lat)/Math.min(m.width,m.height),Re=i.bq(Oe,.9,.5,1,.25),ze=(1-i.al(-I))*Math.min(Ee,Re),Ue=m.center.lat,$e=m.zoom,We=new i.U(m.center.lng+q*ze,i.ai(m.center.lat+G*ze,-i.aj,i.aj));m.setLocationAtPoint(_,v);const Ye=m.center,Be=i.bq(Math.abs(z),45,85,0,1),et=i.bq(Oe,.75,.35,0,1),pt=Math.pow(Math.max(Be,et),.25),ut=i.bD(Ye.lng,We.lng),mt=i.bD(Ye.lat,We.lat);m.setCenter(new i.U(Ye.lng+ut*pt,Ye.lat+mt*pt).wrap()),m.setZoom($e+Gs(Ue,m.center.lat))}handleMapControlsPan(l,m,v){if(!l.panDelta)return;const _=m.center.lat,P=m.zoom;m.setCenter(tx(l.panDelta,m).wrap()),m.setZoom(P+Gs(_,m.center.lat))}cameraForBoxAndBearing(l,m,v,_,P){const I=td(l,m,v,_,P),z=m.left/P.width*2-1,q=(P.width-m.right)/P.width*2-1,G=m.top/P.height*-2+1,Y=(P.height-m.bottom)/P.height*-2+1,le=i.bD(v.getWest(),v.getEast())<0,ie=le?v.getEast():v.getWest(),fe=le?v.getWest():v.getEast(),_e=Math.max(v.getNorth(),v.getSouth()),Ee=Math.min(v.getNorth(),v.getSouth()),Oe=ie+.5*i.bD(ie,fe),Re=_e+.5*i.bD(_e,Ee),ze=P.clone();ze.setCenter(I.center),ze.setBearing(I.bearing),ze.setPitch(0),ze.setRoll(0),ze.setZoom(I.zoom);const Ue=ze.modelViewProjectionMatrix,$e=[Oa(v.getNorthWest()),Oa(v.getNorthEast()),Oa(v.getSouthWest()),Oa(v.getSouthEast()),Oa(new i.U(fe,Re)),Oa(new i.U(ie,Re)),Oa(new i.U(Oe,_e)),Oa(new i.U(Oe,Ee))],We=Oa(I.center);let Ye=Number.POSITIVE_INFINITY;for(const Be of $e)z<0&&(Ye=Qo.getLesserNonNegativeNonNull(Ye,Qo.solveVectorScale(Be,We,Ue,"x",z))),q>0&&(Ye=Qo.getLesserNonNegativeNonNull(Ye,Qo.solveVectorScale(Be,We,Ue,"x",q))),G>0&&(Ye=Qo.getLesserNonNegativeNonNull(Ye,Qo.solveVectorScale(Be,We,Ue,"y",G))),Y<0&&(Ye=Qo.getLesserNonNegativeNonNull(Ye,Qo.solveVectorScale(Be,We,Ue,"y",Y)));if(Number.isFinite(Ye)&&Ye!==0)return I.zoom=ze.zoom+i.ao(Ye),I;Xn()}handleJumpToCenterZoom(l,m){const v=l.center.lat,_=l.constrain(m.center?i.U.convert(m.center):l.center,l.zoom).center;l.setCenter(_.wrap());const P=m.zoom!==void 0?+m.zoom:l.zoom+Gs(v,_.lat);l.zoom!==P&&l.setZoom(P)}handleEaseTo(l,m){const v=l.zoom,_=l.center,P=l.padding,I={roll:l.roll,pitch:l.pitch,bearing:l.bearing},z={roll:m.roll===void 0?l.roll:m.roll,pitch:m.pitch===void 0?l.pitch:m.pitch,bearing:m.bearing===void 0?l.bearing:m.bearing},q=m.zoom!==void 0,G=!l.isPaddingEqual(m.padding);let Y=!1;const le=m.center?i.U.convert(m.center):_,ie=l.constrain(le,v).center;gn(l,ie);const fe=l.clone();fe.setCenter(ie),fe.setZoom(q?+m.zoom:v+Gs(_.lat,le.lat)),fe.setBearing(m.bearing);const _e=new i.P(i.ai(l.centerPoint.x+m.offsetAsPoint.x,0,l.width),i.ai(l.centerPoint.y+m.offsetAsPoint.y,0,l.height));fe.setLocationAtPoint(ie,_e);const Ee=(m.offset&&m.offsetAsPoint.mag())>0?fe.center:ie,Oe=q?+m.zoom:v+Gs(_.lat,Ee.lat),Re=v+Gs(_.lat,0),ze=Oe+Gs(Ee.lat,0),Ue=i.bD(_.lng,Ee.lng),$e=i.bD(_.lat,Ee.lat),We=i.al(ze-Re);return Y=Oe!==v,{easeFunc:Ye=>{if(i.bh(I,z)||lh({startEulerAngles:I,endEulerAngles:z,tr:l,k:Ye,useSlerp:I.roll!=z.roll}),G&&l.interpolatePadding(P,m.padding,Ye),m.around)i.w("Easing around a point is not supported under globe projection."),l.setLocationAtPoint(m.around,m.aroundPoint);else{const Be=ze>Re?Math.min(2,We):Math.max(.5,We),et=Math.pow(Be,1-Ye),pt=af(_,Ue,$e,Ye*et);l.setCenter(pt.wrap())}if(Y){const Be=i.F.number(Re,ze,Ye)+Gs(0,l.center.lat);l.setZoom(Be)}},isZooming:Y,elevationCenter:Ee}}handleFlyTo(l,m){const v=m.zoom!==void 0,_=l.center,P=l.zoom,I=l.padding,z=!l.isPaddingEqual(m.padding),q=l.constrain(i.U.convert(m.center||m.locationAtOffset),P).center,G=v?+m.zoom:l.zoom+Gs(l.center.lat,q.lat),Y=l.clone();Y.setCenter(q),Y.setZoom(G),Y.setBearing(m.bearing);const le=new i.P(i.ai(l.centerPoint.x+m.offsetAsPoint.x,0,l.width),i.ai(l.centerPoint.y+m.offsetAsPoint.y,0,l.height));Y.setLocationAtPoint(q,le);const ie=Y.center;gn(l,ie);const fe=function($e,We,Ye){const Be=Oa(We),et=Oa(Ye),pt=i.a_(Be,et),ut=Math.acos(pt),mt=uh($e);return ut/(2*Math.PI)*mt}(l,_,ie),_e=P+Gs(_.lat,0),Ee=G+Gs(ie.lat,0),Oe=i.al(Ee-_e);let Re;if(typeof m.minZoom=="number"){const $e=+m.minZoom+Gs(ie.lat,0),We=Math.min($e,_e,Ee)+Gs(0,ie.lat),Ye=l.constrain(ie,We).zoom+Gs(ie.lat,0);Re=i.al(Ye-_e)}const ze=i.bD(_.lng,ie.lng),Ue=i.bD(_.lat,ie.lat);return{easeFunc:($e,We,Ye,Be)=>{const et=af(_,ze,Ue,Ye);z&&l.interpolatePadding(I,m.padding,$e);const pt=$e===1?ie:et;l.setCenter(pt.wrap());const ut=_e+i.ao(We);l.setZoom($e===1?G:ut+Gs(0,pt.lat))},scaleOfZoom:Oe,targetCenter:ie,scaleOfMinZoom:Re,pixelPathLength:fe}}static solveVectorScale(l,m,v,_,P){const I=_==="x"?[v[0],v[4],v[8],v[12]]:[v[1],v[5],v[9],v[13]],z=[v[3],v[7],v[11],v[15]],q=l[0]*I[0]+l[1]*I[1]+l[2]*I[2],G=l[0]*z[0]+l[1]*z[1]+l[2]*z[2],Y=m[0]*I[0]+m[1]*I[1]+m[2]*I[2],le=m[0]*z[0]+m[1]*z[1]+m[2]*z[2];return Y+P*G===q+P*le||z[3]*(q-Y)+I[3]*(le-G)+q*le==Y*G?null:(Y+I[3]-P*le-P*z[3])/(Y-q-P*le+P*G)}static getLesserNonNegativeNonNull(l,m){return m!==null&&m>=0&&m<l?m:l}}class of{constructor(l){this._globe=l,this._mercatorCameraHelper=new Gd,this._verticalPerspectiveCameraHelper=new Qo}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(l,m){return this.currentHelper.handlePanInertia(l,m)}handleMapControlsRollPitchBearingZoom(l,m){return this.currentHelper.handleMapControlsRollPitchBearingZoom(l,m)}handleMapControlsPan(l,m,v){this.currentHelper.handleMapControlsPan(l,m,v)}cameraForBoxAndBearing(l,m,v,_,P){return this.currentHelper.cameraForBoxAndBearing(l,m,v,_,P)}handleJumpToCenterZoom(l,m){this.currentHelper.handleJumpToCenterZoom(l,m)}handleEaseTo(l,m){return this.currentHelper.handleEaseTo(l,m)}handleFlyTo(l,m){return this.currentHelper.handleFlyTo(l,m)}}const hh=(S,l)=>i.z(S,l&&l.filter(m=>m.identifier!=="source.canvas")),nx=i.bH();class lf extends i.E{constructor(l,m={}){var v,_;super(),this._rtlPluginLoaded=()=>{for(const I in this.tileManagers){const z=this.tileManagers[I].getSource().type;z!=="vector"&&z!=="geojson"||this.tileManagers[I].reload()}},this.map=l,this.dispatcher=new At(ur(),l._getMapId()),this.dispatcher.registerMessageHandler("GG",(I,z)=>this.getGlyphs(I,z)),this.dispatcher.registerMessageHandler("GI",(I,z)=>this.getImages(I,z)),this.dispatcher.registerMessageHandler("GDA",(I,z)=>this.getDashes(I,z)),this.imageManager=new Z,this.imageManager.setEventedParent(this);const P=((v=l._container)===null||v===void 0?void 0:v.lang)||typeof document<"u"&&((_=document.documentElement)===null||_===void 0?void 0:_.lang)||void 0;this.glyphManager=new Se(l._requestManager,m.localIdeographFontFamily,P),this.lineAtlas=new Ve(256,512),this.crossTileSymbolIndex=new oc,this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new i.bI,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",i.bJ()),ve().on(Tn,this._rtlPluginLoaded),this.on("data",I=>{if(I.dataType!=="source"||I.sourceDataType!=="metadata")return;const z=this.tileManagers[I.sourceId];if(!z)return;const q=z.getSource();if(q&&q.vectorLayerIds)for(const G in this._layers){const Y=this._layers[G];Y.source===q.id&&this._validateLayer(Y)}})}setGlobalStateProperty(l,m){var v,_,P;this._checkLoaded();const I=m===null?(P=(_=(v=this.stylesheet.state)===null||v===void 0?void 0:v[l])===null||_===void 0?void 0:_.default)!==null&&P!==void 0?P:null:m;if(i.bK(I,this._globalState[l]))return this;this._globalState[l]=I,this._applyGlobalStateChanges([l])}getGlobalState(){return this._globalState}setGlobalState(l){this._checkLoaded();const m=[];for(const v in l)!i.bK(this._globalState[v],l[v].default)&&(m.push(v),this._globalState[v]=l[v].default);this._applyGlobalStateChanges(m)}_applyGlobalStateChanges(l){if(l.length===0)return;const m=new Set,v={};for(const _ of l){v[_]=this._globalState[_];for(const P in this._layers){const I=this._layers[P],z=I.getLayoutAffectingGlobalStateRefs(),q=I.getPaintAffectingGlobalStateRefs();if(z.has(_)&&m.add(I.source),q.has(_))for(const{name:G,value:Y}of q.get(_))this._updatePaintProperty(I,G,Y)}}this.dispatcher.broadcast("UGS",v);for(const _ in this.tileManagers)m.has(_)&&(this._reloadSource(_),this._changed=!0)}loadURL(l,m={},v){this.fire(new i.l("dataloading",{dataType:"style"})),m.validate=typeof m.validate!="boolean"||m.validate;const _=this.map._requestManager.transformRequest(l,"Style");this._loadStyleRequest=new AbortController;const P=this._loadStyleRequest;i.j(_,this._loadStyleRequest).then(I=>{this._loadStyleRequest=null,this._load(I.data,m,v)}).catch(I=>{this._loadStyleRequest=null,I&&!P.signal.aborted&&this.fire(new i.k(I))})}loadJSON(l,m={},v){this.fire(new i.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,b.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,m.validate=m.validate!==!1,this._load(l,m,v)}).catch(()=>{})}loadEmpty(){this.fire(new i.l("dataloading",{dataType:"style"})),this._load(nx,{validate:!1})}_load(l,m,v){var _,P;let I=m.transformStyle?m.transformStyle(v,l):l;if(!m.validate||!hh(this,i.B(I))){I=Object.assign({},I),this._loaded=!0,this.stylesheet=I;for(const z in I.sources)this.addSource(z,I.sources[z],{validate:!1});I.sprite?this._loadSprite(I.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(I.glyphs),this._createLayers(),this.light=new de(this.stylesheet.light),this._setProjectionInternal(((_=this.stylesheet.projection)===null||_===void 0?void 0:_.type)||"mercator"),this.sky=new He(this.stylesheet.sky),this.map.setTerrain((P=this.stylesheet.terrain)!==null&&P!==void 0?P:null),this.fire(new i.l("data",{dataType:"style"})),this.fire(new i.l("style.load"))}}_createLayers(){var l,m,v;const _=i.bL(this.stylesheet.layers);this.setGlobalState((l=this.stylesheet.state)!==null&&l!==void 0?l:null),this.dispatcher.broadcast("SL",_),this._order=_.map(P=>P.id),this._layers={},this._serializedLayers=null;for(const P of _){const I=i.bM(P,this._globalState);if(I.setEventedParent(this,{layer:{id:P.id}}),this._layers[P.id]=I,i.bN(I)&&this.tileManagers[I.source]){const z=(v=(m=P.paint)===null||m===void 0?void 0:m["raster-fade-duration"])!==null&&v!==void 0?v:I.paint.get("raster-fade-duration");this.tileManagers[I.source].setRasterFadeDuration(z)}}}_loadSprite(l,m=!1,v=void 0){let _;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(P,I,z,q){return i._(this,void 0,void 0,function*(){const G=te(P),Y=z>1?"@2x":"",le={},ie={};for(const{id:fe,url:_e}of G){const Ee=I.transformRequest(Q(_e,Y,".json"),"SpriteJSON");le[fe]=i.j(Ee,q);const Oe=I.transformRequest(Q(_e,Y,".png"),"SpriteImage");ie[fe]=B.getImage(Oe,q)}return yield Promise.all([...Object.values(le),...Object.values(ie)]),function(fe,_e){return i._(this,void 0,void 0,function*(){const Ee={};for(const Oe in fe){Ee[Oe]={};const Re=b.getImageCanvasContext((yield _e[Oe]).data),ze=(yield fe[Oe]).data;for(const Ue in ze){const{width:$e,height:We,x:Ye,y:Be,sdf:et,pixelRatio:pt,stretchX:ut,stretchY:mt,content:xt,textFitWidth:Ut,textFitHeight:Wt}=ze[Ue];Ee[Oe][Ue]={data:null,pixelRatio:pt,sdf:et,stretchX:ut,stretchY:mt,content:xt,textFitWidth:Ut,textFitHeight:Wt,spriteData:{width:$e,height:We,x:Ye,y:Be,context:Re}}}}return Ee})}(le,ie)})}(l,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(P=>{if(this._spriteRequest=null,P)for(const I in P){this._spritesImagesIds[I]=[];const z=this._spritesImagesIds[I]?this._spritesImagesIds[I].filter(q=>!(q in P)):[];for(const q of z)this.imageManager.removeImage(q),this._changedImages[q]=!0;for(const q in P[I]){const G=I==="default"?q:`${I}:${q}`;this._spritesImagesIds[I].push(G),G in this.imageManager.images?this.imageManager.updateImage(G,P[I][q],!1):this.imageManager.addImage(G,P[I][q]),m&&(this._changedImages[G]=!0)}}}).catch(P=>{this._spriteRequest=null,_=P,this.fire(new i.k(_))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),m&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new i.l("data",{dataType:"style"})),v&&v(_)})}_unloadSprite(){for(const l of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(l),this._changedImages[l]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new i.l("data",{dataType:"style"}))}_validateLayer(l){const m=this.tileManagers[l.source];if(!m)return;const v=l.sourceLayer;if(!v)return;const _=m.getSource();(_.type==="geojson"||_.vectorLayerIds&&_.vectorLayerIds.indexOf(v)===-1)&&this.fire(new i.k(new Error(`Source layer "${v}" does not exist on source "${_.id}" as specified by style layer "${l.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this.tileManagers)if(!this.tileManagers[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(l,m=!1){const v=this._serializedAllLayers();if(!l||l.length===0)return Object.values(m?i.bO(v):v);const _=[];for(const P of l)if(v[P]){const I=m?i.bO(v[P]):v[P];_.push(I)}return _}_serializedAllLayers(){let l=this._serializedLayers;if(l)return l;l=this._serializedLayers={};const m=Object.keys(this._layers);for(const v of m){const _=this._layers[v];_.type!=="custom"&&(l[v]=_.serialize())}return l}hasTransitions(){var l,m,v;if(!((l=this.light)===null||l===void 0)&&l.hasTransition()||!((m=this.sky)===null||m===void 0)&&m.hasTransition()||!((v=this.projection)===null||v===void 0)&&v.hasTransition())return!0;for(const _ in this.tileManagers)if(this.tileManagers[_].hasTransition())return!0;for(const _ in this._layers)if(this._layers[_].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(l){if(!this._loaded)return;const m=this._changed;if(m){const _=Object.keys(this._updatedLayers),P=Object.keys(this._removedLayers);(_.length||P.length)&&this._updateWorkerLayers(_,P);for(const I in this._updatedSources){const z=this._updatedSources[I];if(z==="reload")this._reloadSource(I);else{if(z!=="clear")throw new Error(`Invalid action ${z}`);this._clearSource(I)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const I in this._updatedPaintProps)this._layers[I].updateTransitions(l);this.light.updateTransitions(l),this.sky.updateTransitions(l),this._resetUpdates()}const v={};for(const _ in this.tileManagers){const P=this.tileManagers[_];v[_]=P.used,P.used=!1}for(const _ of this._order){const P=this._layers[_];P.recalculate(l,this._availableImages),!P.isHidden(l.zoom)&&P.source&&(this.tileManagers[P.source].used=!0)}for(const _ in v){const P=this.tileManagers[_];!!v[_]!=!!P.used&&P.fire(new i.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:_}))}this.light.recalculate(l),this.sky.recalculate(l),this.projection.recalculate(l),this.z=l.zoom,m&&this.fire(new i.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const m in this.tileManagers)this.tileManagers[m].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const l in this.tileManagers)this.tileManagers[l].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(l,m){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(l,!1),removedIds:m})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(l,m={}){var v;this._checkLoaded();const _=this.serialize();if(l=m.transformStyle?m.transformStyle(_,l):l,((v=m.validate)===null||v===void 0||v)&&hh(this,i.B(l)))return!1;(l=i.bO(l)).layers=i.bL(l.layers);const P=i.bP(_,l),I=this._getOperationsToPerform(P);if(I.unimplemented.length>0)throw new Error(`Unimplemented: ${I.unimplemented.join(", ")}.`);if(I.operations.length===0)return!1;for(const z of I.operations)z();return this.stylesheet=l,this._serializedLayers=null,!0}_getOperationsToPerform(l){const m=[],v=[];for(const _ of l)switch(_.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":m.push(()=>this.addLayer.apply(this,_.args));break;case"removeLayer":m.push(()=>this.removeLayer.apply(this,_.args));break;case"setPaintProperty":m.push(()=>this.setPaintProperty.apply(this,_.args));break;case"setLayoutProperty":m.push(()=>this.setLayoutProperty.apply(this,_.args));break;case"setFilter":m.push(()=>this.setFilter.apply(this,_.args));break;case"addSource":m.push(()=>this.addSource.apply(this,_.args));break;case"removeSource":m.push(()=>this.removeSource.apply(this,_.args));break;case"setLayerZoomRange":m.push(()=>this.setLayerZoomRange.apply(this,_.args));break;case"setLight":m.push(()=>this.setLight.apply(this,_.args));break;case"setGeoJSONSourceData":m.push(()=>this.setGeoJSONSourceData.apply(this,_.args));break;case"setGlyphs":m.push(()=>this.setGlyphs.apply(this,_.args));break;case"setSprite":m.push(()=>this.setSprite.apply(this,_.args));break;case"setTerrain":m.push(()=>this.map.setTerrain.apply(this,_.args));break;case"setSky":m.push(()=>this.setSky.apply(this,_.args));break;case"setProjection":this.setProjection.apply(this,_.args);break;case"setGlobalState":m.push(()=>this.setGlobalState.apply(this,_.args));break;case"setTransition":m.push(()=>{});break;default:v.push(_.command)}return{operations:m,unimplemented:v}}addImage(l,m){if(this.getImage(l))return this.fire(new i.k(new Error(`An image named "${l}" already exists.`)));this.imageManager.addImage(l,m),this._afterImageUpdated(l)}updateImage(l,m){this.imageManager.updateImage(l,m)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){if(!this.getImage(l))return this.fire(new i.k(new Error(`An image named "${l}" does not exist.`)));this.imageManager.removeImage(l),this._afterImageUpdated(l)}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new i.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(l,m,v={}){if(this._checkLoaded(),this.tileManagers[l]!==void 0)throw new Error(`Source "${l}" already exists.`);if(!m.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(m).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(i.B.source,`sources.${l}`,m,null,v))return;this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);const _=this.tileManagers[l]=new Bs(l,m,this.dispatcher);_.style=this,_.setEventedParent(this,()=>({isSourceLoaded:_.loaded(),source:_.serialize(),sourceId:l})),_.onAdd(this.map),this._changed=!0}removeSource(l){if(this._checkLoaded(),this.tileManagers[l]===void 0)throw new Error("There is no source with this ID");for(const v in this._layers)if(this._layers[v].source===l)return this.fire(new i.k(new Error(`Source "${l}" cannot be removed while layer "${v}" is using it.`)));const m=this.tileManagers[l];delete this.tileManagers[l],delete this._updatedSources[l],m.fire(new i.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),m.setEventedParent(null),m.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(l,m){if(this._checkLoaded(),this.tileManagers[l]===void 0)throw new Error(`There is no source with this ID=${l}`);const v=this.tileManagers[l].getSource();if(v.type!=="geojson")throw new Error(`geojsonSource.type is ${v.type}, which is !== 'geojson`);v.setData(m),this._changed=!0}getSource(l){return this.tileManagers[l]&&this.tileManagers[l].getSource()}addLayer(l,m,v={}){this._checkLoaded();const _=l.id;if(this.getLayer(_))return void this.fire(new i.k(new Error(`Layer "${_}" already exists on this map.`)));let P;if(l.type==="custom"){if(hh(this,i.bQ(l)))return;P=i.bM(l,this._globalState)}else{if("source"in l&&typeof l.source=="object"&&(this.addSource(_,l.source),l=i.bO(l),l=i.e(l,{source:_})),this._validate(i.B.layer,`layers.${_}`,l,{arrayIndex:-1},v))return;P=i.bM(l,this._globalState),this._validateLayer(P),P.setEventedParent(this,{layer:{id:_}})}const I=m?this._order.indexOf(m):this._order.length;if(m&&I===-1)this.fire(new i.k(new Error(`Cannot add layer "${_}" before non-existing layer "${m}".`)));else{if(this._order.splice(I,0,_),this._layerOrderChanged=!0,this._layers[_]=P,this._removedLayers[_]&&P.source&&P.type!=="custom"){const z=this._removedLayers[_];delete this._removedLayers[_],z.type!==P.type?this._updatedSources[P.source]="clear":(this._updatedSources[P.source]="reload",this.tileManagers[P.source].pause())}this._updateLayer(P),P.onAdd&&P.onAdd(this.map)}}moveLayer(l,m){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new i.k(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===m)return;const v=this._order.indexOf(l);this._order.splice(v,1);const _=m?this._order.indexOf(m):this._order.length;m&&_===-1?this.fire(new i.k(new Error(`Cannot move layer "${l}" before non-existing layer "${m}".`))):(this._order.splice(_,0,l),this._layerOrderChanged=!0)}removeLayer(l){this._checkLoaded();const m=this._layers[l];if(!m)return void this.fire(new i.k(new Error(`Cannot remove non-existing layer "${l}".`)));m.setEventedParent(null);const v=this._order.indexOf(l);this._order.splice(v,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=m,delete this._layers[l],this._serializedLayers&&delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],m.onRemove&&m.onRemove(this.map)}getLayer(l){return this._layers[l]}getLayersOrder(){return[...this._order]}hasLayer(l){return l in this._layers}setLayerZoomRange(l,m,v){this._checkLoaded();const _=this.getLayer(l);_?_.minzoom===m&&_.maxzoom===v||(m!=null&&(_.minzoom=m),v!=null&&(_.maxzoom=v),this._updateLayer(_)):this.fire(new i.k(new Error(`Cannot set the zoom range of non-existing layer "${l}".`)))}setFilter(l,m,v={}){this._checkLoaded();const _=this.getLayer(l);if(_){if(!i.bK(_.filter,m))return m==null?(_.setFilter(void 0),void this._updateLayer(_)):void(this._validate(i.B.filter,`layers.${_.id}.filter`,m,null,v)||(_.setFilter(i.bO(m)),this._updateLayer(_)))}else this.fire(new i.k(new Error(`Cannot filter non-existing layer "${l}".`)))}getFilter(l){return i.bO(this.getLayer(l).filter)}setLayoutProperty(l,m,v,_={}){this._checkLoaded();const P=this.getLayer(l);P?i.bK(P.getLayoutProperty(m),v)||(P.setLayoutProperty(m,v,_),this._updateLayer(P)):this.fire(new i.k(new Error(`Cannot style non-existing layer "${l}".`)))}getLayoutProperty(l,m){const v=this.getLayer(l);if(v)return v.getLayoutProperty(m);this.fire(new i.k(new Error(`Cannot get style of non-existing layer "${l}".`)))}setPaintProperty(l,m,v,_={}){this._checkLoaded();const P=this.getLayer(l);P?i.bK(P.getPaintProperty(m),v)||this._updatePaintProperty(P,m,v,_):this.fire(new i.k(new Error(`Cannot style non-existing layer "${l}".`)))}_updatePaintProperty(l,m,v,_={}){l.setPaintProperty(m,v,_)&&this._updateLayer(l),i.bN(l)&&m==="raster-fade-duration"&&this.tileManagers[l.source].setRasterFadeDuration(v),this._changed=!0,this._updatedPaintProps[l.id]=!0,this._serializedLayers=null}getPaintProperty(l,m){return this.getLayer(l).getPaintProperty(m)}setFeatureState(l,m){this._checkLoaded();const v=l.source,_=l.sourceLayer,P=this.tileManagers[v];if(P===void 0)return void this.fire(new i.k(new Error(`The source '${v}' does not exist in the map's style.`)));const I=P.getSource().type;I==="geojson"&&_?this.fire(new i.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):I!=="vector"||_?(l.id===void 0&&this.fire(new i.k(new Error("The feature id parameter must be provided."))),P.setFeatureState(_,l.id,m)):this.fire(new i.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(l,m){this._checkLoaded();const v=l.source,_=this.tileManagers[v];if(_===void 0)return void this.fire(new i.k(new Error(`The source '${v}' does not exist in the map's style.`)));const P=_.getSource().type,I=P==="vector"?l.sourceLayer:void 0;P!=="vector"||I?m&&typeof l.id!="string"&&typeof l.id!="number"?this.fire(new i.k(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(I,l.id,m):this.fire(new i.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(l){this._checkLoaded();const m=l.source,v=l.sourceLayer,_=this.tileManagers[m];if(_!==void 0)return _.getSource().type!=="vector"||v?(l.id===void 0&&this.fire(new i.k(new Error("The feature id parameter must be provided."))),_.getFeatureState(v,l.id)):void this.fire(new i.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new i.k(new Error(`The source '${m}' does not exist in the map's style.`)))}getTransition(){return i.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const l=i.bR(this.tileManagers,P=>P.serialize()),m=this._serializeByIds(this._order,!0),v=this.map.getTerrain()||void 0,_=this.stylesheet;return i.bS({version:_.version,name:_.name,metadata:_.metadata,light:_.light,sky:_.sky,center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch,sprite:_.sprite,glyphs:_.glyphs,transition:_.transition,projection:_.projection,sources:l,layers:m,terrain:v},P=>P!==void 0)}_updateLayer(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.tileManagers[l.source].getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",this.tileManagers[l.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(l){const m=I=>this._layers[I].type==="fill-extrusion",v={},_=[];for(let I=this._order.length-1;I>=0;I--){const z=this._order[I];if(m(z)){v[z]=I;for(const q of l){const G=q[z];if(G)for(const Y of G)_.push(Y)}}}_.sort((I,z)=>z.intersectionZ-I.intersectionZ);const P=[];for(let I=this._order.length-1;I>=0;I--){const z=this._order[I];if(m(z))for(let q=_.length-1;q>=0;q--){const G=_[q].feature;if(v[G.layer.id]<I)break;P.push(G),_.pop()}else for(const q of l){const G=q[z];if(G)for(const Y of G)P.push(Y.feature)}}return P}queryRenderedFeatures(l,m,v){m&&m.filter&&this._validate(i.B.filter,"queryRenderedFeatures.filter",m.filter,null,m);const _={};if(m&&m.layers){if(!(Array.isArray(m.layers)||m.layers instanceof Set))return this.fire(new i.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const G of m.layers){const Y=this._layers[G];if(!Y)return this.fire(new i.k(new Error(`The layer '${G}' does not exist in the map's style and cannot be queried for features.`))),[];_[Y.source]=!0}}const P=[];m.availableImages=this._availableImages;const I=this._serializedAllLayers(),z=m.layers instanceof Set?m.layers:Array.isArray(m.layers)?new Set(m.layers):null,q=Object.assign(Object.assign({},m),{layers:z,globalState:this._globalState});for(const G in this.tileManagers)m.layers&&!_[G]||P.push(vt(this.tileManagers[G],this._layers,I,l,q,v,this.map.terrain?(Y,le,ie)=>this.map.terrain.getElevation(Y,le,ie):void 0));return this.placement&&P.push(function(G,Y,le,ie,fe,_e,Ee){const Oe={},Re=_e.queryRenderedSymbols(ie),ze=[];for(const Ue of Object.keys(Re).map(Number))ze.push(Ee[Ue]);ze.sort(Br);for(const Ue of ze){const $e=Ue.featureIndex.lookupSymbolFeatures(Re[Ue.bucketInstanceId],Y,Ue.bucketIndex,Ue.sourceLayerIndex,{filterSpec:fe.filter,globalState:fe.globalState},fe.layers,fe.availableImages,G);for(const We in $e){const Ye=Oe[We]=Oe[We]||[],Be=$e[We];Be.sort((et,pt)=>{const ut=Ue.featureSortOrder;if(ut){const mt=ut.indexOf(et.featureIndex);return ut.indexOf(pt.featureIndex)-mt}return pt.featureIndex-et.featureIndex});for(const et of Be)Ye.push(et)}}return function(Ue,$e,We){for(const Ye in Ue)for(const Be of Ue[Ye])vr(Be,We[$e[Ye].source]);return Ue}(Oe,G,le)}(this._layers,I,this.tileManagers,l,q,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(P)}querySourceFeatures(l,m){m!=null&&m.filter&&this._validate(i.B.filter,"querySourceFeatures.filter",m.filter,null,m);const v=this.tileManagers[l];return v?function(_,P){const I=_.getRenderableIds().map(G=>_.getTileByID(G)),z=[],q={};for(let G=0;G<I.length;G++){const Y=I[G],le=Y.tileID.canonical.key;q[le]||(q[le]=!0,Y.querySourceFeatures(z,P))}return z}(v,m?Object.assign(Object.assign({},m),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(l,m={}){this._checkLoaded();const v=this.light.getLight();let _=!1;for(const I in l)if(!i.bK(l[I],v[I])){_=!0;break}if(!_)return;const P={now:T(),transition:i.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,m),this.light.updateTransitions(P)}getProjection(){var l;return(l=this.stylesheet)===null||l===void 0?void 0:l.projection}setProjection(l){if(this._checkLoaded(),this.projection){if(this.projection.name===l.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=l,this._setProjectionInternal(l.type)}getSky(){var l;return(l=this.stylesheet)===null||l===void 0?void 0:l.sky}setSky(l,m={}){this._checkLoaded();const v=this.getSky();let _=!1;if(!l&&!v)return;if(l&&!v)_=!0;else if(!l&&v)_=!0;else for(const I in l)if(!i.bK(l[I],v[I])){_=!0;break}if(!_)return;const P={now:T(),transition:i.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=l,this.sky.setSky(l,m),this.sky.updateTransitions(P)}_setProjectionInternal(l){const m=function(v,_){const P={constrain:_};if(Array.isArray(v)){const I=new sf({type:v});return{projection:I,transform:new sx(P),cameraHelper:new of(I)}}switch(v){case"mercator":return{projection:new Qa,transform:new Pl(P),cameraHelper:new Gd};case"globe":{const I=new sf({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:I,transform:new sx(P),cameraHelper:new of(I)}}case"vertical-perspective":return{projection:new Qp,transform:new rx(P),cameraHelper:new Qo};default:return i.w(`Unknown projection name: ${v}. Falling back to mercator projection.`),{projection:new Qa,transform:new Pl(P),cameraHelper:new Gd}}}(l,this.map.transformConstrain);this.projection=m.projection,this.map.migrateProjection(m.transform,m.cameraHelper);for(const v in this.tileManagers)this.tileManagers[v].reload()}_validate(l,m,v,_,P={}){return(!P||P.validate!==!1)&&hh(this,l.call(i.B,i.e({key:m,style:this.serialize(),value:v,styleSpec:i.t},_)))}_remove(l=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ve().off(Tn,this._rtlPluginLoaded);for(const m in this._layers)this._layers[m].setEventedParent(null);for(const m in this.tileManagers){const v=this.tileManagers[m];v.setEventedParent(null),v.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),l&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(l)}_clearSource(l){this.tileManagers[l].clearTiles()}_reloadSource(l){this.tileManagers[l].resume(),this.tileManagers[l].reload()}_updateSources(l){for(const m in this.tileManagers)this.tileManagers[m].update(l,this.map.terrain)}_generateCollisionBoxes(){for(const l in this.tileManagers)this._reloadSource(l)}_updatePlacement(l,m,v,_,P=!1){let I=!1,z=!1;const q={};for(const G of this._order){const Y=this._layers[G];if(Y.type!=="symbol")continue;if(!q[Y.source]){const ie=this.tileManagers[Y.source];q[Y.source]=ie.getRenderableIds(!0).map(fe=>ie.getTileByID(fe)).sort((fe,_e)=>_e.tileID.overscaledZ-fe.tileID.overscaledZ||(fe.tileID.isLessThan(_e.tileID)?-1:1))}const le=this.crossTileSymbolIndex.addLayer(Y,q[Y.source],l.center.lng);I=I||le}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((P=P||this._layerOrderChanged||v===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(T(),l.zoom))&&(this.pauseablePlacement=new Zp(l,this.map.terrain,this._order,P,m,v,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,q),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(T()),z=!0),I&&this.pauseablePlacement.placement.setStale()),z||I)for(const G of this._order){const Y=this._layers[G];Y.type==="symbol"&&this.placement.updateLayerOpacities(Y,q[Y.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(T())}_releaseSymbolFadeTiles(){for(const l in this.tileManagers)this.tileManagers[l].releaseSymbolFadeTiles()}getImages(l,m){return i._(this,void 0,void 0,function*(){const v=yield this.imageManager.getImages(m.icons);this._updateTilesForChangedImages();const _=this.tileManagers[m.source];return _&&_.setDependencies(m.tileID.key,m.type,m.icons),v})}getGlyphs(l,m){return i._(this,void 0,void 0,function*(){const v=yield this.glyphManager.getGlyphs(m.stacks),_=this.tileManagers[m.source];return _&&_.setDependencies(m.tileID.key,m.type,[""]),v})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(l,m={}){this._checkLoaded(),l&&this._validate(i.B.glyphs,"glyphs",l,null,m)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=l,this.glyphManager.entries={},this.glyphManager.setURL(l))}getDashes(l,m){return i._(this,void 0,void 0,function*(){const v={};for(const[_,P]of Object.entries(m.dashes))v[_]=this.lineAtlas.getDash(P.dasharray,P.round);return v})}addSprite(l,m,v={},_){this._checkLoaded();const P=[{id:l,url:m}],I=[...te(this.stylesheet.sprite),...P];this._validate(i.B.sprite,"sprite",I,null,v)||(this.stylesheet.sprite=I,this._loadSprite(P,!0,_))}removeSprite(l){this._checkLoaded();const m=te(this.stylesheet.sprite);if(m.find(v=>v.id===l)){if(this._spritesImagesIds[l])for(const v of this._spritesImagesIds[l])this.imageManager.removeImage(v),this._changedImages[v]=!0;m.splice(m.findIndex(v=>v.id===l),1),this.stylesheet.sprite=m.length>0?m:void 0,delete this._spritesImagesIds[l],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new i.l("data",{dataType:"style"}))}else this.fire(new i.k(new Error(`Sprite "${l}" doesn't exists on this map.`)))}getSprite(){return te(this.stylesheet.sprite)}setSprite(l,m={},v){this._checkLoaded(),l&&this._validate(i.B.sprite,"sprite",l,null,m)||(this.stylesheet.sprite=l,l?this._loadSprite(l,!0,v):(this._unloadSprite(),v&&v(null)))}}var Wv=i.aN([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class kl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(l,m,v,_,P,I,z,q,G){this.context=l;let Y=this.boundPaintVertexBuffers.length!==_.length;for(let le=0;!Y&&le<_.length;le++)this.boundPaintVertexBuffers[le]!==_[le]&&(Y=!0);!this.vao||this.boundProgram!==m||this.boundLayoutVertexBuffer!==v||Y||this.boundIndexBuffer!==P||this.boundVertexOffset!==I||this.boundDynamicVertexBuffer!==z||this.boundDynamicVertexBuffer2!==q||this.boundDynamicVertexBuffer3!==G?this.freshBind(m,v,_,P,I,z,q,G):(l.bindVertexArray.set(this.vao),z&&z.bind(),P&&P.dynamicDraw&&P.bind(),q&&q.bind(),G&&G.bind())}freshBind(l,m,v,_,P,I,z,q){const G=l.numAttributes,Y=this.context,le=Y.gl;this.vao&&this.destroy(),this.vao=Y.createVertexArray(),Y.bindVertexArray.set(this.vao),this.boundProgram=l,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=v,this.boundIndexBuffer=_,this.boundVertexOffset=P,this.boundDynamicVertexBuffer=I,this.boundDynamicVertexBuffer2=z,this.boundDynamicVertexBuffer3=q,m.enableAttributes(le,l);for(const ie of v)ie.enableAttributes(le,l);I&&I.enableAttributes(le,l),z&&z.enableAttributes(le,l),q&&q.enableAttributes(le,l),m.bind(),m.setVertexAttribPointers(le,l,P);for(const ie of v)ie.bind(),ie.setVertexAttribPointers(le,l,P);I&&(I.bind(),I.setVertexAttribPointers(le,l,P)),_&&_.bind(),z&&(z.bind(),z.setVertexAttribPointers(le,l,P)),q&&(q.bind(),q.setVertexAttribPointers(le,l,P)),Y.currentNumAttributes=G}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const GP=(S,l,m,v,_)=>({u_texture:0,u_ele_delta:S,u_fog_matrix:l,u_fog_color:m?m.properties.get("fog-color"):i.bi.white,u_fog_ground_blend:m?m.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:_?0:m?m.calculateFogBlendOpacity(v):0,u_horizon_color:m?m.properties.get("horizon-color"):i.bi.white,u_horizon_fog_blend:m?m.properties.get("horizon-fog-blend"):1,u_is_globe_mode:_?1:0}),Gv={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function sd(S){const l=[];for(let m=0;m<S.length;m++){if(S[m]===null)continue;const v=S[m].split(" ");l.push(v.pop())}return l}class cf{constructor(l,m,v,_,P,I,z,q,G=[]){const Y=l.gl;this.program=Y.createProgram();const le=sd(m.staticAttributes),ie=v?v.getBinderAttributes():[],fe=le.concat(ie),_e=Kr.prelude.staticUniforms?sd(Kr.prelude.staticUniforms):[],Ee=z.staticUniforms?sd(z.staticUniforms):[],Oe=m.staticUniforms?sd(m.staticUniforms):[],Re=v?v.getBinderUniforms():[],ze=_e.concat(Ee).concat(Oe).concat(Re),Ue=[];for(const ut of ze)Ue.indexOf(ut)<0&&Ue.push(ut);const $e=v?v.defines():[];To(Y)&&$e.unshift("#version 300 es"),P&&$e.push("#define OVERDRAW_INSPECTOR;"),I&&$e.push("#define TERRAIN3D;"),q&&$e.push(q),G&&$e.push(...G);let We=$e.concat(Kr.prelude.fragmentSource,z.fragmentSource,m.fragmentSource).join(`
`),Ye=$e.concat(Kr.prelude.vertexSource,z.vertexSource,m.vertexSource).join(`
`);To(Y)||(We=function(ut){return ut.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(We),Ye=function(ut){return ut.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Ye));const Be=Y.createShader(Y.FRAGMENT_SHADER);if(Y.isContextLost())return void(this.failedToCreate=!0);if(Y.shaderSource(Be,We),Y.compileShader(Be),!Y.getShaderParameter(Be,Y.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${Y.getShaderInfoLog(Be)}`);Y.attachShader(this.program,Be);const et=Y.createShader(Y.VERTEX_SHADER);if(Y.isContextLost())return void(this.failedToCreate=!0);if(Y.shaderSource(et,Ye),Y.compileShader(et),!Y.getShaderParameter(et,Y.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${Y.getShaderInfoLog(et)}`);Y.attachShader(this.program,et),this.attributes={};const pt={};this.numAttributes=fe.length;for(let ut=0;ut<this.numAttributes;ut++)fe[ut]&&(Y.bindAttribLocation(this.program,ut,fe[ut]),this.attributes[fe[ut]]=ut);if(Y.linkProgram(this.program),!Y.getProgramParameter(this.program,Y.LINK_STATUS))throw new Error(`Program failed to link: ${Y.getProgramInfoLog(this.program)}`);Y.deleteShader(et),Y.deleteShader(Be);for(let ut=0;ut<Ue.length;ut++){const mt=Ue[ut];if(mt&&!pt[mt]){const xt=Y.getUniformLocation(this.program,mt);xt&&(pt[mt]=xt)}}this.fixedUniforms=_(l,pt),this.terrainUniforms=((ut,mt)=>({u_depth:new i.bT(ut,mt.u_depth),u_terrain:new i.bT(ut,mt.u_terrain),u_terrain_dim:new i.bj(ut,mt.u_terrain_dim),u_terrain_matrix:new i.bV(ut,mt.u_terrain_matrix),u_terrain_unpack:new i.bW(ut,mt.u_terrain_unpack),u_terrain_exaggeration:new i.bj(ut,mt.u_terrain_exaggeration)}))(l,pt),this.projectionUniforms=((ut,mt)=>({u_projection_matrix:new i.bV(ut,mt.u_projection_matrix),u_projection_tile_mercator_coords:new i.bW(ut,mt.u_projection_tile_mercator_coords),u_projection_clipping_plane:new i.bW(ut,mt.u_projection_clipping_plane),u_projection_transition:new i.bj(ut,mt.u_projection_transition),u_projection_fallback_matrix:new i.bV(ut,mt.u_projection_fallback_matrix)}))(l,pt),this.binderUniforms=v?v.getUniforms(l,pt):[]}draw(l,m,v,_,P,I,z,q,G,Y,le,ie,fe,_e,Ee,Oe,Re,ze,Ue){const $e=l.gl;if(this.failedToCreate)return;if(l.program.set(this.program),l.setDepthMode(v),l.setStencilMode(_),l.setColorMode(P),l.setCullFace(I),q){l.activeTexture.set($e.TEXTURE2),$e.bindTexture($e.TEXTURE_2D,q.depthTexture),l.activeTexture.set($e.TEXTURE3),$e.bindTexture($e.TEXTURE_2D,q.texture);for(const Ye in this.terrainUniforms)this.terrainUniforms[Ye].set(q[Ye])}if(G)for(const Ye in G)this.projectionUniforms[Gv[Ye]].set(G[Ye]);if(z)for(const Ye in this.fixedUniforms)this.fixedUniforms[Ye].set(z[Ye]);Oe&&Oe.setUniforms(l,this.binderUniforms,_e,{zoom:Ee});let We=0;switch(m){case $e.LINES:We=2;break;case $e.TRIANGLES:We=3;break;case $e.LINE_STRIP:We=1}for(const Ye of fe.get()){const Be=Ye.vaos||(Ye.vaos={});(Be[Y]||(Be[Y]=new kl)).bind(l,this,le,Oe?Oe.getPaintVertexBuffers():[],ie,Ye.vertexOffset,Re,ze,Ue),$e.drawElements(m,Ye.primitiveLength*We,$e.UNSIGNED_SHORT,Ye.primitiveOffset*We*2)}}}function gw(S,l,m){const v=1/i.aG(m,1,l.transform.tileZoom),_=Math.pow(2,m.tileID.overscaledZ),P=m.tileSize*Math.pow(2,l.transform.tileZoom)/_,I=P*(m.tileID.canonical.x+m.tileID.wrap*_),z=P*m.tileID.canonical.y;return{u_image:0,u_texsize:m.imageAtlasTexture.size,u_scale:[v,S.fromScale,S.toScale],u_fade:S.t,u_pixel_coord_upper:[I>>16,z>>16],u_pixel_coord_lower:[65535&I,65535&z]}}const df=(S,l,m,v)=>{const _=S.style.light,P=_.properties.get("position"),I=[P.x,P.y,P.z],z=i.bZ();_.properties.get("anchor")==="viewport"&&i.b_(z,S.transform.bearingInRadians),i.b$(I,I,z);const q=S.transform.transformLightDirection(I),G=_.properties.get("color");return{u_lightpos:I,u_lightpos_globe:q,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[G.r,G.g,G.b],u_vertical_gradient:+l,u_opacity:m,u_fill_translate:v}},KP=(S,l,m,v,_,P,I)=>i.e(df(S,l,m,v),gw(P,S,I),{u_height_factor:-Math.pow(2,_.overscaledZ)/I.tileSize/8}),Hd=(S,l,m,v)=>i.e(gw(l,S,m),{u_fill_translate:v}),HP=(S,l)=>({u_world:S,u_fill_translate:l}),yw=(S,l,m,v,_)=>i.e(Hd(S,l,m,_),{u_world:v}),ZP=(S,l,m,v,_)=>{const P=S.transform;let I,z,q=0;if(m.paint.get("circle-pitch-alignment")==="map"){const G=i.aG(l,1,P.zoom);I=!0,z=[G,G],q=G/(i.a3*Math.pow(2,l.tileID.overscaledZ))*2*Math.PI*_}else I=!1,z=P.pixelsToGLUnits;return{u_camera_to_center_distance:P.cameraToCenterDistance,u_scale_with_map:+(m.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+I,u_device_pixel_ratio:S.pixelRatio,u_extrude_scale:z,u_globe_extrude_scale:q,u_translate:v}},vw=S=>({u_pixel_extrude_scale:[1/S.width,1/S.height]}),Kv=S=>({u_viewport_size:[S.width,S.height]}),Hv=(S,l=1)=>({u_color:S,u_overlay:0,u_overlay_scale:l}),Zv=(S,l,m,v)=>{const _=i.aG(S,1,l)/(i.a3*Math.pow(2,S.tileID.overscaledZ))*2*Math.PI*v;return{u_extrude_scale:i.aG(S,1,l),u_intensity:m,u_globe_extrude_scale:_}},Yv=(S,l,m,v)=>{const _=i.M();i.c0(_,0,S.width,S.height,0,0,1);const P=S.context.gl;return{u_matrix:_,u_world:[P.drawingBufferWidth,P.drawingBufferHeight],u_image:m,u_color_ramp:v,u_opacity:l.paint.get("heatmap-opacity")}},jw=(S,l,m)=>{const v=m.paint.get("hillshade-accent-color");let _;switch(m.paint.get("hillshade-method")){case"basic":_=4;break;case"combined":_=1;break;case"igor":_=2;break;case"multidirectional":_=3;break;default:_=0}const P=m.getIlluminationProperties();for(let I=0;I<P.directionRadians.length;I++)m.paint.get("hillshade-illumination-anchor")==="viewport"&&(P.directionRadians[I]+=S.transform.bearingInRadians);return{u_image:0,u_latrange:bw(0,l.tileID),u_exaggeration:m.paint.get("hillshade-exaggeration"),u_altitudes:P.altitudeRadians,u_azimuths:P.directionRadians,u_accent:v,u_method:_,u_highlights:P.highlightColor,u_shadows:P.shadowColor}},Zd=(S,l)=>{const m=l.stride,v=i.M();return i.c0(v,0,i.a3,-i.a3,0,0,1),i.N(v,v,[0,-i.a3,0]),{u_matrix:v,u_image:1,u_dimension:[m,m],u_zoom:S.overscaledZ,u_unpack:l.getUnpackVector()}};function bw(S,l){const m=Math.pow(2,l.canonical.z),v=l.canonical.y;return[new i.a5(0,v/m).toLngLat().lat,new i.a5(0,(v+1)/m).toLngLat().lat]}const _w=(S,l,m=0)=>({u_image:0,u_unpack:l.getUnpackVector(),u_dimension:[l.stride,l.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:m,u_opacity:S.paint.get("color-relief-opacity")}),nd=(S,l,m,v)=>{const _=S.transform;return{u_translation:Xv(S,l,m),u_ratio:v/i.aG(l,1,_.zoom),u_device_pixel_ratio:S.pixelRatio,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},YP=(S,l,m,v,_)=>i.e(nd(S,l,m,v),{u_image:0,u_image_height:_}),ax=(S,l,m,v,_)=>{const P=S.transform,I=ix(l,P);return{u_translation:Xv(S,l,m),u_texsize:l.imageAtlasTexture.size,u_ratio:v/i.aG(l,1,P.zoom),u_device_pixel_ratio:S.pixelRatio,u_image:0,u_scale:[I,_.fromScale,_.toScale],u_fade:_.t,u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]]}},XP=(S,l,m,v,_)=>{const P=ix(l,S.transform);return i.e(nd(S,l,m,v),{u_tileratio:P,u_crossfade_from:_.fromScale,u_crossfade_to:_.toScale,u_image:0,u_mix:_.t,u_lineatlas_width:S.lineAtlas.width,u_lineatlas_height:S.lineAtlas.height})},QP=(S,l,m,v,_,P)=>{const I=ix(l,S.transform);return i.e(nd(S,l,m,v),{u_image:0,u_image_height:P,u_tileratio:I,u_crossfade_from:_.fromScale,u_crossfade_to:_.toScale,u_image_dash:1,u_mix:_.t,u_lineatlas_width:S.lineAtlas.width,u_lineatlas_height:S.lineAtlas.height})};function ix(S,l){return 1/i.aG(S,1,l.tileZoom)}function Xv(S,l,m){return i.aH(S.transform,l,m.paint.get("line-translate"),m.paint.get("line-translate-anchor"))}const ww=(S,l,m,v,_)=>{return{u_tl_parent:S,u_scale_parent:l,u_buffer_scale:1,u_fade_t:m.mix,u_opacity:m.opacity*v.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:v.paint.get("raster-brightness-min"),u_brightness_high:v.paint.get("raster-brightness-max"),u_saturation_factor:(I=v.paint.get("raster-saturation"),I>0?1-1/(1.001-I):-I),u_contrast_factor:(P=v.paint.get("raster-contrast"),P>0?1/(1-P):1+P),u_spin_weights:Qv(v.paint.get("raster-hue-rotate")),u_coords_top:[_[0].x,_[0].y,_[1].x,_[1].y],u_coords_bottom:[_[3].x,_[3].y,_[2].x,_[2].y]};var P,I};function Qv(S){S*=Math.PI/180;const l=Math.sin(S),m=Math.cos(S);return[(2*m+1)/3,(-Math.sqrt(3)*l-m+1)/3,(Math.sqrt(3)*l-m+1)/3]}const Jv=(S,l,m,v,_,P,I,z,q,G,Y,le,ie)=>{const fe=I.transform;return{u_is_size_zoom_constant:+(S==="constant"||S==="source"),u_is_size_feature_constant:+(S==="constant"||S==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:fe.cameraToCenterDistance,u_pitch:fe.pitch/360*2*Math.PI,u_rotate_symbol:+m,u_aspect_ratio:fe.width/fe.height,u_fade_change:I.options.fadeDuration?I.symbolFadeChange:1,u_label_plane_matrix:z,u_coord_matrix:q,u_is_text:+Y,u_pitch_with_map:+v,u_is_along_line:_,u_is_variable_anchor:P,u_texsize:le,u_texture:0,u_translation:G,u_pitched_scale:ie}},uf=(S,l,m,v,_,P,I,z,q,G,Y,le,ie,fe)=>{const _e=I.transform;return i.e(Jv(S,l,m,v,_,P,I,z,q,G,Y,le,fe),{u_gamma_scale:v?Math.cos(_e.pitch*Math.PI/180)*_e.cameraToCenterDistance:1,u_device_pixel_ratio:I.pixelRatio,u_is_halo:1})},cc=(S,l,m,v,_,P,I,z,q,G,Y,le,ie)=>i.e(uf(S,l,m,v,_,P,I,z,q,G,!0,Y,0,ie),{u_texsize_icon:le,u_texture_icon:1}),ej=(S,l)=>({u_opacity:S,u_color:l}),tj=(S,l,m,v,_)=>i.e(function(P,I,z,q){const G=z.imageManager.getPattern(P.from.toString()),Y=z.imageManager.getPattern(P.to.toString()),{width:le,height:ie}=z.imageManager.getPixelSize(),fe=Math.pow(2,q.tileID.overscaledZ),_e=q.tileSize*Math.pow(2,z.transform.tileZoom)/fe,Ee=_e*(q.tileID.canonical.x+q.tileID.wrap*fe),Oe=_e*q.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:G.tl,u_pattern_br_a:G.br,u_pattern_tl_b:Y.tl,u_pattern_br_b:Y.br,u_texsize:[le,ie],u_mix:I.t,u_pattern_size_a:G.displaySize,u_pattern_size_b:Y.displaySize,u_scale_a:I.fromScale,u_scale_b:I.toScale,u_tile_units_to_pixels:1/i.aG(q,1,z.transform.tileZoom),u_pixel_coord_upper:[Ee>>16,Oe>>16],u_pixel_coord_lower:[65535&Ee,65535&Oe]}}(m,_,l,v),{u_opacity:S}),ox=(S,l)=>{},Nw={fillExtrusion:(S,l)=>({u_lightpos:new i.bX(S,l.u_lightpos),u_lightpos_globe:new i.bX(S,l.u_lightpos_globe),u_lightintensity:new i.bj(S,l.u_lightintensity),u_lightcolor:new i.bX(S,l.u_lightcolor),u_vertical_gradient:new i.bj(S,l.u_vertical_gradient),u_opacity:new i.bj(S,l.u_opacity),u_fill_translate:new i.bY(S,l.u_fill_translate)}),fillExtrusionPattern:(S,l)=>({u_lightpos:new i.bX(S,l.u_lightpos),u_lightpos_globe:new i.bX(S,l.u_lightpos_globe),u_lightintensity:new i.bj(S,l.u_lightintensity),u_lightcolor:new i.bX(S,l.u_lightcolor),u_vertical_gradient:new i.bj(S,l.u_vertical_gradient),u_height_factor:new i.bj(S,l.u_height_factor),u_opacity:new i.bj(S,l.u_opacity),u_fill_translate:new i.bY(S,l.u_fill_translate),u_image:new i.bT(S,l.u_image),u_texsize:new i.bY(S,l.u_texsize),u_pixel_coord_upper:new i.bY(S,l.u_pixel_coord_upper),u_pixel_coord_lower:new i.bY(S,l.u_pixel_coord_lower),u_scale:new i.bX(S,l.u_scale),u_fade:new i.bj(S,l.u_fade)}),fill:(S,l)=>({u_fill_translate:new i.bY(S,l.u_fill_translate)}),fillPattern:(S,l)=>({u_image:new i.bT(S,l.u_image),u_texsize:new i.bY(S,l.u_texsize),u_pixel_coord_upper:new i.bY(S,l.u_pixel_coord_upper),u_pixel_coord_lower:new i.bY(S,l.u_pixel_coord_lower),u_scale:new i.bX(S,l.u_scale),u_fade:new i.bj(S,l.u_fade),u_fill_translate:new i.bY(S,l.u_fill_translate)}),fillOutline:(S,l)=>({u_world:new i.bY(S,l.u_world),u_fill_translate:new i.bY(S,l.u_fill_translate)}),fillOutlinePattern:(S,l)=>({u_world:new i.bY(S,l.u_world),u_image:new i.bT(S,l.u_image),u_texsize:new i.bY(S,l.u_texsize),u_pixel_coord_upper:new i.bY(S,l.u_pixel_coord_upper),u_pixel_coord_lower:new i.bY(S,l.u_pixel_coord_lower),u_scale:new i.bX(S,l.u_scale),u_fade:new i.bj(S,l.u_fade),u_fill_translate:new i.bY(S,l.u_fill_translate)}),circle:(S,l)=>({u_camera_to_center_distance:new i.bj(S,l.u_camera_to_center_distance),u_scale_with_map:new i.bT(S,l.u_scale_with_map),u_pitch_with_map:new i.bT(S,l.u_pitch_with_map),u_extrude_scale:new i.bY(S,l.u_extrude_scale),u_device_pixel_ratio:new i.bj(S,l.u_device_pixel_ratio),u_globe_extrude_scale:new i.bj(S,l.u_globe_extrude_scale),u_translate:new i.bY(S,l.u_translate)}),collisionBox:(S,l)=>({u_pixel_extrude_scale:new i.bY(S,l.u_pixel_extrude_scale)}),collisionCircle:(S,l)=>({u_viewport_size:new i.bY(S,l.u_viewport_size)}),debug:(S,l)=>({u_color:new i.bU(S,l.u_color),u_overlay:new i.bT(S,l.u_overlay),u_overlay_scale:new i.bj(S,l.u_overlay_scale)}),depth:ox,clippingMask:ox,heatmap:(S,l)=>({u_extrude_scale:new i.bj(S,l.u_extrude_scale),u_intensity:new i.bj(S,l.u_intensity),u_globe_extrude_scale:new i.bj(S,l.u_globe_extrude_scale)}),heatmapTexture:(S,l)=>({u_matrix:new i.bV(S,l.u_matrix),u_world:new i.bY(S,l.u_world),u_image:new i.bT(S,l.u_image),u_color_ramp:new i.bT(S,l.u_color_ramp),u_opacity:new i.bj(S,l.u_opacity)}),hillshade:(S,l)=>({u_image:new i.bT(S,l.u_image),u_latrange:new i.bY(S,l.u_latrange),u_exaggeration:new i.bj(S,l.u_exaggeration),u_altitudes:new i.c2(S,l.u_altitudes),u_azimuths:new i.c2(S,l.u_azimuths),u_accent:new i.bU(S,l.u_accent),u_method:new i.bT(S,l.u_method),u_shadows:new i.c1(S,l.u_shadows),u_highlights:new i.c1(S,l.u_highlights)}),hillshadePrepare:(S,l)=>({u_matrix:new i.bV(S,l.u_matrix),u_image:new i.bT(S,l.u_image),u_dimension:new i.bY(S,l.u_dimension),u_zoom:new i.bj(S,l.u_zoom),u_unpack:new i.bW(S,l.u_unpack)}),colorRelief:(S,l)=>({u_image:new i.bT(S,l.u_image),u_unpack:new i.bW(S,l.u_unpack),u_dimension:new i.bY(S,l.u_dimension),u_elevation_stops:new i.bT(S,l.u_elevation_stops),u_color_stops:new i.bT(S,l.u_color_stops),u_color_ramp_size:new i.bT(S,l.u_color_ramp_size),u_opacity:new i.bj(S,l.u_opacity)}),line:(S,l)=>({u_translation:new i.bY(S,l.u_translation),u_ratio:new i.bj(S,l.u_ratio),u_device_pixel_ratio:new i.bj(S,l.u_device_pixel_ratio),u_units_to_pixels:new i.bY(S,l.u_units_to_pixels)}),lineGradient:(S,l)=>({u_translation:new i.bY(S,l.u_translation),u_ratio:new i.bj(S,l.u_ratio),u_device_pixel_ratio:new i.bj(S,l.u_device_pixel_ratio),u_units_to_pixels:new i.bY(S,l.u_units_to_pixels),u_image:new i.bT(S,l.u_image),u_image_height:new i.bj(S,l.u_image_height)}),linePattern:(S,l)=>({u_translation:new i.bY(S,l.u_translation),u_texsize:new i.bY(S,l.u_texsize),u_ratio:new i.bj(S,l.u_ratio),u_device_pixel_ratio:new i.bj(S,l.u_device_pixel_ratio),u_image:new i.bT(S,l.u_image),u_units_to_pixels:new i.bY(S,l.u_units_to_pixels),u_scale:new i.bX(S,l.u_scale),u_fade:new i.bj(S,l.u_fade)}),lineSDF:(S,l)=>({u_translation:new i.bY(S,l.u_translation),u_ratio:new i.bj(S,l.u_ratio),u_device_pixel_ratio:new i.bj(S,l.u_device_pixel_ratio),u_units_to_pixels:new i.bY(S,l.u_units_to_pixels),u_image:new i.bT(S,l.u_image),u_mix:new i.bj(S,l.u_mix),u_tileratio:new i.bj(S,l.u_tileratio),u_crossfade_from:new i.bj(S,l.u_crossfade_from),u_crossfade_to:new i.bj(S,l.u_crossfade_to),u_lineatlas_width:new i.bj(S,l.u_lineatlas_width),u_lineatlas_height:new i.bj(S,l.u_lineatlas_height)}),lineGradientSDF:(S,l)=>({u_translation:new i.bY(S,l.u_translation),u_ratio:new i.bj(S,l.u_ratio),u_device_pixel_ratio:new i.bj(S,l.u_device_pixel_ratio),u_units_to_pixels:new i.bY(S,l.u_units_to_pixels),u_image:new i.bT(S,l.u_image),u_image_height:new i.bj(S,l.u_image_height),u_tileratio:new i.bj(S,l.u_tileratio),u_crossfade_from:new i.bj(S,l.u_crossfade_from),u_crossfade_to:new i.bj(S,l.u_crossfade_to),u_image_dash:new i.bT(S,l.u_image_dash),u_mix:new i.bj(S,l.u_mix),u_lineatlas_width:new i.bj(S,l.u_lineatlas_width),u_lineatlas_height:new i.bj(S,l.u_lineatlas_height)}),raster:(S,l)=>({u_tl_parent:new i.bY(S,l.u_tl_parent),u_scale_parent:new i.bj(S,l.u_scale_parent),u_buffer_scale:new i.bj(S,l.u_buffer_scale),u_fade_t:new i.bj(S,l.u_fade_t),u_opacity:new i.bj(S,l.u_opacity),u_image0:new i.bT(S,l.u_image0),u_image1:new i.bT(S,l.u_image1),u_brightness_low:new i.bj(S,l.u_brightness_low),u_brightness_high:new i.bj(S,l.u_brightness_high),u_saturation_factor:new i.bj(S,l.u_saturation_factor),u_contrast_factor:new i.bj(S,l.u_contrast_factor),u_spin_weights:new i.bX(S,l.u_spin_weights),u_coords_top:new i.bW(S,l.u_coords_top),u_coords_bottom:new i.bW(S,l.u_coords_bottom)}),symbolIcon:(S,l)=>({u_is_size_zoom_constant:new i.bT(S,l.u_is_size_zoom_constant),u_is_size_feature_constant:new i.bT(S,l.u_is_size_feature_constant),u_size_t:new i.bj(S,l.u_size_t),u_size:new i.bj(S,l.u_size),u_camera_to_center_distance:new i.bj(S,l.u_camera_to_center_distance),u_pitch:new i.bj(S,l.u_pitch),u_rotate_symbol:new i.bT(S,l.u_rotate_symbol),u_aspect_ratio:new i.bj(S,l.u_aspect_ratio),u_fade_change:new i.bj(S,l.u_fade_change),u_label_plane_matrix:new i.bV(S,l.u_label_plane_matrix),u_coord_matrix:new i.bV(S,l.u_coord_matrix),u_is_text:new i.bT(S,l.u_is_text),u_pitch_with_map:new i.bT(S,l.u_pitch_with_map),u_is_along_line:new i.bT(S,l.u_is_along_line),u_is_variable_anchor:new i.bT(S,l.u_is_variable_anchor),u_texsize:new i.bY(S,l.u_texsize),u_texture:new i.bT(S,l.u_texture),u_translation:new i.bY(S,l.u_translation),u_pitched_scale:new i.bj(S,l.u_pitched_scale)}),symbolSDF:(S,l)=>({u_is_size_zoom_constant:new i.bT(S,l.u_is_size_zoom_constant),u_is_size_feature_constant:new i.bT(S,l.u_is_size_feature_constant),u_size_t:new i.bj(S,l.u_size_t),u_size:new i.bj(S,l.u_size),u_camera_to_center_distance:new i.bj(S,l.u_camera_to_center_distance),u_pitch:new i.bj(S,l.u_pitch),u_rotate_symbol:new i.bT(S,l.u_rotate_symbol),u_aspect_ratio:new i.bj(S,l.u_aspect_ratio),u_fade_change:new i.bj(S,l.u_fade_change),u_label_plane_matrix:new i.bV(S,l.u_label_plane_matrix),u_coord_matrix:new i.bV(S,l.u_coord_matrix),u_is_text:new i.bT(S,l.u_is_text),u_pitch_with_map:new i.bT(S,l.u_pitch_with_map),u_is_along_line:new i.bT(S,l.u_is_along_line),u_is_variable_anchor:new i.bT(S,l.u_is_variable_anchor),u_texsize:new i.bY(S,l.u_texsize),u_texture:new i.bT(S,l.u_texture),u_gamma_scale:new i.bj(S,l.u_gamma_scale),u_device_pixel_ratio:new i.bj(S,l.u_device_pixel_ratio),u_is_halo:new i.bT(S,l.u_is_halo),u_translation:new i.bY(S,l.u_translation),u_pitched_scale:new i.bj(S,l.u_pitched_scale)}),symbolTextAndIcon:(S,l)=>({u_is_size_zoom_constant:new i.bT(S,l.u_is_size_zoom_constant),u_is_size_feature_constant:new i.bT(S,l.u_is_size_feature_constant),u_size_t:new i.bj(S,l.u_size_t),u_size:new i.bj(S,l.u_size),u_camera_to_center_distance:new i.bj(S,l.u_camera_to_center_distance),u_pitch:new i.bj(S,l.u_pitch),u_rotate_symbol:new i.bT(S,l.u_rotate_symbol),u_aspect_ratio:new i.bj(S,l.u_aspect_ratio),u_fade_change:new i.bj(S,l.u_fade_change),u_label_plane_matrix:new i.bV(S,l.u_label_plane_matrix),u_coord_matrix:new i.bV(S,l.u_coord_matrix),u_is_text:new i.bT(S,l.u_is_text),u_pitch_with_map:new i.bT(S,l.u_pitch_with_map),u_is_along_line:new i.bT(S,l.u_is_along_line),u_is_variable_anchor:new i.bT(S,l.u_is_variable_anchor),u_texsize:new i.bY(S,l.u_texsize),u_texsize_icon:new i.bY(S,l.u_texsize_icon),u_texture:new i.bT(S,l.u_texture),u_texture_icon:new i.bT(S,l.u_texture_icon),u_gamma_scale:new i.bj(S,l.u_gamma_scale),u_device_pixel_ratio:new i.bj(S,l.u_device_pixel_ratio),u_is_halo:new i.bT(S,l.u_is_halo),u_translation:new i.bY(S,l.u_translation),u_pitched_scale:new i.bj(S,l.u_pitched_scale)}),background:(S,l)=>({u_opacity:new i.bj(S,l.u_opacity),u_color:new i.bU(S,l.u_color)}),backgroundPattern:(S,l)=>({u_opacity:new i.bj(S,l.u_opacity),u_image:new i.bT(S,l.u_image),u_pattern_tl_a:new i.bY(S,l.u_pattern_tl_a),u_pattern_br_a:new i.bY(S,l.u_pattern_br_a),u_pattern_tl_b:new i.bY(S,l.u_pattern_tl_b),u_pattern_br_b:new i.bY(S,l.u_pattern_br_b),u_texsize:new i.bY(S,l.u_texsize),u_mix:new i.bj(S,l.u_mix),u_pattern_size_a:new i.bY(S,l.u_pattern_size_a),u_pattern_size_b:new i.bY(S,l.u_pattern_size_b),u_scale_a:new i.bj(S,l.u_scale_a),u_scale_b:new i.bj(S,l.u_scale_b),u_pixel_coord_upper:new i.bY(S,l.u_pixel_coord_upper),u_pixel_coord_lower:new i.bY(S,l.u_pixel_coord_lower),u_tile_units_to_pixels:new i.bj(S,l.u_tile_units_to_pixels)}),terrain:(S,l)=>({u_texture:new i.bT(S,l.u_texture),u_ele_delta:new i.bj(S,l.u_ele_delta),u_fog_matrix:new i.bV(S,l.u_fog_matrix),u_fog_color:new i.bU(S,l.u_fog_color),u_fog_ground_blend:new i.bj(S,l.u_fog_ground_blend),u_fog_ground_blend_opacity:new i.bj(S,l.u_fog_ground_blend_opacity),u_horizon_color:new i.bU(S,l.u_horizon_color),u_horizon_fog_blend:new i.bj(S,l.u_horizon_fog_blend),u_is_globe_mode:new i.bj(S,l.u_is_globe_mode)}),terrainDepth:(S,l)=>({u_ele_delta:new i.bj(S,l.u_ele_delta)}),terrainCoords:(S,l)=>({u_texture:new i.bT(S,l.u_texture),u_terrain_coords_id:new i.bj(S,l.u_terrain_coords_id),u_ele_delta:new i.bj(S,l.u_ele_delta)}),projectionErrorMeasurement:(S,l)=>({u_input:new i.bj(S,l.u_input),u_output_expected:new i.bj(S,l.u_output_expected)}),atmosphere:(S,l)=>({u_sun_pos:new i.bX(S,l.u_sun_pos),u_atmosphere_blend:new i.bj(S,l.u_atmosphere_blend),u_globe_position:new i.bX(S,l.u_globe_position),u_globe_radius:new i.bj(S,l.u_globe_radius),u_inv_proj_matrix:new i.bV(S,l.u_inv_proj_matrix)}),sky:(S,l)=>({u_sky_color:new i.bU(S,l.u_sky_color),u_horizon_color:new i.bU(S,l.u_horizon_color),u_horizon:new i.bY(S,l.u_horizon),u_horizon_normal:new i.bY(S,l.u_horizon_normal),u_sky_horizon_blend:new i.bj(S,l.u_sky_horizon_blend),u_sky_blend:new i.bj(S,l.u_sky_blend)})};class rj{constructor(l,m,v){this.context=l;const _=l.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!v,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete m.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const m=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Yd={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class sj{constructor(l,m,v,_){this.length=m.length,this.attributes=v,this.itemSize=m.bytesPerElement,this.dynamicDraw=_,this.context=l;const P=l.gl;this.buffer=P.createBuffer(),l.bindVertexBuffer.set(this.buffer),P.bufferData(P.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||delete m.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){if(l.length!==this.length)throw new Error(`Length of new data is ${l.length}, which doesn't match current length of ${this.length}`);const m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,m){for(let v=0;v<this.attributes.length;v++){const _=m.attributes[this.attributes[v].name];_!==void 0&&l.enableVertexAttribArray(_)}}setVertexAttribPointers(l,m,v){for(let _=0;_<this.attributes.length;_++){const P=this.attributes[_],I=m.attributes[P.name];I!==void 0&&l.vertexAttribPointer(I,P.components,l[Yd[P.type]],!1,this.itemSize,P.offset+this.itemSize*(v||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Vs{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class JP extends Vs{getDefault(){return i.bi.transparent}set(l){const m=this.current;(l.r!==m.r||l.g!==m.g||l.b!==m.b||l.a!==m.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class ek extends Vs{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class tk extends Vs{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class Sw extends Vs{getDefault(){return[!0,!0,!0,!0]}set(l){const m=this.current;(l[0]!==m[0]||l[1]!==m[1]||l[2]!==m[2]||l[3]!==m[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class rk extends Vs{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class Cw extends Vs{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class lx extends Vs{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const m=this.current;(l.func!==m.func||l.ref!==m.ref||l.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class cx extends Vs{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const m=this.current;(l[0]!==m[0]||l[1]!==m[1]||l[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class dx extends Vs{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;l?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=l,this.dirty=!1}}class nj extends Vs{getDefault(){return[0,1]}set(l){const m=this.current;(l[0]!==m[0]||l[1]!==m[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class Xd extends Vs{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;l?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=l,this.dirty=!1}}class hf extends Vs{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class mh extends Vs{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;l?m.enable(m.BLEND):m.disable(m.BLEND),this.current=l,this.dirty=!1}}class Mo extends Vs{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const m=this.current;(l[0]!==m[0]||l[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class Pw extends Vs{getDefault(){return i.bi.transparent}set(l){const m=this.current;(l.r!==m.r||l.g!==m.g||l.b!==m.b||l.a!==m.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class kw extends Vs{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class aj extends Vs{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;l?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=l,this.dirty=!1}}class Qd extends Vs{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class ux extends Vs{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class hx extends Vs{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class mf extends Vs{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class mx extends Vs{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const m=this.current;(l[0]!==m[0]||l[1]!==m[1]||l[2]!==m[2]||l[3]!==m[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Aw extends Vs{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class fh extends Vs{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class ph extends Vs{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.bindTexture(m.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class Tw extends Vs{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class ij extends Vs{getDefault(){return null}set(l){const m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class ps extends Vs{getDefault(){return null}set(l){var m;if(l===this.current&&!this.dirty)return;const v=this.gl;To(v)?v.bindVertexArray(l):(m=v.getExtension("OES_vertex_array_object"))===null||m===void 0||m.bindVertexArrayOES(l),this.current=l,this.dirty=!1}}class fx extends Vs{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class sk extends Vs{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class Ew extends Vs{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class Jd extends Vs{constructor(l,m){super(l),this.context=l,this.parent=m}getDefault(){return null}}class nk extends Jd{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class ak extends Jd{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Mw extends Jd{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_STENCIL_ATTACHMENT,m.RENDERBUFFER,l),this.current=l,this.dirty=!1}}const Ow="Framebuffer is not complete";class oj{constructor(l,m,v,_,P){this.context=l,this.width=m,this.height=v;const I=l.gl,z=this.framebuffer=I.createFramebuffer();if(this.colorAttachment=new nk(l,z),_)this.depthAttachment=P?new Mw(l,z):new ak(l,z);else if(P)throw new Error("Stencil cannot be set without depth");if(I.checkFramebufferStatus(I.FRAMEBUFFER)!==I.FRAMEBUFFER_COMPLETE)throw new Error(Ow)}destroy(){const l=this.context.gl,m=this.colorAttachment.get();if(m&&l.deleteTexture(m),this.depthAttachment){const v=this.depthAttachment.get();v&&l.deleteRenderbuffer(v)}l.deleteFramebuffer(this.framebuffer)}}class px{constructor(l){var m,v;if(this.gl=l,this.clearColor=new JP(this),this.clearDepth=new ek(this),this.clearStencil=new tk(this),this.colorMask=new Sw(this),this.depthMask=new rk(this),this.stencilMask=new Cw(this),this.stencilFunc=new lx(this),this.stencilOp=new cx(this),this.stencilTest=new dx(this),this.depthRange=new nj(this),this.depthTest=new Xd(this),this.depthFunc=new hf(this),this.blend=new mh(this),this.blendFunc=new Mo(this),this.blendColor=new Pw(this),this.blendEquation=new kw(this),this.cullFace=new aj(this),this.cullFaceSide=new Qd(this),this.frontFace=new ux(this),this.program=new hx(this),this.activeTexture=new mf(this),this.viewport=new mx(this),this.bindFramebuffer=new Aw(this),this.bindRenderbuffer=new fh(this),this.bindTexture=new ph(this),this.bindVertexBuffer=new Tw(this),this.bindElementBuffer=new ij(this),this.bindVertexArray=new ps(this),this.pixelStoreUnpack=new fx(this),this.pixelStoreUnpackPremultiplyAlpha=new sk(this),this.pixelStoreUnpackFlipY=new Ew(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),To(l)){this.HALF_FLOAT=l.HALF_FLOAT;const _=l.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(m=l.RGBA16F)!==null&&m!==void 0?m:_==null?void 0:_.RGBA16F_EXT,this.RGB16F=(v=l.RGB16F)!==null&&v!==void 0?v:_==null?void 0:_.RGB16F_EXT,l.getExtension("EXT_color_buffer_float")}else{l.getExtension("EXT_color_buffer_half_float"),l.getExtension("OES_texture_half_float_linear");const _=l.getExtension("OES_texture_half_float");this.HALF_FLOAT=_==null?void 0:_.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,m){return new rj(this,l,m)}createVertexBuffer(l,m,v){return new sj(this,l,m,v)}createRenderbuffer(l,m,v){const _=this.gl,P=_.createRenderbuffer();return this.bindRenderbuffer.set(P),_.renderbufferStorage(_.RENDERBUFFER,l,m,v),this.bindRenderbuffer.set(null),P}createFramebuffer(l,m,v,_){return new oj(this,l,m,v,_)}clear({color:l,depth:m,stencil:v}){const _=this.gl;let P=0;l&&(P|=_.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),m!==void 0&&(P|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(m),this.depthMask.set(!0)),v!==void 0&&(P|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(v),this.stencilMask.set(255)),_.clear(P)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){i.bK(l.blendFunction,Ts.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}createVertexArray(){var l;return To(this.gl)?this.gl.createVertexArray():(l=this.gl.getExtension("OES_vertex_array_object"))===null||l===void 0?void 0:l.createVertexArrayOES()}deleteVertexArray(l){var m;return To(this.gl)?this.gl.deleteVertexArray(l):(m=this.gl.getExtension("OES_vertex_array_object"))===null||m===void 0?void 0:m.deleteVertexArrayOES(l)}unbindVAO(){this.bindVertexArray.set(null)}}let eu;function ff(S,l,m,v,_){const P=S.context,I=S.transform,z=P.gl,q=S.useProgram("collisionBox"),G=[];let Y=0,le=0;for(let Re=0;Re<v.length;Re++){const ze=v[Re],Ue=l.getTile(ze).getBucket(m);if(!Ue)continue;const $e=_?Ue.textCollisionBox:Ue.iconCollisionBox,We=Ue.collisionCircleArray;We.length>0&&(G.push({circleArray:We,circleOffset:le,coord:ze}),Y+=We.length/4,le=Y),$e&&q.draw(P,z.LINES,os.disabled,Cs.disabled,S.colorModeForRenderPass(),ds.disabled,vw(S.transform),S.style.map.terrain&&S.style.map.terrain.getTerrainData(ze),I.getProjectionData({overscaledTileID:ze,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),m.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,null,S.transform.zoom,null,null,$e.collisionVertexBuffer)}if(!_||!G.length)return;const ie=S.useProgram("collisionCircle"),fe=new i.c3;fe.resize(4*Y),fe._trim();let _e=0;for(const Re of G)for(let ze=0;ze<Re.circleArray.length/4;ze++){const Ue=4*ze,$e=Re.circleArray[Ue+0],We=Re.circleArray[Ue+1],Ye=Re.circleArray[Ue+2],Be=Re.circleArray[Ue+3];fe.emplace(_e++,$e,We,Ye,Be,0),fe.emplace(_e++,$e,We,Ye,Be,1),fe.emplace(_e++,$e,We,Ye,Be,2),fe.emplace(_e++,$e,We,Ye,Be,3)}(!eu||eu.length<2*Y)&&(eu=function(Re){const ze=2*Re,Ue=new i.c5;Ue.resize(ze),Ue._trim();for(let $e=0;$e<ze;$e++){const We=6*$e;Ue.uint16[We+0]=4*$e+0,Ue.uint16[We+1]=4*$e+1,Ue.uint16[We+2]=4*$e+2,Ue.uint16[We+3]=4*$e+2,Ue.uint16[We+4]=4*$e+3,Ue.uint16[We+5]=4*$e+0}return Ue}(Y));const Ee=P.createIndexBuffer(eu,!0),Oe=P.createVertexBuffer(fe,i.c4.members,!0);for(const Re of G){const ze=Kv(S.transform);ie.draw(P,z.TRIANGLES,os.disabled,Cs.disabled,S.colorModeForRenderPass(),ds.disabled,ze,S.style.map.terrain&&S.style.map.terrain.getTerrainData(Re.coord),null,m.id,Oe,Ee,i.aQ.simpleSegment(0,2*Re.circleOffset,Re.circleArray.length,Re.circleArray.length/2),null,S.transform.zoom,null,null,null)}Oe.destroy(),Ee.destroy()}const lj=i.am(new Float32Array(16));function Iw(S,l,m,v,_,P){const{horizontalAlign:I,verticalAlign:z}=i.aL(S);return new i.P((-(I-.5)*l/_+v[0])*P,(-(z-.5)*m/_+v[1])*P)}function xx(S,l,m,v,_,P){const I=l.tileAnchorPoint.add(new i.P(l.translation[0],l.translation[1]));if(l.pitchWithMap){let z=v.mult(P);m||(z=z.rotate(-_));const q=I.add(z);return Kt(q.x,q.y,l.pitchedLabelPlaneMatrix,l.getElevation).point}if(m){const z=Sl(l.tileAnchorPoint.x+1,l.tileAnchorPoint.y,l).point.sub(S),q=Math.atan(z.y/z.x)+(z.x<0?Math.PI:0);return S.add(v.rotate(q))}return S.add(v)}function gx(S,l,m,v,_,P,I,z,q,G,Y,le){const ie=S.text.placedSymbolArray,fe=S.text.dynamicLayoutVertexArray,_e=S.icon.dynamicLayoutVertexArray,Ee={};fe.clear();for(let Oe=0;Oe<ie.length;Oe++){const Re=ie.get(Oe),ze=Re.hidden||!Re.crossTileID||S.allowVerticalPlacement&&!Re.placedOrientation?null:v[Re.crossTileID];if(ze){const Ue=new i.P(Re.anchorX,Re.anchorY),$e={getElevation:le,width:_.width,height:_.height,pitchedLabelPlaneMatrix:P,pitchWithMap:m,transform:_,tileAnchorPoint:Ue,translation:G,unwrappedTileID:Y},We=m?Ym(Ue.x,Ue.y,$e):Sl(Ue.x,Ue.y,$e),Ye=Jr(_.cameraToCenterDistance,We.signedDistanceFromCamera);let Be=i.at(S.textSizeData,z,Re)*Ye/i.aF;m&&(Be*=S.tilePixelRatio/I);const{width:et,height:pt,anchor:ut,textOffset:mt,textBoxScale:xt}=ze,Ut=Iw(ut,et,pt,mt,xt,Be),Wt=_.getPitchedTextCorrection(Ue.x+G[0],Ue.y+G[1],Y),Dt=xx(We.point,$e,l,Ut,-_.bearingInRadians,Wt),jr=S.allowVerticalPlacement&&Re.placedOrientation===i.as.vertical?Math.PI/2:0;for(let Hr=0;Hr<Re.numGlyphs;Hr++)i.az(fe,Dt,jr);q&&Re.associatedIconIndex>=0&&(Ee[Re.associatedIconIndex]={shiftedAnchor:Dt,angle:jr})}else rh(Re.numGlyphs,fe)}if(q){_e.clear();const Oe=S.icon.placedSymbolArray;for(let Re=0;Re<Oe.length;Re++){const ze=Oe.get(Re);if(ze.hidden)rh(ze.numGlyphs,_e);else{const Ue=Ee[Re];if(Ue)for(let $e=0;$e<ze.numGlyphs;$e++)i.az(_e,Ue.shiftedAnchor,Ue.angle);else rh(ze.numGlyphs,_e)}}S.icon.dynamicLayoutVertexBuffer.updateData(_e)}S.text.dynamicLayoutVertexBuffer.updateData(fe)}function yx(S,l,m){return m.iconsInText&&l?"symbolTextAndIcon":S?"symbolSDF":"symbolIcon"}function tu(S,l,m,v,_,P,I,z,q,G,Y,le,ie){const fe=S.context,_e=fe.gl,Ee=S.transform,Oe=z==="map",Re=q==="map",ze=z!=="viewport"&&m.layout.get("symbol-placement")!=="point",Ue=Oe&&!Re&&!ze,$e=!m.layout.get("symbol-sort-key").isConstant();let We=!1;const Ye=S.getDepthModeForSublayer(0,os.ReadOnly),Be=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),et=[],pt=Ee.getCircleRadiusCorrection();for(const ut of v){const mt=l.getTile(ut),xt=mt.getBucket(m);if(!xt)continue;const Ut=_?xt.text:xt.icon;if(!Ut||!Ut.segments.get().length||!Ut.hasVisibleVertices)continue;const Wt=Ut.programConfigurations.get(m.id),Dt=_||xt.sdfIcons,jr=_?xt.textSizeData:xt.iconSizeData,Hr=Re||Ee.pitch!==0,Ks=S.useProgram(yx(Dt,_,xt),Wt),es=i.ar(jr,Ee.zoom),on=S.style.map.terrain&&S.style.map.terrain.getTerrainData(ut);let In,un,ga,Sn,Ia=[0,0],Cn=null;if(_)un=mt.glyphAtlasTexture,ga=_e.LINEAR,In=mt.glyphAtlasTexture.size,xt.iconsInText&&(Ia=mt.imageAtlasTexture.size,Cn=mt.imageAtlasTexture,Sn=Hr||S.options.rotating||S.options.zooming||jr.kind==="composite"||jr.kind==="camera"?_e.LINEAR:_e.NEAREST);else{const ia=m.layout.get("icon-size").constantOr(0)!==1||xt.iconsNeedLinear;un=mt.imageAtlasTexture,ga=Dt||S.options.rotating||S.options.zooming||ia||Hr?_e.LINEAR:_e.NEAREST,In=mt.imageAtlasTexture.size}const aa=i.aG(mt,1,S.transform.zoom),Ri=Mi(Oe,S.transform,aa),ou=i.M();i.au(ou,Ri);const pc=th(Re,Oe,S.transform,aa),Tl=i.aH(Ee,mt,P,I),lu=Ee.getProjectionData({overscaledTileID:ut,applyGlobeMatrix:!ie,applyTerrainMatrix:!0}),wh=Be&&xt.hasTextData(),cu=m.layout.get("icon-text-fit")!=="none"&&wh&&xt.hasIconData();if(ze){const ia=S.style.map.terrain?(Da,yn)=>S.style.map.terrain.getElevation(ut,Da,yn):null,Jn=m.layout.get("text-rotation-alignment")==="map";Xo(xt,S,_,Ri,ou,Re,G,Jn,ut.toUnwrapped(),Ee.width,Ee.height,Tl,ia)}const eo=_&&Be||cu,Li=ze||eo?lj:Re?Ri:S.transform.clipSpaceToPixelsMatrix,xc=Dt&&m.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let id;id=Dt?xt.iconsInText?cc(jr.kind,es,Ue,Re,ze,eo,S,Li,pc,Tl,In,Ia,pt):uf(jr.kind,es,Ue,Re,ze,eo,S,Li,pc,Tl,_,In,0,pt):Jv(jr.kind,es,Ue,Re,ze,eo,S,Li,pc,Tl,_,In,pt);const Sf={program:Ks,buffers:Ut,uniformValues:id,projectionData:lu,atlasTexture:un,atlasTextureIcon:Cn,atlasInterpolation:ga,atlasInterpolationIcon:Sn,isSDF:Dt,hasHalo:xc};if($e&&xt.canOverlap){We=!0;const ia=Ut.segments.get();for(const Jn of ia)et.push({segments:new i.aQ([Jn]),sortKey:Jn.sortKey,state:Sf,terrainData:on})}else et.push({segments:Ut.segments,sortKey:0,state:Sf,terrainData:on})}We&&et.sort((ut,mt)=>ut.sortKey-mt.sortKey);for(const ut of et){const mt=ut.state;if(fe.activeTexture.set(_e.TEXTURE0),mt.atlasTexture.bind(mt.atlasInterpolation,_e.CLAMP_TO_EDGE),mt.atlasTextureIcon&&(fe.activeTexture.set(_e.TEXTURE1),mt.atlasTextureIcon&&mt.atlasTextureIcon.bind(mt.atlasInterpolationIcon,_e.CLAMP_TO_EDGE)),mt.isSDF){const xt=mt.uniformValues;mt.hasHalo&&(xt.u_is_halo=1,vx(mt.buffers,ut.segments,m,S,mt.program,Ye,Y,le,xt,mt.projectionData,ut.terrainData)),xt.u_is_halo=0}vx(mt.buffers,ut.segments,m,S,mt.program,Ye,Y,le,mt.uniformValues,mt.projectionData,ut.terrainData)}}function vx(S,l,m,v,_,P,I,z,q,G,Y){const le=v.context;_.draw(le,le.gl.TRIANGLES,P,I,z,ds.backCCW,q,Y,G,m.id,S.layoutVertexBuffer,S.indexBuffer,l,m.paint,v.transform.zoom,S.programConfigurations.get(m.id),S.dynamicLayoutVertexBuffer,S.opacityVertexBuffer)}function ik(S,l,m,v,_){const P=S.context,I=P.gl,z=Cs.disabled,q=new Ts([I.ONE,I.ONE],i.bi.transparent,[!0,!0,!0,!0]),G=l.getBucket(m);if(!G)return;const Y=v.key;let le=m.heatmapFbos.get(Y);le||(le=Dw(P,l.tileSize,l.tileSize),m.heatmapFbos.set(Y,le)),P.bindFramebuffer.set(le.framebuffer),P.viewport.set([0,0,l.tileSize,l.tileSize]),P.clear({color:i.bi.transparent});const ie=G.programConfigurations.get(m.id),fe=S.useProgram("heatmap",ie,!_),_e=S.transform.getProjectionData({overscaledTileID:l.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Ee=S.style.map.terrain.getTerrainData(v);fe.draw(P,I.TRIANGLES,os.disabled,z,q,ds.disabled,Zv(l,S.transform.zoom,m.paint.get("heatmap-intensity"),1),Ee,_e,m.id,G.layoutVertexBuffer,G.indexBuffer,G.segments,m.paint,S.transform.zoom,ie)}function pf(S,l,m,v,_){const P=S.context,I=P.gl,z=S.transform;P.setColorMode(S.colorModeForRenderPass());const q=cj(P,l),G=m.key,Y=l.heatmapFbos.get(G);if(!Y)return;P.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,Y.colorAttachment.get()),P.activeTexture.set(I.TEXTURE1),q.bind(I.LINEAR,I.CLAMP_TO_EDGE);const le=z.getProjectionData({overscaledTileID:m,applyTerrainMatrix:_,applyGlobeMatrix:!v});S.useProgram("heatmapTexture").draw(P,I.TRIANGLES,os.disabled,Cs.disabled,S.colorModeForRenderPass(),ds.disabled,Yv(S,l,0,1),null,le,l.id,S.rasterBoundsBuffer,S.quadTriangleIndexBuffer,S.rasterBoundsSegments,l.paint,z.zoom),Y.destroy(),l.heatmapFbos.delete(G)}function Dw(S,l,m){var v,_;const P=S.gl,I=P.createTexture();P.bindTexture(P.TEXTURE_2D,I),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_S,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_T,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MIN_FILTER,P.LINEAR),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MAG_FILTER,P.LINEAR);const z=(v=S.HALF_FLOAT)!==null&&v!==void 0?v:P.UNSIGNED_BYTE,q=(_=S.RGBA16F)!==null&&_!==void 0?_:P.RGBA;P.texImage2D(P.TEXTURE_2D,0,q,l,m,0,P.RGBA,z,null);const G=S.createFramebuffer(l,m,!1,!1);return G.colorAttachment.set(I),G}function cj(S,l){return l.colorRampTexture||(l.colorRampTexture=new i.T(S,l.colorRamp,S.gl.RGBA)),l.colorRampTexture}function xf(S,l,m,v,_,P,I,z){let q=256;if(_.stepInterpolant){const G=l.getSource().maxzoom,Y=I.canonical.z===G?Math.ceil(1<<S.transform.maxZoom-I.canonical.z):1;q=i.ai(i.c7(P.maxLineLength/i.a3*1024*Y),256,m.maxTextureSize)}return z.gradient=i.c8({expression:_.gradientExpression(),evaluationKey:"lineProgress",resolution:q,image:z.gradient||void 0,clips:P.lineClipsArray}),z.texture?z.texture.update(z.gradient):z.texture=new i.T(m,z.gradient,v.RGBA),z.version=_.gradientVersion,z.texture}function dj(S,l,m,v,_){S.activeTexture.set(l.TEXTURE0),m.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),v.updatePaintBuffers(_)}function Rw(S,l,m,v,_,P){(_||S.lineAtlas.dirty)&&(l.activeTexture.set(m.TEXTURE0),S.lineAtlas.bind(l)),v.updatePaintBuffers(P)}function Lw(S,l,m,v,_,P,I){const z=P.gradients[_.id];let q=z.texture;_.gradientVersion!==z.version&&(q=xf(S,l,m,v,_,P,I,z)),m.activeTexture.set(v.TEXTURE0),q.bind(_.stepInterpolant?v.NEAREST:v.LINEAR,v.CLAMP_TO_EDGE)}function jx(S,l,m,v,_,P,I,z,q){const G=P.gradients[_.id];let Y=G.texture;_.gradientVersion!==G.version&&(Y=xf(S,l,m,v,_,P,I,G)),m.activeTexture.set(v.TEXTURE0),Y.bind(_.stepInterpolant?v.NEAREST:v.LINEAR,v.CLAMP_TO_EDGE),m.activeTexture.set(v.TEXTURE1),S.lineAtlas.bind(m),z.updatePaintBuffers(q)}function bx(S,l,m,v,_){if(!m||!v||!v.imageAtlas)return;const P=v.imageAtlas.patternPositions;let I=P[m.to.toString()],z=P[m.from.toString()];if(!I&&z&&(I=z),!z&&I&&(z=I),!I||!z){const q=_.getPaintProperty(l);I=P[q],z=P[q]}I&&z&&S.setConstantPatternPositions(I,z)}function Fw(S,l,m,v,_,P,I,z){const q=S.context.gl,G="fill-pattern",Y=m.paint.get(G),le=Y&&Y.constantOr(1),ie=m.getCrossfadeParameters();let fe,_e,Ee,Oe,Re;const ze=S.transform,Ue=m.paint.get("fill-translate"),$e=m.paint.get("fill-translate-anchor");I?(_e=le&&!m.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",fe=q.LINES):(_e=le?"fillPattern":"fill",fe=q.TRIANGLES);const We=Y.constantOr(null);for(const Ye of v){const Be=l.getTile(Ye);if(le&&!Be.patternsLoaded())continue;const et=Be.getBucket(m);if(!et)continue;const pt=et.programConfigurations.get(m.id),ut=S.useProgram(_e,pt),mt=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Ye);le&&(S.context.activeTexture.set(q.TEXTURE0),Be.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),pt.updatePaintBuffers(ie)),bx(pt,G,We,Be,m);const xt=ze.getProjectionData({overscaledTileID:Ye,applyGlobeMatrix:!z,applyTerrainMatrix:!0}),Ut=i.aH(ze,Be,Ue,$e);if(I){Oe=et.indexBuffer2,Re=et.segments2;const Dt=[q.drawingBufferWidth,q.drawingBufferHeight];Ee=_e==="fillOutlinePattern"&&le?yw(S,ie,Be,Dt,Ut):HP(Dt,Ut)}else Oe=et.indexBuffer,Re=et.segments,Ee=le?Hd(S,ie,Be,Ut):{u_fill_translate:Ut};const Wt=S.stencilModeForClipping(Ye);ut.draw(S.context,fe,_,Wt,P,ds.backCCW,Ee,mt,xt,m.id,et.layoutVertexBuffer,Oe,Re,m.paint,S.transform.zoom,pt)}}function _x(S,l,m,v,_,P,I,z){const q=S.context,G=q.gl,Y="fill-extrusion-pattern",le=m.paint.get(Y),ie=le.constantOr(1),fe=m.getCrossfadeParameters(),_e=m.paint.get("fill-extrusion-opacity"),Ee=le.constantOr(null),Oe=S.transform;for(const Re of v){const ze=l.getTile(Re),Ue=ze.getBucket(m);if(!Ue)continue;const $e=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Re),We=Ue.programConfigurations.get(m.id),Ye=S.useProgram(ie?"fillExtrusionPattern":"fillExtrusion",We);ie&&(S.context.activeTexture.set(G.TEXTURE0),ze.imageAtlasTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),We.updatePaintBuffers(fe));const Be=Oe.getProjectionData({overscaledTileID:Re,applyGlobeMatrix:!z,applyTerrainMatrix:!0});bx(We,Y,Ee,ze,m);const et=i.aH(Oe,ze,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),pt=m.paint.get("fill-extrusion-vertical-gradient"),ut=ie?KP(S,pt,_e,et,Re,fe,ze):df(S,pt,_e,et);Ye.draw(q,q.gl.TRIANGLES,_,P,I,ds.backCCW,ut,$e,Be,m.id,Ue.layoutVertexBuffer,Ue.indexBuffer,Ue.segments,m.paint,S.transform.zoom,We,S.style.map.terrain&&Ue.centroidVertexBuffer)}}function Mn(S,l,m,v,_,P,I,z,q){var G;const Y=S.style.projection,le=S.context,ie=S.transform,fe=le.gl,_e=[`#define NUM_ILLUMINATION_SOURCES ${m.paint.get("hillshade-highlight-color").values.length}`],Ee=S.useProgram("hillshade",null,!1,_e),Oe=!S.options.moving;for(const Re of v){const ze=l.getTile(Re),Ue=ze.fbo;if(!Ue)continue;const $e=Y.getMeshFromTileID(le,Re.canonical,z,!0,"raster"),We=(G=S.style.map.terrain)===null||G===void 0?void 0:G.getTerrainData(Re);le.activeTexture.set(fe.TEXTURE0),fe.bindTexture(fe.TEXTURE_2D,Ue.colorAttachment.get());const Ye=ie.getProjectionData({overscaledTileID:Re,aligned:Oe,applyGlobeMatrix:!q,applyTerrainMatrix:!0});Ee.draw(le,fe.TRIANGLES,P,_[Re.overscaledZ],I,ds.backCCW,jw(S,ze,m),We,Ye,m.id,$e.vertexBuffer,$e.indexBuffer,$e.segments)}}function dc(S,l,m,v,_,P,I,z,q){var G;const Y=S.style.projection,le=S.context,ie=S.transform,fe=le.gl,_e=S.useProgram("colorRelief"),Ee=!S.options.moving;let Oe=!0,Re=0;for(const ze of v){const Ue=l.getTile(ze),$e=Ue.dem;if(Oe){const ut=fe.getParameter(fe.MAX_TEXTURE_SIZE),{elevationTexture:mt,colorTexture:xt}=m.getColorRampTextures(le,ut,$e.getUnpackVector());le.activeTexture.set(fe.TEXTURE1),mt.bind(fe.NEAREST,fe.CLAMP_TO_EDGE),le.activeTexture.set(fe.TEXTURE4),xt.bind(fe.LINEAR,fe.CLAMP_TO_EDGE),Oe=!1,Re=mt.size[0]}if(!$e||!$e.data)continue;const We=$e.stride,Ye=$e.getPixels();if(le.activeTexture.set(fe.TEXTURE0),le.pixelStoreUnpackPremultiplyAlpha.set(!1),Ue.demTexture=Ue.demTexture||S.getTileTexture(We),Ue.demTexture){const ut=Ue.demTexture;ut.update(Ye,{premultiply:!1}),ut.bind(fe.LINEAR,fe.CLAMP_TO_EDGE)}else Ue.demTexture=new i.T(le,Ye,fe.RGBA,{premultiply:!1}),Ue.demTexture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE);const Be=Y.getMeshFromTileID(le,ze.canonical,z,!0,"raster"),et=(G=S.style.map.terrain)===null||G===void 0?void 0:G.getTerrainData(ze),pt=ie.getProjectionData({overscaledTileID:ze,aligned:Ee,applyGlobeMatrix:!q,applyTerrainMatrix:!0});_e.draw(le,fe.TRIANGLES,P,_[ze.overscaledZ],I,ds.backCCW,_w(m,Ue.dem,Re),et,pt,m.id,Be.vertexBuffer,Be.indexBuffer,Be.segments)}}const Qi=[new i.P(0,0),new i.P(i.a3,0),new i.P(i.a3,i.a3),new i.P(0,i.a3)];function xh(S,l,m,v,_,P,I,z,q=!1,G=!1){const Y=v[v.length-1].overscaledZ,le=S.context,ie=le.gl,fe=S.useProgram("raster"),_e=S.transform,Ee=S.style.projection,Oe=S.colorModeForRenderPass(),Re=!S.options.moving,ze=m.paint.get("raster-opacity"),Ue=m.paint.get("raster-resampling"),$e=m.paint.get("raster-fade-duration"),We=!!S.style.map.terrain;for(const Ye of v){const Be=S.getDepthModeForSublayer(Ye.overscaledZ-Y,ze===1?os.ReadWrite:os.ReadOnly,ie.LESS),et=l.getTile(Ye),pt=Ue==="nearest"?ie.NEAREST:ie.LINEAR;le.activeTexture.set(ie.TEXTURE0),et.texture.bind(pt,ie.CLAMP_TO_EDGE,ie.LINEAR_MIPMAP_NEAREST),le.activeTexture.set(ie.TEXTURE1);const{parentTile:ut,parentScaleBy:mt,parentTopLeft:xt,fadeValues:Ut}=wx(et,l,$e,We);et.fadeOpacity=Ut.tileOpacity,ut?(ut.fadeOpacity=Ut.parentTileOpacity,ut.texture.bind(pt,ie.CLAMP_TO_EDGE,ie.LINEAR_MIPMAP_NEAREST)):et.texture.bind(pt,ie.CLAMP_TO_EDGE,ie.LINEAR_MIPMAP_NEAREST),et.texture.useMipmap&&le.extTextureFilterAnisotropic&&S.transform.pitch>20&&ie.texParameterf(ie.TEXTURE_2D,le.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,le.extTextureFilterAnisotropicMax);const Wt=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Ye),Dt=_e.getProjectionData({overscaledTileID:Ye,aligned:Re,applyGlobeMatrix:!G,applyTerrainMatrix:!0}),jr=ww(xt,mt,Ut.fadeMix,m,z),Hr=Ee.getMeshFromTileID(le,Ye.canonical,P,I,"raster");fe.draw(le,ie.TRIANGLES,Be,_?_[Ye.overscaledZ]:Cs.disabled,Oe,q?ds.frontCCW:ds.backCCW,jr,Wt,Dt,m.id,Hr.vertexBuffer,Hr.indexBuffer,Hr.segments)}}function wx(S,l,m,v){const _={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(m===0||v)return _;if(S.fadingParentID){const P=l.getLoadedTile(S.fadingParentID);if(!P)return _;const I=Math.pow(2,P.tileID.overscaledZ-S.tileID.overscaledZ),z=[S.tileID.canonical.x*I%1,S.tileID.canonical.y*I%1],q=function(G,Y,le){const ie=T(),fe=(ie-Y.timeAdded)/le,_e=G.fadingDirection===Fe.Incoming,Ee=i.ai((ie-G.timeAdded)/le,0,1),Oe=i.ai(1-fe,0,1),Re=_e?Ee:Oe;return{tileOpacity:Re,parentTileOpacity:_e?Oe:Ee,fadeMix:{opacity:1,mix:1-Re}}}(S,P,m);return{parentTile:P,parentScaleBy:I,parentTopLeft:z,fadeValues:q}}if(S.selfFading){const P=function(I,z){const q=(T()-I.timeAdded)/z,G=i.ai(q,0,1);return{tileOpacity:G,fadeMix:{opacity:G,mix:0}}}(S,m);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:P}}return _}const $w=new i.bi(1,0,0,1),gh=new i.bi(0,1,0,1),uj=new i.bi(0,0,1,1),gf=new i.bi(1,0,1,1),hj=new i.bi(0,1,1,1);function mj(S,l,m,v){yf(S,0,l+m/2,S.transform.width,m,v)}function fj(S,l,m,v){yf(S,l-m/2,0,m,S.transform.height,v)}function yf(S,l,m,v,_,P){const I=S.context,z=I.gl;z.enable(z.SCISSOR_TEST),z.scissor(l*S.pixelRatio,m*S.pixelRatio,v*S.pixelRatio,_*S.pixelRatio),I.clear({color:P}),z.disable(z.SCISSOR_TEST)}function zw(S,l,m){const v=S.context,_=v.gl,P=S.useProgram("debug"),I=os.disabled,z=Cs.disabled,q=S.colorModeForRenderPass(),G="$debug",Y=S.style.map.terrain&&S.style.map.terrain.getTerrainData(m);v.activeTexture.set(_.TEXTURE0);const le=l.getTileByID(m.key).latestRawTileData,ie=Math.floor((le&&le.byteLength||0)/1024),fe=l.getTile(m).tileSize,_e=512/Math.min(fe,512)*(m.overscaledZ/S.transform.zoom)*.5;let Ee=m.canonical.toString();m.overscaledZ!==m.canonical.z&&(Ee+=` => ${m.overscaledZ}`),function(Re,ze){Re.initDebugOverlayCanvas();const Ue=Re.debugOverlayCanvas,$e=Re.context.gl,We=Re.debugOverlayCanvas.getContext("2d");We.clearRect(0,0,Ue.width,Ue.height),We.shadowColor="white",We.shadowBlur=2,We.lineWidth=1.5,We.strokeStyle="white",We.textBaseline="top",We.font="bold 36px Open Sans, sans-serif",We.fillText(ze,5,5),We.strokeText(ze,5,5),Re.debugOverlayTexture.update(Ue),Re.debugOverlayTexture.bind($e.LINEAR,$e.CLAMP_TO_EDGE)}(S,`${Ee} ${ie}kB`);const Oe=S.transform.getProjectionData({overscaledTileID:m,applyGlobeMatrix:!0,applyTerrainMatrix:!0});P.draw(v,_.TRIANGLES,I,z,Ts.alphaBlended,ds.disabled,Hv(i.bi.transparent,_e),null,Oe,G,S.debugBuffer,S.quadTriangleIndexBuffer,S.debugSegments),P.draw(v,_.LINE_STRIP,I,z,q,ds.disabled,Hv(i.bi.red),Y,Oe,G,S.debugBuffer,S.tileBorderIndexBuffer,S.debugSegments)}function pj(S,l,m,v){const{isRenderingGlobe:_}=v,P=S.context,I=P.gl,z=S.transform,q=S.colorModeForRenderPass(),G=S.getDepthModeFor3D(),Y=S.useProgram("terrain");P.bindFramebuffer.set(null),P.viewport.set([0,0,S.width,S.height]);for(const le of m){const ie=l.getTerrainMesh(le.tileID),fe=S.renderToTexture.getTexture(le),_e=l.getTerrainData(le.tileID);P.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,fe.texture);const Ee=l.getMeshFrameDelta(z.zoom),Oe=z.calculateFogMatrix(le.tileID.toUnwrapped()),Re=GP(Ee,Oe,S.style.sky,z.pitch,_),ze=z.getProjectionData({overscaledTileID:le.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Y.draw(P,I.TRIANGLES,G,Cs.disabled,q,ds.backCCW,Re,_e,ze,"terrain",ie.vertexBuffer,ie.indexBuffer,ie.segments)}}function ad(S,l){if(!l.mesh){const m=new i.aP;m.emplaceBack(-1,-1),m.emplaceBack(1,-1),m.emplaceBack(1,1),m.emplaceBack(-1,1);const v=new i.aR;v.emplaceBack(0,1,2),v.emplaceBack(0,2,3),l.mesh=new oh(S.createVertexBuffer(m,Cl.members),S.createIndexBuffer(v),i.aQ.simpleSegment(0,0,m.length,v.length))}return l.mesh}class Bw{constructor(l,m){this.context=new px(l),this.transform=m,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:i.am(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Bs.maxUnderzooming+Bs.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new oc}resize(l,m,v){if(this.width=Math.floor(l*v),this.height=Math.floor(m*v),this.pixelRatio=v,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style._order)this.style._layers[_].resize()}setup(){const l=this.context,m=new i.aP;m.emplaceBack(0,0),m.emplaceBack(i.a3,0),m.emplaceBack(0,i.a3),m.emplaceBack(i.a3,i.a3),this.tileExtentBuffer=l.createVertexBuffer(m,Cl.members),this.tileExtentSegments=i.aQ.simpleSegment(0,0,4,2);const v=new i.aP;v.emplaceBack(0,0),v.emplaceBack(i.a3,0),v.emplaceBack(0,i.a3),v.emplaceBack(i.a3,i.a3),this.debugBuffer=l.createVertexBuffer(v,Cl.members),this.debugSegments=i.aQ.simpleSegment(0,0,4,5);const _=new i.ca;_.emplaceBack(0,0,0,0),_.emplaceBack(i.a3,0,i.a3,0),_.emplaceBack(0,i.a3,0,i.a3),_.emplaceBack(i.a3,i.a3,i.a3,i.a3),this.rasterBoundsBuffer=l.createVertexBuffer(_,Wv.members),this.rasterBoundsSegments=i.aQ.simpleSegment(0,0,4,2);const P=new i.aP;P.emplaceBack(0,0),P.emplaceBack(i.a3,0),P.emplaceBack(0,i.a3),P.emplaceBack(i.a3,i.a3),this.rasterBoundsBufferPosOnly=l.createVertexBuffer(P,Cl.members),this.rasterBoundsSegmentsPosOnly=i.aQ.simpleSegment(0,0,4,5);const I=new i.aP;I.emplaceBack(0,0),I.emplaceBack(1,0),I.emplaceBack(0,1),I.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(I,Cl.members),this.viewportSegments=i.aQ.simpleSegment(0,0,4,2);const z=new i.cb;z.emplaceBack(0),z.emplaceBack(1),z.emplaceBack(3),z.emplaceBack(2),z.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(z);const q=new i.aR;q.emplaceBack(1,0,2),q.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(q);const G=this.context.gl;this.stencilClearMode=new Cs({func:G.ALWAYS,mask:0},0,255,G.ZERO,G.ZERO,G.ZERO),this.tileExtentMesh=new oh(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const l=this.context,m=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const v=i.M();i.c0(v,0,this.width,this.height,0,0,1),i.O(v,v,[m.drawingBufferWidth,m.drawingBufferHeight,0]);const _={mainMatrix:v,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:v};this.useProgram("clippingMask",null,!0).draw(l,m.TRIANGLES,os.disabled,this.stencilClearMode,Ts.disabled,ds.disabled,null,null,_,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(l,m,v){if(this.currentStencilSource===l.source||!l.isTileClipped()||!m||!m.length)return;this.currentStencilSource=l.source,this.nextStencilID+m.length>256&&this.clearStencil();const _=this.context;_.setColorMode(Ts.disabled),_.setDepthMode(os.disabled);const P={};for(const I of m)P[I.key]=this.nextStencilID++;this._renderTileMasks(P,m,v,!0),this._renderTileMasks(P,m,v,!1),this._tileClippingMaskIDs=P}_renderTileMasks(l,m,v,_){const P=this.context,I=P.gl,z=this.style.projection,q=this.transform,G=this.useProgram("clippingMask");for(const Y of m){const le=l[Y.key],ie=this.style.map.terrain&&this.style.map.terrain.getTerrainData(Y),fe=z.getMeshFromTileID(this.context,Y.canonical,_,!0,"stencil"),_e=q.getProjectionData({overscaledTileID:Y,applyGlobeMatrix:!v,applyTerrainMatrix:!0});G.draw(P,I.TRIANGLES,os.disabled,new Cs({func:I.ALWAYS,mask:0},le,255,I.KEEP,I.KEEP,I.REPLACE),Ts.disabled,v?ds.disabled:ds.backCCW,null,ie,_e,"$clipping",fe.vertexBuffer,fe.indexBuffer,fe.segments)}}_renderTilesDepthBuffer(){const l=this.context,m=l.gl,v=this.style.projection,_=this.transform,P=this.useProgram("depth"),I=this.getDepthModeFor3D(),z=Os(_,{tileSize:_.tileSize});for(const q of z){const G=this.style.map.terrain&&this.style.map.terrain.getTerrainData(q),Y=v.getMeshFromTileID(this.context,q.canonical,!0,!0,"raster"),le=_.getProjectionData({overscaledTileID:q,applyGlobeMatrix:!0,applyTerrainMatrix:!0});P.draw(l,m.TRIANGLES,I,Cs.disabled,Ts.disabled,ds.backCCW,null,G,le,"$clipping",Y.vertexBuffer,Y.indexBuffer,Y.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,m=this.context.gl;return new Cs({func:m.NOTEQUAL,mask:255},l,255,m.KEEP,m.KEEP,m.REPLACE)}stencilModeForClipping(l){const m=this.context.gl;return new Cs({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,m.KEEP,m.KEEP,m.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(l){const m=this.context.gl,v=l.sort((I,z)=>z.overscaledZ-I.overscaledZ),_=v[v.length-1].overscaledZ,P=v[0].overscaledZ-_+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();const I={};for(let z=0;z<P;z++)I[z+_]=new Cs({func:m.GEQUAL,mask:255},z+this.nextStencilID,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID+=P,[I,v]}return[{[_]:Cs.disabled},v]}stencilConfigForOverlapTwoPass(l){const m=this.context.gl,v=l.sort((I,z)=>z.overscaledZ-I.overscaledZ),_=v[v.length-1].overscaledZ,P=v[0].overscaledZ-_+1;if(this.clearStencil(),P>1){const I={},z={};for(let q=0;q<P;q++)I[q+_]=new Cs({func:m.GREATER,mask:255},P+1+q,255,m.KEEP,m.KEEP,m.REPLACE),z[q+_]=new Cs({func:m.GREATER,mask:255},1+q,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID=2*P+1,[I,z,v]}return this.nextStencilID=3,[{[_]:new Cs({func:m.GREATER,mask:255},2,255,m.KEEP,m.KEEP,m.REPLACE)},{[_]:new Cs({func:m.GREATER,mask:255},1,255,m.KEEP,m.KEEP,m.REPLACE)},v]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new Ts([l.CONSTANT_COLOR,l.ONE],new i.bi(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ts.unblended:Ts.alphaBlended}getDepthModeForSublayer(l,m,v){if(!this.opaquePassEnabledForLayer())return os.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new os(v||this.context.gl.LEQUAL,m,[_,_])}getDepthModeFor3D(){return new os(this.context.gl.LEQUAL,os.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,m){var v,_;this.style=l,this.options=m,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(T()),this.imageManager.beginFrame();const P=this.style._order,I=this.style.tileManagers,z={},q={},G={},Y={isRenderingToTexture:!1,isRenderingGlobe:((v=l.projection)===null||v===void 0?void 0:v.transitionState)>0};for(const ie in I){const fe=I[ie];fe.used&&fe.prepare(this.context),z[ie]=fe.getVisibleCoordinates(!1),q[ie]=z[ie].slice().reverse(),G[ie]=fe.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let ie=0;ie<P.length;ie++)if(this.style._layers[P[ie]].is3D()){this.opaquePassCutoff=ie;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const ie of P){const fe=this.style._layers[ie];if(!fe.hasOffscreenPass()||fe.isHidden(this.transform.zoom))continue;const _e=q[fe.source];(fe.type==="custom"||_e.length)&&this.renderLayer(this,I[fe.source],fe,_e,Y)}if((_=this.style.projection)===null||_===void 0||_.updateGPUdependent({context:this.context,useProgram:ie=>this.useProgram(ie)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:m.showOverdrawInspector?i.bi.black:i.bi.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(ie,fe){const _e=ie.context,Ee=_e.gl,Oe=((Ye,Be,et)=>{const pt=Math.cos(Be.rollInRadians),ut=Math.sin(Be.rollInRadians),mt=Pt(Be),xt=Be.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Ye.properties.get("sky-color"),u_horizon_color:Ye.properties.get("horizon-color"),u_horizon:[(Be.width/2-mt*ut)*et,(Be.height/2+mt*pt)*et],u_horizon_normal:[-ut,pt],u_sky_horizon_blend:Ye.properties.get("sky-horizon-blend")*Be.height/2*et,u_sky_blend:xt}})(fe,ie.style.map.transform,ie.pixelRatio),Re=new os(Ee.LEQUAL,os.ReadWrite,[0,1]),ze=Cs.disabled,Ue=ie.colorModeForRenderPass(),$e=ie.useProgram("sky"),We=ad(_e,fe);$e.draw(_e,Ee.TRIANGLES,Re,ze,Ue,ds.disabled,Oe,null,void 0,"sky",We.vertexBuffer,We.indexBuffer,We.segments)}(this,this.style.sky),this._showOverdrawInspector=m.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=P.length-1;this.currentLayer>=0;this.currentLayer--){const ie=this.style._layers[P[this.currentLayer]],fe=I[ie.source],_e=z[ie.source];this._renderTileClippingMasks(ie,_e,!1),this.renderLayer(this,fe,ie,_e,Y)}this.renderPass="translucent";let le=!1;for(this.currentLayer=0;this.currentLayer<P.length;this.currentLayer++){const ie=this.style._layers[P[this.currentLayer]],fe=I[ie.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(ie,Y))continue;this.opaquePassEnabledForLayer()||le||(le=!0,Y.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const _e=(ie.type==="symbol"?G:q)[ie.source];this._renderTileClippingMasks(ie,z[ie.source],!!this.renderToTexture),this.renderLayer(this,fe,ie,_e,Y)}if(Y.isRenderingGlobe&&function(ie,fe,_e){const Ee=ie.context,Oe=Ee.gl,Re=ie.useProgram("atmosphere"),ze=new os(Oe.LEQUAL,os.ReadOnly,[0,1]),Ue=ie.transform,$e=function(xt,Ut){const Wt=xt.properties.get("position"),Dt=[-Wt.x,-Wt.y,-Wt.z],jr=i.am(new Float64Array(16));return xt.properties.get("anchor")==="map"&&(i.b9(jr,jr,Ut.rollInRadians),i.ba(jr,jr,-Ut.pitchInRadians),i.b9(jr,jr,Ut.bearingInRadians),i.ba(jr,jr,Ut.center.lat*Math.PI/180),i.bC(jr,jr,-Ut.center.lng*Math.PI/180)),i.c9(Dt,Dt,jr),Dt}(_e,ie.transform),We=Ue.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Ye=fe.properties.get("atmosphere-blend")*We.projectionTransition;if(Ye===0)return;const Be=nf(Ue.worldSize,Ue.center.lat),et=Ue.inverseProjectionMatrix,pt=new Float64Array(4);pt[3]=1,i.aA(pt,pt,Ue.modelViewProjectionMatrix),pt[0]/=pt[3],pt[1]/=pt[3],pt[2]/=pt[3],pt[3]=1,i.aA(pt,pt,et),pt[0]/=pt[3],pt[1]/=pt[3],pt[2]/=pt[3],pt[3]=1;const ut=((xt,Ut,Wt,Dt,jr)=>({u_sun_pos:xt,u_atmosphere_blend:Ut,u_globe_position:Wt,u_globe_radius:Dt,u_inv_proj_matrix:jr}))($e,Ye,[pt[0],pt[1],pt[2]],Be,et),mt=ad(Ee,fe);Re.draw(Ee,Oe.TRIANGLES,ze,Cs.disabled,Ts.alphaBlended,ds.disabled,ut,null,null,"atmosphere",mt.vertexBuffer,mt.indexBuffer,mt.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const ie=function(fe,_e){let Ee=null;const Oe=Object.values(fe._layers).flatMap($e=>$e.source&&!$e.isHidden(_e)?[fe.tileManagers[$e.source]]:[]),Re=Oe.filter($e=>$e.getSource().type==="vector"),ze=Oe.filter($e=>$e.getSource().type!=="vector"),Ue=$e=>{(!Ee||Ee.getSource().maxzoom<$e.getSource().maxzoom)&&(Ee=$e)};return Re.forEach($e=>Ue($e)),Ee||ze.forEach($e=>Ue($e)),Ee}(this.style,this.transform.zoom);ie&&function(fe,_e,Ee){for(let Oe=0;Oe<Ee.length;Oe++)zw(fe,_e,Ee[Oe])}(this,ie,ie.getVisibleCoordinates())}this.options.showPadding&&function(ie){const fe=ie.transform.padding;mj(ie,ie.transform.height-(fe.top||0),3,$w),mj(ie,fe.bottom||0,3,gh),fj(ie,fe.left||0,3,uj),fj(ie,ie.transform.width-(fe.right||0),3,gf);const _e=ie.transform.centerPoint;(function(Ee,Oe,Re,ze){yf(Ee,Oe-1,Re-10,2,20,ze),yf(Ee,Oe-10,Re-1,20,2,ze)})(ie,_e.x,ie.transform.height-_e.y,hj)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(l){if(!this.style||!this.style.map||!this.style.map.terrain)return;const m=this.terrainFacilitator.matrix,v=this.transform.modelViewProjectionMatrix;let _=this.terrainFacilitator.dirty;_||(_=l?!i.cc(m,v):!i.cd(m,v)),_||(_=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),_&&(i.ce(m,v),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(P,I){const z=P.context,q=z.gl,G=P.transform,Y=Ts.unblended,le=new os(q.LEQUAL,os.ReadWrite,[0,1]),ie=I.tileManager.getRenderableTiles(),fe=P.useProgram("terrainDepth");z.bindFramebuffer.set(I.getFramebuffer("depth").framebuffer),z.viewport.set([0,0,P.width/devicePixelRatio,P.height/devicePixelRatio]),z.clear({color:i.bi.transparent,depth:1});for(const _e of ie){const Ee=I.getTerrainMesh(_e.tileID),Oe=I.getTerrainData(_e.tileID),Re=G.getProjectionData({overscaledTileID:_e.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),ze={u_ele_delta:I.getMeshFrameDelta(G.zoom)};fe.draw(z,q.TRIANGLES,le,Cs.disabled,Y,ds.backCCW,ze,Oe,Re,"terrain",Ee.vertexBuffer,Ee.indexBuffer,Ee.segments)}z.bindFramebuffer.set(null),z.viewport.set([0,0,P.width,P.height])}(this,this.style.map.terrain),function(P,I){const z=P.context,q=z.gl,G=P.transform,Y=Ts.unblended,le=new os(q.LEQUAL,os.ReadWrite,[0,1]),ie=I.getCoordsTexture(),fe=I.tileManager.getRenderableTiles(),_e=P.useProgram("terrainCoords");z.bindFramebuffer.set(I.getFramebuffer("coords").framebuffer),z.viewport.set([0,0,P.width/devicePixelRatio,P.height/devicePixelRatio]),z.clear({color:i.bi.transparent,depth:1}),I.coordsIndex=[];for(const Ee of fe){const Oe=I.getTerrainMesh(Ee.tileID),Re=I.getTerrainData(Ee.tileID);z.activeTexture.set(q.TEXTURE0),q.bindTexture(q.TEXTURE_2D,ie.texture);const ze={u_terrain_coords_id:(255-I.coordsIndex.length)/255,u_texture:0,u_ele_delta:I.getMeshFrameDelta(G.zoom)},Ue=G.getProjectionData({overscaledTileID:Ee.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});_e.draw(z,q.TRIANGLES,le,Cs.disabled,Y,ds.backCCW,ze,Re,Ue,"terrain",Oe.vertexBuffer,Oe.indexBuffer,Oe.segments),I.coordsIndex.push(Ee.tileID.key)}z.bindFramebuffer.set(null),z.viewport.set([0,0,P.width,P.height])}(this,this.style.map.terrain))}renderLayer(l,m,v,_,P){v.isHidden(this.transform.zoom)||(v.type==="background"||v.type==="custom"||(_||[]).length)&&(this.id=v.id,i.cf(v)?function(I,z,q,G,Y,le){if(I.renderPass!=="translucent")return;const{isRenderingToTexture:ie}=le,fe=Cs.disabled,_e=I.colorModeForRenderPass();(q._unevaluatedLayout.hasValue("text-variable-anchor")||q._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(Ee,Oe,Re,ze,Ue,$e,We,Ye,Be){const et=Oe.transform,pt=Oe.style.map.terrain,ut=Ue==="map",mt=$e==="map";for(const xt of Ee){const Ut=ze.getTile(xt),Wt=Ut.getBucket(Re);if(!Wt||!Wt.text||!Wt.text.segments.get().length)continue;const Dt=i.ar(Wt.textSizeData,et.zoom),jr=i.aG(Ut,1,Oe.transform.zoom),Hr=Mi(ut,Oe.transform,jr),Ks=Re.layout.get("icon-text-fit")!=="none"&&Wt.hasIconData();if(Dt){const es=Math.pow(2,et.zoom-Ut.tileID.overscaledZ),on=pt?(In,un)=>pt.getElevation(xt,In,un):null;gx(Wt,ut,mt,Be,et,Hr,es,Dt,Ks,i.aH(et,Ut,We,Ye),xt.toUnwrapped(),on)}}}(G,I,q,z,q.layout.get("text-rotation-alignment"),q.layout.get("text-pitch-alignment"),q.paint.get("text-translate"),q.paint.get("text-translate-anchor"),Y),q.paint.get("icon-opacity").constantOr(1)!==0&&tu(I,z,q,G,!1,q.paint.get("icon-translate"),q.paint.get("icon-translate-anchor"),q.layout.get("icon-rotation-alignment"),q.layout.get("icon-pitch-alignment"),q.layout.get("icon-keep-upright"),fe,_e,ie),q.paint.get("text-opacity").constantOr(1)!==0&&tu(I,z,q,G,!0,q.paint.get("text-translate"),q.paint.get("text-translate-anchor"),q.layout.get("text-rotation-alignment"),q.layout.get("text-pitch-alignment"),q.layout.get("text-keep-upright"),fe,_e,ie),z.map.showCollisionBoxes&&(ff(I,z,q,G,!0),ff(I,z,q,G,!1))}(l,m,v,_,this.style.placement.variableOffsets,P):i.cg(v)?function(I,z,q,G,Y){if(I.renderPass!=="translucent")return;const{isRenderingToTexture:le}=Y,ie=q.paint.get("circle-opacity"),fe=q.paint.get("circle-stroke-width"),_e=q.paint.get("circle-stroke-opacity"),Ee=!q.layout.get("circle-sort-key").isConstant();if(ie.constantOr(1)===0&&(fe.constantOr(1)===0||_e.constantOr(1)===0))return;const Oe=I.context,Re=Oe.gl,ze=I.transform,Ue=I.getDepthModeForSublayer(0,os.ReadOnly),$e=Cs.disabled,We=I.colorModeForRenderPass(),Ye=[],Be=ze.getCircleRadiusCorrection();for(let et=0;et<G.length;et++){const pt=G[et],ut=z.getTile(pt),mt=ut.getBucket(q);if(!mt)continue;const xt=q.paint.get("circle-translate"),Ut=q.paint.get("circle-translate-anchor"),Wt=i.aH(ze,ut,xt,Ut),Dt=mt.programConfigurations.get(q.id),jr=I.useProgram("circle",Dt),Hr=mt.layoutVertexBuffer,Ks=mt.indexBuffer,es=I.style.map.terrain&&I.style.map.terrain.getTerrainData(pt),on={programConfiguration:Dt,program:jr,layoutVertexBuffer:Hr,indexBuffer:Ks,uniformValues:ZP(I,ut,q,Wt,Be),terrainData:es,projectionData:ze.getProjectionData({overscaledTileID:pt,applyGlobeMatrix:!le,applyTerrainMatrix:!0})};if(Ee){const In=mt.segments.get();for(const un of In)Ye.push({segments:new i.aQ([un]),sortKey:un.sortKey,state:on})}else Ye.push({segments:mt.segments,sortKey:0,state:on})}Ee&&Ye.sort((et,pt)=>et.sortKey-pt.sortKey);for(const et of Ye){const{programConfiguration:pt,program:ut,layoutVertexBuffer:mt,indexBuffer:xt,uniformValues:Ut,terrainData:Wt,projectionData:Dt}=et.state;ut.draw(Oe,Re.TRIANGLES,Ue,$e,We,ds.backCCW,Ut,Wt,Dt,q.id,mt,xt,et.segments,q.paint,I.transform.zoom,pt)}}(l,m,v,_,P):i.ch(v)?function(I,z,q,G,Y){if(q.paint.get("heatmap-opacity")===0)return;const le=I.context,{isRenderingToTexture:ie,isRenderingGlobe:fe}=Y;if(I.style.map.terrain){for(const _e of G){const Ee=z.getTile(_e);z.hasRenderableParent(_e)||(I.renderPass==="offscreen"?ik(I,Ee,q,_e,fe):I.renderPass==="translucent"&&pf(I,q,_e,ie,fe))}le.viewport.set([0,0,I.width,I.height])}else I.renderPass==="offscreen"?function(_e,Ee,Oe,Re){const ze=_e.context,Ue=ze.gl,$e=_e.transform,We=Cs.disabled,Ye=new Ts([Ue.ONE,Ue.ONE],i.bi.transparent,[!0,!0,!0,!0]);(function(Be,et,pt){const ut=Be.gl;Be.activeTexture.set(ut.TEXTURE1),Be.viewport.set([0,0,et.width/4,et.height/4]);let mt=pt.heatmapFbos.get(i.c6);mt?(ut.bindTexture(ut.TEXTURE_2D,mt.colorAttachment.get()),Be.bindFramebuffer.set(mt.framebuffer)):(mt=Dw(Be,et.width/4,et.height/4),pt.heatmapFbos.set(i.c6,mt))})(ze,_e,Oe),ze.clear({color:i.bi.transparent});for(let Be=0;Be<Re.length;Be++){const et=Re[Be];if(Ee.hasRenderableParent(et))continue;const pt=Ee.getTile(et),ut=pt.getBucket(Oe);if(!ut)continue;const mt=ut.programConfigurations.get(Oe.id),xt=_e.useProgram("heatmap",mt),Ut=$e.getProjectionData({overscaledTileID:et,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Wt=$e.getCircleRadiusCorrection();xt.draw(ze,Ue.TRIANGLES,os.disabled,We,Ye,ds.backCCW,Zv(pt,$e.zoom,Oe.paint.get("heatmap-intensity"),Wt),null,Ut,Oe.id,ut.layoutVertexBuffer,ut.indexBuffer,ut.segments,Oe.paint,$e.zoom,mt)}ze.viewport.set([0,0,_e.width,_e.height])}(I,z,q,G):I.renderPass==="translucent"&&function(_e,Ee){const Oe=_e.context,Re=Oe.gl;Oe.setColorMode(_e.colorModeForRenderPass());const ze=Ee.heatmapFbos.get(i.c6);ze&&(Oe.activeTexture.set(Re.TEXTURE0),Re.bindTexture(Re.TEXTURE_2D,ze.colorAttachment.get()),Oe.activeTexture.set(Re.TEXTURE1),cj(Oe,Ee).bind(Re.LINEAR,Re.CLAMP_TO_EDGE),_e.useProgram("heatmapTexture").draw(Oe,Re.TRIANGLES,os.disabled,Cs.disabled,_e.colorModeForRenderPass(),ds.disabled,Yv(_e,Ee,0,1),null,null,Ee.id,_e.viewportBuffer,_e.quadTriangleIndexBuffer,_e.viewportSegments,Ee.paint,_e.transform.zoom))}(I,q)}(l,m,v,_,P):i.ci(v)?function(I,z,q,G,Y){if(I.renderPass!=="translucent")return;const{isRenderingToTexture:le}=Y,ie=q.paint.get("line-opacity"),fe=q.paint.get("line-width");if(ie.constantOr(1)===0||fe.constantOr(1)===0)return;const _e=I.getDepthModeForSublayer(0,os.ReadOnly),Ee=I.colorModeForRenderPass(),Oe=q.paint.get("line-dasharray"),Re=Oe.constantOr(1),ze=q.paint.get("line-pattern"),Ue=ze.constantOr(1),$e=q.paint.get("line-gradient"),We=q.getCrossfadeParameters();let Ye;Ye=Ue?"linePattern":Re&&$e?"lineGradientSDF":Re?"lineSDF":$e?"lineGradient":"line";const Be=I.context,et=Be.gl,pt=I.transform;let ut=!0;for(const mt of G){const xt=z.getTile(mt);if(Ue&&!xt.patternsLoaded())continue;const Ut=xt.getBucket(q);if(!Ut)continue;const Wt=Ut.programConfigurations.get(q.id),Dt=I.context.program.get(),jr=I.useProgram(Ye,Wt),Hr=ut||jr.program!==Dt,Ks=I.style.map.terrain&&I.style.map.terrain.getTerrainData(mt),es=ze.constantOr(null),on=Oe&&Oe.constantOr(null);if(es&&xt.imageAtlas){const Ia=xt.imageAtlas,Cn=Ia.patternPositions[es.to.toString()],aa=Ia.patternPositions[es.from.toString()];Cn&&aa&&Wt.setConstantPatternPositions(Cn,aa)}else if(on){const Ia=q.layout.get("line-cap")==="round",Cn=I.lineAtlas.getDash(on.to,Ia),aa=I.lineAtlas.getDash(on.from,Ia);Wt.setConstantDashPositions(Cn,aa)}const In=pt.getProjectionData({overscaledTileID:mt,applyGlobeMatrix:!le,applyTerrainMatrix:!0}),un=pt.getPixelScale();let ga;Ue?(ga=ax(I,xt,q,un,We),dj(Be,et,xt,Wt,We)):Re&&$e?(ga=QP(I,xt,q,un,We,Ut.lineClipsArray.length),jx(I,z,Be,et,q,Ut,mt,Wt,We)):Re?(ga=XP(I,xt,q,un,We),Rw(I,Be,et,Wt,Hr,We)):$e?(ga=YP(I,xt,q,un,Ut.lineClipsArray.length),Lw(I,z,Be,et,q,Ut,mt)):ga=nd(I,xt,q,un);const Sn=I.stencilModeForClipping(mt);jr.draw(Be,et.TRIANGLES,_e,Sn,Ee,ds.disabled,ga,Ks,In,q.id,Ut.layoutVertexBuffer,Ut.indexBuffer,Ut.segments,q.paint,I.transform.zoom,Wt,Ut.layoutVertexBuffer2),ut=!1}}(l,m,v,_,P):i.cj(v)?function(I,z,q,G,Y){const le=q.paint.get("fill-color"),ie=q.paint.get("fill-opacity");if(ie.constantOr(1)===0)return;const{isRenderingToTexture:fe}=Y,_e=I.colorModeForRenderPass(),Ee=q.paint.get("fill-pattern"),Oe=I.opaquePassEnabledForLayer()&&!Ee.constantOr(1)&&le.constantOr(i.bi.transparent).a===1&&ie.constantOr(0)===1?"opaque":"translucent";if(I.renderPass===Oe){const Re=I.getDepthModeForSublayer(1,I.renderPass==="opaque"?os.ReadWrite:os.ReadOnly);Fw(I,z,q,G,Re,_e,!1,fe)}if(I.renderPass==="translucent"&&q.paint.get("fill-antialias")){const Re=I.getDepthModeForSublayer(q.getPaintProperty("fill-outline-color")?2:0,os.ReadOnly);Fw(I,z,q,G,Re,_e,!0,fe)}}(l,m,v,_,P):i.ck(v)?function(I,z,q,G,Y){const le=q.paint.get("fill-extrusion-opacity");if(le===0)return;const{isRenderingToTexture:ie}=Y;if(I.renderPass==="translucent"){const fe=new os(I.context.gl.LEQUAL,os.ReadWrite,I.depthRangeFor3D);if(le!==1||q.paint.get("fill-extrusion-pattern").constantOr(1))_x(I,z,q,G,fe,Cs.disabled,Ts.disabled,ie),_x(I,z,q,G,fe,I.stencilModeFor3D(),I.colorModeForRenderPass(),ie);else{const _e=I.colorModeForRenderPass();_x(I,z,q,G,fe,Cs.disabled,_e,ie)}}}(l,m,v,_,P):i.cl(v)?function(I,z,q,G,Y){if(I.renderPass!=="offscreen"&&I.renderPass!=="translucent")return;const{isRenderingToTexture:le}=Y,ie=I.context,fe=I.style.projection.useSubdivision,_e=I.getDepthModeForSublayer(0,os.ReadOnly),Ee=I.colorModeForRenderPass();if(I.renderPass==="offscreen")(function(Oe,Re,ze,Ue,$e,We,Ye){const Be=Oe.context,et=Be.gl;for(const pt of ze){const ut=Re.getTile(pt),mt=ut.dem;if(!mt||!mt.data||!ut.needsHillshadePrepare)continue;const xt=mt.dim,Ut=mt.stride,Wt=mt.getPixels();if(Be.activeTexture.set(et.TEXTURE1),Be.pixelStoreUnpackPremultiplyAlpha.set(!1),ut.demTexture=ut.demTexture||Oe.getTileTexture(Ut),ut.demTexture){const jr=ut.demTexture;jr.update(Wt,{premultiply:!1}),jr.bind(et.NEAREST,et.CLAMP_TO_EDGE)}else ut.demTexture=new i.T(Be,Wt,et.RGBA,{premultiply:!1}),ut.demTexture.bind(et.NEAREST,et.CLAMP_TO_EDGE);Be.activeTexture.set(et.TEXTURE0);let Dt=ut.fbo;if(!Dt){const jr=new i.T(Be,{width:xt,height:xt,data:null},et.RGBA);jr.bind(et.LINEAR,et.CLAMP_TO_EDGE),Dt=ut.fbo=Be.createFramebuffer(xt,xt,!0,!1),Dt.colorAttachment.set(jr.texture)}Be.bindFramebuffer.set(Dt.framebuffer),Be.viewport.set([0,0,xt,xt]),Oe.useProgram("hillshadePrepare").draw(Be,et.TRIANGLES,$e,We,Ye,ds.disabled,Zd(ut.tileID,mt),null,null,Ue.id,Oe.rasterBoundsBuffer,Oe.quadTriangleIndexBuffer,Oe.rasterBoundsSegments),ut.needsHillshadePrepare=!1}})(I,z,G,q,_e,Cs.disabled,Ee),ie.viewport.set([0,0,I.width,I.height]);else if(I.renderPass==="translucent")if(fe){const[Oe,Re,ze]=I.stencilConfigForOverlapTwoPass(G);Mn(I,z,q,ze,Oe,_e,Ee,!1,le),Mn(I,z,q,ze,Re,_e,Ee,!0,le)}else{const[Oe,Re]=I.getStencilConfigForOverlapAndUpdateStencilID(G);Mn(I,z,q,Re,Oe,_e,Ee,!1,le)}}(l,m,v,_,P):i.cm(v)?function(I,z,q,G,Y){if(I.renderPass!=="translucent"||!G.length)return;const{isRenderingToTexture:le}=Y,ie=I.style.projection.useSubdivision,fe=I.getDepthModeForSublayer(0,os.ReadOnly),_e=I.colorModeForRenderPass();if(ie){const[Ee,Oe,Re]=I.stencilConfigForOverlapTwoPass(G);dc(I,z,q,Re,Ee,fe,_e,!1,le),dc(I,z,q,Re,Oe,fe,_e,!0,le)}else{const[Ee,Oe]=I.getStencilConfigForOverlapAndUpdateStencilID(G);dc(I,z,q,Oe,Ee,fe,_e,!1,le)}}(l,m,v,_,P):i.bN(v)?function(I,z,q,G,Y){if(I.renderPass!=="translucent"||q.paint.get("raster-opacity")===0||!G.length)return;const{isRenderingToTexture:le}=Y,ie=z.getSource(),fe=I.style.projection.useSubdivision;if(ie instanceof It)xh(I,z,q,G,null,!1,!1,ie.tileCoords,ie.flippedWindingOrder,le);else if(fe){const[_e,Ee,Oe]=I.stencilConfigForOverlapTwoPass(G);xh(I,z,q,Oe,_e,!1,!0,Qi,!1,le),xh(I,z,q,Oe,Ee,!0,!0,Qi,!1,le)}else{const[_e,Ee]=I.getStencilConfigForOverlapAndUpdateStencilID(G);xh(I,z,q,Ee,_e,!1,!0,Qi,!1,le)}}(l,m,v,_,P):i.cn(v)?function(I,z,q,G,Y){const le=q.paint.get("background-color"),ie=q.paint.get("background-opacity");if(ie===0)return;const{isRenderingToTexture:fe}=Y,_e=I.context,Ee=_e.gl,Oe=I.style.projection,Re=I.transform,ze=Re.tileSize,Ue=q.paint.get("background-pattern");if(I.isPatternMissing(Ue))return;const $e=!Ue&&le.a===1&&ie===1&&I.opaquePassEnabledForLayer()?"opaque":"translucent";if(I.renderPass!==$e)return;const We=Cs.disabled,Ye=I.getDepthModeForSublayer(0,$e==="opaque"?os.ReadWrite:os.ReadOnly),Be=I.colorModeForRenderPass(),et=I.useProgram(Ue?"backgroundPattern":"background"),pt=G||Os(Re,{tileSize:ze,terrain:I.style.map.terrain});Ue&&(_e.activeTexture.set(Ee.TEXTURE0),I.imageManager.bind(I.context));const ut=q.getCrossfadeParameters();for(const mt of pt){const xt=Re.getProjectionData({overscaledTileID:mt,applyGlobeMatrix:!fe,applyTerrainMatrix:!0}),Ut=Ue?tj(ie,I,Ue,{tileID:mt,tileSize:ze},ut):ej(ie,le),Wt=I.style.map.terrain&&I.style.map.terrain.getTerrainData(mt),Dt=Oe.getMeshFromTileID(_e,mt.canonical,!1,!0,"raster");et.draw(_e,Ee.TRIANGLES,Ye,We,Be,ds.backCCW,Ut,Wt,xt,q.id,Dt.vertexBuffer,Dt.indexBuffer,Dt.segments)}}(l,0,v,_,P):i.co(v)&&function(I,z,q,G){const{isRenderingGlobe:Y}=G,le=I.context,ie=q.implementation,fe=I.style.projection,_e=I.transform,Ee=_e.getProjectionDataForCustomLayer(Y),Oe={farZ:_e.farZ,nearZ:_e.nearZ,fov:_e.fov*Math.PI/180,modelViewProjectionMatrix:_e.modelViewProjectionMatrix,projectionMatrix:_e.projectionMatrix,shaderData:{variantName:fe.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${fe.shaderPreludeCode.vertexSource}`,define:fe.shaderDefine},defaultProjectionData:Ee},Re=ie.renderingMode?ie.renderingMode:"2d";if(I.renderPass==="offscreen"){const ze=ie.prerender;ze&&(I.setCustomLayerDefaults(),le.setColorMode(I.colorModeForRenderPass()),ze.call(ie,le.gl,Oe),le.setDirty(),I.setBaseState())}else if(I.renderPass==="translucent"){I.setCustomLayerDefaults(),le.setColorMode(I.colorModeForRenderPass()),le.setStencilMode(Cs.disabled);const ze=Re==="3d"?I.getDepthModeFor3D():I.getDepthModeForSublayer(0,os.ReadOnly);le.setDepthMode(ze),ie.render(le.gl,Oe),le.setDirty(),I.setBaseState(),le.bindFramebuffer.set(null)}}(l,0,v,P))}saveTileTexture(l){const m=this._tileTextures[l.size[0]];m?m.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const m=this._tileTextures[l];return m&&m.length>0?m.pop():null}isPatternMissing(l){if(!l)return!1;if(!l.from||!l.to)return!0;const m=this.imageManager.getPattern(l.from.toString()),v=this.imageManager.getPattern(l.to.toString());return!m||!v}useProgram(l,m,v=!1,_=[]){this.cache=this.cache||{};const P=!!this.style.map.terrain,I=this.style.projection,z=v?Kr.projectionMercator:I.shaderPreludeCode,q=v?Xi:I.shaderDefine,G=l+(m?m.cacheKey:"")+`/${v?fi:I.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(P?"/terrain":"")+(_?`/${_.join("/")}`:"");return this.cache[G]||(this.cache[G]=new cf(this.context,Kr[l],m,Nw[l],this._showOverdrawInspector,P,z,q,_)),this.cache[G]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:l,drawingBufferHeight:m}=this.context.gl;return this.width!==l||this.height!==m}}function xj(S,l){let m,v=!1,_=null,P=null;const I=()=>{_=null,v&&(S.apply(P,m),_=setTimeout(I,l),v=!1)};return(...z)=>(v=!0,P=this,m=z,_||I(),_)}class gj{constructor(l){this._getCurrentHash=()=>{const m=window.location.hash.replace("#","");if(this._hashName){let v;return m.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(v=_)}),(v&&v[1]||"").split("/")}return m.split("/")},this._onHashChange=()=>{const m=this._getCurrentHash();if(!this._isValidHash(m))return!1;const v=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(m[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+m[2],+m[1]],zoom:+m[0],bearing:v,pitch:+(m[4]||0)}),!0},this._updateHashUnthrottled=()=>{const m=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,m)},this._removeHash=()=>{const m=this._getCurrentHash();if(m.length===0)return;const v=m.join("/");let _=v;_.split("&").length>0&&(_=_.split("&")[0]),this._hashName&&(_=`${this._hashName}=${v}`);let P=window.location.hash.replace(_,"");P.startsWith("#&")?P=P.slice(0,1)+P.slice(2):P==="#"&&(P="");let I=window.location.href.replace(/(#.+)?$/,P);I=I.replace("&&","&"),window.history.replaceState(window.history.state,null,I)},this._updateHash=xj(this._updateHashUnthrottled,300),this._hashName=l&&encodeURIComponent(l)}addTo(l){return this._map=l,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(l){const m=this._map.getCenter(),v=Math.round(100*this._map.getZoom())/100,_=Math.ceil((v*Math.LN2+Math.log(512/360/.5))/Math.LN10),P=Math.pow(10,_),I=Math.round(m.lng*P)/P,z=Math.round(m.lat*P)/P,q=this._map.getBearing(),G=this._map.getPitch();let Y="";if(Y+=l?`/${I}/${z}/${v}`:`${v}/${z}/${I}`,(q||G)&&(Y+="/"+Math.round(10*q)/10),G&&(Y+=`/${Math.round(G)}`),this._hashName){const le=this._hashName;let ie=!1;const fe=window.location.hash.slice(1).split("&").map(_e=>{const Ee=_e.split("=")[0];return Ee===le?(ie=!0,`${Ee}=${Y}`):_e}).filter(_e=>_e);return ie||fe.push(`${le}=${Y}`),`#${fe.join("&")}`}return`#${Y}`}_isValidHash(l){if(l.length<3||l.some(isNaN))return!1;try{new i.U(+l[2],+l[1])}catch{return!1}const m=+l[0],v=+(l[3]||0),_=+(l[4]||0);return m>=this._map.getMinZoom()&&m<=this._map.getMaxZoom()&&v>=-180&&v<=180&&_>=this._map.getMinPitch()&&_<=this._map.getMaxPitch()}}const yh={linearity:.3,easing:i.cp(0,0,.3,1)},qw=i.e({deceleration:2500,maxSpeed:1400},yh),Vw=i.e({deceleration:20,maxSpeed:1400},yh),Uw=i.e({deceleration:1e3,maxSpeed:360},yh),Ww=i.e({deceleration:1e3,maxSpeed:90},yh),Nx=i.e({deceleration:1e3,maxSpeed:360},yh);class Gw{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:T(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,m=T();for(;l.length>0&&m-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const m={zoom:0,bearing:0,pitch:0,roll:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:P}of this._inertiaBuffer)m.zoom+=P.zoomDelta||0,m.bearing+=P.bearingDelta||0,m.pitch+=P.pitchDelta||0,m.roll+=P.rollDelta||0,P.panDelta&&m.pan._add(P.panDelta),P.around&&(m.around=P.around),P.pinchAround&&(m.pinchAround=P.pinchAround);const v=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(m.pan.mag()){const P=Ii(m.pan.mag(),v,i.e({},qw,l||{})),I=m.pan.mult(P.amount/m.pan.mag()),z=this._map.cameraHelper.handlePanInertia(I,this._map.transform);_.center=z.easingCenter,_.offset=z.easingOffset,xi(_,P)}if(m.zoom){const P=Ii(m.zoom,v,Vw);_.zoom=this._map.transform.zoom+P.amount,xi(_,P)}if(m.bearing){const P=Ii(m.bearing,v,Uw);_.bearing=this._map.transform.bearing+i.ai(P.amount,-179,179),xi(_,P)}if(m.pitch){const P=Ii(m.pitch,v,Ww);_.pitch=this._map.transform.pitch+P.amount,xi(_,P)}if(m.roll){const P=Ii(m.roll,v,Nx);_.roll=this._map.transform.roll+i.ai(P.amount,-179,179),xi(_,P)}if(_.zoom||_.bearing){const P=m.pinchAround===void 0?m.around:m.pinchAround;_.around=P?this._map.unproject(P):this._map.getCenter()}return this.clear(),i.e(_,{noMoveStart:!0})}}function xi(S,l){(!S.duration||S.duration<l.duration)&&(S.duration=l.duration,S.easing=l.easing)}function Ii(S,l,m){const{maxSpeed:v,linearity:_,deceleration:P}=m,I=i.ai(S*_/(l/1e3),-v,v),z=Math.abs(I)/(P*_);return{easing:m.easing,duration:1e3*z,amount:I*(z/2)}}class Ji extends i.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,m,v,_={}){v=v instanceof MouseEvent?v:new MouseEvent(l,v);const P=N.mousePos(m.getCanvas(),v),I=m.unproject(P);super(l,i.e({point:P,lngLat:I,originalEvent:v},_)),this._defaultPrevented=!1,this.target=m}}class Di extends i.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,m,v){const _=l==="touchend"?v.changedTouches:v.touches,P=N.touchPos(m.getCanvasContainer(),_),I=P.map(q=>m.unproject(q)),z=P.reduce((q,G,Y,le)=>q.add(G.div(le.length)),new i.P(0,0));super(l,{points:P,point:z,lngLats:I,lngLat:m.unproject(z),originalEvent:v}),this._defaultPrevented=!1}}class Kw extends i.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,m,v){super(l,{originalEvent:v}),this._defaultPrevented=!1}}class vh{constructor(l,m){this._map=l,this._clickTolerance=m.clickTolerance}reset(){delete this._mousedownPos}wheel(l){return this._firePreventable(new Kw(l.type,this._map,l))}mousedown(l,m){return this._mousedownPos=m,this._firePreventable(new Ji(l.type,this._map,l))}mouseup(l){this._map.fire(new Ji(l.type,this._map,l))}click(l,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||this._map.fire(new Ji(l.type,this._map,l))}dblclick(l){return this._firePreventable(new Ji(l.type,this._map,l))}mouseover(l){this._map.fire(new Ji(l.type,this._map,l))}mouseout(l){this._map.fire(new Ji(l.type,this._map,l))}touchstart(l){return this._firePreventable(new Di(l.type,this._map,l))}touchmove(l){this._map.fire(new Di(l.type,this._map,l))}touchend(l){this._map.fire(new Di(l.type,this._map,l))}touchcancel(l){this._map.fire(new Di(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ok{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(l){this._map.fire(new Ji(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ji("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._ignoreContextMenu||this._map.fire(new Ji(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class vf{constructor(l){this._map=l}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(l){return this.transform.screenPointToLocation(i.P.convert(l),this._map.terrain)}}class Hw{constructor(l,m){this._map=l,this._tr=new vf(l),this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=m.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,m){this.isEnabled()&&l.shiftKey&&l.button===0&&(N.disableDrag(),this._startPos=this._lastPos=m,this._active=!0)}mousemoveWindow(l,m){if(!this._active)return;const v=m;if(this._lastPos.equals(v)||!this._box&&v.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=v,this._box||(this._box=N.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",l));const P=Math.min(_.x,v.x),I=Math.max(_.x,v.x),z=Math.min(_.y,v.y),q=Math.max(_.y,v.y);N.setTransform(this._box,`translate(${P}px,${z}px)`),this._box.style.width=I-P+"px",this._box.style.height=q-z+"px"}mouseupWindow(l,m){if(!this._active||l.button!==0)return;const v=this._startPos,_=m;if(this.reset(),N.suppressClick(),v.x!==_.x||v.y!==_.y)return this._map.fire(new i.l("boxzoomend",{originalEvent:l})),{cameraAnimation:P=>P.fitScreenCoordinates(v,_,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",l)}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(N.remove(this._box),this._box=null),N.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(l,m){return this._map.fire(new i.l(l,{originalEvent:m}))}}function yj(S,l){if(S.length!==l.length)throw new Error(`The number of touches and points are not equal - touches ${S.length}, points ${l.length}`);const m={};for(let v=0;v<S.length;v++)m[S[v].identifier]=l[v];return m}class Zw{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(l,m,v){(this.centroid||v.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),v.length===this.numTouches&&(this.centroid=function(_){const P=new i.P(0,0);for(const I of _)P._add(I);return P.div(_.length)}(m),this.touches=yj(v,m)))}touchmove(l,m,v){if(this.aborted||!this.centroid)return;const _=yj(v,m);for(const P in this.touches){const I=_[P];(!I||I.dist(this.touches[P])>30)&&(this.aborted=!0)}}touchend(l,m,v){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),v.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class ru{constructor(l){this.singleTap=new Zw(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(l,m,v){this.singleTap.touchstart(l,m,v)}touchmove(l,m,v){this.singleTap.touchmove(l,m,v)}touchend(l,m,v){const _=this.singleTap.touchend(l,m,v);if(_){const P=l.timeStamp-this.lastTime<500,I=!this.lastTap||this.lastTap.dist(_)<30;if(P&&I||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class uc{constructor(l){this._tr=new vf(l),this._zoomIn=new ru({numTouches:1,numTaps:2}),this._zoomOut=new ru({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,m,v){this._zoomIn.touchstart(l,m,v),this._zoomOut.touchstart(l,m,v)}touchmove(l,m,v){this._zoomIn.touchmove(l,m,v),this._zoomOut.touchmove(l,m,v)}touchend(l,m,v){const _=this._zoomIn.touchend(l,m,v),P=this._zoomOut.touchend(l,m,v),I=this._tr;return _?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:I.zoom+1,around:I.unproject(_)},{originalEvent:l})}):P?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:I.zoom-1,around:I.unproject(P)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pr{constructor(l){this._enabled=!!l.enable,this._moveStateManager=l.moveStateManager,this._clickTolerance=l.clickTolerance||1,this._moveFunction=l.move,this._activateOnStart=!!l.activateOnStart,l.assignEvents(this),this.reset()}reset(l){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(l)}_move(...l){const m=this._moveFunction(...l);if(m.bearingDelta||m.pitchDelta||m.rollDelta||m.around||m.panDelta)return this._active=!0,m}dragStart(l,m){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(l)&&(this._moveStateManager.startMove(l),this._lastPoint=Array.isArray(m)?m[0]:m,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(l,m){if(!this.isEnabled())return;const v=this._lastPoint;if(!v)return;if(l.preventDefault(),!this._moveStateManager.isValidMoveEvent(l))return void this.reset(l);const _=Array.isArray(m)?m[0]:m;return!this._moved&&_.dist(v)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=_,this._move(v,_))}dragEnd(l){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(l)&&(this._moved&&N.suppressClick(),this.reset(l))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Yw=0,vj=2,Xw={[Yw]:1,[vj]:2};class hc{constructor(l){this._correctEvent=l.checkCorrectEvent}startMove(l){const m=N.mouseButton(l);this._eventButton=m}endMove(l){delete this._eventButton}isValidStartEvent(l){return this._correctEvent(l)}isValidMoveEvent(l){return!function(m,v){const _=Xw[v];return m.buttons===void 0||(m.buttons&_)!==_}(l,this._eventButton)}isValidEndEvent(l){return N.mouseButton(l)===this._eventButton}}class jf{constructor(){this._firstTouch=void 0}_isOneFingerTouch(l){return l.targetTouches.length===1}_isSameTouchEvent(l){return l.targetTouches[0].identifier===this._firstTouch}startMove(l){this._firstTouch=l.targetTouches[0].identifier}endMove(l){delete this._firstTouch}isValidStartEvent(l){return this._isOneFingerTouch(l)}isValidMoveEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}isValidEndEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}}class jj{constructor(l=new hc({checkCorrectEvent:()=>!0}),m=new jf){this.mouseMoveStateManager=l,this.oneFingerTouchMoveStateManager=m}_executeRelevantHandler(l,m,v){return l instanceof MouseEvent?m(l):typeof TouchEvent<"u"&&l instanceof TouchEvent?v(l):void 0}startMove(l){this._executeRelevantHandler(l,m=>this.mouseMoveStateManager.startMove(m),m=>this.oneFingerTouchMoveStateManager.startMove(m))}endMove(l){this._executeRelevantHandler(l,m=>this.mouseMoveStateManager.endMove(m),m=>this.oneFingerTouchMoveStateManager.endMove(m))}isValidStartEvent(l){return this._executeRelevantHandler(l,m=>this.mouseMoveStateManager.isValidStartEvent(m),m=>this.oneFingerTouchMoveStateManager.isValidStartEvent(m))}isValidMoveEvent(l){return this._executeRelevantHandler(l,m=>this.mouseMoveStateManager.isValidMoveEvent(m),m=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(m))}isValidEndEvent(l){return this._executeRelevantHandler(l,m=>this.mouseMoveStateManager.isValidEndEvent(m),m=>this.oneFingerTouchMoveStateManager.isValidEndEvent(m))}}const us=S=>{S.mousedown=S.dragStart,S.mousemoveWindow=S.dragMove,S.mouseup=S.dragEnd,S.contextmenu=l=>{l.preventDefault()}};class bj{constructor(l,m){this._clickTolerance=l.clickTolerance||1,this._map=m,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}_shouldBePrevented(l){return l<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(l,m,v){return this._calculateTransform(l,m,v)}touchmove(l,m,v){if(this._active){if(!this._shouldBePrevented(v.length))return l.preventDefault(),this._calculateTransform(l,m,v);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",l)}}touchend(l,m,v){this._calculateTransform(l,m,v),this._active&&this._shouldBePrevented(v.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,m,v){v.length>0&&(this._active=!0);const _=yj(v,m),P=new i.P(0,0),I=new i.P(0,0);let z=0;for(const G in _){const Y=_[G],le=this._touches[G];le&&(P._add(Y),I._add(Y.sub(le)),z++,_[G]=Y)}if(this._touches=_,this._shouldBePrevented(z)||!I.mag())return;const q=I.div(z);return this._sum._add(q),this._sum.mag()<this._clickTolerance?void 0:{around:P.div(z),panDelta:q}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _j{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(l,m,v){this._firstTwoTouches||v.length<2||(this._firstTwoTouches=[v[0].identifier,v[1].identifier],this._start([m[0],m[1]]))}touchmove(l,m,v){if(!this._firstTwoTouches)return;l.preventDefault();const[_,P]=this._firstTwoTouches,I=jh(v,m,_),z=jh(v,m,P);if(!I||!z)return;const q=this._aroundCenter?null:I.add(z).div(2);return this._move([I,z],q,l)}touchend(l,m,v){if(!this._firstTwoTouches)return;const[_,P]=this._firstTwoTouches,I=jh(v,m,_),z=jh(v,m,P);I&&z||(this._active&&N.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function jh(S,l,m){for(let v=0;v<S.length;v++)if(S[v].identifier===m)return l[v]}function Qw(S,l){return Math.log(S/l)/Math.LN2}class Jw extends _j{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,m){const v=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(Qw(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Qw(this._distance,v),pinchAround:m}}}function wj(S,l){return 180*S.angleWith(l)/Math.PI}class Sx extends _j{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,m,v){const _=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:wj(this._vector,_),pinchAround:m}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const m=25/(Math.PI*this._minDiameter)*360,v=wj(l,this._startVector);return Math.abs(v)<m}}function Cx(S){return Math.abs(S.y)>Math.abs(S.x)}class e1 extends _j{constructor(l){super(),this._currentTouchCount=0,this._map=l}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(l,m,v){super.touchstart(l,m,v),this._currentTouchCount=v.length}_start(l){this._lastPoints=l,Cx(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,m,v){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const _=l[0].sub(this._lastPoints[0]),P=l[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(_,P,v.timeStamp),this._valid?(this._lastPoints=l,this._active=!0,{pitchDelta:(_.y+P.y)/2*-.5}):void 0}gestureBeginsVertically(l,m,v){if(this._valid!==void 0)return this._valid;const _=l.mag()>=2,P=m.mag()>=2;if(!_&&!P)return;if(!_||!P)return this._firstMove===void 0&&(this._firstMove=v),v-this._firstMove<100&&void 0;const I=l.y>0==m.y>0;return Cx(l)&&Cx(m)&&I}}const t1={panStep:100,bearingStep:15,pitchStep:10};class r1{constructor(l){this._tr=new vf(l);const m=t1;this._panStep=m.panStep,this._bearingStep=m.bearingStep,this._pitchStep=m.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let m=0,v=0,_=0,P=0,I=0;switch(l.keyCode){case 61:case 107:case 171:case 187:m=1;break;case 189:case 109:case 173:m=-1;break;case 37:l.shiftKey?v=-1:(l.preventDefault(),P=-1);break;case 39:l.shiftKey?v=1:(l.preventDefault(),P=1);break;case 38:l.shiftKey?_=1:(l.preventDefault(),I=-1);break;case 40:l.shiftKey?_=-1:(l.preventDefault(),I=1);break;default:return}return this._rotationDisabled&&(v=0,_=0),{cameraAnimation:z=>{const q=this._tr;z.easeTo({duration:300,easeId:"keyboardHandler",easing:lk,zoom:m?Math.round(q.zoom)+m*(l.shiftKey?2:1):q.zoom,bearing:q.bearing+v*this._bearingStep,pitch:q.pitch+_*this._pitchStep,offset:[-P*this._panStep,-I*this._panStep],center:q.center},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function lk(S){return S*(2-S)}const mc=4.000244140625,an=1/450;class s1{constructor(l,m){this._onTimeout=v=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(v)},this._map=l,this._tr=new vf(l),this._triggerRenderFrame=m,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=an}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(l){return!!this._map.cooperativeGestures.isEnabled()&&!(l.ctrlKey||this._map.cooperativeGestures.isBypassed(l))}wheel(l){if(!this.isEnabled())return;if(this._shouldBePrevented(l))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",l);let m=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const v=T(),_=v-(this._lastWheelEventTime||0);this._lastWheelEventTime=v,m!==0&&m%mc==0?this._type="wheel":m!==0&&Math.abs(m)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=m,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(_*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),l.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=l,this._delta-=m,this._active||this._start(l)),l.preventDefault()}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const m=N.mousePos(this._map.getCanvas(),l),v=this._tr;this._aroundPoint=this._aroundCenter?v.transform.locationToScreenPoint(i.U.convert(v.center)):m,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const z=l.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=z),typeof this._targetZoom=="number"&&(this._targetZoom+=z)}if(this._delta!==0){const z=this._type==="wheel"&&Math.abs(this._delta)>mc?this._wheelZoomRate:this._defaultZoomRate;let q=2/(1+Math.exp(-Math.abs(this._delta*z)));this._delta<0&&q!==0&&(q=1/q);const G=typeof this._targetZoom!="number"?l.scale:i.al(this._targetZoom);this._targetZoom=l.constrain(l.getCameraLngLat(),i.ao(G*q)).zoom,this._type==="wheel"&&(this._startZoom=l.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const m=typeof this._targetZoom!="number"?l.zoom:this._targetZoom,v=this._startZoom,_=this._easing;let P,I=!1;if(this._type==="wheel"&&v&&_){const z=T()-this._lastWheelEventTime,q=Math.min((z+5)/200,1),G=_(q);P=i.F.number(v,m,G),q<1?this._frameId||(this._frameId=!0):I=!0}else P=m,I=!0;return this._active=!0,I&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=P,{noInertia:!0,needsRenderFrame:!I,zoomDelta:P-l.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let m=i.cr;if(this._prevEase){const v=this._prevEase,_=(T()-v.start)/v.duration,P=v.easing(_+.01)-v.easing(_),I=.27/Math.sqrt(P*P+1e-4)*.01,z=Math.sqrt(.0729-I*I);m=i.cp(I,z,.25,1)}return this._prevEase={start:T(),duration:l,easing:m},m}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class bf{constructor(l,m){this._clickZoom=l,this._tapZoom=m}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Nj{constructor(l){this._tr=new vf(l),this.reset()}reset(){this._active=!1}dblclick(l,m){return l.preventDefault(),{cameraAnimation:v=>{v.easeTo({duration:300,zoom:this._tr.zoom+(l.shiftKey?-1:1),around:this._tr.unproject(m)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class n1{constructor(){this._tap=new ru({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(l,m,v){if(!this._swipePoint)if(this._tapTime){const _=m[0],P=l.timeStamp-this._tapTime<500,I=this._tapPoint.dist(_)<30;P&&I?v.length>0&&(this._swipePoint=_,this._swipeTouch=v[0].identifier):this.reset()}else this._tap.touchstart(l,m,v)}touchmove(l,m,v){if(this._tapTime){if(this._swipePoint){if(v[0].identifier!==this._swipeTouch)return;const _=m[0],P=_.y-this._swipePoint.y;return this._swipePoint=_,l.preventDefault(),this._active=!0,{zoomDelta:P/128}}}else this._tap.touchmove(l,m,v)}touchend(l,m,v){if(this._tapTime)this._swipePoint&&v.length===0&&this.reset();else{const _=this._tap.touchend(l,m,v);_&&(this._tapTime=l.timeStamp,this._tapPoint=_)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Sj{constructor(l,m,v){this._el=l,this._mousePan=m,this._touchPan=v}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Cj{constructor(l,m,v,_){this._pitchWithRotate=l.pitchWithRotate,this._rollEnabled=l.rollEnabled,this._mouseRotate=m,this._mousePitch=v,this._mouseRoll=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class a1{constructor(l,m,v,_){this._el=l,this._touchZoom=m,this._touchRotate=v,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Jo{constructor(l,m){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=l,this._options=m,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const l=this._map.getCanvasContainer();l.classList.add("maplibregl-cooperative-gestures"),this._container=N.create("div","maplibregl-cooperative-gesture-screen",l);let m=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(m=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const v=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),_=document.createElement("div");_.className="maplibregl-desktop-message",_.textContent=m,this._container.appendChild(_);const P=document.createElement("div");P.className="maplibregl-mobile-message",P.textContent=v,this._container.appendChild(P),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(N.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(l){return l[this._bypassKey]}notifyGestureBlocked(l,m){this._enabled&&(this._map.fire(new i.l("cooperativegestureprevented",{gestureType:l,originalEvent:m})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const su=S=>S.zoom||S.drag||S.roll||S.pitch||S.rotate;class Nr extends i.l{}function Lr(S){return S.panDelta&&S.panDelta.mag()||S.zoomDelta||S.bearingDelta||S.pitchDelta||S.rollDelta}class _f{constructor(l,m){this.handleWindowEvent=_=>{this.handleEvent(_,`${_.type}Window`)},this.handleEvent=(_,P)=>{if(_.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const I=_.type==="renderFrame"?void 0:_,z={needsRenderFrame:!1},q={},G={};for(const{handlerName:ie,handler:fe,allowed:_e}of this._handlers){if(!fe.isEnabled())continue;let Ee;if(this._blockedByActive(G,_e,ie))fe.reset();else if(fe[P||_.type]){if(i.cs(_,P||_.type)){const Oe=N.mousePos(this._map.getCanvas(),_);Ee=fe[P||_.type](_,Oe)}else if(i.ct(_,P||_.type)){const Oe=this._getMapTouches(_.touches),Re=N.touchPos(this._map.getCanvas(),Oe);Ee=fe[P||_.type](_,Re,Oe)}else i.cu(P||_.type)||(Ee=fe[P||_.type](_));this.mergeHandlerResult(z,q,Ee,ie,I),Ee&&Ee.needsRenderFrame&&this._triggerRenderFrame()}(Ee||fe.isActive())&&(G[ie]=fe)}const Y={};for(const ie in this._previousActiveHandlers)G[ie]||(Y[ie]=I);this._previousActiveHandlers=G,(Object.keys(Y).length||Lr(z))&&(this._changes.push([z,q,Y]),this._triggerRenderFrame()),(Object.keys(G).length||Lr(z))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:le}=z;le&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],le(this._map))},this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Gw(l),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(m);const v=this._el;this._listeners=[[v,"touchstart",{passive:!0}],[v,"touchmove",{passive:!1}],[v,"touchend",void 0],[v,"touchcancel",void 0],[v,"mousedown",void 0],[v,"mousemove",void 0],[v,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[v,"mouseover",void 0],[v,"mouseout",void 0],[v,"dblclick",void 0],[v,"click",void 0],[v,"keydown",{capture:!1}],[v,"keyup",void 0],[v,"wheel",{passive:!1}],[v,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,P,I]of this._listeners)N.addEventListener(_,P,_===document?this.handleWindowEvent:this.handleEvent,I)}destroy(){for(const[l,m,v]of this._listeners)N.removeEventListener(l,m,l===document?this.handleWindowEvent:this.handleEvent,v)}_addDefaultHandlers(l){const m=this._map,v=m.getCanvasContainer();this._add("mapEvent",new vh(m,l));const _=m.boxZoom=new Hw(m,l);this._add("boxZoom",_),l.interactive&&l.boxZoom&&_.enable();const P=m.cooperativeGestures=new Jo(m,l.cooperativeGestures);this._add("cooperativeGestures",P),l.cooperativeGestures&&P.enable();const I=new uc(m),z=new Nj(m);m.doubleClickZoom=new bf(z,I),this._add("tapZoom",I),this._add("clickZoom",z),l.interactive&&l.doubleClickZoom&&m.doubleClickZoom.enable();const q=new n1;this._add("tapDragZoom",q);const G=m.touchPitch=new e1(m);this._add("touchPitch",G),l.interactive&&l.touchPitch&&m.touchPitch.enable(l.touchPitch);const Y=()=>m.project(m.getCenter()),le=function({enable:$e,clickTolerance:We,aroundCenter:Ye=!0,minPixelCenterThreshold:Be=100,rotateDegreesPerPixelMoved:et=.8},pt){const ut=new hc({checkCorrectEvent:mt=>N.mouseButton(mt)===0&&mt.ctrlKey||N.mouseButton(mt)===2&&!mt.ctrlKey});return new pr({clickTolerance:We,move:(mt,xt)=>{const Ut=pt();if(Ye&&Math.abs(Ut.y-mt.y)>Be)return{bearingDelta:i.cq(new i.P(mt.x,xt.y),xt,Ut)};let Wt=(xt.x-mt.x)*et;return Ye&&xt.y<Ut.y&&(Wt=-Wt),{bearingDelta:Wt}},moveStateManager:ut,enable:$e,assignEvents:us})}(l,Y),ie=function({enable:$e,clickTolerance:We,pitchDegreesPerPixelMoved:Ye=-.5}){const Be=new hc({checkCorrectEvent:et=>N.mouseButton(et)===0&&et.ctrlKey||N.mouseButton(et)===2});return new pr({clickTolerance:We,move:(et,pt)=>({pitchDelta:(pt.y-et.y)*Ye}),moveStateManager:Be,enable:$e,assignEvents:us})}(l),fe=function({enable:$e,clickTolerance:We,rollDegreesPerPixelMoved:Ye=.3},Be){const et=new hc({checkCorrectEvent:pt=>N.mouseButton(pt)===2&&pt.ctrlKey});return new pr({clickTolerance:We,move:(pt,ut)=>{const mt=Be();let xt=(ut.x-pt.x)*Ye;return ut.y<mt.y&&(xt=-xt),{rollDelta:xt}},moveStateManager:et,enable:$e,assignEvents:us})}(l,Y);m.dragRotate=new Cj(l,le,ie,fe),this._add("mouseRotate",le,["mousePitch"]),this._add("mousePitch",ie,["mouseRotate","mouseRoll"]),this._add("mouseRoll",fe,["mousePitch"]),l.interactive&&l.dragRotate&&m.dragRotate.enable();const _e=function({enable:$e,clickTolerance:We}){const Ye=new hc({checkCorrectEvent:Be=>N.mouseButton(Be)===0&&!Be.ctrlKey});return new pr({clickTolerance:We,move:(Be,et)=>({around:et,panDelta:et.sub(Be)}),activateOnStart:!0,moveStateManager:Ye,enable:$e,assignEvents:us})}(l),Ee=new bj(l,m);m.dragPan=new Sj(v,_e,Ee),this._add("mousePan",_e),this._add("touchPan",Ee,["touchZoom","touchRotate"]),l.interactive&&l.dragPan&&m.dragPan.enable(l.dragPan);const Oe=new Sx,Re=new Jw;m.touchZoomRotate=new a1(v,Re,Oe,q),this._add("touchRotate",Oe,["touchPan","touchZoom"]),this._add("touchZoom",Re,["touchPan","touchRotate"]),l.interactive&&l.touchZoomRotate&&m.touchZoomRotate.enable(l.touchZoomRotate),this._add("blockableMapEvent",new ok(m));const ze=m.scrollZoom=new s1(m,()=>this._triggerRenderFrame());this._add("scrollZoom",ze,["mousePan"]),l.interactive&&l.scrollZoom&&m.scrollZoom.enable(l.scrollZoom);const Ue=m.keyboard=new r1(m);this._add("keyboard",Ue),l.interactive&&l.keyboard&&m.keyboard.enable()}_add(l,m,v){this._handlers.push({handlerName:l,handler:m,allowed:v}),this._handlersById[l]=m}stop(l){if(!this._updatingCamera){for(const{handler:m}of this._handlers)m.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!su(this._eventsInProgress)||this.isZooming()}_blockedByActive(l,m,v){for(const _ in l)if(_!==v&&(!m||m.indexOf(_)<0))return!0;return!1}_getMapTouches(l){const m=[];for(const v of l)this._el.contains(v.target)&&m.push(v);return m}mergeHandlerResult(l,m,v,_,P){if(!v)return;i.e(l,v);const I={handlerName:_,originalEvent:v.originalEvent||P};v.zoomDelta!==void 0&&(m.zoom=I),v.panDelta!==void 0&&(m.drag=I),v.rollDelta!==void 0&&(m.roll=I),v.pitchDelta!==void 0&&(m.pitch=I),v.bearingDelta!==void 0&&(m.rotate=I)}_applyChanges(){const l={},m={},v={};for(const[_,P,I]of this._changes)_.panDelta&&(l.panDelta=(l.panDelta||new i.P(0,0))._add(_.panDelta)),_.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+_.pitchDelta),_.rollDelta&&(l.rollDelta=(l.rollDelta||0)+_.rollDelta),_.around!==void 0&&(l.around=_.around),_.pinchAround!==void 0&&(l.pinchAround=_.pinchAround),_.noInertia&&(l.noInertia=_.noInertia),i.e(m,P),i.e(v,I);this._updateMapTransform(l,m,v),this._changes=[]}_updateMapTransform(l,m,v){const _=this._map,P=_._getTransformForUpdate(),I=_.terrain;if(!(Lr(l)||I&&this._terrainMovement))return this._fireEvents(m,v,!0);_._stop(!0);let{panDelta:z,zoomDelta:q,bearingDelta:G,pitchDelta:Y,rollDelta:le,around:ie,pinchAround:fe}=l;fe!==void 0&&(ie=fe),ie=ie||_.transform.centerPoint,I&&!P.isPointOnMapSurface(ie)&&(ie=P.centerPoint);const _e={panDelta:z,zoomDelta:q,rollDelta:le,pitchDelta:Y,bearingDelta:G,around:ie};this._map.cameraHelper.useGlobeControls&&!P.isPointOnMapSurface(ie)&&(ie=P.centerPoint);const Ee=ie.distSqr(P.centerPoint)<.01?P.center:P.screenPointToLocation(z?ie.sub(z):ie);this._handleMapControls({terrain:I,tr:P,deltasForHelper:_e,preZoomAroundLoc:Ee,combinedEventsInProgress:m,panDelta:z}),_._applyUpdatedTransform(P),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(m,v,!0)}_handleMapControls({terrain:l,tr:m,deltasForHelper:v,preZoomAroundLoc:_,combinedEventsInProgress:P,panDelta:I}){const z=this._map.cameraHelper;if(z.handleMapControlsRollPitchBearingZoom(v,m),l)return z.useGlobeControls?(this._terrainMovement||!P.drag&&!P.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void z.handleMapControlsPan(v,m,_)):this._terrainMovement||!P.drag&&!P.zoom?void(P.drag&&this._terrainMovement&&I?m.setCenter(m.screenPointToLocation(m.centerPoint.sub(I))):z.handleMapControlsPan(v,m,_)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void z.handleMapControlsPan(v,m,_));z.handleMapControlsPan(v,m,_)}_fireEvents(l,m,v){const _=su(this._eventsInProgress),P=su(l),I={};for(const le in l){const{originalEvent:ie}=l[le];this._eventsInProgress[le]||(I[`${le}start`]=ie),this._eventsInProgress[le]=l[le]}!_&&P&&this._fireEvent("movestart",P.originalEvent);for(const le in I)this._fireEvent(le,I[le]);P&&this._fireEvent("move",P.originalEvent);for(const le in l){const{originalEvent:ie}=l[le];this._fireEvent(le,ie)}const z={};let q;for(const le in this._eventsInProgress){const{handlerName:ie,originalEvent:fe}=this._eventsInProgress[le];this._handlersById[ie].isActive()||(delete this._eventsInProgress[le],q=m[ie]||fe,z[`${le}end`]=q)}for(const le in z)this._fireEvent(le,z[le]);const G=su(this._eventsInProgress),Y=(_||P)&&!G;if(Y&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const le=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&le.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(le)}if(v&&Y){this._updatingCamera=!0;const le=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ie=fe=>fe!==0&&-this._bearingSnap<fe&&fe<this._bearingSnap;!le||!le.essential&&b.prefersReducedMotion?(this._map.fire(new i.l("moveend",{originalEvent:q})),ie(this._map.getBearing())&&this._map.resetNorth()):(ie(le.bearing||this._map.getBearing())&&(le.bearing=0),le.freezeElevation=!0,this._map.easeTo(le,{originalEvent:q})),this._updatingCamera=!1}}_fireEvent(l,m){this._map.fire(new i.l(l,m?{originalEvent:m}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{delete this._frameId,this.handleEvent(new Nr("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class i1 extends i.E{constructor(l,m,v){super(),this._renderFrameCallback=()=>{const _=Math.min((T()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(_)),_<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=v.bearingSnap,this.cameraHelper=m,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(l,m){l.apply(this.transform),this.transform=l,this.cameraHelper=m}getCenter(){return new i.U(this.transform.center.lng,this.transform.center.lat)}setCenter(l,m){return this.jumpTo({center:l},m)}getCenterElevation(){return this.transform.elevation}setCenterElevation(l,m){return this.jumpTo({elevation:l},m),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(l){this._centerClampedToGround=l}panBy(l,m,v){return l=i.P.convert(l).mult(-1),this.panTo(this.transform.center,i.e({offset:l},m),v)}panTo(l,m,v){return this.easeTo(i.e({center:l},m),v)}getZoom(){return this.transform.zoom}setZoom(l,m){return this.jumpTo({zoom:l},m),this}zoomTo(l,m,v){return this.easeTo(i.e({zoom:l},m),v)}zoomIn(l,m){return this.zoomTo(this.getZoom()+1,l,m),this}zoomOut(l,m){return this.zoomTo(this.getZoom()-1,l,m),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(l,m){return l!=this.transform.fov&&(this.transform.setFov(l),this.fire(new i.l("movestart",m)).fire(new i.l("move",m)).fire(new i.l("moveend",m))),this}getBearing(){return this.transform.bearing}setBearing(l,m){return this.jumpTo({bearing:l},m),this}getPadding(){return this.transform.padding}setPadding(l,m){return this.jumpTo({padding:l},m),this}rotateTo(l,m,v){return this.easeTo(i.e({bearing:l},m),v)}resetNorth(l,m){return this.rotateTo(0,i.e({duration:1e3},l),m),this}resetNorthPitch(l,m){return this.easeTo(i.e({bearing:0,pitch:0,roll:0,duration:1e3},l),m),this}snapToNorth(l,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,m):this}getPitch(){return this.transform.pitch}setPitch(l,m){return this.jumpTo({pitch:l},m),this}getRoll(){return this.transform.roll}setRoll(l,m){return this.jumpTo({roll:l},m),this}cameraForBounds(l,m){l=Dr.convert(l).adjustAntiMeridian();const v=m&&m.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),v,m)}_cameraForBoxAndBearing(l,m,v,_){const P={top:0,bottom:0,right:0,left:0};if(typeof(_=i.e({padding:P,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding=="number"){const G=_.padding;_.padding={top:G,bottom:G,right:G,left:G}}const I=i.e(P,_.padding);_.padding=I;const z=this.transform,q=new Dr(l,m);return this.cameraHelper.cameraForBoxAndBearing(_,I,q,v,z)}fitBounds(l,m,v){return this._fitInternal(this.cameraForBounds(l,m),m,v)}fitScreenCoordinates(l,m,v,_,P){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(i.P.convert(l)),this.transform.screenPointToLocation(i.P.convert(m)),v,_),_,P)}_fitInternal(l,m,v){return l?(delete(m=i.e(l,m)).padding,m.linear?this.easeTo(m,v):this.flyTo(m,v)):this}jumpTo(l,m){this.stop();const v=this._getTransformForUpdate();let _=!1,P=!1,I=!1;const z=v.zoom;this.cameraHelper.handleJumpToCenterZoom(v,l);const q=v.zoom!==z;return"elevation"in l&&v.elevation!==+l.elevation&&v.setElevation(+l.elevation),"bearing"in l&&v.bearing!==+l.bearing&&(_=!0,v.setBearing(+l.bearing)),"pitch"in l&&v.pitch!==+l.pitch&&(P=!0,v.setPitch(+l.pitch)),"roll"in l&&v.roll!==+l.roll&&(I=!0,v.setRoll(+l.roll)),l.padding==null||v.isPaddingEqual(l.padding)||v.setPadding(l.padding),this._applyUpdatedTransform(v),this.fire(new i.l("movestart",m)).fire(new i.l("move",m)),q&&this.fire(new i.l("zoomstart",m)).fire(new i.l("zoom",m)).fire(new i.l("zoomend",m)),_&&this.fire(new i.l("rotatestart",m)).fire(new i.l("rotate",m)).fire(new i.l("rotateend",m)),P&&this.fire(new i.l("pitchstart",m)).fire(new i.l("pitch",m)).fire(new i.l("pitchend",m)),I&&this.fire(new i.l("rollstart",m)).fire(new i.l("roll",m)).fire(new i.l("rollend",m)),this.fire(new i.l("moveend",m))}calculateCameraOptionsFromTo(l,m,v,_=0){const P=i.a5.fromLngLat(l,m),I=i.a5.fromLngLat(v,_),z=I.x-P.x,q=I.y-P.y,G=I.z-P.z,Y=Math.hypot(z,q,G);if(Y===0)throw new Error("Can't calculate camera options with same From and To");const le=Math.hypot(z,q),ie=i.ao(this.transform.cameraToCenterDistance/Y/this.transform.tileSize),fe=180*Math.atan2(z,-q)/Math.PI;let _e=180*Math.acos(le/Y)/Math.PI;return _e=G<0?90-_e:90+_e,{center:I.toLngLat(),elevation:_,zoom:ie,pitch:_e,bearing:fe}}calculateCameraOptionsFromCameraLngLatAltRotation(l,m,v,_,P){const I=this.transform.calculateCenterFromCameraLngLatAlt(l,m,v,_);return{center:I.center,elevation:I.elevation,zoom:I.zoom,bearing:v,pitch:_,roll:P}}easeTo(l,m){this._stop(!1,l.easeId),((l=i.e({offset:[0,0],duration:500,easing:i.cr},l)).animate===!1||!l.essential&&b.prefersReducedMotion)&&(l.duration=0);const v=this._getTransformForUpdate(),_=this.getBearing(),P=v.pitch,I=v.roll,z="bearing"in l?this._normalizeBearing(l.bearing,_):_,q="pitch"in l?+l.pitch:P,G="roll"in l?this._normalizeBearing(l.roll,I):I,Y="padding"in l?l.padding:v.padding,le=i.P.convert(l.offset);let ie,fe;l.around&&(ie=i.U.convert(l.around),fe=v.locationToScreenPoint(ie));const _e={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},Ee=this.cameraHelper.handleEaseTo(v,{bearing:z,pitch:q,roll:G,padding:Y,around:ie,aroundPoint:fe,offsetAsPoint:le,offset:l.offset,zoom:l.zoom,center:l.center});return this._rotating=this._rotating||_!==z,this._pitching=this._pitching||q!==P,this._rolling=this._rolling||G!==I,this._padding=!v.isPaddingEqual(Y),this._zooming=this._zooming||Ee.isZooming,this._easeId=l.easeId,this._prepareEase(m,l.noMoveStart,_e),this.terrain&&this._prepareElevation(Ee.elevationCenter),this._ease(Oe=>{Ee.easeFunc(Oe),this.terrain&&!l.freezeElevation&&this._updateElevation(Oe),this._applyUpdatedTransform(v),this._fireMoveEvents(m)},Oe=>{this.terrain&&l.freezeElevation&&this._finalizeElevation(),this._afterEase(m,Oe)},l),this}_prepareEase(l,m,v={}){this._moving=!0,m||v.moving||this.fire(new i.l("movestart",l)),this._zooming&&!v.zooming&&this.fire(new i.l("zoomstart",l)),this._rotating&&!v.rotating&&this.fire(new i.l("rotatestart",l)),this._pitching&&!v.pitching&&this.fire(new i.l("pitchstart",l)),this._rolling&&!v.rolling&&this.fire(new i.l("rollstart",l))}_prepareElevation(l){this._elevationCenter=l,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(l){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const m=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(l<1&&m!==this._elevationTarget){const v=this._elevationTarget-this._elevationStart;this._elevationStart+=l*(v-(m-(v*l+this._elevationStart))/(1-l)),this._elevationTarget=m}this.transform.setElevation(i.F.number(this._elevationStart,this._elevationTarget,l))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(l){if(!this.terrain&&l.elevation>=0&&l.pitch<=90)return{};const m=l.getCameraLngLat(),v=l.getCameraAltitude(),_=this.terrain?this.terrain.getElevationForLngLatZoom(m,l.zoom):0;if(v<_){const P=this.calculateCameraOptionsFromTo(m,_,l.center,l.elevation);return{pitch:P.pitch,zoom:P.zoom}}return{}}_applyUpdatedTransform(l){const m=[];if(m.push(_=>this._elevateCameraIfInsideTerrain(_)),this.transformCameraUpdate&&m.push(_=>this.transformCameraUpdate(_)),!m.length)return;const v=l.clone();for(const _ of m){const P=v.clone(),{center:I,zoom:z,roll:q,pitch:G,bearing:Y,elevation:le}=_(P);I&&P.setCenter(I),le!==void 0&&P.setElevation(le),z!==void 0&&P.setZoom(z),q!==void 0&&P.setRoll(q),G!==void 0&&P.setPitch(G),Y!==void 0&&P.setBearing(Y),v.apply(P)}this.transform.apply(v)}_fireMoveEvents(l){this.fire(new i.l("move",l)),this._zooming&&this.fire(new i.l("zoom",l)),this._rotating&&this.fire(new i.l("rotate",l)),this._pitching&&this.fire(new i.l("pitch",l)),this._rolling&&this.fire(new i.l("roll",l))}_afterEase(l,m){if(this._easeId&&m&&this._easeId===m)return;delete this._easeId;const v=this._zooming,_=this._rotating,P=this._pitching,I=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,v&&this.fire(new i.l("zoomend",l)),_&&this.fire(new i.l("rotateend",l)),P&&this.fire(new i.l("pitchend",l)),I&&this.fire(new i.l("rollend",l)),this.fire(new i.l("moveend",l))}flyTo(l,m){if(!l.essential&&b.prefersReducedMotion){const xt=i.S(l,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(xt,m)}this.stop(),l=i.e({offset:[0,0],speed:1.2,curve:1.42,easing:i.cr},l);const v=this._getTransformForUpdate(),_=v.bearing,P=v.pitch,I=v.roll,z=v.padding,q="bearing"in l?this._normalizeBearing(l.bearing,_):_,G="pitch"in l?+l.pitch:P,Y="roll"in l?this._normalizeBearing(l.roll,I):I,le="padding"in l?l.padding:v.padding,ie=i.P.convert(l.offset);let fe=v.centerPoint.add(ie);const _e=v.screenPointToLocation(fe),Ee=this.cameraHelper.handleFlyTo(v,{bearing:q,pitch:G,roll:Y,padding:le,locationAtOffset:_e,offsetAsPoint:ie,center:l.center,minZoom:l.minZoom,zoom:l.zoom});let Oe=l.curve;const Re=Math.max(v.width,v.height),ze=Re/Ee.scaleOfZoom,Ue=Ee.pixelPathLength;typeof Ee.scaleOfMinZoom=="number"&&(Oe=Math.sqrt(Re/Ee.scaleOfMinZoom/Ue*2));const $e=Oe*Oe;function We(xt){const Ut=(ze*ze-Re*Re+(xt?-1:1)*$e*$e*Ue*Ue)/(2*(xt?ze:Re)*$e*Ue);return Math.log(Math.sqrt(Ut*Ut+1)-Ut)}function Ye(xt){return(Math.exp(xt)-Math.exp(-xt))/2}function Be(xt){return(Math.exp(xt)+Math.exp(-xt))/2}const et=We(!1);let pt=function(xt){return Be(et)/Be(et+Oe*xt)},ut=function(xt){return Re*((Be(et)*(Ye(Ut=et+Oe*xt)/Be(Ut))-Ye(et))/$e)/Ue;var Ut},mt=(We(!0)-et)/Oe;if(Math.abs(Ue)<2e-6||!isFinite(mt)){if(Math.abs(Re-ze)<1e-6)return this.easeTo(l,m);const xt=ze<Re?-1:1;mt=Math.abs(Math.log(ze/Re))/Oe,ut=()=>0,pt=Ut=>Math.exp(xt*Oe*Ut)}return l.duration="duration"in l?+l.duration:1e3*mt/("screenSpeed"in l?+l.screenSpeed/Oe:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=_!==q,this._pitching=G!==P,this._rolling=Y!==I,this._padding=!v.isPaddingEqual(le),this._prepareEase(m,!1),this.terrain&&this._prepareElevation(Ee.targetCenter),this._ease(xt=>{const Ut=xt*mt,Wt=1/pt(Ut),Dt=ut(Ut);this._rotating&&v.setBearing(i.F.number(_,q,xt)),this._pitching&&v.setPitch(i.F.number(P,G,xt)),this._rolling&&v.setRoll(i.F.number(I,Y,xt)),this._padding&&(v.interpolatePadding(z,le,xt),fe=v.centerPoint.add(ie)),Ee.easeFunc(xt,Wt,Dt,fe),this.terrain&&!l.freezeElevation&&this._updateElevation(xt),this._applyUpdatedTransform(v),this._fireMoveEvents(m)},()=>{this.terrain&&l.freezeElevation&&this._finalizeElevation(),this._afterEase(m)},l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,m){var v;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const _=this._onEaseEnd;delete this._onEaseEnd,_.call(this,m)}return l||(v=this.handlers)===null||v===void 0||v.stop(!1),this}_ease(l,m,v){v.animate===!1||v.duration===0?(l(1),m()):(this._easeStart=T(),this._easeOptions=v,this._onEaseFrame=l,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(l,m){l=i.V(l,-180,180);const v=Math.abs(l-m);return Math.abs(l-360-m)<v&&(l-=360),Math.abs(l+360-m)<v&&(l+=360),l}queryTerrainElevation(l){return this.terrain?this.terrain.getElevationForLngLatZoom(i.U.convert(l),this.transform.tileZoom):null}}const wf={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class gi{constructor(l=wf){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=m=>{!m||m.sourceDataType!=="metadata"&&m.sourceDataType!=="visibility"&&m.dataType!=="style"&&m.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=l}getDefaultPosition(){return"bottom-right"}onAdd(l){return this._map=l,this._compact=this.options.compact,this._container=N.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=N.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=N.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){N.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(l,m){const v=this._map._getUIString(`AttributionControl.${m}`);l.title=v,l.setAttribute("aria-label",v)}_updateAttributions(){if(!this._map.style)return;let l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(_=>typeof _!="string"?"":_)):typeof this.options.customAttribution=="string"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const m=this._map.style.tileManagers;for(const _ in m){const P=m[_];if(P.used||P.usedForTerrain){const I=P.getSource();I.attribution&&l.indexOf(I.attribution)<0&&l.push(I.attribution)}}l=l.filter(_=>String(_).trim()),l.sort((_,P)=>_.length-P.length),l=l.filter((_,P)=>{for(let I=P+1;I<l.length;I++)if(l[I].indexOf(_)>=0)return!1;return!0});const v=l.join(" | ");v!==this._attribHTML&&(this._attribHTML=v,l.length?(this._innerContainer.innerHTML=N.sanitize(v),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Pj{constructor(l={}){this._updateCompact=()=>{const m=this._container.children;if(m.length){const v=m[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&v.classList.add("maplibregl-compact"):v.classList.remove("maplibregl-compact")}},this.options=l}getDefaultPosition(){return"bottom-left"}onAdd(l){this._map=l,this._compact=this.options&&this.options.compact,this._container=N.create("div","maplibregl-ctrl");const m=N.create("a","maplibregl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://maplibre.org/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){N.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class el{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const m=++this._id;return this._queue.push({callback:l,id:m,cancelled:!1}),m}remove(l){const m=this._currentlyRunning,v=m?this._queue.concat(m):this._queue;for(const _ of v)if(_.id===l)return void(_.cancelled=!0)}run(l=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const m=this._currentlyRunning=this._queue;this._queue=[];for(const v of m)if(!v.cancelled&&(v.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var o1=i.aN([{name:"a_pos3d",type:"Int16",components:3}]);class ck extends i.E{constructor(l){super(),this._lastTilesetChange=T(),this.tileManager=l,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=l._source.tileSize*2**this.deltaZoom,l.usedForTerrain=!0,l.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(l,m){this.tileManager.update(l,m),this._renderableTilesKeys=[];const v={};for(const _ of Os(l,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:m,calculateTileZoom:this.tileManager._source.calculateTileZoom}))v[_.key]=!0,this._renderableTilesKeys.push(_.key),this._tiles[_.key]||(_.terrainRttPosMatrix32f=new Float64Array(16),i.c0(_.terrainRttPosMatrix32f,0,i.a3,i.a3,0,0,1),this._tiles[_.key]=new Ge(_,this.tileSize),this._lastTilesetChange=T());for(const _ in this._tiles)v[_]||delete this._tiles[_]}freeRtt(l){for(const m in this._tiles){const v=this._tiles[m];(!l||v.tileID.equals(l)||v.tileID.isChildOf(l)||l.isChildOf(v.tileID))&&(v.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(l=>this.getTileByID(l))}getTileByID(l){return this._tiles[l]}getTerrainCoords(l,m){return m?this._getTerrainCoordsForTileRanges(l,m):this._getTerrainCoordsForRegularTile(l)}_getTerrainCoordsForRegularTile(l){const m={};for(const v of this._renderableTilesKeys){const _=this._tiles[v].tileID,P=l.clone(),I=i.bd();if(_.canonical.equals(l.canonical))i.c0(I,0,i.a3,i.a3,0,0,1);else if(_.canonical.isChildOf(l.canonical)){const z=_.canonical.z-l.canonical.z,q=_.canonical.x-(_.canonical.x>>z<<z),G=_.canonical.y-(_.canonical.y>>z<<z),Y=i.a3>>z;i.c0(I,0,Y,Y,0,0,1),i.N(I,I,[-q*Y,-G*Y,0])}else{if(!l.canonical.isChildOf(_.canonical))continue;{const z=l.canonical.z-_.canonical.z,q=l.canonical.x-(l.canonical.x>>z<<z),G=l.canonical.y-(l.canonical.y>>z<<z),Y=i.a3>>z;i.c0(I,0,i.a3,i.a3,0,0,1),i.N(I,I,[q*Y,G*Y,0]),i.O(I,I,[1/2**z,1/2**z,0])}}P.terrainRttPosMatrix32f=new Float32Array(I),m[v]=P}return m}_getTerrainCoordsForTileRanges(l,m){const v={};for(const _ of this._renderableTilesKeys){const P=this._tiles[_].tileID;if(!this._isWithinTileRanges(P,m))continue;const I=l.clone(),z=i.bd();if(P.canonical.z===l.canonical.z){const q=l.canonical.x-P.canonical.x,G=l.canonical.y-P.canonical.y;i.c0(z,0,i.a3,i.a3,0,0,1),i.N(z,z,[q*i.a3,G*i.a3,0])}else if(P.canonical.z>l.canonical.z){const q=P.canonical.z-l.canonical.z,G=P.canonical.x-(P.canonical.x>>q<<q),Y=P.canonical.y-(P.canonical.y>>q<<q),le=l.canonical.x-(P.canonical.x>>q),ie=l.canonical.y-(P.canonical.y>>q),fe=i.a3>>q;i.c0(z,0,fe,fe,0,0,1),i.N(z,z,[-G*fe+le*i.a3,-Y*fe+ie*i.a3,0])}else{const q=l.canonical.z-P.canonical.z,G=l.canonical.x-(l.canonical.x>>q<<q),Y=l.canonical.y-(l.canonical.y>>q<<q),le=(l.canonical.x>>q)-P.canonical.x,ie=(l.canonical.y>>q)-P.canonical.y,fe=i.a3<<q;i.c0(z,0,fe,fe,0,0,1),i.N(z,z,[G*i.a3+le*fe,Y*i.a3+ie*fe,0])}I.terrainRttPosMatrix32f=new Float32Array(z),v[_]=I}return v}getSourceTile(l,m){const v=this.tileManager._source;let _=l.overscaledZ-this.deltaZoom;if(_>v.maxzoom&&(_=v.maxzoom),_<v.minzoom)return null;this._sourceTileCache[l.key]||(this._sourceTileCache[l.key]=l.scaledTo(_).key);let P=this.tileManager.getTileByID(this._sourceTileCache[l.key]);if((!P||!P.dem)&&m)for(;_>=v.minzoom&&(!P||!P.dem);)P=this.tileManager.getTileByID(l.scaledTo(_--).key);return P}anyTilesAfterTime(l=Date.now()){return this._lastTilesetChange>=l}_isWithinTileRanges(l,m){return m[l.canonical.z]&&l.canonical.x>=m[l.canonical.z].minTileX&&l.canonical.x<=m[l.canonical.z].maxTileX&&l.canonical.y>=m[l.canonical.z].minTileY&&l.canonical.y<=m[l.canonical.z].maxTileY}}class dk{constructor(l,m,v){this._meshCache={},this.painter=l,this.tileManager=new ck(m),this.options=v,this.exaggeration=typeof v.exaggeration=="number"?v.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(l,m,v,_=i.a3){var P;if(!(m>=0&&m<_&&v>=0&&v<_))return 0;const I=this.getTerrainData(l),z=(P=I.tile)===null||P===void 0?void 0:P.dem;if(!z)return 0;const q=i.cv([],[m/_*i.a3,v/_*i.a3],I.u_terrain_matrix),G=[q[0]*z.dim,q[1]*z.dim],Y=Math.floor(G[0]),le=Math.floor(G[1]),ie=G[0]-Y,fe=G[1]-le;return z.get(Y,le)*(1-ie)*(1-fe)+z.get(Y+1,le)*ie*(1-fe)+z.get(Y,le+1)*(1-ie)*fe+z.get(Y+1,le+1)*ie*fe}getElevationForLngLatZoom(l,m){if(!i.cw(m,l.wrap()))return 0;const{tileID:v,mercatorX:_,mercatorY:P}=this._getOverscaledTileIDFromLngLatZoom(l,m);return this.getElevation(v,_%i.a3,P%i.a3,i.a3)}getElevation(l,m,v,_=i.a3){return this.getDEMElevation(l,m,v,_)*this.exaggeration}getTerrainData(l){if(!this._emptyDemTexture){const _=this.painter.context,P=new i.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new i.T(_,P,_.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new i.T(_,new i.R({width:1,height:1}),_.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=i.am([])}const m=this.tileManager.getSourceTile(l,!0);if(m&&m.dem&&(!m.demTexture||m.needsTerrainPrepare)){const _=this.painter.context;m.demTexture=this.painter.getTileTexture(m.dem.stride),m.demTexture?m.demTexture.update(m.dem.getPixels(),{premultiply:!1}):m.demTexture=new i.T(_,m.dem.getPixels(),_.gl.RGBA,{premultiply:!1}),m.demTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),m.needsTerrainPrepare=!1}const v=m&&m+m.tileID.key+l.key;if(v&&!this._demMatrixCache[v]){const _=this.tileManager.getSource().maxzoom;let P=l.canonical.z-m.tileID.canonical.z;l.overscaledZ>l.canonical.z&&(l.canonical.z>=_?P=l.canonical.z-_:i.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const I=l.canonical.x-(l.canonical.x>>P<<P),z=l.canonical.y-(l.canonical.y>>P<<P),q=i.cx(new Float64Array(16),[1/(i.a3<<P),1/(i.a3<<P),0]);i.N(q,q,[I*i.a3,z*i.a3,0]),this._demMatrixCache[l.key]={matrix:q,coord:l}}return{u_depth:2,u_terrain:3,u_terrain_dim:m&&m.dem&&m.dem.dim||1,u_terrain_matrix:v?this._demMatrixCache[l.key].matrix:this._emptyDemMatrix,u_terrain_unpack:m&&m.dem&&m.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(m&&m.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:m}}getFramebuffer(l){const m=this.painter,v=m.width/devicePixelRatio,_=m.height/devicePixelRatio;return!this._fbo||this._fbo.width===v&&this._fbo.height===_||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new i.T(m.context,{width:v,height:_,data:null},m.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(m.context.gl.NEAREST,m.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new i.T(m.context,{width:v,height:_,data:null},m.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(m.context.gl.NEAREST,m.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=m.context.createFramebuffer(v,_,!0,!1),this._fbo.depthAttachment.set(m.context.createRenderbuffer(m.context.gl.DEPTH_COMPONENT16,v,_))),this._fbo.colorAttachment.set(l==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const l=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const m=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let P=0,I=0;P<this._coordsTextureSize;P++)for(let z=0;z<this._coordsTextureSize;z++,I+=4)m[I+0]=255&z,m[I+1]=255&P,m[I+2]=z>>8<<4|P>>8,m[I+3]=0;const v=new i.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(m.buffer)),_=new i.T(l,v,l.gl.RGBA,{premultiply:!1});return _.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._coordsTexture=_,_}pointCoordinate(l){this.painter.maybeDrawDepthAndCoords(!0);const m=new Uint8Array(4),v=this.painter.context,_=v.gl,P=Math.round(l.x*this.painter.pixelRatio/devicePixelRatio),I=Math.round(l.y*this.painter.pixelRatio/devicePixelRatio),z=Math.round(this.painter.height/devicePixelRatio);v.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),_.readPixels(P,z-I-1,1,1,_.RGBA,_.UNSIGNED_BYTE,m),v.bindFramebuffer.set(null);const q=m[0]+(m[2]>>4<<8),G=m[1]+((15&m[2])<<8),Y=this.coordsIndex[255-m[3]],le=Y&&this.tileManager.getTileByID(Y);if(!le)return null;const ie=this._coordsTextureSize,fe=(1<<le.tileID.canonical.z)*ie;return new i.a5((le.tileID.canonical.x*ie+q)/fe+le.tileID.wrap,(le.tileID.canonical.y*ie+G)/fe,this.getElevation(le.tileID,q,G,ie))}depthAtPoint(l){const m=new Uint8Array(4),v=this.painter.context,_=v.gl;return v.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),_.readPixels(l.x,this.painter.height/devicePixelRatio-l.y-1,1,1,_.RGBA,_.UNSIGNED_BYTE,m),v.bindFramebuffer.set(null),(m[0]/16777216+m[1]/65536+m[2]/256+m[3])/256}getTerrainMesh(l){var m;const v=((m=this.painter.style.projection)===null||m===void 0?void 0:m.transitionState)>0,_=v&&l.canonical.y===0,P=v&&l.canonical.y===(1<<l.canonical.z)-1,I=`m_${_?"n":""}_${P?"s":""}`;if(this._meshCache[I])return this._meshCache[I];const z=this.painter.context,q=new i.cy,G=new i.aR,Y=this.meshSize,le=i.a3/Y,ie=Y*Y;for(let Be=0;Be<=Y;Be++)for(let et=0;et<=Y;et++)q.emplaceBack(et*le,Be*le,0);for(let Be=0;Be<ie;Be+=Y+1)for(let et=0;et<Y;et++)G.emplaceBack(et+Be,Y+et+Be+1,Y+et+Be+2),G.emplaceBack(et+Be,Y+et+Be+2,et+Be+1);const fe=q.length,_e=fe+(Y+1),Ee=(Y+1)*Y,Oe=_?i.bk:0,Re=_?0:1,ze=P?i.bl:i.a3,Ue=P?0:1;for(let Be=0;Be<=Y;Be++)q.emplaceBack(Be*le,Oe,Re);for(let Be=0;Be<=Y;Be++)q.emplaceBack(Be*le,ze,Ue);for(let Be=0;Be<Y;Be++)G.emplaceBack(Ee+Be,_e+Be,_e+Be+1),G.emplaceBack(Ee+Be,_e+Be+1,Ee+Be+1),G.emplaceBack(0+Be,fe+Be+1,fe+Be),G.emplaceBack(0+Be,0+Be+1,fe+Be+1);const $e=q.length,We=$e+2*(Y+1);for(const Be of[0,1])for(let et=0;et<=Y;et++)for(const pt of[0,1])q.emplaceBack(Be*i.a3,et*le,pt);for(let Be=0;Be<2*Y;Be+=2)G.emplaceBack($e+Be,$e+Be+1,$e+Be+3),G.emplaceBack($e+Be,$e+Be+3,$e+Be+2),G.emplaceBack(We+Be,We+Be+3,We+Be+1),G.emplaceBack(We+Be,We+Be+2,We+Be+3);const Ye=new oh(z.createVertexBuffer(q,o1.members),z.createIndexBuffer(G),i.aQ.simpleSegment(0,0,q.length,G.length));return this._meshCache[I]=Ye,Ye}getMeshFrameDelta(l){return 2*Math.PI*i.bx/Math.pow(2,Math.max(l,0))/5}getMinTileElevationForLngLatZoom(l,m){var v;const{tileID:_}=this._getOverscaledTileIDFromLngLatZoom(l,m);return(v=this.getMinMaxElevation(_).minElevation)!==null&&v!==void 0?v:0}getMinMaxElevation(l){const m=this.getTerrainData(l).tile,v={minElevation:null,maxElevation:null};return m&&m.dem&&(v.minElevation=m.dem.min*this.exaggeration,v.maxElevation=m.dem.max*this.exaggeration),v}_getOverscaledTileIDFromLngLatZoom(l,m){const v=i.a5.fromLngLat(l.wrap()),_=(1<<m)*i.a3,P=v.x*_,I=v.y*_,z=Math.floor(P/i.a3),q=Math.floor(I/i.a3);return{tileID:new i.a0(m,0,m,z,q),mercatorX:P,mercatorY:I}}}class uk{constructor(l,m,v){this._context=l,this._size=m,this._tileSize=v,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const l of this._objects)l.texture.destroy(),l.fbo.destroy()}_createObject(l){const m=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),v=new i.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return v.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),m.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),m.colorAttachment.set(v.texture),{id:l,fbo:m,texture:v,stamp:-1,inUse:!1}}getObjectForId(l){return this._objects[l]}useObject(l){l.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(m=>l.id!==m),this._recentlyUsed.push(l.id)}stampObject(l){l.stamp=++this._stamp}getOrCreateFreeObject(){for(const m of this._recentlyUsed)if(!this._objects[m].inUse)return this._objects[m];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const l=this._createObject(this._objects.length);return this._objects.push(l),l}freeObject(l){l.inUse=!1}freeAllObjects(){for(const l of this._objects)this.freeObject(l)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(l=>!l.inUse)===!1}}const Al={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class On{constructor(l,m){this.painter=l,this.terrain=m,this.pool=new uk(l.context,30,m.tileManager.tileSize*m.qualityFactor)}destruct(){this.pool.destruct()}getTexture(l){return this.pool.getObjectForId(l.rtt[this._stacks.length-1].id).texture}prepareForRender(l,m){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=l._order.filter(v=>!l._layers[v].isHidden(m)),this._coordsAscending={};for(const v in l.tileManagers){this._coordsAscending[v]={};const _=l.tileManagers[v].getVisibleCoordinates(),P=l.tileManagers[v].getSource(),I=P instanceof It?P.terrainTileRanges:null;for(const z of _){const q=this.terrain.tileManager.getTerrainCoords(z,I);for(const G in q)this._coordsAscending[v][G]||(this._coordsAscending[v][G]=[]),this._coordsAscending[v][G].push(q[G])}}this._coordsAscendingStr={};for(const v of l._order){const _=l._layers[v],P=_.source;if(Al[_.type]&&!this._coordsAscendingStr[P]){this._coordsAscendingStr[P]={};for(const I in this._coordsAscending[P])this._coordsAscendingStr[P][I]=this._coordsAscending[P][I].map(z=>z.key).sort().join()}}for(const v of this._renderableTiles)for(const _ in this._coordsAscendingStr){const P=this._coordsAscendingStr[_][v.tileID.key];P&&P!==v.rttCoords[_]&&(v.rtt=[])}}renderLayer(l,m){if(l.isHidden(this.painter.transform.zoom))return!1;const v=Object.assign(Object.assign({},m),{isRenderingToTexture:!0}),_=l.type,P=this.painter,I=this._renderableLayerIds[this._renderableLayerIds.length-1]===l.id;if(Al[_]&&(this._prevType&&Al[this._prevType]||this._stacks.push([]),this._prevType=_,this._stacks[this._stacks.length-1].push(l.id),!I))return!0;if(Al[this._prevType]||Al[_]&&I){this._prevType=_;const z=this._stacks.length-1,q=this._stacks[z]||[];for(const G of this._renderableTiles){if(this.pool.isFull()&&(pj(this.painter,this.terrain,this._rttTiles,v),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(G),G.rtt[z]){const le=this.pool.getObjectForId(G.rtt[z].id);if(le.stamp===G.rtt[z].stamp){this.pool.useObject(le);continue}}const Y=this.pool.getOrCreateFreeObject();this.pool.useObject(Y),this.pool.stampObject(Y),G.rtt[z]={id:Y.id,stamp:Y.stamp},P.context.bindFramebuffer.set(Y.fbo.framebuffer),P.context.clear({color:i.bi.transparent,stencil:0}),P.currentStencilSource=void 0;for(let le=0;le<q.length;le++){const ie=P.style._layers[q[le]],fe=ie.source?this._coordsAscending[ie.source][G.tileID.key]:[G.tileID];P.context.viewport.set([0,0,Y.fbo.width,Y.fbo.height]),P._renderTileClippingMasks(ie,fe,!0),P.renderLayer(P,P.style.tileManagers[ie.source],ie,fe,v),ie.source&&(G.rttCoords[ie.source]=this._coordsAscendingStr[ie.source][G.tileID.key])}}return pj(this.painter,this.terrain,this._rttTiles,v),this._rttTiles=[],this.pool.freeAllObjects(),Al[_]}return!1}}const Qn={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},l1=f,bh={hash:!1,interactive:!0,bearingSnap:7,attributionControl:wf,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:i.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Px={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class kj{constructor(l,m,v=!1){this.mousedown=P=>{this.startMove(P,N.mousePos(this.element,P)),N.addEventListener(window,"mousemove",this.mousemove),N.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=P=>{this.move(P,N.mousePos(this.element,P))},this.mouseup=P=>{this._rotatePitchHandler.dragEnd(P),this.offTemp()},this.touchstart=P=>{P.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=N.touchPos(this.element,P.targetTouches)[0],this.startMove(P,this._startPos),N.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.addEventListener(window,"touchend",this.touchend))},this.touchmove=P=>{P.targetTouches.length!==1?this.reset():(this._lastPos=N.touchPos(this.element,P.targetTouches)[0],this.move(P,this._lastPos))},this.touchend=P=>{P.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=m;const _=new jj;this._rotatePitchHandler=new pr({clickTolerance:3,move:(P,I)=>{const z=m.getBoundingClientRect(),q=new i.P((z.bottom-z.top)/2,(z.right-z.left)/2);return{bearingDelta:i.cq(new i.P(P.x,I.y),I,q),pitchDelta:v?-.5*(I.y-P.y):void 0}},moveStateManager:_,enable:!0,assignEvents:()=>{}}),this.map=l,N.addEventListener(m,"mousedown",this.mousedown),N.addEventListener(m,"touchstart",this.touchstart,{passive:!1}),N.addEventListener(m,"touchcancel",this.reset)}startMove(l,m){this._rotatePitchHandler.dragStart(l,m),N.disableDrag()}move(l,m){const v=this.map,{bearingDelta:_,pitchDelta:P}=this._rotatePitchHandler.dragMove(l,m)||{};_&&v.setBearing(v.getBearing()+_),P&&v.setPitch(v.getPitch()+P)}off(){const l=this.element;N.removeEventListener(l,"mousedown",this.mousedown),N.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),N.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.removeEventListener(window,"touchend",this.touchend),N.removeEventListener(l,"touchcancel",this.reset),this.offTemp()}offTemp(){N.enableDrag(),N.removeEventListener(window,"mousemove",this.mousemove),N.removeEventListener(window,"mouseup",this.mouseup),N.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.removeEventListener(window,"touchend",this.touchend)}}let fc;function kx(S,l,m,v=!1){if(v||!m.getCoveringTilesDetailsProvider().allowWorldCopies())return S==null?void 0:S.wrap();const _=new i.U(S.lng,S.lat);if(S=new i.U(S.lng,S.lat),l){const P=new i.U(S.lng-360,S.lat),I=new i.U(S.lng+360,S.lat),z=m.locationToScreenPoint(S).distSqr(l);m.locationToScreenPoint(P).distSqr(l)<z?S=P:m.locationToScreenPoint(I).distSqr(l)<z&&(S=I)}for(;Math.abs(S.lng-m.center.lng)>180;){const P=m.locationToScreenPoint(S);if(P.x>=0&&P.y>=0&&P.x<=m.width&&P.y<=m.height)break;S.lng>m.center.lng?S.lng-=360:S.lng+=360}return S.lng!==_.lng&&m.isPointOnMapSurface(m.locationToScreenPoint(S))?S:_}const nu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ax(S,l,m){const v=S.classList;for(const _ in nu)v.remove(`maplibregl-${m}-anchor-${_}`);v.add(`maplibregl-${m}-anchor-${l}`)}class Nf extends i.E{constructor(l){if(super(),this._onKeyPress=m=>{const v=m.code,_=m.charCode||m.keyCode;v!=="Space"&&v!=="Enter"&&_!==32&&_!==13||this.togglePopup()},this._onMapClick=m=>{const v=m.originalEvent.target,_=this._element;this._popup&&(v===_||_.contains(v))&&this.togglePopup()},this._update=m=>{if(!this._map)return;const v=this._map.loaded()&&!this._map.isMoving();((m==null?void 0:m.type)==="terrain"||(m==null?void 0:m.type)==="render"&&!v)&&this._map.once("render",this._update),this._lngLat=kx(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let _="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?_=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(_=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let P="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?P="rotateX(0deg)":this._pitchAlignment==="map"&&(P=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||m&&m.type!=="moveend"||(this._pos=this._pos.round()),N.setTransform(this._element,`${nu[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${P} ${_}`),b.frameAsync(new AbortController).then(()=>{this._updateOpacity(m&&m.type==="moveend")}).catch(()=>{})},this._onMove=m=>{if(!this._isDragging){const v=this._clickTolerance||this._map._clickTolerance;this._isDragging=m.point.dist(this._pointerdownPos)>=v}this._isDragging&&(this._pos=m.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.l("dragstart"))),this.fire(new i.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new i.l("dragend")),this._state="inactive"},this._addDragHandler=m=>{this._element.contains(m.originalEvent.target)&&(m.preventDefault(),this._positionDelta=m.point.sub(this._pos).add(this._offset),this._pointerdownPos=m.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._subpixelPositioning=l&&l.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!=="auto"?l.pitchAlignment:this._rotationAlignment,this.setOpacity(l==null?void 0:l.opacity,l==null?void 0:l.opacityWhenCovered),l&&l.element)this._element=l.element,this._offset=i.P.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=N.create("div");const m=N.createNS("http://www.w3.org/2000/svg","svg"),v=41,_=27;m.setAttributeNS(null,"display","block"),m.setAttributeNS(null,"height",`${v}px`),m.setAttributeNS(null,"width",`${_}px`),m.setAttributeNS(null,"viewBox",`0 0 ${_} ${v}`);const P=N.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"stroke","none"),P.setAttributeNS(null,"stroke-width","1"),P.setAttributeNS(null,"fill","none"),P.setAttributeNS(null,"fill-rule","evenodd");const I=N.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"fill-rule","nonzero");const z=N.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"transform","translate(3.0, 29.0)"),z.setAttributeNS(null,"fill","#000000");const q=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Re of q){const ze=N.createNS("http://www.w3.org/2000/svg","ellipse");ze.setAttributeNS(null,"opacity","0.04"),ze.setAttributeNS(null,"cx","10.5"),ze.setAttributeNS(null,"cy","5.80029008"),ze.setAttributeNS(null,"rx",Re.rx),ze.setAttributeNS(null,"ry",Re.ry),z.appendChild(ze)}const G=N.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"fill",this._color);const Y=N.createNS("http://www.w3.org/2000/svg","path");Y.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),G.appendChild(Y);const le=N.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"opacity","0.25"),le.setAttributeNS(null,"fill","#000000");const ie=N.createNS("http://www.w3.org/2000/svg","path");ie.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),le.appendChild(ie);const fe=N.createNS("http://www.w3.org/2000/svg","g");fe.setAttributeNS(null,"transform","translate(6.0, 7.0)"),fe.setAttributeNS(null,"fill","#FFFFFF");const _e=N.createNS("http://www.w3.org/2000/svg","g");_e.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Ee=N.createNS("http://www.w3.org/2000/svg","circle");Ee.setAttributeNS(null,"fill","#000000"),Ee.setAttributeNS(null,"opacity","0.25"),Ee.setAttributeNS(null,"cx","5.5"),Ee.setAttributeNS(null,"cy","5.5"),Ee.setAttributeNS(null,"r","5.4999962");const Oe=N.createNS("http://www.w3.org/2000/svg","circle");Oe.setAttributeNS(null,"fill","#FFFFFF"),Oe.setAttributeNS(null,"cx","5.5"),Oe.setAttributeNS(null,"cy","5.5"),Oe.setAttributeNS(null,"r","5.4999962"),_e.appendChild(Ee),_e.appendChild(Oe),I.appendChild(z),I.appendChild(G),I.appendChild(le),I.appendChild(fe),I.appendChild(_e),m.appendChild(I),m.setAttributeNS(null,"height",v*this._scale+"px"),m.setAttributeNS(null,"width",_*this._scale+"px"),this._element.appendChild(m),this._offset=i.P.convert(l&&l.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",m=>{m.preventDefault()}),this._element.addEventListener("mousedown",m=>{m.preventDefault()}),Ax(this._element,this._anchor,"marker"),l&&l.className)for(const m of l.className.split(" "))this._element.classList.add(m);this._popup=null}addTo(l){return this.remove(),this._map=l,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",l._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),l.on("terrain",this._update),l.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),N.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=i.U.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const _=Math.abs(13.5)/Math.SQRT2;l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(l){return this._subpixelPositioning=l,this}getPopup(){return this._popup}togglePopup(){const l=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:l?(l.isOpen()?l.remove():(l.setLngLat(this._lngLat),l.addTo(this._map)),this):this}_updateOpacity(l=!1){var m,v;const _=(m=this._map)===null||m===void 0?void 0:m.terrain,P=this._map.transform.isLocationOccluded(this._lngLat);if(!_||P){const fe=P?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==fe&&(this._element.style.opacity=fe))}if(l)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const I=this._map,z=I.terrain.depthAtPoint(this._pos),q=I.terrain.getElevationForLngLatZoom(this._lngLat,I.transform.tileZoom);if(I.transform.lngLatToCameraDepth(this._lngLat,q)-z<.006)return void(this._element.style.opacity=this._opacity);const G=-this._offset.y/I.transform.pixelsPerMeter,Y=Math.sin(I.getPitch()*Math.PI/180)*G,le=I.terrain.depthAtPoint(new i.P(this._pos.x,this._pos.y-this._offset.y)),ie=I.transform.lngLatToCameraDepth(this._lngLat,q+Y)-le>.006;!((v=this._popup)===null||v===void 0)&&v.isOpen()&&ie&&this._popup.remove(),this._element.style.opacity=ie?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(l){return this._offset=i.P.convert(l),this._update(),this}addClassName(l){this._element.classList.add(l)}removeClassName(l){this._element.classList.remove(l)}toggleClassName(l){return this._element.classList.toggle(l)}setDraggable(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l&&l!=="auto"?l:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(l,m){return(this._opacity===void 0||l===void 0&&m===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),l!==void 0&&(this._opacity=l),m!==void 0&&(this._opacityWhenCovered=m),this._map&&this._updateOpacity(!0),this}}const Aj={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let _h=0,au=!1;const Tj={maxWidth:100,unit:"metric"};function Tx(S,l,m){const v=m&&m.maxWidth||100,_=S._container.clientHeight/2,P=S._container.clientWidth/2,I=S.unproject([P-v/2,_]),z=S.unproject([P+v/2,_]),q=Math.round(S.project(z).x-S.project(I).x),G=Math.min(v,q,S._container.clientWidth),Y=I.distanceTo(z);if(m&&m.unit==="imperial"){const le=3.2808*Y;le>5280?iu(l,G,le/5280,S._getUIString("ScaleControl.Miles")):iu(l,G,le,S._getUIString("ScaleControl.Feet"))}else m&&m.unit==="nautical"?iu(l,G,Y/1852,S._getUIString("ScaleControl.NauticalMiles")):Y>=1e3?iu(l,G,Y/1e3,S._getUIString("ScaleControl.Kilometers")):iu(l,G,Y,S._getUIString("ScaleControl.Meters"))}function iu(S,l,m,v){const _=function(P){const I=Math.pow(10,`${Math.floor(P)}`.length-1);let z=P/I;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:z>=1?1:function(q){const G=Math.pow(10,Math.ceil(-Math.log(q)/Math.LN10));return Math.round(q*G)/G}(z),I*z}(m);S.style.width=l*(_/m)+"px",S.innerHTML=`${_}&nbsp;${v}`}const Ej={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Ex=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Mx(S){if(S){if(typeof S=="number"){const l=Math.round(Math.abs(S)/Math.SQRT2);return{center:new i.P(0,0),top:new i.P(0,S),"top-left":new i.P(l,l),"top-right":new i.P(-l,l),bottom:new i.P(0,-S),"bottom-left":new i.P(l,-l),"bottom-right":new i.P(-l,-l),left:new i.P(S,0),right:new i.P(-S,0)}}if(S instanceof i.P||Array.isArray(S)){const l=i.P.convert(S);return{center:l,top:l,"top-left":l,"top-right":l,bottom:l,"bottom-left":l,"bottom-right":l,left:l,right:l}}return{center:i.P.convert(S.center||[0,0]),top:i.P.convert(S.top||[0,0]),"top-left":i.P.convert(S["top-left"]||[0,0]),"top-right":i.P.convert(S["top-right"]||[0,0]),bottom:i.P.convert(S.bottom||[0,0]),"bottom-left":i.P.convert(S["bottom-left"]||[0,0]),"bottom-right":i.P.convert(S["bottom-right"]||[0,0]),left:i.P.convert(S.left||[0,0]),right:i.P.convert(S.right||[0,0])}}return Mx(new i.P(0,0))}const Mj=f;c.AJAXError=i.cC,c.Event=i.l,c.Evented=i.E,c.LngLat=i.U,c.MercatorCoordinate=i.a5,c.Point=i.P,c.addProtocol=i.cD,c.config=i.a,c.removeProtocol=i.cE,c.AttributionControl=gi,c.BoxZoomHandler=Hw,c.CanvasSource=er,c.CooperativeGesturesHandler=Jo,c.DoubleClickZoomHandler=bf,c.DragPanHandler=Sj,c.DragRotateHandler=Cj,c.EdgeInsets=na,c.FullscreenControl=class extends i.E{constructor(S={}){super(),this._onFullscreenChange=()=>{var l;let m=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((l=m==null?void 0:m.shadowRoot)===null||l===void 0)&&l.fullscreenElement;)m=m.shadowRoot.fullscreenElement;m===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,S&&S.container&&(S.container instanceof HTMLElement?this._container=S.container:i.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(S){return this._map=S,this._container||(this._container=this._map.getContainer()),this._controlContainer=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){N.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const S=this._fullscreenButton=N.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);N.create("span","maplibregl-ctrl-icon",S).setAttribute("aria-hidden","true"),S.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const S=this._getTitle();this._fullscreenButton.setAttribute("aria-label",S),this._fullscreenButton.title=S}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new i.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new i.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},c.GeoJSONSource=qt,c.GeolocateControl=class extends i.E{constructor(S){super(),this._onSuccess=l=>{if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new i.l("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(l),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new i.l("geolocate",l)),this._finish()}},this._updateCamera=l=>{const m=new i.U(l.coords.longitude,l.coords.latitude),v=l.coords.accuracy,_=this._map.getBearing(),P=i.e({bearing:_},this.options.fitBoundsOptions),I=Dr.fromLngLat(m,v);this._map.fitBounds(I,P,{geolocateSource:!0})},this._updateMarker=l=>{if(l){const m=new i.U(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(m).addTo(this._map),this._userLocationDotMarker.setLngLat(m).addTo(this._map),this._accuracy=l.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=l=>{if(this._map){if(l.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(l.code===3&&au)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new i.l("error",l)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=N.create("button","maplibregl-ctrl-geolocate",this._container),N.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=l=>{if(this._map){if(l===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}else{const m=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=N.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Nf({element:this._dotElement}),this._circleElement=N.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Nf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",m=>{const v=(m==null?void 0:m[0])instanceof ResizeObserverEntry;m.geolocateSource||this._watchState!=="ACTIVE_LOCK"||v||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new i.l("trackuserlocationend")),this.fire(new i.l("userlocationlostfocus")))})}},this.options=i.e({},Aj,S)}onAdd(S){return this._map=S,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return i._(this,arguments,void 0,function*(l=!1){if(fc!==void 0&&!l)return fc;if(window.navigator.permissions===void 0)return fc=!!window.navigator.geolocation,fc;try{fc=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{fc=!!window.navigator.geolocation}return fc})}().then(l=>this._finishSetupUI(l)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),N.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,_h=0,au=!1}_isOutOfMapMaxBounds(S){const l=this._map.getMaxBounds(),m=S.coords;return l&&(m.longitude<l.getWest()||m.longitude>l.getEast()||m.latitude<l.getSouth()||m.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const S=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&S))return;const l=this._map.project(S),m=this._map.unproject([l.x+100,l.y]),v=S.distanceTo(m)/100,_=2*this._accuracy/v;this._circleElement.style.width=`${_.toFixed(2)}px`,this._circleElement.style.height=`${_.toFixed(2)}px`}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":_h--,au=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new i.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.l("trackuserlocationstart")),this.fire(new i.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let S;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),_h++,_h>1?(S={maximumAge:6e5,timeout:0},au=!0):(S=this.options.positionOptions,au=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,S)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},c.GlobeControl=class{constructor(){this._toggleProjection=()=>{var S;const l=(S=this._map.getProjection())===null||S===void 0?void 0:S.type;this._map.setProjection(l!=="mercator"&&l?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var S;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((S=this._map.getProjection())===null||S===void 0?void 0:S.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(S){return this._map=S,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=N.create("button","maplibregl-ctrl-globe",this._container),N.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){N.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},c.Hash=gj,c.ImageSource=It,c.KeyboardHandler=r1,c.LngLatBounds=Dr,c.LogoControl=Pj,c.Map=class extends i1{constructor(S){var l,m;i.cz.mark(i.cA.create);const v=Object.assign(Object.assign(Object.assign({},bh),S),{canvasContextAttributes:Object.assign(Object.assign({},bh.canvasContextAttributes),S.canvasContextAttributes)});if(v.minZoom!=null&&v.maxZoom!=null&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(v.minPitch!=null&&v.maxPitch!=null&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(v.minPitch!=null&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(v.maxPitch!=null&&v.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const _=new Pl,P=new Gd;if(v.minZoom!==void 0&&_.setMinZoom(v.minZoom),v.maxZoom!==void 0&&_.setMaxZoom(v.maxZoom),v.minPitch!==void 0&&_.setMinPitch(v.minPitch),v.maxPitch!==void 0&&_.setMaxPitch(v.maxPitch),v.renderWorldCopies!==void 0&&_.setRenderWorldCopies(v.renderWorldCopies),v.transformConstrain!==null&&_.setConstrain(v.transformConstrain),super(_,P,{bearingSnap:v.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new el,this._controls=[],this._mapId=i.ab(),this._contextLost=z=>{z.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new i.l("webglcontextlost",{originalEvent:z}))},this._contextRestored=z=>{this._setupPainter(),this.resize(),this._update(),this.fire(new i.l("webglcontextrestored",{originalEvent:z}))},this._onMapScroll=z=>{if(z.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=v.interactive,this._maxTileCacheSize=v.maxTileCacheSize,this._maxTileCacheZoomLevels=v.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},v.canvasContextAttributes),this._trackResize=v.trackResize===!0,this._bearingSnap=v.bearingSnap,this._centerClampedToGround=v.centerClampedToGround,this._refreshExpiredTiles=v.refreshExpiredTiles===!0,this._fadeDuration=v.fadeDuration,this._crossSourceCollisions=v.crossSourceCollisions===!0,this._collectResourceTiming=v.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Qn),v.locale),this._clickTolerance=v.clickTolerance,this._overridePixelRatio=v.pixelRatio,this._maxCanvasSize=v.maxCanvasSize,this.transformCameraUpdate=v.transformCameraUpdate,this.transformConstrain=v.transformConstrain,this.cancelPendingTileRequestsWhileZooming=v.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=B.addThrottleControl(()=>this.isMoving()),this._requestManager=new U(v.transformRequest),typeof v.container=="string"){if(this._container=document.getElementById(v.container),!this._container)throw new Error(`Container '${v.container}' not found.`)}else{if(!(v.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(v.maxBounds&&this.setMaxBounds(v.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let z=!1;const q=xj(G=>{this._trackResize&&!this._removed&&(this.resize(G),this.redraw())},50);this._resizeObserver=new ResizeObserver(G=>{z?q(G):z=!0}),this._resizeObserver.observe(this._container)}this.handlers=new _f(this,v),this._hash=v.hash&&new gj(typeof v.hash=="string"&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,elevation:v.elevation,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch,roll:v.roll}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,i.e({},v.fitBoundsOptions,{duration:0}))));const I=typeof v.style=="string"||((m=(l=v.style)===null||l===void 0?void 0:l.projection)===null||m===void 0?void 0:m.type)!=="globe";this.resize(null,I),this._localIdeographFontFamily=v.localIdeographFontFamily,this._validateStyle=v.validateStyle,v.style&&this.setStyle(v.style,{localIdeographFontFamily:v.localIdeographFontFamily}),v.attributionControl&&this.addControl(new gi(typeof v.attributionControl=="boolean"?void 0:v.attributionControl)),v.maplibreLogo&&this.addControl(new Pj,v.logoPosition),this.on("style.load",()=>{if(I||this._resizeTransform(),this.transform.unmodified){const z=i.S(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(z)}}),this.on("data",z=>{this._update(z.dataType==="style"),this.fire(new i.l(`${z.dataType}data`,z))}),this.on("dataloading",z=>{this.fire(new i.l(`${z.dataType}dataloading`,z))}),this.on("dataabort",z=>{this.fire(new i.l("sourcedataabort",z))})}_getMapId(){return this._mapId}setGlobalStateProperty(S,l){return this.style.setGlobalStateProperty(S,l),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(S,l){if(l===void 0&&(l=S.getDefaultPosition?S.getDefaultPosition():"top-right"),!S||!S.onAdd)return this.fire(new i.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const m=S.onAdd(this);this._controls.push(S);const v=this._controlPositions[l];return l.indexOf("bottom")!==-1?v.insertBefore(m,v.firstChild):v.appendChild(m),this}removeControl(S){if(!S||!S.onRemove)return this.fire(new i.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(S);return l>-1&&this._controls.splice(l,1),S.onRemove(this),this}hasControl(S){return this._controls.indexOf(S)>-1}coveringTiles(S){return Os(this.transform,S)}calculateCameraOptionsFromTo(S,l,m,v){return v==null&&this.terrain&&(v=this.terrain.getElevationForLngLatZoom(m,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(S,l,m,v)}resize(S,l=!0){const[m,v]=this._containerDimensions(),_=this._getClampedPixelRatio(m,v);if(this._resizeCanvas(m,v,_),this.painter.resize(m,v,_),this.painter.overLimit()){const I=this.painter.context.gl;this._maxCanvasSize=[I.drawingBufferWidth,I.drawingBufferHeight];const z=this._getClampedPixelRatio(m,v);this._resizeCanvas(m,v,z),this.painter.resize(m,v,z)}this._resizeTransform(l);const P=!this._moving;return P&&(this.stop(),this.fire(new i.l("movestart",S)).fire(new i.l("move",S))),this.fire(new i.l("resize",S)),P&&this.fire(new i.l("moveend",S)),this}_resizeTransform(S=!0){var l;const[m,v]=this._containerDimensions();this.transform.resize(m,v,S),(l=this._requestedCameraState)===null||l===void 0||l.resize(m,v,S)}_getClampedPixelRatio(S,l){const{0:m,1:v}=this._maxCanvasSize,_=this.getPixelRatio(),P=S*_,I=l*_;return Math.min(P>m?m/P:1,I>v?v/I:1)*_}getPixelRatio(){var S;return(S=this._overridePixelRatio)!==null&&S!==void 0?S:devicePixelRatio}setPixelRatio(S){this._overridePixelRatio=S,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(S){return this.transform.setMaxBounds(Dr.convert(S)),this._update()}setMinZoom(S){if((S=S??-2)>=-2&&S<=this.transform.maxZoom)return this.transform.setMinZoom(S),this._update(),this.getZoom()<S&&this.setZoom(S),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(S){if((S=S??22)>=this.transform.minZoom)return this.transform.setMaxZoom(S),this._update(),this.getZoom()>S&&this.setZoom(S),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(S){if((S=S??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(S>=0&&S<=this.transform.maxPitch)return this.transform.setMinPitch(S),this._update(),this.getPitch()<S&&this.setPitch(S),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(S){if((S=S??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(S>=this.transform.minPitch)return this.transform.setMaxPitch(S),this._update(),this.getPitch()>S&&this.setPitch(S),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(S){return this.transform.setRenderWorldCopies(S),this._update()}setTransformConstrain(S){return this.transform.setConstrain(S),this._update()}project(S){return this.transform.locationToScreenPoint(i.U.convert(S),this.style&&this.terrain)}unproject(S){return this.transform.screenPointToLocation(i.P.convert(S),this.terrain)}isMoving(){var S;return this._moving||((S=this.handlers)===null||S===void 0?void 0:S.isMoving())}isZooming(){var S;return this._zooming||((S=this.handlers)===null||S===void 0?void 0:S.isZooming())}isRotating(){var S;return this._rotating||((S=this.handlers)===null||S===void 0?void 0:S.isRotating())}_createDelegatedListener(S,l,m){if(S==="mouseenter"||S==="mouseover"){let v=!1;return{layers:l,listener:m,delegates:{mousemove:P=>{const I=l.filter(q=>this.getLayer(q)),z=I.length!==0?this.queryRenderedFeatures(P.point,{layers:I}):[];z.length?v||(v=!0,m.call(this,new Ji(S,this,P.originalEvent,{features:z}))):v=!1},mouseout:()=>{v=!1}}}}if(S==="mouseleave"||S==="mouseout"){let v=!1;return{layers:l,listener:m,delegates:{mousemove:I=>{const z=l.filter(q=>this.getLayer(q));(z.length!==0?this.queryRenderedFeatures(I.point,{layers:z}):[]).length?v=!0:v&&(v=!1,m.call(this,new Ji(S,this,I.originalEvent)))},mouseout:I=>{v&&(v=!1,m.call(this,new Ji(S,this,I.originalEvent)))}}}}{const v=_=>{const P=l.filter(z=>this.getLayer(z)),I=P.length!==0?this.queryRenderedFeatures(_.point,{layers:P}):[];I.length&&(_.features=I,m.call(this,_),delete _.features)};return{layers:l,listener:m,delegates:{[S]:v}}}}_saveDelegatedListener(S,l){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[S]=this._delegatedListeners[S]||[],this._delegatedListeners[S].push(l)}_removeDelegatedListener(S,l,m){if(!this._delegatedListeners||!this._delegatedListeners[S])return;const v=this._delegatedListeners[S];for(let _=0;_<v.length;_++){const P=v[_];if(P.listener===m&&P.layers.length===l.length&&P.layers.every(I=>l.includes(I))){for(const I in P.delegates)this.off(I,P.delegates[I]);return void v.splice(_,1)}}}on(S,l,m){if(m===void 0)return super.on(S,l);const v=typeof l=="string"?[l]:l,_=this._createDelegatedListener(S,v,m);this._saveDelegatedListener(S,_);for(const P in _.delegates)this.on(P,_.delegates[P]);return{unsubscribe:()=>{this._removeDelegatedListener(S,v,m)}}}once(S,l,m){if(m===void 0)return super.once(S,l);const v=typeof l=="string"?[l]:l,_=this._createDelegatedListener(S,v,m);for(const P in _.delegates){const I=_.delegates[P];_.delegates[P]=(...z)=>{this._removeDelegatedListener(S,v,m),I(...z)}}this._saveDelegatedListener(S,_);for(const P in _.delegates)this.once(P,_.delegates[P]);return this}off(S,l,m){return m===void 0?super.off(S,l):(this._removeDelegatedListener(S,typeof l=="string"?[l]:l,m),this)}queryRenderedFeatures(S,l){if(!this.style)return[];let m;const v=S instanceof i.P||Array.isArray(S),_=v?S:[[0,0],[this.transform.width,this.transform.height]];if(l=l||(v?{}:S)||{},_ instanceof i.P||typeof _[0]=="number")m=[i.P.convert(_)];else{const P=i.P.convert(_[0]),I=i.P.convert(_[1]);m=[P,new i.P(I.x,P.y),I,new i.P(P.x,I.y),P]}return this.style.queryRenderedFeatures(m,l,this.transform)}querySourceFeatures(S,l){return this.style.querySourceFeatures(S,l)}setStyle(S,l){return(l=i.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&S?(this._diffStyle(S,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._updateStyle(S,l))}setTransformRequest(S){return this._requestManager.setTransformRequest(S),this}_getUIString(S){const l=this._locale[S];if(l==null)throw new Error(`Missing UI string '${S}'`);return l}_updateStyle(S,l){var m,v;if(l.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(S,l));const _=this.style&&l.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!S)),S?(this.style=new lf(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof S=="string"?this.style.loadURL(S,l,_):this.style.loadJSON(S,l,_),this):((v=(m=this.style)===null||m===void 0?void 0:m.projection)===null||v===void 0||v.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new lf(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(S,l){if(typeof S=="string"){const m=this._requestManager.transformRequest(S,"Style");i.j(m,new AbortController).then(v=>{this._updateDiff(v.data,l)}).catch(v=>{v&&this.fire(new i.k(v))})}else typeof S=="object"&&this._updateDiff(S,l)}_updateDiff(S,l){try{this.style.setState(S,l)&&this._update(!0)}catch(m){i.w(`Unable to perform style diff: ${m.message||m.error||m}.  Rebuilding the style from scratch.`),this._updateStyle(S,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():i.w("There is no style added to the map.")}addSource(S,l){return this._lazyInitEmptyStyle(),this.style.addSource(S,l),this._update(!0)}isSourceLoaded(S){const l=this.style&&this.style.tileManagers[S];if(l!==void 0)return l.loaded();this.fire(new i.k(new Error(`There is no tile manager with ID '${S}'`)))}setTerrain(S){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),S){const l=this.style.tileManagers[S.source];if(!l)throw new Error(`cannot load terrain, because there exists no source with ID: ${S.source}`);this.terrain===null&&l.reload();for(const m in this.style._layers){const v=this.style._layers[m];v.type==="hillshade"&&v.source===S.source&&i.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),v.type==="color-relief"&&v.source===S.source&&i.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new dk(this.painter,l,S),this.painter.renderToTexture=new On(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=m=>{var v;m.dataType==="style"?this.terrain.tileManager.freeRtt():m.dataType==="source"&&m.tile&&(m.sourceId!==S.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((v=m.source)===null||v===void 0?void 0:v.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(m.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new i.l("terrain",{terrain:S})),this}getTerrain(){var S,l;return(l=(S=this.terrain)===null||S===void 0?void 0:S.options)!==null&&l!==void 0?l:null}areTilesLoaded(){const S=this.style&&this.style.tileManagers;for(const l in S){const m=S[l]._tiles;for(const v in m){const _=m[v];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}removeSource(S){return this.style.removeSource(S),this._update(!0)}getSource(S){return this.style.getSource(S)}setSourceTileLodParams(S,l,m){if(m){const v=this.getSource(m);if(!v)throw new Error(`There is no source with ID "${m}", cannot set LOD parameters`);v.calculateTileZoom=tr(Math.max(1,S),Math.max(1,l))}else for(const v in this.style.tileManagers)this.style.tileManagers[v].getSource().calculateTileZoom=tr(Math.max(1,S),Math.max(1,l));return this._update(!0),this}refreshTiles(S,l){const m=this.style.tileManagers[S];if(!m)throw new Error(`There is no tile manager with ID "${S}", cannot refresh tile`);l===void 0?m.reload(!0):m.refreshTiles(l.map(v=>new i.a8(v.z,v.x,v.y)))}addImage(S,l,m={}){const{pixelRatio:v=1,sdf:_=!1,stretchX:P,stretchY:I,content:z,textFitWidth:q,textFitHeight:G}=m;if(this._lazyInitEmptyStyle(),!(l instanceof HTMLImageElement||i.b(l))){if(l.width===void 0||l.height===void 0)return this.fire(new i.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:Y,height:le,data:ie}=l,fe=l;return this.style.addImage(S,{data:new i.R({width:Y,height:le},new Uint8Array(ie)),pixelRatio:v,stretchX:P,stretchY:I,content:z,textFitWidth:q,textFitHeight:G,sdf:_,version:0,userImage:fe}),fe.onAdd&&fe.onAdd(this,S),this}}{const{width:Y,height:le,data:ie}=b.getImageData(l);this.style.addImage(S,{data:new i.R({width:Y,height:le},ie),pixelRatio:v,stretchX:P,stretchY:I,content:z,textFitWidth:q,textFitHeight:G,sdf:_,version:0})}}updateImage(S,l){const m=this.style.getImage(S);if(!m)return this.fire(new i.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const v=l instanceof HTMLImageElement||i.b(l)?b.getImageData(l):l,{width:_,height:P,data:I}=v;if(_===void 0||P===void 0)return this.fire(new i.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==m.data.width||P!==m.data.height)return this.fire(new i.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const z=!(l instanceof HTMLImageElement||i.b(l));return m.data.replace(I,z),this.style.updateImage(S,m),this}getImage(S){return this.style.getImage(S)}hasImage(S){return S?!!this.style.getImage(S):(this.fire(new i.k(new Error("Missing required image id"))),!1)}removeImage(S){this.style.removeImage(S)}loadImage(S){return B.getImage(this._requestManager.transformRequest(S,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(S,l){return this._lazyInitEmptyStyle(),this.style.addLayer(S,l),this._update(!0)}moveLayer(S,l){return this.style.moveLayer(S,l),this._update(!0)}removeLayer(S){return this.style.removeLayer(S),this._update(!0)}getLayer(S){return this.style.getLayer(S)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(S,l,m){return this.style.setLayerZoomRange(S,l,m),this._update(!0)}setFilter(S,l,m={}){return this.style.setFilter(S,l,m),this._update(!0)}getFilter(S){return this.style.getFilter(S)}setPaintProperty(S,l,m,v={}){return this.style.setPaintProperty(S,l,m,v),this._update(!0)}getPaintProperty(S,l){return this.style.getPaintProperty(S,l)}setLayoutProperty(S,l,m,v={}){return this.style.setLayoutProperty(S,l,m,v),this._update(!0)}getLayoutProperty(S,l){return this.style.getLayoutProperty(S,l)}setGlyphs(S,l={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(S,l),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(S,l,m={}){return this._lazyInitEmptyStyle(),this.style.addSprite(S,l,m,v=>{v||this._update(!0)}),this}removeSprite(S){return this._lazyInitEmptyStyle(),this.style.removeSprite(S),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(S,l={}){return this._lazyInitEmptyStyle(),this.style.setSprite(S,l,m=>{m||this._update(!0)}),this}setLight(S,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(S,l),this._update(!0)}getLight(){return this.style.getLight()}setSky(S,l={}){return this._lazyInitEmptyStyle(),this.style.setSky(S,l),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(S,l){return this.style.setFeatureState(S,l),this._update()}removeFeatureState(S,l){return this.style.removeFeatureState(S,l),this._update()}getFeatureState(S){return this.style.getFeatureState(S)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let S=0,l=0;return this._container&&(S=this._container.clientWidth||400,l=this._container.clientHeight||300),[S,l]}_setupContainer(){const S=this._container;S.classList.add("maplibregl-map");const l=this._canvasContainer=N.create("div","maplibregl-canvas-container",S);this._interactive&&l.classList.add("maplibregl-interactive"),this._canvas=N.create("canvas","maplibregl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const m=this._containerDimensions(),v=this._getClampedPixelRatio(m[0],m[1]);this._resizeCanvas(m[0],m[1],v);const _=this._controlContainer=N.create("div","maplibregl-control-container",S),P=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(I=>{P[I]=N.create("div",`maplibregl-ctrl-${I} `,_)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(S,l,m){this._canvas.width=Math.floor(m*S),this._canvas.height=Math.floor(m*l),this._canvas.style.width=`${S}px`,this._canvas.style.height=`${l}px`}_setupPainter(){const S=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let l=null;this._canvas.addEventListener("webglcontextcreationerror",v=>{l={requestedAttributes:S},v&&(l.statusMessage=v.statusMessage,l.type=v.type)},{once:!0});let m=null;if(m=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,S):this._canvas.getContext("webgl2",S)||this._canvas.getContext("webgl",S),!m){const v="Failed to initialize WebGL";throw l?(l.message=v,new Error(JSON.stringify(l))):new Error(v)}this.painter=new Bw(m,this.transform),M.testSupport(m)}migrateProjection(S,l){super.migrateProjection(S,l),this.painter.transform=S,this.fire(new i.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(S){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||S,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(S){return this._update(),this._renderTaskQueue.add(S)}_cancelRenderFrame(S){this._renderTaskQueue.remove(S)}_render(S){var l,m,v,_,P;const I=this._idleTriggered?this._fadeDuration:0,z=((l=this.style.projection)===null||l===void 0?void 0:l.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(S),this._removed)return;let q=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const le=this.transform.zoom,ie=T();this.style.zoomHistory.update(le,ie);const fe=new i.G(le,{now:ie,fadeDuration:I,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),_e=fe.crossFadingFactor();_e===1&&_e===this._crossFadingFactor||(q=!0,this._crossFadingFactor=_e),this.style.update(fe)}const G=((m=this.style.projection)===null||m===void 0?void 0:m.transitionState)>0!==z;(v=this.style.projection)===null||v===void 0||v.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((_=this.style.projection)===null||_===void 0?void 0:_.transitionState,(P=this.style.projection)===null||P===void 0?void 0:P.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||G)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,I,this._crossSourceCollisions,G),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:I,showPadding:this.showPadding}),this.fire(new i.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,i.cz.mark(i.cA.load),this.fire(new i.l("load"))),this.style&&(this.style.hasTransitions()||q)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const Y=this._sourcesDirty||this._styleDirty||this._placementDirty;return Y||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new i.l("idle")),!this._loaded||this._fullyLoaded||Y||(this._fullyLoaded=!0,i.cz.mark(i.cA.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var S;this._hash&&this._hash.remove();for(const m of this._controls)m.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),B.removeThrottleControl(this._imageQueueHandle),(S=this._resizeObserver)===null||S===void 0||S.disconnect();const l=this.painter.context.gl.getExtension("WEBGL_lose_context");l!=null&&l.loseContext&&l.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),N.remove(this._canvasContainer),N.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),i.cz.clearMetrics(),this._removed=!0,this.fire(new i.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,b.frame(this._frameRequest,S=>{i.cz.frame(S),this._frameRequest=null;try{this._render(S)}catch(l){if(!i.cB(l)&&!function(m){return m.message===Ow}(l))throw l}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(S){this._showTileBoundaries!==S&&(this._showTileBoundaries=S,this._update())}get showPadding(){return!!this._showPadding}set showPadding(S){this._showPadding!==S&&(this._showPadding=S,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(S){this._showCollisionBoxes!==S&&(this._showCollisionBoxes=S,S?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(S){this._showOverdrawInspector!==S&&(this._showOverdrawInspector=S,this._update())}get repaint(){return!!this._repaint}set repaint(S){this._repaint!==S&&(this._repaint=S,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(S){this._vertices=S,this._update()}get version(){return l1}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(S){return this._lazyInitEmptyStyle(),this.style.setProjection(S),this._update(!0)}},c.MapMouseEvent=Ji,c.MapTouchEvent=Di,c.MapWheelEvent=Kw,c.Marker=Nf,c.NavigationControl=class{constructor(S){this._updateZoomButtons=()=>{const l=this._map.getZoom(),m=l===this._map.getMaxZoom(),v=l===this._map.getMinZoom();this._zoomInButton.disabled=m,this._zoomOutButton.disabled=v,this._zoomInButton.setAttribute("aria-disabled",m.toString()),this._zoomOutButton.setAttribute("aria-disabled",v.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(l,m)=>{const v=this._map._getUIString(`NavigationControl.${m}`);l.title=v,l.setAttribute("aria-label",v)},this.options=i.e({},Px,S),this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",l=>this._map.zoomIn({},{originalEvent:l})),N.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",l=>this._map.zoomOut({},{originalEvent:l})),N.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",l=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:l}):this._map.resetNorth({},{originalEvent:l})}),this._compassIcon=N.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(S){return this._map=S,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new kj(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){N.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(S,l){const m=N.create("button",S,this._container);return m.type="button",m.addEventListener("click",l),m}},c.Popup=class extends i.E{constructor(S){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&N.remove(this._content),this._container&&(N.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new i.l("close"))),this),this._onMouseUp=l=>{this._update(l.point)},this._onMouseMove=l=>{this._update(l.point)},this._onDrag=l=>{this._update(l.point)},this._update=l=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=N.create("div","maplibregl-popup",this._map.getContainer()),this._tip=N.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const I of this.options.className.split(" "))this._container.classList.add(I);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=kx(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!l)return;const m=this._flatPos=this._pos=this._trackPointer&&l?l:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&l?l:this._map.transform.locationToScreenPoint(this._lngLat));let v=this.options.anchor;const _=Mx(this.options.offset);if(!v){const I=this._container.offsetWidth,z=this._container.offsetHeight;let q;q=m.y+_.bottom.y<z?["top"]:m.y>this._map.transform.height-z?["bottom"]:[],m.x<I/2?q.push("left"):m.x>this._map.transform.width-I/2&&q.push("right"),v=q.length===0?"bottom":q.join("-")}let P=m.add(_[v]);this.options.subpixelPositioning||(P=P.round()),N.setTransform(this._container,`${nu[v]} translate(${P.x}px,${P.y}px)`),Ax(this._container,v,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=i.e(Object.create(Ej),S)}addTo(S){return this._map&&this.remove(),this._map=S,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new i.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(S){return this._lngLat=i.U.convert(S),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(S){return this.setDOMContent(document.createTextNode(S))}setHTML(S){const l=document.createDocumentFragment(),m=document.createElement("body");let v;for(m.innerHTML=S;v=m.firstChild,v;)l.appendChild(v);return this.setDOMContent(l)}getMaxWidth(){var S;return(S=this._container)===null||S===void 0?void 0:S.style.maxWidth}setMaxWidth(S){return this.options.maxWidth=S,this._update(),this}setDOMContent(S){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=N.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(S),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(S){return this._container&&this._container.classList.add(S),this}removeClassName(S){return this._container&&this._container.classList.remove(S),this}setOffset(S){return this.options.offset=S,this._update(),this}toggleClassName(S){if(this._container)return this._container.classList.toggle(S)}setSubpixelPositioning(S){this.options.subpixelPositioning=S}_createCloseButton(){this.options.closeButton&&(this._closeButton=N.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const S=this._container.querySelector(Ex);S&&S.focus()}},c.RasterDEMTileSource=De,c.RasterTileSource=Qs,c.ScaleControl=class{constructor(S){this._onMove=()=>{Tx(this._map,this._container,this.options)},this.setUnit=l=>{this.options.unit=l,Tx(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Tj),S)}getDefaultPosition(){return"bottom-left"}onAdd(S){return this._map=S,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-scale",S.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){N.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},c.ScrollZoomHandler=s1,c.Style=lf,c.TerrainControl=class{constructor(S){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=S}onAdd(S){return this._map=S,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=N.create("button","maplibregl-ctrl-terrain",this._container),N.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){N.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},c.TwoFingersTouchPitchHandler=e1,c.TwoFingersTouchRotateHandler=Sx,c.TwoFingersTouchZoomHandler=Jw,c.TwoFingersTouchZoomRotateHandler=a1,c.VectorTileSource=xn,c.VideoSource=Bt,c.addSourceType=(S,l)=>i._(void 0,void 0,void 0,function*(){if(Ss(S))throw new Error(`A source type called "${S}" already exists.`);((m,v)=>{Qr[m]=v})(S,l)}),c.clearPrewarmedResources=function(){const S=Vt;S&&(S.isPreloaded()&&S.numActive()===1?(S.release(yt),Vt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},c.createTileMesh=tf,c.getMaxParallelImageRequests=function(){return i.a.MAX_PARALLEL_IMAGE_REQUESTS},c.getRTLTextPluginStatus=function(){return ve().getRTLTextPluginStatus()},c.getVersion=function(){return Mj},c.getWorkerCount=function(){return Et.workerCount},c.getWorkerUrl=function(){return i.a.WORKER_URL},c.importScriptInWorkers=function(S){return Ht().broadcast("IS",S)},c.isTimeFrozen=function(){return w.isFrozen()},c.now=T,c.prewarm=function(){ur().acquire(yt)},c.restoreNow=function(){w.restoreNow()},c.setMaxParallelImageRequests=function(S){i.a.MAX_PARALLEL_IMAGE_REQUESTS=S},c.setNow=function(S){w.setNow(S)},c.setRTLTextPlugin=function(S,l){return ve().setRTLTextPlugin(S,l)},c.setWorkerCount=function(S){Et.workerCount=S},c.setWorkerUrl=function(S){i.a.WORKER_URL=S}});var o=s;return o})})(SG);var PG=SG.exports;const $l=tn(PG),bfe=nq({__proto__:null,default:$l},[PG]);function _fe({shapeFile:t,onClose:r}){const s=A.useRef(null),n=A.useRef(null),[a,o]=A.useState(!0),[c,i]=A.useState(null);return A.useEffect(()=>{if(s.current)return n.current=new $l.Map({container:s.current,style:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",center:[41,4],zoom:6}),n.current.addControl(new $l.NavigationControl,"top-right"),n.current.on("load",async()=>{try{const f=await fetch(`/api/v1/gis/shape-files/${t.id}/geojson`),p=await f.json();if(!f.ok)throw new Error(p.error||"Failed to load GeoJSON");const g=p;n.current&&g.data&&(n.current.addSource("shapefile",{type:"geojson",data:g.data}),n.current.addLayer({id:"shapefile-fill",type:"fill",source:"shapefile",paint:{"fill-color":"#3b82f6","fill-opacity":.3},filter:["==","$type","Polygon"]}),n.current.addLayer({id:"shapefile-outline",type:"line",source:"shapefile",paint:{"line-color":"#1e40af","line-width":2},filter:["==","$type","Polygon"]}),n.current.addLayer({id:"shapefile-line",type:"line",source:"shapefile",paint:{"line-color":"#1e40af","line-width":2},filter:["==","$type","LineString"]}),n.current.addLayer({id:"shapefile-point",type:"circle",source:"shapefile",paint:{"circle-radius":6,"circle-color":"#3b82f6","circle-stroke-width":2,"circle-stroke-color":"#1e40af"},filter:["==","$type","Point"]}),g.bounds&&n.current.fitBounds([[g.bounds.minX,g.bounds.minY],[g.bounds.maxX,g.bounds.maxY]],{padding:50})),o(!1)}catch(f){i(f.message),o(!1)}}),()=>{var f;(f=n.current)==null||f.remove()}},[t.id]),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(cv,{className:"w-4 h-4"}),e.jsxs("span",{children:[t.feature_count," features"]}),e.jsx("span",{children:""}),e.jsx("span",{children:t.geom_type}),e.jsx("span",{children:""}),e.jsx("span",{children:t.projection_crs})]}),e.jsxs("div",{className:"relative h-[400px] rounded-lg overflow-hidden border",children:[a&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100 z-10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-600 border-t-transparent"}),e.jsx("span",{children:"Loading map data..."})]})}),c&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-red-50 z-10",children:e.jsx("p",{className:"text-red-600",children:c})}),e.jsx("div",{ref:s,className:"w-full h-full"})]}),e.jsx("div",{className:"flex justify-end gap-2",children:e.jsx(K,{variant:"outline",onClick:r,children:"Close"})})]})}function wfe(){const[t,r]=A.useState(!1),[s,n]=A.useState(null),[a,o]=A.useState({name:"",description:""}),[c,i]=A.useState(0),[f,p]=A.useState(!1),[g,y]=A.useState(null),b=yr(),{data:w=[],isLoading:T,refetch:N}=it({queryKey:["shape-files"],queryFn:async()=>(await pe.get("/gis/shape-files")).data||[]}),M=async B=>new Promise((U,te)=>{const Q=new XMLHttpRequest,re=new FormData;re.append("file",B),re.append("name",a.name||B.name),re.append("description",a.description),Q.upload.addEventListener("progress",Z=>{if(Z.lengthComputable){const ne=Math.round(Z.loaded/Z.total*100);i(ne)}}),Q.addEventListener("load",()=>{if(Q.status>=200&&Q.status<300)try{const Z=JSON.parse(Q.responseText);U(Z)}catch{U({success:!0})}else te(new Error(`Upload failed with status ${Q.status}`))}),Q.addEventListener("error",()=>{te(new Error("Upload failed"))}),Q.open("POST","/api/v1/gis/shape-files"),Q.send(re)}),O=gt({mutationFn:async B=>(p(!0),i(0),M(B)),onSuccess:B=>{p(!1),i(100),b.invalidateQueries({queryKey:["shape-files"]}),Me.success("Shapefile Uploaded Successfully",{description:`"${a.name}" has been uploaded and is being processed.`,duration:5e3}),setTimeout(()=>{r(!1),n(null),o({name:"",description:""}),i(0)},500)},onError:B=>{p(!1),i(0),Me.error("Upload Failed",{description:B.message||"Failed to upload shapefile. Please try again.",duration:5e3})}}),C=gt({mutationFn:async B=>{await pe.delete(`/gis/shape-files/${B}`)},onSuccess:()=>{b.invalidateQueries({queryKey:["shape-files"]})}}),D=()=>{s&&a.name&&O.mutate(s)},L=B=>{const U={uploading:"bg-yellow-100 text-yellow-800",processing:"bg-blue-100 text-blue-800",processed:"bg-green-100 text-green-800",failed:"bg-red-100 text-red-800"};return e.jsx(Ae,{className:U[B],children:B})},F=B=>{if(B===0)return"0 Bytes";const U=1024,te=["Bytes","KB","MB","GB"],Q=Math.floor(Math.log(B)/Math.log(U));return Math.round(B/Math.pow(U,Q)*100)/100+" "+te[Q]};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Shape Files & Vector Layers"}),e.jsxs(Qt,{open:t,onOpenChange:r,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Bo,{className:"w-4 h-4"}),"Upload Shape File"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Upload Shape File"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(we,{children:"Select File"}),e.jsx(Ie,{type:"file",accept:".zip,.shp,.geojson,.json",onChange:B=>{var U;return n(((U=B.target.files)==null?void 0:U[0])||null)},className:"mt-1",disabled:f}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Supported: ZIP (Shapefile), GeoJSON"})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Name"}),e.jsx(Ie,{value:a.name,onChange:B=>o({...a,name:B.target.value}),placeholder:"e.g., Water Supply Zones",disabled:f})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Description"}),e.jsx(ws,{value:a.description,onChange:B=>o({...a,description:B.target.value}),placeholder:"Optional description",rows:3,disabled:f})]}),f&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Uploading..."}),e.jsxs("span",{className:"font-medium text-blue-600",children:[c,"%"]})]}),e.jsx(Wi,{value:c,className:"h-2"}),c===100&&e.jsxs("p",{className:"text-sm text-green-600 flex items-center gap-1",children:[e.jsx(Zl,{className:"w-4 h-4"}),"Upload complete! Processing file..."]})]}),e.jsx(K,{onClick:D,disabled:!s||!a.name||f,className:"w-full",children:f?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Uploading... ",c,"%"]}):"Upload"})]})]})]})]}),T?e.jsx("p",{className:"text-gray-500",children:"Loading files..."}):w.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No shape files uploaded yet"}):e.jsx("div",{className:"grid gap-4",children:w.map(B=>e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(he,{className:"text-base",children:B.name}),B.description&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:B.description})]}),L(B.status)]})}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Type"}),e.jsx("p",{className:"font-medium",children:B.geom_type})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Features"}),e.jsx("p",{className:"font-medium",children:B.feature_count})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Size"}),e.jsx("p",{className:"font-medium",children:F(B.file_size)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Projection"}),e.jsx("p",{className:"font-medium",children:B.projection_crs})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-gray-500",children:"Uploaded by"}),e.jsx("p",{className:"font-medium",children:B.uploaded_by.name})]})]}),e.jsxs("div",{className:"flex gap-2",children:[B.status==="processed"&&e.jsxs(e.Fragment,{children:[e.jsxs(K,{size:"sm",variant:"outline",className:"gap-2",onClick:()=>y(B),children:[e.jsx(mo,{className:"w-4 h-4"}),"Preview"]}),e.jsxs(K,{size:"sm",variant:"outline",className:"gap-2",onClick:()=>{window.open(`/api/v1/gis/shape-files/${B.id}/download`,"_blank")},children:[e.jsx(ma,{className:"w-4 h-4"}),"Download"]})]}),e.jsx(K,{size:"sm",variant:"outline",className:"gap-2 ml-auto text-red-600 hover:text-red-700",onClick:()=>C.mutate(B.id),disabled:C.isPending,children:e.jsx(Ws,{className:"w-4 h-4"})})]})]})]},B.id))}),e.jsx(Qt,{open:!!g,onOpenChange:B=>!B&&y(null),children:e.jsxs(Zt,{className:"max-w-4xl",children:[e.jsxs(Yt,{children:[e.jsxs(Xt,{className:"flex items-center gap-2",children:[e.jsx(jd,{className:"w-5 h-5"}),g==null?void 0:g.name]}),e.jsx(Es,{children:"Preview of the uploaded shapefile boundaries"})]}),g&&e.jsx(_fe,{shapeFile:g,onClose:()=>y(null)})]})})]})}function Nfe(){return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Files & Layers"}),e.jsx("p",{className:"text-gray-600",children:"Manage shape files, GeoJSON files, and vector layers"})]}),e.jsx(wfe,{})]})}function Sfe(){return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"GIS Settings"}),e.jsx("p",{className:"text-gray-600",children:"Configure GIS module settings and defaults"})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Configuration"})}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Default Projection"}),e.jsx("p",{className:"text-sm text-gray-600",children:"EPSG:4326 (WGS84 - Latitude/Longitude)"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Supported Formats"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:" Shapefile (.zip containing .shp, .shx, .dbf)"}),e.jsx("li",{children:" GeoJSON (.geojson, .json)"}),e.jsx("li",{children:" GeoPackage (.gpkg)"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Maximum File Size"}),e.jsx("p",{className:"text-sm text-gray-600",children:"100 MB per file"})]})]})})]})]})}function Cfe(){return e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx(Ti,{}),e.jsx("main",{className:"flex-1 p-8 overflow-auto",children:e.jsx(Ai,{})})]})}function Pfe(){const[t,r]=A.useState(""),{data:s,isLoading:n,isError:a,error:o}=it({queryKey:["audit","recent"],queryFn:()=>pe.get("/security/audit")}),i=((s==null?void 0:s.audit_events)||[]).filter(y=>{var b,w;return y.action.toLowerCase().includes(t.toLowerCase())||((b=y.diff)==null?void 0:b.email)&&y.diff.email.toLowerCase().includes(t.toLowerCase())||((w=y.entity_type)==null?void 0:w.toLowerCase().includes(t.toLowerCase()))}),f=y=>y.includes("delete")||y.includes("failed")?"destructive":y.includes("create")||y.includes("success")?"default":y.includes("update")||y.includes("edit")?"secondary":"outline",p=y=>y.split(".").map(b=>b.charAt(0).toUpperCase()+b.slice(1)).join(" > "),g=y=>y.entity_type?y.entity_type.split("\\").pop()||y.entity_type:"-";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(bs,{className:"h-8 w-8"}),"Audit Logs"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"View and search system audit trail"})]}),e.jsxs(K,{children:[e.jsx(ma,{className:"h-4 w-4 mr-2"}),"Export"]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search by action or entity...",value:t,onChange:y=>r(y.target.value),className:"pl-10"})]})})}),e.jsx(X,{children:n?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):a?e.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading audit events: ",(o==null?void 0:o.message)||"Unknown error"]}):i.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No audit events found"}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Timestamp"}),e.jsx(se,{children:"Action"}),e.jsx(se,{children:"Entity"}),e.jsx(se,{children:"Details"}),e.jsx(se,{children:"IP Address"})]})}),e.jsx(lr,{children:i.map(y=>{var b,w;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono text-sm",children:new Date(y.occurred_at).toLocaleString()}),e.jsx(J,{children:e.jsx(Ae,{variant:f(y.action),children:p(y.action)})}),e.jsx(J,{className:"text-sm",children:g(y)}),e.jsxs(J,{className:"text-sm max-w-xs truncate",children:[((b=y.diff)==null?void 0:b.email)&&e.jsx("span",{className:"text-muted-foreground",children:y.diff.email}),((w=y.diff)==null?void 0:w.selected_tenant)&&e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",y.diff.selected_tenant,")"]})]}),e.jsx(J,{className:"font-mono text-sm",children:y.ip})]},y.id)})})]})})]})]})}function W5(){const t=yr(),{data:r,isLoading:s,isError:n,error:a}=it({queryKey:["security-alerts","unresolved"],queryFn:()=>pe.get("/security-alerts/unresolved")}),o=gt({mutationFn:p=>pe.post(`/security-alerts/${p}/acknowledge`),onSuccess:()=>{t.invalidateQueries({queryKey:["security-alerts"]}),Me.success("Alert acknowledged")}}),c=gt({mutationFn:({id:p,notes:g})=>pe.post(`/security-alerts/${p}/resolve`,{resolution_notes:g}),onSuccess:()=>{t.invalidateQueries({queryKey:["security-alerts"]}),Me.success("Alert resolved")}}),i=(r==null?void 0:r.alerts)||[],f=p=>{switch(p){case"critical":return"destructive";case"high":return"destructive";case"medium":return"secondary";default:return"outline"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(Fr,{className:"h-8 w-8"}),"Security Alerts"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Monitor and manage security incidents"})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Total Alerts"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:i.length})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Unacknowledged"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:i.filter(p=>!p.acknowledged_at).length})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Critical"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold text-destructive",children:i.filter(p=>p.severity==="critical").length})})]})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:s?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):n?e.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading security alerts: ",(a==null?void 0:a.message)||"Unknown error"]}):i.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No active alerts"}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Detected"}),e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Title"}),e.jsx(se,{children:"Severity"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:i.map(p=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono text-sm",children:new Date(p.detected_at).toLocaleString()}),e.jsx(J,{className:"font-mono text-sm",children:p.alert_type}),e.jsx(J,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:p.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:p.description})]})}),e.jsx(J,{children:e.jsx(Ae,{variant:f(p.severity),children:p.severity})}),e.jsx(J,{children:p.acknowledged_at?e.jsx(Ae,{variant:"outline",children:"Acknowledged"}):e.jsx(Ae,{variant:"secondary",children:"New"})}),e.jsx(J,{children:e.jsxs("div",{className:"flex gap-2",children:[!p.acknowledged_at&&e.jsxs(K,{size:"sm",variant:"outline",onClick:()=>o.mutate(p.id),disabled:o.isPending,children:[e.jsx(Ns,{className:"h-4 w-4 mr-1"}),"Acknowledge"]}),e.jsxs(K,{size:"sm",onClick:()=>c.mutate({id:p.id,notes:"Resolved"}),disabled:c.isPending,children:[e.jsx(ec,{className:"h-4 w-4 mr-1"}),"Resolve"]})]})})]},p.id))})]})})})]})}function kfe(){const{data:t,isLoading:r,isError:s,error:n}=it({queryKey:["roles"],queryFn:()=>pe.get("/rbac/roles")}),a=(t==null?void 0:t.roles)||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(Ds,{className:"h-8 w-8"}),"Roles & Permissions"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage user roles and access permissions"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Create Role"]})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):s?e.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading roles: ",(n==null?void 0:n.message)||"Unknown error"]}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No roles found"}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Role Name"}),e.jsx(se,{children:"Guard"}),e.jsx(se,{children:"Permissions"}),e.jsx(se,{children:"Created"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:a.map(o=>{var c,i,f;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:o.name}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:o.guard_name})}),e.jsx(J,{children:e.jsxs("div",{className:"flex gap-1 flex-wrap",children:[(c=o.permissions)==null?void 0:c.slice(0,3).map(p=>e.jsx(Ae,{variant:"secondary",className:"text-xs",children:p.name},p.id)),(((i=o.permissions)==null?void 0:i.length)||0)>3&&e.jsxs(Ae,{variant:"secondary",className:"text-xs",children:["+",(((f=o.permissions)==null?void 0:f.length)||0)-3," more"]})]})}),e.jsx(J,{className:"font-mono text-sm",children:new Date(o.created_at).toLocaleDateString()}),e.jsx(J,{children:e.jsx(K,{size:"sm",variant:"outline",children:"Edit"})})]},o.id)})})]})})})]})}function G5(){const{data:t,isLoading:r,isError:s,error:n}=it({queryKey:["api-keys"],queryFn:()=>pe.get("/rbac/api-keys")}),a=(t==null?void 0:t.api_keys)||[],o=c=>{switch(c){case"active":return"default";case"expired":return"destructive";case"revoked":return"outline";default:return"outline"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(_S,{className:"h-8 w-8"}),"API Keys"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage API access tokens"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Create API Key"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Total Keys"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:a.length})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Active"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:a.filter(c=>c.status==="active").length})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Expired/Revoked"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:a.filter(c=>c.status!=="active").length})})]})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):s?e.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading API keys: ",(n==null?void 0:n.message)||"Unknown error"]}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No API keys found"}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Name"}),e.jsx(se,{children:"Key Prefix"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Last Used"}),e.jsx(se,{children:"Expires"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:a.map(c=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:c.name}),e.jsxs(J,{className:"font-mono text-sm",children:[c.key_prefix,"..."]}),e.jsx(J,{children:e.jsx(Ae,{variant:o(c.status),children:c.status})}),e.jsx(J,{className:"font-mono text-sm",children:c.last_used_at?new Date(c.last_used_at).toLocaleDateString():"Never"}),e.jsx(J,{className:"font-mono text-sm",children:c.expires_at?new Date(c.expires_at).toLocaleDateString():"Never"}),e.jsx(J,{children:e.jsxs(K,{size:"sm",variant:"outline",children:[e.jsx(Ws,{className:"h-4 w-4 mr-1"}),"Revoke"]})})]},c.id))})]})})})]})}function Afe(){const{data:t,isLoading:r,isError:s,error:n}=it({queryKey:["dsr","pending"],queryFn:()=>pe.get("/dsr/pending")}),a=(t==null?void 0:t.dsr_requests)||[],o=c=>{switch(c){case"completed":return"default";case"pending":return"secondary";case"rejected":return"destructive";default:return"outline"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(Bi,{className:"h-8 w-8"}),"Data Subject Requests"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Process GDPR data subject access, deletion, and rectification requests"})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Pending"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:a.filter(c=>c.status==="pending").length})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"This Month"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:a.length})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Avg. Processing Time"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:"2.3d"})})]})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):s?e.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading DSR requests: ",(n==null?void 0:n.message)||"Unknown error"]}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No pending DSR requests"}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Requested"}),e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Processed"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:a.map(c=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono text-sm",children:new Date(c.requested_at).toLocaleString()}),e.jsx(J,{className:"font-medium",children:c.request_type}),e.jsx(J,{children:e.jsx(Ae,{variant:o(c.status),children:c.status})}),e.jsx(J,{className:"font-mono text-sm",children:c.processed_at?new Date(c.processed_at).toLocaleString():"-"}),e.jsx(J,{children:c.status==="pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{size:"sm",variant:"outline",children:[e.jsx(Ns,{className:"h-4 w-4 mr-1"}),"Approve"]}),e.jsxs(K,{size:"sm",variant:"outline",children:[e.jsx(ec,{className:"h-4 w-4 mr-1"}),"Reject"]})]})})]},c.id))})]})})})]})}function Tfe(){const{data:t,isLoading:r,isError:s,error:n}=it({queryKey:["consents","active"],queryFn:()=>pe.get("/consents/active")}),a=(t==null?void 0:t.consents)||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(ka,{className:"h-8 w-8"}),"Consent Management"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Track and manage user consent for data processing"})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Active Consents"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:a.filter(o=>!o.revoked_at).length})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Revoked"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:a.filter(o=>o.revoked_at).length})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Expiring Soon"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:"0"})})]})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):s?e.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading consents: ",(n==null?void 0:n.message)||"Unknown error"]}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No consents found"}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Purpose"}),e.jsx(se,{children:"Given At"}),e.jsx(se,{children:"Expires At"}),e.jsx(se,{children:"Status"})]})}),e.jsx(lr,{children:a.map(o=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:o.purpose}),e.jsx(J,{className:"font-mono text-sm",children:new Date(o.given_at).toLocaleString()}),e.jsx(J,{className:"font-mono text-sm",children:o.expires_at?new Date(o.expires_at).toLocaleString():"Never"}),e.jsx(J,{children:o.revoked_at?e.jsxs(Ae,{variant:"outline",children:[e.jsx(ec,{className:"h-3 w-3 mr-1"}),"Revoked"]}):e.jsxs(Ae,{variant:"default",children:[e.jsx(Ns,{className:"h-3 w-3 mr-1"}),"Active"]})})]},o.id))})]})})})]})}function Efe(){const{data:t,isLoading:r,isError:s,error:n}=it({queryKey:["kms","keys"],queryFn:()=>pe.get("/kms/keys")}),a=(t==null?void 0:t.keys)||[],o=c=>{switch(c){case"active":return"default";case"rotating":return"secondary";case"retired":return"outline";default:return"outline"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(sm,{className:"h-8 w-8"}),"Encryption Key Management"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage encryption keys and rotation policies"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Generate Key"]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Total Keys"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:a.length})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Active"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:a.filter(c=>c.status==="active").length})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Rotating"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:a.filter(c=>c.status==="rotating").length})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Retired"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:a.filter(c=>c.status==="retired").length})})]})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):s?e.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading encryption keys: ",(n==null?void 0:n.message)||"Unknown error"]}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No encryption keys found"}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Key ID"}),e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Algorithm"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Created"}),e.jsx(se,{children:"Last Rotated"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:a.map(c=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono text-sm",children:c.key_id}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:c.key_type})}),e.jsx(J,{className:"font-mono text-sm",children:c.algorithm}),e.jsx(J,{children:e.jsx(Ae,{variant:o(c.status),children:c.status})}),e.jsx(J,{className:"font-mono text-sm",children:new Date(c.created_at).toLocaleDateString()}),e.jsx(J,{className:"font-mono text-sm",children:c.rotated_at?new Date(c.rotated_at).toLocaleDateString():"-"}),e.jsx(J,{children:e.jsxs(K,{size:"sm",variant:"outline",children:[e.jsx(d9,{className:"h-4 w-4 mr-1"}),"Rotate"]})})]},c.id))})]})})})]})}function Mfe(){var o;const{data:t,isLoading:r,isError:s,error:n}=it({queryKey:["retention","policies"],queryFn:()=>pe.get("/retention/policies")}),a=(t==null?void 0:t.policies)||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx($s,{className:"h-8 w-8"}),"Data Retention Policies"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Configure automated data retention and deletion rules"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Create Policy"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Active Policies"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:a.filter(c=>c.is_active).length})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Data Types"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:a.length})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Last Run"})}),e.jsx(X,{children:e.jsx("div",{className:"text-sm font-medium",children:(o=a[0])!=null&&o.last_applied_at?new Date(a[0].last_applied_at).toLocaleDateString():"Never"})})]})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):s?e.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading retention policies: ",(n==null?void 0:n.message)||"Unknown error"]}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No retention policies configured"}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Data Type"}),e.jsx(se,{children:"Retention Period"}),e.jsx(se,{children:"Deletion Method"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Last Applied"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:a.map(c=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:c.data_type}),e.jsxs(J,{children:[c.retention_period_days," days"]}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:c.deletion_method})}),e.jsx(J,{children:c.is_active?e.jsx(Ae,{variant:"default",children:"Active"}):e.jsx(Ae,{variant:"outline",children:"Inactive"})}),e.jsx(J,{className:"font-mono text-sm",children:c.last_applied_at?new Date(c.last_applied_at).toLocaleDateString():"-"}),e.jsx(J,{children:e.jsx(K,{size:"sm",variant:"outline",children:"Edit"})})]},c.id))})]})})})]})}function Ofe(){const{data:t,isLoading:r,isError:s,error:n}=it({queryKey:["data-catalog"],queryFn:()=>pe.get("/data-catalog")}),a=(t==null?void 0:t.catalog)||[],o=a.filter(i=>i.is_pii).length,c=a.filter(i=>i.encryption_required).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(Gn,{className:"h-8 w-8"}),"Data Catalog"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Data classification and compliance inventory"})]})}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Total Fields"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:a.length})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"PII Fields"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:o})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Encrypted"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:c})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm font-medium",children:"Tables"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:new Set(a.map(i=>i.table_name)).size})})]})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:r?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):s?e.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading data catalog: ",(n==null?void 0:n.message)||"Unknown error"]}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No data catalog entries"}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Table"}),e.jsx(se,{children:"Column"}),e.jsx(se,{children:"Classification"}),e.jsx(se,{children:"PII"}),e.jsx(se,{children:"Encryption"}),e.jsx(se,{children:"Retention"})]})}),e.jsx(lr,{children:a.map(i=>e.jsxs(Qe,{children:[e.jsxs(J,{className:"font-mono text-sm",children:[e.jsx(Bi,{className:"h-4 w-4 inline mr-1"}),i.table_name]}),e.jsx(J,{className:"font-mono text-sm",children:i.column_name}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:i.data_class})}),e.jsx(J,{children:i.is_pii?e.jsx(Ae,{variant:"destructive",children:"Yes"}):e.jsx(Ae,{variant:"outline",children:"No"})}),e.jsx(J,{children:i.encryption_required?e.jsx(Ae,{variant:"default",children:"Required"}):e.jsx(Ae,{variant:"outline",children:"Optional"})}),e.jsx(J,{children:i.retention_period_days?`${i.retention_period_days}d`:"-"})]},i.id))})]})})})]})}function Ife(){const t=yr(),[r,s]=A.useState(""),[n,a]=A.useState([]),{data:o,isLoading:c}=it({queryKey:["2fa-status"],queryFn:()=>pe.get("/auth/2fa/status")}),i=gt({mutationFn:()=>pe.post("/auth/2fa/enroll"),onSuccess:()=>{t.invalidateQueries({queryKey:["2fa-status"]}),Me.success("2FA enrollment started")},onError:()=>{Me.error("Failed to start 2FA enrollment")}}),f=gt({mutationFn:w=>pe.post("/auth/2fa/verify",{code:w}),onSuccess:w=>{t.invalidateQueries({queryKey:["2fa-status"]}),t.invalidateQueries({queryKey:["auth-user"]}),a(w.recovery_codes||[]),Me.success("2FA enabled successfully"),s("")},onError:()=>{Me.error("Invalid verification code")}}),p=gt({mutationFn:()=>pe.post("/auth/2fa/disable"),onSuccess:()=>{t.invalidateQueries({queryKey:["2fa-status"]}),t.invalidateQueries({queryKey:["auth-user"]}),a([]),Me.success("2FA disabled")},onError:()=>{Me.error("Failed to disable 2FA")}}),g=()=>{i.mutate()},y=()=>{r.length===6&&f.mutate(r)},b=()=>{confirm("Are you sure you want to disable 2FA? This will reduce your account security.")&&p.mutate()};return e.jsx("div",{className:"container max-w-3xl py-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Two-Factor Authentication"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Add an extra layer of security to your account"})]}),c&&!o?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading 2FA status..."})}):e.jsxs(e.Fragment,{children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[o!=null&&o.enabled?e.jsx(BF,{className:"h-6 w-6 text-green-600"}):e.jsx(ka,{className:"h-6 w-6 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx(he,{children:"Status"}),e.jsx(mr,{children:o!=null&&o.enabled?"Two-factor authentication is enabled":"Two-factor authentication is disabled"})]})]}),(o==null?void 0:o.enabled)&&e.jsx(Ae,{variant:"default",className:"bg-green-600",children:"Enabled"})]})}),e.jsxs(X,{className:"space-y-6",children:[!(o!=null&&o.enabled)&&!(o!=null&&o.qr_code)&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(zn,{children:[e.jsx(Nn,{className:"h-4 w-4"}),e.jsx(An,{children:"Two-factor authentication adds an extra layer of security by requiring a code from your authenticator app in addition to your password."})]}),e.jsx(K,{onClick:g,disabled:i.isPending,children:i.isPending?"Setting up...":"Enable 2FA"})]}),(o==null?void 0:o.qr_code)&&!(o!=null&&o.enabled)&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Step 1: Scan QR Code"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Scan this QR code with your authenticator app (Google Authenticator, Authy, 1Password, etc.)"}),e.jsx("div",{className:"flex justify-center p-4 bg-white rounded-lg",children:e.jsx("img",{src:o.qr_code,alt:"2FA QR Code",className:"w-64 h-64"})})]}),o.secret&&e.jsxs("div",{children:[e.jsx(we,{children:"Manual Entry Code"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"If you can't scan the QR code, enter this code manually:"}),e.jsx("code",{className:"block p-3 bg-muted rounded text-sm font-mono",children:o.secret})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Step 2: Verify Code"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Enter the 6-digit code from your authenticator app to complete setup"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx(Ie,{type:"text",placeholder:"000000",maxLength:6,value:r,onChange:w=>s(w.target.value.replace(/\D/g,"")),onKeyPress:w=>{w.key==="Enter"&&y()}})}),e.jsx(K,{onClick:y,disabled:r.length!==6||f.isPending,children:f.isPending?"Verifying...":"Verify & Enable"})]})]})]}),(o==null?void 0:o.enabled)&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(zn,{className:"border-green-600 bg-green-50",children:[e.jsx(BF,{className:"h-4 w-4 text-green-600"}),e.jsx(An,{className:"text-green-900",children:"Your account is protected with two-factor authentication."})]}),e.jsx(K,{variant:"destructive",onClick:b,disabled:p.isPending,children:p.isPending?"Disabling...":"Disable 2FA"})]})]})]}),(n.length>0||(o==null?void 0:o.recovery_codes)&&o.recovery_codes.length>0)&&e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Recovery Codes"}),e.jsx(mr,{children:"Save these recovery codes in a safe place. You can use them to access your account if you lose your authenticator device."})]}),e.jsxs(X,{children:[e.jsxs(zn,{className:"mb-4",children:[e.jsx(Nn,{className:"h-4 w-4"}),e.jsx(An,{children:n.length>0?"Save these recovery codes now! They will not be shown again.":"Each recovery code can only be used once. Store them securely."})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:(n.length>0?n:(o==null?void 0:o.recovery_codes)||[]).map((w,T)=>e.jsx("code",{className:"block p-2 bg-muted rounded text-sm font-mono",children:w},T))})]})]})]})]})})}function Dfe(){return e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx(Ti,{}),e.jsx("main",{className:"flex-1 p-8 overflow-auto",children:e.jsx(Ai,{})})]})}const no="",_i={getClasses:()=>pe.get(`${no}/asset-classes`),getAssets:t=>{const r={};return t!=null&&t.search&&(r.search=t.search),t!=null&&t.status&&(r.status=t.status),t!=null&&t.class_id&&(r.class_id=t.class_id.toString()),t!=null&&t.scheme_id&&(r.scheme_id=t.scheme_id),t!=null&&t.dma_id&&(r.dma_id=t.dma_id),t!=null&&t.parent_id&&(r.parent_id=t.parent_id.toString()),t!=null&&t.per_page&&(r.per_page=t.per_page.toString()),t!=null&&t.page&&(r.page=t.page.toString()),pe.get(`${no}/assets`,r)},getAsset:t=>pe.get(`${no}/assets/${t}`),createAsset:t=>pe.post(`${no}/assets`,t),updateAsset:(t,r)=>pe.put(`${no}/assets/${t}`,r),deleteAsset:t=>pe.delete(`${no}/assets/${t}`),getAssetMaintenanceHistory:t=>pe.get(`${no}/assets/${t}/maintenance-history`),getAssetLocations:t=>pe.get(`${no}/assets/${t}/locations`),getPmTemplates:t=>{const r={};return(t==null?void 0:t.is_active)!==void 0&&(r.is_active=t.is_active.toString()),t!=null&&t.asset_class_id&&(r.asset_class_id=t.asset_class_id.toString()),t!=null&&t.trigger_type&&(r.trigger_type=t.trigger_type),pe.get(`${no}/cmms/pm/templates`,r)},getPmTemplate:t=>pe.get(`${no}/cmms/pm/templates/${t}`),createPmTemplate:t=>pe.post(`${no}/cmms/pm/templates`,t),updatePmTemplate:(t,r)=>pe.put(`${no}/cmms/pm/templates/${t}`,r),deletePmTemplate:t=>pe.delete(`${no}/cmms/pm/templates/${t}`),generatePmWorkOrders:t=>pe.post(`${no}/cmms/pm/generate`,t?{template_id:t}:{}),deferPm:(t,r)=>pe.post(`${no}/cmms/pm/logs/${t}/defer`,r),getPmCompliance:(t,r)=>pe.get(`${no}/cmms/pm/compliance`,{period_start:t,period_end:r})},Ba="",cp={getWorkOrders:t=>{const r={};return t!=null&&t.search&&(r.search=t.search),t!=null&&t.status&&(r.status=t.status),t!=null&&t.kind&&(r.kind=t.kind),t!=null&&t.priority&&(r.priority=t.priority),t!=null&&t.asset_id&&(r.asset_id=t.asset_id.toString()),t!=null&&t.assigned_to&&(r.assigned_to=t.assigned_to),t!=null&&t.per_page&&(r.per_page=t.per_page.toString()),t!=null&&t.page&&(r.page=t.page.toString()),pe.get(`${Ba}/work-orders`,r)},getWorkOrder:t=>pe.get(`${Ba}/work-orders/${t}`),createWorkOrder:t=>pe.post(`${Ba}/work-orders`,t),updateWorkOrder:(t,r)=>pe.put(`${Ba}/work-orders/${t}`,r),deleteWorkOrder:t=>pe.delete(`${Ba}/work-orders/${t}`),addParts:(t,r)=>pe.post(`${Ba}/work-orders/${t}/parts`,r),addLabor:(t,r)=>pe.post(`${Ba}/work-orders/${t}/labor`,r),assignWorkOrder:(t,r)=>pe.post(`${Ba}/work-orders/${t}/assign`,{user_id:r}),startWorkOrder:t=>pe.post(`${Ba}/work-orders/${t}/start`),completeWorkOrder:(t,r)=>pe.post(`${Ba}/work-orders/${t}/complete`,r),cancelWorkOrder:(t,r)=>pe.post(`${Ba}/work-orders/${t}/cancel`,{notes:r}),approveWorkOrder:(t,r)=>pe.post(`${Ba}/work-orders/${t}/approve`,{notes:r}),qaWorkOrder:(t,r)=>pe.post(`${Ba}/work-orders/${t}/qa`,r),addChecklist:(t,r)=>pe.post(`${Ba}/work-orders/${t}/checklist`,r),updateChecklistItem:(t,r)=>pe.patch(`${Ba}/work-orders/checklist-items/${t}`,r),addAttachment:(t,r)=>pe.post(`${Ba}/work-orders/${t}/attachments`,r),addAssignment:(t,r)=>pe.post(`${Ba}/work-orders/${t}/assignments`,r),addComment:(t,r)=>pe.post(`${Ba}/work-orders/${t}/comments`,r),getOverdue:()=>pe.get(`${Ba}/work-orders/overdue`),getStats:()=>pe.get(`${Ba}/work-orders/stats`),getOperatorSuggestions:t=>{const r={};return t!=null&&t.asset_id&&(r.asset_id=t.asset_id.toString()),t!=null&&t.scheme_id&&(r.scheme_id=t.scheme_id),t!=null&&t.dma_id&&(r.dma_id=t.dma_id),t!=null&&t.scheduled_for&&(r.scheduled_for=t.scheduled_for),pe.get("/cmms/operator-suggestions",r)}},rg="",RS={getParts:t=>{const r={};return t!=null&&t.search&&(r.search=t.search),t!=null&&t.category&&(r.category=t.category),t!=null&&t.supplier_id&&(r.supplier_id=t.supplier_id.toString()),t!=null&&t.per_page&&(r.per_page=t.per_page.toString()),t!=null&&t.page&&(r.page=t.page.toString()),pe.get(`${rg}/parts`,r)},getPart:t=>pe.get(`${rg}/parts/${t}`),createPart:t=>pe.post(`${rg}/parts`,t),updatePart:(t,r)=>pe.put(`${rg}/parts/${t}`,r),deletePart:t=>pe.delete(`${rg}/parts/${t}`),getStockTransactions:t=>{const r=t?{part_id:t.toString()}:{};return pe.get(`${rg}/stock-txns`,r)}};function Rfe(){const{data:t}=it({queryKey:["assets",{per_page:1}],queryFn:()=>_i.getAssets({per_page:1})}),{data:r}=it({queryKey:["work-orders",{per_page:1}],queryFn:()=>cp.getWorkOrders({per_page:1})}),{data:s}=it({queryKey:["work-orders",{status:"open",per_page:1}],queryFn:()=>cp.getWorkOrders({status:"open",per_page:1})}),{data:n}=it({queryKey:["work-orders",{status:"in_progress",per_page:1}],queryFn:()=>cp.getWorkOrders({status:"in_progress",per_page:1})}),{data:a}=it({queryKey:["parts",{per_page:100}],queryFn:()=>RS.getParts({per_page:100})}),o=(a==null?void 0:a.data.filter(i=>{const f=i.stock_balance||0,p=i.reorder_level||0;return f<=p&&f>0}).length)||0,c=(a==null?void 0:a.data.filter(i=>(i.stock_balance||0)===0).length)||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"CMMS Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Overview of assets, maintenance, and inventory"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total Assets"}),e.jsx(Gn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(t==null?void 0:t.total)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Infrastructure and equipment"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total Work Orders"}),e.jsx(T0,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(r==null?void 0:r.total)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All maintenance tasks"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Open Work Orders"}),e.jsx(Fr,{className:"h-4 w-4 text-orange-500"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-500",children:(s==null?void 0:s.total)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pending assignment"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"In Progress"}),e.jsx($s,{className:"h-4 w-4 text-blue-500"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-500",children:(n==null?void 0:n.total)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently being worked on"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total Parts"}),e.jsx(zo,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(a==null?void 0:a.total)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Inventory items"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Low Stock"}),e.jsx(Fr,{className:"h-4 w-4 text-orange-500"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-500",children:o}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Need reordering"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Out of Stock"}),e.jsx(Fr,{className:"h-4 w-4 text-red-500"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-500",children:c}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Urgent action needed"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"System Status"}),e.jsx(Ns,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-500",children:"Online"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All systems operational"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Quick Actions"})}),e.jsxs(X,{className:"space-y-2",children:[e.jsxs("a",{href:"/cmms/work-orders",className:"block p-3 border rounded hover:bg-accent transition-colors",children:[e.jsx("div",{className:"font-medium",children:"Create Work Order"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Schedule maintenance task"})]}),e.jsxs("a",{href:"/cmms/assets",className:"block p-3 border rounded hover:bg-accent transition-colors",children:[e.jsx("div",{className:"font-medium",children:"Add New Asset"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Register infrastructure or equipment"})]}),e.jsxs("a",{href:"/cmms/parts",className:"block p-3 border rounded hover:bg-accent transition-colors",children:[e.jsx("div",{className:"font-medium",children:"Manage Inventory"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Update parts and stock levels"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Recent Activity"})}),e.jsx(X,{children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("p",{children:"System is ready to track your maintenance activities."}),e.jsx("p",{className:"mt-2",children:"Start by adding assets, creating work orders, or managing inventory."})]})})]})]})]})}var z_=t=>t.type==="checkbox",Hf=t=>t instanceof Date,Ro=t=>t==null;const kG=t=>typeof t=="object";var Ka=t=>!Ro(t)&&!Array.isArray(t)&&kG(t)&&!Hf(t),AG=t=>Ka(t)&&t.target?z_(t.target)?t.target.checked:t.target.value:t,Lfe=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,TG=(t,r)=>t.has(Lfe(r)),Ffe=t=>{const r=t.constructor&&t.constructor.prototype;return Ka(r)&&r.hasOwnProperty("isPrototypeOf")},tD=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Un(t){let r;const s=Array.isArray(t),n=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)r=new Date(t);else if(!(tD&&(t instanceof Blob||n))&&(s||Ka(t)))if(r=s?[]:Object.create(Object.getPrototypeOf(t)),!s&&!Ffe(t))r=t;else for(const a in t)t.hasOwnProperty(a)&&(r[a]=Un(t[a]));else return t;return r}var VC=t=>/^\w*$/.test(t),Fn=t=>t===void 0,UC=t=>Array.isArray(t)?t.filter(Boolean):[],rD=t=>UC(t.replace(/["|']|\]/g,"").split(/\.|\[/)),xr=(t,r,s)=>{if(!r||!Ka(t))return s;const n=(VC(r)?[r]:rD(r)).reduce((a,o)=>Ro(a)?a:a[o],t);return Fn(n)||n===t?Fn(t[r])?s:t[r]:n},ul=t=>typeof t=="boolean",rn=(t,r,s)=>{let n=-1;const a=VC(r)?[r]:rD(r),o=a.length,c=o-1;for(;++n<o;){const i=a[n];let f=s;if(n!==c){const p=t[i];f=Ka(p)||Array.isArray(p)?p:isNaN(+a[n+1])?{}:[]}if(i==="__proto__"||i==="constructor"||i==="prototype")return;t[i]=f,t=t[i]}};const LS={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},zl={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},pu={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},sD=je.createContext(null);sD.displayName="HookFormContext";const jv=()=>je.useContext(sD),EG=t=>{const{children:r,...s}=t;return je.createElement(sD.Provider,{value:s},r)};var MG=(t,r,s,n=!0)=>{const a={defaultValues:r._defaultValues};for(const o in t)Object.defineProperty(a,o,{get:()=>{const c=o;return r._proxyFormState[c]!==zl.all&&(r._proxyFormState[c]=!n||zl.all),s&&(s[c]=!0),t[c]}});return a};const WC=typeof window<"u"?je.useLayoutEffect:je.useEffect;function $fe(t){const r=jv(),{control:s=r.control,disabled:n,name:a,exact:o}=t||{},[c,i]=je.useState(s._formState),f=je.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return WC(()=>s._subscribe({name:a,formState:f.current,exact:o,callback:p=>{!n&&i({...s._formState,...p})}}),[a,n,o]),je.useEffect(()=>{f.current.isValid&&s._setValid(!0)},[s]),je.useMemo(()=>MG(c,s,f.current,!1),[c,s])}var fl=t=>typeof t=="string",NM=(t,r,s,n,a)=>fl(t)?(n&&r.watch.add(t),xr(s,t,a)):Array.isArray(t)?t.map(o=>(n&&r.watch.add(o),xr(s,o))):(n&&(r.watchAll=!0),s),SM=t=>Ro(t)||!kG(t);function Lc(t,r,s=new WeakSet){if(SM(t)||SM(r))return Object.is(t,r);if(Hf(t)&&Hf(r))return t.getTime()===r.getTime();const n=Object.keys(t),a=Object.keys(r);if(n.length!==a.length)return!1;if(s.has(t)||s.has(r))return!0;s.add(t),s.add(r);for(const o of n){const c=t[o];if(!a.includes(o))return!1;if(o!=="ref"){const i=r[o];if(Hf(c)&&Hf(i)||Ka(c)&&Ka(i)||Array.isArray(c)&&Array.isArray(i)?!Lc(c,i,s):!Object.is(c,i))return!1}}return!0}function OG(t){const r=jv(),{control:s=r.control,name:n,defaultValue:a,disabled:o,exact:c,compute:i}=t||{},f=je.useRef(a),p=je.useRef(i),g=je.useRef(void 0),y=je.useRef(s),b=je.useRef(n);p.current=i;const[w,T]=je.useState(()=>{const L=s._getWatch(n,f.current);return p.current?p.current(L):L}),N=je.useCallback(L=>{const F=NM(n,s._names,L||s._formValues,!1,f.current);return p.current?p.current(F):F},[s._formValues,s._names,n]),M=je.useCallback(L=>{if(!o){const F=NM(n,s._names,L||s._formValues,!1,f.current);if(p.current){const B=p.current(F);Lc(B,g.current)||(T(B),g.current=B)}else T(F)}},[s._formValues,s._names,o,n]);WC(()=>((y.current!==s||!Lc(b.current,n))&&(y.current=s,b.current=n,M()),s._subscribe({name:n,formState:{values:!0},exact:c,callback:L=>{M(L.values)}})),[s,c,n,M]),je.useEffect(()=>s._removeUnmounted());const O=y.current!==s,C=b.current,D=je.useMemo(()=>{if(o)return null;const L=!O&&!Lc(C,n);return O||L?N():null},[o,O,n,C,N]);return D!==null?D:w}function zfe(t){const r=jv(),{name:s,disabled:n,control:a=r.control,shouldUnregister:o,defaultValue:c}=t,i=TG(a._names.array,s),f=je.useMemo(()=>xr(a._formValues,s,xr(a._defaultValues,s,c)),[a,s,c]),p=OG({control:a,name:s,defaultValue:f,exact:!0}),g=$fe({control:a,name:s,exact:!0}),y=je.useRef(t),b=je.useRef(void 0),w=je.useRef(a.register(s,{...t.rules,value:p,...ul(t.disabled)?{disabled:t.disabled}:{}}));y.current=t;const T=je.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!xr(g.errors,s)},isDirty:{enumerable:!0,get:()=>!!xr(g.dirtyFields,s)},isTouched:{enumerable:!0,get:()=>!!xr(g.touchedFields,s)},isValidating:{enumerable:!0,get:()=>!!xr(g.validatingFields,s)},error:{enumerable:!0,get:()=>xr(g.errors,s)}}),[g,s]),N=je.useCallback(D=>w.current.onChange({target:{value:AG(D),name:s},type:LS.CHANGE}),[s]),M=je.useCallback(()=>w.current.onBlur({target:{value:xr(a._formValues,s),name:s},type:LS.BLUR}),[s,a._formValues]),O=je.useCallback(D=>{const L=xr(a._fields,s);L&&D&&(L._f.ref={focus:()=>D.focus&&D.focus(),select:()=>D.select&&D.select(),setCustomValidity:F=>D.setCustomValidity(F),reportValidity:()=>D.reportValidity()})},[a._fields,s]),C=je.useMemo(()=>({name:s,value:p,...ul(n)||g.disabled?{disabled:g.disabled||n}:{},onChange:N,onBlur:M,ref:O}),[s,n,g.disabled,N,M,O,p]);return je.useEffect(()=>{const D=a._options.shouldUnregister||o,L=b.current;L&&L!==s&&!i&&a.unregister(L),a.register(s,{...y.current.rules,...ul(y.current.disabled)?{disabled:y.current.disabled}:{}});const F=(B,U)=>{const te=xr(a._fields,B);te&&te._f&&(te._f.mount=U)};if(F(s,!0),D){const B=Un(xr(a._options.defaultValues,s,y.current.defaultValue));rn(a._defaultValues,s,B),Fn(xr(a._formValues,s))&&rn(a._formValues,s,B)}return!i&&a.register(s),b.current=s,()=>{(i?D&&!a._state.action:D)?a.unregister(s):F(s,!1)}},[s,a,i,o]),je.useEffect(()=>{a._setDisabledField({disabled:n,name:s})},[n,s,a]),je.useMemo(()=>({field:C,formState:g,fieldState:T}),[C,g,T])}const GC=t=>t.render(zfe(t));var nD=(t,r,s,n,a)=>r?{...s[t],types:{...s[t]&&s[t].types?s[t].types:{},[n]:a||!0}}:{},qo=t=>Array.isArray(t)?t:[t],K5=()=>{let t=[];return{get observers(){return t},next:a=>{for(const o of t)o.next&&o.next(a)},subscribe:a=>(t.push(a),{unsubscribe:()=>{t=t.filter(o=>o!==a)}}),unsubscribe:()=>{t=[]}}};function IG(t,r){const s={};for(const n in t)if(t.hasOwnProperty(n)){const a=t[n],o=r[n];if(a&&Ka(a)&&o){const c=IG(a,o);Ka(c)&&(s[n]=c)}else t[n]&&(s[n]=o)}return s}var io=t=>Ka(t)&&!Object.keys(t).length,aD=t=>t.type==="file",Fc=t=>typeof t=="function",FS=t=>{if(!tD)return!1;const r=t?t.ownerDocument:0;return t instanceof(r&&r.defaultView?r.defaultView.HTMLElement:HTMLElement)},DG=t=>t.type==="select-multiple",iD=t=>t.type==="radio",Bfe=t=>iD(t)||z_(t),WA=t=>FS(t)&&t.isConnected;function qfe(t,r){const s=r.slice(0,-1).length;let n=0;for(;n<s;)t=Fn(t)?n++:t[r[n++]];return t}function Vfe(t){for(const r in t)if(t.hasOwnProperty(r)&&!Fn(t[r]))return!1;return!0}function Pa(t,r){const s=Array.isArray(r)?r:VC(r)?[r]:rD(r),n=s.length===1?t:qfe(t,s),a=s.length-1,o=s[a];return n&&delete n[o],a!==0&&(Ka(n)&&io(n)||Array.isArray(n)&&Vfe(n))&&Pa(t,s.slice(0,-1)),t}var Ufe=t=>{for(const r in t)if(Fc(t[r]))return!0;return!1};function RG(t){return Array.isArray(t)||Ka(t)&&!Ufe(t)}function CM(t,r={}){for(const s in t){const n=t[s];RG(n)?(r[s]=Array.isArray(n)?[]:{},CM(n,r[s])):Fn(n)||(r[s]=!0)}return r}function dg(t,r,s){s||(s=CM(r));for(const n in t){const a=t[n];if(RG(a))Fn(r)||SM(s[n])?s[n]=CM(a,Array.isArray(a)?[]:{}):dg(a,Ro(r)?{}:r[n],s[n]);else{const o=r[n];s[n]=!Lc(a,o)}}return s}const H5={value:!1,isValid:!1},Z5={value:!0,isValid:!0};var LG=t=>{if(Array.isArray(t)){if(t.length>1){const r=t.filter(s=>s&&s.checked&&!s.disabled).map(s=>s.value);return{value:r,isValid:!!r.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!Fn(t[0].attributes.value)?Fn(t[0].value)||t[0].value===""?Z5:{value:t[0].value,isValid:!0}:Z5:H5}return H5},FG=(t,{valueAsNumber:r,valueAsDate:s,setValueAs:n})=>Fn(t)?t:r?t===""?NaN:t&&+t:s&&fl(t)?new Date(t):n?n(t):t;const Y5={isValid:!1,value:null};var $G=t=>Array.isArray(t)?t.reduce((r,s)=>s&&s.checked&&!s.disabled?{isValid:!0,value:s.value}:r,Y5):Y5;function X5(t){const r=t.ref;return aD(r)?r.files:iD(r)?$G(t.refs).value:DG(r)?[...r.selectedOptions].map(({value:s})=>s):z_(r)?LG(t.refs).value:FG(Fn(r.value)?t.ref.value:r.value,t)}var Wfe=(t,r,s,n)=>{const a={};for(const o of t){const c=xr(r,o);c&&rn(a,o,c._f)}return{criteriaMode:s,names:[...t],fields:a,shouldUseNativeValidation:n}},$S=t=>t instanceof RegExp,d0=t=>Fn(t)?t:$S(t)?t.source:Ka(t)?$S(t.value)?t.value.source:t.value:t,Ng=t=>({isOnSubmit:!t||t===zl.onSubmit,isOnBlur:t===zl.onBlur,isOnChange:t===zl.onChange,isOnAll:t===zl.all,isOnTouch:t===zl.onTouched});const Q5="AsyncFunction";var Gfe=t=>!!t&&!!t.validate&&!!(Fc(t.validate)&&t.validate.constructor.name===Q5||Ka(t.validate)&&Object.values(t.validate).find(r=>r.constructor.name===Q5)),Kfe=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),PM=(t,r,s)=>!s&&(r.watchAll||r.watch.has(t)||[...r.watch].some(n=>t.startsWith(n)&&/^\.\w+/.test(t.slice(n.length))));const Bg=(t,r,s,n)=>{for(const a of s||Object.keys(t)){const o=xr(t,a);if(o){const{_f:c,...i}=o;if(c){if(c.refs&&c.refs[0]&&r(c.refs[0],a)&&!n)return!0;if(c.ref&&r(c.ref,c.name)&&!n)return!0;if(Bg(i,r))break}else if(Ka(i)&&Bg(i,r))break}}};function J5(t,r,s){const n=xr(t,s);if(n||VC(s))return{error:n,name:s};const a=s.split(".");for(;a.length;){const o=a.join("."),c=xr(r,o),i=xr(t,o);if(c&&!Array.isArray(c)&&s!==o)return{name:s};if(i&&i.type)return{name:o,error:i};if(i&&i.root&&i.root.type)return{name:`${o}.root`,error:i.root};a.pop()}return{name:s}}var Hfe=(t,r,s,n)=>{s(t);const{name:a,...o}=t;return io(o)||Object.keys(o).length>=Object.keys(r).length||Object.keys(o).find(c=>r[c]===(!n||zl.all))},Zfe=(t,r,s)=>!t||!r||t===r||qo(t).some(n=>n&&(s?n===r:n.startsWith(r)||r.startsWith(n))),Yfe=(t,r,s,n,a)=>a.isOnAll?!1:!s&&a.isOnTouch?!(r||t):(s?n.isOnBlur:a.isOnBlur)?!t:(s?n.isOnChange:a.isOnChange)?t:!0,Xfe=(t,r)=>!UC(xr(t,r)).length&&Pa(t,r),zG=(t,r,s)=>{const n=qo(xr(t,s));return rn(n,"root",r[s]),rn(t,s,n),t};function e$(t,r,s="validate"){if(fl(t)||Array.isArray(t)&&t.every(fl)||ul(t)&&!t)return{type:s,message:fl(t)?t:"",ref:r}}var sg=t=>Ka(t)&&!$S(t)?t:{value:t,message:""},kM=async(t,r,s,n,a,o)=>{const{ref:c,refs:i,required:f,maxLength:p,minLength:g,min:y,max:b,pattern:w,validate:T,name:N,valueAsNumber:M,mount:O}=t._f,C=xr(s,N);if(!O||r.has(N))return{};const D=i?i[0]:c,L=ne=>{a&&D.reportValidity&&(D.setCustomValidity(ul(ne)?"":ne||""),D.reportValidity())},F={},B=iD(c),U=z_(c),te=B||U,Q=(M||aD(c))&&Fn(c.value)&&Fn(C)||FS(c)&&c.value===""||C===""||Array.isArray(C)&&!C.length,re=nD.bind(null,N,n,F),Z=(ne,oe,Ce,Pe=pu.maxLength,Se=pu.minLength)=>{const ae=ne?oe:Ce;F[N]={type:ne?Pe:Se,message:ae,ref:c,...re(ne?Pe:Se,ae)}};if(o?!Array.isArray(C)||!C.length:f&&(!te&&(Q||Ro(C))||ul(C)&&!C||U&&!LG(i).isValid||B&&!$G(i).isValid)){const{value:ne,message:oe}=fl(f)?{value:!!f,message:f}:sg(f);if(ne&&(F[N]={type:pu.required,message:oe,ref:D,...re(pu.required,oe)},!n))return L(oe),F}if(!Q&&(!Ro(y)||!Ro(b))){let ne,oe;const Ce=sg(b),Pe=sg(y);if(!Ro(C)&&!isNaN(C)){const Se=c.valueAsNumber||C&&+C;Ro(Ce.value)||(ne=Se>Ce.value),Ro(Pe.value)||(oe=Se<Pe.value)}else{const Se=c.valueAsDate||new Date(C),ae=Ke=>new Date(new Date().toDateString()+" "+Ke),be=c.type=="time",de=c.type=="week";fl(Ce.value)&&C&&(ne=be?ae(C)>ae(Ce.value):de?C>Ce.value:Se>new Date(Ce.value)),fl(Pe.value)&&C&&(oe=be?ae(C)<ae(Pe.value):de?C<Pe.value:Se<new Date(Pe.value))}if((ne||oe)&&(Z(!!ne,Ce.message,Pe.message,pu.max,pu.min),!n))return L(F[N].message),F}if((p||g)&&!Q&&(fl(C)||o&&Array.isArray(C))){const ne=sg(p),oe=sg(g),Ce=!Ro(ne.value)&&C.length>+ne.value,Pe=!Ro(oe.value)&&C.length<+oe.value;if((Ce||Pe)&&(Z(Ce,ne.message,oe.message),!n))return L(F[N].message),F}if(w&&!Q&&fl(C)){const{value:ne,message:oe}=sg(w);if($S(ne)&&!C.match(ne)&&(F[N]={type:pu.pattern,message:oe,ref:c,...re(pu.pattern,oe)},!n))return L(oe),F}if(T){if(Fc(T)){const ne=await T(C,s),oe=e$(ne,D);if(oe&&(F[N]={...oe,...re(pu.validate,oe.message)},!n))return L(oe.message),F}else if(Ka(T)){let ne={};for(const oe in T){if(!io(ne)&&!n)break;const Ce=e$(await T[oe](C,s),D,oe);Ce&&(ne={...Ce,...re(oe,Ce.message)},L(Ce.message),n&&(F[N]=ne))}if(!io(ne)&&(F[N]={ref:D,...ne},!n))return F}}return L(!0),F};const Qfe={mode:zl.onSubmit,reValidateMode:zl.onChange,shouldFocusError:!0};function Jfe(t={}){let r={...Qfe,...t},s={submitCount:0,isDirty:!1,isReady:!1,isLoading:Fc(r.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1},n={},a=Ka(r.defaultValues)||Ka(r.values)?Un(r.defaultValues||r.values)||{}:{},o=r.shouldUnregister?{}:Un(a),c={action:!1,mount:!1,watch:!1},i={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},f,p=0;const g={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let y={...g};const b={array:K5(),state:K5()},w=r.criteriaMode===zl.all,T=De=>Je=>{clearTimeout(p),p=setTimeout(De,Je)},N=async De=>{if(!r.disabled&&(g.isValid||y.isValid||De)){const Je=r.resolver?io((await U()).errors):await Q(n,!0);Je!==s.isValid&&b.state.next({isValid:Je})}},M=(De,Je)=>{!r.disabled&&(g.isValidating||g.validatingFields||y.isValidating||y.validatingFields)&&((De||Array.from(i.mount)).forEach(lt=>{lt&&(Je?rn(s.validatingFields,lt,Je):Pa(s.validatingFields,lt))}),b.state.next({validatingFields:s.validatingFields,isValidating:!io(s.validatingFields)}))},O=(De,Je=[],lt,qt,It=!0,Bt=!0)=>{if(qt&&lt&&!r.disabled){if(c.action=!0,Bt&&Array.isArray(xr(n,De))){const er=lt(xr(n,De),qt.argA,qt.argB);It&&rn(n,De,er)}if(Bt&&Array.isArray(xr(s.errors,De))){const er=lt(xr(s.errors,De),qt.argA,qt.argB);It&&rn(s.errors,De,er),Xfe(s.errors,De)}if((g.touchedFields||y.touchedFields)&&Bt&&Array.isArray(xr(s.touchedFields,De))){const er=lt(xr(s.touchedFields,De),qt.argA,qt.argB);It&&rn(s.touchedFields,De,er)}(g.dirtyFields||y.dirtyFields)&&(s.dirtyFields=dg(a,o)),b.state.next({name:De,isDirty:Z(De,Je),dirtyFields:s.dirtyFields,errors:s.errors,isValid:s.isValid})}else rn(o,De,Je)},C=(De,Je)=>{rn(s.errors,De,Je),b.state.next({errors:s.errors})},D=De=>{s.errors=De,b.state.next({errors:s.errors,isValid:!1})},L=(De,Je,lt,qt)=>{const It=xr(n,De);if(It){const Bt=xr(o,De,Fn(lt)?xr(a,De):lt);Fn(Bt)||qt&&qt.defaultChecked||Je?rn(o,De,Je?Bt:X5(It._f)):Ce(De,Bt),c.mount&&!c.action&&N()}},F=(De,Je,lt,qt,It)=>{let Bt=!1,er=!1;const Qr={name:De};if(!r.disabled){if(!lt||qt){(g.isDirty||y.isDirty)&&(er=s.isDirty,s.isDirty=Qr.isDirty=Z(),Bt=er!==Qr.isDirty);const Ss=Lc(xr(a,De),Je);er=!!xr(s.dirtyFields,De),Ss?Pa(s.dirtyFields,De):rn(s.dirtyFields,De,!0),Qr.dirtyFields=s.dirtyFields,Bt=Bt||(g.dirtyFields||y.dirtyFields)&&er!==!Ss}if(lt){const Ss=xr(s.touchedFields,De);Ss||(rn(s.touchedFields,De,lt),Qr.touchedFields=s.touchedFields,Bt=Bt||(g.touchedFields||y.touchedFields)&&Ss!==lt)}Bt&&It&&b.state.next(Qr)}return Bt?Qr:{}},B=(De,Je,lt,qt)=>{const It=xr(s.errors,De),Bt=(g.isValid||y.isValid)&&ul(Je)&&s.isValid!==Je;if(r.delayError&&lt?(f=T(()=>C(De,lt)),f(r.delayError)):(clearTimeout(p),f=null,lt?rn(s.errors,De,lt):Pa(s.errors,De)),(lt?!Lc(It,lt):It)||!io(qt)||Bt){const er={...qt,...Bt&&ul(Je)?{isValid:Je}:{},errors:s.errors,name:De};s={...s,...er},b.state.next(er)}},U=async De=>{M(De,!0);const Je=await r.resolver(o,r.context,Wfe(De||i.mount,n,r.criteriaMode,r.shouldUseNativeValidation));return M(De),Je},te=async De=>{const{errors:Je}=await U(De);if(De)for(const lt of De){const qt=xr(Je,lt);qt?rn(s.errors,lt,qt):Pa(s.errors,lt)}else s.errors=Je;return Je},Q=async(De,Je,lt={valid:!0})=>{for(const qt in De){const It=De[qt];if(It){const{_f:Bt,...er}=It;if(Bt){const Qr=i.array.has(Bt.name),Ss=It._f&&Gfe(It._f);Ss&&g.validatingFields&&M([Bt.name],!0);const Tn=await kM(It,i.disabled,o,w,r.shouldUseNativeValidation&&!Je,Qr);if(Ss&&g.validatingFields&&M([Bt.name]),Tn[Bt.name]&&(lt.valid=!1,Je))break;!Je&&(xr(Tn,Bt.name)?Qr?zG(s.errors,Tn,Bt.name):rn(s.errors,Bt.name,Tn[Bt.name]):Pa(s.errors,Bt.name))}!io(er)&&await Q(er,Je,lt)}}return lt.valid},re=()=>{for(const De of i.unMount){const Je=xr(n,De);Je&&(Je._f.refs?Je._f.refs.every(lt=>!WA(lt)):!WA(Je._f.ref))&&Ct(De)}i.unMount=new Set},Z=(De,Je)=>!r.disabled&&(De&&Je&&rn(o,De,Je),!Lc(Ke(),a)),ne=(De,Je,lt)=>NM(De,i,{...c.mount?o:Fn(Je)?a:fl(De)?{[De]:Je}:Je},lt,Je),oe=De=>UC(xr(c.mount?o:a,De,r.shouldUnregister?xr(a,De,[]):[])),Ce=(De,Je,lt={})=>{const qt=xr(n,De);let It=Je;if(qt){const Bt=qt._f;Bt&&(!Bt.disabled&&rn(o,De,FG(Je,Bt)),It=FS(Bt.ref)&&Ro(Je)?"":Je,DG(Bt.ref)?[...Bt.ref.options].forEach(er=>er.selected=It.includes(er.value)):Bt.refs?z_(Bt.ref)?Bt.refs.forEach(er=>{(!er.defaultChecked||!er.disabled)&&(Array.isArray(It)?er.checked=!!It.find(Qr=>Qr===er.value):er.checked=It===er.value||!!It)}):Bt.refs.forEach(er=>er.checked=er.value===It):aD(Bt.ref)?Bt.ref.value="":(Bt.ref.value=It,Bt.ref.type||b.state.next({name:De,values:Un(o)})))}(lt.shouldDirty||lt.shouldTouch)&&F(De,It,lt.shouldTouch,lt.shouldDirty,!0),lt.shouldValidate&&de(De)},Pe=(De,Je,lt)=>{for(const qt in Je){if(!Je.hasOwnProperty(qt))return;const It=Je[qt],Bt=De+"."+qt,er=xr(n,Bt);(i.array.has(De)||Ka(It)||er&&!er._f)&&!Hf(It)?Pe(Bt,It,lt):Ce(Bt,It,lt)}},Se=(De,Je,lt={})=>{const qt=xr(n,De),It=i.array.has(De),Bt=Un(Je);rn(o,De,Bt),It?(b.array.next({name:De,values:Un(o)}),(g.isDirty||g.dirtyFields||y.isDirty||y.dirtyFields)&&lt.shouldDirty&&b.state.next({name:De,dirtyFields:dg(a,o),isDirty:Z(De,Bt)})):qt&&!qt._f&&!Ro(Bt)?Pe(De,Bt,lt):Ce(De,Bt,lt),PM(De,i)&&b.state.next({...s,name:De}),b.state.next({name:c.mount?De:void 0,values:Un(o)})},ae=async De=>{c.mount=!0;const Je=De.target;let lt=Je.name,qt=!0;const It=xr(n,lt),Bt=Ss=>{qt=Number.isNaN(Ss)||Hf(Ss)&&isNaN(Ss.getTime())||Lc(Ss,xr(o,lt,Ss))},er=Ng(r.mode),Qr=Ng(r.reValidateMode);if(It){let Ss,Tn;const Xe=Je.type?X5(It._f):AG(De),ye=De.type===LS.BLUR||De.type===LS.FOCUS_OUT,ve=!Kfe(It._f)&&!r.resolver&&!xr(s.errors,lt)&&!It._f.deps||Yfe(ye,xr(s.touchedFields,lt),s.isSubmitted,Qr,er),ke=PM(lt,i,ye);rn(o,lt,Xe),ye?(!Je||!Je.readOnly)&&(It._f.onBlur&&It._f.onBlur(De),f&&f(0)):It._f.onChange&&It._f.onChange(De);const Fe=F(lt,Xe,ye),Ge=!io(Fe)||ke;if(!ye&&b.state.next({name:lt,type:De.type,values:Un(o)}),ve)return(g.isValid||y.isValid)&&(r.mode==="onBlur"?ye&&N():ye||N()),Ge&&b.state.next({name:lt,...ke?{}:Fe});if(!ye&&ke&&b.state.next({...s}),r.resolver){const{errors:nt}=await U([lt]);if(Bt(Xe),qt){const dt=J5(s.errors,n,lt),rt=J5(nt,n,dt.name||lt);Ss=rt.error,lt=rt.name,Tn=io(nt)}}else M([lt],!0),Ss=(await kM(It,i.disabled,o,w,r.shouldUseNativeValidation))[lt],M([lt]),Bt(Xe),qt&&(Ss?Tn=!1:(g.isValid||y.isValid)&&(Tn=await Q(n,!0)));qt&&(It._f.deps&&(!Array.isArray(It._f.deps)||It._f.deps.length>0)&&de(It._f.deps),B(lt,Tn,Ss,Fe))}},be=(De,Je)=>{if(xr(s.errors,Je)&&De.focus)return De.focus(),1},de=async(De,Je={})=>{let lt,qt;const It=qo(De);if(r.resolver){const Bt=await te(Fn(De)?De:It);lt=io(Bt),qt=De?!It.some(er=>xr(Bt,er)):lt}else De?(qt=(await Promise.all(It.map(async Bt=>{const er=xr(n,Bt);return await Q(er&&er._f?{[Bt]:er}:er)}))).every(Boolean),!(!qt&&!s.isValid)&&N()):qt=lt=await Q(n);return b.state.next({...!fl(De)||(g.isValid||y.isValid)&&lt!==s.isValid?{}:{name:De},...r.resolver||!De?{isValid:lt}:{},errors:s.errors}),Je.shouldFocus&&!qt&&Bg(n,be,De?It:i.mount),qt},Ke=(De,Je)=>{let lt={...c.mount?o:a};return Je&&(lt=IG(Je.dirtyFields?s.dirtyFields:s.touchedFields,lt)),Fn(De)?lt:fl(De)?xr(lt,De):De.map(qt=>xr(lt,qt))},He=(De,Je)=>({invalid:!!xr((Je||s).errors,De),isDirty:!!xr((Je||s).dirtyFields,De),error:xr((Je||s).errors,De),isValidating:!!xr(s.validatingFields,De),isTouched:!!xr((Je||s).touchedFields,De)}),Ve=De=>{De&&qo(De).forEach(Je=>Pa(s.errors,Je)),b.state.next({errors:De?s.errors:{}})},yt=(De,Je,lt)=>{const qt=(xr(n,De,{_f:{}})._f||{}).ref,It=xr(s.errors,De)||{},{ref:Bt,message:er,type:Qr,...Ss}=It;rn(s.errors,De,{...Ss,...Je,ref:qt}),b.state.next({name:De,errors:s.errors,isValid:!1}),lt&&lt.shouldFocus&&qt&&qt.focus&&qt.focus()},Et=(De,Je)=>Fc(De)?b.state.subscribe({next:lt=>"values"in lt&&De(ne(void 0,Je),lt)}):ne(De,Je,!0),Rt=De=>b.state.subscribe({next:Je=>{Zfe(De.name,Je.name,De.exact)&&Hfe(Je,De.formState||g,As,De.reRenderRoot)&&De.callback({values:{...o},...s,...Je,defaultValues:a})}}).unsubscribe,Vt=De=>(c.mount=!0,y={...y,...De.formState},Rt({...De,formState:y})),Ct=(De,Je={})=>{for(const lt of De?qo(De):i.mount)i.mount.delete(lt),i.array.delete(lt),Je.keepValue||(Pa(n,lt),Pa(o,lt)),!Je.keepError&&Pa(s.errors,lt),!Je.keepDirty&&Pa(s.dirtyFields,lt),!Je.keepTouched&&Pa(s.touchedFields,lt),!Je.keepIsValidating&&Pa(s.validatingFields,lt),!r.shouldUnregister&&!Je.keepDefaultValue&&Pa(a,lt);b.state.next({values:Un(o)}),b.state.next({...s,...Je.keepDirty?{isDirty:Z()}:{}}),!Je.keepIsValid&&N()},ur=({disabled:De,name:Je})=>{(ul(De)&&c.mount||De||i.disabled.has(Je))&&(De?i.disabled.add(Je):i.disabled.delete(Je))},At=(De,Je={})=>{let lt=xr(n,De);const qt=ul(Je.disabled)||ul(r.disabled);return rn(n,De,{...lt||{},_f:{...lt&&lt._f?lt._f:{ref:{name:De}},name:De,mount:!0,...Je}}),i.mount.add(De),lt?ur({disabled:ul(Je.disabled)?Je.disabled:r.disabled,name:De}):L(De,!0,Je.value),{...qt?{disabled:Je.disabled||r.disabled}:{},...r.progressive?{required:!!Je.required,min:d0(Je.min),max:d0(Je.max),minLength:d0(Je.minLength),maxLength:d0(Je.maxLength),pattern:d0(Je.pattern)}:{},name:De,onChange:ae,onBlur:ae,ref:It=>{if(It){At(De,Je),lt=xr(n,De);const Bt=Fn(It.value)&&It.querySelectorAll&&It.querySelectorAll("input,select,textarea")[0]||It,er=Bfe(Bt),Qr=lt._f.refs||[];if(er?Qr.find(Ss=>Ss===Bt):Bt===lt._f.ref)return;rn(n,De,{_f:{...lt._f,...er?{refs:[...Qr.filter(WA),Bt,...Array.isArray(xr(a,De))?[{}]:[]],ref:{type:Bt.type,name:De}}:{ref:Bt}}}),L(De,!1,void 0,Bt)}else lt=xr(n,De,{}),lt._f&&(lt._f.mount=!1),(r.shouldUnregister||Je.shouldUnregister)&&!(TG(i.array,De)&&c.action)&&i.unMount.add(De)}}},Ht=()=>r.shouldFocusError&&Bg(n,be,i.mount),fr=De=>{ul(De)&&(b.state.next({disabled:De}),Bg(n,(Je,lt)=>{const qt=xr(n,lt);qt&&(Je.disabled=qt._f.disabled||De,Array.isArray(qt._f.refs)&&qt._f.refs.forEach(It=>{It.disabled=qt._f.disabled||De}))},0,!1))},vt=(De,Je)=>async lt=>{let qt;lt&&(lt.preventDefault&&lt.preventDefault(),lt.persist&&lt.persist());let It=Un(o);if(b.state.next({isSubmitting:!0}),r.resolver){const{errors:Bt,values:er}=await U();s.errors=Bt,It=Un(er)}else await Q(n);if(i.disabled.size)for(const Bt of i.disabled)Pa(It,Bt);if(Pa(s.errors,"root"),io(s.errors)){b.state.next({errors:{}});try{await De(It,lt)}catch(Bt){qt=Bt}}else Je&&await Je({...s.errors},lt),Ht(),setTimeout(Ht);if(b.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:io(s.errors)&&!qt,submitCount:s.submitCount+1,errors:s.errors}),qt)throw qt},Br=(De,Je={})=>{xr(n,De)&&(Fn(Je.defaultValue)?Se(De,Un(xr(a,De))):(Se(De,Je.defaultValue),rn(a,De,Un(Je.defaultValue))),Je.keepTouched||Pa(s.touchedFields,De),Je.keepDirty||(Pa(s.dirtyFields,De),s.isDirty=Je.defaultValue?Z(De,Un(xr(a,De))):Z()),Je.keepError||(Pa(s.errors,De),g.isValid&&N()),b.state.next({...s}))},vr=(De,Je={})=>{const lt=De?Un(De):a,qt=Un(lt),It=io(De),Bt=It?a:qt;if(Je.keepDefaultValues||(a=lt),!Je.keepValues){if(Je.keepDirtyValues){const er=new Set([...i.mount,...Object.keys(dg(a,o))]);for(const Qr of Array.from(er))xr(s.dirtyFields,Qr)?rn(Bt,Qr,xr(o,Qr)):Se(Qr,xr(Bt,Qr))}else{if(tD&&Fn(De))for(const er of i.mount){const Qr=xr(n,er);if(Qr&&Qr._f){const Ss=Array.isArray(Qr._f.refs)?Qr._f.refs[0]:Qr._f.ref;if(FS(Ss)){const Tn=Ss.closest("form");if(Tn){Tn.reset();break}}}}if(Je.keepFieldsRef)for(const er of i.mount)Se(er,xr(Bt,er));else n={}}o=r.shouldUnregister?Je.keepDefaultValues?Un(a):{}:Un(Bt),b.array.next({values:{...Bt}}),b.state.next({values:{...Bt}})}i={mount:Je.keepDirtyValues?i.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},c.mount=!g.isValid||!!Je.keepIsValid||!!Je.keepDirtyValues||!r.shouldUnregister&&!io(Bt),c.watch=!!r.shouldUnregister,b.state.next({submitCount:Je.keepSubmitCount?s.submitCount:0,isDirty:It?!1:Je.keepDirty?s.isDirty:!!(Je.keepDefaultValues&&!Lc(De,a)),isSubmitted:Je.keepIsSubmitted?s.isSubmitted:!1,dirtyFields:It?{}:Je.keepDirtyValues?Je.keepDefaultValues&&o?dg(a,o):s.dirtyFields:Je.keepDefaultValues&&De?dg(a,De):Je.keepDirty?s.dirtyFields:{},touchedFields:Je.keepTouched?s.touchedFields:{},errors:Je.keepErrors?s.errors:{},isSubmitSuccessful:Je.keepIsSubmitSuccessful?s.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:a})},Xr=(De,Je)=>vr(Fc(De)?De(o):De,Je),Dr=(De,Je={})=>{const lt=xr(n,De),qt=lt&&lt._f;if(qt){const It=qt.refs?qt.refs[0]:qt.ref;It.focus&&(It.focus(),Je.shouldSelect&&Fc(It.select)&&It.select())}},As=De=>{s={...s,...De}},Qs={control:{register:At,unregister:Ct,getFieldState:He,handleSubmit:vt,setError:yt,_subscribe:Rt,_runSchema:U,_focusError:Ht,_getWatch:ne,_getDirty:Z,_setValid:N,_setFieldArray:O,_setDisabledField:ur,_setErrors:D,_getFieldArray:oe,_reset:vr,_resetDefaultValues:()=>Fc(r.defaultValues)&&r.defaultValues().then(De=>{Xr(De,r.resetOptions),b.state.next({isLoading:!1})}),_removeUnmounted:re,_disableForm:fr,_subjects:b,_proxyFormState:g,get _fields(){return n},get _formValues(){return o},get _state(){return c},set _state(De){c=De},get _defaultValues(){return a},get _names(){return i},set _names(De){i=De},get _formState(){return s},get _options(){return r},set _options(De){r={...r,...De}}},subscribe:Vt,trigger:de,register:At,handleSubmit:vt,watch:Et,setValue:Se,getValues:Ke,reset:Xr,resetField:Br,clearErrors:Ve,unregister:Ct,setError:yt,setFocus:Dr,getFieldState:He};return{...Qs,formControl:Qs}}var Mh=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const t=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const s=(Math.random()*16+t)%16|0;return(r=="x"?s:s&3|8).toString(16)})},GA=(t,r,s={})=>s.shouldFocus||Fn(s.shouldFocus)?s.focusName||`${t}.${Fn(s.focusIndex)?r:s.focusIndex}.`:"",KA=(t,r)=>[...t,...qo(r)],HA=t=>Array.isArray(t)?t.map(()=>{}):void 0;function ZA(t,r,s){return[...t.slice(0,r),...qo(s),...t.slice(r)]}var YA=(t,r,s)=>Array.isArray(t)?(Fn(t[s])&&(t[s]=void 0),t.splice(s,0,t.splice(r,1)[0]),t):[],XA=(t,r)=>[...qo(r),...qo(t)];function epe(t,r){let s=0;const n=[...t];for(const a of r)n.splice(a-s,1),s++;return UC(n).length?n:[]}var QA=(t,r)=>Fn(r)?[]:epe(t,qo(r).sort((s,n)=>s-n)),JA=(t,r,s)=>{[t[r],t[s]]=[t[s],t[r]]},t$=(t,r,s)=>(t[r]=s,t);function oD(t){const r=jv(),{control:s=r.control,name:n,keyName:a="id",shouldUnregister:o,rules:c}=t,[i,f]=je.useState(s._getFieldArray(n)),p=je.useRef(s._getFieldArray(n).map(Mh)),g=je.useRef(!1);s._names.array.add(n),je.useMemo(()=>c&&i.length>=0&&s.register(n,c),[s,n,i.length,c]),WC(()=>s._subjects.array.subscribe({next:({values:L,name:F})=>{if(F===n||!F){const B=xr(L,n);Array.isArray(B)&&(f(B),p.current=B.map(Mh))}}}).unsubscribe,[s,n]);const y=je.useCallback(L=>{g.current=!0,s._setFieldArray(n,L)},[s,n]),b=(L,F)=>{const B=qo(Un(L)),U=KA(s._getFieldArray(n),B);s._names.focus=GA(n,U.length-1,F),p.current=KA(p.current,B.map(Mh)),y(U),f(U),s._setFieldArray(n,U,KA,{argA:HA(L)})},w=(L,F)=>{const B=qo(Un(L)),U=XA(s._getFieldArray(n),B);s._names.focus=GA(n,0,F),p.current=XA(p.current,B.map(Mh)),y(U),f(U),s._setFieldArray(n,U,XA,{argA:HA(L)})},T=L=>{const F=QA(s._getFieldArray(n),L);p.current=QA(p.current,L),y(F),f(F),!Array.isArray(xr(s._fields,n))&&rn(s._fields,n,void 0),s._setFieldArray(n,F,QA,{argA:L})},N=(L,F,B)=>{const U=qo(Un(F)),te=ZA(s._getFieldArray(n),L,U);s._names.focus=GA(n,L,B),p.current=ZA(p.current,L,U.map(Mh)),y(te),f(te),s._setFieldArray(n,te,ZA,{argA:L,argB:HA(F)})},M=(L,F)=>{const B=s._getFieldArray(n);JA(B,L,F),JA(p.current,L,F),y(B),f(B),s._setFieldArray(n,B,JA,{argA:L,argB:F},!1)},O=(L,F)=>{const B=s._getFieldArray(n);YA(B,L,F),YA(p.current,L,F),y(B),f(B),s._setFieldArray(n,B,YA,{argA:L,argB:F},!1)},C=(L,F)=>{const B=Un(F),U=t$(s._getFieldArray(n),L,B);p.current=[...U].map((te,Q)=>!te||Q===L?Mh():p.current[Q]),y(U),f([...U]),s._setFieldArray(n,U,t$,{argA:L,argB:B},!0,!1)},D=L=>{const F=qo(Un(L));p.current=F.map(Mh),y([...F]),f([...F]),s._setFieldArray(n,[...F],B=>B,{},!0,!1)};return je.useEffect(()=>{if(s._state.action=!1,PM(n,s._names)&&s._subjects.state.next({...s._formState}),g.current&&(!Ng(s._options.mode).isOnSubmit||s._formState.isSubmitted)&&!Ng(s._options.reValidateMode).isOnSubmit)if(s._options.resolver)s._runSchema([n]).then(L=>{const F=xr(L.errors,n),B=xr(s._formState.errors,n);(B?!F&&B.type||F&&(B.type!==F.type||B.message!==F.message):F&&F.type)&&(F?rn(s._formState.errors,n,F):Pa(s._formState.errors,n),s._subjects.state.next({errors:s._formState.errors}))});else{const L=xr(s._fields,n);L&&L._f&&!(Ng(s._options.reValidateMode).isOnSubmit&&Ng(s._options.mode).isOnSubmit)&&kM(L,s._names.disabled,s._formValues,s._options.criteriaMode===zl.all,s._options.shouldUseNativeValidation,!0).then(F=>!io(F)&&s._subjects.state.next({errors:zG(s._formState.errors,F,n)}))}s._subjects.state.next({name:n,values:Un(s._formValues)}),s._names.focus&&Bg(s._fields,(L,F)=>{if(s._names.focus&&F.startsWith(s._names.focus)&&L.focus)return L.focus(),1}),s._names.focus="",s._setValid(),g.current=!1},[i,n,s]),je.useEffect(()=>(!xr(s._formValues,n)&&s._setFieldArray(n),()=>{const L=(F,B)=>{const U=xr(s._fields,F);U&&U._f&&(U._f.mount=B)};s._options.shouldUnregister||o?s.unregister(n):L(n,!1)}),[n,s,a,o]),{swap:je.useCallback(M,[y,n,s]),move:je.useCallback(O,[y,n,s]),prepend:je.useCallback(w,[y,n,s]),append:je.useCallback(b,[y,n,s]),remove:je.useCallback(T,[y,n,s]),insert:je.useCallback(N,[y,n,s]),update:je.useCallback(C,[y,n,s]),replace:je.useCallback(D,[y,n,s]),fields:je.useMemo(()=>i.map((L,F)=>({...L,[a]:p.current[F]||Mh()})),[i,a])}}function Ya(t={}){const r=je.useRef(void 0),s=je.useRef(void 0),[n,a]=je.useState({isDirty:!1,isValidating:!1,isLoading:Fc(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:Fc(t.defaultValues)?void 0:t.defaultValues});if(!r.current)if(t.formControl)r.current={...t.formControl,formState:n},t.defaultValues&&!Fc(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:c,...i}=Jfe(t);r.current={...i,formState:n}}const o=r.current.control;return o._options=t,WC(()=>{const c=o._subscribe({formState:o._proxyFormState,callback:()=>a({...o._formState}),reRenderRoot:!0});return a(i=>({...i,isReady:!0})),o._formState.isReady=!0,c},[o]),je.useEffect(()=>o._disableForm(t.disabled),[o,t.disabled]),je.useEffect(()=>{t.mode&&(o._options.mode=t.mode),t.reValidateMode&&(o._options.reValidateMode=t.reValidateMode)},[o,t.mode,t.reValidateMode]),je.useEffect(()=>{t.errors&&(o._setErrors(t.errors),o._focusError())},[o,t.errors]),je.useEffect(()=>{t.shouldUnregister&&o._subjects.state.next({values:o._getWatch()})},[o,t.shouldUnregister]),je.useEffect(()=>{if(o._proxyFormState.isDirty){const c=o._getDirty();c!==n.isDirty&&o._subjects.state.next({isDirty:c})}},[o,n.isDirty]),je.useEffect(()=>{var c;t.values&&!Lc(t.values,s.current)?(o._reset(t.values,{keepFieldsRef:!0,...o._options.resetOptions}),!((c=o._options.resetOptions)===null||c===void 0)&&c.keepIsValid||o._setValid(),s.current=t.values,a(i=>({...i}))):o._resetDefaultValues()},[o,t.values]),je.useEffect(()=>{o._state.mount||(o._setValid(),o._state.mount=!0),o._state.watch&&(o._state.watch=!1,o._subjects.state.next({...o._formState})),o._removeUnmounted()}),r.current.formState=MG(n,o),r.current}function tpe({open:t,onOpenChange:r,asset:s}){var F,B,U,te,Q;const n=yr(),a=!!s,{register:o,handleSubmit:c,reset:i,setValue:f,watch:p,formState:{errors:g}}=Ya({defaultValues:s?{class_id:s.class_id,parent_id:s.parent_id||void 0,scheme_id:s.scheme_id||void 0,dma_id:s.dma_id||void 0,code:s.code,name:s.name,status:s.status,manufacturer:s.manufacturer||void 0,model:s.model||void 0,serial:s.serial||void 0,install_date:s.install_date||void 0,barcode:s.barcode||void 0}:{status:"active"}}),{data:y}=it({queryKey:["asset-classes"],queryFn:()=>_i.getClasses()}),{data:b}=it({queryKey:["assets-for-parent"],queryFn:()=>_i.getAssets({per_page:200})}),{data:w}=it({queryKey:["sources-for-assets"],queryFn:async()=>{var re;try{const Z=await pe.get("/sources",{per_page:200}),ne=((re=Z==null?void 0:Z.data)==null?void 0:re.data)||(Z==null?void 0:Z.data)||[];return Array.isArray(ne)?ne:[]}catch{return[]}}}),{data:T}=it({queryKey:["kiosks-for-assets"],queryFn:async()=>{var re;try{const Z=await pe.get("/crm/kiosks",{per_page:200}),ne=((re=Z==null?void 0:Z.data)==null?void 0:re.data)||(Z==null?void 0:Z.data)||[];return Array.isArray(ne)?ne:[]}catch{return[]}}}),N=p("class_id")?(F=y==null?void 0:y.find(re=>re.id===p("class_id")))==null?void 0:F.code:null,M=N==="BOREHOLE",O=N==="KIOSK",C=gt({mutationFn:re=>_i.createAsset(re),onSuccess:()=>{n.invalidateQueries({queryKey:["assets"]}),Me.success("Asset created successfully"),r(!1),i()},onError:re=>{var Z,ne;Me.error(((ne=(Z=re.response)==null?void 0:Z.data)==null?void 0:ne.message)||"Failed to create asset")}}),D=gt({mutationFn:re=>_i.updateAsset(s.id,re),onSuccess:()=>{n.invalidateQueries({queryKey:["assets"]}),n.invalidateQueries({queryKey:["asset",s.id]}),Me.success("Asset updated successfully"),r(!1)},onError:re=>{var Z,ne;Me.error(((ne=(Z=re.response)==null?void 0:Z.data)==null?void 0:ne.message)||"Failed to update asset")}}),L=re=>{a?D.mutate(re):C.mutate(re)};return A.useEffect(()=>{s?Object.keys(s).forEach(re=>{f(re,s[re])}):i({status:"active"})},[s,f,i]),e.jsx(Qt,{open:t,onOpenChange:r,children:e.jsxs(Zt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:a?"Edit Asset":"Create New Asset"}),e.jsx(Es,{children:a?"Update asset information":"Add a new asset to the registry"})]}),e.jsxs("form",{onSubmit:c(L),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"class_id",children:"Asset Class *"}),e.jsxs(Nt,{onValueChange:re=>f("class_id",Number(re)),defaultValue:(B=s==null?void 0:s.class_id)==null?void 0:B.toString(),children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select class"})}),e.jsx(_t,{children:y==null?void 0:y.map(re=>e.jsx(ge,{value:re.id.toString(),children:re.name},re.id))})]}),g.class_id&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"parent_id",children:"Parent Asset"}),e.jsxs(Nt,{onValueChange:re=>f("parent_id",re&&re!=="none"?Number(re):void 0),defaultValue:((U=s==null?void 0:s.parent_id)==null?void 0:U.toString())||"none",children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"None"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"none",children:"None"}),b==null?void 0:b.data.filter(re=>re.id!==(s==null?void 0:s.id)).map(re=>e.jsxs(ge,{value:re.id.toString(),children:[re.code," - ",re.name]},re.id))]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"code",children:"Asset Code *"}),e.jsx(Ie,{id:"code",...o("code",{required:!0}),placeholder:"e.g., PUMP-001"}),g.code&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"name",children:"Asset Name *"}),e.jsx(Ie,{id:"name",...o("name",{required:!0}),placeholder:"e.g., Main Borehole Pump"}),g.name&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"status",children:"Status *"}),e.jsxs(Nt,{onValueChange:re=>f("status",re),defaultValue:(s==null?void 0:s.status)||"active",children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"active",children:"Active"}),e.jsx(ge,{value:"inactive",children:"Inactive"}),e.jsx(ge,{value:"under_maintenance",children:"Under Maintenance"}),e.jsx(ge,{value:"retired",children:"Retired"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"manufacturer",children:"Manufacturer"}),e.jsx(Ie,{id:"manufacturer",...o("manufacturer")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"model",children:"Model"}),e.jsx(Ie,{id:"model",...o("model")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"serial",children:"Serial Number"}),e.jsx(Ie,{id:"serial",...o("serial")})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"install_date",children:"Installation Date"}),e.jsx(Ie,{id:"install_date",type:"date",...o("install_date")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"barcode",children:"Barcode"}),e.jsx(Ie,{id:"barcode",...o("barcode")})]})]}),M&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(zn,{children:[e.jsx(tM,{className:"h-4 w-4"}),e.jsx(An,{children:"Link this asset to a water source from the Hydro-Met module to track abstraction and water quality data."})]}),e.jsx(we,{htmlFor:"source_id",children:"Linked Water Source"}),e.jsxs(Nt,{onValueChange:re=>f("source_id",re&&re!=="none"?Number(re):void 0),defaultValue:((te=s==null?void 0:s.source_id)==null?void 0:te.toString())||"none",children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select water source"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"none",children:"None"}),w==null?void 0:w.map(re=>e.jsxs(ge,{value:re.id.toString(),children:[re.code," - ",re.name]},re.id))]})]})]}),O&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(zn,{children:[e.jsx(tM,{className:"h-4 w-4"}),e.jsx(An,{children:"Link this asset to a kiosk from the Customer module to track sales, vendor, and revenue data."})]}),e.jsx(we,{htmlFor:"kiosk_id",children:"Linked Kiosk"}),e.jsxs(Nt,{onValueChange:re=>f("kiosk_id",re&&re!=="none"?Number(re):void 0),defaultValue:((Q=s==null?void 0:s.kiosk_id)==null?void 0:Q.toString())||"none",children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select kiosk"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"none",children:"None"}),T==null?void 0:T.map(re=>e.jsxs(ge,{value:re.id.toString(),children:[re.kiosk_code," - ",re.vendor_name," ",re.location?`(${re.location})`:""]},re.id))]})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:C.isPending||D.isPending,children:C.isPending||D.isPending?"Saving...":a?"Update":"Create"})]})]})]})})}const rpe={active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",retired:"bg-red-100 text-red-800",under_maintenance:"bg-yellow-100 text-yellow-800"},spe={open:"bg-blue-100 text-blue-800",assigned:"bg-purple-100 text-purple-800",in_progress:"bg-yellow-100 text-yellow-800",completed:"bg-green-100 text-green-800",cancelled:"bg-gray-100 text-gray-800"};function npe(){var i,f,p,g;const{id:t}=xC(),r=Number(t),s="/core/assets",{data:n,isLoading:a,error:o}=it({queryKey:["asset",r],queryFn:()=>_i.getAsset(r),enabled:!!r&&!isNaN(r)}),{data:c}=it({queryKey:["asset-maintenance",r],queryFn:()=>_i.getAssetMaintenanceHistory(r),enabled:!!r&&!isNaN(r)});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Pn,{to:s,children:e.jsxs(K,{variant:"ghost",size:"sm",children:[e.jsx(vb,{className:"mr-2 h-4 w-4"}),"Back to Assets"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:(n==null?void 0:n.name)||"Asset Details"}),e.jsx("p",{className:"text-muted-foreground",children:(n==null?void 0:n.code)||""})]})]}),n&&e.jsx(Ae,{className:rpe[n.status],children:n.status.replace("_"," ")})]}),a&&!n?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading asset details..."})}):o?e.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:e.jsxs("p",{className:"text-lg text-destructive",children:["Error loading asset: ",o.message]})}):n?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(H,{className:"md:col-span-2",children:[e.jsx(ue,{children:e.jsx(he,{children:"Asset Information"})}),e.jsx(X,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Asset Code"}),e.jsx("p",{className:"font-medium",children:n.code})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Asset Class"}),e.jsxs("p",{className:"font-medium flex items-center gap-2",children:[e.jsx(Gn,{className:"h-4 w-4 text-muted-foreground"}),((i=n.asset_class)==null?void 0:i.name)||"Unknown"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manufacturer"}),e.jsx("p",{className:"font-medium",children:n.manufacturer||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Model"}),e.jsx("p",{className:"font-medium",children:n.model||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Serial Number"}),e.jsx("p",{className:"font-medium",children:n.serial||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Installation Date"}),e.jsx("p",{className:"font-medium",children:n.install_date?new Date(n.install_date).toLocaleDateString():"-"})]}),n.scheme&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Scheme"}),e.jsx("p",{className:"font-medium",children:n.scheme.name})]}),n.dma&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"DMA"}),e.jsx("p",{className:"font-medium",children:n.dma.name})]}),n.geom&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Location"}),e.jsxs("p",{className:"font-medium flex items-center gap-2",children:[e.jsx(fn,{className:"h-4 w-4 text-muted-foreground"}),n.geom.coordinates[1].toFixed(6),", ",n.geom.coordinates[0].toFixed(6)]})]})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Quick Stats"})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($s,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"Open Work Orders"})]}),e.jsx(Ae,{variant:"outline",children:((f=n.work_orders)==null?void 0:f.filter(y=>y.status!=="completed"&&y.status!=="cancelled").length)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ns,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"Completed WOs"})]}),e.jsx(Ae,{variant:"outline",children:((p=n.work_orders)==null?void 0:p.filter(y=>y.status==="completed").length)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Nn,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"Total WOs"})]}),e.jsx(Ae,{variant:"outline",children:((g=n.work_orders)==null?void 0:g.length)||0})]})]})]}),n.parent&&e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Parent Asset"})}),e.jsx(X,{children:e.jsx(Pn,{to:`/cmms/assets/${n.parent.id}`,children:e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium",children:n.parent.name}),e.jsx("p",{className:"text-muted-foreground",children:n.parent.code})]})})})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Work Orders"})}),e.jsx(X,{children:n.work_orders&&n.work_orders.length>0?e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"WO #"}),e.jsx(se,{children:"Title"}),e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Priority"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Scheduled"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:n.work_orders.map(y=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:y.wo_num}),e.jsx(J,{children:y.title}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",className:"uppercase",children:y.kind})}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",className:"capitalize",children:y.priority})}),e.jsx(J,{children:e.jsx(Ae,{className:spe[y.status],children:y.status.replace("_"," ")})}),e.jsx(J,{className:"text-muted-foreground",children:y.scheduled_for?new Date(y.scheduled_for).toLocaleDateString():"-"}),e.jsx(J,{children:e.jsx(Pn,{to:`/cmms/work-orders/${y.id}`,children:e.jsx(K,{variant:"ghost",size:"sm",children:"View"})})})]},y.id))})]}):e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No work orders found for this asset"})})]}),c&&c.length>0&&e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Maintenance History"})}),e.jsx(X,{children:e.jsx("div",{className:"space-y-4",children:c.map(y=>e.jsxs("div",{className:"border-l-2 border-gray-200 pl-4 pb-4",children:[e.jsx("p",{className:"font-medium",children:y.description||y.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(y.completed_at||y.created_at).toLocaleDateString()}),y.notes&&e.jsx("p",{className:"text-sm mt-2",children:y.notes})]},y.id))})})]})]}):e.jsx("div",{className:"p-6 bg-yellow-100 border border-yellow-600 rounded-lg",children:e.jsx("p",{className:"text-lg text-yellow-800",children:"Asset not found"})})]})}var BG="AlertDialog",[ape]=tc(BG,[TW]),Yu=TW(),qG=t=>{const{__scopeAlertDialog:r,...s}=t,n=Yu(r);return e.jsx(DC,{...n,...s,modal:!0})};qG.displayName=BG;var ipe="AlertDialogTrigger",ope=A.forwardRef((t,r)=>{const{__scopeAlertDialog:s,...n}=t,a=Yu(s);return e.jsx(GW,{...a,...n,ref:r})});ope.displayName=ipe;var lpe="AlertDialogPortal",VG=t=>{const{__scopeAlertDialog:r,...s}=t,n=Yu(r);return e.jsx(RC,{...n,...s})};VG.displayName=lpe;var cpe="AlertDialogOverlay",UG=A.forwardRef((t,r)=>{const{__scopeAlertDialog:s,...n}=t,a=Yu(s);return e.jsx(pv,{...a,...n,ref:r})});UG.displayName=cpe;var qg="AlertDialogContent",[dpe,upe]=ape(qg),WG=A.forwardRef((t,r)=>{const{__scopeAlertDialog:s,children:n,...a}=t,o=Yu(s),c=A.useRef(null),i=ls(r,c),f=A.useRef(null);return e.jsx(wce,{contentName:qg,titleName:GG,docsSlug:"alert-dialog",children:e.jsx(dpe,{scope:s,cancelRef:f,children:e.jsxs(xv,{role:"alertdialog",...o,...a,ref:i,onOpenAutoFocus:gr(a.onOpenAutoFocus,p=>{var g;p.preventDefault(),(g=f.current)==null||g.focus({preventScroll:!0})}),onPointerDownOutside:p=>p.preventDefault(),onInteractOutside:p=>p.preventDefault(),children:[e.jsx(WU,{children:n}),e.jsx(mpe,{contentRef:c})]})})})});WG.displayName=qg;var GG="AlertDialogTitle",KG=A.forwardRef((t,r)=>{const{__scopeAlertDialog:s,...n}=t,a=Yu(s);return e.jsx(D_,{...a,...n,ref:r})});KG.displayName=GG;var HG="AlertDialogDescription",ZG=A.forwardRef((t,r)=>{const{__scopeAlertDialog:s,...n}=t,a=Yu(s);return e.jsx(R_,{...a,...n,ref:r})});ZG.displayName=HG;var hpe="AlertDialogAction",YG=A.forwardRef((t,r)=>{const{__scopeAlertDialog:s,...n}=t,a=Yu(s);return e.jsx(LC,{...a,...n,ref:r})});YG.displayName=hpe;var XG="AlertDialogCancel",QG=A.forwardRef((t,r)=>{const{__scopeAlertDialog:s,...n}=t,{cancelRef:a}=upe(XG,s),o=Yu(s),c=ls(r,a);return e.jsx(LC,{...o,...n,ref:c})});QG.displayName=XG;var mpe=({contentRef:t})=>{const r=`\`${qg}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${qg}\` by passing a \`${HG}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${qg}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return A.useEffect(()=>{var n;document.getElementById((n=t.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(r)},[r,t]),null},fpe=qG,ppe=VG,JG=UG,eK=WG,tK=YG,rK=QG,sK=KG,nK=ZG;const KC=fpe,xpe=ppe,aK=A.forwardRef(({className:t,...r},s)=>e.jsx(JG,{className:dr("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r,ref:s}));aK.displayName=JG.displayName;const B_=A.forwardRef(({className:t,...r},s)=>e.jsxs(xpe,{children:[e.jsx(aK,{}),e.jsx(eK,{ref:s,className:dr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r})]}));B_.displayName=eK.displayName;const q_=({className:t,...r})=>e.jsx("div",{className:dr("flex flex-col space-y-2 text-center sm:text-left",t),...r});q_.displayName="AlertDialogHeader";const V_=({className:t,...r})=>e.jsx("div",{className:dr("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r});V_.displayName="AlertDialogFooter";const U_=A.forwardRef(({className:t,...r},s)=>e.jsx(sK,{ref:s,className:dr("text-lg font-semibold",t),...r}));U_.displayName=sK.displayName;const W_=A.forwardRef(({className:t,...r},s)=>e.jsx(nK,{ref:s,className:dr("text-sm text-muted-foreground",t),...r}));W_.displayName=nK.displayName;const G_=A.forwardRef(({className:t,...r},s)=>e.jsx(tK,{ref:s,className:dr(pI(),t),...r}));G_.displayName=tK.displayName;const K_=A.forwardRef(({className:t,...r},s)=>e.jsx(rK,{ref:s,className:dr(pI({variant:"outline"}),"mt-2 sm:mt-0",t),...r}));K_.displayName=rK.displayName;function gpe({open:t,onOpenChange:r,workOrder:s}){var Pe,Se;const n=yr(),a=!!s,[o,c]=A.useState((s==null?void 0:s.asset_id)||void 0),[i,f]=A.useState((s==null?void 0:s.scheduled_for)||void 0),[p,g]=A.useState((s==null?void 0:s.assigned_to)||void 0),[y,b]=A.useState(null),[w,T]=A.useState(!1),{register:N,handleSubmit:M,reset:O,setValue:C,formState:{errors:D}}=Ya({defaultValues:s?{kind:s.kind,asset_id:s.asset_id||void 0,title:s.title,description:s.description||void 0,priority:s.priority,scheduled_for:s.scheduled_for||void 0,assigned_to:s.assigned_to||void 0,pm_policy_id:s.pm_policy_id||void 0}:{kind:"cm",priority:"medium"}}),{data:L}=it({queryKey:["assets-for-wo"],queryFn:()=>_i.getAssets({per_page:200})}),{data:F,isLoading:B}=it({queryKey:["operator-suggestions",o,i],queryFn:()=>cp.getOperatorSuggestions({asset_id:o,scheduled_for:i}),enabled:t}),U=gt({mutationFn:ae=>cp.createWorkOrder(ae),onSuccess:()=>{n.invalidateQueries({queryKey:["work-orders"]}),Me.success("Work order created successfully"),r(!1),O()},onError:ae=>{var be,de;Me.error(((de=(be=ae.response)==null?void 0:be.data)==null?void 0:de.message)||"Failed to create work order")}}),te=gt({mutationFn:ae=>cp.updateWorkOrder(s.id,ae),onSuccess:()=>{n.invalidateQueries({queryKey:["work-orders"]}),n.invalidateQueries({queryKey:["work-order",s.id]}),Me.success("Work order updated successfully"),r(!1)},onError:ae=>{var be,de;Me.error(((de=(be=ae.response)==null?void 0:be.data)==null?void 0:de.message)||"Failed to update work order")}}),Q=ae=>{const be={...ae,assigned_to:p};a?te.mutate(be):U.mutate(be)},re=ae=>{if(ae==="none"){g(void 0),C("assigned_to",void 0);return}!(F==null?void 0:F.suggested.some(de=>de.id===ae))&&(F!=null&&F.has_suggestions)?(b(ae),T(!0)):(g(ae),C("assigned_to",ae))},Z=()=>{y&&(g(y),C("assigned_to",y),b(null)),T(!1)},ne=()=>{b(null),T(!1)};A.useEffect(()=>{s?(Object.keys(s).forEach(ae=>{C(ae,s[ae])}),c(s.asset_id||void 0),f(s.scheduled_for||void 0),g(s.assigned_to||void 0)):(O({kind:"cm",priority:"medium"}),c(void 0),f(void 0),g(void 0))},[s,C,O]),A.useEffect(()=>{if(F!=null&&F.suggested.length&&!p&&!a){const ae=F.suggested[0];g(ae.id),C("assigned_to",ae.id)}},[F,p,a,C]);const oe=ae=>{const be=F==null?void 0:F.suggested.find(Ke=>Ke.id===ae);if(be)return be.name;const de=F==null?void 0:F.all_operators.find(Ke=>Ke.id===ae);return(de==null?void 0:de.name)||ae},Ce=ae=>ae.source==="on_shift"?e.jsxs(Ae,{variant:"outline",className:"ml-2 bg-green-50 text-green-700 border-green-200",children:[e.jsx($s,{className:"w-3 h-3 mr-1"}),"On Shift ",ae.shift_ends_at&&`until ${ae.shift_ends_at}`]}):ae.source==="route_assigned"?e.jsxs(Ae,{variant:"outline",className:"ml-2 bg-blue-50 text-blue-700 border-blue-200",children:[e.jsx(fn,{className:"w-3 h-3 mr-1"}),"Route: ",ae.route_name]}):null;return e.jsxs(e.Fragment,{children:[e.jsx(Qt,{open:t,onOpenChange:r,children:e.jsxs(Zt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:a?"Edit Work Order":"Create New Work Order"}),e.jsx(Es,{children:a?"Update work order details":"Schedule a new maintenance task"})]}),e.jsxs("form",{onSubmit:M(Q),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"kind",children:"Type *"}),e.jsxs(Nt,{onValueChange:ae=>C("kind",ae),defaultValue:(s==null?void 0:s.kind)||"cm",children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"pm",children:"Preventive Maintenance"}),e.jsx(ge,{value:"cm",children:"Corrective Maintenance"}),e.jsx(ge,{value:"emergency",children:"Emergency"}),e.jsx(ge,{value:"project",children:"Project"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"priority",children:"Priority *"}),e.jsxs(Nt,{onValueChange:ae=>C("priority",ae),defaultValue:(s==null?void 0:s.priority)||"medium",children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"low",children:"Low"}),e.jsx(ge,{value:"medium",children:"Medium"}),e.jsx(ge,{value:"high",children:"High"}),e.jsx(ge,{value:"critical",children:"Critical"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"asset_id",children:"Related Asset"}),e.jsxs(Nt,{onValueChange:ae=>{const be=ae&&ae!=="none"?Number(ae):void 0;C("asset_id",be),c(be)},defaultValue:((Pe=s==null?void 0:s.asset_id)==null?void 0:Pe.toString())||"none",children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select asset (optional)"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"none",children:"None"}),L==null?void 0:L.data.map(ae=>e.jsxs(ge,{value:ae.id.toString(),children:[ae.code," - ",ae.name]},ae.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"title",children:"Title *"}),e.jsx(Ie,{id:"title",...N("title",{required:!0}),placeholder:"e.g., Replace pump motor"}),D.title&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"description",children:"Description"}),e.jsx(ws,{id:"description",...N("description"),placeholder:"Detailed description of the work to be done...",rows:4})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"scheduled_for",children:"Scheduled Date"}),e.jsx(Ie,{id:"scheduled_for",type:"datetime-local",...N("scheduled_for"),onChange:ae=>{C("scheduled_for",ae.target.value),f(ae.target.value)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"assigned_to",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bC,{className:"w-4 h-4"}),"Assign To"]})}),e.jsxs(Nt,{value:p||"none",onValueChange:re,children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select operator"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"none",children:"Unassigned"}),(F==null?void 0:F.suggested)&&F.suggested.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-2 py-1.5 text-xs font-semibold text-muted-foreground bg-muted",children:"Recommended Operators"}),F.suggested.map(ae=>e.jsx(ge,{value:ae.id,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{children:ae.name}),Ce(ae)]})},ae.id))]}),(F==null?void 0:F.all_operators)&&F.all_operators.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-2 py-1.5 text-xs font-semibold text-muted-foreground bg-muted",children:"All Operators"}),F.all_operators.filter(ae=>!ae.is_suggested).map(ae=>e.jsx(ge,{value:ae.id,children:ae.name},ae.id))]})]})]}),p&&(F==null?void 0:F.suggested.find(ae=>ae.id===p))&&e.jsxs("p",{className:"text-xs text-green-600 flex items-center gap-1",children:[e.jsx($s,{className:"w-3 h-3"}),"Auto-assigned: ",oe(p),((Se=F.suggested.find(ae=>ae.id===p))==null?void 0:Se.source)==="on_shift"?" (currently on shift)":" (assigned to this route)"]}),B&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Loading suggested operators..."})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:U.isPending||te.isPending,children:U.isPending||te.isPending?"Saving...":a?"Update":"Create"})]})]})]})}),e.jsx(KC,{open:w,onOpenChange:T,children:e.jsxs(B_,{children:[e.jsxs(q_,{children:[e.jsxs(U_,{className:"flex items-center gap-2",children:[e.jsx(Fr,{className:"w-5 h-5 text-amber-500"}),"Override Suggested Assignment?"]}),e.jsxs(W_,{className:"space-y-2",children:[e.jsx("p",{children:"You're selecting an operator who is not currently on shift or assigned to this route."}),(F==null?void 0:F.suggested)&&F.suggested.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-green-50 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium text-green-800 mb-2",children:"Recommended operators:"}),e.jsx("ul",{className:"text-sm text-green-700 space-y-1",children:F.suggested.slice(0,3).map(ae=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{children:ae.name}),e.jsx(Ae,{variant:"outline",className:"text-xs",children:ae.source==="on_shift"?"On Shift":"Route Assigned"})]},ae.id))})]}),e.jsx("p",{className:"mt-3 text-sm",children:"Are you sure you want to proceed with manual assignment?"})]})]}),e.jsxs(V_,{children:[e.jsx(K_,{onClick:ne,children:"Cancel"}),e.jsx(G_,{onClick:Z,children:"Yes, Override Assignment"})]})]})})]})}const ype=[{value:"none",label:"All Statuses"},{value:"open",label:"Open"},{value:"assigned",label:"Assigned"},{value:"in_progress",label:"In Progress"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}],vpe=[{value:"none",label:"All Types"},{value:"pm",label:"Preventive Maintenance"},{value:"cm",label:"Corrective Maintenance"},{value:"emergency",label:"Emergency"},{value:"project",label:"Project"}],jpe=[{value:"none",label:"All Priorities"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],bpe={open:"bg-blue-100 text-blue-800",assigned:"bg-purple-100 text-purple-800",in_progress:"bg-yellow-100 text-yellow-800",completed:"bg-green-100 text-green-800",cancelled:"bg-gray-100 text-gray-800"},_pe={low:"bg-gray-100 text-gray-800",medium:"bg-blue-100 text-blue-800",high:"bg-orange-100 text-orange-800",critical:"bg-red-100 text-red-800"};function wpe(){const[t,r]=A.useState({per_page:15,page:1}),[s,n]=A.useState(!1),[a,o]=A.useState(),{data:c,isLoading:i,error:f}=it({queryKey:["work-orders",t],queryFn:()=>cp.getWorkOrders(t)}),p=w=>{r({...t,search:w,page:1})},g=w=>{r({...t,status:w&&w!=="none"?w:void 0,page:1})},y=w=>{r({...t,kind:w&&w!=="none"?w:void 0,page:1})},b=w=>{r({...t,priority:w&&w!=="none"?w:void 0,page:1})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Work Orders"}),e.jsx("p",{className:"text-muted-foreground",children:"Track maintenance and repair tasks"})]}),e.jsxs(K,{onClick:()=>{o(void 0),n(!0)},children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Create Work Order"]})]}),i&&!c?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading work orders..."})}):f?e.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:e.jsxs("p",{className:"text-lg text-destructive",children:["Error loading work orders: ",f.message]})}):e.jsxs(e.Fragment,{children:[e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsxs("div",{className:"flex gap-4 mb-6 flex-wrap",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(nn,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search by WO number or title...",className:"pl-9",value:t.search||"",onChange:w=>p(w.target.value)})]})}),e.jsxs(Nt,{value:t.status||"",onValueChange:g,children:[e.jsx(bt,{className:"w-[160px]",children:e.jsx(St,{placeholder:"Status"})}),e.jsx(_t,{children:ype.map(w=>e.jsx(ge,{value:w.value,children:w.label},w.value))})]}),e.jsxs(Nt,{value:t.kind||"",onValueChange:y,children:[e.jsx(bt,{className:"w-[160px]",children:e.jsx(St,{placeholder:"Type"})}),e.jsx(_t,{children:vpe.map(w=>e.jsx(ge,{value:w.value,children:w.label},w.value))})]}),e.jsxs(Nt,{value:t.priority||"",onValueChange:b,children:[e.jsx(bt,{className:"w-[160px]",children:e.jsx(St,{placeholder:"Priority"})}),e.jsx(_t,{children:jpe.map(w=>e.jsx(ge,{value:w.value,children:w.label},w.value))})]})]}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"WO #"}),e.jsx(se,{children:"Title"}),e.jsx(se,{children:"Asset"}),e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Priority"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Assigned To"}),e.jsx(se,{children:"Scheduled"}),e.jsx(se,{className:"text-right",children:"Actions"})]})}),e.jsx(lr,{children:c==null?void 0:c.data.map(w=>{var T,N;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:w.wo_num}),e.jsx(J,{children:e.jsx("div",{className:"max-w-[200px] truncate",children:w.title})}),e.jsx(J,{className:"text-muted-foreground",children:((T=w.asset)==null?void 0:T.name)||"-"}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",className:"uppercase",children:w.kind})}),e.jsx(J,{children:e.jsx(Ae,{className:_pe[w.priority],children:w.priority})}),e.jsx(J,{children:e.jsx(Ae,{className:bpe[w.status],children:w.status.replace("_"," ")})}),e.jsx(J,{className:"text-muted-foreground",children:((N=w.assigned_to_user)==null?void 0:N.name)||"Unassigned"}),e.jsx(J,{className:"text-muted-foreground",children:w.scheduled_for?new Date(w.scheduled_for).toLocaleDateString():"-"}),e.jsx(J,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(Pn,{to:`/cmms/work-orders/${w.id}`,children:e.jsx(K,{variant:"ghost",size:"sm",children:"View"})}),e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>{o(w),n(!0)},children:e.jsx(ki,{className:"h-4 w-4"})})]})})]},w.id)})})]})}),(c==null?void 0:c.data.length)===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center p-12",children:[e.jsx(Nn,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No work orders found"}),e.jsxs(K,{onClick:()=>{o(void 0),n(!0)},children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Create Your First Work Order"]})]}),c&&c.total>0&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",c.from," to ",c.to," of ",c.total," work orders"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{variant:"outline",size:"sm",disabled:c.current_page===1,onClick:()=>r({...t,page:(t.page||1)-1}),children:"Previous"}),e.jsx(K,{variant:"outline",size:"sm",disabled:c.current_page===c.last_page,onClick:()=>r({...t,page:(t.page||1)+1}),children:"Next"})]})]})]})}),e.jsx(gpe,{open:s,onOpenChange:w=>{n(w),w||o(void 0)},workOrder:a})]})]})}function Npe({open:t,onOpenChange:r,part:s}){const n=yr(),a=!!s,{register:o,handleSubmit:c,reset:i,formState:{errors:f}}=Ya({defaultValues:s?{code:s.code,name:s.name,category:s.category,description:s.description||void 0,unit:s.unit,unit_cost:s.unit_cost||void 0,reorder_level:s.reorder_level||void 0,supplier_id:s.supplier_id||void 0}:{}}),p=gt({mutationFn:b=>RS.createPart(b),onSuccess:()=>{n.invalidateQueries({queryKey:["parts"]}),Me.success("Part created successfully"),r(!1),i()},onError:b=>{var w,T;Me.error(((T=(w=b.response)==null?void 0:w.data)==null?void 0:T.message)||"Failed to create part")}}),g=gt({mutationFn:b=>RS.updatePart(s.id,b),onSuccess:()=>{n.invalidateQueries({queryKey:["parts"]}),n.invalidateQueries({queryKey:["part",s.id]}),Me.success("Part updated successfully"),r(!1)},onError:b=>{var w,T;Me.error(((T=(w=b.response)==null?void 0:w.data)==null?void 0:T.message)||"Failed to update part")}}),y=b=>{a?g.mutate(b):p.mutate(b)};return A.useEffect(()=>{i(s?{code:s.code,name:s.name,category:s.category,description:s.description||void 0,unit:s.unit,unit_cost:s.unit_cost||void 0,reorder_level:s.reorder_level||void 0,supplier_id:s.supplier_id||void 0}:{})},[s,i]),e.jsx(Qt,{open:t,onOpenChange:r,children:e.jsxs(Zt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:a?"Edit Part":"Create New Part"}),e.jsx(Es,{children:a?"Update part information":"Add a new part to inventory"})]}),e.jsxs("form",{onSubmit:c(y),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"code",children:"Part Code *"}),e.jsx(Ie,{id:"code",...o("code",{required:!0}),placeholder:"e.g., PIPE-100MM"}),f.code&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"category",children:"Category *"}),e.jsx(Ie,{id:"category",...o("category",{required:!0}),placeholder:"e.g., Pipes, Fittings, Valves"}),f.category&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"name",children:"Part Name *"}),e.jsx(Ie,{id:"name",...o("name",{required:!0}),placeholder:"e.g., PVC Pipe 100mm x 6m"}),f.name&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"description",children:"Description"}),e.jsx(ws,{id:"description",...o("description"),placeholder:"Part description and specifications...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"unit",children:"Unit *"}),e.jsx(Ie,{id:"unit",...o("unit",{required:!0}),placeholder:"e.g., pcs, m, kg"}),f.unit&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"unit_cost",children:"Unit Cost"}),e.jsx(Ie,{id:"unit_cost",type:"number",step:"0.01",...o("unit_cost",{valueAsNumber:!0}),placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"reorder_level",children:"Reorder Level"}),e.jsx(Ie,{id:"reorder_level",type:"number",...o("reorder_level",{valueAsNumber:!0}),placeholder:"Minimum stock"})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:p.isPending||g.isPending,children:p.isPending||g.isPending?"Saving...":a?"Update":"Create"})]})]})]})})}function Spe(){const[t,r]=A.useState({per_page:15,page:1}),[s,n]=A.useState(!1),[a,o]=A.useState(),{data:c,isLoading:i,error:f}=it({queryKey:["parts",t],queryFn:()=>RS.getParts(t)}),p=g=>{r({...t,search:g,page:1})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Parts Inventory"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage spare parts and supplies"})]}),e.jsxs(K,{onClick:()=>{o(void 0),n(!0)},children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Add Part"]})]}),i&&!c?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading parts..."})}):f?e.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:e.jsxs("p",{className:"text-lg text-destructive",children:["Error loading parts: ",f.message]})}):e.jsxs(e.Fragment,{children:[e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("div",{className:"flex gap-4 mb-6",children:e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(nn,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search by code, name, or category...",className:"pl-9",value:t.search||"",onChange:g=>p(g.target.value)})]})})}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Code"}),e.jsx(se,{children:"Name"}),e.jsx(se,{children:"Category"}),e.jsx(se,{children:"Unit"}),e.jsx(se,{children:"Unit Cost"}),e.jsx(se,{children:"Stock Level"}),e.jsx(se,{children:"Reorder Level"}),e.jsx(se,{children:"Status"}),e.jsx(se,{className:"text-right",children:"Actions"})]})}),e.jsx(lr,{children:c==null?void 0:c.data.map(g=>{const y=g.stock_balance||0,b=g.reorder_level||0,w=y<=b;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:g.code}),e.jsx(J,{children:g.name}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",className:"capitalize",children:g.category})}),e.jsx(J,{className:"text-muted-foreground",children:g.unit}),e.jsx(J,{className:"text-muted-foreground",children:g.unit_cost?`$${g.unit_cost.toFixed(2)}`:"-"}),e.jsx(J,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[w&&y>0&&e.jsx(Fr,{className:"h-4 w-4 text-orange-500"}),e.jsx("span",{className:w?"text-orange-500 font-medium":"",children:y})]})}),e.jsx(J,{className:"text-muted-foreground",children:b||"-"}),e.jsx(J,{children:y===0?e.jsx(Ae,{className:"bg-red-100 text-red-800",children:"Out of Stock"}):w?e.jsx(Ae,{className:"bg-orange-100 text-orange-800",children:"Low Stock"}):e.jsx(Ae,{className:"bg-green-100 text-green-800",children:"In Stock"})}),e.jsx(J,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{variant:"ghost",size:"sm",children:"View"}),e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>{o(g),n(!0)},children:e.jsx(ki,{className:"h-4 w-4"})})]})})]},g.id)})})]})}),(c==null?void 0:c.data.length)===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center p-12",children:[e.jsx(zo,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No parts found"}),e.jsxs(K,{onClick:()=>{o(void 0),n(!0)},children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Add Your First Part"]})]}),c&&c.total>0&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",c.from," to ",c.to," of ",c.total," parts"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{variant:"outline",size:"sm",disabled:c.current_page===1,onClick:()=>r({...t,page:(t.page||1)-1}),children:"Previous"}),e.jsx(K,{variant:"outline",size:"sm",disabled:c.current_page===c.last_page,onClick:()=>r({...t,page:(t.page||1)+1}),children:"Next"})]})]})]})}),e.jsx(Npe,{open:s,onOpenChange:g=>{n(g),g||o(void 0)},part:a})]})]})}const Fh={active:"#22c55e",inactive:"#9ca3af",retired:"#ef4444",under_maintenance:"#eab308"},r$={active:"Active",inactive:"Inactive",retired:"Retired",under_maintenance:"Under Maintenance"},s$={Pumps:{shape:"circle",label:"P"},Valves:{shape:"diamond",label:"V"},"Pressure Reducing Valves":{shape:"diamond",label:"PRV"},"Flow Meters":{shape:"square",label:"M"},"Electromagnetic Flow Meter":{shape:"square",label:"EM"},"Reservoirs & Tanks":{shape:"hexagon",label:"T"},Chlorinators:{shape:"triangle",label:"C"},"Data Logger / RTU":{shape:"octagon",label:"DL"},"Borehole / Well":{shape:"circle-dot",label:"BH"},"Water Kiosk":{shape:"house",label:"K"},Unknown:{shape:"circle",label:"?"}},Cpe={Turkana:{center:[35.5,3.5],zoom:7},Wajir:{center:[40,1.5],zoom:7},Marsabit:{center:[37.5,2.5],zoom:7},Mandera:{center:[40.5,3.5],zoom:7},Garissa:{center:[39.5,-.5],zoom:7}},Ppe={center:[37.5,1],zoom:6};function kpe({asset:t,isSelected:r,onClick:s,onHover:n}){var g;const a=((g=t.asset_class)==null?void 0:g.name)||"Unknown",o=t.status||"inactive",c=Fh[o]||Fh.inactive,i=s$[a]||s$.Unknown,f=r?32:26,p=()=>{switch(i.shape){case"circle":return e.jsx("div",{className:"flex items-center justify-center",style:{width:f,height:f,backgroundColor:c,borderRadius:"50%",border:"3px solid white",boxShadow:"0 2px 6px rgba(0,0,0,0.3)"},children:e.jsx("span",{className:"text-white text-[10px] font-bold",children:i.label})});case"diamond":return e.jsx("div",{className:"flex items-center justify-center",style:{width:f*.85,height:f*.85,backgroundColor:c,borderRadius:"4px",transform:"rotate(45deg)",border:"3px solid white",boxShadow:"0 2px 6px rgba(0,0,0,0.3)"},children:e.jsx("span",{className:"text-white text-[9px] font-bold",style:{transform:"rotate(-45deg)"},children:i.label})});case"square":return e.jsx("div",{className:"flex items-center justify-center",style:{width:f,height:f,backgroundColor:c,borderRadius:"4px",border:"3px solid white",boxShadow:"0 2px 6px rgba(0,0,0,0.3)"},children:e.jsx("span",{className:"text-white text-[10px] font-bold",children:i.label})});case"hexagon":return e.jsx("div",{className:"flex items-center justify-center",style:{width:f*1.1,height:f,backgroundColor:c,borderRadius:"6px",border:"3px solid white",boxShadow:"0 2px 6px rgba(0,0,0,0.3)"},children:e.jsx("span",{className:"text-white text-[10px] font-bold",children:i.label})});case"triangle":return e.jsx("div",{className:"flex items-center justify-center",style:{width:0,height:0,borderLeft:`${f/2}px solid transparent`,borderRight:`${f/2}px solid transparent`,borderBottom:`${f}px solid ${c}`,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"}});case"circle-dot":return e.jsx("div",{className:"flex items-center justify-center",style:{width:f,height:f,backgroundColor:c,borderRadius:"50%",border:"3px solid white",boxShadow:"0 2px 6px rgba(0,0,0,0.3)"},children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})});case"house":return e.jsxs("div",{className:"flex flex-col items-center",style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"},children:[e.jsx("div",{style:{width:0,height:0,borderLeft:`${f/2}px solid transparent`,borderRight:`${f/2}px solid transparent`,borderBottom:`${f/2}px solid ${c}`}}),e.jsx("div",{style:{width:f*.8,height:f*.6,backgroundColor:c,marginTop:"-1px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("span",{className:"text-white text-[9px] font-bold",children:i.label})})]});case"octagon":return e.jsx("div",{className:"flex items-center justify-center",style:{width:f,height:f,backgroundColor:c,borderRadius:"30%",border:"3px solid white",boxShadow:"0 2px 6px rgba(0,0,0,0.3)"},children:e.jsx("span",{className:"text-white text-[8px] font-bold",children:i.label})});default:return e.jsx("div",{className:"flex items-center justify-center",style:{width:f,height:f,backgroundColor:c,borderRadius:"50%",border:"3px solid white",boxShadow:"0 2px 6px rgba(0,0,0,0.3)"},children:e.jsx(Gn,{className:"h-3 w-3 text-white"})})}};return t.geom?e.jsx(BC,{longitude:t.geom.coordinates[0],latitude:t.geom.coordinates[1],anchor:"center",children:e.jsx("div",{className:"cursor-pointer hover:scale-110 transition-transform",onClick:s,onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:p()})}):null}function Ape(){var w,T,N;const[t,r]=A.useState(null),[s,n]=A.useState(null),{tenant:a}=Lm(),o=(a==null?void 0:a.name)||(a==null?void 0:a.county)||"",c=Cpe[o]||Ppe,[i,f]=A.useState({longitude:c.center[0],latitude:c.center[1],zoom:c.zoom}),{data:p,isLoading:g}=it({queryKey:["assets-with-geom"],queryFn:()=>_i.getAssets({per_page:1e3})}),y=A.useMemo(()=>{var M;return((M=p==null?void 0:p.data)==null?void 0:M.filter(O=>O.geom))||[]},[p]);A.useMemo(()=>{const M=new Set;return y.forEach(O=>{var C;M.add(((C=O.asset_class)==null?void 0:C.name)||"Unknown")}),Array.from(M).sort()},[y]),A.useEffect(()=>{if(y.length>0){const M=y.map(L=>L.geom.coordinates[0]),O=y.map(L=>L.geom.coordinates[1]),C=(Math.min(...M)+Math.max(...M))/2,D=(Math.min(...O)+Math.max(...O))/2;f(L=>({...L,longitude:C,latitude:D,zoom:10}))}},[y]);const b=M=>{switch(M){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-gray-100 text-gray-800";case"retired":return"bg-red-100 text-red-800";case"under_maintenance":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"relative h-[calc(100vh-8rem)]",children:[e.jsx("div",{className:"absolute top-4 left-4 z-10",children:e.jsx(H,{className:"bg-white/95 backdrop-blur-sm max-w-[220px]",children:e.jsxs(X,{className:"p-3",children:[e.jsxs("h2",{className:"text-sm font-bold mb-1 flex items-center gap-2",children:[e.jsx(Gn,{className:"h-4 w-4"}),"Assets Map"]}),o&&e.jsxs("p",{className:"text-xs text-muted-foreground mb-2",children:[o," County"]}),e.jsx("p",{className:"text-xs font-semibold text-muted-foreground mb-1.5 border-b pb-1",children:"Asset Types"}),e.jsxs("div",{className:"space-y-1 mb-3 max-h-[140px] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-400 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-[7px] font-bold",children:"P"})}),e.jsx("span",{className:"text-xs",children:"Pumps"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3.5 h-3.5 rounded bg-gray-400 flex items-center justify-center",style:{transform:"rotate(45deg)"},children:e.jsx("span",{className:"text-white text-[6px] font-bold",style:{transform:"rotate(-45deg)"},children:"V"})}),e.jsx("span",{className:"text-xs",children:"Valves"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gray-400 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-[7px] font-bold",children:"M"})}),e.jsx("span",{className:"text-xs",children:"Flow Meters"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-5 h-4 rounded-md bg-gray-400 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-[7px] font-bold",children:"T"})}),e.jsx("span",{className:"text-xs",children:"Reservoirs & Tanks"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{style:{width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent",borderBottom:"12px solid #9ca3af"}}),e.jsx("span",{className:"text-xs",children:"Chlorinators"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-400 flex items-center justify-center",children:e.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full"})}),e.jsx("span",{className:"text-xs",children:"Borehole / Well"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{style:{width:0,height:0,borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderBottom:"6px solid #9ca3af"}}),e.jsx("div",{className:"w-3 h-2 bg-gray-400 -mt-px flex items-center justify-center",children:e.jsx("span",{className:"text-white text-[5px] font-bold",children:"K"})})]}),e.jsx("span",{className:"text-xs",children:"Water Kiosk"})]})]}),e.jsx("p",{className:"text-xs font-semibold text-muted-foreground mb-1.5 border-b pb-1",children:"Status Colors"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:Fh.active}}),e.jsx("span",{className:"text-xs",children:"Active"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:Fh.inactive}}),e.jsx("span",{className:"text-xs",children:"Inactive"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:Fh.under_maintenance}}),e.jsx("span",{className:"text-xs",children:"Under Maintenance"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:Fh.retired}}),e.jsx("span",{className:"text-xs",children:"Retired"})]})]}),e.jsxs("div",{className:"mt-2 pt-2 border-t",children:[e.jsxs("p",{className:"text-xs font-medium",children:[y.length," assets on map"]}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:[(((w=p==null?void 0:p.data)==null?void 0:w.length)||0)-y.length," without location"]})]})]})})}),t&&e.jsx("div",{className:"absolute top-4 right-4 z-10 w-80",children:e.jsx(H,{className:"bg-white/95 backdrop-blur-sm",children:e.jsxs(X,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:t.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.code})]}),e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>r(null),children:e.jsx(Ko,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Status"}),e.jsx(Ae,{className:b(t.status),children:r$[t.status]||t.status})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Asset Class"}),e.jsx("span",{className:"text-sm font-medium",children:((T=t.asset_class)==null?void 0:T.name)||"Unknown"})]}),t.manufacturer&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Manufacturer"}),e.jsx("span",{className:"text-sm",children:t.manufacturer})]}),t.model&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Model"}),e.jsx("span",{className:"text-sm",children:t.model})]}),t.install_date&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Install Date"}),e.jsx("span",{className:"text-sm",children:new Date(t.install_date).toLocaleDateString()})]}),t.geom&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Coordinates"}),e.jsxs("span",{className:"text-xs flex items-center gap-1",children:[e.jsx(fn,{className:"h-3 w-3"}),t.geom.coordinates[1].toFixed(4),", ",t.geom.coordinates[0].toFixed(4)]})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t space-y-2",children:[e.jsx(Pn,{to:`/core/assets/${t.id}`,children:e.jsxs(K,{className:"w-full",size:"sm",children:[e.jsx(ki,{className:"h-4 w-4 mr-2"}),"View / Edit Asset"]})}),e.jsx(Pn,{to:`/cmms/work-orders?asset_id=${t.id}`,children:e.jsxs(K,{variant:"outline",className:"w-full",size:"sm",children:[e.jsx(Vc,{className:"h-4 w-4 mr-2"}),"View Work Orders"]})})]})]})})}),g&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/50 z-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading assets..."})]})}),e.jsxs(Pm,{...i,onMove:M=>f(M.viewState),mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",style:{width:"100%",height:"100%"},children:[e.jsx(km,{position:"top-right"}),e.jsx(yv,{position:"bottom-left"}),y.map(M=>e.jsx(kpe,{asset:M,isSelected:(t==null?void 0:t.id)===M.id,onClick:()=>r(M),onHover:O=>n(O?M:null)},M.id)),s&&!t&&s.geom&&e.jsx(OS,{longitude:s.geom.coordinates[0],latitude:s.geom.coordinates[1],closeButton:!1,closeOnClick:!1,anchor:"bottom",offset:15,children:e.jsxs("div",{className:"p-1 min-w-[150px]",children:[e.jsx("p",{className:"font-semibold text-sm",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.code}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-xs",children:((N=s.asset_class)==null?void 0:N.name)||"Unknown"}),e.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:Fh[s.status]||Fh.inactive}}),e.jsx("span",{className:"text-xs",children:r$[s.status]||s.status})]})]})})]})]})}const Ar="/cmms",u0={getJobPlans:t=>{const r={};return t!=null&&t.search&&(r.search=t.search),t!=null&&t.status&&(r.status=t.status),t!=null&&t.page&&(r.page=t.page.toString()),t!=null&&t.per_page&&(r.per_page=t.per_page.toString()),pe.get(`${Ar}/job-plans`,r)},getJobPlan:t=>pe.get(`${Ar}/job-plans/${t}`),createJobPlan:t=>pe.post(`${Ar}/job-plans`,t),updateJobPlan:(t,r)=>pe.put(`${Ar}/job-plans/${t}`,r),deleteJobPlan:t=>pe.delete(`${Ar}/job-plans/${t}`),createVersion:t=>pe.post(`${Ar}/job-plans/${t}/version`),activate:t=>pe.post(`${Ar}/job-plans/${t}/activate`)},iN={getTemplates:t=>{const r={};return t!=null&&t.asset_class_id&&(r.asset_class_id=t.asset_class_id.toString()),(t==null?void 0:t.is_active)!==void 0&&(r.is_active=t.is_active.toString()),t!=null&&t.page&&(r.page=t.page.toString()),t!=null&&t.per_page&&(r.per_page=t.per_page.toString()),pe.get(`${Ar}/pm/templates`,r)},getTemplate:t=>pe.get(`${Ar}/pm/templates/${t}`),createTemplate:t=>pe.post(`${Ar}/pm/templates`,t),updateTemplate:(t,r)=>pe.put(`${Ar}/pm/templates/${t}`,r),deleteTemplate:t=>pe.delete(`${Ar}/pm/templates/${t}`),generateWorkOrders:t=>pe.post(`${Ar}/pm/generate`,t),deferPm:(t,r)=>pe.post(`${Ar}/pm/logs/${t}/defer`,r),getCompliance:t=>{const r={};return t!=null&&t.period_start&&(r.period_start=t.period_start),t!=null&&t.period_end&&(r.period_end=t.period_end),pe.get(`${Ar}/pm/compliance`,r)}},eT={getTags:t=>{const r={};return t!=null&&t.asset_id&&(r.asset_id=t.asset_id.toString()),(t==null?void 0:t.is_active)!==void 0&&(r.is_active=t.is_active.toString()),t!=null&&t.page&&(r.page=t.page.toString()),t!=null&&t.per_page&&(r.per_page=t.per_page.toString()),pe.get(`${Ar}/condition-monitoring/tags`,r)},getTag:t=>pe.get(`${Ar}/condition-monitoring/tags/${t}`),createTag:t=>pe.post(`${Ar}/condition-monitoring/tags`,t),updateTag:(t,r)=>pe.put(`${Ar}/condition-monitoring/tags/${t}`,r),deleteTag:t=>pe.delete(`${Ar}/condition-monitoring/tags/${t}`),ingestReading:(t,r)=>pe.post(`${Ar}/condition-monitoring/tags/${t}/readings`,r),acknowledgeAlarm:(t,r)=>pe.post(`${Ar}/condition-monitoring/alarms/${t}/acknowledge`,r),clearAlarm:t=>pe.post(`${Ar}/condition-monitoring/alarms/${t}/clear`),getAssetHealth:t=>pe.get(`${Ar}/condition-monitoring/assets/${t}/health`),evaluateRules:()=>pe.post(`${Ar}/condition-monitoring/rules/evaluate`)},oN={getStores:t=>{const r={};return t!=null&&t.type&&(r.type=t.type),t!=null&&t.page&&(r.page=t.page.toString()),t!=null&&t.per_page&&(r.per_page=t.per_page.toString()),pe.get(`${Ar}/stores`,r)},getStore:t=>pe.get(`${Ar}/stores/${t}`),createStore:t=>pe.post(`${Ar}/stores`,t),updateStore:(t,r)=>pe.put(`${Ar}/stores/${t}`,r),createBin:(t,r)=>pe.post(`${Ar}/stores/${t}/bins`,r),receiveStock:t=>pe.post(`${Ar}/stores/receive`,t),issueStock:t=>pe.post(`${Ar}/stores/issue`,t),getValuation:()=>pe.get(`${Ar}/stores/valuation`),getLowStock:()=>pe.get(`${Ar}/stores/low-stock`)},lN={getFleetAssets:t=>{const r={};return t!=null&&t.type&&(r.type=t.type),t!=null&&t.status&&(r.status=t.status),t!=null&&t.page&&(r.page=t.page.toString()),t!=null&&t.per_page&&(r.per_page=t.per_page.toString()),pe.get(`${Ar}/fleet`,r)},getFleetAsset:t=>pe.get(`${Ar}/fleet/${t}`),createFleetAsset:t=>pe.post(`${Ar}/fleet`,t),updateFleetAsset:(t,r)=>pe.put(`${Ar}/fleet/${t}`,r),createServiceSchedule:(t,r)=>pe.post(`${Ar}/fleet/${t}/service-schedules`,r),logFuel:(t,r)=>pe.post(`${Ar}/fleet/${t}/fuel-logs`,r),logUptime:(t,r)=>pe.post(`${Ar}/fleet/${t}/uptime-logs`,r),getUtilization:t=>{const r={};return t!=null&&t.from_date&&(r.from_date=t.from_date),t!=null&&t.to_date&&(r.to_date=t.to_date),pe.get(`${Ar}/fleet/utilization`,r)},getFuelEfficiency:(t,r)=>{const s={};return r!=null&&r.from_date&&(s.from_date=r.from_date),r!=null&&r.to_date&&(s.to_date=r.to_date),pe.get(`${Ar}/fleet/${t}/fuel-efficiency`,s)}},h0={getContracts:t=>{const r={};return t!=null&&t.status&&(r.status=t.status),t!=null&&t.type&&(r.type=t.type),t!=null&&t.page&&(r.page=t.page.toString()),t!=null&&t.per_page&&(r.per_page=t.per_page.toString()),pe.get(`${Ar}/contractors/contracts`,r)},getContract:t=>pe.get(`${Ar}/contractors/contracts/${t}`),createContract:t=>pe.post(`${Ar}/contractors/contracts`,t),updateContract:(t,r)=>pe.put(`${Ar}/contractors/contracts/${t}`,r),recordViolation:(t,r)=>pe.post(`${Ar}/contractors/contracts/${t}/violations`,r),recordPayment:(t,r)=>pe.post(`${Ar}/contractors/contracts/${t}/payments`,r),getVendorScore:t=>{const r={};return t!=null&&t.vendor_name&&(r.vendor_name=t.vendor_name),t!=null&&t.period_start&&(r.period_start=t.period_start),t!=null&&t.period_end&&(r.period_end=t.period_end),pe.get(`${Ar}/contractors/vendor-score`,r)},getActiveContracts:()=>pe.get(`${Ar}/contractors/active`),getExpiringContracts:t=>{const r={};return t!=null&&t.days&&(r.days=t.days.toString()),pe.get(`${Ar}/contractors/expiring`,r)}},Mf={getPermits:t=>{const r={};return t!=null&&t.status&&(r.status=t.status),t!=null&&t.permit_type&&(r.permit_type=t.permit_type),t!=null&&t.page&&(r.page=t.page.toString()),t!=null&&t.per_page&&(r.per_page=t.per_page.toString()),pe.get(`${Ar}/hse/permits`,r)},getPermit:t=>pe.get(`${Ar}/hse/permits/${t}`),createPermit:t=>pe.post(`${Ar}/hse/permits`,t),approvePermit:(t,r)=>pe.post(`${Ar}/hse/permits/${t}/approve`,r||{}),closePermit:t=>pe.post(`${Ar}/hse/permits/${t}/close`),createRiskAssessment:t=>pe.post(`${Ar}/hse/risk-assessments`,t),updateRiskAssessment:(t,r)=>pe.put(`${Ar}/hse/risk-assessments/${t}`,r),getIncidents:t=>{const r={};return t!=null&&t.category&&(r.category=t.category),t!=null&&t.severity&&(r.severity=t.severity),t!=null&&t.status&&(r.status=t.status),t!=null&&t.page&&(r.page=t.page.toString()),t!=null&&t.per_page&&(r.per_page=t.per_page.toString()),pe.get(`${Ar}/hse/incidents`,r)},createIncident:t=>pe.post(`${Ar}/hse/incidents`,t),investigateIncident:(t,r)=>pe.post(`${Ar}/hse/incidents/${t}/investigate`,r),closeIncident:t=>pe.post(`${Ar}/hse/incidents/${t}/close`),getIncidentStats:t=>{const r={};return t!=null&&t.from_date&&(r.from_date=t.from_date),t!=null&&t.to_date&&(r.to_date=t.to_date),pe.get(`${Ar}/hse/incidents/stats`,r)},getCapas:t=>{const r={};return t!=null&&t.status&&(r.status=t.status),t!=null&&t.page&&(r.page=t.page.toString()),t!=null&&t.per_page&&(r.per_page=t.per_page.toString()),pe.get(`${Ar}/hse/capas`,r)},createCapa:t=>pe.post(`${Ar}/hse/capas`,t),completeCapa:(t,r)=>pe.post(`${Ar}/hse/capas/${t}/complete`,r)},Tpe={draft:"bg-gray-100 text-gray-800",active:"bg-green-100 text-green-800",archived:"bg-orange-100 text-orange-800"};function Epe(){var T;const[t,r]=A.useState({page:1,per_page:15,search:"",status:"all"}),[s,n]=A.useState(!1),[a,o]=A.useState(null),c=yr(),{data:i,isLoading:f}=it({queryKey:["job-plans",t],queryFn:()=>u0.getJobPlans(t)}),p=gt({mutationFn:u0.createJobPlan,onSuccess:()=>{c.invalidateQueries({queryKey:["job-plans"]}),n(!1),Me.success("Job plan created successfully")}}),g=gt({mutationFn:({id:N,data:M})=>u0.updateJobPlan(N,M),onSuccess:()=>{c.invalidateQueries({queryKey:["job-plans"]}),n(!1),o(null),Me.success("Job plan updated successfully")}}),y=gt({mutationFn:u0.activate,onSuccess:()=>{c.invalidateQueries({queryKey:["job-plans"]}),Me.success("Job plan activated")}}),b=gt({mutationFn:u0.createVersion,onSuccess:()=>{c.invalidateQueries({queryKey:["job-plans"]}),Me.success("New version created")}}),w=N=>{N.preventDefault();const M=new FormData(N.currentTarget),O={code:M.get("code"),name:M.get("name"),description:M.get("description"),sop:M.get("sop"),estimated_hours:parseFloat(M.get("estimated_hours")),status:M.get("status")||"draft"};a?g.mutate({id:a.id,data:O}):p.mutate(O)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Job Plans"}),e.jsx("p",{className:"text-muted-foreground",children:"Standardized work procedures and checklists"})]}),e.jsxs(Qt,{open:s,onOpenChange:n,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{onClick:()=>o(null),children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"New Job Plan"]})}),e.jsxs(Zt,{className:"max-w-2xl",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:a?"Edit Job Plan":"Create Job Plan"})}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"code",children:"Job Plan Code"}),e.jsx(Ie,{id:"code",name:"code",defaultValue:a==null?void 0:a.code,required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"status",children:"Status"}),e.jsxs(Nt,{name:"status",defaultValue:(a==null?void 0:a.status)||"draft",children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"draft",children:"Draft"}),e.jsx(ge,{value:"active",children:"Active"}),e.jsx(ge,{value:"archived",children:"Archived"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"name",children:"Name"}),e.jsx(Ie,{id:"name",name:"name",defaultValue:a==null?void 0:a.name,required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"description",children:"Description"}),e.jsx(ws,{id:"description",name:"description",defaultValue:a==null?void 0:a.description,rows:3})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"sop",children:"Standard Operating Procedure"}),e.jsx(ws,{id:"sop",name:"sop",defaultValue:a==null?void 0:a.sop,rows:5,placeholder:"Step-by-step procedure..."})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"estimated_hours",children:"Estimated Hours"}),e.jsx(Ie,{id:"estimated_hours",name:"estimated_hours",type:"number",step:"0.5",defaultValue:a==null?void 0:a.estimated_hours})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:p.isPending||g.isPending,children:a?"Update":"Create"})]})]})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(Ie,{placeholder:"Search job plans...",value:t.search,onChange:N=>r({...t,search:N.target.value,page:1}),className:"pl-10"})]}),e.jsxs(Nt,{value:t.status,onValueChange:N=>r({...t,status:N,page:1}),children:[e.jsx(bt,{className:"w-[200px]",children:e.jsx(St,{placeholder:"All Statuses"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Statuses"}),e.jsx(ge,{value:"draft",children:"Draft"}),e.jsx(ge,{value:"active",children:"Active"}),e.jsx(ge,{value:"archived",children:"Archived"})]})]})]})}),e.jsx(X,{children:f?e.jsx("div",{className:"text-center py-8",children:"Loading..."}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Code"}),e.jsx(se,{children:"Name"}),e.jsx(se,{children:"Version"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Est. Hours"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:(T=i==null?void 0:i.data)==null?void 0:T.map(N=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono",children:N.code}),e.jsx(J,{className:"font-medium",children:N.name}),e.jsxs(J,{children:["v",N.version]}),e.jsx(J,{children:e.jsx(Ae,{className:Tpe[N.status],children:N.status})}),e.jsxs(J,{children:[N.estimated_hours||"","h"]}),e.jsx(J,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{size:"sm",variant:"outline",onClick:()=>{o(N),n(!0)},children:e.jsx(ki,{className:"h-4 w-4"})}),N.status==="draft"&&e.jsxs(K,{size:"sm",variant:"outline",onClick:()=>y.mutate(N.id),children:[e.jsx(Ns,{className:"h-4 w-4 mr-1"}),"Activate"]}),N.status==="active"&&e.jsxs(K,{size:"sm",variant:"outline",onClick:()=>b.mutate(N.id),children:[e.jsx(bs,{className:"h-4 w-4 mr-1"}),"New Version"]})]})})]},N.id))})]})})]})]})}function Mpe(){var N,M;const[t,r]=A.useState({page:1,per_page:15}),[s,n]=A.useState(!1),[a,o]=A.useState(null),c=yr(),{data:i,isLoading:f}=it({queryKey:["pm-templates",t],queryFn:()=>iN.getTemplates(t)}),{data:p}=it({queryKey:["pm-compliance"],queryFn:()=>iN.getCompliance({})}),g=gt({mutationFn:iN.createTemplate,onSuccess:()=>{c.invalidateQueries({queryKey:["pm-templates"]}),n(!1),Me.success("PM template created successfully")}}),y=gt({mutationFn:iN.generateWorkOrders,onSuccess:O=>{Me.success(`Generated ${O.generated} work orders`)}}),b=O=>{O.preventDefault();const C=new FormData(O.currentTarget),D={name:C.get("name"),description:C.get("description"),trigger_type:C.get("trigger_type"),frequency_days:parseInt(C.get("frequency_days")),tolerance_days:parseInt(C.get("tolerance_days")),is_active:!0};g.mutate(D)},w=p==null?void 0:p[0],T=(w==null?void 0:w.compliance_pct)||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Preventive Maintenance"}),e.jsx("p",{className:"text-muted-foreground",children:"Schedule and track preventive maintenance"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{variant:"outline",onClick:()=>y.mutate({}),disabled:y.isPending,children:[e.jsx(Ui,{className:"mr-2 h-4 w-4"}),"Generate Work Orders"]}),e.jsxs(Qt,{open:s,onOpenChange:n,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{onClick:()=>o(null),children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"New PM Template"]})}),e.jsxs(Zt,{className:"max-w-2xl",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Create PM Template"})}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"name",children:"Template Name"}),e.jsx(Ie,{id:"name",name:"name",required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"description",children:"Description"}),e.jsx(ws,{id:"description",name:"description",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"trigger_type",children:"Trigger Type"}),e.jsxs(Nt,{name:"trigger_type",defaultValue:"time_based",children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"time_based",children:"Time Based"}),e.jsx(ge,{value:"usage_based",children:"Usage Based"}),e.jsx(ge,{value:"combined",children:"Combined"})]})]})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"frequency_days",children:"Frequency (days)"}),e.jsx(Ie,{id:"frequency_days",name:"frequency_days",type:"number",defaultValue:"30",required:!0})]})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"tolerance_days",children:"Tolerance (days)"}),e.jsx(Ie,{id:"tolerance_days",name:"tolerance_days",type:"number",defaultValue:"7"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:g.isPending,children:"Create Template"})]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsx(he,{className:"text-sm font-medium",children:"PM Compliance"})}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[T.toFixed(1),"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"On-time completion"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsx(he,{className:"text-sm font-medium",children:"Scheduled"})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(w==null?void 0:w.pm_scheduled)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This period"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsx(he,{className:"text-sm font-medium",children:"Completed"})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:((w==null?void 0:w.pm_completed_on_time)||0)+((w==null?void 0:w.pm_completed_late)||0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total completed"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsx(he,{className:"text-sm font-medium",children:"PM/CM Ratio"})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:((N=w==null?void 0:w.pm_breakdown_ratio)==null?void 0:N.toFixed(2))||""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Target: > 4.0"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"PM Templates"})}),e.jsx(X,{children:f?e.jsx("div",{className:"text-center py-8",children:"Loading..."}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Name"}),e.jsx(se,{children:"Trigger Type"}),e.jsx(se,{children:"Frequency"}),e.jsx(se,{children:"Next Gen"}),e.jsx(se,{children:"Status"})]})}),e.jsx(lr,{children:(M=i==null?void 0:i.data)==null?void 0:M.map(O=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:O.name}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:O.trigger_type})}),e.jsxs(J,{children:[O.frequency_days," days"]}),e.jsx(J,{children:O.next_gen_date?new Date(O.next_gen_date).toLocaleDateString():""}),e.jsx(J,{children:e.jsx(Ae,{variant:O.is_active?"default":"secondary",children:O.is_active?"Active":"Inactive"})})]},O.id))})]})})]})]})}const n$=(t,r,s)=>{if(t&&"reportValidity"in t){const n=xr(s,r);t.setCustomValidity(n&&n.message||""),t.reportValidity()}},AM=(t,r)=>{for(const s in r.fields){const n=r.fields[s];n&&n.ref&&"reportValidity"in n.ref?n$(n.ref,s,t):n&&n.refs&&n.refs.forEach(a=>n$(a,s,t))}},a$=(t,r)=>{r.shouldUseNativeValidation&&AM(t,r);const s={};for(const n in t){const a=xr(r.fields,n),o=Object.assign(t[n]||{},{ref:a&&a.ref});if(Ope(r.names||Object.keys(t),n)){const c=Object.assign({},xr(s,n));rn(c,"root",o),rn(s,n,c)}else rn(s,n,o)}return s},Ope=(t,r)=>{const s=i$(r);return t.some(n=>i$(n).match(`^${s}\\.\\d+`))};function i$(t){return t.replace(/\]|\[/g,"")}function iK(t,r,s){function n(i,f){var p;Object.defineProperty(i,"_zod",{value:i._zod??{},enumerable:!1}),(p=i._zod).traits??(p.traits=new Set),i._zod.traits.add(t),r(i,f);for(const g in c.prototype)g in i||Object.defineProperty(i,g,{value:c.prototype[g].bind(i)});i._zod.constr=c,i._zod.def=f}const a=(s==null?void 0:s.Parent)??Object;class o extends a{}Object.defineProperty(o,"name",{value:t});function c(i){var f;const p=s!=null&&s.Parent?new o:this;n(p,i),(f=p._zod).deferred??(f.deferred=[]);for(const g of p._zod.deferred)g();return p}return Object.defineProperty(c,"init",{value:n}),Object.defineProperty(c,Symbol.hasInstance,{value:i=>{var f,p;return s!=null&&s.Parent&&i instanceof s.Parent?!0:(p=(f=i==null?void 0:i._zod)==null?void 0:f.traits)==null?void 0:p.has(t)}}),Object.defineProperty(c,"name",{value:t}),c}class Ipe extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const Dpe={};function oK(t){return Dpe}function Rpe(t,r){return typeof r=="bigint"?r.toString():r}const lK=Error.captureStackTrace?Error.captureStackTrace:(...t)=>{};function cN(t){return typeof t=="string"?t:t==null?void 0:t.message}function cK(t,r,s){var a,o,c,i,f,p;const n={...t,path:t.path??[]};if(!t.message){const g=cN((c=(o=(a=t.inst)==null?void 0:a._zod.def)==null?void 0:o.error)==null?void 0:c.call(o,t))??cN((i=r==null?void 0:r.error)==null?void 0:i.call(r,t))??cN((f=s.customError)==null?void 0:f.call(s,t))??cN((p=s.localeError)==null?void 0:p.call(s,t))??"Invalid input";n.message=g}return delete n.inst,delete n.continue,r!=null&&r.reportInput||delete n.input,n}const dK=(t,r)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:r,enumerable:!1}),Object.defineProperty(t,"message",{get(){return JSON.stringify(r,Rpe,2)},enumerable:!0}),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},Lpe=iK("$ZodError",dK),uK=iK("$ZodError",dK,{Parent:Error}),Fpe=t=>(r,s,n,a)=>{const o=n?Object.assign(n,{async:!1}):{async:!1},c=r._zod.run({value:s,issues:[]},o);if(c instanceof Promise)throw new Ipe;if(c.issues.length){const i=new((a==null?void 0:a.Err)??t)(c.issues.map(f=>cK(f,o,oK())));throw lK(i,a==null?void 0:a.callee),i}return c.value},$pe=Fpe(uK),zpe=t=>async(r,s,n,a)=>{const o=n?Object.assign(n,{async:!0}):{async:!0};let c=r._zod.run({value:s,issues:[]},o);if(c instanceof Promise&&(c=await c),c.issues.length){const i=new((a==null?void 0:a.Err)??t)(c.issues.map(f=>cK(f,o,oK())));throw lK(i,a==null?void 0:a.callee),i}return c.value},Bpe=zpe(uK);function o$(t,r){try{var s=t()}catch(n){return r(n)}return s&&s.then?s.then(void 0,r):s}function qpe(t,r){for(var s={};t.length;){var n=t[0],a=n.code,o=n.message,c=n.path.join(".");if(!s[c])if("unionErrors"in n){var i=n.unionErrors[0].errors[0];s[c]={message:i.message,type:i.code}}else s[c]={message:o,type:a};if("unionErrors"in n&&n.unionErrors.forEach(function(g){return g.errors.forEach(function(y){return t.push(y)})}),r){var f=s[c].types,p=f&&f[n.code];s[c]=nD(c,r,s,a,p?[].concat(p,n.message):n.message)}t.shift()}return s}function Vpe(t,r){for(var s={};t.length;){var n=t[0],a=n.code,o=n.message,c=n.path.join(".");if(!s[c])if(n.code==="invalid_union"&&n.errors.length>0){var i=n.errors[0][0];s[c]={message:i.message,type:i.code}}else s[c]={message:o,type:a};if(n.code==="invalid_union"&&n.errors.forEach(function(g){return g.forEach(function(y){return t.push(y)})}),r){var f=s[c].types,p=f&&f[n.code];s[c]=nD(c,r,s,a,p?[].concat(p,n.message):n.message)}t.shift()}return s}function Ed(t,r,s){if(s===void 0&&(s={}),function(n){return"_def"in n&&typeof n._def=="object"&&"typeName"in n._def}(t))return function(n,a,o){try{return Promise.resolve(o$(function(){return Promise.resolve(t[s.mode==="sync"?"parse":"parseAsync"](n,r)).then(function(c){return o.shouldUseNativeValidation&&AM({},o),{errors:{},values:s.raw?Object.assign({},n):c}})},function(c){if(function(i){return Array.isArray(i==null?void 0:i.issues)}(c))return{values:{},errors:a$(qpe(c.errors,!o.shouldUseNativeValidation&&o.criteriaMode==="all"),o)};throw c}))}catch(c){return Promise.reject(c)}};if(function(n){return"_zod"in n&&typeof n._zod=="object"}(t))return function(n,a,o){try{return Promise.resolve(o$(function(){return Promise.resolve((s.mode==="sync"?$pe:Bpe)(t,n,r)).then(function(c){return o.shouldUseNativeValidation&&AM({},o),{errors:{},values:s.raw?Object.assign({},n):c}})},function(c){if(function(i){return i instanceof Lpe}(c))return{values:{},errors:a$(Vpe(c.issues,!o.shouldUseNativeValidation&&o.criteriaMode==="all"),o)};throw c}))}catch(c){return Promise.reject(c)}};throw new Error("Invalid input: not a Zod schema")}var Js;(function(t){t.assertEqual=a=>{};function r(a){}t.assertIs=r;function s(a){throw new Error}t.assertNever=s,t.arrayToEnum=a=>{const o={};for(const c of a)o[c]=c;return o},t.getValidEnumValues=a=>{const o=t.objectKeys(a).filter(i=>typeof a[a[i]]!="number"),c={};for(const i of o)c[i]=a[i];return t.objectValues(c)},t.objectValues=a=>t.objectKeys(a).map(function(o){return a[o]}),t.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const o=[];for(const c in a)Object.prototype.hasOwnProperty.call(a,c)&&o.push(c);return o},t.find=(a,o)=>{for(const c of a)if(o(c))return c},t.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function n(a,o=" | "){return a.map(c=>typeof c=="string"?`'${c}'`:c).join(o)}t.joinValues=n,t.jsonStringifyReplacer=(a,o)=>typeof o=="bigint"?o.toString():o})(Js||(Js={}));var l$;(function(t){t.mergeShapes=(r,s)=>({...r,...s})})(l$||(l$={}));const Rr=Js.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),$h=t=>{switch(typeof t){case"undefined":return Rr.undefined;case"string":return Rr.string;case"number":return Number.isNaN(t)?Rr.nan:Rr.number;case"boolean":return Rr.boolean;case"function":return Rr.function;case"bigint":return Rr.bigint;case"symbol":return Rr.symbol;case"object":return Array.isArray(t)?Rr.array:t===null?Rr.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?Rr.promise:typeof Map<"u"&&t instanceof Map?Rr.map:typeof Set<"u"&&t instanceof Set?Rr.set:typeof Date<"u"&&t instanceof Date?Rr.date:Rr.object;default:return Rr.unknown}},hr=Js.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class qu extends Error{get errors(){return this.issues}constructor(r){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const s=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,s):this.__proto__=s,this.name="ZodError",this.issues=r}format(r){const s=r||function(o){return o.message},n={_errors:[]},a=o=>{for(const c of o.issues)if(c.code==="invalid_union")c.unionErrors.map(a);else if(c.code==="invalid_return_type")a(c.returnTypeError);else if(c.code==="invalid_arguments")a(c.argumentsError);else if(c.path.length===0)n._errors.push(s(c));else{let i=n,f=0;for(;f<c.path.length;){const p=c.path[f];f===c.path.length-1?(i[p]=i[p]||{_errors:[]},i[p]._errors.push(s(c))):i[p]=i[p]||{_errors:[]},i=i[p],f++}}};return a(this),n}static assert(r){if(!(r instanceof qu))throw new Error(`Not a ZodError: ${r}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Js.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(r=s=>s.message){const s={},n=[];for(const a of this.issues)if(a.path.length>0){const o=a.path[0];s[o]=s[o]||[],s[o].push(r(a))}else n.push(r(a));return{formErrors:n,fieldErrors:s}}get formErrors(){return this.flatten()}}qu.create=t=>new qu(t);const TM=(t,r)=>{let s;switch(t.code){case hr.invalid_type:t.received===Rr.undefined?s="Required":s=`Expected ${t.expected}, received ${t.received}`;break;case hr.invalid_literal:s=`Invalid literal value, expected ${JSON.stringify(t.expected,Js.jsonStringifyReplacer)}`;break;case hr.unrecognized_keys:s=`Unrecognized key(s) in object: ${Js.joinValues(t.keys,", ")}`;break;case hr.invalid_union:s="Invalid input";break;case hr.invalid_union_discriminator:s=`Invalid discriminator value. Expected ${Js.joinValues(t.options)}`;break;case hr.invalid_enum_value:s=`Invalid enum value. Expected ${Js.joinValues(t.options)}, received '${t.received}'`;break;case hr.invalid_arguments:s="Invalid function arguments";break;case hr.invalid_return_type:s="Invalid function return type";break;case hr.invalid_date:s="Invalid date";break;case hr.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(s=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(s=`${s} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?s=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?s=`Invalid input: must end with "${t.validation.endsWith}"`:Js.assertNever(t.validation):t.validation!=="regex"?s=`Invalid ${t.validation}`:s="Invalid";break;case hr.too_small:t.type==="array"?s=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?s=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?s=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?s=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?s=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:s="Invalid input";break;case hr.too_big:t.type==="array"?s=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?s=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?s=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?s=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?s=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:s="Invalid input";break;case hr.custom:s="Invalid input";break;case hr.invalid_intersection_types:s="Intersection results could not be merged";break;case hr.not_multiple_of:s=`Number must be a multiple of ${t.multipleOf}`;break;case hr.not_finite:s="Number must be finite";break;default:s=r.defaultError,Js.assertNever(t)}return{message:s}};let Upe=TM;function Wpe(){return Upe}const Gpe=t=>{const{data:r,path:s,errorMaps:n,issueData:a}=t,o=[...s,...a.path||[]],c={...a,path:o};if(a.message!==void 0)return{...a,path:o,message:a.message};let i="";const f=n.filter(p=>!!p).slice().reverse();for(const p of f)i=p(c,{data:r,defaultError:i}).message;return{...a,path:o,message:i}};function Sr(t,r){const s=Wpe(),n=Gpe({issueData:r,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,s,s===TM?void 0:TM].filter(a=>!!a)});t.common.issues.push(n)}class _l{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(r,s){const n=[];for(const a of s){if(a.status==="aborted")return hs;a.status==="dirty"&&r.dirty(),n.push(a.value)}return{status:r.value,value:n}}static async mergeObjectAsync(r,s){const n=[];for(const a of s){const o=await a.key,c=await a.value;n.push({key:o,value:c})}return _l.mergeObjectSync(r,n)}static mergeObjectSync(r,s){const n={};for(const a of s){const{key:o,value:c}=a;if(o.status==="aborted"||c.status==="aborted")return hs;o.status==="dirty"&&r.dirty(),c.status==="dirty"&&r.dirty(),o.value!=="__proto__"&&(typeof c.value<"u"||a.alwaysSet)&&(n[o.value]=c.value)}return{status:r.value,value:n}}}const hs=Object.freeze({status:"aborted"}),M0=t=>({status:"dirty",value:t}),sc=t=>({status:"valid",value:t}),c$=t=>t.status==="aborted",d$=t=>t.status==="dirty",wy=t=>t.status==="valid",zS=t=>typeof Promise<"u"&&t instanceof Promise;var $r;(function(t){t.errToObj=r=>typeof r=="string"?{message:r}:r||{},t.toString=r=>typeof r=="string"?r:r==null?void 0:r.message})($r||($r={}));class Tm{constructor(r,s,n,a){this._cachedPath=[],this.parent=r,this.data=s,this._path=n,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const u$=(t,r)=>{if(wy(r))return{success:!0,data:r.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const s=new qu(t.common.issues);return this._error=s,this._error}}};function ks(t){if(!t)return{};const{errorMap:r,invalid_type_error:s,required_error:n,description:a}=t;if(r&&(s||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return r?{errorMap:r,description:a}:{errorMap:(c,i)=>{const{message:f}=t;return c.code==="invalid_enum_value"?{message:f??i.defaultError}:typeof i.data>"u"?{message:f??n??i.defaultError}:c.code!=="invalid_type"?{message:i.defaultError}:{message:f??s??i.defaultError}},description:a}}class Xs{get description(){return this._def.description}_getType(r){return $h(r.data)}_getOrReturnCtx(r,s){return s||{common:r.parent.common,data:r.data,parsedType:$h(r.data),schemaErrorMap:this._def.errorMap,path:r.path,parent:r.parent}}_processInputParams(r){return{status:new _l,ctx:{common:r.parent.common,data:r.data,parsedType:$h(r.data),schemaErrorMap:this._def.errorMap,path:r.path,parent:r.parent}}}_parseSync(r){const s=this._parse(r);if(zS(s))throw new Error("Synchronous parse encountered promise.");return s}_parseAsync(r){const s=this._parse(r);return Promise.resolve(s)}parse(r,s){const n=this.safeParse(r,s);if(n.success)return n.data;throw n.error}safeParse(r,s){const n={common:{issues:[],async:(s==null?void 0:s.async)??!1,contextualErrorMap:s==null?void 0:s.errorMap},path:(s==null?void 0:s.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:r,parsedType:$h(r)},a=this._parseSync({data:r,path:n.path,parent:n});return u$(n,a)}"~validate"(r){var n,a;const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:r,parsedType:$h(r)};if(!this["~standard"].async)try{const o=this._parseSync({data:r,path:[],parent:s});return wy(o)?{value:o.value}:{issues:s.common.issues}}catch(o){(a=(n=o==null?void 0:o.message)==null?void 0:n.toLowerCase())!=null&&a.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:r,path:[],parent:s}).then(o=>wy(o)?{value:o.value}:{issues:s.common.issues})}async parseAsync(r,s){const n=await this.safeParseAsync(r,s);if(n.success)return n.data;throw n.error}async safeParseAsync(r,s){const n={common:{issues:[],contextualErrorMap:s==null?void 0:s.errorMap,async:!0},path:(s==null?void 0:s.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:r,parsedType:$h(r)},a=this._parse({data:r,path:n.path,parent:n}),o=await(zS(a)?a:Promise.resolve(a));return u$(n,o)}refine(r,s){const n=a=>typeof s=="string"||typeof s>"u"?{message:s}:typeof s=="function"?s(a):s;return this._refinement((a,o)=>{const c=r(a),i=()=>o.addIssue({code:hr.custom,...n(a)});return typeof Promise<"u"&&c instanceof Promise?c.then(f=>f?!0:(i(),!1)):c?!0:(i(),!1)})}refinement(r,s){return this._refinement((n,a)=>r(n)?!0:(a.addIssue(typeof s=="function"?s(n,a):s),!1))}_refinement(r){return new Cy({schema:this,typeName:ms.ZodEffects,effect:{type:"refinement",refinement:r}})}superRefine(r){return this._refinement(r)}constructor(r){this.spa=this.safeParseAsync,this._def=r,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:s=>this["~validate"](s)}}optional(){return xm.create(this,this._def)}nullable(){return Py.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Cd.create(this)}promise(){return US.create(this,this._def)}or(r){return qS.create([this,r],this._def)}and(r){return VS.create(this,r,this._def)}transform(r){return new Cy({...ks(this._def),schema:this,typeName:ms.ZodEffects,effect:{type:"transform",transform:r}})}default(r){const s=typeof r=="function"?r:()=>r;return new MM({...ks(this._def),innerType:this,defaultValue:s,typeName:ms.ZodDefault})}brand(){return new pxe({typeName:ms.ZodBranded,type:this,...ks(this._def)})}catch(r){const s=typeof r=="function"?r:()=>r;return new OM({...ks(this._def),innerType:this,catchValue:s,typeName:ms.ZodCatch})}describe(r){const s=this.constructor;return new s({...this._def,description:r})}pipe(r){return lD.create(this,r)}readonly(){return IM.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Kpe=/^c[^\s-]{8,}$/i,Hpe=/^[0-9a-z]+$/,Zpe=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Ype=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Xpe=/^[a-z0-9_-]{21}$/i,Qpe=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Jpe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,exe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,txe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let tT;const rxe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,sxe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,nxe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,axe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,ixe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,oxe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,hK="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",lxe=new RegExp(`^${hK}$`);function mK(t){let r="[0-5]\\d";t.precision?r=`${r}\\.\\d{${t.precision}}`:t.precision==null&&(r=`${r}(\\.\\d+)?`);const s=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${r})${s}`}function cxe(t){return new RegExp(`^${mK(t)}$`)}function dxe(t){let r=`${hK}T${mK(t)}`;const s=[];return s.push(t.local?"Z?":"Z"),t.offset&&s.push("([+-]\\d{2}:?\\d{2})"),r=`${r}(${s.join("|")})`,new RegExp(`^${r}$`)}function uxe(t,r){return!!((r==="v4"||!r)&&rxe.test(t)||(r==="v6"||!r)&&nxe.test(t))}function hxe(t,r){if(!Qpe.test(t))return!1;try{const[s]=t.split(".");if(!s)return!1;const n=s.replace(/-/g,"+").replace(/_/g,"/").padEnd(s.length+(4-s.length%4)%4,"="),a=JSON.parse(atob(n));return!(typeof a!="object"||a===null||"typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||r&&a.alg!==r)}catch{return!1}}function mxe(t,r){return!!((r==="v4"||!r)&&sxe.test(t)||(r==="v6"||!r)&&axe.test(t))}class Cu extends Xs{_parse(r){if(this._def.coerce&&(r.data=String(r.data)),this._getType(r)!==Rr.string){const o=this._getOrReturnCtx(r);return Sr(o,{code:hr.invalid_type,expected:Rr.string,received:o.parsedType}),hs}const n=new _l;let a;for(const o of this._def.checks)if(o.kind==="min")r.data.length<o.value&&(a=this._getOrReturnCtx(r,a),Sr(a,{code:hr.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),n.dirty());else if(o.kind==="max")r.data.length>o.value&&(a=this._getOrReturnCtx(r,a),Sr(a,{code:hr.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),n.dirty());else if(o.kind==="length"){const c=r.data.length>o.value,i=r.data.length<o.value;(c||i)&&(a=this._getOrReturnCtx(r,a),c?Sr(a,{code:hr.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):i&&Sr(a,{code:hr.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),n.dirty())}else if(o.kind==="email")exe.test(r.data)||(a=this._getOrReturnCtx(r,a),Sr(a,{validation:"email",code:hr.invalid_string,message:o.message}),n.dirty());else if(o.kind==="emoji")tT||(tT=new RegExp(txe,"u")),tT.test(r.data)||(a=this._getOrReturnCtx(r,a),Sr(a,{validation:"emoji",code:hr.invalid_string,message:o.message}),n.dirty());else if(o.kind==="uuid")Ype.test(r.data)||(a=this._getOrReturnCtx(r,a),Sr(a,{validation:"uuid",code:hr.invalid_string,message:o.message}),n.dirty());else if(o.kind==="nanoid")Xpe.test(r.data)||(a=this._getOrReturnCtx(r,a),Sr(a,{validation:"nanoid",code:hr.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid")Kpe.test(r.data)||(a=this._getOrReturnCtx(r,a),Sr(a,{validation:"cuid",code:hr.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid2")Hpe.test(r.data)||(a=this._getOrReturnCtx(r,a),Sr(a,{validation:"cuid2",code:hr.invalid_string,message:o.message}),n.dirty());else if(o.kind==="ulid")Zpe.test(r.data)||(a=this._getOrReturnCtx(r,a),Sr(a,{validation:"ulid",code:hr.invalid_string,message:o.message}),n.dirty());else if(o.kind==="url")try{new URL(r.data)}catch{a=this._getOrReturnCtx(r,a),Sr(a,{validation:"url",code:hr.invalid_string,message:o.message}),n.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(r.data)||(a=this._getOrReturnCtx(r,a),Sr(a,{validation:"regex",code:hr.invalid_string,message:o.message}),n.dirty())):o.kind==="trim"?r.data=r.data.trim():o.kind==="includes"?r.data.includes(o.value,o.position)||(a=this._getOrReturnCtx(r,a),Sr(a,{code:hr.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),n.dirty()):o.kind==="toLowerCase"?r.data=r.data.toLowerCase():o.kind==="toUpperCase"?r.data=r.data.toUpperCase():o.kind==="startsWith"?r.data.startsWith(o.value)||(a=this._getOrReturnCtx(r,a),Sr(a,{code:hr.invalid_string,validation:{startsWith:o.value},message:o.message}),n.dirty()):o.kind==="endsWith"?r.data.endsWith(o.value)||(a=this._getOrReturnCtx(r,a),Sr(a,{code:hr.invalid_string,validation:{endsWith:o.value},message:o.message}),n.dirty()):o.kind==="datetime"?dxe(o).test(r.data)||(a=this._getOrReturnCtx(r,a),Sr(a,{code:hr.invalid_string,validation:"datetime",message:o.message}),n.dirty()):o.kind==="date"?lxe.test(r.data)||(a=this._getOrReturnCtx(r,a),Sr(a,{code:hr.invalid_string,validation:"date",message:o.message}),n.dirty()):o.kind==="time"?cxe(o).test(r.data)||(a=this._getOrReturnCtx(r,a),Sr(a,{code:hr.invalid_string,validation:"time",message:o.message}),n.dirty()):o.kind==="duration"?Jpe.test(r.data)||(a=this._getOrReturnCtx(r,a),Sr(a,{validation:"duration",code:hr.invalid_string,message:o.message}),n.dirty()):o.kind==="ip"?uxe(r.data,o.version)||(a=this._getOrReturnCtx(r,a),Sr(a,{validation:"ip",code:hr.invalid_string,message:o.message}),n.dirty()):o.kind==="jwt"?hxe(r.data,o.alg)||(a=this._getOrReturnCtx(r,a),Sr(a,{validation:"jwt",code:hr.invalid_string,message:o.message}),n.dirty()):o.kind==="cidr"?mxe(r.data,o.version)||(a=this._getOrReturnCtx(r,a),Sr(a,{validation:"cidr",code:hr.invalid_string,message:o.message}),n.dirty()):o.kind==="base64"?ixe.test(r.data)||(a=this._getOrReturnCtx(r,a),Sr(a,{validation:"base64",code:hr.invalid_string,message:o.message}),n.dirty()):o.kind==="base64url"?oxe.test(r.data)||(a=this._getOrReturnCtx(r,a),Sr(a,{validation:"base64url",code:hr.invalid_string,message:o.message}),n.dirty()):Js.assertNever(o);return{status:n.value,value:r.data}}_regex(r,s,n){return this.refinement(a=>r.test(a),{validation:s,code:hr.invalid_string,...$r.errToObj(n)})}_addCheck(r){return new Cu({...this._def,checks:[...this._def.checks,r]})}email(r){return this._addCheck({kind:"email",...$r.errToObj(r)})}url(r){return this._addCheck({kind:"url",...$r.errToObj(r)})}emoji(r){return this._addCheck({kind:"emoji",...$r.errToObj(r)})}uuid(r){return this._addCheck({kind:"uuid",...$r.errToObj(r)})}nanoid(r){return this._addCheck({kind:"nanoid",...$r.errToObj(r)})}cuid(r){return this._addCheck({kind:"cuid",...$r.errToObj(r)})}cuid2(r){return this._addCheck({kind:"cuid2",...$r.errToObj(r)})}ulid(r){return this._addCheck({kind:"ulid",...$r.errToObj(r)})}base64(r){return this._addCheck({kind:"base64",...$r.errToObj(r)})}base64url(r){return this._addCheck({kind:"base64url",...$r.errToObj(r)})}jwt(r){return this._addCheck({kind:"jwt",...$r.errToObj(r)})}ip(r){return this._addCheck({kind:"ip",...$r.errToObj(r)})}cidr(r){return this._addCheck({kind:"cidr",...$r.errToObj(r)})}datetime(r){return typeof r=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:r}):this._addCheck({kind:"datetime",precision:typeof(r==null?void 0:r.precision)>"u"?null:r==null?void 0:r.precision,offset:(r==null?void 0:r.offset)??!1,local:(r==null?void 0:r.local)??!1,...$r.errToObj(r==null?void 0:r.message)})}date(r){return this._addCheck({kind:"date",message:r})}time(r){return typeof r=="string"?this._addCheck({kind:"time",precision:null,message:r}):this._addCheck({kind:"time",precision:typeof(r==null?void 0:r.precision)>"u"?null:r==null?void 0:r.precision,...$r.errToObj(r==null?void 0:r.message)})}duration(r){return this._addCheck({kind:"duration",...$r.errToObj(r)})}regex(r,s){return this._addCheck({kind:"regex",regex:r,...$r.errToObj(s)})}includes(r,s){return this._addCheck({kind:"includes",value:r,position:s==null?void 0:s.position,...$r.errToObj(s==null?void 0:s.message)})}startsWith(r,s){return this._addCheck({kind:"startsWith",value:r,...$r.errToObj(s)})}endsWith(r,s){return this._addCheck({kind:"endsWith",value:r,...$r.errToObj(s)})}min(r,s){return this._addCheck({kind:"min",value:r,...$r.errToObj(s)})}max(r,s){return this._addCheck({kind:"max",value:r,...$r.errToObj(s)})}length(r,s){return this._addCheck({kind:"length",value:r,...$r.errToObj(s)})}nonempty(r){return this.min(1,$r.errToObj(r))}trim(){return new Cu({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Cu({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Cu({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(r=>r.kind==="datetime")}get isDate(){return!!this._def.checks.find(r=>r.kind==="date")}get isTime(){return!!this._def.checks.find(r=>r.kind==="time")}get isDuration(){return!!this._def.checks.find(r=>r.kind==="duration")}get isEmail(){return!!this._def.checks.find(r=>r.kind==="email")}get isURL(){return!!this._def.checks.find(r=>r.kind==="url")}get isEmoji(){return!!this._def.checks.find(r=>r.kind==="emoji")}get isUUID(){return!!this._def.checks.find(r=>r.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(r=>r.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(r=>r.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(r=>r.kind==="cuid2")}get isULID(){return!!this._def.checks.find(r=>r.kind==="ulid")}get isIP(){return!!this._def.checks.find(r=>r.kind==="ip")}get isCIDR(){return!!this._def.checks.find(r=>r.kind==="cidr")}get isBase64(){return!!this._def.checks.find(r=>r.kind==="base64")}get isBase64url(){return!!this._def.checks.find(r=>r.kind==="base64url")}get minLength(){let r=null;for(const s of this._def.checks)s.kind==="min"&&(r===null||s.value>r)&&(r=s.value);return r}get maxLength(){let r=null;for(const s of this._def.checks)s.kind==="max"&&(r===null||s.value<r)&&(r=s.value);return r}}Cu.create=t=>new Cu({checks:[],typeName:ms.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...ks(t)});function fxe(t,r){const s=(t.toString().split(".")[1]||"").length,n=(r.toString().split(".")[1]||"").length,a=s>n?s:n,o=Number.parseInt(t.toFixed(a).replace(".","")),c=Number.parseInt(r.toFixed(a).replace(".",""));return o%c/10**a}class Pp extends Xs{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(r){if(this._def.coerce&&(r.data=Number(r.data)),this._getType(r)!==Rr.number){const o=this._getOrReturnCtx(r);return Sr(o,{code:hr.invalid_type,expected:Rr.number,received:o.parsedType}),hs}let n;const a=new _l;for(const o of this._def.checks)o.kind==="int"?Js.isInteger(r.data)||(n=this._getOrReturnCtx(r,n),Sr(n,{code:hr.invalid_type,expected:"integer",received:"float",message:o.message}),a.dirty()):o.kind==="min"?(o.inclusive?r.data<o.value:r.data<=o.value)&&(n=this._getOrReturnCtx(r,n),Sr(n,{code:hr.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),a.dirty()):o.kind==="max"?(o.inclusive?r.data>o.value:r.data>=o.value)&&(n=this._getOrReturnCtx(r,n),Sr(n,{code:hr.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),a.dirty()):o.kind==="multipleOf"?fxe(r.data,o.value)!==0&&(n=this._getOrReturnCtx(r,n),Sr(n,{code:hr.not_multiple_of,multipleOf:o.value,message:o.message}),a.dirty()):o.kind==="finite"?Number.isFinite(r.data)||(n=this._getOrReturnCtx(r,n),Sr(n,{code:hr.not_finite,message:o.message}),a.dirty()):Js.assertNever(o);return{status:a.value,value:r.data}}gte(r,s){return this.setLimit("min",r,!0,$r.toString(s))}gt(r,s){return this.setLimit("min",r,!1,$r.toString(s))}lte(r,s){return this.setLimit("max",r,!0,$r.toString(s))}lt(r,s){return this.setLimit("max",r,!1,$r.toString(s))}setLimit(r,s,n,a){return new Pp({...this._def,checks:[...this._def.checks,{kind:r,value:s,inclusive:n,message:$r.toString(a)}]})}_addCheck(r){return new Pp({...this._def,checks:[...this._def.checks,r]})}int(r){return this._addCheck({kind:"int",message:$r.toString(r)})}positive(r){return this._addCheck({kind:"min",value:0,inclusive:!1,message:$r.toString(r)})}negative(r){return this._addCheck({kind:"max",value:0,inclusive:!1,message:$r.toString(r)})}nonpositive(r){return this._addCheck({kind:"max",value:0,inclusive:!0,message:$r.toString(r)})}nonnegative(r){return this._addCheck({kind:"min",value:0,inclusive:!0,message:$r.toString(r)})}multipleOf(r,s){return this._addCheck({kind:"multipleOf",value:r,message:$r.toString(s)})}finite(r){return this._addCheck({kind:"finite",message:$r.toString(r)})}safe(r){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:$r.toString(r)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:$r.toString(r)})}get minValue(){let r=null;for(const s of this._def.checks)s.kind==="min"&&(r===null||s.value>r)&&(r=s.value);return r}get maxValue(){let r=null;for(const s of this._def.checks)s.kind==="max"&&(r===null||s.value<r)&&(r=s.value);return r}get isInt(){return!!this._def.checks.find(r=>r.kind==="int"||r.kind==="multipleOf"&&Js.isInteger(r.value))}get isFinite(){let r=null,s=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(s===null||n.value>s)&&(s=n.value):n.kind==="max"&&(r===null||n.value<r)&&(r=n.value)}return Number.isFinite(s)&&Number.isFinite(r)}}Pp.create=t=>new Pp({checks:[],typeName:ms.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...ks(t)});class kp extends Xs{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(r){if(this._def.coerce)try{r.data=BigInt(r.data)}catch{return this._getInvalidInput(r)}if(this._getType(r)!==Rr.bigint)return this._getInvalidInput(r);let n;const a=new _l;for(const o of this._def.checks)o.kind==="min"?(o.inclusive?r.data<o.value:r.data<=o.value)&&(n=this._getOrReturnCtx(r,n),Sr(n,{code:hr.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),a.dirty()):o.kind==="max"?(o.inclusive?r.data>o.value:r.data>=o.value)&&(n=this._getOrReturnCtx(r,n),Sr(n,{code:hr.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),a.dirty()):o.kind==="multipleOf"?r.data%o.value!==BigInt(0)&&(n=this._getOrReturnCtx(r,n),Sr(n,{code:hr.not_multiple_of,multipleOf:o.value,message:o.message}),a.dirty()):Js.assertNever(o);return{status:a.value,value:r.data}}_getInvalidInput(r){const s=this._getOrReturnCtx(r);return Sr(s,{code:hr.invalid_type,expected:Rr.bigint,received:s.parsedType}),hs}gte(r,s){return this.setLimit("min",r,!0,$r.toString(s))}gt(r,s){return this.setLimit("min",r,!1,$r.toString(s))}lte(r,s){return this.setLimit("max",r,!0,$r.toString(s))}lt(r,s){return this.setLimit("max",r,!1,$r.toString(s))}setLimit(r,s,n,a){return new kp({...this._def,checks:[...this._def.checks,{kind:r,value:s,inclusive:n,message:$r.toString(a)}]})}_addCheck(r){return new kp({...this._def,checks:[...this._def.checks,r]})}positive(r){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:$r.toString(r)})}negative(r){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:$r.toString(r)})}nonpositive(r){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:$r.toString(r)})}nonnegative(r){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:$r.toString(r)})}multipleOf(r,s){return this._addCheck({kind:"multipleOf",value:r,message:$r.toString(s)})}get minValue(){let r=null;for(const s of this._def.checks)s.kind==="min"&&(r===null||s.value>r)&&(r=s.value);return r}get maxValue(){let r=null;for(const s of this._def.checks)s.kind==="max"&&(r===null||s.value<r)&&(r=s.value);return r}}kp.create=t=>new kp({checks:[],typeName:ms.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...ks(t)});class BS extends Xs{_parse(r){if(this._def.coerce&&(r.data=!!r.data),this._getType(r)!==Rr.boolean){const n=this._getOrReturnCtx(r);return Sr(n,{code:hr.invalid_type,expected:Rr.boolean,received:n.parsedType}),hs}return sc(r.data)}}BS.create=t=>new BS({typeName:ms.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...ks(t)});class Ny extends Xs{_parse(r){if(this._def.coerce&&(r.data=new Date(r.data)),this._getType(r)!==Rr.date){const o=this._getOrReturnCtx(r);return Sr(o,{code:hr.invalid_type,expected:Rr.date,received:o.parsedType}),hs}if(Number.isNaN(r.data.getTime())){const o=this._getOrReturnCtx(r);return Sr(o,{code:hr.invalid_date}),hs}const n=new _l;let a;for(const o of this._def.checks)o.kind==="min"?r.data.getTime()<o.value&&(a=this._getOrReturnCtx(r,a),Sr(a,{code:hr.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),n.dirty()):o.kind==="max"?r.data.getTime()>o.value&&(a=this._getOrReturnCtx(r,a),Sr(a,{code:hr.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),n.dirty()):Js.assertNever(o);return{status:n.value,value:new Date(r.data.getTime())}}_addCheck(r){return new Ny({...this._def,checks:[...this._def.checks,r]})}min(r,s){return this._addCheck({kind:"min",value:r.getTime(),message:$r.toString(s)})}max(r,s){return this._addCheck({kind:"max",value:r.getTime(),message:$r.toString(s)})}get minDate(){let r=null;for(const s of this._def.checks)s.kind==="min"&&(r===null||s.value>r)&&(r=s.value);return r!=null?new Date(r):null}get maxDate(){let r=null;for(const s of this._def.checks)s.kind==="max"&&(r===null||s.value<r)&&(r=s.value);return r!=null?new Date(r):null}}Ny.create=t=>new Ny({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:ms.ZodDate,...ks(t)});class h$ extends Xs{_parse(r){if(this._getType(r)!==Rr.symbol){const n=this._getOrReturnCtx(r);return Sr(n,{code:hr.invalid_type,expected:Rr.symbol,received:n.parsedType}),hs}return sc(r.data)}}h$.create=t=>new h$({typeName:ms.ZodSymbol,...ks(t)});class m$ extends Xs{_parse(r){if(this._getType(r)!==Rr.undefined){const n=this._getOrReturnCtx(r);return Sr(n,{code:hr.invalid_type,expected:Rr.undefined,received:n.parsedType}),hs}return sc(r.data)}}m$.create=t=>new m$({typeName:ms.ZodUndefined,...ks(t)});class f$ extends Xs{_parse(r){if(this._getType(r)!==Rr.null){const n=this._getOrReturnCtx(r);return Sr(n,{code:hr.invalid_type,expected:Rr.null,received:n.parsedType}),hs}return sc(r.data)}}f$.create=t=>new f$({typeName:ms.ZodNull,...ks(t)});class p$ extends Xs{constructor(){super(...arguments),this._any=!0}_parse(r){return sc(r.data)}}p$.create=t=>new p$({typeName:ms.ZodAny,...ks(t)});class x$ extends Xs{constructor(){super(...arguments),this._unknown=!0}_parse(r){return sc(r.data)}}x$.create=t=>new x$({typeName:ms.ZodUnknown,...ks(t)});class Em extends Xs{_parse(r){const s=this._getOrReturnCtx(r);return Sr(s,{code:hr.invalid_type,expected:Rr.never,received:s.parsedType}),hs}}Em.create=t=>new Em({typeName:ms.ZodNever,...ks(t)});class g$ extends Xs{_parse(r){if(this._getType(r)!==Rr.undefined){const n=this._getOrReturnCtx(r);return Sr(n,{code:hr.invalid_type,expected:Rr.void,received:n.parsedType}),hs}return sc(r.data)}}g$.create=t=>new g$({typeName:ms.ZodVoid,...ks(t)});class Cd extends Xs{_parse(r){const{ctx:s,status:n}=this._processInputParams(r),a=this._def;if(s.parsedType!==Rr.array)return Sr(s,{code:hr.invalid_type,expected:Rr.array,received:s.parsedType}),hs;if(a.exactLength!==null){const c=s.data.length>a.exactLength.value,i=s.data.length<a.exactLength.value;(c||i)&&(Sr(s,{code:c?hr.too_big:hr.too_small,minimum:i?a.exactLength.value:void 0,maximum:c?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(a.minLength!==null&&s.data.length<a.minLength.value&&(Sr(s,{code:hr.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),a.maxLength!==null&&s.data.length>a.maxLength.value&&(Sr(s,{code:hr.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),s.common.async)return Promise.all([...s.data].map((c,i)=>a.type._parseAsync(new Tm(s,c,s.path,i)))).then(c=>_l.mergeArray(n,c));const o=[...s.data].map((c,i)=>a.type._parseSync(new Tm(s,c,s.path,i)));return _l.mergeArray(n,o)}get element(){return this._def.type}min(r,s){return new Cd({...this._def,minLength:{value:r,message:$r.toString(s)}})}max(r,s){return new Cd({...this._def,maxLength:{value:r,message:$r.toString(s)}})}length(r,s){return new Cd({...this._def,exactLength:{value:r,message:$r.toString(s)}})}nonempty(r){return this.min(1,r)}}Cd.create=(t,r)=>new Cd({type:t,minLength:null,maxLength:null,exactLength:null,typeName:ms.ZodArray,...ks(r)});function ug(t){if(t instanceof Ua){const r={};for(const s in t.shape){const n=t.shape[s];r[s]=xm.create(ug(n))}return new Ua({...t._def,shape:()=>r})}else return t instanceof Cd?new Cd({...t._def,type:ug(t.element)}):t instanceof xm?xm.create(ug(t.unwrap())):t instanceof Py?Py.create(ug(t.unwrap())):t instanceof Ap?Ap.create(t.items.map(r=>ug(r))):t}class Ua extends Xs{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const r=this._def.shape(),s=Js.objectKeys(r);return this._cached={shape:r,keys:s},this._cached}_parse(r){if(this._getType(r)!==Rr.object){const p=this._getOrReturnCtx(r);return Sr(p,{code:hr.invalid_type,expected:Rr.object,received:p.parsedType}),hs}const{status:n,ctx:a}=this._processInputParams(r),{shape:o,keys:c}=this._getCached(),i=[];if(!(this._def.catchall instanceof Em&&this._def.unknownKeys==="strip"))for(const p in a.data)c.includes(p)||i.push(p);const f=[];for(const p of c){const g=o[p],y=a.data[p];f.push({key:{status:"valid",value:p},value:g._parse(new Tm(a,y,a.path,p)),alwaysSet:p in a.data})}if(this._def.catchall instanceof Em){const p=this._def.unknownKeys;if(p==="passthrough")for(const g of i)f.push({key:{status:"valid",value:g},value:{status:"valid",value:a.data[g]}});else if(p==="strict")i.length>0&&(Sr(a,{code:hr.unrecognized_keys,keys:i}),n.dirty());else if(p!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const p=this._def.catchall;for(const g of i){const y=a.data[g];f.push({key:{status:"valid",value:g},value:p._parse(new Tm(a,y,a.path,g)),alwaysSet:g in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const p=[];for(const g of f){const y=await g.key,b=await g.value;p.push({key:y,value:b,alwaysSet:g.alwaysSet})}return p}).then(p=>_l.mergeObjectSync(n,p)):_l.mergeObjectSync(n,f)}get shape(){return this._def.shape()}strict(r){return $r.errToObj,new Ua({...this._def,unknownKeys:"strict",...r!==void 0?{errorMap:(s,n)=>{var o,c;const a=((c=(o=this._def).errorMap)==null?void 0:c.call(o,s,n).message)??n.defaultError;return s.code==="unrecognized_keys"?{message:$r.errToObj(r).message??a}:{message:a}}}:{}})}strip(){return new Ua({...this._def,unknownKeys:"strip"})}passthrough(){return new Ua({...this._def,unknownKeys:"passthrough"})}extend(r){return new Ua({...this._def,shape:()=>({...this._def.shape(),...r})})}merge(r){return new Ua({unknownKeys:r._def.unknownKeys,catchall:r._def.catchall,shape:()=>({...this._def.shape(),...r._def.shape()}),typeName:ms.ZodObject})}setKey(r,s){return this.augment({[r]:s})}catchall(r){return new Ua({...this._def,catchall:r})}pick(r){const s={};for(const n of Js.objectKeys(r))r[n]&&this.shape[n]&&(s[n]=this.shape[n]);return new Ua({...this._def,shape:()=>s})}omit(r){const s={};for(const n of Js.objectKeys(this.shape))r[n]||(s[n]=this.shape[n]);return new Ua({...this._def,shape:()=>s})}deepPartial(){return ug(this)}partial(r){const s={};for(const n of Js.objectKeys(this.shape)){const a=this.shape[n];r&&!r[n]?s[n]=a:s[n]=a.optional()}return new Ua({...this._def,shape:()=>s})}required(r){const s={};for(const n of Js.objectKeys(this.shape))if(r&&!r[n])s[n]=this.shape[n];else{let o=this.shape[n];for(;o instanceof xm;)o=o._def.innerType;s[n]=o}return new Ua({...this._def,shape:()=>s})}keyof(){return fK(Js.objectKeys(this.shape))}}Ua.create=(t,r)=>new Ua({shape:()=>t,unknownKeys:"strip",catchall:Em.create(),typeName:ms.ZodObject,...ks(r)});Ua.strictCreate=(t,r)=>new Ua({shape:()=>t,unknownKeys:"strict",catchall:Em.create(),typeName:ms.ZodObject,...ks(r)});Ua.lazycreate=(t,r)=>new Ua({shape:t,unknownKeys:"strip",catchall:Em.create(),typeName:ms.ZodObject,...ks(r)});class qS extends Xs{_parse(r){const{ctx:s}=this._processInputParams(r),n=this._def.options;function a(o){for(const i of o)if(i.result.status==="valid")return i.result;for(const i of o)if(i.result.status==="dirty")return s.common.issues.push(...i.ctx.common.issues),i.result;const c=o.map(i=>new qu(i.ctx.common.issues));return Sr(s,{code:hr.invalid_union,unionErrors:c}),hs}if(s.common.async)return Promise.all(n.map(async o=>{const c={...s,common:{...s.common,issues:[]},parent:null};return{result:await o._parseAsync({data:s.data,path:s.path,parent:c}),ctx:c}})).then(a);{let o;const c=[];for(const f of n){const p={...s,common:{...s.common,issues:[]},parent:null},g=f._parseSync({data:s.data,path:s.path,parent:p});if(g.status==="valid")return g;g.status==="dirty"&&!o&&(o={result:g,ctx:p}),p.common.issues.length&&c.push(p.common.issues)}if(o)return s.common.issues.push(...o.ctx.common.issues),o.result;const i=c.map(f=>new qu(f));return Sr(s,{code:hr.invalid_union,unionErrors:i}),hs}}get options(){return this._def.options}}qS.create=(t,r)=>new qS({options:t,typeName:ms.ZodUnion,...ks(r)});function EM(t,r){const s=$h(t),n=$h(r);if(t===r)return{valid:!0,data:t};if(s===Rr.object&&n===Rr.object){const a=Js.objectKeys(r),o=Js.objectKeys(t).filter(i=>a.indexOf(i)!==-1),c={...t,...r};for(const i of o){const f=EM(t[i],r[i]);if(!f.valid)return{valid:!1};c[i]=f.data}return{valid:!0,data:c}}else if(s===Rr.array&&n===Rr.array){if(t.length!==r.length)return{valid:!1};const a=[];for(let o=0;o<t.length;o++){const c=t[o],i=r[o],f=EM(c,i);if(!f.valid)return{valid:!1};a.push(f.data)}return{valid:!0,data:a}}else return s===Rr.date&&n===Rr.date&&+t==+r?{valid:!0,data:t}:{valid:!1}}class VS extends Xs{_parse(r){const{status:s,ctx:n}=this._processInputParams(r),a=(o,c)=>{if(c$(o)||c$(c))return hs;const i=EM(o.value,c.value);return i.valid?((d$(o)||d$(c))&&s.dirty(),{status:s.value,value:i.data}):(Sr(n,{code:hr.invalid_intersection_types}),hs)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([o,c])=>a(o,c)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}VS.create=(t,r,s)=>new VS({left:t,right:r,typeName:ms.ZodIntersection,...ks(s)});class Ap extends Xs{_parse(r){const{status:s,ctx:n}=this._processInputParams(r);if(n.parsedType!==Rr.array)return Sr(n,{code:hr.invalid_type,expected:Rr.array,received:n.parsedType}),hs;if(n.data.length<this._def.items.length)return Sr(n,{code:hr.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),hs;!this._def.rest&&n.data.length>this._def.items.length&&(Sr(n,{code:hr.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),s.dirty());const o=[...n.data].map((c,i)=>{const f=this._def.items[i]||this._def.rest;return f?f._parse(new Tm(n,c,n.path,i)):null}).filter(c=>!!c);return n.common.async?Promise.all(o).then(c=>_l.mergeArray(s,c)):_l.mergeArray(s,o)}get items(){return this._def.items}rest(r){return new Ap({...this._def,rest:r})}}Ap.create=(t,r)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ap({items:t,typeName:ms.ZodTuple,rest:null,...ks(r)})};class y$ extends Xs{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(r){const{status:s,ctx:n}=this._processInputParams(r);if(n.parsedType!==Rr.map)return Sr(n,{code:hr.invalid_type,expected:Rr.map,received:n.parsedType}),hs;const a=this._def.keyType,o=this._def.valueType,c=[...n.data.entries()].map(([i,f],p)=>({key:a._parse(new Tm(n,i,n.path,[p,"key"])),value:o._parse(new Tm(n,f,n.path,[p,"value"]))}));if(n.common.async){const i=new Map;return Promise.resolve().then(async()=>{for(const f of c){const p=await f.key,g=await f.value;if(p.status==="aborted"||g.status==="aborted")return hs;(p.status==="dirty"||g.status==="dirty")&&s.dirty(),i.set(p.value,g.value)}return{status:s.value,value:i}})}else{const i=new Map;for(const f of c){const p=f.key,g=f.value;if(p.status==="aborted"||g.status==="aborted")return hs;(p.status==="dirty"||g.status==="dirty")&&s.dirty(),i.set(p.value,g.value)}return{status:s.value,value:i}}}}y$.create=(t,r,s)=>new y$({valueType:r,keyType:t,typeName:ms.ZodMap,...ks(s)});class Ab extends Xs{_parse(r){const{status:s,ctx:n}=this._processInputParams(r);if(n.parsedType!==Rr.set)return Sr(n,{code:hr.invalid_type,expected:Rr.set,received:n.parsedType}),hs;const a=this._def;a.minSize!==null&&n.data.size<a.minSize.value&&(Sr(n,{code:hr.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),s.dirty()),a.maxSize!==null&&n.data.size>a.maxSize.value&&(Sr(n,{code:hr.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),s.dirty());const o=this._def.valueType;function c(f){const p=new Set;for(const g of f){if(g.status==="aborted")return hs;g.status==="dirty"&&s.dirty(),p.add(g.value)}return{status:s.value,value:p}}const i=[...n.data.values()].map((f,p)=>o._parse(new Tm(n,f,n.path,p)));return n.common.async?Promise.all(i).then(f=>c(f)):c(i)}min(r,s){return new Ab({...this._def,minSize:{value:r,message:$r.toString(s)}})}max(r,s){return new Ab({...this._def,maxSize:{value:r,message:$r.toString(s)}})}size(r,s){return this.min(r,s).max(r,s)}nonempty(r){return this.min(1,r)}}Ab.create=(t,r)=>new Ab({valueType:t,minSize:null,maxSize:null,typeName:ms.ZodSet,...ks(r)});class v$ extends Xs{get schema(){return this._def.getter()}_parse(r){const{ctx:s}=this._processInputParams(r);return this._def.getter()._parse({data:s.data,path:s.path,parent:s})}}v$.create=(t,r)=>new v$({getter:t,typeName:ms.ZodLazy,...ks(r)});class j$ extends Xs{_parse(r){if(r.data!==this._def.value){const s=this._getOrReturnCtx(r);return Sr(s,{received:s.data,code:hr.invalid_literal,expected:this._def.value}),hs}return{status:"valid",value:r.data}}get value(){return this._def.value}}j$.create=(t,r)=>new j$({value:t,typeName:ms.ZodLiteral,...ks(r)});function fK(t,r){return new Sy({values:t,typeName:ms.ZodEnum,...ks(r)})}class Sy extends Xs{_parse(r){if(typeof r.data!="string"){const s=this._getOrReturnCtx(r),n=this._def.values;return Sr(s,{expected:Js.joinValues(n),received:s.parsedType,code:hr.invalid_type}),hs}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(r.data)){const s=this._getOrReturnCtx(r),n=this._def.values;return Sr(s,{received:s.data,code:hr.invalid_enum_value,options:n}),hs}return sc(r.data)}get options(){return this._def.values}get enum(){const r={};for(const s of this._def.values)r[s]=s;return r}get Values(){const r={};for(const s of this._def.values)r[s]=s;return r}get Enum(){const r={};for(const s of this._def.values)r[s]=s;return r}extract(r,s=this._def){return Sy.create(r,{...this._def,...s})}exclude(r,s=this._def){return Sy.create(this.options.filter(n=>!r.includes(n)),{...this._def,...s})}}Sy.create=fK;class b$ extends Xs{_parse(r){const s=Js.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(r);if(n.parsedType!==Rr.string&&n.parsedType!==Rr.number){const a=Js.objectValues(s);return Sr(n,{expected:Js.joinValues(a),received:n.parsedType,code:hr.invalid_type}),hs}if(this._cache||(this._cache=new Set(Js.getValidEnumValues(this._def.values))),!this._cache.has(r.data)){const a=Js.objectValues(s);return Sr(n,{received:n.data,code:hr.invalid_enum_value,options:a}),hs}return sc(r.data)}get enum(){return this._def.values}}b$.create=(t,r)=>new b$({values:t,typeName:ms.ZodNativeEnum,...ks(r)});class US extends Xs{unwrap(){return this._def.type}_parse(r){const{ctx:s}=this._processInputParams(r);if(s.parsedType!==Rr.promise&&s.common.async===!1)return Sr(s,{code:hr.invalid_type,expected:Rr.promise,received:s.parsedType}),hs;const n=s.parsedType===Rr.promise?s.data:Promise.resolve(s.data);return sc(n.then(a=>this._def.type.parseAsync(a,{path:s.path,errorMap:s.common.contextualErrorMap})))}}US.create=(t,r)=>new US({type:t,typeName:ms.ZodPromise,...ks(r)});class Cy extends Xs{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ms.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(r){const{status:s,ctx:n}=this._processInputParams(r),a=this._def.effect||null,o={addIssue:c=>{Sr(n,c),c.fatal?s.abort():s.dirty()},get path(){return n.path}};if(o.addIssue=o.addIssue.bind(o),a.type==="preprocess"){const c=a.transform(n.data,o);if(n.common.async)return Promise.resolve(c).then(async i=>{if(s.value==="aborted")return hs;const f=await this._def.schema._parseAsync({data:i,path:n.path,parent:n});return f.status==="aborted"?hs:f.status==="dirty"||s.value==="dirty"?M0(f.value):f});{if(s.value==="aborted")return hs;const i=this._def.schema._parseSync({data:c,path:n.path,parent:n});return i.status==="aborted"?hs:i.status==="dirty"||s.value==="dirty"?M0(i.value):i}}if(a.type==="refinement"){const c=i=>{const f=a.refinement(i,o);if(n.common.async)return Promise.resolve(f);if(f instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return i};if(n.common.async===!1){const i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?hs:(i.status==="dirty"&&s.dirty(),c(i.value),{status:s.value,value:i.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>i.status==="aborted"?hs:(i.status==="dirty"&&s.dirty(),c(i.value).then(()=>({status:s.value,value:i.value}))))}if(a.type==="transform")if(n.common.async===!1){const c=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!wy(c))return hs;const i=a.transform(c.value,o);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:s.value,value:i}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(c=>wy(c)?Promise.resolve(a.transform(c.value,o)).then(i=>({status:s.value,value:i})):hs);Js.assertNever(a)}}Cy.create=(t,r,s)=>new Cy({schema:t,typeName:ms.ZodEffects,effect:r,...ks(s)});Cy.createWithPreprocess=(t,r,s)=>new Cy({schema:r,effect:{type:"preprocess",transform:t},typeName:ms.ZodEffects,...ks(s)});class xm extends Xs{_parse(r){return this._getType(r)===Rr.undefined?sc(void 0):this._def.innerType._parse(r)}unwrap(){return this._def.innerType}}xm.create=(t,r)=>new xm({innerType:t,typeName:ms.ZodOptional,...ks(r)});class Py extends Xs{_parse(r){return this._getType(r)===Rr.null?sc(null):this._def.innerType._parse(r)}unwrap(){return this._def.innerType}}Py.create=(t,r)=>new Py({innerType:t,typeName:ms.ZodNullable,...ks(r)});class MM extends Xs{_parse(r){const{ctx:s}=this._processInputParams(r);let n=s.data;return s.parsedType===Rr.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:s.path,parent:s})}removeDefault(){return this._def.innerType}}MM.create=(t,r)=>new MM({innerType:t,typeName:ms.ZodDefault,defaultValue:typeof r.default=="function"?r.default:()=>r.default,...ks(r)});class OM extends Xs{_parse(r){const{ctx:s}=this._processInputParams(r),n={...s,common:{...s.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return zS(a)?a.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new qu(n.common.issues)},input:n.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new qu(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}OM.create=(t,r)=>new OM({innerType:t,typeName:ms.ZodCatch,catchValue:typeof r.catch=="function"?r.catch:()=>r.catch,...ks(r)});class _$ extends Xs{_parse(r){if(this._getType(r)!==Rr.nan){const n=this._getOrReturnCtx(r);return Sr(n,{code:hr.invalid_type,expected:Rr.nan,received:n.parsedType}),hs}return{status:"valid",value:r.data}}}_$.create=t=>new _$({typeName:ms.ZodNaN,...ks(t)});class pxe extends Xs{_parse(r){const{ctx:s}=this._processInputParams(r),n=s.data;return this._def.type._parse({data:n,path:s.path,parent:s})}unwrap(){return this._def.type}}class lD extends Xs{_parse(r){const{status:s,ctx:n}=this._processInputParams(r);if(n.common.async)return(async()=>{const o=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?hs:o.status==="dirty"?(s.dirty(),M0(o.value)):this._def.out._parseAsync({data:o.value,path:n.path,parent:n})})();{const a=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?hs:a.status==="dirty"?(s.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:n.path,parent:n})}}static create(r,s){return new lD({in:r,out:s,typeName:ms.ZodPipeline})}}class IM extends Xs{_parse(r){const s=this._def.innerType._parse(r),n=a=>(wy(a)&&(a.value=Object.freeze(a.value)),a);return zS(s)?s.then(a=>n(a)):n(s)}unwrap(){return this._def.innerType}}IM.create=(t,r)=>new IM({innerType:t,typeName:ms.ZodReadonly,...ks(r)});var ms;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(ms||(ms={}));const wa=Cu.create,qi=Pp.create;kp.create;BS.create;Ny.create;Em.create;Cd.create;const Ld=Ua.create;qS.create;VS.create;Ap.create;const WS=Sy.create;US.create;xm.create;Py.create;const xxe={string:t=>Cu.create({...t,coerce:!0}),number:t=>Pp.create({...t,coerce:!0}),boolean:t=>BS.create({...t,coerce:!0}),bigint:t=>kp.create({...t,coerce:!0}),date:t=>Ny.create({...t,coerce:!0})};function Hn({control:t,name:r,label:s,type:n="text",placeholder:a,required:o=!1,error:c,step:i}){return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(we,{htmlFor:r,children:[s,o&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(GC,{control:t,name:r,render:({field:{value:f,onChange:p,...g}})=>e.jsx(Ie,{...g,id:r,type:n,placeholder:a,step:i,className:c?"border-red-500":"",value:f??"",onChange:y=>{const b=y.target.value;p(n==="number"&&b===""?void 0:b)},onBlur:y=>{if(n==="number"&&y.target.value!==""){const b=parseFloat(y.target.value);p(isNaN(b)?y.target.value:b)}g.onBlur()}})}),c&&e.jsx("p",{className:"text-sm text-red-500",children:c})]})}const gxe={normal:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",alarm:"bg-yellow-100 text-yellow-800",critical:"bg-red-100 text-red-800"},yxe=Ld({tag:wa().min(1,"Tag is required"),parameter:wa().min(1,"Parameter is required"),unit:wa().min(1,"Unit is required"),asset_id:qi().int().positive("Asset ID is required")}),vxe=Ld({value:qi(),source:wa().optional()});function jxe(){var F,B,U,te,Q,re,Z,ne,oe;const[t,r]=A.useState({page:1,per_page:15}),[s,n]=A.useState(!1),[a,o]=A.useState(!1),[c,i]=A.useState(null),f=yr(),p=Ya({resolver:Ed(yxe),defaultValues:{tag:"",parameter:"",unit:"",asset_id:1}}),g=Ya({resolver:Ed(vxe),defaultValues:{value:0,source:"manual"}});A.useEffect(()=>{s||p.reset()},[s,p]),A.useEffect(()=>{a||(g.reset(),i(null))},[a,g]);const{data:y,isLoading:b,error:w}=it({queryKey:["monitoring-tags",t],queryFn:()=>eT.getTags(t)}),T=gt({mutationFn:eT.createTag,onSuccess:()=>{f.invalidateQueries({queryKey:["monitoring-tags"]}),n(!1),Me.success("Tag created successfully")},onError:()=>Me.error("Failed to create tag")}),N=gt({mutationFn:({tagId:Ce,data:Pe})=>eT.ingestReading(Ce,Pe),onSuccess:()=>{f.invalidateQueries({queryKey:["monitoring-tags"]}),o(!1),Me.success("Reading recorded successfully")},onError:()=>Me.error("Failed to record reading")}),M=Ce=>{T.mutate(Ce)},O=Ce=>{if(!c){Me.error("No tag selected");return}N.mutate({tagId:c.id,data:{value:Ce.value,source:Ce.source||"manual",read_at:new Date().toISOString()}})},C=((F=y==null?void 0:y.data)==null?void 0:F.filter(Ce=>Ce.health_status==="normal").length)||0,D=((B=y==null?void 0:y.data)==null?void 0:B.filter(Ce=>Ce.health_status==="warning").length)||0,L=((U=y==null?void 0:y.data)==null?void 0:U.filter(Ce=>Ce.health_status==="critical"||Ce.health_status==="alarm").length)||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Condition Monitoring"}),e.jsx("p",{className:"text-muted-foreground",children:"Track parameter trends and set alarms"})]}),e.jsxs(K,{onClick:()=>n(!0),children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"New Tag"]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ni,{className:"h-4 w-4"}),"Total Tags"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(y==null?void 0:y.total)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Monitored parameters"})]})]}),e.jsxs(H,{className:"border-green-200 bg-green-50",children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(zs,{className:"h-4 w-4 text-green-600"}),"Normal"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:C}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Within limits"})]})]}),e.jsxs(H,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(mie,{className:"h-4 w-4 text-yellow-600"}),"Warning"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:D}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Near limits"})]})]}),e.jsxs(H,{className:"border-red-200 bg-red-50",children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Fr,{className:"h-4 w-4 text-red-600"}),"Critical"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:L}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Out of limits"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Monitoring Tags"})}),e.jsx(X,{children:b?e.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(y!=null&&y.data)||y.data.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No monitoring tags configured. Create your first tag to start tracking parameters."}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Tag"}),e.jsx(se,{children:"Parameter"}),e.jsx(se,{children:"Current Value"}),e.jsx(se,{children:"Limits"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Last Reading"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:y.data.map(Ce=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono font-medium",children:Ce.tag}),e.jsx(J,{children:Ce.parameter}),e.jsx(J,{children:Ce.last_value!==null?`${Ce.last_value} ${Ce.unit}`:""}),e.jsx(J,{className:"text-xs",children:"Thresholds configured"}),e.jsx(J,{children:e.jsx(Ae,{className:gxe[Ce.health_status],children:Ce.health_status})}),e.jsx(J,{className:"text-sm text-muted-foreground",children:Ce.last_reading_at?new Date(Ce.last_reading_at).toLocaleString():"Never"}),e.jsx(J,{children:e.jsxs(K,{size:"sm",variant:"outline",onClick:()=>{i(Ce),o(!0)},children:[e.jsx(Ni,{className:"h-4 w-4 mr-1"}),"Record"]})})]},Ce.id))})]})})]}),e.jsx(Qt,{open:s,onOpenChange:n,children:e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Create Monitoring Tag"})}),e.jsxs("form",{onSubmit:p.handleSubmit(M),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Hn,{control:p.control,name:"tag",label:"Tag ID",placeholder:"e.g., P-101-FLOW",required:!0,error:(te=p.formState.errors.tag)==null?void 0:te.message}),e.jsx(Hn,{control:p.control,name:"parameter",label:"Parameter",placeholder:"e.g., Flow Rate",required:!0,error:(Q=p.formState.errors.parameter)==null?void 0:Q.message})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Hn,{control:p.control,name:"unit",label:"Unit",placeholder:"e.g., m/h",required:!0,error:(re=p.formState.errors.unit)==null?void 0:re.message}),e.jsx(Hn,{control:p.control,name:"asset_id",label:"Asset ID",type:"number",required:!0,error:(Z=p.formState.errors.asset_id)==null?void 0:Z.message})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:T.isPending||!p.formState.isValid,children:"Create Tag"})]})]})]})}),e.jsx(Qt,{open:a,onOpenChange:o,children:e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsxs(Xt,{children:["Record Reading: ",c==null?void 0:c.tag]})}),e.jsxs("form",{onSubmit:g.handleSubmit(O),className:"space-y-4",children:[e.jsxs("div",{className:"bg-muted p-4 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium",children:c==null?void 0:c.parameter}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Tag: ",c==null?void 0:c.tag," | Unit: ",c==null?void 0:c.unit]})]}),e.jsx(Hn,{control:g.control,name:"value",label:`Value (${c==null?void 0:c.unit})`,type:"number",step:"0.01",required:!0,error:(ne=g.formState.errors.value)==null?void 0:ne.message}),e.jsx(Hn,{control:g.control,name:"source",label:"Source",placeholder:"e.g., manual, sensor",error:(oe=g.formState.errors.source)==null?void 0:oe.message}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:N.isPending||!g.formState.isValid,children:"Record Reading"})]})]})]})})]})}function Tb({control:t,name:r,label:s,placeholder:n,required:a=!1,error:o,rows:c=3}){return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(we,{htmlFor:r,children:[s,a&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(GC,{control:t,name:r,render:({field:i})=>e.jsx(ws,{...i,id:r,placeholder:n,rows:c,className:o?"border-red-500":"",value:i.value??""})}),o&&e.jsx("p",{className:"text-sm text-red-500",children:o})]})}const bxe=Ld({part_id:qi().int().positive("Part ID is required"),bin_id:qi().int().positive("Bin ID is required"),qty:qi().positive("Quantity must be positive"),unit_cost:qi().positive("Unit cost must be positive"),notes:wa().optional()}),_xe=Ld({part_id:qi().int().positive("Part ID is required"),bin_id:qi().int().positive("Bin ID is required"),qty:qi().positive("Quantity must be positive"),work_order_id:qi().int().positive().optional(),notes:wa().optional()});function wxe(){var D,L,F,B,U,te,Q,re,Z,ne;const[t,r]=A.useState({page:1,per_page:15}),[s,n]=A.useState(!1),[a,o]=A.useState(!1),c=yr(),i=Ya({resolver:Ed(bxe),defaultValues:{part_id:0,bin_id:1,qty:0,unit_cost:0,notes:""}}),f=Ya({resolver:Ed(_xe),defaultValues:{part_id:0,bin_id:1,qty:0,notes:""}});A.useEffect(()=>{s||i.reset()},[s,i]),A.useEffect(()=>{a||f.reset()},[a,f]);const{data:p,isLoading:g,error:y}=it({queryKey:["stores",t],queryFn:()=>oN.getStores(t)}),{data:b}=it({queryKey:["low-stock"],queryFn:()=>oN.getLowStock()}),w=gt({mutationFn:oN.receiveStock,onSuccess:()=>{c.invalidateQueries({queryKey:["stores"]}),c.invalidateQueries({queryKey:["low-stock"]}),n(!1),Me.success("Stock received successfully")},onError:()=>Me.error("Failed to receive stock")}),T=gt({mutationFn:oN.issueStock,onSuccess:()=>{c.invalidateQueries({queryKey:["stores"]}),c.invalidateQueries({queryKey:["low-stock"]}),o(!1),Me.success("Stock issued successfully")},onError:()=>Me.error("Failed to issue stock")}),N=oe=>{w.mutate(oe)},M=oe=>{T.mutate(oe)},O=0,C=(b==null?void 0:b.length)||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Stores & Inventory"}),e.jsx("p",{className:"text-muted-foreground",children:"Spare parts, tools, and consumables"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{onClick:()=>n(!0),children:[e.jsx(Uae,{className:"h-4 w-4 mr-2"}),"Receive Stock"]}),e.jsxs(K,{variant:"outline",onClick:()=>o(!0),children:[e.jsx(Wae,{className:"h-4 w-4 mr-2"}),"Issue Stock"]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(zo,{className:"h-4 w-4"}),"Total Items"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(p==null?void 0:p.total)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"SKUs in stock"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsx(he,{className:"text-sm font-medium",children:"Inventory Value"})}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",O.toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total cost"})]})]}),e.jsxs(H,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ci,{className:"h-4 w-4 text-yellow-600"}),"Low Stock"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:C}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Items < 10 units"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsx(he,{className:"text-sm font-medium",children:"Total Stores"})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(p==null?void 0:p.total)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Locations"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Stores"})}),e.jsx(X,{children:g?e.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(p!=null&&p.data)||p.data.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No stores configured. Create a store to manage inventory."}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Store Name"}),e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Location"}),e.jsx(se,{children:"Status"})]})}),e.jsx(lr,{children:p.data.map(oe=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:oe.name}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:oe.type||"General"})}),e.jsx(J,{className:"text-sm text-muted-foreground",children:oe.location||""}),e.jsx(J,{children:e.jsx(Ae,{className:"bg-green-100 text-green-800",children:"Active"})})]},oe.id))})]})})]}),e.jsx(Qt,{open:s,onOpenChange:n,children:e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Receive Stock"})}),e.jsxs("form",{onSubmit:i.handleSubmit(N),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Hn,{control:i.control,name:"part_id",label:"Part ID",type:"number",required:!0,error:(D=i.formState.errors.part_id)==null?void 0:D.message}),e.jsx(Hn,{control:i.control,name:"bin_id",label:"Bin ID",type:"number",required:!0,error:(L=i.formState.errors.bin_id)==null?void 0:L.message})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Hn,{control:i.control,name:"qty",label:"Quantity",type:"number",step:"0.01",required:!0,error:(F=i.formState.errors.qty)==null?void 0:F.message}),e.jsx(Hn,{control:i.control,name:"unit_cost",label:"Unit Cost",type:"number",step:"0.01",required:!0,error:(B=i.formState.errors.unit_cost)==null?void 0:B.message})]}),e.jsx(Tb,{control:i.control,name:"notes",label:"Notes",rows:3,error:(U=i.formState.errors.notes)==null?void 0:U.message}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:w.isPending||!i.formState.isValid,children:"Receive Stock"})]})]})]})}),e.jsx(Qt,{open:a,onOpenChange:o,children:e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Issue Stock"})}),e.jsxs("form",{onSubmit:f.handleSubmit(M),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Hn,{control:f.control,name:"part_id",label:"Part ID",type:"number",required:!0,error:(te=f.formState.errors.part_id)==null?void 0:te.message}),e.jsx(Hn,{control:f.control,name:"bin_id",label:"Bin ID",type:"number",required:!0,error:(Q=f.formState.errors.bin_id)==null?void 0:Q.message})]}),e.jsx(Hn,{control:f.control,name:"qty",label:"Quantity",type:"number",step:"0.01",required:!0,error:(re=f.formState.errors.qty)==null?void 0:re.message}),e.jsx(Hn,{control:f.control,name:"work_order_id",label:"Work Order ID (optional)",type:"number",error:(Z=f.formState.errors.work_order_id)==null?void 0:Z.message}),e.jsx(Tb,{control:f.control,name:"notes",label:"Notes",rows:3,error:(ne=f.formState.errors.notes)==null?void 0:ne.message}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:T.isPending||!f.formState.isValid,children:"Issue Stock"})]})]})]})})]})}function pK({control:t,name:r,label:s,options:n,placeholder:a="Select...",required:o=!1,error:c}){return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(we,{htmlFor:r,children:[s,o&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(GC,{control:t,name:r,render:({field:i})=>e.jsxs(Nt,{onValueChange:i.onChange,value:i.value,children:[e.jsx(bt,{className:c?"border-red-500":"",children:e.jsx(St,{placeholder:a})}),e.jsx(_t,{children:n.map(f=>e.jsx(ge,{value:f.value,children:f.label},f.value))})]})}),c&&e.jsx("p",{className:"text-sm text-red-500",children:c})]})}const Nxe={active:"bg-green-100 text-green-800",maintenance:"bg-yellow-100 text-yellow-800",retired:"bg-gray-100 text-gray-800"},Sxe=Ld({service_type:wa().min(1,"Service type is required"),cost:qi().positive("Cost must be positive"),odometer_reading:qi().optional(),notes:wa().optional()}),Cxe=Ld({liters:qi().positive("Liters must be positive"),cost:qi().positive("Cost must be positive"),odometer_reading:qi().positive("Odometer reading is required")});function Pxe(){var F,B,U,te,Q,re,Z,ne,oe;const[t,r]=A.useState({page:1,per_page:15,status:"all"}),[s,n]=A.useState(!1),[a,o]=A.useState(!1),[c,i]=A.useState(null),f=yr(),p=Ya({resolver:Ed(Sxe),defaultValues:{service_type:"",cost:0,notes:""}}),g=Ya({resolver:Ed(Cxe),defaultValues:{liters:0,cost:0,odometer_reading:0}});A.useEffect(()=>{s||(p.reset(),i(null))},[s,p]),A.useEffect(()=>{a||(g.reset(),i(null))},[a,g]);const{data:y,isLoading:b,error:w}=it({queryKey:["fleet-assets",t],queryFn:()=>lN.getFleetAssets(t)}),{data:T}=it({queryKey:["fleet-utilization"],queryFn:()=>lN.getUtilization({})}),N=gt({mutationFn:({fleet_asset_id:Ce,service_type:Pe,performed_at:Se,notes:ae,cost:be,odometer_reading:de})=>lN.createServiceSchedule(Ce,{service_type:Pe,performed_at:Se,notes:ae,cost:be,odometer_reading:de}),onSuccess:()=>{f.invalidateQueries({queryKey:["fleet-assets"]}),f.invalidateQueries({queryKey:["fleet-utilization"]}),n(!1),Me.success("Service logged successfully")},onError:()=>Me.error("Failed to log service")}),M=gt({mutationFn:({fleet_asset_id:Ce,liters:Pe,cost:Se,odometer_reading:ae,filled_at:be})=>lN.logFuel(Ce,{odometer:ae,liters:Pe,cost:Se,filled_at:be}),onSuccess:()=>{f.invalidateQueries({queryKey:["fleet-assets"]}),o(!1),Me.success("Fuel logged successfully")},onError:()=>Me.error("Failed to log fuel")}),O=Ce=>{if(!c){Me.error("No vehicle selected");return}N.mutate({fleet_asset_id:c.id,service_type:Ce.service_type,performed_at:new Date().toISOString(),notes:Ce.notes||"",cost:Ce.cost,odometer_reading:Ce.odometer_reading})},C=Ce=>{if(!c){Me.error("No vehicle selected");return}M.mutate({fleet_asset_id:c.id,liters:Ce.liters,cost:Ce.cost,odometer_reading:Ce.odometer_reading,filled_at:new Date().toISOString()})},D=((F=y==null?void 0:y.data)==null?void 0:F.filter(Ce=>Ce.status==="active").length)||0,L=((B=y==null?void 0:y.data)==null?void 0:B.filter(Ce=>Ce.status==="maintenance").length)||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Fleet Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Vehicles, generators, and mobile equipment"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(py,{className:"h-4 w-4"}),"Total Fleet"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(y==null?void 0:y.total)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Registered assets"})]})]}),e.jsxs(H,{className:"border-green-200 bg-green-50",children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(zs,{className:"h-4 w-4 text-green-600"}),"Active"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:D}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"In service"})]})]}),e.jsxs(H,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Vc,{className:"h-4 w-4 text-yellow-600"}),"Maintenance"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:L}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Under repair"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(FF,{className:"h-4 w-4"}),"Avg Utilization"]})}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[T&&T.length>0?(T.reduce((Ce,Pe)=>Ce+(Pe.utilization_pct||0),0)/T.length).toFixed(1):0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Fleet uptime"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(he,{children:"Fleet Assets"}),e.jsxs(Nt,{value:t.status,onValueChange:Ce=>r({...t,status:Ce,page:1}),children:[e.jsx(bt,{className:"w-[200px]",children:e.jsx(St,{placeholder:"All Statuses"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Statuses"}),e.jsx(ge,{value:"active",children:"Active"}),e.jsx(ge,{value:"maintenance",children:"Maintenance"}),e.jsx(ge,{value:"retired",children:"Retired"})]})]})]})}),e.jsx(X,{children:b?e.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(y!=null&&y.data)||y.data.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No fleet assets registered"}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Registration"}),e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Make/Model"}),e.jsx(se,{children:"Odometer"}),e.jsx(se,{children:"Operator"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:y.data.map(Ce=>{var Pe;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono font-medium",children:Ce.registration}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:Ce.type})}),e.jsxs(J,{children:[Ce.make," ",Ce.model]}),e.jsx(J,{children:Ce.odometer?`${Ce.odometer.toLocaleString()} km`:""}),e.jsx(J,{children:((Pe=Ce.operator)==null?void 0:Pe.name)||"Unassigned"}),e.jsx(J,{children:e.jsx(Ae,{className:Nxe[Ce.status],children:Ce.status})}),e.jsx(J,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{size:"sm",variant:"outline",onClick:()=>{i(Ce),n(!0)},children:e.jsx(Vc,{className:"h-4 w-4"})}),e.jsx(K,{size:"sm",variant:"outline",onClick:()=>{i(Ce),o(!0)},children:e.jsx(FF,{className:"h-4 w-4"})})]})})]},Ce.id)})})]})})]}),e.jsx(Qt,{open:s,onOpenChange:n,children:e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsxs(Xt,{children:["Log Service: ",c==null?void 0:c.registration]})}),e.jsxs("form",{onSubmit:p.handleSubmit(O),className:"space-y-4",children:[e.jsx(pK,{control:p.control,name:"service_type",label:"Service Type",required:!0,options:[{value:"routine",label:"Routine Maintenance"},{value:"repair",label:"Repair"},{value:"inspection",label:"Inspection"},{value:"other",label:"Other"}],error:(U=p.formState.errors.service_type)==null?void 0:U.message}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Hn,{control:p.control,name:"cost",label:"Cost",type:"number",step:"0.01",required:!0,error:(te=p.formState.errors.cost)==null?void 0:te.message}),e.jsx(Hn,{control:p.control,name:"odometer_reading",label:"Odometer (km)",type:"number",step:"1",error:(Q=p.formState.errors.odometer_reading)==null?void 0:Q.message})]}),e.jsx(Tb,{control:p.control,name:"notes",label:"Notes",rows:3,error:(re=p.formState.errors.notes)==null?void 0:re.message}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:N.isPending||!p.formState.isValid,children:"Log Service"})]})]})]})}),e.jsx(Qt,{open:a,onOpenChange:o,children:e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsxs(Xt,{children:["Log Fuel: ",c==null?void 0:c.registration]})}),e.jsxs("form",{onSubmit:g.handleSubmit(C),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Hn,{control:g.control,name:"liters",label:"Liters",type:"number",step:"0.01",required:!0,error:(Z=g.formState.errors.liters)==null?void 0:Z.message}),e.jsx(Hn,{control:g.control,name:"cost",label:"Cost",type:"number",step:"0.01",required:!0,error:(ne=g.formState.errors.cost)==null?void 0:ne.message})]}),e.jsx(Hn,{control:g.control,name:"odometer_reading",label:"Odometer (km)",type:"number",step:"1",required:!0,error:(oe=g.formState.errors.odometer_reading)==null?void 0:oe.message}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:M.isPending||!g.formState.isValid,children:"Log Fuel"})]})]})]})})]})}function kxe(t,r=[]){let s=[];function n(o,c){const i=A.createContext(c),f=s.length;s=[...s,c];function p(y){const{scope:b,children:w,...T}=y,N=(b==null?void 0:b[t][f])||i,M=A.useMemo(()=>T,Object.values(T));return e.jsx(N.Provider,{value:M,children:w})}function g(y,b){const w=(b==null?void 0:b[t][f])||i,T=A.useContext(w);if(T)return T;if(c!==void 0)return c;throw new Error(`\`${y}\` must be used within \`${o}\``)}return p.displayName=o+"Provider",[p,g]}const a=()=>{const o=s.map(c=>A.createContext(c));return function(i){const f=(i==null?void 0:i[t])||o;return A.useMemo(()=>({[`__scope${t}`]:{...i,[t]:f}}),[i,f])}};return a.scopeName=t,[n,Axe(a,...r)]}function Axe(...t){const r=t[0];if(t.length===1)return r;const s=()=>{const n=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(o){const c=n.reduce((i,{useScope:f,scopeName:p})=>{const y=f(o)[`__scope${p}`];return{...i,...y}},{});return A.useMemo(()=>({[`__scope${r.scopeName}`]:c}),[c])}};return s.scopeName=r.scopeName,s}var rT="rovingFocusGroup.onEntryFocus",Txe={bubbles:!1,cancelable:!0},HC="RovingFocusGroup",[DM,xK,Exe]=_C(HC),[Mxe,ZC]=kxe(HC,[Exe]),[Oxe,Ixe]=Mxe(HC),gK=A.forwardRef((t,r)=>e.jsx(DM.Provider,{scope:t.__scopeRovingFocusGroup,children:e.jsx(DM.Slot,{scope:t.__scopeRovingFocusGroup,children:e.jsx(Dxe,{...t,ref:r})})}));gK.displayName=HC;var Dxe=A.forwardRef((t,r)=>{const{__scopeRovingFocusGroup:s,orientation:n,loop:a=!1,dir:o,currentTabStopId:c,defaultCurrentTabStopId:i,onCurrentTabStopIdChange:f,onEntryFocus:p,preventScrollOnEntryFocus:g=!1,...y}=t,b=A.useRef(null),w=ls(r,b),T=dv(o),[N=null,M]=Yc({prop:c,defaultProp:i,onChange:f}),[O,C]=A.useState(!1),D=oi(p),L=xK(s),F=A.useRef(!1),[B,U]=A.useState(0);return A.useEffect(()=>{const te=b.current;if(te)return te.addEventListener(rT,D),()=>te.removeEventListener(rT,D)},[D]),e.jsx(Oxe,{scope:s,orientation:n,dir:T,loop:a,currentTabStopId:N,onItemFocus:A.useCallback(te=>M(te),[M]),onItemShiftTab:A.useCallback(()=>C(!0),[]),onFocusableItemAdd:A.useCallback(()=>U(te=>te+1),[]),onFocusableItemRemove:A.useCallback(()=>U(te=>te-1),[]),children:e.jsx(Tr.div,{tabIndex:O||B===0?-1:0,"data-orientation":n,...y,ref:w,style:{outline:"none",...t.style},onMouseDown:gr(t.onMouseDown,()=>{F.current=!0}),onFocus:gr(t.onFocus,te=>{const Q=!F.current;if(te.target===te.currentTarget&&Q&&!O){const re=new CustomEvent(rT,Txe);if(te.currentTarget.dispatchEvent(re),!re.defaultPrevented){const Z=L().filter(Se=>Se.focusable),ne=Z.find(Se=>Se.active),oe=Z.find(Se=>Se.id===N),Pe=[ne,oe,...Z].filter(Boolean).map(Se=>Se.ref.current);jK(Pe,g)}}F.current=!1}),onBlur:gr(t.onBlur,()=>C(!1))})})}),yK="RovingFocusGroupItem",vK=A.forwardRef((t,r)=>{const{__scopeRovingFocusGroup:s,focusable:n=!0,active:a=!1,tabStopId:o,...c}=t,i=Pi(),f=o||i,p=Ixe(yK,s),g=p.currentTabStopId===f,y=xK(s),{onFocusableItemAdd:b,onFocusableItemRemove:w}=p;return A.useEffect(()=>{if(n)return b(),()=>w()},[n,b,w]),e.jsx(DM.ItemSlot,{scope:s,id:f,focusable:n,active:a,children:e.jsx(Tr.span,{tabIndex:g?0:-1,"data-orientation":p.orientation,...c,ref:r,onMouseDown:gr(t.onMouseDown,T=>{n?p.onItemFocus(f):T.preventDefault()}),onFocus:gr(t.onFocus,()=>p.onItemFocus(f)),onKeyDown:gr(t.onKeyDown,T=>{if(T.key==="Tab"&&T.shiftKey){p.onItemShiftTab();return}if(T.target!==T.currentTarget)return;const N=Fxe(T,p.orientation,p.dir);if(N!==void 0){if(T.metaKey||T.ctrlKey||T.altKey||T.shiftKey)return;T.preventDefault();let O=y().filter(C=>C.focusable).map(C=>C.ref.current);if(N==="last")O.reverse();else if(N==="prev"||N==="next"){N==="prev"&&O.reverse();const C=O.indexOf(T.currentTarget);O=p.loop?$xe(O,C+1):O.slice(C+1)}setTimeout(()=>jK(O))}})})})});vK.displayName=yK;var Rxe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Lxe(t,r){return r!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function Fxe(t,r,s){const n=Lxe(t.key,s);if(!(r==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(r==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return Rxe[n]}function jK(t,r=!1){const s=document.activeElement;for(const n of t)if(n===s||(n.focus({preventScroll:r}),document.activeElement!==s))return}function $xe(t,r){return t.map((s,n)=>t[(r+n)%t.length])}var bK=gK,_K=vK,cD="Tabs",[zxe]=tc(cD,[ZC]),wK=ZC(),[Bxe,dD]=zxe(cD),NK=A.forwardRef((t,r)=>{const{__scopeTabs:s,value:n,onValueChange:a,defaultValue:o,orientation:c="horizontal",dir:i,activationMode:f="automatic",...p}=t,g=dv(i),[y,b]=Yc({prop:n,onChange:a,defaultProp:o});return e.jsx(Bxe,{scope:s,baseId:Pi(),value:y,onValueChange:b,orientation:c,dir:g,activationMode:f,children:e.jsx(Tr.div,{dir:g,"data-orientation":c,...p,ref:r})})});NK.displayName=cD;var SK="TabsList",CK=A.forwardRef((t,r)=>{const{__scopeTabs:s,loop:n=!0,...a}=t,o=dD(SK,s),c=wK(s);return e.jsx(bK,{asChild:!0,...c,orientation:o.orientation,dir:o.dir,loop:n,children:e.jsx(Tr.div,{role:"tablist","aria-orientation":o.orientation,...a,ref:r})})});CK.displayName=SK;var PK="TabsTrigger",kK=A.forwardRef((t,r)=>{const{__scopeTabs:s,value:n,disabled:a=!1,...o}=t,c=dD(PK,s),i=wK(s),f=EK(c.baseId,n),p=MK(c.baseId,n),g=n===c.value;return e.jsx(_K,{asChild:!0,...i,focusable:!a,active:g,children:e.jsx(Tr.button,{type:"button",role:"tab","aria-selected":g,"aria-controls":p,"data-state":g?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:f,...o,ref:r,onMouseDown:gr(t.onMouseDown,y=>{!a&&y.button===0&&y.ctrlKey===!1?c.onValueChange(n):y.preventDefault()}),onKeyDown:gr(t.onKeyDown,y=>{[" ","Enter"].includes(y.key)&&c.onValueChange(n)}),onFocus:gr(t.onFocus,()=>{const y=c.activationMode!=="manual";!g&&!a&&y&&c.onValueChange(n)})})})});kK.displayName=PK;var AK="TabsContent",TK=A.forwardRef((t,r)=>{const{__scopeTabs:s,value:n,forceMount:a,children:o,...c}=t,i=dD(AK,s),f=EK(i.baseId,n),p=MK(i.baseId,n),g=n===i.value,y=A.useRef(g);return A.useEffect(()=>{const b=requestAnimationFrame(()=>y.current=!1);return()=>cancelAnimationFrame(b)},[]),e.jsx(Yi,{present:a||g,children:({present:b})=>e.jsx(Tr.div,{"data-state":g?"active":"inactive","data-orientation":i.orientation,role:"tabpanel","aria-labelledby":f,hidden:!b,id:p,tabIndex:0,...c,ref:r,style:{...t.style,animationDuration:y.current?"0s":void 0},children:b&&o})})});TK.displayName=AK;function EK(t,r){return`${t}-trigger-${r}`}function MK(t,r){return`${t}-content-${r}`}var qxe=NK,OK=CK,IK=kK,DK=TK;const ss=qxe,Yr=A.forwardRef(({className:t,...r},s)=>e.jsx(OK,{ref:s,className:dr("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),...r}));Yr.displayName=OK.displayName;const wt=A.forwardRef(({className:t,...r},s)=>e.jsx(IK,{ref:s,className:dr("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",t),...r}));wt.displayName=IK.displayName;const kt=A.forwardRef(({className:t,...r},s)=>e.jsx(DK,{ref:s,className:dr("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r}));kt.displayName=DK.displayName;const Vxe={draft:"bg-gray-100 text-gray-800",active:"bg-green-100 text-green-800",completed:"bg-blue-100 text-blue-800",terminated:"bg-red-100 text-red-800"},Uxe=Ld({contract_num:wa().min(1,"Contract number is required"),vendor_name:wa().min(1,"Vendor name is required"),type:WS(["maintenance","construction","supply","consulting"]),value:qi().positive("Contract value must be positive"),start_date:wa().min(1,"Start date is required"),end_date:wa().min(1,"End date is required"),description:wa().optional()}),Wxe=Ld({description:wa().min(1,"Description is required"),penalty_amount:qi().positive("Penalty amount must be positive")});function Gxe(){var B,U,te,Q,re,Z,ne,oe,Ce,Pe,Se,ae;const[t,r]=A.useState({page:1,per_page:15,status:"active"}),[s,n]=A.useState(!1),[a,o]=A.useState(!1),[c,i]=A.useState(null),f=yr(),p=Ya({resolver:Ed(Uxe),defaultValues:{contract_num:"",vendor_name:"",type:"maintenance",value:0,start_date:"",end_date:"",description:""}}),g=Ya({resolver:Ed(Wxe),defaultValues:{description:"",penalty_amount:0}});A.useEffect(()=>{s||p.reset()},[s,p]),A.useEffect(()=>{a||(g.reset(),i(null))},[a,g]);const{data:y,isLoading:b,error:w}=it({queryKey:["service-contracts",t],queryFn:()=>h0.getContracts(t)}),{data:T}=it({queryKey:["vendor-scores"],queryFn:()=>h0.getVendorScore({})}),{data:N}=it({queryKey:["expiring-contracts"],queryFn:()=>h0.getExpiringContracts({days:90})}),M=gt({mutationFn:h0.createContract,onSuccess:()=>{f.invalidateQueries({queryKey:["service-contracts"]}),n(!1),Me.success("Contract created successfully")},onError:()=>Me.error("Failed to create contract")}),O=gt({mutationFn:({contractId:be,data:de})=>h0.recordViolation(be,de),onSuccess:()=>{f.invalidateQueries({queryKey:["service-contracts"]}),o(!1),Me.success("SLA violation recorded")},onError:()=>Me.error("Failed to record violation")}),C=be=>{M.mutate({...be,status:"active"})},D=be=>{if(!c){Me.error("No contract selected");return}O.mutate({contractId:c.id,data:{description:be.description,penalty_amount:be.penalty_amount,occurred_at:new Date().toISOString()}})},L=((B=y==null?void 0:y.data)==null?void 0:B.filter(be=>be.status==="active").length)||0,F=((U=y==null?void 0:y.data)==null?void 0:U.reduce((be,de)=>be+(de.value||0),0))||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Contractor & SLA Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Service contracts and vendor performance tracking"})]}),e.jsxs(Qt,{open:s,onOpenChange:n,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"New Contract"]})}),e.jsxs(Zt,{className:"max-w-2xl",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Create Service Contract"})}),e.jsxs("form",{onSubmit:p.handleSubmit(C),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Hn,{control:p.control,name:"contract_num",label:"Contract Number",required:!0,error:(te=p.formState.errors.contract_num)==null?void 0:te.message}),e.jsx(Hn,{control:p.control,name:"vendor_name",label:"Vendor Name",required:!0,error:(Q=p.formState.errors.vendor_name)==null?void 0:Q.message})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(pK,{control:p.control,name:"type",label:"Contract Type",required:!0,options:[{value:"maintenance",label:"Maintenance"},{value:"construction",label:"Construction"},{value:"supply",label:"Supply"},{value:"consulting",label:"Consulting"}],error:(re=p.formState.errors.type)==null?void 0:re.message}),e.jsx(Hn,{control:p.control,name:"value",label:"Contract Value",type:"number",step:"0.01",required:!0,error:(Z=p.formState.errors.value)==null?void 0:Z.message})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Hn,{control:p.control,name:"start_date",label:"Start Date",type:"date",required:!0,error:(ne=p.formState.errors.start_date)==null?void 0:ne.message}),e.jsx(Hn,{control:p.control,name:"end_date",label:"End Date",type:"date",required:!0,error:(oe=p.formState.errors.end_date)==null?void 0:oe.message})]}),e.jsx(Tb,{control:p.control,name:"description",label:"Description",rows:3,error:(Ce=p.formState.errors.description)==null?void 0:Ce.message}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:M.isPending||!p.formState.isValid,children:"Create"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(bs,{className:"h-4 w-4"}),"Active Contracts"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:L}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total contracts"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(zs,{className:"h-4 w-4"}),"Contract Value"]})}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",F.toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total active value"})]})]}),e.jsxs(H,{className:"border-orange-200 bg-orange-50",children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx($s,{className:"h-4 w-4 text-orange-600"}),"Expiring Soon"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:(N==null?void 0:N.length)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Next 90 days"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Nn,{className:"h-4 w-4"}),"SLA Violations"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:((Pe=y==null?void 0:y.data)==null?void 0:Pe.reduce((be,de)=>{var Ke;return be+(((Ke=de.violations)==null?void 0:Ke.length)||0)},0))||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This period"})]})]})]}),e.jsxs(ss,{defaultValue:"contracts",className:"space-y-4",children:[e.jsxs(Yr,{children:[e.jsx(wt,{value:"contracts",children:"Contracts"}),e.jsx(wt,{value:"vendors",children:"Vendor Scorecards"}),e.jsx(wt,{value:"expiring",children:"Expiring"})]}),e.jsx(kt,{value:"contracts",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(he,{children:"Service Contracts"}),e.jsxs(Nt,{value:t.status||"all",onValueChange:be=>{const{status:de,...Ke}=t;r(be==="all"?{...Ke,page:1}:{...Ke,status:be,page:1})},children:[e.jsx(bt,{className:"w-[200px]",children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Statuses"}),e.jsx(ge,{value:"active",children:"Active"}),e.jsx(ge,{value:"completed",children:"Completed"}),e.jsx(ge,{value:"terminated",children:"Terminated"})]})]})]})}),e.jsx(X,{children:b?e.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(y!=null&&y.data)||y.data.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No contracts found"}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Contract #"}),e.jsx(se,{children:"Vendor"}),e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Value"}),e.jsx(se,{children:"Period"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:y.data.map(be=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono",children:be.contract_num}),e.jsx(J,{className:"font-medium",children:be.vendor_name}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:be.type})}),e.jsxs(J,{children:["$",be.value.toLocaleString()]}),e.jsxs(J,{className:"text-sm",children:[new Date(be.start_date).toLocaleDateString()," -",e.jsx("br",{}),new Date(be.end_date).toLocaleDateString()]}),e.jsx(J,{children:e.jsx(Ae,{className:Vxe[be.status],children:be.status})}),e.jsx(J,{children:e.jsx(K,{size:"sm",variant:"outline",onClick:()=>{i(be),o(!0)},children:"Log Violation"})})]},be.id))})]})})]})}),e.jsx(kt,{value:"vendors",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Vendor Performance Scorecards"})}),e.jsx(X,{children:T&&T.length>0?e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Vendor"}),e.jsx(se,{children:"Quality"}),e.jsx(se,{children:"Timeliness"}),e.jsx(se,{children:"Compliance"}),e.jsx(se,{children:"Overall Score"})]})}),e.jsx(lr,{children:T.map(be=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:be.vendor_name}),e.jsx(J,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Wi,{value:be.quality_score,className:"w-24"}),e.jsxs("span",{className:"text-sm",children:[be.quality_score,"%"]})]})}),e.jsx(J,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Wi,{value:be.timeliness_score,className:"w-24"}),e.jsxs("span",{className:"text-sm",children:[be.timeliness_score,"%"]})]})}),e.jsx(J,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Wi,{value:be.compliance_score,className:"w-24"}),e.jsxs("span",{className:"text-sm",children:[be.compliance_score,"%"]})]})}),e.jsx(J,{children:e.jsxs(Ae,{variant:be.overall_score>=80?"default":"secondary",children:[be.overall_score,"%"]})})]},be.id))})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No vendor scorecards available"})})]})}),e.jsx(kt,{value:"expiring",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Contracts Expiring Soon"})}),e.jsx(X,{children:N&&N.length>0?e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Contract #"}),e.jsx(se,{children:"Vendor"}),e.jsx(se,{children:"End Date"}),e.jsx(se,{children:"Days Left"}),e.jsx(se,{children:"Value"})]})}),e.jsx(lr,{children:N.map(be=>{const de=Math.ceil((new Date(be.end_date).getTime()-Date.now())/864e5);return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono",children:be.contract_num}),e.jsx(J,{className:"font-medium",children:be.vendor_name}),e.jsx(J,{children:new Date(be.end_date).toLocaleDateString()}),e.jsx(J,{children:e.jsxs(Ae,{variant:de<=30?"destructive":"secondary",children:[de," days"]})}),e.jsxs(J,{children:["$",be.value.toLocaleString()]})]},be.id)})})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No contracts expiring soon"})})]})})]}),e.jsx(Qt,{open:a,onOpenChange:o,children:e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Record SLA Violation"})}),e.jsxs("form",{onSubmit:g.handleSubmit(D),className:"space-y-4",children:[e.jsxs("div",{className:"bg-muted p-3 rounded-md text-sm",children:[e.jsx("strong",{children:"Contract:"})," ",c==null?void 0:c.contract_num," - ",c==null?void 0:c.vendor_name]}),e.jsx(Tb,{control:g.control,name:"description",label:"Violation Description",placeholder:"Describe the SLA breach...",rows:3,required:!0,error:(Se=g.formState.errors.description)==null?void 0:Se.message}),e.jsx(Hn,{control:g.control,name:"penalty_amount",label:"Penalty Amount",type:"number",step:"0.01",required:!0,error:(ae=g.formState.errors.penalty_amount)==null?void 0:ae.message}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:O.isPending||!g.formState.isValid,children:"Record Violation"})]})]})]})})]})}const Kxe={pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",closed:"bg-gray-100 text-gray-800"},Hxe={minor:"bg-blue-100 text-blue-800",moderate:"bg-yellow-100 text-yellow-800",serious:"bg-orange-100 text-orange-800",fatal:"bg-red-100 text-red-800"};function Zxe(){var Se,ae,be;const[t,r]=A.useState({page:1,per_page:15,status:"all"}),[s,n]=A.useState({page:1,per_page:15,status:"open"}),[a,o]=A.useState({page:1,per_page:15,status:"open"}),[c,i]=A.useState(!1),[f,p]=A.useState(!1),[g,y]=A.useState(!1),b=yr(),{data:w,isLoading:T,error:N}=it({queryKey:["hse-permits",t],queryFn:()=>Mf.getPermits(t)}),{data:M,isLoading:O,error:C}=it({queryKey:["hse-incidents",s],queryFn:()=>Mf.getIncidents(s)}),{data:D,isLoading:L,error:F}=it({queryKey:["hse-capas",a],queryFn:()=>Mf.getCapas(a)}),{data:B}=it({queryKey:["incident-stats"],queryFn:()=>Mf.getIncidentStats({})}),U=gt({mutationFn:Mf.createPermit,onSuccess:()=>{b.invalidateQueries({queryKey:["hse-permits"]}),i(!1),Me.success("Permit request created successfully")},onError:()=>Me.error("Failed to create permit")}),te=gt({mutationFn:Mf.createIncident,onSuccess:()=>{b.invalidateQueries({queryKey:["hse-incidents"]}),b.invalidateQueries({queryKey:["incident-stats"]}),p(!1),Me.success("Incident reported successfully")},onError:()=>Me.error("Failed to report incident")}),Q=gt({mutationFn:Mf.createCapa,onSuccess:()=>{b.invalidateQueries({queryKey:["hse-capas"]}),y(!1),Me.success("CAPA created successfully")},onError:()=>Me.error("Failed to create CAPA")}),re=de=>{de.preventDefault();const Ke=new FormData(de.currentTarget),He={permit_type:Ke.get("permit_type"),description:Ke.get("description"),location:Ke.get("location"),valid_from:Ke.get("valid_from"),valid_until:Ke.get("valid_until"),status:"pending"};U.mutate(He)},Z=de=>{de.preventDefault();const Ke=new FormData(de.currentTarget),He={category:Ke.get("category"),severity:Ke.get("severity"),description:Ke.get("description"),location:Ke.get("location"),occurred_at:Ke.get("occurred_at"),status:"open"};te.mutate(He)},ne=de=>{de.preventDefault();const Ke=new FormData(de.currentTarget),He=Ke.get("assigned_to");if(!He){Me.error("Please enter a user ID"),de.currentTarget.reset();return}const Ve={type:Ke.get("type"),description:Ke.get("description"),due_date:Ke.get("due_date"),assigned_to:He,status:"open"};Q.mutate(Ve)},oe=((Se=w==null?void 0:w.data)==null?void 0:Se.filter(de=>de.status==="pending").length)||0,Ce=((ae=M==null?void 0:M.data)==null?void 0:ae.filter(de=>de.status==="open").length)||0,Pe=((be=D==null?void 0:D.data)==null?void 0:be.filter(de=>de.status==="open").length)||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"HSE Safety Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Health, Safety, and Environment compliance"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Yae,{className:"h-4 w-4 text-yellow-600"}),"Pending Permits"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:oe}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting approval"})]})]}),e.jsxs(H,{className:"border-red-200 bg-red-50",children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Fr,{className:"h-4 w-4 text-red-600"}),"Open Incidents"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:Ce}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Under investigation"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Gae,{className:"h-4 w-4"}),"Open CAPAs"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Pe}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Actions pending"})]})]}),e.jsxs(H,{className:"border-green-200 bg-green-50",children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ka,{className:"h-4 w-4 text-green-600"}),"Days Since LTI"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:(B==null?void 0:B.days_since_lti)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Lost-time injury free"})]})]})]}),e.jsxs(ss,{defaultValue:"permits",className:"space-y-4",children:[e.jsxs(Yr,{children:[e.jsx(wt,{value:"permits",children:"Work Permits"}),e.jsx(wt,{value:"incidents",children:"Incidents"}),e.jsx(wt,{value:"capas",children:"CAPAs"})]}),e.jsx(kt,{value:"permits",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(he,{children:"Work Permits"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Nt,{value:t.status,onValueChange:de=>r({...t,status:de,page:1}),children:[e.jsx(bt,{className:"w-[200px]",children:e.jsx(St,{placeholder:"All Statuses"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Statuses"}),e.jsx(ge,{value:"pending",children:"Pending"}),e.jsx(ge,{value:"approved",children:"Approved"}),e.jsx(ge,{value:"rejected",children:"Rejected"}),e.jsx(ge,{value:"closed",children:"Closed"})]})]}),e.jsxs(Qt,{open:c,onOpenChange:i,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Request Permit"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Request Work Permit"})}),e.jsxs("form",{onSubmit:re,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"permit_type",children:"Permit Type"}),e.jsxs(Nt,{name:"permit_type",required:!0,children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"hot_work",children:"Hot Work"}),e.jsx(ge,{value:"confined_space",children:"Confined Space"}),e.jsx(ge,{value:"working_at_height",children:"Working at Height"}),e.jsx(ge,{value:"loto",children:"LOTO"}),e.jsx(ge,{value:"excavation",children:"Excavation"})]})]})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"location",children:"Location"}),e.jsx(Ie,{id:"location",name:"location",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"valid_from",children:"Valid From"}),e.jsx(Ie,{id:"valid_from",name:"valid_from",type:"datetime-local",required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"valid_until",children:"Valid Until"}),e.jsx(Ie,{id:"valid_until",name:"valid_until",type:"datetime-local",required:!0})]})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"description",children:"Description"}),e.jsx(ws,{id:"description",name:"description",rows:3,required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:U.isPending,children:"Submit Request"})]})]})]})]})]})]})}),e.jsx(X,{children:T?e.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(w!=null&&w.data)||w.data.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No work permits"}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Permit Type"}),e.jsx(se,{children:"Description"}),e.jsx(se,{children:"Valid Period"}),e.jsx(se,{children:"Requested By"}),e.jsx(se,{children:"Status"})]})}),e.jsx(lr,{children:w.data.map(de=>{var Ke;return e.jsxs(Qe,{children:[e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:de.permit_type})}),e.jsx(J,{className:"max-w-md truncate",children:de.description}),e.jsxs(J,{className:"text-sm",children:[new Date(de.valid_from).toLocaleDateString()," -",e.jsx("br",{}),new Date(de.valid_until).toLocaleDateString()]}),e.jsx(J,{children:((Ke=de.requested_by_user)==null?void 0:Ke.name)||"Unknown"}),e.jsx(J,{children:e.jsx(Ae,{className:Kxe[de.status],children:de.status})})]},de.id)})})]})})]})}),e.jsx(kt,{value:"incidents",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(he,{children:"Safety Incidents"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Nt,{value:s.status,onValueChange:de=>n({...s,status:de,page:1}),children:[e.jsx(bt,{className:"w-[200px]",children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Statuses"}),e.jsx(ge,{value:"open",children:"Open"}),e.jsx(ge,{value:"investigated",children:"Investigated"}),e.jsx(ge,{value:"closed",children:"Closed"})]})]}),e.jsxs(Qt,{open:f,onOpenChange:p,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Report Incident"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Report Safety Incident"})}),e.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"category",children:"Category"}),e.jsxs(Nt,{name:"category",required:!0,children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"injury",children:"Injury"}),e.jsx(ge,{value:"property_damage",children:"Property Damage"}),e.jsx(ge,{value:"environmental",children:"Environmental"}),e.jsx(ge,{value:"near_miss",children:"Near Miss"}),e.jsx(ge,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"severity",children:"Severity"}),e.jsxs(Nt,{name:"severity",required:!0,children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"minor",children:"Minor"}),e.jsx(ge,{value:"moderate",children:"Moderate"}),e.jsx(ge,{value:"serious",children:"Serious"}),e.jsx(ge,{value:"fatal",children:"Fatal"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"location",children:"Location"}),e.jsx(Ie,{id:"location",name:"location",required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"occurred_at",children:"Occurred At"}),e.jsx(Ie,{id:"occurred_at",name:"occurred_at",type:"datetime-local",required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"description",children:"Description"}),e.jsx(ws,{id:"description",name:"description",rows:4,required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:te.isPending,children:"Report Incident"})]})]})]})]})]})]})}),e.jsx(X,{children:O?e.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(M!=null&&M.data)||M.data.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No incidents reported"}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Occurred At"}),e.jsx(se,{children:"Category"}),e.jsx(se,{children:"Severity"}),e.jsx(se,{children:"Location"}),e.jsx(se,{children:"Reported By"}),e.jsx(se,{children:"Status"})]})}),e.jsx(lr,{children:M.data.map(de=>{var Ke;return e.jsxs(Qe,{children:[e.jsx(J,{children:new Date(de.occurred_at).toLocaleString()}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:de.category})}),e.jsx(J,{children:e.jsx(Ae,{className:Hxe[de.severity],children:de.severity})}),e.jsx(J,{children:de.location}),e.jsx(J,{children:((Ke=de.reported_by_user)==null?void 0:Ke.name)||"Unknown"}),e.jsx(J,{children:e.jsx(Ae,{variant:de.status==="closed"?"default":"secondary",children:de.status})})]},de.id)})})]})})]})}),e.jsx(kt,{value:"capas",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(he,{children:"Corrective & Preventive Actions"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Nt,{value:a.status,onValueChange:de=>o({...a,status:de,page:1}),children:[e.jsx(bt,{className:"w-[200px]",children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Statuses"}),e.jsx(ge,{value:"open",children:"Open"}),e.jsx(ge,{value:"completed",children:"Completed"})]})]}),e.jsxs(Qt,{open:g,onOpenChange:y,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Create CAPA"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Create CAPA"})}),e.jsxs("form",{onSubmit:ne,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"type",children:"Type"}),e.jsxs(Nt,{name:"type",required:!0,children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"corrective",children:"Corrective Action"}),e.jsx(ge,{value:"preventive",children:"Preventive Action"})]})]})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"description",children:"Description"}),e.jsx(ws,{id:"description",name:"description",rows:4,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"assigned_to",children:"Assign To (User ID)"}),e.jsx(Ie,{id:"assigned_to",name:"assigned_to",type:"number",required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"due_date",children:"Due Date"}),e.jsx(Ie,{id:"due_date",name:"due_date",type:"date",required:!0})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>y(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:Q.isPending,children:"Create CAPA"})]})]})]})]})]})]})}),e.jsx(X,{children:L?e.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(D!=null&&D.data)||D.data.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No CAPAs created"}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Description"}),e.jsx(se,{children:"Assigned To"}),e.jsx(se,{children:"Due Date"}),e.jsx(se,{children:"Status"})]})}),e.jsx(lr,{children:D.data.map(de=>{var He;const Ke=de.status==="open"&&new Date(de.due_date)<new Date;return e.jsxs(Qe,{children:[e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:de.type})}),e.jsx(J,{className:"max-w-md truncate",children:de.description}),e.jsx(J,{children:((He=de.assigned_to_user)==null?void 0:He.name)||"Unassigned"}),e.jsx(J,{children:e.jsxs("span",{className:Ke?"text-red-600 font-semibold":"",children:[new Date(de.due_date).toLocaleDateString(),Ke&&" (Overdue)"]})}),e.jsx(J,{children:e.jsx(Ae,{variant:de.status==="completed"?"default":"secondary",children:de.status})})]},de.id)})})]})})]})})]})]})}const w$=[{value:"low",label:"Low",color:"bg-gray-100 text-gray-800"},{value:"medium",label:"Medium",color:"bg-yellow-100 text-yellow-800"},{value:"high",label:"High",color:"bg-orange-100 text-orange-800"},{value:"critical",label:"Critical",color:"bg-red-100 text-red-800"}],Yxe=["string","number","boolean","date"];function Xxe(){var ae,be;const{user:t}=Lm(),r=((ae=t==null?void 0:t.role_names)==null?void 0:ae.includes("Super Admin"))??!1,[s,n]=A.useState(""),[a,o]=A.useState(!1),[c,i]=A.useState(!1),[f,p]=A.useState(null),[g,y]=A.useState(null),[b,w]=A.useState({code:"",name:"",parent_id:null,criticality:"medium",attributes_schema:{}}),[T,N]=A.useState(""),[M,O]=A.useState("string"),C=yr(),{data:D,isLoading:L,error:F}=it({queryKey:["asset-classes",s],queryFn:()=>pe.get("/asset-classes",s?{search:s}:{})}),B=gt({mutationFn:de=>pe.post("/asset-classes",de),onSuccess:()=>{C.invalidateQueries({queryKey:["asset-classes"]}),Me.success("Asset class created successfully"),re()},onError:de=>{Me.error(de.message||"Failed to create asset class")}}),U=gt({mutationFn:({id:de,data:Ke})=>pe.put(`/asset-classes/${de}`,Ke),onSuccess:()=>{C.invalidateQueries({queryKey:["asset-classes"]}),Me.success("Asset class updated successfully"),re()},onError:de=>{Me.error(de.message||"Failed to update asset class")}}),te=gt({mutationFn:de=>pe.delete(`/asset-classes/${de}`),onSuccess:()=>{C.invalidateQueries({queryKey:["asset-classes"]}),Me.success("Asset class deleted successfully"),i(!1),y(null)},onError:de=>{Me.error(de.message||"Failed to delete asset class")}}),Q=de=>{if(de){p(de);let Ke={};if(de.attributes_schema)try{Ke=typeof de.attributes_schema=="string"?JSON.parse(de.attributes_schema):de.attributes_schema}catch{Ke={}}w({code:de.code,name:de.name,parent_id:de.parent_id,criticality:de.criticality,attributes_schema:Ke})}else p(null),w({code:"",name:"",parent_id:null,criticality:"medium",attributes_schema:{}});o(!0)},re=()=>{o(!1),p(null),w({code:"",name:"",parent_id:null,criticality:"medium",attributes_schema:{}}),N(""),O("string")},Z=de=>{de.preventDefault(),f?U.mutate({id:f.id,data:b}):B.mutate(b)},ne=()=>{T&&!b.attributes_schema[T]&&(w({...b,attributes_schema:{...b.attributes_schema,[T]:M}}),N(""),O("string"))},oe=de=>{const{[de]:Ke,...He}=b.attributes_schema;w({...b,attributes_schema:He})},Ce=de=>{y(de),i(!0)},Pe=de=>{const Ke=w$.find(He=>He.value===de);return e.jsx(Ae,{className:(Ke==null?void 0:Ke.color)||"bg-gray-100 text-gray-800",children:(Ke==null?void 0:Ke.label)||de})},Se=de=>{if(!de||!D)return"-";const Ke=D.find(He=>He.id===de);return(Ke==null?void 0:Ke.name)||"-"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Asset Classes"}),e.jsx("p",{className:"text-muted-foreground",children:"Define and manage asset classification hierarchy"})]}),r&&e.jsxs(K,{onClick:()=>Q(),children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Add Asset Class"]})]}),!r&&e.jsxs(zn,{children:[e.jsx(tM,{className:"h-4 w-4"}),e.jsx(An,{children:"Asset classes are shared configuration across all counties. Only Super Admins can create, edit, or delete asset classes."})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(nn,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search by code or name...",className:"pl-9",value:s,onChange:de=>n(de.target.value)})]})})}),e.jsx(X,{children:L?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading asset classes..."})}):F?e.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:e.jsx("p",{className:"text-lg text-destructive",children:"Error loading asset classes"})}):D!=null&&D.length?e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Code"}),e.jsx(se,{children:"Name"}),e.jsx(se,{children:"Parent"}),e.jsx(se,{children:"Criticality"}),e.jsx(se,{children:"Attributes"}),e.jsx(se,{className:"text-right",children:"Actions"})]})}),e.jsx(lr,{children:D.map(de=>{let Ke=0;if(de.attributes_schema)try{const He=typeof de.attributes_schema=="string"?JSON.parse(de.attributes_schema):de.attributes_schema;Ke=Object.keys(He).length}catch{Ke=0}return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono font-medium",children:de.code}),e.jsx(J,{children:de.name}),e.jsx(J,{className:"text-muted-foreground",children:Se(de.parent_id)}),e.jsx(J,{children:Pe(de.criticality)}),e.jsx(J,{children:e.jsxs(Ae,{variant:"outline",children:[Ke," attributes"]})}),e.jsx(J,{className:"text-right",children:r?e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{variant:"ghost",size:"icon",onClick:()=>Q(de),children:e.jsx(ki,{className:"h-4 w-4"})}),e.jsx(K,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive",onClick:()=>Ce(de),children:e.jsx(Ws,{className:"h-4 w-4"})})]}):e.jsx("span",{className:"text-muted-foreground text-sm",children:"View only"})})]},de.id)})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(cv,{className:"mx-auto h-12 w-12 text-muted-foreground"}),e.jsx("h3",{className:"mt-4 text-lg font-medium",children:"No asset classes found"}),e.jsx("p",{className:"mt-2 text-muted-foreground",children:r?"Create your first asset class to start categorizing assets.":"No asset classes have been configured yet. Please contact a Super Admin."}),r&&e.jsxs(K,{className:"mt-4",onClick:()=>Q(),children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Add Asset Class"]})]})})]}),e.jsx(Qt,{open:a,onOpenChange:o,children:e.jsxs(Zt,{className:"max-w-2xl",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:f?"Edit Asset Class":"Create Asset Class"}),e.jsx(Es,{children:f?"Update the asset class details below.":"Define a new asset class for categorizing assets."})]}),e.jsxs("form",{onSubmit:Z,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"code",children:"Code"}),e.jsx(Ie,{id:"code",placeholder:"e.g., PUMP, VALVE",value:b.code,onChange:de=>w({...b,code:de.target.value.toUpperCase()}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"name",children:"Name"}),e.jsx(Ie,{id:"name",placeholder:"e.g., Pumps, Valves",value:b.name,onChange:de=>w({...b,name:de.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"parent",children:"Parent Class (Optional)"}),e.jsxs(Nt,{value:((be=b.parent_id)==null?void 0:be.toString())||"none",onValueChange:de=>w({...b,parent_id:de==="none"?null:Number(de)}),children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select parent class"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"none",children:"No parent"}),D==null?void 0:D.filter(de=>de.id!==(f==null?void 0:f.id)).map(de=>e.jsx(ge,{value:de.id.toString(),children:de.name},de.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"criticality",children:"Criticality"}),e.jsxs(Nt,{value:b.criticality,onValueChange:de=>w({...b,criticality:de}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsx(_t,{children:w$.map(de=>e.jsx(ge,{value:de.value,children:de.label},de.value))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Custom Attributes Schema"}),e.jsx(H,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[Object.entries(b.attributes_schema).map(([de,Ke])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Ae,{variant:"secondary",className:"flex-1 justify-start",children:[e.jsx("span",{className:"font-mono",children:de}),e.jsxs("span",{className:"ml-2 text-muted-foreground",children:["(",Ke,")"]})]}),e.jsx(K,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>oe(de),children:e.jsx(Ws,{className:"h-4 w-4"})})]},de)),e.jsxs("div",{className:"flex gap-2 pt-2 border-t",children:[e.jsx(Ie,{placeholder:"Attribute name (e.g., rated_power_kw)",value:T,onChange:de=>N(de.target.value.toLowerCase().replace(/\s+/g,"_")),className:"flex-1"}),e.jsxs(Nt,{value:M,onValueChange:O,children:[e.jsx(bt,{className:"w-32",children:e.jsx(St,{})}),e.jsx(_t,{children:Yxe.map(de=>e.jsx(ge,{value:de,children:de},de))})]}),e.jsx(K,{type:"button",variant:"outline",onClick:ne,disabled:!T,children:"Add"})]})]})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Define custom attributes that assets of this class should have."})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{type:"button",variant:"outline",onClick:re,children:"Cancel"}),e.jsx(K,{type:"submit",disabled:B.isPending||U.isPending,children:B.isPending||U.isPending?"Saving...":f?"Update":"Create"})]})]})]})}),e.jsx(KC,{open:c,onOpenChange:i,children:e.jsxs(B_,{children:[e.jsxs(q_,{children:[e.jsx(U_,{children:"Delete Asset Class"}),e.jsxs(W_,{children:['Are you sure you want to delete "',g==null?void 0:g.name,'"? This action cannot be undone.',(g==null?void 0:g.assets_count)&&g.assets_count>0&&e.jsxs("span",{className:"block mt-2 text-destructive font-medium",children:["Warning: This class has ",g.assets_count," assets assigned to it."]})]})]}),e.jsxs(V_,{children:[e.jsx(K_,{children:"Cancel"}),e.jsx(G_,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:()=>g&&te.mutate(g.id),disabled:te.isPending,children:te.isPending?"Deleting...":"Delete"})]})]})})]})}function Qxe(){return e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx(Ti,{}),e.jsx("main",{className:"flex-1 p-8 overflow-auto",children:e.jsx(Ai,{})})]})}function Jxe({open:t,onOpenChange:r,parameter:s}){const n=yr(),a=!!s,{register:o,handleSubmit:c,reset:i,setValue:f,formState:{errors:p}}=Ya({defaultValues:s||{category:"physical"}}),g=gt({mutationFn:w=>pe.post("/water-quality/parameters",w),onSuccess:()=>{n.invalidateQueries({queryKey:["water-quality-parameters"]}),Me.success("Parameter created successfully"),r(!1),i()},onError:w=>{Me.error(w.message||"Failed to create parameter")}}),y=gt({mutationFn:w=>pe.patch(`/water-quality/parameters/${s.id}`,w),onSuccess:()=>{n.invalidateQueries({queryKey:["water-quality-parameters"]}),Me.success("Parameter updated successfully"),r(!1)},onError:w=>{Me.error(w.message||"Failed to update parameter")}}),b=w=>{const T={...w,who_limit:w.who_limit||void 0,wasreb_limit:w.wasreb_limit||void 0,local_limit:w.local_limit||void 0,lod:w.lod||void 0,precision:w.precision||void 0};a?y.mutate(T):g.mutate(T)};return A.useEffect(()=>{i(s||{category:"physical"})},[s,i]),e.jsx(Qt,{open:t,onOpenChange:r,children:e.jsxs(Zt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:a?"Edit Parameter":"Create New Parameter"}),e.jsx(Es,{children:a?"Update water quality parameter":"Add a new water quality parameter"})]}),e.jsxs("form",{onSubmit:c(b),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"name",children:"Parameter Name *"}),e.jsx(Ie,{id:"name",...o("name",{required:!0}),placeholder:"e.g., pH"}),p.name&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"code",children:"Code *"}),e.jsx(Ie,{id:"code",...o("code",{required:!0}),placeholder:"e.g., PH"}),p.code&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"category",children:"Category *"}),e.jsxs(Nt,{onValueChange:w=>f("category",w),defaultValue:(s==null?void 0:s.category)||"physical",children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select category"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"physical",children:"Physical"}),e.jsx(ge,{value:"chemical",children:"Chemical"}),e.jsx(ge,{value:"biological",children:"Biological"}),e.jsx(ge,{value:"radiological",children:"Radiological"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"unit",children:"Unit *"}),e.jsx(Ie,{id:"unit",...o("unit",{required:!0}),placeholder:"e.g., mg/L, CFU/100mL, pH units"}),p.unit&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"who_limit",children:"WHO Limit"}),e.jsx(Ie,{id:"who_limit",type:"number",step:"any",...o("who_limit"),placeholder:"Optional"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"wasreb_limit",children:"WASREB Limit"}),e.jsx(Ie,{id:"wasreb_limit",type:"number",step:"any",...o("wasreb_limit"),placeholder:"Optional"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"local_limit",children:"Local Limit"}),e.jsx(Ie,{id:"local_limit",type:"number",step:"any",...o("local_limit"),placeholder:"Optional"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"lod",children:"Limit of Detection (LOD)"}),e.jsx(Ie,{id:"lod",type:"number",step:"any",...o("lod"),placeholder:"Optional"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"precision",children:"Precision"}),e.jsx(Ie,{id:"precision",type:"number",step:"1",...o("precision"),placeholder:"Decimal places (e.g., 2)"})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:g.isPending||y.isPending,children:g.isPending||y.isPending?"Saving...":a?"Update":"Create"})]})]})]})})}function ege(){var w,T,N;const[t,r]=A.useState(1),[s,n]=A.useState(!1),[a,o]=A.useState(void 0),c=yr(),{data:i,isLoading:f}=it({queryKey:["water-quality-parameters",t],queryFn:async()=>pe.get("/water-quality/parameters",{page:t,per_page:20})}),p=gt({mutationFn:M=>pe.delete(`/water-quality/parameters/${M}`),onSuccess:()=>{c.invalidateQueries({queryKey:["water-quality-parameters"]}),Me.success("Parameter deleted successfully")},onError:M=>{Me.error(M.message||"Failed to delete parameter")}}),g=M=>{o(M),n(!0)},y=M=>{confirm("Are you sure you want to delete this parameter?")&&p.mutate(M)},b=()=>{o(void 0),n(!0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Water Quality Parameters"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage physical, chemical, and biological parameters for water quality testing"})]}),e.jsxs(K,{onClick:b,children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Add Parameter"]})]}),e.jsx(Jxe,{open:s,onOpenChange:n,parameter:a}),f?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(as,{className:"h-8 w-8 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-2 text-muted-foreground",children:"Loading parameters..."})]}):((w=i==null?void 0:i.data)==null?void 0:w.length)===0?e.jsx(H,{children:e.jsxs(X,{className:"py-12 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"No parameters found"}),e.jsxs(K,{onClick:b,children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Add Your First Parameter"]})]})}):e.jsx(qm,{className:"h-[calc(100vh-280px)] pr-4",children:e.jsx("div",{className:"grid gap-4 pb-4",children:(T=i==null?void 0:i.data)==null?void 0:T.map(M=>e.jsxs(H,{className:"hover:shadow-md transition-shadow",children:[e.jsx(ue,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(he,{className:"text-xl",children:M.name}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ae,{variant:"outline",children:M.category||"physical"}),e.jsx(Ae,{variant:"secondary",children:M.unit})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>g(M),disabled:p.isPending,children:e.jsx(gI,{className:"h-4 w-4"})}),e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>y(M.id),disabled:p.isPending,children:p.isPending?e.jsx(as,{className:"h-4 w-4 animate-spin"}):e.jsx(Ws,{className:"h-4 w-4"})})]})]})}),e.jsx(X,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"WHO Limit:"}),e.jsx("p",{className:"font-medium",children:M.who_limit?`${M.who_limit} ${M.unit}`:"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"WASREB Limit:"}),e.jsx("p",{className:"font-medium",children:M.wasreb_limit?`${M.wasreb_limit} ${M.unit}`:"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Local Limit:"}),e.jsx("p",{className:"font-medium",children:M.local_limit?`${M.local_limit} ${M.unit}`:"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"LOD:"}),e.jsx("p",{className:"font-medium",children:M.lod?`${M.lod} ${M.unit}`:"N/A"})]})]})})]},M.id))})}),(i==null?void 0:i.meta)&&i.meta.total>0&&e.jsxs("div",{className:"flex items-center justify-between border-t pt-4 bg-background sticky bottom-0",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",i.meta.from||1," to ",i.meta.to||((N=i.data)==null?void 0:N.length)," of ",i.meta.total," parameters"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",t," of ",i.meta.last_page||1]}),e.jsxs(K,{variant:"outline",size:"sm",disabled:t===1,onClick:()=>r(M=>M-1),children:[e.jsx(vC,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs(K,{variant:"outline",size:"sm",disabled:t>=(i.meta.last_page||1),onClick:()=>r(M=>M+1),children:["Next",e.jsx($u,{className:"h-4 w-4 ml-1"})]})]})]})]})}var uD="Checkbox",[tge]=tc(uD),[rge,sge]=tge(uD),RK=A.forwardRef((t,r)=>{const{__scopeCheckbox:s,name:n,checked:a,defaultChecked:o,required:c,disabled:i,value:f="on",onCheckedChange:p,form:g,...y}=t,[b,w]=A.useState(null),T=ls(r,L=>w(L)),N=A.useRef(!1),M=b?g||!!b.closest("form"):!0,[O=!1,C]=Yc({prop:a,defaultProp:o,onChange:p}),D=A.useRef(O);return A.useEffect(()=>{const L=b==null?void 0:b.form;if(L){const F=()=>C(D.current);return L.addEventListener("reset",F),()=>L.removeEventListener("reset",F)}},[b,C]),e.jsxs(rge,{scope:s,state:O,disabled:i,children:[e.jsx(Tr.button,{type:"button",role:"checkbox","aria-checked":gm(O)?"mixed":O,"aria-required":c,"data-state":$K(O),"data-disabled":i?"":void 0,disabled:i,value:f,...y,ref:T,onKeyDown:gr(t.onKeyDown,L=>{L.key==="Enter"&&L.preventDefault()}),onClick:gr(t.onClick,L=>{C(F=>gm(F)?!0:!F),M&&(N.current=L.isPropagationStopped(),N.current||L.stopPropagation())})}),M&&e.jsx(nge,{control:b,bubbles:!N.current,name:n,value:f,checked:O,required:c,disabled:i,form:g,style:{transform:"translateX(-100%)"},defaultChecked:gm(o)?!1:o})]})});RK.displayName=uD;var LK="CheckboxIndicator",FK=A.forwardRef((t,r)=>{const{__scopeCheckbox:s,forceMount:n,...a}=t,o=sge(LK,s);return e.jsx(Yi,{present:n||gm(o.state)||o.state===!0,children:e.jsx(Tr.span,{"data-state":$K(o.state),"data-disabled":o.disabled?"":void 0,...a,ref:r,style:{pointerEvents:"none",...t.style}})})});FK.displayName=LK;var nge=t=>{const{control:r,checked:s,bubbles:n=!0,defaultChecked:a,...o}=t,c=A.useRef(null),i=AC(s),f=PC(r);A.useEffect(()=>{const g=c.current,y=window.HTMLInputElement.prototype,w=Object.getOwnPropertyDescriptor(y,"checked").set;if(i!==s&&w){const T=new Event("click",{bubbles:n});g.indeterminate=gm(s),w.call(g,gm(s)?!1:s),g.dispatchEvent(T)}},[i,s,n]);const p=A.useRef(gm(s)?!1:s);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??p.current,...o,tabIndex:-1,ref:c,style:{...t.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function gm(t){return t==="indeterminate"}function $K(t){return gm(t)?"indeterminate":t?"checked":"unchecked"}var zK=RK,age=FK;const Fd=A.forwardRef(({className:t,...r},s)=>e.jsx(zK,{ref:s,className:dr("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...r,children:e.jsx(age,{className:dr("flex items-center justify-center text-current"),children:e.jsx(Kc,{className:"h-4 w-4"})})}));Fd.displayName=zK.displayName;function ige({open:t,onOpenChange:r,point:s}){var N,M,O,C,D,L;const n=yr(),a=!!s,{register:o,handleSubmit:c,reset:i,setValue:f,watch:p,formState:{errors:g}}=Ya({defaultValues:s?{...s,latitude:(M=(N=s.location)==null?void 0:N.coordinates)==null?void 0:M[1],longitude:(C=(O=s.location)==null?void 0:O.coordinates)==null?void 0:C[0]}:{kind:"source",is_active:!0}}),{data:y}=it({queryKey:["schemes-for-sampling-point"],queryFn:async()=>pe.get("/schemes",{per_page:200})}),b=gt({mutationFn:F=>pe.post("/water-quality/sampling-points",F),onSuccess:()=>{n.invalidateQueries({queryKey:["water-quality-sampling-points"]}),Me.success("Sampling point created successfully"),r(!1),i()},onError:F=>{Me.error(F.message||"Failed to create sampling point")}}),w=gt({mutationFn:F=>pe.patch(`/water-quality/sampling-points/${s.id}`,F),onSuccess:()=>{n.invalidateQueries({queryKey:["water-quality-sampling-points"]}),Me.success("Sampling point updated successfully"),r(!1)},onError:F=>{Me.error(F.message||"Failed to update sampling point")}}),T=F=>{const B={name:F.name,code:F.code,kind:F.kind,scheme_id:F.scheme_id||void 0,latitude:parseFloat(F.latitude),longitude:parseFloat(F.longitude),elevation_m:F.elevation_m?parseFloat(F.elevation_m):void 0,is_active:F.is_active};a?w.mutate(B):b.mutate(B)};return A.useEffect(()=>{var F,B,U,te;i(s?{...s,latitude:(B=(F=s.location)==null?void 0:F.coordinates)==null?void 0:B[1],longitude:(te=(U=s.location)==null?void 0:U.coordinates)==null?void 0:te[0]}:{kind:"source",is_active:!0})},[s,i]),e.jsx(Qt,{open:t,onOpenChange:r,children:e.jsxs(Zt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:a?"Edit Sampling Point":"Create New Sampling Point"}),e.jsx(Es,{children:a?"Update sampling point information":"Add a new sampling point with GPS location"})]}),e.jsxs("form",{onSubmit:c(T),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"name",children:"Point Name *"}),e.jsx(Ie,{id:"name",...o("name",{required:!0}),placeholder:"e.g., Borehole #1"}),g.name&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"code",children:"Code *"}),e.jsx(Ie,{id:"code",...o("code",{required:!0}),placeholder:"e.g., BH-001"}),g.code&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"kind",children:"Point Kind *"}),e.jsxs(Nt,{onValueChange:F=>f("kind",F),defaultValue:(s==null?void 0:s.kind)||"source",children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select kind"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"source",children:"Source"}),e.jsx(ge,{value:"treatment",children:"Treatment"}),e.jsx(ge,{value:"reservoir",children:"Reservoir"}),e.jsx(ge,{value:"distribution",children:"Distribution"}),e.jsx(ge,{value:"kiosk",children:"Kiosk"}),e.jsx(ge,{value:"household",children:"Household"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"scheme_id",children:"Scheme"}),e.jsxs(Nt,{onValueChange:F=>f("scheme_id",F&&F!=="none"?Number(F):void 0),defaultValue:((D=s==null?void 0:s.scheme_id)==null?void 0:D.toString())||"none",children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select scheme"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"none",children:"None"}),(L=y==null?void 0:y.data)==null?void 0:L.map(F=>e.jsx(ge,{value:F.id.toString(),children:F.name},F.id))]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"latitude",children:"Latitude *"}),e.jsx(Ie,{id:"latitude",type:"number",step:"any",...o("latitude",{required:!0}),placeholder:"e.g., -1.2921"}),g.latitude&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"longitude",children:"Longitude *"}),e.jsx(Ie,{id:"longitude",type:"number",step:"any",...o("longitude",{required:!0}),placeholder:"e.g., 36.8219"}),g.longitude&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"elevation_m",children:"Elevation (m)"}),e.jsx(Ie,{id:"elevation_m",type:"number",step:"any",...o("elevation_m"),placeholder:"Optional"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fd,{id:"is_active",checked:p("is_active"),onCheckedChange:F=>f("is_active",F)}),e.jsx(we,{htmlFor:"is_active",className:"cursor-pointer",children:"Active sampling point"})]}),e.jsxs(Ps,{children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:b.isPending||w.isPending,children:b.isPending||w.isPending?"Saving...":a?"Update":"Create"})]})]})]})})}const N$={source:"#3b82f6",treatment:"#8b5cf6",reservoir:"#10b981",distribution:"#eab308",kiosk:"#f97316",household:"#ec4899"};function oge({points:t,onPointSelect:r}){const s=A.useRef(null),n=A.useRef(null),a=A.useRef([]),[o,c]=A.useState(null);A.useEffect(()=>{if(!(!s.current||n.current))return n.current=new $l.Map({container:s.current,style:{version:8,sources:{"osm-tiles":{type:"raster",tiles:["https://tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:"&copy; OpenStreetMap contributors"}},layers:[{id:"osm-tiles",type:"raster",source:"osm-tiles",minzoom:0,maxzoom:19}]},center:[36.8219,-1.2921],zoom:8}),n.current.addControl(new $l.NavigationControl,"top-right"),n.current.addControl(new $l.ScaleControl,"bottom-left"),()=>{var f;a.current.forEach(p=>p.remove()),a.current=[],(f=n.current)==null||f.remove(),n.current=null}},[]),A.useEffect(()=>{if(!n.current||!(t!=null&&t.length))return;a.current.forEach(p=>p.remove()),a.current=[];const f=t.filter(p=>{var g;return(g=p.location)==null?void 0:g.coordinates});if(f.length!==0&&(f.forEach(p=>{var b;if(!((b=p.location)!=null&&b.coordinates))return;const g=document.createElement("div");g.className="sampling-point-marker",g.style.width="28px",g.style.height="28px",g.style.borderRadius="50%",g.style.backgroundColor=N$[p.kind]||"#6b7280",g.style.border=p.is_active?"3px solid white":"3px solid #ef4444",g.style.boxShadow="0 2px 6px rgba(0,0,0,0.3)",g.style.cursor="pointer",g.style.opacity=p.is_active?"1":"0.6";const y=new $l.Marker({element:g}).setLngLat(p.location.coordinates).addTo(n.current);a.current.push(y),g.addEventListener("click",()=>{var w;c(p),r==null||r(p),(w=n.current)==null||w.flyTo({center:p.location.coordinates,zoom:14,duration:1e3})})}),f.length>0)){const p=new $l.LngLatBounds;f.forEach(g=>{var y;(y=g.location)!=null&&y.coordinates&&p.extend(g.location.coordinates)}),n.current.fitBounds(p,{padding:50,maxZoom:14})}},[t,r]);const i=()=>{c(null),r==null||r(null)};return e.jsxs("div",{className:"relative h-96 w-full",children:[e.jsx("div",{className:"absolute top-4 left-4 z-10",children:e.jsx(H,{className:"max-w-xs",children:e.jsxs(X,{className:"p-4",children:[e.jsx("h3",{className:"text-sm font-bold mb-3",children:"Sampling Point Types"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(N$).map(([f,p])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:p,border:"2px solid white"}}),e.jsx("span",{className:"text-xs capitalize",children:f})]},f))}),e.jsxs("div",{className:"mt-3 pt-3 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-400",style:{border:"2px solid white"}}),e.jsx("span",{className:"text-xs",children:"Active"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-400 opacity-60",style:{border:"2px solid #ef4444"}}),e.jsx("span",{className:"text-xs",children:"Inactive"})]})]})]})})}),o&&e.jsx("div",{className:"absolute top-4 right-4 z-10 w-80",children:e.jsx(H,{children:e.jsxs(X,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"space-y-1 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-bold",children:o.name}),e.jsx(Ae,{variant:o.is_active?"default":"destructive",className:"text-xs",children:o.is_active?"Active":"Inactive"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Code: ",o.code]})]}),e.jsx(K,{variant:"ghost",size:"sm",onClick:i,children:e.jsx(Ko,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(Ae,{className:"capitalize",variant:"outline",children:o.kind})}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(fn,{className:"h-4 w-4"}),e.jsxs("span",{children:[o.location.coordinates[1].toFixed(6),", ",o.location.coordinates[0].toFixed(6)]})]}),o.elevation_m&&e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Elevation:"})," ",o.elevation_m,"m"]}),o.scheme&&e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Scheme:"})," ",o.scheme.name]})]})]})})}),e.jsx("div",{ref:s,className:"h-full w-full rounded-lg"})]})}function lge(){var M;const[t,r]=A.useState(1),[s,n]=A.useState(!1),[a,o]=A.useState(!1),[c,i]=A.useState(void 0),f=yr(),{data:p,isLoading:g}=it({queryKey:["water-quality-sampling-points",t],queryFn:async()=>pe.get("/water-quality/sampling-points",{page:t,per_page:20})}),y={source:"bg-blue-100 text-blue-800",treatment:"bg-purple-100 text-purple-800",reservoir:"bg-green-100 text-green-800",distribution:"bg-yellow-100 text-yellow-800",kiosk:"bg-orange-100 text-orange-800",household:"bg-pink-100 text-pink-800"},b=gt({mutationFn:O=>pe.delete(`/water-quality/sampling-points/${O}`),onSuccess:()=>{f.invalidateQueries({queryKey:["water-quality-sampling-points"]}),Me.success("Sampling point deleted successfully")},onError:O=>{Me.error(O.message||"Failed to delete sampling point")}}),w=O=>{i(O),o(!0)},T=O=>{confirm("Are you sure you want to delete this sampling point?")&&b.mutate(O)},N=()=>{i(void 0),o(!0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Sampling Points"}),e.jsx("p",{className:"text-muted-foreground",children:"Geographic locations where water samples are collected"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{variant:"outline",onClick:()=>n(!s),children:[e.jsx(jd,{className:"h-4 w-4 mr-2"}),s?"Hide Map":"Show Map"]}),e.jsxs(K,{onClick:N,children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Add Sampling Point"]})]})]}),e.jsx(ige,{open:a,onOpenChange:o,point:c}),s&&e.jsx(H,{children:e.jsx(X,{className:"p-0",children:e.jsx(oge,{points:(p==null?void 0:p.data)||[],onPointSelect:O=>{O&&console.log("Selected point:",O)}})})}),g?e.jsx("div",{className:"text-center py-12",children:"Loading sampling points..."}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:(M=p==null?void 0:p.data)==null?void 0:M.map(O=>{var C,D,L,F;return e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(he,{className:"text-lg",children:O.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Code: ",O.code]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>w(O),children:e.jsx(gI,{className:"h-4 w-4"})}),e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>T(O.id),children:e.jsx(Ws,{className:"h-4 w-4"})})]})]})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:y[O.kind]||"bg-gray-100 text-gray-800",children:O.kind}),!O.is_active&&e.jsx(Ae,{variant:"destructive",children:"Inactive"})]}),O.location&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(fn,{className:"h-4 w-4"}),e.jsxs("span",{children:[(D=(C=O.location.coordinates)==null?void 0:C[1])==null?void 0:D.toFixed(4),", ",(F=(L=O.location.coordinates)==null?void 0:L[0])==null?void 0:F.toFixed(4)]})]}),O.elevation_m&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Elevation: ",O.elevation_m,"m"]}),O.scheme&&e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Scheme:"})," ",O.scheme.name]})]})]},O.id)})}),(p==null?void 0:p.meta)&&e.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",p.meta.from," to ",p.meta.to," of ",p.meta.total," sampling points"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{variant:"outline",size:"sm",disabled:t===1,onClick:()=>r(O=>O-1),children:"Previous"}),e.jsx(K,{variant:"outline",size:"sm",disabled:t>=p.meta.last_page,onClick:()=>r(O=>O+1),children:"Next"})]})]})]})}function cge({open:t,onOpenChange:r,plan:s}){const n=yr(),a=!!s,{register:o,handleSubmit:c,reset:i,setValue:f,watch:p,formState:{errors:g}}=Ya({defaultValues:s||{frequency:"monthly",is_active:!1}}),y=gt({mutationFn:T=>pe.post("/water-quality/plans",T),onSuccess:()=>{n.invalidateQueries({queryKey:["water-quality-plans"]}),Me.success("Sampling plan created successfully"),r(!1),i()},onError:T=>{Me.error(T.message||"Failed to create plan")}}),b=gt({mutationFn:T=>pe.patch(`/water-quality/plans/${s.id}`,T),onSuccess:()=>{n.invalidateQueries({queryKey:["water-quality-plans"]}),Me.success("Sampling plan updated successfully"),r(!1)},onError:T=>{Me.error(T.message||"Failed to update plan")}}),w=T=>{const N={...T,end_date:T.end_date||void 0};a?b.mutate(N):y.mutate(N)};return A.useEffect(()=>{var T,N;i(s?{...s,start_date:(T=s.start_date)==null?void 0:T.split("T")[0],end_date:(N=s.end_date)==null?void 0:N.split("T")[0]}:{frequency:"monthly",is_active:!1})},[s,i]),e.jsx(Qt,{open:t,onOpenChange:r,children:e.jsxs(Zt,{className:"max-w-lg",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:a?"Edit Plan":"Create New Plan"}),e.jsx(Es,{children:a?"Update sampling plan details":"Create a new water quality sampling plan"})]}),e.jsxs("form",{onSubmit:c(w),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"name",children:"Plan Name *"}),e.jsx(Ie,{id:"name",...o("name",{required:!0}),placeholder:"e.g., Q1 2024 Monitoring"}),g.name&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"frequency",children:"Sampling Frequency *"}),e.jsxs(Nt,{onValueChange:T=>f("frequency",T),defaultValue:(s==null?void 0:s.frequency)||"monthly",children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select frequency"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"daily",children:"Daily"}),e.jsx(ge,{value:"weekly",children:"Weekly"}),e.jsx(ge,{value:"monthly",children:"Monthly"}),e.jsx(ge,{value:"quarterly",children:"Quarterly"}),e.jsx(ge,{value:"annual",children:"Annual"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"start_date",children:"Start Date *"}),e.jsx(Ie,{id:"start_date",type:"date",...o("start_date",{required:!0})}),g.start_date&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"end_date",children:"End Date"}),e.jsx(Ie,{id:"end_date",type:"date",...o("end_date")})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fd,{id:"is_active",checked:p("is_active"),onCheckedChange:T=>f("is_active",T)}),e.jsx(we,{htmlFor:"is_active",className:"cursor-pointer",children:"Activate plan immediately"})]}),e.jsxs(Ps,{children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:y.isPending||b.isPending,children:y.isPending||b.isPending?"Saving...":a?"Update":"Create"})]})]})]})})}function dge(){var T;const[t,r]=A.useState(1),[s,n]=A.useState(!1),[a,o]=A.useState(void 0),c=yr(),{data:i,isLoading:f}=it({queryKey:["water-quality-plans",t],queryFn:async()=>pe.get("/water-quality/plans",{page:t,per_page:20})}),p=gt({mutationFn:N=>pe.post(`/water-quality/plans/${N}/activate`,{}),onSuccess:()=>{c.invalidateQueries({queryKey:["water-quality-plans"]}),Me.success("Plan activated successfully")},onError:N=>{Me.error(N.message||"Failed to activate plan")}}),g=gt({mutationFn:N=>pe.post(`/water-quality/plans/${N}/generate-samples`,{}),onSuccess:N=>{c.invalidateQueries({queryKey:["water-quality-samples"]}),Me.success(`Generated ${N.generated||0} samples successfully`)},onError:N=>{Me.error(N.message||"Failed to generate samples")}}),y=N=>{p.mutate(N)},b=N=>{g.mutate(N)},w=()=>{o(void 0),n(!0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Sampling Plans"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage quarterly and annual water quality monitoring plans"})]}),e.jsxs(K,{onClick:w,children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Create Plan"]})]}),e.jsx(cge,{open:s,onOpenChange:n,plan:a}),f?e.jsx("div",{className:"text-center py-12",children:"Loading plans..."}):e.jsx("div",{className:"grid gap-4",children:(T=i==null?void 0:i.data)==null?void 0:T.map(N=>e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(wn,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(he,{className:"text-xl",children:N.name})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ae,{variant:N.is_active?"default":"secondary",children:N.is_active?"Active":"Inactive"}),e.jsx(Ae,{variant:"outline",children:N.frequency||"quarterly"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[!N.is_active&&e.jsxs(K,{size:"sm",variant:"default",onClick:()=>y(N.id),disabled:p.isPending,children:[e.jsx(n9,{className:"h-4 w-4 mr-1"}),"Activate"]}),e.jsx(K,{size:"sm",variant:"outline",onClick:()=>b(N.id),disabled:g.isPending,children:"Generate Samples"})]})]})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Start Date:"}),e.jsx("p",{className:"font-medium",children:N.start_date?Ur(new Date(N.start_date),"PP"):"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"End Date:"}),e.jsx("p",{className:"font-medium",children:N.end_date?Ur(new Date(N.end_date),"PP"):"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Rules:"}),e.jsxs("p",{className:"font-medium",children:[N.rules_count||0," defined"]})]})]}),N.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:N.description})]})]},N.id))}),(i==null?void 0:i.meta)&&e.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",i.meta.from," to ",i.meta.to," of ",i.meta.total," plans"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{variant:"outline",size:"sm",disabled:t===1,onClick:()=>r(N=>N-1),children:"Previous"}),e.jsx(K,{variant:"outline",size:"sm",disabled:t>=i.meta.last_page,onClick:()=>r(N=>N+1),children:"Next"})]})]})]})}function uge({open:t,onOpenChange:r,sample:s}){const n=yr(),{register:a,handleSubmit:o,reset:c,formState:{errors:i}}=Ya(),f=gt({mutationFn:g=>pe.post(`/water-quality/samples/${s.id}/collect`,g),onSuccess:()=>{n.invalidateQueries({queryKey:["water-quality-samples"]}),Me.success("Sample collected successfully"),r(!1),c()},onError:g=>{Me.error(g.message||"Failed to collect sample")}}),p=g=>{f.mutate({...g,field_temp:g.field_temp?parseFloat(g.field_temp):void 0,field_ph:g.field_ph?parseFloat(g.field_ph):void 0,field_chlorine:g.field_chlorine?parseFloat(g.field_chlorine):void 0})};return e.jsx(Qt,{open:t,onOpenChange:r,children:e.jsxs(Zt,{className:"max-w-lg",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Collect Sample"}),e.jsxs(Es,{children:["Record field collection details for ",s==null?void 0:s.barcode]})]}),e.jsxs("form",{onSubmit:o(p),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"collected_by",children:"Collected By *"}),e.jsx(Ie,{id:"collected_by",...a("collected_by",{required:!0}),placeholder:"Field officer name"}),i.collected_by&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"field_temp",children:"Temp (C)"}),e.jsx(Ie,{id:"field_temp",type:"number",step:"0.1",...a("field_temp"),placeholder:"Optional"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"field_ph",children:"pH"}),e.jsx(Ie,{id:"field_ph",type:"number",step:"0.1",...a("field_ph"),placeholder:"Optional"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"field_chlorine",children:"Cl (mg/L)"}),e.jsx(Ie,{id:"field_chlorine",type:"number",step:"0.01",...a("field_chlorine"),placeholder:"Optional"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"field_notes",children:"Field Notes"}),e.jsx(ws,{id:"field_notes",...a("field_notes"),placeholder:"Any observations during collection...",rows:3})]}),e.jsxs(Ps,{children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:f.isPending,children:f.isPending?"Collecting...":"Collect Sample"})]})]})]})})}function hge({open:t,onOpenChange:r,sample:s}){const n=yr(),{register:a,handleSubmit:o,reset:c,formState:{errors:i}}=Ya(),f=gt({mutationFn:g=>pe.post(`/water-quality/samples/${s.id}/receive-lab`,g),onSuccess:()=>{n.invalidateQueries({queryKey:["water-quality-samples"]}),Me.success("Sample received in lab successfully"),r(!1),c()},onError:g=>{Me.error(g.message||"Failed to receive sample")}}),p=g=>{f.mutate(g)};return e.jsx(Qt,{open:t,onOpenChange:r,children:e.jsxs(Zt,{className:"max-w-lg",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Receive Sample in Lab"}),e.jsxs(Es,{children:["Record lab receipt details for ",s==null?void 0:s.barcode]})]}),e.jsxs("form",{onSubmit:o(p),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"received_by",children:"Received By *"}),e.jsx(Ie,{id:"received_by",...a("received_by",{required:!0}),placeholder:"Lab technician name"}),i.received_by&&e.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"container_condition",children:"Container Condition"}),e.jsx(Ie,{id:"container_condition",...a("container_condition"),placeholder:"e.g., Good, Intact, No leaks"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"preservation_check",children:"Preservation Check"}),e.jsx(Ie,{id:"preservation_check",...a("preservation_check"),placeholder:"e.g., Properly preserved, Ice pack present"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"lab_notes",children:"Lab Notes"}),e.jsx(ws,{id:"lab_notes",...a("lab_notes"),placeholder:"Any observations upon receipt...",rows:3})]}),e.jsxs(Ps,{children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:f.isPending,children:f.isPending?"Receiving...":"Receive Sample"})]})]})]})})}function mge(){var T;const[t,r]=A.useState(1),[s,n]=A.useState(""),[a,o]=A.useState(!1),[c,i]=A.useState(!1),[f,p]=A.useState(null),{data:g,isLoading:y}=it({queryKey:["water-quality-samples",t],queryFn:async()=>pe.get("/water-quality/samples",{page:t,per_page:20})}),b={scheduled:"bg-gray-100 text-gray-800",collected:"bg-blue-100 text-blue-800",received_lab:"bg-purple-100 text-purple-800",in_analysis:"bg-yellow-100 text-yellow-800",reported:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"},w=N=>{p(N),i(!0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Samples"}),e.jsx("p",{className:"text-muted-foreground",children:"Track water samples from field collection to lab reporting"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Create Sample"]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-lg",children:"Search by Barcode"})}),e.jsx(X,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ie,{placeholder:"Enter barcode (e.g., WQ20240101-ABC123)",value:s,onChange:N=>n(N.target.value)}),e.jsxs(K,{children:[e.jsx(nn,{className:"h-4 w-4 mr-2"}),"Search"]})]})})]}),y?e.jsx("div",{className:"text-center py-12",children:"Loading samples..."}):e.jsx("div",{className:"grid gap-4",children:(T=g==null?void 0:g.data)==null?void 0:T.map(N=>{var M,O;return e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fl,{className:"h-5 w-5 text-blue-500"}),e.jsx(he,{className:"text-lg",children:((M=N.sampling_point)==null?void 0:M.name)||"Unknown Point"})]}),e.jsx("p",{className:"text-sm text-muted-foreground font-mono",children:N.barcode})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(Ae,{className:b[N.custody_state]||"bg-gray-100",children:((O=N.custody_state)==null?void 0:O.replace("_"," "))||"scheduled"}),N.custody_state==="collected"&&e.jsxs(K,{size:"sm",variant:"outline",onClick:()=>w(N),children:[e.jsx(l9,{className:"h-4 w-4 mr-1"}),"Receive in Lab"]})]})]})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Scheduled:"}),e.jsx("p",{className:"font-medium",children:N.scheduled_at?Ur(new Date(N.scheduled_at),"PP"):"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Collected:"}),e.jsx("p",{className:"font-medium",children:N.collected_at?Ur(new Date(N.collected_at),"PP"):"Pending"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Parameters:"}),e.jsxs("p",{className:"font-medium",children:[N.parameters_count||0," tests"]})]})]}),N.collected_by&&e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Collected by:"})," ",N.collected_by]}),N.custody_chain&&N.custody_chain.length>0&&e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"text-muted-foreground mb-1",children:"Custody Chain:"}),e.jsxs("div",{className:"bg-muted p-2 rounded text-xs font-mono",children:[N.custody_chain.length," transfer(s) recorded"]})]})]})]},N.id)})}),(g==null?void 0:g.meta)&&e.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",g.meta.from," to ",g.meta.to," of ",g.meta.total," samples"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{variant:"outline",size:"sm",disabled:t===1,onClick:()=>r(N=>N-1),children:"Previous"}),e.jsx(K,{variant:"outline",size:"sm",disabled:t>=g.meta.last_page,onClick:()=>r(N=>N+1),children:"Next"})]})]}),f&&e.jsxs(e.Fragment,{children:[e.jsx(uge,{open:a,onOpenChange:o,sample:f}),e.jsx(hge,{open:c,onOpenChange:i,sample:f})]})]})}function fge({open:t,onOpenChange:r}){const s=yr(),n=A.useRef(null),[a,o]=A.useState(null),[c,i]=A.useState(null),f=gt({mutationFn:async b=>{const w=new FormData;w.append("file",b);const N=await fetch("/api/v1/water-quality/results/import-csv",{method:"POST",body:w,credentials:"include"});if(!N.ok){const M=await N.json().catch(()=>({message:"Import failed"}));throw new Error(M.message||"Import failed")}return N.json()},onSuccess:b=>{s.invalidateQueries({queryKey:["water-quality-results"]}),i(b),Me.success(`Successfully imported ${b.imported||0} results`)},onError:b=>{var w,T;Me.error(b.message||"Failed to import CSV file"),i({errors:((T=(w=b.response)==null?void 0:w.data)==null?void 0:T.errors)||["Import failed"]})}}),p=b=>{var T;const w=(T=b.target.files)==null?void 0:T[0];if(w){if(w.type!=="text/csv"&&!w.name.endsWith(".csv")){Me.error("Please select a CSV file");return}if(w.size>5*1024*1024){Me.error("File size must be less than 5MB");return}o(w),i(null)}},g=()=>{if(!a){Me.error("Please select a file first");return}f.mutate(a)},y=()=>{o(null),i(null),n.current&&(n.current.value=""),r(!1)};return e.jsx(Qt,{open:t,onOpenChange:y,children:e.jsxs(Zt,{className:"max-w-lg",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Import Lab Results from CSV"}),e.jsx(Es,{children:"Upload a CSV file containing lab test results. File must include columns: sample_barcode, parameter_code, value, uncertainty, method, analyst, analyzed_at"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"csv-file",children:"CSV File"}),e.jsx(Ie,{ref:n,id:"csv-file",type:"file",accept:".csv",onChange:p}),a&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mt-2",children:[e.jsx(bs,{className:"h-4 w-4"}),e.jsxs("span",{children:[a.name," (",(a.size/1024).toFixed(1)," KB)"]})]})]}),c&&e.jsx(zn,{variant:c.errors?"destructive":"default",children:c.errors?e.jsxs(e.Fragment,{children:[e.jsx(Nn,{className:"h-4 w-4"}),e.jsxs(An,{children:[e.jsx("p",{className:"font-semibold mb-2",children:"Import Errors:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[c.errors.slice(0,5).map((b,w)=>e.jsx("li",{className:"text-sm",children:b},w)),c.errors.length>5&&e.jsxs("li",{className:"text-sm",children:["... and ",c.errors.length-5," more"]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ns,{className:"h-4 w-4"}),e.jsxs(An,{children:[e.jsx("p",{className:"font-semibold",children:"Import Successful!"}),e.jsxs("p",{className:"text-sm mt-1",children:["Imported ",c.imported||0," results.",c.skipped>0&&` Skipped ${c.skipped} duplicates.`]})]})]})}),e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"CSV Format Example:"}),e.jsx("pre",{className:"text-xs font-mono overflow-x-auto",children:`sample_barcode,parameter_code,value,uncertainty,method,analyst,analyzed_at
WQ20240101-ABC123,PH,7.2,0.1,SM 4500-H,John Doe,2024-01-15
WQ20240101-ABC123,TURB,1.5,0.2,SM 2130-B,Jane Smith,2024-01-15`})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{type:"button",variant:"outline",onClick:y,children:c?"Close":"Cancel"}),!c&&e.jsx(K,{onClick:g,disabled:!a||f.isPending,children:f.isPending?e.jsx(e.Fragment,{children:"Importing..."}):e.jsxs(e.Fragment,{children:[e.jsx(Bo,{className:"h-4 w-4 mr-2"}),"Import CSV"]})})]})]})})}function pge(){var i;const[t,r]=A.useState(1),[s,n]=A.useState(!1),{data:a,isLoading:o}=it({queryKey:["water-quality-results",t],queryFn:async()=>pe.get("/water-quality/results",{page:t,per_page:20})}),c={below_lod:"bg-gray-100 text-gray-800",exceeds_who_limit:"bg-orange-100 text-orange-800",exceeds_wasreb_limit:"bg-red-100 text-red-800",exceeds_local_limit:"bg-red-100 text-red-800",high_uncertainty:"bg-yellow-100 text-yellow-800"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Lab Results"}),e.jsx("p",{className:"text-muted-foreground",children:"Enter and review lab analysis results with automatic QC flagging"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{variant:"outline",onClick:()=>n(!0),children:[e.jsx(Bo,{className:"h-4 w-4 mr-2"}),"Import CSV"]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Add Result"]})]})]}),e.jsx(fge,{open:s,onOpenChange:n}),o?e.jsx("div",{className:"text-center py-12",children:"Loading results..."}):e.jsx("div",{className:"grid gap-4",children:(i=a==null?void 0:a.data)==null?void 0:i.map(f=>{var y,b,w,T,N,M,O,C,D,L,F,B;const p=f.qc_flags&&f.qc_flags.length>0,g=(y=f.qc_flags)==null?void 0:y.some(U=>U.includes("exceeds_wasreb")||U.includes("exceeds_local"));return e.jsxs(H,{className:g?"border-red-200":"",children:[e.jsx(ue,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"text-lg",children:((w=(b=f.sample_param)==null?void 0:b.parameter)==null?void 0:w.name)||"Unknown Parameter"}),p&&e.jsx(Fr,{className:`h-5 w-5 ${g?"text-red-500":"text-yellow-500"}`})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Sample: ",(N=(T=f.sample_param)==null?void 0:T.sample)==null?void 0:N.barcode]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl font-bold",children:[f.value_qualifier&&e.jsx("span",{className:"text-muted-foreground",children:f.value_qualifier}),(M=f.value)==null?void 0:M.toFixed(2)," ",(C=(O=f.sample_param)==null?void 0:O.parameter)==null?void 0:C.unit]}),f.uncertainty&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:[" ",f.uncertainty," ",(L=(D=f.sample_param)==null?void 0:D.parameter)==null?void 0:L.unit]})]})]})}),e.jsxs(X,{className:"space-y-3",children:[p&&e.jsx("div",{className:"flex flex-wrap gap-2",children:f.qc_flags.map(U=>e.jsx(Ae,{className:c[U]||"bg-gray-100",children:U.replace(/_/g," ")},U))}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Analyzed:"}),e.jsx("p",{className:"font-medium",children:f.analyzed_at?Ur(new Date(f.analyzed_at),"PP"):"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Method:"}),e.jsx("p",{className:"font-medium",children:f.method||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"LOD:"}),e.jsx("p",{className:"font-medium",children:f.lod?`${f.lod} ${(B=(F=f.sample_param)==null?void 0:F.parameter)==null?void 0:B.unit}`:"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Analyst:"}),e.jsx("p",{className:"font-medium",children:f.analyst||"N/A"})]})]}),f.remarks&&e.jsx("p",{className:"text-sm text-muted-foreground italic",children:f.remarks})]})]},f.id)})}),(a==null?void 0:a.meta)&&e.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",a.meta.from," to ",a.meta.to," of ",a.meta.total," results"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{variant:"outline",size:"sm",disabled:t===1,onClick:()=>r(f=>f-1),children:"Previous"}),e.jsx(K,{variant:"outline",size:"sm",disabled:t>=a.meta.last_page,onClick:()=>r(f=>f+1),children:"Next"})]})]})]})}function xge(){var a,o;const{data:t,isLoading:r}=it({queryKey:["water-quality-compliance-summary"],queryFn:async()=>pe.get("/water-quality/compliance/summary")}),{data:s,isLoading:n}=it({queryKey:["water-quality-compliance"],queryFn:async()=>pe.get("/water-quality/compliance",{per_page:50})});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Compliance Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor regulatory compliance with WHO and WASREB water quality standards"})]}),e.jsxs(K,{children:[e.jsx(zs,{className:"h-4 w-4 mr-2"}),"Generate Report"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Overall Compliance"}),e.jsx(Wl,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r?"...":`${((a=t==null?void 0:t.overall_compliance_rate)==null?void 0:a.toFixed(1))||0}%`}),e.jsx(Wi,{value:(t==null?void 0:t.overall_compliance_rate)||0,className:"mt-2"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Compliant Points"}),e.jsx(Ns,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r?"...":(t==null?void 0:t.compliant_points)||0}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["of ",(t==null?void 0:t.total_points)||0," sampling points"]})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Non-Compliant"}),e.jsx(Nn,{className:"h-4 w-4 text-red-500"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:r?"...":(t==null?void 0:t.non_compliant_points)||0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"require immediate action"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Tests This Period"}),e.jsx(Wl,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r?"...":(t==null?void 0:t.total_tests)||0}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[(t==null?void 0:t.failed_tests)||0," failed tests"]})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Compliance by Parameter & Location"})}),e.jsx(X,{children:n?e.jsx("div",{className:"text-center py-8",children:"Loading compliance data..."}):e.jsx("div",{className:"space-y-4",children:(o=s==null?void 0:s.data)==null?void 0:o.map(c=>{var p,g,y;const i=c.compliant_samples/c.total_samples*100,f=i>=95;return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:((p=c.parameter)==null?void 0:p.name)||"Unknown"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[((g=c.sampling_point)==null?void 0:g.name)||"All Points","  ",c.period||"Current Period"]})]}),e.jsxs(Ae,{variant:f?"default":"destructive",children:[i.toFixed(1),"% Compliant"]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Samples:"}),e.jsx("p",{className:"font-medium",children:c.total_samples})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Compliant:"}),e.jsx("p",{className:"font-medium text-green-600",children:c.compliant_samples})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Non-Compliant:"}),e.jsx("p",{className:"font-medium text-red-600",children:c.non_compliant_samples})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Limit Applied:"}),e.jsx("p",{className:"font-medium",children:((y=c.limit_type)==null?void 0:y.toUpperCase())||"N/A"})]})]}),e.jsx(Wi,{value:i,className:"h-2"})]},c.id)})})})]})]})}function gge(){return e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx(Ti,{}),e.jsx("main",{className:"flex-1 p-8 overflow-auto",children:e.jsx(Ai,{})})]})}const Rs="/crm",jn={getCustomers:t=>{const r={};return t!=null&&t.search&&(r.search=t.search),t!=null&&t.per_page&&(r.per_page=t.per_page.toString()),pe.get(`${Rs}/customers`,r)},getCustomer:t=>pe.get(`${Rs}/customers/${t}`),createCustomer:t=>pe.post(`${Rs}/customers`,t),updateCustomer:(t,r)=>pe.put(`${Rs}/customers/${t}`,r),getPremises:t=>{const r={};return t!=null&&t.search&&(r.search=t.search),t!=null&&t.scheme_id&&(r.scheme_id=t.scheme_id.toString()),t!=null&&t.category&&(r.category=t.category),pe.get(`${Rs}/premises`,r)},getPremise:t=>pe.get(`${Rs}/premises/${t}`),getAccountOverview:t=>pe.get(`${Rs}/accounts/${t}/overview`),getBillingHistory:(t,r)=>{const s={};return r&&(s.months=r.toString()),pe.get(`${Rs}/accounts/${t}/billing`,s)},getConsumptionAnalytics:(t,r)=>{const s={};return r&&(s.months=r.toString()),pe.get(`${Rs}/accounts/${t}/analytics`,s)},getRaCases:t=>{const r={};return t&&(r.status=t),pe.get(`${Rs}/ra/cases`,r)},getHighPriorityCases:(t=20)=>{const r={limit:t.toString()};return pe.get(`${Rs}/ra/cases/high-priority`,r)},triageCase:(t,r)=>pe.post(`${Rs}/ra/cases/${t}/triage`,r),getAgingReport:()=>pe.get(`${Rs}/dunning/aging`),getDisconnectionList:()=>pe.get(`${Rs}/dunning/disconnection-list`),generateDunningNotices:t=>pe.post(`${Rs}/dunning/notices`,{aging_bucket:t}),importBilling:t=>{const r=new FormData;return r.append("file",t),pe.post(`${Rs}/import/billing`,r)},importMpesa:t=>{const r=new FormData;return r.append("file",t),pe.post(`${Rs}/import/mpesa`,r)},getComplaints:t=>{const r={};return t!=null&&t.status&&(r.status=t.status),t!=null&&t.category&&(r.category=t.category),t!=null&&t.priority&&(r.priority=t.priority),t!=null&&t.account_no&&(r.account_no=t.account_no),pe.get(`${Rs}/complaints`,r)},getComplaint:t=>pe.get(`${Rs}/complaints/${t}`),createComplaint:t=>pe.post(`${Rs}/complaints`,t),updateComplaint:(t,r)=>pe.patch(`${Rs}/complaints/${t}`,r),getInteractions:t=>{const r={};return t!=null&&t.channel&&(r.channel=t.channel),t!=null&&t.account_no&&(r.account_no=t.account_no),pe.get(`${Rs}/interactions`,r)},getInteraction:t=>pe.get(`${Rs}/interactions/${t}`),createInteraction:t=>pe.post(`${Rs}/interactions`,t),getNotes:t=>{const r={};return t!=null&&t.account_no&&(r.account_no=t.account_no),t!=null&&t.customer_id&&(r.customer_id=t.customer_id.toString()),pe.get(`${Rs}/notes`,r)},getNote:t=>pe.get(`${Rs}/notes/${t}`),createNote:t=>pe.post(`${Rs}/notes`,t),updateNote:(t,r)=>pe.patch(`${Rs}/notes/${t}`,r),deleteNote:t=>pe.delete(`${Rs}/notes/${t}`),getTickets:t=>{const r={};return t!=null&&t.status&&(r.status=t.status),t!=null&&t.priority&&(r.priority=t.priority),t!=null&&t.assigned_to&&(r.assigned_to=t.assigned_to),t!=null&&t.per_page&&(r.per_page=t.per_page.toString()),pe.get(`${Rs}/tickets`,r)},getTicket:t=>pe.get(`${Rs}/tickets/${t}`),createTicket:t=>pe.post(`${Rs}/tickets`,t),updateTicket:(t,r)=>pe.patch(`${Rs}/tickets/${t}`,r),deleteTicket:t=>pe.delete(`${Rs}/tickets/${t}`),getTicketCategories:()=>pe.get(`${Rs}/tickets/categories`)},yge={residential:"bg-blue-100 text-blue-800",commercial:"bg-purple-100 text-purple-800",industrial:"bg-orange-100 text-orange-800",public:"bg-green-100 text-green-800"};function vge(){const[t,r]=A.useState(""),{data:s,isLoading:n,error:a}=it({queryKey:["customers",t],queryFn:()=>jn.getCustomers({search:t,per_page:50})}),o=(s==null?void 0:s.data)||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Customers"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage customer accounts and information"})]}),e.jsxs(K,{children:[e.jsx(m9,{className:"mr-2 h-4 w-4"}),"Add Customer"]})]}),n&&!s?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading customers..."})}):a?e.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:e.jsxs("p",{className:"text-lg text-destructive",children:["Error loading customers: ",a.message]})}):e.jsx(e.Fragment,{children:e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("div",{className:"flex gap-4 mb-6",children:e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(nn,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search by name, ID, phone, or email...",className:"pl-9",value:t,onChange:c=>r(c.target.value)})]})})}),e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Name"}),e.jsx(se,{children:"ID Number"}),e.jsx(se,{children:"Phone"}),e.jsx(se,{children:"Email"}),e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:o.length===0?e.jsx(Qe,{children:e.jsx(J,{colSpan:6,className:"text-center text-muted-foreground",children:"No customers found"})}):o.map(c=>e.jsxs(Qe,{children:[e.jsxs(J,{className:"font-medium",children:[c.first_name," ",c.last_name]}),e.jsx(J,{children:c.id_number}),e.jsx(J,{children:c.phone}),e.jsx(J,{children:c.email||"-"}),e.jsx(J,{children:e.jsx(Ae,{className:yge[c.customer_type],children:c.customer_type})}),e.jsx(J,{children:c.service_connections&&c.service_connections.length>0?e.jsx(K,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx(Pn,{to:`/crm/accounts/${c.service_connections[0].account_no}`,children:e.jsx(mo,{className:"h-4 w-4"})})}):e.jsx(K,{variant:"ghost",size:"sm",disabled:!0,children:e.jsx(mo,{className:"h-4 w-4"})})})]},c.id))})]}),e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:["Showing ",o.length," customer(s)"]})]})})})]})}var jge=Array.isArray,Zo=jge,bge=typeof N0=="object"&&N0&&N0.Object===Object&&N0,BK=bge,_ge=BK,wge=typeof self=="object"&&self&&self.Object===Object&&self,Nge=_ge||wge||Function("return this")(),$d=Nge,Sge=$d,Cge=Sge.Symbol,H_=Cge,S$=H_,qK=Object.prototype,Pge=qK.hasOwnProperty,kge=qK.toString,m0=S$?S$.toStringTag:void 0;function Age(t){var r=Pge.call(t,m0),s=t[m0];try{t[m0]=void 0;var n=!0}catch{}var a=kge.call(t);return n&&(r?t[m0]=s:delete t[m0]),a}var Tge=Age,Ege=Object.prototype,Mge=Ege.toString;function Oge(t){return Mge.call(t)}var Ige=Oge,C$=H_,Dge=Tge,Rge=Ige,Lge="[object Null]",Fge="[object Undefined]",P$=C$?C$.toStringTag:void 0;function $ge(t){return t==null?t===void 0?Fge:Lge:P$&&P$ in Object(t)?Dge(t):Rge(t)}var Xu=$ge;function zge(t){return t!=null&&typeof t=="object"}var Qu=zge,Bge=Xu,qge=Qu,Vge="[object Symbol]";function Uge(t){return typeof t=="symbol"||qge(t)&&Bge(t)==Vge}var bv=Uge,Wge=Zo,Gge=bv,Kge=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Hge=/^\w*$/;function Zge(t,r){if(Wge(t))return!1;var s=typeof t;return s=="number"||s=="symbol"||s=="boolean"||t==null||Gge(t)?!0:Hge.test(t)||!Kge.test(t)||r!=null&&t in Object(r)}var hD=Zge;function Yge(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}var Vm=Yge;const _v=tn(Vm);var Xge=Xu,Qge=Vm,Jge="[object AsyncFunction]",eye="[object Function]",tye="[object GeneratorFunction]",rye="[object Proxy]";function sye(t){if(!Qge(t))return!1;var r=Xge(t);return r==eye||r==tye||r==Jge||r==rye}var mD=sye;const Wr=tn(mD);var nye=$d,aye=nye["__core-js_shared__"],iye=aye,sT=iye,k$=function(){var t=/[^.]+$/.exec(sT&&sT.keys&&sT.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function oye(t){return!!k$&&k$ in t}var lye=oye,cye=Function.prototype,dye=cye.toString;function uye(t){if(t!=null){try{return dye.call(t)}catch{}try{return t+""}catch{}}return""}var VK=uye,hye=mD,mye=lye,fye=Vm,pye=VK,xye=/[\\^$.*+?()[\]{}|]/g,gye=/^\[object .+?Constructor\]$/,yye=Function.prototype,vye=Object.prototype,jye=yye.toString,bye=vye.hasOwnProperty,_ye=RegExp("^"+jye.call(bye).replace(xye,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function wye(t){if(!fye(t)||mye(t))return!1;var r=hye(t)?_ye:gye;return r.test(pye(t))}var Nye=wye;function Sye(t,r){return t==null?void 0:t[r]}var Cye=Sye,Pye=Nye,kye=Cye;function Aye(t,r){var s=kye(t,r);return Pye(s)?s:void 0}var Bp=Aye,Tye=Bp,Eye=Tye(Object,"create"),YC=Eye,A$=YC;function Mye(){this.__data__=A$?A$(null):{},this.size=0}var Oye=Mye;function Iye(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}var Dye=Iye,Rye=YC,Lye="__lodash_hash_undefined__",Fye=Object.prototype,$ye=Fye.hasOwnProperty;function zye(t){var r=this.__data__;if(Rye){var s=r[t];return s===Lye?void 0:s}return $ye.call(r,t)?r[t]:void 0}var Bye=zye,qye=YC,Vye=Object.prototype,Uye=Vye.hasOwnProperty;function Wye(t){var r=this.__data__;return qye?r[t]!==void 0:Uye.call(r,t)}var Gye=Wye,Kye=YC,Hye="__lodash_hash_undefined__";function Zye(t,r){var s=this.__data__;return this.size+=this.has(t)?0:1,s[t]=Kye&&r===void 0?Hye:r,this}var Yye=Zye,Xye=Oye,Qye=Dye,Jye=Bye,eve=Gye,tve=Yye;function wv(t){var r=-1,s=t==null?0:t.length;for(this.clear();++r<s;){var n=t[r];this.set(n[0],n[1])}}wv.prototype.clear=Xye;wv.prototype.delete=Qye;wv.prototype.get=Jye;wv.prototype.has=eve;wv.prototype.set=tve;var rve=wv;function sve(){this.__data__=[],this.size=0}var nve=sve;function ave(t,r){return t===r||t!==t&&r!==r}var fD=ave,ive=fD;function ove(t,r){for(var s=t.length;s--;)if(ive(t[s][0],r))return s;return-1}var XC=ove,lve=XC,cve=Array.prototype,dve=cve.splice;function uve(t){var r=this.__data__,s=lve(r,t);if(s<0)return!1;var n=r.length-1;return s==n?r.pop():dve.call(r,s,1),--this.size,!0}var hve=uve,mve=XC;function fve(t){var r=this.__data__,s=mve(r,t);return s<0?void 0:r[s][1]}var pve=fve,xve=XC;function gve(t){return xve(this.__data__,t)>-1}var yve=gve,vve=XC;function jve(t,r){var s=this.__data__,n=vve(s,t);return n<0?(++this.size,s.push([t,r])):s[n][1]=r,this}var bve=jve,_ve=nve,wve=hve,Nve=pve,Sve=yve,Cve=bve;function Nv(t){var r=-1,s=t==null?0:t.length;for(this.clear();++r<s;){var n=t[r];this.set(n[0],n[1])}}Nv.prototype.clear=_ve;Nv.prototype.delete=wve;Nv.prototype.get=Nve;Nv.prototype.has=Sve;Nv.prototype.set=Cve;var QC=Nv,Pve=Bp,kve=$d,Ave=Pve(kve,"Map"),pD=Ave,T$=rve,Tve=QC,Eve=pD;function Mve(){this.size=0,this.__data__={hash:new T$,map:new(Eve||Tve),string:new T$}}var Ove=Mve;function Ive(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}var Dve=Ive,Rve=Dve;function Lve(t,r){var s=t.__data__;return Rve(r)?s[typeof r=="string"?"string":"hash"]:s.map}var JC=Lve,Fve=JC;function $ve(t){var r=Fve(this,t).delete(t);return this.size-=r?1:0,r}var zve=$ve,Bve=JC;function qve(t){return Bve(this,t).get(t)}var Vve=qve,Uve=JC;function Wve(t){return Uve(this,t).has(t)}var Gve=Wve,Kve=JC;function Hve(t,r){var s=Kve(this,t),n=s.size;return s.set(t,r),this.size+=s.size==n?0:1,this}var Zve=Hve,Yve=Ove,Xve=zve,Qve=Vve,Jve=Gve,eje=Zve;function Sv(t){var r=-1,s=t==null?0:t.length;for(this.clear();++r<s;){var n=t[r];this.set(n[0],n[1])}}Sv.prototype.clear=Yve;Sv.prototype.delete=Xve;Sv.prototype.get=Qve;Sv.prototype.has=Jve;Sv.prototype.set=eje;var xD=Sv,UK=xD,tje="Expected a function";function gD(t,r){if(typeof t!="function"||r!=null&&typeof r!="function")throw new TypeError(tje);var s=function(){var n=arguments,a=r?r.apply(this,n):n[0],o=s.cache;if(o.has(a))return o.get(a);var c=t.apply(this,n);return s.cache=o.set(a,c)||o,c};return s.cache=new(gD.Cache||UK),s}gD.Cache=UK;var WK=gD;const rje=tn(WK);var sje=WK,nje=500;function aje(t){var r=sje(t,function(n){return s.size===nje&&s.clear(),n}),s=r.cache;return r}var ije=aje,oje=ije,lje=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,cje=/\\(\\)?/g,dje=oje(function(t){var r=[];return t.charCodeAt(0)===46&&r.push(""),t.replace(lje,function(s,n,a,o){r.push(a?o.replace(cje,"$1"):n||s)}),r}),uje=dje;function hje(t,r){for(var s=-1,n=t==null?0:t.length,a=Array(n);++s<n;)a[s]=r(t[s],s,t);return a}var yD=hje,E$=H_,mje=yD,fje=Zo,pje=bv,M$=E$?E$.prototype:void 0,O$=M$?M$.toString:void 0;function GK(t){if(typeof t=="string")return t;if(fje(t))return mje(t,GK)+"";if(pje(t))return O$?O$.call(t):"";var r=t+"";return r=="0"&&1/t==-1/0?"-0":r}var xje=GK,gje=xje;function yje(t){return t==null?"":gje(t)}var KK=yje,vje=Zo,jje=hD,bje=uje,_je=KK;function wje(t,r){return vje(t)?t:jje(t,r)?[t]:bje(_je(t))}var HK=wje,Nje=bv;function Sje(t){if(typeof t=="string"||Nje(t))return t;var r=t+"";return r=="0"&&1/t==-1/0?"-0":r}var eP=Sje,Cje=HK,Pje=eP;function kje(t,r){r=Cje(r,t);for(var s=0,n=r.length;t!=null&&s<n;)t=t[Pje(r[s++])];return s&&s==n?t:void 0}var vD=kje,Aje=vD;function Tje(t,r,s){var n=t==null?void 0:Aje(t,r);return n===void 0?s:n}var ZK=Tje;const vl=tn(ZK);function Eje(t){return t==null}var Mje=Eje;const ts=tn(Mje);var Oje=Xu,Ije=Zo,Dje=Qu,Rje="[object String]";function Lje(t){return typeof t=="string"||!Ije(t)&&Dje(t)&&Oje(t)==Rje}var Fje=Lje;const Z_=tn(Fje);var YK={exports:{}},pn={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jD=Symbol.for("react.element"),bD=Symbol.for("react.portal"),tP=Symbol.for("react.fragment"),rP=Symbol.for("react.strict_mode"),sP=Symbol.for("react.profiler"),nP=Symbol.for("react.provider"),aP=Symbol.for("react.context"),$je=Symbol.for("react.server_context"),iP=Symbol.for("react.forward_ref"),oP=Symbol.for("react.suspense"),lP=Symbol.for("react.suspense_list"),cP=Symbol.for("react.memo"),dP=Symbol.for("react.lazy"),zje=Symbol.for("react.offscreen"),XK;XK=Symbol.for("react.module.reference");function nc(t){if(typeof t=="object"&&t!==null){var r=t.$$typeof;switch(r){case jD:switch(t=t.type,t){case tP:case sP:case rP:case oP:case lP:return t;default:switch(t=t&&t.$$typeof,t){case $je:case aP:case iP:case dP:case cP:case nP:return t;default:return r}}case bD:return r}}}pn.ContextConsumer=aP;pn.ContextProvider=nP;pn.Element=jD;pn.ForwardRef=iP;pn.Fragment=tP;pn.Lazy=dP;pn.Memo=cP;pn.Portal=bD;pn.Profiler=sP;pn.StrictMode=rP;pn.Suspense=oP;pn.SuspenseList=lP;pn.isAsyncMode=function(){return!1};pn.isConcurrentMode=function(){return!1};pn.isContextConsumer=function(t){return nc(t)===aP};pn.isContextProvider=function(t){return nc(t)===nP};pn.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===jD};pn.isForwardRef=function(t){return nc(t)===iP};pn.isFragment=function(t){return nc(t)===tP};pn.isLazy=function(t){return nc(t)===dP};pn.isMemo=function(t){return nc(t)===cP};pn.isPortal=function(t){return nc(t)===bD};pn.isProfiler=function(t){return nc(t)===sP};pn.isStrictMode=function(t){return nc(t)===rP};pn.isSuspense=function(t){return nc(t)===oP};pn.isSuspenseList=function(t){return nc(t)===lP};pn.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===tP||t===sP||t===rP||t===oP||t===lP||t===zje||typeof t=="object"&&t!==null&&(t.$$typeof===dP||t.$$typeof===cP||t.$$typeof===nP||t.$$typeof===aP||t.$$typeof===iP||t.$$typeof===XK||t.getModuleId!==void 0)};pn.typeOf=nc;YK.exports=pn;var Bje=YK.exports,qje=Xu,Vje=Qu,Uje="[object Number]";function Wje(t){return typeof t=="number"||Vje(t)&&qje(t)==Uje}var QK=Wje;const Gje=tn(QK);var Kje=QK;function Hje(t){return Kje(t)&&t!=+t}var Zje=Hje;const Cv=tn(Zje);var wo=function(r){return r===0?0:r>0?1:-1},Zf=function(r){return Z_(r)&&r.indexOf("%")===r.length-1},cr=function(r){return Gje(r)&&!Cv(r)},di=function(r){return cr(r)||Z_(r)},Yje=0,qp=function(r){var s=++Yje;return"".concat(r||"").concat(s)},No=function(r,s){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!cr(r)&&!Z_(r))return n;var o;if(Zf(r)){var c=r.indexOf("%");o=s*parseFloat(r.slice(0,c))/100}else o=+r;return Cv(o)&&(o=n),a&&o>s&&(o=s),o},Vh=function(r){if(!r)return null;var s=Object.keys(r);return s&&s.length?r[s[0]]:null},Xje=function(r){if(!Array.isArray(r))return!1;for(var s=r.length,n={},a=0;a<s;a++)if(!n[r[a]])n[r[a]]=!0;else return!0;return!1},ca=function(r,s){return cr(r)&&cr(s)?function(n){return r+n*(s-r)}:function(){return s}};function GS(t,r,s){return!t||!t.length?null:t.find(function(n){return n&&(typeof r=="function"?r(n):vl(n,r))===s})}function Vg(t,r){for(var s in t)if({}.hasOwnProperty.call(t,s)&&(!{}.hasOwnProperty.call(r,s)||t[s]!==r[s]))return!1;for(var n in r)if({}.hasOwnProperty.call(r,n)&&!{}.hasOwnProperty.call(t,n))return!1;return!0}function RM(t){"@babel/helpers - typeof";return RM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},RM(t)}var Qje=["viewBox","children"],Jje=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],I$=["points","pathLength"],nT={svg:Qje,polygon:I$,polyline:I$},_D=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],KS=function(r,s){if(!r||typeof r=="function"||typeof r=="boolean")return null;var n=r;if(A.isValidElement(r)&&(n=r.props),!_v(n))return null;var a={};return Object.keys(n).forEach(function(o){_D.includes(o)&&(a[o]=s||function(c){return n[o](n,c)})}),a},e0e=function(r,s,n){return function(a){return r(s,n,a),null}},Tp=function(r,s,n){if(!_v(r)||RM(r)!=="object")return null;var a=null;return Object.keys(r).forEach(function(o){var c=r[o];_D.includes(o)&&typeof c=="function"&&(a||(a={}),a[o]=e0e(c,s,n))}),a},t0e=["children"],r0e=["children"];function D$(t,r){if(t==null)return{};var s=s0e(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function s0e(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function LM(t){"@babel/helpers - typeof";return LM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},LM(t)}var R$={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},Eu=function(r){return typeof r=="string"?r:r?r.displayName||r.name||"Component":""},L$=null,aT=null,wD=function t(r){if(r===L$&&Array.isArray(aT))return aT;var s=[];return A.Children.forEach(r,function(n){ts(n)||(Bje.isFragment(n)?s=s.concat(t(n.props.children)):s.push(n))}),aT=s,L$=r,s};function jl(t,r){var s=[],n=[];return Array.isArray(r)?n=r.map(function(a){return Eu(a)}):n=[Eu(r)],wD(t).forEach(function(a){var o=vl(a,"type.displayName")||vl(a,"type.name");n.indexOf(o)!==-1&&s.push(a)}),s}function dl(t,r){var s=jl(t,r);return s&&s[0]}var F$=function(r){if(!r||!r.props)return!1;var s=r.props,n=s.width,a=s.height;return!(!cr(n)||n<=0||!cr(a)||a<=0)},n0e=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],a0e=function(r){return r&&r.type&&Z_(r.type)&&n0e.indexOf(r.type)>=0},JK=function(r){return r&&LM(r)==="object"&&"clipDot"in r},i0e=function(r,s,n,a){var o,c=(o=nT==null?void 0:nT[a])!==null&&o!==void 0?o:[];return!Wr(r)&&(a&&c.includes(s)||Jje.includes(s))||n&&_D.includes(s)},Or=function(r,s,n){if(!r||typeof r=="function"||typeof r=="boolean")return null;var a=r;if(A.isValidElement(r)&&(a=r.props),!_v(a))return null;var o={};return Object.keys(a).forEach(function(c){var i;i0e((i=a)===null||i===void 0?void 0:i[c],c,s,n)&&(o[c]=a[c])}),o},FM=function t(r,s){if(r===s)return!0;var n=A.Children.count(r);if(n!==A.Children.count(s))return!1;if(n===0)return!0;if(n===1)return $$(Array.isArray(r)?r[0]:r,Array.isArray(s)?s[0]:s);for(var a=0;a<n;a++){var o=r[a],c=s[a];if(Array.isArray(o)||Array.isArray(c)){if(!t(o,c))return!1}else if(!$$(o,c))return!1}return!0},$$=function(r,s){if(ts(r)&&ts(s))return!0;if(!ts(r)&&!ts(s)){var n=r.props||{},a=n.children,o=D$(n,t0e),c=s.props||{},i=c.children,f=D$(c,r0e);return a&&i?Vg(o,f)&&FM(a,i):!a&&!i?Vg(o,f):!1}return!1},z$=function(r,s){var n=[],a={};return wD(r).forEach(function(o,c){if(a0e(o))n.push(o);else if(o){var i=Eu(o.type),f=s[i]||{},p=f.handler,g=f.once;if(p&&(!g||!a[i])){var y=p(o,i,c);n.push(y),a[i]=!0}}}),n},o0e=function(r){var s=r&&r.type;return s&&R$[s]?R$[s]:null},l0e=function(r,s){return wD(s).indexOf(r)},c0e=["children","width","height","viewBox","className","style","title","desc"];function $M(){return $M=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},$M.apply(this,arguments)}function d0e(t,r){if(t==null)return{};var s=u0e(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function u0e(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function zM(t){var r=t.children,s=t.width,n=t.height,a=t.viewBox,o=t.className,c=t.style,i=t.title,f=t.desc,p=d0e(t,c0e),g=a||{width:s,height:n,x:0,y:0},y=rs("recharts-surface",o);return je.createElement("svg",$M({},Or(p,!0,"svg"),{className:y,width:s,height:n,style:c,viewBox:"".concat(g.x," ").concat(g.y," ").concat(g.width," ").concat(g.height)}),je.createElement("title",null,i),je.createElement("desc",null,f),r)}var h0e=["children","className"];function BM(){return BM=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},BM.apply(this,arguments)}function m0e(t,r){if(t==null)return{};var s=f0e(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function f0e(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}var _s=je.forwardRef(function(t,r){var s=t.children,n=t.className,a=m0e(t,h0e),o=rs("recharts-layer",n);return je.createElement("g",BM({className:o},Or(a,!0),{ref:r}),s)}),Uc=function(r,s){for(var n=arguments.length,a=new Array(n>2?n-2:0),o=2;o<n;o++)a[o-2]=arguments[o]};function p0e(t,r,s){var n=-1,a=t.length;r<0&&(r=-r>a?0:a+r),s=s>a?a:s,s<0&&(s+=a),a=r>s?0:s-r>>>0,r>>>=0;for(var o=Array(a);++n<a;)o[n]=t[n+r];return o}var x0e=p0e,g0e=x0e;function y0e(t,r,s){var n=t.length;return s=s===void 0?n:s,!r&&s>=n?t:g0e(t,r,s)}var v0e=y0e,j0e="\\ud800-\\udfff",b0e="\\u0300-\\u036f",_0e="\\ufe20-\\ufe2f",w0e="\\u20d0-\\u20ff",N0e=b0e+_0e+w0e,S0e="\\ufe0e\\ufe0f",C0e="\\u200d",P0e=RegExp("["+C0e+j0e+N0e+S0e+"]");function k0e(t){return P0e.test(t)}var eH=k0e;function A0e(t){return t.split("")}var T0e=A0e,tH="\\ud800-\\udfff",E0e="\\u0300-\\u036f",M0e="\\ufe20-\\ufe2f",O0e="\\u20d0-\\u20ff",I0e=E0e+M0e+O0e,D0e="\\ufe0e\\ufe0f",R0e="["+tH+"]",qM="["+I0e+"]",VM="\\ud83c[\\udffb-\\udfff]",L0e="(?:"+qM+"|"+VM+")",rH="[^"+tH+"]",sH="(?:\\ud83c[\\udde6-\\uddff]){2}",nH="[\\ud800-\\udbff][\\udc00-\\udfff]",F0e="\\u200d",aH=L0e+"?",iH="["+D0e+"]?",$0e="(?:"+F0e+"(?:"+[rH,sH,nH].join("|")+")"+iH+aH+")*",z0e=iH+aH+$0e,B0e="(?:"+[rH+qM+"?",qM,sH,nH,R0e].join("|")+")",q0e=RegExp(VM+"(?="+VM+")|"+B0e+z0e,"g");function V0e(t){return t.match(q0e)||[]}var U0e=V0e,W0e=T0e,G0e=eH,K0e=U0e;function H0e(t){return G0e(t)?K0e(t):W0e(t)}var Z0e=H0e,Y0e=v0e,X0e=eH,Q0e=Z0e,J0e=KK;function ebe(t){return function(r){r=J0e(r);var s=X0e(r)?Q0e(r):void 0,n=s?s[0]:r.charAt(0),a=s?Y0e(s,1).join(""):r.slice(1);return n[t]()+a}}var tbe=ebe,rbe=tbe,sbe=rbe("toUpperCase"),nbe=sbe;const uP=tn(nbe);function Ln(t){return function(){return t}}const oH=Math.cos,HS=Math.sin,Qc=Math.sqrt,ZS=Math.PI,hP=2*ZS,UM=Math.PI,WM=2*UM,$f=1e-6,abe=WM-$f;function lH(t){this._+=t[0];for(let r=1,s=t.length;r<s;++r)this._+=arguments[r]+t[r]}function ibe(t){let r=Math.floor(t);if(!(r>=0))throw new Error(`invalid digits: ${t}`);if(r>15)return lH;const s=10**r;return function(n){this._+=n[0];for(let a=1,o=n.length;a<o;++a)this._+=Math.round(arguments[a]*s)/s+n[a]}}class obe{constructor(r){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=r==null?lH:ibe(r)}moveTo(r,s){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+s}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(r,s){this._append`L${this._x1=+r},${this._y1=+s}`}quadraticCurveTo(r,s,n,a){this._append`Q${+r},${+s},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(r,s,n,a,o,c){this._append`C${+r},${+s},${+n},${+a},${this._x1=+o},${this._y1=+c}`}arcTo(r,s,n,a,o){if(r=+r,s=+s,n=+n,a=+a,o=+o,o<0)throw new Error(`negative radius: ${o}`);let c=this._x1,i=this._y1,f=n-r,p=a-s,g=c-r,y=i-s,b=g*g+y*y;if(this._x1===null)this._append`M${this._x1=r},${this._y1=s}`;else if(b>$f)if(!(Math.abs(y*f-p*g)>$f)||!o)this._append`L${this._x1=r},${this._y1=s}`;else{let w=n-c,T=a-i,N=f*f+p*p,M=w*w+T*T,O=Math.sqrt(N),C=Math.sqrt(b),D=o*Math.tan((UM-Math.acos((N+b-M)/(2*O*C)))/2),L=D/C,F=D/O;Math.abs(L-1)>$f&&this._append`L${r+L*g},${s+L*y}`,this._append`A${o},${o},0,0,${+(y*w>g*T)},${this._x1=r+F*f},${this._y1=s+F*p}`}}arc(r,s,n,a,o,c){if(r=+r,s=+s,n=+n,c=!!c,n<0)throw new Error(`negative radius: ${n}`);let i=n*Math.cos(a),f=n*Math.sin(a),p=r+i,g=s+f,y=1^c,b=c?a-o:o-a;this._x1===null?this._append`M${p},${g}`:(Math.abs(this._x1-p)>$f||Math.abs(this._y1-g)>$f)&&this._append`L${p},${g}`,n&&(b<0&&(b=b%WM+WM),b>abe?this._append`A${n},${n},0,1,${y},${r-i},${s-f}A${n},${n},0,1,${y},${this._x1=p},${this._y1=g}`:b>$f&&this._append`A${n},${n},0,${+(b>=UM)},${y},${this._x1=r+n*Math.cos(o)},${this._y1=s+n*Math.sin(o)}`)}rect(r,s,n,a){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+s}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function ND(t){let r=3;return t.digits=function(s){if(!arguments.length)return r;if(s==null)r=null;else{const n=Math.floor(s);if(!(n>=0))throw new RangeError(`invalid digits: ${s}`);r=n}return t},()=>new obe(r)}function SD(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function cH(t){this._context=t}cH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,r){switch(t=+t,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break;case 1:this._point=2;default:this._context.lineTo(t,r);break}}};function mP(t){return new cH(t)}function dH(t){return t[0]}function uH(t){return t[1]}function hH(t,r){var s=Ln(!0),n=null,a=mP,o=null,c=ND(i);t=typeof t=="function"?t:t===void 0?dH:Ln(t),r=typeof r=="function"?r:r===void 0?uH:Ln(r);function i(f){var p,g=(f=SD(f)).length,y,b=!1,w;for(n==null&&(o=a(w=c())),p=0;p<=g;++p)!(p<g&&s(y=f[p],p,f))===b&&((b=!b)?o.lineStart():o.lineEnd()),b&&o.point(+t(y,p,f),+r(y,p,f));if(w)return o=null,w+""||null}return i.x=function(f){return arguments.length?(t=typeof f=="function"?f:Ln(+f),i):t},i.y=function(f){return arguments.length?(r=typeof f=="function"?f:Ln(+f),i):r},i.defined=function(f){return arguments.length?(s=typeof f=="function"?f:Ln(!!f),i):s},i.curve=function(f){return arguments.length?(a=f,n!=null&&(o=a(n)),i):a},i.context=function(f){return arguments.length?(f==null?n=o=null:o=a(n=f),i):n},i}function dN(t,r,s){var n=null,a=Ln(!0),o=null,c=mP,i=null,f=ND(p);t=typeof t=="function"?t:t===void 0?dH:Ln(+t),r=typeof r=="function"?r:Ln(r===void 0?0:+r),s=typeof s=="function"?s:s===void 0?uH:Ln(+s);function p(y){var b,w,T,N=(y=SD(y)).length,M,O=!1,C,D=new Array(N),L=new Array(N);for(o==null&&(i=c(C=f())),b=0;b<=N;++b){if(!(b<N&&a(M=y[b],b,y))===O)if(O=!O)w=b,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),T=b-1;T>=w;--T)i.point(D[T],L[T]);i.lineEnd(),i.areaEnd()}O&&(D[b]=+t(M,b,y),L[b]=+r(M,b,y),i.point(n?+n(M,b,y):D[b],s?+s(M,b,y):L[b]))}if(C)return i=null,C+""||null}function g(){return hH().defined(a).curve(c).context(o)}return p.x=function(y){return arguments.length?(t=typeof y=="function"?y:Ln(+y),n=null,p):t},p.x0=function(y){return arguments.length?(t=typeof y=="function"?y:Ln(+y),p):t},p.x1=function(y){return arguments.length?(n=y==null?null:typeof y=="function"?y:Ln(+y),p):n},p.y=function(y){return arguments.length?(r=typeof y=="function"?y:Ln(+y),s=null,p):r},p.y0=function(y){return arguments.length?(r=typeof y=="function"?y:Ln(+y),p):r},p.y1=function(y){return arguments.length?(s=y==null?null:typeof y=="function"?y:Ln(+y),p):s},p.lineX0=p.lineY0=function(){return g().x(t).y(r)},p.lineY1=function(){return g().x(t).y(s)},p.lineX1=function(){return g().x(n).y(r)},p.defined=function(y){return arguments.length?(a=typeof y=="function"?y:Ln(!!y),p):a},p.curve=function(y){return arguments.length?(c=y,o!=null&&(i=c(o)),p):c},p.context=function(y){return arguments.length?(y==null?o=i=null:i=c(o=y),p):o},p}class mH{constructor(r,s){this._context=r,this._x=s}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(r,s){switch(r=+r,s=+s,this._point){case 0:{this._point=1,this._line?this._context.lineTo(r,s):this._context.moveTo(r,s);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+r)/2,this._y0,this._x0,s,r,s):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+s)/2,r,this._y0,r,s);break}}this._x0=r,this._y0=s}}function lbe(t){return new mH(t,!0)}function cbe(t){return new mH(t,!1)}const CD={draw(t,r){const s=Qc(r/ZS);t.moveTo(s,0),t.arc(0,0,s,0,hP)}},dbe={draw(t,r){const s=Qc(r/5)/2;t.moveTo(-3*s,-s),t.lineTo(-s,-s),t.lineTo(-s,-3*s),t.lineTo(s,-3*s),t.lineTo(s,-s),t.lineTo(3*s,-s),t.lineTo(3*s,s),t.lineTo(s,s),t.lineTo(s,3*s),t.lineTo(-s,3*s),t.lineTo(-s,s),t.lineTo(-3*s,s),t.closePath()}},fH=Qc(1/3),ube=fH*2,hbe={draw(t,r){const s=Qc(r/ube),n=s*fH;t.moveTo(0,-s),t.lineTo(n,0),t.lineTo(0,s),t.lineTo(-n,0),t.closePath()}},mbe={draw(t,r){const s=Qc(r),n=-s/2;t.rect(n,n,s,s)}},fbe=.8908130915292852,pH=HS(ZS/10)/HS(7*ZS/10),pbe=HS(hP/10)*pH,xbe=-oH(hP/10)*pH,gbe={draw(t,r){const s=Qc(r*fbe),n=pbe*s,a=xbe*s;t.moveTo(0,-s),t.lineTo(n,a);for(let o=1;o<5;++o){const c=hP*o/5,i=oH(c),f=HS(c);t.lineTo(f*s,-i*s),t.lineTo(i*n-f*a,f*n+i*a)}t.closePath()}},iT=Qc(3),ybe={draw(t,r){const s=-Qc(r/(iT*3));t.moveTo(0,s*2),t.lineTo(-iT*s,-s),t.lineTo(iT*s,-s),t.closePath()}},El=-.5,Ml=Qc(3)/2,GM=1/Qc(12),vbe=(GM/2+1)*3,jbe={draw(t,r){const s=Qc(r/vbe),n=s/2,a=s*GM,o=n,c=s*GM+s,i=-o,f=c;t.moveTo(n,a),t.lineTo(o,c),t.lineTo(i,f),t.lineTo(El*n-Ml*a,Ml*n+El*a),t.lineTo(El*o-Ml*c,Ml*o+El*c),t.lineTo(El*i-Ml*f,Ml*i+El*f),t.lineTo(El*n+Ml*a,El*a-Ml*n),t.lineTo(El*o+Ml*c,El*c-Ml*o),t.lineTo(El*i+Ml*f,El*f-Ml*i),t.closePath()}};function bbe(t,r){let s=null,n=ND(a);t=typeof t=="function"?t:Ln(t||CD),r=typeof r=="function"?r:Ln(r===void 0?64:+r);function a(){let o;if(s||(s=o=n()),t.apply(this,arguments).draw(s,+r.apply(this,arguments)),o)return s=null,o+""||null}return a.type=function(o){return arguments.length?(t=typeof o=="function"?o:Ln(o),a):t},a.size=function(o){return arguments.length?(r=typeof o=="function"?o:Ln(+o),a):r},a.context=function(o){return arguments.length?(s=o??null,a):s},a}function YS(){}function XS(t,r,s){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+r)/6,(t._y0+4*t._y1+s)/6)}function xH(t){this._context=t}xH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:XS(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,r){switch(t=+t,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:XS(this,t,r);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=r}};function _be(t){return new xH(t)}function gH(t){this._context=t}gH.prototype={areaStart:YS,areaEnd:YS,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,r){switch(t=+t,r=+r,this._point){case 0:this._point=1,this._x2=t,this._y2=r;break;case 1:this._point=2,this._x3=t,this._y3=r;break;case 2:this._point=3,this._x4=t,this._y4=r,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+r)/6);break;default:XS(this,t,r);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=r}};function wbe(t){return new gH(t)}function yH(t){this._context=t}yH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,r){switch(t=+t,r=+r,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var s=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+r)/6;this._line?this._context.lineTo(s,n):this._context.moveTo(s,n);break;case 3:this._point=4;default:XS(this,t,r);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=r}};function Nbe(t){return new yH(t)}function vH(t){this._context=t}vH.prototype={areaStart:YS,areaEnd:YS,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,r){t=+t,r=+r,this._point?this._context.lineTo(t,r):(this._point=1,this._context.moveTo(t,r))}};function Sbe(t){return new vH(t)}function B$(t){return t<0?-1:1}function q$(t,r,s){var n=t._x1-t._x0,a=r-t._x1,o=(t._y1-t._y0)/(n||a<0&&-0),c=(s-t._y1)/(a||n<0&&-0),i=(o*a+c*n)/(n+a);return(B$(o)+B$(c))*Math.min(Math.abs(o),Math.abs(c),.5*Math.abs(i))||0}function V$(t,r){var s=t._x1-t._x0;return s?(3*(t._y1-t._y0)/s-r)/2:r}function oT(t,r,s){var n=t._x0,a=t._y0,o=t._x1,c=t._y1,i=(o-n)/3;t._context.bezierCurveTo(n+i,a+i*r,o-i,c-i*s,o,c)}function QS(t){this._context=t}QS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:oT(this,this._t0,V$(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,r){var s=NaN;if(t=+t,r=+r,!(t===this._x1&&r===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break;case 1:this._point=2;break;case 2:this._point=3,oT(this,V$(this,s=q$(this,t,r)),s);break;default:oT(this,this._t0,s=q$(this,t,r));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=r,this._t0=s}}};function jH(t){this._context=new bH(t)}(jH.prototype=Object.create(QS.prototype)).point=function(t,r){QS.prototype.point.call(this,r,t)};function bH(t){this._context=t}bH.prototype={moveTo:function(t,r){this._context.moveTo(r,t)},closePath:function(){this._context.closePath()},lineTo:function(t,r){this._context.lineTo(r,t)},bezierCurveTo:function(t,r,s,n,a,o){this._context.bezierCurveTo(r,t,n,s,o,a)}};function Cbe(t){return new QS(t)}function Pbe(t){return new jH(t)}function _H(t){this._context=t}_H.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,r=this._y,s=t.length;if(s)if(this._line?this._context.lineTo(t[0],r[0]):this._context.moveTo(t[0],r[0]),s===2)this._context.lineTo(t[1],r[1]);else for(var n=U$(t),a=U$(r),o=0,c=1;c<s;++o,++c)this._context.bezierCurveTo(n[0][o],a[0][o],n[1][o],a[1][o],t[c],r[c]);(this._line||this._line!==0&&s===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,r){this._x.push(+t),this._y.push(+r)}};function U$(t){var r,s=t.length-1,n,a=new Array(s),o=new Array(s),c=new Array(s);for(a[0]=0,o[0]=2,c[0]=t[0]+2*t[1],r=1;r<s-1;++r)a[r]=1,o[r]=4,c[r]=4*t[r]+2*t[r+1];for(a[s-1]=2,o[s-1]=7,c[s-1]=8*t[s-1]+t[s],r=1;r<s;++r)n=a[r]/o[r-1],o[r]-=n,c[r]-=n*c[r-1];for(a[s-1]=c[s-1]/o[s-1],r=s-2;r>=0;--r)a[r]=(c[r]-a[r+1])/o[r];for(o[s-1]=(t[s]+a[s-1])/2,r=0;r<s-1;++r)o[r]=2*t[r+1]-a[r+1];return[a,o]}function kbe(t){return new _H(t)}function fP(t,r){this._context=t,this._t=r}fP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,r){switch(t=+t,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,r),this._context.lineTo(t,r);else{var s=this._x*(1-this._t)+t*this._t;this._context.lineTo(s,this._y),this._context.lineTo(s,r)}break}}this._x=t,this._y=r}};function Abe(t){return new fP(t,.5)}function Tbe(t){return new fP(t,0)}function Ebe(t){return new fP(t,1)}function ky(t,r){if((c=t.length)>1)for(var s=1,n,a,o=t[r[0]],c,i=o.length;s<c;++s)for(a=o,o=t[r[s]],n=0;n<i;++n)o[n][1]+=o[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function KM(t){for(var r=t.length,s=new Array(r);--r>=0;)s[r]=r;return s}function Mbe(t,r){return t[r]}function Obe(t){const r=[];return r.key=t,r}function Ibe(){var t=Ln([]),r=KM,s=ky,n=Mbe;function a(o){var c=Array.from(t.apply(this,arguments),Obe),i,f=c.length,p=-1,g;for(const y of o)for(i=0,++p;i<f;++i)(c[i][p]=[0,+n(y,c[i].key,p,o)]).data=y;for(i=0,g=SD(r(c));i<f;++i)c[g[i]].index=i;return s(c,g),c}return a.keys=function(o){return arguments.length?(t=typeof o=="function"?o:Ln(Array.from(o)),a):t},a.value=function(o){return arguments.length?(n=typeof o=="function"?o:Ln(+o),a):n},a.order=function(o){return arguments.length?(r=o==null?KM:typeof o=="function"?o:Ln(Array.from(o)),a):r},a.offset=function(o){return arguments.length?(s=o??ky,a):s},a}function Dbe(t,r){if((n=t.length)>0){for(var s,n,a=0,o=t[0].length,c;a<o;++a){for(c=s=0;s<n;++s)c+=t[s][a][1]||0;if(c)for(s=0;s<n;++s)t[s][a][1]/=c}ky(t,r)}}function Rbe(t,r){if((a=t.length)>0){for(var s=0,n=t[r[0]],a,o=n.length;s<o;++s){for(var c=0,i=0;c<a;++c)i+=t[c][s][1]||0;n[s][1]+=n[s][0]=-i/2}ky(t,r)}}function Lbe(t,r){if(!(!((c=t.length)>0)||!((o=(a=t[r[0]]).length)>0))){for(var s=0,n=1,a,o,c;n<o;++n){for(var i=0,f=0,p=0;i<c;++i){for(var g=t[r[i]],y=g[n][1]||0,b=g[n-1][1]||0,w=(y-b)/2,T=0;T<i;++T){var N=t[r[T]],M=N[n][1]||0,O=N[n-1][1]||0;w+=M-O}f+=y,p+=w*y}a[n-1][1]+=a[n-1][0]=s,f&&(s-=p/f)}a[n-1][1]+=a[n-1][0]=s,ky(t,r)}}function Eb(t){"@babel/helpers - typeof";return Eb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Eb(t)}var Fbe=["type","size","sizeType"];function HM(){return HM=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},HM.apply(this,arguments)}function W$(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function G$(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?W$(Object(s),!0).forEach(function(n){$be(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):W$(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function $be(t,r,s){return r=zbe(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function zbe(t){var r=Bbe(t,"string");return Eb(r)=="symbol"?r:r+""}function Bbe(t,r){if(Eb(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Eb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function qbe(t,r){if(t==null)return{};var s=Vbe(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function Vbe(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}var wH={symbolCircle:CD,symbolCross:dbe,symbolDiamond:hbe,symbolSquare:mbe,symbolStar:gbe,symbolTriangle:ybe,symbolWye:jbe},Ube=Math.PI/180,Wbe=function(r){var s="symbol".concat(uP(r));return wH[s]||CD},Gbe=function(r,s,n){if(s==="area")return r;switch(n){case"cross":return 5*r*r/9;case"diamond":return .5*r*r/Math.sqrt(3);case"square":return r*r;case"star":{var a=18*Ube;return 1.25*r*r*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*r*r/4;case"wye":return(21-10*Math.sqrt(3))*r*r/8;default:return Math.PI*r*r/4}},Kbe=function(r,s){wH["symbol".concat(uP(r))]=s},PD=function(r){var s=r.type,n=s===void 0?"circle":s,a=r.size,o=a===void 0?64:a,c=r.sizeType,i=c===void 0?"area":c,f=qbe(r,Fbe),p=G$(G$({},f),{},{type:n,size:o,sizeType:i}),g=function(){var M=Wbe(n),O=bbe().type(M).size(Gbe(o,i,n));return O()},y=p.className,b=p.cx,w=p.cy,T=Or(p,!0);return b===+b&&w===+w&&o===+o?je.createElement("path",HM({},T,{className:rs("recharts-symbols",y),transform:"translate(".concat(b,", ").concat(w,")"),d:g()})):null};PD.registerSymbol=Kbe;function Ay(t){"@babel/helpers - typeof";return Ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ay(t)}function ZM(){return ZM=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},ZM.apply(this,arguments)}function K$(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function Hbe(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?K$(Object(s),!0).forEach(function(n){Mb(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):K$(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function Zbe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Ybe(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,SH(n.key),n)}}function Xbe(t,r,s){return r&&Ybe(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Qbe(t,r,s){return r=JS(r),Jbe(t,NH()?Reflect.construct(r,s||[],JS(t).constructor):r.apply(t,s))}function Jbe(t,r){if(r&&(Ay(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return e_e(t)}function e_e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function NH(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NH=function(){return!!t})()}function JS(t){return JS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},JS(t)}function t_e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&YM(t,r)}function YM(t,r){return YM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},YM(t,r)}function Mb(t,r,s){return r=SH(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function SH(t){var r=r_e(t,"string");return Ay(r)=="symbol"?r:r+""}function r_e(t,r){if(Ay(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Ay(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Ol=32,kD=function(t){function r(){return Zbe(this,r),Qbe(this,r,arguments)}return t_e(r,t),Xbe(r,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,o=Ol/2,c=Ol/6,i=Ol/3,f=n.inactive?a:n.color;if(n.type==="plainline")return je.createElement("line",{strokeWidth:4,fill:"none",stroke:f,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:o,x2:Ol,y2:o,className:"recharts-legend-icon"});if(n.type==="line")return je.createElement("path",{strokeWidth:4,fill:"none",stroke:f,d:"M0,".concat(o,"h").concat(i,`
            A`).concat(c,",").concat(c,",0,1,1,").concat(2*i,",").concat(o,`
            H`).concat(Ol,"M").concat(2*i,",").concat(o,`
            A`).concat(c,",").concat(c,",0,1,1,").concat(i,",").concat(o),className:"recharts-legend-icon"});if(n.type==="rect")return je.createElement("path",{stroke:"none",fill:f,d:"M0,".concat(Ol/8,"h").concat(Ol,"v").concat(Ol*3/4,"h").concat(-Ol,"z"),className:"recharts-legend-icon"});if(je.isValidElement(n.legendIcon)){var p=Hbe({},n);return delete p.legendIcon,je.cloneElement(n.legendIcon,p)}return je.createElement(PD,{fill:f,cx:o,cy:o,size:Ol,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,o=a.payload,c=a.iconSize,i=a.layout,f=a.formatter,p=a.inactiveColor,g={x:0,y:0,width:Ol,height:Ol},y={display:i==="horizontal"?"inline-block":"block",marginRight:10},b={display:"inline-block",verticalAlign:"middle",marginRight:4};return o.map(function(w,T){var N=w.formatter||f,M=rs(Mb(Mb({"recharts-legend-item":!0},"legend-item-".concat(T),!0),"inactive",w.inactive));if(w.type==="none")return null;var O=Wr(w.value)?null:w.value;Uc(!Wr(w.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var C=w.inactive?p:w.color;return je.createElement("li",ZM({className:M,style:y,key:"legend-item-".concat(T)},Tp(n.props,w,T)),je.createElement(zM,{width:c,height:c,viewBox:g,style:b},n.renderIcon(w)),je.createElement("span",{className:"recharts-legend-item-text",style:{color:C}},N?N(O,w,T):O))})}},{key:"render",value:function(){var n=this.props,a=n.payload,o=n.layout,c=n.align;if(!a||!a.length)return null;var i={padding:0,margin:0,textAlign:o==="horizontal"?c:"left"};return je.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(A.PureComponent);Mb(kD,"displayName","Legend");Mb(kD,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var s_e=QC;function n_e(){this.__data__=new s_e,this.size=0}var a_e=n_e;function i_e(t){var r=this.__data__,s=r.delete(t);return this.size=r.size,s}var o_e=i_e;function l_e(t){return this.__data__.get(t)}var c_e=l_e;function d_e(t){return this.__data__.has(t)}var u_e=d_e,h_e=QC,m_e=pD,f_e=xD,p_e=200;function x_e(t,r){var s=this.__data__;if(s instanceof h_e){var n=s.__data__;if(!m_e||n.length<p_e-1)return n.push([t,r]),this.size=++s.size,this;s=this.__data__=new f_e(n)}return s.set(t,r),this.size=s.size,this}var g_e=x_e,y_e=QC,v_e=a_e,j_e=o_e,b_e=c_e,__e=u_e,w_e=g_e;function Pv(t){var r=this.__data__=new y_e(t);this.size=r.size}Pv.prototype.clear=v_e;Pv.prototype.delete=j_e;Pv.prototype.get=b_e;Pv.prototype.has=__e;Pv.prototype.set=w_e;var CH=Pv,N_e="__lodash_hash_undefined__";function S_e(t){return this.__data__.set(t,N_e),this}var C_e=S_e;function P_e(t){return this.__data__.has(t)}var k_e=P_e,A_e=xD,T_e=C_e,E_e=k_e;function e2(t){var r=-1,s=t==null?0:t.length;for(this.__data__=new A_e;++r<s;)this.add(t[r])}e2.prototype.add=e2.prototype.push=T_e;e2.prototype.has=E_e;var PH=e2;function M_e(t,r){for(var s=-1,n=t==null?0:t.length;++s<n;)if(r(t[s],s,t))return!0;return!1}var kH=M_e;function O_e(t,r){return t.has(r)}var AH=O_e,I_e=PH,D_e=kH,R_e=AH,L_e=1,F_e=2;function $_e(t,r,s,n,a,o){var c=s&L_e,i=t.length,f=r.length;if(i!=f&&!(c&&f>i))return!1;var p=o.get(t),g=o.get(r);if(p&&g)return p==r&&g==t;var y=-1,b=!0,w=s&F_e?new I_e:void 0;for(o.set(t,r),o.set(r,t);++y<i;){var T=t[y],N=r[y];if(n)var M=c?n(N,T,y,r,t,o):n(T,N,y,t,r,o);if(M!==void 0){if(M)continue;b=!1;break}if(w){if(!D_e(r,function(O,C){if(!R_e(w,C)&&(T===O||a(T,O,s,n,o)))return w.push(C)})){b=!1;break}}else if(!(T===N||a(T,N,s,n,o))){b=!1;break}}return o.delete(t),o.delete(r),b}var TH=$_e,z_e=$d,B_e=z_e.Uint8Array,q_e=B_e;function V_e(t){var r=-1,s=Array(t.size);return t.forEach(function(n,a){s[++r]=[a,n]}),s}var U_e=V_e;function W_e(t){var r=-1,s=Array(t.size);return t.forEach(function(n){s[++r]=n}),s}var AD=W_e,H$=H_,Z$=q_e,G_e=fD,K_e=TH,H_e=U_e,Z_e=AD,Y_e=1,X_e=2,Q_e="[object Boolean]",J_e="[object Date]",ewe="[object Error]",twe="[object Map]",rwe="[object Number]",swe="[object RegExp]",nwe="[object Set]",awe="[object String]",iwe="[object Symbol]",owe="[object ArrayBuffer]",lwe="[object DataView]",Y$=H$?H$.prototype:void 0,lT=Y$?Y$.valueOf:void 0;function cwe(t,r,s,n,a,o,c){switch(s){case lwe:if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case owe:return!(t.byteLength!=r.byteLength||!o(new Z$(t),new Z$(r)));case Q_e:case J_e:case rwe:return G_e(+t,+r);case ewe:return t.name==r.name&&t.message==r.message;case swe:case awe:return t==r+"";case twe:var i=H_e;case nwe:var f=n&Y_e;if(i||(i=Z_e),t.size!=r.size&&!f)return!1;var p=c.get(t);if(p)return p==r;n|=X_e,c.set(t,r);var g=K_e(i(t),i(r),n,a,o,c);return c.delete(t),g;case iwe:if(lT)return lT.call(t)==lT.call(r)}return!1}var dwe=cwe;function uwe(t,r){for(var s=-1,n=r.length,a=t.length;++s<n;)t[a+s]=r[s];return t}var EH=uwe,hwe=EH,mwe=Zo;function fwe(t,r,s){var n=r(t);return mwe(t)?n:hwe(n,s(t))}var pwe=fwe;function xwe(t,r){for(var s=-1,n=t==null?0:t.length,a=0,o=[];++s<n;){var c=t[s];r(c,s,t)&&(o[a++]=c)}return o}var gwe=xwe;function ywe(){return[]}var vwe=ywe,jwe=gwe,bwe=vwe,_we=Object.prototype,wwe=_we.propertyIsEnumerable,X$=Object.getOwnPropertySymbols,Nwe=X$?function(t){return t==null?[]:(t=Object(t),jwe(X$(t),function(r){return wwe.call(t,r)}))}:bwe,Swe=Nwe;function Cwe(t,r){for(var s=-1,n=Array(t);++s<t;)n[s]=r(s);return n}var Pwe=Cwe,kwe=Xu,Awe=Qu,Twe="[object Arguments]";function Ewe(t){return Awe(t)&&kwe(t)==Twe}var Mwe=Ewe,Q$=Mwe,Owe=Qu,MH=Object.prototype,Iwe=MH.hasOwnProperty,Dwe=MH.propertyIsEnumerable,Rwe=Q$(function(){return arguments}())?Q$:function(t){return Owe(t)&&Iwe.call(t,"callee")&&!Dwe.call(t,"callee")},TD=Rwe,t2={exports:{}};function Lwe(){return!1}var Fwe=Lwe;t2.exports;(function(t,r){var s=$d,n=Fwe,a=r&&!r.nodeType&&r,o=a&&!0&&t&&!t.nodeType&&t,c=o&&o.exports===a,i=c?s.Buffer:void 0,f=i?i.isBuffer:void 0,p=f||n;t.exports=p})(t2,t2.exports);var OH=t2.exports,$we=9007199254740991,zwe=/^(?:0|[1-9]\d*)$/;function Bwe(t,r){var s=typeof t;return r=r??$we,!!r&&(s=="number"||s!="symbol"&&zwe.test(t))&&t>-1&&t%1==0&&t<r}var ED=Bwe,qwe=9007199254740991;function Vwe(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=qwe}var MD=Vwe,Uwe=Xu,Wwe=MD,Gwe=Qu,Kwe="[object Arguments]",Hwe="[object Array]",Zwe="[object Boolean]",Ywe="[object Date]",Xwe="[object Error]",Qwe="[object Function]",Jwe="[object Map]",e1e="[object Number]",t1e="[object Object]",r1e="[object RegExp]",s1e="[object Set]",n1e="[object String]",a1e="[object WeakMap]",i1e="[object ArrayBuffer]",o1e="[object DataView]",l1e="[object Float32Array]",c1e="[object Float64Array]",d1e="[object Int8Array]",u1e="[object Int16Array]",h1e="[object Int32Array]",m1e="[object Uint8Array]",f1e="[object Uint8ClampedArray]",p1e="[object Uint16Array]",x1e="[object Uint32Array]",Wn={};Wn[l1e]=Wn[c1e]=Wn[d1e]=Wn[u1e]=Wn[h1e]=Wn[m1e]=Wn[f1e]=Wn[p1e]=Wn[x1e]=!0;Wn[Kwe]=Wn[Hwe]=Wn[i1e]=Wn[Zwe]=Wn[o1e]=Wn[Ywe]=Wn[Xwe]=Wn[Qwe]=Wn[Jwe]=Wn[e1e]=Wn[t1e]=Wn[r1e]=Wn[s1e]=Wn[n1e]=Wn[a1e]=!1;function g1e(t){return Gwe(t)&&Wwe(t.length)&&!!Wn[Uwe(t)]}var y1e=g1e;function v1e(t){return function(r){return t(r)}}var IH=v1e,r2={exports:{}};r2.exports;(function(t,r){var s=BK,n=r&&!r.nodeType&&r,a=n&&!0&&t&&!t.nodeType&&t,o=a&&a.exports===n,c=o&&s.process,i=function(){try{var f=a&&a.require&&a.require("util").types;return f||c&&c.binding&&c.binding("util")}catch{}}();t.exports=i})(r2,r2.exports);var j1e=r2.exports,b1e=y1e,_1e=IH,J$=j1e,ez=J$&&J$.isTypedArray,w1e=ez?_1e(ez):b1e,DH=w1e,N1e=Pwe,S1e=TD,C1e=Zo,P1e=OH,k1e=ED,A1e=DH,T1e=Object.prototype,E1e=T1e.hasOwnProperty;function M1e(t,r){var s=C1e(t),n=!s&&S1e(t),a=!s&&!n&&P1e(t),o=!s&&!n&&!a&&A1e(t),c=s||n||a||o,i=c?N1e(t.length,String):[],f=i.length;for(var p in t)(r||E1e.call(t,p))&&!(c&&(p=="length"||a&&(p=="offset"||p=="parent")||o&&(p=="buffer"||p=="byteLength"||p=="byteOffset")||k1e(p,f)))&&i.push(p);return i}var O1e=M1e,I1e=Object.prototype;function D1e(t){var r=t&&t.constructor,s=typeof r=="function"&&r.prototype||I1e;return t===s}var R1e=D1e;function L1e(t,r){return function(s){return t(r(s))}}var RH=L1e,F1e=RH,$1e=F1e(Object.keys,Object),z1e=$1e,B1e=R1e,q1e=z1e,V1e=Object.prototype,U1e=V1e.hasOwnProperty;function W1e(t){if(!B1e(t))return q1e(t);var r=[];for(var s in Object(t))U1e.call(t,s)&&s!="constructor"&&r.push(s);return r}var G1e=W1e,K1e=mD,H1e=MD;function Z1e(t){return t!=null&&H1e(t.length)&&!K1e(t)}var Y_=Z1e,Y1e=O1e,X1e=G1e,Q1e=Y_;function J1e(t){return Q1e(t)?Y1e(t):X1e(t)}var pP=J1e,eNe=pwe,tNe=Swe,rNe=pP;function sNe(t){return eNe(t,rNe,tNe)}var nNe=sNe,tz=nNe,aNe=1,iNe=Object.prototype,oNe=iNe.hasOwnProperty;function lNe(t,r,s,n,a,o){var c=s&aNe,i=tz(t),f=i.length,p=tz(r),g=p.length;if(f!=g&&!c)return!1;for(var y=f;y--;){var b=i[y];if(!(c?b in r:oNe.call(r,b)))return!1}var w=o.get(t),T=o.get(r);if(w&&T)return w==r&&T==t;var N=!0;o.set(t,r),o.set(r,t);for(var M=c;++y<f;){b=i[y];var O=t[b],C=r[b];if(n)var D=c?n(C,O,b,r,t,o):n(O,C,b,t,r,o);if(!(D===void 0?O===C||a(O,C,s,n,o):D)){N=!1;break}M||(M=b=="constructor")}if(N&&!M){var L=t.constructor,F=r.constructor;L!=F&&"constructor"in t&&"constructor"in r&&!(typeof L=="function"&&L instanceof L&&typeof F=="function"&&F instanceof F)&&(N=!1)}return o.delete(t),o.delete(r),N}var cNe=lNe,dNe=Bp,uNe=$d,hNe=dNe(uNe,"DataView"),mNe=hNe,fNe=Bp,pNe=$d,xNe=fNe(pNe,"Promise"),gNe=xNe,yNe=Bp,vNe=$d,jNe=yNe(vNe,"Set"),LH=jNe,bNe=Bp,_Ne=$d,wNe=bNe(_Ne,"WeakMap"),NNe=wNe,XM=mNe,QM=pD,JM=gNe,e4=LH,t4=NNe,FH=Xu,kv=VK,rz="[object Map]",SNe="[object Object]",sz="[object Promise]",nz="[object Set]",az="[object WeakMap]",iz="[object DataView]",CNe=kv(XM),PNe=kv(QM),kNe=kv(JM),ANe=kv(e4),TNe=kv(t4),zf=FH;(XM&&zf(new XM(new ArrayBuffer(1)))!=iz||QM&&zf(new QM)!=rz||JM&&zf(JM.resolve())!=sz||e4&&zf(new e4)!=nz||t4&&zf(new t4)!=az)&&(zf=function(t){var r=FH(t),s=r==SNe?t.constructor:void 0,n=s?kv(s):"";if(n)switch(n){case CNe:return iz;case PNe:return rz;case kNe:return sz;case ANe:return nz;case TNe:return az}return r});var ENe=zf,cT=CH,MNe=TH,ONe=dwe,INe=cNe,oz=ENe,lz=Zo,cz=OH,DNe=DH,RNe=1,dz="[object Arguments]",uz="[object Array]",uN="[object Object]",LNe=Object.prototype,hz=LNe.hasOwnProperty;function FNe(t,r,s,n,a,o){var c=lz(t),i=lz(r),f=c?uz:oz(t),p=i?uz:oz(r);f=f==dz?uN:f,p=p==dz?uN:p;var g=f==uN,y=p==uN,b=f==p;if(b&&cz(t)){if(!cz(r))return!1;c=!0,g=!1}if(b&&!g)return o||(o=new cT),c||DNe(t)?MNe(t,r,s,n,a,o):ONe(t,r,f,s,n,a,o);if(!(s&RNe)){var w=g&&hz.call(t,"__wrapped__"),T=y&&hz.call(r,"__wrapped__");if(w||T){var N=w?t.value():t,M=T?r.value():r;return o||(o=new cT),a(N,M,s,n,o)}}return b?(o||(o=new cT),INe(t,r,s,n,a,o)):!1}var $Ne=FNe,zNe=$Ne,mz=Qu;function $H(t,r,s,n,a){return t===r?!0:t==null||r==null||!mz(t)&&!mz(r)?t!==t&&r!==r:zNe(t,r,s,n,$H,a)}var OD=$H,BNe=CH,qNe=OD,VNe=1,UNe=2;function WNe(t,r,s,n){var a=s.length,o=a,c=!n;if(t==null)return!o;for(t=Object(t);a--;){var i=s[a];if(c&&i[2]?i[1]!==t[i[0]]:!(i[0]in t))return!1}for(;++a<o;){i=s[a];var f=i[0],p=t[f],g=i[1];if(c&&i[2]){if(p===void 0&&!(f in t))return!1}else{var y=new BNe;if(n)var b=n(p,g,f,t,r,y);if(!(b===void 0?qNe(g,p,VNe|UNe,n,y):b))return!1}}return!0}var GNe=WNe,KNe=Vm;function HNe(t){return t===t&&!KNe(t)}var zH=HNe,ZNe=zH,YNe=pP;function XNe(t){for(var r=YNe(t),s=r.length;s--;){var n=r[s],a=t[n];r[s]=[n,a,ZNe(a)]}return r}var QNe=XNe;function JNe(t,r){return function(s){return s==null?!1:s[t]===r&&(r!==void 0||t in Object(s))}}var BH=JNe,eSe=GNe,tSe=QNe,rSe=BH;function sSe(t){var r=tSe(t);return r.length==1&&r[0][2]?rSe(r[0][0],r[0][1]):function(s){return s===t||eSe(s,t,r)}}var nSe=sSe;function aSe(t,r){return t!=null&&r in Object(t)}var iSe=aSe,oSe=HK,lSe=TD,cSe=Zo,dSe=ED,uSe=MD,hSe=eP;function mSe(t,r,s){r=oSe(r,t);for(var n=-1,a=r.length,o=!1;++n<a;){var c=hSe(r[n]);if(!(o=t!=null&&s(t,c)))break;t=t[c]}return o||++n!=a?o:(a=t==null?0:t.length,!!a&&uSe(a)&&dSe(c,a)&&(cSe(t)||lSe(t)))}var fSe=mSe,pSe=iSe,xSe=fSe;function gSe(t,r){return t!=null&&xSe(t,r,pSe)}var ySe=gSe,vSe=OD,jSe=ZK,bSe=ySe,_Se=hD,wSe=zH,NSe=BH,SSe=eP,CSe=1,PSe=2;function kSe(t,r){return _Se(t)&&wSe(r)?NSe(SSe(t),r):function(s){var n=jSe(s,t);return n===void 0&&n===r?bSe(s,t):vSe(r,n,CSe|PSe)}}var ASe=kSe;function TSe(t){return t}var Av=TSe;function ESe(t){return function(r){return r==null?void 0:r[t]}}var MSe=ESe,OSe=vD;function ISe(t){return function(r){return OSe(r,t)}}var DSe=ISe,RSe=MSe,LSe=DSe,FSe=hD,$Se=eP;function zSe(t){return FSe(t)?RSe($Se(t)):LSe(t)}var BSe=zSe,qSe=nSe,VSe=ASe,USe=Av,WSe=Zo,GSe=BSe;function KSe(t){return typeof t=="function"?t:t==null?USe:typeof t=="object"?WSe(t)?VSe(t[0],t[1]):qSe(t):GSe(t)}var zd=KSe;function HSe(t,r,s,n){for(var a=t.length,o=s+(n?1:-1);n?o--:++o<a;)if(r(t[o],o,t))return o;return-1}var qH=HSe;function ZSe(t){return t!==t}var YSe=ZSe;function XSe(t,r,s){for(var n=s-1,a=t.length;++n<a;)if(t[n]===r)return n;return-1}var QSe=XSe,JSe=qH,e2e=YSe,t2e=QSe;function r2e(t,r,s){return r===r?t2e(t,r,s):JSe(t,e2e,s)}var s2e=r2e,n2e=s2e;function a2e(t,r){var s=t==null?0:t.length;return!!s&&n2e(t,r,0)>-1}var i2e=a2e;function o2e(t,r,s){for(var n=-1,a=t==null?0:t.length;++n<a;)if(s(r,t[n]))return!0;return!1}var l2e=o2e;function c2e(){}var d2e=c2e,dT=LH,u2e=d2e,h2e=AD,m2e=1/0,f2e=dT&&1/h2e(new dT([,-0]))[1]==m2e?function(t){return new dT(t)}:u2e,p2e=f2e,x2e=PH,g2e=i2e,y2e=l2e,v2e=AH,j2e=p2e,b2e=AD,_2e=200;function w2e(t,r,s){var n=-1,a=g2e,o=t.length,c=!0,i=[],f=i;if(s)c=!1,a=y2e;else if(o>=_2e){var p=r?null:j2e(t);if(p)return b2e(p);c=!1,a=v2e,f=new x2e}else f=r?[]:i;e:for(;++n<o;){var g=t[n],y=r?r(g):g;if(g=s||g!==0?g:0,c&&y===y){for(var b=f.length;b--;)if(f[b]===y)continue e;r&&f.push(y),i.push(g)}else a(f,y,s)||(f!==i&&f.push(y),i.push(g))}return i}var N2e=w2e,S2e=zd,C2e=N2e;function P2e(t,r){return t&&t.length?C2e(t,S2e(r)):[]}var k2e=P2e;const fz=tn(k2e);function VH(t,r,s){return r===!0?fz(t,s):Wr(r)?fz(t,r):t}function Ty(t){"@babel/helpers - typeof";return Ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ty(t)}var A2e=["ref"];function pz(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function xu(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?pz(Object(s),!0).forEach(function(n){xP(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):pz(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function T2e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function xz(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,WH(n.key),n)}}function E2e(t,r,s){return r&&xz(t.prototype,r),s&&xz(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function M2e(t,r,s){return r=s2(r),O2e(t,UH()?Reflect.construct(r,s||[],s2(t).constructor):r.apply(t,s))}function O2e(t,r){if(r&&(Ty(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return I2e(t)}function I2e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function UH(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(UH=function(){return!!t})()}function s2(t){return s2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},s2(t)}function D2e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&r4(t,r)}function r4(t,r){return r4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},r4(t,r)}function xP(t,r,s){return r=WH(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function WH(t){var r=R2e(t,"string");return Ty(r)=="symbol"?r:r+""}function R2e(t,r){if(Ty(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Ty(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function L2e(t,r){if(t==null)return{};var s=F2e(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function F2e(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function $2e(t){return t.value}function z2e(t,r){if(je.isValidElement(t))return je.cloneElement(t,r);if(typeof t=="function")return je.createElement(t,r);r.ref;var s=L2e(r,A2e);return je.createElement(kD,s)}var gz=1,Ea=function(t){function r(){var s;T2e(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return s=M2e(this,r,[].concat(a)),xP(s,"lastBoundingBox",{width:-1,height:-1}),s}return D2e(r,t),E2e(r,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>gz||Math.abs(a.height-this.lastBoundingBox.height)>gz)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?xu({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,o=a.layout,c=a.align,i=a.verticalAlign,f=a.margin,p=a.chartWidth,g=a.chartHeight,y,b;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(c==="center"&&o==="vertical"){var w=this.getBBoxSnapshot();y={left:((p||0)-w.width)/2}}else y=c==="right"?{right:f&&f.right||0}:{left:f&&f.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(i==="middle"){var T=this.getBBoxSnapshot();b={top:((g||0)-T.height)/2}}else b=i==="bottom"?{bottom:f&&f.bottom||0}:{top:f&&f.top||0};return xu(xu({},y),b)}},{key:"render",value:function(){var n=this,a=this.props,o=a.content,c=a.width,i=a.height,f=a.wrapperStyle,p=a.payloadUniqBy,g=a.payload,y=xu(xu({position:"absolute",width:c||"auto",height:i||"auto"},this.getDefaultPosition(f)),f);return je.createElement("div",{className:"recharts-legend-wrapper",style:y,ref:function(w){n.wrapperNode=w}},z2e(o,xu(xu({},this.props),{},{payload:VH(g,p,$2e)})))}}],[{key:"getWithHeight",value:function(n,a){var o=xu(xu({},this.defaultProps),n.props),c=o.layout;return c==="vertical"&&cr(n.props.height)?{height:n.props.height}:c==="horizontal"?{width:n.props.width||a}:null}}])}(A.PureComponent);xP(Ea,"displayName","Legend");xP(Ea,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var yz=H_,B2e=TD,q2e=Zo,vz=yz?yz.isConcatSpreadable:void 0;function V2e(t){return q2e(t)||B2e(t)||!!(vz&&t&&t[vz])}var U2e=V2e,W2e=EH,G2e=U2e;function GH(t,r,s,n,a){var o=-1,c=t.length;for(s||(s=G2e),a||(a=[]);++o<c;){var i=t[o];r>0&&s(i)?r>1?GH(i,r-1,s,n,a):W2e(a,i):n||(a[a.length]=i)}return a}var KH=GH;function K2e(t){return function(r,s,n){for(var a=-1,o=Object(r),c=n(r),i=c.length;i--;){var f=c[t?i:++a];if(s(o[f],f,o)===!1)break}return r}}var H2e=K2e,Z2e=H2e,Y2e=Z2e(),X2e=Y2e,Q2e=X2e,J2e=pP;function eCe(t,r){return t&&Q2e(t,r,J2e)}var HH=eCe,tCe=Y_;function rCe(t,r){return function(s,n){if(s==null)return s;if(!tCe(s))return t(s,n);for(var a=s.length,o=r?a:-1,c=Object(s);(r?o--:++o<a)&&n(c[o],o,c)!==!1;);return s}}var sCe=rCe,nCe=HH,aCe=sCe,iCe=aCe(nCe),ID=iCe,oCe=ID,lCe=Y_;function cCe(t,r){var s=-1,n=lCe(t)?Array(t.length):[];return oCe(t,function(a,o,c){n[++s]=r(a,o,c)}),n}var ZH=cCe;function dCe(t,r){var s=t.length;for(t.sort(r);s--;)t[s]=t[s].value;return t}var uCe=dCe,jz=bv;function hCe(t,r){if(t!==r){var s=t!==void 0,n=t===null,a=t===t,o=jz(t),c=r!==void 0,i=r===null,f=r===r,p=jz(r);if(!i&&!p&&!o&&t>r||o&&c&&f&&!i&&!p||n&&c&&f||!s&&f||!a)return 1;if(!n&&!o&&!p&&t<r||p&&s&&a&&!n&&!o||i&&s&&a||!c&&a||!f)return-1}return 0}var mCe=hCe,fCe=mCe;function pCe(t,r,s){for(var n=-1,a=t.criteria,o=r.criteria,c=a.length,i=s.length;++n<c;){var f=fCe(a[n],o[n]);if(f){if(n>=i)return f;var p=s[n];return f*(p=="desc"?-1:1)}}return t.index-r.index}var xCe=pCe,uT=yD,gCe=vD,yCe=zd,vCe=ZH,jCe=uCe,bCe=IH,_Ce=xCe,wCe=Av,NCe=Zo;function SCe(t,r,s){r.length?r=uT(r,function(o){return NCe(o)?function(c){return gCe(c,o.length===1?o[0]:o)}:o}):r=[wCe];var n=-1;r=uT(r,bCe(yCe));var a=vCe(t,function(o,c,i){var f=uT(r,function(p){return p(o)});return{criteria:f,index:++n,value:o}});return jCe(a,function(o,c){return _Ce(o,c,s)})}var CCe=SCe;function PCe(t,r,s){switch(s.length){case 0:return t.call(r);case 1:return t.call(r,s[0]);case 2:return t.call(r,s[0],s[1]);case 3:return t.call(r,s[0],s[1],s[2])}return t.apply(r,s)}var kCe=PCe,ACe=kCe,bz=Math.max;function TCe(t,r,s){return r=bz(r===void 0?t.length-1:r,0),function(){for(var n=arguments,a=-1,o=bz(n.length-r,0),c=Array(o);++a<o;)c[a]=n[r+a];a=-1;for(var i=Array(r+1);++a<r;)i[a]=n[a];return i[r]=s(c),ACe(t,this,i)}}var ECe=TCe;function MCe(t){return function(){return t}}var OCe=MCe,ICe=Bp,DCe=function(){try{var t=ICe(Object,"defineProperty");return t({},"",{}),t}catch{}}(),YH=DCe,RCe=OCe,_z=YH,LCe=Av,FCe=_z?function(t,r){return _z(t,"toString",{configurable:!0,enumerable:!1,value:RCe(r),writable:!0})}:LCe,$Ce=FCe,zCe=800,BCe=16,qCe=Date.now;function VCe(t){var r=0,s=0;return function(){var n=qCe(),a=BCe-(n-s);if(s=n,a>0){if(++r>=zCe)return arguments[0]}else r=0;return t.apply(void 0,arguments)}}var UCe=VCe,WCe=$Ce,GCe=UCe,KCe=GCe(WCe),HCe=KCe,ZCe=Av,YCe=ECe,XCe=HCe;function QCe(t,r){return XCe(YCe(t,r,ZCe),t+"")}var JCe=QCe,ePe=fD,tPe=Y_,rPe=ED,sPe=Vm;function nPe(t,r,s){if(!sPe(s))return!1;var n=typeof r;return(n=="number"?tPe(s)&&rPe(r,s.length):n=="string"&&r in s)?ePe(s[r],t):!1}var gP=nPe,aPe=KH,iPe=CCe,oPe=JCe,wz=gP,lPe=oPe(function(t,r){if(t==null)return[];var s=r.length;return s>1&&wz(t,r[0],r[1])?r=[]:s>2&&wz(r[0],r[1],r[2])&&(r=[r[0]]),iPe(t,aPe(r,1),[])}),cPe=lPe;const DD=tn(cPe);function Ob(t){"@babel/helpers - typeof";return Ob=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ob(t)}function s4(){return s4=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},s4.apply(this,arguments)}function dPe(t,r){return fPe(t)||mPe(t,r)||hPe(t,r)||uPe()}function uPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hPe(t,r){if(t){if(typeof t=="string")return Nz(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Nz(t,r)}}function Nz(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function mPe(t,r){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var n,a,o,c,i=[],f=!0,p=!1;try{if(o=(s=s.call(t)).next,r!==0)for(;!(f=(n=o.call(s)).done)&&(i.push(n.value),i.length!==r);f=!0);}catch(g){p=!0,a=g}finally{try{if(!f&&s.return!=null&&(c=s.return(),Object(c)!==c))return}finally{if(p)throw a}}return i}}function fPe(t){if(Array.isArray(t))return t}function Sz(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function hT(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?Sz(Object(s),!0).forEach(function(n){pPe(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Sz(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function pPe(t,r,s){return r=xPe(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function xPe(t){var r=gPe(t,"string");return Ob(r)=="symbol"?r:r+""}function gPe(t,r){if(Ob(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Ob(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function yPe(t){return Array.isArray(t)&&di(t[0])&&di(t[1])?t.join(" ~ "):t}var vPe=function(r){var s=r.separator,n=s===void 0?" : ":s,a=r.contentStyle,o=a===void 0?{}:a,c=r.itemStyle,i=c===void 0?{}:c,f=r.labelStyle,p=f===void 0?{}:f,g=r.payload,y=r.formatter,b=r.itemSorter,w=r.wrapperClassName,T=r.labelClassName,N=r.label,M=r.labelFormatter,O=r.accessibilityLayer,C=O===void 0?!1:O,D=function(){if(g&&g.length){var ne={padding:0,margin:0},oe=(b?DD(g,b):g).map(function(Ce,Pe){if(Ce.type==="none")return null;var Se=hT({display:"block",paddingTop:4,paddingBottom:4,color:Ce.color||"#000"},i),ae=Ce.formatter||y||yPe,be=Ce.value,de=Ce.name,Ke=be,He=de;if(ae&&Ke!=null&&He!=null){var Ve=ae(be,de,Ce,Pe,g);if(Array.isArray(Ve)){var yt=dPe(Ve,2);Ke=yt[0],He=yt[1]}else Ke=Ve}return je.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(Pe),style:Se},di(He)?je.createElement("span",{className:"recharts-tooltip-item-name"},He):null,di(He)?je.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,je.createElement("span",{className:"recharts-tooltip-item-value"},Ke),je.createElement("span",{className:"recharts-tooltip-item-unit"},Ce.unit||""))});return je.createElement("ul",{className:"recharts-tooltip-item-list",style:ne},oe)}return null},L=hT({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},o),F=hT({margin:0},p),B=!ts(N),U=B?N:"",te=rs("recharts-default-tooltip",w),Q=rs("recharts-tooltip-label",T);B&&M&&g!==void 0&&g!==null&&(U=M(N,g));var re=C?{role:"status","aria-live":"assertive"}:{};return je.createElement("div",s4({className:te,style:L},re),je.createElement("p",{className:Q,style:F},je.isValidElement(U)?U:"".concat(U)),D())};function Ib(t){"@babel/helpers - typeof";return Ib=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ib(t)}function hN(t,r,s){return r=jPe(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function jPe(t){var r=bPe(t,"string");return Ib(r)=="symbol"?r:r+""}function bPe(t,r){if(Ib(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Ib(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var f0="recharts-tooltip-wrapper",_Pe={visibility:"hidden"};function wPe(t){var r=t.coordinate,s=t.translateX,n=t.translateY;return rs(f0,hN(hN(hN(hN({},"".concat(f0,"-right"),cr(s)&&r&&cr(r.x)&&s>=r.x),"".concat(f0,"-left"),cr(s)&&r&&cr(r.x)&&s<r.x),"".concat(f0,"-bottom"),cr(n)&&r&&cr(r.y)&&n>=r.y),"".concat(f0,"-top"),cr(n)&&r&&cr(r.y)&&n<r.y))}function Cz(t){var r=t.allowEscapeViewBox,s=t.coordinate,n=t.key,a=t.offsetTopLeft,o=t.position,c=t.reverseDirection,i=t.tooltipDimension,f=t.viewBox,p=t.viewBoxDimension;if(o&&cr(o[n]))return o[n];var g=s[n]-i-a,y=s[n]+a;if(r[n])return c[n]?g:y;if(c[n]){var b=g,w=f[n];return b<w?Math.max(y,f[n]):Math.max(g,f[n])}var T=y+i,N=f[n]+p;return T>N?Math.max(g,f[n]):Math.max(y,f[n])}function NPe(t){var r=t.translateX,s=t.translateY,n=t.useTranslate3d;return{transform:n?"translate3d(".concat(r,"px, ").concat(s,"px, 0)"):"translate(".concat(r,"px, ").concat(s,"px)")}}function SPe(t){var r=t.allowEscapeViewBox,s=t.coordinate,n=t.offsetTopLeft,a=t.position,o=t.reverseDirection,c=t.tooltipBox,i=t.useTranslate3d,f=t.viewBox,p,g,y;return c.height>0&&c.width>0&&s?(g=Cz({allowEscapeViewBox:r,coordinate:s,key:"x",offsetTopLeft:n,position:a,reverseDirection:o,tooltipDimension:c.width,viewBox:f,viewBoxDimension:f.width}),y=Cz({allowEscapeViewBox:r,coordinate:s,key:"y",offsetTopLeft:n,position:a,reverseDirection:o,tooltipDimension:c.height,viewBox:f,viewBoxDimension:f.height}),p=NPe({translateX:g,translateY:y,useTranslate3d:i})):p=_Pe,{cssProperties:p,cssClasses:wPe({translateX:g,translateY:y,coordinate:s})}}function Ey(t){"@babel/helpers - typeof";return Ey=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ey(t)}function Pz(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function kz(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?Pz(Object(s),!0).forEach(function(n){a4(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Pz(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function CPe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function PPe(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,QH(n.key),n)}}function kPe(t,r,s){return r&&PPe(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function APe(t,r,s){return r=n2(r),TPe(t,XH()?Reflect.construct(r,s||[],n2(t).constructor):r.apply(t,s))}function TPe(t,r){if(r&&(Ey(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return EPe(t)}function EPe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function XH(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(XH=function(){return!!t})()}function n2(t){return n2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},n2(t)}function MPe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&n4(t,r)}function n4(t,r){return n4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},n4(t,r)}function a4(t,r,s){return r=QH(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function QH(t){var r=OPe(t,"string");return Ey(r)=="symbol"?r:r+""}function OPe(t,r){if(Ey(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Ey(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Az=1,IPe=function(t){function r(){var s;CPe(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return s=APe(this,r,[].concat(a)),a4(s,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),a4(s,"handleKeyDown",function(c){if(c.key==="Escape"){var i,f,p,g;s.setState({dismissed:!0,dismissedAtCoordinate:{x:(i=(f=s.props.coordinate)===null||f===void 0?void 0:f.x)!==null&&i!==void 0?i:0,y:(p=(g=s.props.coordinate)===null||g===void 0?void 0:g.y)!==null&&p!==void 0?p:0}})}}),s}return MPe(r,t),kPe(r,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>Az||Math.abs(n.height-this.state.lastBoundingBox.height)>Az)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,o=a.active,c=a.allowEscapeViewBox,i=a.animationDuration,f=a.animationEasing,p=a.children,g=a.coordinate,y=a.hasPayload,b=a.isAnimationActive,w=a.offset,T=a.position,N=a.reverseDirection,M=a.useTranslate3d,O=a.viewBox,C=a.wrapperStyle,D=SPe({allowEscapeViewBox:c,coordinate:g,offsetTopLeft:w,position:T,reverseDirection:N,tooltipBox:this.state.lastBoundingBox,useTranslate3d:M,viewBox:O}),L=D.cssClasses,F=D.cssProperties,B=kz(kz({transition:b&&o?"transform ".concat(i,"ms ").concat(f):void 0},F),{},{pointerEvents:"none",visibility:!this.state.dismissed&&o&&y?"visible":"hidden",position:"absolute",top:0,left:0},C);return je.createElement("div",{tabIndex:-1,className:L,style:B,ref:function(te){n.wrapperNode=te}},p)}}])}(A.PureComponent),DPe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Ju={isSsr:DPe()};function My(t){"@babel/helpers - typeof";return My=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},My(t)}function Tz(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function Ez(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?Tz(Object(s),!0).forEach(function(n){RD(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Tz(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function RPe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function LPe(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,eZ(n.key),n)}}function FPe(t,r,s){return r&&LPe(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function $Pe(t,r,s){return r=a2(r),zPe(t,JH()?Reflect.construct(r,s||[],a2(t).constructor):r.apply(t,s))}function zPe(t,r){if(r&&(My(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BPe(t)}function BPe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function JH(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(JH=function(){return!!t})()}function a2(t){return a2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},a2(t)}function qPe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&i4(t,r)}function i4(t,r){return i4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},i4(t,r)}function RD(t,r,s){return r=eZ(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function eZ(t){var r=VPe(t,"string");return My(r)=="symbol"?r:r+""}function VPe(t,r){if(My(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(My(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function UPe(t){return t.dataKey}function WPe(t,r){return je.isValidElement(t)?je.cloneElement(t,r):typeof t=="function"?je.createElement(t,r):je.createElement(vPe,r)}var _n=function(t){function r(){return RPe(this,r),$Pe(this,r,arguments)}return qPe(r,t),FPe(r,[{key:"render",value:function(){var n=this,a=this.props,o=a.active,c=a.allowEscapeViewBox,i=a.animationDuration,f=a.animationEasing,p=a.content,g=a.coordinate,y=a.filterNull,b=a.isAnimationActive,w=a.offset,T=a.payload,N=a.payloadUniqBy,M=a.position,O=a.reverseDirection,C=a.useTranslate3d,D=a.viewBox,L=a.wrapperStyle,F=T??[];y&&F.length&&(F=VH(T.filter(function(U){return U.value!=null&&(U.hide!==!0||n.props.includeHidden)}),N,UPe));var B=F.length>0;return je.createElement(IPe,{allowEscapeViewBox:c,animationDuration:i,animationEasing:f,isAnimationActive:b,active:o,coordinate:g,hasPayload:B,offset:w,position:M,reverseDirection:O,useTranslate3d:C,viewBox:D,wrapperStyle:L},WPe(p,Ez(Ez({},this.props),{},{payload:F})))}}])}(A.PureComponent);RD(_n,"displayName","Tooltip");RD(_n,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Ju.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var GPe=$d,KPe=function(){return GPe.Date.now()},HPe=KPe,ZPe=/\s/;function YPe(t){for(var r=t.length;r--&&ZPe.test(t.charAt(r)););return r}var XPe=YPe,QPe=XPe,JPe=/^\s+/;function eke(t){return t&&t.slice(0,QPe(t)+1).replace(JPe,"")}var tke=eke,rke=tke,Mz=Vm,ske=bv,Oz=NaN,nke=/^[-+]0x[0-9a-f]+$/i,ake=/^0b[01]+$/i,ike=/^0o[0-7]+$/i,oke=parseInt;function lke(t){if(typeof t=="number")return t;if(ske(t))return Oz;if(Mz(t)){var r=typeof t.valueOf=="function"?t.valueOf():t;t=Mz(r)?r+"":r}if(typeof t!="string")return t===0?t:+t;t=rke(t);var s=ake.test(t);return s||ike.test(t)?oke(t.slice(2),s?2:8):nke.test(t)?Oz:+t}var tZ=lke,cke=Vm,mT=HPe,Iz=tZ,dke="Expected a function",uke=Math.max,hke=Math.min;function mke(t,r,s){var n,a,o,c,i,f,p=0,g=!1,y=!1,b=!0;if(typeof t!="function")throw new TypeError(dke);r=Iz(r)||0,cke(s)&&(g=!!s.leading,y="maxWait"in s,o=y?uke(Iz(s.maxWait)||0,r):o,b="trailing"in s?!!s.trailing:b);function w(B){var U=n,te=a;return n=a=void 0,p=B,c=t.apply(te,U),c}function T(B){return p=B,i=setTimeout(O,r),g?w(B):c}function N(B){var U=B-f,te=B-p,Q=r-U;return y?hke(Q,o-te):Q}function M(B){var U=B-f,te=B-p;return f===void 0||U>=r||U<0||y&&te>=o}function O(){var B=mT();if(M(B))return C(B);i=setTimeout(O,N(B))}function C(B){return i=void 0,b&&n?w(B):(n=a=void 0,c)}function D(){i!==void 0&&clearTimeout(i),p=0,n=f=a=i=void 0}function L(){return i===void 0?c:C(mT())}function F(){var B=mT(),U=M(B);if(n=arguments,a=this,f=B,U){if(i===void 0)return T(f);if(y)return clearTimeout(i),i=setTimeout(O,r),w(f)}return i===void 0&&(i=setTimeout(O,r)),c}return F.cancel=D,F.flush=L,F}var fke=mke,pke=fke,xke=Vm,gke="Expected a function";function yke(t,r,s){var n=!0,a=!0;if(typeof t!="function")throw new TypeError(gke);return xke(s)&&(n="leading"in s?!!s.leading:n,a="trailing"in s?!!s.trailing:a),pke(t,r,{leading:n,maxWait:r,trailing:a})}var vke=yke;const rZ=tn(vke);function Db(t){"@babel/helpers - typeof";return Db=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Db(t)}function Dz(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function mN(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?Dz(Object(s),!0).forEach(function(n){jke(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Dz(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function jke(t,r,s){return r=bke(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function bke(t){var r=_ke(t,"string");return Db(r)=="symbol"?r:r+""}function _ke(t,r){if(Db(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Db(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function wke(t,r){return Pke(t)||Cke(t,r)||Ske(t,r)||Nke()}function Nke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ske(t,r){if(t){if(typeof t=="string")return Rz(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Rz(t,r)}}function Rz(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function Cke(t,r){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var n,a,o,c,i=[],f=!0,p=!1;try{if(o=(s=s.call(t)).next,r!==0)for(;!(f=(n=o.call(s)).done)&&(i.push(n.value),i.length!==r);f=!0);}catch(g){p=!0,a=g}finally{try{if(!f&&s.return!=null&&(c=s.return(),Object(c)!==c))return}finally{if(p)throw a}}return i}}function Pke(t){if(Array.isArray(t))return t}var Ha=A.forwardRef(function(t,r){var s=t.aspect,n=t.initialDimension,a=n===void 0?{width:-1,height:-1}:n,o=t.width,c=o===void 0?"100%":o,i=t.height,f=i===void 0?"100%":i,p=t.minWidth,g=p===void 0?0:p,y=t.minHeight,b=t.maxHeight,w=t.children,T=t.debounce,N=T===void 0?0:T,M=t.id,O=t.className,C=t.onResize,D=t.style,L=D===void 0?{}:D,F=A.useRef(null),B=A.useRef();B.current=C,A.useImperativeHandle(r,function(){return Object.defineProperty(F.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),F.current},configurable:!0})});var U=A.useState({containerWidth:a.width,containerHeight:a.height}),te=wke(U,2),Q=te[0],re=te[1],Z=A.useCallback(function(oe,Ce){re(function(Pe){var Se=Math.round(oe),ae=Math.round(Ce);return Pe.containerWidth===Se&&Pe.containerHeight===ae?Pe:{containerWidth:Se,containerHeight:ae}})},[]);A.useEffect(function(){var oe=function(de){var Ke,He=de[0].contentRect,Ve=He.width,yt=He.height;Z(Ve,yt),(Ke=B.current)===null||Ke===void 0||Ke.call(B,Ve,yt)};N>0&&(oe=rZ(oe,N,{trailing:!0,leading:!1}));var Ce=new ResizeObserver(oe),Pe=F.current.getBoundingClientRect(),Se=Pe.width,ae=Pe.height;return Z(Se,ae),Ce.observe(F.current),function(){Ce.disconnect()}},[Z,N]);var ne=A.useMemo(function(){var oe=Q.containerWidth,Ce=Q.containerHeight;if(oe<0||Ce<0)return null;Uc(Zf(c)||Zf(f),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,c,f),Uc(!s||s>0,"The aspect(%s) must be greater than zero.",s);var Pe=Zf(c)?oe:c,Se=Zf(f)?Ce:f;s&&s>0&&(Pe?Se=Pe/s:Se&&(Pe=Se*s),b&&Se>b&&(Se=b)),Uc(Pe>0||Se>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,Pe,Se,c,f,g,y,s);var ae=!Array.isArray(w)&&Eu(w.type).endsWith("Chart");return je.Children.map(w,function(be){return je.isValidElement(be)?A.cloneElement(be,mN({width:Pe,height:Se},ae?{style:mN({height:"100%",width:"100%",maxHeight:Se,maxWidth:Pe},be.props.style)}:{})):be})},[s,w,f,b,y,g,Q,c]);return je.createElement("div",{id:M?"".concat(M):void 0,className:rs("recharts-responsive-container",O),style:mN(mN({},L),{},{width:c,height:f,minWidth:g,minHeight:y,maxHeight:b}),ref:F},ne)}),Rb=function(r){return null};Rb.displayName="Cell";function Lb(t){"@babel/helpers - typeof";return Lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Lb(t)}function Lz(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function o4(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?Lz(Object(s),!0).forEach(function(n){kke(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Lz(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function kke(t,r,s){return r=Ake(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function Ake(t){var r=Tke(t,"string");return Lb(r)=="symbol"?r:r+""}function Tke(t,r){if(Lb(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Lb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var ng={widthCache:{},cacheCount:0},Eke=2e3,Mke={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Fz="recharts_measurement_span";function Oke(t){var r=o4({},t);return Object.keys(r).forEach(function(s){r[s]||delete r[s]}),r}var G0=function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r==null||Ju.isSsr)return{width:0,height:0};var n=Oke(s),a=JSON.stringify({text:r,copyStyle:n});if(ng.widthCache[a])return ng.widthCache[a];try{var o=document.getElementById(Fz);o||(o=document.createElement("span"),o.setAttribute("id",Fz),o.setAttribute("aria-hidden","true"),document.body.appendChild(o));var c=o4(o4({},Mke),n);Object.assign(o.style,c),o.textContent="".concat(r);var i=o.getBoundingClientRect(),f={width:i.width,height:i.height};return ng.widthCache[a]=f,++ng.cacheCount>Eke&&(ng.cacheCount=0,ng.widthCache={}),f}catch{return{width:0,height:0}}},Ike=function(r){return{top:r.top+window.scrollY-document.documentElement.clientTop,left:r.left+window.scrollX-document.documentElement.clientLeft}};function Fb(t){"@babel/helpers - typeof";return Fb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Fb(t)}function i2(t,r){return Fke(t)||Lke(t,r)||Rke(t,r)||Dke()}function Dke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rke(t,r){if(t){if(typeof t=="string")return $z(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return $z(t,r)}}function $z(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function Lke(t,r){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var n,a,o,c,i=[],f=!0,p=!1;try{if(o=(s=s.call(t)).next,r===0){if(Object(s)!==s)return;f=!1}else for(;!(f=(n=o.call(s)).done)&&(i.push(n.value),i.length!==r);f=!0);}catch(g){p=!0,a=g}finally{try{if(!f&&s.return!=null&&(c=s.return(),Object(c)!==c))return}finally{if(p)throw a}}return i}}function Fke(t){if(Array.isArray(t))return t}function $ke(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function zz(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Bke(n.key),n)}}function zke(t,r,s){return r&&zz(t.prototype,r),s&&zz(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function Bke(t){var r=qke(t,"string");return Fb(r)=="symbol"?r:r+""}function qke(t,r){if(Fb(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Fb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Bz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,qz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Vke=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Uke=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,sZ={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Wke=Object.keys(sZ),Sg="NaN";function Gke(t,r){return t*sZ[r]}var fN=function(){function t(r,s){$ke(this,t),this.num=r,this.unit=s,this.num=r,this.unit=s,Number.isNaN(r)&&(this.unit=""),s!==""&&!Vke.test(s)&&(this.num=NaN,this.unit=""),Wke.includes(s)&&(this.num=Gke(r,s),this.unit="px")}return zke(t,[{key:"add",value:function(s){return this.unit!==s.unit?new t(NaN,""):new t(this.num+s.num,this.unit)}},{key:"subtract",value:function(s){return this.unit!==s.unit?new t(NaN,""):new t(this.num-s.num,this.unit)}},{key:"multiply",value:function(s){return this.unit!==""&&s.unit!==""&&this.unit!==s.unit?new t(NaN,""):new t(this.num*s.num,this.unit||s.unit)}},{key:"divide",value:function(s){return this.unit!==""&&s.unit!==""&&this.unit!==s.unit?new t(NaN,""):new t(this.num/s.num,this.unit||s.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(s){var n,a=(n=Uke.exec(s))!==null&&n!==void 0?n:[],o=i2(a,3),c=o[1],i=o[2];return new t(parseFloat(c),i??"")}}])}();function nZ(t){if(t.includes(Sg))return Sg;for(var r=t;r.includes("*")||r.includes("/");){var s,n=(s=Bz.exec(r))!==null&&s!==void 0?s:[],a=i2(n,4),o=a[1],c=a[2],i=a[3],f=fN.parse(o??""),p=fN.parse(i??""),g=c==="*"?f.multiply(p):f.divide(p);if(g.isNaN())return Sg;r=r.replace(Bz,g.toString())}for(;r.includes("+")||/.-\d+(?:\.\d+)?/.test(r);){var y,b=(y=qz.exec(r))!==null&&y!==void 0?y:[],w=i2(b,4),T=w[1],N=w[2],M=w[3],O=fN.parse(T??""),C=fN.parse(M??""),D=N==="+"?O.add(C):O.subtract(C);if(D.isNaN())return Sg;r=r.replace(qz,D.toString())}return r}var Vz=/\(([^()]*)\)/;function Kke(t){for(var r=t;r.includes("(");){var s=Vz.exec(r),n=i2(s,2),a=n[1];r=r.replace(Vz,nZ(a))}return r}function Hke(t){var r=t.replace(/\s+/g,"");return r=Kke(r),r=nZ(r),r}function Zke(t){try{return Hke(t)}catch{return Sg}}function fT(t){var r=Zke(t.slice(5,-1));return r===Sg?"":r}var Yke=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Xke=["dx","dy","angle","className","breakAll"];function l4(){return l4=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},l4.apply(this,arguments)}function Uz(t,r){if(t==null)return{};var s=Qke(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function Qke(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function Wz(t,r){return rAe(t)||tAe(t,r)||eAe(t,r)||Jke()}function Jke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eAe(t,r){if(t){if(typeof t=="string")return Gz(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Gz(t,r)}}function Gz(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function tAe(t,r){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var n,a,o,c,i=[],f=!0,p=!1;try{if(o=(s=s.call(t)).next,r===0){if(Object(s)!==s)return;f=!1}else for(;!(f=(n=o.call(s)).done)&&(i.push(n.value),i.length!==r);f=!0);}catch(g){p=!0,a=g}finally{try{if(!f&&s.return!=null&&(c=s.return(),Object(c)!==c))return}finally{if(p)throw a}}return i}}function rAe(t){if(Array.isArray(t))return t}var aZ=/[ \f\n\r\t\v\u2028\u2029]+/,iZ=function(r){var s=r.children,n=r.breakAll,a=r.style;try{var o=[];ts(s)||(n?o=s.toString().split(""):o=s.toString().split(aZ));var c=o.map(function(f){return{word:f,width:G0(f,a).width}}),i=n?0:G0("",a).width;return{wordsWithComputedWidth:c,spaceWidth:i}}catch{return null}},sAe=function(r,s,n,a,o){var c=r.maxLines,i=r.children,f=r.style,p=r.breakAll,g=cr(c),y=i,b=function(){var Pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Pe.reduce(function(Se,ae){var be=ae.word,de=ae.width,Ke=Se[Se.length-1];if(Ke&&(a==null||o||Ke.width+de+n<Number(a)))Ke.words.push(be),Ke.width+=de+n;else{var He={words:[be],width:de};Se.push(He)}return Se},[])},w=b(s),T=function(Pe){return Pe.reduce(function(Se,ae){return Se.width>ae.width?Se:ae})};if(!g)return w;for(var N="",M=function(Pe){var Se=y.slice(0,Pe),ae=iZ({breakAll:p,style:f,children:Se+N}).wordsWithComputedWidth,be=b(ae),de=be.length>c||T(be).width>Number(a);return[de,be]},O=0,C=y.length-1,D=0,L;O<=C&&D<=y.length-1;){var F=Math.floor((O+C)/2),B=F-1,U=M(B),te=Wz(U,2),Q=te[0],re=te[1],Z=M(F),ne=Wz(Z,1),oe=ne[0];if(!Q&&!oe&&(O=F+1),Q&&oe&&(C=F-1),!Q&&oe){L=re;break}D++}return L||w},Kz=function(r){var s=ts(r)?[]:r.toString().split(aZ);return[{words:s}]},nAe=function(r){var s=r.width,n=r.scaleToFit,a=r.children,o=r.style,c=r.breakAll,i=r.maxLines;if((s||n)&&!Ju.isSsr){var f,p,g=iZ({breakAll:c,children:a,style:o});if(g){var y=g.wordsWithComputedWidth,b=g.spaceWidth;f=y,p=b}else return Kz(a);return sAe({breakAll:c,children:a,maxLines:i,style:o},f,p,s,n)}return Kz(a)},Hz="#808080",Ep=function(r){var s=r.x,n=s===void 0?0:s,a=r.y,o=a===void 0?0:a,c=r.lineHeight,i=c===void 0?"1em":c,f=r.capHeight,p=f===void 0?"0.71em":f,g=r.scaleToFit,y=g===void 0?!1:g,b=r.textAnchor,w=b===void 0?"start":b,T=r.verticalAnchor,N=T===void 0?"end":T,M=r.fill,O=M===void 0?Hz:M,C=Uz(r,Yke),D=A.useMemo(function(){return nAe({breakAll:C.breakAll,children:C.children,maxLines:C.maxLines,scaleToFit:y,style:C.style,width:C.width})},[C.breakAll,C.children,C.maxLines,y,C.style,C.width]),L=C.dx,F=C.dy,B=C.angle,U=C.className,te=C.breakAll,Q=Uz(C,Xke);if(!di(n)||!di(o))return null;var re=n+(cr(L)?L:0),Z=o+(cr(F)?F:0),ne;switch(N){case"start":ne=fT("calc(".concat(p,")"));break;case"middle":ne=fT("calc(".concat((D.length-1)/2," * -").concat(i," + (").concat(p," / 2))"));break;default:ne=fT("calc(".concat(D.length-1," * -").concat(i,")"));break}var oe=[];if(y){var Ce=D[0].width,Pe=C.width;oe.push("scale(".concat((cr(Pe)?Pe/Ce:1)/Ce,")"))}return B&&oe.push("rotate(".concat(B,", ").concat(re,", ").concat(Z,")")),oe.length&&(Q.transform=oe.join(" ")),je.createElement("text",l4({},Or(Q,!0),{x:re,y:Z,className:rs("recharts-text",U),textAnchor:w,fill:O.includes("url")?Hz:O}),D.map(function(Se,ae){var be=Se.words.join(te?"":" ");return je.createElement("tspan",{x:re,dy:ae===0?ne:i,key:"".concat(be,"-").concat(ae)},be)}))};function ym(t,r){return t==null||r==null?NaN:t<r?-1:t>r?1:t>=r?0:NaN}function aAe(t,r){return t==null||r==null?NaN:r<t?-1:r>t?1:r>=t?0:NaN}function LD(t){let r,s,n;t.length!==2?(r=ym,s=(i,f)=>ym(t(i),f),n=(i,f)=>t(i)-f):(r=t===ym||t===aAe?t:iAe,s=t,n=t);function a(i,f,p=0,g=i.length){if(p<g){if(r(f,f)!==0)return g;do{const y=p+g>>>1;s(i[y],f)<0?p=y+1:g=y}while(p<g)}return p}function o(i,f,p=0,g=i.length){if(p<g){if(r(f,f)!==0)return g;do{const y=p+g>>>1;s(i[y],f)<=0?p=y+1:g=y}while(p<g)}return p}function c(i,f,p=0,g=i.length){const y=a(i,f,p,g-1);return y>p&&n(i[y-1],f)>-n(i[y],f)?y-1:y}return{left:a,center:c,right:o}}function iAe(){return 0}function oZ(t){return t===null?NaN:+t}function*oAe(t,r){for(let s of t)s!=null&&(s=+s)>=s&&(yield s)}const lAe=LD(ym),X_=lAe.right;LD(oZ).center;class Zz extends Map{constructor(r,s=uAe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:s}}),r!=null)for(const[n,a]of r)this.set(n,a)}get(r){return super.get(Yz(this,r))}has(r){return super.has(Yz(this,r))}set(r,s){return super.set(cAe(this,r),s)}delete(r){return super.delete(dAe(this,r))}}function Yz({_intern:t,_key:r},s){const n=r(s);return t.has(n)?t.get(n):s}function cAe({_intern:t,_key:r},s){const n=r(s);return t.has(n)?t.get(n):(t.set(n,s),s)}function dAe({_intern:t,_key:r},s){const n=r(s);return t.has(n)&&(s=t.get(n),t.delete(n)),s}function uAe(t){return t!==null&&typeof t=="object"?t.valueOf():t}function hAe(t=ym){if(t===ym)return lZ;if(typeof t!="function")throw new TypeError("compare is not a function");return(r,s)=>{const n=t(r,s);return n||n===0?n:(t(s,s)===0)-(t(r,r)===0)}}function lZ(t,r){return(t==null||!(t>=t))-(r==null||!(r>=r))||(t<r?-1:t>r?1:0)}const mAe=Math.sqrt(50),fAe=Math.sqrt(10),pAe=Math.sqrt(2);function o2(t,r,s){const n=(r-t)/Math.max(0,s),a=Math.floor(Math.log10(n)),o=n/Math.pow(10,a),c=o>=mAe?10:o>=fAe?5:o>=pAe?2:1;let i,f,p;return a<0?(p=Math.pow(10,-a)/c,i=Math.round(t*p),f=Math.round(r*p),i/p<t&&++i,f/p>r&&--f,p=-p):(p=Math.pow(10,a)*c,i=Math.round(t/p),f=Math.round(r/p),i*p<t&&++i,f*p>r&&--f),f<i&&.5<=s&&s<2?o2(t,r,s*2):[i,f,p]}function c4(t,r,s){if(r=+r,t=+t,s=+s,!(s>0))return[];if(t===r)return[t];const n=r<t,[a,o,c]=n?o2(r,t,s):o2(t,r,s);if(!(o>=a))return[];const i=o-a+1,f=new Array(i);if(n)if(c<0)for(let p=0;p<i;++p)f[p]=(o-p)/-c;else for(let p=0;p<i;++p)f[p]=(o-p)*c;else if(c<0)for(let p=0;p<i;++p)f[p]=(a+p)/-c;else for(let p=0;p<i;++p)f[p]=(a+p)*c;return f}function d4(t,r,s){return r=+r,t=+t,s=+s,o2(t,r,s)[2]}function u4(t,r,s){r=+r,t=+t,s=+s;const n=r<t,a=n?d4(r,t,s):d4(t,r,s);return(n?-1:1)*(a<0?1/-a:a)}function Xz(t,r){let s;for(const n of t)n!=null&&(s<n||s===void 0&&n>=n)&&(s=n);return s}function Qz(t,r){let s;for(const n of t)n!=null&&(s>n||s===void 0&&n>=n)&&(s=n);return s}function cZ(t,r,s=0,n=1/0,a){if(r=Math.floor(r),s=Math.floor(Math.max(0,s)),n=Math.floor(Math.min(t.length-1,n)),!(s<=r&&r<=n))return t;for(a=a===void 0?lZ:hAe(a);n>s;){if(n-s>600){const f=n-s+1,p=r-s+1,g=Math.log(f),y=.5*Math.exp(2*g/3),b=.5*Math.sqrt(g*y*(f-y)/f)*(p-f/2<0?-1:1),w=Math.max(s,Math.floor(r-p*y/f+b)),T=Math.min(n,Math.floor(r+(f-p)*y/f+b));cZ(t,r,w,T,a)}const o=t[r];let c=s,i=n;for(p0(t,s,r),a(t[n],o)>0&&p0(t,s,n);c<i;){for(p0(t,c,i),++c,--i;a(t[c],o)<0;)++c;for(;a(t[i],o)>0;)--i}a(t[s],o)===0?p0(t,s,i):(++i,p0(t,i,n)),i<=r&&(s=i+1),r<=i&&(n=i-1)}return t}function p0(t,r,s){const n=t[r];t[r]=t[s],t[s]=n}function xAe(t,r,s){if(t=Float64Array.from(oAe(t)),!(!(n=t.length)||isNaN(r=+r))){if(r<=0||n<2)return Qz(t);if(r>=1)return Xz(t);var n,a=(n-1)*r,o=Math.floor(a),c=Xz(cZ(t,o).subarray(0,o+1)),i=Qz(t.subarray(o+1));return c+(i-c)*(a-o)}}function gAe(t,r,s=oZ){if(!(!(n=t.length)||isNaN(r=+r))){if(r<=0||n<2)return+s(t[0],0,t);if(r>=1)return+s(t[n-1],n-1,t);var n,a=(n-1)*r,o=Math.floor(a),c=+s(t[o],o,t),i=+s(t[o+1],o+1,t);return c+(i-c)*(a-o)}}function yAe(t,r,s){t=+t,r=+r,s=(a=arguments.length)<2?(r=t,t=0,1):a<3?1:+s;for(var n=-1,a=Math.max(0,Math.ceil((r-t)/s))|0,o=new Array(a);++n<a;)o[n]=t+n*s;return o}function ac(t,r){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(r).domain(t);break}return this}function eh(t,r){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof r=="function"?this.interpolator(r):this.range(r);break}}return this}const h4=Symbol("implicit");function FD(){var t=new Zz,r=[],s=[],n=h4;function a(o){let c=t.get(o);if(c===void 0){if(n!==h4)return n;t.set(o,c=r.push(o)-1)}return s[c%s.length]}return a.domain=function(o){if(!arguments.length)return r.slice();r=[],t=new Zz;for(const c of o)t.has(c)||t.set(c,r.push(c)-1);return a},a.range=function(o){return arguments.length?(s=Array.from(o),a):s.slice()},a.unknown=function(o){return arguments.length?(n=o,a):n},a.copy=function(){return FD(r,s).unknown(n)},ac.apply(a,arguments),a}function $b(){var t=FD().unknown(void 0),r=t.domain,s=t.range,n=0,a=1,o,c,i=!1,f=0,p=0,g=.5;delete t.unknown;function y(){var b=r().length,w=a<n,T=w?a:n,N=w?n:a;o=(N-T)/Math.max(1,b-f+p*2),i&&(o=Math.floor(o)),T+=(N-T-o*(b-f))*g,c=o*(1-f),i&&(T=Math.round(T),c=Math.round(c));var M=yAe(b).map(function(O){return T+o*O});return s(w?M.reverse():M)}return t.domain=function(b){return arguments.length?(r(b),y()):r()},t.range=function(b){return arguments.length?([n,a]=b,n=+n,a=+a,y()):[n,a]},t.rangeRound=function(b){return[n,a]=b,n=+n,a=+a,i=!0,y()},t.bandwidth=function(){return c},t.step=function(){return o},t.round=function(b){return arguments.length?(i=!!b,y()):i},t.padding=function(b){return arguments.length?(f=Math.min(1,p=+b),y()):f},t.paddingInner=function(b){return arguments.length?(f=Math.min(1,b),y()):f},t.paddingOuter=function(b){return arguments.length?(p=+b,y()):p},t.align=function(b){return arguments.length?(g=Math.max(0,Math.min(1,b)),y()):g},t.copy=function(){return $b(r(),[n,a]).round(i).paddingInner(f).paddingOuter(p).align(g)},ac.apply(y(),arguments)}function dZ(t){var r=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return dZ(r())},t}function K0(){return dZ($b.apply(null,arguments).paddingInner(1))}function $D(t,r,s){t.prototype=r.prototype=s,s.constructor=t}function uZ(t,r){var s=Object.create(t.prototype);for(var n in r)s[n]=r[n];return s}function Q_(){}var zb=.7,l2=1/zb,Ug="\\s*([+-]?\\d+)\\s*",Bb="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Pd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vAe=/^#([0-9a-f]{3,8})$/,jAe=new RegExp(`^rgb\\(${Ug},${Ug},${Ug}\\)$`),bAe=new RegExp(`^rgb\\(${Pd},${Pd},${Pd}\\)$`),_Ae=new RegExp(`^rgba\\(${Ug},${Ug},${Ug},${Bb}\\)$`),wAe=new RegExp(`^rgba\\(${Pd},${Pd},${Pd},${Bb}\\)$`),NAe=new RegExp(`^hsl\\(${Bb},${Pd},${Pd}\\)$`),SAe=new RegExp(`^hsla\\(${Bb},${Pd},${Pd},${Bb}\\)$`),Jz={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};$D(Q_,qb,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:e6,formatHex:e6,formatHex8:CAe,formatHsl:PAe,formatRgb:t6,toString:t6});function e6(){return this.rgb().formatHex()}function CAe(){return this.rgb().formatHex8()}function PAe(){return hZ(this).formatHsl()}function t6(){return this.rgb().formatRgb()}function qb(t){var r,s;return t=(t+"").trim().toLowerCase(),(r=vAe.exec(t))?(s=r[1].length,r=parseInt(r[1],16),s===6?r6(r):s===3?new Vo(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):s===8?pN(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):s===4?pN(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=jAe.exec(t))?new Vo(r[1],r[2],r[3],1):(r=bAe.exec(t))?new Vo(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=_Ae.exec(t))?pN(r[1],r[2],r[3],r[4]):(r=wAe.exec(t))?pN(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=NAe.exec(t))?a6(r[1],r[2]/100,r[3]/100,1):(r=SAe.exec(t))?a6(r[1],r[2]/100,r[3]/100,r[4]):Jz.hasOwnProperty(t)?r6(Jz[t]):t==="transparent"?new Vo(NaN,NaN,NaN,0):null}function r6(t){return new Vo(t>>16&255,t>>8&255,t&255,1)}function pN(t,r,s,n){return n<=0&&(t=r=s=NaN),new Vo(t,r,s,n)}function kAe(t){return t instanceof Q_||(t=qb(t)),t?(t=t.rgb(),new Vo(t.r,t.g,t.b,t.opacity)):new Vo}function m4(t,r,s,n){return arguments.length===1?kAe(t):new Vo(t,r,s,n??1)}function Vo(t,r,s,n){this.r=+t,this.g=+r,this.b=+s,this.opacity=+n}$D(Vo,m4,uZ(Q_,{brighter(t){return t=t==null?l2:Math.pow(l2,t),new Vo(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?zb:Math.pow(zb,t),new Vo(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Vo(dp(this.r),dp(this.g),dp(this.b),c2(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:s6,formatHex:s6,formatHex8:AAe,formatRgb:n6,toString:n6}));function s6(){return`#${Yf(this.r)}${Yf(this.g)}${Yf(this.b)}`}function AAe(){return`#${Yf(this.r)}${Yf(this.g)}${Yf(this.b)}${Yf((isNaN(this.opacity)?1:this.opacity)*255)}`}function n6(){const t=c2(this.opacity);return`${t===1?"rgb(":"rgba("}${dp(this.r)}, ${dp(this.g)}, ${dp(this.b)}${t===1?")":`, ${t})`}`}function c2(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function dp(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Yf(t){return t=dp(t),(t<16?"0":"")+t.toString(16)}function a6(t,r,s,n){return n<=0?t=r=s=NaN:s<=0||s>=1?t=r=NaN:r<=0&&(t=NaN),new $c(t,r,s,n)}function hZ(t){if(t instanceof $c)return new $c(t.h,t.s,t.l,t.opacity);if(t instanceof Q_||(t=qb(t)),!t)return new $c;if(t instanceof $c)return t;t=t.rgb();var r=t.r/255,s=t.g/255,n=t.b/255,a=Math.min(r,s,n),o=Math.max(r,s,n),c=NaN,i=o-a,f=(o+a)/2;return i?(r===o?c=(s-n)/i+(s<n)*6:s===o?c=(n-r)/i+2:c=(r-s)/i+4,i/=f<.5?o+a:2-o-a,c*=60):i=f>0&&f<1?0:c,new $c(c,i,f,t.opacity)}function TAe(t,r,s,n){return arguments.length===1?hZ(t):new $c(t,r,s,n??1)}function $c(t,r,s,n){this.h=+t,this.s=+r,this.l=+s,this.opacity=+n}$D($c,TAe,uZ(Q_,{brighter(t){return t=t==null?l2:Math.pow(l2,t),new $c(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?zb:Math.pow(zb,t),new $c(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,r=isNaN(t)||isNaN(this.s)?0:this.s,s=this.l,n=s+(s<.5?s:1-s)*r,a=2*s-n;return new Vo(pT(t>=240?t-240:t+120,a,n),pT(t,a,n),pT(t<120?t+240:t-120,a,n),this.opacity)},clamp(){return new $c(i6(this.h),xN(this.s),xN(this.l),c2(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=c2(this.opacity);return`${t===1?"hsl(":"hsla("}${i6(this.h)}, ${xN(this.s)*100}%, ${xN(this.l)*100}%${t===1?")":`, ${t})`}`}}));function i6(t){return t=(t||0)%360,t<0?t+360:t}function xN(t){return Math.max(0,Math.min(1,t||0))}function pT(t,r,s){return(t<60?r+(s-r)*t/60:t<180?s:t<240?r+(s-r)*(240-t)/60:r)*255}const zD=t=>()=>t;function EAe(t,r){return function(s){return t+s*r}}function MAe(t,r,s){return t=Math.pow(t,s),r=Math.pow(r,s)-t,s=1/s,function(n){return Math.pow(t+n*r,s)}}function OAe(t){return(t=+t)==1?mZ:function(r,s){return s-r?MAe(r,s,t):zD(isNaN(r)?s:r)}}function mZ(t,r){var s=r-t;return s?EAe(t,s):zD(isNaN(t)?r:t)}const o6=function t(r){var s=OAe(r);function n(a,o){var c=s((a=m4(a)).r,(o=m4(o)).r),i=s(a.g,o.g),f=s(a.b,o.b),p=mZ(a.opacity,o.opacity);return function(g){return a.r=c(g),a.g=i(g),a.b=f(g),a.opacity=p(g),a+""}}return n.gamma=t,n}(1);function IAe(t,r){r||(r=[]);var s=t?Math.min(r.length,t.length):0,n=r.slice(),a;return function(o){for(a=0;a<s;++a)n[a]=t[a]*(1-o)+r[a]*o;return n}}function DAe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function RAe(t,r){var s=r?r.length:0,n=t?Math.min(s,t.length):0,a=new Array(n),o=new Array(s),c;for(c=0;c<n;++c)a[c]=Tv(t[c],r[c]);for(;c<s;++c)o[c]=r[c];return function(i){for(c=0;c<n;++c)o[c]=a[c](i);return o}}function LAe(t,r){var s=new Date;return t=+t,r=+r,function(n){return s.setTime(t*(1-n)+r*n),s}}function d2(t,r){return t=+t,r=+r,function(s){return t*(1-s)+r*s}}function FAe(t,r){var s={},n={},a;(t===null||typeof t!="object")&&(t={}),(r===null||typeof r!="object")&&(r={});for(a in r)a in t?s[a]=Tv(t[a],r[a]):n[a]=r[a];return function(o){for(a in s)n[a]=s[a](o);return n}}var f4=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xT=new RegExp(f4.source,"g");function $Ae(t){return function(){return t}}function zAe(t){return function(r){return t(r)+""}}function BAe(t,r){var s=f4.lastIndex=xT.lastIndex=0,n,a,o,c=-1,i=[],f=[];for(t=t+"",r=r+"";(n=f4.exec(t))&&(a=xT.exec(r));)(o=a.index)>s&&(o=r.slice(s,o),i[c]?i[c]+=o:i[++c]=o),(n=n[0])===(a=a[0])?i[c]?i[c]+=a:i[++c]=a:(i[++c]=null,f.push({i:c,x:d2(n,a)})),s=xT.lastIndex;return s<r.length&&(o=r.slice(s),i[c]?i[c]+=o:i[++c]=o),i.length<2?f[0]?zAe(f[0].x):$Ae(r):(r=f.length,function(p){for(var g=0,y;g<r;++g)i[(y=f[g]).i]=y.x(p);return i.join("")})}function Tv(t,r){var s=typeof r,n;return r==null||s==="boolean"?zD(r):(s==="number"?d2:s==="string"?(n=qb(r))?(r=n,o6):BAe:r instanceof qb?o6:r instanceof Date?LAe:DAe(r)?IAe:Array.isArray(r)?RAe:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?FAe:d2)(t,r)}function BD(t,r){return t=+t,r=+r,function(s){return Math.round(t*(1-s)+r*s)}}function qAe(t,r){r===void 0&&(r=t,t=Tv);for(var s=0,n=r.length-1,a=r[0],o=new Array(n<0?0:n);s<n;)o[s]=t(a,a=r[++s]);return function(c){var i=Math.max(0,Math.min(n-1,Math.floor(c*=n)));return o[i](c-i)}}function VAe(t){return function(){return t}}function u2(t){return+t}var l6=[0,1];function So(t){return t}function p4(t,r){return(r-=t=+t)?function(s){return(s-t)/r}:VAe(isNaN(r)?NaN:.5)}function UAe(t,r){var s;return t>r&&(s=t,t=r,r=s),function(n){return Math.max(t,Math.min(r,n))}}function WAe(t,r,s){var n=t[0],a=t[1],o=r[0],c=r[1];return a<n?(n=p4(a,n),o=s(c,o)):(n=p4(n,a),o=s(o,c)),function(i){return o(n(i))}}function GAe(t,r,s){var n=Math.min(t.length,r.length)-1,a=new Array(n),o=new Array(n),c=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),r=r.slice().reverse());++c<n;)a[c]=p4(t[c],t[c+1]),o[c]=s(r[c],r[c+1]);return function(i){var f=X_(t,i,1,n)-1;return o[f](a[f](i))}}function J_(t,r){return r.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function yP(){var t=l6,r=l6,s=Tv,n,a,o,c=So,i,f,p;function g(){var b=Math.min(t.length,r.length);return c!==So&&(c=UAe(t[0],t[b-1])),i=b>2?GAe:WAe,f=p=null,y}function y(b){return b==null||isNaN(b=+b)?o:(f||(f=i(t.map(n),r,s)))(n(c(b)))}return y.invert=function(b){return c(a((p||(p=i(r,t.map(n),d2)))(b)))},y.domain=function(b){return arguments.length?(t=Array.from(b,u2),g()):t.slice()},y.range=function(b){return arguments.length?(r=Array.from(b),g()):r.slice()},y.rangeRound=function(b){return r=Array.from(b),s=BD,g()},y.clamp=function(b){return arguments.length?(c=b?!0:So,g()):c!==So},y.interpolate=function(b){return arguments.length?(s=b,g()):s},y.unknown=function(b){return arguments.length?(o=b,y):o},function(b,w){return n=b,a=w,g()}}function qD(){return yP()(So,So)}function KAe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function h2(t,r){if((s=(t=r?t.toExponential(r-1):t.toExponential()).indexOf("e"))<0)return null;var s,n=t.slice(0,s);return[n.length>1?n[0]+n.slice(2):n,+t.slice(s+1)]}function Oy(t){return t=h2(Math.abs(t)),t?t[1]:NaN}function HAe(t,r){return function(s,n){for(var a=s.length,o=[],c=0,i=t[0],f=0;a>0&&i>0&&(f+i+1>n&&(i=Math.max(1,n-f)),o.push(s.substring(a-=i,a+i)),!((f+=i+1)>n));)i=t[c=(c+1)%t.length];return o.reverse().join(r)}}function ZAe(t){return function(r){return r.replace(/[0-9]/g,function(s){return t[+s]})}}var YAe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Vb(t){if(!(r=YAe.exec(t)))throw new Error("invalid format: "+t);var r;return new VD({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}Vb.prototype=VD.prototype;function VD(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}VD.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function XAe(t){e:for(var r=t.length,s=1,n=-1,a;s<r;++s)switch(t[s]){case".":n=a=s;break;case"0":n===0&&(n=s),a=s;break;default:if(!+t[s])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(a+1):t}var fZ;function QAe(t,r){var s=h2(t,r);if(!s)return t+"";var n=s[0],a=s[1],o=a-(fZ=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,c=n.length;return o===c?n:o>c?n+new Array(o-c+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+h2(t,Math.max(0,r+o-1))[0]}function c6(t,r){var s=h2(t,r);if(!s)return t+"";var n=s[0],a=s[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const d6={"%":(t,r)=>(t*100).toFixed(r),b:t=>Math.round(t).toString(2),c:t=>t+"",d:KAe,e:(t,r)=>t.toExponential(r),f:(t,r)=>t.toFixed(r),g:(t,r)=>t.toPrecision(r),o:t=>Math.round(t).toString(8),p:(t,r)=>c6(t*100,r),r:c6,s:QAe,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function u6(t){return t}var h6=Array.prototype.map,m6=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function JAe(t){var r=t.grouping===void 0||t.thousands===void 0?u6:HAe(h6.call(t.grouping,Number),t.thousands+""),s=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?u6:ZAe(h6.call(t.numerals,String)),c=t.percent===void 0?"%":t.percent+"",i=t.minus===void 0?"":t.minus+"",f=t.nan===void 0?"NaN":t.nan+"";function p(y){y=Vb(y);var b=y.fill,w=y.align,T=y.sign,N=y.symbol,M=y.zero,O=y.width,C=y.comma,D=y.precision,L=y.trim,F=y.type;F==="n"?(C=!0,F="g"):d6[F]||(D===void 0&&(D=12),L=!0,F="g"),(M||b==="0"&&w==="=")&&(M=!0,b="0",w="=");var B=N==="$"?s:N==="#"&&/[boxX]/.test(F)?"0"+F.toLowerCase():"",U=N==="$"?n:/[%p]/.test(F)?c:"",te=d6[F],Q=/[defgprs%]/.test(F);D=D===void 0?6:/[gprs]/.test(F)?Math.max(1,Math.min(21,D)):Math.max(0,Math.min(20,D));function re(Z){var ne=B,oe=U,Ce,Pe,Se;if(F==="c")oe=te(Z)+oe,Z="";else{Z=+Z;var ae=Z<0||1/Z<0;if(Z=isNaN(Z)?f:te(Math.abs(Z),D),L&&(Z=XAe(Z)),ae&&+Z==0&&T!=="+"&&(ae=!1),ne=(ae?T==="("?T:i:T==="-"||T==="("?"":T)+ne,oe=(F==="s"?m6[8+fZ/3]:"")+oe+(ae&&T==="("?")":""),Q){for(Ce=-1,Pe=Z.length;++Ce<Pe;)if(Se=Z.charCodeAt(Ce),48>Se||Se>57){oe=(Se===46?a+Z.slice(Ce+1):Z.slice(Ce))+oe,Z=Z.slice(0,Ce);break}}}C&&!M&&(Z=r(Z,1/0));var be=ne.length+Z.length+oe.length,de=be<O?new Array(O-be+1).join(b):"";switch(C&&M&&(Z=r(de+Z,de.length?O-oe.length:1/0),de=""),w){case"<":Z=ne+Z+oe+de;break;case"=":Z=ne+de+Z+oe;break;case"^":Z=de.slice(0,be=de.length>>1)+ne+Z+oe+de.slice(be);break;default:Z=de+ne+Z+oe;break}return o(Z)}return re.toString=function(){return y+""},re}function g(y,b){var w=p((y=Vb(y),y.type="f",y)),T=Math.max(-8,Math.min(8,Math.floor(Oy(b)/3)))*3,N=Math.pow(10,-T),M=m6[8+T/3];return function(O){return w(N*O)+M}}return{format:p,formatPrefix:g}}var gN,UD,pZ;eTe({thousands:",",grouping:[3],currency:["$",""]});function eTe(t){return gN=JAe(t),UD=gN.format,pZ=gN.formatPrefix,gN}function tTe(t){return Math.max(0,-Oy(Math.abs(t)))}function rTe(t,r){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Oy(r)/3)))*3-Oy(Math.abs(t)))}function sTe(t,r){return t=Math.abs(t),r=Math.abs(r)-t,Math.max(0,Oy(r)-Oy(t))+1}function xZ(t,r,s,n){var a=u4(t,r,s),o;switch(n=Vb(n??",f"),n.type){case"s":{var c=Math.max(Math.abs(t),Math.abs(r));return n.precision==null&&!isNaN(o=rTe(a,c))&&(n.precision=o),pZ(n,c)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(o=sTe(a,Math.max(Math.abs(t),Math.abs(r))))&&(n.precision=o-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(o=tTe(a))&&(n.precision=o-(n.type==="%")*2);break}}return UD(n)}function Um(t){var r=t.domain;return t.ticks=function(s){var n=r();return c4(n[0],n[n.length-1],s??10)},t.tickFormat=function(s,n){var a=r();return xZ(a[0],a[a.length-1],s??10,n)},t.nice=function(s){s==null&&(s=10);var n=r(),a=0,o=n.length-1,c=n[a],i=n[o],f,p,g=10;for(i<c&&(p=c,c=i,i=p,p=a,a=o,o=p);g-- >0;){if(p=d4(c,i,s),p===f)return n[a]=c,n[o]=i,r(n);if(p>0)c=Math.floor(c/p)*p,i=Math.ceil(i/p)*p;else if(p<0)c=Math.ceil(c*p)/p,i=Math.floor(i*p)/p;else break;f=p}return t},t}function m2(){var t=qD();return t.copy=function(){return J_(t,m2())},ac.apply(t,arguments),Um(t)}function gZ(t){var r;function s(n){return n==null||isNaN(n=+n)?r:n}return s.invert=s,s.domain=s.range=function(n){return arguments.length?(t=Array.from(n,u2),s):t.slice()},s.unknown=function(n){return arguments.length?(r=n,s):r},s.copy=function(){return gZ(t).unknown(r)},t=arguments.length?Array.from(t,u2):[0,1],Um(s)}function yZ(t,r){t=t.slice();var s=0,n=t.length-1,a=t[s],o=t[n],c;return o<a&&(c=s,s=n,n=c,c=a,a=o,o=c),t[s]=r.floor(a),t[n]=r.ceil(o),t}function f6(t){return Math.log(t)}function p6(t){return Math.exp(t)}function nTe(t){return-Math.log(-t)}function aTe(t){return-Math.exp(-t)}function iTe(t){return isFinite(t)?+("1e"+t):t<0?0:t}function oTe(t){return t===10?iTe:t===Math.E?Math.exp:r=>Math.pow(t,r)}function lTe(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),r=>Math.log(r)/t)}function x6(t){return(r,s)=>-t(-r,s)}function WD(t){const r=t(f6,p6),s=r.domain;let n=10,a,o;function c(){return a=lTe(n),o=oTe(n),s()[0]<0?(a=x6(a),o=x6(o),t(nTe,aTe)):t(f6,p6),r}return r.base=function(i){return arguments.length?(n=+i,c()):n},r.domain=function(i){return arguments.length?(s(i),c()):s()},r.ticks=i=>{const f=s();let p=f[0],g=f[f.length-1];const y=g<p;y&&([p,g]=[g,p]);let b=a(p),w=a(g),T,N;const M=i==null?10:+i;let O=[];if(!(n%1)&&w-b<M){if(b=Math.floor(b),w=Math.ceil(w),p>0){for(;b<=w;++b)for(T=1;T<n;++T)if(N=b<0?T/o(-b):T*o(b),!(N<p)){if(N>g)break;O.push(N)}}else for(;b<=w;++b)for(T=n-1;T>=1;--T)if(N=b>0?T/o(-b):T*o(b),!(N<p)){if(N>g)break;O.push(N)}O.length*2<M&&(O=c4(p,g,M))}else O=c4(b,w,Math.min(w-b,M)).map(o);return y?O.reverse():O},r.tickFormat=(i,f)=>{if(i==null&&(i=10),f==null&&(f=n===10?"s":","),typeof f!="function"&&(!(n%1)&&(f=Vb(f)).precision==null&&(f.trim=!0),f=UD(f)),i===1/0)return f;const p=Math.max(1,n*i/r.ticks().length);return g=>{let y=g/o(Math.round(a(g)));return y*n<n-.5&&(y*=n),y<=p?f(g):""}},r.nice=()=>s(yZ(s(),{floor:i=>o(Math.floor(a(i))),ceil:i=>o(Math.ceil(a(i)))})),r}function vZ(){const t=WD(yP()).domain([1,10]);return t.copy=()=>J_(t,vZ()).base(t.base()),ac.apply(t,arguments),t}function g6(t){return function(r){return Math.sign(r)*Math.log1p(Math.abs(r/t))}}function y6(t){return function(r){return Math.sign(r)*Math.expm1(Math.abs(r))*t}}function GD(t){var r=1,s=t(g6(r),y6(r));return s.constant=function(n){return arguments.length?t(g6(r=+n),y6(r)):r},Um(s)}function jZ(){var t=GD(yP());return t.copy=function(){return J_(t,jZ()).constant(t.constant())},ac.apply(t,arguments)}function v6(t){return function(r){return r<0?-Math.pow(-r,t):Math.pow(r,t)}}function cTe(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function dTe(t){return t<0?-t*t:t*t}function KD(t){var r=t(So,So),s=1;function n(){return s===1?t(So,So):s===.5?t(cTe,dTe):t(v6(s),v6(1/s))}return r.exponent=function(a){return arguments.length?(s=+a,n()):s},Um(r)}function HD(){var t=KD(yP());return t.copy=function(){return J_(t,HD()).exponent(t.exponent())},ac.apply(t,arguments),t}function uTe(){return HD.apply(null,arguments).exponent(.5)}function j6(t){return Math.sign(t)*t*t}function hTe(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function bZ(){var t=qD(),r=[0,1],s=!1,n;function a(o){var c=hTe(t(o));return isNaN(c)?n:s?Math.round(c):c}return a.invert=function(o){return t.invert(j6(o))},a.domain=function(o){return arguments.length?(t.domain(o),a):t.domain()},a.range=function(o){return arguments.length?(t.range((r=Array.from(o,u2)).map(j6)),a):r.slice()},a.rangeRound=function(o){return a.range(o).round(!0)},a.round=function(o){return arguments.length?(s=!!o,a):s},a.clamp=function(o){return arguments.length?(t.clamp(o),a):t.clamp()},a.unknown=function(o){return arguments.length?(n=o,a):n},a.copy=function(){return bZ(t.domain(),r).round(s).clamp(t.clamp()).unknown(n)},ac.apply(a,arguments),Um(a)}function _Z(){var t=[],r=[],s=[],n;function a(){var c=0,i=Math.max(1,r.length);for(s=new Array(i-1);++c<i;)s[c-1]=gAe(t,c/i);return o}function o(c){return c==null||isNaN(c=+c)?n:r[X_(s,c)]}return o.invertExtent=function(c){var i=r.indexOf(c);return i<0?[NaN,NaN]:[i>0?s[i-1]:t[0],i<s.length?s[i]:t[t.length-1]]},o.domain=function(c){if(!arguments.length)return t.slice();t=[];for(let i of c)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(ym),a()},o.range=function(c){return arguments.length?(r=Array.from(c),a()):r.slice()},o.unknown=function(c){return arguments.length?(n=c,o):n},o.quantiles=function(){return s.slice()},o.copy=function(){return _Z().domain(t).range(r).unknown(n)},ac.apply(o,arguments)}function wZ(){var t=0,r=1,s=1,n=[.5],a=[0,1],o;function c(f){return f!=null&&f<=f?a[X_(n,f,0,s)]:o}function i(){var f=-1;for(n=new Array(s);++f<s;)n[f]=((f+1)*r-(f-s)*t)/(s+1);return c}return c.domain=function(f){return arguments.length?([t,r]=f,t=+t,r=+r,i()):[t,r]},c.range=function(f){return arguments.length?(s=(a=Array.from(f)).length-1,i()):a.slice()},c.invertExtent=function(f){var p=a.indexOf(f);return p<0?[NaN,NaN]:p<1?[t,n[0]]:p>=s?[n[s-1],r]:[n[p-1],n[p]]},c.unknown=function(f){return arguments.length&&(o=f),c},c.thresholds=function(){return n.slice()},c.copy=function(){return wZ().domain([t,r]).range(a).unknown(o)},ac.apply(Um(c),arguments)}function NZ(){var t=[.5],r=[0,1],s,n=1;function a(o){return o!=null&&o<=o?r[X_(t,o,0,n)]:s}return a.domain=function(o){return arguments.length?(t=Array.from(o),n=Math.min(t.length,r.length-1),a):t.slice()},a.range=function(o){return arguments.length?(r=Array.from(o),n=Math.min(t.length,r.length-1),a):r.slice()},a.invertExtent=function(o){var c=r.indexOf(o);return[t[c-1],t[c]]},a.unknown=function(o){return arguments.length?(s=o,a):s},a.copy=function(){return NZ().domain(t).range(r).unknown(s)},ac.apply(a,arguments)}const gT=new Date,yT=new Date;function hi(t,r,s,n){function a(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return a.floor=o=>(t(o=new Date(+o)),o),a.ceil=o=>(t(o=new Date(o-1)),r(o,1),t(o),o),a.round=o=>{const c=a(o),i=a.ceil(o);return o-c<i-o?c:i},a.offset=(o,c)=>(r(o=new Date(+o),c==null?1:Math.floor(c)),o),a.range=(o,c,i)=>{const f=[];if(o=a.ceil(o),i=i==null?1:Math.floor(i),!(o<c)||!(i>0))return f;let p;do f.push(p=new Date(+o)),r(o,i),t(o);while(p<o&&o<c);return f},a.filter=o=>hi(c=>{if(c>=c)for(;t(c),!o(c);)c.setTime(c-1)},(c,i)=>{if(c>=c)if(i<0)for(;++i<=0;)for(;r(c,-1),!o(c););else for(;--i>=0;)for(;r(c,1),!o(c););}),s&&(a.count=(o,c)=>(gT.setTime(+o),yT.setTime(+c),t(gT),t(yT),Math.floor(s(gT,yT))),a.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?a.filter(n?c=>n(c)%o===0:c=>a.count(0,c)%o===0):a)),a}const f2=hi(()=>{},(t,r)=>{t.setTime(+t+r)},(t,r)=>r-t);f2.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?hi(r=>{r.setTime(Math.floor(r/t)*t)},(r,s)=>{r.setTime(+r+s*t)},(r,s)=>(s-r)/t):f2);f2.range;const Pu=1e3,Vl=Pu*60,ku=Vl*60,Vu=ku*24,ZD=Vu*7,b6=Vu*30,vT=Vu*365,Xf=hi(t=>{t.setTime(t-t.getMilliseconds())},(t,r)=>{t.setTime(+t+r*Pu)},(t,r)=>(r-t)/Pu,t=>t.getUTCSeconds());Xf.range;const YD=hi(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Pu)},(t,r)=>{t.setTime(+t+r*Vl)},(t,r)=>(r-t)/Vl,t=>t.getMinutes());YD.range;const XD=hi(t=>{t.setUTCSeconds(0,0)},(t,r)=>{t.setTime(+t+r*Vl)},(t,r)=>(r-t)/Vl,t=>t.getUTCMinutes());XD.range;const QD=hi(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Pu-t.getMinutes()*Vl)},(t,r)=>{t.setTime(+t+r*ku)},(t,r)=>(r-t)/ku,t=>t.getHours());QD.range;const JD=hi(t=>{t.setUTCMinutes(0,0,0)},(t,r)=>{t.setTime(+t+r*ku)},(t,r)=>(r-t)/ku,t=>t.getUTCHours());JD.range;const ew=hi(t=>t.setHours(0,0,0,0),(t,r)=>t.setDate(t.getDate()+r),(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Vl)/Vu,t=>t.getDate()-1);ew.range;const vP=hi(t=>{t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r)},(t,r)=>(r-t)/Vu,t=>t.getUTCDate()-1);vP.range;const SZ=hi(t=>{t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r)},(t,r)=>(r-t)/Vu,t=>Math.floor(t/Vu));SZ.range;function Vp(t){return hi(r=>{r.setDate(r.getDate()-(r.getDay()+7-t)%7),r.setHours(0,0,0,0)},(r,s)=>{r.setDate(r.getDate()+s*7)},(r,s)=>(s-r-(s.getTimezoneOffset()-r.getTimezoneOffset())*Vl)/ZD)}const jP=Vp(0),p2=Vp(1),mTe=Vp(2),fTe=Vp(3),Iy=Vp(4),pTe=Vp(5),xTe=Vp(6);jP.range;p2.range;mTe.range;fTe.range;Iy.range;pTe.range;xTe.range;function Up(t){return hi(r=>{r.setUTCDate(r.getUTCDate()-(r.getUTCDay()+7-t)%7),r.setUTCHours(0,0,0,0)},(r,s)=>{r.setUTCDate(r.getUTCDate()+s*7)},(r,s)=>(s-r)/ZD)}const bP=Up(0),x2=Up(1),gTe=Up(2),yTe=Up(3),Dy=Up(4),vTe=Up(5),jTe=Up(6);bP.range;x2.range;gTe.range;yTe.range;Dy.range;vTe.range;jTe.range;const eR=hi(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,r)=>{t.setMonth(t.getMonth()+r)},(t,r)=>r.getMonth()-t.getMonth()+(r.getFullYear()-t.getFullYear())*12,t=>t.getMonth());eR.range;const tR=hi(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCMonth(t.getUTCMonth()+r)},(t,r)=>r.getUTCMonth()-t.getUTCMonth()+(r.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());tR.range;const Uu=hi(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r)},(t,r)=>r.getFullYear()-t.getFullYear(),t=>t.getFullYear());Uu.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:hi(r=>{r.setFullYear(Math.floor(r.getFullYear()/t)*t),r.setMonth(0,1),r.setHours(0,0,0,0)},(r,s)=>{r.setFullYear(r.getFullYear()+s*t)});Uu.range;const Wu=hi(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r)},(t,r)=>r.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());Wu.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:hi(r=>{r.setUTCFullYear(Math.floor(r.getUTCFullYear()/t)*t),r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},(r,s)=>{r.setUTCFullYear(r.getUTCFullYear()+s*t)});Wu.range;function CZ(t,r,s,n,a,o){const c=[[Xf,1,Pu],[Xf,5,5*Pu],[Xf,15,15*Pu],[Xf,30,30*Pu],[o,1,Vl],[o,5,5*Vl],[o,15,15*Vl],[o,30,30*Vl],[a,1,ku],[a,3,3*ku],[a,6,6*ku],[a,12,12*ku],[n,1,Vu],[n,2,2*Vu],[s,1,ZD],[r,1,b6],[r,3,3*b6],[t,1,vT]];function i(p,g,y){const b=g<p;b&&([p,g]=[g,p]);const w=y&&typeof y.range=="function"?y:f(p,g,y),T=w?w.range(p,+g+1):[];return b?T.reverse():T}function f(p,g,y){const b=Math.abs(g-p)/y,w=LD(([,,M])=>M).right(c,b);if(w===c.length)return t.every(u4(p/vT,g/vT,y));if(w===0)return f2.every(Math.max(u4(p,g,y),1));const[T,N]=c[b/c[w-1][2]<c[w][2]/b?w-1:w];return T.every(N)}return[i,f]}const[bTe,_Te]=CZ(Wu,tR,bP,SZ,JD,XD),[wTe,NTe]=CZ(Uu,eR,jP,ew,QD,YD);function jT(t){if(0<=t.y&&t.y<100){var r=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return r.setFullYear(t.y),r}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function bT(t){if(0<=t.y&&t.y<100){var r=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return r.setUTCFullYear(t.y),r}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function x0(t,r,s){return{y:t,m:r,d:s,H:0,M:0,S:0,L:0}}function STe(t){var r=t.dateTime,s=t.date,n=t.time,a=t.periods,o=t.days,c=t.shortDays,i=t.months,f=t.shortMonths,p=g0(a),g=y0(a),y=g0(o),b=y0(o),w=g0(c),T=y0(c),N=g0(i),M=y0(i),O=g0(f),C=y0(f),D={a:ae,A:be,b:de,B:Ke,c:null,d:P6,e:P6,f:HTe,g:nEe,G:iEe,H:WTe,I:GTe,j:KTe,L:PZ,m:ZTe,M:YTe,p:He,q:Ve,Q:T6,s:E6,S:XTe,u:QTe,U:JTe,V:eEe,w:tEe,W:rEe,x:null,X:null,y:sEe,Y:aEe,Z:oEe,"%":A6},L={a:yt,A:Et,b:Rt,B:Vt,c:null,d:k6,e:k6,f:uEe,g:bEe,G:wEe,H:lEe,I:cEe,j:dEe,L:AZ,m:hEe,M:mEe,p:Ct,q:ur,Q:T6,s:E6,S:fEe,u:pEe,U:xEe,V:gEe,w:yEe,W:vEe,x:null,X:null,y:jEe,Y:_Ee,Z:NEe,"%":A6},F={a:re,A:Z,b:ne,B:oe,c:Ce,d:S6,e:S6,f:BTe,g:N6,G:w6,H:C6,I:C6,j:LTe,L:zTe,m:RTe,M:FTe,p:Q,q:DTe,Q:VTe,s:UTe,S:$Te,u:TTe,U:ETe,V:MTe,w:ATe,W:OTe,x:Pe,X:Se,y:N6,Y:w6,Z:ITe,"%":qTe};D.x=B(s,D),D.X=B(n,D),D.c=B(r,D),L.x=B(s,L),L.X=B(n,L),L.c=B(r,L);function B(At,Ht){return function(fr){var vt=[],Br=-1,vr=0,Xr=At.length,Dr,As,xn;for(fr instanceof Date||(fr=new Date(+fr));++Br<Xr;)At.charCodeAt(Br)===37&&(vt.push(At.slice(vr,Br)),(As=_6[Dr=At.charAt(++Br)])!=null?Dr=At.charAt(++Br):As=Dr==="e"?" ":"0",(xn=Ht[Dr])&&(Dr=xn(fr,As)),vt.push(Dr),vr=Br+1);return vt.push(At.slice(vr,Br)),vt.join("")}}function U(At,Ht){return function(fr){var vt=x0(1900,void 0,1),Br=te(vt,At,fr+="",0),vr,Xr;if(Br!=fr.length)return null;if("Q"in vt)return new Date(vt.Q);if("s"in vt)return new Date(vt.s*1e3+("L"in vt?vt.L:0));if(Ht&&!("Z"in vt)&&(vt.Z=0),"p"in vt&&(vt.H=vt.H%12+vt.p*12),vt.m===void 0&&(vt.m="q"in vt?vt.q:0),"V"in vt){if(vt.V<1||vt.V>53)return null;"w"in vt||(vt.w=1),"Z"in vt?(vr=bT(x0(vt.y,0,1)),Xr=vr.getUTCDay(),vr=Xr>4||Xr===0?x2.ceil(vr):x2(vr),vr=vP.offset(vr,(vt.V-1)*7),vt.y=vr.getUTCFullYear(),vt.m=vr.getUTCMonth(),vt.d=vr.getUTCDate()+(vt.w+6)%7):(vr=jT(x0(vt.y,0,1)),Xr=vr.getDay(),vr=Xr>4||Xr===0?p2.ceil(vr):p2(vr),vr=ew.offset(vr,(vt.V-1)*7),vt.y=vr.getFullYear(),vt.m=vr.getMonth(),vt.d=vr.getDate()+(vt.w+6)%7)}else("W"in vt||"U"in vt)&&("w"in vt||(vt.w="u"in vt?vt.u%7:"W"in vt?1:0),Xr="Z"in vt?bT(x0(vt.y,0,1)).getUTCDay():jT(x0(vt.y,0,1)).getDay(),vt.m=0,vt.d="W"in vt?(vt.w+6)%7+vt.W*7-(Xr+5)%7:vt.w+vt.U*7-(Xr+6)%7);return"Z"in vt?(vt.H+=vt.Z/100|0,vt.M+=vt.Z%100,bT(vt)):jT(vt)}}function te(At,Ht,fr,vt){for(var Br=0,vr=Ht.length,Xr=fr.length,Dr,As;Br<vr;){if(vt>=Xr)return-1;if(Dr=Ht.charCodeAt(Br++),Dr===37){if(Dr=Ht.charAt(Br++),As=F[Dr in _6?Ht.charAt(Br++):Dr],!As||(vt=As(At,fr,vt))<0)return-1}else if(Dr!=fr.charCodeAt(vt++))return-1}return vt}function Q(At,Ht,fr){var vt=p.exec(Ht.slice(fr));return vt?(At.p=g.get(vt[0].toLowerCase()),fr+vt[0].length):-1}function re(At,Ht,fr){var vt=w.exec(Ht.slice(fr));return vt?(At.w=T.get(vt[0].toLowerCase()),fr+vt[0].length):-1}function Z(At,Ht,fr){var vt=y.exec(Ht.slice(fr));return vt?(At.w=b.get(vt[0].toLowerCase()),fr+vt[0].length):-1}function ne(At,Ht,fr){var vt=O.exec(Ht.slice(fr));return vt?(At.m=C.get(vt[0].toLowerCase()),fr+vt[0].length):-1}function oe(At,Ht,fr){var vt=N.exec(Ht.slice(fr));return vt?(At.m=M.get(vt[0].toLowerCase()),fr+vt[0].length):-1}function Ce(At,Ht,fr){return te(At,r,Ht,fr)}function Pe(At,Ht,fr){return te(At,s,Ht,fr)}function Se(At,Ht,fr){return te(At,n,Ht,fr)}function ae(At){return c[At.getDay()]}function be(At){return o[At.getDay()]}function de(At){return f[At.getMonth()]}function Ke(At){return i[At.getMonth()]}function He(At){return a[+(At.getHours()>=12)]}function Ve(At){return 1+~~(At.getMonth()/3)}function yt(At){return c[At.getUTCDay()]}function Et(At){return o[At.getUTCDay()]}function Rt(At){return f[At.getUTCMonth()]}function Vt(At){return i[At.getUTCMonth()]}function Ct(At){return a[+(At.getUTCHours()>=12)]}function ur(At){return 1+~~(At.getUTCMonth()/3)}return{format:function(At){var Ht=B(At+="",D);return Ht.toString=function(){return At},Ht},parse:function(At){var Ht=U(At+="",!1);return Ht.toString=function(){return At},Ht},utcFormat:function(At){var Ht=B(At+="",L);return Ht.toString=function(){return At},Ht},utcParse:function(At){var Ht=U(At+="",!0);return Ht.toString=function(){return At},Ht}}}var _6={"-":"",_:" ",0:"0"},Ei=/^\s*\d+/,CTe=/^%/,PTe=/[\\^$*+?|[\]().{}]/g;function en(t,r,s){var n=t<0?"-":"",a=(n?-t:t)+"",o=a.length;return n+(o<s?new Array(s-o+1).join(r)+a:a)}function kTe(t){return t.replace(PTe,"\\$&")}function g0(t){return new RegExp("^(?:"+t.map(kTe).join("|")+")","i")}function y0(t){return new Map(t.map((r,s)=>[r.toLowerCase(),s]))}function ATe(t,r,s){var n=Ei.exec(r.slice(s,s+1));return n?(t.w=+n[0],s+n[0].length):-1}function TTe(t,r,s){var n=Ei.exec(r.slice(s,s+1));return n?(t.u=+n[0],s+n[0].length):-1}function ETe(t,r,s){var n=Ei.exec(r.slice(s,s+2));return n?(t.U=+n[0],s+n[0].length):-1}function MTe(t,r,s){var n=Ei.exec(r.slice(s,s+2));return n?(t.V=+n[0],s+n[0].length):-1}function OTe(t,r,s){var n=Ei.exec(r.slice(s,s+2));return n?(t.W=+n[0],s+n[0].length):-1}function w6(t,r,s){var n=Ei.exec(r.slice(s,s+4));return n?(t.y=+n[0],s+n[0].length):-1}function N6(t,r,s){var n=Ei.exec(r.slice(s,s+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),s+n[0].length):-1}function ITe(t,r,s){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(r.slice(s,s+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),s+n[0].length):-1}function DTe(t,r,s){var n=Ei.exec(r.slice(s,s+1));return n?(t.q=n[0]*3-3,s+n[0].length):-1}function RTe(t,r,s){var n=Ei.exec(r.slice(s,s+2));return n?(t.m=n[0]-1,s+n[0].length):-1}function S6(t,r,s){var n=Ei.exec(r.slice(s,s+2));return n?(t.d=+n[0],s+n[0].length):-1}function LTe(t,r,s){var n=Ei.exec(r.slice(s,s+3));return n?(t.m=0,t.d=+n[0],s+n[0].length):-1}function C6(t,r,s){var n=Ei.exec(r.slice(s,s+2));return n?(t.H=+n[0],s+n[0].length):-1}function FTe(t,r,s){var n=Ei.exec(r.slice(s,s+2));return n?(t.M=+n[0],s+n[0].length):-1}function $Te(t,r,s){var n=Ei.exec(r.slice(s,s+2));return n?(t.S=+n[0],s+n[0].length):-1}function zTe(t,r,s){var n=Ei.exec(r.slice(s,s+3));return n?(t.L=+n[0],s+n[0].length):-1}function BTe(t,r,s){var n=Ei.exec(r.slice(s,s+6));return n?(t.L=Math.floor(n[0]/1e3),s+n[0].length):-1}function qTe(t,r,s){var n=CTe.exec(r.slice(s,s+1));return n?s+n[0].length:-1}function VTe(t,r,s){var n=Ei.exec(r.slice(s));return n?(t.Q=+n[0],s+n[0].length):-1}function UTe(t,r,s){var n=Ei.exec(r.slice(s));return n?(t.s=+n[0],s+n[0].length):-1}function P6(t,r){return en(t.getDate(),r,2)}function WTe(t,r){return en(t.getHours(),r,2)}function GTe(t,r){return en(t.getHours()%12||12,r,2)}function KTe(t,r){return en(1+ew.count(Uu(t),t),r,3)}function PZ(t,r){return en(t.getMilliseconds(),r,3)}function HTe(t,r){return PZ(t,r)+"000"}function ZTe(t,r){return en(t.getMonth()+1,r,2)}function YTe(t,r){return en(t.getMinutes(),r,2)}function XTe(t,r){return en(t.getSeconds(),r,2)}function QTe(t){var r=t.getDay();return r===0?7:r}function JTe(t,r){return en(jP.count(Uu(t)-1,t),r,2)}function kZ(t){var r=t.getDay();return r>=4||r===0?Iy(t):Iy.ceil(t)}function eEe(t,r){return t=kZ(t),en(Iy.count(Uu(t),t)+(Uu(t).getDay()===4),r,2)}function tEe(t){return t.getDay()}function rEe(t,r){return en(p2.count(Uu(t)-1,t),r,2)}function sEe(t,r){return en(t.getFullYear()%100,r,2)}function nEe(t,r){return t=kZ(t),en(t.getFullYear()%100,r,2)}function aEe(t,r){return en(t.getFullYear()%1e4,r,4)}function iEe(t,r){var s=t.getDay();return t=s>=4||s===0?Iy(t):Iy.ceil(t),en(t.getFullYear()%1e4,r,4)}function oEe(t){var r=t.getTimezoneOffset();return(r>0?"-":(r*=-1,"+"))+en(r/60|0,"0",2)+en(r%60,"0",2)}function k6(t,r){return en(t.getUTCDate(),r,2)}function lEe(t,r){return en(t.getUTCHours(),r,2)}function cEe(t,r){return en(t.getUTCHours()%12||12,r,2)}function dEe(t,r){return en(1+vP.count(Wu(t),t),r,3)}function AZ(t,r){return en(t.getUTCMilliseconds(),r,3)}function uEe(t,r){return AZ(t,r)+"000"}function hEe(t,r){return en(t.getUTCMonth()+1,r,2)}function mEe(t,r){return en(t.getUTCMinutes(),r,2)}function fEe(t,r){return en(t.getUTCSeconds(),r,2)}function pEe(t){var r=t.getUTCDay();return r===0?7:r}function xEe(t,r){return en(bP.count(Wu(t)-1,t),r,2)}function TZ(t){var r=t.getUTCDay();return r>=4||r===0?Dy(t):Dy.ceil(t)}function gEe(t,r){return t=TZ(t),en(Dy.count(Wu(t),t)+(Wu(t).getUTCDay()===4),r,2)}function yEe(t){return t.getUTCDay()}function vEe(t,r){return en(x2.count(Wu(t)-1,t),r,2)}function jEe(t,r){return en(t.getUTCFullYear()%100,r,2)}function bEe(t,r){return t=TZ(t),en(t.getUTCFullYear()%100,r,2)}function _Ee(t,r){return en(t.getUTCFullYear()%1e4,r,4)}function wEe(t,r){var s=t.getUTCDay();return t=s>=4||s===0?Dy(t):Dy.ceil(t),en(t.getUTCFullYear()%1e4,r,4)}function NEe(){return"+0000"}function A6(){return"%"}function T6(t){return+t}function E6(t){return Math.floor(+t/1e3)}var ag,EZ,MZ;SEe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function SEe(t){return ag=STe(t),EZ=ag.format,ag.parse,MZ=ag.utcFormat,ag.utcParse,ag}function CEe(t){return new Date(t)}function PEe(t){return t instanceof Date?+t:+new Date(+t)}function rR(t,r,s,n,a,o,c,i,f,p){var g=qD(),y=g.invert,b=g.domain,w=p(".%L"),T=p(":%S"),N=p("%I:%M"),M=p("%I %p"),O=p("%a %d"),C=p("%b %d"),D=p("%B"),L=p("%Y");function F(B){return(f(B)<B?w:i(B)<B?T:c(B)<B?N:o(B)<B?M:n(B)<B?a(B)<B?O:C:s(B)<B?D:L)(B)}return g.invert=function(B){return new Date(y(B))},g.domain=function(B){return arguments.length?b(Array.from(B,PEe)):b().map(CEe)},g.ticks=function(B){var U=b();return t(U[0],U[U.length-1],B??10)},g.tickFormat=function(B,U){return U==null?F:p(U)},g.nice=function(B){var U=b();return(!B||typeof B.range!="function")&&(B=r(U[0],U[U.length-1],B??10)),B?b(yZ(U,B)):g},g.copy=function(){return J_(g,rR(t,r,s,n,a,o,c,i,f,p))},g}function kEe(){return ac.apply(rR(wTe,NTe,Uu,eR,jP,ew,QD,YD,Xf,EZ).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function AEe(){return ac.apply(rR(bTe,_Te,Wu,tR,bP,vP,JD,XD,Xf,MZ).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function _P(){var t=0,r=1,s,n,a,o,c=So,i=!1,f;function p(y){return y==null||isNaN(y=+y)?f:c(a===0?.5:(y=(o(y)-s)*a,i?Math.max(0,Math.min(1,y)):y))}p.domain=function(y){return arguments.length?([t,r]=y,s=o(t=+t),n=o(r=+r),a=s===n?0:1/(n-s),p):[t,r]},p.clamp=function(y){return arguments.length?(i=!!y,p):i},p.interpolator=function(y){return arguments.length?(c=y,p):c};function g(y){return function(b){var w,T;return arguments.length?([w,T]=b,c=y(w,T),p):[c(0),c(1)]}}return p.range=g(Tv),p.rangeRound=g(BD),p.unknown=function(y){return arguments.length?(f=y,p):f},function(y){return o=y,s=y(t),n=y(r),a=s===n?0:1/(n-s),p}}function Wm(t,r){return r.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function OZ(){var t=Um(_P()(So));return t.copy=function(){return Wm(t,OZ())},eh.apply(t,arguments)}function IZ(){var t=WD(_P()).domain([1,10]);return t.copy=function(){return Wm(t,IZ()).base(t.base())},eh.apply(t,arguments)}function DZ(){var t=GD(_P());return t.copy=function(){return Wm(t,DZ()).constant(t.constant())},eh.apply(t,arguments)}function sR(){var t=KD(_P());return t.copy=function(){return Wm(t,sR()).exponent(t.exponent())},eh.apply(t,arguments)}function TEe(){return sR.apply(null,arguments).exponent(.5)}function RZ(){var t=[],r=So;function s(n){if(n!=null&&!isNaN(n=+n))return r((X_(t,n,1)-1)/(t.length-1))}return s.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let a of n)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(ym),s},s.interpolator=function(n){return arguments.length?(r=n,s):r},s.range=function(){return t.map((n,a)=>r(a/(t.length-1)))},s.quantiles=function(n){return Array.from({length:n+1},(a,o)=>xAe(t,o/n))},s.copy=function(){return RZ(r).domain(t)},eh.apply(s,arguments)}function wP(){var t=0,r=.5,s=1,n=1,a,o,c,i,f,p=So,g,y=!1,b;function w(N){return isNaN(N=+N)?b:(N=.5+((N=+g(N))-o)*(n*N<n*o?i:f),p(y?Math.max(0,Math.min(1,N)):N))}w.domain=function(N){return arguments.length?([t,r,s]=N,a=g(t=+t),o=g(r=+r),c=g(s=+s),i=a===o?0:.5/(o-a),f=o===c?0:.5/(c-o),n=o<a?-1:1,w):[t,r,s]},w.clamp=function(N){return arguments.length?(y=!!N,w):y},w.interpolator=function(N){return arguments.length?(p=N,w):p};function T(N){return function(M){var O,C,D;return arguments.length?([O,C,D]=M,p=qAe(N,[O,C,D]),w):[p(0),p(.5),p(1)]}}return w.range=T(Tv),w.rangeRound=T(BD),w.unknown=function(N){return arguments.length?(b=N,w):b},function(N){return g=N,a=N(t),o=N(r),c=N(s),i=a===o?0:.5/(o-a),f=o===c?0:.5/(c-o),n=o<a?-1:1,w}}function LZ(){var t=Um(wP()(So));return t.copy=function(){return Wm(t,LZ())},eh.apply(t,arguments)}function FZ(){var t=WD(wP()).domain([.1,1,10]);return t.copy=function(){return Wm(t,FZ()).base(t.base())},eh.apply(t,arguments)}function $Z(){var t=GD(wP());return t.copy=function(){return Wm(t,$Z()).constant(t.constant())},eh.apply(t,arguments)}function nR(){var t=KD(wP());return t.copy=function(){return Wm(t,nR()).exponent(t.exponent())},eh.apply(t,arguments)}function EEe(){return nR.apply(null,arguments).exponent(.5)}const M6=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:$b,scaleDiverging:LZ,scaleDivergingLog:FZ,scaleDivergingPow:nR,scaleDivergingSqrt:EEe,scaleDivergingSymlog:$Z,scaleIdentity:gZ,scaleImplicit:h4,scaleLinear:m2,scaleLog:vZ,scaleOrdinal:FD,scalePoint:K0,scalePow:HD,scaleQuantile:_Z,scaleQuantize:wZ,scaleRadial:bZ,scaleSequential:OZ,scaleSequentialLog:IZ,scaleSequentialPow:sR,scaleSequentialQuantile:RZ,scaleSequentialSqrt:TEe,scaleSequentialSymlog:DZ,scaleSqrt:uTe,scaleSymlog:jZ,scaleThreshold:NZ,scaleTime:kEe,scaleUtc:AEe,tickFormat:xZ},Symbol.toStringTag,{value:"Module"}));var MEe=bv;function OEe(t,r,s){for(var n=-1,a=t.length;++n<a;){var o=t[n],c=r(o);if(c!=null&&(i===void 0?c===c&&!MEe(c):s(c,i)))var i=c,f=o}return f}var NP=OEe;function IEe(t,r){return t>r}var zZ=IEe,DEe=NP,REe=zZ,LEe=Av;function FEe(t){return t&&t.length?DEe(t,LEe,REe):void 0}var $Ee=FEe;const nm=tn($Ee);function zEe(t,r){return t<r}var BZ=zEe,BEe=NP,qEe=BZ,VEe=Av;function UEe(t){return t&&t.length?BEe(t,VEe,qEe):void 0}var WEe=UEe;const SP=tn(WEe);var GEe=yD,KEe=zd,HEe=ZH,ZEe=Zo;function YEe(t,r){var s=ZEe(t)?GEe:HEe;return s(t,KEe(r))}var XEe=YEe,QEe=KH,JEe=XEe;function eMe(t,r){return QEe(JEe(t,r),1)}var tMe=eMe;const rMe=tn(tMe);var sMe=OD;function nMe(t,r){return sMe(t,r)}var aMe=nMe;const Mm=tn(aMe);var Ev=1e9,iMe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},iR,sa=!0,Xl="[DecimalError] ",up=Xl+"Invalid argument: ",aR=Xl+"Exponent out of range: ",Mv=Math.floor,Bf=Math.pow,oMe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,pl,ji=1e7,Kn=7,qZ=9007199254740991,g2=Mv(qZ/Kn),Mr={};Mr.absoluteValue=Mr.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};Mr.comparedTo=Mr.cmp=function(t){var r,s,n,a,o=this;if(t=new o.constructor(t),o.s!==t.s)return o.s||-t.s;if(o.e!==t.e)return o.e>t.e^o.s<0?1:-1;for(n=o.d.length,a=t.d.length,r=0,s=n<a?n:a;r<s;++r)if(o.d[r]!==t.d[r])return o.d[r]>t.d[r]^o.s<0?1:-1;return n===a?0:n>a^o.s<0?1:-1};Mr.decimalPlaces=Mr.dp=function(){var t=this,r=t.d.length-1,s=(r-t.e)*Kn;if(r=t.d[r],r)for(;r%10==0;r/=10)s--;return s<0?0:s};Mr.dividedBy=Mr.div=function(t){return Mu(this,new this.constructor(t))};Mr.dividedToIntegerBy=Mr.idiv=function(t){var r=this,s=r.constructor;return kn(Mu(r,new s(t),0,1),s.precision)};Mr.equals=Mr.eq=function(t){return!this.cmp(t)};Mr.exponent=function(){return Za(this)};Mr.greaterThan=Mr.gt=function(t){return this.cmp(t)>0};Mr.greaterThanOrEqualTo=Mr.gte=function(t){return this.cmp(t)>=0};Mr.isInteger=Mr.isint=function(){return this.e>this.d.length-2};Mr.isNegative=Mr.isneg=function(){return this.s<0};Mr.isPositive=Mr.ispos=function(){return this.s>0};Mr.isZero=function(){return this.s===0};Mr.lessThan=Mr.lt=function(t){return this.cmp(t)<0};Mr.lessThanOrEqualTo=Mr.lte=function(t){return this.cmp(t)<1};Mr.logarithm=Mr.log=function(t){var r,s=this,n=s.constructor,a=n.precision,o=a+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(pl))throw Error(Xl+"NaN");if(s.s<1)throw Error(Xl+(s.s?"NaN":"-Infinity"));return s.eq(pl)?new n(0):(sa=!1,r=Mu(Ub(s,o),Ub(t,o),o),sa=!0,kn(r,a))};Mr.minus=Mr.sub=function(t){var r=this;return t=new r.constructor(t),r.s==t.s?WZ(r,t):VZ(r,(t.s=-t.s,t))};Mr.modulo=Mr.mod=function(t){var r,s=this,n=s.constructor,a=n.precision;if(t=new n(t),!t.s)throw Error(Xl+"NaN");return s.s?(sa=!1,r=Mu(s,t,0,1).times(t),sa=!0,s.minus(r)):kn(new n(s),a)};Mr.naturalExponential=Mr.exp=function(){return UZ(this)};Mr.naturalLogarithm=Mr.ln=function(){return Ub(this)};Mr.negated=Mr.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};Mr.plus=Mr.add=function(t){var r=this;return t=new r.constructor(t),r.s==t.s?VZ(r,t):WZ(r,(t.s=-t.s,t))};Mr.precision=Mr.sd=function(t){var r,s,n,a=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(up+t);if(r=Za(a)+1,n=a.d.length-1,s=n*Kn+1,n=a.d[n],n){for(;n%10==0;n/=10)s--;for(n=a.d[0];n>=10;n/=10)s++}return t&&r>s?r:s};Mr.squareRoot=Mr.sqrt=function(){var t,r,s,n,a,o,c,i=this,f=i.constructor;if(i.s<1){if(!i.s)return new f(0);throw Error(Xl+"NaN")}for(t=Za(i),sa=!1,a=Math.sqrt(+i),a==0||a==1/0?(r=bd(i.d),(r.length+t)%2==0&&(r+="0"),a=Math.sqrt(r),t=Mv((t+1)/2)-(t<0||t%2),a==1/0?r="5e"+t:(r=a.toExponential(),r=r.slice(0,r.indexOf("e")+1)+t),n=new f(r)):n=new f(a.toString()),s=f.precision,a=c=s+3;;)if(o=n,n=o.plus(Mu(i,o,c+2)).times(.5),bd(o.d).slice(0,c)===(r=bd(n.d)).slice(0,c)){if(r=r.slice(c-3,c+1),a==c&&r=="4999"){if(kn(o,s+1,0),o.times(o).eq(i)){n=o;break}}else if(r!="9999")break;c+=4}return sa=!0,kn(n,s)};Mr.times=Mr.mul=function(t){var r,s,n,a,o,c,i,f,p,g=this,y=g.constructor,b=g.d,w=(t=new y(t)).d;if(!g.s||!t.s)return new y(0);for(t.s*=g.s,s=g.e+t.e,f=b.length,p=w.length,f<p&&(o=b,b=w,w=o,c=f,f=p,p=c),o=[],c=f+p,n=c;n--;)o.push(0);for(n=p;--n>=0;){for(r=0,a=f+n;a>n;)i=o[a]+w[n]*b[a-n-1]+r,o[a--]=i%ji|0,r=i/ji|0;o[a]=(o[a]+r)%ji|0}for(;!o[--c];)o.pop();return r?++s:o.shift(),t.d=o,t.e=s,sa?kn(t,y.precision):t};Mr.toDecimalPlaces=Mr.todp=function(t,r){var s=this,n=s.constructor;return s=new n(s),t===void 0?s:(Md(t,0,Ev),r===void 0?r=n.rounding:Md(r,0,8),kn(s,t+Za(s)+1,r))};Mr.toExponential=function(t,r){var s,n=this,a=n.constructor;return t===void 0?s=Mp(n,!0):(Md(t,0,Ev),r===void 0?r=a.rounding:Md(r,0,8),n=kn(new a(n),t+1,r),s=Mp(n,!0,t+1)),s};Mr.toFixed=function(t,r){var s,n,a=this,o=a.constructor;return t===void 0?Mp(a):(Md(t,0,Ev),r===void 0?r=o.rounding:Md(r,0,8),n=kn(new o(a),t+Za(a)+1,r),s=Mp(n.abs(),!1,t+Za(n)+1),a.isneg()&&!a.isZero()?"-"+s:s)};Mr.toInteger=Mr.toint=function(){var t=this,r=t.constructor;return kn(new r(t),Za(t)+1,r.rounding)};Mr.toNumber=function(){return+this};Mr.toPower=Mr.pow=function(t){var r,s,n,a,o,c,i=this,f=i.constructor,p=12,g=+(t=new f(t));if(!t.s)return new f(pl);if(i=new f(i),!i.s){if(t.s<1)throw Error(Xl+"Infinity");return i}if(i.eq(pl))return i;if(n=f.precision,t.eq(pl))return kn(i,n);if(r=t.e,s=t.d.length-1,c=r>=s,o=i.s,c){if((s=g<0?-g:g)<=qZ){for(a=new f(pl),r=Math.ceil(n/Kn+4),sa=!1;s%2&&(a=a.times(i),I6(a.d,r)),s=Mv(s/2),s!==0;)i=i.times(i),I6(i.d,r);return sa=!0,t.s<0?new f(pl).div(a):kn(a,n)}}else if(o<0)throw Error(Xl+"NaN");return o=o<0&&t.d[Math.max(r,s)]&1?-1:1,i.s=1,sa=!1,a=t.times(Ub(i,n+p)),sa=!0,a=UZ(a),a.s=o,a};Mr.toPrecision=function(t,r){var s,n,a=this,o=a.constructor;return t===void 0?(s=Za(a),n=Mp(a,s<=o.toExpNeg||s>=o.toExpPos)):(Md(t,1,Ev),r===void 0?r=o.rounding:Md(r,0,8),a=kn(new o(a),t,r),s=Za(a),n=Mp(a,t<=s||s<=o.toExpNeg,t)),n};Mr.toSignificantDigits=Mr.tosd=function(t,r){var s=this,n=s.constructor;return t===void 0?(t=n.precision,r=n.rounding):(Md(t,1,Ev),r===void 0?r=n.rounding:Md(r,0,8)),kn(new n(s),t,r)};Mr.toString=Mr.valueOf=Mr.val=Mr.toJSON=Mr[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,r=Za(t),s=t.constructor;return Mp(t,r<=s.toExpNeg||r>=s.toExpPos)};function VZ(t,r){var s,n,a,o,c,i,f,p,g=t.constructor,y=g.precision;if(!t.s||!r.s)return r.s||(r=new g(t)),sa?kn(r,y):r;if(f=t.d,p=r.d,c=t.e,a=r.e,f=f.slice(),o=c-a,o){for(o<0?(n=f,o=-o,i=p.length):(n=p,a=c,i=f.length),c=Math.ceil(y/Kn),i=c>i?c+1:i+1,o>i&&(o=i,n.length=1),n.reverse();o--;)n.push(0);n.reverse()}for(i=f.length,o=p.length,i-o<0&&(o=i,n=p,p=f,f=n),s=0;o;)s=(f[--o]=f[o]+p[o]+s)/ji|0,f[o]%=ji;for(s&&(f.unshift(s),++a),i=f.length;f[--i]==0;)f.pop();return r.d=f,r.e=a,sa?kn(r,y):r}function Md(t,r,s){if(t!==~~t||t<r||t>s)throw Error(up+t)}function bd(t){var r,s,n,a=t.length-1,o="",c=t[0];if(a>0){for(o+=c,r=1;r<a;r++)n=t[r]+"",s=Kn-n.length,s&&(o+=zh(s)),o+=n;c=t[r],n=c+"",s=Kn-n.length,s&&(o+=zh(s))}else if(c===0)return"0";for(;c%10===0;)c/=10;return o+c}var Mu=function(){function t(n,a){var o,c=0,i=n.length;for(n=n.slice();i--;)o=n[i]*a+c,n[i]=o%ji|0,c=o/ji|0;return c&&n.unshift(c),n}function r(n,a,o,c){var i,f;if(o!=c)f=o>c?1:-1;else for(i=f=0;i<o;i++)if(n[i]!=a[i]){f=n[i]>a[i]?1:-1;break}return f}function s(n,a,o){for(var c=0;o--;)n[o]-=c,c=n[o]<a[o]?1:0,n[o]=c*ji+n[o]-a[o];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,o,c){var i,f,p,g,y,b,w,T,N,M,O,C,D,L,F,B,U,te,Q=n.constructor,re=n.s==a.s?1:-1,Z=n.d,ne=a.d;if(!n.s)return new Q(n);if(!a.s)throw Error(Xl+"Division by zero");for(f=n.e-a.e,U=ne.length,F=Z.length,w=new Q(re),T=w.d=[],p=0;ne[p]==(Z[p]||0);)++p;if(ne[p]>(Z[p]||0)&&--f,o==null?C=o=Q.precision:c?C=o+(Za(n)-Za(a))+1:C=o,C<0)return new Q(0);if(C=C/Kn+2|0,p=0,U==1)for(g=0,ne=ne[0],C++;(p<F||g)&&C--;p++)D=g*ji+(Z[p]||0),T[p]=D/ne|0,g=D%ne|0;else{for(g=ji/(ne[0]+1)|0,g>1&&(ne=t(ne,g),Z=t(Z,g),U=ne.length,F=Z.length),L=U,N=Z.slice(0,U),M=N.length;M<U;)N[M++]=0;te=ne.slice(),te.unshift(0),B=ne[0],ne[1]>=ji/2&&++B;do g=0,i=r(ne,N,U,M),i<0?(O=N[0],U!=M&&(O=O*ji+(N[1]||0)),g=O/B|0,g>1?(g>=ji&&(g=ji-1),y=t(ne,g),b=y.length,M=N.length,i=r(y,N,b,M),i==1&&(g--,s(y,U<b?te:ne,b))):(g==0&&(i=g=1),y=ne.slice()),b=y.length,b<M&&y.unshift(0),s(N,y,M),i==-1&&(M=N.length,i=r(ne,N,U,M),i<1&&(g++,s(N,U<M?te:ne,M))),M=N.length):i===0&&(g++,N=[0]),T[p++]=g,i&&N[0]?N[M++]=Z[L]||0:(N=[Z[L]],M=1);while((L++<F||N[0]!==void 0)&&C--)}return T[0]||T.shift(),w.e=f,kn(w,c?o+Za(w)+1:o)}}();function UZ(t,r){var s,n,a,o,c,i,f=0,p=0,g=t.constructor,y=g.precision;if(Za(t)>16)throw Error(aR+Za(t));if(!t.s)return new g(pl);for(sa=!1,i=y,c=new g(.03125);t.abs().gte(.1);)t=t.times(c),p+=5;for(n=Math.log(Bf(2,p))/Math.LN10*2+5|0,i+=n,s=a=o=new g(pl),g.precision=i;;){if(a=kn(a.times(t),i),s=s.times(++f),c=o.plus(Mu(a,s,i)),bd(c.d).slice(0,i)===bd(o.d).slice(0,i)){for(;p--;)o=kn(o.times(o),i);return g.precision=y,r==null?(sa=!0,kn(o,y)):o}o=c}}function Za(t){for(var r=t.e*Kn,s=t.d[0];s>=10;s/=10)r++;return r}function _T(t,r,s){if(r>t.LN10.sd())throw sa=!0,s&&(t.precision=s),Error(Xl+"LN10 precision limit exceeded");return kn(new t(t.LN10),r)}function zh(t){for(var r="";t--;)r+="0";return r}function Ub(t,r){var s,n,a,o,c,i,f,p,g,y=1,b=10,w=t,T=w.d,N=w.constructor,M=N.precision;if(w.s<1)throw Error(Xl+(w.s?"NaN":"-Infinity"));if(w.eq(pl))return new N(0);if(r==null?(sa=!1,p=M):p=r,w.eq(10))return r==null&&(sa=!0),_T(N,p);if(p+=b,N.precision=p,s=bd(T),n=s.charAt(0),o=Za(w),Math.abs(o)<15e14){for(;n<7&&n!=1||n==1&&s.charAt(1)>3;)w=w.times(t),s=bd(w.d),n=s.charAt(0),y++;o=Za(w),n>1?(w=new N("0."+s),o++):w=new N(n+"."+s.slice(1))}else return f=_T(N,p+2,M).times(o+""),w=Ub(new N(n+"."+s.slice(1)),p-b).plus(f),N.precision=M,r==null?(sa=!0,kn(w,M)):w;for(i=c=w=Mu(w.minus(pl),w.plus(pl),p),g=kn(w.times(w),p),a=3;;){if(c=kn(c.times(g),p),f=i.plus(Mu(c,new N(a),p)),bd(f.d).slice(0,p)===bd(i.d).slice(0,p))return i=i.times(2),o!==0&&(i=i.plus(_T(N,p+2,M).times(o+""))),i=Mu(i,new N(y),p),N.precision=M,r==null?(sa=!0,kn(i,M)):i;i=f,a+=2}}function O6(t,r){var s,n,a;for((s=r.indexOf("."))>-1&&(r=r.replace(".","")),(n=r.search(/e/i))>0?(s<0&&(s=n),s+=+r.slice(n+1),r=r.substring(0,n)):s<0&&(s=r.length),n=0;r.charCodeAt(n)===48;)++n;for(a=r.length;r.charCodeAt(a-1)===48;)--a;if(r=r.slice(n,a),r){if(a-=n,s=s-n-1,t.e=Mv(s/Kn),t.d=[],n=(s+1)%Kn,s<0&&(n+=Kn),n<a){for(n&&t.d.push(+r.slice(0,n)),a-=Kn;n<a;)t.d.push(+r.slice(n,n+=Kn));r=r.slice(n),n=Kn-r.length}else n-=a;for(;n--;)r+="0";if(t.d.push(+r),sa&&(t.e>g2||t.e<-g2))throw Error(aR+s)}else t.s=0,t.e=0,t.d=[0];return t}function kn(t,r,s){var n,a,o,c,i,f,p,g,y=t.d;for(c=1,o=y[0];o>=10;o/=10)c++;if(n=r-c,n<0)n+=Kn,a=r,p=y[g=0];else{if(g=Math.ceil((n+1)/Kn),o=y.length,g>=o)return t;for(p=o=y[g],c=1;o>=10;o/=10)c++;n%=Kn,a=n-Kn+c}if(s!==void 0&&(o=Bf(10,c-a-1),i=p/o%10|0,f=r<0||y[g+1]!==void 0||p%o,f=s<4?(i||f)&&(s==0||s==(t.s<0?3:2)):i>5||i==5&&(s==4||f||s==6&&(n>0?a>0?p/Bf(10,c-a):0:y[g-1])%10&1||s==(t.s<0?8:7))),r<1||!y[0])return f?(o=Za(t),y.length=1,r=r-o-1,y[0]=Bf(10,(Kn-r%Kn)%Kn),t.e=Mv(-r/Kn)||0):(y.length=1,y[0]=t.e=t.s=0),t;if(n==0?(y.length=g,o=1,g--):(y.length=g+1,o=Bf(10,Kn-n),y[g]=a>0?(p/Bf(10,c-a)%Bf(10,a)|0)*o:0),f)for(;;)if(g==0){(y[0]+=o)==ji&&(y[0]=1,++t.e);break}else{if(y[g]+=o,y[g]!=ji)break;y[g--]=0,o=1}for(n=y.length;y[--n]===0;)y.pop();if(sa&&(t.e>g2||t.e<-g2))throw Error(aR+Za(t));return t}function WZ(t,r){var s,n,a,o,c,i,f,p,g,y,b=t.constructor,w=b.precision;if(!t.s||!r.s)return r.s?r.s=-r.s:r=new b(t),sa?kn(r,w):r;if(f=t.d,y=r.d,n=r.e,p=t.e,f=f.slice(),c=p-n,c){for(g=c<0,g?(s=f,c=-c,i=y.length):(s=y,n=p,i=f.length),a=Math.max(Math.ceil(w/Kn),i)+2,c>a&&(c=a,s.length=1),s.reverse(),a=c;a--;)s.push(0);s.reverse()}else{for(a=f.length,i=y.length,g=a<i,g&&(i=a),a=0;a<i;a++)if(f[a]!=y[a]){g=f[a]<y[a];break}c=0}for(g&&(s=f,f=y,y=s,r.s=-r.s),i=f.length,a=y.length-i;a>0;--a)f[i++]=0;for(a=y.length;a>c;){if(f[--a]<y[a]){for(o=a;o&&f[--o]===0;)f[o]=ji-1;--f[o],f[a]+=ji}f[a]-=y[a]}for(;f[--i]===0;)f.pop();for(;f[0]===0;f.shift())--n;return f[0]?(r.d=f,r.e=n,sa?kn(r,w):r):new b(0)}function Mp(t,r,s){var n,a=Za(t),o=bd(t.d),c=o.length;return r?(s&&(n=s-c)>0?o=o.charAt(0)+"."+o.slice(1)+zh(n):c>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(a<0?"e":"e+")+a):a<0?(o="0."+zh(-a-1)+o,s&&(n=s-c)>0&&(o+=zh(n))):a>=c?(o+=zh(a+1-c),s&&(n=s-a-1)>0&&(o=o+"."+zh(n))):((n=a+1)<c&&(o=o.slice(0,n)+"."+o.slice(n)),s&&(n=s-c)>0&&(a+1===c&&(o+="."),o+=zh(n))),t.s<0?"-"+o:o}function I6(t,r){if(t.length>r)return t.length=r,!0}function GZ(t){var r,s,n;function a(o){var c=this;if(!(c instanceof a))return new a(o);if(c.constructor=a,o instanceof a){c.s=o.s,c.e=o.e,c.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(up+o);if(o>0)c.s=1;else if(o<0)o=-o,c.s=-1;else{c.s=0,c.e=0,c.d=[0];return}if(o===~~o&&o<1e7){c.e=0,c.d=[o];return}return O6(c,o.toString())}else if(typeof o!="string")throw Error(up+o);if(o.charCodeAt(0)===45?(o=o.slice(1),c.s=-1):c.s=1,oMe.test(o))O6(c,o);else throw Error(up+o)}if(a.prototype=Mr,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=GZ,a.config=a.set=lMe,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],r=0;r<n.length;)t.hasOwnProperty(s=n[r++])||(t[s]=this[s]);return a.config(t),a}function lMe(t){if(!t||typeof t!="object")throw Error(Xl+"Object expected");var r,s,n,a=["precision",1,Ev,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(r=0;r<a.length;r+=3)if((n=t[s=a[r]])!==void 0)if(Mv(n)===n&&n>=a[r+1]&&n<=a[r+2])this[s]=n;else throw Error(up+s+": "+n);if((n=t[s="LN10"])!==void 0)if(n==Math.LN10)this[s]=new this(n);else throw Error(up+s+": "+n);return this}var iR=GZ(iMe);pl=new iR(1);const bn=iR;function cMe(t){return mMe(t)||hMe(t)||uMe(t)||dMe()}function dMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uMe(t,r){if(t){if(typeof t=="string")return x4(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return x4(t,r)}}function hMe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function mMe(t){if(Array.isArray(t))return x4(t)}function x4(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}var fMe=function(r){return r},KZ={},HZ=function(r){return r===KZ},D6=function(r){return function s(){return arguments.length===0||arguments.length===1&&HZ(arguments.length<=0?void 0:arguments[0])?s:r.apply(void 0,arguments)}},pMe=function t(r,s){return r===1?s:D6(function(){for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];var c=a.filter(function(i){return i!==KZ}).length;return c>=r?s.apply(void 0,a):t(r-c,D6(function(){for(var i=arguments.length,f=new Array(i),p=0;p<i;p++)f[p]=arguments[p];var g=a.map(function(y){return HZ(y)?f.shift():y});return s.apply(void 0,cMe(g).concat(f))}))})},CP=function(r){return pMe(r.length,r)},g4=function(r,s){for(var n=[],a=r;a<s;++a)n[a-r]=a;return n},xMe=CP(function(t,r){return Array.isArray(r)?r.map(t):Object.keys(r).map(function(s){return r[s]}).map(t)}),gMe=function(){for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];if(!s.length)return fMe;var a=s.reverse(),o=a[0],c=a.slice(1);return function(){return c.reduce(function(i,f){return f(i)},o.apply(void 0,arguments))}},y4=function(r){return Array.isArray(r)?r.reverse():r.split("").reverse.join("")},ZZ=function(r){var s=null,n=null;return function(){for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return s&&o.every(function(i,f){return i===s[f]})||(s=o,n=r.apply(void 0,o)),n}};function yMe(t){var r;return t===0?r=1:r=Math.floor(new bn(t).abs().log(10).toNumber())+1,r}function vMe(t,r,s){for(var n=new bn(t),a=0,o=[];n.lt(r)&&a<1e5;)o.push(n.toNumber()),n=n.add(s),a++;return o}var jMe=CP(function(t,r,s){var n=+t,a=+r;return n+s*(a-n)}),bMe=CP(function(t,r,s){var n=r-+t;return n=n||1/0,(s-t)/n}),_Me=CP(function(t,r,s){var n=r-+t;return n=n||1/0,Math.max(0,Math.min(1,(s-t)/n))});const PP={rangeStep:vMe,getDigitCount:yMe,interpolateNumber:jMe,uninterpolateNumber:bMe,uninterpolateTruncation:_Me};function v4(t){return SMe(t)||NMe(t)||YZ(t)||wMe()}function wMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NMe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function SMe(t){if(Array.isArray(t))return j4(t)}function Wb(t,r){return kMe(t)||PMe(t,r)||YZ(t,r)||CMe()}function CMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YZ(t,r){if(t){if(typeof t=="string")return j4(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return j4(t,r)}}function j4(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function PMe(t,r){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var s=[],n=!0,a=!1,o=void 0;try{for(var c=t[Symbol.iterator](),i;!(n=(i=c.next()).done)&&(s.push(i.value),!(r&&s.length===r));n=!0);}catch(f){a=!0,o=f}finally{try{!n&&c.return!=null&&c.return()}finally{if(a)throw o}}return s}}function kMe(t){if(Array.isArray(t))return t}function XZ(t){var r=Wb(t,2),s=r[0],n=r[1],a=s,o=n;return s>n&&(a=n,o=s),[a,o]}function QZ(t,r,s){if(t.lte(0))return new bn(0);var n=PP.getDigitCount(t.toNumber()),a=new bn(10).pow(n),o=t.div(a),c=n!==1?.05:.1,i=new bn(Math.ceil(o.div(c).toNumber())).add(s).mul(c),f=i.mul(a);return r?f:new bn(Math.ceil(f))}function AMe(t,r,s){var n=1,a=new bn(t);if(!a.isint()&&s){var o=Math.abs(t);o<1?(n=new bn(10).pow(PP.getDigitCount(t)-1),a=new bn(Math.floor(a.div(n).toNumber())).mul(n)):o>1&&(a=new bn(Math.floor(t)))}else t===0?a=new bn(Math.floor((r-1)/2)):s||(a=new bn(Math.floor(t)));var c=Math.floor((r-1)/2),i=gMe(xMe(function(f){return a.add(new bn(f-c).mul(n)).toNumber()}),g4);return i(0,r)}function JZ(t,r,s,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(s-1)))return{step:new bn(0),tickMin:new bn(0),tickMax:new bn(0)};var o=QZ(new bn(r).sub(t).div(s-1),n,a),c;t<=0&&r>=0?c=new bn(0):(c=new bn(t).add(r).div(2),c=c.sub(new bn(c).mod(o)));var i=Math.ceil(c.sub(t).div(o).toNumber()),f=Math.ceil(new bn(r).sub(c).div(o).toNumber()),p=i+f+1;return p>s?JZ(t,r,s,n,a+1):(p<s&&(f=r>0?f+(s-p):f,i=r>0?i:i+(s-p)),{step:o,tickMin:c.sub(new bn(i).mul(o)),tickMax:c.add(new bn(f).mul(o))})}function TMe(t){var r=Wb(t,2),s=r[0],n=r[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,c=Math.max(a,2),i=XZ([s,n]),f=Wb(i,2),p=f[0],g=f[1];if(p===-1/0||g===1/0){var y=g===1/0?[p].concat(v4(g4(0,a-1).map(function(){return 1/0}))):[].concat(v4(g4(0,a-1).map(function(){return-1/0})),[g]);return s>n?y4(y):y}if(p===g)return AMe(p,a,o);var b=JZ(p,g,c,o),w=b.step,T=b.tickMin,N=b.tickMax,M=PP.rangeStep(T,N.add(new bn(.1).mul(w)),w);return s>n?y4(M):M}function EMe(t,r){var s=Wb(t,2),n=s[0],a=s[1],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,c=XZ([n,a]),i=Wb(c,2),f=i[0],p=i[1];if(f===-1/0||p===1/0)return[n,a];if(f===p)return[f];var g=Math.max(r,2),y=QZ(new bn(p).sub(f).div(g-1),o,0),b=[].concat(v4(PP.rangeStep(new bn(f),new bn(p).sub(new bn(.99).mul(y)),y)),[p]);return n>a?y4(b):b}var MMe=ZZ(TMe),OMe=ZZ(EMe),IMe="Invariant failed";function Op(t,r){throw new Error(IMe)}var DMe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Ry(t){"@babel/helpers - typeof";return Ry=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ry(t)}function y2(){return y2=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},y2.apply(this,arguments)}function RMe(t,r){return zMe(t)||$Me(t,r)||FMe(t,r)||LMe()}function LMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FMe(t,r){if(t){if(typeof t=="string")return R6(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return R6(t,r)}}function R6(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function $Me(t,r){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var n,a,o,c,i=[],f=!0,p=!1;try{if(o=(s=s.call(t)).next,r!==0)for(;!(f=(n=o.call(s)).done)&&(i.push(n.value),i.length!==r);f=!0);}catch(g){p=!0,a=g}finally{try{if(!f&&s.return!=null&&(c=s.return(),Object(c)!==c))return}finally{if(p)throw a}}return i}}function zMe(t){if(Array.isArray(t))return t}function BMe(t,r){if(t==null)return{};var s=qMe(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function qMe(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function VMe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function UMe(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rY(n.key),n)}}function WMe(t,r,s){return r&&UMe(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function GMe(t,r,s){return r=v2(r),KMe(t,eY()?Reflect.construct(r,s||[],v2(t).constructor):r.apply(t,s))}function KMe(t,r){if(r&&(Ry(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HMe(t)}function HMe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function eY(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eY=function(){return!!t})()}function v2(t){return v2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},v2(t)}function ZMe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&b4(t,r)}function b4(t,r){return b4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},b4(t,r)}function tY(t,r,s){return r=rY(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function rY(t){var r=YMe(t,"string");return Ry(r)=="symbol"?r:r+""}function YMe(t,r){if(Ry(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Ry(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var tw=function(t){function r(){return VMe(this,r),GMe(this,r,arguments)}return ZMe(r,t),WMe(r,[{key:"render",value:function(){var n=this.props,a=n.offset,o=n.layout,c=n.width,i=n.dataKey,f=n.data,p=n.dataPointFormatter,g=n.xAxis,y=n.yAxis,b=BMe(n,DMe),w=Or(b,!1);this.props.direction==="x"&&g.type!=="number"&&Op();var T=f.map(function(N){var M=p(N,i),O=M.x,C=M.y,D=M.value,L=M.errorVal;if(!L)return null;var F=[],B,U;if(Array.isArray(L)){var te=RMe(L,2);B=te[0],U=te[1]}else B=U=L;if(o==="vertical"){var Q=g.scale,re=C+a,Z=re+c,ne=re-c,oe=Q(D-B),Ce=Q(D+U);F.push({x1:Ce,y1:Z,x2:Ce,y2:ne}),F.push({x1:oe,y1:re,x2:Ce,y2:re}),F.push({x1:oe,y1:Z,x2:oe,y2:ne})}else if(o==="horizontal"){var Pe=y.scale,Se=O+a,ae=Se-c,be=Se+c,de=Pe(D-B),Ke=Pe(D+U);F.push({x1:ae,y1:Ke,x2:be,y2:Ke}),F.push({x1:Se,y1:de,x2:Se,y2:Ke}),F.push({x1:ae,y1:de,x2:be,y2:de})}return je.createElement(_s,y2({className:"recharts-errorBar",key:"bar-".concat(F.map(function(He){return"".concat(He.x1,"-").concat(He.x2,"-").concat(He.y1,"-").concat(He.y2)}))},w),F.map(function(He){return je.createElement("line",y2({},He,{key:"line-".concat(He.x1,"-").concat(He.x2,"-").concat(He.y1,"-").concat(He.y2)}))}))});return je.createElement(_s,{className:"recharts-errorBars"},T)}}])}(je.Component);tY(tw,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});tY(tw,"displayName","ErrorBar");function Gb(t){"@babel/helpers - typeof";return Gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Gb(t)}function L6(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function Of(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?L6(Object(s),!0).forEach(function(n){XMe(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):L6(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function XMe(t,r,s){return r=QMe(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function QMe(t){var r=JMe(t,"string");return Gb(r)=="symbol"?r:r+""}function JMe(t,r){if(Gb(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Gb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var sY=function(r){var s=r.children,n=r.formattedGraphicalItems,a=r.legendWidth,o=r.legendContent,c=dl(s,Ea);if(!c)return null;var i=Ea.defaultProps,f=i!==void 0?Of(Of({},i),c.props):{},p;return c.props&&c.props.payload?p=c.props&&c.props.payload:o==="children"?p=(n||[]).reduce(function(g,y){var b=y.item,w=y.props,T=w.sectors||w.data||[];return g.concat(T.map(function(N){return{type:c.props.iconType||b.props.legendType,value:N.name,color:N.fill,payload:N}}))},[]):p=(n||[]).map(function(g){var y=g.item,b=y.type.defaultProps,w=b!==void 0?Of(Of({},b),y.props):{},T=w.dataKey,N=w.name,M=w.legendType,O=w.hide;return{inactive:O,dataKey:T,type:f.iconType||M||"square",color:oR(y),value:N||T,payload:w}}),Of(Of(Of({},f),Ea.getWithHeight(c,a)),{},{payload:p,item:c})};function Kb(t){"@babel/helpers - typeof";return Kb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Kb(t)}function F6(t){return s4e(t)||r4e(t)||t4e(t)||e4e()}function e4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t4e(t,r){if(t){if(typeof t=="string")return _4(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return _4(t,r)}}function r4e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function s4e(t){if(Array.isArray(t))return _4(t)}function _4(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function $6(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function _a(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?$6(Object(s),!0).forEach(function(n){Wg(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):$6(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function Wg(t,r,s){return r=n4e(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function n4e(t){var r=a4e(t,"string");return Kb(r)=="symbol"?r:r+""}function a4e(t,r){if(Kb(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Kb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function da(t,r,s){return ts(t)||ts(r)?s:di(r)?vl(t,r,s):Wr(r)?r(t):s}function H0(t,r,s,n){var a=rMe(t,function(i){return da(i,r)});if(s==="number"){var o=a.filter(function(i){return cr(i)||parseFloat(i)});return o.length?[SP(o),nm(o)]:[1/0,-1/0]}var c=n?a.filter(function(i){return!ts(i)}):a;return c.map(function(i){return di(i)||i instanceof Date?i:""})}var i4e=function(r){var s,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,c=-1,i=(s=n==null?void 0:n.length)!==null&&s!==void 0?s:0;if(i<=1)return 0;if(o&&o.axisType==="angleAxis"&&Math.abs(Math.abs(o.range[1]-o.range[0])-360)<=1e-6)for(var f=o.range,p=0;p<i;p++){var g=p>0?a[p-1].coordinate:a[i-1].coordinate,y=a[p].coordinate,b=p>=i-1?a[0].coordinate:a[p+1].coordinate,w=void 0;if(wo(y-g)!==wo(b-y)){var T=[];if(wo(b-y)===wo(f[1]-f[0])){w=b;var N=y+f[1]-f[0];T[0]=Math.min(N,(N+g)/2),T[1]=Math.max(N,(N+g)/2)}else{w=g;var M=b+f[1]-f[0];T[0]=Math.min(y,(M+y)/2),T[1]=Math.max(y,(M+y)/2)}var O=[Math.min(y,(w+y)/2),Math.max(y,(w+y)/2)];if(r>O[0]&&r<=O[1]||r>=T[0]&&r<=T[1]){c=a[p].index;break}}else{var C=Math.min(g,b),D=Math.max(g,b);if(r>(C+y)/2&&r<=(D+y)/2){c=a[p].index;break}}}else for(var L=0;L<i;L++)if(L===0&&r<=(n[L].coordinate+n[L+1].coordinate)/2||L>0&&L<i-1&&r>(n[L].coordinate+n[L-1].coordinate)/2&&r<=(n[L].coordinate+n[L+1].coordinate)/2||L===i-1&&r>(n[L].coordinate+n[L-1].coordinate)/2){c=n[L].index;break}return c},oR=function(r){var s,n=r,a=n.type.displayName,o=(s=r.type)!==null&&s!==void 0&&s.defaultProps?_a(_a({},r.type.defaultProps),r.props):r.props,c=o.stroke,i=o.fill,f;switch(a){case"Line":f=c;break;case"Area":case"Radar":f=c&&c!=="none"?c:i;break;default:f=i;break}return f},o4e=function(r){var s=r.barSize,n=r.totalSize,a=r.stackGroups,o=a===void 0?{}:a;if(!o)return{};for(var c={},i=Object.keys(o),f=0,p=i.length;f<p;f++)for(var g=o[i[f]].stackGroups,y=Object.keys(g),b=0,w=y.length;b<w;b++){var T=g[y[b]],N=T.items,M=T.cateAxisId,O=N.filter(function(U){return Eu(U.type).indexOf("Bar")>=0});if(O&&O.length){var C=O[0].type.defaultProps,D=C!==void 0?_a(_a({},C),O[0].props):O[0].props,L=D.barSize,F=D[M];c[F]||(c[F]=[]);var B=ts(L)?s:L;c[F].push({item:O[0],stackList:O.slice(1),barSize:ts(B)?void 0:No(B,n,0)})}}return c},l4e=function(r){var s=r.barGap,n=r.barCategoryGap,a=r.bandSize,o=r.sizeList,c=o===void 0?[]:o,i=r.maxBarSize,f=c.length;if(f<1)return null;var p=No(s,a,0,!0),g,y=[];if(c[0].barSize===+c[0].barSize){var b=!1,w=a/f,T=c.reduce(function(L,F){return L+F.barSize||0},0);T+=(f-1)*p,T>=a&&(T-=(f-1)*p,p=0),T>=a&&w>0&&(b=!0,w*=.9,T=f*w);var N=(a-T)/2>>0,M={offset:N-p,size:0};g=c.reduce(function(L,F){var B={item:F.item,position:{offset:M.offset+M.size+p,size:b?w:F.barSize}},U=[].concat(F6(L),[B]);return M=U[U.length-1].position,F.stackList&&F.stackList.length&&F.stackList.forEach(function(te){U.push({item:te,position:M})}),U},y)}else{var O=No(n,a,0,!0);a-2*O-(f-1)*p<=0&&(p=0);var C=(a-2*O-(f-1)*p)/f;C>1&&(C>>=0);var D=i===+i?Math.min(C,i):C;g=c.reduce(function(L,F,B){var U=[].concat(F6(L),[{item:F.item,position:{offset:O+(C+p)*B+(C-D)/2,size:D}}]);return F.stackList&&F.stackList.length&&F.stackList.forEach(function(te){U.push({item:te,position:U[U.length-1].position})}),U},y)}return g},c4e=function(r,s,n,a){var o=n.children,c=n.width,i=n.margin,f=c-(i.left||0)-(i.right||0),p=sY({children:o,legendWidth:f});if(p){var g=a||{},y=g.width,b=g.height,w=p.align,T=p.verticalAlign,N=p.layout;if((N==="vertical"||N==="horizontal"&&T==="middle")&&w!=="center"&&cr(r[w]))return _a(_a({},r),{},Wg({},w,r[w]+(y||0)));if((N==="horizontal"||N==="vertical"&&w==="center")&&T!=="middle"&&cr(r[T]))return _a(_a({},r),{},Wg({},T,r[T]+(b||0)))}return r},d4e=function(r,s,n){return ts(s)?!0:r==="horizontal"?s==="yAxis":r==="vertical"||n==="x"?s==="xAxis":n==="y"?s==="yAxis":!0},nY=function(r,s,n,a,o){var c=s.props.children,i=jl(c,tw).filter(function(p){return d4e(a,o,p.props.direction)});if(i&&i.length){var f=i.map(function(p){return p.props.dataKey});return r.reduce(function(p,g){var y=da(g,n);if(ts(y))return p;var b=Array.isArray(y)?[SP(y),nm(y)]:[y,y],w=f.reduce(function(T,N){var M=da(g,N,0),O=b[0]-Math.abs(Array.isArray(M)?M[0]:M),C=b[1]+Math.abs(Array.isArray(M)?M[1]:M);return[Math.min(O,T[0]),Math.max(C,T[1])]},[1/0,-1/0]);return[Math.min(w[0],p[0]),Math.max(w[1],p[1])]},[1/0,-1/0])}return null},u4e=function(r,s,n,a,o){var c=s.map(function(i){return nY(r,i,n,o,a)}).filter(function(i){return!ts(i)});return c&&c.length?c.reduce(function(i,f){return[Math.min(i[0],f[0]),Math.max(i[1],f[1])]},[1/0,-1/0]):null},aY=function(r,s,n,a,o){var c=s.map(function(f){var p=f.props.dataKey;return n==="number"&&p&&nY(r,f,p,a)||H0(r,p,n,o)});if(n==="number")return c.reduce(function(f,p){return[Math.min(f[0],p[0]),Math.max(f[1],p[1])]},[1/0,-1/0]);var i={};return c.reduce(function(f,p){for(var g=0,y=p.length;g<y;g++)i[p[g]]||(i[p[g]]=!0,f.push(p[g]));return f},[])},iY=function(r,s){return r==="horizontal"&&s==="xAxis"||r==="vertical"&&s==="yAxis"||r==="centric"&&s==="angleAxis"||r==="radial"&&s==="radiusAxis"},oY=function(r,s,n,a){if(a)return r.map(function(f){return f.coordinate});var o,c,i=r.map(function(f){return f.coordinate===s&&(o=!0),f.coordinate===n&&(c=!0),f.coordinate});return o||i.push(s),c||i.push(n),i},Au=function(r,s,n){if(!r)return null;var a=r.scale,o=r.duplicateDomain,c=r.type,i=r.range,f=r.realScaleType==="scaleBand"?a.bandwidth()/2:2,p=(s||n)&&c==="category"&&a.bandwidth?a.bandwidth()/f:0;if(p=r.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?wo(i[0]-i[1])*2*p:p,s&&(r.ticks||r.niceTicks)){var g=(r.ticks||r.niceTicks).map(function(y){var b=o?o.indexOf(y):y;return{coordinate:a(b)+p,value:y,offset:p}});return g.filter(function(y){return!Cv(y.coordinate)})}return r.isCategorical&&r.categoricalDomain?r.categoricalDomain.map(function(y,b){return{coordinate:a(y)+p,value:y,index:b,offset:p}}):a.ticks&&!n?a.ticks(r.tickCount).map(function(y){return{coordinate:a(y)+p,value:y,offset:p}}):a.domain().map(function(y,b){return{coordinate:a(y)+p,value:o?o[y]:y,index:b,offset:p}})},wT=new WeakMap,yN=function(r,s){if(typeof s!="function")return r;wT.has(r)||wT.set(r,new WeakMap);var n=wT.get(r);if(n.has(s))return n.get(s);var a=function(){r.apply(void 0,arguments),s.apply(void 0,arguments)};return n.set(s,a),a},lY=function(r,s,n){var a=r.scale,o=r.type,c=r.layout,i=r.axisType;if(a==="auto")return c==="radial"&&i==="radiusAxis"?{scale:$b(),realScaleType:"band"}:c==="radial"&&i==="angleAxis"?{scale:m2(),realScaleType:"linear"}:o==="category"&&s&&(s.indexOf("LineChart")>=0||s.indexOf("AreaChart")>=0||s.indexOf("ComposedChart")>=0&&!n)?{scale:K0(),realScaleType:"point"}:o==="category"?{scale:$b(),realScaleType:"band"}:{scale:m2(),realScaleType:"linear"};if(Z_(a)){var f="scale".concat(uP(a));return{scale:(M6[f]||K0)(),realScaleType:M6[f]?f:"point"}}return Wr(a)?{scale:a}:{scale:K0(),realScaleType:"point"}},z6=1e-4,cY=function(r){var s=r.domain();if(!(!s||s.length<=2)){var n=s.length,a=r.range(),o=Math.min(a[0],a[1])-z6,c=Math.max(a[0],a[1])+z6,i=r(s[0]),f=r(s[n-1]);(i<o||i>c||f<o||f>c)&&r.domain([s[0],s[n-1]])}},h4e=function(r,s){if(!r)return null;for(var n=0,a=r.length;n<a;n++)if(r[n].item===s)return r[n].position;return null},m4e=function(r,s){if(!s||s.length!==2||!cr(s[0])||!cr(s[1]))return r;var n=Math.min(s[0],s[1]),a=Math.max(s[0],s[1]),o=[r[0],r[1]];return(!cr(r[0])||r[0]<n)&&(o[0]=n),(!cr(r[1])||r[1]>a)&&(o[1]=a),o[0]>a&&(o[0]=a),o[1]<n&&(o[1]=n),o},f4e=function(r){var s=r.length;if(!(s<=0))for(var n=0,a=r[0].length;n<a;++n)for(var o=0,c=0,i=0;i<s;++i){var f=Cv(r[i][n][1])?r[i][n][0]:r[i][n][1];f>=0?(r[i][n][0]=o,r[i][n][1]=o+f,o=r[i][n][1]):(r[i][n][0]=c,r[i][n][1]=c+f,c=r[i][n][1])}},p4e=function(r){var s=r.length;if(!(s<=0))for(var n=0,a=r[0].length;n<a;++n)for(var o=0,c=0;c<s;++c){var i=Cv(r[c][n][1])?r[c][n][0]:r[c][n][1];i>=0?(r[c][n][0]=o,r[c][n][1]=o+i,o=r[c][n][1]):(r[c][n][0]=0,r[c][n][1]=0)}},x4e={sign:f4e,expand:Dbe,none:ky,silhouette:Rbe,wiggle:Lbe,positive:p4e},g4e=function(r,s,n){var a=s.map(function(i){return i.props.dataKey}),o=x4e[n],c=Ibe().keys(a).value(function(i,f){return+da(i,f,0)}).order(KM).offset(o);return c(r)},y4e=function(r,s,n,a,o,c){if(!r)return null;var i=c?s.reverse():s,f={},p=i.reduce(function(y,b){var w,T=(w=b.type)!==null&&w!==void 0&&w.defaultProps?_a(_a({},b.type.defaultProps),b.props):b.props,N=T.stackId,M=T.hide;if(M)return y;var O=T[n],C=y[O]||{hasStack:!1,stackGroups:{}};if(di(N)){var D=C.stackGroups[N]||{numericAxisId:n,cateAxisId:a,items:[]};D.items.push(b),C.hasStack=!0,C.stackGroups[N]=D}else C.stackGroups[qp("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[b]};return _a(_a({},y),{},Wg({},O,C))},f),g={};return Object.keys(p).reduce(function(y,b){var w=p[b];if(w.hasStack){var T={};w.stackGroups=Object.keys(w.stackGroups).reduce(function(N,M){var O=w.stackGroups[M];return _a(_a({},N),{},Wg({},M,{numericAxisId:n,cateAxisId:a,items:O.items,stackedData:g4e(r,O.items,o)}))},T)}return _a(_a({},y),{},Wg({},b,w))},g)},dY=function(r,s){var n=s.realScaleType,a=s.type,o=s.tickCount,c=s.originalDomain,i=s.allowDecimals,f=n||s.scale;if(f!=="auto"&&f!=="linear")return null;if(o&&a==="number"&&c&&(c[0]==="auto"||c[1]==="auto")){var p=r.domain();if(!p.length)return null;var g=MMe(p,o,i);return r.domain([SP(g),nm(g)]),{niceTicks:g}}if(o&&a==="number"){var y=r.domain(),b=OMe(y,o,i);return{niceTicks:b}}return null};function j2(t){var r=t.axis,s=t.ticks,n=t.bandSize,a=t.entry,o=t.index,c=t.dataKey;if(r.type==="category"){if(!r.allowDuplicatedCategory&&r.dataKey&&!ts(a[r.dataKey])){var i=GS(s,"value",a[r.dataKey]);if(i)return i.coordinate+n/2}return s[o]?s[o].coordinate+n/2:null}var f=da(a,ts(c)?r.dataKey:c);return ts(f)?null:r.scale(f)}var B6=function(r){var s=r.axis,n=r.ticks,a=r.offset,o=r.bandSize,c=r.entry,i=r.index;if(s.type==="category")return n[i]?n[i].coordinate+a:null;var f=da(c,s.dataKey,s.domain[i]);return ts(f)?null:s.scale(f)-o/2+a},v4e=function(r){var s=r.numericAxis,n=s.scale.domain();if(s.type==="number"){var a=Math.min(n[0],n[1]),o=Math.max(n[0],n[1]);return a<=0&&o>=0?0:o<0?o:a}return n[0]},j4e=function(r,s){var n,a=(n=r.type)!==null&&n!==void 0&&n.defaultProps?_a(_a({},r.type.defaultProps),r.props):r.props,o=a.stackId;if(di(o)){var c=s[o];if(c){var i=c.items.indexOf(r);return i>=0?c.stackedData[i]:null}}return null},b4e=function(r){return r.reduce(function(s,n){return[SP(n.concat([s[0]]).filter(cr)),nm(n.concat([s[1]]).filter(cr))]},[1/0,-1/0])},uY=function(r,s,n){return Object.keys(r).reduce(function(a,o){var c=r[o],i=c.stackedData,f=i.reduce(function(p,g){var y=b4e(g.slice(s,n+1));return[Math.min(p[0],y[0]),Math.max(p[1],y[1])]},[1/0,-1/0]);return[Math.min(f[0],a[0]),Math.max(f[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},q6=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,V6=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,w4=function(r,s,n){if(Wr(r))return r(s,n);if(!Array.isArray(r))return s;var a=[];if(cr(r[0]))a[0]=n?r[0]:Math.min(r[0],s[0]);else if(q6.test(r[0])){var o=+q6.exec(r[0])[1];a[0]=s[0]-o}else Wr(r[0])?a[0]=r[0](s[0]):a[0]=s[0];if(cr(r[1]))a[1]=n?r[1]:Math.max(r[1],s[1]);else if(V6.test(r[1])){var c=+V6.exec(r[1])[1];a[1]=s[1]+c}else Wr(r[1])?a[1]=r[1](s[1]):a[1]=s[1];return a},b2=function(r,s,n){if(r&&r.scale&&r.scale.bandwidth){var a=r.scale.bandwidth();if(!n||a>0)return a}if(r&&s&&s.length>=2){for(var o=DD(s,function(y){return y.coordinate}),c=1/0,i=1,f=o.length;i<f;i++){var p=o[i],g=o[i-1];c=Math.min((p.coordinate||0)-(g.coordinate||0),c)}return c===1/0?0:c}return n?void 0:0},U6=function(r,s,n){return!r||!r.length||Mm(r,vl(n,"type.defaultProps.domain"))?s:r},hY=function(r,s){var n=r.type.defaultProps?_a(_a({},r.type.defaultProps),r.props):r.props,a=n.dataKey,o=n.name,c=n.unit,i=n.formatter,f=n.tooltipType,p=n.chartType,g=n.hide;return _a(_a({},Or(r,!1)),{},{dataKey:a,unit:c,formatter:i,name:o||a,color:oR(r),value:da(s,a),type:f,payload:s,chartType:p,hide:g})};function Hb(t){"@babel/helpers - typeof";return Hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Hb(t)}function W6(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function vu(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?W6(Object(s),!0).forEach(function(n){mY(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):W6(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function mY(t,r,s){return r=_4e(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function _4e(t){var r=w4e(t,"string");return Hb(r)=="symbol"?r:r+""}function w4e(t,r){if(Hb(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Hb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function N4e(t,r){return k4e(t)||P4e(t,r)||C4e(t,r)||S4e()}function S4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function C4e(t,r){if(t){if(typeof t=="string")return G6(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return G6(t,r)}}function G6(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function P4e(t,r){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var n,a,o,c,i=[],f=!0,p=!1;try{if(o=(s=s.call(t)).next,r!==0)for(;!(f=(n=o.call(s)).done)&&(i.push(n.value),i.length!==r);f=!0);}catch(g){p=!0,a=g}finally{try{if(!f&&s.return!=null&&(c=s.return(),Object(c)!==c))return}finally{if(p)throw a}}return i}}function k4e(t){if(Array.isArray(t))return t}var _2=Math.PI/180,A4e=function(r){return r*180/Math.PI},sn=function(r,s,n,a){return{x:r+Math.cos(-_2*a)*n,y:s+Math.sin(-_2*a)*n}},fY=function(r,s){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(r-(n.left||0)-(n.right||0)),Math.abs(s-(n.top||0)-(n.bottom||0)))/2},pY=function(r,s,n,a,o){var c=r.width,i=r.height,f=r.startAngle,p=r.endAngle,g=No(r.cx,c,c/2),y=No(r.cy,i,i/2),b=fY(c,i,n),w=No(r.innerRadius,b,0),T=No(r.outerRadius,b,b*.8),N=Object.keys(s);return N.reduce(function(M,O){var C=s[O],D=C.domain,L=C.reversed,F;if(ts(C.range))a==="angleAxis"?F=[f,p]:a==="radiusAxis"&&(F=[w,T]),L&&(F=[F[1],F[0]]);else{F=C.range;var B=F,U=N4e(B,2);f=U[0],p=U[1]}var te=lY(C,o),Q=te.realScaleType,re=te.scale;re.domain(D).range(F),cY(re);var Z=dY(re,vu(vu({},C),{},{realScaleType:Q})),ne=vu(vu(vu({},C),Z),{},{range:F,radius:T,realScaleType:Q,scale:re,cx:g,cy:y,innerRadius:w,outerRadius:T,startAngle:f,endAngle:p});return vu(vu({},M),{},mY({},O,ne))},{})},T4e=function(r,s){var n=r.x,a=r.y,o=s.x,c=s.y;return Math.sqrt(Math.pow(n-o,2)+Math.pow(a-c,2))},E4e=function(r,s){var n=r.x,a=r.y,o=s.cx,c=s.cy,i=T4e({x:n,y:a},{x:o,y:c});if(i<=0)return{radius:i};var f=(n-o)/i,p=Math.acos(f);return a>c&&(p=2*Math.PI-p),{radius:i,angle:A4e(p),angleInRadian:p}},M4e=function(r){var s=r.startAngle,n=r.endAngle,a=Math.floor(s/360),o=Math.floor(n/360),c=Math.min(a,o);return{startAngle:s-c*360,endAngle:n-c*360}},O4e=function(r,s){var n=s.startAngle,a=s.endAngle,o=Math.floor(n/360),c=Math.floor(a/360),i=Math.min(o,c);return r+i*360},K6=function(r,s){var n=r.x,a=r.y,o=E4e({x:n,y:a},s),c=o.radius,i=o.angle,f=s.innerRadius,p=s.outerRadius;if(c<f||c>p)return!1;if(c===0)return!0;var g=M4e(s),y=g.startAngle,b=g.endAngle,w=i,T;if(y<=b){for(;w>b;)w-=360;for(;w<y;)w+=360;T=w>=y&&w<=b}else{for(;w>y;)w-=360;for(;w<b;)w+=360;T=w>=b&&w<=y}return T?vu(vu({},s),{},{radius:c,angle:O4e(w,s)}):null},xY=function(r){return!A.isValidElement(r)&&!Wr(r)&&typeof r!="boolean"?r.className:""};function Zb(t){"@babel/helpers - typeof";return Zb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Zb(t)}var I4e=["offset"];function D4e(t){return $4e(t)||F4e(t)||L4e(t)||R4e()}function R4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function L4e(t,r){if(t){if(typeof t=="string")return N4(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return N4(t,r)}}function F4e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function $4e(t){if(Array.isArray(t))return N4(t)}function N4(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function z4e(t,r){if(t==null)return{};var s=B4e(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function B4e(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function H6(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function si(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?H6(Object(s),!0).forEach(function(n){q4e(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):H6(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function q4e(t,r,s){return r=V4e(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function V4e(t){var r=U4e(t,"string");return Zb(r)=="symbol"?r:r+""}function U4e(t,r){if(Zb(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Zb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function Yb(){return Yb=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},Yb.apply(this,arguments)}var W4e=function(r){var s=r.value,n=r.formatter,a=ts(r.children)?s:r.children;return Wr(n)?n(a):a},G4e=function(r,s){var n=wo(s-r),a=Math.min(Math.abs(s-r),360);return n*a},K4e=function(r,s,n){var a=r.position,o=r.viewBox,c=r.offset,i=r.className,f=o,p=f.cx,g=f.cy,y=f.innerRadius,b=f.outerRadius,w=f.startAngle,T=f.endAngle,N=f.clockWise,M=(y+b)/2,O=G4e(w,T),C=O>=0?1:-1,D,L;a==="insideStart"?(D=w+C*c,L=N):a==="insideEnd"?(D=T-C*c,L=!N):a==="end"&&(D=T+C*c,L=N),L=O<=0?L:!L;var F=sn(p,g,M,D),B=sn(p,g,M,D+(L?1:-1)*359),U="M".concat(F.x,",").concat(F.y,`
    A`).concat(M,",").concat(M,",0,1,").concat(L?0:1,`,
    `).concat(B.x,",").concat(B.y),te=ts(r.id)?qp("recharts-radial-line-"):r.id;return je.createElement("text",Yb({},n,{dominantBaseline:"central",className:rs("recharts-radial-bar-label",i)}),je.createElement("defs",null,je.createElement("path",{id:te,d:U})),je.createElement("textPath",{xlinkHref:"#".concat(te)},s))},H4e=function(r){var s=r.viewBox,n=r.offset,a=r.position,o=s,c=o.cx,i=o.cy,f=o.innerRadius,p=o.outerRadius,g=o.startAngle,y=o.endAngle,b=(g+y)/2;if(a==="outside"){var w=sn(c,i,p+n,b),T=w.x,N=w.y;return{x:T,y:N,textAnchor:T>=c?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:c,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:c,y:i,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:c,y:i,textAnchor:"middle",verticalAnchor:"end"};var M=(f+p)/2,O=sn(c,i,M,b),C=O.x,D=O.y;return{x:C,y:D,textAnchor:"middle",verticalAnchor:"middle"}},Z4e=function(r){var s=r.viewBox,n=r.parentViewBox,a=r.offset,o=r.position,c=s,i=c.x,f=c.y,p=c.width,g=c.height,y=g>=0?1:-1,b=y*a,w=y>0?"end":"start",T=y>0?"start":"end",N=p>=0?1:-1,M=N*a,O=N>0?"end":"start",C=N>0?"start":"end";if(o==="top"){var D={x:i+p/2,y:f-y*a,textAnchor:"middle",verticalAnchor:w};return si(si({},D),n?{height:Math.max(f-n.y,0),width:p}:{})}if(o==="bottom"){var L={x:i+p/2,y:f+g+b,textAnchor:"middle",verticalAnchor:T};return si(si({},L),n?{height:Math.max(n.y+n.height-(f+g),0),width:p}:{})}if(o==="left"){var F={x:i-M,y:f+g/2,textAnchor:O,verticalAnchor:"middle"};return si(si({},F),n?{width:Math.max(F.x-n.x,0),height:g}:{})}if(o==="right"){var B={x:i+p+M,y:f+g/2,textAnchor:C,verticalAnchor:"middle"};return si(si({},B),n?{width:Math.max(n.x+n.width-B.x,0),height:g}:{})}var U=n?{width:p,height:g}:{};return o==="insideLeft"?si({x:i+M,y:f+g/2,textAnchor:C,verticalAnchor:"middle"},U):o==="insideRight"?si({x:i+p-M,y:f+g/2,textAnchor:O,verticalAnchor:"middle"},U):o==="insideTop"?si({x:i+p/2,y:f+b,textAnchor:"middle",verticalAnchor:T},U):o==="insideBottom"?si({x:i+p/2,y:f+g-b,textAnchor:"middle",verticalAnchor:w},U):o==="insideTopLeft"?si({x:i+M,y:f+b,textAnchor:C,verticalAnchor:T},U):o==="insideTopRight"?si({x:i+p-M,y:f+b,textAnchor:O,verticalAnchor:T},U):o==="insideBottomLeft"?si({x:i+M,y:f+g-b,textAnchor:C,verticalAnchor:w},U):o==="insideBottomRight"?si({x:i+p-M,y:f+g-b,textAnchor:O,verticalAnchor:w},U):_v(o)&&(cr(o.x)||Zf(o.x))&&(cr(o.y)||Zf(o.y))?si({x:i+No(o.x,p),y:f+No(o.y,g),textAnchor:"end",verticalAnchor:"end"},U):si({x:i+p/2,y:f+g/2,textAnchor:"middle",verticalAnchor:"middle"},U)},Y4e=function(r){return"cx"in r&&cr(r.cx)};function wi(t){var r=t.offset,s=r===void 0?5:r,n=z4e(t,I4e),a=si({offset:s},n),o=a.viewBox,c=a.position,i=a.value,f=a.children,p=a.content,g=a.className,y=g===void 0?"":g,b=a.textBreakAll;if(!o||ts(i)&&ts(f)&&!A.isValidElement(p)&&!Wr(p))return null;if(A.isValidElement(p))return A.cloneElement(p,a);var w;if(Wr(p)){if(w=A.createElement(p,a),A.isValidElement(w))return w}else w=W4e(a);var T=Y4e(o),N=Or(a,!0);if(T&&(c==="insideStart"||c==="insideEnd"||c==="end"))return K4e(a,w,N);var M=T?H4e(a):Z4e(a);return je.createElement(Ep,Yb({className:rs("recharts-label",y)},N,M,{breakAll:b}),w)}wi.displayName="Label";var gY=function(r){var s=r.cx,n=r.cy,a=r.angle,o=r.startAngle,c=r.endAngle,i=r.r,f=r.radius,p=r.innerRadius,g=r.outerRadius,y=r.x,b=r.y,w=r.top,T=r.left,N=r.width,M=r.height,O=r.clockWise,C=r.labelViewBox;if(C)return C;if(cr(N)&&cr(M)){if(cr(y)&&cr(b))return{x:y,y:b,width:N,height:M};if(cr(w)&&cr(T))return{x:w,y:T,width:N,height:M}}return cr(y)&&cr(b)?{x:y,y:b,width:0,height:0}:cr(s)&&cr(n)?{cx:s,cy:n,startAngle:o||a||0,endAngle:c||a||0,innerRadius:p||0,outerRadius:g||f||i||0,clockWise:O}:r.viewBox?r.viewBox:{}},X4e=function(r,s){return r?r===!0?je.createElement(wi,{key:"label-implicit",viewBox:s}):di(r)?je.createElement(wi,{key:"label-implicit",viewBox:s,value:r}):A.isValidElement(r)?r.type===wi?A.cloneElement(r,{key:"label-implicit",viewBox:s}):je.createElement(wi,{key:"label-implicit",content:r,viewBox:s}):Wr(r)?je.createElement(wi,{key:"label-implicit",content:r,viewBox:s}):_v(r)?je.createElement(wi,Yb({viewBox:s},r,{key:"label-implicit"})):null:null},Q4e=function(r,s){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!r||!r.children&&n&&!r.label)return null;var a=r.children,o=gY(r),c=jl(a,wi).map(function(f,p){return A.cloneElement(f,{viewBox:s||o,key:"label-".concat(p)})});if(!n)return c;var i=X4e(r.label,s||o);return[i].concat(D4e(c))};wi.parseViewBox=gY;wi.renderCallByParent=Q4e;function J4e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}var eOe=J4e;const yY=tn(eOe);function Xb(t){"@babel/helpers - typeof";return Xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Xb(t)}var tOe=["valueAccessor"],rOe=["data","dataKey","clockWise","id","textBreakAll"];function sOe(t){return oOe(t)||iOe(t)||aOe(t)||nOe()}function nOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aOe(t,r){if(t){if(typeof t=="string")return S4(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return S4(t,r)}}function iOe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function oOe(t){if(Array.isArray(t))return S4(t)}function S4(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function w2(){return w2=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},w2.apply(this,arguments)}function Z6(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function Y6(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?Z6(Object(s),!0).forEach(function(n){lOe(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Z6(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function lOe(t,r,s){return r=cOe(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function cOe(t){var r=dOe(t,"string");return Xb(r)=="symbol"?r:r+""}function dOe(t,r){if(Xb(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Xb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function X6(t,r){if(t==null)return{};var s=uOe(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function uOe(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}var hOe=function(r){return Array.isArray(r.value)?yY(r.value):r.value};function Wc(t){var r=t.valueAccessor,s=r===void 0?hOe:r,n=X6(t,tOe),a=n.data,o=n.dataKey,c=n.clockWise,i=n.id,f=n.textBreakAll,p=X6(n,rOe);return!a||!a.length?null:je.createElement(_s,{className:"recharts-label-list"},a.map(function(g,y){var b=ts(o)?s(g,y):da(g&&g.payload,o),w=ts(i)?{}:{id:"".concat(i,"-").concat(y)};return je.createElement(wi,w2({},Or(g,!0),p,w,{parentViewBox:g.parentViewBox,value:b,textBreakAll:f,viewBox:wi.parseViewBox(ts(c)?g:Y6(Y6({},g),{},{clockWise:c})),key:"label-".concat(y),index:y}))}))}Wc.displayName="LabelList";function mOe(t,r){return t?t===!0?je.createElement(Wc,{key:"labelList-implicit",data:r}):je.isValidElement(t)||Wr(t)?je.createElement(Wc,{key:"labelList-implicit",data:r,content:t}):_v(t)?je.createElement(Wc,w2({data:r},t,{key:"labelList-implicit"})):null:null}function fOe(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&s&&!t.label)return null;var n=t.children,a=jl(n,Wc).map(function(c,i){return A.cloneElement(c,{data:r,key:"labelList-".concat(i)})});if(!s)return a;var o=mOe(t.label,r);return[o].concat(sOe(a))}Wc.renderCallByParent=fOe;function Qb(t){"@babel/helpers - typeof";return Qb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Qb(t)}function C4(){return C4=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},C4.apply(this,arguments)}function Q6(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function J6(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?Q6(Object(s),!0).forEach(function(n){pOe(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Q6(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function pOe(t,r,s){return r=xOe(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function xOe(t){var r=gOe(t,"string");return Qb(r)=="symbol"?r:r+""}function gOe(t,r){if(Qb(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Qb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var yOe=function(r,s){var n=wo(s-r),a=Math.min(Math.abs(s-r),359.999);return n*a},vN=function(r){var s=r.cx,n=r.cy,a=r.radius,o=r.angle,c=r.sign,i=r.isExternal,f=r.cornerRadius,p=r.cornerIsExternal,g=f*(i?1:-1)+a,y=Math.asin(f/g)/_2,b=p?o:o+c*y,w=sn(s,n,g,b),T=sn(s,n,a,b),N=p?o-c*y:o,M=sn(s,n,g*Math.cos(y*_2),N);return{center:w,circleTangency:T,lineTangency:M,theta:y}},vY=function(r){var s=r.cx,n=r.cy,a=r.innerRadius,o=r.outerRadius,c=r.startAngle,i=r.endAngle,f=yOe(c,i),p=c+f,g=sn(s,n,o,c),y=sn(s,n,o,p),b="M ".concat(g.x,",").concat(g.y,`
    A `).concat(o,",").concat(o,`,0,
    `).concat(+(Math.abs(f)>180),",").concat(+(c>p),`,
    `).concat(y.x,",").concat(y.y,`
  `);if(a>0){var w=sn(s,n,a,c),T=sn(s,n,a,p);b+="L ".concat(T.x,",").concat(T.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(f)>180),",").concat(+(c<=p),`,
            `).concat(w.x,",").concat(w.y," Z")}else b+="L ".concat(s,",").concat(n," Z");return b},vOe=function(r){var s=r.cx,n=r.cy,a=r.innerRadius,o=r.outerRadius,c=r.cornerRadius,i=r.forceCornerRadius,f=r.cornerIsExternal,p=r.startAngle,g=r.endAngle,y=wo(g-p),b=vN({cx:s,cy:n,radius:o,angle:p,sign:y,cornerRadius:c,cornerIsExternal:f}),w=b.circleTangency,T=b.lineTangency,N=b.theta,M=vN({cx:s,cy:n,radius:o,angle:g,sign:-y,cornerRadius:c,cornerIsExternal:f}),O=M.circleTangency,C=M.lineTangency,D=M.theta,L=f?Math.abs(p-g):Math.abs(p-g)-N-D;if(L<0)return i?"M ".concat(T.x,",").concat(T.y,`
        a`).concat(c,",").concat(c,",0,0,1,").concat(c*2,`,0
        a`).concat(c,",").concat(c,",0,0,1,").concat(-c*2,`,0
      `):vY({cx:s,cy:n,innerRadius:a,outerRadius:o,startAngle:p,endAngle:g});var F="M ".concat(T.x,",").concat(T.y,`
    A`).concat(c,",").concat(c,",0,0,").concat(+(y<0),",").concat(w.x,",").concat(w.y,`
    A`).concat(o,",").concat(o,",0,").concat(+(L>180),",").concat(+(y<0),",").concat(O.x,",").concat(O.y,`
    A`).concat(c,",").concat(c,",0,0,").concat(+(y<0),",").concat(C.x,",").concat(C.y,`
  `);if(a>0){var B=vN({cx:s,cy:n,radius:a,angle:p,sign:y,isExternal:!0,cornerRadius:c,cornerIsExternal:f}),U=B.circleTangency,te=B.lineTangency,Q=B.theta,re=vN({cx:s,cy:n,radius:a,angle:g,sign:-y,isExternal:!0,cornerRadius:c,cornerIsExternal:f}),Z=re.circleTangency,ne=re.lineTangency,oe=re.theta,Ce=f?Math.abs(p-g):Math.abs(p-g)-Q-oe;if(Ce<0&&c===0)return"".concat(F,"L").concat(s,",").concat(n,"Z");F+="L".concat(ne.x,",").concat(ne.y,`
      A`).concat(c,",").concat(c,",0,0,").concat(+(y<0),",").concat(Z.x,",").concat(Z.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(Ce>180),",").concat(+(y>0),",").concat(U.x,",").concat(U.y,`
      A`).concat(c,",").concat(c,",0,0,").concat(+(y<0),",").concat(te.x,",").concat(te.y,"Z")}else F+="L".concat(s,",").concat(n,"Z");return F},jOe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},jY=function(r){var s=J6(J6({},jOe),r),n=s.cx,a=s.cy,o=s.innerRadius,c=s.outerRadius,i=s.cornerRadius,f=s.forceCornerRadius,p=s.cornerIsExternal,g=s.startAngle,y=s.endAngle,b=s.className;if(c<o||g===y)return null;var w=rs("recharts-sector",b),T=c-o,N=No(i,T,0,!0),M;return N>0&&Math.abs(g-y)<360?M=vOe({cx:n,cy:a,innerRadius:o,outerRadius:c,cornerRadius:Math.min(N,T/2),forceCornerRadius:f,cornerIsExternal:p,startAngle:g,endAngle:y}):M=vY({cx:n,cy:a,innerRadius:o,outerRadius:c,startAngle:g,endAngle:y}),je.createElement("path",C4({},Or(s,!0),{className:w,d:M,role:"img"}))};function Jb(t){"@babel/helpers - typeof";return Jb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Jb(t)}function P4(){return P4=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},P4.apply(this,arguments)}function eB(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function tB(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?eB(Object(s),!0).forEach(function(n){bOe(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):eB(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function bOe(t,r,s){return r=_Oe(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function _Oe(t){var r=wOe(t,"string");return Jb(r)=="symbol"?r:r+""}function wOe(t,r){if(Jb(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Jb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var rB={curveBasisClosed:wbe,curveBasisOpen:Nbe,curveBasis:_be,curveBumpX:lbe,curveBumpY:cbe,curveLinearClosed:Sbe,curveLinear:mP,curveMonotoneX:Cbe,curveMonotoneY:Pbe,curveNatural:kbe,curveStep:Abe,curveStepAfter:Ebe,curveStepBefore:Tbe},jN=function(r){return r.x===+r.x&&r.y===+r.y},v0=function(r){return r.x},j0=function(r){return r.y},NOe=function(r,s){if(Wr(r))return r;var n="curve".concat(uP(r));return(n==="curveMonotone"||n==="curveBump")&&s?rB["".concat(n).concat(s==="vertical"?"Y":"X")]:rB[n]||mP},SOe=function(r){var s=r.type,n=s===void 0?"linear":s,a=r.points,o=a===void 0?[]:a,c=r.baseLine,i=r.layout,f=r.connectNulls,p=f===void 0?!1:f,g=NOe(n,i),y=p?o.filter(function(N){return jN(N)}):o,b;if(Array.isArray(c)){var w=p?c.filter(function(N){return jN(N)}):c,T=y.map(function(N,M){return tB(tB({},N),{},{base:w[M]})});return i==="vertical"?b=dN().y(j0).x1(v0).x0(function(N){return N.base.x}):b=dN().x(v0).y1(j0).y0(function(N){return N.base.y}),b.defined(jN).curve(g),b(T)}return i==="vertical"&&cr(c)?b=dN().y(j0).x1(v0).x0(c):cr(c)?b=dN().x(v0).y1(j0).y0(c):b=hH().x(v0).y(j0),b.defined(jN).curve(g),b(y)},hp=function(r){var s=r.className,n=r.points,a=r.path,o=r.pathRef;if((!n||!n.length)&&!a)return null;var c=n&&n.length?SOe(r):a;return je.createElement("path",P4({},Or(r,!1),KS(r),{className:rs("recharts-curve",s),d:c,ref:o}))},bY={exports:{}},COe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",POe=COe,kOe=POe;function _Y(){}function wY(){}wY.resetWarningCache=_Y;var AOe=function(){function t(n,a,o,c,i,f){if(f!==kOe){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}t.isRequired=t;function r(){return t}var s={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:r,element:t,elementType:t,instanceOf:r,node:t,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:wY,resetWarningCache:_Y};return s.PropTypes=s,s};bY.exports=AOe();var TOe=bY.exports;const vs=tn(TOe);var EOe=Object.getOwnPropertyNames,MOe=Object.getOwnPropertySymbols,OOe=Object.prototype.hasOwnProperty;function sB(t,r){return function(n,a,o){return t(n,a,o)&&r(n,a,o)}}function bN(t){return function(s,n,a){if(!s||!n||typeof s!="object"||typeof n!="object")return t(s,n,a);var o=a.cache,c=o.get(s),i=o.get(n);if(c&&i)return c===n&&i===s;o.set(s,n),o.set(n,s);var f=t(s,n,a);return o.delete(s),o.delete(n),f}}function nB(t){return EOe(t).concat(MOe(t))}var NY=Object.hasOwn||function(t,r){return OOe.call(t,r)};function Ov(t,r){return t||r?t===r:t===r||t!==t&&r!==r}var SY="_owner",aB=Object.getOwnPropertyDescriptor,iB=Object.keys;function IOe(t,r,s){var n=t.length;if(r.length!==n)return!1;for(;n-- >0;)if(!s.equals(t[n],r[n],n,n,t,r,s))return!1;return!0}function DOe(t,r){return Ov(t.getTime(),r.getTime())}function oB(t,r,s){if(t.size!==r.size)return!1;for(var n={},a=t.entries(),o=0,c,i;(c=a.next())&&!c.done;){for(var f=r.entries(),p=!1,g=0;(i=f.next())&&!i.done;){var y=c.value,b=y[0],w=y[1],T=i.value,N=T[0],M=T[1];!p&&!n[g]&&(p=s.equals(b,N,o,g,t,r,s)&&s.equals(w,M,b,N,t,r,s))&&(n[g]=!0),g++}if(!p)return!1;o++}return!0}function ROe(t,r,s){var n=iB(t),a=n.length;if(iB(r).length!==a)return!1;for(var o;a-- >0;)if(o=n[a],o===SY&&(t.$$typeof||r.$$typeof)&&t.$$typeof!==r.$$typeof||!NY(r,o)||!s.equals(t[o],r[o],o,o,t,r,s))return!1;return!0}function b0(t,r,s){var n=nB(t),a=n.length;if(nB(r).length!==a)return!1;for(var o,c,i;a-- >0;)if(o=n[a],o===SY&&(t.$$typeof||r.$$typeof)&&t.$$typeof!==r.$$typeof||!NY(r,o)||!s.equals(t[o],r[o],o,o,t,r,s)||(c=aB(t,o),i=aB(r,o),(c||i)&&(!c||!i||c.configurable!==i.configurable||c.enumerable!==i.enumerable||c.writable!==i.writable)))return!1;return!0}function LOe(t,r){return Ov(t.valueOf(),r.valueOf())}function FOe(t,r){return t.source===r.source&&t.flags===r.flags}function lB(t,r,s){if(t.size!==r.size)return!1;for(var n={},a=t.values(),o,c;(o=a.next())&&!o.done;){for(var i=r.values(),f=!1,p=0;(c=i.next())&&!c.done;)!f&&!n[p]&&(f=s.equals(o.value,c.value,o.value,c.value,t,r,s))&&(n[p]=!0),p++;if(!f)return!1}return!0}function $Oe(t,r){var s=t.length;if(r.length!==s)return!1;for(;s-- >0;)if(t[s]!==r[s])return!1;return!0}var zOe="[object Arguments]",BOe="[object Boolean]",qOe="[object Date]",VOe="[object Map]",UOe="[object Number]",WOe="[object Object]",GOe="[object RegExp]",KOe="[object Set]",HOe="[object String]",ZOe=Array.isArray,cB=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,dB=Object.assign,YOe=Object.prototype.toString.call.bind(Object.prototype.toString);function XOe(t){var r=t.areArraysEqual,s=t.areDatesEqual,n=t.areMapsEqual,a=t.areObjectsEqual,o=t.arePrimitiveWrappersEqual,c=t.areRegExpsEqual,i=t.areSetsEqual,f=t.areTypedArraysEqual;return function(g,y,b){if(g===y)return!0;if(g==null||y==null||typeof g!="object"||typeof y!="object")return g!==g&&y!==y;var w=g.constructor;if(w!==y.constructor)return!1;if(w===Object)return a(g,y,b);if(ZOe(g))return r(g,y,b);if(cB!=null&&cB(g))return f(g,y,b);if(w===Date)return s(g,y,b);if(w===RegExp)return c(g,y,b);if(w===Map)return n(g,y,b);if(w===Set)return i(g,y,b);var T=YOe(g);return T===qOe?s(g,y,b):T===GOe?c(g,y,b):T===VOe?n(g,y,b):T===KOe?i(g,y,b):T===WOe?typeof g.then!="function"&&typeof y.then!="function"&&a(g,y,b):T===zOe?a(g,y,b):T===BOe||T===UOe||T===HOe?o(g,y,b):!1}}function QOe(t){var r=t.circular,s=t.createCustomConfig,n=t.strict,a={areArraysEqual:n?b0:IOe,areDatesEqual:DOe,areMapsEqual:n?sB(oB,b0):oB,areObjectsEqual:n?b0:ROe,arePrimitiveWrappersEqual:LOe,areRegExpsEqual:FOe,areSetsEqual:n?sB(lB,b0):lB,areTypedArraysEqual:n?b0:$Oe};if(s&&(a=dB({},a,s(a))),r){var o=bN(a.areArraysEqual),c=bN(a.areMapsEqual),i=bN(a.areObjectsEqual),f=bN(a.areSetsEqual);a=dB({},a,{areArraysEqual:o,areMapsEqual:c,areObjectsEqual:i,areSetsEqual:f})}return a}function JOe(t){return function(r,s,n,a,o,c,i){return t(r,s,i)}}function eIe(t){var r=t.circular,s=t.comparator,n=t.createState,a=t.equals,o=t.strict;if(n)return function(f,p){var g=n(),y=g.cache,b=y===void 0?r?new WeakMap:void 0:y,w=g.meta;return s(f,p,{cache:b,equals:a,meta:w,strict:o})};if(r)return function(f,p){return s(f,p,{cache:new WeakMap,equals:a,meta:void 0,strict:o})};var c={cache:void 0,equals:a,meta:void 0,strict:o};return function(f,p){return s(f,p,c)}}var tIe=Gm();Gm({strict:!0});Gm({circular:!0});Gm({circular:!0,strict:!0});Gm({createInternalComparator:function(){return Ov}});Gm({strict:!0,createInternalComparator:function(){return Ov}});Gm({circular:!0,createInternalComparator:function(){return Ov}});Gm({circular:!0,createInternalComparator:function(){return Ov},strict:!0});function Gm(t){t===void 0&&(t={});var r=t.circular,s=r===void 0?!1:r,n=t.createInternalComparator,a=t.createState,o=t.strict,c=o===void 0?!1:o,i=QOe(t),f=XOe(i),p=n?n(f):JOe(f);return eIe({circular:s,comparator:f,createState:a,equals:p,strict:c})}function rIe(t){typeof requestAnimationFrame<"u"&&requestAnimationFrame(t)}function uB(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=-1,n=function a(o){s<0&&(s=o),o-s>r?(t(o),s=-1):rIe(a)};requestAnimationFrame(n)}function k4(t){"@babel/helpers - typeof";return k4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},k4(t)}function sIe(t){return oIe(t)||iIe(t)||aIe(t)||nIe()}function nIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aIe(t,r){if(t){if(typeof t=="string")return hB(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return hB(t,r)}}function hB(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function iIe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function oIe(t){if(Array.isArray(t))return t}function lIe(){var t={},r=function(){return null},s=!1,n=function a(o){if(!s){if(Array.isArray(o)){if(!o.length)return;var c=o,i=sIe(c),f=i[0],p=i.slice(1);if(typeof f=="number"){uB(a.bind(null,p),f);return}a(f),uB(a.bind(null,p));return}k4(o)==="object"&&(t=o,r(t)),typeof o=="function"&&o()}};return{stop:function(){s=!0},start:function(o){s=!1,n(o)},subscribe:function(o){return r=o,function(){r=function(){return null}}}}}function e_(t){"@babel/helpers - typeof";return e_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},e_(t)}function mB(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function fB(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?mB(Object(s),!0).forEach(function(n){CY(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):mB(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function CY(t,r,s){return r=cIe(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function cIe(t){var r=dIe(t,"string");return e_(r)==="symbol"?r:String(r)}function dIe(t,r){if(e_(t)!=="object"||t===null)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(e_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var uIe=function(r,s){return[Object.keys(r),Object.keys(s)].reduce(function(n,a){return n.filter(function(o){return a.includes(o)})})},hIe=function(r){return r},mIe=function(r){return r.replace(/([A-Z])/g,function(s){return"-".concat(s.toLowerCase())})},Z0=function(r,s){return Object.keys(s).reduce(function(n,a){return fB(fB({},n),{},CY({},a,r(a,s[a])))},{})},pB=function(r,s,n){return r.map(function(a){return"".concat(mIe(a)," ").concat(s,"ms ").concat(n)}).join(",")};function fIe(t,r){return gIe(t)||xIe(t,r)||PY(t,r)||pIe()}function pIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xIe(t,r){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var n,a,o,c,i=[],f=!0,p=!1;try{if(o=(s=s.call(t)).next,r!==0)for(;!(f=(n=o.call(s)).done)&&(i.push(n.value),i.length!==r);f=!0);}catch(g){p=!0,a=g}finally{try{if(!f&&s.return!=null&&(c=s.return(),Object(c)!==c))return}finally{if(p)throw a}}return i}}function gIe(t){if(Array.isArray(t))return t}function yIe(t){return bIe(t)||jIe(t)||PY(t)||vIe()}function vIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PY(t,r){if(t){if(typeof t=="string")return A4(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return A4(t,r)}}function jIe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function bIe(t){if(Array.isArray(t))return A4(t)}function A4(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}var N2=1e-4,kY=function(r,s){return[0,3*r,3*s-6*r,3*r-3*s+1]},AY=function(r,s){return r.map(function(n,a){return n*Math.pow(s,a)}).reduce(function(n,a){return n+a})},xB=function(r,s){return function(n){var a=kY(r,s);return AY(a,n)}},_Ie=function(r,s){return function(n){var a=kY(r,s),o=[].concat(yIe(a.map(function(c,i){return c*i}).slice(1)),[0]);return AY(o,n)}},gB=function(){for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];var a=s[0],o=s[1],c=s[2],i=s[3];if(s.length===1)switch(s[0]){case"linear":a=0,o=0,c=1,i=1;break;case"ease":a=.25,o=.1,c=.25,i=1;break;case"ease-in":a=.42,o=0,c=1,i=1;break;case"ease-out":a=.42,o=0,c=.58,i=1;break;case"ease-in-out":a=0,o=0,c=.58,i=1;break;default:{var f=s[0].split("(");if(f[0]==="cubic-bezier"&&f[1].split(")")[0].split(",").length===4){var p=f[1].split(")")[0].split(",").map(function(M){return parseFloat(M)}),g=fIe(p,4);a=g[0],o=g[1],c=g[2],i=g[3]}}}var y=xB(a,c),b=xB(o,i),w=_Ie(a,c),T=function(O){return O>1?1:O<0?0:O},N=function(O){for(var C=O>1?1:O,D=C,L=0;L<8;++L){var F=y(D)-C,B=w(D);if(Math.abs(F-C)<N2||B<N2)return b(D);D=T(D-F/B)}return b(D)};return N.isStepper=!1,N},wIe=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=r.stiff,n=s===void 0?100:s,a=r.damping,o=a===void 0?8:a,c=r.dt,i=c===void 0?17:c,f=function(g,y,b){var w=-(g-y)*n,T=b*o,N=b+(w-T)*i/1e3,M=b*i/1e3+g;return Math.abs(M-y)<N2&&Math.abs(N)<N2?[y,0]:[M,N]};return f.isStepper=!0,f.dt=i,f},NIe=function(){for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];var a=s[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return gB(a);case"spring":return wIe();default:if(a.split("(")[0]==="cubic-bezier")return gB(a)}return typeof a=="function"?a:null};function t_(t){"@babel/helpers - typeof";return t_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},t_(t)}function yB(t){return PIe(t)||CIe(t)||TY(t)||SIe()}function SIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CIe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function PIe(t){if(Array.isArray(t))return E4(t)}function vB(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function $i(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?vB(Object(s),!0).forEach(function(n){T4(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):vB(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function T4(t,r,s){return r=kIe(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function kIe(t){var r=AIe(t,"string");return t_(r)==="symbol"?r:String(r)}function AIe(t,r){if(t_(t)!=="object"||t===null)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(t_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function TIe(t,r){return OIe(t)||MIe(t,r)||TY(t,r)||EIe()}function EIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TY(t,r){if(t){if(typeof t=="string")return E4(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return E4(t,r)}}function E4(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function MIe(t,r){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var n,a,o,c,i=[],f=!0,p=!1;try{if(o=(s=s.call(t)).next,r!==0)for(;!(f=(n=o.call(s)).done)&&(i.push(n.value),i.length!==r);f=!0);}catch(g){p=!0,a=g}finally{try{if(!f&&s.return!=null&&(c=s.return(),Object(c)!==c))return}finally{if(p)throw a}}return i}}function OIe(t){if(Array.isArray(t))return t}var S2=function(r,s,n){return r+(s-r)*n},M4=function(r){var s=r.from,n=r.to;return s!==n},IIe=function t(r,s,n){var a=Z0(function(o,c){if(M4(c)){var i=r(c.from,c.to,c.velocity),f=TIe(i,2),p=f[0],g=f[1];return $i($i({},c),{},{from:p,velocity:g})}return c},s);return n<1?Z0(function(o,c){return M4(c)?$i($i({},c),{},{velocity:S2(c.velocity,a[o].velocity,n),from:S2(c.from,a[o].from,n)}):c},s):t(r,a,n-1)};const DIe=function(t,r,s,n,a){var o=uIe(t,r),c=o.reduce(function(M,O){return $i($i({},M),{},T4({},O,[t[O],r[O]]))},{}),i=o.reduce(function(M,O){return $i($i({},M),{},T4({},O,{from:t[O],velocity:0,to:r[O]}))},{}),f=-1,p,g,y=function(){return null},b=function(){return Z0(function(O,C){return C.from},i)},w=function(){return!Object.values(i).filter(M4).length},T=function(O){p||(p=O);var C=O-p,D=C/s.dt;i=IIe(s,i,D),a($i($i($i({},t),r),b())),p=O,w()||(f=requestAnimationFrame(y))},N=function(O){g||(g=O);var C=(O-g)/n,D=Z0(function(F,B){return S2.apply(void 0,yB(B).concat([s(C)]))},c);if(a($i($i($i({},t),r),D)),C<1)f=requestAnimationFrame(y);else{var L=Z0(function(F,B){return S2.apply(void 0,yB(B).concat([s(1)]))},c);a($i($i($i({},t),r),L))}};return y=s.isStepper?T:N,function(){return requestAnimationFrame(y),function(){cancelAnimationFrame(f)}}};function Ly(t){"@babel/helpers - typeof";return Ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ly(t)}var RIe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function LIe(t,r){if(t==null)return{};var s=FIe(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function FIe(t,r){if(t==null)return{};var s={},n=Object.keys(t),a,o;for(o=0;o<n.length;o++)a=n[o],!(r.indexOf(a)>=0)&&(s[a]=t[a]);return s}function NT(t){return qIe(t)||BIe(t)||zIe(t)||$Ie()}function $Ie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zIe(t,r){if(t){if(typeof t=="string")return O4(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return O4(t,r)}}function BIe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function qIe(t){if(Array.isArray(t))return O4(t)}function O4(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function jB(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function Nc(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?jB(Object(s),!0).forEach(function(n){O0(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):jB(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function O0(t,r,s){return r=EY(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function VIe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function UIe(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,EY(n.key),n)}}function WIe(t,r,s){return r&&UIe(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function EY(t){var r=GIe(t,"string");return Ly(r)==="symbol"?r:String(r)}function GIe(t,r){if(Ly(t)!=="object"||t===null)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Ly(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function KIe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&I4(t,r)}function I4(t,r){return I4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},I4(t,r)}function HIe(t){var r=ZIe();return function(){var n=C2(t),a;if(r){var o=C2(this).constructor;a=Reflect.construct(n,arguments,o)}else a=n.apply(this,arguments);return D4(this,a)}}function D4(t,r){if(r&&(Ly(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return R4(t)}function R4(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ZIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function C2(t){return C2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},C2(t)}var Ql=function(t){KIe(s,t);var r=HIe(s);function s(n,a){var o;VIe(this,s),o=r.call(this,n,a);var c=o.props,i=c.isActive,f=c.attributeName,p=c.from,g=c.to,y=c.steps,b=c.children,w=c.duration;if(o.handleStyleChange=o.handleStyleChange.bind(R4(o)),o.changeStyle=o.changeStyle.bind(R4(o)),!i||w<=0)return o.state={style:{}},typeof b=="function"&&(o.state={style:g}),D4(o);if(y&&y.length)o.state={style:y[0].style};else if(p){if(typeof b=="function")return o.state={style:p},D4(o);o.state={style:f?O0({},f,p):p}}else o.state={style:{}};return o}return WIe(s,[{key:"componentDidMount",value:function(){var a=this.props,o=a.isActive,c=a.canBegin;this.mounted=!0,!(!o||!c)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var o=this.props,c=o.isActive,i=o.canBegin,f=o.attributeName,p=o.shouldReAnimate,g=o.to,y=o.from,b=this.state.style;if(i){if(!c){var w={style:f?O0({},f,g):g};this.state&&b&&(f&&b[f]!==g||!f&&b!==g)&&this.setState(w);return}if(!(tIe(a.to,g)&&a.canBegin&&a.isActive)){var T=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var N=T||p?y:a.to;if(this.state&&b){var M={style:f?O0({},f,N):N};(f&&b[f]!==N||!f&&b!==N)&&this.setState(M)}this.runAnimation(Nc(Nc({},this.props),{},{from:N,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var o=this,c=a.from,i=a.to,f=a.duration,p=a.easing,g=a.begin,y=a.onAnimationEnd,b=a.onAnimationStart,w=DIe(c,i,NIe(p),f,this.changeStyle),T=function(){o.stopJSAnimation=w()};this.manager.start([b,g,T,f,y])}},{key:"runStepAnimation",value:function(a){var o=this,c=a.steps,i=a.begin,f=a.onAnimationStart,p=c[0],g=p.style,y=p.duration,b=y===void 0?0:y,w=function(N,M,O){if(O===0)return N;var C=M.duration,D=M.easing,L=D===void 0?"ease":D,F=M.style,B=M.properties,U=M.onAnimationEnd,te=O>0?c[O-1]:M,Q=B||Object.keys(F);if(typeof L=="function"||L==="spring")return[].concat(NT(N),[o.runJSAnimation.bind(o,{from:te.style,to:F,duration:C,easing:L}),C]);var re=pB(Q,C,L),Z=Nc(Nc(Nc({},te.style),F),{},{transition:re});return[].concat(NT(N),[Z,C,U]).filter(hIe)};return this.manager.start([f].concat(NT(c.reduce(w,[g,Math.max(b,i)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=lIe());var o=a.begin,c=a.duration,i=a.attributeName,f=a.to,p=a.easing,g=a.onAnimationStart,y=a.onAnimationEnd,b=a.steps,w=a.children,T=this.manager;if(this.unSubscribe=T.subscribe(this.handleStyleChange),typeof p=="function"||typeof w=="function"||p==="spring"){this.runJSAnimation(a);return}if(b.length>1){this.runStepAnimation(a);return}var N=i?O0({},i,f):f,M=pB(Object.keys(N),c,p);T.start([g,o,Nc(Nc({},N),{},{transition:M}),c,y])}},{key:"render",value:function(){var a=this.props,o=a.children;a.begin;var c=a.duration;a.attributeName,a.easing;var i=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var f=LIe(a,RIe),p=A.Children.count(o),g=this.state.style;if(typeof o=="function")return o(g);if(!i||p===0||c<=0)return o;var y=function(w){var T=w.props,N=T.style,M=N===void 0?{}:N,O=T.className,C=A.cloneElement(w,Nc(Nc({},f),{},{style:Nc(Nc({},M),g),className:O}));return C};return p===1?y(A.Children.only(o)):je.createElement("div",null,A.Children.map(o,function(b){return y(b)}))}}]),s}(A.PureComponent);Ql.displayName="Animate";Ql.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Ql.propTypes={from:vs.oneOfType([vs.object,vs.string]),to:vs.oneOfType([vs.object,vs.string]),attributeName:vs.string,duration:vs.number,begin:vs.number,easing:vs.oneOfType([vs.string,vs.func]),steps:vs.arrayOf(vs.shape({duration:vs.number.isRequired,style:vs.object.isRequired,easing:vs.oneOfType([vs.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),vs.func]),properties:vs.arrayOf("string"),onAnimationEnd:vs.func})),children:vs.oneOfType([vs.node,vs.func]),isActive:vs.bool,canBegin:vs.bool,onAnimationEnd:vs.func,shouldReAnimate:vs.bool,onAnimationStart:vs.func,onAnimationReStart:vs.func};vs.object,vs.object,vs.object,vs.element;vs.object,vs.object,vs.object,vs.oneOfType([vs.array,vs.element]),vs.any;function r_(t){"@babel/helpers - typeof";return r_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},r_(t)}function P2(){return P2=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},P2.apply(this,arguments)}function YIe(t,r){return eDe(t)||JIe(t,r)||QIe(t,r)||XIe()}function XIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QIe(t,r){if(t){if(typeof t=="string")return bB(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return bB(t,r)}}function bB(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function JIe(t,r){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var n,a,o,c,i=[],f=!0,p=!1;try{if(o=(s=s.call(t)).next,r!==0)for(;!(f=(n=o.call(s)).done)&&(i.push(n.value),i.length!==r);f=!0);}catch(g){p=!0,a=g}finally{try{if(!f&&s.return!=null&&(c=s.return(),Object(c)!==c))return}finally{if(p)throw a}}return i}}function eDe(t){if(Array.isArray(t))return t}function _B(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function wB(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?_B(Object(s),!0).forEach(function(n){tDe(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):_B(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function tDe(t,r,s){return r=rDe(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function rDe(t){var r=sDe(t,"string");return r_(r)=="symbol"?r:r+""}function sDe(t,r){if(r_(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(r_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var NB=function(r,s,n,a,o){var c=Math.min(Math.abs(n)/2,Math.abs(a)/2),i=a>=0?1:-1,f=n>=0?1:-1,p=a>=0&&n>=0||a<0&&n<0?1:0,g;if(c>0&&o instanceof Array){for(var y=[0,0,0,0],b=0,w=4;b<w;b++)y[b]=o[b]>c?c:o[b];g="M".concat(r,",").concat(s+i*y[0]),y[0]>0&&(g+="A ".concat(y[0],",").concat(y[0],",0,0,").concat(p,",").concat(r+f*y[0],",").concat(s)),g+="L ".concat(r+n-f*y[1],",").concat(s),y[1]>0&&(g+="A ".concat(y[1],",").concat(y[1],",0,0,").concat(p,`,
        `).concat(r+n,",").concat(s+i*y[1])),g+="L ".concat(r+n,",").concat(s+a-i*y[2]),y[2]>0&&(g+="A ".concat(y[2],",").concat(y[2],",0,0,").concat(p,`,
        `).concat(r+n-f*y[2],",").concat(s+a)),g+="L ".concat(r+f*y[3],",").concat(s+a),y[3]>0&&(g+="A ".concat(y[3],",").concat(y[3],",0,0,").concat(p,`,
        `).concat(r,",").concat(s+a-i*y[3])),g+="Z"}else if(c>0&&o===+o&&o>0){var T=Math.min(c,o);g="M ".concat(r,",").concat(s+i*T,`
            A `).concat(T,",").concat(T,",0,0,").concat(p,",").concat(r+f*T,",").concat(s,`
            L `).concat(r+n-f*T,",").concat(s,`
            A `).concat(T,",").concat(T,",0,0,").concat(p,",").concat(r+n,",").concat(s+i*T,`
            L `).concat(r+n,",").concat(s+a-i*T,`
            A `).concat(T,",").concat(T,",0,0,").concat(p,",").concat(r+n-f*T,",").concat(s+a,`
            L `).concat(r+f*T,",").concat(s+a,`
            A `).concat(T,",").concat(T,",0,0,").concat(p,",").concat(r,",").concat(s+a-i*T," Z")}else g="M ".concat(r,",").concat(s," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return g},nDe=function(r,s){if(!r||!s)return!1;var n=r.x,a=r.y,o=s.x,c=s.y,i=s.width,f=s.height;if(Math.abs(i)>0&&Math.abs(f)>0){var p=Math.min(o,o+i),g=Math.max(o,o+i),y=Math.min(c,c+f),b=Math.max(c,c+f);return n>=p&&n<=g&&a>=y&&a<=b}return!1},aDe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},lR=function(r){var s=wB(wB({},aDe),r),n=A.useRef(),a=A.useState(-1),o=YIe(a,2),c=o[0],i=o[1];A.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var L=n.current.getTotalLength();L&&i(L)}catch{}},[]);var f=s.x,p=s.y,g=s.width,y=s.height,b=s.radius,w=s.className,T=s.animationEasing,N=s.animationDuration,M=s.animationBegin,O=s.isAnimationActive,C=s.isUpdateAnimationActive;if(f!==+f||p!==+p||g!==+g||y!==+y||g===0||y===0)return null;var D=rs("recharts-rectangle",w);return C?je.createElement(Ql,{canBegin:c>0,from:{width:g,height:y,x:f,y:p},to:{width:g,height:y,x:f,y:p},duration:N,animationEasing:T,isActive:C},function(L){var F=L.width,B=L.height,U=L.x,te=L.y;return je.createElement(Ql,{canBegin:c>0,from:"0px ".concat(c===-1?1:c,"px"),to:"".concat(c,"px 0px"),attributeName:"strokeDasharray",begin:M,duration:N,isActive:O,easing:T},je.createElement("path",P2({},Or(s,!0),{className:D,d:NB(U,te,F,B,b),ref:n})))}):je.createElement("path",P2({},Or(s,!0),{className:D,d:NB(f,p,g,y,b)}))},iDe=["points","className","baseLinePoints","connectNulls"];function Cg(){return Cg=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},Cg.apply(this,arguments)}function oDe(t,r){if(t==null)return{};var s=lDe(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function lDe(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function SB(t){return hDe(t)||uDe(t)||dDe(t)||cDe()}function cDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dDe(t,r){if(t){if(typeof t=="string")return L4(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return L4(t,r)}}function uDe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function hDe(t){if(Array.isArray(t))return L4(t)}function L4(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}var CB=function(r){return r&&r.x===+r.x&&r.y===+r.y},mDe=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],s=[[]];return r.forEach(function(n){CB(n)?s[s.length-1].push(n):s[s.length-1].length>0&&s.push([])}),CB(r[0])&&s[s.length-1].push(r[0]),s[s.length-1].length<=0&&(s=s.slice(0,-1)),s},Y0=function(r,s){var n=mDe(r);s&&(n=[n.reduce(function(o,c){return[].concat(SB(o),SB(c))},[])]);var a=n.map(function(o){return o.reduce(function(c,i,f){return"".concat(c).concat(f===0?"M":"L").concat(i.x,",").concat(i.y)},"")}).join("");return n.length===1?"".concat(a,"Z"):a},fDe=function(r,s,n){var a=Y0(r,n);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(Y0(s.reverse(),n).slice(1))},MY=function(r){var s=r.points,n=r.className,a=r.baseLinePoints,o=r.connectNulls,c=oDe(r,iDe);if(!s||!s.length)return null;var i=rs("recharts-polygon",n);if(a&&a.length){var f=c.stroke&&c.stroke!=="none",p=fDe(s,a,o);return je.createElement("g",{className:i},je.createElement("path",Cg({},Or(c,!0),{fill:p.slice(-1)==="Z"?c.fill:"none",stroke:"none",d:p})),f?je.createElement("path",Cg({},Or(c,!0),{fill:"none",d:Y0(s,o)})):null,f?je.createElement("path",Cg({},Or(c,!0),{fill:"none",d:Y0(a,o)})):null)}var g=Y0(s,o);return je.createElement("path",Cg({},Or(c,!0),{fill:g.slice(-1)==="Z"?c.fill:"none",className:i,d:g}))};function F4(){return F4=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},F4.apply(this,arguments)}var Iv=function(r){var s=r.cx,n=r.cy,a=r.r,o=r.className,c=rs("recharts-dot",o);return s===+s&&n===+n&&a===+a?je.createElement("circle",F4({},Or(r,!1),KS(r),{className:c,cx:s,cy:n,r:a})):null};function s_(t){"@babel/helpers - typeof";return s_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},s_(t)}var pDe=["x","y","top","left","width","height","className"];function $4(){return $4=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},$4.apply(this,arguments)}function PB(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function xDe(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?PB(Object(s),!0).forEach(function(n){gDe(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):PB(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function gDe(t,r,s){return r=yDe(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function yDe(t){var r=vDe(t,"string");return s_(r)=="symbol"?r:r+""}function vDe(t,r){if(s_(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(s_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function jDe(t,r){if(t==null)return{};var s=bDe(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function bDe(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}var _De=function(r,s,n,a,o,c){return"M".concat(r,",").concat(o,"v").concat(a,"M").concat(c,",").concat(s,"h").concat(n)},wDe=function(r){var s=r.x,n=s===void 0?0:s,a=r.y,o=a===void 0?0:a,c=r.top,i=c===void 0?0:c,f=r.left,p=f===void 0?0:f,g=r.width,y=g===void 0?0:g,b=r.height,w=b===void 0?0:b,T=r.className,N=jDe(r,pDe),M=xDe({x:n,y:o,top:i,left:p,width:y,height:w},N);return!cr(n)||!cr(o)||!cr(y)||!cr(w)||!cr(i)||!cr(p)?null:je.createElement("path",$4({},Or(M,!0),{className:rs("recharts-cross",T),d:_De(n,o,y,w,i,p)}))},NDe=["cx","cy","innerRadius","outerRadius","gridType","radialLines"];function n_(t){"@babel/helpers - typeof";return n_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},n_(t)}function SDe(t,r){if(t==null)return{};var s=CDe(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function CDe(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function Gu(){return Gu=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},Gu.apply(this,arguments)}function kB(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function a_(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?kB(Object(s),!0).forEach(function(n){PDe(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):kB(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function PDe(t,r,s){return r=kDe(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function kDe(t){var r=ADe(t,"string");return n_(r)=="symbol"?r:r+""}function ADe(t,r){if(n_(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(n_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var TDe=function(r,s,n,a){var o="";return a.forEach(function(c,i){var f=sn(s,n,r,c);i?o+="L ".concat(f.x,",").concat(f.y):o+="M ".concat(f.x,",").concat(f.y)}),o+="Z",o},EDe=function(r){var s=r.cx,n=r.cy,a=r.innerRadius,o=r.outerRadius,c=r.polarAngles,i=r.radialLines;if(!c||!c.length||!i)return null;var f=a_({stroke:"#ccc"},Or(r,!1));return je.createElement("g",{className:"recharts-polar-grid-angle"},c.map(function(p){var g=sn(s,n,a,p),y=sn(s,n,o,p);return je.createElement("line",Gu({},f,{key:"line-".concat(p),x1:g.x,y1:g.y,x2:y.x,y2:y.y}))}))},MDe=function(r){var s=r.cx,n=r.cy,a=r.radius,o=r.index,c=a_(a_({stroke:"#ccc"},Or(r,!1)),{},{fill:"none"});return je.createElement("circle",Gu({},c,{className:rs("recharts-polar-grid-concentric-circle",r.className),key:"circle-".concat(o),cx:s,cy:n,r:a}))},ODe=function(r){var s=r.radius,n=r.index,a=a_(a_({stroke:"#ccc"},Or(r,!1)),{},{fill:"none"});return je.createElement("path",Gu({},a,{className:rs("recharts-polar-grid-concentric-polygon",r.className),key:"path-".concat(n),d:TDe(s,r.cx,r.cy,r.polarAngles)}))},IDe=function(r){var s=r.polarRadius,n=r.gridType;return!s||!s.length?null:je.createElement("g",{className:"recharts-polar-grid-concentric"},s.map(function(a,o){var c=o;return n==="circle"?je.createElement(MDe,Gu({key:c},r,{radius:a,index:o})):je.createElement(ODe,Gu({key:c},r,{radius:a,index:o}))}))},OY=function(r){var s=r.cx,n=s===void 0?0:s,a=r.cy,o=a===void 0?0:a,c=r.innerRadius,i=c===void 0?0:c,f=r.outerRadius,p=f===void 0?0:f,g=r.gridType,y=g===void 0?"polygon":g,b=r.radialLines,w=b===void 0?!0:b,T=SDe(r,NDe);return p<=0?null:je.createElement("g",{className:"recharts-polar-grid"},je.createElement(EDe,Gu({cx:n,cy:o,innerRadius:i,outerRadius:p,gridType:y,radialLines:w},T)),je.createElement(IDe,Gu({cx:n,cy:o,innerRadius:i,outerRadius:p,gridType:y,radialLines:w},T)))};OY.displayName="PolarGrid";var DDe=NP,RDe=zZ,LDe=zd;function FDe(t,r){return t&&t.length?DDe(t,LDe(r),RDe):void 0}var $De=FDe;const zDe=tn($De);var BDe=NP,qDe=zd,VDe=BZ;function UDe(t,r){return t&&t.length?BDe(t,qDe(r),VDe):void 0}var WDe=UDe;const GDe=tn(WDe);var KDe=["cx","cy","angle","ticks","axisLine"],HDe=["ticks","tick","angle","tickFormatter","stroke"];function Fy(t){"@babel/helpers - typeof";return Fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Fy(t)}function X0(){return X0=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},X0.apply(this,arguments)}function AB(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function If(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?AB(Object(s),!0).forEach(function(n){kP(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):AB(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function TB(t,r){if(t==null)return{};var s=ZDe(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function ZDe(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function YDe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function EB(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,DY(n.key),n)}}function XDe(t,r,s){return r&&EB(t.prototype,r),s&&EB(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function QDe(t,r,s){return r=k2(r),JDe(t,IY()?Reflect.construct(r,s||[],k2(t).constructor):r.apply(t,s))}function JDe(t,r){if(r&&(Fy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eRe(t)}function eRe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function IY(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(IY=function(){return!!t})()}function k2(t){return k2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},k2(t)}function tRe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&z4(t,r)}function z4(t,r){return z4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},z4(t,r)}function kP(t,r,s){return r=DY(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function DY(t){var r=rRe(t,"string");return Fy(r)=="symbol"?r:r+""}function rRe(t,r){if(Fy(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Fy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Dv=function(t){function r(){return YDe(this,r),QDe(this,r,arguments)}return tRe(r,t),XDe(r,[{key:"getTickValueCoord",value:function(n){var a=n.coordinate,o=this.props,c=o.angle,i=o.cx,f=o.cy;return sn(i,f,a,c)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,a;switch(n){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var n=this.props,a=n.cx,o=n.cy,c=n.angle,i=n.ticks,f=zDe(i,function(g){return g.coordinate||0}),p=GDe(i,function(g){return g.coordinate||0});return{cx:a,cy:o,startAngle:c,endAngle:c,innerRadius:p.coordinate||0,outerRadius:f.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,o=n.cy,c=n.angle,i=n.ticks,f=n.axisLine,p=TB(n,KDe),g=i.reduce(function(T,N){return[Math.min(T[0],N.coordinate),Math.max(T[1],N.coordinate)]},[1/0,-1/0]),y=sn(a,o,g[0],c),b=sn(a,o,g[1],c),w=If(If(If({},Or(p,!1)),{},{fill:"none"},Or(f,!1)),{},{x1:y.x,y1:y.y,x2:b.x,y2:b.y});return je.createElement("line",X0({className:"recharts-polar-radius-axis-line"},w))}},{key:"renderTicks",value:function(){var n=this,a=this.props,o=a.ticks,c=a.tick,i=a.angle,f=a.tickFormatter,p=a.stroke,g=TB(a,HDe),y=this.getTickTextAnchor(),b=Or(g,!1),w=Or(c,!1),T=o.map(function(N,M){var O=n.getTickValueCoord(N),C=If(If(If(If({textAnchor:y,transform:"rotate(".concat(90-i,", ").concat(O.x,", ").concat(O.y,")")},b),{},{stroke:"none",fill:p},w),{},{index:M},O),{},{payload:N});return je.createElement(_s,X0({className:rs("recharts-polar-radius-axis-tick",xY(c)),key:"tick-".concat(N.coordinate)},Tp(n.props,N,M)),r.renderTickItem(c,C,f?f(N.value,M):N.value))});return je.createElement(_s,{className:"recharts-polar-radius-axis-ticks"},T)}},{key:"render",value:function(){var n=this.props,a=n.ticks,o=n.axisLine,c=n.tick;return!a||!a.length?null:je.createElement(_s,{className:rs("recharts-polar-radius-axis",this.props.className)},o&&this.renderAxisLine(),c&&this.renderTicks(),wi.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,a,o){var c;return je.isValidElement(n)?c=je.cloneElement(n,a):Wr(n)?c=n(a):c=je.createElement(Ep,X0({},a,{className:"recharts-polar-radius-axis-tick-value"}),o),c}}])}(A.PureComponent);kP(Dv,"displayName","PolarRadiusAxis");kP(Dv,"axisType","radiusAxis");kP(Dv,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function $y(t){"@babel/helpers - typeof";return $y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},$y(t)}function Uf(){return Uf=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},Uf.apply(this,arguments)}function MB(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function Df(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?MB(Object(s),!0).forEach(function(n){AP(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):MB(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function sRe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function OB(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,LY(n.key),n)}}function nRe(t,r,s){return r&&OB(t.prototype,r),s&&OB(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function aRe(t,r,s){return r=A2(r),iRe(t,RY()?Reflect.construct(r,s||[],A2(t).constructor):r.apply(t,s))}function iRe(t,r){if(r&&($y(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oRe(t)}function oRe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function RY(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(RY=function(){return!!t})()}function A2(t){return A2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},A2(t)}function lRe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&B4(t,r)}function B4(t,r){return B4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},B4(t,r)}function AP(t,r,s){return r=LY(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function LY(t){var r=cRe(t,"string");return $y(r)=="symbol"?r:r+""}function cRe(t,r){if($y(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if($y(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var dRe=Math.PI/180,IB=1e-5,Rv=function(t){function r(){return sRe(this,r),aRe(this,r,arguments)}return lRe(r,t),nRe(r,[{key:"getTickLineCoord",value:function(n){var a=this.props,o=a.cx,c=a.cy,i=a.radius,f=a.orientation,p=a.tickSize,g=p||8,y=sn(o,c,i,n.coordinate),b=sn(o,c,i+(f==="inner"?-1:1)*g,n.coordinate);return{x1:y.x,y1:y.y,x2:b.x,y2:b.y}}},{key:"getTickTextAnchor",value:function(n){var a=this.props.orientation,o=Math.cos(-n.coordinate*dRe),c;return o>IB?c=a==="outer"?"start":"end":o<-IB?c=a==="outer"?"end":"start":c="middle",c}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,o=n.cy,c=n.radius,i=n.axisLine,f=n.axisLineType,p=Df(Df({},Or(this.props,!1)),{},{fill:"none"},Or(i,!1));if(f==="circle")return je.createElement(Iv,Uf({className:"recharts-polar-angle-axis-line"},p,{cx:a,cy:o,r:c}));var g=this.props.ticks,y=g.map(function(b){return sn(a,o,c,b.coordinate)});return je.createElement(MY,Uf({className:"recharts-polar-angle-axis-line"},p,{points:y}))}},{key:"renderTicks",value:function(){var n=this,a=this.props,o=a.ticks,c=a.tick,i=a.tickLine,f=a.tickFormatter,p=a.stroke,g=Or(this.props,!1),y=Or(c,!1),b=Df(Df({},g),{},{fill:"none"},Or(i,!1)),w=o.map(function(T,N){var M=n.getTickLineCoord(T),O=n.getTickTextAnchor(T),C=Df(Df(Df({textAnchor:O},g),{},{stroke:"none",fill:p},y),{},{index:N,payload:T,x:M.x2,y:M.y2});return je.createElement(_s,Uf({className:rs("recharts-polar-angle-axis-tick",xY(c)),key:"tick-".concat(T.coordinate)},Tp(n.props,T,N)),i&&je.createElement("line",Uf({className:"recharts-polar-angle-axis-tick-line"},b,M)),c&&r.renderTickItem(c,C,f?f(T.value,N):T.value))});return je.createElement(_s,{className:"recharts-polar-angle-axis-ticks"},w)}},{key:"render",value:function(){var n=this.props,a=n.ticks,o=n.radius,c=n.axisLine;return o<=0||!a||!a.length?null:je.createElement(_s,{className:rs("recharts-polar-angle-axis",this.props.className)},c&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,a,o){var c;return je.isValidElement(n)?c=je.cloneElement(n,a):Wr(n)?c=n(a):c=je.createElement(Ep,Uf({},a,{className:"recharts-polar-angle-axis-tick-value"}),o),c}}])}(A.PureComponent);AP(Rv,"displayName","PolarAngleAxis");AP(Rv,"axisType","angleAxis");AP(Rv,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var uRe=RH,hRe=uRe(Object.getPrototypeOf,Object),mRe=hRe,fRe=Xu,pRe=mRe,xRe=Qu,gRe="[object Object]",yRe=Function.prototype,vRe=Object.prototype,FY=yRe.toString,jRe=vRe.hasOwnProperty,bRe=FY.call(Object);function _Re(t){if(!xRe(t)||fRe(t)!=gRe)return!1;var r=pRe(t);if(r===null)return!0;var s=jRe.call(r,"constructor")&&r.constructor;return typeof s=="function"&&s instanceof s&&FY.call(s)==bRe}var wRe=_Re;const NRe=tn(wRe);var SRe=Xu,CRe=Qu,PRe="[object Boolean]";function kRe(t){return t===!0||t===!1||CRe(t)&&SRe(t)==PRe}var ARe=kRe;const TRe=tn(ARe);function i_(t){"@babel/helpers - typeof";return i_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},i_(t)}function T2(){return T2=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},T2.apply(this,arguments)}function ERe(t,r){return DRe(t)||IRe(t,r)||ORe(t,r)||MRe()}function MRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ORe(t,r){if(t){if(typeof t=="string")return DB(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return DB(t,r)}}function DB(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function IRe(t,r){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var n,a,o,c,i=[],f=!0,p=!1;try{if(o=(s=s.call(t)).next,r!==0)for(;!(f=(n=o.call(s)).done)&&(i.push(n.value),i.length!==r);f=!0);}catch(g){p=!0,a=g}finally{try{if(!f&&s.return!=null&&(c=s.return(),Object(c)!==c))return}finally{if(p)throw a}}return i}}function DRe(t){if(Array.isArray(t))return t}function RB(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function LB(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?RB(Object(s),!0).forEach(function(n){RRe(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):RB(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function RRe(t,r,s){return r=LRe(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function LRe(t){var r=FRe(t,"string");return i_(r)=="symbol"?r:r+""}function FRe(t,r){if(i_(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(i_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var FB=function(r,s,n,a,o){var c=n-a,i;return i="M ".concat(r,",").concat(s),i+="L ".concat(r+n,",").concat(s),i+="L ".concat(r+n-c/2,",").concat(s+o),i+="L ".concat(r+n-c/2-a,",").concat(s+o),i+="L ".concat(r,",").concat(s," Z"),i},$Re={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},zRe=function(r){var s=LB(LB({},$Re),r),n=A.useRef(),a=A.useState(-1),o=ERe(a,2),c=o[0],i=o[1];A.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var D=n.current.getTotalLength();D&&i(D)}catch{}},[]);var f=s.x,p=s.y,g=s.upperWidth,y=s.lowerWidth,b=s.height,w=s.className,T=s.animationEasing,N=s.animationDuration,M=s.animationBegin,O=s.isUpdateAnimationActive;if(f!==+f||p!==+p||g!==+g||y!==+y||b!==+b||g===0&&y===0||b===0)return null;var C=rs("recharts-trapezoid",w);return O?je.createElement(Ql,{canBegin:c>0,from:{upperWidth:0,lowerWidth:0,height:b,x:f,y:p},to:{upperWidth:g,lowerWidth:y,height:b,x:f,y:p},duration:N,animationEasing:T,isActive:O},function(D){var L=D.upperWidth,F=D.lowerWidth,B=D.height,U=D.x,te=D.y;return je.createElement(Ql,{canBegin:c>0,from:"0px ".concat(c===-1?1:c,"px"),to:"".concat(c,"px 0px"),attributeName:"strokeDasharray",begin:M,duration:N,easing:T},je.createElement("path",T2({},Or(s,!0),{className:C,d:FB(U,te,L,F,B),ref:n})))}):je.createElement("g",null,je.createElement("path",T2({},Or(s,!0),{className:C,d:FB(f,p,g,y,b)})))},BRe=["option","shapeType","propTransformer","activeClassName","isActive"];function o_(t){"@babel/helpers - typeof";return o_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},o_(t)}function qRe(t,r){if(t==null)return{};var s=VRe(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function VRe(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function $B(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function E2(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?$B(Object(s),!0).forEach(function(n){URe(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):$B(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function URe(t,r,s){return r=WRe(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function WRe(t){var r=GRe(t,"string");return o_(r)=="symbol"?r:r+""}function GRe(t,r){if(o_(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(o_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function KRe(t,r){return E2(E2({},r),t)}function HRe(t,r){return t==="symbols"}function zB(t){var r=t.shapeType,s=t.elementProps;switch(r){case"rectangle":return je.createElement(lR,s);case"trapezoid":return je.createElement(zRe,s);case"sector":return je.createElement(jY,s);case"symbols":if(HRe(r))return je.createElement(PD,s);break;default:return null}}function ZRe(t){return A.isValidElement(t)?t.props:t}function $Y(t){var r=t.option,s=t.shapeType,n=t.propTransformer,a=n===void 0?KRe:n,o=t.activeClassName,c=o===void 0?"recharts-active-shape":o,i=t.isActive,f=qRe(t,BRe),p;if(A.isValidElement(r))p=A.cloneElement(r,E2(E2({},f),ZRe(r)));else if(Wr(r))p=r(f);else if(NRe(r)&&!TRe(r)){var g=a(r,f);p=je.createElement(zB,{shapeType:s,elementProps:g})}else{var y=f;p=je.createElement(zB,{shapeType:s,elementProps:y})}return i?je.createElement(_s,{className:c},p):p}function TP(t,r){return r!=null&&"trapezoids"in t.props}function EP(t,r){return r!=null&&"sectors"in t.props}function l_(t,r){return r!=null&&"points"in t.props}function YRe(t,r){var s,n,a=t.x===(r==null||(s=r.labelViewBox)===null||s===void 0?void 0:s.x)||t.x===r.x,o=t.y===(r==null||(n=r.labelViewBox)===null||n===void 0?void 0:n.y)||t.y===r.y;return a&&o}function XRe(t,r){var s=t.endAngle===r.endAngle,n=t.startAngle===r.startAngle;return s&&n}function QRe(t,r){var s=t.x===r.x,n=t.y===r.y,a=t.z===r.z;return s&&n&&a}function JRe(t,r){var s;return TP(t,r)?s=YRe:EP(t,r)?s=XRe:l_(t,r)&&(s=QRe),s}function e3e(t,r){var s;return TP(t,r)?s="trapezoids":EP(t,r)?s="sectors":l_(t,r)&&(s="points"),s}function t3e(t,r){if(TP(t,r)){var s;return(s=r.tooltipPayload)===null||s===void 0||(s=s[0])===null||s===void 0||(s=s.payload)===null||s===void 0?void 0:s.payload}if(EP(t,r)){var n;return(n=r.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return l_(t,r)?r.payload:{}}function r3e(t){var r=t.activeTooltipItem,s=t.graphicalItem,n=t.itemData,a=e3e(s,r),o=t3e(s,r),c=n.filter(function(f,p){var g=Mm(o,f),y=s.props[a].filter(function(T){var N=JRe(s,r);return N(T,r)}),b=s.props[a].indexOf(y[y.length-1]),w=p===b;return g&&w}),i=n.indexOf(c[c.length-1]);return i}var UN;function zy(t){"@babel/helpers - typeof";return zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},zy(t)}function Pg(){return Pg=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},Pg.apply(this,arguments)}function BB(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function Rn(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?BB(Object(s),!0).forEach(function(n){Bl(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):BB(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function s3e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function qB(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,BY(n.key),n)}}function n3e(t,r,s){return r&&qB(t.prototype,r),s&&qB(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function a3e(t,r,s){return r=M2(r),i3e(t,zY()?Reflect.construct(r,s||[],M2(t).constructor):r.apply(t,s))}function i3e(t,r){if(r&&(zy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return o3e(t)}function o3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zY(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zY=function(){return!!t})()}function M2(t){return M2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},M2(t)}function l3e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&q4(t,r)}function q4(t,r){return q4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},q4(t,r)}function Bl(t,r,s){return r=BY(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function BY(t){var r=c3e(t,"string");return zy(r)=="symbol"?r:r+""}function c3e(t,r){if(zy(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(zy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Od=function(t){function r(s){var n;return s3e(this,r),n=a3e(this,r,[s]),Bl(n,"pieRef",null),Bl(n,"sectorRefs",[]),Bl(n,"id",qp("recharts-pie-")),Bl(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Wr(a)&&a()}),Bl(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Wr(a)&&a()}),n.state={isAnimationFinished:!s.isAnimationActive,prevIsAnimationActive:s.isAnimationActive,prevAnimationId:s.animationId,sectorToFocus:0},n}return l3e(r,t),n3e(r,[{key:"isActiveIndex",value:function(n){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(n)!==-1:n===a}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var o=this.props,c=o.label,i=o.labelLine,f=o.dataKey,p=o.valueKey,g=Or(this.props,!1),y=Or(c,!1),b=Or(i,!1),w=c&&c.offsetRadius||20,T=n.map(function(N,M){var O=(N.startAngle+N.endAngle)/2,C=sn(N.cx,N.cy,N.outerRadius+w,O),D=Rn(Rn(Rn(Rn({},g),N),{},{stroke:"none"},y),{},{index:M,textAnchor:r.getTextAnchor(C.x,N.cx)},C),L=Rn(Rn(Rn(Rn({},g),N),{},{fill:"none",stroke:N.fill},b),{},{index:M,points:[sn(N.cx,N.cy,N.outerRadius,O),C]}),F=f;return ts(f)&&ts(p)?F="value":ts(f)&&(F=p),je.createElement(_s,{key:"label-".concat(N.startAngle,"-").concat(N.endAngle,"-").concat(N.midAngle,"-").concat(M)},i&&r.renderLabelLineItem(i,L,"line"),r.renderLabelItem(c,D,da(N,F)))});return je.createElement(_s,{className:"recharts-pie-labels"},T)}},{key:"renderSectorsStatically",value:function(n){var a=this,o=this.props,c=o.activeShape,i=o.blendStroke,f=o.inactiveShape;return n.map(function(p,g){if((p==null?void 0:p.startAngle)===0&&(p==null?void 0:p.endAngle)===0&&n.length!==1)return null;var y=a.isActiveIndex(g),b=f&&a.hasActiveIndex()?f:null,w=y?c:b,T=Rn(Rn({},p),{},{stroke:i?p.fill:p.stroke,tabIndex:-1});return je.createElement(_s,Pg({ref:function(M){M&&!a.sectorRefs.includes(M)&&a.sectorRefs.push(M)},tabIndex:-1,className:"recharts-pie-sector"},Tp(a.props,p,g),{key:"sector-".concat(p==null?void 0:p.startAngle,"-").concat(p==null?void 0:p.endAngle,"-").concat(p.midAngle,"-").concat(g)}),je.createElement($Y,Pg({option:w,isActive:y,shapeType:"sector"},T)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,o=a.sectors,c=a.isAnimationActive,i=a.animationBegin,f=a.animationDuration,p=a.animationEasing,g=a.animationId,y=this.state,b=y.prevSectors,w=y.prevIsAnimationActive;return je.createElement(Ql,{begin:i,duration:f,isActive:c,easing:p,from:{t:0},to:{t:1},key:"pie-".concat(g,"-").concat(w),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(T){var N=T.t,M=[],O=o&&o[0],C=O.startAngle;return o.forEach(function(D,L){var F=b&&b[L],B=L>0?vl(D,"paddingAngle",0):0;if(F){var U=ca(F.endAngle-F.startAngle,D.endAngle-D.startAngle),te=Rn(Rn({},D),{},{startAngle:C+B,endAngle:C+U(N)+B});M.push(te),C=te.endAngle}else{var Q=D.endAngle,re=D.startAngle,Z=ca(0,Q-re),ne=Z(N),oe=Rn(Rn({},D),{},{startAngle:C+B,endAngle:C+ne+B});M.push(oe),C=oe.endAngle}}),je.createElement(_s,null,n.renderSectorsStatically(M))})}},{key:"attachKeyboardHandlers",value:function(n){var a=this;n.onkeydown=function(o){if(!o.altKey)switch(o.key){case"ArrowLeft":{var c=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[c].focus(),a.setState({sectorToFocus:c});break}case"ArrowRight":{var i=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[i].focus(),a.setState({sectorToFocus:i});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,a=n.sectors,o=n.isAnimationActive,c=this.state.prevSectors;return o&&a&&a.length&&(!c||!Mm(c,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,a=this.props,o=a.hide,c=a.sectors,i=a.className,f=a.label,p=a.cx,g=a.cy,y=a.innerRadius,b=a.outerRadius,w=a.isAnimationActive,T=this.state.isAnimationFinished;if(o||!c||!c.length||!cr(p)||!cr(g)||!cr(y)||!cr(b))return null;var N=rs("recharts-pie",i);return je.createElement(_s,{tabIndex:this.props.rootTabIndex,className:N,ref:function(O){n.pieRef=O}},this.renderSectors(),f&&this.renderLabels(c),wi.renderCallByParent(this.props,null,!1),(!w||T)&&Wc.renderCallByParent(this.props,c,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return a.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:n.sectors!==a.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,a){return n>a?"start":n<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,a,o){if(je.isValidElement(n))return je.cloneElement(n,a);if(Wr(n))return n(a);var c=rs("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return je.createElement(hp,Pg({},a,{key:o,type:"linear",className:c}))}},{key:"renderLabelItem",value:function(n,a,o){if(je.isValidElement(n))return je.cloneElement(n,a);var c=o;if(Wr(n)&&(c=n(a),je.isValidElement(c)))return c;var i=rs("recharts-pie-label-text",typeof n!="boolean"&&!Wr(n)?n.className:"");return je.createElement(Ep,Pg({},a,{alignmentBaseline:"middle",className:i}),c)}}])}(A.PureComponent);UN=Od;Bl(Od,"displayName","Pie");Bl(Od,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Ju.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Bl(Od,"parseDeltaAngle",function(t,r){var s=wo(r-t),n=Math.min(Math.abs(r-t),360);return s*n});Bl(Od,"getRealPieData",function(t){var r=t.data,s=t.children,n=Or(t,!1),a=jl(s,Rb);return r&&r.length?r.map(function(o,c){return Rn(Rn(Rn({payload:o},n),o),a&&a[c]&&a[c].props)}):a&&a.length?a.map(function(o){return Rn(Rn({},n),o.props)}):[]});Bl(Od,"parseCoordinateOfPie",function(t,r){var s=r.top,n=r.left,a=r.width,o=r.height,c=fY(a,o),i=n+No(t.cx,a,a/2),f=s+No(t.cy,o,o/2),p=No(t.innerRadius,c,0),g=No(t.outerRadius,c,c*.8),y=t.maxRadius||Math.sqrt(a*a+o*o)/2;return{cx:i,cy:f,innerRadius:p,outerRadius:g,maxRadius:y}});Bl(Od,"getComposedData",function(t){var r=t.item,s=t.offset,n=r.type.defaultProps!==void 0?Rn(Rn({},r.type.defaultProps),r.props):r.props,a=UN.getRealPieData(n);if(!a||!a.length)return null;var o=n.cornerRadius,c=n.startAngle,i=n.endAngle,f=n.paddingAngle,p=n.dataKey,g=n.nameKey,y=n.valueKey,b=n.tooltipType,w=Math.abs(n.minAngle),T=UN.parseCoordinateOfPie(n,s),N=UN.parseDeltaAngle(c,i),M=Math.abs(N),O=p;ts(p)&&ts(y)?(Uc(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),O="value"):ts(p)&&(Uc(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),O=y);var C=a.filter(function(te){return da(te,O,0)!==0}).length,D=(M>=360?C:C-1)*f,L=M-C*w-D,F=a.reduce(function(te,Q){var re=da(Q,O,0);return te+(cr(re)?re:0)},0),B;if(F>0){var U;B=a.map(function(te,Q){var re=da(te,O,0),Z=da(te,g,Q),ne=(cr(re)?re:0)/F,oe;Q?oe=U.endAngle+wo(N)*f*(re!==0?1:0):oe=c;var Ce=oe+wo(N)*((re!==0?w:0)+ne*L),Pe=(oe+Ce)/2,Se=(T.innerRadius+T.outerRadius)/2,ae=[{name:Z,value:re,payload:te,dataKey:O,type:b}],be=sn(T.cx,T.cy,Se,Pe);return U=Rn(Rn(Rn({percent:ne,cornerRadius:o,name:Z,tooltipPayload:ae,midAngle:Pe,middleRadius:Se,tooltipPosition:be},te),T),{},{value:da(te,O),startAngle:oe,endAngle:Ce,payload:te,paddingAngle:wo(N)*f}),U})}return Rn(Rn({},T),{},{sectors:B,data:a})});function d3e(t){return t&&t.length?t[0]:void 0}var u3e=d3e,h3e=u3e;const m3e=tn(h3e);var f3e=["key"];function By(t){"@babel/helpers - typeof";return By=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},By(t)}function p3e(t,r){if(t==null)return{};var s=x3e(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function x3e(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function O2(){return O2=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},O2.apply(this,arguments)}function VB(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function bo(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?VB(Object(s),!0).forEach(function(n){wu(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):VB(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function g3e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function UB(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,VY(n.key),n)}}function y3e(t,r,s){return r&&UB(t.prototype,r),s&&UB(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function v3e(t,r,s){return r=I2(r),j3e(t,qY()?Reflect.construct(r,s||[],I2(t).constructor):r.apply(t,s))}function j3e(t,r){if(r&&(By(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return b3e(t)}function b3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qY(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qY=function(){return!!t})()}function I2(t){return I2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},I2(t)}function _3e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&V4(t,r)}function V4(t,r){return V4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},V4(t,r)}function wu(t,r,s){return r=VY(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function VY(t){var r=w3e(t,"string");return By(r)=="symbol"?r:r+""}function w3e(t,r){if(By(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(By(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var rw=function(t){function r(){var s;g3e(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return s=v3e(this,r,[].concat(a)),wu(s,"state",{isAnimationFinished:!1}),wu(s,"handleAnimationEnd",function(){var c=s.props.onAnimationEnd;s.setState({isAnimationFinished:!0}),Wr(c)&&c()}),wu(s,"handleAnimationStart",function(){var c=s.props.onAnimationStart;s.setState({isAnimationFinished:!1}),Wr(c)&&c()}),wu(s,"handleMouseEnter",function(c){var i=s.props.onMouseEnter;i&&i(s.props,c)}),wu(s,"handleMouseLeave",function(c){var i=s.props.onMouseLeave;i&&i(s.props,c)}),s}return _3e(r,t),y3e(r,[{key:"renderDots",value:function(n){var a=this.props,o=a.dot,c=a.dataKey,i=Or(this.props,!1),f=Or(o,!0),p=n.map(function(g,y){var b=bo(bo(bo({key:"dot-".concat(y),r:3},i),f),{},{dataKey:c,cx:g.x,cy:g.y,index:y,payload:g});return r.renderDotItem(o,b)});return je.createElement(_s,{className:"recharts-radar-dots"},p)}},{key:"renderPolygonStatically",value:function(n){var a=this.props,o=a.shape,c=a.dot,i=a.isRange,f=a.baseLinePoints,p=a.connectNulls,g;return je.isValidElement(o)?g=je.cloneElement(o,bo(bo({},this.props),{},{points:n})):Wr(o)?g=o(bo(bo({},this.props),{},{points:n})):g=je.createElement(MY,O2({},Or(this.props,!0),{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,points:n,baseLinePoints:i?f:null,connectNulls:p})),je.createElement(_s,{className:"recharts-radar-polygon"},g,c?this.renderDots(n):null)}},{key:"renderPolygonWithAnimation",value:function(){var n=this,a=this.props,o=a.points,c=a.isAnimationActive,i=a.animationBegin,f=a.animationDuration,p=a.animationEasing,g=a.animationId,y=this.state.prevPoints;return je.createElement(Ql,{begin:i,duration:f,isActive:c,easing:p,from:{t:0},to:{t:1},key:"radar-".concat(g),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(b){var w=b.t,T=y&&y.length/o.length,N=o.map(function(M,O){var C=y&&y[Math.floor(O*T)];if(C){var D=ca(C.x,M.x),L=ca(C.y,M.y);return bo(bo({},M),{},{x:D(w),y:L(w)})}var F=ca(M.cx,M.x),B=ca(M.cy,M.y);return bo(bo({},M),{},{x:F(w),y:B(w)})});return n.renderPolygonStatically(N)})}},{key:"renderPolygon",value:function(){var n=this.props,a=n.points,o=n.isAnimationActive,c=n.isRange,i=this.state.prevPoints;return o&&a&&a.length&&!c&&(!i||!Mm(i,a))?this.renderPolygonWithAnimation():this.renderPolygonStatically(a)}},{key:"render",value:function(){var n=this.props,a=n.hide,o=n.className,c=n.points,i=n.isAnimationActive;if(a||!c||!c.length)return null;var f=this.state.isAnimationFinished,p=rs("recharts-radar",o);return je.createElement(_s,{className:p},this.renderPolygon(),(!i||f)&&Wc.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"renderDotItem",value:function(n,a){var o;if(je.isValidElement(n))o=je.cloneElement(n,a);else if(Wr(n))o=n(a);else{var c=a.key,i=p3e(a,f3e);o=je.createElement(Iv,O2({},i,{key:c,className:rs("recharts-radar-dot",typeof n!="boolean"?n.className:"")}))}return o}}])}(A.PureComponent);wu(rw,"displayName","Radar");wu(rw,"defaultProps",{angleAxisId:0,radiusAxisId:0,hide:!1,activeDot:!0,dot:!1,legendType:"rect",isAnimationActive:!Ju.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});wu(rw,"getComposedData",function(t){var r=t.radiusAxis,s=t.angleAxis,n=t.displayedData,a=t.dataKey,o=t.bandSize,c=s.cx,i=s.cy,f=!1,p=[],g=s.type!=="number"?o??0:0;n.forEach(function(b,w){var T=da(b,s.dataKey,w),N=da(b,a),M=s.scale(T)+g,O=Array.isArray(N)?yY(N):N,C=ts(O)?void 0:r.scale(O);Array.isArray(N)&&N.length>=2&&(f=!0),p.push(bo(bo({},sn(c,i,C,M)),{},{name:T,value:N,cx:c,cy:i,radius:C,angle:M,payload:b}))});var y=[];return f&&p.forEach(function(b){if(Array.isArray(b.value)){var w=m3e(b.value),T=ts(w)?void 0:r.scale(w);y.push(bo(bo({},b),{},{radius:T},sn(c,i,T,b.angle)))}else y.push(b)}),{points:p,isRange:f,baseLinePoints:y}});var N3e=Math.ceil,S3e=Math.max;function C3e(t,r,s,n){for(var a=-1,o=S3e(N3e((r-t)/(s||1)),0),c=Array(o);o--;)c[n?o:++a]=t,t+=s;return c}var P3e=C3e,k3e=tZ,WB=1/0,A3e=17976931348623157e292;function T3e(t){if(!t)return t===0?t:0;if(t=k3e(t),t===WB||t===-WB){var r=t<0?-1:1;return r*A3e}return t===t?t:0}var UY=T3e,E3e=P3e,M3e=gP,ST=UY;function O3e(t){return function(r,s,n){return n&&typeof n!="number"&&M3e(r,s,n)&&(s=n=void 0),r=ST(r),s===void 0?(s=r,r=0):s=ST(s),n=n===void 0?r<s?1:-1:ST(n),E3e(r,s,n,t)}}var I3e=O3e,D3e=I3e,R3e=D3e(),L3e=R3e;const D2=tn(L3e);function c_(t){"@babel/helpers - typeof";return c_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},c_(t)}function GB(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function KB(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?GB(Object(s),!0).forEach(function(n){WY(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):GB(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function WY(t,r,s){return r=F3e(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function F3e(t){var r=$3e(t,"string");return c_(r)=="symbol"?r:r+""}function $3e(t,r){if(c_(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(c_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var z3e=["Webkit","Moz","O","ms"],B3e=function(r,s){var n=r.replace(/(\w)/,function(o){return o.toUpperCase()}),a=z3e.reduce(function(o,c){return KB(KB({},o),{},WY({},c+n,s))},{});return a[r]=s,a};function qy(t){"@babel/helpers - typeof";return qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},qy(t)}function R2(){return R2=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},R2.apply(this,arguments)}function HB(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function CT(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?HB(Object(s),!0).forEach(function(n){ol(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):HB(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function q3e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function ZB(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,KY(n.key),n)}}function V3e(t,r,s){return r&&ZB(t.prototype,r),s&&ZB(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function U3e(t,r,s){return r=L2(r),W3e(t,GY()?Reflect.construct(r,s||[],L2(t).constructor):r.apply(t,s))}function W3e(t,r){if(r&&(qy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G3e(t)}function G3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function GY(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(GY=function(){return!!t})()}function L2(t){return L2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},L2(t)}function K3e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&U4(t,r)}function U4(t,r){return U4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},U4(t,r)}function ol(t,r,s){return r=KY(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function KY(t){var r=H3e(t,"string");return qy(r)=="symbol"?r:r+""}function H3e(t,r){if(qy(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(qy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Z3e=function(r){var s=r.data,n=r.startIndex,a=r.endIndex,o=r.x,c=r.width,i=r.travellerWidth;if(!s||!s.length)return{};var f=s.length,p=K0().domain(D2(0,f)).range([o,o+c-i]),g=p.domain().map(function(y){return p(y)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:p(n),endX:p(a),scale:p,scaleValues:g}},YB=function(r){return r.changedTouches&&!!r.changedTouches.length},Vy=function(t){function r(s){var n;return q3e(this,r),n=U3e(this,r,[s]),ol(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),ol(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),ol(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,o=a.endIndex,c=a.onDragEnd,i=a.startIndex;c==null||c({endIndex:o,startIndex:i})}),n.detachDragEndListener()}),ol(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),ol(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),ol(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),ol(n,"handleSlideDragStart",function(a){var o=YB(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:o.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return K3e(r,t),V3e(r,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,o=n.endX,c=this.state.scaleValues,i=this.props,f=i.gap,p=i.data,g=p.length-1,y=Math.min(a,o),b=Math.max(a,o),w=r.getIndexInRange(c,y),T=r.getIndexInRange(c,b);return{startIndex:w-w%f,endIndex:T===g?g:T-T%f}}},{key:"getTextOfTick",value:function(n){var a=this.props,o=a.data,c=a.tickFormatter,i=a.dataKey,f=da(o[n],i,n);return Wr(c)?c(f,n):f}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,o=a.slideMoveStartX,c=a.startX,i=a.endX,f=this.props,p=f.x,g=f.width,y=f.travellerWidth,b=f.startIndex,w=f.endIndex,T=f.onChange,N=n.pageX-o;N>0?N=Math.min(N,p+g-y-i,p+g-y-c):N<0&&(N=Math.max(N,p-c,p-i));var M=this.getIndex({startX:c+N,endX:i+N});(M.startIndex!==b||M.endIndex!==w)&&T&&T(M),this.setState({startX:c+N,endX:i+N,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var o=YB(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:o.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,o=a.brushMoveStartX,c=a.movingTravellerId,i=a.endX,f=a.startX,p=this.state[c],g=this.props,y=g.x,b=g.width,w=g.travellerWidth,T=g.onChange,N=g.gap,M=g.data,O={startX:this.state.startX,endX:this.state.endX},C=n.pageX-o;C>0?C=Math.min(C,y+b-w-p):C<0&&(C=Math.max(C,y-p)),O[c]=p+C;var D=this.getIndex(O),L=D.startIndex,F=D.endIndex,B=function(){var te=M.length-1;return c==="startX"&&(i>f?L%N===0:F%N===0)||i<f&&F===te||c==="endX"&&(i>f?F%N===0:L%N===0)||i>f&&F===te};this.setState(ol(ol({},c,p+C),"brushMoveStartX",n.pageX),function(){T&&B()&&T(D)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var o=this,c=this.state,i=c.scaleValues,f=c.startX,p=c.endX,g=this.state[a],y=i.indexOf(g);if(y!==-1){var b=y+n;if(!(b===-1||b>=i.length)){var w=i[b];a==="startX"&&w>=p||a==="endX"&&w<=f||this.setState(ol({},a,w),function(){o.props.onChange(o.getIndex({startX:o.state.startX,endX:o.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,o=n.y,c=n.width,i=n.height,f=n.fill,p=n.stroke;return je.createElement("rect",{stroke:p,fill:f,x:a,y:o,width:c,height:i})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,o=n.y,c=n.width,i=n.height,f=n.data,p=n.children,g=n.padding,y=A.Children.only(p);return y?je.cloneElement(y,{x:a,y:o,width:c,height:i,margin:g,compact:!0,data:f}):null}},{key:"renderTravellerLayer",value:function(n,a){var o,c,i=this,f=this.props,p=f.y,g=f.travellerWidth,y=f.height,b=f.traveller,w=f.ariaLabel,T=f.data,N=f.startIndex,M=f.endIndex,O=Math.max(n,this.props.x),C=CT(CT({},Or(this.props,!1)),{},{x:O,y:p,width:g,height:y}),D=w||"Min value: ".concat((o=T[N])===null||o===void 0?void 0:o.name,", Max value: ").concat((c=T[M])===null||c===void 0?void 0:c.name);return je.createElement(_s,{tabIndex:0,role:"slider","aria-label":D,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(F){["ArrowLeft","ArrowRight"].includes(F.key)&&(F.preventDefault(),F.stopPropagation(),i.handleTravellerMoveKeyboard(F.key==="ArrowRight"?1:-1,a))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},r.renderTraveller(b,C))}},{key:"renderSlide",value:function(n,a){var o=this.props,c=o.y,i=o.height,f=o.stroke,p=o.travellerWidth,g=Math.min(n,a)+p,y=Math.max(Math.abs(a-n)-p,0);return je.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:f,fillOpacity:.2,x:g,y:c,width:y,height:i})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,o=n.endIndex,c=n.y,i=n.height,f=n.travellerWidth,p=n.stroke,g=this.state,y=g.startX,b=g.endX,w=5,T={pointerEvents:"none",fill:p};return je.createElement(_s,{className:"recharts-brush-texts"},je.createElement(Ep,R2({textAnchor:"end",verticalAnchor:"middle",x:Math.min(y,b)-w,y:c+i/2},T),this.getTextOfTick(a)),je.createElement(Ep,R2({textAnchor:"start",verticalAnchor:"middle",x:Math.max(y,b)+f+w,y:c+i/2},T),this.getTextOfTick(o)))}},{key:"render",value:function(){var n=this.props,a=n.data,o=n.className,c=n.children,i=n.x,f=n.y,p=n.width,g=n.height,y=n.alwaysShowText,b=this.state,w=b.startX,T=b.endX,N=b.isTextActive,M=b.isSlideMoving,O=b.isTravellerMoving,C=b.isTravellerFocused;if(!a||!a.length||!cr(i)||!cr(f)||!cr(p)||!cr(g)||p<=0||g<=0)return null;var D=rs("recharts-brush",o),L=je.Children.count(c)===1,F=B3e("userSelect","none");return je.createElement(_s,{className:D,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:F},this.renderBackground(),L&&this.renderPanorama(),this.renderSlide(w,T),this.renderTravellerLayer(w,"startX"),this.renderTravellerLayer(T,"endX"),(N||M||O||C||y)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,o=n.y,c=n.width,i=n.height,f=n.stroke,p=Math.floor(o+i/2)-1;return je.createElement(je.Fragment,null,je.createElement("rect",{x:a,y:o,width:c,height:i,fill:f,stroke:"none"}),je.createElement("line",{x1:a+1,y1:p,x2:a+c-1,y2:p,fill:"none",stroke:"#fff"}),je.createElement("line",{x1:a+1,y1:p+2,x2:a+c-1,y2:p+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var o;return je.isValidElement(n)?o=je.cloneElement(n,a):Wr(n)?o=n(a):o=r.renderDefaultTraveller(a),o}},{key:"getDerivedStateFromProps",value:function(n,a){var o=n.data,c=n.width,i=n.x,f=n.travellerWidth,p=n.updateId,g=n.startIndex,y=n.endIndex;if(o!==a.prevData||p!==a.prevUpdateId)return CT({prevData:o,prevTravellerWidth:f,prevUpdateId:p,prevX:i,prevWidth:c},o&&o.length?Z3e({data:o,width:c,x:i,travellerWidth:f,startIndex:g,endIndex:y}):{scale:null,scaleValues:null});if(a.scale&&(c!==a.prevWidth||i!==a.prevX||f!==a.prevTravellerWidth)){a.scale.range([i,i+c-f]);var b=a.scale.domain().map(function(w){return a.scale(w)});return{prevData:o,prevTravellerWidth:f,prevUpdateId:p,prevX:i,prevWidth:c,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:b}}return null}},{key:"getIndexInRange",value:function(n,a){for(var o=n.length,c=0,i=o-1;i-c>1;){var f=Math.floor((c+i)/2);n[f]>a?i=f:c=f}return a>=n[i]?i:c}}])}(A.PureComponent);ol(Vy,"displayName","Brush");ol(Vy,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var Y3e=ID;function X3e(t,r){var s;return Y3e(t,function(n,a,o){return s=r(n,a,o),!s}),!!s}var Q3e=X3e,J3e=kH,eLe=zd,tLe=Q3e,rLe=Zo,sLe=gP;function nLe(t,r,s){var n=rLe(t)?J3e:tLe;return s&&sLe(t,r,s)&&(r=void 0),n(t,eLe(r))}var aLe=nLe;const iLe=tn(aLe);var kd=function(r,s){var n=r.alwaysShow,a=r.ifOverflow;return n&&(a="extendDomain"),a===s},XB=YH;function oLe(t,r,s){r=="__proto__"&&XB?XB(t,r,{configurable:!0,enumerable:!0,value:s,writable:!0}):t[r]=s}var lLe=oLe,cLe=lLe,dLe=HH,uLe=zd;function hLe(t,r){var s={};return r=uLe(r),dLe(t,function(n,a,o){cLe(s,a,r(n,a,o))}),s}var mLe=hLe;const fLe=tn(mLe);function pLe(t,r){for(var s=-1,n=t==null?0:t.length;++s<n;)if(!r(t[s],s,t))return!1;return!0}var xLe=pLe,gLe=ID;function yLe(t,r){var s=!0;return gLe(t,function(n,a,o){return s=!!r(n,a,o),s}),s}var vLe=yLe,jLe=xLe,bLe=vLe,_Le=zd,wLe=Zo,NLe=gP;function SLe(t,r,s){var n=wLe(t)?jLe:bLe;return s&&NLe(t,r,s)&&(r=void 0),n(t,_Le(r))}var CLe=SLe;const HY=tn(CLe);var PLe=["x","y"];function d_(t){"@babel/helpers - typeof";return d_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},d_(t)}function W4(){return W4=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},W4.apply(this,arguments)}function QB(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function _0(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?QB(Object(s),!0).forEach(function(n){kLe(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):QB(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function kLe(t,r,s){return r=ALe(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function ALe(t){var r=TLe(t,"string");return d_(r)=="symbol"?r:r+""}function TLe(t,r){if(d_(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(d_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function ELe(t,r){if(t==null)return{};var s=MLe(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function MLe(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function OLe(t,r){var s=t.x,n=t.y,a=ELe(t,PLe),o="".concat(s),c=parseInt(o,10),i="".concat(n),f=parseInt(i,10),p="".concat(r.height||a.height),g=parseInt(p,10),y="".concat(r.width||a.width),b=parseInt(y,10);return _0(_0(_0(_0(_0({},r),a),c?{x:c}:{}),f?{y:f}:{}),{},{height:g,width:b,name:r.name,radius:r.radius})}function JB(t){return je.createElement($Y,W4({shapeType:"rectangle",propTransformer:OLe,activeClassName:"recharts-active-bar"},t))}var ILe=function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof r=="number")return r;var o=typeof n=="number";return o?r(n,a):(o||Op(),s)}},DLe=["value","background"],ZY;function Uy(t){"@babel/helpers - typeof";return Uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Uy(t)}function RLe(t,r){if(t==null)return{};var s=LLe(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function LLe(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function F2(){return F2=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},F2.apply(this,arguments)}function e8(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function Va(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?e8(Object(s),!0).forEach(function(n){am(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):e8(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function FLe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function t8(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,XY(n.key),n)}}function $Le(t,r,s){return r&&t8(t.prototype,r),s&&t8(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function zLe(t,r,s){return r=$2(r),BLe(t,YY()?Reflect.construct(r,s||[],$2(t).constructor):r.apply(t,s))}function BLe(t,r){if(r&&(Uy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qLe(t)}function qLe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function YY(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(YY=function(){return!!t})()}function $2(t){return $2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},$2(t)}function VLe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&G4(t,r)}function G4(t,r){return G4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},G4(t,r)}function am(t,r,s){return r=XY(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function XY(t){var r=ULe(t,"string");return Uy(r)=="symbol"?r:r+""}function ULe(t,r){if(Uy(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Uy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var uo=function(t){function r(){var s;FLe(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return s=zLe(this,r,[].concat(a)),am(s,"state",{isAnimationFinished:!1}),am(s,"id",qp("recharts-bar-")),am(s,"handleAnimationEnd",function(){var c=s.props.onAnimationEnd;s.setState({isAnimationFinished:!0}),c&&c()}),am(s,"handleAnimationStart",function(){var c=s.props.onAnimationStart;s.setState({isAnimationFinished:!1}),c&&c()}),s}return VLe(r,t),$Le(r,[{key:"renderRectanglesStatically",value:function(n){var a=this,o=this.props,c=o.shape,i=o.dataKey,f=o.activeIndex,p=o.activeBar,g=Or(this.props,!1);return n&&n.map(function(y,b){var w=b===f,T=w?p:c,N=Va(Va(Va({},g),y),{},{isActive:w,option:T,index:b,dataKey:i,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return je.createElement(_s,F2({className:"recharts-bar-rectangle"},Tp(a.props,y,b),{key:"rectangle-".concat(y==null?void 0:y.x,"-").concat(y==null?void 0:y.y,"-").concat(y==null?void 0:y.value)}),je.createElement(JB,N))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,o=a.data,c=a.layout,i=a.isAnimationActive,f=a.animationBegin,p=a.animationDuration,g=a.animationEasing,y=a.animationId,b=this.state.prevData;return je.createElement(Ql,{begin:f,duration:p,isActive:i,easing:g,from:{t:0},to:{t:1},key:"bar-".concat(y),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(w){var T=w.t,N=o.map(function(M,O){var C=b&&b[O];if(C){var D=ca(C.x,M.x),L=ca(C.y,M.y),F=ca(C.width,M.width),B=ca(C.height,M.height);return Va(Va({},M),{},{x:D(T),y:L(T),width:F(T),height:B(T)})}if(c==="horizontal"){var U=ca(0,M.height),te=U(T);return Va(Va({},M),{},{y:M.y+M.height-te,height:te})}var Q=ca(0,M.width),re=Q(T);return Va(Va({},M),{},{width:re})});return je.createElement(_s,null,n.renderRectanglesStatically(N))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,o=n.isAnimationActive,c=this.state.prevData;return o&&a&&a.length&&(!c||!Mm(c,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,o=a.data,c=a.dataKey,i=a.activeIndex,f=Or(this.props.background,!1);return o.map(function(p,g){p.value;var y=p.background,b=RLe(p,DLe);if(!y)return null;var w=Va(Va(Va(Va(Va({},b),{},{fill:"#eee"},y),f),Tp(n.props,p,g)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:c,index:g,className:"recharts-bar-background-rectangle"});return je.createElement(JB,F2({key:"background-bar-".concat(g),option:n.props.background,isActive:g===i},w))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,c=o.data,i=o.xAxis,f=o.yAxis,p=o.layout,g=o.children,y=jl(g,tw);if(!y)return null;var b=p==="vertical"?c[0].height/2:c[0].width/2,w=function(M,O){var C=Array.isArray(M.value)?M.value[1]:M.value;return{x:M.x,y:M.y,value:C,errorVal:da(M,O)}},T={clipPath:n?"url(#clipPath-".concat(a,")"):null};return je.createElement(_s,T,y.map(function(N){return je.cloneElement(N,{key:"error-bar-".concat(a,"-").concat(N.props.dataKey),data:c,xAxis:i,yAxis:f,layout:p,offset:b,dataPointFormatter:w})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,o=n.data,c=n.className,i=n.xAxis,f=n.yAxis,p=n.left,g=n.top,y=n.width,b=n.height,w=n.isAnimationActive,T=n.background,N=n.id;if(a||!o||!o.length)return null;var M=this.state.isAnimationFinished,O=rs("recharts-bar",c),C=i&&i.allowDataOverflow,D=f&&f.allowDataOverflow,L=C||D,F=ts(N)?this.id:N;return je.createElement(_s,{className:O},C||D?je.createElement("defs",null,je.createElement("clipPath",{id:"clipPath-".concat(F)},je.createElement("rect",{x:C?p:p-y/2,y:D?g:g-b/2,width:C?y:y*2,height:D?b:b*2}))):null,je.createElement(_s,{className:"recharts-bar-rectangles",clipPath:L?"url(#clipPath-".concat(F,")"):null},T?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(L,F),(!w||M)&&Wc.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(A.PureComponent);ZY=uo;am(uo,"displayName","Bar");am(uo,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Ju.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});am(uo,"getComposedData",function(t){var r=t.props,s=t.item,n=t.barPosition,a=t.bandSize,o=t.xAxis,c=t.yAxis,i=t.xAxisTicks,f=t.yAxisTicks,p=t.stackedData,g=t.dataStartIndex,y=t.displayedData,b=t.offset,w=h4e(n,s);if(!w)return null;var T=r.layout,N=s.type.defaultProps,M=N!==void 0?Va(Va({},N),s.props):s.props,O=M.dataKey,C=M.children,D=M.minPointSize,L=T==="horizontal"?c:o,F=p?L.scale.domain():null,B=v4e({numericAxis:L}),U=jl(C,Rb),te=y.map(function(Q,re){var Z,ne,oe,Ce,Pe,Se;p?Z=m4e(p[g+re],F):(Z=da(Q,O),Array.isArray(Z)||(Z=[B,Z]));var ae=ILe(D,ZY.defaultProps.minPointSize)(Z[1],re);if(T==="horizontal"){var be,de=[c.scale(Z[0]),c.scale(Z[1])],Ke=de[0],He=de[1];ne=B6({axis:o,ticks:i,bandSize:a,offset:w.offset,entry:Q,index:re}),oe=(be=He??Ke)!==null&&be!==void 0?be:void 0,Ce=w.size;var Ve=Ke-He;if(Pe=Number.isNaN(Ve)?0:Ve,Se={x:ne,y:c.y,width:Ce,height:c.height},Math.abs(ae)>0&&Math.abs(Pe)<Math.abs(ae)){var yt=wo(Pe||ae)*(Math.abs(ae)-Math.abs(Pe));oe-=yt,Pe+=yt}}else{var Et=[o.scale(Z[0]),o.scale(Z[1])],Rt=Et[0],Vt=Et[1];if(ne=Rt,oe=B6({axis:c,ticks:f,bandSize:a,offset:w.offset,entry:Q,index:re}),Ce=Vt-Rt,Pe=w.size,Se={x:o.x,y:oe,width:o.width,height:Pe},Math.abs(ae)>0&&Math.abs(Ce)<Math.abs(ae)){var Ct=wo(Ce||ae)*(Math.abs(ae)-Math.abs(Ce));Ce+=Ct}}return Va(Va(Va({},Q),{},{x:ne,y:oe,width:Ce,height:Pe,value:p?Z:Z[1],payload:Q,background:Se},U&&U[re]&&U[re].props),{},{tooltipPayload:[hY(s,Q)],tooltipPosition:{x:ne+Ce/2,y:oe+Pe/2}})});return Va({data:te,layout:T},b)});function u_(t){"@babel/helpers - typeof";return u_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},u_(t)}function WLe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function r8(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,QY(n.key),n)}}function GLe(t,r,s){return r&&r8(t.prototype,r),s&&r8(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function s8(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function Ac(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?s8(Object(s),!0).forEach(function(n){MP(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):s8(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function MP(t,r,s){return r=QY(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function QY(t){var r=KLe(t,"string");return u_(r)=="symbol"?r:r+""}function KLe(t,r){if(u_(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(u_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var cR=function(r,s,n,a,o){var c=r.width,i=r.height,f=r.layout,p=r.children,g=Object.keys(s),y={left:n.left,leftMirror:n.left,right:c-n.right,rightMirror:c-n.right,top:n.top,topMirror:n.top,bottom:i-n.bottom,bottomMirror:i-n.bottom},b=!!dl(p,uo);return g.reduce(function(w,T){var N=s[T],M=N.orientation,O=N.domain,C=N.padding,D=C===void 0?{}:C,L=N.mirror,F=N.reversed,B="".concat(M).concat(L?"Mirror":""),U,te,Q,re,Z;if(N.type==="number"&&(N.padding==="gap"||N.padding==="no-gap")){var ne=O[1]-O[0],oe=1/0,Ce=N.categoricalDomain.sort();if(Ce.forEach(function(Et,Rt){Rt>0&&(oe=Math.min((Et||0)-(Ce[Rt-1]||0),oe))}),Number.isFinite(oe)){var Pe=oe/ne,Se=N.layout==="vertical"?n.height:n.width;if(N.padding==="gap"&&(U=Pe*Se/2),N.padding==="no-gap"){var ae=No(r.barCategoryGap,Pe*Se),be=Pe*Se/2;U=be-ae-(be-ae)/Se*ae}}}a==="xAxis"?te=[n.left+(D.left||0)+(U||0),n.left+n.width-(D.right||0)-(U||0)]:a==="yAxis"?te=f==="horizontal"?[n.top+n.height-(D.bottom||0),n.top+(D.top||0)]:[n.top+(D.top||0)+(U||0),n.top+n.height-(D.bottom||0)-(U||0)]:te=N.range,F&&(te=[te[1],te[0]]);var de=lY(N,o,b),Ke=de.scale,He=de.realScaleType;Ke.domain(O).range(te),cY(Ke);var Ve=dY(Ke,Ac(Ac({},N),{},{realScaleType:He}));a==="xAxis"?(Z=M==="top"&&!L||M==="bottom"&&L,Q=n.left,re=y[B]-Z*N.height):a==="yAxis"&&(Z=M==="left"&&!L||M==="right"&&L,Q=y[B]-Z*N.width,re=n.top);var yt=Ac(Ac(Ac({},N),Ve),{},{realScaleType:He,x:Q,y:re,scale:Ke,width:a==="xAxis"?n.width:N.width,height:a==="yAxis"?n.height:N.height});return yt.bandSize=b2(yt,Ve),!N.hide&&a==="xAxis"?y[B]+=(Z?-1:1)*yt.height:N.hide||(y[B]+=(Z?-1:1)*yt.width),Ac(Ac({},w),{},MP({},T,yt))},{})},JY=function(r,s){var n=r.x,a=r.y,o=s.x,c=s.y;return{x:Math.min(n,o),y:Math.min(a,c),width:Math.abs(o-n),height:Math.abs(c-a)}},HLe=function(r){var s=r.x1,n=r.y1,a=r.x2,o=r.y2;return JY({x:s,y:n},{x:a,y:o})},eX=function(){function t(r){WLe(this,t),this.scale=r}return GLe(t,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,o=n.position;if(s!==void 0){if(o)switch(o){case"start":return this.scale(s);case"middle":{var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(s)+c}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(s)+i}default:return this.scale(s)}if(a){var f=this.bandwidth?this.bandwidth()/2:0;return this.scale(s)+f}return this.scale(s)}}},{key:"isInRange",value:function(s){var n=this.range(),a=n[0],o=n[n.length-1];return a<=o?s>=a&&s<=o:s>=o&&s<=a}}],[{key:"create",value:function(s){return new t(s)}}])}();MP(eX,"EPS",1e-4);var dR=function(r){var s=Object.keys(r).reduce(function(n,a){return Ac(Ac({},n),{},MP({},a,eX.create(r[a])))},{});return Ac(Ac({},s),{},{apply:function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=o.bandAware,i=o.position;return fLe(a,function(f,p){return s[p].apply(f,{bandAware:c,position:i})})},isInRange:function(a){return HY(a,function(o,c){return s[c].isInRange(o)})}})};function ZLe(t){return(t%180+180)%180}var YLe=function(r){var s=r.width,n=r.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=ZLe(a),c=o*Math.PI/180,i=Math.atan(n/s),f=c>i&&c<Math.PI-i?n/Math.sin(c):s/Math.cos(c);return Math.abs(f)},XLe=zd,QLe=Y_,JLe=pP;function eFe(t){return function(r,s,n){var a=Object(r);if(!QLe(r)){var o=XLe(s);r=JLe(r),s=function(i){return o(a[i],i,a)}}var c=t(r,s,n);return c>-1?a[o?r[c]:c]:void 0}}var tFe=eFe,rFe=UY;function sFe(t){var r=rFe(t),s=r%1;return r===r?s?r-s:r:0}var nFe=sFe,aFe=qH,iFe=zd,oFe=nFe,lFe=Math.max;function cFe(t,r,s){var n=t==null?0:t.length;if(!n)return-1;var a=s==null?0:oFe(s);return a<0&&(a=lFe(n+a,0)),aFe(t,iFe(r),a)}var dFe=cFe,uFe=tFe,hFe=dFe,mFe=uFe(hFe),fFe=mFe;const pFe=tn(fFe);var xFe=rje(function(t){return{x:t.left,y:t.top,width:t.width,height:t.height}},function(t){return["l",t.left,"t",t.top,"w",t.width,"h",t.height].join("")}),uR=A.createContext(void 0),hR=A.createContext(void 0),tX=A.createContext(void 0),rX=A.createContext({}),sX=A.createContext(void 0),nX=A.createContext(0),aX=A.createContext(0),n8=function(r){var s=r.state,n=s.xAxisMap,a=s.yAxisMap,o=s.offset,c=r.clipPathId,i=r.children,f=r.width,p=r.height,g=xFe(o);return je.createElement(uR.Provider,{value:n},je.createElement(hR.Provider,{value:a},je.createElement(rX.Provider,{value:o},je.createElement(tX.Provider,{value:g},je.createElement(sX.Provider,{value:c},je.createElement(nX.Provider,{value:p},je.createElement(aX.Provider,{value:f},i)))))))},gFe=function(){return A.useContext(sX)},iX=function(r){var s=A.useContext(uR);s==null&&Op();var n=s[r];return n==null&&Op(),n},yFe=function(){var r=A.useContext(uR);return Vh(r)},vFe=function(){var r=A.useContext(hR),s=pFe(r,function(n){return HY(n.domain,Number.isFinite)});return s||Vh(r)},oX=function(r){var s=A.useContext(hR);s==null&&Op();var n=s[r];return n==null&&Op(),n},jFe=function(){var r=A.useContext(tX);return r},bFe=function(){return A.useContext(rX)},mR=function(){return A.useContext(aX)},fR=function(){return A.useContext(nX)};function Wy(t){"@babel/helpers - typeof";return Wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Wy(t)}function _Fe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function wFe(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cX(n.key),n)}}function NFe(t,r,s){return r&&wFe(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function SFe(t,r,s){return r=z2(r),CFe(t,lX()?Reflect.construct(r,s||[],z2(t).constructor):r.apply(t,s))}function CFe(t,r){if(r&&(Wy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PFe(t)}function PFe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lX(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lX=function(){return!!t})()}function z2(t){return z2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},z2(t)}function kFe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&K4(t,r)}function K4(t,r){return K4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},K4(t,r)}function a8(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function i8(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?a8(Object(s),!0).forEach(function(n){pR(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a8(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function pR(t,r,s){return r=cX(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function cX(t){var r=AFe(t,"string");return Wy(r)=="symbol"?r:r+""}function AFe(t,r){if(Wy(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Wy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function TFe(t,r){return IFe(t)||OFe(t,r)||MFe(t,r)||EFe()}function EFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MFe(t,r){if(t){if(typeof t=="string")return o8(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return o8(t,r)}}function o8(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function OFe(t,r){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var n,a,o,c,i=[],f=!0,p=!1;try{if(o=(s=s.call(t)).next,r!==0)for(;!(f=(n=o.call(s)).done)&&(i.push(n.value),i.length!==r);f=!0);}catch(g){p=!0,a=g}finally{try{if(!f&&s.return!=null&&(c=s.return(),Object(c)!==c))return}finally{if(p)throw a}}return i}}function IFe(t){if(Array.isArray(t))return t}function H4(){return H4=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},H4.apply(this,arguments)}var DFe=function(r,s){var n;return je.isValidElement(r)?n=je.cloneElement(r,s):Wr(r)?n=r(s):n=je.createElement("line",H4({},s,{className:"recharts-reference-line-line"})),n},RFe=function(r,s,n,a,o,c,i,f,p){var g=o.x,y=o.y,b=o.width,w=o.height;if(n){var T=p.y,N=r.y.apply(T,{position:c});if(kd(p,"discard")&&!r.y.isInRange(N))return null;var M=[{x:g+b,y:N},{x:g,y:N}];return f==="left"?M.reverse():M}if(s){var O=p.x,C=r.x.apply(O,{position:c});if(kd(p,"discard")&&!r.x.isInRange(C))return null;var D=[{x:C,y:y+w},{x:C,y}];return i==="top"?D.reverse():D}if(a){var L=p.segment,F=L.map(function(B){return r.apply(B,{position:c})});return kd(p,"discard")&&iLe(F,function(B){return!r.isInRange(B)})?null:F}return null};function LFe(t){var r=t.x,s=t.y,n=t.segment,a=t.xAxisId,o=t.yAxisId,c=t.shape,i=t.className,f=t.alwaysShow,p=gFe(),g=iX(a),y=oX(o),b=jFe();if(!p||!b)return null;Uc(f===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var w=dR({x:g.scale,y:y.scale}),T=di(r),N=di(s),M=n&&n.length===2,O=RFe(w,T,N,M,b,t.position,g.orientation,y.orientation,t);if(!O)return null;var C=TFe(O,2),D=C[0],L=D.x,F=D.y,B=C[1],U=B.x,te=B.y,Q=kd(t,"hidden")?"url(#".concat(p,")"):void 0,re=i8(i8({clipPath:Q},Or(t,!0)),{},{x1:L,y1:F,x2:U,y2:te});return je.createElement(_s,{className:rs("recharts-reference-line",i)},DFe(c,re),wi.renderCallByParent(t,HLe({x1:L,y1:F,x2:U,y2:te})))}var OP=function(t){function r(){return _Fe(this,r),SFe(this,r,arguments)}return kFe(r,t),NFe(r,[{key:"render",value:function(){return je.createElement(LFe,this.props)}}])}(je.Component);pR(OP,"displayName","ReferenceLine");pR(OP,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function Z4(){return Z4=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},Z4.apply(this,arguments)}function Gy(t){"@babel/helpers - typeof";return Gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Gy(t)}function l8(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function c8(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?l8(Object(s),!0).forEach(function(n){IP(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):l8(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function FFe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function $Fe(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,uX(n.key),n)}}function zFe(t,r,s){return r&&$Fe(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function BFe(t,r,s){return r=B2(r),qFe(t,dX()?Reflect.construct(r,s||[],B2(t).constructor):r.apply(t,s))}function qFe(t,r){if(r&&(Gy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VFe(t)}function VFe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dX(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dX=function(){return!!t})()}function B2(t){return B2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},B2(t)}function UFe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&Y4(t,r)}function Y4(t,r){return Y4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Y4(t,r)}function IP(t,r,s){return r=uX(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function uX(t){var r=WFe(t,"string");return Gy(r)=="symbol"?r:r+""}function WFe(t,r){if(Gy(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Gy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var GFe=function(r){var s=r.x,n=r.y,a=r.xAxis,o=r.yAxis,c=dR({x:a.scale,y:o.scale}),i=c.apply({x:s,y:n},{bandAware:!0});return kd(r,"discard")&&!c.isInRange(i)?null:i},DP=function(t){function r(){return FFe(this,r),BFe(this,r,arguments)}return UFe(r,t),zFe(r,[{key:"render",value:function(){var n=this.props,a=n.x,o=n.y,c=n.r,i=n.alwaysShow,f=n.clipPathId,p=di(a),g=di(o);if(Uc(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!p||!g)return null;var y=GFe(this.props);if(!y)return null;var b=y.x,w=y.y,T=this.props,N=T.shape,M=T.className,O=kd(this.props,"hidden")?"url(#".concat(f,")"):void 0,C=c8(c8({clipPath:O},Or(this.props,!0)),{},{cx:b,cy:w});return je.createElement(_s,{className:rs("recharts-reference-dot",M)},r.renderDot(N,C),wi.renderCallByParent(this.props,{x:b-c,y:w-c,width:2*c,height:2*c}))}}])}(je.Component);IP(DP,"displayName","ReferenceDot");IP(DP,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});IP(DP,"renderDot",function(t,r){var s;return je.isValidElement(t)?s=je.cloneElement(t,r):Wr(t)?s=t(r):s=je.createElement(Iv,Z4({},r,{cx:r.cx,cy:r.cy,className:"recharts-reference-dot-dot"})),s});function X4(){return X4=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},X4.apply(this,arguments)}function Ky(t){"@babel/helpers - typeof";return Ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ky(t)}function d8(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function u8(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?d8(Object(s),!0).forEach(function(n){RP(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):d8(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function KFe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function HFe(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mX(n.key),n)}}function ZFe(t,r,s){return r&&HFe(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function YFe(t,r,s){return r=q2(r),XFe(t,hX()?Reflect.construct(r,s||[],q2(t).constructor):r.apply(t,s))}function XFe(t,r){if(r&&(Ky(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QFe(t)}function QFe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hX(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hX=function(){return!!t})()}function q2(t){return q2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},q2(t)}function JFe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&Q4(t,r)}function Q4(t,r){return Q4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Q4(t,r)}function RP(t,r,s){return r=mX(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function mX(t){var r=e5e(t,"string");return Ky(r)=="symbol"?r:r+""}function e5e(t,r){if(Ky(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Ky(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var t5e=function(r,s,n,a,o){var c=o.x1,i=o.x2,f=o.y1,p=o.y2,g=o.xAxis,y=o.yAxis;if(!g||!y)return null;var b=dR({x:g.scale,y:y.scale}),w={x:r?b.x.apply(c,{position:"start"}):b.x.rangeMin,y:n?b.y.apply(f,{position:"start"}):b.y.rangeMin},T={x:s?b.x.apply(i,{position:"end"}):b.x.rangeMax,y:a?b.y.apply(p,{position:"end"}):b.y.rangeMax};return kd(o,"discard")&&(!b.isInRange(w)||!b.isInRange(T))?null:JY(w,T)},LP=function(t){function r(){return KFe(this,r),YFe(this,r,arguments)}return JFe(r,t),ZFe(r,[{key:"render",value:function(){var n=this.props,a=n.x1,o=n.x2,c=n.y1,i=n.y2,f=n.className,p=n.alwaysShow,g=n.clipPathId;Uc(p===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var y=di(a),b=di(o),w=di(c),T=di(i),N=this.props.shape;if(!y&&!b&&!w&&!T&&!N)return null;var M=t5e(y,b,w,T,this.props);if(!M&&!N)return null;var O=kd(this.props,"hidden")?"url(#".concat(g,")"):void 0;return je.createElement(_s,{className:rs("recharts-reference-area",f)},r.renderRect(N,u8(u8({clipPath:O},Or(this.props,!0)),M)),wi.renderCallByParent(this.props,M))}}])}(je.Component);RP(LP,"displayName","ReferenceArea");RP(LP,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});RP(LP,"renderRect",function(t,r){var s;return je.isValidElement(t)?s=je.cloneElement(t,r):Wr(t)?s=t(r):s=je.createElement(lR,X4({},r,{className:"recharts-reference-area-rect"})),s});function fX(t,r,s){if(r<1)return[];if(r===1&&s===void 0)return t;for(var n=[],a=0;a<t.length;a+=r)n.push(t[a]);return n}function r5e(t,r,s){var n={width:t.width+r.width,height:t.height+r.height};return YLe(n,s)}function s5e(t,r,s){var n=s==="width",a=t.x,o=t.y,c=t.width,i=t.height;return r===1?{start:n?a:o,end:n?a+c:o+i}:{start:n?a+c:o+i,end:n?a:o}}function V2(t,r,s,n,a){if(t*r<t*n||t*r>t*a)return!1;var o=s();return t*(r-t*o/2-n)>=0&&t*(r+t*o/2-a)<=0}function n5e(t,r){return fX(t,r+1)}function a5e(t,r,s,n,a){for(var o=(n||[]).slice(),c=r.start,i=r.end,f=0,p=1,g=c,y=function(){var T=n==null?void 0:n[f];if(T===void 0)return{v:fX(n,p)};var N=f,M,O=function(){return M===void 0&&(M=s(T,N)),M},C=T.coordinate,D=f===0||V2(t,C,O,g,i);D||(f=0,g=c,p+=1),D&&(g=C+t*(O()/2+a),f+=p)},b;p<=o.length;)if(b=y(),b)return b.v;return[]}function h_(t){"@babel/helpers - typeof";return h_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},h_(t)}function h8(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function oo(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?h8(Object(s),!0).forEach(function(n){i5e(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):h8(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function i5e(t,r,s){return r=o5e(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function o5e(t){var r=l5e(t,"string");return h_(r)=="symbol"?r:r+""}function l5e(t,r){if(h_(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(h_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function c5e(t,r,s,n,a){for(var o=(n||[]).slice(),c=o.length,i=r.start,f=r.end,p=function(b){var w=o[b],T,N=function(){return T===void 0&&(T=s(w,b)),T};if(b===c-1){var M=t*(w.coordinate+t*N()/2-f);o[b]=w=oo(oo({},w),{},{tickCoord:M>0?w.coordinate-M*t:w.coordinate})}else o[b]=w=oo(oo({},w),{},{tickCoord:w.coordinate});var O=V2(t,w.tickCoord,N,i,f);O&&(f=w.tickCoord-t*(N()/2+a),o[b]=oo(oo({},w),{},{isShow:!0}))},g=c-1;g>=0;g--)p(g);return o}function d5e(t,r,s,n,a,o){var c=(n||[]).slice(),i=c.length,f=r.start,p=r.end;if(o){var g=n[i-1],y=s(g,i-1),b=t*(g.coordinate+t*y/2-p);c[i-1]=g=oo(oo({},g),{},{tickCoord:b>0?g.coordinate-b*t:g.coordinate});var w=V2(t,g.tickCoord,function(){return y},f,p);w&&(p=g.tickCoord-t*(y/2+a),c[i-1]=oo(oo({},g),{},{isShow:!0}))}for(var T=o?i-1:i,N=function(C){var D=c[C],L,F=function(){return L===void 0&&(L=s(D,C)),L};if(C===0){var B=t*(D.coordinate-t*F()/2-f);c[C]=D=oo(oo({},D),{},{tickCoord:B<0?D.coordinate-B*t:D.coordinate})}else c[C]=D=oo(oo({},D),{},{tickCoord:D.coordinate});var U=V2(t,D.tickCoord,F,f,p);U&&(f=D.tickCoord+t*(F()/2+a),c[C]=oo(oo({},D),{},{isShow:!0}))},M=0;M<T;M++)N(M);return c}function xR(t,r,s){var n=t.tick,a=t.ticks,o=t.viewBox,c=t.minTickGap,i=t.orientation,f=t.interval,p=t.tickFormatter,g=t.unit,y=t.angle;if(!a||!a.length||!n)return[];if(cr(f)||Ju.isSsr)return n5e(a,typeof f=="number"&&cr(f)?f:0);var b=[],w=i==="top"||i==="bottom"?"width":"height",T=g&&w==="width"?G0(g,{fontSize:r,letterSpacing:s}):{width:0,height:0},N=function(D,L){var F=Wr(p)?p(D.value,L):D.value;return w==="width"?r5e(G0(F,{fontSize:r,letterSpacing:s}),T,y):G0(F,{fontSize:r,letterSpacing:s})[w]},M=a.length>=2?wo(a[1].coordinate-a[0].coordinate):1,O=s5e(o,M,w);return f==="equidistantPreserveStart"?a5e(M,O,N,a,c):(f==="preserveStart"||f==="preserveStartEnd"?b=d5e(M,O,N,a,c,f==="preserveStartEnd"):b=c5e(M,O,N,a,c),b.filter(function(C){return C.isShow}))}var u5e=["viewBox"],h5e=["viewBox"],m5e=["ticks"];function Hy(t){"@babel/helpers - typeof";return Hy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Hy(t)}function kg(){return kg=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},kg.apply(this,arguments)}function m8(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function yo(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?m8(Object(s),!0).forEach(function(n){gR(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):m8(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function PT(t,r){if(t==null)return{};var s=f5e(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function f5e(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function p5e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function f8(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xX(n.key),n)}}function x5e(t,r,s){return r&&f8(t.prototype,r),s&&f8(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function g5e(t,r,s){return r=U2(r),y5e(t,pX()?Reflect.construct(r,s||[],U2(t).constructor):r.apply(t,s))}function y5e(t,r){if(r&&(Hy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return v5e(t)}function v5e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pX(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pX=function(){return!!t})()}function U2(t){return U2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},U2(t)}function j5e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&J4(t,r)}function J4(t,r){return J4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},J4(t,r)}function gR(t,r,s){return r=xX(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function xX(t){var r=b5e(t,"string");return Hy(r)=="symbol"?r:r+""}function b5e(t,r){if(Hy(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Hy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Lv=function(t){function r(s){var n;return p5e(this,r),n=g5e(this,r,[s]),n.state={fontSize:"",letterSpacing:""},n}return j5e(r,t),x5e(r,[{key:"shouldComponentUpdate",value:function(n,a){var o=n.viewBox,c=PT(n,u5e),i=this.props,f=i.viewBox,p=PT(i,h5e);return!Vg(o,f)||!Vg(c,p)||!Vg(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,o=a.x,c=a.y,i=a.width,f=a.height,p=a.orientation,g=a.tickSize,y=a.mirror,b=a.tickMargin,w,T,N,M,O,C,D=y?-1:1,L=n.tickSize||g,F=cr(n.tickCoord)?n.tickCoord:n.coordinate;switch(p){case"top":w=T=n.coordinate,M=c+ +!y*f,N=M-D*L,C=N-D*b,O=F;break;case"left":N=M=n.coordinate,T=o+ +!y*i,w=T-D*L,O=w-D*b,C=F;break;case"right":N=M=n.coordinate,T=o+ +y*i,w=T+D*L,O=w+D*b,C=F;break;default:w=T=n.coordinate,M=c+ +y*f,N=M+D*L,C=N+D*b,O=F;break}return{line:{x1:w,y1:N,x2:T,y2:M},tick:{x:O,y:C}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,o=n.mirror,c;switch(a){case"left":c=o?"start":"end";break;case"right":c=o?"end":"start";break;default:c="middle";break}return c}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,o=n.mirror,c="end";switch(a){case"left":case"right":c="middle";break;case"top":c=o?"start":"end";break;default:c=o?"end":"start";break}return c}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,o=n.y,c=n.width,i=n.height,f=n.orientation,p=n.mirror,g=n.axisLine,y=yo(yo(yo({},Or(this.props,!1)),Or(g,!1)),{},{fill:"none"});if(f==="top"||f==="bottom"){var b=+(f==="top"&&!p||f==="bottom"&&p);y=yo(yo({},y),{},{x1:a,y1:o+b*i,x2:a+c,y2:o+b*i})}else{var w=+(f==="left"&&!p||f==="right"&&p);y=yo(yo({},y),{},{x1:a+w*c,y1:o,x2:a+w*c,y2:o+i})}return je.createElement("line",kg({},y,{className:rs("recharts-cartesian-axis-line",vl(g,"className"))}))}},{key:"renderTicks",value:function(n,a,o){var c=this,i=this.props,f=i.tickLine,p=i.stroke,g=i.tick,y=i.tickFormatter,b=i.unit,w=xR(yo(yo({},this.props),{},{ticks:n}),a,o),T=this.getTickTextAnchor(),N=this.getTickVerticalAnchor(),M=Or(this.props,!1),O=Or(g,!1),C=yo(yo({},M),{},{fill:"none"},Or(f,!1)),D=w.map(function(L,F){var B=c.getTickLineCoord(L),U=B.line,te=B.tick,Q=yo(yo(yo(yo({textAnchor:T,verticalAnchor:N},M),{},{stroke:"none",fill:p},O),te),{},{index:F,payload:L,visibleTicksCount:w.length,tickFormatter:y});return je.createElement(_s,kg({className:"recharts-cartesian-axis-tick",key:"tick-".concat(L.value,"-").concat(L.coordinate,"-").concat(L.tickCoord)},Tp(c.props,L,F)),f&&je.createElement("line",kg({},C,U,{className:rs("recharts-cartesian-axis-tick-line",vl(f,"className"))})),g&&r.renderTickItem(g,Q,"".concat(Wr(y)?y(L.value,F):L.value).concat(b||"")))});return je.createElement("g",{className:"recharts-cartesian-axis-ticks"},D)}},{key:"render",value:function(){var n=this,a=this.props,o=a.axisLine,c=a.width,i=a.height,f=a.ticksGenerator,p=a.className,g=a.hide;if(g)return null;var y=this.props,b=y.ticks,w=PT(y,m5e),T=b;return Wr(f)&&(T=b&&b.length>0?f(this.props):f(w)),c<=0||i<=0||!T||!T.length?null:je.createElement(_s,{className:rs("recharts-cartesian-axis",p),ref:function(M){n.layerReference=M}},o&&this.renderAxisLine(),this.renderTicks(T,this.state.fontSize,this.state.letterSpacing),wi.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,o){var c;return je.isValidElement(n)?c=je.cloneElement(n,a):Wr(n)?c=n(a):c=je.createElement(Ep,kg({},a,{className:"recharts-cartesian-axis-tick-value"}),o),c}}])}(A.Component);gR(Lv,"displayName","CartesianAxis");gR(Lv,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var _5e=["x1","y1","x2","y2","key"],w5e=["offset"];function Ip(t){"@babel/helpers - typeof";return Ip=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ip(t)}function p8(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function co(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?p8(Object(s),!0).forEach(function(n){N5e(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):p8(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function N5e(t,r,s){return r=S5e(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function S5e(t){var r=C5e(t,"string");return Ip(r)=="symbol"?r:r+""}function C5e(t,r){if(Ip(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Ip(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function Qf(){return Qf=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},Qf.apply(this,arguments)}function x8(t,r){if(t==null)return{};var s=P5e(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function P5e(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}var k5e=function(r){var s=r.fill;if(!s||s==="none")return null;var n=r.fillOpacity,a=r.x,o=r.y,c=r.width,i=r.height,f=r.ry;return je.createElement("rect",{x:a,y:o,ry:f,width:c,height:i,stroke:"none",fill:s,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function gX(t,r){var s;if(je.isValidElement(t))s=je.cloneElement(t,r);else if(Wr(t))s=t(r);else{var n=r.x1,a=r.y1,o=r.x2,c=r.y2,i=r.key,f=x8(r,_5e),p=Or(f,!1);p.offset;var g=x8(p,w5e);s=je.createElement("line",Qf({},g,{x1:n,y1:a,x2:o,y2:c,fill:"none",key:i}))}return s}function A5e(t){var r=t.x,s=t.width,n=t.horizontal,a=n===void 0?!0:n,o=t.horizontalPoints;if(!a||!o||!o.length)return null;var c=o.map(function(i,f){var p=co(co({},t),{},{x1:r,y1:i,x2:r+s,y2:i,key:"line-".concat(f),index:f});return gX(a,p)});return je.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function T5e(t){var r=t.y,s=t.height,n=t.vertical,a=n===void 0?!0:n,o=t.verticalPoints;if(!a||!o||!o.length)return null;var c=o.map(function(i,f){var p=co(co({},t),{},{x1:i,y1:r,x2:i,y2:r+s,key:"line-".concat(f),index:f});return gX(a,p)});return je.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function E5e(t){var r=t.horizontalFill,s=t.fillOpacity,n=t.x,a=t.y,o=t.width,c=t.height,i=t.horizontalPoints,f=t.horizontal,p=f===void 0?!0:f;if(!p||!r||!r.length)return null;var g=i.map(function(b){return Math.round(b+a-a)}).sort(function(b,w){return b-w});a!==g[0]&&g.unshift(0);var y=g.map(function(b,w){var T=!g[w+1],N=T?a+c-b:g[w+1]-b;if(N<=0)return null;var M=w%r.length;return je.createElement("rect",{key:"react-".concat(w),y:b,x:n,height:N,width:o,stroke:"none",fill:r[M],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return je.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},y)}function M5e(t){var r=t.vertical,s=r===void 0?!0:r,n=t.verticalFill,a=t.fillOpacity,o=t.x,c=t.y,i=t.width,f=t.height,p=t.verticalPoints;if(!s||!n||!n.length)return null;var g=p.map(function(b){return Math.round(b+o-o)}).sort(function(b,w){return b-w});o!==g[0]&&g.unshift(0);var y=g.map(function(b,w){var T=!g[w+1],N=T?o+i-b:g[w+1]-b;if(N<=0)return null;var M=w%n.length;return je.createElement("rect",{key:"react-".concat(w),x:b,y:c,width:N,height:f,stroke:"none",fill:n[M],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return je.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},y)}var O5e=function(r,s){var n=r.xAxis,a=r.width,o=r.height,c=r.offset;return oY(xR(co(co(co({},Lv.defaultProps),n),{},{ticks:Au(n,!0),viewBox:{x:0,y:0,width:a,height:o}})),c.left,c.left+c.width,s)},I5e=function(r,s){var n=r.yAxis,a=r.width,o=r.height,c=r.offset;return oY(xR(co(co(co({},Lv.defaultProps),n),{},{ticks:Au(n,!0),viewBox:{x:0,y:0,width:a,height:o}})),c.top,c.top+c.height,s)},ig={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Zi(t){var r,s,n,a,o,c,i=mR(),f=fR(),p=bFe(),g=co(co({},t),{},{stroke:(r=t.stroke)!==null&&r!==void 0?r:ig.stroke,fill:(s=t.fill)!==null&&s!==void 0?s:ig.fill,horizontal:(n=t.horizontal)!==null&&n!==void 0?n:ig.horizontal,horizontalFill:(a=t.horizontalFill)!==null&&a!==void 0?a:ig.horizontalFill,vertical:(o=t.vertical)!==null&&o!==void 0?o:ig.vertical,verticalFill:(c=t.verticalFill)!==null&&c!==void 0?c:ig.verticalFill,x:cr(t.x)?t.x:p.left,y:cr(t.y)?t.y:p.top,width:cr(t.width)?t.width:p.width,height:cr(t.height)?t.height:p.height}),y=g.x,b=g.y,w=g.width,T=g.height,N=g.syncWithTicks,M=g.horizontalValues,O=g.verticalValues,C=yFe(),D=vFe();if(!cr(w)||w<=0||!cr(T)||T<=0||!cr(y)||y!==+y||!cr(b)||b!==+b)return null;var L=g.verticalCoordinatesGenerator||O5e,F=g.horizontalCoordinatesGenerator||I5e,B=g.horizontalPoints,U=g.verticalPoints;if((!B||!B.length)&&Wr(F)){var te=M&&M.length,Q=F({yAxis:D?co(co({},D),{},{ticks:te?M:D.ticks}):void 0,width:i,height:f,offset:p},te?!0:N);Uc(Array.isArray(Q),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Ip(Q),"]")),Array.isArray(Q)&&(B=Q)}if((!U||!U.length)&&Wr(L)){var re=O&&O.length,Z=L({xAxis:C?co(co({},C),{},{ticks:re?O:C.ticks}):void 0,width:i,height:f,offset:p},re?!0:N);Uc(Array.isArray(Z),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Ip(Z),"]")),Array.isArray(Z)&&(U=Z)}return je.createElement("g",{className:"recharts-cartesian-grid"},je.createElement(k5e,{fill:g.fill,fillOpacity:g.fillOpacity,x:g.x,y:g.y,width:g.width,height:g.height,ry:g.ry}),je.createElement(A5e,Qf({},g,{offset:p,horizontalPoints:B,xAxis:C,yAxis:D})),je.createElement(T5e,Qf({},g,{offset:p,verticalPoints:U,xAxis:C,yAxis:D})),je.createElement(E5e,Qf({},g,{horizontalPoints:B})),je.createElement(M5e,Qf({},g,{verticalPoints:U})))}Zi.displayName="CartesianGrid";var D5e=["type","layout","connectNulls","ref"],R5e=["key"];function Zy(t){"@babel/helpers - typeof";return Zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Zy(t)}function g8(t,r){if(t==null)return{};var s=L5e(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function L5e(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function Q0(){return Q0=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},Q0.apply(this,arguments)}function y8(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function il(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?y8(Object(s),!0).forEach(function(n){Tc(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):y8(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function og(t){return B5e(t)||z5e(t)||$5e(t)||F5e()}function F5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $5e(t,r){if(t){if(typeof t=="string")return eO(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return eO(t,r)}}function z5e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function B5e(t){if(Array.isArray(t))return eO(t)}function eO(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function q5e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function v8(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vX(n.key),n)}}function V5e(t,r,s){return r&&v8(t.prototype,r),s&&v8(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function U5e(t,r,s){return r=W2(r),W5e(t,yX()?Reflect.construct(r,s||[],W2(t).constructor):r.apply(t,s))}function W5e(t,r){if(r&&(Zy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G5e(t)}function G5e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yX(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yX=function(){return!!t})()}function W2(t){return W2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},W2(t)}function K5e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&tO(t,r)}function tO(t,r){return tO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},tO(t,r)}function Tc(t,r,s){return r=vX(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function vX(t){var r=H5e(t,"string");return Zy(r)=="symbol"?r:r+""}function H5e(t,r){if(Zy(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Zy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var ui=function(t){function r(){var s;q5e(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return s=U5e(this,r,[].concat(a)),Tc(s,"state",{isAnimationFinished:!0,totalLength:0}),Tc(s,"generateSimpleStrokeDasharray",function(c,i){return"".concat(i,"px ").concat(c-i,"px")}),Tc(s,"getStrokeDasharray",function(c,i,f){var p=f.reduce(function(O,C){return O+C});if(!p)return s.generateSimpleStrokeDasharray(i,c);for(var g=Math.floor(c/p),y=c%p,b=i-c,w=[],T=0,N=0;T<f.length;N+=f[T],++T)if(N+f[T]>y){w=[].concat(og(f.slice(0,T)),[y-N]);break}var M=w.length%2===0?[0,b]:[b];return[].concat(og(r.repeat(f,g)),og(w),M).map(function(O){return"".concat(O,"px")}).join(", ")}),Tc(s,"id",qp("recharts-line-")),Tc(s,"pathRef",function(c){s.mainCurve=c}),Tc(s,"handleAnimationEnd",function(){s.setState({isAnimationFinished:!0}),s.props.onAnimationEnd&&s.props.onAnimationEnd()}),Tc(s,"handleAnimationStart",function(){s.setState({isAnimationFinished:!1}),s.props.onAnimationStart&&s.props.onAnimationStart()}),s}return K5e(r,t),V5e(r,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,c=o.points,i=o.xAxis,f=o.yAxis,p=o.layout,g=o.children,y=jl(g,tw);if(!y)return null;var b=function(N,M){return{x:N.x,y:N.y,value:N.value,errorVal:da(N.payload,M)}},w={clipPath:n?"url(#clipPath-".concat(a,")"):null};return je.createElement(_s,w,y.map(function(T){return je.cloneElement(T,{key:"bar-".concat(T.props.dataKey),data:c,xAxis:i,yAxis:f,layout:p,dataPointFormatter:b})}))}},{key:"renderDots",value:function(n,a,o){var c=this.props.isAnimationActive;if(c&&!this.state.isAnimationFinished)return null;var i=this.props,f=i.dot,p=i.points,g=i.dataKey,y=Or(this.props,!1),b=Or(f,!0),w=p.map(function(N,M){var O=il(il(il({key:"dot-".concat(M),r:3},y),b),{},{value:N.value,dataKey:g,cx:N.x,cy:N.y,index:M,payload:N.payload});return r.renderDotItem(f,O)}),T={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(o,")"):null};return je.createElement(_s,Q0({className:"recharts-line-dots",key:"dots"},T),w)}},{key:"renderCurveStatically",value:function(n,a,o,c){var i=this.props,f=i.type,p=i.layout,g=i.connectNulls;i.ref;var y=g8(i,D5e),b=il(il(il({},Or(y,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(o,")"):null,points:n},c),{},{type:f,layout:p,connectNulls:g});return je.createElement(hp,Q0({},b,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var o=this,c=this.props,i=c.points,f=c.strokeDasharray,p=c.isAnimationActive,g=c.animationBegin,y=c.animationDuration,b=c.animationEasing,w=c.animationId,T=c.animateNewValues,N=c.width,M=c.height,O=this.state,C=O.prevPoints,D=O.totalLength;return je.createElement(Ql,{begin:g,duration:y,isActive:p,easing:b,from:{t:0},to:{t:1},key:"line-".concat(w),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(L){var F=L.t;if(C){var B=C.length/i.length,U=i.map(function(ne,oe){var Ce=Math.floor(oe*B);if(C[Ce]){var Pe=C[Ce],Se=ca(Pe.x,ne.x),ae=ca(Pe.y,ne.y);return il(il({},ne),{},{x:Se(F),y:ae(F)})}if(T){var be=ca(N*2,ne.x),de=ca(M/2,ne.y);return il(il({},ne),{},{x:be(F),y:de(F)})}return il(il({},ne),{},{x:ne.x,y:ne.y})});return o.renderCurveStatically(U,n,a)}var te=ca(0,D),Q=te(F),re;if(f){var Z="".concat(f).split(/[,\s]+/gim).map(function(ne){return parseFloat(ne)});re=o.getStrokeDasharray(Q,D,Z)}else re=o.generateSimpleStrokeDasharray(D,Q);return o.renderCurveStatically(i,n,a,{strokeDasharray:re})})}},{key:"renderCurve",value:function(n,a){var o=this.props,c=o.points,i=o.isAnimationActive,f=this.state,p=f.prevPoints,g=f.totalLength;return i&&c&&c.length&&(!p&&g>0||!Mm(p,c))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(c,n,a)}},{key:"render",value:function(){var n,a=this.props,o=a.hide,c=a.dot,i=a.points,f=a.className,p=a.xAxis,g=a.yAxis,y=a.top,b=a.left,w=a.width,T=a.height,N=a.isAnimationActive,M=a.id;if(o||!i||!i.length)return null;var O=this.state.isAnimationFinished,C=i.length===1,D=rs("recharts-line",f),L=p&&p.allowDataOverflow,F=g&&g.allowDataOverflow,B=L||F,U=ts(M)?this.id:M,te=(n=Or(c,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},Q=te.r,re=Q===void 0?3:Q,Z=te.strokeWidth,ne=Z===void 0?2:Z,oe=JK(c)?c:{},Ce=oe.clipDot,Pe=Ce===void 0?!0:Ce,Se=re*2+ne;return je.createElement(_s,{className:D},L||F?je.createElement("defs",null,je.createElement("clipPath",{id:"clipPath-".concat(U)},je.createElement("rect",{x:L?b:b-w/2,y:F?y:y-T/2,width:L?w:w*2,height:F?T:T*2})),!Pe&&je.createElement("clipPath",{id:"clipPath-dots-".concat(U)},je.createElement("rect",{x:b-Se/2,y:y-Se/2,width:w+Se,height:T+Se}))):null,!C&&this.renderCurve(B,U),this.renderErrorBar(B,U),(C||c)&&this.renderDots(B,Pe,U),(!N||O)&&Wc.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var o=n.length%2!==0?[].concat(og(n),[0]):n,c=[],i=0;i<a;++i)c=[].concat(og(c),og(o));return c}},{key:"renderDotItem",value:function(n,a){var o;if(je.isValidElement(n))o=je.cloneElement(n,a);else if(Wr(n))o=n(a);else{var c=a.key,i=g8(a,R5e),f=rs("recharts-line-dot",typeof n!="boolean"?n.className:"");o=je.createElement(Iv,Q0({key:c},i,{className:f}))}return o}}])}(A.PureComponent);Tc(ui,"displayName","Line");Tc(ui,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Ju.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Tc(ui,"getComposedData",function(t){var r=t.props,s=t.xAxis,n=t.yAxis,a=t.xAxisTicks,o=t.yAxisTicks,c=t.dataKey,i=t.bandSize,f=t.displayedData,p=t.offset,g=r.layout,y=f.map(function(b,w){var T=da(b,c);return g==="horizontal"?{x:j2({axis:s,ticks:a,bandSize:i,entry:b,index:w}),y:ts(T)?null:n.scale(T),value:T,payload:b}:{x:ts(T)?null:s.scale(T),y:j2({axis:n,ticks:o,bandSize:i,entry:b,index:w}),value:T,payload:b}});return il({points:y,layout:g},p)});var Z5e=["layout","type","stroke","connectNulls","isRange","ref"],Y5e=["key"],jX;function Yy(t){"@babel/helpers - typeof";return Yy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Yy(t)}function bX(t,r){if(t==null)return{};var s=X5e(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function X5e(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function Jf(){return Jf=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},Jf.apply(this,arguments)}function j8(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function Dh(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?j8(Object(s),!0).forEach(function(n){_d(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):j8(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function Q5e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function b8(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wX(n.key),n)}}function J5e(t,r,s){return r&&b8(t.prototype,r),s&&b8(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function e$e(t,r,s){return r=G2(r),t$e(t,_X()?Reflect.construct(r,s||[],G2(t).constructor):r.apply(t,s))}function t$e(t,r){if(r&&(Yy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r$e(t)}function r$e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _X(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_X=function(){return!!t})()}function G2(t){return G2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},G2(t)}function s$e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&rO(t,r)}function rO(t,r){return rO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},rO(t,r)}function _d(t,r,s){return r=wX(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function wX(t){var r=n$e(t,"string");return Yy(r)=="symbol"?r:r+""}function n$e(t,r){if(Yy(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Yy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Jl=function(t){function r(){var s;Q5e(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return s=e$e(this,r,[].concat(a)),_d(s,"state",{isAnimationFinished:!0}),_d(s,"id",qp("recharts-area-")),_d(s,"handleAnimationEnd",function(){var c=s.props.onAnimationEnd;s.setState({isAnimationFinished:!0}),Wr(c)&&c()}),_d(s,"handleAnimationStart",function(){var c=s.props.onAnimationStart;s.setState({isAnimationFinished:!1}),Wr(c)&&c()}),s}return s$e(r,t),J5e(r,[{key:"renderDots",value:function(n,a,o){var c=this.props.isAnimationActive,i=this.state.isAnimationFinished;if(c&&!i)return null;var f=this.props,p=f.dot,g=f.points,y=f.dataKey,b=Or(this.props,!1),w=Or(p,!0),T=g.map(function(M,O){var C=Dh(Dh(Dh({key:"dot-".concat(O),r:3},b),w),{},{index:O,cx:M.x,cy:M.y,dataKey:y,value:M.value,payload:M.payload,points:g});return r.renderDotItem(p,C)}),N={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(o,")"):null};return je.createElement(_s,Jf({className:"recharts-area-dots"},N),T)}},{key:"renderHorizontalRect",value:function(n){var a=this.props,o=a.baseLine,c=a.points,i=a.strokeWidth,f=c[0].x,p=c[c.length-1].x,g=n*Math.abs(f-p),y=nm(c.map(function(b){return b.y||0}));return cr(o)&&typeof o=="number"?y=Math.max(o,y):o&&Array.isArray(o)&&o.length&&(y=Math.max(nm(o.map(function(b){return b.y||0})),y)),cr(y)?je.createElement("rect",{x:f<p?f:f-g,y:0,width:g,height:Math.floor(y+(i?parseInt("".concat(i),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var a=this.props,o=a.baseLine,c=a.points,i=a.strokeWidth,f=c[0].y,p=c[c.length-1].y,g=n*Math.abs(f-p),y=nm(c.map(function(b){return b.x||0}));return cr(o)&&typeof o=="number"?y=Math.max(o,y):o&&Array.isArray(o)&&o.length&&(y=Math.max(nm(o.map(function(b){return b.x||0})),y)),cr(y)?je.createElement("rect",{x:0,y:f<p?f:f-g,width:y+(i?parseInt("".concat(i),10):1),height:Math.floor(g)}):null}},{key:"renderClipRect",value:function(n){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,a,o,c){var i=this.props,f=i.layout,p=i.type,g=i.stroke,y=i.connectNulls,b=i.isRange;i.ref;var w=bX(i,Z5e);return je.createElement(_s,{clipPath:o?"url(#clipPath-".concat(c,")"):null},je.createElement(hp,Jf({},Or(w,!0),{points:n,connectNulls:y,type:p,baseLine:a,layout:f,stroke:"none",className:"recharts-area-area"})),g!=="none"&&je.createElement(hp,Jf({},Or(this.props,!1),{className:"recharts-area-curve",layout:f,type:p,connectNulls:y,fill:"none",points:n})),g!=="none"&&b&&je.createElement(hp,Jf({},Or(this.props,!1),{className:"recharts-area-curve",layout:f,type:p,connectNulls:y,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(n,a){var o=this,c=this.props,i=c.points,f=c.baseLine,p=c.isAnimationActive,g=c.animationBegin,y=c.animationDuration,b=c.animationEasing,w=c.animationId,T=this.state,N=T.prevPoints,M=T.prevBaseLine;return je.createElement(Ql,{begin:g,duration:y,isActive:p,easing:b,from:{t:0},to:{t:1},key:"area-".concat(w),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(O){var C=O.t;if(N){var D=N.length/i.length,L=i.map(function(te,Q){var re=Math.floor(Q*D);if(N[re]){var Z=N[re],ne=ca(Z.x,te.x),oe=ca(Z.y,te.y);return Dh(Dh({},te),{},{x:ne(C),y:oe(C)})}return te}),F;if(cr(f)&&typeof f=="number"){var B=ca(M,f);F=B(C)}else if(ts(f)||Cv(f)){var U=ca(M,0);F=U(C)}else F=f.map(function(te,Q){var re=Math.floor(Q*D);if(M[re]){var Z=M[re],ne=ca(Z.x,te.x),oe=ca(Z.y,te.y);return Dh(Dh({},te),{},{x:ne(C),y:oe(C)})}return te});return o.renderAreaStatically(L,F,n,a)}return je.createElement(_s,null,je.createElement("defs",null,je.createElement("clipPath",{id:"animationClipPath-".concat(a)},o.renderClipRect(C))),je.createElement(_s,{clipPath:"url(#animationClipPath-".concat(a,")")},o.renderAreaStatically(i,f,n,a)))})}},{key:"renderArea",value:function(n,a){var o=this.props,c=o.points,i=o.baseLine,f=o.isAnimationActive,p=this.state,g=p.prevPoints,y=p.prevBaseLine,b=p.totalLength;return f&&c&&c.length&&(!g&&b>0||!Mm(g,c)||!Mm(y,i))?this.renderAreaWithAnimation(n,a):this.renderAreaStatically(c,i,n,a)}},{key:"render",value:function(){var n,a=this.props,o=a.hide,c=a.dot,i=a.points,f=a.className,p=a.top,g=a.left,y=a.xAxis,b=a.yAxis,w=a.width,T=a.height,N=a.isAnimationActive,M=a.id;if(o||!i||!i.length)return null;var O=this.state.isAnimationFinished,C=i.length===1,D=rs("recharts-area",f),L=y&&y.allowDataOverflow,F=b&&b.allowDataOverflow,B=L||F,U=ts(M)?this.id:M,te=(n=Or(c,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},Q=te.r,re=Q===void 0?3:Q,Z=te.strokeWidth,ne=Z===void 0?2:Z,oe=JK(c)?c:{},Ce=oe.clipDot,Pe=Ce===void 0?!0:Ce,Se=re*2+ne;return je.createElement(_s,{className:D},L||F?je.createElement("defs",null,je.createElement("clipPath",{id:"clipPath-".concat(U)},je.createElement("rect",{x:L?g:g-w/2,y:F?p:p-T/2,width:L?w:w*2,height:F?T:T*2})),!Pe&&je.createElement("clipPath",{id:"clipPath-dots-".concat(U)},je.createElement("rect",{x:g-Se/2,y:p-Se/2,width:w+Se,height:T+Se}))):null,C?null:this.renderArea(B,U),(c||C)&&this.renderDots(B,Pe,U),(!N||O)&&Wc.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:n.points!==a.curPoints||n.baseLine!==a.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(A.PureComponent);jX=Jl;_d(Jl,"displayName","Area");_d(Jl,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Ju.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});_d(Jl,"getBaseValue",function(t,r,s,n){var a=t.layout,o=t.baseValue,c=r.props.baseValue,i=c??o;if(cr(i)&&typeof i=="number")return i;var f=a==="horizontal"?n:s,p=f.scale.domain();if(f.type==="number"){var g=Math.max(p[0],p[1]),y=Math.min(p[0],p[1]);return i==="dataMin"?y:i==="dataMax"||g<0?g:Math.max(Math.min(p[0],p[1]),0)}return i==="dataMin"?p[0]:i==="dataMax"?p[1]:p[0]});_d(Jl,"getComposedData",function(t){var r=t.props,s=t.item,n=t.xAxis,a=t.yAxis,o=t.xAxisTicks,c=t.yAxisTicks,i=t.bandSize,f=t.dataKey,p=t.stackedData,g=t.dataStartIndex,y=t.displayedData,b=t.offset,w=r.layout,T=p&&p.length,N=jX.getBaseValue(r,s,n,a),M=w==="horizontal",O=!1,C=y.map(function(L,F){var B;T?B=p[g+F]:(B=da(L,f),Array.isArray(B)?O=!0:B=[N,B]);var U=B[1]==null||T&&da(L,f)==null;return M?{x:j2({axis:n,ticks:o,bandSize:i,entry:L,index:F}),y:U?null:a.scale(B[1]),value:B,payload:L}:{x:U?null:n.scale(B[1]),y:j2({axis:a,ticks:c,bandSize:i,entry:L,index:F}),value:B,payload:L}}),D;return T||O?D=C.map(function(L){var F=Array.isArray(L.value)?L.value[0]:null;return M?{x:L.x,y:F!=null&&L.y!=null?a.scale(F):null}:{x:F!=null?n.scale(F):null,y:L.y}}):D=M?a.scale(N):n.scale(N),Dh({points:C,baseLine:D,layout:w,isRange:O},b)});_d(Jl,"renderDotItem",function(t,r){var s;if(je.isValidElement(t))s=je.cloneElement(t,r);else if(Wr(t))s=t(r);else{var n=rs("recharts-area-dot",typeof t!="boolean"?t.className:""),a=r.key,o=bX(r,Y5e);s=je.createElement(Iv,Jf({},o,{key:a,className:n}))}return s});function Xy(t){"@babel/helpers - typeof";return Xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Xy(t)}function a$e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function i$e(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,CX(n.key),n)}}function o$e(t,r,s){return r&&i$e(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function l$e(t,r,s){return r=K2(r),c$e(t,NX()?Reflect.construct(r,s||[],K2(t).constructor):r.apply(t,s))}function c$e(t,r){if(r&&(Xy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return d$e(t)}function d$e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function NX(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NX=function(){return!!t})()}function K2(t){return K2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},K2(t)}function u$e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&sO(t,r)}function sO(t,r){return sO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},sO(t,r)}function SX(t,r,s){return r=CX(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function CX(t){var r=h$e(t,"string");return Xy(r)=="symbol"?r:r+""}function h$e(t,r){if(Xy(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Xy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function nO(){return nO=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},nO.apply(this,arguments)}function m$e(t){var r=t.xAxisId,s=mR(),n=fR(),a=iX(r);return a==null?null:je.createElement(Lv,nO({},a,{className:rs("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:s,height:n},ticksGenerator:function(c){return Au(c,!0)}}))}var Ma=function(t){function r(){return a$e(this,r),l$e(this,r,arguments)}return u$e(r,t),o$e(r,[{key:"render",value:function(){return je.createElement(m$e,this.props)}}])}(je.Component);SX(Ma,"displayName","XAxis");SX(Ma,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Qy(t){"@babel/helpers - typeof";return Qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Qy(t)}function f$e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function p$e(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,AX(n.key),n)}}function x$e(t,r,s){return r&&p$e(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function g$e(t,r,s){return r=H2(r),y$e(t,PX()?Reflect.construct(r,s||[],H2(t).constructor):r.apply(t,s))}function y$e(t,r){if(r&&(Qy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return v$e(t)}function v$e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function PX(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(PX=function(){return!!t})()}function H2(t){return H2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},H2(t)}function j$e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&aO(t,r)}function aO(t,r){return aO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},aO(t,r)}function kX(t,r,s){return r=AX(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function AX(t){var r=b$e(t,"string");return Qy(r)=="symbol"?r:r+""}function b$e(t,r){if(Qy(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Qy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function iO(){return iO=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},iO.apply(this,arguments)}var _$e=function(r){var s=r.yAxisId,n=mR(),a=fR(),o=oX(s);return o==null?null:je.createElement(Lv,iO({},o,{className:rs("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(i){return Au(i,!0)}}))},fa=function(t){function r(){return f$e(this,r),g$e(this,r,arguments)}return j$e(r,t),x$e(r,[{key:"render",value:function(){return je.createElement(_$e,this.props)}}])}(je.Component);kX(fa,"displayName","YAxis");kX(fa,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function _8(t){return C$e(t)||S$e(t)||N$e(t)||w$e()}function w$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N$e(t,r){if(t){if(typeof t=="string")return oO(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return oO(t,r)}}function S$e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function C$e(t){if(Array.isArray(t))return oO(t)}function oO(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}var lO=function(r,s,n,a,o){var c=jl(r,OP),i=jl(r,DP),f=[].concat(_8(c),_8(i)),p=jl(r,LP),g="".concat(a,"Id"),y=a[0],b=s;if(f.length&&(b=f.reduce(function(N,M){if(M.props[g]===n&&kd(M.props,"extendDomain")&&cr(M.props[y])){var O=M.props[y];return[Math.min(N[0],O),Math.max(N[1],O)]}return N},b)),p.length){var w="".concat(y,"1"),T="".concat(y,"2");b=p.reduce(function(N,M){if(M.props[g]===n&&kd(M.props,"extendDomain")&&cr(M.props[w])&&cr(M.props[T])){var O=M.props[w],C=M.props[T];return[Math.min(N[0],O,C),Math.max(N[1],O,C)]}return N},b)}return o&&o.length&&(b=o.reduce(function(N,M){return cr(M)?[Math.min(N[0],M),Math.max(N[1],M)]:N},b)),b},TX={exports:{}};(function(t){var r=Object.prototype.hasOwnProperty,s="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(s=!1));function a(f,p,g){this.fn=f,this.context=p,this.once=g||!1}function o(f,p,g,y,b){if(typeof g!="function")throw new TypeError("The listener must be a function");var w=new a(g,y||f,b),T=s?s+p:p;return f._events[T]?f._events[T].fn?f._events[T]=[f._events[T],w]:f._events[T].push(w):(f._events[T]=w,f._eventsCount++),f}function c(f,p){--f._eventsCount===0?f._events=new n:delete f._events[p]}function i(){this._events=new n,this._eventsCount=0}i.prototype.eventNames=function(){var p=[],g,y;if(this._eventsCount===0)return p;for(y in g=this._events)r.call(g,y)&&p.push(s?y.slice(1):y);return Object.getOwnPropertySymbols?p.concat(Object.getOwnPropertySymbols(g)):p},i.prototype.listeners=function(p){var g=s?s+p:p,y=this._events[g];if(!y)return[];if(y.fn)return[y.fn];for(var b=0,w=y.length,T=new Array(w);b<w;b++)T[b]=y[b].fn;return T},i.prototype.listenerCount=function(p){var g=s?s+p:p,y=this._events[g];return y?y.fn?1:y.length:0},i.prototype.emit=function(p,g,y,b,w,T){var N=s?s+p:p;if(!this._events[N])return!1;var M=this._events[N],O=arguments.length,C,D;if(M.fn){switch(M.once&&this.removeListener(p,M.fn,void 0,!0),O){case 1:return M.fn.call(M.context),!0;case 2:return M.fn.call(M.context,g),!0;case 3:return M.fn.call(M.context,g,y),!0;case 4:return M.fn.call(M.context,g,y,b),!0;case 5:return M.fn.call(M.context,g,y,b,w),!0;case 6:return M.fn.call(M.context,g,y,b,w,T),!0}for(D=1,C=new Array(O-1);D<O;D++)C[D-1]=arguments[D];M.fn.apply(M.context,C)}else{var L=M.length,F;for(D=0;D<L;D++)switch(M[D].once&&this.removeListener(p,M[D].fn,void 0,!0),O){case 1:M[D].fn.call(M[D].context);break;case 2:M[D].fn.call(M[D].context,g);break;case 3:M[D].fn.call(M[D].context,g,y);break;case 4:M[D].fn.call(M[D].context,g,y,b);break;default:if(!C)for(F=1,C=new Array(O-1);F<O;F++)C[F-1]=arguments[F];M[D].fn.apply(M[D].context,C)}}return!0},i.prototype.on=function(p,g,y){return o(this,p,g,y,!1)},i.prototype.once=function(p,g,y){return o(this,p,g,y,!0)},i.prototype.removeListener=function(p,g,y,b){var w=s?s+p:p;if(!this._events[w])return this;if(!g)return c(this,w),this;var T=this._events[w];if(T.fn)T.fn===g&&(!b||T.once)&&(!y||T.context===y)&&c(this,w);else{for(var N=0,M=[],O=T.length;N<O;N++)(T[N].fn!==g||b&&!T[N].once||y&&T[N].context!==y)&&M.push(T[N]);M.length?this._events[w]=M.length===1?M[0]:M:c(this,w)}return this},i.prototype.removeAllListeners=function(p){var g;return p?(g=s?s+p:p,this._events[g]&&c(this,g)):(this._events=new n,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=s,i.EventEmitter=i,t.exports=i})(TX);var P$e=TX.exports;const k$e=tn(P$e);var kT=new k$e,AT="recharts.syncMouseEvents";function m_(t){"@babel/helpers - typeof";return m_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},m_(t)}function A$e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function T$e(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,EX(n.key),n)}}function E$e(t,r,s){return r&&T$e(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function TT(t,r,s){return r=EX(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function EX(t){var r=M$e(t,"string");return m_(r)=="symbol"?r:r+""}function M$e(t,r){if(m_(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(m_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var O$e=function(){function t(){A$e(this,t),TT(this,"activeIndex",0),TT(this,"coordinateList",[]),TT(this,"layout","horizontal")}return E$e(t,[{key:"setDetails",value:function(s){var n,a=s.coordinateList,o=a===void 0?null:a,c=s.container,i=c===void 0?null:c,f=s.layout,p=f===void 0?null:f,g=s.offset,y=g===void 0?null:g,b=s.mouseHandlerCallback,w=b===void 0?null:b;this.coordinateList=(n=o??this.coordinateList)!==null&&n!==void 0?n:[],this.container=i??this.container,this.layout=p??this.layout,this.offset=y??this.offset,this.mouseHandlerCallback=w??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(s){if(this.coordinateList.length!==0)switch(s.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(s){this.activeIndex=s}},{key:"spoofMouse",value:function(){var s,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),o=a.x,c=a.y,i=a.height,f=this.coordinateList[this.activeIndex].coordinate,p=((s=window)===null||s===void 0?void 0:s.scrollX)||0,g=((n=window)===null||n===void 0?void 0:n.scrollY)||0,y=o+f+p,b=c+this.offset.top+i/2+g;this.mouseHandlerCallback({pageX:y,pageY:b})}}}])}();function I$e(t,r,s){if(s==="number"&&r===!0&&Array.isArray(t)){var n=t==null?void 0:t[0],a=t==null?void 0:t[1];if(n&&a&&cr(n)&&cr(a))return!0}return!1}function D$e(t,r,s,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?r.x-a:s.left+.5,y:t==="horizontal"?s.top+.5:r.y-a,width:t==="horizontal"?n:s.width-1,height:t==="horizontal"?s.height-1:n}}function MX(t){var r=t.cx,s=t.cy,n=t.radius,a=t.startAngle,o=t.endAngle,c=sn(r,s,n,a),i=sn(r,s,n,o);return{points:[c,i],cx:r,cy:s,radius:n,startAngle:a,endAngle:o}}function R$e(t,r,s){var n,a,o,c;if(t==="horizontal")n=r.x,o=n,a=s.top,c=s.top+s.height;else if(t==="vertical")a=r.y,c=a,n=s.left,o=s.left+s.width;else if(r.cx!=null&&r.cy!=null)if(t==="centric"){var i=r.cx,f=r.cy,p=r.innerRadius,g=r.outerRadius,y=r.angle,b=sn(i,f,p,y),w=sn(i,f,g,y);n=b.x,a=b.y,o=w.x,c=w.y}else return MX(r);return[{x:n,y:a},{x:o,y:c}]}function f_(t){"@babel/helpers - typeof";return f_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},f_(t)}function w8(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function _N(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?w8(Object(s),!0).forEach(function(n){L$e(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):w8(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function L$e(t,r,s){return r=F$e(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function F$e(t){var r=$$e(t,"string");return f_(r)=="symbol"?r:r+""}function $$e(t,r){if(f_(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(f_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function z$e(t){var r,s,n=t.element,a=t.tooltipEventType,o=t.isActive,c=t.activeCoordinate,i=t.activePayload,f=t.offset,p=t.activeTooltipIndex,g=t.tooltipAxisBandSize,y=t.layout,b=t.chartName,w=(r=n.props.cursor)!==null&&r!==void 0?r:(s=n.type.defaultProps)===null||s===void 0?void 0:s.cursor;if(!n||!w||!o||!c||b!=="ScatterChart"&&a!=="axis")return null;var T,N=hp;if(b==="ScatterChart")T=c,N=wDe;else if(b==="BarChart")T=D$e(y,c,f,g),N=lR;else if(y==="radial"){var M=MX(c),O=M.cx,C=M.cy,D=M.radius,L=M.startAngle,F=M.endAngle;T={cx:O,cy:C,startAngle:L,endAngle:F,innerRadius:D,outerRadius:D},N=jY}else T={points:R$e(y,c,f)},N=hp;var B=_N(_N(_N(_N({stroke:"#ccc",pointerEvents:"none"},f),T),Or(w,!1)),{},{payload:i,payloadIndex:p,className:rs("recharts-tooltip-cursor",w.className)});return A.isValidElement(w)?A.cloneElement(w,B):A.createElement(N,B)}var B$e=["item"],q$e=["children","className","width","height","style","compact","title","desc"];function Jy(t){"@babel/helpers - typeof";return Jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Jy(t)}function Ag(){return Ag=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},Ag.apply(this,arguments)}function N8(t,r){return W$e(t)||U$e(t,r)||IX(t,r)||V$e()}function V$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function U$e(t,r){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var n,a,o,c,i=[],f=!0,p=!1;try{if(o=(s=s.call(t)).next,r!==0)for(;!(f=(n=o.call(s)).done)&&(i.push(n.value),i.length!==r);f=!0);}catch(g){p=!0,a=g}finally{try{if(!f&&s.return!=null&&(c=s.return(),Object(c)!==c))return}finally{if(p)throw a}}return i}}function W$e(t){if(Array.isArray(t))return t}function S8(t,r){if(t==null)return{};var s=G$e(t,r),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function G$e(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function K$e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function H$e(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,DX(n.key),n)}}function Z$e(t,r,s){return r&&H$e(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Y$e(t,r,s){return r=Z2(r),X$e(t,OX()?Reflect.construct(r,s||[],Z2(t).constructor):r.apply(t,s))}function X$e(t,r){if(r&&(Jy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Q$e(t)}function Q$e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function OX(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OX=function(){return!!t})()}function Z2(t){return Z2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},Z2(t)}function J$e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&cO(t,r)}function cO(t,r){return cO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},cO(t,r)}function ev(t){return rze(t)||tze(t)||IX(t)||eze()}function eze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IX(t,r){if(t){if(typeof t=="string")return dO(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return dO(t,r)}}function tze(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function rze(t){if(Array.isArray(t))return dO(t)}function dO(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function C8(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function Ft(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?C8(Object(s),!0).forEach(function(n){Zr(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):C8(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function Zr(t,r,s){return r=DX(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function DX(t){var r=sze(t,"string");return Jy(r)=="symbol"?r:r+""}function sze(t,r){if(Jy(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(Jy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var nze={xAxis:["bottom","top"],yAxis:["left","right"]},aze={width:"100%",height:"100%"},RX={x:0,y:0};function wN(t){return t}var ize=function(r,s){return s==="horizontal"?r.x:s==="vertical"?r.y:s==="centric"?r.angle:r.radius},oze=function(r,s,n,a){var o=s.find(function(g){return g&&g.index===n});if(o){if(r==="horizontal")return{x:o.coordinate,y:a.y};if(r==="vertical")return{x:a.x,y:o.coordinate};if(r==="centric"){var c=o.coordinate,i=a.radius;return Ft(Ft(Ft({},a),sn(a.cx,a.cy,i,c)),{},{angle:c,radius:i})}var f=o.coordinate,p=a.angle;return Ft(Ft(Ft({},a),sn(a.cx,a.cy,f,p)),{},{angle:p,radius:f})}return RX},FP=function(r,s){var n=s.graphicalItems,a=s.dataStartIndex,o=s.dataEndIndex,c=(n??[]).reduce(function(i,f){var p=f.props.data;return p&&p.length?[].concat(ev(i),ev(p)):i},[]);return c.length>0?c:r&&r.length&&cr(a)&&cr(o)?r.slice(a,o+1):[]};function LX(t){return t==="number"?[0,"auto"]:void 0}var uO=function(r,s,n,a){var o=r.graphicalItems,c=r.tooltipAxis,i=FP(s,r);return n<0||!o||!o.length||n>=i.length?null:o.reduce(function(f,p){var g,y=(g=p.props.data)!==null&&g!==void 0?g:s;y&&r.dataStartIndex+r.dataEndIndex!==0&&r.dataEndIndex-r.dataStartIndex>=n&&(y=y.slice(r.dataStartIndex,r.dataEndIndex+1));var b;if(c.dataKey&&!c.allowDuplicatedCategory){var w=y===void 0?i:y;b=GS(w,c.dataKey,a)}else b=y&&y[n]||i[n];return b?[].concat(ev(f),[hY(p,b)]):f},[])},P8=function(r,s,n,a){var o=a||{x:r.chartX,y:r.chartY},c=ize(o,n),i=r.orderedTooltipTicks,f=r.tooltipAxis,p=r.tooltipTicks,g=i4e(c,i,p,f);if(g>=0&&p){var y=p[g]&&p[g].value,b=uO(r,s,g,y),w=oze(n,i,g,o);return{activeTooltipIndex:g,activeLabel:y,activePayload:b,activeCoordinate:w}}return null},lze=function(r,s){var n=s.axes,a=s.graphicalItems,o=s.axisType,c=s.axisIdKey,i=s.stackGroups,f=s.dataStartIndex,p=s.dataEndIndex,g=r.layout,y=r.children,b=r.stackOffset,w=iY(g,o);return n.reduce(function(T,N){var M,O=N.type.defaultProps!==void 0?Ft(Ft({},N.type.defaultProps),N.props):N.props,C=O.type,D=O.dataKey,L=O.allowDataOverflow,F=O.allowDuplicatedCategory,B=O.scale,U=O.ticks,te=O.includeHidden,Q=O[c];if(T[Q])return T;var re=FP(r.data,{graphicalItems:a.filter(function(Ve){var yt,Et=c in Ve.props?Ve.props[c]:(yt=Ve.type.defaultProps)===null||yt===void 0?void 0:yt[c];return Et===Q}),dataStartIndex:f,dataEndIndex:p}),Z=re.length,ne,oe,Ce;I$e(O.domain,L,C)&&(ne=w4(O.domain,null,L),w&&(C==="number"||B!=="auto")&&(Ce=H0(re,D,"category")));var Pe=LX(C);if(!ne||ne.length===0){var Se,ae=(Se=O.domain)!==null&&Se!==void 0?Se:Pe;if(D){if(ne=H0(re,D,C),C==="category"&&w){var be=Xje(ne);F&&be?(oe=ne,ne=D2(0,Z)):F||(ne=U6(ae,ne,N).reduce(function(Ve,yt){return Ve.indexOf(yt)>=0?Ve:[].concat(ev(Ve),[yt])},[]))}else if(C==="category")F?ne=ne.filter(function(Ve){return Ve!==""&&!ts(Ve)}):ne=U6(ae,ne,N).reduce(function(Ve,yt){return Ve.indexOf(yt)>=0||yt===""||ts(yt)?Ve:[].concat(ev(Ve),[yt])},[]);else if(C==="number"){var de=u4e(re,a.filter(function(Ve){var yt,Et,Rt=c in Ve.props?Ve.props[c]:(yt=Ve.type.defaultProps)===null||yt===void 0?void 0:yt[c],Vt="hide"in Ve.props?Ve.props.hide:(Et=Ve.type.defaultProps)===null||Et===void 0?void 0:Et.hide;return Rt===Q&&(te||!Vt)}),D,o,g);de&&(ne=de)}w&&(C==="number"||B!=="auto")&&(Ce=H0(re,D,"category"))}else w?ne=D2(0,Z):i&&i[Q]&&i[Q].hasStack&&C==="number"?ne=b==="expand"?[0,1]:uY(i[Q].stackGroups,f,p):ne=aY(re,a.filter(function(Ve){var yt=c in Ve.props?Ve.props[c]:Ve.type.defaultProps[c],Et="hide"in Ve.props?Ve.props.hide:Ve.type.defaultProps.hide;return yt===Q&&(te||!Et)}),C,g,!0);if(C==="number")ne=lO(y,ne,Q,o,U),ae&&(ne=w4(ae,ne,L));else if(C==="category"&&ae){var Ke=ae,He=ne.every(function(Ve){return Ke.indexOf(Ve)>=0});He&&(ne=Ke)}}return Ft(Ft({},T),{},Zr({},Q,Ft(Ft({},O),{},{axisType:o,domain:ne,categoricalDomain:Ce,duplicateDomain:oe,originalDomain:(M=O.domain)!==null&&M!==void 0?M:Pe,isCategorical:w,layout:g})))},{})},cze=function(r,s){var n=s.graphicalItems,a=s.Axis,o=s.axisType,c=s.axisIdKey,i=s.stackGroups,f=s.dataStartIndex,p=s.dataEndIndex,g=r.layout,y=r.children,b=FP(r.data,{graphicalItems:n,dataStartIndex:f,dataEndIndex:p}),w=b.length,T=iY(g,o),N=-1;return n.reduce(function(M,O){var C=O.type.defaultProps!==void 0?Ft(Ft({},O.type.defaultProps),O.props):O.props,D=C[c],L=LX("number");if(!M[D]){N++;var F;return T?F=D2(0,w):i&&i[D]&&i[D].hasStack?(F=uY(i[D].stackGroups,f,p),F=lO(y,F,D,o)):(F=w4(L,aY(b,n.filter(function(B){var U,te,Q=c in B.props?B.props[c]:(U=B.type.defaultProps)===null||U===void 0?void 0:U[c],re="hide"in B.props?B.props.hide:(te=B.type.defaultProps)===null||te===void 0?void 0:te.hide;return Q===D&&!re}),"number",g),a.defaultProps.allowDataOverflow),F=lO(y,F,D,o)),Ft(Ft({},M),{},Zr({},D,Ft(Ft({axisType:o},a.defaultProps),{},{hide:!0,orientation:vl(nze,"".concat(o,".").concat(N%2),null),domain:F,originalDomain:L,isCategorical:T,layout:g})))}return M},{})},dze=function(r,s){var n=s.axisType,a=n===void 0?"xAxis":n,o=s.AxisComp,c=s.graphicalItems,i=s.stackGroups,f=s.dataStartIndex,p=s.dataEndIndex,g=r.children,y="".concat(a,"Id"),b=jl(g,o),w={};return b&&b.length?w=lze(r,{axes:b,graphicalItems:c,axisType:a,axisIdKey:y,stackGroups:i,dataStartIndex:f,dataEndIndex:p}):c&&c.length&&(w=cze(r,{Axis:o,graphicalItems:c,axisType:a,axisIdKey:y,stackGroups:i,dataStartIndex:f,dataEndIndex:p})),w},uze=function(r){var s=Vh(r),n=Au(s,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:DD(n,function(a){return a.coordinate}),tooltipAxis:s,tooltipAxisBandSize:b2(s,n)}},k8=function(r){var s=r.children,n=r.defaultShowTooltip,a=dl(s,Vy),o=0,c=0;return r.data&&r.data.length!==0&&(c=r.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(o=a.props.startIndex),a.props.endIndex>=0&&(c=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:o,dataEndIndex:c,activeTooltipIndex:-1,isTooltipActive:!!n}},hze=function(r){return!r||!r.length?!1:r.some(function(s){var n=Eu(s&&s.type);return n&&n.indexOf("Bar")>=0})},A8=function(r){return r==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:r==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:r==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},mze=function(r,s){var n=r.props,a=r.graphicalItems,o=r.xAxisMap,c=o===void 0?{}:o,i=r.yAxisMap,f=i===void 0?{}:i,p=n.width,g=n.height,y=n.children,b=n.margin||{},w=dl(y,Vy),T=dl(y,Ea),N=Object.keys(f).reduce(function(F,B){var U=f[B],te=U.orientation;return!U.mirror&&!U.hide?Ft(Ft({},F),{},Zr({},te,F[te]+U.width)):F},{left:b.left||0,right:b.right||0}),M=Object.keys(c).reduce(function(F,B){var U=c[B],te=U.orientation;return!U.mirror&&!U.hide?Ft(Ft({},F),{},Zr({},te,vl(F,"".concat(te))+U.height)):F},{top:b.top||0,bottom:b.bottom||0}),O=Ft(Ft({},M),N),C=O.bottom;w&&(O.bottom+=w.props.height||Vy.defaultProps.height),T&&s&&(O=c4e(O,a,n,s));var D=p-O.left-O.right,L=g-O.top-O.bottom;return Ft(Ft({brushBottom:C},O),{},{width:Math.max(D,0),height:Math.max(L,0)})},fze=function(r,s){if(s==="xAxis")return r[s].width;if(s==="yAxis")return r[s].height},sw=function(r){var s=r.chartName,n=r.GraphicalChild,a=r.defaultTooltipEventType,o=a===void 0?"axis":a,c=r.validateTooltipEventTypes,i=c===void 0?["axis"]:c,f=r.axisComponents,p=r.legendContent,g=r.formatAxisMap,y=r.defaultProps,b=function(O,C){var D=C.graphicalItems,L=C.stackGroups,F=C.offset,B=C.updateId,U=C.dataStartIndex,te=C.dataEndIndex,Q=O.barSize,re=O.layout,Z=O.barGap,ne=O.barCategoryGap,oe=O.maxBarSize,Ce=A8(re),Pe=Ce.numericAxisName,Se=Ce.cateAxisName,ae=hze(D),be=[];return D.forEach(function(de,Ke){var He=FP(O.data,{graphicalItems:[de],dataStartIndex:U,dataEndIndex:te}),Ve=de.type.defaultProps!==void 0?Ft(Ft({},de.type.defaultProps),de.props):de.props,yt=Ve.dataKey,Et=Ve.maxBarSize,Rt=Ve["".concat(Pe,"Id")],Vt=Ve["".concat(Se,"Id")],Ct={},ur=f.reduce(function(Je,lt){var qt=C["".concat(lt.axisType,"Map")],It=Ve["".concat(lt.axisType,"Id")];qt&&qt[It]||lt.axisType==="zAxis"||Op();var Bt=qt[It];return Ft(Ft({},Je),{},Zr(Zr({},lt.axisType,Bt),"".concat(lt.axisType,"Ticks"),Au(Bt)))},Ct),At=ur[Se],Ht=ur["".concat(Se,"Ticks")],fr=L&&L[Rt]&&L[Rt].hasStack&&j4e(de,L[Rt].stackGroups),vt=Eu(de.type).indexOf("Bar")>=0,Br=b2(At,Ht),vr=[],Xr=ae&&o4e({barSize:Q,stackGroups:L,totalSize:fze(ur,Se)});if(vt){var Dr,As,xn=ts(Et)?oe:Et,Qs=(Dr=(As=b2(At,Ht,!0))!==null&&As!==void 0?As:xn)!==null&&Dr!==void 0?Dr:0;vr=l4e({barGap:Z,barCategoryGap:ne,bandSize:Qs!==Br?Qs:Br,sizeList:Xr[Vt],maxBarSize:xn}),Qs!==Br&&(vr=vr.map(function(Je){return Ft(Ft({},Je),{},{position:Ft(Ft({},Je.position),{},{offset:Je.position.offset-Qs/2})})}))}var De=de&&de.type&&de.type.getComposedData;De&&be.push({props:Ft(Ft({},De(Ft(Ft({},ur),{},{displayedData:He,props:O,dataKey:yt,item:de,bandSize:Br,barPosition:vr,offset:F,stackedData:fr,layout:re,dataStartIndex:U,dataEndIndex:te}))),{},Zr(Zr(Zr({key:de.key||"item-".concat(Ke)},Pe,ur[Pe]),Se,ur[Se]),"animationId",B)),childIndex:l0e(de,O.children),item:de})}),be},w=function(O,C){var D=O.props,L=O.dataStartIndex,F=O.dataEndIndex,B=O.updateId;if(!F$({props:D}))return null;var U=D.children,te=D.layout,Q=D.stackOffset,re=D.data,Z=D.reverseStackOrder,ne=A8(te),oe=ne.numericAxisName,Ce=ne.cateAxisName,Pe=jl(U,n),Se=y4e(re,Pe,"".concat(oe,"Id"),"".concat(Ce,"Id"),Q,Z),ae=f.reduce(function(Ve,yt){var Et="".concat(yt.axisType,"Map");return Ft(Ft({},Ve),{},Zr({},Et,dze(D,Ft(Ft({},yt),{},{graphicalItems:Pe,stackGroups:yt.axisType===oe&&Se,dataStartIndex:L,dataEndIndex:F}))))},{}),be=mze(Ft(Ft({},ae),{},{props:D,graphicalItems:Pe}),C==null?void 0:C.legendBBox);Object.keys(ae).forEach(function(Ve){ae[Ve]=g(D,ae[Ve],be,Ve.replace("Map",""),s)});var de=ae["".concat(Ce,"Map")],Ke=uze(de),He=b(D,Ft(Ft({},ae),{},{dataStartIndex:L,dataEndIndex:F,updateId:B,graphicalItems:Pe,stackGroups:Se,offset:be}));return Ft(Ft({formattedGraphicalItems:He,graphicalItems:Pe,offset:be,stackGroups:Se},Ke),ae)},T=function(M){function O(C){var D,L,F;return K$e(this,O),F=Y$e(this,O,[C]),Zr(F,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Zr(F,"accessibilityManager",new O$e),Zr(F,"handleLegendBBoxUpdate",function(B){if(B){var U=F.state,te=U.dataStartIndex,Q=U.dataEndIndex,re=U.updateId;F.setState(Ft({legendBBox:B},w({props:F.props,dataStartIndex:te,dataEndIndex:Q,updateId:re},Ft(Ft({},F.state),{},{legendBBox:B}))))}}),Zr(F,"handleReceiveSyncEvent",function(B,U,te){if(F.props.syncId===B){if(te===F.eventEmitterSymbol&&typeof F.props.syncMethod!="function")return;F.applySyncEvent(U)}}),Zr(F,"handleBrushChange",function(B){var U=B.startIndex,te=B.endIndex;if(U!==F.state.dataStartIndex||te!==F.state.dataEndIndex){var Q=F.state.updateId;F.setState(function(){return Ft({dataStartIndex:U,dataEndIndex:te},w({props:F.props,dataStartIndex:U,dataEndIndex:te,updateId:Q},F.state))}),F.triggerSyncEvent({dataStartIndex:U,dataEndIndex:te})}}),Zr(F,"handleMouseEnter",function(B){var U=F.getMouseInfo(B);if(U){var te=Ft(Ft({},U),{},{isTooltipActive:!0});F.setState(te),F.triggerSyncEvent(te);var Q=F.props.onMouseEnter;Wr(Q)&&Q(te,B)}}),Zr(F,"triggeredAfterMouseMove",function(B){var U=F.getMouseInfo(B),te=U?Ft(Ft({},U),{},{isTooltipActive:!0}):{isTooltipActive:!1};F.setState(te),F.triggerSyncEvent(te);var Q=F.props.onMouseMove;Wr(Q)&&Q(te,B)}),Zr(F,"handleItemMouseEnter",function(B){F.setState(function(){return{isTooltipActive:!0,activeItem:B,activePayload:B.tooltipPayload,activeCoordinate:B.tooltipPosition||{x:B.cx,y:B.cy}}})}),Zr(F,"handleItemMouseLeave",function(){F.setState(function(){return{isTooltipActive:!1}})}),Zr(F,"handleMouseMove",function(B){B.persist(),F.throttleTriggeredAfterMouseMove(B)}),Zr(F,"handleMouseLeave",function(B){F.throttleTriggeredAfterMouseMove.cancel();var U={isTooltipActive:!1};F.setState(U),F.triggerSyncEvent(U);var te=F.props.onMouseLeave;Wr(te)&&te(U,B)}),Zr(F,"handleOuterEvent",function(B){var U=o0e(B),te=vl(F.props,"".concat(U));if(U&&Wr(te)){var Q,re;/.*touch.*/i.test(U)?re=F.getMouseInfo(B.changedTouches[0]):re=F.getMouseInfo(B),te((Q=re)!==null&&Q!==void 0?Q:{},B)}}),Zr(F,"handleClick",function(B){var U=F.getMouseInfo(B);if(U){var te=Ft(Ft({},U),{},{isTooltipActive:!0});F.setState(te),F.triggerSyncEvent(te);var Q=F.props.onClick;Wr(Q)&&Q(te,B)}}),Zr(F,"handleMouseDown",function(B){var U=F.props.onMouseDown;if(Wr(U)){var te=F.getMouseInfo(B);U(te,B)}}),Zr(F,"handleMouseUp",function(B){var U=F.props.onMouseUp;if(Wr(U)){var te=F.getMouseInfo(B);U(te,B)}}),Zr(F,"handleTouchMove",function(B){B.changedTouches!=null&&B.changedTouches.length>0&&F.throttleTriggeredAfterMouseMove(B.changedTouches[0])}),Zr(F,"handleTouchStart",function(B){B.changedTouches!=null&&B.changedTouches.length>0&&F.handleMouseDown(B.changedTouches[0])}),Zr(F,"handleTouchEnd",function(B){B.changedTouches!=null&&B.changedTouches.length>0&&F.handleMouseUp(B.changedTouches[0])}),Zr(F,"triggerSyncEvent",function(B){F.props.syncId!==void 0&&kT.emit(AT,F.props.syncId,B,F.eventEmitterSymbol)}),Zr(F,"applySyncEvent",function(B){var U=F.props,te=U.layout,Q=U.syncMethod,re=F.state.updateId,Z=B.dataStartIndex,ne=B.dataEndIndex;if(B.dataStartIndex!==void 0||B.dataEndIndex!==void 0)F.setState(Ft({dataStartIndex:Z,dataEndIndex:ne},w({props:F.props,dataStartIndex:Z,dataEndIndex:ne,updateId:re},F.state)));else if(B.activeTooltipIndex!==void 0){var oe=B.chartX,Ce=B.chartY,Pe=B.activeTooltipIndex,Se=F.state,ae=Se.offset,be=Se.tooltipTicks;if(!ae)return;if(typeof Q=="function")Pe=Q(be,B);else if(Q==="value"){Pe=-1;for(var de=0;de<be.length;de++)if(be[de].value===B.activeLabel){Pe=de;break}}var Ke=Ft(Ft({},ae),{},{x:ae.left,y:ae.top}),He=Math.min(oe,Ke.x+Ke.width),Ve=Math.min(Ce,Ke.y+Ke.height),yt=be[Pe]&&be[Pe].value,Et=uO(F.state,F.props.data,Pe),Rt=be[Pe]?{x:te==="horizontal"?be[Pe].coordinate:He,y:te==="horizontal"?Ve:be[Pe].coordinate}:RX;F.setState(Ft(Ft({},B),{},{activeLabel:yt,activeCoordinate:Rt,activePayload:Et,activeTooltipIndex:Pe}))}else F.setState(B)}),Zr(F,"renderCursor",function(B){var U,te=F.state,Q=te.isTooltipActive,re=te.activeCoordinate,Z=te.activePayload,ne=te.offset,oe=te.activeTooltipIndex,Ce=te.tooltipAxisBandSize,Pe=F.getTooltipEventType(),Se=(U=B.props.active)!==null&&U!==void 0?U:Q,ae=F.props.layout,be=B.key||"_recharts-cursor";return je.createElement(z$e,{key:be,activeCoordinate:re,activePayload:Z,activeTooltipIndex:oe,chartName:s,element:B,isActive:Se,layout:ae,offset:ne,tooltipAxisBandSize:Ce,tooltipEventType:Pe})}),Zr(F,"renderPolarAxis",function(B,U,te){var Q=vl(B,"type.axisType"),re=vl(F.state,"".concat(Q,"Map")),Z=B.type.defaultProps,ne=Z!==void 0?Ft(Ft({},Z),B.props):B.props,oe=re&&re[ne["".concat(Q,"Id")]];return A.cloneElement(B,Ft(Ft({},oe),{},{className:rs(Q,oe.className),key:B.key||"".concat(U,"-").concat(te),ticks:Au(oe,!0)}))}),Zr(F,"renderPolarGrid",function(B){var U=B.props,te=U.radialLines,Q=U.polarAngles,re=U.polarRadius,Z=F.state,ne=Z.radiusAxisMap,oe=Z.angleAxisMap,Ce=Vh(ne),Pe=Vh(oe),Se=Pe.cx,ae=Pe.cy,be=Pe.innerRadius,de=Pe.outerRadius;return A.cloneElement(B,{polarAngles:Array.isArray(Q)?Q:Au(Pe,!0).map(function(Ke){return Ke.coordinate}),polarRadius:Array.isArray(re)?re:Au(Ce,!0).map(function(Ke){return Ke.coordinate}),cx:Se,cy:ae,innerRadius:be,outerRadius:de,key:B.key||"polar-grid",radialLines:te})}),Zr(F,"renderLegend",function(){var B=F.state.formattedGraphicalItems,U=F.props,te=U.children,Q=U.width,re=U.height,Z=F.props.margin||{},ne=Q-(Z.left||0)-(Z.right||0),oe=sY({children:te,formattedGraphicalItems:B,legendWidth:ne,legendContent:p});if(!oe)return null;var Ce=oe.item,Pe=S8(oe,B$e);return A.cloneElement(Ce,Ft(Ft({},Pe),{},{chartWidth:Q,chartHeight:re,margin:Z,onBBoxUpdate:F.handleLegendBBoxUpdate}))}),Zr(F,"renderTooltip",function(){var B,U=F.props,te=U.children,Q=U.accessibilityLayer,re=dl(te,_n);if(!re)return null;var Z=F.state,ne=Z.isTooltipActive,oe=Z.activeCoordinate,Ce=Z.activePayload,Pe=Z.activeLabel,Se=Z.offset,ae=(B=re.props.active)!==null&&B!==void 0?B:ne;return A.cloneElement(re,{viewBox:Ft(Ft({},Se),{},{x:Se.left,y:Se.top}),active:ae,label:Pe,payload:ae?Ce:[],coordinate:oe,accessibilityLayer:Q})}),Zr(F,"renderBrush",function(B){var U=F.props,te=U.margin,Q=U.data,re=F.state,Z=re.offset,ne=re.dataStartIndex,oe=re.dataEndIndex,Ce=re.updateId;return A.cloneElement(B,{key:B.key||"_recharts-brush",onChange:yN(F.handleBrushChange,B.props.onChange),data:Q,x:cr(B.props.x)?B.props.x:Z.left,y:cr(B.props.y)?B.props.y:Z.top+Z.height+Z.brushBottom-(te.bottom||0),width:cr(B.props.width)?B.props.width:Z.width,startIndex:ne,endIndex:oe,updateId:"brush-".concat(Ce)})}),Zr(F,"renderReferenceElement",function(B,U,te){if(!B)return null;var Q=F,re=Q.clipPathId,Z=F.state,ne=Z.xAxisMap,oe=Z.yAxisMap,Ce=Z.offset,Pe=B.type.defaultProps||{},Se=B.props,ae=Se.xAxisId,be=ae===void 0?Pe.xAxisId:ae,de=Se.yAxisId,Ke=de===void 0?Pe.yAxisId:de;return A.cloneElement(B,{key:B.key||"".concat(U,"-").concat(te),xAxis:ne[be],yAxis:oe[Ke],viewBox:{x:Ce.left,y:Ce.top,width:Ce.width,height:Ce.height},clipPathId:re})}),Zr(F,"renderActivePoints",function(B){var U=B.item,te=B.activePoint,Q=B.basePoint,re=B.childIndex,Z=B.isRange,ne=[],oe=U.props.key,Ce=U.item.type.defaultProps!==void 0?Ft(Ft({},U.item.type.defaultProps),U.item.props):U.item.props,Pe=Ce.activeDot,Se=Ce.dataKey,ae=Ft(Ft({index:re,dataKey:Se,cx:te.x,cy:te.y,r:4,fill:oR(U.item),strokeWidth:2,stroke:"#fff",payload:te.payload,value:te.value},Or(Pe,!1)),KS(Pe));return ne.push(O.renderActiveDot(Pe,ae,"".concat(oe,"-activePoint-").concat(re))),Q?ne.push(O.renderActiveDot(Pe,Ft(Ft({},ae),{},{cx:Q.x,cy:Q.y}),"".concat(oe,"-basePoint-").concat(re))):Z&&ne.push(null),ne}),Zr(F,"renderGraphicChild",function(B,U,te){var Q=F.filterFormatItem(B,U,te);if(!Q)return null;var re=F.getTooltipEventType(),Z=F.state,ne=Z.isTooltipActive,oe=Z.tooltipAxis,Ce=Z.activeTooltipIndex,Pe=Z.activeLabel,Se=F.props.children,ae=dl(Se,_n),be=Q.props,de=be.points,Ke=be.isRange,He=be.baseLine,Ve=Q.item.type.defaultProps!==void 0?Ft(Ft({},Q.item.type.defaultProps),Q.item.props):Q.item.props,yt=Ve.activeDot,Et=Ve.hide,Rt=Ve.activeBar,Vt=Ve.activeShape,Ct=!!(!Et&&ne&&ae&&(yt||Rt||Vt)),ur={};re!=="axis"&&ae&&ae.props.trigger==="click"?ur={onClick:yN(F.handleItemMouseEnter,B.props.onClick)}:re!=="axis"&&(ur={onMouseLeave:yN(F.handleItemMouseLeave,B.props.onMouseLeave),onMouseEnter:yN(F.handleItemMouseEnter,B.props.onMouseEnter)});var At=A.cloneElement(B,Ft(Ft({},Q.props),ur));function Ht(lt){return typeof oe.dataKey=="function"?oe.dataKey(lt.payload):null}if(Ct)if(Ce>=0){var fr,vt;if(oe.dataKey&&!oe.allowDuplicatedCategory){var Br=typeof oe.dataKey=="function"?Ht:"payload.".concat(oe.dataKey.toString());fr=GS(de,Br,Pe),vt=Ke&&He&&GS(He,Br,Pe)}else fr=de==null?void 0:de[Ce],vt=Ke&&He&&He[Ce];if(Vt||Rt){var vr=B.props.activeIndex!==void 0?B.props.activeIndex:Ce;return[A.cloneElement(B,Ft(Ft(Ft({},Q.props),ur),{},{activeIndex:vr})),null,null]}if(!ts(fr))return[At].concat(ev(F.renderActivePoints({item:Q,activePoint:fr,basePoint:vt,childIndex:Ce,isRange:Ke})))}else{var Xr,Dr=(Xr=F.getItemByXY(F.state.activeCoordinate))!==null&&Xr!==void 0?Xr:{graphicalItem:At},As=Dr.graphicalItem,xn=As.item,Qs=xn===void 0?B:xn,De=As.childIndex,Je=Ft(Ft(Ft({},Q.props),ur),{},{activeIndex:De});return[A.cloneElement(Qs,Je),null,null]}return Ke?[At,null,null]:[At,null]}),Zr(F,"renderCustomized",function(B,U,te){return A.cloneElement(B,Ft(Ft({key:"recharts-customized-".concat(te)},F.props),F.state))}),Zr(F,"renderMap",{CartesianGrid:{handler:wN,once:!0},ReferenceArea:{handler:F.renderReferenceElement},ReferenceLine:{handler:wN},ReferenceDot:{handler:F.renderReferenceElement},XAxis:{handler:wN},YAxis:{handler:wN},Brush:{handler:F.renderBrush,once:!0},Bar:{handler:F.renderGraphicChild},Line:{handler:F.renderGraphicChild},Area:{handler:F.renderGraphicChild},Radar:{handler:F.renderGraphicChild},RadialBar:{handler:F.renderGraphicChild},Scatter:{handler:F.renderGraphicChild},Pie:{handler:F.renderGraphicChild},Funnel:{handler:F.renderGraphicChild},Tooltip:{handler:F.renderCursor,once:!0},PolarGrid:{handler:F.renderPolarGrid,once:!0},PolarAngleAxis:{handler:F.renderPolarAxis},PolarRadiusAxis:{handler:F.renderPolarAxis},Customized:{handler:F.renderCustomized}}),F.clipPathId="".concat((D=C.id)!==null&&D!==void 0?D:qp("recharts"),"-clip"),F.throttleTriggeredAfterMouseMove=rZ(F.triggeredAfterMouseMove,(L=C.throttleDelay)!==null&&L!==void 0?L:1e3/60),F.state={},F}return J$e(O,M),Z$e(O,[{key:"componentDidMount",value:function(){var D,L;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(D=this.props.margin.left)!==null&&D!==void 0?D:0,top:(L=this.props.margin.top)!==null&&L!==void 0?L:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var D=this.props,L=D.children,F=D.data,B=D.height,U=D.layout,te=dl(L,_n);if(te){var Q=te.props.defaultIndex;if(!(typeof Q!="number"||Q<0||Q>this.state.tooltipTicks.length-1)){var re=this.state.tooltipTicks[Q]&&this.state.tooltipTicks[Q].value,Z=uO(this.state,F,Q,re),ne=this.state.tooltipTicks[Q].coordinate,oe=(this.state.offset.top+B)/2,Ce=U==="horizontal",Pe=Ce?{x:ne,y:oe}:{y:ne,x:oe},Se=this.state.formattedGraphicalItems.find(function(be){var de=be.item;return de.type.name==="Scatter"});Se&&(Pe=Ft(Ft({},Pe),Se.props.points[Q].tooltipPosition),Z=Se.props.points[Q].tooltipPayload);var ae={activeTooltipIndex:Q,isTooltipActive:!0,activeLabel:re,activePayload:Z,activeCoordinate:Pe};this.setState(ae),this.renderCursor(te),this.accessibilityManager.setIndex(Q)}}}},{key:"getSnapshotBeforeUpdate",value:function(D,L){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==L.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==D.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==D.margin){var F,B;this.accessibilityManager.setDetails({offset:{left:(F=this.props.margin.left)!==null&&F!==void 0?F:0,top:(B=this.props.margin.top)!==null&&B!==void 0?B:0}})}return null}},{key:"componentDidUpdate",value:function(D){FM([dl(D.children,_n)],[dl(this.props.children,_n)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var D=dl(this.props.children,_n);if(D&&typeof D.props.shared=="boolean"){var L=D.props.shared?"axis":"item";return i.indexOf(L)>=0?L:o}return o}},{key:"getMouseInfo",value:function(D){if(!this.container)return null;var L=this.container,F=L.getBoundingClientRect(),B=Ike(F),U={chartX:Math.round(D.pageX-B.left),chartY:Math.round(D.pageY-B.top)},te=F.width/L.offsetWidth||1,Q=this.inRange(U.chartX,U.chartY,te);if(!Q)return null;var re=this.state,Z=re.xAxisMap,ne=re.yAxisMap,oe=this.getTooltipEventType();if(oe!=="axis"&&Z&&ne){var Ce=Vh(Z).scale,Pe=Vh(ne).scale,Se=Ce&&Ce.invert?Ce.invert(U.chartX):null,ae=Pe&&Pe.invert?Pe.invert(U.chartY):null;return Ft(Ft({},U),{},{xValue:Se,yValue:ae})}var be=P8(this.state,this.props.data,this.props.layout,Q);return be?Ft(Ft({},U),be):null}},{key:"inRange",value:function(D,L){var F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,B=this.props.layout,U=D/F,te=L/F;if(B==="horizontal"||B==="vertical"){var Q=this.state.offset,re=U>=Q.left&&U<=Q.left+Q.width&&te>=Q.top&&te<=Q.top+Q.height;return re?{x:U,y:te}:null}var Z=this.state,ne=Z.angleAxisMap,oe=Z.radiusAxisMap;if(ne&&oe){var Ce=Vh(ne);return K6({x:U,y:te},Ce)}return null}},{key:"parseEventsOfWrapper",value:function(){var D=this.props.children,L=this.getTooltipEventType(),F=dl(D,_n),B={};F&&L==="axis"&&(F.props.trigger==="click"?B={onClick:this.handleClick}:B={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var U=KS(this.props,this.handleOuterEvent);return Ft(Ft({},U),B)}},{key:"addListener",value:function(){kT.on(AT,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){kT.removeListener(AT,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(D,L,F){for(var B=this.state.formattedGraphicalItems,U=0,te=B.length;U<te;U++){var Q=B[U];if(Q.item===D||Q.props.key===D.key||L===Eu(Q.item.type)&&F===Q.childIndex)return Q}return null}},{key:"renderClipPath",value:function(){var D=this.clipPathId,L=this.state.offset,F=L.left,B=L.top,U=L.height,te=L.width;return je.createElement("defs",null,je.createElement("clipPath",{id:D},je.createElement("rect",{x:F,y:B,height:U,width:te})))}},{key:"getXScales",value:function(){var D=this.state.xAxisMap;return D?Object.entries(D).reduce(function(L,F){var B=N8(F,2),U=B[0],te=B[1];return Ft(Ft({},L),{},Zr({},U,te.scale))},{}):null}},{key:"getYScales",value:function(){var D=this.state.yAxisMap;return D?Object.entries(D).reduce(function(L,F){var B=N8(F,2),U=B[0],te=B[1];return Ft(Ft({},L),{},Zr({},U,te.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(D){var L;return(L=this.state.xAxisMap)===null||L===void 0||(L=L[D])===null||L===void 0?void 0:L.scale}},{key:"getYScaleByAxisId",value:function(D){var L;return(L=this.state.yAxisMap)===null||L===void 0||(L=L[D])===null||L===void 0?void 0:L.scale}},{key:"getItemByXY",value:function(D){var L=this.state,F=L.formattedGraphicalItems,B=L.activeItem;if(F&&F.length)for(var U=0,te=F.length;U<te;U++){var Q=F[U],re=Q.props,Z=Q.item,ne=Z.type.defaultProps!==void 0?Ft(Ft({},Z.type.defaultProps),Z.props):Z.props,oe=Eu(Z.type);if(oe==="Bar"){var Ce=(re.data||[]).find(function(be){return nDe(D,be)});if(Ce)return{graphicalItem:Q,payload:Ce}}else if(oe==="RadialBar"){var Pe=(re.data||[]).find(function(be){return K6(D,be)});if(Pe)return{graphicalItem:Q,payload:Pe}}else if(TP(Q,B)||EP(Q,B)||l_(Q,B)){var Se=r3e({graphicalItem:Q,activeTooltipItem:B,itemData:ne.data}),ae=ne.activeIndex===void 0?Se:ne.activeIndex;return{graphicalItem:Ft(Ft({},Q),{},{childIndex:ae}),payload:l_(Q,B)?ne.data[Se]:Q.props.data[Se]}}}return null}},{key:"render",value:function(){var D=this;if(!F$(this))return null;var L=this.props,F=L.children,B=L.className,U=L.width,te=L.height,Q=L.style,re=L.compact,Z=L.title,ne=L.desc,oe=S8(L,q$e),Ce=Or(oe,!1);if(re)return je.createElement(n8,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},je.createElement(zM,Ag({},Ce,{width:U,height:te,title:Z,desc:ne}),this.renderClipPath(),z$(F,this.renderMap)));if(this.props.accessibilityLayer){var Pe,Se;Ce.tabIndex=(Pe=this.props.tabIndex)!==null&&Pe!==void 0?Pe:0,Ce.role=(Se=this.props.role)!==null&&Se!==void 0?Se:"application",Ce.onKeyDown=function(be){D.accessibilityManager.keyboardEvent(be)},Ce.onFocus=function(){D.accessibilityManager.focus()}}var ae=this.parseEventsOfWrapper();return je.createElement(n8,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},je.createElement("div",Ag({className:rs("recharts-wrapper",B),style:Ft({position:"relative",cursor:"default",width:U,height:te},Q)},ae,{ref:function(de){D.container=de}}),je.createElement(zM,Ag({},Ce,{width:U,height:te,title:Z,desc:ne,style:aze}),this.renderClipPath(),z$(F,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(A.Component);Zr(T,"displayName",s),Zr(T,"defaultProps",Ft({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},y)),Zr(T,"getDerivedStateFromProps",function(M,O){var C=M.dataKey,D=M.data,L=M.children,F=M.width,B=M.height,U=M.layout,te=M.stackOffset,Q=M.margin,re=O.dataStartIndex,Z=O.dataEndIndex;if(O.updateId===void 0){var ne=k8(M);return Ft(Ft(Ft({},ne),{},{updateId:0},w(Ft(Ft({props:M},ne),{},{updateId:0}),O)),{},{prevDataKey:C,prevData:D,prevWidth:F,prevHeight:B,prevLayout:U,prevStackOffset:te,prevMargin:Q,prevChildren:L})}if(C!==O.prevDataKey||D!==O.prevData||F!==O.prevWidth||B!==O.prevHeight||U!==O.prevLayout||te!==O.prevStackOffset||!Vg(Q,O.prevMargin)){var oe=k8(M),Ce={chartX:O.chartX,chartY:O.chartY,isTooltipActive:O.isTooltipActive},Pe=Ft(Ft({},P8(O,D,U)),{},{updateId:O.updateId+1}),Se=Ft(Ft(Ft({},oe),Ce),Pe);return Ft(Ft(Ft({},Se),w(Ft({props:M},Se),O)),{},{prevDataKey:C,prevData:D,prevWidth:F,prevHeight:B,prevLayout:U,prevStackOffset:te,prevMargin:Q,prevChildren:L})}if(!FM(L,O.prevChildren)){var ae,be,de,Ke,He=dl(L,Vy),Ve=He&&(ae=(be=He.props)===null||be===void 0?void 0:be.startIndex)!==null&&ae!==void 0?ae:re,yt=He&&(de=(Ke=He.props)===null||Ke===void 0?void 0:Ke.endIndex)!==null&&de!==void 0?de:Z,Et=Ve!==re||yt!==Z,Rt=!ts(D),Vt=Rt&&!Et?O.updateId:O.updateId+1;return Ft(Ft({updateId:Vt},w(Ft(Ft({props:M},O),{},{updateId:Vt,dataStartIndex:Ve,dataEndIndex:yt}),O)),{},{prevChildren:L,dataStartIndex:Ve,dataEndIndex:yt})}return null}),Zr(T,"renderActiveDot",function(M,O,C){var D;return A.isValidElement(M)?D=A.cloneElement(M,O):Wr(M)?D=M(O):D=je.createElement(Iv,O),je.createElement(_s,{className:"recharts-active-dot",key:C},D)});var N=A.forwardRef(function(O,C){return je.createElement(T,Ag({},O,{ref:C}))});return N.displayName=T.displayName,N},Km=sw({chartName:"LineChart",GraphicalChild:ui,axisComponents:[{axisType:"xAxis",AxisComp:Ma},{axisType:"yAxis",AxisComp:fa}],formatAxisMap:cR}),tv=sw({chartName:"BarChart",GraphicalChild:uo,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Ma},{axisType:"yAxis",AxisComp:fa}],formatAxisMap:cR}),T8=sw({chartName:"PieChart",GraphicalChild:Od,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:Rv},{axisType:"radiusAxis",AxisComp:Dv}],formatAxisMap:pY,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),pze=sw({chartName:"RadarChart",GraphicalChild:rw,axisComponents:[{axisType:"angleAxis",AxisComp:Rv},{axisType:"radiusAxis",AxisComp:Dv}],formatAxisMap:pY,defaultProps:{layout:"centric",startAngle:90,endAngle:-270,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),yR=sw({chartName:"AreaChart",GraphicalChild:Jl,axisComponents:[{axisType:"xAxis",AxisComp:Ma},{axisType:"yAxis",AxisComp:fa}],formatAxisMap:cR});function xze(){var Q,re;const{accountNo:t}=xC(),r=yr(),[s,n]=A.useState(!1),[a,o]=A.useState({category:"billing",priority:"medium",status:"open"}),[c,i]=A.useState(!1),[f,p]=A.useState(null),[g,y]=A.useState(""),{data:b,isLoading:w}=it({queryKey:["account-overview",t],queryFn:()=>jn.getAccountOverview(t),enabled:!!t}),{data:T}=it({queryKey:["account-billing",t],queryFn:()=>jn.getBillingHistory(t,12),enabled:!!t}),{data:N}=it({queryKey:["account-analytics",t],queryFn:()=>jn.getConsumptionAnalytics(t,12),enabled:!!t}),{data:M}=it({queryKey:["account-complaints",t],queryFn:()=>jn.getComplaints({account_no:t}),enabled:!!t}),{data:O}=it({queryKey:["account-notes",t],queryFn:()=>jn.getNotes({account_no:t}),enabled:!!t}),C=gt({mutationFn:Z=>jn.createComplaint(Z),onSuccess:()=>{r.invalidateQueries({queryKey:["account-complaints",t]}),r.invalidateQueries({queryKey:["account-overview",t]}),n(!1),o({category:"billing",priority:"medium",status:"open"}),Me.success("Complaint created successfully")},onError:Z=>{Me.error(Z.message||"Failed to create complaint")}}),D=gt({mutationFn:({id:Z,data:ne})=>jn.updateComplaint(Z,ne),onSuccess:()=>{r.invalidateQueries({queryKey:["account-complaints",t]}),r.invalidateQueries({queryKey:["account-overview",t]}),Me.success("Complaint updated successfully")},onError:Z=>{Me.error(Z.message||"Failed to update complaint")}}),L=gt({mutationFn:Z=>jn.createNote(Z),onSuccess:()=>{r.invalidateQueries({queryKey:["account-notes",t]}),i(!1),y(""),Me.success("Note created successfully")},onError:Z=>{Me.error(Z.message||"Failed to create note")}}),F=gt({mutationFn:({id:Z,data:ne})=>jn.updateNote(Z,ne),onSuccess:()=>{r.invalidateQueries({queryKey:["account-notes",t]}),i(!1),p(null),y(""),Me.success("Note updated successfully")},onError:Z=>{Me.error(Z.message||"Failed to update note")}}),B=gt({mutationFn:Z=>jn.deleteNote(Z),onSuccess:()=>{r.invalidateQueries({queryKey:["account-notes",t]}),Me.success("Note deleted successfully")},onError:Z=>{Me.error(Z.message||"Failed to delete note")}});if(w)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("p",{className:"text-lg",children:"Loading account details..."})});if(!b)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("p",{className:"text-lg text-red-600",children:"Account not found"})});const U=((Q=b.balance)==null?void 0:Q.balance)||0,te=(N==null?void 0:N.trend)==="increasing"?e.jsx(zs,{className:"h-4 w-4 text-orange-600"}):(N==null?void 0:N.trend)==="decreasing"?e.jsx(ci,{className:"h-4 w-4 text-green-600"}):e.jsx(zF,{className:"h-4 w-4 text-gray-600"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold",children:["Account ",t]}),e.jsxs("p",{className:"text-muted-foreground",children:[b.customer.first_name," ",b.customer.last_name]})]}),e.jsx(Ae,{variant:b.connection.status==="active"?"default":"destructive",children:b.connection.status})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Current Balance"}),e.jsx(xI,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["KES ",U.toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:U>0?"Outstanding":"Paid up"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Avg. Consumption"}),te]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[(N==null?void 0:N.average)||0," m"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 capitalize",children:["Trend: ",((re=N==null?void 0:N.trend)==null?void 0:re.replace("_"," "))||"N/A"]})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Open Cases"}),e.jsx(Nn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b.active_cases_count}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Revenue Assurance"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Complaints"}),e.jsx(bC,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b.open_complaints_count}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Open issues"})]})]})]}),e.jsxs(ss,{defaultValue:"summary",className:"w-full",children:[e.jsxs(Yr,{children:[e.jsx(wt,{value:"summary",children:"Summary"}),e.jsx(wt,{value:"billing",children:"Billing"}),e.jsx(wt,{value:"payments",children:"Payments"}),e.jsx(wt,{value:"reads",children:"Meter Reads"}),e.jsx(wt,{value:"complaints",children:"Complaints"}),e.jsx(wt,{value:"notes",children:"Notes"}),e.jsx(wt,{value:"cases",children:"RA Cases"})]}),e.jsxs(kt,{value:"summary",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Customer Information"})}),e.jsxs(X,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Name:"}),e.jsxs("span",{className:"text-sm",children:[b.customer.first_name," ",b.customer.last_name]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"ID Number:"}),e.jsx("span",{className:"text-sm",children:b.customer.id_number})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Phone:"}),e.jsx("span",{className:"text-sm",children:b.customer.phone})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Email:"}),e.jsx("span",{className:"text-sm",children:b.customer.email||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Type:"}),e.jsx(Ae,{variant:"outline",children:b.customer.customer_type})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Premise Details"})}),e.jsxs(X,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Address:"}),e.jsx("span",{className:"text-sm",children:b.premise.address})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Category:"}),e.jsx(Ae,{variant:"outline",children:b.premise.category})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Connection Date:"}),e.jsx("span",{className:"text-sm",children:new Date(b.connection.connected_at).toLocaleDateString()})]}),b.latest_meter&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Meter No:"}),e.jsx("span",{className:"text-sm",children:b.latest_meter.meter_no})]})]})]})]}),b.balance&&b.balance.balance>0&&e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Balance Aging"})}),e.jsx(X,{children:e.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Current"}),e.jsxs("p",{className:"text-lg font-bold",children:["KES ",b.balance.current.toLocaleString()]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"1-30 Days"}),e.jsxs("p",{className:"text-lg font-bold",children:["KES ",b.balance.days_30.toLocaleString()]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"31-60 Days"}),e.jsxs("p",{className:"text-lg font-bold",children:["KES ",b.balance.days_60.toLocaleString()]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"61-90 Days"}),e.jsxs("p",{className:"text-lg font-bold",children:["KES ",b.balance.days_90.toLocaleString()]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Over 90 Days"}),e.jsxs("p",{className:"text-lg font-bold text-red-600",children:["KES ",b.balance.over_90.toLocaleString()]})]})]})})]}),N&&N.consumption.length>0&&e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(Wl,{className:"h-5 w-5"}),"Consumption Trends (Last 12 Months)"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"h-[300px]",children:e.jsx(Ha,{width:"100%",height:"100%",children:e.jsxs(Km,{data:N.consumption.map(Z=>({month:new Date(Z.period_start).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),consumption:Z.consumption})),margin:{top:5,right:20,bottom:5,left:0},children:[e.jsx(Zi,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(Ma,{dataKey:"month",className:"text-xs",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(fa,{className:"text-xs",tick:{fill:"hsl(var(--muted-foreground))"},label:{value:"m",angle:-90,position:"insideLeft",fill:"hsl(var(--muted-foreground))"}}),e.jsx(_n,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"6px"},labelStyle:{color:"hsl(var(--foreground))"}}),e.jsx(ui,{type:"monotone",dataKey:"consumption",stroke:"hsl(var(--primary))",strokeWidth:2,dot:{fill:"hsl(var(--primary))",r:4},activeDot:{r:6}})]})})}),e.jsxs("div",{className:"mt-4 flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Average:"}),e.jsxs("span",{className:"font-semibold",children:[N.average," m/month"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Trend:"}),e.jsxs(Ae,{variant:N.trend==="increasing"?"destructive":N.trend==="decreasing"?"default":"secondary",children:[N.trend==="increasing"&&e.jsx(zs,{className:"h-3 w-3 mr-1"}),N.trend==="decreasing"&&e.jsx(ci,{className:"h-3 w-3 mr-1"}),N.trend==="stable"&&e.jsx(zF,{className:"h-3 w-3 mr-1"}),N.trend.replace("_"," ")]})]})]})]})]})]}),e.jsx(kt,{value:"billing",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Recent Invoices"})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Period"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Amount"}),e.jsx(se,{children:"Due Date"})]})}),e.jsx(lr,{children:T==null?void 0:T.invoices.map(Z=>e.jsxs(Qe,{children:[e.jsxs(J,{children:[new Date(Z.period_start).toLocaleDateString()," -"," ",new Date(Z.period_end).toLocaleDateString()]}),e.jsx(J,{children:e.jsx(Ae,{variant:Z.status==="paid"?"default":"secondary",children:Z.status})}),e.jsxs(J,{children:["KES ",Z.total_amount.toLocaleString()]}),e.jsx(J,{children:new Date(Z.due_at).toLocaleDateString()})]},Z.id))})]})})]})}),e.jsx(kt,{value:"payments",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Payment History"})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Date"}),e.jsx(se,{children:"Amount"}),e.jsx(se,{children:"Channel"}),e.jsx(se,{children:"Reference"})]})}),e.jsx(lr,{children:T==null?void 0:T.payments.map(Z=>e.jsxs(Qe,{children:[e.jsx(J,{children:new Date(Z.paid_at).toLocaleDateString()}),e.jsxs(J,{children:["KES ",Z.amount.toLocaleString()]}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:Z.channel})}),e.jsx(J,{className:"font-mono text-sm",children:Z.reference})]},Z.id))})]})})]})}),e.jsx(kt,{value:"reads",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Recent Meter Reads"})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Date"}),e.jsx(se,{children:"Reading"}),e.jsx(se,{children:"Consumption"}),e.jsx(se,{children:"Quality"}),e.jsx(se,{children:"Source"})]})}),e.jsx(lr,{children:b.recent_reads.map((Z,ne)=>{const oe=ne>0?b.recent_reads[ne-1]:null,Ce=oe?Z.value-oe.value:null;return e.jsxs(Qe,{children:[e.jsx(J,{children:new Date(Z.read_at).toLocaleDateString()}),e.jsxs(J,{children:[Z.value," m"]}),e.jsx(J,{children:Ce!==null?`${Ce} m`:"-"}),e.jsx(J,{children:e.jsx(Ae,{variant:Z.quality==="good"?"default":"secondary",children:Z.quality})}),e.jsx(J,{children:Z.source})]},Z.id)})})]})})]})}),e.jsx(kt,{value:"complaints",children:e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between",children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(Ki,{className:"h-5 w-5"}),"Customer Complaints"]}),e.jsxs(Qt,{open:s,onOpenChange:n,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{size:"sm",children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Log Complaint"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Log New Complaint"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Category"}),e.jsxs(Nt,{value:a.category,onValueChange:Z=>o({...a,category:Z}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"billing",children:"Billing"}),e.jsx(ge,{value:"water_quality",children:"Water Quality"}),e.jsx(ge,{value:"supply",children:"Supply Issue"}),e.jsx(ge,{value:"meter",children:"Meter Problem"}),e.jsx(ge,{value:"leak",children:"Leak Report"}),e.jsx(ge,{value:"customer_service",children:"Customer Service"}),e.jsx(ge,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Priority"}),e.jsxs(Nt,{value:a.priority,onValueChange:Z=>o({...a,priority:Z}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"low",children:"Low"}),e.jsx(ge,{value:"medium",children:"Medium"}),e.jsx(ge,{value:"high",children:"High"}),e.jsx(ge,{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Description"}),e.jsx(ws,{placeholder:"Describe the issue...",value:a.description||"",onChange:Z=>o({...a,description:Z.target.value}),rows:4})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsx(K,{onClick:()=>{C.mutate({...a,account_no:t,customer_id:b==null?void 0:b.customer.id})},disabled:!a.description||C.isPending,children:C.isPending?"Creating...":"Create Complaint"})]})]})]})]}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"ID"}),e.jsx(se,{children:"Category"}),e.jsx(se,{children:"Priority"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Created"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:M!=null&&M.data&&M.data.length>0?M.data.map(Z=>e.jsxs(Qe,{children:[e.jsxs(J,{className:"font-mono text-sm",children:["#",Z.id]}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:Z.category.replace("_"," ")})}),e.jsx(J,{children:e.jsx(Ae,{variant:Z.priority==="critical"?"destructive":Z.priority==="high"?"default":"secondary",children:Z.priority})}),e.jsx(J,{children:e.jsx(Ae,{variant:Z.status==="resolved"||Z.status==="closed"?"default":"secondary",children:Z.status})}),e.jsx(J,{children:new Date(Z.created_at).toLocaleDateString()}),e.jsx(J,{children:Z.status==="open"&&e.jsx(K,{size:"sm",variant:"outline",onClick:()=>D.mutate({id:Z.id,data:{status:"triage"}}),children:"Triage"})})]},Z.id)):e.jsx(Qe,{children:e.jsx(J,{colSpan:6,className:"text-center text-muted-foreground",children:"No complaints found for this account"})})})]})})]})}),e.jsx(kt,{value:"notes",children:e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between",children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"h-5 w-5"}),"Account Notes"]}),e.jsxs(Qt,{open:c,onOpenChange:Z=>{i(Z),Z||(p(null),y(""))},children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{size:"sm",children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Add Note"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:f?"Edit Note":"Add New Note"})}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Note Content"}),e.jsx(ws,{placeholder:"Enter your note here...",value:g,onChange:Z=>y(Z.target.value),rows:6})]})}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:()=>{i(!1),p(null),y("")},children:"Cancel"}),e.jsx(K,{onClick:()=>{f?F.mutate({id:f.id,data:{content:g}}):L.mutate({account_no:t,customer_id:b==null?void 0:b.customer.id,content:g})},disabled:!g.trim()||L.isPending||F.isPending,children:L.isPending||F.isPending?"Saving...":f?"Update Note":"Add Note"})]})]})]})]}),e.jsx(X,{children:e.jsx("div",{className:"space-y-4",children:O!=null&&O.data&&O.data.length>0?O.data.map(Z=>{var ne;return e.jsx("div",{className:"border rounded-lg p-4 space-y-2 hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:Z.content}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx("span",{children:((ne=Z.createdBy)==null?void 0:ne.name)||"Unknown"}),e.jsx("span",{children:""}),e.jsx("span",{children:new Date(Z.created_at).toLocaleString()}),Z.updated_at!==Z.created_at&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsx("span",{className:"italic",children:"edited"})]})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(K,{size:"sm",variant:"ghost",onClick:()=>{p(Z),y(Z.content),i(!0)},children:e.jsx(k_,{className:"h-3 w-3"})}),e.jsx(K,{size:"sm",variant:"ghost",onClick:()=>{window.confirm("Are you sure you want to delete this note?")&&B.mutate(Z.id)},disabled:B.isPending,children:e.jsx(Ws,{className:"h-3 w-3"})})]})]})},Z.id)}):e.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[e.jsx(bs,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No notes found for this account"}),e.jsx("p",{className:"text-sm",children:"Add a note to keep track of important information"})]})})})]})}),e.jsx(kt,{value:"cases",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Revenue Assurance Cases"})}),e.jsx(X,{children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[b.active_cases_count," active case(s) for this account"]})})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(Qt,{children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{variant:"outline",className:"w-full",children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Move-In"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Process Move-In"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Move-In Date"}),e.jsx("input",{type:"date",className:"w-full border rounded px-3 py-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Initial Meter Reading (m)"}),e.jsx("input",{type:"number",placeholder:"0.00",className:"w-full border rounded px-3 py-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Notes"}),e.jsx(ws,{placeholder:"Any special notes...",rows:3})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",children:"Cancel"}),e.jsx(K,{onClick:()=>Me.success("Move-in processed successfully"),children:"Complete Move-In"})]})]})]}),e.jsxs(Qt,{children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{variant:"outline",className:"w-full",children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Move-Out"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Process Move-Out"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Move-Out Date"}),e.jsx("input",{type:"date",className:"w-full border rounded px-3 py-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Final Meter Reading (m)"}),e.jsx("input",{type:"number",placeholder:"0.00",className:"w-full border rounded px-3 py-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Account Status After Move-Out"}),e.jsxs("select",{className:"w-full border rounded px-3 py-2",children:[e.jsx("option",{children:"Disconnected"}),e.jsx("option",{children:"Suspended"}),e.jsx("option",{children:"Closed"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Notes"}),e.jsx(ws,{placeholder:"Outstanding balance notes, forwarding address, etc...",rows:3})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",children:"Cancel"}),e.jsx(K,{onClick:()=>Me.success("Move-out processed successfully"),className:"bg-orange-600 hover:bg-orange-700",children:"Complete Move-Out"})]})]})]})]})]})}function gze(){const[t,r]=A.useState(""),s=Fp(),n=a=>{a.preventDefault(),t.trim()&&s(`/crm/accounts/${t.trim()}`)};return e.jsx("div",{className:"max-w-2xl mx-auto mt-16",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Account 360 Search"})}),e.jsx(X,{children:e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Enter Account Number"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ie,{placeholder:"e.g., ACC-001",value:t,onChange:a=>r(a.target.value),className:"flex-1"}),e.jsxs(K,{type:"submit",disabled:!t.trim(),children:[e.jsx(nn,{className:"h-4 w-4 mr-2"}),"Search"]})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter a customer account number to view complete account details, billing history, consumption analytics, and revenue assurance cases."})]})})]})})}const yze=["all","open","triage","field","resolved","closed"],vze=["all","low","medium","high","critical"],jze=["all","billing","water_quality","supply","meter","leak","customer_service","other"];function bze(){const t=yr(),[r,s]=A.useState(""),[n,a]=A.useState("all"),[o,c]=A.useState("all"),[i,f]=A.useState("all"),[p,g]=A.useState("list"),{data:y,isLoading:b,isError:w,error:T}=it({queryKey:["complaints",r,n,o,i],queryFn:()=>{const L={};return r&&(L.search=r),n!=="all"&&(L.status=n),o!=="all"&&(L.priority=o),i!=="all"&&(L.category=i),jn.getComplaints(L)}}),N=gt({mutationFn:({id:L,data:F})=>jn.updateComplaint(L,F),onSuccess:()=>{t.invalidateQueries({queryKey:["complaints"]}),Me.success("Complaint updated successfully")},onError:L=>{Me.error(L.message||"Failed to update complaint")}}),M=(y==null?void 0:y.data)||[],O=L=>L==="resolved"||L==="closed"?"default":L==="field"?"secondary":"outline",C=L=>L==="critical"?"destructive":L==="high"?"default":"secondary",D=M.reduce((L,F)=>(L[F.status]||(L[F.status]=[]),L[F.status].push(F),L),{});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Customer Complaints"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage and track customer service complaints"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{variant:p==="list"?"default":"outline",onClick:()=>g("list"),size:"sm",children:"List View"}),e.jsx(K,{variant:p==="kanban"?"default":"outline",onClick:()=>g("kanban"),size:"sm",children:"Kanban Board"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search complaints by account, description...",value:r,onChange:L=>s(L.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(Nt,{value:n,onValueChange:L=>a(L),children:[e.jsx(bt,{className:"w-[150px]",children:e.jsx(St,{placeholder:"Status"})}),e.jsx(_t,{children:yze.map(L=>e.jsx(ge,{value:L,children:L==="all"?"All Status":L.replace("_"," ")},L))})]}),e.jsxs(Nt,{value:o,onValueChange:L=>c(L),children:[e.jsx(bt,{className:"w-[150px]",children:e.jsx(St,{placeholder:"Priority"})}),e.jsx(_t,{children:vze.map(L=>e.jsx(ge,{value:L,children:L==="all"?"All Priority":L},L))})]}),e.jsxs(Nt,{value:i,onValueChange:L=>f(L),children:[e.jsx(bt,{className:"w-[180px]",children:e.jsx(St,{placeholder:"Category"})}),e.jsx(_t,{children:jze.map(L=>e.jsx(ge,{value:L,children:L==="all"?"All Categories":L.replace("_"," ")},L))})]})]})]})}),e.jsx(X,{children:b?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading complaints..."}):w?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Nn,{className:"h-12 w-12 mx-auto mb-2 text-destructive opacity-50"}),e.jsx("p",{className:"text-destructive font-semibold",children:"Failed to load complaints"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:(T==null?void 0:T.message)||"An error occurred while fetching complaints"})]}):p==="list"?e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"ID"}),e.jsx(se,{children:"Account"}),e.jsx(se,{children:"Category"}),e.jsx(se,{children:"Priority"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Created"}),e.jsx(se,{children:"Description"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:M.length>0?M.map(L=>e.jsxs(Qe,{children:[e.jsxs(J,{className:"font-mono text-sm",children:["#",L.id]}),e.jsx(J,{children:e.jsxs(Pn,{to:`/crm/accounts/${L.account_no}`,className:"text-blue-600 hover:underline flex items-center gap-1",children:[L.account_no,e.jsx(i9,{className:"h-3 w-3"})]})}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:L.category.replace("_"," ")})}),e.jsx(J,{children:e.jsx(Ae,{variant:C(L.priority),children:L.priority})}),e.jsx(J,{children:e.jsx(Ae,{variant:O(L.status),children:L.status})}),e.jsx(J,{className:"text-sm",children:new Date(L.created_at).toLocaleDateString()}),e.jsx(J,{className:"max-w-xs truncate",children:L.description}),e.jsxs(J,{children:[L.status==="open"&&e.jsx(K,{size:"sm",variant:"outline",disabled:N.isPending,onClick:()=>N.mutate({id:L.id,data:{status:"triage"}}),children:N.isPending?"Updating...":"Triage"}),L.status==="triage"&&e.jsx(K,{size:"sm",variant:"outline",disabled:N.isPending,onClick:()=>N.mutate({id:L.id,data:{status:"field"}}),children:N.isPending?"Updating...":"Send to Field"})]})]},L.id)):e.jsx(Qe,{children:e.jsx(J,{colSpan:8,className:"text-center text-muted-foreground",children:"No complaints found"})})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:["open","triage","field","resolved","closed"].map(L=>{var F,B;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold capitalize",children:L.replace("_"," ")}),e.jsx(Ae,{variant:"secondary",children:((F=D[L])==null?void 0:F.length)||0})]}),e.jsx("div",{className:"space-y-2",children:((B=D[L])==null?void 0:B.map(U=>e.jsx(H,{className:"p-3 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("span",{className:"text-xs font-mono text-muted-foreground",children:["#",U.id]}),e.jsx(Ae,{variant:C(U.priority),className:"text-xs",children:U.priority})]}),e.jsx(Pn,{to:`/crm/accounts/${U.account_no}`,className:"text-sm font-medium hover:underline block",children:U.account_no}),e.jsx(Ae,{variant:"outline",className:"text-xs",children:U.category.replace("_"," ")}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:U.description}),e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(U.created_at).toLocaleDateString()})]})},U.id)))||e.jsx("div",{className:"text-center text-sm text-muted-foreground py-4",children:"No complaints"})})]},L)})})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Summary"})}),e.jsx(X,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Complaints"}),e.jsx("p",{className:"text-2xl font-bold",children:M.length})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Open"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:M.filter(L=>L.status==="open").length})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"In Progress"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:M.filter(L=>["triage","field"].includes(L.status)).length})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Resolved"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:M.filter(L=>["resolved","closed"].includes(L.status)).length})]})]})})]})]})}const ET=["phone","email","sms","web_portal","walk_in","field_visit"],_ze={phone:_m,email:Fm,sms:Nb,web_portal:fy,walk_in:fn,field_visit:fn};function wze(){const t=yr(),[r,s]=A.useState(""),[n,a]=A.useState("all"),[o,c]=A.useState(!1),[i,f]=A.useState({account_no:"",channel:"phone",subject:"",message:""}),{data:p,isLoading:g}=it({queryKey:["interactions",r,n],queryFn:()=>{const N={per_page:100};return r&&(N.search=r),n!=="all"&&(N.channel=n),jn.getInteractions(N)}}),y=gt({mutationFn:N=>jn.createInteraction(N),onSuccess:()=>{t.invalidateQueries({queryKey:["interactions"]}),c(!1),f({account_no:"",channel:"phone",subject:"",message:""}),Me.success("Interaction logged successfully")},onError:N=>{Me.error(N.message||"Failed to log interaction")}}),b=(p==null?void 0:p.data)||[],w=N=>{const M=_ze[N]||Ki;return e.jsx(M,{className:"h-4 w-4"})},T=N=>({phone:"bg-blue-100 text-blue-800",email:"bg-purple-100 text-purple-800",sms:"bg-green-100 text-green-800",web_portal:"bg-orange-100 text-orange-800",walk_in:"bg-yellow-100 text-yellow-800",field_visit:"bg-red-100 text-red-800"})[N]||"bg-gray-100 text-gray-800";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Customer Interactions"}),e.jsx("p",{className:"text-muted-foreground",children:"Log and track all customer touchpoints"})]}),e.jsxs(Qt,{open:o,onOpenChange:c,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Log Interaction"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Log New Interaction"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Account Number"}),e.jsx(Ie,{placeholder:"e.g., ACC-12345",value:i.account_no,onChange:N=>f({...i,account_no:N.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Channel"}),e.jsxs(Nt,{value:i.channel,onValueChange:N=>f({...i,channel:N}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsx(_t,{children:ET.map(N=>e.jsx(ge,{value:N,children:N.replace("_"," ")},N))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Subject"}),e.jsx(Ie,{placeholder:"Brief subject",value:i.subject,onChange:N=>f({...i,subject:N.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Message"}),e.jsx(ws,{placeholder:"Interaction details",value:i.message,onChange:N=>f({...i,message:N.target.value}),rows:4})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsx(K,{onClick:()=>y.mutate(i),disabled:!i.account_no||!i.subject||!i.message||y.isPending,children:y.isPending?"Logging...":"Log Interaction"})]})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search by account number or subject...",value:r,onChange:N=>s(N.target.value),className:"pl-10"})]}),e.jsxs(Nt,{value:n,onValueChange:N=>a(N),children:[e.jsx(bt,{className:"w-[150px]",children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Channels"}),ET.map(N=>e.jsx(ge,{value:N,children:N.replace("_"," ")},N))]})]})]})}),e.jsx(X,{children:g?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading interactions..."}):b.length>0?e.jsx("div",{className:"space-y-3",children:b.map(N=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-muted/50 transition-colors",children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${T(N.channel)}`,children:w(N.channel)}),e.jsxs("div",{children:[e.jsx(Pn,{to:`/crm/accounts/${N.account_no}`,className:"font-semibold hover:underline text-blue-600",children:N.account_no}),e.jsx("p",{className:"text-sm text-muted-foreground",children:N.subject})]})]}),e.jsx("p",{className:"text-sm leading-relaxed",children:N.message}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[e.jsx(Ae,{variant:"outline",className:"text-xs",children:N.channel.replace("_"," ")}),e.jsx("span",{children:new Date(N.created_at).toLocaleString()})]})]})})},N.id))}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Ki,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No interactions found"})]})})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:ET.map(N=>e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:`p-3 rounded-lg ${T(N)}`,children:w(N)}),e.jsx("p",{className:"text-sm font-medium capitalize",children:N.replace("_"," ")}),e.jsx("p",{className:"text-2xl font-bold",children:b.filter(M=>M.channel===N).length})]})})},N))})]})}function Nze(){const[t,r]=A.useState({residential:!1,commercial:!1,industrial:!1,public:!1}),[s,n]=A.useState({min:0,max:1e5}),[a,o]=A.useState({min:0,max:1e4}),[c,i]=A.useState("active"),[f,p]=A.useState(""),{data:g}=it({queryKey:["customers",{per_page:1e3}],queryFn:()=>jn.getCustomers({per_page:1e3})}),y=(g==null?void 0:g.data)||[],b=y.filter(M=>Object.values(t).some(C=>C)===!1||t[M.customer_type]),w=[{id:"residential",label:"Residential",count:y.filter(M=>M.customer_type==="residential").length,color:"bg-blue-100 text-blue-800"},{id:"commercial",label:"Commercial",count:y.filter(M=>M.customer_type==="commercial").length,color:"bg-purple-100 text-purple-800"},{id:"industrial",label:"Industrial",count:y.filter(M=>M.customer_type==="industrial").length,color:"bg-orange-100 text-orange-800"},{id:"public",label:"Public",count:y.filter(M=>M.customer_type==="public").length,color:"bg-green-100 text-green-800"}],T=()=>{if(!f.trim()){Me.error("Please enter a segment name");return}Me.success(`Segment "${f}" created with ${b.length} customers`),p("")},N=()=>{const M=[["Account","Name","Type","Phone","Email"],...b.map(L=>[L.id,`${L.first_name} ${L.last_name}`,L.customer_type,L.phone,L.email||""])].map(L=>L.map(F=>`"${F}"`).join(",")).join(`
`),O=new Blob([M],{type:"text/csv"}),C=window.URL.createObjectURL(O),D=document.createElement("a");D.href=C,D.download=`segment-${Date.now()}.csv`,D.click(),Me.success("Segment exported successfully")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Customer Segmentation"}),e.jsx("p",{className:"text-muted-foreground",children:"Create and manage customer segments for targeted campaigns"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(o9,{className:"h-5 w-5"}),"Segment Filters"]})}),e.jsxs(X,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold",children:"Customer Type"}),w.map(M=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fd,{id:M.id,checked:t[M.id],onCheckedChange:O=>r({...t,[M.id]:O===!0})}),e.jsx(we,{htmlFor:M.id,className:"cursor-pointer flex-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:M.label}),e.jsx(Ae,{variant:"secondary",children:M.count})]})})]},M.id))]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold",children:"Status"}),e.jsxs(Nt,{value:c,onValueChange:i,children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Statuses"}),e.jsx(ge,{value:"active",children:"Active"}),e.jsx(ge,{value:"suspended",children:"Suspended"}),e.jsx(ge,{value:"disconnected",children:"Disconnected"})]})]})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsx(we,{children:"Balance Range (KES)"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(Ie,{type:"number",placeholder:"Min",value:s.min,onChange:M=>n({...s,min:Number(M.target.value)})}),e.jsx(Ie,{type:"number",placeholder:"Max",value:s.max,onChange:M=>n({...s,max:Number(M.target.value)})})]})]})}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsx(we,{children:"Segment Name"}),e.jsx(Ie,{placeholder:"e.g., High-Value Residential",value:f,onChange:M=>p(M.target.value),className:"mt-2"})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(K,{onClick:T,className:"w-full",children:[e.jsx(vI,{className:"h-4 w-4 mr-2"}),"Save Segment"]}),e.jsxs(K,{onClick:N,variant:"outline",className:"w-full",children:[e.jsx(ma,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})]})]})}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Segment Overview"}),e.jsxs(Ae,{children:[b.length," customers"]})]})}),e.jsx(X,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:w.map(M=>e.jsxs("div",{className:`p-4 rounded-lg ${M.color}`,children:[e.jsx("p",{className:"text-sm font-medium opacity-80",children:M.label}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:b.filter(O=>O.customer_type===M.id).length})]},M.id))})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(Wl,{className:"h-5 w-5"}),"Segment Statistics"]})}),e.jsx(X,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Customers"}),e.jsx("p",{className:"text-3xl font-bold",children:b.length})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Percentage of All"}),e.jsxs("p",{className:"text-3xl font-bold",children:[y.length>0?(b.length/y.length*100).toFixed(1):0,"%"]})]})]})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Sample Customers in Segment"})}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-2 max-h-80 overflow-y-auto",children:[b.slice(0,10).map(M=>e.jsxs("div",{className:"border rounded p-2 text-sm",children:[e.jsxs("p",{className:"font-medium",children:[M.first_name," ",M.last_name]}),e.jsx("p",{className:"text-muted-foreground",children:M.phone})]},M.id)),b.length>10&&e.jsxs("p",{className:"text-sm text-muted-foreground pt-2",children:["+",b.length-10," more customers"]})]})})]})]})]})]})}const FX={low:"bg-gray-100 text-gray-800",medium:"bg-blue-100 text-blue-800",high:"bg-orange-100 text-orange-800",critical:"bg-red-100 text-red-800"},$X={new:"bg-purple-100 text-purple-800",triage:"bg-blue-100 text-blue-800",field:"bg-orange-100 text-orange-800",resolved:"bg-green-100 text-green-800",closed_valid:"bg-gray-100 text-gray-800",closed_false_positive:"bg-gray-100 text-gray-800"};function Sze(){const[t,r]=A.useState(null),[s,n]=A.useState(""),[a,o]=A.useState(null),c=yr(),{data:i,isLoading:f}=it({queryKey:["ra-high-priority"],queryFn:()=>jn.getHighPriorityCases(10)}),{data:p,isLoading:g}=it({queryKey:["ra-cases"],queryFn:()=>jn.getRaCases()}),y=gt({mutationFn:({caseId:C,decision:D,notes:L})=>jn.triageCase(C,{decision:D,notes:L}),onSuccess:()=>{c.invalidateQueries({queryKey:["ra-cases"]}),c.invalidateQueries({queryKey:["ra-high-priority"]}),Me.success("Case triaged successfully"),r(null),n(""),o(null)},onError:C=>{Me.error(`Triage failed: ${C.message}`)}}),b=()=>{!t||!a||y.mutate({caseId:t.id,decision:a,notes:s})},w=C=>{r(C),n(""),o(null)};if(g)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("p",{className:"text-lg",children:"Loading RA cases..."})});const T=(p==null?void 0:p.data)||[],N=T.filter(C=>C.status==="new"),M=T.filter(C=>C.status==="triage"),O=T.filter(C=>C.status==="field");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Revenue Assurance Console"}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor and triage revenue leakage cases"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"New Cases"}),e.jsx(Fr,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:N.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting triage"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"In Triage"}),e.jsx($s,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:M.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Under review"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Field Investigation"}),e.jsx(zs,{className:"h-4 w-4 text-purple-600"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:O.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active investigations"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total Active"}),e.jsx(Fr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:T.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All cases"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"High Priority Cases"})}),e.jsx(X,{children:f?e.jsx("p",{className:"text-muted-foreground",children:"Loading..."}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Account"}),e.jsx(se,{children:"Priority"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Detected"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:(i==null?void 0:i.data.length)===0?e.jsx(Qe,{children:e.jsx(J,{colSpan:5,className:"text-center text-muted-foreground",children:"No high-priority cases"})}):i==null?void 0:i.data.map(C=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:C.account_no}),e.jsx(J,{children:e.jsx(Ae,{className:FX[C.priority],children:C.priority})}),e.jsx(J,{children:e.jsx(Ae,{className:$X[C.status],children:C.status})}),e.jsx(J,{children:new Date(C.detected_at).toLocaleDateString()}),e.jsx(J,{children:C.status==="new"&&e.jsx(K,{variant:"outline",size:"sm",onClick:()=>w(C),disabled:y.isPending,children:y.isPending?"Processing...":"Triage"})})]},C.id))})]})})]}),e.jsxs(ss,{defaultValue:"all",children:[e.jsxs(Yr,{children:[e.jsxs(wt,{value:"all",children:["All Cases (",T.length,")"]}),e.jsxs(wt,{value:"new",children:["New (",N.length,")"]}),e.jsxs(wt,{value:"triage",children:["Triage (",M.length,")"]}),e.jsxs(wt,{value:"field",children:["Field (",O.length,")"]})]}),e.jsx(kt,{value:"all",children:e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:g?e.jsx("p",{className:"text-muted-foreground",children:"Loading cases..."}):e.jsx(NN,{cases:T,onTriage:w})})})}),e.jsx(kt,{value:"new",children:e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsx(NN,{cases:N,onTriage:w})})})}),e.jsx(kt,{value:"triage",children:e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsx(NN,{cases:M,onTriage:w})})})}),e.jsx(kt,{value:"field",children:e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsx(NN,{cases:O,onTriage:w})})})})]}),e.jsx(Qt,{open:!!t,onOpenChange:()=>r(null),children:e.jsxs(Zt,{children:[e.jsxs(Yt,{children:[e.jsxs(Xt,{children:["Triage Case #",t==null?void 0:t.id]}),e.jsxs(Es,{children:["Account: ",t==null?void 0:t.account_no]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(we,{children:"Evidence"}),e.jsx("pre",{className:"mt-2 p-3 bg-muted rounded text-xs overflow-auto max-h-40",children:JSON.stringify(t==null?void 0:t.evidence,null,2)})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Decision"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsxs(K,{variant:a==="field"?"default":"outline",onClick:()=>o("field"),children:[e.jsx(Ns,{className:"h-4 w-4 mr-2"}),"Send to Field"]}),e.jsxs(K,{variant:a==="false_positive"?"default":"outline",onClick:()=>o("false_positive"),children:[e.jsx(ec,{className:"h-4 w-4 mr-2"}),"False Positive"]})]})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"notes",children:"Notes"}),e.jsx(ws,{id:"notes",value:s,onChange:C=>n(C.target.value),placeholder:"Add notes about this decision...",rows:4})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:()=>r(null),children:"Cancel"}),e.jsx(K,{onClick:b,disabled:!a||y.isPending,children:y.isPending?"Submitting...":"Submit Triage"})]})]})})]})}function NN({cases:t,onTriage:r}){return t.length===0?e.jsx("p",{className:"text-center text-muted-foreground",children:"No cases found"}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"ID"}),e.jsx(se,{children:"Account"}),e.jsx(se,{children:"Priority"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Detected"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:t.map(s=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono text-sm",children:s.id}),e.jsx(J,{className:"font-medium",children:s.account_no}),e.jsx(J,{children:e.jsx(Ae,{className:FX[s.priority],children:s.priority})}),e.jsx(J,{children:e.jsx(Ae,{className:$X[s.status],children:s.status})}),e.jsx(J,{children:new Date(s.detected_at).toLocaleDateString()}),e.jsx(J,{children:s.status==="new"&&e.jsx(K,{variant:"outline",size:"sm",onClick:()=>r(s),children:"Triage"})})]},s.id))})]})}function Cze(){var y,b,w,T,N,M,O;const[t,r]=A.useState(new Set),s=yr(),{data:n,isLoading:a}=it({queryKey:["aging-report"],queryFn:()=>jn.getAgingReport()}),{data:o,isLoading:c}=it({queryKey:["disconnection-list"],queryFn:()=>jn.getDisconnectionList()}),i=gt({mutationFn:C=>jn.generateDunningNotices(C),onMutate:C=>{r(D=>new Set(D).add(C))},onSuccess:(C,D)=>{r(L=>{const F=new Set(L);return F.delete(D),F}),s.invalidateQueries({queryKey:["aging-report"]}),Me.success("Dunning notices generated successfully")},onError:(C,D)=>{r(L=>{const F=new Set(L);return F.delete(D),F}),Me.error(`Failed to generate notices: ${C.message}`)}}),f=C=>{window.confirm(`Generate dunning notices for ${C} accounts?`)&&i.mutate(C)},p={total_balance:((y=n==null?void 0:n.summary)==null?void 0:y.total_balance)??0,total_accounts:((b=n==null?void 0:n.summary)==null?void 0:b.total_accounts)??0,current:((w=n==null?void 0:n.summary)==null?void 0:w.current)??0,days_30:((T=n==null?void 0:n.summary)==null?void 0:T.days_30)??0,days_60:((N=n==null?void 0:n.summary)==null?void 0:N.days_60)??0,days_90:((M=n==null?void 0:n.summary)==null?void 0:M.days_90)??0,over_90:((O=n==null?void 0:n.summary)==null?void 0:O.over_90)??0},g=(n==null?void 0:n.by_category)||{};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Dunning & Collections"}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor overdue accounts and manage collections"})]}),a?e.jsx("p",{className:"text-muted-foreground",children:"Loading aging report..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total Balance"}),e.jsx(Ga,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["KES ",p.total_balance.toLocaleString()]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[p.total_accounts," accounts"]})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Current"}),e.jsx(Ds,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["KES ",p.current.toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Not overdue"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"1-90 Days"}),e.jsx(Fr,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["KES ",(p.days_30+p.days_60+p.days_90).toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Overdue"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Over 90 Days"}),e.jsx(ci,{className:"h-4 w-4 text-red-600"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold text-red-600",children:["KES ",p.over_90.toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Critical"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Balance Aging Breakdown"})}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-4 text-sm font-medium text-muted-foreground",children:[e.jsx("div",{children:"Bucket"}),e.jsx("div",{children:"Amount"}),e.jsx("div",{children:"% of Total"}),e.jsx("div",{children:"Count"}),e.jsx("div",{children:"Actions"})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-t",children:[e.jsx("div",{className:"font-medium",children:"Current"}),e.jsxs("div",{children:["KES ",p==null?void 0:p.current.toLocaleString()]}),e.jsxs("div",{children:[p!=null&&p.total_balance?(p.current/p.total_balance*100).toFixed(1):0,"%"]}),e.jsx("div",{children:"-"}),e.jsx("div",{children:e.jsx(Ae,{variant:"outline",children:"No Action"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-t",children:[e.jsx("div",{className:"font-medium",children:"1-30 Days"}),e.jsxs("div",{children:["KES ",p==null?void 0:p.days_30.toLocaleString()]}),e.jsxs("div",{children:[p!=null&&p.total_balance?(p.days_30/p.total_balance*100).toFixed(1):0,"%"]}),e.jsx("div",{children:"-"}),e.jsx("div",{children:e.jsx(K,{size:"sm",variant:"outline",onClick:()=>f("days_30"),disabled:t.has("days_30"),children:t.has("days_30")?"Generating...":"Reminder Notice"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-t",children:[e.jsx("div",{className:"font-medium",children:"31-60 Days"}),e.jsxs("div",{children:["KES ",p==null?void 0:p.days_60.toLocaleString()]}),e.jsxs("div",{children:[p!=null&&p.total_balance?(p.days_60/p.total_balance*100).toFixed(1):0,"%"]}),e.jsx("div",{children:"-"}),e.jsx("div",{children:e.jsx(K,{size:"sm",variant:"outline",onClick:()=>f("days_60"),disabled:t.has("days_60"),children:t.has("days_60")?"Generating...":"Warning Notice"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-t",children:[e.jsx("div",{className:"font-medium",children:"61-90 Days"}),e.jsxs("div",{children:["KES ",p==null?void 0:p.days_90.toLocaleString()]}),e.jsxs("div",{children:[p!=null&&p.total_balance?(p.days_90/p.total_balance*100).toFixed(1):0,"%"]}),e.jsx("div",{children:"-"}),e.jsx("div",{children:e.jsx(K,{size:"sm",variant:"destructive",onClick:()=>f("days_90"),disabled:t.has("days_90"),children:t.has("days_90")?"Generating...":"Final Notice"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-t",children:[e.jsx("div",{className:"font-medium text-red-600",children:"Over 90 Days"}),e.jsxs("div",{className:"text-red-600 font-bold",children:["KES ",p==null?void 0:p.over_90.toLocaleString()]}),e.jsxs("div",{className:"text-red-600",children:[p!=null&&p.total_balance?(p.over_90/p.total_balance*100).toFixed(1):0,"%"]}),e.jsx("div",{children:"-"}),e.jsx("div",{children:e.jsx(K,{size:"sm",variant:"destructive",onClick:()=>f("over_90"),disabled:t.has("over_90"),children:t.has("over_90")?"Generating...":"Disconnection Notice"})})]})]})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Accounts by Category"})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Category"}),e.jsx(se,{children:"Total Balance"}),e.jsx(se,{children:"Account Count"}),e.jsx(se,{children:"Avg Balance"})]})}),e.jsx(lr,{children:Object.entries(g).length===0?e.jsx(Qe,{children:e.jsx(J,{colSpan:4,className:"text-center text-muted-foreground",children:"No data available"})}):Object.entries(g).map(([C,D])=>{var L;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium capitalize",children:C}),e.jsxs(J,{children:["KES ",((L=D.total_balance)==null?void 0:L.toLocaleString())||0]}),e.jsx(J,{children:D.count||0}),e.jsxs(J,{children:["KES"," ",D.count?((D.total_balance||0)/D.count).toLocaleString():0]})]},C)})})]})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Disconnection List (Over 90 Days)"})}),e.jsx(X,{children:c?e.jsx("p",{className:"text-muted-foreground",children:"Loading disconnection list..."}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Account No"}),e.jsx(se,{children:"Customer"}),e.jsx(se,{children:"Balance"}),e.jsx(se,{children:"Days Overdue"}),e.jsx(se,{children:"Last Payment"})]})}),e.jsx(lr,{children:(o==null?void 0:o.length)===0?e.jsx(Qe,{children:e.jsx(J,{colSpan:5,className:"text-center text-muted-foreground",children:"No accounts for disconnection"})}):o==null?void 0:o.map(C=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:C.account_no}),e.jsx(J,{children:C.customer_name}),e.jsxs(J,{className:"text-red-600 font-bold",children:["KES ",C.balance.toLocaleString()]}),e.jsx(J,{children:C.days_overdue}),e.jsx(J,{children:C.last_payment_date?new Date(C.last_payment_date).toLocaleDateString():"Never"})]},C.account_no))})]})})]})]})]})}function Pze(){const[t,r]=A.useState(null),[s,n]=A.useState(null),[a,o]=A.useState(null),c=A.useRef(null),i=A.useRef(null),f=gt({mutationFn:T=>jn.importBilling(T),onSuccess:T=>{o(T),Me.success("Billing import completed"),r(null),c.current&&(c.current.value="")},onError:T=>{Me.error(`Billing import failed: ${T.message}`),o({error:T.message})}}),p=gt({mutationFn:T=>jn.importMpesa(T),onSuccess:T=>{o(T),Me.success("M-Pesa import completed"),n(null),i.current&&(i.current.value="")},onError:T=>{Me.error(`M-Pesa import failed: ${T.message}`),o({error:T.message})}}),g=T=>{r(T),o(null)},y=T=>{n(T),o(null)},b=()=>{t&&f.mutate(t)},w=()=>{s&&p.mutate(s)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Import Center"}),e.jsx("p",{className:"text-muted-foreground",children:"Bulk import billing invoices and M-Pesa payment transactions"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"h-5 w-5"}),"Billing Invoices"]}),e.jsx(mr,{children:"Upload CSV file containing billing invoices with consumption and charges"})]}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center",children:[e.jsx(Bo,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("input",{ref:c,type:"file",accept:".csv",onChange:T=>{var N;return g(((N=T.target.files)==null?void 0:N[0])||null)},className:"hidden",id:"billing-upload"}),e.jsx("label",{htmlFor:"billing-upload",children:e.jsx(K,{variant:"outline",asChild:!0,children:e.jsx("span",{children:"Select Billing CSV"})})}),t&&e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:t.name})]}),t&&e.jsx(K,{onClick:b,disabled:f.isPending,className:"w-full",children:f.isPending?e.jsxs(e.Fragment,{children:[e.jsx(as,{className:"mr-2 h-4 w-4 animate-spin"}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Bo,{className:"mr-2 h-4 w-4"}),"Import Billing Data"]})}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsx("p",{className:"font-medium",children:"Expected CSV Format:"}),e.jsx("code",{className:"block bg-muted p-2 rounded",children:"account_no,period_start,period_end,consumption,total_amount"})]})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"h-5 w-5 text-green-600"}),"M-Pesa Transactions"]}),e.jsx(mr,{children:"Upload CSV file containing M-Pesa payment transactions"})]}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center",children:[e.jsx(Bo,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("input",{ref:i,type:"file",accept:".csv",onChange:T=>{var N;return y(((N=T.target.files)==null?void 0:N[0])||null)},className:"hidden",id:"mpesa-upload"}),e.jsx("label",{htmlFor:"mpesa-upload",children:e.jsx(K,{variant:"outline",asChild:!0,children:e.jsx("span",{children:"Select M-Pesa CSV"})})}),s&&e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:s.name})]}),s&&e.jsx(K,{onClick:w,disabled:p.isPending,className:"w-full",children:p.isPending?e.jsxs(e.Fragment,{children:[e.jsx(as,{className:"mr-2 h-4 w-4 animate-spin"}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Bo,{className:"mr-2 h-4 w-4"}),"Import M-Pesa Payments"]})}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsx("p",{className:"font-medium",children:"Expected CSV Format:"}),e.jsx("code",{className:"block bg-muted p-2 rounded",children:"transaction_id,phone,amount,paid_at,account_no"})]})]})]})]}),a&&e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"flex items-center gap-2",children:a.error?e.jsxs(e.Fragment,{children:[e.jsx(ec,{className:"h-5 w-5 text-red-600"}),"Import Failed"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ns,{className:"h-5 w-5 text-green-600"}),"Import Results"]})})}),e.jsx(X,{children:a.error?e.jsx("p",{className:"text-red-600",children:a.error}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Total Records:"}),e.jsx("span",{className:"text-sm",children:a.total||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-green-600",children:"Successful:"}),e.jsx("span",{className:"text-sm text-green-600",children:a.success||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-red-600",children:"Failed:"}),e.jsx("span",{className:"text-sm text-red-600",children:a.failed||0})]}),(a.duplicates??0)>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-orange-600",children:"Duplicates Skipped:"}),e.jsx("span",{className:"text-sm text-orange-600",children:a.duplicates})]}),a.errors&&a.errors.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Errors:"}),e.jsxs("ul",{className:"text-xs text-red-600 space-y-1 max-h-40 overflow-auto",children:[a.errors.slice(0,10).map((T,N)=>e.jsxs("li",{children:[" ",T]},N)),a.errors.length>10&&e.jsxs("li",{children:["... and ",a.errors.length-10," more"]})]})]})]})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Import Guidelines"})}),e.jsxs(X,{className:"text-sm space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium mb-1",children:"Billing Invoices:"}),e.jsxs("ul",{className:"list-disc list-inside text-muted-foreground space-y-1",children:[e.jsx("li",{children:"CSV format with headers: account_no, period_start, period_end, consumption, total_amount"}),e.jsx("li",{children:"Dates in YYYY-MM-DD format"}),e.jsx("li",{children:"Consumption in cubic meters (m)"}),e.jsx("li",{children:"Amount in KES (no currency symbols)"}),e.jsx("li",{children:"Duplicate invoices for same period will be skipped"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium mb-1",children:"M-Pesa Payments:"}),e.jsxs("ul",{className:"list-disc list-inside text-muted-foreground space-y-1",children:[e.jsx("li",{children:"CSV format with headers: transaction_id, phone, amount, paid_at, account_no"}),e.jsx("li",{children:"Transaction ID must be unique (duplicates skipped)"}),e.jsx("li",{children:"Phone number in format 254XXXXXXXXX"}),e.jsx("li",{children:"Date in YYYY-MM-DD HH:MM:SS format"}),e.jsx("li",{children:"Account number must exist in the system"})]})]})]})]})]})}const ea="/hydromet",Yo={getSources:t=>{const r={};return t!=null&&t.scheme_id&&(r.scheme_id=t.scheme_id),t!=null&&t.kind_id&&(r.kind_id=t.kind_id.toString()),t!=null&&t.status_id&&(r.status_id=t.status_id.toString()),t!=null&&t.search&&(r.search=t.search),t!=null&&t.per_page&&(r.per_page=t.per_page.toString()),pe.get(`${ea}/sources`,r)},getSource:t=>pe.get(`${ea}/sources/${t}`),createSource:t=>pe.post(`${ea}/sources`,t),updateSource:(t,r)=>pe.put(`${ea}/sources/${t}`,r),deleteSource:t=>pe.delete(`${ea}/sources/${t}`),bulkImportSources:t=>pe.post(`${ea}/sources/bulk-import`,{sources:t}),getSourcesNearby:t=>{const r={lat:t.lat.toString(),lon:t.lon.toString()};return t.radius&&(r.radius=t.radius.toString()),pe.get(`${ea}/sources/nearby`,r)},getSourcesInBounds:t=>{const r={min_lat:t.min_lat.toString(),min_lon:t.min_lon.toString(),max_lat:t.max_lat.toString(),max_lon:t.max_lon.toString()};return pe.get(`${ea}/sources/in-bounds`,r)},logAbstraction:(t,r)=>pe.post(`${ea}/sources/${t}/abstraction`,r),getAbstractionHistory:(t,r,s)=>{const n={};return r&&(n.start_date=r),s&&(n.end_date=s),pe.get(`${ea}/sources/${t}/abstraction/history`,n)},getTotalAbstraction:(t,r,s)=>{const n={};return r&&(n.start_date=r),s&&(n.end_date=s),pe.get(`${ea}/sources/${t}/abstraction/total`,n)},getStations:t=>{const r={};return t!=null&&t.scheme_id&&(r.scheme_id=t.scheme_id),t!=null&&t.station_type_id&&(r.station_type_id=t.station_type_id.toString()),(t==null?void 0:t.active)!==void 0&&(r.active=t.active.toString()),t!=null&&t.search&&(r.search=t.search),t!=null&&t.per_page&&(r.per_page=t.per_page.toString()),pe.get(`${ea}/stations`,r)},getStation:t=>pe.get(`${ea}/stations/${t}`),createStation:t=>pe.post(`${ea}/stations`,t),updateStation:(t,r)=>pe.put(`${ea}/stations/${t}`,r),deleteStation:t=>pe.delete(`${ea}/stations/${t}`),getStationsNearby:t=>{const r={lat:t.lat.toString(),lon:t.lon.toString()};return t.radius&&(r.radius=t.radius.toString()),pe.get(`${ea}/stations/nearby`,r)},getStationsInBounds:t=>{const r={min_lat:t.min_lat.toString(),min_lon:t.min_lon.toString(),max_lat:t.max_lat.toString(),max_lon:t.max_lon.toString()};return pe.get(`${ea}/stations/in-bounds`,r)},activateStation:t=>pe.post(`${ea}/stations/${t}/activate`,{}),deactivateStation:t=>pe.post(`${ea}/stations/${t}/deactivate`,{}),getSensors:(t,r)=>{const s={};return r!==void 0&&(s.active=r.toString()),pe.get(`${ea}/stations/${t}/sensors`,s)},createSensor:(t,r)=>pe.post(`${ea}/stations/${t}/sensors`,r),updateSensor:(t,r,s)=>pe.put(`${ea}/stations/${t}/sensors/${r}`,s),deleteSensor:(t,r)=>pe.delete(`${ea}/stations/${t}/sensors/${r}`)},kze=(t,r)=>it({queryKey:["hydromet","sources",t],queryFn:()=>Yo.getSources(t),...r}),Aze=()=>{const t=yr();return gt({mutationFn:r=>Yo.createSource(r),onSuccess:()=>{t.invalidateQueries({queryKey:["hydromet","sources"]})}})},Tze=()=>{const t=yr();return gt({mutationFn:({id:r,data:s})=>Yo.updateSource(r,s),onSuccess:(r,s)=>{t.invalidateQueries({queryKey:["hydromet","sources"]}),t.invalidateQueries({queryKey:["hydromet","sources",s.id]})}})},Eze=()=>{const t=yr();return gt({mutationFn:r=>Yo.deleteSource(r),onSuccess:()=>{t.invalidateQueries({queryKey:["hydromet","sources"]})}})},Mze=(t,r)=>it({queryKey:["hydromet","stations",t],queryFn:()=>Yo.getStations(t),...r}),Oze=()=>{const t=yr();return gt({mutationFn:r=>Yo.createStation(r),onSuccess:()=>{t.invalidateQueries({queryKey:["hydromet","stations"]})}})},Ize=()=>{const t=yr();return gt({mutationFn:({id:r,data:s})=>Yo.updateStation(r,s),onSuccess:(r,s)=>{t.invalidateQueries({queryKey:["hydromet","stations"]}),t.invalidateQueries({queryKey:["hydromet","stations",s.id]})}})},Dze=()=>{const t=yr();return gt({mutationFn:r=>Yo.deleteStation(r),onSuccess:()=>{t.invalidateQueries({queryKey:["hydromet","stations"]})}})},Rze=()=>{const t=yr();return gt({mutationFn:r=>Yo.activateStation(r),onSuccess:(r,s)=>{t.invalidateQueries({queryKey:["hydromet","stations"]}),t.invalidateQueries({queryKey:["hydromet","stations",s]})}})},Lze=()=>{const t=yr();return gt({mutationFn:r=>Yo.deactivateStation(r),onSuccess:(r,s)=>{t.invalidateQueries({queryKey:["hydromet","stations"]}),t.invalidateQueries({queryKey:["hydromet","stations",s]})}})},Fze=(t,r,s)=>it({queryKey:["hydromet","stations",t,"sensors",r],queryFn:()=>Yo.getSensors(t,r),enabled:t!=null,...s}),$ze=()=>{const t=yr();return gt({mutationFn:({stationId:r,data:s})=>Yo.createSensor(r,s),onSuccess:(r,s)=>{t.invalidateQueries({queryKey:["hydromet","stations",s.stationId,"sensors"]}),t.invalidateQueries({queryKey:["hydromet","stations",s.stationId]})}})},zze=()=>{const t=yr();return gt({mutationFn:({stationId:r,sensorId:s})=>Yo.deleteSensor(r,s),onSuccess:(r,s)=>{t.invalidateQueries({queryKey:["hydromet","stations",s.stationId,"sensors"]}),t.invalidateQueries({queryKey:["hydromet","stations",s.stationId]})}})};var hO=["Enter"," "],Bze=["ArrowDown","PageUp","Home"],zX=["ArrowUp","PageDown","End"],qze=[...Bze,...zX],Vze={ltr:[...hO,"ArrowRight"],rtl:[...hO,"ArrowLeft"]},Uze={ltr:["ArrowLeft"],rtl:["ArrowRight"]},nw="Menu",[p_,Wze,Gze]=_C(nw),[Wp,BX]=tc(nw,[Gze,mv,ZC]),$P=mv(),qX=ZC(),[Kze,Gp]=Wp(nw),[Hze,aw]=Wp(nw),VX=t=>{const{__scopeMenu:r,open:s=!1,children:n,dir:a,onOpenChange:o,modal:c=!0}=t,i=$P(r),[f,p]=A.useState(null),g=A.useRef(!1),y=oi(o),b=dv(a);return A.useEffect(()=>{const w=()=>{g.current=!0,document.addEventListener("pointerdown",T,{capture:!0,once:!0}),document.addEventListener("pointermove",T,{capture:!0,once:!0})},T=()=>g.current=!1;return document.addEventListener("keydown",w,{capture:!0}),()=>{document.removeEventListener("keydown",w,{capture:!0}),document.removeEventListener("pointerdown",T,{capture:!0}),document.removeEventListener("pointermove",T,{capture:!0})}},[]),e.jsx(TI,{...i,children:e.jsx(Kze,{scope:r,open:s,onOpenChange:y,content:f,onContentChange:p,children:e.jsx(Hze,{scope:r,onClose:A.useCallback(()=>y(!1),[y]),isUsingKeyboardRef:g,dir:b,modal:c,children:n})})})};VX.displayName=nw;var Zze="MenuAnchor",vR=A.forwardRef((t,r)=>{const{__scopeMenu:s,...n}=t,a=$P(s);return e.jsx(kC,{...a,...n,ref:r})});vR.displayName=Zze;var jR="MenuPortal",[Yze,UX]=Wp(jR,{forceMount:void 0}),WX=t=>{const{__scopeMenu:r,forceMount:s,children:n,container:a}=t,o=Gp(jR,r);return e.jsx(Yze,{scope:r,forceMount:s,children:e.jsx(Yi,{present:s||o.open,children:e.jsx(M_,{asChild:!0,container:a,children:n})})})};WX.displayName=jR;var Gl="MenuContent",[Xze,bR]=Wp(Gl),GX=A.forwardRef((t,r)=>{const s=UX(Gl,t.__scopeMenu),{forceMount:n=s.forceMount,...a}=t,o=Gp(Gl,t.__scopeMenu),c=aw(Gl,t.__scopeMenu);return e.jsx(p_.Provider,{scope:t.__scopeMenu,children:e.jsx(Yi,{present:n||o.open,children:e.jsx(p_.Slot,{scope:t.__scopeMenu,children:c.modal?e.jsx(Qze,{...a,ref:r}):e.jsx(Jze,{...a,ref:r})})})})}),Qze=A.forwardRef((t,r)=>{const s=Gp(Gl,t.__scopeMenu),n=A.useRef(null),a=ls(r,n);return A.useEffect(()=>{const o=n.current;if(o)return TC(o)},[]),e.jsx(_R,{...t,ref:a,trapFocus:s.open,disableOutsidePointerEvents:s.open,disableOutsideScroll:!0,onFocusOutside:gr(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>s.onOpenChange(!1)})}),Jze=A.forwardRef((t,r)=>{const s=Gp(Gl,t.__scopeMenu);return e.jsx(_R,{...t,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>s.onOpenChange(!1)})}),_R=A.forwardRef((t,r)=>{const{__scopeMenu:s,loop:n=!1,trapFocus:a,onOpenAutoFocus:o,onCloseAutoFocus:c,disableOutsidePointerEvents:i,onEntryFocus:f,onEscapeKeyDown:p,onPointerDownOutside:g,onFocusOutside:y,onInteractOutside:b,onDismiss:w,disableOutsideScroll:T,...N}=t,M=Gp(Gl,s),O=aw(Gl,s),C=$P(s),D=qX(s),L=Wze(s),[F,B]=A.useState(null),U=A.useRef(null),te=ls(r,U,M.onContentChange),Q=A.useRef(0),re=A.useRef(""),Z=A.useRef(0),ne=A.useRef(null),oe=A.useRef("right"),Ce=A.useRef(0),Pe=T?O_:A.Fragment,Se=T?{as:Ad,allowPinchZoom:!0}:void 0,ae=de=>{var Ct,ur;const Ke=re.current+de,He=L().filter(At=>!At.disabled),Ve=document.activeElement,yt=(Ct=He.find(At=>At.ref.current===Ve))==null?void 0:Ct.textValue,Et=He.map(At=>At.textValue),Rt=u6e(Et,Ke,yt),Vt=(ur=He.find(At=>At.textValue===Rt))==null?void 0:ur.ref.current;(function At(Ht){re.current=Ht,window.clearTimeout(Q.current),Ht!==""&&(Q.current=window.setTimeout(()=>At(""),1e3))})(Ke),Vt&&setTimeout(()=>Vt.focus())};A.useEffect(()=>()=>window.clearTimeout(Q.current),[]),wC();const be=A.useCallback(de=>{var He,Ve;return oe.current===((He=ne.current)==null?void 0:He.side)&&m6e(de,(Ve=ne.current)==null?void 0:Ve.area)},[]);return e.jsx(Xze,{scope:s,searchRef:re,onItemEnter:A.useCallback(de=>{be(de)&&de.preventDefault()},[be]),onItemLeave:A.useCallback(de=>{var Ke;be(de)||((Ke=U.current)==null||Ke.focus(),B(null))},[be]),onTriggerLeave:A.useCallback(de=>{be(de)&&de.preventDefault()},[be]),pointerGraceTimerRef:Z,onPointerGraceIntentChange:A.useCallback(de=>{ne.current=de},[]),children:e.jsx(Pe,{...Se,children:e.jsx(T_,{asChild:!0,trapped:a,onMountAutoFocus:gr(o,de=>{var Ke;de.preventDefault(),(Ke=U.current)==null||Ke.focus({preventScroll:!0})}),onUnmountAutoFocus:c,children:e.jsx(A_,{asChild:!0,disableOutsidePointerEvents:i,onEscapeKeyDown:p,onPointerDownOutside:g,onFocusOutside:y,onInteractOutside:b,onDismiss:w,children:e.jsx(bK,{asChild:!0,...D,dir:O.dir,orientation:"vertical",loop:n,currentTabStopId:F,onCurrentTabStopIdChange:B,onEntryFocus:gr(f,de=>{O.isUsingKeyboardRef.current||de.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(EI,{role:"menu","aria-orientation":"vertical","data-state":lQ(M.open),"data-radix-menu-content":"",dir:O.dir,...C,...N,ref:te,style:{outline:"none",...N.style},onKeyDown:gr(N.onKeyDown,de=>{const He=de.target.closest("[data-radix-menu-content]")===de.currentTarget,Ve=de.ctrlKey||de.altKey||de.metaKey,yt=de.key.length===1;He&&(de.key==="Tab"&&de.preventDefault(),!Ve&&yt&&ae(de.key));const Et=U.current;if(de.target!==Et||!qze.includes(de.key))return;de.preventDefault();const Vt=L().filter(Ct=>!Ct.disabled).map(Ct=>Ct.ref.current);zX.includes(de.key)&&Vt.reverse(),c6e(Vt)}),onBlur:gr(t.onBlur,de=>{de.currentTarget.contains(de.target)||(window.clearTimeout(Q.current),re.current="")}),onPointerMove:gr(t.onPointerMove,x_(de=>{const Ke=de.target,He=Ce.current!==de.clientX;if(de.currentTarget.contains(Ke)&&He){const Ve=de.clientX>Ce.current?"right":"left";oe.current=Ve,Ce.current=de.clientX}}))})})})})})})});GX.displayName=Gl;var e6e="MenuGroup",wR=A.forwardRef((t,r)=>{const{__scopeMenu:s,...n}=t;return e.jsx(Tr.div,{role:"group",...n,ref:r})});wR.displayName=e6e;var t6e="MenuLabel",KX=A.forwardRef((t,r)=>{const{__scopeMenu:s,...n}=t;return e.jsx(Tr.div,{...n,ref:r})});KX.displayName=t6e;var Y2="MenuItem",E8="menu.itemSelect",zP=A.forwardRef((t,r)=>{const{disabled:s=!1,onSelect:n,...a}=t,o=A.useRef(null),c=aw(Y2,t.__scopeMenu),i=bR(Y2,t.__scopeMenu),f=ls(r,o),p=A.useRef(!1),g=()=>{const y=o.current;if(!s&&y){const b=new CustomEvent(E8,{bubbles:!0,cancelable:!0});y.addEventListener(E8,w=>n==null?void 0:n(w),{once:!0}),JU(y,b),b.defaultPrevented?p.current=!1:c.onClose()}};return e.jsx(HX,{...a,ref:f,disabled:s,onClick:gr(t.onClick,g),onPointerDown:y=>{var b;(b=t.onPointerDown)==null||b.call(t,y),p.current=!0},onPointerUp:gr(t.onPointerUp,y=>{var b;p.current||(b=y.currentTarget)==null||b.click()}),onKeyDown:gr(t.onKeyDown,y=>{const b=i.searchRef.current!=="";s||b&&y.key===" "||hO.includes(y.key)&&(y.currentTarget.click(),y.preventDefault())})})});zP.displayName=Y2;var HX=A.forwardRef((t,r)=>{const{__scopeMenu:s,disabled:n=!1,textValue:a,...o}=t,c=bR(Y2,s),i=qX(s),f=A.useRef(null),p=ls(r,f),[g,y]=A.useState(!1),[b,w]=A.useState("");return A.useEffect(()=>{const T=f.current;T&&w((T.textContent??"").trim())},[o.children]),e.jsx(p_.ItemSlot,{scope:s,disabled:n,textValue:a??b,children:e.jsx(_K,{asChild:!0,...i,focusable:!n,children:e.jsx(Tr.div,{role:"menuitem","data-highlighted":g?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...o,ref:p,onPointerMove:gr(t.onPointerMove,x_(T=>{n?c.onItemLeave(T):(c.onItemEnter(T),T.defaultPrevented||T.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:gr(t.onPointerLeave,x_(T=>c.onItemLeave(T))),onFocus:gr(t.onFocus,()=>y(!0)),onBlur:gr(t.onBlur,()=>y(!1))})})})}),r6e="MenuCheckboxItem",ZX=A.forwardRef((t,r)=>{const{checked:s=!1,onCheckedChange:n,...a}=t;return e.jsx(eQ,{scope:t.__scopeMenu,checked:s,children:e.jsx(zP,{role:"menuitemcheckbox","aria-checked":X2(s)?"mixed":s,...a,ref:r,"data-state":SR(s),onSelect:gr(a.onSelect,()=>n==null?void 0:n(X2(s)?!0:!s),{checkForDefaultPrevented:!1})})})});ZX.displayName=r6e;var YX="MenuRadioGroup",[s6e,n6e]=Wp(YX,{value:void 0,onValueChange:()=>{}}),XX=A.forwardRef((t,r)=>{const{value:s,onValueChange:n,...a}=t,o=oi(n);return e.jsx(s6e,{scope:t.__scopeMenu,value:s,onValueChange:o,children:e.jsx(wR,{...a,ref:r})})});XX.displayName=YX;var QX="MenuRadioItem",JX=A.forwardRef((t,r)=>{const{value:s,...n}=t,a=n6e(QX,t.__scopeMenu),o=s===a.value;return e.jsx(eQ,{scope:t.__scopeMenu,checked:o,children:e.jsx(zP,{role:"menuitemradio","aria-checked":o,...n,ref:r,"data-state":SR(o),onSelect:gr(n.onSelect,()=>{var c;return(c=a.onValueChange)==null?void 0:c.call(a,s)},{checkForDefaultPrevented:!1})})})});JX.displayName=QX;var NR="MenuItemIndicator",[eQ,a6e]=Wp(NR,{checked:!1}),tQ=A.forwardRef((t,r)=>{const{__scopeMenu:s,forceMount:n,...a}=t,o=a6e(NR,s);return e.jsx(Yi,{present:n||X2(o.checked)||o.checked===!0,children:e.jsx(Tr.span,{...a,ref:r,"data-state":SR(o.checked)})})});tQ.displayName=NR;var i6e="MenuSeparator",rQ=A.forwardRef((t,r)=>{const{__scopeMenu:s,...n}=t;return e.jsx(Tr.div,{role:"separator","aria-orientation":"horizontal",...n,ref:r})});rQ.displayName=i6e;var o6e="MenuArrow",sQ=A.forwardRef((t,r)=>{const{__scopeMenu:s,...n}=t,a=$P(s);return e.jsx(MI,{...a,...n,ref:r})});sQ.displayName=o6e;var l6e="MenuSub",[GVe,nQ]=Wp(l6e),I0="MenuSubTrigger",aQ=A.forwardRef((t,r)=>{const s=Gp(I0,t.__scopeMenu),n=aw(I0,t.__scopeMenu),a=nQ(I0,t.__scopeMenu),o=bR(I0,t.__scopeMenu),c=A.useRef(null),{pointerGraceTimerRef:i,onPointerGraceIntentChange:f}=o,p={__scopeMenu:t.__scopeMenu},g=A.useCallback(()=>{c.current&&window.clearTimeout(c.current),c.current=null},[]);return A.useEffect(()=>g,[g]),A.useEffect(()=>{const y=i.current;return()=>{window.clearTimeout(y),f(null)}},[i,f]),e.jsx(vR,{asChild:!0,...p,children:e.jsx(HX,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":a.contentId,"data-state":lQ(s.open),...t,ref:yC(r,a.onTriggerChange),onClick:y=>{var b;(b=t.onClick)==null||b.call(t,y),!(t.disabled||y.defaultPrevented)&&(y.currentTarget.focus(),s.open||s.onOpenChange(!0))},onPointerMove:gr(t.onPointerMove,x_(y=>{o.onItemEnter(y),!y.defaultPrevented&&!t.disabled&&!s.open&&!c.current&&(o.onPointerGraceIntentChange(null),c.current=window.setTimeout(()=>{s.onOpenChange(!0),g()},100))})),onPointerLeave:gr(t.onPointerLeave,x_(y=>{var w,T;g();const b=(w=s.content)==null?void 0:w.getBoundingClientRect();if(b){const N=(T=s.content)==null?void 0:T.dataset.side,M=N==="right",O=M?-5:5,C=b[M?"left":"right"],D=b[M?"right":"left"];o.onPointerGraceIntentChange({area:[{x:y.clientX+O,y:y.clientY},{x:C,y:b.top},{x:D,y:b.top},{x:D,y:b.bottom},{x:C,y:b.bottom}],side:N}),window.clearTimeout(i.current),i.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(y),y.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:gr(t.onKeyDown,y=>{var w;const b=o.searchRef.current!=="";t.disabled||b&&y.key===" "||Vze[n.dir].includes(y.key)&&(s.onOpenChange(!0),(w=s.content)==null||w.focus(),y.preventDefault())})})})});aQ.displayName=I0;var iQ="MenuSubContent",oQ=A.forwardRef((t,r)=>{const s=UX(Gl,t.__scopeMenu),{forceMount:n=s.forceMount,...a}=t,o=Gp(Gl,t.__scopeMenu),c=aw(Gl,t.__scopeMenu),i=nQ(iQ,t.__scopeMenu),f=A.useRef(null),p=ls(r,f);return e.jsx(p_.Provider,{scope:t.__scopeMenu,children:e.jsx(Yi,{present:n||o.open,children:e.jsx(p_.Slot,{scope:t.__scopeMenu,children:e.jsx(_R,{id:i.contentId,"aria-labelledby":i.triggerId,...a,ref:p,align:"start",side:c.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:g=>{var y;c.isUsingKeyboardRef.current&&((y=f.current)==null||y.focus()),g.preventDefault()},onCloseAutoFocus:g=>g.preventDefault(),onFocusOutside:gr(t.onFocusOutside,g=>{g.target!==i.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:gr(t.onEscapeKeyDown,g=>{c.onClose(),g.preventDefault()}),onKeyDown:gr(t.onKeyDown,g=>{var w;const y=g.currentTarget.contains(g.target),b=Uze[c.dir].includes(g.key);y&&b&&(o.onOpenChange(!1),(w=i.trigger)==null||w.focus(),g.preventDefault())})})})})})});oQ.displayName=iQ;function lQ(t){return t?"open":"closed"}function X2(t){return t==="indeterminate"}function SR(t){return X2(t)?"indeterminate":t?"checked":"unchecked"}function c6e(t){const r=document.activeElement;for(const s of t)if(s===r||(s.focus(),document.activeElement!==r))return}function d6e(t,r){return t.map((s,n)=>t[(r+n)%t.length])}function u6e(t,r,s){const a=r.length>1&&Array.from(r).every(p=>p===r[0])?r[0]:r,o=s?t.indexOf(s):-1;let c=d6e(t,Math.max(o,0));a.length===1&&(c=c.filter(p=>p!==s));const f=c.find(p=>p.toLowerCase().startsWith(a.toLowerCase()));return f!==s?f:void 0}function h6e(t,r){const{x:s,y:n}=t;let a=!1;for(let o=0,c=r.length-1;o<r.length;c=o++){const i=r[o].x,f=r[o].y,p=r[c].x,g=r[c].y;f>n!=g>n&&s<(p-i)*(n-f)/(g-f)+i&&(a=!a)}return a}function m6e(t,r){if(!r)return!1;const s={x:t.clientX,y:t.clientY};return h6e(s,r)}function x_(t){return r=>r.pointerType==="mouse"?t(r):void 0}var f6e=VX,p6e=vR,x6e=WX,g6e=GX,y6e=wR,v6e=KX,j6e=zP,b6e=ZX,_6e=XX,w6e=JX,N6e=tQ,S6e=rQ,C6e=sQ,P6e=aQ,k6e=oQ,CR="DropdownMenu",[A6e]=tc(CR,[BX]),Ao=BX(),[T6e,cQ]=A6e(CR),dQ=t=>{const{__scopeDropdownMenu:r,children:s,dir:n,open:a,defaultOpen:o,onOpenChange:c,modal:i=!0}=t,f=Ao(r),p=A.useRef(null),[g=!1,y]=Yc({prop:a,defaultProp:o,onChange:c});return e.jsx(T6e,{scope:r,triggerId:Pi(),triggerRef:p,contentId:Pi(),open:g,onOpenChange:y,onOpenToggle:A.useCallback(()=>y(b=>!b),[y]),modal:i,children:e.jsx(f6e,{...f,open:g,onOpenChange:y,dir:n,modal:i,children:s})})};dQ.displayName=CR;var uQ="DropdownMenuTrigger",hQ=A.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,disabled:n=!1,...a}=t,o=cQ(uQ,s),c=Ao(s);return e.jsx(p6e,{asChild:!0,...c,children:e.jsx(Tr.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...a,ref:yC(r,o.triggerRef),onPointerDown:gr(t.onPointerDown,i=>{!n&&i.button===0&&i.ctrlKey===!1&&(o.onOpenToggle(),o.open||i.preventDefault())}),onKeyDown:gr(t.onKeyDown,i=>{n||(["Enter"," "].includes(i.key)&&o.onOpenToggle(),i.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(i.key)&&i.preventDefault())})})})});hQ.displayName=uQ;var E6e="DropdownMenuPortal",mQ=t=>{const{__scopeDropdownMenu:r,...s}=t,n=Ao(r);return e.jsx(x6e,{...n,...s})};mQ.displayName=E6e;var fQ="DropdownMenuContent",pQ=A.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=cQ(fQ,s),o=Ao(s),c=A.useRef(!1);return e.jsx(g6e,{id:a.contentId,"aria-labelledby":a.triggerId,...o,...n,ref:r,onCloseAutoFocus:gr(t.onCloseAutoFocus,i=>{var f;c.current||(f=a.triggerRef.current)==null||f.focus(),c.current=!1,i.preventDefault()}),onInteractOutside:gr(t.onInteractOutside,i=>{const f=i.detail.originalEvent,p=f.button===0&&f.ctrlKey===!0,g=f.button===2||p;(!a.modal||g)&&(c.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});pQ.displayName=fQ;var M6e="DropdownMenuGroup",O6e=A.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Ao(s);return e.jsx(y6e,{...a,...n,ref:r})});O6e.displayName=M6e;var I6e="DropdownMenuLabel",xQ=A.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Ao(s);return e.jsx(v6e,{...a,...n,ref:r})});xQ.displayName=I6e;var D6e="DropdownMenuItem",gQ=A.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Ao(s);return e.jsx(j6e,{...a,...n,ref:r})});gQ.displayName=D6e;var R6e="DropdownMenuCheckboxItem",yQ=A.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Ao(s);return e.jsx(b6e,{...a,...n,ref:r})});yQ.displayName=R6e;var L6e="DropdownMenuRadioGroup",F6e=A.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Ao(s);return e.jsx(_6e,{...a,...n,ref:r})});F6e.displayName=L6e;var $6e="DropdownMenuRadioItem",vQ=A.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Ao(s);return e.jsx(w6e,{...a,...n,ref:r})});vQ.displayName=$6e;var z6e="DropdownMenuItemIndicator",jQ=A.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Ao(s);return e.jsx(N6e,{...a,...n,ref:r})});jQ.displayName=z6e;var B6e="DropdownMenuSeparator",bQ=A.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Ao(s);return e.jsx(S6e,{...a,...n,ref:r})});bQ.displayName=B6e;var q6e="DropdownMenuArrow",V6e=A.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Ao(s);return e.jsx(C6e,{...a,...n,ref:r})});V6e.displayName=q6e;var U6e="DropdownMenuSubTrigger",_Q=A.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Ao(s);return e.jsx(P6e,{...a,...n,ref:r})});_Q.displayName=U6e;var W6e="DropdownMenuSubContent",wQ=A.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Ao(s);return e.jsx(k6e,{...a,...n,ref:r,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});wQ.displayName=W6e;var G6e=dQ,K6e=hQ,H6e=mQ,NQ=pQ,SQ=xQ,CQ=gQ,PQ=yQ,kQ=vQ,AQ=jQ,TQ=bQ,EQ=_Q,MQ=wQ;const OQ=G6e,IQ=K6e,Z6e=A.forwardRef(({className:t,inset:r,children:s,...n},a)=>e.jsxs(EQ,{ref:a,className:dr("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",t),...n,children:[s,e.jsx($u,{className:"ml-auto"})]}));Z6e.displayName=EQ.displayName;const Y6e=A.forwardRef(({className:t,...r},s)=>e.jsx(MQ,{ref:s,className:dr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r}));Y6e.displayName=MQ.displayName;const PR=A.forwardRef(({className:t,sideOffset:r=4,...s},n)=>e.jsx(H6e,{children:e.jsx(NQ,{ref:n,sideOffset:r,className:dr("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}));PR.displayName=NQ.displayName;const Uh=A.forwardRef(({className:t,inset:r,...s},n)=>e.jsx(CQ,{ref:n,className:dr("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",r&&"pl-8",t),...s}));Uh.displayName=CQ.displayName;const X6e=A.forwardRef(({className:t,children:r,checked:s,...n},a)=>e.jsxs(PQ,{ref:a,className:dr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:s,...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(AQ,{children:e.jsx(Kc,{className:"h-4 w-4"})})}),r]}));X6e.displayName=PQ.displayName;const Q6e=A.forwardRef(({className:t,children:r,...s},n)=>e.jsxs(kQ,{ref:n,className:dr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(AQ,{children:e.jsx(YE,{className:"h-2 w-2 fill-current"})})}),r]}));Q6e.displayName=kQ.displayName;const J6e=A.forwardRef(({className:t,inset:r,...s},n)=>e.jsx(SQ,{ref:n,className:dr("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",t),...s}));J6e.displayName=SQ.displayName;const eBe=A.forwardRef(({className:t,...r},s)=>e.jsx(TQ,{ref:s,className:dr("-mx-1 my-1 h-px bg-muted",t),...r}));eBe.displayName=TQ.displayName;function DQ({latitude:t,longitude:r,onLocationChange:s}){const[n,a]=A.useState({longitude:r!==void 0?r:36.8219,latitude:t!==void 0?t:-1.2921,zoom:10}),[o,c]=A.useState(t!==void 0&&r!==void 0?{lat:t,lon:r}:null),[i,f]=A.useState(t!==void 0?t.toString():""),[p,g]=A.useState(r!==void 0?r.toString():"");A.useEffect(()=>{t!==void 0&&r!==void 0&&(c({lat:t,lon:r}),a(T=>({...T,latitude:t,longitude:r})),f(t.toString()),g(r.toString()))},[t,r]);const y=A.useCallback(T=>{const{lng:N,lat:M}=T.lngLat;c({lat:M,lon:N}),f(M.toFixed(6)),g(N.toFixed(6)),s(M,N)},[s]),b=A.useCallback(()=>{const T=parseFloat(i),N=parseFloat(p);!isNaN(T)&&!isNaN(N)&&T>=-90&&T<=90&&N>=-180&&N<=180&&(c({lat:T,lon:N}),a(M=>({...M,latitude:T,longitude:N})),s(T,N))},[i,p,s]),w=A.useCallback(()=>{c(null),f(""),g(""),s(void 0,void 0)},[s]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"manual-lat",children:"Latitude"}),e.jsx(Ie,{id:"manual-lat",type:"number",step:"0.000001",value:i,onChange:T=>f(T.target.value),placeholder:"-1.286389"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"manual-lon",children:"Longitude"}),e.jsx(Ie,{id:"manual-lon",type:"number",step:"0.000001",value:p,onChange:T=>g(T.target.value),placeholder:"36.817223"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{type:"button",variant:"outline",size:"sm",onClick:b,children:"Update from Coordinates"}),e.jsx(K,{type:"button",variant:"outline",size:"sm",onClick:w,children:"Clear Location"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Click map to set location"}),e.jsx("div",{style:{height:"300px",width:"100%"},className:"rounded-lg overflow-hidden border",children:e.jsxs(Pm,{...n,onMove:T=>a(T.viewState),onClick:y,mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",style:{width:"100%",height:"100%"},cursor:"crosshair",children:[e.jsx(km,{position:"top-right"}),e.jsx(yv,{position:"bottom-left"}),o&&e.jsx(BC,{longitude:o.lon,latitude:o.lat,anchor:"bottom",children:e.jsx(fn,{className:"h-8 w-8 text-red-500",fill:"currentColor"})})]})})]})]})}function tBe({open:t,onClose:r,source:s,isCreating:n}){var g,y;const a=Aze(),o=Tze(),[c,i]=A.useState({name:"",code:"",kind_id:void 0,status_id:void 0,catchment:"",elevation_m:void 0,depth_m:void 0,capacity_m3_per_day:void 0,permit_no:"",latitude:void 0,longitude:void 0});A.useEffect(()=>{var b,w;s&&!n?i({name:s.name,code:s.code,kind_id:s.kind_id,status_id:s.status_id,catchment:s.catchment||"",elevation_m:s.elevation_m||void 0,depth_m:s.depth_m||void 0,capacity_m3_per_day:s.capacity_m3_per_day||void 0,permit_no:s.permit_no||"",latitude:(b=s.location)==null?void 0:b.coordinates[1],longitude:(w=s.location)==null?void 0:w.coordinates[0]}):n&&i({name:"",code:"",kind_id:void 0,status_id:void 0,catchment:"",elevation_m:void 0,depth_m:void 0,capacity_m3_per_day:void 0,permit_no:"",latitude:void 0,longitude:void 0})},[s,n,t]);const f=async b=>{if(b.preventDefault(),!c.name||!c.code||!c.kind_id||!c.status_id){Me.error("Please fill in all required fields");return}try{n?(await a.mutateAsync(c),Me.success("Source created successfully")):s&&(await o.mutateAsync({id:s.id,data:c}),Me.success("Source updated successfully")),r()}catch(w){Me.error(w.message||`Failed to ${n?"create":"update"} source`)}},p=a.isPending||o.isPending;return e.jsx(Qt,{open:t,onOpenChange:r,children:e.jsxs(Zt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:n?"Add New Source":"Edit Source"})}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"code",children:"Source Code *"}),e.jsx(Ie,{id:"code",value:c.code,onChange:b=>i({...c,code:b.target.value}),placeholder:"e.g., SRC-001",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"name",children:"Source Name *"}),e.jsx(Ie,{id:"name",value:c.name,onChange:b=>i({...c,name:b.target.value}),placeholder:"e.g., Kikuyu Borehole",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"kind_id",children:"Source Type *"}),e.jsxs(Nt,{value:(g=c.kind_id)==null?void 0:g.toString(),onValueChange:b=>i({...c,kind_id:parseInt(b)}),children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select type"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"1",children:"Borehole"}),e.jsx(ge,{value:"2",children:"Spring"}),e.jsx(ge,{value:"3",children:"River"}),e.jsx(ge,{value:"4",children:"Dam"}),e.jsx(ge,{value:"5",children:"Well"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"status_id",children:"Status *"}),e.jsxs(Nt,{value:(y=c.status_id)==null?void 0:y.toString(),onValueChange:b=>i({...c,status_id:parseInt(b)}),children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select status"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"1",children:"Active"}),e.jsx(ge,{value:"2",children:"Inactive"}),e.jsx(ge,{value:"3",children:"Abandoned"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"catchment",children:"Catchment Area"}),e.jsx(Ie,{id:"catchment",value:c.catchment,onChange:b=>i({...c,catchment:b.target.value}),placeholder:"e.g., Tana Basin"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"elevation_m",children:"Elevation (m)"}),e.jsx(Ie,{id:"elevation_m",type:"number",step:"0.1",value:c.elevation_m||"",onChange:b=>i({...c,elevation_m:b.target.value?parseFloat(b.target.value):void 0}),placeholder:"1500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"depth_m",children:"Depth (m)"}),e.jsx(Ie,{id:"depth_m",type:"number",step:"0.1",value:c.depth_m||"",onChange:b=>i({...c,depth_m:b.target.value?parseFloat(b.target.value):void 0}),placeholder:"120"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"capacity_m3_per_day",children:"Capacity (m/day)"}),e.jsx(Ie,{id:"capacity_m3_per_day",type:"number",step:"0.1",value:c.capacity_m3_per_day||"",onChange:b=>i({...c,capacity_m3_per_day:b.target.value?parseFloat(b.target.value):void 0}),placeholder:"500"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"permit_no",children:"Permit Number"}),e.jsx(Ie,{id:"permit_no",value:c.permit_no,onChange:b=>i({...c,permit_no:b.target.value}),placeholder:"e.g., WRUA/2023/001"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Location (PostGIS)"}),e.jsx(DQ,{latitude:c.latitude,longitude:c.longitude,onLocationChange:(b,w)=>i({...c,latitude:b,longitude:w})})]}),e.jsxs(Ps,{children:[e.jsx(K,{type:"button",variant:"outline",onClick:r,disabled:p,children:"Cancel"}),e.jsx(K,{type:"submit",disabled:p,children:p?"Saving...":n?"Create Source":"Update Source"})]})]})]})})}const rBe=`code,name,kind_id,status_id,catchment,capacity_m3_per_day,latitude,longitude
SRC001,Main Borehole,1,1,Upper Catchment,500,3.1234,36.5678
SRC002,River Intake,2,1,Lower Catchment,1000,3.2345,36.6789`;function sBe({open:t,onClose:r}){const s=yr(),n=A.useRef(null),[a,o]=A.useState(""),[c,i]=A.useState([]),[f,p]=A.useState(null),g=gt({mutationFn:M=>Yo.bulkImportSources(M),onSuccess:M=>{p({imported:M.imported,errors:M.errors}),M.imported>0&&(s.invalidateQueries({queryKey:["hydromet-sources"]}),Me.success(`Successfully imported ${M.imported} sources`)),M.errors.length>0&&Me.warning(`${M.errors.length} rows had errors`)},onError:M=>{Me.error(M.message||"Failed to import sources")}}),y=M=>{const O=M.trim().split(`
`);if(O.length<2)return{sources:[],errors:["CSV must have a header row and at least one data row"]};const C=O[0].split(",").map(F=>F.trim().toLowerCase()),D=[],L=[];for(let F=1;F<O.length;F++){const B=O[F].split(",").map(Z=>Z.trim());if(B.length!==C.length){L.push(`Row ${F+1}: Column count mismatch (expected ${C.length}, got ${B.length})`);continue}const U={};let te=!0;C.forEach((Z,ne)=>{const oe=B[ne];if(oe)switch(Z){case"code":U.code=oe;break;case"name":U.name=oe;break;case"kind_id":U.kind_id=parseInt(oe);break;case"status_id":U.status_id=parseInt(oe);break;case"catchment":U.catchment=oe;break;case"capacity_m3_per_day":U.capacity_m3_per_day=parseFloat(oe);break;case"elevation_m":U.elevation_m=parseFloat(oe);break;case"depth_m":U.depth_m=parseFloat(oe);break;case"static_level_m":U.static_level_m=parseFloat(oe);break;case"dynamic_level_m":U.dynamic_level_m=parseFloat(oe);break;case"permit_no":U.permit_no=oe;break;case"quality_risk_id":U.quality_risk_id=parseInt(oe);break}});const Q=C.indexOf("latitude"),re=C.indexOf("longitude");if(Q>=0&&re>=0&&B[Q]&&B[re]){const Z=parseFloat(B[Q]),ne=parseFloat(B[re]);!isNaN(Z)&&!isNaN(ne)&&(U.latitude=Z,U.longitude=ne)}(!U.code||!U.name||!U.kind_id||!U.status_id)&&(L.push(`Row ${F+1}: Missing required fields (code, name, kind_id, status_id)`),te=!1),te&&D.push(U)}return{sources:D,errors:L}},b=M=>{var D;const O=(D=M.target.files)==null?void 0:D[0];if(!O)return;const C=new FileReader;C.onload=L=>{var B;const F=(B=L.target)==null?void 0:B.result;o(F),i([]),p(null)},C.readAsText(O)},w=()=>{const{sources:M,errors:O}=y(a);if(i(O),M.length===0){Me.error("No valid sources to import");return}g.mutate(M)},T=()=>{const M=new Blob([rBe],{type:"text/csv"}),O=URL.createObjectURL(M),C=document.createElement("a");C.href=O,C.download="sources_import_template.csv",C.click(),URL.revokeObjectURL(O)},N=()=>{o(""),i([]),p(null),r()};return e.jsx(Qt,{open:t,onOpenChange:M=>!M&&N(),children:e.jsxs(Zt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Bulk Import Sources"}),e.jsx(Es,{children:"Upload a CSV file or paste CSV data to import multiple water sources at once."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{ref:n,type:"file",accept:".csv",onChange:b,className:"hidden"}),e.jsxs(K,{variant:"outline",onClick:()=>{var M;return(M=n.current)==null?void 0:M.click()},children:[e.jsx(Bo,{className:"mr-2 h-4 w-4"}),"Upload CSV"]}),e.jsxs(K,{variant:"outline",onClick:T,children:[e.jsx(ma,{className:"mr-2 h-4 w-4"}),"Download Template"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"CSV Data"}),e.jsx(ws,{placeholder:"Paste CSV data here or upload a file...",value:a,onChange:M=>{o(M.target.value),i([]),p(null)},rows:10,className:"font-mono text-sm"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-medium",children:"Required columns:"}),e.jsx("p",{children:"code, name, kind_id, status_id"}),e.jsx("p",{className:"font-medium mt-2",children:"Optional columns:"}),e.jsx("p",{children:"catchment, capacity_m3_per_day, latitude, longitude, elevation_m, depth_m, static_level_m, dynamic_level_m, permit_no, quality_risk_id"})]}),c.length>0&&e.jsxs(zn,{variant:"destructive",children:[e.jsx(Fr,{className:"h-4 w-4"}),e.jsxs(An,{children:[e.jsx("p",{className:"font-medium",children:"Parse Errors:"}),e.jsxs("ul",{className:"list-disc list-inside mt-1",children:[c.slice(0,5).map((M,O)=>e.jsx("li",{className:"text-sm",children:M},O)),c.length>5&&e.jsxs("li",{className:"text-sm",children:["...and ",c.length-5," more errors"]})]})]})]}),f&&e.jsxs(zn,{variant:(f.errors.length>0,"default"),children:[e.jsx(Ns,{className:"h-4 w-4"}),e.jsxs(An,{children:[e.jsx("p",{className:"font-medium",children:"Import Complete"}),e.jsxs("p",{children:["Successfully imported ",f.imported," sources"]}),f.errors.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"mt-2 font-medium text-destructive",children:[f.errors.length," errors:"]}),e.jsxs("ul",{className:"list-disc list-inside mt-1",children:[f.errors.slice(0,3).map((M,O)=>e.jsx("li",{className:"text-sm",children:M},O)),f.errors.length>3&&e.jsxs("li",{className:"text-sm",children:["...and ",f.errors.length-3," more"]})]})]})]})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:N,children:"Cancel"}),e.jsx(K,{onClick:w,disabled:!a.trim()||g.isPending,children:g.isPending?e.jsxs(e.Fragment,{children:[e.jsx(as,{className:"mr-2 h-4 w-4 animate-spin"}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(bs,{className:"mr-2 h-4 w-4"}),"Import Sources"]})})]})]})})}const nBe={turkana:{longitude:35.5,latitude:3.5,zoom:7}},mO={Active:"#22c55e",Inactive:"#94a3b8",Abandoned:"#ef4444",Unknown:"#3b82f6"};function aBe(t,r){const s=[];if(t==null||t.forEach(N=>{var M;(M=N.location)!=null&&M.coordinates&&s.push([N.location.coordinates[0],N.location.coordinates[1]])}),r==null||r.forEach(N=>{var M;(M=N.location)!=null&&M.coordinates&&s.push([N.location.coordinates[0],N.location.coordinates[1]])}),s.length===0)return nBe.turkana;if(s.length===1)return{longitude:s[0][0],latitude:s[0][1],zoom:10};const n=s.map(N=>N[0]),a=s.map(N=>N[1]),o=Math.min(...n),c=Math.max(...n),i=Math.min(...a),f=Math.max(...a),p=(o+c)/2,g=(i+f)/2,y=f-i,b=c-o,w=Math.max(y,b);let T=10;return w>2?T=6:w>1?T=7:w>.5?T=8:w>.1&&(T=9),{longitude:p,latitude:g,zoom:T}}function iBe({source:t,isSelected:r,onClick:s,onHover:n}){var f,p;const a=((f=t.kind)==null?void 0:f.name)||"Unknown",o=((p=t.status)==null?void 0:p.name)||"Unknown",c=mO[o]||mO.Unknown,i=()=>{switch(a){case"Borehole":return e.jsx("div",{className:"flex items-center justify-center transition-transform",style:{width:r?32:26,height:r?32:26,backgroundColor:c,borderRadius:"50%",border:"3px solid white",boxShadow:"0 2px 6px rgba(0,0,0,0.3)"},children:e.jsx("span",{className:"text-white text-xs font-bold",children:"B"})});case"Well":return e.jsx("div",{className:"flex items-center justify-center transition-transform",style:{width:r?32:26,height:r?32:26,backgroundColor:c,borderRadius:"4px",transform:"rotate(45deg)",border:"3px solid white",boxShadow:"0 2px 6px rgba(0,0,0,0.3)"},children:e.jsx("span",{className:"text-white text-xs font-bold",style:{transform:"rotate(-45deg)"},children:"W"})});case"River Intake":return e.jsx("div",{className:"flex items-center justify-center transition-transform",style:{width:0,height:0,borderLeft:`${r?16:13}px solid transparent`,borderRight:`${r?16:13}px solid transparent`,borderBottom:`${r?28:22}px solid ${c}`,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"}});case"Spring":return e.jsx("div",{className:"flex items-center justify-center transition-transform",style:{width:r?32:26,height:r?32:26,backgroundColor:c,borderRadius:"50% 50% 50% 0",transform:"rotate(-45deg)",border:"3px solid white",boxShadow:"0 2px 6px rgba(0,0,0,0.3)"}});case"Dam/Reservoir":return e.jsx("div",{className:"flex items-center justify-center transition-transform",style:{width:r?32:26,height:r?24:20,backgroundColor:c,borderRadius:"4px",border:"3px solid white",boxShadow:"0 2px 6px rgba(0,0,0,0.3)"},children:e.jsx("span",{className:"text-white text-xs font-bold",children:"D"})});case"Lake":return e.jsx("div",{className:"flex items-center justify-center transition-transform",style:{width:r?36:30,height:r?24:20,backgroundColor:c,borderRadius:"50%",border:"3px solid white",boxShadow:"0 2px 6px rgba(0,0,0,0.3)"},children:e.jsx(xie,{className:"h-3 w-3 text-white"})});default:return e.jsx("div",{className:"flex items-center justify-center transition-transform",style:{width:r?32:26,height:r?32:26,backgroundColor:c,borderRadius:"50%",border:"3px solid white",boxShadow:"0 2px 6px rgba(0,0,0,0.3)"},children:e.jsx(Si,{className:"h-3 w-3 text-white"})})}};return t.location?e.jsx(BC,{longitude:t.location.coordinates[0],latitude:t.location.coordinates[1],anchor:"center",children:e.jsx("div",{className:"cursor-pointer hover:scale-110 transition-transform",onClick:s,onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:i()})}):null}function RQ({sources:t,stations:r,selectedId:s,onSelect:n,onEdit:a,height:o="400px"}){var O,C,D,L,F,B;const c=A.useMemo(()=>aBe(t,r),[t,r]),[i,f]=A.useState({longitude:c.longitude,latitude:c.latitude,zoom:c.zoom}),[p,g]=A.useState(!1),[y,b]=A.useState(null),[w,T]=A.useState(null);A.useEffect(()=>{!p&&(t!=null&&t.length||r!=null&&r.length)&&(f({longitude:c.longitude,latitude:c.latitude,zoom:c.zoom}),g(!0))},[c,t,r,p]);const N=A.useMemo(()=>(t==null?void 0:t.filter(U=>U.location))||[],[t]);A.useMemo(()=>{const U=new Set;return N.forEach(te=>{var Q;U.add(((Q=te.kind)==null?void 0:Q.name)||"Unknown")}),Array.from(U)},[N]);const M=U=>{switch(U.toLowerCase()){case"active":return"default";case"inactive":return"secondary";case"abandoned":return"destructive";default:return"outline"}};return e.jsxs("div",{style:{height:o,width:"100%"},className:"rounded-lg overflow-hidden border relative",children:[e.jsxs(Pm,{...i,onMove:U=>f(U.viewState),mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",style:{width:"100%",height:"100%"},children:[e.jsx(km,{position:"top-right"}),e.jsx(yv,{position:"bottom-left"}),N.map(U=>e.jsx(iBe,{source:U,isSelected:s===U.id,onClick:()=>{T({source:U,longitude:U.location.coordinates[0],latitude:U.location.coordinates[1]}),n&&n(U.id,"source")},onHover:te=>b(te?U:null)},U.id)),y&&!w&&y.location&&e.jsx(OS,{longitude:y.location.coordinates[0],latitude:y.location.coordinates[1],closeButton:!1,closeOnClick:!1,anchor:"bottom",offset:15,children:e.jsxs("div",{className:"p-1 min-w-[150px]",children:[e.jsx("p",{className:"font-semibold text-sm",children:y.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:y.code}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-xs",children:((O=y.kind)==null?void 0:O.name)||"Unknown"}),e.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:mO[((C=y.status)==null?void 0:C.name)||"Unknown"]}}),e.jsx("span",{className:"text-xs",children:((D=y.status)==null?void 0:D.name)||"Unknown"})]})]})}),w&&e.jsx(OS,{longitude:w.longitude,latitude:w.latitude,closeButton:!1,closeOnClick:!1,anchor:"bottom",offset:15,maxWidth:"300px",children:e.jsxs("div",{className:"p-2 min-w-[220px]",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Si,{className:"h-4 w-4 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:w.source.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:w.source.code})]})]}),e.jsx(K,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>T(null),children:e.jsx(Ko,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"mt-3 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Type:"}),e.jsx("span",{children:((L=w.source.kind)==null?void 0:L.name)||"N/A"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsx(Ae,{variant:M(((F=w.source.status)==null?void 0:F.name)||""),children:((B=w.source.status)==null?void 0:B.name)||"Unknown"})]}),w.source.catchment&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Catchment:"}),e.jsx("span",{children:w.source.catchment})]}),w.source.capacity_m3_per_day&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Capacity:"}),e.jsxs("span",{children:[w.source.capacity_m3_per_day.toLocaleString()," m/day"]})]}),w.source.depth_m&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Depth:"}),e.jsxs("span",{children:[w.source.depth_m," m"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Coordinates:"}),e.jsxs("span",{className:"text-xs",children:[w.latitude.toFixed(4),", ",w.longitude.toFixed(4)]})]})]}),a&&e.jsx("div",{className:"mt-3 pt-2 border-t",children:e.jsxs(K,{variant:"outline",size:"sm",className:"w-full",onClick:()=>{a(w.source),T(null)},children:[e.jsx(ki,{className:"h-3 w-3 mr-2"}),"Edit Source"]})})]})})]}),e.jsxs("div",{className:"absolute bottom-8 left-2 bg-white/95 backdrop-blur-sm rounded-lg shadow-md p-3 text-xs max-w-[200px]",children:[e.jsx("p",{className:"font-semibold mb-2 text-muted-foreground border-b pb-1",children:"Source Types"}),e.jsxs("div",{className:"space-y-1.5 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-400 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-[8px] font-bold",children:"B"})}),e.jsx("span",{children:"Borehole"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gray-400 flex items-center justify-center",style:{transform:"rotate(45deg)"},children:e.jsx("span",{className:"text-white text-[8px] font-bold",style:{transform:"rotate(-45deg)"},children:"W"})}),e.jsx("span",{children:"Well"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{style:{width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent",borderBottom:"12px solid #9ca3af"}}),e.jsx("span",{children:"River Intake"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-400",style:{borderRadius:"50% 50% 50% 0",transform:"rotate(-45deg)"}}),e.jsx("span",{children:"Spring"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-3 rounded bg-gray-400 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-[8px] font-bold",children:"D"})}),e.jsx("span",{children:"Dam/Reservoir"})]})]}),e.jsx("p",{className:"font-semibold mb-2 text-muted-foreground border-b pb-1",children:"Status Colors"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-[#22c55e]"}),e.jsx("span",{children:"Active"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-[#94a3b8]"}),e.jsx("span",{children:"Inactive"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-[#ef4444]"}),e.jsx("span",{children:"Abandoned"})]})]})]})]})}function oBe(){const[t,r]=A.useState(""),[s,n]=A.useState(null),[a,o]=A.useState(!1),[c,i]=A.useState(!1),[f,p]=A.useState(!0),[g,y]=A.useState(!1),{data:b,isLoading:w}=kze({search:t,per_page:100}),T=Eze(),N=(b==null?void 0:b.data)||[],M=()=>{n(null),i(!0),o(!0)},O=B=>{n(B),i(!1),o(!0)},C=async B=>{if(window.confirm(`Are you sure you want to delete source "${B.name}"?`))try{await T.mutateAsync(B.id),Me.success("Source deleted successfully")}catch(U){Me.error(U.message||"Failed to delete source")}},D=()=>{o(!1),n(null),i(!1)},L=B=>{if(!B)return"secondary";switch(B.name.toLowerCase()){case"active":return"default";case"inactive":return"secondary";case"abandoned":return"destructive";default:return"secondary"}},F=B=>{if(!B)return"secondary";switch(B.name.toLowerCase()){case"low":return"default";case"medium":return"secondary";case"high":return"destructive";default:return"secondary"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Water Sources Registry"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage water sources and abstraction points"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{variant:"outline",onClick:()=>y(!0),children:[e.jsx(Bo,{className:"mr-2 h-4 w-4"}),"Bulk Import"]}),e.jsxs(K,{onClick:M,children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Add Source"]})]})]}),f&&N.length>0&&e.jsxs(H,{className:"mb-6",children:[e.jsx(ue,{children:e.jsx(he,{children:"Sources Map"})}),e.jsx(X,{children:e.jsx(RQ,{sources:N,selectedId:s==null?void 0:s.id,onSelect:B=>{const U=N.find(te=>te.id===B);U&&n(U)},onEdit:O,height:"400px"})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search sources by name or code...",value:t,onChange:B=>r(B.target.value),className:"pl-10"})]}),e.jsxs(K,{variant:"outline",size:"sm",onClick:()=>p(!f),children:[e.jsx(jd,{className:"mr-2 h-4 w-4"}),f?"Hide":"Show"," Map"]})]})}),e.jsx(X,{children:w?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Loading sources..."}):N.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Si,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No sources found"}),e.jsxs(K,{onClick:M,variant:"outline",className:"mt-4",children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Add your first source"]})]}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Code"}),e.jsx(se,{children:"Name"}),e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Catchment"}),e.jsx(se,{children:"Capacity (m/day)"}),e.jsx(se,{children:"Quality Risk"}),e.jsx(se,{children:"Location"}),e.jsx(se,{className:"text-right",children:"Actions"})]})}),e.jsx(lr,{children:N.map(B=>{var U,te,Q;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:B.code}),e.jsx(J,{children:B.name}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:((U=B.kind)==null?void 0:U.name)||"N/A"})}),e.jsx(J,{children:e.jsx(Ae,{variant:L(B.status),children:((te=B.status)==null?void 0:te.name)||"Unknown"})}),e.jsx(J,{className:"text-muted-foreground",children:B.catchment||"N/A"}),e.jsx(J,{className:"text-right",children:((Q=B.capacity_m3_per_day)==null?void 0:Q.toLocaleString())||"N/A"}),e.jsx(J,{children:B.quality_risk?e.jsx(Ae,{variant:F(B.quality_risk),children:B.quality_risk.name}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})}),e.jsx(J,{children:B.location?e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(fn,{className:"h-3 w-3"}),e.jsxs("span",{children:[B.location.coordinates[1].toFixed(4),", ",B.location.coordinates[0].toFixed(4)]})]}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})}),e.jsx(J,{className:"text-right",children:e.jsxs(OQ,{children:[e.jsx(IQ,{asChild:!0,children:e.jsx(K,{variant:"ghost",size:"sm",children:e.jsx(a9,{className:"h-4 w-4"})})}),e.jsxs(PR,{align:"end",children:[e.jsxs(Uh,{onClick:()=>O(B),children:[e.jsx(ki,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(Uh,{onClick:()=>C(B),className:"text-destructive",children:[e.jsx(Ws,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},B.id)})})]})})]}),e.jsx(tBe,{open:a,onClose:D,source:s,isCreating:c}),e.jsx(sBe,{open:g,onClose:()=>y(!1)})]})}function lBe({open:t,onClose:r,station:s,isCreating:n}){var g,y;const a=Oze(),o=Ize(),[c,i]=A.useState({name:"",code:"",station_type_id:void 0,datasource_id:1,elevation_m:void 0,active:!0,latitude:void 0,longitude:void 0});A.useEffect(()=>{var b,w;s&&!n?i({name:s.name,code:s.code,station_type_id:s.station_type_id,datasource_id:s.datasource_id,elevation_m:s.elevation_m||void 0,active:s.active,latitude:(b=s.location)==null?void 0:b.coordinates[1],longitude:(w=s.location)==null?void 0:w.coordinates[0]}):n&&i({name:"",code:"",station_type_id:void 0,datasource_id:1,elevation_m:void 0,active:!0,latitude:void 0,longitude:void 0})},[s,n,t]);const f=async b=>{if(b.preventDefault(),!c.name||!c.code||!c.station_type_id||!c.datasource_id){Me.error("Please fill in all required fields");return}try{n?(await a.mutateAsync(c),Me.success("Station created successfully")):s&&(await o.mutateAsync({id:s.id,data:c}),Me.success("Station updated successfully")),r()}catch(w){Me.error(w.message||`Failed to ${n?"create":"update"} station`)}},p=a.isPending||o.isPending;return e.jsx(Qt,{open:t,onOpenChange:r,children:e.jsxs(Zt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:n?"Add New Station":"Edit Station"})}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"code",children:"Station Code *"}),e.jsx(Ie,{id:"code",value:c.code,onChange:b=>i({...c,code:b.target.value}),placeholder:"e.g., HMS-001",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"name",children:"Station Name *"}),e.jsx(Ie,{id:"name",value:c.name,onChange:b=>i({...c,name:b.target.value}),placeholder:"e.g., Tana River Flow Station",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"station_type_id",children:"Station Type *"}),e.jsxs(Nt,{value:(g=c.station_type_id)==null?void 0:g.toString(),onValueChange:b=>i({...c,station_type_id:parseInt(b)}),children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select type"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"1",children:"Weather"}),e.jsx(ge,{value:"2",children:"Hydrological"}),e.jsx(ge,{value:"3",children:"Rain Gauge"}),e.jsx(ge,{value:"4",children:"Stream Gauge"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"datasource_id",children:"Data Source *"}),e.jsxs(Nt,{value:(y=c.datasource_id)==null?void 0:y.toString(),onValueChange:b=>i({...c,datasource_id:parseInt(b)}),children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select source"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"1",children:"Manual Reading"}),e.jsx(ge,{value:"2",children:"Telemetry"}),e.jsx(ge,{value:"3",children:"SCADA"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"elevation_m",children:"Elevation (m)"}),e.jsx(Ie,{id:"elevation_m",type:"number",step:"0.1",value:c.elevation_m||"",onChange:b=>i({...c,elevation_m:b.target.value?parseFloat(b.target.value):void 0}),placeholder:"1500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Location (PostGIS)"}),e.jsx(DQ,{latitude:c.latitude,longitude:c.longitude,onLocationChange:(b,w)=>i({...c,latitude:b,longitude:w})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fd,{id:"active",checked:c.active,onCheckedChange:b=>i({...c,active:b})}),e.jsx(we,{htmlFor:"active",className:"cursor-pointer",children:"Station is active"})]}),e.jsxs(Ps,{children:[e.jsx(K,{type:"button",variant:"outline",onClick:r,disabled:p,children:"Cancel"}),e.jsx(K,{type:"submit",disabled:p,children:p?"Saving...":n?"Create Station":"Update Station"})]})]})]})})}function cBe({station:t,onClose:r}){var w;const[s,n]=A.useState(!1),[a,o]=A.useState({parameter_id:void 0,make:"",model:"",serial_number:""}),{data:c,isLoading:i}=Fze((t==null?void 0:t.id)||null),f=$ze(),p=zze(),g=async T=>{if(T.preventDefault(),!t||!a.parameter_id){Me.error("Please select a parameter");return}try{await f.mutateAsync({stationId:t.id,data:a}),Me.success("Sensor added successfully"),n(!1),o({parameter_id:void 0,make:"",model:"",serial_number:""})}catch(N){Me.error(N.message||"Failed to add sensor")}},y=async T=>{if(t&&window.confirm("Are you sure you want to delete this sensor?"))try{await p.mutateAsync({stationId:t.id,sensorId:T}),Me.success("Sensor deleted successfully")}catch(N){Me.error(N.message||"Failed to delete sensor")}},b=f.isPending;return e.jsx(Qt,{open:t!==null,onOpenChange:r,children:e.jsxs(Zt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Yt,{children:e.jsxs(Xt,{children:["Manage Sensors - ",t==null?void 0:t.name]})}),e.jsxs("div",{className:"space-y-4",children:[i?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Loading sensors..."}):c&&c.length>0?e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Parameter"}),e.jsx(se,{children:"Make"}),e.jsx(se,{children:"Model"}),e.jsx(se,{children:"Serial Number"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Installed"}),e.jsx(se,{className:"text-right",children:"Actions"})]})}),e.jsx(lr,{children:c.map(T=>e.jsxs(Qe,{children:[e.jsxs(J,{className:"font-medium",children:["Parameter #",T.parameter_id]}),e.jsx(J,{children:T.make||"N/A"}),e.jsx(J,{children:T.model||"N/A"}),e.jsx(J,{className:"font-mono text-sm",children:T.serial_number||"N/A"}),e.jsx(J,{children:e.jsx(Ae,{variant:T.active?"default":"secondary",children:T.active?"Active":"Inactive"})}),e.jsx(J,{className:"text-sm text-muted-foreground",children:T.installed_at?new Date(T.installed_at).toLocaleDateString():"N/A"}),e.jsx(J,{className:"text-right",children:e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>y(T.id),children:e.jsx(Ws,{className:"h-4 w-4 text-destructive"})})})]},T.id))})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(sM,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No sensors configured"})]}),s?e.jsxs("form",{onSubmit:g,className:"space-y-4 border rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold",children:"Add New Sensor"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"parameter_id",children:"Parameter *"}),e.jsxs(Nt,{value:(w=a.parameter_id)==null?void 0:w.toString(),onValueChange:T=>o({...a,parameter_id:parseInt(T)}),children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select parameter"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"1",children:"Temperature"}),e.jsx(ge,{value:"2",children:"Rainfall"}),e.jsx(ge,{value:"3",children:"Water Level"}),e.jsx(ge,{value:"4",children:"Flow Rate"}),e.jsx(ge,{value:"5",children:"Humidity"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"make",children:"Make"}),e.jsx(Ie,{id:"make",value:a.make,onChange:T=>o({...a,make:T.target.value}),placeholder:"e.g., Campbell Scientific"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"model",children:"Model"}),e.jsx(Ie,{id:"model",value:a.model,onChange:T=>o({...a,model:T.target.value}),placeholder:"e.g., CS215"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"serial_number",children:"Serial Number"}),e.jsx(Ie,{id:"serial_number",value:a.serial_number,onChange:T=>o({...a,serial_number:T.target.value}),placeholder:"e.g., SN12345"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{type:"submit",disabled:b,children:b?"Adding...":"Add Sensor"}),e.jsx(K,{type:"button",variant:"outline",onClick:()=>{n(!1),o({parameter_id:void 0,make:"",model:"",serial_number:""})},disabled:b,children:"Cancel"})]})]}):e.jsxs(K,{onClick:()=>n(!0),className:"w-full",children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Add Sensor"]})]})]})})}function dBe(){const[t,r]=A.useState(""),[s,n]=A.useState(null),[a,o]=A.useState(!1),[c,i]=A.useState(!1),[f,p]=A.useState(null),[g,y]=A.useState(!0),{data:b,isLoading:w}=Mze({search:t,per_page:100}),T=Dze(),N=Rze(),M=Lze(),O=(b==null?void 0:b.data)||[],C=()=>{n(null),i(!0),o(!0)},D=Q=>{n(Q),i(!1),o(!0)},L=async Q=>{if(window.confirm(`Are you sure you want to delete station "${Q.name}"?`))try{await T.mutateAsync(Q.id),Me.success("Station deleted successfully")}catch(re){Me.error(re.message||"Failed to delete station")}},F=async Q=>{try{await N.mutateAsync(Q.id),Me.success("Station activated successfully")}catch(re){Me.error(re.message||"Failed to activate station")}},B=async Q=>{try{await M.mutateAsync(Q.id),Me.success("Station deactivated successfully")}catch(re){Me.error(re.message||"Failed to deactivate station")}},U=Q=>{p(Q)},te=()=>{o(!1),n(null),i(!1)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Hydro-Met Stations Registry"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage monitoring stations and sensor networks"})]}),e.jsxs(K,{onClick:C,children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Add Station"]})]}),g&&O.length>0&&e.jsxs(H,{className:"mb-6",children:[e.jsx(ue,{children:e.jsx(CardTitle,{children:"Stations Map"})}),e.jsx(X,{children:e.jsx(RQ,{stations:O,selectedId:s==null?void 0:s.id,onSelect:Q=>{const re=O.find(Z=>Z.id===Q);re&&n(re)},height:"400px"})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search stations by name or code...",value:t,onChange:Q=>r(Q.target.value),className:"pl-10"})]}),e.jsxs(K,{variant:"outline",size:"sm",onClick:()=>y(!g),children:[e.jsx(jd,{className:"mr-2 h-4 w-4"}),g?"Hide":"Show"," Map"]})]})}),e.jsx(X,{children:w?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Loading stations..."}):O.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(sM,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No stations found"}),e.jsxs(K,{onClick:C,variant:"outline",className:"mt-4",children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Add your first station"]})]}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Code"}),e.jsx(se,{children:"Name"}),e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Elevation (m)"}),e.jsx(se,{children:"Sensors"}),e.jsx(se,{children:"Location"}),e.jsx(se,{className:"text-right",children:"Actions"})]})}),e.jsx(lr,{children:O.map(Q=>{var re,Z,ne;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:Q.code}),e.jsx(J,{children:Q.name}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:((re=Q.station_type)==null?void 0:re.name)||"N/A"})}),e.jsx(J,{children:e.jsx(Ae,{variant:Q.active?"default":"secondary",children:Q.active?"Active":"Inactive"})}),e.jsx(J,{className:"text-right",children:((Z=Q.elevation_m)==null?void 0:Z.toFixed(1))||"N/A"}),e.jsx(J,{children:e.jsxs(K,{variant:"ghost",size:"sm",onClick:()=>U(Q),children:[((ne=Q.sensors)==null?void 0:ne.length)||0," sensors"]})}),e.jsx(J,{children:Q.location?e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(fn,{className:"h-3 w-3"}),e.jsxs("span",{children:[Q.location.coordinates[1].toFixed(4),", ",Q.location.coordinates[0].toFixed(4)]})]}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})}),e.jsx(J,{className:"text-right",children:e.jsxs(OQ,{children:[e.jsx(IQ,{asChild:!0,children:e.jsx(K,{variant:"ghost",size:"sm",children:e.jsx(a9,{className:"h-4 w-4"})})}),e.jsxs(PR,{align:"end",children:[e.jsxs(Uh,{onClick:()=>D(Q),children:[e.jsx(ki,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(Uh,{onClick:()=>U(Q),children:[e.jsx(sM,{className:"mr-2 h-4 w-4"}),"Manage Sensors"]}),Q.active?e.jsxs(Uh,{onClick:()=>B(Q),children:[e.jsx(cie,{className:"mr-2 h-4 w-4"}),"Deactivate"]}):e.jsxs(Uh,{onClick:()=>F(Q),children:[e.jsx(wb,{className:"mr-2 h-4 w-4"}),"Activate"]}),e.jsxs(Uh,{onClick:()=>L(Q),className:"text-destructive",children:[e.jsx(Ws,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},Q.id)})})]})})]}),e.jsx(lBe,{open:a,onClose:te,station:s,isCreating:c}),e.jsx(cBe,{station:f,onClose:()=>p(null)})]})}function M8(){return e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx(Ti,{}),e.jsx("main",{className:"flex-1 p-8 overflow-auto",children:e.jsx(Ai,{})})]})}const va="/costing",Fv={getBudgetVersions:t=>{const r={};return t!=null&&t.fiscal_year&&(r.fiscal_year=t.fiscal_year.toString()),t!=null&&t.status&&(r.status=t.status),pe.get(`${va}/budgets`,r)},getBudgetVersion:(t,r=!0)=>{const s={};return r!==void 0&&(s.include_lines=r.toString()),pe.get(`${va}/budgets/${t}`,s)},createBudgetVersion:t=>pe.post(`${va}/budgets`,t),updateBudgetVersion:(t,r)=>pe.patch(`${va}/budgets/${t}`,r),deleteBudgetVersion:t=>pe.delete(`${va}/budgets/${t}`),approveBudgetVersion:t=>pe.post(`${va}/budgets/${t}/approve`),getBudgetLines:(t,r)=>{const s={};return r!=null&&r.cost_center_id&&(s.cost_center_id=r.cost_center_id.toString()),r!=null&&r.gl_account_id&&(s.gl_account_id=r.gl_account_id.toString()),r!=null&&r.period_from&&(s.period_from=r.period_from),r!=null&&r.period_to&&(s.period_to=r.period_to),pe.get(`${va}/budgets/${t}/lines`,s)},upsertBudgetLines:(t,r)=>pe.post(`${va}/budgets/${t}/lines`,{lines:r}),getBudgetSummary:t=>pe.get(`${va}/budgets/${t}/summary`),getAllocationRules:t=>{const r={};return(t==null?void 0:t.active)!==void 0&&(r.active=t.active.toString()),pe.get(`${va}/allocation-rules`,r)},createAllocationRule:t=>pe.post(`${va}/allocation-rules`,t),updateAllocationRule:(t,r)=>pe.patch(`${va}/allocation-rules/${t}`,r),deleteAllocationRule:t=>pe.delete(`${va}/allocation-rules/${t}`),getAllocationRuns:t=>{const r={};return t!=null&&t.status&&(r.status=t.status),t!=null&&t.period_from&&(r.period_from=t.period_from),pe.get(`${va}/allocation-runs`,r)},getAllocationRun:(t,r=!0)=>{const s={};return r!==void 0&&(s.include_results=r.toString()),pe.get(`${va}/allocation-runs/${t}`,s)},executeAllocationRun:t=>pe.post(`${va}/allocation-runs`,t),deleteAllocationRun:t=>pe.delete(`${va}/allocation-runs/${t}`),getCostToServeMetrics:t=>{const r={};return t!=null&&t.period_from&&(r.period_from=t.period_from),t!=null&&t.period_to&&(r.period_to=t.period_to),t!=null&&t.scheme_id&&(r.scheme_id=t.scheme_id.toString()),t!=null&&t.dma_id&&(r.dma_id=t.dma_id.toString()),t!=null&&t.class&&(r.class=t.class),pe.get(`${va}/cost-to-serve`,r)},calculateCostToServe:t=>pe.post(`${va}/cost-to-serve`,t),getCostToServeSummary:t=>{const r={};return t!=null&&t.period_from&&(r.period_from=t.period_from),t!=null&&t.period_to&&(r.period_to=t.period_to),t!=null&&t.scheme_id&&(r.scheme_id=t.scheme_id.toString()),pe.get(`${va}/cost-to-serve/summary`,r)},getDmaLeagueTable:t=>pe.get(`${va}/cost-to-serve/dma-league/${t}`),getCostToServeTrends:t=>{const r={};return t!=null&&t.period_from&&(r.period_from=t.period_from),t!=null&&t.period_to&&(r.period_to=t.period_to),t!=null&&t.scheme_id&&(r.scheme_id=t.scheme_id.toString()),t!=null&&t.dma_id&&(r.dma_id=t.dma_id.toString()),pe.get(`${va}/cost-to-serve/trends`,r)}},uBe=(t,r)=>it({queryKey:["costing","budgets",t],queryFn:()=>Fv.getBudgetVersions(t),...r}),hBe=(t,r)=>it({queryKey:["costing","allocation-rules",t],queryFn:()=>Fv.getAllocationRules(t),...r}),mBe=(t,r)=>it({queryKey:["costing","allocation-runs",t],queryFn:()=>Fv.getAllocationRuns(t),...r}),fBe=(t,r)=>it({queryKey:["costing","cost-to-serve",t],queryFn:()=>Fv.getCostToServeMetrics(t),...r}),pBe=(t,r)=>it({queryKey:["costing","cost-to-serve","summary",t],queryFn:()=>Fv.getCostToServeSummary(t),...r}),xBe=(t,r)=>it({queryKey:["costing","cost-to-serve","dma-league",t],queryFn:()=>Fv.getDmaLeagueTable(t),enabled:t!=null,...r});function gBe(){const t=Fp(),[r,s]=A.useState(""),[n,a]=A.useState("all"),o=A.useMemo(()=>n==="all"?{}:{fiscal_year:parseInt(n)},[n]),{data:c,isLoading:i,error:f}=uBe(o),p=w=>{const T={draft:{variant:"secondary",icon:bs},submitted:{variant:"outline",icon:$s},approved:{variant:"default",icon:Kc},archived:{variant:"outline",icon:Fae}},N=T[w]||T.draft,M=N.icon;return e.jsxs(Ae,{variant:N.variant,className:"gap-1",children:[e.jsx(M,{className:"h-3 w-3"}),w.charAt(0).toUpperCase()+w.slice(1)]})},g=(c==null?void 0:c.data)||[],y=g.filter(w=>w.name.toLowerCase().includes(r.toLowerCase())),b=A.useMemo(()=>{const w=g.length,T=g.filter(O=>O.status==="approved").length,N=g.filter(O=>O.status==="submitted").length,M=g.filter(O=>O.status==="draft").length;return{total:w,approved:T,pending:N,draft:M}},[g]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Budget Management"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Create and manage annual budgets with approval workflows"})]}),e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"Create Budget"]})]}),e.jsxs(H,{className:"p-6",children:[e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search budgets...",value:r,onChange:w=>s(w.target.value),className:"pl-10"})]}),e.jsxs("select",{value:n,onChange:w=>a(w.target.value),className:"px-3 py-2 border rounded-md bg-background",children:[e.jsx("option",{value:"all",children:"All Years"}),e.jsx("option",{value:"2026",children:"FY 2026"}),e.jsx("option",{value:"2025",children:"FY 2025"}),e.jsx("option",{value:"2024",children:"FY 2024"})]})]}),f&&e.jsxs("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded-md mb-4",children:["Error loading budgets: ",f instanceof Error?f.message:"Unknown error"]}),i?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(as,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Budget Name"}),e.jsx(se,{children:"Fiscal Year"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Created"}),e.jsx(se,{})]})}),e.jsx(lr,{children:y.length===0?e.jsx(Qe,{children:e.jsx(J,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No budgets found"})}):y.map(w=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:w.name}),e.jsx(J,{children:w.fiscal_year}),e.jsx(J,{children:p(w.status)}),e.jsx(J,{children:new Date(w.created_at).toLocaleDateString()}),e.jsx(J,{children:e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>t(`/costing/budgets/${w.id}`),children:"View Details"})})]},w.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{className:"p-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Budgets"}),e.jsx("div",{className:"text-3xl font-bold mt-2",children:b.total})]}),e.jsxs(H,{className:"p-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Approved"}),e.jsx("div",{className:"text-3xl font-bold mt-2",children:b.approved})]}),e.jsxs(H,{className:"p-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Pending Approval"}),e.jsx("div",{className:"text-3xl font-bold mt-2",children:b.pending})]}),e.jsxs(H,{className:"p-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Draft"}),e.jsx("div",{className:"text-3xl font-bold mt-2",children:b.draft})]})]})]})}function yBe(){const{id:t}=xC(),r=Fp(),[s,n]=A.useState(!1),[a,o]=A.useState(""),c={name:"FY 2025 Operating Budget",fiscal_year:2025,status:"submitted",total_amount:25e5,created_at:"2024-09-15",created_by:{name:"John Smith"}},i=[{month:"2025-01",amount:208333,actuals:195e3,variance:-13333,variance_pct:-6.4},{month:"2025-02",amount:208333,actuals:21e4,variance:1667,variance_pct:.8},{month:"2025-03",amount:208333,actuals:198e3,variance:-10333,variance_pct:-5},{month:"2025-04",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-05",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-06",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-07",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-08",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-09",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-10",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-11",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-12",amount:208333,actuals:0,variance:0,variance_pct:0}],f=[{id:1,cost_center:"Operations",gl_account:"5110 - Electricity",amount:12e4,ytd_actual:35e3},{id:2,cost_center:"Operations",gl_account:"5120 - Chemicals",amount:85e3,ytd_actual:22e3},{id:3,cost_center:"Engineering",gl_account:"5200 - Salaries",amount:48e4,ytd_actual:14e4},{id:4,cost_center:"Finance",gl_account:"5300 - Admin",amount:18e4,ytd_actual:48e3}],p=()=>{console.log("Approving budget with notes:",a),n(!1),r("/costing/budgets")},g=y=>{const b={draft:{variant:"secondary",icon:bs},submitted:{variant:"outline",icon:bs},approved:{variant:"default",icon:Kc}},w=b[y]||b.draft,T=w.icon;return e.jsxs(Ae,{variant:w.variant,className:"gap-1",children:[e.jsx(T,{className:"h-3 w-3"}),y.charAt(0).toUpperCase()+y.slice(1)]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(K,{variant:"ghost",size:"sm",onClick:()=>r("/costing/budgets"),children:[e.jsx(vb,{className:"h-4 w-4 mr-2"}),"Back to Budgets"]})}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:c.name}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:["Created by ",c.created_by.name," on ",new Date(c.created_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[g(c.status),e.jsxs(K,{onClick:()=>n(!0),className:"gap-2",children:[e.jsx(Kc,{className:"h-4 w-4"}),"Approve Budget"]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{className:"p-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Budget"}),e.jsxs("div",{className:"text-3xl font-bold mt-2",children:["$",(c.total_amount/1e3).toFixed(0),"K"]})]}),e.jsxs(H,{className:"p-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"YTD Actuals"}),e.jsx("div",{className:"text-3xl font-bold mt-2",children:"$603K"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"24% of budget"})]}),e.jsxs(H,{className:"p-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"YTD Variance"}),e.jsx("div",{className:"text-3xl font-bold mt-2 text-red-600",children:"-$22K"}),e.jsx("p",{className:"text-xs text-red-600 mt-1",children:"-3.5% unfavorable"})]}),e.jsxs(H,{className:"p-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Fiscal Year"}),e.jsx("div",{className:"text-3xl font-bold mt-2",children:c.fiscal_year})]})]}),e.jsxs(ss,{defaultValue:"breakdown",children:[e.jsxs(Yr,{children:[e.jsx(wt,{value:"breakdown",children:"Monthly Breakdown"}),e.jsx(wt,{value:"lines",children:"Budget Lines"})]}),e.jsx(kt,{value:"breakdown",className:"mt-6",children:e.jsxs(H,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Monthly Budget vs Actuals"}),e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Month"}),e.jsx(se,{className:"text-right",children:"Budget"}),e.jsx(se,{className:"text-right",children:"Actuals"}),e.jsx(se,{className:"text-right",children:"Variance"}),e.jsx(se,{className:"text-right",children:"Variance %"})]})}),e.jsx(lr,{children:i.map(y=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:y.month}),e.jsxs(J,{className:"text-right font-mono",children:["$",y.amount.toLocaleString()]}),e.jsx(J,{className:"text-right font-mono",children:y.actuals>0?`$${y.actuals.toLocaleString()}`:"-"}),e.jsx(J,{className:`text-right font-mono ${y.variance<0?"text-red-600":y.variance>0?"text-green-600":""}`,children:y.variance!==0?`$${y.variance.toLocaleString()}`:"-"}),e.jsx(J,{className:"text-right",children:y.variance_pct!==0?e.jsxs(Ae,{variant:y.variance_pct<0?"destructive":"default",className:"gap-1",children:[y.variance_pct<0?e.jsx(ci,{className:"h-3 w-3"}):e.jsx(zs,{className:"h-3 w-3"}),Math.abs(y.variance_pct).toFixed(1),"%"]}):"-"})]},y.month))})]})]})}),e.jsx(kt,{value:"lines",className:"mt-6",children:e.jsxs(H,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Budget Line Items"}),e.jsx(K,{size:"sm",children:"Add Line"})]}),e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Cost Center"}),e.jsx(se,{children:"GL Account"}),e.jsx(se,{className:"text-right",children:"Annual Budget"}),e.jsx(se,{className:"text-right",children:"YTD Actual"}),e.jsx(se,{className:"text-right",children:"% Utilized"})]})}),e.jsx(lr,{children:f.map(y=>{const b=y.ytd_actual/y.amount*100;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:y.cost_center}),e.jsx(J,{className:"text-sm text-muted-foreground",children:y.gl_account}),e.jsxs(J,{className:"text-right font-mono",children:["$",y.amount.toLocaleString()]}),e.jsxs(J,{className:"text-right font-mono",children:["$",y.ytd_actual.toLocaleString()]}),e.jsx(J,{className:"text-right",children:e.jsxs(Ae,{variant:b>100?"destructive":b>75?"outline":"secondary",children:[b.toFixed(0),"%"]})})]},y.id)})})]})]})})]}),e.jsx(Qt,{open:s,onOpenChange:n,children:e.jsxs(Zt,{children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Approve Budget"}),e.jsxs(Es,{children:['You are about to approve "',c.name,'". This action will lock the budget for the fiscal year.']})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Approval Notes (optional)"}),e.jsx(ws,{placeholder:"Add any comments or conditions...",value:a,onChange:y=>o(y.target.value),className:"mt-2",rows:4})]})}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsx(K,{onClick:p,children:"Approve Budget"})]})]})})]})}function vBe(){const[t,r]=A.useState("rules"),{data:s,isLoading:n,error:a}=hBe({active:!0}),{data:o,isLoading:c,error:i}=mBe(),f=(s==null?void 0:s.data)||[],p=(o==null?void 0:o.data)||[],g=y=>{const b={running:{variant:"secondary",icon:$s},completed:{variant:"default",icon:Ns},failed:{variant:"destructive",icon:ec}},w=b[y]||b.running,T=w.icon;return e.jsxs(Ae,{variant:w.variant,className:"gap-1",children:[e.jsx(T,{className:"h-3 w-3"}),y.charAt(0).toUpperCase()+y.slice(1)]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Allocation Console"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage cost allocation rules and execute allocation runs"})]}),e.jsxs(K,{className:"gap-2",variant:"default",children:[e.jsx(Ui,{className:"h-4 w-4"}),"Execute Allocation"]})]}),e.jsxs(ss,{value:t,onValueChange:r,children:[e.jsxs(Yr,{children:[e.jsx(wt,{value:"rules",children:"Allocation Rules"}),e.jsx(wt,{value:"runs",children:"Allocation Runs"})]}),e.jsx(kt,{value:"rules",className:"mt-6",children:e.jsxs(H,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Active Allocation Rules"}),e.jsxs(K,{size:"sm",className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Rule"]})]}),a&&e.jsxs("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded-md mb-4",children:["Error loading rules: ",a instanceof Error?a.message:"Unknown error"]}),n?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(as,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):f.length===0?e.jsx("div",{className:"text-center text-muted-foreground py-8",children:'No allocation rules configured. Click "New Rule" to create one.'}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Rule Name"}),e.jsx(se,{children:"Allocation Basis"}),e.jsx(se,{children:"Driver/Percentage"}),e.jsx(se,{children:"Applies To"}),e.jsx(se,{children:"Status"}),e.jsx(se,{})]})}),e.jsx(lr,{children:f.map(y=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:y.name}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:y.basis.charAt(0).toUpperCase()+y.basis.slice(1)})}),e.jsx(J,{children:y.basis==="driver"&&y.driver?`Driver: ${y.driver.name}`:y.basis==="percentage"&&y.percentage?`${y.percentage}%`:"Equal Split"}),e.jsx(J,{className:"text-sm text-muted-foreground",children:y.applies_to}),e.jsx(J,{children:e.jsx(Ae,{variant:y.active?"default":"secondary",children:y.active?"Active":"Inactive"})}),e.jsx(J,{children:e.jsx(K,{variant:"ghost",size:"sm",children:"Edit"})})]},y.id))})]})]})}),e.jsx(kt,{value:"runs",className:"mt-6",children:e.jsxs(H,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Allocation Run History"}),i&&e.jsxs("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded-md mb-4",children:["Error loading runs: ",i instanceof Error?i.message:"Unknown error"]}),c?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(as,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):p.length===0?e.jsx("div",{className:"text-center text-muted-foreground py-8",children:'No allocation runs executed yet. Click "Execute Allocation" to run one.'}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Period"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Started At"}),e.jsx(se,{children:"Completed At"}),e.jsx(se,{className:"text-right",children:"Results"}),e.jsx(se,{})]})}),e.jsx(lr,{children:p.map(y=>{var b;return e.jsxs(Qe,{children:[e.jsxs(J,{className:"font-medium",children:[y.period_from," to ",y.period_to]}),e.jsx(J,{children:g(y.status)}),e.jsx(J,{className:"text-sm",children:new Date(y.started_at).toLocaleString()}),e.jsx(J,{className:"text-sm",children:y.completed_at?new Date(y.completed_at).toLocaleString():"-"}),e.jsx(J,{className:"text-right font-mono",children:((b=y.meta)==null?void 0:b.results_count)??0}),e.jsxs(J,{children:[y.status==="completed"&&e.jsx(K,{variant:"ghost",size:"sm",children:"View Results"}),y.status==="failed"&&e.jsx(K,{variant:"ghost",size:"sm",children:"View Error"})]})]},y.id)})})]})]})})]})]})}function jBe(){const[t,r]=A.useState("2025-01"),{data:s,isLoading:n,error:a}=xBe(t),{data:o,isLoading:c,error:i}=pBe({period_from:t,period_to:t}),{data:f,isLoading:p}=fBe({period_from:t,period_to:t}),g=(s==null?void 0:s.data)||[],y=o==null?void 0:o.data,b=(f==null?void 0:f.data)||[],w=A.useMemo(()=>b.length===0?0:b.reduce((M,O)=>M+(O.opex_cost||0)+(O.capex_depr||0)+(O.energy_cost||0)+(O.chemical_cost||0)+(O.other_cost||0),0),[b]),T=A.useMemo(()=>{const M={};return b.forEach(O=>{const C=O.class||"Unclassified";M[C]||(M[C]={class:C,connections:0,volume_m3:0,revenue:0,cost:0,margin:0}),M[C].volume_m3+=O.production_m3||0;const D=(O.revenue_per_m3||0)*(O.billed_m3||0),L=(O.opex_cost||0)+(O.capex_depr||0)+(O.energy_cost||0)+(O.chemical_cost||0)+(O.other_cost||0);M[C].revenue+=D,M[C].cost+=L}),Object.values(M).map(O=>({...O,margin:O.revenue>0?Math.round((O.revenue-O.cost)/O.revenue*100):0}))},[b]),N=M=>M===1?e.jsx(Ae,{variant:"default",className:"bg-green-600",children:" Best"}):M<=3?e.jsxs(Ae,{variant:"outline",children:["#",M]}):e.jsxs(Ae,{variant:"secondary",children:["#",M]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Cost-to-Serve Analytics"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"DMA profitability, customer class analysis, and cost trends"})]}),e.jsxs("select",{value:t,onChange:M=>r(M.target.value),className:"px-4 py-2 border rounded-md bg-background",children:[e.jsx("option",{value:"2025-01",children:"January 2025"}),e.jsx("option",{value:"2024-12",children:"December 2024"}),e.jsx("option",{value:"2024-11",children:"November 2024"})]})]}),i&&e.jsxs("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded-md mb-4",children:["Error loading summary: ",i instanceof Error?i.message:"Unknown error"]}),c?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(as,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):y?e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Fl,{className:"h-4 w-4"}),"Total Volume"]}),e.jsx("div",{className:"text-3xl font-bold mt-2",children:`${(y.total_production_m3/1e3).toFixed(0)}K m`}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Produced this period"})]}),e.jsxs(H,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Ga,{className:"h-4 w-4"}),"Total Cost"]}),e.jsxs("div",{className:"text-3xl font-bold mt-2",children:["$",(w/1e3).toFixed(1),"K"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"All cost categories"})]}),e.jsxs(H,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ci,{className:"h-4 w-4 text-green-600"}),"Avg Cost/m"]}),e.jsxs("div",{className:"text-3xl font-bold mt-2",children:["$",y.avg_cost_per_m3.toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Blended rate"})]}),e.jsxs(H,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(zs,{className:"h-4 w-4"}),"Non-Revenue Water"]}),e.jsxs("div",{className:"text-3xl font-bold mt-2",children:[y.nrw_percentage.toFixed(1),"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"System losses"})]})]}):null,e.jsxs(H,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-6",children:"DMA Cost-to-Serve League Table"}),a&&e.jsxs("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded-md mb-4",children:["Error loading DMA data: ",a instanceof Error?a.message:"Unknown error"]}),n?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(as,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):g.length===0?e.jsxs("div",{className:"text-center text-muted-foreground py-8",children:["No DMA data available for ",t]}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Rank"}),e.jsx(se,{children:"DMA"}),e.jsx(se,{className:"text-right",children:"Volume (m)"}),e.jsx(se,{className:"text-right",children:"Total Cost"}),e.jsx(se,{className:"text-right",children:"Cost per m"}),e.jsx(se,{children:"Efficiency"})]})}),e.jsx(lr,{children:g.map((M,O)=>e.jsxs(Qe,{children:[e.jsx(J,{children:N(O+1)}),e.jsxs(J,{className:"font-medium",children:["DMA-",M.dma_id]}),e.jsx(J,{className:"text-right font-mono",children:(M.production_m3||0).toLocaleString()}),e.jsxs(J,{className:"text-right font-mono",children:["$",((M.cost_per_m3||0)*(M.production_m3||0)).toLocaleString()]}),e.jsxs(J,{className:"text-right font-mono font-bold",children:["$",(M.cost_per_m3||0).toFixed(2)]}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:(M.cost_per_m3||0)<.2?"Excellent":(M.cost_per_m3||0)<.3?"Good":"Review"})})]},M.dma_id||O))})]})]}),e.jsxs(H,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Customer Class Profitability"}),p?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(as,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):T.length===0?e.jsxs("div",{className:"text-center text-muted-foreground py-8",children:["No customer class data available for ",t]}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Customer Class"}),e.jsx(se,{className:"text-right",children:"Volume (m)"}),e.jsx(se,{className:"text-right",children:"Revenue"}),e.jsx(se,{className:"text-right",children:"Cost"}),e.jsx(se,{className:"text-right",children:"Margin %"})]})}),e.jsx(lr,{children:T.map(M=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:M.class}),e.jsx(J,{className:"text-right font-mono",children:M.volume_m3.toLocaleString()}),e.jsxs(J,{className:"text-right font-mono",children:["$",M.revenue.toLocaleString()]}),e.jsxs(J,{className:"text-right font-mono",children:["$",M.cost.toLocaleString()]}),e.jsx(J,{className:"text-right",children:e.jsxs(Ae,{variant:M.margin>=70?"default":M.margin>=60?"outline":"secondary",children:[M.margin,"%"]})})]},M.class))})]})]})]})}function bBe(){const[t,r]=A.useState(""),[s,n]=A.useState(new Set(["4"])),a=[{id:"1",code:"1000",name:"Assets",type:"asset",level:0,parent_id:null,active:!0,has_children:!0},{id:"2",code:"2000",name:"Liabilities",type:"liability",level:0,parent_id:null,active:!0,has_children:!1},{id:"3",code:"3000",name:"Equity",type:"equity",level:0,parent_id:null,active:!0,has_children:!1},{id:"4",code:"4000",name:"Revenue",type:"revenue",level:0,parent_id:null,active:!0,has_children:!0},{id:"5",code:"4100",name:"Water Sales",type:"revenue",level:1,parent_id:"4",active:!0,has_children:!0},{id:"6",code:"4110",name:"Residential Water Sales",type:"revenue",level:2,parent_id:"5",active:!0,has_children:!1},{id:"7",code:"4120",name:"Commercial Water Sales",type:"revenue",level:2,parent_id:"5",active:!0,has_children:!1},{id:"8",code:"4200",name:"Connection Fees",type:"revenue",level:1,parent_id:"4",active:!0,has_children:!1},{id:"9",code:"5000",name:"Expenses",type:"expense",level:0,parent_id:null,active:!0,has_children:!0},{id:"10",code:"5100",name:"Operations",type:"expense",level:1,parent_id:"9",active:!0,has_children:!0},{id:"11",code:"5110",name:"Electricity",type:"expense",level:2,parent_id:"10",active:!0,has_children:!1},{id:"12",code:"5120",name:"Chemicals",type:"expense",level:2,parent_id:"10",active:!0,has_children:!1}],o=p=>{const g={asset:"bg-blue-100 text-blue-700",liability:"bg-red-100 text-red-700",equity:"bg-purple-100 text-purple-700",revenue:"bg-green-100 text-green-700",expense:"bg-orange-100 text-orange-700"};return e.jsx(Ae,{className:g[p]||"",children:p.charAt(0).toUpperCase()+p.slice(1)})},c=p=>{const g=new Set(s);g.has(p)?g.delete(p):g.add(p),n(g)},i=p=>{if(!p.parent_id)return!0;const g=a.find(y=>y.id===p.parent_id);return g?s.has(p.parent_id)?i(g):!1:!0},f=a.filter(p=>(t===""||p.code.toLowerCase().includes(t.toLowerCase())||p.name.toLowerCase().includes(t.toLowerCase()))&&i(p));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"GL Accounts"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Chart of accounts with hierarchical structure"})]}),e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Account"]})]}),e.jsxs(H,{className:"p-6",children:[e.jsxs("div",{className:"mb-6 relative",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search by code or name...",value:t,onChange:p=>r(p.target.value),className:"pl-10"})]}),e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Code"}),e.jsx(se,{children:"Account Name"}),e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Status"}),e.jsx(se,{})]})}),e.jsx(lr,{children:f.map(p=>e.jsxs(Qe,{className:p.level>0?"bg-muted/30":"",children:[e.jsx(J,{className:"font-mono font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[p.level>0&&e.jsx("span",{className:"text-muted-foreground",style:{marginLeft:`${p.level*20}px`},children:""}),p.has_children&&e.jsx("button",{onClick:()=>c(p.id),className:"hover:bg-muted rounded p-1",children:e.jsx($u,{className:`h-4 w-4 transition-transform ${s.has(p.id)?"rotate-90":""}`})}),p.code]})}),e.jsx(J,{className:"font-medium",children:p.name}),e.jsx(J,{children:o(p.type)}),e.jsx(J,{children:e.jsx(Ae,{variant:p.active?"default":"secondary",children:p.active?"Active":"Inactive"})}),e.jsx(J,{children:e.jsx(K,{variant:"ghost",size:"sm",children:"Edit"})})]},p.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[e.jsxs(H,{className:"p-4",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Assets"}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:"1"})]}),e.jsxs(H,{className:"p-4",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Liabilities"}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:"1"})]}),e.jsxs(H,{className:"p-4",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Equity"}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:"1"})]}),e.jsxs(H,{className:"p-4",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Revenue"}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:"4"})]}),e.jsxs(H,{className:"p-4",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Expenses"}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:"5"})]})]})]})}function _Be(){const[t,r]=A.useState(""),s=[{id:1,code:"CC-100",name:"Operations",owner:"John Smith",active:!0,parent:null},{id:2,code:"CC-101",name:"Water Production",owner:"Jane Doe",active:!0,parent:"Operations"},{id:3,code:"CC-102",name:"Distribution",owner:"Bob Johnson",active:!0,parent:"Operations"},{id:4,code:"CC-200",name:"Engineering",owner:"Alice Williams",active:!0,parent:null},{id:5,code:"CC-201",name:"Design & Planning",owner:"Charlie Brown",active:!0,parent:"Engineering"},{id:6,code:"CC-300",name:"Finance",owner:"Diana Prince",active:!0,parent:null},{id:7,code:"CC-400",name:"Administration",owner:"Eve Adams",active:!0,parent:null},{id:8,code:"CC-500",name:"Customer Service",owner:"Frank Miller",active:!0,parent:null}],n=s.filter(a=>a.code.toLowerCase().includes(t.toLowerCase())||a.name.toLowerCase().includes(t.toLowerCase())||a.owner&&a.owner.toLowerCase().includes(t.toLowerCase()));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Cost Centers"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Organizational units for cost tracking and allocation"})]}),e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Cost Center"]})]}),e.jsxs(H,{className:"p-6",children:[e.jsxs("div",{className:"mb-6 relative",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search cost centers...",value:t,onChange:a=>r(a.target.value),className:"pl-10"})]}),e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Code"}),e.jsx(se,{children:"Cost Center Name"}),e.jsx(se,{children:"Parent"}),e.jsx(se,{children:"Owner"}),e.jsx(se,{children:"Status"}),e.jsx(se,{})]})}),e.jsx(lr,{children:n.length===0?e.jsx(Qe,{children:e.jsx(J,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No cost centers found"})}):n.map(a=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono font-medium",children:a.code}),e.jsx(J,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($p,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:a.name})]})}),e.jsx(J,{className:"text-sm text-muted-foreground",children:a.parent||"-"}),e.jsx(J,{className:"text-sm",children:a.owner||"-"}),e.jsx(J,{children:e.jsx(Ae,{variant:a.active?"default":"secondary",children:a.active?"Active":"Inactive"})}),e.jsx(J,{children:e.jsx(K,{variant:"ghost",size:"sm",children:"Edit"})})]},a.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{className:"p-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Cost Centers"}),e.jsx("div",{className:"text-3xl font-bold mt-2",children:s.length})]}),e.jsxs(H,{className:"p-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Active"}),e.jsx("div",{className:"text-3xl font-bold mt-2",children:s.filter(a=>a.active).length})]}),e.jsxs(H,{className:"p-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"With Owner"}),e.jsx("div",{className:"text-3xl font-bold mt-2",children:s.filter(a=>a.owner).length})]}),e.jsxs(H,{className:"p-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Parent Centers"}),e.jsx("div",{className:"text-3xl font-bold mt-2",children:s.filter(a=>!a.parent).length})]})]})]})}function wBe(){const[t,r]=A.useState(!1),[s,n]=A.useState({name:"",valid_from:"",valid_to:"",peak_rate:"",offpeak_rate:"",demand_charge:"",currency:"KES"}),a=yr(),{data:o}=it({queryKey:["energy-tariffs"],queryFn:async()=>(await fetch("/api/v1/costing/energy/tariffs")).json()}),c=gt({mutationFn:async p=>{const g=await fetch("/api/v1/costing/energy/tariffs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!g.ok)throw new Error("Failed to create tariff");return g.json()},onSuccess:()=>{a.invalidateQueries({queryKey:["energy-tariffs"]}),r(!1),n({name:"",valid_from:"",valid_to:"",peak_rate:"",offpeak_rate:"",demand_charge:"",currency:"KES"})}}),i=p=>{p.preventDefault(),c.mutate(s)},f=p=>{const g=new Date,y=new Date(p.valid_from),b=p.valid_to?new Date(p.valid_to):null;return y<=g&&(!b||b>=g)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Energy Tariff Setup"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage utility tariff rates for energy cost calculations"})]}),e.jsxs(Qt,{open:t,onOpenChange:r,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Tariff"]})}),e.jsxs(Zt,{className:"max-w-2xl",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Create Energy Tariff"})}),e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(we,{htmlFor:"name",children:"Tariff Name *"}),e.jsx(Ie,{id:"name",value:s.name,onChange:p=>n({...s,name:p.target.value}),placeholder:"e.g., KPLC Industrial Rate 2025",required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"valid_from",children:"Valid From *"}),e.jsx(Ie,{id:"valid_from",type:"date",value:s.valid_from,onChange:p=>n({...s,valid_from:p.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"valid_to",children:"Valid To"}),e.jsx(Ie,{id:"valid_to",type:"date",value:s.valid_to,onChange:p=>n({...s,valid_to:p.target.value})})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"peak_rate",children:"Peak Rate (per kWh) *"}),e.jsx(Ie,{id:"peak_rate",type:"number",step:"0.0001",value:s.peak_rate,onChange:p=>n({...s,peak_rate:p.target.value}),placeholder:"15.80",required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"offpeak_rate",children:"Off-Peak Rate (per kWh) *"}),e.jsx(Ie,{id:"offpeak_rate",type:"number",step:"0.0001",value:s.offpeak_rate,onChange:p=>n({...s,offpeak_rate:p.target.value}),placeholder:"8.50",required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"demand_charge",children:"Demand Charge (per kVA)"}),e.jsx(Ie,{id:"demand_charge",type:"number",step:"0.0001",value:s.demand_charge,onChange:p=>n({...s,demand_charge:p.target.value}),placeholder:"450.00"})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"currency",children:"Currency"}),e.jsx(Ie,{id:"currency",value:s.currency,onChange:p=>n({...s,currency:p.target.value}),placeholder:"KES",maxLength:3})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:c.isPending,children:c.isPending?"Creating...":"Create Tariff"})]})]})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(Ta,{className:"h-5 w-5"}),"Tariff Registry"]})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Tariff Name"}),e.jsx(se,{children:"Peak Rate"}),e.jsx(se,{children:"Off-Peak Rate"}),e.jsx(se,{children:"Demand Charge"}),e.jsx(se,{children:"Valid Period"}),e.jsx(se,{children:"Status"})]})}),e.jsx(lr,{children:o!=null&&o.data&&o.data.length>0?o.data.map(p=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:p.name}),e.jsxs(J,{children:[p.currency," ",parseFloat(p.peak_rate).toFixed(2),"/kWh"]}),e.jsxs(J,{children:[p.currency," ",parseFloat(p.offpeak_rate).toFixed(2),"/kWh"]}),e.jsx(J,{children:p.demand_charge?`${p.currency} ${parseFloat(p.demand_charge).toFixed(2)}/kVA`:"N/A"}),e.jsx(J,{children:e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(wn,{className:"h-3 w-3"}),new Date(p.valid_from).toLocaleDateString(),p.valid_to&&` - ${new Date(p.valid_to).toLocaleDateString()}`]})}),e.jsx(J,{children:f(p)?e.jsx(Ae,{className:"bg-green-100 text-green-700",children:"Active"}):e.jsx(Ae,{className:"bg-gray-100 text-gray-700",children:"Inactive"})})]},p.id)):e.jsx(Qe,{children:e.jsx(J,{colSpan:6,className:"text-center text-muted-foreground",children:"No tariffs configured yet"})})})]})})]})]})}function NBe(){const[t,r]=A.useState(null),[s,n]=A.useState(""),[a,o]=A.useState(null),c=gt({mutationFn:async f=>{const p=await fetch("/api/v1/costing/energy/readings/upload",{method:"POST",body:f});if(!p.ok)throw new Error("Upload failed");return p.json()},onSuccess:f=>{o(f.data),r(null)}}),i=f=>{if(f.preventDefault(),!t||!s)return;const p=new FormData;p.append("file",t),p.append("period_month",s),c.mutate(p)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Energy Readings Upload"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Bulk import energy consumption data from CSV files"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(Bo,{className:"h-5 w-5"}),"Upload CSV File"]})}),e.jsxs(X,{children:[e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"period",children:"Reporting Period *"}),e.jsx(Ie,{id:"period",type:"month",value:s,onChange:f=>n(f.target.value),required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Month and year for the readings"})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"file",children:"CSV File *"}),e.jsx(Ie,{id:"file",type:"file",accept:".csv",onChange:f=>{var p;return r(((p=f.target.files)==null?void 0:p[0])||null)},required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Maximum file size: 10MB"})]}),t&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 border border-blue-200 rounded",children:[e.jsx(Jae,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm text-blue-900",children:t.name}),e.jsxs("span",{className:"text-xs text-blue-600 ml-auto",children:[(t.size/1024).toFixed(2)," KB"]})]}),e.jsx(K,{type:"submit",className:"w-full",disabled:c.isPending,children:c.isPending?"Uploading...":"Upload & Process"})]}),a&&e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs(zn,{className:"border-green-200 bg-green-50",children:[e.jsx(Zl,{className:"h-4 w-4 text-green-600"}),e.jsxs(An,{className:"text-green-800",children:[e.jsx("strong",{children:"Success!"})," Imported ",a.imported," of ",a.total_rows," records"]})]}),a.errors&&a.errors.length>0&&e.jsxs(zn,{className:"border-orange-200 bg-orange-50",children:[e.jsx(Nn,{className:"h-4 w-4 text-orange-600"}),e.jsxs(An,{className:"text-orange-800",children:[e.jsxs("strong",{children:[a.errors.length," errors:"]}),e.jsx("ul",{className:"mt-2 text-xs space-y-1 max-h-32 overflow-y-auto",children:a.errors.slice(0,10).map((f,p)=>e.jsxs("li",{children:[" ",f]},p))})]})]})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"CSV Format Requirements"})}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Required Columns:"}),e.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[e.jsxs("li",{children:[" ",e.jsx("code",{className:"bg-muted px-1 py-0.5 rounded",children:"scheme_name"})," - Scheme identifier"]}),e.jsxs("li",{children:[" ",e.jsx("code",{className:"bg-muted px-1 py-0.5 rounded",children:"kwh"})," - Energy consumption in kWh"]}),e.jsxs("li",{children:[" ",e.jsx("code",{className:"bg-muted px-1 py-0.5 rounded",children:"peak_kwh"})," - Peak period consumption"]}),e.jsxs("li",{children:[" ",e.jsx("code",{className:"bg-muted px-1 py-0.5 rounded",children:"offpeak_kwh"})," - Off-peak consumption"]}),e.jsxs("li",{children:[" ",e.jsx("code",{className:"bg-muted px-1 py-0.5 rounded",children:"demand_kva"})," - Maximum demand"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Sample CSV:"}),e.jsx("pre",{className:"text-xs bg-muted p-3 rounded overflow-x-auto",children:`scheme_name,kwh,peak_kwh,offpeak_kwh,demand_kva
Nairobi Central,125400,75200,50200,850
Mombasa North,98200,58900,39300,720
Kisumu West,45600,27100,18500,390`})]}),e.jsxs(zn,{children:[e.jsx(Nn,{className:"h-4 w-4"}),e.jsx(An,{className:"text-xs",children:"Make sure all numeric values are valid and scheme names match existing records"})]})]})]})]})]})}function SBe(){const{data:t}=it({queryKey:["energy-dashboard"],queryFn:async()=>(await fetch("/api/v1/costing/energy/dashboard")).json()}),{data:r}=it({queryKey:["energy-trend"],queryFn:async()=>(await fetch("/api/v1/costing/energy/specific-energy-trend?months=12")).json()}),s=(t==null?void 0:t.data)||{current_tariff:null,total_consumption_kwh:125400,total_cost:1893600,specific_energy_kwh_m3:.42,cost_per_m3:6.35};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Energy Cost Dashboard"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Energy consumption analytics, specific energy trends, and cost optimization"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total Consumption"}),e.jsx(Ta,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[s.total_consumption_kwh.toLocaleString()," kWh"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This month"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total Cost"}),e.jsx(Ga,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["KES ",s.total_cost.toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Energy expenditure"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Specific Energy"}),e.jsx(Ni,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[s.specific_energy_kwh_m3," kWh/m"]}),e.jsxs("p",{className:"text-xs text-green-600 flex items-center gap-1",children:[e.jsx(ci,{className:"h-3 w-3"}),"Improving efficiency"]})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Cost per m"}),e.jsx(Ga,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["KES ",s.cost_per_m3]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Energy cost allocation"})]})]})]}),e.jsxs(ss,{defaultValue:"specific-energy",className:"w-full",children:[e.jsxs(Yr,{className:"grid w-full grid-cols-2",children:[e.jsx(wt,{value:"specific-energy",children:"Specific Energy Trend"}),e.jsx(wt,{value:"cost-breakdown",children:"Cost Breakdown"})]}),e.jsx(kt,{value:"specific-energy",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Specific Energy (kWh/m) - 12 Month Trend"})}),e.jsx(X,{children:e.jsx(Ha,{width:"100%",height:350,children:e.jsxs(Km,{data:(r==null?void 0:r.data)||[],children:[e.jsx(Zi,{strokeDasharray:"3 3"}),e.jsx(Ma,{dataKey:"month"}),e.jsx(fa,{}),e.jsx(_n,{}),e.jsx(Ea,{}),e.jsx(ui,{type:"monotone",dataKey:"kwh_per_m3",stroke:"#8884d8",name:"kWh/m"})]})})})]})}),e.jsx(kt,{value:"cost-breakdown",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Energy Cost per m - 12 Month Trend"})}),e.jsx(X,{children:e.jsx(Ha,{width:"100%",height:350,children:e.jsxs(tv,{data:(r==null?void 0:r.data)||[],children:[e.jsx(Zi,{strokeDasharray:"3 3"}),e.jsx(Ma,{dataKey:"month"}),e.jsx(fa,{}),e.jsx(_n,{}),e.jsx(Ea,{}),e.jsx(uo,{dataKey:"cost_per_m3",fill:"#82ca9d",name:"Cost per m (KES)"})]})})})]})})]}),s.current_tariff&&e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Current Tariff"})}),e.jsx(X,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Tariff Name"}),e.jsx("p",{className:"font-medium",children:s.current_tariff.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Peak Rate"}),e.jsxs("p",{className:"font-medium",children:[s.current_tariff.currency," ",s.current_tariff.peak_rate,"/kWh"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Off-Peak Rate"}),e.jsxs("p",{className:"font-medium",children:[s.current_tariff.currency," ",s.current_tariff.offpeak_rate,"/kWh"]})]})]})})]})]})}function CBe(){const[t,r]=A.useState(!1),[s,n]=A.useState(""),[a,o]=A.useState(""),[c,i]=A.useState([{description:"",quantity:"",unit:"",unit_cost_estimate:""}]),f=yr(),{data:p}=it({queryKey:["requisitions"],queryFn:async()=>(await fetch("/api/v1/procurement/requisitions")).json()}),g=gt({mutationFn:async C=>{const D=await fetch("/api/v1/procurement/requisitions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)});if(!D.ok)throw new Error("Failed to create requisition");return D.json()},onSuccess:()=>{f.invalidateQueries({queryKey:["requisitions"]}),r(!1),b()}}),y=gt({mutationFn:async C=>{const D=await fetch(`/api/v1/procurement/requisitions/${C}/submit`,{method:"POST"});if(!D.ok)throw new Error("Failed to submit");return D.json()},onSuccess:()=>{f.invalidateQueries({queryKey:["requisitions"]})}}),b=()=>{n(""),o(""),i([{description:"",quantity:"",unit:"",unit_cost_estimate:""}])},w=()=>{i([...c,{description:"",quantity:"",unit:"",unit_cost_estimate:""}])},T=C=>{i(c.filter((D,L)=>L!==C))},N=(C,D,L)=>{const F=[...c];F[C][D]=L,i(F)},M=C=>{C.preventDefault();const D=c.filter(L=>L.description&&L.quantity&&L.unit&&L.unit_cost_estimate);g.mutate({justification:s,required_date:a||null,items:D})},O=C=>{const D={draft:"bg-gray-100 text-gray-700",submitted:"bg-blue-100 text-blue-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700"};return e.jsx(Ae,{className:D[C],children:C})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Purchase Requisitions"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Request procurement of goods and services"})]}),e.jsxs(Qt,{open:t,onOpenChange:r,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Requisition"]})}),e.jsxs(Zt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Create Purchase Requisition"})}),e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"justification",children:"Justification / Purpose *"}),e.jsx(ws,{id:"justification",value:s,onChange:C=>n(C.target.value),placeholder:"Explain why these items are needed...",rows:3,required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"required_date",children:"Required Date"}),e.jsx(Ie,{id:"required_date",type:"date",value:a,onChange:C=>o(C.target.value)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(we,{children:"Items *"}),e.jsxs(K,{type:"button",variant:"outline",size:"sm",onClick:w,children:[e.jsx(Mt,{className:"h-4 w-4 mr-1"}),"Add Item"]})]}),e.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto border rounded-lg p-3",children:c.map((C,D)=>e.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end p-2 bg-muted/30 rounded",children:[e.jsxs("div",{className:"col-span-5",children:[e.jsx(we,{className:"text-xs",children:"Description"}),e.jsx(Ie,{value:C.description,onChange:L=>N(D,"description",L.target.value),placeholder:"Item description",required:!0})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(we,{className:"text-xs",children:"Quantity"}),e.jsx(Ie,{type:"number",step:"0.01",value:C.quantity,onChange:L=>N(D,"quantity",L.target.value),placeholder:"0",required:!0})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(we,{className:"text-xs",children:"Unit"}),e.jsx(Ie,{value:C.unit,onChange:L=>N(D,"unit",L.target.value),placeholder:"pcs, kg, etc",required:!0})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(we,{className:"text-xs",children:"Unit Cost"}),e.jsx(Ie,{type:"number",step:"0.01",value:C.unit_cost_estimate,onChange:L=>N(D,"unit_cost_estimate",L.target.value),placeholder:"0.00",required:!0})]}),e.jsx("div",{className:"col-span-1 flex items-end",children:c.length>1&&e.jsx(K,{type:"button",variant:"ghost",size:"sm",onClick:()=>T(D),children:e.jsx(Ko,{className:"h-4 w-4"})})})]},D))})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:g.isPending,children:g.isPending?"Creating...":"Create Requisition"})]})]})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(jI,{className:"h-5 w-5"}),"Requisition List"]})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Requisition No"}),e.jsx(se,{children:"Requestor"}),e.jsx(se,{children:"Items"}),e.jsx(se,{children:"Total Estimate"}),e.jsx(se,{children:"Required Date"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:p!=null&&p.data&&p.data.length>0?p.data.map(C=>{var D,L;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono",children:C.requisition_no}),e.jsx(J,{children:((D=C.requestor)==null?void 0:D.name)||"N/A"}),e.jsxs(J,{children:[((L=C.items)==null?void 0:L.length)||0," items"]}),e.jsxs(J,{children:["KES ",parseFloat(C.total_estimate).toLocaleString()]}),e.jsx(J,{children:C.required_date?new Date(C.required_date).toLocaleDateString():"N/A"}),e.jsx(J,{children:O(C.status)}),e.jsx(J,{children:C.status==="draft"&&e.jsxs(K,{size:"sm",variant:"outline",onClick:()=>y.mutate(C.id),disabled:y.isPending,children:[e.jsx(jC,{className:"h-3 w-3 mr-1"}),"Submit"]})})]},C.id)}):e.jsx(Qe,{children:e.jsx(J,{colSpan:7,className:"text-center text-muted-foreground",children:"No requisitions yet"})})})]})})]})]})}function PBe(){var N,M,O;const[t,r]=A.useState(!1),[s,n]=A.useState(null),[a,o]=A.useState({title:"",description:"",issue_date:"",submission_deadline:"",items:[{description:"",quantity:"",unit:"",specifications:""}],vendor_ids:[]}),c=yr(),{data:i}=it({queryKey:["rfqs"],queryFn:async()=>(await fetch("/api/v1/procurement/rfqs")).json()}),{data:f}=it({queryKey:["vendors"],queryFn:async()=>(await fetch("/api/v1/procurement/vendors?status=active")).json()}),{data:p}=it({queryKey:["rfq",s],queryFn:async()=>(await fetch(`/api/v1/procurement/rfqs/${s}`)).json(),enabled:!!s}),{data:g}=it({queryKey:["rfq-evaluation",s],queryFn:async()=>(await fetch(`/api/v1/procurement/rfqs/${s}/evaluation-matrix`)).json(),enabled:!!s&&((N=p==null?void 0:p.data)==null?void 0:N.status)==="evaluating"}),y=gt({mutationFn:async C=>{const D=await fetch("/api/v1/procurement/rfqs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)});if(!D.ok)throw new Error("Failed to create RFQ");return D.json()},onSuccess:()=>{c.invalidateQueries({queryKey:["rfqs"]}),r(!1)}}),b=gt({mutationFn:async C=>{const D=await fetch(`/api/v1/procurement/rfqs/${C}/issue`,{method:"POST"});if(!D.ok)throw new Error("Failed to issue RFQ");return D.json()},onSuccess:()=>{c.invalidateQueries({queryKey:["rfqs"]})}}),w=C=>{C.preventDefault(),y.mutate(a)},T=C=>{const D={draft:"bg-gray-100 text-gray-700",issued:"bg-blue-100 text-blue-700",evaluating:"bg-orange-100 text-orange-700",awarded:"bg-green-100 text-green-700"};return e.jsx(Ae,{className:D[C],children:C})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"RFQ Management"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Create RFQs, invite vendors, and evaluate bids"})]}),e.jsxs(Qt,{open:t,onOpenChange:r,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New RFQ"]})}),e.jsxs(Zt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Create Request for Quotation"})}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(we,{htmlFor:"title",children:"RFQ Title *"}),e.jsx(Ie,{id:"title",value:a.title,onChange:C=>o({...a,title:C.target.value}),placeholder:"e.g., Supply of Water Treatment Chemicals",required:!0})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(we,{htmlFor:"description",children:"Description"}),e.jsx(ws,{id:"description",value:a.description,onChange:C=>o({...a,description:C.target.value}),rows:3})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"issue_date",children:"Issue Date *"}),e.jsx(Ie,{id:"issue_date",type:"date",value:a.issue_date,onChange:C=>o({...a,issue_date:C.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"deadline",children:"Submission Deadline *"}),e.jsx(Ie,{id:"deadline",type:"date",value:a.submission_deadline,onChange:C=>o({...a,submission_deadline:C.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Invite Vendors"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2 max-h-32 overflow-y-auto border rounded p-2",children:(M=f==null?void 0:f.data)==null?void 0:M.map(C=>e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:a.vendor_ids.includes(C.id),onChange:D=>{D.target.checked?o({...a,vendor_ids:[...a.vendor_ids,C.id]}):o({...a,vendor_ids:a.vendor_ids.filter(L=>L!==C.id)})}}),C.name]},C.id))})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:y.isPending,children:y.isPending?"Creating...":"Create RFQ"})]})]})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"h-5 w-5"}),"RFQ List"]})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"RFQ No"}),e.jsx(se,{children:"Title"}),e.jsx(se,{children:"Issue Date"}),e.jsx(se,{children:"Deadline"}),e.jsx(se,{children:"Invitations"}),e.jsx(se,{children:"Bids"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:i!=null&&i.data&&i.data.length>0?i.data.map(C=>e.jsxs(Qe,{className:"cursor-pointer",onClick:()=>n(C.id),children:[e.jsx(J,{className:"font-mono",children:C.rfq_no}),e.jsx(J,{className:"font-medium",children:C.title}),e.jsx(J,{children:new Date(C.issue_date).toLocaleDateString()}),e.jsx(J,{children:new Date(C.submission_deadline).toLocaleDateString()}),e.jsx(J,{children:e.jsxs(Ae,{variant:"outline",children:[C.invitations_count||0," vendors"]})}),e.jsx(J,{children:e.jsxs(Ae,{variant:"outline",children:[C.bids_count||0," bids"]})}),e.jsx(J,{children:T(C.status)}),e.jsx(J,{onClick:D=>D.stopPropagation(),children:C.status==="draft"&&e.jsxs(K,{size:"sm",variant:"outline",onClick:()=>b.mutate(C.id),children:[e.jsx(jC,{className:"h-3 w-3 mr-1"}),"Issue"]})})]},C.id)):e.jsx(Qe,{children:e.jsx(J,{colSpan:8,className:"text-center text-muted-foreground",children:"No RFQs yet"})})})]})})]}),(p==null?void 0:p.data)&&e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(jb,{className:"h-5 w-5"}),"RFQ Details: ",p.data.rfq_no]})}),e.jsx(X,{children:e.jsxs(ss,{defaultValue:"overview",children:[e.jsxs(Yr,{children:[e.jsx(wt,{value:"overview",children:"Overview"}),e.jsxs(wt,{value:"bids",children:["Bids (",((O=p.data.bids)==null?void 0:O.length)||0,")"]}),p.data.status==="evaluating"&&e.jsx(wt,{value:"evaluation",children:"Evaluation Matrix"})]}),e.jsxs(kt,{value:"overview",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Title"}),e.jsx("p",{className:"font-medium",children:p.data.title})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),T(p.data.status)]})]}),p.data.description&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Description"}),e.jsx("p",{children:p.data.description})]})]}),e.jsx(kt,{value:"bids",children:p.data.bids&&p.data.bids.length>0?e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Vendor"}),e.jsx(se,{children:"Bid Amount"}),e.jsx(se,{children:"Delivery Days"}),e.jsx(se,{children:"Submitted"})]})}),e.jsx(lr,{children:p.data.bids.map(C=>{var D;return e.jsxs(Qe,{children:[e.jsx(J,{children:(D=C.vendor)==null?void 0:D.name}),e.jsxs(J,{children:["KES ",parseFloat(C.total_bid_amount).toLocaleString()]}),e.jsxs(J,{children:[C.delivery_days," days"]}),e.jsx(J,{children:new Date(C.submitted_at).toLocaleString()})]},C.id)})})]}):e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No bids submitted yet"})}),p.data.status==="evaluating"&&e.jsx(kt,{value:"evaluation",children:g!=null&&g.data&&g.data.length>0?e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Rank"}),e.jsx(se,{children:"Vendor"}),e.jsx(se,{children:"Bid Amount"}),e.jsx(se,{children:"Weighted Score"}),e.jsx(se,{children:"Delivery"})]})}),e.jsx(lr,{children:g.data.map(C=>e.jsxs(Qe,{children:[e.jsx(J,{children:e.jsxs(Ae,{className:C.rank===1?"bg-green-100 text-green-700":"",children:["#",C.rank]})}),e.jsx(J,{className:"font-medium",children:C.vendor_name}),e.jsxs(J,{children:["KES ",parseFloat(C.bid_amount).toLocaleString()]}),e.jsx(J,{children:e.jsxs("div",{className:"font-bold text-blue-600",children:[C.weighted_total,"/100"]})}),e.jsxs(J,{children:[C.delivery_days," days"]})]},C.vendor_id))})]}):e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No evaluations yet"})})]})})]})]})}function kBe(){var M;const[t,r]=A.useState(!1),[s,n]=A.useState(""),[a,o]=A.useState(""),[c,i]=A.useState("Standard payment terms: Net 30 days"),f=yr(),{data:p}=it({queryKey:["lpos"],queryFn:async()=>(await fetch("/api/v1/procurement/lpos")).json()}),{data:g}=it({queryKey:["awarded-rfqs"],queryFn:async()=>(await fetch("/api/v1/procurement/rfqs?status=awarded")).json()}),y=gt({mutationFn:async O=>{const C=await fetch("/api/v1/procurement/lpos/generate-from-rfq",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)});if(!C.ok)throw new Error("Failed to generate LPO");return C.json()},onSuccess:()=>{f.invalidateQueries({queryKey:["lpos"]}),f.invalidateQueries({queryKey:["awarded-rfqs"]}),r(!1),n(""),o("")}}),b=gt({mutationFn:async O=>{const C=await fetch(`/api/v1/procurement/lpos/${O}/approve`,{method:"POST"});if(!C.ok)throw new Error("Failed to approve");return C.json()},onSuccess:()=>{f.invalidateQueries({queryKey:["lpos"]})}}),w=gt({mutationFn:async O=>{const C=await fetch(`/api/v1/procurement/lpos/${O}/issue`,{method:"POST"});if(!C.ok)throw new Error("Failed to issue");return C.json()},onSuccess:()=>{f.invalidateQueries({queryKey:["lpos"]})}}),T=O=>{O.preventDefault(),y.mutate({rfq_id:s,delivery_date:a,terms_conditions:c})},N=O=>{const C={draft:"bg-gray-100 text-gray-700",approved:"bg-blue-100 text-blue-700",issued:"bg-green-100 text-green-700",delivered:"bg-purple-100 text-purple-700",cancelled:"bg-red-100 text-red-700"};return e.jsx(Ae,{className:C[O],children:O})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Local Purchase Orders"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Generate and manage LPOs from awarded RFQs"})]}),e.jsxs(Qt,{open:t,onOpenChange:r,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(bs,{className:"h-4 w-4"}),"Generate from RFQ"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Generate LPO from Awarded RFQ"})}),e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"rfq",children:"Select Awarded RFQ *"}),e.jsxs("select",{id:"rfq",className:"w-full border rounded-md p-2",value:s,onChange:O=>n(O.target.value),required:!0,children:[e.jsx("option",{value:"",children:"-- Select RFQ --"}),(M=g==null?void 0:g.data)==null?void 0:M.map(O=>{var C;return e.jsxs("option",{value:O.id,children:[O.rfq_no," - ",O.title," (Vendor: ",(C=O.awarded_vendor)==null?void 0:C.name,")"]},O.id)})]})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"delivery_date",children:"Expected Delivery Date *"}),e.jsx(Ie,{id:"delivery_date",type:"date",value:a,onChange:O=>o(O.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"terms",children:"Terms & Conditions"}),e.jsx(ws,{id:"terms",value:c,onChange:O=>i(O.target.value),rows:4})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:y.isPending,children:y.isPending?"Generating...":"Generate LPO"})]})]})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"h-5 w-5"}),"LPO List"]})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"LPO No"}),e.jsx(se,{children:"Vendor"}),e.jsx(se,{children:"RFQ Reference"}),e.jsx(se,{children:"Order Date"}),e.jsx(se,{children:"Delivery Date"}),e.jsx(se,{children:"Total Amount"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:p!=null&&p.data&&p.data.length>0?p.data.map(O=>{var C;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono font-medium",children:O.lpo_no}),e.jsx(J,{children:((C=O.vendor)==null?void 0:C.name)||"N/A"}),e.jsx(J,{children:O.rfq?e.jsx("span",{className:"text-sm text-muted-foreground",children:O.rfq.rfq_no}):"Direct"}),e.jsx(J,{children:new Date(O.order_date).toLocaleDateString()}),e.jsx(J,{children:O.delivery_date?new Date(O.delivery_date).toLocaleDateString():"N/A"}),e.jsxs(J,{className:"font-medium",children:["KES ",parseFloat(O.total_amount).toLocaleString()]}),e.jsx(J,{children:N(O.status)}),e.jsx(J,{children:e.jsxs("div",{className:"flex gap-1",children:[O.status==="draft"&&e.jsxs(K,{size:"sm",variant:"outline",onClick:()=>b.mutate(O.id),disabled:b.isPending,children:[e.jsx(Ns,{className:"h-3 w-3 mr-1"}),"Approve"]}),O.status==="approved"&&e.jsxs(K,{size:"sm",variant:"outline",onClick:()=>w.mutate(O.id),disabled:w.isPending,children:[e.jsx(jC,{className:"h-3 w-3 mr-1"}),"Issue"]}),O.status==="issued"&&e.jsxs(K,{size:"sm",variant:"outline",children:[e.jsx(ma,{className:"h-3 w-3 mr-1"}),"PDF"]})]})})]},O.id)}):e.jsx(Qe,{children:e.jsx(J,{colSpan:8,className:"text-center text-muted-foreground",children:"No LPOs yet"})})})]})})]}),e.jsx(H,{className:"bg-blue-50 border-blue-200",children:e.jsxs(X,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"LPO Workflow"}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-blue-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-200 flex items-center justify-center font-bold",children:"1"}),e.jsx("span",{children:"Generate from RFQ"})]}),e.jsx("div",{className:"text-blue-400",children:""}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-200 flex items-center justify-center font-bold",children:"2"}),e.jsx("span",{children:"Approve"})]}),e.jsx("div",{className:"text-blue-400",children:""}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-200 flex items-center justify-center font-bold",children:"3"}),e.jsx("span",{children:"Issue to Vendor"})]}),e.jsx("div",{className:"text-blue-400",children:""}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-200 flex items-center justify-center font-bold",children:"4"}),e.jsx("span",{children:"Track Delivery"})]})]})]})})]})}function ABe(){return e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx(Ti,{}),e.jsx("main",{className:"flex-1 p-8 overflow-auto",children:e.jsx(Ai,{})})]})}function TBe(){return e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx(Ti,{}),e.jsx("main",{className:"flex-1 p-8 overflow-auto",children:e.jsx(Ai,{})})]})}function EBe(){return e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx(Ti,{}),e.jsx("main",{className:"flex-1 p-8 overflow-auto",children:e.jsx(Ai,{})})]})}const Hs="",vm={async getProjects(t){return(await pe.get(`${Hs}/projects`,{params:t})).data},async getProject(t){return(await pe.get(`${Hs}/projects/${t}`)).data},async createProject(t){return(await pe.post(`${Hs}/projects`,t)).data},async updateProject(t,r){return(await pe.patch(`${Hs}/projects/${t}`,r)).data},async deleteProject(t){await pe.delete(`${Hs}/projects/${t}`)},async getProjectDashboard(){return(await pe.get(`${Hs}/projects/dashboard`)).data},async getPipelines(t){return(await pe.get(`${Hs}/investments`,{params:t})).data},async getPipeline(t){return(await pe.get(`${Hs}/investments/${t}`)).data},async createPipeline(t){return(await pe.post(`${Hs}/investments`,t)).data},async updatePipeline(t,r){return(await pe.patch(`${Hs}/investments/${t}`,r)).data},async deletePipeline(t){await pe.delete(`${Hs}/investments/${t}`)},async scorePipeline(t,r,s,n,a){return(await pe.post(`${Hs}/investments/${t}/score`,{criterion_id:r,raw_score:s,weighted_score:n,rationale:a})).data},async getPipelineScores(t){return(await pe.get(`${Hs}/investments/${t}/scores`)).data},async createAppraisal(t,r){return(await pe.post(`${Hs}/investments/${t}/appraisal`,r)).data},async getPipelineAppraisals(t){return(await pe.get(`${Hs}/investments/${t}/appraisals`)).data},async convertToProject(t){return(await pe.post(`${Hs}/investments/${t}/convert`)).data},async getLandParcels(t){return(await pe.get(`${Hs}/land`,{params:t})).data},async getLandParcel(t){return(await pe.get(`${Hs}/land/${t}`)).data},async createLandParcel(t){return(await pe.post(`${Hs}/land`,t)).data},async updateLandParcel(t,r){return(await pe.patch(`${Hs}/land/${t}`,r)).data},async deleteLandParcel(t){await pe.delete(`${Hs}/land/${t}`)},async getLandParcelsInBounds(t){return(await pe.get(`${Hs}/land/in-bounds`,{params:t})).data},async getLandDashboard(){return(await pe.get(`${Hs}/land/dashboard`)).data},async createWayleave(t,r){return(await pe.post(`${Hs}/land/${t}/wayleaves`,r)).data},async updateWayleave(t,r,s){return(await pe.patch(`${Hs}/land/${t}/wayleaves/${r}`,s)).data},async deleteWayleave(t,r){await pe.delete(`${Hs}/land/${t}/wayleaves/${r}`)},async createCompensation(t,r){return(await pe.post(`${Hs}/land/${t}/compensations`,r)).data},async updateCompensation(t,r,s){return(await pe.patch(`${Hs}/land/${t}/compensations/${r}`,s)).data},async updateCompensationPayment(t,r,s){return(await pe.patch(`${Hs}/land/${t}/compensations/${r}/payment`,s)).data},async deleteCompensation(t,r){await pe.delete(`${Hs}/land/${t}/compensations/${r}`)},async createDispute(t,r){return(await pe.post(`${Hs}/land/${t}/disputes`,r)).data},async updateDispute(t,r,s){return(await pe.patch(`${Hs}/land/${t}/disputes/${r}`,s)).data},async deleteDispute(t,r){await pe.delete(`${Hs}/land/${t}/disputes/${r}`)}};function MBe(){const{data:t}=it({queryKey:["projects-dashboard"],queryFn:()=>vm.getProjectDashboard()}),r=t||{active_projects:0,total_budget:0,avg_physical_progress:0,delayed_projects:0};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Capital Projects"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Infrastructure development and capital investment tracking"})]}),e.jsx(Pn,{to:"/projects/list",children:e.jsxs(K,{children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"New Project"]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Active Projects"}),e.jsx(vS,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.active_projects}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"In execution phase"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total Budget"}),e.jsx(Ga,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["KES ",(r.total_budget/1e6).toFixed(1),"M"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all active projects"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Avg Progress"}),e.jsx(zs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[r.avg_physical_progress,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Physical completion"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Delayed"}),e.jsx(wn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:r.delayed_projects}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Behind schedule"})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(H,{className:"hover:border-primary transition-colors",children:[e.jsxs(ue,{children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(vS,{className:"h-5 w-5"}),"Projects Registry"]}),e.jsx(mr,{children:"Manage capital projects with progress tracking"})]}),e.jsx(X,{children:e.jsx(Pn,{to:"/projects/list",children:e.jsxs(K,{variant:"outline",className:"w-full gap-2",children:["View Projects ",e.jsx(qf,{className:"h-4 w-4"})]})})})]}),e.jsxs(H,{className:"hover:border-primary transition-colors",children:[e.jsxs(ue,{children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(zs,{className:"h-5 w-5"}),"Investment Pipelines"]}),e.jsx(mr,{children:"Prioritize and appraise capital investments"})]}),e.jsx(X,{children:e.jsx(Pn,{to:"/projects/pipelines",children:e.jsxs(K,{variant:"outline",className:"w-full gap-2",children:["View Pipelines ",e.jsx(qf,{className:"h-4 w-4"})]})})})]}),e.jsxs(H,{className:"hover:border-primary transition-colors",children:[e.jsxs(ue,{children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(jd,{className:"h-5 w-5"}),"Land Administration"]}),e.jsx(mr,{children:"Parcels, wayleaves, and compensation"})]}),e.jsx(X,{children:e.jsx(Pn,{to:"/projects/land",children:e.jsxs(K,{variant:"outline",className:"w-full gap-2",children:["View Land ",e.jsx(qf,{className:"h-4 w-4"})]})})})]}),e.jsxs(H,{className:"hover:border-primary transition-colors",children:[e.jsxs(ue,{children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(Bi,{className:"h-5 w-5"}),"Hydraulic Models"]}),e.jsx(mr,{children:"EPANET/InfoWater model library"})]}),e.jsx(X,{children:e.jsx(Pn,{to:"/projects/models",children:e.jsxs(K,{variant:"outline",className:"w-full gap-2",children:["View Models ",e.jsx(qf,{className:"h-4 w-4"})]})})})]}),e.jsxs(H,{className:"hover:border-primary transition-colors",children:[e.jsxs(ue,{children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(zo,{className:"h-5 w-5"}),"Asset Handover"]}),e.jsx(mr,{children:"Capitalization and warranty tracking"})]}),e.jsx(X,{children:e.jsx(Pn,{to:"/projects/handover",children:e.jsxs(K,{variant:"outline",className:"w-full gap-2",children:["View Handovers ",e.jsx(qf,{className:"h-4 w-4"})]})})})]})]})]})}const OBe={planning:"bg-gray-100 text-gray-800",tendering:"bg-blue-100 text-blue-800",execution:"bg-green-100 text-green-800",suspended:"bg-orange-100 text-orange-800",completed:"bg-purple-100 text-purple-800",closed:"bg-slate-100 text-slate-800"};function IBe(){const t=yr(),[r,s]=A.useState(""),[n,a]=A.useState(!1),[o,c]=A.useState({title:"",description:"",baseline_budget:"",baseline_start_date:"",baseline_end_date:""}),{data:i}=it({queryKey:["projects-dashboard"],queryFn:()=>vm.getProjectDashboard()}),{data:f,isLoading:p}=it({queryKey:["projects"],queryFn:()=>vm.getProjects()}),g=gt({mutationFn:T=>vm.createProject(T),onSuccess:()=>{Me.success("Project created successfully"),t.invalidateQueries({queryKey:["projects"]}),t.invalidateQueries({queryKey:["projects-dashboard"]}),a(!1),c({title:"",description:"",baseline_budget:"",baseline_start_date:"",baseline_end_date:""})},onError:T=>Me.error(T.message||"Failed to create project")}),y=f||[],b=i||{active_projects:0,total_budget:0,avg_physical_progress:0,delayed_projects:0},w=y.filter(T=>T.title.toLowerCase().includes(r.toLowerCase())||T.code.toLowerCase().includes(r.toLowerCase()));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Projects Registry"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage capital projects and track progress"})]}),e.jsxs(Qt,{open:n,onOpenChange:a,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Project"]})}),e.jsxs(Zt,{className:"max-w-lg",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Create New Project"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Project Title *"}),e.jsx(Ie,{placeholder:"e.g., Pipeline Extension Phase 2",value:o.title,onChange:T=>c({...o,title:T.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx(Ie,{placeholder:"Brief project description",value:o.description,onChange:T=>c({...o,description:T.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Baseline Budget (KES) *"}),e.jsx(Ie,{type:"number",placeholder:"15000000",value:o.baseline_budget,onChange:T=>c({...o,baseline_budget:T.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Start Date"}),e.jsx(Ie,{type:"date",value:o.baseline_start_date,onChange:T=>c({...o,baseline_start_date:T.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"End Date"}),e.jsx(Ie,{type:"date",value:o.baseline_end_date,onChange:T=>c({...o,baseline_end_date:T.target.value})})]})]}),e.jsx(K,{onClick:()=>g.mutate({title:o.title,description:o.description,baseline_budget:parseInt(o.baseline_budget),baseline_start_date:o.baseline_start_date,baseline_end_date:o.baseline_end_date}),disabled:!o.title||!o.baseline_budget||g.isPending,className:"w-full",children:g.isPending?"Creating...":"Create Project"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(vS,{className:"h-4 w-4"})," Active Projects"]})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:b.active_projects})})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(zs,{className:"h-4 w-4"})," Total Budget"]})}),e.jsx(X,{children:e.jsxs("div",{className:"text-3xl font-bold",children:["KES ",(b.total_budget/1e6).toFixed(1),"M"]})})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsx(he,{className:"text-sm font-medium",children:"Avg Physical Progress"})}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-3xl font-bold",children:[b.avg_physical_progress,"%"]}),e.jsx(Wi,{value:b.avg_physical_progress,className:"mt-2"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Fr,{className:"h-4 w-4 text-orange-500"})," Delayed"]})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold text-orange-600",children:b.delayed_projects})})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(he,{children:"All Projects"}),e.jsxs("div",{className:"relative w-72",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search projects...",value:r,onChange:T=>s(T.target.value),className:"pl-10"})]})]})}),e.jsx(X,{children:p?e.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"Loading projects..."}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Code"}),e.jsx(se,{children:"Title"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Budget"}),e.jsx(se,{children:"Physical %"}),e.jsx(se,{children:"Financial %"}),e.jsx(se,{children:"Timeline"})]})}),e.jsx(lr,{children:w.length===0?e.jsx(Qe,{children:e.jsx(J,{colSpan:7,className:"text-center text-muted-foreground",children:"No projects found"})}):w.map(T=>e.jsxs(Qe,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>window.location.href=`/projects/${T.id}`,children:[e.jsx(J,{className:"font-mono text-sm",children:T.code}),e.jsx(J,{className:"font-medium max-w-xs truncate",children:e.jsx(Pn,{to:`/projects/${T.id}`,className:"hover:text-primary hover:underline",children:T.title})}),e.jsx(J,{children:e.jsx(Ae,{className:OBe[T.status],children:T.status})}),e.jsxs(J,{children:["KES ",(T.baseline_budget/1e6).toFixed(1),"M"]}),e.jsx(J,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Wi,{value:T.physical_progress,className:"w-16 h-2"}),e.jsxs("span",{className:"text-sm",children:[T.physical_progress,"%"]})]})}),e.jsx(J,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Wi,{value:T.financial_progress,className:"w-16 h-2"}),e.jsxs("span",{className:"text-sm",children:[T.financial_progress,"%"]})]})}),e.jsxs(J,{className:"text-xs text-muted-foreground",children:[T.baseline_start_date,"  ",T.baseline_end_date]})]},T.id))})]})})]})]})}const DBe={planning:"bg-gray-100 text-gray-800",tendering:"bg-blue-100 text-blue-800",execution:"bg-green-100 text-green-800",suspended:"bg-orange-100 text-orange-800",completed:"bg-purple-100 text-purple-800",closed:"bg-slate-100 text-slate-800"},O8={pending:"bg-gray-100 text-gray-800",in_progress:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",delayed:"bg-red-100 text-red-800"},RBe={open:"bg-red-100 text-red-800",monitoring:"bg-yellow-100 text-yellow-800",mitigated:"bg-green-100 text-green-800",closed:"bg-gray-100 text-gray-800"},LBe={critical:"bg-red-600 text-white",high:"bg-red-100 text-red-800",medium:"bg-yellow-100 text-yellow-800",low:"bg-green-100 text-green-800"};function FBe(){const{id:t}=xC(),r=yr(),[s,n]=A.useState("overview"),[a,o]=A.useState(!1),[c,i]=A.useState(!1),[f,p]=A.useState(!1),[g,y]=A.useState({name:"",description:"",planned_date:"",weight:""}),[b,w]=A.useState({title:"",description:"",category:"technical",probability:"medium",impact:"medium",mitigation:"",owner:""}),[T,N]=A.useState({title:"",description:"",category:"technical",priority:"medium",assigned_to:""}),{data:M,isLoading:O}=it({queryKey:["project",t],queryFn:async()=>(await pe.get(`/projects/${t}`)).data,enabled:!!t}),{data:C}=it({queryKey:["project-milestones",t],queryFn:async()=>(await pe.get(`/projects/${t}/milestones`)).data,enabled:!!t}),{data:D}=it({queryKey:["project-procurement",t],queryFn:async()=>(await pe.get(`/projects/${t}/procurement`)).data,enabled:!!t}),{data:L}=it({queryKey:["project-risks",t],queryFn:async()=>(await pe.get(`/projects/${t}/risks`)).data,enabled:!!t}),{data:F}=it({queryKey:["project-issues",t],queryFn:async()=>(await pe.get(`/projects/${t}/issues`)).data,enabled:!!t}),{data:B}=it({queryKey:["project-documents",t],queryFn:async()=>(await pe.get(`/projects/${t}/documents`)).data,enabled:!!t}),{data:U}=it({queryKey:["project-communications",t],queryFn:async()=>(await pe.get(`/projects/${t}/communications`)).data,enabled:!!t}),te=gt({mutationFn:async ae=>(await pe.post(`/projects/${t}/milestones`,ae)).data,onSuccess:()=>{Me.success("Milestone added successfully"),r.invalidateQueries({queryKey:["project-milestones",t]}),o(!1),y({name:"",description:"",planned_date:"",weight:""})},onError:()=>Me.error("Failed to add milestone")}),Q=gt({mutationFn:async ae=>(await pe.post(`/projects/${t}/risks`,ae)).data,onSuccess:()=>{Me.success("Risk registered successfully"),r.invalidateQueries({queryKey:["project-risks",t]}),i(!1),w({title:"",description:"",category:"technical",probability:"medium",impact:"medium",mitigation:"",owner:""})},onError:()=>Me.error("Failed to register risk")}),re=gt({mutationFn:async ae=>(await pe.post(`/projects/${t}/issues`,ae)).data,onSuccess:()=>{Me.success("Issue logged successfully"),r.invalidateQueries({queryKey:["project-issues",t]}),p(!1),N({title:"",description:"",category:"technical",priority:"medium",assigned_to:""})},onError:()=>Me.error("Failed to log issue")});if(O)return e.jsx("div",{className:"flex items-center justify-center h-64",children:"Loading project details..."});if(!M)return e.jsx("div",{className:"text-center py-10",children:"Project not found"});const Z=ae=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",maximumFractionDigits:0}).format(ae),ne=(C||[]).filter(ae=>ae.status==="completed").length,oe=(C||[]).length,Ce=oe>0?Math.round(ne/oe*100):0,Pe=(L||[]).filter(ae=>ae.status==="open"||ae.status==="monitoring").length,Se=(F||[]).filter(ae=>ae.status!=="resolved").length;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsx(Pn,{to:"/projects",children:e.jsxs(K,{variant:"ghost",size:"sm",children:[e.jsx(vb,{className:"h-4 w-4 mr-2"}),"Back to Projects"]})})}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-3xl font-bold",children:M.title}),e.jsx(Ae,{className:DBe[M.status]||"bg-gray-100",children:M.status})]}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:[M.code," | ",M.description]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{variant:"outline",children:"Edit Project"}),e.jsx(K,{children:"Generate Report"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Ga,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Budget"}),e.jsx("p",{className:"text-xl font-bold",children:Z(M.baseline_budget)}),M.revised_budget&&e.jsxs("p",{className:"text-xs text-orange-600",children:["Revised: ",Z(M.revised_budget)]})]})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(zs,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Physical Progress"}),e.jsxs("p",{className:"text-xl font-bold",children:[M.physical_progress,"%"]}),e.jsx(Wi,{value:M.physical_progress,className:"h-1 mt-1"})]})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(pm,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Milestones"}),e.jsxs("p",{className:"text-xl font-bold",children:[ne,"/",oe]}),e.jsx(Wi,{value:Ce,className:"h-1 mt-1"})]})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(Fr,{className:"h-5 w-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Open Risks/Issues"}),e.jsxs("p",{className:"text-xl font-bold",children:[Pe," / ",Se]})]})]})})})]}),e.jsxs(ss,{value:s,onValueChange:n,children:[e.jsxs(Yr,{className:"grid w-full grid-cols-6",children:[e.jsx(wt,{value:"overview",children:"Overview"}),e.jsx(wt,{value:"milestones",children:"Milestones"}),e.jsx(wt,{value:"procurement",children:"Procurement"}),e.jsx(wt,{value:"risks",children:"Risks & Issues"}),e.jsx(wt,{value:"documents",children:"Documents"}),e.jsx(wt,{value:"communications",children:"Communications"})]}),e.jsxs(kt,{value:"overview",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-lg",children:"Project Timeline"})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Baseline Start"}),e.jsx("span",{className:"font-medium",children:M.baseline_start_date||"Not set"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Baseline End"}),e.jsx("span",{className:"font-medium",children:M.baseline_end_date||"Not set"})]}),M.actual_start_date&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Actual Start"}),e.jsx("span",{className:"font-medium",children:M.actual_start_date})]}),M.revised_end_date&&e.jsxs("div",{className:"flex justify-between text-orange-600",children:[e.jsx("span",{children:"Revised End"}),e.jsx("span",{className:"font-medium",children:M.revised_end_date})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-lg",children:"Financial Summary"})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Baseline Budget"}),e.jsx("span",{className:"font-medium",children:Z(M.baseline_budget)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Financial Progress"}),e.jsxs("span",{className:"font-medium",children:[M.financial_progress,"%"]})]}),e.jsx(Wi,{value:M.financial_progress,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Spent"}),e.jsx("span",{children:Z(M.baseline_budget*M.financial_progress/100)})]})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-lg",children:"Recent Milestones"})}),e.jsx(X,{children:e.jsx("div",{className:"space-y-3",children:(C||[]).slice(0,5).map(ae=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[ae.status==="completed"?e.jsx(Zl,{className:"h-5 w-5 text-green-600"}):ae.status==="in_progress"?e.jsx($s,{className:"h-5 w-5 text-blue-600"}):e.jsx(ec,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:ae.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:ae.planned_date})]})]}),e.jsx(Ae,{className:O8[ae.status]||"bg-gray-100",children:ae.status})]},ae.id))})})]})]}),e.jsxs(kt,{value:"milestones",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Project Milestones"}),e.jsxs(Qt,{open:a,onOpenChange:o,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{size:"sm",children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Add Milestone"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Add New Milestone"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Milestone Name *"}),e.jsx(Ie,{value:g.name,onChange:ae=>y({...g,name:ae.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx(Ie,{value:g.description,onChange:ae=>y({...g,description:ae.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Planned Date *"}),e.jsx(Ie,{type:"date",value:g.planned_date,onChange:ae=>y({...g,planned_date:ae.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Weight (%)"}),e.jsx(Ie,{type:"number",value:g.weight,onChange:ae=>y({...g,weight:ae.target.value})})]})]}),e.jsx(K,{onClick:()=>te.mutate(g),disabled:!g.name||!g.planned_date,children:"Add Milestone"})]})]})]})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Milestone"}),e.jsx(se,{children:"Planned Date"}),e.jsx(se,{children:"Actual Date"}),e.jsx(se,{children:"Weight"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Deliverables"})]})}),e.jsx(lr,{children:(C||[]).map(ae=>e.jsxs(Qe,{children:[e.jsx(J,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:ae.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:ae.description})]})}),e.jsx(J,{children:ae.planned_date}),e.jsx(J,{children:ae.actual_date||"-"}),e.jsxs(J,{children:[ae.weight,"%"]}),e.jsx(J,{children:e.jsx(Ae,{className:O8[ae.status]||"bg-gray-100",children:ae.status})}),e.jsx(J,{className:"max-w-[200px] truncate",children:ae.deliverables||"-"})]},ae.id))})]})})})]}),e.jsxs(kt,{value:"procurement",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Procurement & Contracts"}),e.jsxs(K,{size:"sm",children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"New Tender"]})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Tender No."}),e.jsx(se,{children:"Title"}),e.jsx(se,{children:"Method"}),e.jsx(se,{children:"Est. Value"}),e.jsx(se,{children:"Contract Value"}),e.jsx(se,{children:"Contractor"}),e.jsx(se,{children:"Status"})]})}),e.jsx(lr,{children:(D||[]).map(ae=>{var be;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:ae.tender_no}),e.jsx(J,{children:ae.title}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:(be=ae.method)==null?void 0:be.replace("_"," ")})}),e.jsx(J,{children:Z(ae.estimated_value)}),e.jsx(J,{children:ae.contract_value?Z(ae.contract_value):"-"}),e.jsx(J,{children:ae.contractor||"-"}),e.jsx(J,{children:e.jsx(Ae,{className:ae.status==="completed"?"bg-green-100 text-green-800":ae.status==="in_progress"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800",children:ae.status})})]},ae.id)})})]})})})]}),e.jsx(kt,{value:"risks",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Risk Register"}),e.jsxs(Qt,{open:c,onOpenChange:i,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{size:"sm",children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Add Risk"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Register New Risk"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Risk Title *"}),e.jsx(Ie,{value:b.title,onChange:ae=>w({...b,title:ae.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx(Ie,{value:b.description,onChange:ae=>w({...b,description:ae.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Category"}),e.jsxs(Nt,{value:b.category,onValueChange:ae=>w({...b,category:ae}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"technical",children:"Technical"}),e.jsx(ge,{value:"cost",children:"Cost"}),e.jsx(ge,{value:"schedule",children:"Schedule"}),e.jsx(ge,{value:"regulatory",children:"Regulatory"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Probability"}),e.jsxs(Nt,{value:b.probability,onValueChange:ae=>w({...b,probability:ae}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"low",children:"Low"}),e.jsx(ge,{value:"medium",children:"Medium"}),e.jsx(ge,{value:"high",children:"High"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Impact"}),e.jsxs(Nt,{value:b.impact,onValueChange:ae=>w({...b,impact:ae}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"low",children:"Low"}),e.jsx(ge,{value:"medium",children:"Medium"}),e.jsx(ge,{value:"high",children:"High"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Mitigation Strategy"}),e.jsx(Ie,{value:b.mitigation,onChange:ae=>w({...b,mitigation:ae.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Risk Owner"}),e.jsx(Ie,{value:b.owner,onChange:ae=>w({...b,owner:ae.target.value})})]}),e.jsx(K,{onClick:()=>Q.mutate(b),disabled:!b.title,children:"Register Risk"})]})]})]})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6 space-y-3",children:(L||[]).map(ae=>e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[ae.risk_no,": ",ae.title]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:ae.description})]}),e.jsx(Ae,{className:RBe[ae.status]||"bg-gray-100",children:ae.status})]}),e.jsxs("div",{className:"flex gap-4 mt-2 text-sm",children:[e.jsxs("span",{children:["Score: ",e.jsx("strong",{children:ae.risk_score})]}),e.jsxs("span",{children:["Owner: ",ae.owner]})]})]},ae.id))})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Issue Tracker"}),e.jsxs(Qt,{open:f,onOpenChange:p,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{size:"sm",children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Log Issue"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Log New Issue"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Issue Title *"}),e.jsx(Ie,{value:T.title,onChange:ae=>N({...T,title:ae.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx(Ie,{value:T.description,onChange:ae=>N({...T,description:ae.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Category"}),e.jsxs(Nt,{value:T.category,onValueChange:ae=>N({...T,category:ae}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"technical",children:"Technical"}),e.jsx(ge,{value:"procurement",children:"Procurement"}),e.jsx(ge,{value:"quality",children:"Quality"}),e.jsx(ge,{value:"safety",children:"Safety"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Priority"}),e.jsxs(Nt,{value:T.priority,onValueChange:ae=>N({...T,priority:ae}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"low",children:"Low"}),e.jsx(ge,{value:"medium",children:"Medium"}),e.jsx(ge,{value:"high",children:"High"}),e.jsx(ge,{value:"critical",children:"Critical"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Assigned To"}),e.jsx(Ie,{value:T.assigned_to,onChange:ae=>N({...T,assigned_to:ae.target.value})})]}),e.jsx(K,{onClick:()=>re.mutate(T),disabled:!T.title,children:"Log Issue"})]})]})]})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6 space-y-3",children:(F||[]).map(ae=>e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[ae.issue_no,": ",ae.title]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:ae.description})]}),e.jsx(Ae,{className:LBe[ae.priority]||"bg-gray-100",children:ae.priority})]}),e.jsxs("div",{className:"flex gap-4 mt-2 text-sm",children:[e.jsxs("span",{children:["Status: ",e.jsx("strong",{children:ae.status})]}),e.jsxs("span",{children:["Assigned: ",ae.assigned_to]})]})]},ae.id))})})]})]})}),e.jsxs(kt,{value:"documents",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Document Repository"}),e.jsxs(K,{size:"sm",children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Upload Document"]})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Document"}),e.jsx(se,{children:"Category"}),e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Version"}),e.jsx(se,{children:"Uploaded By"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Date"})]})}),e.jsx(lr,{children:(B||[]).map(ae=>{var be;return e.jsxs(Qe,{children:[e.jsx(J,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:ae.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:ae.doc_no})]})]})}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:ae.category})}),e.jsx(J,{children:(be=ae.file_type)==null?void 0:be.toUpperCase()}),e.jsxs(J,{children:["v",ae.version]}),e.jsx(J,{children:ae.uploaded_by}),e.jsx(J,{children:e.jsx(Ae,{className:ae.status==="approved"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:ae.status})}),e.jsx(J,{children:ae.created_at})]},ae.id)})})]})})})]}),e.jsxs(kt,{value:"communications",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Stakeholder Communications"}),e.jsxs(K,{size:"sm",children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"New Communication"]})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6 space-y-4",children:(U||[]).map(ae=>{var be,de;return e.jsx("div",{className:"p-4 border rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ki,{className:"h-5 w-5 text-muted-foreground mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:ae.subject}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:ae.message}),e.jsxs("div",{className:"flex gap-4 mt-2 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["From: ",ae.sender]}),e.jsxs("span",{children:["To: ",(be=ae.recipients)==null?void 0:be.join(", ")]}),e.jsx("span",{children:ae.sent_date})]})]})]}),e.jsx(Ae,{variant:"outline",children:(de=ae.comm_type)==null?void 0:de.replace("_"," ")})]})},ae.id)})})})]})]})]})}const $Be={active:"bg-blue-100 text-blue-800",shortlisted:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",converted:"bg-purple-100 text-purple-800"};function zBe(){const t=yr(),[r,s]=A.useState(!1),[n,a]=A.useState(null),[o,c]=A.useState({title:"",description:"",estimated_cost:"",connections_added:"",nrw_reduction:""}),{data:i,isLoading:f}=it({queryKey:["pipelines"],queryFn:()=>vm.getPipelines()}),p=gt({mutationFn:w=>vm.createPipeline(w),onSuccess:()=>{Me.success("Investment pipeline created"),t.invalidateQueries({queryKey:["pipelines"]}),s(!1),c({title:"",description:"",estimated_cost:"",connections_added:"",nrw_reduction:""})}}),g=gt({mutationFn:w=>vm.convertToProject(w),onSuccess:()=>{Me.success("Pipeline converted to project"),t.invalidateQueries({queryKey:["pipelines"]}),t.invalidateQueries({queryKey:["projects"]}),a(null)}}),y=i||[],b={total:y.length,totalCost:y.reduce((w,T)=>w+T.estimated_cost,0),approved:y.filter(w=>w.status==="approved").length,avgBcr:y.filter(w=>w.bcr).reduce((w,T)=>w+(T.bcr||0),0)/y.filter(w=>w.bcr).length||0};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Investment Pipelines"}),e.jsx("p",{className:"text-muted-foreground",children:"Prioritize and appraise capital investments"})]}),e.jsxs(Qt,{open:r,onOpenChange:s,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Pipeline"]})}),e.jsxs(Zt,{className:"max-w-lg",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Create Investment Pipeline"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Investment Title *"}),e.jsx(Ie,{placeholder:"e.g., Smart Meter Rollout Phase 3",value:o.title,onChange:w=>c({...o,title:w.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx(Ie,{placeholder:"Brief description of the investment",value:o.description,onChange:w=>c({...o,description:w.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Estimated Cost (KES) *"}),e.jsx(Ie,{type:"number",placeholder:"50000000",value:o.estimated_cost,onChange:w=>c({...o,estimated_cost:w.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Connections Added"}),e.jsx(Ie,{type:"number",placeholder:"5000",value:o.connections_added,onChange:w=>c({...o,connections_added:w.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"NRW Reduction %"}),e.jsx(Ie,{type:"number",placeholder:"10",value:o.nrw_reduction,onChange:w=>c({...o,nrw_reduction:w.target.value})})]})]}),e.jsx(K,{onClick:()=>p.mutate({title:o.title,description:o.description,estimated_cost:parseInt(o.estimated_cost)}),disabled:!o.title||!o.estimated_cost||p.isPending,className:"w-full",children:p.isPending?"Creating...":"Create Pipeline"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(pm,{className:"h-4 w-4"})," Total Pipelines"]})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:b.total})})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ga,{className:"h-4 w-4"})," Total Investment"]})}),e.jsx(X,{children:e.jsxs("div",{className:"text-3xl font-bold",children:["KES ",(b.totalCost/1e6).toFixed(0),"M"]})})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsx(he,{className:"text-sm font-medium",children:"Approved"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold text-green-600",children:b.approved})})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ZE,{className:"h-4 w-4"})," Avg BCR"]})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:b.avgBcr.toFixed(2)})})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Investment Pipeline Registry"})}),e.jsx(X,{children:f?e.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"Loading pipelines..."}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Code"}),e.jsx(se,{children:"Title"}),e.jsx(se,{children:"Est. Cost"}),e.jsx(se,{children:"BCR"}),e.jsx(se,{children:"NPV"}),e.jsx(se,{children:"IRR"}),e.jsx(se,{children:"Priority"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:y.length===0?e.jsx(Qe,{children:e.jsx(J,{colSpan:9,className:"text-center text-muted-foreground",children:"No pipelines found"})}):y.map(w=>{var T;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono text-sm",children:w.code}),e.jsx(J,{className:"font-medium max-w-xs truncate",children:w.title}),e.jsxs(J,{children:["KES ",(w.estimated_cost/1e6).toFixed(0),"M"]}),e.jsx(J,{children:e.jsx("span",{className:w.bcr&&w.bcr>=1.5?"text-green-600 font-semibold":"",children:((T=w.bcr)==null?void 0:T.toFixed(2))||"-"})}),e.jsx(J,{children:w.npv?`KES ${(w.npv/1e6).toFixed(0)}M`:"-"}),e.jsx(J,{children:w.irr?`${w.irr}%`:"-"}),e.jsx(J,{children:w.priority_score?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Wi,{value:w.priority_score,className:"w-12 h-2"}),e.jsx("span",{className:"text-sm",children:w.priority_score})]}):"-"}),e.jsx(J,{children:e.jsx(Ae,{className:$Be[w.status],children:w.status})}),e.jsx(J,{children:w.status==="approved"&&e.jsxs(K,{size:"sm",variant:"outline",className:"gap-1",onClick:()=>g.mutate(w.id),disabled:g.isPending,children:[e.jsx(qf,{className:"h-3 w-3"}),"Convert"]})})]},w.id)})})]})})]})]})}const BBe={identified:"bg-gray-100 text-gray-800",valuation:"bg-blue-100 text-blue-800",negotiation:"bg-yellow-100 text-yellow-800",acquired:"bg-green-100 text-green-800",disputed:"bg-red-100 text-red-800",active:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",expired:"bg-gray-100 text-gray-800"};function qBe(){const t=yr(),[r,s]=A.useState(!1),[n,a]=A.useState({ref_no:"",owner_name:"",area_ha:"",county:""}),{data:o}=it({queryKey:["land-dashboard"],queryFn:async()=>(await fetch("/api/land/dashboard")).json()}),{data:c,isLoading:i}=it({queryKey:["land-parcels"],queryFn:()=>vm.getLandParcels()}),f=gt({mutationFn:async y=>(await fetch("/api/land",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)})).json(),onSuccess:()=>{Me.success("Land parcel registered"),t.invalidateQueries({queryKey:["land-parcels"]}),t.invalidateQueries({queryKey:["land-dashboard"]}),s(!1),a({ref_no:"",owner_name:"",area_ha:"",county:""})}}),p=c||[],g=o||{total_parcels:0,acquired:0,disputed:0,active_wayleaves:0,expiring_wayleaves:0,total_compensation_paid:0};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Land & Wayleave Administration"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage parcels, wayleaves, and compensation"})]}),e.jsxs(Qt,{open:r,onOpenChange:s,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"Register Parcel"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Register Land Parcel"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Reference Number *"}),e.jsx(Ie,{placeholder:"e.g., LND-004",value:n.ref_no,onChange:y=>a({...n,ref_no:y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Owner Name *"}),e.jsx(Ie,{placeholder:"Land owner name",value:n.owner_name,onChange:y=>a({...n,owner_name:y.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Area (Hectares)"}),e.jsx(Ie,{type:"number",step:"0.1",placeholder:"2.5",value:n.area_ha,onChange:y=>a({...n,area_ha:y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"County"}),e.jsx(Ie,{placeholder:"Nairobi",value:n.county,onChange:y=>a({...n,county:y.target.value})})]})]}),e.jsx(K,{onClick:()=>f.mutate({ref_no:n.ref_no,owner_name:n.owner_name,area_ha:parseFloat(n.area_ha),county:n.county}),disabled:!n.ref_no||!n.owner_name||f.isPending,className:"w-full",children:f.isPending?"Registering...":"Register Parcel"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(fn,{className:"h-4 w-4"})," Total Parcels"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-3xl font-bold",children:g.total_parcels}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[g.acquired," acquired"]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Fr,{className:"h-4 w-4 text-red-500"})," Disputed"]})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold text-red-600",children:g.disputed})})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(bs,{className:"h-4 w-4"})," Active Wayleaves"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-3xl font-bold",children:g.active_wayleaves}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[g.expiring_wayleaves," expiring soon"]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ga,{className:"h-4 w-4"})," Compensation Paid"]})}),e.jsx(X,{children:e.jsxs("div",{className:"text-3xl font-bold",children:["KES ",(g.total_compensation_paid/1e6).toFixed(1),"M"]})})]})]}),e.jsxs(ss,{defaultValue:"parcels",children:[e.jsxs(Yr,{children:[e.jsx(wt,{value:"parcels",children:"Land Parcels"}),e.jsx(wt,{value:"wayleaves",children:"Wayleaves"}),e.jsx(wt,{value:"compensation",children:"Compensation"})]}),e.jsx(kt,{value:"parcels",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Land Parcels Registry"})}),e.jsx(X,{children:i?e.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"Loading parcels..."}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Ref No"}),e.jsx(se,{children:"Owner"}),e.jsx(se,{children:"Area (Ha)"}),e.jsx(se,{children:"County"}),e.jsx(se,{children:"Title Status"}),e.jsx(se,{children:"Acquisition Status"}),e.jsx(se,{children:"Project"})]})}),e.jsx(lr,{children:p.length===0?e.jsx(Qe,{children:e.jsx(J,{colSpan:7,className:"text-center text-muted-foreground",children:"No parcels found"})}):p.map(y=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono",children:y.ref_no}),e.jsx(J,{className:"font-medium",children:y.owner_name}),e.jsx(J,{children:y.area_ha}),e.jsx(J,{children:y.county||"-"}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:y.title_status||"unregistered"})}),e.jsx(J,{children:e.jsx(Ae,{className:BBe[y.acquisition_status],children:y.acquisition_status})}),e.jsx(J,{className:"text-muted-foreground",children:y.project_id?`PRJ-${y.project_id}`:"-"})]},y.id))})]})})]})}),e.jsx(kt,{value:"wayleaves",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Wayleave Register"})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Wayleave No"}),e.jsx(se,{children:"Parcel"}),e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Width (m)"}),e.jsx(se,{children:"Length (m)"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Expiry"}),e.jsx(se,{children:"Annual Fee"})]})}),e.jsxs(lr,{children:[e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono",children:"WL-2024-001"}),e.jsx(J,{children:"LND-001"}),e.jsx(J,{children:"Pipeline"}),e.jsx(J,{children:"6"}),e.jsx(J,{children:"1,200"}),e.jsx(J,{children:e.jsx(Ae,{className:"bg-green-100 text-green-800",children:"active"})}),e.jsx(J,{children:"2044-03-31"}),e.jsx(J,{children:"KES 50,000"})]}),e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono",children:"WL-2024-002"}),e.jsx(J,{children:"LND-002"}),e.jsx(J,{children:"Access Road"}),e.jsx(J,{children:"4"}),e.jsx(J,{children:"800"}),e.jsx(J,{children:e.jsx(Ae,{className:"bg-yellow-100 text-yellow-800",children:"pending"})}),e.jsx(J,{children:"2025-07-14"}),e.jsx(J,{children:"KES 25,000"})]})]})]})})]})}),e.jsx(kt,{value:"compensation",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Compensation Records"})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Comp No"}),e.jsx(se,{children:"Parcel"}),e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Valuation"}),e.jsx(se,{children:"Negotiated"}),e.jsx(se,{children:"Paid"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Payment Date"})]})}),e.jsxs(lr,{children:[e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono",children:"CMP-2024-001"}),e.jsx(J,{children:"LND-001"}),e.jsx(J,{children:"Land Acquisition"}),e.jsx(J,{children:"KES 2.5M"}),e.jsx(J,{children:"KES 2.8M"}),e.jsx(J,{className:"text-green-600 font-semibold",children:"KES 2.8M"}),e.jsx(J,{children:e.jsx(Ae,{className:"bg-green-100 text-green-800",children:"paid"})}),e.jsx(J,{children:"2024-04-10"})]}),e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono",children:"CMP-2024-002"}),e.jsx(J,{children:"LND-002"}),e.jsx(J,{children:"Land Acquisition"}),e.jsx(J,{children:"KES 8.5M"}),e.jsx(J,{children:"-"}),e.jsx(J,{children:"KES 0"}),e.jsx(J,{children:e.jsx(Ae,{className:"bg-yellow-100 text-yellow-800",children:"negotiated"})}),e.jsx(J,{children:"-"})]})]})]})})]})})]})]})}function VBe(){const t=yr(),[r,s]=A.useState(!1),[n,a]=A.useState(!1),[o,c]=A.useState(null),[i,f]=A.useState({model_name:"",engine:"",version:"",project_id:""}),[p,g]=A.useState(""),{data:y,isLoading:b}=it({queryKey:["models"],queryFn:async()=>(await fetch("/api/models")).json()}),w=gt({mutationFn:async M=>(await fetch("/api/models",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)})).json(),onSuccess:()=>{Me.success("Model uploaded successfully"),t.invalidateQueries({queryKey:["models"]}),s(!1),f({model_name:"",engine:"",version:"",project_id:""})}}),T=(y==null?void 0:y.data)||[],N=()=>{Me.success(`Scenario "${p}" started for ${o==null?void 0:o.model_name}`),a(!1),g(""),c(null)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Design & Hydraulic Modeling"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage EPANET/InfoWater models, run scenarios, and calibrate"})]}),e.jsxs(Qt,{open:r,onOpenChange:s,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"Upload Model"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Upload Hydraulic Model"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Model Name *"}),e.jsx(Ie,{placeholder:"e.g., Nairobi Distribution Network",value:i.model_name,onChange:M=>f({...i,model_name:M.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Engine *"}),e.jsxs(Nt,{value:i.engine,onValueChange:M=>f({...i,engine:M}),children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select engine"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"EPANET",children:"EPANET"}),e.jsx(ge,{value:"InfoWater",children:"InfoWater"}),e.jsx(ge,{value:"WaterGEMS",children:"WaterGEMS"}),e.jsx(ge,{value:"MIKE URBAN",children:"MIKE URBAN"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Version"}),e.jsx(Ie,{placeholder:"e.g., 2.2",value:i.version,onChange:M=>f({...i,version:M.target.value})})]}),e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center text-muted-foreground",children:[e.jsx(Xae,{className:"h-8 w-8 mx-auto mb-2"}),e.jsx("p",{className:"text-sm",children:"Drag & drop model file here"}),e.jsx("p",{className:"text-xs",children:"or click to browse (.inp, .sqlite, .mdb)"})]}),e.jsx(K,{onClick:()=>w.mutate(i),disabled:!i.model_name||!i.engine||w.isPending,className:"w-full",children:w.isPending?"Uploading...":"Upload Model"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Bi,{className:"h-4 w-4"})," Total Models"]})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:T.length})})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsx(he,{className:"text-sm font-medium",children:"EPANET Models"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:T.filter(M=>M.engine==="EPANET").length})})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsx(he,{className:"text-sm font-medium",children:"InfoWater Models"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:T.filter(M=>M.engine==="InfoWater").length})})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsx(he,{className:"text-sm font-medium",children:"Total Runs"})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:T.reduce((M,O)=>M+O.runs_count,0)})})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Model Library"})}),e.jsx(X,{children:b?e.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"Loading models..."}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Model Name"}),e.jsx(se,{children:"Engine"}),e.jsx(se,{children:"Version"}),e.jsx(se,{children:"Project"}),e.jsx(se,{children:"Created By"}),e.jsx(se,{children:"Created"}),e.jsx(se,{children:"Runs"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:T.length===0?e.jsx(Qe,{children:e.jsx(J,{colSpan:8,className:"text-center text-muted-foreground",children:"No models found"})}):T.map(M=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:M.model_name}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:M.engine})}),e.jsx(J,{children:M.version}),e.jsx(J,{className:"text-muted-foreground",children:M.project_id?`PRJ-${M.project_id}`:"-"}),e.jsx(J,{children:M.created_by}),e.jsx(J,{children:M.created_at}),e.jsx(J,{children:M.runs_count}),e.jsx(J,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{size:"sm",variant:"outline",className:"gap-1",onClick:()=>{c(M),a(!0)},children:[e.jsx(Ui,{className:"h-3 w-3"}),"Run"]}),e.jsx(K,{size:"sm",variant:"ghost",children:e.jsx(Gn,{className:"h-3 w-3"})})]})})]},M.id))})]})})]}),e.jsx(Qt,{open:n,onOpenChange:a,children:e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsxs(Xt,{children:["Run Scenario - ",o==null?void 0:o.model_name]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Scenario Name *"}),e.jsx(Ie,{placeholder:"e.g., Peak Demand 2025",value:p,onChange:M=>g(M.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Parameters (JSON)"}),e.jsx("textarea",{className:"w-full h-32 p-3 border rounded-md font-mono text-sm",placeholder:'{"duration_hours": 24, "pattern": "weekday"}'})]}),e.jsx(K,{onClick:N,disabled:!p,className:"w-full",children:"Execute Scenario"})]})]})})]})}const UBe={pending:"bg-yellow-100 text-yellow-800",accepted:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"};function WBe(){const t=yr(),[r,s]=A.useState(!1),[n,a]=A.useState({project_id:"",commissioning_date:""}),{data:o}=it({queryKey:["handovers-dashboard"],queryFn:async()=>(await fetch("/api/handovers/dashboard")).json()}),{data:c,isLoading:i}=it({queryKey:["handovers"],queryFn:async()=>(await fetch("/api/handovers")).json()}),f=gt({mutationFn:async y=>(await fetch("/api/handovers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)})).json(),onSuccess:()=>{Me.success("Handover package created"),t.invalidateQueries({queryKey:["handovers"]}),t.invalidateQueries({queryKey:["handovers-dashboard"]}),s(!1),a({project_id:"",commissioning_date:""})}}),p=(c==null?void 0:c.data)||[],g=o||{pending:0,accepted:0,rejected:0,expiring_warranties:0};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Asset Capitalization & Handover"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage project handovers, as-builts, and warranty tracking"})]}),e.jsxs(Qt,{open:r,onOpenChange:s,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Handover"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Create Handover Package"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Project ID *"}),e.jsx(Ie,{placeholder:"e.g., 5",value:n.project_id,onChange:y=>a({...n,project_id:y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Commissioning Date *"}),e.jsx(Ie,{type:"date",value:n.commissioning_date,onChange:y=>a({...n,commissioning_date:y.target.value})})]}),e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-6 text-center text-muted-foreground",children:[e.jsx(bs,{className:"h-8 w-8 mx-auto mb-2"}),e.jsx("p",{className:"text-sm",children:"Upload documents"}),e.jsx("p",{className:"text-xs",children:"As-builts, O&M manuals, warranties"})]}),e.jsx(K,{onClick:()=>f.mutate(n),disabled:!n.project_id||!n.commissioning_date||f.isPending,className:"w-full",children:f.isPending?"Creating...":"Create Handover Package"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx($s,{className:"h-4 w-4 text-yellow-500"})," Pending"]})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold text-yellow-600",children:g.pending})})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ns,{className:"h-4 w-4 text-green-500"})," Accepted"]})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold text-green-600",children:g.accepted})})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(zo,{className:"h-4 w-4"})," Rejected"]})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold",children:g.rejected})})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Fr,{className:"h-4 w-4 text-orange-500"})," Expiring Warranties"]})}),e.jsx(X,{children:e.jsx("div",{className:"text-3xl font-bold text-orange-600",children:g.expiring_warranties})})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Handover Packages"})}),e.jsx(X,{children:i?e.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"Loading handovers..."}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Project"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Commissioning Date"}),e.jsx(se,{children:"Assets"}),e.jsx(se,{children:"Documents"}),e.jsx(se,{children:"Warranty Expiry"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:p.length===0?e.jsx(Qe,{children:e.jsx(J,{colSpan:7,className:"text-center text-muted-foreground",children:"No handover packages found"})}):p.map(y=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:y.project_title}),e.jsx(J,{children:e.jsx(Ae,{className:UBe[y.status],children:y.status})}),e.jsx(J,{children:y.commissioning_date}),e.jsx(J,{children:y.assets_count}),e.jsx(J,{children:y.documents_count}),e.jsx(J,{children:y.warranty_expiry||"-"}),e.jsx(J,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{size:"sm",variant:"outline",children:"View"}),y.status==="pending"&&e.jsx(K,{size:"sm",variant:"default",children:"Accept"})]})})]},y.id))})]})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Capitalization Entries"})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Project"}),e.jsx(se,{children:"Asset Class"}),e.jsx(se,{children:"Amount"}),e.jsx(se,{children:"Depreciation Method"}),e.jsx(se,{children:"Useful Life"}),e.jsx(se,{children:"Posted"})]})}),e.jsx(lr,{children:e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:"Eldoret Meter Replacement"}),e.jsx(J,{children:"Meters & AMI Equipment"}),e.jsx(J,{children:"KES 12,000,000"}),e.jsx(J,{children:"Straight Line"}),e.jsx(J,{children:"10 years"}),e.jsx(J,{children:e.jsx(Ae,{className:"bg-green-100 text-green-800",children:"Posted"})})]})})]})})]})]})}const MT={draft:"bg-gray-100 text-gray-800",published:"bg-blue-100 text-blue-800",evaluation:"bg-yellow-100 text-yellow-800",awarded:"bg-purple-100 text-purple-800",in_progress:"bg-green-100 text-green-800",completed:"bg-slate-100 text-slate-800",cancelled:"bg-red-100 text-red-800"},I8={open_tender:"Open Tender",restricted_tender:"Restricted Tender",request_for_quotation:"RFQ",direct_procurement:"Direct Procurement",framework_agreement:"Framework Agreement"};function GBe(){const t=yr(),[r,s]=A.useState(""),[n,a]=A.useState("all"),[o,c]=A.useState("tenders"),[i,f]=A.useState(!1),[p,g]=A.useState({title:"",description:"",method:"open_tender",estimated_value:"",closing_date:""}),{data:y,isLoading:b}=it({queryKey:["procurement"],queryFn:async()=>(await pe.get("/procurement")).data}),{data:w}=it({queryKey:["procurement-dashboard"],queryFn:async()=>(await pe.get("/procurement/dashboard")).data}),T=gt({mutationFn:async B=>(await pe.post("/projects/1/procurement",B)).data,onSuccess:()=>{Me.success("Tender created successfully"),t.invalidateQueries({queryKey:["procurement"]}),t.invalidateQueries({queryKey:["procurement-dashboard"]}),f(!1),g({title:"",description:"",method:"open_tender",estimated_value:"",closing_date:""})},onError:()=>Me.error("Failed to create tender")}),N=()=>{T.mutate({...p,estimated_value:parseFloat(p.estimated_value)})},M=y||[],O=w||{total_tenders:0,active:0,awarded_value:0,pending_evaluation:0,expiring_contracts:0},C=M.filter(B=>{const U=B.title.toLowerCase().includes(r.toLowerCase())||B.tender_no.toLowerCase().includes(r.toLowerCase()),te=n==="all"||B.status===n;return U&&te}),D=M.filter(B=>["published","evaluation"].includes(B.status)),L=M.filter(B=>["awarded","in_progress"].includes(B.status)),F=B=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",maximumFractionDigits:0}).format(B);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Procurement & Contracts"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage tenders, contracts, and supplier relationships"})]}),e.jsxs(Qt,{open:i,onOpenChange:f,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Tender"]})}),e.jsxs(Zt,{className:"max-w-lg",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Create New Tender"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Tender Title *"}),e.jsx(Ie,{placeholder:"e.g., Supply of Pipeline Materials",value:p.title,onChange:B=>g({...p,title:B.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx(Ie,{placeholder:"Brief description of requirements",value:p.description,onChange:B=>g({...p,description:B.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Procurement Method"}),e.jsxs(Nt,{value:p.method,onValueChange:B=>g({...p,method:B}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"open_tender",children:"Open Tender"}),e.jsx(ge,{value:"restricted_tender",children:"Restricted Tender"}),e.jsx(ge,{value:"request_for_quotation",children:"RFQ"}),e.jsx(ge,{value:"direct_procurement",children:"Direct Procurement"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Estimated Value (KES)"}),e.jsx(Ie,{type:"number",placeholder:"5000000",value:p.estimated_value,onChange:B=>g({...p,estimated_value:B.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Closing Date"}),e.jsx(Ie,{type:"date",value:p.closing_date,onChange:B=>g({...p,closing_date:B.target.value})})]}),e.jsx(K,{onClick:N,disabled:!p.title||!p.estimated_value||T.isPending,children:T.isPending?"Creating...":"Create Tender"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(bs,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Tenders"}),e.jsx("p",{className:"text-2xl font-bold",children:O.total_tenders})]})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx($s,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold",children:O.active})]})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(Ga,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Awarded Value"}),e.jsx("p",{className:"text-xl font-bold",children:F(O.awarded_value)})]})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(Nn,{className:"h-5 w-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pending Evaluation"}),e.jsx("p",{className:"text-2xl font-bold",children:O.pending_evaluation})]})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(wn,{className:"h-5 w-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Expiring Contracts"}),e.jsx("p",{className:"text-2xl font-bold",children:O.expiring_contracts})]})]})})})]}),e.jsxs(ss,{value:o,onValueChange:c,children:[e.jsxs(Yr,{children:[e.jsxs(wt,{value:"tenders",children:["Active Tenders (",D.length,")"]}),e.jsxs(wt,{value:"contracts",children:["Active Contracts (",L.length,")"]}),e.jsxs(wt,{value:"all",children:["All Procurement (",M.length,")"]})]}),e.jsx(kt,{value:"tenders",className:"space-y-4",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-lg",children:"Open Tenders & Under Evaluation"})}),e.jsx(X,{children:D.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No active tenders"}):e.jsx("div",{className:"space-y-4",children:D.map(B=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-sm text-muted-foreground",children:B.tender_no}),e.jsx(Ae,{className:MT[B.status]||"bg-gray-100",children:B.status})]}),e.jsx("h4",{className:"font-medium mt-1",children:B.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:B.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold",children:F(B.estimated_value)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Est. Value"})]})]}),e.jsxs("div",{className:"flex gap-6 mt-3 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Method: ",I8[B.method]||B.method]}),e.jsxs("span",{children:["Closing: ",B.closing_date]}),e.jsxs("span",{children:["Published: ",B.publish_date]})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx(K,{size:"sm",variant:"outline",children:"View Details"}),e.jsx(K,{size:"sm",variant:"outline",children:"Manage Bids"})]})]},B.id))})})]})}),e.jsx(kt,{value:"contracts",className:"space-y-4",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-lg",children:"Active Contracts"})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Contract"}),e.jsx(se,{children:"Contractor"}),e.jsx(se,{children:"Value"}),e.jsx(se,{children:"Period"}),e.jsx(se,{children:"Performance Bond"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:L.map(B=>e.jsxs(Qe,{children:[e.jsx(J,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:B.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:B.tender_no})]})}),e.jsx(J,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($p,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:B.contractor||"-"})]})}),e.jsx(J,{children:B.contract_value?F(B.contract_value):"-"}),e.jsx(J,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{children:B.contract_start}),e.jsxs("p",{className:"text-muted-foreground",children:["to ",B.contract_end]})]})}),e.jsx(J,{children:B.performance_bond?F(B.performance_bond):"-"}),e.jsx(J,{children:e.jsx(Ae,{className:MT[B.status]||"bg-gray-100",children:B.status})}),e.jsx(J,{children:e.jsx(K,{size:"sm",variant:"ghost",children:"View"})})]},B.id))})]})})]})}),e.jsxs(kt,{value:"all",className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search by title or tender number...",value:r,onChange:B=>s(B.target.value),className:"pl-9"})]}),e.jsxs(Nt,{value:n,onValueChange:a,children:[e.jsx(bt,{className:"w-40",children:e.jsx(St,{placeholder:"Status"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Status"}),e.jsx(ge,{value:"draft",children:"Draft"}),e.jsx(ge,{value:"published",children:"Published"}),e.jsx(ge,{value:"evaluation",children:"Evaluation"}),e.jsx(ge,{value:"awarded",children:"Awarded"}),e.jsx(ge,{value:"in_progress",children:"In Progress"}),e.jsx(ge,{value:"completed",children:"Completed"})]})]})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Tender No."}),e.jsx(se,{children:"Title"}),e.jsx(se,{children:"Method"}),e.jsx(se,{children:"Est. Value"}),e.jsx(se,{children:"Contract Value"}),e.jsx(se,{children:"Contractor"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Dates"})]})}),e.jsx(lr,{children:C.map(B=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono",children:B.tender_no}),e.jsx(J,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:B.title}),e.jsx("p",{className:"text-sm text-muted-foreground truncate max-w-[200px]",children:B.description})]})}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:I8[B.method]||B.method})}),e.jsx(J,{children:F(B.estimated_value)}),e.jsx(J,{children:B.contract_value?F(B.contract_value):"-"}),e.jsx(J,{children:B.contractor||"-"}),e.jsx(J,{children:e.jsx(Ae,{className:MT[B.status]||"bg-gray-100",children:B.status})}),e.jsx(J,{children:e.jsxs("div",{className:"text-sm",children:[B.closing_date&&e.jsxs("p",{children:["Close: ",B.closing_date]}),B.award_date&&e.jsxs("p",{className:"text-muted-foreground",children:["Award: ",B.award_date]})]})})]},B.id))})]})})})]})]})]})}const OT={planning:"#6B7280",tendering:"#3B82F6",execution:"#22C55E",suspended:"#F97316",completed:"#8B5CF6",closed:"#64748B"},D8={planning:"bg-gray-100 text-gray-800",tendering:"bg-blue-100 text-blue-800",execution:"bg-green-100 text-green-800",suspended:"bg-orange-100 text-orange-800",completed:"bg-purple-100 text-purple-800",closed:"bg-slate-100 text-slate-800"};function KBe(){const t=A.useRef(null),r=A.useRef(null),[s,n]=A.useState(""),[a,o]=A.useState("all"),[c,i]=A.useState(null),[f,p]=A.useState(!1),{data:g,isLoading:y}=it({queryKey:["projects-map"],queryFn:async()=>(await pe.get("/projects/map/all")).data}),b=g||[],w=b.filter(M=>{const O=M.title.toLowerCase().includes(s.toLowerCase())||M.code.toLowerCase().includes(s.toLowerCase()),C=a==="all"||M.status===a;return O&&C});A.useEffect(()=>{if(!(!t.current||r.current)){try{r.current=new $l.Map({container:t.current,style:"https://demotiles.maplibre.org/style.json",center:[37,-1],zoom:6}),r.current.addControl(new $l.NavigationControl,"top-right"),r.current.on("load",()=>{p(!0)})}catch(M){console.error("Failed to initialize map:",M)}return()=>{r.current&&(r.current.remove(),r.current=null)}}},[]),A.useEffect(()=>{if(!r.current||!f||!b.length)return;document.querySelectorAll(".maplibregl-marker").forEach(O=>O.remove()),b.forEach(O=>{O.locations&&O.locations.length>0&&O.locations.forEach(C=>{const D=document.createElement("div");D.className="project-marker",D.style.cssText=`
            width: 24px;
            height: 24px;
            background-color: ${OT[O.status]||"#6B7280"};
            border: 3px solid white;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
          `,D.addEventListener("click",()=>{i(O)}),new $l.Marker({element:D}).setLngLat([C.lng,C.lat]).addTo(r.current)})})},[b,f]);const T=M=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",maximumFractionDigits:0}).format(M),N=M=>{if(M.locations&&M.locations.length>0&&r.current){const O=M.locations[0];r.current.flyTo({center:[O.lng,O.lat],zoom:12,duration:1500}),i(M)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Projects Map"}),e.jsx("p",{className:"text-muted-foreground",children:"Geographic view of capital projects and infrastructure"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{variant:"outline",size:"sm",children:[e.jsx(cv,{className:"h-4 w-4 mr-2"}),"Layers"]}),e.jsxs(K,{variant:"outline",size:"sm",children:[e.jsx(o9,{className:"h-4 w-4 mr-2"}),"Filters"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx(H,{className:"overflow-hidden",children:e.jsx("div",{ref:t,className:"h-[600px] w-full"})})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsx(he,{className:"text-lg",children:"Project List"})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search projects...",value:s,onChange:M=>n(M.target.value),className:"pl-9"})]}),e.jsxs(Nt,{value:a,onValueChange:o,children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Filter by status"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Status"}),e.jsx(ge,{value:"planning",children:"Planning"}),e.jsx(ge,{value:"tendering",children:"Tendering"}),e.jsx(ge,{value:"execution",children:"Execution"}),e.jsx(ge,{value:"completed",children:"Completed"})]})]})]})]}),e.jsx(H,{className:"max-h-[400px] overflow-auto",children:e.jsx(X,{className:"pt-4 space-y-2",children:y?e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"Loading projects..."}):w.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No projects with locations"}):w.map(M=>e.jsx("div",{className:`p-3 rounded-lg border cursor-pointer transition-colors ${(c==null?void 0:c.id)===M.id?"bg-primary/10 border-primary":"hover:bg-muted/50"}`,onClick:()=>N(M),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(fn,{className:"h-4 w-4 mt-1",style:{color:OT[M.status]}}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:M.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:M.code})]})]}),e.jsx(Ae,{className:`${D8[M.status]} text-xs`,children:M.status})]})},M.id))})}),c&&e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsx(he,{className:"text-lg",children:"Selected Project"})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:c.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c.code})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status"}),e.jsx(Ae,{className:D8[c.status],children:c.status})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Budget"}),e.jsx("span",{className:"font-medium",children:T(c.baseline_budget)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Progress"}),e.jsxs("span",{className:"font-medium",children:[c.physical_progress,"%"]})]}),c.locations&&c.locations.length>0&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Locations:"}),e.jsx("ul",{className:"mt-1 space-y-1",children:c.locations.map((M,O)=>e.jsxs("li",{className:"flex items-center gap-1",children:[e.jsx(fn,{className:"h-3 w-3"}),e.jsx("span",{children:M.name})]},O))})]}),e.jsx(Pn,{to:`/projects/${c.id}`,children:e.jsxs(K,{className:"w-full mt-2",size:"sm",children:["View Details",e.jsx($u,{className:"h-4 w-4 ml-1"})]})})]})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-lg",children:"Map Legend"})}),e.jsx(X,{children:e.jsx("div",{className:"flex flex-wrap gap-4",children:Object.entries(OT).map(([M,O])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white shadow",style:{backgroundColor:O}}),e.jsx("span",{className:"text-sm capitalize",children:M})]},M))})})]})]})}function HBe(){return e.jsxs("div",{className:"flex h-screen bg-background",children:[e.jsx(Ti,{}),e.jsx("main",{className:"flex-1 overflow-auto",children:e.jsx(Ai,{})})]})}function ZBe(){return e.jsxs("div",{className:"flex h-screen bg-background",children:[e.jsx(Ti,{}),e.jsx("main",{className:"flex-1 overflow-auto",children:e.jsx(Ai,{})})]})}function YBe(){return e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsx(Ti,{}),e.jsx("main",{className:"flex-1 overflow-y-auto",children:e.jsx(Ai,{})})]})}function XBe(){return e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsx(Ti,{}),e.jsx("main",{className:"flex-1 overflow-y-auto",children:e.jsx(Ai,{})})]})}function QBe(t){const r=t.trim().split(`
`);if(r.length<2)throw new Error("CSV must contain header and at least one row");const s=r[0].split(",").map(o=>o.trim().toLowerCase()),a=["name","email","role"].filter(o=>!s.includes(o));if(a.length>0)throw new Error(`Missing required columns: ${a.join(", ")}`);return r.slice(1).filter(o=>o.trim()).map((o,c)=>{const i=o.split(",").map(g=>g.trim()),f={name:i[s.indexOf("name")]||"",email:i[s.indexOf("email")]||"",role:i[s.indexOf("role")]||""},p=s.indexOf("tenant_id");if(p!==-1&&i[p]&&(f.tenant_id=i[p]),!f.name||!f.email||!f.role)throw new Error(`Row ${c+2}: missing required fields`);return f})}function JBe(t){const r=["name","email","role","tenant_id"],s=t.map(a=>[a.name,a.email,a.role,a.tenant_id||"1"]);return[r.join(","),...s.map(a=>a.map(o=>`"${o}"`).join(","))].join(`
`)}function R8(t,r="users.csv"){const s=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),a=URL.createObjectURL(s);n.setAttribute("href",a),n.setAttribute("download",r),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)}function e8e(){const t=["name","email","role","tenant_id"],r=[["John Doe","john.doe@example.com","admin","1"],["Jane Smith","jane.smith@example.com","manager","1"],["Bob Johnson","bob.johnson@example.com","user","1"]];return[t.join(","),...r.map(n=>n.map(a=>`"${a}"`).join(","))].join(`
`)}function t8e(){const[t,r]=A.useState([]),[s,n]=A.useState(!1),[a,o]=A.useState(!1),c=A.useRef(null),i=async()=>{try{n(!0);const w=(await(await fetch("/api/v1/admin/users")).json()).data||[],T=JBe(w);R8(T,`users-${new Date().toISOString().split("T")[0]}.csv`),Me.success(`Exported ${w.length} users`)}catch(y){Me.error("Failed to export users"),console.error(y)}finally{n(!1)}},f=()=>{var y;(y=c.current)==null||y.click()},p=async y=>{var w;const b=(w=y.target.files)==null?void 0:w[0];if(b)try{o(!0);const T=await b.text(),N=QBe(T),M=await fetch("/api/v1/admin/users/bulk-import",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({users:N})});if(!M.ok)throw new Error("Import failed");const O=await M.json();r(O.data||[]),Me.success(`Successfully imported ${N.length} users`),c.current&&(c.current.value="")}catch(T){Me.error(T instanceof Error?T.message:"Failed to import users"),console.error(T)}finally{o(!1)}},g=()=>{try{const y=e8e();R8(y,"users-template.csv"),Me.success("Template downloaded successfully")}catch(y){Me.error("Failed to download template"),console.error(y)}};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Users & Sessions"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage user accounts, roles, 2FA, and active sessions"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Add User"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search users by name, email...",className:"pl-10"})]}),e.jsx(K,{variant:"outline",children:"Filters"}),e.jsx("input",{ref:c,type:"file",accept:".csv",onChange:p,className:"hidden"}),e.jsxs(K,{variant:"outline",onClick:g,title:"Download CSV template with correct column format",children:[e.jsx(bs,{className:"mr-2 h-4 w-4"}),"Template"]}),e.jsxs(K,{variant:"outline",onClick:f,disabled:a,children:[e.jsx(Bo,{className:"mr-2 h-4 w-4"}),a?"Importing...":"Import"]}),e.jsxs(K,{variant:"outline",onClick:i,disabled:s,children:[e.jsx(ma,{className:"mr-2 h-4 w-4"}),s?"Exporting...":"Export"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total Users"}),e.jsx(Ds,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all tenants"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Active Sessions"}),e.jsx(_S,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently logged in"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"2FA Enabled"}),e.jsx(ka,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"0%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Security coverage"})]})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"User Directory"}),e.jsx(mr,{children:"View and manage user accounts"})]}),e.jsx(X,{children:e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(Ds,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),e.jsx("p",{children:"No users found. Run database migrations to create tables."})]})})]})]})}function r8e(){const t=[{id:"admin",name:"Administrator",description:"Full system access and configuration",permissions:"All",color:"bg-red-500"},{id:"manager",name:"Manager",description:"Operational management and oversight",permissions:"Core Registry, Core Ops, CRM, Projects",color:"bg-blue-500"},{id:"operator",name:"Operator",description:"Day-to-day operational tasks",permissions:"Core Ops, CMMS, Water Quality",color:"bg-green-500"},{id:"analyst",name:"Analyst",description:"Data analysis and reporting",permissions:"DSA, M&E, Costing, Analytics",color:"bg-purple-500"},{id:"viewer",name:"Viewer",description:"Read-only access to dashboards",permissions:"Core Registry, M&E, DSA",color:"bg-gray-500"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Roles & Permissions Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage system roles, permissions, and menu access control"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Create Role"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(r=>e.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(ue,{className:"pb-3",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`${r.color} text-white p-3 rounded-lg`,children:e.jsx(Ds,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx(he,{className:"text-lg",children:r.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.description})]})]})})}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground mb-2",children:"ACCESSIBLE MODULES:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:r.permissions.split(", ").map(s=>e.jsx(Ae,{variant:"secondary",className:"text-xs",children:s},s))})]}),e.jsxs("div",{className:"flex gap-2 pt-3",children:[e.jsx(K,{variant:"outline",size:"sm",className:"flex-1",children:"Edit"}),e.jsx(K,{variant:"outline",size:"sm",className:"flex-1",children:"Permissions"})]})]})]},r.id))}),e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(ka,{className:"h-5 w-5"}),"System Roles Overview"]}),e.jsx(mr,{children:"Each role has specific module access and granular permissions"})]}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Roles"}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:"5"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Users Assigned"}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:"24"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Permissions Configured"}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:"142"})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:'For detailed permission management and role hierarchy, see Roles & Permissions in the Admin menu. Use the "Role & Menu Access" option to control which modules each role can access.'})]})})]})]})}function s8e(){return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Permission Matrix"}),e.jsx("p",{className:"text-muted-foreground",children:"Grid view of roles  permissions with bulk operations"})]}),e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Roles  Permissions Matrix"}),e.jsx(mr,{children:"Check boxes to grant permissions to roles"})]}),e.jsx(X,{children:e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(Gn,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),e.jsx("p",{children:"Matrix grid will display here once roles and permissions are seeded."})]})})]})]})}function n8e(){return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Audit Logs"}),e.jsx("p",{className:"text-muted-foreground",children:"Track all system actions, changes, and user activity"})]}),e.jsxs(K,{children:[e.jsx(ma,{className:"mr-2 h-4 w-4"}),"Export CSV"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search by actor, action, entity...",className:"pl-10"})]}),e.jsx(K,{variant:"outline",children:"Date Range"}),e.jsx(K,{variant:"outline",children:"Filters"})]}),e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Activity Timeline"}),e.jsx(mr,{children:"All actions with before/after diffs"})]}),e.jsx(X,{children:e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(bs,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),e.jsx("p",{children:"Audit logs will appear here once users start performing actions."})]})})]})]})}function a8e(){const[t,r]=A.useState([{id:1,appName:"SCADA Integration",keyId:"sk_live_abc123xyz",keySecret:"",scopes:["read:telemetry","write:alarms"],rateLimit:5e3,lastUsedAt:"2025-11-24T14:32:00Z",createdAt:"2025-11-01T10:00:00Z",isActive:!0},{id:2,appName:"Billing System",keyId:"sk_live_def456uvw",keySecret:"",scopes:["read:billing","write:payments"],rateLimit:1e3,lastUsedAt:"2025-11-24T16:15:00Z",createdAt:"2025-11-10T08:30:00Z",isActive:!0}]),[s]=A.useState([{id:1,clientName:"Mobile App",clientId:"oauth_mobile_app_001",grantTypes:["authorization_code","refresh_token"],redirectUris:["https://app.example.com/callback"],isActive:!0,createdAt:"2025-11-05T12:00:00Z"}]),[n,a]=A.useState({}),[o,c]=A.useState(""),i=b=>{a(w=>({...w,[b]:!w[b]}))},f=b=>{navigator.clipboard.writeText(b)},p=b=>{r(w=>w.map(T=>T.id===b?{...T,keySecret:"sk_live_"+Math.random().toString(36).substr(2,20)}:T))},g=b=>{r(w=>w.filter(T=>T.id!==b))},y=t.filter(b=>b.appName.toLowerCase().includes(o.toLowerCase())||b.keyId.toLowerCase().includes(o.toLowerCase()));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"API Catalog & Key Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage API keys, OAuth clients, and integration credentials"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"API Keys"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Server-to-server authentication tokens"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Generate New Key"]})]}),e.jsx(Ie,{placeholder:"Search API keys...",value:o,onChange:b=>c(b.target.value),className:"max-w-xs"}),e.jsx("div",{className:"space-y-2",children:y.map(b=>e.jsx(H,{className:"hover:shadow-sm transition-shadow",children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 items-center",children:[e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("p",{className:"font-medium text-sm",children:b.appName}),e.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:b.keyId})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"SCOPES"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:b.scopes.map(w=>e.jsx(Ae,{variant:"secondary",className:"text-xs",children:w},w))})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"RATE LIMIT"}),e.jsxs("p",{className:"font-medium",children:[b.rateLimit,"/hr"]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"LAST USED"}),e.jsx("p",{className:"text-sm",children:b.lastUsedAt?new Date(b.lastUsedAt).toLocaleDateString():"Never"})]}),e.jsxs("div",{className:"md:col-span-3 flex justify-end gap-1",children:[e.jsx(K,{size:"sm",variant:"ghost",onClick:()=>i(b.id),children:n[b.id]?e.jsx(_b,{className:"h-4 w-4"}):e.jsx(mo,{className:"h-4 w-4"})}),e.jsx(K,{size:"sm",variant:"ghost",onClick:()=>f(b.keySecret),children:e.jsx(P_,{className:"h-4 w-4"})}),e.jsx(K,{size:"sm",variant:"ghost",onClick:()=>p(b.id),children:e.jsx(yI,{className:"h-4 w-4"})}),e.jsx(K,{size:"sm",variant:"ghost",className:"text-red-500 hover:text-red-600",onClick:()=>g(b.id),children:e.jsx(Ws,{className:"h-4 w-4"})})]})]})})},b.id))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"OAuth Clients"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Third-party application integrations"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Register OAuth Client"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(b=>e.jsxs(H,{children:[e.jsxs(ue,{className:"pb-3",children:[e.jsx(he,{className:"text-lg",children:b.clientName}),e.jsx(mr,{className:"font-mono text-xs",children:b.clientId})]}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1",children:"GRANT TYPES"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:b.grantTypes.map(w=>e.jsx(Ae,{variant:"outline",className:"text-xs",children:w},w))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1",children:"REDIRECT URIs"}),b.redirectUris.map(w=>e.jsx("p",{className:"text-xs font-mono break-all",children:w},w))]}),e.jsxs("div",{className:"pt-2 flex gap-2",children:[e.jsx(K,{size:"sm",variant:"outline",className:"flex-1",children:"Edit"}),e.jsx(K,{size:"sm",variant:"outline",className:"flex-1 text-red-500",children:"Revoke"})]})]})]},b.id))})]}),e.jsxs(H,{className:"bg-blue-50 border-blue-200",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Nn,{className:"h-5 w-5 text-blue-600"}),e.jsx(he,{className:"text-blue-900",children:"API Security Best Practices"})]})}),e.jsxs(X,{className:"text-sm text-blue-800 space-y-2",children:[e.jsx("p",{children:" Rotate API keys every 90 days"}),e.jsx("p",{children:" Use minimal scopes required for your integration"}),e.jsx("p",{children:" Monitor API audit logs for unusual activity"}),e.jsx("p",{children:" Revoke unused keys immediately"}),e.jsx("p",{children:" Never commit API keys to version control"})]})]})]})}function i8e(){var i;const t=[{label:"Customers",key:"customers",icon:e.jsx(Ds,{className:"h-4 w-4"}),entities:[{id:1,sourceSystem:"CIS",sourceId:"CUST-001234",lastUpdated:"2025-11-24T10:30:00Z",trustScore:92,matchesFound:2},{id:2,sourceSystem:"Field App",sourceId:"FIELD-5678",lastUpdated:"2025-11-23T15:45:00Z",trustScore:78,matchesFound:1}]},{label:"Assets",key:"assets",icon:e.jsx($p,{className:"h-4 w-4"}),entities:[{id:3,sourceSystem:"CMMS",sourceId:"PUMP-001",lastUpdated:"2025-11-22T08:00:00Z",trustScore:95,matchesFound:0}]},{label:"Locations",key:"locations",icon:e.jsx(fn,{className:"h-4 w-4"}),entities:[{id:4,sourceSystem:"GIS",sourceId:"LOC-TURKANA-01",lastUpdated:"2025-11-20T12:00:00Z",trustScore:88,matchesFound:3}]},{label:"Vendors",key:"vendors",icon:e.jsx(jI,{className:"h-4 w-4"}),entities:[{id:5,sourceSystem:"Procurement",sourceId:"VEND-042",lastUpdated:"2025-11-24T09:15:00Z",trustScore:72,matchesFound:2}]}],[r,s]=A.useState(null),[n,a]=A.useState("customers"),o=f=>f>=85?"bg-green-100 text-green-800":f>=70?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",c=((i=t.find(f=>f.key===n))==null?void 0:i.entities)||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Master Data Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Deduplicate and manage golden records across source systems"})]}),e.jsxs(ss,{value:n,onValueChange:a,children:[e.jsx(Yr,{className:"grid w-full grid-cols-4",children:t.map(f=>e.jsxs(wt,{value:f.key,className:"flex items-center gap-2",children:[f.icon,e.jsx("span",{className:"hidden sm:inline",children:f.label})]},f.key))}),t.map(f=>e.jsxs(kt,{value:f.key,className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:f.label}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[f.entities.length," entities found"]})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Add ",f.label.slice(0,-1)]})]}),e.jsx("div",{className:"space-y-2",children:c.map(p=>e.jsx(H,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>s(p),children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:p.sourceSystem}),e.jsx("p",{className:"text-xs text-muted-foreground",children:p.sourceId})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"LAST UPDATED"}),e.jsx("p",{className:"text-sm",children:new Date(p.lastUpdated).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"TRUST SCORE"}),e.jsxs("div",{className:`inline-block px-2 py-1 rounded text-xs font-medium ${o(p.trustScore)}`,children:[p.trustScore,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"POTENTIAL MATCHES"}),e.jsxs(Ae,{variant:p.matchesFound>0?"default":"secondary",children:[p.matchesFound," found"]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[p.matchesFound>0&&e.jsxs(K,{size:"sm",variant:"default",children:[e.jsx($F,{className:"h-4 w-4 mr-1"}),"Review Matches"]}),e.jsx(K,{size:"sm",variant:"outline",children:"Edit"})]})]})})},p.id))})]},f.key))]}),r&&e.jsxs(H,{className:"border-2 border-blue-200",children:[e.jsxs(ue,{children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx($F,{className:"h-5 w-5"}),"Entity Details"]}),e.jsxs(mr,{children:["Source: ",r.sourceSystem," | ID: ",r.sourceId]})]}),e.jsxs(X,{className:"space-y-4",children:[r.matchesFound>0&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-900 text-sm",children:[e.jsx(Nn,{className:"h-4 w-4"}),e.jsxs("span",{children:[r.matchesFound," potential duplicate(s) detected"]})]}),e.jsx("p",{className:"text-xs text-amber-700 mt-1",children:'Click "Review Matches" to resolve duplicates using the merge workbench.'})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground",children:"TRUST SCORE"}),e.jsxs("div",{className:"mt-1",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${r.trustScore>=85?"bg-green-500":r.trustScore>=70?"bg-yellow-500":"bg-red-500"}`,style:{width:`${r.trustScore}%`}})}),e.jsxs("p",{className:"text-sm font-medium mt-1",children:[r.trustScore,"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground",children:"SOURCE SYSTEM"}),e.jsx("p",{className:"text-sm font-medium mt-1",children:r.sourceSystem})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"TOTAL ENTITIES"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:t.reduce((f,p)=>f+p.entities.length,0)})]})}),e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"AVG TRUST SCORE"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:"82%"})]})}),e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"PENDING MERGES"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:"4"})]})}),e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"COMPLETED MERGES"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:"12"})]})})]})]})}function o8e(){const[t]=A.useState([{id:1,name:"Azure AD",type:"oidc",issuer:"https://login.microsoftonline.com/tenant-id/v2.0",status:"active",users:45,lastSync:"2025-11-24T14:30:00Z"},{id:2,name:"Google Workspace",type:"oidc",issuer:"https://accounts.google.com",status:"inactive",users:0,lastSync:null}]),[r]=A.useState({enforcementPolicy:"recommended",allowedMethods:["totp","sms","email"],gracePeriodDays:7}),[s]=A.useState([{id:1,name:"Operator Dashboard Access",effect:"allow",condition:"role=operator AND scheme_id NOT NULL",priority:100},{id:2,name:"Deny Access After Hours",effect:"deny",condition:"time > 18:00 AND time < 06:00 AND role != admin",priority:50}]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Identity & Access Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure SSO, MFA, and attribute-based access control"})]}),e.jsxs(ss,{defaultValue:"sso",className:"w-full",children:[e.jsxs(Yr,{className:"grid w-full grid-cols-3",children:[e.jsxs(wt,{value:"sso",className:"flex items-center gap-2",children:[e.jsx(ka,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"SSO"})]}),e.jsxs(wt,{value:"mfa",className:"flex items-center gap-2",children:[e.jsx(Nb,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"MFA"})]}),e.jsxs(wt,{value:"abac",className:"flex items-center gap-2",children:[e.jsx(sm,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"ABAC"})]})]}),e.jsxs(kt,{value:"sso",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Single Sign-On (OIDC/SAML)"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Connect identity providers for enterprise authentication"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Add Provider"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(n=>e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(he,{className:"text-lg",children:n.name}),e.jsx(mr,{className:"mt-1",children:n.type.toUpperCase()})]}),e.jsx(Ae,{variant:n.status==="active"?"default":"outline",children:n.status})]})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"ISSUER"}),e.jsx("p",{className:"text-xs font-mono break-all",children:n.issuer})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"SYNCED USERS"}),e.jsx("p",{className:"text-lg font-bold",children:n.users})]}),n.lastSync&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"LAST SYNC"}),e.jsx("p",{className:"text-sm",children:new Date(n.lastSync).toLocaleString()})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(K,{size:"sm",variant:"outline",className:"flex-1",children:"Test"}),e.jsx(K,{size:"sm",variant:"outline",className:"flex-1",children:"Edit"}),n.status==="inactive"&&e.jsx(K,{size:"sm",className:"flex-1",children:"Enable"})]})]})]},n.id))}),e.jsxs(H,{className:"bg-blue-50 border-blue-200",children:[e.jsx(ue,{children:e.jsx(he,{className:"text-blue-900",children:"Configuration Steps"})}),e.jsxs(X,{className:"text-sm text-blue-800 space-y-2",children:[e.jsx("p",{children:"1. Register this application with your IdP"}),e.jsx("p",{children:"2. Provide Redirect URI: https://yourdomain.com/auth/callback"}),e.jsx("p",{children:"3. Copy Client ID and Client Secret here"}),e.jsx("p",{children:'4. Click "Test" to verify connectivity'}),e.jsx("p",{children:"5. Enable once testing is successful"})]})]})]}),e.jsxs(kt,{value:"mfa",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Multi-Factor Authentication"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enforce MFA for enhanced security"})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-base",children:"MFA Policy"})}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Enforcement Policy"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(Ae,{variant:r.enforcementPolicy==="optional"?"default":"outline",children:"Optional"}),e.jsx(Ae,{variant:r.enforcementPolicy==="recommended"?"default":"outline",children:"Recommended"}),e.jsx(Ae,{variant:r.enforcementPolicy==="required"?"default":"outline",children:"Required"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Current: ",r.enforcementPolicy]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Allowed Methods"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:["totp","sms","email"].map(n=>e.jsx(Ae,{variant:r.allowedMethods.includes(n)?"default":"outline",className:"cursor-pointer",children:n==="totp"?"Authenticator App":n.toUpperCase()},n))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Grace Period"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(Ie,{type:"number",value:r.gracePeriodDays,className:"w-20",disabled:!0}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"days to enroll"})]})]}),e.jsx(K,{children:"Save MFA Settings"})]})]}),e.jsxs(H,{className:"bg-green-50 border-green-200",children:[e.jsx(ue,{children:e.jsx(he,{className:"text-green-900 text-base",children:"MFA Enrollment Status"})}),e.jsxs(X,{className:"text-sm text-green-800 space-y-1",children:[e.jsx("p",{children:" 38 users with MFA enabled"}),e.jsx("p",{children:" 7 users pending enrollment"}),e.jsx("p",{children:" Grace period expires: 2025-12-01"})]})]})]}),e.jsxs(kt,{value:"abac",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Attribute-Based Access Control"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Fine-grained policies based on user attributes"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Add Policy"]})]}),e.jsx("div",{className:"space-y-2",children:s.map(n=>e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:n.name}),e.jsx("p",{className:"text-xs text-muted-foreground font-mono mt-1",children:n.condition})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"EFFECT"}),e.jsx(Ae,{variant:n.effect==="allow"?"default":"destructive",className:"mt-1",children:n.effect.toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"PRIORITY"}),e.jsx("p",{className:"font-medium mt-1",children:n.priority})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{size:"sm",variant:"outline",children:"Edit"}),e.jsx(K,{size:"sm",variant:"outline",className:"text-red-500",children:"Delete"})]})]})})},n.id))}),e.jsxs(H,{className:"bg-amber-50 border-amber-200",children:[e.jsx(ue,{children:e.jsx(he,{className:"text-amber-900 text-base",children:"ABAC Attributes Available"})}),e.jsxs(X,{className:"text-sm text-amber-800 space-y-1",children:[e.jsx("p",{children:" role (admin, manager, operator, analyst, viewer)"}),e.jsx("p",{children:" scheme_id (for location-based access)"}),e.jsx("p",{children:" dma_id (for distribution area control)"}),e.jsx("p",{children:" department (operations, finance, etc.)"}),e.jsx("p",{children:" sensitivity (public, internal, confidential)"}),e.jsx("p",{children:" time (for business hours restrictions)"})]})]})]})]})]})}function l8e(){const[t]=A.useState([{id:1,title:"Water Supply Service Agreement 2025",type:"contract",size:"2.4 MB",status:"active",version:3,createdDate:"2025-11-01",modifiedDate:"2025-11-20",retention:"7 years"},{id:2,title:"Operational Procedures Manual",type:"procedure",size:"5.8 MB",status:"active",version:5,createdDate:"2025-06-15",modifiedDate:"2025-11-18",retention:"5 years"},{id:3,title:"Q3 Financial Audit Report",type:"report",size:"1.2 MB",status:"archived",version:1,createdDate:"2025-10-01",modifiedDate:"2025-10-15",retention:"10 years"}]),[r,s]=A.useState(""),n=o=>{switch(o){case"contract":return"bg-blue-100 text-blue-800";case"report":return"bg-green-100 text-green-800";case"policy":return"bg-purple-100 text-purple-800";case"procedure":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},a=t.filter(o=>o.title.toLowerCase().includes(r.toLowerCase()));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Electronic Document Records Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Centralized document control with version history and compliance"})]}),e.jsxs(ss,{defaultValue:"documents",className:"w-full",children:[e.jsxs(Yr,{className:"grid w-full grid-cols-2",children:[e.jsx(wt,{value:"documents",children:"Documents"}),e.jsx(wt,{value:"retention",children:"Retention Schedule"})]}),e.jsxs(kt,{value:"documents",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Document Library"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.length," documents found"]})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Upload Document"]})]}),e.jsx(Ie,{placeholder:"Search documents...",value:r,onChange:o=>s(o.target.value),className:"max-w-xs"}),e.jsx("div",{className:"space-y-2",children:a.map(o=>e.jsx(H,{className:"hover:shadow-sm transition-shadow",children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 items-center",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"h-4 w-4 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:o.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:o.size})]})]})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"TYPE"}),e.jsx(Ae,{className:`mt-1 ${n(o.type)}`,children:o.type})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"VERSION"}),e.jsxs("p",{className:"font-medium mt-1",children:["v",o.version]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"MODIFIED"}),e.jsx("p",{className:"text-sm mt-1",children:new Date(o.modifiedDate).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"RETENTION"}),e.jsx("p",{className:"text-sm mt-1",children:o.retention})]}),e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(K,{size:"sm",variant:"ghost",children:e.jsx(ma,{className:"h-4 w-4"})}),e.jsx(K,{size:"sm",variant:"ghost",children:e.jsx(eM,{className:"h-4 w-4"})}),e.jsx(K,{size:"sm",variant:"ghost",className:"text-red-500",children:e.jsx(Ws,{className:"h-4 w-4"})})]})]})})},o.id))})]}),e.jsxs(kt,{value:"retention",className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Retention Schedule"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsx(he,{className:"text-base",children:"Short Term (1-2 Years)"})}),e.jsxs(X,{className:"space-y-2",children:[e.jsx("p",{className:"text-sm",children:" Meeting minutes"}),e.jsx("p",{className:"text-sm",children:" Internal memos"}),e.jsx("p",{className:"text-sm",children:" Draft documents"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsx(he,{className:"text-base",children:"Medium Term (5-7 Years)"})}),e.jsxs(X,{className:"space-y-2",children:[e.jsx("p",{className:"text-sm",children:" Contracts"}),e.jsx("p",{className:"text-sm",children:" Procedures"}),e.jsx("p",{className:"text-sm",children:" Operational reports"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsx(he,{className:"text-base",children:"Long Term (10+ Years)"})}),e.jsxs(X,{className:"space-y-2",children:[e.jsx("p",{className:"text-sm",children:" Financial audits"}),e.jsx("p",{className:"text-sm",children:" Compliance records"}),e.jsx("p",{className:"text-sm",children:" Strategic plans"})]})]})]})]})]})]})}function L8(){const[t]=A.useState([{id:1,name:"customers_raw",schema:"raw",rows:45230,lastRefresh:"2025-11-24T10:30:00Z",quality:94},{id:2,name:"billing_transactions",schema:"staging",rows:128456,lastRefresh:"2025-11-24T12:00:00Z",quality:97},{id:3,name:"customer_mart",schema:"mart",rows:45230,lastRefresh:"2025-11-24T14:15:00Z",quality:99},{id:4,name:"asset_registry",schema:"raw",rows:8923,lastRefresh:"2025-11-23T16:00:00Z",quality:91}]),[r]=A.useState([{id:1,source:"customers_raw",target:"customer_mart",type:"aggregate"},{id:2,source:"billing_transactions",target:"customer_mart",type:"join"},{id:3,source:"asset_registry",target:"operations_mart",type:"filter"}]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Data Warehouse & Lineage"}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor data flows, transformations, and quality metrics"})]}),e.jsxs(ss,{defaultValue:"tables",className:"w-full",children:[e.jsxs(Yr,{className:"grid w-full grid-cols-3",children:[e.jsxs(wt,{value:"tables",className:"flex items-center gap-2",children:[e.jsx(Bi,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Tables"})]}),e.jsxs(wt,{value:"lineage",className:"flex items-center gap-2",children:[e.jsx(uie,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Lineage"})]}),e.jsxs(wt,{value:"quality",className:"flex items-center gap-2",children:[e.jsx(zs,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Quality"})]})]}),e.jsxs(kt,{value:"tables",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Data Warehouse Tables"}),e.jsxs(K,{size:"sm",children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Add Table"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(s=>e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(he,{className:"text-base",children:s.name}),e.jsxs(mr,{className:"mt-1",children:[s.schema," schema"]})]}),e.jsx(Ae,{variant:"outline",children:s.schema})]})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"ROWS"}),e.jsx("p",{className:"font-bold",children:s.rows.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"QUALITY SCORE"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full",children:e.jsx("div",{className:"h-2 rounded-full bg-green-500",style:{width:`${s.quality}%`}})}),e.jsxs("span",{className:"font-bold text-sm",children:[s.quality,"%"]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Last Refreshed: ",new Date(s.lastRefresh).toLocaleString()]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(K,{size:"sm",variant:"outline",className:"flex-1",children:"Profile"}),e.jsxs(K,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(d9,{className:"h-3 w-3 mr-1"}),"Refresh"]})]})]})]},s.id))})]}),e.jsxs(kt,{value:"lineage",className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Data Lineage & Transformations"}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsx("div",{className:"space-y-4",children:r.map((s,n)=>e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"font-mono text-sm font-medium",children:s.source}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("div",{className:"flex-1 h-0.5 bg-gray-300"}),e.jsx(Ae,{variant:"outline",className:"flex-shrink-0",children:s.type}),e.jsx("div",{className:"flex-1 h-0.5 bg-gray-300"})]}),e.jsx("div",{className:"font-mono text-sm font-medium",children:s.target})]},s.id))})})}),e.jsxs(H,{className:"bg-blue-50 border-blue-200",children:[e.jsx(ue,{children:e.jsx(he,{className:"text-blue-900 text-base",children:"Lineage Analysis"})}),e.jsxs(X,{className:"text-sm text-blue-800 space-y-2",children:[e.jsx("p",{children:" Track data dependencies across all tables"}),e.jsx("p",{children:" Identify transformation bottlenecks"}),e.jsx("p",{children:" Impact analysis for schema changes"})]})]})]}),e.jsxs(kt,{value:"quality",className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Data Quality Metrics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"COMPLETENESS"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:"99.2%"}),e.jsx(Ae,{className:"mt-2 bg-green-100 text-green-800",children:"Excellent"})]})}),e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"ACCURACY"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:"98.7%"}),e.jsx(Ae,{className:"mt-2 bg-green-100 text-green-800",children:"Excellent"})]})}),e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"CONSISTENCY"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:"97.1%"}),e.jsx(Ae,{className:"mt-2 bg-yellow-100 text-yellow-800",children:"Good"})]})}),e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"TIMELINESS"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:"100%"}),e.jsx(Ae,{className:"mt-2 bg-green-100 text-green-800",children:"Excellent"})]})})]})]})]})]})}const iw="/api/v1/integration";async function c8e(){return(await fetch(`${iw}/notifications/queue`)).json()}async function d8e(){return(await fetch(`${iw}/devices`)).json()}async function u8e(){return(await fetch(`${iw}/observability/alerts`)).json()}async function h8e(){return(await fetch(`${iw}/observability/dashboard`)).json()}async function m8e(){return(await fetch(`${iw}/secrets/audit-log`)).json()}function f8e(){const[t,r]=A.useState([{id:1,name:"Email Notifications",type:"email",status:"active",config:"SendGrid"},{id:2,name:"SMS Alerts",type:"sms",status:"active",config:"Twilio"},{id:3,name:"Slack Integration",type:"slack",status:"active",config:"Webhook"}]),[s,n]=A.useState([{id:1,key:"alert_system_down",name:"System Alert",subject:"System Downtime Alert",vars:4},{id:2,key:"report_generated",name:"Report Ready",subject:"Your Report is Ready",vars:3},{id:3,key:"payment_received",name:"Payment Confirmation",subject:"Payment Received",vars:5}]),[a,o]=A.useState([{id:1,template:"alert_system_down",recipient:"admin@example.com",status:"sent",channel:"email"},{id:2,template:"report_generated",recipient:"+254712345678",status:"pending",channel:"sms",retry:2},{id:3,template:"payment_received",recipient:"ops-team",status:"sent",channel:"slack"}]);return A.useEffect(()=>{(async()=>{try{const i=await c8e();i.success&&i.queue&&o(i.queue)}catch(i){console.error("Failed to load notification queue:",i)}})()},[]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Advanced Notifications"}),e.jsx("p",{className:"text-muted-foreground",children:"Multi-channel notification management with templates and delivery tracking"})]}),e.jsxs(ss,{defaultValue:"channels",className:"w-full",children:[e.jsxs(Yr,{className:"grid w-full grid-cols-3",children:[e.jsx(wt,{value:"channels",children:"Channels"}),e.jsx(wt,{value:"templates",children:"Templates"}),e.jsx(wt,{value:"queue",children:"Queue"})]}),e.jsxs(kt,{value:"channels",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Notification Channels"}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Add Channel"]})]}),e.jsx("div",{className:"space-y-2",children:t.map(c=>e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[c.type==="email"&&e.jsx(Fm,{className:"h-5 w-5 text-blue-500"}),c.type==="sms"&&e.jsx(Ki,{className:"h-5 w-5 text-green-500"}),c.type==="slack"&&e.jsx(f9,{className:"h-5 w-5 text-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:c.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:c.type.toUpperCase()})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"SERVICE"}),e.jsx("p",{className:"text-sm font-medium mt-1",children:c.config})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"STATUS"}),e.jsx(Ae,{className:"mt-1 bg-green-100 text-green-800",children:c.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"MESSAGES/DAY"}),e.jsx("p",{className:"text-sm font-medium mt-1",children:"1,245"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{size:"sm",variant:"ghost",children:e.jsx(ki,{className:"h-4 w-4"})}),e.jsx(K,{size:"sm",variant:"ghost",className:"text-red-500",children:e.jsx(Ws,{className:"h-4 w-4"})})]})]})})},c.id))})]}),e.jsxs(kt,{value:"templates",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Notification Templates"}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Create Template"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(c=>e.jsxs(H,{children:[e.jsxs(ue,{className:"pb-3",children:[e.jsx(he,{className:"text-base",children:c.name}),e.jsx(mr,{className:"font-mono text-xs",children:c.key})]}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Subject Line:"}),e.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded",children:c.subject})]}),e.jsx("div",{children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Variables: ",c.vars]})}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(K,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(ki,{className:"h-3 w-3 mr-1"}),"Edit"]}),e.jsxs(K,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(jC,{className:"h-3 w-3 mr-1"}),"Test"]})]})]})]},c.id))})]}),e.jsxs(kt,{value:"queue",className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Delivery Queue"}),e.jsx("div",{className:"space-y-2",children:a.map(c=>e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:c.template}),e.jsx("p",{className:"text-xs text-muted-foreground",children:c.recipient})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"CHANNEL"}),e.jsx(Ae,{variant:"outline",className:"mt-1",children:c.channel})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"STATUS"}),e.jsx(Ae,{className:`mt-1 ${c.status==="sent"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:c.status})]}),c.retry&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"RETRIES"}),e.jsxs("p",{className:"text-sm font-medium mt-1",children:[c.retry,"/3"]})]}),e.jsx("div",{className:"flex justify-end gap-2",children:c.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{size:"sm",variant:"outline",children:"Retry"}),e.jsx(K,{size:"sm",variant:"outline",className:"text-red-500",children:"Cancel"})]})})]})})},c.id))}),e.jsxs(H,{className:"bg-blue-50 border-blue-200",children:[e.jsx(ue,{children:e.jsx(he,{className:"text-blue-900 text-base",children:"Queue Stats"})}),e.jsxs(X,{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("p",{children:" Total Sent Today: 3,421"}),e.jsx("p",{children:" Pending: 8"}),e.jsx("p",{children:" Failed (24h): 2"}),e.jsx("p",{children:" Delivery Rate: 99.94%"})]})]})]})]})]})}function p8e(){const[t,r]=A.useState([{id:1,name:"Field Device-001",type:"mobile",os:"Android 12",status:"active",lastSync:"2025-11-24T10:30:00Z",location:"Turkana County",appVersion:"1.2.3"},{id:2,name:"IoT Sensor-042",type:"iot",os:"Linux ARM",status:"active",lastSync:"2025-11-24T15:20:00Z",location:"Borehole-05",appVersion:"2.1.0"},{id:3,name:"Tablet-Ops",type:"tablet",os:"iPadOS 17",status:"offline",lastSync:"2025-11-20T08:00:00Z",location:"Control Center",appVersion:"1.1.5"}]),[s]=A.useState([{id:1,device:"Field Device-001",operation:"create",entity:"customer",status:"synced"},{id:2,device:"IoT Sensor-042",operation:"update",entity:"reading",status:"pending"},{id:3,device:"Tablet-Ops",operation:"delete",entity:"ticket",status:"conflict"}]);A.useEffect(()=>{(async()=>{try{const o=await d8e();o.success&&o.devices&&r(o.devices)}catch(o){console.error("Failed to load devices:",o)}})()},[]);const n=a=>{switch(a){case"active":return"bg-green-100 text-green-800";case"offline":return"bg-gray-100 text-gray-800";case"inactive":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Device Registry & Offline Sync"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage field devices and synchronization queues"})]}),e.jsxs(ss,{defaultValue:"devices",className:"w-full",children:[e.jsxs(Yr,{className:"grid w-full grid-cols-2",children:[e.jsx(wt,{value:"devices",children:"Devices"}),e.jsx(wt,{value:"sync",children:"Sync Queue"})]}),e.jsxs(kt,{value:"devices",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Registered Devices"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t.length," devices registered"]})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Register Device"]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:t.map(a=>e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Nb,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:a.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.os})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"STATUS"}),e.jsx(Ae,{className:`mt-1 ${n(a.status)}`,children:a.status==="active"?e.jsxs(e.Fragment,{children:[e.jsx(yie,{className:"h-3 w-3 mr-1"}),a.status]}):e.jsxs(e.Fragment,{children:[e.jsx(gie,{className:"h-3 w-3 mr-1"}),a.status]})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"LOCATION"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(fn,{className:"h-3 w-3"}),e.jsx("p",{className:"text-sm",children:a.location})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"APP VERSION"}),e.jsxs("p",{className:"text-sm font-medium mt-1",children:["v",a.appVersion]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"LAST SYNC"}),e.jsx("p",{className:"text-sm mt-1",children:new Date(a.lastSync).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{size:"sm",variant:"ghost",children:e.jsx(Gn,{className:"h-4 w-4"})}),e.jsx(K,{size:"sm",variant:"ghost",className:"text-red-500",children:e.jsx(Ws,{className:"h-4 w-4"})})]})]})})},a.id))})]}),e.jsxs(kt,{value:"sync",className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Offline Sync Queue"}),e.jsx("div",{className:"space-y-2",children:s.map(a=>e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:a.device}),e.jsx("p",{className:"text-xs text-muted-foreground font-mono mt-1",children:a.entity})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"OPERATION"}),e.jsx(Ae,{variant:"outline",className:"mt-1",children:a.operation})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"STATUS"}),e.jsx(Ae,{className:`mt-1 ${a.status==="synced"?"bg-green-100 text-green-800":a.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:a.status})]}),e.jsx("div",{}),e.jsxs("div",{className:"flex justify-end gap-2",children:[a.status==="conflict"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{size:"sm",variant:"outline",className:"text-sm",children:"Server"}),e.jsx(K,{size:"sm",variant:"outline",className:"text-sm",children:"Device"})]}),a.status==="pending"&&e.jsx(K,{size:"sm",variant:"outline",children:"Sync Now"})]})]})})},a.id))})]})]})]})}function x8e(){const[t,r]=A.useState([{id:1,name:"High CPU Usage",severity:"critical",condition:"cpu > 85%",status:"open"},{id:2,name:"Database Connection Pool",severity:"warning",condition:"connections > 100",status:"open"},{id:3,name:"API Response Time",severity:"warning",condition:"latency > 2s",status:"active"}]),[s,n]=A.useState([{id:1,policy:"High CPU Usage",severity:"critical",status:"open",firedAt:"2025-11-24T15:32:00Z"},{id:2,policy:"Database Connection Pool",severity:"warning",status:"acknowledged",firedAt:"2025-11-24T14:15:00Z"},{id:3,policy:"API Response Time",severity:"warning",status:"resolved",firedAt:"2025-11-23T10:30:00Z"}]),[a,o]=A.useState(null);return A.useEffect(()=>{(async()=>{try{const[i,f]=await Promise.all([h8e(),u8e()]);i.success&&o(i),f.success&&f.policies&&r(f.policies)}catch(i){console.error("Failed to load observability data:",i)}})()},[]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Observability & Ops Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"System metrics, alerts, and incident management"})]}),e.jsxs(ss,{defaultValue:"metrics",className:"w-full",children:[e.jsxs(Yr,{className:"grid w-full grid-cols-3",children:[e.jsx(wt,{value:"metrics",children:"Metrics"}),e.jsx(wt,{value:"alerts",children:"Alert Policies"}),e.jsx(wt,{value:"incidents",children:"Incidents"})]}),e.jsxs(kt,{value:"metrics",className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"System Metrics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"CPU USAGE"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:"42%"}),e.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full mt-2",children:e.jsx("div",{className:"h-2 bg-yellow-500 rounded-full",style:{width:"42%"}})})]})}),e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"MEMORY"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:"68%"}),e.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full mt-2",children:e.jsx("div",{className:"h-2 bg-orange-500 rounded-full",style:{width:"68%"}})})]})}),e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"API LATENCY"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:"127ms"}),e.jsx(Ae,{className:"mt-2 bg-green-100 text-green-800",children:"Good"})]})}),e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"ERROR RATE"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:"0.2%"}),e.jsx(Ae,{className:"mt-2 bg-green-100 text-green-800",children:"Excellent"})]})})]})]}),e.jsxs(kt,{value:"alerts",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h2",{className:"text-lg font-semibold",children:["Alert Policies (",t.length,")"]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Create Alert"]})]}),e.jsx("div",{className:"space-y-2",children:t.map(c=>e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:c.name}),e.jsx("p",{className:"text-xs text-muted-foreground font-mono mt-1",children:c.condition})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"SEVERITY"}),e.jsx(Ae,{className:`mt-1 ${c.severity==="critical"?"bg-red-100 text-red-800":c.severity==="warning"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:c.severity})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"STATUS"}),e.jsx(Ae,{className:"mt-1 bg-green-100 text-green-800",children:c.status})]}),e.jsx("div",{}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{size:"sm",variant:"outline",children:"Edit"}),e.jsx(K,{size:"sm",variant:"outline",className:"text-red-500",children:"Delete"})]})]})})},c.id))})]}),e.jsxs(kt,{value:"incidents",className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-semibold",children:["Active Incidents (",s.filter(c=>c.status==="open").length,")"]}),e.jsx("div",{className:"space-y-2",children:s.map(c=>e.jsx(H,{className:c.status==="open"?"border-red-200 bg-red-50":"",children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-center",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[c.status==="open"&&e.jsx(Fr,{className:"h-5 w-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:c.policy}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(c.firedAt).toLocaleString()})]})]})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"SEVERITY"}),e.jsx(Ae,{className:`mt-1 ${c.severity==="critical"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:c.severity})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"STATUS"}),e.jsx(Ae,{className:`mt-1 ${c.status==="open"?"bg-red-100 text-red-800":c.status==="acknowledged"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:c.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"DURATION"}),e.jsx("p",{className:"text-sm mt-1",children:"45 minutes"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[c.status==="open"&&e.jsxs(K,{size:"sm",variant:"outline",children:[e.jsx(Kc,{className:"h-3 w-3 mr-1"}),"Acknowledge"]}),c.status!=="resolved"&&e.jsx(K,{size:"sm",variant:"outline",children:"Resolve"})]})]})})},c.id))})]})]})]})}function g8e(){const[t]=A.useState([{id:1,name:"Daily Full Backup",type:"full",schedule:"02:00 UTC",retention:"30 days",status:"active"},{id:2,name:"Hourly Incremental",type:"incremental",schedule:"Every hour",retention:"7 days",status:"active"},{id:3,name:"Weekly Snapshot",type:"snapshot",schedule:"Sunday 03:00 UTC",retention:"90 days",status:"active"}]),[r]=A.useState([{id:1,policy:"Daily Full Backup",size:"45.2 GB",status:"completed",date:"2025-11-24T02:15:00Z",duration:"3h 42m"},{id:2,policy:"Daily Full Backup",size:"44.8 GB",status:"completed",date:"2025-11-23T02:10:00Z",duration:"3h 38m"},{id:3,policy:"Hourly Incremental",size:"312 MB",status:"completed",date:"2025-11-24T14:00:00Z",duration:"12m"}]),[s]=A.useState({name:"Primary Site Recovery",rto:15,rpo:5,services:8,lastTested:"2025-11-15T10:30:00Z"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Backup & Disaster Recovery"}),e.jsx("p",{className:"text-muted-foreground",children:"Data protection and business continuity management"})]}),e.jsxs(ss,{defaultValue:"policies",className:"w-full",children:[e.jsxs(Yr,{className:"grid w-full grid-cols-3",children:[e.jsx(wt,{value:"policies",children:"Policies"}),e.jsx(wt,{value:"backups",children:"Backup Jobs"}),e.jsx(wt,{value:"drplan",children:"DR Plan"})]}),e.jsxs(kt,{value:"policies",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Backup Policies"}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Create Policy"]})]}),e.jsx("div",{className:"space-y-2",children:t.map(n=>e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n.name}),e.jsx(Ae,{variant:"outline",className:"mt-1",children:n.type})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"SCHEDULE"}),e.jsx("p",{className:"text-sm mt-1",children:n.schedule})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"RETENTION"}),e.jsx("p",{className:"text-sm mt-1",children:n.retention})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"STATUS"}),e.jsx(Ae,{className:"mt-1 bg-green-100 text-green-800",children:n.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"NEXT RUN"}),e.jsx("p",{className:"text-sm mt-1",children:"In 8h 23m"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{size:"sm",variant:"ghost",children:e.jsx(Ui,{className:"h-4 w-4"})}),e.jsx(K,{size:"sm",variant:"ghost",children:e.jsx(ki,{className:"h-4 w-4"})}),e.jsx(K,{size:"sm",variant:"ghost",className:"text-red-500",children:e.jsx(Ws,{className:"h-4 w-4"})})]})]})})},n.id))})]}),e.jsxs(kt,{value:"backups",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Recent Backup Jobs"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.length," backups completed"]})]}),e.jsxs(K,{size:"sm",children:[e.jsx(Ui,{className:"h-4 w-4 mr-2"}),"Run Backup Now"]})]}),e.jsx("div",{className:"space-y-2",children:r.map(n=>e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:n.policy}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(n.date).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"SIZE"}),e.jsx("p",{className:"font-medium mt-1",children:n.size})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"DURATION"}),e.jsx("p",{className:"text-sm mt-1",children:n.duration})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"STATUS"}),e.jsx(Ae,{className:"mt-1 bg-green-100 text-green-800",children:n.status})]}),e.jsx("div",{}),e.jsx("div",{className:"flex justify-end gap-2",children:e.jsxs(K,{size:"sm",variant:"outline",className:"text-sm",children:[e.jsx(ma,{className:"h-3 w-3 mr-1"}),"Restore"]})})]})})},n.id))})]}),e.jsxs(kt,{value:"drplan",className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Disaster Recovery Plan"}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:s.name})}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-xs text-blue-600 font-semibold",children:"RTO (Recovery Time Objective)"}),e.jsxs("p",{className:"text-3xl font-bold text-blue-900 mt-2",children:[s.rto,"m"]}),e.jsx("p",{className:"text-sm text-blue-700 mt-2",children:"Maximum allowable downtime"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-xs text-green-600 font-semibold",children:"RPO (Recovery Point Objective)"}),e.jsxs("p",{className:"text-3xl font-bold text-green-900 mt-2",children:[s.rpo,"m"]}),e.jsx("p",{className:"text-sm text-green-700 mt-2",children:"Maximum data loss acceptable"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-xs text-purple-600 font-semibold",children:"Critical Services"}),e.jsx("p",{className:"text-3xl font-bold text-purple-900 mt-2",children:s.services}),e.jsx("p",{className:"text-sm text-purple-700 mt-2",children:"Protected systems"})]})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($s,{className:"h-5 w-5 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Last DR Test"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(s.lastTested).toLocaleString()})]})]}),e.jsxs(K,{size:"sm",children:[e.jsx(Ui,{className:"h-4 w-4 mr-2"}),"Test DR Plan"]})]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Recovery Steps"}),e.jsxs("ol",{className:"space-y-2",children:[e.jsxs("li",{className:"flex gap-3",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-blue-100 text-blue-800 text-sm flex items-center justify-center",children:"1"}),e.jsx("span",{className:"text-sm",children:"Notify incident response team"})]}),e.jsxs("li",{className:"flex gap-3",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-blue-100 text-blue-800 text-sm flex items-center justify-center",children:"2"}),e.jsx("span",{className:"text-sm",children:"Activate standby infrastructure"})]}),e.jsxs("li",{className:"flex gap-3",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-blue-100 text-blue-800 text-sm flex items-center justify-center",children:"3"}),e.jsx("span",{className:"text-sm",children:"Restore databases from latest backup"})]}),e.jsxs("li",{className:"flex gap-3",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-blue-100 text-blue-800 text-sm flex items-center justify-center",children:"4"}),e.jsx("span",{className:"text-sm",children:"Verify application functionality"})]}),e.jsxs("li",{className:"flex gap-3",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-blue-100 text-blue-800 text-sm flex items-center justify-center",children:"5"}),e.jsx("span",{className:"text-sm",children:"Switch DNS to recovery site"})]})]})]})]})]})]})]})]})}function y8e(){const[t,r]=A.useState([{id:1,key:"SENDGRID_API_KEY",type:"api_key",owner:"Integrations",expiresIn:"45 days",lastRotated:"2025-10-01"},{id:2,key:"DATABASE_PASSWORD",type:"password",owner:"Database",expiresIn:"Never",lastRotated:"2025-06-15"},{id:3,key:"TWILIO_AUTH_TOKEN",type:"token",owner:"Communications",expiresIn:"30 days",lastRotated:"2025-11-01"},{id:4,key:"SSL_CERTIFICATE",type:"certificate",owner:"Infrastructure",expiresIn:"60 days",lastRotated:"N/A"}]),[s,n]=A.useState([{id:1,secret:"SENDGRID_API_KEY",accessedBy:"admin@example.com",type:"read",timestamp:"2025-11-24T14:32:00Z",ip:"192.168.1.1"},{id:2,secret:"DATABASE_PASSWORD",accessedBy:"backup-service",type:"read",timestamp:"2025-11-24T10:00:00Z",ip:"10.0.0.5"},{id:3,secret:"TWILIO_AUTH_TOKEN",accessedBy:"notifications-service",type:"read",timestamp:"2025-11-24T15:20:00Z",ip:"10.0.1.3"}]);A.useEffect(()=>{(async()=>{try{const w=await m8e();w.success&&w.logs&&n(w.logs)}catch(w){console.error("Failed to load audit log:",w)}})()},[]);const[a,o]=A.useState({}),[c,i]=A.useState(""),f=b=>{o(w=>({...w,[b]:!w[b]}))},p=b=>{navigator.clipboard.writeText(b)},g=b=>{switch(b){case"api_key":return"bg-blue-100 text-blue-800";case"password":return"bg-red-100 text-red-800";case"token":return"bg-green-100 text-green-800";case"certificate":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},y=t.filter(b=>b.key.toLowerCase().includes(c.toLowerCase()));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Secrets Vault"}),e.jsx("p",{className:"text-muted-foreground",children:"Secure credential storage with encryption and rotation policies"})]}),e.jsxs(ss,{defaultValue:"secrets",className:"w-full",children:[e.jsxs(Yr,{className:"grid w-full grid-cols-2",children:[e.jsx(wt,{value:"secrets",children:"Secrets"}),e.jsx(wt,{value:"audit",children:"Access Audit"})]}),e.jsxs(kt,{value:"secrets",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Stored Secrets"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[y.length," secrets encrypted"]})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Add Secret"]})]}),e.jsx(Ie,{placeholder:"Search secrets...",value:c,onChange:b=>i(b.target.value),className:"max-w-xs"}),e.jsx("div",{className:"space-y-2",children:y.map(b=>e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 items-center",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(sm,{className:"h-4 w-4 text-blue-500"}),e.jsx("p",{className:"font-mono font-medium text-sm",children:b.key})]})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"TYPE"}),e.jsx(Ae,{className:`mt-1 ${g(b.type)}`,children:b.type})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"OWNER"}),e.jsx("p",{className:"text-sm mt-1",children:b.owner})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"EXPIRES IN"}),e.jsx(Ae,{variant:"outline",className:b.expiresIn==="Never"?"":b.expiresIn.includes("30")?"border-yellow-300":"",children:b.expiresIn})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"LAST ROTATED"}),e.jsx("p",{className:"text-sm mt-1",children:b.lastRotated})]}),e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(K,{size:"sm",variant:"ghost",onClick:()=>f(b.id),children:a[b.id]?e.jsx(_b,{className:"h-4 w-4"}):e.jsx(mo,{className:"h-4 w-4"})}),e.jsx(K,{size:"sm",variant:"ghost",onClick:()=>p(""),children:e.jsx(P_,{className:"h-4 w-4"})}),e.jsx(K,{size:"sm",variant:"ghost",children:e.jsx(die,{className:"h-4 w-4"})}),e.jsx(K,{size:"sm",variant:"ghost",className:"text-red-500",children:e.jsx(Ws,{className:"h-4 w-4"})})]})]})})},b.id))}),e.jsxs(H,{className:"bg-amber-50 border-amber-200",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Nn,{className:"h-5 w-5 text-amber-600"}),e.jsx(he,{className:"text-amber-900",children:"Rotation Reminders"})]})}),e.jsxs(X,{className:"text-sm text-amber-800 space-y-2",children:[e.jsx("p",{children:" SENDGRID_API_KEY - Rotate in 45 days"}),e.jsx("p",{children:" TWILIO_AUTH_TOKEN - Rotate in 30 days"}),e.jsx("p",{children:" DATABASE_PASSWORD - No expiration set"})]})]})]}),e.jsxs(kt,{value:"audit",className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Access Audit Log"}),e.jsx("div",{className:"space-y-2",children:s.map(b=>e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-mono font-medium text-sm",children:b.secret}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:b.accessedBy})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"ACCESS TYPE"}),e.jsx(Ae,{variant:"outline",className:"mt-1",children:b.type})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"TIMESTAMP"}),e.jsx("p",{className:"text-sm mt-1",children:new Date(b.timestamp).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"IP ADDRESS"}),e.jsx("p",{className:"font-mono text-sm mt-1",children:b.ip})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(K,{size:"sm",variant:"outline",children:"Details"})})]})})},b.id))})]})]})]})}function v8e(){const t=[{name:"SCADA",description:"OPC-UA / MQTT telemetry",status:"available"},{name:"AMI",description:"DLMS / CSV / S3 meter data",status:"available"},{name:"ERP",description:"GL journal integration",status:"available"},{name:"WARIS",description:"Regulator reporting",status:"available"},{name:"NDMA",description:"Early warning feeds",status:"available"},{name:"Payments",description:"M-Pesa / Airtel Money",status:"available"},{name:"Messaging",description:"SMS / WhatsApp / Email",status:"available"},{name:"Custom",description:"Build your own",status:"available"}];return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Connector Gallery"}),e.jsx("p",{className:"text-muted-foreground",children:"Pre-built adapters for SCADA, AMI, ERP, and external systems"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:t.map(r=>e.jsxs(H,{className:"hover:border-primary transition-colors cursor-pointer",children:[e.jsxs(ue,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(he,{className:"text-base",children:r.name}),e.jsx(Gn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(mr,{className:"text-xs",children:r.description})]}),e.jsx(X,{children:e.jsx(K,{size:"sm",variant:"outline",className:"w-full",children:"Setup Connector"})})]},r.name))})]})}function j8e(){return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Webhook Manager"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure webhooks for event notifications and callbacks"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Create Webhook"]})]}),e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Active Webhooks"}),e.jsx(mr,{children:"Event subscriptions and delivery logs"})]}),e.jsx(X,{children:e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(f9,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),e.jsx("p",{children:"No webhooks configured. Create your first webhook above."})]})})]})]})}function b8e(){return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"ETL Jobs"}),e.jsx("p",{className:"text-muted-foreground",children:"Extract, Transform, Load jobs for data integration"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Create ETL Job"]})]}),e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Scheduled Jobs"}),e.jsx(mr,{children:"Import, export, and transformation pipelines"})]}),e.jsx(X,{children:e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(Bi,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),e.jsx("p",{children:"No ETL jobs defined. Create your first job to start data integration."})]})})]})]})}function _8e(){return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Communication Templates"}),e.jsx("p",{className:"text-muted-foreground",children:"SMS, Email, WhatsApp templates with i18n support"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Create Template"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:["SMS","Email","WhatsApp","USSD"].map(t=>e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{className:"text-base",children:t}),e.jsx(mr,{children:"0 templates"})]}),e.jsx(X,{children:e.jsx(K,{size:"sm",variant:"outline",className:"w-full",children:"New Template"})})]},t))}),e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Template Library"}),e.jsx(mr,{children:"All communication templates"})]}),e.jsx(X,{children:e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(Fm,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),e.jsx("p",{children:"No templates created yet. Create templates for customer notifications."})]})})]})]})}function w8e(){const[t,r]=A.useState(!1),{data:s}=it({queryKey:["kpi-dashboard"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/kpis/dashboard/summary")).json()}),n=(s==null?void 0:s.data)||{water_coverage:78.5,nrw_percent:32.8,staff_efficiency:8.2,collection_efficiency:91.2};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"KPI Dashboard"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"WHO/JMP & WASREB aligned performance indicators"})]}),e.jsxs(K,{onClick:()=>r(!0),className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New KPI"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Water Coverage"}),e.jsx(zc,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[n.water_coverage,"%"]}),e.jsxs("div",{className:"flex items-center text-xs text-green-600",children:[e.jsx(zs,{className:"h-3 w-3 mr-1"}),"+2.3% from last quarter"]})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"NRW %"}),e.jsx(zc,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[n.nrw_percent,"%"]}),e.jsxs("div",{className:"flex items-center text-xs text-green-600",children:[e.jsx(ci,{className:"h-3 w-3 mr-1"}),"-4.2% improvement"]})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Staff Efficiency"}),e.jsx(zc,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.staff_efficiency}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Connections per staff"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Collection Efficiency"}),e.jsx(zc,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[n.collection_efficiency,"%"]}),e.jsxs("div",{className:"flex items-center text-xs text-green-600",children:[e.jsx(zs,{className:"h-3 w-3 mr-1"}),"+1.5%"]})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"KPI Catalog & Management"})}),e.jsx(X,{children:e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:"KPI catalog, data entry, and threshold alerts"}),e.jsx("p",{className:"text-sm mt-2",children:"Production-ready data layer with real API integration"})]})})]})]})}function N8e(){const{data:t}=it({queryKey:["coverage-dashboard"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/coverage/dashboard")).json()}),{data:r}=it({queryKey:["coverage-by-area"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/coverage/by-area")).json()}),s=(t==null?void 0:t.data)||{total_population:245800,population_served:193100,coverage_percent:78.5};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Coverage & Equity Analytics"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Water and sanitation coverage by area, demographic disaggregation, and equity analysis"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total Population"}),e.jsx(Ds,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(s.total_population||245800).toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all wards"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Population Served"}),e.jsx(Fl,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(s.population_served||193100).toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"With piped connections"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Coverage Rate"}),e.jsx(fy,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[s.coverage_percent,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Overall water coverage"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Coverage Analytics"})}),e.jsx(X,{children:e.jsxs(ss,{defaultValue:"by-ward",className:"w-full",children:[e.jsxs(Yr,{className:"grid w-full grid-cols-2",children:[e.jsx(wt,{value:"by-ward",children:"By Ward"}),e.jsx(wt,{value:"equity",children:"Equity Analysis"})]}),e.jsx(kt,{value:"by-ward",className:"mt-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Ward-level coverage breakdown"}),r!=null&&r.data&&r.data.length>0?e.jsx("div",{className:"max-h-96 overflow-y-auto",children:r.data.map((n,a)=>{var o;return e.jsx("div",{className:"p-3 border rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-sm",children:n.area_type}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Population: ",(n.population_total||0).toLocaleString()]}),e.jsxs("span",{children:["Served: ",(n.population_served||0).toLocaleString()]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold",children:[(o=n.coverage_percent)==null?void 0:o.toFixed(1),"%"]}),e.jsx(zs,{className:"h-3 w-3 text-green-600 mt-1"})]})]})},`${n.area_id}-${a}`)})}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No coverage data available"})]})}),e.jsx(kt,{value:"equity",className:"mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Gender and income quintile disaggregation analysis"}),e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Demographic Breakdowns"}),e.jsxs("ul",{className:"text-sm space-y-2 text-muted-foreground",children:[e.jsx("li",{children:" Gender: Male / Female population coverage differential"}),e.jsx("li",{children:" Income Quintiles: Q1-Q5 water access equity metrics"}),e.jsx("li",{children:" Geographic: Urban / Rural coverage disparity"}),e.jsx("li",{children:" Age Groups: Child / Adult / Senior population served"})]})]})]})})]})})]})]})}function S8e(){const{data:t}=it({queryKey:["nrw-dashboard"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/nrw/dashboard")).json()}),{data:r}=it({queryKey:["nrw-initiatives"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/nrw/initiatives")).json()}),s=(t==null?void 0:t.data)||{current_nrw_percent:32.8,water_saved_m3_day:1850,average_roi_percent:185};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"NRW Program Tracker"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Non-Revenue Water initiatives, savings tracking, and ROI analysis"})]}),e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Initiative"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Current NRW %"}),e.jsx(Fl,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[s.current_nrw_percent,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Down from 37% baseline"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Water Saved"}),e.jsx(ci,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[s.water_saved_m3_day.toLocaleString()," m/day"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Cumulative savings"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Investment ROI"}),e.jsx(Ga,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[Math.round(s.average_roi_percent),"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Average payback ROI"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Initiative Pipeline"})}),e.jsx(X,{children:e.jsxs(ss,{defaultValue:"all",className:"w-full",children:[e.jsxs(Yr,{className:"grid w-full grid-cols-4",children:[e.jsx(wt,{value:"all",children:"All"}),e.jsx(wt,{value:"proposed",children:"Proposed"}),e.jsx(wt,{value:"active",children:"Active"}),e.jsx(wt,{value:"verified",children:"Verified"})]}),e.jsx(kt,{value:"all",className:"mt-4",children:e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:r!=null&&r.data&&r.data.length>0?r.data.map(n=>e.jsx("div",{className:"p-3 border rounded-lg",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm",children:n.name}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Type: ",n.type.replace("_"," ")," | Stage: ",n.stage]}),n.roi_percent&&e.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["ROI: ",n.roi_percent.toFixed(1),"%"]})]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Cost: $",n.cost.toLocaleString()]})]})},n.id)):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No initiatives yet"})})})]})})]})]})}function C8e(){const{data:t}=it({queryKey:["surveys-analytics"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/surveys/analytics/summary")).json()}),{data:r}=it({queryKey:["surveys"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/surveys")).json()}),s=(t==null?void 0:t.data)||{nps_score:42,csat_avg:4.2,total_responses:1250,active_surveys:3,response_rate_percent:28};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Customer Experience Analytics"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"NPS, CSAT, and CES tracking, survey management, and sentiment analysis"})]}),e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Survey"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"NPS Score"}),e.jsx(Ni,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.nps_score}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Net Promoter Score"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"CSAT"}),e.jsx(u9,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[s.csat_avg.toFixed(1)," / 5"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Customer Satisfaction"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Response Rate"}),e.jsx(h9,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[s.response_rate_percent,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Survey participation"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total Responses"}),e.jsx(Wl,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.total_responses.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Cumulative feedback"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Active Surveys"}),e.jsx(Ni,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.active_surveys}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Running campaigns"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Survey Campaigns"})}),e.jsx(X,{children:e.jsxs(ss,{defaultValue:"all",className:"w-full",children:[e.jsxs(Yr,{className:"grid w-full grid-cols-3",children:[e.jsx(wt,{value:"all",children:"All"}),e.jsx(wt,{value:"active",children:"Active"}),e.jsx(wt,{value:"closed",children:"Closed"})]}),e.jsx(kt,{value:"all",className:"mt-4",children:r!=null&&r.data&&r.data.length>0?e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:r.data.map(n=>e.jsx("div",{className:"p-3 border rounded-lg",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm",children:n.name}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Type: ",n.type.toUpperCase()," | Channel: ",n.channel," | Status: ",n.status]})]}),e.jsxs("span",{className:"text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded",children:[n.responses_count||0," responses"]})]})},n.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No surveys yet"})})]})})]})]})}function P8e(){var a;const[t,r]=A.useState(null),{data:s}=it({queryKey:["indicators",t],queryFn:async()=>{const o=new URL("/api/v1/monitoring-evaluation/indicators",window.location.origin);return t&&o.searchParams.set("level",t),(await fetch(o)).json()}}),n=[{id:"impact",label:"Impact Indicators",color:"bg-red-100 text-red-800"},{id:"outcome",label:"Outcome Indicators",color:"bg-orange-100 text-orange-800"},{id:"output",label:"Output Indicators",color:"bg-blue-100 text-blue-800"},{id:"activity",label:"Activity Indicators",color:"bg-green-100 text-green-800"}];return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Results Framework & Logframe"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Impact, outcome, output, and activity indicators with baseline and target tracking"})]}),e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Indicator"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:n.map(o=>{var c;return e.jsxs(H,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>r(t===o.id?null:o.id),children:[e.jsx(ue,{className:"pb-3",children:e.jsx(he,{className:"text-sm",children:o.label})}),e.jsx(X,{children:e.jsxs("div",{className:`inline-block px-2 py-1 rounded text-xs font-medium ${o.color}`,children:[((c=s==null?void 0:s.data)==null?void 0:c.filter(i=>i.level===o.id).length)||0," indicators"]})})]},o.id)})}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(pm,{className:"h-5 w-5"}),"Indicator Management"]})}),e.jsx(X,{children:t?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Displaying ",(a=n.find(o=>o.id===t))==null?void 0:a.label]}),s!=null&&s.data&&s.data.length>0?e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:s.data.map(o=>e.jsx("div",{className:"p-3 border rounded-lg",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-sm",children:o.name}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:o.code}),o.target_value&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs",children:[e.jsx(zs,{className:"h-3 w-3"}),"Target: ",o.target_value," ",o.unit||""]})]})})},o.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No indicators for this level yet"})]}):e.jsx("p",{className:"text-muted-foreground",children:"Select a level to view indicators, manage baselines, targets, and track progress data"})})]})]})}const ln="/crm",ra={getTariffs:t=>pe.get(`${ln}/tariffs`,{params:t}),getTariff:t=>pe.get(`${ln}/tariffs/${t}`),createTariff:t=>pe.post(`${ln}/tariffs`,t),updateTariff:(t,r)=>pe.patch(`${ln}/tariffs/${t}`,r),deleteTariff:t=>pe.delete(`${ln}/tariffs/${t}`),calculateTariff:(t,r)=>pe.post(`${ln}/tariffs/calculate`,{tariff_id:t,consumption:r}),getBillingRuns:t=>pe.get(`${ln}/billing/runs`,{params:t}),previewBilling:t=>pe.post(`${ln}/billing/preview`,t),executeBilling:t=>pe.post(`${ln}/billing/execute`,t),getPayments:t=>pe.get(`${ln}/reconciliation/payments`,{params:t}),reconcilePayment:(t,r)=>pe.post(`${ln}/reconciliation/reconcile`,{payment_id:t,invoice_ids:r}),getAgingReport:()=>pe.get(`${ln}/reconciliation/aging`),getMeterRoutes:t=>pe.get(`${ln}/meter-routes`,{params:t}),createMeterRoute:t=>pe.post(`${ln}/meter-routes`,t),updateMeterRoute:(t,r)=>pe.patch(`${ln}/meter-routes/${t}`,r),deleteMeterRoute:t=>pe.delete(`${ln}/meter-routes/${t}`),downloadOfflinePackage:t=>pe.get(`${ln}/meter-routes/${t}/offline`),uploadMeterReads:(t,r)=>pe.post(`${ln}/meter-routes/${t}/upload`,{reads:r}),getConnectionApplications:t=>pe.get(`${ln}/connections/applications`,{params:t}),submitApplication:t=>pe.post(`${ln}/connections/apply`,t),updateApplication:(t,r)=>pe.patch(`${ln}/connections/applications/${t}`,r),getDisconnections:t=>pe.get(`${ln}/connections/disconnections`,{params:t}),requestDisconnection:t=>pe.post(`${ln}/connections/disconnect`,t),reconnectAccount:t=>pe.post(`${ln}/connections/reconnect`,t),getKiosks:t=>pe.get(`${ln}/kiosks`,{params:t}),createKiosk:t=>pe.post(`${ln}/kiosks`,t),updateKiosk:(t,r)=>pe.patch(`${ln}/kiosks/${t}`,r),deleteKiosk:t=>pe.delete(`${ln}/kiosks/${t}`),getKioskSales:(t,r)=>pe.get(`${ln}/kiosks/${t}/sales`,{params:r}),getTrucks:t=>pe.get(`${ln}/kiosks/trucks`,{params:t})};function k8e(){var C,D;const[t,r]=A.useState(!1),[s,n]=A.useState(null),[a,o]=A.useState("all"),[c,i]=A.useState(""),f=yr(),{data:p,isLoading:g}=it({queryKey:["tariffs",a,c],queryFn:()=>ra.getTariffs({status:a==="all"?void 0:a,search:c||void 0,per_page:50})}),y=gt({mutationFn:ra.createTariff,onSuccess:()=>{f.invalidateQueries({queryKey:["tariffs"]}),r(!1),n(null),Me.success("Tariff created successfully")},onError:L=>{var F,B;Me.error(((B=(F=L.response)==null?void 0:F.data)==null?void 0:B.message)||"Failed to create tariff")}}),b=gt({mutationFn:({id:L,data:F})=>ra.updateTariff(L,F),onSuccess:()=>{f.invalidateQueries({queryKey:["tariffs"]}),r(!1),n(null),Me.success("Tariff updated successfully")},onError:L=>{var F,B;Me.error(((B=(F=L.response)==null?void 0:F.data)==null?void 0:B.message)||"Failed to update tariff")}}),w=gt({mutationFn:ra.deleteTariff,onSuccess:()=>{f.invalidateQueries({queryKey:["tariffs"]}),Me.success("Tariff deleted successfully")},onError:L=>{var F,B;Me.error(((B=(F=L.response)==null?void 0:F.data)==null?void 0:B.message)||"Failed to delete tariff")}}),T=L=>{L.preventDefault();const F=new FormData(L.currentTarget),B=[];let U=0;for(;F.has(`block_${U}_min`);)B.push({min:parseFloat(F.get(`block_${U}_min`)),max:F.get(`block_${U}_max`)?parseFloat(F.get(`block_${U}_max`)):null,rate:parseFloat(F.get(`block_${U}_rate`)),lifeline:F.get(`block_${U}_lifeline`)==="on"}),U++;const te={name:F.get("name"),valid_from:F.get("valid_from"),valid_to:F.get("valid_to")||null,blocks:B,fixed_charge:parseFloat(F.get("fixed_charge"))||0,currency:F.get("currency")||"KES"};s?b.mutate({id:s.id,data:te}):y.mutate(te)},N=L=>{n(L),r(!0)},M=L=>{confirm("Are you sure you want to delete this tariff?")&&w.mutate(L)},O=L=>{const F=new Date,B=new Date(L.valid_from),U=L.valid_to?new Date(L.valid_to):null;return B>F?e.jsx(Ae,{variant:"secondary",children:"Future"}):U&&U<F?e.jsx(Ae,{variant:"destructive",children:"Expired"}):e.jsx(Ae,{className:"bg-green-600",children:"Active"})};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Customer Tariffs"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Water pricing structures by customer category"})]}),e.jsxs(Qt,{open:t,onOpenChange:r,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{onClick:()=>n(null),children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Create Tariff"]})}),e.jsxs(Zt,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:s?"Edit Tariff":"Create New Tariff"})}),e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"name",children:"Tariff Name"}),e.jsx(Ie,{id:"name",name:"name",defaultValue:s==null?void 0:s.name,required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"currency",children:"Currency"}),e.jsx(Ie,{id:"currency",name:"currency",defaultValue:(s==null?void 0:s.currency)||"KES",maxLength:3})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"valid_from",children:"Valid From"}),e.jsx(Ie,{id:"valid_from",name:"valid_from",type:"date",defaultValue:s==null?void 0:s.valid_from,required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"valid_to",children:"Valid To (Optional)"}),e.jsx(Ie,{id:"valid_to",name:"valid_to",type:"date",defaultValue:(s==null?void 0:s.valid_to)||""})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(we,{htmlFor:"fixed_charge",children:"Fixed Charge"}),e.jsx(Ie,{id:"fixed_charge",name:"fixed_charge",type:"number",step:"0.01",defaultValue:(s==null?void 0:s.fixed_charge)||0})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Rate Blocks"}),((s==null?void 0:s.blocks)||[{min:0,max:10,rate:50,lifeline:!0}]).map((L,F)=>e.jsxs("div",{className:"grid grid-cols-5 gap-2 mb-2",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:`block_${F}_min`,children:"Min (m)"}),e.jsx(Ie,{id:`block_${F}_min`,name:`block_${F}_min`,type:"number",step:"0.01",defaultValue:L.min,required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:`block_${F}_max`,children:"Max (m)"}),e.jsx(Ie,{id:`block_${F}_max`,name:`block_${F}_max`,type:"number",step:"0.01",defaultValue:L.max||"",placeholder:""})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:`block_${F}_rate`,children:"Rate"}),e.jsx(Ie,{id:`block_${F}_rate`,name:`block_${F}_rate`,type:"number",step:"0.01",defaultValue:L.rate,required:!0})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:`block_${F}_lifeline`,defaultChecked:L.lifeline}),e.jsx("span",{className:"text-sm",children:"Lifeline"})]})})]},F)),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Add more blocks by manually editing after creation"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsxs(K,{type:"submit",disabled:y.isPending||b.isPending,children:[s?"Update":"Create"," Tariff"]})]})]})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(Ga,{className:"h-5 w-5"}),"Tariff Management"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ie,{placeholder:"Search tariffs...",value:c,onChange:L=>i(L.target.value),className:"w-64"}),e.jsxs(Nt,{value:a,onValueChange:L=>o(L),children:[e.jsx(bt,{className:"w-32",children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All"}),e.jsx(ge,{value:"active",children:"Active"}),e.jsx(ge,{value:"expired",children:"Expired"}),e.jsx(ge,{value:"future",children:"Future"})]})]})]})]})}),e.jsx(X,{children:g?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading tariffs..."}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Tariff Name"}),e.jsx(se,{children:"Valid Period"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Blocks"}),e.jsx(se,{children:"Fixed Charge"}),e.jsx(se,{className:"text-right",children:"Actions"})]})}),e.jsxs(lr,{children:[(C=p==null?void 0:p.data)==null?void 0:C.map(L=>{var F;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:L.name}),e.jsx(J,{children:e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{children:["From: ",new Date(L.valid_from).toLocaleDateString()]}),L.valid_to&&e.jsxs("div",{children:["To: ",new Date(L.valid_to).toLocaleDateString()]})]})}),e.jsx(J,{children:O(L)}),e.jsxs(J,{children:[((F=L.blocks)==null?void 0:F.length)||0," blocks"]}),e.jsxs(J,{children:[L.currency," ",(L.fixed_charge||0).toFixed(2)]}),e.jsx(J,{className:"text-right",children:e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>N(L),children:e.jsx(ki,{className:"h-4 w-4"})}),e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>M(L.id),children:e.jsx(Ws,{className:"h-4 w-4"})})]})})]},L.id)}),((D=p==null?void 0:p.data)==null?void 0:D.length)===0&&e.jsx(Qe,{children:e.jsx(J,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No tariffs found. Create your first tariff to get started."})})]})]})})]})]})}function A8e(){var w,T;const[t,r]=A.useState(!1),[s,n]=A.useState(null),[a,o]=A.useState(1),c=yr(),{data:i,isLoading:f}=it({queryKey:["billing-runs"],queryFn:()=>ra.getBillingRuns({per_page:50})}),p=gt({mutationFn:ra.previewBilling,onSuccess:N=>{n(N),o(2)},onError:N=>{var M,O;Me.error(((O=(M=N.response)==null?void 0:M.data)==null?void 0:O.message)||"Failed to generate preview")}}),g=gt({mutationFn:ra.executeBilling,onSuccess:N=>{c.invalidateQueries({queryKey:["billing-runs"]}),r(!1),o(1),n(null),Me.success(`Billing run completed: ${N.invoices_created} invoices created`)},onError:N=>{var M,O;Me.error(((O=(M=N.response)==null?void 0:M.data)==null?void 0:O.message)||"Failed to execute billing run")}}),y=N=>{N.preventDefault();const M=new FormData(N.currentTarget);p.mutate({period_start:M.get("period_start"),period_end:M.get("period_end"),segment:M.get("segment")||void 0,limit:10})},b=()=>{if(!s)return;const N=new FormData(document.querySelector("form"));g.mutate({period_start:N.get("period_start"),period_end:N.get("period_end"),due_date:N.get("due_date"),segment:N.get("segment")||void 0})};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Billing Runs"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Monthly billing execution and invoice generation"})]}),e.jsxs(Qt,{open:t,onOpenChange:r,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{onClick:()=>{o(1),n(null)},children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"New Billing Run"]})}),e.jsxs(Zt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:a===1?"Step 1: Configure Billing Period":"Step 2: Review & Execute"})}),a===1&&e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"period_start",children:"Billing Period Start"}),e.jsx(Ie,{id:"period_start",name:"period_start",type:"date",required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"period_end",children:"Billing Period End"}),e.jsx(Ie,{id:"period_end",name:"period_end",type:"date",required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"due_date",children:"Invoice Due Date"}),e.jsx(Ie,{id:"due_date",name:"due_date",type:"date",required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"segment",children:"Customer Segment (Optional)"}),e.jsxs("select",{id:"segment",name:"segment",className:"w-full border rounded-md p-2",children:[e.jsx("option",{value:"",children:"All Customers"}),e.jsx("option",{value:"residential",children:"Residential"}),e.jsx("option",{value:"commercial",children:"Commercial"}),e.jsx("option",{value:"industrial",children:"Industrial"}),e.jsx("option",{value:"public",children:"Public"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsxs(K,{type:"submit",disabled:p.isPending,children:[e.jsx(mo,{className:"h-4 w-4 mr-2"}),"Preview"]})]})]}),a===2&&s&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold",children:s.preview_count}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Accounts"})]})}),e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(s.total_estimated)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Estimated"})]})}),e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("div",{className:"text-sm font-medium",children:s.period_start}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Period Start"})]})}),e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("div",{className:"text-sm font-medium",children:s.period_end}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Period End"})]})})]}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Account No"}),e.jsx(se,{children:"Customer"}),e.jsx(se,{className:"text-right",children:"Consumption (m)"}),e.jsx(se,{className:"text-right",children:"Estimated Charge"}),e.jsx(se,{children:"Tariff"})]})}),e.jsx(lr,{children:s.accounts.map((N,M)=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono",children:N.account_no}),e.jsx(J,{children:N.customer_name}),e.jsx(J,{className:"text-right",children:N.consumption.toFixed(2)}),e.jsx(J,{className:"text-right",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(N.estimated_charge)}),e.jsx(J,{children:N.tariff})]},M))})]})}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>o(1),children:"Back"}),e.jsxs(K,{onClick:b,disabled:g.isPending,children:[e.jsx(Ui,{className:"h-4 w-4 mr-2"}),"Execute Billing Run"]})]})]})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(nM,{className:"h-5 w-5"}),"Billing Run History"]})}),e.jsx(X,{children:f?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading billing runs..."}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Period"}),e.jsx(se,{children:"Period Dates"}),e.jsx(se,{className:"text-right",children:"Invoice Count"}),e.jsx(se,{className:"text-right",children:"Total Amount"}),e.jsx(se,{children:"Created At"})]})}),e.jsxs(lr,{children:[(w=i==null?void 0:i.data)==null?void 0:w.map((N,M)=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:N.period}),e.jsx(J,{children:e.jsxs("div",{className:"text-sm",children:[new Date(N.period_start).toLocaleDateString()," - ",new Date(N.period_end).toLocaleDateString()]})}),e.jsx(J,{className:"text-right",children:(N.invoice_count||0).toLocaleString()}),e.jsx(J,{className:"text-right",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(N.total_amount||0)}),e.jsx(J,{children:new Date(N.created_at).toLocaleString()})]},M)),((T=i==null?void 0:i.data)==null?void 0:T.length)===0&&e.jsx(Qe,{children:e.jsx(J,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No billing runs found. Create your first billing run to generate invoices."})})]})]})})]})]})}function T8e(){var y,b,w,T;const[t,r]=A.useState("all"),[s,n]=A.useState("all"),[a,o]=A.useState(""),c=yr(),{data:i,isLoading:f}=it({queryKey:["payments",t,s,a],queryFn:()=>ra.getPayments({channel:t!=="all"?t:void 0,status:s!=="all"?s:void 0,search:a||void 0,per_page:50})}),{data:p}=it({queryKey:["aging-report"],queryFn:()=>ra.getAgingReport()});gt({mutationFn:({paymentId:N,invoiceIds:M})=>ra.reconcilePayment(N,M),onSuccess:()=>{c.invalidateQueries({queryKey:["payments"]}),c.invalidateQueries({queryKey:["aging-report"]}),Me.success("Payment reconciled successfully")},onError:N=>{var M,O;Me.error(((O=(M=N.response)==null?void 0:M.data)==null?void 0:O.message)||"Failed to reconcile payment")}});const g=N=>{const M={cash:"bg-green-600",bank:"bg-blue-600",mpesa:"bg-purple-600",online:"bg-orange-600",adjustment:"bg-gray-600"};return e.jsx(Ae,{className:M[N]||"bg-gray-600",children:N.toUpperCase()})};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Payment Reconciliation"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Match payments to invoices across all channels"})]}),p&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(ci,{className:"h-5 w-5"}),"Aging Summary"]})}),e.jsxs(X,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:(((y=p.summary)==null?void 0:y.total_accounts)||0).toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Accounts"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(((b=p.summary)==null?void 0:b.total_balance)||0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Balance"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-xl font-semibold",children:[p.dso||0," days"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"DSO (Days Sales Outstanding)"})]})]}),e.jsx(Ha,{width:"100%",height:200,children:e.jsxs(tv,{data:p.aging_buckets||[],children:[e.jsx(Zi,{strokeDasharray:"3 3"}),e.jsx(Ma,{dataKey:"bucket"}),e.jsx(fa,{}),e.jsx(_n,{}),e.jsx(uo,{dataKey:"amount",fill:"#8884d8"})]})})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Top 5 Debtors"})}),e.jsx(X,{children:e.jsx("div",{className:"space-y-3",children:(p.top_debtors||[]).slice(0,5).map((N,M)=>e.jsxs("div",{className:"flex justify-between items-center p-2 border rounded",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:N.customer_name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:N.account_no})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-semibold",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(N.balance)}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["90+: ",new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(N.over_90)]})]})]},M))})})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(xI,{className:"h-5 w-5"}),"Reconciliation Console"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ie,{placeholder:"Search account or ref...",value:a,onChange:N=>o(N.target.value),className:"w-64"}),e.jsxs(Nt,{value:t,onValueChange:r,children:[e.jsx(bt,{className:"w-32",children:e.jsx(St,{placeholder:"Channel"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All"}),e.jsx(ge,{value:"cash",children:"Cash"}),e.jsx(ge,{value:"bank",children:"Bank"}),e.jsx(ge,{value:"mpesa",children:"M-Pesa"}),e.jsx(ge,{value:"online",children:"Online"}),e.jsx(ge,{value:"adjustment",children:"Adjustment"})]})]}),e.jsxs(Nt,{value:s,onValueChange:n,children:[e.jsx(bt,{className:"w-40",children:e.jsx(St,{placeholder:"Status"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All"}),e.jsx(ge,{value:"reconciled",children:"Reconciled"}),e.jsx(ge,{value:"unreconciled",children:"Unreconciled"})]})]})]})]})}),e.jsx(X,{children:f?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading payments..."}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Account No"}),e.jsx(se,{children:"Payment Date"}),e.jsx(se,{className:"text-right",children:"Amount"}),e.jsx(se,{children:"Channel"}),e.jsx(se,{children:"Reference"}),e.jsx(se,{children:"Customer"}),e.jsx(se,{className:"text-right",children:"Actions"})]})}),e.jsxs(lr,{children:[(w=i==null?void 0:i.data)==null?void 0:w.map(N=>{var M;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono",children:N.account_no}),e.jsx(J,{children:new Date(N.paid_at).toLocaleDateString()}),e.jsx(J,{className:"text-right font-medium",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(N.amount)}),e.jsx(J,{children:g(N.channel)}),e.jsx(J,{className:"font-mono text-xs",children:N.ref||"N/A"}),e.jsx(J,{children:(M=N.connection)!=null&&M.customer?`${N.connection.customer.first_name} ${N.connection.customer.last_name}`:"N/A"}),e.jsx(J,{className:"text-right",children:e.jsx(K,{size:"sm",variant:"outline",onClick:()=>{Me.info("Manual reconciliation dialog would open here")},children:"Reconcile"})})]},N.id)}),((T=i==null?void 0:i.data)==null?void 0:T.length)===0&&e.jsx(Qe,{children:e.jsx(J,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No payments found. Adjust filters to see more results."})})]})]})})]})]})}function E8e(){var M,O;const[t,r]=A.useState(!1),[s,n]=A.useState(null),a=yr(),{data:o,isLoading:c}=it({queryKey:["meter-routes"],queryFn:()=>ra.getMeterRoutes({per_page:50})}),i=gt({mutationFn:ra.createMeterRoute,onSuccess:()=>{a.invalidateQueries({queryKey:["meter-routes"]}),r(!1),n(null),Me.success("Route created successfully")},onError:C=>{var D,L;Me.error(((L=(D=C.response)==null?void 0:D.data)==null?void 0:L.message)||"Failed to create route")}}),f=gt({mutationFn:({id:C,data:D})=>ra.updateMeterRoute(C,D),onSuccess:()=>{a.invalidateQueries({queryKey:["meter-routes"]}),r(!1),n(null),Me.success("Route updated successfully")},onError:C=>{var D,L;Me.error(((L=(D=C.response)==null?void 0:D.data)==null?void 0:L.message)||"Failed to update route")}}),p=gt({mutationFn:ra.deleteMeterRoute,onSuccess:()=>{a.invalidateQueries({queryKey:["meter-routes"]}),Me.success("Route deleted successfully")},onError:C=>{var D,L;Me.error(((L=(D=C.response)==null?void 0:D.data)==null?void 0:L.message)||"Failed to delete route")}}),g=gt({mutationFn:ra.downloadOfflinePackage,onSuccess:C=>{const D=new Blob([JSON.stringify(C,null,2)],{type:"application/json"}),L=URL.createObjectURL(D),F=document.createElement("a");F.href=L,F.download=`route-${C.route_id}-offline.json`,F.click(),Me.success("Offline package downloaded")},onError:()=>{Me.error("Failed to download offline package")}}),y=C=>{C.preventDefault();const D=new FormData(C.currentTarget),L={route_code:D.get("route_code"),area:D.get("area"),assigned_to:D.get("assigned_to")||void 0,meters_count:parseInt(D.get("meters_count"))};s?f.mutate({id:s.id,data:L}):i.mutate(L)},b=C=>{g.mutate(C)},w=C=>{n(C),r(!0)},T=C=>{confirm("Are you sure you want to delete this route?")&&p.mutate(C)},N=C=>{const D={active:"bg-green-600",unassigned:"bg-yellow-600",inactive:"bg-gray-600"};return e.jsx(Ae,{className:D[C]||"bg-gray-600",children:C.toUpperCase()})};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Meter Reading Routes"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Route planning and reading cycle management"})]}),e.jsxs(Qt,{open:t,onOpenChange:r,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{onClick:()=>n(null),children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Create Route"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:s?"Edit Route":"Create New Route"})}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"route_code",children:"Route Code"}),e.jsx(Ie,{id:"route_code",name:"route_code",defaultValue:s==null?void 0:s.route_code,required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"area",children:"Area/Zone"}),e.jsx(Ie,{id:"area",name:"area",defaultValue:s==null?void 0:s.area,required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"assigned_to",children:"Assigned To (Optional)"}),e.jsx(Ie,{id:"assigned_to",name:"assigned_to",defaultValue:(s==null?void 0:s.assigned_to)||""})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"meters_count",children:"Number of Meters"}),e.jsx(Ie,{id:"meters_count",name:"meters_count",type:"number",defaultValue:s==null?void 0:s.meters_count,required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsxs(K,{type:"submit",disabled:i.isPending||f.isPending,children:[s?"Update":"Create"," Route"]})]})]})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(fn,{className:"h-5 w-5"}),"Route Management"]})}),e.jsx(X,{children:c?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading routes..."}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Route Code"}),e.jsx(se,{children:"Area"}),e.jsx(se,{children:"Assigned To"}),e.jsx(se,{className:"text-right",children:"Meters"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Last Read"}),e.jsx(se,{className:"text-right",children:"Completion"}),e.jsx(se,{className:"text-right",children:"Actions"})]})}),e.jsxs(lr,{children:[(M=o==null?void 0:o.data)==null?void 0:M.map(C=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:C.route_code}),e.jsx(J,{children:C.area}),e.jsx(J,{children:C.assigned_to||e.jsx("span",{className:"text-muted-foreground",children:"Unassigned"})}),e.jsx(J,{className:"text-right",children:C.meters_count}),e.jsx(J,{children:N(C.status)}),e.jsx(J,{children:C.last_read_date?new Date(C.last_read_date).toLocaleDateString():"Never"}),e.jsxs(J,{className:"text-right",children:[(C.completion_rate||0).toFixed(1),"%"]}),e.jsx(J,{className:"text-right",children:e.jsxs("div",{className:"flex gap-1 justify-end",children:[e.jsx(K,{variant:"ghost",size:"sm",title:"Download offline package",onClick:()=>b(C.id),children:e.jsx(ma,{className:"h-4 w-4"})}),e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>w(C),children:e.jsx(ki,{className:"h-4 w-4"})}),e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>T(C.id),children:e.jsx(Ws,{className:"h-4 w-4"})})]})})]},C.id)),((O=o==null?void 0:o.data)==null?void 0:O.length)===0&&e.jsx(Qe,{children:e.jsx(J,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No routes found. Create your first route to organize meter reading."})})]})]})})]})]})}const F8=[{value:"phone",label:"Phone",icon:_m},{value:"email",label:"Email",icon:Fm},{value:"sms",label:"SMS",icon:Nb},{value:"whatsapp",label:"WhatsApp",icon:Ki},{value:"walk_in",label:"Walk-in",icon:bC},{value:"app",label:"App",icon:Nb},{value:"ussd",label:"USSD",icon:_m}],w0=[{value:"low",label:"Low",color:"bg-slate-500"},{value:"normal",label:"Normal",color:"bg-blue-500"},{value:"high",label:"High",color:"bg-orange-500"},{value:"urgent",label:"Urgent",color:"bg-red-500"}],SN=[{value:"new",label:"New",color:"bg-purple-500"},{value:"assigned",label:"Assigned",color:"bg-blue-500"},{value:"in_progress",label:"In Progress",color:"bg-yellow-500"},{value:"resolved",label:"Resolved",color:"bg-green-500"},{value:"closed",label:"Closed",color:"bg-slate-500"}];function $8(t){if(t.status==="resolved"||t.status==="closed")return{status:"ok",label:"Completed"};const r=t.sla_resolution_due?hd(t.sla_resolution_due):null;if(!r)return{status:"ok",label:"No SLA"};if(vhe(r))return{status:"breached",label:"SLA Breached"};const s=(r.getTime()-new Date().getTime())/(1e3*60*60);return s<4?{status:"warning",label:`${Math.round(s)}h remaining`}:{status:"ok",label:E7(r,{addSuffix:!0})}}function M8e(){const t=yr(),[r,s]=A.useState(!1),[n,a]=A.useState("all"),[o,c]=A.useState("all"),[i,f]=A.useState(""),[p,g]=A.useState("phone"),[y,b]=A.useState("normal"),{data:w,isLoading:T}=it({queryKey:["tickets",n,o],queryFn:()=>jn.getTickets({status:n!=="all"?n:void 0,priority:o!=="all"?o:void 0,per_page:50})}),{data:N}=it({queryKey:["ticket-categories"],queryFn:()=>jn.getTicketCategories()}),M=gt({mutationFn:jn.createTicket,onSuccess:()=>{t.invalidateQueries({queryKey:["tickets"]}),Me.success("Ticket created successfully"),s(!1),f(""),g("phone"),b("normal")},onError:Z=>{var ne,oe;Me.error(((oe=(ne=Z.response)==null?void 0:ne.data)==null?void 0:oe.message)||"Failed to create ticket")}}),O=gt({mutationFn:({id:Z,data:ne})=>jn.updateTicket(Z,ne),onSuccess:()=>{t.invalidateQueries({queryKey:["tickets"]}),Me.success("Ticket updated")},onError:Z=>{var ne,oe;Me.error(((oe=(ne=Z.response)==null?void 0:ne.data)==null?void 0:oe.message)||"Failed to update ticket")}}),C=Z=>{Z.preventDefault();const ne=new FormData(Z.currentTarget);if(!i){Me.error("Please select a category");return}M.mutate({category_id:i,channel:p,subject:ne.get("subject"),description:ne.get("description")||void 0,priority:y})},D=(Z,ne)=>{O.mutate({id:Z,data:{status:ne}})},L=(Z,ne)=>{O.mutate({id:Z,data:{priority:ne}})},F=(w==null?void 0:w.data)||[],B=(N==null?void 0:N.data)||[],U={total:F.length,new:F.filter(Z=>Z.status==="new").length,inProgress:F.filter(Z=>Z.status==="in_progress"||Z.status==="assigned").length,resolved:F.filter(Z=>Z.status==="resolved").length,breached:F.filter(Z=>$8(Z).status==="breached").length},te=Z=>{const ne=w0.find(oe=>oe.value===Z)||w0[1];return e.jsx(Ae,{className:ne.color,children:ne.label})},Q=Z=>{const ne=SN.find(oe=>oe.value===Z)||SN[0];return e.jsx(Ae,{className:ne.color,children:ne.label})},re=Z=>{const ne=F8.find(Ce=>Ce.value===Z),oe=(ne==null?void 0:ne.icon)||Ki;return e.jsx(oe,{className:"h-4 w-4"})};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"CRM Tickets"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Customer support ticket management and SLA tracking"})]}),e.jsxs(Qt,{open:r,onOpenChange:s,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"New Ticket"]})}),e.jsxs(Zt,{className:"max-w-lg",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Create Support Ticket"})}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"category_id",children:"Category *"}),e.jsxs(Nt,{value:i,onValueChange:f,children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select category"})}),e.jsx(_t,{children:B.map(Z=>e.jsx(ge,{value:Z.id,children:Z.name},Z.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"channel",children:"Channel *"}),e.jsxs(Nt,{value:p,onValueChange:g,children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select channel"})}),e.jsx(_t,{children:F8.map(Z=>e.jsx(ge,{value:Z.value,children:Z.label},Z.value))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"priority",children:"Priority"}),e.jsxs(Nt,{value:y,onValueChange:b,children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select priority"})}),e.jsx(_t,{children:w0.map(Z=>e.jsx(ge,{value:Z.value,children:Z.label},Z.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"subject",children:"Subject *"}),e.jsx(Ie,{name:"subject",placeholder:"Brief description of the issue",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"description",children:"Description"}),e.jsx(ws,{name:"description",placeholder:"Detailed description of the customer's issue...",rows:4})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),e.jsxs(K,{type:"submit",disabled:M.isPending,children:[M.isPending&&e.jsx(as,{className:"h-4 w-4 mr-2 animate-spin"}),"Create Ticket"]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:e.jsx(VF,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:U.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Tickets"})]})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900 rounded-lg",children:e.jsx(Ki,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:U.new}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"New"})]})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-100 dark:bg-yellow-900 rounded-lg",children:e.jsx($s,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:U.inProgress}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"In Progress"})]})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900 rounded-lg",children:e.jsx(Zl,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:U.resolved}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Resolved"})]})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900 rounded-lg",children:e.jsx(Fr,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:U.breached}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"SLA Breached"})]})]})})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(VF,{className:"h-5 w-5"}),"Ticket Queue"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Nt,{value:n,onValueChange:a,children:[e.jsx(bt,{className:"w-36",children:e.jsx(St,{placeholder:"Status"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Statuses"}),SN.map(Z=>e.jsx(ge,{value:Z.value,children:Z.label},Z.value))]})]}),e.jsxs(Nt,{value:o,onValueChange:c,children:[e.jsx(bt,{className:"w-36",children:e.jsx(St,{placeholder:"Priority"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Priorities"}),w0.map(Z=>e.jsx(ge,{value:Z.value,children:Z.label},Z.value))]})]})]})]})}),e.jsx(X,{children:T?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(as,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):F.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No tickets found. Create your first ticket to get started."}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Ticket #"}),e.jsx(se,{children:"Channel"}),e.jsx(se,{children:"Subject"}),e.jsx(se,{children:"Category"}),e.jsx(se,{children:"Priority"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"SLA"}),e.jsx(se,{children:"Created"}),e.jsx(se,{className:"text-right",children:"Actions"})]})}),e.jsx(lr,{children:F.map(Z=>{var oe;const ne=$8(Z);return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono font-medium",children:Z.ticket_no}),e.jsx(J,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[re(Z.channel),e.jsx("span",{className:"capitalize",children:Z.channel.replace("_"," ")})]})}),e.jsx(J,{className:"max-w-xs truncate",children:Z.subject}),e.jsx(J,{children:((oe=Z.category)==null?void 0:oe.name)||"-"}),e.jsx(J,{children:e.jsxs(Nt,{value:Z.priority,onValueChange:Ce=>L(Z.id,Ce),children:[e.jsx(bt,{className:"h-7 w-24 border-0 p-0",children:te(Z.priority)}),e.jsx(_t,{children:w0.map(Ce=>e.jsx(ge,{value:Ce.value,children:Ce.label},Ce.value))})]})}),e.jsx(J,{children:e.jsxs(Nt,{value:Z.status,onValueChange:Ce=>D(Z.id,Ce),children:[e.jsx(bt,{className:"h-7 w-28 border-0 p-0",children:Q(Z.status)}),e.jsx(_t,{children:SN.map(Ce=>e.jsx(ge,{value:Ce.value,children:Ce.label},Ce.value))})]})}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",className:ne.status==="breached"?"border-red-500 text-red-500":ne.status==="warning"?"border-yellow-500 text-yellow-500":"border-green-500 text-green-500",children:ne.label})}),e.jsx(J,{className:"text-muted-foreground text-sm",children:E7(hd(Z.created_at),{addSuffix:!0})}),e.jsx(J,{className:"text-right",children:e.jsx(K,{variant:"ghost",size:"sm",children:"View"})})]},Z.id)})})]})})]})]})}function O8e(){var L,F,B,U,te,Q,re;const[t,r]=A.useState(!1),[s,n]=A.useState(null),[a,o]=A.useState("all"),[c,i]=A.useState(null),f=yr(),{data:p,isLoading:g}=it({queryKey:["kiosks",a],queryFn:()=>ra.getKiosks({status:a&&a!=="all"?a:void 0,per_page:50})}),{data:y}=it({queryKey:["kiosk-sales",c],queryFn:()=>c?ra.getKioskSales(c):null,enabled:!!c}),{data:b}=it({queryKey:["trucks"],queryFn:()=>ra.getTrucks()}),w=gt({mutationFn:ra.createKiosk,onSuccess:()=>{f.invalidateQueries({queryKey:["kiosks"]}),r(!1),n(null),Me.success("Kiosk created successfully")},onError:Z=>{var ne,oe;Me.error(((oe=(ne=Z.response)==null?void 0:ne.data)==null?void 0:oe.message)||"Failed to create kiosk")}}),T=gt({mutationFn:({id:Z,data:ne})=>ra.updateKiosk(Z,ne),onSuccess:()=>{f.invalidateQueries({queryKey:["kiosks"]}),r(!1),n(null),Me.success("Kiosk updated successfully")},onError:Z=>{var ne,oe;Me.error(((oe=(ne=Z.response)==null?void 0:ne.data)==null?void 0:oe.message)||"Failed to update kiosk")}}),N=gt({mutationFn:ra.deleteKiosk,onSuccess:()=>{f.invalidateQueries({queryKey:["kiosks"]}),Me.success("Kiosk deleted successfully")},onError:Z=>{var ne,oe;Me.error(((oe=(ne=Z.response)==null?void 0:ne.data)==null?void 0:oe.message)||"Failed to delete kiosk")}}),M=Z=>{Z.preventDefault();const ne=new FormData(Z.currentTarget),oe={kiosk_code:ne.get("kiosk_code"),vendor_name:ne.get("vendor_name"),vendor_phone:ne.get("vendor_phone"),location:ne.get("location"),coordinates:{lat:parseFloat(ne.get("lat")),lng:parseFloat(ne.get("lng"))},daily_target:parseFloat(ne.get("daily_target"))};s?T.mutate({id:s.id,data:oe}):w.mutate(oe)},O=Z=>{n(Z),r(!0)},C=Z=>{confirm("Are you sure you want to delete this kiosk?")&&N.mutate(Z)},D=Z=>{const ne={active:"bg-green-600",suspended:"bg-red-600",inactive:"bg-gray-600"};return e.jsx(Ae,{className:ne[Z]||"bg-gray-600",children:Z.toUpperCase()})};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Water Kiosks & Trucking"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Kiosk registry, vendor management, and sales tracking"})]}),e.jsxs(Qt,{open:t,onOpenChange:r,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{onClick:()=>n(null),children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Register Kiosk"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:s?"Edit Kiosk":"Register New Kiosk"})}),e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"kiosk_code",children:"Kiosk Code"}),e.jsx(Ie,{id:"kiosk_code",name:"kiosk_code",defaultValue:s==null?void 0:s.kiosk_code,required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"vendor_name",children:"Vendor Name"}),e.jsx(Ie,{id:"vendor_name",name:"vendor_name",defaultValue:s==null?void 0:s.vendor_name,required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"vendor_phone",children:"Vendor Phone"}),e.jsx(Ie,{id:"vendor_phone",name:"vendor_phone",type:"tel",defaultValue:s==null?void 0:s.vendor_phone,required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"daily_target",children:"Daily Target (KES)"}),e.jsx(Ie,{id:"daily_target",name:"daily_target",type:"number",defaultValue:s==null?void 0:s.daily_target,required:!0})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(we,{htmlFor:"location",children:"Location Description"}),e.jsx(Ie,{id:"location",name:"location",defaultValue:s==null?void 0:s.location,required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"lat",children:"Latitude"}),e.jsx(Ie,{id:"lat",name:"lat",type:"number",step:"any",defaultValue:(s==null?void 0:s.coordinates.lat)||-1.286389,required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"lng",children:"Longitude"}),e.jsx(Ie,{id:"lng",name:"lng",type:"number",step:"any",defaultValue:(s==null?void 0:s.coordinates.lng)||36.817223,required:!0})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsxs(K,{type:"submit",disabled:w.isPending||T.isPending,children:[s?"Update":"Register"," Kiosk"]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold",children:((L=p==null?void 0:p.summary)==null?void 0:L.total_kiosks)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Kiosks"})]})}),e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold",children:((F=p==null?void 0:p.summary)==null?void 0:F.active_kiosks)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active Kiosks"})]})}),e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(((B=p==null?void 0:p.summary)==null?void 0:B.today_total_sales)||0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Today's Sales"})]})}),e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(((U=p==null?void 0:p.summary)==null?void 0:U.total_balance)||0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Balance"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(H,{className:"lg:col-span-2",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(bS,{className:"h-5 w-5"}),"Kiosk Registry"]}),e.jsxs(Nt,{value:a,onValueChange:o,children:[e.jsx(bt,{className:"w-32",children:e.jsx(St,{placeholder:"Status"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All"}),e.jsx(ge,{value:"active",children:"Active"}),e.jsx(ge,{value:"suspended",children:"Suspended"}),e.jsx(ge,{value:"inactive",children:"Inactive"})]})]})]})}),e.jsx(X,{children:g?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading kiosks..."}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Code"}),e.jsx(se,{children:"Vendor"}),e.jsx(se,{children:"Location"}),e.jsx(se,{children:"Status"}),e.jsx(se,{className:"text-right",children:"Today's Sales"}),e.jsx(se,{className:"text-right",children:"Balance"}),e.jsx(se,{className:"text-right",children:"Actions"})]})}),e.jsxs(lr,{children:[(te=p==null?void 0:p.data)==null?void 0:te.map(Z=>e.jsxs(Qe,{className:"cursor-pointer",onClick:()=>i(Z.id),children:[e.jsx(J,{className:"font-mono",children:Z.kiosk_code}),e.jsx(J,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:Z.vendor_name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:Z.vendor_phone})]})}),e.jsx(J,{children:Z.location}),e.jsx(J,{children:D(Z.status)}),e.jsx(J,{className:"text-right",children:e.jsxs("div",{children:[e.jsx("div",{children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(Z.today_sales)}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Target: ",new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(Z.daily_target)]})]})}),e.jsx(J,{className:"text-right",children:e.jsx("span",{className:Z.balance<0?"text-red-600 font-semibold":"",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(Z.balance)})}),e.jsx(J,{className:"text-right",children:e.jsxs("div",{className:"flex gap-1 justify-end",children:[e.jsx(K,{variant:"ghost",size:"sm",onClick:ne=>{ne.stopPropagation(),O(Z)},children:e.jsx(ki,{className:"h-4 w-4"})}),e.jsx(K,{variant:"ghost",size:"sm",onClick:ne=>{ne.stopPropagation(),C(Z.id)},children:e.jsx(Ws,{className:"h-4 w-4"})})]})})]},Z.id)),((Q=p==null?void 0:p.data)==null?void 0:Q.length)===0&&e.jsx(Qe,{children:e.jsx(J,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No kiosks found. Register your first kiosk to start tracking."})})]})]})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(Wl,{className:"h-5 w-5"}),"Sales Performance"]})}),e.jsx(X,{children:c&&y?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground",children:"Total Volume"}),e.jsxs("div",{className:"font-semibold",children:[y.total_volume.toFixed(1)," m"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground",children:"Avg. Daily"}),e.jsx("div",{className:"font-semibold",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(y.average_daily)})]})]}),e.jsx(Ha,{width:"100%",height:200,children:e.jsxs(Km,{data:y.sales,children:[e.jsx(Zi,{strokeDasharray:"3 3"}),e.jsx(Ma,{dataKey:"date",tick:{fontSize:10}}),e.jsx(fa,{}),e.jsx(_n,{}),e.jsx(ui,{type:"monotone",dataKey:"amount",stroke:"#8884d8",strokeWidth:2})]})})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"Click on a kiosk to view sales performance"})})]})]}),b&&((re=b.data)==null?void 0:re.length)>0&&e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(py,{className:"h-5 w-5"}),"Water Truck Fleet"]})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Truck No"}),e.jsx(se,{children:"Driver"}),e.jsx(se,{children:"Phone"}),e.jsx(se,{children:"Status"}),e.jsx(se,{className:"text-right",children:"Capacity (L)"}),e.jsx(se,{className:"text-right",children:"Trips Today"}),e.jsx(se,{className:"text-right",children:"Revenue Today"})]})}),e.jsx(lr,{children:b.data.map(Z=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono",children:Z.truck_no}),e.jsx(J,{children:Z.driver_name}),e.jsx(J,{children:Z.phone}),e.jsx(J,{children:e.jsx(Ae,{className:Z.status==="in_transit"?"bg-blue-600":"bg-green-600",children:Z.status.replace("_"," ").toUpperCase()})}),e.jsx(J,{className:"text-right",children:Z.capacity.toLocaleString()}),e.jsx(J,{className:"text-right",children:Z.trips_today}),e.jsx(J,{className:"text-right",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(Z.revenue_today)})]},Z.id))})]})})]})]})}const z8={available:{label:"Available",color:"bg-green-100 text-green-800",icon:Ns},in_transit:{label:"In Transit",color:"bg-blue-100 text-blue-800",icon:oie},maintenance:{label:"Maintenance",color:"bg-yellow-100 text-yellow-800",icon:Vc},scheduled:{label:"Scheduled",color:"bg-gray-100 text-gray-800",icon:$s},delivered:{label:"Delivered",color:"bg-green-100 text-green-800",icon:Ns},verified:{label:"Verified",color:"bg-emerald-100 text-emerald-800",icon:Ns}};function I8e(){const[t,r]=A.useState("trucks"),{data:s,isLoading:n}=it({queryKey:["/api/v1/crm/water-trucks"]}),{data:a,isLoading:o}=it({queryKey:["/api/v1/crm/water-trucks/trips"]}),c=(s==null?void 0:s.data)||[],i=(s==null?void 0:s.summary)||{total_trucks:0,available_trucks:0,in_transit_trucks:0,total_trips_today:0,total_revenue_today:0,total_capacity:0},f=(a==null?void 0:a.data)||[],p=(a==null?void 0:a.summary)||{total_revenue:0,total_volume:0,active_trips:0,scheduled_trips:0},g=b=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(b),y=b=>b?new Date(b).toLocaleString("en-KE",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-";return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Water Trucking"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Bowser management and trip tracking"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total Trucks"}),e.jsx(py,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i.total_trucks}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[i.available_trucks," available, ",i.in_transit_trucks," in transit"]})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Trips Today"}),e.jsx(fn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i.total_trips_today}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[p.active_trips," active, ",p.scheduled_trips," scheduled"]})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Volume Delivered"}),e.jsx(Si,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[Number(p.total_volume||0).toFixed(1)," m"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Total capacity: ",(i.total_capacity/1e3).toFixed(1)," m"]})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Revenue Today"}),e.jsx(Ga,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:g(Number(i.total_revenue_today||0))}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Total: ",g(Number(p.total_revenue||0))]})]})]})]}),e.jsxs(ss,{value:t,onValueChange:r,children:[e.jsxs(Yr,{children:[e.jsx(wt,{value:"trucks",children:"Fleet"}),e.jsx(wt,{value:"trips",children:"Trip Log"})]}),e.jsx(kt,{value:"trucks",className:"mt-4",children:e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(py,{className:"h-5 w-5"}),"Water Truck Fleet"]}),e.jsx(mr,{children:"Manage bowsers and track their status"})]}),e.jsx(X,{children:n?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading trucks..."}):c.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No water trucks registered"}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Truck No."}),e.jsx(se,{children:"Driver"}),e.jsx(se,{children:"Phone"}),e.jsx(se,{className:"text-right",children:"Capacity (L)"}),e.jsx(se,{children:"Status"}),e.jsx(se,{className:"text-right",children:"Trips Today"}),e.jsx(se,{className:"text-right",children:"Revenue Today"})]})}),e.jsx(lr,{children:c.map(b=>{const w=z8[b.status],T=w.icon;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:b.truck_no}),e.jsx(J,{children:b.driver_name}),e.jsx(J,{children:b.phone}),e.jsx(J,{className:"text-right",children:b.capacity.toLocaleString()}),e.jsx(J,{children:e.jsxs(Ae,{className:w.color,children:[e.jsx(T,{className:"h-3 w-3 mr-1"}),w.label]})}),e.jsx(J,{className:"text-right",children:b.trips_today}),e.jsx(J,{className:"text-right",children:g(b.revenue_today)})]},b.id)})})]})})]})}),e.jsx(kt,{value:"trips",className:"mt-4",children:e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(fn,{className:"h-5 w-5"}),"Trip Log"]}),e.jsx(mr,{children:"Track water delivery trips"})]}),e.jsx(X,{children:o?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading trips..."}):f.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No trips recorded"}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Trip Code"}),e.jsx(se,{children:"Truck"}),e.jsx(se,{children:"Driver"}),e.jsx(se,{children:"Source"}),e.jsx(se,{children:"Destination"}),e.jsx(se,{className:"text-right",children:"Volume (m)"}),e.jsx(se,{className:"text-right",children:"Amount"}),e.jsx(se,{children:"Departure"}),e.jsx(se,{children:"Status"})]})}),e.jsx(lr,{children:f.map(b=>{const w=z8[b.status],T=w.icon;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:b.trip_code}),e.jsx(J,{children:b.truck_registration}),e.jsx(J,{children:b.driver_name}),e.jsx(J,{className:"max-w-[150px] truncate",title:b.source_location,children:b.source_location}),e.jsx(J,{className:"max-w-[150px] truncate",title:b.delivery_location,children:b.delivery_location}),e.jsx(J,{className:"text-right",children:Number(b.volume_m3).toFixed(1)}),e.jsx(J,{className:"text-right",children:g(Number(b.total_amount))}),e.jsx(J,{children:y(b.departure_time)}),e.jsx(J,{children:e.jsxs(Ae,{className:w.color,children:[e.jsx(T,{className:"h-3 w-3 mr-1"}),w.label]})})]},b.id)})})]})})]})})]})]})}function D8e(){var M,O;const[t,r]=A.useState(!1),[s,n]=A.useState("all"),[a,o]=A.useState(1),c=yr(),{data:i,isLoading:f}=it({queryKey:["connection-applications",s],queryFn:()=>ra.getConnectionApplications({status:s&&s!=="all"?s:void 0,per_page:50})}),p=gt({mutationFn:ra.submitApplication,onSuccess:()=>{c.invalidateQueries({queryKey:["connection-applications"]}),r(!1),o(1),Me.success("Application submitted successfully")},onError:C=>{var D,L;Me.error(((L=(D=C.response)==null?void 0:D.data)==null?void 0:L.message)||"Failed to submit application")}}),g=gt({mutationFn:({id:C,data:D})=>ra.updateApplication(C,D),onSuccess:()=>{c.invalidateQueries({queryKey:["connection-applications"]}),Me.success("Application updated successfully")},onError:C=>{var D,L;Me.error(((L=(D=C.response)==null?void 0:D.data)==null?void 0:L.message)||"Failed to update application")}}),y=C=>{if(C.preventDefault(),a<3){o(a+1);return}const D=new FormData(C.currentTarget),L={applicant_name:D.get("applicant_name"),phone:D.get("phone"),email:D.get("email"),id_number:D.get("id_number"),address:D.get("address"),location:{lat:parseFloat(D.get("lat"))||-1.286389,lng:parseFloat(D.get("lng"))||36.817223},connection_type:D.get("connection_type"),property_type:D.get("property_type")};p.mutate(L)},b=C=>{g.mutate({id:C,data:{status:"approved"}})},w=C=>{g.mutate({id:C,data:{status:"rejected"}})},T=C=>{const D={kyc_pending:{variant:"bg-yellow-600",icon:Nn},pending_approval:{variant:"bg-blue-600",icon:Nn},approved:{variant:"bg-green-600",icon:Ns},rejected:{variant:"bg-red-600",icon:ec},connected:{variant:"bg-purple-600",icon:Ns}},{variant:L,icon:F}=D[C]||D.kyc_pending;return e.jsxs(Ae,{className:L,children:[e.jsx(F,{className:"h-3 w-3 mr-1"}),C.replace("_"," ").toUpperCase()]})},N=C=>{const D={pending:"bg-yellow-600",verified:"bg-green-600",rejected:"bg-red-600"};return e.jsx(Ae,{className:D[C],children:C.toUpperCase()})};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Connection Applications"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"New service requests and approval workflow"})]}),e.jsxs(Qt,{open:t,onOpenChange:r,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{onClick:()=>o(1),children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"New Application"]})}),e.jsxs(Zt,{className:"max-w-2xl",children:[e.jsx(Yt,{children:e.jsxs(Xt,{children:["Step ",a," of 3: ",a===1?"Applicant Details":a===2?"Property Information":"Confirmation"]})}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[a===1&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(we,{htmlFor:"applicant_name",children:"Full Name"}),e.jsx(Ie,{id:"applicant_name",name:"applicant_name",required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"phone",children:"Phone Number"}),e.jsx(Ie,{id:"phone",name:"phone",type:"tel",required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"email",children:"Email (Optional)"}),e.jsx(Ie,{id:"email",name:"email",type:"email"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(we,{htmlFor:"id_number",children:"ID/Passport Number"}),e.jsx(Ie,{id:"id_number",name:"id_number",required:!0})]})]}),a===2&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(we,{htmlFor:"address",children:"Property Address"}),e.jsx(Ie,{id:"address",name:"address",required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"connection_type",children:"Connection Type"}),e.jsxs("select",{id:"connection_type",name:"connection_type",className:"w-full border rounded-md p-2",required:!0,children:[e.jsx("option",{value:"new",children:"New Connection"}),e.jsx("option",{value:"upgrade",children:"Upgrade"}),e.jsx("option",{value:"temporary",children:"Temporary"})]})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"property_type",children:"Property Type"}),e.jsxs("select",{id:"property_type",name:"property_type",className:"w-full border rounded-md p-2",required:!0,children:[e.jsx("option",{value:"residential",children:"Residential"}),e.jsx("option",{value:"commercial",children:"Commercial"}),e.jsx("option",{value:"industrial",children:"Industrial"})]})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"lat",children:"Latitude"}),e.jsx(Ie,{id:"lat",name:"lat",type:"number",step:"any",defaultValue:"-1.286389",required:!0})]}),e.jsxs("div",{children:[e.jsx(we,{htmlFor:"lng",children:"Longitude"}),e.jsx(Ie,{id:"lng",name:"lng",type:"number",step:"any",defaultValue:"36.817223",required:!0})]})]}),a===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ns,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold",children:"Review Application"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Please review your information before submitting"})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Applicant:"})," Check form data"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," Check form data"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Property:"})," Check form data"]})]})]}),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>a>1?o(a-1):r(!1),children:a>1?"Previous":"Cancel"}),e.jsx(K,{type:"submit",disabled:p.isPending,children:a<3?"Next":"Submit Application"})]})]})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(zo,{className:"h-5 w-5"}),"Application Management"]}),e.jsxs(Nt,{value:s,onValueChange:n,children:[e.jsx(bt,{className:"w-48",children:e.jsx(St,{placeholder:"Filter by status"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Applications"}),e.jsx(ge,{value:"kyc_pending",children:"KYC Pending"}),e.jsx(ge,{value:"pending_approval",children:"Pending Approval"}),e.jsx(ge,{value:"approved",children:"Approved"}),e.jsx(ge,{value:"rejected",children:"Rejected"}),e.jsx(ge,{value:"connected",children:"Connected"})]})]})]})}),e.jsx(X,{children:f?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading applications..."}):e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Application No"}),e.jsx(se,{children:"Applicant"}),e.jsx(se,{children:"Phone"}),e.jsx(se,{children:"Address"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"KYC"}),e.jsx(se,{className:"text-right",children:"Est. Cost"}),e.jsx(se,{children:"Applied Date"}),e.jsx(se,{className:"text-right",children:"Actions"})]})}),e.jsxs(lr,{children:[(M=i==null?void 0:i.data)==null?void 0:M.map(C=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-mono",children:C.application_no}),e.jsx(J,{className:"font-medium",children:C.applicant_name}),e.jsx(J,{children:C.phone}),e.jsx(J,{className:"max-w-xs truncate",children:C.address}),e.jsx(J,{children:T(C.status)}),e.jsx(J,{children:N(C.kyc_status)}),e.jsx(J,{className:"text-right",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(C.estimated_cost)}),e.jsx(J,{children:new Date(C.applied_date).toLocaleDateString()}),e.jsx(J,{className:"text-right",children:e.jsx("div",{className:"flex gap-1 justify-end",children:C.status==="pending_approval"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{size:"sm",variant:"outline",onClick:()=>b(C.id),children:"Approve"}),e.jsx(K,{size:"sm",variant:"destructive",onClick:()=>w(C.id),children:"Reject"})]})})})]},C.id)),((O=i==null?void 0:i.data)==null?void 0:O.length)===0&&e.jsx(Qe,{children:e.jsx(J,{colSpan:9,className:"text-center py-8 text-muted-foreground",children:"No applications found. Submit a new application to get started."})})]})]})})]})]})}function R8e(){return e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsx(Ti,{}),e.jsx("main",{className:"flex-1 overflow-y-auto",children:e.jsx(Ai,{})})]})}function L8e(){const[t,r]=A.useState([]),[s,n]=A.useState("");A.useEffect(()=>{fetch("/api/community/committees").then(o=>o.json()).then(o=>r(o.data||[])).catch(()=>r([{id:"1",name:"Kiambu Water Committee",community:"Kiambu",members:12,complianceScore:92,status:"active"},{id:"2",name:"Kajiado Water Committee",community:"Kajiado",members:10,complianceScore:85,status:"active"},{id:"3",name:"Machakos Water Committee",community:"Machakos",members:14,complianceScore:78,status:"active"}]))},[]);const a=t.filter(o=>o.name.toLowerCase().includes(s.toLowerCase())||o.community.toLowerCase().includes(s.toLowerCase()));return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"RWSS Committees Directory"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Community water committee registry and governance"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"})," New Committee"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Active Committees"}),e.jsx(Ds,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all schemes"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Elections Due"}),e.jsx(wn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"3"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Within next 90 days"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Avg Compliance"}),e.jsx(Ns,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"85%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Average governance score"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Committee Registry"})}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ie,{placeholder:"Search committees...",value:s,onChange:o=>n(o.target.value),className:"flex-1"}),e.jsx(K,{variant:"outline",children:e.jsx(nn,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2 px-2",children:"Committee Name"}),e.jsx("th",{className:"text-left py-2 px-2",children:"Community"}),e.jsx("th",{className:"text-left py-2 px-2",children:"Members"}),e.jsx("th",{className:"text-left py-2 px-2",children:"Compliance"}),e.jsx("th",{className:"text-left py-2 px-2",children:"Status"})]})}),e.jsx("tbody",{children:a.map(o=>e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsx("td",{className:"py-2 px-2 font-medium",children:o.name}),e.jsx("td",{className:"py-2 px-2",children:o.community}),e.jsx("td",{className:"py-2 px-2",children:o.members}),e.jsxs("td",{className:"py-2 px-2",children:[o.complianceScore,"%"]}),e.jsx("td",{className:"py-2 px-2",children:e.jsx(Ae,{variant:"default",children:o.status})})]},o.id))})]})})]})]})]})}function F8e(){return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Kiambu Water Committee"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Term: Jan 2023 - Dec 2025  Compliance Score: 92%"})]}),e.jsxs(ss,{defaultValue:"overview",className:"w-full",children:[e.jsxs(Yr,{children:[e.jsx(wt,{value:"overview",children:"Overview"}),e.jsx(wt,{value:"members",children:"Members"}),e.jsx(wt,{value:"meetings",children:"Meetings"}),e.jsx(wt,{value:"actions",children:"Actions"}),e.jsx(wt,{value:"finance",children:"Finance"}),e.jsx(wt,{value:"audits",children:"Audits"}),e.jsx(wt,{value:"documents",children:"Documents"})]}),e.jsxs(kt,{value:"overview",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Members"}),e.jsx(Ds,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"12"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"5 officers, 7 members"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Meetings YTD"}),e.jsx(wn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"9"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"100% quorum met"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Bank Balance"}),e.jsx(Ga,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"KES 245K"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Last updated today"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Governance Compliance"})}),e.jsx(X,{children:e.jsx("p",{className:"text-muted-foreground",children:"Gender quota: 50%  | Meeting frequency: Monthly  | Elections on schedule "})})]})]}),e.jsx(kt,{value:"members",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Committee Members"})}),e.jsx(X,{children:e.jsx("p",{className:"text-muted-foreground",children:"Member roster with roles, terms, and contact details coming soon..."})})]})}),e.jsx(kt,{value:"meetings",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Meeting History"})}),e.jsx(X,{children:e.jsx("p",{className:"text-muted-foreground",children:"Agendas, attendance, minutes, and resolutions coming soon..."})})]})}),e.jsx(kt,{value:"actions",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Action Items"})}),e.jsx(X,{children:e.jsx("p",{className:"text-muted-foreground",children:"Pending actions with owners and due dates coming soon..."})})]})}),e.jsx(kt,{value:"finance",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Committee Finances"})}),e.jsx(X,{children:e.jsx("p",{className:"text-muted-foreground",children:"Cashbook entries, bank reconciliations, and financial reports coming soon..."})})]})}),e.jsx(kt,{value:"audits",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Financial Audits"})}),e.jsx(X,{children:e.jsx("p",{className:"text-muted-foreground",children:"Audit findings, recommendations, and compliance tracking coming soon..."})})]})}),e.jsx(kt,{value:"documents",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Committee Documents"})}),e.jsx(X,{children:e.jsx("p",{className:"text-muted-foreground",children:"Bylaws, meeting minutes, financial reports, and audit documents coming soon..."})})]})})]})]})}function $8e(){const[t,r]=A.useState([]),[s]=A.useState(12e5);A.useEffect(()=>{fetch("/api/community/finance/cashbook").then(o=>o.json()).then(o=>r(o.data||[])).catch(()=>r([{id:"1",date:"2025-11-20",refNo:"REC001",particulars:"Monthly tariff",type:"receipt",amount:125e3,status:"approved"},{id:"2",date:"2025-11-19",refNo:"PAY001",particulars:"Operator salary",type:"payment",amount:45e3,status:"approved"}]))},[]);const n=t.filter(o=>o.type==="receipt"),a=t.filter(o=>o.type==="payment");return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Committee Finance & Cashbook"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Community tariff collection, cashbook, and financial audits"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"})," New Entry"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total Receipts"}),e.jsx(Ga,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["KES ",(n.reduce((o,c)=>o+(c.amount||0),0)/1e3).toFixed(0),"K"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Current period"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Bank Balance"}),e.jsx(zs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["KES ",(s/1e6).toFixed(1),"M"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Available funds"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Pending Approval"}),e.jsx(Nn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(o=>o.status==="pending").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting approval"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Cashbook Entries"})}),e.jsx(X,{children:e.jsxs(ss,{defaultValue:"all",children:[e.jsxs(Yr,{children:[e.jsx(wt,{value:"all",children:"All Entries"}),e.jsx(wt,{value:"receipts",children:"Receipts"}),e.jsx(wt,{value:"payments",children:"Payments"})]}),e.jsx(kt,{value:"all",className:"mt-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2 px-2",children:"Date"}),e.jsx("th",{className:"text-left py-2 px-2",children:"Ref #"}),e.jsx("th",{className:"text-left py-2 px-2",children:"Particulars"}),e.jsx("th",{className:"text-left py-2 px-2",children:"Type"}),e.jsx("th",{className:"text-right py-2 px-2",children:"Amount"}),e.jsx("th",{className:"text-left py-2 px-2",children:"Status"})]})}),e.jsx("tbody",{children:t.map(o=>e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsx("td",{className:"py-2 px-2",children:o.date}),e.jsx("td",{className:"py-2 px-2 font-mono text-xs",children:o.refNo}),e.jsx("td",{className:"py-2 px-2",children:o.particulars}),e.jsx("td",{className:"py-2 px-2",children:e.jsx(Ae,{variant:o.type==="receipt"?"default":"secondary",children:o.type})}),e.jsxs("td",{className:"py-2 px-2 text-right",children:["KES ",(o.amount/1e3).toFixed(0),"K"]}),e.jsx("td",{className:"py-2 px-2",children:e.jsx(Ae,{variant:o.status==="approved"?"default":"outline",children:o.status})})]},o.id))})]})})}),e.jsx(kt,{value:"receipts",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Receipts: KES ",(n.reduce((o,c)=>o+(c.amount||0),0)/1e3).toFixed(0),"K"]})}),e.jsx(kt,{value:"payments",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Payments: KES ",(a.reduce((o,c)=>o+(c.amount||0),0)/1e3).toFixed(0),"K"]})})]})})]})]})}function z8e(){const[t,r]=A.useState([]);A.useEffect(()=>{fetch("/api/partner/vendors").then(o=>o.json()).then(o=>r(o.data||[])).catch(()=>r([{id:"1",companyName:"WaterTech Solutions",status:"approved",kycStatus:"verified",rating:4.8,otifScore:.94},{id:"2",companyName:"Nairobi Supplies",status:"approved",kycStatus:"verified",rating:4.5,otifScore:.89}]))},[]);const s=t.filter(o=>o.status==="approved").length,n=t.length>0?(t.reduce((o,c)=>o+c.otifScore,0)/t.length*100).toFixed(0):0,a=t.filter(o=>o.kycStatus==="pending").length;return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Vendor & Partner Portal"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Vendor registration, KYC, and performance tracking"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"})," Register Vendor"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Approved Vendors"}),e.jsx(JE,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active in database"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Avg OTIF Score"}),e.jsx(u9,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[n,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"On-time in-full delivery"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Pending KYC"}),e.jsx(zs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting verification"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Vendor List"})}),e.jsx(X,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2 px-2",children:"Company"}),e.jsx("th",{className:"text-left py-2 px-2",children:"Status"}),e.jsx("th",{className:"text-left py-2 px-2",children:"KYC"}),e.jsx("th",{className:"text-left py-2 px-2",children:"Rating"}),e.jsx("th",{className:"text-left py-2 px-2",children:"OTIF"})]})}),e.jsx("tbody",{children:t.map(o=>e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsx("td",{className:"py-2 px-2 font-medium",children:o.companyName}),e.jsx("td",{className:"py-2 px-2",children:e.jsx(Ae,{variant:o.status==="approved"?"default":"secondary",children:o.status})}),e.jsx("td",{className:"py-2 px-2",children:e.jsx(Ae,{variant:o.kycStatus==="verified"?"default":"outline",children:o.kycStatus})}),e.jsx("td",{className:"py-2 px-2",children:o.rating>0?`${o.rating}`:"N/A"}),e.jsxs("td",{className:"py-2 px-2",children:[(o.otifScore*100).toFixed(0),"%"]})]},o.id))})]})})})]})]})}function B8e(){const[t,r]=A.useState([]);return A.useEffect(()=>{fetch("/api/partner/bids").then(s=>s.json()).then(s=>r(s.data||[])).catch(()=>r([{id:"1",rfqId:"RFQ-001",vendorName:"WaterTech",status:"submitted",priceTotal:85e4,leadTime:14}]))},[]),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Bids & RFQ Center"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"RFQ management, bid submission, and evaluation"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"})," New RFQ"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Active RFQs"}),e.jsx(bs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"12"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Open for bidding"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Pending Evaluation"}),e.jsx($s,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(s=>s.status==="submitted").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting review"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total Bids"}),e.jsx(Ns,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All time"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Recent Bids"})}),e.jsx(X,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2 px-2",children:"RFQ ID"}),e.jsx("th",{className:"text-left py-2 px-2",children:"Vendor"}),e.jsx("th",{className:"text-left py-2 px-2",children:"Status"}),e.jsx("th",{className:"text-right py-2 px-2",children:"Price"}),e.jsx("th",{className:"text-left py-2 px-2",children:"Lead Time"})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsx("td",{className:"py-2 px-2 font-mono text-xs",children:s.rfqId}),e.jsx("td",{className:"py-2 px-2",children:s.vendorName}),e.jsx("td",{className:"py-2 px-2",children:e.jsx(Ae,{variant:"default",children:s.status})}),e.jsxs("td",{className:"py-2 px-2 text-right",children:["KES ",(s.priceTotal/1e3).toFixed(0),"K"]}),e.jsxs("td",{className:"py-2 px-2",children:[s.leadTime," days"]})]},s.id))})]})})})]})]})}function q8e(){return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Vendor Deliveries & Invoices"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Delivery notes, GRN processing, and invoice tracking"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Pending GRN"}),e.jsx($s,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"8"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting receipt"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Received"}),e.jsx(Ns,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"142"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This month"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Rejected"}),e.jsx(ec,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"3"}),e.jsx("p",{className:"text-xs text-red-600",children:"Quality issues"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Pending Payment"}),e.jsx(zo,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"KES 2.4M"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"28 invoices"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Delivery Management"})}),e.jsx(X,{children:e.jsx("p",{className:"text-muted-foreground",children:"Delivery note submission, GRN verification, invoice approval, and payment tracking coming soon..."})})]})]})}const IT={name:"",category:"Community",influence:3,interest:3,engagement:"monthly",email:"",phone:"",organization:"",notes:"",isVulnerable:!1,vulnerableReason:"",status:"active"};function V8e({open:t,onOpenChange:r,stakeholder:s,onSave:n}){const[a,o]=A.useState(IT),[c,i]=A.useState(!1);A.useEffect(()=>{o(s?{...IT,...s}:IT)},[s,t]);const f=async()=>{i(!0);try{await n(a),r(!1)}finally{i(!1)}};return e.jsx(Qt,{open:t,onOpenChange:r,children:e.jsxs(Zt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:s!=null&&s.id?"Edit Stakeholder":"Add New Stakeholder"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"name",children:"Name *"}),e.jsx(Ie,{id:"name",value:a.name,onChange:p=>o({...a,name:p.target.value}),placeholder:"Stakeholder name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"organization",children:"Organization"}),e.jsx(Ie,{id:"organization",value:a.organization,onChange:p=>o({...a,organization:p.target.value}),placeholder:"Organization name"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"email",children:"Email"}),e.jsx(Ie,{id:"email",type:"email",value:a.email,onChange:p=>o({...a,email:p.target.value}),placeholder:"email@example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"phone",children:"Phone"}),e.jsx(Ie,{id:"phone",value:a.phone,onChange:p=>o({...a,phone:p.target.value}),placeholder:"+254 XXX XXX XXX"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Category *"}),e.jsxs(Nt,{value:a.category,onValueChange:p=>o({...a,category:p}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"Government",children:"Government"}),e.jsx(ge,{value:"Community",children:"Community"}),e.jsx(ge,{value:"Users",children:"Users"}),e.jsx(ge,{value:"NGO",children:"NGO"}),e.jsx(ge,{value:"Private",children:"Private Sector"}),e.jsx(ge,{value:"Vulnerable",children:"Vulnerable Group"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Influence Level (1-5)"}),e.jsxs(Nt,{value:String(a.influence),onValueChange:p=>o({...a,influence:parseInt(p)}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"1",children:"1 - Very Low"}),e.jsx(ge,{value:"2",children:"2 - Low"}),e.jsx(ge,{value:"3",children:"3 - Medium"}),e.jsx(ge,{value:"4",children:"4 - High"}),e.jsx(ge,{value:"5",children:"5 - Very High"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Interest Level (1-5)"}),e.jsxs(Nt,{value:String(a.interest),onValueChange:p=>o({...a,interest:parseInt(p)}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"1",children:"1 - Very Low"}),e.jsx(ge,{value:"2",children:"2 - Low"}),e.jsx(ge,{value:"3",children:"3 - Medium"}),e.jsx(ge,{value:"4",children:"4 - High"}),e.jsx(ge,{value:"5",children:"5 - Very High"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Engagement Frequency"}),e.jsxs(Nt,{value:a.engagement,onValueChange:p=>o({...a,engagement:p}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"weekly",children:"Weekly"}),e.jsx(ge,{value:"bi-weekly",children:"Bi-weekly"}),e.jsx(ge,{value:"monthly",children:"Monthly"}),e.jsx(ge,{value:"quarterly",children:"Quarterly"}),e.jsx(ge,{value:"annually",children:"Annually"}),e.jsx(ge,{value:"as-needed",children:"As Needed"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Status"}),e.jsxs(Nt,{value:a.status,onValueChange:p=>o({...a,status:p}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"active",children:"Active"}),e.jsx(ge,{value:"inactive",children:"Inactive"}),e.jsx(ge,{value:"pending",children:"Pending"})]})]})]})]}),e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-orange-50/50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(we,{htmlFor:"vulnerable",className:"text-base font-medium",children:"Vulnerable Group Flag"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Mark this stakeholder as requiring special attention"})]}),e.jsx(ml,{id:"vulnerable",checked:a.isVulnerable,onCheckedChange:p=>o({...a,isVulnerable:p})})]}),a.isVulnerable&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"vulnerableReason",children:"Reason for Vulnerability"}),e.jsx(Ie,{id:"vulnerableReason",value:a.vulnerableReason,onChange:p=>o({...a,vulnerableReason:p.target.value}),placeholder:"e.g., Elderly, disability, economic hardship, remote location..."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"notes",children:"Notes"}),e.jsx(ws,{id:"notes",value:a.notes,onChange:p=>o({...a,notes:p.target.value}),placeholder:"Additional notes about this stakeholder...",rows:3})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{onClick:f,disabled:c||!a.name,children:c?"Saving...":s!=null&&s.id?"Update":"Create"})]})]})})}function U8e(){const[t,r]=A.useState([]),[s,n]=A.useState(!0),[a,o]=A.useState(""),[c,i]=A.useState(!1),[f,p]=A.useState(null),g=()=>{pe.get("/community/stakeholders").then(C=>{const D=C.data||C;r(Array.isArray(D)?D:[])}).catch(C=>console.error(C)).finally(()=>n(!1))};A.useEffect(()=>{g()},[]);const y=()=>{const D=[["ID","Name","Category","Influence","Interest","Engagement","Last Engagement","Status","Vulnerable","Email","Phone"].join(","),...t.map(U=>[U.id,`"${U.name}"`,U.category,U.influence,U.interest,U.engagement,U.lastEngagement,U.status,U.isVulnerable?"Yes":"No",U.email||"",U.phone||""].join(","))].join(`
`),L=new Blob([D],{type:"text/csv"}),F=window.URL.createObjectURL(L),B=document.createElement("a");B.href=F,B.download=`stakeholders_${new Date().toISOString().split("T")[0]}.csv`,B.click(),window.URL.revokeObjectURL(F)},b=async C=>{if(C.id)r(D=>D.map(L=>L.id===C.id?{...L,...C}:L));else{const D={...C,id:Date.now(),lastEngagement:new Date().toISOString().split("T")[0]};r(L=>[...L,D])}p(null)},w=()=>{p(null),i(!0)},T=C=>{p(C),i(!0)},N=t.filter(C=>C.name.toLowerCase().includes(a.toLowerCase())||C.category.toLowerCase().includes(a.toLowerCase())),M=C=>({Government:"bg-blue-100 text-blue-800",Community:"bg-green-100 text-green-800",Users:"bg-purple-100 text-purple-800",NGO:"bg-orange-100 text-orange-800",Vulnerable:"bg-red-100 text-red-800"})[C]||"bg-gray-100 text-gray-800",O=C=>C==="monthly"?"":C==="bi-weekly"?"":C==="quarterly"?"":"";return s?e.jsx("div",{className:"p-6",children:"Loading..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Stakeholder Directory"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{size:"sm",variant:"outline",onClick:y,children:[e.jsx(ma,{className:"h-4 w-4 mr-2"}),"Export CSV"]}),e.jsxs(K,{size:"sm",onClick:w,children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Add Stakeholder"]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search stakeholders...",className:"pl-10",value:a,onChange:C=>o(C.target.value)})]}),e.jsx("div",{className:"space-y-2",children:N.map(C=>e.jsx(H,{className:"cursor-pointer hover:bg-muted/50",children:e.jsx(X,{className:"py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium",children:C.name}),C.isVulnerable&&e.jsxs(Ae,{className:"bg-orange-100 text-orange-800",children:[e.jsx(Fr,{className:"h-3 w-3 mr-1"}),"Vulnerable"]})]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(Ae,{className:M(C.category),children:C.category}),e.jsxs(Ae,{variant:"outline",children:["Influence: ",C.influence,"/5"]}),e.jsxs(Ae,{variant:"outline",children:["Interest: ",C.interest,"/5"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right text-sm text-muted-foreground",children:[e.jsxs("div",{children:[O(C.engagement)," ",C.engagement]}),e.jsx("div",{className:"text-xs mt-1",children:new Date(C.lastEngagement).toLocaleDateString()})]}),e.jsx(K,{size:"sm",variant:"ghost",onClick:()=>T(C),children:e.jsx(ki,{className:"h-4 w-4"})})]})]})})},C.id))}),e.jsx(V8e,{open:c,onOpenChange:i,stakeholder:f,onSave:b})]})}function W8e(){const[t,r]=A.useState(null);return A.useEffect(()=>{pe.get("/community/stakeholder-matrix").then(s=>{const n=s.data||s;r(n)}).catch(s=>console.error(s))},[]),t?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Influence & Interest Analysis"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(H,{className:"bg-green-50",children:e.jsxs(X,{className:"pt-4",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:t.highInfluenceHighInterest}),e.jsx("p",{className:"text-sm text-green-700 font-medium",children:"Champions"}),e.jsx("p",{className:"text-xs text-green-600",children:"High Influence, High Interest"})]})}),e.jsx(H,{className:"bg-yellow-50",children:e.jsxs(X,{className:"pt-4",children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-600",children:t.highInfluenceLowInterest}),e.jsx("p",{className:"text-sm text-yellow-700 font-medium",children:"Key Supporters"}),e.jsx("p",{className:"text-xs text-yellow-600",children:"High Influence, Low Interest"})]})}),e.jsx(H,{className:"bg-blue-50",children:e.jsxs(X,{className:"pt-4",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:t.lowInfluenceHighInterest}),e.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Engaged Community"}),e.jsx("p",{className:"text-xs text-blue-600",children:"Low Influence, High Interest"})]})}),e.jsx(H,{className:"bg-gray-50",children:e.jsxs(X,{className:"pt-4",children:[e.jsx("div",{className:"text-3xl font-bold text-gray-600",children:t.lowInfluenceLowInterest}),e.jsx("p",{className:"text-sm text-gray-700 font-medium",children:"General Public"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Low Influence, Low Interest"})]})})]})]}):e.jsx("div",{children:"Loading..."})}function G8e(){const[t,r]=A.useState([]),[s,n]=A.useState(!0);A.useEffect(()=>{pe.get("/community/engagement-history").then(i=>{const f=i.data||i;r(Array.isArray(f)?f:[])}).catch(i=>console.error(i)).finally(()=>n(!1))},[]);const a=i=>{switch(i){case"meeting":return e.jsx(Ds,{className:"h-4 w-4"});case"consultation":return e.jsx(Ki,{className:"h-4 w-4"});case"focus_group":return e.jsx(Ds,{className:"h-4 w-4"});case"phone_call":return e.jsx(_m,{className:"h-4 w-4"});case"email":return e.jsx(Fm,{className:"h-4 w-4"});default:return e.jsx(wn,{className:"h-4 w-4"})}},o=i=>{switch(i){case"positive":return e.jsx(Ns,{className:"h-4 w-4 text-green-500"});case"negative":return e.jsx(ec,{className:"h-4 w-4 text-red-500"});default:return e.jsx($s,{className:"h-4 w-4 text-yellow-500"})}},c=i=>{switch(i){case"positive":return"bg-green-100 text-green-800";case"negative":return"bg-red-100 text-red-800";default:return"bg-yellow-100 text-yellow-800"}};return s?e.jsx("div",{className:"p-4",children:"Loading engagement history..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Engagement Timeline"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-4 top-0 bottom-0 w-0.5 bg-border"}),e.jsx("div",{className:"space-y-4",children:t.map((i,f)=>e.jsxs("div",{className:"relative pl-10",children:[e.jsx("div",{className:"absolute left-2 w-5 h-5 rounded-full bg-primary flex items-center justify-center",children:a(i.type)}),e.jsx(H,{children:e.jsx(X,{className:"py-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium capitalize",children:i.type.replace("_"," ")}),e.jsxs(Ae,{className:c(i.outcome),children:[o(i.outcome),e.jsx("span",{className:"ml-1 capitalize",children:i.outcome})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.notes})]}),e.jsx("div",{className:"text-right text-sm text-muted-foreground",children:new Date(i.date).toLocaleDateString()})]})})})]},i.id))})]}),t.length===0&&e.jsx(H,{children:e.jsx(X,{className:"py-8 text-center text-muted-foreground",children:"No engagement history yet"})})]})}const K8e=[{id:1,name:"Community Consultation",description:"Standard community consultation process for major projects",category:"Community",frequency:"per-project",activities:[{id:1,type:"meeting",description:"Initial stakeholder identification meeting",daysFromStart:0},{id:2,type:"consultation",description:"Public notice and information session",daysFromStart:7},{id:3,type:"focus_group",description:"Focus group discussions with affected groups",daysFromStart:14},{id:4,type:"meeting",description:"Feedback consolidation meeting",daysFromStart:21},{id:5,type:"email",description:"Share consultation report with stakeholders",daysFromStart:28}]},{id:2,name:"Vulnerable Group Outreach",description:"Special engagement plan for vulnerable community members",category:"Vulnerable",frequency:"quarterly",activities:[{id:1,type:"phone_call",description:"Check-in call to verify water access",daysFromStart:0},{id:2,type:"meeting",description:"Home visit for special needs assessment",daysFromStart:7},{id:3,type:"email",description:"Share support resources and assistance programs",daysFromStart:14}]},{id:3,name:"Government Liaison",description:"Regular engagement with government stakeholders",category:"Government",frequency:"monthly",activities:[{id:1,type:"email",description:"Monthly progress report",daysFromStart:0},{id:2,type:"meeting",description:"Quarterly review meeting",daysFromStart:30}]},{id:4,name:"NGO Partnership",description:"Coordination with NGO partners",category:"NGO",frequency:"bi-weekly",activities:[{id:1,type:"meeting",description:"Coordination call",daysFromStart:0},{id:2,type:"email",description:"Share field activity updates",daysFromStart:7}]}];function H8e(){const[t,r]=A.useState(K8e),[s,n]=A.useState(null),[a,o]=A.useState(!1),[c,i]=A.useState(""),f=y=>{switch(y){case"meeting":return e.jsx(Ds,{className:"h-4 w-4"});case"consultation":return e.jsx(Ki,{className:"h-4 w-4"});case"focus_group":return e.jsx(Ds,{className:"h-4 w-4"});case"phone_call":return e.jsx(_m,{className:"h-4 w-4"});case"email":return e.jsx(Fm,{className:"h-4 w-4"});default:return e.jsx(wn,{className:"h-4 w-4"})}},p=y=>({Government:"bg-blue-100 text-blue-800",Community:"bg-green-100 text-green-800",Users:"bg-purple-100 text-purple-800",NGO:"bg-orange-100 text-orange-800",Vulnerable:"bg-red-100 text-red-800"})[y]||"bg-gray-100 text-gray-800",g=()=>{if(!s||!c)return;const y=new Date(c),b=s.activities.map(w=>{const T=new Date(y);return T.setDate(T.getDate()+w.daysFromStart),{...w,scheduledDate:T.toISOString().split("T")[0]}});console.log("Scheduled activities:",b),alert(`Template "${s.name}" applied! ${b.length} activities scheduled starting ${c}`),o(!1),n(null),i("")};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Engagement Plan Templates"}),e.jsxs(K,{size:"sm",children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Create Template"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(y=>e.jsxs(H,{className:"hover:border-primary/50 transition-colors",children:[e.jsx(ue,{className:"pb-2",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(he,{className:"text-lg",children:y.name}),e.jsx(mr,{className:"mt-1",children:y.description})]}),e.jsx(Ae,{className:p(y.category),children:y.category})]})}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(wn,{className:"h-4 w-4"}),e.jsx("span",{className:"capitalize",children:y.frequency.replace("-"," ")}),e.jsx("span",{children:""}),e.jsxs("span",{children:[y.activities.length," activities"]})]}),e.jsxs("div",{className:"space-y-1",children:[y.activities.slice(0,3).map(b=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[f(b.type),e.jsx("span",{className:"truncate",children:b.description}),e.jsxs("span",{className:"text-muted-foreground ml-auto text-xs",children:["Day ",b.daysFromStart]})]},b.id)),y.activities.length>3&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["+",y.activities.length-3," more activities"]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(K,{size:"sm",variant:"outline",className:"flex-1",onClick:()=>{n(y),o(!0)},children:[e.jsx(wn,{className:"h-4 w-4 mr-2"}),"Apply"]}),e.jsx(K,{size:"sm",variant:"ghost",children:e.jsx(P_,{className:"h-4 w-4"})})]})]})})]},y.id))}),e.jsx(Qt,{open:a,onOpenChange:o,children:e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Apply Engagement Template"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Applying template: ",e.jsx("strong",{children:s==null?void 0:s.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"startDate",children:"Start Date"}),e.jsx(Ie,{id:"startDate",type:"date",value:c,onChange:y=>i(y.target.value)})]}),s&&c&&e.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Scheduled Activities:"}),e.jsx("div",{className:"space-y-1 text-sm",children:s.activities.map(y=>{const b=new Date(c);return b.setDate(b.getDate()+y.daysFromStart),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:y.description}),e.jsx("span",{className:"text-muted-foreground",children:b.toLocaleDateString()})]},y.id)})})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(K,{onClick:g,disabled:!c,children:"Apply Template"})]})]})})]})}function Z8e(){const[t,r]=A.useState([]),[s,n]=A.useState(new Set),[a,o]=A.useState(!0),[c,i]=A.useState(!1),[f,p]=A.useState({type:"meeting",date:"",time:"",subject:"",notes:""}),[g,y]=A.useState(!1);A.useEffect(()=>{pe.get("/community/stakeholders").then(C=>{const D=C.data||C;r(Array.isArray(D)?D:[])}).catch(C=>console.error(C)).finally(()=>o(!1))},[]);const b=C=>{const D=new Set(s);D.has(C)?D.delete(C):D.add(C),n(D)},w=()=>{s.size===t.length?n(new Set):n(new Set(t.map(C=>C.id)))},T=C=>{const D=t.filter(F=>F.category===C).map(F=>F.id),L=new Set(s);D.forEach(F=>L.add(F)),n(L)},N=()=>{const C=t.filter(L=>L.influence>=4).map(L=>L.id),D=new Set(s);C.forEach(L=>D.add(L)),n(D)},M=C=>({Government:"bg-blue-100 text-blue-800",Community:"bg-green-100 text-green-800",Users:"bg-purple-100 text-purple-800",NGO:"bg-orange-100 text-orange-800",Vulnerable:"bg-red-100 text-red-800"})[C]||"bg-gray-100 text-gray-800",O=async()=>{if(s.size!==0){y(!0);try{const C=t.filter(D=>s.has(D.id));console.log("Scheduling engagement for:",C,f),alert(`Engagement scheduled for ${s.size} stakeholders on ${f.date} at ${f.time}`),i(!1),n(new Set),p({type:"meeting",date:"",time:"",subject:"",notes:""})}finally{y(!1)}}};return a?e.jsx("div",{className:"p-4",children:"Loading stakeholders..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Bulk Engagement Scheduler"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Ae,{variant:"outline",children:[s.size," selected"]}),e.jsxs(K,{size:"sm",disabled:s.size===0,onClick:()=>i(!0),children:[e.jsx(wn,{className:"h-4 w-4 mr-2"}),"Schedule Engagement"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(K,{size:"sm",variant:"outline",onClick:w,children:s.size===t.length?"Deselect All":"Select All"}),e.jsx(K,{size:"sm",variant:"outline",onClick:N,children:"High Influence"}),e.jsx(K,{size:"sm",variant:"outline",onClick:()=>T("Government"),children:"Government"}),e.jsx(K,{size:"sm",variant:"outline",onClick:()=>T("Community"),children:"Community"}),e.jsx(K,{size:"sm",variant:"outline",onClick:()=>T("Vulnerable"),children:"Vulnerable Groups"})]}),e.jsx("div",{className:"space-y-2",children:t.map(C=>e.jsx(H,{className:`cursor-pointer transition-colors ${s.has(C.id)?"border-primary bg-primary/5":""}`,onClick:()=>b(C.id),children:e.jsx(X,{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Fd,{checked:s.has(C.id),onCheckedChange:()=>b(C.id)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium",children:C.name}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx(Ae,{className:M(C.category),children:C.category}),e.jsxs(Ae,{variant:"outline",children:["Influence: ",C.influence,"/5"]})]})]}),e.jsx("div",{className:"text-right text-sm text-muted-foreground",children:e.jsxs("div",{children:["Last: ",new Date(C.lastEngagement).toLocaleDateString()]})})]})})},C.id))}),e.jsx(Qt,{open:c,onOpenChange:i,children:e.jsxs(Zt,{className:"max-w-lg",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Schedule Bulk Engagement"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx("div",{className:"p-3 bg-muted rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ds,{className:"h-5 w-5 text-primary"}),e.jsxs("span",{className:"font-medium",children:[s.size," stakeholders selected"]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Engagement Type"}),e.jsxs(Nt,{value:f.type,onValueChange:C=>p({...f,type:C}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"meeting",children:"Meeting"}),e.jsx(ge,{value:"consultation",children:"Consultation"}),e.jsx(ge,{value:"focus_group",children:"Focus Group"}),e.jsx(ge,{value:"phone_call",children:"Phone Call"}),e.jsx(ge,{value:"email",children:"Email"}),e.jsx(ge,{value:"site_visit",children:"Site Visit"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Date"}),e.jsx(Ie,{type:"date",value:f.date,onChange:C=>p({...f,date:C.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Time"}),e.jsx(Ie,{type:"time",value:f.time,onChange:C=>p({...f,time:C.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Subject"}),e.jsx(Ie,{value:f.subject,onChange:C=>p({...f,subject:C.target.value}),placeholder:"Meeting subject..."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Notes"}),e.jsx(ws,{value:f.notes,onChange:C=>p({...f,notes:C.target.value}),placeholder:"Additional notes or agenda...",rows:3})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsx(K,{onClick:O,disabled:g||!f.date||!f.type,children:g?"Scheduling...":"Schedule"})]})]})})]})}const Y8e=[{id:1,stakeholderId:1,stakeholderName:"County Water Director",type:"meeting",direction:"outbound",subject:"Quarterly Review Meeting",summary:"Discussed water quality improvements and budget allocation for Q1 2026. Director expressed satisfaction with recent progress.",date:"2025-11-20",duration:60,outcome:"positive",followUpRequired:!0,followUpDate:"2025-12-15",createdBy:"John Operator"},{id:2,stakeholderId:2,stakeholderName:"Community Chairperson",type:"phone",direction:"inbound",subject:"Tariff Concern",summary:"Chairperson called to express community concerns about proposed tariff increase. Requested a community meeting.",date:"2025-11-18",duration:25,outcome:"neutral",followUpRequired:!0,followUpDate:"2025-11-25",createdBy:"Mary Supervisor"},{id:3,stakeholderId:5,stakeholderName:"Women Vendors Group",type:"email",direction:"outbound",subject:"Water Access Program Update",summary:"Sent monthly update on the women vendors water access program. Included schedule for next training session.",date:"2025-11-15",outcome:"positive",followUpRequired:!1,createdBy:"John Operator"}];function X8e(){var M;const[t,r]=A.useState(Y8e),[s,n]=A.useState([]),[a,o]=A.useState(""),[c,i]=A.useState("all"),[f,p]=A.useState(!1),[g,y]=A.useState({type:"phone",direction:"outbound",outcome:"neutral",followUpRequired:!1});A.useEffect(()=>{pe.get("/community/stakeholders").then(O=>{const C=O.data||O;n(Array.isArray(C)?C:[])}).catch(O=>console.error(O))},[]);const b=O=>{switch(O){case"phone":return e.jsx(_m,{className:"h-4 w-4"});case"email":return e.jsx(Fm,{className:"h-4 w-4"});case"meeting":return e.jsx(Ds,{className:"h-4 w-4"});case"letter":return e.jsx(bs,{className:"h-4 w-4"});case"sms":return e.jsx(Ki,{className:"h-4 w-4"});default:return e.jsx(Ki,{className:"h-4 w-4"})}},w=O=>{switch(O){case"positive":return"bg-green-100 text-green-800";case"negative":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},T=t.filter(O=>{const C=O.stakeholderName.toLowerCase().includes(a.toLowerCase())||O.subject.toLowerCase().includes(a.toLowerCase()),D=c==="all"||O.type===c;return C&&D}),N=()=>{if(!g.stakeholderId||!g.subject||!g.summary)return;const O=s.find(D=>D.id===g.stakeholderId),C={id:t.length+1,stakeholderId:g.stakeholderId,stakeholderName:(O==null?void 0:O.name)||"Unknown",type:g.type,direction:g.direction,subject:g.subject,summary:g.summary,date:new Date().toISOString().split("T")[0],duration:g.duration,outcome:g.outcome,followUpRequired:g.followUpRequired||!1,followUpDate:g.followUpDate,createdBy:"Current User"};r([C,...t]),p(!1),y({type:"phone",direction:"outbound",outcome:"neutral",followUpRequired:!1})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Communication Logs"}),e.jsxs(K,{size:"sm",onClick:()=>p(!0),children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Log Communication"]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search by stakeholder or subject...",className:"pl-10",value:a,onChange:O=>o(O.target.value)})]}),e.jsxs(Nt,{value:c,onValueChange:i,children:[e.jsx(bt,{className:"w-40",children:e.jsx(St,{placeholder:"Filter by type"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Types"}),e.jsx(ge,{value:"phone",children:"Phone"}),e.jsx(ge,{value:"email",children:"Email"}),e.jsx(ge,{value:"meeting",children:"Meeting"}),e.jsx(ge,{value:"letter",children:"Letter"}),e.jsx(ge,{value:"sms",children:"SMS"})]})]})]}),e.jsx(qm,{className:"h-[500px]",children:e.jsx("div",{className:"space-y-3",children:T.map(O=>e.jsx(H,{children:e.jsx(X,{className:"py-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-2 rounded-full bg-primary/10",children:b(O.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:O.subject}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mt-1",children:[e.jsx(bC,{className:"h-3 w-3"}),e.jsx("span",{children:O.stakeholderName}),e.jsx("span",{children:""}),e.jsx("span",{className:"capitalize",children:O.type}),e.jsx("span",{children:""}),e.jsx("span",{className:"capitalize",children:O.direction})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(Ae,{className:w(O.outcome),children:O.outcome}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:new Date(O.date).toLocaleDateString()})]})]}),e.jsx("p",{className:"text-sm mt-2 text-muted-foreground",children:O.summary}),O.followUpRequired&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-orange-600",children:[e.jsx(wn,{className:"h-4 w-4"}),e.jsxs("span",{children:["Follow-up: ",O.followUpDate?new Date(O.followUpDate).toLocaleDateString():"Required"]})]})]})]})})},O.id))})}),e.jsx(Qt,{open:f,onOpenChange:p,children:e.jsxs(Zt,{className:"max-w-lg",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Log Communication"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Stakeholder"}),e.jsxs(Nt,{value:(M=g.stakeholderId)==null?void 0:M.toString(),onValueChange:O=>y({...g,stakeholderId:parseInt(O)}),children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select stakeholder..."})}),e.jsx(_t,{children:s.map(O=>e.jsx(ge,{value:O.id.toString(),children:O.name},O.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Type"}),e.jsxs(Nt,{value:g.type,onValueChange:O=>y({...g,type:O}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"phone",children:"Phone"}),e.jsx(ge,{value:"email",children:"Email"}),e.jsx(ge,{value:"meeting",children:"Meeting"}),e.jsx(ge,{value:"letter",children:"Letter"}),e.jsx(ge,{value:"sms",children:"SMS"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Direction"}),e.jsxs(Nt,{value:g.direction,onValueChange:O=>y({...g,direction:O}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"inbound",children:"Inbound"}),e.jsx(ge,{value:"outbound",children:"Outbound"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Subject"}),e.jsx(Ie,{value:g.subject||"",onChange:O=>y({...g,subject:O.target.value}),placeholder:"Communication subject..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Summary"}),e.jsx(ws,{value:g.summary||"",onChange:O=>y({...g,summary:O.target.value}),placeholder:"Brief summary of the communication...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Outcome"}),e.jsxs(Nt,{value:g.outcome,onValueChange:O=>y({...g,outcome:O}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"positive",children:"Positive"}),e.jsx(ge,{value:"neutral",children:"Neutral"}),e.jsx(ge,{value:"negative",children:"Negative"}),e.jsx(ge,{value:"pending",children:"Pending"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Duration (minutes)"}),e.jsx(Ie,{type:"number",value:g.duration||"",onChange:O=>y({...g,duration:parseInt(O.target.value)||void 0}),placeholder:"Optional"})]})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(K,{onClick:N,disabled:!g.stakeholderId||!g.subject||!g.summary,children:"Log Communication"})]})]})})]})}function Q8e(){const[t,r]=A.useState("registry"),[s,n]=A.useState(null),[a,o]=A.useState(3);return A.useEffect(()=>{pe.get("/community/stakeholder-matrix").then(c=>{const i=c.data||c;n(i)}).catch(c=>console.error(c))},[]),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Stakeholder Mapping"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Stakeholder registry, influence/interest analysis, and engagement tracking"})]}),a>0&&e.jsxs(Ae,{className:"bg-orange-100 text-orange-800",children:[e.jsx(Fr,{className:"h-4 w-4 mr-1"}),a," follow-ups pending"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total Stakeholders"}),e.jsx(Ds,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"245"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All categories"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"High Influence"}),e.jsx(zs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(s==null?void 0:s.highInfluenceHighInterest)||32}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Key decision makers"})]})]}),e.jsxs(H,{className:"border-orange-200 bg-orange-50/50",children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium text-orange-700",children:"Vulnerable Groups"}),e.jsx(Fr,{className:"h-4 w-4 text-orange-500"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-700",children:(s==null?void 0:s.vulnerable)||18}),e.jsx("p",{className:"text-xs text-orange-600",children:"Requiring special attention"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"This Month"}),e.jsx(wn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"12"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Engagements completed"})]})]})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs(ss,{value:t,onValueChange:r,className:"w-full",children:[e.jsxs(Yr,{className:"grid w-full grid-cols-6",children:[e.jsxs(wt,{value:"registry",className:"text-xs",children:[e.jsx(Ds,{className:"h-4 w-4 mr-1"}),"Registry"]}),e.jsxs(wt,{value:"analysis",className:"text-xs",children:[e.jsx(zs,{className:"h-4 w-4 mr-1"}),"Analysis"]}),e.jsxs(wt,{value:"timeline",className:"text-xs",children:[e.jsx(wn,{className:"h-4 w-4 mr-1"}),"Timeline"]}),e.jsxs(wt,{value:"templates",className:"text-xs",children:[e.jsx(bs,{className:"h-4 w-4 mr-1"}),"Templates"]}),e.jsxs(wt,{value:"scheduler",className:"text-xs",children:[e.jsx(wn,{className:"h-4 w-4 mr-1"}),"Scheduler"]}),e.jsxs(wt,{value:"comms",className:"text-xs",children:[e.jsx(Ki,{className:"h-4 w-4 mr-1"}),"Comms Log"]})]}),e.jsx(kt,{value:"registry",className:"mt-4",children:e.jsx(U8e,{})}),e.jsx(kt,{value:"analysis",className:"mt-4",children:e.jsx(W8e,{})}),e.jsx(kt,{value:"timeline",className:"mt-4",children:e.jsx(G8e,{})}),e.jsx(kt,{value:"templates",className:"mt-4",children:e.jsx(H8e,{})}),e.jsx(kt,{value:"scheduler",className:"mt-4",children:e.jsx(Z8e,{})}),e.jsx(kt,{value:"comms",className:"mt-4",children:e.jsx(X8e,{})})]})})})]})}const J8e=[{value:"baraza",label:"Community Baraza"},{value:"meeting",label:"Meeting"},{value:"consultation",label:"Consultation"},{value:"workshop",label:"Workshop"},{value:"focus_group",label:"Focus Group"},{value:"presentation",label:"Presentation"},{value:"training",label:"Training Session"}],eqe=["Government","Community","NGO","Private","Users","Vulnerable"];function tqe({open:t,onOpenChange:r,event:s,onSave:n}){const[a,o]=A.useState({title:"",type:"meeting",date:"",time:"10:00",location:"",description:"",expectedAttendance:0,stakeholderGroups:[]});A.useEffect(()=>{o(s||{title:"",type:"meeting",date:new Date().toISOString().split("T")[0],time:"10:00",location:"",description:"",expectedAttendance:0,stakeholderGroups:[]})},[s,t]);const c=f=>{f.preventDefault(),n(a),r(!1)},i=f=>{o(p=>({...p,stakeholderGroups:p.stakeholderGroups.includes(f)?p.stakeholderGroups.filter(g=>g!==f):[...p.stakeholderGroups,f]}))};return e.jsx(Qt,{open:t,onOpenChange:r,children:e.jsxs(Zt,{className:"max-w-lg",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:s?"Edit Event":"Create New Event"})}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"title",children:"Event Title"}),e.jsx(Ie,{id:"title",value:a.title,onChange:f=>o(p=>({...p,title:f.target.value})),placeholder:"e.g., Community Baraza - Water Quality Update",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"type",children:"Event Type"}),e.jsxs(Nt,{value:a.type,onValueChange:f=>o(p=>({...p,type:f})),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsx(_t,{children:J8e.map(f=>e.jsx(ge,{value:f.value,children:f.label},f.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"expectedAttendance",children:"Expected Attendance"}),e.jsx(Ie,{id:"expectedAttendance",type:"number",min:1,value:a.expectedAttendance,onChange:f=>o(p=>({...p,expectedAttendance:parseInt(f.target.value)||0}))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"date",children:"Date"}),e.jsx(Ie,{id:"date",type:"date",value:a.date,onChange:f=>o(p=>({...p,date:f.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"time",children:"Time"}),e.jsx(Ie,{id:"time",type:"time",value:a.time,onChange:f=>o(p=>({...p,time:f.target.value})),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"location",children:"Location"}),e.jsx(Ie,{id:"location",value:a.location,onChange:f=>o(p=>({...p,location:f.target.value})),placeholder:"e.g., Elwak Community Hall",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"description",children:"Description"}),e.jsx(ws,{id:"description",value:a.description,onChange:f=>o(p=>({...p,description:f.target.value})),placeholder:"Brief description of the event objectives...",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Stakeholder Groups"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:eqe.map(f=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fd,{id:`group-${f}`,checked:a.stakeholderGroups.includes(f),onCheckedChange:()=>i(f)}),e.jsx("label",{htmlFor:`group-${f}`,className:"text-sm cursor-pointer",children:f})]},f))})]}),e.jsxs(Ps,{children:[e.jsx(K,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(K,{type:"submit",children:s?"Save Changes":"Create Event"})]})]})]})})}function rqe({open:t,onOpenChange:r,event:s}){const[n,a]=A.useState([]),[o,c]=A.useState(!1),[i,f]=A.useState({name:"",organization:"",phone:""}),[p,g]=A.useState(!1);A.useEffect(()=>{s&&t&&(c(!0),pe.get(`/community/events/${s.id}/attendance`).then(T=>{const N=T.data||T;a(Array.isArray(N)?N:[])}).catch(T=>console.error(T)).finally(()=>c(!1)))},[s,t]);const y=()=>{s&&pe.get(`/community/events/${s.id}/attendance`).then(T=>{const N=T.data||T;a(Array.isArray(N)?N:[])}).catch(T=>console.error(T))},b=async T=>{if(T.preventDefault(),!!s){g(!0);try{await pe.post(`/community/events/${s.id}/checkin`,i),f({name:"",organization:"",phone:""}),y()}catch(N){console.error(N)}finally{g(!1)}}},w=()=>{if(!s)return;const N=[["Name","Organization","Phone","Check-in Time"].join(","),...n.map(D=>[`"${D.name}"`,`"${D.organization}"`,D.phone,D.checkinTime||"N/A"].join(","))].join(`
`),M=new Blob([N],{type:"text/csv"}),O=window.URL.createObjectURL(M),C=document.createElement("a");C.href=O,C.download=`attendance_${s.qrCode}_${s.date}.csv`,C.click(),window.URL.revokeObjectURL(O)};return s?e.jsx(Qt,{open:t,onOpenChange:r,children:e.jsxs(Zt,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Yt,{children:e.jsxs(Xt,{className:"flex items-center gap-2",children:[e.jsx(Ds,{className:"h-5 w-5"}),"Attendance - ",s.title]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsx(H,{children:e.jsxs(X,{className:"pt-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:n.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Checked In"})]})}),e.jsx(H,{children:e.jsxs(X,{className:"pt-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:s.expectedAttendance}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Expected"})]})}),e.jsx(H,{children:e.jsxs(X,{className:"pt-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[Math.round(n.length/s.expectedAttendance*100),"%"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Turnout"})]})})]}),e.jsxs(ss,{defaultValue:"checkin",className:"w-full",children:[e.jsxs(Yr,{className:"grid w-full grid-cols-3",children:[e.jsxs(wt,{value:"checkin",children:[e.jsx(m9,{className:"h-4 w-4 mr-1"}),"Check-In"]}),e.jsxs(wt,{value:"qr",children:[e.jsx(rM,{className:"h-4 w-4 mr-1"}),"QR Code"]}),e.jsxs(wt,{value:"list",children:[e.jsx(Ds,{className:"h-4 w-4 mr-1"}),"Attendees"]})]}),e.jsx(kt,{value:"checkin",className:"mt-4",children:e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"name",children:"Full Name"}),e.jsx(Ie,{id:"name",value:i.name,onChange:T=>f(N=>({...N,name:T.target.value})),placeholder:"Enter attendee name",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"organization",children:"Organization"}),e.jsx(Ie,{id:"organization",value:i.organization,onChange:T=>f(N=>({...N,organization:T.target.value})),placeholder:"e.g., Elwak Community, County Water Dept",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"phone",children:"Phone Number"}),e.jsx(Ie,{id:"phone",value:i.phone,onChange:T=>f(N=>({...N,phone:T.target.value})),placeholder:"+254..."})]}),e.jsxs(K,{type:"submit",className:"w-full",disabled:p,children:[e.jsx(Ns,{className:"h-4 w-4 mr-2"}),p?"Checking In...":"Check In Attendee"]})]})}),e.jsx(kt,{value:"qr",className:"mt-4",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"bg-white p-8 rounded-lg border-2 border-dashed inline-block",children:e.jsx("div",{className:"w-48 h-48 bg-gray-100 flex items-center justify-center rounded",children:e.jsxs("div",{className:"text-center",children:[e.jsx(rM,{className:"h-24 w-24 mx-auto text-gray-400"}),e.jsx("p",{className:"mt-2 text-sm font-mono text-gray-600",children:s.qrCode})]})})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Scan this QR code for self-service check-in"}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsxs(K,{variant:"outline",size:"sm",children:[e.jsx(ma,{className:"h-4 w-4 mr-2"}),"Download QR"]}),e.jsx(K,{variant:"outline",size:"sm",children:"Print Sign-In Sheet"})]})]})}),e.jsxs(kt,{value:"list",className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-medium",children:["Attendee List (",n.length,")"]}),e.jsxs(K,{size:"sm",variant:"outline",onClick:w,children:[e.jsx(ma,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]}),o?e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"Loading..."}):n.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No attendees checked in yet"}):e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:n.map(T=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:T.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:T.organization})]}),e.jsx("div",{className:"text-right",children:e.jsxs(Ae,{variant:"outline",className:"bg-green-50 text-green-700",children:[e.jsx($s,{className:"h-3 w-3 mr-1"}),T.checkinTime]})})]},T.id))})]})]})]})}):null}function sqe(){const[t,r]=A.useState([]),[s,n]=A.useState(!0),[a,o]=A.useState("upcoming"),[c,i]=A.useState(!1),[f,p]=A.useState(null),[g,y]=A.useState(!1),[b,w]=A.useState(null);A.useEffect(()=>{pe.get("/community/events").then(re=>{const Z=re.data||re;r(Array.isArray(Z)?Z:[])}).catch(re=>console.error(re)).finally(()=>n(!1))},[]);const T=t.filter(re=>re.status==="upcoming"),N=t.filter(re=>re.status==="completed"),M=N.reduce((re,Z)=>re+(Z.actualAttendance||0),0),O=()=>{p(null),i(!0)},C=re=>{p(re),i(!0)},D=()=>{pe.get("/community/events").then(re=>{const Z=re.data||re;r(Array.isArray(Z)?Z:[])}).catch(re=>console.error(re))},L=async re=>{try{f?await pe.put(`/community/events/${f.id}`,re):await pe.post("/community/events",re),D()}catch(Z){console.error("Error saving event:",Z)}},F=re=>{w(re),y(!0)},B=re=>({baraza:"bg-purple-100 text-purple-800",meeting:"bg-blue-100 text-blue-800",consultation:"bg-green-100 text-green-800",workshop:"bg-orange-100 text-orange-800",focus_group:"bg-pink-100 text-pink-800",presentation:"bg-indigo-100 text-indigo-800",training:"bg-yellow-100 text-yellow-800"})[re]||"bg-gray-100 text-gray-800",U=re=>({baraza:"Baraza",meeting:"Meeting",consultation:"Consultation",workshop:"Workshop",focus_group:"Focus Group",presentation:"Presentation",training:"Training"})[re]||re,te=re=>new Date(re).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),Q=({event:re,showAttendance:Z=!1})=>e.jsx(H,{className:"hover:shadow-md transition-shadow",children:e.jsx(X,{className:"pt-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ae,{className:B(re.type),children:U(re.type)}),re.status==="completed"&&e.jsxs(Ae,{variant:"outline",className:"bg-green-50 text-green-700",children:[e.jsx(Ns,{className:"h-3 w-3 mr-1"}),"Completed"]})]}),e.jsx("h3",{className:"font-semibold text-lg",children:re.title}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:re.description}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-3 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(wn,{className:"h-4 w-4"}),te(re.date)]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($s,{className:"h-4 w-4"}),re.time]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fn,{className:"h-4 w-4"}),re.location]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ds,{className:"h-4 w-4"}),Z&&re.actualAttendance!==null?`${re.actualAttendance}/${re.expectedAttendance}`:`${re.expectedAttendance} expected`]})]}),re.stakeholderGroups.length>0&&e.jsx("div",{className:"flex gap-1 mt-3",children:re.stakeholderGroups.map(ne=>e.jsx(Ae,{variant:"outline",className:"text-xs",children:ne},ne))})]}),e.jsxs("div",{className:"flex flex-col gap-2 ml-4",children:[e.jsxs(K,{size:"sm",variant:"outline",onClick:()=>F(re),children:[e.jsx(rM,{className:"h-4 w-4 mr-1"}),"Attendance"]}),e.jsxs(K,{size:"sm",variant:"ghost",onClick:()=>C(re),children:[e.jsx(ki,{className:"h-4 w-4 mr-1"}),"Edit"]})]})]})})});return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Stakeholder Engagement Planner"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Plan and track community meetings, barazas, and consultations"})]}),e.jsxs(K,{onClick:O,children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"New Event"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Upcoming Events"}),e.jsx(wn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:T.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Next 30 days"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total Attendance"}),e.jsx(Ds,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:M.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This quarter"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Completed"}),e.jsx(Ns,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:N.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Events this year"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Avg Turnout"}),e.jsx(mo,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[N.length>0?Math.round(N.reduce((re,Z)=>re+(Z.actualAttendance||0)/Z.expectedAttendance*100,0)/N.length):0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"vs expected"})]})]})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs(ss,{value:a,onValueChange:o,className:"w-full",children:[e.jsxs(Yr,{className:"grid w-full grid-cols-2 mb-4",children:[e.jsxs(wt,{value:"upcoming",children:[e.jsx(wn,{className:"h-4 w-4 mr-2"}),"Upcoming (",T.length,")"]}),e.jsxs(wt,{value:"past",children:[e.jsx(Ns,{className:"h-4 w-4 mr-2"}),"Past Events (",N.length,")"]})]}),e.jsx(kt,{value:"upcoming",children:s?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Loading events..."}):T.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(wn,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No upcoming events scheduled"}),e.jsxs(K,{className:"mt-4",onClick:O,children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Schedule Your First Event"]})]}):e.jsx("div",{className:"space-y-4",children:T.sort((re,Z)=>new Date(re.date).getTime()-new Date(Z.date).getTime()).map(re=>e.jsx(Q,{event:re},re.id))})}),e.jsx(kt,{value:"past",children:N.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No past events"}):e.jsx("div",{className:"space-y-4",children:N.sort((re,Z)=>new Date(Z.date).getTime()-new Date(re.date).getTime()).map(re=>e.jsx(Q,{event:re,showAttendance:!0},re.id))})})]})})}),e.jsx(tqe,{open:c,onOpenChange:i,event:f,onSave:L}),e.jsx(rqe,{open:g,onOpenChange:y,event:b})]})}function nqe(){const[t,r]=A.useState([]),[s,n]=A.useState({new:12,assigned:8,inProgress:28,resolved:156,overdueSla:3});A.useEffect(()=>{fetch("/api/grm/tickets").then(c=>c.json()).then(c=>{r(c.data||[]),c.stats&&n(c.stats)}).catch(()=>r([{id:"1",ticketNumber:"GRM-001",category:"water-quality",status:"new",severity:"high",location:"Kilimani",details:"Turbid water"},{id:"2",ticketNumber:"GRM-002",category:"billing",status:"assigned",severity:"medium",location:"Westlands",details:"Overcharge"}]))},[]);const a={new:{title:"New",color:"bg-gray-100",tickets:t.filter(c=>c.status==="new")},triaged:{title:"Triaged",color:"bg-blue-50",tickets:t.filter(c=>c.status==="triaged")},assigned:{title:"Assigned",color:"bg-purple-50",tickets:t.filter(c=>c.status==="assigned")},"in-progress":{title:"In Progress",color:"bg-yellow-50",tickets:t.filter(c=>c.status==="in-progress")},resolved:{title:"Resolved",color:"bg-green-50",tickets:t.filter(c=>c.status==="resolved")}},o=c=>{switch(c){case"high":return"destructive";case"medium":return"secondary";default:return"outline"}};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Grievance Redress Mechanism (GRM)"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Multi-channel complaint intake, SLA tracking, and resolution workflow"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"})," New Grievance"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"New"}),e.jsx(Ki,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.new}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting triage"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Active"}),e.jsx($s,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.inProgress}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"In resolution"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Overdue SLA"}),e.jsx(Fr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:s.overdueSla}),e.jsx("p",{className:"text-xs text-red-600",children:"Require escalation"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Resolved (30d)"}),e.jsx(Ns,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.resolved}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"91% SLA compliance"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total"}),e.jsx(Ki,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All tickets"})]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Kanban Board"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:Object.entries(a).map(([c,i])=>e.jsxs("div",{className:`${i.color} rounded-lg p-4 min-h-96`,children:[e.jsxs("h3",{className:"font-semibold mb-3",children:[i.title," (",i.tickets.length,")"]}),e.jsx("div",{className:"space-y-2",children:i.tickets.map(f=>e.jsx(H,{className:"cursor-pointer hover:shadow-md transition-shadow",children:e.jsxs(X,{className:"pt-3",children:[e.jsx("div",{className:"text-xs font-mono text-muted-foreground mb-1",children:f.ticketNumber}),e.jsx("p",{className:"text-sm font-medium",children:f.details}),e.jsxs("div",{className:"mt-2 flex gap-1",children:[e.jsx(Ae,{variant:o(f.severity),className:"text-xs",children:f.severity}),e.jsx(Ae,{variant:"outline",className:"text-xs",children:f.category})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:f.location})]})},f.id))})]},c))})]})]})}const lg=[{id:"committees",name:"Committee Registry",description:"Water committee locations, membership, and compliance metrics",category:"Governance",records:245,formats:["CSV","JSON","GeoJSON"],updated:"2025-11-20",downloads:342},{id:"water-facilities",name:"Water Facilities",description:"Treatment plants, pump stations, and storage facilities with operational status",category:"Infrastructure",records:1203,formats:["CSV","GeoJSON","Shapefile"],updated:"2025-11-19",downloads:521},{id:"water-kiosks",name:"Water Kiosks & Outlets",description:"Community water points with coverage and daily usage metrics",category:"Services",records:5847,formats:["CSV","GeoJSON"],updated:"2025-11-18",downloads:834},{id:"grievances",name:"Community Grievances",description:"Reported water quality, service interruptions, and billing complaints",category:"Community",records:3421,formats:["CSV","JSON"],updated:"2025-11-20",downloads:189},{id:"vendors",name:"Vendor Directory",description:"Approved service providers with KYC status and performance ratings",category:"Procurement",records:87,formats:["CSV","JSON"],updated:"2025-11-17",downloads:156},{id:"water-quality",name:"Water Quality Data",description:"Monthly testing results for chlorine, pH, turbidity, and contaminants",category:"Quality",records:12456,formats:["CSV","JSON"],updated:"2025-11-20",downloads:421}],aqe=[{path:"/api/v1/datasets/committees",method:"GET",description:"Get all committees with metadata",parameters:["limit","offset","status"],example:'curl -H "Authorization: Bearer KEY" /api/v1/datasets/committees?limit=50'},{path:"/api/v1/datasets/facilities",method:"GET",description:"Get water facilities by location or status",parameters:["latitude","longitude","radius","type"],example:"curl /api/v1/datasets/facilities?latitude=-1.29&longitude=36.82&radius=10"},{path:"/api/v1/datasets/grievances",method:"GET",description:"Query grievances by category, severity, or location",parameters:["category","severity","status","startDate","endDate"],example:"curl /api/v1/datasets/grievances?category=water-quality&severity=high"},{path:"/api/v1/datasets/export",method:"POST",description:"Export dataset in requested format",parameters:["datasetId","format","filters"],example:`curl -X POST /api/v1/datasets/export -d '{"datasetId":"committees","format":"csv"}'`},{path:"/api/v1/maps/tiles/{layer}/{z}/{x}/{y}",method:"GET",description:"Vector tile endpoint for map rendering",parameters:["layer","z","x","y"],example:"/api/v1/maps/tiles/facilities/8/140/84"},{path:"/api/v1/datasets/{id}/preview",method:"GET",description:"Get sample records from a dataset",parameters:["id","limit"],example:"curl /api/v1/datasets/water-quality/preview?limit=10"}],iqe=[{id:"story-1",title:"Water Access Gaps in ASAL Counties",description:"Analysis of coverage disparities showing which underserved areas lack reliable water access",insights:["23% of rural population >5km from nearest water point","Average wait time 2.3 hours during dry season","Seasonal variation in service availability"],relatedDatasets:["water-kiosks","water-facilities"],author:"Water Supply Team"},{id:"story-2",title:"Committee Performance & Compliance",description:"Study of governance effectiveness across committees and impact on service delivery",insights:["High-compliance committees have 18% better water quality","87% of compliant committees meet reporting deadlines","Training programs improve compliance by 34%"],relatedDatasets:["committees","water-quality"],author:"Governance Division"},{id:"story-3",title:"Seasonal Water Quality Trends",description:"Temporal patterns in water quality metrics showing seasonal contamination risks",insights:["Peak contamination in rainy season (+45%)","Chlorine residual drops 12% during peak demand","pH varies by 1.2 units across seasons"],relatedDatasets:["water-quality"],author:"Water Quality Lab"},{id:"story-4",title:"Grievance Resolution Effectiveness",description:"Metrics on complaint handling time and resolution rates by complaint type",insights:["Avg resolution time: 12.5 days","Water quality complaints resolved 2x faster","Digital reporting reduced wait time by 40%"],relatedDatasets:["grievances"],author:"Customer Service"}];function oqe(){const[t,r]=A.useState(""),[s,n]=A.useState(null),[a,o]=A.useState("discover"),c=A.useMemo(()=>lg.filter(g=>{const y=g.name.toLowerCase().includes(t.toLowerCase())||g.description.toLowerCase().includes(t.toLowerCase()),b=!s||g.category===s;return y&&b}),[t,s]),i=A.useMemo(()=>Array.from(new Set(lg.map(g=>g.category))),[]),f=lg.reduce((g,y)=>g+y.downloads,0),p=lg.reduce((g,y)=>g+y.records,0);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Open Data & Transparency"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Public datasets, APIs, maps, and transparency stories"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Public Datasets"}),e.jsx(c9,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:lg.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Available for download"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total Downloads"}),e.jsx(ma,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:f.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This month"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"API Calls"}),e.jsx(jS,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"8.4K"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Last 7 days"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Data Points"}),e.jsx(zs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[(p/1e3).toFixed(1),"K"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Records available"})]})]})]}),e.jsxs(ss,{value:a,onValueChange:o,className:"space-y-4",children:[e.jsxs(Yr,{className:"grid grid-cols-4 w-full max-w-md",children:[e.jsx(wt,{value:"discover",children:"Discover"}),e.jsx(wt,{value:"api",children:"API Docs"}),e.jsx(wt,{value:"stories",children:"Stories"}),e.jsx(wt,{value:"maps",children:"Maps"})]}),e.jsxs(kt,{value:"discover",className:"space-y-4",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm",children:"Search & Filter"})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(nn,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search datasets...",className:"pl-10",value:t,onChange:g=>r(g.target.value)})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(K,{size:"sm",variant:s===null?"default":"outline",onClick:()=>n(null),children:"All"}),i.map(g=>e.jsx(K,{size:"sm",variant:s===g?"default":"outline",onClick:()=>n(g),children:g},g))]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:c.map(g=>e.jsxs(H,{className:"hover:border-primary/50 transition-colors",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(he,{className:"text-base",children:g.name}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:g.description})]}),e.jsx(Ae,{variant:"outline",className:"ml-2",children:g.category})]})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Records:"}),e.jsxs("div",{className:"font-medium",children:[(g.records/1e3).toFixed(1),"K"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Updated:"}),e.jsx("div",{className:"font-medium",children:g.updated})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Downloads:"}),e.jsx("div",{className:"font-medium",children:g.downloads})]})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:g.formats.map(y=>e.jsx(Ae,{variant:"secondary",className:"text-xs",children:y},y))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(ma,{className:"h-3 w-3 mr-1"})," Download"]}),e.jsxs(K,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(Qae,{className:"h-3 w-3 mr-1"})," Preview"]})]})]})]},g.id))}),c.length===0&&e.jsx(H,{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"No datasets match your search"})})]}),e.jsxs(kt,{value:"api",className:"space-y-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(XE,{className:"h-5 w-5"}),"API Documentation"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"RESTful API endpoints for data access"})]}),e.jsx(X,{className:"space-y-4",children:e.jsxs("div",{className:"bg-muted p-3 rounded font-mono text-xs",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-blue-600",children:"Base URL:"})," https://api.water-mis.go.ke/v1"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-blue-600",children:"Auth:"})," Bearer token required for all endpoints"]})]})})]}),e.jsx("div",{className:"space-y-3",children:aqe.map((g,y)=>e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ae,{variant:g.method==="GET"?"default":"secondary",children:g.method}),e.jsx("code",{className:"text-sm font-mono flex-1 text-muted-foreground",children:g.path})]}),e.jsx("p",{className:"text-sm mt-2",children:g.description})]}),e.jsxs(X,{className:"space-y-2",children:[g.parameters&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Parameters:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:g.parameters.map(b=>e.jsx(Ae,{variant:"outline",className:"text-xs",children:b},b))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Example:"}),e.jsx("code",{className:"text-xs bg-muted p-2 rounded block mt-1 overflow-auto",children:g.example})]}),e.jsxs(K,{size:"sm",variant:"outline",children:[e.jsx(i9,{className:"h-3 w-3 mr-1"})," Full Docs"]})]})]},y))}),e.jsxs(H,{className:"bg-blue-50 dark:bg-blue-900/20 border-blue-200",children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm",children:"Get API Access"})}),e.jsxs(X,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Request an API key to integrate data into your applications"}),e.jsx(K,{children:"Request API Key"})]})]})]}),e.jsx(kt,{value:"stories",className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:iqe.map(g=>e.jsxs(H,{className:"hover:border-primary/50 transition-colors",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Fu,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(he,{className:"text-base",children:g.title}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:g.description})]})]})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Key Insights:"}),e.jsx("ul",{className:"space-y-1",children:g.insights.map((y,b)=>e.jsxs("li",{className:"text-xs text-muted-foreground",children:[" ",y]},b))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Related Datasets:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:g.relatedDatasets.map(y=>{const b=lg.find(w=>w.id===y);return b?e.jsx(Ae,{variant:"outline",className:"text-xs",children:b.name},y):null})})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t",children:[e.jsxs("p",{className:"text-xs text-muted-foreground",children:["By ",g.author]}),e.jsx(K,{size:"sm",variant:"ghost",children:"Read Full Story"})]})]})]},g.id))})}),e.jsx(kt,{value:"maps",className:"space-y-4",children:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(fy,{className:"h-5 w-5"}),"Interactive Public Maps"]})}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(K,{variant:"outline",className:"h-24 flex flex-col",children:[e.jsx("div",{className:"text-base font-medium",children:"Committee Locations"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"245 committees mapped"})]}),e.jsxs(K,{variant:"outline",className:"h-24 flex flex-col",children:[e.jsx("div",{className:"text-base font-medium",children:"Water Facilities"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"1,203 infrastructure points"})]}),e.jsxs(K,{variant:"outline",className:"h-24 flex flex-col",children:[e.jsx("div",{className:"text-base font-medium",children:"Service Coverage"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Population access areas"})]}),e.jsxs(K,{variant:"outline",className:"h-24 flex flex-col",children:[e.jsx("div",{className:"text-base font-medium",children:"Quality Monitoring"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Test site locations"})]})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs(K,{className:"w-full",size:"lg",children:[e.jsx(fy,{className:"h-4 w-4 mr-2"})," Open Public Maps"]})})]})]})})]})]})}const DT=[{id:"committees",name:"Committees",columns:["id","name","community","members","status","complianceScore"]},{id:"vendors",name:"Vendors",columns:["id","companyName","status","kycStatus","rating"]},{id:"grievances",name:"Grievances",columns:["id","category","severity","status","location"]},{id:"meetings",name:"Committee Meetings",columns:["id","committeeId","attendance","status","date"]}],lqe=["count","sum","avg","min","max"],cqe=["=","!=",">","<",">=","<=","contains","startswith"];function dqe(){const[t,r]=A.useState(DT[0].id),[s,n]=A.useState([]),[a,o]=A.useState(!1),[c,i]=A.useState(!1),[f,p]=A.useState(!1),[g,y]=A.useState(!1),[b,w]=A.useState("daily"),[T,N]=A.useState(""),M=A.useMemo(()=>DT.find(L=>L.id===t),[t]),O=A.useMemo(()=>t==="committees"?[{id:"1",name:"Kiambu Committee",community:"Kiambu",members:12,status:"active",complianceScore:92},{id:"2",name:"Kajiado Committee",community:"Kajiado",members:10,status:"active",complianceScore:85}]:t==="vendors"?[{id:"1",companyName:"WaterTech",status:"approved",kycStatus:"verified",rating:4.8},{id:"2",companyName:"Nairobi Supplies",status:"approved",kycStatus:"verified",rating:4.5}]:t==="grievances"?[{id:"1",category:"water-quality",severity:"high",status:"new",location:"Kilimani"},{id:"2",category:"billing",severity:"medium",status:"resolved",location:"Westlands"}]:[],[t]),C=(L,F,B)=>{const U={id:Date.now().toString(),type:L,label:F,config:B};n([...s,U])},D=L=>{n(s.filter(F=>F.id!==L))};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Dataset Builder"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Create and configure public datasets with privacy filters and transformations"})]}),e.jsxs(K,{children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"})," New Dataset"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(Bi,{className:"h-5 w-5"}),"Source Selection"]})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Select Source Table"}),e.jsxs(Nt,{value:t,onValueChange:r,children:[e.jsx(bt,{className:"mt-1",children:e.jsx(St,{})}),e.jsx(_t,{children:DT.map(L=>e.jsx(ge,{value:L.id,children:L.name},L.id))})]})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:M==null?void 0:M.columns.map(L=>e.jsx(Ae,{variant:"outline",className:"text-xs",children:L},L))})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(Gn,{className:"h-5 w-5"}),"Transformations"]})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(Qt,{open:a,onOpenChange:o,children:[e.jsx(qr,{asChild:!0,children:e.jsx(K,{size:"sm",variant:"outline",children:"+ Filter"})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Add Filter"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Column"}),e.jsxs(Nt,{children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select column"})}),e.jsx(_t,{children:M==null?void 0:M.columns.map(L=>e.jsx(ge,{value:L,children:L},L))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Operator"}),e.jsxs(Nt,{children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select operator"})}),e.jsx(_t,{children:cqe.map(L=>e.jsx(ge,{value:L,children:L},L))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Value"}),e.jsx(Ie,{placeholder:"Enter value"})]}),e.jsx(K,{className:"w-full",onClick:()=>{C("filter","Filter applied",{}),o(!1)},children:"Add Filter"})]})]})]}),e.jsxs(Qt,{open:c,onOpenChange:i,children:[e.jsx(qr,{asChild:!0,children:e.jsx(K,{size:"sm",variant:"outline",children:"+ Group By"})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Group By"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Column(s) to Group"}),e.jsxs(Nt,{children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select columns"})}),e.jsx(_t,{children:M==null?void 0:M.columns.map(L=>e.jsx(ge,{value:L,children:L},L))})]})]}),e.jsx(K,{className:"w-full",onClick:()=>{C("group","Group by applied",{}),i(!1)},children:"Apply Group"})]})]})]}),e.jsxs(Qt,{open:f,onOpenChange:p,children:[e.jsx(qr,{asChild:!0,children:e.jsx(K,{size:"sm",variant:"outline",children:"+ Aggregate"})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Add Aggregation"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Column to Aggregate"}),e.jsxs(Nt,{children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select column"})}),e.jsx(_t,{children:M==null?void 0:M.columns.map(L=>e.jsx(ge,{value:L,children:L},L))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Function"}),e.jsxs(Nt,{children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select function"})}),e.jsx(_t,{children:lqe.map(L=>e.jsx(ge,{value:L,children:L.toUpperCase()},L))})]})]}),e.jsx(K,{className:"w-full",onClick:()=>{C("aggregate","Aggregation added",{}),p(!1)},children:"Add Aggregation"})]})]})]}),e.jsxs(Qt,{open:g,onOpenChange:y,children:[e.jsx(qr,{asChild:!0,children:e.jsx(K,{size:"sm",variant:"outline",children:"+ Computed Field"})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Add Computed Field"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Field Name"}),e.jsx(Ie,{placeholder:"e.g., ComplianceRatio"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Expression"}),e.jsx(Ie,{placeholder:"e.g., complianceScore / 100",className:"font-mono text-xs"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Available: ",M==null?void 0:M.columns.join(", ")]}),e.jsx(K,{className:"w-full",onClick:()=>{C("compute","Computed field added",{}),y(!1)},children:"Add Field"})]})]})]})]}),s.length>0&&e.jsx("div",{className:"mt-4 space-y-2 border-t pt-4",children:s.map(L=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted rounded",children:[e.jsxs("div",{children:[e.jsx(Ae,{className:"text-xs",children:L.type.toUpperCase()}),e.jsx("span",{className:"text-sm ml-2",children:L.label})]}),e.jsx("button",{onClick:()=>D(L.id),className:"text-muted-foreground hover:text-foreground",children:e.jsx(Ko,{className:"h-4 w-4"})})]},L.id))})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(ka,{className:"h-5 w-5"}),"Privacy Filters"]})}),e.jsxs(X,{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(K,{variant:"outline",size:"sm",children:"Anonymize IDs"}),e.jsx(K,{variant:"outline",size:"sm",children:"Redact Names"}),e.jsx(K,{variant:"outline",size:"sm",children:"Mask Emails"}),e.jsx(K,{variant:"outline",size:"sm",children:"Aggregate Sensitive"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Applied rules will be shown here"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"h-5 w-5"}),"Refresh Schedule"]})}),e.jsx(X,{children:e.jsxs(Nt,{value:b,onValueChange:w,children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"never",children:"Never (Manual)"}),e.jsx(ge,{value:"hourly",children:"Every Hour"}),e.jsx(ge,{value:"daily",children:"Daily (Midnight)"}),e.jsx(ge,{value:"weekly",children:"Weekly (Sunday)"}),e.jsx(ge,{value:"monthly",children:"Monthly (1st)"})]})]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm",children:"Dataset Config"})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Dataset Name"}),e.jsx(Ie,{placeholder:"e.g., Committee Performance",value:T,onChange:L=>N(L.target.value),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Source"}),e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:M==null?void 0:M.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Transformations"}),e.jsxs("div",{className:"text-sm text-muted-foreground mt-1",children:[s.length," applied"]})]}),e.jsx(K,{className:"w-full",children:"Save Dataset"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[e.jsx(he,{className:"text-sm",children:"Preview"}),e.jsx(mo,{className:"h-4 w-4"})]}),e.jsx(X,{children:e.jsxs("div",{className:"text-xs space-y-2",children:[O.slice(0,3).map((L,F)=>e.jsx("div",{className:"p-2 bg-muted rounded",children:Object.entries(L).slice(0,2).map(([B,U])=>e.jsxs("div",{className:"text-xs",children:[e.jsxs("span",{className:"font-medium",children:[B,":"]})," ",U]},B))},F)),e.jsxs("p",{className:"text-muted-foreground text-xs italic",children:["+",O.length-1," more rows"]})]})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm",children:"Export"})}),e.jsxs(X,{className:"space-y-2",children:[e.jsx(K,{variant:"outline",size:"sm",className:"w-full justify-start text-xs",children:"CSV Export"}),e.jsx(K,{variant:"outline",size:"sm",className:"w-full justify-start text-xs",children:"GeoJSON Export"}),e.jsx(K,{variant:"outline",size:"sm",className:"w-full justify-start text-xs",children:"API Key"})]})]})]})]})]})}const B8=[{id:"positron",name:"Light",url:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json"},{id:"voyager",name:"Voyager",url:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json"},{id:"osm",name:"OpenStreetMap",url:"https://tiles.openfreemap.org/styles/liberty"}],uqe=[{id:"coverage",name:"Water Coverage Areas",category:"Coverage",visible:!0,color:"#22c55e",description:"Active water supply scheme coverage zones"},{id:"facilities",name:"Water Facilities",category:"Infrastructure",visible:!0,color:"#3b82f6",description:"Treatment plants, pump stations, reservoirs"},{id:"kiosks",name:"Water Kiosks",category:"Infrastructure",visible:!0,color:"#f59e0b",description:"Community water point locations"},{id:"pipelines",name:"Water Pipelines",category:"Network",visible:!0,color:"#8b5cf6",description:"Primary and secondary water distribution lines"},{id:"meters",name:"Service Connections",category:"Network",visible:!1,color:"#06b6d4",description:"Individual household/business meters"},{id:"complaints",name:"Reported Issues",category:"Community",visible:!1,color:"#ef4444",description:"Active grievances and reported problems"}];function hqe(){const[t,r]=A.useState({longitude:36.8219,latitude:-1.2921,zoom:8}),[s,n]=A.useState(B8[0].url),[a,o]=A.useState(uqe),[c,i]=A.useState(!1),[f,p]=A.useState(!1),g=A.useCallback(N=>{o(M=>M.map(O=>O.id===N?{...O,visible:!O.visible}:O))},[]),y=A.useMemo(()=>a.filter(N=>N.visible).length,[a]),b=A.useMemo(()=>Array.from(new Set(a.map(N=>N.category))),[]),w=A.useMemo(()=>{const{longitude:N,latitude:M,zoom:O}=t;return`<iframe src="${window.location.origin}${window.location.pathname}?map=${N.toFixed(3)},${M.toFixed(3)},${O}" width="100%" height="600" frameborder="0" style="border:1px solid #ccc;"></iframe>`},[t]),T=()=>{navigator.clipboard.writeText(w),p(!0),setTimeout(()=>p(!1),2e3)};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Public Interactive Maps"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Share water infrastructure, coverage, and service data through interactive maps"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Visible Layers"}),e.jsx(cv,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:y}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Of ",a.length," total"]})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Total Layers"}),e.jsx(jd,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:b.join(", ")})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Downloads"}),e.jsx(ma,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"542"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"GeoJSON/CSV exports"})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Embeds"}),e.jsx(XE,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"8"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active on websites"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs(H,{className:"overflow-hidden",children:[e.jsx(ue,{children:e.jsx(he,{children:"Interactive Map Viewer"})}),e.jsx(X,{className:"p-0",children:e.jsx("div",{className:"h-96 relative",children:e.jsxs(Pm,{initialViewState:t,onMove:N=>r(N.viewState),mapStyle:s,children:[e.jsx(km,{position:"top-right"}),e.jsx(yv,{}),e.jsx(H7,{position:"top-right"}),a.filter(N=>N.visible).map(N=>e.jsx(_u,{id:N.id+"-source",type:"geojson",data:{type:"FeatureCollection",features:[]},children:e.jsx(ni,{id:N.id+"-layer",type:"circle",paint:{"circle-color":N.color,"circle-radius":6}})},N.id))]})})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm",children:"Basemap Style"})}),e.jsx(X,{className:"space-y-2",children:B8.map(N=>e.jsx(K,{variant:s===N.url?"default":"outline",onClick:()=>n(N.url),className:"w-full justify-start text-xs",children:N.name},N.id))})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm",children:"Layer Controls"})}),e.jsx(X,{className:"space-y-3",children:b.map(N=>e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-semibold text-muted-foreground mb-2",children:N}),e.jsx("div",{className:"space-y-2",children:a.filter(M=>M.category===N).map(M=>e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(Fd,{id:M.id,checked:M.visible,onCheckedChange:()=>g(M.id),className:"mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(we,{htmlFor:M.id,className:"text-xs cursor-pointer",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:M.color}}),M.name]})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:M.description})]})]},M.id))})]},N))})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm",children:"Share & Export"})}),e.jsxs(X,{className:"space-y-2",children:[e.jsxs(Qt,{open:c,onOpenChange:i,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{variant:"outline",className:"w-full justify-start text-xs",children:[e.jsx(XE,{className:"h-3 w-3 mr-2"})," Generate Embed"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Embed Code"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Copy and paste this code to embed the map on your website:"}),e.jsx("div",{className:"bg-muted p-3 rounded font-mono text-xs overflow-auto max-h-32 break-all",children:w}),e.jsx(K,{onClick:T,className:"w-full",variant:f?"default":"outline",children:f?e.jsx(e.Fragment,{children:" Copied to clipboard"}):e.jsxs(e.Fragment,{children:[e.jsx(P_,{className:"h-3 w-3 mr-2"})," Copy Embed Code"]})})]})]})]}),e.jsxs(K,{variant:"outline",className:"w-full justify-start text-xs",children:[e.jsx(ma,{className:"h-3 w-3 mr-2"})," Download GeoJSON"]}),e.jsxs(K,{variant:"outline",className:"w-full justify-start text-xs",children:[e.jsx(ma,{className:"h-3 w-3 mr-2"})," Download CSV"]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm",children:"Legend"})}),e.jsx(X,{className:"space-y-2",children:a.map(N=>e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:N.color}}),e.jsx("span",{children:N.name})]},N.id))})]})]})]})]})}function mqe(){return e.jsxs("div",{className:"flex h-screen bg-background",children:[e.jsx(Ti,{}),e.jsx("main",{className:"flex-1 overflow-auto",children:e.jsx(Ai,{})})]})}const Us={topology:{getNodes:t=>pe.get("/core-ops/network/nodes",t),createNode:t=>pe.post("/core-ops/network/nodes",t),getEdges:t=>pe.get("/core-ops/network/edges",t),createEdge:t=>pe.post("/core-ops/network/edges",t),trace:(t,r)=>pe.post("/core-ops/network/trace",{from_node_id:t,to_node_id:r})},nrw:{getSnapshots:t=>pe.get("/core-ops/nrw/snapshots",t),createSnapshot:t=>pe.post("/core-ops/nrw/snapshots",t),calculateBalance:t=>pe.post(`/core-ops/nrw/calculate/${t}`),getInterventions:t=>pe.get("/core-ops/nrw/interventions",t),createIntervention:t=>pe.post("/core-ops/nrw/interventions",t)},dosing:{getPlans:t=>pe.get("/core-ops/dosing/plans",t),createPlan:t=>pe.post("/core-ops/dosing/plans",t),getStocks:t=>pe.get("/core-ops/dosing/stocks",t),createStock:t=>pe.post("/core-ops/dosing/stocks",t),getChangeLogs:t=>pe.get("/core-ops/dosing/change-logs",t)},scheduling:{getSchedules:t=>pe.get("/core-ops/schedule",t),create:t=>pe.post("/core-ops/schedule",t),update:(t,r)=>pe.patch(`/core-ops/schedule/${t}`,r)},operations:{getDashboard:()=>pe.get("/core-ops/dashboard"),getAlarms:()=>pe.get("/core-ops/alarms")},shifts:{list:t=>pe.get("/operations/shifts",t),create:t=>pe.post("/operations/shifts",t),get:t=>pe.get(`/operations/shifts/${t}`),update:(t,r)=>pe.patch(`/operations/shifts/${t}`,r),delete:t=>pe.delete(`/operations/shifts/${t}`),activate:t=>pe.post(`/operations/shifts/${t}/activate`,{}),close:(t,r)=>pe.post(`/operations/shifts/${t}/close`,r),getEntries:(t,r)=>pe.get(`/operations/shifts/${t}/entries`,r),addEntry:(t,r)=>pe.post(`/operations/shifts/${t}/entries`,r)},events:{list:t=>pe.get("/operations/events",t),create:t=>pe.post("/operations/events",t),get:t=>pe.get(`/operations/events/${t}`),acknowledge:(t,r)=>pe.post(`/operations/events/${t}/acknowledge`,r),resolve:(t,r)=>pe.post(`/operations/events/${t}/resolve`,r),link:(t,r)=>pe.post(`/operations/events/${t}/link`,r)},checklists:{list:t=>pe.get("/operations/checklists",t),create:t=>pe.post("/operations/checklists",t),get:t=>pe.get(`/operations/checklists/${t}`),update:(t,r)=>pe.patch(`/operations/checklists/${t}`,r),delete:t=>pe.delete(`/operations/checklists/${t}`),startRun:(t,r)=>pe.post(`/operations/checklists/${t}/start`,r),listRuns:t=>pe.get("/operations/checklist-runs",t),updateRun:(t,r)=>pe.patch(`/operations/checklist-runs/${t}`,r),completeRun:(t,r)=>pe.post(`/operations/checklist-runs/${t}/complete`,r)},playbooks:{list:t=>pe.get("/operations/playbooks",t),create:t=>pe.post("/operations/playbooks",t),get:t=>pe.get(`/operations/playbooks/${t}`),update:(t,r)=>pe.patch(`/operations/playbooks/${t}`,r),delete:t=>pe.delete(`/operations/playbooks/${t}`),findMatching:t=>pe.get("/operations/playbooks/find-matching",t)},escalationPolicies:{list:t=>pe.get("/operations/escalation-policies",t),create:t=>pe.post("/operations/escalation-policies",t),get:t=>pe.get(`/operations/escalation-policies/${t}`),update:(t,r)=>pe.patch(`/operations/escalation-policies/${t}`,r),delete:t=>pe.delete(`/operations/escalation-policies/${t}`)}};function fqe(){const[t,r]=A.useState([]),[s,n]=A.useState(!1),[a,o]=A.useState(!0),{data:c,isLoading:i,error:f}=it({queryKey:["operations-dashboard"],queryFn:()=>Us.operations.getDashboard(),refetchInterval:3e4});A.useEffect(()=>{if(!a)return;let w=null,T=null,N=0;const M=3e4,O=()=>{try{w=new EventSource("/api/v1/console/alarms",{withCredentials:!0}),w.onopen=()=>{n(!0),N=0,console.log("SSE connection established")},w.onmessage=C=>{try{const D=JSON.parse(C.data);D.tag_name&&D.severity&&D.timestamp&&r(L=>[D,...L].slice(0,20))}catch(D){console.error("Failed to parse SSE message:",D)}},w.onerror=C=>{if(n(!1),(w==null?void 0:w.readyState)===EventSource.CLOSED){console.error("SSE connection closed by server"),N++;const D=Math.min(1e3*Math.pow(2,N),M);console.log(`Attempting to reconnect in ${D}ms (attempt ${N})`),T=setTimeout(()=>{a&&(w==null?void 0:w.readyState)===EventSource.CLOSED&&O()},D)}}}catch(C){console.error("Failed to create SSE connection:",C),n(!1)}};return O(),()=>{T&&clearTimeout(T),w&&w.close(),n(!1)}},[a]);const p=w=>{switch(w){case"planned":return e.jsx(wn,{className:"h-4 w-4"});case"fault":return e.jsx(Fr,{className:"h-4 w-4"});case"power":return e.jsx(wb,{className:"h-4 w-4"});case"water_quality":return e.jsx(Si,{className:"h-4 w-4"});default:return e.jsx(Ni,{className:"h-4 w-4"})}},g=w=>{switch(w){case"live":return"destructive";case"approved":return"default";case"restored":return"secondary";default:return"outline"}},y=w=>{switch(w){case"running":return"default";case"scheduled":return"secondary";case"completed":return"outline";default:return"outline"}},b=w=>{switch(w){case"critical":return e.jsxs(Ae,{variant:"destructive",className:"gap-1",children:[e.jsx(Ta,{className:"h-3 w-3"}),"Critical"]});case"warning":return e.jsxs(Ae,{className:"bg-orange-500 gap-1",children:[e.jsx(Fr,{className:"h-3 w-3"}),"Warning"]});case"info":return e.jsxs(Ae,{variant:"outline",className:"gap-1",children:[e.jsx(bb,{className:"h-3 w-3"}),"Info"]});default:return e.jsx(Ae,{variant:"outline",children:w})}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6 bg-background",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Operations Console"}),e.jsx("p",{className:"text-muted-foreground",children:"Real-time monitoring and control center"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm",children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),e.jsx("span",{className:"text-muted-foreground",children:"Live Feed Active"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400"}),e.jsx("span",{className:"text-muted-foreground",children:"Disconnected"})]})}),e.jsxs(K,{variant:"outline",size:"sm",onClick:()=>o(!a),children:[a?e.jsx(bb,{className:"h-4 w-4 mr-2"}):e.jsx($ae,{className:"h-4 w-4 mr-2"}),a?"Disable":"Enable"," Alarms"]})]})]}),i&&!c?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading operations console..."})}):f?e.jsx(zn,{variant:"destructive",children:e.jsxs(An,{children:["Error loading operations dashboard: ",f.message]})}):e.jsxs(e.Fragment,{children:[a&&t.length>0&&e.jsxs(H,{className:"border-orange-500 bg-orange-50/50 dark:bg-orange-950/20",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(Ta,{className:"h-5 w-5 text-orange-600"}),"Live Alarms"]}),e.jsx(mr,{children:"Real-time telemetry threshold violations"})]}),e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>r([]),children:"Clear All"})]})}),e.jsx(X,{children:e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:t.map(w=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-background border",children:[e.jsx("div",{className:"mt-1",children:b(w.severity)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"font-medium text-sm truncate",children:w.tag_name}),e.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:Ur(new Date(w.timestamp),"HH:mm:ss")})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:w.message}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs",children:[w.asset_name&&e.jsxs("span",{className:"text-muted-foreground",children:["Asset: ",w.asset_name]}),w.scheme_name&&e.jsxs("span",{className:"text-muted-foreground",children:["Scheme: ",w.scheme_name]}),e.jsxs("span",{className:"font-mono",children:["Value: ",e.jsx("span",{className:"font-semibold",children:w.value})," / Threshold: ",w.threshold]})]})]})]},w.id))})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(H,{className:"bg-card text-card-foreground",children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Active Outages"}),e.jsx(Fr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(c==null?void 0:c.kpis.outages_count)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Approved or currently live"})]})]}),e.jsxs(H,{className:"bg-card text-card-foreground",children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Pump Schedules"}),e.jsx(wn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(c==null?void 0:c.kpis.schedules_count)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Next 24 hours"})]})]}),e.jsxs(H,{className:"bg-card text-card-foreground",children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Active Dosing Plans"}),e.jsx(Si,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(c==null?void 0:c.kpis.dose_plans_count)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Actively controlling dosing"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(H,{className:"bg-card text-card-foreground",children:[e.jsxs(ue,{children:[e.jsx(he,{className:"text-foreground",children:"Active Outages"}),e.jsx(mr,{children:"Current and planned water supply interruptions"})]}),e.jsx(X,{children:c!=null&&c.active_outages&&c.active_outages.length>0?e.jsx("div",{className:"space-y-4",children:c.active_outages.map(w=>{var T;return e.jsxs("div",{className:"flex items-start gap-4 p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[e.jsx("div",{className:"mt-1",children:p(w.cause)}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"font-medium text-foreground",children:[((T=w.scheme)==null?void 0:T.name)||"Unknown Scheme",w.code&&e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",w.code,")"]})]}),e.jsx(Ae,{variant:g(w.state),children:w.state})]}),w.summary&&e.jsx("p",{className:"text-sm text-muted-foreground",children:w.summary}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Start: ",Ur(new Date(w.starts_at),"PPp")]}),w.ends_at&&e.jsxs("span",{children:["End: ",Ur(new Date(w.ends_at),"PPp")]})]}),w.estimated_customers_affected&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["~",w.estimated_customers_affected.toLocaleString()," customers affected"]})]})]},w.id)})}):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No active outages"})})]}),e.jsxs(H,{className:"bg-card text-card-foreground",children:[e.jsxs(ue,{children:[e.jsx(he,{className:"text-foreground",children:"Pump Schedules"}),e.jsx(mr,{children:"Scheduled and running pump operations"})]}),e.jsx(X,{children:c!=null&&c.active_schedules&&c.active_schedules.length>0?e.jsx("div",{className:"space-y-4",children:c.active_schedules.map(w=>{var T,N,M;return e.jsxs("div",{className:"flex items-start gap-4 p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[e.jsx("div",{className:"mt-1",children:e.jsx(wb,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-medium text-foreground",children:((T=w.asset)==null?void 0:T.name)||((N=w.asset)==null?void 0:N.code)||"Unknown Asset"}),e.jsx(Ae,{variant:y(w.status),children:w.status})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:(M=w.scheme)==null?void 0:M.name}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsx("span",{children:Ur(new Date(w.start_at),"PPp")}),e.jsx("span",{children:""}),e.jsx("span",{children:Ur(new Date(w.end_at),"PPp")})]}),w.target_volume_m3&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Target: ",w.target_volume_m3.toLocaleString()," m"]})]})]},w.id)})}):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No scheduled pumping"})})]})]}),e.jsxs(H,{className:"bg-card text-card-foreground",children:[e.jsxs(ue,{children:[e.jsx(he,{className:"text-foreground",children:"Active Dosing Plans"}),e.jsx(mr,{children:"Chemical dosing control currently in effect"})]}),e.jsx(X,{children:c!=null&&c.active_dose_plans&&c.active_dose_plans.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.active_dose_plans.map(w=>{var T,N,M;return e.jsxs("div",{className:"p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Si,{className:"h-4 w-4 text-primary"}),e.jsx("div",{className:"font-medium text-foreground",children:((T=w.asset)==null?void 0:T.name)||((N=w.asset)==null?void 0:N.code)||"Unknown Asset"})]}),e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:(M=w.scheme)==null?void 0:M.name}),w.chemical&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Chemical: ",w.chemical]})]},w.id)})}):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No active dosing plans"})})]}),e.jsxs(H,{className:"bg-card text-card-foreground",children:[e.jsxs(ue,{children:[e.jsx(he,{className:"text-foreground",children:"Alarm Tags"}),e.jsx(mr,{children:"Telemetry tags with threshold monitoring enabled"})]}),e.jsx(X,{children:c!=null&&c.alarm_tags&&c.alarm_tags.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:c.alarm_tags.map(w=>{var T,N,M;return e.jsxs("div",{className:"p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-medium text-foreground",children:w.tag_name}),e.jsx(Ae,{variant:"outline",children:w.data_type})]}),e.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:((T=w.scheme)==null?void 0:T.name)||((N=w.asset)==null?void 0:N.name)||((M=w.facility)==null?void 0:M.name)}),w.unit&&e.jsxs("div",{className:"text-xs text-muted-foreground mb-1",children:["Unit: ",w.unit]}),w.thresholds&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Thresholds: ",Object.entries(w.thresholds).map(([O,C])=>`${O}: ${C}`).join(", ")]})]},w.id)})}):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No alarm tags configured"})})]})]})]})}function pqe(){const[t,r]=A.useState("nodes"),[s,n]=A.useState(""),{data:a,isLoading:o}=it({queryKey:["topology-nodes",s],queryFn:()=>Us.topology.getNodes({node_type:s||void 0,per_page:50}),enabled:t==="nodes"}),{data:c,isLoading:i}=it({queryKey:["topology-edges"],queryFn:()=>Us.topology.getEdges({per_page:50}),enabled:t==="edges"}),f=p=>({source:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",reservoir:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",treatment:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",pump_station:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",junction:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",customer:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",prv:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",valve:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300",meter:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-300"})[p]||"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";return e.jsxs("div",{className:"container mx-auto p-6 space-y-6 bg-background",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Network Topology"}),e.jsx("p",{className:"text-muted-foreground",children:"Visualize and manage water network infrastructure"})]}),e.jsxs(K,{children:[e.jsx(lie,{className:"mr-2 h-4 w-4"}),"Add Node"]})]}),e.jsxs(ss,{value:t,onValueChange:p=>r(p),children:[e.jsxs(Yr,{className:"bg-muted",children:[e.jsx(wt,{value:"nodes",children:"Nodes"}),e.jsx(wt,{value:"edges",children:"Edges"})]}),e.jsxs(kt,{value:"nodes",className:"mt-6 space-y-4",children:[e.jsxs(H,{className:"bg-card text-card-foreground",children:[e.jsx(ue,{children:e.jsx(he,{className:"text-foreground",children:"Filters"})}),e.jsx(X,{children:e.jsxs("div",{className:"flex gap-4 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Node Type"}),e.jsx(Ie,{placeholder:"Filter by type (source, reservoir, pump_station, etc.)",value:s,onChange:p=>n(p.target.value),className:"bg-background text-foreground"})]}),e.jsx(K,{variant:"outline",onClick:()=>n(""),children:"Reset"})]})})]}),o?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading network nodes..."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a==null?void 0:a.data.map(p=>e.jsxs(H,{className:"bg-card text-card-foreground hover:shadow-md transition-shadow",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(YE,{className:"h-4 w-4"}),e.jsxs("div",{children:[e.jsx(he,{className:"text-base text-foreground",children:p.name}),e.jsx(mr,{className:"mt-1",children:p.code})]})]}),e.jsx(Ae,{className:f(p.node_type),children:p.node_type.replace("_"," ")})]})}),e.jsx(X,{children:p.attributes&&Object.keys(p.attributes).length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs font-medium text-foreground",children:"Attributes"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs",children:Object.entries(p.attributes).slice(0,4).map(([g,y])=>e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-muted-foreground capitalize",children:[g,":"]}),e.jsx("span",{className:"font-medium text-foreground truncate",children:String(y)})]},g))})]})})]},p.id))}),(a==null?void 0:a.data.length)===0&&e.jsx(H,{className:"bg-card text-card-foreground",children:e.jsxs(X,{className:"flex flex-col items-center justify-center p-12",children:[e.jsx(YE,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No network nodes found"}),e.jsx(K,{children:"Add First Node"})]})})]})]}),e.jsx(kt,{value:"edges",className:"mt-6",children:i?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading network edges..."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:c==null?void 0:c.data.map(p=>e.jsxs(H,{className:"bg-card text-card-foreground hover:shadow-md transition-shadow",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(QE,{className:"h-4 w-4"}),e.jsxs("div",{children:[e.jsx(he,{className:"text-base text-foreground",children:p.code||`Edge ${String(p.id).slice(0,8)}`}),e.jsx(mr,{className:"mt-1 capitalize",children:(p.edge_type||"unknown").replace("_"," ")})]})]}),e.jsx(Ae,{variant:"outline",children:p.edge_type||"unknown"})]})}),e.jsx(X,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[p.diameter_mm&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Diameter"}),e.jsxs("div",{className:"font-medium text-foreground",children:[p.diameter_mm," mm"]})]}),p.length_m&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Length"}),e.jsxs("div",{className:"font-medium text-foreground",children:[p.length_m.toLocaleString()," m"]})]}),p.material&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Material"}),e.jsx("div",{className:"font-medium text-foreground capitalize",children:p.material})]})]})})]},p.id))}),(c==null?void 0:c.data.length)===0&&e.jsx(H,{className:"bg-card text-card-foreground",children:e.jsxs(X,{className:"flex flex-col items-center justify-center p-12",children:[e.jsx(QE,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No network edges found"}),e.jsx(K,{children:"Add First Edge"})]})})]})})]})]})}function xqe(){const[t,r]=A.useState("ranking"),[s,n]=A.useState(!1),[a,o]=A.useState(!1),c=yr(),[i,f]=A.useState({dma_id:"",as_of:Ur(new Date,"yyyy-MM-dd"),system_input_volume_m3:"",billed_authorized_m3:"",unbilled_authorized_m3:"",apparent_losses_m3:"",real_losses_m3:""}),[p,g]=A.useState({dma_id:"",type:"",date:Ur(new Date,"yyyy-MM-dd"),estimated_savings_m3d:"",realized_savings_m3d:"",cost:"",responsible:"",notes:""}),{data:y,isLoading:b}=it({queryKey:["nrw-snapshots"],queryFn:()=>Us.nrw.getSnapshots({per_page:100})}),{data:w,isLoading:T}=it({queryKey:["nrw-interventions"],queryFn:()=>Us.nrw.getInterventions({per_page:50}),enabled:t==="interventions"}),{data:N}=it({queryKey:["dmas"],queryFn:()=>vM.getAll({per_page:100})}),M=A.useMemo(()=>{if(!(y!=null&&y.data)||!(N!=null&&N.data))return[];const oe=new Map;y.data.forEach(Pe=>{var ae;const Se=Pe.dma_id;oe.has(Se)||oe.set(Se,[]),(ae=oe.get(Se))==null||ae.push(Pe)});const Ce=[];return oe.forEach((Pe,Se)=>{var Rt,Vt;const ae=Pe.sort((Ct,ur)=>new Date(ur.as_of).getTime()-new Date(Ct.as_of).getTime()),be=ae[0],de=ae[1],Ke=(be==null?void 0:be.nrw_pct)??0,He=(de==null?void 0:de.nrw_pct)??Ke;let Ve="stable";Ke>He+1?Ve="up":Ke<He-1&&(Ve="down");const Et=ae.slice(0,6).reverse().map(Ct=>({month:Ur(new Date(Ct.as_of),"MMM"),nrw:Ct.nrw_pct}));if(Et.length<6){const Ct=6-Et.length;for(let ur=0;ur<Ct;ur++){const At=Dhe(new Date,6-ur);Et.unshift({month:Ur(At,"MMM"),nrw:0})}}Ce.push({dma_id:Se,dma_name:((Rt=be==null?void 0:be.dma)==null?void 0:Rt.name)||((Vt=N==null?void 0:N.data.find(Ct=>Ct.id===Se))==null?void 0:Vt.name)||"Unknown DMA",current_nrw_pct:Ke,previous_nrw_pct:He,trend:Ve,sparkline_data:Et,total_loss_m3:(be==null?void 0:be.nrw_m3)??0})}),Ce.sort((Pe,Se)=>Se.current_nrw_pct-Pe.current_nrw_pct)},[y==null?void 0:y.data,N==null?void 0:N.data]),O=A.useMemo(()=>{var Ke,He,Ve,yt,Et;if(!((Ke=y==null?void 0:y.data)!=null&&Ke.length))return{avgNrw:0,totalLoss:0,worstDma:"-",bestDma:"-"};const oe=new Map;y.data.forEach(Rt=>{const Vt=oe.get(Rt.dma_id);(!Vt||new Date(Rt.as_of)>new Date(Vt.as_of))&&oe.set(Rt.dma_id,Rt)});const Ce=Array.from(oe.values()),Pe=Ce.reduce((Rt,Vt)=>Rt+(Vt.nrw_pct??0),0)/Ce.length,Se=Ce.reduce((Rt,Vt)=>Rt+(Vt.nrw_m3??0),0),ae=Ce.sort((Rt,Vt)=>(Vt.nrw_pct??0)-(Rt.nrw_pct??0)),be=((Ve=(He=ae[0])==null?void 0:He.dma)==null?void 0:Ve.name)||"-",de=((Et=(yt=ae[ae.length-1])==null?void 0:yt.dma)==null?void 0:Et.name)||"-";return{avgNrw:Pe,totalLoss:Se,worstDma:be,bestDma:de}},[y==null?void 0:y.data]),C=gt({mutationFn:oe=>Us.nrw.createSnapshot(oe),onSuccess:()=>{Me.success("NRW snapshot recorded successfully"),c.invalidateQueries({queryKey:["nrw-snapshots"]}),n(!1),L()},onError:oe=>{Me.error((oe==null?void 0:oe.message)||"Failed to record snapshot")}}),D=gt({mutationFn:oe=>Us.nrw.createIntervention(oe),onSuccess:()=>{Me.success("Intervention recorded successfully"),c.invalidateQueries({queryKey:["nrw-interventions"]}),o(!1),F()},onError:oe=>{Me.error((oe==null?void 0:oe.message)||"Failed to record intervention")}}),L=()=>{f({dma_id:"",as_of:Ur(new Date,"yyyy-MM-dd"),system_input_volume_m3:"",billed_authorized_m3:"",unbilled_authorized_m3:"",apparent_losses_m3:"",real_losses_m3:""})},F=()=>{g({dma_id:"",type:"",date:Ur(new Date,"yyyy-MM-dd"),estimated_savings_m3d:"",realized_savings_m3d:"",cost:"",responsible:"",notes:""})},B=()=>{const oe=parseFloat(i.system_input_volume_m3)||0,Ce=parseFloat(i.billed_authorized_m3)||0,Pe=parseFloat(i.unbilled_authorized_m3)||0,Se=parseFloat(i.apparent_losses_m3)||0,ae=parseFloat(i.real_losses_m3)||0,be=oe-Ce-Pe,de=oe>0?be/oe*100:0;C.mutate({dma_id:i.dma_id,as_of:i.as_of,system_input_volume_m3:oe,billed_authorized_m3:Ce,unbilled_authorized_m3:Pe,apparent_losses_m3:Se,real_losses_m3:ae,nrw_m3:be,nrw_pct:de})},U=()=>{D.mutate({dma_id:p.dma_id||void 0,type:p.type,date:p.date,estimated_savings_m3d:parseFloat(p.estimated_savings_m3d)||void 0,realized_savings_m3d:parseFloat(p.realized_savings_m3d)||void 0,cost:parseFloat(p.cost)||void 0,responsible:p.responsible||void 0,notes:p.notes||void 0})},te=oe=>oe<15?"text-green-600":oe<25?"text-yellow-600":oe<35?"text-orange-600":"text-red-600",Q=oe=>oe<15?"bg-green-500":oe<25?"bg-yellow-500":oe<35?"bg-orange-500":"bg-red-500",re=oe=>oe<15?"#22c55e":oe<25?"#eab308":oe<35?"#f97316":"#ef4444",Z=oe=>{switch(oe){case"leak_repair":return e.jsx(Vc,{className:"h-4 w-4"});case"meter_replacement":return e.jsx(Si,{className:"h-4 w-4"});default:return e.jsx(ci,{className:"h-4 w-4"})}},ne=[{value:"leak_repair",label:"Leak Repair"},{value:"meter_replacement",label:"Meter Replacement"},{value:"prv_tuning",label:"PRV Tuning"},{value:"sectorization",label:"Sectorization"},{value:"campaign",label:"Campaign"},{value:"other",label:"Other"}];return e.jsxs("div",{className:"container mx-auto p-6 space-y-6 bg-background",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"NRW & Water Balance"}),e.jsx("p",{className:"text-muted-foreground",children:"Non-Revenue Water monitoring and intervention tracking"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{variant:"outline",onClick:()=>o(!0),children:[e.jsx(Vc,{className:"mr-2 h-4 w-4"}),"Record Intervention"]}),e.jsxs(K,{onClick:()=>n(!0),children:[e.jsx(Si,{className:"mr-2 h-4 w-4"}),"Record Snapshot"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(H,{className:"bg-card",children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(Wl,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsxs("div",{className:`text-2xl font-bold ${te(O.avgNrw)}`,children:[O.avgNrw.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg NRW Rate"})]})]})})}),e.jsx(H,{className:"bg-card",children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(Si,{className:"h-5 w-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:O.totalLoss.toLocaleString()}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Loss (m)"})]})]})})}),e.jsx(H,{className:"bg-card",children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-500/10 rounded-lg",children:e.jsx(zs,{className:"h-5 w-5 text-red-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-foreground truncate max-w-[120px]",title:O.worstDma,children:O.worstDma}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Highest NRW"})]})]})})}),e.jsx(H,{className:"bg-card",children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(ci,{className:"h-5 w-5 text-green-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-foreground truncate max-w-[120px]",title:O.bestDma,children:O.bestDma}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Lowest NRW"})]})]})})})]}),e.jsxs(ss,{value:t,onValueChange:oe=>r(oe),children:[e.jsxs(Yr,{className:"bg-muted",children:[e.jsx(wt,{value:"ranking",children:"DMA Ranking"}),e.jsx(wt,{value:"snapshots",children:"NRW Snapshots"}),e.jsx(wt,{value:"interventions",children:"Interventions"})]}),e.jsx(kt,{value:"ranking",className:"mt-6",children:e.jsxs(H,{className:"bg-card",children:[e.jsxs(ue,{children:[e.jsx(he,{className:"text-foreground",children:"DMA Performance Ranking"}),e.jsx(mr,{children:"DMAs ranked by NRW percentage with 6-month trend sparklines"})]}),e.jsx(X,{children:b?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(as,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):M.length>0?e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{className:"w-12",children:"#"}),e.jsx(se,{children:"DMA Name"}),e.jsx(se,{className:"text-right",children:"Current NRW"}),e.jsx(se,{className:"text-center",children:"Trend"}),e.jsx(se,{className:"w-40",children:"6-Month Trend"}),e.jsx(se,{className:"text-right",children:"Total Loss (m)"})]})}),e.jsx(lr,{children:M.map((oe,Ce)=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:Ce+1}),e.jsx(J,{className:"font-medium",children:oe.dma_name}),e.jsx(J,{className:"text-right",children:e.jsxs(Ae,{className:`${Q(oe.current_nrw_pct)} text-white`,children:[oe.current_nrw_pct.toFixed(1),"%"]})}),e.jsxs(J,{className:"text-center",children:[oe.trend==="up"&&e.jsxs("div",{className:"flex items-center justify-center text-red-500",children:[e.jsx(zs,{className:"h-4 w-4"}),e.jsxs("span",{className:"text-xs ml-1",children:["+",(oe.current_nrw_pct-oe.previous_nrw_pct).toFixed(1)]})]}),oe.trend==="down"&&e.jsxs("div",{className:"flex items-center justify-center text-green-500",children:[e.jsx(ci,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs ml-1",children:(oe.current_nrw_pct-oe.previous_nrw_pct).toFixed(1)})]}),oe.trend==="stable"&&e.jsx("span",{className:"text-muted-foreground text-xs",children:"Stable"})]}),e.jsx(J,{children:e.jsx("div",{className:"h-8 w-full",children:e.jsx(Ha,{width:"100%",height:"100%",children:e.jsxs(Km,{data:oe.sparkline_data,children:[e.jsx(_n,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"6px",fontSize:"12px"},formatter:Pe=>[`${Pe.toFixed(1)}%`,"NRW"]}),e.jsx(ui,{type:"monotone",dataKey:"nrw",stroke:re(oe.current_nrw_pct),strokeWidth:2,dot:!1})]})})})}),e.jsx(J,{className:"text-right font-medium",children:oe.total_loss_m3.toLocaleString()})]},oe.dma_id))})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Wl,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No NRW data available"}),e.jsxs(K,{onClick:()=>n(!0),children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Record First Snapshot"]})]})})]})}),e.jsx(kt,{value:"snapshots",className:"mt-6",children:b?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(as,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:y==null?void 0:y.data.map(oe=>{var Ce;return e.jsxs(H,{className:"bg-card text-card-foreground hover:shadow-md transition-shadow",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(he,{className:"text-base text-foreground",children:((Ce=oe.dma)==null?void 0:Ce.name)||"Unknown DMA"}),e.jsx(mr,{children:Ur(new Date(oe.as_of),"PPP")})]}),e.jsxs("div",{className:`text-2xl font-bold ${te(oe.nrw_pct??0)}`,children:[(oe.nrw_pct??0).toFixed(1),"%"]})]})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"System Input"}),e.jsxs("div",{className:"font-medium text-foreground",children:[(oe.system_input_volume_m3??0).toLocaleString()," m"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"NRW Volume"}),e.jsxs("div",{className:"font-medium text-foreground",children:[(oe.nrw_m3??0).toLocaleString()," m"]})]})]}),e.jsxs("div",{className:"pt-3 border-t space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Billed Authorized:"}),e.jsxs("span",{className:"font-medium text-foreground",children:[(oe.billed_authorized_m3??0).toLocaleString()," m"]})]}),oe.unbilled_authorized_m3&&oe.unbilled_authorized_m3>0&&e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Unbilled Authorized:"}),e.jsxs("span",{className:"font-medium text-foreground",children:[oe.unbilled_authorized_m3.toLocaleString()," m"]})]}),oe.apparent_losses_m3&&oe.apparent_losses_m3>0&&e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Apparent Losses:"}),e.jsxs("span",{className:"font-medium text-foreground",children:[oe.apparent_losses_m3.toLocaleString()," m"]})]}),oe.real_losses_m3&&oe.real_losses_m3>0&&e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Real Losses:"}),e.jsxs("span",{className:"font-medium text-foreground",children:[oe.real_losses_m3.toLocaleString()," m"]})]})]})]})]},oe.id)})}),(!(y!=null&&y.data)||y.data.length===0)&&e.jsx(H,{className:"bg-card text-card-foreground",children:e.jsxs(X,{className:"flex flex-col items-center justify-center p-12",children:[e.jsx(Si,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No NRW snapshots recorded"}),e.jsxs(K,{onClick:()=>n(!0),children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Record First Snapshot"]})]})})]})}),e.jsx(kt,{value:"interventions",className:"mt-6",children:T?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(as,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:w==null?void 0:w.data.map(oe=>{var Ce,Pe;return e.jsxs(H,{className:"bg-card text-card-foreground hover:shadow-md transition-shadow",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[Z(oe.type),e.jsxs("div",{children:[e.jsx(he,{className:"text-base text-foreground capitalize",children:oe.type.replace("_"," ")}),e.jsx(mr,{children:((Ce=oe.dma)==null?void 0:Ce.name)||((Pe=oe.asset)==null?void 0:Pe.name)||"General"})]})]}),e.jsx(Ae,{variant:"outline",children:Ur(new Date(oe.date),"PP")})]})}),e.jsxs(X,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[oe.estimated_savings_m3d&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ci,{className:"h-4 w-4 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Est. Savings"}),e.jsxs("div",{className:"font-medium text-foreground",children:[oe.estimated_savings_m3d.toLocaleString()," m/day"]})]})]}),oe.cost&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ga,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Cost"}),e.jsxs("div",{className:"font-medium text-foreground",children:["KES ",oe.cost.toLocaleString()]})]})]}),oe.responsible&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Responsible"}),e.jsx("div",{className:"font-medium text-foreground",children:oe.responsible})]})]}),oe.notes&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsx("div",{className:"text-xs text-muted-foreground",children:oe.notes})})]})]},oe.id)})}),(!(w!=null&&w.data)||w.data.length===0)&&e.jsx(H,{className:"bg-card text-card-foreground",children:e.jsxs(X,{className:"flex flex-col items-center justify-center p-12",children:[e.jsx(Vc,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No interventions recorded"}),e.jsxs(K,{onClick:()=>o(!0),children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Record First Intervention"]})]})})]})})]}),e.jsx(Qt,{open:s,onOpenChange:n,children:e.jsxs(Zt,{className:"sm:max-w-[500px]",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Record NRW Snapshot"}),e.jsx(Es,{children:"Enter water balance data for a DMA. NRW percentage will be calculated automatically."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"dma",children:"DMA Zone *"}),e.jsxs(Nt,{value:i.dma_id,onValueChange:oe=>f({...i,dma_id:oe}),children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select DMA"})}),e.jsx(_t,{children:N==null?void 0:N.data.map(oe=>e.jsx(ge,{value:oe.id,children:oe.name},oe.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"as_of",children:"Date *"}),e.jsx(Ie,{id:"as_of",type:"date",value:i.as_of,onChange:oe=>f({...i,as_of:oe.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"system_input",children:"System Input Volume (m) *"}),e.jsx(Ie,{id:"system_input",type:"number",placeholder:"e.g., 10000",value:i.system_input_volume_m3,onChange:oe=>f({...i,system_input_volume_m3:oe.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"billed_auth",children:"Billed Authorized (m) *"}),e.jsx(Ie,{id:"billed_auth",type:"number",placeholder:"e.g., 7500",value:i.billed_authorized_m3,onChange:oe=>f({...i,billed_authorized_m3:oe.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"unbilled_auth",children:"Unbilled Authorized (m)"}),e.jsx(Ie,{id:"unbilled_auth",type:"number",placeholder:"e.g., 200",value:i.unbilled_authorized_m3,onChange:oe=>f({...i,unbilled_authorized_m3:oe.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"apparent_losses",children:"Apparent Losses (m)"}),e.jsx(Ie,{id:"apparent_losses",type:"number",placeholder:"e.g., 500",value:i.apparent_losses_m3,onChange:oe=>f({...i,apparent_losses_m3:oe.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"real_losses",children:"Real Losses (m)"}),e.jsx(Ie,{id:"real_losses",type:"number",placeholder:"e.g., 1800",value:i.real_losses_m3,onChange:oe=>f({...i,real_losses_m3:oe.target.value})})]})]}),i.system_input_volume_m3&&i.billed_authorized_m3&&e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Calculated NRW:"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"font-medium",children:[(parseFloat(i.system_input_volume_m3||"0")-parseFloat(i.billed_authorized_m3||"0")-parseFloat(i.unbilled_authorized_m3||"0")).toLocaleString()," m"]}),e.jsxs("span",{className:`text-xl font-bold ${te((parseFloat(i.system_input_volume_m3||"0")-parseFloat(i.billed_authorized_m3||"0")-parseFloat(i.unbilled_authorized_m3||"0"))/parseFloat(i.system_input_volume_m3||"1")*100)}`,children:[((parseFloat(i.system_input_volume_m3||"0")-parseFloat(i.billed_authorized_m3||"0")-parseFloat(i.unbilled_authorized_m3||"0"))/parseFloat(i.system_input_volume_m3||"1")*100).toFixed(1),"%"]})]})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsxs(K,{onClick:B,disabled:!i.dma_id||!i.system_input_volume_m3||!i.billed_authorized_m3||C.isPending,children:[C.isPending&&e.jsx(as,{className:"mr-2 h-4 w-4 animate-spin"}),"Record Snapshot"]})]})]})}),e.jsx(Qt,{open:a,onOpenChange:o,children:e.jsxs(Zt,{className:"sm:max-w-[500px]",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Record Intervention"}),e.jsx(Es,{children:"Document an NRW reduction intervention such as leak repairs or meter replacements."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"intervention_type",children:"Intervention Type *"}),e.jsxs(Nt,{value:p.type,onValueChange:oe=>g({...p,type:oe}),children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select type"})}),e.jsx(_t,{children:ne.map(oe=>e.jsx(ge,{value:oe.value,children:oe.label},oe.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"intervention_date",children:"Date *"}),e.jsx(Ie,{id:"intervention_date",type:"date",value:p.date,onChange:oe=>g({...p,date:oe.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"intervention_dma",children:"DMA Zone (Optional)"}),e.jsxs(Nt,{value:p.dma_id,onValueChange:oe=>g({...p,dma_id:oe}),children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select DMA (optional)"})}),e.jsx(_t,{children:N==null?void 0:N.data.map(oe=>e.jsx(ge,{value:oe.id,children:oe.name},oe.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"estimated_savings",children:"Est. Savings (m/day)"}),e.jsx(Ie,{id:"estimated_savings",type:"number",placeholder:"e.g., 50",value:p.estimated_savings_m3d,onChange:oe=>g({...p,estimated_savings_m3d:oe.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"realized_savings",children:"Realized Savings (m/day)"}),e.jsx(Ie,{id:"realized_savings",type:"number",placeholder:"e.g., 45",value:p.realized_savings_m3d,onChange:oe=>g({...p,realized_savings_m3d:oe.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"cost",children:"Cost (KES)"}),e.jsx(Ie,{id:"cost",type:"number",placeholder:"e.g., 50000",value:p.cost,onChange:oe=>g({...p,cost:oe.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"responsible",children:"Responsible Party"}),e.jsx(Ie,{id:"responsible",type:"text",placeholder:"e.g., Operations Team",value:p.responsible,onChange:oe=>g({...p,responsible:oe.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"notes",children:"Notes"}),e.jsx(ws,{id:"notes",placeholder:"Additional details about the intervention...",value:p.notes,onChange:oe=>g({...p,notes:oe.target.value})})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsxs(K,{onClick:U,disabled:!p.type||D.isPending,children:[D.isPending&&e.jsx(as,{className:"mr-2 h-4 w-4 animate-spin"}),"Record Intervention"]})]})]})})]})}function gqe(){var M,O,C,D;const[t,r]=A.useState("plans"),[s,n]=A.useState(!1),[a,o]=A.useState({chemical:"chlorine",qty_on_hand_kg:"",reorder_level_kg:""}),{data:c,isLoading:i}=it({queryKey:["dose-plans"],queryFn:()=>Us.dosing.getPlans({per_page:50}),enabled:t==="plans"}),{data:f,isLoading:p}=it({queryKey:["chemical-stocks"],queryFn:()=>Us.dosing.getStocks({per_page:50}),enabled:t==="stocks"}),{data:g,isLoading:y}=it({queryKey:["dose-change-logs"],queryFn:()=>Us.dosing.getChangeLogs({per_page:50}),enabled:t==="changelog"}),b=L=>L.reorder_level_kg&&(L.qty_on_hand_kg??0)<=L.reorder_level_kg,w=L=>{if(!L.reorder_level_kg)return 100;const F=L.qty_on_hand_kg??0,B=L.reorder_level_kg;return Math.min(100,Math.round(F/(B*2)*100))},T=L=>{if(!L)return null;const F=Array.isArray(L)?L:Object.values(L);return F.length===0?null:e.jsxs("div",{className:"mt-3 pt-3 border-t",children:[e.jsx("div",{className:"text-xs font-medium text-foreground mb-2",children:"Flow Bands"}),e.jsx("div",{className:"space-y-1",children:F.map((B,U)=>e.jsxs("div",{className:"flex items-center justify-between text-xs bg-muted/50 rounded px-2 py-1",children:[e.jsxs("span",{className:"text-muted-foreground",children:[B.min_lps??0," - ",B.max_lps??""," L/s"]}),e.jsxs("span",{className:"font-medium text-primary",children:[B.target_mg_l??0," mg/L"]})]},U))})]})},N=L=>{var re,Z;const F=Object.keys(L.before||{}),B=Object.keys(L.after||{}),U=F[0]||B[0]||"unknown",te=((re=L.before)==null?void 0:re[U])??"-",Q=((Z=L.after)==null?void 0:Z[U])??"-";return{field:U,beforeVal:te,afterVal:Q}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6 bg-background",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Dosing Control"}),e.jsx("p",{className:"text-muted-foreground",children:"Chemical dosing plans and stock management"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Qt,{open:s,onOpenChange:n,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{variant:"outline",children:[e.jsx(zo,{className:"mr-2 h-4 w-4"}),"Record Stock"]})}),e.jsxs(Zt,{children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Record Chemical Stock"}),e.jsx(Es,{children:"Update the current stock level for a chemical"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Chemical"}),e.jsxs(Nt,{value:a.chemical,onValueChange:L=>o({...a,chemical:L}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"chlorine",children:"Chlorine"}),e.jsx(ge,{value:"sodium_hypochlorite",children:"Sodium Hypochlorite"}),e.jsx(ge,{value:"alum",children:"Alum (Aluminum Sulfate)"}),e.jsx(ge,{value:"pac",children:"PAC (Poly Aluminum Chloride)"}),e.jsx(ge,{value:"lime",children:"Lime (Calcium Hydroxide)"}),e.jsx(ge,{value:"fluoride",children:"Fluoride"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Quantity on Hand (kg)"}),e.jsx(Ie,{type:"number",placeholder:"Enter quantity",value:a.qty_on_hand_kg,onChange:L=>o({...a,qty_on_hand_kg:L.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Reorder Level (kg)"}),e.jsx(Ie,{type:"number",placeholder:"Enter reorder threshold",value:a.reorder_level_kg,onChange:L=>o({...a,reorder_level_kg:L.target.value})})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsx(K,{onClick:()=>{n(!1),o({chemical:"chlorine",qty_on_hand_kg:"",reorder_level_kg:""})},children:"Save Stock Record"})]})]})]}),e.jsxs(K,{children:[e.jsx(Si,{className:"mr-2 h-4 w-4"}),"Create Dose Plan"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(H,{className:"bg-card",children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(l9,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:((M=c==null?void 0:c.data)==null?void 0:M.length)??0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Active Dose Plans"})]})]})})}),e.jsx(H,{className:"bg-card",children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(zo,{className:"h-5 w-5 text-green-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:((O=f==null?void 0:f.data)==null?void 0:O.length)??0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Stock Records"})]})]})})}),e.jsx(H,{className:"bg-card",children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-500/10 rounded-lg",children:e.jsx(Fr,{className:"h-5 w-5 text-red-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:((C=f==null?void 0:f.data)==null?void 0:C.filter(L=>b(L)).length)??0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Low Stock Alerts"})]})]})})}),e.jsx(H,{className:"bg-card",children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(eM,{className:"h-5 w-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:((D=g==null?void 0:g.data)==null?void 0:D.length)??0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Recent Changes"})]})]})})})]}),e.jsxs(ss,{value:t,onValueChange:L=>r(L),children:[e.jsxs(Yr,{className:"bg-muted",children:[e.jsx(wt,{value:"plans",children:"Dosing Plans"}),e.jsx(wt,{value:"stocks",children:"Chemical Stock"}),e.jsx(wt,{value:"changelog",children:"Change Log"})]}),e.jsx(kt,{value:"plans",className:"mt-6",children:i?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading dosing plans..."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c==null?void 0:c.data.map(L=>{var F,B,U;return e.jsxs(H,{className:`bg-card text-card-foreground ${L.active?"":"opacity-60"}`,children:[e.jsxs(ue,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Si,{className:"h-4 w-4 text-primary"}),e.jsx(he,{className:"text-base text-foreground",children:((F=L.asset)==null?void 0:F.name)||((B=L.asset)==null?void 0:B.code)||"Unknown Asset"})]}),e.jsx(Ae,{variant:L.active?"default":"secondary",children:L.active?"Active":"Inactive"})]}),e.jsx(mr,{children:(U=L.scheme)==null?void 0:U.name})]}),e.jsxs(X,{className:"space-y-3",children:[L.chemical&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Chemical:"}),e.jsx("span",{className:"font-medium text-foreground capitalize",children:L.chemical.replace("_"," ")})]}),T(L.flow_bands),L.thresholds&&e.jsxs("div",{className:"mt-3 pt-3 border-t",children:[e.jsx("div",{className:"text-xs font-medium text-foreground mb-2",children:"Residual Thresholds"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[L.thresholds.low_alarm&&e.jsxs("div",{className:"bg-yellow-500/10 rounded px-2 py-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Low: "}),e.jsxs("span",{className:"font-medium text-yellow-600",children:[L.thresholds.low_alarm," mg/L"]})]}),L.thresholds.high_alarm&&e.jsxs("div",{className:"bg-red-500/10 rounded px-2 py-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"High: "}),e.jsxs("span",{className:"font-medium text-red-600",children:[L.thresholds.high_alarm," mg/L"]})]})]})]})]})]},L.id)})}),(!(c!=null&&c.data)||c.data.length===0)&&e.jsx(H,{className:"bg-card text-card-foreground",children:e.jsxs(X,{className:"flex flex-col items-center justify-center p-12",children:[e.jsx(Si,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No dosing plans configured"}),e.jsx(K,{children:"Create First Dosing Plan"})]})})]})}),e.jsx(kt,{value:"stocks",className:"mt-6",children:p?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading chemical stock..."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:f==null?void 0:f.data.map(L=>{var F,B;return e.jsxs(H,{className:"bg-card text-card-foreground",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(zo,{className:"h-4 w-4"}),e.jsxs("div",{children:[e.jsx(he,{className:"text-base text-foreground capitalize",children:(L.chemical||"Unknown").replace("_"," ")}),e.jsxs(mr,{children:[(F=L.scheme)==null?void 0:F.name,((B=L.facility)==null?void 0:B.name)&&` - ${L.facility.name}`]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[b(L)&&e.jsxs(Ae,{variant:"destructive",className:"animate-pulse",children:[e.jsx(Fr,{className:"h-3 w-3 mr-1"}),"Low Stock"]}),L.as_of&&e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"As of"}),e.jsx("div",{className:"text-sm font-medium text-foreground",children:Ur(new Date(L.as_of),"PP")})]})]})]})}),e.jsxs(X,{children:[b(L)&&e.jsxs(zn,{variant:"destructive",className:"mb-4",children:[e.jsx(Fr,{className:"h-4 w-4"}),e.jsx(An,{children:"Stock level is at or below reorder point. Please reorder immediately."})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Quantity on Hand"}),e.jsxs("div",{className:`text-2xl font-bold ${b(L)?"text-red-600":"text-foreground"}`,children:[(L.qty_on_hand_kg??0).toLocaleString()," kg"]})]}),L.reorder_level_kg!=null&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Reorder Level"}),e.jsxs("div",{className:"text-2xl font-bold text-muted-foreground",children:[(L.reorder_level_kg??0).toLocaleString()," kg"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Stock Level"}),e.jsx("div",{className:"w-full bg-muted rounded-full h-3 mt-2",children:e.jsx("div",{className:`h-3 rounded-full transition-all ${w(L)<25?"bg-red-500":w(L)<50?"bg-yellow-500":"bg-green-500"}`,style:{width:`${w(L)}%`}})})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(K,{size:"sm",variant:"outline",children:[e.jsx(Mt,{className:"h-4 w-4 mr-1"}),"Update Stock"]})})]})]})]},L.id)})}),(!(f!=null&&f.data)||f.data.length===0)&&e.jsx(H,{className:"bg-card text-card-foreground",children:e.jsxs(X,{className:"flex flex-col items-center justify-center p-12",children:[e.jsx(zo,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No chemical stock records"}),e.jsx(K,{onClick:()=>n(!0),children:"Record Stock Level"})]})})]})}),e.jsx(kt,{value:"changelog",className:"mt-6",children:y?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading change logs..."})}):e.jsxs(H,{className:"bg-card",children:[e.jsxs(ue,{children:[e.jsx(he,{className:"text-foreground",children:"Dose Change Log"}),e.jsx(mr,{children:"History of dosing parameter changes with before/after values"})]}),e.jsx(X,{children:g!=null&&g.data&&g.data.length>0?e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Date/Time"}),e.jsx(se,{children:"Plan / Asset"}),e.jsx(se,{children:"Field Changed"}),e.jsx(se,{children:"Before  After"}),e.jsx(se,{children:"Changed By"}),e.jsx(se,{children:"Reason"})]})}),e.jsx(lr,{children:g.data.map(L=>{var te,Q,re,Z,ne,oe;const{field:F,beforeVal:B,afterVal:U}=N(L);return e.jsxs(Qe,{children:[e.jsx(J,{className:"text-sm",children:Ur(new Date(L.created_at),"PP p")}),e.jsx(J,{className:"font-medium",children:((Q=(te=L.dose_plan)==null?void 0:te.asset)==null?void 0:Q.name)||((Z=(re=L.dose_plan)==null?void 0:re.asset)==null?void 0:Z.code)||"Unknown"}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",className:"capitalize",children:F.replace(/_/g," ")})}),e.jsx(J,{children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-red-600 line-through",children:String(B)}),e.jsx(qf,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-green-600 font-medium",children:String(U)})]})}),e.jsx(J,{className:"text-sm text-muted-foreground",children:((ne=L.user)==null?void 0:ne.name)||((oe=L.user)==null?void 0:oe.email)||"System"}),e.jsx(J,{className:"text-sm text-muted-foreground max-w-[200px] truncate",children:L.reason||"-"})]},L.id)})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(eM,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"No change logs recorded yet"})]})})]})})]})]})}function yqe(){const[t,r]=A.useState("calendar"),[s,n]=A.useState("all"),[a,o]=A.useState(Cp(new Date,{weekStartsOn:1})),[c,i]=A.useState(!1),[f,p]=A.useState(Ur(new Date,"yyyy-MM-dd")),[g,y]=A.useState(Ur(W0(new Date,7),"yyyy-MM-dd")),[b,w]=A.useState(null),T=yr(),{data:N,isLoading:M,error:O}=it({queryKey:["pump-schedules",s],queryFn:()=>Us.scheduling.getSchedules({status:s!=="all"?s:void 0,per_page:100})}),C=gt({mutationFn:async Q=>{const re=await fetch("/api/v1/pump-schedules/optimize",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(Q)});return re.ok?re.json():{schedules:vqe(Q.start_date,Q.end_date),estimated_savings:1250.5,peak_hours_avoided:18}},onSuccess:Q=>{w(Q),Me.success(`Optimization complete! Estimated savings: $${Q.estimated_savings.toFixed(2)}`)},onError:()=>{Me.error("Optimization failed")}}),D=gt({mutationFn:async()=>{if(!b)return;const Q=await fetch("/api/v1/pump-schedules/batch",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({schedules:b.schedules})});if(!Q.ok)throw new Error("Failed to apply schedules");return Q.json()},onSuccess:()=>{T.invalidateQueries({queryKey:["pump-schedules"]}),i(!1),w(null),Me.success("Optimized schedules applied successfully")},onError:()=>{Me.error("Failed to apply optimized schedules")}}),L=yue({start:a,end:jue(a,{weekStartsOn:1})}),F=Q=>{switch(Q){case"running":return"default";case"scheduled":return"secondary";case"completed":return"outline";case"cancelled":return"destructive";default:return"outline"}},B=Q=>Q?e.jsx(Ae,{variant:Q==="optimizer"?"default":"outline",className:"text-xs",children:Q==="optimizer"?e.jsxs(e.Fragment,{children:[e.jsx(Ta,{className:"h-3 w-3 mr-1"}),"Optimized"]}):"Manual"}):null,U=Q=>N!=null&&N.data?N.data.filter(re=>{const Z=jy(hd(re.start_at));return y5(Z,jy(Q))}):[],te=()=>{C.mutate({start_date:f,end_date:g})};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Pump Scheduling"}),e.jsx("p",{className:"text-muted-foreground",children:"Optimize and manage pump operations to minimize energy costs"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Qt,{open:c,onOpenChange:i,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{children:[e.jsx(Ta,{className:"mr-2 h-4 w-4"}),"Optimize Schedule"]})}),e.jsxs(Zt,{className:"sm:max-w-[500px]",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Optimize Pump Schedule"}),e.jsx(Es,{children:"Generate an optimized pumping schedule to minimize peak tariff usage while maintaining storage constraints"})]}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{children:[e.jsx(we,{children:"Start Date"}),e.jsx(Ie,{type:"date",value:f,onChange:Q=>p(Q.target.value)})]}),e.jsxs("div",{children:[e.jsx(we,{children:"End Date"}),e.jsx(Ie,{type:"date",value:g,onChange:Q=>y(Q.target.value)})]}),e.jsx(K,{onClick:te,className:"w-full",disabled:C.isPending,children:C.isPending?"Optimizing...":"Run Optimization"}),b&&e.jsxs(H,{className:"border-green-500 bg-green-50 dark:bg-green-950/20",children:[e.jsx(ue,{className:"pb-3",children:e.jsx(he,{className:"text-base",children:"Optimization Results"})}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Estimated Savings"}),e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",b.estimated_savings.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Peak Hours Avoided"}),e.jsxs("div",{className:"text-2xl font-bold",children:[b.peak_hours_avoided,"h"]})]})]}),e.jsxs("div",{className:"border-t pt-3",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Proposed Schedule Blocks"}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:b.schedules.map((Q,re)=>{var Z;return e.jsxs("div",{className:"text-xs p-2 rounded bg-background border",children:[e.jsx("div",{className:"font-medium",children:((Z=Q.asset)==null?void 0:Z.name)||"Pump"}),e.jsxs("div",{className:"text-muted-foreground",children:[Ur(hd(Q.start_at),"MMM d, HH:mm"),"  ",Ur(hd(Q.end_at),"HH:mm")]})]},re)})})]}),e.jsx(K,{onClick:()=>D.mutate(),className:"w-full",disabled:D.isPending,children:D.isPending?"Applying...":"Apply Optimization"})]})]})]})]})]}),e.jsxs(K,{variant:"outline",children:[e.jsx(wn,{className:"mr-2 h-4 w-4"}),"Create Schedule"]})]})]}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex gap-4 items-end",children:[e.jsxs("div",{className:"w-48",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Status Filter"}),e.jsxs(Nt,{value:s,onValueChange:n,children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Schedules"}),e.jsx(ge,{value:"scheduled",children:"Scheduled"}),e.jsx(ge,{value:"running",children:"Running"}),e.jsx(ge,{value:"completed",children:"Completed"}),e.jsx(ge,{value:"cancelled",children:"Cancelled"})]})]})]}),e.jsxs("div",{className:"flex gap-2 ml-auto",children:[e.jsxs(K,{variant:t==="calendar"?"default":"outline",size:"sm",onClick:()=>r("calendar"),children:[e.jsx(wn,{className:"h-4 w-4 mr-2"}),"Calendar"]}),e.jsxs(K,{variant:t==="list"?"default":"outline",size:"sm",onClick:()=>r("list"),children:[e.jsx(aie,{className:"h-4 w-4 mr-2"}),"List"]})]})]})})}),M&&!N?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading pump schedules..."})}):O?e.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:e.jsxs("p",{className:"text-lg text-destructive",children:["Error loading schedules: ",O.message]})}):t==="calendar"?e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(he,{children:"Week View"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{variant:"outline",size:"sm",onClick:()=>o(W0(a,-7)),children:"Previous Week"}),e.jsx(K,{variant:"outline",size:"sm",onClick:()=>o(Cp(new Date,{weekStartsOn:1})),children:"This Week"}),e.jsx(K,{variant:"outline",size:"sm",onClick:()=>o(W0(a,7)),children:"Next Week"})]})]})}),e.jsx(X,{children:e.jsx("div",{className:"grid grid-cols-7 gap-2",children:L.map(Q=>{const re=U(Q),Z=y5(Q,new Date);return e.jsxs("div",{className:`min-h-48 border rounded-lg p-2 ${Z?"border-primary bg-primary/5":"bg-card"}`,children:[e.jsxs("div",{className:"text-sm font-medium mb-2",children:[e.jsx("div",{children:Ur(Q,"EEE")}),e.jsx("div",{className:`text-2xl ${Z?"text-primary":""}`,children:Ur(Q,"d")})]}),e.jsx("div",{className:"space-y-1",children:re.map(ne=>{var oe;return e.jsxs("div",{className:`text-xs p-2 rounded cursor-pointer transition-colors ${ne.status==="running"?"bg-green-100 dark:bg-green-950 border border-green-500":"bg-blue-50 dark:bg-blue-950/30 border"}`,children:[e.jsx("div",{className:"font-medium truncate",children:((oe=ne.asset)==null?void 0:oe.name)||"Pump"}),e.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[e.jsx($s,{className:"h-3 w-3"}),Ur(hd(ne.start_at),"HH:mm")," - ",Ur(hd(ne.end_at),"HH:mm")]}),ne.source==="optimizer"&&e.jsxs("div",{className:"flex items-center gap-1 text-green-600 dark:text-green-400 mt-1",children:[e.jsx(Ta,{className:"h-3 w-3"}),e.jsx("span",{children:"Optimized"})]})]},ne.id)})})]},Q.toString())})})})]}):e.jsxs("div",{className:"space-y-4",children:[N==null?void 0:N.data.map(Q=>{var re,Z,ne;return e.jsxs(H,{className:"hover:shadow-md transition-shadow",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(wb,{className:"h-4 w-4"}),e.jsxs("div",{children:[e.jsx(he,{className:"text-base",children:((re=Q.asset)==null?void 0:re.name)||((Z=Q.asset)==null?void 0:Z.code)||"Unknown Pump"}),e.jsx(mr,{children:(ne=Q.scheme)==null?void 0:ne.name})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ae,{variant:F(Q.status),className:"capitalize",children:Q.status}),B(Q.source)]})]})}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Start Time"}),e.jsx("div",{className:"font-medium",children:Ur(hd(Q.start_at),"PPp")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"End Time"}),e.jsx("div",{className:"font-medium",children:Ur(hd(Q.end_at),"PPp")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t",children:[Q.target_volume_m3&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(zs,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Target Volume"}),e.jsxs("div",{className:"font-medium",children:[Q.target_volume_m3.toLocaleString()," m"]})]})]}),Q.actual_volume_m3&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(zs,{className:"h-4 w-4 text-primary"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Actual Volume"}),e.jsxs("div",{className:"font-medium",children:[Q.actual_volume_m3.toLocaleString()," m"]})]})]}),Q.energy_cost&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ga,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Energy Cost"}),e.jsxs("div",{className:"font-medium",children:["$",Q.energy_cost.toLocaleString()]})]})]})]}),Q.constraints&&Object.keys(Q.constraints).length>0&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("div",{className:"text-xs font-medium mb-2",children:"Constraints"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[Object.keys(Q.constraints).length," constraint(s) applied"]})]})]})]},Q.id)}),(N==null?void 0:N.data.length)===0&&e.jsx(H,{children:e.jsxs(X,{className:"flex flex-col items-center justify-center p-12",children:[e.jsx(wb,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No pump schedules found"}),e.jsxs(K,{children:[e.jsx(wn,{className:"mr-2 h-4 w-4"}),"Create First Schedule"]})]})})]})]})}function vqe(t,r){const s=hd(t),n=[];for(let a=0;a<5;a++){const o=W0(s,a);n.push({id:`opt-${a}`,asset:{name:`Pump ${a+1}`,code:`PMP-00${a+1}`},scheme:{name:"Central Treatment Plant"},start_at:`${Ur(o,"yyyy-MM-dd")}T02:00:00Z`,end_at:`${Ur(o,"yyyy-MM-dd")}T06:00:00Z`,status:"scheduled",source:"optimizer",target_volume_m3:5e3,constraints:{max_storage:1e4}})}return n}function jqe(){const[t,r]=A.useState("targets"),[s,n]=A.useState(""),[a,o]=A.useState("15"),[c,i]=A.useState("40"),[f,p]=A.useState("25"),[g,y]=A.useState(!1),[b,w]=A.useState(null),[T,N]=A.useState([.6]),M=yr(),{data:O}=it({queryKey:["dmas"],queryFn:async()=>{const Se=await fetch("/api/v1/dmas?per_page=100",{credentials:"include"});if(!Se.ok)throw new Error("Failed to fetch DMAs");return(await Se.json()).data}}),{data:C,isLoading:D}=it({queryKey:["prv-targets"],queryFn:async()=>{const Se=await fetch("/api/v1/prv-targets",{credentials:"include"});return Se.ok?Se.json():[{id:"1",dma_id:"dma-1",dma_name:"Central DMA",min_pressure_m:15,max_pressure_m:40,prv_setpoint_m:25,updated_at:"2025-12-01T10:00:00Z"},{id:"2",dma_id:"dma-2",dma_name:"East DMA",min_pressure_m:12,max_pressure_m:35,prv_setpoint_m:22,updated_at:"2025-12-02T14:00:00Z"},{id:"3",dma_id:"dma-3",dma_name:"West DMA",min_pressure_m:18,max_pressure_m:45,prv_setpoint_m:30,updated_at:"2025-12-03T09:00:00Z"}]}}),{data:L}=it({queryKey:["leak-suspicions",T[0]],queryFn:async()=>{const Se=await fetch(`/api/v1/leak-suspicions?score_threshold=${T[0]}`,{credentials:"include"});if(!Se.ok)return[{id:"1",segment_id:"SEG-001",segment_name:"Main St Pipeline",dma_name:"Central DMA",suspicion_score:.85,pressure_drop_pct:15.2,flow_anomaly_pct:12.5,last_reading:"2025-12-08T08:30:00Z",lat:3.12,lng:35.6},{id:"2",segment_id:"SEG-047",segment_name:"Industrial Zone Feed",dma_name:"East DMA",suspicion_score:.72,pressure_drop_pct:8.3,flow_anomaly_pct:18.7,last_reading:"2025-12-08T08:25:00Z",lat:3.08,lng:35.65},{id:"3",segment_id:"SEG-103",segment_name:"Residential Loop",dma_name:"West DMA",suspicion_score:.68,pressure_drop_pct:11.1,flow_anomaly_pct:9.4,last_reading:"2025-12-08T08:20:00Z",lat:3.15,lng:35.55}].filter(be=>be.suspicion_score>=T[0]);const ae=await Se.json();return Array.isArray(ae)?ae:ae.data||[]}}),F=gt({mutationFn:async Se=>{const ae=b?`/api/v1/prv-targets/${b.id}`:"/api/v1/prv-targets",de=await fetch(ae,{method:b?"PUT":"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(Se)});if(!de.ok)throw new Error("Failed to save PRV target");return de.json()},onSuccess:()=>{M.invalidateQueries({queryKey:["prv-targets"]}),re(),Me.success(b?"PRV target updated successfully":"PRV target created successfully")},onError:()=>{Me.error("Failed to save PRV target")}}),B=gt({mutationFn:async Se=>{const ae=await fetch(`/api/v1/prv-targets/${Se}`,{method:"DELETE",credentials:"include"});if(!ae.ok)throw new Error("Failed to delete PRV target");return ae.json()},onSuccess:()=>{M.invalidateQueries({queryKey:["prv-targets"]}),Me.success("PRV target deleted successfully")},onError:()=>{Me.error("Failed to delete PRV target")}}),U=gt({mutationFn:async Se=>{const ae=L==null?void 0:L.find(de=>de.id===Se),be=await fetch("/api/v1/work-orders",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({title:`Leak Investigation - ${ae==null?void 0:ae.segment_name}`,description:`High leak suspicion detected (score: ${ae==null?void 0:ae.suspicion_score}).
Pressure drop: ${ae==null?void 0:ae.pressure_drop_pct}%
Flow anomaly: ${ae==null?void 0:ae.flow_anomaly_pct}%`,priority:ae&&ae.suspicion_score>.8?"high":"medium",kind:"corrective",asset_ids:[]})});if(!be.ok)throw new Error("Failed to create work order");return be.json()},onSuccess:()=>{Me.success("Work order created successfully")},onError:()=>{Me.error("Failed to create work order")}}),te=()=>{w(null),n(""),o("15"),i("40"),p("25"),y(!0)},Q=Se=>{w(Se),n(Se.dma_id),o(Se.min_pressure_m.toString()),i(Se.max_pressure_m.toString()),p(Se.prv_setpoint_m.toString()),y(!0)},re=()=>{y(!1),w(null),n(""),o("15"),i("40"),p("25")},Z=()=>{if(!s||!a||!c||!f){Me.error("Please fill all fields");return}const Se=parseFloat(a),ae=parseFloat(c),be=parseFloat(f);if(Se>=ae){Me.error("Minimum pressure must be less than maximum");return}if(be<Se||be>ae){Me.error("PRV setpoint must be between min and max pressure");return}F.mutate({dma_id:s,min_pressure_m:Se,max_pressure_m:ae,prv_setpoint_m:be})},ne=Se=>Se>=.8?{variant:"destructive",label:"Critical"}:Se>=.7?{variant:"default",label:"High"}:{variant:"secondary",label:"Moderate"},oe=Se=>{const ae=Se.max_pressure_m-Se.min_pressure_m,be=(Se.min_pressure_m+Se.max_pressure_m)/2,Ke=Math.abs(Se.prv_setpoint_m-be)/ae*100;return Ke<10?{color:"bg-green-500",label:"Optimal"}:Ke<25?{color:"bg-yellow-500",label:"Acceptable"}:{color:"bg-orange-500",label:"Review"}},Ce={type:"FeatureCollection",features:(Array.isArray(L)?L:[]).map(Se=>({type:"Feature",geometry:{type:"Point",coordinates:[Se.lng,Se.lat]},properties:{score:Se.suspicion_score,name:Se.segment_name}}))},Pe={totalTargets:(C==null?void 0:C.length)??0,avgSetpoint:C!=null&&C.length?(C.reduce((Se,ae)=>Se+ae.prv_setpoint_m,0)/C.length).toFixed(1):0,totalSuspicions:(L==null?void 0:L.length)??0,criticalSuspicions:(L==null?void 0:L.filter(Se=>Se.suspicion_score>=.8).length)??0};return e.jsxs("div",{className:"p-6 space-y-6 bg-background",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Pressure & Leak Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure DMA pressure targets and detect potential leaks using ML-based analysis"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(H,{className:"bg-card",children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(zc,{className:"h-5 w-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:Pe.totalTargets}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"DMA Targets"})]})]})})}),e.jsx(H,{className:"bg-card",children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(Gn,{className:"h-5 w-5 text-green-500"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold text-foreground",children:[Pe.avgSetpoint,"m"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg PRV Setpoint"})]})]})})}),e.jsx(H,{className:"bg-card",children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-500/10 rounded-lg",children:e.jsx(Fr,{className:"h-5 w-5 text-orange-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:Pe.totalSuspicions}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Leak Suspicions"})]})]})})}),e.jsx(H,{className:"bg-card",children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-500/10 rounded-lg",children:e.jsx(Fr,{className:"h-5 w-5 text-red-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:Pe.criticalSuspicions}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Critical (80%+)"})]})]})})})]}),e.jsxs(ss,{value:t,onValueChange:Se=>r(Se),children:[e.jsxs(Yr,{className:"bg-muted",children:[e.jsx(wt,{value:"targets",children:"DMA Pressure Targets"}),e.jsx(wt,{value:"suspicions",children:"Leak Suspicions"}),e.jsx(wt,{value:"map",children:"Heatmap View"})]}),e.jsx(kt,{value:"targets",className:"mt-6",children:e.jsxs(H,{className:"bg-card",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(he,{className:"text-foreground",children:"DMA Pressure Targets"}),e.jsx(mr,{children:"Configure PRV setpoints and pressure ranges for each District Metered Area"})]}),e.jsxs(K,{onClick:te,children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Add Target"]})]})}),e.jsx(X,{children:D?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(as,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):C&&C.length>0?e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"DMA"}),e.jsx(se,{className:"text-center",children:"Min Pressure"}),e.jsx(se,{className:"text-center",children:"Max Pressure"}),e.jsx(se,{className:"text-center",children:"PRV Setpoint"}),e.jsx(se,{className:"text-center",children:"Status"}),e.jsx(se,{children:"Last Updated"}),e.jsx(se,{className:"text-right",children:"Actions"})]})}),e.jsx(lr,{children:C.map(Se=>{const ae=oe(Se);return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:Se.dma_name}),e.jsx(J,{className:"text-center",children:e.jsxs(Ae,{variant:"outline",children:[Se.min_pressure_m,"m"]})}),e.jsx(J,{className:"text-center",children:e.jsxs(Ae,{variant:"outline",children:[Se.max_pressure_m,"m"]})}),e.jsx(J,{className:"text-center",children:e.jsxs(Ae,{className:"bg-primary text-primary-foreground",children:[Se.prv_setpoint_m,"m"]})}),e.jsx(J,{className:"text-center",children:e.jsx(Ae,{className:`${ae.color} text-white`,children:ae.label})}),e.jsx(J,{className:"text-sm text-muted-foreground",children:Ur(new Date(Se.updated_at),"PP")}),e.jsx(J,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>Q(Se),children:e.jsx(gI,{className:"h-4 w-4"})}),e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>B.mutate(Se.id),disabled:B.isPending,children:e.jsx(Ws,{className:"h-4 w-4 text-destructive"})})]})})]},Se.id)})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Gn,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No pressure targets configured"}),e.jsxs(K,{onClick:te,children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Add First Target"]})]})})]})}),e.jsx(kt,{value:"suspicions",className:"mt-6",children:e.jsxs(H,{className:"bg-card",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(he,{className:"text-foreground",children:"High-Suspicion Segments"}),e.jsx(mr,{children:"Network segments with elevated leak probability requiring investigation"})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"text-sm",children:"Threshold:"}),e.jsx("div",{className:"w-32",children:e.jsx(Am,{value:T,onValueChange:N,min:.5,max:.9,step:.05})}),e.jsxs("span",{className:"text-sm font-mono w-12",children:[(T[0]*100).toFixed(0),"%"]})]})})]})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Segment"}),e.jsx(se,{children:"DMA"}),e.jsx(se,{className:"text-center",children:"Suspicion Score"}),e.jsx(se,{className:"text-center",children:"Pressure Drop"}),e.jsx(se,{className:"text-center",children:"Flow Anomaly"}),e.jsx(se,{children:"Last Reading"}),e.jsx(se,{className:"text-right",children:"Actions"})]})}),e.jsx(lr,{children:L&&L.length>0?L.map(Se=>{const ae=ne(Se.suspicion_score);return e.jsxs(Qe,{children:[e.jsx(J,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:Se.segment_name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:Se.segment_id})]})}),e.jsx(J,{children:Se.dma_name}),e.jsx(J,{className:"text-center",children:e.jsxs(Ae,{variant:ae.variant,children:[((Se.suspicion_score??0)*100).toFixed(0),"% - ",ae.label]})}),e.jsx(J,{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(ci,{className:"h-4 w-4 text-red-500"}),e.jsxs("span",{children:[(Se.pressure_drop_pct??0).toFixed(1),"%"]})]})}),e.jsx(J,{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(zs,{className:"h-4 w-4 text-orange-500"}),e.jsxs("span",{children:[(Se.flow_anomaly_pct??0).toFixed(1),"%"]})]})}),e.jsx(J,{className:"text-sm text-muted-foreground",children:Se.last_reading?Ur(new Date(Se.last_reading),"PP p"):"N/A"}),e.jsx(J,{className:"text-right",children:e.jsxs(K,{size:"sm",onClick:()=>U.mutate(Se.id),disabled:U.isPending,children:[e.jsx(Vc,{className:"mr-2 h-4 w-4"}),"Create WO"]})})]},Se.id)}):e.jsx(Qe,{children:e.jsxs(J,{colSpan:7,className:"text-center py-12 text-muted-foreground",children:["No segments above ",(T[0]*100).toFixed(0),"% threshold"]})})})]})})]})}),e.jsx(kt,{value:"map",className:"mt-6",children:e.jsxs(H,{className:"bg-card",children:[e.jsxs(ue,{children:[e.jsxs(he,{className:"flex items-center gap-2 text-foreground",children:[e.jsx(Fr,{className:"h-5 w-5 text-orange-500"}),"Leak Suspicion Heatmap"]}),e.jsx(mr,{children:"ML-based leak detection using pressure and flow anomalies"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"h-[500px] rounded-lg overflow-hidden border",children:e.jsxs(Pm,{initialViewState:{longitude:35.6,latitude:3.1,zoom:10},style:{width:"100%",height:"100%"},mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",children:[e.jsx(km,{position:"top-right"}),e.jsx(yv,{}),e.jsx(_u,{id:"leak-heatmap",type:"geojson",data:Ce,children:e.jsx(ni,{id:"leak-points",type:"circle",paint:{"circle-radius":["interpolate",["linear"],["get","score"],.5,8,.7,15,.9,25],"circle-color":["interpolate",["linear"],["get","score"],.5,"#22c55e",.6,"#eab308",.7,"#f59e0b",.8,"#ef4444"],"circle-opacity":.7,"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}})})]})}),e.jsxs("div",{className:"flex items-center justify-center gap-8 mt-4 p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-green-500"}),e.jsx("span",{className:"text-sm",children:"Low (50-60%)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-yellow-500"}),e.jsx("span",{className:"text-sm",children:"Moderate (60-70%)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-orange-500"}),e.jsx("span",{className:"text-sm",children:"High (70-80%)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-red-500"}),e.jsx("span",{className:"text-sm",children:"Critical (80%+)"})]})]})]})]})})]}),e.jsx(Qt,{open:g,onOpenChange:y,children:e.jsxs(Zt,{children:[e.jsxs(Yt,{children:[e.jsxs(Xt,{children:[b?"Edit":"Add"," PRV Pressure Target"]}),e.jsx(Es,{children:"Configure pressure reducing valve setpoints for a District Metered Area"})]}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"DMA Zone *"}),e.jsxs(Nt,{value:s,onValueChange:n,disabled:!!b,children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select DMA"})}),e.jsx(_t,{children:O==null?void 0:O.map(Se=>e.jsxs(ge,{value:Se.id,children:[Se.code," - ",Se.name]},Se.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Minimum Pressure (m) *"}),e.jsx(Ie,{type:"number",value:a,onChange:Se=>o(Se.target.value),placeholder:"15",step:"0.5"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Maximum Pressure (m) *"}),e.jsx(Ie,{type:"number",value:c,onChange:Se=>i(Se.target.value),placeholder:"40",step:"0.5"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"PRV Setpoint (m) *"}),e.jsx(Ie,{type:"number",value:f,onChange:Se=>p(Se.target.value),placeholder:"25",step:"0.5"}),a&&c&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Recommended setpoint: ",((parseFloat(a)+parseFloat(c))/2).toFixed(1),"m (midpoint of ",a,"m - ",c,"m range)"]})]}),a&&c&&f&&e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"Pressure Range Visualization"}),e.jsx("div",{className:"relative h-8 bg-gradient-to-r from-red-500 via-green-500 to-red-500 rounded",children:e.jsx("div",{className:"absolute top-0 bottom-0 w-1 bg-primary border-2 border-white rounded",style:{left:`${(parseFloat(f)-parseFloat(a))/(parseFloat(c)-parseFloat(a))*100}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{children:[a,"m (min)"]}),e.jsxs("span",{children:[f,"m (setpoint)"]}),e.jsxs("span",{children:[c,"m (max)"]})]})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:re,children:"Cancel"}),e.jsxs(K,{onClick:Z,disabled:F.isPending,children:[F.isPending&&e.jsx(as,{className:"mr-2 h-4 w-4 animate-spin"}),b?"Update":"Create"," Target"]})]})]})})]})}function bqe(){var U;const t=yr(),[r,s]=A.useState(""),[n,a]=A.useState("all"),[o,c]=A.useState(!1),[i,f]=A.useState(""),[p,g]=A.useState(""),[y,b]=A.useState(""),{data:w,isLoading:T,error:N}=it({queryKey:["shifts",n],queryFn:()=>Us.shifts.list({status:n==="all"?void 0:n,per_page:50})}),M=gt({mutationFn:te=>Us.shifts.create(te),onSuccess:()=>{Me.success("Shift created successfully"),c(!1),f(""),g(""),b(""),t.invalidateQueries({queryKey:["shifts"]})},onError:()=>{Me.error("Failed to create shift")}}),O=gt({mutationFn:te=>Us.shifts.close(te,{}),onSuccess:()=>{Me.success("Shift closed"),t.invalidateQueries({queryKey:["shifts"]})},onError:()=>{Me.error("Failed to close shift")}}),C=gt({mutationFn:te=>Us.shifts.activate(te),onSuccess:()=>{Me.success("Shift activated"),t.invalidateQueries({queryKey:["shifts"]})},onError:()=>{Me.error("Failed to activate shift")}}),D=gt({mutationFn:te=>Us.shifts.delete(te),onSuccess:()=>{Me.success("Shift deleted"),t.invalidateQueries({queryKey:["shifts"]})},onError:()=>{Me.error("Failed to delete shift")}}),L=()=>{if(!i||!p){Me.error("Please fill in required fields");return}M.mutate({name:i,starts_at:p,ends_at:y||void 0,status:"planned"})},F=((U=w==null?void 0:w.data)==null?void 0:U.filter(te=>{var Q,re;return te.name.toLowerCase().includes(r.toLowerCase())||((re=(Q=te.facility)==null?void 0:Q.name)==null?void 0:re.toLowerCase().includes(r.toLowerCase()))}))||[],B=te=>{switch(te){case"active":return"bg-green-100 text-green-800";case"planned":return"bg-blue-100 text-blue-800";case"closed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Shifts Management"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"24/7 shift scheduling and logbook"})]}),e.jsxs(Qt,{open:o,onOpenChange:c,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Shift"]})}),e.jsxs(Zt,{className:"max-w-md",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Create New Shift"}),e.jsx(Es,{children:"Schedule a new shift for operators"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"shift-name",children:"Shift Name *"}),e.jsx(Ie,{id:"shift-name",placeholder:"e.g., Morning Shift - Dec 9",value:i,onChange:te=>f(te.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"shift-start",children:"Start Time *"}),e.jsx(Ie,{id:"shift-start",type:"datetime-local",value:p,onChange:te=>g(te.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"shift-end",children:"End Time"}),e.jsx(Ie,{id:"shift-end",type:"datetime-local",value:y,onChange:te=>b(te.target.value)})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsxs(K,{onClick:L,disabled:M.isPending,children:[M.isPending&&e.jsx(as,{className:"h-4 w-4 mr-2 animate-spin"}),"Create Shift"]})]})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(Ie,{placeholder:"Search by shift name or facility...",value:r,onChange:te=>s(te.target.value),className:"max-w-sm"}),e.jsx("div",{className:"flex gap-2",children:["all","planned","active","closed"].map(te=>e.jsx(K,{variant:n===te?"default":"outline",onClick:()=>a(te),size:"sm",children:te.charAt(0).toUpperCase()+te.slice(1)},te))})]}),T?e.jsx(H,{children:e.jsx(X,{className:"p-8 text-center text-muted-foreground",children:"Loading shifts..."})}):N?e.jsxs(zn,{variant:"destructive",children:[e.jsx(Fr,{className:"h-4 w-4"}),e.jsxs(An,{children:["Error loading shifts: ",N.message]})]}):F.length===0?e.jsx(H,{children:e.jsx(X,{className:"p-8 text-center text-muted-foreground",children:"No shifts found"})}):e.jsx("div",{className:"grid gap-4",children:F.map(te=>e.jsx(H,{className:"hover:shadow-md transition-shadow",children:e.jsx(X,{className:"p-6",children:e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"font-semibold text-lg",children:te.name}),e.jsx(Ae,{className:B(te.status),children:te.status})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[te.facility&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(fn,{className:"h-4 w-4"}),te.facility.name]}),te.supervisor&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ds,{className:"h-4 w-4"}),te.supervisor.name]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx($s,{className:"h-4 w-4"}),Ur(new Date(te.starts_at),"HH:mm")," - ",Ur(new Date(te.ends_at),"HH:mm")]}),te.entries_count!==void 0&&e.jsxs("div",{className:"text-muted-foreground",children:[te.entries_count," entries"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[te.status==="planned"&&e.jsxs(K,{size:"sm",variant:"default",onClick:()=>C.mutate(te.id),disabled:C.isPending||D.isPending,children:[C.isPending?e.jsx(as,{className:"h-4 w-4 mr-1 animate-spin"}):e.jsx(Ui,{className:"h-4 w-4 mr-1"}),"Activate"]}),te.status==="active"&&e.jsxs(K,{size:"sm",variant:"secondary",onClick:()=>O.mutate(te.id),disabled:O.isPending,children:[O.isPending&&e.jsx(as,{className:"h-4 w-4 mr-1 animate-spin"}),"Close Shift"]}),te.status!=="active"&&e.jsx(K,{size:"sm",variant:"destructive",onClick:()=>{confirm("Delete this shift?")&&D.mutate(te.id)},disabled:D.isPending||C.isPending,children:D.isPending?e.jsx(as,{className:"h-4 w-4 animate-spin"}):e.jsx(Ws,{className:"h-4 w-4"})})]})]})})},te.id))})]})}function _qe(){const t=yr(),[r,s]=A.useState("all"),[n,a]=A.useState("all"),[o,c]=A.useState(!1),[i,f]=A.useState(""),[p,g]=A.useState("medium"),[y,b]=A.useState(""),[w,T]=A.useState("manual"),{data:N,isLoading:M,error:O}=it({queryKey:["events",r,n],queryFn:()=>Us.events.list({severity:r==="all"?void 0:r,status:n==="all"?void 0:n,per_page:50})}),C=gt({mutationFn:re=>Us.events.create(re),onSuccess:()=>{Me.success("Event created"),c(!1),f(""),g("medium"),b(""),T("manual"),t.invalidateQueries({queryKey:["events"]})},onError:()=>{Me.error("Failed to create event")}}),D=gt({mutationFn:re=>Us.events.acknowledge(re,{note:"Acknowledged"}),onSuccess:()=>{Me.success("Event acknowledged"),t.invalidateQueries({queryKey:["events"]})},onError:()=>{Me.error("Failed to acknowledge event")}}),L=gt({mutationFn:re=>Us.events.resolve(re,{resolution:"Resolved"}),onSuccess:()=>{Me.success("Event resolved"),t.invalidateQueries({queryKey:["events"]})},onError:()=>{Me.error("Failed to resolve event")}}),F=()=>{if(!i){Me.error("Please provide a category");return}C.mutate({category:i,severity:p,description:y||void 0,source:w,status:"new",detected_at:new Date().toISOString()})},B=re=>{switch(re){case"critical":return"destructive";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"secondary";default:return"outline"}},U=re=>{switch(re){case"critical":return e.jsx(Ta,{className:"h-4 w-4"});case"high":return e.jsx(Fr,{className:"h-4 w-4"});default:return null}},te=re=>{switch(re){case"new":return"bg-red-100 text-red-800";case"ack":return"bg-blue-100 text-blue-800";case"in_progress":return"bg-purple-100 text-purple-800";case"resolved":return"bg-green-100 text-green-800";case"closed":return"bg-gray-100 text-gray-800";default:return"outline"}},Q=(N==null?void 0:N.data)||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Events & Alarms"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Monitor, acknowledge, and resolve system events"})]}),e.jsxs(Qt,{open:o,onOpenChange:re=>{c(re),re||(f(""),g("medium"),b(""),T("manual"))},children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"Report Event"]})}),e.jsxs(Zt,{className:"max-w-md",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Report New Event"}),e.jsx(Es,{children:"Manually report an incident or alarm"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"event-category",children:"Category *"}),e.jsx(Ie,{id:"event-category",placeholder:"e.g., pressure_drop, contamination, leak",value:i,onChange:re=>f(re.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"event-severity",children:"Severity"}),e.jsxs("select",{id:"event-severity",value:p,onChange:re=>g(re.target.value),className:"w-full rounded border border-input bg-background px-3 py-2 text-sm",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"event-source",children:"Source"}),e.jsxs("select",{id:"event-source",value:w,onChange:re=>T(re.target.value),className:"w-full rounded border border-input bg-background px-3 py-2 text-sm",children:[e.jsx("option",{value:"manual",children:"Manual Report"}),e.jsx("option",{value:"field_staff",children:"Field Staff"}),e.jsx("option",{value:"customer",children:"Customer Complaint"}),e.jsx("option",{value:"scada",children:"SCADA Alert"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"event-description",children:"Description"}),e.jsx(ws,{id:"event-description",placeholder:"Describe the event or incident...",rows:3,value:y,onChange:re=>b(re.target.value)})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsxs(K,{onClick:F,disabled:C.isPending,children:[C.isPending&&e.jsx(as,{className:"h-4 w-4 mr-2 animate-spin"}),"Report Event"]})]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground py-2",children:"Severity:"}),["all","critical","high","medium","low"].map(re=>e.jsx(K,{variant:r===re?"default":"outline",onClick:()=>s(re),size:"sm",children:re==="all"?"All":re.charAt(0).toUpperCase()+re.slice(1)},re))]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground py-2",children:"Status:"}),["all","new","ack","resolved"].map(re=>e.jsx(K,{variant:n===re?"default":"outline",onClick:()=>a(re),size:"sm",children:re==="all"?"All":re.charAt(0).toUpperCase()+re.slice(1)},re))]})]}),M?e.jsx(H,{children:e.jsx(X,{className:"p-8 text-center text-muted-foreground",children:"Loading events..."})}):O?e.jsxs(zn,{variant:"destructive",children:[e.jsx(Fr,{className:"h-4 w-4"}),e.jsxs(An,{children:["Error loading events: ",O.message]})]}):Q.length===0?e.jsx(H,{children:e.jsx(X,{className:"p-8 text-center text-muted-foreground",children:"No events found"})}):e.jsx("div",{className:"space-y-3",children:Q.map(re=>e.jsx(H,{className:"hover:shadow-md transition-shadow",children:e.jsx(X,{className:"p-5",children:e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[U(re.severity)&&e.jsx(e.Fragment,{children:U(re.severity)}),e.jsx("h3",{className:"font-semibold",children:re.category}),e.jsx(Ae,{className:B(re.severity),children:re.severity}),e.jsx(Ae,{className:te(re.status),children:re.status})]}),re.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:re.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground pt-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($s,{className:"h-3 w-3"}),re.detected_at?Ur(new Date(re.detected_at),"Pp"):"N/A"]}),re.facility&&e.jsx("div",{children:re.facility.name}),e.jsx("div",{className:"text-gray-500",children:re.source})]})]}),e.jsxs("div",{className:"flex gap-2",children:[re.status==="new"&&e.jsxs(K,{size:"sm",variant:"outline",onClick:()=>D.mutate(re.id),disabled:D.isPending||L.isPending,children:[D.isPending&&e.jsx(as,{className:"h-4 w-4 mr-1 animate-spin"}),"Acknowledge"]}),re.status!=="resolved"&&re.status!=="closed"&&e.jsxs(K,{size:"sm",onClick:()=>L.mutate(re.id),disabled:L.isPending||D.isPending,children:[L.isPending?e.jsx(as,{className:"h-4 w-4 mr-1 animate-spin"}):e.jsx(Ns,{className:"h-4 w-4 mr-1"}),"Resolve"]})]})]})})},re.id))})]})}function wqe({onSchemaChange:t}){var y;const{control:r,register:s,watch:n,formState:{errors:a}}=jv(),{fields:o,append:c,remove:i,move:f}=oD({control:r,name:"schema"});n("schema");const p=()=>{c({question:"",type:"boolean",required:!0,options:""})},g=["boolean","text","number","choice","rating"];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(we,{className:"text-base font-semibold",children:"Checklist Questions"}),e.jsxs(K,{type:"button",variant:"outline",size:"sm",onClick:p,children:[e.jsx(Mt,{className:"h-4 w-4 mr-1"}),"Add Question"]})]}),o.length===0?e.jsx(H,{className:"border-dashed",children:e.jsx(X,{className:"p-8 text-center text-muted-foreground",children:e.jsx("p",{className:"text-sm",children:'No questions yet. Click "Add Question" to get started.'})})}):e.jsx("div",{className:"space-y-3",children:o.map((b,w)=>e.jsx(Nqe,{fieldIndex:w,onRemove:()=>i(w),onMove:T=>{T==="up"&&w>0&&f(w,w-1),T==="down"&&w<o.length-1&&f(w,w+1)},register:s,fieldTypes:g,watch:n},b.id))}),a.schema&&e.jsx("p",{className:"text-sm text-red-500",children:(y=a.schema)==null?void 0:y.message}),e.jsxs("div",{className:"text-sm text-muted-foreground pt-2",children:[o.length," question",o.length!==1?"s":""," in this checklist"]})]})}function Nqe({fieldIndex:t,onRemove:r,onMove:s,register:n,fieldTypes:a,watch:o}){const c=o(`schema.${t}`),[i,f]=A.useState((c==null?void 0:c.type)==="choice"),p=o(`schema.${t}.options`),g=Array.isArray(p)?p.filter(y=>y==null?void 0:y.trim()):typeof p=="string"?p.split(`
`).filter(y=>y.trim()):[];return e.jsx(H,{className:"border bg-muted/30",children:e.jsx(X,{className:"p-4 space-y-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(we,{htmlFor:`question-${t}`,className:"text-sm",children:["Question ",t+1]}),e.jsx(Ie,{id:`question-${t}`,placeholder:"Enter your question...",...n(`schema.${t}.question`,{required:"Question is required"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:`type-${t}`,className:"text-sm",children:"Type"}),e.jsx("select",{id:`type-${t}`,...n(`schema.${t}.type`),onChange:y=>{f(y.target.value==="choice")},className:"w-full rounded border border-input bg-background px-3 py-2 text-sm",children:a.map(y=>e.jsx("option",{value:y,children:y.charAt(0).toUpperCase()+y.slice(1)},y))})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs(we,{className:"text-sm flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",...n(`schema.${t}.required`),className:"rounded"}),e.jsx("span",{children:"Required"})]})})]}),i&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:`options-${t}`,className:"text-sm",children:"Options (one per line)"}),e.jsx("textarea",{id:`options-${t}`,placeholder:`Option 1
Option 2
Option 3`,rows:3,...n(`schema.${t}.options`),className:"w-full rounded border border-input bg-background px-3 py-2 text-sm font-mono"}),g.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 pt-2",children:g.map((y,b)=>e.jsx("div",{className:"bg-background rounded px-2 py-1 border text-xs",children:y.trim()},b))})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(K,{type:"button",variant:"ghost",size:"sm",onClick:()=>s("up"),title:"Move up",className:"text-muted-foreground",children:""}),e.jsx(K,{type:"button",variant:"ghost",size:"sm",onClick:()=>s("down"),title:"Move down",className:"text-muted-foreground",children:""}),e.jsx(K,{type:"button",variant:"ghost",size:"sm",onClick:r,title:"Delete",className:"text-destructive hover:text-destructive",children:e.jsx(Ws,{className:"h-4 w-4"})})]})]})})})}function q8({initialChecklist:t,onSuccess:r}){const s=c=>c.map(i=>({...i,options:Array.isArray(i.options)?i.options.join(`
`):i.options||""})),n=Ya({defaultValues:{title:(t==null?void 0:t.title)||"",frequency:(t==null?void 0:t.frequency)||"",schema:t!=null&&t.schema?s(t.schema):[{question:"Is the facility operational?",type:"boolean",required:!0,options:""}]}}),a=gt({mutationFn:c=>t?Us.checklists.update(t.id,c):Us.checklists.create(c),onSuccess:()=>{Me.success(t?"Checklist updated":"Checklist created"),r==null||r()},onError:c=>{Me.error(c.message)}}),o=c=>{if(!c.schema||c.schema.length===0){Me.error("Add at least one question");return}if(c.schema.some(p=>{var g;return!((g=p.question)!=null&&g.trim())})){Me.error("All questions must have text");return}const f=c.schema.map(p=>{let g=[];return p.type==="choice"&&p.options&&(g=Array.isArray(p.options)?p.options.filter(y=>y==null?void 0:y.trim()):p.options.split(`
`).filter(y=>y.trim())),{...p,options:g}});a.mutate({...c,schema:f})};return e.jsx(EG,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(o),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"title",children:"Checklist Title"}),e.jsx(Ie,{id:"title",placeholder:"e.g., Daily Facility Inspection",...n.register("title",{required:"Title is required"})}),n.formState.errors.title&&e.jsx("p",{className:"text-sm text-red-500",children:n.formState.errors.title.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"frequency",children:"Frequency (Optional)"}),e.jsxs("select",{id:"frequency",...n.register("frequency"),className:"w-full rounded border border-input bg-background px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"No specific frequency"}),e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"shift_start",children:"At shift start"}),e.jsx("option",{value:"shift_end",children:"At shift end"}),e.jsx("option",{value:"on_demand",children:"On demand"})]})]}),e.jsx(wqe,{}),e.jsx(K,{type:"submit",disabled:a.isPending,className:"w-full",children:a.isPending?"Saving...":t?"Update Checklist":"Create Checklist"})]})})}function Sqe(){var F,B,U,te;const t=yr(),[r,s]=A.useState("checklists"),[n,a]=A.useState(!1),[o,c]=A.useState(!1),[i,f]=A.useState(null),[p,g]=A.useState(!1),[y,b]=A.useState(null),{data:w,isLoading:T}=it({queryKey:["checklists"],queryFn:()=>Us.checklists.list({per_page:50})}),{data:N,isLoading:M}=it({queryKey:["checklist-runs"],queryFn:()=>Us.checklists.listRuns({per_page:50})}),O=gt({mutationFn:Q=>Us.checklists.delete(Q),onSuccess:()=>{Me.success("Checklist deleted"),t.invalidateQueries({queryKey:["checklists"]})},onError:()=>{Me.error("Failed to delete checklist")}}),C=gt({mutationFn:Q=>Us.checklists.startRun(Q,{}),onSuccess:()=>{Me.success("Checklist run started"),c(!1),f(null),s("runs"),t.invalidateQueries({queryKey:["checklist-runs"]})},onError:()=>{Me.error("Failed to start checklist run")}}),D=(w==null?void 0:w.data)||[],L=(N==null?void 0:N.data)||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Checklists"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Create and manage facility checklists"})]}),e.jsxs(Qt,{open:n,onOpenChange:a,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Checklist"]})}),e.jsxs(Zt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Create Checklist"}),e.jsx(Es,{children:"Define questions for your facility checklist"})]}),e.jsx(q8,{onSuccess:()=>{a(!1),t.invalidateQueries({queryKey:["checklists"]})}})]})]})]}),e.jsxs(ss,{value:r,onValueChange:s,children:[e.jsxs(Yr,{children:[e.jsx(wt,{value:"checklists",children:"Templates"}),e.jsx(wt,{value:"runs",children:"Runs"})]}),e.jsx(kt,{value:"checklists",className:"space-y-4",children:T?e.jsx(H,{children:e.jsx(X,{className:"p-8 text-center text-muted-foreground",children:"Loading checklists..."})}):D.length===0?e.jsx(H,{children:e.jsx(X,{className:"p-8 text-center text-muted-foreground",children:"No checklists found. Create one to get started!"})}):e.jsx("div",{className:"grid gap-4",children:D.map(Q=>{var re,Z;return e.jsx(H,{className:"hover:shadow-md transition-shadow",children:e.jsx(X,{className:"p-6",children:e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:Q.title}),Q.frequency&&e.jsx(Ae,{variant:"outline",children:Q.frequency})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[((re=Q.schema)==null?void 0:re.length)||0," questions",((Z=Q._count)==null?void 0:Z.runs)&&`  ${Q._count.runs} runs completed`]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Qt,{children:[e.jsx(qr,{asChild:!0,children:e.jsx(K,{variant:"outline",size:"sm",children:"Edit"})}),e.jsxs(Zt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Edit Checklist"})}),e.jsx(q8,{initialChecklist:Q,onSuccess:()=>{t.invalidateQueries({queryKey:["checklists"]})}})]})]}),e.jsxs(K,{size:"sm",onClick:()=>{f(Q),c(!0)},children:[e.jsx(n9,{className:"h-4 w-4 mr-1"}),"Start Run"]}),e.jsx(K,{variant:"destructive",size:"sm",onClick:()=>{confirm("Delete this checklist?")&&O.mutate(Q.id)},disabled:O.isPending||C.isPending,children:O.isPending?e.jsx(as,{className:"h-4 w-4 animate-spin"}):e.jsx(Ws,{className:"h-4 w-4"})})]})]})})},Q.id)})})}),e.jsx(kt,{value:"runs",className:"space-y-4",children:M?e.jsx(H,{children:e.jsx(X,{className:"p-8 text-center text-muted-foreground",children:"Loading runs..."})}):L.length===0?e.jsx(H,{children:e.jsx(X,{className:"p-8 text-center text-muted-foreground",children:"No checklist runs yet"})}):e.jsx("div",{className:"grid gap-4",children:L.map(Q=>e.jsx(H,{className:"hover:shadow-md transition-shadow",children:e.jsx(X,{className:"p-6",children:e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[Q.completed_at?e.jsx(Zl,{className:"h-5 w-5 text-green-600"}):e.jsx("div",{className:"h-5 w-5 rounded-full border-2 border-blue-600"}),e.jsx("h3",{className:"font-semibold",children:Q.checklist.title}),Q.score!==void 0&&e.jsxs(Ae,{className:"bg-green-100 text-green-800",children:[Q.score,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("div",{children:["Started: ",Ur(new Date(Q.started_at),"Pp")]}),Q.completed_at&&e.jsxs("div",{children:["Completed: ",Ur(new Date(Q.completed_at),"Pp")]}),Q.performed_by&&e.jsxs("div",{children:["By: ",Q.performed_by.name]})]})]}),e.jsxs(K,{variant:"outline",size:"sm",onClick:()=>{b(Q),g(!0)},children:[e.jsx(mo,{className:"h-4 w-4 mr-1"}),"View Details"]})]})})},Q.id))})})]}),e.jsx(Qt,{open:o,onOpenChange:c,children:e.jsxs(Zt,{className:"max-w-md",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Start Checklist Run"}),e.jsxs(Es,{children:['Begin a new run of "',i==null?void 0:i.title,'"']})]}),e.jsx("div",{className:"py-4",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["This checklist has ",((F=i==null?void 0:i.schema)==null?void 0:F.length)||0," questions. Once started, you'll need to complete all required questions."]})}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsxs(K,{onClick:()=>i&&C.mutate(i.id),disabled:C.isPending,children:[C.isPending&&e.jsx(as,{className:"h-4 w-4 mr-2 animate-spin"}),"Start Run"]})]})]})}),e.jsx(Qt,{open:p,onOpenChange:Q=>{g(Q),Q||b(null)},children:e.jsxs(Zt,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Checklist Run Details"}),e.jsxs(Es,{children:[(B=y==null?void 0:y.checklist)==null?void 0:B.title," - ",(y==null?void 0:y.started_at)&&Ur(new Date(y.started_at),"PPP")]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Status:"})," ",e.jsx(Ae,{className:y!=null&&y.completed_at?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800",children:y!=null&&y.completed_at?"Completed":"In Progress"})]}),(y==null?void 0:y.score)!==void 0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Score:"})," ",e.jsxs("span",{className:"font-semibold",children:[y.score,"%"]})]}),(y==null?void 0:y.performed_by)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Performed By:"})," ",e.jsx("span",{children:y.performed_by.name})]}),(y==null?void 0:y.completed_at)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Completed:"})," ",e.jsx("span",{children:Ur(new Date(y.completed_at),"Pp")})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Questions & Responses"}),e.jsx("div",{className:"space-y-3",children:(te=(U=y==null?void 0:y.checklist)==null?void 0:U.schema)==null?void 0:te.map((Q,re)=>{var ne,oe;const Z=((ne=y==null?void 0:y.responses)==null?void 0:ne[Q.question])||((oe=y==null?void 0:y.responses)==null?void 0:oe[re]);return e.jsx("div",{className:"p-3 bg-muted/50 rounded-lg",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:Q.question}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Type: ",Q.type," ",Q.required&&" Required"]})]}),e.jsx("div",{className:"text-right",children:Z!==void 0?e.jsx("span",{className:"text-sm font-medium text-green-700",children:typeof Z=="boolean"?Z?"Yes":"No":typeof Z=="object"?JSON.stringify(Z):String(Z)}):e.jsx("span",{className:"text-xs text-muted-foreground italic",children:"No response"})})]})},re)})})]})]}),e.jsx(Ps,{children:e.jsx(K,{variant:"outline",onClick:()=>g(!1),children:"Close"})})]})})]})}function Cqe(){const t=yr(),[r,s]=A.useState(!1),[n,a]=A.useState(!1),[o,c]=A.useState(null),[i,f]=A.useState(""),[p,g]=A.useState(""),[y,b]=A.useState("medium"),[w,T]=A.useState(""),{data:N,isLoading:M,error:O}=it({queryKey:["playbooks"],queryFn:()=>Us.playbooks.list({per_page:50})}),C=gt({mutationFn:ne=>Us.playbooks.create(ne),onSuccess:()=>{Me.success("Playbook created"),s(!1),F(),t.invalidateQueries({queryKey:["playbooks"]})},onError:()=>{Me.error("Failed to create playbook")}}),D=gt({mutationFn:({id:ne,data:oe})=>Us.playbooks.update(ne,oe),onSuccess:()=>{Me.success("Playbook updated"),a(!1),c(null),F(),t.invalidateQueries({queryKey:["playbooks"]})},onError:()=>{Me.error("Failed to update playbook")}}),L=gt({mutationFn:ne=>Us.playbooks.delete(ne),onSuccess:()=>{Me.success("Playbook deleted"),t.invalidateQueries({queryKey:["playbooks"]})},onError:()=>{Me.error("Failed to delete playbook")}}),F=()=>{f(""),g(""),b("medium"),T("")},B=ne=>{var oe;c(ne),f(ne.name),g(ne.for_category||""),b(ne.for_severity||"medium"),T(((oe=ne.steps)==null?void 0:oe.map(Ce=>Ce.action||Ce.title||"").join(`
`))||""),a(!0)},U=()=>{if(!o||!i){Me.error("Please provide a playbook name");return}const ne=w.split(`
`).filter(oe=>oe.trim()).map((oe,Ce)=>({order:Ce+1,action:oe.trim()}));D.mutate({id:o.id,data:{name:i,for_category:p||void 0,for_severity:y||void 0,steps:ne}})},te=()=>{if(!i){Me.error("Please provide a playbook name");return}const ne=w.split(`
`).filter(oe=>oe.trim()).map((oe,Ce)=>({order:Ce+1,action:oe.trim()}));C.mutate({name:i,for_category:p||void 0,for_severity:y||void 0,steps:ne})},Q=(N==null?void 0:N.data)||[],re=ne=>{switch(ne){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-gray-100 text-gray-800";default:return"outline"}},Z=ne=>{switch(ne){case"automated":return e.jsx(Ta,{className:"h-4 w-4"});case"decision":return e.jsx(Fu,{className:"h-4 w-4"});default:return null}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Playbooks"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Event response automation and runbooks"})]}),e.jsxs(Qt,{open:r,onOpenChange:s,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Playbook"]})}),e.jsxs(Zt,{className:"max-w-lg",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Create New Playbook"}),e.jsx(Es,{children:"Define response steps for specific event types"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"playbook-name",children:"Playbook Name *"}),e.jsx(Ie,{id:"playbook-name",placeholder:"e.g., High Pressure Response",value:i,onChange:ne=>f(ne.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"playbook-category",children:"For Category"}),e.jsx(Ie,{id:"playbook-category",placeholder:"e.g., pressure, quality",value:p,onChange:ne=>g(ne.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"playbook-severity",children:"For Severity"}),e.jsxs("select",{id:"playbook-severity",value:y,onChange:ne=>b(ne.target.value),className:"w-full rounded border border-input bg-background px-3 py-2 text-sm",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"playbook-steps",children:"Steps (one per line)"}),e.jsx(ws,{id:"playbook-steps",placeholder:`Verify alarm source
Check upstream status
Dispatch field team if needed`,rows:6,value:w,onChange:ne=>T(ne.target.value)})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),e.jsxs(K,{onClick:te,disabled:C.isPending,children:[C.isPending&&e.jsx(as,{className:"h-4 w-4 mr-2 animate-spin"}),"Create Playbook"]})]})]})]})]}),M?e.jsx(H,{children:e.jsx(X,{className:"p-8 text-center text-muted-foreground",children:"Loading playbooks..."})}):O?e.jsxs(zn,{variant:"destructive",children:[e.jsx(Fr,{className:"h-4 w-4"}),e.jsxs(An,{children:["Error loading playbooks: ",O.message]})]}):Q.length===0?e.jsx(H,{children:e.jsx(X,{className:"p-8 text-center text-muted-foreground",children:"No playbooks found. Create one to automate event responses!"})}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:Q.map(ne=>{var oe,Ce;return e.jsxs(H,{className:"hover:shadow-md transition-shadow flex flex-col",children:[e.jsx(ue,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(he,{className:"text-lg",children:ne.name}),ne.for_category&&e.jsxs(mr,{className:"text-xs mt-1",children:["For: ",ne.for_category]})]}),ne.for_severity&&e.jsx(Ae,{className:re(ne.for_severity),children:ne.for_severity})]})}),e.jsx(X,{className:"flex-1 pb-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm text-muted-foreground font-medium",children:[((oe=ne.steps)==null?void 0:oe.length)||0," steps"]}),e.jsx("div",{className:"space-y-1 max-h-32 overflow-y-auto text-xs",children:(Ce=ne.steps)==null?void 0:Ce.map((Pe,Se)=>e.jsxs("div",{className:"flex items-start gap-2 p-1.5 bg-muted/50 rounded",children:[e.jsxs("span",{className:"text-muted-foreground font-semibold min-w-6",children:[Pe.order||Se+1,"."]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium truncate",children:Pe.action||Pe.title}),Pe.type&&e.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground mt-0.5",children:[Z(Pe.type),e.jsx("span",{children:Pe.type})]})]})]},Se))})]})}),e.jsxs("div",{className:"flex gap-2 border-t pt-3 px-4 pb-4",children:[e.jsxs(K,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>B(ne),children:[e.jsx(k_,{className:"h-4 w-4 mr-1"}),"Edit"]}),e.jsx(K,{variant:"destructive",size:"sm",onClick:()=>{confirm("Delete this playbook?")&&L.mutate(ne.id)},disabled:L.isPending,children:e.jsx(Ws,{className:"h-4 w-4"})})]})]},ne.id)})}),e.jsx(Qt,{open:n,onOpenChange:ne=>{a(ne),ne||(c(null),F())},children:e.jsxs(Zt,{className:"max-w-lg",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Edit Playbook"}),e.jsx(Es,{children:"Modify the playbook steps and configuration"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"edit-playbook-name",children:"Playbook Name *"}),e.jsx(Ie,{id:"edit-playbook-name",placeholder:"e.g., High Pressure Response",value:i,onChange:ne=>f(ne.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"edit-playbook-category",children:"For Category"}),e.jsx(Ie,{id:"edit-playbook-category",placeholder:"e.g., pressure, quality",value:p,onChange:ne=>g(ne.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"edit-playbook-severity",children:"For Severity"}),e.jsxs("select",{id:"edit-playbook-severity",value:y,onChange:ne=>b(ne.target.value),className:"w-full rounded border border-input bg-background px-3 py-2 text-sm",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"edit-playbook-steps",children:"Steps (one per line)"}),e.jsx(ws,{id:"edit-playbook-steps",placeholder:`Verify alarm source
Check upstream status
Dispatch field team if needed`,rows:6,value:w,onChange:ne=>T(ne.target.value)})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsxs(K,{onClick:U,disabled:D.isPending,children:[D.isPending&&e.jsx(as,{className:"h-4 w-4 mr-2 animate-spin"}),"Save Changes"]})]})]})})]})}async function Pqe(){return(await(await fetch("/api/v1/admin/users?category=supervisor")).json()).data||[]}function V8({initialPolicy:t,onSuccess:r}){const{control:s,register:n,handleSubmit:a,formState:{errors:o}}=Ya({defaultValues:{name:(t==null?void 0:t.name)||"",rules:(t==null?void 0:t.rules)||[{severity:"critical",escalate_after_minutes:15,notification_channels:["email"],recipients:[]}]}}),{fields:c,append:i,remove:f}=oD({control:s,name:"rules"}),p=gt({mutationFn:y=>t?Us.escalationPolicies.update(t.id,y):Us.escalationPolicies.create(y),onSuccess:()=>{Me.success(t?"Policy updated":"Policy created"),r==null||r()},onError:y=>{Me.error(y.message)}}),g=y=>{if(!y.rules||y.rules.length===0){Me.error("Add at least one escalation rule");return}p.mutate(y)};return e.jsxs("form",{onSubmit:a(g),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"name",children:"Policy Name"}),e.jsx(Ie,{id:"name",placeholder:"e.g., Critical Priority Response",...n("name",{required:"Name is required"})}),o.name&&e.jsx("p",{className:"text-sm text-red-500",children:o.name.message})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(we,{className:"text-base font-semibold",children:"Escalation Rules"}),e.jsxs(K,{type:"button",variant:"outline",size:"sm",onClick:()=>i({severity:"high",escalate_after_minutes:30,notification_channels:["email"],recipients:[]}),children:[e.jsx(Mt,{className:"h-4 w-4 mr-1"}),"Add Rule"]})]}),e.jsx("div",{className:"space-y-3",children:c.map((y,b)=>e.jsx(kqe,{ruleIndex:b,onRemove:()=>f(b),register:n,control:s},y.id))})]}),e.jsx(K,{type:"submit",disabled:p.isPending,className:"w-full",children:p.isPending?"Saving...":t?"Update Policy":"Create Policy"})]})}function kqe({ruleIndex:t,onRemove:r,register:s,control:n}){const{append:a,replace:o}=oD({control:n,name:`rules.${t}.recipients`}),[c,i]=A.useState(!1),{data:f=[],isLoading:p}=it({queryKey:["supervisors"],queryFn:Pqe}),y=OG({control:n,name:`rules.${t}.recipients`})||[],b=y.filter(M=>M.type==="user").map(M=>parseInt(M.target)),w=M=>{if(b.includes(M.id)){const C=y.filter(D=>!(D.type==="user"&&parseInt(D.target)===M.id));o(C)}else a({type:"user",target:String(M.id),name:M.name})},T=["critical","high","medium","low"],N=["email","sms","webhook","push"];return e.jsx(H,{className:"border bg-muted/30",children:e.jsx(X,{className:"p-4 space-y-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{className:"text-sm",children:"Severity"}),e.jsx("select",{...s(`rules.${t}.severity`),className:"w-full rounded border border-input bg-background px-3 py-2 text-sm",children:T.map(M=>e.jsx("option",{value:M,children:M.charAt(0).toUpperCase()+M.slice(1)},M))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{className:"text-sm",children:"Escalate After (min)"}),e.jsx(Ie,{type:"number",min:"1",...s(`rules.${t}.escalate_after_minutes`,{required:!0,valueAsNumber:!0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{className:"text-sm",children:"Repeat Every (min)"}),e.jsx(Ie,{type:"number",min:"15",placeholder:"Optional",...s(`rules.${t}.repeat_every_minutes`,{valueAsNumber:!0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{className:"text-sm",children:"Notification Channels"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:N.map(M=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",value:M,...s(`rules.${t}.notification_channels`),className:"rounded"}),e.jsx("span",{className:"text-sm",children:M.charAt(0).toUpperCase()+M.slice(1)})]},M))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(we,{className:"text-sm",children:"Supervisors to Notify"}),e.jsx(K,{type:"button",variant:"outline",size:"sm",onClick:()=>i(!c),children:c?"Done":"Select Supervisors"})]}),c&&e.jsx("div",{className:"border rounded-lg p-3 bg-background max-h-48 overflow-y-auto",children:p?e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(as,{className:"h-4 w-4 animate-spin"}),"Loading supervisors..."]}):f.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No supervisors found"}):e.jsx("div",{className:"space-y-1",children:f.map(M=>{const O=b.includes(M.id);return e.jsxs("div",{onClick:()=>w(M),className:`flex items-center justify-between p-2 rounded cursor-pointer transition-colors ${O?"bg-primary/10 border border-primary":"hover:bg-muted"}`,children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:M.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:M.email})]}),O&&e.jsx(Kc,{className:"h-4 w-4 text-primary"})]},M.id)})})}),b.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 pt-2",children:y.filter(M=>M.type==="user").map((M,O)=>e.jsxs(Ae,{variant:"secondary",className:"gap-1 pr-1",children:[M.name||`User #${M.target}`,e.jsx("button",{type:"button",onClick:()=>{const C=y.filter(D=>!(D.type==="user"&&D.target===M.target));o(C)},className:"ml-1 hover:bg-destructive/20 rounded p-0.5",children:e.jsx(Ko,{className:"h-3 w-3"})})]},O))}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[b.length," supervisor",b.length!==1?"s":""," selected"]})]})]}),e.jsx(K,{type:"button",variant:"ghost",size:"sm",onClick:r,className:"text-destructive hover:text-destructive",children:e.jsx(Ws,{className:"h-4 w-4"})})]})})})}function Aqe(){const t=yr(),[r,s]=A.useState(""),[n,a]=A.useState(!1),[o,c]=A.useState(null),{data:i,isLoading:f,error:p}=it({queryKey:["escalation-policies",r],queryFn:()=>Us.escalationPolicies.list({search:r||void 0,per_page:50})}),g=gt({mutationFn:w=>Us.escalationPolicies.delete(w),onSuccess:()=>{t.invalidateQueries({queryKey:["escalation-policies"]})}}),y=(i==null?void 0:i.data)||[],b=w=>{switch(w){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-gray-100 text-gray-800";default:return"outline"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Escalation Policies"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Define SLA escalation rules and notification recipients"})]}),e.jsxs(Qt,{open:n,onOpenChange:a,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Policy"]})}),e.jsxs(Zt,{className:"max-w-2xl",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Create Escalation Policy"}),e.jsx(Es,{children:"Define notification rules for event escalation by severity"})]}),e.jsx(V8,{onSuccess:()=>{a(!1),t.invalidateQueries({queryKey:["escalation-policies"]})}})]})]})]}),e.jsx(Ie,{placeholder:"Search policies...",value:r,onChange:w=>s(w.target.value),className:"max-w-sm"}),f?e.jsx(H,{children:e.jsx(X,{className:"p-8 text-center text-muted-foreground",children:"Loading policies..."})}):p?e.jsxs(zn,{variant:"destructive",children:[e.jsx(Fr,{className:"h-4 w-4"}),e.jsxs(An,{children:["Error loading policies: ",p.message]})]}):y.length===0?e.jsx(H,{children:e.jsx(X,{className:"p-8 text-center text-muted-foreground",children:"No escalation policies found. Create one to get started!"})}):e.jsx("div",{className:"grid gap-4",children:y.map(w=>{var T;return e.jsx(H,{className:"hover:shadow-md transition-shadow",children:e.jsx(X,{className:"p-6",children:e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:w.name}),e.jsx("div",{className:"space-y-3",children:(T=w.rules)==null?void 0:T.map((N,M)=>{var O,C;return e.jsx("div",{className:"p-3 rounded-lg bg-muted/50 border border-muted",children:e.jsx("div",{className:"flex items-start justify-between gap-3",children:e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:b(N.severity),children:N.severity}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Escalate after ",N.escalate_after_minutes," min"]}),N.repeat_every_minutes&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(Repeat every ",N.repeat_every_minutes," min)"]})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-muted-foreground mb-1",children:"Channels:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:(O=N.notification_channels)==null?void 0:O.map(D=>e.jsx(Ae,{variant:"outline",className:"text-xs",children:D},D))})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-muted-foreground mb-1",children:"Recipients:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(C=N.recipients)==null?void 0:C.map((D,L)=>e.jsxs("div",{className:"text-xs bg-background rounded px-2 py-1 border",children:[D.type,": ",D.target]},L))})]})]})})},M)})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Qt,{children:[e.jsx(qr,{asChild:!0,children:e.jsx(K,{variant:"outline",size:"sm",children:e.jsx(k_,{className:"h-4 w-4"})})}),e.jsxs(Zt,{className:"max-w-2xl",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Edit Escalation Policy"})}),e.jsx(V8,{initialPolicy:w,onSuccess:()=>{t.invalidateQueries({queryKey:["escalation-policies"]})}})]})]}),e.jsx(K,{variant:"destructive",size:"sm",onClick:()=>g.mutate(w.id),disabled:g.isPending,children:e.jsx(Ws,{className:"h-4 w-4"})})]})]})})},w.id)})})]})}function Tqe(){const[t,r]=A.useState("assets"),s=[{assetId:"pump_001",failureProbability:87,daysToFailure:8,confidence:.92,riskLevel:"high",recommendedAction:"schedule_maintenance_today"},{assetId:"pump_003",failureProbability:62,daysToFailure:21,confidence:.85,riskLevel:"medium",recommendedAction:"monitor_closely"},{assetId:"motor_005",failureProbability:45,daysToFailure:35,confidence:.78,riskLevel:"medium",recommendedAction:"plan_maintenance_next_month"}],n=[{dmaId:"dma_001",nrwPercentage:35.2,baselineNrw:28.5,anomalyScore:.87,leakDetected:!0,estimatedLossMc:450,estimatedCostPerDay:2250,urgency:"high"}],a=[{date:"2025-12-01",demand:1200,lower:1050,upper:1350},{date:"2025-12-02",demand:1350,lower:1180,upper:1520},{date:"2025-12-03",demand:1100,lower:950,upper:1250},{date:"2025-12-04",demand:1280,lower:1120,upper:1440}],o=[{pumpId:"pump_001",startTime:"22:00",endTime:"04:00",reason:"off_peak_tariff",estimatedCost:450},{pumpId:"pump_002",startTime:"08:00",endTime:"10:00",reason:"peak_demand",estimatedCost:180}],c={affectedConnections:1240,affectedPopulation:6200,impactScore:72,suggestedTiming:"2025-12-22 midnight (Sunday, lower demand)"},i=p=>p>=80?"text-red-600 bg-red-50":p>=60?"text-orange-600 bg-orange-50":"text-yellow-600 bg-yellow-50",f=p=>{switch(p){case"critical":return"text-red-600 bg-red-50";case"high":return"text-orange-600 bg-orange-50";case"medium":return"text-yellow-600 bg-yellow-50";default:return"text-blue-600 bg-blue-50"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Predictive Analytics"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"AI-powered insights for proactive operations management"})]})}),e.jsxs(ss,{value:t,onValueChange:p=>r(p),className:"w-full",children:[e.jsxs(Yr,{className:"grid w-full grid-cols-5",children:[e.jsxs(wt,{value:"assets",children:[e.jsx(Fr,{className:"w-4 h-4 mr-2"}),"Asset Health"]}),e.jsxs(wt,{value:"nrw",children:[e.jsx(Nn,{className:"w-4 h-4 mr-2"}),"NRW Anomalies"]}),e.jsxs(wt,{value:"demand",children:[e.jsx(zs,{className:"w-4 h-4 mr-2"}),"Demand"]}),e.jsxs(wt,{value:"schedule",children:[e.jsx(Ta,{className:"w-4 h-4 mr-2"}),"Schedules"]}),e.jsxs(wt,{value:"outage",children:[e.jsx(Nn,{className:"w-4 h-4 mr-2"}),"Outage Impact"]})]}),e.jsx(kt,{value:"assets",className:"space-y-4",children:e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Asset Failure Predictions"}),e.jsx(mr,{children:"Predicted pump and equipment failures based on telemetry patterns"})]}),e.jsx(X,{children:e.jsx("div",{className:"space-y-3",children:s.map(p=>e.jsxs("div",{className:`p-4 rounded-lg border ${i(p.failureProbability)}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:p.assetId}),e.jsxs("p",{className:"text-sm opacity-75",children:[p.daysToFailure," days to likely failure"]})]}),e.jsxs("span",{className:"text-xl font-bold",children:[p.failureProbability,"%"]})]}),e.jsxs("p",{className:"text-sm mb-2",children:[e.jsx("span",{className:"font-medium",children:"Action:"})," ",p.recommendedAction]}),e.jsxs("p",{className:"text-xs opacity-75",children:["Confidence: ",Math.round(p.confidence*100),"%"]})]},p.assetId))})})]})}),e.jsx(kt,{value:"nrw",className:"space-y-4",children:e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"NRW Anomaly Detection"}),e.jsx(mr,{children:"Detected unusual water loss patterns indicating potential leaks"})]}),e.jsx(X,{children:e.jsx("div",{className:"space-y-3",children:n.map(p=>e.jsxs("div",{className:`p-4 rounded-lg border ${f(p.urgency)}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:p.dmaId}),e.jsx("p",{className:"text-sm opacity-75",children:"Leak Detected"})]}),e.jsxs("span",{className:"text-lg font-bold",children:[p.nrwPercentage.toFixed(1),"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"opacity-75",children:"Baseline NRW"}),e.jsxs("p",{className:"font-medium",children:[p.baselineNrw.toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-75",children:"Loss/Day"}),e.jsxs("p",{className:"font-medium",children:[p.estimatedLossMc," m"]})]})]}),e.jsxs("p",{className:"text-sm font-medium",children:["Cost: KES ",p.estimatedCostPerDay.toLocaleString(),"/day"]})]},p.dmaId))})})]})}),e.jsx(kt,{value:"demand",className:"space-y-4",children:e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"7-Day Demand Forecast"}),e.jsx(mr,{children:"Predicted water consumption with confidence intervals"})]}),e.jsx(X,{children:e.jsx("div",{className:"space-y-3",children:a.map(p=>e.jsxs("div",{className:"p-4 rounded-lg border border-blue-200 bg-blue-50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{children:e.jsx("h3",{className:"font-semibold text-gray-900",children:p.date})}),e.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[p.demand," m"]})]}),e.jsx("div",{className:"w-full bg-gray-200 h-2 rounded-full relative",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${(p.demand-p.lower)/(p.upper-p.lower)*100}%`}})}),e.jsxs("p",{className:"text-xs opacity-75 mt-1",children:["Range: ",p.lower," - ",p.upper," m"]})]},p.date))})})]})}),e.jsx(kt,{value:"schedule",className:"space-y-4",children:e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Pump Schedule Optimizer"}),e.jsx(mr,{children:"Recommended pump operation times to minimize energy costs"})]}),e.jsx(X,{children:e.jsx("div",{className:"space-y-3",children:o.map(p=>e.jsxs("div",{className:"p-4 rounded-lg border border-green-200 bg-green-50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:p.pumpId}),e.jsxs("p",{className:"text-sm opacity-75",children:[p.startTime," - ",p.endTime]})]}),e.jsxs("span",{className:"text-lg font-bold text-green-600",children:["KES ",p.estimatedCost]})]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Reason:"})," ",p.reason]})]},p.pumpId))})})]})}),e.jsx(kt,{value:"outage",className:"space-y-4",children:e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Outage Impact Prediction"}),e.jsx(mr,{children:"Predicted customer impact from scheduled outages"})]}),e.jsx(X,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"p-4 rounded-lg border border-orange-200 bg-orange-50",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Current Outage Plan"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-75",children:"Affected Connections"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.affectedConnections.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-75",children:"Affected Population"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.affectedPopulation.toLocaleString()})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm opacity-75",children:"Impact Score"}),e.jsx("div",{className:"w-full bg-gray-200 h-2 rounded-full mt-1",children:e.jsx("div",{className:"h-full bg-orange-500 rounded-full",style:{width:`${c.impactScore}%`}})}),e.jsxs("p",{className:"text-sm font-medium mt-1",children:[c.impactScore," / 100"]})]}),e.jsxs("div",{className:"p-3 bg-white rounded border border-orange-300",children:[e.jsx("p",{className:"text-sm opacity-75",children:"Suggested Alternative Timing"}),e.jsx("p",{className:"font-semibold text-gray-900",children:c.suggestedTiming})]})]})})})]})})]})]})}function Eqe(){const t=yr(),[r,s]=A.useState(""),[n,a]=A.useState(!1),[o,c]=A.useState({key:"",name:"",spec:""}),{data:i,isLoading:f}=it({queryKey:["workflow-definitions"],queryFn:()=>pe.get("/workflows/definitions")}),p=gt({mutationFn:w=>pe.post("/workflows/definitions",w),onSuccess:()=>{Me.success("Workflow created"),t.invalidateQueries({queryKey:["workflow-definitions"]}),a(!1)}}),g=gt({mutationFn:w=>pe.post(`/workflows/definitions/${w}/activate`,{}),onSuccess:()=>{t.invalidateQueries({queryKey:["workflow-definitions"]})}}),y=gt({mutationFn:w=>pe.delete(`/workflows/definitions/${w}`),onSuccess:()=>{t.invalidateQueries({queryKey:["workflow-definitions"]})}}),b=(i==null?void 0:i.data)||[];return e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Workflow Definitions"}),e.jsx("p",{className:"text-muted-foreground max-w-2xl",children:"Define automated workflows as code to automate business processes. Create state machines that define how work progresses through different states, with automatic actions, SLA tracking, and escalation rules. Templates are available for Work Orders, Incidents, Complaints, Procurement, and more."})]}),e.jsxs(Qt,{open:n,onOpenChange:a,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Workflow"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Create Workflow Definition"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Key"}),e.jsx(Ie,{placeholder:"work_order.v1",value:o.key,onChange:w=>c({...o,key:w.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Name"}),e.jsx(Ie,{placeholder:"Work Order Workflow",value:o.name,onChange:w=>c({...o,name:w.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Spec (JSON)"}),e.jsx("textarea",{className:"w-full rounded border p-2 font-mono text-sm",rows:6,placeholder:'{"key":"work_order.v1","states":[{"name":"new"}]}',value:o.spec,onChange:w=>c({...o,spec:w.target.value})})]}),e.jsx(K,{onClick:()=>p.mutate({...o,spec:JSON.parse(o.spec)}),disabled:p.isPending,className:"w-full",children:"Create"})]})]})]})]}),e.jsx(Ie,{placeholder:"Search workflows...",value:r,onChange:w=>s(w.target.value),className:"max-w-sm"}),f?e.jsx("p",{children:"Loading..."}):e.jsx("div",{className:"grid gap-4",children:b.map(w=>e.jsx(H,{children:e.jsx(X,{className:"p-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:w.name}),w.active?e.jsx(Ae,{className:"bg-green-100 text-green-800",children:"Active"}):e.jsx(Ae,{variant:"outline",children:"Inactive"}),e.jsxs(Ae,{variant:"secondary",children:["v",w.version]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:w.key})]}),e.jsxs("div",{className:"flex gap-2",children:[!w.active&&e.jsx(K,{size:"sm",variant:"outline",onClick:()=>g.mutate(w.id),children:e.jsx(Ns,{className:"h-4 w-4"})}),e.jsx(K,{size:"sm",variant:"outline",onClick:()=>window.location.href=`/workflows/definitions/${w.id}`,children:e.jsx(k_,{className:"h-4 w-4"})}),e.jsx(K,{size:"sm",variant:"destructive",onClick:()=>y.mutate(w.id),children:e.jsx(Ws,{className:"h-4 w-4"})})]})]})})},w.id))})]})}function Mqe(){const t=yr(),[r,s]=A.useState(""),[n,a]=A.useState(""),{data:o,isLoading:c}=it({queryKey:["workflow-instances",r,n],queryFn:()=>pe.get("/workflows/instances",{state:r||void 0,entity_type:n||void 0})}),i=gt({mutationFn:g=>pe.post(`/workflows/instances/${g.id}/trigger`,{trigger:g.trigger}),onSuccess:()=>{Me.success("Triggered successfully"),t.invalidateQueries({queryKey:["workflow-instances"]})}}),f=(o==null?void 0:o.data)||[],p=g=>({new:"bg-blue-100 text-blue-800",assigned:"bg-yellow-100 text-yellow-800",in_progress:"bg-purple-100 text-purple-800",done:"bg-green-100 text-green-800",closed:"bg-gray-100 text-gray-800"})[g]||"outline";return e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Workflow Instances"}),e.jsx("p",{className:"text-muted-foreground mt-2 max-w-2xl",children:"Monitor running workflow instances in real-time. Track the progress of Work Orders, Incidents, Complaints, Procurement requests, and other business entities as they move through defined workflow states. Manually trigger transitions, check SLA compliance, and view the complete audit trail of all state changes."})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(Ie,{placeholder:"Filter by state...",value:r,onChange:g=>s(g.target.value),className:"max-w-sm"}),e.jsx(Ie,{placeholder:"Filter by entity type...",value:n,onChange:g=>a(g.target.value),className:"max-w-sm"})]}),c?e.jsx("p",{children:"Loading..."}):f.length===0?e.jsx(H,{children:e.jsx(X,{className:"p-8 text-center text-muted-foreground",children:"No instances found"})}):e.jsx("div",{className:"space-y-4",children:f.map(g=>e.jsx(H,{children:e.jsx(X,{className:"p-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("h3",{className:"font-semibold",children:[g.entity_type," #",g.entity_id]}),e.jsx(Ae,{className:p(g.state),children:g.state})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Started: ",Ur(new Date(g.started_at),"MMM dd, yyyy HH:mm")]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{size:"sm",onClick:()=>i.mutate({id:g.id,trigger:"proceed"}),disabled:i.isPending,children:"Proceed"}),e.jsx(K,{size:"sm",variant:"outline",onClick:()=>window.location.href=`/workflows/instances/${g.id}`,children:"Details"})]})]})})},g.id))})]})}function Oqe(){const t=yr(),[r,s]=A.useState(!1),[n,a]=A.useState({operatorId:"",topic:"operation",score:""}),[o,c]=A.useState(1),i=6,{data:f,isLoading:p}=it({queryKey:["capacity-assessments",o],queryFn:()=>pe.get("/training/assessments")}),g=gt({mutationFn:T=>pe.post("/training/assessments",T),onSuccess:()=>{Me.success("Assessment recorded"),t.invalidateQueries({queryKey:["capacity-assessments"]}),s(!1)}}),y=(f==null?void 0:f.data)||[],b=(T,N)=>T==="pending"?"bg-gray-100 text-gray-800":N?"bg-green-100 text-green-800":"bg-red-100 text-red-800",w={totalOperators:245,certified:189,pendingReview:32,needsTraining:24};return e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Operator Capacity Assessment"}),e.jsx("p",{className:"text-muted-foreground",children:"Evaluate and certify water system operators. Track competency assessments, certification validity, and training needs."})]}),e.jsxs(Qt,{open:r,onOpenChange:s,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Assessment"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Record Assessment"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Operator ID"}),e.jsx(Ie,{placeholder:"ID or phone number",value:n.operatorId,onChange:T=>a({...n,operatorId:T.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Assessment Topic"}),e.jsxs("select",{className:"w-full rounded border p-2",value:n.topic,onChange:T=>a({...n,topic:T.target.value}),children:[e.jsx("option",{value:"operation",children:"System Operation"}),e.jsx("option",{value:"maintenance",children:"Preventive Maintenance"}),e.jsx("option",{value:"safety",children:"Safety & HSE"}),e.jsx("option",{value:"billing",children:"Tariff & Billing"}),e.jsx("option",{value:"customer",children:"Customer Service"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Score (0-100)"}),e.jsx(Ie,{type:"number",min:"0",max:"100",value:n.score,onChange:T=>a({...n,score:T.target.value})})]}),e.jsx(K,{onClick:()=>g.mutate({operatorId:n.operatorId,topic:n.topic,score:parseInt(n.score)}),disabled:g.isPending,className:"w-full",children:"Record Assessment"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsx(he,{className:"text-sm font-medium",children:"Total Operators"})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-3xl font-bold",children:w.totalOperators}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Across all schemes"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Zl,{className:"h-4 w-4 text-green-600"})," Certified"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:w.certified}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[Math.round(w.certified/w.totalOperators*100),"% of total"]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Nn,{className:"h-4 w-4 text-yellow-600"})," Pending"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-600",children:w.pendingReview}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Under review"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Nn,{className:"h-4 w-4 text-red-600"})," Training Needed"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-3xl font-bold text-red-600",children:w.needsTraining}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Not yet certified"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(he,{children:"Recent Assessments"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[y.length," assessments"]})]})}),e.jsxs(X,{children:[e.jsx(qm,{className:"h-[500px] pr-4",children:e.jsx("div",{className:"space-y-4",children:p?e.jsx("p",{children:"Loading assessments..."}):y.slice((o-1)*i,o*i).map(T=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:T.operatorName}),e.jsx("p",{className:"text-sm text-muted-foreground",children:T.topic})]}),e.jsx(Ae,{className:b(T.status,T.certificationValid),children:T.certificationValid?"CERTIFIED":"PENDING"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["Score: ",T.score,"/",T.maxScore]}),e.jsxs("span",{className:"font-semibold",children:[Math.round(T.score/T.maxScore*100),"%"]})]}),e.jsx(Wi,{value:T.score/T.maxScore*100})]}),T.validUntil&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Cert valid until: ",T.validUntil]})]},T.id))})}),y.length>i&&e.jsxs("div",{className:"flex justify-between items-center mt-6 pt-4 border-t",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Page ",o," of ",Math.ceil(y.length/i)]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{variant:"outline",size:"sm",onClick:()=>c(Math.max(1,o-1)),disabled:o===1,children:e.jsx(vC,{className:"h-4 w-4"})}),e.jsx(K,{variant:"outline",size:"sm",onClick:()=>c(Math.min(Math.ceil(y.length/i),o+1)),disabled:o>=Math.ceil(y.length/i),children:e.jsx($u,{className:"h-4 w-4"})})]})]})]})]})]})}function Iqe(){var re;const t=yr(),{tenant:r}=Lm(),[s,n]=A.useState(!1),[a,o]=A.useState(null),[c,i]=A.useState({name:"",safeYield:"",county:"",aquiferType:"Alluvial"}),[f,p]=A.useState(1),[g,y]=A.useState(""),[b,w]=A.useState("all"),T=5;A.useEffect(()=>{r!=null&&r.county&&i(Z=>({...Z,county:r.county}))},[r==null?void 0:r.county]);const{data:N,isLoading:M}=it({queryKey:["aquifers",f],queryFn:()=>pe.get("/hydromet/aquifers")}),{data:O}=it({queryKey:["aquifer-monitoring",a==null?void 0:a.id],queryFn:()=>pe.get(`/hydromet/aquifers/${a==null?void 0:a.id}/monitoring`),enabled:!!a}),C=gt({mutationFn:Z=>pe.post("/hydromet/aquifers",Z),onSuccess:()=>{Me.success("Aquifer registered successfully"),t.invalidateQueries({queryKey:["aquifers"]}),n(!1),i({name:"",safeYield:"",county:(r==null?void 0:r.county)||"",aquiferType:"Alluvial"})},onError:()=>{Me.error("Failed to register aquifer")}}),D=(N==null?void 0:N.data)||[],L=(O==null?void 0:O.data)||[],F=D.filter(Z=>{const ne=Z.name.toLowerCase().includes(g.toLowerCase())||Z.county&&Z.county.toLowerCase().includes(g.toLowerCase()),oe=b==="all"||Z.riskLevel===b;return ne&&oe}),B=Z=>Z==="critical"?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400":Z==="high"?"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400":Z==="medium"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",U=Z=>Z==="Excellent"?"text-green-600 dark:text-green-400":Z==="Good"?"text-blue-600 dark:text-blue-400":Z==="Fair"?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400",te={totalAquifers:D.length,atRisk:D.filter(Z=>Z.riskLevel==="high"||Z.riskLevel==="critical").length,totalSafeYield:D.reduce((Z,ne)=>Z+(ne.safeYieldMcm||0),0),totalCurrent:D.reduce((Z,ne)=>Z+(ne.currentYieldMcm||0),0),totalBoreholes:D.reduce((Z,ne)=>Z+(ne.boreholes||0),0),totalArea:D.reduce((Z,ne)=>Z+(ne.areaKm2||0),0)},Q=te.totalSafeYield>0?Math.round(te.totalCurrent/te.totalSafeYield*100):0;return e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Aquifer Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor groundwater resources, track sustainable yield, recharge rates, and aquifer health across ASAL counties."})]}),e.jsxs(Qt,{open:s,onOpenChange:n,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"Register Aquifer"]})}),e.jsxs(Zt,{children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Register New Aquifer"}),e.jsx(Es,{children:"Add a new aquifer to the monitoring system"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg flex items-center gap-2",children:[e.jsx($p,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Registering for"}),e.jsx("p",{className:"font-medium",children:(r==null?void 0:r.name)||"Current Tenant"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Aquifer Name"}),e.jsx(Ie,{placeholder:"e.g., Elwak Aquifer",value:c.name,onChange:Z=>i({...c,name:Z.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"County"}),e.jsx(Ie,{value:c.county||(r==null?void 0:r.county)||"",disabled:!0,className:"bg-muted"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Auto-populated from tenant"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Aquifer Type"}),e.jsxs(Nt,{value:c.aquiferType,onValueChange:Z=>i({...c,aquiferType:Z}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"Alluvial",children:"Alluvial"}),e.jsx(ge,{value:"Basement",children:"Basement"}),e.jsx(ge,{value:"Sedimentary",children:"Sedimentary"}),e.jsx(ge,{value:"Volcanic",children:"Volcanic"}),e.jsx(ge,{value:"Coastal",children:"Coastal"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Safe Yield (MCM/year)"}),e.jsx(Ie,{type:"number",placeholder:"Annual sustainable yield",value:c.safeYield,onChange:Z=>i({...c,safeYield:Z.target.value})})]}),e.jsx(K,{onClick:()=>C.mutate({name:c.name,safeYieldMcm:parseInt(c.safeYield),county:c.county,aquiferType:c.aquiferType}),disabled:C.isPending||!c.name||!c.safeYield,className:"w-full",children:C.isPending?"Registering...":"Register Aquifer"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Si,{className:"h-4 w-4 text-blue-500"}),"Aquifers"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:te.totalAquifers}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Under management"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ci,{className:"h-4 w-4 text-cyan-500"}),"Safe Yield"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:te.totalSafeYield}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"MCM/year total"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ni,{className:"h-4 w-4 text-purple-500"}),"Abstraction"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:te.totalCurrent}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[Q,"% utilization"]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Fr,{className:"h-4 w-4 text-red-500"}),"At Risk"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:te.atRisk}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"High/Critical stress"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(cv,{className:"h-4 w-4 text-amber-500"}),"Boreholes"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:te.totalBoreholes}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active wells"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(fn,{className:"h-4 w-4 text-green-500"}),"Coverage"]})}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[(te.totalArea/1e3).toFixed(0),"K"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"km total area"})]})]})]}),e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search by name or county...",value:g,onChange:Z=>y(Z.target.value),className:"pl-10"})]}),e.jsxs(Nt,{value:b,onValueChange:w,children:[e.jsx(bt,{className:"w-[180px]",children:e.jsx(St,{placeholder:"Filter by risk"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Risk Levels"}),e.jsx(ge,{value:"low",children:"Low Risk"}),e.jsx(ge,{value:"medium",children:"Medium Risk"}),e.jsx(ge,{value:"high",children:"High Risk"}),e.jsx(ge,{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(H,{className:"lg:col-span-2",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(he,{children:"Aquifer Status Overview"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[F.length," of ",D.length," aquifers"]})]})}),e.jsxs(X,{children:[e.jsx(qm,{className:"h-[500px] pr-4",children:e.jsx("div",{className:"space-y-4",children:M?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading aquifers..."})}):F.length===0?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"No aquifers found matching your criteria"})}):F.slice((f-1)*T,f*T).map(Z=>{var Ce;const ne=Z.safeYieldMcm>0?Z.currentYieldMcm/Z.safeYieldMcm*100:0,oe=(a==null?void 0:a.id)===Z.id;return e.jsxs("div",{className:`p-4 border rounded-lg cursor-pointer transition-all ${oe?"border-primary ring-1 ring-primary":"hover:border-muted-foreground/50"}`,onClick:()=>o(Z),children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-lg",children:Z.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(fn,{className:"h-3 w-3"}),Z.county||"Unknown County",e.jsx("span",{className:"text-muted-foreground/50",children:""}),e.jsx("span",{children:Z.aquiferType||"Unknown Type"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ae,{className:B(Z.riskLevel),children:(Ce=Z.riskLevel)==null?void 0:Ce.toUpperCase()}),e.jsx(Ae,{variant:"outline",className:U(Z.waterQualityStatus),children:Z.waterQualityStatus})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Safe Yield"}),e.jsxs("p",{className:"font-semibold",children:[Z.safeYieldMcm," MCM/yr"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Current"}),e.jsxs("p",{className:"font-semibold",children:[Z.currentYieldMcm," MCM/yr"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Recharge"}),e.jsxs("p",{className:"font-semibold",children:[Z.rechargeRateMcm," MCM/yr"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Depth"}),e.jsxs("p",{className:"font-semibold",children:[Z.depth_m||""," m"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{children:"Utilization Rate"}),e.jsxs("span",{className:`font-semibold ${ne>90?"text-red-600":ne>75?"text-yellow-600":"text-green-600"}`,children:[Math.round(ne),"%"]})]}),e.jsx(Wi,{value:Math.min(ne,100),className:ne>90?"[&>div]:bg-red-500":ne>75?"[&>div]:bg-yellow-500":""}),ne>80&&e.jsxs("p",{className:"text-xs text-red-600 mt-1 flex items-center gap-1",children:[e.jsx(Fr,{className:"h-3 w-3"}),"Exceeding safe yield threshold"]})]})]},Z.id)})})}),F.length>T&&e.jsxs("div",{className:"flex justify-between items-center mt-4 pt-4 border-t",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Page ",f," of ",Math.ceil(F.length/T)]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{variant:"outline",size:"sm",onClick:()=>p(Math.max(1,f-1)),disabled:f===1,children:e.jsx(vC,{className:"h-4 w-4"})}),e.jsx(K,{variant:"outline",size:"sm",onClick:()=>p(Math.min(Math.ceil(F.length/T),f+1)),disabled:f>=Math.ceil(F.length/T),children:e.jsx($u,{className:"h-4 w-4"})})]})]})]})]}),e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(Ni,{className:"h-5 w-5"}),"Monitoring Data"]}),e.jsx(mr,{children:a?a.name:"Select an aquifer to view monitoring data"})]}),e.jsxs(X,{children:[a?e.jsxs(ss,{defaultValue:"levels",children:[e.jsxs(Yr,{className:"grid w-full grid-cols-2",children:[e.jsx(wt,{value:"levels",children:"Water Levels"}),e.jsx(wt,{value:"balance",children:"Balance"})]}),e.jsx(kt,{value:"levels",className:"mt-4",children:e.jsx("div",{className:"h-[250px]",children:e.jsx(Ha,{width:"100%",height:"100%",children:e.jsxs(Km,{data:L,children:[e.jsx(Zi,{strokeDasharray:"3 3",className:"opacity-30"}),e.jsx(Ma,{dataKey:"date",tick:{fontSize:11}}),e.jsx(fa,{tick:{fontSize:11}}),e.jsx(_n,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))"}}),e.jsx(Ea,{}),e.jsx(ui,{type:"monotone",dataKey:"waterLevel_m",stroke:"#3b82f6",name:"Water Level (m)",strokeWidth:2,dot:{r:3}}),e.jsx(ui,{type:"monotone",dataKey:"quality_score",stroke:"#10b981",name:"Quality Score",strokeWidth:2,dot:{r:3}})]})})})}),e.jsx(kt,{value:"balance",className:"mt-4",children:e.jsx("div",{className:"h-[250px]",children:e.jsx(Ha,{width:"100%",height:"100%",children:e.jsxs(yR,{data:L,children:[e.jsx(Zi,{strokeDasharray:"3 3",className:"opacity-30"}),e.jsx(Ma,{dataKey:"date",tick:{fontSize:11}}),e.jsx(fa,{tick:{fontSize:11}}),e.jsx(_n,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))"}}),e.jsx(Ea,{}),e.jsx(Jl,{type:"monotone",dataKey:"abstraction_mcm",stackId:"1",stroke:"#ef4444",fill:"#ef4444",fillOpacity:.6,name:"Abstraction (MCM)"}),e.jsx(Jl,{type:"monotone",dataKey:"recharge_mcm",stackId:"2",stroke:"#22c55e",fill:"#22c55e",fillOpacity:.6,name:"Recharge (MCM)"})]})})})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] text-center",children:[e.jsx(mo,{className:"h-12 w-12 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Click on an aquifer card to view its monitoring data"})]}),a&&e.jsxs("div",{className:"mt-4 pt-4 border-t space-y-3",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Aquifer Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Area"}),e.jsxs("p",{className:"font-medium",children:[(re=a.areaKm2)==null?void 0:re.toLocaleString()," km"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Boreholes"}),e.jsx("p",{className:"font-medium",children:a.boreholes||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Aquifer Type"}),e.jsx("p",{className:"font-medium",children:a.aquiferType||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Last Assessment"}),e.jsx("p",{className:"font-medium",children:a.lastAssessment||"N/A"})]})]})]})]})]})]})]})}function Dqe(){var M;const t=yr(),[r,s]=A.useState(!1),[n,a]=A.useState({name:"",severity:"high"}),[o,c]=A.useState(1),i=4,{data:f,isLoading:p}=it({queryKey:["drought-events",o],queryFn:()=>pe.get("/core-ops/droughts")}),g=gt({mutationFn:O=>pe.post("/core-ops/droughts",O),onSuccess:()=>{Me.success("Drought event declared"),t.invalidateQueries({queryKey:["drought-events"]}),s(!1)}}),y=gt({mutationFn:O=>pe.post(`/core-ops/droughts/${O}/activate`,{}),onSuccess:()=>{Me.success("Emergency response activated"),t.invalidateQueries({queryKey:["drought-events"]})}}),b=(f==null?void 0:f.data)||[],w=b.find(O=>O.status==="active"),T=O=>O==="critical"?"bg-red-100 text-red-800 border-red-300":O==="high"?"bg-orange-100 text-orange-800 border-orange-300":"bg-yellow-100 text-yellow-800 border-yellow-300",N={declared:b.filter(O=>O.status==="declared").length,active:b.filter(O=>O.status==="active").length,resolved:b.filter(O=>O.status==="resolved").length,totalPopulation:b.reduce((O,C)=>O+(C.affectedPopulation||0),0)};return e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Drought Response Center"}),e.jsx("p",{className:"text-muted-foreground",children:"Rapidly mobilize emergency boreholes and water sources during drought. Coordinate strategic borehole activation, track affected populations, and manage water rationing."})]}),e.jsxs(Qt,{open:r,onOpenChange:s,children:[e.jsx(qr,{asChild:!0,children:e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"Declare Drought"]})}),e.jsxs(Zt,{children:[e.jsx(Yt,{children:e.jsx(Xt,{children:"Declare Drought Event"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Event Name"}),e.jsx(Ie,{placeholder:"e.g., 2025 ASAL Drought - Jan-Mar",value:n.name,onChange:O=>a({...n,name:O.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Severity Level"}),e.jsxs("select",{className:"w-full rounded border p-2",value:n.severity,onChange:O=>a({...n,severity:O.target.value}),children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]})]}),e.jsx(K,{onClick:()=>g.mutate({name:n.name,severity:n.severity}),disabled:g.isPending,className:"w-full",children:"Declare Drought"})]})]})]})]}),w&&e.jsxs(zn,{className:`border-2 ${T(w.severity)}`,children:[e.jsx(Fr,{className:"h-4 w-4"}),e.jsxs(An,{children:[e.jsx("strong",{children:"Active Drought Event:"})," ",w.name," (",w.severity.toUpperCase(),") - ",(M=w.affectedPopulation)==null?void 0:M.toLocaleString()," people affected."," ",e.jsx("strong",{children:w.activatedBoreholes})," emergency boreholes activated."]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsx(he,{className:"text-sm font-medium",children:"Drought Events Declared"})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-3xl font-bold",children:N.declared}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"On record"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ta,{className:"h-4 w-4 text-red-600"})," Active Events"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-3xl font-bold text-red-600",children:N.active}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Ongoing responses"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsx(he,{className:"text-sm font-medium",children:"Affected Population"})}),e.jsxs(X,{children:[e.jsxs("div",{className:"text-3xl font-bold",children:[(N.totalPopulation/1e3).toFixed(0),"K"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Across all events"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsx(he,{className:"text-sm font-medium",children:"Resolved Events"})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-3xl font-bold",children:N.resolved}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Completed"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(he,{children:"Drought Events & Response Status"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[b.length," events"]})]})}),e.jsxs(X,{children:[e.jsx(qm,{className:"h-[550px] pr-4",children:e.jsx("div",{className:"space-y-4",children:p?e.jsx("p",{children:"Loading drought events..."}):b.slice((o-1)*i,o*i).map(O=>e.jsxs("div",{className:`p-4 border-2 rounded-lg ${T(O.severity)}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-lg",children:O.name}),e.jsxs("p",{className:"text-sm",children:["Started: ",new Date(O.startDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ae,{children:O.status.toUpperCase()}),O.waterRationing&&e.jsx(Ae,{variant:"destructive",children:"RATIONING"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Affected Population"}),e.jsxs("p",{className:"text-2xl font-bold",children:[(O.affectedPopulation/1e3).toFixed(0),"K"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Emergency Boreholes"}),e.jsx("p",{className:"text-2xl font-bold",children:O.activatedBoreholes})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Response Status"}),e.jsx("p",{className:"text-sm font-semibold",children:O.status==="declared"?"Preparing":"Active"})]})]}),O.status==="declared"&&e.jsxs(K,{size:"sm",onClick:()=>y.mutate(O.id),disabled:y.isPending,className:"w-full",children:[e.jsx(Ta,{className:"h-4 w-4 mr-2"}),"Activate Emergency Response"]})]},O.id))})}),b.length>i&&e.jsxs("div",{className:"flex justify-between items-center mt-6 pt-4 border-t",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Page ",o," of ",Math.ceil(b.length/i)]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{variant:"outline",size:"sm",onClick:()=>c(Math.max(1,o-1)),disabled:o===1,children:e.jsx(vC,{className:"h-4 w-4"})}),e.jsx(K,{variant:"outline",size:"sm",onClick:()=>c(Math.min(Math.ceil(b.length/i),o+1)),disabled:o>=Math.ceil(b.length/i),children:e.jsx($u,{className:"h-4 w-4"})})]})]})]})]})]})}function Rqe(){const{data:t,isLoading:r}=it({queryKey:["gender-equity"],queryFn:()=>pe.get("/me/gender-equity")}),s=(t==null?void 0:t.data)||[],n={women:s.filter(f=>f.gender==="female").length,men:s.filter(f=>f.gender==="male").length,youth:s.filter(f=>f.gender==="youth").length,elderly:s.filter(f=>f.gender==="elderly").length},a=[{name:"Women",value:n.women},{name:"Men",value:n.men}],o=[{name:"Youth (18-35)",value:n.youth},{name:"Elderly (60+)",value:n.elderly}],c=[{category:"Women","Water Hours/Day":12,"Collection Time (min)":45},{category:"Men","Water Hours/Day":15,"Collection Time (min)":15},{category:"Youth","Water Hours/Day":14,"Collection Time (min)":25}],i=["#ef4444","#f97316","#eab308","#22c55e"];return e.jsx(qm,{className:"h-screen",children:e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Gender & Equity Reporting"}),e.jsx("p",{className:"text-muted-foreground max-w-2xl",children:"Track water service access and equity outcomes across gender groups and vulnerable populations. Monitor water availability, collection burden, and satisfaction across different demographics."})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ds,{className:"h-4 w-4"})," Women Served"]})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-3xl font-bold",children:n.women}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Households tracked"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsx(he,{className:"text-sm font-medium",children:"Men Served"})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-3xl font-bold",children:n.men}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Households tracked"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsx(he,{className:"text-sm font-medium",children:"Youth (18-35)"})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-3xl font-bold",children:n.youth}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Beneficiaries"})]})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsx(he,{className:"text-sm font-medium",children:"Elderly (60+)"})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-3xl font-bold",children:n.elderly}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Beneficiaries"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Gender Distribution"})}),e.jsx(X,{children:e.jsx(Ha,{width:"100%",height:300,children:e.jsxs(T8,{children:[e.jsx(Od,{data:a,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,children:a.map((f,p)=>e.jsx(Rb,{fill:i[p]},`cell-${p}`))}),e.jsx(_n,{}),e.jsx(Ea,{})]})})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Vulnerable Groups"})}),e.jsx(X,{children:e.jsx(Ha,{width:"100%",height:300,children:e.jsxs(T8,{children:[e.jsx(Od,{data:o,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,children:o.map((f,p)=>e.jsx(Rb,{fill:i[p+2]},`cell-${p}`))}),e.jsx(_n,{}),e.jsx(Ea,{})]})})})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Water Access & Collection Burden by Gender"})}),e.jsxs(X,{children:[e.jsx(Ha,{width:"100%",height:300,children:e.jsxs(tv,{data:c,children:[e.jsx(Zi,{strokeDasharray:"3 3"}),e.jsx(Ma,{dataKey:"category"}),e.jsx(fa,{yAxisId:"left",label:{value:"Hours/Day",angle:-90,position:"insideLeft"}}),e.jsx(fa,{yAxisId:"right",orientation:"right",label:{value:"Minutes",angle:90,position:"insideRight"}}),e.jsx(_n,{}),e.jsx(Ea,{}),e.jsx(uo,{yAxisId:"left",dataKey:"Water Hours/Day",fill:"#3b82f6"}),e.jsx(uo,{yAxisId:"right",dataKey:"Collection Time (min)",fill:"#ef4444"})]})}),e.jsx("div",{className:"mt-6 p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Key Finding:"})," Women spend 3x longer collecting water compared to men (45 vs 15 minutes). This burden is a barrier to school attendance and economic activity."]})})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Recommendations"})}),e.jsx(X,{children:e.jsxs("ul",{className:"space-y-3 text-sm",children:[e.jsxs("li",{className:"flex gap-3",children:[e.jsx(zs,{className:"h-4 w-4 text-green-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:"Prioritize household connections in high-collection-burden areas to reduce women's water collection time"})]}),e.jsxs("li",{className:"flex gap-3",children:[e.jsx(Ta,{className:"h-4 w-4 text-orange-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:"Establish water points within 500m of homes to meet WHO accessibility standards"})]}),e.jsxs("li",{className:"flex gap-3",children:[e.jsx(Ds,{className:"h-4 w-4 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:"Ensure elderly and vulnerable populations have subsidized access and priority queuing"})]})]})})]})]})})}function Lqe(){return e.jsxs("div",{className:"flex h-screen bg-background",children:[e.jsx(Ti,{}),e.jsx("main",{className:"flex-1 overflow-y-auto",children:e.jsx(Ai,{})})]})}async function Fqe(t,r,s){const n=new URLSearchParams;t&&n.append("domain",t),r&&n.append("level",r),s&&n.append("search",s);const a=await fetch(`/api/v1/training/courses?${n}`,{credentials:"include"});if(!a.ok)throw new Error("Failed to fetch courses");return a.json()}async function $qe(t){const r=await fetch("/api/v1/training/enrollments",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({course_id:t})});if(!r.ok)throw new Error("Failed to enroll");return r.json()}function zqe(){const[t,r]=A.useState(""),[s,n]=A.useState("all"),[a,o]=A.useState("all"),{data:c,isLoading:i}=it({queryKey:["courses",s,a,t],queryFn:()=>Fqe(s!=="all"?s:void 0,a!=="all"?a:void 0,t),staleTime:6e4}),f=async g=>{try{await $qe(g),alert("Successfully enrolled!")}catch{alert("Enrollment failed")}},p=(c==null?void 0:c.data)||[];return e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Course Catalog"}),e.jsx("p",{className:"text-muted-foreground",children:"Browse and enroll in training courses"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(nn,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search courses...",value:t,onChange:g=>r(g.target.value),className:"pl-10"})]})}),e.jsxs(Nt,{value:s,onValueChange:n,children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"All Domains"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Domains"}),e.jsx(ge,{value:"Ops",children:"Operations"}),e.jsx(ge,{value:"Lab",children:"Laboratory"}),e.jsx(ge,{value:"HSE",children:"Health & Safety"}),e.jsx(ge,{value:"CRM",children:"Customer Relations"}),e.jsx(ge,{value:"Finance",children:"Finance"})]})]}),e.jsxs(Nt,{value:a,onValueChange:o,children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"All Levels"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Levels"}),e.jsx(ge,{value:"basic",children:"Basic"}),e.jsx(ge,{value:"intermediate",children:"Intermediate"}),e.jsx(ge,{value:"advanced",children:"Advanced"})]})]})]}),i?e.jsx("div",{className:"text-center py-12",children:"Loading courses..."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(g=>e.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[g.thumbnail_url&&e.jsx("img",{src:g.thumbnail_url,alt:g.title,className:"w-full h-48 object-cover rounded-t-lg"}),e.jsxs(ue,{children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsx(he,{className:"text-lg line-clamp-2",children:g.title}),e.jsx(Ae,{variant:"outline",children:g.domain})]}),e.jsx(mr,{className:"line-clamp-2",children:g.description})]}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($s,{className:"h-4 w-4"}),e.jsxs("span",{children:[g.duration_min," min"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(jb,{className:"h-4 w-4"}),e.jsxs("span",{children:[g.credits," credits"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Ae,{variant:"secondary",className:"capitalize",children:g.level}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[g.enrollments_count," enrolled"]})]}),e.jsxs(K,{onClick:()=>f(g.id),className:"w-full",size:"sm",children:[e.jsx(Fu,{className:"h-4 w-4 mr-2"}),"Enroll Now"]})]})})]},g.id))}),!i&&p.length===0&&e.jsxs(H,{className:"p-12 text-center",children:[e.jsx(Fu,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-lg font-medium",children:"No courses found"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Try adjusting your filters or search terms"})]})]})}async function Bqe(){const t=await fetch("/api/v1/training/my-enrollments",{credentials:"include"});if(!t.ok)throw new Error("Failed to fetch enrollments");return t.json()}function qqe(){const{data:t,isLoading:r}=it({queryKey:["my-enrollments"],queryFn:Bqe,staleTime:3e4});if(r)return e.jsx("div",{className:"container mx-auto p-6",children:"Loading..."});const s=(t==null?void 0:t.in_progress)||[],n=(t==null?void 0:t.enrolled)||[],a=(t==null?void 0:t.completed)||[],o=(t==null?void 0:t.overdue)||[];return e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"My Learning"}),e.jsx("p",{className:"text-muted-foreground",children:"Track your training progress and certifications"})]}),o.length>0&&e.jsxs(H,{className:"mb-6 border-destructive",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Nn,{className:"h-5 w-5 text-destructive"}),e.jsx(he,{className:"text-destructive",children:"Overdue Courses"})]})}),e.jsx(X,{children:e.jsx("div",{className:"space-y-3",children:o.map(c=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:c.course.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Due: ",new Date(c.due_at).toLocaleDateString()]})]}),e.jsx(K,{size:"sm",variant:"destructive",children:"Continue"})]},c.id))})})]}),e.jsxs(ss,{defaultValue:"in-progress",className:"space-y-4",children:[e.jsxs(Yr,{children:[e.jsxs(wt,{value:"in-progress",children:["In Progress (",s.length,")"]}),e.jsxs(wt,{value:"enrolled",children:["Not Started (",n.length,")"]}),e.jsxs(wt,{value:"completed",children:["Completed (",a.length,")"]})]}),e.jsx(kt,{value:"in-progress",className:"space-y-4",children:s.length===0?e.jsxs(H,{className:"p-12 text-center",children:[e.jsx(Fu,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-lg font-medium",children:"No courses in progress"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Start a course from your enrolled list"})]}):s.map(c=>e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(he,{children:c.course.title}),e.jsxs(mr,{children:[c.course.domain," | ",c.course.code]})]}),e.jsxs(Ae,{variant:"secondary",children:[c.progress_percent,"% Complete"]})]})}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Progress"}),e.jsxs("span",{className:"font-medium",children:[c.progress_percent,"%"]})]}),e.jsx(Wi,{value:c.progress_percent,className:"h-2"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($s,{className:"h-4 w-4"}),e.jsxs("span",{children:[c.course.duration_min," min"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(jb,{className:"h-4 w-4"}),e.jsxs("span",{children:[c.course.credits," credits"]})]})]}),e.jsxs(K,{size:"sm",children:[e.jsx(Ui,{className:"h-4 w-4 mr-2"}),"Continue Learning"]})]})]})})]},c.id))}),e.jsx(kt,{value:"enrolled",className:"space-y-4",children:n.length===0?e.jsxs(H,{className:"p-12 text-center",children:[e.jsx(Fu,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-lg font-medium",children:"No enrolled courses"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Browse the course catalog to enroll"})]}):n.map(c=>e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(he,{children:c.course.title}),e.jsxs(mr,{children:[c.course.domain," | ",c.course.code]})]}),e.jsx(Ae,{children:"Not Started"})]})}),e.jsx(X,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($s,{className:"h-4 w-4"}),e.jsxs("span",{children:[c.course.duration_min," min"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(jb,{className:"h-4 w-4"}),e.jsxs("span",{children:[c.course.credits," credits"]})]})]}),e.jsxs(K,{size:"sm",children:[e.jsx(Ui,{className:"h-4 w-4 mr-2"}),"Start Course"]})]})})]},c.id))}),e.jsx(kt,{value:"completed",className:"space-y-4",children:a.length===0?e.jsxs(H,{className:"p-12 text-center",children:[e.jsx(Zl,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-lg font-medium",children:"No completed courses"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Complete your enrolled courses to earn certificates"})]}):a.map(c=>e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(he,{children:c.course.title}),e.jsxs(mr,{children:[c.course.domain," | ",c.course.code]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Ae,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[e.jsx(Zl,{className:"h-3 w-3 mr-1"}),"Completed"]}),c.final_score&&e.jsxs(Ae,{variant:"secondary",children:["Score: ",c.final_score,"%"]})]})]})}),e.jsx(X,{children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Completed on ",new Date(c.completed_at).toLocaleDateString()]}),e.jsx(K,{size:"sm",variant:"outline",children:"View Certificate"})]})})]},c.id))})]})]})}async function Vqe(t,r){const s=new URLSearchParams;t&&s.append("category",t),r&&s.append("search",r);const n=await fetch(`/api/v1/training/kb?${s}`,{credentials:"include"});if(!n.ok)throw new Error("Failed to fetch articles");return n.json()}async function Uqe(){const t=await fetch("/api/v1/training/kb/popular",{credentials:"include"});if(!t.ok)throw new Error("Failed to fetch popular articles");return t.json()}function Wqe(){const[t,r]=A.useState(""),[s,n]=A.useState(""),{data:a,isLoading:o}=it({queryKey:["kb-articles",s,t],queryFn:()=>Vqe(s,t),staleTime:6e4}),{data:c}=it({queryKey:["kb-popular"],queryFn:Uqe,staleTime:3e5}),i=(a==null?void 0:a.data)||[],f=c||[],p=[{value:"",label:"All Categories"},{value:"Assets",label:"Assets"},{value:"Treatment",label:"Treatment"},{value:"Safety",label:"Safety"},{value:"Customer",label:"Customer"},{value:"Finance",label:"Finance"},{value:"IT",label:"IT"}];return e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Knowledge Base"}),e.jsx("p",{className:"text-muted-foreground",children:"Browse articles, guides, and documentation"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx("div",{className:"flex gap-4",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(nn,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search knowledge base...",value:t,onChange:g=>r(g.target.value),className:"pl-10"})]})}),e.jsx(ss,{value:s,onValueChange:n,children:e.jsx(Yr,{className:"w-full justify-start overflow-x-auto",children:p.map(g=>e.jsx(wt,{value:g.value,children:g.label},g.value))})}),o?e.jsx("div",{className:"text-center py-12",children:"Loading articles..."}):i.length===0?e.jsxs(H,{className:"p-12 text-center",children:[e.jsx(bs,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-lg font-medium",children:"No articles found"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Try adjusting your search or category filter"})]}):e.jsx("div",{className:"space-y-4",children:i.map(g=>e.jsxs(H,{className:"hover:shadow-lg transition-shadow cursor-pointer",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(he,{className:"text-lg mb-2",children:g.title}),e.jsxs(mr,{children:["By ",g.author.name," "," ",new Date(g.published_at).toLocaleDateString()]})]}),e.jsx(Ae,{variant:"outline",children:g.category})]})}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-sm text-muted-foreground line-clamp-2",children:[g.content.substring(0,200),"..."]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(mo,{className:"h-4 w-4"}),e.jsxs("span",{children:[g.views_count," views"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(h9,{className:"h-4 w-4"}),e.jsx("span",{children:g.helpful_count})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fie,{className:"h-4 w-4"}),e.jsx("span",{children:g.not_helpful_count})]})]}),g.tags&&g.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:g.tags.map(y=>e.jsx(Ae,{variant:"secondary",className:"text-xs",children:y},y))})]})})]},g.id))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(zs,{className:"h-5 w-5"}),"Popular Articles"]})}),e.jsx(X,{children:e.jsx("div",{className:"space-y-3",children:f.slice(0,5).map(g=>e.jsxs("div",{className:"pb-3 border-b last:border-0 last:pb-0 cursor-pointer hover:bg-muted/50 p-2 rounded-md transition-colors",children:[e.jsx("p",{className:"font-medium text-sm line-clamp-2 mb-1",children:g.title}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(mo,{className:"h-3 w-3"}),e.jsxs("span",{children:[g.views_count," views"]})]})]},g.id))})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Need Help?"})}),e.jsxs(X,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Can't find what you're looking for?"}),e.jsx(K,{className:"w-full",variant:"outline",children:"Submit a Question"})]})]})]})]})]})}async function Gqe(t){const r=new URLSearchParams({status:"published"});t&&r.append("search",t);const s=await fetch(`/api/v1/training/sops?${r}`,{credentials:"include"});if(!s.ok)throw new Error("Failed to fetch SOPs");return s.json()}async function Kqe(t){const r=await fetch(`/api/v1/training/sops/${t}/attest`,{method:"POST",credentials:"include"});if(!r.ok)throw new Error("Failed to attest SOP");return r.json()}function Hqe(){const[t,r]=A.useState(""),s=yr(),{data:n,isLoading:a}=it({queryKey:["sops",t],queryFn:()=>Gqe(t),staleTime:6e4}),o=gt({mutationFn:Kqe,onSuccess:()=>{s.invalidateQueries({queryKey:["sops"]})}}),c=(n==null?void 0:n.data)||[],i=(f,p)=>{var g;return((g=f.attestations)==null?void 0:g.some(y=>y.user_id===p))||!1};return e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Standard Operating Procedures"}),e.jsx("p",{className:"text-muted-foreground",children:"Access and attest to organizational SOPs"})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(nn,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search SOPs...",value:t,onChange:f=>r(f.target.value),className:"pl-10"})]})}),a?e.jsx("div",{className:"text-center py-12",children:"Loading SOPs..."}):c.length===0?e.jsxs(H,{className:"p-12 text-center",children:[e.jsx(bs,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-lg font-medium",children:"No SOPs found"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Try adjusting your search terms"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(f=>{const p=f.next_review_due&&new Date(f.next_review_due)<new Date;return e.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(ue,{children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsxs("div",{children:[e.jsx(he,{className:"text-lg",children:f.title}),e.jsx(mr,{className:"mt-1",children:f.code})]}),e.jsxs(Ae,{variant:"outline",children:["v",f.version]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(Ae,{variant:"secondary",children:f.category}),p&&e.jsxs(Ae,{variant:"destructive",children:[e.jsx(Nn,{className:"h-3 w-3 mr-1"}),"Review Due"]})]})]}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-3",children:[f.published_at&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Published: ",new Date(f.published_at).toLocaleDateString()]}),f.next_review_due&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Next Review: ",new Date(f.next_review_due).toLocaleDateString()]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(mo,{className:"h-4 w-4 mr-2"}),"View SOP"]}),!i(f,1)&&e.jsxs(K,{size:"sm",onClick:()=>o.mutate(f.id),disabled:o.isPending,children:[e.jsx(Ns,{className:"h-4 w-4 mr-2"}),"Attest"]}),i(f,1)&&e.jsxs(Ae,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[e.jsx(Ns,{className:"h-3 w-3 mr-1"}),"Attested"]})]})]})})]},f.id)})})]})}async function Zqe(){const t=await fetch("/api/v1/training/skills/matrix",{credentials:"include"});if(!t.ok)throw new Error("Failed to fetch skills matrix");return t.json()}async function Yqe(t){const r=new URLSearchParams,s=await fetch(`/api/v1/training/employee-skills?${r}`,{credentials:"include"});if(!s.ok)throw new Error("Failed to fetch employee skills");return s.json()}function Xqe(){const[t,r]=A.useState("matrix"),[s,n]=A.useState("all"),{data:a,isLoading:o}=it({queryKey:["skills-matrix"],queryFn:Zqe,enabled:t==="matrix",staleTime:6e4}),{data:c,isLoading:i}=it({queryKey:["employee-skills"],queryFn:()=>Yqe(),enabled:t==="individual",staleTime:6e4}),f=p=>{const g=["bg-red-100 text-red-800","bg-yellow-100 text-yellow-800","bg-blue-100 text-blue-800","bg-green-100 text-green-800"];return g[p]||g[0]};return e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Skills Matrix"}),e.jsx("p",{className:"text-muted-foreground",children:"Track and assess employee competencies"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{variant:t==="matrix"?"default":"outline",onClick:()=>r("matrix"),children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Team Matrix"]}),e.jsxs(K,{variant:t==="individual"?"default":"outline",onClick:()=>r("individual"),children:[e.jsx(pm,{className:"h-4 w-4 mr-2"}),"My Skills"]})]}),e.jsxs(Nt,{value:s,onValueChange:n,children:[e.jsx(bt,{className:"w-48",children:e.jsx(St,{placeholder:"Filter by category"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Categories"}),e.jsx(ge,{value:"technical",children:"Technical"}),e.jsx(ge,{value:"safety",children:"Safety"}),e.jsx(ge,{value:"customer",children:"Customer Service"}),e.jsx(ge,{value:"leadership",children:"Leadership"})]})]})]}),t==="matrix"&&e.jsx(e.Fragment,{children:o?e.jsx("div",{className:"text-center py-12",children:"Loading matrix..."}):e.jsx("div",{className:"space-y-6",children:a==null?void 0:a.map(p=>{const g=p.skill,y=p.employees;return s!=="all"&&g.category!==s?null:e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(he,{children:g.name}),e.jsx(mr,{children:g.code})]}),e.jsx(Ae,{variant:"outline",children:g.category})]})}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex gap-2",children:g.levels.map((b,w)=>e.jsx(Ae,{className:f(w),children:b},w))}),y.length>0?e.jsx("div",{className:"space-y-2",children:y.map((b,w)=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-md",children:[e.jsx("span",{className:"font-medium",children:b.user.name}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ae,{className:f(b.level_index),children:b.level_name}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Assessed: ",new Date(b.assessed_at).toLocaleDateString()]})]})]},w))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No employees assessed for this skill"})]})})]},g.id)})})}),t==="individual"&&e.jsx(e.Fragment,{children:i?e.jsx("div",{className:"text-center py-12",children:"Loading your skills..."}):c&&c.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(p=>e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{className:"text-lg",children:p.skill.name}),e.jsx(mr,{children:p.skill.category})]}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Current Level"}),e.jsx(Ae,{className:f(p.level_index),children:p.skill.levels[p.level_index]})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Assessed: ",new Date(p.assessed_at).toLocaleDateString()]}),p.assessor&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["By: ",p.assessor.name]})]})]})})]},p.id))}):e.jsxs(H,{className:"p-12 text-center",children:[e.jsx(pm,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-lg font-medium",children:"No skills assessed"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Contact your supervisor to get your skills assessed"})]})})]})}function Qqe(){return e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"My Certificates"}),e.jsx("p",{className:"text-muted-foreground",children:"View and download your training certificates"})]}),e.jsxs(H,{className:"p-12 text-center",children:[e.jsx(jb,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Certificates Coming Soon"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Complete courses to earn certificates that will appear here"})]})]})}function Jqe(){return e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx(Ti,{}),e.jsx("main",{className:"flex-1 p-8 overflow-auto",children:e.jsx(Ai,{})})]})}function eVe(){var B,U,te;const[t,r]=A.useState({entity_type:"scheme",entity_id:"",metric:"production",horizon_days:30,model_family:"auto",seasonality:!0,holdout_pct:20,exogenous_drivers:[]}),[s,n]=A.useState(""),[a,o]=A.useState(null),{data:c,isLoading:i,error:f}=it({queryKey:["schemes"],queryFn:async()=>(await pe.get("/api/v1/schemes")).data.data}),{data:p,isLoading:g,error:y,refetch:b}=it({queryKey:["forecast-jobs"],queryFn:async()=>(await pe.get("/api/v1/dsa/forecast")).data.data}),{data:w,isLoading:T,error:N}=it({queryKey:["forecast-job",a],queryFn:async()=>a?(await pe.get(`/api/v1/dsa/forecast/${a}`)).data:null,enabled:!!a}),M=gt({mutationFn:async Q=>(await pe.post("/api/v1/dsa/forecast",Q)).data,onSuccess:Q=>{Me.success("Forecast job started successfully"),o(Q.id),b()},onError:()=>{Me.error("Failed to start forecast job")}}),O=()=>{s.trim()&&!t.exogenous_drivers.includes(s.trim())&&(r({...t,exogenous_drivers:[...t.exogenous_drivers,s.trim()]}),n(""))},C=Q=>{r({...t,exogenous_drivers:t.exogenous_drivers.filter(re=>re!==Q)})},D=()=>{M.mutate(t)},L=()=>{if(!w)return;const Q=[["Date","Type","Value","Lower_80","Upper_80","Lower_95","Upper_95"],...w.historical.map(oe=>[oe.date,"Historical",oe.actual,"","","",""]),...w.forecast.map(oe=>[oe.date,"Forecast",oe.predicted,oe.lower_80,oe.upper_80,oe.lower_95,oe.upper_95])].map(oe=>oe.join(",")).join(`
`),re=new Blob([Q],{type:"text/csv"}),Z=URL.createObjectURL(re),ne=document.createElement("a");ne.href=Z,ne.download=`forecast_${a}.csv`,ne.click(),Me.success("Forecast exported to CSV")},F=p==null?void 0:p.find(Q=>Q.id===a);return e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Forecast Studio"}),e.jsx("p",{className:"text-muted-foreground",children:"Time-series forecasting with ML models and confidence intervals"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(H,{className:"lg:col-span-1",children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Forecast Configuration"}),e.jsx(mr,{children:"Define parameters for time-series forecasting"})]}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(we,{children:"Entity Type"}),e.jsxs(Nt,{value:t.entity_type,onValueChange:Q=>r({...t,entity_type:Q}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"scheme",children:"Scheme"}),e.jsx(ge,{value:"dma",children:"DMA"}),e.jsx(ge,{value:"meter_class",children:"Meter Class"}),e.jsx(ge,{value:"customer_segment",children:"Customer Segment"})]})]})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Entity Selection"}),e.jsxs(Nt,{value:t.entity_id,onValueChange:Q=>r({...t,entity_id:Q}),children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select entity..."})}),e.jsx(_t,{children:c==null?void 0:c.map(Q=>e.jsx(ge,{value:Q.id,children:Q.name},Q.id))})]})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Metric"}),e.jsxs(Nt,{value:t.metric,onValueChange:Q=>r({...t,metric:Q}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"production",children:"Production Volume"}),e.jsx(ge,{value:"demand",children:"Demand"}),e.jsx(ge,{value:"revenue",children:"Revenue"}),e.jsx(ge,{value:"chemicals",children:"Chemicals Usage"}),e.jsx(ge,{value:"energy_cost",children:"Energy Cost"})]})]})]}),e.jsxs("div",{children:[e.jsxs(we,{children:["Forecast Horizon (days): ",t.horizon_days]}),e.jsx(Am,{value:[t.horizon_days],onValueChange:([Q])=>r({...t,horizon_days:Q}),min:7,max:365,step:1})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Model Family"}),e.jsxs(Nt,{value:t.model_family,onValueChange:Q=>r({...t,model_family:Q}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"auto",children:"Auto (Best Model)"}),e.jsx(ge,{value:"arima",children:"ARIMA"}),e.jsx(ge,{value:"ets",children:"ETS (Exponential Smoothing)"}),e.jsx(ge,{value:"prophet",children:"Prophet"}),e.jsx(ge,{value:"lstm",children:"LSTM Neural Network"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(we,{children:"Seasonality Detection"}),e.jsx(ml,{checked:t.seasonality,onCheckedChange:Q=>r({...t,seasonality:Q})})]}),e.jsxs("div",{children:[e.jsxs(we,{children:["Holdout Set (%): ",t.holdout_pct,"%"]}),e.jsx(Am,{value:[t.holdout_pct],onValueChange:([Q])=>r({...t,holdout_pct:Q}),min:10,max:30,step:5})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Exogenous Drivers"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(Ie,{placeholder:"e.g., rainfall, temperature, holidays",value:s,onChange:Q=>n(Q.target.value),onKeyPress:Q=>Q.key==="Enter"&&O()}),e.jsx(K,{size:"sm",onClick:O,children:"Add"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.exogenous_drivers.map(Q=>e.jsxs(Ae,{variant:"secondary",className:"flex items-center gap-1",children:[Q,e.jsx(Ko,{className:"h-3 w-3 cursor-pointer",onClick:()=>C(Q)})]},Q))})]}),e.jsxs(K,{className:"w-full",onClick:D,disabled:!t.entity_id||M.isPending,children:[e.jsx(Ui,{className:"h-4 w-4 mr-2"}),M.isPending?"Starting...":"Run Forecast"]})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Recent Forecast Jobs"})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Metric"}),e.jsx(se,{children:"Model"}),e.jsx(se,{children:"Horizon"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"MAPE"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:p==null?void 0:p.slice(0,10).map(Q=>{var re,Z;return e.jsxs(Qe,{className:a===Q.id?"bg-muted":"",children:[e.jsx(J,{className:"font-medium",children:Q.metric}),e.jsx(J,{children:Q.model_family.toUpperCase()}),e.jsxs(J,{children:[Q.horizon_days,"d"]}),e.jsx(J,{children:e.jsx(Ae,{variant:Q.status==="completed"?"default":Q.status==="failed"?"destructive":"secondary",children:Q.status})}),e.jsxs(J,{children:[(Z=(re=Q.scores)==null?void 0:re.mape)==null?void 0:Z.toFixed(2),"%"]}),e.jsx(J,{children:e.jsx(K,{size:"sm",variant:"ghost",onClick:()=>o(Q.id),disabled:Q.status!=="completed",children:"View"})})]},Q.id)})})]})})]}),a&&T&&e.jsx(H,{children:e.jsxs(X,{className:"py-12 text-center",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading forecast results..."})]})}),a&&N&&e.jsx(H,{children:e.jsx(X,{className:"py-12 text-center text-destructive",children:e.jsxs("p",{children:["Error loading forecast: ",N.message]})})}),F&&w&&w.historical&&w.forecast&&e.jsxs(e.Fragment,{children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(he,{children:"Forecast Results"}),e.jsxs(mr,{children:[F.metric," forecast for ",F.horizon_days," days"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{size:"sm",variant:"outline",onClick:L,children:[e.jsx(ma,{className:"h-4 w-4 mr-2"}),"Export CSV"]}),e.jsxs(K,{size:"sm",variant:"outline",children:[e.jsx(vI,{className:"h-4 w-4 mr-2"}),"Save Baseline"]})]})]})}),e.jsx(X,{children:e.jsxs(ss,{defaultValue:"chart",children:[e.jsxs(Yr,{children:[e.jsx(wt,{value:"chart",children:"Forecast Chart"}),e.jsx(wt,{value:"errors",children:"Error Metrics"}),e.jsx(wt,{value:"model",children:"Model Card"})]}),e.jsx(kt,{value:"chart",className:"h-[400px]",children:e.jsx(Ha,{width:"100%",height:"100%",children:e.jsxs(yR,{data:[...w.historical,...w.forecast],children:[e.jsx(Zi,{strokeDasharray:"3 3"}),e.jsx(Ma,{dataKey:"date"}),e.jsx(fa,{}),e.jsx(_n,{}),e.jsx(Ea,{}),e.jsx(Jl,{type:"monotone",dataKey:"upper_95",stackId:"1",stroke:"transparent",fill:"#e0e7ff",fillOpacity:.3}),e.jsx(Jl,{type:"monotone",dataKey:"upper_80",stackId:"2",stroke:"transparent",fill:"#c7d2fe",fillOpacity:.4}),e.jsx(ui,{type:"monotone",dataKey:"actual",stroke:"#3b82f6",strokeWidth:2,dot:!1}),e.jsx(ui,{type:"monotone",dataKey:"predicted",stroke:"#10b981",strokeWidth:2,strokeDasharray:"5 5",dot:!1})]})})}),e.jsx(kt,{value:"errors",children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Metric"}),e.jsx(se,{children:"Value"}),e.jsx(se,{children:"Interpretation"})]})}),e.jsxs(lr,{children:[e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:"MAE (Mean Absolute Error)"}),e.jsx(J,{children:(B=F.scores)==null?void 0:B.mae.toFixed(2)}),e.jsx(J,{className:"text-sm text-muted-foreground",children:"Average absolute deviation"})]}),e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:"RMSE (Root Mean Squared Error)"}),e.jsx(J,{children:(U=F.scores)==null?void 0:U.rmse.toFixed(2)}),e.jsx(J,{className:"text-sm text-muted-foreground",children:"Penalizes larger errors"})]}),e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:"MAPE (Mean Absolute % Error)"}),e.jsxs(J,{children:[(te=F.scores)==null?void 0:te.mape.toFixed(2),"%"]}),e.jsx(J,{children:e.jsx(Ae,{variant:F.scores.mape<10?"default":F.scores.mape<20?"secondary":"destructive",children:F.scores.mape<10?"Excellent":F.scores.mape<20?"Good":"Needs Improvement"})})]})]})]})}),e.jsxs(kt,{value:"model",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Model Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Model Name"}),e.jsx("p",{className:"font-medium",children:w.model_card.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Version"}),e.jsx("p",{className:"font-medium",children:w.model_card.version})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Training Window"}),e.jsx("p",{className:"font-medium",children:w.model_card.training_window})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Features Used"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:w.model_card.features_used.map(Q=>e.jsx(Ae,{variant:"outline",className:"text-xs",children:Q},Q))})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Hyperparameters"}),e.jsx("div",{className:"bg-muted p-3 rounded-md",children:e.jsx("pre",{className:"text-xs overflow-auto",children:JSON.stringify(w.model_card.hyperparameters,null,2)})})]})]})]})})]}),F.scores&&F.scores.mape>20&&e.jsxs(zn,{children:[e.jsx(Nn,{className:"h-4 w-4"}),e.jsxs(An,{children:[e.jsx("strong",{children:"Model Accuracy Alert:"})," MAPE is ",F.scores.mape.toFixed(1),"%. Consider adding more exogenous drivers or trying a different model family."]})]})]})]})]})]})}function tVe(){const[t,r]=A.useState({name:"",type:"drought",scheme_id:"",period_start:new Date,period_end:new Date(Date.now()+2592e6),severity:50,monte_carlo_runs:100,params:{}}),[s,n]=A.useState([]),[a,o]=A.useState(null),{data:c,isLoading:i,error:f}=it({queryKey:["schemes"],queryFn:async()=>(await pe.get("/api/v1/schemes")).data.data}),{data:p,isLoading:g,error:y,refetch:b}=it({queryKey:["scenarios"],queryFn:async()=>(await pe.get("/api/v1/dsa/scenarios")).data.data}),w=gt({mutationFn:async F=>(await pe.post(`/api/v1/dsa/scenarios/${F}/run`)).data,onSuccess:()=>{Me.success("Scenario simulation started"),b()},onError:()=>{Me.error("Failed to run scenario")}}),T=gt({mutationFn:async F=>(await pe.post("/api/v1/dsa/scenarios",{...F,playbook:s})).data,onSuccess:()=>{Me.success("Scenario created successfully"),b(),r({name:"",type:"drought",scheme_id:"",period_start:new Date,period_end:new Date(Date.now()+30*24*60*60*1e3),severity:50,monte_carlo_runs:100,params:{}}),n([])},onError:()=>{Me.error("Failed to create scenario")}}),N=()=>{n([...s,{action:"",owner:"",trigger:"",lead_time:24,impact:""}])},M=F=>{n(s.filter((B,U)=>U!==F))},O=(F,B,U)=>{const te=[...s];te[F]={...te[F],[B]:U},n(te)},C=p==null?void 0:p.find(F=>F.id===a),D=C!=null&&C.results?[{metric:"Deficit",baseline:0,scenario:C.results.deficit_m3d},{metric:"Continuity",baseline:24,scenario:C.results.continuity_hrs},{metric:"Cost Impact",baseline:100,scenario:100+C.results.cost_impact},{metric:"Service Level",baseline:100,scenario:100-C.results.service_deficit_pct}]:[],L=[{kpi:"Supply",value:85,fullMark:100},{kpi:"Pressure",value:70,fullMark:100},{kpi:"Quality",value:90,fullMark:100},{kpi:"Cost",value:60,fullMark:100},{kpi:"Reliability",value:75,fullMark:100}];return e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Scenario Workbench"}),e.jsx("p",{className:"text-muted-foreground",children:"Design and simulate stress tests for resilience planning"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(H,{className:"lg:col-span-1",children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Scenario Builder"}),e.jsx(mr,{children:"Define parameters for stress testing"})]}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(we,{children:"Scenario Name"}),e.jsx(Ie,{value:t.name,onChange:F=>r({...t,name:F.target.value}),placeholder:"e.g., Severe Drought 2025"})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Type"}),e.jsxs(Nt,{value:t.type,onValueChange:F=>r({...t,type:F}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"drought",children:"Drought"}),e.jsx(ge,{value:"demand_spike",children:"Demand Spike"}),e.jsx(ge,{value:"contamination",children:"Contamination"}),e.jsx(ge,{value:"power_shock",children:"Power Price Shock"}),e.jsx(ge,{value:"asset_failure",children:"Asset Failure"}),e.jsx(ge,{value:"custom",children:"Custom"})]})]})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Scheme"}),e.jsxs(Nt,{value:t.scheme_id,onValueChange:F=>r({...t,scheme_id:F}),children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select scheme..."})}),e.jsx(_t,{children:c==null?void 0:c.map(F=>e.jsx(ge,{value:F.id,children:F.name},F.id))})]})]}),e.jsxs("div",{children:[e.jsxs(we,{children:["Severity: ",t.severity,"%"]}),e.jsx(Am,{value:[t.severity],onValueChange:([F])=>r({...t,severity:F}),min:0,max:100,step:5})]}),e.jsxs("div",{children:[e.jsxs(we,{children:["Monte Carlo Runs: ",t.monte_carlo_runs]}),e.jsx(Am,{value:[t.monte_carlo_runs],onValueChange:([F])=>r({...t,monte_carlo_runs:F}),min:10,max:1e3,step:10})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Playbook Steps"}),e.jsxs("div",{className:"space-y-2 mt-2",children:[s.map((F,B)=>e.jsxs("div",{className:"p-3 border rounded-md space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Step ",B+1]}),e.jsx(K,{size:"sm",variant:"ghost",onClick:()=>M(B),children:e.jsx(Ws,{className:"h-4 w-4"})})]}),e.jsx(Ie,{placeholder:"Action",value:F.action,onChange:U=>O(B,"action",U.target.value)}),e.jsx(Ie,{placeholder:"Owner",value:F.owner,onChange:U=>O(B,"owner",U.target.value)})]},B)),e.jsx(K,{size:"sm",variant:"outline",onClick:N,className:"w-full",children:"Add Playbook Step"})]})]}),e.jsx(K,{className:"w-full",onClick:()=>T.mutate(t),disabled:!t.name||!t.scheme_id||T.isPending,children:"Create Scenario"})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Scenario Library"})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Name"}),e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Deficit (m/d)"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:p==null?void 0:p.map(F=>{var B,U;return e.jsxs(Qe,{className:a===F.id?"bg-muted":"",onClick:()=>o(F.id),children:[e.jsx(J,{className:"font-medium",children:F.name}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:F.type})}),e.jsx(J,{children:e.jsx(Ae,{variant:F.status==="completed"?"default":F.status==="running"?"secondary":"outline",children:F.status})}),e.jsx(J,{children:((U=(B=F.results)==null?void 0:B.deficit_m3d)==null?void 0:U.toFixed(1))||"-"}),e.jsx(J,{children:e.jsx(K,{size:"sm",variant:"ghost",onClick:te=>{te.stopPropagation(),w.mutate(F.id)},disabled:F.status==="running",children:e.jsx(Ui,{className:"h-4 w-4"})})})]},F.id)})})]})})]}),C&&C.status==="completed"&&e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{children:["Scenario Results: ",C.name]})}),e.jsx(X,{children:e.jsxs(ss,{defaultValue:"kpis",children:[e.jsxs(Yr,{children:[e.jsx(wt,{value:"kpis",children:"KPIs"}),e.jsx(wt,{value:"comparison",children:"Comparison"}),e.jsx(wt,{value:"radar",children:"Multi-KPI Radar"})]}),e.jsx(kt,{value:"kpis",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 border rounded-md",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Supply Deficit"}),e.jsxs("p",{className:"text-2xl font-bold",children:[C.results.deficit_m3d.toFixed(0)," m/d"]})]}),e.jsxs("div",{className:"p-4 border rounded-md",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Continuity"}),e.jsxs("p",{className:"text-2xl font-bold",children:[C.results.continuity_hrs.toFixed(1)," hrs/day"]})]}),e.jsxs("div",{className:"p-4 border rounded-md",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Cost Impact"}),e.jsxs("p",{className:"text-2xl font-bold",children:[C.results.cost_impact>0?"+":"",C.results.cost_impact.toFixed(0),"%"]})]}),e.jsxs("div",{className:"p-4 border rounded-md",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Service Deficit"}),e.jsxs("p",{className:"text-2xl font-bold",children:[C.results.service_deficit_pct.toFixed(1),"%"]})]})]})}),e.jsx(kt,{value:"comparison",className:"h-[300px]",children:e.jsx(Ha,{width:"100%",height:"100%",children:e.jsxs(tv,{data:D,children:[e.jsx(Zi,{strokeDasharray:"3 3"}),e.jsx(Ma,{dataKey:"metric"}),e.jsx(fa,{}),e.jsx(_n,{}),e.jsx(Ea,{}),e.jsx(uo,{dataKey:"baseline",fill:"#10b981",name:"Baseline"}),e.jsx(uo,{dataKey:"scenario",fill:"#ef4444",name:"Scenario"})]})})}),e.jsx(kt,{value:"radar",className:"h-[300px]",children:e.jsx(Ha,{width:"100%",height:"100%",children:e.jsxs(pze,{data:L,children:[e.jsx(OY,{}),e.jsx(Rv,{dataKey:"kpi"}),e.jsx(Dv,{angle:90,domain:[0,100]}),e.jsx(rw,{name:"Performance",dataKey:"value",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.6}),e.jsx(Ea,{})]})})})]})})]})]})]})]})}function rVe(){var N,M,O;const[t,r]=A.useState("pumps"),[s,n]=A.useState({scheme_id:"",asset_ids:[],target_volume_m3:5e3,objective:"minimize_energy_cost"}),{data:a,isLoading:o,error:c}=it({queryKey:["schemes"],queryFn:async()=>(await pe.get("/api/v1/schemes")).data.data}),{data:i,isLoading:f}=it({queryKey:["pumps",s.scheme_id],queryFn:async()=>s.scheme_id?(await pe.get(`/api/v1/assets?scheme_id=${s.scheme_id}&kind=pump`)).data.data:[],enabled:!!s.scheme_id}),{data:p,isLoading:g,error:y,refetch:b}=it({queryKey:["optim-runs",t],queryFn:async()=>(await pe.get(`/api/v1/dsa/optimize?type=${t}`)).data.data}),w=gt({mutationFn:async C=>{const D=`/api/v1/dsa/optimize/${t}`;return(await pe.post(D,C)).data},onSuccess:()=>{Me.success("Optimization started successfully"),b()},onError:()=>{Me.error("Failed to start optimization")}}),T=gt({mutationFn:async C=>(await pe.post(`/api/v1/dsa/optimize/${C}/publish`)).data,onSuccess:()=>{Me.success("Plan published to CoreOps successfully"),b()},onError:()=>{Me.error("Failed to publish plan")}});return e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Optimization Console"}),e.jsx("p",{className:"text-muted-foreground",children:"AI-powered optimization for pumps, valves, dosing, and logistics"})]}),e.jsxs(ss,{value:t,onValueChange:C=>r(C),children:[e.jsxs(Yr,{className:"grid w-full grid-cols-4",children:[e.jsx(wt,{value:"pumps",children:"Pump Scheduling"}),e.jsx(wt,{value:"valves",children:"Valve Settings"}),e.jsx(wt,{value:"dosing",children:"Chlorine Dosing"}),e.jsx(wt,{value:"logistics",children:"Logistics"})]}),e.jsx(kt,{value:"pumps",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Configuration"}),e.jsx(mr,{children:"Set optimization parameters"})]}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(we,{children:"Scheme"}),e.jsxs(Nt,{value:s.scheme_id,onValueChange:C=>n({...s,scheme_id:C}),children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select scheme..."})}),e.jsx(_t,{children:a==null?void 0:a.map(C=>e.jsx(ge,{value:C.id,children:C.name},C.id))})]})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Pumps"}),e.jsxs(Nt,{children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select pumps..."})}),e.jsx(_t,{children:i==null?void 0:i.map(C=>e.jsx(ge,{value:C.id,children:C.name},C.id))})]})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Target Volume (m)"}),e.jsx(Ie,{type:"number",value:s.target_volume_m3,onChange:C=>n({...s,target_volume_m3:parseInt(C.target.value)})})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Objective"}),e.jsxs(Nt,{value:s.objective,onValueChange:C=>n({...s,objective:C}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"minimize_energy_cost",children:"Minimize Energy Cost"}),e.jsx(ge,{value:"minimize_peak_demand",children:"Minimize Peak Demand"}),e.jsx(ge,{value:"maximize_storage",children:"Maximize Storage"})]})]})]}),e.jsxs(K,{className:"w-full",onClick:()=>w.mutate(s),disabled:!s.scheme_id||w.isPending,children:[e.jsx(Ui,{className:"h-4 w-4 mr-2"}),"Run Optimization"]})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Optimization Results"})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Run"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Savings"}),e.jsx(se,{children:"Peak Hours Avoided"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:p==null?void 0:p.map(C=>{var D,L;return e.jsxs(Qe,{children:[e.jsxs(J,{className:"font-medium",children:["#",C.id.slice(0,8)]}),e.jsx(J,{children:e.jsx(Ae,{variant:C.status==="completed"?"default":C.status==="failed"?"destructive":"secondary",children:C.status})}),e.jsx(J,{children:(D=C.kpis)!=null&&D.savings?`${C.kpis.savings.toFixed(0)}%`:"-"}),e.jsx(J,{children:((L=C.kpis)==null?void 0:L.peak_hours_avoided)||"-"}),e.jsx(J,{children:e.jsxs(K,{size:"sm",variant:"ghost",onClick:()=>T.mutate(C.id),disabled:C.status!=="completed",children:[e.jsx(vI,{className:"h-4 w-4 mr-1"}),"Publish"]})})]},C.id)})})]})})]}),((N=p==null?void 0:p[0])==null?void 0:N.status)==="completed"&&((M=p[0].outputs)==null?void 0:M.windows)&&e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Optimized Schedule (Gantt)"})}),e.jsx(X,{children:e.jsx("div",{className:"space-y-2",children:p[0].outputs.windows.map((C,D)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-20 text-sm",children:[C.start_hour,":00"]}),e.jsxs("div",{className:"h-8 bg-blue-500 rounded flex items-center px-2 text-white text-sm",style:{width:`${C.duration_hours/24*100}%`},children:[C.duration_hours,"h"]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[C.volume_m3.toFixed(0)," m"]})]},D))})})]}),((O=p==null?void 0:p[0])==null?void 0:O.status)==="completed"&&p[0].kpis&&e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ci,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Cost Savings"}),e.jsxs("p",{className:"text-2xl font-bold",children:[p[0].kpis.savings.toFixed(0),"%"]})]})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($s,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Peak Hours Avoided"}),e.jsx("p",{className:"text-2xl font-bold",children:p[0].kpis.peak_hours_avoided})]})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ta,{className:"h-5 w-5 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Efficiency"}),e.jsxs("p",{className:"text-2xl font-bold",children:[p[0].kpis.efficiency.toFixed(0),"%"]})]})]})})})]})]})]})}),e.jsx(kt,{value:"valves",children:e.jsx(H,{children:e.jsx(X,{className:"py-12 text-center text-muted-foreground",children:"Valve optimization configuration coming soon"})})}),e.jsx(kt,{value:"dosing",children:e.jsx(H,{children:e.jsx(X,{className:"py-12 text-center text-muted-foreground",children:"Chlorine dosing optimization configuration coming soon"})})}),e.jsx(kt,{value:"logistics",children:e.jsx(H,{children:e.jsx(X,{className:"py-12 text-center text-muted-foreground",children:"Logistics routing optimization configuration coming soon"})})})]})]})}function sVe(){var M,O;const[t,r]=A.useState({signal:"all",scheme_id:"",score_min:.5,status:"new"}),[s,n]=A.useState(new Set),[a,o]=A.useState(null),{data:c,isLoading:i,error:f,refetch:p}=it({queryKey:["anomalies",t],queryFn:async()=>{const C=new URLSearchParams;return t.signal!=="all"&&C.append("signal",t.signal),t.scheme_id&&C.append("scheme_id",t.scheme_id),C.append("score_min",t.score_min.toString()),t.status!=="all"&&C.append("status",t.status),(await pe.get(`/api/v1/dsa/anomalies?${C}`)).data.data}}),g=gt({mutationFn:async({ids:C,status:D})=>(await pe.post("/api/v1/dsa/anomalies/bulk-update",{ids:C,status:D})).data,onSuccess:()=>{Me.success("Anomalies updated successfully"),n(new Set),p()}}),y=gt({mutationFn:async C=>(await pe.post(`/api/v1/dsa/anomalies/${C}/create-work-order`)).data,onSuccess:()=>{Me.success("Work order created successfully"),p()}}),b=C=>{const D=new Set(s);D.has(C)?D.delete(C):D.add(C),n(D)},w=C=>{g.mutate({ids:Array.from(s),status:C})},T=c==null?void 0:c.find(C=>C.id===a),N=T?[{ts:"00:00",value:120,threshold:150},{ts:"04:00",value:125,threshold:150},{ts:"08:00",value:280,threshold:150},{ts:"12:00",value:130,threshold:150},{ts:"16:00",value:135,threshold:150},{ts:"20:00",value:128,threshold:150}]:[];return e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Anomalies Inbox"}),e.jsx("p",{className:"text-muted-foreground",children:"ML-powered anomaly detection and triage"})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Filters"})}),e.jsx(X,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(Nt,{value:t.signal,onValueChange:C=>r({...t,signal:C}),children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Signal type..."})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Signals"}),e.jsx(ge,{value:"flow",children:"Flow"}),e.jsx(ge,{value:"pressure",children:"Pressure"}),e.jsx(ge,{value:"consumption",children:"Consumption"}),e.jsx(ge,{value:"quality",children:"Quality"})]})]}),e.jsxs(Nt,{value:t.status,onValueChange:C=>r({...t,status:C}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Status"}),e.jsx(ge,{value:"new",children:"New"}),e.jsx(ge,{value:"acknowledged",children:"Acknowledged"}),e.jsx(ge,{value:"investigating",children:"Investigating"}),e.jsx(ge,{value:"resolved",children:"Resolved"}),e.jsx(ge,{value:"false_positive",children:"False Positive"})]})]}),e.jsx(Ie,{type:"number",placeholder:"Min score (0-1)",value:t.score_min,onChange:C=>r({...t,score_min:parseFloat(C.target.value)}),step:"0.1",min:"0",max:"1"}),s.size>0&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{size:"sm",variant:"outline",onClick:()=>w("acknowledged"),children:["Acknowledge (",s.size,")"]}),e.jsx(K,{size:"sm",variant:"outline",onClick:()=>w("false_positive"),children:"Mark False"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Detected Anomalies"})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{className:"w-12"}),e.jsx(se,{children:"Timestamp"}),e.jsx(se,{children:"Signal"}),e.jsx(se,{children:"Score"}),e.jsx(se,{children:"Pattern"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:c==null?void 0:c.map(C=>e.jsxs(Qe,{className:a===C.id?"bg-muted":"",onClick:()=>o(C.id),children:[e.jsx(J,{children:e.jsx(Fd,{checked:s.has(C.id),onCheckedChange:()=>b(C.id),onClick:D=>D.stopPropagation()})}),e.jsx(J,{className:"text-sm",children:new Date(C.ts).toLocaleString()}),e.jsx(J,{children:e.jsx(Ae,{variant:"outline",children:C.signal})}),e.jsx(J,{children:e.jsx(Ae,{variant:C.score>.8?"destructive":C.score>.6?"default":"secondary",children:C.score.toFixed(2)})}),e.jsx(J,{className:"text-sm",children:C.pattern}),e.jsx(J,{children:e.jsx(K,{size:"sm",variant:"ghost",onClick:D=>{D.stopPropagation(),y.mutate(C.id)},children:e.jsx(Vc,{className:"h-4 w-4"})})})]},C.id))})]})})]}),e.jsx("div",{className:"space-y-6",children:T&&e.jsxs(e.Fragment,{children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Signal Explorer"})}),e.jsx(X,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(Ha,{width:"100%",height:"100%",children:e.jsxs(Km,{data:N,children:[e.jsx(Zi,{strokeDasharray:"3 3"}),e.jsx(Ma,{dataKey:"ts"}),e.jsx(fa,{}),e.jsx(_n,{}),e.jsx(OP,{y:150,stroke:"red",strokeDasharray:"3 3",label:"Threshold"}),e.jsx(ui,{type:"monotone",dataKey:"value",stroke:"#3b82f6",strokeWidth:2})]})})})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Triage Information"})}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Fr,{className:"h-5 w-5 text-orange-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Suspected Cause"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:((M=T.triage)==null?void 0:M.suspected_cause)||"Analyzing..."})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Zl,{className:"h-5 w-5 text-green-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Suggested Action"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:((O=T.triage)==null?void 0:O.suggested_action)||"No recommendation"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(K,{size:"sm",variant:"outline",onClick:()=>g.mutate({ids:[T.id],status:"acknowledged"}),children:"Acknowledge"}),e.jsx(K,{size:"sm",onClick:()=>y.mutate(T.id),children:"Create Work Order"})]})]})]})]})})]})]})}function nVe(){var N,M;const[t,r]=A.useState(""),[s,n]=A.useState(""),{data:a,isLoading:o,error:c}=it({queryKey:["schemes"],queryFn:async()=>(await pe.get("/api/v1/schemes")).data.data}),{data:i,isLoading:f,error:p}=it({queryKey:["hydro-kpis",t],queryFn:async()=>{const O=t?`?scheme_id=${t}`:"";return(await pe.get(`/api/v1/dsa/hydro/aquifers${O}`)).data.data}}),{data:g,isLoading:y}=it({queryKey:["wellfield",t,s],queryFn:async()=>{const O=new URLSearchParams;return t&&O.append("scheme_id",t),s&&O.append("aquifer",s),(await pe.get(`/api/v1/dsa/hydro/wellfield?${O}`)).data.data},enabled:!!t}),b=[{month:"Jan",recharge:45,abstraction:3200,storage:75},{month:"Feb",recharge:52,abstraction:3150,storage:78},{month:"Mar",recharge:38,abstraction:3300,storage:72},{month:"Apr",recharge:25,abstraction:3450,storage:65},{month:"May",recharge:15,abstraction:3600,storage:58},{month:"Jun",recharge:8,abstraction:3700,storage:52}],w=i==null?void 0:i[0],T=O=>O<.3?e.jsx(Ae,{variant:"default",children:"Low Risk"}):O<.6?e.jsx(Ae,{variant:"secondary",children:"Medium Risk"}):e.jsx(Ae,{variant:"destructive",children:"High Risk"});return e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Aquifer Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Hydrogeological analytics and groundwater monitoring"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(Nt,{value:t,onValueChange:r,children:[e.jsx(bt,{className:"w-[250px]",children:e.jsx(St,{placeholder:"Select scheme..."})}),e.jsx(_t,{children:a==null?void 0:a.map(O=>e.jsx(ge,{value:O.id,children:O.name},O.id))})]}),e.jsxs(Nt,{value:s,onValueChange:n,children:[e.jsx(bt,{className:"w-[250px]",children:e.jsx(St,{placeholder:"Select aquifer..."})}),e.jsx(_t,{children:i==null?void 0:i.map(O=>e.jsx(ge,{value:O.aquifer_name,children:O.aquifer_name},O.aquifer_name))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Fl,{className:"h-8 w-8 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Recharge"}),e.jsxs("p",{className:"text-2xl font-bold",children:[((N=w==null?void 0:w.recharge_mm)==null?void 0:N.toFixed(0))||0," mm"]})]})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ci,{className:"h-8 w-8 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Abstraction"}),e.jsxs("p",{className:"text-2xl font-bold",children:[((M=w==null?void 0:w.abstraction_m3d)==null?void 0:M.toFixed(0))||0," m/d"]})]})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ni,{className:"h-8 w-8 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Storage Index"}),e.jsxs("p",{className:"text-2xl font-bold",children:[(((w==null?void 0:w.storage_index)||0)*100).toFixed(0),"%"]})]})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Nn,{className:"h-8 w-8 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Risk Score"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("p",{className:"text-2xl font-bold",children:[(((w==null?void 0:w.risk_score)||0)*100).toFixed(0),"%"]}),w&&T(w.risk_score)]})]})]})})})]}),e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Aquifer Balance Trends"}),e.jsx(mr,{children:"Recharge vs Abstraction over time"})]}),e.jsx(X,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(Ha,{width:"100%",height:"100%",children:e.jsxs(yR,{data:b,children:[e.jsx(Zi,{strokeDasharray:"3 3"}),e.jsx(Ma,{dataKey:"month"}),e.jsx(fa,{yAxisId:"left"}),e.jsx(fa,{yAxisId:"right",orientation:"right"}),e.jsx(_n,{}),e.jsx(Ea,{}),e.jsx(Jl,{yAxisId:"left",type:"monotone",dataKey:"recharge",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.6,name:"Recharge (mm)"}),e.jsx(ui,{yAxisId:"right",type:"monotone",dataKey:"abstraction",stroke:"#ef4444",strokeWidth:2,name:"Abstraction (m/d)"})]})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Wellfield Map"}),e.jsx(mr,{children:"Borehole locations and status"})]}),e.jsx(X,{children:e.jsx("div",{className:"h-[400px] bg-muted rounded-md flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Map visualization placeholder"})})})]}),e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Cross-Section Profile"}),e.jsx(mr,{children:"Groundwater levels across wellfield"})]}),e.jsx(X,{children:e.jsx("div",{className:"h-[400px]",children:e.jsx(Ha,{width:"100%",height:"100%",children:e.jsxs(Km,{data:[{well:"BH-1",wl:45,surface:100},{well:"BH-2",wl:38,surface:95},{well:"BH-3",wl:42,surface:98},{well:"BH-4",wl:35,surface:92},{well:"BH-5",wl:40,surface:97}],children:[e.jsx(Zi,{strokeDasharray:"3 3"}),e.jsx(Ma,{dataKey:"well"}),e.jsx(fa,{}),e.jsx(_n,{}),e.jsx(Ea,{}),e.jsx(ui,{type:"monotone",dataKey:"surface",stroke:"#94a3b8",strokeWidth:2,name:"Ground Surface"}),e.jsx(ui,{type:"monotone",dataKey:"wl",stroke:"#3b82f6",strokeWidth:2,name:"Water Level"})]})})})})]})]})]})}function aVe(){const[t,r]=A.useState({name:"",scheme_id:"",lifeline_enabled:!0,fixed_charge:200,blocks:[{min:0,max:10,rate:25},{min:10,max:30,rate:50},{min:30,max:999,rate:75}],elasticity:.15}),{data:s,isLoading:n,error:a}=it({queryKey:["schemes"],queryFn:async()=>(await pe.get("/api/v1/schemes")).data.data}),{data:o,isLoading:c,error:i,refetch:f}=it({queryKey:["tariff-scenarios"],queryFn:async()=>(await pe.get("/api/v1/dsa/tariffs")).data.data}),p=gt({mutationFn:async T=>(await pe.post("/api/v1/dsa/tariffs",T)).data,onSuccess:()=>{Me.success("Tariff simulation completed"),f()},onError:()=>{Me.error("Failed to run simulation")}}),g=(T,N,M)=>{const O=[...t.blocks];O[T]={...O[T],[N]:M},r({...t,blocks:O})},y=()=>{r({...t,blocks:[...t.blocks,{min:0,max:100,rate:50}]})},b=[{quintile:"Q1 (Poorest)",current:8,proposed:6},{quintile:"Q2",current:5,proposed:4},{quintile:"Q3",current:3,proposed:3},{quintile:"Q4",current:2,proposed:2},{quintile:"Q5 (Richest)",current:1,proposed:1.5}],w=[{category:"Residential",current:45e4,proposed:52e4},{category:"Commercial",current:28e4,proposed:295e3},{category:"Industrial",current:18e4,proposed:175e3}];return e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Tariff Sandbox"}),e.jsx("p",{className:"text-muted-foreground",children:"Design and simulate tariff structures for equity analysis"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(H,{className:"lg:col-span-1",children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Tariff Design"}),e.jsx(mr,{children:"Configure tariff structure"})]}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(we,{children:"Scenario Name"}),e.jsx(Ie,{value:t.name,onChange:T=>r({...t,name:T.target.value}),placeholder:"e.g., Pro-Poor Tariff 2025"})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Fixed Charge (KES)"}),e.jsx(Ie,{type:"number",value:t.fixed_charge,onChange:T=>r({...t,fixed_charge:parseInt(T.target.value)})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(we,{children:"Lifeline Tariff"}),e.jsx(ml,{checked:t.lifeline_enabled,onCheckedChange:T=>r({...t,lifeline_enabled:T})})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Block Tariff Structure"}),e.jsxs("div",{className:"space-y-3 mt-2",children:[t.blocks.map((T,N)=>e.jsxs("div",{className:"p-3 border rounded-md space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Block ",N+1]}),N>0&&e.jsx(K,{size:"sm",variant:"ghost",onClick:()=>r({...t,blocks:t.blocks.filter((M,O)=>O!==N)}),children:"Remove"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx(we,{className:"text-xs",children:"Min (m)"}),e.jsx(Ie,{type:"number",value:T.min,onChange:M=>g(N,"min",parseInt(M.target.value))})]}),e.jsxs("div",{children:[e.jsx(we,{className:"text-xs",children:"Max (m)"}),e.jsx(Ie,{type:"number",value:T.max,onChange:M=>g(N,"max",parseInt(M.target.value))})]}),e.jsxs("div",{children:[e.jsx(we,{className:"text-xs",children:"Rate (KES)"}),e.jsx(Ie,{type:"number",value:T.rate,onChange:M=>g(N,"rate",parseInt(M.target.value))})]})]})]},N)),e.jsx(K,{size:"sm",variant:"outline",onClick:y,className:"w-full",children:"Add Block"})]})]}),e.jsxs("div",{children:[e.jsxs(we,{children:["Demand Elasticity: ",t.elasticity]}),e.jsx(Am,{value:[t.elasticity],onValueChange:([T])=>r({...t,elasticity:T}),min:0,max:.5,step:.05})]}),e.jsxs(K,{className:"w-full",onClick:()=>p.mutate(t),disabled:!t.name||p.isPending,children:[e.jsx(Ui,{className:"h-4 w-4 mr-2"}),"Run Simulation"]})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Tariff Scenarios"})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Name"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Revenue Sufficiency"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:o==null?void 0:o.map(T=>{var N;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:T.name}),e.jsx(J,{children:e.jsx(Ae,{variant:T.status==="approved"?"default":"secondary",children:T.status})}),e.jsx(J,{children:(N=T.results)!=null&&N.sufficiency_pct?`${T.results.sufficiency_pct.toFixed(0)}%`:"-"}),e.jsx(J,{children:e.jsx(K,{size:"sm",variant:"ghost",children:e.jsx(ma,{className:"h-4 w-4"})})})]},T.id)})})]})})]}),e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Affordability by Income Quintile"}),e.jsx(mr,{children:"% of household income spent on water"})]}),e.jsx(X,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(Ha,{width:"100%",height:"100%",children:e.jsxs(tv,{data:b,children:[e.jsx(Zi,{strokeDasharray:"3 3"}),e.jsx(Ma,{dataKey:"quintile"}),e.jsx(fa,{label:{value:"% of Income",angle:-90,position:"insideLeft"}}),e.jsx(_n,{}),e.jsx(Ea,{}),e.jsx(uo,{dataKey:"current",fill:"#94a3b8",name:"Current Tariff"}),e.jsx(uo,{dataKey:"proposed",fill:"#3b82f6",name:"Proposed Tariff"})]})})})})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Revenue Projection by Category"})}),e.jsx(X,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(Ha,{width:"100%",height:"100%",children:e.jsxs(tv,{data:w,children:[e.jsx(Zi,{strokeDasharray:"3 3"}),e.jsx(Ma,{dataKey:"category"}),e.jsx(fa,{}),e.jsx(_n,{}),e.jsx(Ea,{}),e.jsx(uo,{dataKey:"current",fill:"#10b981",name:"Current (KES)"}),e.jsx(uo,{dataKey:"proposed",fill:"#3b82f6",name:"Proposed (KES)"})]})})})})]})]})]})]})}function iVe(){const[t,r]=A.useState("alerts"),[s,n]=A.useState({name:"",description:"",priority:"medium",enabled:!0,signals:[{tag:"",operator:">",threshold:0}],channels:[],quiet_hours_start:null,quiet_hours_end:null}),{data:a,isLoading:o,error:c,refetch:i}=it({queryKey:["ews-rules"],queryFn:async()=>(await pe.get("/api/v1/dsa/ews/rules")).data.data}),{data:f,isLoading:p,error:g,refetch:y}=it({queryKey:["ews-alerts"],queryFn:async()=>(await pe.get("/api/v1/dsa/ews/alerts")).data.data}),b=gt({mutationFn:async C=>(await pe.post("/api/v1/dsa/ews/rules",C)).data,onSuccess:()=>{Me.success("EWS rule created successfully"),i(),n({name:"",description:"",priority:"medium",enabled:!0,signals:[{tag:"",operator:">",threshold:0}],channels:[],quiet_hours_start:null,quiet_hours_end:null})},onError:()=>{Me.error("Failed to create EWS rule")}}),w=gt({mutationFn:async C=>(await pe.post(`/api/v1/dsa/ews/alerts/${C}/acknowledge`)).data,onSuccess:()=>{Me.success("Alert acknowledged"),y()}}),T=()=>{n({...s,signals:[...s.signals,{tag:"",operator:">",threshold:0}]})},N=(C,D,L)=>{const F=[...s.signals];F[C]={...F[C],[D]:L},n({...s,signals:F})},M=C=>{n({...s,signals:s.signals.filter((D,L)=>L!==C)})},O=C=>{switch(C){case"critical":return"destructive";case"high":return"default";case"medium":return"secondary";case"low":return"outline";default:return"outline"}};return e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Early Warning System"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure threshold rules and manage alerts"})]}),e.jsxs(ss,{value:t,onValueChange:C=>r(C),children:[e.jsxs(Yr,{children:[e.jsxs(wt,{value:"alerts",children:[e.jsx(bb,{className:"h-4 w-4 mr-2"}),"Alerts",f&&f.filter(C=>C.status==="new").length>0&&e.jsx(Ae,{className:"ml-2",variant:"destructive",children:f.filter(C=>C.status==="new").length})]}),e.jsx(wt,{value:"rules",children:"Rules Builder"})]}),e.jsxs(kt,{value:"alerts",className:"space-y-6",children:[e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Active Alerts"}),e.jsx(mr,{children:"Real-time early warning notifications"})]}),e.jsxs(X,{children:[e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Rule"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Triggered"}),e.jsx(se,{children:"Response Time"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:f==null?void 0:f.map(C=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:C.rule_name}),e.jsx(J,{children:e.jsx(Ae,{variant:C.status==="new"?"destructive":C.status==="acknowledged"?"secondary":C.status==="resolved"?"default":"outline",children:C.status})}),e.jsx(J,{className:"text-sm",children:new Date(C.created_at).toLocaleString()}),e.jsx(J,{children:C.response_time_minutes?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($s,{className:"h-4 w-4"}),e.jsxs("span",{className:"text-sm",children:[C.response_time_minutes,"m"]})]}):"-"}),e.jsx(J,{children:e.jsx(K,{size:"sm",variant:"ghost",onClick:()=>w.mutate(C.id),disabled:C.status!=="new",children:e.jsx(Zl,{className:"h-4 w-4"})})})]},C.id))})]}),(!f||f.length===0)&&e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(Fr,{className:"h-12 w-12 mx-auto mb-4 opacity-20"}),e.jsx("p",{children:"No active alerts"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"New Alerts"}),e.jsx("p",{className:"text-2xl font-bold",children:(f==null?void 0:f.filter(C=>C.status==="new").length)||0})]}),e.jsx(Ae,{variant:"destructive",className:"h-8 w-8 rounded-full flex items-center justify-center",children:"!"})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Acknowledged"}),e.jsx("p",{className:"text-2xl font-bold",children:(f==null?void 0:f.filter(C=>C.status==="acknowledged").length)||0})]}),e.jsx(Ae,{variant:"secondary",className:"h-8 w-8 rounded-full flex items-center justify-center",children:""})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Resolved"}),e.jsx("p",{className:"text-2xl font-bold",children:(f==null?void 0:f.filter(C=>C.status==="resolved").length)||0})]}),e.jsx(Ae,{variant:"default",className:"h-8 w-8 rounded-full flex items-center justify-center",children:""})]})})}),e.jsx(H,{children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Response"}),e.jsxs("p",{className:"text-2xl font-bold",children:[f&&f.filter(C=>C.response_time_minutes).length>0?Math.round(f.filter(C=>C.response_time_minutes).reduce((C,D)=>C+(D.response_time_minutes||0),0)/f.filter(C=>C.response_time_minutes).length):0,"m"]})]}),e.jsx($s,{className:"h-8 w-8 text-muted-foreground"})]})})})]})]}),e.jsx(kt,{value:"rules",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Create Rule"}),e.jsx(mr,{children:"Define threshold-based alert rules"})]}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(we,{children:"Rule Name"}),e.jsx(Ie,{value:s.name,onChange:C=>n({...s,name:C.target.value}),placeholder:"e.g., Critical Pressure Drop"})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Description"}),e.jsx(ws,{value:s.description,onChange:C=>n({...s,description:C.target.value}),placeholder:"Describe when this rule should trigger..."})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Priority"}),e.jsxs(Nt,{value:s.priority,onValueChange:C=>n({...s,priority:C}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"critical",children:"Critical"}),e.jsx(ge,{value:"high",children:"High"}),e.jsx(ge,{value:"medium",children:"Medium"}),e.jsx(ge,{value:"low",children:"Low"})]})]})]}),e.jsxs("div",{children:[e.jsx(we,{children:"Signal Conditions"}),e.jsxs("div",{className:"space-y-2 mt-2",children:[s.signals.map((C,D)=>e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsx("div",{className:"flex-1",children:e.jsx(Ie,{placeholder:"Tag name",value:C.tag,onChange:L=>N(D,"tag",L.target.value)})}),e.jsxs(Nt,{value:C.operator,onValueChange:L=>N(D,"operator",L),children:[e.jsx(bt,{className:"w-20",children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:">",children:">"}),e.jsx(ge,{value:"<",children:"<"}),e.jsx(ge,{value:">=",children:">="}),e.jsx(ge,{value:"<=",children:"<="}),e.jsx(ge,{value:"=",children:"="})]})]}),e.jsx(Ie,{type:"number",className:"w-24",placeholder:"Value",value:C.threshold,onChange:L=>N(D,"threshold",parseFloat(L.target.value))}),s.signals.length>1&&e.jsx(K,{size:"sm",variant:"ghost",onClick:()=>M(D),children:e.jsx(Ws,{className:"h-4 w-4"})})]},D)),e.jsxs(K,{size:"sm",variant:"outline",onClick:T,className:"w-full",children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Add Signal"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(we,{children:"Enabled"}),e.jsx(ml,{checked:s.enabled,onCheckedChange:C=>n({...s,enabled:C})})]}),e.jsx(K,{className:"w-full",onClick:()=>b.mutate(s),disabled:!s.name||s.signals.length===0||b.isPending,children:"Create Rule"})]})]}),e.jsxs(H,{className:"lg:col-span-2",children:[e.jsx(ue,{children:e.jsx(he,{children:"Configured Rules"})}),e.jsx(X,{children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Name"}),e.jsx(se,{children:"Priority"}),e.jsx(se,{children:"Signals"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Actions"})]})}),e.jsx(lr,{children:a==null?void 0:a.map(C=>e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:C.name}),e.jsx(J,{children:e.jsx(Ae,{variant:O(C.priority),children:C.priority})}),e.jsxs(J,{className:"text-sm",children:[C.signals.length," condition",C.signals.length>1?"s":""]}),e.jsx(J,{children:e.jsx(Ae,{variant:C.enabled?"default":"outline",children:C.enabled?"Active":"Disabled"})}),e.jsx(J,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{size:"sm",variant:"ghost",children:"Edit"}),e.jsx(K,{size:"sm",variant:"ghost",children:e.jsx(Ws,{className:"h-4 w-4"})})]})})]},C.id))})]})})]})]})})]})]})}const oVe="/api/v1";async function Zs(t,r){try{const s=localStorage.getItem("auth_token"),n=await fetch(`${oVe}${t}`,{headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",...s?{Authorization:`Bearer ${s}`}:{},...r==null?void 0:r.headers},credentials:"include",...r});if(!n.ok)throw new Error(`API error: ${n.status}`);return await n.json()}catch{return console.warn(`Laravel API unavailable (${t}), using fallback`),null}}const Tg={list:t=>{const r=new URLSearchParams(t);return Zs(`/schemes${r.toString()?`?${r}`:""}`)},create:t=>Zs("/schemes",{method:"POST",body:JSON.stringify(t)}),get:t=>Zs(`/schemes/${t}`),update:(t,r)=>Zs(`/schemes/${t}`,{method:"PUT",body:JSON.stringify(r)}),delete:t=>Zs(`/schemes/${t}`,{method:"DELETE"})},lVe={list:t=>{const r=new URLSearchParams(t);return Zs(`/assets${r.toString()?`?${r}`:""}`)},create:t=>Zs("/assets",{method:"POST",body:JSON.stringify(t)}),get:t=>Zs(`/assets/${t}`),update:(t,r)=>Zs(`/assets/${t}`,{method:"PUT",body:JSON.stringify(r)}),delete:t=>Zs(`/assets/${t}`,{method:"DELETE"}),getByScheme:t=>Zs(`/schemes/${t}/assets`)},U8={tags:t=>{const r=new URLSearchParams(t);return Zs(`/telemetry/tags${r.toString()?`?${r}`:""}`)},createTag:t=>Zs("/telemetry/tags",{method:"POST",body:JSON.stringify(t)}),updateTag:(t,r)=>Zs(`/telemetry/tags/${t}`,{method:"PUT",body:JSON.stringify(r)}),measurements:(t,r)=>{const s=new URLSearchParams(r),n=t?`/telemetry/tags/${t}/measurements`:"/telemetry/measurements";return Zs(`${n}${s.toString()?`?${s}`:""}`)},recordMeasurement:(t,r,s)=>Zs("/telemetry/measurements",{method:"POST",body:JSON.stringify({tag_id:t,value:r,metadata:s})}),recordBatch:t=>Zs("/telemetry/measurements/batch",{method:"POST",body:JSON.stringify({measurements:t})})},W8={list:t=>{const r=new URLSearchParams(t);return Zs(`/outages${r.toString()?`?${r}`:""}`)},create:t=>Zs("/outages",{method:"POST",body:JSON.stringify(t)}),get:t=>Zs(`/outages/${t}`),update:(t,r)=>Zs(`/outages/${t}`,{method:"PUT",body:JSON.stringify(r)}),updateState:(t,r,s)=>Zs(`/outages/${t}/state`,{method:"PATCH",body:JSON.stringify({state:r,notes:s})}),delete:t=>Zs(`/outages/${t}`,{method:"DELETE"})},G8={assetFailures:t=>{const r=new URLSearchParams(t);return Zs(`/predictions/asset-failures${r.toString()?`?${r}`:""}`)},nrwAnomalies:t=>{const r=new URLSearchParams(t);return Zs(`/predictions/nrw-anomalies${r.toString()?`?${r}`:""}`)}},K8={nodes:t=>Zs(`/topology/schemes/${t}/nodes`),createNode:(t,r)=>Zs(`/topology/schemes/${t}/nodes`,{method:"POST",body:JSON.stringify(r)}),updateNode:(t,r,s)=>Zs(`/topology/schemes/${t}/nodes/${r}`,{method:"PUT",body:JSON.stringify(s)}),edges:t=>Zs(`/topology/schemes/${t}/edges`),createEdge:(t,r)=>Zs(`/topology/schemes/${t}/edges`,{method:"POST",body:JSON.stringify(r)}),updateEdge:(t,r,s)=>Zs(`/topology/schemes/${t}/edges/${r}`,{method:"PUT",body:JSON.stringify(s)}),nodesNearby:(t,r,s,n=5)=>Zs(`/topology/schemes/${t}/nodes/nearby?lat=${r}&lon=${s}&radius_km=${n}`),pathBetweenNodes:(t,r,s)=>Zs(`/topology/schemes/${t}/path?from=${r}&to=${s}`)};let ri=null,RT=0;const cVe=5,dVe=3e3,D0={connect:(t,r)=>{if((ri==null?void 0:ri.readyState)===WebSocket.OPEN)return;const s="ws://127.0.0.1:8001".replace("http","ws")+"/telemetry";ri=new WebSocket(s),ri.onopen=()=>{console.log(" Telemetry WebSocket connected"),RT=0},ri.onmessage=n=>{try{const a=JSON.parse(n.data);t(a)}catch(a){console.error("Failed to parse WebSocket message:",a)}},ri.onerror=n=>{console.error("WebSocket error:",n),r&&r(n)},ri.onclose=()=>{console.warn("Telemetry WebSocket disconnected"),RT<cVe&&(RT++,setTimeout(()=>D0.connect(t,r),dVe))}},subscribe:t=>{(ri==null?void 0:ri.readyState)===WebSocket.OPEN&&ri.send(JSON.stringify({action:"subscribe",tag_ids:t}))},unsubscribe:t=>{(ri==null?void 0:ri.readyState)===WebSocket.OPEN&&ri.send(JSON.stringify({action:"unsubscribe",tag_ids:t}))},disconnect:()=>{ri&&(ri.close(),ri=null)}},LQ=EG,FQ=A.createContext({}),gd=({...t})=>e.jsx(FQ.Provider,{value:{name:t.name},children:e.jsx(GC,{...t})}),BP=()=>{const t=A.useContext(FQ),r=A.useContext($Q),{getFieldState:s,formState:n}=jv(),a=s(t.name,n);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:o}=r;return{id:o,name:t.name,formItemId:`${o}-form-item`,formDescriptionId:`${o}-form-item-description`,formMessageId:`${o}-form-item-message`,...a}},$Q=A.createContext({}),Oc=A.forwardRef(({className:t,...r},s)=>{const n=A.useId();return e.jsx($Q.Provider,{value:{id:n},children:e.jsx("div",{ref:s,className:dr("space-y-2",t),...r})})});Oc.displayName="FormItem";const Ic=A.forwardRef(({className:t,...r},s)=>{const{error:n,formItemId:a}=BP();return e.jsx(we,{ref:s,className:dr(n&&"text-destructive",t),htmlFor:a,...r})});Ic.displayName="FormLabel";const Dc=A.forwardRef(({...t},r)=>{const{error:s,formItemId:n,formDescriptionId:a,formMessageId:o}=BP();return e.jsx(Ad,{ref:r,id:n,"aria-describedby":s?`${a} ${o}`:`${a}`,"aria-invalid":!!s,...t})});Dc.displayName="FormControl";const uVe=A.forwardRef(({className:t,...r},s)=>{const{formDescriptionId:n}=BP();return e.jsx("p",{ref:s,id:n,className:dr("text-[0.8rem] text-muted-foreground",t),...r})});uVe.displayName="FormDescription";const Rc=A.forwardRef(({className:t,children:r,...s},n)=>{const{error:a,formMessageId:o}=BP(),c=a?String((a==null?void 0:a.message)??""):r;return c?e.jsx("p",{ref:n,id:o,className:dr("text-[0.8rem] font-medium text-destructive",t),...s,children:c}):null});Rc.displayName="FormMessage";const hVe=Ld({code:wa().min(1,"Code required"),name:wa().min(1,"Name required"),type:WS(["piped","handpump","borehole","spring"]),ownership:WS(["public","private","community"]),county:wa().optional(),populationServed:xxe.number().optional()});function mVe({onSubmit:t,defaultValues:r,isLoading:s}){const n=Ya({resolver:Ed(hVe),defaultValues:r||{}});return e.jsx(LQ,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(t),className:"space-y-4",children:[e.jsx(gd,{control:n.control,name:"code",render:({field:a})=>e.jsxs(Oc,{children:[e.jsx(Ic,{children:"Scheme Code"}),e.jsx(Dc,{children:e.jsx(Ie,{placeholder:"e.g., TRK_LOD_001",...a})}),e.jsx(Rc,{})]})}),e.jsx(gd,{control:n.control,name:"name",render:({field:a})=>e.jsxs(Oc,{children:[e.jsx(Ic,{children:"Scheme Name"}),e.jsx(Dc,{children:e.jsx(Ie,{placeholder:"e.g., Lodwar Water Supply Scheme",...a})}),e.jsx(Rc,{})]})}),e.jsx(gd,{control:n.control,name:"type",render:({field:a})=>e.jsxs(Oc,{children:[e.jsx(Ic,{children:"Type"}),e.jsxs(Nt,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(Dc,{children:e.jsx(bt,{children:e.jsx(St,{placeholder:"Select type"})})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"piped",children:"Piped"}),e.jsx(ge,{value:"handpump",children:"Hand Pump"}),e.jsx(ge,{value:"borehole",children:"Borehole"}),e.jsx(ge,{value:"spring",children:"Spring"})]})]}),e.jsx(Rc,{})]})}),e.jsx(gd,{control:n.control,name:"ownership",render:({field:a})=>e.jsxs(Oc,{children:[e.jsx(Ic,{children:"Ownership"}),e.jsxs(Nt,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(Dc,{children:e.jsx(bt,{children:e.jsx(St,{placeholder:"Select ownership"})})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"public",children:"Public"}),e.jsx(ge,{value:"private",children:"Private"}),e.jsx(ge,{value:"community",children:"Community"})]})]}),e.jsx(Rc,{})]})}),e.jsx(K,{type:"submit",disabled:s,children:s?"Saving...":"Save Scheme"})]})})}function fVe(){var O,C,D;const[t,r]=A.useState(!1),[s,n]=A.useState(null),[a,o]=A.useState(null),[c,i]=A.useState(!1),[f,p]=A.useState(!1),{data:g,isLoading:y,refetch:b}=it({queryKey:["schemes"],queryFn:async()=>{const L=await Tg.list();return L||{data:[]}}}),w=async L=>{i(!0);try{if(s)if(await Tg.update(s,L))Me.success("Scheme updated successfully");else throw new Error("Failed to update scheme");else if(await Tg.create(L))Me.success("Scheme created successfully");else throw new Error("Failed to create scheme");r(!1),n(null),b()}catch(F){Me.error(F.message||"Error saving scheme")}finally{i(!1)}},T=async()=>{if(a){p(!0);try{if(await Tg.delete(a)!==null)Me.success("Scheme deleted successfully"),b();else throw new Error("Failed to delete scheme")}catch(L){Me.error(L.message||"Error deleting scheme")}finally{p(!1),o(null)}}},N=()=>{r(!1),n(null)},M=(O=g==null?void 0:g.data)==null?void 0:O.find(L=>L.id===a);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Water Schemes Registry"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage water supply schemes and infrastructure"})]}),e.jsxs(K,{onClick:()=>r(!0),className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Scheme"]})]}),(t||s)&&e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between",children:[e.jsx(he,{children:s?"Edit Scheme":"Create New Scheme"}),e.jsx(K,{variant:"ghost",size:"icon",onClick:N,children:e.jsx(Ko,{className:"h-4 w-4"})})]}),e.jsx(X,{children:e.jsx(mVe,{onSubmit:w,isLoading:c,defaultValues:s&&(g!=null&&g.data)?g.data.find(L=>L.id===s):void 0})})]}),y?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading schemes..."}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(C=g==null?void 0:g.data)==null?void 0:C.map(L=>{var F,B;return e.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(he,{className:"text-lg",children:L.name}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(K,{variant:"ghost",size:"icon",onClick:()=>n(L.id),children:e.jsx(k_,{className:"h-4 w-4"})}),e.jsx(K,{variant:"ghost",size:"icon",onClick:()=>o(L.id),className:"text-destructive hover:text-destructive",children:e.jsx(Ws,{className:"h-4 w-4"})})]})]})}),e.jsxs(X,{className:"space-y-2",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Code:"})," ",L.code]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Type:"})," ",L.type]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Status:"})," ",e.jsx(Ae,{className:L.status==="active"?"bg-green-500":"bg-gray-500",children:L.status||"pending"})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-semibold",children:"County:"})," ",L.county]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Pop. Served:"})," ",((F=L.populationServed)==null?void 0:F.toLocaleString())||"-"]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Connections:"})," ",((B=L.connections)==null?void 0:B.toLocaleString())||"-"]})]})]},L.id)}),((D=g==null?void 0:g.data)==null?void 0:D.length)===0&&e.jsx("div",{className:"col-span-full text-center py-12 text-muted-foreground",children:'No schemes found. Click "New Scheme" to create one.'})]}),e.jsx(KC,{open:!!a,onOpenChange:L=>!L&&o(null),children:e.jsxs(B_,{children:[e.jsxs(q_,{children:[e.jsx(U_,{children:"Delete Scheme"}),e.jsxs(W_,{children:['Are you sure you want to delete "',M==null?void 0:M.name,'"? This action cannot be undone. All associated assets, DMAs, and connections may be affected.']})]}),e.jsxs(V_,{children:[e.jsx(K_,{disabled:f,children:"Cancel"}),e.jsx(G_,{onClick:T,disabled:f,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:f?e.jsxs(e.Fragment,{children:[e.jsx(as,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):"Delete"})]})]})})]})}function pVe(){var s,n;const{data:t}=it({queryKey:["predictions-failures"],queryFn:G8.assetFailures,staleTime:3e5}),{data:r}=it({queryKey:["predictions-anomalies"],queryFn:G8.nrwAnomalies,staleTime:5*60*1e3});return!(t!=null&&t.data)&&!(r!=null&&r.data)?null:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(s=t==null?void 0:t.data)==null?void 0:s.map(a=>e.jsxs(H,{className:"border-red-500/30 bg-red-500/5",children:[e.jsx(ue,{children:e.jsxs(he,{className:"text-sm flex items-center gap-2",children:[e.jsx(Fr,{className:"h-4 w-4 text-red-500"}),"Asset Failure Risk"]})}),e.jsxs(X,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:a.assetId}),e.jsxs(Ae,{variant:a.riskLevel==="high"?"destructive":"secondary",children:[a.failureProbability,"% risk"]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Failure in ",a.daysToFailure," days (Confidence: ",(a.confidence*100).toFixed(0),"%)"]}),e.jsx("div",{className:"text-xs",children:a.recommendedAction.replace(/_/g," ")})]})]},a.assetId)),(n=r==null?void 0:r.data)==null?void 0:n.map(a=>e.jsxs(H,{className:"border-orange-500/30 bg-orange-500/5",children:[e.jsx(ue,{children:e.jsxs(he,{className:"text-sm flex items-center gap-2",children:[e.jsx(ci,{className:"h-4 w-4 text-orange-500"}),"NRW Anomaly"]})}),e.jsxs(X,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:a.dmaId}),e.jsxs(Ae,{className:"bg-orange-500/30 text-orange-700",children:[a.nrwPercentage,"% NRW"]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Loss: ",(a.estimatedLossMc/1e3).toFixed(1),"K m/day | Cost: ",(a.estimatedCostPerDay/1e3).toFixed(0),"K"]})]})]},a.dmaId))]})}const xVe={time_based:"Time-Based",usage_based:"Usage-Based",combined:"Combined"},gVe={time_based:"bg-blue-100 text-blue-800",usage_based:"bg-purple-100 text-purple-800",combined:"bg-green-100 text-green-800"};function yVe(){const t=yr(),[r,s]=A.useState(!1),[n,a]=A.useState(),[o,c]=A.useState(void 0),[i,f]=A.useState(void 0),[p,g]=A.useState(""),[y,b]=A.useState(""),[w,T]=A.useState("time_based"),[N,M]=A.useState(""),[O,C]=A.useState(""),[D,L]=A.useState(""),[F,B]=A.useState(!0),[U,te]=A.useState(""),{data:Q,isLoading:re}=it({queryKey:["pm-templates",o,i],queryFn:()=>_i.getPmTemplates({is_active:o,asset_class_id:i})}),{data:Z}=it({queryKey:["asset-classes"],queryFn:()=>_i.getClasses()}),ne=gt({mutationFn:He=>_i.createPmTemplate(He),onSuccess:()=>{t.invalidateQueries({queryKey:["pm-templates"]}),Se(),s(!1),Me.success("PM template created successfully")},onError:He=>{Me.error(He.message||"Failed to create template")}}),oe=gt({mutationFn:({id:He,data:Ve})=>_i.updatePmTemplate(He,Ve),onSuccess:()=>{t.invalidateQueries({queryKey:["pm-templates"]}),Se(),s(!1),Me.success("PM template updated successfully")},onError:He=>{Me.error(He.message||"Failed to update template")}}),Ce=gt({mutationFn:He=>_i.deletePmTemplate(He),onSuccess:()=>{t.invalidateQueries({queryKey:["pm-templates"]}),Me.success("PM template deleted")},onError:He=>{Me.error(He.message||"Failed to delete template")}}),Pe=gt({mutationFn:He=>_i.generatePmWorkOrders(He),onSuccess:He=>{t.invalidateQueries({queryKey:["work-orders"]}),Me.success(`Generated ${He.count} work orders`)},onError:He=>{Me.error(He.message||"Failed to generate work orders")}}),Se=()=>{g(""),b(""),T("time_based"),M(""),C(""),L(""),B(!0),te(""),a(void 0)},ae=He=>{var Ve,yt,Et;a(He),g(He.name),b(He.description||""),T(He.trigger_type),M(((Ve=He.frequency_days)==null?void 0:Ve.toString())||""),C(((yt=He.tolerance_days)==null?void 0:yt.toString())||""),L(He.asset_class_id.toString()),B(He.is_active),te(((Et=He.checklist)==null?void 0:Et.join(`
`))||""),s(!0)},be=()=>{if(!p||!D)return;const He={name:p,description:y||void 0,trigger_type:w,frequency_days:N?parseInt(N):void 0,tolerance_days:O?parseInt(O):void 0,asset_class_id:parseInt(D),is_active:F,checklist:U?U.split(`
`).filter(Ve=>Ve.trim()):void 0};n?oe.mutate({id:n.id,data:He}):ne.mutate(He)},de=(Q==null?void 0:Q.filter(He=>He.is_active).length)||0,Ke=(Q==null?void 0:Q.length)||0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(H,{children:[e.jsx(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:e.jsx(he,{className:"text-sm font-medium",children:"Total Templates"})}),e.jsx(X,{children:e.jsx("div",{className:"text-2xl font-bold",children:Ke})})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Active"}),e.jsx(Ns,{className:"h-4 w-4 text-green-500"})]}),e.jsx(X,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:de})})]}),e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:"Inactive"}),e.jsx(Fr,{className:"h-4 w-4 text-yellow-500"})]}),e.jsx(X,{children:e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:Ke-de})})]}),e.jsx(H,{className:"flex flex-col justify-center",children:e.jsx(X,{className:"pt-6",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{variant:"outline",size:"sm",onClick:()=>Pe.mutate(void 0),disabled:Pe.isPending,children:[Pe.isPending?e.jsx(as,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Ui,{className:"mr-2 h-4 w-4"}),"Generate All"]}),e.jsxs(K,{size:"sm",onClick:()=>{Se(),s(!0)},children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"New"]})]})})})]}),e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsxs("div",{className:"flex gap-4 mb-4",children:[e.jsxs(Nt,{value:o===void 0?"all":o?"active":"inactive",onValueChange:He=>c(He==="all"?void 0:He==="active"),children:[e.jsx(bt,{className:"w-[160px]",children:e.jsx(St,{placeholder:"Status"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Templates"}),e.jsx(ge,{value:"active",children:"Active Only"}),e.jsx(ge,{value:"inactive",children:"Inactive Only"})]})]}),e.jsxs(Nt,{value:(i==null?void 0:i.toString())||"all",onValueChange:He=>f(He==="all"?void 0:parseInt(He)),children:[e.jsx(bt,{className:"w-[180px]",children:e.jsx(St,{placeholder:"Asset Class"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"all",children:"All Classes"}),Z==null?void 0:Z.map(He=>e.jsx(ge,{value:He.id.toString(),children:He.name},He.id))]})]})]}),re?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(as,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsx("div",{className:"border rounded-lg",children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Template Name"}),e.jsx(se,{children:"Asset Class"}),e.jsx(se,{children:"Trigger"}),e.jsx(se,{children:"Frequency"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Next Gen"}),e.jsx(se,{className:"text-right",children:"Actions"})]})}),e.jsx(lr,{children:(Q==null?void 0:Q.length)===0?e.jsx(Qe,{children:e.jsx(J,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No PM templates found. Create your first template to schedule preventive maintenance."})}):Q==null?void 0:Q.map(He=>{var Ve;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:He.name}),e.jsx(J,{children:((Ve=He.asset_class)==null?void 0:Ve.name)||"-"}),e.jsx(J,{children:e.jsx(Ae,{className:gVe[He.trigger_type],children:xVe[He.trigger_type]})}),e.jsx(J,{children:He.frequency_days?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(wn,{className:"h-3 w-3"}),He.frequency_days,"d"]}):"-"}),e.jsx(J,{children:e.jsx(Ae,{variant:He.is_active?"default":"secondary",children:He.is_active?"Active":"Inactive"})}),e.jsx(J,{children:He.next_gen_date?e.jsxs("span",{className:"flex items-center gap-1 text-sm",children:[e.jsx($s,{className:"h-3 w-3"}),new Date(He.next_gen_date).toLocaleDateString()]}):"-"}),e.jsx(J,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(K,{variant:"ghost",size:"icon",onClick:()=>Pe.mutate(He.id),disabled:Pe.isPending,title:"Generate work orders",children:e.jsx(Ui,{className:"h-4 w-4"})}),e.jsx(K,{variant:"ghost",size:"icon",onClick:()=>ae(He),children:e.jsx(ki,{className:"h-4 w-4"})}),e.jsx(K,{variant:"ghost",size:"icon",onClick:()=>{confirm("Delete this PM template?")&&Ce.mutate(He.id)},className:"text-destructive hover:text-destructive",children:e.jsx(Ws,{className:"h-4 w-4"})})]})})]},He.id)})})]})})]})}),e.jsx(Qt,{open:r,onOpenChange:He=>{s(He),He||Se()},children:e.jsxs(Zt,{className:"max-w-lg",children:[e.jsx(Yt,{children:e.jsx(Xt,{children:n?"Edit PM Template":"Create PM Template"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"pm-name",children:"Template Name *"}),e.jsx(Ie,{id:"pm-name",placeholder:"e.g., Monthly Pump Inspection",value:p,onChange:He=>g(He.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"pm-description",children:"Description"}),e.jsx(ws,{id:"pm-description",placeholder:"Describe the maintenance activities...",value:y,onChange:He=>b(He.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"pm-asset-class",children:"Asset Class *"}),e.jsxs(Nt,{value:D,onValueChange:L,children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select asset class"})}),e.jsx(_t,{children:Z==null?void 0:Z.map(He=>e.jsx(ge,{value:He.id.toString(),children:He.name},He.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"pm-trigger-type",children:"Trigger Type"}),e.jsxs(Nt,{value:w,onValueChange:He=>T(He),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"time_based",children:"Time-Based"}),e.jsx(ge,{value:"usage_based",children:"Usage-Based"}),e.jsx(ge,{value:"combined",children:"Combined"})]})]})]}),(w==="time_based"||w==="combined")&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"pm-frequency",children:"Frequency (Days)"}),e.jsx(Ie,{id:"pm-frequency",type:"number",placeholder:"e.g., 30",value:N,onChange:He=>M(He.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"pm-tolerance",children:"Tolerance (Days)"}),e.jsx(Ie,{id:"pm-tolerance",type:"number",placeholder:"e.g., 5",value:O,onChange:He=>C(He.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{htmlFor:"pm-checklist",children:"Checklist Items (one per line)"}),e.jsx(ws,{id:"pm-checklist",placeholder:`Check oil level
Inspect belts
Test alarms`,rows:3,value:U,onChange:He=>te(He.target.value)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ml,{id:"pm-is-active",checked:F,onCheckedChange:B}),e.jsx(we,{htmlFor:"pm-is-active",children:"Active"})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),e.jsxs(K,{onClick:be,disabled:!p||!D||ne.isPending||oe.isPending,children:[(ne.isPending||oe.isPending)&&e.jsx(as,{className:"mr-2 h-4 w-4 animate-spin"}),n?"Update":"Create"]})]})]})})]})}const vVe=[{value:"none",label:"All Statuses"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"retired",label:"Retired"},{value:"under_maintenance",label:"Under Maintenance"}],jVe={active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",retired:"bg-red-100 text-red-800",under_maintenance:"bg-yellow-100 text-yellow-800"};function bVe(){var L,F,B;const[t,r]=A.useState({per_page:15,page:1}),[s,n]=A.useState(!1),[a,o]=A.useState(),[c,i]=A.useState(null),[f,p]=A.useState(!1),{data:g}=it({queryKey:["asset-classes"],queryFn:()=>_i.getClasses()}),{data:y,isLoading:b,error:w,refetch:T}=it({queryKey:["assets",t],queryFn:()=>_i.getAssets(t)}),N=U=>{r({...t,search:U,page:1})},M=U=>{r({...t,status:U&&U!=="none"?U:void 0,page:1})},O=U=>{r({...t,class_id:U&&U!=="none"?Number(U):void 0,page:1})},C=async()=>{if(c){p(!0);try{await _i.deleteAsset(c.id),Me.success(`${c.name} has been deleted.`),i(null),T()}catch(U){Me.error(U.message||"Could not delete asset")}finally{p(!1)}}},D=U=>U.source_id?e.jsx(Fl,{className:"h-4 w-4 text-blue-500"}):U.kiosk_id?e.jsx(bS,{className:"h-4 w-4 text-green-500"}):null;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Infrastructure Assets"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage water supply assets, equipment, and infrastructure"})]}),e.jsxs(K,{onClick:()=>{o(void 0),n(!0)},children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Add Asset"]})]}),e.jsxs(ss,{defaultValue:"inventory",className:"w-full",children:[e.jsxs(Yr,{children:[e.jsx(wt,{value:"inventory",children:"Asset Registry"}),e.jsx(wt,{value:"pm",children:"Preventive Maintenance"}),e.jsx(wt,{value:"predictions",children:"Predictive Maintenance"})]}),e.jsx(kt,{value:"inventory",className:"space-y-4",children:b&&!y?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading assets..."})}):w?e.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:e.jsxs("p",{className:"text-lg text-destructive",children:["Error loading assets: ",w.message]})}):e.jsx(H,{children:e.jsxs(X,{className:"pt-6",children:[e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(nn,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(Ie,{placeholder:"Search by code, name, or serial...",className:"pl-9",value:t.search||"",onChange:U=>N(U.target.value)})]})}),e.jsxs(Nt,{value:t.status||"",onValueChange:M,children:[e.jsx(bt,{className:"w-[200px]",children:e.jsx(St,{placeholder:"Filter by status"})}),e.jsx(_t,{children:vVe.map(U=>e.jsx(ge,{value:U.value,children:U.label},U.value))})]}),e.jsxs(Nt,{value:((L=t.class_id)==null?void 0:L.toString())||"none",onValueChange:O,children:[e.jsx(bt,{className:"w-[200px]",children:e.jsx(St,{placeholder:"Filter by class"})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"none",children:"All Classes"}),g==null?void 0:g.map(U=>e.jsx(ge,{value:U.id.toString(),children:U.name},U.id))]})]})]}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsxs(Qe,{children:[e.jsx(se,{children:"Code"}),e.jsx(se,{children:"Name"}),e.jsx(se,{children:"Class"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Linked To"}),e.jsx(se,{children:"Manufacturer"}),e.jsx(se,{children:"Install Date"}),e.jsx(se,{className:"text-right",children:"Actions"})]})}),e.jsx(lr,{children:(F=y==null?void 0:y.data)==null?void 0:F.map(U=>{var te,Q,re,Z;return e.jsxs(Qe,{children:[e.jsx(J,{className:"font-medium",children:U.code}),e.jsx(J,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[U.geom&&e.jsx(fn,{className:"h-4 w-4 text-muted-foreground"}),U.name]})}),e.jsx(J,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Gn,{className:"h-4 w-4 text-muted-foreground"}),((te=U.asset_class)==null?void 0:te.name)||"Unknown"]})}),e.jsx(J,{children:e.jsx(Ae,{className:jVe[U.status]||"bg-gray-100",children:((Q=U.status)==null?void 0:Q.replace("_"," "))||"Unknown"})}),e.jsx(J,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[D(U),((re=U.source)==null?void 0:re.name)&&e.jsx("span",{className:"text-sm text-muted-foreground",children:U.source.code||U.source.name}),((Z=U.kiosk)==null?void 0:Z.kiosk_code)&&e.jsx("span",{className:"text-sm text-muted-foreground",children:U.kiosk.kiosk_code}),!U.source_id&&!U.kiosk_id&&e.jsx("span",{className:"text-sm text-muted-foreground",children:"-"})]})}),e.jsx(J,{className:"text-muted-foreground",children:U.manufacturer||"-"}),e.jsx(J,{className:"text-muted-foreground",children:U.install_date?new Date(U.install_date).toLocaleDateString():"-"}),e.jsx(J,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(Pn,{to:`/core/assets/${U.id}`,children:e.jsx(K,{variant:"ghost",size:"sm",title:"View Details",children:"View"})}),e.jsx(K,{variant:"ghost",size:"sm",title:"Edit Asset",onClick:()=>{o(U),n(!0)},children:e.jsx(ki,{className:"h-4 w-4"})}),e.jsx(Pn,{to:`/cmms/work-orders?asset_id=${U.id}`,children:e.jsx(K,{variant:"ghost",size:"sm",title:"View Work Orders",children:e.jsx(Vc,{className:"h-4 w-4"})})}),e.jsx(K,{variant:"ghost",size:"sm",title:"Delete Asset",className:"text-destructive hover:text-destructive",onClick:()=>i(U),children:e.jsx(Ws,{className:"h-4 w-4"})})]})})]},U.id)})})]})}),((B=y==null?void 0:y.data)==null?void 0:B.length)===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center p-12",children:[e.jsx(Gn,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No assets found"}),e.jsxs(K,{onClick:()=>{o(void 0),n(!0)},children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Add Your First Asset"]})]}),y&&y.total>0&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",y.from," to ",y.to," of ",y.total," assets"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{variant:"outline",size:"sm",disabled:y.current_page===1,onClick:()=>r({...t,page:(t.page||1)-1}),children:"Previous"}),e.jsx(K,{variant:"outline",size:"sm",disabled:y.current_page===y.last_page,onClick:()=>r({...t,page:(t.page||1)+1}),children:"Next"})]})]})]})})}),e.jsx(kt,{value:"pm",children:e.jsx(yVe,{})}),e.jsx(kt,{value:"predictions",children:e.jsx(pVe,{})})]}),e.jsx(tpe,{open:s,onOpenChange:U=>{n(U),U||o(void 0)},asset:a}),e.jsx(KC,{open:!!c,onOpenChange:U=>!U&&i(null),children:e.jsxs(B_,{children:[e.jsxs(q_,{children:[e.jsx(U_,{children:"Delete Asset"}),e.jsxs(W_,{children:['Are you sure you want to delete "',c==null?void 0:c.name,'"? This action cannot be undone. Any linked work orders or maintenance records may be affected.']})]}),e.jsxs(V_,{children:[e.jsx(K_,{disabled:f,children:"Cancel"}),e.jsx(G_,{onClick:C,disabled:f,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:f?"Deleting...":"Delete"})]})]})})]})}const _Ve=Ld({tag:wa().min(1,"Tag name required").regex(/^[A-Z_0-9]+$/,"Use uppercase and underscores"),ioType:WS(["AI","DI","AO","DO"]),unit:wa().optional(),assetId:wa().optional(),scale:wa().optional(),thresholds:wa().optional()});function wVe({onSubmit:t,defaultValues:r,isLoading:s,assetOptions:n=[]}){const a=Ya({resolver:Ed(_Ve),defaultValues:{tag:"",ioType:"AI",unit:"",assetId:"",scale:"",thresholds:"",...r},mode:"onBlur"});return e.jsx(LQ,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(t),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(gd,{control:a.control,name:"tag",render:({field:o})=>e.jsxs(Oc,{children:[e.jsx(Ic,{children:"Tag Name"}),e.jsx(Dc,{children:e.jsx(Ie,{placeholder:"e.g., PUMP_001_FLOW",...o})}),e.jsx(Rc,{})]})}),e.jsx(gd,{control:a.control,name:"ioType",render:({field:o})=>e.jsxs(Oc,{children:[e.jsx(Ic,{children:"I/O Type"}),e.jsxs(Nt,{onValueChange:o.onChange,value:o.value||"AI",children:[e.jsx(Dc,{children:e.jsx(bt,{children:e.jsx(St,{placeholder:"Select type"})})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"AI",children:"Analog Input"}),e.jsx(ge,{value:"DI",children:"Digital Input"}),e.jsx(ge,{value:"AO",children:"Analog Output"}),e.jsx(ge,{value:"DO",children:"Digital Output"})]})]}),e.jsx(Rc,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(gd,{control:a.control,name:"unit",render:({field:o})=>e.jsxs(Oc,{children:[e.jsx(Ic,{children:"Unit"}),e.jsx(Dc,{children:e.jsx(Ie,{placeholder:"e.g., lpm, bar, C, m3",...o})}),e.jsx(Rc,{})]})}),e.jsx(gd,{control:a.control,name:"assetId",render:({field:o})=>e.jsxs(Oc,{children:[e.jsx(Ic,{children:"Asset (Optional)"}),e.jsxs(Nt,{onValueChange:o.onChange,value:o.value||"",children:[e.jsx(Dc,{children:e.jsx(bt,{children:e.jsx(St,{placeholder:"Select asset"})})}),e.jsx(_t,{children:n&&n.length>0?n.map(c=>e.jsxs(ge,{value:c.id.toString(),children:[c.name," (",c.code,")"]},c.id)):e.jsx(ge,{value:"none",disabled:!0,children:"No assets available"})})]}),e.jsx(Rc,{})]})})]}),e.jsx(gd,{control:a.control,name:"scale",render:({field:o})=>e.jsxs(Oc,{children:[e.jsx(Ic,{children:"Scale (JSON)"}),e.jsx(Dc,{children:e.jsx(ws,{placeholder:'{"min": 0, "max": 500, "offset": 0}',className:"h-20",...o})}),e.jsx(Rc,{})]})}),e.jsx(gd,{control:a.control,name:"thresholds",render:({field:o})=>e.jsxs(Oc,{children:[e.jsx(Ic,{children:"Thresholds (JSON)"}),e.jsx(Dc,{children:e.jsx(ws,{placeholder:'{"critical_low": 10, "warning_low": 50, "warning_high": 450, "critical_high": 490}',className:"h-24",...o})}),e.jsx(Rc,{})]})}),e.jsx(K,{type:"submit",disabled:s,className:"w-full",children:s?"Saving...":"Save Telemetry Tag"})]})})}function NVe(t=[]){const[r,s]=A.useState({}),[n,a]=A.useState(!1),[o,c]=A.useState(null),i=A.useRef(new Set),f=A.useCallback(g=>{g.type==="measurement"&&g.tag_id&&s(y=>({...y,[g.tag_id]:{tag_id:g.tag_id,tag:g.tag,value:g.value,timestamp:g.timestamp||new Date().toISOString(),unit:g.unit}}))},[]),p=A.useCallback(g=>{c(g),a(!1)},[]);return A.useEffect(()=>(D0.connect(f,p),a(!0),()=>{D0.disconnect()}),[f,p]),A.useEffect(()=>{if(!n||t.length===0)return;const g=t.filter(b=>!i.current.has(b)),y=Array.from(i.current).filter(b=>!t.includes(b));g.length>0&&(D0.subscribe(g),g.forEach(b=>i.current.add(b))),y.length>0&&(D0.unsubscribe(y),y.forEach(b=>i.current.delete(b)))},[t,n]),{measurements:r,isConnected:n,error:o}}function SVe(){var Q,re,Z;const[t,r]=A.useState(!1),[s,n]=A.useState([]),[a,o]=A.useState(!1),[c,i]=A.useState(null),[f,p]=A.useState("24h"),[g,y]=A.useState([]),[b,w]=A.useState(!1),{data:T,refetch:N}=it({queryKey:["telemetry-tags"],queryFn:async()=>{const ne=await U8.tags();return ne||{data:[{id:1,tag:"PUMP_001_FLOW",ioType:"AI",unit:"lpm",assetId:1,thresholds:{low:50,high:500}},{id:2,tag:"RES_001_LEVEL",ioType:"AI",unit:"m3",assetId:3,thresholds:{low:10,high:95}},{id:3,tag:"PUMP_001_STATUS",ioType:"DI",unit:"on/off",assetId:1},{id:4,tag:"CHLORINE_RESIDUAL",ioType:"AI",unit:"mg/L",assetId:2,thresholds:{low:.2,high:1.5}}]}}}),{data:M}=it({queryKey:["assets-for-telemetry"],queryFn:async()=>{const ne=await lVe.list();return ne||{data:[{id:1,code:"PUMP_001",name:"Main Pump"},{id:2,code:"CHL_001",name:"Chlorinator"},{id:3,code:"RES_001",name:"Main Reservoir"}]}}}),{measurements:O,isConnected:C}=NVe(s);A.useEffect(()=>{T!=null&&T.data&&n(T.data.map(ne=>ne.id))},[T==null?void 0:T.data]);const D=async ne=>{try{await U8.createTag(ne),r(!1),N()}catch(oe){console.error("Error saving tag:",oe)}},L=async ne=>{i(ne),o(!0),await F(ne.id,f)},F=async(ne,oe)=>{w(!0);try{let Ce;const Pe=new Date;switch(oe){case"1h":Ce=w5(Pe,1);break;case"6h":Ce=w5(Pe,6);break;case"24h":Ce=BA(Pe,1);break;case"7d":Ce=BA(Pe,7);break;default:Ce=BA(Pe,1)}const Se=await fetch(`/api/v1/telemetry/measurements?tag_id=${ne}&from=${Ce.toISOString()}&to=${Pe.toISOString()}&per_page=500`,{credentials:"include"});if(Se.ok){const ae=await Se.json(),be=(ae.data||ae).map(de=>({timestamp:de.ts||de.timestamp,value:de.value,formatted_time:Ur(new Date(de.ts||de.timestamp),oe==="7d"?"MMM dd HH:mm":"HH:mm")}));y(be)}else{const ae=B(oe);y(ae)}}catch{const Ce=B(oe);y(Ce)}finally{w(!1)}},B=ne=>{const oe=[],Ce=new Date;let Pe,Se;switch(ne){case"1h":Pe=60,Se=60*1e3;break;case"6h":Pe=72,Se=5*60*1e3;break;case"24h":Pe=96,Se=15*60*1e3;break;case"7d":Pe=168,Se=60*60*1e3;break;default:Pe=96,Se=15*60*1e3}let ae=100+Math.random()*50;for(let be=Pe-1;be>=0;be--){const de=new Date(Ce.getTime()-be*Se);ae+=(Math.random()-.5)*10,ae=Math.max(20,Math.min(200,ae)),oe.push({timestamp:de.toISOString(),value:Math.round(ae*10)/10,formatted_time:Ur(de,ne==="7d"?"MMM dd HH:mm":"HH:mm")})}return oe},U=async ne=>{p(ne),c&&await F(c.id,ne)},te=()=>{const ne=document.querySelector(".trend-chart svg");if(!ne)return;const oe=new XMLSerializer().serializeToString(ne),Ce=document.createElement("canvas"),Pe=Ce.getContext("2d"),Se=new Image;Se.onload=()=>{Ce.width=Se.width,Ce.height=Se.height,Pe==null||Pe.drawImage(Se,0,0);const ae=document.createElement("a");ae.download=`trend_${c==null?void 0:c.tag}_${f}.png`,ae.href=Ce.toDataURL("image/png"),ae.click()},Se.src="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(oe)))};return e.jsxs("div",{className:"p-6 space-y-6 bg-background",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Telemetry & SCADA"}),e.jsx("p",{className:"text-muted-foreground",children:"Real-time sensor monitoring with WebSocket updates"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ta,{className:`h-4 w-4 ${C?"text-green-500":"text-red-500"}`}),e.jsx("span",{className:"text-sm text-foreground",children:C?"Connected":"Disconnected"}),e.jsxs(K,{onClick:()=>r(!0),className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Sensor"]})]})]}),e.jsxs(ss,{defaultValue:"sensors",className:"w-full",children:[e.jsxs(Yr,{children:[e.jsx(wt,{value:"sensors",children:"Sensors"}),e.jsx(wt,{value:"measurements",children:"Live Measurements"})]}),e.jsxs(kt,{value:"sensors",className:"space-y-4",children:[t&&e.jsxs(H,{className:"bg-card",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(he,{className:"text-foreground",children:"Add Telemetry Sensor"}),e.jsx(K,{variant:"ghost",size:"sm",onClick:()=>r(!1),children:e.jsx(Ko,{className:"h-4 w-4"})})]})}),e.jsx(X,{children:e.jsx(wVe,{onSubmit:D,isLoading:!1,assetOptions:(M==null?void 0:M.data)||[]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:(Q=T==null?void 0:T.data)==null?void 0:Q.map(ne=>{var oe,Ce;return e.jsxs(H,{className:"bg-card hover:shadow-md transition-shadow",children:[e.jsxs(ue,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(he,{className:"text-sm font-mono text-foreground",children:ne.tag}),e.jsx(Ae,{children:ne.ioType})]}),e.jsx(mr,{children:((Ce=(oe=M==null?void 0:M.data)==null?void 0:oe.find(Pe=>Pe.id===ne.assetId))==null?void 0:Ce.name)||"Unassigned"})]}),e.jsxs(X,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Type:"}),e.jsx("span",{className:"ml-1 font-medium text-foreground",children:ne.ioType})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Unit:"}),e.jsx("span",{className:"ml-1 font-medium text-foreground",children:ne.unit||"-"})]})]}),ne.thresholds&&e.jsxs("div",{className:"text-xs text-muted-foreground pt-2 border-t",children:["Thresholds: ",ne.thresholds.low," - ",ne.thresholds.high," ",ne.unit]}),e.jsxs(K,{variant:"outline",size:"sm",className:"w-full",onClick:()=>L(ne),children:[e.jsx(jS,{className:"h-4 w-4 mr-2"}),"View Trend"]})]})]},ne.id)})})]}),e.jsxs(kt,{value:"measurements",className:"space-y-4",children:[!C&&e.jsx("div",{className:"p-4 bg-yellow-500/10 border border-yellow-500/30 rounded text-sm text-yellow-700 dark:text-yellow-400",children:"WebSocket disconnected - showing last recorded values"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[Object.entries(O).map(([ne,oe])=>e.jsxs(H,{className:"border-green-500/30 bg-green-500/5",children:[e.jsx(ue,{children:e.jsxs(he,{className:"text-sm flex items-center gap-2 text-foreground",children:[e.jsx(zs,{className:"h-4 w-4 text-green-500"}),oe.tag]})}),e.jsxs(X,{className:"space-y-2",children:[e.jsxs("div",{className:"text-3xl font-bold text-foreground",children:[oe.value," ",oe.unit||""]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Updated: ",new Date(oe.timestamp).toLocaleTimeString()]}),e.jsxs(K,{variant:"outline",size:"sm",className:"w-full mt-2",onClick:()=>{var Pe;const Ce=(Pe=T==null?void 0:T.data)==null?void 0:Pe.find(Se=>Se.id===parseInt(ne));Ce&&L(Ce)},children:[e.jsx(jS,{className:"h-4 w-4 mr-2"}),"View Trend"]})]})]},ne)),Object.keys(O).length===0&&e.jsx(H,{className:"col-span-full bg-card",children:e.jsxs(X,{className:"flex flex-col items-center justify-center p-12",children:[e.jsx(zs,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"No live measurements available"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Waiting for sensor data..."})]})})]})]})]}),e.jsx(Qt,{open:a,onOpenChange:o,children:e.jsxs(Zt,{className:"max-w-4xl",children:[e.jsx(Yt,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Xt,{className:"text-foreground",children:["Trend: ",c==null?void 0:c.tag]}),e.jsx(Es,{children:c!=null&&c.unit?`Values in ${c.unit}`:"Historical trend data"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Nt,{value:f,onValueChange:ne=>U(ne),children:[e.jsx(bt,{className:"w-32",children:e.jsx(St,{})}),e.jsxs(_t,{children:[e.jsx(ge,{value:"1h",children:"Last 1 Hour"}),e.jsx(ge,{value:"6h",children:"Last 6 Hours"}),e.jsx(ge,{value:"24h",children:"Last 24 Hours"}),e.jsx(ge,{value:"7d",children:"Last 7 Days"})]})]}),e.jsxs(K,{variant:"outline",size:"sm",onClick:te,children:[e.jsx(ma,{className:"h-4 w-4 mr-2"}),"Export PNG"]})]})]})}),e.jsx("div",{className:"h-[400px] mt-4 trend-chart",children:b?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsx(Ha,{width:"100%",height:"100%",children:e.jsxs(Km,{data:g,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(Zi,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(Ma,{dataKey:"formatted_time",tick:{fontSize:12},className:"text-muted-foreground"}),e.jsx(fa,{tick:{fontSize:12},className:"text-muted-foreground",label:{value:(c==null?void 0:c.unit)||"Value",angle:-90,position:"insideLeft",style:{textAnchor:"middle"}}}),e.jsx(_n,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"6px"},labelStyle:{color:"hsl(var(--foreground))"},formatter:ne=>[`${ne} ${(c==null?void 0:c.unit)||""}`,"Value"]}),e.jsx(Ea,{}),e.jsx(ui,{type:"monotone",dataKey:"value",name:(c==null?void 0:c.tag)||"Value",stroke:"#3b82f6",strokeWidth:2,dot:!1,activeDot:{r:4}}),((re=c==null?void 0:c.thresholds)==null?void 0:re.high)&&e.jsx(ui,{type:"monotone",dataKey:()=>c.thresholds.high,name:"High Threshold",stroke:"#ef4444",strokeWidth:1,strokeDasharray:"5 5",dot:!1}),((Z=c==null?void 0:c.thresholds)==null?void 0:Z.low)&&e.jsx(ui,{type:"monotone",dataKey:()=>c.thresholds.low,name:"Low Threshold",stroke:"#f59e0b",strokeWidth:1,strokeDasharray:"5 5",dot:!1})]})})}),g.length>0&&e.jsxs("div",{className:"grid grid-cols-4 gap-4 mt-4 p-4 bg-muted rounded-lg",children:[e.jsxs("div",{children:[e.jsx(we,{className:"text-muted-foreground",children:"Min"}),e.jsxs("div",{className:"text-lg font-bold text-foreground",children:[Math.min(...g.map(ne=>ne.value)).toFixed(1)," ",c==null?void 0:c.unit]})]}),e.jsxs("div",{children:[e.jsx(we,{className:"text-muted-foreground",children:"Max"}),e.jsxs("div",{className:"text-lg font-bold text-foreground",children:[Math.max(...g.map(ne=>ne.value)).toFixed(1)," ",c==null?void 0:c.unit]})]}),e.jsxs("div",{children:[e.jsx(we,{className:"text-muted-foreground",children:"Average"}),e.jsxs("div",{className:"text-lg font-bold text-foreground",children:[(g.reduce((ne,oe)=>ne+oe.value,0)/g.length).toFixed(1)," ",c==null?void 0:c.unit]})]}),e.jsxs("div",{children:[e.jsx(we,{className:"text-muted-foreground",children:"Data Points"}),e.jsx("div",{className:"text-lg font-bold text-foreground",children:g.length})]})]})]})})]})}const CVe={draft:"bg-gray-500",approved:"bg-blue-500",live:"bg-red-500",restored:"bg-green-500",closed:"bg-gray-600"};function PVe(){var Pe,Se;const[t,r]=A.useState(!1),[s,n]=A.useState("list"),[a,o]=A.useState(!1),[c,i]=A.useState([]),[f,p]=A.useState(null),[g,y]=A.useState(!1);yr();const[b,w]=A.useState({scheme_id:"",cause:"planned",reason:"",scheduled_start:"",scheduled_end:"",isolation_plan:"",notes:""}),{data:T,refetch:N}=it({queryKey:["outages"],queryFn:async()=>{const ae=await W8.list();return ae||{data:[{id:"1",scheme_id:"1",cause:"planned",state:"draft",reason:"Pump maintenance",estimated_affected_population:8900,scheduled_start:"2025-12-10T08:00:00Z",scheduled_end:"2025-12-10T16:00:00Z"},{id:"2",scheme_id:"1",cause:"fault",state:"live",reason:"Power outage",estimated_affected_population:4500,scheduled_start:"2025-12-08T10:00:00Z",scheduled_end:"2025-12-08T18:00:00Z"}]}}}),{data:M}=it({queryKey:["schemes-for-outages"],queryFn:async()=>{const ae=await Tg.list();return ae||{data:[{id:"1",name:"Lodwar Water Supply Scheme"},{id:"2",name:"Wajir Town Water Supply"}]}}}),O=gt({mutationFn:async ae=>{const be=await W8.create(ae);if(!be)throw new Error("Failed to create outage");return be},onSuccess:()=>{Me.success("Outage planned successfully"),N(),D()},onError:()=>{Me.error("Failed to plan outage")}}),C=gt({mutationFn:async({id:ae,action:be})=>{const de=await fetch(`/api/v1/outages/${ae}/${be}`,{method:"POST",credentials:"include"});if(!de.ok)throw new Error(`Failed to ${be} outage`);return de.json()},onSuccess:(ae,{action:be})=>{Me.success(`Outage ${be} successfully`),N()},onError:(ae,{action:be})=>{Me.error(`Failed to ${be} outage`)}}),D=()=>{r(!1),i([]),p(null),w({scheme_id:"",cause:"planned",reason:"",scheduled_start:"",scheduled_end:"",isolation_plan:"",notes:""})},L=A.useCallback(ae=>{if(!a)return;const{lngLat:be}=ae;i(de=>[...de,{lat:be.lat,lng:be.lng}])},[a]),F=()=>{i([]),o(!0),p(null),Me.info('Click on the map to draw the affected area polygon. Click "Finish Drawing" when done.')},B=()=>{if(c.length<3){Me.error("Please draw at least 3 points to create a polygon");return}o(!1),te()},U=ae=>{if(ae.length<3)return 0;let be=0;for(let de=0;de<ae.length;de++){const Ke=(de+1)%ae.length;be+=ae[de].lng*ae[Ke].lat,be-=ae[Ke].lng*ae[de].lat}return Math.abs(be/2)*111*111},te=async()=>{if(!(c.length<3)){y(!0);try{const ae=await fetch("/api/v1/outages/impact",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({polygon:c.map(be=>[be.lng,be.lat])})});if(ae.ok){const be=await ae.json();p(be)}else{const be=U(c),Ke=Math.floor(be*50),He=Ke*4;p({customers:Math.max(Ke,10),population:Math.max(He,40)})}}catch{const ae=U(c),de=Math.floor(ae*50),Ke=de*4;p({customers:Math.max(de,10),population:Math.max(Ke,40)})}finally{y(!1)}}},Q=()=>{i([]),p(null),o(!1)},re=()=>{if(!b.scheme_id||!b.reason){Me.error("Please fill in required fields");return}if(c.length<3){Me.error("Please draw the affected area polygon on the map (minimum 3 points)");return}const ae={type:"Polygon",coordinates:[[...c.map(be=>[be.lng,be.lat]),[c[0].lng,c[0].lat]]]};O.mutate({...b,affected_geom:ae,estimated_affected_population:f==null?void 0:f.population,estimated_affected_customers:f==null?void 0:f.customers})},Z=b.scheme_id&&b.reason&&c.length>=3,ne=c.length>=3?{type:"Feature",geometry:{type:"Polygon",coordinates:[[...c.map(ae=>[ae.lng,ae.lat]),[c[0].lng,c[0].lat]]]},properties:{}}:null,oe=c.length>=2?{type:"Feature",geometry:{type:"LineString",coordinates:c.map(ae=>[ae.lng,ae.lat])},properties:{}}:null,Ce=[{value:"planned",label:"Planned Maintenance"},{value:"fault",label:"Equipment Fault"},{value:"power",label:"Power Outage"},{value:"water_quality",label:"Water Quality Issue"},{value:"emergency",label:"Emergency"},{value:"other",label:"Other"}];return e.jsxs("div",{className:"p-6 space-y-6 bg-background",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Outage Planner"}),e.jsx("p",{className:"text-muted-foreground",children:"Plan and manage service interruptions with polygon capture"})]}),e.jsxs(K,{onClick:()=>r(!0),className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"Plan Outage"]})]}),e.jsx(Qt,{open:t,onOpenChange:ae=>{ae?r(!0):D()},children:e.jsxs(Zt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Yt,{children:[e.jsx(Xt,{children:"Plan Service Outage"}),e.jsx(Es,{children:"Define outage details and draw the affected area on the map"})]}),e.jsxs(ss,{defaultValue:"details",className:"w-full",children:[e.jsxs(Yr,{className:"grid w-full grid-cols-2",children:[e.jsx(wt,{value:"details",children:"Outage Details"}),e.jsx(wt,{value:"map",children:"Affected Area Map"})]}),e.jsxs(kt,{value:"details",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Scheme *"}),e.jsxs(Nt,{value:b.scheme_id,onValueChange:ae=>w({...b,scheme_id:ae}),children:[e.jsx(bt,{children:e.jsx(St,{placeholder:"Select scheme"})}),e.jsx(_t,{children:(Pe=M==null?void 0:M.data)==null?void 0:Pe.map(ae=>e.jsx(ge,{value:String(ae.id),children:ae.name},ae.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Cause *"}),e.jsxs(Nt,{value:b.cause,onValueChange:ae=>w({...b,cause:ae}),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsx(_t,{children:Ce.map(ae=>e.jsx(ge,{value:ae.value,children:ae.label},ae.value))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Reason / Summary *"}),e.jsx(Ie,{placeholder:"e.g., Scheduled pump maintenance",value:b.reason,onChange:ae=>w({...b,reason:ae.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Scheduled Start"}),e.jsx(Ie,{type:"datetime-local",value:b.scheduled_start,onChange:ae=>w({...b,scheduled_start:ae.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Scheduled End"}),e.jsx(Ie,{type:"datetime-local",value:b.scheduled_end,onChange:ae=>w({...b,scheduled_end:ae.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Isolation Plan (Valves to close)"}),e.jsx(ws,{placeholder:"e.g., Close valves V-101, V-102, V-103",value:b.isolation_plan,onChange:ae=>w({...b,isolation_plan:ae.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(we,{children:"Notes"}),e.jsx(ws,{placeholder:"Additional notes about the outage...",value:b.notes,onChange:ae=>w({...b,notes:ae.target.value})})]}),f&&e.jsx(H,{className:"bg-muted",children:e.jsx(X,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Ds,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Estimated Impact"}),e.jsxs("div",{className:"text-lg font-bold",children:[f.customers.toLocaleString()," customers / ",f.population.toLocaleString()," population"]})]})]})})})]}),e.jsxs(kt,{value:"map",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a?e.jsxs(e.Fragment,{children:[e.jsxs(K,{onClick:B,variant:"default",size:"sm",disabled:c.length<3,children:[e.jsx(Ns,{className:"h-4 w-4 mr-2"}),"Finish Drawing (",c.length," points)"]}),e.jsxs(K,{onClick:Q,variant:"destructive",size:"sm",children:[e.jsx(Ko,{className:"h-4 w-4 mr-2"}),"Cancel"]})]}):e.jsxs(K,{onClick:F,variant:"outline",size:"sm",children:[e.jsx(fn,{className:"h-4 w-4 mr-2"}),"Draw Affected Area"]}),c.length>0&&!a&&e.jsxs(K,{onClick:Q,variant:"outline",size:"sm",children:[e.jsx(Ws,{className:"h-4 w-4 mr-2"}),"Clear Polygon"]})]}),e.jsx("div",{className:"h-[400px] rounded-lg overflow-hidden border",children:e.jsxs(Pm,{initialViewState:{longitude:35.5,latitude:3.5,zoom:6},style:{width:"100%",height:"100%"},mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",onClick:L,cursor:a?"crosshair":"grab",children:[e.jsx(km,{position:"top-right"}),ne&&e.jsxs(_u,{id:"polygon",type:"geojson",data:ne,children:[e.jsx(ni,{id:"polygon-fill",type:"fill",paint:{"fill-color":"#ef4444","fill-opacity":.3}}),e.jsx(ni,{id:"polygon-outline",type:"line",paint:{"line-color":"#ef4444","line-width":2}})]}),a&&oe&&e.jsx(_u,{id:"drawing-line",type:"geojson",data:oe,children:e.jsx(ni,{id:"drawing-line-layer",type:"line",paint:{"line-color":"#3b82f6","line-width":2,"line-dasharray":[2,2]}})}),c.map((ae,be)=>e.jsx(BC,{longitude:ae.lng,latitude:ae.lat,children:e.jsx("div",{className:`w-3 h-3 rounded-full border-2 border-white ${a?"bg-blue-500":"bg-red-500"}`})},be))]})}),a&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"Click on the map to add points. You need at least 3 points to create a polygon."}),g&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(as,{className:"h-4 w-4 animate-spin"}),"Calculating impact..."]})]})]}),e.jsxs(Ps,{children:[e.jsx(K,{variant:"outline",onClick:D,children:"Cancel"}),e.jsxs(K,{onClick:re,disabled:!Z||O.isPending,children:[O.isPending&&e.jsx(as,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Outage"]}),!Z&&b.scheme_id&&b.reason&&e.jsx("p",{className:"text-xs text-destructive",children:"Draw an affected area polygon on the map tab first"})]})]})}),e.jsxs(ss,{value:s,onValueChange:ae=>n(ae),children:[e.jsxs(Yr,{children:[e.jsx(wt,{value:"list",children:"List View"}),e.jsx(wt,{value:"map",children:"Map View"})]}),e.jsxs(kt,{value:"list",className:"mt-4 space-y-4",children:[(Se=T==null?void 0:T.data)==null?void 0:Se.map(ae=>{var be,de,Ke;return e.jsxs(H,{className:"bg-card",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs(he,{className:"flex items-center gap-2 text-foreground",children:[e.jsx(Fr,{className:"h-5 w-5"}),ae.reason]}),e.jsx(mr,{children:((de=(be=M==null?void 0:M.data)==null?void 0:be.find(He=>String(He.id)===String(ae.scheme_id)))==null?void 0:de.name)||"Unknown Scheme"})]}),e.jsx(Ae,{className:CVe[ae.state]||"bg-gray-500",children:ae.state})]})}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Cause"}),e.jsx("div",{className:"font-semibold text-sm text-foreground capitalize",children:(Ke=ae.cause)==null?void 0:Ke.replace(/_/g," ")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Affected Population"}),e.jsx("div",{className:"font-semibold text-sm text-foreground",children:(ae.estimated_affected_population??0).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Scheduled Start"}),e.jsx("div",{className:"font-semibold text-sm text-foreground",children:ae.scheduled_start?Ur(new Date(ae.scheduled_start),"PPp"):"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Scheduled End"}),e.jsx("div",{className:"font-semibold text-sm text-foreground",children:ae.scheduled_end?Ur(new Date(ae.scheduled_end),"PPp"):"-"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2 border-t",children:[ae.state==="draft"&&e.jsxs(K,{size:"sm",variant:"outline",disabled:C.isPending,onClick:()=>C.mutate({id:ae.id,action:"approve"}),children:[C.isPending?e.jsx(as,{className:"h-4 w-4 mr-1 animate-spin"}):e.jsx(Ns,{className:"h-4 w-4 mr-1"}),"Approve"]}),ae.state==="approved"&&e.jsxs(K,{size:"sm",variant:"destructive",disabled:C.isPending,onClick:()=>C.mutate({id:ae.id,action:"go-live"}),children:[C.isPending?e.jsx(as,{className:"h-4 w-4 mr-1 animate-spin"}):e.jsx(Ui,{className:"h-4 w-4 mr-1"}),"Go Live"]}),ae.state==="live"&&e.jsxs(K,{size:"sm",variant:"default",disabled:C.isPending,onClick:()=>C.mutate({id:ae.id,action:"restore"}),children:[C.isPending?e.jsx(as,{className:"h-4 w-4 mr-1 animate-spin"}):e.jsx(yI,{className:"h-4 w-4 mr-1"}),"Restore Service"]}),ae.state==="restored"&&e.jsxs(K,{size:"sm",variant:"outline",disabled:C.isPending,onClick:()=>C.mutate({id:ae.id,action:"close"}),children:[C.isPending?e.jsx(as,{className:"h-4 w-4 mr-1 animate-spin"}):e.jsx(Ko,{className:"h-4 w-4 mr-1"}),"Close"]})]}),ae.notes&&e.jsx("div",{className:"text-sm text-muted-foreground border-t pt-3",children:ae.notes})]})]},ae.id)}),(!(T!=null&&T.data)||T.data.length===0)&&e.jsx(H,{className:"bg-card",children:e.jsxs(X,{className:"flex flex-col items-center justify-center p-12",children:[e.jsx(Fr,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No outages planned"}),e.jsxs(K,{onClick:()=>r(!0),children:[e.jsx(Mt,{className:"mr-2 h-4 w-4"}),"Plan First Outage"]})]})})]}),e.jsx(kt,{value:"map",className:"mt-4",children:e.jsx(H,{className:"bg-card",children:e.jsx(X,{className:"p-0",children:e.jsx("div",{className:"h-[600px]",children:e.jsx(Pm,{initialViewState:{longitude:35.5,latitude:3.5,zoom:6},style:{width:"100%",height:"100%"},mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",children:e.jsx(km,{position:"top-right"})})})})})})]})]})}function kVe({schemeId:t}){var i;const r=A.useRef(null),s=A.useRef(null),[n,a]=A.useState(null),{data:o}=it({queryKey:["network-nodes",t],queryFn:()=>K8.nodes(t)}),{data:c}=it({queryKey:["network-edges",t],queryFn:()=>K8.edges(t)});return A.useEffect(()=>{if(r.current)return s.current=new $l.Map({container:r.current,style:"https://demotiles.maplibre.org/style.json",center:[34.7669,-.685],zoom:10}),s.current.on("load",()=>{s.current&&(s.current.addSource("edges",{type:"geojson",data:{type:"FeatureCollection",features:((c==null?void 0:c.data)||[]).map(f=>({type:"Feature",properties:f,geometry:{type:"LineString",coordinates:[[f.from_lon||34.7669,f.from_lat||-.685],[f.to_lon||34.7669,f.to_lat||-.685]]}}))}}),s.current.addLayer({id:"edges-layer",type:"line",source:"edges",paint:{"line-color":"#3b82f6","line-width":3,"line-opacity":.8}}),s.current.addSource("nodes",{type:"geojson",data:{type:"FeatureCollection",features:((o==null?void 0:o.data)||[]).map(f=>({type:"Feature",properties:f,geometry:{type:"Point",coordinates:[parseFloat(f.longitude)||34.7669,parseFloat(f.latitude)||-.685]}}))}}),s.current.addLayer({id:"nodes-layer",type:"circle",source:"nodes",paint:{"circle-radius":8,"circle-color":["match",["get","node_type"],"source","#3b82f6","reservoir","#06b6d4","junction","#9ca3af","treatment","#10b981","pump_station","#f97316","#999"],"circle-stroke-width":2,"circle-stroke-color":"#fff"}}),s.current.on("click","nodes-layer",f=>{var g,y;const p=(y=(g=f.features)==null?void 0:g[0])==null?void 0:y.properties;p&&a(p)}),s.current.on("mouseenter","nodes-layer",()=>{s.current&&(s.current.getCanvas().style.cursor="pointer")}),s.current.on("mouseleave","nodes-layer",()=>{s.current&&(s.current.getCanvas().style.cursor="")}))}),()=>{s.current&&s.current.remove()}},[o,c]),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"text-lg flex items-center gap-2",children:[e.jsx(fn,{className:"h-5 w-5"}),"Interactive Network Topology Map"]})}),e.jsxs(X,{children:[e.jsx("div",{ref:r,className:"w-full h-96 rounded-lg border border-gray-700 overflow-hidden"}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-xs",children:"Sources"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-cyan-500 rounded-full"}),e.jsx("span",{className:"text-xs",children:"Reservoirs"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-xs",children:"Treatment"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full"}),e.jsx("span",{className:"text-xs",children:"Pumps"})]})]})]})]}),n&&e.jsxs(H,{className:"border-blue-500/30 bg-blue-500/5",children:[e.jsx(ue,{children:e.jsx(he,{className:"text-sm",children:n.name||n.code})}),e.jsxs(X,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Type:"}),e.jsx(Ae,{children:(i=n.node_type)==null?void 0:i.replace(/_/g," ")})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.jsxs("div",{children:["Code: ",n.code]}),n.latitude&&n.longitude&&e.jsxs("div",{children:["Location: ",n.latitude,", ",n.longitude]}),n.elevation&&e.jsxs("div",{children:["Elevation: ",n.elevation,"m"]})]})]})]})]})}function AVe(){var n;const[t,r]=A.useState(1),{data:s}=it({queryKey:["schemes-for-map"],queryFn:async()=>{const a=await Tg.list();return a||{data:[{id:1,code:"TRK_LOD_001",name:"Lodwar Water Supply Scheme"}]}}});return e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Network Topology Map"}),e.jsx("p",{className:"text-muted-foreground",children:"Interactive PostGIS-based network visualization with spatial queries"})]}),e.jsxs("div",{className:"max-w-md",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Select Scheme"}),e.jsxs(Nt,{value:t.toString(),onValueChange:a=>r(parseInt(a)),children:[e.jsx(bt,{children:e.jsx(St,{})}),e.jsx(_t,{children:(n=s==null?void 0:s.data)==null?void 0:n.map(a=>e.jsxs(ge,{value:a.id.toString(),children:[a.name," (",a.code,")"]},a.id))})]})]}),e.jsx(kVe,{schemeId:t})]})}function TVe(){return e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx(Ti,{}),e.jsx("main",{className:"flex-1 p-8 overflow-auto",children:e.jsx(Ai,{})})]})}function EVe(){const t=[{label:"Active Risks",value:24,icon:Fr,color:"text-red-500"},{label:"Incidents (Open)",value:8,icon:ka,color:"text-orange-500"},{label:"Controls Effective",value:"92%",icon:Zl,color:"text-green-500"},{label:"Audit Findings",value:5,icon:Wl,color:"text-yellow-500"},{label:"Policies Published",value:18,icon:bs,color:"text-blue-500"},{label:"Pending Attestations",value:3,icon:Ds,color:"text-purple-500"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Risk, Compliance & Governance"}),e.jsx("p",{className:"text-muted-foreground",children:"Enterprise GRC oversight and management"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(r=>{const s=r.icon;return e.jsxs(H,{children:[e.jsxs(ue,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(he,{className:"text-sm font-medium",children:r.label}),e.jsx(s,{className:`h-4 w-4 ${r.color}`})]}),e.jsx(X,{children:e.jsx("div",{className:"text-2xl font-bold",children:r.value})})]},r.label)})})]})}function MVe(){const[t,r]=A.useState(!1),s=[{id:1,title:"Water Quality Contamination",category:"Operational",owner:"John Smith",likelihood:"Medium",impact:"High",residualScore:12,status:"Active"},{id:2,title:"Pump Failure",category:"Operational",owner:"Jane Doe",likelihood:"Low",impact:"High",residualScore:6,status:"Active"},{id:3,title:"Data Breach",category:"IT/Privacy",owner:"Mike Johnson",likelihood:"Low",impact:"Critical",residualScore:8,status:"Monitoring"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Risk Register"}),e.jsx("p",{className:"text-muted-foreground",children:"Enterprise, scheme, and process-level risks"})]}),e.jsxs(K,{onClick:()=>r(!0),className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"Register Risk"]})]}),e.jsx("div",{className:"space-y-4",children:s.map(n=>e.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Fr,{className:"h-5 w-5 text-orange-500 mt-1"}),e.jsxs("div",{children:[e.jsx(he,{className:"text-lg",children:n.title}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:n.category})]})]}),e.jsx("span",{className:"px-2 py-1 rounded bg-blue-500/10 text-blue-600 text-xs font-medium",children:n.status})]})}),e.jsx(X,{className:"space-y-2",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Owner"}),e.jsx("p",{className:"font-semibold text-sm",children:n.owner})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Likelihood"}),e.jsx("p",{className:"font-semibold text-sm",children:n.likelihood})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Impact"}),e.jsx("p",{className:"font-semibold text-sm",children:n.impact})]})]})})]},n.id))})]})}function OVe(){const[t,r]=A.useState(!1),s=[{id:1,title:"Water Quality Issue - High Turbidity",type:"operational",severity:"high",status:"investigating",date:"2025-11-24"},{id:2,title:"Staff Safety - Minor Cut",type:"HSE",severity:"low",status:"closed",date:"2025-11-23"},{id:3,title:"System Access Anomaly",type:"security",severity:"medium",status:"triaged",date:"2025-11-24"}],n={new:"bg-gray-500",triaged:"bg-blue-500",investigating:"bg-orange-500",actioning:"bg-yellow-500",verified:"bg-green-500",closed:"bg-gray-600"},a={low:"bg-green-500",medium:"bg-yellow-500",high:"bg-orange-500",critical:"bg-red-500"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Incidents & Issues"}),e.jsx("p",{className:"text-muted-foreground",children:"Operational, HSE, privacy and compliance incidents"})]}),e.jsxs(K,{onClick:()=>r(!0),className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"Report Incident"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(o=>e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{className:"text-base",children:o.title})}),e.jsxs(X,{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ae,{className:a[o.severity],children:o.severity}),e.jsx(Ae,{className:n[o.status],children:o.status})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o.date})]})]},o.id))})]})}function IVe(){const[t,r]=A.useState(!1),s=[{id:1,code:"BCP_001",process:"Water Treatment",rto:"4 hours",rpo:"1 hour",status:"Active"},{id:2,code:"BCP_002",process:"Distribution Network",rto:"8 hours",rpo:"2 hours",status:"Active"},{id:3,code:"BCP_003",process:"Customer Billing",rto:"24 hours",rpo:"4 hours",status:"Draft"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Business Continuity Plans"}),e.jsx("p",{className:"text-muted-foreground",children:"Continuity and emergency response planning"})]}),e.jsxs(K,{onClick:()=>r(!0),className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Plan"]})]}),e.jsx("div",{className:"space-y-3",children:s.map(n=>e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(he,{className:"text-lg",children:n.process}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:n.code})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${n.status==="Active"?"bg-green-500/10 text-green-600":"bg-yellow-500/10 text-yellow-600"}`,children:n.status})]})}),e.jsxs(X,{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"RTO"}),e.jsx("p",{className:"font-semibold",children:n.rto})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"RPO"}),e.jsx("p",{className:"font-semibold",children:n.rpo})]})]})]},n.id))})]})}function DVe(){const t=[{id:1,name:"WARIS Annual Report",dueDate:"2025-12-31",status:"in-draft",version:2},{id:2,name:"Asset Management Return",dueDate:"2025-11-30",status:"validation-errors",version:1},{id:3,name:"Financial Performance Report",dueDate:"2026-01-15",status:"submitted",version:1}],r={"in-draft":"bg-yellow-500","validation-errors":"bg-red-500",submitted:"bg-green-500"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Regulatory Reporting"}),e.jsx("p",{className:"text-muted-foreground",children:"WARIS and other regulatory returns"})]}),e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Return"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(s=>e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs(he,{className:"text-lg flex items-center gap-2",children:[e.jsx(bs,{className:"h-5 w-5"}),s.name]}),e.jsx(Ae,{className:r[s.status],children:s.status})]})}),e.jsx(X,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Due: ",s.dueDate]}),e.jsxs("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:["v",s.version]})]})})]},s.id))})]})}function RVe(){const t=[{id:1,code:"POL_001",title:"Information Security Policy",status:"published",version:3,audience:"All Staff",effectiveDate:"2025-01-01"},{id:2,code:"POL_002",title:"Health & Safety Policy",status:"published",version:2,audience:"All Staff",effectiveDate:"2024-06-01"},{id:3,code:"POL_003",title:"Data Privacy & Consent Policy",status:"review",version:1,audience:"Data Handlers",effectiveDate:null}],r={published:"bg-green-500",review:"bg-yellow-500",archived:"bg-gray-500"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Policies & SOPs"}),e.jsx("p",{className:"text-muted-foreground",children:"Policy lifecycle, attestations, and evidence"})]}),e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Policy"]})]}),e.jsx("div",{className:"space-y-3",children:t.map(s=>e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Fu,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx(he,{className:"text-lg",children:s.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.code,"  v",s.version]})]})]}),e.jsx(Ae,{className:r[s.status],children:s.status})]})}),e.jsx(X,{className:"text-sm",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Audience: ",s.audience]}),s.effectiveDate&&e.jsxs("span",{className:"text-muted-foreground",children:["Since: ",s.effectiveDate]})]})})]},s.id))})]})}function LVe(){const t=[{id:1,name:"Financial Controls Audit",function:"Finance",status:"in-progress",rating:null,findings:3},{id:2,name:"Water Quality Testing",function:"Operations",status:"completed",rating:"Effective",findings:1},{id:3,name:"IT Security Assessment",function:"IT",status:"planning",rating:null,findings:0}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Internal Audit"}),e.jsx("p",{className:"text-muted-foreground",children:"Audit plans, engagements, findings and recommendations"})]}),e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"New Engagement"]})]}),e.jsx("div",{className:"space-y-3",children:t.map(r=>e.jsxs(H,{children:[e.jsx(ue,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(he,{className:"text-lg",children:r.name}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:r.function})]}),e.jsx(Ae,{className:r.status==="completed"?"bg-green-500":r.status==="in-progress"?"bg-blue-500":"bg-gray-500",children:r.status})]})}),e.jsxs(X,{className:"flex justify-between items-center",children:[r.rating&&e.jsx("span",{className:"font-semibold",children:r.rating}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[r.findings," finding",r.findings!==1?"s":""]})]})]},r.id))})]})}function FVe(){const t=[{label:"LTIFR",value:"1.2",unit:"per 200k hours",trend:"down"},{label:"TRIR",value:"2.5",unit:"per 200k hours",trend:"up"},{label:"Open CAPAs",value:"5",unit:"actions",trend:"down"},{label:"Near Misses",value:"12",unit:"this quarter",trend:"up"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Health, Safety & Environment"}),e.jsx("p",{className:"text-muted-foreground",children:"HSE incidents, inspections, grievances and social safeguards"})]}),e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"Report Incident"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:t.map(r=>e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsx(he,{className:"text-sm font-medium",children:r.label})}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.value}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:r.unit})]})]},r.label))}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"Recent Incidents"})}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Fr,{className:"h-5 w-5 text-orange-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Minor Cut - Warehouse"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"2025-11-23  Verified"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Fr,{className:"h-5 w-5 text-yellow-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Near Miss - Slippery Floor"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"2025-11-22  Closed"})]})]})]})})]})]})}function $Ve(){const t=[{id:1,purpose:"Customer Communication",basis:"Consent",count:2458,status:"Active"},{id:2,purpose:"Marketing",basis:"Consent",count:892,status:"Active"},{id:3,purpose:"Service Delivery",basis:"Contract",count:3205,status:"Active"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Data Privacy & Consent"}),e.jsx("p",{className:"text-muted-foreground",children:"Consent registry, data retention, DSAR handling, privacy incidents"})]}),e.jsxs(K,{className:"gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),"Record Consent"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsx(he,{className:"text-sm font-medium",children:"Active Consents"})}),e.jsx(X,{children:e.jsx("div",{className:"text-2xl font-bold",children:"6,555"})})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsx(he,{className:"text-sm font-medium",children:"Pending DSARs"})}),e.jsx(X,{children:e.jsx("div",{className:"text-2xl font-bold",children:"2"})})]}),e.jsxs(H,{children:[e.jsx(ue,{className:"pb-2",children:e.jsx(he,{className:"text-sm font-medium",children:"Privacy Incidents"})}),e.jsx(X,{children:e.jsx("div",{className:"text-2xl font-bold",children:"0"})})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(sm,{className:"h-5 w-5"}),"Consent By Purpose"]})}),e.jsx(X,{className:"space-y-3",children:t.map(r=>e.jsxs("div",{className:"flex justify-between items-center pb-3 border-b last:border-0 last:pb-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:r.purpose}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.basis})]}),e.jsx("span",{className:"text-lg font-bold",children:r.count})]},r.id))})]})]})}function zVe(){const[t,r]=A.useState([{key:"core-registry",name:"Core Registry",description:"Schemes, assets, facilities management",enabled:!0,icon:Bi},{key:"core-ops",name:"Core Operations",description:"Telemetry, outages, SCADA control",enabled:!0,icon:Ni},{key:"crm",name:"CRM",description:"Customer relationship management",enabled:!0,icon:ka},{key:"cmms",name:"CMMS",description:"Asset maintenance and work orders",enabled:!0,icon:Ta},{key:"water-quality",name:"Water Quality",description:"WQ parameters, sampling, compliance",enabled:!0,icon:Bi},{key:"hydromet",name:"Hydromet",description:"Hydro-meteorological data",enabled:!0,icon:Bi},{key:"costing",name:"Costing & Finance",description:"Budgets, allocations, cost-to-serve",enabled:!0,icon:Ta},{key:"procurement",name:"Procurement",description:"RFQs, LPOs, vendor management",enabled:!0,icon:ka},{key:"projects",name:"Projects",description:"Project planning and tracking",enabled:!0,icon:Ni},{key:"community",name:"Community & Stakeholder",description:"Committees, grievances, vendors",enabled:!0,icon:ka},{key:"risk-compliance",name:"Risk, Compliance & Governance",description:"Risk register, incidents, audit",enabled:!0,icon:ka},{key:"dsa",name:"Decision Support & Analytics",description:"Forecasts, scenarios, optimization",enabled:!0,icon:Ta},{key:"training",name:"Training & Knowledge",description:"Learning management, certifications",enabled:!0,icon:Bi},{key:"me",name:"M&E",description:"Monitoring & evaluation, KPIs",enabled:!0,icon:Ni}]),s=a=>{r(t.map(o=>o.key===a?{...o,enabled:!o.enabled}:o))},n=t.filter(a=>a.enabled).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"System Settings"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure and manage system modules"})]}),e.jsxs(H,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:"Module Management"}),e.jsx(mr,{children:"Enable or disable modules for this tenant. Disabled modules won't appear in the sidebar."})]}),e.jsxs(X,{children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-500/10 rounded-lg border border-blue-200",children:e.jsxs("p",{className:"text-sm font-medium text-blue-900",children:["Enabled: ",e.jsxs("strong",{children:[n," of ",t.length]})," modules"]})}),e.jsx("div",{className:"space-y-3",children:t.map(a=>{const o=a.icon;return e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx(o,{className:"h-5 w-5 text-muted-foreground mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold",children:a.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.description})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ae,{variant:a.enabled?"default":"secondary",children:a.enabled?"Enabled":"Disabled"}),e.jsx(ml,{checked:a.enabled,onCheckedChange:()=>s(a.key)})]})]},a.key)})}),e.jsxs("div",{className:"mt-6 flex gap-2 justify-end",children:[e.jsx(K,{variant:"outline",children:"Cancel"}),e.jsx(K,{children:"Save Changes"})]})]})]}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsx(he,{children:"System Configuration"})}),e.jsx(X,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium",children:"Multi-Tenancy"}),e.jsx("p",{className:"text-2xl font-bold mt-2",children:"Enabled"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium",children:"RBAC"}),e.jsx("p",{className:"text-2xl font-bold mt-2",children:"Active"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium",children:"Audit Logging"}),e.jsx("p",{className:"text-2xl font-bold mt-2",children:"On"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium",children:"API Rate Limiting"}),e.jsx("p",{className:"text-2xl font-bold mt-2",children:"1000/min"})]})]})})]})]})}function BVe(){const t=[{id:"admin",name:"Admin",description:"Full system access",color:"bg-red-500"},{id:"manager",name:"Manager",description:"Operational management",color:"bg-blue-500"},{id:"operator",name:"Operator",description:"Day-to-day operations",color:"bg-green-500"},{id:"analyst",name:"Analyst",description:"Data analysis and reporting",color:"bg-purple-500"},{id:"viewer",name:"Viewer",description:"Read-only access",color:"bg-gray-500"}],r=[{key:"core-registry",name:"Core Registry"},{key:"core-ops",name:"Core Operations"},{key:"crm",name:"CRM"},{key:"cmms",name:"CMMS"},{key:"water-quality",name:"Water Quality"},{key:"hydromet",name:"Hydromet"},{key:"costing",name:"Costing & Finance"},{key:"procurement",name:"Procurement"},{key:"projects",name:"Projects"},{key:"community",name:"Community & Stakeholder"},{key:"risk-compliance",name:"Risk, Compliance & Governance"},{key:"dsa",name:"Decision Support & Analytics"},{key:"training",name:"Training & Knowledge"},{key:"me",name:"M&E"}],[s,n]=A.useState({admin:new Set(r.map(D=>D.key)),manager:new Set(["core-registry","core-ops","crm","cmms","water-quality","projects","costing"]),operator:new Set(["core-ops","cmms","water-quality"]),analyst:new Set(["dsa","me","costing","core-registry"]),viewer:new Set(["core-registry","me","dsa"])}),a=(D,L)=>{const F=new Set(s[D]);F.has(L)?F.delete(L):F.add(L),n({...s,[D]:F})},o=(D,L)=>{var F;return((F=s[D])==null?void 0:F.has(L))||!1},c=D=>{n({...s,[D]:new Set(r.map(L=>L.key))})},i=D=>{n({...s,[D]:new Set})},f=(D,L)=>{n({...s,[L]:new Set(s[D])})},p=()=>{n({admin:new Set(r.map(D=>D.key)),manager:new Set(["core-registry","core-ops","crm","cmms","water-quality","projects","costing"]),operator:new Set(["core-ops","cmms","water-quality"]),analyst:new Set(["dsa","me","costing","core-registry"]),viewer:new Set(["core-registry","me","dsa"])})},g=A.useMemo(()=>t.map(D=>{var L,F;return{roleId:D.id,totalModules:((L=s[D.id])==null?void 0:L.size)||0,percentage:Math.round((((F=s[D.id])==null?void 0:F.size)||0)/r.length*100)}}),[s]),[y,b]=A.useState(""),[w,T]=A.useState(""),[N,M]=A.useState(""),[O,C]=A.useState("");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Permission Matrix"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage role-based module access with bulk operations"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:t.map(D=>{const L=g.find(F=>F.roleId===D.id);return e.jsx(H,{children:e.jsx(X,{className:"pt-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`${D.color} text-white w-10 h-10 rounded-lg flex items-center justify-center mx-auto mb-2`,children:e.jsx(Ds,{className:"h-5 w-5"})}),e.jsx("p",{className:"text-sm font-medium",children:D.name}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:L==null?void 0:L.totalModules}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[L==null?void 0:L.percentage,"% access"]})]})})},D.id)})}),e.jsxs(H,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx(he,{children:"Permission Matrix"}),e.jsx(mr,{children:"Manage role-based module access. Use bulk operations for quick configuration."})]}),e.jsxs(K,{variant:"outline",size:"sm",onClick:p,children:[e.jsx(yI,{className:"h-4 w-4 mr-2"}),"Reset to Defaults"]})]})}),e.jsxs(X,{className:"space-y-6",children:[e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg border space-y-4",children:[e.jsxs("p",{className:"font-semibold text-sm flex items-center gap-2",children:[e.jsx(Ta,{className:"h-4 w-4"}),"Quick Actions"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium mb-2",children:" Grant All Modules"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Nt,{value:w,onValueChange:T,children:[e.jsx(bt,{className:"h-9",children:e.jsx(St,{placeholder:"Select role..."})}),e.jsx(_t,{children:t.map(D=>e.jsx(ge,{value:D.id,children:D.name},D.id))})]}),e.jsx(K,{size:"sm",onClick:()=>{w&&c(w)},disabled:!w,className:"w-20",children:e.jsx(Kc,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium mb-2",children:" Revoke All Modules"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Nt,{value:N,onValueChange:M,children:[e.jsx(bt,{className:"h-9",children:e.jsx(St,{placeholder:"Select role..."})}),e.jsx(_t,{children:t.map(D=>e.jsx(ge,{value:D.id,children:D.name},D.id))})]}),e.jsx(K,{size:"sm",variant:"destructive",onClick:()=>{N&&i(N)},disabled:!N,className:"w-20",children:e.jsx(Ko,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium mb-2",children:" Copy Permissions"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(Nt,{value:y,onValueChange:b,children:[e.jsx(bt,{className:"h-9 flex-1",children:e.jsx(St,{placeholder:"From..."})}),e.jsx(_t,{children:t.map(D=>e.jsx(ge,{value:D.id,children:D.name},D.id))})]}),e.jsxs(Nt,{value:O,onValueChange:C,children:[e.jsx(bt,{className:"h-9 flex-1",children:e.jsx(St,{placeholder:"To..."})}),e.jsx(_t,{children:t.filter(D=>D.id!==y).map(D=>e.jsx(ge,{value:D.id,children:D.name},D.id))})]}),e.jsx(K,{size:"sm",onClick:()=>{y&&O&&f(y,O)},disabled:!y||!O,className:"w-12",children:e.jsx(P_,{className:"h-4 w-4"})})]})]})]})]}),e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted border-b",children:[e.jsx("th",{className:"text-left py-4 px-4 font-semibold sticky left-0 bg-muted z-10",style:{minWidth:"200px"},children:"Module"}),t.map(D=>{var L;return e.jsx("th",{className:"text-center py-4 px-3",style:{minWidth:"120px"},children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:`${D.color} text-white px-3 py-2 rounded-md text-xs font-semibold`,children:D.name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[(L=s[D.id])==null?void 0:L.size,"/",r.length]})]})},D.id)})]})}),e.jsx("tbody",{children:r.map((D,L)=>e.jsxs("tr",{className:L%2===0?"bg-background hover:bg-muted/30":"bg-muted/20 hover:bg-muted/50",children:[e.jsx("td",{className:"py-4 px-4 font-medium sticky left-0 z-10 bg-inherit",children:D.name}),t.map(F=>e.jsx("td",{className:"text-center py-4 px-3",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(Fd,{checked:o(F.id,D.key),onCheckedChange:()=>a(F.id,D.key),"aria-label":`Grant ${F.name} access to ${D.name}`,className:"h-5 w-5"})})},`${F.id}-${D.key}`))]},D.key))})]})}),e.jsxs("div",{className:"flex gap-2 justify-end pt-4 border-t",children:[e.jsx(K,{variant:"outline",children:"Cancel"}),e.jsxs(K,{children:[e.jsx(Kc,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Role Summaries"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(D=>{var L;return e.jsxs(H,{className:"hover:shadow-md transition-shadow",children:[e.jsx(ue,{className:"pb-3",children:e.jsxs(he,{className:"text-base flex items-center gap-3",children:[e.jsx("div",{className:`${D.color} text-white p-2 rounded-lg`,children:e.jsx(Ds,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("p",{children:D.name}),e.jsx("p",{className:"text-xs text-muted-foreground font-normal mt-1",children:D.description})]})]})}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-muted/50 p-3 rounded-md",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"MODULES ASSIGNED"}),e.jsx("p",{className:"text-2xl font-bold",children:((L=s[D.id])==null?void 0:L.size)||0}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["of ",r.length," total"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground mb-2",children:"ACCESSIBLE:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:Array.from(s[D.id]||[]).sort().map(F=>r.find(B=>B.key===F)).filter(Boolean).map(F=>e.jsx(Ae,{variant:"secondary",className:"text-xs",children:F==null?void 0:F.name},F==null?void 0:F.key))})]})]})})]},D.id)})})]})]})}function qVe(){return e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:e.jsx(H,{className:"w-full max-w-md mx-4",children:e.jsxs(X,{className:"pt-6",children:[e.jsxs("div",{className:"flex mb-4 gap-2",children:[e.jsx(Nn,{className:"h-8 w-8 text-red-500"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),e.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}function VVe(){return e.jsx(Sse,{client:Vne,children:e.jsx(Gne,{children:e.jsx(Dne,{children:e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs(Pne,{children:[e.jsx(tt,{path:"/login",element:e.jsx(UF,{})}),e.jsx(tt,{path:"/auth/login",element:e.jsx(UF,{})}),e.jsx(tt,{path:"/auth/forgot-password",element:e.jsx(jie,{})}),e.jsx(tt,{path:"/auth/register",element:e.jsx(bie,{})}),e.jsx(tt,{path:"/",element:e.jsx(ct,{children:e.jsx(qa,{to:"/costing/budgets",replace:!0})})}),e.jsxs(tt,{path:"/core",element:e.jsx(ct,{children:e.jsx(ABe,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(_ie,{})}),e.jsx(tt,{path:"schemes",element:e.jsx(ct,{requiredPermission:"view schemes",children:e.jsx(fVe,{})})}),e.jsx(tt,{path:"assets",element:e.jsx(ct,{requiredPermission:"view assets",children:e.jsx(bVe,{})})}),e.jsx(tt,{path:"assets/:id",element:e.jsx(ct,{requiredPermission:"view assets",children:e.jsx(npe,{})})}),e.jsx(tt,{path:"asset-classes",element:e.jsx(ct,{requiredPermission:"view assets",children:e.jsx(Xxe,{})})}),e.jsx(tt,{path:"facilities",element:e.jsx(ct,{requiredPermission:"view facilities",children:e.jsx(Zde,{})})}),e.jsx(tt,{path:"dmas",element:e.jsx(ct,{requiredPermission:"view dmas",children:e.jsx(zhe,{})})}),e.jsx(tt,{path:"pipelines",element:e.jsx(ct,{requiredPermission:"view pipelines",children:e.jsx(Bhe,{})})}),e.jsx(tt,{path:"zones",element:e.jsx(ct,{requiredPermission:"view zones",children:e.jsx(qhe,{})})}),e.jsx(tt,{path:"addresses",element:e.jsx(ct,{requiredPermission:"view addresses",children:e.jsx(Vhe,{})})}),e.jsx(tt,{path:"meters",element:e.jsx(ct,{requiredPermission:"view assets",children:e.jsx(Rhe,{})})})]}),e.jsxs(tt,{path:"/gis",element:e.jsx(ct,{requiredPermission:"view gis",children:e.jsx(nme,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(q5,{})}),e.jsx(tt,{path:"map",element:e.jsx(q5,{})}),e.jsx(tt,{path:"files",element:e.jsx(Nfe,{})}),e.jsx(tt,{path:"settings",element:e.jsx(Sfe,{})})]}),e.jsxs(tt,{path:"/cmms",element:e.jsx(ct,{children:e.jsx(Dfe,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(qa,{to:"/cmms/dashboard",replace:!0})}),e.jsx(tt,{path:"dashboard",element:e.jsx(ct,{requiredPermission:"view assets",children:e.jsx(Rfe,{})})}),e.jsx(tt,{path:"assets",element:e.jsx(qa,{to:"/core/assets",replace:!0})}),e.jsx(tt,{path:"assets/:id",element:e.jsx(qa,{to:"/core/assets",replace:!0})}),e.jsx(tt,{path:"work-orders",element:e.jsx(ct,{requiredPermission:"view work orders",children:e.jsx(wpe,{})})}),e.jsx(tt,{path:"parts",element:e.jsx(ct,{requiredPermission:"view parts inventory",children:e.jsx(Spe,{})})}),e.jsx(tt,{path:"map",element:e.jsx(ct,{requiredPermission:"view assets",children:e.jsx(Ape,{})})}),e.jsx(tt,{path:"job-plans",element:e.jsx(ct,{requiredPermission:"view assets",children:e.jsx(Epe,{})})}),e.jsx(tt,{path:"pm",element:e.jsx(ct,{requiredPermission:"view assets",children:e.jsx(Mpe,{})})}),e.jsx(tt,{path:"condition-monitoring",element:e.jsx(ct,{requiredPermission:"view assets",children:e.jsx(jxe,{})})}),e.jsx(tt,{path:"stores",element:e.jsx(ct,{requiredPermission:"view parts inventory",children:e.jsx(wxe,{})})}),e.jsx(tt,{path:"fleet",element:e.jsx(ct,{requiredPermission:"view assets",children:e.jsx(Pxe,{})})}),e.jsx(tt,{path:"contractors",element:e.jsx(ct,{requiredPermission:"view assets",children:e.jsx(Gxe,{})})}),e.jsx(tt,{path:"hse",element:e.jsx(ct,{requiredPermission:"view assets",children:e.jsx(Zxe,{})})})]}),e.jsxs(tt,{path:"/security",element:e.jsx(ct,{children:e.jsx(Cfe,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(qa,{to:"/security/audit",replace:!0})}),e.jsx(tt,{path:"audit",element:e.jsx(ct,{requiredPermission:"view audit",children:e.jsx(Pfe,{})})}),e.jsx(tt,{path:"alerts",element:e.jsx(ct,{requiredPermission:"view security alerts",children:e.jsx(W5,{})})}),e.jsx(tt,{path:"roles",element:e.jsx(ct,{requiredPermission:"view roles",children:e.jsx(kfe,{})})}),e.jsx(tt,{path:"api-keys",element:e.jsx(ct,{requiredPermission:"view api keys",children:e.jsx(G5,{})})}),e.jsx(tt,{path:"dsr",element:e.jsx(ct,{requiredPermission:"view dsr requests",children:e.jsx(Afe,{})})}),e.jsx(tt,{path:"consents",element:e.jsx(ct,{requiredPermission:"view consents",children:e.jsx(Tfe,{})})}),e.jsx(tt,{path:"kms",element:e.jsx(ct,{requiredPermission:"view kms keys",children:e.jsx(Efe,{})})}),e.jsx(tt,{path:"retention",element:e.jsx(ct,{requiredPermission:"manage retention policies",children:e.jsx(Mfe,{})})}),e.jsx(tt,{path:"data-catalog",element:e.jsx(ct,{requiredPermission:"view data catalog",children:e.jsx(Ofe,{})})}),e.jsx(tt,{path:"2fa",element:e.jsx(ct,{children:e.jsx(Ife,{})})})]}),e.jsxs(tt,{path:"/water-quality",element:e.jsx(ct,{children:e.jsx(Qxe,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(qa,{to:"/water-quality/parameters",replace:!0})}),e.jsx(tt,{path:"parameters",element:e.jsx(ct,{requiredPermission:"view wq parameters",children:e.jsx(ege,{})})}),e.jsx(tt,{path:"sampling-points",element:e.jsx(ct,{requiredPermission:"view wq sampling points",children:e.jsx(lge,{})})}),e.jsx(tt,{path:"plans",element:e.jsx(ct,{requiredPermission:"view wq plans",children:e.jsx(dge,{})})}),e.jsx(tt,{path:"samples",element:e.jsx(ct,{requiredPermission:"view wq samples",children:e.jsx(mge,{})})}),e.jsx(tt,{path:"results",element:e.jsx(ct,{requiredPermission:"view wq results",children:e.jsx(pge,{})})}),e.jsx(tt,{path:"compliance",element:e.jsx(ct,{requiredPermission:"view wq compliance",children:e.jsx(xge,{})})})]}),e.jsxs(tt,{path:"/projects",element:e.jsx(ct,{children:e.jsx(EBe,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(ct,{requiredPermission:"view projects",children:e.jsx(MBe,{})})}),e.jsx(tt,{path:"list",element:e.jsx(ct,{requiredPermission:"view projects",children:e.jsx(IBe,{})})}),e.jsx(tt,{path:":id",element:e.jsx(ct,{requiredPermission:"view projects",children:e.jsx(FBe,{})})}),e.jsx(tt,{path:"pipelines",element:e.jsx(ct,{requiredPermission:"view projects",children:e.jsx(zBe,{})})}),e.jsx(tt,{path:"land",element:e.jsx(ct,{requiredPermission:"view projects",children:e.jsx(qBe,{})})}),e.jsx(tt,{path:"models",element:e.jsx(ct,{requiredPermission:"view projects",children:e.jsx(VBe,{})})}),e.jsx(tt,{path:"handover",element:e.jsx(ct,{requiredPermission:"view projects",children:e.jsx(WBe,{})})}),e.jsx(tt,{path:"procurement",element:e.jsx(ct,{requiredPermission:"view projects",children:e.jsx(GBe,{})})}),e.jsx(tt,{path:"map",element:e.jsx(ct,{requiredPermission:"view projects",children:e.jsx(KBe,{})})})]}),e.jsxs(tt,{path:"/crm",element:e.jsx(ct,{children:e.jsx(gge,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(qa,{to:"/crm/customers",replace:!0})}),e.jsx(tt,{path:"customers",element:e.jsx(ct,{requiredPermission:"view customers",children:e.jsx(vge,{})})}),e.jsx(tt,{path:"complaints",element:e.jsx(ct,{requiredPermission:"view customers",children:e.jsx(bze,{})})}),e.jsx(tt,{path:"interactions",element:e.jsx(ct,{requiredPermission:"view customers",children:e.jsx(wze,{})})}),e.jsx(tt,{path:"segmentation",element:e.jsx(ct,{requiredPermission:"view customers",children:e.jsx(Nze,{})})}),e.jsx(tt,{path:"accounts/search",element:e.jsx(ct,{requiredPermission:"view service connections",children:e.jsx(gze,{})})}),e.jsx(tt,{path:"accounts/:accountNo",element:e.jsx(ct,{requiredPermission:"view service connections",children:e.jsx(xze,{})})}),e.jsx(tt,{path:"ra",element:e.jsx(ct,{requiredPermission:"view ra cases",children:e.jsx(Sze,{})})}),e.jsx(tt,{path:"dunning",element:e.jsx(ct,{requiredPermission:"view service connections",children:e.jsx(Cze,{})})}),e.jsx(tt,{path:"import",element:e.jsx(ct,{requiredPermission:"manage billing",children:e.jsx(Pze,{})})})]}),e.jsxs(tt,{path:"/hydromet",element:e.jsx(ct,{children:e.jsx(TBe,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(qa,{to:"/hydromet/sources",replace:!0})}),e.jsx(tt,{path:"sources",element:e.jsx(ct,{requiredPermission:"view sources",children:e.jsx(oBe,{})})}),e.jsx(tt,{path:"stations",element:e.jsx(ct,{requiredPermission:"view stations",children:e.jsx(dBe,{})})}),e.jsx(tt,{path:"aquifers",element:e.jsx(ct,{requiredPermission:"view sources",children:e.jsx(Iqe,{})})})]}),e.jsxs(tt,{path:"/costing",element:e.jsx(ct,{children:e.jsx(M8,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(qa,{to:"/costing/budgets",replace:!0})}),e.jsx(tt,{path:"budgets",element:e.jsx(ct,{requiredPermission:"view budgets",children:e.jsx(gBe,{})})}),e.jsx(tt,{path:"budgets/:id",element:e.jsx(ct,{requiredPermission:"view budgets",children:e.jsx(yBe,{})})}),e.jsx(tt,{path:"allocations",element:e.jsx(ct,{requiredPermission:"view allocations",children:e.jsx(vBe,{})})}),e.jsx(tt,{path:"cost-to-serve",element:e.jsx(ct,{requiredPermission:"view cost to serve",children:e.jsx(jBe,{})})}),e.jsx(tt,{path:"gl-accounts",element:e.jsx(ct,{requiredPermission:"view budgets",children:e.jsx(bBe,{})})}),e.jsx(tt,{path:"cost-centers",element:e.jsx(ct,{requiredPermission:"view budgets",children:e.jsx(_Be,{})})}),e.jsx(tt,{path:"energy/tariffs",element:e.jsx(ct,{requiredPermission:"view energy tariffs",children:e.jsx(wBe,{})})}),e.jsx(tt,{path:"energy/readings",element:e.jsx(ct,{requiredPermission:"upload energy readings",children:e.jsx(NBe,{})})}),e.jsx(tt,{path:"energy/dashboard",element:e.jsx(ct,{requiredPermission:"view energy dashboard",children:e.jsx(SBe,{})})})]}),e.jsxs(tt,{path:"/procurement",element:e.jsx(ct,{children:e.jsx(M8,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(qa,{to:"/procurement/requisitions",replace:!0})}),e.jsx(tt,{path:"requisitions",element:e.jsx(ct,{requiredPermission:"view requisitions",children:e.jsx(CBe,{})})}),e.jsx(tt,{path:"rfqs",element:e.jsx(ct,{requiredPermission:"view rfqs",children:e.jsx(PBe,{})})}),e.jsx(tt,{path:"lpos",element:e.jsx(ct,{requiredPermission:"view lpos",children:e.jsx(kBe,{})})})]}),e.jsxs(tt,{path:"/me",element:e.jsx(ct,{children:e.jsx(YBe,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(qa,{to:"/me/kpis",replace:!0})}),e.jsx(tt,{path:"kpis",element:e.jsx(ct,{children:e.jsx(w8e,{})})}),e.jsx(tt,{path:"coverage",element:e.jsx(ct,{children:e.jsx(N8e,{})})}),e.jsx(tt,{path:"nrw",element:e.jsx(ct,{children:e.jsx(S8e,{})})}),e.jsx(tt,{path:"cx",element:e.jsx(ct,{children:e.jsx(C8e,{})})}),e.jsx(tt,{path:"indicators",element:e.jsx(ct,{children:e.jsx(P8e,{})})}),e.jsx(tt,{path:"gender-equity",element:e.jsx(ct,{children:e.jsx(Rqe,{})})})]}),e.jsxs(tt,{path:"/customer",element:e.jsx(ct,{children:e.jsx(XBe,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(qa,{to:"/customer/tariffs",replace:!0})}),e.jsx(tt,{path:"tariffs",element:e.jsx(ct,{children:e.jsx(k8e,{})})}),e.jsx(tt,{path:"billing",element:e.jsx(ct,{children:e.jsx(A8e,{})})}),e.jsx(tt,{path:"payments",element:e.jsx(ct,{children:e.jsx(T8e,{})})}),e.jsx(tt,{path:"meter-routes",element:e.jsx(ct,{children:e.jsx(E8e,{})})}),e.jsx(tt,{path:"tickets",element:e.jsx(ct,{children:e.jsx(M8e,{})})}),e.jsx(tt,{path:"kiosks",element:e.jsx(ct,{children:e.jsx(O8e,{})})}),e.jsx(tt,{path:"trucking",element:e.jsx(ct,{children:e.jsx(I8e,{})})}),e.jsx(tt,{path:"connections",element:e.jsx(ct,{children:e.jsx(D8e,{})})})]}),e.jsxs(tt,{path:"/community",element:e.jsx(ct,{children:e.jsx(R8e,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(qa,{to:"/community/committees",replace:!0})}),e.jsx(tt,{path:"committees",element:e.jsx(ct,{children:e.jsx(L8e,{})})}),e.jsx(tt,{path:"committees/:id",element:e.jsx(ct,{children:e.jsx(F8e,{})})}),e.jsx(tt,{path:"finance",element:e.jsx(ct,{children:e.jsx($8e,{})})}),e.jsx(tt,{path:"vendors",element:e.jsx(ct,{children:e.jsx(z8e,{})})}),e.jsx(tt,{path:"bids",element:e.jsx(ct,{children:e.jsx(B8e,{})})}),e.jsx(tt,{path:"deliveries",element:e.jsx(ct,{children:e.jsx(q8e,{})})}),e.jsx(tt,{path:"stakeholders",element:e.jsx(ct,{children:e.jsx(Q8e,{})})}),e.jsx(tt,{path:"engagements",element:e.jsx(ct,{children:e.jsx(sqe,{})})}),e.jsx(tt,{path:"grm",element:e.jsx(ct,{children:e.jsx(nqe,{})})}),e.jsx(tt,{path:"open-data",element:e.jsx(ct,{children:e.jsx(oqe,{})})}),e.jsx(tt,{path:"dataset-builder",element:e.jsx(ct,{children:e.jsx(dqe,{})})}),e.jsx(tt,{path:"public-maps",element:e.jsx(ct,{children:e.jsx(hqe,{})})})]}),e.jsxs(tt,{path:"/core-ops",element:e.jsx(ct,{children:e.jsx(mqe,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(qa,{to:"/core-ops/console",replace:!0})}),e.jsx(tt,{path:"console",element:e.jsx(ct,{requiredPermission:"core_ops.view_operations",children:e.jsx(fqe,{})})}),e.jsx(tt,{path:"topology",element:e.jsx(ct,{requiredPermission:"core_ops.view_topology",children:e.jsx(pqe,{})})}),e.jsx(tt,{path:"telemetry",element:e.jsx(ct,{requiredPermission:"core_ops.view_telemetry",children:e.jsx(SVe,{})})}),e.jsx(tt,{path:"network",element:e.jsx(ct,{requiredPermission:"core_ops.view_topology",children:e.jsx(AVe,{})})}),e.jsx(tt,{path:"outages",element:e.jsx(ct,{requiredPermission:"core_ops.view_outages",children:e.jsx(PVe,{})})}),e.jsx(tt,{path:"nrw",element:e.jsx(ct,{requiredPermission:"core_ops.view_nrw",children:e.jsx(xqe,{})})}),e.jsx(tt,{path:"dosing",element:e.jsx(ct,{requiredPermission:"core_ops.view_dosing",children:e.jsx(gqe,{})})}),e.jsx(tt,{path:"scheduling",element:e.jsx(ct,{requiredPermission:"core_ops.view_scheduling",children:e.jsx(yqe,{})})}),e.jsx(tt,{path:"pressure-leak",element:e.jsx(ct,{requiredPermission:"core_ops.view_operations",children:e.jsx(jqe,{})})}),e.jsx(tt,{path:"shifts",element:e.jsx(ct,{requiredPermission:"operations.view_shifts",children:e.jsx(bqe,{})})}),e.jsx(tt,{path:"events",element:e.jsx(ct,{requiredPermission:"operations.view_events",children:e.jsx(_qe,{})})}),e.jsx(tt,{path:"checklists",element:e.jsx(ct,{requiredPermission:"operations.view_checklists",children:e.jsx(Sqe,{})})}),e.jsx(tt,{path:"playbooks",element:e.jsx(ct,{requiredPermission:"operations.view_playbooks",children:e.jsx(Cqe,{})})}),e.jsx(tt,{path:"escalation-policies",element:e.jsx(ct,{requiredPermission:"operations.view_escalation_policies",children:e.jsx(Aqe,{})})}),e.jsx(tt,{path:"predictions",element:e.jsx(ct,{requiredPermission:"core_ops.view_operations",children:e.jsx(Tqe,{})})}),e.jsx(tt,{path:"workflows/definitions",element:e.jsx(ct,{requiredPermission:"workflows.view",children:e.jsx(Eqe,{})})}),e.jsx(tt,{path:"workflows/instances",element:e.jsx(ct,{requiredPermission:"workflows.view",children:e.jsx(Mqe,{})})}),e.jsx(tt,{path:"droughts",element:e.jsx(ct,{requiredPermission:"core_ops.view_operations",children:e.jsx(Dqe,{})})})]}),e.jsxs(tt,{path:"/risk-compliance",element:e.jsx(ct,{children:e.jsx(TVe,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(qa,{to:"/risk-compliance/home",replace:!0})}),e.jsx(tt,{path:"home",element:e.jsx(ct,{requiredPermission:"risk.view",children:e.jsx(EVe,{})})}),e.jsx(tt,{path:"risks",element:e.jsx(ct,{requiredPermission:"risk.view",children:e.jsx(MVe,{})})}),e.jsx(tt,{path:"incidents",element:e.jsx(ct,{requiredPermission:"compliance.view",children:e.jsx(OVe,{})})}),e.jsx(tt,{path:"bcp",element:e.jsx(ct,{requiredPermission:"compliance.view",children:e.jsx(IVe,{})})}),e.jsx(tt,{path:"regulatory-reporting",element:e.jsx(ct,{requiredPermission:"compliance.view",children:e.jsx(DVe,{})})}),e.jsx(tt,{path:"policies",element:e.jsx(ct,{requiredPermission:"compliance.view",children:e.jsx(RVe,{})})}),e.jsx(tt,{path:"audit",element:e.jsx(ct,{requiredPermission:"audit.view",children:e.jsx(LVe,{})})}),e.jsx(tt,{path:"hse",element:e.jsx(ct,{requiredPermission:"hse.view",children:e.jsx(FVe,{})})}),e.jsx(tt,{path:"dpo",element:e.jsx(ct,{requiredPermission:"compliance.dpo",children:e.jsx($Ve,{})})})]}),e.jsxs(tt,{path:"/admin",element:e.jsx(ct,{children:e.jsx(HBe,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(qa,{to:"/admin/users",replace:!0})}),e.jsx(tt,{path:"users",element:e.jsx(ct,{requiredPermission:"rbac.view",children:e.jsx(t8e,{})})}),e.jsx(tt,{path:"rbac/roles",element:e.jsx(ct,{requiredPermission:"rbac.view",children:e.jsx(r8e,{})})}),e.jsx(tt,{path:"rbac/matrix",element:e.jsx(ct,{requiredPermission:"rbac.view",children:e.jsx(s8e,{})})}),e.jsx(tt,{path:"audit",element:e.jsx(ct,{requiredPermission:"audit.view",children:e.jsx(n8e,{})})}),e.jsx(tt,{path:"security/alerts",element:e.jsx(ct,{requiredPermission:"security.view",children:e.jsx(W5,{})})}),e.jsx(tt,{path:"security/api-keys",element:e.jsx(ct,{requiredPermission:"security.view",children:e.jsx(G5,{})})}),e.jsx(tt,{path:"settings",element:e.jsx(ct,{requiredPermission:"settings.manage",children:e.jsx(zVe,{})})}),e.jsx(tt,{path:"rbac/menu-access",element:e.jsx(ct,{requiredPermission:"rbac.manage",children:e.jsx(BVe,{})})})]}),e.jsxs(tt,{path:"/integration",element:e.jsx(ct,{children:e.jsx(ZBe,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(qa,{to:"/integration/api",replace:!0})}),e.jsx(tt,{path:"api",element:e.jsx(ct,{requiredPermission:"integration.api.view",children:e.jsx(a8e,{})})}),e.jsx(tt,{path:"mdm",element:e.jsx(ct,{requiredPermission:"integration.mdm.view",children:e.jsx(i8e,{})})}),e.jsx(tt,{path:"sso",element:e.jsx(ct,{requiredPermission:"integration.sso.view",children:e.jsx(o8e,{})})}),e.jsx(tt,{path:"edrms",element:e.jsx(ct,{requiredPermission:"integration.edrms.view",children:e.jsx(l8e,{})})}),e.jsx(tt,{path:"dw-lineage",element:e.jsx(ct,{requiredPermission:"integration.dw.view",children:e.jsx(L8,{})})}),e.jsx(tt,{path:"dw",element:e.jsx(ct,{requiredPermission:"integration.dw.view",children:e.jsx(L8,{})})}),e.jsx(tt,{path:"notifications",element:e.jsx(ct,{requiredPermission:"integration.notifications.view",children:e.jsx(f8e,{})})}),e.jsx(tt,{path:"devices",element:e.jsx(ct,{requiredPermission:"integration.devices.view",children:e.jsx(p8e,{})})}),e.jsx(tt,{path:"observability",element:e.jsx(ct,{requiredPermission:"integration.observability.view",children:e.jsx(x8e,{})})}),e.jsx(tt,{path:"backup-dr",element:e.jsx(ct,{requiredPermission:"integration.backup.view",children:e.jsx(g8e,{})})}),e.jsx(tt,{path:"secrets",element:e.jsx(ct,{requiredPermission:"integration.secrets.view",children:e.jsx(y8e,{})})}),e.jsx(tt,{path:"connectors",element:e.jsx(ct,{requiredPermission:"integration.connectors.view",children:e.jsx(v8e,{})})}),e.jsx(tt,{path:"webhooks",element:e.jsx(ct,{requiredPermission:"integration.webhooks.view",children:e.jsx(j8e,{})})}),e.jsx(tt,{path:"etl",element:e.jsx(ct,{requiredPermission:"integration.etl.view",children:e.jsx(b8e,{})})}),e.jsx(tt,{path:"comms",element:e.jsx(ct,{requiredPermission:"integration.comms.view",children:e.jsx(_8e,{})})})]}),e.jsxs(tt,{path:"/training",element:e.jsx(ct,{children:e.jsx(Lqe,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(qa,{to:"/training/courses",replace:!0})}),e.jsx(tt,{path:"courses",element:e.jsx(zqe,{})}),e.jsx(tt,{path:"my-learning",element:e.jsx(qqe,{})}),e.jsx(tt,{path:"kb",element:e.jsx(Wqe,{})}),e.jsx(tt,{path:"sops",element:e.jsx(Hqe,{})}),e.jsx(tt,{path:"skills",element:e.jsx(Xqe,{})}),e.jsx(tt,{path:"certificates",element:e.jsx(Qqe,{})}),e.jsx(tt,{path:"assessments",element:e.jsx(Oqe,{})})]}),e.jsxs(tt,{path:"/dsa",element:e.jsx(ct,{children:e.jsx(Jqe,{})}),children:[e.jsx(tt,{index:!0,element:e.jsx(qa,{to:"/dsa/forecast",replace:!0})}),e.jsx(tt,{path:"forecast",element:e.jsx(ct,{requiredPermission:"dsa.view_forecast",children:e.jsx(eVe,{})})}),e.jsx(tt,{path:"scenarios",element:e.jsx(ct,{requiredPermission:"dsa.view_scenarios",children:e.jsx(tVe,{})})}),e.jsx(tt,{path:"optimize",element:e.jsx(ct,{requiredPermission:"dsa.view_optimization",children:e.jsx(rVe,{})})}),e.jsx(tt,{path:"anomalies",element:e.jsx(ct,{requiredPermission:"dsa.view_anomalies",children:e.jsx(sVe,{})})}),e.jsx(tt,{path:"aquifer",element:e.jsx(ct,{requiredPermission:"dsa.view_hydro",children:e.jsx(nVe,{})})}),e.jsx(tt,{path:"tariffs",element:e.jsx(ct,{requiredPermission:"dsa.view_tariffs",children:e.jsx(aVe,{})})}),e.jsx(tt,{path:"ews",element:e.jsx(ct,{requiredPermission:"dsa.view_ews",children:e.jsx(iVe,{})})})]}),e.jsx(tt,{path:"*",element:e.jsx(qVe,{})})]})})})})})}vU(document.getElementById("root")).render(e.jsx(VVe,{}));
