var LR=e=>{throw TypeError(e)};var ZC=(e,r,n)=>r.has(e)||LR("Cannot "+n);var Ze=(e,r,n)=>(ZC(e,r,"read from private field"),n?n.call(e):r.get(e)),Vr=(e,r,n)=>r.has(e)?LR("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(e):r.set(e,n),vr=(e,r,n,s)=>(ZC(e,r,"write to private field"),s?s.call(e,n):r.set(e,n),n),xn=(e,r,n)=>(ZC(e,r,"access private method"),n);var Rw=(e,r,n,s)=>({set _(i){vr(e,r,i,n)},get _(){return Ze(e,r,s)}});function xB(e,r){for(var n=0;n<r.length;n++){const s=r[n];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in e)){const l=Object.getOwnPropertyDescriptor(s,i);l&&Object.defineProperty(e,i,l.get?l:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function n(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(i){if(i.ep)return;i.ep=!0;const l=n(i);fetch(i.href,l)}})();var U0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var gB={exports:{}},YS={},yB={exports:{}},Nn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $b=Symbol.for("react.element"),iQ=Symbol.for("react.portal"),aQ=Symbol.for("react.fragment"),oQ=Symbol.for("react.strict_mode"),lQ=Symbol.for("react.profiler"),cQ=Symbol.for("react.provider"),dQ=Symbol.for("react.context"),uQ=Symbol.for("react.forward_ref"),hQ=Symbol.for("react.suspense"),mQ=Symbol.for("react.memo"),fQ=Symbol.for("react.lazy"),FR=Symbol.iterator;function pQ(e){return e===null||typeof e!="object"?null:(e=FR&&e[FR]||e["@@iterator"],typeof e=="function"?e:null)}var vB={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_B=Object.assign,bB={};function Sy(e,r,n){this.props=e,this.context=r,this.refs=bB,this.updater=n||vB}Sy.prototype.isReactComponent={};Sy.prototype.setState=function(e,r){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,r,"setState")};Sy.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function jB(){}jB.prototype=Sy.prototype;function XM(e,r,n){this.props=e,this.context=r,this.refs=bB,this.updater=n||vB}var QM=XM.prototype=new jB;QM.constructor=XM;_B(QM,Sy.prototype);QM.isPureReactComponent=!0;var zR=Array.isArray,wB=Object.prototype.hasOwnProperty,JM={current:null},NB={key:!0,ref:!0,__self:!0,__source:!0};function SB(e,r,n){var s,i={},l=null,d=null;if(r!=null)for(s in r.ref!==void 0&&(d=r.ref),r.key!==void 0&&(l=""+r.key),r)wB.call(r,s)&&!NB.hasOwnProperty(s)&&(i[s]=r[s]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var f=Array(a),p=0;p<a;p++)f[p]=arguments[p+2];i.children=f}if(e&&e.defaultProps)for(s in a=e.defaultProps,a)i[s]===void 0&&(i[s]=a[s]);return{$$typeof:$b,type:e,key:l,ref:d,props:i,_owner:JM.current}}function xQ(e,r){return{$$typeof:$b,type:e.type,key:r,ref:e.ref,props:e.props,_owner:e._owner}}function eO(e){return typeof e=="object"&&e!==null&&e.$$typeof===$b}function gQ(e){var r={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return r[n]})}var $R=/\/+/g;function YC(e,r){return typeof e=="object"&&e!==null&&e.key!=null?gQ(""+e.key):r.toString(36)}function A1(e,r,n,s,i){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var d=!1;if(e===null)d=!0;else switch(l){case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case $b:case iQ:d=!0}}if(d)return d=e,i=i(d),e=s===""?"."+YC(d,0):s,zR(i)?(n="",e!=null&&(n=e.replace($R,"$&/")+"/"),A1(i,r,n,"",function(p){return p})):i!=null&&(eO(i)&&(i=xQ(i,n+(!i.key||d&&d.key===i.key?"":(""+i.key).replace($R,"$&/")+"/")+e)),r.push(i)),1;if(d=0,s=s===""?".":s+":",zR(e))for(var a=0;a<e.length;a++){l=e[a];var f=s+YC(l,a);d+=A1(l,r,n,f,i)}else if(f=pQ(e),typeof f=="function")for(e=f.call(e),a=0;!(l=e.next()).done;)l=l.value,f=s+YC(l,a++),d+=A1(l,r,n,f,i);else if(l==="object")throw r=String(e),Error("Objects are not valid as a React child (found: "+(r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return d}function Lw(e,r,n){if(e==null)return e;var s=[],i=0;return A1(e,s,"","",function(l){return r.call(n,l,i++)}),s}function yQ(e){if(e._status===-1){var r=e._result;r=r(),r.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=r)}if(e._status===1)return e._result.default;throw e._result}var po={current:null},k1={transition:null},vQ={ReactCurrentDispatcher:po,ReactCurrentBatchConfig:k1,ReactCurrentOwner:JM};function PB(){throw Error("act(...) is not supported in production builds of React.")}Nn.Children={map:Lw,forEach:function(e,r,n){Lw(e,function(){r.apply(this,arguments)},n)},count:function(e){var r=0;return Lw(e,function(){r++}),r},toArray:function(e){return Lw(e,function(r){return r})||[]},only:function(e){if(!eO(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Nn.Component=Sy;Nn.Fragment=aQ;Nn.Profiler=lQ;Nn.PureComponent=XM;Nn.StrictMode=oQ;Nn.Suspense=hQ;Nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vQ;Nn.act=PB;Nn.cloneElement=function(e,r,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=_B({},e.props),i=e.key,l=e.ref,d=e._owner;if(r!=null){if(r.ref!==void 0&&(l=r.ref,d=JM.current),r.key!==void 0&&(i=""+r.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(f in r)wB.call(r,f)&&!NB.hasOwnProperty(f)&&(s[f]=r[f]===void 0&&a!==void 0?a[f]:r[f])}var f=arguments.length-2;if(f===1)s.children=n;else if(1<f){a=Array(f);for(var p=0;p<f;p++)a[p]=arguments[p+2];s.children=a}return{$$typeof:$b,type:e.type,key:i,ref:l,props:s,_owner:d}};Nn.createContext=function(e){return e={$$typeof:dQ,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:cQ,_context:e},e.Consumer=e};Nn.createElement=SB;Nn.createFactory=function(e){var r=SB.bind(null,e);return r.type=e,r};Nn.createRef=function(){return{current:null}};Nn.forwardRef=function(e){return{$$typeof:uQ,render:e}};Nn.isValidElement=eO;Nn.lazy=function(e){return{$$typeof:fQ,_payload:{_status:-1,_result:e},_init:yQ}};Nn.memo=function(e,r){return{$$typeof:mQ,type:e,compare:r===void 0?null:r}};Nn.startTransition=function(e){var r=k1.transition;k1.transition={};try{e()}finally{k1.transition=r}};Nn.unstable_act=PB;Nn.useCallback=function(e,r){return po.current.useCallback(e,r)};Nn.useContext=function(e){return po.current.useContext(e)};Nn.useDebugValue=function(){};Nn.useDeferredValue=function(e){return po.current.useDeferredValue(e)};Nn.useEffect=function(e,r){return po.current.useEffect(e,r)};Nn.useId=function(){return po.current.useId()};Nn.useImperativeHandle=function(e,r,n){return po.current.useImperativeHandle(e,r,n)};Nn.useInsertionEffect=function(e,r){return po.current.useInsertionEffect(e,r)};Nn.useLayoutEffect=function(e,r){return po.current.useLayoutEffect(e,r)};Nn.useMemo=function(e,r){return po.current.useMemo(e,r)};Nn.useReducer=function(e,r,n){return po.current.useReducer(e,r,n)};Nn.useRef=function(e){return po.current.useRef(e)};Nn.useState=function(e){return po.current.useState(e)};Nn.useSyncExternalStore=function(e,r,n){return po.current.useSyncExternalStore(e,r,n)};Nn.useTransition=function(){return po.current.useTransition()};Nn.version="18.3.1";yB.exports=Nn;var O=yB.exports;const me=Vn(O),CB=xB({__proto__:null,default:me},[O]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _Q=O,bQ=Symbol.for("react.element"),jQ=Symbol.for("react.fragment"),wQ=Object.prototype.hasOwnProperty,NQ=_Q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,SQ={key:!0,ref:!0,__self:!0,__source:!0};function AB(e,r,n){var s,i={},l=null,d=null;n!==void 0&&(l=""+n),r.key!==void 0&&(l=""+r.key),r.ref!==void 0&&(d=r.ref);for(s in r)wQ.call(r,s)&&!SQ.hasOwnProperty(s)&&(i[s]=r[s]);if(e&&e.defaultProps)for(s in r=e.defaultProps,r)i[s]===void 0&&(i[s]=r[s]);return{$$typeof:bQ,type:e,key:l,ref:d,props:i,_owner:NQ.current}}YS.Fragment=jQ;YS.jsx=AB;YS.jsxs=AB;gB.exports=YS;var t=gB.exports,kB={exports:{}},cl={},TB={exports:{}},EB={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function r(Ce,ve){var rt=Ce.length;Ce.push(ve);e:for(;0<rt;){var vt=rt-1>>>1,gt=Ce[vt];if(0<i(gt,ve))Ce[vt]=ve,Ce[rt]=gt,rt=vt;else break e}}function n(Ce){return Ce.length===0?null:Ce[0]}function s(Ce){if(Ce.length===0)return null;var ve=Ce[0],rt=Ce.pop();if(rt!==ve){Ce[0]=rt;e:for(var vt=0,gt=Ce.length,Et=gt>>>1;vt<Et;){var tr=2*(vt+1)-1,Dr=Ce[tr],Pr=tr+1,It=Ce[Pr];if(0>i(Dr,rt))Pr<gt&&0>i(It,Dr)?(Ce[vt]=It,Ce[Pr]=rt,vt=Pr):(Ce[vt]=Dr,Ce[tr]=rt,vt=tr);else if(Pr<gt&&0>i(It,rt))Ce[vt]=It,Ce[Pr]=rt,vt=Pr;else break e}}return ve}function i(Ce,ve){var rt=Ce.sortIndex-ve.sortIndex;return rt!==0?rt:Ce.id-ve.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var d=Date,a=d.now();e.unstable_now=function(){return d.now()-a}}var f=[],p=[],y=1,v=null,j=3,w=!1,k=!1,S=!1,R=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(Ce){for(var ve=n(p);ve!==null;){if(ve.callback===null)s(p);else if(ve.startTime<=Ce)s(p),ve.sortIndex=ve.expirationTime,r(f,ve);else break;ve=n(p)}}function L(Ce){if(S=!1,I(Ce),!k)if(n(f)!==null)k=!0,Ue($);else{var ve=n(p);ve!==null&&tt(L,ve.startTime-Ce)}}function $(Ce,ve){k=!1,S&&(S=!1,D(oe),oe=-1),w=!0;var rt=j;try{for(I(ve),v=n(f);v!==null&&(!(v.expirationTime>ve)||Ce&&!ie());){var vt=v.callback;if(typeof vt=="function"){v.callback=null,j=v.priorityLevel;var gt=vt(v.expirationTime<=ve);ve=e.unstable_now(),typeof gt=="function"?v.callback=gt:v===n(f)&&s(f),I(ve)}else s(f);v=n(f)}if(v!==null)var Et=!0;else{var tr=n(p);tr!==null&&tt(L,tr.startTime-ve),Et=!1}return Et}finally{v=null,j=rt,w=!1}}var W=!1,Z=null,oe=-1,te=5,be=-1;function ie(){return!(e.unstable_now()-be<te)}function ge(){if(Z!==null){var Ce=e.unstable_now();be=Ce;var ve=!0;try{ve=Z(!0,Ce)}finally{ve?Ie():(W=!1,Z=null)}}else W=!1}var Ie;if(typeof T=="function")Ie=function(){T(ge)};else if(typeof MessageChannel<"u"){var Oe=new MessageChannel,Xe=Oe.port2;Oe.port1.onmessage=ge,Ie=function(){Xe.postMessage(null)}}else Ie=function(){R(ge,0)};function Ue(Ce){Z=Ce,W||(W=!0,Ie())}function tt(Ce,ve){oe=R(function(){Ce(e.unstable_now())},ve)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ce){Ce.callback=null},e.unstable_continueExecution=function(){k||w||(k=!0,Ue($))},e.unstable_forceFrameRate=function(Ce){0>Ce||125<Ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):te=0<Ce?Math.floor(1e3/Ce):5},e.unstable_getCurrentPriorityLevel=function(){return j},e.unstable_getFirstCallbackNode=function(){return n(f)},e.unstable_next=function(Ce){switch(j){case 1:case 2:case 3:var ve=3;break;default:ve=j}var rt=j;j=ve;try{return Ce()}finally{j=rt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Ce,ve){switch(Ce){case 1:case 2:case 3:case 4:case 5:break;default:Ce=3}var rt=j;j=Ce;try{return ve()}finally{j=rt}},e.unstable_scheduleCallback=function(Ce,ve,rt){var vt=e.unstable_now();switch(typeof rt=="object"&&rt!==null?(rt=rt.delay,rt=typeof rt=="number"&&0<rt?vt+rt:vt):rt=vt,Ce){case 1:var gt=-1;break;case 2:gt=250;break;case 5:gt=1073741823;break;case 4:gt=1e4;break;default:gt=5e3}return gt=rt+gt,Ce={id:y++,callback:ve,priorityLevel:Ce,startTime:rt,expirationTime:gt,sortIndex:-1},rt>vt?(Ce.sortIndex=rt,r(p,Ce),n(f)===null&&Ce===n(p)&&(S?(D(oe),oe=-1):S=!0,tt(L,rt-vt))):(Ce.sortIndex=gt,r(f,Ce),k||w||(k=!0,Ue($))),Ce},e.unstable_shouldYield=ie,e.unstable_wrapCallback=function(Ce){var ve=j;return function(){var rt=j;j=ve;try{return Ce.apply(this,arguments)}finally{j=rt}}}})(EB);TB.exports=EB;var PQ=TB.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CQ=O,ol=PQ;function Zt(e){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)r+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var MB=new Set,y_={};function up(e,r){Ig(e,r),Ig(e+"Capture",r)}function Ig(e,r){for(y_[e]=r,e=0;e<r.length;e++)MB.add(r[e])}var fu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),kk=Object.prototype.hasOwnProperty,AQ=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,BR={},qR={};function kQ(e){return kk.call(qR,e)?!0:kk.call(BR,e)?!1:AQ.test(e)?qR[e]=!0:(BR[e]=!0,!1)}function TQ(e,r,n,s){if(n!==null&&n.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function EQ(e,r,n,s){if(r===null||typeof r>"u"||TQ(e,r,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function xo(e,r,n,s,i,l,d){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=s,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=r,this.sanitizeURL=l,this.removeEmptyString=d}var Ea={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ea[e]=new xo(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var r=e[0];Ea[r]=new xo(r,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ea[e]=new xo(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ea[e]=new xo(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ea[e]=new xo(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ea[e]=new xo(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ea[e]=new xo(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ea[e]=new xo(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ea[e]=new xo(e,5,!1,e.toLowerCase(),null,!1,!1)});var tO=/[\-:]([a-z])/g;function rO(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var r=e.replace(tO,rO);Ea[r]=new xo(r,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var r=e.replace(tO,rO);Ea[r]=new xo(r,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var r=e.replace(tO,rO);Ea[r]=new xo(r,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ea[e]=new xo(e,1,!1,e.toLowerCase(),null,!1,!1)});Ea.xlinkHref=new xo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ea[e]=new xo(e,1,!1,e.toLowerCase(),null,!0,!0)});function nO(e,r,n,s){var i=Ea.hasOwnProperty(r)?Ea[r]:null;(i!==null?i.type!==0:s||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(EQ(r,n,i,s)&&(n=null),s||i===null?kQ(r)&&(n===null?e.removeAttribute(r):e.setAttribute(r,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(r=i.attributeName,s=i.attributeNamespace,n===null?e.removeAttribute(r):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,s?e.setAttributeNS(s,r,n):e.setAttribute(r,n))))}var Tu=CQ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fw=Symbol.for("react.element"),$x=Symbol.for("react.portal"),Bx=Symbol.for("react.fragment"),sO=Symbol.for("react.strict_mode"),Tk=Symbol.for("react.profiler"),OB=Symbol.for("react.provider"),IB=Symbol.for("react.context"),iO=Symbol.for("react.forward_ref"),Ek=Symbol.for("react.suspense"),Mk=Symbol.for("react.suspense_list"),aO=Symbol.for("react.memo"),jh=Symbol.for("react.lazy"),DB=Symbol.for("react.offscreen"),VR=Symbol.iterator;function g0(e){return e===null||typeof e!="object"?null:(e=VR&&e[VR]||e["@@iterator"],typeof e=="function"?e:null)}var ci=Object.assign,XC;function W0(e){if(XC===void 0)try{throw Error()}catch(n){var r=n.stack.trim().match(/\n( *(at )?)/);XC=r&&r[1]||""}return`
`+XC+e}var QC=!1;function JC(e,r){if(!e||QC)return"";QC=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(p){var s=p}Reflect.construct(e,[],r)}else{try{r.call()}catch(p){s=p}e.call(r.prototype)}else{try{throw Error()}catch(p){s=p}e()}}catch(p){if(p&&s&&typeof p.stack=="string"){for(var i=p.stack.split(`
`),l=s.stack.split(`
`),d=i.length-1,a=l.length-1;1<=d&&0<=a&&i[d]!==l[a];)a--;for(;1<=d&&0<=a;d--,a--)if(i[d]!==l[a]){if(d!==1||a!==1)do if(d--,a--,0>a||i[d]!==l[a]){var f=`
`+i[d].replace(" at new "," at ");return e.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",e.displayName)),f}while(1<=d&&0<=a);break}}}finally{QC=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?W0(e):""}function MQ(e){switch(e.tag){case 5:return W0(e.type);case 16:return W0("Lazy");case 13:return W0("Suspense");case 19:return W0("SuspenseList");case 0:case 2:case 15:return e=JC(e.type,!1),e;case 11:return e=JC(e.type.render,!1),e;case 1:return e=JC(e.type,!0),e;default:return""}}function Ok(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Bx:return"Fragment";case $x:return"Portal";case Tk:return"Profiler";case sO:return"StrictMode";case Ek:return"Suspense";case Mk:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case IB:return(e.displayName||"Context")+".Consumer";case OB:return(e._context.displayName||"Context")+".Provider";case iO:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case aO:return r=e.displayName||null,r!==null?r:Ok(e.type)||"Memo";case jh:r=e._payload,e=e._init;try{return Ok(e(r))}catch{}}return null}function OQ(e){var r=e.type;switch(e.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=r.render,e=e.displayName||e.name||"",r.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ok(r);case 8:return r===sO?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function am(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function RB(e){var r=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function IQ(e){var r=RB(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,r),s=""+e[r];if(!e.hasOwnProperty(r)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,l=n.set;return Object.defineProperty(e,r,{configurable:!0,get:function(){return i.call(this)},set:function(d){s=""+d,l.call(this,d)}}),Object.defineProperty(e,r,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(d){s=""+d},stopTracking:function(){e._valueTracker=null,delete e[r]}}}}function zw(e){e._valueTracker||(e._valueTracker=IQ(e))}function LB(e){if(!e)return!1;var r=e._valueTracker;if(!r)return!0;var n=r.getValue(),s="";return e&&(s=RB(e)?e.checked?"true":"false":e.value),e=s,e!==n?(r.setValue(e),!0):!1}function K1(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ik(e,r){var n=r.checked;return ci({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function UR(e,r){var n=r.defaultValue==null?"":r.defaultValue,s=r.checked!=null?r.checked:r.defaultChecked;n=am(r.value!=null?r.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function FB(e,r){r=r.checked,r!=null&&nO(e,"checked",r,!1)}function Dk(e,r){FB(e,r);var n=am(r.value),s=r.type;if(n!=null)s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}r.hasOwnProperty("value")?Rk(e,r.type,n):r.hasOwnProperty("defaultValue")&&Rk(e,r.type,am(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(e.defaultChecked=!!r.defaultChecked)}function WR(e,r,n){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var s=r.type;if(!(s!=="submit"&&s!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+e._wrapperState.initialValue,n||r===e.value||(e.value=r),e.defaultValue=r}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Rk(e,r,n){(r!=="number"||K1(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var G0=Array.isArray;function sg(e,r,n,s){if(e=e.options,r){r={};for(var i=0;i<n.length;i++)r["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=r.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&s&&(e[n].defaultSelected=!0)}else{for(n=""+am(n),r=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,s&&(e[i].defaultSelected=!0);return}r!==null||e[i].disabled||(r=e[i])}r!==null&&(r.selected=!0)}}function Lk(e,r){if(r.dangerouslySetInnerHTML!=null)throw Error(Zt(91));return ci({},r,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function GR(e,r){var n=r.value;if(n==null){if(n=r.children,r=r.defaultValue,n!=null){if(r!=null)throw Error(Zt(92));if(G0(n)){if(1<n.length)throw Error(Zt(93));n=n[0]}r=n}r==null&&(r=""),n=r}e._wrapperState={initialValue:am(n)}}function zB(e,r){var n=am(r.value),s=am(r.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),r.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),s!=null&&(e.defaultValue=""+s)}function KR(e){var r=e.textContent;r===e._wrapperState.initialValue&&r!==""&&r!==null&&(e.value=r)}function $B(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fk(e,r){return e==null||e==="http://www.w3.org/1999/xhtml"?$B(r):e==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var $w,BB=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,n,s,i){MSApp.execUnsafeLocalFunction(function(){return e(r,n,s,i)})}:e}(function(e,r){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=r;else{for($w=$w||document.createElement("div"),$w.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=$w.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;r.firstChild;)e.appendChild(r.firstChild)}});function v_(e,r){if(r){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=r;return}}e.textContent=r}var r_={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},DQ=["Webkit","ms","Moz","O"];Object.keys(r_).forEach(function(e){DQ.forEach(function(r){r=r+e.charAt(0).toUpperCase()+e.substring(1),r_[r]=r_[e]})});function qB(e,r,n){return r==null||typeof r=="boolean"||r===""?"":n||typeof r!="number"||r===0||r_.hasOwnProperty(e)&&r_[e]?(""+r).trim():r+"px"}function VB(e,r){e=e.style;for(var n in r)if(r.hasOwnProperty(n)){var s=n.indexOf("--")===0,i=qB(n,r[n],s);n==="float"&&(n="cssFloat"),s?e.setProperty(n,i):e[n]=i}}var RQ=ci({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zk(e,r){if(r){if(RQ[e]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(Zt(137,e));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(Zt(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(Zt(61))}if(r.style!=null&&typeof r.style!="object")throw Error(Zt(62))}}function $k(e,r){if(e.indexOf("-")===-1)return typeof r.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bk=null;function oO(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var qk=null,ig=null,ag=null;function HR(e){if(e=Vb(e)){if(typeof qk!="function")throw Error(Zt(280));var r=e.stateNode;r&&(r=t2(r),qk(e.stateNode,e.type,r))}}function UB(e){ig?ag?ag.push(e):ag=[e]:ig=e}function WB(){if(ig){var e=ig,r=ag;if(ag=ig=null,HR(e),r)for(e=0;e<r.length;e++)HR(r[e])}}function GB(e,r){return e(r)}function KB(){}var eA=!1;function HB(e,r,n){if(eA)return e(r,n);eA=!0;try{return GB(e,r,n)}finally{eA=!1,(ig!==null||ag!==null)&&(KB(),WB())}}function __(e,r){var n=e.stateNode;if(n===null)return null;var s=t2(n);if(s===null)return null;n=s[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Zt(231,r,typeof n));return n}var Vk=!1;if(fu)try{var y0={};Object.defineProperty(y0,"passive",{get:function(){Vk=!0}}),window.addEventListener("test",y0,y0),window.removeEventListener("test",y0,y0)}catch{Vk=!1}function LQ(e,r,n,s,i,l,d,a,f){var p=Array.prototype.slice.call(arguments,3);try{r.apply(n,p)}catch(y){this.onError(y)}}var n_=!1,H1=null,Z1=!1,Uk=null,FQ={onError:function(e){n_=!0,H1=e}};function zQ(e,r,n,s,i,l,d,a,f){n_=!1,H1=null,LQ.apply(FQ,arguments)}function $Q(e,r,n,s,i,l,d,a,f){if(zQ.apply(this,arguments),n_){if(n_){var p=H1;n_=!1,H1=null}else throw Error(Zt(198));Z1||(Z1=!0,Uk=p)}}function hp(e){var r=e,n=e;if(e.alternate)for(;r.return;)r=r.return;else{e=r;do r=e,r.flags&4098&&(n=r.return),e=r.return;while(e)}return r.tag===3?n:null}function ZB(e){if(e.tag===13){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function ZR(e){if(hp(e)!==e)throw Error(Zt(188))}function BQ(e){var r=e.alternate;if(!r){if(r=hp(e),r===null)throw Error(Zt(188));return r!==e?null:e}for(var n=e,s=r;;){var i=n.return;if(i===null)break;var l=i.alternate;if(l===null){if(s=i.return,s!==null){n=s;continue}break}if(i.child===l.child){for(l=i.child;l;){if(l===n)return ZR(i),e;if(l===s)return ZR(i),r;l=l.sibling}throw Error(Zt(188))}if(n.return!==s.return)n=i,s=l;else{for(var d=!1,a=i.child;a;){if(a===n){d=!0,n=i,s=l;break}if(a===s){d=!0,s=i,n=l;break}a=a.sibling}if(!d){for(a=l.child;a;){if(a===n){d=!0,n=l,s=i;break}if(a===s){d=!0,s=l,n=i;break}a=a.sibling}if(!d)throw Error(Zt(189))}}if(n.alternate!==s)throw Error(Zt(190))}if(n.tag!==3)throw Error(Zt(188));return n.stateNode.current===n?e:r}function YB(e){return e=BQ(e),e!==null?XB(e):null}function XB(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var r=XB(e);if(r!==null)return r;e=e.sibling}return null}var QB=ol.unstable_scheduleCallback,YR=ol.unstable_cancelCallback,qQ=ol.unstable_shouldYield,VQ=ol.unstable_requestPaint,Ni=ol.unstable_now,UQ=ol.unstable_getCurrentPriorityLevel,lO=ol.unstable_ImmediatePriority,JB=ol.unstable_UserBlockingPriority,Y1=ol.unstable_NormalPriority,WQ=ol.unstable_LowPriority,e8=ol.unstable_IdlePriority,XS=null,td=null;function GQ(e){if(td&&typeof td.onCommitFiberRoot=="function")try{td.onCommitFiberRoot(XS,e,void 0,(e.current.flags&128)===128)}catch{}}var wc=Math.clz32?Math.clz32:ZQ,KQ=Math.log,HQ=Math.LN2;function ZQ(e){return e>>>=0,e===0?32:31-(KQ(e)/HQ|0)|0}var Bw=64,qw=4194304;function K0(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function X1(e,r){var n=e.pendingLanes;if(n===0)return 0;var s=0,i=e.suspendedLanes,l=e.pingedLanes,d=n&268435455;if(d!==0){var a=d&~i;a!==0?s=K0(a):(l&=d,l!==0&&(s=K0(l)))}else d=n&~i,d!==0?s=K0(d):l!==0&&(s=K0(l));if(s===0)return 0;if(r!==0&&r!==s&&!(r&i)&&(i=s&-s,l=r&-r,i>=l||i===16&&(l&4194240)!==0))return r;if(s&4&&(s|=n&16),r=e.entangledLanes,r!==0)for(e=e.entanglements,r&=s;0<r;)n=31-wc(r),i=1<<n,s|=e[n],r&=~i;return s}function YQ(e,r){switch(e){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function XQ(e,r){for(var n=e.suspendedLanes,s=e.pingedLanes,i=e.expirationTimes,l=e.pendingLanes;0<l;){var d=31-wc(l),a=1<<d,f=i[d];f===-1?(!(a&n)||a&s)&&(i[d]=YQ(a,r)):f<=r&&(e.expiredLanes|=a),l&=~a}}function Wk(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function t8(){var e=Bw;return Bw<<=1,!(Bw&4194240)&&(Bw=64),e}function tA(e){for(var r=[],n=0;31>n;n++)r.push(e);return r}function Bb(e,r,n){e.pendingLanes|=r,r!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,r=31-wc(r),e[r]=n}function QQ(e,r){var n=e.pendingLanes&~r;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=r,e.mutableReadLanes&=r,e.entangledLanes&=r,r=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-wc(n),l=1<<i;r[i]=0,s[i]=-1,e[i]=-1,n&=~l}}function cO(e,r){var n=e.entangledLanes|=r;for(e=e.entanglements;n;){var s=31-wc(n),i=1<<s;i&r|e[s]&r&&(e[s]|=r),n&=~i}}var rs=0;function r8(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var n8,dO,s8,i8,a8,Gk=!1,Vw=[],Gh=null,Kh=null,Hh=null,b_=new Map,j_=new Map,Ph=[],JQ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function XR(e,r){switch(e){case"focusin":case"focusout":Gh=null;break;case"dragenter":case"dragleave":Kh=null;break;case"mouseover":case"mouseout":Hh=null;break;case"pointerover":case"pointerout":b_.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":j_.delete(r.pointerId)}}function v0(e,r,n,s,i,l){return e===null||e.nativeEvent!==l?(e={blockedOn:r,domEventName:n,eventSystemFlags:s,nativeEvent:l,targetContainers:[i]},r!==null&&(r=Vb(r),r!==null&&dO(r)),e):(e.eventSystemFlags|=s,r=e.targetContainers,i!==null&&r.indexOf(i)===-1&&r.push(i),e)}function eJ(e,r,n,s,i){switch(r){case"focusin":return Gh=v0(Gh,e,r,n,s,i),!0;case"dragenter":return Kh=v0(Kh,e,r,n,s,i),!0;case"mouseover":return Hh=v0(Hh,e,r,n,s,i),!0;case"pointerover":var l=i.pointerId;return b_.set(l,v0(b_.get(l)||null,e,r,n,s,i)),!0;case"gotpointercapture":return l=i.pointerId,j_.set(l,v0(j_.get(l)||null,e,r,n,s,i)),!0}return!1}function o8(e){var r=Nf(e.target);if(r!==null){var n=hp(r);if(n!==null){if(r=n.tag,r===13){if(r=ZB(n),r!==null){e.blockedOn=r,a8(e.priority,function(){s8(n)});return}}else if(r===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function T1(e){if(e.blockedOn!==null)return!1;for(var r=e.targetContainers;0<r.length;){var n=Kk(e.domEventName,e.eventSystemFlags,r[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);Bk=s,n.target.dispatchEvent(s),Bk=null}else return r=Vb(n),r!==null&&dO(r),e.blockedOn=n,!1;r.shift()}return!0}function QR(e,r,n){T1(e)&&n.delete(r)}function tJ(){Gk=!1,Gh!==null&&T1(Gh)&&(Gh=null),Kh!==null&&T1(Kh)&&(Kh=null),Hh!==null&&T1(Hh)&&(Hh=null),b_.forEach(QR),j_.forEach(QR)}function _0(e,r){e.blockedOn===r&&(e.blockedOn=null,Gk||(Gk=!0,ol.unstable_scheduleCallback(ol.unstable_NormalPriority,tJ)))}function w_(e){function r(i){return _0(i,e)}if(0<Vw.length){_0(Vw[0],e);for(var n=1;n<Vw.length;n++){var s=Vw[n];s.blockedOn===e&&(s.blockedOn=null)}}for(Gh!==null&&_0(Gh,e),Kh!==null&&_0(Kh,e),Hh!==null&&_0(Hh,e),b_.forEach(r),j_.forEach(r),n=0;n<Ph.length;n++)s=Ph[n],s.blockedOn===e&&(s.blockedOn=null);for(;0<Ph.length&&(n=Ph[0],n.blockedOn===null);)o8(n),n.blockedOn===null&&Ph.shift()}var og=Tu.ReactCurrentBatchConfig,Q1=!0;function rJ(e,r,n,s){var i=rs,l=og.transition;og.transition=null;try{rs=1,uO(e,r,n,s)}finally{rs=i,og.transition=l}}function nJ(e,r,n,s){var i=rs,l=og.transition;og.transition=null;try{rs=4,uO(e,r,n,s)}finally{rs=i,og.transition=l}}function uO(e,r,n,s){if(Q1){var i=Kk(e,r,n,s);if(i===null)uA(e,r,s,J1,n),XR(e,s);else if(eJ(i,e,r,n,s))s.stopPropagation();else if(XR(e,s),r&4&&-1<JQ.indexOf(e)){for(;i!==null;){var l=Vb(i);if(l!==null&&n8(l),l=Kk(e,r,n,s),l===null&&uA(e,r,s,J1,n),l===i)break;i=l}i!==null&&s.stopPropagation()}else uA(e,r,s,null,n)}}var J1=null;function Kk(e,r,n,s){if(J1=null,e=oO(s),e=Nf(e),e!==null)if(r=hp(e),r===null)e=null;else if(n=r.tag,n===13){if(e=ZB(r),e!==null)return e;e=null}else if(n===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;e=null}else r!==e&&(e=null);return J1=e,null}function l8(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(UQ()){case lO:return 1;case JB:return 4;case Y1:case WQ:return 16;case e8:return 536870912;default:return 16}default:return 16}}var zh=null,hO=null,E1=null;function c8(){if(E1)return E1;var e,r=hO,n=r.length,s,i="value"in zh?zh.value:zh.textContent,l=i.length;for(e=0;e<n&&r[e]===i[e];e++);var d=n-e;for(s=1;s<=d&&r[n-s]===i[l-s];s++);return E1=i.slice(e,1<s?1-s:void 0)}function M1(e){var r=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&r===13&&(e=13)):e=r,e===10&&(e=13),32<=e||e===13?e:0}function Uw(){return!0}function JR(){return!1}function dl(e){function r(n,s,i,l,d){this._reactName=n,this._targetInst=i,this.type=s,this.nativeEvent=l,this.target=d,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(l):l[a]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?Uw:JR,this.isPropagationStopped=JR,this}return ci(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Uw)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Uw)},persist:function(){},isPersistent:Uw}),r}var Py={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},mO=dl(Py),qb=ci({},Py,{view:0,detail:0}),sJ=dl(qb),rA,nA,b0,QS=ci({},qb,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fO,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==b0&&(b0&&e.type==="mousemove"?(rA=e.screenX-b0.screenX,nA=e.screenY-b0.screenY):nA=rA=0,b0=e),rA)},movementY:function(e){return"movementY"in e?e.movementY:nA}}),e3=dl(QS),iJ=ci({},QS,{dataTransfer:0}),aJ=dl(iJ),oJ=ci({},qb,{relatedTarget:0}),sA=dl(oJ),lJ=ci({},Py,{animationName:0,elapsedTime:0,pseudoElement:0}),cJ=dl(lJ),dJ=ci({},Py,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),uJ=dl(dJ),hJ=ci({},Py,{data:0}),t3=dl(hJ),mJ={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fJ={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pJ={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xJ(e){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(e):(e=pJ[e])?!!r[e]:!1}function fO(){return xJ}var gJ=ci({},qb,{key:function(e){if(e.key){var r=mJ[e.key]||e.key;if(r!=="Unidentified")return r}return e.type==="keypress"?(e=M1(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?fJ[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fO,charCode:function(e){return e.type==="keypress"?M1(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?M1(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),yJ=dl(gJ),vJ=ci({},QS,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),r3=dl(vJ),_J=ci({},qb,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fO}),bJ=dl(_J),jJ=ci({},Py,{propertyName:0,elapsedTime:0,pseudoElement:0}),wJ=dl(jJ),NJ=ci({},QS,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),SJ=dl(NJ),PJ=[9,13,27,32],pO=fu&&"CompositionEvent"in window,s_=null;fu&&"documentMode"in document&&(s_=document.documentMode);var CJ=fu&&"TextEvent"in window&&!s_,d8=fu&&(!pO||s_&&8<s_&&11>=s_),n3=" ",s3=!1;function u8(e,r){switch(e){case"keyup":return PJ.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function h8(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var qx=!1;function AJ(e,r){switch(e){case"compositionend":return h8(r);case"keypress":return r.which!==32?null:(s3=!0,n3);case"textInput":return e=r.data,e===n3&&s3?null:e;default:return null}}function kJ(e,r){if(qx)return e==="compositionend"||!pO&&u8(e,r)?(e=c8(),E1=hO=zh=null,qx=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return d8&&r.locale!=="ko"?null:r.data;default:return null}}var TJ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function i3(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r==="input"?!!TJ[e.type]:r==="textarea"}function m8(e,r,n,s){UB(s),r=eN(r,"onChange"),0<r.length&&(n=new mO("onChange","change",null,n,s),e.push({event:n,listeners:r}))}var i_=null,N_=null;function EJ(e){N8(e,0)}function JS(e){var r=Wx(e);if(LB(r))return e}function MJ(e,r){if(e==="change")return r}var f8=!1;if(fu){var iA;if(fu){var aA="oninput"in document;if(!aA){var a3=document.createElement("div");a3.setAttribute("oninput","return;"),aA=typeof a3.oninput=="function"}iA=aA}else iA=!1;f8=iA&&(!document.documentMode||9<document.documentMode)}function o3(){i_&&(i_.detachEvent("onpropertychange",p8),N_=i_=null)}function p8(e){if(e.propertyName==="value"&&JS(N_)){var r=[];m8(r,N_,e,oO(e)),HB(EJ,r)}}function OJ(e,r,n){e==="focusin"?(o3(),i_=r,N_=n,i_.attachEvent("onpropertychange",p8)):e==="focusout"&&o3()}function IJ(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return JS(N_)}function DJ(e,r){if(e==="click")return JS(r)}function RJ(e,r){if(e==="input"||e==="change")return JS(r)}function LJ(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var Ac=typeof Object.is=="function"?Object.is:LJ;function S_(e,r){if(Ac(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;var n=Object.keys(e),s=Object.keys(r);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var i=n[s];if(!kk.call(r,i)||!Ac(e[i],r[i]))return!1}return!0}function l3(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function c3(e,r){var n=l3(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=r&&s>=r)return{node:n,offset:r-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=l3(n)}}function x8(e,r){return e&&r?e===r?!0:e&&e.nodeType===3?!1:r&&r.nodeType===3?x8(e,r.parentNode):"contains"in e?e.contains(r):e.compareDocumentPosition?!!(e.compareDocumentPosition(r)&16):!1:!1}function g8(){for(var e=window,r=K1();r instanceof e.HTMLIFrameElement;){try{var n=typeof r.contentWindow.location.href=="string"}catch{n=!1}if(n)e=r.contentWindow;else break;r=K1(e.document)}return r}function xO(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r&&(r==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||r==="textarea"||e.contentEditable==="true")}function FJ(e){var r=g8(),n=e.focusedElem,s=e.selectionRange;if(r!==n&&n&&n.ownerDocument&&x8(n.ownerDocument.documentElement,n)){if(s!==null&&xO(n)){if(r=s.start,e=s.end,e===void 0&&(e=r),"selectionStart"in n)n.selectionStart=r,n.selectionEnd=Math.min(e,n.value.length);else if(e=(r=n.ownerDocument||document)&&r.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,l=Math.min(s.start,i);s=s.end===void 0?l:Math.min(s.end,i),!e.extend&&l>s&&(i=s,s=l,l=i),i=c3(n,l);var d=c3(n,s);i&&d&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==d.node||e.focusOffset!==d.offset)&&(r=r.createRange(),r.setStart(i.node,i.offset),e.removeAllRanges(),l>s?(e.addRange(r),e.extend(d.node,d.offset)):(r.setEnd(d.node,d.offset),e.addRange(r)))}}for(r=[],e=n;e=e.parentNode;)e.nodeType===1&&r.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<r.length;n++)e=r[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var zJ=fu&&"documentMode"in document&&11>=document.documentMode,Vx=null,Hk=null,a_=null,Zk=!1;function d3(e,r,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Zk||Vx==null||Vx!==K1(s)||(s=Vx,"selectionStart"in s&&xO(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),a_&&S_(a_,s)||(a_=s,s=eN(Hk,"onSelect"),0<s.length&&(r=new mO("onSelect","select",null,r,n),e.push({event:r,listeners:s}),r.target=Vx)))}function Ww(e,r){var n={};return n[e.toLowerCase()]=r.toLowerCase(),n["Webkit"+e]="webkit"+r,n["Moz"+e]="moz"+r,n}var Ux={animationend:Ww("Animation","AnimationEnd"),animationiteration:Ww("Animation","AnimationIteration"),animationstart:Ww("Animation","AnimationStart"),transitionend:Ww("Transition","TransitionEnd")},oA={},y8={};fu&&(y8=document.createElement("div").style,"AnimationEvent"in window||(delete Ux.animationend.animation,delete Ux.animationiteration.animation,delete Ux.animationstart.animation),"TransitionEvent"in window||delete Ux.transitionend.transition);function e2(e){if(oA[e])return oA[e];if(!Ux[e])return e;var r=Ux[e],n;for(n in r)if(r.hasOwnProperty(n)&&n in y8)return oA[e]=r[n];return e}var v8=e2("animationend"),_8=e2("animationiteration"),b8=e2("animationstart"),j8=e2("transitionend"),w8=new Map,u3="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function gm(e,r){w8.set(e,r),up(r,[e])}for(var lA=0;lA<u3.length;lA++){var cA=u3[lA],$J=cA.toLowerCase(),BJ=cA[0].toUpperCase()+cA.slice(1);gm($J,"on"+BJ)}gm(v8,"onAnimationEnd");gm(_8,"onAnimationIteration");gm(b8,"onAnimationStart");gm("dblclick","onDoubleClick");gm("focusin","onFocus");gm("focusout","onBlur");gm(j8,"onTransitionEnd");Ig("onMouseEnter",["mouseout","mouseover"]);Ig("onMouseLeave",["mouseout","mouseover"]);Ig("onPointerEnter",["pointerout","pointerover"]);Ig("onPointerLeave",["pointerout","pointerover"]);up("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));up("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));up("onBeforeInput",["compositionend","keypress","textInput","paste"]);up("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));up("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));up("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var H0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qJ=new Set("cancel close invalid load scroll toggle".split(" ").concat(H0));function h3(e,r,n){var s=e.type||"unknown-event";e.currentTarget=n,$Q(s,r,void 0,e),e.currentTarget=null}function N8(e,r){r=(r&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],i=s.event;s=s.listeners;e:{var l=void 0;if(r)for(var d=s.length-1;0<=d;d--){var a=s[d],f=a.instance,p=a.currentTarget;if(a=a.listener,f!==l&&i.isPropagationStopped())break e;h3(i,a,p),l=f}else for(d=0;d<s.length;d++){if(a=s[d],f=a.instance,p=a.currentTarget,a=a.listener,f!==l&&i.isPropagationStopped())break e;h3(i,a,p),l=f}}}if(Z1)throw e=Uk,Z1=!1,Uk=null,e}function Ms(e,r){var n=r[eT];n===void 0&&(n=r[eT]=new Set);var s=e+"__bubble";n.has(s)||(S8(r,e,2,!1),n.add(s))}function dA(e,r,n){var s=0;r&&(s|=4),S8(n,e,s,r)}var Gw="_reactListening"+Math.random().toString(36).slice(2);function P_(e){if(!e[Gw]){e[Gw]=!0,MB.forEach(function(n){n!=="selectionchange"&&(qJ.has(n)||dA(n,!1,e),dA(n,!0,e))});var r=e.nodeType===9?e:e.ownerDocument;r===null||r[Gw]||(r[Gw]=!0,dA("selectionchange",!1,r))}}function S8(e,r,n,s){switch(l8(r)){case 1:var i=rJ;break;case 4:i=nJ;break;default:i=uO}n=i.bind(null,r,n,e),i=void 0,!Vk||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(i=!0),s?i!==void 0?e.addEventListener(r,n,{capture:!0,passive:i}):e.addEventListener(r,n,!0):i!==void 0?e.addEventListener(r,n,{passive:i}):e.addEventListener(r,n,!1)}function uA(e,r,n,s,i){var l=s;if(!(r&1)&&!(r&2)&&s!==null)e:for(;;){if(s===null)return;var d=s.tag;if(d===3||d===4){var a=s.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(d===4)for(d=s.return;d!==null;){var f=d.tag;if((f===3||f===4)&&(f=d.stateNode.containerInfo,f===i||f.nodeType===8&&f.parentNode===i))return;d=d.return}for(;a!==null;){if(d=Nf(a),d===null)return;if(f=d.tag,f===5||f===6){s=l=d;continue e}a=a.parentNode}}s=s.return}HB(function(){var p=l,y=oO(n),v=[];e:{var j=w8.get(e);if(j!==void 0){var w=mO,k=e;switch(e){case"keypress":if(M1(n)===0)break e;case"keydown":case"keyup":w=yJ;break;case"focusin":k="focus",w=sA;break;case"focusout":k="blur",w=sA;break;case"beforeblur":case"afterblur":w=sA;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=e3;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=aJ;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=bJ;break;case v8:case _8:case b8:w=cJ;break;case j8:w=wJ;break;case"scroll":w=sJ;break;case"wheel":w=SJ;break;case"copy":case"cut":case"paste":w=uJ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=r3}var S=(r&4)!==0,R=!S&&e==="scroll",D=S?j!==null?j+"Capture":null:j;S=[];for(var T=p,I;T!==null;){I=T;var L=I.stateNode;if(I.tag===5&&L!==null&&(I=L,D!==null&&(L=__(T,D),L!=null&&S.push(C_(T,L,I)))),R)break;T=T.return}0<S.length&&(j=new w(j,k,null,n,y),v.push({event:j,listeners:S}))}}if(!(r&7)){e:{if(j=e==="mouseover"||e==="pointerover",w=e==="mouseout"||e==="pointerout",j&&n!==Bk&&(k=n.relatedTarget||n.fromElement)&&(Nf(k)||k[pu]))break e;if((w||j)&&(j=y.window===y?y:(j=y.ownerDocument)?j.defaultView||j.parentWindow:window,w?(k=n.relatedTarget||n.toElement,w=p,k=k?Nf(k):null,k!==null&&(R=hp(k),k!==R||k.tag!==5&&k.tag!==6)&&(k=null)):(w=null,k=p),w!==k)){if(S=e3,L="onMouseLeave",D="onMouseEnter",T="mouse",(e==="pointerout"||e==="pointerover")&&(S=r3,L="onPointerLeave",D="onPointerEnter",T="pointer"),R=w==null?j:Wx(w),I=k==null?j:Wx(k),j=new S(L,T+"leave",w,n,y),j.target=R,j.relatedTarget=I,L=null,Nf(y)===p&&(S=new S(D,T+"enter",k,n,y),S.target=I,S.relatedTarget=R,L=S),R=L,w&&k)t:{for(S=w,D=k,T=0,I=S;I;I=Px(I))T++;for(I=0,L=D;L;L=Px(L))I++;for(;0<T-I;)S=Px(S),T--;for(;0<I-T;)D=Px(D),I--;for(;T--;){if(S===D||D!==null&&S===D.alternate)break t;S=Px(S),D=Px(D)}S=null}else S=null;w!==null&&m3(v,j,w,S,!1),k!==null&&R!==null&&m3(v,R,k,S,!0)}}e:{if(j=p?Wx(p):window,w=j.nodeName&&j.nodeName.toLowerCase(),w==="select"||w==="input"&&j.type==="file")var $=MJ;else if(i3(j))if(f8)$=RJ;else{$=IJ;var W=OJ}else(w=j.nodeName)&&w.toLowerCase()==="input"&&(j.type==="checkbox"||j.type==="radio")&&($=DJ);if($&&($=$(e,p))){m8(v,$,n,y);break e}W&&W(e,j,p),e==="focusout"&&(W=j._wrapperState)&&W.controlled&&j.type==="number"&&Rk(j,"number",j.value)}switch(W=p?Wx(p):window,e){case"focusin":(i3(W)||W.contentEditable==="true")&&(Vx=W,Hk=p,a_=null);break;case"focusout":a_=Hk=Vx=null;break;case"mousedown":Zk=!0;break;case"contextmenu":case"mouseup":case"dragend":Zk=!1,d3(v,n,y);break;case"selectionchange":if(zJ)break;case"keydown":case"keyup":d3(v,n,y)}var Z;if(pO)e:{switch(e){case"compositionstart":var oe="onCompositionStart";break e;case"compositionend":oe="onCompositionEnd";break e;case"compositionupdate":oe="onCompositionUpdate";break e}oe=void 0}else qx?u8(e,n)&&(oe="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(oe="onCompositionStart");oe&&(d8&&n.locale!=="ko"&&(qx||oe!=="onCompositionStart"?oe==="onCompositionEnd"&&qx&&(Z=c8()):(zh=y,hO="value"in zh?zh.value:zh.textContent,qx=!0)),W=eN(p,oe),0<W.length&&(oe=new t3(oe,e,null,n,y),v.push({event:oe,listeners:W}),Z?oe.data=Z:(Z=h8(n),Z!==null&&(oe.data=Z)))),(Z=CJ?AJ(e,n):kJ(e,n))&&(p=eN(p,"onBeforeInput"),0<p.length&&(y=new t3("onBeforeInput","beforeinput",null,n,y),v.push({event:y,listeners:p}),y.data=Z))}N8(v,r)})}function C_(e,r,n){return{instance:e,listener:r,currentTarget:n}}function eN(e,r){for(var n=r+"Capture",s=[];e!==null;){var i=e,l=i.stateNode;i.tag===5&&l!==null&&(i=l,l=__(e,n),l!=null&&s.unshift(C_(e,l,i)),l=__(e,r),l!=null&&s.push(C_(e,l,i))),e=e.return}return s}function Px(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function m3(e,r,n,s,i){for(var l=r._reactName,d=[];n!==null&&n!==s;){var a=n,f=a.alternate,p=a.stateNode;if(f!==null&&f===s)break;a.tag===5&&p!==null&&(a=p,i?(f=__(n,l),f!=null&&d.unshift(C_(n,f,a))):i||(f=__(n,l),f!=null&&d.push(C_(n,f,a)))),n=n.return}d.length!==0&&e.push({event:r,listeners:d})}var VJ=/\r\n?/g,UJ=/\u0000|\uFFFD/g;function f3(e){return(typeof e=="string"?e:""+e).replace(VJ,`
`).replace(UJ,"")}function Kw(e,r,n){if(r=f3(r),f3(e)!==r&&n)throw Error(Zt(425))}function tN(){}var Yk=null,Xk=null;function Qk(e,r){return e==="textarea"||e==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Jk=typeof setTimeout=="function"?setTimeout:void 0,WJ=typeof clearTimeout=="function"?clearTimeout:void 0,p3=typeof Promise=="function"?Promise:void 0,GJ=typeof queueMicrotask=="function"?queueMicrotask:typeof p3<"u"?function(e){return p3.resolve(null).then(e).catch(KJ)}:Jk;function KJ(e){setTimeout(function(){throw e})}function hA(e,r){var n=r,s=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(s===0){e.removeChild(i),w_(r);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=i}while(n);w_(r)}function Zh(e){for(;e!=null;e=e.nextSibling){var r=e.nodeType;if(r===1||r===3)break;if(r===8){if(r=e.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return e}function x3(e){e=e.previousSibling;for(var r=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(r===0)return e;r--}else n==="/$"&&r++}e=e.previousSibling}return null}var Cy=Math.random().toString(36).slice(2),Yc="__reactFiber$"+Cy,A_="__reactProps$"+Cy,pu="__reactContainer$"+Cy,eT="__reactEvents$"+Cy,HJ="__reactListeners$"+Cy,ZJ="__reactHandles$"+Cy;function Nf(e){var r=e[Yc];if(r)return r;for(var n=e.parentNode;n;){if(r=n[pu]||n[Yc]){if(n=r.alternate,r.child!==null||n!==null&&n.child!==null)for(e=x3(e);e!==null;){if(n=e[Yc])return n;e=x3(e)}return r}e=n,n=e.parentNode}return null}function Vb(e){return e=e[Yc]||e[pu],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Wx(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Zt(33))}function t2(e){return e[A_]||null}var tT=[],Gx=-1;function ym(e){return{current:e}}function Ls(e){0>Gx||(e.current=tT[Gx],tT[Gx]=null,Gx--)}function Ps(e,r){Gx++,tT[Gx]=e.current,e.current=r}var om={},Ya=ym(om),To=ym(!1),Wf=om;function Dg(e,r){var n=e.type.contextTypes;if(!n)return om;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===r)return s.__reactInternalMemoizedMaskedChildContext;var i={},l;for(l in n)i[l]=r[l];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=i),i}function Eo(e){return e=e.childContextTypes,e!=null}function rN(){Ls(To),Ls(Ya)}function g3(e,r,n){if(Ya.current!==om)throw Error(Zt(168));Ps(Ya,r),Ps(To,n)}function P8(e,r,n){var s=e.stateNode;if(r=r.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var i in s)if(!(i in r))throw Error(Zt(108,OQ(e)||"Unknown",i));return ci({},n,s)}function nN(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||om,Wf=Ya.current,Ps(Ya,e),Ps(To,To.current),!0}function y3(e,r,n){var s=e.stateNode;if(!s)throw Error(Zt(169));n?(e=P8(e,r,Wf),s.__reactInternalMemoizedMergedChildContext=e,Ls(To),Ls(Ya),Ps(Ya,e)):Ls(To),Ps(To,n)}var eu=null,r2=!1,mA=!1;function C8(e){eu===null?eu=[e]:eu.push(e)}function YJ(e){r2=!0,C8(e)}function vm(){if(!mA&&eu!==null){mA=!0;var e=0,r=rs;try{var n=eu;for(rs=1;e<n.length;e++){var s=n[e];do s=s(!0);while(s!==null)}eu=null,r2=!1}catch(i){throw eu!==null&&(eu=eu.slice(e+1)),QB(lO,vm),i}finally{rs=r,mA=!1}}return null}var Kx=[],Hx=0,sN=null,iN=0,wl=[],Nl=0,Gf=null,nu=1,su="";function gf(e,r){Kx[Hx++]=iN,Kx[Hx++]=sN,sN=e,iN=r}function A8(e,r,n){wl[Nl++]=nu,wl[Nl++]=su,wl[Nl++]=Gf,Gf=e;var s=nu;e=su;var i=32-wc(s)-1;s&=~(1<<i),n+=1;var l=32-wc(r)+i;if(30<l){var d=i-i%5;l=(s&(1<<d)-1).toString(32),s>>=d,i-=d,nu=1<<32-wc(r)+i|n<<i|s,su=l+e}else nu=1<<l|n<<i|s,su=e}function gO(e){e.return!==null&&(gf(e,1),A8(e,1,0))}function yO(e){for(;e===sN;)sN=Kx[--Hx],Kx[Hx]=null,iN=Kx[--Hx],Kx[Hx]=null;for(;e===Gf;)Gf=wl[--Nl],wl[Nl]=null,su=wl[--Nl],wl[Nl]=null,nu=wl[--Nl],wl[Nl]=null}var rl=null,tl=null,Ks=!1,pc=null;function k8(e,r){var n=Al(5,null,null,0);n.elementType="DELETED",n.stateNode=r,n.return=e,r=e.deletions,r===null?(e.deletions=[n],e.flags|=16):r.push(n)}function v3(e,r){switch(e.tag){case 5:var n=e.type;return r=r.nodeType!==1||n.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(e.stateNode=r,rl=e,tl=Zh(r.firstChild),!0):!1;case 6:return r=e.pendingProps===""||r.nodeType!==3?null:r,r!==null?(e.stateNode=r,rl=e,tl=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(n=Gf!==null?{id:nu,overflow:su}:null,e.memoizedState={dehydrated:r,treeContext:n,retryLane:1073741824},n=Al(18,null,null,0),n.stateNode=r,n.return=e,e.child=n,rl=e,tl=null,!0):!1;default:return!1}}function rT(e){return(e.mode&1)!==0&&(e.flags&128)===0}function nT(e){if(Ks){var r=tl;if(r){var n=r;if(!v3(e,r)){if(rT(e))throw Error(Zt(418));r=Zh(n.nextSibling);var s=rl;r&&v3(e,r)?k8(s,n):(e.flags=e.flags&-4097|2,Ks=!1,rl=e)}}else{if(rT(e))throw Error(Zt(418));e.flags=e.flags&-4097|2,Ks=!1,rl=e}}}function _3(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;rl=e}function Hw(e){if(e!==rl)return!1;if(!Ks)return _3(e),Ks=!0,!1;var r;if((r=e.tag!==3)&&!(r=e.tag!==5)&&(r=e.type,r=r!=="head"&&r!=="body"&&!Qk(e.type,e.memoizedProps)),r&&(r=tl)){if(rT(e))throw T8(),Error(Zt(418));for(;r;)k8(e,r),r=Zh(r.nextSibling)}if(_3(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Zt(317));e:{for(e=e.nextSibling,r=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(r===0){tl=Zh(e.nextSibling);break e}r--}else n!=="$"&&n!=="$!"&&n!=="$?"||r++}e=e.nextSibling}tl=null}}else tl=rl?Zh(e.stateNode.nextSibling):null;return!0}function T8(){for(var e=tl;e;)e=Zh(e.nextSibling)}function Rg(){tl=rl=null,Ks=!1}function vO(e){pc===null?pc=[e]:pc.push(e)}var XJ=Tu.ReactCurrentBatchConfig;function j0(e,r,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Zt(309));var s=n.stateNode}if(!s)throw Error(Zt(147,e));var i=s,l=""+e;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===l?r.ref:(r=function(d){var a=i.refs;d===null?delete a[l]:a[l]=d},r._stringRef=l,r)}if(typeof e!="string")throw Error(Zt(284));if(!n._owner)throw Error(Zt(290,e))}return e}function Zw(e,r){throw e=Object.prototype.toString.call(r),Error(Zt(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e))}function b3(e){var r=e._init;return r(e._payload)}function E8(e){function r(D,T){if(e){var I=D.deletions;I===null?(D.deletions=[T],D.flags|=16):I.push(T)}}function n(D,T){if(!e)return null;for(;T!==null;)r(D,T),T=T.sibling;return null}function s(D,T){for(D=new Map;T!==null;)T.key!==null?D.set(T.key,T):D.set(T.index,T),T=T.sibling;return D}function i(D,T){return D=Jh(D,T),D.index=0,D.sibling=null,D}function l(D,T,I){return D.index=I,e?(I=D.alternate,I!==null?(I=I.index,I<T?(D.flags|=2,T):I):(D.flags|=2,T)):(D.flags|=1048576,T)}function d(D){return e&&D.alternate===null&&(D.flags|=2),D}function a(D,T,I,L){return T===null||T.tag!==6?(T=_A(I,D.mode,L),T.return=D,T):(T=i(T,I),T.return=D,T)}function f(D,T,I,L){var $=I.type;return $===Bx?y(D,T,I.props.children,L,I.key):T!==null&&(T.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===jh&&b3($)===T.type)?(L=i(T,I.props),L.ref=j0(D,T,I),L.return=D,L):(L=z1(I.type,I.key,I.props,null,D.mode,L),L.ref=j0(D,T,I),L.return=D,L)}function p(D,T,I,L){return T===null||T.tag!==4||T.stateNode.containerInfo!==I.containerInfo||T.stateNode.implementation!==I.implementation?(T=bA(I,D.mode,L),T.return=D,T):(T=i(T,I.children||[]),T.return=D,T)}function y(D,T,I,L,$){return T===null||T.tag!==7?(T=Bf(I,D.mode,L,$),T.return=D,T):(T=i(T,I),T.return=D,T)}function v(D,T,I){if(typeof T=="string"&&T!==""||typeof T=="number")return T=_A(""+T,D.mode,I),T.return=D,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Fw:return I=z1(T.type,T.key,T.props,null,D.mode,I),I.ref=j0(D,null,T),I.return=D,I;case $x:return T=bA(T,D.mode,I),T.return=D,T;case jh:var L=T._init;return v(D,L(T._payload),I)}if(G0(T)||g0(T))return T=Bf(T,D.mode,I,null),T.return=D,T;Zw(D,T)}return null}function j(D,T,I,L){var $=T!==null?T.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return $!==null?null:a(D,T,""+I,L);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Fw:return I.key===$?f(D,T,I,L):null;case $x:return I.key===$?p(D,T,I,L):null;case jh:return $=I._init,j(D,T,$(I._payload),L)}if(G0(I)||g0(I))return $!==null?null:y(D,T,I,L,null);Zw(D,I)}return null}function w(D,T,I,L,$){if(typeof L=="string"&&L!==""||typeof L=="number")return D=D.get(I)||null,a(T,D,""+L,$);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case Fw:return D=D.get(L.key===null?I:L.key)||null,f(T,D,L,$);case $x:return D=D.get(L.key===null?I:L.key)||null,p(T,D,L,$);case jh:var W=L._init;return w(D,T,I,W(L._payload),$)}if(G0(L)||g0(L))return D=D.get(I)||null,y(T,D,L,$,null);Zw(T,L)}return null}function k(D,T,I,L){for(var $=null,W=null,Z=T,oe=T=0,te=null;Z!==null&&oe<I.length;oe++){Z.index>oe?(te=Z,Z=null):te=Z.sibling;var be=j(D,Z,I[oe],L);if(be===null){Z===null&&(Z=te);break}e&&Z&&be.alternate===null&&r(D,Z),T=l(be,T,oe),W===null?$=be:W.sibling=be,W=be,Z=te}if(oe===I.length)return n(D,Z),Ks&&gf(D,oe),$;if(Z===null){for(;oe<I.length;oe++)Z=v(D,I[oe],L),Z!==null&&(T=l(Z,T,oe),W===null?$=Z:W.sibling=Z,W=Z);return Ks&&gf(D,oe),$}for(Z=s(D,Z);oe<I.length;oe++)te=w(Z,D,oe,I[oe],L),te!==null&&(e&&te.alternate!==null&&Z.delete(te.key===null?oe:te.key),T=l(te,T,oe),W===null?$=te:W.sibling=te,W=te);return e&&Z.forEach(function(ie){return r(D,ie)}),Ks&&gf(D,oe),$}function S(D,T,I,L){var $=g0(I);if(typeof $!="function")throw Error(Zt(150));if(I=$.call(I),I==null)throw Error(Zt(151));for(var W=$=null,Z=T,oe=T=0,te=null,be=I.next();Z!==null&&!be.done;oe++,be=I.next()){Z.index>oe?(te=Z,Z=null):te=Z.sibling;var ie=j(D,Z,be.value,L);if(ie===null){Z===null&&(Z=te);break}e&&Z&&ie.alternate===null&&r(D,Z),T=l(ie,T,oe),W===null?$=ie:W.sibling=ie,W=ie,Z=te}if(be.done)return n(D,Z),Ks&&gf(D,oe),$;if(Z===null){for(;!be.done;oe++,be=I.next())be=v(D,be.value,L),be!==null&&(T=l(be,T,oe),W===null?$=be:W.sibling=be,W=be);return Ks&&gf(D,oe),$}for(Z=s(D,Z);!be.done;oe++,be=I.next())be=w(Z,D,oe,be.value,L),be!==null&&(e&&be.alternate!==null&&Z.delete(be.key===null?oe:be.key),T=l(be,T,oe),W===null?$=be:W.sibling=be,W=be);return e&&Z.forEach(function(ge){return r(D,ge)}),Ks&&gf(D,oe),$}function R(D,T,I,L){if(typeof I=="object"&&I!==null&&I.type===Bx&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case Fw:e:{for(var $=I.key,W=T;W!==null;){if(W.key===$){if($=I.type,$===Bx){if(W.tag===7){n(D,W.sibling),T=i(W,I.props.children),T.return=D,D=T;break e}}else if(W.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===jh&&b3($)===W.type){n(D,W.sibling),T=i(W,I.props),T.ref=j0(D,W,I),T.return=D,D=T;break e}n(D,W);break}else r(D,W);W=W.sibling}I.type===Bx?(T=Bf(I.props.children,D.mode,L,I.key),T.return=D,D=T):(L=z1(I.type,I.key,I.props,null,D.mode,L),L.ref=j0(D,T,I),L.return=D,D=L)}return d(D);case $x:e:{for(W=I.key;T!==null;){if(T.key===W)if(T.tag===4&&T.stateNode.containerInfo===I.containerInfo&&T.stateNode.implementation===I.implementation){n(D,T.sibling),T=i(T,I.children||[]),T.return=D,D=T;break e}else{n(D,T);break}else r(D,T);T=T.sibling}T=bA(I,D.mode,L),T.return=D,D=T}return d(D);case jh:return W=I._init,R(D,T,W(I._payload),L)}if(G0(I))return k(D,T,I,L);if(g0(I))return S(D,T,I,L);Zw(D,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,T!==null&&T.tag===6?(n(D,T.sibling),T=i(T,I),T.return=D,D=T):(n(D,T),T=_A(I,D.mode,L),T.return=D,D=T),d(D)):n(D,T)}return R}var Lg=E8(!0),M8=E8(!1),aN=ym(null),oN=null,Zx=null,_O=null;function bO(){_O=Zx=oN=null}function jO(e){var r=aN.current;Ls(aN),e._currentValue=r}function sT(e,r,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&r)!==r?(e.childLanes|=r,s!==null&&(s.childLanes|=r)):s!==null&&(s.childLanes&r)!==r&&(s.childLanes|=r),e===n)break;e=e.return}}function lg(e,r){oN=e,_O=Zx=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&r&&(Co=!0),e.firstContext=null)}function Ol(e){var r=e._currentValue;if(_O!==e)if(e={context:e,memoizedValue:r,next:null},Zx===null){if(oN===null)throw Error(Zt(308));Zx=e,oN.dependencies={lanes:0,firstContext:e}}else Zx=Zx.next=e;return r}var Sf=null;function wO(e){Sf===null?Sf=[e]:Sf.push(e)}function O8(e,r,n,s){var i=r.interleaved;return i===null?(n.next=n,wO(r)):(n.next=i.next,i.next=n),r.interleaved=n,xu(e,s)}function xu(e,r){e.lanes|=r;var n=e.alternate;for(n!==null&&(n.lanes|=r),n=e,e=e.return;e!==null;)e.childLanes|=r,n=e.alternate,n!==null&&(n.childLanes|=r),n=e,e=e.return;return n.tag===3?n.stateNode:null}var wh=!1;function NO(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function I8(e,r){e=e.updateQueue,r.updateQueue===e&&(r.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function cu(e,r){return{eventTime:e,lane:r,tag:0,payload:null,callback:null,next:null}}function Yh(e,r,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,Fn&2){var i=s.pending;return i===null?r.next=r:(r.next=i.next,i.next=r),s.pending=r,xu(e,n)}return i=s.interleaved,i===null?(r.next=r,wO(s)):(r.next=i.next,i.next=r),s.interleaved=r,xu(e,n)}function O1(e,r,n){if(r=r.updateQueue,r!==null&&(r=r.shared,(n&4194240)!==0)){var s=r.lanes;s&=e.pendingLanes,n|=s,r.lanes=n,cO(e,n)}}function j3(e,r){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var i=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var d={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?i=l=d:l=l.next=d,n=n.next}while(n!==null);l===null?i=l=r:l=l.next=r}else i=l=r;n={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:l,shared:s.shared,effects:s.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=r:e.next=r,n.lastBaseUpdate=r}function lN(e,r,n,s){var i=e.updateQueue;wh=!1;var l=i.firstBaseUpdate,d=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var f=a,p=f.next;f.next=null,d===null?l=p:d.next=p,d=f;var y=e.alternate;y!==null&&(y=y.updateQueue,a=y.lastBaseUpdate,a!==d&&(a===null?y.firstBaseUpdate=p:a.next=p,y.lastBaseUpdate=f))}if(l!==null){var v=i.baseState;d=0,y=p=f=null,a=l;do{var j=a.lane,w=a.eventTime;if((s&j)===j){y!==null&&(y=y.next={eventTime:w,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var k=e,S=a;switch(j=r,w=n,S.tag){case 1:if(k=S.payload,typeof k=="function"){v=k.call(w,v,j);break e}v=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=S.payload,j=typeof k=="function"?k.call(w,v,j):k,j==null)break e;v=ci({},v,j);break e;case 2:wh=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,j=i.effects,j===null?i.effects=[a]:j.push(a))}else w={eventTime:w,lane:j,tag:a.tag,payload:a.payload,callback:a.callback,next:null},y===null?(p=y=w,f=v):y=y.next=w,d|=j;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;j=a,a=j.next,j.next=null,i.lastBaseUpdate=j,i.shared.pending=null}}while(!0);if(y===null&&(f=v),i.baseState=f,i.firstBaseUpdate=p,i.lastBaseUpdate=y,r=i.shared.interleaved,r!==null){i=r;do d|=i.lane,i=i.next;while(i!==r)}else l===null&&(i.shared.lanes=0);Hf|=d,e.lanes=d,e.memoizedState=v}}function w3(e,r,n){if(e=r.effects,r.effects=null,e!==null)for(r=0;r<e.length;r++){var s=e[r],i=s.callback;if(i!==null){if(s.callback=null,s=n,typeof i!="function")throw Error(Zt(191,i));i.call(s)}}}var Ub={},rd=ym(Ub),k_=ym(Ub),T_=ym(Ub);function Pf(e){if(e===Ub)throw Error(Zt(174));return e}function SO(e,r){switch(Ps(T_,r),Ps(k_,e),Ps(rd,Ub),e=r.nodeType,e){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:Fk(null,"");break;default:e=e===8?r.parentNode:r,r=e.namespaceURI||null,e=e.tagName,r=Fk(r,e)}Ls(rd),Ps(rd,r)}function Fg(){Ls(rd),Ls(k_),Ls(T_)}function D8(e){Pf(T_.current);var r=Pf(rd.current),n=Fk(r,e.type);r!==n&&(Ps(k_,e),Ps(rd,n))}function PO(e){k_.current===e&&(Ls(rd),Ls(k_))}var ni=ym(0);function cN(e){for(var r=e;r!==null;){if(r.tag===13){var n=r.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if(r.flags&128)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var fA=[];function CO(){for(var e=0;e<fA.length;e++)fA[e]._workInProgressVersionPrimary=null;fA.length=0}var I1=Tu.ReactCurrentDispatcher,pA=Tu.ReactCurrentBatchConfig,Kf=0,ai=null,Zi=null,ua=null,dN=!1,o_=!1,E_=0,QJ=0;function $a(){throw Error(Zt(321))}function AO(e,r){if(r===null)return!1;for(var n=0;n<r.length&&n<e.length;n++)if(!Ac(e[n],r[n]))return!1;return!0}function kO(e,r,n,s,i,l){if(Kf=l,ai=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,I1.current=e===null||e.memoizedState===null?ree:nee,e=n(s,i),o_){l=0;do{if(o_=!1,E_=0,25<=l)throw Error(Zt(301));l+=1,ua=Zi=null,r.updateQueue=null,I1.current=see,e=n(s,i)}while(o_)}if(I1.current=uN,r=Zi!==null&&Zi.next!==null,Kf=0,ua=Zi=ai=null,dN=!1,r)throw Error(Zt(300));return e}function TO(){var e=E_!==0;return E_=0,e}function Wc(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ua===null?ai.memoizedState=ua=e:ua=ua.next=e,ua}function Il(){if(Zi===null){var e=ai.alternate;e=e!==null?e.memoizedState:null}else e=Zi.next;var r=ua===null?ai.memoizedState:ua.next;if(r!==null)ua=r,Zi=e;else{if(e===null)throw Error(Zt(310));Zi=e,e={memoizedState:Zi.memoizedState,baseState:Zi.baseState,baseQueue:Zi.baseQueue,queue:Zi.queue,next:null},ua===null?ai.memoizedState=ua=e:ua=ua.next=e}return ua}function M_(e,r){return typeof r=="function"?r(e):r}function xA(e){var r=Il(),n=r.queue;if(n===null)throw Error(Zt(311));n.lastRenderedReducer=e;var s=Zi,i=s.baseQueue,l=n.pending;if(l!==null){if(i!==null){var d=i.next;i.next=l.next,l.next=d}s.baseQueue=i=l,n.pending=null}if(i!==null){l=i.next,s=s.baseState;var a=d=null,f=null,p=l;do{var y=p.lane;if((Kf&y)===y)f!==null&&(f=f.next={lane:0,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null}),s=p.hasEagerState?p.eagerState:e(s,p.action);else{var v={lane:y,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null};f===null?(a=f=v,d=s):f=f.next=v,ai.lanes|=y,Hf|=y}p=p.next}while(p!==null&&p!==l);f===null?d=s:f.next=a,Ac(s,r.memoizedState)||(Co=!0),r.memoizedState=s,r.baseState=d,r.baseQueue=f,n.lastRenderedState=s}if(e=n.interleaved,e!==null){i=e;do l=i.lane,ai.lanes|=l,Hf|=l,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[r.memoizedState,n.dispatch]}function gA(e){var r=Il(),n=r.queue;if(n===null)throw Error(Zt(311));n.lastRenderedReducer=e;var s=n.dispatch,i=n.pending,l=r.memoizedState;if(i!==null){n.pending=null;var d=i=i.next;do l=e(l,d.action),d=d.next;while(d!==i);Ac(l,r.memoizedState)||(Co=!0),r.memoizedState=l,r.baseQueue===null&&(r.baseState=l),n.lastRenderedState=l}return[l,s]}function R8(){}function L8(e,r){var n=ai,s=Il(),i=r(),l=!Ac(s.memoizedState,i);if(l&&(s.memoizedState=i,Co=!0),s=s.queue,EO($8.bind(null,n,s,e),[e]),s.getSnapshot!==r||l||ua!==null&&ua.memoizedState.tag&1){if(n.flags|=2048,O_(9,z8.bind(null,n,s,i,r),void 0,null),ma===null)throw Error(Zt(349));Kf&30||F8(n,r,i)}return i}function F8(e,r,n){e.flags|=16384,e={getSnapshot:r,value:n},r=ai.updateQueue,r===null?(r={lastEffect:null,stores:null},ai.updateQueue=r,r.stores=[e]):(n=r.stores,n===null?r.stores=[e]:n.push(e))}function z8(e,r,n,s){r.value=n,r.getSnapshot=s,B8(r)&&q8(e)}function $8(e,r,n){return n(function(){B8(r)&&q8(e)})}function B8(e){var r=e.getSnapshot;e=e.value;try{var n=r();return!Ac(e,n)}catch{return!0}}function q8(e){var r=xu(e,1);r!==null&&Nc(r,e,1,-1)}function N3(e){var r=Wc();return typeof e=="function"&&(e=e()),r.memoizedState=r.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:M_,lastRenderedState:e},r.queue=e,e=e.dispatch=tee.bind(null,ai,e),[r.memoizedState,e]}function O_(e,r,n,s){return e={tag:e,create:r,destroy:n,deps:s,next:null},r=ai.updateQueue,r===null?(r={lastEffect:null,stores:null},ai.updateQueue=r,r.lastEffect=e.next=e):(n=r.lastEffect,n===null?r.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,r.lastEffect=e)),e}function V8(){return Il().memoizedState}function D1(e,r,n,s){var i=Wc();ai.flags|=e,i.memoizedState=O_(1|r,n,void 0,s===void 0?null:s)}function n2(e,r,n,s){var i=Il();s=s===void 0?null:s;var l=void 0;if(Zi!==null){var d=Zi.memoizedState;if(l=d.destroy,s!==null&&AO(s,d.deps)){i.memoizedState=O_(r,n,l,s);return}}ai.flags|=e,i.memoizedState=O_(1|r,n,l,s)}function S3(e,r){return D1(8390656,8,e,r)}function EO(e,r){return n2(2048,8,e,r)}function U8(e,r){return n2(4,2,e,r)}function W8(e,r){return n2(4,4,e,r)}function G8(e,r){if(typeof r=="function")return e=e(),r(e),function(){r(null)};if(r!=null)return e=e(),r.current=e,function(){r.current=null}}function K8(e,r,n){return n=n!=null?n.concat([e]):null,n2(4,4,G8.bind(null,r,e),n)}function MO(){}function H8(e,r){var n=Il();r=r===void 0?null:r;var s=n.memoizedState;return s!==null&&r!==null&&AO(r,s[1])?s[0]:(n.memoizedState=[e,r],e)}function Z8(e,r){var n=Il();r=r===void 0?null:r;var s=n.memoizedState;return s!==null&&r!==null&&AO(r,s[1])?s[0]:(e=e(),n.memoizedState=[e,r],e)}function Y8(e,r,n){return Kf&21?(Ac(n,r)||(n=t8(),ai.lanes|=n,Hf|=n,e.baseState=!0),r):(e.baseState&&(e.baseState=!1,Co=!0),e.memoizedState=n)}function JJ(e,r){var n=rs;rs=n!==0&&4>n?n:4,e(!0);var s=pA.transition;pA.transition={};try{e(!1),r()}finally{rs=n,pA.transition=s}}function X8(){return Il().memoizedState}function eee(e,r,n){var s=Qh(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},Q8(e))J8(r,n);else if(n=O8(e,r,n,s),n!==null){var i=fo();Nc(n,e,s,i),eq(n,r,s)}}function tee(e,r,n){var s=Qh(e),i={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(Q8(e))J8(r,i);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=r.lastRenderedReducer,l!==null))try{var d=r.lastRenderedState,a=l(d,n);if(i.hasEagerState=!0,i.eagerState=a,Ac(a,d)){var f=r.interleaved;f===null?(i.next=i,wO(r)):(i.next=f.next,f.next=i),r.interleaved=i;return}}catch{}finally{}n=O8(e,r,i,s),n!==null&&(i=fo(),Nc(n,e,s,i),eq(n,r,s))}}function Q8(e){var r=e.alternate;return e===ai||r!==null&&r===ai}function J8(e,r){o_=dN=!0;var n=e.pending;n===null?r.next=r:(r.next=n.next,n.next=r),e.pending=r}function eq(e,r,n){if(n&4194240){var s=r.lanes;s&=e.pendingLanes,n|=s,r.lanes=n,cO(e,n)}}var uN={readContext:Ol,useCallback:$a,useContext:$a,useEffect:$a,useImperativeHandle:$a,useInsertionEffect:$a,useLayoutEffect:$a,useMemo:$a,useReducer:$a,useRef:$a,useState:$a,useDebugValue:$a,useDeferredValue:$a,useTransition:$a,useMutableSource:$a,useSyncExternalStore:$a,useId:$a,unstable_isNewReconciler:!1},ree={readContext:Ol,useCallback:function(e,r){return Wc().memoizedState=[e,r===void 0?null:r],e},useContext:Ol,useEffect:S3,useImperativeHandle:function(e,r,n){return n=n!=null?n.concat([e]):null,D1(4194308,4,G8.bind(null,r,e),n)},useLayoutEffect:function(e,r){return D1(4194308,4,e,r)},useInsertionEffect:function(e,r){return D1(4,2,e,r)},useMemo:function(e,r){var n=Wc();return r=r===void 0?null:r,e=e(),n.memoizedState=[e,r],e},useReducer:function(e,r,n){var s=Wc();return r=n!==void 0?n(r):r,s.memoizedState=s.baseState=r,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},s.queue=e,e=e.dispatch=eee.bind(null,ai,e),[s.memoizedState,e]},useRef:function(e){var r=Wc();return e={current:e},r.memoizedState=e},useState:N3,useDebugValue:MO,useDeferredValue:function(e){return Wc().memoizedState=e},useTransition:function(){var e=N3(!1),r=e[0];return e=JJ.bind(null,e[1]),Wc().memoizedState=e,[r,e]},useMutableSource:function(){},useSyncExternalStore:function(e,r,n){var s=ai,i=Wc();if(Ks){if(n===void 0)throw Error(Zt(407));n=n()}else{if(n=r(),ma===null)throw Error(Zt(349));Kf&30||F8(s,r,n)}i.memoizedState=n;var l={value:n,getSnapshot:r};return i.queue=l,S3($8.bind(null,s,l,e),[e]),s.flags|=2048,O_(9,z8.bind(null,s,l,n,r),void 0,null),n},useId:function(){var e=Wc(),r=ma.identifierPrefix;if(Ks){var n=su,s=nu;n=(s&~(1<<32-wc(s)-1)).toString(32)+n,r=":"+r+"R"+n,n=E_++,0<n&&(r+="H"+n.toString(32)),r+=":"}else n=QJ++,r=":"+r+"r"+n.toString(32)+":";return e.memoizedState=r},unstable_isNewReconciler:!1},nee={readContext:Ol,useCallback:H8,useContext:Ol,useEffect:EO,useImperativeHandle:K8,useInsertionEffect:U8,useLayoutEffect:W8,useMemo:Z8,useReducer:xA,useRef:V8,useState:function(){return xA(M_)},useDebugValue:MO,useDeferredValue:function(e){var r=Il();return Y8(r,Zi.memoizedState,e)},useTransition:function(){var e=xA(M_)[0],r=Il().memoizedState;return[e,r]},useMutableSource:R8,useSyncExternalStore:L8,useId:X8,unstable_isNewReconciler:!1},see={readContext:Ol,useCallback:H8,useContext:Ol,useEffect:EO,useImperativeHandle:K8,useInsertionEffect:U8,useLayoutEffect:W8,useMemo:Z8,useReducer:gA,useRef:V8,useState:function(){return gA(M_)},useDebugValue:MO,useDeferredValue:function(e){var r=Il();return Zi===null?r.memoizedState=e:Y8(r,Zi.memoizedState,e)},useTransition:function(){var e=gA(M_)[0],r=Il().memoizedState;return[e,r]},useMutableSource:R8,useSyncExternalStore:L8,useId:X8,unstable_isNewReconciler:!1};function dc(e,r){if(e&&e.defaultProps){r=ci({},r),e=e.defaultProps;for(var n in e)r[n]===void 0&&(r[n]=e[n]);return r}return r}function iT(e,r,n,s){r=e.memoizedState,n=n(s,r),n=n==null?r:ci({},r,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var s2={isMounted:function(e){return(e=e._reactInternals)?hp(e)===e:!1},enqueueSetState:function(e,r,n){e=e._reactInternals;var s=fo(),i=Qh(e),l=cu(s,i);l.payload=r,n!=null&&(l.callback=n),r=Yh(e,l,i),r!==null&&(Nc(r,e,i,s),O1(r,e,i))},enqueueReplaceState:function(e,r,n){e=e._reactInternals;var s=fo(),i=Qh(e),l=cu(s,i);l.tag=1,l.payload=r,n!=null&&(l.callback=n),r=Yh(e,l,i),r!==null&&(Nc(r,e,i,s),O1(r,e,i))},enqueueForceUpdate:function(e,r){e=e._reactInternals;var n=fo(),s=Qh(e),i=cu(n,s);i.tag=2,r!=null&&(i.callback=r),r=Yh(e,i,s),r!==null&&(Nc(r,e,s,n),O1(r,e,s))}};function P3(e,r,n,s,i,l,d){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,l,d):r.prototype&&r.prototype.isPureReactComponent?!S_(n,s)||!S_(i,l):!0}function tq(e,r,n){var s=!1,i=om,l=r.contextType;return typeof l=="object"&&l!==null?l=Ol(l):(i=Eo(r)?Wf:Ya.current,s=r.contextTypes,l=(s=s!=null)?Dg(e,i):om),r=new r(n,l),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=s2,e.stateNode=r,r._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=l),r}function C3(e,r,n,s){e=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(n,s),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(n,s),r.state!==e&&s2.enqueueReplaceState(r,r.state,null)}function aT(e,r,n,s){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},NO(e);var l=r.contextType;typeof l=="object"&&l!==null?i.context=Ol(l):(l=Eo(r)?Wf:Ya.current,i.context=Dg(e,l)),i.state=e.memoizedState,l=r.getDerivedStateFromProps,typeof l=="function"&&(iT(e,r,l,n),i.state=e.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(r=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),r!==i.state&&s2.enqueueReplaceState(i,i.state,null),lN(e,n,i,s),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function zg(e,r){try{var n="",s=r;do n+=MQ(s),s=s.return;while(s);var i=n}catch(l){i=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:r,stack:i,digest:null}}function yA(e,r,n){return{value:e,source:null,stack:n??null,digest:r??null}}function oT(e,r){try{console.error(r.value)}catch(n){setTimeout(function(){throw n})}}var iee=typeof WeakMap=="function"?WeakMap:Map;function rq(e,r,n){n=cu(-1,n),n.tag=3,n.payload={element:null};var s=r.value;return n.callback=function(){mN||(mN=!0,gT=s),oT(e,r)},n}function nq(e,r,n){n=cu(-1,n),n.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var i=r.value;n.payload=function(){return s(i)},n.callback=function(){oT(e,r)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){oT(e,r),typeof s!="function"&&(Xh===null?Xh=new Set([this]):Xh.add(this));var d=r.stack;this.componentDidCatch(r.value,{componentStack:d!==null?d:""})}),n}function A3(e,r,n){var s=e.pingCache;if(s===null){s=e.pingCache=new iee;var i=new Set;s.set(r,i)}else i=s.get(r),i===void 0&&(i=new Set,s.set(r,i));i.has(n)||(i.add(n),e=vee.bind(null,e,r,n),r.then(e,e))}function k3(e){do{var r;if((r=e.tag===13)&&(r=e.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return e;e=e.return}while(e!==null);return null}function T3(e,r,n,s,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===r?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(r=cu(-1,1),r.tag=2,Yh(n,r,1))),n.lanes|=1),e)}var aee=Tu.ReactCurrentOwner,Co=!1;function oo(e,r,n,s){r.child=e===null?M8(r,null,n,s):Lg(r,e.child,n,s)}function E3(e,r,n,s,i){n=n.render;var l=r.ref;return lg(r,i),s=kO(e,r,n,s,l,i),n=TO(),e!==null&&!Co?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~i,gu(e,r,i)):(Ks&&n&&gO(r),r.flags|=1,oo(e,r,s,i),r.child)}function M3(e,r,n,s,i){if(e===null){var l=n.type;return typeof l=="function"&&!$O(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(r.tag=15,r.type=l,sq(e,r,l,s,i)):(e=z1(n.type,null,s,r,r.mode,i),e.ref=r.ref,e.return=r,r.child=e)}if(l=e.child,!(e.lanes&i)){var d=l.memoizedProps;if(n=n.compare,n=n!==null?n:S_,n(d,s)&&e.ref===r.ref)return gu(e,r,i)}return r.flags|=1,e=Jh(l,s),e.ref=r.ref,e.return=r,r.child=e}function sq(e,r,n,s,i){if(e!==null){var l=e.memoizedProps;if(S_(l,s)&&e.ref===r.ref)if(Co=!1,r.pendingProps=s=l,(e.lanes&i)!==0)e.flags&131072&&(Co=!0);else return r.lanes=e.lanes,gu(e,r,i)}return lT(e,r,n,s,i)}function iq(e,r,n){var s=r.pendingProps,i=s.children,l=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(r.mode&1))r.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ps(Xx,Zo),Zo|=n;else{if(!(n&1073741824))return e=l!==null?l.baseLanes|n:n,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:e,cachePool:null,transitions:null},r.updateQueue=null,Ps(Xx,Zo),Zo|=e,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=l!==null?l.baseLanes:n,Ps(Xx,Zo),Zo|=s}else l!==null?(s=l.baseLanes|n,r.memoizedState=null):s=n,Ps(Xx,Zo),Zo|=s;return oo(e,r,i,n),r.child}function aq(e,r){var n=r.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(r.flags|=512,r.flags|=2097152)}function lT(e,r,n,s,i){var l=Eo(n)?Wf:Ya.current;return l=Dg(r,l),lg(r,i),n=kO(e,r,n,s,l,i),s=TO(),e!==null&&!Co?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~i,gu(e,r,i)):(Ks&&s&&gO(r),r.flags|=1,oo(e,r,n,i),r.child)}function O3(e,r,n,s,i){if(Eo(n)){var l=!0;nN(r)}else l=!1;if(lg(r,i),r.stateNode===null)R1(e,r),tq(r,n,s),aT(r,n,s,i),s=!0;else if(e===null){var d=r.stateNode,a=r.memoizedProps;d.props=a;var f=d.context,p=n.contextType;typeof p=="object"&&p!==null?p=Ol(p):(p=Eo(n)?Wf:Ya.current,p=Dg(r,p));var y=n.getDerivedStateFromProps,v=typeof y=="function"||typeof d.getSnapshotBeforeUpdate=="function";v||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(a!==s||f!==p)&&C3(r,d,s,p),wh=!1;var j=r.memoizedState;d.state=j,lN(r,s,d,i),f=r.memoizedState,a!==s||j!==f||To.current||wh?(typeof y=="function"&&(iT(r,n,y,s),f=r.memoizedState),(a=wh||P3(r,n,a,s,j,f,p))?(v||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(r.flags|=4194308)):(typeof d.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=s,r.memoizedState=f),d.props=s,d.state=f,d.context=p,s=a):(typeof d.componentDidMount=="function"&&(r.flags|=4194308),s=!1)}else{d=r.stateNode,I8(e,r),a=r.memoizedProps,p=r.type===r.elementType?a:dc(r.type,a),d.props=p,v=r.pendingProps,j=d.context,f=n.contextType,typeof f=="object"&&f!==null?f=Ol(f):(f=Eo(n)?Wf:Ya.current,f=Dg(r,f));var w=n.getDerivedStateFromProps;(y=typeof w=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(a!==v||j!==f)&&C3(r,d,s,f),wh=!1,j=r.memoizedState,d.state=j,lN(r,s,d,i);var k=r.memoizedState;a!==v||j!==k||To.current||wh?(typeof w=="function"&&(iT(r,n,w,s),k=r.memoizedState),(p=wh||P3(r,n,p,s,j,k,f)||!1)?(y||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(s,k,f),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(s,k,f)),typeof d.componentDidUpdate=="function"&&(r.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof d.componentDidUpdate!="function"||a===e.memoizedProps&&j===e.memoizedState||(r.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&j===e.memoizedState||(r.flags|=1024),r.memoizedProps=s,r.memoizedState=k),d.props=s,d.state=k,d.context=f,s=p):(typeof d.componentDidUpdate!="function"||a===e.memoizedProps&&j===e.memoizedState||(r.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&j===e.memoizedState||(r.flags|=1024),s=!1)}return cT(e,r,n,s,l,i)}function cT(e,r,n,s,i,l){aq(e,r);var d=(r.flags&128)!==0;if(!s&&!d)return i&&y3(r,n,!1),gu(e,r,l);s=r.stateNode,aee.current=r;var a=d&&typeof n.getDerivedStateFromError!="function"?null:s.render();return r.flags|=1,e!==null&&d?(r.child=Lg(r,e.child,null,l),r.child=Lg(r,null,a,l)):oo(e,r,a,l),r.memoizedState=s.state,i&&y3(r,n,!0),r.child}function oq(e){var r=e.stateNode;r.pendingContext?g3(e,r.pendingContext,r.pendingContext!==r.context):r.context&&g3(e,r.context,!1),SO(e,r.containerInfo)}function I3(e,r,n,s,i){return Rg(),vO(i),r.flags|=256,oo(e,r,n,s),r.child}var dT={dehydrated:null,treeContext:null,retryLane:0};function uT(e){return{baseLanes:e,cachePool:null,transitions:null}}function lq(e,r,n){var s=r.pendingProps,i=ni.current,l=!1,d=(r.flags&128)!==0,a;if((a=d)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(l=!0,r.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Ps(ni,i&1),e===null)return nT(r),e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(r.mode&1?e.data==="$!"?r.lanes=8:r.lanes=1073741824:r.lanes=1,null):(d=s.children,e=s.fallback,l?(s=r.mode,l=r.child,d={mode:"hidden",children:d},!(s&1)&&l!==null?(l.childLanes=0,l.pendingProps=d):l=o2(d,s,0,null),e=Bf(e,s,n,null),l.return=r,e.return=r,l.sibling=e,r.child=l,r.child.memoizedState=uT(n),r.memoizedState=dT,e):OO(r,d));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return oee(e,r,d,s,a,i,n);if(l){l=s.fallback,d=r.mode,i=e.child,a=i.sibling;var f={mode:"hidden",children:s.children};return!(d&1)&&r.child!==i?(s=r.child,s.childLanes=0,s.pendingProps=f,r.deletions=null):(s=Jh(i,f),s.subtreeFlags=i.subtreeFlags&14680064),a!==null?l=Jh(a,l):(l=Bf(l,d,n,null),l.flags|=2),l.return=r,s.return=r,s.sibling=l,r.child=s,s=l,l=r.child,d=e.child.memoizedState,d=d===null?uT(n):{baseLanes:d.baseLanes|n,cachePool:null,transitions:d.transitions},l.memoizedState=d,l.childLanes=e.childLanes&~n,r.memoizedState=dT,s}return l=e.child,e=l.sibling,s=Jh(l,{mode:"visible",children:s.children}),!(r.mode&1)&&(s.lanes=n),s.return=r,s.sibling=null,e!==null&&(n=r.deletions,n===null?(r.deletions=[e],r.flags|=16):n.push(e)),r.child=s,r.memoizedState=null,s}function OO(e,r){return r=o2({mode:"visible",children:r},e.mode,0,null),r.return=e,e.child=r}function Yw(e,r,n,s){return s!==null&&vO(s),Lg(r,e.child,null,n),e=OO(r,r.pendingProps.children),e.flags|=2,r.memoizedState=null,e}function oee(e,r,n,s,i,l,d){if(n)return r.flags&256?(r.flags&=-257,s=yA(Error(Zt(422))),Yw(e,r,d,s)):r.memoizedState!==null?(r.child=e.child,r.flags|=128,null):(l=s.fallback,i=r.mode,s=o2({mode:"visible",children:s.children},i,0,null),l=Bf(l,i,d,null),l.flags|=2,s.return=r,l.return=r,s.sibling=l,r.child=s,r.mode&1&&Lg(r,e.child,null,d),r.child.memoizedState=uT(d),r.memoizedState=dT,l);if(!(r.mode&1))return Yw(e,r,d,null);if(i.data==="$!"){if(s=i.nextSibling&&i.nextSibling.dataset,s)var a=s.dgst;return s=a,l=Error(Zt(419)),s=yA(l,s,void 0),Yw(e,r,d,s)}if(a=(d&e.childLanes)!==0,Co||a){if(s=ma,s!==null){switch(d&-d){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(s.suspendedLanes|d)?0:i,i!==0&&i!==l.retryLane&&(l.retryLane=i,xu(e,i),Nc(s,e,i,-1))}return zO(),s=yA(Error(Zt(421))),Yw(e,r,d,s)}return i.data==="$?"?(r.flags|=128,r.child=e.child,r=_ee.bind(null,e),i._reactRetry=r,null):(e=l.treeContext,tl=Zh(i.nextSibling),rl=r,Ks=!0,pc=null,e!==null&&(wl[Nl++]=nu,wl[Nl++]=su,wl[Nl++]=Gf,nu=e.id,su=e.overflow,Gf=r),r=OO(r,s.children),r.flags|=4096,r)}function D3(e,r,n){e.lanes|=r;var s=e.alternate;s!==null&&(s.lanes|=r),sT(e.return,r,n)}function vA(e,r,n,s,i){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:i}:(l.isBackwards=r,l.rendering=null,l.renderingStartTime=0,l.last=s,l.tail=n,l.tailMode=i)}function cq(e,r,n){var s=r.pendingProps,i=s.revealOrder,l=s.tail;if(oo(e,r,s.children,n),s=ni.current,s&2)s=s&1|2,r.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=r.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&D3(e,n,r);else if(e.tag===19)D3(e,n,r);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break e;for(;e.sibling===null;){if(e.return===null||e.return===r)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(Ps(ni,s),!(r.mode&1))r.memoizedState=null;else switch(i){case"forwards":for(n=r.child,i=null;n!==null;)e=n.alternate,e!==null&&cN(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=r.child,r.child=null):(i=n.sibling,n.sibling=null),vA(r,!1,i,n,l);break;case"backwards":for(n=null,i=r.child,r.child=null;i!==null;){if(e=i.alternate,e!==null&&cN(e)===null){r.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}vA(r,!0,n,null,l);break;case"together":vA(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function R1(e,r){!(r.mode&1)&&e!==null&&(e.alternate=null,r.alternate=null,r.flags|=2)}function gu(e,r,n){if(e!==null&&(r.dependencies=e.dependencies),Hf|=r.lanes,!(n&r.childLanes))return null;if(e!==null&&r.child!==e.child)throw Error(Zt(153));if(r.child!==null){for(e=r.child,n=Jh(e,e.pendingProps),r.child=n,n.return=r;e.sibling!==null;)e=e.sibling,n=n.sibling=Jh(e,e.pendingProps),n.return=r;n.sibling=null}return r.child}function lee(e,r,n){switch(r.tag){case 3:oq(r),Rg();break;case 5:D8(r);break;case 1:Eo(r.type)&&nN(r);break;case 4:SO(r,r.stateNode.containerInfo);break;case 10:var s=r.type._context,i=r.memoizedProps.value;Ps(aN,s._currentValue),s._currentValue=i;break;case 13:if(s=r.memoizedState,s!==null)return s.dehydrated!==null?(Ps(ni,ni.current&1),r.flags|=128,null):n&r.child.childLanes?lq(e,r,n):(Ps(ni,ni.current&1),e=gu(e,r,n),e!==null?e.sibling:null);Ps(ni,ni.current&1);break;case 19:if(s=(n&r.childLanes)!==0,e.flags&128){if(s)return cq(e,r,n);r.flags|=128}if(i=r.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ps(ni,ni.current),s)break;return null;case 22:case 23:return r.lanes=0,iq(e,r,n)}return gu(e,r,n)}var dq,hT,uq,hq;dq=function(e,r){for(var n=r.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break;for(;n.sibling===null;){if(n.return===null||n.return===r)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};hT=function(){};uq=function(e,r,n,s){var i=e.memoizedProps;if(i!==s){e=r.stateNode,Pf(rd.current);var l=null;switch(n){case"input":i=Ik(e,i),s=Ik(e,s),l=[];break;case"select":i=ci({},i,{value:void 0}),s=ci({},s,{value:void 0}),l=[];break;case"textarea":i=Lk(e,i),s=Lk(e,s),l=[];break;default:typeof i.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=tN)}zk(n,s);var d;n=null;for(p in i)if(!s.hasOwnProperty(p)&&i.hasOwnProperty(p)&&i[p]!=null)if(p==="style"){var a=i[p];for(d in a)a.hasOwnProperty(d)&&(n||(n={}),n[d]="")}else p!=="dangerouslySetInnerHTML"&&p!=="children"&&p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(y_.hasOwnProperty(p)?l||(l=[]):(l=l||[]).push(p,null));for(p in s){var f=s[p];if(a=i!=null?i[p]:void 0,s.hasOwnProperty(p)&&f!==a&&(f!=null||a!=null))if(p==="style")if(a){for(d in a)!a.hasOwnProperty(d)||f&&f.hasOwnProperty(d)||(n||(n={}),n[d]="");for(d in f)f.hasOwnProperty(d)&&a[d]!==f[d]&&(n||(n={}),n[d]=f[d])}else n||(l||(l=[]),l.push(p,n)),n=f;else p==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,a=a?a.__html:void 0,f!=null&&a!==f&&(l=l||[]).push(p,f)):p==="children"?typeof f!="string"&&typeof f!="number"||(l=l||[]).push(p,""+f):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&(y_.hasOwnProperty(p)?(f!=null&&p==="onScroll"&&Ms("scroll",e),l||a===f||(l=[])):(l=l||[]).push(p,f))}n&&(l=l||[]).push("style",n);var p=l;(r.updateQueue=p)&&(r.flags|=4)}};hq=function(e,r,n,s){n!==s&&(r.flags|=4)};function w0(e,r){if(!Ks)switch(e.tailMode){case"hidden":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?r||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Ba(e){var r=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(r)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,s|=i.subtreeFlags&14680064,s|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=s,e.childLanes=n,r}function cee(e,r,n){var s=r.pendingProps;switch(yO(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ba(r),null;case 1:return Eo(r.type)&&rN(),Ba(r),null;case 3:return s=r.stateNode,Fg(),Ls(To),Ls(Ya),CO(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Hw(r)?r.flags|=4:e===null||e.memoizedState.isDehydrated&&!(r.flags&256)||(r.flags|=1024,pc!==null&&(_T(pc),pc=null))),hT(e,r),Ba(r),null;case 5:PO(r);var i=Pf(T_.current);if(n=r.type,e!==null&&r.stateNode!=null)uq(e,r,n,s,i),e.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!s){if(r.stateNode===null)throw Error(Zt(166));return Ba(r),null}if(e=Pf(rd.current),Hw(r)){s=r.stateNode,n=r.type;var l=r.memoizedProps;switch(s[Yc]=r,s[A_]=l,e=(r.mode&1)!==0,n){case"dialog":Ms("cancel",s),Ms("close",s);break;case"iframe":case"object":case"embed":Ms("load",s);break;case"video":case"audio":for(i=0;i<H0.length;i++)Ms(H0[i],s);break;case"source":Ms("error",s);break;case"img":case"image":case"link":Ms("error",s),Ms("load",s);break;case"details":Ms("toggle",s);break;case"input":UR(s,l),Ms("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!l.multiple},Ms("invalid",s);break;case"textarea":GR(s,l),Ms("invalid",s)}zk(n,l),i=null;for(var d in l)if(l.hasOwnProperty(d)){var a=l[d];d==="children"?typeof a=="string"?s.textContent!==a&&(l.suppressHydrationWarning!==!0&&Kw(s.textContent,a,e),i=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(l.suppressHydrationWarning!==!0&&Kw(s.textContent,a,e),i=["children",""+a]):y_.hasOwnProperty(d)&&a!=null&&d==="onScroll"&&Ms("scroll",s)}switch(n){case"input":zw(s),WR(s,l,!0);break;case"textarea":zw(s),KR(s);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(s.onclick=tN)}s=i,r.updateQueue=s,s!==null&&(r.flags|=4)}else{d=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=$B(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=d.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=d.createElement(n,{is:s.is}):(e=d.createElement(n),n==="select"&&(d=e,s.multiple?d.multiple=!0:s.size&&(d.size=s.size))):e=d.createElementNS(e,n),e[Yc]=r,e[A_]=s,dq(e,r,!1,!1),r.stateNode=e;e:{switch(d=$k(n,s),n){case"dialog":Ms("cancel",e),Ms("close",e),i=s;break;case"iframe":case"object":case"embed":Ms("load",e),i=s;break;case"video":case"audio":for(i=0;i<H0.length;i++)Ms(H0[i],e);i=s;break;case"source":Ms("error",e),i=s;break;case"img":case"image":case"link":Ms("error",e),Ms("load",e),i=s;break;case"details":Ms("toggle",e),i=s;break;case"input":UR(e,s),i=Ik(e,s),Ms("invalid",e);break;case"option":i=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},i=ci({},s,{value:void 0}),Ms("invalid",e);break;case"textarea":GR(e,s),i=Lk(e,s),Ms("invalid",e);break;default:i=s}zk(n,i),a=i;for(l in a)if(a.hasOwnProperty(l)){var f=a[l];l==="style"?VB(e,f):l==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,f!=null&&BB(e,f)):l==="children"?typeof f=="string"?(n!=="textarea"||f!=="")&&v_(e,f):typeof f=="number"&&v_(e,""+f):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(y_.hasOwnProperty(l)?f!=null&&l==="onScroll"&&Ms("scroll",e):f!=null&&nO(e,l,f,d))}switch(n){case"input":zw(e),WR(e,s,!1);break;case"textarea":zw(e),KR(e);break;case"option":s.value!=null&&e.setAttribute("value",""+am(s.value));break;case"select":e.multiple=!!s.multiple,l=s.value,l!=null?sg(e,!!s.multiple,l,!1):s.defaultValue!=null&&sg(e,!!s.multiple,s.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=tN)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return Ba(r),null;case 6:if(e&&r.stateNode!=null)hq(e,r,e.memoizedProps,s);else{if(typeof s!="string"&&r.stateNode===null)throw Error(Zt(166));if(n=Pf(T_.current),Pf(rd.current),Hw(r)){if(s=r.stateNode,n=r.memoizedProps,s[Yc]=r,(l=s.nodeValue!==n)&&(e=rl,e!==null))switch(e.tag){case 3:Kw(s.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Kw(s.nodeValue,n,(e.mode&1)!==0)}l&&(r.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Yc]=r,r.stateNode=s}return Ba(r),null;case 13:if(Ls(ni),s=r.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ks&&tl!==null&&r.mode&1&&!(r.flags&128))T8(),Rg(),r.flags|=98560,l=!1;else if(l=Hw(r),s!==null&&s.dehydrated!==null){if(e===null){if(!l)throw Error(Zt(318));if(l=r.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(Zt(317));l[Yc]=r}else Rg(),!(r.flags&128)&&(r.memoizedState=null),r.flags|=4;Ba(r),l=!1}else pc!==null&&(_T(pc),pc=null),l=!0;if(!l)return r.flags&65536?r:null}return r.flags&128?(r.lanes=n,r):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(r.child.flags|=8192,r.mode&1&&(e===null||ni.current&1?Qi===0&&(Qi=3):zO())),r.updateQueue!==null&&(r.flags|=4),Ba(r),null);case 4:return Fg(),hT(e,r),e===null&&P_(r.stateNode.containerInfo),Ba(r),null;case 10:return jO(r.type._context),Ba(r),null;case 17:return Eo(r.type)&&rN(),Ba(r),null;case 19:if(Ls(ni),l=r.memoizedState,l===null)return Ba(r),null;if(s=(r.flags&128)!==0,d=l.rendering,d===null)if(s)w0(l,!1);else{if(Qi!==0||e!==null&&e.flags&128)for(e=r.child;e!==null;){if(d=cN(e),d!==null){for(r.flags|=128,w0(l,!1),s=d.updateQueue,s!==null&&(r.updateQueue=s,r.flags|=4),r.subtreeFlags=0,s=n,n=r.child;n!==null;)l=n,e=s,l.flags&=14680066,d=l.alternate,d===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=d.childLanes,l.lanes=d.lanes,l.child=d.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=d.memoizedProps,l.memoizedState=d.memoizedState,l.updateQueue=d.updateQueue,l.type=d.type,e=d.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ps(ni,ni.current&1|2),r.child}e=e.sibling}l.tail!==null&&Ni()>$g&&(r.flags|=128,s=!0,w0(l,!1),r.lanes=4194304)}else{if(!s)if(e=cN(d),e!==null){if(r.flags|=128,s=!0,n=e.updateQueue,n!==null&&(r.updateQueue=n,r.flags|=4),w0(l,!0),l.tail===null&&l.tailMode==="hidden"&&!d.alternate&&!Ks)return Ba(r),null}else 2*Ni()-l.renderingStartTime>$g&&n!==1073741824&&(r.flags|=128,s=!0,w0(l,!1),r.lanes=4194304);l.isBackwards?(d.sibling=r.child,r.child=d):(n=l.last,n!==null?n.sibling=d:r.child=d,l.last=d)}return l.tail!==null?(r=l.tail,l.rendering=r,l.tail=r.sibling,l.renderingStartTime=Ni(),r.sibling=null,n=ni.current,Ps(ni,s?n&1|2:n&1),r):(Ba(r),null);case 22:case 23:return FO(),s=r.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(r.flags|=8192),s&&r.mode&1?Zo&1073741824&&(Ba(r),r.subtreeFlags&6&&(r.flags|=8192)):Ba(r),null;case 24:return null;case 25:return null}throw Error(Zt(156,r.tag))}function dee(e,r){switch(yO(r),r.tag){case 1:return Eo(r.type)&&rN(),e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 3:return Fg(),Ls(To),Ls(Ya),CO(),e=r.flags,e&65536&&!(e&128)?(r.flags=e&-65537|128,r):null;case 5:return PO(r),null;case 13:if(Ls(ni),e=r.memoizedState,e!==null&&e.dehydrated!==null){if(r.alternate===null)throw Error(Zt(340));Rg()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 19:return Ls(ni),null;case 4:return Fg(),null;case 10:return jO(r.type._context),null;case 22:case 23:return FO(),null;case 24:return null;default:return null}}var Xw=!1,Wa=!1,uee=typeof WeakSet=="function"?WeakSet:Set,wr=null;function Yx(e,r){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){xi(e,r,s)}else n.current=null}function mT(e,r,n){try{n()}catch(s){xi(e,r,s)}}var R3=!1;function hee(e,r){if(Yk=Q1,e=g8(),xO(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var i=s.anchorOffset,l=s.focusNode;s=s.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var d=0,a=-1,f=-1,p=0,y=0,v=e,j=null;t:for(;;){for(var w;v!==n||i!==0&&v.nodeType!==3||(a=d+i),v!==l||s!==0&&v.nodeType!==3||(f=d+s),v.nodeType===3&&(d+=v.nodeValue.length),(w=v.firstChild)!==null;)j=v,v=w;for(;;){if(v===e)break t;if(j===n&&++p===i&&(a=d),j===l&&++y===s&&(f=d),(w=v.nextSibling)!==null)break;v=j,j=v.parentNode}v=w}n=a===-1||f===-1?null:{start:a,end:f}}else n=null}n=n||{start:0,end:0}}else n=null;for(Xk={focusedElem:e,selectionRange:n},Q1=!1,wr=r;wr!==null;)if(r=wr,e=r.child,(r.subtreeFlags&1028)!==0&&e!==null)e.return=r,wr=e;else for(;wr!==null;){r=wr;try{var k=r.alternate;if(r.flags&1024)switch(r.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var S=k.memoizedProps,R=k.memoizedState,D=r.stateNode,T=D.getSnapshotBeforeUpdate(r.elementType===r.type?S:dc(r.type,S),R);D.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var I=r.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Zt(163))}}catch(L){xi(r,r.return,L)}if(e=r.sibling,e!==null){e.return=r.return,wr=e;break}wr=r.return}return k=R3,R3=!1,k}function l_(e,r,n){var s=r.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var i=s=s.next;do{if((i.tag&e)===e){var l=i.destroy;i.destroy=void 0,l!==void 0&&mT(r,n,l)}i=i.next}while(i!==s)}}function i2(e,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var n=r=r.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==r)}}function fT(e){var r=e.ref;if(r!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof r=="function"?r(e):r.current=e}}function mq(e){var r=e.alternate;r!==null&&(e.alternate=null,mq(r)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(r=e.stateNode,r!==null&&(delete r[Yc],delete r[A_],delete r[eT],delete r[HJ],delete r[ZJ])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function fq(e){return e.tag===5||e.tag===3||e.tag===4}function L3(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||fq(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function pT(e,r,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,r?n.nodeType===8?n.parentNode.insertBefore(e,r):n.insertBefore(e,r):(n.nodeType===8?(r=n.parentNode,r.insertBefore(e,n)):(r=n,r.appendChild(e)),n=n._reactRootContainer,n!=null||r.onclick!==null||(r.onclick=tN));else if(s!==4&&(e=e.child,e!==null))for(pT(e,r,n),e=e.sibling;e!==null;)pT(e,r,n),e=e.sibling}function xT(e,r,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,r?n.insertBefore(e,r):n.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(xT(e,r,n),e=e.sibling;e!==null;)xT(e,r,n),e=e.sibling}var Ca=null,hc=!1;function hh(e,r,n){for(n=n.child;n!==null;)pq(e,r,n),n=n.sibling}function pq(e,r,n){if(td&&typeof td.onCommitFiberUnmount=="function")try{td.onCommitFiberUnmount(XS,n)}catch{}switch(n.tag){case 5:Wa||Yx(n,r);case 6:var s=Ca,i=hc;Ca=null,hh(e,r,n),Ca=s,hc=i,Ca!==null&&(hc?(e=Ca,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Ca.removeChild(n.stateNode));break;case 18:Ca!==null&&(hc?(e=Ca,n=n.stateNode,e.nodeType===8?hA(e.parentNode,n):e.nodeType===1&&hA(e,n),w_(e)):hA(Ca,n.stateNode));break;case 4:s=Ca,i=hc,Ca=n.stateNode.containerInfo,hc=!0,hh(e,r,n),Ca=s,hc=i;break;case 0:case 11:case 14:case 15:if(!Wa&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){i=s=s.next;do{var l=i,d=l.destroy;l=l.tag,d!==void 0&&(l&2||l&4)&&mT(n,r,d),i=i.next}while(i!==s)}hh(e,r,n);break;case 1:if(!Wa&&(Yx(n,r),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){xi(n,r,a)}hh(e,r,n);break;case 21:hh(e,r,n);break;case 22:n.mode&1?(Wa=(s=Wa)||n.memoizedState!==null,hh(e,r,n),Wa=s):hh(e,r,n);break;default:hh(e,r,n)}}function F3(e){var r=e.updateQueue;if(r!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new uee),r.forEach(function(s){var i=bee.bind(null,e,s);n.has(s)||(n.add(s),s.then(i,i))})}}function ac(e,r){var n=r.deletions;if(n!==null)for(var s=0;s<n.length;s++){var i=n[s];try{var l=e,d=r,a=d;e:for(;a!==null;){switch(a.tag){case 5:Ca=a.stateNode,hc=!1;break e;case 3:Ca=a.stateNode.containerInfo,hc=!0;break e;case 4:Ca=a.stateNode.containerInfo,hc=!0;break e}a=a.return}if(Ca===null)throw Error(Zt(160));pq(l,d,i),Ca=null,hc=!1;var f=i.alternate;f!==null&&(f.return=null),i.return=null}catch(p){xi(i,r,p)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)xq(r,e),r=r.sibling}function xq(e,r){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ac(r,e),Uc(e),s&4){try{l_(3,e,e.return),i2(3,e)}catch(S){xi(e,e.return,S)}try{l_(5,e,e.return)}catch(S){xi(e,e.return,S)}}break;case 1:ac(r,e),Uc(e),s&512&&n!==null&&Yx(n,n.return);break;case 5:if(ac(r,e),Uc(e),s&512&&n!==null&&Yx(n,n.return),e.flags&32){var i=e.stateNode;try{v_(i,"")}catch(S){xi(e,e.return,S)}}if(s&4&&(i=e.stateNode,i!=null)){var l=e.memoizedProps,d=n!==null?n.memoizedProps:l,a=e.type,f=e.updateQueue;if(e.updateQueue=null,f!==null)try{a==="input"&&l.type==="radio"&&l.name!=null&&FB(i,l),$k(a,d);var p=$k(a,l);for(d=0;d<f.length;d+=2){var y=f[d],v=f[d+1];y==="style"?VB(i,v):y==="dangerouslySetInnerHTML"?BB(i,v):y==="children"?v_(i,v):nO(i,y,v,p)}switch(a){case"input":Dk(i,l);break;case"textarea":zB(i,l);break;case"select":var j=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!l.multiple;var w=l.value;w!=null?sg(i,!!l.multiple,w,!1):j!==!!l.multiple&&(l.defaultValue!=null?sg(i,!!l.multiple,l.defaultValue,!0):sg(i,!!l.multiple,l.multiple?[]:"",!1))}i[A_]=l}catch(S){xi(e,e.return,S)}}break;case 6:if(ac(r,e),Uc(e),s&4){if(e.stateNode===null)throw Error(Zt(162));i=e.stateNode,l=e.memoizedProps;try{i.nodeValue=l}catch(S){xi(e,e.return,S)}}break;case 3:if(ac(r,e),Uc(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{w_(r.containerInfo)}catch(S){xi(e,e.return,S)}break;case 4:ac(r,e),Uc(e);break;case 13:ac(r,e),Uc(e),i=e.child,i.flags&8192&&(l=i.memoizedState!==null,i.stateNode.isHidden=l,!l||i.alternate!==null&&i.alternate.memoizedState!==null||(RO=Ni())),s&4&&F3(e);break;case 22:if(y=n!==null&&n.memoizedState!==null,e.mode&1?(Wa=(p=Wa)||y,ac(r,e),Wa=p):ac(r,e),Uc(e),s&8192){if(p=e.memoizedState!==null,(e.stateNode.isHidden=p)&&!y&&e.mode&1)for(wr=e,y=e.child;y!==null;){for(v=wr=y;wr!==null;){switch(j=wr,w=j.child,j.tag){case 0:case 11:case 14:case 15:l_(4,j,j.return);break;case 1:Yx(j,j.return);var k=j.stateNode;if(typeof k.componentWillUnmount=="function"){s=j,n=j.return;try{r=s,k.props=r.memoizedProps,k.state=r.memoizedState,k.componentWillUnmount()}catch(S){xi(s,n,S)}}break;case 5:Yx(j,j.return);break;case 22:if(j.memoizedState!==null){$3(v);continue}}w!==null?(w.return=j,wr=w):$3(v)}y=y.sibling}e:for(y=null,v=e;;){if(v.tag===5){if(y===null){y=v;try{i=v.stateNode,p?(l=i.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(a=v.stateNode,f=v.memoizedProps.style,d=f!=null&&f.hasOwnProperty("display")?f.display:null,a.style.display=qB("display",d))}catch(S){xi(e,e.return,S)}}}else if(v.tag===6){if(y===null)try{v.stateNode.nodeValue=p?"":v.memoizedProps}catch(S){xi(e,e.return,S)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===e)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===e)break e;for(;v.sibling===null;){if(v.return===null||v.return===e)break e;y===v&&(y=null),v=v.return}y===v&&(y=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:ac(r,e),Uc(e),s&4&&F3(e);break;case 21:break;default:ac(r,e),Uc(e)}}function Uc(e){var r=e.flags;if(r&2){try{e:{for(var n=e.return;n!==null;){if(fq(n)){var s=n;break e}n=n.return}throw Error(Zt(160))}switch(s.tag){case 5:var i=s.stateNode;s.flags&32&&(v_(i,""),s.flags&=-33);var l=L3(e);xT(e,l,i);break;case 3:case 4:var d=s.stateNode.containerInfo,a=L3(e);pT(e,a,d);break;default:throw Error(Zt(161))}}catch(f){xi(e,e.return,f)}e.flags&=-3}r&4096&&(e.flags&=-4097)}function mee(e,r,n){wr=e,gq(e)}function gq(e,r,n){for(var s=(e.mode&1)!==0;wr!==null;){var i=wr,l=i.child;if(i.tag===22&&s){var d=i.memoizedState!==null||Xw;if(!d){var a=i.alternate,f=a!==null&&a.memoizedState!==null||Wa;a=Xw;var p=Wa;if(Xw=d,(Wa=f)&&!p)for(wr=i;wr!==null;)d=wr,f=d.child,d.tag===22&&d.memoizedState!==null?B3(i):f!==null?(f.return=d,wr=f):B3(i);for(;l!==null;)wr=l,gq(l),l=l.sibling;wr=i,Xw=a,Wa=p}z3(e)}else i.subtreeFlags&8772&&l!==null?(l.return=i,wr=l):z3(e)}}function z3(e){for(;wr!==null;){var r=wr;if(r.flags&8772){var n=r.alternate;try{if(r.flags&8772)switch(r.tag){case 0:case 11:case 15:Wa||i2(5,r);break;case 1:var s=r.stateNode;if(r.flags&4&&!Wa)if(n===null)s.componentDidMount();else{var i=r.elementType===r.type?n.memoizedProps:dc(r.type,n.memoizedProps);s.componentDidUpdate(i,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var l=r.updateQueue;l!==null&&w3(r,l,s);break;case 3:var d=r.updateQueue;if(d!==null){if(n=null,r.child!==null)switch(r.child.tag){case 5:n=r.child.stateNode;break;case 1:n=r.child.stateNode}w3(r,d,n)}break;case 5:var a=r.stateNode;if(n===null&&r.flags&4){n=a;var f=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":f.autoFocus&&n.focus();break;case"img":f.src&&(n.src=f.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var p=r.alternate;if(p!==null){var y=p.memoizedState;if(y!==null){var v=y.dehydrated;v!==null&&w_(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Zt(163))}Wa||r.flags&512&&fT(r)}catch(j){xi(r,r.return,j)}}if(r===e){wr=null;break}if(n=r.sibling,n!==null){n.return=r.return,wr=n;break}wr=r.return}}function $3(e){for(;wr!==null;){var r=wr;if(r===e){wr=null;break}var n=r.sibling;if(n!==null){n.return=r.return,wr=n;break}wr=r.return}}function B3(e){for(;wr!==null;){var r=wr;try{switch(r.tag){case 0:case 11:case 15:var n=r.return;try{i2(4,r)}catch(f){xi(r,n,f)}break;case 1:var s=r.stateNode;if(typeof s.componentDidMount=="function"){var i=r.return;try{s.componentDidMount()}catch(f){xi(r,i,f)}}var l=r.return;try{fT(r)}catch(f){xi(r,l,f)}break;case 5:var d=r.return;try{fT(r)}catch(f){xi(r,d,f)}}}catch(f){xi(r,r.return,f)}if(r===e){wr=null;break}var a=r.sibling;if(a!==null){a.return=r.return,wr=a;break}wr=r.return}}var fee=Math.ceil,hN=Tu.ReactCurrentDispatcher,IO=Tu.ReactCurrentOwner,Tl=Tu.ReactCurrentBatchConfig,Fn=0,ma=null,Fi=null,ka=0,Zo=0,Xx=ym(0),Qi=0,I_=null,Hf=0,a2=0,DO=0,c_=null,So=null,RO=0,$g=1/0,Qd=null,mN=!1,gT=null,Xh=null,Qw=!1,$h=null,fN=0,d_=0,yT=null,L1=-1,F1=0;function fo(){return Fn&6?Ni():L1!==-1?L1:L1=Ni()}function Qh(e){return e.mode&1?Fn&2&&ka!==0?ka&-ka:XJ.transition!==null?(F1===0&&(F1=t8()),F1):(e=rs,e!==0||(e=window.event,e=e===void 0?16:l8(e.type)),e):1}function Nc(e,r,n,s){if(50<d_)throw d_=0,yT=null,Error(Zt(185));Bb(e,n,s),(!(Fn&2)||e!==ma)&&(e===ma&&(!(Fn&2)&&(a2|=n),Qi===4&&Ch(e,ka)),Mo(e,s),n===1&&Fn===0&&!(r.mode&1)&&($g=Ni()+500,r2&&vm()))}function Mo(e,r){var n=e.callbackNode;XQ(e,r);var s=X1(e,e===ma?ka:0);if(s===0)n!==null&&YR(n),e.callbackNode=null,e.callbackPriority=0;else if(r=s&-s,e.callbackPriority!==r){if(n!=null&&YR(n),r===1)e.tag===0?YJ(q3.bind(null,e)):C8(q3.bind(null,e)),GJ(function(){!(Fn&6)&&vm()}),n=null;else{switch(r8(s)){case 1:n=lO;break;case 4:n=JB;break;case 16:n=Y1;break;case 536870912:n=e8;break;default:n=Y1}n=Sq(n,yq.bind(null,e))}e.callbackPriority=r,e.callbackNode=n}}function yq(e,r){if(L1=-1,F1=0,Fn&6)throw Error(Zt(327));var n=e.callbackNode;if(cg()&&e.callbackNode!==n)return null;var s=X1(e,e===ma?ka:0);if(s===0)return null;if(s&30||s&e.expiredLanes||r)r=pN(e,s);else{r=s;var i=Fn;Fn|=2;var l=_q();(ma!==e||ka!==r)&&(Qd=null,$g=Ni()+500,$f(e,r));do try{gee();break}catch(a){vq(e,a)}while(!0);bO(),hN.current=l,Fn=i,Fi!==null?r=0:(ma=null,ka=0,r=Qi)}if(r!==0){if(r===2&&(i=Wk(e),i!==0&&(s=i,r=vT(e,i))),r===1)throw n=I_,$f(e,0),Ch(e,s),Mo(e,Ni()),n;if(r===6)Ch(e,s);else{if(i=e.current.alternate,!(s&30)&&!pee(i)&&(r=pN(e,s),r===2&&(l=Wk(e),l!==0&&(s=l,r=vT(e,l))),r===1))throw n=I_,$f(e,0),Ch(e,s),Mo(e,Ni()),n;switch(e.finishedWork=i,e.finishedLanes=s,r){case 0:case 1:throw Error(Zt(345));case 2:yf(e,So,Qd);break;case 3:if(Ch(e,s),(s&130023424)===s&&(r=RO+500-Ni(),10<r)){if(X1(e,0)!==0)break;if(i=e.suspendedLanes,(i&s)!==s){fo(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Jk(yf.bind(null,e,So,Qd),r);break}yf(e,So,Qd);break;case 4:if(Ch(e,s),(s&4194240)===s)break;for(r=e.eventTimes,i=-1;0<s;){var d=31-wc(s);l=1<<d,d=r[d],d>i&&(i=d),s&=~l}if(s=i,s=Ni()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*fee(s/1960))-s,10<s){e.timeoutHandle=Jk(yf.bind(null,e,So,Qd),s);break}yf(e,So,Qd);break;case 5:yf(e,So,Qd);break;default:throw Error(Zt(329))}}}return Mo(e,Ni()),e.callbackNode===n?yq.bind(null,e):null}function vT(e,r){var n=c_;return e.current.memoizedState.isDehydrated&&($f(e,r).flags|=256),e=pN(e,r),e!==2&&(r=So,So=n,r!==null&&_T(r)),e}function _T(e){So===null?So=e:So.push.apply(So,e)}function pee(e){for(var r=e;;){if(r.flags&16384){var n=r.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var i=n[s],l=i.getSnapshot;i=i.value;try{if(!Ac(l(),i))return!1}catch{return!1}}}if(n=r.child,r.subtreeFlags&16384&&n!==null)n.return=r,r=n;else{if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Ch(e,r){for(r&=~DO,r&=~a2,e.suspendedLanes|=r,e.pingedLanes&=~r,e=e.expirationTimes;0<r;){var n=31-wc(r),s=1<<n;e[n]=-1,r&=~s}}function q3(e){if(Fn&6)throw Error(Zt(327));cg();var r=X1(e,0);if(!(r&1))return Mo(e,Ni()),null;var n=pN(e,r);if(e.tag!==0&&n===2){var s=Wk(e);s!==0&&(r=s,n=vT(e,s))}if(n===1)throw n=I_,$f(e,0),Ch(e,r),Mo(e,Ni()),n;if(n===6)throw Error(Zt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=r,yf(e,So,Qd),Mo(e,Ni()),null}function LO(e,r){var n=Fn;Fn|=1;try{return e(r)}finally{Fn=n,Fn===0&&($g=Ni()+500,r2&&vm())}}function Zf(e){$h!==null&&$h.tag===0&&!(Fn&6)&&cg();var r=Fn;Fn|=1;var n=Tl.transition,s=rs;try{if(Tl.transition=null,rs=1,e)return e()}finally{rs=s,Tl.transition=n,Fn=r,!(Fn&6)&&vm()}}function FO(){Zo=Xx.current,Ls(Xx)}function $f(e,r){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,WJ(n)),Fi!==null)for(n=Fi.return;n!==null;){var s=n;switch(yO(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&rN();break;case 3:Fg(),Ls(To),Ls(Ya),CO();break;case 5:PO(s);break;case 4:Fg();break;case 13:Ls(ni);break;case 19:Ls(ni);break;case 10:jO(s.type._context);break;case 22:case 23:FO()}n=n.return}if(ma=e,Fi=e=Jh(e.current,null),ka=Zo=r,Qi=0,I_=null,DO=a2=Hf=0,So=c_=null,Sf!==null){for(r=0;r<Sf.length;r++)if(n=Sf[r],s=n.interleaved,s!==null){n.interleaved=null;var i=s.next,l=n.pending;if(l!==null){var d=l.next;l.next=i,s.next=d}n.pending=s}Sf=null}return e}function vq(e,r){do{var n=Fi;try{if(bO(),I1.current=uN,dN){for(var s=ai.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}dN=!1}if(Kf=0,ua=Zi=ai=null,o_=!1,E_=0,IO.current=null,n===null||n.return===null){Qi=1,I_=r,Fi=null;break}e:{var l=e,d=n.return,a=n,f=r;if(r=ka,a.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){var p=f,y=a,v=y.tag;if(!(y.mode&1)&&(v===0||v===11||v===15)){var j=y.alternate;j?(y.updateQueue=j.updateQueue,y.memoizedState=j.memoizedState,y.lanes=j.lanes):(y.updateQueue=null,y.memoizedState=null)}var w=k3(d);if(w!==null){w.flags&=-257,T3(w,d,a,l,r),w.mode&1&&A3(l,p,r),r=w,f=p;var k=r.updateQueue;if(k===null){var S=new Set;S.add(f),r.updateQueue=S}else k.add(f);break e}else{if(!(r&1)){A3(l,p,r),zO();break e}f=Error(Zt(426))}}else if(Ks&&a.mode&1){var R=k3(d);if(R!==null){!(R.flags&65536)&&(R.flags|=256),T3(R,d,a,l,r),vO(zg(f,a));break e}}l=f=zg(f,a),Qi!==4&&(Qi=2),c_===null?c_=[l]:c_.push(l),l=d;do{switch(l.tag){case 3:l.flags|=65536,r&=-r,l.lanes|=r;var D=rq(l,f,r);j3(l,D);break e;case 1:a=f;var T=l.type,I=l.stateNode;if(!(l.flags&128)&&(typeof T.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(Xh===null||!Xh.has(I)))){l.flags|=65536,r&=-r,l.lanes|=r;var L=nq(l,a,r);j3(l,L);break e}}l=l.return}while(l!==null)}jq(n)}catch($){r=$,Fi===n&&n!==null&&(Fi=n=n.return);continue}break}while(!0)}function _q(){var e=hN.current;return hN.current=uN,e===null?uN:e}function zO(){(Qi===0||Qi===3||Qi===2)&&(Qi=4),ma===null||!(Hf&268435455)&&!(a2&268435455)||Ch(ma,ka)}function pN(e,r){var n=Fn;Fn|=2;var s=_q();(ma!==e||ka!==r)&&(Qd=null,$f(e,r));do try{xee();break}catch(i){vq(e,i)}while(!0);if(bO(),Fn=n,hN.current=s,Fi!==null)throw Error(Zt(261));return ma=null,ka=0,Qi}function xee(){for(;Fi!==null;)bq(Fi)}function gee(){for(;Fi!==null&&!qQ();)bq(Fi)}function bq(e){var r=Nq(e.alternate,e,Zo);e.memoizedProps=e.pendingProps,r===null?jq(e):Fi=r,IO.current=null}function jq(e){var r=e;do{var n=r.alternate;if(e=r.return,r.flags&32768){if(n=dee(n,r),n!==null){n.flags&=32767,Fi=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Qi=6,Fi=null;return}}else if(n=cee(n,r,Zo),n!==null){Fi=n;return}if(r=r.sibling,r!==null){Fi=r;return}Fi=r=e}while(r!==null);Qi===0&&(Qi=5)}function yf(e,r,n){var s=rs,i=Tl.transition;try{Tl.transition=null,rs=1,yee(e,r,n,s)}finally{Tl.transition=i,rs=s}return null}function yee(e,r,n,s){do cg();while($h!==null);if(Fn&6)throw Error(Zt(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Zt(177));e.callbackNode=null,e.callbackPriority=0;var l=n.lanes|n.childLanes;if(QQ(e,l),e===ma&&(Fi=ma=null,ka=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Qw||(Qw=!0,Sq(Y1,function(){return cg(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=Tl.transition,Tl.transition=null;var d=rs;rs=1;var a=Fn;Fn|=4,IO.current=null,hee(e,n),xq(n,e),FJ(Xk),Q1=!!Yk,Xk=Yk=null,e.current=n,mee(n),VQ(),Fn=a,rs=d,Tl.transition=l}else e.current=n;if(Qw&&(Qw=!1,$h=e,fN=i),l=e.pendingLanes,l===0&&(Xh=null),GQ(n.stateNode),Mo(e,Ni()),r!==null)for(s=e.onRecoverableError,n=0;n<r.length;n++)i=r[n],s(i.value,{componentStack:i.stack,digest:i.digest});if(mN)throw mN=!1,e=gT,gT=null,e;return fN&1&&e.tag!==0&&cg(),l=e.pendingLanes,l&1?e===yT?d_++:(d_=0,yT=e):d_=0,vm(),null}function cg(){if($h!==null){var e=r8(fN),r=Tl.transition,n=rs;try{if(Tl.transition=null,rs=16>e?16:e,$h===null)var s=!1;else{if(e=$h,$h=null,fN=0,Fn&6)throw Error(Zt(331));var i=Fn;for(Fn|=4,wr=e.current;wr!==null;){var l=wr,d=l.child;if(wr.flags&16){var a=l.deletions;if(a!==null){for(var f=0;f<a.length;f++){var p=a[f];for(wr=p;wr!==null;){var y=wr;switch(y.tag){case 0:case 11:case 15:l_(8,y,l)}var v=y.child;if(v!==null)v.return=y,wr=v;else for(;wr!==null;){y=wr;var j=y.sibling,w=y.return;if(mq(y),y===p){wr=null;break}if(j!==null){j.return=w,wr=j;break}wr=w}}}var k=l.alternate;if(k!==null){var S=k.child;if(S!==null){k.child=null;do{var R=S.sibling;S.sibling=null,S=R}while(S!==null)}}wr=l}}if(l.subtreeFlags&2064&&d!==null)d.return=l,wr=d;else e:for(;wr!==null;){if(l=wr,l.flags&2048)switch(l.tag){case 0:case 11:case 15:l_(9,l,l.return)}var D=l.sibling;if(D!==null){D.return=l.return,wr=D;break e}wr=l.return}}var T=e.current;for(wr=T;wr!==null;){d=wr;var I=d.child;if(d.subtreeFlags&2064&&I!==null)I.return=d,wr=I;else e:for(d=T;wr!==null;){if(a=wr,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:i2(9,a)}}catch($){xi(a,a.return,$)}if(a===d){wr=null;break e}var L=a.sibling;if(L!==null){L.return=a.return,wr=L;break e}wr=a.return}}if(Fn=i,vm(),td&&typeof td.onPostCommitFiberRoot=="function")try{td.onPostCommitFiberRoot(XS,e)}catch{}s=!0}return s}finally{rs=n,Tl.transition=r}}return!1}function V3(e,r,n){r=zg(n,r),r=rq(e,r,1),e=Yh(e,r,1),r=fo(),e!==null&&(Bb(e,1,r),Mo(e,r))}function xi(e,r,n){if(e.tag===3)V3(e,e,n);else for(;r!==null;){if(r.tag===3){V3(r,e,n);break}else if(r.tag===1){var s=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Xh===null||!Xh.has(s))){e=zg(n,e),e=nq(r,e,1),r=Yh(r,e,1),e=fo(),r!==null&&(Bb(r,1,e),Mo(r,e));break}}r=r.return}}function vee(e,r,n){var s=e.pingCache;s!==null&&s.delete(r),r=fo(),e.pingedLanes|=e.suspendedLanes&n,ma===e&&(ka&n)===n&&(Qi===4||Qi===3&&(ka&130023424)===ka&&500>Ni()-RO?$f(e,0):DO|=n),Mo(e,r)}function wq(e,r){r===0&&(e.mode&1?(r=qw,qw<<=1,!(qw&130023424)&&(qw=4194304)):r=1);var n=fo();e=xu(e,r),e!==null&&(Bb(e,r,n),Mo(e,n))}function _ee(e){var r=e.memoizedState,n=0;r!==null&&(n=r.retryLane),wq(e,n)}function bee(e,r){var n=0;switch(e.tag){case 13:var s=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(Zt(314))}s!==null&&s.delete(r),wq(e,n)}var Nq;Nq=function(e,r,n){if(e!==null)if(e.memoizedProps!==r.pendingProps||To.current)Co=!0;else{if(!(e.lanes&n)&&!(r.flags&128))return Co=!1,lee(e,r,n);Co=!!(e.flags&131072)}else Co=!1,Ks&&r.flags&1048576&&A8(r,iN,r.index);switch(r.lanes=0,r.tag){case 2:var s=r.type;R1(e,r),e=r.pendingProps;var i=Dg(r,Ya.current);lg(r,n),i=kO(null,r,s,e,i,n);var l=TO();return r.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,Eo(s)?(l=!0,nN(r)):l=!1,r.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,NO(r),i.updater=s2,r.stateNode=i,i._reactInternals=r,aT(r,s,e,n),r=cT(null,r,s,!0,l,n)):(r.tag=0,Ks&&l&&gO(r),oo(null,r,i,n),r=r.child),r;case 16:s=r.elementType;e:{switch(R1(e,r),e=r.pendingProps,i=s._init,s=i(s._payload),r.type=s,i=r.tag=wee(s),e=dc(s,e),i){case 0:r=lT(null,r,s,e,n);break e;case 1:r=O3(null,r,s,e,n);break e;case 11:r=E3(null,r,s,e,n);break e;case 14:r=M3(null,r,s,dc(s.type,e),n);break e}throw Error(Zt(306,s,""))}return r;case 0:return s=r.type,i=r.pendingProps,i=r.elementType===s?i:dc(s,i),lT(e,r,s,i,n);case 1:return s=r.type,i=r.pendingProps,i=r.elementType===s?i:dc(s,i),O3(e,r,s,i,n);case 3:e:{if(oq(r),e===null)throw Error(Zt(387));s=r.pendingProps,l=r.memoizedState,i=l.element,I8(e,r),lN(r,s,null,n);var d=r.memoizedState;if(s=d.element,l.isDehydrated)if(l={element:s,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},r.updateQueue.baseState=l,r.memoizedState=l,r.flags&256){i=zg(Error(Zt(423)),r),r=I3(e,r,s,n,i);break e}else if(s!==i){i=zg(Error(Zt(424)),r),r=I3(e,r,s,n,i);break e}else for(tl=Zh(r.stateNode.containerInfo.firstChild),rl=r,Ks=!0,pc=null,n=M8(r,null,s,n),r.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Rg(),s===i){r=gu(e,r,n);break e}oo(e,r,s,n)}r=r.child}return r;case 5:return D8(r),e===null&&nT(r),s=r.type,i=r.pendingProps,l=e!==null?e.memoizedProps:null,d=i.children,Qk(s,i)?d=null:l!==null&&Qk(s,l)&&(r.flags|=32),aq(e,r),oo(e,r,d,n),r.child;case 6:return e===null&&nT(r),null;case 13:return lq(e,r,n);case 4:return SO(r,r.stateNode.containerInfo),s=r.pendingProps,e===null?r.child=Lg(r,null,s,n):oo(e,r,s,n),r.child;case 11:return s=r.type,i=r.pendingProps,i=r.elementType===s?i:dc(s,i),E3(e,r,s,i,n);case 7:return oo(e,r,r.pendingProps,n),r.child;case 8:return oo(e,r,r.pendingProps.children,n),r.child;case 12:return oo(e,r,r.pendingProps.children,n),r.child;case 10:e:{if(s=r.type._context,i=r.pendingProps,l=r.memoizedProps,d=i.value,Ps(aN,s._currentValue),s._currentValue=d,l!==null)if(Ac(l.value,d)){if(l.children===i.children&&!To.current){r=gu(e,r,n);break e}}else for(l=r.child,l!==null&&(l.return=r);l!==null;){var a=l.dependencies;if(a!==null){d=l.child;for(var f=a.firstContext;f!==null;){if(f.context===s){if(l.tag===1){f=cu(-1,n&-n),f.tag=2;var p=l.updateQueue;if(p!==null){p=p.shared;var y=p.pending;y===null?f.next=f:(f.next=y.next,y.next=f),p.pending=f}}l.lanes|=n,f=l.alternate,f!==null&&(f.lanes|=n),sT(l.return,n,r),a.lanes|=n;break}f=f.next}}else if(l.tag===10)d=l.type===r.type?null:l.child;else if(l.tag===18){if(d=l.return,d===null)throw Error(Zt(341));d.lanes|=n,a=d.alternate,a!==null&&(a.lanes|=n),sT(d,n,r),d=l.sibling}else d=l.child;if(d!==null)d.return=l;else for(d=l;d!==null;){if(d===r){d=null;break}if(l=d.sibling,l!==null){l.return=d.return,d=l;break}d=d.return}l=d}oo(e,r,i.children,n),r=r.child}return r;case 9:return i=r.type,s=r.pendingProps.children,lg(r,n),i=Ol(i),s=s(i),r.flags|=1,oo(e,r,s,n),r.child;case 14:return s=r.type,i=dc(s,r.pendingProps),i=dc(s.type,i),M3(e,r,s,i,n);case 15:return sq(e,r,r.type,r.pendingProps,n);case 17:return s=r.type,i=r.pendingProps,i=r.elementType===s?i:dc(s,i),R1(e,r),r.tag=1,Eo(s)?(e=!0,nN(r)):e=!1,lg(r,n),tq(r,s,i),aT(r,s,i,n),cT(null,r,s,!0,e,n);case 19:return cq(e,r,n);case 22:return iq(e,r,n)}throw Error(Zt(156,r.tag))};function Sq(e,r){return QB(e,r)}function jee(e,r,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Al(e,r,n,s){return new jee(e,r,n,s)}function $O(e){return e=e.prototype,!(!e||!e.isReactComponent)}function wee(e){if(typeof e=="function")return $O(e)?1:0;if(e!=null){if(e=e.$$typeof,e===iO)return 11;if(e===aO)return 14}return 2}function Jh(e,r){var n=e.alternate;return n===null?(n=Al(e.tag,r,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=r,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,r=e.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function z1(e,r,n,s,i,l){var d=2;if(s=e,typeof e=="function")$O(e)&&(d=1);else if(typeof e=="string")d=5;else e:switch(e){case Bx:return Bf(n.children,i,l,r);case sO:d=8,i|=8;break;case Tk:return e=Al(12,n,r,i|2),e.elementType=Tk,e.lanes=l,e;case Ek:return e=Al(13,n,r,i),e.elementType=Ek,e.lanes=l,e;case Mk:return e=Al(19,n,r,i),e.elementType=Mk,e.lanes=l,e;case DB:return o2(n,i,l,r);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case OB:d=10;break e;case IB:d=9;break e;case iO:d=11;break e;case aO:d=14;break e;case jh:d=16,s=null;break e}throw Error(Zt(130,e==null?e:typeof e,""))}return r=Al(d,n,r,i),r.elementType=e,r.type=s,r.lanes=l,r}function Bf(e,r,n,s){return e=Al(7,e,s,r),e.lanes=n,e}function o2(e,r,n,s){return e=Al(22,e,s,r),e.elementType=DB,e.lanes=n,e.stateNode={isHidden:!1},e}function _A(e,r,n){return e=Al(6,e,null,r),e.lanes=n,e}function bA(e,r,n){return r=Al(4,e.children!==null?e.children:[],e.key,r),r.lanes=n,r.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},r}function Nee(e,r,n,s,i){this.tag=r,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tA(0),this.expirationTimes=tA(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tA(0),this.identifierPrefix=s,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function BO(e,r,n,s,i,l,d,a,f){return e=new Nee(e,r,n,a,f),r===1?(r=1,l===!0&&(r|=8)):r=0,l=Al(3,null,null,r),e.current=l,l.stateNode=e,l.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},NO(l),e}function See(e,r,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$x,key:s==null?null:""+s,children:e,containerInfo:r,implementation:n}}function Pq(e){if(!e)return om;e=e._reactInternals;e:{if(hp(e)!==e||e.tag!==1)throw Error(Zt(170));var r=e;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(Eo(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(Zt(171))}if(e.tag===1){var n=e.type;if(Eo(n))return P8(e,n,r)}return r}function Cq(e,r,n,s,i,l,d,a,f){return e=BO(n,s,!0,e,i,l,d,a,f),e.context=Pq(null),n=e.current,s=fo(),i=Qh(n),l=cu(s,i),l.callback=r??null,Yh(n,l,i),e.current.lanes=i,Bb(e,i,s),Mo(e,s),e}function l2(e,r,n,s){var i=r.current,l=fo(),d=Qh(i);return n=Pq(n),r.context===null?r.context=n:r.pendingContext=n,r=cu(l,d),r.payload={element:e},s=s===void 0?null:s,s!==null&&(r.callback=s),e=Yh(i,r,d),e!==null&&(Nc(e,i,d,l),O1(e,i,d)),d}function xN(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function U3(e,r){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<r?n:r}}function qO(e,r){U3(e,r),(e=e.alternate)&&U3(e,r)}function Pee(){return null}var Aq=typeof reportError=="function"?reportError:function(e){console.error(e)};function VO(e){this._internalRoot=e}c2.prototype.render=VO.prototype.render=function(e){var r=this._internalRoot;if(r===null)throw Error(Zt(409));l2(e,r,null,null)};c2.prototype.unmount=VO.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var r=e.containerInfo;Zf(function(){l2(null,e,null,null)}),r[pu]=null}};function c2(e){this._internalRoot=e}c2.prototype.unstable_scheduleHydration=function(e){if(e){var r=i8();e={blockedOn:null,target:e,priority:r};for(var n=0;n<Ph.length&&r!==0&&r<Ph[n].priority;n++);Ph.splice(n,0,e),n===0&&o8(e)}};function UO(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function W3(){}function Cee(e,r,n,s,i){if(i){if(typeof s=="function"){var l=s;s=function(){var p=xN(d);l.call(p)}}var d=Cq(r,s,e,0,null,!1,!1,"",W3);return e._reactRootContainer=d,e[pu]=d.current,P_(e.nodeType===8?e.parentNode:e),Zf(),d}for(;i=e.lastChild;)e.removeChild(i);if(typeof s=="function"){var a=s;s=function(){var p=xN(f);a.call(p)}}var f=BO(e,0,!1,null,null,!1,!1,"",W3);return e._reactRootContainer=f,e[pu]=f.current,P_(e.nodeType===8?e.parentNode:e),Zf(function(){l2(r,f,n,s)}),f}function u2(e,r,n,s,i){var l=n._reactRootContainer;if(l){var d=l;if(typeof i=="function"){var a=i;i=function(){var f=xN(d);a.call(f)}}l2(r,d,e,i)}else d=Cee(n,r,e,i,s);return xN(d)}n8=function(e){switch(e.tag){case 3:var r=e.stateNode;if(r.current.memoizedState.isDehydrated){var n=K0(r.pendingLanes);n!==0&&(cO(r,n|1),Mo(r,Ni()),!(Fn&6)&&($g=Ni()+500,vm()))}break;case 13:Zf(function(){var s=xu(e,1);if(s!==null){var i=fo();Nc(s,e,1,i)}}),qO(e,1)}};dO=function(e){if(e.tag===13){var r=xu(e,134217728);if(r!==null){var n=fo();Nc(r,e,134217728,n)}qO(e,134217728)}};s8=function(e){if(e.tag===13){var r=Qh(e),n=xu(e,r);if(n!==null){var s=fo();Nc(n,e,r,s)}qO(e,r)}};i8=function(){return rs};a8=function(e,r){var n=rs;try{return rs=e,r()}finally{rs=n}};qk=function(e,r,n){switch(r){case"input":if(Dk(e,n),r=n.name,n.type==="radio"&&r!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<n.length;r++){var s=n[r];if(s!==e&&s.form===e.form){var i=t2(s);if(!i)throw Error(Zt(90));LB(s),Dk(s,i)}}}break;case"textarea":zB(e,n);break;case"select":r=n.value,r!=null&&sg(e,!!n.multiple,r,!1)}};GB=LO;KB=Zf;var Aee={usingClientEntryPoint:!1,Events:[Vb,Wx,t2,UB,WB,LO]},N0={findFiberByHostInstance:Nf,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},kee={bundleType:N0.bundleType,version:N0.version,rendererPackageName:N0.rendererPackageName,rendererConfig:N0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Tu.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=YB(e),e===null?null:e.stateNode},findFiberByHostInstance:N0.findFiberByHostInstance||Pee,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jw.isDisabled&&Jw.supportsFiber)try{XS=Jw.inject(kee),td=Jw}catch{}}cl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Aee;cl.createPortal=function(e,r){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!UO(r))throw Error(Zt(200));return See(e,r,null,n)};cl.createRoot=function(e,r){if(!UO(e))throw Error(Zt(299));var n=!1,s="",i=Aq;return r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),r=BO(e,1,!1,null,null,n,!1,s,i),e[pu]=r.current,P_(e.nodeType===8?e.parentNode:e),new VO(r)};cl.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var r=e._reactInternals;if(r===void 0)throw typeof e.render=="function"?Error(Zt(188)):(e=Object.keys(e).join(","),Error(Zt(268,e)));return e=YB(r),e=e===null?null:e.stateNode,e};cl.flushSync=function(e){return Zf(e)};cl.hydrate=function(e,r,n){if(!d2(r))throw Error(Zt(200));return u2(null,e,r,!0,n)};cl.hydrateRoot=function(e,r,n){if(!UO(e))throw Error(Zt(405));var s=n!=null&&n.hydratedSources||null,i=!1,l="",d=Aq;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(d=n.onRecoverableError)),r=Cq(r,null,e,1,n??null,i,!1,l,d),e[pu]=r.current,P_(e),s)for(e=0;e<s.length;e++)n=s[e],i=n._getVersion,i=i(n._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[n,i]:r.mutableSourceEagerHydrationData.push(n,i);return new c2(r)};cl.render=function(e,r,n){if(!d2(r))throw Error(Zt(200));return u2(null,e,r,!1,n)};cl.unmountComponentAtNode=function(e){if(!d2(e))throw Error(Zt(40));return e._reactRootContainer?(Zf(function(){u2(null,null,e,!1,function(){e._reactRootContainer=null,e[pu]=null})}),!0):!1};cl.unstable_batchedUpdates=LO;cl.unstable_renderSubtreeIntoContainer=function(e,r,n,s){if(!d2(n))throw Error(Zt(200));if(e==null||e._reactInternals===void 0)throw Error(Zt(38));return u2(e,r,n,!1,s)};cl.version="18.3.1-next-f1338f8080-20240426";function kq(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(kq)}catch(e){console.error(e)}}kq(),kB.exports=cl;var _m=kB.exports;const Tq=Vn(_m);var Eq,G3=_m;Eq=G3.createRoot,G3.hydrateRoot;var Ay=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Yf=typeof window>"u"||"Deno"in globalThis;function jl(){}function Tee(e,r){return typeof e=="function"?e(r):e}function bT(e){return typeof e=="number"&&e>=0&&e!==1/0}function Mq(e,r){return Math.max(e+(r||0)-Date.now(),0)}function dg(e,r){return typeof e=="function"?e(r):e}function xc(e,r){return typeof e=="function"?e(r):e}function K3(e,r){const{type:n="all",exact:s,fetchStatus:i,predicate:l,queryKey:d,stale:a}=e;if(d){if(s){if(r.queryHash!==WO(d,r.options))return!1}else if(!D_(r.queryKey,d))return!1}if(n!=="all"){const f=r.isActive();if(n==="active"&&!f||n==="inactive"&&f)return!1}return!(typeof a=="boolean"&&r.isStale()!==a||i&&i!==r.state.fetchStatus||l&&!l(r))}function H3(e,r){const{exact:n,status:s,predicate:i,mutationKey:l}=e;if(l){if(!r.options.mutationKey)return!1;if(n){if(Xf(r.options.mutationKey)!==Xf(l))return!1}else if(!D_(r.options.mutationKey,l))return!1}return!(s&&r.state.status!==s||i&&!i(r))}function WO(e,r){return((r==null?void 0:r.queryKeyHashFn)||Xf)(e)}function Xf(e){return JSON.stringify(e,(r,n)=>jT(n)?Object.keys(n).sort().reduce((s,i)=>(s[i]=n[i],s),{}):n)}function D_(e,r){return e===r?!0:typeof e!=typeof r?!1:e&&r&&typeof e=="object"&&typeof r=="object"?!Object.keys(r).some(n=>!D_(e[n],r[n])):!1}function Oq(e,r){if(e===r)return e;const n=Z3(e)&&Z3(r);if(n||jT(e)&&jT(r)){const s=n?e:Object.keys(e),i=s.length,l=n?r:Object.keys(r),d=l.length,a=n?[]:{};let f=0;for(let p=0;p<d;p++){const y=n?p:l[p];(!n&&s.includes(y)||n)&&e[y]===void 0&&r[y]===void 0?(a[y]=void 0,f++):(a[y]=Oq(e[y],r[y]),a[y]===e[y]&&e[y]!==void 0&&f++)}return i===d&&f===i?e:a}return r}function gN(e,r){if(!r||Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}function Z3(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function jT(e){if(!Y3(e))return!1;const r=e.constructor;if(r===void 0)return!0;const n=r.prototype;return!(!Y3(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Y3(e){return Object.prototype.toString.call(e)==="[object Object]"}function Eee(e){return new Promise(r=>{setTimeout(r,e)})}function wT(e,r,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,r):n.structuralSharing!==!1?Oq(e,r):r}function Mee(e,r,n=0){const s=[...e,r];return n&&s.length>n?s.slice(1):s}function Oee(e,r,n=0){const s=[r,...e];return n&&s.length>n?s.slice(0,-1):s}var GO=Symbol();function Iq(e,r){return!e.queryFn&&(r!=null&&r.initialPromise)?()=>r.initialPromise:!e.queryFn||e.queryFn===GO?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Of,Th,bg,aB,Iee=(aB=class extends Ay{constructor(){super();Vr(this,Of);Vr(this,Th);Vr(this,bg);vr(this,bg,r=>{if(!Yf&&window.addEventListener){const n=()=>r();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){Ze(this,Th)||this.setEventListener(Ze(this,bg))}onUnsubscribe(){var r;this.hasListeners()||((r=Ze(this,Th))==null||r.call(this),vr(this,Th,void 0))}setEventListener(r){var n;vr(this,bg,r),(n=Ze(this,Th))==null||n.call(this),vr(this,Th,r(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(r){Ze(this,Of)!==r&&(vr(this,Of,r),this.onFocus())}onFocus(){const r=this.isFocused();this.listeners.forEach(n=>{n(r)})}isFocused(){var r;return typeof Ze(this,Of)=="boolean"?Ze(this,Of):((r=globalThis.document)==null?void 0:r.visibilityState)!=="hidden"}},Of=new WeakMap,Th=new WeakMap,bg=new WeakMap,aB),KO=new Iee,jg,Eh,wg,oB,Dee=(oB=class extends Ay{constructor(){super();Vr(this,jg,!0);Vr(this,Eh);Vr(this,wg);vr(this,wg,r=>{if(!Yf&&window.addEventListener){const n=()=>r(!0),s=()=>r(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){Ze(this,Eh)||this.setEventListener(Ze(this,wg))}onUnsubscribe(){var r;this.hasListeners()||((r=Ze(this,Eh))==null||r.call(this),vr(this,Eh,void 0))}setEventListener(r){var n;vr(this,wg,r),(n=Ze(this,Eh))==null||n.call(this),vr(this,Eh,r(this.setOnline.bind(this)))}setOnline(r){Ze(this,jg)!==r&&(vr(this,jg,r),this.listeners.forEach(s=>{s(r)}))}isOnline(){return Ze(this,jg)}},jg=new WeakMap,Eh=new WeakMap,wg=new WeakMap,oB),yN=new Dee;function NT(){let e,r;const n=new Promise((i,l)=>{e=i,r=l});n.status="pending",n.catch(()=>{});function s(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{s({status:"fulfilled",value:i}),e(i)},n.reject=i=>{s({status:"rejected",reason:i}),r(i)},n}function Ree(e){return Math.min(1e3*2**e,3e4)}function Dq(e){return(e??"online")==="online"?yN.isOnline():!0}var Rq=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function jA(e){return e instanceof Rq}function Lq(e){let r=!1,n=0,s=!1,i;const l=NT(),d=S=>{var R;s||(j(new Rq(S)),(R=e.abort)==null||R.call(e))},a=()=>{r=!0},f=()=>{r=!1},p=()=>KO.isFocused()&&(e.networkMode==="always"||yN.isOnline())&&e.canRun(),y=()=>Dq(e.networkMode)&&e.canRun(),v=S=>{var R;s||(s=!0,(R=e.onSuccess)==null||R.call(e,S),i==null||i(),l.resolve(S))},j=S=>{var R;s||(s=!0,(R=e.onError)==null||R.call(e,S),i==null||i(),l.reject(S))},w=()=>new Promise(S=>{var R;i=D=>{(s||p())&&S(D)},(R=e.onPause)==null||R.call(e)}).then(()=>{var S;i=void 0,s||(S=e.onContinue)==null||S.call(e)}),k=()=>{if(s)return;let S;const R=n===0?e.initialPromise:void 0;try{S=R??e.fn()}catch(D){S=Promise.reject(D)}Promise.resolve(S).then(v).catch(D=>{var W;if(s)return;const T=e.retry??(Yf?0:3),I=e.retryDelay??Ree,L=typeof I=="function"?I(n,D):I,$=T===!0||typeof T=="number"&&n<T||typeof T=="function"&&T(n,D);if(r||!$){j(D);return}n++,(W=e.onFail)==null||W.call(e,n,D),Eee(L).then(()=>p()?void 0:w()).then(()=>{r?j(D):k()})})};return{promise:l,cancel:d,continue:()=>(i==null||i(),l),cancelRetry:a,continueRetry:f,canStart:y,start:()=>(y()?k():w().then(k),l)}}function Lee(){let e=[],r=0,n=a=>{a()},s=a=>{a()},i=a=>setTimeout(a,0);const l=a=>{r?e.push(a):i(()=>{n(a)})},d=()=>{const a=e;e=[],a.length&&i(()=>{s(()=>{a.forEach(f=>{n(f)})})})};return{batch:a=>{let f;r++;try{f=a()}finally{r--,r||d()}return f},batchCalls:a=>(...f)=>{l(()=>{a(...f)})},schedule:l,setNotifyFunction:a=>{n=a},setBatchNotifyFunction:a=>{s=a},setScheduler:a=>{i=a}}}var Yi=Lee(),If,lB,Fq=(lB=class{constructor(){Vr(this,If)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),bT(this.gcTime)&&vr(this,If,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Yf?1/0:5*60*1e3))}clearGcTimeout(){Ze(this,If)&&(clearTimeout(Ze(this,If)),vr(this,If,void 0))}},If=new WeakMap,lB),Ng,Sg,bl,qa,Rb,Df,uc,Xd,cB,Fee=(cB=class extends Fq{constructor(r){super();Vr(this,uc);Vr(this,Ng);Vr(this,Sg);Vr(this,bl);Vr(this,qa);Vr(this,Rb);Vr(this,Df);vr(this,Df,!1),vr(this,Rb,r.defaultOptions),this.setOptions(r.options),this.observers=[],vr(this,bl,r.cache),this.queryKey=r.queryKey,this.queryHash=r.queryHash,vr(this,Ng,zee(this.options)),this.state=r.state??Ze(this,Ng),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var r;return(r=Ze(this,qa))==null?void 0:r.promise}setOptions(r){this.options={...Ze(this,Rb),...r},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Ze(this,bl).remove(this)}setData(r,n){const s=wT(this.state.data,r,this.options);return xn(this,uc,Xd).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(r,n){xn(this,uc,Xd).call(this,{type:"setState",state:r,setStateOptions:n})}cancel(r){var s,i;const n=(s=Ze(this,qa))==null?void 0:s.promise;return(i=Ze(this,qa))==null||i.cancel(r),n?n.then(jl).catch(jl):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Ze(this,Ng))}isActive(){return this.observers.some(r=>xc(r.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===GO||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(r=>r.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(r=0){return this.state.isInvalidated||this.state.data===void 0||!Mq(this.state.dataUpdatedAt,r)}onFocus(){var n;const r=this.observers.find(s=>s.shouldFetchOnWindowFocus());r==null||r.refetch({cancelRefetch:!1}),(n=Ze(this,qa))==null||n.continue()}onOnline(){var n;const r=this.observers.find(s=>s.shouldFetchOnReconnect());r==null||r.refetch({cancelRefetch:!1}),(n=Ze(this,qa))==null||n.continue()}addObserver(r){this.observers.includes(r)||(this.observers.push(r),this.clearGcTimeout(),Ze(this,bl).notify({type:"observerAdded",query:this,observer:r}))}removeObserver(r){this.observers.includes(r)&&(this.observers=this.observers.filter(n=>n!==r),this.observers.length||(Ze(this,qa)&&(Ze(this,Df)?Ze(this,qa).cancel({revert:!0}):Ze(this,qa).cancelRetry()),this.scheduleGc()),Ze(this,bl).notify({type:"observerRemoved",query:this,observer:r}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||xn(this,uc,Xd).call(this,{type:"invalidate"})}fetch(r,n){var f,p,y;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(Ze(this,qa))return Ze(this,qa).continueRetry(),Ze(this,qa).promise}if(r&&this.setOptions(r),!this.options.queryFn){const v=this.observers.find(j=>j.options.queryFn);v&&this.setOptions(v.options)}const s=new AbortController,i=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(vr(this,Df,!0),s.signal)})},l=()=>{const v=Iq(this.options,n),j={queryKey:this.queryKey,meta:this.meta};return i(j),vr(this,Df,!1),this.options.persister?this.options.persister(v,j,this):v(j)},d={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:l};i(d),(f=this.options.behavior)==null||f.onFetch(d,this),vr(this,Sg,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((p=d.fetchOptions)==null?void 0:p.meta))&&xn(this,uc,Xd).call(this,{type:"fetch",meta:(y=d.fetchOptions)==null?void 0:y.meta});const a=v=>{var j,w,k,S;jA(v)&&v.silent||xn(this,uc,Xd).call(this,{type:"error",error:v}),jA(v)||((w=(j=Ze(this,bl).config).onError)==null||w.call(j,v,this),(S=(k=Ze(this,bl).config).onSettled)==null||S.call(k,this.state.data,v,this)),this.scheduleGc()};return vr(this,qa,Lq({initialPromise:n==null?void 0:n.initialPromise,fn:d.fetchFn,abort:s.abort.bind(s),onSuccess:v=>{var j,w,k,S;if(v===void 0){a(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(v)}catch(R){a(R);return}(w=(j=Ze(this,bl).config).onSuccess)==null||w.call(j,v,this),(S=(k=Ze(this,bl).config).onSettled)==null||S.call(k,v,this.state.error,this),this.scheduleGc()},onError:a,onFail:(v,j)=>{xn(this,uc,Xd).call(this,{type:"failed",failureCount:v,error:j})},onPause:()=>{xn(this,uc,Xd).call(this,{type:"pause"})},onContinue:()=>{xn(this,uc,Xd).call(this,{type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0})),Ze(this,qa).start()}},Ng=new WeakMap,Sg=new WeakMap,bl=new WeakMap,qa=new WeakMap,Rb=new WeakMap,Df=new WeakMap,uc=new WeakSet,Xd=function(r){const n=s=>{switch(r.type){case"failed":return{...s,fetchFailureCount:r.failureCount,fetchFailureReason:r.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...zq(s.data,this.options),fetchMeta:r.meta??null};case"success":return{...s,data:r.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:r.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!r.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const i=r.error;return jA(i)&&i.revert&&Ze(this,Sg)?{...Ze(this,Sg),fetchStatus:"idle"}:{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...r.state}}};this.state=n(this.state),Yi.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),Ze(this,bl).notify({query:this,type:"updated",action:r})})},cB);function zq(e,r){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Dq(r.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function zee(e){const r=typeof e.initialData=="function"?e.initialData():e.initialData,n=r!==void 0,s=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:r,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Gc,dB,$ee=(dB=class extends Ay{constructor(r={}){super();Vr(this,Gc);this.config=r,vr(this,Gc,new Map)}build(r,n,s){const i=n.queryKey,l=n.queryHash??WO(i,n);let d=this.get(l);return d||(d=new Fee({cache:this,queryKey:i,queryHash:l,options:r.defaultQueryOptions(n),state:s,defaultOptions:r.getQueryDefaults(i)}),this.add(d)),d}add(r){Ze(this,Gc).has(r.queryHash)||(Ze(this,Gc).set(r.queryHash,r),this.notify({type:"added",query:r}))}remove(r){const n=Ze(this,Gc).get(r.queryHash);n&&(r.destroy(),n===r&&Ze(this,Gc).delete(r.queryHash),this.notify({type:"removed",query:r}))}clear(){Yi.batch(()=>{this.getAll().forEach(r=>{this.remove(r)})})}get(r){return Ze(this,Gc).get(r)}getAll(){return[...Ze(this,Gc).values()]}find(r){const n={exact:!0,...r};return this.getAll().find(s=>K3(n,s))}findAll(r={}){const n=this.getAll();return Object.keys(r).length>0?n.filter(s=>K3(r,s)):n}notify(r){Yi.batch(()=>{this.listeners.forEach(n=>{n(r)})})}onFocus(){Yi.batch(()=>{this.getAll().forEach(r=>{r.onFocus()})})}onOnline(){Yi.batch(()=>{this.getAll().forEach(r=>{r.onOnline()})})}},Gc=new WeakMap,dB),Kc,so,Rf,Hc,yh,uB,Bee=(uB=class extends Fq{constructor(r){super();Vr(this,Hc);Vr(this,Kc);Vr(this,so);Vr(this,Rf);this.mutationId=r.mutationId,vr(this,so,r.mutationCache),vr(this,Kc,[]),this.state=r.state||$q(),this.setOptions(r.options),this.scheduleGc()}setOptions(r){this.options=r,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(r){Ze(this,Kc).includes(r)||(Ze(this,Kc).push(r),this.clearGcTimeout(),Ze(this,so).notify({type:"observerAdded",mutation:this,observer:r}))}removeObserver(r){vr(this,Kc,Ze(this,Kc).filter(n=>n!==r)),this.scheduleGc(),Ze(this,so).notify({type:"observerRemoved",mutation:this,observer:r})}optionalRemove(){Ze(this,Kc).length||(this.state.status==="pending"?this.scheduleGc():Ze(this,so).remove(this))}continue(){var r;return((r=Ze(this,Rf))==null?void 0:r.continue())??this.execute(this.state.variables)}async execute(r){var i,l,d,a,f,p,y,v,j,w,k,S,R,D,T,I,L,$,W,Z;vr(this,Rf,Lq({fn:()=>this.options.mutationFn?this.options.mutationFn(r):Promise.reject(new Error("No mutationFn found")),onFail:(oe,te)=>{xn(this,Hc,yh).call(this,{type:"failed",failureCount:oe,error:te})},onPause:()=>{xn(this,Hc,yh).call(this,{type:"pause"})},onContinue:()=>{xn(this,Hc,yh).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Ze(this,so).canRun(this)}));const n=this.state.status==="pending",s=!Ze(this,Rf).canStart();try{if(!n){xn(this,Hc,yh).call(this,{type:"pending",variables:r,isPaused:s}),await((l=(i=Ze(this,so).config).onMutate)==null?void 0:l.call(i,r,this));const te=await((a=(d=this.options).onMutate)==null?void 0:a.call(d,r));te!==this.state.context&&xn(this,Hc,yh).call(this,{type:"pending",context:te,variables:r,isPaused:s})}const oe=await Ze(this,Rf).start();return await((p=(f=Ze(this,so).config).onSuccess)==null?void 0:p.call(f,oe,r,this.state.context,this)),await((v=(y=this.options).onSuccess)==null?void 0:v.call(y,oe,r,this.state.context)),await((w=(j=Ze(this,so).config).onSettled)==null?void 0:w.call(j,oe,null,this.state.variables,this.state.context,this)),await((S=(k=this.options).onSettled)==null?void 0:S.call(k,oe,null,r,this.state.context)),xn(this,Hc,yh).call(this,{type:"success",data:oe}),oe}catch(oe){try{throw await((D=(R=Ze(this,so).config).onError)==null?void 0:D.call(R,oe,r,this.state.context,this)),await((I=(T=this.options).onError)==null?void 0:I.call(T,oe,r,this.state.context)),await(($=(L=Ze(this,so).config).onSettled)==null?void 0:$.call(L,void 0,oe,this.state.variables,this.state.context,this)),await((Z=(W=this.options).onSettled)==null?void 0:Z.call(W,void 0,oe,r,this.state.context)),oe}finally{xn(this,Hc,yh).call(this,{type:"error",error:oe})}}finally{Ze(this,so).runNext(this)}}},Kc=new WeakMap,so=new WeakMap,Rf=new WeakMap,Hc=new WeakSet,yh=function(r){const n=s=>{switch(r.type){case"failed":return{...s,failureCount:r.failureCount,failureReason:r.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:r.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:r.isPaused,status:"pending",variables:r.variables,submittedAt:Date.now()};case"success":return{...s,data:r.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:r.error,failureCount:s.failureCount+1,failureReason:r.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Yi.batch(()=>{Ze(this,Kc).forEach(s=>{s.onMutationUpdate(r)}),Ze(this,so).notify({mutation:this,type:"updated",action:r})})},uB);function $q(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ho,Lb,hB,qee=(hB=class extends Ay{constructor(r={}){super();Vr(this,Ho);Vr(this,Lb);this.config=r,vr(this,Ho,new Map),vr(this,Lb,Date.now())}build(r,n,s){const i=new Bee({mutationCache:this,mutationId:++Rw(this,Lb)._,options:r.defaultMutationOptions(n),state:s});return this.add(i),i}add(r){const n=e1(r),s=Ze(this,Ho).get(n)??[];s.push(r),Ze(this,Ho).set(n,s),this.notify({type:"added",mutation:r})}remove(r){var s;const n=e1(r);if(Ze(this,Ho).has(n)){const i=(s=Ze(this,Ho).get(n))==null?void 0:s.filter(l=>l!==r);i&&(i.length===0?Ze(this,Ho).delete(n):Ze(this,Ho).set(n,i))}this.notify({type:"removed",mutation:r})}canRun(r){var s;const n=(s=Ze(this,Ho).get(e1(r)))==null?void 0:s.find(i=>i.state.status==="pending");return!n||n===r}runNext(r){var s;const n=(s=Ze(this,Ho).get(e1(r)))==null?void 0:s.find(i=>i!==r&&i.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}clear(){Yi.batch(()=>{this.getAll().forEach(r=>{this.remove(r)})})}getAll(){return[...Ze(this,Ho).values()].flat()}find(r){const n={exact:!0,...r};return this.getAll().find(s=>H3(n,s))}findAll(r={}){return this.getAll().filter(n=>H3(r,n))}notify(r){Yi.batch(()=>{this.listeners.forEach(n=>{n(r)})})}resumePausedMutations(){const r=this.getAll().filter(n=>n.state.isPaused);return Yi.batch(()=>Promise.all(r.map(n=>n.continue().catch(jl))))}},Ho=new WeakMap,Lb=new WeakMap,hB);function e1(e){var r;return((r=e.options.scope)==null?void 0:r.id)??String(e.mutationId)}function X3(e){return{onFetch:(r,n)=>{var y,v,j,w,k;const s=r.options,i=(j=(v=(y=r.fetchOptions)==null?void 0:y.meta)==null?void 0:v.fetchMore)==null?void 0:j.direction,l=((w=r.state.data)==null?void 0:w.pages)||[],d=((k=r.state.data)==null?void 0:k.pageParams)||[];let a={pages:[],pageParams:[]},f=0;const p=async()=>{let S=!1;const R=I=>{Object.defineProperty(I,"signal",{enumerable:!0,get:()=>(r.signal.aborted?S=!0:r.signal.addEventListener("abort",()=>{S=!0}),r.signal)})},D=Iq(r.options,r.fetchOptions),T=async(I,L,$)=>{if(S)return Promise.reject();if(L==null&&I.pages.length)return Promise.resolve(I);const W={queryKey:r.queryKey,pageParam:L,direction:$?"backward":"forward",meta:r.options.meta};R(W);const Z=await D(W),{maxPages:oe}=r.options,te=$?Oee:Mee;return{pages:te(I.pages,Z,oe),pageParams:te(I.pageParams,L,oe)}};if(i&&l.length){const I=i==="backward",L=I?Vee:Q3,$={pages:l,pageParams:d},W=L(s,$);a=await T($,W,I)}else{const I=e??l.length;do{const L=f===0?d[0]??s.initialPageParam:Q3(s,a);if(f>0&&L==null)break;a=await T(a,L),f++}while(f<I)}return a};r.options.persister?r.fetchFn=()=>{var S,R;return(R=(S=r.options).persister)==null?void 0:R.call(S,p,{queryKey:r.queryKey,meta:r.options.meta,signal:r.signal},n)}:r.fetchFn=p}}}function Q3(e,{pages:r,pageParams:n}){const s=r.length-1;return r.length>0?e.getNextPageParam(r[s],r,n[s],n):void 0}function Vee(e,{pages:r,pageParams:n}){var s;return r.length>0?(s=e.getPreviousPageParam)==null?void 0:s.call(e,r[0],r,n[0],n):void 0}var pi,Mh,Oh,Pg,Cg,Ih,Ag,kg,mB,Uee=(mB=class{constructor(e={}){Vr(this,pi);Vr(this,Mh);Vr(this,Oh);Vr(this,Pg);Vr(this,Cg);Vr(this,Ih);Vr(this,Ag);Vr(this,kg);vr(this,pi,e.queryCache||new $ee),vr(this,Mh,e.mutationCache||new qee),vr(this,Oh,e.defaultOptions||{}),vr(this,Pg,new Map),vr(this,Cg,new Map),vr(this,Ih,0)}mount(){Rw(this,Ih)._++,Ze(this,Ih)===1&&(vr(this,Ag,KO.subscribe(async e=>{e&&(await this.resumePausedMutations(),Ze(this,pi).onFocus())})),vr(this,kg,yN.subscribe(async e=>{e&&(await this.resumePausedMutations(),Ze(this,pi).onOnline())})))}unmount(){var e,r;Rw(this,Ih)._--,Ze(this,Ih)===0&&((e=Ze(this,Ag))==null||e.call(this),vr(this,Ag,void 0),(r=Ze(this,kg))==null||r.call(this),vr(this,kg,void 0))}isFetching(e){return Ze(this,pi).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Ze(this,Mh).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const r=this.defaultQueryOptions({queryKey:e});return(n=Ze(this,pi).get(r.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const r=this.getQueryData(e.queryKey);if(r===void 0)return this.fetchQuery(e);{const n=this.defaultQueryOptions(e),s=Ze(this,pi).build(this,n);return e.revalidateIfStale&&s.isStaleByTime(dg(n.staleTime,s))&&this.prefetchQuery(n),Promise.resolve(r)}}getQueriesData(e){return Ze(this,pi).findAll(e).map(({queryKey:r,state:n})=>{const s=n.data;return[r,s]})}setQueryData(e,r,n){const s=this.defaultQueryOptions({queryKey:e}),i=Ze(this,pi).get(s.queryHash),l=i==null?void 0:i.state.data,d=Tee(r,l);if(d!==void 0)return Ze(this,pi).build(this,s).setData(d,{...n,manual:!0})}setQueriesData(e,r,n){return Yi.batch(()=>Ze(this,pi).findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,r,n)]))}getQueryState(e){var n;const r=this.defaultQueryOptions({queryKey:e});return(n=Ze(this,pi).get(r.queryHash))==null?void 0:n.state}removeQueries(e){const r=Ze(this,pi);Yi.batch(()=>{r.findAll(e).forEach(n=>{r.remove(n)})})}resetQueries(e,r){const n=Ze(this,pi),s={type:"active",...e};return Yi.batch(()=>(n.findAll(e).forEach(i=>{i.reset()}),this.refetchQueries(s,r)))}cancelQueries(e={},r={}){const n={revert:!0,...r},s=Yi.batch(()=>Ze(this,pi).findAll(e).map(i=>i.cancel(n)));return Promise.all(s).then(jl).catch(jl)}invalidateQueries(e={},r={}){return Yi.batch(()=>{if(Ze(this,pi).findAll(e).forEach(s=>{s.invalidate()}),e.refetchType==="none")return Promise.resolve();const n={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(n,r)})}refetchQueries(e={},r){const n={...r,cancelRefetch:(r==null?void 0:r.cancelRefetch)??!0},s=Yi.batch(()=>Ze(this,pi).findAll(e).filter(i=>!i.isDisabled()).map(i=>{let l=i.fetch(void 0,n);return n.throwOnError||(l=l.catch(jl)),i.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(s).then(jl)}fetchQuery(e){const r=this.defaultQueryOptions(e);r.retry===void 0&&(r.retry=!1);const n=Ze(this,pi).build(this,r);return n.isStaleByTime(dg(r.staleTime,n))?n.fetch(r):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(jl).catch(jl)}fetchInfiniteQuery(e){return e.behavior=X3(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(jl).catch(jl)}ensureInfiniteQueryData(e){return e.behavior=X3(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return yN.isOnline()?Ze(this,Mh).resumePausedMutations():Promise.resolve()}getQueryCache(){return Ze(this,pi)}getMutationCache(){return Ze(this,Mh)}getDefaultOptions(){return Ze(this,Oh)}setDefaultOptions(e){vr(this,Oh,e)}setQueryDefaults(e,r){Ze(this,Pg).set(Xf(e),{queryKey:e,defaultOptions:r})}getQueryDefaults(e){const r=[...Ze(this,Pg).values()];let n={};return r.forEach(s=>{D_(e,s.queryKey)&&(n={...n,...s.defaultOptions})}),n}setMutationDefaults(e,r){Ze(this,Cg).set(Xf(e),{mutationKey:e,defaultOptions:r})}getMutationDefaults(e){const r=[...Ze(this,Cg).values()];let n={};return r.forEach(s=>{D_(e,s.mutationKey)&&(n={...n,...s.defaultOptions})}),n}defaultQueryOptions(e){if(e._defaulted)return e;const r={...Ze(this,Oh).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return r.queryHash||(r.queryHash=WO(r.queryKey,r)),r.refetchOnReconnect===void 0&&(r.refetchOnReconnect=r.networkMode!=="always"),r.throwOnError===void 0&&(r.throwOnError=!!r.suspense),!r.networkMode&&r.persister&&(r.networkMode="offlineFirst"),r.enabled!==!0&&r.queryFn===GO&&(r.enabled=!1),r}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Ze(this,Oh).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Ze(this,pi).clear(),Ze(this,Mh).clear()}},pi=new WeakMap,Mh=new WeakMap,Oh=new WeakMap,Pg=new WeakMap,Cg=new WeakMap,Ih=new WeakMap,Ag=new WeakMap,kg=new WeakMap,mB),bo,Tn,Fb,io,Lf,Tg,Dh,Zc,zb,Eg,Mg,Ff,zf,Rh,Og,Zn,Z0,ST,PT,CT,AT,kT,TT,ET,Bq,fB,Wee=(fB=class extends Ay{constructor(r,n){super();Vr(this,Zn);Vr(this,bo);Vr(this,Tn);Vr(this,Fb);Vr(this,io);Vr(this,Lf);Vr(this,Tg);Vr(this,Dh);Vr(this,Zc);Vr(this,zb);Vr(this,Eg);Vr(this,Mg);Vr(this,Ff);Vr(this,zf);Vr(this,Rh);Vr(this,Og,new Set);this.options=n,vr(this,bo,r),vr(this,Zc,null),vr(this,Dh,NT()),this.options.experimental_prefetchInRender||Ze(this,Dh).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(Ze(this,Tn).addObserver(this),J3(Ze(this,Tn),this.options)?xn(this,Zn,Z0).call(this):this.updateResult(),xn(this,Zn,AT).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return MT(Ze(this,Tn),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return MT(Ze(this,Tn),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,xn(this,Zn,kT).call(this),xn(this,Zn,TT).call(this),Ze(this,Tn).removeObserver(this)}setOptions(r,n){const s=this.options,i=Ze(this,Tn);if(this.options=Ze(this,bo).defaultQueryOptions(r),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof xc(this.options.enabled,Ze(this,Tn))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");xn(this,Zn,ET).call(this),Ze(this,Tn).setOptions(this.options),s._defaulted&&!gN(this.options,s)&&Ze(this,bo).getQueryCache().notify({type:"observerOptionsUpdated",query:Ze(this,Tn),observer:this});const l=this.hasListeners();l&&eL(Ze(this,Tn),i,this.options,s)&&xn(this,Zn,Z0).call(this),this.updateResult(n),l&&(Ze(this,Tn)!==i||xc(this.options.enabled,Ze(this,Tn))!==xc(s.enabled,Ze(this,Tn))||dg(this.options.staleTime,Ze(this,Tn))!==dg(s.staleTime,Ze(this,Tn)))&&xn(this,Zn,ST).call(this);const d=xn(this,Zn,PT).call(this);l&&(Ze(this,Tn)!==i||xc(this.options.enabled,Ze(this,Tn))!==xc(s.enabled,Ze(this,Tn))||d!==Ze(this,Rh))&&xn(this,Zn,CT).call(this,d)}getOptimisticResult(r){const n=Ze(this,bo).getQueryCache().build(Ze(this,bo),r),s=this.createResult(n,r);return Kee(this,s)&&(vr(this,io,s),vr(this,Tg,this.options),vr(this,Lf,Ze(this,Tn).state)),s}getCurrentResult(){return Ze(this,io)}trackResult(r,n){const s={};return Object.keys(r).forEach(i=>{Object.defineProperty(s,i,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(i),n==null||n(i),r[i])})}),s}trackProp(r){Ze(this,Og).add(r)}getCurrentQuery(){return Ze(this,Tn)}refetch({...r}={}){return this.fetch({...r})}fetchOptimistic(r){const n=Ze(this,bo).defaultQueryOptions(r),s=Ze(this,bo).getQueryCache().build(Ze(this,bo),n);return s.fetch().then(()=>this.createResult(s,n))}fetch(r){return xn(this,Zn,Z0).call(this,{...r,cancelRefetch:r.cancelRefetch??!0}).then(()=>(this.updateResult(),Ze(this,io)))}createResult(r,n){var oe;const s=Ze(this,Tn),i=this.options,l=Ze(this,io),d=Ze(this,Lf),a=Ze(this,Tg),p=r!==s?r.state:Ze(this,Fb),{state:y}=r;let v={...y},j=!1,w;if(n._optimisticResults){const te=this.hasListeners(),be=!te&&J3(r,n),ie=te&&eL(r,s,n,i);(be||ie)&&(v={...v,...zq(y.data,r.options)}),n._optimisticResults==="isRestoring"&&(v.fetchStatus="idle")}let{error:k,errorUpdatedAt:S,status:R}=v;if(n.select&&v.data!==void 0)if(l&&v.data===(d==null?void 0:d.data)&&n.select===Ze(this,zb))w=Ze(this,Eg);else try{vr(this,zb,n.select),w=n.select(v.data),w=wT(l==null?void 0:l.data,w,n),vr(this,Eg,w),vr(this,Zc,null)}catch(te){vr(this,Zc,te)}else w=v.data;if(n.placeholderData!==void 0&&w===void 0&&R==="pending"){let te;if(l!=null&&l.isPlaceholderData&&n.placeholderData===(a==null?void 0:a.placeholderData))te=l.data;else if(te=typeof n.placeholderData=="function"?n.placeholderData((oe=Ze(this,Mg))==null?void 0:oe.state.data,Ze(this,Mg)):n.placeholderData,n.select&&te!==void 0)try{te=n.select(te),vr(this,Zc,null)}catch(be){vr(this,Zc,be)}te!==void 0&&(R="success",w=wT(l==null?void 0:l.data,te,n),j=!0)}Ze(this,Zc)&&(k=Ze(this,Zc),w=Ze(this,Eg),S=Date.now(),R="error");const D=v.fetchStatus==="fetching",T=R==="pending",I=R==="error",L=T&&D,$=w!==void 0,Z={status:R,fetchStatus:v.fetchStatus,isPending:T,isSuccess:R==="success",isError:I,isInitialLoading:L,isLoading:L,data:w,dataUpdatedAt:v.dataUpdatedAt,error:k,errorUpdatedAt:S,failureCount:v.fetchFailureCount,failureReason:v.fetchFailureReason,errorUpdateCount:v.errorUpdateCount,isFetched:v.dataUpdateCount>0||v.errorUpdateCount>0,isFetchedAfterMount:v.dataUpdateCount>p.dataUpdateCount||v.errorUpdateCount>p.errorUpdateCount,isFetching:D,isRefetching:D&&!T,isLoadingError:I&&!$,isPaused:v.fetchStatus==="paused",isPlaceholderData:j,isRefetchError:I&&$,isStale:HO(r,n),refetch:this.refetch,promise:Ze(this,Dh)};if(this.options.experimental_prefetchInRender){const te=ge=>{Z.status==="error"?ge.reject(Z.error):Z.data!==void 0&&ge.resolve(Z.data)},be=()=>{const ge=vr(this,Dh,Z.promise=NT());te(ge)},ie=Ze(this,Dh);switch(ie.status){case"pending":r.queryHash===s.queryHash&&te(ie);break;case"fulfilled":(Z.status==="error"||Z.data!==ie.value)&&be();break;case"rejected":(Z.status!=="error"||Z.error!==ie.reason)&&be();break}}return Z}updateResult(r){const n=Ze(this,io),s=this.createResult(Ze(this,Tn),this.options);if(vr(this,Lf,Ze(this,Tn).state),vr(this,Tg,this.options),Ze(this,Lf).data!==void 0&&vr(this,Mg,Ze(this,Tn)),gN(s,n))return;vr(this,io,s);const i={},l=()=>{if(!n)return!0;const{notifyOnChangeProps:d}=this.options,a=typeof d=="function"?d():d;if(a==="all"||!a&&!Ze(this,Og).size)return!0;const f=new Set(a??Ze(this,Og));return this.options.throwOnError&&f.add("error"),Object.keys(Ze(this,io)).some(p=>{const y=p;return Ze(this,io)[y]!==n[y]&&f.has(y)})};(r==null?void 0:r.listeners)!==!1&&l()&&(i.listeners=!0),xn(this,Zn,Bq).call(this,{...i,...r})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&xn(this,Zn,AT).call(this)}},bo=new WeakMap,Tn=new WeakMap,Fb=new WeakMap,io=new WeakMap,Lf=new WeakMap,Tg=new WeakMap,Dh=new WeakMap,Zc=new WeakMap,zb=new WeakMap,Eg=new WeakMap,Mg=new WeakMap,Ff=new WeakMap,zf=new WeakMap,Rh=new WeakMap,Og=new WeakMap,Zn=new WeakSet,Z0=function(r){xn(this,Zn,ET).call(this);let n=Ze(this,Tn).fetch(this.options,r);return r!=null&&r.throwOnError||(n=n.catch(jl)),n},ST=function(){xn(this,Zn,kT).call(this);const r=dg(this.options.staleTime,Ze(this,Tn));if(Yf||Ze(this,io).isStale||!bT(r))return;const s=Mq(Ze(this,io).dataUpdatedAt,r)+1;vr(this,Ff,setTimeout(()=>{Ze(this,io).isStale||this.updateResult()},s))},PT=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(Ze(this,Tn)):this.options.refetchInterval)??!1},CT=function(r){xn(this,Zn,TT).call(this),vr(this,Rh,r),!(Yf||xc(this.options.enabled,Ze(this,Tn))===!1||!bT(Ze(this,Rh))||Ze(this,Rh)===0)&&vr(this,zf,setInterval(()=>{(this.options.refetchIntervalInBackground||KO.isFocused())&&xn(this,Zn,Z0).call(this)},Ze(this,Rh)))},AT=function(){xn(this,Zn,ST).call(this),xn(this,Zn,CT).call(this,xn(this,Zn,PT).call(this))},kT=function(){Ze(this,Ff)&&(clearTimeout(Ze(this,Ff)),vr(this,Ff,void 0))},TT=function(){Ze(this,zf)&&(clearInterval(Ze(this,zf)),vr(this,zf,void 0))},ET=function(){const r=Ze(this,bo).getQueryCache().build(Ze(this,bo),this.options);if(r===Ze(this,Tn))return;const n=Ze(this,Tn);vr(this,Tn,r),vr(this,Fb,r.state),this.hasListeners()&&(n==null||n.removeObserver(this),r.addObserver(this))},Bq=function(r){Yi.batch(()=>{r.listeners&&this.listeners.forEach(n=>{n(Ze(this,io))}),Ze(this,bo).getQueryCache().notify({query:Ze(this,Tn),type:"observerResultsUpdated"})})},fB);function Gee(e,r){return xc(r.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&r.retryOnMount===!1)}function J3(e,r){return Gee(e,r)||e.state.data!==void 0&&MT(e,r,r.refetchOnMount)}function MT(e,r,n){if(xc(r.enabled,e)!==!1){const s=typeof n=="function"?n(e):n;return s==="always"||s!==!1&&HO(e,r)}return!1}function eL(e,r,n,s){return(e!==r||xc(s.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&HO(e,n)}function HO(e,r){return xc(r.enabled,e)!==!1&&e.isStaleByTime(dg(r.staleTime,e))}function Kee(e,r){return!gN(e.getCurrentResult(),r)}var Lh,Fh,jo,tu,mu,$1,OT,pB,Hee=(pB=class extends Ay{constructor(n,s){super();Vr(this,mu);Vr(this,Lh);Vr(this,Fh);Vr(this,jo);Vr(this,tu);vr(this,Lh,n),this.setOptions(s),this.bindMethods(),xn(this,mu,$1).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var i;const s=this.options;this.options=Ze(this,Lh).defaultMutationOptions(n),gN(this.options,s)||Ze(this,Lh).getMutationCache().notify({type:"observerOptionsUpdated",mutation:Ze(this,jo),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&Xf(s.mutationKey)!==Xf(this.options.mutationKey)?this.reset():((i=Ze(this,jo))==null?void 0:i.state.status)==="pending"&&Ze(this,jo).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=Ze(this,jo))==null||n.removeObserver(this)}onMutationUpdate(n){xn(this,mu,$1).call(this),xn(this,mu,OT).call(this,n)}getCurrentResult(){return Ze(this,Fh)}reset(){var n;(n=Ze(this,jo))==null||n.removeObserver(this),vr(this,jo,void 0),xn(this,mu,$1).call(this),xn(this,mu,OT).call(this)}mutate(n,s){var i;return vr(this,tu,s),(i=Ze(this,jo))==null||i.removeObserver(this),vr(this,jo,Ze(this,Lh).getMutationCache().build(Ze(this,Lh),this.options)),Ze(this,jo).addObserver(this),Ze(this,jo).execute(n)}},Lh=new WeakMap,Fh=new WeakMap,jo=new WeakMap,tu=new WeakMap,mu=new WeakSet,$1=function(){var s;const n=((s=Ze(this,jo))==null?void 0:s.state)??$q();vr(this,Fh,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},OT=function(n){Yi.batch(()=>{var s,i,l,d,a,f,p,y;if(Ze(this,tu)&&this.hasListeners()){const v=Ze(this,Fh).variables,j=Ze(this,Fh).context;(n==null?void 0:n.type)==="success"?((i=(s=Ze(this,tu)).onSuccess)==null||i.call(s,n.data,v,j),(d=(l=Ze(this,tu)).onSettled)==null||d.call(l,n.data,null,v,j)):(n==null?void 0:n.type)==="error"&&((f=(a=Ze(this,tu)).onError)==null||f.call(a,n.error,v,j),(y=(p=Ze(this,tu)).onSettled)==null||y.call(p,void 0,n.error,v,j))}this.listeners.forEach(v=>{v(Ze(this,Fh))})})},pB),qq=O.createContext(void 0),Sr=e=>{const r=O.useContext(qq);if(!r)throw new Error("No QueryClient set, use QueryClientProvider to set one");return r},Zee=({client:e,children:r})=>(O.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),t.jsx(qq.Provider,{value:e,children:r})),Vq=O.createContext(!1),Yee=()=>O.useContext(Vq);Vq.Provider;function Xee(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Qee=O.createContext(Xee()),Jee=()=>O.useContext(Qee);function Uq(e,r){return typeof e=="function"?e(...r):!!e}function IT(){}var ete=(e,r)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(r.isReset()||(e.retryOnMount=!1))},tte=e=>{O.useEffect(()=>{e.clearReset()},[e])},rte=({result:e,errorResetBoundary:r,throwOnError:n,query:s})=>e.isError&&!r.isReset()&&!e.isFetching&&s&&Uq(n,[e.error,s]),nte=e=>{e.suspense&&(e.staleTime===void 0&&(e.staleTime=1e3),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3)))},ste=(e,r)=>e.isLoading&&e.isFetching&&!r,ite=(e,r)=>(e==null?void 0:e.suspense)&&r.isPending,tL=(e,r,n)=>r.fetchOptimistic(e).catch(()=>{n.clearReset()});function ate(e,r,n){var y,v,j,w,k;const s=Sr(),i=Yee(),l=Jee(),d=s.defaultQueryOptions(e);(v=(y=s.getDefaultOptions().queries)==null?void 0:y._experimental_beforeQuery)==null||v.call(y,d),d._optimisticResults=i?"isRestoring":"optimistic",nte(d),ete(d,l),tte(l);const a=!s.getQueryCache().get(d.queryHash),[f]=O.useState(()=>new r(s,d)),p=f.getOptimisticResult(d);if(O.useSyncExternalStore(O.useCallback(S=>{const R=i?IT:f.subscribe(Yi.batchCalls(S));return f.updateResult(),R},[f,i]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),O.useEffect(()=>{f.setOptions(d,{listeners:!1})},[d,f]),ite(d,p))throw tL(d,f,l);if(rte({result:p,errorResetBoundary:l,throwOnError:d.throwOnError,query:s.getQueryCache().get(d.queryHash)}))throw p.error;if((w=(j=s.getDefaultOptions().queries)==null?void 0:j._experimental_afterQuery)==null||w.call(j,d,p),d.experimental_prefetchInRender&&!Yf&&ste(p,i)){const S=a?tL(d,f,l):(k=s.getQueryCache().get(d.queryHash))==null?void 0:k.promise;S==null||S.catch(IT).finally(()=>{f.updateResult()})}return d.notifyOnChangeProps?p:f.trackResult(p)}function ct(e,r){return ate(e,Wee)}function Nt(e,r){const n=Sr(),[s]=O.useState(()=>new Hee(n,e));O.useEffect(()=>{s.setOptions(e)},[s,e]);const i=O.useSyncExternalStore(O.useCallback(d=>s.subscribe(Yi.batchCalls(d)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),l=O.useCallback((d,a)=>{s.mutate(d,a).catch(IT)},[s]);if(i.error&&Uq(s.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:l,mutateAsync:i.mutate}}/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function R_(){return R_=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},R_.apply(this,arguments)}var Bh;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Bh||(Bh={}));const rL="popstate";function ote(e){e===void 0&&(e={});function r(s,i){let{pathname:l,search:d,hash:a}=s.location;return DT("",{pathname:l,search:d,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){return typeof i=="string"?i:vN(i)}return cte(r,n,null,e)}function oi(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function Wq(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function lte(){return Math.random().toString(36).substr(2,8)}function nL(e,r){return{usr:e.state,key:e.key,idx:r}}function DT(e,r,n,s){return n===void 0&&(n=null),R_({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof r=="string"?ky(r):r,{state:n,key:r&&r.key||s||lte()})}function vN(e){let{pathname:r="/",search:n="",hash:s=""}=e;return n&&n!=="?"&&(r+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(r+=s.charAt(0)==="#"?s:"#"+s),r}function ky(e){let r={};if(e){let n=e.indexOf("#");n>=0&&(r.hash=e.substr(n),e=e.substr(0,n));let s=e.indexOf("?");s>=0&&(r.search=e.substr(s),e=e.substr(0,s)),e&&(r.pathname=e)}return r}function cte(e,r,n,s){s===void 0&&(s={});let{window:i=document.defaultView,v5Compat:l=!1}=s,d=i.history,a=Bh.Pop,f=null,p=y();p==null&&(p=0,d.replaceState(R_({},d.state,{idx:p}),""));function y(){return(d.state||{idx:null}).idx}function v(){a=Bh.Pop;let R=y(),D=R==null?null:R-p;p=R,f&&f({action:a,location:S.location,delta:D})}function j(R,D){a=Bh.Push;let T=DT(S.location,R,D);p=y()+1;let I=nL(T,p),L=S.createHref(T);try{d.pushState(I,"",L)}catch($){if($ instanceof DOMException&&$.name==="DataCloneError")throw $;i.location.assign(L)}l&&f&&f({action:a,location:S.location,delta:1})}function w(R,D){a=Bh.Replace;let T=DT(S.location,R,D);p=y();let I=nL(T,p),L=S.createHref(T);d.replaceState(I,"",L),l&&f&&f({action:a,location:S.location,delta:0})}function k(R){let D=i.location.origin!=="null"?i.location.origin:i.location.href,T=typeof R=="string"?R:vN(R);return T=T.replace(/ $/,"%20"),oi(D,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,D)}let S={get action(){return a},get location(){return e(i,d)},listen(R){if(f)throw new Error("A history only accepts one active listener");return i.addEventListener(rL,v),f=R,()=>{i.removeEventListener(rL,v),f=null}},createHref(R){return r(i,R)},createURL:k,encodeLocation(R){let D=k(R);return{pathname:D.pathname,search:D.search,hash:D.hash}},push:j,replace:w,go(R){return d.go(R)}};return S}var sL;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(sL||(sL={}));function dte(e,r,n){return n===void 0&&(n="/"),ute(e,r,n)}function ute(e,r,n,s){let i=typeof r=="string"?ky(r):r,l=Bg(i.pathname||"/",n);if(l==null)return null;let d=Gq(e);hte(d);let a=null;for(let f=0;a==null&&f<d.length;++f){let p=wte(l);a=bte(d[f],p)}return a}function Gq(e,r,n,s){r===void 0&&(r=[]),n===void 0&&(n=[]),s===void 0&&(s="");let i=(l,d,a)=>{let f={relativePath:a===void 0?l.path||"":a,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};f.relativePath.startsWith("/")&&(oi(f.relativePath.startsWith(s),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(s.length));let p=em([s,f.relativePath]),y=n.concat(f);l.children&&l.children.length>0&&(oi(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+p+'".')),Gq(l.children,r,y,p)),!(l.path==null&&!l.index)&&r.push({path:p,score:vte(p,l.index),routesMeta:y})};return e.forEach((l,d)=>{var a;if(l.path===""||!((a=l.path)!=null&&a.includes("?")))i(l,d);else for(let f of Kq(l.path))i(l,d,f)}),r}function Kq(e){let r=e.split("/");if(r.length===0)return[];let[n,...s]=r,i=n.endsWith("?"),l=n.replace(/\?$/,"");if(s.length===0)return i?[l,""]:[l];let d=Kq(s.join("/")),a=[];return a.push(...d.map(f=>f===""?l:[l,f].join("/"))),i&&a.push(...d),a.map(f=>e.startsWith("/")&&f===""?"/":f)}function hte(e){e.sort((r,n)=>r.score!==n.score?n.score-r.score:_te(r.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const mte=/^:[\w-]+$/,fte=3,pte=2,xte=1,gte=10,yte=-2,iL=e=>e==="*";function vte(e,r){let n=e.split("/"),s=n.length;return n.some(iL)&&(s+=yte),r&&(s+=pte),n.filter(i=>!iL(i)).reduce((i,l)=>i+(mte.test(l)?fte:l===""?xte:gte),s)}function _te(e,r){return e.length===r.length&&e.slice(0,-1).every((s,i)=>s===r[i])?e[e.length-1]-r[r.length-1]:0}function bte(e,r,n){let{routesMeta:s}=e,i={},l="/",d=[];for(let a=0;a<s.length;++a){let f=s[a],p=a===s.length-1,y=l==="/"?r:r.slice(l.length)||"/",v=RT({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},y),j=f.route;if(!v)return null;Object.assign(i,v.params),d.push({params:i,pathname:em([l,v.pathname]),pathnameBase:Cte(em([l,v.pathnameBase])),route:j}),v.pathnameBase!=="/"&&(l=em([l,v.pathnameBase]))}return d}function RT(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,s]=jte(e.path,e.caseSensitive,e.end),i=r.match(n);if(!i)return null;let l=i[0],d=l.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:s.reduce((p,y,v)=>{let{paramName:j,isOptional:w}=y;if(j==="*"){let S=a[v]||"";d=l.slice(0,l.length-S.length).replace(/(.)\/+$/,"$1")}const k=a[v];return w&&!k?p[j]=void 0:p[j]=(k||"").replace(/%2F/g,"/"),p},{}),pathname:l,pathnameBase:d,pattern:e}}function jte(e,r,n){r===void 0&&(r=!1),n===void 0&&(n=!0),Wq(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let s=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,a,f)=>(s.push({paramName:a,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(s.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,r?void 0:"i"),s]}function wte(e){try{return e.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return Wq(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+r+").")),e}}function Bg(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let n=r.endsWith("/")?r.length-1:r.length,s=e.charAt(n);return s&&s!=="/"?null:e.slice(n)||"/"}function Nte(e,r){r===void 0&&(r="/");let{pathname:n,search:s="",hash:i=""}=typeof e=="string"?ky(e):e;return{pathname:n?n.startsWith("/")?n:Ste(n,r):r,search:Ate(s),hash:kte(i)}}function Ste(e,r){let n=r.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function wA(e,r,n,s){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+r+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Pte(e){return e.filter((r,n)=>n===0||r.route.path&&r.route.path.length>0)}function ZO(e,r){let n=Pte(e);return r?n.map((s,i)=>i===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function YO(e,r,n,s){s===void 0&&(s=!1);let i;typeof e=="string"?i=ky(e):(i=R_({},e),oi(!i.pathname||!i.pathname.includes("?"),wA("?","pathname","search",i)),oi(!i.pathname||!i.pathname.includes("#"),wA("#","pathname","hash",i)),oi(!i.search||!i.search.includes("#"),wA("#","search","hash",i)));let l=e===""||i.pathname==="",d=l?"/":i.pathname,a;if(d==null)a=n;else{let v=r.length-1;if(!s&&d.startsWith("..")){let j=d.split("/");for(;j[0]==="..";)j.shift(),v-=1;i.pathname=j.join("/")}a=v>=0?r[v]:"/"}let f=Nte(i,a),p=d&&d!=="/"&&d.endsWith("/"),y=(l||d===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(p||y)&&(f.pathname+="/"),f}const em=e=>e.join("/").replace(/\/\/+/g,"/"),Cte=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Ate=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,kte=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Tte(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Hq=["post","put","patch","delete"];new Set(Hq);const Ete=["get",...Hq];new Set(Ete);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function L_(){return L_=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},L_.apply(this,arguments)}const h2=O.createContext(null),Zq=O.createContext(null),Eu=O.createContext(null),m2=O.createContext(null),xd=O.createContext({outlet:null,matches:[],isDataRoute:!1}),Yq=O.createContext(null);function Mte(e,r){let{relative:n}=r===void 0?{}:r;Ty()||oi(!1);let{basename:s,navigator:i}=O.useContext(Eu),{hash:l,pathname:d,search:a}=f2(e,{relative:n}),f=d;return s!=="/"&&(f=d==="/"?s:em([s,d])),i.createHref({pathname:f,search:a,hash:l})}function Ty(){return O.useContext(m2)!=null}function mp(){return Ty()||oi(!1),O.useContext(m2).location}function Xq(e){O.useContext(Eu).static||O.useLayoutEffect(e)}function Ey(){let{isDataRoute:e}=O.useContext(xd);return e?Kte():Ote()}function Ote(){Ty()||oi(!1);let e=O.useContext(h2),{basename:r,future:n,navigator:s}=O.useContext(Eu),{matches:i}=O.useContext(xd),{pathname:l}=mp(),d=JSON.stringify(ZO(i,n.v7_relativeSplatPath)),a=O.useRef(!1);return Xq(()=>{a.current=!0}),O.useCallback(function(p,y){if(y===void 0&&(y={}),!a.current)return;if(typeof p=="number"){s.go(p);return}let v=YO(p,JSON.parse(d),l,y.relative==="path");e==null&&r!=="/"&&(v.pathname=v.pathname==="/"?r:em([r,v.pathname])),(y.replace?s.replace:s.push)(v,y.state,y)},[r,s,d,l,e])}const Ite=O.createContext(null);function Dte(e){let r=O.useContext(xd).outlet;return r&&O.createElement(Ite.Provider,{value:e},r)}function XO(){let{matches:e}=O.useContext(xd),r=e[e.length-1];return r?r.params:{}}function f2(e,r){let{relative:n}=r===void 0?{}:r,{future:s}=O.useContext(Eu),{matches:i}=O.useContext(xd),{pathname:l}=mp(),d=JSON.stringify(ZO(i,s.v7_relativeSplatPath));return O.useMemo(()=>YO(e,JSON.parse(d),l,n==="path"),[e,d,l,n])}function Rte(e,r){return Lte(e,r)}function Lte(e,r,n,s){Ty()||oi(!1);let{navigator:i,static:l}=O.useContext(Eu),{matches:d}=O.useContext(xd),a=d[d.length-1],f=a?a.params:{};a&&a.pathname;let p=a?a.pathnameBase:"/";a&&a.route;let y=mp(),v;if(r){var j;let D=typeof r=="string"?ky(r):r;p==="/"||(j=D.pathname)!=null&&j.startsWith(p)||oi(!1),v=D}else v=y;let w=v.pathname||"/",k=w;if(p!=="/"){let D=p.replace(/^\//,"").split("/");k="/"+w.replace(/^\//,"").split("/").slice(D.length).join("/")}let S=dte(e,{pathname:k}),R=qte(S&&S.map(D=>Object.assign({},D,{params:Object.assign({},f,D.params),pathname:em([p,i.encodeLocation?i.encodeLocation(D.pathname).pathname:D.pathname]),pathnameBase:D.pathnameBase==="/"?p:em([p,i.encodeLocation?i.encodeLocation(D.pathnameBase).pathname:D.pathnameBase])})),d,n,s);return r&&R?O.createElement(m2.Provider,{value:{location:L_({pathname:"/",search:"",hash:"",state:null,key:"default"},v),navigationType:Bh.Pop}},R):R}function Fte(){let e=Gte(),r=Tte(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return O.createElement(O.Fragment,null,O.createElement("h2",null,"Unexpected Application Error!"),O.createElement("h3",{style:{fontStyle:"italic"}},r),n?O.createElement("pre",{style:i},n):null,null)}const zte=O.createElement(Fte,null);class $te extends O.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,n){return n.location!==r.location||n.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:n.error,location:n.location,revalidation:r.revalidation||n.revalidation}}componentDidCatch(r,n){console.error("React Router caught the following error during render",r,n)}render(){return this.state.error!==void 0?O.createElement(xd.Provider,{value:this.props.routeContext},O.createElement(Yq.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Bte(e){let{routeContext:r,match:n,children:s}=e,i=O.useContext(h2);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),O.createElement(xd.Provider,{value:r},s)}function qte(e,r,n,s){var i;if(r===void 0&&(r=[]),n===void 0&&(n=null),s===void 0&&(s=null),e==null){var l;if(!n)return null;if(n.errors)e=n.matches;else if((l=s)!=null&&l.v7_partialHydration&&r.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let d=e,a=(i=n)==null?void 0:i.errors;if(a!=null){let y=d.findIndex(v=>v.route.id&&(a==null?void 0:a[v.route.id])!==void 0);y>=0||oi(!1),d=d.slice(0,Math.min(d.length,y+1))}let f=!1,p=-1;if(n&&s&&s.v7_partialHydration)for(let y=0;y<d.length;y++){let v=d[y];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(p=y),v.route.id){let{loaderData:j,errors:w}=n,k=v.route.loader&&j[v.route.id]===void 0&&(!w||w[v.route.id]===void 0);if(v.route.lazy||k){f=!0,p>=0?d=d.slice(0,p+1):d=[d[0]];break}}}return d.reduceRight((y,v,j)=>{let w,k=!1,S=null,R=null;n&&(w=a&&v.route.id?a[v.route.id]:void 0,S=v.route.errorElement||zte,f&&(p<0&&j===0?(Hte("route-fallback"),k=!0,R=null):p===j&&(k=!0,R=v.route.hydrateFallbackElement||null)));let D=r.concat(d.slice(0,j+1)),T=()=>{let I;return w?I=S:k?I=R:v.route.Component?I=O.createElement(v.route.Component,null):v.route.element?I=v.route.element:I=y,O.createElement(Bte,{match:v,routeContext:{outlet:y,matches:D,isDataRoute:n!=null},children:I})};return n&&(v.route.ErrorBoundary||v.route.errorElement||j===0)?O.createElement($te,{location:n.location,revalidation:n.revalidation,component:S,error:w,children:T(),routeContext:{outlet:null,matches:D,isDataRoute:!0}}):T()},null)}var Qq=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Qq||{}),Jq=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Jq||{});function Vte(e){let r=O.useContext(h2);return r||oi(!1),r}function Ute(e){let r=O.useContext(Zq);return r||oi(!1),r}function Wte(e){let r=O.useContext(xd);return r||oi(!1),r}function eV(e){let r=Wte(),n=r.matches[r.matches.length-1];return n.route.id||oi(!1),n.route.id}function Gte(){var e;let r=O.useContext(Yq),n=Ute(),s=eV();return r!==void 0?r:(e=n.errors)==null?void 0:e[s]}function Kte(){let{router:e}=Vte(Qq.UseNavigateStable),r=eV(Jq.UseNavigateStable),n=O.useRef(!1);return Xq(()=>{n.current=!0}),O.useCallback(function(i,l){l===void 0&&(l={}),n.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,L_({fromRouteId:r},l)))},[e,r])}const aL={};function Hte(e,r,n){aL[e]||(aL[e]=!0)}function Zte(e,r){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Sa(e){let{to:r,replace:n,state:s,relative:i}=e;Ty()||oi(!1);let{future:l,static:d}=O.useContext(Eu),{matches:a}=O.useContext(xd),{pathname:f}=mp(),p=Ey(),y=YO(r,ZO(a,l.v7_relativeSplatPath),f,i==="path"),v=JSON.stringify(y);return O.useEffect(()=>p(JSON.parse(v),{replace:n,state:s,relative:i}),[p,v,i,n,s]),null}function Oa(e){return Dte(e.context)}function et(e){oi(!1)}function Yte(e){let{basename:r="/",children:n=null,location:s,navigationType:i=Bh.Pop,navigator:l,static:d=!1,future:a}=e;Ty()&&oi(!1);let f=r.replace(/^\/*/,"/"),p=O.useMemo(()=>({basename:f,navigator:l,static:d,future:L_({v7_relativeSplatPath:!1},a)}),[f,a,l,d]);typeof s=="string"&&(s=ky(s));let{pathname:y="/",search:v="",hash:j="",state:w=null,key:k="default"}=s,S=O.useMemo(()=>{let R=Bg(y,f);return R==null?null:{location:{pathname:R,search:v,hash:j,state:w,key:k},navigationType:i}},[f,y,v,j,w,k,i]);return S==null?null:O.createElement(Eu.Provider,{value:p},O.createElement(m2.Provider,{children:n,value:S}))}function Xte(e){let{children:r,location:n}=e;return Rte(LT(r),n)}new Promise(()=>{});function LT(e,r){r===void 0&&(r=[]);let n=[];return O.Children.forEach(e,(s,i)=>{if(!O.isValidElement(s))return;let l=[...r,i];if(s.type===O.Fragment){n.push.apply(n,LT(s.props.children,l));return}s.type!==et&&oi(!1),!s.props.index||!s.props.children||oi(!1);let d={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(d.children=LT(s.props.children,l)),n.push(d)}),n}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _N(){return _N=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},_N.apply(this,arguments)}function tV(e,r){if(e==null)return{};var n={},s=Object.keys(e),i,l;for(l=0;l<s.length;l++)i=s[l],!(r.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Qte(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Jte(e,r){return e.button===0&&(!r||r==="_self")&&!Qte(e)}const ere=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],tre=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],rre="6";try{window.__reactRouterVersion=rre}catch{}const nre=O.createContext({isTransitioning:!1}),sre="startTransition",oL=CB[sre];function ire(e){let{basename:r,children:n,future:s,window:i}=e,l=O.useRef();l.current==null&&(l.current=ote({window:i,v5Compat:!0}));let d=l.current,[a,f]=O.useState({action:d.action,location:d.location}),{v7_startTransition:p}=s||{},y=O.useCallback(v=>{p&&oL?oL(()=>f(v)):f(v)},[f,p]);return O.useLayoutEffect(()=>d.listen(y),[d,y]),O.useEffect(()=>Zte(s),[s]),O.createElement(Yte,{basename:r,children:n,location:a.location,navigationType:a.action,navigator:d,future:s})}const are=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ore=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nd=O.forwardRef(function(r,n){let{onClick:s,relative:i,reloadDocument:l,replace:d,state:a,target:f,to:p,preventScrollReset:y,viewTransition:v}=r,j=tV(r,ere),{basename:w}=O.useContext(Eu),k,S=!1;if(typeof p=="string"&&ore.test(p)&&(k=p,are))try{let I=new URL(window.location.href),L=p.startsWith("//")?new URL(I.protocol+p):new URL(p),$=Bg(L.pathname,w);L.origin===I.origin&&$!=null?p=$+L.search+L.hash:S=!0}catch{}let R=Mte(p,{relative:i}),D=cre(p,{replace:d,state:a,target:f,preventScrollReset:y,relative:i,viewTransition:v});function T(I){s&&s(I),I.defaultPrevented||D(I)}return O.createElement("a",_N({},j,{href:k||R,onClick:S||l?s:T,ref:n,target:f}))}),lL=O.forwardRef(function(r,n){let{"aria-current":s="page",caseSensitive:i=!1,className:l="",end:d=!1,style:a,to:f,viewTransition:p,children:y}=r,v=tV(r,tre),j=f2(f,{relative:v.relative}),w=mp(),k=O.useContext(Zq),{navigator:S,basename:R}=O.useContext(Eu),D=k!=null&&dre(j)&&p===!0,T=S.encodeLocation?S.encodeLocation(j).pathname:j.pathname,I=w.pathname,L=k&&k.navigation&&k.navigation.location?k.navigation.location.pathname:null;i||(I=I.toLowerCase(),L=L?L.toLowerCase():null,T=T.toLowerCase()),L&&R&&(L=Bg(L,R)||L);const $=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let W=I===T||!d&&I.startsWith(T)&&I.charAt($)==="/",Z=L!=null&&(L===T||!d&&L.startsWith(T)&&L.charAt(T.length)==="/"),oe={isActive:W,isPending:Z,isTransitioning:D},te=W?s:void 0,be;typeof l=="function"?be=l(oe):be=[l,W?"active":null,Z?"pending":null,D?"transitioning":null].filter(Boolean).join(" ");let ie=typeof a=="function"?a(oe):a;return O.createElement(nd,_N({},v,{"aria-current":te,className:be,ref:n,style:ie,to:f,viewTransition:p}),typeof y=="function"?y(oe):y)});var FT;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(FT||(FT={}));var cL;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(cL||(cL={}));function lre(e){let r=O.useContext(h2);return r||oi(!1),r}function cre(e,r){let{target:n,replace:s,state:i,preventScrollReset:l,relative:d,viewTransition:a}=r===void 0?{}:r,f=Ey(),p=mp(),y=f2(e,{relative:d});return O.useCallback(v=>{if(Jte(v,n)){v.preventDefault();let j=s!==void 0?s:vN(p)===vN(y);f(e,{replace:j,state:i,preventScrollReset:l,relative:d,viewTransition:a})}},[p,f,y,s,i,n,e,l,d,a])}function dre(e,r){r===void 0&&(r={});let n=O.useContext(nre);n==null&&oi(!1);let{basename:s}=lre(FT.useViewTransitionState),i=f2(e,{relative:r.relative});if(!n.isTransitioning)return!1;let l=Bg(n.currentLocation.pathname,s)||n.currentLocation.pathname,d=Bg(n.nextLocation.pathname,s)||n.nextLocation.pathname;return RT(i.pathname,d)!=null||RT(i.pathname,l)!=null}async function ure(e){if(!e.ok){const r=await e.text()||e.statusText;throw new Error(`${e.status}: ${r}`)}}const hre=({on401:e})=>async({queryKey:r})=>{const n=await fetch(r[0],{credentials:"include"});return await ure(n),await n.json()},mre=new Uee({defaultOptions:{queries:{queryFn:hre({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),fre="/api/v1";class pre{constructor(r=fre){this.baseUrl=r}async request(r,n){const s=`${this.baseUrl}${r}`,i={"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",...n==null?void 0:n.headers},l=await fetch(s,{...n,headers:i,credentials:"include"});if(!l.ok){const d=await l.json().catch(()=>({message:l.statusText}));throw new Error(d.message||"API request failed")}return l.json()}async get(r,n){const s=n?"?"+new URLSearchParams(n).toString():"";return this.request(`${r}${s}`)}async post(r,n){return this.request(r,{method:"POST",body:JSON.stringify(n)})}async put(r,n){return this.request(r,{method:"PUT",body:JSON.stringify(n)})}async patch(r,n){return this.request(r,{method:"PATCH",body:JSON.stringify(n)})}async delete(r){return this.request(r,{method:"DELETE"})}}const xe=new pre,rV=O.createContext(void 0);function xre({children:e}){const[r,n]=O.useState(null),[s,i]=O.useState(!0),l=async()=>{try{const y=await xe.get("/auth/user");n(y.user)}catch{n(null)}};O.useEffect(()=>{l().finally(()=>i(!1))},[]);const d=async(y,v)=>{const j=await xe.post("/auth/login",{email:y,password:v});n(j.user)},a=async()=>{try{await xe.post("/auth/logout")}catch(y){console.error("Logout error:",y)}finally{n(null)}},f=y=>!r||!r.permissions?!1:r.permissions.includes(y),p=y=>!r||!r.roles?!1:r.roles.includes(y);return t.jsx(rV.Provider,{value:{user:r,setUser:n,isAuthenticated:!!r,isLoading:s,login:d,logout:a,refreshUser:l,hasPermission:f,hasRole:p},children:e})}function QO(){const e=O.useContext(rV);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}function lt({children:e,requiredPermission:r,requiredRole:n}){const{isAuthenticated:s,isLoading:i,hasPermission:l,hasRole:d}=QO();return t.jsx(t.Fragment,{children:e})}function gre(e,r){typeof e=="function"?e(r):e!=null&&(e.current=r)}function p2(...e){return r=>e.forEach(n=>gre(n,r))}function yn(...e){return O.useCallback(p2(...e),e)}var yu=O.forwardRef((e,r)=>{const{children:n,...s}=e,i=O.Children.toArray(n),l=i.find(vre);if(l){const d=l.props.children,a=i.map(f=>f===l?O.Children.count(d)>1?O.Children.only(null):O.isValidElement(d)?d.props.children:null:f);return t.jsx(zT,{...s,ref:r,children:O.isValidElement(d)?O.cloneElement(d,void 0,a):null})}return t.jsx(zT,{...s,ref:r,children:n})});yu.displayName="Slot";var zT=O.forwardRef((e,r)=>{const{children:n,...s}=e;if(O.isValidElement(n)){const i=bre(n);return O.cloneElement(n,{..._re(s,n.props),ref:r?p2(r,i):i})}return O.Children.count(n)>1?O.Children.only(null):null});zT.displayName="SlotClone";var yre=({children:e})=>t.jsx(t.Fragment,{children:e});function vre(e){return O.isValidElement(e)&&e.type===yre}function _re(e,r){const n={...r};for(const s in r){const i=e[s],l=r[s];/^on[A-Z]/.test(s)?i&&l?n[s]=(...a)=>{l(...a),i(...a)}:i&&(n[s]=i):s==="style"?n[s]={...i,...l}:s==="className"&&(n[s]=[i,l].filter(Boolean).join(" "))}return{...e,...n}}function bre(e){var s,i;let r=(s=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:s.get,n=r&&"isReactWarning"in r&&r.isReactWarning;return n?e.ref:(r=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,n=r&&"isReactWarning"in r&&r.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function nV(e){var r,n,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e))for(r=0;r<e.length;r++)e[r]&&(n=nV(e[r]))&&(s&&(s+=" "),s+=n);else for(r in e)e[r]&&(s&&(s+=" "),s+=r);return s}function jre(){for(var e,r,n=0,s="";n<arguments.length;)(e=arguments[n++])&&(r=nV(e))&&(s&&(s+=" "),s+=r);return s}const dL=e=>typeof e=="boolean"?"".concat(e):e===0?"0":e,uL=jre,Wb=(e,r)=>n=>{var s;if((r==null?void 0:r.variants)==null)return uL(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:i,defaultVariants:l}=r,d=Object.keys(i).map(p=>{const y=n==null?void 0:n[p],v=l==null?void 0:l[p];if(y===null)return null;const j=dL(y)||dL(v);return i[p][j]}),a=n&&Object.entries(n).reduce((p,y)=>{let[v,j]=y;return j===void 0||(p[v]=j),p},{}),f=r==null||(s=r.compoundVariants)===null||s===void 0?void 0:s.reduce((p,y)=>{let{class:v,className:j,...w}=y;return Object.entries(w).every(k=>{let[S,R]=k;return Array.isArray(R)?R.includes({...l,...a}[S]):{...l,...a}[S]===R})?[...p,v,j]:p},[]);return uL(e,d,f,n==null?void 0:n.class,n==null?void 0:n.className)};function sV(e){var r,n,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(r=0;r<i;r++)e[r]&&(n=sV(e[r]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}function Yr(){for(var e,r,n=0,s="",i=arguments.length;n<i;n++)(e=arguments[n])&&(r=sV(e))&&(s&&(s+=" "),s+=r);return s}const JO="-",wre=e=>{const r=Sre(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=e;return{getClassGroupId:d=>{const a=d.split(JO);return a[0]===""&&a.length!==1&&a.shift(),iV(a,r)||Nre(d)},getConflictingClassGroupIds:(d,a)=>{const f=n[d]||[];return a&&s[d]?[...f,...s[d]]:f}}},iV=(e,r)=>{var d;if(e.length===0)return r.classGroupId;const n=e[0],s=r.nextPart.get(n),i=s?iV(e.slice(1),s):void 0;if(i)return i;if(r.validators.length===0)return;const l=e.join(JO);return(d=r.validators.find(({validator:a})=>a(l)))==null?void 0:d.classGroupId},hL=/^\[(.+)\]$/,Nre=e=>{if(hL.test(e)){const r=hL.exec(e)[1],n=r==null?void 0:r.substring(0,r.indexOf(":"));if(n)return"arbitrary.."+n}},Sre=e=>{const{theme:r,prefix:n}=e,s={nextPart:new Map,validators:[]};return Cre(Object.entries(e.classGroups),n).forEach(([l,d])=>{$T(d,s,l,r)}),s},$T=(e,r,n,s)=>{e.forEach(i=>{if(typeof i=="string"){const l=i===""?r:mL(r,i);l.classGroupId=n;return}if(typeof i=="function"){if(Pre(i)){$T(i(s),r,n,s);return}r.validators.push({validator:i,classGroupId:n});return}Object.entries(i).forEach(([l,d])=>{$T(d,mL(r,l),n,s)})})},mL=(e,r)=>{let n=e;return r.split(JO).forEach(s=>{n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n},Pre=e=>e.isThemeGetter,Cre=(e,r)=>r?e.map(([n,s])=>{const i=s.map(l=>typeof l=="string"?r+l:typeof l=="object"?Object.fromEntries(Object.entries(l).map(([d,a])=>[r+d,a])):l);return[n,i]}):e,Are=e=>{if(e<1)return{get:()=>{},set:()=>{}};let r=0,n=new Map,s=new Map;const i=(l,d)=>{n.set(l,d),r++,r>e&&(r=0,s=n,n=new Map)};return{get(l){let d=n.get(l);if(d!==void 0)return d;if((d=s.get(l))!==void 0)return i(l,d),d},set(l,d){n.has(l)?n.set(l,d):i(l,d)}}},aV="!",kre=e=>{const{separator:r,experimentalParseClassName:n}=e,s=r.length===1,i=r[0],l=r.length,d=a=>{const f=[];let p=0,y=0,v;for(let R=0;R<a.length;R++){let D=a[R];if(p===0){if(D===i&&(s||a.slice(R,R+l)===r)){f.push(a.slice(y,R)),y=R+l;continue}if(D==="/"){v=R;continue}}D==="["?p++:D==="]"&&p--}const j=f.length===0?a:a.substring(y),w=j.startsWith(aV),k=w?j.substring(1):j,S=v&&v>y?v-y:void 0;return{modifiers:f,hasImportantModifier:w,baseClassName:k,maybePostfixModifierPosition:S}};return n?a=>n({className:a,parseClassName:d}):d},Tre=e=>{if(e.length<=1)return e;const r=[];let n=[];return e.forEach(s=>{s[0]==="["?(r.push(...n.sort(),s),n=[]):n.push(s)}),r.push(...n.sort()),r},Ere=e=>({cache:Are(e.cacheSize),parseClassName:kre(e),...wre(e)}),Mre=/\s+/,Ore=(e,r)=>{const{parseClassName:n,getClassGroupId:s,getConflictingClassGroupIds:i}=r,l=[],d=e.trim().split(Mre);let a="";for(let f=d.length-1;f>=0;f-=1){const p=d[f],{modifiers:y,hasImportantModifier:v,baseClassName:j,maybePostfixModifierPosition:w}=n(p);let k=!!w,S=s(k?j.substring(0,w):j);if(!S){if(!k){a=p+(a.length>0?" "+a:a);continue}if(S=s(j),!S){a=p+(a.length>0?" "+a:a);continue}k=!1}const R=Tre(y).join(":"),D=v?R+aV:R,T=D+S;if(l.includes(T))continue;l.push(T);const I=i(S,k);for(let L=0;L<I.length;++L){const $=I[L];l.push(D+$)}a=p+(a.length>0?" "+a:a)}return a};function Ire(){let e=0,r,n,s="";for(;e<arguments.length;)(r=arguments[e++])&&(n=oV(r))&&(s&&(s+=" "),s+=n);return s}const oV=e=>{if(typeof e=="string")return e;let r,n="";for(let s=0;s<e.length;s++)e[s]&&(r=oV(e[s]))&&(n&&(n+=" "),n+=r);return n};function Dre(e,...r){let n,s,i,l=d;function d(f){const p=r.reduce((y,v)=>v(y),e());return n=Ere(p),s=n.cache.get,i=n.cache.set,l=a,a(f)}function a(f){const p=s(f);if(p)return p;const y=Ore(f,n);return i(f,y),y}return function(){return l(Ire.apply(null,arguments))}}const Es=e=>{const r=n=>n[e]||[];return r.isThemeGetter=!0,r},lV=/^\[(?:([a-z-]+):)?(.+)\]$/i,Rre=/^\d+\/\d+$/,Lre=new Set(["px","full","screen"]),Fre=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,zre=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,$re=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Bre=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,qre=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Hd=e=>ug(e)||Lre.has(e)||Rre.test(e),mh=e=>My(e,"length",Yre),ug=e=>!!e&&!Number.isNaN(Number(e)),NA=e=>My(e,"number",ug),S0=e=>!!e&&Number.isInteger(Number(e)),Vre=e=>e.endsWith("%")&&ug(e.slice(0,-1)),mn=e=>lV.test(e),fh=e=>Fre.test(e),Ure=new Set(["length","size","percentage"]),Wre=e=>My(e,Ure,cV),Gre=e=>My(e,"position",cV),Kre=new Set(["image","url"]),Hre=e=>My(e,Kre,Qre),Zre=e=>My(e,"",Xre),P0=()=>!0,My=(e,r,n)=>{const s=lV.exec(e);return s?s[1]?typeof r=="string"?s[1]===r:r.has(s[1]):n(s[2]):!1},Yre=e=>zre.test(e)&&!$re.test(e),cV=()=>!1,Xre=e=>Bre.test(e),Qre=e=>qre.test(e),Jre=()=>{const e=Es("colors"),r=Es("spacing"),n=Es("blur"),s=Es("brightness"),i=Es("borderColor"),l=Es("borderRadius"),d=Es("borderSpacing"),a=Es("borderWidth"),f=Es("contrast"),p=Es("grayscale"),y=Es("hueRotate"),v=Es("invert"),j=Es("gap"),w=Es("gradientColorStops"),k=Es("gradientColorStopPositions"),S=Es("inset"),R=Es("margin"),D=Es("opacity"),T=Es("padding"),I=Es("saturate"),L=Es("scale"),$=Es("sepia"),W=Es("skew"),Z=Es("space"),oe=Es("translate"),te=()=>["auto","contain","none"],be=()=>["auto","hidden","clip","visible","scroll"],ie=()=>["auto",mn,r],ge=()=>[mn,r],Ie=()=>["",Hd,mh],Oe=()=>["auto",ug,mn],Xe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Ue=()=>["solid","dashed","dotted","double","none"],tt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Ce=()=>["start","end","center","between","around","evenly","stretch"],ve=()=>["","0",mn],rt=()=>["auto","avoid","all","avoid-page","page","left","right","column"],vt=()=>[ug,mn];return{cacheSize:500,separator:":",theme:{colors:[P0],spacing:[Hd,mh],blur:["none","",fh,mn],brightness:vt(),borderColor:[e],borderRadius:["none","","full",fh,mn],borderSpacing:ge(),borderWidth:Ie(),contrast:vt(),grayscale:ve(),hueRotate:vt(),invert:ve(),gap:ge(),gradientColorStops:[e],gradientColorStopPositions:[Vre,mh],inset:ie(),margin:ie(),opacity:vt(),padding:ge(),saturate:vt(),scale:vt(),sepia:ve(),skew:vt(),space:ge(),translate:ge()},classGroups:{aspect:[{aspect:["auto","square","video",mn]}],container:["container"],columns:[{columns:[fh]}],"break-after":[{"break-after":rt()}],"break-before":[{"break-before":rt()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Xe(),mn]}],overflow:[{overflow:be()}],"overflow-x":[{"overflow-x":be()}],"overflow-y":[{"overflow-y":be()}],overscroll:[{overscroll:te()}],"overscroll-x":[{"overscroll-x":te()}],"overscroll-y":[{"overscroll-y":te()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[S]}],"inset-x":[{"inset-x":[S]}],"inset-y":[{"inset-y":[S]}],start:[{start:[S]}],end:[{end:[S]}],top:[{top:[S]}],right:[{right:[S]}],bottom:[{bottom:[S]}],left:[{left:[S]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",S0,mn]}],basis:[{basis:ie()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",mn]}],grow:[{grow:ve()}],shrink:[{shrink:ve()}],order:[{order:["first","last","none",S0,mn]}],"grid-cols":[{"grid-cols":[P0]}],"col-start-end":[{col:["auto",{span:["full",S0,mn]},mn]}],"col-start":[{"col-start":Oe()}],"col-end":[{"col-end":Oe()}],"grid-rows":[{"grid-rows":[P0]}],"row-start-end":[{row:["auto",{span:[S0,mn]},mn]}],"row-start":[{"row-start":Oe()}],"row-end":[{"row-end":Oe()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",mn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",mn]}],gap:[{gap:[j]}],"gap-x":[{"gap-x":[j]}],"gap-y":[{"gap-y":[j]}],"justify-content":[{justify:["normal",...Ce()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Ce(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Ce(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[T]}],px:[{px:[T]}],py:[{py:[T]}],ps:[{ps:[T]}],pe:[{pe:[T]}],pt:[{pt:[T]}],pr:[{pr:[T]}],pb:[{pb:[T]}],pl:[{pl:[T]}],m:[{m:[R]}],mx:[{mx:[R]}],my:[{my:[R]}],ms:[{ms:[R]}],me:[{me:[R]}],mt:[{mt:[R]}],mr:[{mr:[R]}],mb:[{mb:[R]}],ml:[{ml:[R]}],"space-x":[{"space-x":[Z]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[Z]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",mn,r]}],"min-w":[{"min-w":[mn,r,"min","max","fit"]}],"max-w":[{"max-w":[mn,r,"none","full","min","max","fit","prose",{screen:[fh]},fh]}],h:[{h:[mn,r,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[mn,r,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[mn,r,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[mn,r,"auto","min","max","fit"]}],"font-size":[{text:["base",fh,mh]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",NA]}],"font-family":[{font:[P0]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",mn]}],"line-clamp":[{"line-clamp":["none",ug,NA]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Hd,mn]}],"list-image":[{"list-image":["none",mn]}],"list-style-type":[{list:["none","disc","decimal",mn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[D]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[D]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Ue(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Hd,mh]}],"underline-offset":[{"underline-offset":["auto",Hd,mn]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ge()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",mn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",mn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[D]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Xe(),Gre]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Wre]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Hre]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[k]}],"gradient-via-pos":[{via:[k]}],"gradient-to-pos":[{to:[k]}],"gradient-from":[{from:[w]}],"gradient-via":[{via:[w]}],"gradient-to":[{to:[w]}],rounded:[{rounded:[l]}],"rounded-s":[{"rounded-s":[l]}],"rounded-e":[{"rounded-e":[l]}],"rounded-t":[{"rounded-t":[l]}],"rounded-r":[{"rounded-r":[l]}],"rounded-b":[{"rounded-b":[l]}],"rounded-l":[{"rounded-l":[l]}],"rounded-ss":[{"rounded-ss":[l]}],"rounded-se":[{"rounded-se":[l]}],"rounded-ee":[{"rounded-ee":[l]}],"rounded-es":[{"rounded-es":[l]}],"rounded-tl":[{"rounded-tl":[l]}],"rounded-tr":[{"rounded-tr":[l]}],"rounded-br":[{"rounded-br":[l]}],"rounded-bl":[{"rounded-bl":[l]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[D]}],"border-style":[{border:[...Ue(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[D]}],"divide-style":[{divide:Ue()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...Ue()]}],"outline-offset":[{"outline-offset":[Hd,mn]}],"outline-w":[{outline:[Hd,mh]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:Ie()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[D]}],"ring-offset-w":[{"ring-offset":[Hd,mh]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",fh,Zre]}],"shadow-color":[{shadow:[P0]}],opacity:[{opacity:[D]}],"mix-blend":[{"mix-blend":[...tt(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":tt()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[s]}],contrast:[{contrast:[f]}],"drop-shadow":[{"drop-shadow":["","none",fh,mn]}],grayscale:[{grayscale:[p]}],"hue-rotate":[{"hue-rotate":[y]}],invert:[{invert:[v]}],saturate:[{saturate:[I]}],sepia:[{sepia:[$]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[f]}],"backdrop-grayscale":[{"backdrop-grayscale":[p]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[y]}],"backdrop-invert":[{"backdrop-invert":[v]}],"backdrop-opacity":[{"backdrop-opacity":[D]}],"backdrop-saturate":[{"backdrop-saturate":[I]}],"backdrop-sepia":[{"backdrop-sepia":[$]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[d]}],"border-spacing-x":[{"border-spacing-x":[d]}],"border-spacing-y":[{"border-spacing-y":[d]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",mn]}],duration:[{duration:vt()}],ease:[{ease:["linear","in","out","in-out",mn]}],delay:[{delay:vt()}],animate:[{animate:["none","spin","ping","pulse","bounce",mn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[L]}],"scale-x":[{"scale-x":[L]}],"scale-y":[{"scale-y":[L]}],rotate:[{rotate:[S0,mn]}],"translate-x":[{"translate-x":[oe]}],"translate-y":[{"translate-y":[oe]}],"skew-x":[{"skew-x":[W]}],"skew-y":[{"skew-y":[W]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",mn]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",mn]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ge()}],"scroll-mx":[{"scroll-mx":ge()}],"scroll-my":[{"scroll-my":ge()}],"scroll-ms":[{"scroll-ms":ge()}],"scroll-me":[{"scroll-me":ge()}],"scroll-mt":[{"scroll-mt":ge()}],"scroll-mr":[{"scroll-mr":ge()}],"scroll-mb":[{"scroll-mb":ge()}],"scroll-ml":[{"scroll-ml":ge()}],"scroll-p":[{"scroll-p":ge()}],"scroll-px":[{"scroll-px":ge()}],"scroll-py":[{"scroll-py":ge()}],"scroll-ps":[{"scroll-ps":ge()}],"scroll-pe":[{"scroll-pe":ge()}],"scroll-pt":[{"scroll-pt":ge()}],"scroll-pr":[{"scroll-pr":ge()}],"scroll-pb":[{"scroll-pb":ge()}],"scroll-pl":[{"scroll-pl":ge()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",mn]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Hd,mh,NA]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},ene=Dre(Jre);function gr(...e){return ene(Yr(e))}const tne=Wb("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),X=O.forwardRef(({className:e,variant:r,size:n,asChild:s=!1,...i},l)=>{const d=s?yu:"button";return t.jsx(d,{className:gr(tne({variant:r,size:n,className:e})),ref:l,...i})});X.displayName="Button";const Ve=O.forwardRef(({className:e,type:r,...n},s)=>t.jsx("input",{type:r,className:gr("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...n}));Ve.displayName="Input";var rne=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],zr=rne.reduce((e,r)=>{const n=O.forwardRef((s,i)=>{const{asChild:l,...d}=s,a=l?yu:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),t.jsx(a,{...d,ref:i})});return n.displayName=`Primitive.${r}`,{...e,[r]:n}},{});function dV(e,r){e&&_m.flushSync(()=>e.dispatchEvent(r))}var nne="Label",uV=O.forwardRef((e,r)=>t.jsx(zr.label,{...e,ref:r,onMouseDown:n=>{var i;n.target.closest("button, input, select, textarea")||((i=e.onMouseDown)==null||i.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));uV.displayName=nne;var hV=uV;const sne=Wb("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Me=O.forwardRef(({className:e,...r},n)=>t.jsx(hV,{ref:n,className:gr(sne(),e),...r}));Me.displayName=hV.displayName;const H=O.forwardRef(({className:e,...r},n)=>t.jsx("div",{ref:n,className:gr("rounded-xl border bg-card text-card-foreground shadow",e),...r}));H.displayName="Card";const de=O.forwardRef(({className:e,...r},n)=>t.jsx("div",{ref:n,className:gr("flex flex-col space-y-1.5 p-6",e),...r}));de.displayName="CardHeader";const he=O.forwardRef(({className:e,...r},n)=>t.jsx("div",{ref:n,className:gr("font-semibold leading-none tracking-tight",e),...r}));he.displayName="CardTitle";const cr=O.forwardRef(({className:e,...r},n)=>t.jsx("div",{ref:n,className:gr("text-sm text-muted-foreground",e),...r}));cr.displayName="CardDescription";const Q=O.forwardRef(({className:e,...r},n)=>t.jsx("div",{ref:n,className:gr("p-6 pt-0",e),...r}));Q.displayName="CardContent";const mV=O.forwardRef(({className:e,...r},n)=>t.jsx("div",{ref:n,className:gr("flex items-center p-6 pt-0",e),...r}));mV.displayName="CardFooter";const ine=Wb("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),fa=O.forwardRef(({className:e,variant:r,...n},s)=>t.jsx("div",{ref:s,role:"alert",className:gr(ine({variant:r}),e),...n}));fa.displayName="Alert";const ane=O.forwardRef(({className:e,...r},n)=>t.jsx("h5",{ref:n,className:gr("mb-1 font-medium leading-none tracking-tight",e),...r}));ane.displayName="AlertTitle";const ta=O.forwardRef(({className:e,...r},n)=>t.jsx("div",{ref:n,className:gr("text-sm [&_p]:leading-relaxed",e),...r}));ta.displayName="AlertDescription";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const one=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),fV=(...e)=>e.filter((r,n,s)=>!!r&&s.indexOf(r)===n).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var lne={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cne=O.forwardRef(({color:e="currentColor",size:r=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:i="",children:l,iconNode:d,...a},f)=>O.createElement("svg",{ref:f,...lne,width:r,height:r,stroke:e,strokeWidth:s?Number(n)*24/Number(r):n,className:fV("lucide",i),...a},[...d.map(([p,y])=>O.createElement(p,y)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=(e,r)=>{const n=O.forwardRef(({className:s,...i},l)=>O.createElement(cne,{ref:l,iconNode:r,className:fV(`lucide-${one(e)}`,s),...i}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=Ct("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dne=Ct("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pV=Ct("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F_=Ct("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const une=Ct("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z_=Ct("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vu=Ct("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hne=Ct("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xV=Ct("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=Ct("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fL=Ct("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oo=Ct("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sd=Ct("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mne=Ct("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gV=Ct("ChartNoAxesColumn",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fne=Ct("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _u=Ct("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tI=Ct("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rI=Ct("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oy=Ct("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pne=Ct("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=Ct("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xne=Ct("CircleArrowDown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gne=Ct("CircleArrowUp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=Ct("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bu=Ct("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yne=Ct("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mu=Ct("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BT=Ct("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vne=Ct("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y0=Ct("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=Ct("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ne=Ct("CloudRain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qT=Ct("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=Ct("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bne=Ct("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=Ct("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=Ct("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=Ct("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=Ct("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gc=Ct("Droplet",[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sc=Ct("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yV=Ct("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vV=Ct("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _V=Ct("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ud=Ct("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jne=Ct("FileChartColumnIncreasing",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wne=Ct("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bV=Ct("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nne=Ct("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $n=Ct("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sne=Ct("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pne=Ct("FlaskConical",[["path",{d:"M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2",key:"pzvekw"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M7 16h10",key:"wp8him"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jV=Ct("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pL=Ct("Fuel",[["line",{x1:"3",x2:"15",y1:"22",y2:"22",key:"xegly4"}],["line",{x1:"4",x2:"14",y1:"9",y2:"9",key:"xcnuvu"}],["path",{d:"M14 22V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v18",key:"16j0yd"}],["path",{d:"M14 13h2a2 2 0 0 1 2 2v2a2 2 0 0 0 2 2a2 2 0 0 0 2-2V9.83a2 2 0 0 0-.59-1.42L18 5",key:"7cu91f"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qc=Ct("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cne=Ct("Gavel",[["path",{d:"m14.5 12.5-8 8a2.119 2.119 0 1 1-3-3l8-8",key:"15492f"}],["path",{d:"m16 16 6-6",key:"vzrcl6"}],["path",{d:"m8 8 6-6",key:"18bi4p"}],["path",{d:"m9 7 8 8",key:"5jnvq1"}],["path",{d:"m21 11-8-8",key:"z4y7zo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bN=Ct("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xL=Ct("GitMerge",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qf=Ct("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ane=Ct("HandHeart",[["path",{d:"M11 14h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 16",key:"1ifwr1"}],["path",{d:"m7 20 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9",key:"17abbs"}],["path",{d:"m2 15 6 6",key:"10dquu"}],["path",{d:"M19.5 8.5c.7-.7 1.5-1.6 1.5-2.7A2.73 2.73 0 0 0 16 4a2.78 2.78 0 0 0-5 1.8c0 1.2.8 2 1.5 2.8L16 12Z",key:"1h3036"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VT=Ct("Handshake",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kne=Ct("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UT=Ct("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jN=Ct("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wV=Ct("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tne=Ct("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tm=Ct("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qh=Ct("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=Ct("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=Ct("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iu=Ct("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lm=Ct("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gL=Ct("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ene=Ct("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const id=Ct("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g2=Ct("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NV=Ct("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wN=Ct("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const El=Ct("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=Ct("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mne=Ct("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $_=Ct("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WT=Ct("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GT=Ct("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SV=Ct("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PV=Ct("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const One=Ct("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=Ct("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const di=Ct("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y2=Ct("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=Ct("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ine=Ct("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yL=Ct("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wi=Ct("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=Ct("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oI=Ct("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dne=Ct("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dl=Ct("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CV=Ct("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hg=Ct("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vL=Ct("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rne=Ct("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lne=Ct("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AV=Ct("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=Ct("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=Ct("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=Ct("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=Ct("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fne=Ct("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B_=Ct("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bc=Ct("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zne=Ct("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ne=Ct("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=Ct("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kV=Ct("Webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bne=Ct("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qne=Ct("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jf=Ct("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bm=Ct("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Si=Ct("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function Vne(){const[e,r]=O.useState(""),[n,s]=O.useState(""),[i,l]=O.useState(""),[d,a]=O.useState(!1),[f,p]=O.useState(""),[y,v]=O.useState(!1),{login:j,setUser:w}=QO(),k=Ey(),S=async R=>{var D,T;R.preventDefault(),p(""),v(!0);try{if(d){const I=await xe.post("/auth/2fa/challenge",{email:e,password:n,code:i});w(I.user),k("/")}else try{await j(e,n),k("/")}catch(I){if((D=I.message)!=null&&D.includes("2FA")||(T=I.message)!=null&&T.includes("two-factor"))a(!0),p("");else throw I}}catch(I){p(I.message||"Login failed. Please check your credentials.")}finally{v(!1)}};return t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 px-4",children:t.jsxs(H,{className:"w-full max-w-md",children:[t.jsxs(de,{className:"space-y-1",children:[t.jsx(he,{className:"text-2xl font-bold text-center",children:"Rural Water Supply MIS"}),t.jsx(cr,{className:"text-center",children:"Sign in to access the system"})]}),t.jsxs("form",{onSubmit:S,children:[t.jsxs(Q,{className:"space-y-4",children:[f&&t.jsx(fa,{variant:"destructive",children:t.jsx(ta,{children:f})}),d&&t.jsxs(fa,{children:[t.jsx(wi,{className:"h-4 w-4"}),t.jsx(ta,{children:"Two-factor authentication is enabled. Please enter the code from your authenticator app."})]}),d?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"2fa-code",children:"Verification Code"}),t.jsx(Ve,{id:"2fa-code",type:"text",placeholder:"000000",maxLength:6,value:i,onChange:R=>l(R.target.value.replace(/\D/g,"")),required:!0,disabled:y,autoFocus:!0}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter the 6-digit code from your authenticator app"})]}),t.jsx(X,{type:"button",variant:"ghost",size:"sm",onClick:()=>{a(!1),l(""),p("")},disabled:y,children:"Back to login"})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"email",children:"Email"}),t.jsx(Ve,{id:"email",type:"email",placeholder:"user@example.com",value:e,onChange:R=>r(R.target.value),required:!0,disabled:y})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"password",children:"Password"}),t.jsx(Ve,{id:"password",type:"password",placeholder:"",value:n,onChange:R=>s(R.target.value),required:!0,disabled:y})]})]})]}),t.jsx(mV,{children:t.jsx(X,{type:"submit",className:"w-full",disabled:y||d&&i.length!==6,children:y?"Signing in...":d?"Verify & Sign In":"Sign In"})})]})]})})}function Une(){const{data:e}=ct({queryKey:["registry-stats"],queryFn:async()=>({schemes:2,assets:3,dmas:2,meters:2})});return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Core Registry"}),t.jsx("p",{className:"text-muted-foreground",children:"Phase 1-2: Water Infrastructure Foundation"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Water Schemes"}),t.jsx(Sc,{className:"h-4 w-4 text-blue-500"})]}),t.jsx(Q,{children:t.jsx("div",{className:"text-2xl font-bold",children:e==null?void 0:e.schemes})})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"DMAs"}),t.jsx(Ka,{className:"h-4 w-4 text-green-500"})]}),t.jsx(Q,{children:t.jsx("div",{className:"text-2xl font-bold",children:e==null?void 0:e.dmas})})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Assets"}),t.jsx(Us,{className:"h-4 w-4 text-orange-500"})]}),t.jsx(Q,{children:t.jsx("div",{className:"text-2xl font-bold",children:e==null?void 0:e.assets})})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Meters"}),t.jsx(Qc,{className:"h-4 w-4 text-purple-500"})]}),t.jsx(Q,{children:t.jsx("div",{className:"text-2xl font-bold",children:e==null?void 0:e.meters})})]})]})]})}const _L={getAll:e=>xe.get("/facilities",e),getById:e=>xe.get(`/facilities/${e}`),create:e=>xe.post("/facilities",e),update:(e,r)=>xe.patch(`/facilities/${e}`,r),delete:e=>xe.delete(`/facilities/${e}`)},Wne=Wb("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ee({className:e,variant:r,...n}){return t.jsx("div",{className:gr(Wne({variant:r}),e),...n})}function q_(e,[r,n]){return Math.min(n,Math.max(r,e))}function ar(e,r,{checkForDefaultPrevented:n=!0}={}){return function(i){if(e==null||e(i),n===!1||!i.defaultPrevented)return r==null?void 0:r(i)}}function Gne(e,r=[]){let n=[];function s(l,d){const a=O.createContext(d),f=n.length;n=[...n,d];function p(v){const{scope:j,children:w,...k}=v,S=(j==null?void 0:j[e][f])||a,R=O.useMemo(()=>k,Object.values(k));return t.jsx(S.Provider,{value:R,children:w})}function y(v,j){const w=(j==null?void 0:j[e][f])||a,k=O.useContext(w);if(k)return k;if(d!==void 0)return d;throw new Error(`\`${v}\` must be used within \`${l}\``)}return p.displayName=l+"Provider",[p,y]}const i=()=>{const l=n.map(d=>O.createContext(d));return function(a){const f=(a==null?void 0:a[e])||l;return O.useMemo(()=>({[`__scope${e}`]:{...a,[e]:f}}),[a,f])}};return i.scopeName=e,[s,Kne(i,...r)]}function Kne(...e){const r=e[0];if(e.length===1)return r;const n=()=>{const s=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(l){const d=s.reduce((a,{useScope:f,scopeName:p})=>{const v=f(l)[`__scope${p}`];return{...a,...v}},{});return O.useMemo(()=>({[`__scope${r.scopeName}`]:d}),[d])}};return n.scopeName=r.scopeName,n}function v2(e){const r=e+"CollectionProvider",[n,s]=Gne(r),[i,l]=n(r,{collectionRef:{current:null},itemMap:new Map}),d=w=>{const{scope:k,children:S}=w,R=me.useRef(null),D=me.useRef(new Map).current;return t.jsx(i,{scope:k,itemMap:D,collectionRef:R,children:S})};d.displayName=r;const a=e+"CollectionSlot",f=me.forwardRef((w,k)=>{const{scope:S,children:R}=w,D=l(a,S),T=yn(k,D.collectionRef);return t.jsx(yu,{ref:T,children:R})});f.displayName=a;const p=e+"CollectionItemSlot",y="data-radix-collection-item",v=me.forwardRef((w,k)=>{const{scope:S,children:R,...D}=w,T=me.useRef(null),I=yn(k,T),L=l(p,S);return me.useEffect(()=>(L.itemMap.set(T,{ref:T,...D}),()=>void L.itemMap.delete(T))),t.jsx(yu,{[y]:"",ref:I,children:R})});v.displayName=p;function j(w){const k=l(e+"CollectionConsumer",w);return me.useCallback(()=>{const R=k.collectionRef.current;if(!R)return[];const D=Array.from(R.querySelectorAll(`[${y}]`));return Array.from(k.itemMap.values()).sort((L,$)=>D.indexOf(L.ref.current)-D.indexOf($.ref.current))},[k.collectionRef,k.itemMap])}return[{Provider:d,Slot:f,ItemSlot:v},j,s]}function Hne(e,r){const n=O.createContext(r),s=l=>{const{children:d,...a}=l,f=O.useMemo(()=>a,Object.values(a));return t.jsx(n.Provider,{value:f,children:d})};s.displayName=e+"Provider";function i(l){const d=O.useContext(n);if(d)return d;if(r!==void 0)return r;throw new Error(`\`${l}\` must be used within \`${e}\``)}return[s,i]}function Ou(e,r=[]){let n=[];function s(l,d){const a=O.createContext(d),f=n.length;n=[...n,d];const p=v=>{var D;const{scope:j,children:w,...k}=v,S=((D=j==null?void 0:j[e])==null?void 0:D[f])||a,R=O.useMemo(()=>k,Object.values(k));return t.jsx(S.Provider,{value:R,children:w})};p.displayName=l+"Provider";function y(v,j){var S;const w=((S=j==null?void 0:j[e])==null?void 0:S[f])||a,k=O.useContext(w);if(k)return k;if(d!==void 0)return d;throw new Error(`\`${v}\` must be used within \`${l}\``)}return[p,y]}const i=()=>{const l=n.map(d=>O.createContext(d));return function(a){const f=(a==null?void 0:a[e])||l;return O.useMemo(()=>({[`__scope${e}`]:{...a,[e]:f}}),[a,f])}};return i.scopeName=e,[s,Zne(i,...r)]}function Zne(...e){const r=e[0];if(e.length===1)return r;const n=()=>{const s=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(l){const d=s.reduce((a,{useScope:f,scopeName:p})=>{const v=f(l)[`__scope${p}`];return{...a,...v}},{});return O.useMemo(()=>({[`__scope${r.scopeName}`]:d}),[d])}};return n.scopeName=r.scopeName,n}var Yne=O.createContext(void 0);function Iy(e){const r=O.useContext(Yne);return e||r||"ltr"}function Xi(e){const r=O.useRef(e);return O.useEffect(()=>{r.current=e}),O.useMemo(()=>(...n)=>{var s;return(s=r.current)==null?void 0:s.call(r,...n)},[])}function Xne(e,r=globalThis==null?void 0:globalThis.document){const n=Xi(e);O.useEffect(()=>{const s=i=>{i.key==="Escape"&&n(i)};return r.addEventListener("keydown",s,{capture:!0}),()=>r.removeEventListener("keydown",s,{capture:!0})},[n,r])}var Qne="DismissableLayer",KT="dismissableLayer.update",Jne="dismissableLayer.pointerDownOutside",ese="dismissableLayer.focusOutside",bL,TV=O.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),_2=O.forwardRef((e,r)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:l,onInteractOutside:d,onDismiss:a,...f}=e,p=O.useContext(TV),[y,v]=O.useState(null),j=(y==null?void 0:y.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,w]=O.useState({}),k=yn(r,Z=>v(Z)),S=Array.from(p.layers),[R]=[...p.layersWithOutsidePointerEventsDisabled].slice(-1),D=S.indexOf(R),T=y?S.indexOf(y):-1,I=p.layersWithOutsidePointerEventsDisabled.size>0,L=T>=D,$=nse(Z=>{const oe=Z.target,te=[...p.branches].some(be=>be.contains(oe));!L||te||(i==null||i(Z),d==null||d(Z),Z.defaultPrevented||a==null||a())},j),W=sse(Z=>{const oe=Z.target;[...p.branches].some(be=>be.contains(oe))||(l==null||l(Z),d==null||d(Z),Z.defaultPrevented||a==null||a())},j);return Xne(Z=>{T===p.layers.size-1&&(s==null||s(Z),!Z.defaultPrevented&&a&&(Z.preventDefault(),a()))},j),O.useEffect(()=>{if(y)return n&&(p.layersWithOutsidePointerEventsDisabled.size===0&&(bL=j.body.style.pointerEvents,j.body.style.pointerEvents="none"),p.layersWithOutsidePointerEventsDisabled.add(y)),p.layers.add(y),jL(),()=>{n&&p.layersWithOutsidePointerEventsDisabled.size===1&&(j.body.style.pointerEvents=bL)}},[y,j,n,p]),O.useEffect(()=>()=>{y&&(p.layers.delete(y),p.layersWithOutsidePointerEventsDisabled.delete(y),jL())},[y,p]),O.useEffect(()=>{const Z=()=>w({});return document.addEventListener(KT,Z),()=>document.removeEventListener(KT,Z)},[]),t.jsx(zr.div,{...f,ref:k,style:{pointerEvents:I?L?"auto":"none":void 0,...e.style},onFocusCapture:ar(e.onFocusCapture,W.onFocusCapture),onBlurCapture:ar(e.onBlurCapture,W.onBlurCapture),onPointerDownCapture:ar(e.onPointerDownCapture,$.onPointerDownCapture)})});_2.displayName=Qne;var tse="DismissableLayerBranch",rse=O.forwardRef((e,r)=>{const n=O.useContext(TV),s=O.useRef(null),i=yn(r,s);return O.useEffect(()=>{const l=s.current;if(l)return n.branches.add(l),()=>{n.branches.delete(l)}},[n.branches]),t.jsx(zr.div,{...e,ref:i})});rse.displayName=tse;function nse(e,r=globalThis==null?void 0:globalThis.document){const n=Xi(e),s=O.useRef(!1),i=O.useRef(()=>{});return O.useEffect(()=>{const l=a=>{if(a.target&&!s.current){let f=function(){EV(Jne,n,p,{discrete:!0})};const p={originalEvent:a};a.pointerType==="touch"?(r.removeEventListener("click",i.current),i.current=f,r.addEventListener("click",i.current,{once:!0})):f()}else r.removeEventListener("click",i.current);s.current=!1},d=window.setTimeout(()=>{r.addEventListener("pointerdown",l)},0);return()=>{window.clearTimeout(d),r.removeEventListener("pointerdown",l),r.removeEventListener("click",i.current)}},[r,n]),{onPointerDownCapture:()=>s.current=!0}}function sse(e,r=globalThis==null?void 0:globalThis.document){const n=Xi(e),s=O.useRef(!1);return O.useEffect(()=>{const i=l=>{l.target&&!s.current&&EV(ese,n,{originalEvent:l},{discrete:!1})};return r.addEventListener("focusin",i),()=>r.removeEventListener("focusin",i)},[r,n]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function jL(){const e=new CustomEvent(KT);document.dispatchEvent(e)}function EV(e,r,n,{discrete:s}){const i=n.originalEvent.target,l=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});r&&i.addEventListener(e,r,{once:!0}),s?dV(i,l):i.dispatchEvent(l)}var SA=0;function lI(){O.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??wL()),document.body.insertAdjacentElement("beforeend",e[1]??wL()),SA++,()=>{SA===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),SA--}},[])}function wL(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var PA="focusScope.autoFocusOnMount",CA="focusScope.autoFocusOnUnmount",NL={bubbles:!1,cancelable:!0},ise="FocusScope",b2=O.forwardRef((e,r)=>{const{loop:n=!1,trapped:s=!1,onMountAutoFocus:i,onUnmountAutoFocus:l,...d}=e,[a,f]=O.useState(null),p=Xi(i),y=Xi(l),v=O.useRef(null),j=yn(r,S=>f(S)),w=O.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;O.useEffect(()=>{if(s){let S=function(I){if(w.paused||!a)return;const L=I.target;a.contains(L)?v.current=L:vh(v.current,{select:!0})},R=function(I){if(w.paused||!a)return;const L=I.relatedTarget;L!==null&&(a.contains(L)||vh(v.current,{select:!0}))},D=function(I){if(document.activeElement===document.body)for(const $ of I)$.removedNodes.length>0&&vh(a)};document.addEventListener("focusin",S),document.addEventListener("focusout",R);const T=new MutationObserver(D);return a&&T.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",S),document.removeEventListener("focusout",R),T.disconnect()}}},[s,a,w.paused]),O.useEffect(()=>{if(a){PL.add(w);const S=document.activeElement;if(!a.contains(S)){const D=new CustomEvent(PA,NL);a.addEventListener(PA,p),a.dispatchEvent(D),D.defaultPrevented||(ase(use(MV(a)),{select:!0}),document.activeElement===S&&vh(a))}return()=>{a.removeEventListener(PA,p),setTimeout(()=>{const D=new CustomEvent(CA,NL);a.addEventListener(CA,y),a.dispatchEvent(D),D.defaultPrevented||vh(S??document.body,{select:!0}),a.removeEventListener(CA,y),PL.remove(w)},0)}}},[a,p,y,w]);const k=O.useCallback(S=>{if(!n&&!s||w.paused)return;const R=S.key==="Tab"&&!S.altKey&&!S.ctrlKey&&!S.metaKey,D=document.activeElement;if(R&&D){const T=S.currentTarget,[I,L]=ose(T);I&&L?!S.shiftKey&&D===L?(S.preventDefault(),n&&vh(I,{select:!0})):S.shiftKey&&D===I&&(S.preventDefault(),n&&vh(L,{select:!0})):D===T&&S.preventDefault()}},[n,s,w.paused]);return t.jsx(zr.div,{tabIndex:-1,...d,ref:j,onKeyDown:k})});b2.displayName=ise;function ase(e,{select:r=!1}={}){const n=document.activeElement;for(const s of e)if(vh(s,{select:r}),document.activeElement!==n)return}function ose(e){const r=MV(e),n=SL(r,e),s=SL(r.reverse(),e);return[n,s]}function MV(e){const r=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const i=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||i?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)r.push(n.currentNode);return r}function SL(e,r){for(const n of e)if(!lse(n,{upTo:r}))return n}function lse(e,{upTo:r}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(r!==void 0&&e===r)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function cse(e){return e instanceof HTMLInputElement&&"select"in e}function vh(e,{select:r=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&cse(e)&&r&&e.select()}}var PL=dse();function dse(){let e=[];return{add(r){const n=e[0];r!==n&&(n==null||n.pause()),e=CL(e,r),e.unshift(r)},remove(r){var n;e=CL(e,r),(n=e[0])==null||n.resume()}}}function CL(e,r){const n=[...e],s=n.indexOf(r);return s!==-1&&n.splice(s,1),n}function use(e){return e.filter(r=>r.tagName!=="A")}var Qa=globalThis!=null&&globalThis.document?O.useLayoutEffect:()=>{},hse=CB.useId||(()=>{}),mse=0;function ad(e){const[r,n]=O.useState(hse());return Qa(()=>{n(s=>s??String(mse++))},[e]),r?`radix-${r}`:""}const fse=["top","right","bottom","left"],cm=Math.min,Qo=Math.max,NN=Math.round,t1=Math.floor,od=e=>({x:e,y:e}),pse={left:"right",right:"left",bottom:"top",top:"bottom"},xse={start:"end",end:"start"};function HT(e,r,n){return Qo(e,cm(r,n))}function ju(e,r){return typeof e=="function"?e(r):e}function wu(e){return e.split("-")[0]}function Dy(e){return e.split("-")[1]}function cI(e){return e==="x"?"y":"x"}function dI(e){return e==="y"?"height":"width"}function dm(e){return["top","bottom"].includes(wu(e))?"y":"x"}function uI(e){return cI(dm(e))}function gse(e,r,n){n===void 0&&(n=!1);const s=Dy(e),i=uI(e),l=dI(i);let d=i==="x"?s===(n?"end":"start")?"right":"left":s==="start"?"bottom":"top";return r.reference[l]>r.floating[l]&&(d=SN(d)),[d,SN(d)]}function yse(e){const r=SN(e);return[ZT(e),r,ZT(r)]}function ZT(e){return e.replace(/start|end/g,r=>xse[r])}function vse(e,r,n){const s=["left","right"],i=["right","left"],l=["top","bottom"],d=["bottom","top"];switch(e){case"top":case"bottom":return n?r?i:s:r?s:i;case"left":case"right":return r?l:d;default:return[]}}function _se(e,r,n,s){const i=Dy(e);let l=vse(wu(e),n==="start",s);return i&&(l=l.map(d=>d+"-"+i),r&&(l=l.concat(l.map(ZT)))),l}function SN(e){return e.replace(/left|right|bottom|top/g,r=>pse[r])}function bse(e){return{top:0,right:0,bottom:0,left:0,...e}}function OV(e){return typeof e!="number"?bse(e):{top:e,right:e,bottom:e,left:e}}function PN(e){const{x:r,y:n,width:s,height:i}=e;return{width:s,height:i,top:n,left:r,right:r+s,bottom:n+i,x:r,y:n}}function AL(e,r,n){let{reference:s,floating:i}=e;const l=dm(r),d=uI(r),a=dI(d),f=wu(r),p=l==="y",y=s.x+s.width/2-i.width/2,v=s.y+s.height/2-i.height/2,j=s[a]/2-i[a]/2;let w;switch(f){case"top":w={x:y,y:s.y-i.height};break;case"bottom":w={x:y,y:s.y+s.height};break;case"right":w={x:s.x+s.width,y:v};break;case"left":w={x:s.x-i.width,y:v};break;default:w={x:s.x,y:s.y}}switch(Dy(r)){case"start":w[d]-=j*(n&&p?-1:1);break;case"end":w[d]+=j*(n&&p?-1:1);break}return w}const jse=async(e,r,n)=>{const{placement:s="bottom",strategy:i="absolute",middleware:l=[],platform:d}=n,a=l.filter(Boolean),f=await(d.isRTL==null?void 0:d.isRTL(r));let p=await d.getElementRects({reference:e,floating:r,strategy:i}),{x:y,y:v}=AL(p,s,f),j=s,w={},k=0;for(let S=0;S<a.length;S++){const{name:R,fn:D}=a[S],{x:T,y:I,data:L,reset:$}=await D({x:y,y:v,initialPlacement:s,placement:j,strategy:i,middlewareData:w,rects:p,platform:d,elements:{reference:e,floating:r}});y=T??y,v=I??v,w={...w,[R]:{...w[R],...L}},$&&k<=50&&(k++,typeof $=="object"&&($.placement&&(j=$.placement),$.rects&&(p=$.rects===!0?await d.getElementRects({reference:e,floating:r,strategy:i}):$.rects),{x:y,y:v}=AL(p,j,f)),S=-1)}return{x:y,y:v,placement:j,strategy:i,middlewareData:w}};async function V_(e,r){var n;r===void 0&&(r={});const{x:s,y:i,platform:l,rects:d,elements:a,strategy:f}=e,{boundary:p="clippingAncestors",rootBoundary:y="viewport",elementContext:v="floating",altBoundary:j=!1,padding:w=0}=ju(r,e),k=OV(w),R=a[j?v==="floating"?"reference":"floating":v],D=PN(await l.getClippingRect({element:(n=await(l.isElement==null?void 0:l.isElement(R)))==null||n?R:R.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(a.floating)),boundary:p,rootBoundary:y,strategy:f})),T=v==="floating"?{x:s,y:i,width:d.floating.width,height:d.floating.height}:d.reference,I=await(l.getOffsetParent==null?void 0:l.getOffsetParent(a.floating)),L=await(l.isElement==null?void 0:l.isElement(I))?await(l.getScale==null?void 0:l.getScale(I))||{x:1,y:1}:{x:1,y:1},$=PN(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:T,offsetParent:I,strategy:f}):T);return{top:(D.top-$.top+k.top)/L.y,bottom:($.bottom-D.bottom+k.bottom)/L.y,left:(D.left-$.left+k.left)/L.x,right:($.right-D.right+k.right)/L.x}}const wse=e=>({name:"arrow",options:e,async fn(r){const{x:n,y:s,placement:i,rects:l,platform:d,elements:a,middlewareData:f}=r,{element:p,padding:y=0}=ju(e,r)||{};if(p==null)return{};const v=OV(y),j={x:n,y:s},w=uI(i),k=dI(w),S=await d.getDimensions(p),R=w==="y",D=R?"top":"left",T=R?"bottom":"right",I=R?"clientHeight":"clientWidth",L=l.reference[k]+l.reference[w]-j[w]-l.floating[k],$=j[w]-l.reference[w],W=await(d.getOffsetParent==null?void 0:d.getOffsetParent(p));let Z=W?W[I]:0;(!Z||!await(d.isElement==null?void 0:d.isElement(W)))&&(Z=a.floating[I]||l.floating[k]);const oe=L/2-$/2,te=Z/2-S[k]/2-1,be=cm(v[D],te),ie=cm(v[T],te),ge=be,Ie=Z-S[k]-ie,Oe=Z/2-S[k]/2+oe,Xe=HT(ge,Oe,Ie),Ue=!f.arrow&&Dy(i)!=null&&Oe!==Xe&&l.reference[k]/2-(Oe<ge?be:ie)-S[k]/2<0,tt=Ue?Oe<ge?Oe-ge:Oe-Ie:0;return{[w]:j[w]+tt,data:{[w]:Xe,centerOffset:Oe-Xe-tt,...Ue&&{alignmentOffset:tt}},reset:Ue}}}),Nse=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(r){var n,s;const{placement:i,middlewareData:l,rects:d,initialPlacement:a,platform:f,elements:p}=r,{mainAxis:y=!0,crossAxis:v=!0,fallbackPlacements:j,fallbackStrategy:w="bestFit",fallbackAxisSideDirection:k="none",flipAlignment:S=!0,...R}=ju(e,r);if((n=l.arrow)!=null&&n.alignmentOffset)return{};const D=wu(i),T=dm(a),I=wu(a)===a,L=await(f.isRTL==null?void 0:f.isRTL(p.floating)),$=j||(I||!S?[SN(a)]:yse(a)),W=k!=="none";!j&&W&&$.push(..._se(a,S,k,L));const Z=[a,...$],oe=await V_(r,R),te=[];let be=((s=l.flip)==null?void 0:s.overflows)||[];if(y&&te.push(oe[D]),v){const Oe=gse(i,d,L);te.push(oe[Oe[0]],oe[Oe[1]])}if(be=[...be,{placement:i,overflows:te}],!te.every(Oe=>Oe<=0)){var ie,ge;const Oe=(((ie=l.flip)==null?void 0:ie.index)||0)+1,Xe=Z[Oe];if(Xe)return{data:{index:Oe,overflows:be},reset:{placement:Xe}};let Ue=(ge=be.filter(tt=>tt.overflows[0]<=0).sort((tt,Ce)=>tt.overflows[1]-Ce.overflows[1])[0])==null?void 0:ge.placement;if(!Ue)switch(w){case"bestFit":{var Ie;const tt=(Ie=be.filter(Ce=>{if(W){const ve=dm(Ce.placement);return ve===T||ve==="y"}return!0}).map(Ce=>[Ce.placement,Ce.overflows.filter(ve=>ve>0).reduce((ve,rt)=>ve+rt,0)]).sort((Ce,ve)=>Ce[1]-ve[1])[0])==null?void 0:Ie[0];tt&&(Ue=tt);break}case"initialPlacement":Ue=a;break}if(i!==Ue)return{reset:{placement:Ue}}}return{}}}};function kL(e,r){return{top:e.top-r.height,right:e.right-r.width,bottom:e.bottom-r.height,left:e.left-r.width}}function TL(e){return fse.some(r=>e[r]>=0)}const Sse=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(r){const{rects:n}=r,{strategy:s="referenceHidden",...i}=ju(e,r);switch(s){case"referenceHidden":{const l=await V_(r,{...i,elementContext:"reference"}),d=kL(l,n.reference);return{data:{referenceHiddenOffsets:d,referenceHidden:TL(d)}}}case"escaped":{const l=await V_(r,{...i,altBoundary:!0}),d=kL(l,n.floating);return{data:{escapedOffsets:d,escaped:TL(d)}}}default:return{}}}}};async function Pse(e,r){const{placement:n,platform:s,elements:i}=e,l=await(s.isRTL==null?void 0:s.isRTL(i.floating)),d=wu(n),a=Dy(n),f=dm(n)==="y",p=["left","top"].includes(d)?-1:1,y=l&&f?-1:1,v=ju(r,e);let{mainAxis:j,crossAxis:w,alignmentAxis:k}=typeof v=="number"?{mainAxis:v,crossAxis:0,alignmentAxis:null}:{mainAxis:v.mainAxis||0,crossAxis:v.crossAxis||0,alignmentAxis:v.alignmentAxis};return a&&typeof k=="number"&&(w=a==="end"?k*-1:k),f?{x:w*y,y:j*p}:{x:j*p,y:w*y}}const Cse=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(r){var n,s;const{x:i,y:l,placement:d,middlewareData:a}=r,f=await Pse(r,e);return d===((n=a.offset)==null?void 0:n.placement)&&(s=a.arrow)!=null&&s.alignmentOffset?{}:{x:i+f.x,y:l+f.y,data:{...f,placement:d}}}}},Ase=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(r){const{x:n,y:s,placement:i}=r,{mainAxis:l=!0,crossAxis:d=!1,limiter:a={fn:R=>{let{x:D,y:T}=R;return{x:D,y:T}}},...f}=ju(e,r),p={x:n,y:s},y=await V_(r,f),v=dm(wu(i)),j=cI(v);let w=p[j],k=p[v];if(l){const R=j==="y"?"top":"left",D=j==="y"?"bottom":"right",T=w+y[R],I=w-y[D];w=HT(T,w,I)}if(d){const R=v==="y"?"top":"left",D=v==="y"?"bottom":"right",T=k+y[R],I=k-y[D];k=HT(T,k,I)}const S=a.fn({...r,[j]:w,[v]:k});return{...S,data:{x:S.x-n,y:S.y-s,enabled:{[j]:l,[v]:d}}}}}},kse=function(e){return e===void 0&&(e={}),{options:e,fn(r){const{x:n,y:s,placement:i,rects:l,middlewareData:d}=r,{offset:a=0,mainAxis:f=!0,crossAxis:p=!0}=ju(e,r),y={x:n,y:s},v=dm(i),j=cI(v);let w=y[j],k=y[v];const S=ju(a,r),R=typeof S=="number"?{mainAxis:S,crossAxis:0}:{mainAxis:0,crossAxis:0,...S};if(f){const I=j==="y"?"height":"width",L=l.reference[j]-l.floating[I]+R.mainAxis,$=l.reference[j]+l.reference[I]-R.mainAxis;w<L?w=L:w>$&&(w=$)}if(p){var D,T;const I=j==="y"?"width":"height",L=["top","left"].includes(wu(i)),$=l.reference[v]-l.floating[I]+(L&&((D=d.offset)==null?void 0:D[v])||0)+(L?0:R.crossAxis),W=l.reference[v]+l.reference[I]+(L?0:((T=d.offset)==null?void 0:T[v])||0)-(L?R.crossAxis:0);k<$?k=$:k>W&&(k=W)}return{[j]:w,[v]:k}}}},Tse=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(r){var n,s;const{placement:i,rects:l,platform:d,elements:a}=r,{apply:f=()=>{},...p}=ju(e,r),y=await V_(r,p),v=wu(i),j=Dy(i),w=dm(i)==="y",{width:k,height:S}=l.floating;let R,D;v==="top"||v==="bottom"?(R=v,D=j===(await(d.isRTL==null?void 0:d.isRTL(a.floating))?"start":"end")?"left":"right"):(D=v,R=j==="end"?"top":"bottom");const T=S-y.top-y.bottom,I=k-y.left-y.right,L=cm(S-y[R],T),$=cm(k-y[D],I),W=!r.middlewareData.shift;let Z=L,oe=$;if((n=r.middlewareData.shift)!=null&&n.enabled.x&&(oe=I),(s=r.middlewareData.shift)!=null&&s.enabled.y&&(Z=T),W&&!j){const be=Qo(y.left,0),ie=Qo(y.right,0),ge=Qo(y.top,0),Ie=Qo(y.bottom,0);w?oe=k-2*(be!==0||ie!==0?be+ie:Qo(y.left,y.right)):Z=S-2*(ge!==0||Ie!==0?ge+Ie:Qo(y.top,y.bottom))}await f({...r,availableWidth:oe,availableHeight:Z});const te=await d.getDimensions(a.floating);return k!==te.width||S!==te.height?{reset:{rects:!0}}:{}}}};function j2(){return typeof window<"u"}function Ry(e){return IV(e)?(e.nodeName||"").toLowerCase():"#document"}function nl(e){var r;return(e==null||(r=e.ownerDocument)==null?void 0:r.defaultView)||window}function gd(e){var r;return(r=(IV(e)?e.ownerDocument:e.document)||window.document)==null?void 0:r.documentElement}function IV(e){return j2()?e instanceof Node||e instanceof nl(e).Node:!1}function kc(e){return j2()?e instanceof Element||e instanceof nl(e).Element:!1}function hd(e){return j2()?e instanceof HTMLElement||e instanceof nl(e).HTMLElement:!1}function EL(e){return!j2()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof nl(e).ShadowRoot}function Gb(e){const{overflow:r,overflowX:n,overflowY:s,display:i}=Tc(e);return/auto|scroll|overlay|hidden|clip/.test(r+s+n)&&!["inline","contents"].includes(i)}function Ese(e){return["table","td","th"].includes(Ry(e))}function w2(e){return[":popover-open",":modal"].some(r=>{try{return e.matches(r)}catch{return!1}})}function hI(e){const r=mI(),n=kc(e)?Tc(e):e;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!r&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!r&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(s=>(n.willChange||"").includes(s))||["paint","layout","strict","content"].some(s=>(n.contain||"").includes(s))}function Mse(e){let r=um(e);for(;hd(r)&&!qg(r);){if(hI(r))return r;if(w2(r))return null;r=um(r)}return null}function mI(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function qg(e){return["html","body","#document"].includes(Ry(e))}function Tc(e){return nl(e).getComputedStyle(e)}function N2(e){return kc(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function um(e){if(Ry(e)==="html")return e;const r=e.assignedSlot||e.parentNode||EL(e)&&e.host||gd(e);return EL(r)?r.host:r}function DV(e){const r=um(e);return qg(r)?e.ownerDocument?e.ownerDocument.body:e.body:hd(r)&&Gb(r)?r:DV(r)}function U_(e,r,n){var s;r===void 0&&(r=[]),n===void 0&&(n=!0);const i=DV(e),l=i===((s=e.ownerDocument)==null?void 0:s.body),d=nl(i);if(l){const a=YT(d);return r.concat(d,d.visualViewport||[],Gb(i)?i:[],a&&n?U_(a):[])}return r.concat(i,U_(i,[],n))}function YT(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function RV(e){const r=Tc(e);let n=parseFloat(r.width)||0,s=parseFloat(r.height)||0;const i=hd(e),l=i?e.offsetWidth:n,d=i?e.offsetHeight:s,a=NN(n)!==l||NN(s)!==d;return a&&(n=l,s=d),{width:n,height:s,$:a}}function fI(e){return kc(e)?e:e.contextElement}function mg(e){const r=fI(e);if(!hd(r))return od(1);const n=r.getBoundingClientRect(),{width:s,height:i,$:l}=RV(r);let d=(l?NN(n.width):n.width)/s,a=(l?NN(n.height):n.height)/i;return(!d||!Number.isFinite(d))&&(d=1),(!a||!Number.isFinite(a))&&(a=1),{x:d,y:a}}const Ose=od(0);function LV(e){const r=nl(e);return!mI()||!r.visualViewport?Ose:{x:r.visualViewport.offsetLeft,y:r.visualViewport.offsetTop}}function Ise(e,r,n){return r===void 0&&(r=!1),!n||r&&n!==nl(e)?!1:r}function ep(e,r,n,s){r===void 0&&(r=!1),n===void 0&&(n=!1);const i=e.getBoundingClientRect(),l=fI(e);let d=od(1);r&&(s?kc(s)&&(d=mg(s)):d=mg(e));const a=Ise(l,n,s)?LV(l):od(0);let f=(i.left+a.x)/d.x,p=(i.top+a.y)/d.y,y=i.width/d.x,v=i.height/d.y;if(l){const j=nl(l),w=s&&kc(s)?nl(s):s;let k=j,S=YT(k);for(;S&&s&&w!==k;){const R=mg(S),D=S.getBoundingClientRect(),T=Tc(S),I=D.left+(S.clientLeft+parseFloat(T.paddingLeft))*R.x,L=D.top+(S.clientTop+parseFloat(T.paddingTop))*R.y;f*=R.x,p*=R.y,y*=R.x,v*=R.y,f+=I,p+=L,k=nl(S),S=YT(k)}}return PN({width:y,height:v,x:f,y:p})}function pI(e,r){const n=N2(e).scrollLeft;return r?r.left+n:ep(gd(e)).left+n}function FV(e,r,n){n===void 0&&(n=!1);const s=e.getBoundingClientRect(),i=s.left+r.scrollLeft-(n?0:pI(e,s)),l=s.top+r.scrollTop;return{x:i,y:l}}function Dse(e){let{elements:r,rect:n,offsetParent:s,strategy:i}=e;const l=i==="fixed",d=gd(s),a=r?w2(r.floating):!1;if(s===d||a&&l)return n;let f={scrollLeft:0,scrollTop:0},p=od(1);const y=od(0),v=hd(s);if((v||!v&&!l)&&((Ry(s)!=="body"||Gb(d))&&(f=N2(s)),hd(s))){const w=ep(s);p=mg(s),y.x=w.x+s.clientLeft,y.y=w.y+s.clientTop}const j=d&&!v&&!l?FV(d,f,!0):od(0);return{width:n.width*p.x,height:n.height*p.y,x:n.x*p.x-f.scrollLeft*p.x+y.x+j.x,y:n.y*p.y-f.scrollTop*p.y+y.y+j.y}}function Rse(e){return Array.from(e.getClientRects())}function Lse(e){const r=gd(e),n=N2(e),s=e.ownerDocument.body,i=Qo(r.scrollWidth,r.clientWidth,s.scrollWidth,s.clientWidth),l=Qo(r.scrollHeight,r.clientHeight,s.scrollHeight,s.clientHeight);let d=-n.scrollLeft+pI(e);const a=-n.scrollTop;return Tc(s).direction==="rtl"&&(d+=Qo(r.clientWidth,s.clientWidth)-i),{width:i,height:l,x:d,y:a}}function Fse(e,r){const n=nl(e),s=gd(e),i=n.visualViewport;let l=s.clientWidth,d=s.clientHeight,a=0,f=0;if(i){l=i.width,d=i.height;const p=mI();(!p||p&&r==="fixed")&&(a=i.offsetLeft,f=i.offsetTop)}return{width:l,height:d,x:a,y:f}}function zse(e,r){const n=ep(e,!0,r==="fixed"),s=n.top+e.clientTop,i=n.left+e.clientLeft,l=hd(e)?mg(e):od(1),d=e.clientWidth*l.x,a=e.clientHeight*l.y,f=i*l.x,p=s*l.y;return{width:d,height:a,x:f,y:p}}function ML(e,r,n){let s;if(r==="viewport")s=Fse(e,n);else if(r==="document")s=Lse(gd(e));else if(kc(r))s=zse(r,n);else{const i=LV(e);s={x:r.x-i.x,y:r.y-i.y,width:r.width,height:r.height}}return PN(s)}function zV(e,r){const n=um(e);return n===r||!kc(n)||qg(n)?!1:Tc(n).position==="fixed"||zV(n,r)}function $se(e,r){const n=r.get(e);if(n)return n;let s=U_(e,[],!1).filter(a=>kc(a)&&Ry(a)!=="body"),i=null;const l=Tc(e).position==="fixed";let d=l?um(e):e;for(;kc(d)&&!qg(d);){const a=Tc(d),f=hI(d);!f&&a.position==="fixed"&&(i=null),(l?!f&&!i:!f&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Gb(d)&&!f&&zV(e,d))?s=s.filter(y=>y!==d):i=a,d=um(d)}return r.set(e,s),s}function Bse(e){let{element:r,boundary:n,rootBoundary:s,strategy:i}=e;const d=[...n==="clippingAncestors"?w2(r)?[]:$se(r,this._c):[].concat(n),s],a=d[0],f=d.reduce((p,y)=>{const v=ML(r,y,i);return p.top=Qo(v.top,p.top),p.right=cm(v.right,p.right),p.bottom=cm(v.bottom,p.bottom),p.left=Qo(v.left,p.left),p},ML(r,a,i));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}}function qse(e){const{width:r,height:n}=RV(e);return{width:r,height:n}}function Vse(e,r,n){const s=hd(r),i=gd(r),l=n==="fixed",d=ep(e,!0,l,r);let a={scrollLeft:0,scrollTop:0};const f=od(0);if(s||!s&&!l)if((Ry(r)!=="body"||Gb(i))&&(a=N2(r)),s){const j=ep(r,!0,l,r);f.x=j.x+r.clientLeft,f.y=j.y+r.clientTop}else i&&(f.x=pI(i));const p=i&&!s&&!l?FV(i,a):od(0),y=d.left+a.scrollLeft-f.x-p.x,v=d.top+a.scrollTop-f.y-p.y;return{x:y,y:v,width:d.width,height:d.height}}function AA(e){return Tc(e).position==="static"}function OL(e,r){if(!hd(e)||Tc(e).position==="fixed")return null;if(r)return r(e);let n=e.offsetParent;return gd(e)===n&&(n=n.ownerDocument.body),n}function $V(e,r){const n=nl(e);if(w2(e))return n;if(!hd(e)){let i=um(e);for(;i&&!qg(i);){if(kc(i)&&!AA(i))return i;i=um(i)}return n}let s=OL(e,r);for(;s&&Ese(s)&&AA(s);)s=OL(s,r);return s&&qg(s)&&AA(s)&&!hI(s)?n:s||Mse(e)||n}const Use=async function(e){const r=this.getOffsetParent||$V,n=this.getDimensions,s=await n(e.floating);return{reference:Vse(e.reference,await r(e.floating),e.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function Wse(e){return Tc(e).direction==="rtl"}const Gse={convertOffsetParentRelativeRectToViewportRelativeRect:Dse,getDocumentElement:gd,getClippingRect:Bse,getOffsetParent:$V,getElementRects:Use,getClientRects:Rse,getDimensions:qse,getScale:mg,isElement:kc,isRTL:Wse};function Kse(e,r){let n=null,s;const i=gd(e);function l(){var a;clearTimeout(s),(a=n)==null||a.disconnect(),n=null}function d(a,f){a===void 0&&(a=!1),f===void 0&&(f=1),l();const{left:p,top:y,width:v,height:j}=e.getBoundingClientRect();if(a||r(),!v||!j)return;const w=t1(y),k=t1(i.clientWidth-(p+v)),S=t1(i.clientHeight-(y+j)),R=t1(p),T={rootMargin:-w+"px "+-k+"px "+-S+"px "+-R+"px",threshold:Qo(0,cm(1,f))||1};let I=!0;function L($){const W=$[0].intersectionRatio;if(W!==f){if(!I)return d();W?d(!1,W):s=setTimeout(()=>{d(!1,1e-7)},1e3)}I=!1}try{n=new IntersectionObserver(L,{...T,root:i.ownerDocument})}catch{n=new IntersectionObserver(L,T)}n.observe(e)}return d(!0),l}function Hse(e,r,n,s){s===void 0&&(s={});const{ancestorScroll:i=!0,ancestorResize:l=!0,elementResize:d=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:f=!1}=s,p=fI(e),y=i||l?[...p?U_(p):[],...U_(r)]:[];y.forEach(D=>{i&&D.addEventListener("scroll",n,{passive:!0}),l&&D.addEventListener("resize",n)});const v=p&&a?Kse(p,n):null;let j=-1,w=null;d&&(w=new ResizeObserver(D=>{let[T]=D;T&&T.target===p&&w&&(w.unobserve(r),cancelAnimationFrame(j),j=requestAnimationFrame(()=>{var I;(I=w)==null||I.observe(r)})),n()}),p&&!f&&w.observe(p),w.observe(r));let k,S=f?ep(e):null;f&&R();function R(){const D=ep(e);S&&(D.x!==S.x||D.y!==S.y||D.width!==S.width||D.height!==S.height)&&n(),S=D,k=requestAnimationFrame(R)}return n(),()=>{var D;y.forEach(T=>{i&&T.removeEventListener("scroll",n),l&&T.removeEventListener("resize",n)}),v==null||v(),(D=w)==null||D.disconnect(),w=null,f&&cancelAnimationFrame(k)}}const Zse=Cse,Yse=Ase,Xse=Nse,Qse=Tse,Jse=Sse,IL=wse,eie=kse,tie=(e,r,n)=>{const s=new Map,i={platform:Gse,...n},l={...i.platform,_c:s};return jse(e,r,{...i,platform:l})};var B1=typeof document<"u"?O.useLayoutEffect:O.useEffect;function CN(e,r){if(e===r)return!0;if(typeof e!=typeof r)return!1;if(typeof e=="function"&&e.toString()===r.toString())return!0;let n,s,i;if(e&&r&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==r.length)return!1;for(s=n;s--!==0;)if(!CN(e[s],r[s]))return!1;return!0}if(i=Object.keys(e),n=i.length,n!==Object.keys(r).length)return!1;for(s=n;s--!==0;)if(!{}.hasOwnProperty.call(r,i[s]))return!1;for(s=n;s--!==0;){const l=i[s];if(!(l==="_owner"&&e.$$typeof)&&!CN(e[l],r[l]))return!1}return!0}return e!==e&&r!==r}function BV(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function DL(e,r){const n=BV(e);return Math.round(r*n)/n}function kA(e){const r=O.useRef(e);return B1(()=>{r.current=e}),r}function rie(e){e===void 0&&(e={});const{placement:r="bottom",strategy:n="absolute",middleware:s=[],platform:i,elements:{reference:l,floating:d}={},transform:a=!0,whileElementsMounted:f,open:p}=e,[y,v]=O.useState({x:0,y:0,strategy:n,placement:r,middlewareData:{},isPositioned:!1}),[j,w]=O.useState(s);CN(j,s)||w(s);const[k,S]=O.useState(null),[R,D]=O.useState(null),T=O.useCallback(Ce=>{Ce!==W.current&&(W.current=Ce,S(Ce))},[]),I=O.useCallback(Ce=>{Ce!==Z.current&&(Z.current=Ce,D(Ce))},[]),L=l||k,$=d||R,W=O.useRef(null),Z=O.useRef(null),oe=O.useRef(y),te=f!=null,be=kA(f),ie=kA(i),ge=kA(p),Ie=O.useCallback(()=>{if(!W.current||!Z.current)return;const Ce={placement:r,strategy:n,middleware:j};ie.current&&(Ce.platform=ie.current),tie(W.current,Z.current,Ce).then(ve=>{const rt={...ve,isPositioned:ge.current!==!1};Oe.current&&!CN(oe.current,rt)&&(oe.current=rt,_m.flushSync(()=>{v(rt)}))})},[j,r,n,ie,ge]);B1(()=>{p===!1&&oe.current.isPositioned&&(oe.current.isPositioned=!1,v(Ce=>({...Ce,isPositioned:!1})))},[p]);const Oe=O.useRef(!1);B1(()=>(Oe.current=!0,()=>{Oe.current=!1}),[]),B1(()=>{if(L&&(W.current=L),$&&(Z.current=$),L&&$){if(be.current)return be.current(L,$,Ie);Ie()}},[L,$,Ie,be,te]);const Xe=O.useMemo(()=>({reference:W,floating:Z,setReference:T,setFloating:I}),[T,I]),Ue=O.useMemo(()=>({reference:L,floating:$}),[L,$]),tt=O.useMemo(()=>{const Ce={position:n,left:0,top:0};if(!Ue.floating)return Ce;const ve=DL(Ue.floating,y.x),rt=DL(Ue.floating,y.y);return a?{...Ce,transform:"translate("+ve+"px, "+rt+"px)",...BV(Ue.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:ve,top:rt}},[n,a,Ue.floating,y.x,y.y]);return O.useMemo(()=>({...y,update:Ie,refs:Xe,elements:Ue,floatingStyles:tt}),[y,Ie,Xe,Ue,tt])}const nie=e=>{function r(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:s,padding:i}=typeof e=="function"?e(n):e;return s&&r(s)?s.current!=null?IL({element:s.current,padding:i}).fn(n):{}:s?IL({element:s,padding:i}).fn(n):{}}}},sie=(e,r)=>({...Zse(e),options:[e,r]}),iie=(e,r)=>({...Yse(e),options:[e,r]}),aie=(e,r)=>({...eie(e),options:[e,r]}),oie=(e,r)=>({...Xse(e),options:[e,r]}),lie=(e,r)=>({...Qse(e),options:[e,r]}),cie=(e,r)=>({...Jse(e),options:[e,r]}),die=(e,r)=>({...nie(e),options:[e,r]});var uie="Arrow",qV=O.forwardRef((e,r)=>{const{children:n,width:s=10,height:i=5,...l}=e;return t.jsx(zr.svg,{...l,ref:r,width:s,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:t.jsx("polygon",{points:"0,0 30,0 15,10"})})});qV.displayName=uie;var hie=qV;function mie(e,r=[]){let n=[];function s(l,d){const a=O.createContext(d),f=n.length;n=[...n,d];function p(v){const{scope:j,children:w,...k}=v,S=(j==null?void 0:j[e][f])||a,R=O.useMemo(()=>k,Object.values(k));return t.jsx(S.Provider,{value:R,children:w})}function y(v,j){const w=(j==null?void 0:j[e][f])||a,k=O.useContext(w);if(k)return k;if(d!==void 0)return d;throw new Error(`\`${v}\` must be used within \`${l}\``)}return p.displayName=l+"Provider",[p,y]}const i=()=>{const l=n.map(d=>O.createContext(d));return function(a){const f=(a==null?void 0:a[e])||l;return O.useMemo(()=>({[`__scope${e}`]:{...a,[e]:f}}),[a,f])}};return i.scopeName=e,[s,fie(i,...r)]}function fie(...e){const r=e[0];if(e.length===1)return r;const n=()=>{const s=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(l){const d=s.reduce((a,{useScope:f,scopeName:p})=>{const v=f(l)[`__scope${p}`];return{...a,...v}},{});return O.useMemo(()=>({[`__scope${r.scopeName}`]:d}),[d])}};return n.scopeName=r.scopeName,n}function S2(e){const[r,n]=O.useState(void 0);return Qa(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const s=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const l=i[0];let d,a;if("borderBoxSize"in l){const f=l.borderBoxSize,p=Array.isArray(f)?f[0]:f;d=p.inlineSize,a=p.blockSize}else d=e.offsetWidth,a=e.offsetHeight;n({width:d,height:a})});return s.observe(e,{box:"border-box"}),()=>s.unobserve(e)}else n(void 0)},[e]),r}var xI="Popper",[VV,P2]=mie(xI),[pie,UV]=VV(xI),WV=e=>{const{__scopePopper:r,children:n}=e,[s,i]=O.useState(null);return t.jsx(pie,{scope:r,anchor:s,onAnchorChange:i,children:n})};WV.displayName=xI;var GV="PopperAnchor",KV=O.forwardRef((e,r)=>{const{__scopePopper:n,virtualRef:s,...i}=e,l=UV(GV,n),d=O.useRef(null),a=yn(r,d);return O.useEffect(()=>{l.onAnchorChange((s==null?void 0:s.current)||d.current)}),s?null:t.jsx(zr.div,{...i,ref:a})});KV.displayName=GV;var gI="PopperContent",[xie,gie]=VV(gI),HV=O.forwardRef((e,r)=>{var It,_r,St,Qt,rr,pt;const{__scopePopper:n,side:s="bottom",sideOffset:i=0,align:l="center",alignOffset:d=0,arrowPadding:a=0,avoidCollisions:f=!0,collisionBoundary:p=[],collisionPadding:y=0,sticky:v="partial",hideWhenDetached:j=!1,updatePositionStrategy:w="optimized",onPlaced:k,...S}=e,R=UV(gI,n),[D,T]=O.useState(null),I=yn(r,qr=>T(qr)),[L,$]=O.useState(null),W=S2(L),Z=(W==null?void 0:W.width)??0,oe=(W==null?void 0:W.height)??0,te=s+(l!=="center"?"-"+l:""),be=typeof y=="number"?y:{top:0,right:0,bottom:0,left:0,...y},ie=Array.isArray(p)?p:[p],ge=ie.length>0,Ie={padding:be,boundary:ie.filter(vie),altBoundary:ge},{refs:Oe,floatingStyles:Xe,placement:Ue,isPositioned:tt,middlewareData:Ce}=rie({strategy:"fixed",placement:te,whileElementsMounted:(...qr)=>Hse(...qr,{animationFrame:w==="always"}),elements:{reference:R.anchor},middleware:[sie({mainAxis:i+oe,alignmentAxis:d}),f&&iie({mainAxis:!0,crossAxis:!1,limiter:v==="partial"?aie():void 0,...Ie}),f&&oie({...Ie}),lie({...Ie,apply:({elements:qr,rects:or,availableWidth:en,availableHeight:Lr})=>{const{width:En,height:ks}=or.reference,Yn=qr.floating.style;Yn.setProperty("--radix-popper-available-width",`${en}px`),Yn.setProperty("--radix-popper-available-height",`${Lr}px`),Yn.setProperty("--radix-popper-anchor-width",`${En}px`),Yn.setProperty("--radix-popper-anchor-height",`${ks}px`)}}),L&&die({element:L,padding:a}),_ie({arrowWidth:Z,arrowHeight:oe}),j&&cie({strategy:"referenceHidden",...Ie})]}),[ve,rt]=XV(Ue),vt=Xi(k);Qa(()=>{tt&&(vt==null||vt())},[tt,vt]);const gt=(It=Ce.arrow)==null?void 0:It.x,Et=(_r=Ce.arrow)==null?void 0:_r.y,tr=((St=Ce.arrow)==null?void 0:St.centerOffset)!==0,[Dr,Pr]=O.useState();return Qa(()=>{D&&Pr(window.getComputedStyle(D).zIndex)},[D]),t.jsx("div",{ref:Oe.setFloating,"data-radix-popper-content-wrapper":"",style:{...Xe,transform:tt?Xe.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Dr,"--radix-popper-transform-origin":[(Qt=Ce.transformOrigin)==null?void 0:Qt.x,(rr=Ce.transformOrigin)==null?void 0:rr.y].join(" "),...((pt=Ce.hide)==null?void 0:pt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:t.jsx(xie,{scope:n,placedSide:ve,onArrowChange:$,arrowX:gt,arrowY:Et,shouldHideArrow:tr,children:t.jsx(zr.div,{"data-side":ve,"data-align":rt,...S,ref:I,style:{...S.style,animation:tt?void 0:"none"}})})})});HV.displayName=gI;var ZV="PopperArrow",yie={top:"bottom",right:"left",bottom:"top",left:"right"},YV=O.forwardRef(function(r,n){const{__scopePopper:s,...i}=r,l=gie(ZV,s),d=yie[l.placedSide];return t.jsx("span",{ref:l.onArrowChange,style:{position:"absolute",left:l.arrowX,top:l.arrowY,[d]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[l.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[l.placedSide],visibility:l.shouldHideArrow?"hidden":void 0},children:t.jsx(hie,{...i,ref:n,style:{...i.style,display:"block"}})})});YV.displayName=ZV;function vie(e){return e!==null}var _ie=e=>({name:"transformOrigin",options:e,fn(r){var R,D,T;const{placement:n,rects:s,middlewareData:i}=r,d=((R=i.arrow)==null?void 0:R.centerOffset)!==0,a=d?0:e.arrowWidth,f=d?0:e.arrowHeight,[p,y]=XV(n),v={start:"0%",center:"50%",end:"100%"}[y],j=(((D=i.arrow)==null?void 0:D.x)??0)+a/2,w=(((T=i.arrow)==null?void 0:T.y)??0)+f/2;let k="",S="";return p==="bottom"?(k=d?v:`${j}px`,S=`${-f}px`):p==="top"?(k=d?v:`${j}px`,S=`${s.floating.height+f}px`):p==="right"?(k=`${-f}px`,S=d?v:`${w}px`):p==="left"&&(k=`${s.floating.width+f}px`,S=d?v:`${w}px`),{data:{x:k,y:S}}}});function XV(e){const[r,n="center"]=e.split("-");return[r,n]}var QV=WV,JV=KV,eU=HV,tU=YV,bie="Portal",C2=O.forwardRef((e,r)=>{var a;const{container:n,...s}=e,[i,l]=O.useState(!1);Qa(()=>l(!0),[]);const d=n||i&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return d?Tq.createPortal(t.jsx(zr.div,{...s,ref:r}),d):null});C2.displayName=bie;function Nu({prop:e,defaultProp:r,onChange:n=()=>{}}){const[s,i]=jie({defaultProp:r,onChange:n}),l=e!==void 0,d=l?e:s,a=Xi(n),f=O.useCallback(p=>{if(l){const v=typeof p=="function"?p(e):p;v!==e&&a(v)}else i(p)},[l,e,i,a]);return[d,f]}function jie({defaultProp:e,onChange:r}){const n=O.useState(e),[s]=n,i=O.useRef(s),l=Xi(r);return O.useEffect(()=>{i.current!==s&&(l(s),i.current=s)},[s,i,l]),n}function A2(e){const r=O.useRef({value:e,previous:e});return O.useMemo(()=>(r.current.value!==e&&(r.current.previous=r.current.value,r.current.value=e),r.current.previous),[e])}var wie="VisuallyHidden",rU=O.forwardRef((e,r)=>t.jsx(zr.span,{...e,ref:r,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));rU.displayName=wie;var Nie=function(e){if(typeof document>"u")return null;var r=Array.isArray(e)?e[0]:e;return r.ownerDocument.body},Cx=new WeakMap,r1=new WeakMap,n1={},TA=0,nU=function(e){return e&&(e.host||nU(e.parentNode))},Sie=function(e,r){return r.map(function(n){if(e.contains(n))return n;var s=nU(n);return s&&e.contains(s)?s:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},Pie=function(e,r,n,s){var i=Sie(r,Array.isArray(e)?e:[e]);n1[n]||(n1[n]=new WeakMap);var l=n1[n],d=[],a=new Set,f=new Set(i),p=function(v){!v||a.has(v)||(a.add(v),p(v.parentNode))};i.forEach(p);var y=function(v){!v||f.has(v)||Array.prototype.forEach.call(v.children,function(j){if(a.has(j))y(j);else try{var w=j.getAttribute(s),k=w!==null&&w!=="false",S=(Cx.get(j)||0)+1,R=(l.get(j)||0)+1;Cx.set(j,S),l.set(j,R),d.push(j),S===1&&k&&r1.set(j,!0),R===1&&j.setAttribute(n,"true"),k||j.setAttribute(s,"true")}catch(D){console.error("aria-hidden: cannot operate on ",j,D)}})};return y(r),a.clear(),TA++,function(){d.forEach(function(v){var j=Cx.get(v)-1,w=l.get(v)-1;Cx.set(v,j),l.set(v,w),j||(r1.has(v)||v.removeAttribute(s),r1.delete(v)),w||v.removeAttribute(n)}),TA--,TA||(Cx=new WeakMap,Cx=new WeakMap,r1=new WeakMap,n1={})}},yI=function(e,r,n){n===void 0&&(n="data-aria-hidden");var s=Array.from(Array.isArray(e)?e:[e]),i=Nie(e);return i?(s.push.apply(s,Array.from(i.querySelectorAll("[aria-live]"))),Pie(s,i,n,"aria-hidden")):function(){return null}},Xc=function(){return Xc=Object.assign||function(r){for(var n,s=1,i=arguments.length;s<i;s++){n=arguments[s];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(r[l]=n[l])}return r},Xc.apply(this,arguments)};function sU(e,r){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(e);i<s.length;i++)r.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]]);return n}function Cie(e,r,n){if(n||arguments.length===2)for(var s=0,i=r.length,l;s<i;s++)(l||!(s in r))&&(l||(l=Array.prototype.slice.call(r,0,s)),l[s]=r[s]);return e.concat(l||Array.prototype.slice.call(r))}var q1="right-scroll-bar-position",V1="width-before-scroll-bar",Aie="with-scroll-bars-hidden",kie="--removed-body-scroll-bar-size";function EA(e,r){return typeof e=="function"?e(r):e&&(e.current=r),e}function Tie(e,r){var n=O.useState(function(){return{value:e,callback:r,facade:{get current(){return n.value},set current(s){var i=n.value;i!==s&&(n.value=s,n.callback(s,i))}}}})[0];return n.callback=r,n.facade}var Eie=typeof window<"u"?O.useLayoutEffect:O.useEffect,RL=new WeakMap;function Mie(e,r){var n=Tie(null,function(s){return e.forEach(function(i){return EA(i,s)})});return Eie(function(){var s=RL.get(n);if(s){var i=new Set(s),l=new Set(e),d=n.current;i.forEach(function(a){l.has(a)||EA(a,null)}),l.forEach(function(a){i.has(a)||EA(a,d)})}RL.set(n,e)},[e]),n}function Oie(e){return e}function Iie(e,r){r===void 0&&(r=Oie);var n=[],s=!1,i={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(l){var d=r(l,s);return n.push(d),function(){n=n.filter(function(a){return a!==d})}},assignSyncMedium:function(l){for(s=!0;n.length;){var d=n;n=[],d.forEach(l)}n={push:function(a){return l(a)},filter:function(){return n}}},assignMedium:function(l){s=!0;var d=[];if(n.length){var a=n;n=[],a.forEach(l),d=n}var f=function(){var y=d;d=[],y.forEach(l)},p=function(){return Promise.resolve().then(f)};p(),n={push:function(y){d.push(y),p()},filter:function(y){return d=d.filter(y),n}}}};return i}function Die(e){e===void 0&&(e={});var r=Iie(null);return r.options=Xc({async:!0,ssr:!1},e),r}var iU=function(e){var r=e.sideCar,n=sU(e,["sideCar"]);if(!r)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=r.read();if(!s)throw new Error("Sidecar medium not found");return O.createElement(s,Xc({},n))};iU.isSideCarExport=!0;function Rie(e,r){return e.useMedium(r),iU}var aU=Die(),MA=function(){},k2=O.forwardRef(function(e,r){var n=O.useRef(null),s=O.useState({onScrollCapture:MA,onWheelCapture:MA,onTouchMoveCapture:MA}),i=s[0],l=s[1],d=e.forwardProps,a=e.children,f=e.className,p=e.removeScrollBar,y=e.enabled,v=e.shards,j=e.sideCar,w=e.noIsolation,k=e.inert,S=e.allowPinchZoom,R=e.as,D=R===void 0?"div":R,T=e.gapMode,I=sU(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),L=j,$=Mie([n,r]),W=Xc(Xc({},I),i);return O.createElement(O.Fragment,null,y&&O.createElement(L,{sideCar:aU,removeScrollBar:p,shards:v,noIsolation:w,inert:k,setCallbacks:l,allowPinchZoom:!!S,lockRef:n,gapMode:T}),d?O.cloneElement(O.Children.only(a),Xc(Xc({},W),{ref:$})):O.createElement(D,Xc({},W,{className:f,ref:$}),a))});k2.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};k2.classNames={fullWidth:V1,zeroRight:q1};var Lie=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Fie(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var r=Lie();return r&&e.setAttribute("nonce",r),e}function zie(e,r){e.styleSheet?e.styleSheet.cssText=r:e.appendChild(document.createTextNode(r))}function $ie(e){var r=document.head||document.getElementsByTagName("head")[0];r.appendChild(e)}var Bie=function(){var e=0,r=null;return{add:function(n){e==0&&(r=Fie())&&(zie(r,n),$ie(r)),e++},remove:function(){e--,!e&&r&&(r.parentNode&&r.parentNode.removeChild(r),r=null)}}},qie=function(){var e=Bie();return function(r,n){O.useEffect(function(){return e.add(r),function(){e.remove()}},[r&&n])}},oU=function(){var e=qie(),r=function(n){var s=n.styles,i=n.dynamic;return e(s,i),null};return r},Vie={left:0,top:0,right:0,gap:0},OA=function(e){return parseInt(e||"",10)||0},Uie=function(e){var r=window.getComputedStyle(document.body),n=r[e==="padding"?"paddingLeft":"marginLeft"],s=r[e==="padding"?"paddingTop":"marginTop"],i=r[e==="padding"?"paddingRight":"marginRight"];return[OA(n),OA(s),OA(i)]},Wie=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Vie;var r=Uie(e),n=document.documentElement.clientWidth,s=window.innerWidth;return{left:r[0],top:r[1],right:r[2],gap:Math.max(0,s-n+r[2]-r[0])}},Gie=oU(),fg="data-scroll-locked",Kie=function(e,r,n,s){var i=e.left,l=e.top,d=e.right,a=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(Aie,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(a,"px ").concat(s,`;
  }
  body[`).concat(fg,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([r&&"position: relative ".concat(s,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(l,`px;
    padding-right: `).concat(d,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(s,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(q1,` {
    right: `).concat(a,"px ").concat(s,`;
  }
  
  .`).concat(V1,` {
    margin-right: `).concat(a,"px ").concat(s,`;
  }
  
  .`).concat(q1," .").concat(q1,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(V1," .").concat(V1,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(fg,`] {
    `).concat(kie,": ").concat(a,`px;
  }
`)},LL=function(){var e=parseInt(document.body.getAttribute(fg)||"0",10);return isFinite(e)?e:0},Hie=function(){O.useEffect(function(){return document.body.setAttribute(fg,(LL()+1).toString()),function(){var e=LL()-1;e<=0?document.body.removeAttribute(fg):document.body.setAttribute(fg,e.toString())}},[])},Zie=function(e){var r=e.noRelative,n=e.noImportant,s=e.gapMode,i=s===void 0?"margin":s;Hie();var l=O.useMemo(function(){return Wie(i)},[i]);return O.createElement(Gie,{styles:Kie(l,!r,i,n?"":"!important")})},XT=!1;if(typeof window<"u")try{var s1=Object.defineProperty({},"passive",{get:function(){return XT=!0,!0}});window.addEventListener("test",s1,s1),window.removeEventListener("test",s1,s1)}catch{XT=!1}var Ax=XT?{passive:!1}:!1,Yie=function(e){return e.tagName==="TEXTAREA"},lU=function(e,r){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[r]!=="hidden"&&!(n.overflowY===n.overflowX&&!Yie(e)&&n[r]==="visible")},Xie=function(e){return lU(e,"overflowY")},Qie=function(e){return lU(e,"overflowX")},FL=function(e,r){var n=r.ownerDocument,s=r;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var i=cU(e,s);if(i){var l=dU(e,s),d=l[1],a=l[2];if(d>a)return!0}s=s.parentNode}while(s&&s!==n.body);return!1},Jie=function(e){var r=e.scrollTop,n=e.scrollHeight,s=e.clientHeight;return[r,n,s]},eae=function(e){var r=e.scrollLeft,n=e.scrollWidth,s=e.clientWidth;return[r,n,s]},cU=function(e,r){return e==="v"?Xie(r):Qie(r)},dU=function(e,r){return e==="v"?Jie(r):eae(r)},tae=function(e,r){return e==="h"&&r==="rtl"?-1:1},rae=function(e,r,n,s,i){var l=tae(e,window.getComputedStyle(r).direction),d=l*s,a=n.target,f=r.contains(a),p=!1,y=d>0,v=0,j=0;do{var w=dU(e,a),k=w[0],S=w[1],R=w[2],D=S-R-l*k;(k||D)&&cU(e,a)&&(v+=D,j+=k),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!f&&a!==document.body||f&&(r.contains(a)||r===a));return(y&&Math.abs(v)<1||!y&&Math.abs(j)<1)&&(p=!0),p},i1=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},zL=function(e){return[e.deltaX,e.deltaY]},$L=function(e){return e&&"current"in e?e.current:e},nae=function(e,r){return e[0]===r[0]&&e[1]===r[1]},sae=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},iae=0,kx=[];function aae(e){var r=O.useRef([]),n=O.useRef([0,0]),s=O.useRef(),i=O.useState(iae++)[0],l=O.useState(oU)[0],d=O.useRef(e);O.useEffect(function(){d.current=e},[e]),O.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var S=Cie([e.lockRef.current],(e.shards||[]).map($L),!0).filter(Boolean);return S.forEach(function(R){return R.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),S.forEach(function(R){return R.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var a=O.useCallback(function(S,R){if("touches"in S&&S.touches.length===2||S.type==="wheel"&&S.ctrlKey)return!d.current.allowPinchZoom;var D=i1(S),T=n.current,I="deltaX"in S?S.deltaX:T[0]-D[0],L="deltaY"in S?S.deltaY:T[1]-D[1],$,W=S.target,Z=Math.abs(I)>Math.abs(L)?"h":"v";if("touches"in S&&Z==="h"&&W.type==="range")return!1;var oe=FL(Z,W);if(!oe)return!0;if(oe?$=Z:($=Z==="v"?"h":"v",oe=FL(Z,W)),!oe)return!1;if(!s.current&&"changedTouches"in S&&(I||L)&&(s.current=$),!$)return!0;var te=s.current||$;return rae(te,R,S,te==="h"?I:L)},[]),f=O.useCallback(function(S){var R=S;if(!(!kx.length||kx[kx.length-1]!==l)){var D="deltaY"in R?zL(R):i1(R),T=r.current.filter(function($){return $.name===R.type&&($.target===R.target||R.target===$.shadowParent)&&nae($.delta,D)})[0];if(T&&T.should){R.cancelable&&R.preventDefault();return}if(!T){var I=(d.current.shards||[]).map($L).filter(Boolean).filter(function($){return $.contains(R.target)}),L=I.length>0?a(R,I[0]):!d.current.noIsolation;L&&R.cancelable&&R.preventDefault()}}},[]),p=O.useCallback(function(S,R,D,T){var I={name:S,delta:R,target:D,should:T,shadowParent:oae(D)};r.current.push(I),setTimeout(function(){r.current=r.current.filter(function(L){return L!==I})},1)},[]),y=O.useCallback(function(S){n.current=i1(S),s.current=void 0},[]),v=O.useCallback(function(S){p(S.type,zL(S),S.target,a(S,e.lockRef.current))},[]),j=O.useCallback(function(S){p(S.type,i1(S),S.target,a(S,e.lockRef.current))},[]);O.useEffect(function(){return kx.push(l),e.setCallbacks({onScrollCapture:v,onWheelCapture:v,onTouchMoveCapture:j}),document.addEventListener("wheel",f,Ax),document.addEventListener("touchmove",f,Ax),document.addEventListener("touchstart",y,Ax),function(){kx=kx.filter(function(S){return S!==l}),document.removeEventListener("wheel",f,Ax),document.removeEventListener("touchmove",f,Ax),document.removeEventListener("touchstart",y,Ax)}},[]);var w=e.removeScrollBar,k=e.inert;return O.createElement(O.Fragment,null,k?O.createElement(l,{styles:sae(i)}):null,w?O.createElement(Zie,{gapMode:e.gapMode}):null)}function oae(e){for(var r=null;e!==null;)e instanceof ShadowRoot&&(r=e.host,e=e.host),e=e.parentNode;return r}const lae=Rie(aU,aae);var T2=O.forwardRef(function(e,r){return O.createElement(k2,Xc({},e,{ref:r,sideCar:lae}))});T2.classNames=k2.classNames;var cae=[" ","Enter","ArrowUp","ArrowDown"],dae=[" ","Enter"],Kb="Select",[E2,M2,uae]=v2(Kb),[Ly]=Ou(Kb,[uae,P2]),O2=P2(),[hae,jm]=Ly(Kb),[mae,fae]=Ly(Kb),uU=e=>{const{__scopeSelect:r,children:n,open:s,defaultOpen:i,onOpenChange:l,value:d,defaultValue:a,onValueChange:f,dir:p,name:y,autoComplete:v,disabled:j,required:w,form:k}=e,S=O2(r),[R,D]=O.useState(null),[T,I]=O.useState(null),[L,$]=O.useState(!1),W=Iy(p),[Z=!1,oe]=Nu({prop:s,defaultProp:i,onChange:l}),[te,be]=Nu({prop:d,defaultProp:a,onChange:f}),ie=O.useRef(null),ge=R?k||!!R.closest("form"):!0,[Ie,Oe]=O.useState(new Set),Xe=Array.from(Ie).map(Ue=>Ue.props.value).join(";");return t.jsx(QV,{...S,children:t.jsxs(hae,{required:w,scope:r,trigger:R,onTriggerChange:D,valueNode:T,onValueNodeChange:I,valueNodeHasChildren:L,onValueNodeHasChildrenChange:$,contentId:ad(),value:te,onValueChange:be,open:Z,onOpenChange:oe,dir:W,triggerPointerDownPosRef:ie,disabled:j,children:[t.jsx(E2.Provider,{scope:r,children:t.jsx(mae,{scope:e.__scopeSelect,onNativeOptionAdd:O.useCallback(Ue=>{Oe(tt=>new Set(tt).add(Ue))},[]),onNativeOptionRemove:O.useCallback(Ue=>{Oe(tt=>{const Ce=new Set(tt);return Ce.delete(Ue),Ce})},[]),children:n})}),ge?t.jsxs(RU,{"aria-hidden":!0,required:w,tabIndex:-1,name:y,autoComplete:v,value:te,onChange:Ue=>be(Ue.target.value),disabled:j,form:k,children:[te===void 0?t.jsx("option",{value:""}):null,Array.from(Ie)]},Xe):null]})})};uU.displayName=Kb;var hU="SelectTrigger",mU=O.forwardRef((e,r)=>{const{__scopeSelect:n,disabled:s=!1,...i}=e,l=O2(n),d=jm(hU,n),a=d.disabled||s,f=yn(r,d.onTriggerChange),p=M2(n),y=O.useRef("touch"),[v,j,w]=LU(S=>{const R=p().filter(I=>!I.disabled),D=R.find(I=>I.value===d.value),T=FU(R,S,D);T!==void 0&&d.onValueChange(T.value)}),k=S=>{a||(d.onOpenChange(!0),w()),S&&(d.triggerPointerDownPosRef.current={x:Math.round(S.pageX),y:Math.round(S.pageY)})};return t.jsx(JV,{asChild:!0,...l,children:t.jsx(zr.button,{type:"button",role:"combobox","aria-controls":d.contentId,"aria-expanded":d.open,"aria-required":d.required,"aria-autocomplete":"none",dir:d.dir,"data-state":d.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":DU(d.value)?"":void 0,...i,ref:f,onClick:ar(i.onClick,S=>{S.currentTarget.focus(),y.current!=="mouse"&&k(S)}),onPointerDown:ar(i.onPointerDown,S=>{y.current=S.pointerType;const R=S.target;R.hasPointerCapture(S.pointerId)&&R.releasePointerCapture(S.pointerId),S.button===0&&S.ctrlKey===!1&&S.pointerType==="mouse"&&(k(S),S.preventDefault())}),onKeyDown:ar(i.onKeyDown,S=>{const R=v.current!=="";!(S.ctrlKey||S.altKey||S.metaKey)&&S.key.length===1&&j(S.key),!(R&&S.key===" ")&&cae.includes(S.key)&&(k(),S.preventDefault())})})})});mU.displayName=hU;var fU="SelectValue",pU=O.forwardRef((e,r)=>{const{__scopeSelect:n,className:s,style:i,children:l,placeholder:d="",...a}=e,f=jm(fU,n),{onValueNodeHasChildrenChange:p}=f,y=l!==void 0,v=yn(r,f.onValueNodeChange);return Qa(()=>{p(y)},[p,y]),t.jsx(zr.span,{...a,ref:v,style:{pointerEvents:"none"},children:DU(f.value)?t.jsx(t.Fragment,{children:d}):l})});pU.displayName=fU;var pae="SelectIcon",xU=O.forwardRef((e,r)=>{const{__scopeSelect:n,children:s,...i}=e;return t.jsx(zr.span,{"aria-hidden":!0,...i,ref:r,children:s||""})});xU.displayName=pae;var xae="SelectPortal",gU=e=>t.jsx(C2,{asChild:!0,...e});gU.displayName=xae;var tp="SelectContent",yU=O.forwardRef((e,r)=>{const n=jm(tp,e.__scopeSelect),[s,i]=O.useState();if(Qa(()=>{i(new DocumentFragment)},[]),!n.open){const l=s;return l?_m.createPortal(t.jsx(vU,{scope:e.__scopeSelect,children:t.jsx(E2.Slot,{scope:e.__scopeSelect,children:t.jsx("div",{children:e.children})})}),l):null}return t.jsx(_U,{...e,ref:r})});yU.displayName=tp;var cc=10,[vU,wm]=Ly(tp),gae="SelectContentImpl",_U=O.forwardRef((e,r)=>{const{__scopeSelect:n,position:s="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:l,onPointerDownOutside:d,side:a,sideOffset:f,align:p,alignOffset:y,arrowPadding:v,collisionBoundary:j,collisionPadding:w,sticky:k,hideWhenDetached:S,avoidCollisions:R,...D}=e,T=jm(tp,n),[I,L]=O.useState(null),[$,W]=O.useState(null),Z=yn(r,It=>L(It)),[oe,te]=O.useState(null),[be,ie]=O.useState(null),ge=M2(n),[Ie,Oe]=O.useState(!1),Xe=O.useRef(!1);O.useEffect(()=>{if(I)return yI(I)},[I]),lI();const Ue=O.useCallback(It=>{const[_r,...St]=ge().map(pt=>pt.ref.current),[Qt]=St.slice(-1),rr=document.activeElement;for(const pt of It)if(pt===rr||(pt==null||pt.scrollIntoView({block:"nearest"}),pt===_r&&$&&($.scrollTop=0),pt===Qt&&$&&($.scrollTop=$.scrollHeight),pt==null||pt.focus(),document.activeElement!==rr))return},[ge,$]),tt=O.useCallback(()=>Ue([oe,I]),[Ue,oe,I]);O.useEffect(()=>{Ie&&tt()},[Ie,tt]);const{onOpenChange:Ce,triggerPointerDownPosRef:ve}=T;O.useEffect(()=>{if(I){let It={x:0,y:0};const _r=Qt=>{var rr,pt;It={x:Math.abs(Math.round(Qt.pageX)-(((rr=ve.current)==null?void 0:rr.x)??0)),y:Math.abs(Math.round(Qt.pageY)-(((pt=ve.current)==null?void 0:pt.y)??0))}},St=Qt=>{It.x<=10&&It.y<=10?Qt.preventDefault():I.contains(Qt.target)||Ce(!1),document.removeEventListener("pointermove",_r),ve.current=null};return ve.current!==null&&(document.addEventListener("pointermove",_r),document.addEventListener("pointerup",St,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",_r),document.removeEventListener("pointerup",St,{capture:!0})}}},[I,Ce,ve]),O.useEffect(()=>{const It=()=>Ce(!1);return window.addEventListener("blur",It),window.addEventListener("resize",It),()=>{window.removeEventListener("blur",It),window.removeEventListener("resize",It)}},[Ce]);const[rt,vt]=LU(It=>{const _r=ge().filter(rr=>!rr.disabled),St=_r.find(rr=>rr.ref.current===document.activeElement),Qt=FU(_r,It,St);Qt&&setTimeout(()=>Qt.ref.current.focus())}),gt=O.useCallback((It,_r,St)=>{const Qt=!Xe.current&&!St;(T.value!==void 0&&T.value===_r||Qt)&&(te(It),Qt&&(Xe.current=!0))},[T.value]),Et=O.useCallback(()=>I==null?void 0:I.focus(),[I]),tr=O.useCallback((It,_r,St)=>{const Qt=!Xe.current&&!St;(T.value!==void 0&&T.value===_r||Qt)&&ie(It)},[T.value]),Dr=s==="popper"?QT:bU,Pr=Dr===QT?{side:a,sideOffset:f,align:p,alignOffset:y,arrowPadding:v,collisionBoundary:j,collisionPadding:w,sticky:k,hideWhenDetached:S,avoidCollisions:R}:{};return t.jsx(vU,{scope:n,content:I,viewport:$,onViewportChange:W,itemRefCallback:gt,selectedItem:oe,onItemLeave:Et,itemTextRefCallback:tr,focusSelectedItem:tt,selectedItemText:be,position:s,isPositioned:Ie,searchRef:rt,children:t.jsx(T2,{as:yu,allowPinchZoom:!0,children:t.jsx(b2,{asChild:!0,trapped:T.open,onMountAutoFocus:It=>{It.preventDefault()},onUnmountAutoFocus:ar(i,It=>{var _r;(_r=T.trigger)==null||_r.focus({preventScroll:!0}),It.preventDefault()}),children:t.jsx(_2,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:l,onPointerDownOutside:d,onFocusOutside:It=>It.preventDefault(),onDismiss:()=>T.onOpenChange(!1),children:t.jsx(Dr,{role:"listbox",id:T.contentId,"data-state":T.open?"open":"closed",dir:T.dir,onContextMenu:It=>It.preventDefault(),...D,...Pr,onPlaced:()=>Oe(!0),ref:Z,style:{display:"flex",flexDirection:"column",outline:"none",...D.style},onKeyDown:ar(D.onKeyDown,It=>{const _r=It.ctrlKey||It.altKey||It.metaKey;if(It.key==="Tab"&&It.preventDefault(),!_r&&It.key.length===1&&vt(It.key),["ArrowUp","ArrowDown","Home","End"].includes(It.key)){let Qt=ge().filter(rr=>!rr.disabled).map(rr=>rr.ref.current);if(["ArrowUp","End"].includes(It.key)&&(Qt=Qt.slice().reverse()),["ArrowUp","ArrowDown"].includes(It.key)){const rr=It.target,pt=Qt.indexOf(rr);Qt=Qt.slice(pt+1)}setTimeout(()=>Ue(Qt)),It.preventDefault()}})})})})})})});_U.displayName=gae;var yae="SelectItemAlignedPosition",bU=O.forwardRef((e,r)=>{const{__scopeSelect:n,onPlaced:s,...i}=e,l=jm(tp,n),d=wm(tp,n),[a,f]=O.useState(null),[p,y]=O.useState(null),v=yn(r,Z=>y(Z)),j=M2(n),w=O.useRef(!1),k=O.useRef(!0),{viewport:S,selectedItem:R,selectedItemText:D,focusSelectedItem:T}=d,I=O.useCallback(()=>{if(l.trigger&&l.valueNode&&a&&p&&S&&R&&D){const Z=l.trigger.getBoundingClientRect(),oe=p.getBoundingClientRect(),te=l.valueNode.getBoundingClientRect(),be=D.getBoundingClientRect();if(l.dir!=="rtl"){const rr=be.left-oe.left,pt=te.left-rr,qr=Z.left-pt,or=Z.width+qr,en=Math.max(or,oe.width),Lr=window.innerWidth-cc,En=q_(pt,[cc,Math.max(cc,Lr-en)]);a.style.minWidth=or+"px",a.style.left=En+"px"}else{const rr=oe.right-be.right,pt=window.innerWidth-te.right-rr,qr=window.innerWidth-Z.right-pt,or=Z.width+qr,en=Math.max(or,oe.width),Lr=window.innerWidth-cc,En=q_(pt,[cc,Math.max(cc,Lr-en)]);a.style.minWidth=or+"px",a.style.right=En+"px"}const ie=j(),ge=window.innerHeight-cc*2,Ie=S.scrollHeight,Oe=window.getComputedStyle(p),Xe=parseInt(Oe.borderTopWidth,10),Ue=parseInt(Oe.paddingTop,10),tt=parseInt(Oe.borderBottomWidth,10),Ce=parseInt(Oe.paddingBottom,10),ve=Xe+Ue+Ie+Ce+tt,rt=Math.min(R.offsetHeight*5,ve),vt=window.getComputedStyle(S),gt=parseInt(vt.paddingTop,10),Et=parseInt(vt.paddingBottom,10),tr=Z.top+Z.height/2-cc,Dr=ge-tr,Pr=R.offsetHeight/2,It=R.offsetTop+Pr,_r=Xe+Ue+It,St=ve-_r;if(_r<=tr){const rr=ie.length>0&&R===ie[ie.length-1].ref.current;a.style.bottom="0px";const pt=p.clientHeight-S.offsetTop-S.offsetHeight,qr=Math.max(Dr,Pr+(rr?Et:0)+pt+tt),or=_r+qr;a.style.height=or+"px"}else{const rr=ie.length>0&&R===ie[0].ref.current;a.style.top="0px";const qr=Math.max(tr,Xe+S.offsetTop+(rr?gt:0)+Pr)+St;a.style.height=qr+"px",S.scrollTop=_r-tr+S.offsetTop}a.style.margin=`${cc}px 0`,a.style.minHeight=rt+"px",a.style.maxHeight=ge+"px",s==null||s(),requestAnimationFrame(()=>w.current=!0)}},[j,l.trigger,l.valueNode,a,p,S,R,D,l.dir,s]);Qa(()=>I(),[I]);const[L,$]=O.useState();Qa(()=>{p&&$(window.getComputedStyle(p).zIndex)},[p]);const W=O.useCallback(Z=>{Z&&k.current===!0&&(I(),T==null||T(),k.current=!1)},[I,T]);return t.jsx(_ae,{scope:n,contentWrapper:a,shouldExpandOnScrollRef:w,onScrollButtonChange:W,children:t.jsx("div",{ref:f,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:L},children:t.jsx(zr.div,{...i,ref:v,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});bU.displayName=yae;var vae="SelectPopperPosition",QT=O.forwardRef((e,r)=>{const{__scopeSelect:n,align:s="start",collisionPadding:i=cc,...l}=e,d=O2(n);return t.jsx(eU,{...d,...l,ref:r,align:s,collisionPadding:i,style:{boxSizing:"border-box",...l.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});QT.displayName=vae;var[_ae,vI]=Ly(tp,{}),JT="SelectViewport",jU=O.forwardRef((e,r)=>{const{__scopeSelect:n,nonce:s,...i}=e,l=wm(JT,n),d=vI(JT,n),a=yn(r,l.onViewportChange),f=O.useRef(0);return t.jsxs(t.Fragment,{children:[t.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),t.jsx(E2.Slot,{scope:n,children:t.jsx(zr.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:ar(i.onScroll,p=>{const y=p.currentTarget,{contentWrapper:v,shouldExpandOnScrollRef:j}=d;if(j!=null&&j.current&&v){const w=Math.abs(f.current-y.scrollTop);if(w>0){const k=window.innerHeight-cc*2,S=parseFloat(v.style.minHeight),R=parseFloat(v.style.height),D=Math.max(S,R);if(D<k){const T=D+w,I=Math.min(k,T),L=T-I;v.style.height=I+"px",v.style.bottom==="0px"&&(y.scrollTop=L>0?L:0,v.style.justifyContent="flex-end")}}}f.current=y.scrollTop})})})]})});jU.displayName=JT;var wU="SelectGroup",[bae,jae]=Ly(wU),wae=O.forwardRef((e,r)=>{const{__scopeSelect:n,...s}=e,i=ad();return t.jsx(bae,{scope:n,id:i,children:t.jsx(zr.div,{role:"group","aria-labelledby":i,...s,ref:r})})});wae.displayName=wU;var NU="SelectLabel",SU=O.forwardRef((e,r)=>{const{__scopeSelect:n,...s}=e,i=jae(NU,n);return t.jsx(zr.div,{id:i.id,...s,ref:r})});SU.displayName=NU;var AN="SelectItem",[Nae,PU]=Ly(AN),CU=O.forwardRef((e,r)=>{const{__scopeSelect:n,value:s,disabled:i=!1,textValue:l,...d}=e,a=jm(AN,n),f=wm(AN,n),p=a.value===s,[y,v]=O.useState(l??""),[j,w]=O.useState(!1),k=yn(r,T=>{var I;return(I=f.itemRefCallback)==null?void 0:I.call(f,T,s,i)}),S=ad(),R=O.useRef("touch"),D=()=>{i||(a.onValueChange(s),a.onOpenChange(!1))};if(s==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return t.jsx(Nae,{scope:n,value:s,disabled:i,textId:S,isSelected:p,onItemTextChange:O.useCallback(T=>{v(I=>I||((T==null?void 0:T.textContent)??"").trim())},[]),children:t.jsx(E2.ItemSlot,{scope:n,value:s,disabled:i,textValue:y,children:t.jsx(zr.div,{role:"option","aria-labelledby":S,"data-highlighted":j?"":void 0,"aria-selected":p&&j,"data-state":p?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...d,ref:k,onFocus:ar(d.onFocus,()=>w(!0)),onBlur:ar(d.onBlur,()=>w(!1)),onClick:ar(d.onClick,()=>{R.current!=="mouse"&&D()}),onPointerUp:ar(d.onPointerUp,()=>{R.current==="mouse"&&D()}),onPointerDown:ar(d.onPointerDown,T=>{R.current=T.pointerType}),onPointerMove:ar(d.onPointerMove,T=>{var I;R.current=T.pointerType,i?(I=f.onItemLeave)==null||I.call(f):R.current==="mouse"&&T.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ar(d.onPointerLeave,T=>{var I;T.currentTarget===document.activeElement&&((I=f.onItemLeave)==null||I.call(f))}),onKeyDown:ar(d.onKeyDown,T=>{var L;((L=f.searchRef)==null?void 0:L.current)!==""&&T.key===" "||(dae.includes(T.key)&&D(),T.key===" "&&T.preventDefault())})})})})});CU.displayName=AN;var X0="SelectItemText",AU=O.forwardRef((e,r)=>{const{__scopeSelect:n,className:s,style:i,...l}=e,d=jm(X0,n),a=wm(X0,n),f=PU(X0,n),p=fae(X0,n),[y,v]=O.useState(null),j=yn(r,D=>v(D),f.onItemTextChange,D=>{var T;return(T=a.itemTextRefCallback)==null?void 0:T.call(a,D,f.value,f.disabled)}),w=y==null?void 0:y.textContent,k=O.useMemo(()=>t.jsx("option",{value:f.value,disabled:f.disabled,children:w},f.value),[f.disabled,f.value,w]),{onNativeOptionAdd:S,onNativeOptionRemove:R}=p;return Qa(()=>(S(k),()=>R(k)),[S,R,k]),t.jsxs(t.Fragment,{children:[t.jsx(zr.span,{id:f.textId,...l,ref:j}),f.isSelected&&d.valueNode&&!d.valueNodeHasChildren?_m.createPortal(l.children,d.valueNode):null]})});AU.displayName=X0;var kU="SelectItemIndicator",TU=O.forwardRef((e,r)=>{const{__scopeSelect:n,...s}=e;return PU(kU,n).isSelected?t.jsx(zr.span,{"aria-hidden":!0,...s,ref:r}):null});TU.displayName=kU;var eE="SelectScrollUpButton",EU=O.forwardRef((e,r)=>{const n=wm(eE,e.__scopeSelect),s=vI(eE,e.__scopeSelect),[i,l]=O.useState(!1),d=yn(r,s.onScrollButtonChange);return Qa(()=>{if(n.viewport&&n.isPositioned){let a=function(){const p=f.scrollTop>0;l(p)};const f=n.viewport;return a(),f.addEventListener("scroll",a),()=>f.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),i?t.jsx(OU,{...e,ref:d,onAutoScroll:()=>{const{viewport:a,selectedItem:f}=n;a&&f&&(a.scrollTop=a.scrollTop-f.offsetHeight)}}):null});EU.displayName=eE;var tE="SelectScrollDownButton",MU=O.forwardRef((e,r)=>{const n=wm(tE,e.__scopeSelect),s=vI(tE,e.__scopeSelect),[i,l]=O.useState(!1),d=yn(r,s.onScrollButtonChange);return Qa(()=>{if(n.viewport&&n.isPositioned){let a=function(){const p=f.scrollHeight-f.clientHeight,y=Math.ceil(f.scrollTop)<p;l(y)};const f=n.viewport;return a(),f.addEventListener("scroll",a),()=>f.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),i?t.jsx(OU,{...e,ref:d,onAutoScroll:()=>{const{viewport:a,selectedItem:f}=n;a&&f&&(a.scrollTop=a.scrollTop+f.offsetHeight)}}):null});MU.displayName=tE;var OU=O.forwardRef((e,r)=>{const{__scopeSelect:n,onAutoScroll:s,...i}=e,l=wm("SelectScrollButton",n),d=O.useRef(null),a=M2(n),f=O.useCallback(()=>{d.current!==null&&(window.clearInterval(d.current),d.current=null)},[]);return O.useEffect(()=>()=>f(),[f]),Qa(()=>{var y;const p=a().find(v=>v.ref.current===document.activeElement);(y=p==null?void 0:p.ref.current)==null||y.scrollIntoView({block:"nearest"})},[a]),t.jsx(zr.div,{"aria-hidden":!0,...i,ref:r,style:{flexShrink:0,...i.style},onPointerDown:ar(i.onPointerDown,()=>{d.current===null&&(d.current=window.setInterval(s,50))}),onPointerMove:ar(i.onPointerMove,()=>{var p;(p=l.onItemLeave)==null||p.call(l),d.current===null&&(d.current=window.setInterval(s,50))}),onPointerLeave:ar(i.onPointerLeave,()=>{f()})})}),Sae="SelectSeparator",IU=O.forwardRef((e,r)=>{const{__scopeSelect:n,...s}=e;return t.jsx(zr.div,{"aria-hidden":!0,...s,ref:r})});IU.displayName=Sae;var rE="SelectArrow",Pae=O.forwardRef((e,r)=>{const{__scopeSelect:n,...s}=e,i=O2(n),l=jm(rE,n),d=wm(rE,n);return l.open&&d.position==="popper"?t.jsx(tU,{...i,...s,ref:r}):null});Pae.displayName=rE;function DU(e){return e===""||e===void 0}var RU=O.forwardRef((e,r)=>{const{value:n,...s}=e,i=O.useRef(null),l=yn(r,i),d=A2(n);return O.useEffect(()=>{const a=i.current,f=window.HTMLSelectElement.prototype,y=Object.getOwnPropertyDescriptor(f,"value").set;if(d!==n&&y){const v=new Event("change",{bubbles:!0});y.call(a,n),a.dispatchEvent(v)}},[d,n]),t.jsx(rU,{asChild:!0,children:t.jsx("select",{...s,ref:l,defaultValue:n})})});RU.displayName="BubbleSelect";function LU(e){const r=Xi(e),n=O.useRef(""),s=O.useRef(0),i=O.useCallback(d=>{const a=n.current+d;r(a),function f(p){n.current=p,window.clearTimeout(s.current),p!==""&&(s.current=window.setTimeout(()=>f(""),1e3))}(a)},[r]),l=O.useCallback(()=>{n.current="",window.clearTimeout(s.current)},[]);return O.useEffect(()=>()=>window.clearTimeout(s.current),[]),[n,i,l]}function FU(e,r,n){const i=r.length>1&&Array.from(r).every(p=>p===r[0])?r[0]:r,l=n?e.indexOf(n):-1;let d=Cae(e,Math.max(l,0));i.length===1&&(d=d.filter(p=>p!==n));const f=d.find(p=>p.textValue.toLowerCase().startsWith(i.toLowerCase()));return f!==n?f:void 0}function Cae(e,r){return e.map((n,s)=>e[(r+s)%e.length])}var Aae=uU,zU=mU,kae=pU,Tae=xU,Eae=gU,$U=yU,Mae=jU,BU=SU,qU=CU,Oae=AU,Iae=TU,VU=EU,UU=MU,WU=IU;const $t=Aae,Bt=kae,Rt=O.forwardRef(({className:e,children:r,...n},s)=>t.jsxs(zU,{ref:s,className:gr("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[r,t.jsx(Tae,{asChild:!0,children:t.jsx(tI,{className:"h-4 w-4 opacity-50"})})]}));Rt.displayName=zU.displayName;const GU=O.forwardRef(({className:e,...r},n)=>t.jsx(VU,{ref:n,className:gr("flex cursor-default items-center justify-center py-1",e),...r,children:t.jsx(pne,{className:"h-4 w-4"})}));GU.displayName=VU.displayName;const KU=O.forwardRef(({className:e,...r},n)=>t.jsx(UU,{ref:n,className:gr("flex cursor-default items-center justify-center py-1",e),...r,children:t.jsx(tI,{className:"h-4 w-4"})}));KU.displayName=UU.displayName;const Lt=O.forwardRef(({className:e,children:r,position:n="popper",...s},i)=>t.jsx(Eae,{children:t.jsxs($U,{ref:i,className:gr("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...s,children:[t.jsx(GU,{}),t.jsx(Mae,{className:gr("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),t.jsx(KU,{})]})}));Lt.displayName=$U.displayName;const Dae=O.forwardRef(({className:e,...r},n)=>t.jsx(BU,{ref:n,className:gr("px-2 py-1.5 text-sm font-semibold",e),...r}));Dae.displayName=BU.displayName;const Ne=O.forwardRef(({className:e,children:r,...n},s)=>t.jsxs(qU,{ref:s,className:gr("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[t.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(Iae,{children:t.jsx(_u,{className:"h-4 w-4"})})}),t.jsx(Oae,{children:r})]}));Ne.displayName=qU.displayName;const Rae=O.forwardRef(({className:e,...r},n)=>t.jsx(WU,{ref:n,className:gr("-mx-1 my-1 h-px bg-muted",e),...r}));Rae.displayName=WU.displayName;function Lae(e,r){return O.useReducer((n,s)=>r[n][s]??n,e)}var Do=e=>{const{present:r,children:n}=e,s=Fae(r),i=typeof n=="function"?n({present:s.isPresent}):O.Children.only(n),l=yn(s.ref,zae(i));return typeof n=="function"||s.isPresent?O.cloneElement(i,{ref:l}):null};Do.displayName="Presence";function Fae(e){const[r,n]=O.useState(),s=O.useRef({}),i=O.useRef(e),l=O.useRef("none"),d=e?"mounted":"unmounted",[a,f]=Lae(d,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return O.useEffect(()=>{const p=a1(s.current);l.current=a==="mounted"?p:"none"},[a]),Qa(()=>{const p=s.current,y=i.current;if(y!==e){const j=l.current,w=a1(p);e?f("MOUNT"):w==="none"||(p==null?void 0:p.display)==="none"?f("UNMOUNT"):f(y&&j!==w?"ANIMATION_OUT":"UNMOUNT"),i.current=e}},[e,f]),Qa(()=>{if(r){let p;const y=r.ownerDocument.defaultView??window,v=w=>{const S=a1(s.current).includes(w.animationName);if(w.target===r&&S&&(f("ANIMATION_END"),!i.current)){const R=r.style.animationFillMode;r.style.animationFillMode="forwards",p=y.setTimeout(()=>{r.style.animationFillMode==="forwards"&&(r.style.animationFillMode=R)})}},j=w=>{w.target===r&&(l.current=a1(s.current))};return r.addEventListener("animationstart",j),r.addEventListener("animationcancel",v),r.addEventListener("animationend",v),()=>{y.clearTimeout(p),r.removeEventListener("animationstart",j),r.removeEventListener("animationcancel",v),r.removeEventListener("animationend",v)}}else f("ANIMATION_END")},[r,f]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:O.useCallback(p=>{p&&(s.current=getComputedStyle(p)),n(p)},[])}}function a1(e){return(e==null?void 0:e.animationName)||"none"}function zae(e){var s,i;let r=(s=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:s.get,n=r&&"isReactWarning"in r&&r.isReactWarning;return n?e.ref:(r=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,n=r&&"isReactWarning"in r&&r.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var _I="Dialog",[HU]=Ou(_I),[$ae,Ec]=HU(_I),ZU=e=>{const{__scopeDialog:r,children:n,open:s,defaultOpen:i,onOpenChange:l,modal:d=!0}=e,a=O.useRef(null),f=O.useRef(null),[p=!1,y]=Nu({prop:s,defaultProp:i,onChange:l});return t.jsx($ae,{scope:r,triggerRef:a,contentRef:f,contentId:ad(),titleId:ad(),descriptionId:ad(),open:p,onOpenChange:y,onOpenToggle:O.useCallback(()=>y(v=>!v),[y]),modal:d,children:n})};ZU.displayName=_I;var YU="DialogTrigger",XU=O.forwardRef((e,r)=>{const{__scopeDialog:n,...s}=e,i=Ec(YU,n),l=yn(r,i.triggerRef);return t.jsx(zr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":wI(i.open),...s,ref:l,onClick:ar(e.onClick,i.onOpenToggle)})});XU.displayName=YU;var bI="DialogPortal",[Bae,QU]=HU(bI,{forceMount:void 0}),JU=e=>{const{__scopeDialog:r,forceMount:n,children:s,container:i}=e,l=Ec(bI,r);return t.jsx(Bae,{scope:r,forceMount:n,children:O.Children.map(s,d=>t.jsx(Do,{present:n||l.open,children:t.jsx(C2,{asChild:!0,container:i,children:d})}))})};JU.displayName=bI;var kN="DialogOverlay",e9=O.forwardRef((e,r)=>{const n=QU(kN,e.__scopeDialog),{forceMount:s=n.forceMount,...i}=e,l=Ec(kN,e.__scopeDialog);return l.modal?t.jsx(Do,{present:s||l.open,children:t.jsx(qae,{...i,ref:r})}):null});e9.displayName=kN;var qae=O.forwardRef((e,r)=>{const{__scopeDialog:n,...s}=e,i=Ec(kN,n);return t.jsx(T2,{as:yu,allowPinchZoom:!0,shards:[i.contentRef],children:t.jsx(zr.div,{"data-state":wI(i.open),...s,ref:r,style:{pointerEvents:"auto",...s.style}})})}),rp="DialogContent",t9=O.forwardRef((e,r)=>{const n=QU(rp,e.__scopeDialog),{forceMount:s=n.forceMount,...i}=e,l=Ec(rp,e.__scopeDialog);return t.jsx(Do,{present:s||l.open,children:l.modal?t.jsx(Vae,{...i,ref:r}):t.jsx(Uae,{...i,ref:r})})});t9.displayName=rp;var Vae=O.forwardRef((e,r)=>{const n=Ec(rp,e.__scopeDialog),s=O.useRef(null),i=yn(r,n.contentRef,s);return O.useEffect(()=>{const l=s.current;if(l)return yI(l)},[]),t.jsx(r9,{...e,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ar(e.onCloseAutoFocus,l=>{var d;l.preventDefault(),(d=n.triggerRef.current)==null||d.focus()}),onPointerDownOutside:ar(e.onPointerDownOutside,l=>{const d=l.detail.originalEvent,a=d.button===0&&d.ctrlKey===!0;(d.button===2||a)&&l.preventDefault()}),onFocusOutside:ar(e.onFocusOutside,l=>l.preventDefault())})}),Uae=O.forwardRef((e,r)=>{const n=Ec(rp,e.__scopeDialog),s=O.useRef(!1),i=O.useRef(!1);return t.jsx(r9,{...e,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var d,a;(d=e.onCloseAutoFocus)==null||d.call(e,l),l.defaultPrevented||(s.current||(a=n.triggerRef.current)==null||a.focus(),l.preventDefault()),s.current=!1,i.current=!1},onInteractOutside:l=>{var f,p;(f=e.onInteractOutside)==null||f.call(e,l),l.defaultPrevented||(s.current=!0,l.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const d=l.target;((p=n.triggerRef.current)==null?void 0:p.contains(d))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&i.current&&l.preventDefault()}})}),r9=O.forwardRef((e,r)=>{const{__scopeDialog:n,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:l,...d}=e,a=Ec(rp,n),f=O.useRef(null),p=yn(r,f);return lI(),t.jsxs(t.Fragment,{children:[t.jsx(b2,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:i,onUnmountAutoFocus:l,children:t.jsx(_2,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":wI(a.open),...d,ref:p,onDismiss:()=>a.onOpenChange(!1)})}),t.jsxs(t.Fragment,{children:[t.jsx(Wae,{titleId:a.titleId}),t.jsx(Kae,{contentRef:f,descriptionId:a.descriptionId})]})]})}),jI="DialogTitle",n9=O.forwardRef((e,r)=>{const{__scopeDialog:n,...s}=e,i=Ec(jI,n);return t.jsx(zr.h2,{id:i.titleId,...s,ref:r})});n9.displayName=jI;var s9="DialogDescription",i9=O.forwardRef((e,r)=>{const{__scopeDialog:n,...s}=e,i=Ec(s9,n);return t.jsx(zr.p,{id:i.descriptionId,...s,ref:r})});i9.displayName=s9;var a9="DialogClose",o9=O.forwardRef((e,r)=>{const{__scopeDialog:n,...s}=e,i=Ec(a9,n);return t.jsx(zr.button,{type:"button",...s,ref:r,onClick:ar(e.onClick,()=>i.onOpenChange(!1))})});o9.displayName=a9;function wI(e){return e?"open":"closed"}var l9="DialogTitleWarning",[a6e,c9]=Hne(l9,{contentName:rp,titleName:jI,docsSlug:"dialog"}),Wae=({titleId:e})=>{const r=c9(l9),n=`\`${r.contentName}\` requires a \`${r.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${r.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${r.docsSlug}`;return O.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},Gae="DialogDescriptionWarning",Kae=({contentRef:e,descriptionId:r})=>{const s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${c9(Gae).contentName}}.`;return O.useEffect(()=>{var l;const i=(l=e.current)==null?void 0:l.getAttribute("aria-describedby");r&&i&&(document.getElementById(r)||console.warn(s))},[s,e,r]),null},d9=ZU,Hae=XU,u9=JU,I2=e9,D2=t9,R2=n9,L2=i9,h9=o9;const Or=d9,pn=Hae,Zae=u9,m9=O.forwardRef(({className:e,...r},n)=>t.jsx(I2,{ref:n,className:gr("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...r}));m9.displayName=I2.displayName;const kr=O.forwardRef(({className:e,children:r,...n},s)=>t.jsxs(Zae,{children:[t.jsx(m9,{}),t.jsxs(D2,{ref:s,className:gr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[r,t.jsxs(h9,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[t.jsx(bm,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));kr.displayName=D2.displayName;const Tr=({className:e,...r})=>t.jsx("div",{className:gr("flex flex-col space-y-1.5 text-center sm:text-left",e),...r});Tr.displayName="DialogHeader";const Ji=({className:e,...r})=>t.jsx("div",{className:gr("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...r});Ji.displayName="DialogFooter";const Er=O.forwardRef(({className:e,...r},n)=>t.jsx(R2,{ref:n,className:gr("text-lg font-semibold leading-none tracking-tight",e),...r}));Er.displayName=R2.displayName;const Pi=O.forwardRef(({className:e,...r},n)=>t.jsx(L2,{ref:n,className:gr("text-sm text-muted-foreground",e),...r}));Pi.displayName=L2.displayName;var Yae=e=>{switch(e){case"success":return Jae;case"info":return toe;case"warning":return eoe;case"error":return roe;default:return null}},Xae=Array(12).fill(0),Qae=({visible:e,className:r})=>me.createElement("div",{className:["sonner-loading-wrapper",r].filter(Boolean).join(" "),"data-visible":e},me.createElement("div",{className:"sonner-spinner"},Xae.map((n,s)=>me.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${s}`})))),Jae=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),eoe=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),toe=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),roe=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),noe=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},me.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),me.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),soe=()=>{let[e,r]=me.useState(document.hidden);return me.useEffect(()=>{let n=()=>{r(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},nE=1,ioe=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let r=this.subscribers.indexOf(e);this.subscribers.splice(r,1)}),this.publish=e=>{this.subscribers.forEach(r=>r(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var r;let{message:n,...s}=e,i=typeof(e==null?void 0:e.id)=="number"||((r=e.id)==null?void 0:r.length)>0?e.id:nE++,l=this.toasts.find(a=>a.id===i),d=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),l?this.toasts=this.toasts.map(a=>a.id===i?(this.publish({...a,...e,id:i,title:n}),{...a,...e,id:i,dismissible:d,title:n}):a):this.addToast({title:n,...s,dismissible:d,id:i}),i},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),this.subscribers.forEach(r=>r({id:e,dismiss:!0})),e),this.message=(e,r)=>this.create({...r,message:e}),this.error=(e,r)=>this.create({...r,message:e,type:"error"}),this.success=(e,r)=>this.create({...r,type:"success",message:e}),this.info=(e,r)=>this.create({...r,type:"info",message:e}),this.warning=(e,r)=>this.create({...r,type:"warning",message:e}),this.loading=(e,r)=>this.create({...r,type:"loading",message:e}),this.promise=(e,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:e,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));let s=e instanceof Promise?e:e(),i=n!==void 0,l,d=s.then(async f=>{if(l=["resolve",f],me.isValidElement(f))i=!1,this.create({id:n,type:"default",message:f});else if(ooe(f)&&!f.ok){i=!1;let p=typeof r.error=="function"?await r.error(`HTTP error! status: ${f.status}`):r.error,y=typeof r.description=="function"?await r.description(`HTTP error! status: ${f.status}`):r.description;this.create({id:n,type:"error",message:p,description:y})}else if(r.success!==void 0){i=!1;let p=typeof r.success=="function"?await r.success(f):r.success,y=typeof r.description=="function"?await r.description(f):r.description;this.create({id:n,type:"success",message:p,description:y})}}).catch(async f=>{if(l=["reject",f],r.error!==void 0){i=!1;let p=typeof r.error=="function"?await r.error(f):r.error,y=typeof r.description=="function"?await r.description(f):r.description;this.create({id:n,type:"error",message:p,description:y})}}).finally(()=>{var f;i&&(this.dismiss(n),n=void 0),(f=r.finally)==null||f.call(r)}),a=()=>new Promise((f,p)=>d.then(()=>l[0]==="reject"?p(l[1]):f(l[1])).catch(p));return typeof n!="string"&&typeof n!="number"?{unwrap:a}:Object.assign(n,{unwrap:a})},this.custom=(e,r)=>{let n=(r==null?void 0:r.id)||nE++;return this.create({jsx:e(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},wo=new ioe,aoe=(e,r)=>{let n=(r==null?void 0:r.id)||nE++;return wo.addToast({title:e,...r,id:n}),n},ooe=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",loe=aoe,coe=()=>wo.toasts,doe=()=>wo.getActiveToasts(),Ge=Object.assign(loe,{success:wo.success,info:wo.info,warning:wo.warning,error:wo.error,custom:wo.custom,message:wo.message,promise:wo.promise,dismiss:wo.dismiss,loading:wo.loading},{getHistory:coe,getToasts:doe});function uoe(e,{insertAt:r}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}uoe(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function o1(e){return e.label!==void 0}var hoe=3,moe="32px",foe="16px",BL=4e3,poe=356,xoe=14,goe=20,yoe=200;function oc(...e){return e.filter(Boolean).join(" ")}function voe(e){let[r,n]=e.split("-"),s=[];return r&&s.push(r),n&&s.push(n),s}var _oe=e=>{var r,n,s,i,l,d,a,f,p,y,v;let{invert:j,toast:w,unstyled:k,interacting:S,setHeights:R,visibleToasts:D,heights:T,index:I,toasts:L,expanded:$,removeToast:W,defaultRichColors:Z,closeButton:oe,style:te,cancelButtonStyle:be,actionButtonStyle:ie,className:ge="",descriptionClassName:Ie="",duration:Oe,position:Xe,gap:Ue,loadingIcon:tt,expandByDefault:Ce,classNames:ve,icons:rt,closeButtonAriaLabel:vt="Close toast",pauseWhenPageIsHidden:gt}=e,[Et,tr]=me.useState(null),[Dr,Pr]=me.useState(null),[It,_r]=me.useState(!1),[St,Qt]=me.useState(!1),[rr,pt]=me.useState(!1),[qr,or]=me.useState(!1),[en,Lr]=me.useState(!1),[En,ks]=me.useState(0),[Yn,qe]=me.useState(0),nt=me.useRef(w.duration||Oe||BL),xt=me.useRef(null),Ut=me.useRef(null),Vt=I===0,Ft=I+1<=D,sr=w.type,tn=w.dismissible!==!1,Pn=w.className||"",zs=w.descriptionClassName||"",We=me.useMemo(()=>T.findIndex(fr=>fr.toastId===w.id)||0,[T,w.id]),le=me.useMemo(()=>{var fr;return(fr=w.closeButton)!=null?fr:oe},[w.closeButton,oe]),ue=me.useMemo(()=>w.duration||Oe||BL,[w.duration,Oe]),ye=me.useRef(0),Ae=me.useRef(0),ze=me.useRef(0),Ye=me.useRef(null),[st,He]=Xe.split("-"),dt=me.useMemo(()=>T.reduce((fr,Gt,yr)=>yr>=We?fr:fr+Gt.height,0),[T,We]),Pt=soe(),yt=w.invert||j,lr=sr==="loading";Ae.current=me.useMemo(()=>We*Ue+dt,[We,dt]),me.useEffect(()=>{nt.current=ue},[ue]),me.useEffect(()=>{_r(!0)},[]),me.useEffect(()=>{let fr=Ut.current;if(fr){let Gt=fr.getBoundingClientRect().height;return qe(Gt),R(yr=>[{toastId:w.id,height:Gt,position:w.position},...yr]),()=>R(yr=>yr.filter(cn=>cn.toastId!==w.id))}},[R,w.id]),me.useLayoutEffect(()=>{if(!It)return;let fr=Ut.current,Gt=fr.style.height;fr.style.height="auto";let yr=fr.getBoundingClientRect().height;fr.style.height=Gt,qe(yr),R(cn=>cn.find(Cn=>Cn.toastId===w.id)?cn.map(Cn=>Cn.toastId===w.id?{...Cn,height:yr}:Cn):[{toastId:w.id,height:yr,position:w.position},...cn])},[It,w.title,w.description,R,w.id]);let Je=me.useCallback(()=>{Qt(!0),ks(Ae.current),R(fr=>fr.filter(Gt=>Gt.toastId!==w.id)),setTimeout(()=>{W(w)},yoe)},[w,W,R,Ae]);me.useEffect(()=>{if(w.promise&&sr==="loading"||w.duration===1/0||w.type==="loading")return;let fr;return $||S||gt&&Pt?(()=>{if(ze.current<ye.current){let Gt=new Date().getTime()-ye.current;nt.current=nt.current-Gt}ze.current=new Date().getTime()})():nt.current!==1/0&&(ye.current=new Date().getTime(),fr=setTimeout(()=>{var Gt;(Gt=w.onAutoClose)==null||Gt.call(w,w),Je()},nt.current)),()=>clearTimeout(fr)},[$,S,w,sr,gt,Pt,Je]),me.useEffect(()=>{w.delete&&Je()},[Je,w.delete]);function Qr(){var fr,Gt,yr;return rt!=null&&rt.loading?me.createElement("div",{className:oc(ve==null?void 0:ve.loader,(fr=w==null?void 0:w.classNames)==null?void 0:fr.loader,"sonner-loader"),"data-visible":sr==="loading"},rt.loading):tt?me.createElement("div",{className:oc(ve==null?void 0:ve.loader,(Gt=w==null?void 0:w.classNames)==null?void 0:Gt.loader,"sonner-loader"),"data-visible":sr==="loading"},tt):me.createElement(Qae,{className:oc(ve==null?void 0:ve.loader,(yr=w==null?void 0:w.classNames)==null?void 0:yr.loader),visible:sr==="loading"})}return me.createElement("li",{tabIndex:0,ref:Ut,className:oc(ge,Pn,ve==null?void 0:ve.toast,(r=w==null?void 0:w.classNames)==null?void 0:r.toast,ve==null?void 0:ve.default,ve==null?void 0:ve[sr],(n=w==null?void 0:w.classNames)==null?void 0:n[sr]),"data-sonner-toast":"","data-rich-colors":(s=w.richColors)!=null?s:Z,"data-styled":!(w.jsx||w.unstyled||k),"data-mounted":It,"data-promise":!!w.promise,"data-swiped":en,"data-removed":St,"data-visible":Ft,"data-y-position":st,"data-x-position":He,"data-index":I,"data-front":Vt,"data-swiping":rr,"data-dismissible":tn,"data-type":sr,"data-invert":yt,"data-swipe-out":qr,"data-swipe-direction":Dr,"data-expanded":!!($||Ce&&It),style:{"--index":I,"--toasts-before":I,"--z-index":L.length-I,"--offset":`${St?En:Ae.current}px`,"--initial-height":Ce?"auto":`${Yn}px`,...te,...w.style},onDragEnd:()=>{pt(!1),tr(null),Ye.current=null},onPointerDown:fr=>{lr||!tn||(xt.current=new Date,ks(Ae.current),fr.target.setPointerCapture(fr.pointerId),fr.target.tagName!=="BUTTON"&&(pt(!0),Ye.current={x:fr.clientX,y:fr.clientY}))},onPointerUp:()=>{var fr,Gt,yr,cn;if(qr||!tn)return;Ye.current=null;let Cn=Number(((fr=Ut.current)==null?void 0:fr.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Xn=Number(((Gt=Ut.current)==null?void 0:Gt.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Mn=new Date().getTime()-((yr=xt.current)==null?void 0:yr.getTime()),On=Et==="x"?Cn:Xn,An=Math.abs(On)/Mn;if(Math.abs(On)>=goe||An>.11){ks(Ae.current),(cn=w.onDismiss)==null||cn.call(w,w),Pr(Et==="x"?Cn>0?"right":"left":Xn>0?"down":"up"),Je(),or(!0),Lr(!1);return}pt(!1),tr(null)},onPointerMove:fr=>{var Gt,yr,cn,Cn;if(!Ye.current||!tn||((Gt=window.getSelection())==null?void 0:Gt.toString().length)>0)return;let Xn=fr.clientY-Ye.current.y,Mn=fr.clientX-Ye.current.x,On=(yr=e.swipeDirections)!=null?yr:voe(Xe);!Et&&(Math.abs(Mn)>1||Math.abs(Xn)>1)&&tr(Math.abs(Mn)>Math.abs(Xn)?"x":"y");let An={x:0,y:0};Et==="y"?(On.includes("top")||On.includes("bottom"))&&(On.includes("top")&&Xn<0||On.includes("bottom")&&Xn>0)&&(An.y=Xn):Et==="x"&&(On.includes("left")||On.includes("right"))&&(On.includes("left")&&Mn<0||On.includes("right")&&Mn>0)&&(An.x=Mn),(Math.abs(An.x)>0||Math.abs(An.y)>0)&&Lr(!0),(cn=Ut.current)==null||cn.style.setProperty("--swipe-amount-x",`${An.x}px`),(Cn=Ut.current)==null||Cn.style.setProperty("--swipe-amount-y",`${An.y}px`)}},le&&!w.jsx?me.createElement("button",{"aria-label":vt,"data-disabled":lr,"data-close-button":!0,onClick:lr||!tn?()=>{}:()=>{var fr;Je(),(fr=w.onDismiss)==null||fr.call(w,w)},className:oc(ve==null?void 0:ve.closeButton,(i=w==null?void 0:w.classNames)==null?void 0:i.closeButton)},(l=rt==null?void 0:rt.close)!=null?l:noe):null,w.jsx||O.isValidElement(w.title)?w.jsx?w.jsx:typeof w.title=="function"?w.title():w.title:me.createElement(me.Fragment,null,sr||w.icon||w.promise?me.createElement("div",{"data-icon":"",className:oc(ve==null?void 0:ve.icon,(d=w==null?void 0:w.classNames)==null?void 0:d.icon)},w.promise||w.type==="loading"&&!w.icon?w.icon||Qr():null,w.type!=="loading"?w.icon||(rt==null?void 0:rt[sr])||Yae(sr):null):null,me.createElement("div",{"data-content":"",className:oc(ve==null?void 0:ve.content,(a=w==null?void 0:w.classNames)==null?void 0:a.content)},me.createElement("div",{"data-title":"",className:oc(ve==null?void 0:ve.title,(f=w==null?void 0:w.classNames)==null?void 0:f.title)},typeof w.title=="function"?w.title():w.title),w.description?me.createElement("div",{"data-description":"",className:oc(Ie,zs,ve==null?void 0:ve.description,(p=w==null?void 0:w.classNames)==null?void 0:p.description)},typeof w.description=="function"?w.description():w.description):null),O.isValidElement(w.cancel)?w.cancel:w.cancel&&o1(w.cancel)?me.createElement("button",{"data-button":!0,"data-cancel":!0,style:w.cancelButtonStyle||be,onClick:fr=>{var Gt,yr;o1(w.cancel)&&tn&&((yr=(Gt=w.cancel).onClick)==null||yr.call(Gt,fr),Je())},className:oc(ve==null?void 0:ve.cancelButton,(y=w==null?void 0:w.classNames)==null?void 0:y.cancelButton)},w.cancel.label):null,O.isValidElement(w.action)?w.action:w.action&&o1(w.action)?me.createElement("button",{"data-button":!0,"data-action":!0,style:w.actionButtonStyle||ie,onClick:fr=>{var Gt,yr;o1(w.action)&&((yr=(Gt=w.action).onClick)==null||yr.call(Gt,fr),!fr.defaultPrevented&&Je())},className:oc(ve==null?void 0:ve.actionButton,(v=w==null?void 0:w.classNames)==null?void 0:v.actionButton)},w.action.label):null))};function qL(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function boe(e,r){let n={};return[e,r].forEach((s,i)=>{let l=i===1,d=l?"--mobile-offset":"--offset",a=l?foe:moe;function f(p){["top","right","bottom","left"].forEach(y=>{n[`${d}-${y}`]=typeof p=="number"?`${p}px`:p})}typeof s=="number"||typeof s=="string"?f(s):typeof s=="object"?["top","right","bottom","left"].forEach(p=>{s[p]===void 0?n[`${d}-${p}`]=a:n[`${d}-${p}`]=typeof s[p]=="number"?`${s[p]}px`:s[p]}):f(a)}),n}O.forwardRef(function(e,r){let{invert:n,position:s="bottom-right",hotkey:i=["altKey","KeyT"],expand:l,closeButton:d,className:a,offset:f,mobileOffset:p,theme:y="light",richColors:v,duration:j,style:w,visibleToasts:k=hoe,toastOptions:S,dir:R=qL(),gap:D=xoe,loadingIcon:T,icons:I,containerAriaLabel:L="Notifications",pauseWhenPageIsHidden:$}=e,[W,Z]=me.useState([]),oe=me.useMemo(()=>Array.from(new Set([s].concat(W.filter(gt=>gt.position).map(gt=>gt.position)))),[W,s]),[te,be]=me.useState([]),[ie,ge]=me.useState(!1),[Ie,Oe]=me.useState(!1),[Xe,Ue]=me.useState(y!=="system"?y:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),tt=me.useRef(null),Ce=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),ve=me.useRef(null),rt=me.useRef(!1),vt=me.useCallback(gt=>{Z(Et=>{var tr;return(tr=Et.find(Dr=>Dr.id===gt.id))!=null&&tr.delete||wo.dismiss(gt.id),Et.filter(({id:Dr})=>Dr!==gt.id)})},[]);return me.useEffect(()=>wo.subscribe(gt=>{if(gt.dismiss){Z(Et=>Et.map(tr=>tr.id===gt.id?{...tr,delete:!0}:tr));return}setTimeout(()=>{Tq.flushSync(()=>{Z(Et=>{let tr=Et.findIndex(Dr=>Dr.id===gt.id);return tr!==-1?[...Et.slice(0,tr),{...Et[tr],...gt},...Et.slice(tr+1)]:[gt,...Et]})})})}),[]),me.useEffect(()=>{if(y!=="system"){Ue(y);return}if(y==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Ue("dark"):Ue("light")),typeof window>"u")return;let gt=window.matchMedia("(prefers-color-scheme: dark)");try{gt.addEventListener("change",({matches:Et})=>{Ue(Et?"dark":"light")})}catch{gt.addListener(({matches:tr})=>{try{Ue(tr?"dark":"light")}catch(Dr){console.error(Dr)}})}},[y]),me.useEffect(()=>{W.length<=1&&ge(!1)},[W]),me.useEffect(()=>{let gt=Et=>{var tr,Dr;i.every(Pr=>Et[Pr]||Et.code===Pr)&&(ge(!0),(tr=tt.current)==null||tr.focus()),Et.code==="Escape"&&(document.activeElement===tt.current||(Dr=tt.current)!=null&&Dr.contains(document.activeElement))&&ge(!1)};return document.addEventListener("keydown",gt),()=>document.removeEventListener("keydown",gt)},[i]),me.useEffect(()=>{if(tt.current)return()=>{ve.current&&(ve.current.focus({preventScroll:!0}),ve.current=null,rt.current=!1)}},[tt.current]),me.createElement("section",{ref:r,"aria-label":`${L} ${Ce}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},oe.map((gt,Et)=>{var tr;let[Dr,Pr]=gt.split("-");return W.length?me.createElement("ol",{key:gt,dir:R==="auto"?qL():R,tabIndex:-1,ref:tt,className:a,"data-sonner-toaster":!0,"data-theme":Xe,"data-y-position":Dr,"data-lifted":ie&&W.length>1&&!l,"data-x-position":Pr,style:{"--front-toast-height":`${((tr=te[0])==null?void 0:tr.height)||0}px`,"--width":`${poe}px`,"--gap":`${D}px`,...w,...boe(f,p)},onBlur:It=>{rt.current&&!It.currentTarget.contains(It.relatedTarget)&&(rt.current=!1,ve.current&&(ve.current.focus({preventScroll:!0}),ve.current=null))},onFocus:It=>{It.target instanceof HTMLElement&&It.target.dataset.dismissible==="false"||rt.current||(rt.current=!0,ve.current=It.relatedTarget)},onMouseEnter:()=>ge(!0),onMouseMove:()=>ge(!0),onMouseLeave:()=>{Ie||ge(!1)},onDragEnd:()=>ge(!1),onPointerDown:It=>{It.target instanceof HTMLElement&&It.target.dataset.dismissible==="false"||Oe(!0)},onPointerUp:()=>Oe(!1)},W.filter(It=>!It.position&&Et===0||It.position===gt).map((It,_r)=>{var St,Qt;return me.createElement(_oe,{key:It.id,icons:I,index:_r,toast:It,defaultRichColors:v,duration:(St=S==null?void 0:S.duration)!=null?St:j,className:S==null?void 0:S.className,descriptionClassName:S==null?void 0:S.descriptionClassName,invert:n,visibleToasts:k,closeButton:(Qt=S==null?void 0:S.closeButton)!=null?Qt:d,interacting:Ie,position:gt,style:S==null?void 0:S.style,unstyled:S==null?void 0:S.unstyled,classNames:S==null?void 0:S.classNames,cancelButtonStyle:S==null?void 0:S.cancelButtonStyle,actionButtonStyle:S==null?void 0:S.actionButtonStyle,removeToast:vt,toasts:W.filter(rr=>rr.position==It.position),heights:te.filter(rr=>rr.position==It.position),setHeights:be,expandByDefault:l,gap:D,loadingIcon:T,expanded:ie,pauseWhenPageIsHidden:$,swipeDirections:e.swipeDirections})})):null}))});function joe(){const[e,r]=O.useState(!1),[n,s]=O.useState({code:"",name:"",category:"",status:"active",scheme_id:""}),i=Sr(),{data:l,isLoading:d,error:a}=ct({queryKey:["facilities"],queryFn:()=>_L.getAll({per_page:50})}),f=Nt({mutationFn:j=>_L.create(j),onSuccess:()=>{i.invalidateQueries({queryKey:["facilities"]}),r(!1),s({code:"",name:"",category:"",status:"active",scheme_id:""}),Ge.success("Facility created successfully")},onError:j=>{var w,k;Ge.error(((k=(w=j.response)==null?void 0:w.data)==null?void 0:k.message)||"Failed to create facility")}}),p=j=>{if(j.preventDefault(),!n.code||!n.name||!n.category){Ge.error("Please fill in all required fields");return}f.mutate(n)},y=async()=>{try{const j=await fetch("/api/v1/gis/facilities/export",{credentials:"include"});if(!j.ok)throw new Error(`HTTP ${j.status}`);const w=await j.blob(),k=window.URL.createObjectURL(w),S=document.createElement("a");S.href=k,S.download=`facilities-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(S),S.click(),window.URL.revokeObjectURL(k),document.body.removeChild(S)}catch(j){console.error("Export failed:",j)}},v={source:"bg-blue-500",treatment:"bg-green-500",pumpstation:"bg-purple-500",reservoir:"bg-cyan-500",office:"bg-gray-500",workshop:"bg-yellow-500",warehouse:"bg-orange-500",lab:"bg-pink-500"};return t.jsxs("div",{className:"container mx-auto p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Facilities"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage water infrastructure facilities"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(X,{variant:"outline",onClick:y,children:[t.jsx(Ta,{className:"mr-2 h-4 w-4"}),"Export GeoJSON"]}),t.jsxs(Or,{open:e,onOpenChange:r,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Create Facility"]})}),t.jsxs(kr,{children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:"Create New Facility"}),t.jsx(Pi,{children:"Add a new water infrastructure facility to the registry"})]}),t.jsxs("form",{onSubmit:p,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"code",children:"Code*"}),t.jsx(Ve,{id:"code",placeholder:"e.g. FAC-001",value:n.code,onChange:j=>s({...n,code:j.target.value}),required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"category",children:"Category*"}),t.jsxs($t,{value:n.category,onValueChange:j=>s({...n,category:j}),children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select category"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"source",children:"Water Source"}),t.jsx(Ne,{value:"treatment",children:"Treatment Plant"}),t.jsx(Ne,{value:"pumpstation",children:"Pump Station"}),t.jsx(Ne,{value:"reservoir",children:"Reservoir"}),t.jsx(Ne,{value:"office",children:"Office"}),t.jsx(Ne,{value:"workshop",children:"Workshop"}),t.jsx(Ne,{value:"warehouse",children:"Warehouse"}),t.jsx(Ne,{value:"lab",children:"Lab"})]})]})]})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"name",children:"Name*"}),t.jsx(Ve,{id:"name",placeholder:"Facility name",value:n.name,onChange:j=>s({...n,name:j.target.value}),required:!0})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"status",children:"Status"}),t.jsxs($t,{value:n.status,onValueChange:j=>s({...n,status:j}),children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"active",children:"Active"}),t.jsx(Ne,{value:"standby",children:"Standby"}),t.jsx(Ne,{value:"inactive",children:"Inactive"})]})]})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"scheme_id",children:"Scheme ID"}),t.jsx(Ve,{id:"scheme_id",placeholder:"Optional",value:n.scheme_id,onChange:j=>s({...n,scheme_id:j.target.value})})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:f.isPending,children:f.isPending?"Creating...":"Create Facility"})]})]})]})]})]})]}),d&&!l?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading facilities..."})}):a?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-lg text-red-600 mb-2",children:"Error loading facilities"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:a.message})]})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l==null?void 0:l.data.map(j=>t.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[t.jsx(de,{children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx(he,{children:j.name}),t.jsxs(cr,{children:["Code: ",j.code]})]}),t.jsx(Ee,{className:v[j.category]||"bg-gray-500",children:j.category})]})}),t.jsx(Q,{children:t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Status:"}),t.jsx("span",{className:`font-medium capitalize ${j.status==="active"?"text-green-600":j.status==="standby"?"text-yellow-600":"text-gray-600"}`,children:j.status})]}),j.scheme&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Scheme:"}),t.jsx("span",{className:"font-medium truncate ml-2",children:j.scheme.name})]}),j.commissioned_on&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Commissioned:"}),t.jsx("span",{className:"font-medium",children:new Date(j.commissioned_on).toLocaleDateString()})]})]})})]},j.id))}),(l==null?void 0:l.data.length)===0&&t.jsx(H,{children:t.jsxs(Q,{className:"flex flex-col items-center justify-center p-12",children:[t.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No facilities found"}),t.jsx(X,{children:"Create Your First Facility"})]})})]})]})}const ur=O.forwardRef(({className:e,...r},n)=>t.jsx("div",{className:"relative w-full overflow-auto",children:t.jsx("table",{ref:n,className:gr("w-full caption-bottom text-sm",e),...r})}));ur.displayName="Table";const hr=O.forwardRef(({className:e,...r},n)=>t.jsx("thead",{ref:n,className:gr("[&_tr]:border-b",e),...r}));hr.displayName="TableHeader";const mr=O.forwardRef(({className:e,...r},n)=>t.jsx("tbody",{ref:n,className:gr("[&_tr:last-child]:border-0",e),...r}));mr.displayName="TableBody";const woe=O.forwardRef(({className:e,...r},n)=>t.jsx("tfoot",{ref:n,className:gr("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...r}));woe.displayName="TableFooter";const ut=O.forwardRef(({className:e,...r},n)=>t.jsx("tr",{ref:n,className:gr("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...r}));ut.displayName="TableRow";const ce=O.forwardRef(({className:e,...r},n)=>t.jsx("th",{ref:n,className:gr("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...r}));ce.displayName="TableHead";const se=O.forwardRef(({className:e,...r},n)=>t.jsx("td",{ref:n,className:gr("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...r}));se.displayName="TableCell";const Noe=O.forwardRef(({className:e,...r},n)=>t.jsx("caption",{ref:n,className:gr("mt-4 text-sm text-muted-foreground",e),...r}));Noe.displayName="TableCaption";const Soe=d9,Poe=u9,f9=O.forwardRef(({className:e,...r},n)=>t.jsx(I2,{className:gr("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...r,ref:n}));f9.displayName=I2.displayName;const Coe=Wb("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),p9=O.forwardRef(({side:e="right",className:r,children:n,...s},i)=>t.jsxs(Poe,{children:[t.jsx(f9,{}),t.jsxs(D2,{ref:i,className:gr(Coe({side:e}),r),...s,children:[t.jsxs(h9,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[t.jsx(bm,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Close"})]}),n]})]}));p9.displayName=D2.displayName;const x9=({className:e,...r})=>t.jsx("div",{className:gr("flex flex-col space-y-2 text-center sm:text-left",e),...r});x9.displayName="SheetHeader";const g9=O.forwardRef(({className:e,...r},n)=>t.jsx(R2,{ref:n,className:gr("text-lg font-semibold text-foreground",e),...r}));g9.displayName=R2.displayName;const y9=O.forwardRef(({className:e,...r},n)=>t.jsx(L2,{ref:n,className:gr("text-sm text-muted-foreground",e),...r}));y9.displayName=L2.displayName;function Cs(e){const r=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&r==="[object Date]"?new e.constructor(+e):typeof e=="number"||r==="[object Number]"||typeof e=="string"||r==="[object String]"?new Date(e):new Date(NaN)}function hm(e,r){return e instanceof Date?new e.constructor(r):new Date(r)}function U1(e,r){const n=Cs(e);return isNaN(r)?hm(e,NaN):(r&&n.setDate(n.getDate()+r),n)}const v9=6048e5,Aoe=864e5,_9=6e4,b9=36e5;let koe={};function F2(){return koe}function np(e,r){var a,f,p,y;const n=F2(),s=(r==null?void 0:r.weekStartsOn)??((f=(a=r==null?void 0:r.locale)==null?void 0:a.options)==null?void 0:f.weekStartsOn)??n.weekStartsOn??((y=(p=n.locale)==null?void 0:p.options)==null?void 0:y.weekStartsOn)??0,i=Cs(e),l=i.getDay(),d=(l<s?7:0)+l-s;return i.setDate(i.getDate()-d),i.setHours(0,0,0,0),i}function TN(e){return np(e,{weekStartsOn:1})}function j9(e){const r=Cs(e),n=r.getFullYear(),s=hm(e,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const i=TN(s),l=hm(e,0);l.setFullYear(n,0,4),l.setHours(0,0,0,0);const d=TN(l);return r.getTime()>=i.getTime()?n+1:r.getTime()>=d.getTime()?n:n-1}function Vg(e){const r=Cs(e);return r.setHours(0,0,0,0),r}function VL(e){const r=Cs(e),n=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return n.setUTCFullYear(r.getFullYear()),+e-+n}function Toe(e,r){const n=Vg(e),s=Vg(r),i=+n-VL(n),l=+s-VL(s);return Math.round((i-l)/Aoe)}function Eoe(e){const r=j9(e),n=hm(e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),TN(n)}function IA(e,r){const n=Cs(e),s=Cs(r),i=n.getTime()-s.getTime();return i<0?-1:i>0?1:i}function UL(e,r){const n=Vg(e),s=Vg(r);return+n==+s}function Moe(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Ooe(e){if(!Moe(e)&&typeof e!="number")return!1;const r=Cs(e);return!isNaN(Number(r))}function Ioe(e,r){const n=Cs(e),s=Cs(r),i=n.getFullYear()-s.getFullYear(),l=n.getMonth()-s.getMonth();return i*12+l}function Doe(e){const r=Cs(e);return r.setHours(23,59,59,999),r}function Roe(e){const r=Cs(e),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function Loe(e){const r=Cs(e);return+Doe(r)==+Roe(r)}function Foe(e,r){const n=Cs(e),s=Cs(r),i=IA(n,s),l=Math.abs(Ioe(n,s));let d;if(l<1)d=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-i*l);let a=IA(n,s)===-i;Loe(Cs(e))&&l===1&&IA(e,s)===1&&(a=!1),d=i*(l-Number(a))}return d===0?0:d}function zoe(e,r){const n=Cs(e.start),s=Cs(e.end);let i=+n>+s;const l=i?+n:+s,d=i?s:n;d.setHours(0,0,0,0);let a=1;const f=[];for(;+d<=l;)f.push(Cs(d)),d.setDate(d.getDate()+a),d.setHours(0,0,0,0);return i?f.reverse():f}function $oe(e){const r=Cs(e),n=hm(e,0);return n.setFullYear(r.getFullYear(),0,1),n.setHours(0,0,0,0),n}function Boe(e,r){const n=r==null?void 0:r.weekStartsOn,s=Cs(e),i=s.getDay(),l=(i<n?-7:0)+6-(i-n);return s.setDate(s.getDate()+l),s.setHours(23,59,59,999),s}const qoe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Voe=(e,r,n)=>{let s;const i=qoe[e];return typeof i=="string"?s=i:r===1?s=i.one:s=i.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};function DA(e){return(r={})=>{const n=r.width?String(r.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const Uoe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Woe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Goe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Koe={date:DA({formats:Uoe,defaultWidth:"full"}),time:DA({formats:Woe,defaultWidth:"full"}),dateTime:DA({formats:Goe,defaultWidth:"full"})},Hoe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Zoe=(e,r,n,s)=>Hoe[e];function C0(e){return(r,n)=>{const s=n!=null&&n.context?String(n.context):"standalone";let i;if(s==="formatting"&&e.formattingValues){const d=e.defaultFormattingWidth||e.defaultWidth,a=n!=null&&n.width?String(n.width):d;i=e.formattingValues[a]||e.formattingValues[d]}else{const d=e.defaultWidth,a=n!=null&&n.width?String(n.width):e.defaultWidth;i=e.values[a]||e.values[d]}const l=e.argumentCallback?e.argumentCallback(r):r;return i[l]}}const Yoe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Xoe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Qoe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Joe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},ele={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},tle={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},rle=(e,r)=>{const n=Number(e),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},nle={ordinalNumber:rle,era:C0({values:Yoe,defaultWidth:"wide"}),quarter:C0({values:Xoe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:C0({values:Qoe,defaultWidth:"wide"}),day:C0({values:Joe,defaultWidth:"wide"}),dayPeriod:C0({values:ele,defaultWidth:"wide",formattingValues:tle,defaultFormattingWidth:"wide"})};function A0(e){return(r,n={})=>{const s=n.width,i=s&&e.matchPatterns[s]||e.matchPatterns[e.defaultMatchWidth],l=r.match(i);if(!l)return null;const d=l[0],a=s&&e.parsePatterns[s]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(a)?ile(a,v=>v.test(d)):sle(a,v=>v.test(d));let p;p=e.valueCallback?e.valueCallback(f):f,p=n.valueCallback?n.valueCallback(p):p;const y=r.slice(d.length);return{value:p,rest:y}}}function sle(e,r){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&r(e[n]))return n}function ile(e,r){for(let n=0;n<e.length;n++)if(r(e[n]))return n}function ale(e){return(r,n={})=>{const s=r.match(e.matchPattern);if(!s)return null;const i=s[0],l=r.match(e.parsePattern);if(!l)return null;let d=e.valueCallback?e.valueCallback(l[0]):l[0];d=n.valueCallback?n.valueCallback(d):d;const a=r.slice(i.length);return{value:d,rest:a}}}const ole=/^(\d+)(th|st|nd|rd)?/i,lle=/\d+/i,cle={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},dle={any:[/^b/i,/^(a|c)/i]},ule={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},hle={any:[/1/i,/2/i,/3/i,/4/i]},mle={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},fle={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},ple={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},xle={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},gle={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},yle={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},vle={ordinalNumber:ale({matchPattern:ole,parsePattern:lle,valueCallback:e=>parseInt(e,10)}),era:A0({matchPatterns:cle,defaultMatchWidth:"wide",parsePatterns:dle,defaultParseWidth:"any"}),quarter:A0({matchPatterns:ule,defaultMatchWidth:"wide",parsePatterns:hle,defaultParseWidth:"any",valueCallback:e=>e+1}),month:A0({matchPatterns:mle,defaultMatchWidth:"wide",parsePatterns:fle,defaultParseWidth:"any"}),day:A0({matchPatterns:ple,defaultMatchWidth:"wide",parsePatterns:xle,defaultParseWidth:"any"}),dayPeriod:A0({matchPatterns:gle,defaultMatchWidth:"any",parsePatterns:yle,defaultParseWidth:"any"})},_le={code:"en-US",formatDistance:Voe,formatLong:Koe,formatRelative:Zoe,localize:nle,match:vle,options:{weekStartsOn:0,firstWeekContainsDate:1}};function ble(e){const r=Cs(e);return Toe(r,$oe(r))+1}function jle(e){const r=Cs(e),n=+TN(r)-+Eoe(r);return Math.round(n/v9)+1}function w9(e,r){var y,v,j,w;const n=Cs(e),s=n.getFullYear(),i=F2(),l=(r==null?void 0:r.firstWeekContainsDate)??((v=(y=r==null?void 0:r.locale)==null?void 0:y.options)==null?void 0:v.firstWeekContainsDate)??i.firstWeekContainsDate??((w=(j=i.locale)==null?void 0:j.options)==null?void 0:w.firstWeekContainsDate)??1,d=hm(e,0);d.setFullYear(s+1,0,l),d.setHours(0,0,0,0);const a=np(d,r),f=hm(e,0);f.setFullYear(s,0,l),f.setHours(0,0,0,0);const p=np(f,r);return n.getTime()>=a.getTime()?s+1:n.getTime()>=p.getTime()?s:s-1}function wle(e,r){var a,f,p,y;const n=F2(),s=(r==null?void 0:r.firstWeekContainsDate)??((f=(a=r==null?void 0:r.locale)==null?void 0:a.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((y=(p=n.locale)==null?void 0:p.options)==null?void 0:y.firstWeekContainsDate)??1,i=w9(e,r),l=hm(e,0);return l.setFullYear(i,0,s),l.setHours(0,0,0,0),np(l,r)}function Nle(e,r){const n=Cs(e),s=+np(n,r)-+wle(n,r);return Math.round(s/v9)+1}function es(e,r){const n=e<0?"-":"",s=Math.abs(e).toString().padStart(r,"0");return n+s}const ph={y(e,r){const n=e.getFullYear(),s=n>0?n:1-n;return es(r==="yy"?s%100:s,r.length)},M(e,r){const n=e.getMonth();return r==="M"?String(n+1):es(n+1,2)},d(e,r){return es(e.getDate(),r.length)},a(e,r){const n=e.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,r){return es(e.getHours()%12||12,r.length)},H(e,r){return es(e.getHours(),r.length)},m(e,r){return es(e.getMinutes(),r.length)},s(e,r){return es(e.getSeconds(),r.length)},S(e,r){const n=r.length,s=e.getMilliseconds(),i=Math.trunc(s*Math.pow(10,n-3));return es(i,r.length)}},Tx={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},WL={G:function(e,r,n){const s=e.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return n.era(s,{width:"abbreviated"});case"GGGGG":return n.era(s,{width:"narrow"});case"GGGG":default:return n.era(s,{width:"wide"})}},y:function(e,r,n){if(r==="yo"){const s=e.getFullYear(),i=s>0?s:1-s;return n.ordinalNumber(i,{unit:"year"})}return ph.y(e,r)},Y:function(e,r,n,s){const i=w9(e,s),l=i>0?i:1-i;if(r==="YY"){const d=l%100;return es(d,2)}return r==="Yo"?n.ordinalNumber(l,{unit:"year"}):es(l,r.length)},R:function(e,r){const n=j9(e);return es(n,r.length)},u:function(e,r){const n=e.getFullYear();return es(n,r.length)},Q:function(e,r,n){const s=Math.ceil((e.getMonth()+1)/3);switch(r){case"Q":return String(s);case"QQ":return es(s,2);case"Qo":return n.ordinalNumber(s,{unit:"quarter"});case"QQQ":return n.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(s,{width:"wide",context:"formatting"})}},q:function(e,r,n){const s=Math.ceil((e.getMonth()+1)/3);switch(r){case"q":return String(s);case"qq":return es(s,2);case"qo":return n.ordinalNumber(s,{unit:"quarter"});case"qqq":return n.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(s,{width:"wide",context:"standalone"})}},M:function(e,r,n){const s=e.getMonth();switch(r){case"M":case"MM":return ph.M(e,r);case"Mo":return n.ordinalNumber(s+1,{unit:"month"});case"MMM":return n.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(s,{width:"wide",context:"formatting"})}},L:function(e,r,n){const s=e.getMonth();switch(r){case"L":return String(s+1);case"LL":return es(s+1,2);case"Lo":return n.ordinalNumber(s+1,{unit:"month"});case"LLL":return n.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(s,{width:"wide",context:"standalone"})}},w:function(e,r,n,s){const i=Nle(e,s);return r==="wo"?n.ordinalNumber(i,{unit:"week"}):es(i,r.length)},I:function(e,r,n){const s=jle(e);return r==="Io"?n.ordinalNumber(s,{unit:"week"}):es(s,r.length)},d:function(e,r,n){return r==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):ph.d(e,r)},D:function(e,r,n){const s=ble(e);return r==="Do"?n.ordinalNumber(s,{unit:"dayOfYear"}):es(s,r.length)},E:function(e,r,n){const s=e.getDay();switch(r){case"E":case"EE":case"EEE":return n.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(s,{width:"short",context:"formatting"});case"EEEE":default:return n.day(s,{width:"wide",context:"formatting"})}},e:function(e,r,n,s){const i=e.getDay(),l=(i-s.weekStartsOn+8)%7||7;switch(r){case"e":return String(l);case"ee":return es(l,2);case"eo":return n.ordinalNumber(l,{unit:"day"});case"eee":return n.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(i,{width:"short",context:"formatting"});case"eeee":default:return n.day(i,{width:"wide",context:"formatting"})}},c:function(e,r,n,s){const i=e.getDay(),l=(i-s.weekStartsOn+8)%7||7;switch(r){case"c":return String(l);case"cc":return es(l,r.length);case"co":return n.ordinalNumber(l,{unit:"day"});case"ccc":return n.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(i,{width:"narrow",context:"standalone"});case"cccccc":return n.day(i,{width:"short",context:"standalone"});case"cccc":default:return n.day(i,{width:"wide",context:"standalone"})}},i:function(e,r,n){const s=e.getDay(),i=s===0?7:s;switch(r){case"i":return String(i);case"ii":return es(i,r.length);case"io":return n.ordinalNumber(i,{unit:"day"});case"iii":return n.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(s,{width:"short",context:"formatting"});case"iiii":default:return n.day(s,{width:"wide",context:"formatting"})}},a:function(e,r,n){const i=e.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,r,n){const s=e.getHours();let i;switch(s===12?i=Tx.noon:s===0?i=Tx.midnight:i=s/12>=1?"pm":"am",r){case"b":case"bb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,r,n){const s=e.getHours();let i;switch(s>=17?i=Tx.evening:s>=12?i=Tx.afternoon:s>=4?i=Tx.morning:i=Tx.night,r){case"B":case"BB":case"BBB":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,r,n){if(r==="ho"){let s=e.getHours()%12;return s===0&&(s=12),n.ordinalNumber(s,{unit:"hour"})}return ph.h(e,r)},H:function(e,r,n){return r==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):ph.H(e,r)},K:function(e,r,n){const s=e.getHours()%12;return r==="Ko"?n.ordinalNumber(s,{unit:"hour"}):es(s,r.length)},k:function(e,r,n){let s=e.getHours();return s===0&&(s=24),r==="ko"?n.ordinalNumber(s,{unit:"hour"}):es(s,r.length)},m:function(e,r,n){return r==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):ph.m(e,r)},s:function(e,r,n){return r==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):ph.s(e,r)},S:function(e,r){return ph.S(e,r)},X:function(e,r,n){const s=e.getTimezoneOffset();if(s===0)return"Z";switch(r){case"X":return KL(s);case"XXXX":case"XX":return vf(s);case"XXXXX":case"XXX":default:return vf(s,":")}},x:function(e,r,n){const s=e.getTimezoneOffset();switch(r){case"x":return KL(s);case"xxxx":case"xx":return vf(s);case"xxxxx":case"xxx":default:return vf(s,":")}},O:function(e,r,n){const s=e.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+GL(s,":");case"OOOO":default:return"GMT"+vf(s,":")}},z:function(e,r,n){const s=e.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+GL(s,":");case"zzzz":default:return"GMT"+vf(s,":")}},t:function(e,r,n){const s=Math.trunc(e.getTime()/1e3);return es(s,r.length)},T:function(e,r,n){const s=e.getTime();return es(s,r.length)}};function GL(e,r=""){const n=e>0?"-":"+",s=Math.abs(e),i=Math.trunc(s/60),l=s%60;return l===0?n+String(i):n+String(i)+r+es(l,2)}function KL(e,r){return e%60===0?(e>0?"-":"+")+es(Math.abs(e)/60,2):vf(e,r)}function vf(e,r=""){const n=e>0?"-":"+",s=Math.abs(e),i=es(Math.trunc(s/60),2),l=es(s%60,2);return n+i+r+l}const HL=(e,r)=>{switch(e){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},N9=(e,r)=>{switch(e){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},Sle=(e,r)=>{const n=e.match(/(P+)(p+)?/)||[],s=n[1],i=n[2];if(!i)return HL(e,r);let l;switch(s){case"P":l=r.dateTime({width:"short"});break;case"PP":l=r.dateTime({width:"medium"});break;case"PPP":l=r.dateTime({width:"long"});break;case"PPPP":default:l=r.dateTime({width:"full"});break}return l.replace("{{date}}",HL(s,r)).replace("{{time}}",N9(i,r))},Ple={p:N9,P:Sle},Cle=/^D+$/,Ale=/^Y+$/,kle=["D","DD","YY","YYYY"];function Tle(e){return Cle.test(e)}function Ele(e){return Ale.test(e)}function Mle(e,r,n){const s=Ole(e,r,n);if(console.warn(s),kle.includes(e))throw new RangeError(s)}function Ole(e,r,n){const s=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${r}\`) for formatting ${s} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Ile=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Dle=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Rle=/^'([^]*?)'?$/,Lle=/''/g,Fle=/[a-zA-Z]/;function wn(e,r,n){var y,v,j,w;const s=F2(),i=s.locale??_le,l=s.firstWeekContainsDate??((v=(y=s.locale)==null?void 0:y.options)==null?void 0:v.firstWeekContainsDate)??1,d=s.weekStartsOn??((w=(j=s.locale)==null?void 0:j.options)==null?void 0:w.weekStartsOn)??0,a=Cs(e);if(!Ooe(a))throw new RangeError("Invalid time value");let f=r.match(Dle).map(k=>{const S=k[0];if(S==="p"||S==="P"){const R=Ple[S];return R(k,i.formatLong)}return k}).join("").match(Ile).map(k=>{if(k==="''")return{isToken:!1,value:"'"};const S=k[0];if(S==="'")return{isToken:!1,value:zle(k)};if(WL[S])return{isToken:!0,value:k};if(S.match(Fle))throw new RangeError("Format string contains an unescaped latin alphabet character `"+S+"`");return{isToken:!1,value:k}});i.localize.preprocessor&&(f=i.localize.preprocessor(a,f));const p={firstWeekContainsDate:l,weekStartsOn:d,locale:i};return f.map(k=>{if(!k.isToken)return k.value;const S=k.value;(Ele(S)||Tle(S))&&Mle(S,r,String(e));const R=WL[S[0]];return R(a,S,i.localize,p)}).join("")}function zle(e){const r=e.match(Rle);return r?r[1].replace(Lle,"'"):e}function _h(e,r){const s=Vle(e);let i;if(s.date){const f=Ule(s.date,2);i=Wle(f.restDateString,f.year)}if(!i||isNaN(i.getTime()))return new Date(NaN);const l=i.getTime();let d=0,a;if(s.time&&(d=Gle(s.time),isNaN(d)))return new Date(NaN);if(s.timezone){if(a=Kle(s.timezone),isNaN(a))return new Date(NaN)}else{const f=new Date(l+d),p=new Date(0);return p.setFullYear(f.getUTCFullYear(),f.getUTCMonth(),f.getUTCDate()),p.setHours(f.getUTCHours(),f.getUTCMinutes(),f.getUTCSeconds(),f.getUTCMilliseconds()),p}return new Date(l+d+a)}const l1={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},$le=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Ble=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,qle=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Vle(e){const r={},n=e.split(l1.dateTimeDelimiter);let s;if(n.length>2)return r;if(/:/.test(n[0])?s=n[0]:(r.date=n[0],s=n[1],l1.timeZoneDelimiter.test(r.date)&&(r.date=e.split(l1.timeZoneDelimiter)[0],s=e.substr(r.date.length,e.length))),s){const i=l1.timezone.exec(s);i?(r.time=s.replace(i[1],""),r.timezone=i[1]):r.time=s}return r}function Ule(e,r){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+r)+"})|(\\d{2}|[+-]\\d{"+(2+r)+"})$)"),s=e.match(n);if(!s)return{year:NaN,restDateString:""};const i=s[1]?parseInt(s[1]):null,l=s[2]?parseInt(s[2]):null;return{year:l===null?i:l*100,restDateString:e.slice((s[1]||s[2]).length)}}function Wle(e,r){if(r===null)return new Date(NaN);const n=e.match($le);if(!n)return new Date(NaN);const s=!!n[4],i=k0(n[1]),l=k0(n[2])-1,d=k0(n[3]),a=k0(n[4]),f=k0(n[5])-1;if(s)return Qle(r,a,f)?Hle(r,a,f):new Date(NaN);{const p=new Date(0);return!Yle(r,l,d)||!Xle(r,i)?new Date(NaN):(p.setUTCFullYear(r,l,Math.max(i,d)),p)}}function k0(e){return e?parseInt(e):1}function Gle(e){const r=e.match(Ble);if(!r)return NaN;const n=RA(r[1]),s=RA(r[2]),i=RA(r[3]);return Jle(n,s,i)?n*b9+s*_9+i*1e3:NaN}function RA(e){return e&&parseFloat(e.replace(",","."))||0}function Kle(e){if(e==="Z")return 0;const r=e.match(qle);if(!r)return 0;const n=r[1]==="+"?-1:1,s=parseInt(r[2]),i=r[3]&&parseInt(r[3])||0;return ece(s,i)?n*(s*b9+i*_9):NaN}function Hle(e,r,n){const s=new Date(0);s.setUTCFullYear(e,0,4);const i=s.getUTCDay()||7,l=(r-1)*7+n+1-i;return s.setUTCDate(s.getUTCDate()+l),s}const Zle=[31,null,31,30,31,30,31,31,30,31,30,31];function S9(e){return e%400===0||e%4===0&&e%100!==0}function Yle(e,r,n){return r>=0&&r<=11&&n>=1&&n<=(Zle[r]||(S9(e)?29:28))}function Xle(e,r){return r>=1&&r<=(S9(e)?366:365)}function Qle(e,r,n){return r>=1&&r<=53&&n>=0&&n<=6}function Jle(e,r,n){return e===24?r===0&&n===0:n>=0&&n<60&&r>=0&&r<60&&e>=0&&e<25}function ece(e,r){return r>=0&&r<=59}function tce(){const[e,r]=O.useState(""),[n,s]=O.useState("all"),[i,l]=O.useState("all"),[d,a]=O.useState("all"),[f,p]=O.useState(null),[y,v]=O.useState(1),{data:j,isLoading:w}=ct({queryKey:["meters",y,e,n,i,d],queryFn:async()=>{const I=new URLSearchParams({page:y.toString(),per_page:"15",...e&&{q:e},...n!=="all"&&{type:n},...i!=="all"&&{status:i},...d!=="all"&&{dma_id:d}}),L=await fetch(`/api/v1/meters?${I}`,{credentials:"include"});return L.ok?L.json():{data:rce(),current_page:1,last_page:1,per_page:15,total:8}}}),{data:k}=ct({queryKey:["dmas-list"],queryFn:async()=>{const I=await fetch("/api/v1/dmas?per_page=100",{credentials:"include"});return I.ok?(await I.json()).data:[]}}),{data:S}=ct({queryKey:["meter-calibration",f==null?void 0:f.id],queryFn:async()=>{if(!f)return[];const I=await fetch(`/api/v1/meters/${f.id}/calibrations`,{credentials:"include"});return I.ok?I.json():nce()},enabled:!!f}),R=I=>{switch(I){case"active":return t.jsxs(Ee,{className:"bg-green-500",children:[t.jsx(Fs,{className:"h-3 w-3 mr-1"}),"Active"]});case"faulty":return t.jsxs(Ee,{className:"bg-red-500",children:[t.jsx(Mu,{className:"h-3 w-3 mr-1"}),"Faulty"]});case"decommissioned":return t.jsx(Ee,{variant:"outline",children:"Decommissioned"});default:return t.jsx(Ee,{variant:"outline",children:I})}},D=I=>I?new Date(I)<new Date:!1,T=I=>I?Foe(new Date,new Date(I)):null;return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[t.jsx(Qc,{className:"h-8 w-8"}),"Meter Registry"]}),t.jsx("p",{className:"text-muted-foreground",children:"Asset register for bulk and customer meters with calibration tracking"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx(H,{children:t.jsxs(de,{className:"pb-3",children:[t.jsx(cr,{children:"Total Meters"}),t.jsx(he,{className:"text-3xl",children:(j==null?void 0:j.total)||0})]})}),t.jsx(H,{children:t.jsxs(de,{className:"pb-3",children:[t.jsx(cr,{children:"Active"}),t.jsx(he,{className:"text-3xl text-green-600",children:(j==null?void 0:j.data.filter(I=>I.status==="active").length)||0})]})}),t.jsx(H,{children:t.jsxs(de,{className:"pb-3",children:[t.jsx(cr,{children:"Faulty"}),t.jsx(he,{className:"text-3xl text-red-600",children:(j==null?void 0:j.data.filter(I=>I.status==="faulty").length)||0})]})}),t.jsx(H,{children:t.jsxs(de,{className:"pb-3",children:[t.jsx(cr,{children:"Calibration Overdue"}),t.jsx(he,{className:"text-3xl text-orange-600",children:(j==null?void 0:j.data.filter(I=>D(I.calibration_due)).length)||0})]})})]}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Search"}),t.jsxs("div",{className:"relative",children:[t.jsx(di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Serial number or location...",value:e,onChange:I=>r(I.target.value),className:"pl-10"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Type"}),t.jsxs($t,{value:n,onValueChange:s,children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All Types"}),t.jsx(Ne,{value:"bulk",children:"Bulk Meters"}),t.jsx(Ne,{value:"customer",children:"Customer Meters"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Status"}),t.jsxs($t,{value:i,onValueChange:l,children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All Statuses"}),t.jsx(Ne,{value:"active",children:"Active"}),t.jsx(Ne,{value:"faulty",children:"Faulty"}),t.jsx(Ne,{value:"decommissioned",children:"Decommissioned"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"DMA"}),t.jsxs($t,{value:d,onValueChange:a,children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All DMAs"}),k==null?void 0:k.map(I=>t.jsxs(Ne,{value:I.id,children:[I.code," - ",I.name]},I.id))]})]})]})]})})}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx(he,{children:"Meters"}),t.jsx(cr,{children:"Click a row to view details and calibration history"})]}),t.jsxs(X,{children:[t.jsx(Us,{className:"mr-2 h-4 w-4"}),"Add Meter"]})]})}),t.jsxs(Q,{children:[t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Serial Number"}),t.jsx(ce,{children:"Type"}),t.jsx(ce,{children:"Location"}),t.jsx(ce,{children:"DMA"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Last Calibration"}),t.jsx(ce,{children:"Tamper Flags"}),t.jsx(ce,{children:"Accuracy"})]})}),t.jsx(mr,{children:w?t.jsx(ut,{children:t.jsx(se,{colSpan:8,className:"text-center py-8",children:"Loading meters..."})}):(j==null?void 0:j.data.length)===0?t.jsx(ut,{children:t.jsx(se,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No meters found"})}):j==null?void 0:j.data.map(I=>t.jsxs(ut,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>p(I),children:[t.jsx(se,{className:"font-mono font-medium",children:I.serial_number}),t.jsx(se,{className:"capitalize",children:I.type}),t.jsx(se,{children:I.location}),t.jsx(se,{children:I.dma_name||"N/A"}),t.jsx(se,{children:R(I.status)}),t.jsx(se,{children:I.last_calibration?t.jsxs("div",{children:[t.jsx("div",{className:"text-sm",children:wn(new Date(I.last_calibration),"MMM dd, yyyy")}),t.jsxs("div",{className:"text-xs text-muted-foreground",children:[T(I.last_calibration)," months ago"]})]}):t.jsx("span",{className:"text-muted-foreground",children:"Never"})}),t.jsx(se,{children:I.tamper_flags>0?t.jsxs(Ee,{variant:"destructive",className:"gap-1",children:[t.jsx(an,{className:"h-3 w-3"}),I.tamper_flags]}):t.jsx("span",{className:"text-muted-foreground text-sm",children:"None"})}),t.jsx(se,{children:t.jsxs("span",{className:I.accuracy_rating<95?"text-orange-600 font-medium":"",children:[I.accuracy_rating.toFixed(1),"%"]})})]},I.id))})]}),j&&j.last_page>1&&t.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",(j.current_page-1)*j.per_page+1," to ",Math.min(j.current_page*j.per_page,j.total)," of ",j.total," meters"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{variant:"outline",size:"sm",disabled:y===1,onClick:()=>v(I=>I-1),children:"Previous"}),t.jsx(X,{variant:"outline",size:"sm",disabled:y>=j.last_page,onClick:()=>v(I=>I+1),children:"Next"})]})]})]})]}),t.jsx(Soe,{open:!!f,onOpenChange:I=>!I&&p(null),children:t.jsx(p9,{className:"w-[600px] sm:max-w-[600px] overflow-y-auto",children:f&&t.jsxs(t.Fragment,{children:[t.jsxs(x9,{children:[t.jsxs(g9,{className:"flex items-center gap-2",children:[t.jsx(Qc,{className:"h-5 w-5"}),f.serial_number]}),t.jsx(y9,{children:f.location})]}),t.jsxs("div",{className:"mt-6 space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Type"}),t.jsx("p",{className:"text-lg capitalize",children:f.type})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),t.jsx("div",{className:"mt-1",children:R(f.status)})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"DMA"}),t.jsx("p",{className:"text-lg",children:f.dma_name||"Not assigned"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Install Date"}),t.jsx("p",{className:"text-lg",children:wn(new Date(f.install_date),"MMM dd, yyyy")})]})]}),t.jsxs(H,{className:D(f.calibration_due)?"border-orange-500":"",children:[t.jsx(de,{className:"pb-3",children:t.jsx(he,{className:"text-base",children:"Calibration Status"})}),t.jsxs(Q,{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-muted-foreground",children:"Last Calibration"}),t.jsx("p",{className:"font-medium",children:f.last_calibration?wn(new Date(f.last_calibration),"MMM dd, yyyy"):"Never calibrated"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-muted-foreground",children:"Next Due"}),t.jsx("p",{className:`font-medium ${D(f.calibration_due)?"text-orange-600":""}`,children:f.calibration_due?wn(new Date(f.calibration_due),"MMM dd, yyyy"):"Not scheduled"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-muted-foreground",children:"Current Accuracy"}),t.jsxs("p",{className:`text-2xl font-bold ${f.accuracy_rating<95?"text-orange-600":"text-green-600"}`,children:[f.accuracy_rating.toFixed(1),"%"]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-muted-foreground",children:"Tamper Flags"}),t.jsx("p",{className:`text-2xl font-bold ${f.tamper_flags>0?"text-red-600":"text-green-600"}`,children:f.tamper_flags})]})]}),D(f.calibration_due)&&t.jsxs("div",{className:"flex items-center gap-2 text-sm text-orange-600 bg-orange-50 p-2 rounded",children:[t.jsx(an,{className:"h-4 w-4"}),"Calibration overdue - schedule maintenance"]})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsx(he,{className:"text-base",children:"Latest Reading"})}),t.jsx(Q,{children:t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-muted-foreground",children:"Reading"}),t.jsxs("p",{className:"text-2xl font-bold",children:[f.last_reading.toLocaleString()," m"]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-muted-foreground",children:"Date"}),t.jsx("p",{className:"font-medium",children:wn(new Date(f.last_reading_date),"MMM dd, yyyy HH:mm")})]})]})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-base",children:"Calibration History"})}),t.jsx(Q,{children:S&&S.length>0?t.jsx("div",{className:"space-y-3",children:S.map(I=>t.jsxs("div",{className:"border rounded-lg p-3",children:[t.jsxs("div",{className:"flex justify-between items-start mb-2",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:wn(new Date(I.date),"MMM dd, yyyy")}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["By ",I.technician]})]}),t.jsx(Ee,{variant:I.result==="pass"?"default":"destructive",children:I.result})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Before: "}),t.jsxs("span",{className:"font-medium",children:[I.accuracy_before,"%"]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"After: "}),t.jsxs("span",{className:"font-medium",children:[I.accuracy_after,"%"]})]})]}),I.notes&&t.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:I.notes})]},I.id))}):t.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No calibration history available"})})]}),t.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[t.jsx(X,{className:"flex-1",children:"Schedule Calibration"}),t.jsx(X,{variant:"outline",className:"flex-1",children:"View Full History"})]})]})]})})})]})}function rce(){return[{id:"1",serial_number:"BM-2024-001",type:"bulk",status:"active",location:"Central Treatment Plant - Outlet",dma_name:"Central DMA",install_date:"2023-01-15",last_calibration:"2024-09-10",calibration_due:"2025-03-10",tamper_flags:0,accuracy_rating:98.5,last_reading:145678,last_reading_date:"2025-11-21T08:00:00Z"},{id:"2",serial_number:"BM-2024-002",type:"bulk",status:"active",location:"East Zone Distribution",dma_name:"East DMA",install_date:"2023-03-20",last_calibration:"2024-06-15",calibration_due:"2024-12-15",tamper_flags:1,accuracy_rating:96.2,last_reading:89234,last_reading_date:"2025-11-21T07:55:00Z"},{id:"3",serial_number:"CM-2024-1234",type:"customer",status:"active",location:"123 Main Street",install_date:"2024-01-10",last_calibration:"2024-01-10",calibration_due:"2027-01-10",tamper_flags:0,accuracy_rating:99.1,last_reading:1256,last_reading_date:"2025-11-20T18:00:00Z"},{id:"4",serial_number:"BM-2023-015",type:"bulk",status:"faulty",location:"West Reservoir Inlet",dma_name:"West DMA",install_date:"2022-11-05",last_calibration:"2024-03-20",calibration_due:"2024-09-20",tamper_flags:3,accuracy_rating:87.3,last_reading:234567,last_reading_date:"2025-11-19T14:30:00Z"}]}function nce(){return[{id:"1",date:"2024-09-10",result:"pass",accuracy_before:97.8,accuracy_after:98.5,technician:"John Mwangi",notes:"Routine calibration completed successfully"},{id:"2",date:"2024-03-10",result:"pass",accuracy_before:96.5,accuracy_after:97.8,technician:"Jane Wanjiku",notes:"Minor adjustments made to flow sensor"},{id:"3",date:"2023-09-15",result:"pass",accuracy_before:98.1,accuracy_after:98.3,technician:"Peter Kamau",notes:"All readings within acceptable range"}]}const ZL={getAll:e=>xe.get("/dmas",e),getById:e=>xe.get(`/dmas/${e}`),create:e=>xe.post("/dmas",e),update:(e,r)=>xe.patch(`/dmas/${e}`,r),delete:e=>xe.delete(`/dmas/${e}`)};function sce(){const{user:e,hasPermission:r,hasRole:n}=QO();return{user:e,can:p=>r(p),hasAnyPermission:p=>p.some(y=>r(y)),hasAllPermissions:p=>p.every(y=>r(y)),is:p=>n(p),hasAnyRole:p=>p.some(y=>n(y)),hasAllRoles:p=>p.every(y=>n(y))}}function mm({permission:e,permissions:r,requireAll:n=!1,role:s,roles:i,requireAllRoles:l=!1,fallback:d=null,children:a}){const{can:f,hasAnyPermission:p,hasAllPermissions:y,is:v,hasAnyRole:j,hasAllRoles:w}=sce();let k=!0;return e?k=f(e):r&&r.length>0&&(k=n?y(r):p(r)),k&&s?k=v(s):k&&i&&i.length>0&&(k=l?w(i):j(i)),k?t.jsx(t.Fragment,{children:a}):t.jsx(t.Fragment,{children:d})}function ice(){const[e,r]=O.useState(!1),[n,s]=O.useState({code:"",name:"",status:"active"}),i=Sr(),{data:l,isLoading:d,error:a}=ct({queryKey:["dmas"],queryFn:()=>ZL.getAll({per_page:50})}),f=Nt({mutationFn:v=>ZL.create(v),onSuccess:()=>{i.invalidateQueries({queryKey:["dmas"]}),r(!1),s({code:"",name:"",status:"active"}),Ge.success("DMA created successfully")},onError:v=>{var j,w;Ge.error(((w=(j=v.response)==null?void 0:j.data)==null?void 0:w.message)||"Failed to create DMA")}}),p=v=>{if(v.preventDefault(),!n.code||!n.name){Ge.error("Please fill in all required fields");return}f.mutate({code:n.code,name:n.name,status:n.status})},y=async()=>{try{const v=await fetch("/api/v1/gis/dmas/export",{credentials:"include"});if(!v.ok)throw new Error(`HTTP ${v.status}`);const j=await v.blob(),w=window.URL.createObjectURL(j),k=document.createElement("a");k.href=w,k.download=`dmas-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(k),k.click(),window.URL.revokeObjectURL(w),document.body.removeChild(k)}catch(v){console.error("Export failed:",v)}};return t.jsxs("div",{className:"container mx-auto p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"District Metered Areas (DMAs)"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage water distribution network DMAs"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(X,{variant:"outline",onClick:y,children:[t.jsx(Ta,{className:"mr-2 h-4 w-4"}),"Export GeoJSON"]}),t.jsx(mm,{permission:"create dmas",children:t.jsxs(Or,{open:e,onOpenChange:r,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Create DMA"]})}),t.jsxs(kr,{children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:"Create New DMA"}),t.jsx(Pi,{children:"Add a new District Metered Area to the system"})]}),t.jsxs("form",{onSubmit:p,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"code",children:"Code*"}),t.jsx(Ve,{id:"code",placeholder:"e.g. DMA-001",value:n.code,onChange:v=>s({...n,code:v.target.value}),required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"name",children:"Name*"}),t.jsx(Ve,{id:"name",placeholder:"DMA name",value:n.name,onChange:v=>s({...n,name:v.target.value}),required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"status",children:"Status"}),t.jsxs($t,{value:n.status,onValueChange:v=>s({...n,status:v}),children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"active",children:"Active"}),t.jsx(Ne,{value:"planned",children:"Planned"}),t.jsx(Ne,{value:"inactive",children:"Inactive"})]})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:f.isPending,children:f.isPending?"Creating...":"Create DMA"})]})]})]})]})})]})]}),d&&!l?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading DMAs..."})}):a?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-lg text-red-600 mb-2",children:"Error loading DMAs"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:a.message})]})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l==null?void 0:l.data.map(v=>t.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[t.jsxs(de,{children:[t.jsx(he,{children:v.name}),t.jsxs(cr,{children:["Code: ",v.code]})]}),t.jsx(Q,{children:t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Status:"}),t.jsx("span",{className:`font-medium capitalize ${v.status==="active"?"text-green-600":v.status==="planned"?"text-blue-600":"text-gray-600"}`,children:v.status})]}),v.nightline_threshold_m3h&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Nightline:"}),t.jsxs("span",{className:"font-medium",children:[v.nightline_threshold_m3h," m/h"]})]}),v.pressure_target_bar&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Pressure:"}),t.jsxs("span",{className:"font-medium",children:[v.pressure_target_bar," bar"]})]}),v.scheme&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Scheme:"}),t.jsx("span",{className:"font-medium text-xs",children:v.scheme.name})]})]})})]},v.id))}),(l==null?void 0:l.data.length)===0&&t.jsx(H,{children:t.jsxs(Q,{className:"flex flex-col items-center justify-center p-12",children:[t.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No DMAs found"}),t.jsx(mm,{permission:"create dmas",children:t.jsx(X,{children:"Create Your First DMA"})})]})})]})]})}const YL={getAll:e=>xe.get("/pipelines",e),getById:e=>xe.get(`/pipelines/${e}`),create:e=>xe.post("/pipelines",e),update:(e,r)=>xe.patch(`/pipelines/${e}`,r),delete:e=>xe.delete(`/pipelines/${e}`)};function ace(){const[e,r]=O.useState(!1),[n,s]=O.useState({code:"",material:"uPVC",diameter_mm:"50",status:"active"}),i=Sr(),{data:l,isLoading:d,error:a}=ct({queryKey:["pipelines"],queryFn:()=>YL.getAll({per_page:50})}),f=Nt({mutationFn:y=>YL.create(y),onSuccess:()=>{i.invalidateQueries({queryKey:["pipelines"]}),r(!1),s({code:"",material:"PVC",diameter_mm:"50",status:"active"}),Ge.success("Pipeline created successfully")},onError:y=>{var v,j;Ge.error(((j=(v=y.response)==null?void 0:v.data)==null?void 0:j.message)||"Failed to create pipeline")}}),p=y=>{if(y.preventDefault(),!n.code||!n.material||!n.diameter_mm){Ge.error("Please fill in all required fields");return}f.mutate({code:n.code,material:n.material,diameter_mm:parseInt(n.diameter_mm),status:n.status})};return t.jsxs("div",{className:"container mx-auto p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Pipelines"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage water distribution pipelines"})]}),t.jsx(mm,{permission:"create pipelines",children:t.jsxs(Or,{open:e,onOpenChange:r,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Create Pipeline"]})}),t.jsxs(kr,{children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:"Create New Pipeline"}),t.jsx(Pi,{children:"Add a new water distribution pipeline"})]}),t.jsxs("form",{onSubmit:p,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"code",children:"Code*"}),t.jsx(Ve,{id:"code",placeholder:"e.g. PIPE-001",value:n.code,onChange:y=>s({...n,code:y.target.value}),required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"material",children:"Material*"}),t.jsxs($t,{value:n.material,onValueChange:y=>s({...n,material:y}),children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"uPVC",children:"uPVC"}),t.jsx(Ne,{value:"HDPE",children:"HDPE"}),t.jsx(Ne,{value:"Steel",children:"Steel"}),t.jsx(Ne,{value:"DI",children:"DI"}),t.jsx(Ne,{value:"AC",children:"AC"}),t.jsx(Ne,{value:"GI",children:"GI"}),t.jsx(Ne,{value:"Other",children:"Other"})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"diameter_mm",children:"Diameter (mm)*"}),t.jsx(Ve,{id:"diameter_mm",type:"number",placeholder:"50",value:n.diameter_mm,onChange:y=>s({...n,diameter_mm:y.target.value}),required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"status",children:"Status"}),t.jsxs($t,{value:n.status,onValueChange:y=>s({...n,status:y}),children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"active",children:"Active"}),t.jsx(Ne,{value:"leak",children:"Leak"}),t.jsx(Ne,{value:"rehab",children:"Rehab"})]})]})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:f.isPending,children:f.isPending?"Creating...":"Create Pipeline"})]})]})]})]})})]}),d&&!l?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading pipelines..."})}):a?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-lg text-red-600 mb-2",children:"Error loading pipelines"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:a.message})]})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l==null?void 0:l.data.map(y=>t.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[t.jsxs(de,{children:[t.jsx(he,{children:y.code}),t.jsx(cr,{children:y.material})]}),t.jsx(Q,{children:t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Diameter:"}),t.jsxs("span",{className:"font-medium",children:[y.diameter_mm," mm"]})]}),y.install_year&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Installed:"}),t.jsx("span",{className:"font-medium",children:y.install_year})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Status:"}),t.jsx("span",{className:`font-medium capitalize ${y.status==="active"?"text-green-600":y.status==="leak"?"text-red-600":y.status==="rehab"?"text-yellow-600":"text-gray-600"}`,children:y.status})]}),y.scheme&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Scheme:"}),t.jsx("span",{className:"font-medium text-xs",children:y.scheme.name})]})]})})]},y.id))}),(l==null?void 0:l.data.length)===0&&t.jsx(H,{children:t.jsxs(Q,{className:"flex flex-col items-center justify-center p-12",children:[t.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No pipelines found"}),t.jsx(mm,{permission:"create pipelines",children:t.jsx(X,{children:"Create Your First Pipeline"})})]})})]})]})}const XL={getAll:e=>xe.get("/zones",e),getById:e=>xe.get(`/zones/${e}`),create:e=>xe.post("/zones",e),update:(e,r)=>xe.patch(`/zones/${e}`,r),delete:e=>xe.delete(`/zones/${e}`)};function oce(){const[e,r]=O.useState(!1),[n,s]=O.useState({code:"",name:"",type:"billing"}),i=Sr(),{data:l,isLoading:d,error:a}=ct({queryKey:["zones"],queryFn:()=>XL.getAll({per_page:50})}),f=Nt({mutationFn:y=>XL.create(y),onSuccess:()=>{i.invalidateQueries({queryKey:["zones"]}),r(!1),s({code:"",name:"",type:"billing"}),Ge.success("Zone created successfully")},onError:y=>{var v,j;Ge.error(((j=(v=y.response)==null?void 0:v.data)==null?void 0:j.message)||"Failed to create zone")}}),p=y=>{if(y.preventDefault(),!n.code||!n.name){Ge.error("Please fill in all required fields");return}f.mutate(n)};return t.jsxs("div",{className:"container mx-auto p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Zones"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage geographical zones"})]}),t.jsx(mm,{permission:"create zones",children:t.jsxs(Or,{open:e,onOpenChange:r,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Create Zone"]})}),t.jsxs(kr,{children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:"Create New Zone"}),t.jsx(Pi,{children:"Add a new geographical zone"})]}),t.jsxs("form",{onSubmit:p,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"code",children:"Code*"}),t.jsx(Ve,{id:"code",placeholder:"e.g. Z-001",value:n.code,onChange:y=>s({...n,code:y.target.value}),required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"type",children:"Type*"}),t.jsxs($t,{value:n.type,onValueChange:y=>s({...n,type:y}),children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"billing",children:"Billing"}),t.jsx(Ne,{value:"service",children:"Service"}),t.jsx(Ne,{value:"operational",children:"Operational"})]})]})]})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"name",children:"Name*"}),t.jsx(Ve,{id:"name",placeholder:"Zone name",value:n.name,onChange:y=>s({...n,name:y.target.value}),required:!0})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:f.isPending,children:f.isPending?"Creating...":"Create Zone"})]})]})]})]})})]}),d&&!l?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading zones..."})}):a?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-lg text-red-600 mb-2",children:"Error loading zones"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:a.message})]})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l==null?void 0:l.data.map(y=>t.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[t.jsxs(de,{children:[t.jsx(he,{children:y.name}),t.jsxs(cr,{children:["Code: ",y.code]})]}),t.jsx(Q,{children:t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Type:"}),t.jsx("span",{className:"font-medium capitalize",children:y.type})]}),y.scheme&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Scheme:"}),t.jsx("span",{className:"font-medium text-xs",children:y.scheme.name})]})]})})]},y.id))}),(l==null?void 0:l.data.length)===0&&t.jsx(H,{children:t.jsxs(Q,{className:"flex flex-col items-center justify-center p-12",children:[t.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No zones found"}),t.jsx(mm,{permission:"create zones",children:t.jsx(X,{children:"Create Your First Zone"})})]})})]})]})}const QL={getAll:e=>xe.get("/addresses",e),getById:e=>xe.get(`/addresses/${e}`),create:e=>xe.post("/addresses",e),update:(e,r)=>xe.patch(`/addresses/${e}`,r),delete:e=>xe.delete(`/addresses/${e}`)};function lce(){const[e,r]=O.useState(!1),[n,s]=O.useState({premise_code:"",street:"",village:"",ward:"",city:"",country:"KE"}),i=Sr(),{data:l,isLoading:d,error:a}=ct({queryKey:["addresses"],queryFn:()=>QL.getAll({per_page:50})}),f=Nt({mutationFn:y=>QL.create(y),onSuccess:()=>{i.invalidateQueries({queryKey:["addresses"]}),r(!1),s({premise_code:"",street:"",village:"",ward:"",city:"",country:"KE"}),Ge.success("Address created successfully")},onError:y=>{var v,j;Ge.error(((j=(v=y.response)==null?void 0:v.data)==null?void 0:j.message)||"Failed to create address")}}),p=y=>{if(y.preventDefault(),!n.premise_code){Ge.error("Please fill in the premise code");return}f.mutate(n)};return t.jsxs("div",{className:"container mx-auto p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Addresses"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage customer premises addresses"})]}),t.jsx(mm,{permission:"create addresses",children:t.jsxs(Or,{open:e,onOpenChange:r,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Create Address"]})}),t.jsxs(kr,{className:"max-w-2xl",children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:"Create New Address"}),t.jsx(Pi,{children:"Add a new customer premise address"})]}),t.jsxs("form",{onSubmit:p,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"premise_code",children:"Premise Code*"}),t.jsx(Ve,{id:"premise_code",placeholder:"e.g. PREM-001",value:n.premise_code,onChange:y=>s({...n,premise_code:y.target.value}),required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"country",children:"Country"}),t.jsx(Ve,{id:"country",placeholder:"KE",value:n.country,onChange:y=>s({...n,country:y.target.value})})]})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"street",children:"Street"}),t.jsx(Ve,{id:"street",placeholder:"Street address",value:n.street,onChange:y=>s({...n,street:y.target.value})})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"village",children:"Village"}),t.jsx(Ve,{id:"village",placeholder:"Village",value:n.village,onChange:y=>s({...n,village:y.target.value})})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"ward",children:"Ward"}),t.jsx(Ve,{id:"ward",placeholder:"Ward",value:n.ward,onChange:y=>s({...n,ward:y.target.value})})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"city",children:"City"}),t.jsx(Ve,{id:"city",placeholder:"City",value:n.city,onChange:y=>s({...n,city:y.target.value})})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:f.isPending,children:f.isPending?"Creating...":"Create Address"})]})]})]})]})})]}),d&&!l?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading addresses..."})}):a?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-lg text-red-600 mb-2",children:"Error loading addresses"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:a.message})]})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l==null?void 0:l.data.map(y=>t.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[t.jsxs(de,{children:[t.jsx(he,{children:y.premise_code}),t.jsx(cr,{children:[y.street,y.village].filter(Boolean).join(", ")||"No address details"})]}),t.jsx(Q,{children:t.jsxs("div",{className:"space-y-2 text-sm",children:[y.ward&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Ward:"}),t.jsx("span",{className:"font-medium",children:y.ward})]}),y.subcounty&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Subcounty:"}),t.jsx("span",{className:"font-medium",children:y.subcounty})]}),y.city&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"City:"}),t.jsx("span",{className:"font-medium",children:y.city})]}),y.what3words&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"What3Words:"}),t.jsx("span",{className:"font-medium text-xs",children:y.what3words})]}),y.scheme&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Scheme:"}),t.jsx("span",{className:"font-medium text-xs",children:y.scheme.name})]})]})})]},y.id))}),(l==null?void 0:l.data.length)===0&&t.jsx(H,{children:t.jsxs(Q,{className:"flex flex-col items-center justify-center p-12",children:[t.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No addresses found"}),t.jsx(mm,{permission:"create addresses",children:t.jsx(X,{children:"Create Your First Address"})})]})})]})]})}const cce="modulepreload",dce=function(e){return"/"+e},JL={},uce=function(r,n,s){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),a=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));i=Promise.allSettled(n.map(f=>{if(f=dce(f),f in JL)return;JL[f]=!0;const p=f.endsWith(".css"),y=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${y}`))return;const v=document.createElement("link");if(v.rel=p?"stylesheet":cce,p||(v.as="script"),v.crossOrigin="",v.href=f,a&&v.setAttribute("nonce",a),document.head.appendChild(v),p)return new Promise((j,w)=>{v.addEventListener("load",j),v.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function l(d){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=d,window.dispatchEvent(a),!a.defaultPrevented)throw d}return i.then(d=>{for(const a of d||[])a.status==="rejected"&&l(a.reason);return r().catch(l)})},hce=O.createContext(null);function mce(e,r){const n=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0,i=Array.isArray(r)?r[0]:r?r.x:0,l=Array.isArray(r)?r[1]:r?r.y:0;return n===i&&s===l}function Po(e,r){if(e===r)return!0;if(!e||!r)return!1;if(Array.isArray(e)){if(!Array.isArray(r)||e.length!==r.length)return!1;for(let n=0;n<e.length;n++)if(!Po(e[n],r[n]))return!1;return!0}else if(Array.isArray(r))return!1;if(typeof e=="object"&&typeof r=="object"){const n=Object.keys(e),s=Object.keys(r);if(n.length!==s.length)return!1;for(const i of n)if(!r.hasOwnProperty(i)||!Po(e[i],r[i]))return!1;return!0}return!1}function eF(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function tF(e,r){const n=r.viewState||r,s={};if("longitude"in n&&"latitude"in n&&(n.longitude!==e.center.lng||n.latitude!==e.center.lat)){const i=e.center.constructor;s.center=new i(n.longitude,n.latitude)}return"zoom"in n&&n.zoom!==e.zoom&&(s.zoom=n.zoom),"bearing"in n&&n.bearing!==e.bearing&&(s.bearing=n.bearing),"pitch"in n&&n.pitch!==e.pitch&&(s.pitch=n.pitch),n.padding&&e.padding&&!Po(n.padding,e.padding)&&(s.padding=n.padding),s}const fce=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function rF(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const r={};for(const s of e.layers)r[s.id]=s;const n=e.layers.map(s=>{let i=null;"interactive"in s&&(i=Object.assign({},s),delete i.interactive);const l=r[s.ref];if(l){i=i||Object.assign({},s),delete i.ref;for(const d of fce)d in l&&(i[d]=l[d])}return i||s});return{...e,layers:n}}const nF={version:8,sources:{},layers:[]},sF={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},iF={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},aF={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},pce=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],xce=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Ug{constructor(r,n,s){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=i=>{const l=this.props[aF[i.type]];l?l(i):i.type==="error"&&console.error(i.error)},this._onCameraEvent=i=>{if(this._internalUpdate)return;i.viewState=this._propsedCameraUpdate||eF(this._map.transform);const l=this.props[iF[i.type]];l&&l(i)},this._onCameraUpdate=i=>this._internalUpdate?i:(this._propsedCameraUpdate=eF(i),tF(i,this.props)),this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const l=this.props[sF[i.type]];l&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),l(i),delete i.features)},this._MapClass=r,this.props=n,this._initialize(s)}get map(){return this._map}setProps(r){const n=this.props;this.props=r;const s=this._updateSettings(r,n),i=this._updateSize(r),l=this._updateViewState(r);this._updateStyle(r,n),this._updateStyleComponents(r),this._updateHandlers(r,n),(s||i||l&&!this._map.isMoving())&&this.redraw()}static reuse(r,n){const s=Ug.savedMaps.pop();if(!s)return null;const i=s.map,l=i.getContainer();for(n.className=l.className;l.childNodes.length>0;)n.appendChild(l.childNodes[0]);i._container=n;const d=i._resizeObserver;d&&(d.disconnect(),d.observe(n)),s.setProps({...r,styleDiffing:!1}),i.resize();const{initialViewState:a}=r;return a&&(a.bounds?i.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):s._updateViewState(a)),i.isStyleLoaded()?i.fire("load"):i.once("style.load",()=>i.fire("load")),i._update(),s}_initialize(r){const{props:n}=this,{mapStyle:s=nF}=n,i={...n,...n.initialViewState,container:r,style:rF(s)},l=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[l.longitude||0,l.latitude||0],zoom:l.zoom||0,pitch:l.pitch||0,bearing:l.bearing||0}),n.gl){const a=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=a,n.gl)}const d=new this._MapClass(i);l.padding&&d.setPadding(l.padding),n.cursor&&(d.getCanvas().style.cursor=n.cursor),d.transformCameraUpdate=this._onCameraUpdate,d.on("style.load",()=>{var a;this._styleComponents={light:d.getLight(),sky:d.getSky(),projection:(a=d.getProjection)==null?void 0:a.call(d),terrain:d.getTerrain()},this._updateStyleComponents(this.props)}),d.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const a in sF)d.on(a,this._onPointerEvent);for(const a in iF)d.on(a,this._onCameraEvent);for(const a in aF)d.on(a,this._onEvent);this._map=d}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),Ug.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const r=this._map;r.style&&(r._frame&&(r._frame.cancel(),r._frame=null),r._render())}_updateSize(r){const{viewState:n}=r;if(n){const s=this._map;if(n.width!==s.transform.width||n.height!==s.transform.height)return s.resize(),!0}return!1}_updateViewState(r){const n=this._map,s=n.transform;if(!n.isMoving()){const l=tF(s,r);if(Object.keys(l).length>0)return this._internalUpdate=!0,n.jumpTo(l),this._internalUpdate=!1,!0}return!1}_updateSettings(r,n){const s=this._map;let i=!1;for(const l of pce)if(l in r&&!Po(r[l],n[l])){i=!0;const d=s[`set${l[0].toUpperCase()}${l.slice(1)}`];d==null||d.call(s,r[l])}return i}_updateStyle(r,n){if(r.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=r.cursor||""),r.mapStyle!==n.mapStyle){const{mapStyle:s=nF,styleDiffing:i=!0}=r,l={diff:i};"localIdeographFontFamily"in r&&(l.localIdeographFontFamily=r.localIdeographFontFamily),this._map.setStyle(rF(s),l)}}_updateStyleComponents({light:r,projection:n,sky:s,terrain:i}){var a,f;const l=this._map,d=this._styleComponents;l.style._loaded&&(r&&!Po(r,d.light)&&(d.light=r,l.setLight(r)),n&&!Po(n,d.projection)&&n!==((a=d.projection)==null?void 0:a.type)&&(d.projection=typeof n=="string"?{type:n}:n,(f=l.setProjection)==null||f.call(l,d.projection)),s&&!Po(s,d.sky)&&(d.sky=s,l.setSky(s)),i!==void 0&&!Po(i,d.terrain)&&(!i||l.getSource(i.source))&&(d.terrain=i,l.setTerrain(i)))}_updateHandlers(r,n){const s=this._map;for(const i of xce){const l=r[i]??!0,d=n[i]??!0;Po(l,d)||(l?s[i].enable(l):s[i].disable())}}_queryRenderedFeatures(r){const n=this._map,{interactiveLayerIds:s=[]}=this.props;try{return n.queryRenderedFeatures(r,{layers:s.filter(n.getLayer.bind(n))})}catch{return[]}}_updateHover(r){var i;const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const l=r.type,d=((i=this._hoveredFeatures)==null?void 0:i.length)>0,a=this._queryRenderedFeatures(r.point),f=a.length>0;!f&&d&&(r.type="mouseleave",this._onPointerEvent(r)),this._hoveredFeatures=a,f&&!d&&(r.type="mouseenter",this._onPointerEvent(r)),r.type=l}else this._hoveredFeatures=null}}Ug.savedMaps=[];const gce=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function yce(e){if(!e)return null;const r=e.map,n={getMap:()=>r};for(const s of vce(r))!(s in n)&&!gce.includes(s)&&(n[s]=r[s].bind(r));return n}function vce(e){const r=new Set;let n=e;for(;n;){for(const s of Object.getOwnPropertyNames(n))s[0]!=="_"&&typeof e[s]=="function"&&s!=="fire"&&s!=="setEventedParent"&&r.add(s);n=Object.getPrototypeOf(n)}return Array.from(r)}const _ce=typeof document<"u"?O.useLayoutEffect:O.useEffect;function bce(e,r){const{RTLTextPlugin:n,maxParallelImageRequests:s,workerCount:i,workerUrl:l}=r;if(n&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:d,lazy:a=!0}=typeof n=="string"?{pluginUrl:n}:n;e.setRTLTextPlugin(d,f=>{f&&console.error(f)},a)}s!==void 0&&e.setMaxParallelImageRequests(s),i!==void 0&&e.setWorkerCount(i),l!==void 0&&e.setWorkerUrl(l)}const Fy=O.createContext(null);function jce(e,r){const n=O.useContext(hce),[s,i]=O.useState(null),l=O.useRef(),{current:d}=O.useRef({mapLib:null,map:null});O.useEffect(()=>{const p=e.mapLib;let y=!0,v;return Promise.resolve(p||uce(()=>Promise.resolve().then(()=>Rue),void 0)).then(j=>{if(!y)return;if(!j)throw new Error("Invalid mapLib");const w="Map"in j?j:j.default;if(!w.Map)throw new Error("Invalid mapLib");bce(w,e),e.reuseMaps&&(v=Ug.reuse(e,l.current)),v||(v=new Ug(w.Map,e,l.current)),d.map=yce(v),d.mapLib=w,i(v),n==null||n.onMapMount(d.map,e.id)}).catch(j=>{const{onError:w}=e;w?w({type:"error",target:null,originalEvent:null,error:j}):console.error(j)}),()=>{y=!1,v&&(n==null||n.onMapUnmount(e.id),e.reuseMaps?v.recycle():v.destroy())}},[]),_ce(()=>{s&&s.setProps(e)}),O.useImperativeHandle(r,()=>d.map,[s]);const a=O.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),f={height:"100%"};return O.createElement("div",{id:e.id,ref:l,style:a},s&&O.createElement(Fy.Provider,{value:d},O.createElement("div",{"mapboxgl-children":"",style:f},e.children)))}const Hb=O.forwardRef(jce),wce=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Iu(e,r){if(!e||!r)return;const n=e.style;for(const s in r){const i=r[s];Number.isFinite(i)&&!wce.test(s)?n[s]=`${i}px`:n[s]=i}}function P9(e,r){if(e===r)return null;const n=oF(e),s=oF(r),i=[];for(const l of s)n.has(l)||i.push(l);for(const l of n)s.has(l)||i.push(l);return i.length===0?null:i}function oF(e){return new Set(e?e.trim().split(/\s+/):[])}const Nce=O.memo(O.forwardRef((e,r)=>{const{map:n,mapLib:s}=O.useContext(Fy),i=O.useRef({props:e}),l=O.useMemo(()=>{let D=!1;O.Children.forEach(e.children,L=>{L&&(D=!0)});const T={...e,element:D?document.createElement("div"):void 0},I=new s.Marker(T);return I.setLngLat([e.longitude,e.latitude]),I.getElement().addEventListener("click",L=>{var $,W;(W=($=i.current.props).onClick)==null||W.call($,{type:"click",target:I,originalEvent:L})}),I.on("dragstart",L=>{var W,Z;const $=L;$.lngLat=l.getLngLat(),(Z=(W=i.current.props).onDragStart)==null||Z.call(W,$)}),I.on("drag",L=>{var W,Z;const $=L;$.lngLat=l.getLngLat(),(Z=(W=i.current.props).onDrag)==null||Z.call(W,$)}),I.on("dragend",L=>{var W,Z;const $=L;$.lngLat=l.getLngLat(),(Z=(W=i.current.props).onDragEnd)==null||Z.call(W,$)}),I},[]);O.useEffect(()=>(l.addTo(n.getMap()),()=>{l.remove()}),[]);const{longitude:d,latitude:a,offset:f,style:p,draggable:y=!1,popup:v=null,rotation:j=0,rotationAlignment:w="auto",pitchAlignment:k="auto"}=e;O.useEffect(()=>{Iu(l.getElement(),p)},[p]),O.useImperativeHandle(r,()=>l,[]);const S=i.current.props;(l.getLngLat().lng!==d||l.getLngLat().lat!==a)&&l.setLngLat([d,a]),f&&!mce(l.getOffset(),f)&&l.setOffset(f),l.isDraggable()!==y&&l.setDraggable(y),l.getRotation()!==j&&l.setRotation(j),l.getRotationAlignment()!==w&&l.setRotationAlignment(w),l.getPitchAlignment()!==k&&l.setPitchAlignment(k),l.getPopup()!==v&&l.setPopup(v);const R=P9(S.className,e.className);if(R)for(const D of R)l.toggleClassName(D);return i.current.props=e,_m.createPortal(e.children,l.getElement())}));O.memo(O.forwardRef((e,r)=>{const{map:n,mapLib:s}=O.useContext(Fy),i=O.useMemo(()=>document.createElement("div"),[]),l=O.useRef({props:e}),d=O.useMemo(()=>{const a={...e},f=new s.Popup(a);return f.setLngLat([e.longitude,e.latitude]),f.once("open",p=>{var y,v;(v=(y=l.current.props).onOpen)==null||v.call(y,p)}),f},[]);if(O.useEffect(()=>{const a=f=>{var p,y;(y=(p=l.current.props).onClose)==null||y.call(p,f)};return d.on("close",a),d.setDOMContent(i).addTo(n.getMap()),()=>{d.off("close",a),d.isOpen()&&d.remove()}},[]),O.useEffect(()=>{Iu(d.getElement(),e.style)},[e.style]),O.useImperativeHandle(r,()=>d,[]),d.isOpen()){const a=l.current.props;(d.getLngLat().lng!==e.longitude||d.getLngLat().lat!==e.latitude)&&d.setLngLat([e.longitude,e.latitude]),e.offset&&!Po(a.offset,e.offset)&&d.setOffset(e.offset),(a.anchor!==e.anchor||a.maxWidth!==e.maxWidth)&&(d.options.anchor=e.anchor,d.setMaxWidth(e.maxWidth));const f=P9(a.className,e.className);if(f)for(const p of f)d.toggleClassName(p);l.current.props=e}return _m.createPortal(e.children,i)}));function fp(e,r,n,s){const i=O.useContext(Fy),l=O.useMemo(()=>e(i),[]);return O.useEffect(()=>{const d=r,a=null,f=typeof r=="function"?r:null,{map:p}=i;return p.hasControl(l)||(p.addControl(l,d==null?void 0:d.position),a&&a(i)),()=>{f&&f(i),p.hasControl(l)&&p.removeControl(l)}},[]),l}function Sce(e){const r=fp(({mapLib:n})=>new n.AttributionControl(e),{position:e.position});return O.useEffect(()=>{Iu(r._container,e.style)},[e.style]),null}O.memo(Sce);function Pce(e){const r=fp(({mapLib:n})=>new n.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return O.useEffect(()=>{Iu(r._controlContainer,e.style)},[e.style]),null}const C9=O.memo(Pce);function Cce(e,r){const n=O.useRef({props:e}),s=fp(({mapLib:i})=>{const l=new i.GeolocateControl(e),d=l._setupUI;return l._setupUI=()=>{l._container.hasChildNodes()||d()},l.on("geolocate",a=>{var f,p;(p=(f=n.current.props).onGeolocate)==null||p.call(f,a)}),l.on("error",a=>{var f,p;(p=(f=n.current.props).onError)==null||p.call(f,a)}),l.on("outofmaxbounds",a=>{var f,p;(p=(f=n.current.props).onOutOfMaxBounds)==null||p.call(f,a)}),l.on("trackuserlocationstart",a=>{var f,p;(p=(f=n.current.props).onTrackUserLocationStart)==null||p.call(f,a)}),l.on("trackuserlocationend",a=>{var f,p;(p=(f=n.current.props).onTrackUserLocationEnd)==null||p.call(f,a)}),l},{position:e.position});return n.current.props=e,O.useImperativeHandle(r,()=>s,[]),O.useEffect(()=>{Iu(s._container,e.style)},[e.style]),null}O.memo(O.forwardRef(Cce));function Ace(e){const r=fp(({mapLib:n})=>new n.NavigationControl(e),{position:e.position});return O.useEffect(()=>{Iu(r._container,e.style)},[e.style]),null}const Zb=O.memo(Ace);function kce(e){const r=fp(({mapLib:l})=>new l.ScaleControl(e),{position:e.position}),n=O.useRef(e),s=n.current;n.current=e;const{style:i}=e;return e.maxWidth!==void 0&&e.maxWidth!==s.maxWidth&&(r.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==s.unit&&r.setUnit(e.unit),O.useEffect(()=>{Iu(r._container,i)},[i]),null}const Yb=O.memo(kce);function Tce(e){const r=fp(({mapLib:n})=>new n.TerrainControl(e),{position:e.position});return O.useEffect(()=>{Iu(r._container,e.style)},[e.style]),null}O.memo(Tce);function Ece(e){const r=fp(({mapLib:n})=>new n.LogoControl(e),{position:e.position});return O.useEffect(()=>{Iu(r._container,e.style)},[e.style]),null}O.memo(Ece);function EN(e,r){if(!e)throw new Error(r)}let Mce=0;function Oce(e,r,n){if(e.style&&e.style._loaded){const s={...n};return delete s.id,delete s.children,e.addSource(r,s),e.getSource(r)}return null}function Ice(e,r,n){var d,a,f;EN(r.id===n.id,"source id changed"),EN(r.type===n.type,"source type changed");let s="",i=0;for(const p in r)p!=="children"&&p!=="id"&&!Po(n[p],r[p])&&(s=p,i++);if(!i)return;const l=r.type;if(l==="geojson")e.setData(r.data);else if(l==="image")e.updateImage({url:r.url,coordinates:r.coordinates});else switch(s){case"coordinates":(d=e.setCoordinates)==null||d.call(e,r.coordinates);break;case"url":(a=e.setUrl)==null||a.call(e,r.url);break;case"tiles":(f=e.setTiles)==null||f.call(e,r.tiles);break;default:console.warn(`Unable to update <Source> prop: ${s}`)}}function W_(e){const r=O.useContext(Fy).map.getMap(),n=O.useRef(e),[,s]=O.useState(0),i=O.useMemo(()=>e.id||`jsx-source-${Mce++}`,[]);O.useEffect(()=>{if(r){const d=()=>setTimeout(()=>s(a=>a+1),0);return r.on("styledata",d),d(),()=>{var a;if(r.off("styledata",d),r.style&&r.style._loaded&&r.getSource(i)){const f=(a=r.getStyle())==null?void 0:a.layers;if(f)for(const p of f)p.source===i&&r.removeLayer(p.id);r.removeSource(i)}}}},[r]);let l=r&&r.style&&r.getSource(i);return l?Ice(l,e,n.current):l=Oce(r,i,e),n.current=e,l&&O.Children.map(e.children,d=>d&&O.cloneElement(d,{source:i}))||null}function Dce(e,r,n,s){if(EN(n.id===s.id,"layer id changed"),EN(n.type===s.type,"layer type changed"),n.type==="custom"||s.type==="custom")return;const{layout:i={},paint:l={},filter:d,minzoom:a,maxzoom:f,beforeId:p}=n;if(p!==s.beforeId&&e.moveLayer(r,p),i!==s.layout){const y=s.layout||{};for(const v in i)Po(i[v],y[v])||e.setLayoutProperty(r,v,i[v]);for(const v in y)i.hasOwnProperty(v)||e.setLayoutProperty(r,v,void 0)}if(l!==s.paint){const y=s.paint||{};for(const v in l)Po(l[v],y[v])||e.setPaintProperty(r,v,l[v]);for(const v in y)l.hasOwnProperty(v)||e.setPaintProperty(r,v,void 0)}Po(d,s.filter)||e.setFilter(r,d),(a!==s.minzoom||f!==s.maxzoom)&&e.setLayerZoomRange(r,a,f)}function Rce(e,r,n){if(e.style&&e.style._loaded&&(!("source"in n)||e.getSource(n.source))){const s={...n,id:r};delete s.beforeId,e.addLayer(s,n.beforeId)}}let Lce=0;function G_(e){const r=O.useContext(Fy).map.getMap(),n=O.useRef(e),[,s]=O.useState(0),i=O.useMemo(()=>e.id||`jsx-layer-${Lce++}`,[]);if(O.useEffect(()=>{if(r){const d=()=>s(a=>a+1);return r.on("styledata",d),d(),()=>{r.off("styledata",d),r.style&&r.style._loaded&&r.getLayer(i)&&r.removeLayer(i)}}},[r]),r&&r.style&&r.getLayer(i))try{Dce(r,i,e,n.current)}catch(d){console.warn(d)}else Rce(r,i,e);return n.current=e,null}var NI="Switch",[Fce]=Ou(NI),[zce,$ce]=Fce(NI),A9=O.forwardRef((e,r)=>{const{__scopeSwitch:n,name:s,checked:i,defaultChecked:l,required:d,disabled:a,value:f="on",onCheckedChange:p,form:y,...v}=e,[j,w]=O.useState(null),k=yn(r,I=>w(I)),S=O.useRef(!1),R=j?y||!!j.closest("form"):!0,[D=!1,T]=Nu({prop:i,defaultProp:l,onChange:p});return t.jsxs(zce,{scope:n,checked:D,disabled:a,children:[t.jsx(zr.button,{type:"button",role:"switch","aria-checked":D,"aria-required":d,"data-state":E9(D),"data-disabled":a?"":void 0,disabled:a,value:f,...v,ref:k,onClick:ar(e.onClick,I=>{T(L=>!L),R&&(S.current=I.isPropagationStopped(),S.current||I.stopPropagation())})}),R&&t.jsx(Bce,{control:j,bubbles:!S.current,name:s,value:f,checked:D,required:d,disabled:a,form:y,style:{transform:"translateX(-100%)"}})]})});A9.displayName=NI;var k9="SwitchThumb",T9=O.forwardRef((e,r)=>{const{__scopeSwitch:n,...s}=e,i=$ce(k9,n);return t.jsx(zr.span,{"data-state":E9(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:r})});T9.displayName=k9;var Bce=e=>{const{control:r,checked:n,bubbles:s=!0,...i}=e,l=O.useRef(null),d=A2(n),a=S2(r);return O.useEffect(()=>{const f=l.current,p=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(p,"checked").set;if(d!==n&&v){const j=new Event("click",{bubbles:s});v.call(f,n),f.dispatchEvent(j)}},[d,n,s]),t.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...i,tabIndex:-1,ref:l,style:{...e.style,...a,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function E9(e){return e?"checked":"unchecked"}var M9=A9,qce=T9;const pp=O.forwardRef(({className:e,...r},n)=>t.jsx(M9,{className:gr("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...r,ref:n,children:t.jsx(qce,{className:gr("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));pp.displayName=M9.displayName;var Vce="Separator",lF="horizontal",Uce=["horizontal","vertical"],O9=O.forwardRef((e,r)=>{const{decorative:n,orientation:s=lF,...i}=e,l=Wce(s)?s:lF,a=n?{role:"none"}:{"aria-orientation":l==="vertical"?l:void 0,role:"separator"};return t.jsx(zr.div,{"data-orientation":l,...a,...i,ref:r})});O9.displayName=Vce;function Wce(e){return Uce.includes(e)}var I9=O9;const sE=O.forwardRef(({className:e,orientation:r="horizontal",decorative:n=!0,...s},i)=>t.jsx(I9,{ref:i,decorative:n,orientation:r,className:gr("shrink-0 bg-border",r==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...s}));sE.displayName=I9.displayName;var D9=["PageUp","PageDown"],R9=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],L9={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},zy="Slider",[iE,Gce,Kce]=v2(zy),[F9]=Ou(zy,[Kce]),[Hce,z2]=F9(zy),z9=O.forwardRef((e,r)=>{const{name:n,min:s=0,max:i=100,step:l=1,orientation:d="horizontal",disabled:a=!1,minStepsBetweenThumbs:f=0,defaultValue:p=[s],value:y,onValueChange:v=()=>{},onValueCommit:j=()=>{},inverted:w=!1,form:k,...S}=e,R=O.useRef(new Set),D=O.useRef(0),I=d==="horizontal"?Zce:Yce,[L=[],$]=Nu({prop:y,defaultProp:p,onChange:ie=>{var Ie;(Ie=[...R.current][D.current])==null||Ie.focus(),v(ie)}}),W=O.useRef(L);function Z(ie){const ge=tde(L,ie);be(ie,ge)}function oe(ie){be(ie,D.current)}function te(){const ie=W.current[D.current];L[D.current]!==ie&&j(L)}function be(ie,ge,{commit:Ie}={commit:!1}){const Oe=ide(l),Xe=ade(Math.round((ie-s)/l)*l+s,Oe),Ue=q_(Xe,[s,i]);$((tt=[])=>{const Ce=Jce(tt,Ue,ge);if(sde(Ce,f*l)){D.current=Ce.indexOf(Ue);const ve=String(Ce)!==String(tt);return ve&&Ie&&j(Ce),ve?Ce:tt}else return tt})}return t.jsx(Hce,{scope:e.__scopeSlider,name:n,disabled:a,min:s,max:i,valueIndexToChangeRef:D,thumbs:R.current,values:L,orientation:d,form:k,children:t.jsx(iE.Provider,{scope:e.__scopeSlider,children:t.jsx(iE.Slot,{scope:e.__scopeSlider,children:t.jsx(I,{"aria-disabled":a,"data-disabled":a?"":void 0,...S,ref:r,onPointerDown:ar(S.onPointerDown,()=>{a||(W.current=L)}),min:s,max:i,inverted:w,onSlideStart:a?void 0:Z,onSlideMove:a?void 0:oe,onSlideEnd:a?void 0:te,onHomeKeyDown:()=>!a&&be(s,0,{commit:!0}),onEndKeyDown:()=>!a&&be(i,L.length-1,{commit:!0}),onStepKeyDown:({event:ie,direction:ge})=>{if(!a){const Xe=D9.includes(ie.key)||ie.shiftKey&&R9.includes(ie.key)?10:1,Ue=D.current,tt=L[Ue],Ce=l*Xe*ge;be(tt+Ce,Ue,{commit:!0})}}})})})})});z9.displayName=zy;var[$9,B9]=F9(zy,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Zce=O.forwardRef((e,r)=>{const{min:n,max:s,dir:i,inverted:l,onSlideStart:d,onSlideMove:a,onSlideEnd:f,onStepKeyDown:p,...y}=e,[v,j]=O.useState(null),w=yn(r,I=>j(I)),k=O.useRef(),S=Iy(i),R=S==="ltr",D=R&&!l||!R&&l;function T(I){const L=k.current||v.getBoundingClientRect(),$=[0,L.width],Z=SI($,D?[n,s]:[s,n]);return k.current=L,Z(I-L.left)}return t.jsx($9,{scope:e.__scopeSlider,startEdge:D?"left":"right",endEdge:D?"right":"left",direction:D?1:-1,size:"width",children:t.jsx(q9,{dir:S,"data-orientation":"horizontal",...y,ref:w,style:{...y.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:I=>{const L=T(I.clientX);d==null||d(L)},onSlideMove:I=>{const L=T(I.clientX);a==null||a(L)},onSlideEnd:()=>{k.current=void 0,f==null||f()},onStepKeyDown:I=>{const $=L9[D?"from-left":"from-right"].includes(I.key);p==null||p({event:I,direction:$?-1:1})}})})}),Yce=O.forwardRef((e,r)=>{const{min:n,max:s,inverted:i,onSlideStart:l,onSlideMove:d,onSlideEnd:a,onStepKeyDown:f,...p}=e,y=O.useRef(null),v=yn(r,y),j=O.useRef(),w=!i;function k(S){const R=j.current||y.current.getBoundingClientRect(),D=[0,R.height],I=SI(D,w?[s,n]:[n,s]);return j.current=R,I(S-R.top)}return t.jsx($9,{scope:e.__scopeSlider,startEdge:w?"bottom":"top",endEdge:w?"top":"bottom",size:"height",direction:w?1:-1,children:t.jsx(q9,{"data-orientation":"vertical",...p,ref:v,style:{...p.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:S=>{const R=k(S.clientY);l==null||l(R)},onSlideMove:S=>{const R=k(S.clientY);d==null||d(R)},onSlideEnd:()=>{j.current=void 0,a==null||a()},onStepKeyDown:S=>{const D=L9[w?"from-bottom":"from-top"].includes(S.key);f==null||f({event:S,direction:D?-1:1})}})})}),q9=O.forwardRef((e,r)=>{const{__scopeSlider:n,onSlideStart:s,onSlideMove:i,onSlideEnd:l,onHomeKeyDown:d,onEndKeyDown:a,onStepKeyDown:f,...p}=e,y=z2(zy,n);return t.jsx(zr.span,{...p,ref:r,onKeyDown:ar(e.onKeyDown,v=>{v.key==="Home"?(d(v),v.preventDefault()):v.key==="End"?(a(v),v.preventDefault()):D9.concat(R9).includes(v.key)&&(f(v),v.preventDefault())}),onPointerDown:ar(e.onPointerDown,v=>{const j=v.target;j.setPointerCapture(v.pointerId),v.preventDefault(),y.thumbs.has(j)?j.focus():s(v)}),onPointerMove:ar(e.onPointerMove,v=>{v.target.hasPointerCapture(v.pointerId)&&i(v)}),onPointerUp:ar(e.onPointerUp,v=>{const j=v.target;j.hasPointerCapture(v.pointerId)&&(j.releasePointerCapture(v.pointerId),l(v))})})}),V9="SliderTrack",U9=O.forwardRef((e,r)=>{const{__scopeSlider:n,...s}=e,i=z2(V9,n);return t.jsx(zr.span,{"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation,...s,ref:r})});U9.displayName=V9;var aE="SliderRange",W9=O.forwardRef((e,r)=>{const{__scopeSlider:n,...s}=e,i=z2(aE,n),l=B9(aE,n),d=O.useRef(null),a=yn(r,d),f=i.values.length,p=i.values.map(j=>K9(j,i.min,i.max)),y=f>1?Math.min(...p):0,v=100-Math.max(...p);return t.jsx(zr.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...s,ref:a,style:{...e.style,[l.startEdge]:y+"%",[l.endEdge]:v+"%"}})});W9.displayName=aE;var oE="SliderThumb",G9=O.forwardRef((e,r)=>{const n=Gce(e.__scopeSlider),[s,i]=O.useState(null),l=yn(r,a=>i(a)),d=O.useMemo(()=>s?n().findIndex(a=>a.ref.current===s):-1,[n,s]);return t.jsx(Xce,{...e,ref:l,index:d})}),Xce=O.forwardRef((e,r)=>{const{__scopeSlider:n,index:s,name:i,...l}=e,d=z2(oE,n),a=B9(oE,n),[f,p]=O.useState(null),y=yn(r,T=>p(T)),v=f?d.form||!!f.closest("form"):!0,j=S2(f),w=d.values[s],k=w===void 0?0:K9(w,d.min,d.max),S=ede(s,d.values.length),R=j==null?void 0:j[a.size],D=R?rde(R,k,a.direction):0;return O.useEffect(()=>{if(f)return d.thumbs.add(f),()=>{d.thumbs.delete(f)}},[f,d.thumbs]),t.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${k}% + ${D}px)`},children:[t.jsx(iE.ItemSlot,{scope:e.__scopeSlider,children:t.jsx(zr.span,{role:"slider","aria-label":e["aria-label"]||S,"aria-valuemin":d.min,"aria-valuenow":w,"aria-valuemax":d.max,"aria-orientation":d.orientation,"data-orientation":d.orientation,"data-disabled":d.disabled?"":void 0,tabIndex:d.disabled?void 0:0,...l,ref:y,style:w===void 0?{display:"none"}:e.style,onFocus:ar(e.onFocus,()=>{d.valueIndexToChangeRef.current=s})})}),v&&t.jsx(Qce,{name:i??(d.name?d.name+(d.values.length>1?"[]":""):void 0),form:d.form,value:w},s)]})});G9.displayName=oE;var Qce=e=>{const{value:r,...n}=e,s=O.useRef(null),i=A2(r);return O.useEffect(()=>{const l=s.current,d=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(d,"value").set;if(i!==r&&f){const p=new Event("input",{bubbles:!0});f.call(l,r),l.dispatchEvent(p)}},[i,r]),t.jsx("input",{style:{display:"none"},...n,ref:s,defaultValue:r})};function Jce(e=[],r,n){const s=[...e];return s[n]=r,s.sort((i,l)=>i-l)}function K9(e,r,n){const l=100/(n-r)*(e-r);return q_(l,[0,100])}function ede(e,r){return r>2?`Value ${e+1} of ${r}`:r===2?["Minimum","Maximum"][e]:void 0}function tde(e,r){if(e.length===1)return 0;const n=e.map(i=>Math.abs(i-r)),s=Math.min(...n);return n.indexOf(s)}function rde(e,r,n){const s=e/2,l=SI([0,50],[0,s]);return(s-l(r)*n)*n}function nde(e){return e.slice(0,-1).map((r,n)=>e[n+1]-r)}function sde(e,r){if(r>0){const n=nde(e);return Math.min(...n)>=r}return!0}function SI(e,r){return n=>{if(e[0]===e[1]||r[0]===r[1])return r[0];const s=(r[1]-r[0])/(e[1]-e[0]);return r[0]+s*(n-e[0])}}function ide(e){return(String(e).split(".")[1]||"").length}function ade(e,r){const n=Math.pow(10,r);return Math.round(e*n)/n}var H9=z9,ode=U9,lde=W9,cde=G9;const sp=O.forwardRef(({className:e,...r},n)=>t.jsxs(H9,{ref:n,className:gr("relative flex w-full touch-none select-none items-center",e),...r,children:[t.jsx(ode,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:t.jsx(lde,{className:"absolute h-full bg-primary"})}),t.jsx(cde,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));sp.displayName=H9.displayName;const dde=[{id:"schemes",name:"Water Supply Schemes",category:"coverage",icon:"",defaultVisible:!0},{id:"dmas",name:"District Metered Areas",category:"coverage",icon:"",defaultVisible:!0},{id:"facilities",name:"Facilities",category:"infrastructure",icon:"",defaultVisible:!0},{id:"pipelines",name:"Pipelines",category:"network",icon:"",defaultVisible:!0},{id:"network-nodes",name:"Network Nodes",category:"network",icon:"",defaultVisible:!1}];function ude({enabledLayers:e,onLayerToggle:r,onStatusFilterChange:n,onCategoryFilterChange:s,onOpacityChange:i,className:l=""}){const[d,a]=O.useState("all"),[f,p]=O.useState("all"),[y,v]=O.useState([80]),j=T=>{a(T),n==null||n(T)},w=T=>{p(T),s==null||s(T)},k=T=>{v(T),i==null||i(T[0])},S=dde.filter(T=>!(f!=="all"&&T.category!==f)),R=[{value:"all",label:"All Categories"},{value:"coverage",label:"Coverage Areas"},{value:"infrastructure",label:"Infrastructure"},{value:"network",label:"Network"}],D=[{value:"all",label:"All Status"},{value:"active",label:"Active"},{value:"planned",label:"Planned"},{value:"maintenance",label:"Maintenance"},{value:"decommissioned",label:"Decommissioned"}];return t.jsxs(H,{className:`w-80 bg-white/95 dark:bg-gray-900/95 backdrop-blur ${l}`,children:[t.jsx(de,{className:"pb-3",children:t.jsxs(he,{className:"text-base flex items-center gap-2",children:[t.jsx("span",{children:"Network Layers"}),t.jsxs(Ee,{variant:"outline",className:"text-xs font-normal",children:[e.size," active"]})]})}),t.jsxs(Q,{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{className:"text-xs text-gray-600 dark:text-gray-400",children:"Category Filter"}),t.jsxs($t,{value:f,onValueChange:w,children:[t.jsx(Rt,{className:"h-8",children:t.jsx(Bt,{})}),t.jsx(Lt,{children:R.map(T=>t.jsx(Ne,{value:T.value,children:T.label},T.value))})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{className:"text-xs text-gray-600 dark:text-gray-400",children:"Status Filter"}),t.jsxs($t,{value:d,onValueChange:j,children:[t.jsx(Rt,{className:"h-8",children:t.jsx(Bt,{})}),t.jsx(Lt,{children:D.map(T=>t.jsx(Ne,{value:T.value,children:T.label},T.value))})]})]}),t.jsx(sE,{}),t.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:S.map(T=>t.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800 transition",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[t.jsx("span",{className:"text-lg",children:T.icon}),t.jsxs("div",{className:"flex-1",children:[t.jsx(Me,{htmlFor:`layer-${T.id}`,className:"text-sm cursor-pointer text-gray-700 dark:text-gray-300",children:T.name}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize",children:T.category})]})]}),t.jsx(pp,{id:`layer-${T.id}`,checked:e.has(T.id),onCheckedChange:()=>r(T.id)})]},T.id))}),t.jsx(sE,{}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(Me,{className:"text-xs text-gray-600 dark:text-gray-400",children:"Layer Opacity"}),t.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[y[0],"%"]})]}),t.jsx(sp,{value:y,onValueChange:k,min:0,max:100,step:10,className:"w-full"})]}),t.jsxs("div",{className:"pt-2 text-xs text-gray-500 dark:text-gray-400",children:[t.jsx("p",{className:"font-semibold mb-1",children:"Legend"}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded bg-green-500"}),t.jsx("span",{children:"Active"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded bg-blue-500"}),t.jsx("span",{children:"Planned"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded bg-amber-500"}),t.jsx("span",{children:"Maintenance"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded bg-gray-400"}),t.jsx("span",{children:"Decommissioned"})]})]})]})]})]})}const LA=[{id:"positron",name:"Light",url:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json"},{id:"dark-matter",name:"Dark",url:"https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json"},{id:"voyager",name:"Voyager",url:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json"},{id:"osm",name:"OpenStreetMap",url:"https://tiles.openfreemap.org/styles/liberty"}],FA=[{id:"schemes",name:"Water Supply Schemes",category:"coverage",tileUrl:"/api/v1/gis/tiles/schemes/{z}/{x}/{y}.mvt",sourceLayer:"schemes",type:"fill",minZoom:0,maxZoom:22,paint:{"fill-color":["match",["get","status"],"active","#22c55e","planning","#3b82f6","decommissioned","#94a3b8","#6b7280"],"fill-opacity":.6,"fill-outline-color":"#000000"}},{id:"dmas",name:"District Metered Areas",category:"coverage",tileUrl:"/api/v1/gis/tiles/dmas/{z}/{x}/{y}.mvt",sourceLayer:"dmas",type:"fill",minZoom:0,maxZoom:22,paint:{"fill-color":["match",["get","status"],"active","#8b5cf6","planned","#06b6d4","retired","#94a3b8","#6b7280"],"fill-opacity":.5,"fill-outline-color":"#000000"}},{id:"facilities",name:"Facilities",category:"infrastructure",tileUrl:"/api/v1/gis/tiles/facilities/{z}/{x}/{y}.mvt",sourceLayer:"facilities",type:"circle",minZoom:8,maxZoom:22,paint:{"circle-radius":6,"circle-color":["match",["get","category"],"source","#10b981","treatment","#3b82f6","pumpstation","#f59e0b","reservoir","#06b6d4","#6b7280"],"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}},{id:"pipelines",name:"Pipelines",category:"network",tileUrl:"/api/v1/gis/tiles/pipelines/{z}/{x}/{y}.mvt",sourceLayer:"pipelines",type:"line",minZoom:12,maxZoom:22,paint:{"line-color":["match",["get","status"],"active","#3b82f6","leak","#ef4444","rehab","#f59e0b","abandoned","#94a3b8","#6b7280"],"line-width":["interpolate",["linear"],["zoom"],12,1,16,3,20,6],"line-opacity":.8}},{id:"network-nodes",name:"Network Nodes",category:"network",tileUrl:"/api/v1/gis/tiles/network-nodes/{z}/{x}/{y}.mvt",sourceLayer:"network_nodes",type:"circle",minZoom:14,maxZoom:22,paint:{"circle-radius":["interpolate",["linear"],["zoom"],14,2,18,4,22,8],"circle-color":["match",["get","type"],"source","#10b981","wtp","#3b82f6","reservoir","#06b6d4","junction","#fbbf24","valve","#8b5cf6","pump","#f59e0b","#6b7280"],"circle-stroke-width":1,"circle-stroke-color":"#ffffff"}}];function Z9({className:e}){const[r,n]=O.useState({longitude:36.8219,latitude:-1.2921,zoom:8}),[s,i]=O.useState("positron"),[l,d]=O.useState(new Set(["schemes","dmas","facilities","pipelines"])),[a,f]=O.useState(!1),[p,y]=O.useState(80),[v,j]=O.useState("all"),[w,k]=O.useState("all"),S=O.useCallback(T=>{d(I=>{const L=new Set(I);return L.has(T)?L.delete(T):L.add(T),L})},[]),R=O.useCallback(T=>{if(k(T),T==="all")d(new Set(["schemes","dmas","facilities","pipelines"]));else{const I=FA.filter(L=>L.category===T).map(L=>L.id);d(new Set(I))}},[]),D=LA.find(T=>T.id===s)||LA[0];return t.jsxs("div",{className:`relative w-full h-full ${e||""}`,children:[t.jsxs(Hb,{...r,onMove:T=>n(T.viewState),mapStyle:D.url,style:{width:"100%",height:"100%"},children:[t.jsx(Zb,{position:"top-right"}),t.jsx(Yb,{position:"bottom-left"}),t.jsx(C9,{position:"top-right"}),FA.map(T=>{if(!l.has(T.id)||w!=="all"&&T.category!==w)return null;const I={...T.paint};return T.type==="fill"?I["fill-opacity"]=(T.paint["fill-opacity"]||.6)*(p/100):T.type==="circle"?I["circle-opacity"]=p/100:T.type==="line"&&(I["line-opacity"]=(T.paint["line-opacity"]||.8)*(p/100)),t.jsx(W_,{id:T.id,type:"vector",tiles:[T.tileUrl],minzoom:T.minZoom,maxzoom:T.maxZoom,children:t.jsx(G_,{id:T.id,"source-layer":T.sourceLayer,type:T.type,paint:I,filter:v!=="all"?["==",["get","status"],v]:void 0})},T.id)})]}),t.jsx(H,{className:"absolute top-4 left-4 w-64 bg-white/95 dark:bg-gray-900/95 backdrop-blur",children:t.jsxs(Q,{className:"p-4",children:[t.jsx("h3",{className:"font-semibold mb-3 text-gray-900 dark:text-gray-100",children:"Map Controls"}),t.jsxs("div",{className:"mb-4",children:[t.jsx(Me,{className:"text-sm mb-2 block text-gray-700 dark:text-gray-300",children:"Basemap"}),t.jsxs($t,{value:s,onValueChange:i,children:[t.jsx(Rt,{className:"w-full",children:t.jsx(Bt,{})}),t.jsx(Lt,{children:LA.map(T=>t.jsx(Ne,{value:T.id,children:T.name},T.id))})]})]}),t.jsxs(X,{variant:"outline",className:"w-full",onClick:()=>f(!a),children:[t.jsx(wV,{className:"w-4 h-4 mr-2"}),a?"Hide":"Show"," Network Layers"]}),t.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h4",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400",children:"Quick Layers"}),t.jsx(Ee,{variant:"outline",className:"text-xs",children:"Vector Tiles"})]}),t.jsx("div",{className:"space-y-2",children:FA.slice(0,3).map(T=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(Me,{htmlFor:`quick-layer-${T.id}`,className:"text-xs cursor-pointer text-gray-700 dark:text-gray-300",children:T.name}),t.jsx(pp,{id:`quick-layer-${T.id}`,checked:l.has(T.id),onCheckedChange:()=>S(T.id)})]},T.id))})]})]})}),a&&t.jsx(ude,{enabledLayers:l,onLayerToggle:S,onStatusFilterChange:j,onCategoryFilterChange:R,onOpacityChange:y,className:"absolute top-4 left-72"})]})}function hde(){return t.jsx("div",{className:"h-screen w-full flex flex-col",children:t.jsx("div",{className:"flex-1",children:t.jsx(Z9,{})})})}const ts=O.forwardRef(({className:e,...r},n)=>t.jsx("textarea",{className:gr("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));ts.displayName="Textarea";function mde(){const[e,r]=O.useState(!1),[n,s]=O.useState(null),[i,l]=O.useState({name:"",description:""}),d=Sr(),{data:a=[],isLoading:f}=ct({queryKey:["shape-files"],queryFn:async()=>{var S;return((S=(await xe.get("/gis/shape-files")).data)==null?void 0:S.data)||[]}}),p=Nt({mutationFn:async k=>{var D;const S=new FormData;return S.append("file",k),S.append("name",i.name||k.name),S.append("description",i.description),(D=(await xe.post("/gis/shape-files",S)).data)==null?void 0:D.data},onSuccess:()=>{d.invalidateQueries({queryKey:["shape-files"]}),r(!1),s(null),l({name:"",description:""})}}),y=Nt({mutationFn:async k=>{await xe.delete(`/gis/shape-files/${k}`)},onSuccess:()=>{d.invalidateQueries({queryKey:["shape-files"]})}}),v=()=>{n&&i.name&&p.mutate(n)},j=k=>{const S={uploading:"bg-yellow-100 text-yellow-800",processing:"bg-blue-100 text-blue-800",processed:"bg-green-100 text-green-800",failed:"bg-red-100 text-red-800"};return t.jsx(Ee,{className:S[k],children:k})},w=k=>{if(k===0)return"0 Bytes";const S=1024,R=["Bytes","KB","MB","GB"],D=Math.floor(Math.log(k)/Math.log(S));return Math.round(k/Math.pow(S,D)*100)/100+" "+R[D]};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Shape Files & Vector Layers"}),t.jsxs(Or,{open:e,onOpenChange:r,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{className:"gap-2",children:[t.jsx(bc,{className:"w-4 h-4"}),"Upload Shape File"]})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Upload Shape File"})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Me,{children:"Select File"}),t.jsx(Ve,{type:"file",accept:".zip,.shp,.geojson,.json,.gpkg",onChange:k=>{var S;return s(((S=k.target.files)==null?void 0:S[0])||null)},className:"mt-1"}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Supported: ZIP (Shapefile), GeoJSON, GPKG"})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Name"}),t.jsx(Ve,{value:i.name,onChange:k=>l({...i,name:k.target.value}),placeholder:"e.g., Water Supply Zones"})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Description"}),t.jsx(ts,{value:i.description,onChange:k=>l({...i,description:k.target.value}),placeholder:"Optional description",rows:3})]}),t.jsx(X,{onClick:v,disabled:!n||!i.name||p.isPending,className:"w-full",children:p.isPending?"Uploading...":"Upload"})]})]})]})]}),f?t.jsx("p",{className:"text-gray-500",children:"Loading files..."}):a.length===0?t.jsx("p",{className:"text-gray-500 text-center py-8",children:"No shape files uploaded yet"}):t.jsx("div",{className:"grid gap-4",children:a.map(k=>t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx(he,{className:"text-base",children:k.name}),k.description&&t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:k.description})]}),j(k.status)]})}),t.jsxs(Q,{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-500",children:"Type"}),t.jsx("p",{className:"font-medium",children:k.geom_type})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-500",children:"Features"}),t.jsx("p",{className:"font-medium",children:k.feature_count})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-500",children:"Size"}),t.jsx("p",{className:"font-medium",children:w(k.file_size)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-500",children:"Projection"}),t.jsx("p",{className:"font-medium",children:k.projection_crs})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("p",{className:"text-gray-500",children:"Uploaded by"}),t.jsx("p",{className:"font-medium",children:k.uploaded_by.name})]})]}),t.jsxs("div",{className:"flex gap-2",children:[k.status==="processed"&&t.jsxs(t.Fragment,{children:[t.jsxs(X,{size:"sm",variant:"outline",className:"gap-2",children:[t.jsx(ud,{className:"w-4 h-4"}),"Preview"]}),t.jsxs(X,{size:"sm",variant:"outline",className:"gap-2",children:[t.jsx(Ta,{className:"w-4 h-4"}),"Download"]})]}),t.jsx(X,{size:"sm",variant:"outline",className:"gap-2 ml-auto text-red-600 hover:text-red-700",onClick:()=>y.mutate(k.id),disabled:y.isPending,children:t.jsx(As,{className:"w-4 h-4"})})]})]})]},k.id))})]})}function fde(e,r=[]){let n=[];function s(l,d){const a=O.createContext(d),f=n.length;n=[...n,d];function p(v){const{scope:j,children:w,...k}=v,S=(j==null?void 0:j[e][f])||a,R=O.useMemo(()=>k,Object.values(k));return t.jsx(S.Provider,{value:R,children:w})}function y(v,j){const w=(j==null?void 0:j[e][f])||a,k=O.useContext(w);if(k)return k;if(d!==void 0)return d;throw new Error(`\`${v}\` must be used within \`${l}\``)}return p.displayName=l+"Provider",[p,y]}const i=()=>{const l=n.map(d=>O.createContext(d));return function(a){const f=(a==null?void 0:a[e])||l;return O.useMemo(()=>({[`__scope${e}`]:{...a,[e]:f}}),[a,f])}};return i.scopeName=e,[s,pde(i,...r)]}function pde(...e){const r=e[0];if(e.length===1)return r;const n=()=>{const s=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(l){const d=s.reduce((a,{useScope:f,scopeName:p})=>{const v=f(l)[`__scope${p}`];return{...a,...v}},{});return O.useMemo(()=>({[`__scope${r.scopeName}`]:d}),[d])}};return n.scopeName=r.scopeName,n}var zA="rovingFocusGroup.onEntryFocus",xde={bubbles:!1,cancelable:!0},$2="RovingFocusGroup",[lE,Y9,gde]=v2($2),[yde,B2]=fde($2,[gde]),[vde,_de]=yde($2),X9=O.forwardRef((e,r)=>t.jsx(lE.Provider,{scope:e.__scopeRovingFocusGroup,children:t.jsx(lE.Slot,{scope:e.__scopeRovingFocusGroup,children:t.jsx(bde,{...e,ref:r})})}));X9.displayName=$2;var bde=O.forwardRef((e,r)=>{const{__scopeRovingFocusGroup:n,orientation:s,loop:i=!1,dir:l,currentTabStopId:d,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:f,onEntryFocus:p,preventScrollOnEntryFocus:y=!1,...v}=e,j=O.useRef(null),w=yn(r,j),k=Iy(l),[S=null,R]=Nu({prop:d,defaultProp:a,onChange:f}),[D,T]=O.useState(!1),I=Xi(p),L=Y9(n),$=O.useRef(!1),[W,Z]=O.useState(0);return O.useEffect(()=>{const oe=j.current;if(oe)return oe.addEventListener(zA,I),()=>oe.removeEventListener(zA,I)},[I]),t.jsx(vde,{scope:n,orientation:s,dir:k,loop:i,currentTabStopId:S,onItemFocus:O.useCallback(oe=>R(oe),[R]),onItemShiftTab:O.useCallback(()=>T(!0),[]),onFocusableItemAdd:O.useCallback(()=>Z(oe=>oe+1),[]),onFocusableItemRemove:O.useCallback(()=>Z(oe=>oe-1),[]),children:t.jsx(zr.div,{tabIndex:D||W===0?-1:0,"data-orientation":s,...v,ref:w,style:{outline:"none",...e.style},onMouseDown:ar(e.onMouseDown,()=>{$.current=!0}),onFocus:ar(e.onFocus,oe=>{const te=!$.current;if(oe.target===oe.currentTarget&&te&&!D){const be=new CustomEvent(zA,xde);if(oe.currentTarget.dispatchEvent(be),!be.defaultPrevented){const ie=L().filter(Ue=>Ue.focusable),ge=ie.find(Ue=>Ue.active),Ie=ie.find(Ue=>Ue.id===S),Xe=[ge,Ie,...ie].filter(Boolean).map(Ue=>Ue.ref.current);eW(Xe,y)}}$.current=!1}),onBlur:ar(e.onBlur,()=>T(!1))})})}),Q9="RovingFocusGroupItem",J9=O.forwardRef((e,r)=>{const{__scopeRovingFocusGroup:n,focusable:s=!0,active:i=!1,tabStopId:l,...d}=e,a=ad(),f=l||a,p=_de(Q9,n),y=p.currentTabStopId===f,v=Y9(n),{onFocusableItemAdd:j,onFocusableItemRemove:w}=p;return O.useEffect(()=>{if(s)return j(),()=>w()},[s,j,w]),t.jsx(lE.ItemSlot,{scope:n,id:f,focusable:s,active:i,children:t.jsx(zr.span,{tabIndex:y?0:-1,"data-orientation":p.orientation,...d,ref:r,onMouseDown:ar(e.onMouseDown,k=>{s?p.onItemFocus(f):k.preventDefault()}),onFocus:ar(e.onFocus,()=>p.onItemFocus(f)),onKeyDown:ar(e.onKeyDown,k=>{if(k.key==="Tab"&&k.shiftKey){p.onItemShiftTab();return}if(k.target!==k.currentTarget)return;const S=Nde(k,p.orientation,p.dir);if(S!==void 0){if(k.metaKey||k.ctrlKey||k.altKey||k.shiftKey)return;k.preventDefault();let D=v().filter(T=>T.focusable).map(T=>T.ref.current);if(S==="last")D.reverse();else if(S==="prev"||S==="next"){S==="prev"&&D.reverse();const T=D.indexOf(k.currentTarget);D=p.loop?Sde(D,T+1):D.slice(T+1)}setTimeout(()=>eW(D))}})})})});J9.displayName=Q9;var jde={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function wde(e,r){return r!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Nde(e,r,n){const s=wde(e.key,n);if(!(r==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(r==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return jde[s]}function eW(e,r=!1){const n=document.activeElement;for(const s of e)if(s===n||(s.focus({preventScroll:r}),document.activeElement!==n))return}function Sde(e,r){return e.map((n,s)=>e[(r+s)%e.length])}var tW=X9,rW=J9,PI="Tabs",[Pde]=Ou(PI,[B2]),nW=B2(),[Cde,CI]=Pde(PI),sW=O.forwardRef((e,r)=>{const{__scopeTabs:n,value:s,onValueChange:i,defaultValue:l,orientation:d="horizontal",dir:a,activationMode:f="automatic",...p}=e,y=Iy(a),[v,j]=Nu({prop:s,onChange:i,defaultProp:l});return t.jsx(Cde,{scope:n,baseId:ad(),value:v,onValueChange:j,orientation:d,dir:y,activationMode:f,children:t.jsx(zr.div,{dir:y,"data-orientation":d,...p,ref:r})})});sW.displayName=PI;var iW="TabsList",aW=O.forwardRef((e,r)=>{const{__scopeTabs:n,loop:s=!0,...i}=e,l=CI(iW,n),d=nW(n);return t.jsx(tW,{asChild:!0,...d,orientation:l.orientation,dir:l.dir,loop:s,children:t.jsx(zr.div,{role:"tablist","aria-orientation":l.orientation,...i,ref:r})})});aW.displayName=iW;var oW="TabsTrigger",lW=O.forwardRef((e,r)=>{const{__scopeTabs:n,value:s,disabled:i=!1,...l}=e,d=CI(oW,n),a=nW(n),f=uW(d.baseId,s),p=hW(d.baseId,s),y=s===d.value;return t.jsx(rW,{asChild:!0,...a,focusable:!i,active:y,children:t.jsx(zr.button,{type:"button",role:"tab","aria-selected":y,"aria-controls":p,"data-state":y?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:f,...l,ref:r,onMouseDown:ar(e.onMouseDown,v=>{!i&&v.button===0&&v.ctrlKey===!1?d.onValueChange(s):v.preventDefault()}),onKeyDown:ar(e.onKeyDown,v=>{[" ","Enter"].includes(v.key)&&d.onValueChange(s)}),onFocus:ar(e.onFocus,()=>{const v=d.activationMode!=="manual";!y&&!i&&v&&d.onValueChange(s)})})})});lW.displayName=oW;var cW="TabsContent",dW=O.forwardRef((e,r)=>{const{__scopeTabs:n,value:s,forceMount:i,children:l,...d}=e,a=CI(cW,n),f=uW(a.baseId,s),p=hW(a.baseId,s),y=s===a.value,v=O.useRef(y);return O.useEffect(()=>{const j=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(j)},[]),t.jsx(Do,{present:i||y,children:({present:j})=>t.jsx(zr.div,{"data-state":y?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":f,hidden:!j,id:p,tabIndex:0,...d,ref:r,style:{...e.style,animationDuration:v.current?"0s":void 0},children:j&&l})})});dW.displayName=cW;function uW(e,r){return`${e}-trigger-${r}`}function hW(e,r){return`${e}-content-${r}`}var Ade=sW,mW=aW,fW=lW,pW=dW;const Sn=Ade,bn=O.forwardRef(({className:e,...r},n)=>t.jsx(mW,{ref:n,className:gr("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",e),...r}));bn.displayName=mW.displayName;const kt=O.forwardRef(({className:e,...r},n)=>t.jsx(fW,{ref:n,className:gr("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",e),...r}));kt.displayName=fW.displayName;const Dt=O.forwardRef(({className:e,...r},n)=>t.jsx(pW,{ref:n,className:gr("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...r}));Dt.displayName=pW.displayName;function kde(){const[e,r]=O.useState("map");return t.jsxs("div",{className:"h-screen w-full flex flex-col",children:[t.jsxs("div",{className:"border-b bg-white p-4",children:[t.jsx("h1",{className:"text-2xl font-bold",children:"GIS Module"}),t.jsx("p",{className:"text-gray-600",children:"Manage shape files, vector layers, and spatial data"})]}),t.jsxs(Sn,{value:e,onValueChange:r,className:"flex-1 flex flex-col",children:[t.jsxs(bn,{className:"px-4 pt-4 w-full justify-start border-b bg-white",children:[t.jsxs(kt,{value:"map",className:"gap-2",children:[t.jsx(iu,{className:"w-4 h-4"}),"Map Console"]}),t.jsxs(kt,{value:"files",className:"gap-2",children:[t.jsx(bV,{className:"w-4 h-4"}),"Files & Layers"]}),t.jsxs(kt,{value:"settings",className:"gap-2",children:[t.jsx(Us,{className:"w-4 h-4"}),"Settings"]})]}),t.jsx(Dt,{value:"map",className:"flex-1",children:t.jsx("div",{className:"h-full",children:t.jsx(Z9,{})})}),t.jsx(Dt,{value:"files",className:"flex-1 overflow-auto",children:t.jsx("div",{className:"p-6",children:t.jsx(mde,{})})}),t.jsx(Dt,{value:"settings",className:"flex-1 overflow-auto",children:t.jsx("div",{className:"p-6",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"GIS Settings"})}),t.jsx(Q,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold mb-2",children:"Default Projection"}),t.jsx("p",{className:"text-sm text-gray-600",children:"EPSG:4326 (WGS84 - Latitude/Longitude)"})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold mb-2",children:"Supported Formats"}),t.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[t.jsx("li",{children:" Shapefile (.zip containing .shp, .shx, .dbf)"}),t.jsx("li",{children:" GeoJSON (.geojson, .json)"}),t.jsx("li",{children:" GeoPackage (.gpkg)"})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold mb-2",children:"Maximum File Size"}),t.jsx("p",{className:"text-sm text-gray-600",children:"100 MB per file"})]})]})})]})})})]})]})}function Tde(e,r){return O.useReducer((n,s)=>r[n][s]??n,e)}var AI="ScrollArea",[xW]=Ou(AI),[Ede,zl]=xW(AI),gW=O.forwardRef((e,r)=>{const{__scopeScrollArea:n,type:s="hover",dir:i,scrollHideDelay:l=600,...d}=e,[a,f]=O.useState(null),[p,y]=O.useState(null),[v,j]=O.useState(null),[w,k]=O.useState(null),[S,R]=O.useState(null),[D,T]=O.useState(0),[I,L]=O.useState(0),[$,W]=O.useState(!1),[Z,oe]=O.useState(!1),te=yn(r,ie=>f(ie)),be=Iy(i);return t.jsx(Ede,{scope:n,type:s,dir:be,scrollHideDelay:l,scrollArea:a,viewport:p,onViewportChange:y,content:v,onContentChange:j,scrollbarX:w,onScrollbarXChange:k,scrollbarXEnabled:$,onScrollbarXEnabledChange:W,scrollbarY:S,onScrollbarYChange:R,scrollbarYEnabled:Z,onScrollbarYEnabledChange:oe,onCornerWidthChange:T,onCornerHeightChange:L,children:t.jsx(zr.div,{dir:be,...d,ref:te,style:{position:"relative","--radix-scroll-area-corner-width":D+"px","--radix-scroll-area-corner-height":I+"px",...e.style}})})});gW.displayName=AI;var yW="ScrollAreaViewport",vW=O.forwardRef((e,r)=>{const{__scopeScrollArea:n,children:s,asChild:i,nonce:l,...d}=e,a=zl(yW,n),f=O.useRef(null),p=yn(r,f,a.onViewportChange);return t.jsxs(t.Fragment,{children:[t.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:l}),t.jsx(zr.div,{"data-radix-scroll-area-viewport":"",...d,asChild:i,ref:p,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...e.style},children:Bde({asChild:i,children:s},y=>t.jsx("div",{"data-radix-scroll-area-content":"",ref:a.onContentChange,style:{minWidth:a.scrollbarXEnabled?"fit-content":void 0},children:y}))})]})});vW.displayName=yW;var yd="ScrollAreaScrollbar",kI=O.forwardRef((e,r)=>{const{forceMount:n,...s}=e,i=zl(yd,e.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:d}=i,a=e.orientation==="horizontal";return O.useEffect(()=>(a?l(!0):d(!0),()=>{a?l(!1):d(!1)}),[a,l,d]),i.type==="hover"?t.jsx(Mde,{...s,ref:r,forceMount:n}):i.type==="scroll"?t.jsx(Ode,{...s,ref:r,forceMount:n}):i.type==="auto"?t.jsx(_W,{...s,ref:r,forceMount:n}):i.type==="always"?t.jsx(TI,{...s,ref:r}):null});kI.displayName=yd;var Mde=O.forwardRef((e,r)=>{const{forceMount:n,...s}=e,i=zl(yd,e.__scopeScrollArea),[l,d]=O.useState(!1);return O.useEffect(()=>{const a=i.scrollArea;let f=0;if(a){const p=()=>{window.clearTimeout(f),d(!0)},y=()=>{f=window.setTimeout(()=>d(!1),i.scrollHideDelay)};return a.addEventListener("pointerenter",p),a.addEventListener("pointerleave",y),()=>{window.clearTimeout(f),a.removeEventListener("pointerenter",p),a.removeEventListener("pointerleave",y)}}},[i.scrollArea,i.scrollHideDelay]),t.jsx(Do,{present:n||l,children:t.jsx(_W,{"data-state":l?"visible":"hidden",...s,ref:r})})}),Ode=O.forwardRef((e,r)=>{const{forceMount:n,...s}=e,i=zl(yd,e.__scopeScrollArea),l=e.orientation==="horizontal",d=V2(()=>f("SCROLL_END"),100),[a,f]=Tde("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return O.useEffect(()=>{if(a==="idle"){const p=window.setTimeout(()=>f("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(p)}},[a,i.scrollHideDelay,f]),O.useEffect(()=>{const p=i.viewport,y=l?"scrollLeft":"scrollTop";if(p){let v=p[y];const j=()=>{const w=p[y];v!==w&&(f("SCROLL"),d()),v=w};return p.addEventListener("scroll",j),()=>p.removeEventListener("scroll",j)}},[i.viewport,l,f,d]),t.jsx(Do,{present:n||a!=="hidden",children:t.jsx(TI,{"data-state":a==="hidden"?"hidden":"visible",...s,ref:r,onPointerEnter:ar(e.onPointerEnter,()=>f("POINTER_ENTER")),onPointerLeave:ar(e.onPointerLeave,()=>f("POINTER_LEAVE"))})})}),_W=O.forwardRef((e,r)=>{const n=zl(yd,e.__scopeScrollArea),{forceMount:s,...i}=e,[l,d]=O.useState(!1),a=e.orientation==="horizontal",f=V2(()=>{if(n.viewport){const p=n.viewport.offsetWidth<n.viewport.scrollWidth,y=n.viewport.offsetHeight<n.viewport.scrollHeight;d(a?p:y)}},10);return Wg(n.viewport,f),Wg(n.content,f),t.jsx(Do,{present:s||l,children:t.jsx(TI,{"data-state":l?"visible":"hidden",...i,ref:r})})}),TI=O.forwardRef((e,r)=>{const{orientation:n="vertical",...s}=e,i=zl(yd,e.__scopeScrollArea),l=O.useRef(null),d=O.useRef(0),[a,f]=O.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),p=SW(a.viewport,a.content),y={...s,sizes:a,onSizesChange:f,hasThumb:p>0&&p<1,onThumbChange:j=>l.current=j,onThumbPointerUp:()=>d.current=0,onThumbPointerDown:j=>d.current=j};function v(j,w){return zde(j,d.current,a,w)}return n==="horizontal"?t.jsx(Ide,{...y,ref:r,onThumbPositionChange:()=>{if(i.viewport&&l.current){const j=i.viewport.scrollLeft,w=cF(j,a,i.dir);l.current.style.transform=`translate3d(${w}px, 0, 0)`}},onWheelScroll:j=>{i.viewport&&(i.viewport.scrollLeft=j)},onDragScroll:j=>{i.viewport&&(i.viewport.scrollLeft=v(j,i.dir))}}):n==="vertical"?t.jsx(Dde,{...y,ref:r,onThumbPositionChange:()=>{if(i.viewport&&l.current){const j=i.viewport.scrollTop,w=cF(j,a);l.current.style.transform=`translate3d(0, ${w}px, 0)`}},onWheelScroll:j=>{i.viewport&&(i.viewport.scrollTop=j)},onDragScroll:j=>{i.viewport&&(i.viewport.scrollTop=v(j))}}):null}),Ide=O.forwardRef((e,r)=>{const{sizes:n,onSizesChange:s,...i}=e,l=zl(yd,e.__scopeScrollArea),[d,a]=O.useState(),f=O.useRef(null),p=yn(r,f,l.onScrollbarXChange);return O.useEffect(()=>{f.current&&a(getComputedStyle(f.current))},[f]),t.jsx(jW,{"data-orientation":"horizontal",...i,ref:p,sizes:n,style:{bottom:0,left:l.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:l.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":q2(n)+"px",...e.style},onThumbPointerDown:y=>e.onThumbPointerDown(y.x),onDragScroll:y=>e.onDragScroll(y.x),onWheelScroll:(y,v)=>{if(l.viewport){const j=l.viewport.scrollLeft+y.deltaX;e.onWheelScroll(j),CW(j,v)&&y.preventDefault()}},onResize:()=>{f.current&&l.viewport&&d&&s({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:f.current.clientWidth,paddingStart:ON(d.paddingLeft),paddingEnd:ON(d.paddingRight)}})}})}),Dde=O.forwardRef((e,r)=>{const{sizes:n,onSizesChange:s,...i}=e,l=zl(yd,e.__scopeScrollArea),[d,a]=O.useState(),f=O.useRef(null),p=yn(r,f,l.onScrollbarYChange);return O.useEffect(()=>{f.current&&a(getComputedStyle(f.current))},[f]),t.jsx(jW,{"data-orientation":"vertical",...i,ref:p,sizes:n,style:{top:0,right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":q2(n)+"px",...e.style},onThumbPointerDown:y=>e.onThumbPointerDown(y.y),onDragScroll:y=>e.onDragScroll(y.y),onWheelScroll:(y,v)=>{if(l.viewport){const j=l.viewport.scrollTop+y.deltaY;e.onWheelScroll(j),CW(j,v)&&y.preventDefault()}},onResize:()=>{f.current&&l.viewport&&d&&s({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:f.current.clientHeight,paddingStart:ON(d.paddingTop),paddingEnd:ON(d.paddingBottom)}})}})}),[Rde,bW]=xW(yd),jW=O.forwardRef((e,r)=>{const{__scopeScrollArea:n,sizes:s,hasThumb:i,onThumbChange:l,onThumbPointerUp:d,onThumbPointerDown:a,onThumbPositionChange:f,onDragScroll:p,onWheelScroll:y,onResize:v,...j}=e,w=zl(yd,n),[k,S]=O.useState(null),R=yn(r,te=>S(te)),D=O.useRef(null),T=O.useRef(""),I=w.viewport,L=s.content-s.viewport,$=Xi(y),W=Xi(f),Z=V2(v,10);function oe(te){if(D.current){const be=te.clientX-D.current.left,ie=te.clientY-D.current.top;p({x:be,y:ie})}}return O.useEffect(()=>{const te=be=>{const ie=be.target;(k==null?void 0:k.contains(ie))&&$(be,L)};return document.addEventListener("wheel",te,{passive:!1}),()=>document.removeEventListener("wheel",te,{passive:!1})},[I,k,L,$]),O.useEffect(W,[s,W]),Wg(k,Z),Wg(w.content,Z),t.jsx(Rde,{scope:n,scrollbar:k,hasThumb:i,onThumbChange:Xi(l),onThumbPointerUp:Xi(d),onThumbPositionChange:W,onThumbPointerDown:Xi(a),children:t.jsx(zr.div,{...j,ref:R,style:{position:"absolute",...j.style},onPointerDown:ar(e.onPointerDown,te=>{te.button===0&&(te.target.setPointerCapture(te.pointerId),D.current=k.getBoundingClientRect(),T.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",w.viewport&&(w.viewport.style.scrollBehavior="auto"),oe(te))}),onPointerMove:ar(e.onPointerMove,oe),onPointerUp:ar(e.onPointerUp,te=>{const be=te.target;be.hasPointerCapture(te.pointerId)&&be.releasePointerCapture(te.pointerId),document.body.style.webkitUserSelect=T.current,w.viewport&&(w.viewport.style.scrollBehavior=""),D.current=null})})})}),MN="ScrollAreaThumb",wW=O.forwardRef((e,r)=>{const{forceMount:n,...s}=e,i=bW(MN,e.__scopeScrollArea);return t.jsx(Do,{present:n||i.hasThumb,children:t.jsx(Lde,{ref:r,...s})})}),Lde=O.forwardRef((e,r)=>{const{__scopeScrollArea:n,style:s,...i}=e,l=zl(MN,n),d=bW(MN,n),{onThumbPositionChange:a}=d,f=yn(r,v=>d.onThumbChange(v)),p=O.useRef(),y=V2(()=>{p.current&&(p.current(),p.current=void 0)},100);return O.useEffect(()=>{const v=l.viewport;if(v){const j=()=>{if(y(),!p.current){const w=$de(v,a);p.current=w,a()}};return a(),v.addEventListener("scroll",j),()=>v.removeEventListener("scroll",j)}},[l.viewport,y,a]),t.jsx(zr.div,{"data-state":d.hasThumb?"visible":"hidden",...i,ref:f,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:ar(e.onPointerDownCapture,v=>{const w=v.target.getBoundingClientRect(),k=v.clientX-w.left,S=v.clientY-w.top;d.onThumbPointerDown({x:k,y:S})}),onPointerUp:ar(e.onPointerUp,d.onThumbPointerUp)})});wW.displayName=MN;var EI="ScrollAreaCorner",NW=O.forwardRef((e,r)=>{const n=zl(EI,e.__scopeScrollArea),s=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&s?t.jsx(Fde,{...e,ref:r}):null});NW.displayName=EI;var Fde=O.forwardRef((e,r)=>{const{__scopeScrollArea:n,...s}=e,i=zl(EI,n),[l,d]=O.useState(0),[a,f]=O.useState(0),p=!!(l&&a);return Wg(i.scrollbarX,()=>{var v;const y=((v=i.scrollbarX)==null?void 0:v.offsetHeight)||0;i.onCornerHeightChange(y),f(y)}),Wg(i.scrollbarY,()=>{var v;const y=((v=i.scrollbarY)==null?void 0:v.offsetWidth)||0;i.onCornerWidthChange(y),d(y)}),p?t.jsx(zr.div,{...s,ref:r,style:{width:l,height:a,position:"absolute",right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function ON(e){return e?parseInt(e,10):0}function SW(e,r){const n=e/r;return isNaN(n)?0:n}function q2(e){const r=SW(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,s=(e.scrollbar.size-n)*r;return Math.max(s,18)}function zde(e,r,n,s="ltr"){const i=q2(n),l=i/2,d=r||l,a=i-d,f=n.scrollbar.paddingStart+d,p=n.scrollbar.size-n.scrollbar.paddingEnd-a,y=n.content-n.viewport,v=s==="ltr"?[0,y]:[y*-1,0];return PW([f,p],v)(e)}function cF(e,r,n="ltr"){const s=q2(r),i=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,l=r.scrollbar.size-i,d=r.content-r.viewport,a=l-s,f=n==="ltr"?[0,d]:[d*-1,0],p=q_(e,f);return PW([0,d],[0,a])(p)}function PW(e,r){return n=>{if(e[0]===e[1]||r[0]===r[1])return r[0];const s=(r[1]-r[0])/(e[1]-e[0]);return r[0]+s*(n-e[0])}}function CW(e,r){return e>0&&e<r}var $de=(e,r=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},s=0;return function i(){const l={left:e.scrollLeft,top:e.scrollTop},d=n.left!==l.left,a=n.top!==l.top;(d||a)&&r(),n=l,s=window.requestAnimationFrame(i)}(),()=>window.cancelAnimationFrame(s)};function V2(e,r){const n=Xi(e),s=O.useRef(0);return O.useEffect(()=>()=>window.clearTimeout(s.current),[]),O.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(n,r)},[n,r])}function Wg(e,r){const n=Xi(r);Qa(()=>{let s=0;if(e){const i=new ResizeObserver(()=>{cancelAnimationFrame(s),s=window.requestAnimationFrame(n)});return i.observe(e),()=>{window.cancelAnimationFrame(s),i.unobserve(e)}}},[e,n])}function Bde(e,r){const{asChild:n,children:s}=e;if(!n)return typeof r=="function"?r(s):r;const i=O.Children.only(s);return O.cloneElement(i,{children:typeof r=="function"?r(i.props.children):r})}var AW=gW,qde=vW,Vde=NW;const $y=O.forwardRef(({className:e,children:r,...n},s)=>t.jsxs(AW,{ref:s,className:gr("relative overflow-hidden",e),...n,children:[t.jsx(qde,{className:"h-full w-full rounded-[inherit]",children:r}),t.jsx(kW,{}),t.jsx(Vde,{})]}));$y.displayName=AW.displayName;const kW=O.forwardRef(({className:e,orientation:r="vertical",...n},s)=>t.jsx(kI,{ref:s,orientation:r,className:gr("flex touch-none select-none transition-colors",r==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",r==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...n,children:t.jsx(wW,{className:"relative flex-1 rounded-full bg-border"})}));kW.displayName=kI.displayName;const dF=[{name:"Core Registry",href:"/core",icon:lo,color:"text-blue-500",subPages:[{name:"Home",href:"/core"},{name:"Schemes",href:"/core/schemes"},{name:"Assets",href:"/core/assets"},{name:"Facilities",href:"/core/facilities"},{name:"DMAs",href:"/core/dmas"},{name:"Pipelines",href:"/core/pipelines"},{name:"Zones",href:"/core/zones"},{name:"Addresses",href:"/core/addresses"},{name:"Meters",href:"/core/meters"}]},{name:"CRM & Revenue",href:"/crm",icon:Hs,color:"text-green-500",subPages:[{name:"Customers",href:"/crm/customers",icon:Hs},{name:"Account Search",href:"/crm/accounts/search",icon:UT},{name:"Complaints",href:"/crm/complaints",icon:an},{name:"Interactions",href:"/crm/interactions",icon:lm},{name:"Segmentation",href:"/crm/segmentation",icon:sd},{name:"Revenue Assurance",href:"/crm/ra",icon:an},{name:"Dunning & Collections",href:"/crm/dunning",icon:GT},{name:"Import Center",href:"/crm/import",icon:bc}]},{name:"Hydro-Met",href:"/hydromet",icon:_ne,color:"text-cyan-500",subPages:[{name:"Water Sources",href:"/hydromet/sources"},{name:"Stations Registry",href:"/hydromet/stations"},{name:"Aquifer Management",href:"/hydromet/aquifers",icon:gc}]},{name:"Projects",href:"/projects",icon:xV,color:"text-purple-500",subPages:[]},{name:"Costing",href:"/costing",icon:fL,color:"text-orange-500",subPages:[{name:"Budgets",href:"/costing/budgets",icon:fL},{name:"Allocation Console",href:"/costing/allocations",icon:fne},{name:"Cost-to-Serve",href:"/costing/cost-to-serve",icon:xs},{name:"GL Accounts",href:"/costing/gl-accounts",icon:co},{name:"Cost Centers",href:"/costing/cost-centers",icon:eI},{name:"Energy Tariffs",href:"/costing/energy/tariffs",icon:Si},{name:"Energy Readings",href:"/costing/energy/readings",icon:bc},{name:"Energy Dashboard",href:"/costing/energy/dashboard",icon:jne},{name:"Requisitions",href:"/procurement/requisitions",icon:Y0},{name:"RFQ Builder",href:"/procurement/rfqs",icon:$n},{name:"LPO Management",href:"/procurement/lpos",icon:aI}]},{name:"CMMS",href:"/cmms",icon:Jf,color:"text-yellow-500",subPages:[{name:"Dashboard",href:"/cmms/dashboard",icon:sd},{name:"Assets",href:"/cmms/assets",icon:Us},{name:"Work Orders",href:"/cmms/work-orders",icon:Y0},{name:"Job Plans",href:"/cmms/job-plans",icon:$n},{name:"Preventive Maintenance",href:"/cmms/pm",icon:Oo},{name:"Condition Monitoring",href:"/cmms/condition-monitoring",icon:Ka},{name:"Stores & Inventory",href:"/cmms/stores",icon:id},{name:"Fleet Management",href:"/cmms/fleet",icon:B_},{name:"Contractors & SLA",href:"/cmms/contractors",icon:VT},{name:"HSE Safety",href:"/cmms/hse",icon:wi},{name:"Parts Catalog",href:"/cmms/parts",icon:lo},{name:"Asset Map",href:"/cmms/map",icon:iu}]},{name:"Water Quality",href:"/water-quality",icon:gc,color:"text-blue-400",subPages:[{name:"Parameters",href:"/water-quality/parameters",icon:vL},{name:"Sampling Points",href:"/water-quality/sampling-points",icon:Ma},{name:"Sampling Plans",href:"/water-quality/plans",icon:Oo},{name:"Samples",href:"/water-quality/samples",icon:gc},{name:"Lab Results",href:"/water-quality/results",icon:$n},{name:"Compliance",href:"/water-quality/compliance",icon:sd}]},{name:"GIS",href:"/gis",icon:iu,color:"text-red-500",subPages:[{name:"Map Console",href:"/gis",icon:iu},{name:"Files & Layers",href:"/gis",icon:bc},{name:"Settings",href:"/gis",icon:Us}]},{name:"M&E & Service Levels",href:"/me",icon:hg,color:"text-teal-500",subPages:[{name:"KPI Dashboard",href:"/me/kpis",icon:Qc},{name:"Coverage Analytics",href:"/me/coverage",icon:Qf},{name:"NRW Tracker",href:"/me/nrw",icon:gc},{name:"CX Analytics",href:"/me/cx",icon:Ka},{name:"Results Framework",href:"/me/indicators",icon:hg},{name:"Gender & Equity",href:"/me/gender-equity",icon:Hs}]},{name:"Customer & Commercial",href:"/customer",icon:wN,color:"text-pink-500",subPages:[{name:"Tariffs",href:"/customer/tariffs",icon:co},{name:"Billing Runs",href:"/customer/billing",icon:GT},{name:"Payment Reconciliation",href:"/customer/payments",icon:nI},{name:"Meter Routes",href:"/customer/meter-routes",icon:Ma},{name:"Tickets (CRM)",href:"/customer/tickets",icon:wN},{name:"Kiosks",href:"/customer/kiosks",icon:UT},{name:"Water Trucking",href:"/customer/trucking",icon:B_},{name:"Connections",href:"/customer/connections",icon:id}]},{name:"Community & Stakeholder",href:"/community",icon:Ane,color:"text-purple-500",subPages:[{name:"RWSS Committees",href:"/community/committees",icon:Hs},{name:"Committee Finance",href:"/community/finance",icon:co},{name:"Vendor Portal",href:"/community/vendors",icon:VT},{name:"Bids & RFQs",href:"/community/bids",icon:$n},{name:"Vendor Deliveries",href:"/community/deliveries",icon:id},{name:"Stakeholder Map",href:"/community/stakeholders",icon:Hs},{name:"Engagement Planner",href:"/community/engagements",icon:Oo},{name:"GRM Console",href:"/community/grm",icon:lm},{name:"Open Data Catalog",href:"/community/open-data",icon:jV},{name:"Dataset Builder",href:"/community/dataset-builder",icon:Us},{name:"Public Maps",href:"/community/public-maps",icon:iu}]},{name:"Core Operations",href:"/core-ops",icon:Ka,color:"text-emerald-500",subPages:[{name:"Operations Console",href:"/core-ops/console",icon:Qc},{name:"Topology Viewer",href:"/core-ops/topology",icon:Qf},{name:"Telemetry Dashboard",href:"/core-ops/telemetry",icon:gV},{name:"Outage Planner",href:"/core-ops/outages",icon:an},{name:"NRW Dashboard",href:"/core-ops/nrw",icon:gc},{name:"Dosing Control",href:"/core-ops/dosing",icon:vL},{name:"Pump Scheduling",href:"/core-ops/scheduling",icon:Xs},{name:"Pressure & Leak",href:"/core-ops/pressure-leak",icon:Qc},{name:"Shifts",href:"/core-ops/shifts",icon:Xs},{name:"Events",href:"/core-ops/events",icon:ps},{name:"Checklists",href:"/core-ops/checklists",icon:Y0},{name:"Playbooks",href:"/core-ops/playbooks",icon:vu},{name:"Escalation Policies",href:"/core-ops/escalation-policies",icon:z_},{name:"Workflows - Definitions",href:"/core-ops/workflows/definitions",icon:bN},{name:"Workflows - Instances",href:"/core-ops/workflows/instances",icon:bN},{name:"Drought Response",href:"/core-ops/droughts",icon:an}]},{name:"Decision Support & Analytics",href:"/dsa",icon:hne,color:"text-violet-500",subPages:[{name:"Forecast Studio",href:"/dsa/forecast",icon:mne},{name:"Scenario Workbench",href:"/dsa/scenarios",icon:bne},{name:"Optimization Console",href:"/dsa/optimize",icon:Dne},{name:"Anomalies Inbox",href:"/dsa/anomalies",icon:an},{name:"Aquifer Dashboard",href:"/dsa/aquifer",icon:gc},{name:"Tariff Sandbox",href:"/dsa/tariffs",icon:co},{name:"EWS Console",href:"/dsa/ews",icon:z_}]},{name:"Risk, Compliance & Governance",href:"/risk-compliance",icon:Cne,color:"text-orange-500",subPages:[{name:"Dashboard",href:"/risk-compliance/home",icon:Ka},{name:"Risk Register",href:"/risk-compliance/risks",icon:an},{name:"Incidents & Issues",href:"/risk-compliance/incidents",icon:wi},{name:"Business Continuity",href:"/risk-compliance/bcp",icon:bu},{name:"Regulatory Reporting",href:"/risk-compliance/regulatory-reporting",icon:$n},{name:"Policies & SOPs",href:"/risk-compliance/policies",icon:vu},{name:"Internal Audit",href:"/risk-compliance/audit",icon:$n},{name:"HSE",href:"/risk-compliance/hse",icon:wi},{name:"Data Privacy (DPO)",href:"/risk-compliance/dpo",icon:qh}]},{name:"Security",href:"/security",icon:wi,color:"text-red-500",subPages:[{name:"Audit Logs",href:"/security/audit",icon:$n},{name:"Security Alerts",href:"/security/alerts",icon:an},{name:"Roles",href:"/security/roles",icon:jN},{name:"API Keys",href:"/security/api-keys",icon:qh},{name:"DSR Requests",href:"/security/dsr",icon:$n},{name:"Consents",href:"/security/consents",icon:wi},{name:"Key Management",href:"/security/kms",icon:qh},{name:"Retention Policies",href:"/security/retention",icon:Xs},{name:"Data Catalog",href:"/security/data-catalog",icon:lo},{name:"2FA Setup",href:"/security/2fa",icon:wi}]},{name:"Admin",href:"/admin",icon:Us,color:"text-gray-500",subPages:[{name:"Users Management",href:"/admin/users",icon:Hs},{name:"Roles & Permissions",href:"/admin/rbac/roles",icon:jN},{name:"Role & Menu Access",href:"/admin/rbac/menu-access",icon:wi},{name:"Permission Matrix",href:"/admin/rbac/matrix",icon:Us},{name:"Module Settings",href:"/admin/settings",icon:Si},{name:"Audit Logs",href:"/admin/audit",icon:$n},{name:"Security Alerts",href:"/admin/security/alerts",icon:an},{name:"API Keys",href:"/admin/security/api-keys",icon:qh}]},{name:"Integration",href:"/integration",icon:Us,color:"text-indigo-500",subPages:[{name:"API Catalog",href:"/integration/api",icon:lo},{name:"Connector Gallery",href:"/integration/connectors",icon:Us},{name:"Webhook Manager",href:"/integration/webhooks",icon:Us},{name:"ETL Jobs",href:"/integration/etl",icon:Us},{name:"Data Warehouse",href:"/integration/dw",icon:lo},{name:"Communication Templates",href:"/integration/comms",icon:Us}]},{name:"Training & Knowledge",href:"/training",icon:$n,color:"text-amber-500",subPages:[{name:"Course Catalog",href:"/training/courses",icon:$n},{name:"My Learning",href:"/training/my-learning",icon:Ka},{name:"Knowledge Base",href:"/training/kb",icon:lo},{name:"SOPs",href:"/training/sops",icon:Y0},{name:"Skills Matrix",href:"/training/skills",icon:hg},{name:"Certificates",href:"/training/certificates",icon:wi},{name:"Capacity Assessments",href:"/training/assessments",icon:Fne}]}];function Ia(){const e=mp(),[r,n]=O.useState(new Set),[s,i]=O.useState(!1),d=(()=>{const f="/"+e.pathname.split("/")[1];return dF.find(p=>p.href.startsWith(f))})();O.useEffect(()=>{const f=()=>{const j=window.innerHeight<800;i(j),j&&d?n(new Set([d.name])):!j&&d&&n(new Set([d.name]))};f();let p;const y=()=>{clearTimeout(p),p=setTimeout(f,150)};return window.addEventListener("resize",y),()=>{window.removeEventListener("resize",y),clearTimeout(p)}},[d]);const a=f=>{if(s)n(new Set([f]));else{const p=new Set(r);p.has(f)?p.delete(f):p.add(f),n(p)}};return t.jsxs("aside",{className:"w-64 bg-card border-r flex flex-col h-screen",children:[t.jsx("div",{className:"p-6 border-b flex-shrink-0",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-primary rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-primary-foreground font-bold text-sm",children:"RW"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-sm font-bold",children:"Rural Water MIS"}),t.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Management Information System"})]})]})}),t.jsx($y,{className:"flex-1",children:t.jsx("nav",{className:"p-3 space-y-1",children:dF.map(f=>{const p=(d==null?void 0:d.href)===f.href,y=f.subPages.length>0,v=r.has(f.name),j=y&&v,w=gr("w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md transition-colors group",p?"bg-primary/10 text-primary":"text-muted-foreground hover:text-foreground hover:bg-muted");return t.jsxs("div",{children:[y?t.jsxs("button",{onClick:()=>a(f.name),className:w,"aria-expanded":j,"aria-label":`${f.name} ${v?"expanded":"collapsed"}`,children:[t.jsx(f.icon,{className:gr("h-5 w-5 flex-shrink-0",p&&f.color)}),t.jsx("span",{className:"flex-1 text-left",children:f.name}),v?t.jsx(tI,{className:"h-4 w-4"}):t.jsx(Oy,{className:"h-4 w-4"})]}):t.jsxs(lL,{to:f.href,className:({isActive:k})=>gr("flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md transition-colors group",k?"bg-primary/10 text-primary":"text-muted-foreground hover:text-foreground hover:bg-muted"),children:[t.jsx(f.icon,{className:gr("h-5 w-5 flex-shrink-0",p&&f.color)}),t.jsx("span",{className:"flex-1 text-left",children:f.name})]}),j&&t.jsx("div",{className:"mt-1 ml-6 space-y-0.5 animate-in slide-in-from-top-2 duration-200",role:"group","aria-label":`${f.name} submenu`,children:f.subPages.map(k=>{const S="icon"in k?k.icon:null;return t.jsxs(lL,{to:k.href,className:({isActive:R})=>gr("flex items-center gap-2 px-3 py-1.5 text-xs rounded-md transition-colors",R?"bg-primary text-primary-foreground font-medium":"text-muted-foreground hover:text-foreground hover:bg-muted"),children:[S&&t.jsx(S,{className:"h-4 w-4"}),t.jsx("span",{children:k.name})]},k.href)})})]},f.name)})})}),s&&t.jsx("div",{className:"px-3 py-2 text-xs text-muted-foreground bg-muted/50 border-t flex-shrink-0",children:t.jsx("p",{className:"leading-tight",children:"Compact mode active - single section expanded"})})]})}function Ude(){return t.jsxs("div",{className:"flex min-h-screen",children:[t.jsx(Ia,{}),t.jsx("main",{className:"flex-1 p-8 overflow-auto",children:t.jsx(Oa,{})})]})}function Wde(){const[e,r]=O.useState(""),{data:n,isLoading:s,isError:i,error:l}=ct({queryKey:["audit","recent"],queryFn:()=>xe.get("/audit/recent")}),a=((n==null?void 0:n.audit_events)||[]).filter(p=>{var y,v;return p.action.toLowerCase().includes(e.toLowerCase())||((y=p.user)==null?void 0:y.name.toLowerCase().includes(e.toLowerCase()))||((v=p.user)==null?void 0:v.email.toLowerCase().includes(e.toLowerCase()))}),f=p=>{switch(p){case"critical":return"destructive";case"error":return"destructive";case"warning":return"secondary";default:return"outline"}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[t.jsx($n,{className:"h-8 w-8"}),"Audit Logs"]}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"View and search system audit trail"})]}),t.jsxs(X,{children:[t.jsx(Ta,{className:"h-4 w-4 mr-2"}),"Export"]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs("div",{className:"flex-1 relative",children:[t.jsx(di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Search by action, user, or email...",value:e,onChange:p=>r(p.target.value),className:"pl-10"})]})})}),t.jsx(Q,{children:s?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):i?t.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading audit events: ",(l==null?void 0:l.message)||"Unknown error"]}):a.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No audit events found"}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Timestamp"}),t.jsx(ce,{children:"User"}),t.jsx(ce,{children:"Action"}),t.jsx(ce,{children:"Entity"}),t.jsx(ce,{children:"Severity"}),t.jsx(ce,{children:"IP Address"})]})}),t.jsx(mr,{children:a.map(p=>{var y,v;return t.jsxs(ut,{children:[t.jsx(se,{className:"font-mono text-sm",children:new Date(p.created_at).toLocaleString()}),t.jsx(se,{children:t.jsxs("div",{className:"text-sm",children:[t.jsx("p",{className:"font-medium",children:(y=p.user)==null?void 0:y.name}),t.jsx("p",{className:"text-muted-foreground text-xs",children:(v=p.user)==null?void 0:v.email})]})}),t.jsx(se,{className:"font-mono text-sm",children:p.action}),t.jsx(se,{className:"text-sm",children:p.entity_type&&t.jsx("span",{className:"text-muted-foreground",children:p.entity_type})}),t.jsx(se,{children:t.jsx(Ee,{variant:f(p.severity),children:p.severity})}),t.jsx(se,{className:"font-mono text-sm",children:p.ip_address})]},p.id)})})]})})]})]})}function uF(){const e=Sr(),{data:r,isLoading:n,isError:s,error:i}=ct({queryKey:["security-alerts","unresolved"],queryFn:()=>xe.get("/security-alerts/unresolved")}),l=Nt({mutationFn:p=>xe.post(`/security-alerts/${p}/acknowledge`),onSuccess:()=>{e.invalidateQueries({queryKey:["security-alerts"]}),Ge.success("Alert acknowledged")}}),d=Nt({mutationFn:({id:p,notes:y})=>xe.post(`/security-alerts/${p}/resolve`,{resolution_notes:y}),onSuccess:()=>{e.invalidateQueries({queryKey:["security-alerts"]}),Ge.success("Alert resolved")}}),a=(r==null?void 0:r.alerts)||[],f=p=>{switch(p){case"critical":return"destructive";case"high":return"destructive";case"medium":return"secondary";default:return"outline"}};return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[t.jsx(an,{className:"h-8 w-8"}),"Security Alerts"]}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Monitor and manage security incidents"})]})}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Total Alerts"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:a.length})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Unacknowledged"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:a.filter(p=>!p.acknowledged_at).length})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Critical"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold text-destructive",children:a.filter(p=>p.severity==="critical").length})})]})]}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:n?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):s?t.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading security alerts: ",(i==null?void 0:i.message)||"Unknown error"]}):a.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No active alerts"}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Detected"}),t.jsx(ce,{children:"Type"}),t.jsx(ce,{children:"Title"}),t.jsx(ce,{children:"Severity"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:a.map(p=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-mono text-sm",children:new Date(p.detected_at).toLocaleString()}),t.jsx(se,{className:"font-mono text-sm",children:p.alert_type}),t.jsx(se,{children:t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:p.title}),t.jsx("p",{className:"text-sm text-muted-foreground",children:p.description})]})}),t.jsx(se,{children:t.jsx(Ee,{variant:f(p.severity),children:p.severity})}),t.jsx(se,{children:p.acknowledged_at?t.jsx(Ee,{variant:"outline",children:"Acknowledged"}):t.jsx(Ee,{variant:"secondary",children:"New"})}),t.jsx(se,{children:t.jsxs("div",{className:"flex gap-2",children:[!p.acknowledged_at&&t.jsxs(X,{size:"sm",variant:"outline",onClick:()=>l.mutate(p.id),disabled:l.isPending,children:[t.jsx(Fs,{className:"h-4 w-4 mr-1"}),"Acknowledge"]}),t.jsxs(X,{size:"sm",onClick:()=>d.mutate({id:p.id,notes:"Resolved"}),disabled:d.isPending,children:[t.jsx(Mu,{className:"h-4 w-4 mr-1"}),"Resolve"]})]})})]},p.id))})]})})})]})}function Gde(){const{data:e,isLoading:r,isError:n,error:s}=ct({queryKey:["roles"],queryFn:()=>xe.get("/rbac/roles")}),i=(e==null?void 0:e.roles)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[t.jsx(Hs,{className:"h-8 w-8"}),"Roles & Permissions"]}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage user roles and access permissions"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Create Role"]})]}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:r?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):n?t.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading roles: ",(s==null?void 0:s.message)||"Unknown error"]}):i.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No roles found"}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Role Name"}),t.jsx(ce,{children:"Guard"}),t.jsx(ce,{children:"Permissions"}),t.jsx(ce,{children:"Created"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:i.map(l=>{var d,a,f;return t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:l.name}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:l.guard_name})}),t.jsx(se,{children:t.jsxs("div",{className:"flex gap-1 flex-wrap",children:[(d=l.permissions)==null?void 0:d.slice(0,3).map(p=>t.jsx(Ee,{variant:"secondary",className:"text-xs",children:p.name},p.id)),(((a=l.permissions)==null?void 0:a.length)||0)>3&&t.jsxs(Ee,{variant:"secondary",className:"text-xs",children:["+",(((f=l.permissions)==null?void 0:f.length)||0)-3," more"]})]})}),t.jsx(se,{className:"font-mono text-sm",children:new Date(l.created_at).toLocaleDateString()}),t.jsx(se,{children:t.jsx(X,{size:"sm",variant:"outline",children:"Edit"})})]},l.id)})})]})})})]})}function hF(){const{data:e,isLoading:r,isError:n,error:s}=ct({queryKey:["api-keys"],queryFn:()=>xe.get("/rbac/api-keys")}),i=(e==null?void 0:e.api_keys)||[],l=d=>{switch(d){case"active":return"default";case"expired":return"destructive";case"revoked":return"outline";default:return"outline"}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[t.jsx(jN,{className:"h-8 w-8"}),"API Keys"]}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage API access tokens"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Create API Key"]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Total Keys"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:i.length})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Active"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:i.filter(d=>d.status==="active").length})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Expired/Revoked"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:i.filter(d=>d.status!=="active").length})})]})]}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:r?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):n?t.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading API keys: ",(s==null?void 0:s.message)||"Unknown error"]}):i.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No API keys found"}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Name"}),t.jsx(ce,{children:"Key Prefix"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Last Used"}),t.jsx(ce,{children:"Expires"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:i.map(d=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:d.name}),t.jsxs(se,{className:"font-mono text-sm",children:[d.key_prefix,"..."]}),t.jsx(se,{children:t.jsx(Ee,{variant:l(d.status),children:d.status})}),t.jsx(se,{className:"font-mono text-sm",children:d.last_used_at?new Date(d.last_used_at).toLocaleDateString():"Never"}),t.jsx(se,{className:"font-mono text-sm",children:d.expires_at?new Date(d.expires_at).toLocaleDateString():"Never"}),t.jsx(se,{children:t.jsxs(X,{size:"sm",variant:"outline",children:[t.jsx(As,{className:"h-4 w-4 mr-1"}),"Revoke"]})})]},d.id))})]})})})]})}function Kde(){const{data:e,isLoading:r,isError:n,error:s}=ct({queryKey:["dsr","pending"],queryFn:()=>xe.get("/dsr/pending")}),i=(e==null?void 0:e.dsr_requests)||[],l=d=>{switch(d){case"completed":return"default";case"pending":return"secondary";case"rejected":return"destructive";default:return"outline"}};return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[t.jsx(lo,{className:"h-8 w-8"}),"Data Subject Requests"]}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Process GDPR data subject access, deletion, and rectification requests"})]})}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Pending"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:i.filter(d=>d.status==="pending").length})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"This Month"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:i.length})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Avg. Processing Time"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:"2.3d"})})]})]}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:r?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):n?t.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading DSR requests: ",(s==null?void 0:s.message)||"Unknown error"]}):i.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No pending DSR requests"}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Requested"}),t.jsx(ce,{children:"Type"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Processed"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:i.map(d=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-mono text-sm",children:new Date(d.requested_at).toLocaleString()}),t.jsx(se,{className:"font-medium",children:d.request_type}),t.jsx(se,{children:t.jsx(Ee,{variant:l(d.status),children:d.status})}),t.jsx(se,{className:"font-mono text-sm",children:d.processed_at?new Date(d.processed_at).toLocaleString():"-"}),t.jsx(se,{children:d.status==="pending"&&t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(X,{size:"sm",variant:"outline",children:[t.jsx(Fs,{className:"h-4 w-4 mr-1"}),"Approve"]}),t.jsxs(X,{size:"sm",variant:"outline",children:[t.jsx(Mu,{className:"h-4 w-4 mr-1"}),"Reject"]})]})})]},d.id))})]})})})]})}function Hde(){const{data:e,isLoading:r,isError:n,error:s}=ct({queryKey:["consents","active"],queryFn:()=>xe.get("/consents/active")}),i=(e==null?void 0:e.consents)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[t.jsx(wi,{className:"h-8 w-8"}),"Consent Management"]}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Track and manage user consent for data processing"})]})}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Active Consents"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:i.filter(l=>!l.revoked_at).length})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Revoked"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:i.filter(l=>l.revoked_at).length})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Expiring Soon"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:"0"})})]})]}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:r?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):n?t.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading consents: ",(s==null?void 0:s.message)||"Unknown error"]}):i.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No consents found"}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Purpose"}),t.jsx(ce,{children:"Given At"}),t.jsx(ce,{children:"Expires At"}),t.jsx(ce,{children:"Status"})]})}),t.jsx(mr,{children:i.map(l=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:l.purpose}),t.jsx(se,{className:"font-mono text-sm",children:new Date(l.given_at).toLocaleString()}),t.jsx(se,{className:"font-mono text-sm",children:l.expires_at?new Date(l.expires_at).toLocaleString():"Never"}),t.jsx(se,{children:l.revoked_at?t.jsxs(Ee,{variant:"outline",children:[t.jsx(Mu,{className:"h-3 w-3 mr-1"}),"Revoked"]}):t.jsxs(Ee,{variant:"default",children:[t.jsx(Fs,{className:"h-3 w-3 mr-1"}),"Active"]})})]},l.id))})]})})})]})}function Zde(){const{data:e,isLoading:r,isError:n,error:s}=ct({queryKey:["kms","keys"],queryFn:()=>xe.get("/kms/keys")}),i=(e==null?void 0:e.keys)||[],l=d=>{switch(d){case"active":return"default";case"rotating":return"secondary";case"retired":return"outline";default:return"outline"}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[t.jsx(qh,{className:"h-8 w-8"}),"Encryption Key Management"]}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage encryption keys and rotation policies"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Generate Key"]})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Total Keys"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:i.length})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Active"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:i.filter(d=>d.status==="active").length})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Rotating"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:i.filter(d=>d.status==="rotating").length})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Retired"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:i.filter(d=>d.status==="retired").length})})]})]}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:r?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):n?t.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading encryption keys: ",(s==null?void 0:s.message)||"Unknown error"]}):i.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No encryption keys found"}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Key ID"}),t.jsx(ce,{children:"Type"}),t.jsx(ce,{children:"Algorithm"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Created"}),t.jsx(ce,{children:"Last Rotated"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:i.map(d=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-mono text-sm",children:d.key_id}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:d.key_type})}),t.jsx(se,{className:"font-mono text-sm",children:d.algorithm}),t.jsx(se,{children:t.jsx(Ee,{variant:l(d.status),children:d.status})}),t.jsx(se,{className:"font-mono text-sm",children:new Date(d.created_at).toLocaleDateString()}),t.jsx(se,{className:"font-mono text-sm",children:d.rotated_at?new Date(d.rotated_at).toLocaleDateString():"-"}),t.jsx(se,{children:t.jsxs(X,{size:"sm",variant:"outline",children:[t.jsx(SV,{className:"h-4 w-4 mr-1"}),"Rotate"]})})]},d.id))})]})})})]})}function Yde(){var l;const{data:e,isLoading:r,isError:n,error:s}=ct({queryKey:["retention","policies"],queryFn:()=>xe.get("/retention/policies")}),i=(e==null?void 0:e.policies)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[t.jsx(Xs,{className:"h-8 w-8"}),"Data Retention Policies"]}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Configure automated data retention and deletion rules"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Create Policy"]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Active Policies"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:i.filter(d=>d.is_active).length})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Data Types"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:i.length})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Last Run"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-sm font-medium",children:(l=i[0])!=null&&l.last_applied_at?new Date(i[0].last_applied_at).toLocaleDateString():"Never"})})]})]}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:r?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):n?t.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading retention policies: ",(s==null?void 0:s.message)||"Unknown error"]}):i.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No retention policies configured"}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Data Type"}),t.jsx(ce,{children:"Retention Period"}),t.jsx(ce,{children:"Deletion Method"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Last Applied"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:i.map(d=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:d.data_type}),t.jsxs(se,{children:[d.retention_period_days," days"]}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:d.deletion_method})}),t.jsx(se,{children:d.is_active?t.jsx(Ee,{variant:"default",children:"Active"}):t.jsx(Ee,{variant:"outline",children:"Inactive"})}),t.jsx(se,{className:"font-mono text-sm",children:d.last_applied_at?new Date(d.last_applied_at).toLocaleDateString():"-"}),t.jsx(se,{children:t.jsx(X,{size:"sm",variant:"outline",children:"Edit"})})]},d.id))})]})})})]})}function Xde(){const{data:e,isLoading:r,isError:n,error:s}=ct({queryKey:["data-catalog"],queryFn:()=>xe.get("/data-catalog")}),i=(e==null?void 0:e.catalog)||[],l=i.filter(a=>a.is_pii).length,d=i.filter(a=>a.encryption_required).length;return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[t.jsx(Us,{className:"h-8 w-8"}),"Data Catalog"]}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Data classification and compliance inventory"})]})}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Total Fields"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:i.length})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"PII Fields"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:l})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Encrypted"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:d})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm font-medium",children:"Tables"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-3xl font-bold",children:new Set(i.map(a=>a.table_name)).size})})]})]}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:r?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):n?t.jsxs("div",{className:"text-center py-8 text-destructive",children:["Error loading data catalog: ",(s==null?void 0:s.message)||"Unknown error"]}):i.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No data catalog entries"}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Table"}),t.jsx(ce,{children:"Column"}),t.jsx(ce,{children:"Classification"}),t.jsx(ce,{children:"PII"}),t.jsx(ce,{children:"Encryption"}),t.jsx(ce,{children:"Retention"})]})}),t.jsx(mr,{children:i.map(a=>t.jsxs(ut,{children:[t.jsxs(se,{className:"font-mono text-sm",children:[t.jsx(lo,{className:"h-4 w-4 inline mr-1"}),a.table_name]}),t.jsx(se,{className:"font-mono text-sm",children:a.column_name}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:a.data_class})}),t.jsx(se,{children:a.is_pii?t.jsx(Ee,{variant:"destructive",children:"Yes"}):t.jsx(Ee,{variant:"outline",children:"No"})}),t.jsx(se,{children:a.encryption_required?t.jsx(Ee,{variant:"default",children:"Required"}):t.jsx(Ee,{variant:"outline",children:"Optional"})}),t.jsx(se,{children:a.retention_period_days?`${a.retention_period_days}d`:"-"})]},a.id))})]})})})]})}function Qde(){const e=Sr(),[r,n]=O.useState(""),[s,i]=O.useState([]),{data:l,isLoading:d}=ct({queryKey:["2fa-status"],queryFn:()=>xe.get("/auth/2fa/status")}),a=Nt({mutationFn:()=>xe.post("/auth/2fa/enroll"),onSuccess:()=>{e.invalidateQueries({queryKey:["2fa-status"]}),Ge.success("2FA enrollment started")},onError:()=>{Ge.error("Failed to start 2FA enrollment")}}),f=Nt({mutationFn:w=>xe.post("/auth/2fa/verify",{code:w}),onSuccess:w=>{e.invalidateQueries({queryKey:["2fa-status"]}),e.invalidateQueries({queryKey:["auth-user"]}),i(w.recovery_codes||[]),Ge.success("2FA enabled successfully"),n("")},onError:()=>{Ge.error("Invalid verification code")}}),p=Nt({mutationFn:()=>xe.post("/auth/2fa/disable"),onSuccess:()=>{e.invalidateQueries({queryKey:["2fa-status"]}),e.invalidateQueries({queryKey:["auth-user"]}),i([]),Ge.success("2FA disabled")},onError:()=>{Ge.error("Failed to disable 2FA")}}),y=()=>{a.mutate()},v=()=>{r.length===6&&f.mutate(r)},j=()=>{confirm("Are you sure you want to disable 2FA? This will reduce your account security.")&&p.mutate()};return t.jsx("div",{className:"container max-w-3xl py-8",children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Two-Factor Authentication"}),t.jsx("p",{className:"text-muted-foreground mt-2",children:"Add an extra layer of security to your account"})]}),d&&!l?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading 2FA status..."})}):t.jsxs(t.Fragment,{children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[l!=null&&l.enabled?t.jsx(yL,{className:"h-6 w-6 text-green-600"}):t.jsx(wi,{className:"h-6 w-6 text-muted-foreground"}),t.jsxs("div",{children:[t.jsx(he,{children:"Status"}),t.jsx(cr,{children:l!=null&&l.enabled?"Two-factor authentication is enabled":"Two-factor authentication is disabled"})]})]}),(l==null?void 0:l.enabled)&&t.jsx(Ee,{variant:"default",className:"bg-green-600",children:"Enabled"})]})}),t.jsxs(Q,{className:"space-y-6",children:[!(l!=null&&l.enabled)&&!(l!=null&&l.qr_code)&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs(fa,{children:[t.jsx(ps,{className:"h-4 w-4"}),t.jsx(ta,{children:"Two-factor authentication adds an extra layer of security by requiring a code from your authenticator app in addition to your password."})]}),t.jsx(X,{onClick:y,disabled:a.isPending,children:a.isPending?"Setting up...":"Enable 2FA"})]}),(l==null?void 0:l.qr_code)&&!(l!=null&&l.enabled)&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold mb-3",children:"Step 1: Scan QR Code"}),t.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Scan this QR code with your authenticator app (Google Authenticator, Authy, 1Password, etc.)"}),t.jsx("div",{className:"flex justify-center p-4 bg-white rounded-lg",children:t.jsx("img",{src:l.qr_code,alt:"2FA QR Code",className:"w-64 h-64"})})]}),l.secret&&t.jsxs("div",{children:[t.jsx(Me,{children:"Manual Entry Code"}),t.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"If you can't scan the QR code, enter this code manually:"}),t.jsx("code",{className:"block p-3 bg-muted rounded text-sm font-mono",children:l.secret})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold mb-3",children:"Step 2: Verify Code"}),t.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Enter the 6-digit code from your authenticator app to complete setup"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"flex-1",children:t.jsx(Ve,{type:"text",placeholder:"000000",maxLength:6,value:r,onChange:w=>n(w.target.value.replace(/\D/g,"")),onKeyPress:w=>{w.key==="Enter"&&v()}})}),t.jsx(X,{onClick:v,disabled:r.length!==6||f.isPending,children:f.isPending?"Verifying...":"Verify & Enable"})]})]})]}),(l==null?void 0:l.enabled)&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs(fa,{className:"border-green-600 bg-green-50",children:[t.jsx(yL,{className:"h-4 w-4 text-green-600"}),t.jsx(ta,{className:"text-green-900",children:"Your account is protected with two-factor authentication."})]}),t.jsx(X,{variant:"destructive",onClick:j,disabled:p.isPending,children:p.isPending?"Disabling...":"Disable 2FA"})]})]})]}),(s.length>0||(l==null?void 0:l.recovery_codes)&&l.recovery_codes.length>0)&&t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"Recovery Codes"}),t.jsx(cr,{children:"Save these recovery codes in a safe place. You can use them to access your account if you lose your authenticator device."})]}),t.jsxs(Q,{children:[t.jsxs(fa,{className:"mb-4",children:[t.jsx(ps,{className:"h-4 w-4"}),t.jsx(ta,{children:s.length>0?"Save these recovery codes now! They will not be shown again.":"Each recovery code can only be used once. Store them securely."})]}),t.jsx("div",{className:"grid grid-cols-2 gap-2",children:(s.length>0?s:(l==null?void 0:l.recovery_codes)||[]).map((w,k)=>t.jsx("code",{className:"block p-2 bg-muted rounded text-sm font-mono",children:w},k))})]})]})]})]})})}function Jde(){return t.jsxs("div",{className:"flex min-h-screen",children:[t.jsx(Ia,{}),t.jsx("main",{className:"flex-1 p-8 overflow-auto",children:t.jsx(Oa,{})})]})}const xh="",jc={getClasses:()=>xe.get(`${xh}/asset-classes`),getAssets:e=>{const r={};return e!=null&&e.search&&(r.search=e.search),e!=null&&e.status&&(r.status=e.status),e!=null&&e.class_id&&(r.class_id=e.class_id.toString()),e!=null&&e.scheme_id&&(r.scheme_id=e.scheme_id),e!=null&&e.dma_id&&(r.dma_id=e.dma_id),e!=null&&e.parent_id&&(r.parent_id=e.parent_id.toString()),e!=null&&e.per_page&&(r.per_page=e.per_page.toString()),e!=null&&e.page&&(r.page=e.page.toString()),xe.get(`${xh}/assets`,r)},getAsset:e=>xe.get(`${xh}/assets/${e}`),createAsset:e=>xe.post(`${xh}/assets`,e),updateAsset:(e,r)=>xe.put(`${xh}/assets/${e}`,r),deleteAsset:e=>xe.delete(`${xh}/assets/${e}`),getAssetMaintenanceHistory:e=>xe.get(`${xh}/assets/${e}/maintenance-history`),getAssetLocations:e=>xe.get(`${xh}/assets/${e}/locations`)},Di="",pg={getWorkOrders:e=>{const r={};return e!=null&&e.search&&(r.search=e.search),e!=null&&e.status&&(r.status=e.status),e!=null&&e.kind&&(r.kind=e.kind),e!=null&&e.priority&&(r.priority=e.priority),e!=null&&e.asset_id&&(r.asset_id=e.asset_id.toString()),e!=null&&e.assigned_to&&(r.assigned_to=e.assigned_to),e!=null&&e.per_page&&(r.per_page=e.per_page.toString()),e!=null&&e.page&&(r.page=e.page.toString()),xe.get(`${Di}/work-orders`,r)},getWorkOrder:e=>xe.get(`${Di}/work-orders/${e}`),createWorkOrder:e=>xe.post(`${Di}/work-orders`,e),updateWorkOrder:(e,r)=>xe.put(`${Di}/work-orders/${e}`,r),deleteWorkOrder:e=>xe.delete(`${Di}/work-orders/${e}`),addParts:(e,r)=>xe.post(`${Di}/work-orders/${e}/parts`,r),addLabor:(e,r)=>xe.post(`${Di}/work-orders/${e}/labor`,r),assignWorkOrder:(e,r)=>xe.post(`${Di}/work-orders/${e}/assign`,{user_id:r}),startWorkOrder:e=>xe.post(`${Di}/work-orders/${e}/start`),completeWorkOrder:(e,r)=>xe.post(`${Di}/work-orders/${e}/complete`,r),cancelWorkOrder:(e,r)=>xe.post(`${Di}/work-orders/${e}/cancel`,{notes:r}),approveWorkOrder:(e,r)=>xe.post(`${Di}/work-orders/${e}/approve`,{notes:r}),qaWorkOrder:(e,r)=>xe.post(`${Di}/work-orders/${e}/qa`,r),addChecklist:(e,r)=>xe.post(`${Di}/work-orders/${e}/checklist`,r),updateChecklistItem:(e,r)=>xe.patch(`${Di}/work-orders/checklist-items/${e}`,r),addAttachment:(e,r)=>xe.post(`${Di}/work-orders/${e}/attachments`,r),addAssignment:(e,r)=>xe.post(`${Di}/work-orders/${e}/assignments`,r),addComment:(e,r)=>xe.post(`${Di}/work-orders/${e}/comments`,r),getOverdue:()=>xe.get(`${Di}/work-orders/overdue`),getStats:()=>xe.get(`${Di}/work-orders/stats`)},Ex="",IN={getParts:e=>{const r={};return e!=null&&e.search&&(r.search=e.search),e!=null&&e.category&&(r.category=e.category),e!=null&&e.supplier_id&&(r.supplier_id=e.supplier_id.toString()),e!=null&&e.per_page&&(r.per_page=e.per_page.toString()),e!=null&&e.page&&(r.page=e.page.toString()),xe.get(`${Ex}/parts`,r)},getPart:e=>xe.get(`${Ex}/parts/${e}`),createPart:e=>xe.post(`${Ex}/parts`,e),updatePart:(e,r)=>xe.put(`${Ex}/parts/${e}`,r),deletePart:e=>xe.delete(`${Ex}/parts/${e}`),getStockTransactions:e=>{const r=e?{part_id:e.toString()}:{};return xe.get(`${Ex}/stock-txns`,r)}};function eue(){const{data:e}=ct({queryKey:["assets",{per_page:1}],queryFn:()=>jc.getAssets({per_page:1})}),{data:r}=ct({queryKey:["work-orders",{per_page:1}],queryFn:()=>pg.getWorkOrders({per_page:1})}),{data:n}=ct({queryKey:["work-orders",{status:"open",per_page:1}],queryFn:()=>pg.getWorkOrders({status:"open",per_page:1})}),{data:s}=ct({queryKey:["work-orders",{status:"in_progress",per_page:1}],queryFn:()=>pg.getWorkOrders({status:"in_progress",per_page:1})}),{data:i}=ct({queryKey:["parts",{per_page:100}],queryFn:()=>IN.getParts({per_page:100})}),l=(i==null?void 0:i.data.filter(a=>{const f=a.stock_balance||0,p=a.reorder_level||0;return f<=p&&f>0}).length)||0,d=(i==null?void 0:i.data.filter(a=>(a.stock_balance||0)===0).length)||0;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"CMMS Dashboard"}),t.jsx("p",{className:"text-muted-foreground",children:"Overview of assets, maintenance, and inventory"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Total Assets"}),t.jsx(Us,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:(e==null?void 0:e.total)||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Infrastructure and equipment"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Total Work Orders"}),t.jsx(Y0,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:(r==null?void 0:r.total)||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"All maintenance tasks"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Open Work Orders"}),t.jsx(an,{className:"h-4 w-4 text-orange-500"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold text-orange-500",children:(n==null?void 0:n.total)||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Pending assignment"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"In Progress"}),t.jsx(Xs,{className:"h-4 w-4 text-blue-500"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold text-blue-500",children:(s==null?void 0:s.total)||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently being worked on"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Total Parts"}),t.jsx(id,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:(i==null?void 0:i.total)||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Inventory items"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Low Stock"}),t.jsx(an,{className:"h-4 w-4 text-orange-500"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold text-orange-500",children:l}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Need reordering"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Out of Stock"}),t.jsx(an,{className:"h-4 w-4 text-red-500"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold text-red-500",children:d}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Urgent action needed"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"System Status"}),t.jsx(Fs,{className:"h-4 w-4 text-green-500"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold text-green-500",children:"Online"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"All systems operational"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Quick Actions"})}),t.jsxs(Q,{className:"space-y-2",children:[t.jsxs("a",{href:"/cmms/work-orders",className:"block p-3 border rounded hover:bg-accent transition-colors",children:[t.jsx("div",{className:"font-medium",children:"Create Work Order"}),t.jsx("div",{className:"text-sm text-muted-foreground",children:"Schedule maintenance task"})]}),t.jsxs("a",{href:"/cmms/assets",className:"block p-3 border rounded hover:bg-accent transition-colors",children:[t.jsx("div",{className:"font-medium",children:"Add New Asset"}),t.jsx("div",{className:"text-sm text-muted-foreground",children:"Register infrastructure or equipment"})]}),t.jsxs("a",{href:"/cmms/parts",className:"block p-3 border rounded hover:bg-accent transition-colors",children:[t.jsx("div",{className:"font-medium",children:"Manage Inventory"}),t.jsx("div",{className:"text-sm text-muted-foreground",children:"Update parts and stock levels"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Recent Activity"})}),t.jsx(Q,{children:t.jsxs("div",{className:"text-sm text-muted-foreground",children:[t.jsx("p",{children:"System is ready to track your maintenance activities."}),t.jsx("p",{className:"mt-2",children:"Start by adding assets, creating work orders, or managing inventory."})]})})]})]})]})}var Xb=e=>e.type==="checkbox",Cf=e=>e instanceof Date,No=e=>e==null;const TW=e=>typeof e=="object";var zi=e=>!No(e)&&!Array.isArray(e)&&TW(e)&&!Cf(e),EW=e=>zi(e)&&e.target?Xb(e.target)?e.target.checked:e.target.value:e,tue=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,MW=(e,r)=>e.has(tue(r)),rue=e=>{const r=e.constructor&&e.constructor.prototype;return zi(r)&&r.hasOwnProperty("isPrototypeOf")},MI=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Os(e){let r;const n=Array.isArray(e),s=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)r=new Date(e);else if(!(MI&&(e instanceof Blob||s))&&(n||zi(e)))if(r=n?[]:Object.create(Object.getPrototypeOf(e)),!n&&!rue(e))r=e;else for(const i in e)e.hasOwnProperty(i)&&(r[i]=Os(e[i]));else return e;return r}var U2=e=>/^\w*$/.test(e),Ss=e=>e===void 0,W2=e=>Array.isArray(e)?e.filter(Boolean):[],OI=e=>W2(e.replace(/["|']|\]/g,"").split(/\.|\[/)),nr=(e,r,n)=>{if(!r||!zi(e))return n;const s=(U2(r)?[r]:OI(r)).reduce((i,l)=>No(i)?i:i[l],e);return Ss(s)||s===e?Ss(e[r])?n:e[r]:s},Xo=e=>typeof e=="boolean",Un=(e,r,n)=>{let s=-1;const i=U2(r)?[r]:OI(r),l=i.length,d=l-1;for(;++s<l;){const a=i[s];let f=n;if(s!==d){const p=e[a];f=zi(p)||Array.isArray(p)?p:isNaN(+i[s+1])?{}:[]}if(a==="__proto__"||a==="constructor"||a==="prototype")return;e[a]=f,e=e[a]}};const DN={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Sl={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Zd={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},II=me.createContext(null);II.displayName="HookFormContext";const By=()=>me.useContext(II),OW=e=>{const{children:r,...n}=e;return me.createElement(II.Provider,{value:n},r)};var IW=(e,r,n,s=!0)=>{const i={defaultValues:r._defaultValues};for(const l in e)Object.defineProperty(i,l,{get:()=>{const d=l;return r._proxyFormState[d]!==Sl.all&&(r._proxyFormState[d]=!s||Sl.all),n&&(n[d]=!0),e[d]}});return i};const G2=typeof window<"u"?me.useLayoutEffect:me.useEffect;function nue(e){const r=By(),{control:n=r.control,disabled:s,name:i,exact:l}=e||{},[d,a]=me.useState(n._formState),f=me.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return G2(()=>n._subscribe({name:i,formState:f.current,exact:l,callback:p=>{!s&&a({...n._formState,...p})}}),[i,s,l]),me.useEffect(()=>{f.current.isValid&&n._setValid(!0)},[n]),me.useMemo(()=>IW(d,n,f.current,!1),[d,n])}var Jo=e=>typeof e=="string",cE=(e,r,n,s,i)=>Jo(e)?(s&&r.watch.add(e),nr(n,e,i)):Array.isArray(e)?e.map(l=>(s&&r.watch.add(l),nr(n,l))):(s&&(r.watchAll=!0),n),dE=e=>No(e)||!TW(e);function yc(e,r,n=new WeakSet){if(dE(e)||dE(r))return Object.is(e,r);if(Cf(e)&&Cf(r))return e.getTime()===r.getTime();const s=Object.keys(e),i=Object.keys(r);if(s.length!==i.length)return!1;if(n.has(e)||n.has(r))return!0;n.add(e),n.add(r);for(const l of s){const d=e[l];if(!i.includes(l))return!1;if(l!=="ref"){const a=r[l];if(Cf(d)&&Cf(a)||zi(d)&&zi(a)||Array.isArray(d)&&Array.isArray(a)?!yc(d,a,n):!Object.is(d,a))return!1}}return!0}function sue(e){const r=By(),{control:n=r.control,name:s,defaultValue:i,disabled:l,exact:d,compute:a}=e||{},f=me.useRef(i),p=me.useRef(a),y=me.useRef(void 0),v=me.useRef(n),j=me.useRef(s);p.current=a;const[w,k]=me.useState(()=>{const L=n._getWatch(s,f.current);return p.current?p.current(L):L}),S=me.useCallback(L=>{const $=cE(s,n._names,L||n._formValues,!1,f.current);return p.current?p.current($):$},[n._formValues,n._names,s]),R=me.useCallback(L=>{if(!l){const $=cE(s,n._names,L||n._formValues,!1,f.current);if(p.current){const W=p.current($);yc(W,y.current)||(k(W),y.current=W)}else k($)}},[n._formValues,n._names,l,s]);G2(()=>((v.current!==n||!yc(j.current,s))&&(v.current=n,j.current=s,R()),n._subscribe({name:s,formState:{values:!0},exact:d,callback:L=>{R(L.values)}})),[n,d,s,R]),me.useEffect(()=>n._removeUnmounted());const D=v.current!==n,T=j.current,I=me.useMemo(()=>{if(l)return null;const L=!D&&!yc(T,s);return D||L?S():null},[l,D,s,T,S]);return I!==null?I:w}function iue(e){const r=By(),{name:n,disabled:s,control:i=r.control,shouldUnregister:l,defaultValue:d}=e,a=MW(i._names.array,n),f=me.useMemo(()=>nr(i._formValues,n,nr(i._defaultValues,n,d)),[i,n,d]),p=sue({control:i,name:n,defaultValue:f,exact:!0}),y=nue({control:i,name:n,exact:!0}),v=me.useRef(e),j=me.useRef(void 0),w=me.useRef(i.register(n,{...e.rules,value:p,...Xo(e.disabled)?{disabled:e.disabled}:{}}));v.current=e;const k=me.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!nr(y.errors,n)},isDirty:{enumerable:!0,get:()=>!!nr(y.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!nr(y.touchedFields,n)},isValidating:{enumerable:!0,get:()=>!!nr(y.validatingFields,n)},error:{enumerable:!0,get:()=>nr(y.errors,n)}}),[y,n]),S=me.useCallback(I=>w.current.onChange({target:{value:EW(I),name:n},type:DN.CHANGE}),[n]),R=me.useCallback(()=>w.current.onBlur({target:{value:nr(i._formValues,n),name:n},type:DN.BLUR}),[n,i._formValues]),D=me.useCallback(I=>{const L=nr(i._fields,n);L&&I&&(L._f.ref={focus:()=>I.focus&&I.focus(),select:()=>I.select&&I.select(),setCustomValidity:$=>I.setCustomValidity($),reportValidity:()=>I.reportValidity()})},[i._fields,n]),T=me.useMemo(()=>({name:n,value:p,...Xo(s)||y.disabled?{disabled:y.disabled||s}:{},onChange:S,onBlur:R,ref:D}),[n,s,y.disabled,S,R,D,p]);return me.useEffect(()=>{const I=i._options.shouldUnregister||l,L=j.current;L&&L!==n&&!a&&i.unregister(L),i.register(n,{...v.current.rules,...Xo(v.current.disabled)?{disabled:v.current.disabled}:{}});const $=(W,Z)=>{const oe=nr(i._fields,W);oe&&oe._f&&(oe._f.mount=Z)};if($(n,!0),I){const W=Os(nr(i._options.defaultValues,n,v.current.defaultValue));Un(i._defaultValues,n,W),Ss(nr(i._formValues,n))&&Un(i._formValues,n,W)}return!a&&i.register(n),j.current=n,()=>{(a?I&&!i._state.action:I)?i.unregister(n):$(n,!1)}},[n,i,a,l]),me.useEffect(()=>{i._setDisabledField({disabled:s,name:n})},[s,n,i]),me.useMemo(()=>({field:T,formState:y,fieldState:k}),[T,y,k])}const K2=e=>e.render(iue(e));var DI=(e,r,n,s,i)=>r?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[s]:i||!0}}:{},Ao=e=>Array.isArray(e)?e:[e],mF=()=>{let e=[];return{get observers(){return e},next:i=>{for(const l of e)l.next&&l.next(i)},subscribe:i=>(e.push(i),{unsubscribe:()=>{e=e.filter(l=>l!==i)}}),unsubscribe:()=>{e=[]}}};function DW(e,r){const n={};for(const s in e)if(e.hasOwnProperty(s)){const i=e[s],l=r[s];if(i&&zi(i)&&l){const d=DW(i,l);zi(d)&&(n[s]=d)}else e[s]&&(n[s]=l)}return n}var Va=e=>zi(e)&&!Object.keys(e).length,RI=e=>e.type==="file",vc=e=>typeof e=="function",RN=e=>{if(!MI)return!1;const r=e?e.ownerDocument:0;return e instanceof(r&&r.defaultView?r.defaultView.HTMLElement:HTMLElement)},RW=e=>e.type==="select-multiple",LI=e=>e.type==="radio",aue=e=>LI(e)||Xb(e),$A=e=>RN(e)&&e.isConnected;function oue(e,r){const n=r.slice(0,-1).length;let s=0;for(;s<n;)e=Ss(e)?s++:e[r[s++]];return e}function lue(e){for(const r in e)if(e.hasOwnProperty(r)&&!Ss(e[r]))return!1;return!0}function ji(e,r){const n=Array.isArray(r)?r:U2(r)?[r]:OI(r),s=n.length===1?e:oue(e,n),i=n.length-1,l=n[i];return s&&delete s[l],i!==0&&(zi(s)&&Va(s)||Array.isArray(s)&&lue(s))&&ji(e,n.slice(0,-1)),e}var cue=e=>{for(const r in e)if(vc(e[r]))return!0;return!1};function LW(e){return Array.isArray(e)||zi(e)&&!cue(e)}function uE(e,r={}){for(const n in e){const s=e[n];LW(s)?(r[n]=Array.isArray(s)?[]:{},uE(s,r[n])):Ss(s)||(r[n]=!0)}return r}function Fx(e,r,n){n||(n=uE(r));for(const s in e){const i=e[s];if(LW(i))Ss(r)||dE(n[s])?n[s]=uE(i,Array.isArray(i)?[]:{}):Fx(i,No(r)?{}:r[s],n[s]);else{const l=r[s];n[s]=!yc(i,l)}}return n}const fF={value:!1,isValid:!1},pF={value:!0,isValid:!0};var FW=e=>{if(Array.isArray(e)){if(e.length>1){const r=e.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:r,isValid:!!r.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Ss(e[0].attributes.value)?Ss(e[0].value)||e[0].value===""?pF:{value:e[0].value,isValid:!0}:pF:fF}return fF},zW=(e,{valueAsNumber:r,valueAsDate:n,setValueAs:s})=>Ss(e)?e:r?e===""?NaN:e&&+e:n&&Jo(e)?new Date(e):s?s(e):e;const xF={isValid:!1,value:null};var $W=e=>Array.isArray(e)?e.reduce((r,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:r,xF):xF;function gF(e){const r=e.ref;return RI(r)?r.files:LI(r)?$W(e.refs).value:RW(r)?[...r.selectedOptions].map(({value:n})=>n):Xb(r)?FW(e.refs).value:zW(Ss(r.value)?e.ref.value:r.value,e)}var due=(e,r,n,s)=>{const i={};for(const l of e){const d=nr(r,l);d&&Un(i,l,d._f)}return{criteriaMode:n,names:[...e],fields:i,shouldUseNativeValidation:s}},LN=e=>e instanceof RegExp,T0=e=>Ss(e)?e:LN(e)?e.source:zi(e)?LN(e.value)?e.value.source:e.value:e,Qx=e=>({isOnSubmit:!e||e===Sl.onSubmit,isOnBlur:e===Sl.onBlur,isOnChange:e===Sl.onChange,isOnAll:e===Sl.all,isOnTouch:e===Sl.onTouched});const yF="AsyncFunction";var uue=e=>!!e&&!!e.validate&&!!(vc(e.validate)&&e.validate.constructor.name===yF||zi(e.validate)&&Object.values(e.validate).find(r=>r.constructor.name===yF)),hue=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),hE=(e,r,n)=>!n&&(r.watchAll||r.watch.has(e)||[...r.watch].some(s=>e.startsWith(s)&&/^\.\w+/.test(e.slice(s.length))));const xg=(e,r,n,s)=>{for(const i of n||Object.keys(e)){const l=nr(e,i);if(l){const{_f:d,...a}=l;if(d){if(d.refs&&d.refs[0]&&r(d.refs[0],i)&&!s)return!0;if(d.ref&&r(d.ref,d.name)&&!s)return!0;if(xg(a,r))break}else if(zi(a)&&xg(a,r))break}}};function vF(e,r,n){const s=nr(e,n);if(s||U2(n))return{error:s,name:n};const i=n.split(".");for(;i.length;){const l=i.join("."),d=nr(r,l),a=nr(e,l);if(d&&!Array.isArray(d)&&n!==l)return{name:n};if(a&&a.type)return{name:l,error:a};if(a&&a.root&&a.root.type)return{name:`${l}.root`,error:a.root};i.pop()}return{name:n}}var mue=(e,r,n,s)=>{n(e);const{name:i,...l}=e;return Va(l)||Object.keys(l).length>=Object.keys(r).length||Object.keys(l).find(d=>r[d]===(!s||Sl.all))},fue=(e,r,n)=>!e||!r||e===r||Ao(e).some(s=>s&&(n?s===r:s.startsWith(r)||r.startsWith(s))),pue=(e,r,n,s,i)=>i.isOnAll?!1:!n&&i.isOnTouch?!(r||e):(n?s.isOnBlur:i.isOnBlur)?!e:(n?s.isOnChange:i.isOnChange)?e:!0,xue=(e,r)=>!W2(nr(e,r)).length&&ji(e,r),BW=(e,r,n)=>{const s=Ao(nr(e,n));return Un(s,"root",r[n]),Un(e,n,s),e};function _F(e,r,n="validate"){if(Jo(e)||Array.isArray(e)&&e.every(Jo)||Xo(e)&&!e)return{type:n,message:Jo(e)?e:"",ref:r}}var Mx=e=>zi(e)&&!LN(e)?e:{value:e,message:""},mE=async(e,r,n,s,i,l)=>{const{ref:d,refs:a,required:f,maxLength:p,minLength:y,min:v,max:j,pattern:w,validate:k,name:S,valueAsNumber:R,mount:D}=e._f,T=nr(n,S);if(!D||r.has(S))return{};const I=a?a[0]:d,L=ge=>{i&&I.reportValidity&&(I.setCustomValidity(Xo(ge)?"":ge||""),I.reportValidity())},$={},W=LI(d),Z=Xb(d),oe=W||Z,te=(R||RI(d))&&Ss(d.value)&&Ss(T)||RN(d)&&d.value===""||T===""||Array.isArray(T)&&!T.length,be=DI.bind(null,S,s,$),ie=(ge,Ie,Oe,Xe=Zd.maxLength,Ue=Zd.minLength)=>{const tt=ge?Ie:Oe;$[S]={type:ge?Xe:Ue,message:tt,ref:d,...be(ge?Xe:Ue,tt)}};if(l?!Array.isArray(T)||!T.length:f&&(!oe&&(te||No(T))||Xo(T)&&!T||Z&&!FW(a).isValid||W&&!$W(a).isValid)){const{value:ge,message:Ie}=Jo(f)?{value:!!f,message:f}:Mx(f);if(ge&&($[S]={type:Zd.required,message:Ie,ref:I,...be(Zd.required,Ie)},!s))return L(Ie),$}if(!te&&(!No(v)||!No(j))){let ge,Ie;const Oe=Mx(j),Xe=Mx(v);if(!No(T)&&!isNaN(T)){const Ue=d.valueAsNumber||T&&+T;No(Oe.value)||(ge=Ue>Oe.value),No(Xe.value)||(Ie=Ue<Xe.value)}else{const Ue=d.valueAsDate||new Date(T),tt=rt=>new Date(new Date().toDateString()+" "+rt),Ce=d.type=="time",ve=d.type=="week";Jo(Oe.value)&&T&&(ge=Ce?tt(T)>tt(Oe.value):ve?T>Oe.value:Ue>new Date(Oe.value)),Jo(Xe.value)&&T&&(Ie=Ce?tt(T)<tt(Xe.value):ve?T<Xe.value:Ue<new Date(Xe.value))}if((ge||Ie)&&(ie(!!ge,Oe.message,Xe.message,Zd.max,Zd.min),!s))return L($[S].message),$}if((p||y)&&!te&&(Jo(T)||l&&Array.isArray(T))){const ge=Mx(p),Ie=Mx(y),Oe=!No(ge.value)&&T.length>+ge.value,Xe=!No(Ie.value)&&T.length<+Ie.value;if((Oe||Xe)&&(ie(Oe,ge.message,Ie.message),!s))return L($[S].message),$}if(w&&!te&&Jo(T)){const{value:ge,message:Ie}=Mx(w);if(LN(ge)&&!T.match(ge)&&($[S]={type:Zd.pattern,message:Ie,ref:d,...be(Zd.pattern,Ie)},!s))return L(Ie),$}if(k){if(vc(k)){const ge=await k(T,n),Ie=_F(ge,I);if(Ie&&($[S]={...Ie,...be(Zd.validate,Ie.message)},!s))return L(Ie.message),$}else if(zi(k)){let ge={};for(const Ie in k){if(!Va(ge)&&!s)break;const Oe=_F(await k[Ie](T,n),I,Ie);Oe&&(ge={...Oe,...be(Ie,Oe.message)},L(Oe.message),s&&($[S]=ge))}if(!Va(ge)&&($[S]={ref:I,...ge},!s))return $}}return L(!0),$};const gue={mode:Sl.onSubmit,reValidateMode:Sl.onChange,shouldFocusError:!0};function yue(e={}){let r={...gue,...e},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:vc(r.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1},s={},i=zi(r.defaultValues)||zi(r.values)?Os(r.defaultValues||r.values)||{}:{},l=r.shouldUnregister?{}:Os(i),d={action:!1,mount:!1,watch:!1},a={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},f,p=0;const y={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let v={...y};const j={array:mF(),state:mF()},w=r.criteriaMode===Sl.all,k=qe=>nt=>{clearTimeout(p),p=setTimeout(qe,nt)},S=async qe=>{if(!r.disabled&&(y.isValid||v.isValid||qe)){const nt=r.resolver?Va((await Z()).errors):await te(s,!0);nt!==n.isValid&&j.state.next({isValid:nt})}},R=(qe,nt)=>{!r.disabled&&(y.isValidating||y.validatingFields||v.isValidating||v.validatingFields)&&((qe||Array.from(a.mount)).forEach(xt=>{xt&&(nt?Un(n.validatingFields,xt,nt):ji(n.validatingFields,xt))}),j.state.next({validatingFields:n.validatingFields,isValidating:!Va(n.validatingFields)}))},D=(qe,nt=[],xt,Ut,Vt=!0,Ft=!0)=>{if(Ut&&xt&&!r.disabled){if(d.action=!0,Ft&&Array.isArray(nr(s,qe))){const sr=xt(nr(s,qe),Ut.argA,Ut.argB);Vt&&Un(s,qe,sr)}if(Ft&&Array.isArray(nr(n.errors,qe))){const sr=xt(nr(n.errors,qe),Ut.argA,Ut.argB);Vt&&Un(n.errors,qe,sr),xue(n.errors,qe)}if((y.touchedFields||v.touchedFields)&&Ft&&Array.isArray(nr(n.touchedFields,qe))){const sr=xt(nr(n.touchedFields,qe),Ut.argA,Ut.argB);Vt&&Un(n.touchedFields,qe,sr)}(y.dirtyFields||v.dirtyFields)&&(n.dirtyFields=Fx(i,l)),j.state.next({name:qe,isDirty:ie(qe,nt),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else Un(l,qe,nt)},T=(qe,nt)=>{Un(n.errors,qe,nt),j.state.next({errors:n.errors})},I=qe=>{n.errors=qe,j.state.next({errors:n.errors,isValid:!1})},L=(qe,nt,xt,Ut)=>{const Vt=nr(s,qe);if(Vt){const Ft=nr(l,qe,Ss(xt)?nr(i,qe):xt);Ss(Ft)||Ut&&Ut.defaultChecked||nt?Un(l,qe,nt?Ft:gF(Vt._f)):Oe(qe,Ft),d.mount&&!d.action&&S()}},$=(qe,nt,xt,Ut,Vt)=>{let Ft=!1,sr=!1;const tn={name:qe};if(!r.disabled){if(!xt||Ut){(y.isDirty||v.isDirty)&&(sr=n.isDirty,n.isDirty=tn.isDirty=ie(),Ft=sr!==tn.isDirty);const Pn=yc(nr(i,qe),nt);sr=!!nr(n.dirtyFields,qe),Pn?ji(n.dirtyFields,qe):Un(n.dirtyFields,qe,!0),tn.dirtyFields=n.dirtyFields,Ft=Ft||(y.dirtyFields||v.dirtyFields)&&sr!==!Pn}if(xt){const Pn=nr(n.touchedFields,qe);Pn||(Un(n.touchedFields,qe,xt),tn.touchedFields=n.touchedFields,Ft=Ft||(y.touchedFields||v.touchedFields)&&Pn!==xt)}Ft&&Vt&&j.state.next(tn)}return Ft?tn:{}},W=(qe,nt,xt,Ut)=>{const Vt=nr(n.errors,qe),Ft=(y.isValid||v.isValid)&&Xo(nt)&&n.isValid!==nt;if(r.delayError&&xt?(f=k(()=>T(qe,xt)),f(r.delayError)):(clearTimeout(p),f=null,xt?Un(n.errors,qe,xt):ji(n.errors,qe)),(xt?!yc(Vt,xt):Vt)||!Va(Ut)||Ft){const sr={...Ut,...Ft&&Xo(nt)?{isValid:nt}:{},errors:n.errors,name:qe};n={...n,...sr},j.state.next(sr)}},Z=async qe=>{R(qe,!0);const nt=await r.resolver(l,r.context,due(qe||a.mount,s,r.criteriaMode,r.shouldUseNativeValidation));return R(qe),nt},oe=async qe=>{const{errors:nt}=await Z(qe);if(qe)for(const xt of qe){const Ut=nr(nt,xt);Ut?Un(n.errors,xt,Ut):ji(n.errors,xt)}else n.errors=nt;return nt},te=async(qe,nt,xt={valid:!0})=>{for(const Ut in qe){const Vt=qe[Ut];if(Vt){const{_f:Ft,...sr}=Vt;if(Ft){const tn=a.array.has(Ft.name),Pn=Vt._f&&uue(Vt._f);Pn&&y.validatingFields&&R([Ft.name],!0);const zs=await mE(Vt,a.disabled,l,w,r.shouldUseNativeValidation&&!nt,tn);if(Pn&&y.validatingFields&&R([Ft.name]),zs[Ft.name]&&(xt.valid=!1,nt))break;!nt&&(nr(zs,Ft.name)?tn?BW(n.errors,zs,Ft.name):Un(n.errors,Ft.name,zs[Ft.name]):ji(n.errors,Ft.name))}!Va(sr)&&await te(sr,nt,xt)}}return xt.valid},be=()=>{for(const qe of a.unMount){const nt=nr(s,qe);nt&&(nt._f.refs?nt._f.refs.every(xt=>!$A(xt)):!$A(nt._f.ref))&&It(qe)}a.unMount=new Set},ie=(qe,nt)=>!r.disabled&&(qe&&nt&&Un(l,qe,nt),!yc(rt(),i)),ge=(qe,nt,xt)=>cE(qe,a,{...d.mount?l:Ss(nt)?i:Jo(qe)?{[qe]:nt}:nt},xt,nt),Ie=qe=>W2(nr(d.mount?l:i,qe,r.shouldUnregister?nr(i,qe,[]):[])),Oe=(qe,nt,xt={})=>{const Ut=nr(s,qe);let Vt=nt;if(Ut){const Ft=Ut._f;Ft&&(!Ft.disabled&&Un(l,qe,zW(nt,Ft)),Vt=RN(Ft.ref)&&No(nt)?"":nt,RW(Ft.ref)?[...Ft.ref.options].forEach(sr=>sr.selected=Vt.includes(sr.value)):Ft.refs?Xb(Ft.ref)?Ft.refs.forEach(sr=>{(!sr.defaultChecked||!sr.disabled)&&(Array.isArray(Vt)?sr.checked=!!Vt.find(tn=>tn===sr.value):sr.checked=Vt===sr.value||!!Vt)}):Ft.refs.forEach(sr=>sr.checked=sr.value===Vt):RI(Ft.ref)?Ft.ref.value="":(Ft.ref.value=Vt,Ft.ref.type||j.state.next({name:qe,values:Os(l)})))}(xt.shouldDirty||xt.shouldTouch)&&$(qe,Vt,xt.shouldTouch,xt.shouldDirty,!0),xt.shouldValidate&&ve(qe)},Xe=(qe,nt,xt)=>{for(const Ut in nt){if(!nt.hasOwnProperty(Ut))return;const Vt=nt[Ut],Ft=qe+"."+Ut,sr=nr(s,Ft);(a.array.has(qe)||zi(Vt)||sr&&!sr._f)&&!Cf(Vt)?Xe(Ft,Vt,xt):Oe(Ft,Vt,xt)}},Ue=(qe,nt,xt={})=>{const Ut=nr(s,qe),Vt=a.array.has(qe),Ft=Os(nt);Un(l,qe,Ft),Vt?(j.array.next({name:qe,values:Os(l)}),(y.isDirty||y.dirtyFields||v.isDirty||v.dirtyFields)&&xt.shouldDirty&&j.state.next({name:qe,dirtyFields:Fx(i,l),isDirty:ie(qe,Ft)})):Ut&&!Ut._f&&!No(Ft)?Xe(qe,Ft,xt):Oe(qe,Ft,xt),hE(qe,a)&&j.state.next({...n,name:qe}),j.state.next({name:d.mount?qe:void 0,values:Os(l)})},tt=async qe=>{d.mount=!0;const nt=qe.target;let xt=nt.name,Ut=!0;const Vt=nr(s,xt),Ft=Pn=>{Ut=Number.isNaN(Pn)||Cf(Pn)&&isNaN(Pn.getTime())||yc(Pn,nr(l,xt,Pn))},sr=Qx(r.mode),tn=Qx(r.reValidateMode);if(Vt){let Pn,zs;const We=nt.type?gF(Vt._f):EW(qe),le=qe.type===DN.BLUR||qe.type===DN.FOCUS_OUT,ue=!hue(Vt._f)&&!r.resolver&&!nr(n.errors,xt)&&!Vt._f.deps||pue(le,nr(n.touchedFields,xt),n.isSubmitted,tn,sr),ye=hE(xt,a,le);Un(l,xt,We),le?(!nt||!nt.readOnly)&&(Vt._f.onBlur&&Vt._f.onBlur(qe),f&&f(0)):Vt._f.onChange&&Vt._f.onChange(qe);const Ae=$(xt,We,le),ze=!Va(Ae)||ye;if(!le&&j.state.next({name:xt,type:qe.type,values:Os(l)}),ue)return(y.isValid||v.isValid)&&(r.mode==="onBlur"?le&&S():le||S()),ze&&j.state.next({name:xt,...ye?{}:Ae});if(!le&&ye&&j.state.next({...n}),r.resolver){const{errors:Ye}=await Z([xt]);if(Ft(We),Ut){const st=vF(n.errors,s,xt),He=vF(Ye,s,st.name||xt);Pn=He.error,xt=He.name,zs=Va(Ye)}}else R([xt],!0),Pn=(await mE(Vt,a.disabled,l,w,r.shouldUseNativeValidation))[xt],R([xt]),Ft(We),Ut&&(Pn?zs=!1:(y.isValid||v.isValid)&&(zs=await te(s,!0)));Ut&&(Vt._f.deps&&(!Array.isArray(Vt._f.deps)||Vt._f.deps.length>0)&&ve(Vt._f.deps),W(xt,zs,Pn,Ae))}},Ce=(qe,nt)=>{if(nr(n.errors,nt)&&qe.focus)return qe.focus(),1},ve=async(qe,nt={})=>{let xt,Ut;const Vt=Ao(qe);if(r.resolver){const Ft=await oe(Ss(qe)?qe:Vt);xt=Va(Ft),Ut=qe?!Vt.some(sr=>nr(Ft,sr)):xt}else qe?(Ut=(await Promise.all(Vt.map(async Ft=>{const sr=nr(s,Ft);return await te(sr&&sr._f?{[Ft]:sr}:sr)}))).every(Boolean),!(!Ut&&!n.isValid)&&S()):Ut=xt=await te(s);return j.state.next({...!Jo(qe)||(y.isValid||v.isValid)&&xt!==n.isValid?{}:{name:qe},...r.resolver||!qe?{isValid:xt}:{},errors:n.errors}),nt.shouldFocus&&!Ut&&xg(s,Ce,qe?Vt:a.mount),Ut},rt=(qe,nt)=>{let xt={...d.mount?l:i};return nt&&(xt=DW(nt.dirtyFields?n.dirtyFields:n.touchedFields,xt)),Ss(qe)?xt:Jo(qe)?nr(xt,qe):qe.map(Ut=>nr(xt,Ut))},vt=(qe,nt)=>({invalid:!!nr((nt||n).errors,qe),isDirty:!!nr((nt||n).dirtyFields,qe),error:nr((nt||n).errors,qe),isValidating:!!nr(n.validatingFields,qe),isTouched:!!nr((nt||n).touchedFields,qe)}),gt=qe=>{qe&&Ao(qe).forEach(nt=>ji(n.errors,nt)),j.state.next({errors:qe?n.errors:{}})},Et=(qe,nt,xt)=>{const Ut=(nr(s,qe,{_f:{}})._f||{}).ref,Vt=nr(n.errors,qe)||{},{ref:Ft,message:sr,type:tn,...Pn}=Vt;Un(n.errors,qe,{...Pn,...nt,ref:Ut}),j.state.next({name:qe,errors:n.errors,isValid:!1}),xt&&xt.shouldFocus&&Ut&&Ut.focus&&Ut.focus()},tr=(qe,nt)=>vc(qe)?j.state.subscribe({next:xt=>"values"in xt&&qe(ge(void 0,nt),xt)}):ge(qe,nt,!0),Dr=qe=>j.state.subscribe({next:nt=>{fue(qe.name,nt.name,qe.exact)&&mue(nt,qe.formState||y,En,qe.reRenderRoot)&&qe.callback({values:{...l},...n,...nt,defaultValues:i})}}).unsubscribe,Pr=qe=>(d.mount=!0,v={...v,...qe.formState},Dr({...qe,formState:v})),It=(qe,nt={})=>{for(const xt of qe?Ao(qe):a.mount)a.mount.delete(xt),a.array.delete(xt),nt.keepValue||(ji(s,xt),ji(l,xt)),!nt.keepError&&ji(n.errors,xt),!nt.keepDirty&&ji(n.dirtyFields,xt),!nt.keepTouched&&ji(n.touchedFields,xt),!nt.keepIsValidating&&ji(n.validatingFields,xt),!r.shouldUnregister&&!nt.keepDefaultValue&&ji(i,xt);j.state.next({values:Os(l)}),j.state.next({...n,...nt.keepDirty?{isDirty:ie()}:{}}),!nt.keepIsValid&&S()},_r=({disabled:qe,name:nt})=>{(Xo(qe)&&d.mount||qe||a.disabled.has(nt))&&(qe?a.disabled.add(nt):a.disabled.delete(nt))},St=(qe,nt={})=>{let xt=nr(s,qe);const Ut=Xo(nt.disabled)||Xo(r.disabled);return Un(s,qe,{...xt||{},_f:{...xt&&xt._f?xt._f:{ref:{name:qe}},name:qe,mount:!0,...nt}}),a.mount.add(qe),xt?_r({disabled:Xo(nt.disabled)?nt.disabled:r.disabled,name:qe}):L(qe,!0,nt.value),{...Ut?{disabled:nt.disabled||r.disabled}:{},...r.progressive?{required:!!nt.required,min:T0(nt.min),max:T0(nt.max),minLength:T0(nt.minLength),maxLength:T0(nt.maxLength),pattern:T0(nt.pattern)}:{},name:qe,onChange:tt,onBlur:tt,ref:Vt=>{if(Vt){St(qe,nt),xt=nr(s,qe);const Ft=Ss(Vt.value)&&Vt.querySelectorAll&&Vt.querySelectorAll("input,select,textarea")[0]||Vt,sr=aue(Ft),tn=xt._f.refs||[];if(sr?tn.find(Pn=>Pn===Ft):Ft===xt._f.ref)return;Un(s,qe,{_f:{...xt._f,...sr?{refs:[...tn.filter($A),Ft,...Array.isArray(nr(i,qe))?[{}]:[]],ref:{type:Ft.type,name:qe}}:{ref:Ft}}}),L(qe,!1,void 0,Ft)}else xt=nr(s,qe,{}),xt._f&&(xt._f.mount=!1),(r.shouldUnregister||nt.shouldUnregister)&&!(MW(a.array,qe)&&d.action)&&a.unMount.add(qe)}}},Qt=()=>r.shouldFocusError&&xg(s,Ce,a.mount),rr=qe=>{Xo(qe)&&(j.state.next({disabled:qe}),xg(s,(nt,xt)=>{const Ut=nr(s,xt);Ut&&(nt.disabled=Ut._f.disabled||qe,Array.isArray(Ut._f.refs)&&Ut._f.refs.forEach(Vt=>{Vt.disabled=Ut._f.disabled||qe}))},0,!1))},pt=(qe,nt)=>async xt=>{let Ut;xt&&(xt.preventDefault&&xt.preventDefault(),xt.persist&&xt.persist());let Vt=Os(l);if(j.state.next({isSubmitting:!0}),r.resolver){const{errors:Ft,values:sr}=await Z();n.errors=Ft,Vt=Os(sr)}else await te(s);if(a.disabled.size)for(const Ft of a.disabled)ji(Vt,Ft);if(ji(n.errors,"root"),Va(n.errors)){j.state.next({errors:{}});try{await qe(Vt,xt)}catch(Ft){Ut=Ft}}else nt&&await nt({...n.errors},xt),Qt(),setTimeout(Qt);if(j.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Va(n.errors)&&!Ut,submitCount:n.submitCount+1,errors:n.errors}),Ut)throw Ut},qr=(qe,nt={})=>{nr(s,qe)&&(Ss(nt.defaultValue)?Ue(qe,Os(nr(i,qe))):(Ue(qe,nt.defaultValue),Un(i,qe,Os(nt.defaultValue))),nt.keepTouched||ji(n.touchedFields,qe),nt.keepDirty||(ji(n.dirtyFields,qe),n.isDirty=nt.defaultValue?ie(qe,Os(nr(i,qe))):ie()),nt.keepError||(ji(n.errors,qe),y.isValid&&S()),j.state.next({...n}))},or=(qe,nt={})=>{const xt=qe?Os(qe):i,Ut=Os(xt),Vt=Va(qe),Ft=Vt?i:Ut;if(nt.keepDefaultValues||(i=xt),!nt.keepValues){if(nt.keepDirtyValues){const sr=new Set([...a.mount,...Object.keys(Fx(i,l))]);for(const tn of Array.from(sr))nr(n.dirtyFields,tn)?Un(Ft,tn,nr(l,tn)):Ue(tn,nr(Ft,tn))}else{if(MI&&Ss(qe))for(const sr of a.mount){const tn=nr(s,sr);if(tn&&tn._f){const Pn=Array.isArray(tn._f.refs)?tn._f.refs[0]:tn._f.ref;if(RN(Pn)){const zs=Pn.closest("form");if(zs){zs.reset();break}}}}if(nt.keepFieldsRef)for(const sr of a.mount)Ue(sr,nr(Ft,sr));else s={}}l=r.shouldUnregister?nt.keepDefaultValues?Os(i):{}:Os(Ft),j.array.next({values:{...Ft}}),j.state.next({values:{...Ft}})}a={mount:nt.keepDirtyValues?a.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},d.mount=!y.isValid||!!nt.keepIsValid||!!nt.keepDirtyValues||!r.shouldUnregister&&!Va(Ft),d.watch=!!r.shouldUnregister,j.state.next({submitCount:nt.keepSubmitCount?n.submitCount:0,isDirty:Vt?!1:nt.keepDirty?n.isDirty:!!(nt.keepDefaultValues&&!yc(qe,i)),isSubmitted:nt.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:Vt?{}:nt.keepDirtyValues?nt.keepDefaultValues&&l?Fx(i,l):n.dirtyFields:nt.keepDefaultValues&&qe?Fx(i,qe):nt.keepDirty?n.dirtyFields:{},touchedFields:nt.keepTouched?n.touchedFields:{},errors:nt.keepErrors?n.errors:{},isSubmitSuccessful:nt.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:i})},en=(qe,nt)=>or(vc(qe)?qe(l):qe,nt),Lr=(qe,nt={})=>{const xt=nr(s,qe),Ut=xt&&xt._f;if(Ut){const Vt=Ut.refs?Ut.refs[0]:Ut.ref;Vt.focus&&(Vt.focus(),nt.shouldSelect&&vc(Vt.select)&&Vt.select())}},En=qe=>{n={...n,...qe}},Yn={control:{register:St,unregister:It,getFieldState:vt,handleSubmit:pt,setError:Et,_subscribe:Dr,_runSchema:Z,_focusError:Qt,_getWatch:ge,_getDirty:ie,_setValid:S,_setFieldArray:D,_setDisabledField:_r,_setErrors:I,_getFieldArray:Ie,_reset:or,_resetDefaultValues:()=>vc(r.defaultValues)&&r.defaultValues().then(qe=>{en(qe,r.resetOptions),j.state.next({isLoading:!1})}),_removeUnmounted:be,_disableForm:rr,_subjects:j,_proxyFormState:y,get _fields(){return s},get _formValues(){return l},get _state(){return d},set _state(qe){d=qe},get _defaultValues(){return i},get _names(){return a},set _names(qe){a=qe},get _formState(){return n},get _options(){return r},set _options(qe){r={...r,...qe}}},subscribe:Pr,trigger:ve,register:St,handleSubmit:pt,watch:tr,setValue:Ue,getValues:rt,reset:en,resetField:qr,clearErrors:gt,unregister:It,setError:Et,setFocus:Lr,getFieldState:vt};return{...Yn,formControl:Yn}}var gh=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const e=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const n=(Math.random()*16+e)%16|0;return(r=="x"?n:n&3|8).toString(16)})},BA=(e,r,n={})=>n.shouldFocus||Ss(n.shouldFocus)?n.focusName||`${e}.${Ss(n.focusIndex)?r:n.focusIndex}.`:"",qA=(e,r)=>[...e,...Ao(r)],VA=e=>Array.isArray(e)?e.map(()=>{}):void 0;function UA(e,r,n){return[...e.slice(0,r),...Ao(n),...e.slice(r)]}var WA=(e,r,n)=>Array.isArray(e)?(Ss(e[n])&&(e[n]=void 0),e.splice(n,0,e.splice(r,1)[0]),e):[],GA=(e,r)=>[...Ao(r),...Ao(e)];function vue(e,r){let n=0;const s=[...e];for(const i of r)s.splice(i-n,1),n++;return W2(s).length?s:[]}var KA=(e,r)=>Ss(r)?[]:vue(e,Ao(r).sort((n,s)=>n-s)),HA=(e,r,n)=>{[e[r],e[n]]=[e[n],e[r]]},bF=(e,r,n)=>(e[r]=n,e);function FI(e){const r=By(),{control:n=r.control,name:s,keyName:i="id",shouldUnregister:l,rules:d}=e,[a,f]=me.useState(n._getFieldArray(s)),p=me.useRef(n._getFieldArray(s).map(gh)),y=me.useRef(!1);n._names.array.add(s),me.useMemo(()=>d&&a.length>=0&&n.register(s,d),[n,s,a.length,d]),G2(()=>n._subjects.array.subscribe({next:({values:L,name:$})=>{if($===s||!$){const W=nr(L,s);Array.isArray(W)&&(f(W),p.current=W.map(gh))}}}).unsubscribe,[n,s]);const v=me.useCallback(L=>{y.current=!0,n._setFieldArray(s,L)},[n,s]),j=(L,$)=>{const W=Ao(Os(L)),Z=qA(n._getFieldArray(s),W);n._names.focus=BA(s,Z.length-1,$),p.current=qA(p.current,W.map(gh)),v(Z),f(Z),n._setFieldArray(s,Z,qA,{argA:VA(L)})},w=(L,$)=>{const W=Ao(Os(L)),Z=GA(n._getFieldArray(s),W);n._names.focus=BA(s,0,$),p.current=GA(p.current,W.map(gh)),v(Z),f(Z),n._setFieldArray(s,Z,GA,{argA:VA(L)})},k=L=>{const $=KA(n._getFieldArray(s),L);p.current=KA(p.current,L),v($),f($),!Array.isArray(nr(n._fields,s))&&Un(n._fields,s,void 0),n._setFieldArray(s,$,KA,{argA:L})},S=(L,$,W)=>{const Z=Ao(Os($)),oe=UA(n._getFieldArray(s),L,Z);n._names.focus=BA(s,L,W),p.current=UA(p.current,L,Z.map(gh)),v(oe),f(oe),n._setFieldArray(s,oe,UA,{argA:L,argB:VA($)})},R=(L,$)=>{const W=n._getFieldArray(s);HA(W,L,$),HA(p.current,L,$),v(W),f(W),n._setFieldArray(s,W,HA,{argA:L,argB:$},!1)},D=(L,$)=>{const W=n._getFieldArray(s);WA(W,L,$),WA(p.current,L,$),v(W),f(W),n._setFieldArray(s,W,WA,{argA:L,argB:$},!1)},T=(L,$)=>{const W=Os($),Z=bF(n._getFieldArray(s),L,W);p.current=[...Z].map((oe,te)=>!oe||te===L?gh():p.current[te]),v(Z),f([...Z]),n._setFieldArray(s,Z,bF,{argA:L,argB:W},!0,!1)},I=L=>{const $=Ao(Os(L));p.current=$.map(gh),v([...$]),f([...$]),n._setFieldArray(s,[...$],W=>W,{},!0,!1)};return me.useEffect(()=>{if(n._state.action=!1,hE(s,n._names)&&n._subjects.state.next({...n._formState}),y.current&&(!Qx(n._options.mode).isOnSubmit||n._formState.isSubmitted)&&!Qx(n._options.reValidateMode).isOnSubmit)if(n._options.resolver)n._runSchema([s]).then(L=>{const $=nr(L.errors,s),W=nr(n._formState.errors,s);(W?!$&&W.type||$&&(W.type!==$.type||W.message!==$.message):$&&$.type)&&($?Un(n._formState.errors,s,$):ji(n._formState.errors,s),n._subjects.state.next({errors:n._formState.errors}))});else{const L=nr(n._fields,s);L&&L._f&&!(Qx(n._options.reValidateMode).isOnSubmit&&Qx(n._options.mode).isOnSubmit)&&mE(L,n._names.disabled,n._formValues,n._options.criteriaMode===Sl.all,n._options.shouldUseNativeValidation,!0).then($=>!Va($)&&n._subjects.state.next({errors:BW(n._formState.errors,$,s)}))}n._subjects.state.next({name:s,values:Os(n._formValues)}),n._names.focus&&xg(n._fields,(L,$)=>{if(n._names.focus&&$.startsWith(n._names.focus)&&L.focus)return L.focus(),1}),n._names.focus="",n._setValid(),y.current=!1},[a,s,n]),me.useEffect(()=>(!nr(n._formValues,s)&&n._setFieldArray(s),()=>{const L=($,W)=>{const Z=nr(n._fields,$);Z&&Z._f&&(Z._f.mount=W)};n._options.shouldUnregister||l?n.unregister(s):L(s,!1)}),[s,n,i,l]),{swap:me.useCallback(R,[v,s,n]),move:me.useCallback(D,[v,s,n]),prepend:me.useCallback(w,[v,s,n]),append:me.useCallback(j,[v,s,n]),remove:me.useCallback(k,[v,s,n]),insert:me.useCallback(S,[v,s,n]),update:me.useCallback(T,[v,s,n]),replace:me.useCallback(I,[v,s,n]),fields:me.useMemo(()=>a.map((L,$)=>({...L,[i]:p.current[$]||gh()})),[a,i])}}function yi(e={}){const r=me.useRef(void 0),n=me.useRef(void 0),[s,i]=me.useState({isDirty:!1,isValidating:!1,isLoading:vc(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:vc(e.defaultValues)?void 0:e.defaultValues});if(!r.current)if(e.formControl)r.current={...e.formControl,formState:s},e.defaultValues&&!vc(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:d,...a}=yue(e);r.current={...a,formState:s}}const l=r.current.control;return l._options=e,G2(()=>{const d=l._subscribe({formState:l._proxyFormState,callback:()=>i({...l._formState}),reRenderRoot:!0});return i(a=>({...a,isReady:!0})),l._formState.isReady=!0,d},[l]),me.useEffect(()=>l._disableForm(e.disabled),[l,e.disabled]),me.useEffect(()=>{e.mode&&(l._options.mode=e.mode),e.reValidateMode&&(l._options.reValidateMode=e.reValidateMode)},[l,e.mode,e.reValidateMode]),me.useEffect(()=>{e.errors&&(l._setErrors(e.errors),l._focusError())},[l,e.errors]),me.useEffect(()=>{e.shouldUnregister&&l._subjects.state.next({values:l._getWatch()})},[l,e.shouldUnregister]),me.useEffect(()=>{if(l._proxyFormState.isDirty){const d=l._getDirty();d!==s.isDirty&&l._subjects.state.next({isDirty:d})}},[l,s.isDirty]),me.useEffect(()=>{var d;e.values&&!yc(e.values,n.current)?(l._reset(e.values,{keepFieldsRef:!0,...l._options.resetOptions}),!((d=l._options.resetOptions)===null||d===void 0)&&d.keepIsValid||l._setValid(),n.current=e.values,i(a=>({...a}))):l._resetDefaultValues()},[l,e.values]),me.useEffect(()=>{l._state.mount||(l._setValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),r.current.formState=IW(s,l),r.current}function _ue({open:e,onOpenChange:r,asset:n}){var R,D;const s=Sr(),i=!!n,{register:l,handleSubmit:d,reset:a,setValue:f,watch:p,formState:{errors:y}}=yi({defaultValues:n?{class_id:n.class_id,parent_id:n.parent_id||void 0,scheme_id:n.scheme_id||void 0,dma_id:n.dma_id||void 0,code:n.code,name:n.name,status:n.status,manufacturer:n.manufacturer||void 0,model:n.model||void 0,serial:n.serial||void 0,install_date:n.install_date||void 0,barcode:n.barcode||void 0}:{status:"active"}}),{data:v}=ct({queryKey:["asset-classes"],queryFn:()=>jc.getClasses()}),{data:j}=ct({queryKey:["assets-for-parent"],queryFn:()=>jc.getAssets({per_page:200})}),w=Nt({mutationFn:T=>jc.createAsset(T),onSuccess:()=>{s.invalidateQueries({queryKey:["assets"]}),Ge.success("Asset created successfully"),r(!1),a()},onError:T=>{var I,L;Ge.error(((L=(I=T.response)==null?void 0:I.data)==null?void 0:L.message)||"Failed to create asset")}}),k=Nt({mutationFn:T=>jc.updateAsset(n.id,T),onSuccess:()=>{s.invalidateQueries({queryKey:["assets"]}),s.invalidateQueries({queryKey:["asset",n.id]}),Ge.success("Asset updated successfully"),r(!1)},onError:T=>{var I,L;Ge.error(((L=(I=T.response)==null?void 0:I.data)==null?void 0:L.message)||"Failed to update asset")}}),S=T=>{i?k.mutate(T):w.mutate(T)};return O.useEffect(()=>{n?Object.keys(n).forEach(T=>{f(T,n[T])}):a({status:"active"})},[n,f,a]),t.jsx(Or,{open:e,onOpenChange:r,children:t.jsxs(kr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:i?"Edit Asset":"Create New Asset"}),t.jsx(Pi,{children:i?"Update asset information":"Add a new asset to the registry"})]}),t.jsxs("form",{onSubmit:d(S),className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"class_id",children:"Asset Class *"}),t.jsxs($t,{onValueChange:T=>f("class_id",Number(T)),defaultValue:(R=n==null?void 0:n.class_id)==null?void 0:R.toString(),children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select class"})}),t.jsx(Lt,{children:v==null?void 0:v.map(T=>t.jsx(Ne,{value:T.id.toString(),children:T.name},T.id))})]}),y.class_id&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"parent_id",children:"Parent Asset"}),t.jsxs($t,{onValueChange:T=>f("parent_id",T&&T!=="none"?Number(T):void 0),defaultValue:((D=n==null?void 0:n.parent_id)==null?void 0:D.toString())||"none",children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"None"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"none",children:"None"}),j==null?void 0:j.data.filter(T=>T.id!==(n==null?void 0:n.id)).map(T=>t.jsxs(Ne,{value:T.id.toString(),children:[T.code," - ",T.name]},T.id))]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"code",children:"Asset Code *"}),t.jsx(Ve,{id:"code",...l("code",{required:!0}),placeholder:"e.g., PUMP-001"}),y.code&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"name",children:"Asset Name *"}),t.jsx(Ve,{id:"name",...l("name",{required:!0}),placeholder:"e.g., Main Borehole Pump"}),y.name&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"status",children:"Status *"}),t.jsxs($t,{onValueChange:T=>f("status",T),defaultValue:(n==null?void 0:n.status)||"active",children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"active",children:"Active"}),t.jsx(Ne,{value:"inactive",children:"Inactive"}),t.jsx(Ne,{value:"under_maintenance",children:"Under Maintenance"}),t.jsx(Ne,{value:"retired",children:"Retired"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"manufacturer",children:"Manufacturer"}),t.jsx(Ve,{id:"manufacturer",...l("manufacturer")})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"model",children:"Model"}),t.jsx(Ve,{id:"model",...l("model")})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"serial",children:"Serial Number"}),t.jsx(Ve,{id:"serial",...l("serial")})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"install_date",children:"Installation Date"}),t.jsx(Ve,{id:"install_date",type:"date",...l("install_date")})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"barcode",children:"Barcode"}),t.jsx(Ve,{id:"barcode",...l("barcode")})]})]}),t.jsxs(Ji,{children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:w.isPending||k.isPending,children:w.isPending||k.isPending?"Saving...":i?"Update":"Create"})]})]})]})})}const bue=[{value:"none",label:"All Statuses"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"retired",label:"Retired"},{value:"under_maintenance",label:"Under Maintenance"}],jue={active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",retired:"bg-red-100 text-red-800",under_maintenance:"bg-yellow-100 text-yellow-800"};function wue(){var w;const[e,r]=O.useState({per_page:15,page:1}),[n,s]=O.useState(!1),[i,l]=O.useState(),{data:d}=ct({queryKey:["asset-classes"],queryFn:()=>jc.getClasses()}),{data:a,isLoading:f,error:p}=ct({queryKey:["assets",e],queryFn:()=>jc.getAssets(e)}),y=k=>{r({...e,search:k,page:1})},v=k=>{r({...e,status:k&&k!=="none"?k:void 0,page:1})},j=k=>{r({...e,class_id:k&&k!=="none"?Number(k):void 0,page:1})};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Assets"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage infrastructure assets and equipment"})]}),t.jsxs(X,{onClick:()=>{l(void 0),s(!0)},children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Add Asset"]})]}),f&&!a?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading assets..."})}):p?t.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:t.jsxs("p",{className:"text-lg text-destructive",children:["Error loading assets: ",p.message]})}):t.jsxs(t.Fragment,{children:[t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsxs("div",{className:"flex gap-4 mb-6",children:[t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"relative",children:[t.jsx(di,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Search by code, name, or serial...",className:"pl-9",value:e.search||"",onChange:k=>y(k.target.value)})]})}),t.jsxs($t,{value:e.status||"",onValueChange:v,children:[t.jsx(Rt,{className:"w-[200px]",children:t.jsx(Bt,{placeholder:"Filter by status"})}),t.jsx(Lt,{children:bue.map(k=>t.jsx(Ne,{value:k.value,children:k.label},k.value))})]}),t.jsxs($t,{value:((w=e.class_id)==null?void 0:w.toString())||"none",onValueChange:j,children:[t.jsx(Rt,{className:"w-[200px]",children:t.jsx(Bt,{placeholder:"Filter by class"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"none",children:"All Classes"}),d==null?void 0:d.map(k=>t.jsx(Ne,{value:k.id.toString(),children:k.name},k.id))]})]})]}),t.jsx("div",{className:"border rounded-lg",children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Code"}),t.jsx(ce,{children:"Name"}),t.jsx(ce,{children:"Class"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Manufacturer"}),t.jsx(ce,{children:"Install Date"}),t.jsx(ce,{className:"text-right",children:"Actions"})]})}),t.jsx(mr,{children:a==null?void 0:a.data.map(k=>{var S;return t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:k.code}),t.jsx(se,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[k.geom&&t.jsx(Ma,{className:"h-4 w-4 text-muted-foreground"}),k.name]})}),t.jsx(se,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Us,{className:"h-4 w-4 text-muted-foreground"}),((S=k.asset_class)==null?void 0:S.name)||"Unknown"]})}),t.jsx(se,{children:t.jsx(Ee,{className:jue[k.status],children:k.status.replace("_"," ")})}),t.jsx(se,{className:"text-muted-foreground",children:k.manufacturer||"-"}),t.jsx(se,{className:"text-muted-foreground",children:k.install_date?new Date(k.install_date).toLocaleDateString():"-"}),t.jsx(se,{className:"text-right",children:t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(nd,{to:`/cmms/assets/${k.id}`,children:t.jsx(X,{variant:"ghost",size:"sm",children:"View"})}),t.jsx(X,{variant:"ghost",size:"sm",onClick:()=>{l(k),s(!0)},children:t.jsx(Dl,{className:"h-4 w-4"})})]})})]},k.id)})})]})}),(a==null?void 0:a.data.length)===0&&t.jsxs("div",{className:"flex flex-col items-center justify-center p-12",children:[t.jsx(Us,{className:"h-12 w-12 text-muted-foreground mb-4"}),t.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No assets found"}),t.jsxs(X,{onClick:()=>{l(void 0),s(!0)},children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Add Your First Asset"]})]}),a&&a.total>0&&t.jsxs("div",{className:"flex items-center justify-between mt-4",children:[t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",a.from," to ",a.to," of ",a.total," assets"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{variant:"outline",size:"sm",disabled:a.current_page===1,onClick:()=>r({...e,page:(e.page||1)-1}),children:"Previous"}),t.jsx(X,{variant:"outline",size:"sm",disabled:a.current_page===a.last_page,onClick:()=>r({...e,page:(e.page||1)+1}),children:"Next"})]})]})]})}),t.jsx(_ue,{open:n,onOpenChange:k=>{s(k),k||l(void 0)},asset:i})]})]})}const Nue={active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",retired:"bg-red-100 text-red-800",under_maintenance:"bg-yellow-100 text-yellow-800"},Sue={open:"bg-blue-100 text-blue-800",assigned:"bg-purple-100 text-purple-800",in_progress:"bg-yellow-100 text-yellow-800",completed:"bg-green-100 text-green-800",cancelled:"bg-gray-100 text-gray-800"};function Pue(){var d,a,f,p;const{id:e}=XO(),r=Number(e),{data:n,isLoading:s,error:i}=ct({queryKey:["asset",r],queryFn:()=>jc.getAsset(r),enabled:!!r&&!isNaN(r)}),{data:l}=ct({queryKey:["asset-maintenance",r],queryFn:()=>jc.getAssetMaintenanceHistory(r),enabled:!!r&&!isNaN(r)});return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(nd,{to:"/cmms/assets",children:t.jsxs(X,{variant:"ghost",size:"sm",children:[t.jsx(pV,{className:"mr-2 h-4 w-4"}),"Back to Assets"]})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:(n==null?void 0:n.name)||"Asset Details"}),t.jsx("p",{className:"text-muted-foreground",children:(n==null?void 0:n.code)||""})]})]}),n&&t.jsx(Ee,{className:Nue[n.status],children:n.status.replace("_"," ")})]}),s&&!n?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading asset details..."})}):i?t.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:t.jsxs("p",{className:"text-lg text-destructive",children:["Error loading asset: ",i.message]})}):n?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs(H,{className:"md:col-span-2",children:[t.jsx(de,{children:t.jsx(he,{children:"Asset Information"})}),t.jsx(Q,{className:"space-y-4",children:t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Asset Code"}),t.jsx("p",{className:"font-medium",children:n.code})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Asset Class"}),t.jsxs("p",{className:"font-medium flex items-center gap-2",children:[t.jsx(Us,{className:"h-4 w-4 text-muted-foreground"}),((d=n.asset_class)==null?void 0:d.name)||"Unknown"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Manufacturer"}),t.jsx("p",{className:"font-medium",children:n.manufacturer||"-"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Model"}),t.jsx("p",{className:"font-medium",children:n.model||"-"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Serial Number"}),t.jsx("p",{className:"font-medium",children:n.serial||"-"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Installation Date"}),t.jsx("p",{className:"font-medium",children:n.install_date?new Date(n.install_date).toLocaleDateString():"-"})]}),n.scheme&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Scheme"}),t.jsx("p",{className:"font-medium",children:n.scheme.name})]}),n.dma&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"DMA"}),t.jsx("p",{className:"font-medium",children:n.dma.name})]}),n.geom&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Location"}),t.jsxs("p",{className:"font-medium flex items-center gap-2",children:[t.jsx(Ma,{className:"h-4 w-4 text-muted-foreground"}),n.geom.coordinates[1].toFixed(6),", ",n.geom.coordinates[0].toFixed(6)]})]})]})})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Quick Stats"})}),t.jsxs(Q,{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Xs,{className:"h-4 w-4 text-muted-foreground"}),t.jsx("span",{className:"text-sm",children:"Open Work Orders"})]}),t.jsx(Ee,{variant:"outline",children:((a=n.work_orders)==null?void 0:a.filter(y=>y.status!=="completed"&&y.status!=="cancelled").length)||0})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Fs,{className:"h-4 w-4 text-muted-foreground"}),t.jsx("span",{className:"text-sm",children:"Completed WOs"})]}),t.jsx(Ee,{variant:"outline",children:((f=n.work_orders)==null?void 0:f.filter(y=>y.status==="completed").length)||0})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ps,{className:"h-4 w-4 text-muted-foreground"}),t.jsx("span",{className:"text-sm",children:"Total WOs"})]}),t.jsx(Ee,{variant:"outline",children:((p=n.work_orders)==null?void 0:p.length)||0})]})]})]}),n.parent&&t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Parent Asset"})}),t.jsx(Q,{children:t.jsx(nd,{to:`/cmms/assets/${n.parent.id}`,children:t.jsxs("div",{className:"text-sm",children:[t.jsx("p",{className:"font-medium",children:n.parent.name}),t.jsx("p",{className:"text-muted-foreground",children:n.parent.code})]})})})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Work Orders"})}),t.jsx(Q,{children:n.work_orders&&n.work_orders.length>0?t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"WO #"}),t.jsx(ce,{children:"Title"}),t.jsx(ce,{children:"Type"}),t.jsx(ce,{children:"Priority"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Scheduled"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:n.work_orders.map(y=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:y.wo_num}),t.jsx(se,{children:y.title}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",className:"uppercase",children:y.kind})}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",className:"capitalize",children:y.priority})}),t.jsx(se,{children:t.jsx(Ee,{className:Sue[y.status],children:y.status.replace("_"," ")})}),t.jsx(se,{className:"text-muted-foreground",children:y.scheduled_for?new Date(y.scheduled_for).toLocaleDateString():"-"}),t.jsx(se,{children:t.jsx(nd,{to:`/cmms/work-orders/${y.id}`,children:t.jsx(X,{variant:"ghost",size:"sm",children:"View"})})})]},y.id))})]}):t.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No work orders found for this asset"})})]}),l&&l.length>0&&t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Maintenance History"})}),t.jsx(Q,{children:t.jsx("div",{className:"space-y-4",children:l.map(y=>t.jsxs("div",{className:"border-l-2 border-gray-200 pl-4 pb-4",children:[t.jsx("p",{className:"font-medium",children:y.description||y.title}),t.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(y.completed_at||y.created_at).toLocaleDateString()}),y.notes&&t.jsx("p",{className:"text-sm mt-2",children:y.notes})]},y.id))})})]})]}):t.jsx("div",{className:"p-6 bg-yellow-100 border border-yellow-600 rounded-lg",children:t.jsx("p",{className:"text-lg text-yellow-800",children:"Asset not found"})})]})}function Cue({open:e,onOpenChange:r,workOrder:n}){var k;const s=Sr(),i=!!n,{register:l,handleSubmit:d,reset:a,setValue:f,formState:{errors:p}}=yi({defaultValues:n?{kind:n.kind,asset_id:n.asset_id||void 0,title:n.title,description:n.description||void 0,priority:n.priority,scheduled_for:n.scheduled_for||void 0,assigned_to:n.assigned_to||void 0,pm_policy_id:n.pm_policy_id||void 0}:{kind:"cm",priority:"medium"}}),{data:y}=ct({queryKey:["assets-for-wo"],queryFn:()=>jc.getAssets({per_page:200})}),v=Nt({mutationFn:S=>pg.createWorkOrder(S),onSuccess:()=>{s.invalidateQueries({queryKey:["work-orders"]}),Ge.success("Work order created successfully"),r(!1),a()},onError:S=>{var R,D;Ge.error(((D=(R=S.response)==null?void 0:R.data)==null?void 0:D.message)||"Failed to create work order")}}),j=Nt({mutationFn:S=>pg.updateWorkOrder(n.id,S),onSuccess:()=>{s.invalidateQueries({queryKey:["work-orders"]}),s.invalidateQueries({queryKey:["work-order",n.id]}),Ge.success("Work order updated successfully"),r(!1)},onError:S=>{var R,D;Ge.error(((D=(R=S.response)==null?void 0:R.data)==null?void 0:D.message)||"Failed to update work order")}}),w=S=>{i?j.mutate(S):v.mutate(S)};return O.useEffect(()=>{n?Object.keys(n).forEach(S=>{f(S,n[S])}):a({kind:"cm",priority:"medium"})},[n,f,a]),t.jsx(Or,{open:e,onOpenChange:r,children:t.jsxs(kr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:i?"Edit Work Order":"Create New Work Order"}),t.jsx(Pi,{children:i?"Update work order details":"Schedule a new maintenance task"})]}),t.jsxs("form",{onSubmit:d(w),className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"kind",children:"Type *"}),t.jsxs($t,{onValueChange:S=>f("kind",S),defaultValue:(n==null?void 0:n.kind)||"cm",children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"pm",children:"Preventive Maintenance"}),t.jsx(Ne,{value:"cm",children:"Corrective Maintenance"}),t.jsx(Ne,{value:"emergency",children:"Emergency"}),t.jsx(Ne,{value:"project",children:"Project"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"priority",children:"Priority *"}),t.jsxs($t,{onValueChange:S=>f("priority",S),defaultValue:(n==null?void 0:n.priority)||"medium",children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"low",children:"Low"}),t.jsx(Ne,{value:"medium",children:"Medium"}),t.jsx(Ne,{value:"high",children:"High"}),t.jsx(Ne,{value:"critical",children:"Critical"})]})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"asset_id",children:"Related Asset"}),t.jsxs($t,{onValueChange:S=>f("asset_id",S&&S!=="none"?Number(S):void 0),defaultValue:((k=n==null?void 0:n.asset_id)==null?void 0:k.toString())||"none",children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select asset (optional)"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"none",children:"None"}),y==null?void 0:y.data.map(S=>t.jsxs(Ne,{value:S.id.toString(),children:[S.code," - ",S.name]},S.id))]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"title",children:"Title *"}),t.jsx(Ve,{id:"title",...l("title",{required:!0}),placeholder:"e.g., Replace pump motor"}),p.title&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"description",children:"Description"}),t.jsx(ts,{id:"description",...l("description"),placeholder:"Detailed description of the work to be done...",rows:4})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"scheduled_for",children:"Scheduled Date"}),t.jsx(Ve,{id:"scheduled_for",type:"datetime-local",...l("scheduled_for")})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"assigned_to",children:"Assign To (User ID)"}),t.jsx(Ve,{id:"assigned_to",...l("assigned_to"),placeholder:"User UUID"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter user ID to assign this work order"})]})]}),t.jsxs(Ji,{children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:v.isPending||j.isPending,children:v.isPending||j.isPending?"Saving...":i?"Update":"Create"})]})]})]})})}const Aue=[{value:"none",label:"All Statuses"},{value:"open",label:"Open"},{value:"assigned",label:"Assigned"},{value:"in_progress",label:"In Progress"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}],kue=[{value:"none",label:"All Types"},{value:"pm",label:"Preventive Maintenance"},{value:"cm",label:"Corrective Maintenance"},{value:"emergency",label:"Emergency"},{value:"project",label:"Project"}],Tue=[{value:"none",label:"All Priorities"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],Eue={open:"bg-blue-100 text-blue-800",assigned:"bg-purple-100 text-purple-800",in_progress:"bg-yellow-100 text-yellow-800",completed:"bg-green-100 text-green-800",cancelled:"bg-gray-100 text-gray-800"},Mue={low:"bg-gray-100 text-gray-800",medium:"bg-blue-100 text-blue-800",high:"bg-orange-100 text-orange-800",critical:"bg-red-100 text-red-800"};function Oue(){const[e,r]=O.useState({per_page:15,page:1}),[n,s]=O.useState(!1),[i,l]=O.useState(),{data:d,isLoading:a,error:f}=ct({queryKey:["work-orders",e],queryFn:()=>pg.getWorkOrders(e)}),p=w=>{r({...e,search:w,page:1})},y=w=>{r({...e,status:w&&w!=="none"?w:void 0,page:1})},v=w=>{r({...e,kind:w&&w!=="none"?w:void 0,page:1})},j=w=>{r({...e,priority:w&&w!=="none"?w:void 0,page:1})};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Work Orders"}),t.jsx("p",{className:"text-muted-foreground",children:"Track maintenance and repair tasks"})]}),t.jsxs(X,{onClick:()=>{l(void 0),s(!0)},children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Create Work Order"]})]}),a&&!d?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading work orders..."})}):f?t.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:t.jsxs("p",{className:"text-lg text-destructive",children:["Error loading work orders: ",f.message]})}):t.jsxs(t.Fragment,{children:[t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsxs("div",{className:"flex gap-4 mb-6 flex-wrap",children:[t.jsx("div",{className:"flex-1 min-w-[200px]",children:t.jsxs("div",{className:"relative",children:[t.jsx(di,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Search by WO number or title...",className:"pl-9",value:e.search||"",onChange:w=>p(w.target.value)})]})}),t.jsxs($t,{value:e.status||"",onValueChange:y,children:[t.jsx(Rt,{className:"w-[160px]",children:t.jsx(Bt,{placeholder:"Status"})}),t.jsx(Lt,{children:Aue.map(w=>t.jsx(Ne,{value:w.value,children:w.label},w.value))})]}),t.jsxs($t,{value:e.kind||"",onValueChange:v,children:[t.jsx(Rt,{className:"w-[160px]",children:t.jsx(Bt,{placeholder:"Type"})}),t.jsx(Lt,{children:kue.map(w=>t.jsx(Ne,{value:w.value,children:w.label},w.value))})]}),t.jsxs($t,{value:e.priority||"",onValueChange:j,children:[t.jsx(Rt,{className:"w-[160px]",children:t.jsx(Bt,{placeholder:"Priority"})}),t.jsx(Lt,{children:Tue.map(w=>t.jsx(Ne,{value:w.value,children:w.label},w.value))})]})]}),t.jsx("div",{className:"border rounded-lg",children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"WO #"}),t.jsx(ce,{children:"Title"}),t.jsx(ce,{children:"Asset"}),t.jsx(ce,{children:"Type"}),t.jsx(ce,{children:"Priority"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Assigned To"}),t.jsx(ce,{children:"Scheduled"}),t.jsx(ce,{className:"text-right",children:"Actions"})]})}),t.jsx(mr,{children:d==null?void 0:d.data.map(w=>{var k,S;return t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:w.wo_num}),t.jsx(se,{children:t.jsx("div",{className:"max-w-[200px] truncate",children:w.title})}),t.jsx(se,{className:"text-muted-foreground",children:((k=w.asset)==null?void 0:k.name)||"-"}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",className:"uppercase",children:w.kind})}),t.jsx(se,{children:t.jsx(Ee,{className:Mue[w.priority],children:w.priority})}),t.jsx(se,{children:t.jsx(Ee,{className:Eue[w.status],children:w.status.replace("_"," ")})}),t.jsx(se,{className:"text-muted-foreground",children:((S=w.assigned_to_user)==null?void 0:S.name)||"Unassigned"}),t.jsx(se,{className:"text-muted-foreground",children:w.scheduled_for?new Date(w.scheduled_for).toLocaleDateString():"-"}),t.jsx(se,{className:"text-right",children:t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(nd,{to:`/cmms/work-orders/${w.id}`,children:t.jsx(X,{variant:"ghost",size:"sm",children:"View"})}),t.jsx(X,{variant:"ghost",size:"sm",onClick:()=>{l(w),s(!0)},children:t.jsx(Dl,{className:"h-4 w-4"})})]})})]},w.id)})})]})}),(d==null?void 0:d.data.length)===0&&t.jsxs("div",{className:"flex flex-col items-center justify-center p-12",children:[t.jsx(ps,{className:"h-12 w-12 text-muted-foreground mb-4"}),t.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No work orders found"}),t.jsxs(X,{onClick:()=>{l(void 0),s(!0)},children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Create Your First Work Order"]})]}),d&&d.total>0&&t.jsxs("div",{className:"flex items-center justify-between mt-4",children:[t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",d.from," to ",d.to," of ",d.total," work orders"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{variant:"outline",size:"sm",disabled:d.current_page===1,onClick:()=>r({...e,page:(e.page||1)-1}),children:"Previous"}),t.jsx(X,{variant:"outline",size:"sm",disabled:d.current_page===d.last_page,onClick:()=>r({...e,page:(e.page||1)+1}),children:"Next"})]})]})]})}),t.jsx(Cue,{open:n,onOpenChange:w=>{s(w),w||l(void 0)},workOrder:i})]})]})}function Iue({open:e,onOpenChange:r,part:n}){const s=Sr(),i=!!n,{register:l,handleSubmit:d,reset:a,formState:{errors:f}}=yi({defaultValues:n?{code:n.code,name:n.name,category:n.category,description:n.description||void 0,unit:n.unit,unit_cost:n.unit_cost||void 0,reorder_level:n.reorder_level||void 0,supplier_id:n.supplier_id||void 0}:{}}),p=Nt({mutationFn:j=>IN.createPart(j),onSuccess:()=>{s.invalidateQueries({queryKey:["parts"]}),Ge.success("Part created successfully"),r(!1),a()},onError:j=>{var w,k;Ge.error(((k=(w=j.response)==null?void 0:w.data)==null?void 0:k.message)||"Failed to create part")}}),y=Nt({mutationFn:j=>IN.updatePart(n.id,j),onSuccess:()=>{s.invalidateQueries({queryKey:["parts"]}),s.invalidateQueries({queryKey:["part",n.id]}),Ge.success("Part updated successfully"),r(!1)},onError:j=>{var w,k;Ge.error(((k=(w=j.response)==null?void 0:w.data)==null?void 0:k.message)||"Failed to update part")}}),v=j=>{i?y.mutate(j):p.mutate(j)};return O.useEffect(()=>{a(n?{code:n.code,name:n.name,category:n.category,description:n.description||void 0,unit:n.unit,unit_cost:n.unit_cost||void 0,reorder_level:n.reorder_level||void 0,supplier_id:n.supplier_id||void 0}:{})},[n,a]),t.jsx(Or,{open:e,onOpenChange:r,children:t.jsxs(kr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:i?"Edit Part":"Create New Part"}),t.jsx(Pi,{children:i?"Update part information":"Add a new part to inventory"})]}),t.jsxs("form",{onSubmit:d(v),className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"code",children:"Part Code *"}),t.jsx(Ve,{id:"code",...l("code",{required:!0}),placeholder:"e.g., PIPE-100MM"}),f.code&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"category",children:"Category *"}),t.jsx(Ve,{id:"category",...l("category",{required:!0}),placeholder:"e.g., Pipes, Fittings, Valves"}),f.category&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"name",children:"Part Name *"}),t.jsx(Ve,{id:"name",...l("name",{required:!0}),placeholder:"e.g., PVC Pipe 100mm x 6m"}),f.name&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"description",children:"Description"}),t.jsx(ts,{id:"description",...l("description"),placeholder:"Part description and specifications...",rows:3})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"unit",children:"Unit *"}),t.jsx(Ve,{id:"unit",...l("unit",{required:!0}),placeholder:"e.g., pcs, m, kg"}),f.unit&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"unit_cost",children:"Unit Cost"}),t.jsx(Ve,{id:"unit_cost",type:"number",step:"0.01",...l("unit_cost",{valueAsNumber:!0}),placeholder:"0.00"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"reorder_level",children:"Reorder Level"}),t.jsx(Ve,{id:"reorder_level",type:"number",...l("reorder_level",{valueAsNumber:!0}),placeholder:"Minimum stock"})]})]}),t.jsxs(Ji,{children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:p.isPending||y.isPending,children:p.isPending||y.isPending?"Saving...":i?"Update":"Create"})]})]})]})})}function Due(){const[e,r]=O.useState({per_page:15,page:1}),[n,s]=O.useState(!1),[i,l]=O.useState(),{data:d,isLoading:a,error:f}=ct({queryKey:["parts",e],queryFn:()=>IN.getParts(e)}),p=y=>{r({...e,search:y,page:1})};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Parts Inventory"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage spare parts and supplies"})]}),t.jsxs(X,{onClick:()=>{l(void 0),s(!0)},children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Add Part"]})]}),a&&!d?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading parts..."})}):f?t.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:t.jsxs("p",{className:"text-lg text-destructive",children:["Error loading parts: ",f.message]})}):t.jsxs(t.Fragment,{children:[t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("div",{className:"flex gap-4 mb-6",children:t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"relative",children:[t.jsx(di,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Search by code, name, or category...",className:"pl-9",value:e.search||"",onChange:y=>p(y.target.value)})]})})}),t.jsx("div",{className:"border rounded-lg",children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Code"}),t.jsx(ce,{children:"Name"}),t.jsx(ce,{children:"Category"}),t.jsx(ce,{children:"Unit"}),t.jsx(ce,{children:"Unit Cost"}),t.jsx(ce,{children:"Stock Level"}),t.jsx(ce,{children:"Reorder Level"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{className:"text-right",children:"Actions"})]})}),t.jsx(mr,{children:d==null?void 0:d.data.map(y=>{const v=y.stock_balance||0,j=y.reorder_level||0,w=v<=j;return t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:y.code}),t.jsx(se,{children:y.name}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",className:"capitalize",children:y.category})}),t.jsx(se,{className:"text-muted-foreground",children:y.unit}),t.jsx(se,{className:"text-muted-foreground",children:y.unit_cost?`$${y.unit_cost.toFixed(2)}`:"-"}),t.jsx(se,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[w&&v>0&&t.jsx(an,{className:"h-4 w-4 text-orange-500"}),t.jsx("span",{className:w?"text-orange-500 font-medium":"",children:v})]})}),t.jsx(se,{className:"text-muted-foreground",children:j||"-"}),t.jsx(se,{children:v===0?t.jsx(Ee,{className:"bg-red-100 text-red-800",children:"Out of Stock"}):w?t.jsx(Ee,{className:"bg-orange-100 text-orange-800",children:"Low Stock"}):t.jsx(Ee,{className:"bg-green-100 text-green-800",children:"In Stock"})}),t.jsx(se,{className:"text-right",children:t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{variant:"ghost",size:"sm",children:"View"}),t.jsx(X,{variant:"ghost",size:"sm",onClick:()=>{l(y),s(!0)},children:t.jsx(Dl,{className:"h-4 w-4"})})]})})]},y.id)})})]})}),(d==null?void 0:d.data.length)===0&&t.jsxs("div",{className:"flex flex-col items-center justify-center p-12",children:[t.jsx(id,{className:"h-12 w-12 text-muted-foreground mb-4"}),t.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No parts found"}),t.jsxs(X,{onClick:()=>{l(void 0),s(!0)},children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Add Your First Part"]})]}),d&&d.total>0&&t.jsxs("div",{className:"flex items-center justify-between mt-4",children:[t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",d.from," to ",d.to," of ",d.total," parts"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{variant:"outline",size:"sm",disabled:d.current_page===1,onClick:()=>r({...e,page:(e.page||1)-1}),children:"Previous"}),t.jsx(X,{variant:"outline",size:"sm",disabled:d.current_page===d.last_page,onClick:()=>r({...e,page:(e.page||1)+1}),children:"Next"})]})]})]})}),t.jsx(Iue,{open:n,onOpenChange:y=>{s(y),y||l(void 0)},part:i})]})]})}var qW={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.11.0/LICENSE.txt
 */(function(e,r){(function(n,s){e.exports=s()})(U0,function(){var n={},s={};function i(d,a,f){if(s[d]=f,d==="index"){var p="var sharedModule = {}; ("+s.shared+")(sharedModule); ("+s.worker+")(sharedModule);",y={};return s.shared(y),s.index(n,y),typeof window<"u"&&n.setWorkerUrl(window.URL.createObjectURL(new Blob([p],{type:"text/javascript"}))),n}}i("shared",["exports"],function(d){function a(h,c,u,x){return new(u||(u=Promise))(function(_,C){function A(q){try{F(x.next(q))}catch(V){C(V)}}function M(q){try{F(x.throw(q))}catch(V){C(V)}}function F(q){var V;q.done?_(q.value):(V=q.value,V instanceof u?V:new u(function(K){K(V)})).then(A,M)}F((x=x.apply(h,c||[])).next())})}function f(h,c){this.x=h,this.y=c}function p(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var y,v;typeof SuppressedError=="function"&&SuppressedError,f.prototype={clone(){return new f(this.x,this.y)},add(h){return this.clone()._add(h)},sub(h){return this.clone()._sub(h)},multByPoint(h){return this.clone()._multByPoint(h)},divByPoint(h){return this.clone()._divByPoint(h)},mult(h){return this.clone()._mult(h)},div(h){return this.clone()._div(h)},rotate(h){return this.clone()._rotate(h)},rotateAround(h,c){return this.clone()._rotateAround(h,c)},matMult(h){return this.clone()._matMult(h)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(h){return this.x===h.x&&this.y===h.y},dist(h){return Math.sqrt(this.distSqr(h))},distSqr(h){const c=h.x-this.x,u=h.y-this.y;return c*c+u*u},angle(){return Math.atan2(this.y,this.x)},angleTo(h){return Math.atan2(this.y-h.y,this.x-h.x)},angleWith(h){return this.angleWithSep(h.x,h.y)},angleWithSep(h,c){return Math.atan2(this.x*c-this.y*h,this.x*h+this.y*c)},_matMult(h){const c=h[2]*this.x+h[3]*this.y;return this.x=h[0]*this.x+h[1]*this.y,this.y=c,this},_add(h){return this.x+=h.x,this.y+=h.y,this},_sub(h){return this.x-=h.x,this.y-=h.y,this},_mult(h){return this.x*=h,this.y*=h,this},_div(h){return this.x/=h,this.y/=h,this},_multByPoint(h){return this.x*=h.x,this.y*=h.y,this},_divByPoint(h){return this.x/=h.x,this.y/=h.y,this},_unit(){return this._div(this.mag()),this},_perp(){const h=this.y;return this.y=this.x,this.x=-h,this},_rotate(h){const c=Math.cos(h),u=Math.sin(h),x=u*this.x+c*this.y;return this.x=c*this.x-u*this.y,this.y=x,this},_rotateAround(h,c){const u=Math.cos(h),x=Math.sin(h),_=c.y+x*(this.x-c.x)+u*(this.y-c.y);return this.x=c.x+u*(this.x-c.x)-x*(this.y-c.y),this.y=_,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:f},f.convert=function(h){if(h instanceof f)return h;if(Array.isArray(h))return new f(+h[0],+h[1]);if(h.x!==void 0&&h.y!==void 0)return new f(+h.x,+h.y);throw new Error("Expected [x, y] or {x, y} point format")};var j=function(){if(v)return y;function h(c,u,x,_){this.cx=3*c,this.bx=3*(x-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(_-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=u,this.p2x=x,this.p2y=_}return v=1,y=h,h.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,u){if(u===void 0&&(u=1e-6),c<0)return 0;if(c>1)return 1;for(var x=c,_=0;_<8;_++){var C=this.sampleCurveX(x)-c;if(Math.abs(C)<u)return x;var A=this.sampleCurveDerivativeX(x);if(Math.abs(A)<1e-6)break;x-=C/A}var M=0,F=1;for(x=c,_=0;_<20&&(C=this.sampleCurveX(x),!(Math.abs(C-c)<u));_++)c>C?M=x:F=x,x=.5*(F-M)+M;return x},solve:function(c,u){return this.sampleCurveY(this.solveCurveX(c,u))}},y}(),w=p(j);let k,S;function R(){return k==null&&(k=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),k}function D(){if(S==null&&(S=!1,R())){const c=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(c){for(let x=0;x<5*5;x++){const _=4*x;c.fillStyle=`rgb(${_},${_+1},${_+2})`,c.fillRect(x%5,Math.floor(x/5),1,1)}const u=c.getImageData(0,0,5,5).data;for(let x=0;x<5*5*4;x++)if(x%4!=3&&u[x]!==x){S=!0;break}}}return S||!1}var T=1e-6,I=typeof Float32Array<"u"?Float32Array:Array;function L(){var h=new I(9);return I!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h}function $(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h}function W(){var h=new I(3);return I!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),h}function Z(h){var c=h[0],u=h[1],x=h[2];return Math.sqrt(c*c+u*u+x*x)}function oe(h,c,u){var x=new I(3);return x[0]=h,x[1]=c,x[2]=u,x}function te(h,c,u){return h[0]=c[0]+u[0],h[1]=c[1]+u[1],h[2]=c[2]+u[2],h}function be(h,c,u){return h[0]=c[0]*u,h[1]=c[1]*u,h[2]=c[2]*u,h}function ie(h,c,u){var x=c[0],_=c[1],C=c[2],A=u[0],M=u[1],F=u[2];return h[0]=_*F-C*M,h[1]=C*A-x*F,h[2]=x*M-_*A,h}var ge,Ie=Z;function Oe(h,c,u){var x=c[0],_=c[1],C=c[2],A=c[3];return h[0]=u[0]*x+u[4]*_+u[8]*C+u[12]*A,h[1]=u[1]*x+u[5]*_+u[9]*C+u[13]*A,h[2]=u[2]*x+u[6]*_+u[10]*C+u[14]*A,h[3]=u[3]*x+u[7]*_+u[11]*C+u[15]*A,h}function Xe(){var h=new I(4);return I!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),h[3]=1,h}function Ue(h,c,u,x){var _=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",C=Math.PI/360;c*=C,x*=C,u*=C;var A=Math.sin(c),M=Math.cos(c),F=Math.sin(u),q=Math.cos(u),V=Math.sin(x),K=Math.cos(x);switch(_){case"xyz":h[0]=A*q*K+M*F*V,h[1]=M*F*K-A*q*V,h[2]=M*q*V+A*F*K,h[3]=M*q*K-A*F*V;break;case"xzy":h[0]=A*q*K-M*F*V,h[1]=M*F*K-A*q*V,h[2]=M*q*V+A*F*K,h[3]=M*q*K+A*F*V;break;case"yxz":h[0]=A*q*K+M*F*V,h[1]=M*F*K-A*q*V,h[2]=M*q*V-A*F*K,h[3]=M*q*K+A*F*V;break;case"yzx":h[0]=A*q*K+M*F*V,h[1]=M*F*K+A*q*V,h[2]=M*q*V-A*F*K,h[3]=M*q*K-A*F*V;break;case"zxy":h[0]=A*q*K-M*F*V,h[1]=M*F*K+A*q*V,h[2]=M*q*V+A*F*K,h[3]=M*q*K-A*F*V;break;case"zyx":h[0]=A*q*K-M*F*V,h[1]=M*F*K+A*q*V,h[2]=M*q*V-A*F*K,h[3]=M*q*K+A*F*V;break;default:throw new Error("Unknown angle order "+_)}return h}function tt(){var h=new I(2);return I!=Float32Array&&(h[0]=0,h[1]=0),h}function Ce(h,c){var u=new I(2);return u[0]=h,u[1]=c,u}W(),ge=new I(4),I!=Float32Array&&(ge[0]=0,ge[1]=0,ge[2]=0,ge[3]=0),W(),oe(1,0,0),oe(0,1,0),Xe(),Xe(),L(),tt();const ve=8192;function rt(h,c,u){return c*(ve/(h.tileSize*Math.pow(2,u-h.tileID.overscaledZ)))}function vt(h,c){return(h%c+c)%c}function gt(h,c,u){return h*(1-u)+c*u}function Et(h){if(h<=0)return 0;if(h>=1)return 1;const c=h*h,u=c*h;return 4*(h<.5?u:3*(h-c)+u-.75)}function tr(h,c,u,x){const _=new w(h,c,u,x);return C=>_.solve(C)}const Dr=tr(.25,.1,.25,1);function Pr(h,c,u){return Math.min(u,Math.max(c,h))}function It(h,c,u){const x=u-c,_=((h-c)%x+x)%x+c;return _===c?u:_}function _r(h,...c){for(const u of c)for(const x in u)h[x]=u[x];return h}let St=1;function Qt(h,c,u){const x={};for(const _ in h)x[_]=c.call(this,h[_],_,h);return x}function rr(h,c,u){const x={};for(const _ in h)c.call(this,h[_],_,h)&&(x[_]=h[_]);return x}function pt(h){return Array.isArray(h)?h.map(pt):typeof h=="object"&&h?Qt(h,pt):h}const qr={};function or(h){qr[h]||(typeof console<"u"&&console.warn(h),qr[h]=!0)}function en(h,c,u){return(u.y-h.y)*(c.x-h.x)>(c.y-h.y)*(u.x-h.x)}function Lr(h){return typeof WorkerGlobalScope<"u"&&h!==void 0&&h instanceof WorkerGlobalScope}let En=null;function ks(h){if(En==null){const c=h.navigator?h.navigator.userAgent:null;En=!!h.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return En}function Yn(h){return typeof ImageBitmap<"u"&&h instanceof ImageBitmap}const qe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function nt(h,c,u,x,_){return a(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const C=new VideoFrame(h,{timestamp:0});try{const A=C==null?void 0:C.format;if(!A||!A.startsWith("BGR")&&!A.startsWith("RGB"))throw new Error(`Unrecognized format ${A}`);const M=A.startsWith("BGR"),F=new Uint8ClampedArray(x*_*4);if(yield C.copyTo(F,function(q,V,K,ee,re){const ae=4*Math.max(-V,0),pe=(Math.max(0,K)-K)*ee*4+ae,_e=4*ee,Pe=Math.max(0,V),Qe=Math.max(0,K);return{rect:{x:Pe,y:Qe,width:Math.min(q.width,V+ee)-Pe,height:Math.min(q.height,K+re)-Qe},layout:[{offset:pe,stride:_e}]}}(h,c,u,x,_)),M)for(let q=0;q<F.length;q+=4){const V=F[q];F[q]=F[q+2],F[q+2]=V}return F}finally{C.close()}})}let xt,Ut;function Vt(h,c,u,x){return h.addEventListener(c,u,x),{unsubscribe:()=>{h.removeEventListener(c,u,x)}}}function Ft(h){return h*Math.PI/180}function sr(h){return h/Math.PI*180}const tn={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Pn={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},zs="AbortError";function We(){return new Error(zs)}const le={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ue(h){return le.REGISTERED_PROTOCOLS[h.substring(0,h.indexOf("://"))]}const ye="global-dispatcher";class Ae extends Error{constructor(c,u,x,_){super(`AJAXError: ${u} (${c}): ${x}`),this.status=c,this.statusText=u,this.url=x,this.body=_}}const ze=()=>Lr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ye=function(h,c){if(/:\/\//.test(h.url)&&!/^https?:|^file:/.test(h.url)){const x=ue(h.url);if(x)return x(h,c);if(Lr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:h,targetMapId:ye},c)}if(!(/^file:/.test(u=h.url)||/^file:/.test(ze())&&!/^\w+:/.test(u))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(x,_){return a(this,void 0,void 0,function*(){const C=new Request(x.url,{method:x.method||"GET",body:x.body,credentials:x.credentials,headers:x.headers,cache:x.cache,referrer:ze(),signal:_.signal});let A,M;x.type!=="json"||C.headers.has("Accept")||C.headers.set("Accept","application/json");try{A=yield fetch(C)}catch(q){throw new Ae(0,q.message,x.url,new Blob)}if(!A.ok){const q=yield A.blob();throw new Ae(A.status,A.statusText,x.url,q)}M=x.type==="arrayBuffer"||x.type==="image"?A.arrayBuffer():x.type==="json"?A.json():A.text();const F=yield M;if(_.signal.aborted)throw We();return{data:F,cacheControl:A.headers.get("Cache-Control"),expires:A.headers.get("Expires")}})}(h,c);if(Lr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:h,mustQueue:!0,targetMapId:ye},c)}var u;return function(x,_){return new Promise((C,A)=>{var M;const F=new XMLHttpRequest;F.open(x.method||"GET",x.url,!0),x.type!=="arrayBuffer"&&x.type!=="image"||(F.responseType="arraybuffer");for(const q in x.headers)F.setRequestHeader(q,x.headers[q]);x.type==="json"&&(F.responseType="text",!((M=x.headers)===null||M===void 0)&&M.Accept||F.setRequestHeader("Accept","application/json")),F.withCredentials=x.credentials==="include",F.onerror=()=>{A(new Error(F.statusText))},F.onload=()=>{if(!_.signal.aborted)if((F.status>=200&&F.status<300||F.status===0)&&F.response!==null){let q=F.response;if(x.type==="json")try{q=JSON.parse(F.response)}catch(V){return void A(V)}C({data:q,cacheControl:F.getResponseHeader("Cache-Control"),expires:F.getResponseHeader("Expires")})}else{const q=new Blob([F.response],{type:F.getResponseHeader("Content-Type")});A(new Ae(F.status,F.statusText,x.url,q))}},_.signal.addEventListener("abort",()=>{F.abort(),A(We())}),F.send(x.body)})}(h,c)};function st(h){if(!h||h.indexOf("://")<=0||h.indexOf("data:image/")===0||h.indexOf("blob:")===0)return!0;const c=new URL(h),u=window.location;return c.protocol===u.protocol&&c.host===u.host}function He(h,c,u){u[h]&&u[h].indexOf(c)!==-1||(u[h]=u[h]||[],u[h].push(c))}function dt(h,c,u){if(u&&u[h]){const x=u[h].indexOf(c);x!==-1&&u[h].splice(x,1)}}class Pt{constructor(c,u={}){_r(this,u),this.type=c}}class yt extends Pt{constructor(c,u={}){super("error",_r({error:c},u))}}class lr{on(c,u){return this._listeners=this._listeners||{},He(c,u,this._listeners),{unsubscribe:()=>{this.off(c,u)}}}off(c,u){return dt(c,u,this._listeners),dt(c,u,this._oneTimeListeners),this}once(c,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},He(c,u,this._oneTimeListeners),this):new Promise(x=>this.once(c,x))}fire(c,u){typeof c=="string"&&(c=new Pt(c,u||{}));const x=c.type;if(this.listens(x)){c.target=this;const _=this._listeners&&this._listeners[x]?this._listeners[x].slice():[];for(const M of _)M.call(this,c);const C=this._oneTimeListeners&&this._oneTimeListeners[x]?this._oneTimeListeners[x].slice():[];for(const M of C)dt(x,M,this._oneTimeListeners),M.call(this,c);const A=this._eventedParent;A&&(_r(c,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),A.fire(c))}else c instanceof yt&&console.error(c.error);return this}listens(c){return this._listeners&&this._listeners[c]&&this._listeners[c].length>0||this._oneTimeListeners&&this._oneTimeListeners[c]&&this._oneTimeListeners[c].length>0||this._eventedParent&&this._eventedParent.listens(c)}setEventedParent(c,u){return this._eventedParent=c,this._eventedParentData=u,this}}var Je={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Qr=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function fr(h,c){const u={};for(const x in h)x!=="ref"&&(u[x]=h[x]);return Qr.forEach(x=>{x in c&&(u[x]=c[x])}),u}function Gt(h,c){if(Array.isArray(h)){if(!Array.isArray(c)||h.length!==c.length)return!1;for(let u=0;u<h.length;u++)if(!Gt(h[u],c[u]))return!1;return!0}if(typeof h=="object"&&h!==null&&c!==null){if(typeof c!="object"||Object.keys(h).length!==Object.keys(c).length)return!1;for(const u in h)if(!Gt(h[u],c[u]))return!1;return!0}return h===c}function yr(h,c){h.push(c)}function cn(h,c,u){yr(u,{command:"addSource",args:[h,c[h]]})}function Cn(h,c,u){yr(c,{command:"removeSource",args:[h]}),u[h]=!0}function Xn(h,c,u,x){Cn(h,u,x),cn(h,c,u)}function Mn(h,c,u){let x;for(x in h[u])if(Object.prototype.hasOwnProperty.call(h[u],x)&&x!=="data"&&!Gt(h[u][x],c[u][x]))return!1;for(x in c[u])if(Object.prototype.hasOwnProperty.call(c[u],x)&&x!=="data"&&!Gt(h[u][x],c[u][x]))return!1;return!0}function On(h,c,u,x,_,C){h=h||{},c=c||{};for(const A in h)Object.prototype.hasOwnProperty.call(h,A)&&(Gt(h[A],c[A])||u.push({command:C,args:[x,A,c[A],_]}));for(const A in c)Object.prototype.hasOwnProperty.call(c,A)&&!Object.prototype.hasOwnProperty.call(h,A)&&(Gt(h[A],c[A])||u.push({command:C,args:[x,A,c[A],_]}))}function An(h){return h.id}function vi(h,c){return h[c.id]=c,h}class jt{constructor(c,u,x,_){this.message=(c?`${c}: `:"")+x,_&&(this.identifier=_),u!=null&&u.__line__&&(this.line=u.__line__)}}function $s(h,...c){for(const u of c)for(const x in u)h[x]=u[x];return h}class ya extends Error{constructor(c,u){super(u),this.message=u,this.key=c}}class zu{constructor(c,u=[]){this.parent=c,this.bindings={};for(const[x,_]of u)this.bindings[x]=_}concat(c){return new zu(this,c)}get(c){if(this.bindings[c])return this.bindings[c];if(this.parent)return this.parent.get(c);throw new Error(`${c} not found in scope.`)}has(c){return!!this.bindings[c]||!!this.parent&&this.parent.has(c)}}const qi={kind:"null"},qt={kind:"number"},Kr={kind:"string"},rn={kind:"boolean"},Lo={kind:"color"},km={kind:"projectionDefinition"},Oc={kind:"object"},Xr={kind:"value"},Tm={kind:"collator"},bd={kind:"formatted"},hl={kind:"padding"},Ic={kind:"colorArray"},Em={kind:"numberArray"},jd={kind:"resolvedImage"},jp={kind:"variableAnchorOffsetCollection"};function na(h,c){return{kind:"array",itemType:h,N:c}}function gs(h){if(h.kind==="array"){const c=gs(h.itemType);return typeof h.N=="number"?`array<${c}, ${h.N}>`:h.itemType.kind==="value"?"array":`array<${c}>`}return h.kind}const $u=[qi,qt,Kr,rn,Lo,km,bd,Oc,na(Xr),hl,Em,Ic,jd,jp];function wd(h,c){if(c.kind==="error")return null;if(h.kind==="array"){if(c.kind==="array"&&(c.N===0&&c.itemType.kind==="value"||!wd(h.itemType,c.itemType))&&(typeof h.N!="number"||h.N===c.N))return null}else{if(h.kind===c.kind)return null;if(h.kind==="value"){for(const u of $u)if(!wd(u,c))return null}}return`Expected ${gs(h)} but found ${gs(c)} instead.`}function ui(h,c){return c.some(u=>u.kind===h.kind)}function Nd(h,c){return c.some(u=>u==="null"?h===null:u==="array"?Array.isArray(h):u==="object"?h&&!Array.isArray(h)&&typeof h=="object":u===typeof h)}function Ul(h,c){return h.kind==="array"&&c.kind==="array"?h.itemType.kind===c.itemType.kind&&typeof h.N=="number":h.kind===c.kind}const Bu=.96422,av=.82521,hj=4/29,qu=6/29,ov=3*qu*qu,BP=qu*qu*qu,mj=Math.PI/180,qP=180/Math.PI;function fj(h){return(h%=360)<0&&(h+=360),h}function pj([h,c,u,x]){let _,C;const A=cv((.2225045*(h=lv(h))+.7168786*(c=lv(c))+.0606169*(u=lv(u)))/1);h===c&&c===u?_=C=A:(_=cv((.4360747*h+.3850649*c+.1430804*u)/Bu),C=cv((.0139322*h+.0971045*c+.7141733*u)/av));const M=116*A-16;return[M<0?0:M,500*(_-A),200*(A-C),x]}function lv(h){return h<=.04045?h/12.92:Math.pow((h+.055)/1.055,2.4)}function cv(h){return h>BP?Math.pow(h,1/3):h/ov+hj}function xj([h,c,u,x]){let _=(h+16)/116,C=isNaN(c)?_:_+c/500,A=isNaN(u)?_:_-u/200;return _=1*wp(_),C=Bu*wp(C),A=av*wp(A),[dv(3.1338561*C-1.6168667*_-.4906146*A),dv(-.9787684*C+1.9161415*_+.033454*A),dv(.0719453*C-.2289914*_+1.4052427*A),x]}function dv(h){return(h=h<=.00304?12.92*h:1.055*Math.pow(h,1/2.4)-.055)<0?0:h>1?1:h}function wp(h){return h>qu?h*h*h:ov*(h-hj)}const Mm=Object.hasOwn||function(h,c){return Object.prototype.hasOwnProperty.call(h,c)};function Om(h,c){return Mm(h,c)?h[c]:void 0}function Np(h){return parseInt(h.padEnd(2,h),16)/255}function Vu(h,c){return Uu(c?h/100:h,0,1)}function Uu(h,c,u){return Math.min(Math.max(c,h),u)}function gj(h){return!h.some(Number.isNaN)}const VP={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Wl(h,c,u){return h+u*(c-h)}function Sd(h,c,u){return h.map((x,_)=>Wl(x,c[_],u))}class Ur{constructor(c,u,x,_=1,C=!0){this.r=c,this.g=u,this.b=x,this.a=_,C||(this.r*=_,this.g*=_,this.b*=_,_||this.overwriteGetter("rgb",[c,u,x,_]))}static parse(c){if(c instanceof Ur)return c;if(typeof c!="string")return;const u=function(x){if((x=x.toLowerCase().trim())==="transparent")return[0,0,0,0];const _=Om(VP,x);if(_){const[A,M,F]=_;return[A/255,M/255,F/255,1]}if(x.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(x)){const A=x.length<6?1:2;let M=1;return[Np(x.slice(M,M+=A)),Np(x.slice(M,M+=A)),Np(x.slice(M,M+=A)),Np(x.slice(M,M+A)||"ff")]}if(x.startsWith("rgb")){const A=x.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(A){const[M,F,q,V,K,ee,re,ae,pe,_e,Pe,Qe]=A,Re=[V||" ",re||" ",_e].join("");if(Re==="  "||Re==="  /"||Re===",,"||Re===",,,"){const $e=[q,ee,pe].join(""),at=$e==="%%%"?100:$e===""?255:0;if(at){const ft=[Uu(+F/at,0,1),Uu(+K/at,0,1),Uu(+ae/at,0,1),Pe?Vu(+Pe,Qe):1];if(gj(ft))return ft}}return}}const C=x.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(C){const[A,M,F,q,V,K,ee,re,ae]=C,pe=[F||" ",V||" ",ee].join("");if(pe==="  "||pe==="  /"||pe===",,"||pe===",,,"){const _e=[+M,Uu(+q,0,100),Uu(+K,0,100),re?Vu(+re,ae):1];if(gj(_e))return function([Pe,Qe,Re,$e]){function at(ft){const At=(ft+Pe/30)%12,Yt=Qe*Math.min(Re,1-Re);return Re-Yt*Math.max(-1,Math.min(At-3,9-At,1))}return Pe=fj(Pe),Qe/=100,Re/=100,[at(0),at(8),at(4),$e]}(_e)}}}(c);return u?new Ur(...u,!1):void 0}get rgb(){const{r:c,g:u,b:x,a:_}=this,C=_||1/0;return this.overwriteGetter("rgb",[c/C,u/C,x/C,_])}get hcl(){return this.overwriteGetter("hcl",function(c){const[u,x,_,C]=pj(c),A=Math.sqrt(x*x+_*_);return[Math.round(1e4*A)?fj(Math.atan2(_,x)*qP):NaN,A,u,C]}(this.rgb))}get lab(){return this.overwriteGetter("lab",pj(this.rgb))}overwriteGetter(c,u){return Object.defineProperty(this,c,{value:u}),u}toString(){const[c,u,x,_]=this.rgb;return`rgba(${[c,u,x].map(C=>Math.round(255*C)).join(",")},${_})`}static interpolate(c,u,x,_="rgb"){switch(_){case"rgb":{const[C,A,M,F]=Sd(c.rgb,u.rgb,x);return new Ur(C,A,M,F,!1)}case"hcl":{const[C,A,M,F]=c.hcl,[q,V,K,ee]=u.hcl;let re,ae;if(isNaN(C)||isNaN(q))isNaN(C)?isNaN(q)?re=NaN:(re=q,M!==1&&M!==0||(ae=V)):(re=C,K!==1&&K!==0||(ae=A));else{let Re=q-C;q>C&&Re>180?Re-=360:q<C&&C-q>180&&(Re+=360),re=C+x*Re}const[pe,_e,Pe,Qe]=function([Re,$e,at,ft]){return Re=isNaN(Re)?0:Re*mj,xj([at,Math.cos(Re)*$e,Math.sin(Re)*$e,ft])}([re,ae??Wl(A,V,x),Wl(M,K,x),Wl(F,ee,x)]);return new Ur(pe,_e,Pe,Qe,!1)}case"lab":{const[C,A,M,F]=xj(Sd(c.lab,u.lab,x));return new Ur(C,A,M,F,!1)}}}}Ur.black=new Ur(0,0,0,1),Ur.white=new Ur(1,1,1,1),Ur.transparent=new Ur(0,0,0,0),Ur.red=new Ur(1,0,0,1);class un{constructor(c,u,x){this.sensitivity=c?u?"variant":"case":u?"accent":"base",this.locale=x,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(c,u){return this.collator.compare(c,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Wu=["bottom","center","top"];class ml{constructor(c,u,x,_,C,A){this.text=c,this.image=u,this.scale=x,this.fontStack=_,this.textColor=C,this.verticalAlign=A}}class Da{constructor(c){this.sections=c}static fromString(c){return new Da([new ml(c,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(c=>c.text.length!==0||c.image&&c.image.name.length!==0)}static factory(c){return c instanceof Da?c:Da.fromString(c)}toString(){return this.sections.length===0?"":this.sections.map(c=>c.text).join("")}}class sa{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof sa)return c;if(typeof c=="number")return new sa([c,c,c,c]);if(Array.isArray(c)&&!(c.length<1||c.length>4)){for(const u of c)if(typeof u!="number")return;switch(c.length){case 1:c=[c[0],c[0],c[0],c[0]];break;case 2:c=[c[0],c[1],c[0],c[1]];break;case 3:c=[c[0],c[1],c[2],c[1]]}return new sa(c)}}toString(){return JSON.stringify(this.values)}static interpolate(c,u,x){return new sa(Sd(c.values,u.values,x))}}class Vi{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof Vi)return c;if(typeof c=="number")return new Vi([c]);if(Array.isArray(c)){for(const u of c)if(typeof u!="number")return;return new Vi(c)}}toString(){return JSON.stringify(this.values)}static interpolate(c,u,x){return new Vi(Sd(c.values,u.values,x))}}class Qs{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof Qs)return c;if(typeof c=="string"){const x=Ur.parse(c);return x?new Qs([x]):void 0}if(!Array.isArray(c))return;const u=[];for(const x of c){if(typeof x!="string")return;const _=Ur.parse(x);if(!_)return;u.push(_)}return new Qs(u)}toString(){return JSON.stringify(this.values)}static interpolate(c,u,x,_="rgb"){const C=[];if(c.values.length!=u.values.length)throw new Error(`colorArray: Arrays have mismatched length (${c.values.length} vs. ${u.values.length}), cannot interpolate.`);for(let A=0;A<c.values.length;A++)C.push(Ur.interpolate(c.values[A],u.values[A],x,_));return new Qs(C)}}class ss extends Error{constructor(c){super(c),this.name="RuntimeError"}toJSON(){return this.message}}const yj=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ia{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof ia)return c;if(Array.isArray(c)&&!(c.length<1)&&c.length%2==0){for(let u=0;u<c.length;u+=2){const x=c[u],_=c[u+1];if(typeof x!="string"||!yj.has(x)||!Array.isArray(_)||_.length!==2||typeof _[0]!="number"||typeof _[1]!="number")return}return new ia(c)}}toString(){return JSON.stringify(this.values)}static interpolate(c,u,x){const _=c.values,C=u.values;if(_.length!==C.length)throw new ss(`Cannot interpolate values of different length. from: ${c.toString()}, to: ${u.toString()}`);const A=[];for(let M=0;M<_.length;M+=2){if(_[M]!==C[M])throw new ss(`Cannot interpolate values containing mismatched anchors. from[${M}]: ${_[M]}, to[${M}]: ${C[M]}`);A.push(_[M]);const[F,q]=_[M+1],[V,K]=C[M+1];A.push([Wl(F,V,x),Wl(q,K,x)])}return new ia(A)}}class va{constructor(c){this.name=c.name,this.available=c.available}toString(){return this.name}static fromString(c){return c?new va({name:c,available:!1}):null}}class Ja{constructor(c,u,x){this.from=c,this.to=u,this.transition=x}static interpolate(c,u,x){return new Ja(c,u,x)}static parse(c){return c instanceof Ja?c:Array.isArray(c)&&c.length===3&&typeof c[0]=="string"&&typeof c[1]=="string"&&typeof c[2]=="number"?new Ja(c[0],c[1],c[2]):typeof c=="object"&&typeof c.from=="string"&&typeof c.to=="string"&&typeof c.transition=="number"?new Ja(c.from,c.to,c.transition):typeof c=="string"?new Ja(c,c,1):void 0}}function Im(h,c,u,x){return typeof h=="number"&&h>=0&&h<=255&&typeof c=="number"&&c>=0&&c<=255&&typeof u=="number"&&u>=0&&u<=255?x===void 0||typeof x=="number"&&x>=0&&x<=1?null:`Invalid rgba value [${[h,c,u,x].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof x=="number"?[h,c,u,x]:[h,c,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function fl(h){if(h===null||typeof h=="string"||typeof h=="boolean"||typeof h=="number"||h instanceof Ja||h instanceof Ur||h instanceof un||h instanceof Da||h instanceof sa||h instanceof Vi||h instanceof Qs||h instanceof ia||h instanceof va)return!0;if(Array.isArray(h)){for(const c of h)if(!fl(c))return!1;return!0}if(typeof h=="object"){for(const c in h)if(!fl(h[c]))return!1;return!0}return!1}function Bs(h){if(h===null)return qi;if(typeof h=="string")return Kr;if(typeof h=="boolean")return rn;if(typeof h=="number")return qt;if(h instanceof Ur)return Lo;if(h instanceof Ja)return km;if(h instanceof un)return Tm;if(h instanceof Da)return bd;if(h instanceof sa)return hl;if(h instanceof Vi)return Em;if(h instanceof Qs)return Ic;if(h instanceof ia)return jp;if(h instanceof va)return jd;if(Array.isArray(h)){const c=h.length;let u;for(const x of h){const _=Bs(x);if(u){if(u===_)continue;u=Xr;break}u=_}return na(u||Xr,c)}return Oc}function Gu(h){const c=typeof h;return h===null?"":c==="string"||c==="number"||c==="boolean"?String(h):h instanceof Ur||h instanceof Ja||h instanceof Da||h instanceof sa||h instanceof Vi||h instanceof Qs||h instanceof ia||h instanceof va?h.toString():JSON.stringify(h)}class Dc{constructor(c,u){this.type=c,this.value=u}static parse(c,u){if(c.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${c.length-1} instead.`);if(!fl(c[1]))return u.error("invalid value");const x=c[1];let _=Bs(x);const C=u.expectedType;return _.kind!=="array"||_.N!==0||!C||C.kind!=="array"||typeof C.N=="number"&&C.N!==0||(_=C),new Dc(_,x)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Pd={string:Kr,number:qt,boolean:rn,object:Oc};class jn{constructor(c,u){this.type=c,this.args=u}static parse(c,u){if(c.length<2)return u.error("Expected at least one argument.");let x,_=1;const C=c[0];if(C==="array"){let M,F;if(c.length>2){const q=c[1];if(typeof q!="string"||!(q in Pd)||q==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);M=Pd[q],_++}else M=Xr;if(c.length>3){if(c[2]!==null&&(typeof c[2]!="number"||c[2]<0||c[2]!==Math.floor(c[2])))return u.error('The length argument to "array" must be a positive integer literal',2);F=c[2],_++}x=na(M,F)}else{if(!Pd[C])throw new Error(`Types doesn't contain name = ${C}`);x=Pd[C]}const A=[];for(;_<c.length;_++){const M=u.parse(c[_],_,Xr);if(!M)return null;A.push(M)}return new jn(x,A)}evaluate(c){for(let u=0;u<this.args.length;u++){const x=this.args[u].evaluate(c);if(!wd(this.type,Bs(x)))return x;if(u===this.args.length-1)throw new ss(`Expected value to be of type ${gs(this.type)}, but found ${gs(Bs(x))} instead.`)}throw new Error}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}}const Sp={"to-boolean":rn,"to-color":Lo,"to-number":qt,"to-string":Kr};class nn{constructor(c,u){this.type=c,this.args=u}static parse(c,u){if(c.length<2)return u.error("Expected at least one argument.");const x=c[0];if(!Sp[x])throw new Error(`Can't parse ${x} as it is not part of the known types`);if((x==="to-boolean"||x==="to-string")&&c.length!==2)return u.error("Expected one argument.");const _=Sp[x],C=[];for(let A=1;A<c.length;A++){const M=u.parse(c[A],A,Xr);if(!M)return null;C.push(M)}return new nn(_,C)}evaluate(c){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(c);case"color":{let u,x;for(const _ of this.args){if(u=_.evaluate(c),x=null,u instanceof Ur)return u;if(typeof u=="string"){const C=c.parseColor(u);if(C)return C}else if(Array.isArray(u)&&(x=u.length<3||u.length>4?`Invalid rgba value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:Im(u[0],u[1],u[2],u[3]),!x))return new Ur(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new ss(x||`Could not parse color from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"padding":{let u;for(const x of this.args){u=x.evaluate(c);const _=sa.parse(u);if(_)return _}throw new ss(`Could not parse padding from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"numberArray":{let u;for(const x of this.args){u=x.evaluate(c);const _=Vi.parse(u);if(_)return _}throw new ss(`Could not parse numberArray from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"colorArray":{let u;for(const x of this.args){u=x.evaluate(c);const _=Qs.parse(u);if(_)return _}throw new ss(`Could not parse colorArray from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"variableAnchorOffsetCollection":{let u;for(const x of this.args){u=x.evaluate(c);const _=ia.parse(u);if(_)return _}throw new ss(`Could not parse variableAnchorOffsetCollection from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"number":{let u=null;for(const x of this.args){if(u=x.evaluate(c),u===null)return 0;const _=Number(u);if(!isNaN(_))return _}throw new ss(`Could not convert ${JSON.stringify(u)} to number.`)}case"formatted":return Da.fromString(Gu(this.args[0].evaluate(c)));case"resolvedImage":return va.fromString(Gu(this.args[0].evaluate(c)));case"projectionDefinition":return this.args[0].evaluate(c);default:return Gu(this.args[0].evaluate(c))}}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}}const Jr=["Unknown","Point","LineString","Polygon"];class Pp{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Jr[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(c){let u=this._parseColorCache.get(c);return u||(u=Ur.parse(c),this._parseColorCache.set(c,u)),u}}class vn{constructor(c,u,x=[],_,C=new zu,A=[]){this.registry=c,this.path=x,this.key=x.map(M=>`[${M}]`).join(""),this.scope=C,this.errors=A,this.expectedType=_,this._isConstant=u}parse(c,u,x,_,C={}){return u?this.concat(u,x,_)._parse(c,C):this._parse(c,C)}_parse(c,u){function x(_,C,A){return A==="assert"?new jn(C,[_]):A==="coerce"?new nn(C,[_]):_}if(c!==null&&typeof c!="string"&&typeof c!="boolean"&&typeof c!="number"||(c=["literal",c]),Array.isArray(c)){if(c.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _=c[0];if(typeof _!="string")return this.error(`Expression name must be a string, but found ${typeof _} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const C=this.registry[_];if(C){let A=C.parse(c,this);if(!A)return null;if(this.expectedType){const M=this.expectedType,F=A.type;if(M.kind!=="string"&&M.kind!=="number"&&M.kind!=="boolean"&&M.kind!=="object"&&M.kind!=="array"||F.kind!=="value"){if(M.kind==="projectionDefinition"&&["string","array"].includes(F.kind)||["color","formatted","resolvedImage"].includes(M.kind)&&["value","string"].includes(F.kind)||["padding","numberArray"].includes(M.kind)&&["value","number","array"].includes(F.kind)||M.kind==="colorArray"&&["value","string","array"].includes(F.kind)||M.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(F.kind))A=x(A,M,u.typeAnnotation||"coerce");else if(this.checkSubtype(M,F))return null}else A=x(A,M,u.typeAnnotation||"assert")}if(!(A instanceof Dc)&&A.type.kind!=="resolvedImage"&&this._isConstant(A)){const M=new Pp;try{A=new Dc(A.type,A.evaluate(M))}catch(F){return this.error(F.message),null}}return A}return this.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(c===void 0?"'undefined' value invalid. Use null instead.":typeof c=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof c} instead.`)}concat(c,u,x){const _=typeof c=="number"?this.path.concat(c):this.path,C=x?this.scope.concat(x):this.scope;return new vn(this.registry,this._isConstant,_,u||null,C,this.errors)}error(c,...u){const x=`${this.key}${u.map(_=>`[${_}]`).join("")}`;this.errors.push(new ya(x,c))}checkSubtype(c,u){const x=wd(c,u);return x&&this.error(x),x}}class Ku{constructor(c,u){this.type=u.type,this.bindings=[].concat(c),this.result=u}evaluate(c){return this.result.evaluate(c)}eachChild(c){for(const u of this.bindings)c(u[1]);c(this.result)}static parse(c,u){if(c.length<4)return u.error(`Expected at least 3 arguments, but found ${c.length-1} instead.`);const x=[];for(let C=1;C<c.length-1;C+=2){const A=c[C];if(typeof A!="string")return u.error(`Expected string, but found ${typeof A} instead.`,C);if(/[^a-zA-Z0-9_]/.test(A))return u.error("Variable names must contain only alphanumeric characters or '_'.",C);const M=u.parse(c[C+1],C+1);if(!M)return null;x.push([A,M])}const _=u.parse(c[c.length-1],c.length-1,u.expectedType,x);return _?new Ku(x,_):null}outputDefined(){return this.result.outputDefined()}}class yo{constructor(c,u){this.type=u.type,this.name=c,this.boundExpression=u}static parse(c,u){if(c.length!==2||typeof c[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");const x=c[1];return u.scope.has(x)?new yo(x,u.scope.get(x)):u.error(`Unknown variable "${x}". Make sure "${x}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(c){return this.boundExpression.evaluate(c)}eachChild(){}outputDefined(){return!1}}class Dm{constructor(c,u,x){this.type=c,this.index=u,this.input=x}static parse(c,u){if(c.length!==3)return u.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const x=u.parse(c[1],1,qt),_=u.parse(c[2],2,na(u.expectedType||Xr));return x&&_?new Dm(_.type.itemType,x,_):null}evaluate(c){const u=this.index.evaluate(c),x=this.input.evaluate(c);if(u<0)throw new ss(`Array index out of bounds: ${u} < 0.`);if(u>=x.length)throw new ss(`Array index out of bounds: ${u} > ${x.length-1}.`);if(u!==Math.floor(u))throw new ss(`Array index must be an integer, but found ${u} instead.`);return x[u]}eachChild(c){c(this.index),c(this.input)}outputDefined(){return!1}}class Hu{constructor(c,u){this.type=rn,this.needle=c,this.haystack=u}static parse(c,u){if(c.length!==3)return u.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const x=u.parse(c[1],1,Xr),_=u.parse(c[2],2,Xr);return x&&_?ui(x.type,[rn,Kr,qt,qi,Xr])?new Hu(x,_):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${gs(x.type)} instead`):null}evaluate(c){const u=this.needle.evaluate(c),x=this.haystack.evaluate(c);if(!x)return!1;if(!Nd(u,["boolean","string","number","null"]))throw new ss(`Expected first argument to be of type boolean, string, number or null, but found ${gs(Bs(u))} instead.`);if(!Nd(x,["string","array"]))throw new ss(`Expected second argument to be of type array or string, but found ${gs(Bs(x))} instead.`);return x.indexOf(u)>=0}eachChild(c){c(this.needle),c(this.haystack)}outputDefined(){return!0}}class Rm{constructor(c,u,x){this.type=qt,this.needle=c,this.haystack=u,this.fromIndex=x}static parse(c,u){if(c.length<=2||c.length>=5)return u.error(`Expected 2 or 3 arguments, but found ${c.length-1} instead.`);const x=u.parse(c[1],1,Xr),_=u.parse(c[2],2,Xr);if(!x||!_)return null;if(!ui(x.type,[rn,Kr,qt,qi,Xr]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${gs(x.type)} instead`);if(c.length===4){const C=u.parse(c[3],3,qt);return C?new Rm(x,_,C):null}return new Rm(x,_)}evaluate(c){const u=this.needle.evaluate(c),x=this.haystack.evaluate(c);if(!Nd(u,["boolean","string","number","null"]))throw new ss(`Expected first argument to be of type boolean, string, number or null, but found ${gs(Bs(u))} instead.`);let _;if(this.fromIndex&&(_=this.fromIndex.evaluate(c)),Nd(x,["string"])){const C=x.indexOf(u,_);return C===-1?-1:[...x.slice(0,C)].length}if(Nd(x,["array"]))return x.indexOf(u,_);throw new ss(`Expected second argument to be of type array or string, but found ${gs(Bs(x))} instead.`)}eachChild(c){c(this.needle),c(this.haystack),this.fromIndex&&c(this.fromIndex)}outputDefined(){return!1}}class Lm{constructor(c,u,x,_,C,A){this.inputType=c,this.type=u,this.input=x,this.cases=_,this.outputs=C,this.otherwise=A}static parse(c,u){if(c.length<5)return u.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if(c.length%2!=1)return u.error("Expected an even number of arguments.");let x,_;u.expectedType&&u.expectedType.kind!=="value"&&(_=u.expectedType);const C={},A=[];for(let q=2;q<c.length-1;q+=2){let V=c[q];const K=c[q+1];Array.isArray(V)||(V=[V]);const ee=u.concat(q);if(V.length===0)return ee.error("Expected at least one branch label.");for(const ae of V){if(typeof ae!="number"&&typeof ae!="string")return ee.error("Branch labels must be numbers or strings.");if(typeof ae=="number"&&Math.abs(ae)>Number.MAX_SAFE_INTEGER)return ee.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ae=="number"&&Math.floor(ae)!==ae)return ee.error("Numeric branch labels must be integer values.");if(x){if(ee.checkSubtype(x,Bs(ae)))return null}else x=Bs(ae);if(C[String(ae)]!==void 0)return ee.error("Branch labels must be unique.");C[String(ae)]=A.length}const re=u.parse(K,q,_);if(!re)return null;_=_||re.type,A.push(re)}const M=u.parse(c[1],1,Xr);if(!M)return null;const F=u.parse(c[c.length-1],c.length-1,_);return F?M.type.kind!=="value"&&u.concat(1).checkSubtype(x,M.type)?null:new Lm(x,_,M,C,A,F):null}evaluate(c){const u=this.input.evaluate(c);return(Bs(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(c)}eachChild(c){c(this.input),this.outputs.forEach(c),c(this.otherwise)}outputDefined(){return this.outputs.every(c=>c.outputDefined())&&this.otherwise.outputDefined()}}class Cp{constructor(c,u,x){this.type=c,this.branches=u,this.otherwise=x}static parse(c,u){if(c.length<4)return u.error(`Expected at least 3 arguments, but found only ${c.length-1}.`);if(c.length%2!=0)return u.error("Expected an odd number of arguments.");let x;u.expectedType&&u.expectedType.kind!=="value"&&(x=u.expectedType);const _=[];for(let A=1;A<c.length-1;A+=2){const M=u.parse(c[A],A,rn);if(!M)return null;const F=u.parse(c[A+1],A+1,x);if(!F)return null;_.push([M,F]),x=x||F.type}const C=u.parse(c[c.length-1],c.length-1,x);if(!C)return null;if(!x)throw new Error("Can't infer output type");return new Cp(x,_,C)}evaluate(c){for(const[u,x]of this.branches)if(u.evaluate(c))return x.evaluate(c);return this.otherwise.evaluate(c)}eachChild(c){for(const[u,x]of this.branches)c(u),c(x);c(this.otherwise)}outputDefined(){return this.branches.every(([c,u])=>u.outputDefined())&&this.otherwise.outputDefined()}}class Ap{constructor(c,u,x,_){this.type=c,this.input=u,this.beginIndex=x,this.endIndex=_}static parse(c,u){if(c.length<=2||c.length>=5)return u.error(`Expected 2 or 3 arguments, but found ${c.length-1} instead.`);const x=u.parse(c[1],1,Xr),_=u.parse(c[2],2,qt);if(!x||!_)return null;if(!ui(x.type,[na(Xr),Kr,Xr]))return u.error(`Expected first argument to be of type array or string, but found ${gs(x.type)} instead`);if(c.length===4){const C=u.parse(c[3],3,qt);return C?new Ap(x.type,x,_,C):null}return new Ap(x.type,x,_)}evaluate(c){const u=this.input.evaluate(c),x=this.beginIndex.evaluate(c);let _;if(this.endIndex&&(_=this.endIndex.evaluate(c)),Nd(u,["string"]))return[...u].slice(x,_).join("");if(Nd(u,["array"]))return u.slice(x,_);throw new ss(`Expected first argument to be of type array or string, but found ${gs(Bs(u))} instead.`)}eachChild(c){c(this.input),c(this.beginIndex),this.endIndex&&c(this.endIndex)}outputDefined(){return!1}}function Fm(h,c){const u=h.length-1;let x,_,C=0,A=u,M=0;for(;C<=A;)if(M=Math.floor((C+A)/2),x=h[M],_=h[M+1],x<=c){if(M===u||c<_)return M;C=M+1}else{if(!(x>c))throw new ss("Input is not a number.");A=M-1}return 0}class Zu{constructor(c,u,x){this.type=c,this.input=u,this.labels=[],this.outputs=[];for(const[_,C]of x)this.labels.push(_),this.outputs.push(C)}static parse(c,u){if(c.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return u.error("Expected an even number of arguments.");const x=u.parse(c[1],1,qt);if(!x)return null;const _=[];let C=null;u.expectedType&&u.expectedType.kind!=="value"&&(C=u.expectedType);for(let A=1;A<c.length;A+=2){const M=A===1?-1/0:c[A],F=c[A+1],q=A,V=A+1;if(typeof M!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(_.length&&_[_.length-1][0]>=M)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',q);const K=u.parse(F,V,C);if(!K)return null;C=C||K.type,_.push([M,K])}return new Zu(C,x,_)}evaluate(c){const u=this.labels,x=this.outputs;if(u.length===1)return x[0].evaluate(c);const _=this.input.evaluate(c);if(_<=u[0])return x[0].evaluate(c);const C=u.length;return _>=u[C-1]?x[C-1].evaluate(c):x[Fm(u,_)].evaluate(c)}eachChild(c){c(this.input);for(const u of this.outputs)c(u)}outputDefined(){return this.outputs.every(c=>c.outputDefined())}}function Rc(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var Ci,zm,vj=function(){if(zm)return Ci;function h(c,u,x,_){this.cx=3*c,this.bx=3*(x-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(_-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=u,this.p2x=x,this.p2y=_}return zm=1,Ci=h,h.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,u){if(u===void 0&&(u=1e-6),c<0)return 0;if(c>1)return 1;for(var x=c,_=0;_<8;_++){var C=this.sampleCurveX(x)-c;if(Math.abs(C)<u)return x;var A=this.sampleCurveDerivativeX(x);if(Math.abs(A)<1e-6)break;x-=C/A}var M=0,F=1;for(x=c,_=0;_<20&&(C=this.sampleCurveX(x),!(Math.abs(C-c)<u));_++)c>C?M=x:F=x,x=.5*(F-M)+M;return x},solve:function(c,u){return this.sampleCurveY(this.solveCurveX(c,u))}},Ci}(),kp=Rc(vj);class Dn{constructor(c,u,x,_,C){this.type=c,this.operator=u,this.interpolation=x,this.input=_,this.labels=[],this.outputs=[];for(const[A,M]of C)this.labels.push(A),this.outputs.push(M)}static interpolationFactor(c,u,x,_){let C=0;if(c.name==="exponential")C=Tp(u,c.base,x,_);else if(c.name==="linear")C=Tp(u,1,x,_);else if(c.name==="cubic-bezier"){const A=c.controlPoints;C=new kp(A[0],A[1],A[2],A[3]).solve(Tp(u,1,x,_))}return C}static parse(c,u){let[x,_,C,...A]=c;if(!Array.isArray(_)||_.length===0)return u.error("Expected an interpolation type expression.",1);if(_[0]==="linear")_={name:"linear"};else if(_[0]==="exponential"){const q=_[1];if(typeof q!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:q}}else{if(_[0]!=="cubic-bezier")return u.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const q=_.slice(1);if(q.length!==4||q.some(V=>typeof V!="number"||V<0||V>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:q}}}if(c.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(C=u.parse(C,2,qt),!C)return null;const M=[];let F=null;x!=="interpolate-hcl"&&x!=="interpolate-lab"||u.expectedType==Ic?u.expectedType&&u.expectedType.kind!=="value"&&(F=u.expectedType):F=Lo;for(let q=0;q<A.length;q+=2){const V=A[q],K=A[q+1],ee=q+3,re=q+4;if(typeof V!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ee);if(M.length&&M[M.length-1][0]>=V)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ee);const ae=u.parse(K,re,F);if(!ae)return null;F=F||ae.type,M.push([V,ae])}return Ul(F,qt)||Ul(F,km)||Ul(F,Lo)||Ul(F,hl)||Ul(F,Em)||Ul(F,Ic)||Ul(F,jp)||Ul(F,na(qt))?new Dn(F,x,_,C,M):u.error(`Type ${gs(F)} is not interpolatable.`)}evaluate(c){const u=this.labels,x=this.outputs;if(u.length===1)return x[0].evaluate(c);const _=this.input.evaluate(c);if(_<=u[0])return x[0].evaluate(c);const C=u.length;if(_>=u[C-1])return x[C-1].evaluate(c);const A=Fm(u,_),M=Dn.interpolationFactor(this.interpolation,_,u[A],u[A+1]),F=x[A].evaluate(c),q=x[A+1].evaluate(c);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Wl(F,q,M);case"color":return Ur.interpolate(F,q,M);case"padding":return sa.interpolate(F,q,M);case"colorArray":return Qs.interpolate(F,q,M);case"numberArray":return Vi.interpolate(F,q,M);case"variableAnchorOffsetCollection":return ia.interpolate(F,q,M);case"array":return Sd(F,q,M);case"projectionDefinition":return Ja.interpolate(F,q,M)}case"interpolate-hcl":switch(this.type.kind){case"color":return Ur.interpolate(F,q,M,"hcl");case"colorArray":return Qs.interpolate(F,q,M,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Ur.interpolate(F,q,M,"lab");case"colorArray":return Qs.interpolate(F,q,M,"lab")}}}eachChild(c){c(this.input);for(const u of this.outputs)c(u)}outputDefined(){return this.outputs.every(c=>c.outputDefined())}}function Tp(h,c,u,x){const _=x-u,C=h-u;return _===0?0:c===1?C/_:(Math.pow(c,C)-1)/(Math.pow(c,_)-1)}const vo={color:Ur.interpolate,number:Wl,padding:sa.interpolate,numberArray:Vi.interpolate,colorArray:Qs.interpolate,variableAnchorOffsetCollection:ia.interpolate,array:Sd};class $m{constructor(c,u){this.type=c,this.args=u}static parse(c,u){if(c.length<2)return u.error("Expected at least one argument.");let x=null;const _=u.expectedType;_&&_.kind!=="value"&&(x=_);const C=[];for(const M of c.slice(1)){const F=u.parse(M,1+C.length,x,void 0,{typeAnnotation:"omit"});if(!F)return null;x=x||F.type,C.push(F)}if(!x)throw new Error("No output type");const A=_&&C.some(M=>wd(_,M.type));return new $m(A?Xr:x,C)}evaluate(c){let u,x=null,_=0;for(const C of this.args)if(_++,x=C.evaluate(c),x&&x instanceof va&&!x.available&&(u||(u=x.name),x=null,_===this.args.length&&(x=u)),x!==null)break;return x}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}}function _j(h,c){return h==="=="||h==="!="?c.kind==="boolean"||c.kind==="string"||c.kind==="number"||c.kind==="null"||c.kind==="value":c.kind==="string"||c.kind==="number"||c.kind==="value"}function Cd(h,c,u,x){return x.compare(c,u)===0}function Gl(h,c,u){const x=h!=="=="&&h!=="!=";return class VW{constructor(C,A,M){this.type=rn,this.lhs=C,this.rhs=A,this.collator=M,this.hasUntypedArgument=C.type.kind==="value"||A.type.kind==="value"}static parse(C,A){if(C.length!==3&&C.length!==4)return A.error("Expected two or three arguments.");const M=C[0];let F=A.parse(C[1],1,Xr);if(!F)return null;if(!_j(M,F.type))return A.concat(1).error(`"${M}" comparisons are not supported for type '${gs(F.type)}'.`);let q=A.parse(C[2],2,Xr);if(!q)return null;if(!_j(M,q.type))return A.concat(2).error(`"${M}" comparisons are not supported for type '${gs(q.type)}'.`);if(F.type.kind!==q.type.kind&&F.type.kind!=="value"&&q.type.kind!=="value")return A.error(`Cannot compare types '${gs(F.type)}' and '${gs(q.type)}'.`);x&&(F.type.kind==="value"&&q.type.kind!=="value"?F=new jn(q.type,[F]):F.type.kind!=="value"&&q.type.kind==="value"&&(q=new jn(F.type,[q])));let V=null;if(C.length===4){if(F.type.kind!=="string"&&q.type.kind!=="string"&&F.type.kind!=="value"&&q.type.kind!=="value")return A.error("Cannot use collator to compare non-string types.");if(V=A.parse(C[3],3,Tm),!V)return null}return new VW(F,q,V)}evaluate(C){const A=this.lhs.evaluate(C),M=this.rhs.evaluate(C);if(x&&this.hasUntypedArgument){const F=Bs(A),q=Bs(M);if(F.kind!==q.kind||F.kind!=="string"&&F.kind!=="number")throw new ss(`Expected arguments for "${h}" to be (string, string) or (number, number), but found (${F.kind}, ${q.kind}) instead.`)}if(this.collator&&!x&&this.hasUntypedArgument){const F=Bs(A),q=Bs(M);if(F.kind!=="string"||q.kind!=="string")return c(C,A,M)}return this.collator?u(C,A,M,this.collator.evaluate(C)):c(C,A,M)}eachChild(C){C(this.lhs),C(this.rhs),this.collator&&C(this.collator)}outputDefined(){return!0}}}const uv=Gl("==",function(h,c,u){return c===u},Cd),UP=Gl("!=",function(h,c,u){return c!==u},function(h,c,u,x){return!Cd(0,c,u,x)}),bj=Gl("<",function(h,c,u){return c<u},function(h,c,u,x){return x.compare(c,u)<0}),Ep=Gl(">",function(h,c,u){return c>u},function(h,c,u,x){return x.compare(c,u)>0}),Mp=Gl("<=",function(h,c,u){return c<=u},function(h,c,u,x){return x.compare(c,u)<=0}),Fo=Gl(">=",function(h,c,u){return c>=u},function(h,c,u,x){return x.compare(c,u)>=0});class Bm{constructor(c,u,x){this.type=Tm,this.locale=x,this.caseSensitive=c,this.diacriticSensitive=u}static parse(c,u){if(c.length!==2)return u.error("Expected one argument.");const x=c[1];if(typeof x!="object"||Array.isArray(x))return u.error("Collator options argument must be an object.");const _=u.parse(x["case-sensitive"]!==void 0&&x["case-sensitive"],1,rn);if(!_)return null;const C=u.parse(x["diacritic-sensitive"]!==void 0&&x["diacritic-sensitive"],1,rn);if(!C)return null;let A=null;return x.locale&&(A=u.parse(x.locale,1,Kr),!A)?null:new Bm(_,C,A)}evaluate(c){return new un(this.caseSensitive.evaluate(c),this.diacriticSensitive.evaluate(c),this.locale?this.locale.evaluate(c):null)}eachChild(c){c(this.caseSensitive),c(this.diacriticSensitive),this.locale&&c(this.locale)}outputDefined(){return!1}}class Yu{constructor(c,u,x,_,C){this.type=Kr,this.number=c,this.locale=u,this.currency=x,this.minFractionDigits=_,this.maxFractionDigits=C}static parse(c,u){if(c.length!==3)return u.error("Expected two arguments.");const x=u.parse(c[1],1,qt);if(!x)return null;const _=c[2];if(typeof _!="object"||Array.isArray(_))return u.error("NumberFormat options argument must be an object.");let C=null;if(_.locale&&(C=u.parse(_.locale,1,Kr),!C))return null;let A=null;if(_.currency&&(A=u.parse(_.currency,1,Kr),!A))return null;let M=null;if(_["min-fraction-digits"]&&(M=u.parse(_["min-fraction-digits"],1,qt),!M))return null;let F=null;return _["max-fraction-digits"]&&(F=u.parse(_["max-fraction-digits"],1,qt),!F)?null:new Yu(x,C,A,M,F)}evaluate(c){return new Intl.NumberFormat(this.locale?this.locale.evaluate(c):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(c):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(c):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(c):void 0}).format(this.number.evaluate(c))}eachChild(c){c(this.number),this.locale&&c(this.locale),this.currency&&c(this.currency),this.minFractionDigits&&c(this.minFractionDigits),this.maxFractionDigits&&c(this.maxFractionDigits)}outputDefined(){return!1}}class Op{constructor(c){this.type=bd,this.sections=c}static parse(c,u){if(c.length<2)return u.error("Expected at least one argument.");const x=c[1];if(!Array.isArray(x)&&typeof x=="object")return u.error("First argument must be an image or text section.");const _=[];let C=!1;for(let A=1;A<=c.length-1;++A){const M=c[A];if(C&&typeof M=="object"&&!Array.isArray(M)){C=!1;let F=null;if(M["font-scale"]&&(F=u.parse(M["font-scale"],1,qt),!F))return null;let q=null;if(M["text-font"]&&(q=u.parse(M["text-font"],1,na(Kr)),!q))return null;let V=null;if(M["text-color"]&&(V=u.parse(M["text-color"],1,Lo),!V))return null;let K=null;if(M["vertical-align"]){if(typeof M["vertical-align"]=="string"&&!Wu.includes(M["vertical-align"]))return u.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${M["vertical-align"]}' instead.`);if(K=u.parse(M["vertical-align"],1,Kr),!K)return null}const ee=_[_.length-1];ee.scale=F,ee.font=q,ee.textColor=V,ee.verticalAlign=K}else{const F=u.parse(c[A],1,Xr);if(!F)return null;const q=F.type.kind;if(q!=="string"&&q!=="value"&&q!=="null"&&q!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");C=!0,_.push({content:F,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Op(_)}evaluate(c){return new Da(this.sections.map(u=>{const x=u.content.evaluate(c);return Bs(x)===jd?new ml("",x,null,null,null,u.verticalAlign?u.verticalAlign.evaluate(c):null):new ml(Gu(x),null,u.scale?u.scale.evaluate(c):null,u.font?u.font.evaluate(c).join(","):null,u.textColor?u.textColor.evaluate(c):null,u.verticalAlign?u.verticalAlign.evaluate(c):null)}))}eachChild(c){for(const u of this.sections)c(u.content),u.scale&&c(u.scale),u.font&&c(u.font),u.textColor&&c(u.textColor),u.verticalAlign&&c(u.verticalAlign)}outputDefined(){return!1}}class qm{constructor(c){this.type=jd,this.input=c}static parse(c,u){if(c.length!==2)return u.error("Expected two arguments.");const x=u.parse(c[1],1,Kr);return x?new qm(x):u.error("No image name provided.")}evaluate(c){const u=this.input.evaluate(c),x=va.fromString(u);return x&&c.availableImages&&(x.available=c.availableImages.indexOf(u)>-1),x}eachChild(c){c(this.input)}outputDefined(){return!1}}class hv{constructor(c){this.type=qt,this.input=c}static parse(c,u){if(c.length!==2)return u.error(`Expected 1 argument, but found ${c.length-1} instead.`);const x=u.parse(c[1],1);return x?x.type.kind!=="array"&&x.type.kind!=="string"&&x.type.kind!=="value"?u.error(`Expected argument of type string or array, but found ${gs(x.type)} instead.`):new hv(x):null}evaluate(c){const u=this.input.evaluate(c);if(typeof u=="string")return[...u].length;if(Array.isArray(u))return u.length;throw new ss(`Expected value to be of type string or array, but found ${gs(Bs(u))} instead.`)}eachChild(c){c(this.input)}outputDefined(){return!1}}const pl=8192;function WP(h,c){const u=(180+h[0])/360,x=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h[1]*Math.PI/360)))/360,_=Math.pow(2,c.z);return[Math.round(u*_*pl),Math.round(x*_*pl)]}function mv(h,c){const u=Math.pow(2,c.z);return[(_=(h[0]/pl+c.x)/u,360*_-180),(x=(h[1]/pl+c.y)/u,360/Math.PI*Math.atan(Math.exp((180-360*x)*Math.PI/180))-90)];var x,_}function Lc(h,c){h[0]=Math.min(h[0],c[0]),h[1]=Math.min(h[1],c[1]),h[2]=Math.max(h[2],c[0]),h[3]=Math.max(h[3],c[1])}function Vm(h,c){return!(h[0]<=c[0]||h[2]>=c[2]||h[1]<=c[1]||h[3]>=c[3])}function jj(h,c,u){const x=h[0]-c[0],_=h[1]-c[1],C=h[0]-u[0],A=h[1]-u[1];return x*A-C*_==0&&x*C<=0&&_*A<=0}function Um(h,c,u,x){return(_=[x[0]-u[0],x[1]-u[1]])[0]*(C=[c[0]-h[0],c[1]-h[1]])[1]-_[1]*C[0]!=0&&!(!Nj(h,c,u,x)||!Nj(u,x,h,c));var _,C}function GP(h,c,u){for(const x of u)for(let _=0;_<x.length-1;++_)if(Um(h,c,x[_],x[_+1]))return!0;return!1}function Ad(h,c,u=!1){let x=!1;for(const M of c)for(let F=0;F<M.length-1;F++){if(jj(h,M[F],M[F+1]))return u;(C=M[F])[1]>(_=h)[1]!=(A=M[F+1])[1]>_[1]&&_[0]<(A[0]-C[0])*(_[1]-C[1])/(A[1]-C[1])+C[0]&&(x=!x)}var _,C,A;return x}function KP(h,c){for(const u of c)if(Ad(h,u))return!0;return!1}function wj(h,c){for(const u of h)if(!Ad(u,c))return!1;for(let u=0;u<h.length-1;++u)if(GP(h[u],h[u+1],c))return!1;return!0}function HP(h,c){for(const u of c)if(wj(h,u))return!0;return!1}function Nj(h,c,u,x){const _=x[0]-u[0],C=x[1]-u[1],A=(h[0]-u[0])*C-_*(h[1]-u[1]),M=(c[0]-u[0])*C-_*(c[1]-u[1]);return A>0&&M<0||A<0&&M>0}function fv(h,c,u){const x=[];for(let _=0;_<h.length;_++){const C=[];for(let A=0;A<h[_].length;A++){const M=WP(h[_][A],u);Lc(c,M),C.push(M)}x.push(C)}return x}function pv(h,c,u){const x=[];for(let _=0;_<h.length;_++){const C=fv(h[_],c,u);x.push(C)}return x}function xv(h,c,u,x){if(h[0]<u[0]||h[0]>u[2]){const _=.5*x;let C=h[0]-u[0]>_?-x:u[0]-h[0]>_?x:0;C===0&&(C=h[0]-u[2]>_?-x:u[2]-h[0]>_?x:0),h[0]+=C}Lc(c,h)}function gv(h,c,u,x){const _=Math.pow(2,x.z)*pl,C=[x.x*pl,x.y*pl],A=[];for(const M of h)for(const F of M){const q=[F.x+C[0],F.y+C[1]];xv(q,c,u,_),A.push(q)}return A}function Sj(h,c,u,x){const _=Math.pow(2,x.z)*pl,C=[x.x*pl,x.y*pl],A=[];for(const F of h){const q=[];for(const V of F){const K=[V.x+C[0],V.y+C[1]];Lc(c,K),q.push(K)}A.push(q)}if(c[2]-c[0]<=_/2){(M=c)[0]=M[1]=1/0,M[2]=M[3]=-1/0;for(const F of A)for(const q of F)xv(q,c,u,_)}var M;return A}class kd{constructor(c,u){this.type=rn,this.geojson=c,this.geometries=u}static parse(c,u){if(c.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${c.length-1} instead.`);if(fl(c[1])){const x=c[1];if(x.type==="FeatureCollection"){const _=[];for(const C of x.features){const{type:A,coordinates:M}=C.geometry;A==="Polygon"&&_.push(M),A==="MultiPolygon"&&_.push(...M)}if(_.length)return new kd(x,{type:"MultiPolygon",coordinates:_})}else if(x.type==="Feature"){const _=x.geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new kd(x,x.geometry)}else if(x.type==="Polygon"||x.type==="MultiPolygon")return new kd(x,x)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return function(u,x){const _=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],A=u.canonicalID();if(x.type==="Polygon"){const M=fv(x.coordinates,C,A),F=gv(u.geometry(),_,C,A);if(!Vm(_,C))return!1;for(const q of F)if(!Ad(q,M))return!1}if(x.type==="MultiPolygon"){const M=pv(x.coordinates,C,A),F=gv(u.geometry(),_,C,A);if(!Vm(_,C))return!1;for(const q of F)if(!KP(q,M))return!1}return!0}(c,this.geometries);if(c.geometryType()==="LineString")return function(u,x){const _=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],A=u.canonicalID();if(x.type==="Polygon"){const M=fv(x.coordinates,C,A),F=Sj(u.geometry(),_,C,A);if(!Vm(_,C))return!1;for(const q of F)if(!wj(q,M))return!1}if(x.type==="MultiPolygon"){const M=pv(x.coordinates,C,A),F=Sj(u.geometry(),_,C,A);if(!Vm(_,C))return!1;for(const q of F)if(!HP(q,M))return!1}return!0}(c,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Pj=class{constructor(h=[],c=(u,x)=>u<x?-1:u>x?1:0){if(this.data=h,this.length=this.data.length,this.compare=c,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(h){this.data.push(h),this._up(this.length++)}pop(){if(this.length===0)return;const h=this.data[0],c=this.data.pop();return--this.length>0&&(this.data[0]=c,this._down(0)),h}peek(){return this.data[0]}_up(h){const{data:c,compare:u}=this,x=c[h];for(;h>0;){const _=h-1>>1,C=c[_];if(u(x,C)>=0)break;c[h]=C,h=_}c[h]=x}_down(h){const{data:c,compare:u}=this,x=this.length>>1,_=c[h];for(;h<x;){let C=1+(h<<1);const A=C+1;if(A<this.length&&u(c[A],c[C])<0&&(C=A),u(c[C],_)>=0)break;c[h]=c[C],h=C}c[h]=_}};function Cj(h,c,u=0,x=h.length-1,_=ZP){for(;x>u;){if(x-u>600){const F=x-u+1,q=c-u+1,V=Math.log(F),K=.5*Math.exp(2*V/3),ee=.5*Math.sqrt(V*K*(F-K)/F)*(q-F/2<0?-1:1);Cj(h,c,Math.max(u,Math.floor(c-q*K/F+ee)),Math.min(x,Math.floor(c+(F-q)*K/F+ee)),_)}const C=h[c];let A=u,M=x;for(Fc(h,u,c),_(h[x],C)>0&&Fc(h,u,x);A<M;){for(Fc(h,A,M),A++,M--;_(h[A],C)<0;)A++;for(;_(h[M],C)>0;)M--}_(h[u],C)===0?Fc(h,u,M):(M++,Fc(h,M,x)),M<=c&&(u=M+1),c<=M&&(x=M-1)}}function Fc(h,c,u){const x=h[c];h[c]=h[u],h[u]=x}function ZP(h,c){return h<c?-1:h>c?1:0}function Ip(h,c){if(h.length<=1)return[h];const u=[];let x,_;for(const C of h){const A=XP(C);A!==0&&(C.area=Math.abs(A),_===void 0&&(_=A<0),_===A<0?(x&&u.push(x),x=[C]):x.push(C))}if(x&&u.push(x),c>1)for(let C=0;C<u.length;C++)u[C].length<=c||(Cj(u[C],c,1,u[C].length-1,YP),u[C]=u[C].slice(0,c));return u}function YP(h,c){return c.area-h.area}function XP(h){let c=0;for(let u,x,_=0,C=h.length,A=C-1;_<C;A=_++)u=h[_],x=h[A],c+=(x.x-u.x)*(u.y+x.y);return c}const Dp=1/298.257223563,yv=Dp*(2-Dp),Aj=Math.PI/180;class vv{constructor(c){const u=6378.137*Aj*1e3,x=Math.cos(c*Aj),_=1/(1-yv*(1-x*x)),C=Math.sqrt(_);this.kx=u*C*x,this.ky=u*C*_*(1-yv)}distance(c,u){const x=this.wrap(c[0]-u[0])*this.kx,_=(c[1]-u[1])*this.ky;return Math.sqrt(x*x+_*_)}pointOnLine(c,u){let x,_,C,A,M=1/0;for(let F=0;F<c.length-1;F++){let q=c[F][0],V=c[F][1],K=this.wrap(c[F+1][0]-q)*this.kx,ee=(c[F+1][1]-V)*this.ky,re=0;K===0&&ee===0||(re=(this.wrap(u[0]-q)*this.kx*K+(u[1]-V)*this.ky*ee)/(K*K+ee*ee),re>1?(q=c[F+1][0],V=c[F+1][1]):re>0&&(q+=K/this.kx*re,V+=ee/this.ky*re)),K=this.wrap(u[0]-q)*this.kx,ee=(u[1]-V)*this.ky;const ae=K*K+ee*ee;ae<M&&(M=ae,x=q,_=V,C=F,A=re)}return{point:[x,_],index:C,t:Math.max(0,Math.min(1,A))}}wrap(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}}function _v(h,c){return c[0]-h[0]}function Wm(h){return h[1]-h[0]+1}function Kl(h,c){return h[1]>=h[0]&&h[1]<c}function bv(h,c){if(h[0]>h[1])return[null,null];const u=Wm(h);if(c){if(u===2)return[h,null];const _=Math.floor(u/2);return[[h[0],h[0]+_],[h[0]+_,h[1]]]}if(u===1)return[h,null];const x=Math.floor(u/2)-1;return[[h[0],h[0]+x],[h[0]+x+1,h[1]]]}function jv(h,c){if(!Kl(c,h.length))return[1/0,1/0,-1/0,-1/0];const u=[1/0,1/0,-1/0,-1/0];for(let x=c[0];x<=c[1];++x)Lc(u,h[x]);return u}function Rp(h){const c=[1/0,1/0,-1/0,-1/0];for(const u of h)for(const x of u)Lc(c,x);return c}function kj(h){return h[0]!==-1/0&&h[1]!==-1/0&&h[2]!==1/0&&h[3]!==1/0}function wv(h,c,u){if(!kj(h)||!kj(c))return NaN;let x=0,_=0;return h[2]<c[0]&&(x=c[0]-h[2]),h[0]>c[2]&&(x=h[0]-c[2]),h[1]>c[3]&&(_=h[1]-c[3]),h[3]<c[1]&&(_=c[1]-h[3]),u.distance([0,0],[x,_])}function Td(h,c,u){const x=u.pointOnLine(c,h);return u.distance(h,x.point)}function Nv(h,c,u,x,_){const C=Math.min(Td(h,[u,x],_),Td(c,[u,x],_)),A=Math.min(Td(u,[h,c],_),Td(x,[h,c],_));return Math.min(C,A)}function In(h,c,u,x,_){if(!Kl(c,h.length)||!Kl(x,u.length))return 1/0;let C=1/0;for(let A=c[0];A<c[1];++A){const M=h[A],F=h[A+1];for(let q=x[0];q<x[1];++q){const V=u[q],K=u[q+1];if(Um(M,F,V,K))return 0;C=Math.min(C,Nv(M,F,V,K,_))}}return C}function QP(h,c,u,x,_){if(!Kl(c,h.length)||!Kl(x,u.length))return NaN;let C=1/0;for(let A=c[0];A<=c[1];++A)for(let M=x[0];M<=x[1];++M)if(C=Math.min(C,_.distance(h[A],u[M])),C===0)return C;return C}function JP(h,c,u){if(Ad(h,c,!0))return 0;let x=1/0;for(const _ of c){const C=_[0],A=_[_.length-1];if(C!==A&&(x=Math.min(x,Td(h,[A,C],u)),x===0))return x;const M=u.pointOnLine(_,h);if(x=Math.min(x,u.distance(h,M.point)),x===0)return x}return x}function eC(h,c,u,x){if(!Kl(c,h.length))return NaN;for(let C=c[0];C<=c[1];++C)if(Ad(h[C],u,!0))return 0;let _=1/0;for(let C=c[0];C<c[1];++C){const A=h[C],M=h[C+1];for(const F of u)for(let q=0,V=F.length,K=V-1;q<V;K=q++){const ee=F[K],re=F[q];if(Um(A,M,ee,re))return 0;_=Math.min(_,Nv(A,M,ee,re,x))}}return _}function Tj(h,c){for(const u of h)for(const x of u)if(Ad(x,c,!0))return!0;return!1}function tC(h,c,u,x=1/0){const _=Rp(h),C=Rp(c);if(x!==1/0&&wv(_,C,u)>=x)return x;if(Vm(_,C)){if(Tj(h,c))return 0}else if(Tj(c,h))return 0;let A=1/0;for(const M of h)for(let F=0,q=M.length,V=q-1;F<q;V=F++){const K=M[V],ee=M[F];for(const re of c)for(let ae=0,pe=re.length,_e=pe-1;ae<pe;_e=ae++){const Pe=re[_e],Qe=re[ae];if(Um(K,ee,Pe,Qe))return 0;A=Math.min(A,Nv(K,ee,Pe,Qe,u))}}return A}function Ej(h,c,u,x,_,C){if(!C)return;const A=wv(jv(x,C),_,u);A<c&&h.push([A,C,[0,0]])}function Lp(h,c,u,x,_,C,A){if(!C||!A)return;const M=wv(jv(x,C),jv(_,A),u);M<c&&h.push([M,C,A])}function Fp(h,c,u,x,_=1/0){let C=Math.min(x.distance(h[0],u[0][0]),_);if(C===0)return C;const A=new Pj([[0,[0,h.length-1],[0,0]]],_v),M=Rp(u);for(;A.length>0;){const F=A.pop();if(F[0]>=C)continue;const q=F[1],V=c?50:100;if(Wm(q)<=V){if(!Kl(q,h.length))return NaN;if(c){const K=eC(h,q,u,x);if(isNaN(K)||K===0)return K;C=Math.min(C,K)}else for(let K=q[0];K<=q[1];++K){const ee=JP(h[K],u,x);if(C=Math.min(C,ee),C===0)return 0}}else{const K=bv(q,c);Ej(A,C,x,h,M,K[0]),Ej(A,C,x,h,M,K[1])}}return C}function zp(h,c,u,x,_,C=1/0){let A=Math.min(C,_.distance(h[0],u[0]));if(A===0)return A;const M=new Pj([[0,[0,h.length-1],[0,u.length-1]]],_v);for(;M.length>0;){const F=M.pop();if(F[0]>=A)continue;const q=F[1],V=F[2],K=c?50:100,ee=x?50:100;if(Wm(q)<=K&&Wm(V)<=ee){if(!Kl(q,h.length)&&Kl(V,u.length))return NaN;let re;if(c&&x)re=In(h,q,u,V,_),A=Math.min(A,re);else if(c&&!x){const ae=h.slice(q[0],q[1]+1);for(let pe=V[0];pe<=V[1];++pe)if(re=Td(u[pe],ae,_),A=Math.min(A,re),A===0)return A}else if(!c&&x){const ae=u.slice(V[0],V[1]+1);for(let pe=q[0];pe<=q[1];++pe)if(re=Td(h[pe],ae,_),A=Math.min(A,re),A===0)return A}else re=QP(h,q,u,V,_),A=Math.min(A,re)}else{const re=bv(q,c),ae=bv(V,x);Lp(M,A,_,h,u,re[0],ae[0]),Lp(M,A,_,h,u,re[0],ae[1]),Lp(M,A,_,h,u,re[1],ae[0]),Lp(M,A,_,h,u,re[1],ae[1])}}return A}function Sv(h){return h.type==="MultiPolygon"?h.coordinates.map(c=>({type:"Polygon",coordinates:c})):h.type==="MultiLineString"?h.coordinates.map(c=>({type:"LineString",coordinates:c})):h.type==="MultiPoint"?h.coordinates.map(c=>({type:"Point",coordinates:c})):[h]}class Ed{constructor(c,u){this.type=qt,this.geojson=c,this.geometries=u}static parse(c,u){if(c.length!==2)return u.error(`'distance' expression requires exactly one argument, but found ${c.length-1} instead.`);if(fl(c[1])){const x=c[1];if(x.type==="FeatureCollection")return new Ed(x,x.features.map(_=>Sv(_.geometry)).flat());if(x.type==="Feature")return new Ed(x,Sv(x.geometry));if("type"in x&&"coordinates"in x)return new Ed(x,Sv(x))}return u.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return function(u,x){const _=u.geometry(),C=_.flat().map(F=>mv([F.x,F.y],u.canonical));if(_.length===0)return NaN;const A=new vv(C[0][1]);let M=1/0;for(const F of x){switch(F.type){case"Point":M=Math.min(M,zp(C,!1,[F.coordinates],!1,A,M));break;case"LineString":M=Math.min(M,zp(C,!1,F.coordinates,!0,A,M));break;case"Polygon":M=Math.min(M,Fp(C,!1,F.coordinates,A,M))}if(M===0)return M}return M}(c,this.geometries);if(c.geometryType()==="LineString")return function(u,x){const _=u.geometry(),C=_.flat().map(F=>mv([F.x,F.y],u.canonical));if(_.length===0)return NaN;const A=new vv(C[0][1]);let M=1/0;for(const F of x){switch(F.type){case"Point":M=Math.min(M,zp(C,!0,[F.coordinates],!1,A,M));break;case"LineString":M=Math.min(M,zp(C,!0,F.coordinates,!0,A,M));break;case"Polygon":M=Math.min(M,Fp(C,!0,F.coordinates,A,M))}if(M===0)return M}return M}(c,this.geometries);if(c.geometryType()==="Polygon")return function(u,x){const _=u.geometry();if(_.length===0||_[0].length===0)return NaN;const C=Ip(_,0).map(F=>F.map(q=>q.map(V=>mv([V.x,V.y],u.canonical)))),A=new vv(C[0][0][0][1]);let M=1/0;for(const F of x)for(const q of C){switch(F.type){case"Point":M=Math.min(M,Fp([F.coordinates],!1,q,A,M));break;case"LineString":M=Math.min(M,Fp(F.coordinates,!0,q,A,M));break;case"Polygon":M=Math.min(M,tC(q,F.coordinates,A,M))}if(M===0)return M}return M}(c,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Gm{constructor(c){this.type=Xr,this.key=c}static parse(c,u){if(c.length!==2)return u.error(`Expected 1 argument, but found ${c.length-1} instead.`);const x=c[1];return x==null?u.error("Global state property must be defined."):typeof x!="string"?u.error(`Global state property must be string, but found ${typeof c[1]} instead.`):new Gm(x)}evaluate(c){var u;const x=(u=c.globals)===null||u===void 0?void 0:u.globalState;return x&&Object.keys(x).length!==0?Om(x,this.key):null}eachChild(){}outputDefined(){return!1}}const Xu={"==":uv,"!=":UP,">":Ep,"<":bj,">=":Fo,"<=":Mp,array:jn,at:Dm,boolean:jn,case:Cp,coalesce:$m,collator:Bm,format:Op,image:qm,in:Hu,"index-of":Rm,interpolate:Dn,"interpolate-hcl":Dn,"interpolate-lab":Dn,length:hv,let:Ku,literal:Dc,match:Lm,number:jn,"number-format":Yu,object:jn,slice:Ap,step:Zu,string:jn,"to-boolean":nn,"to-color":nn,"to-number":nn,"to-string":nn,var:yo,within:kd,distance:Ed,"global-state":Gm};class _o{constructor(c,u,x,_){this.name=c,this.type=u,this._evaluate=x,this.args=_}evaluate(c){return this._evaluate(c,this.args)}eachChild(c){this.args.forEach(c)}outputDefined(){return!1}static parse(c,u){const x=c[0],_=_o.definitions[x];if(!_)return u.error(`Unknown expression "${x}". If you wanted a literal array, use ["literal", [...]].`,0);const C=Array.isArray(_)?_[0]:_.type,A=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,M=A.filter(([q])=>!Array.isArray(q)||q.length===c.length-1);let F=null;for(const[q,V]of M){F=new vn(u.registry,$p,u.path,null,u.scope);const K=[];let ee=!1;for(let re=1;re<c.length;re++){const ae=c[re],pe=Array.isArray(q)?q[re-1]:q.type,_e=F.parse(ae,1+K.length,pe);if(!_e){ee=!0;break}K.push(_e)}if(!ee)if(Array.isArray(q)&&q.length!==K.length)F.error(`Expected ${q.length} arguments, but found ${K.length} instead.`);else{for(let re=0;re<K.length;re++){const ae=Array.isArray(q)?q[re]:q.type,pe=K[re];F.concat(re+1).checkSubtype(ae,pe.type)}if(F.errors.length===0)return new _o(x,C,V,K)}}if(M.length===1)u.errors.push(...F.errors);else{const q=(M.length?M:A).map(([K])=>{return ee=K,Array.isArray(ee)?`(${ee.map(gs).join(", ")})`:`(${gs(ee.type)}...)`;var ee}).join(" | "),V=[];for(let K=1;K<c.length;K++){const ee=u.parse(c[K],1+V.length);if(!ee)return null;V.push(gs(ee.type))}u.error(`Expected arguments of type ${q}, but found (${V.join(", ")}) instead.`)}return null}static register(c,u){_o.definitions=u;for(const x in u)c[x]=_o}}function Mj(h,[c,u,x,_]){c=c.evaluate(h),u=u.evaluate(h),x=x.evaluate(h);const C=_?_.evaluate(h):1,A=Im(c,u,x,C);if(A)throw new ss(A);return new Ur(c/255,u/255,x/255,C,!1)}function Oj(h,c){return h in c}function Pv(h,c){const u=c[h];return u===void 0?null:u}function Md(h){return{type:h}}function $p(h){if(h instanceof yo)return $p(h.boundExpression);if(h instanceof _o&&h.name==="error"||h instanceof Bm||h instanceof kd||h instanceof Ed||h instanceof Gm)return!1;const c=h instanceof nn||h instanceof jn;let u=!0;return h.eachChild(x=>{u=c?u&&$p(x):u&&x instanceof Dc}),!!u&&Bp(h)&&qp(h,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Bp(h){if(h instanceof _o&&(h.name==="get"&&h.args.length===1||h.name==="feature-state"||h.name==="has"&&h.args.length===1||h.name==="properties"||h.name==="geometry-type"||h.name==="id"||/^filter-/.test(h.name))||h instanceof kd||h instanceof Ed)return!1;let c=!0;return h.eachChild(u=>{c&&!Bp(u)&&(c=!1)}),c}function Km(h){if(h instanceof _o&&h.name==="feature-state")return!1;let c=!0;return h.eachChild(u=>{c&&!Km(u)&&(c=!1)}),c}function qp(h,c){if(h instanceof _o&&c.indexOf(h.name)>=0)return!1;let u=!0;return h.eachChild(x=>{u&&!qp(x,c)&&(u=!1)}),u}function Ij(h){return{result:"success",value:h}}function Qu(h){return{result:"error",value:h}}function Ju(h){return h["property-type"]==="data-driven"||h["property-type"]==="cross-faded-data-driven"}function Dj(h){return!!h.expression&&h.expression.parameters.indexOf("zoom")>-1}function Cv(h){return!!h.expression&&h.expression.interpolated}function dn(h){return h instanceof Number?"number":h instanceof String?"string":h instanceof Boolean?"boolean":Array.isArray(h)?"array":h===null?"null":typeof h}function Vp(h){return typeof h=="object"&&h!==null&&!Array.isArray(h)&&Bs(h)===Oc}function rC(h){return h}function Rj(h,c){const u=h.stops&&typeof h.stops[0][0]=="object",x=u||!(u||h.property!==void 0),_=h.type||(Cv(c)?"exponential":"interval"),C=function(V){switch(V.type){case"color":return Ur.parse;case"padding":return sa.parse;case"numberArray":return Vi.parse;case"colorArray":return Qs.parse;default:return null}}(c);if(C&&((h=$s({},h)).stops&&(h.stops=h.stops.map(V=>[V[0],C(V[1])])),h.default=C(h.default?h.default:c.default)),h.colorSpace&&(A=h.colorSpace)!=="rgb"&&A!=="hcl"&&A!=="lab")throw new Error(`Unknown color space: "${h.colorSpace}"`);var A;const M=function(V){switch(V){case"exponential":return Lj;case"interval":return sC;case"categorical":return nC;case"identity":return Fj;default:throw new Error(`Unknown function type "${V}"`)}}(_);let F,q;if(_==="categorical"){F=Object.create(null);for(const V of h.stops)F[V[0]]=V[1];q=typeof h.stops[0][0]}if(u){const V={},K=[];for(let ae=0;ae<h.stops.length;ae++){const pe=h.stops[ae],_e=pe[0].zoom;V[_e]===void 0&&(V[_e]={zoom:_e,type:h.type,property:h.property,default:h.default,stops:[]},K.push(_e)),V[_e].stops.push([pe[0].value,pe[1]])}const ee=[];for(const ae of K)ee.push([V[ae].zoom,Rj(V[ae],c)]);const re={name:"linear"};return{kind:"composite",interpolationType:re,interpolationFactor:Dn.interpolationFactor.bind(void 0,re),zoomStops:ee.map(ae=>ae[0]),evaluate:({zoom:ae},pe)=>Lj({stops:ee,base:h.base},c,ae).evaluate(ae,pe)}}if(x){const V=_==="exponential"?{name:"exponential",base:h.base!==void 0?h.base:1}:null;return{kind:"camera",interpolationType:V,interpolationFactor:Dn.interpolationFactor.bind(void 0,V),zoomStops:h.stops.map(K=>K[0]),evaluate:({zoom:K})=>M(h,c,K,F,q)}}return{kind:"source",evaluate(V,K){const ee=K&&K.properties?K.properties[h.property]:void 0;return ee===void 0?Od(h.default,c.default):M(h,c,ee,F,q)}}}function Od(h,c,u){return h!==void 0?h:c!==void 0?c:u!==void 0?u:void 0}function nC(h,c,u,x,_){return Od(typeof u===_?x[u]:void 0,h.default,c.default)}function sC(h,c,u){if(dn(u)!=="number")return Od(h.default,c.default);const x=h.stops.length;if(x===1||u<=h.stops[0][0])return h.stops[0][1];if(u>=h.stops[x-1][0])return h.stops[x-1][1];const _=Fm(h.stops.map(C=>C[0]),u);return h.stops[_][1]}function Lj(h,c,u){const x=h.base!==void 0?h.base:1;if(dn(u)!=="number")return Od(h.default,c.default);const _=h.stops.length;if(_===1||u<=h.stops[0][0])return h.stops[0][1];if(u>=h.stops[_-1][0])return h.stops[_-1][1];const C=Fm(h.stops.map(V=>V[0]),u),A=function(V,K,ee,re){const ae=re-ee,pe=V-ee;return ae===0?0:K===1?pe/ae:(Math.pow(K,pe)-1)/(Math.pow(K,ae)-1)}(u,x,h.stops[C][0],h.stops[C+1][0]),M=h.stops[C][1],F=h.stops[C+1][1],q=vo[c.type]||rC;return typeof M.evaluate=="function"?{evaluate(...V){const K=M.evaluate.apply(void 0,V),ee=F.evaluate.apply(void 0,V);if(K!==void 0&&ee!==void 0)return q(K,ee,A,h.colorSpace)}}:q(M,F,A,h.colorSpace)}function Fj(h,c,u){switch(c.type){case"color":u=Ur.parse(u);break;case"formatted":u=Da.fromString(u.toString());break;case"resolvedImage":u=va.fromString(u.toString());break;case"padding":u=sa.parse(u);break;case"colorArray":u=Qs.parse(u);break;case"numberArray":u=Vi.parse(u);break;default:dn(u)===c.type||c.type==="enum"&&c.values[u]||(u=void 0)}return Od(u,h.default,c.default)}_o.register(Xu,{error:[{kind:"error"},[Kr],(h,[c])=>{throw new ss(c.evaluate(h))}],typeof:[Kr,[Xr],(h,[c])=>gs(Bs(c.evaluate(h)))],"to-rgba":[na(qt,4),[Lo],(h,[c])=>{const[u,x,_,C]=c.evaluate(h).rgb;return[255*u,255*x,255*_,C]}],rgb:[Lo,[qt,qt,qt],Mj],rgba:[Lo,[qt,qt,qt,qt],Mj],has:{type:rn,overloads:[[[Kr],(h,[c])=>Oj(c.evaluate(h),h.properties())],[[Kr,Oc],(h,[c,u])=>Oj(c.evaluate(h),u.evaluate(h))]]},get:{type:Xr,overloads:[[[Kr],(h,[c])=>Pv(c.evaluate(h),h.properties())],[[Kr,Oc],(h,[c,u])=>Pv(c.evaluate(h),u.evaluate(h))]]},"feature-state":[Xr,[Kr],(h,[c])=>Pv(c.evaluate(h),h.featureState||{})],properties:[Oc,[],h=>h.properties()],"geometry-type":[Kr,[],h=>h.geometryType()],id:[Xr,[],h=>h.id()],zoom:[qt,[],h=>h.globals.zoom],"heatmap-density":[qt,[],h=>h.globals.heatmapDensity||0],elevation:[qt,[],h=>h.globals.elevation||0],"line-progress":[qt,[],h=>h.globals.lineProgress||0],accumulated:[Xr,[],h=>h.globals.accumulated===void 0?null:h.globals.accumulated],"+":[qt,Md(qt),(h,c)=>{let u=0;for(const x of c)u+=x.evaluate(h);return u}],"*":[qt,Md(qt),(h,c)=>{let u=1;for(const x of c)u*=x.evaluate(h);return u}],"-":{type:qt,overloads:[[[qt,qt],(h,[c,u])=>c.evaluate(h)-u.evaluate(h)],[[qt],(h,[c])=>-c.evaluate(h)]]},"/":[qt,[qt,qt],(h,[c,u])=>c.evaluate(h)/u.evaluate(h)],"%":[qt,[qt,qt],(h,[c,u])=>c.evaluate(h)%u.evaluate(h)],ln2:[qt,[],()=>Math.LN2],pi:[qt,[],()=>Math.PI],e:[qt,[],()=>Math.E],"^":[qt,[qt,qt],(h,[c,u])=>Math.pow(c.evaluate(h),u.evaluate(h))],sqrt:[qt,[qt],(h,[c])=>Math.sqrt(c.evaluate(h))],log10:[qt,[qt],(h,[c])=>Math.log(c.evaluate(h))/Math.LN10],ln:[qt,[qt],(h,[c])=>Math.log(c.evaluate(h))],log2:[qt,[qt],(h,[c])=>Math.log(c.evaluate(h))/Math.LN2],sin:[qt,[qt],(h,[c])=>Math.sin(c.evaluate(h))],cos:[qt,[qt],(h,[c])=>Math.cos(c.evaluate(h))],tan:[qt,[qt],(h,[c])=>Math.tan(c.evaluate(h))],asin:[qt,[qt],(h,[c])=>Math.asin(c.evaluate(h))],acos:[qt,[qt],(h,[c])=>Math.acos(c.evaluate(h))],atan:[qt,[qt],(h,[c])=>Math.atan(c.evaluate(h))],min:[qt,Md(qt),(h,c)=>Math.min(...c.map(u=>u.evaluate(h)))],max:[qt,Md(qt),(h,c)=>Math.max(...c.map(u=>u.evaluate(h)))],abs:[qt,[qt],(h,[c])=>Math.abs(c.evaluate(h))],round:[qt,[qt],(h,[c])=>{const u=c.evaluate(h);return u<0?-Math.round(-u):Math.round(u)}],floor:[qt,[qt],(h,[c])=>Math.floor(c.evaluate(h))],ceil:[qt,[qt],(h,[c])=>Math.ceil(c.evaluate(h))],"filter-==":[rn,[Kr,Xr],(h,[c,u])=>h.properties()[c.value]===u.value],"filter-id-==":[rn,[Xr],(h,[c])=>h.id()===c.value],"filter-type-==":[rn,[Kr],(h,[c])=>h.geometryType()===c.value],"filter-<":[rn,[Kr,Xr],(h,[c,u])=>{const x=h.properties()[c.value],_=u.value;return typeof x==typeof _&&x<_}],"filter-id-<":[rn,[Xr],(h,[c])=>{const u=h.id(),x=c.value;return typeof u==typeof x&&u<x}],"filter->":[rn,[Kr,Xr],(h,[c,u])=>{const x=h.properties()[c.value],_=u.value;return typeof x==typeof _&&x>_}],"filter-id->":[rn,[Xr],(h,[c])=>{const u=h.id(),x=c.value;return typeof u==typeof x&&u>x}],"filter-<=":[rn,[Kr,Xr],(h,[c,u])=>{const x=h.properties()[c.value],_=u.value;return typeof x==typeof _&&x<=_}],"filter-id-<=":[rn,[Xr],(h,[c])=>{const u=h.id(),x=c.value;return typeof u==typeof x&&u<=x}],"filter->=":[rn,[Kr,Xr],(h,[c,u])=>{const x=h.properties()[c.value],_=u.value;return typeof x==typeof _&&x>=_}],"filter-id->=":[rn,[Xr],(h,[c])=>{const u=h.id(),x=c.value;return typeof u==typeof x&&u>=x}],"filter-has":[rn,[Xr],(h,[c])=>c.value in h.properties()],"filter-has-id":[rn,[],h=>h.id()!==null&&h.id()!==void 0],"filter-type-in":[rn,[na(Kr)],(h,[c])=>c.value.indexOf(h.geometryType())>=0],"filter-id-in":[rn,[na(Xr)],(h,[c])=>c.value.indexOf(h.id())>=0],"filter-in-small":[rn,[Kr,na(Xr)],(h,[c,u])=>u.value.indexOf(h.properties()[c.value])>=0],"filter-in-large":[rn,[Kr,na(Xr)],(h,[c,u])=>function(x,_,C,A){for(;C<=A;){const M=C+A>>1;if(_[M]===x)return!0;_[M]>x?A=M-1:C=M+1}return!1}(h.properties()[c.value],u.value,0,u.value.length-1)],all:{type:rn,overloads:[[[rn,rn],(h,[c,u])=>c.evaluate(h)&&u.evaluate(h)],[Md(rn),(h,c)=>{for(const u of c)if(!u.evaluate(h))return!1;return!0}]]},any:{type:rn,overloads:[[[rn,rn],(h,[c,u])=>c.evaluate(h)||u.evaluate(h)],[Md(rn),(h,c)=>{for(const u of c)if(u.evaluate(h))return!0;return!1}]]},"!":[rn,[rn],(h,[c])=>!c.evaluate(h)],"is-supported-script":[rn,[Kr],(h,[c])=>{const u=h.globals&&h.globals.isSupportedScript;return!u||u(c.evaluate(h))}],upcase:[Kr,[Kr],(h,[c])=>c.evaluate(h).toUpperCase()],downcase:[Kr,[Kr],(h,[c])=>c.evaluate(h).toLowerCase()],concat:[Kr,Md(Xr),(h,c)=>c.map(u=>Gu(u.evaluate(h))).join("")],"resolved-locale":[Kr,[Tm],(h,[c])=>c.evaluate(h).resolvedLocale()]});class Av{constructor(c,u,x){this.expression=c,this._warningHistory={},this._evaluator=new Pp,this._defaultValue=u?function(_){if(_.type==="color"&&Vp(_.default))return new Ur(0,0,0,0);switch(_.type){case"color":return Ur.parse(_.default)||null;case"padding":return sa.parse(_.default)||null;case"numberArray":return Vi.parse(_.default)||null;case"colorArray":return Qs.parse(_.default)||null;case"variableAnchorOffsetCollection":return ia.parse(_.default)||null;case"projectionDefinition":return Ja.parse(_.default)||null;default:return _.default===void 0?null:_.default}}(u):null,this._enumValues=u&&u.type==="enum"?u.values:null,this._globalState=x}evaluateWithoutErrorHandling(c,u,x,_,C,A){return this._globalState&&(c=Dd(c,this._globalState)),this._evaluator.globals=c,this._evaluator.feature=u,this._evaluator.featureState=x,this._evaluator.canonical=_,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=A,this.expression.evaluate(this._evaluator)}evaluate(c,u,x,_,C,A){this._globalState&&(c=Dd(c,this._globalState)),this._evaluator.globals=c,this._evaluator.feature=u||null,this._evaluator.featureState=x||null,this._evaluator.canonical=_,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=A||null;try{const M=this.expression.evaluate(this._evaluator);if(M==null||typeof M=="number"&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new ss(`Expected value to be one of ${Object.keys(this._enumValues).map(F=>JSON.stringify(F)).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,typeof console<"u"&&console.warn(M.message)),this._defaultValue}}}function Up(h){return Array.isArray(h)&&h.length>0&&typeof h[0]=="string"&&h[0]in Xu}function Id(h,c,u){const x=new vn(Xu,$p,[],c?function(C){const A={color:Lo,string:Kr,number:qt,enum:Kr,boolean:rn,formatted:bd,padding:hl,numberArray:Em,colorArray:Ic,projectionDefinition:km,resolvedImage:jd,variableAnchorOffsetCollection:jp};return C.type==="array"?na(A[C.value]||Xr,C.length):A[C.type]}(c):void 0),_=x.parse(h,void 0,void 0,void 0,c&&c.type==="string"?{typeAnnotation:"coerce"}:void 0);return _?Ij(new Av(_,c,u)):Qu(x.errors)}class Hm{constructor(c,u,x){this.kind=c,this._styleExpression=u,this.isStateDependent=c!=="constant"&&!Km(u.expression),this.globalStateRefs=Kp(u.expression),this._globalState=x}evaluateWithoutErrorHandling(c,u,x,_,C,A){return this._globalState&&(c=Dd(c,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(c,u,x,_,C,A)}evaluate(c,u,x,_,C,A){return this._globalState&&(c=Dd(c,this._globalState)),this._styleExpression.evaluate(c,u,x,_,C,A)}}class kv{constructor(c,u,x,_,C){this.kind=c,this.zoomStops=x,this._styleExpression=u,this.isStateDependent=c!=="camera"&&!Km(u.expression),this.globalStateRefs=Kp(u.expression),this.interpolationType=_,this._globalState=C}evaluateWithoutErrorHandling(c,u,x,_,C,A){return this._globalState&&(c=Dd(c,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(c,u,x,_,C,A)}evaluate(c,u,x,_,C,A){return this._globalState&&(c=Dd(c,this._globalState)),this._styleExpression.evaluate(c,u,x,_,C,A)}interpolationFactor(c,u,x){return this.interpolationType?Dn.interpolationFactor(this.interpolationType,c,u,x):0}}function zj(h,c,u){const x=Id(h,c,u);if(x.result==="error")return x;const _=x.value.expression,C=Bp(_);if(!C&&!Ju(c))return Qu([new ya("","data expressions not supported")]);const A=qp(_,["zoom"]);if(!A&&!Dj(c))return Qu([new ya("","zoom expressions not supported")]);const M=Gp(_);return M||A?M instanceof ya?Qu([M]):M instanceof Dn&&!Cv(c)?Qu([new ya("",'"interpolate" expressions cannot be used with this property')]):Ij(M?new kv(C?"camera":"composite",x.value,M.labels,M instanceof Dn?M.interpolation:void 0,u):new Hm(C?"constant":"source",x.value,u)):Qu([new ya("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Wp{constructor(c,u){this._parameters=c,this._specification=u,$s(this,Rj(this._parameters,this._specification))}static deserialize(c){return new Wp(c._parameters,c._specification)}static serialize(c){return{_parameters:c._parameters,_specification:c._specification}}}function Gp(h){let c=null;if(h instanceof Ku)c=Gp(h.result);else if(h instanceof $m){for(const u of h.args)if(c=Gp(u),c)break}else(h instanceof Zu||h instanceof Dn)&&h.input instanceof _o&&h.input.name==="zoom"&&(c=h);return c instanceof ya||h.eachChild(u=>{const x=Gp(u);x instanceof ya?c=x:!c&&x?c=new ya("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):c&&x&&c!==x&&(c=new ya("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),c}function Kp(h,c=new Set){return h instanceof Gm&&c.add(h.key),h.eachChild(u=>{Kp(u,c)}),c}function Dd(h,c){const{zoom:u,heatmapDensity:x,elevation:_,lineProgress:C,isSupportedScript:A,accumulated:M}=h??{};return{zoom:u,heatmapDensity:x,elevation:_,lineProgress:C,isSupportedScript:A,accumulated:M,globalState:c}}function Hp(h){if(h===!0||h===!1)return!0;if(!Array.isArray(h)||h.length===0)return!1;switch(h[0]){case"has":return h.length>=2&&h[1]!=="$id"&&h[1]!=="$type";case"in":return h.length>=3&&(typeof h[1]!="string"||Array.isArray(h[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return h.length!==3||Array.isArray(h[1])||Array.isArray(h[2]);case"any":case"all":for(const c of h.slice(1))if(!Hp(c)&&typeof c!="boolean")return!1;return!0;default:return!0}}const iC={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Zm(h,c){if(h==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Hp(h)||(h=Ym(h));const u=Id(h,iC,c);if(u.result==="error")throw new Error(u.value.map(x=>`${x.key}: ${x.message}`).join(", "));return{filter:(x,_,C)=>u.value.evaluate(x,_,{},C),needGeometry:Tv(h),getGlobalStateRefs:()=>Kp(u.value.expression)}}function $j(h,c){return h<c?-1:h>c?1:0}function Tv(h){if(!Array.isArray(h))return!1;if(h[0]==="within"||h[0]==="distance")return!0;for(let c=1;c<h.length;c++)if(Tv(h[c]))return!0;return!1}function Ym(h){if(!h)return!0;const c=h[0];return h.length<=1?c!=="any":c==="=="?Ev(h[1],h[2],"=="):c==="!="?Zp(Ev(h[1],h[2],"==")):c==="<"||c===">"||c==="<="||c===">="?Ev(h[1],h[2],c):c==="any"?(u=h.slice(1),["any"].concat(u.map(Ym))):c==="all"?["all"].concat(h.slice(1).map(Ym)):c==="none"?["all"].concat(h.slice(1).map(Ym).map(Zp)):c==="in"?Bj(h[1],h.slice(2)):c==="!in"?Zp(Bj(h[1],h.slice(2))):c==="has"?qj(h[1]):c!=="!has"||Zp(qj(h[1]));var u}function Ev(h,c,u){switch(h){case"$type":return[`filter-type-${u}`,c];case"$id":return[`filter-id-${u}`,c];default:return[`filter-${u}`,h,c]}}function Bj(h,c){if(c.length===0)return!1;switch(h){case"$type":return["filter-type-in",["literal",c]];case"$id":return["filter-id-in",["literal",c]];default:return c.length>200&&!c.some(u=>typeof u!=typeof c[0])?["filter-in-large",h,["literal",c.sort($j)]]:["filter-in-small",h,["literal",c]]}}function qj(h){switch(h){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",h]}}function Zp(h){return["!",h]}function Yp(h){const c=typeof h;if(c==="number"||c==="boolean"||c==="string"||h==null)return JSON.stringify(h);if(Array.isArray(h)){let _="[";for(const C of h)_+=`${Yp(C)},`;return`${_}]`}const u=Object.keys(h).sort();let x="{";for(let _=0;_<u.length;_++)x+=`${JSON.stringify(u[_])}:${Yp(h[u[_]])},`;return`${x}}`}function Vj(h){let c="";for(const u of Qr)c+=`/${Yp(h[u])}`;return c}function Xp(h){const c=h.value;return c?[new jt(h.key,c,"constants have been deprecated as of v8")]:[]}function ys(h){return h instanceof Number||h instanceof String||h instanceof Boolean?h.valueOf():h}function Hl(h){if(Array.isArray(h))return h.map(Hl);if(h instanceof Object&&!(h instanceof Number||h instanceof String||h instanceof Boolean)){const c={};for(const u in h)c[u]=Hl(h[u]);return c}return ys(h)}function Ra(h){const c=h.key,u=h.value,x=h.valueSpec||{},_=h.objectElementValidators||{},C=h.style,A=h.styleSpec,M=h.validateSpec;let F=[];const q=dn(u);if(q!=="object")return[new jt(c,u,`object expected, ${q} found`)];for(const V in u){const K=V.split(".")[0],ee=Om(x,K)||x["*"];let re;if(Om(_,K))re=_[K];else if(Om(x,K))re=M;else if(_["*"])re=_["*"];else{if(!x["*"]){F.push(new jt(c,u[V],`unknown property "${V}"`));continue}re=M}F=F.concat(re({key:(c&&`${c}.`)+V,value:u[V],valueSpec:ee,style:C,styleSpec:A,object:u,objectKey:V,validateSpec:M},u))}for(const V in x)_[V]||x[V].required&&x[V].default===void 0&&u[V]===void 0&&F.push(new jt(c,u,`missing required property "${V}"`));return F}function eh(h){const c=h.value,u=h.valueSpec,x=h.style,_=h.styleSpec,C=h.key,A=h.arrayElementValidator||h.validateSpec;if(dn(c)!=="array")return[new jt(C,c,`array expected, ${dn(c)} found`)];if(u.length&&c.length!==u.length)return[new jt(C,c,`array length ${u.length} expected, length ${c.length} found`)];if(u["min-length"]&&c.length<u["min-length"])return[new jt(C,c,`array length at least ${u["min-length"]} expected, length ${c.length} found`)];let M={type:u.value,values:u.values};_.$version<7&&(M.function=u.function),dn(u.value)==="object"&&(M=u.value);let F=[];for(let q=0;q<c.length;q++)F=F.concat(A({array:c,arrayIndex:q,value:c[q],valueSpec:M,validateSpec:h.validateSpec,style:x,styleSpec:_,key:`${C}[${q}]`}));return F}function Qp(h){const c=h.key,u=h.value,x=h.valueSpec;let _=dn(u);return _==="number"&&u!=u&&(_="NaN"),_!=="number"?[new jt(c,u,`number expected, ${_} found`)]:"minimum"in x&&u<x.minimum?[new jt(c,u,`${u} is less than the minimum value ${x.minimum}`)]:"maximum"in x&&u>x.maximum?[new jt(c,u,`${u} is greater than the maximum value ${x.maximum}`)]:[]}function Uj(h){const c=h.valueSpec,u=ys(h.value.type);let x,_,C,A={};const M=u!=="categorical"&&h.value.property===void 0,F=!M,q=dn(h.value.stops)==="array"&&dn(h.value.stops[0])==="array"&&dn(h.value.stops[0][0])==="object",V=Ra({key:h.key,value:h.value,valueSpec:h.styleSpec.function,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{stops:function(re){if(u==="identity")return[new jt(re.key,re.value,'identity function may not have a "stops" property')];let ae=[];const pe=re.value;return ae=ae.concat(eh({key:re.key,value:pe,valueSpec:re.valueSpec,validateSpec:re.validateSpec,style:re.style,styleSpec:re.styleSpec,arrayElementValidator:K})),dn(pe)==="array"&&pe.length===0&&ae.push(new jt(re.key,pe,"array must have at least one stop")),ae},default:function(re){return re.validateSpec({key:re.key,value:re.value,valueSpec:c,validateSpec:re.validateSpec,style:re.style,styleSpec:re.styleSpec})}}});return u==="identity"&&M&&V.push(new jt(h.key,h.value,'missing required property "property"')),u==="identity"||h.value.stops||V.push(new jt(h.key,h.value,'missing required property "stops"')),u==="exponential"&&h.valueSpec.expression&&!Cv(h.valueSpec)&&V.push(new jt(h.key,h.value,"exponential functions not supported")),h.styleSpec.$version>=8&&(F&&!Ju(h.valueSpec)?V.push(new jt(h.key,h.value,"property functions not supported")):M&&!Dj(h.valueSpec)&&V.push(new jt(h.key,h.value,"zoom functions not supported"))),u!=="categorical"&&!q||h.value.property!==void 0||V.push(new jt(h.key,h.value,'"property" property is required')),V;function K(re){let ae=[];const pe=re.value,_e=re.key;if(dn(pe)!=="array")return[new jt(_e,pe,`array expected, ${dn(pe)} found`)];if(pe.length!==2)return[new jt(_e,pe,`array length 2 expected, length ${pe.length} found`)];if(q){if(dn(pe[0])!=="object")return[new jt(_e,pe,`object expected, ${dn(pe[0])} found`)];if(pe[0].zoom===void 0)return[new jt(_e,pe,"object stop key must have zoom")];if(pe[0].value===void 0)return[new jt(_e,pe,"object stop key must have value")];if(C&&C>ys(pe[0].zoom))return[new jt(_e,pe[0].zoom,"stop zoom values must appear in ascending order")];ys(pe[0].zoom)!==C&&(C=ys(pe[0].zoom),_=void 0,A={}),ae=ae.concat(Ra({key:`${_e}[0]`,value:pe[0],valueSpec:{zoom:{}},validateSpec:re.validateSpec,style:re.style,styleSpec:re.styleSpec,objectElementValidators:{zoom:Qp,value:ee}}))}else ae=ae.concat(ee({key:`${_e}[0]`,value:pe[0],validateSpec:re.validateSpec,style:re.style,styleSpec:re.styleSpec},pe));return Up(Hl(pe[1]))?ae.concat([new jt(`${_e}[1]`,pe[1],"expressions are not allowed in function stops.")]):ae.concat(re.validateSpec({key:`${_e}[1]`,value:pe[1],valueSpec:c,validateSpec:re.validateSpec,style:re.style,styleSpec:re.styleSpec}))}function ee(re,ae){const pe=dn(re.value),_e=ys(re.value),Pe=re.value!==null?re.value:ae;if(x){if(pe!==x)return[new jt(re.key,Pe,`${pe} stop domain type must match previous stop domain type ${x}`)]}else x=pe;if(pe!=="number"&&pe!=="string"&&pe!=="boolean")return[new jt(re.key,Pe,"stop domain value must be a number, string, or boolean")];if(pe!=="number"&&u!=="categorical"){let Qe=`number expected, ${pe} found`;return Ju(c)&&u===void 0&&(Qe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new jt(re.key,Pe,Qe)]}return u!=="categorical"||pe!=="number"||isFinite(_e)&&Math.floor(_e)===_e?u!=="categorical"&&pe==="number"&&_!==void 0&&_e<_?[new jt(re.key,Pe,"stop domain values must appear in ascending order")]:(_=_e,u==="categorical"&&_e in A?[new jt(re.key,Pe,"stop domain values must be unique")]:(A[_e]=!0,[])):[new jt(re.key,Pe,`integer expected, found ${_e}`)]}}function th(h){const c=(h.expressionContext==="property"?zj:Id)(Hl(h.value),h.valueSpec);if(c.result==="error")return c.value.map(x=>new jt(`${h.key}${x.key}`,h.value,x.message));const u=c.value.expression||c.value._styleExpression.expression;if(h.expressionContext==="property"&&h.propertyKey==="text-font"&&!u.outputDefined())return[new jt(h.key,h.value,`Invalid data expression for "${h.propertyKey}". Output values must be contained as literals within the expression.`)];if(h.expressionContext==="property"&&h.propertyType==="layout"&&!Km(u))return[new jt(h.key,h.value,'"feature-state" data expressions are not supported with layout properties.')];if(h.expressionContext==="filter"&&!Km(u))return[new jt(h.key,h.value,'"feature-state" data expressions are not supported with filters.')];if(h.expressionContext&&h.expressionContext.indexOf("cluster")===0){if(!qp(u,["zoom","feature-state"]))return[new jt(h.key,h.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(h.expressionContext==="cluster-initial"&&!Bp(u))return[new jt(h.key,h.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Mv(h){const c=h.key,u=h.value,x=dn(u);return x!=="string"?[new jt(c,u,`color expected, ${x} found`)]:Ur.parse(String(u))?[]:[new jt(c,u,`color expected, "${u}" found`)]}function Xm(h){const c=h.key,u=h.value,x=h.valueSpec,_=[];return Array.isArray(x.values)?x.values.indexOf(ys(u))===-1&&_.push(new jt(c,u,`expected one of [${x.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(x.values).indexOf(ys(u))===-1&&_.push(new jt(c,u,`expected one of [${Object.keys(x.values).join(", ")}], ${JSON.stringify(u)} found`)),_}function Ov(h){return Hp(Hl(h.value))?th($s({},h,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Iv(h)}function Iv(h){const c=h.value,u=h.key;if(dn(c)!=="array")return[new jt(u,c,`array expected, ${dn(c)} found`)];const x=h.styleSpec;let _,C=[];if(c.length<1)return[new jt(u,c,"filter array must have at least 1 element")];switch(C=C.concat(Xm({key:`${u}[0]`,value:c[0],valueSpec:x.filter_operator,style:h.style,styleSpec:h.styleSpec})),ys(c[0])){case"<":case"<=":case">":case">=":c.length>=2&&ys(c[1])==="$type"&&C.push(new jt(u,c,`"$type" cannot be use with operator "${c[0]}"`));case"==":case"!=":c.length!==3&&C.push(new jt(u,c,`filter array for operator "${c[0]}" must have 3 elements`));case"in":case"!in":c.length>=2&&(_=dn(c[1]),_!=="string"&&C.push(new jt(`${u}[1]`,c[1],`string expected, ${_} found`)));for(let A=2;A<c.length;A++)_=dn(c[A]),ys(c[1])==="$type"?C=C.concat(Xm({key:`${u}[${A}]`,value:c[A],valueSpec:x.geometry_type,style:h.style,styleSpec:h.styleSpec})):_!=="string"&&_!=="number"&&_!=="boolean"&&C.push(new jt(`${u}[${A}]`,c[A],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let A=1;A<c.length;A++)C=C.concat(Iv({key:`${u}[${A}]`,value:c[A],style:h.style,styleSpec:h.styleSpec}));break;case"has":case"!has":_=dn(c[1]),c.length!==2?C.push(new jt(u,c,`filter array for "${c[0]}" operator must have 2 elements`)):_!=="string"&&C.push(new jt(`${u}[1]`,c[1],`string expected, ${_} found`))}return C}function Dv(h,c){const u=h.key,x=h.validateSpec,_=h.style,C=h.styleSpec,A=h.value,M=h.objectKey,F=C[`${c}_${h.layerType}`];if(!F)return[];const q=M.match(/^(.*)-transition$/);if(c==="paint"&&q&&F[q[1]]&&F[q[1]].transition)return x({key:u,value:A,valueSpec:C.transition,style:_,styleSpec:C});const V=h.valueSpec||F[M];if(!V)return[new jt(u,A,`unknown property "${M}"`)];let K;if(dn(A)==="string"&&Ju(V)&&!V.tokens&&(K=/^{([^}]+)}$/.exec(A)))return[new jt(u,A,`"${M}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(K[1])} }\`.`)];const ee=[];return h.layerType==="symbol"&&M==="text-font"&&Vp(Hl(A))&&ys(A.type)==="identity"&&ee.push(new jt(u,A,'"text-font" does not support identity functions')),ee.concat(x({key:h.key,value:A,valueSpec:V,style:_,styleSpec:C,expressionContext:"property",propertyType:c,propertyKey:M}))}function Qm(h){return Dv(h,"paint")}function Wj(h){return Dv(h,"layout")}function Rv(h){let c=[];const u=h.value,x=h.key,_=h.style,C=h.styleSpec;if(dn(u)!=="object")return[new jt(x,u,`object expected, ${dn(u)} found`)];u.type||u.ref||c.push(new jt(x,u,'either "type" or "ref" is required'));let A=ys(u.type);const M=ys(u.ref);if(u.id){const F=ys(u.id);for(let q=0;q<h.arrayIndex;q++){const V=_.layers[q];ys(V.id)===F&&c.push(new jt(x,u.id,`duplicate layer id "${u.id}", previously used at line ${V.id.__line__}`))}}if("ref"in u){let F;["type","source","source-layer","filter","layout"].forEach(q=>{q in u&&c.push(new jt(x,u[q],`"${q}" is prohibited for ref layers`))}),_.layers.forEach(q=>{ys(q.id)===M&&(F=q)}),F?F.ref?c.push(new jt(x,u.ref,"ref cannot reference another ref layer")):A=ys(F.type):c.push(new jt(x,u.ref,`ref layer "${M}" not found`))}else if(A!=="background")if(u.source){const F=_.sources&&_.sources[u.source],q=F&&ys(F.type);F?q==="vector"&&A==="raster"?c.push(new jt(x,u.source,`layer "${u.id}" requires a raster source`)):q!=="raster-dem"&&A==="hillshade"||q!=="raster-dem"&&A==="color-relief"?c.push(new jt(x,u.source,`layer "${u.id}" requires a raster-dem source`)):q==="raster"&&A!=="raster"?c.push(new jt(x,u.source,`layer "${u.id}" requires a vector source`)):q!=="vector"||u["source-layer"]?q==="raster-dem"&&A!=="hillshade"&&A!=="color-relief"?c.push(new jt(x,u.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):A!=="line"||!u.paint||!u.paint["line-gradient"]||q==="geojson"&&F.lineMetrics||c.push(new jt(x,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):c.push(new jt(x,u,`layer "${u.id}" must specify a "source-layer"`)):c.push(new jt(x,u.source,`source "${u.source}" not found`))}else c.push(new jt(x,u,'missing required property "source"'));return c=c.concat(Ra({key:x,value:u,valueSpec:C.layer,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,objectElementValidators:{"*":()=>[],type:()=>h.validateSpec({key:`${x}.type`,value:u.type,valueSpec:C.layer.type,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,object:u,objectKey:"type"}),filter:Ov,layout:F=>Ra({layer:u,key:F.key,value:F.value,style:F.style,styleSpec:F.styleSpec,validateSpec:F.validateSpec,objectElementValidators:{"*":q=>Wj($s({layerType:A},q))}}),paint:F=>Ra({layer:u,key:F.key,value:F.value,style:F.style,styleSpec:F.styleSpec,validateSpec:F.validateSpec,objectElementValidators:{"*":q=>Qm($s({layerType:A},q))}})}})),c}function zc(h){const c=h.value,u=h.key,x=dn(c);return x!=="string"?[new jt(u,c,`string expected, ${x} found`)]:[]}const Gj={promoteId:function({key:h,value:c}){if(dn(c)==="string")return zc({key:h,value:c});{const u=[];for(const x in c)u.push(...zc({key:`${h}.${x}`,value:c[x]}));return u}}};function Lv(h){const c=h.value,u=h.key,x=h.styleSpec,_=h.style,C=h.validateSpec;if(!c.type)return[new jt(u,c,'"type" is required')];const A=ys(c.type);let M;switch(A){case"vector":case"raster":return M=Ra({key:u,value:c,valueSpec:x[`source_${A.replace("-","_")}`],style:h.style,styleSpec:x,objectElementValidators:Gj,validateSpec:C}),M;case"raster-dem":return M=function(F){var q;const V=(q=F.sourceName)!==null&&q!==void 0?q:"",K=F.value,ee=F.styleSpec,re=ee.source_raster_dem,ae=F.style;let pe=[];const _e=dn(K);if(K===void 0)return pe;if(_e!=="object")return pe.push(new jt("source_raster_dem",K,`object expected, ${_e} found`)),pe;const Pe=ys(K.encoding)==="custom",Qe=["redFactor","greenFactor","blueFactor","baseShift"],Re=F.value.encoding?`"${F.value.encoding}"`:"Default";for(const $e in K)!Pe&&Qe.includes($e)?pe.push(new jt($e,K[$e],`In "${V}": "${$e}" is only valid when "encoding" is set to "custom". ${Re} encoding found`)):re[$e]?pe=pe.concat(F.validateSpec({key:$e,value:K[$e],valueSpec:re[$e],validateSpec:F.validateSpec,style:ae,styleSpec:ee})):pe.push(new jt($e,K[$e],`unknown property "${$e}"`));return pe}({sourceName:u,value:c,style:h.style,styleSpec:x,validateSpec:C}),M;case"geojson":if(M=Ra({key:u,value:c,valueSpec:x.source_geojson,style:_,styleSpec:x,validateSpec:C,objectElementValidators:Gj}),c.cluster)for(const F in c.clusterProperties){const[q,V]=c.clusterProperties[F],K=typeof q=="string"?[q,["accumulated"],["get",F]]:q;M.push(...th({key:`${u}.${F}.map`,value:V,expressionContext:"cluster-map"})),M.push(...th({key:`${u}.${F}.reduce`,value:K,expressionContext:"cluster-reduce"}))}return M;case"video":return Ra({key:u,value:c,valueSpec:x.source_video,style:_,validateSpec:C,styleSpec:x});case"image":return Ra({key:u,value:c,valueSpec:x.source_image,style:_,validateSpec:C,styleSpec:x});case"canvas":return[new jt(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Xm({key:`${u}.type`,value:c.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Fv(h){const c=h.value,u=h.styleSpec,x=u.light,_=h.style;let C=[];const A=dn(c);if(c===void 0)return C;if(A!=="object")return C=C.concat([new jt("light",c,`object expected, ${A} found`)]),C;for(const M in c){const F=M.match(/^(.*)-transition$/);C=C.concat(F&&x[F[1]]&&x[F[1]].transition?h.validateSpec({key:M,value:c[M],valueSpec:u.transition,validateSpec:h.validateSpec,style:_,styleSpec:u}):x[M]?h.validateSpec({key:M,value:c[M],valueSpec:x[M],validateSpec:h.validateSpec,style:_,styleSpec:u}):[new jt(M,c[M],`unknown property "${M}"`)])}return C}function rh(h){const c=h.value,u=h.styleSpec,x=u.sky,_=h.style,C=dn(c);if(c===void 0)return[];if(C!=="object")return[new jt("sky",c,`object expected, ${C} found`)];let A=[];for(const M in c)A=A.concat(x[M]?h.validateSpec({key:M,value:c[M],valueSpec:x[M],style:_,styleSpec:u}):[new jt(M,c[M],`unknown property "${M}"`)]);return A}function Kj(h){const c=h.value,u=h.styleSpec,x=u.terrain,_=h.style;let C=[];const A=dn(c);if(c===void 0)return C;if(A!=="object")return C=C.concat([new jt("terrain",c,`object expected, ${A} found`)]),C;for(const M in c)C=C.concat(x[M]?h.validateSpec({key:M,value:c[M],valueSpec:x[M],validateSpec:h.validateSpec,style:_,styleSpec:u}):[new jt(M,c[M],`unknown property "${M}"`)]);return C}function Hj(h){let c=[];const u=h.value,x=h.key;if(Array.isArray(u)){const _=[],C=[];for(const A in u)u[A].id&&_.includes(u[A].id)&&c.push(new jt(x,u,`all the sprites' ids must be unique, but ${u[A].id} is duplicated`)),_.push(u[A].id),u[A].url&&C.includes(u[A].url)&&c.push(new jt(x,u,`all the sprites' URLs must be unique, but ${u[A].url} is duplicated`)),C.push(u[A].url),c=c.concat(Ra({key:`${x}[${A}]`,value:u[A],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:h.validateSpec}));return c}return zc({key:x,value:u})}function Zj(h){return c=h.value,c&&c.constructor===Object?[]:[new jt(h.key,h.value,`object expected, ${dn(h.value)} found`)];var c}const Yj={"*":()=>[],array:eh,boolean:function(h){const c=h.value,u=h.key,x=dn(c);return x!=="boolean"?[new jt(u,c,`boolean expected, ${x} found`)]:[]},number:Qp,color:Mv,constants:Xp,enum:Xm,filter:Ov,function:Uj,layer:Rv,object:Ra,source:Lv,light:Fv,sky:rh,terrain:Kj,projection:function(h){const c=h.value,u=h.styleSpec,x=u.projection,_=h.style,C=dn(c);if(c===void 0)return[];if(C!=="object")return[new jt("projection",c,`object expected, ${C} found`)];let A=[];for(const M in c)A=A.concat(x[M]?h.validateSpec({key:M,value:c[M],valueSpec:x[M],style:_,styleSpec:u}):[new jt(M,c[M],`unknown property "${M}"`)]);return A},projectionDefinition:function(h){const c=h.key;let u=h.value;u=u instanceof String?u.valueOf():u;const x=dn(u);return x!=="array"||function(_){return Array.isArray(_)&&_.length===3&&typeof _[0]=="string"&&typeof _[1]=="string"&&typeof _[2]=="number"}(u)||function(_){return!!["interpolate","step","literal"].includes(_[0])}(u)?["array","string"].includes(x)?[]:[new jt(c,u,`projection expected, invalid type "${x}" found`)]:[new jt(c,u,`projection expected, invalid array ${JSON.stringify(u)} found`)]},string:zc,formatted:function(h){return zc(h).length===0?[]:th(h)},resolvedImage:function(h){return zc(h).length===0?[]:th(h)},padding:function(h){const c=h.key,u=h.value;if(dn(u)==="array"){if(u.length<1||u.length>4)return[new jt(c,u,`padding requires 1 to 4 values; ${u.length} values found`)];const x={type:"number"};let _=[];for(let C=0;C<u.length;C++)_=_.concat(h.validateSpec({key:`${c}[${C}]`,value:u[C],validateSpec:h.validateSpec,valueSpec:x}));return _}return Qp({key:c,value:u,valueSpec:{}})},numberArray:function(h){const c=h.key,u=h.value;if(dn(u)==="array"){const x={type:"number"};if(u.length<1)return[new jt(c,u,"array length at least 1 expected, length 0 found")];let _=[];for(let C=0;C<u.length;C++)_=_.concat(h.validateSpec({key:`${c}[${C}]`,value:u[C],validateSpec:h.validateSpec,valueSpec:x}));return _}return Qp({key:c,value:u,valueSpec:{}})},colorArray:function(h){const c=h.key,u=h.value;if(dn(u)==="array"){if(u.length<1)return[new jt(c,u,"array length at least 1 expected, length 0 found")];let x=[];for(let _=0;_<u.length;_++)x=x.concat(Mv({key:`${c}[${_}]`,value:u[_]}));return x}return Mv({key:c,value:u})},variableAnchorOffsetCollection:function(h){const c=h.key,u=h.value,x=dn(u),_=h.styleSpec;if(x!=="array"||u.length<1||u.length%2!=0)return[new jt(c,u,"variableAnchorOffsetCollection requires a non-empty array of even length")];let C=[];for(let A=0;A<u.length;A+=2)C=C.concat(Xm({key:`${c}[${A}]`,value:u[A],valueSpec:_.layout_symbol["text-anchor"]})),C=C.concat(eh({key:`${c}[${A+1}]`,value:u[A+1],valueSpec:{length:2,value:"number"},validateSpec:h.validateSpec,style:h.style,styleSpec:_}));return C},sprite:Hj,state:Zj};function Jp(h){const c=h.value,u=h.valueSpec,x=h.styleSpec;return h.validateSpec=Jp,u.expression&&Vp(ys(c))?Uj(h):u.expression&&Up(Hl(c))?th(h):u.type&&Yj[u.type]?Yj[u.type](h):Ra($s({},h,{valueSpec:u.type?x[u.type]:u}))}function Xj(h){const c=h.value,u=h.key,x=zc(h);return x.length||(c.indexOf("{fontstack}")===-1&&x.push(new jt(u,c,'"glyphs" url must include a "{fontstack}" token')),c.indexOf("{range}")===-1&&x.push(new jt(u,c,'"glyphs" url must include a "{range}" token'))),x}function aa(h,c=Je){let u=[];return u=u.concat(Jp({key:"",value:h,valueSpec:c.$root,styleSpec:c,style:h,validateSpec:Jp,objectElementValidators:{glyphs:Xj,"*":()=>[]}})),h.constants&&(u=u.concat(Xp({key:"constants",value:h.constants}))),La(u)}function _a(h){return function(c){return h(Object.assign({},c,{validateSpec:Jp}))}}function La(h){return[].concat(h).sort((c,u)=>c.line-u.line)}function ba(h){return function(...c){return La(h.apply(this,c))}}aa.source=ba(_a(Lv)),aa.sprite=ba(_a(Hj)),aa.glyphs=ba(_a(Xj)),aa.light=ba(_a(Fv)),aa.sky=ba(_a(rh)),aa.terrain=ba(_a(Kj)),aa.state=ba(_a(Zj)),aa.layer=ba(_a(Rv)),aa.filter=ba(_a(Ov)),aa.paintProperty=ba(_a(Qm)),aa.layoutProperty=ba(_a(Wj));const Qj=Je,nh=aa,aC=nh.light,Jm=nh.sky,Jj=nh.paintProperty,zv=nh.layoutProperty;function ew(h,c){let u=!1;if(c&&c.length)for(const x of c)h.fire(new yt(new Error(x.message))),u=!0;return u}class Rd{constructor(c,u,x){const _=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;const A=new Int32Array(this.arrayBuffer);c=A[0],this.d=(u=A[1])+2*(x=A[2]);for(let F=0;F<this.d*this.d;F++){const q=A[3+F],V=A[3+F+1];_.push(q===V?null:A.subarray(q,V))}const M=A[3+_.length+1];this.keys=A.subarray(A[3+_.length],M),this.bboxes=A.subarray(M),this.insert=this._insertReadonly}else{this.d=u+2*x;for(let A=0;A<this.d*this.d;A++)_.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=c,this.padding=x,this.scale=u/c,this.uid=0;const C=x/u*c;this.min=-C,this.max=c+C}insert(c,u,x,_,C){this._forEachCell(u,x,_,C,this._insertCell,this.uid++,void 0,void 0),this.keys.push(c),this.bboxes.push(u),this.bboxes.push(x),this.bboxes.push(_),this.bboxes.push(C)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(c,u,x,_,C,A){this.cells[C].push(A)}query(c,u,x,_,C){const A=this.min,M=this.max;if(c<=A&&u<=A&&M<=x&&M<=_&&!C)return Array.prototype.slice.call(this.keys);{const F=[];return this._forEachCell(c,u,x,_,this._queryCell,F,{},C),F}}_queryCell(c,u,x,_,C,A,M,F){const q=this.cells[C];if(q!==null){const V=this.keys,K=this.bboxes;for(let ee=0;ee<q.length;ee++){const re=q[ee];if(M[re]===void 0){const ae=4*re;(F?F(K[ae+0],K[ae+1],K[ae+2],K[ae+3]):c<=K[ae+2]&&u<=K[ae+3]&&x>=K[ae+0]&&_>=K[ae+1])?(M[re]=!0,A.push(V[re])):M[re]=!1}}}}_forEachCell(c,u,x,_,C,A,M,F){const q=this._convertToCellCoord(c),V=this._convertToCellCoord(u),K=this._convertToCellCoord(x),ee=this._convertToCellCoord(_);for(let re=q;re<=K;re++)for(let ae=V;ae<=ee;ae++){const pe=this.d*ae+re;if((!F||F(this._convertFromCellCoord(re),this._convertFromCellCoord(ae),this._convertFromCellCoord(re+1),this._convertFromCellCoord(ae+1)))&&C.call(this,c,u,x,_,pe,A,M,F))return}}_convertFromCellCoord(c){return(c-this.padding)/this.scale}_convertToCellCoord(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const c=this.cells,u=3+this.cells.length+1+1;let x=0;for(let A=0;A<this.cells.length;A++)x+=this.cells[A].length;const _=new Int32Array(u+x+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;let C=u;for(let A=0;A<c.length;A++){const M=c[A];_[3+A]=C,_.set(M,C),C+=M.length}return _[3+c.length]=C,_.set(this.keys,C),C+=this.keys.length,_[3+c.length+1]=C,_.set(this.bboxes,C),C+=this.bboxes.length,_.buffer}static serialize(c,u){const x=c.toArrayBuffer();return u&&u.push(x),{buffer:x}}static deserialize(c){return new Rd(c.buffer)}}const Zl={};function er(h,c,u={}){if(Zl[h])throw new Error(`${h} is already registered.`);Object.defineProperty(c,"_classRegistryKey",{value:h,writeable:!1}),Zl[h]={klass:c,omit:u.omit||[],shallow:u.shallow||[]}}er("Object",Object),er("Set",Set),er("TransferableGridIndex",Rd),er("Color",Ur),er("Error",Error),er("AJAXError",Ae),er("ResolvedImage",va),er("StylePropertyFunction",Wp),er("StyleExpression",Av,{omit:["_evaluator"]}),er("ZoomDependentExpression",kv),er("ZoomConstantExpression",Hm),er("CompoundExpression",_o,{omit:["_evaluate"]});for(const h in Xu)Xu[h]._classRegistryKey||er(`Expression_${h}`,Xu[h]);function tw(h){return h&&typeof ArrayBuffer<"u"&&(h instanceof ArrayBuffer||h.constructor&&h.constructor.name==="ArrayBuffer")}function $v(h){return h.$name||h.constructor._classRegistryKey}function rw(h){return!function(c){if(c===null||typeof c!="object")return!1;const u=$v(c);return!(!u||u==="Object")}(h)&&(h==null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp||h instanceof Blob||h instanceof Error||tw(h)||Yn(h)||ArrayBuffer.isView(h)||h instanceof ImageData)}function Yl(h,c){if(rw(h))return(tw(h)||Yn(h))&&c&&c.push(h),ArrayBuffer.isView(h)&&c&&c.push(h.buffer),h instanceof ImageData&&c&&c.push(h.data.buffer),h;if(Array.isArray(h)){const C=[];for(const A of h)C.push(Yl(A,c));return C}if(typeof h!="object")throw new Error("can't serialize object of type "+typeof h);const u=$v(h);if(!u)throw new Error(`can't serialize object of unregistered class ${h.constructor.name}`);if(!Zl[u])throw new Error(`${u} is not registered.`);const{klass:x}=Zl[u],_=x.serialize?x.serialize(h,c):{};if(x.serialize){if(c&&_===c[c.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const C in h){if(!h.hasOwnProperty(C)||Zl[u].omit.indexOf(C)>=0)continue;const A=h[C];_[C]=Zl[u].shallow.indexOf(C)>=0?A:Yl(A,c)}h instanceof Error&&(_.message=h.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(_.$name=u),_}function ef(h){if(rw(h))return h;if(Array.isArray(h))return h.map(ef);if(typeof h!="object")throw new Error("can't deserialize object of type "+typeof h);const c=$v(h)||"Object";if(!Zl[c])throw new Error(`can't deserialize unregistered class ${c}`);const{klass:u}=Zl[c];if(!u)throw new Error(`can't deserialize unregistered class ${c}`);if(u.deserialize)return u.deserialize(h);const x=Object.create(u.prototype);for(const _ of Object.keys(h)){if(_==="$name")continue;const C=h[_];x[_]=Zl[c].shallow.indexOf(_)>=0?C:ef(C)}return x}class Bv{constructor(){this.first=!0}update(c,u){const x=Math.floor(c);return this.first?(this.first=!1,this.lastIntegerZoom=x,this.lastIntegerZoomTime=0,this.lastZoom=c,this.lastFloorZoom=x,!0):(this.lastFloorZoom>x?(this.lastIntegerZoom=x+1,this.lastIntegerZoomTime=u):this.lastFloorZoom<x&&(this.lastIntegerZoom=x,this.lastIntegerZoomTime=u),c!==this.lastZoom&&(this.lastZoom=c,this.lastFloorZoom=x,!0))}}const sn={"Latin-1 Supplement":h=>h>=128&&h<=255,"Hangul Jamo":h=>h>=4352&&h<=4607,Khmer:h=>h>=6016&&h<=6143,"General Punctuation":h=>h>=8192&&h<=8303,"Letterlike Symbols":h=>h>=8448&&h<=8527,"Number Forms":h=>h>=8528&&h<=8591,"Miscellaneous Technical":h=>h>=8960&&h<=9215,"Control Pictures":h=>h>=9216&&h<=9279,"Optical Character Recognition":h=>h>=9280&&h<=9311,"Enclosed Alphanumerics":h=>h>=9312&&h<=9471,"Geometric Shapes":h=>h>=9632&&h<=9727,"Miscellaneous Symbols":h=>h>=9728&&h<=9983,"Miscellaneous Symbols and Arrows":h=>h>=11008&&h<=11263,"Ideographic Description Characters":h=>h>=12272&&h<=12287,"CJK Symbols and Punctuation":h=>h>=12288&&h<=12351,Hiragana:h=>h>=12352&&h<=12447,Katakana:h=>h>=12448&&h<=12543,Kanbun:h=>h>=12688&&h<=12703,"CJK Strokes":h=>h>=12736&&h<=12783,"Enclosed CJK Letters and Months":h=>h>=12800&&h<=13055,"CJK Compatibility":h=>h>=13056&&h<=13311,"Yijing Hexagram Symbols":h=>h>=19904&&h<=19967,"CJK Unified Ideographs":h=>h>=19968&&h<=40959,"Hangul Syllables":h=>h>=44032&&h<=55215,"Private Use Area":h=>h>=57344&&h<=63743,"Vertical Forms":h=>h>=65040&&h<=65055,"CJK Compatibility Forms":h=>h>=65072&&h<=65103,"Small Form Variants":h=>h>=65104&&h<=65135,"Halfwidth and Fullwidth Forms":h=>h>=65280&&h<=65519};function qv(h){for(const c of h)if(ex(c.charCodeAt(0)))return!0;return!1}function Vv(h){for(const c of h)if(!sw(c.charCodeAt(0)))return!1;return!0}function sh(h){const c=h.map(u=>{try{return new RegExp(`\\p{sc=${u}}`,"u").source}catch{return null}}).filter(u=>u);return new RegExp(c.join("|"),"u")}const nw=sh(["Arab","Dupl","Mong","Ougr","Syrc"]);function sw(h){return!nw.test(String.fromCodePoint(h))}const Uv=sh(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function ex(h){return!(h!==746&&h!==747&&(h<4352||!(sn["CJK Compatibility Forms"](h)&&!(h>=65097&&h<=65103)||sn["CJK Compatibility"](h)||sn["CJK Strokes"](h)||!(!sn["CJK Symbols and Punctuation"](h)||h>=12296&&h<=12305||h>=12308&&h<=12319||h===12336)||sn["Enclosed CJK Letters and Months"](h)||sn["Ideographic Description Characters"](h)||sn.Kanbun(h)||sn.Katakana(h)&&h!==12540||!(!sn["Halfwidth and Fullwidth Forms"](h)||h===65288||h===65289||h===65293||h>=65306&&h<=65310||h===65339||h===65341||h===65343||h>=65371&&h<=65503||h===65507||h>=65512&&h<=65519)||!(!sn["Small Form Variants"](h)||h>=65112&&h<=65118||h>=65123&&h<=65126)||sn["Vertical Forms"](h)||sn["Yijing Hexagram Symbols"](h)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(h))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(h))||Uv.test(String.fromCodePoint(h)))))}function tx(h){return!(ex(h)||function(c){return!!(sn["Latin-1 Supplement"](c)&&(c===167||c===169||c===174||c===177||c===188||c===189||c===190||c===215||c===247)||sn["General Punctuation"](c)&&(c===8214||c===8224||c===8225||c===8240||c===8241||c===8251||c===8252||c===8258||c===8263||c===8264||c===8265||c===8273)||sn["Letterlike Symbols"](c)||sn["Number Forms"](c)||sn["Miscellaneous Technical"](c)&&(c>=8960&&c<=8967||c>=8972&&c<=8991||c>=8996&&c<=9e3||c===9003||c>=9085&&c<=9114||c>=9150&&c<=9165||c===9167||c>=9169&&c<=9179||c>=9186&&c<=9215)||sn["Control Pictures"](c)&&c!==9251||sn["Optical Character Recognition"](c)||sn["Enclosed Alphanumerics"](c)||sn["Geometric Shapes"](c)||sn["Miscellaneous Symbols"](c)&&!(c>=9754&&c<=9759)||sn["Miscellaneous Symbols and Arrows"](c)&&(c>=11026&&c<=11055||c>=11088&&c<=11097||c>=11192&&c<=11243)||sn["CJK Symbols and Punctuation"](c)||sn.Katakana(c)||sn["Private Use Area"](c)||sn["CJK Compatibility Forms"](c)||sn["Small Form Variants"](c)||sn["Halfwidth and Fullwidth Forms"](c)||c===8734||c===8756||c===8757||c>=9984&&c<=10087||c>=10102&&c<=10131||c===65532||c===65533)}(h))}const iw=sh(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function aw(h){return iw.test(String.fromCodePoint(h))}function ow(h,c){return!(!c&&aw(h)||h>=2304&&h<=3583||h>=3840&&h<=4255||sn.Khmer(h))}function oC(h){for(const c of h)if(aw(c.charCodeAt(0)))return!0;return!1}const Xl=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(h){this.pluginStatus=h.pluginStatus,this.pluginURL=h.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(h){if(Xl.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=h.applyArabicShaping,this.processBidirectionalText=h.processBidirectionalText,this.processStyledBidirectionalText=h.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(h,c){return a(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(h.pluginStatus!=="loading")return this.setState(h),h;const u=h.pluginURL,x=new Promise(C=>{this.loadScriptResolve=C});c(u);const _=new Promise(C=>setTimeout(()=>C(),this.TIMEOUT));if(yield Promise.race([x,_]),this.isParsed()){const C={pluginStatus:"loaded",pluginURL:u};return this.setState(C),C}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${u}`)})}};class Gn{constructor(c,u){this.isSupportedScript=lw,this.zoom=c,u?(this.now=u.now||0,this.fadeDuration=u.fadeDuration||0,this.zoomHistory=u.zoomHistory||new Bv,this.transition=u.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Bv,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const c=this.zoom,u=c-Math.floor(c),x=this.crossFadingFactor();return c>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:u+(1-u)*x}:{fromScale:.5,toScale:1,t:1-(1-x)*u}}}function lw(h){return function(c,u){for(const x of c)if(!ow(x.charCodeAt(0),u))return!1;return!0}(h,Xl.getRTLTextPluginStatus()==="loaded")}class tf{constructor(c,u,x){this.property=c,this.value=u,this.expression=function(_,C,A){if(Vp(_))return new Wp(_,C);if(Up(_)){const M=zj(_,C,A);if(M.result==="error")throw new Error(M.value.map(F=>`${F.key}: ${F.message}`).join(", "));return M.value}{let M=_;return C.type==="color"&&typeof _=="string"?M=Ur.parse(_):C.type!=="padding"||typeof _!="number"&&!Array.isArray(_)?C.type!=="numberArray"||typeof _!="number"&&!Array.isArray(_)?C.type!=="colorArray"||typeof _!="string"&&!Array.isArray(_)?C.type==="variableAnchorOffsetCollection"&&Array.isArray(_)?M=ia.parse(_):C.type==="projectionDefinition"&&typeof _=="string"&&(M=Ja.parse(_)):M=Qs.parse(_):M=Vi.parse(_):M=sa.parse(_),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>M}}}(u===void 0?c.specification.default:u,c.specification,x)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(c,u,x){return this.property.possiblyEvaluate(this,c,u,x)}}class Wv{constructor(c,u){this.property=c,this.value=new tf(c,void 0,u)}transitioned(c,u){return new Gv(this.property,this.value,u,_r({},c.transition,this.transition),c.now)}untransitioned(){return new Gv(this.property,this.value,null,{},0)}}class cw{constructor(c,u){this._properties=c,this._values=Object.create(c.defaultTransitionablePropertyValues),this._globalState=u}getValue(c){return pt(this._values[c].value.value)}setValue(c,u){Object.prototype.hasOwnProperty.call(this._values,c)||(this._values[c]=new Wv(this._values[c].property,this._globalState)),this._values[c].value=new tf(this._values[c].property,u===null?void 0:pt(u),this._globalState)}getTransition(c){return pt(this._values[c].transition)}setTransition(c,u){Object.prototype.hasOwnProperty.call(this._values,c)||(this._values[c]=new Wv(this._values[c].property,this._globalState)),this._values[c].transition=pt(u)||void 0}serialize(){const c={};for(const u of Object.keys(this._values)){const x=this.getValue(u);x!==void 0&&(c[u]=x);const _=this.getTransition(u);_!==void 0&&(c[`${u}-transition`]=_)}return c}transitioned(c,u){const x=new Kv(this._properties);for(const _ of Object.keys(this._values))x._values[_]=this._values[_].transitioned(c,u._values[_]);return x}untransitioned(){const c=new Kv(this._properties);for(const u of Object.keys(this._values))c._values[u]=this._values[u].untransitioned();return c}}class Gv{constructor(c,u,x,_,C){this.property=c,this.value=u,this.begin=C+_.delay||0,this.end=this.begin+_.duration||0,c.specification.transition&&(_.delay||_.duration)&&(this.prior=x)}possiblyEvaluate(c,u,x){const _=c.now||0,C=this.value.possiblyEvaluate(c,u,x),A=this.prior;if(A){if(_>this.end)return this.prior=null,C;if(this.value.isDataDriven())return this.prior=null,C;if(_<this.begin)return A.possiblyEvaluate(c,u,x);{const M=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(A.possiblyEvaluate(c,u,x),C,Et(M))}}return C}}class Kv{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitioningPropertyValues)}possiblyEvaluate(c,u,x){const _=new Ld(this._properties);for(const C of Object.keys(this._values))_._values[C]=this._values[C].possiblyEvaluate(c,u,x);return _}hasTransition(){for(const c of Object.keys(this._values))if(this._values[c].prior)return!0;return!1}}class dw{constructor(c,u){this._properties=c,this._values=Object.create(c.defaultPropertyValues),this._globalState=u}hasValue(c){return this._values[c].value!==void 0}getValue(c){return pt(this._values[c].value)}setValue(c,u){this._values[c]=new tf(this._values[c].property,u===null?void 0:pt(u),this._globalState)}serialize(){const c={};for(const u of Object.keys(this._values)){const x=this.getValue(u);x!==void 0&&(c[u]=x)}return c}possiblyEvaluate(c,u,x){const _=new Ld(this._properties);for(const C of Object.keys(this._values))_._values[C]=this._values[C].possiblyEvaluate(c,u,x);return _}}class zo{constructor(c,u,x){this.property=c,this.value=u,this.parameters=x}isConstant(){return this.value.kind==="constant"}constantOr(c){return this.value.kind==="constant"?this.value.value:c}evaluate(c,u,x,_){return this.property.evaluate(this.value,this.parameters,c,u,x,_)}}class Ld{constructor(c){this._properties=c,this._values=Object.create(c.defaultPossiblyEvaluatedValues)}get(c){return this._values[c]}}class pr{constructor(c){this.specification=c}possiblyEvaluate(c,u){if(c.isDataDriven())throw new Error("Value should not be data driven");return c.expression.evaluate(u)}interpolate(c,u,x){const _=vo[this.specification.type];return _?_(c,u,x):c}}class Ir{constructor(c,u){this.specification=c,this.overrides=u}possiblyEvaluate(c,u,x,_){return new zo(this,c.expression.kind==="constant"||c.expression.kind==="camera"?{kind:"constant",value:c.expression.evaluate(u,null,{},x,_)}:c.expression,u)}interpolate(c,u,x){if(c.value.kind!=="constant"||u.value.kind!=="constant")return c;if(c.value.value===void 0||u.value.value===void 0)return new zo(this,{kind:"constant",value:void 0},c.parameters);const _=vo[this.specification.type];if(_){const C=_(c.value.value,u.value.value,x);return new zo(this,{kind:"constant",value:C},c.parameters)}return c}evaluate(c,u,x,_,C,A){return c.kind==="constant"?c.value:c.evaluate(u,x,_,C,A)}}class rf extends Ir{possiblyEvaluate(c,u,x,_){if(c.value===void 0)return new zo(this,{kind:"constant",value:void 0},u);if(c.expression.kind==="constant"){const C=c.expression.evaluate(u,null,{},x,_),A=c.property.specification.type==="resolvedImage"&&typeof C!="string"?C.name:C,M=this._calculate(A,A,A,u);return new zo(this,{kind:"constant",value:M},u)}if(c.expression.kind==="camera"){const C=this._calculate(c.expression.evaluate({zoom:u.zoom-1}),c.expression.evaluate({zoom:u.zoom}),c.expression.evaluate({zoom:u.zoom+1}),u);return new zo(this,{kind:"constant",value:C},u)}return new zo(this,c.expression,u)}evaluate(c,u,x,_,C,A){if(c.kind==="source"){const M=c.evaluate(u,x,_,C,A);return this._calculate(M,M,M,u)}return c.kind==="composite"?this._calculate(c.evaluate({zoom:Math.floor(u.zoom)-1},x,_),c.evaluate({zoom:Math.floor(u.zoom)},x,_),c.evaluate({zoom:Math.floor(u.zoom)+1},x,_),u):c.value}_calculate(c,u,x,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:c,to:u}:{from:x,to:u}}interpolate(c){return c}}class uw{constructor(c){this.specification=c}possiblyEvaluate(c,u,x,_){if(c.value!==void 0){if(c.expression.kind==="constant"){const C=c.expression.evaluate(u,null,{},x,_);return this._calculate(C,C,C,u)}return this._calculate(c.expression.evaluate(new Gn(Math.floor(u.zoom-1),u)),c.expression.evaluate(new Gn(Math.floor(u.zoom),u)),c.expression.evaluate(new Gn(Math.floor(u.zoom+1),u)),u)}}_calculate(c,u,x,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:c,to:u}:{from:x,to:u}}interpolate(c){return c}}class nf{constructor(c){this.specification=c}possiblyEvaluate(c,u,x,_){return!!c.expression.evaluate(u,null,{},x,_)}interpolate(){return!1}}class oa{constructor(c){this.properties=c,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const u in c){const x=c[u];x.specification.overridable&&this.overridableProperties.push(u);const _=this.defaultPropertyValues[u]=new tf(x,void 0,void 0),C=this.defaultTransitionablePropertyValues[u]=new Wv(x,void 0);this.defaultTransitioningPropertyValues[u]=C.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=_.possiblyEvaluate({})}}}er("DataDrivenProperty",Ir),er("DataConstantProperty",pr),er("CrossFadedDataDrivenProperty",rf),er("CrossFadedProperty",uw),er("ColorRampProperty",nf);const Hv="-transition";class $o extends lr{constructor(c,u,x){if(super(),this.id=c.id,this.type=c.type,this._globalState=x,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},c.type!=="custom"&&(this.metadata=c.metadata,this.minzoom=c.minzoom,this.maxzoom=c.maxzoom,c.type!=="background"&&(this.source=c.source,this.sourceLayer=c["source-layer"],this.filter=c.filter,this._featureFilter=Zm(c.filter,x)),u.layout&&(this._unevaluatedLayout=new dw(u.layout,x)),u.paint)){this._transitionablePaint=new cw(u.paint,x);for(const _ in c.paint)this.setPaintProperty(_,c.paint[_],{validate:!1});for(const _ in c.layout)this.setLayoutProperty(_,c.layout[_],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ld(u.paint)}}setFilter(c){this.filter=c,this._featureFilter=Zm(c,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(c){return c==="visibility"?this.visibility:this._unevaluatedLayout.getValue(c)}getLayoutAffectingGlobalStateRefs(){const c=new Set;if(this._unevaluatedLayout)for(const u in this._unevaluatedLayout._values){const x=this._unevaluatedLayout._values[u];for(const _ of x.getGlobalStateRefs())c.add(_)}for(const u of this._featureFilter.getGlobalStateRefs())c.add(u);return c}getPaintAffectingGlobalStateRefs(){var c;const u=new globalThis.Map;if(this._transitionablePaint)for(const x in this._transitionablePaint._values){const _=this._transitionablePaint._values[x].value;for(const C of _.getGlobalStateRefs()){const A=(c=u.get(C))!==null&&c!==void 0?c:[];A.push({name:x,value:_.value}),u.set(C,A)}}return u}setLayoutProperty(c,u,x={}){u!=null&&this._validate(zv,`layers.${this.id}.layout.${c}`,c,u,x)||(c!=="visibility"?this._unevaluatedLayout.setValue(c,u):this.visibility=u)}getPaintProperty(c){return c.endsWith(Hv)?this._transitionablePaint.getTransition(c.slice(0,-11)):this._transitionablePaint.getValue(c)}setPaintProperty(c,u,x={}){if(u!=null&&this._validate(Jj,`layers.${this.id}.paint.${c}`,c,u,x))return!1;if(c.endsWith(Hv))return this._transitionablePaint.setTransition(c.slice(0,-11),u||void 0),!1;{const _=this._transitionablePaint._values[c],C=_.property.specification["property-type"]==="cross-faded-data-driven",A=_.value.isDataDriven(),M=_.value;this._transitionablePaint.setValue(c,u),this._handleSpecialPaintPropertyUpdate(c);const F=this._transitionablePaint._values[c].value;return F.isDataDriven()||A||C||this._handleOverridablePaintPropertyUpdate(c,M,F)}}_handleSpecialPaintPropertyUpdate(c){}_handleOverridablePaintPropertyUpdate(c,u,x){return!1}isHidden(c,u=!1){return!!(this.minzoom&&c<(u?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&c>=this.maxzoom)||this.visibility==="none"}updateTransitions(c){this._transitioningPaint=this._transitionablePaint.transitioned(c,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(c,u){c.getCrossfadeParameters&&(this._crossfadeParameters=c.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(c,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(c,void 0,u)}serialize(){const c={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(c.layout=c.layout||{},c.layout.visibility=this.visibility),rr(c,(u,x)=>!(u===void 0||x==="layout"&&!Object.keys(u).length||x==="paint"&&!Object.keys(u).length))}_validate(c,u,x,_,C={}){return(!C||C.validate!==!1)&&ew(this,c.call(nh,{key:u,layerType:this.type,objectKey:x,value:_,styleSpec:Je,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const c in this.paint._values){const u=this.paint.get(c);if(u instanceof zo&&Ju(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1}}let hw;var lC={get paint(){return hw=hw||new oa({"raster-opacity":new pr(Je.paint_raster["raster-opacity"]),"raster-hue-rotate":new pr(Je.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new pr(Je.paint_raster["raster-brightness-min"]),"raster-brightness-max":new pr(Je.paint_raster["raster-brightness-max"]),"raster-saturation":new pr(Je.paint_raster["raster-saturation"]),"raster-contrast":new pr(Je.paint_raster["raster-contrast"]),"raster-resampling":new pr(Je.paint_raster["raster-resampling"]),"raster-fade-duration":new pr(Je.paint_raster["raster-fade-duration"])})}};class cC extends $o{constructor(c,u){super(c,lC,u)}}const dC={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class xl{constructor(c,u){this._structArray=c,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class vs{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(c,u){return c._trim(),u&&(c.isTransferred=!0,u.push(c.arrayBuffer)),{length:c.length,arrayBuffer:c.arrayBuffer}}static deserialize(c){const u=Object.create(this.prototype);return u.arrayBuffer=c.arrayBuffer,u.length=c.length,u.capacity=c.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(c){this.reserve(c),this.length=c}reserve(c){if(c>this.capacity){this.capacity=Math.max(c,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function qs(h,c=1){let u=0,x=0;return{members:h.map(_=>{const C=dC[_.type].BYTES_PER_ELEMENT,A=u=mw(u,Math.max(c,C)),M=_.components||1;return x=Math.max(x,C),u+=C*M,{name:_.name,type:_.type,components:M,offset:A}}),size:mw(u,Math.max(x,c)),alignment:c}}function mw(h,c){return Math.ceil(h/c)*c}class ih extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,u){const x=this.length;return this.resize(x+1),this.emplace(x,c,u)}emplace(c,u,x){const _=2*c;return this.int16[_+0]=u,this.int16[_+1]=x,c}}ih.prototype.bytesPerElement=4,er("StructArrayLayout2i4",ih);class rx extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,u,x){const _=this.length;return this.resize(_+1),this.emplace(_,c,u,x)}emplace(c,u,x,_){const C=3*c;return this.int16[C+0]=u,this.int16[C+1]=x,this.int16[C+2]=_,c}}rx.prototype.bytesPerElement=6,er("StructArrayLayout3i6",rx);class Zv extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,u,x,_){const C=this.length;return this.resize(C+1),this.emplace(C,c,u,x,_)}emplace(c,u,x,_,C){const A=4*c;return this.int16[A+0]=u,this.int16[A+1]=x,this.int16[A+2]=_,this.int16[A+3]=C,c}}Zv.prototype.bytesPerElement=8,er("StructArrayLayout4i8",Zv);class Ql extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,u,x,_,C,A){const M=this.length;return this.resize(M+1),this.emplace(M,c,u,x,_,C,A)}emplace(c,u,x,_,C,A,M){const F=6*c;return this.int16[F+0]=u,this.int16[F+1]=x,this.int16[F+2]=_,this.int16[F+3]=C,this.int16[F+4]=A,this.int16[F+5]=M,c}}Ql.prototype.bytesPerElement=12,er("StructArrayLayout2i4i12",Ql);class nx extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,u,x,_,C,A){const M=this.length;return this.resize(M+1),this.emplace(M,c,u,x,_,C,A)}emplace(c,u,x,_,C,A,M){const F=4*c,q=8*c;return this.int16[F+0]=u,this.int16[F+1]=x,this.uint8[q+4]=_,this.uint8[q+5]=C,this.uint8[q+6]=A,this.uint8[q+7]=M,c}}nx.prototype.bytesPerElement=8,er("StructArrayLayout2i4ub8",nx);class Fd extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,u){const x=this.length;return this.resize(x+1),this.emplace(x,c,u)}emplace(c,u,x){const _=2*c;return this.float32[_+0]=u,this.float32[_+1]=x,c}}Fd.prototype.bytesPerElement=8,er("StructArrayLayout2f8",Fd);class sx extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,u,x,_,C,A,M,F,q,V){const K=this.length;return this.resize(K+1),this.emplace(K,c,u,x,_,C,A,M,F,q,V)}emplace(c,u,x,_,C,A,M,F,q,V,K){const ee=10*c;return this.uint16[ee+0]=u,this.uint16[ee+1]=x,this.uint16[ee+2]=_,this.uint16[ee+3]=C,this.uint16[ee+4]=A,this.uint16[ee+5]=M,this.uint16[ee+6]=F,this.uint16[ee+7]=q,this.uint16[ee+8]=V,this.uint16[ee+9]=K,c}}sx.prototype.bytesPerElement=20,er("StructArrayLayout10ui20",sx);class sf extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,u,x,_,C,A,M,F){const q=this.length;return this.resize(q+1),this.emplace(q,c,u,x,_,C,A,M,F)}emplace(c,u,x,_,C,A,M,F,q){const V=8*c;return this.uint16[V+0]=u,this.uint16[V+1]=x,this.uint16[V+2]=_,this.uint16[V+3]=C,this.uint16[V+4]=A,this.uint16[V+5]=M,this.uint16[V+6]=F,this.uint16[V+7]=q,c}}sf.prototype.bytesPerElement=16,er("StructArrayLayout8ui16",sf);class Yv extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,u,x,_,C,A,M,F,q,V,K,ee){const re=this.length;return this.resize(re+1),this.emplace(re,c,u,x,_,C,A,M,F,q,V,K,ee)}emplace(c,u,x,_,C,A,M,F,q,V,K,ee,re){const ae=12*c;return this.int16[ae+0]=u,this.int16[ae+1]=x,this.int16[ae+2]=_,this.int16[ae+3]=C,this.uint16[ae+4]=A,this.uint16[ae+5]=M,this.uint16[ae+6]=F,this.uint16[ae+7]=q,this.int16[ae+8]=V,this.int16[ae+9]=K,this.int16[ae+10]=ee,this.int16[ae+11]=re,c}}Yv.prototype.bytesPerElement=24,er("StructArrayLayout4i4ui4i24",Yv);class ah extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,u,x){const _=this.length;return this.resize(_+1),this.emplace(_,c,u,x)}emplace(c,u,x,_){const C=3*c;return this.float32[C+0]=u,this.float32[C+1]=x,this.float32[C+2]=_,c}}ah.prototype.bytesPerElement=12,er("StructArrayLayout3f12",ah);class zd extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(c){const u=this.length;return this.resize(u+1),this.emplace(u,c)}emplace(c,u){return this.uint32[1*c+0]=u,c}}zd.prototype.bytesPerElement=4,er("StructArrayLayout1ul4",zd);class Xv extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,u,x,_,C,A,M,F,q){const V=this.length;return this.resize(V+1),this.emplace(V,c,u,x,_,C,A,M,F,q)}emplace(c,u,x,_,C,A,M,F,q,V){const K=10*c,ee=5*c;return this.int16[K+0]=u,this.int16[K+1]=x,this.int16[K+2]=_,this.int16[K+3]=C,this.int16[K+4]=A,this.int16[K+5]=M,this.uint32[ee+3]=F,this.uint16[K+8]=q,this.uint16[K+9]=V,c}}Xv.prototype.bytesPerElement=20,er("StructArrayLayout6i1ul2ui20",Xv);class ix extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,u,x,_,C,A){const M=this.length;return this.resize(M+1),this.emplace(M,c,u,x,_,C,A)}emplace(c,u,x,_,C,A,M){const F=6*c;return this.int16[F+0]=u,this.int16[F+1]=x,this.int16[F+2]=_,this.int16[F+3]=C,this.int16[F+4]=A,this.int16[F+5]=M,c}}ix.prototype.bytesPerElement=12,er("StructArrayLayout2i2i2i12",ix);class $d extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,u,x,_,C){const A=this.length;return this.resize(A+1),this.emplace(A,c,u,x,_,C)}emplace(c,u,x,_,C,A){const M=4*c,F=8*c;return this.float32[M+0]=u,this.float32[M+1]=x,this.float32[M+2]=_,this.int16[F+6]=C,this.int16[F+7]=A,c}}$d.prototype.bytesPerElement=16,er("StructArrayLayout2f1f2i16",$d);class Qv extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,u,x,_,C,A){const M=this.length;return this.resize(M+1),this.emplace(M,c,u,x,_,C,A)}emplace(c,u,x,_,C,A,M){const F=16*c,q=4*c,V=8*c;return this.uint8[F+0]=u,this.uint8[F+1]=x,this.float32[q+1]=_,this.float32[q+2]=C,this.int16[V+6]=A,this.int16[V+7]=M,c}}Qv.prototype.bytesPerElement=16,er("StructArrayLayout2ub2f2i16",Qv);class ax extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,u,x){const _=this.length;return this.resize(_+1),this.emplace(_,c,u,x)}emplace(c,u,x,_){const C=3*c;return this.uint16[C+0]=u,this.uint16[C+1]=x,this.uint16[C+2]=_,c}}ax.prototype.bytesPerElement=6,er("StructArrayLayout3ui6",ax);class ox extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,u,x,_,C,A,M,F,q,V,K,ee,re,ae,pe,_e,Pe){const Qe=this.length;return this.resize(Qe+1),this.emplace(Qe,c,u,x,_,C,A,M,F,q,V,K,ee,re,ae,pe,_e,Pe)}emplace(c,u,x,_,C,A,M,F,q,V,K,ee,re,ae,pe,_e,Pe,Qe){const Re=24*c,$e=12*c,at=48*c;return this.int16[Re+0]=u,this.int16[Re+1]=x,this.uint16[Re+2]=_,this.uint16[Re+3]=C,this.uint32[$e+2]=A,this.uint32[$e+3]=M,this.uint32[$e+4]=F,this.uint16[Re+10]=q,this.uint16[Re+11]=V,this.uint16[Re+12]=K,this.float32[$e+7]=ee,this.float32[$e+8]=re,this.uint8[at+36]=ae,this.uint8[at+37]=pe,this.uint8[at+38]=_e,this.uint32[$e+10]=Pe,this.int16[Re+22]=Qe,c}}ox.prototype.bytesPerElement=48,er("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ox);class Jv extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,u,x,_,C,A,M,F,q,V,K,ee,re,ae,pe,_e,Pe,Qe,Re,$e,at,ft,At,Yt,zt,Kt,br,Wt){const Ht=this.length;return this.resize(Ht+1),this.emplace(Ht,c,u,x,_,C,A,M,F,q,V,K,ee,re,ae,pe,_e,Pe,Qe,Re,$e,at,ft,At,Yt,zt,Kt,br,Wt)}emplace(c,u,x,_,C,A,M,F,q,V,K,ee,re,ae,pe,_e,Pe,Qe,Re,$e,at,ft,At,Yt,zt,Kt,br,Wt,Ht){const _t=32*c,Fr=16*c;return this.int16[_t+0]=u,this.int16[_t+1]=x,this.int16[_t+2]=_,this.int16[_t+3]=C,this.int16[_t+4]=A,this.int16[_t+5]=M,this.int16[_t+6]=F,this.int16[_t+7]=q,this.uint16[_t+8]=V,this.uint16[_t+9]=K,this.uint16[_t+10]=ee,this.uint16[_t+11]=re,this.uint16[_t+12]=ae,this.uint16[_t+13]=pe,this.uint16[_t+14]=_e,this.uint16[_t+15]=Pe,this.uint16[_t+16]=Qe,this.uint16[_t+17]=Re,this.uint16[_t+18]=$e,this.uint16[_t+19]=at,this.uint16[_t+20]=ft,this.uint16[_t+21]=At,this.uint16[_t+22]=Yt,this.uint32[Fr+12]=zt,this.float32[Fr+13]=Kt,this.float32[Fr+14]=br,this.uint16[_t+30]=Wt,this.uint16[_t+31]=Ht,c}}Jv.prototype.bytesPerElement=64,er("StructArrayLayout8i15ui1ul2f2ui64",Jv);class N extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c){const u=this.length;return this.resize(u+1),this.emplace(u,c)}emplace(c,u){return this.float32[1*c+0]=u,c}}N.prototype.bytesPerElement=4,er("StructArrayLayout1f4",N);class o extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,u,x){const _=this.length;return this.resize(_+1),this.emplace(_,c,u,x)}emplace(c,u,x,_){const C=3*c;return this.uint16[6*c+0]=u,this.float32[C+1]=x,this.float32[C+2]=_,c}}o.prototype.bytesPerElement=12,er("StructArrayLayout1ui2f12",o);class m extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,u,x){const _=this.length;return this.resize(_+1),this.emplace(_,c,u,x)}emplace(c,u,x,_){const C=4*c;return this.uint32[2*c+0]=u,this.uint16[C+2]=x,this.uint16[C+3]=_,c}}m.prototype.bytesPerElement=8,er("StructArrayLayout1ul2ui8",m);class g extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,u){const x=this.length;return this.resize(x+1),this.emplace(x,c,u)}emplace(c,u,x){const _=2*c;return this.uint16[_+0]=u,this.uint16[_+1]=x,c}}g.prototype.bytesPerElement=4,er("StructArrayLayout2ui4",g);class b extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c){const u=this.length;return this.resize(u+1),this.emplace(u,c)}emplace(c,u){return this.uint16[1*c+0]=u,c}}b.prototype.bytesPerElement=2,er("StructArrayLayout1ui2",b);class P extends vs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,u,x,_){const C=this.length;return this.resize(C+1),this.emplace(C,c,u,x,_)}emplace(c,u,x,_,C){const A=4*c;return this.float32[A+0]=u,this.float32[A+1]=x,this.float32[A+2]=_,this.float32[A+3]=C,c}}P.prototype.bytesPerElement=16,er("StructArrayLayout4f16",P);class E extends xl{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new f(this.anchorPointX,this.anchorPointY)}}E.prototype.size=20;class z extends Xv{get(c){return new E(this,c)}}er("CollisionBoxArray",z);class B extends xl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(c){this._structArray.uint8[this._pos1+37]=c}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(c){this._structArray.uint8[this._pos1+38]=c}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(c){this._structArray.uint32[this._pos4+10]=c}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}B.prototype.size=48;class U extends ox{get(c){return new B(this,c)}}er("PlacedSymbolArray",U);class G extends xl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(c){this._structArray.uint32[this._pos4+12]=c}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}G.prototype.size=64;class J extends Jv{get(c){return new G(this,c)}}er("SymbolInstanceArray",J);class Y extends N{getoffsetX(c){return this.float32[1*c+0]}}er("GlyphOffsetArray",Y);class ne extends rx{getx(c){return this.int16[3*c+0]}gety(c){return this.int16[3*c+1]}gettileUnitDistanceFromAnchor(c){return this.int16[3*c+2]}}er("SymbolLineVertexArray",ne);class fe extends xl{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}fe.prototype.size=12;class je extends o{get(c){return new fe(this,c)}}er("TextAnchorOffsetArray",je);class we extends xl{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}we.prototype.size=8;class Se extends m{get(c){return new we(this,c)}}er("FeatureIndexArray",Se);class Te extends ih{}class Le extends ih{}class ke extends ih{}class Fe extends Ql{}class Be extends nx{}class De extends Fd{}class Ke extends sx{}class ht extends sf{}class it extends Yv{}class ot extends ah{}class mt extends zd{}class Tt extends ix{}class Mt extends Qv{}class bt extends ax{}class ir extends g{}const Wr=qs([{name:"a_pos",components:2,type:"Int16"}],4),{members:Rn}=Wr;class Hr{constructor(c=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=c}prepareSegment(c,u,x,_){const C=this.segments[this.segments.length-1];return c>Hr.MAX_VERTEX_ARRAY_LENGTH&&or(`Max vertices per segment is ${Hr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${c}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Hr.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!C||C.vertexLength+c>Hr.MAX_VERTEX_ARRAY_LENGTH||C.sortKey!==_?this.createNewSegment(u,x,_):C}createNewSegment(c,u,x){const _={vertexOffset:c.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0,vaos:{}};return x!==void 0&&(_.sortKey=x),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(_),_}getOrCreateLatestSegment(c,u,x){return this.prepareSegment(0,c,u,x)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const c of this.segments)for(const u in c.vaos)c.vaos[u].destroy()}static simpleSegment(c,u,x,_){return new Hr([{vertexOffset:c,primitiveOffset:u,vertexLength:x,primitiveLength:_,vaos:{},sortKey:0}])}}function Kn(h,c){return 256*(h=Pr(Math.floor(h),0,255))+Pr(Math.floor(c),0,255)}Hr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,er("SegmentVector",Hr);const _s=qs([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Qn=qs([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var hi,ls,Ai,cs={exports:{}},Js={exports:{}},ja={exports:{}},Bd=function(){if(Ai)return cs.exports;Ai=1;var h=(hi||(hi=1,Js.exports=function(u,x){var _,C,A,M,F,q,V,K;for(C=u.length-(_=3&u.length),A=x,F=3432918353,q=461845907,K=0;K<C;)V=255&u.charCodeAt(K)|(255&u.charCodeAt(++K))<<8|(255&u.charCodeAt(++K))<<16|(255&u.charCodeAt(++K))<<24,++K,A=27492+(65535&(M=5*(65535&(A=(A^=V=(65535&(V=(V=(65535&V)*F+(((V>>>16)*F&65535)<<16)&4294967295)<<15|V>>>17))*q+(((V>>>16)*q&65535)<<16)&4294967295)<<13|A>>>19))+((5*(A>>>16)&65535)<<16)&4294967295))+((58964+(M>>>16)&65535)<<16);switch(V=0,_){case 3:V^=(255&u.charCodeAt(K+2))<<16;case 2:V^=(255&u.charCodeAt(K+1))<<8;case 1:A^=V=(65535&(V=(V=(65535&(V^=255&u.charCodeAt(K)))*F+(((V>>>16)*F&65535)<<16)&4294967295)<<15|V>>>17))*q+(((V>>>16)*q&65535)<<16)&4294967295}return A^=u.length,A=2246822507*(65535&(A^=A>>>16))+((2246822507*(A>>>16)&65535)<<16)&4294967295,A=3266489909*(65535&(A^=A>>>13))+((3266489909*(A>>>16)&65535)<<16)&4294967295,(A^=A>>>16)>>>0}),Js.exports),c=(ls||(ls=1,ja.exports=function(u,x){for(var _,C=u.length,A=x^C,M=0;C>=4;)_=1540483477*(65535&(_=255&u.charCodeAt(M)|(255&u.charCodeAt(++M))<<8|(255&u.charCodeAt(++M))<<16|(255&u.charCodeAt(++M))<<24))+((1540483477*(_>>>16)&65535)<<16),A=1540483477*(65535&A)+((1540483477*(A>>>16)&65535)<<16)^(_=1540483477*(65535&(_^=_>>>24))+((1540483477*(_>>>16)&65535)<<16)),C-=4,++M;switch(C){case 3:A^=(255&u.charCodeAt(M+2))<<16;case 2:A^=(255&u.charCodeAt(M+1))<<8;case 1:A=1540483477*(65535&(A^=255&u.charCodeAt(M)))+((1540483477*(A>>>16)&65535)<<16)}return A=1540483477*(65535&(A^=A>>>13))+((1540483477*(A>>>16)&65535)<<16),(A^=A>>>15)>>>0}),ja.exports);return cs.exports=h,cs.exports.murmur3=h,cs.exports.murmur2=c,cs.exports}(),Jl=p(Bd);class gl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(c,u,x,_){this.ids.push(qd(c)),this.positions.push(u,x,_)}getPositions(c){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const u=qd(c);let x=0,_=this.ids.length-1;for(;x<_;){const A=x+_>>1;this.ids[A]>=u?_=A:x=A+1}const C=[];for(;this.ids[x]===u;)C.push({index:this.positions[3*x],start:this.positions[3*x+1],end:this.positions[3*x+2]}),x++;return C}static serialize(c,u){const x=new Float64Array(c.ids),_=new Uint32Array(c.positions);return oh(x,_,0,x.length-1),u&&u.push(x.buffer,_.buffer),{ids:x,positions:_}}static deserialize(c){const u=new gl;return u.ids=c.ids,u.positions=c.positions,u.indexed=!0,u}}function qd(h){const c=+h;return!isNaN(c)&&c<=Number.MAX_SAFE_INTEGER?c:Jl(String(h))}function oh(h,c,u,x){for(;u<x;){const _=h[u+x>>1];let C=u-1,A=x+1;for(;;){do C++;while(h[C]<_);do A--;while(h[A]>_);if(C>=A)break;Vd(h,C,A),Vd(c,3*C,3*A),Vd(c,3*C+1,3*A+1),Vd(c,3*C+2,3*A+2)}A-u<x-A?(oh(h,c,u,A),u=A+1):(oh(h,c,A+1,x),x=A)}}function Vd(h,c,u){const x=h[c];h[c]=h[u],h[u]=x}er("FeaturePositionMap",gl);class Fa{constructor(c,u){this.gl=c.gl,this.location=u}}class wa extends Fa{constructor(c,u){super(c,u),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class ec extends Fa{constructor(c,u){super(c,u),this.current=[0,0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3]))}}class $c extends Fa{constructor(c,u){super(c,u),this.current=Ur.transparent}set(c){c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a))}}const af=new Float32Array(16);function ei(h){return[Kn(255*h.r,255*h.g),Kn(255*h.b,255*h.a)]}class Vs{constructor(c,u,x){this.value=c,this.uniformNames=u.map(_=>`u_${_}`),this.type=x}setUniform(c,u,x){c.set(x.constantOr(this.value))}getBinding(c,u,x){return this.type==="color"?new $c(c,u):new wa(c,u)}}class ki{constructor(c,u){this.uniformNames=u.map(x=>`u_${x}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(c,u){this.pixelRatioFrom=u.pixelRatio,this.pixelRatioTo=c.pixelRatio,this.patternFrom=u.tlbr,this.patternTo=c.tlbr}setConstantDashPositions(c,u){this.dashTo=[0,c.y,c.height,c.width],this.dashFrom=[0,u.y,u.height,u.width]}setUniform(c,u,x,_){let C=null;_==="u_pattern_to"?C=this.patternTo:_==="u_pattern_from"?C=this.patternFrom:_==="u_dasharray_to"?C=this.dashTo:_==="u_dasharray_from"?C=this.dashFrom:_==="u_pixel_ratio_to"?C=this.pixelRatioTo:_==="u_pixel_ratio_from"&&(C=this.pixelRatioFrom),C!==null&&c.set(C)}getBinding(c,u,x){return x.substr(0,9)==="u_pattern"||x.substr(0,12)==="u_dasharray_"?new ec(c,u):new wa(c,u)}}class is{constructor(c,u,x,_){this.expression=c,this.type=x,this.maxValue=0,this.paintVertexAttributes=u.map(C=>({name:`a_${C}`,type:"Float32",components:x==="color"?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(c,u,x){const _=this.paintVertexArray.length,C=this.expression.evaluate(new Gn(0,x),u,{},x.canonical,[],x.formattedSection);this.paintVertexArray.resize(c),this._setPaintValue(_,c,C)}updatePaintArray(c,u,x,_,C){const A=this.expression.evaluate(new Gn(0,C),x,_);this._setPaintValue(c,u,A)}_setPaintValue(c,u,x){if(this.type==="color"){const _=ei(x);for(let C=c;C<u;C++)this.paintVertexArray.emplace(C,_[0],_[1])}else{for(let _=c;_<u;_++)this.paintVertexArray.emplace(_,x);this.maxValue=Math.max(this.maxValue,Math.abs(x))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Bo{constructor(c,u,x,_,C,A){this.expression=c,this.uniformNames=u.map(M=>`u_${M}_t`),this.type=x,this.useIntegerZoom=_,this.zoom=C,this.maxValue=0,this.paintVertexAttributes=u.map(M=>({name:`a_${M}`,type:"Float32",components:x==="color"?4:2,offset:0})),this.paintVertexArray=new A}populatePaintArray(c,u,x){const _=this.expression.evaluate(new Gn(this.zoom,x),u,{},x.canonical,[],x.formattedSection),C=this.expression.evaluate(new Gn(this.zoom+1,x),u,{},x.canonical,[],x.formattedSection),A=this.paintVertexArray.length;this.paintVertexArray.resize(c),this._setPaintValue(A,c,_,C)}updatePaintArray(c,u,x,_,C){const A=this.expression.evaluate(new Gn(this.zoom,C),x,_),M=this.expression.evaluate(new Gn(this.zoom+1,C),x,_);this._setPaintValue(c,u,A,M)}_setPaintValue(c,u,x,_){if(this.type==="color"){const C=ei(x),A=ei(_);for(let M=c;M<u;M++)this.paintVertexArray.emplace(M,C[0],C[1],A[0],A[1])}else{for(let C=c;C<u;C++)this.paintVertexArray.emplace(C,x,_);this.maxValue=Math.max(this.maxValue,Math.abs(x),Math.abs(_))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(c,u){const x=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,_=Pr(this.expression.interpolationFactor(x,this.zoom,this.zoom+1),0,1);c.set(_)}getBinding(c,u,x){return new wa(c,u)}}class Bc{constructor(c,u,x,_,C,A){this.expression=c,this.type=u,this.useIntegerZoom=x,this.zoom=_,this.layerId=A,this.zoomInPaintVertexArray=new C,this.zoomOutPaintVertexArray=new C}populatePaintArray(c,u,x){const _=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(c),this.zoomOutPaintVertexArray.resize(c),this._setPaintValues(_,c,this.getPositionIds(u),x)}updatePaintArray(c,u,x,_,C){this._setPaintValues(c,u,this.getPositionIds(x),C)}_setPaintValues(c,u,x,_){const C=this.getPositions(_);if(!C||!x)return;const A=C[x.min],M=C[x.mid],F=C[x.max];if(A&&M&&F)for(let q=c;q<u;q++)this.emplace(this.zoomInPaintVertexArray,q,M,A),this.emplace(this.zoomOutPaintVertexArray,q,M,F)}upload(c){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const u=this.getVertexAttributes();this.zoomInPaintVertexBuffer=c.createVertexBuffer(this.zoomInPaintVertexArray,u,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=c.createVertexBuffer(this.zoomOutPaintVertexArray,u,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class fw extends Bc{getPositions(c){return c.imagePositions}getPositionIds(c){return c.patterns&&c.patterns[this.layerId]}getVertexAttributes(){return _s.members}emplace(c,u,x,_){c.emplace(u,x.tlbr[0],x.tlbr[1],x.tlbr[2],x.tlbr[3],_.tlbr[0],_.tlbr[1],_.tlbr[2],_.tlbr[3],x.pixelRatio,_.pixelRatio)}}class pw extends Bc{getPositions(c){return c.dashPositions}getPositionIds(c){return c.dashes&&c.dashes[this.layerId]}getVertexAttributes(){return Qn.members}emplace(c,u,x,_){c.emplace(u,0,x.y,x.height,x.width,0,_.y,_.height,_.width)}}class xw{constructor(c,u,x){this.binders={},this._buffers=[];const _=[];for(const C in c.paint._values){if(!x(C))continue;const A=c.paint.get(C);if(!(A instanceof zo&&Ju(A.property.specification)))continue;const M=Wd(C,c.type),F=A.value,q=A.property.specification.type,V=A.property.useIntegerZoom,K=A.property.specification["property-type"],ee=K==="cross-faded"||K==="cross-faded-data-driven";if(F.kind==="constant")this.binders[C]=ee?new ki(F.value,M):new Vs(F.value,M,q),_.push(`/u_${C}`);else if(F.kind==="source"||ee){const re=e0(C,q,"source");this.binders[C]=ee?C==="line-dasharray"?new pw(F,q,V,u,re,c.id):new fw(F,q,V,u,re,c.id):new is(F,M,q,re),_.push(`/a_${C}`)}else{const re=e0(C,q,"composite");this.binders[C]=new Bo(F,M,q,V,u,re),_.push(`/z_${C}`)}}this.cacheKey=_.sort().join("")}getMaxValue(c){const u=this.binders[c];return u instanceof is||u instanceof Bo?u.maxValue:0}populatePaintArrays(c,u,x){for(const _ in this.binders){const C=this.binders[_];(C instanceof is||C instanceof Bo||C instanceof Bc)&&C.populatePaintArray(c,u,x)}}setConstantPatternPositions(c,u){for(const x in this.binders){const _=this.binders[x];_ instanceof ki&&_.setConstantPatternPositions(c,u)}}setConstantDashPositions(c,u){for(const x in this.binders){const _=this.binders[x];_ instanceof ki&&_.setConstantDashPositions(c,u)}}updatePaintArrays(c,u,x,_,C){let A=!1;for(const M in c){const F=u.getPositions(M);for(const q of F){const V=x.feature(q.index);for(const K in this.binders){const ee=this.binders[K];if((ee instanceof is||ee instanceof Bo||ee instanceof Bc)&&ee.expression.isStateDependent===!0){const re=_.paint.get(K);ee.expression=re.value,ee.updatePaintArray(q.start,q.end,V,c[M],C),A=!0}}}}return A}defines(){const c=[];for(const u in this.binders){const x=this.binders[u];(x instanceof Vs||x instanceof ki)&&c.push(...x.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return c}getBinderAttributes(){const c=[];for(const u in this.binders){const x=this.binders[u];if(x instanceof is||x instanceof Bo)for(let _=0;_<x.paintVertexAttributes.length;_++)c.push(x.paintVertexAttributes[_].name);else if(x instanceof Bc){const _=x.getVertexAttributes();for(const C of _)c.push(C.name)}}return c}getBinderUniforms(){const c=[];for(const u in this.binders){const x=this.binders[u];if(x instanceof Vs||x instanceof ki||x instanceof Bo)for(const _ of x.uniformNames)c.push(_)}return c}getPaintVertexBuffers(){return this._buffers}getUniforms(c,u){const x=[];for(const _ in this.binders){const C=this.binders[_];if(C instanceof Vs||C instanceof ki||C instanceof Bo){for(const A of C.uniformNames)if(u[A]){const M=C.getBinding(c,u[A],A);x.push({name:A,property:_,binding:M})}}}return x}setUniforms(c,u,x,_){for(const{name:C,property:A,binding:M}of u)this.binders[A].setUniform(M,_,x.get(A),C)}updatePaintBuffers(c){this._buffers=[];for(const u in this.binders){const x=this.binders[u];if(c&&x instanceof Bc){const _=c.fromScale===2?x.zoomInPaintVertexBuffer:x.zoomOutPaintVertexBuffer;_&&this._buffers.push(_)}else(x instanceof is||x instanceof Bo)&&x.paintVertexBuffer&&this._buffers.push(x.paintVertexBuffer)}}upload(c){for(const u in this.binders){const x=this.binders[u];(x instanceof is||x instanceof Bo||x instanceof Bc)&&x.upload(c)}this.updatePaintBuffers()}destroy(){for(const c in this.binders){const u=this.binders[c];(u instanceof is||u instanceof Bo||u instanceof Bc)&&u.destroy()}}}class Ud{constructor(c,u,x=()=>!0){this.programConfigurations={};for(const _ of c)this.programConfigurations[_.id]=new xw(_,u,x);this.needsUpload=!1,this._featureMap=new gl,this._bufferOffset=0}populatePaintArrays(c,u,x,_){for(const C in this.programConfigurations)this.programConfigurations[C].populatePaintArrays(c,u,_);u.id!==void 0&&this._featureMap.add(u.id,x,this._bufferOffset,c),this._bufferOffset=c,this.needsUpload=!0}updatePaintArrays(c,u,x,_){for(const C of x)this.needsUpload=this.programConfigurations[C.id].updatePaintArrays(c,this._featureMap,u,C,_)||this.needsUpload}get(c){return this.programConfigurations[c]}upload(c){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(c);this.needsUpload=!1}}destroy(){for(const c in this.programConfigurations)this.programConfigurations[c].destroy()}}function Wd(h,c){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[h]||[h.replace(`${c}-`,"").replace(/-/g,"_")]}function e0(h,c,u){const x={color:{source:Fd,composite:P},number:{source:N,composite:Fd}},_=function(C){return{"line-pattern":{source:Ke,composite:Ke},"fill-pattern":{source:Ke,composite:Ke},"fill-extrusion-pattern":{source:Ke,composite:Ke},"line-dasharray":{source:ht,composite:ht}}[C]}(h);return _&&_[u]||x[c][u]}er("ConstantBinder",Vs),er("CrossFadedConstantBinder",ki),er("SourceExpressionBinder",is),er("CrossFadedPatternBinder",fw),er("CrossFadedDasharrayBinder",pw),er("CompositeExpressionBinder",Bo),er("ProgramConfiguration",xw,{omit:["_buffers"]}),er("ProgramConfigurationSet",Ud);const lx=Math.pow(2,14)-1,t0=-lx-1;function tc(h){const c=ve/h.extent,u=h.loadGeometry();for(let x=0;x<u.length;x++){const _=u[x];for(let C=0;C<_.length;C++){const A=_[C],M=Math.round(A.x*c),F=Math.round(A.y*c);A.x=Pr(M,t0,lx),A.y=Pr(F,t0,lx),(M<A.x||M>A.x+1||F<A.y||F>A.y+1)&&or("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return u}function qc(h,c){return{type:h.type,id:h.id,properties:h.properties,geometry:c?tc(h):[]}}const cx=-32768;function dY(h,c,u,x,_){h.emplaceBack(cx+8*c+x,cx+8*u+_)}class uC{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(u=>u.id),this.index=c.index,this.hasDependencies=!1,this.layoutVertexArray=new Le,this.indexArray=new bt,this.segments=new Hr,this.programConfigurations=new Ud(c.layers,c.zoom),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(c,u,x){const _=this.layers[0],C=[];let A=null,M=!1,F=_.type==="heatmap";if(_.type==="circle"){const V=_;A=V.layout.get("circle-sort-key"),M=!A.isConstant(),F=F||V.paint.get("circle-pitch-alignment")==="map"}const q=F?u.subdivisionGranularity.circle:1;for(const{feature:V,id:K,index:ee,sourceLayerIndex:re}of c){const ae=this.layers[0]._featureFilter.needGeometry,pe=qc(V,ae);if(!this.layers[0]._featureFilter.filter(new Gn(this.zoom),pe,x))continue;const _e=M?A.evaluate(pe,{},x):void 0,Pe={id:K,properties:V.properties,type:V.type,sourceLayerIndex:re,index:ee,geometry:ae?pe.geometry:tc(V),patterns:{},sortKey:_e};C.push(Pe)}M&&C.sort((V,K)=>V.sortKey-K.sortKey);for(const V of C){const{geometry:K,index:ee,sourceLayerIndex:re}=V,ae=c[ee].feature;this.addFeature(V,K,ee,x,q),u.featureIndex.insert(ae,K,ee,re,this.index)}}update(c,u,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,u,this.stateDependentLayers,{imagePositions:x})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,Rn),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(c,u,x,_,C=1){let A;switch(C){case 1:A=[0,7];break;case 3:A=[0,2,5,7];break;case 5:A=[0,1,3,4,6,7];break;case 7:A=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${C}; valid values are 1, 3, 5, 7.`)}const M=A.length;for(const F of u)for(const q of F){const V=q.x,K=q.y;if(V<0||V>=ve||K<0||K>=ve)continue;const ee=this.segments.prepareSegment(M*M,this.layoutVertexArray,this.indexArray,c.sortKey),re=ee.vertexLength;for(let ae=0;ae<M;ae++)for(let pe=0;pe<M;pe++)dY(this.layoutVertexArray,V,K,A[pe],A[ae]);for(let ae=0;ae<M-1;ae++)for(let pe=0;pe<M-1;pe++){const _e=re+ae*M+pe,Pe=re+(ae+1)*M+pe;this.indexArray.emplaceBack(_e,Pe+1,_e+1),this.indexArray.emplaceBack(_e,Pe,Pe+1)}ee.vertexLength+=M*M,ee.primitiveLength+=(M-1)*(M-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,x,{imagePositions:{},canonical:_})}}function sD(h,c){for(let u=0;u<h.length;u++)if(dx(c,h[u]))return!0;for(let u=0;u<c.length;u++)if(dx(h,c[u]))return!0;return!!hC(h,c)}function gw(h,c,u){return!!dx(h,c)||!!mC(c,h,u)}function iD(h,c){if(h.length===1)return oD(c,h[0]);for(let u=0;u<c.length;u++){const x=c[u];for(let _=0;_<x.length;_++)if(dx(h,x[_]))return!0}for(let u=0;u<h.length;u++)if(oD(c,h[u]))return!0;for(let u=0;u<c.length;u++)if(hC(h,c[u]))return!0;return!1}function uY(h,c,u){if(h.length>1){if(hC(h,c))return!0;for(let x=0;x<c.length;x++)if(mC(c[x],h,u))return!0}for(let x=0;x<h.length;x++)if(mC(h[x],c,u))return!0;return!1}function hC(h,c){if(h.length===0||c.length===0)return!1;for(let u=0;u<h.length-1;u++){const x=h[u],_=h[u+1];for(let C=0;C<c.length-1;C++)if(hY(x,_,c[C],c[C+1]))return!0}return!1}function hY(h,c,u,x){return en(h,u,x)!==en(c,u,x)&&en(h,c,u)!==en(h,c,x)}function mC(h,c,u){const x=u*u;if(c.length===1)return h.distSqr(c[0])<x;for(let _=1;_<c.length;_++)if(aD(h,c[_-1],c[_])<x)return!0;return!1}function aD(h,c,u){const x=c.distSqr(u);if(x===0)return h.distSqr(c);const _=((h.x-c.x)*(u.x-c.x)+(h.y-c.y)*(u.y-c.y))/x;return h.distSqr(_<0?c:_>1?u:u.sub(c)._mult(_)._add(c))}function oD(h,c){let u,x,_,C=!1;for(let A=0;A<h.length;A++){u=h[A];for(let M=0,F=u.length-1;M<u.length;F=M++)x=u[M],_=u[F],x.y>c.y!=_.y>c.y&&c.x<(_.x-x.x)*(c.y-x.y)/(_.y-x.y)+x.x&&(C=!C)}return C}function dx(h,c){let u=!1;for(let x=0,_=h.length-1;x<h.length;_=x++){const C=h[x],A=h[_];C.y>c.y!=A.y>c.y&&c.x<(A.x-C.x)*(c.y-C.y)/(A.y-C.y)+C.x&&(u=!u)}return u}function mY(h,c,u){const x=u[0],_=u[2];if(h.x<x.x&&c.x<x.x||h.x>_.x&&c.x>_.x||h.y<x.y&&c.y<x.y||h.y>_.y&&c.y>_.y)return!1;const C=en(h,c,u[0]);return C!==en(h,c,u[1])||C!==en(h,c,u[2])||C!==en(h,c,u[3])}function ux(h,c,u){const x=c.paint.get(h).value;return x.kind==="constant"?x.value:u.programConfigurations.get(c.id).getMaxValue(h)}function yw(h){return Math.sqrt(h[0]*h[0]+h[1]*h[1])}function vw(h,c,u,x,_){if(!c[0]&&!c[1])return h;const C=f.convert(c)._mult(_);u==="viewport"&&C._rotate(-x);const A=[];for(let M=0;M<h.length;M++)A.push(h[M].sub(C));return A}function fY({queryGeometry:h,size:c},u){return gw(h,u,c)}function pY({queryGeometry:h,size:c,transform:u,unwrappedTileID:x,getElevation:_},C){return gw(h,C,c*(u.projectTileCoordinates(C.x,C.y,x,_).signedDistanceFromCamera/u.cameraToCenterDistance))}function xY({queryGeometry:h,size:c,transform:u,unwrappedTileID:x,getElevation:_},C){const A=u.projectTileCoordinates(C.x,C.y,x,_).signedDistanceFromCamera,M=c*(u.cameraToCenterDistance/A);return gw(h,fC(C,u,x,_),M)}function gY({queryGeometry:h,size:c,transform:u,unwrappedTileID:x,getElevation:_},C){return gw(h,fC(C,u,x,_),c)}function lD({queryGeometry:h,size:c,transform:u,unwrappedTileID:x,getElevation:_,pitchAlignment:C="map",pitchScale:A="map"},M){const F=C==="map"?A==="map"?fY:pY:A==="map"?xY:gY,q={queryGeometry:h,size:c,transform:u,unwrappedTileID:x,getElevation:_};for(const V of M)for(const K of V)if(F(q,K))return!0;return!1}function fC(h,c,u,x){const _=c.projectTileCoordinates(h.x,h.y,u,x).point;return new f((.5*_.x+.5)*c.width,(.5*-_.y+.5)*c.height)}let cD,dD;er("CircleBucket",uC,{omit:["layers"]});var yY={get paint(){return dD=dD||new oa({"circle-radius":new Ir(Je.paint_circle["circle-radius"]),"circle-color":new Ir(Je.paint_circle["circle-color"]),"circle-blur":new Ir(Je.paint_circle["circle-blur"]),"circle-opacity":new Ir(Je.paint_circle["circle-opacity"]),"circle-translate":new pr(Je.paint_circle["circle-translate"]),"circle-translate-anchor":new pr(Je.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new pr(Je.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new pr(Je.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ir(Je.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ir(Je.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ir(Je.paint_circle["circle-stroke-opacity"])})},get layout(){return cD=cD||new oa({"circle-sort-key":new Ir(Je.layout_circle["circle-sort-key"])})}};class vY extends $o{constructor(c,u){super(c,yY,u)}createBucket(c){return new uC(c)}queryRadius(c){const u=c;return ux("circle-radius",this,u)+ux("circle-stroke-width",this,u)+yw(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:c,feature:u,featureState:x,geometry:_,transform:C,pixelsToTileUnits:A,unwrappedTileID:M,getElevation:F}){const q=vw(c,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-C.bearingInRadians,A),V=this.paint.get("circle-radius").evaluate(u,x)+this.paint.get("circle-stroke-width").evaluate(u,x),K=this.paint.get("circle-pitch-scale"),ee=this.paint.get("circle-pitch-alignment");let re,ae;return ee==="map"?(re=q,ae=V*A):(re=function(pe,_e,Pe,Qe){return pe.map(Re=>fC(Re,_e,Pe,Qe))}(q,C,M,F),ae=V),lD({queryGeometry:re,size:ae,transform:C,unwrappedTileID:M,getElevation:F,pitchAlignment:ee,pitchScale:K},_)}}class uD extends uC{}let hD;er("HeatmapBucket",uD,{omit:["layers"]});var _Y={get paint(){return hD=hD||new oa({"heatmap-radius":new Ir(Je.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ir(Je.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new pr(Je.paint_heatmap["heatmap-intensity"]),"heatmap-color":new nf(Je.paint_heatmap["heatmap-color"]),"heatmap-opacity":new pr(Je.paint_heatmap["heatmap-opacity"])})}};function pC(h,{width:c,height:u},x,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==c*u*x)throw new RangeError(`mismatched image size. expected: ${_.length} but got: ${c*u*x}`)}else _=new Uint8Array(c*u*x);return h.width=c,h.height=u,h.data=_,h}function mD(h,{width:c,height:u},x){if(c===h.width&&u===h.height)return;const _=pC({},{width:c,height:u},x);xC(h,_,{x:0,y:0},{x:0,y:0},{width:Math.min(h.width,c),height:Math.min(h.height,u)},x),h.width=c,h.height=u,h.data=_.data}function xC(h,c,u,x,_,C){if(_.width===0||_.height===0)return c;if(_.width>h.width||_.height>h.height||u.x>h.width-_.width||u.y>h.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>c.width||_.height>c.height||x.x>c.width-_.width||x.y>c.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const A=h.data,M=c.data;if(A===M)throw new Error("srcData equals dstData, so image is already copied");for(let F=0;F<_.height;F++){const q=((u.y+F)*h.width+u.x)*C,V=((x.y+F)*c.width+x.x)*C;for(let K=0;K<_.width*C;K++)M[V+K]=A[q+K]}return c}class r0{constructor(c,u){pC(this,c,1,u)}resize(c){mD(this,c,1)}clone(){return new r0({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,u,x,_,C){xC(c,u,x,_,C,1)}}class eo{constructor(c,u){pC(this,c,4,u)}resize(c){mD(this,c,4)}replace(c,u){u?this.data.set(c):this.data=c instanceof Uint8ClampedArray?new Uint8Array(c.buffer):c}clone(){return new eo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,u,x,_,C){xC(c,u,x,_,C,4)}setPixel(c,u,x){const _=4*(c*this.width+u);this.data[_+0]=Math.round(255*x.r/x.a),this.data[_+1]=Math.round(255*x.g/x.a),this.data[_+2]=Math.round(255*x.b/x.a),this.data[_+3]=Math.round(255*x.a)}}function fD(h){const c={},u=h.resolution||256,x=h.clips?h.clips.length:1,_=h.image||new eo({width:u,height:x});if(Math.log(u)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${u}`);const C=(A,M,F)=>{c[h.evaluationKey]=F;const q=h.expression.evaluate(c);_.setPixel(A/4/u,M/4,q)};if(h.clips)for(let A=0,M=0;A<x;++A,M+=4*u)for(let F=0,q=0;F<u;F++,q+=4){const V=F/(u-1),{start:K,end:ee}=h.clips[A];C(M,q,K*(1-V)+ee*V)}else for(let A=0,M=0;A<u;A++,M+=4)C(0,M,A/(u-1));return _}er("AlphaImage",r0),er("RGBAImage",eo);const gC="big-fb";class bY extends $o{createBucket(c){return new uD(c)}constructor(c,u){super(c,_Y,u),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=fD({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(gC)&&this.heatmapFbos.delete(gC)}queryRadius(c){return ux("heatmap-radius",this,c)}queryIntersectsFeature({queryGeometry:c,feature:u,featureState:x,geometry:_,transform:C,pixelsToTileUnits:A,unwrappedTileID:M,getElevation:F}){return lD({queryGeometry:c,size:this.paint.get("heatmap-radius").evaluate(u,x)*A,transform:C,unwrappedTileID:M,getElevation:F},_)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let pD;var jY={get paint(){return pD=pD||new oa({"hillshade-illumination-direction":new pr(Je.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new pr(Je.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new pr(Je.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new pr(Je.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new pr(Je.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new pr(Je.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new pr(Je.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new pr(Je.paint_hillshade["hillshade-method"])})}};class wY extends $o{constructor(c,u){super(c,jY,u),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let c=this.paint.get("hillshade-illumination-direction").values,u=this.paint.get("hillshade-illumination-altitude").values,x=this.paint.get("hillshade-highlight-color").values,_=this.paint.get("hillshade-shadow-color").values;const C=Math.max(c.length,u.length,x.length,_.length);c=c.concat(Array(C-c.length).fill(c.at(-1))),u=u.concat(Array(C-u.length).fill(u.at(-1))),x=x.concat(Array(C-x.length).fill(x.at(-1))),_=_.concat(Array(C-_.length).fill(_.at(-1)));const A=u.map(Ft);return{directionRadians:c.map(Ft),altitudeRadians:A,shadowColor:_,highlightColor:x}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let xD;var NY={get paint(){return xD=xD||new oa({"color-relief-opacity":new pr(Je["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new nf(Je["paint_color-relief"]["color-relief-color"])})}};class yC{constructor(c,u,x,_){this.context=c,this.format=x,this.texture=c.gl.createTexture(),this.update(u,_)}update(c,u,x){const{width:_,height:C}=c,A=!(this.size&&this.size[0]===_&&this.size[1]===C||x),{context:M}=this,{gl:F}=M;if(this.useMipmap=!!(u&&u.useMipmap),F.bindTexture(F.TEXTURE_2D,this.texture),M.pixelStoreUnpackFlipY.set(!1),M.pixelStoreUnpack.set(1),M.pixelStoreUnpackPremultiplyAlpha.set(this.format===F.RGBA&&(!u||u.premultiply!==!1)),A)this.size=[_,C],c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||Yn(c)?F.texImage2D(F.TEXTURE_2D,0,this.format,this.format,F.UNSIGNED_BYTE,c):F.texImage2D(F.TEXTURE_2D,0,this.format,_,C,0,this.format,F.UNSIGNED_BYTE,c.data);else{const{x:q,y:V}=x||{x:0,y:0};c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||Yn(c)?F.texSubImage2D(F.TEXTURE_2D,0,q,V,F.RGBA,F.UNSIGNED_BYTE,c):F.texSubImage2D(F.TEXTURE_2D,0,q,V,_,C,F.RGBA,F.UNSIGNED_BYTE,c.data)}this.useMipmap&&this.isSizePowerOfTwo()&&F.generateMipmap(F.TEXTURE_2D),M.pixelStoreUnpackFlipY.setDefault(),M.pixelStoreUnpack.setDefault(),M.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(c,u,x){const{context:_}=this,{gl:C}=_;C.bindTexture(C.TEXTURE_2D,this.texture),x!==C.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(x=C.LINEAR),c!==this.filter&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,c),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,x||c),this.filter=c),u!==this.wrap&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,u),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}}class gD{constructor(c,u,x,_=1,C=1,A=1,M=0){if(this.uid=c,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(x&&!["mapbox","terrarium","custom"].includes(x))return void or(`"${x}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=u.height;const F=this.dim=u.height-2;switch(this.data=new Uint32Array(u.data.buffer),x){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=_,this.greenFactor=C,this.blueFactor=A,this.baseShift=M;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let q=0;q<F;q++)this.data[this._idx(-1,q)]=this.data[this._idx(0,q)],this.data[this._idx(F,q)]=this.data[this._idx(F-1,q)],this.data[this._idx(q,-1)]=this.data[this._idx(q,0)],this.data[this._idx(q,F)]=this.data[this._idx(q,F-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(F,-1)]=this.data[this._idx(F-1,0)],this.data[this._idx(-1,F)]=this.data[this._idx(0,F-1)],this.data[this._idx(F,F)]=this.data[this._idx(F-1,F-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let q=0;q<F;q++)for(let V=0;V<F;V++){const K=this.get(q,V);K>this.max&&(this.max=K),K<this.min&&(this.min=K)}}get(c,u){const x=new Uint8Array(this.data.buffer),_=4*this._idx(c,u);return this.unpack(x[_],x[_+1],x[_+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(c,u){if(c<-1||c>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(c+1)}unpack(c,u,x){return c*this.redFactor+u*this.greenFactor+x*this.blueFactor-this.baseShift}pack(c){return yD(c,this.getUnpackVector())}getPixels(){return new eo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(c,u,x){if(this.dim!==c.dim)throw new Error("dem dimension mismatch");let _=u*this.dim,C=u*this.dim+this.dim,A=x*this.dim,M=x*this.dim+this.dim;switch(u){case-1:_=C-1;break;case 1:C=_+1}switch(x){case-1:A=M-1;break;case 1:M=A+1}const F=-u*this.dim,q=-x*this.dim;for(let V=A;V<M;V++)for(let K=_;K<C;K++)this.data[this._idx(K,V)]=c.data[this._idx(K+F,V+q)]}}function yD(h,c){const u=c[0],x=c[1],_=c[2],C=c[3],A=Math.min(u,x,_),M=Math.round((h+C)/A);return{r:Math.floor(M*A/u)%256,g:Math.floor(M*A/x)%256,b:Math.floor(M*A/_)%256}}er("DEMData",gD);class SY extends $o{constructor(c,u){super(c,NY,u)}_createColorRamp(c){const u={elevationStops:[],colorStops:[]},x=this._transitionablePaint._values["color-relief-color"].value.expression;if(x instanceof Hm&&x._styleExpression.expression instanceof Dn){this.colorRampExpression=x;const A=x._styleExpression.expression;u.elevationStops=A.labels,u.colorStops=[];for(const M of u.elevationStops)u.colorStops.push(A.evaluate({globals:{elevation:M}}))}if(u.elevationStops.length<1&&(u.elevationStops=[0],u.colorStops=[Ur.transparent]),u.elevationStops.length<2&&(u.elevationStops.push(u.elevationStops[0]+1),u.colorStops.push(u.colorStops[0])),u.elevationStops.length<=c)return u;const _={elevationStops:[],colorStops:[]},C=(u.elevationStops.length-1)/(c-1);for(let A=0;A<u.elevationStops.length-.5;A+=C)_.elevationStops.push(u.elevationStops[Math.round(A)]),_.colorStops.push(u.colorStops[Math.round(A)]);return or(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${c}, provided: ${u.elevationStops.length}`),_}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(c,u,x){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const _=this._createColorRamp(u),C=new eo({width:_.colorStops.length,height:1}),A=new eo({width:_.colorStops.length,height:1});for(let M=0;M<_.elevationStops.length;M++){const F=yD(_.elevationStops[M],x);A.setPixel(0,M,new Ur(F.r/255,F.g/255,F.b/255,1)),C.setPixel(0,M,_.colorStops[M])}return this.colorRampTextures={elevationTexture:new yC(c,A,c.gl.RGBA),colorTexture:new yC(c,C,c.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const PY=qs([{name:"a_pos",components:2,type:"Int16"}],4),{members:CY}=PY;function _w(h,c,u){const x=u.patternDependencies;let _=!1;for(const C of c){const A=C.paint.get(`${h}-pattern`);A.isConstant()||(_=!0);const M=A.constantOr(null);M&&(_=!0,x[M.to]=!0,x[M.from]=!0)}return _}function vC(h,c,u,x,_){const{zoom:C}=x,A=_.patternDependencies;for(const M of c){const F=M.paint.get(`${h}-pattern`).value;if(F.kind!=="constant"){let q=F.evaluate({zoom:C-1},u,{},_.availableImages),V=F.evaluate({zoom:C},u,{},_.availableImages),K=F.evaluate({zoom:C+1},u,{},_.availableImages);q=q&&q.name?q.name:q,V=V&&V.name?V.name:V,K=K&&K.name?K.name:K,A[q]=!0,A[V]=!0,A[K]=!0,u.patterns[M.id]={min:q,mid:V,max:K}}}return u}function vD(h,c,u,x,_){let C;if(_===function(A,M,F,q){let V=0;for(let K=M,ee=F-q;K<F;K+=q)V+=(A[ee]-A[K])*(A[K+1]+A[ee+1]),ee=K;return V}(h,c,u,x)>0)for(let A=c;A<u;A+=x)C=wD(A/x|0,h[A],h[A+1],C);else for(let A=u-x;A>=c;A-=x)C=wD(A/x|0,h[A],h[A+1],C);return C&&hx(C,C.next)&&(a0(C),C=C.next),C}function of(h,c){if(!h)return h;c||(c=h);let u,x=h;do if(u=!1,x.steiner||!hx(x,x.next)&&ti(x.prev,x,x.next)!==0)x=x.next;else{if(a0(x),x=c=x.prev,x===x.next)break;u=!0}while(u||x!==c);return c}function n0(h,c,u,x,_,C,A){if(!h)return;!A&&C&&function(F,q,V,K){let ee=F;do ee.z===0&&(ee.z=_C(ee.x,ee.y,q,V,K)),ee.prevZ=ee.prev,ee.nextZ=ee.next,ee=ee.next;while(ee!==F);ee.prevZ.nextZ=null,ee.prevZ=null,function(re){let ae,pe=1;do{let _e,Pe=re;re=null;let Qe=null;for(ae=0;Pe;){ae++;let Re=Pe,$e=0;for(let ft=0;ft<pe&&($e++,Re=Re.nextZ,Re);ft++);let at=pe;for(;$e>0||at>0&&Re;)$e!==0&&(at===0||!Re||Pe.z<=Re.z)?(_e=Pe,Pe=Pe.nextZ,$e--):(_e=Re,Re=Re.nextZ,at--),Qe?Qe.nextZ=_e:re=_e,_e.prevZ=Qe,Qe=_e;Pe=Re}Qe.nextZ=null,pe*=2}while(ae>1)}(ee)}(h,x,_,C);let M=h;for(;h.prev!==h.next;){const F=h.prev,q=h.next;if(C?kY(h,x,_,C):AY(h))c.push(F.i,h.i,q.i),a0(h),h=q.next,M=q.next;else if((h=q)===M){A?A===1?n0(h=TY(of(h),c),c,u,x,_,C,2):A===2&&EY(h,c,u,x,_,C):n0(of(h),c,u,x,_,C,1);break}}}function AY(h){const c=h.prev,u=h,x=h.next;if(ti(c,u,x)>=0)return!1;const _=c.x,C=u.x,A=x.x,M=c.y,F=u.y,q=x.y,V=Math.min(_,C,A),K=Math.min(M,F,q),ee=Math.max(_,C,A),re=Math.max(M,F,q);let ae=x.next;for(;ae!==c;){if(ae.x>=V&&ae.x<=ee&&ae.y>=K&&ae.y<=re&&s0(_,M,C,F,A,q,ae.x,ae.y)&&ti(ae.prev,ae,ae.next)>=0)return!1;ae=ae.next}return!0}function kY(h,c,u,x){const _=h.prev,C=h,A=h.next;if(ti(_,C,A)>=0)return!1;const M=_.x,F=C.x,q=A.x,V=_.y,K=C.y,ee=A.y,re=Math.min(M,F,q),ae=Math.min(V,K,ee),pe=Math.max(M,F,q),_e=Math.max(V,K,ee),Pe=_C(re,ae,c,u,x),Qe=_C(pe,_e,c,u,x);let Re=h.prevZ,$e=h.nextZ;for(;Re&&Re.z>=Pe&&$e&&$e.z<=Qe;){if(Re.x>=re&&Re.x<=pe&&Re.y>=ae&&Re.y<=_e&&Re!==_&&Re!==A&&s0(M,V,F,K,q,ee,Re.x,Re.y)&&ti(Re.prev,Re,Re.next)>=0||(Re=Re.prevZ,$e.x>=re&&$e.x<=pe&&$e.y>=ae&&$e.y<=_e&&$e!==_&&$e!==A&&s0(M,V,F,K,q,ee,$e.x,$e.y)&&ti($e.prev,$e,$e.next)>=0))return!1;$e=$e.nextZ}for(;Re&&Re.z>=Pe;){if(Re.x>=re&&Re.x<=pe&&Re.y>=ae&&Re.y<=_e&&Re!==_&&Re!==A&&s0(M,V,F,K,q,ee,Re.x,Re.y)&&ti(Re.prev,Re,Re.next)>=0)return!1;Re=Re.prevZ}for(;$e&&$e.z<=Qe;){if($e.x>=re&&$e.x<=pe&&$e.y>=ae&&$e.y<=_e&&$e!==_&&$e!==A&&s0(M,V,F,K,q,ee,$e.x,$e.y)&&ti($e.prev,$e,$e.next)>=0)return!1;$e=$e.nextZ}return!0}function TY(h,c){let u=h;do{const x=u.prev,_=u.next.next;!hx(x,_)&&bD(x,u,u.next,_)&&i0(x,_)&&i0(_,x)&&(c.push(x.i,u.i,_.i),a0(u),a0(u.next),u=h=_),u=u.next}while(u!==h);return of(u)}function EY(h,c,u,x,_,C){let A=h;do{let M=A.next.next;for(;M!==A.prev;){if(A.i!==M.i&&RY(A,M)){let F=jD(A,M);return A=of(A,A.next),F=of(F,F.next),n0(A,c,u,x,_,C,0),void n0(F,c,u,x,_,C,0)}M=M.next}A=A.next}while(A!==h)}function MY(h,c){let u=h.x-c.x;return u===0&&(u=h.y-c.y,u===0)&&(u=(h.next.y-h.y)/(h.next.x-h.x)-(c.next.y-c.y)/(c.next.x-c.x)),u}function OY(h,c){const u=function(_,C){let A=C;const M=_.x,F=_.y;let q,V=-1/0;if(hx(_,A))return A;do{if(hx(_,A.next))return A.next;if(F<=A.y&&F>=A.next.y&&A.next.y!==A.y){const pe=A.x+(F-A.y)*(A.next.x-A.x)/(A.next.y-A.y);if(pe<=M&&pe>V&&(V=pe,q=A.x<A.next.x?A:A.next,pe===M))return q}A=A.next}while(A!==C);if(!q)return null;const K=q,ee=q.x,re=q.y;let ae=1/0;A=q;do{if(M>=A.x&&A.x>=ee&&M!==A.x&&_D(F<re?M:V,F,ee,re,F<re?V:M,F,A.x,A.y)){const pe=Math.abs(F-A.y)/(M-A.x);i0(A,_)&&(pe<ae||pe===ae&&(A.x>q.x||A.x===q.x&&IY(q,A)))&&(q=A,ae=pe)}A=A.next}while(A!==K);return q}(h,c);if(!u)return c;const x=jD(u,h);return of(x,x.next),of(u,u.next)}function IY(h,c){return ti(h.prev,h,c.prev)<0&&ti(c.next,h,h.next)<0}function _C(h,c,u,x,_){return(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-u)*_|0)|h<<8))|h<<4))|h<<2))|h<<1))|(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-x)*_|0)|c<<8))|c<<4))|c<<2))|c<<1))<<1}function DY(h){let c=h,u=h;do(c.x<u.x||c.x===u.x&&c.y<u.y)&&(u=c),c=c.next;while(c!==h);return u}function _D(h,c,u,x,_,C,A,M){return(_-A)*(c-M)>=(h-A)*(C-M)&&(h-A)*(x-M)>=(u-A)*(c-M)&&(u-A)*(C-M)>=(_-A)*(x-M)}function s0(h,c,u,x,_,C,A,M){return!(h===A&&c===M)&&_D(h,c,u,x,_,C,A,M)}function RY(h,c){return h.next.i!==c.i&&h.prev.i!==c.i&&!function(u,x){let _=u;do{if(_.i!==u.i&&_.next.i!==u.i&&_.i!==x.i&&_.next.i!==x.i&&bD(_,_.next,u,x))return!0;_=_.next}while(_!==u);return!1}(h,c)&&(i0(h,c)&&i0(c,h)&&function(u,x){let _=u,C=!1;const A=(u.x+x.x)/2,M=(u.y+x.y)/2;do _.y>M!=_.next.y>M&&_.next.y!==_.y&&A<(_.next.x-_.x)*(M-_.y)/(_.next.y-_.y)+_.x&&(C=!C),_=_.next;while(_!==u);return C}(h,c)&&(ti(h.prev,h,c.prev)||ti(h,c.prev,c))||hx(h,c)&&ti(h.prev,h,h.next)>0&&ti(c.prev,c,c.next)>0)}function ti(h,c,u){return(c.y-h.y)*(u.x-c.x)-(c.x-h.x)*(u.y-c.y)}function hx(h,c){return h.x===c.x&&h.y===c.y}function bD(h,c,u,x){const _=jw(ti(h,c,u)),C=jw(ti(h,c,x)),A=jw(ti(u,x,h)),M=jw(ti(u,x,c));return _!==C&&A!==M||!(_!==0||!bw(h,u,c))||!(C!==0||!bw(h,x,c))||!(A!==0||!bw(u,h,x))||!(M!==0||!bw(u,c,x))}function bw(h,c,u){return c.x<=Math.max(h.x,u.x)&&c.x>=Math.min(h.x,u.x)&&c.y<=Math.max(h.y,u.y)&&c.y>=Math.min(h.y,u.y)}function jw(h){return h>0?1:h<0?-1:0}function i0(h,c){return ti(h.prev,h,h.next)<0?ti(h,c,h.next)>=0&&ti(h,h.prev,c)>=0:ti(h,c,h.prev)<0||ti(h,h.next,c)<0}function jD(h,c){const u=bC(h.i,h.x,h.y),x=bC(c.i,c.x,c.y),_=h.next,C=c.prev;return h.next=c,c.prev=h,u.next=_,_.prev=u,x.next=u,u.prev=x,C.next=x,x.prev=C,x}function wD(h,c,u,x){const _=bC(h,c,u);return x?(_.next=x.next,_.prev=x,x.next.prev=_,x.next=_):(_.prev=_,_.next=_),_}function a0(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function bC(h,c,u){return{i:h,x:c,y:u,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class mx{constructor(c,u){if(u>c)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=c,this._minGranularity=u}getGranularityForZoomLevel(c){return Math.max(Math.floor(this._baseZoomGranularity/(1<<c)),this._minGranularity,1)}}class ww{constructor(c){this.fill=c.fill,this.line=c.line,this.tile=c.tile,this.stencil=c.stencil,this.circle=c.circle}}ww.noSubdivision=new ww({fill:new mx(0,0),line:new mx(0,0),tile:new mx(0,0),stencil:new mx(0,0),circle:1}),er("SubdivisionGranularityExpression",mx),er("SubdivisionGranularitySetting",ww);const fx=-32768,o0=32767;class LY{constructor(c,u){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=c,this._granularityCellSize=ve/c,this._canonical=u}_getKey(c,u){return(c+=32768)<<16|u+32768}_vertexToIndex(c,u){if(c<-32768||u<-32768||c>32767||u>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const x=0|Math.round(c),_=0|Math.round(u),C=this._getKey(x,_);if(this._vertexDictionary.has(C))return this._vertexDictionary.get(C);const A=this._vertexBuffer.length/2;return this._vertexDictionary.set(C,A),this._vertexBuffer.push(x,_),A}_subdivideTrianglesScanline(c){if(this._granularity<2)return function(_,C){const A=[];for(let M=0;M<C.length;M+=3){const F=C[M],q=C[M+1],V=C[M+2],K=_[2*F],ee=_[2*F+1];(_[2*q]-K)*(_[2*V+1]-ee)-(_[2*q+1]-ee)*(_[2*V]-K)>0?(A.push(F),A.push(V),A.push(q)):(A.push(F),A.push(q),A.push(V))}return A}(this._vertexBuffer,c);const u=[],x=c.length;for(let _=0;_<x;_+=3){const C=[c[_+0],c[_+1],c[_+2]],A=[this._vertexBuffer[2*c[_+0]+0],this._vertexBuffer[2*c[_+0]+1],this._vertexBuffer[2*c[_+1]+0],this._vertexBuffer[2*c[_+1]+1],this._vertexBuffer[2*c[_+2]+0],this._vertexBuffer[2*c[_+2]+1]];let M=1/0,F=1/0,q=-1/0,V=-1/0;for(let pe=0;pe<3;pe++){const _e=A[2*pe],Pe=A[2*pe+1];M=Math.min(M,_e),q=Math.max(q,_e),F=Math.min(F,Pe),V=Math.max(V,Pe)}if(M===q||F===V)continue;const K=Math.floor(M/this._granularityCellSize),ee=Math.ceil(q/this._granularityCellSize),re=Math.floor(F/this._granularityCellSize),ae=Math.ceil(V/this._granularityCellSize);if(K!==ee||re!==ae)for(let pe=re;pe<ae;pe++){const _e=this._scanlineGenerateVertexRingForCellRow(pe,A,C);FY(this._vertexBuffer,_e,u)}else u.push(...C)}return u}_scanlineGenerateVertexRingForCellRow(c,u,x){const _=c*this._granularityCellSize,C=_+this._granularityCellSize,A=[];for(let M=0;M<3;M++){const F=u[2*M],q=u[2*M+1],V=u[2*(M+1)%6],K=u[(2*(M+1)+1)%6],ee=u[2*(M+2)%6],re=u[(2*(M+2)+1)%6],ae=V-F,pe=K-q,_e=ae===0,Pe=pe===0,Qe=(_-q)/pe,Re=(C-q)/pe,$e=Math.min(Qe,Re),at=Math.max(Qe,Re);if(!Pe&&($e>=1||at<=0)||Pe&&(q<_||q>C)){K>=_&&K<=C&&A.push(x[(M+1)%3]);continue}!Pe&&$e>0&&A.push(this._vertexToIndex(F+ae*$e,q+pe*$e));const ft=F+ae*Math.max($e,0),At=F+ae*Math.min(at,1);_e||this._generateIntraEdgeVertices(A,F,q,V,K,ft,At),!Pe&&at<1&&A.push(this._vertexToIndex(F+ae*at,q+pe*at)),(Pe||K>=_&&K<=C)&&A.push(x[(M+1)%3]),!Pe&&(K<=_||K>=C)&&this._generateInterEdgeVertices(A,F,q,V,K,ee,re,At,_,C)}return A}_generateIntraEdgeVertices(c,u,x,_,C,A,M){const F=_-u,q=C-x,V=q===0,K=V?Math.min(u,_):Math.min(A,M),ee=V?Math.max(u,_):Math.max(A,M),re=Math.floor(K/this._granularityCellSize)+1,ae=Math.ceil(ee/this._granularityCellSize)-1;if(V?u<_:A<M)for(let pe=re;pe<=ae;pe++){const _e=pe*this._granularityCellSize;c.push(this._vertexToIndex(_e,x+q*(_e-u)/F))}else for(let pe=ae;pe>=re;pe--){const _e=pe*this._granularityCellSize;c.push(this._vertexToIndex(_e,x+q*(_e-u)/F))}}_generateInterEdgeVertices(c,u,x,_,C,A,M,F,q,V){const K=C-x,ee=A-_,re=M-C,ae=(q-C)/re,pe=(V-C)/re,_e=Math.min(ae,pe),Pe=Math.max(ae,pe),Qe=_+ee*_e;let Re=Math.floor(Math.min(Qe,F)/this._granularityCellSize)+1,$e=Math.ceil(Math.max(Qe,F)/this._granularityCellSize)-1,at=F<Qe;const ft=re===0;if(ft&&(M===q||M===V))return;if(ft||_e>=1||Pe<=0){const Yt=x-M,zt=A+(u-A)*Math.min((q-M)/Yt,(V-M)/Yt);Re=Math.floor(Math.min(zt,F)/this._granularityCellSize)+1,$e=Math.ceil(Math.max(zt,F)/this._granularityCellSize)-1,at=F<zt}const At=K>0?V:q;if(at)for(let Yt=Re;Yt<=$e;Yt++)c.push(this._vertexToIndex(Yt*this._granularityCellSize,At));else for(let Yt=$e;Yt>=Re;Yt--)c.push(this._vertexToIndex(Yt*this._granularityCellSize,At))}_generateOutline(c){const u=[];for(const x of c){const _=lf(x,this._granularity,!0),C=this._pointArrayToIndices(_),A=[];for(let M=1;M<C.length;M++)A.push(C[M-1]),A.push(C[M]);u.push(A)}return u}_handlePoles(c){let u=!1,x=!1;this._canonical&&(this._canonical.y===0&&(u=!0),this._canonical.y===(1<<this._canonical.z)-1&&(x=!0)),(u||x)&&this._fillPoles(c,u,x)}_ensureNoPoleVertices(){const c=this._vertexBuffer;for(let u=0;u<c.length;u+=2){const x=c[u+1];x===fx&&(c[u+1]=-32767),x===o0&&(c[u+1]=32766)}}_generatePoleQuad(c,u,x,_,C,A){_>C!=(A===fx)?(c.push(u),c.push(x),c.push(this._vertexToIndex(_,A)),c.push(x),c.push(this._vertexToIndex(C,A)),c.push(this._vertexToIndex(_,A))):(c.push(x),c.push(u),c.push(this._vertexToIndex(_,A)),c.push(this._vertexToIndex(C,A)),c.push(x),c.push(this._vertexToIndex(_,A)))}_fillPoles(c,u,x){const _=this._vertexBuffer,C=ve,A=c.length;for(let M=2;M<A;M+=3){const F=c[M-2],q=c[M-1],V=c[M],K=_[2*F],ee=_[2*F+1],re=_[2*q],ae=_[2*q+1],pe=_[2*V],_e=_[2*V+1];u&&(ee===0&&ae===0&&this._generatePoleQuad(c,F,q,K,re,fx),ae===0&&_e===0&&this._generatePoleQuad(c,q,V,re,pe,fx),_e===0&&ee===0&&this._generatePoleQuad(c,V,F,pe,K,fx)),x&&(ee===C&&ae===C&&this._generatePoleQuad(c,F,q,K,re,o0),ae===C&&_e===C&&this._generatePoleQuad(c,q,V,re,pe,o0),_e===C&&ee===C&&this._generatePoleQuad(c,V,F,pe,K,o0))}}_initializeVertices(c){for(let u=0;u<c.length;u+=2)this._vertexToIndex(c[u],c[u+1])}subdividePolygonInternal(c,u){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:x,holeIndices:_}=function(M){const F=[],q=[];for(const V of M)if(V.length!==0){V!==M[0]&&F.push(q.length/2);for(let K=0;K<V.length;K++)q.push(V[K].x),q.push(V[K].y)}return{flattened:q,holeIndices:F}}(c);let C;this._initializeVertices(x);try{const M=function(q,V,K=2){const ee=V&&V.length,re=ee?V[0]*K:q.length;let ae=vD(q,0,re,K,!0);const pe=[];if(!ae||ae.next===ae.prev)return pe;let _e,Pe,Qe;if(ee&&(ae=function(Re,$e,at,ft){const At=[];for(let Yt=0,zt=$e.length;Yt<zt;Yt++){const Kt=vD(Re,$e[Yt]*ft,Yt<zt-1?$e[Yt+1]*ft:Re.length,ft,!1);Kt===Kt.next&&(Kt.steiner=!0),At.push(DY(Kt))}At.sort(MY);for(let Yt=0;Yt<At.length;Yt++)at=OY(At[Yt],at);return at}(q,V,ae,K)),q.length>80*K){_e=q[0],Pe=q[1];let Re=_e,$e=Pe;for(let at=K;at<re;at+=K){const ft=q[at],At=q[at+1];ft<_e&&(_e=ft),At<Pe&&(Pe=At),ft>Re&&(Re=ft),At>$e&&($e=At)}Qe=Math.max(Re-_e,$e-Pe),Qe=Qe!==0?32767/Qe:0}return n0(ae,pe,K,_e,Pe,Qe,0),pe}(x,_),F=this._convertIndices(x,M);C=this._subdivideTrianglesScanline(F)}catch(M){console.error(M)}let A=[];return u&&(A=this._generateOutline(c)),this._ensureNoPoleVertices(),this._handlePoles(C),{verticesFlattened:this._vertexBuffer,indicesTriangles:C,indicesLineList:A}}_convertIndices(c,u){const x=[];for(let _=0;_<u.length;_++)x.push(this._vertexToIndex(c[2*u[_]],c[2*u[_]+1]));return x}_pointArrayToIndices(c){const u=[];for(let x=0;x<c.length;x++){const _=c[x];u.push(this._vertexToIndex(_.x,_.y))}return u}}function ND(h,c,u,x=!0){return new LY(u,c).subdividePolygonInternal(h,x)}function lf(h,c,u=!1){if(!h||h.length<1)return[];if(h.length<2)return[];const x=h[0],_=h[h.length-1],C=u&&(x.x!==_.x||x.y!==_.y);if(c<2)return C?[...h,h[0]]:[...h];const A=Math.floor(ve/c),M=[];M.push(new f(h[0].x,h[0].y));const F=h.length,q=C?F:F-1;for(let V=0;V<q;V++){const K=h[V],ee=V<F-1?h[V+1]:h[0],re=K.x,ae=K.y,pe=ee.x,_e=ee.y,Pe=re!==pe,Qe=ae!==_e;if(!Pe&&!Qe)continue;const Re=pe-re,$e=_e-ae,at=Math.abs(Re),ft=Math.abs($e);let At=re,Yt=ae;for(;;){const Kt=Re>0?(Math.floor(At/A)+1)*A:(Math.ceil(At/A)-1)*A,br=$e>0?(Math.floor(Yt/A)+1)*A:(Math.ceil(Yt/A)-1)*A,Wt=Math.abs(At-Kt),Ht=Math.abs(Yt-br),_t=Math.abs(At-pe),Fr=Math.abs(Yt-_e),$r=Pe?Wt/at:Number.POSITIVE_INFINITY,Ar=Qe?Ht/ft:Number.POSITIVE_INFINITY;if((_t<=Wt||!Pe)&&(Fr<=Ht||!Qe))break;if($r<Ar&&Pe||!Qe){At=Kt,Yt+=$e*$r;const dr=new f(At,Math.round(Yt));M[M.length-1].x===dr.x&&M[M.length-1].y===dr.y||M.push(dr)}else{At+=Re*Ar,Yt=br;const dr=new f(Math.round(At),Yt);M[M.length-1].x===dr.x&&M[M.length-1].y===dr.y||M.push(dr)}}const zt=new f(pe,_e);M[M.length-1].x===zt.x&&M[M.length-1].y===zt.y||M.push(zt)}return M}function FY(h,c,u){if(c.length===0)throw new Error("Subdivision vertex ring is empty.");let x=0,_=h[2*c[0]];for(let F=1;F<c.length;F++){const q=h[2*c[F]];q<_&&(_=q,x=F)}const C=c.length;let A=x,M=(A+1)%C;for(;;){const F=A-1>=0?A-1:C-1,q=(M+1)%C,V=h[2*c[F]],K=h[2*c[q]],ee=h[2*c[A]],re=h[2*c[A]+1],ae=h[2*c[M]+1];let pe=!1;if(V<K)pe=!0;else if(V>K)pe=!1;else{const _e=ae-re,Pe=-(h[2*c[M]]-ee),Qe=re<ae?1:-1;((V-ee)*_e+(h[2*c[F]+1]-re)*Pe)*Qe>((K-ee)*_e+(h[2*c[q]+1]-re)*Pe)*Qe&&(pe=!0)}if(pe){const _e=c[F],Pe=c[A],Qe=c[M];_e!==Pe&&_e!==Qe&&Pe!==Qe&&u.push(Qe,Pe,_e),A--,A<0&&(A=C-1)}else{const _e=c[q],Pe=c[A],Qe=c[M];_e!==Pe&&_e!==Qe&&Pe!==Qe&&u.push(Qe,Pe,_e),M++,M>=C&&(M=0)}if(F===q)break}}function SD(h,c,u,x,_,C,A,M,F){const q=_.length/2,V=A&&M&&F;if(q<Hr.MAX_VERTEX_ARRAY_LENGTH){const K=c.prepareSegment(q,u,x),ee=K.vertexLength;for(let pe=0;pe<C.length;pe+=3)x.emplaceBack(ee+C[pe],ee+C[pe+1],ee+C[pe+2]);let re,ae;K.vertexLength+=q,K.primitiveLength+=C.length/3,V&&(ae=A.prepareSegment(q,u,M),re=ae.vertexLength,ae.vertexLength+=q);for(let pe=0;pe<_.length;pe+=2)h(_[pe],_[pe+1]);if(V)for(let pe=0;pe<F.length;pe++){const _e=F[pe];for(let Pe=1;Pe<_e.length;Pe+=2)M.emplaceBack(re+_e[Pe-1],re+_e[Pe]);ae.primitiveLength+=_e.length/2}}else(function(K,ee,re,ae,pe,_e){const Pe=[];for(let ft=0;ft<ae.length/2;ft++)Pe.push(-1);const Qe={count:0};let Re=0,$e=K.getOrCreateLatestSegment(ee,re),at=$e.vertexLength;for(let ft=2;ft<pe.length;ft+=3){const At=pe[ft-2],Yt=pe[ft-1],zt=pe[ft];let Kt=Pe[At]<Re,br=Pe[Yt]<Re,Wt=Pe[zt]<Re;$e.vertexLength+((Kt?1:0)+(br?1:0)+(Wt?1:0))>Hr.MAX_VERTEX_ARRAY_LENGTH&&($e=K.createNewSegment(ee,re),Re=Qe.count,Kt=!0,br=!0,Wt=!0,at=0);const Ht=l0(Pe,ae,_e,Qe,At,Kt,$e),_t=l0(Pe,ae,_e,Qe,Yt,br,$e),Fr=l0(Pe,ae,_e,Qe,zt,Wt,$e);re.emplaceBack(at+Ht-Re,at+_t-Re,at+Fr-Re),$e.primitiveLength++}})(c,u,x,_,C,h),V&&function(K,ee,re,ae,pe,_e){const Pe=[];for(let ft=0;ft<ae.length/2;ft++)Pe.push(-1);const Qe={count:0};let Re=0,$e=K.getOrCreateLatestSegment(ee,re),at=$e.vertexLength;for(let ft=0;ft<pe.length;ft++){const At=pe[ft];for(let Yt=1;Yt<pe[ft].length;Yt+=2){const zt=At[Yt-1],Kt=At[Yt];let br=Pe[zt]<Re,Wt=Pe[Kt]<Re;$e.vertexLength+((br?1:0)+(Wt?1:0))>Hr.MAX_VERTEX_ARRAY_LENGTH&&($e=K.createNewSegment(ee,re),Re=Qe.count,br=!0,Wt=!0,at=0);const Ht=l0(Pe,ae,_e,Qe,zt,br,$e),_t=l0(Pe,ae,_e,Qe,Kt,Wt,$e);re.emplaceBack(at+Ht-Re,at+_t-Re),$e.primitiveLength++}}}(A,u,M,_,F,h),c.forceNewSegmentOnNextPrepare(),A==null||A.forceNewSegmentOnNextPrepare()}function l0(h,c,u,x,_,C,A){if(C){const M=x.count;return u(c[2*_],c[2*_+1]),h[_]=x.count,x.count++,A.vertexLength++,M}return h[_]}class jC{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(u=>u.id),this.index=c.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new ke,this.indexArray=new bt,this.indexArray2=new ir,this.programConfigurations=new Ud(c.layers,c.zoom),this.segments=new Hr,this.segments2=new Hr,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(c,u,x){this.hasDependencies=_w("fill",this.layers,u);const _=this.layers[0].layout.get("fill-sort-key"),C=!_.isConstant(),A=[];for(const{feature:M,id:F,index:q,sourceLayerIndex:V}of c){const K=this.layers[0]._featureFilter.needGeometry,ee=qc(M,K);if(!this.layers[0]._featureFilter.filter(new Gn(this.zoom),ee,x))continue;const re=C?_.evaluate(ee,{},x,u.availableImages):void 0,ae={id:F,properties:M.properties,type:M.type,sourceLayerIndex:V,index:q,geometry:K?ee.geometry:tc(M),patterns:{},sortKey:re};A.push(ae)}C&&A.sort((M,F)=>M.sortKey-F.sortKey);for(const M of A){const{geometry:F,index:q,sourceLayerIndex:V}=M;if(this.hasDependencies){const K=vC("fill",this.layers,M,{zoom:this.zoom},u);this.patternFeatures.push(K)}else this.addFeature(M,F,q,x,{},u.subdivisionGranularity);u.featureIndex.insert(c[q].feature,F,q,V,this.index)}}update(c,u,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,u,this.stateDependentLayers,{imagePositions:x})}addFeatures(c,u,x){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,u,x,c.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,CY),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.indexBuffer2=c.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(c,u,x,_,C,A){for(const M of Ip(u,500)){const F=ND(M,_,A.fill.getGranularityForZoomLevel(_.z)),q=this.layoutVertexArray;SD((V,K)=>{q.emplaceBack(V,K)},this.segments,this.layoutVertexArray,this.indexArray,F.verticesFlattened,F.indicesTriangles,this.segments2,this.indexArray2,F.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,x,{imagePositions:C,canonical:_})}}let PD,CD;er("FillBucket",jC,{omit:["layers","patternFeatures"]});var zY={get paint(){return CD=CD||new oa({"fill-antialias":new pr(Je.paint_fill["fill-antialias"]),"fill-opacity":new Ir(Je.paint_fill["fill-opacity"]),"fill-color":new Ir(Je.paint_fill["fill-color"]),"fill-outline-color":new Ir(Je.paint_fill["fill-outline-color"]),"fill-translate":new pr(Je.paint_fill["fill-translate"]),"fill-translate-anchor":new pr(Je.paint_fill["fill-translate-anchor"]),"fill-pattern":new rf(Je.paint_fill["fill-pattern"])})},get layout(){return PD=PD||new oa({"fill-sort-key":new Ir(Je.layout_fill["fill-sort-key"])})}};class $Y extends $o{constructor(c,u){super(c,zY,u)}recalculate(c,u){super.recalculate(c,u);const x=this.paint._values["fill-outline-color"];x.value.kind==="constant"&&x.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new jC(c)}queryRadius(){return yw(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:c,geometry:u,transform:x,pixelsToTileUnits:_}){return iD(vw(c,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-x.bearingInRadians,_),u)}isTileClipped(){return!0}}const BY=qs([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),qY=qs([{name:"a_centroid",components:2,type:"Int16"}],4),{members:VY}=BY;class px{constructor(c,u,x,_,C){this.properties={},this.extent=x,this.type=0,this.id=void 0,this._pbf=c,this._geometry=-1,this._keys=_,this._values=C,c.readFields(UY,this,u)}loadGeometry(){const c=this._pbf;c.pos=this._geometry;const u=c.readVarint()+c.pos,x=[];let _,C=1,A=0,M=0,F=0;for(;c.pos<u;){if(A<=0){const q=c.readVarint();C=7&q,A=q>>3}if(A--,C===1||C===2)M+=c.readSVarint(),F+=c.readSVarint(),C===1&&(_&&x.push(_),_=[]),_&&_.push(new f(M,F));else{if(C!==7)throw new Error(`unknown command ${C}`);_&&_.push(_[0].clone())}}return _&&x.push(_),x}bbox(){const c=this._pbf;c.pos=this._geometry;const u=c.readVarint()+c.pos;let x=1,_=0,C=0,A=0,M=1/0,F=-1/0,q=1/0,V=-1/0;for(;c.pos<u;){if(_<=0){const K=c.readVarint();x=7&K,_=K>>3}if(_--,x===1||x===2)C+=c.readSVarint(),A+=c.readSVarint(),C<M&&(M=C),C>F&&(F=C),A<q&&(q=A),A>V&&(V=A);else if(x!==7)throw new Error(`unknown command ${x}`)}return[M,q,F,V]}toGeoJSON(c,u,x){const _=this.extent*Math.pow(2,x),C=this.extent*c,A=this.extent*u,M=this.loadGeometry();function F(ee){return[360*(ee.x+C)/_-180,360/Math.PI*Math.atan(Math.exp((1-2*(ee.y+A)/_)*Math.PI))-90]}function q(ee){return ee.map(F)}let V;if(this.type===1){const ee=[];for(const ae of M)ee.push(ae[0]);const re=q(ee);V=ee.length===1?{type:"Point",coordinates:re[0]}:{type:"MultiPoint",coordinates:re}}else if(this.type===2){const ee=M.map(q);V=ee.length===1?{type:"LineString",coordinates:ee[0]}:{type:"MultiLineString",coordinates:ee}}else{if(this.type!==3)throw new Error("unknown feature type");{const ee=function(ae){const pe=ae.length;if(pe<=1)return[ae];const _e=[];let Pe,Qe;for(let Re=0;Re<pe;Re++){const $e=WY(ae[Re]);$e!==0&&(Qe===void 0&&(Qe=$e<0),Qe===$e<0?(Pe&&_e.push(Pe),Pe=[ae[Re]]):Pe&&Pe.push(ae[Re]))}return Pe&&_e.push(Pe),_e}(M),re=[];for(const ae of ee)re.push(ae.map(q));V=re.length===1?{type:"Polygon",coordinates:re[0]}:{type:"MultiPolygon",coordinates:re}}}const K={type:"Feature",geometry:V,properties:this.properties};return this.id!=null&&(K.id=this.id),K}}function UY(h,c,u){h===1?c.id=u.readVarint():h===2?function(x,_){const C=x.readVarint()+x.pos;for(;x.pos<C;){const A=_._keys[x.readVarint()],M=_._values[x.readVarint()];_.properties[A]=M}}(u,c):h===3?c.type=u.readVarint():h===4&&(c._geometry=u.pos)}function WY(h){let c=0;for(let u,x,_=0,C=h.length,A=C-1;_<C;A=_++)u=h[_],x=h[A],c+=(x.x-u.x)*(u.y+x.y);return c}px.types=["Unknown","Point","LineString","Polygon"];class AD{constructor(c,u){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(GY,this,u),this.length=this._features.length}feature(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];const u=this._pbf.readVarint()+this._pbf.pos;return new px(this._pbf,u,this.extent,this._keys,this._values)}}function GY(h,c,u){h===15?c.version=u.readVarint():h===1?c.name=u.readString():h===5?c.extent=u.readVarint():h===2?c._features.push(u.pos):h===3?c._keys.push(u.readString()):h===4&&c._values.push(function(x){let _=null;const C=x.readVarint()+x.pos;for(;x.pos<C;){const A=x.readVarint()>>3;_=A===1?x.readString():A===2?x.readFloat():A===3?x.readDouble():A===4?x.readVarint64():A===5?x.readVarint():A===6?x.readSVarint():A===7?x.readBoolean():null}if(_==null)throw new Error("unknown feature value");return _}(u))}class kD{constructor(c,u){this.layers=c.readFields(KY,{},u)}}function KY(h,c,u){if(h===3){const x=new AD(u,u.readVarint()+u.pos);x.length&&(c[x.name]=x)}}const wC=Math.pow(2,13);function c0(h,c,u,x,_,C,A,M){h.emplaceBack(c,u,2*Math.floor(x*wC)+A,_*wC*2,C*wC*2,Math.round(M))}class NC{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(u=>u.id),this.index=c.index,this.hasDependencies=!1,this.layoutVertexArray=new Fe,this.centroidVertexArray=new Te,this.indexArray=new bt,this.programConfigurations=new Ud(c.layers,c.zoom),this.segments=new Hr,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(c,u,x){this.features=[],this.hasDependencies=_w("fill-extrusion",this.layers,u);for(const{feature:_,id:C,index:A,sourceLayerIndex:M}of c){const F=this.layers[0]._featureFilter.needGeometry,q=qc(_,F);if(!this.layers[0]._featureFilter.filter(new Gn(this.zoom),q,x))continue;const V={id:C,sourceLayerIndex:M,index:A,geometry:F?q.geometry:tc(_),properties:_.properties,type:_.type,patterns:{}};this.hasDependencies?this.features.push(vC("fill-extrusion",this.layers,V,{zoom:this.zoom},u)):this.addFeature(V,V.geometry,A,x,{},u.subdivisionGranularity),u.featureIndex.insert(_,V.geometry,A,M,this.index,!0)}}addFeatures(c,u,x){for(const _ of this.features){const{geometry:C}=_;this.addFeature(_,C,_.index,u,x,c.subdivisionGranularity)}}update(c,u,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,u,this.stateDependentLayers,{imagePositions:x})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,VY),this.centroidVertexBuffer=c.createVertexBuffer(this.centroidVertexArray,qY.members,!0),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(c,u,x,_,C,A){for(const M of Ip(u,500)){const F={x:0,y:0,sampleCount:0},q=this.layoutVertexArray.length;this.processPolygon(F,_,c,M,A);const V=this.layoutVertexArray.length-q,K=Math.floor(F.x/F.sampleCount),ee=Math.floor(F.y/F.sampleCount);for(let re=0;re<V;re++)this.centroidVertexArray.emplaceBack(K,ee)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,x,{imagePositions:C,canonical:_})}processPolygon(c,u,x,_,C){if(_.length<1||TD(_[0]))return;for(const K of _)K.length!==0&&HY(c,K);const A={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},M=C.fill.getGranularityForZoomLevel(u.z),F=px.types[x.type]==="Polygon";for(const K of _){if(K.length===0||TD(K))continue;const ee=lf(K,M,F);this._generateSideFaces(ee,A)}if(!F)return;const q=ND(_,u,M,!1),V=this.layoutVertexArray;SD((K,ee)=>{c0(V,K,ee,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,q.verticesFlattened,q.indicesTriangles)}_generateSideFaces(c,u){let x=0;for(let _=1;_<c.length;_++){const C=c[_],A=c[_-1];if(ZY(C,A))continue;u.segment.vertexLength+4>Hr.MAX_VERTEX_ARRAY_LENGTH&&(u.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const M=C.sub(A)._perp()._unit(),F=A.dist(C);x+F>32768&&(x=0),c0(this.layoutVertexArray,C.x,C.y,M.x,M.y,0,0,x),c0(this.layoutVertexArray,C.x,C.y,M.x,M.y,0,1,x),x+=F,c0(this.layoutVertexArray,A.x,A.y,M.x,M.y,0,0,x),c0(this.layoutVertexArray,A.x,A.y,M.x,M.y,0,1,x);const q=u.segment.vertexLength;this.indexArray.emplaceBack(q,q+2,q+1),this.indexArray.emplaceBack(q+1,q+2,q+3),u.segment.vertexLength+=4,u.segment.primitiveLength+=2}}}function HY(h,c){for(let u=0;u<c.length;u++){const x=c[u];u===c.length-1&&c[0].x===x.x&&c[0].y===x.y||(h.x+=x.x,h.y+=x.y,h.sampleCount++)}}function ZY(h,c){return h.x===c.x&&(h.x<0||h.x>ve)||h.y===c.y&&(h.y<0||h.y>ve)}function TD(h){return h.every(c=>c.x<0)||h.every(c=>c.x>ve)||h.every(c=>c.y<0)||h.every(c=>c.y>ve)}let ED;er("FillExtrusionBucket",NC,{omit:["layers","features"]});var YY={get paint(){return ED=ED||new oa({"fill-extrusion-opacity":new pr(Je["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ir(Je["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new pr(Je["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new pr(Je["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new rf(Je["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ir(Je["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ir(Je["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new pr(Je["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class XY extends $o{constructor(c,u){super(c,YY,u)}createBucket(c){return new NC(c)}queryRadius(){return yw(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:c,feature:u,featureState:x,geometry:_,transform:C,pixelsToTileUnits:A,pixelPosMatrix:M}){const F=vw(c,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-C.bearingInRadians,A),q=this.paint.get("fill-extrusion-height").evaluate(u,x),V=this.paint.get("fill-extrusion-base").evaluate(u,x),K=function(re,ae){const pe=[];for(const _e of re){const Pe=[_e.x,_e.y,0,1];Oe(Pe,Pe,ae),pe.push(new f(Pe[0]/Pe[3],Pe[1]/Pe[3]))}return pe}(F,M),ee=function(re,ae,pe,_e){const Pe=[],Qe=[],Re=_e[8]*ae,$e=_e[9]*ae,at=_e[10]*ae,ft=_e[11]*ae,At=_e[8]*pe,Yt=_e[9]*pe,zt=_e[10]*pe,Kt=_e[11]*pe;for(const br of re){const Wt=[],Ht=[];for(const _t of br){const Fr=_t.x,$r=_t.y,Ar=_e[0]*Fr+_e[4]*$r+_e[12],dr=_e[1]*Fr+_e[5]*$r+_e[13],hn=_e[2]*Fr+_e[6]*$r+_e[14],Ts=_e[3]*Fr+_e[7]*$r+_e[15],_i=hn+at,ca=Ts+ft,Vo=Ar+At,to=dr+Yt,Ui=hn+zt,bs=Ts+Kt,Ei=new f((Ar+Re)/ca,(dr+$e)/ca);Ei.z=_i/ca,Wt.push(Ei);const Wi=new f(Vo/bs,to/bs);Wi.z=Ui/bs,Ht.push(Wi)}Pe.push(Wt),Qe.push(Ht)}return[Pe,Qe]}(_,V,q,M);return function(re,ae,pe){let _e=1/0;iD(pe,ae)&&(_e=MD(pe,ae[0]));for(let Pe=0;Pe<ae.length;Pe++){const Qe=ae[Pe],Re=re[Pe];for(let $e=0;$e<Qe.length-1;$e++){const at=Qe[$e],ft=[at,Qe[$e+1],Re[$e+1],Re[$e],at];sD(pe,ft)&&(_e=Math.min(_e,MD(pe,ft)))}}return _e!==1/0&&_e}(ee[0],ee[1],K)}}function d0(h,c){return h.x*c.x+h.y*c.y}function MD(h,c){if(h.length===1){let u=0;const x=c[u++];let _;for(;!_||x.equals(_);)if(_=c[u++],!_)return 1/0;for(;u<c.length;u++){const C=c[u],A=h[0],M=_.sub(x),F=C.sub(x),q=A.sub(x),V=d0(M,M),K=d0(M,F),ee=d0(F,F),re=d0(q,M),ae=d0(q,F),pe=V*ee-K*K,_e=(ee*re-K*ae)/pe,Pe=(V*ae-K*re)/pe,Qe=x.z*(1-_e-Pe)+_.z*_e+C.z*Pe;if(isFinite(Qe))return Qe}return 1/0}{let u=1/0;for(const x of c)u=Math.min(u,x.z);return u}}const QY=qs([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:JY}=QY,eX=qs([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:tX}=eX,rX=Math.cos(Math.PI/180*37.5),OD=Math.pow(2,14)/.5;class SC{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(u=>u.id),this.index=c.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new Be,this.layoutVertexArray2=new De,this.indexArray=new bt,this.programConfigurations=new Ud(c.layers,c.zoom),this.segments=new Hr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(c,u,x){this.hasDependencies=_w("line",this.layers,u)||this.hasLineDasharray(this.layers);const _=this.layers[0].layout.get("line-sort-key"),C=!_.isConstant(),A=[];for(const{feature:M,id:F,index:q,sourceLayerIndex:V}of c){const K=this.layers[0]._featureFilter.needGeometry,ee=qc(M,K);if(!this.layers[0]._featureFilter.filter(new Gn(this.zoom),ee,x))continue;const re=C?_.evaluate(ee,{},x):void 0,ae={id:F,properties:M.properties,type:M.type,sourceLayerIndex:V,index:q,geometry:K?ee.geometry:tc(M),patterns:{},dashes:{},sortKey:re};A.push(ae)}C&&A.sort((M,F)=>M.sortKey-F.sortKey);for(const M of A){const{geometry:F,index:q,sourceLayerIndex:V}=M;this.hasDependencies?(_w("line",this.layers,u)?vC("line",this.layers,M,{zoom:this.zoom},u):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,M,this.zoom,u),this.patternFeatures.push(M)):this.addFeature(M,F,q,x,{},{},u.subdivisionGranularity),u.featureIndex.insert(c[q].feature,F,q,V,this.index)}}update(c,u,x,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,u,this.stateDependentLayers,{imagePositions:x,dashPositions:_})}addFeatures(c,u,x,_){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,u,x,_,c.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=c.createVertexBuffer(this.layoutVertexArray2,tX)),this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,JY),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(c){if(c.properties&&Object.prototype.hasOwnProperty.call(c.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(c.properties,"mapbox_clip_end"))return{start:+c.properties.mapbox_clip_start,end:+c.properties.mapbox_clip_end}}addFeature(c,u,x,_,C,A,M){const F=this.layers[0].layout,q=F.get("line-join").evaluate(c,{}),V=F.get("line-cap"),K=F.get("line-miter-limit"),ee=F.get("line-round-limit");this.lineClips=this.lineFeatureClips(c);for(const re of u)this.addLine(re,c,q,V,K,ee,_,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,x,{imagePositions:C,dashPositions:A,canonical:_})}addLine(c,u,x,_,C,A,M,F){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,c=lf(c,M?F.line.getGranularityForZoomLevel(M.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Re=0;Re<c.length-1;Re++)this.totalDistance+=c[Re].dist(c[Re+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const q=px.types[u.type]==="Polygon";let V=c.length;for(;V>=2&&c[V-1].equals(c[V-2]);)V--;let K=0;for(;K<V-1&&c[K].equals(c[K+1]);)K++;if(V<(q?3:2))return;x==="bevel"&&(C=1.05);const ee=this.overscaling<=16?122880/(512*this.overscaling):0,re=this.segments.prepareSegment(10*V,this.layoutVertexArray,this.indexArray);let ae,pe,_e,Pe,Qe;this.e1=this.e2=-1,q&&(ae=c[V-2],Qe=c[K].sub(ae)._unit()._perp());for(let Re=K;Re<V;Re++){if(_e=Re===V-1?q?c[K+1]:void 0:c[Re+1],_e&&c[Re].equals(_e))continue;Qe&&(Pe=Qe),ae&&(pe=ae),ae=c[Re],Qe=_e?_e.sub(ae)._unit()._perp():Pe,Pe=Pe||Qe;let $e=Pe.add(Qe);$e.x===0&&$e.y===0||$e._unit();const at=Pe.x*Qe.x+Pe.y*Qe.y,ft=$e.x*Qe.x+$e.y*Qe.y,At=ft!==0?1/ft:1/0,Yt=2*Math.sqrt(2-2*ft),zt=ft<rX&&pe&&_e,Kt=Pe.x*Qe.y-Pe.y*Qe.x>0;if(zt&&Re>K){const Ht=ae.dist(pe);if(Ht>2*ee){const _t=ae.sub(ae.sub(pe)._mult(ee/Ht)._round());this.updateDistance(pe,_t),this.addCurrentVertex(_t,Pe,0,0,re),pe=_t}}const br=pe&&_e;let Wt=br?x:q?"butt":_;if(br&&Wt==="round"&&(At<A?Wt="miter":At<=2&&(Wt="fakeround")),Wt==="miter"&&At>C&&(Wt="bevel"),Wt==="bevel"&&(At>2&&(Wt="flipbevel"),At<C&&(Wt="miter")),pe&&this.updateDistance(pe,ae),Wt==="miter")$e._mult(At),this.addCurrentVertex(ae,$e,0,0,re);else if(Wt==="flipbevel"){if(At>100)$e=Qe.mult(-1);else{const Ht=At*Pe.add(Qe).mag()/Pe.sub(Qe).mag();$e._perp()._mult(Ht*(Kt?-1:1))}this.addCurrentVertex(ae,$e,0,0,re),this.addCurrentVertex(ae,$e.mult(-1),0,0,re)}else if(Wt==="bevel"||Wt==="fakeround"){const Ht=-Math.sqrt(At*At-1),_t=Kt?Ht:0,Fr=Kt?0:Ht;if(pe&&this.addCurrentVertex(ae,Pe,_t,Fr,re),Wt==="fakeround"){const $r=Math.round(180*Yt/Math.PI/20);for(let Ar=1;Ar<$r;Ar++){let dr=Ar/$r;if(dr!==.5){const Ts=dr-.5;dr+=dr*Ts*(dr-1)*((1.0904+at*(at*(3.55645-1.43519*at)-3.2452))*Ts*Ts+(.848013+at*(.215638*at-1.06021)))}const hn=Qe.sub(Pe)._mult(dr)._add(Pe)._unit()._mult(Kt?-1:1);this.addHalfVertex(ae,hn.x,hn.y,!1,Kt,0,re)}}_e&&this.addCurrentVertex(ae,Qe,-_t,-Fr,re)}else if(Wt==="butt")this.addCurrentVertex(ae,$e,0,0,re);else if(Wt==="square"){const Ht=pe?1:-1;this.addCurrentVertex(ae,$e,Ht,Ht,re)}else Wt==="round"&&(pe&&(this.addCurrentVertex(ae,Pe,0,0,re),this.addCurrentVertex(ae,Pe,1,1,re,!0)),_e&&(this.addCurrentVertex(ae,Qe,-1,-1,re,!0),this.addCurrentVertex(ae,Qe,0,0,re)));if(zt&&Re<V-1){const Ht=ae.dist(_e);if(Ht>2*ee){const _t=ae.add(_e.sub(ae)._mult(ee/Ht)._round());this.updateDistance(ae,_t),this.addCurrentVertex(_t,Qe,0,0,re),ae=_t}}}}addCurrentVertex(c,u,x,_,C,A=!1){const M=u.y*_-u.x,F=-u.y-u.x*_;this.addHalfVertex(c,u.x+u.y*x,u.y-u.x*x,A,!1,x,C),this.addHalfVertex(c,M,F,A,!0,-_,C),this.distance>OD/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(c,u,x,_,C,A))}addHalfVertex({x:c,y:u},x,_,C,A,M,F){const q=.5*(this.lineClips?this.scaledDistance*(OD-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((c<<1)+(C?1:0),(u<<1)+(A?1:0),Math.round(63*x)+128,Math.round(63*_)+128,1+(M===0?0:M<0?-1:1)|(63&q)<<2,q>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const V=F.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,V,this.e2),F.primitiveLength++),A?this.e2=V:this.e1=V}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(c,u){this.distance+=c.dist(u),this.updateScaledDistance()}hasLineDasharray(c){for(const u of c){const x=u.paint.get("line-dasharray");if(x&&!x.isConstant())return!0}return!1}addLineDashDependencies(c,u,x,_){for(const C of c){const A=C.paint.get("line-dasharray");if(!A||A.value.kind==="constant")continue;const M=C.layout.get("line-cap")==="round",F={dasharray:A.value.evaluate({zoom:x-1},u,{}),round:M},q={dasharray:A.value.evaluate({zoom:x},u,{}),round:M},V={dasharray:A.value.evaluate({zoom:x+1},u,{}),round:M},K=`${F.dasharray.join(",")},${F.round}`,ee=`${q.dasharray.join(",")},${q.round}`,re=`${V.dasharray.join(",")},${V.round}`;_.dashDependencies[K]=F,_.dashDependencies[ee]=q,_.dashDependencies[re]=V,u.dashes[C.id]={min:K,mid:ee,max:re}}}}let ID,DD;er("LineBucket",SC,{omit:["layers","patternFeatures"]});var RD={get paint(){return DD=DD||new oa({"line-opacity":new Ir(Je.paint_line["line-opacity"]),"line-color":new Ir(Je.paint_line["line-color"]),"line-translate":new pr(Je.paint_line["line-translate"]),"line-translate-anchor":new pr(Je.paint_line["line-translate-anchor"]),"line-width":new Ir(Je.paint_line["line-width"]),"line-gap-width":new Ir(Je.paint_line["line-gap-width"]),"line-offset":new Ir(Je.paint_line["line-offset"]),"line-blur":new Ir(Je.paint_line["line-blur"]),"line-dasharray":new rf(Je.paint_line["line-dasharray"]),"line-pattern":new rf(Je.paint_line["line-pattern"]),"line-gradient":new nf(Je.paint_line["line-gradient"])})},get layout(){return ID=ID||new oa({"line-cap":new pr(Je.layout_line["line-cap"]),"line-join":new Ir(Je.layout_line["line-join"]),"line-miter-limit":new pr(Je.layout_line["line-miter-limit"]),"line-round-limit":new pr(Je.layout_line["line-round-limit"]),"line-sort-key":new Ir(Je.layout_line["line-sort-key"])})}};class nX extends Ir{possiblyEvaluate(c,u){return u=new Gn(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),super.possiblyEvaluate(c,u)}evaluate(c,u,x,_){return u=_r({},u,{zoom:Math.floor(u.zoom)}),super.evaluate(c,u,x,_)}}let Nw;class sX extends $o{constructor(c,u){super(c,RD,u),this.gradientVersion=0,Nw||(Nw=new nX(RD.paint.properties["line-width"].specification),Nw.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const u=this.gradientExpression();this.stepInterpolant=!!function(x){return x._styleExpression!==void 0}(u)&&u._styleExpression.expression instanceof Zu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(c,u){super.recalculate(c,u),this.paint._values["line-floorwidth"]=Nw.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new SC(c)}queryRadius(c){const u=c,x=LD(ux("line-width",this,u),ux("line-gap-width",this,u)),_=ux("line-offset",this,u);return x/2+Math.abs(_)+yw(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:c,feature:u,featureState:x,geometry:_,transform:C,pixelsToTileUnits:A}){const M=vw(c,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-C.bearingInRadians,A),F=A/2*LD(this.paint.get("line-width").evaluate(u,x),this.paint.get("line-gap-width").evaluate(u,x)),q=this.paint.get("line-offset").evaluate(u,x);return q&&(_=function(V,K){const ee=[];for(let re=0;re<V.length;re++){const ae=V[re],pe=[];for(let _e=0;_e<ae.length;_e++){const Pe=ae[_e-1],Qe=ae[_e],Re=ae[_e+1],$e=_e===0?new f(0,0):Qe.sub(Pe)._unit()._perp(),at=_e===ae.length-1?new f(0,0):Re.sub(Qe)._unit()._perp(),ft=$e._add(at)._unit(),At=ft.x*at.x+ft.y*at.y;At!==0&&ft._mult(1/At),pe.push(ft._mult(K)._add(Qe))}ee.push(pe)}return ee}(_,q*A)),function(V,K,ee){for(let re=0;re<K.length;re++){const ae=K[re];if(V.length>=3){for(let pe=0;pe<ae.length;pe++)if(dx(V,ae[pe]))return!0}if(uY(V,ae,ee))return!0}return!1}(M,_,F)}isTileClipped(){return!0}}function LD(h,c){return c>0?c+2*h:h}const iX=qs([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),aX=qs([{name:"a_projected_pos",components:3,type:"Float32"}],4);qs([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const oX=qs([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);qs([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const FD=qs([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),lX=qs([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function cX(h,c,u){return h.sections.forEach(x=>{x.text=function(_,C,A){const M=C.layout.get("text-transform").evaluate(A,{});return M==="uppercase"?_=_.toLocaleUpperCase():M==="lowercase"&&(_=_.toLocaleLowerCase()),Xl.applyArabicShaping&&(_=Xl.applyArabicShaping(_)),_}(x.text,c,u)}),h}qs([{name:"triangle",components:3,type:"Uint16"}]),qs([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),qs([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),qs([{type:"Float32",name:"offsetX"}]),qs([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),qs([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const u0={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Ti=24;const PC=4294967296,zD=1/PC,$D=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class CC{constructor(c=new Uint8Array(16)){this.buf=ArrayBuffer.isView(c)?c:new Uint8Array(c),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(c,u,x=this.length){for(;this.pos<x;){const _=this.readVarint(),C=_>>3,A=this.pos;this.type=7&_,c(C,u,this),this.pos===A&&this.skip(_)}return u}readMessage(c,u){return this.readFields(c,u,this.readVarint()+this.pos)}readFixed32(){const c=this.dataView.getUint32(this.pos,!0);return this.pos+=4,c}readSFixed32(){const c=this.dataView.getInt32(this.pos,!0);return this.pos+=4,c}readFixed64(){const c=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*PC;return this.pos+=8,c}readSFixed64(){const c=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*PC;return this.pos+=8,c}readFloat(){const c=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,c}readDouble(){const c=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,c}readVarint(c){const u=this.buf;let x,_;return _=u[this.pos++],x=127&_,_<128?x:(_=u[this.pos++],x|=(127&_)<<7,_<128?x:(_=u[this.pos++],x|=(127&_)<<14,_<128?x:(_=u[this.pos++],x|=(127&_)<<21,_<128?x:(_=u[this.pos],x|=(15&_)<<28,function(C,A,M){const F=M.buf;let q,V;if(V=F[M.pos++],q=(112&V)>>4,V<128||(V=F[M.pos++],q|=(127&V)<<3,V<128)||(V=F[M.pos++],q|=(127&V)<<10,V<128)||(V=F[M.pos++],q|=(127&V)<<17,V<128)||(V=F[M.pos++],q|=(127&V)<<24,V<128)||(V=F[M.pos++],q|=(1&V)<<31,V<128))return xx(C,q,A);throw new Error("Expected varint not more than 10 bytes")}(x,c,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const c=this.readVarint();return c%2==1?(c+1)/-2:c/2}readBoolean(){return!!this.readVarint()}readString(){const c=this.readVarint()+this.pos,u=this.pos;return this.pos=c,c-u>=12&&$D?$D.decode(this.buf.subarray(u,c)):function(x,_,C){let A="",M=_;for(;M<C;){const F=x[M];let q,V,K,ee=null,re=F>239?4:F>223?3:F>191?2:1;if(M+re>C)break;re===1?F<128&&(ee=F):re===2?(q=x[M+1],(192&q)==128&&(ee=(31&F)<<6|63&q,ee<=127&&(ee=null))):re===3?(q=x[M+1],V=x[M+2],(192&q)==128&&(192&V)==128&&(ee=(15&F)<<12|(63&q)<<6|63&V,(ee<=2047||ee>=55296&&ee<=57343)&&(ee=null))):re===4&&(q=x[M+1],V=x[M+2],K=x[M+3],(192&q)==128&&(192&V)==128&&(192&K)==128&&(ee=(15&F)<<18|(63&q)<<12|(63&V)<<6|63&K,(ee<=65535||ee>=1114112)&&(ee=null))),ee===null?(ee=65533,re=1):ee>65535&&(ee-=65536,A+=String.fromCharCode(ee>>>10&1023|55296),ee=56320|1023&ee),A+=String.fromCharCode(ee),M+=re}return A}(this.buf,u,c)}readBytes(){const c=this.readVarint()+this.pos,u=this.buf.subarray(this.pos,c);return this.pos=c,u}readPackedVarint(c=[],u){const x=this.readPackedEnd();for(;this.pos<x;)c.push(this.readVarint(u));return c}readPackedSVarint(c=[]){const u=this.readPackedEnd();for(;this.pos<u;)c.push(this.readSVarint());return c}readPackedBoolean(c=[]){const u=this.readPackedEnd();for(;this.pos<u;)c.push(this.readBoolean());return c}readPackedFloat(c=[]){const u=this.readPackedEnd();for(;this.pos<u;)c.push(this.readFloat());return c}readPackedDouble(c=[]){const u=this.readPackedEnd();for(;this.pos<u;)c.push(this.readDouble());return c}readPackedFixed32(c=[]){const u=this.readPackedEnd();for(;this.pos<u;)c.push(this.readFixed32());return c}readPackedSFixed32(c=[]){const u=this.readPackedEnd();for(;this.pos<u;)c.push(this.readSFixed32());return c}readPackedFixed64(c=[]){const u=this.readPackedEnd();for(;this.pos<u;)c.push(this.readFixed64());return c}readPackedSFixed64(c=[]){const u=this.readPackedEnd();for(;this.pos<u;)c.push(this.readSFixed64());return c}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(c){const u=7&c;if(u===0)for(;this.buf[this.pos++]>127;);else if(u===2)this.pos=this.readVarint()+this.pos;else if(u===5)this.pos+=4;else{if(u!==1)throw new Error(`Unimplemented type: ${u}`);this.pos+=8}}writeTag(c,u){this.writeVarint(c<<3|u)}realloc(c){let u=this.length||16;for(;u<this.pos+c;)u*=2;if(u!==this.length){const x=new Uint8Array(u);x.set(this.buf),this.buf=x,this.dataView=new DataView(x.buffer),this.length=u}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(c){this.realloc(4),this.dataView.setInt32(this.pos,c,!0),this.pos+=4}writeSFixed32(c){this.realloc(4),this.dataView.setInt32(this.pos,c,!0),this.pos+=4}writeFixed64(c){this.realloc(8),this.dataView.setInt32(this.pos,-1&c,!0),this.dataView.setInt32(this.pos+4,Math.floor(c*zD),!0),this.pos+=8}writeSFixed64(c){this.realloc(8),this.dataView.setInt32(this.pos,-1&c,!0),this.dataView.setInt32(this.pos+4,Math.floor(c*zD),!0),this.pos+=8}writeVarint(c){(c=+c||0)>268435455||c<0?function(u,x){let _,C;if(u>=0?(_=u%4294967296|0,C=u/4294967296|0):(_=~(-u%4294967296),C=~(-u/4294967296),4294967295^_?_=_+1|0:(_=0,C=C+1|0)),u>=18446744073709552e3||u<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");x.realloc(10),function(A,M,F){F.buf[F.pos++]=127&A|128,A>>>=7,F.buf[F.pos++]=127&A|128,A>>>=7,F.buf[F.pos++]=127&A|128,A>>>=7,F.buf[F.pos++]=127&A|128,F.buf[F.pos]=127&(A>>>=7)}(_,0,x),function(A,M){const F=(7&A)<<4;M.buf[M.pos++]|=F|((A>>>=3)?128:0),A&&(M.buf[M.pos++]=127&A|((A>>>=7)?128:0),A&&(M.buf[M.pos++]=127&A|((A>>>=7)?128:0),A&&(M.buf[M.pos++]=127&A|((A>>>=7)?128:0),A&&(M.buf[M.pos++]=127&A|((A>>>=7)?128:0),A&&(M.buf[M.pos++]=127&A)))))}(C,x)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))}writeSVarint(c){this.writeVarint(c<0?2*-c-1:2*c)}writeBoolean(c){this.writeVarint(+c)}writeString(c){c=String(c),this.realloc(4*c.length),this.pos++;const u=this.pos;this.pos=function(_,C,A){for(let M,F,q=0;q<C.length;q++){if(M=C.charCodeAt(q),M>55295&&M<57344){if(!F){M>56319||q+1===C.length?(_[A++]=239,_[A++]=191,_[A++]=189):F=M;continue}if(M<56320){_[A++]=239,_[A++]=191,_[A++]=189,F=M;continue}M=F-55296<<10|M-56320|65536,F=null}else F&&(_[A++]=239,_[A++]=191,_[A++]=189,F=null);M<128?_[A++]=M:(M<2048?_[A++]=M>>6|192:(M<65536?_[A++]=M>>12|224:(_[A++]=M>>18|240,_[A++]=M>>12&63|128),_[A++]=M>>6&63|128),_[A++]=63&M|128)}return A}(this.buf,c,this.pos);const x=this.pos-u;x>=128&&BD(u,x,this),this.pos=u-1,this.writeVarint(x),this.pos+=x}writeFloat(c){this.realloc(4),this.dataView.setFloat32(this.pos,c,!0),this.pos+=4}writeDouble(c){this.realloc(8),this.dataView.setFloat64(this.pos,c,!0),this.pos+=8}writeBytes(c){const u=c.length;this.writeVarint(u),this.realloc(u);for(let x=0;x<u;x++)this.buf[this.pos++]=c[x]}writeRawMessage(c,u){this.pos++;const x=this.pos;c(u,this);const _=this.pos-x;_>=128&&BD(x,_,this),this.pos=x-1,this.writeVarint(_),this.pos+=_}writeMessage(c,u,x){this.writeTag(c,2),this.writeRawMessage(u,x)}writePackedVarint(c,u){u.length&&this.writeMessage(c,dX,u)}writePackedSVarint(c,u){u.length&&this.writeMessage(c,uX,u)}writePackedBoolean(c,u){u.length&&this.writeMessage(c,fX,u)}writePackedFloat(c,u){u.length&&this.writeMessage(c,hX,u)}writePackedDouble(c,u){u.length&&this.writeMessage(c,mX,u)}writePackedFixed32(c,u){u.length&&this.writeMessage(c,pX,u)}writePackedSFixed32(c,u){u.length&&this.writeMessage(c,xX,u)}writePackedFixed64(c,u){u.length&&this.writeMessage(c,gX,u)}writePackedSFixed64(c,u){u.length&&this.writeMessage(c,yX,u)}writeBytesField(c,u){this.writeTag(c,2),this.writeBytes(u)}writeFixed32Field(c,u){this.writeTag(c,5),this.writeFixed32(u)}writeSFixed32Field(c,u){this.writeTag(c,5),this.writeSFixed32(u)}writeFixed64Field(c,u){this.writeTag(c,1),this.writeFixed64(u)}writeSFixed64Field(c,u){this.writeTag(c,1),this.writeSFixed64(u)}writeVarintField(c,u){this.writeTag(c,0),this.writeVarint(u)}writeSVarintField(c,u){this.writeTag(c,0),this.writeSVarint(u)}writeStringField(c,u){this.writeTag(c,2),this.writeString(u)}writeFloatField(c,u){this.writeTag(c,5),this.writeFloat(u)}writeDoubleField(c,u){this.writeTag(c,1),this.writeDouble(u)}writeBooleanField(c,u){this.writeVarintField(c,+u)}}function xx(h,c,u){return u?4294967296*c+(h>>>0):4294967296*(c>>>0)+(h>>>0)}function BD(h,c,u){const x=c<=16383?1:c<=2097151?2:c<=268435455?3:Math.floor(Math.log(c)/(7*Math.LN2));u.realloc(x);for(let _=u.pos-1;_>=h;_--)u.buf[_+x]=u.buf[_]}function dX(h,c){for(let u=0;u<h.length;u++)c.writeVarint(h[u])}function uX(h,c){for(let u=0;u<h.length;u++)c.writeSVarint(h[u])}function hX(h,c){for(let u=0;u<h.length;u++)c.writeFloat(h[u])}function mX(h,c){for(let u=0;u<h.length;u++)c.writeDouble(h[u])}function fX(h,c){for(let u=0;u<h.length;u++)c.writeBoolean(h[u])}function pX(h,c){for(let u=0;u<h.length;u++)c.writeFixed32(h[u])}function xX(h,c){for(let u=0;u<h.length;u++)c.writeSFixed32(h[u])}function gX(h,c){for(let u=0;u<h.length;u++)c.writeFixed64(h[u])}function yX(h,c){for(let u=0;u<h.length;u++)c.writeSFixed64(h[u])}function vX(h,c,u){h===1&&u.readMessage(_X,c)}function _X(h,c,u){if(h===3){const{id:x,bitmap:_,width:C,height:A,left:M,top:F,advance:q}=u.readMessage(bX,{});c.push({id:x,bitmap:new r0({width:C+6,height:A+6},_),metrics:{width:C,height:A,left:M,top:F,advance:q}})}}function bX(h,c,u){h===1?c.id=u.readVarint():h===2?c.bitmap=u.readBytes():h===3?c.width=u.readVarint():h===4?c.height=u.readVarint():h===5?c.left=u.readSVarint():h===6?c.top=u.readSVarint():h===7&&(c.advance=u.readVarint())}function qD(h){let c=0,u=0;for(const A of h)c+=A.w*A.h,u=Math.max(u,A.w);h.sort((A,M)=>M.h-A.h);const x=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(c/.95)),u),h:1/0}];let _=0,C=0;for(const A of h)for(let M=x.length-1;M>=0;M--){const F=x[M];if(!(A.w>F.w||A.h>F.h)){if(A.x=F.x,A.y=F.y,C=Math.max(C,A.y+A.h),_=Math.max(_,A.x+A.w),A.w===F.w&&A.h===F.h){const q=x.pop();q&&M<x.length&&(x[M]=q)}else A.h===F.h?(F.x+=A.w,F.w-=A.w):A.w===F.w?(F.y+=A.h,F.h-=A.h):(x.push({x:F.x+A.w,y:F.y,w:F.w-A.w,h:A.h}),F.y+=A.h,F.h-=A.h);break}}return{w:_,h:C,fill:c/(_*C)||0}}class AC{constructor(c,{pixelRatio:u,version:x,stretchX:_,stretchY:C,content:A,textFitWidth:M,textFitHeight:F}){this.paddedRect=c,this.pixelRatio=u,this.stretchX=_,this.stretchY=C,this.content=A,this.version=x,this.textFitWidth=M,this.textFitHeight=F}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class VD{constructor(c,u){const x={},_={};this.haveRenderCallbacks=[];const C=[];this.addImages(c,x,C),this.addImages(u,_,C);const{w:A,h:M}=qD(C),F=new eo({width:A||1,height:M||1});for(const q in c){const V=c[q],K=x[q].paddedRect;eo.copy(V.data,F,{x:0,y:0},{x:K.x+1,y:K.y+1},V.data)}for(const q in u){const V=u[q],K=_[q].paddedRect,ee=K.x+1,re=K.y+1,ae=V.data.width,pe=V.data.height;eo.copy(V.data,F,{x:0,y:0},{x:ee,y:re},V.data),eo.copy(V.data,F,{x:0,y:pe-1},{x:ee,y:re-1},{width:ae,height:1}),eo.copy(V.data,F,{x:0,y:0},{x:ee,y:re+pe},{width:ae,height:1}),eo.copy(V.data,F,{x:ae-1,y:0},{x:ee-1,y:re},{width:1,height:pe}),eo.copy(V.data,F,{x:0,y:0},{x:ee+ae,y:re},{width:1,height:pe})}this.image=F,this.iconPositions=x,this.patternPositions=_}addImages(c,u,x){for(const _ in c){const C=c[_],A={x:0,y:0,w:C.data.width+2,h:C.data.height+2};x.push(A),u[_]=new AC(A,C),C.hasRenderCallback&&this.haveRenderCallbacks.push(_)}}patchUpdatedImages(c,u){c.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const x in c.updatedImages)this.patchUpdatedImage(this.iconPositions[x],c.getImage(x),u),this.patchUpdatedImage(this.patternPositions[x],c.getImage(x),u)}patchUpdatedImage(c,u,x){if(!c||!u||c.version===u.version)return;c.version=u.version;const[_,C]=c.tl;x.update(u.data,void 0,{x:_,y:C})}}var lh;er("ImagePosition",AC),er("ImageAtlas",VD),d.as=void 0,(lh=d.as||(d.as={}))[lh.none=0]="none",lh[lh.horizontal=1]="horizontal",lh[lh.vertical=2]="vertical",lh[lh.horizontalOnly=3]="horizontalOnly";class h0{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(c,u,x){const _=new h0;return _.scale=c||1,_.fontStack=u,_.verticalAlign=x||"bottom",_}static forImage(c,u){const x=new h0;return x.imageName=c,x.verticalAlign=u||"bottom",x}}class gx{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(c,u){const x=new gx;for(let _=0;_<c.sections.length;_++){const C=c.sections[_];C.image?x.addImageSection(C):x.addTextSection(C,u)}return x}length(){return this.text.length}getSection(c){return this.sections[this.sectionIndex[c]]}getSectionIndex(c){return this.sectionIndex[c]}getCharCode(c){return this.text.charCodeAt(c)}verticalizePunctuation(){this.text=function(c){let u="";for(let x=0;x<c.length;x++){const _=c.charCodeAt(x+1)||null,C=c.charCodeAt(x-1)||null;u+=_&&tx(_)&&!u0[c[x+1]]||C&&tx(C)&&!u0[c[x-1]]||!u0[c[x]]?c[x]:u0[c[x]]}return u}(this.text)}trim(){let c=0;for(let x=0;x<this.text.length&&Pw[this.text.charCodeAt(x)];x++)c++;let u=this.text.length;for(let x=this.text.length-1;x>=0&&x>=c&&Pw[this.text.charCodeAt(x)];x--)u--;this.text=this.text.substring(c,u),this.sectionIndex=this.sectionIndex.slice(c,u)}substring(c,u){const x=new gx;return x.text=this.text.substring(c,u),x.sectionIndex=this.sectionIndex.slice(c,u),x.sections=this.sections,x}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((c,u)=>Math.max(c,this.sections[u].scale),0)}getMaxImageSize(c){let u=0,x=0;for(let _=0;_<this.length();_++){const C=this.getSection(_);if(C.imageName){const A=c[C.imageName];if(!A)continue;const M=A.displaySize;u=Math.max(u,M[0]),x=Math.max(x,M[1])}}return{maxImageWidth:u,maxImageHeight:x}}addTextSection(c,u){this.text+=c.text,this.sections.push(h0.forText(c.scale,c.fontStack||u,c.verticalAlign));const x=this.sections.length-1;for(let _=0;_<c.text.length;++_)this.sectionIndex.push(x)}addImageSection(c){const u=c.image?c.image.name:"";if(u.length===0)return void or("Can't add FormattedSection with an empty image.");const x=this.getNextImageSectionCharCode();x?(this.text+=String.fromCharCode(x),this.sections.push(h0.forImage(u,c.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):or("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Sw(h,c,u,x,_,C,A,M,F,q,V,K,ee,re,ae){const pe=gx.fromFeature(h,_);let _e;K===d.as.vertical&&pe.verticalizePunctuation();const{processBidirectionalText:Pe,processStyledBidirectionalText:Qe}=Xl;if(Pe&&pe.sections.length===1){_e=[];const at=Pe(pe.toString(),kC(pe,q,C,c,x,re));for(const ft of at){const At=new gx;At.text=ft,At.sections=pe.sections;for(let Yt=0;Yt<ft.length;Yt++)At.sectionIndex.push(0);_e.push(At)}}else if(Qe){_e=[];const at=Qe(pe.text,pe.sectionIndex,kC(pe,q,C,c,x,re));for(const ft of at){const At=new gx;At.text=ft[0],At.sectionIndex=ft[1],At.sections=pe.sections,_e.push(At)}}else _e=function(at,ft){const At=[],Yt=at.text;let zt=0;for(const Kt of ft)At.push(at.substring(zt,Kt)),zt=Kt;return zt<Yt.length&&At.push(at.substring(zt,Yt.length)),At}(pe,kC(pe,q,C,c,x,re));const Re=[],$e={positionedLines:Re,text:pe.toString(),top:V[1],bottom:V[1],left:V[0],right:V[0],writingMode:K,iconsInText:!1,verticalizable:!1};return function(at,ft,At,Yt,zt,Kt,br,Wt,Ht,_t,Fr,$r){let Ar=0,dr=0,hn=0,Ts=0;const _i=Wt==="right"?1:Wt==="left"?0:.5,ca=Ti/$r;let Vo=0;for(const bs of zt){bs.trim();const Ei=bs.getMaxScale(),Wi={positionedGlyphs:[],lineOffset:0};at.positionedLines[Vo]=Wi;const Gi=Wi.positionedGlyphs;let za=0;if(!bs.length()){dr+=Kt,++Vo;continue}const Uo=SX(Yt,bs,ca);for(let ro=0;ro<bs.length();ro++){const bi=bs.getSection(ro),Oi=bs.getSectionIndex(ro),Ii=bs.getCharCode(ro),mi=PX(Ht,Fr,Ii);let as;if(bi.imageName){if(at.iconsInText=!0,bi.scale=bi.scale*ca,as=AX(bi,mi,Ei,Uo,Yt),!as)continue;za=Math.max(za,as.imageOffset)}else if(as=CX(bi,Ii,mi,Uo,ft,At),!as)continue;const{rect:rc,metrics:bx,baselineOffset:nc}=as;Gi.push({glyph:Ii,imageName:bi.imageName,x:Ar,y:dr+nc+-17,vertical:mi,scale:bi.scale,fontStack:bi.fontStack,sectionIndex:Oi,metrics:bx,rect:rc}),mi?(at.verticalizable=!0,Ar+=(bi.imageName?bx.advance:Ti)*bi.scale+_t):Ar+=bx.advance*bi.scale+_t}Gi.length!==0&&(hn=Math.max(Ar-_t,hn),kX(Gi,0,Gi.length-1,_i)),Ar=0,Wi.lineOffset=Math.max(za,(Ei-1)*Ti);const Mi=Kt*Ei+za;dr+=Mi,Ts=Math.max(Mi,Ts),++Vo}const{horizontalAlign:to,verticalAlign:Ui}=TC(br);(function(bs,Ei,Wi,Gi,za,Uo,Mi,ro,bi){const Oi=(Ei-Wi)*za;let Ii=0;Ii=Uo!==Mi?-ro*Gi- -17:-Gi*bi*Mi+.5*Mi;for(const mi of bs)for(const as of mi.positionedGlyphs)as.x+=Oi,as.y+=Ii})(at.positionedLines,_i,to,Ui,hn,Ts,Kt,dr,zt.length),at.top+=-Ui*dr,at.bottom=at.top+dr,at.left+=-to*hn,at.right=at.left+hn}($e,c,u,x,_e,A,M,F,K,q,ee,ae),!function(at){for(const ft of at)if(ft.positionedGlyphs.length!==0)return!1;return!0}(Re)&&$e}const Pw={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},jX={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},wX={40:!0};function UD(h,c,u,x,_,C){if(c.imageName){const A=x[c.imageName];return A?A.displaySize[0]*c.scale*Ti/C+_:0}{const A=u[c.fontStack],M=A&&A[h];return M?M.metrics.advance*c.scale+_:0}}function WD(h,c,u,x){const _=Math.pow(h-c,2);return x?h<c?_/2:2*_:_+Math.abs(u)*u}function NX(h,c,u){let x=0;return h===10&&(x-=1e4),u&&(x+=150),h!==40&&h!==65288||(x+=50),c!==41&&c!==65289||(x+=50),x}function GD(h,c,u,x,_,C){let A=null,M=WD(c,u,_,C);for(const F of x){const q=WD(c-F.x,u,_,C)+F.badness;q<=M&&(A=F,M=q)}return{index:h,x:c,priorBreak:A,badness:M}}function KD(h){return h?KD(h.priorBreak).concat(h.index):[]}function kC(h,c,u,x,_,C){if(!h)return[];const A=[],M=function(K,ee,re,ae,pe,_e){let Pe=0;for(let Qe=0;Qe<K.length();Qe++){const Re=K.getSection(Qe);Pe+=UD(K.getCharCode(Qe),Re,ae,pe,ee,_e)}return Pe/Math.max(1,Math.ceil(Pe/re))}(h,c,u,x,_,C),F=h.text.indexOf("")>=0;let q=0;for(let K=0;K<h.length();K++){const ee=h.getSection(K),re=h.getCharCode(K);if(Pw[re]||(q+=UD(re,ee,x,_,c,C)),K<h.length()-1){const ae=!((V=re)<11904)&&(!!sn["CJK Compatibility Forms"](V)||!!sn["CJK Compatibility"](V)||!!sn["CJK Strokes"](V)||!!sn["CJK Symbols and Punctuation"](V)||!!sn["Enclosed CJK Letters and Months"](V)||!!sn["Halfwidth and Fullwidth Forms"](V)||!!sn["Ideographic Description Characters"](V)||!!sn["Vertical Forms"](V)||Uv.test(String.fromCodePoint(V)));(jX[re]||ae||ee.imageName||K!==h.length()-2&&wX[h.getCharCode(K+1)])&&A.push(GD(K+1,q,M,A,NX(re,h.getCharCode(K+1),ae&&F),!1))}}var V;return KD(GD(h.length(),q,M,A,0,!0))}function TC(h){let c=.5,u=.5;switch(h){case"right":case"top-right":case"bottom-right":c=1;break;case"left":case"top-left":case"bottom-left":c=0}switch(h){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:c,verticalAlign:u}}function SX(h,c,u){const x=c.getMaxScale()*Ti,{maxImageWidth:_,maxImageHeight:C}=c.getMaxImageSize(h),A=Math.max(x,C*u);return{verticalLineContentWidth:Math.max(x,_*u),horizontalLineContentHeight:A}}function HD(h){switch(h){case"top":return 0;case"center":return .5;default:return 1}}function PX(h,c,u){return!(h===d.as.horizontal||!c&&!ex(u)||c&&(Pw[u]||(x=u,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(x)))));var x}function CX(h,c,u,x,_,C){const A=C[h.fontStack],M=function(q,V,K,ee){if(q&&q.rect)return q;const re=V[K.fontStack],ae=re&&re[ee];return ae?{rect:null,metrics:ae.metrics}:null}(A&&A[c],_,h,c);if(M===null)return null;let F;if(u)F=x.verticalLineContentWidth-h.scale*Ti;else{const q=HD(h.verticalAlign);F=(x.horizontalLineContentHeight-h.scale*Ti)*q}return{rect:M.rect,metrics:M.metrics,baselineOffset:F}}function AX(h,c,u,x,_){const C=_[h.imageName];if(!C)return null;const A=C.paddedRect,M=C.displaySize,F={width:M[0],height:M[1],left:1,top:-3,advance:c?M[1]:M[0]};let q;if(c)q=x.verticalLineContentWidth-M[1]*h.scale;else{const V=HD(h.verticalAlign);q=(x.horizontalLineContentHeight-M[1]*h.scale)*V}return{rect:A,metrics:F,baselineOffset:q,imageOffset:(c?M[0]:M[1])*h.scale-Ti*u}}function kX(h,c,u,x){if(x===0)return;const _=h[u],C=(h[u].x+_.metrics.advance*_.scale)*x;for(let A=c;A<=u;A++)h[A].x-=C}function TX(h,c,u){const{horizontalAlign:x,verticalAlign:_}=TC(u),C=c[0]-h.displaySize[0]*x,A=c[1]-h.displaySize[1]*_;return{image:h,top:A,bottom:A+h.displaySize[1],left:C,right:C+h.displaySize[0]}}function ZD(h){var c,u;let x=h.left,_=h.top,C=h.right-x,A=h.bottom-_;const M=(c=h.image.textFitWidth)!==null&&c!==void 0?c:"stretchOrShrink",F=(u=h.image.textFitHeight)!==null&&u!==void 0?u:"stretchOrShrink",q=(h.image.content[2]-h.image.content[0])/(h.image.content[3]-h.image.content[1]);if(F==="proportional"){if(M==="stretchOnly"&&C/A<q||M==="proportional"){const V=Math.ceil(A*q);x*=V/C,C=V}}else if(M==="proportional"&&F==="stretchOnly"&&q!==0&&C/A>q){const V=Math.ceil(C/q);_*=V/A,A=V}return{x1:x,y1:_,x2:x+C,y2:_+A}}function YD(h,c,u,x,_,C){const A=h.image;let M;if(A.content){const _e=A.content,Pe=A.pixelRatio||1;M=[_e[0]/Pe,_e[1]/Pe,A.displaySize[0]-_e[2]/Pe,A.displaySize[1]-_e[3]/Pe]}const F=c.left*C,q=c.right*C;let V,K,ee,re;u==="width"||u==="both"?(re=_[0]+F-x[3],K=_[0]+q+x[1]):(re=_[0]+(F+q-A.displaySize[0])/2,K=re+A.displaySize[0]);const ae=c.top*C,pe=c.bottom*C;return u==="height"||u==="both"?(V=_[1]+ae-x[0],ee=_[1]+pe+x[2]):(V=_[1]+(ae+pe-A.displaySize[1])/2,ee=V+A.displaySize[1]),{image:A,top:V,right:K,bottom:ee,left:re,collisionPadding:M}}const Gd=128,ch=32640;function XD(h,c){const{expression:u}=c;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new Gn(h+1))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:x,interpolationType:_}=u;let C=0;for(;C<x.length&&x[C]<=h;)C++;C=Math.max(0,C-1);let A=C;for(;A<x.length&&x[A]<h+1;)A++;A=Math.min(x.length-1,A);const M=x[C],F=x[A];return u.kind==="composite"?{kind:"composite",minZoom:M,maxZoom:F,interpolationType:_}:{kind:"camera",minZoom:M,maxZoom:F,minSize:u.evaluate(new Gn(M)),maxSize:u.evaluate(new Gn(F)),interpolationType:_}}}function EC(h,c,u){let x="never";const _=h.get(c);return _?x=_:h.get(u)&&(x="always"),x}const EX=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Cw(h,c,u,x,_,C,A,M,F,q,V,K,ee){const re=M?Math.min(ch,Math.round(M[0])):0,ae=M?Math.min(ch,Math.round(M[1])):0;h.emplaceBack(c,u,Math.round(32*x),Math.round(32*_),C,A,(re<<1)+(F?1:0),ae,16*q,16*V,256*K,256*ee)}function MC(h,c,u){h.emplaceBack(c.x,c.y,u),h.emplaceBack(c.x,c.y,u),h.emplaceBack(c.x,c.y,u),h.emplaceBack(c.x,c.y,u)}function MX(h){for(const c of h.sections)if(oC(c.text))return!0;return!1}class OC{constructor(c){this.layoutVertexArray=new it,this.indexArray=new bt,this.programConfigurations=c,this.segments=new Hr,this.dynamicLayoutVertexArray=new ot,this.opacityVertexArray=new mt,this.hasVisibleVertices=!1,this.placedSymbolArray=new U}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(c,u,x,_){this.isEmpty()||(x&&(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,iX.members),this.indexBuffer=c.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=c.createVertexBuffer(this.dynamicLayoutVertexArray,aX.members,!0),this.opacityVertexBuffer=c.createVertexBuffer(this.opacityVertexArray,EX,!0),this.opacityVertexBuffer.itemSize=1),(x||_)&&this.programConfigurations.upload(c))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}er("SymbolBuffers",OC);class IC{constructor(c,u,x){this.layoutVertexArray=new c,this.layoutAttributes=u,this.indexArray=new x,this.segments=new Hr,this.collisionVertexArray=new Mt}upload(c){this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=c.createVertexBuffer(this.collisionVertexArray,oX.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}er("CollisionBuffers",IC);class yx{constructor(c){this.collisionBoxArray=c.collisionBoxArray,this.zoom=c.zoom,this.overscaling=ks(globalThis)?Math.min(c.overscaling,128):c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(A=>A.id),this.index=c.index,this.pixelRatio=c.pixelRatio,this.sourceLayerIndex=c.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=XD(this.zoom,u["text-size"]),this.iconSizeData=XD(this.zoom,u["icon-size"]);const x=this.layers[0].layout,_=x.get("symbol-sort-key"),C=x.get("symbol-z-order");this.canOverlap=EC(x,"text-overlap","text-allow-overlap")!=="never"||EC(x,"icon-overlap","icon-allow-overlap")!=="never"||x.get("text-ignore-placement")||x.get("icon-ignore-placement"),this.sortFeaturesByKey=C!=="viewport-y"&&!_.isConstant(),this.sortFeaturesByY=(C==="viewport-y"||C==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,x.get("symbol-placement")==="point"&&(this.writingModes=x.get("text-writing-mode").map(A=>d.as[A])),this.stateDependentLayerIds=this.layers.filter(A=>A.isStateDependent()).map(A=>A.id),this.sourceID=c.sourceID}createArrays(){this.text=new OC(new Ud(this.layers,this.zoom,c=>/^text/.test(c))),this.icon=new OC(new Ud(this.layers,this.zoom,c=>/^icon/.test(c))),this.glyphOffsetArray=new Y,this.lineVertexArray=new ne,this.symbolInstances=new J,this.textAnchorOffsets=new je}calculateGlyphDependencies(c,u,x,_,C){for(let A=0;A<c.length;A++)if(u[c.charCodeAt(A)]=!0,(x||_)&&C){const M=u0[c.charAt(A)];M&&(u[M.charCodeAt(0)]=!0)}}populate(c,u,x){const _=this.layers[0],C=_.layout,A=C.get("text-font"),M=C.get("text-field"),F=C.get("icon-image"),q=(M.value.kind!=="constant"||M.value.value instanceof Da&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&(A.value.kind!=="constant"||A.value.value.length>0),V=F.value.kind!=="constant"||!!F.value.value||Object.keys(F.parameters).length>0,K=C.get("symbol-sort-key");if(this.features=[],!q&&!V)return;const ee=u.iconDependencies,re=u.glyphDependencies,ae=u.availableImages,pe=new Gn(this.zoom);for(const{feature:_e,id:Pe,index:Qe,sourceLayerIndex:Re}of c){const $e=_._featureFilter.needGeometry,at=qc(_e,$e);if(!_._featureFilter.filter(pe,at,x))continue;let ft,At;if($e||(at.geometry=tc(_e)),q){const zt=_.getValueAndResolveTokens("text-field",at,x,ae),Kt=Da.factory(zt),br=this.hasRTLText=this.hasRTLText||MX(Kt);(!br||Xl.getRTLTextPluginStatus()==="unavailable"||br&&Xl.isParsed())&&(ft=cX(Kt,_,at))}if(V){const zt=_.getValueAndResolveTokens("icon-image",at,x,ae);At=zt instanceof va?zt:va.fromString(zt)}if(!ft&&!At)continue;const Yt=this.sortFeaturesByKey?K.evaluate(at,{},x):void 0;if(this.features.push({id:Pe,text:ft,icon:At,index:Qe,sourceLayerIndex:Re,geometry:at.geometry,properties:_e.properties,type:px.types[_e.type],sortKey:Yt}),At&&(ee[At.name]=!0),ft){const zt=A.evaluate(at,{},x).join(","),Kt=C.get("text-rotation-alignment")!=="viewport"&&C.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(d.as.vertical)>=0;for(const br of ft.sections)if(br.image)ee[br.image.name]=!0;else{const Wt=qv(ft.toString()),Ht=br.fontStack||zt,_t=re[Ht]=re[Ht]||{};this.calculateGlyphDependencies(br.text,_t,Kt,this.allowVerticalPlacement,Wt)}}}C.get("symbol-placement")==="line"&&(this.features=function(_e){const Pe={},Qe={},Re=[];let $e=0;function at(zt){Re.push(_e[zt]),$e++}function ft(zt,Kt,br){const Wt=Qe[zt];return delete Qe[zt],Qe[Kt]=Wt,Re[Wt].geometry[0].pop(),Re[Wt].geometry[0]=Re[Wt].geometry[0].concat(br[0]),Wt}function At(zt,Kt,br){const Wt=Pe[Kt];return delete Pe[Kt],Pe[zt]=Wt,Re[Wt].geometry[0].shift(),Re[Wt].geometry[0]=br[0].concat(Re[Wt].geometry[0]),Wt}function Yt(zt,Kt,br){const Wt=br?Kt[0][Kt[0].length-1]:Kt[0][0];return`${zt}:${Wt.x}:${Wt.y}`}for(let zt=0;zt<_e.length;zt++){const Kt=_e[zt],br=Kt.geometry,Wt=Kt.text?Kt.text.toString():null;if(!Wt){at(zt);continue}const Ht=Yt(Wt,br),_t=Yt(Wt,br,!0);if(Ht in Qe&&_t in Pe&&Qe[Ht]!==Pe[_t]){const Fr=At(Ht,_t,br),$r=ft(Ht,_t,Re[Fr].geometry);delete Pe[Ht],delete Qe[_t],Qe[Yt(Wt,Re[$r].geometry,!0)]=$r,Re[Fr].geometry=null}else Ht in Qe?ft(Ht,_t,br):_t in Pe?At(Ht,_t,br):(at(zt),Pe[Ht]=$e-1,Qe[_t]=$e-1)}return Re.filter(zt=>zt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((_e,Pe)=>_e.sortKey-Pe.sortKey)}update(c,u,x){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(c,u,this.layers,{imagePositions:x}),this.icon.programConfigurations.updatePaintArrays(c,u,this.layers,{imagePositions:x}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(c){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(c),this.iconCollisionBox.upload(c)),this.text.upload(c,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(c,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(c,u){const x=this.lineVertexArray.length;if(c.segment!==void 0){let _=c.dist(u[c.segment+1]),C=c.dist(u[c.segment]);const A={};for(let M=c.segment+1;M<u.length;M++)A[M]={x:u[M].x,y:u[M].y,tileUnitDistanceFromAnchor:_},M<u.length-1&&(_+=u[M+1].dist(u[M]));for(let M=c.segment||0;M>=0;M--)A[M]={x:u[M].x,y:u[M].y,tileUnitDistanceFromAnchor:C},M>0&&(C+=u[M-1].dist(u[M]));for(let M=0;M<u.length;M++){const F=A[M];this.lineVertexArray.emplaceBack(F.x,F.y,F.tileUnitDistanceFromAnchor)}}return{lineStartIndex:x,lineLength:this.lineVertexArray.length-x}}addSymbols(c,u,x,_,C,A,M,F,q,V,K,ee){const re=c.indexArray,ae=c.layoutVertexArray,pe=c.segments.prepareSegment(4*u.length,ae,re,this.canOverlap?A.sortKey:void 0),_e=this.glyphOffsetArray.length,Pe=pe.vertexLength,Qe=this.allowVerticalPlacement&&M===d.as.vertical?Math.PI/2:0,Re=A.text&&A.text.sections;for(let $e=0;$e<u.length;$e++){const{tl:at,tr:ft,bl:At,br:Yt,tex:zt,pixelOffsetTL:Kt,pixelOffsetBR:br,minFontScaleX:Wt,minFontScaleY:Ht,glyphOffset:_t,isSDF:Fr,sectionIndex:$r}=u[$e],Ar=pe.vertexLength,dr=_t[1];Cw(ae,F.x,F.y,at.x,dr+at.y,zt.x,zt.y,x,Fr,Kt.x,Kt.y,Wt,Ht),Cw(ae,F.x,F.y,ft.x,dr+ft.y,zt.x+zt.w,zt.y,x,Fr,br.x,Kt.y,Wt,Ht),Cw(ae,F.x,F.y,At.x,dr+At.y,zt.x,zt.y+zt.h,x,Fr,Kt.x,br.y,Wt,Ht),Cw(ae,F.x,F.y,Yt.x,dr+Yt.y,zt.x+zt.w,zt.y+zt.h,x,Fr,br.x,br.y,Wt,Ht),MC(c.dynamicLayoutVertexArray,F,Qe),re.emplaceBack(Ar,Ar+2,Ar+1),re.emplaceBack(Ar+1,Ar+2,Ar+3),pe.vertexLength+=4,pe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(_t[0]),$e!==u.length-1&&$r===u[$e+1].sectionIndex||c.programConfigurations.populatePaintArrays(ae.length,A,A.index,{imagePositions:{},canonical:ee,formattedSection:Re&&Re[$r]})}c.placedSymbolArray.emplaceBack(F.x,F.y,_e,this.glyphOffsetArray.length-_e,Pe,q,V,F.segment,x?x[0]:0,x?x[1]:0,_[0],_[1],M,0,!1,0,K)}_addCollisionDebugVertex(c,u,x,_,C,A){return u.emplaceBack(0,0),c.emplaceBack(x.x,x.y,_,C,Math.round(A.x),Math.round(A.y))}addCollisionDebugVertices(c,u,x,_,C,A,M){const F=C.segments.prepareSegment(4,C.layoutVertexArray,C.indexArray),q=F.vertexLength,V=C.layoutVertexArray,K=C.collisionVertexArray,ee=M.anchorX,re=M.anchorY;this._addCollisionDebugVertex(V,K,A,ee,re,new f(c,u)),this._addCollisionDebugVertex(V,K,A,ee,re,new f(x,u)),this._addCollisionDebugVertex(V,K,A,ee,re,new f(x,_)),this._addCollisionDebugVertex(V,K,A,ee,re,new f(c,_)),F.vertexLength+=4;const ae=C.indexArray;ae.emplaceBack(q,q+1),ae.emplaceBack(q+1,q+2),ae.emplaceBack(q+2,q+3),ae.emplaceBack(q+3,q),F.primitiveLength+=4}addDebugCollisionBoxes(c,u,x,_){for(let C=c;C<u;C++){const A=this.collisionBoxArray.get(C);this.addCollisionDebugVertices(A.x1,A.y1,A.x2,A.y2,_?this.textCollisionBox:this.iconCollisionBox,A.anchorPoint,x)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new IC(Tt,FD.members,ir),this.iconCollisionBox=new IC(Tt,FD.members,ir);for(let c=0;c<this.symbolInstances.length;c++){const u=this.symbolInstances.get(c);this.addDebugCollisionBoxes(u.textBoxStartIndex,u.textBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.iconBoxStartIndex,u.iconBoxEndIndex,u,!1),this.addDebugCollisionBoxes(u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex,u,!1)}}_deserializeCollisionBoxesForSymbol(c,u,x,_,C,A,M,F,q){const V={};for(let K=u;K<x;K++){const ee=c.get(K);V.textBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},V.textFeatureIndex=ee.featureIndex;break}for(let K=_;K<C;K++){const ee=c.get(K);V.verticalTextBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},V.verticalTextFeatureIndex=ee.featureIndex;break}for(let K=A;K<M;K++){const ee=c.get(K);V.iconBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},V.iconFeatureIndex=ee.featureIndex;break}for(let K=F;K<q;K++){const ee=c.get(K);V.verticalIconBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},V.verticalIconFeatureIndex=ee.featureIndex;break}return V}deserializeCollisionBoxes(c){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const x=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(c,x.textBoxStartIndex,x.textBoxEndIndex,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x.iconBoxStartIndex,x.iconBoxEndIndex,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(c,u){const x=c.placedSymbolArray.get(u),_=x.vertexStartIndex+4*x.numGlyphs;for(let C=x.vertexStartIndex;C<_;C+=4)c.indexArray.emplaceBack(C,C+2,C+1),c.indexArray.emplaceBack(C+1,C+2,C+3)}getSortedSymbolIndexes(c){if(this.sortedAngle===c&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const u=Math.sin(c),x=Math.cos(c),_=[],C=[],A=[];for(let M=0;M<this.symbolInstances.length;++M){A.push(M);const F=this.symbolInstances.get(M);_.push(0|Math.round(u*F.anchorX+x*F.anchorY)),C.push(F.featureIndex)}return A.sort((M,F)=>_[M]-_[F]||C[F]-C[M]),A}addToSortKeyRanges(c,u){const x=this.sortKeyRanges[this.sortKeyRanges.length-1];x&&x.sortKey===u?x.symbolInstanceEnd=c+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:c,symbolInstanceEnd:c+1})}sortFeatures(c){if(this.sortFeaturesByY&&this.sortedAngle!==c&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(c),this.sortedAngle=c,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const x=this.symbolInstances.get(u);this.featureSortOrder.push(x.featureIndex),[x.rightJustifiedTextSymbolIndex,x.centerJustifiedTextSymbolIndex,x.leftJustifiedTextSymbolIndex].forEach((_,C,A)=>{_>=0&&A.indexOf(_)===C&&this.addIndicesForPlacedSymbol(this.text,_)}),x.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,x.verticalPlacedTextSymbolIndex),x.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,x.placedIconSymbolIndex),x.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,x.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let QD,JD;er("SymbolBucket",yx,{omit:["layers","collisionBoxArray","features","compareText"]}),yx.MAX_GLYPHS=65535,yx.addDynamicAttributes=MC;var DC={get paint(){return JD=JD||new oa({"icon-opacity":new Ir(Je.paint_symbol["icon-opacity"]),"icon-color":new Ir(Je.paint_symbol["icon-color"]),"icon-halo-color":new Ir(Je.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ir(Je.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ir(Je.paint_symbol["icon-halo-blur"]),"icon-translate":new pr(Je.paint_symbol["icon-translate"]),"icon-translate-anchor":new pr(Je.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ir(Je.paint_symbol["text-opacity"]),"text-color":new Ir(Je.paint_symbol["text-color"],{runtimeType:Lo,getOverride:h=>h.textColor,hasOverride:h=>!!h.textColor}),"text-halo-color":new Ir(Je.paint_symbol["text-halo-color"]),"text-halo-width":new Ir(Je.paint_symbol["text-halo-width"]),"text-halo-blur":new Ir(Je.paint_symbol["text-halo-blur"]),"text-translate":new pr(Je.paint_symbol["text-translate"]),"text-translate-anchor":new pr(Je.paint_symbol["text-translate-anchor"])})},get layout(){return QD=QD||new oa({"symbol-placement":new pr(Je.layout_symbol["symbol-placement"]),"symbol-spacing":new pr(Je.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new pr(Je.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ir(Je.layout_symbol["symbol-sort-key"]),"symbol-z-order":new pr(Je.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new pr(Je.layout_symbol["icon-allow-overlap"]),"icon-overlap":new pr(Je.layout_symbol["icon-overlap"]),"icon-ignore-placement":new pr(Je.layout_symbol["icon-ignore-placement"]),"icon-optional":new pr(Je.layout_symbol["icon-optional"]),"icon-rotation-alignment":new pr(Je.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ir(Je.layout_symbol["icon-size"]),"icon-text-fit":new pr(Je.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new pr(Je.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ir(Je.layout_symbol["icon-image"]),"icon-rotate":new Ir(Je.layout_symbol["icon-rotate"]),"icon-padding":new Ir(Je.layout_symbol["icon-padding"]),"icon-keep-upright":new pr(Je.layout_symbol["icon-keep-upright"]),"icon-offset":new Ir(Je.layout_symbol["icon-offset"]),"icon-anchor":new Ir(Je.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new pr(Je.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new pr(Je.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new pr(Je.layout_symbol["text-rotation-alignment"]),"text-field":new Ir(Je.layout_symbol["text-field"]),"text-font":new Ir(Je.layout_symbol["text-font"]),"text-size":new Ir(Je.layout_symbol["text-size"]),"text-max-width":new Ir(Je.layout_symbol["text-max-width"]),"text-line-height":new pr(Je.layout_symbol["text-line-height"]),"text-letter-spacing":new Ir(Je.layout_symbol["text-letter-spacing"]),"text-justify":new Ir(Je.layout_symbol["text-justify"]),"text-radial-offset":new Ir(Je.layout_symbol["text-radial-offset"]),"text-variable-anchor":new pr(Je.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Ir(Je.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Ir(Je.layout_symbol["text-anchor"]),"text-max-angle":new pr(Je.layout_symbol["text-max-angle"]),"text-writing-mode":new pr(Je.layout_symbol["text-writing-mode"]),"text-rotate":new Ir(Je.layout_symbol["text-rotate"]),"text-padding":new pr(Je.layout_symbol["text-padding"]),"text-keep-upright":new pr(Je.layout_symbol["text-keep-upright"]),"text-transform":new Ir(Je.layout_symbol["text-transform"]),"text-offset":new Ir(Je.layout_symbol["text-offset"]),"text-allow-overlap":new pr(Je.layout_symbol["text-allow-overlap"]),"text-overlap":new pr(Je.layout_symbol["text-overlap"]),"text-ignore-placement":new pr(Je.layout_symbol["text-ignore-placement"]),"text-optional":new pr(Je.layout_symbol["text-optional"])})}};class eR{constructor(c){if(c.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=c.property.overrides?c.property.overrides.runtimeType:qi,this.defaultValue=c}evaluate(c){if(c.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(c.formattedSection))return u.getOverride(c.formattedSection)}return c.feature&&c.featureState?this.defaultValue.evaluate(c.feature,c.featureState):this.defaultValue.property.specification.default}eachChild(c){this.defaultValue.isConstant()||c(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}er("FormatSectionOverride",eR,{omit:["defaultValue"]});class Aw extends $o{constructor(c,u){super(c,DC,u)}recalculate(c,u){if(super.recalculate(c,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const x=this.layout.get("text-writing-mode");if(x){const _=[];for(const C of x)_.indexOf(C)<0&&_.push(C);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(c,u,x,_){const C=this.layout.get(c).evaluate(u,{},x,_),A=this._unevaluatedLayout._values[c];return A.isDataDriven()||Up(A.value)||!C?C:function(M,F){return F.replace(/{([^{}]+)}/g,(q,V)=>M&&V in M?String(M[V]):"")}(u.properties,C)}createBucket(c){return new yx(c)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const c of DC.paint.overridableProperties){if(!Aw.hasPaintOverride(this.layout,c))continue;const u=this.paint.get(c),x=new eR(u),_=new Av(x,u.property.specification);let C=null;C=u.value.kind==="constant"||u.value.kind==="source"?new Hm("source",_):new kv("composite",_,u.value.zoomStops),this.paint._values[c]=new zo(u.property,C,u.parameters)}}_handleOverridablePaintPropertyUpdate(c,u,x){return!(!this.layout||u.isDataDriven()||x.isDataDriven())&&Aw.hasPaintOverride(this.layout,c)}static hasPaintOverride(c,u){const x=c.get("text-field"),_=DC.paint.properties[u];let C=!1;const A=M=>{for(const F of M)if(_.overrides&&_.overrides.hasOverride(F))return void(C=!0)};if(x.value.kind==="constant"&&x.value.value instanceof Da)A(x.value.value.sections);else if(x.value.kind==="source"||x.value.kind==="composite"){const M=q=>{C||(q instanceof Dc&&Bs(q.value)===bd?A(q.value.sections):q instanceof Op?A(q.sections):q.eachChild(M))},F=x.value;F._styleExpression&&M(F._styleExpression.expression)}return C}}let tR;var OX={get paint(){return tR=tR||new oa({"background-color":new pr(Je.paint_background["background-color"]),"background-pattern":new uw(Je.paint_background["background-pattern"]),"background-opacity":new pr(Je.paint_background["background-opacity"])})}};class IX extends $o{constructor(c,u){super(c,OX,u)}}class DX extends $o{constructor(c,u){super(c,{},u),this.onAdd=x=>{this.implementation.onAdd&&this.implementation.onAdd(x,x.painter.context.gl)},this.onRemove=x=>{this.implementation.onRemove&&this.implementation.onRemove(x,x.painter.context.gl)},this.implementation=c}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class RX{constructor(c){this._methodToThrottle=c,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const LX={once:!0},RC=63710088e-1;class dh{constructor(c,u){if(isNaN(c)||isNaN(u))throw new Error(`Invalid LngLat object: (${c}, ${u})`);if(this.lng=+c,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new dh(It(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(c){const u=Math.PI/180,x=this.lat*u,_=c.lat*u,C=Math.sin(x)*Math.sin(_)+Math.cos(x)*Math.cos(_)*Math.cos((c.lng-this.lng)*u);return RC*Math.acos(Math.min(C,1))}static convert(c){if(c instanceof dh)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new dh(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&typeof c=="object"&&c!==null)return new dh(Number("lng"in c?c.lng:c.lon),Number(c.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const rR=2*Math.PI*RC;function nR(h){return rR*Math.cos(h*Math.PI/180)}function sR(h){return(180+h)/360}function iR(h){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h*Math.PI/360)))/360}function aR(h,c){return h/nR(c)}function oR(h){return 360*h-180}function kw(h){return 360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90}function lR(h,c){return h*nR(kw(c))}class m0{constructor(c,u,x=0){this.x=+c,this.y=+u,this.z=+x}static fromLngLat(c,u=0){const x=dh.convert(c);return new m0(sR(x.lng),iR(x.lat),aR(u,x.lat))}toLngLat(){return new dh(oR(this.x),kw(this.y))}toAltitude(){return lR(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/rR*(c=kw(this.y),1/Math.cos(c*Math.PI/180));var c}}function cR(h,c,u){var x=2*Math.PI*6378137/256/Math.pow(2,u);return[h*x-2*Math.PI*6378137/2,c*x-2*Math.PI*6378137/2]}class LC{constructor(c,u,x){if(!function(_,C,A){return!(_<0||_>25||A<0||A>=Math.pow(2,_)||C<0||C>=Math.pow(2,_))}(c,u,x))throw new Error(`x=${u}, y=${x}, z=${c} outside of bounds. 0<=x<${Math.pow(2,c)}, 0<=y<${Math.pow(2,c)} 0<=z<=25 `);this.z=c,this.x=u,this.y=x,this.key=vx(0,c,c,u,x)}equals(c){return this.z===c.z&&this.x===c.x&&this.y===c.y}url(c,u,x){const _=(A=this.y,M=this.z,F=cR(256*(C=this.x),256*(A=Math.pow(2,M)-A-1),M),q=cR(256*(C+1),256*(A+1),M),F[0]+","+F[1]+","+q[0]+","+q[1]);var C,A,M,F,q;const V=function(K,ee,re){let ae,pe="";for(let _e=K;_e>0;_e--)ae=1<<_e-1,pe+=(ee&ae?1:0)+(re&ae?2:0);return pe}(this.z,this.x,this.y);return c[(this.x+this.y)%c.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(x==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,u>1?"@2x":"").replace(/{quadkey}/g,V).replace(/{bbox-epsg-3857}/g,_)}isChildOf(c){const u=this.z-c.z;return u>0&&c.x===this.x>>u&&c.y===this.y>>u}getTilePoint(c){const u=Math.pow(2,this.z);return new f((c.x*u-this.x)*ve,(c.y*u-this.y)*ve)}toString(){return`${this.z}/${this.x}/${this.y}`}}class dR{constructor(c,u){this.wrap=c,this.canonical=u,this.key=vx(c,u.z,u.z,u.x,u.y)}}class qo{constructor(c,u,x,_,C){if(this.terrainRttPosMatrix32f=null,c<x)throw new Error(`overscaledZ should be >= z; overscaledZ = ${c}; z = ${x}`);this.overscaledZ=c,this.wrap=u,this.canonical=new LC(x,+_,+C),this.key=vx(u,c,x,_,C)}clone(){return new qo(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(c){return this.overscaledZ===c.overscaledZ&&this.wrap===c.wrap&&this.canonical.equals(c.canonical)}scaledTo(c){if(c>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${c}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-c;return c>this.canonical.z?new qo(c,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new qo(c,this.wrap,c,this.canonical.x>>u,this.canonical.y>>u)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(c,u){if(c>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${c}; overscaledZ = ${this.overscaledZ}`);const x=this.canonical.z-c;return c>this.canonical.z?vx(this.wrap*+u,c,this.canonical.z,this.canonical.x,this.canonical.y):vx(this.wrap*+u,c,c,this.canonical.x>>x,this.canonical.y>>x)}isChildOf(c){if(c.wrap!==this.wrap||this.overscaledZ-c.overscaledZ<=0)return!1;if(c.overscaledZ===0)return this.overscaledZ>0;const u=this.canonical.z-c.canonical.z;return!(u<0)&&c.canonical.x===this.canonical.x>>u&&c.canonical.y===this.canonical.y>>u}children(c){if(this.overscaledZ>=c)return[new qo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,x=2*this.canonical.x,_=2*this.canonical.y;return[new qo(u,this.wrap,u,x,_),new qo(u,this.wrap,u,x+1,_),new qo(u,this.wrap,u,x,_+1),new qo(u,this.wrap,u,x+1,_+1)]}isLessThan(c){return this.wrap<c.wrap||!(this.wrap>c.wrap)&&(this.overscaledZ<c.overscaledZ||!(this.overscaledZ>c.overscaledZ)&&(this.canonical.x<c.canonical.x||!(this.canonical.x>c.canonical.x)&&this.canonical.y<c.canonical.y))}wrapped(){return new qo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(c){return new qo(this.overscaledZ,c,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new dR(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(c){return this.canonical.getTilePoint(new m0(c.x-this.wrap,c.y))}}function vx(h,c,u,x,_){(h*=2)<0&&(h=-1*h-1);const C=1<<u;return(C*C*h+C*_+x).toString(36)+u.toString(36)+c.toString(36)}function f0(h,c){return c?h.properties[c]:h.id}er("CanonicalTileID",LC),er("OverscaledTileID",qo,{omit:["terrainRttPosMatrix32f"]});class cf{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(c){return this.minX=Math.min(this.minX,c.x),this.minY=Math.min(this.minY,c.y),this.maxX=Math.max(this.maxX,c.x),this.maxY=Math.max(this.maxY,c.y),this}expandBy(c){return this.minX-=c,this.minY-=c,this.maxX+=c,this.maxY+=c,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(c){return this.expandBy(-c)}map(c){const u=new cf;return u.extend(c(new f(this.minX,this.minY))),u.extend(c(new f(this.maxX,this.minY))),u.extend(c(new f(this.minX,this.maxY))),u.extend(c(new f(this.maxX,this.maxY))),u}static fromPoints(c){const u=new cf;for(const x of c)u.extend(x);return u}contains(c){return c.x>=this.minX&&c.x<=this.maxX&&c.y>=this.minY&&c.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(c){return!this.empty()&&!c.empty()&&c.minX>=this.minX&&c.maxX<=this.maxX&&c.minY>=this.minY&&c.maxY<=this.maxY}intersects(c){return!this.empty()&&!c.empty()&&c.minX<=this.maxX&&c.maxX>=this.minX&&c.minY<=this.maxY&&c.maxY>=this.minY}}class uR{constructor(c){this._stringToNumber={},this._numberToString=[];for(let u=0;u<c.length;u++){const x=c[u];this._stringToNumber[x]=u,this._numberToString[u]=x}}encode(c){return this._stringToNumber[c]}decode(c){if(c>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${c} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[c]}}class hR{constructor(c,u,x,_,C){this.type="Feature",this._vectorTileFeature=c,c._z=u,c._x=x,c._y=_,this.properties=c.properties,this.id=C}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(c){this._geometry=c}toJSON(){const c={geometry:this.geometry};for(const u in this)u!=="_geometry"&&u!=="_vectorTileFeature"&&(c[u]=this[u]);return c}}class mR{constructor(c,u){this.tileID=c,this.x=c.canonical.x,this.y=c.canonical.y,this.z=c.canonical.z,this.grid=new Rd(ve,16,0),this.grid3D=new Rd(ve,16,0),this.featureIndexArray=new Se,this.promoteId=u}insert(c,u,x,_,C,A){const M=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(x,_,C);const F=A?this.grid3D:this.grid;for(let q=0;q<u.length;q++){const V=u[q],K=[1/0,1/0,-1/0,-1/0];for(let ee=0;ee<V.length;ee++){const re=V[ee];K[0]=Math.min(K[0],re.x),K[1]=Math.min(K[1],re.y),K[2]=Math.max(K[2],re.x),K[3]=Math.max(K[3],re.y)}K[0]<ve&&K[1]<ve&&K[2]>=0&&K[3]>=0&&F.insert(M,K[0],K[1],K[2],K[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new kD(new CC(this.rawTileData)).layers,this.sourceLayerCoder=new uR(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(c,u,x,_){this.loadVTLayers();const C=c.params,A=ve/c.tileSize/c.scale,M=Zm(C.filter,C.globalState),F=c.queryGeometry,q=c.queryPadding*A,V=cf.fromPoints(F),K=this.grid.query(V.minX-q,V.minY-q,V.maxX+q,V.maxY+q),ee=cf.fromPoints(c.cameraQueryGeometry).expandBy(q),re=this.grid3D.query(ee.minX,ee.minY,ee.maxX,ee.maxY,(_e,Pe,Qe,Re)=>function($e,at,ft,At,Yt){for(const Kt of $e)if(at<=Kt.x&&ft<=Kt.y&&At>=Kt.x&&Yt>=Kt.y)return!0;const zt=[new f(at,ft),new f(at,Yt),new f(At,Yt),new f(At,ft)];if($e.length>2){for(const Kt of zt)if(dx($e,Kt))return!0}for(let Kt=0;Kt<$e.length-1;Kt++)if(mY($e[Kt],$e[Kt+1],zt))return!0;return!1}(c.cameraQueryGeometry,_e-q,Pe-q,Qe+q,Re+q));for(const _e of re)K.push(_e);K.sort(FX);const ae={};let pe;for(let _e=0;_e<K.length;_e++){const Pe=K[_e];if(Pe===pe)continue;pe=Pe;const Qe=this.featureIndexArray.get(Pe);let Re=null;this.loadMatchingFeature(ae,Qe.bucketIndex,Qe.sourceLayerIndex,Qe.featureIndex,M,C.layers,C.availableImages,u,x,_,($e,at,ft)=>(Re||(Re=tc($e)),at.queryIntersectsFeature({queryGeometry:F,feature:$e,featureState:ft,geometry:Re,zoom:this.z,transform:c.transform,pixelsToTileUnits:A,pixelPosMatrix:c.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:c.getElevation})))}return ae}loadMatchingFeature(c,u,x,_,C,A,M,F,q,V,K){const ee=this.bucketLayerIDs[u];if(A&&!ee.some(_e=>A.has(_e)))return;const re=this.sourceLayerCoder.decode(x),ae=this.vtLayers[re].feature(_);if(C.needGeometry){const _e=qc(ae,!0);if(!C.filter(new Gn(this.tileID.overscaledZ),_e,this.tileID.canonical))return}else if(!C.filter(new Gn(this.tileID.overscaledZ),ae))return;const pe=this.getId(ae,re);for(let _e=0;_e<ee.length;_e++){const Pe=ee[_e];if(A&&!A.has(Pe))continue;const Qe=F[Pe];if(!Qe)continue;let Re={};pe&&V&&(Re=V.getState(Qe.sourceLayer||"_geojsonTileLayer",pe));const $e=_r({},q[Pe]);$e.paint=fR($e.paint,Qe.paint,ae,Re,M),$e.layout=fR($e.layout,Qe.layout,ae,Re,M);const at=!K||K(ae,Qe,Re);if(!at)continue;const ft=new hR(ae,this.z,this.x,this.y,pe);ft.layer=$e;let At=c[Pe];At===void 0&&(At=c[Pe]=[]),At.push({featureIndex:_,feature:ft,intersectionZ:at})}}lookupSymbolFeatures(c,u,x,_,C,A,M,F){const q={};this.loadVTLayers();const V=Zm(C.filterSpec,C.globalState);for(const K of c)this.loadMatchingFeature(q,x,_,K,V,A,M,F,u);return q}hasLayer(c){for(const u of this.bucketLayerIDs)for(const x of u)if(c===x)return!0;return!1}getId(c,u){var x;let _=c.id;return this.promoteId&&(_=c.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[u]],typeof _=="boolean"&&(_=Number(_)),_===void 0&&(!((x=c.properties)===null||x===void 0)&&x.cluster)&&this.promoteId&&(_=Number(c.properties.cluster_id))),_}}function fR(h,c,u,x,_){return Qt(h,(C,A)=>{const M=c instanceof Ld?c.get(A):null;return M&&M.evaluate?M.evaluate(u,x,_):M})}function FX(h,c){return c-h}function pR(h,c,u,x,_){const C=[];for(let A=0;A<h.length;A++){const M=h[A];let F;for(let q=0;q<M.length-1;q++){let V=M[q],K=M[q+1];V.x<c&&K.x<c||(V.x<c?V=new f(c,V.y+(c-V.x)/(K.x-V.x)*(K.y-V.y))._round():K.x<c&&(K=new f(c,V.y+(c-V.x)/(K.x-V.x)*(K.y-V.y))._round()),V.y<u&&K.y<u||(V.y<u?V=new f(V.x+(u-V.y)/(K.y-V.y)*(K.x-V.x),u)._round():K.y<u&&(K=new f(V.x+(u-V.y)/(K.y-V.y)*(K.x-V.x),u)._round()),V.x>=x&&K.x>=x||(V.x>=x?V=new f(x,V.y+(x-V.x)/(K.x-V.x)*(K.y-V.y))._round():K.x>=x&&(K=new f(x,V.y+(x-V.x)/(K.x-V.x)*(K.y-V.y))._round()),V.y>=_&&K.y>=_||(V.y>=_?V=new f(V.x+(_-V.y)/(K.y-V.y)*(K.x-V.x),_)._round():K.y>=_&&(K=new f(V.x+(_-V.y)/(K.y-V.y)*(K.x-V.x),_)._round()),F&&V.equals(F[F.length-1])||(F=[V],C.push(F)),F.push(K)))))}}return C}er("FeatureIndex",mR,{omit:["rawTileData","sourceLayerCoder"]});class uh extends f{constructor(c,u,x,_){super(c,u),this.angle=x,_!==void 0&&(this.segment=_)}clone(){return new uh(this.x,this.y,this.angle,this.segment)}}function xR(h,c,u,x,_){if(c.segment===void 0||u===0)return!0;let C=c,A=c.segment+1,M=0;for(;M>-u/2;){if(A--,A<0)return!1;M-=h[A].dist(C),C=h[A]}M+=h[A].dist(h[A+1]),A++;const F=[];let q=0;for(;M<u/2;){const V=h[A],K=h[A+1];if(!K)return!1;let ee=h[A-1].angleTo(V)-V.angleTo(K);for(ee=Math.abs((ee+3*Math.PI)%(2*Math.PI)-Math.PI),F.push({distance:M,angleDelta:ee}),q+=ee;M-F[0].distance>x;)q-=F.shift().angleDelta;if(q>_)return!1;A++,M+=V.dist(K)}return!0}function gR(h){let c=0;for(let u=0;u<h.length-1;u++)c+=h[u].dist(h[u+1]);return c}function yR(h,c,u){return h?.6*c*u:0}function vR(h,c){return Math.max(h?h.right-h.left:0,c?c.right-c.left:0)}function zX(h,c,u,x,_,C){const A=yR(u,_,C),M=vR(u,x)*C;let F=0;const q=gR(h)/2;for(let V=0;V<h.length-1;V++){const K=h[V],ee=h[V+1],re=K.dist(ee);if(F+re>q){const ae=(q-F)/re,pe=vo.number(K.x,ee.x,ae),_e=vo.number(K.y,ee.y,ae),Pe=new uh(pe,_e,ee.angleTo(K),V);return Pe._round(),!A||xR(h,Pe,M,A,c)?Pe:void 0}F+=re}}function $X(h,c,u,x,_,C,A,M,F){const q=yR(x,C,A),V=vR(x,_),K=V*A,ee=h[0].x===0||h[0].x===F||h[0].y===0||h[0].y===F;return c-K<c/4&&(c=K+c/4),_R(h,ee?c/2*M%c:(V/2+2*C)*A*M%c,c,q,u,K,ee,!1,F)}function _R(h,c,u,x,_,C,A,M,F){const q=C/2,V=gR(h);let K=0,ee=c-u,re=[];for(let ae=0;ae<h.length-1;ae++){const pe=h[ae],_e=h[ae+1],Pe=pe.dist(_e),Qe=_e.angleTo(pe);for(;ee+u<K+Pe;){ee+=u;const Re=(ee-K)/Pe,$e=vo.number(pe.x,_e.x,Re),at=vo.number(pe.y,_e.y,Re);if($e>=0&&$e<F&&at>=0&&at<F&&ee-q>=0&&ee+q<=V){const ft=new uh($e,at,Qe,ae);ft._round(),x&&!xR(h,ft,C,x,_)||re.push(ft)}}K+=Pe}return M||re.length||A||(re=_R(h,K/2,u,x,_,C,A,!0,F)),re}function bR(h,c,u,x){const _=[],C=h.image,A=C.pixelRatio,M=C.paddedRect.w-2,F=C.paddedRect.h-2;let q={x1:h.left,y1:h.top,x2:h.right,y2:h.bottom};const V=C.stretchX||[[0,M]],K=C.stretchY||[[0,F]],ee=(_t,Fr)=>_t+Fr[1]-Fr[0],re=V.reduce(ee,0),ae=K.reduce(ee,0),pe=M-re,_e=F-ae;let Pe=0,Qe=re,Re=0,$e=ae,at=0,ft=pe,At=0,Yt=_e;if(C.content&&x){const _t=C.content,Fr=_t[2]-_t[0],$r=_t[3]-_t[1];(C.textFitWidth||C.textFitHeight)&&(q=ZD(h)),Pe=Tw(V,0,_t[0]),Re=Tw(K,0,_t[1]),Qe=Tw(V,_t[0],_t[2]),$e=Tw(K,_t[1],_t[3]),at=_t[0]-Pe,At=_t[1]-Re,ft=Fr-Qe,Yt=$r-$e}const zt=q.x1,Kt=q.y1,br=q.x2-zt,Wt=q.y2-Kt,Ht=(_t,Fr,$r,Ar)=>{const dr=Ew(_t.stretch-Pe,Qe,br,zt),hn=Mw(_t.fixed-at,ft,_t.stretch,re),Ts=Ew(Fr.stretch-Re,$e,Wt,Kt),_i=Mw(Fr.fixed-At,Yt,Fr.stretch,ae),ca=Ew($r.stretch-Pe,Qe,br,zt),Vo=Mw($r.fixed-at,ft,$r.stretch,re),to=Ew(Ar.stretch-Re,$e,Wt,Kt),Ui=Mw(Ar.fixed-At,Yt,Ar.stretch,ae),bs=new f(dr,Ts),Ei=new f(ca,Ts),Wi=new f(ca,to),Gi=new f(dr,to),za=new f(hn/A,_i/A),Uo=new f(Vo/A,Ui/A),Mi=c*Math.PI/180;if(Mi){const Oi=Math.sin(Mi),Ii=Math.cos(Mi),mi=[Ii,-Oi,Oi,Ii];bs._matMult(mi),Ei._matMult(mi),Gi._matMult(mi),Wi._matMult(mi)}const ro=_t.stretch+_t.fixed,bi=Fr.stretch+Fr.fixed;return{tl:bs,tr:Ei,bl:Gi,br:Wi,tex:{x:C.paddedRect.x+1+ro,y:C.paddedRect.y+1+bi,w:$r.stretch+$r.fixed-ro,h:Ar.stretch+Ar.fixed-bi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:za,pixelOffsetBR:Uo,minFontScaleX:ft/A/br,minFontScaleY:Yt/A/Wt,isSDF:u}};if(x&&(C.stretchX||C.stretchY)){const _t=jR(V,pe,re),Fr=jR(K,_e,ae);for(let $r=0;$r<_t.length-1;$r++){const Ar=_t[$r],dr=_t[$r+1];for(let hn=0;hn<Fr.length-1;hn++)_.push(Ht(Ar,Fr[hn],dr,Fr[hn+1]))}}else _.push(Ht({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:M+1},{fixed:0,stretch:F+1}));return _}function Tw(h,c,u){let x=0;for(const _ of h)x+=Math.max(c,Math.min(u,_[1]))-Math.max(c,Math.min(u,_[0]));return x}function jR(h,c,u){const x=[{fixed:-1,stretch:0}];for(const[_,C]of h){const A=x[x.length-1];x.push({fixed:_-A.stretch,stretch:A.stretch}),x.push({fixed:_-A.stretch,stretch:A.stretch+(C-_)})}return x.push({fixed:c+1,stretch:u}),x}function Ew(h,c,u,x){return h/c*u+x}function Mw(h,c,u,x){return h-c*u/x}er("Anchor",uh);class Ow{constructor(c,u,x,_,C,A,M,F,q,V){var K;if(this.boxStartIndex=c.length,q){let ee=A.top,re=A.bottom;const ae=A.collisionPadding;ae&&(ee-=ae[1],re+=ae[3]);let pe=re-ee;pe>0&&(pe=Math.max(10,pe),this.circleDiameter=pe)}else{const ee=!((K=A.image)===null||K===void 0)&&K.content&&(A.image.textFitWidth||A.image.textFitHeight)?ZD(A):{x1:A.left,y1:A.top,x2:A.right,y2:A.bottom};ee.y1=ee.y1*M-F[0],ee.y2=ee.y2*M+F[2],ee.x1=ee.x1*M-F[3],ee.x2=ee.x2*M+F[1];const re=A.collisionPadding;if(re&&(ee.x1-=re[0]*M,ee.y1-=re[1]*M,ee.x2+=re[2]*M,ee.y2+=re[3]*M),V){const ae=new f(ee.x1,ee.y1),pe=new f(ee.x2,ee.y1),_e=new f(ee.x1,ee.y2),Pe=new f(ee.x2,ee.y2),Qe=V*Math.PI/180;ae._rotate(Qe),pe._rotate(Qe),_e._rotate(Qe),Pe._rotate(Qe),ee.x1=Math.min(ae.x,pe.x,_e.x,Pe.x),ee.x2=Math.max(ae.x,pe.x,_e.x,Pe.x),ee.y1=Math.min(ae.y,pe.y,_e.y,Pe.y),ee.y2=Math.max(ae.y,pe.y,_e.y,Pe.y)}c.emplaceBack(u.x,u.y,ee.x1,ee.y1,ee.x2,ee.y2,x,_,C)}this.boxEndIndex=c.length}}class BX{constructor(c=[],u=(x,_)=>x<_?-1:x>_?1:0){if(this.data=c,this.length=this.data.length,this.compare=u,this.length>0)for(let x=(this.length>>1)-1;x>=0;x--)this._down(x)}push(c){this.data.push(c),this._up(this.length++)}pop(){if(this.length===0)return;const c=this.data[0],u=this.data.pop();return--this.length>0&&(this.data[0]=u,this._down(0)),c}peek(){return this.data[0]}_up(c){const{data:u,compare:x}=this,_=u[c];for(;c>0;){const C=c-1>>1,A=u[C];if(x(_,A)>=0)break;u[c]=A,c=C}u[c]=_}_down(c){const{data:u,compare:x}=this,_=this.length>>1,C=u[c];for(;c<_;){let A=1+(c<<1);const M=A+1;if(M<this.length&&x(u[M],u[A])<0&&(A=M),x(u[A],C)>=0)break;u[c]=u[A],c=A}u[c]=C}}function qX(h,c=1,u=!1){const x=cf.fromPoints(h[0]),_=Math.min(x.width(),x.height());let C=_/2;const A=new BX([],VX),{minX:M,minY:F,maxX:q,maxY:V}=x;if(_===0)return new f(M,F);for(let re=M;re<q;re+=_)for(let ae=F;ae<V;ae+=_)A.push(new _x(re+C,ae+C,C,h));let K=function(re){let ae=0,pe=0,_e=0;const Pe=re[0];for(let Qe=0,Re=Pe.length,$e=Re-1;Qe<Re;$e=Qe++){const at=Pe[Qe],ft=Pe[$e],At=at.x*ft.y-ft.x*at.y;pe+=(at.x+ft.x)*At,_e+=(at.y+ft.y)*At,ae+=3*At}return new _x(pe/ae,_e/ae,0,re)}(h),ee=A.length;for(;A.length;){const re=A.pop();(re.d>K.d||!K.d)&&(K=re,u&&console.log("found best %d after %d probes",Math.round(1e4*re.d)/1e4,ee)),re.max-K.d<=c||(C=re.h/2,A.push(new _x(re.p.x-C,re.p.y-C,C,h)),A.push(new _x(re.p.x+C,re.p.y-C,C,h)),A.push(new _x(re.p.x-C,re.p.y+C,C,h)),A.push(new _x(re.p.x+C,re.p.y+C,C,h)),ee+=4)}return u&&(console.log(`num probes: ${ee}`),console.log(`best distance: ${K.d}`)),K.p}function VX(h,c){return c.max-h.max}function _x(h,c,u,x){this.p=new f(h,c),this.h=u,this.d=function(_,C){let A=!1,M=1/0;for(let F=0;F<C.length;F++){const q=C[F];for(let V=0,K=q.length,ee=K-1;V<K;ee=V++){const re=q[V],ae=q[ee];re.y>_.y!=ae.y>_.y&&_.x<(ae.x-re.x)*(_.y-re.y)/(ae.y-re.y)+re.x&&(A=!A),M=Math.min(M,aD(_,re,ae))}}return(A?1:-1)*Math.sqrt(M)}(this.p,x),this.max=this.d+this.h*Math.SQRT2}var la;d.aI=void 0,(la=d.aI||(d.aI={}))[la.center=1]="center",la[la.left=2]="left",la[la.right=3]="right",la[la.top=4]="top",la[la.bottom=5]="bottom",la[la["top-left"]=6]="top-left",la[la["top-right"]=7]="top-right",la[la["bottom-left"]=8]="bottom-left",la[la["bottom-right"]=9]="bottom-right";const FC=Number.POSITIVE_INFINITY;function wR(h,c){return c[1]!==FC?function(u,x,_){let C=0,A=0;switch(x=Math.abs(x),_=Math.abs(_),u){case"top-right":case"top-left":case"top":A=_-7;break;case"bottom-right":case"bottom-left":case"bottom":A=7-_}switch(u){case"top-right":case"bottom-right":case"right":C=-x;break;case"top-left":case"bottom-left":case"left":C=x}return[C,A]}(h,c[0],c[1]):function(u,x){let _=0,C=0;x<0&&(x=0);const A=x/Math.SQRT2;switch(u){case"top-right":case"top-left":C=A-7;break;case"bottom-right":case"bottom-left":C=7-A;break;case"bottom":C=7-x;break;case"top":C=x-7}switch(u){case"top-right":case"bottom-right":_=-A;break;case"top-left":case"bottom-left":_=A;break;case"left":_=x;break;case"right":_=-x}return[_,C]}(h,c[0])}function NR(h,c,u){var x;const _=h.layout,C=(x=_.get("text-variable-anchor-offset"))===null||x===void 0?void 0:x.evaluate(c,{},u);if(C){const M=C.values,F=[];for(let q=0;q<M.length;q+=2){const V=F[q]=M[q],K=M[q+1].map(ee=>ee*Ti);V.startsWith("top")?K[1]-=7:V.startsWith("bottom")&&(K[1]+=7),F[q+1]=K}return new ia(F)}const A=_.get("text-variable-anchor");if(A){let M;M=h._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[_.get("text-radial-offset").evaluate(c,{},u)*Ti,FC]:_.get("text-offset").evaluate(c,{},u).map(q=>q*Ti);const F=[];for(const q of A)F.push(q,wR(q,M));return new ia(F)}return null}function zC(h){switch(h){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function UX(h,c,u,x,_,C,A,M,F,q,V,K){let ee=C.textMaxSize.evaluate(c,{});ee===void 0&&(ee=A);const re=h.layers[0].layout,ae=re.get("icon-offset").evaluate(c,{},V),pe=PR(u.horizontal),_e=A/24,Pe=h.tilePixelRatio*_e,Qe=h.tilePixelRatio*ee/24,Re=h.tilePixelRatio*M,$e=h.tilePixelRatio*re.get("symbol-spacing"),at=re.get("text-padding")*h.tilePixelRatio,ft=function($r,Ar,dr,hn=1){const Ts=$r.get("icon-padding").evaluate(Ar,{},dr),_i=Ts&&Ts.values;return[_i[0]*hn,_i[1]*hn,_i[2]*hn,_i[3]*hn]}(re,c,V,h.tilePixelRatio),At=re.get("text-max-angle")/180*Math.PI,Yt=re.get("text-rotation-alignment")!=="viewport"&&re.get("symbol-placement")!=="point",zt=re.get("icon-rotation-alignment")==="map"&&re.get("symbol-placement")!=="point",Kt=re.get("symbol-placement"),br=$e/2,Wt=re.get("icon-text-fit");let Ht;x&&Wt!=="none"&&(h.allowVerticalPlacement&&u.vertical&&(Ht=YD(x,u.vertical,Wt,re.get("icon-text-fit-padding"),ae,_e)),pe&&(x=YD(x,pe,Wt,re.get("icon-text-fit-padding"),ae,_e)));const _t=V?K.line.getGranularityForZoomLevel(V.z):1,Fr=($r,Ar)=>{Ar.x<0||Ar.x>=ve||Ar.y<0||Ar.y>=ve||function(dr,hn,Ts,_i,ca,Vo,to,Ui,bs,Ei,Wi,Gi,za,Uo,Mi,ro,bi,Oi,Ii,mi,as,rc,bx,nc,KX){const jx=dr.addToLineVertexArray(hn,Ts);let df,wx,Nx,Sx,TR=0,ER=0,MR=0,OR=0,KC=-1,HC=-1;const Kd={};let IR=Jl("");if(dr.allowVerticalPlacement&&_i.vertical){const Na=Ui.layout.get("text-rotate").evaluate(as,{},nc)+90;Nx=new Ow(bs,hn,Ei,Wi,Gi,_i.vertical,za,Uo,Mi,Na),to&&(Sx=new Ow(bs,hn,Ei,Wi,Gi,to,bi,Oi,Mi,Na))}if(ca){const Na=Ui.layout.get("icon-rotate").evaluate(as,{}),Wo=Ui.layout.get("icon-text-fit")!=="none",uf=bR(ca,Na,bx,Wo),ic=to?bR(to,Na,bx,Wo):void 0;wx=new Ow(bs,hn,Ei,Wi,Gi,ca,bi,Oi,!1,Na),TR=4*uf.length;const hf=dr.iconSizeData;let Vc=null;hf.kind==="source"?(Vc=[Gd*Ui.layout.get("icon-size").evaluate(as,{})],Vc[0]>ch&&or(`${dr.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):hf.kind==="composite"&&(Vc=[Gd*rc.compositeIconSizes[0].evaluate(as,{},nc),Gd*rc.compositeIconSizes[1].evaluate(as,{},nc)],(Vc[0]>ch||Vc[1]>ch)&&or(`${dr.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),dr.addSymbols(dr.icon,uf,Vc,mi,Ii,as,d.as.none,hn,jx.lineStartIndex,jx.lineLength,-1,nc),KC=dr.icon.placedSymbolArray.length-1,ic&&(ER=4*ic.length,dr.addSymbols(dr.icon,ic,Vc,mi,Ii,as,d.as.vertical,hn,jx.lineStartIndex,jx.lineLength,-1,nc),HC=dr.icon.placedSymbolArray.length-1)}const DR=Object.keys(_i.horizontal);for(const Na of DR){const Wo=_i.horizontal[Na];if(!df){IR=Jl(Wo.text);const ic=Ui.layout.get("text-rotate").evaluate(as,{},nc);df=new Ow(bs,hn,Ei,Wi,Gi,Wo,za,Uo,Mi,ic)}const uf=Wo.positionedLines.length===1;if(MR+=SR(dr,hn,Wo,Vo,Ui,Mi,as,ro,jx,_i.vertical?d.as.horizontal:d.as.horizontalOnly,uf?DR:[Na],Kd,KC,rc,nc),uf)break}_i.vertical&&(OR+=SR(dr,hn,_i.vertical,Vo,Ui,Mi,as,ro,jx,d.as.vertical,["vertical"],Kd,HC,rc,nc));const HX=df?df.boxStartIndex:dr.collisionBoxArray.length,ZX=df?df.boxEndIndex:dr.collisionBoxArray.length,YX=Nx?Nx.boxStartIndex:dr.collisionBoxArray.length,XX=Nx?Nx.boxEndIndex:dr.collisionBoxArray.length,QX=wx?wx.boxStartIndex:dr.collisionBoxArray.length,JX=wx?wx.boxEndIndex:dr.collisionBoxArray.length,eQ=Sx?Sx.boxStartIndex:dr.collisionBoxArray.length,tQ=Sx?Sx.boxEndIndex:dr.collisionBoxArray.length;let sc=-1;const Dw=(Na,Wo)=>Na&&Na.circleDiameter?Math.max(Na.circleDiameter,Wo):Wo;sc=Dw(df,sc),sc=Dw(Nx,sc),sc=Dw(wx,sc),sc=Dw(Sx,sc);const RR=sc>-1?1:0;RR&&(sc*=KX/Ti),dr.glyphOffsetArray.length>=yx.MAX_GLYPHS&&or("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),as.sortKey!==void 0&&dr.addToSortKeyRanges(dr.symbolInstances.length,as.sortKey);const rQ=NR(Ui,as,nc),[nQ,sQ]=function(Na,Wo){const uf=Na.length,ic=Wo==null?void 0:Wo.values;if((ic==null?void 0:ic.length)>0)for(let hf=0;hf<ic.length;hf+=2){const Vc=ic[hf+1];Na.emplaceBack(d.aI[ic[hf]],Vc[0],Vc[1])}return[uf,Na.length]}(dr.textAnchorOffsets,rQ);dr.symbolInstances.emplaceBack(hn.x,hn.y,Kd.right>=0?Kd.right:-1,Kd.center>=0?Kd.center:-1,Kd.left>=0?Kd.left:-1,Kd.vertical||-1,KC,HC,IR,HX,ZX,YX,XX,QX,JX,eQ,tQ,Ei,MR,OR,TR,ER,RR,0,za,sc,nQ,sQ)}(h,Ar,$r,u,x,_,Ht,h.layers[0],h.collisionBoxArray,c.index,c.sourceLayerIndex,h.index,Pe,[at,at,at,at],Yt,F,Re,ft,zt,ae,c,C,q,V,A)};if(Kt==="line")for(const $r of pR(c.geometry,0,0,ve,ve)){const Ar=lf($r,_t),dr=$X(Ar,$e,At,u.vertical||pe,x,24,Qe,h.overscaling,ve);for(const hn of dr)pe&&WX(h,pe.text,br,hn)||Fr(Ar,hn)}else if(Kt==="line-center"){for(const $r of c.geometry)if($r.length>1){const Ar=lf($r,_t),dr=zX(Ar,At,u.vertical||pe,x,24,Qe);dr&&Fr(Ar,dr)}}else if(c.type==="Polygon")for(const $r of Ip(c.geometry,0)){const Ar=qX($r,16);Fr(lf($r[0],_t,!0),new uh(Ar.x,Ar.y,0))}else if(c.type==="LineString")for(const $r of c.geometry){const Ar=lf($r,_t);Fr(Ar,new uh(Ar[0].x,Ar[0].y,0))}else if(c.type==="Point")for(const $r of c.geometry)for(const Ar of $r)Fr([Ar],new uh(Ar.x,Ar.y,0))}function SR(h,c,u,x,_,C,A,M,F,q,V,K,ee,re,ae){const pe=function(Qe,Re,$e,at,ft,At,Yt,zt){const Kt=at.layout.get("text-rotate").evaluate(At,{})*Math.PI/180,br=[];for(const Wt of Re.positionedLines)for(const Ht of Wt.positionedGlyphs){if(!Ht.rect)continue;const _t=Ht.rect||{};let Fr=4,$r=!0,Ar=1,dr=0;const hn=(ft||zt)&&Ht.vertical,Ts=Ht.metrics.advance*Ht.scale/2;if(zt&&Re.verticalizable&&(dr=Wt.lineOffset/2-(Ht.imageName?-(Ti-Ht.metrics.width*Ht.scale)/2:(Ht.scale-1)*Ti)),Ht.imageName){const Oi=Yt[Ht.imageName];$r=Oi.sdf,Ar=Oi.pixelRatio,Fr=1/Ar}const _i=ft?[Ht.x+Ts,Ht.y]:[0,0];let ca=ft?[0,0]:[Ht.x+Ts+$e[0],Ht.y+$e[1]-dr],Vo=[0,0];hn&&(Vo=ca,ca=[0,0]);const to=Ht.metrics.isDoubleResolution?2:1,Ui=(Ht.metrics.left-Fr)*Ht.scale-Ts+ca[0],bs=(-Ht.metrics.top-Fr)*Ht.scale+ca[1],Ei=Ui+_t.w/to*Ht.scale/Ar,Wi=bs+_t.h/to*Ht.scale/Ar,Gi=new f(Ui,bs),za=new f(Ei,bs),Uo=new f(Ui,Wi),Mi=new f(Ei,Wi);if(hn){const Oi=new f(-Ts,Ts- -17),Ii=-Math.PI/2,mi=12-Ts,as=new f(22-mi,-(Ht.imageName?mi:0)),rc=new f(...Vo);Gi._rotateAround(Ii,Oi)._add(as)._add(rc),za._rotateAround(Ii,Oi)._add(as)._add(rc),Uo._rotateAround(Ii,Oi)._add(as)._add(rc),Mi._rotateAround(Ii,Oi)._add(as)._add(rc)}if(Kt){const Oi=Math.sin(Kt),Ii=Math.cos(Kt),mi=[Ii,-Oi,Oi,Ii];Gi._matMult(mi),za._matMult(mi),Uo._matMult(mi),Mi._matMult(mi)}const ro=new f(0,0),bi=new f(0,0);br.push({tl:Gi,tr:za,bl:Uo,br:Mi,tex:_t,writingMode:Re.writingMode,glyphOffset:_i,sectionIndex:Ht.sectionIndex,isSDF:$r,pixelOffsetTL:ro,pixelOffsetBR:bi,minFontScaleX:0,minFontScaleY:0})}return br}(0,u,M,_,C,A,x,h.allowVerticalPlacement),_e=h.textSizeData;let Pe=null;_e.kind==="source"?(Pe=[Gd*_.layout.get("text-size").evaluate(A,{})],Pe[0]>ch&&or(`${h.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):_e.kind==="composite"&&(Pe=[Gd*re.compositeTextSizes[0].evaluate(A,{},ae),Gd*re.compositeTextSizes[1].evaluate(A,{},ae)],(Pe[0]>ch||Pe[1]>ch)&&or(`${h.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),h.addSymbols(h.text,pe,Pe,M,C,A,q,c,F.lineStartIndex,F.lineLength,ee,ae);for(const Qe of V)K[Qe]=h.text.placedSymbolArray.length-1;return 4*pe.length}function PR(h){for(const c in h)return h[c];return null}function WX(h,c,u,x){const _=h.compareText;if(c in _){const C=_[c];for(let A=C.length-1;A>=0;A--)if(x.dist(C[A])<u)return!0}else _[c]=[];return _[c].push(x),!1}const CR=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class $C{static from(c){if(!(c instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[u,x]=new Uint8Array(c,0,2);if(u!==219)throw new Error("Data does not appear to be in a KDBush format.");const _=x>>4;if(_!==1)throw new Error(`Got v${_} data when expected v1.`);const C=CR[15&x];if(!C)throw new Error("Unrecognized array type.");const[A]=new Uint16Array(c,2,1),[M]=new Uint32Array(c,4,1);return new $C(M,A,C,c)}constructor(c,u=64,x=Float64Array,_){if(isNaN(c)||c<0)throw new Error(`Unpexpected numItems value: ${c}.`);this.numItems=+c,this.nodeSize=Math.min(Math.max(+u,2),65535),this.ArrayType=x,this.IndexArrayType=c<65536?Uint16Array:Uint32Array;const C=CR.indexOf(this.ArrayType),A=2*c*this.ArrayType.BYTES_PER_ELEMENT,M=c*this.IndexArrayType.BYTES_PER_ELEMENT,F=(8-M%8)%8;if(C<0)throw new Error(`Unexpected typed array class: ${x}.`);_&&_ instanceof ArrayBuffer?(this.data=_,this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+M+F,2*c),this._pos=2*c,this._finished=!0):(this.data=new ArrayBuffer(8+A+M+F),this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+M+F,2*c),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+C]),new Uint16Array(this.data,2,1)[0]=u,new Uint32Array(this.data,4,1)[0]=c)}add(c,u){const x=this._pos>>1;return this.ids[x]=x,this.coords[this._pos++]=c,this.coords[this._pos++]=u,x}finish(){const c=this._pos>>1;if(c!==this.numItems)throw new Error(`Added ${c} items when expected ${this.numItems}.`);return BC(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(c,u,x,_){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:C,coords:A,nodeSize:M}=this,F=[0,C.length-1,0],q=[];for(;F.length;){const V=F.pop()||0,K=F.pop()||0,ee=F.pop()||0;if(K-ee<=M){for(let _e=ee;_e<=K;_e++){const Pe=A[2*_e],Qe=A[2*_e+1];Pe>=c&&Pe<=x&&Qe>=u&&Qe<=_&&q.push(C[_e])}continue}const re=ee+K>>1,ae=A[2*re],pe=A[2*re+1];ae>=c&&ae<=x&&pe>=u&&pe<=_&&q.push(C[re]),(V===0?c<=ae:u<=pe)&&(F.push(ee),F.push(re-1),F.push(1-V)),(V===0?x>=ae:_>=pe)&&(F.push(re+1),F.push(K),F.push(1-V))}return q}within(c,u,x){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:C,nodeSize:A}=this,M=[0,_.length-1,0],F=[],q=x*x;for(;M.length;){const V=M.pop()||0,K=M.pop()||0,ee=M.pop()||0;if(K-ee<=A){for(let _e=ee;_e<=K;_e++)kR(C[2*_e],C[2*_e+1],c,u)<=q&&F.push(_[_e]);continue}const re=ee+K>>1,ae=C[2*re],pe=C[2*re+1];kR(ae,pe,c,u)<=q&&F.push(_[re]),(V===0?c-x<=ae:u-x<=pe)&&(M.push(ee),M.push(re-1),M.push(1-V)),(V===0?c+x>=ae:u+x>=pe)&&(M.push(re+1),M.push(K),M.push(1-V))}return F}}function BC(h,c,u,x,_,C){if(_-x<=u)return;const A=x+_>>1;AR(h,c,A,x,_,C),BC(h,c,u,x,A-1,1-C),BC(h,c,u,A+1,_,1-C)}function AR(h,c,u,x,_,C){for(;_>x;){if(_-x>600){const q=_-x+1,V=u-x+1,K=Math.log(q),ee=.5*Math.exp(2*K/3),re=.5*Math.sqrt(K*ee*(q-ee)/q)*(V-q/2<0?-1:1);AR(h,c,u,Math.max(x,Math.floor(u-V*ee/q+re)),Math.min(_,Math.floor(u+(q-V)*ee/q+re)),C)}const A=c[2*u+C];let M=x,F=_;for(p0(h,c,x,u),c[2*_+C]>A&&p0(h,c,x,_);M<F;){for(p0(h,c,M,F),M++,F--;c[2*M+C]<A;)M++;for(;c[2*F+C]>A;)F--}c[2*x+C]===A?p0(h,c,x,F):(F++,p0(h,c,F,_)),F<=u&&(x=F+1),u<=F&&(_=F-1)}}function p0(h,c,u,x){qC(h,u,x),qC(c,2*u,2*x),qC(c,2*u+1,2*x+1)}function qC(h,c,u){const x=h[c];h[c]=h[u],h[u]=x}function kR(h,c,u,x){const _=h-u,C=c-x;return _*_+C*C}var VC;d.cA=void 0,(VC=d.cA||(d.cA={})).create="create",VC.load="load",VC.fullLoad="fullLoad";let Iw=null,x0=[];const UC=1e3/60,WC="loadTime",GC="fullLoadTime",GX={mark(h){performance.mark(h)},frame(h){const c=h;Iw!=null&&x0.push(c-Iw),Iw=c},clearMetrics(){Iw=null,x0=[],performance.clearMeasures(WC),performance.clearMeasures(GC);for(const h in d.cA)performance.clearMarks(d.cA[h])},getPerformanceMetrics(){performance.measure(WC,d.cA.create,d.cA.load),performance.measure(GC,d.cA.create,d.cA.fullLoad);const h=performance.getEntriesByName(WC)[0].duration,c=performance.getEntriesByName(GC)[0].duration,u=x0.length,x=1/(x0.reduce((C,A)=>C+A,0)/u/1e3),_=x0.filter(C=>C>UC).reduce((C,A)=>C+(A-UC)/UC,0);return{loadTime:h,fullLoadTime:c,fps:x,percentDroppedFrames:_/(u+_)*100,totalFrames:u}}};d.$=nt,d.A=I,d.B=nh,d.C=function([h,c,u]){return c+=90,c*=Math.PI/180,u*=Math.PI/180,{x:h*Math.cos(c)*Math.sin(u),y:h*Math.sin(c)*Math.sin(u),z:h*Math.cos(u)}},d.D=pr,d.E=lr,d.F=vo,d.G=Gn,d.H=Jm,d.I=AC,d.J=ks,d.K=class{constructor(h,c){this.target=h,this.mapId=c,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new RX(()=>this.process()),this.subscription=Vt(this.target,"message",u=>this.receive(u),!1),this.globalScope=Lr(self)?h:window}registerMessageHandler(h,c){this.messageHandlers[h]=c}sendAsync(h,c){return new Promise((u,x)=>{const _=Math.round(1e18*Math.random()).toString(36).substring(0,10),C=c?Vt(c.signal,"abort",()=>{C==null||C.unsubscribe(),delete this.resolveRejects[_];const F={id:_,type:"<cancel>",origin:location.origin,targetMapId:h.targetMapId,sourceMapId:this.mapId};this.target.postMessage(F)},LX):null;this.resolveRejects[_]={resolve:F=>{C==null||C.unsubscribe(),u(F)},reject:F=>{C==null||C.unsubscribe(),x(F)}};const A=[],M=Object.assign(Object.assign({},h),{id:_,sourceMapId:this.mapId,origin:location.origin,data:Yl(h.data,A)});this.target.postMessage(M,{transfer:A})})}receive(h){const c=h.data,u=c.id;if(!(c.origin!=="file://"&&location.origin!=="file://"&&c.origin!=="resource://android"&&location.origin!=="resource://android"&&c.origin!==location.origin||c.targetMapId&&this.mapId!==c.targetMapId)){if(c.type==="<cancel>"){delete this.tasks[u];const x=this.abortControllers[u];return delete this.abortControllers[u],void(x&&x.abort())}if(Lr(self)||c.mustQueue)return this.tasks[u]=c,this.taskQueue.push(u),void this.invoker.trigger();this.processTask(u,c)}}process(){if(this.taskQueue.length===0)return;const h=this.taskQueue.shift(),c=this.tasks[h];delete this.tasks[h],this.taskQueue.length>0&&this.invoker.trigger(),c&&this.processTask(h,c)}processTask(h,c){return a(this,void 0,void 0,function*(){if(c.type==="<response>"){const _=this.resolveRejects[h];return delete this.resolveRejects[h],_?void(c.error?_.reject(ef(c.error)):_.resolve(ef(c.data))):void 0}if(!this.messageHandlers[c.type])return void this.completeTask(h,new Error(`Could not find a registered handler for ${c.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const u=ef(c.data),x=new AbortController;this.abortControllers[h]=x;try{const _=yield this.messageHandlers[c.type](c.sourceMapId,u,x);this.completeTask(h,null,_)}catch(_){this.completeTask(h,_)}})}completeTask(h,c,u){const x=[];delete this.abortControllers[h];const _={id:h,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:c?Yl(c):null,data:Yl(u,x)};this.target.postMessage(_,{transfer:x})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},d.L=ye,d.M=function(){var h=new I(16);return I!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=0,h[12]=0,h[13]=0,h[14]=0),h[0]=1,h[5]=1,h[10]=1,h[15]=1,h},d.N=function(h,c,u){var x,_,C,A,M,F,q,V,K,ee,re,ae,pe=u[0],_e=u[1],Pe=u[2];return c===h?(h[12]=c[0]*pe+c[4]*_e+c[8]*Pe+c[12],h[13]=c[1]*pe+c[5]*_e+c[9]*Pe+c[13],h[14]=c[2]*pe+c[6]*_e+c[10]*Pe+c[14],h[15]=c[3]*pe+c[7]*_e+c[11]*Pe+c[15]):(_=c[1],C=c[2],A=c[3],M=c[4],F=c[5],q=c[6],V=c[7],K=c[8],ee=c[9],re=c[10],ae=c[11],h[0]=x=c[0],h[1]=_,h[2]=C,h[3]=A,h[4]=M,h[5]=F,h[6]=q,h[7]=V,h[8]=K,h[9]=ee,h[10]=re,h[11]=ae,h[12]=x*pe+M*_e+K*Pe+c[12],h[13]=_*pe+F*_e+ee*Pe+c[13],h[14]=C*pe+q*_e+re*Pe+c[14],h[15]=A*pe+V*_e+ae*Pe+c[15]),h},d.O=function(h,c,u){var x=u[0],_=u[1],C=u[2];return h[0]=c[0]*x,h[1]=c[1]*x,h[2]=c[2]*x,h[3]=c[3]*x,h[4]=c[4]*_,h[5]=c[5]*_,h[6]=c[6]*_,h[7]=c[7]*_,h[8]=c[8]*C,h[9]=c[9]*C,h[10]=c[10]*C,h[11]=c[11]*C,h[12]=c[12],h[13]=c[13],h[14]=c[14],h[15]=c[15],h},d.P=f,d.Q=function(h,c,u){var x=c[0],_=c[1],C=c[2],A=c[3],M=c[4],F=c[5],q=c[6],V=c[7],K=c[8],ee=c[9],re=c[10],ae=c[11],pe=c[12],_e=c[13],Pe=c[14],Qe=c[15],Re=u[0],$e=u[1],at=u[2],ft=u[3];return h[0]=Re*x+$e*M+at*K+ft*pe,h[1]=Re*_+$e*F+at*ee+ft*_e,h[2]=Re*C+$e*q+at*re+ft*Pe,h[3]=Re*A+$e*V+at*ae+ft*Qe,h[4]=(Re=u[4])*x+($e=u[5])*M+(at=u[6])*K+(ft=u[7])*pe,h[5]=Re*_+$e*F+at*ee+ft*_e,h[6]=Re*C+$e*q+at*re+ft*Pe,h[7]=Re*A+$e*V+at*ae+ft*Qe,h[8]=(Re=u[8])*x+($e=u[9])*M+(at=u[10])*K+(ft=u[11])*pe,h[9]=Re*_+$e*F+at*ee+ft*_e,h[10]=Re*C+$e*q+at*re+ft*Pe,h[11]=Re*A+$e*V+at*ae+ft*Qe,h[12]=(Re=u[12])*x+($e=u[13])*M+(at=u[14])*K+(ft=u[15])*pe,h[13]=Re*_+$e*F+at*ee+ft*_e,h[14]=Re*C+$e*q+at*re+ft*Pe,h[15]=Re*A+$e*V+at*ae+ft*Qe,h},d.R=eo,d.S=function(h,c){const u={};for(let x=0;x<c.length;x++){const _=c[x];_ in h&&(u[_]=h[_])}return u},d.T=yC,d.U=dh,d.V=It,d.W=iR,d.X=sR,d.Y=R,d.Z=D,d._=a,d.a=le,d.a$=function(h,c,u){return h[0]=c[0]*u[0],h[1]=c[1]*u[1],h[2]=c[2]*u[2],h[3]=c[3]*u[3],h},d.a0=qo,d.a1=oR,d.a2=kw,d.a3=ve,d.a4=function(h,c){var u,x,_,C,A;if(!h)return c??{};if(!c)return h;let M=Object.assign({},h);if(c.removeAll&&(M={removeAll:!0}),c.remove){const F=new Set(c.remove);M.add&&(M.add=M.add.filter(V=>!F.has(V.id))),M.update&&(M.update=M.update.filter(V=>!F.has(V.id)));const q=new Set(((u=h.add)!==null&&u!==void 0?u:[]).map(V=>V.id));c.remove=c.remove.filter(V=>!q.has(V))}if(c.remove){const F=new Set(M.remove?M.remove.concat(c.remove):c.remove);M.remove=Array.from(F.values())}if(c.add){const F=M.add?M.add.concat(c.add):c.add,q=new Map(F.map(V=>[V.id,V]));M.add=Array.from(q.values())}if(c.update){const F=new Map((x=M.update)===null||x===void 0?void 0:x.map(q=>[q.id,q]));for(const q of c.update){const V=(_=F.get(q.id))!==null&&_!==void 0?_:{id:q.id};q.newGeometry&&(V.newGeometry=q.newGeometry),q.addOrUpdateProperties&&(V.addOrUpdateProperties=((C=V.addOrUpdateProperties)!==null&&C!==void 0?C:[]).concat(q.addOrUpdateProperties)),q.removeProperties&&(V.removeProperties=((A=V.removeProperties)!==null&&A!==void 0?A:[]).concat(q.removeProperties)),q.removeAllProperties&&(V.removeAllProperties=!0),F.set(q.id,V)}M.update=Array.from(F.values())}return M.remove&&M.add&&(M.remove=M.remove.filter(F=>M.add.findIndex(q=>q.id===F)===-1)),M},d.a5=m0,d.a6=cf,d.a7=25,d.a8=LC,d.a9=h=>{const c=window.document.createElement("video");return c.muted=!0,new Promise(u=>{c.onloadstart=()=>{u(c)};for(const x of h){const _=window.document.createElement("source");st(x)||(c.crossOrigin="Anonymous"),_.src=x,c.appendChild(_)}})},d.aA=Oe,d.aB=function(h,c,u,x){const _=c.y-h.y,C=c.x-h.x,A=x.y-u.y,M=x.x-u.x,F=A*C-M*_;if(F===0)return null;const q=(M*(h.y-u.y)-A*(h.x-u.x))/F;return new f(h.x+q*C,h.y+q*_)},d.aC=pR,d.aD=sD,d.aE=function(h){let c=1/0,u=1/0,x=-1/0,_=-1/0;for(const C of h)c=Math.min(c,C.x),u=Math.min(u,C.y),x=Math.max(x,C.x),_=Math.max(_,C.y);return[c,u,x,_]},d.aF=Ti,d.aG=rt,d.aH=function(h,c,u,x,_=!1){if(!u[0]&&!u[1])return[0,0];const C=_?x==="map"?-h.bearingInRadians:0:x==="viewport"?h.bearingInRadians:0;if(C){const A=Math.sin(C),M=Math.cos(C);u=[u[0]*M-u[1]*A,u[0]*A+u[1]*M]}return[_?u[0]:rt(c,u[0],h.zoom),_?u[1]:rt(c,u[1],h.zoom)]},d.aJ=EC,d.aK=zC,d.aL=TC,d.aM=$C,d.aN=qs,d.aO=ww,d.aP=Te,d.aQ=Hr,d.aR=bt,d.aS=sr,d.aT=lR,d.aU=be,d.aV=te,d.aW=function(h){var c=new I(3);return c[0]=h[0],c[1]=h[1],c[2]=h[2],c},d.aX=function(h,c,u){return h[0]=c[0]-u[0],h[1]=c[1]-u[1],h[2]=c[2]-u[2],h},d.aY=function(h,c){var u=c[0],x=c[1],_=c[2],C=u*u+x*x+_*_;return C>0&&(C=1/Math.sqrt(C)),h[0]=c[0]*C,h[1]=c[1]*C,h[2]=c[2]*C,h},d.aZ=ie,d.a_=function(h,c){return h[0]*c[0]+h[1]*c[1]+h[2]*c[2]},d.aa=jt,d.ab=function(){return St++},d.ac=z,d.ad=yx,d.ae=Zm,d.af=qc,d.ag=hR,d.ah=function(h){const c={};if(h.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,x,_,C)=>{const A=_||C;return c[x]=!A||A.toLowerCase(),""}),c["max-age"]){const u=parseInt(c["max-age"],10);isNaN(u)?delete c["max-age"]:c["max-age"]=u}return c},d.ai=Pr,d.aj=85.051129,d.ak=Ft,d.al=function(h){return Math.pow(2,h)},d.am=$,d.an=aR,d.ao=function(h){return Math.log(h)/Math.LN2},d.ap=function(h){var c=h[0],u=h[1];return c*c+u*u},d.aq=function(h){if(!h.length)return new Set;const c=Math.max(...h.map(F=>F.canonical.z));let u=1/0,x=-1/0,_=1/0,C=-1/0;const A=[];for(const F of h){const{x:q,y:V,z:K}=F.canonical,ee=Math.pow(2,c-K),re=q*ee,ae=V*ee;A.push({id:F,x:re,y:ae}),re<u&&(u=re),re>x&&(x=re),ae<_&&(_=ae),ae>C&&(C=ae)}const M=new Set;for(const F of A)F.x!==u&&F.x!==x&&F.y!==_&&F.y!==C||M.add(F.id);return M},d.ar=function(h,c){let u=0,x=0;if(h.kind==="constant")x=h.layoutSize;else if(h.kind!=="source"){const{interpolationType:_,minZoom:C,maxZoom:A}=h,M=_?Pr(Dn.interpolationFactor(_,c,C,A),0,1):0;h.kind==="camera"?x=vo.number(h.minSize,h.maxSize,M):u=M}return{uSizeT:u,uSize:x}},d.at=function(h,{uSize:c,uSizeT:u},{lowerSize:x,upperSize:_}){return h.kind==="source"?x/Gd:h.kind==="composite"?vo.number(x/Gd,_/Gd,u):c},d.au=function(h,c){var u=c[0],x=c[1],_=c[2],C=c[3],A=c[4],M=c[5],F=c[6],q=c[7],V=c[8],K=c[9],ee=c[10],re=c[11],ae=c[12],pe=c[13],_e=c[14],Pe=c[15],Qe=u*M-x*A,Re=u*F-_*A,$e=u*q-C*A,at=x*F-_*M,ft=x*q-C*M,At=_*q-C*F,Yt=V*pe-K*ae,zt=V*_e-ee*ae,Kt=V*Pe-re*ae,br=K*_e-ee*pe,Wt=K*Pe-re*pe,Ht=ee*Pe-re*_e,_t=Qe*Ht-Re*Wt+$e*br+at*Kt-ft*zt+At*Yt;return _t?(h[0]=(M*Ht-F*Wt+q*br)*(_t=1/_t),h[1]=(_*Wt-x*Ht-C*br)*_t,h[2]=(pe*At-_e*ft+Pe*at)*_t,h[3]=(ee*ft-K*At-re*at)*_t,h[4]=(F*Kt-A*Ht-q*zt)*_t,h[5]=(u*Ht-_*Kt+C*zt)*_t,h[6]=(_e*$e-ae*At-Pe*Re)*_t,h[7]=(V*At-ee*$e+re*Re)*_t,h[8]=(A*Wt-M*Kt+q*Yt)*_t,h[9]=(x*Kt-u*Wt-C*Yt)*_t,h[10]=(ae*ft-pe*$e+Pe*Qe)*_t,h[11]=(K*$e-V*ft-re*Qe)*_t,h[12]=(M*zt-A*br-F*Yt)*_t,h[13]=(u*br-x*zt+_*Yt)*_t,h[14]=(pe*Re-ae*at-_e*Qe)*_t,h[15]=(V*at-K*Re+ee*Qe)*_t,h):null},d.av=tt,d.aw=function(h){var c=h[0],u=h[1];return Math.sqrt(c*c+u*u)},d.ax=function(h){return h[0]=0,h[1]=0,h},d.ay=function(h,c,u){return h[0]=c[0]*u,h[1]=c[1]*u,h},d.az=MC,d.b=Yn,d.b$=function(h,c,u){var x=c[0],_=c[1],C=c[2];return h[0]=x*u[0]+_*u[3]+C*u[6],h[1]=x*u[1]+_*u[4]+C*u[7],h[2]=x*u[2]+_*u[5]+C*u[8],h},d.b0=Z,d.b1=function(h,c,u){const x=c[0]*u[0]+c[1]*u[1]+c[2]*u[2];return x===0?null:(-(h[0]*u[0]+h[1]*u[1]+h[2]*u[2])-u[3])/x},d.b2=Ie,d.b3=function(h,c,u){return h[0]=c[0]*u,h[1]=c[1]*u,h[2]=c[2]*u,h[3]=c[3]*u,h},d.b4=function(h,c){return h[0]*c[0]+h[1]*c[1]+h[2]*c[2]+h[3]},d.b5=dR,d.b6=vx,d.b7=function(h,c,u,x,_){var C=1/Math.tan(c/2);if(h[0]=C/u,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=C,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=-1,h[12]=0,h[13]=0,h[15]=0,_!=null&&_!==1/0){var A=1/(x-_);h[10]=(_+x)*A,h[14]=2*_*x*A}else h[10]=-1,h[14]=-2*x;return h},d.b8=function(h){var c=new I(16);return c[0]=h[0],c[1]=h[1],c[2]=h[2],c[3]=h[3],c[4]=h[4],c[5]=h[5],c[6]=h[6],c[7]=h[7],c[8]=h[8],c[9]=h[9],c[10]=h[10],c[11]=h[11],c[12]=h[12],c[13]=h[13],c[14]=h[14],c[15]=h[15],c},d.b9=function(h,c,u){var x=Math.sin(u),_=Math.cos(u),C=c[0],A=c[1],M=c[2],F=c[3],q=c[4],V=c[5],K=c[6],ee=c[7];return c!==h&&(h[8]=c[8],h[9]=c[9],h[10]=c[10],h[11]=c[11],h[12]=c[12],h[13]=c[13],h[14]=c[14],h[15]=c[15]),h[0]=C*_+q*x,h[1]=A*_+V*x,h[2]=M*_+K*x,h[3]=F*_+ee*x,h[4]=q*_-C*x,h[5]=V*_-A*x,h[6]=K*_-M*x,h[7]=ee*_-F*x,h},d.bA=function(h,c,u,x){var _=[],C=[];return _[0]=c[0]-u[0],_[1]=c[1]-u[1],_[2]=c[2]-u[2],C[0]=_[0],C[1]=_[1]*Math.cos(x)-_[2]*Math.sin(x),C[2]=_[1]*Math.sin(x)+_[2]*Math.cos(x),h[0]=C[0]+u[0],h[1]=C[1]+u[1],h[2]=C[2]+u[2],h},d.bB=function(h,c,u,x){var _=[],C=[];return _[0]=c[0]-u[0],_[1]=c[1]-u[1],_[2]=c[2]-u[2],C[0]=_[2]*Math.sin(x)+_[0]*Math.cos(x),C[1]=_[1],C[2]=_[2]*Math.cos(x)-_[0]*Math.sin(x),h[0]=C[0]+u[0],h[1]=C[1]+u[1],h[2]=C[2]+u[2],h},d.bC=function(h,c,u){var x=Math.sin(u),_=Math.cos(u),C=c[0],A=c[1],M=c[2],F=c[3],q=c[8],V=c[9],K=c[10],ee=c[11];return c!==h&&(h[4]=c[4],h[5]=c[5],h[6]=c[6],h[7]=c[7],h[12]=c[12],h[13]=c[13],h[14]=c[14],h[15]=c[15]),h[0]=C*_-q*x,h[1]=A*_-V*x,h[2]=M*_-K*x,h[3]=F*_-ee*x,h[8]=C*x+q*_,h[9]=A*x+V*_,h[10]=M*x+K*_,h[11]=F*x+ee*_,h},d.bD=function(h,c){const u=vt(h,360),x=vt(c,360),_=x-u,C=x>u?_-360:_+360;return Math.abs(_)<Math.abs(C)?_:C},d.bE=function(h){return h[0]=0,h[1]=0,h[2]=0,h},d.bF=function(h,c,u,x){const _=Math.sqrt(h*h+c*c),C=Math.sqrt(u*u+x*x);h/=_,c/=_,u/=C,x/=C;const A=Math.acos(h*u+c*x);return-c*u+h*x>0?A:-A},d.bG=function(h,c){const u=vt(h,2*Math.PI),x=vt(c,2*Math.PI);return Math.min(Math.abs(u-x),Math.abs(u-x+2*Math.PI),Math.abs(u-x-2*Math.PI))},d.bH=function(){const h={},c=Je.$version;for(const u in Je.$root){const x=Je.$root[u];if(x.required){let _=null;_=u==="version"?c:x.type==="array"?[]:{},_!=null&&(h[u]=_)}}return h},d.bI=Bv,d.bJ=ze,d.bK=function h(c,u){if(Array.isArray(c)){if(!Array.isArray(u)||c.length!==u.length)return!1;for(let x=0;x<c.length;x++)if(!h(c[x],u[x]))return!1;return!0}if(typeof c=="object"&&c!==null&&u!==null){if(typeof u!="object"||Object.keys(c).length!==Object.keys(u).length)return!1;for(const x in c)if(!h(c[x],u[x]))return!1;return!0}return c===u},d.bL=function(h){h=h.slice();const c=Object.create(null);for(let u=0;u<h.length;u++)c[h[u].id]=h[u];for(let u=0;u<h.length;u++)"ref"in h[u]&&(h[u]=fr(h[u],c[h[u].ref]));return h},d.bM=function(h,c){if(h.type==="custom")return new DX(h,c);switch(h.type){case"background":return new IX(h,c);case"circle":return new vY(h,c);case"color-relief":return new SY(h,c);case"fill":return new $Y(h,c);case"fill-extrusion":return new XY(h,c);case"heatmap":return new bY(h,c);case"hillshade":return new wY(h,c);case"line":return new sX(h,c);case"raster":return new cC(h,c);case"symbol":return new Aw(h,c)}},d.bN=h=>h.type==="raster",d.bO=pt,d.bP=function(h,c){if(!h)return[{command:"setStyle",args:[c]}];let u=[];try{if(!Gt(h.version,c.version))return[{command:"setStyle",args:[c]}];Gt(h.center,c.center)||u.push({command:"setCenter",args:[c.center]}),Gt(h.state,c.state)||u.push({command:"setGlobalState",args:[c.state]}),Gt(h.centerAltitude,c.centerAltitude)||u.push({command:"setCenterAltitude",args:[c.centerAltitude]}),Gt(h.zoom,c.zoom)||u.push({command:"setZoom",args:[c.zoom]}),Gt(h.bearing,c.bearing)||u.push({command:"setBearing",args:[c.bearing]}),Gt(h.pitch,c.pitch)||u.push({command:"setPitch",args:[c.pitch]}),Gt(h.roll,c.roll)||u.push({command:"setRoll",args:[c.roll]}),Gt(h.sprite,c.sprite)||u.push({command:"setSprite",args:[c.sprite]}),Gt(h.glyphs,c.glyphs)||u.push({command:"setGlyphs",args:[c.glyphs]}),Gt(h.transition,c.transition)||u.push({command:"setTransition",args:[c.transition]}),Gt(h.light,c.light)||u.push({command:"setLight",args:[c.light]}),Gt(h.terrain,c.terrain)||u.push({command:"setTerrain",args:[c.terrain]}),Gt(h.sky,c.sky)||u.push({command:"setSky",args:[c.sky]}),Gt(h.projection,c.projection)||u.push({command:"setProjection",args:[c.projection]});const x={},_=[];(function(A,M,F,q){let V;for(V in M=M||{},A=A||{})Object.prototype.hasOwnProperty.call(A,V)&&(Object.prototype.hasOwnProperty.call(M,V)||Cn(V,F,q));for(V in M)Object.prototype.hasOwnProperty.call(M,V)&&(Object.prototype.hasOwnProperty.call(A,V)?Gt(A[V],M[V])||(A[V].type==="geojson"&&M[V].type==="geojson"&&Mn(A,M,V)?yr(F,{command:"setGeoJSONSourceData",args:[V,M[V].data]}):Xn(V,M,F,q)):cn(V,M,F))})(h.sources,c.sources,_,x);const C=[];h.layers&&h.layers.forEach(A=>{"source"in A&&x[A.source]?u.push({command:"removeLayer",args:[A.id]}):C.push(A)}),u=u.concat(_),function(A,M,F){M=M||[];const q=(A=A||[]).map(An),V=M.map(An),K=A.reduce(vi,{}),ee=M.reduce(vi,{}),re=q.slice(),ae=Object.create(null);let pe,_e,Pe,Qe,Re;for(let $e=0,at=0;$e<q.length;$e++)pe=q[$e],Object.prototype.hasOwnProperty.call(ee,pe)?at++:(yr(F,{command:"removeLayer",args:[pe]}),re.splice(re.indexOf(pe,at),1));for(let $e=0,at=0;$e<V.length;$e++)pe=V[V.length-1-$e],re[re.length-1-$e]!==pe&&(Object.prototype.hasOwnProperty.call(K,pe)?(yr(F,{command:"removeLayer",args:[pe]}),re.splice(re.lastIndexOf(pe,re.length-at),1)):at++,Qe=re[re.length-$e],yr(F,{command:"addLayer",args:[ee[pe],Qe]}),re.splice(re.length-$e,0,pe),ae[pe]=!0);for(let $e=0;$e<V.length;$e++)if(pe=V[$e],_e=K[pe],Pe=ee[pe],!ae[pe]&&!Gt(_e,Pe))if(Gt(_e.source,Pe.source)&&Gt(_e["source-layer"],Pe["source-layer"])&&Gt(_e.type,Pe.type)){for(Re in On(_e.layout,Pe.layout,F,pe,null,"setLayoutProperty"),On(_e.paint,Pe.paint,F,pe,null,"setPaintProperty"),Gt(_e.filter,Pe.filter)||yr(F,{command:"setFilter",args:[pe,Pe.filter]}),Gt(_e.minzoom,Pe.minzoom)&&Gt(_e.maxzoom,Pe.maxzoom)||yr(F,{command:"setLayerZoomRange",args:[pe,Pe.minzoom,Pe.maxzoom]}),_e)Object.prototype.hasOwnProperty.call(_e,Re)&&Re!=="layout"&&Re!=="paint"&&Re!=="filter"&&Re!=="metadata"&&Re!=="minzoom"&&Re!=="maxzoom"&&(Re.indexOf("paint.")===0?On(_e[Re],Pe[Re],F,pe,Re.slice(6),"setPaintProperty"):Gt(_e[Re],Pe[Re])||yr(F,{command:"setLayerProperty",args:[pe,Re,Pe[Re]]}));for(Re in Pe)Object.prototype.hasOwnProperty.call(Pe,Re)&&!Object.prototype.hasOwnProperty.call(_e,Re)&&Re!=="layout"&&Re!=="paint"&&Re!=="filter"&&Re!=="metadata"&&Re!=="minzoom"&&Re!=="maxzoom"&&(Re.indexOf("paint.")===0?On(_e[Re],Pe[Re],F,pe,Re.slice(6),"setPaintProperty"):Gt(_e[Re],Pe[Re])||yr(F,{command:"setLayerProperty",args:[pe,Re,Pe[Re]]}))}else yr(F,{command:"removeLayer",args:[pe]}),Qe=re[re.lastIndexOf(pe)+1],yr(F,{command:"addLayer",args:[Pe,Qe]})}(C,c.layers,u)}catch(x){console.warn("Unable to compute style diff:",x),u=[{command:"setStyle",args:[c]}]}return u},d.bQ=function(h){const c=[],u=h.id;return u===void 0&&c.push({message:`layers.${u}: missing required property "id"`}),h.render===void 0&&c.push({message:`layers.${u}: missing required method "render"`}),h.renderingMode&&h.renderingMode!=="2d"&&h.renderingMode!=="3d"&&c.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),c},d.bR=Qt,d.bS=rr,d.bT=class extends Fa{constructor(h,c){super(h,c),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}},d.bU=$c,d.bV=class extends Fa{constructor(h,c){super(h,c),this.current=af}set(h){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let c=1;c<16;c++)if(h[c]!==this.current[c]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}},d.bW=ec,d.bX=class extends Fa{constructor(h,c){super(h,c),this.current=[0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2]))}},d.bY=class extends Fa{constructor(h,c){super(h,c),this.current=[0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1]))}},d.bZ=L,d.b_=function(h,c){var u=Math.sin(c),x=Math.cos(c);return h[0]=x,h[1]=u,h[2]=0,h[3]=-u,h[4]=x,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},d.ba=function(h,c,u){var x=Math.sin(u),_=Math.cos(u),C=c[4],A=c[5],M=c[6],F=c[7],q=c[8],V=c[9],K=c[10],ee=c[11];return c!==h&&(h[0]=c[0],h[1]=c[1],h[2]=c[2],h[3]=c[3],h[12]=c[12],h[13]=c[13],h[14]=c[14],h[15]=c[15]),h[4]=C*_+q*x,h[5]=A*_+V*x,h[6]=M*_+K*x,h[7]=F*_+ee*x,h[8]=q*_-C*x,h[9]=V*_-A*x,h[10]=K*_-M*x,h[11]=ee*_-F*x,h},d.bb=function(){const h=new Float32Array(16);return $(h),h},d.bc=function(){const h=new Float64Array(16);return $(h),h},d.bd=function(){return new Float64Array(16)},d.be=function(h,c,u){const x=new Float64Array(4);return Ue(x,h,c-90,u),x},d.bf=function(h,c,u,x){var _,C,A,M,F,q=c[0],V=c[1],K=c[2],ee=c[3],re=u[0],ae=u[1],pe=u[2],_e=u[3];return(C=q*re+V*ae+K*pe+ee*_e)<0&&(C=-C,re=-re,ae=-ae,pe=-pe,_e=-_e),1-C>T?(_=Math.acos(C),A=Math.sin(_),M=Math.sin((1-x)*_)/A,F=Math.sin(x*_)/A):(M=1-x,F=x),h[0]=M*q+F*re,h[1]=M*V+F*ae,h[2]=M*K+F*pe,h[3]=M*ee+F*_e,h},d.bg=function(h){const c=new Float64Array(9);var u,x,_,C,A,M,F,q,V,K,ee,re,ae,pe,_e,Pe,Qe,Re;K=(_=(x=h)[0])*(F=_+_),ee=(C=x[1])*F,ae=(A=x[2])*F,pe=A*(q=C+C),Pe=(M=x[3])*F,Qe=M*q,Re=M*(V=A+A),(u=c)[0]=1-(re=C*q)-(_e=A*V),u[3]=ee-Re,u[6]=ae+Qe,u[1]=ee+Re,u[4]=1-K-_e,u[7]=pe-Pe,u[2]=ae-Qe,u[5]=pe+Pe,u[8]=1-K-re;const $e=sr(-Math.asin(Pr(c[2],-1,1)));let at,ft;return Math.hypot(c[5],c[8])<.001?(at=0,ft=-sr(Math.atan2(c[3],c[4]))):(at=sr(c[5]===0&&c[8]===0?0:Math.atan2(c[5],c[8])),ft=sr(c[1]===0&&c[0]===0?0:Math.atan2(c[1],c[0]))),{roll:at,pitch:$e+90,bearing:ft}},d.bh=function(h,c){return h.roll==c.roll&&h.pitch==c.pitch&&h.bearing==c.bearing},d.bi=Ur,d.bj=wa,d.bk=fx,d.bl=o0,d.bm=mx,d.bn=gt,d.bo=Et,d.bp=Ja,d.bq=function(h,c,u,x,_){return gt(x,_,Pr((h-c)/(u-c),0,1))},d.br=vt,d.bs=function(){return new Float64Array(3)},d.bt=function(h,c,u,x){return h[0]=c[0]+u[0]*x,h[1]=c[1]+u[1]*x,h[2]=c[2]+u[2]*x,h},d.bu=Ue,d.bv=function(h,c,u){var x=u[0],_=u[1],C=u[2],A=u[3],M=c[0],F=c[1],q=c[2],V=_*q-C*F,K=C*M-x*q,ee=x*F-_*M;return h[0]=M+A*(V+=V)+_*(ee+=ee)-C*(K+=K),h[1]=F+A*K+C*V-x*ee,h[2]=q+A*ee+x*K-_*V,h},d.bw=function(h,c,u){const x=(_=[h[0],h[1],h[2],c[0],c[1],c[2],u[0],u[1],u[2]])[0]*((V=_[8])*(A=_[4])-(M=_[5])*(q=_[7]))+_[1]*(-V*(C=_[3])+M*(F=_[6]))+_[2]*(q*C-A*F);var _,C,A,M,F,q,V;if(x===0)return null;const K=ie([],[c[0],c[1],c[2]],[u[0],u[1],u[2]]),ee=ie([],[u[0],u[1],u[2]],[h[0],h[1],h[2]]),re=ie([],[h[0],h[1],h[2]],[c[0],c[1],c[2]]),ae=be([],K,-h[3]);return te(ae,ae,be([],ee,-c[3])),te(ae,ae,be([],re,-u[3])),be(ae,ae,1/x),ae},d.bx=RC,d.by=function(){return new Float64Array(4)},d.bz=function(h,c,u,x){var _=[],C=[];return _[0]=c[0]-u[0],_[1]=c[1]-u[1],_[2]=c[2]-u[2],C[0]=_[0]*Math.cos(x)-_[1]*Math.sin(x),C[1]=_[0]*Math.sin(x)+_[1]*Math.cos(x),C[2]=_[2],h[0]=C[0]+u[0],h[1]=C[1]+u[1],h[2]=C[2]+u[2],h},d.c=We,d.c0=function(h,c,u,x,_,C,A){var M=1/(c-u),F=1/(x-_),q=1/(C-A);return h[0]=-2*M,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=-2*F,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=2*q,h[11]=0,h[12]=(c+u)*M,h[13]=(_+x)*F,h[14]=(A+C)*q,h[15]=1,h},d.c1=class extends Fa{constructor(h,c){super(h,c),this.current=new Array}set(h){if(h!=this.current){this.current=h;const c=new Float32Array(4*h.length);for(let u=0;u<h.length;u++)c[4*u]=h[u].r,c[4*u+1]=h[u].g,c[4*u+2]=h[u].b,c[4*u+3]=h[u].a;this.gl.uniform4fv(this.location,c)}}},d.c2=class extends Fa{constructor(h,c){super(h,c),this.current=new Array}set(h){if(h!=this.current){this.current=h;const c=new Float32Array(h);this.gl.uniform1fv(this.location,c)}}},d.c3=class extends $d{},d.c4=lX,d.c5=class extends ax{},d.c6=gC,d.c7=function(h){return h<=1?1:Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))},d.c8=fD,d.c9=function(h,c,u){var x=c[0],_=c[1],C=c[2],A=u[3]*x+u[7]*_+u[11]*C+u[15];return h[0]=(u[0]*x+u[4]*_+u[8]*C+u[12])/(A=A||1),h[1]=(u[1]*x+u[5]*_+u[9]*C+u[13])/A,h[2]=(u[2]*x+u[6]*_+u[10]*C+u[14])/A,h},d.cB=function(h){return h.message===zs},d.cC=Ae,d.cD=function(h,c){le.REGISTERED_PROTOCOLS[h]=c},d.cE=function(h){delete le.REGISTERED_PROTOCOLS[h]},d.cF=function(h,c){const u={};for(let _=0;_<h.length;_++){const C=c&&c[h[_].id]||Vj(h[_]);c&&(c[h[_].id]=C);let A=u[C];A||(A=u[C]=[]),A.push(h[_])}const x=[];for(const _ in u)x.push(u[_]);return x},d.cG=er,d.cH=uR,d.cI=mR,d.cJ=VD,d.cK=function(h){h.bucket.createArrays(),h.bucket.tilePixelRatio=ve/(512*h.bucket.overscaling),h.bucket.compareText={},h.bucket.iconsNeedLinear=!1;const c=h.bucket.layers[0],u=c.layout,x=c._unevaluatedLayout._values,_={layoutIconSize:x["icon-size"].possiblyEvaluate(new Gn(h.bucket.zoom+1),h.canonical),layoutTextSize:x["text-size"].possiblyEvaluate(new Gn(h.bucket.zoom+1),h.canonical),textMaxSize:x["text-size"].possiblyEvaluate(new Gn(18))};if(h.bucket.textSizeData.kind==="composite"){const{minZoom:q,maxZoom:V}=h.bucket.textSizeData;_.compositeTextSizes=[x["text-size"].possiblyEvaluate(new Gn(q),h.canonical),x["text-size"].possiblyEvaluate(new Gn(V),h.canonical)]}if(h.bucket.iconSizeData.kind==="composite"){const{minZoom:q,maxZoom:V}=h.bucket.iconSizeData;_.compositeIconSizes=[x["icon-size"].possiblyEvaluate(new Gn(q),h.canonical),x["icon-size"].possiblyEvaluate(new Gn(V),h.canonical)]}const C=u.get("text-line-height")*Ti,A=u.get("text-rotation-alignment")!=="viewport"&&u.get("symbol-placement")!=="point",M=u.get("text-keep-upright"),F=u.get("text-size");for(const q of h.bucket.features){const V=u.get("text-font").evaluate(q,{},h.canonical).join(","),K=F.evaluate(q,{},h.canonical),ee=_.layoutTextSize.evaluate(q,{},h.canonical),re=_.layoutIconSize.evaluate(q,{},h.canonical),ae={horizontal:{},vertical:void 0},pe=q.text;let _e,Pe=[0,0];if(pe){const $e=pe.toString(),at=u.get("text-letter-spacing").evaluate(q,{},h.canonical)*Ti,ft=Vv($e)?at:0,At=u.get("text-anchor").evaluate(q,{},h.canonical),Yt=NR(c,q,h.canonical);if(!Yt){const Wt=u.get("text-radial-offset").evaluate(q,{},h.canonical);Pe=Wt?wR(At,[Wt*Ti,FC]):u.get("text-offset").evaluate(q,{},h.canonical).map(Ht=>Ht*Ti)}let zt=A?"center":u.get("text-justify").evaluate(q,{},h.canonical);const Kt=u.get("symbol-placement")==="point"?u.get("text-max-width").evaluate(q,{},h.canonical)*Ti:1/0,br=()=>{h.bucket.allowVerticalPlacement&&qv($e)&&(ae.vertical=Sw(pe,h.glyphMap,h.glyphPositions,h.imagePositions,V,Kt,C,At,"left",ft,Pe,d.as.vertical,!0,ee,K))};if(!A&&Yt){const Wt=new Set;if(zt==="auto")for(let _t=0;_t<Yt.values.length;_t+=2)Wt.add(zC(Yt.values[_t]));else Wt.add(zt);let Ht=!1;for(const _t of Wt)if(!ae.horizontal[_t])if(Ht)ae.horizontal[_t]=ae.horizontal[0];else{const Fr=Sw(pe,h.glyphMap,h.glyphPositions,h.imagePositions,V,Kt,C,"center",_t,ft,Pe,d.as.horizontal,!1,ee,K);Fr&&(ae.horizontal[_t]=Fr,Ht=Fr.positionedLines.length===1)}br()}else{zt==="auto"&&(zt=zC(At));const Wt=Sw(pe,h.glyphMap,h.glyphPositions,h.imagePositions,V,Kt,C,At,zt,ft,Pe,d.as.horizontal,!1,ee,K);Wt&&(ae.horizontal[zt]=Wt),br(),qv($e)&&A&&M&&(ae.vertical=Sw(pe,h.glyphMap,h.glyphPositions,h.imagePositions,V,Kt,C,At,zt,ft,Pe,d.as.vertical,!1,ee,K))}}let Qe=!1;if(q.icon&&q.icon.name){const $e=h.imageMap[q.icon.name];$e&&(_e=TX(h.imagePositions[q.icon.name],u.get("icon-offset").evaluate(q,{},h.canonical),u.get("icon-anchor").evaluate(q,{},h.canonical)),Qe=!!$e.sdf,h.bucket.sdfIcons===void 0?h.bucket.sdfIcons=Qe:h.bucket.sdfIcons!==Qe&&or("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),($e.pixelRatio!==h.bucket.pixelRatio||u.get("icon-rotate").constantOr(1)!==0)&&(h.bucket.iconsNeedLinear=!0))}const Re=PR(ae.horizontal)||ae.vertical;h.bucket.iconsInText=!!Re&&Re.iconsInText,(Re||_e)&&UX(h.bucket,q,ae,_e,h.imageMap,_,ee,re,Pe,Qe,h.canonical,h.subdivisionGranularity)}h.showCollisionBoxes&&h.bucket.generateCollisionDebugBuffers()},d.cL=jC,d.cM=NC,d.cN=SC,d.cO=kD,d.cP=CC,d.cQ=class{constructor(h){this._marks={start:[h.url,"start"].join("#"),end:[h.url,"end"].join("#"),measure:h.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let h=performance.getEntriesByName(this._marks.measure);return h.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),h=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),h}},d.cR=function(h,c,u,x,_){return a(this,void 0,void 0,function*(){if(D())try{return yield nt(h,c,u,x,_)}catch{}return function(C,A,M,F,q){const V=C.width,K=C.height;xt&&Ut||(xt=new OffscreenCanvas(V,K),Ut=xt.getContext("2d",{willReadFrequently:!0})),xt.width=V,xt.height=K,Ut.drawImage(C,0,0,V,K);const ee=Ut.getImageData(A,M,F,q);return Ut.clearRect(0,0,V,K),ee.data}(h,c,u,x,_)})},d.cS=gD,d.cT=p,d.cU=AD,d.cV=px,d.cW=Id,d.cX=function(h,c){const u=new Map;if(h!=null)if(h.type==="Feature")u.set(f0(h,c),h);else for(const x of h.features)u.set(f0(x,c),x);return u},d.cY=function(h,c){if(h==null)return!0;if(h.type==="Feature")return f0(h,c)!=null;if(h.type==="FeatureCollection"){const u=new Set;for(const x of h.features){const _=f0(x,c);if(_==null||u.has(_))return!1;u.add(_)}return!0}return!1},d.cZ=function(h,c,u){var x,_,C,A;if(c.removeAll&&h.clear(),c.remove)for(const M of c.remove)h.delete(M);if(c.add)for(const M of c.add){const F=f0(M,u);F!=null&&h.set(F,M)}if(c.update)for(const M of c.update){let F=h.get(M.id);if(F==null)continue;const q=!M.removeAllProperties&&(((x=M.removeProperties)===null||x===void 0?void 0:x.length)>0||((_=M.addOrUpdateProperties)===null||_===void 0?void 0:_.length)>0);if((M.newGeometry||M.removeAllProperties||q)&&(F=Object.assign({},F),h.set(M.id,F),q&&(F.properties=Object.assign({},F.properties))),M.newGeometry&&(F.geometry=M.newGeometry),M.removeAllProperties)F.properties={};else if(((C=M.removeProperties)===null||C===void 0?void 0:C.length)>0)for(const V of M.removeProperties)Object.prototype.hasOwnProperty.call(F.properties,V)&&delete F.properties[V];if(((A=M.addOrUpdateProperties)===null||A===void 0?void 0:A.length)>0)for(const{key:V,value:K}of M.addOrUpdateProperties)F.properties[V]=K}},d.c_=Xl,d.ca=class extends Zv{},d.cb=class extends b{},d.cc=function(h,c){return h[0]===c[0]&&h[1]===c[1]&&h[2]===c[2]&&h[3]===c[3]&&h[4]===c[4]&&h[5]===c[5]&&h[6]===c[6]&&h[7]===c[7]&&h[8]===c[8]&&h[9]===c[9]&&h[10]===c[10]&&h[11]===c[11]&&h[12]===c[12]&&h[13]===c[13]&&h[14]===c[14]&&h[15]===c[15]},d.cd=function(h,c){var u=h[0],x=h[1],_=h[2],C=h[3],A=h[4],M=h[5],F=h[6],q=h[7],V=h[8],K=h[9],ee=h[10],re=h[11],ae=h[12],pe=h[13],_e=h[14],Pe=h[15],Qe=c[0],Re=c[1],$e=c[2],at=c[3],ft=c[4],At=c[5],Yt=c[6],zt=c[7],Kt=c[8],br=c[9],Wt=c[10],Ht=c[11],_t=c[12],Fr=c[13],$r=c[14],Ar=c[15];return Math.abs(u-Qe)<=T*Math.max(1,Math.abs(u),Math.abs(Qe))&&Math.abs(x-Re)<=T*Math.max(1,Math.abs(x),Math.abs(Re))&&Math.abs(_-$e)<=T*Math.max(1,Math.abs(_),Math.abs($e))&&Math.abs(C-at)<=T*Math.max(1,Math.abs(C),Math.abs(at))&&Math.abs(A-ft)<=T*Math.max(1,Math.abs(A),Math.abs(ft))&&Math.abs(M-At)<=T*Math.max(1,Math.abs(M),Math.abs(At))&&Math.abs(F-Yt)<=T*Math.max(1,Math.abs(F),Math.abs(Yt))&&Math.abs(q-zt)<=T*Math.max(1,Math.abs(q),Math.abs(zt))&&Math.abs(V-Kt)<=T*Math.max(1,Math.abs(V),Math.abs(Kt))&&Math.abs(K-br)<=T*Math.max(1,Math.abs(K),Math.abs(br))&&Math.abs(ee-Wt)<=T*Math.max(1,Math.abs(ee),Math.abs(Wt))&&Math.abs(re-Ht)<=T*Math.max(1,Math.abs(re),Math.abs(Ht))&&Math.abs(ae-_t)<=T*Math.max(1,Math.abs(ae),Math.abs(_t))&&Math.abs(pe-Fr)<=T*Math.max(1,Math.abs(pe),Math.abs(Fr))&&Math.abs(_e-$r)<=T*Math.max(1,Math.abs(_e),Math.abs($r))&&Math.abs(Pe-Ar)<=T*Math.max(1,Math.abs(Pe),Math.abs(Ar))},d.ce=function(h,c){return h[0]=c[0],h[1]=c[1],h[2]=c[2],h[3]=c[3],h[4]=c[4],h[5]=c[5],h[6]=c[6],h[7]=c[7],h[8]=c[8],h[9]=c[9],h[10]=c[10],h[11]=c[11],h[12]=c[12],h[13]=c[13],h[14]=c[14],h[15]=c[15],h},d.cf=h=>h.type==="symbol",d.cg=h=>h.type==="circle",d.ch=h=>h.type==="heatmap",d.ci=h=>h.type==="line",d.cj=h=>h.type==="fill",d.ck=h=>h.type==="fill-extrusion",d.cl=h=>h.type==="hillshade",d.cm=h=>h.type==="color-relief",d.cn=h=>h.type==="background",d.co=h=>h.type==="custom",d.cp=tr,d.cq=function(h,c,u){const x=Ce(c.x-u.x,c.y-u.y),_=Ce(h.x-u.x,h.y-u.y);var C,A;return sr(Math.atan2(x[0]*_[1]-x[1]*_[0],(C=x)[0]*(A=_)[0]+C[1]*A[1]))},d.cr=Dr,d.cs=function(h,c){return Pn[c]&&(h instanceof MouseEvent||h instanceof WheelEvent)},d.ct=function(h,c){return tn[c]&&"touches"in h},d.cu=function(h){return tn[h]||Pn[h]},d.cv=function(h,c,u){var x=c[0],_=c[1];return h[0]=u[0]*x+u[4]*_+u[12],h[1]=u[1]*x+u[5]*_+u[13],h},d.cw=function(h,c){const{x:u,y:x}=m0.fromLngLat(c);return!(h<0||h>25||x<0||x>=1||u<0||u>=1)},d.cx=function(h,c){return h[0]=c[0],h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=c[1],h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=c[2],h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},d.cy=class extends rx{},d.cz=GX,d.d=st,d.e=_r,d.f=h=>a(void 0,void 0,void 0,function*(){if(h.byteLength===0)return createImageBitmap(new ImageData(1,1));const c=new Blob([new Uint8Array(h)],{type:"image/png"});try{return createImageBitmap(c)}catch(u){throw new Error(`Could not load image because of ${u.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),d.g=ue,d.h=h=>new Promise((c,u)=>{const x=new Image;x.onload=()=>{c(x),URL.revokeObjectURL(x.src),x.onload=null,window.requestAnimationFrame(()=>{x.src=qe})},x.onerror=()=>u(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const _=new Blob([new Uint8Array(h)],{type:"image/png"});x.src=h.byteLength?URL.createObjectURL(_):qe}),d.i=Lr,d.j=(h,c)=>Ye(_r(h,{type:"json"}),c),d.k=yt,d.l=Pt,d.m=Ye,d.n=(h,c)=>Ye(_r(h,{type:"arrayBuffer"}),c),d.o=function(h){return new CC(h).readFields(vX,[])},d.p=qD,d.q=r0,d.r=oa,d.s=Vt,d.t=Je,d.u=sn,d.v=Qj,d.w=or,d.x=cw,d.y=aC,d.z=ew}),i("worker",["./shared"],function(d){class a{constructor(le,ue){this.keyCache={},le&&this.replace(le,ue)}replace(le,ue){this._layerConfigs={},this._layers={},this.update(le,[],ue)}update(le,ue,ye){for(const ze of le){this._layerConfigs[ze.id]=ze;const Ye=this._layers[ze.id]=d.bM(ze,ye);Ye._featureFilter=d.ae(Ye.filter,ye),this.keyCache[ze.id]&&delete this.keyCache[ze.id]}for(const ze of ue)delete this.keyCache[ze],delete this._layerConfigs[ze],delete this._layers[ze];this.familiesBySource={};const Ae=d.cF(Object.values(this._layerConfigs),this.keyCache);for(const ze of Ae){const Ye=ze.map(lr=>this._layers[lr.id]),st=Ye[0];if(st.visibility==="none")continue;const He=st.source||"";let dt=this.familiesBySource[He];dt||(dt=this.familiesBySource[He]={});const Pt=st.sourceLayer||"_geojsonTileLayer";let yt=dt[Pt];yt||(yt=dt[Pt]=[]),yt.push(Ye)}}}class f{constructor(le){const ue={},ye=[];for(const st in le){const He=le[st],dt=ue[st]={};for(const Pt in He){const yt=He[+Pt];if(!yt||yt.bitmap.width===0||yt.bitmap.height===0)continue;const lr={x:0,y:0,w:yt.bitmap.width+2,h:yt.bitmap.height+2};ye.push(lr),dt[Pt]={rect:lr,metrics:yt.metrics}}}const{w:Ae,h:ze}=d.p(ye),Ye=new d.q({width:Ae||1,height:ze||1});for(const st in le){const He=le[st];for(const dt in He){const Pt=He[+dt];if(!Pt||Pt.bitmap.width===0||Pt.bitmap.height===0)continue;const yt=ue[st][dt].rect;d.q.copy(Pt.bitmap,Ye,{x:0,y:0},{x:yt.x+1,y:yt.y+1},Pt.bitmap)}}this.image=Ye,this.positions=ue}}d.cG("GlyphAtlas",f);class p{constructor(le){this.tileID=new d.a0(le.tileID.overscaledZ,le.tileID.wrap,le.tileID.canonical.z,le.tileID.canonical.x,le.tileID.canonical.y),this.uid=le.uid,this.zoom=le.zoom,this.pixelRatio=le.pixelRatio,this.tileSize=le.tileSize,this.source=le.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=le.showCollisionBoxes,this.collectResourceTiming=!!le.collectResourceTiming,this.returnDependencies=!!le.returnDependencies,this.promoteId=le.promoteId,this.inFlightDependencies=[]}parse(le,ue,ye,Ae,ze){return d._(this,void 0,void 0,function*(){this.status="parsing",this.data=le,this.collisionBoxArray=new d.ac;const Ye=new d.cH(Object.keys(le.layers).sort()),st=new d.cI(this.tileID,this.promoteId);st.bucketLayerIDs=[];const He={},dt={featureIndex:st,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:ye,subdivisionGranularity:ze},Pt=ue.familiesBySource[this.source];for(const jt in Pt){const $s=le.layers[jt];if(!$s)continue;$s.version===1&&d.w(`Vector tile source "${this.source}" layer "${jt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ya=Ye.encode(jt),zu=[];for(let qi=0;qi<$s.length;qi++){const qt=$s.feature(qi),Kr=st.getId(qt,jt);zu.push({feature:qt,id:Kr,index:qi,sourceLayerIndex:ya})}for(const qi of Pt[jt]){const qt=qi[0];qt.source!==this.source&&d.w(`layer.source = ${qt.source} does not equal this.source = ${this.source}`),qt.isHidden(this.zoom,!0)||(y(qi,this.zoom,ye),(He[qt.id]=qt.createBucket({index:st.bucketLayerIDs.length,layers:qi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ya,sourceID:this.source})).populate(zu,dt,this.tileID.canonical),st.bucketLayerIDs.push(qi.map(Kr=>Kr.id)))}}const yt=d.bR(dt.glyphDependencies,jt=>Object.keys(jt).map(Number));this.inFlightDependencies.forEach(jt=>jt==null?void 0:jt.abort()),this.inFlightDependencies=[];let lr=Promise.resolve({});if(Object.keys(yt).length){const jt=new AbortController;this.inFlightDependencies.push(jt),lr=Ae.sendAsync({type:"GG",data:{stacks:yt,source:this.source,tileID:this.tileID,type:"glyphs"}},jt)}const Je=Object.keys(dt.iconDependencies);let Qr=Promise.resolve({});if(Je.length){const jt=new AbortController;this.inFlightDependencies.push(jt),Qr=Ae.sendAsync({type:"GI",data:{icons:Je,source:this.source,tileID:this.tileID,type:"icons"}},jt)}const fr=Object.keys(dt.patternDependencies);let Gt=Promise.resolve({});if(fr.length){const jt=new AbortController;this.inFlightDependencies.push(jt),Gt=Ae.sendAsync({type:"GI",data:{icons:fr,source:this.source,tileID:this.tileID,type:"patterns"}},jt)}const yr=dt.dashDependencies;let cn=Promise.resolve({});if(Object.keys(yr).length){const jt=new AbortController;this.inFlightDependencies.push(jt),cn=Ae.sendAsync({type:"GDA",data:{dashes:yr}},jt)}const[Cn,Xn,Mn,On]=yield Promise.all([lr,Qr,Gt,cn]),An=new f(Cn),vi=new d.cJ(Xn,Mn);for(const jt in He){const $s=He[jt];$s instanceof d.ad?(y($s.layers,this.zoom,ye),d.cK({bucket:$s,glyphMap:Cn,glyphPositions:An.positions,imageMap:Xn,imagePositions:vi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:dt.subdivisionGranularity})):$s.hasDependencies&&($s instanceof d.cL||$s instanceof d.cM||$s instanceof d.cN)&&(y($s.layers,this.zoom,ye),$s.addFeatures(dt,this.tileID.canonical,vi.patternPositions,On))}return this.status="done",{buckets:Object.values(He).filter(jt=>!jt.isEmpty()),featureIndex:st,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:An.image,imageAtlas:vi,dashPositions:On,glyphMap:this.returnDependencies?Cn:null,iconMap:this.returnDependencies?Xn:null,glyphPositions:this.returnDependencies?An.positions:null}})}}function y(We,le,ue){const ye=new d.G(le);for(const Ae of We)Ae.recalculate(ye,ue)}class v{constructor(le,ue,ye){this.actor=le,this.layerIndex=ue,this.availableImages=ye,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(le,ue){return d._(this,void 0,void 0,function*(){const ye=yield d.n(le.request,ue);try{return{vectorTile:new d.cO(new d.cP(ye.data)),rawData:ye.data,cacheControl:ye.cacheControl,expires:ye.expires}}catch(Ae){const ze=new Uint8Array(ye.data);let Ye=`Unable to parse the tile at ${le.request.url}, `;throw Ye+=ze[0]===31&&ze[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Ae.message}`,new Error(Ye)}})}loadTile(le){return d._(this,void 0,void 0,function*(){const ue=le.uid,ye=!!(le&&le.request&&le.request.collectResourceTiming)&&new d.cQ(le.request),Ae=new p(le);this.loading[ue]=Ae;const ze=new AbortController;Ae.abort=ze;try{const Ye=yield this.loadVectorTile(le,ze);if(delete this.loading[ue],!Ye)return null;const st=Ye.rawData,He={};Ye.expires&&(He.expires=Ye.expires),Ye.cacheControl&&(He.cacheControl=Ye.cacheControl);const dt={};if(ye){const yt=ye.finish();yt&&(dt.resourceTiming=JSON.parse(JSON.stringify(yt)))}Ae.vectorTile=Ye.vectorTile;const Pt=Ae.parse(Ye.vectorTile,this.layerIndex,this.availableImages,this.actor,le.subdivisionGranularity);this.loaded[ue]=Ae,this.fetching[ue]={rawTileData:st,cacheControl:He,resourceTiming:dt};try{const yt=yield Pt;return d.e({rawTileData:st.slice(0)},yt,He,dt)}finally{delete this.fetching[ue]}}catch(Ye){throw delete this.loading[ue],Ae.status="done",this.loaded[ue]=Ae,Ye}})}reloadTile(le){return d._(this,void 0,void 0,function*(){const ue=le.uid;if(!this.loaded||!this.loaded[ue])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ye=this.loaded[ue];if(ye.showCollisionBoxes=le.showCollisionBoxes,ye.status==="parsing"){const Ae=yield ye.parse(ye.vectorTile,this.layerIndex,this.availableImages,this.actor,le.subdivisionGranularity);let ze;if(this.fetching[ue]){const{rawTileData:Ye,cacheControl:st,resourceTiming:He}=this.fetching[ue];delete this.fetching[ue],ze=d.e({rawTileData:Ye.slice(0)},Ae,st,He)}else ze=Ae;return ze}if(ye.status==="done"&&ye.vectorTile)return ye.parse(ye.vectorTile,this.layerIndex,this.availableImages,this.actor,le.subdivisionGranularity)})}abortTile(le){return d._(this,void 0,void 0,function*(){const ue=this.loading,ye=le.uid;ue&&ue[ye]&&ue[ye].abort&&(ue[ye].abort.abort(),delete ue[ye])})}removeTile(le){return d._(this,void 0,void 0,function*(){this.loaded&&this.loaded[le.uid]&&delete this.loaded[le.uid]})}}class j{constructor(){this.loaded={}}loadTile(le){return d._(this,void 0,void 0,function*(){const{uid:ue,encoding:ye,rawImageData:Ae,redFactor:ze,greenFactor:Ye,blueFactor:st,baseShift:He}=le,dt=Ae.width+2,Pt=Ae.height+2,yt=d.b(Ae)?new d.R({width:dt,height:Pt},yield d.cR(Ae,-1,-1,dt,Pt)):Ae,lr=new d.cS(ue,yt,ye,ze,Ye,st,He);return this.loaded=this.loaded||{},this.loaded[ue]=lr,lr})}removeTile(le){const ue=this.loaded,ye=le.uid;ue&&ue[ye]&&delete ue[ye]}}var w,k,S=function(){if(k)return w;function We(ue,ye){if(ue.length!==0){le(ue[0],ye);for(var Ae=1;Ae<ue.length;Ae++)le(ue[Ae],!ye)}}function le(ue,ye){for(var Ae=0,ze=0,Ye=0,st=ue.length,He=st-1;Ye<st;He=Ye++){var dt=(ue[Ye][0]-ue[He][0])*(ue[He][1]+ue[Ye][1]),Pt=Ae+dt;ze+=Math.abs(Ae)>=Math.abs(dt)?Ae-Pt+dt:dt-Pt+Ae,Ae=Pt}Ae+ze>=0!=!!ye&&ue.reverse()}return k=1,w=function ue(ye,Ae){var ze,Ye=ye&&ye.type;if(Ye==="FeatureCollection")for(ze=0;ze<ye.features.length;ze++)ue(ye.features[ze],Ae);else if(Ye==="GeometryCollection")for(ze=0;ze<ye.geometries.length;ze++)ue(ye.geometries[ze],Ae);else if(Ye==="Feature")ue(ye.geometry,Ae);else if(Ye==="Polygon")We(ye.coordinates,Ae);else if(Ye==="MultiPolygon")for(ze=0;ze<ye.coordinates.length;ze++)We(ye.coordinates[ze],Ae);return ye}}(),R=d.cT(S);class D extends d.cV{constructor(le,ue){super(new d.cP,0,ue,[],[]),this.feature=le,this.type=le.type,this.properties=le.tags?le.tags:{},"id"in le&&(typeof le.id=="string"?this.id=parseInt(le.id,10):typeof le.id!="number"||isNaN(le.id)||(this.id=le.id))}loadGeometry(){const le=[],ue=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const ye of ue){const Ae=[];for(const ze of ye)Ae.push(new d.P(ze[0],ze[1]));le.push(Ae)}return le}}class T extends d.cU{constructor(le,ue){super(new d.cP),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=ue?ue.version:1,this.extent=ue?ue.extent:4096,this.length=le.length,this.features=le}feature(le){return new D(this.features[le],this.extent)}}function I(We,le){le.writeVarintField(15,We.version||1),le.writeStringField(1,We.name||""),le.writeVarintField(5,We.extent||4096);const ue={keys:[],values:[],keycache:{},valuecache:{}};for(let ze=0;ze<We.length;ze++)ue.feature=We.feature(ze),le.writeMessage(2,L,ue);const ye=ue.keys;for(const ze of ye)le.writeStringField(3,ze);const Ae=ue.values;for(const ze of Ae)le.writeMessage(4,te,ze)}function L(We,le){if(!We.feature)return;const ue=We.feature;ue.id!==void 0&&le.writeVarintField(1,ue.id),le.writeMessage(2,$,We),le.writeVarintField(3,ue.type),le.writeMessage(4,oe,ue)}function $(We,le){var ue;for(const ye in(ue=We.feature)==null?void 0:ue.properties){let Ae=We.feature.properties[ye],ze=We.keycache[ye];if(Ae===null)continue;ze===void 0&&(We.keys.push(ye),ze=We.keys.length-1,We.keycache[ye]=ze),le.writeVarint(ze),typeof Ae!="string"&&typeof Ae!="boolean"&&typeof Ae!="number"&&(Ae=JSON.stringify(Ae));const Ye=typeof Ae+":"+Ae;let st=We.valuecache[Ye];st===void 0&&(We.values.push(Ae),st=We.values.length-1,We.valuecache[Ye]=st),le.writeVarint(st)}}function W(We,le){return(le<<3)+(7&We)}function Z(We){return We<<1^We>>31}function oe(We,le){const ue=We.loadGeometry(),ye=We.type;let Ae=0,ze=0;for(const Ye of ue){let st=1;ye===1&&(st=Ye.length),le.writeVarint(W(1,st));const He=ye===3?Ye.length-1:Ye.length;for(let dt=0;dt<He;dt++){dt===1&&ye!==1&&le.writeVarint(W(2,He-1));const Pt=Ye[dt].x-Ae,yt=Ye[dt].y-ze;le.writeVarint(Z(Pt)),le.writeVarint(Z(yt)),Ae+=Pt,ze+=yt}We.type===3&&le.writeVarint(W(7,1))}}function te(We,le){const ue=typeof We;ue==="string"?le.writeStringField(1,We):ue==="boolean"?le.writeBooleanField(7,We):ue==="number"&&(We%1!=0?le.writeDoubleField(3,We):We<0?le.writeSVarintField(6,We):le.writeVarintField(5,We))}const be={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:We=>We},ie=Math.fround||(ge=new Float32Array(1),We=>(ge[0]=+We,ge[0]));var ge;class Ie{constructor(le){this.options=Object.assign(Object.create(be),le),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(le){const{log:ue,minZoom:ye,maxZoom:Ae}=this.options;ue&&console.time("total time");const ze=`prepare ${le.length} points`;ue&&console.time(ze),this.points=le;const Ye=[];for(let He=0;He<le.length;He++){const dt=le[He];if(!dt.geometry)continue;const[Pt,yt]=dt.geometry.coordinates,lr=ie(Ue(Pt)),Je=ie(tt(yt));Ye.push(lr,Je,1/0,He,-1,1),this.options.reduce&&Ye.push(0)}let st=this.trees[Ae+1]=this._createTree(Ye);ue&&console.timeEnd(ze);for(let He=Ae;He>=ye;He--){const dt=+Date.now();st=this.trees[He]=this._createTree(this._cluster(st,He)),ue&&console.log("z%d: %d clusters in %dms",He,st.numItems,+Date.now()-dt)}return ue&&console.timeEnd("total time"),this}getClusters(le,ue){let ye=((le[0]+180)%360+360)%360-180;const Ae=Math.max(-90,Math.min(90,le[1]));let ze=le[2]===180?180:((le[2]+180)%360+360)%360-180;const Ye=Math.max(-90,Math.min(90,le[3]));if(le[2]-le[0]>=360)ye=-180,ze=180;else if(ye>ze){const yt=this.getClusters([ye,Ae,180,Ye],ue),lr=this.getClusters([-180,Ae,ze,Ye],ue);return yt.concat(lr)}const st=this.trees[this._limitZoom(ue)],He=st.range(Ue(ye),tt(Ye),Ue(ze),tt(Ae)),dt=st.data,Pt=[];for(const yt of He){const lr=this.stride*yt;Pt.push(dt[lr+5]>1?Oe(dt,lr,this.clusterProps):this.points[dt[lr+3]])}return Pt}getChildren(le){const ue=this._getOriginId(le),ye=this._getOriginZoom(le),Ae="No cluster with the specified id.",ze=this.trees[ye];if(!ze)throw new Error(Ae);const Ye=ze.data;if(ue*this.stride>=Ye.length)throw new Error(Ae);const st=this.options.radius/(this.options.extent*Math.pow(2,ye-1)),He=ze.within(Ye[ue*this.stride],Ye[ue*this.stride+1],st),dt=[];for(const Pt of He){const yt=Pt*this.stride;Ye[yt+4]===le&&dt.push(Ye[yt+5]>1?Oe(Ye,yt,this.clusterProps):this.points[Ye[yt+3]])}if(dt.length===0)throw new Error(Ae);return dt}getLeaves(le,ue,ye){const Ae=[];return this._appendLeaves(Ae,le,ue=ue||10,ye=ye||0,0),Ae}getTile(le,ue,ye){const Ae=this.trees[this._limitZoom(le)],ze=Math.pow(2,le),{extent:Ye,radius:st}=this.options,He=st/Ye,dt=(ye-He)/ze,Pt=(ye+1+He)/ze,yt={features:[]};return this._addTileFeatures(Ae.range((ue-He)/ze,dt,(ue+1+He)/ze,Pt),Ae.data,ue,ye,ze,yt),ue===0&&this._addTileFeatures(Ae.range(1-He/ze,dt,1,Pt),Ae.data,ze,ye,ze,yt),ue===ze-1&&this._addTileFeatures(Ae.range(0,dt,He/ze,Pt),Ae.data,-1,ye,ze,yt),yt.features.length?yt:null}getClusterExpansionZoom(le){let ue=this._getOriginZoom(le)-1;for(;ue<=this.options.maxZoom;){const ye=this.getChildren(le);if(ue++,ye.length!==1)break;le=ye[0].properties.cluster_id}return ue}_appendLeaves(le,ue,ye,Ae,ze){const Ye=this.getChildren(ue);for(const st of Ye){const He=st.properties;if(He&&He.cluster?ze+He.point_count<=Ae?ze+=He.point_count:ze=this._appendLeaves(le,He.cluster_id,ye,Ae,ze):ze<Ae?ze++:le.push(st),le.length===ye)break}return ze}_createTree(le){const ue=new d.aM(le.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ye=0;ye<le.length;ye+=this.stride)ue.add(le[ye],le[ye+1]);return ue.finish(),ue.data=le,ue}_addTileFeatures(le,ue,ye,Ae,ze,Ye){for(const st of le){const He=st*this.stride,dt=ue[He+5]>1;let Pt,yt,lr;if(dt)Pt=Xe(ue,He,this.clusterProps),yt=ue[He],lr=ue[He+1];else{const fr=this.points[ue[He+3]];Pt=fr.properties;const[Gt,yr]=fr.geometry.coordinates;yt=Ue(Gt),lr=tt(yr)}const Je={type:1,geometry:[[Math.round(this.options.extent*(yt*ze-ye)),Math.round(this.options.extent*(lr*ze-Ae))]],tags:Pt};let Qr;Qr=dt||this.options.generateId?ue[He+3]:this.points[ue[He+3]].id,Qr!==void 0&&(Je.id=Qr),Ye.features.push(Je)}}_limitZoom(le){return Math.max(this.options.minZoom,Math.min(Math.floor(+le),this.options.maxZoom+1))}_cluster(le,ue){const{radius:ye,extent:Ae,reduce:ze,minPoints:Ye}=this.options,st=ye/(Ae*Math.pow(2,ue)),He=le.data,dt=[],Pt=this.stride;for(let yt=0;yt<He.length;yt+=Pt){if(He[yt+2]<=ue)continue;He[yt+2]=ue;const lr=He[yt],Je=He[yt+1],Qr=le.within(He[yt],He[yt+1],st),fr=He[yt+5];let Gt=fr;for(const yr of Qr){const cn=yr*Pt;He[cn+2]>ue&&(Gt+=He[cn+5])}if(Gt>fr&&Gt>=Ye){let yr,cn=lr*fr,Cn=Je*fr,Xn=-1;const Mn=(yt/Pt<<5)+(ue+1)+this.points.length;for(const On of Qr){const An=On*Pt;if(He[An+2]<=ue)continue;He[An+2]=ue;const vi=He[An+5];cn+=He[An]*vi,Cn+=He[An+1]*vi,He[An+4]=Mn,ze&&(yr||(yr=this._map(He,yt,!0),Xn=this.clusterProps.length,this.clusterProps.push(yr)),ze(yr,this._map(He,An)))}He[yt+4]=Mn,dt.push(cn/Gt,Cn/Gt,1/0,Mn,-1,Gt),ze&&dt.push(Xn)}else{for(let yr=0;yr<Pt;yr++)dt.push(He[yt+yr]);if(Gt>1)for(const yr of Qr){const cn=yr*Pt;if(!(He[cn+2]<=ue)){He[cn+2]=ue;for(let Cn=0;Cn<Pt;Cn++)dt.push(He[cn+Cn])}}}}return dt}_getOriginId(le){return le-this.points.length>>5}_getOriginZoom(le){return(le-this.points.length)%32}_map(le,ue,ye){if(le[ue+5]>1){const Ye=this.clusterProps[le[ue+6]];return ye?Object.assign({},Ye):Ye}const Ae=this.points[le[ue+3]].properties,ze=this.options.map(Ae);return ye&&ze===Ae?Object.assign({},ze):ze}}function Oe(We,le,ue){return{type:"Feature",id:We[le+3],properties:Xe(We,le,ue),geometry:{type:"Point",coordinates:[(ye=We[le],360*(ye-.5)),Ce(We[le+1])]}};var ye}function Xe(We,le,ue){const ye=We[le+5],Ae=ye>=1e4?`${Math.round(ye/1e3)}k`:ye>=1e3?Math.round(ye/100)/10+"k":ye,ze=We[le+6],Ye=ze===-1?{}:Object.assign({},ue[ze]);return Object.assign(Ye,{cluster:!0,cluster_id:We[le+3],point_count:ye,point_count_abbreviated:Ae})}function Ue(We){return We/360+.5}function tt(We){const le=Math.sin(We*Math.PI/180),ue=.5-.25*Math.log((1+le)/(1-le))/Math.PI;return ue<0?0:ue>1?1:ue}function Ce(We){const le=(180-360*We)*Math.PI/180;return 360*Math.atan(Math.exp(le))/Math.PI-90}function ve(We,le,ue,ye){let Ae=ye;const ze=le+(ue-le>>1);let Ye,st=ue-le;const He=We[le],dt=We[le+1],Pt=We[ue],yt=We[ue+1];for(let lr=le+3;lr<ue;lr+=3){const Je=rt(We[lr],We[lr+1],He,dt,Pt,yt);if(Je>Ae)Ye=lr,Ae=Je;else if(Je===Ae){const Qr=Math.abs(lr-ze);Qr<st&&(Ye=lr,st=Qr)}}Ae>ye&&(Ye-le>3&&ve(We,le,Ye,ye),We[Ye+2]=Ae,ue-Ye>3&&ve(We,Ye,ue,ye))}function rt(We,le,ue,ye,Ae,ze){let Ye=Ae-ue,st=ze-ye;if(Ye!==0||st!==0){const He=((We-ue)*Ye+(le-ye)*st)/(Ye*Ye+st*st);He>1?(ue=Ae,ye=ze):He>0&&(ue+=Ye*He,ye+=st*He)}return Ye=We-ue,st=le-ye,Ye*Ye+st*st}function vt(We,le,ue,ye){const Ae={id:We??null,type:le,geometry:ue,tags:ye,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(le==="Point"||le==="MultiPoint"||le==="LineString")gt(Ae,ue);else if(le==="Polygon")gt(Ae,ue[0]);else if(le==="MultiLineString")for(const ze of ue)gt(Ae,ze);else if(le==="MultiPolygon")for(const ze of ue)gt(Ae,ze[0]);return Ae}function gt(We,le){for(let ue=0;ue<le.length;ue+=3)We.minX=Math.min(We.minX,le[ue]),We.minY=Math.min(We.minY,le[ue+1]),We.maxX=Math.max(We.maxX,le[ue]),We.maxY=Math.max(We.maxY,le[ue+1])}function Et(We,le,ue,ye){if(!le.geometry)return;const Ae=le.geometry.coordinates;if(Ae&&Ae.length===0)return;const ze=le.geometry.type,Ye=Math.pow(ue.tolerance/((1<<ue.maxZoom)*ue.extent),2);let st=[],He=le.id;if(ue.promoteId?He=le.properties[ue.promoteId]:ue.generateId&&(He=ye||0),ze==="Point")tr(Ae,st);else if(ze==="MultiPoint")for(const dt of Ae)tr(dt,st);else if(ze==="LineString")Dr(Ae,st,Ye,!1);else if(ze==="MultiLineString"){if(ue.lineMetrics){for(const dt of Ae)st=[],Dr(dt,st,Ye,!1),We.push(vt(He,"LineString",st,le.properties));return}Pr(Ae,st,Ye,!1)}else if(ze==="Polygon")Pr(Ae,st,Ye,!0);else{if(ze!=="MultiPolygon"){if(ze==="GeometryCollection"){for(const dt of le.geometry.geometries)Et(We,{id:He,geometry:dt,properties:le.properties},ue,ye);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const dt of Ae){const Pt=[];Pr(dt,Pt,Ye,!0),st.push(Pt)}}We.push(vt(He,ze,st,le.properties))}function tr(We,le){le.push(It(We[0]),_r(We[1]),0)}function Dr(We,le,ue,ye){let Ae,ze,Ye=0;for(let He=0;He<We.length;He++){const dt=It(We[He][0]),Pt=_r(We[He][1]);le.push(dt,Pt,0),He>0&&(Ye+=ye?(Ae*Pt-dt*ze)/2:Math.sqrt(Math.pow(dt-Ae,2)+Math.pow(Pt-ze,2))),Ae=dt,ze=Pt}const st=le.length-3;le[2]=1,ve(le,0,st,ue),le[st+2]=1,le.size=Math.abs(Ye),le.start=0,le.end=le.size}function Pr(We,le,ue,ye){for(let Ae=0;Ae<We.length;Ae++){const ze=[];Dr(We[Ae],ze,ue,ye),le.push(ze)}}function It(We){return We/360+.5}function _r(We){const le=Math.sin(We*Math.PI/180),ue=.5-.25*Math.log((1+le)/(1-le))/Math.PI;return ue<0?0:ue>1?1:ue}function St(We,le,ue,ye,Ae,ze,Ye,st){if(ye/=le,ze>=(ue/=le)&&Ye<ye)return We;if(Ye<ue||ze>=ye)return null;const He=[];for(const dt of We){const Pt=dt.geometry;let yt=dt.type;const lr=Ae===0?dt.minX:dt.minY,Je=Ae===0?dt.maxX:dt.maxY;if(lr>=ue&&Je<ye){He.push(dt);continue}if(Je<ue||lr>=ye)continue;let Qr=[];if(yt==="Point"||yt==="MultiPoint")Qt(Pt,Qr,ue,ye,Ae);else if(yt==="LineString")rr(Pt,Qr,ue,ye,Ae,!1,st.lineMetrics);else if(yt==="MultiLineString")qr(Pt,Qr,ue,ye,Ae,!1);else if(yt==="Polygon")qr(Pt,Qr,ue,ye,Ae,!0);else if(yt==="MultiPolygon")for(const fr of Pt){const Gt=[];qr(fr,Gt,ue,ye,Ae,!0),Gt.length&&Qr.push(Gt)}if(Qr.length){if(st.lineMetrics&&yt==="LineString"){for(const fr of Qr)He.push(vt(dt.id,yt,fr,dt.tags));continue}yt!=="LineString"&&yt!=="MultiLineString"||(Qr.length===1?(yt="LineString",Qr=Qr[0]):yt="MultiLineString"),yt!=="Point"&&yt!=="MultiPoint"||(yt=Qr.length===3?"Point":"MultiPoint"),He.push(vt(dt.id,yt,Qr,dt.tags))}}return He.length?He:null}function Qt(We,le,ue,ye,Ae){for(let ze=0;ze<We.length;ze+=3){const Ye=We[ze+Ae];Ye>=ue&&Ye<=ye&&or(le,We[ze],We[ze+1],We[ze+2])}}function rr(We,le,ue,ye,Ae,ze,Ye){let st=pt(We);const He=Ae===0?en:Lr;let dt,Pt,yt=We.start;for(let Gt=0;Gt<We.length-3;Gt+=3){const yr=We[Gt],cn=We[Gt+1],Cn=We[Gt+2],Xn=We[Gt+3],Mn=We[Gt+4],On=Ae===0?yr:cn,An=Ae===0?Xn:Mn;let vi=!1;Ye&&(dt=Math.sqrt(Math.pow(yr-Xn,2)+Math.pow(cn-Mn,2))),On<ue?An>ue&&(Pt=He(st,yr,cn,Xn,Mn,ue),Ye&&(st.start=yt+dt*Pt)):On>ye?An<ye&&(Pt=He(st,yr,cn,Xn,Mn,ye),Ye&&(st.start=yt+dt*Pt)):or(st,yr,cn,Cn),An<ue&&On>=ue&&(Pt=He(st,yr,cn,Xn,Mn,ue),vi=!0),An>ye&&On<=ye&&(Pt=He(st,yr,cn,Xn,Mn,ye),vi=!0),!ze&&vi&&(Ye&&(st.end=yt+dt*Pt),le.push(st),st=pt(We)),Ye&&(yt+=dt)}let lr=We.length-3;const Je=We[lr],Qr=We[lr+1],fr=Ae===0?Je:Qr;fr>=ue&&fr<=ye&&or(st,Je,Qr,We[lr+2]),lr=st.length-3,ze&&lr>=3&&(st[lr]!==st[0]||st[lr+1]!==st[1])&&or(st,st[0],st[1],st[2]),st.length&&le.push(st)}function pt(We){const le=[];return le.size=We.size,le.start=We.start,le.end=We.end,le}function qr(We,le,ue,ye,Ae,ze){for(const Ye of We)rr(Ye,le,ue,ye,Ae,ze,!1)}function or(We,le,ue,ye){We.push(le,ue,ye)}function en(We,le,ue,ye,Ae,ze){const Ye=(ze-le)/(ye-le);return or(We,ze,ue+(Ae-ue)*Ye,1),Ye}function Lr(We,le,ue,ye,Ae,ze){const Ye=(ze-ue)/(Ae-ue);return or(We,le+(ye-le)*Ye,ze,1),Ye}function En(We,le){const ue=[];for(let ye=0;ye<We.length;ye++){const Ae=We[ye],ze=Ae.type;let Ye;if(ze==="Point"||ze==="MultiPoint"||ze==="LineString")Ye=ks(Ae.geometry,le);else if(ze==="MultiLineString"||ze==="Polygon"){Ye=[];for(const st of Ae.geometry)Ye.push(ks(st,le))}else if(ze==="MultiPolygon"){Ye=[];for(const st of Ae.geometry){const He=[];for(const dt of st)He.push(ks(dt,le));Ye.push(He)}}ue.push(vt(Ae.id,ze,Ye,Ae.tags))}return ue}function ks(We,le){const ue=[];ue.size=We.size,We.start!==void 0&&(ue.start=We.start,ue.end=We.end);for(let ye=0;ye<We.length;ye+=3)ue.push(We[ye]+le,We[ye+1],We[ye+2]);return ue}function Yn(We,le){if(We.transformed)return We;const ue=1<<We.z,ye=We.x,Ae=We.y;for(const ze of We.features){const Ye=ze.geometry,st=ze.type;if(ze.geometry=[],st===1)for(let He=0;He<Ye.length;He+=2)ze.geometry.push(qe(Ye[He],Ye[He+1],le,ue,ye,Ae));else for(let He=0;He<Ye.length;He++){const dt=[];for(let Pt=0;Pt<Ye[He].length;Pt+=2)dt.push(qe(Ye[He][Pt],Ye[He][Pt+1],le,ue,ye,Ae));ze.geometry.push(dt)}}return We.transformed=!0,We}function qe(We,le,ue,ye,Ae,ze){return[Math.round(ue*(We*ye-Ae)),Math.round(ue*(le*ye-ze))]}function nt(We,le,ue,ye,Ae){const ze=le===Ae.maxZoom?0:Ae.tolerance/((1<<le)*Ae.extent),Ye={features:[],numPoints:0,numSimplified:0,numFeatures:We.length,source:null,x:ue,y:ye,z:le,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const st of We)xt(Ye,st,ze,Ae);return Ye}function xt(We,le,ue,ye){const Ae=le.geometry,ze=le.type,Ye=[];if(We.minX=Math.min(We.minX,le.minX),We.minY=Math.min(We.minY,le.minY),We.maxX=Math.max(We.maxX,le.maxX),We.maxY=Math.max(We.maxY,le.maxY),ze==="Point"||ze==="MultiPoint")for(let st=0;st<Ae.length;st+=3)Ye.push(Ae[st],Ae[st+1]),We.numPoints++,We.numSimplified++;else if(ze==="LineString")Ut(Ye,Ae,We,ue,!1,!1);else if(ze==="MultiLineString"||ze==="Polygon")for(let st=0;st<Ae.length;st++)Ut(Ye,Ae[st],We,ue,ze==="Polygon",st===0);else if(ze==="MultiPolygon")for(let st=0;st<Ae.length;st++){const He=Ae[st];for(let dt=0;dt<He.length;dt++)Ut(Ye,He[dt],We,ue,!0,dt===0)}if(Ye.length){let st=le.tags||null;if(ze==="LineString"&&ye.lineMetrics){st={};for(const dt in le.tags)st[dt]=le.tags[dt];st.mapbox_clip_start=Ae.start/Ae.size,st.mapbox_clip_end=Ae.end/Ae.size}const He={geometry:Ye,type:ze==="Polygon"||ze==="MultiPolygon"?3:ze==="LineString"||ze==="MultiLineString"?2:1,tags:st};le.id!==null&&(He.id=le.id),We.features.push(He)}}function Ut(We,le,ue,ye,Ae,ze){const Ye=ye*ye;if(ye>0&&le.size<(Ae?Ye:ye))return void(ue.numPoints+=le.length/3);const st=[];for(let He=0;He<le.length;He+=3)(ye===0||le[He+2]>Ye)&&(ue.numSimplified++,st.push(le[He],le[He+1])),ue.numPoints++;Ae&&function(He,dt){let Pt=0;for(let yt=0,lr=He.length,Je=lr-2;yt<lr;Je=yt,yt+=2)Pt+=(He[yt]-He[Je])*(He[yt+1]+He[Je+1]);if(Pt>0===dt)for(let yt=0,lr=He.length;yt<lr/2;yt+=2){const Je=He[yt],Qr=He[yt+1];He[yt]=He[lr-2-yt],He[yt+1]=He[lr-1-yt],He[lr-2-yt]=Je,He[lr-1-yt]=Qr}}(st,ze),We.push(st)}const Vt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ft{constructor(le,ue){const ye=(ue=this.options=function(ze,Ye){for(const st in Ye)ze[st]=Ye[st];return ze}(Object.create(Vt),ue)).debug;if(ye&&console.time("preprocess data"),ue.maxZoom<0||ue.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ue.promoteId&&ue.generateId)throw new Error("promoteId and generateId cannot be used together.");let Ae=function(ze,Ye){const st=[];if(ze.type==="FeatureCollection")for(let He=0;He<ze.features.length;He++)Et(st,ze.features[He],Ye,He);else Et(st,ze.type==="Feature"?ze:{geometry:ze},Ye);return st}(le,ue);this.tiles={},this.tileCoords=[],ye&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ue.indexMaxZoom,ue.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ae=function(ze,Ye){const st=Ye.buffer/Ye.extent;let He=ze;const dt=St(ze,1,-1-st,st,0,-1,2,Ye),Pt=St(ze,1,1-st,2+st,0,-1,2,Ye);return(dt||Pt)&&(He=St(ze,1,-st,1+st,0,-1,2,Ye)||[],dt&&(He=En(dt,1).concat(He)),Pt&&(He=He.concat(En(Pt,-1)))),He}(Ae,ue),Ae.length&&this.splitTile(Ae,0,0,0),ye&&(Ae.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(le,ue,ye,Ae,ze,Ye,st){const He=[le,ue,ye,Ae],dt=this.options,Pt=dt.debug;for(;He.length;){Ae=He.pop(),ye=He.pop(),ue=He.pop(),le=He.pop();const yt=1<<ue,lr=sr(ue,ye,Ae);let Je=this.tiles[lr];if(!Je&&(Pt>1&&console.time("creation"),Je=this.tiles[lr]=nt(le,ue,ye,Ae,dt),this.tileCoords.push({z:ue,x:ye,y:Ae}),Pt)){Pt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ue,ye,Ae,Je.numFeatures,Je.numPoints,Je.numSimplified),console.timeEnd("creation"));const vi=`z${ue}`;this.stats[vi]=(this.stats[vi]||0)+1,this.total++}if(Je.source=le,ze==null){if(ue===dt.indexMaxZoom||Je.numPoints<=dt.indexMaxPoints)continue}else{if(ue===dt.maxZoom||ue===ze)continue;if(ze!=null){const vi=ze-ue;if(ye!==Ye>>vi||Ae!==st>>vi)continue}}if(Je.source=null,le.length===0)continue;Pt>1&&console.time("clipping");const Qr=.5*dt.buffer/dt.extent,fr=.5-Qr,Gt=.5+Qr,yr=1+Qr;let cn=null,Cn=null,Xn=null,Mn=null,On=St(le,yt,ye-Qr,ye+Gt,0,Je.minX,Je.maxX,dt),An=St(le,yt,ye+fr,ye+yr,0,Je.minX,Je.maxX,dt);le=null,On&&(cn=St(On,yt,Ae-Qr,Ae+Gt,1,Je.minY,Je.maxY,dt),Cn=St(On,yt,Ae+fr,Ae+yr,1,Je.minY,Je.maxY,dt),On=null),An&&(Xn=St(An,yt,Ae-Qr,Ae+Gt,1,Je.minY,Je.maxY,dt),Mn=St(An,yt,Ae+fr,Ae+yr,1,Je.minY,Je.maxY,dt),An=null),Pt>1&&console.timeEnd("clipping"),He.push(cn||[],ue+1,2*ye,2*Ae),He.push(Cn||[],ue+1,2*ye,2*Ae+1),He.push(Xn||[],ue+1,2*ye+1,2*Ae),He.push(Mn||[],ue+1,2*ye+1,2*Ae+1)}}getTile(le,ue,ye){le=+le,ue=+ue,ye=+ye;const Ae=this.options,{extent:ze,debug:Ye}=Ae;if(le<0||le>24)return null;const st=1<<le,He=sr(le,ue=ue+st&st-1,ye);if(this.tiles[He])return Yn(this.tiles[He],ze);Ye>1&&console.log("drilling down to z%d-%d-%d",le,ue,ye);let dt,Pt=le,yt=ue,lr=ye;for(;!dt&&Pt>0;)Pt--,yt>>=1,lr>>=1,dt=this.tiles[sr(Pt,yt,lr)];return dt&&dt.source?(Ye>1&&(console.log("found parent tile z%d-%d-%d",Pt,yt,lr),console.time("drilling down")),this.splitTile(dt.source,Pt,yt,lr,le,ue,ye),Ye>1&&console.timeEnd("drilling down"),this.tiles[He]?Yn(this.tiles[He],ze):null):null}}function sr(We,le,ue){return 32*((1<<We)*ue+le)+We}class tn extends v{constructor(le,ue,ye,Ae=Pn){super(le,ue,ye),this._dataUpdateable=new Map,this._createGeoJSONIndex=Ae}loadVectorTile(le,ue){return d._(this,void 0,void 0,function*(){const ye=le.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Ae=this._geoJSONIndex.getTile(ye.z,ye.x,ye.y);if(!Ae)return null;const ze=new T(Ae.features,{version:2,extent:d.a3});let Ye=function(st){const He=new d.cP;return function(dt,Pt){for(const yt in dt.layers)Pt.writeMessage(3,I,dt.layers[yt])}(st,He),He.finish()}(ze);return Ye.byteOffset===0&&Ye.byteLength===Ye.buffer.byteLength||(Ye=new Uint8Array(Ye)),{vectorTile:ze,rawData:Ye.buffer}})}loadData(le){return d._(this,void 0,void 0,function*(){var ue;(ue=this._pendingRequest)===null||ue===void 0||ue.abort();const ye=!!(le&&le.request&&le.request.collectResourceTiming)&&new d.cQ(le.request);this._pendingRequest=new AbortController;try{(!this._pendingData||le.request||le.data||le.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(le,this._pendingRequest));const Ae=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(Ae,le),this.loaded={};const ze={data:Ae};if(ye){const Ye=ye.finish();Ye&&(ze.resourceTiming={},ze.resourceTiming[le.source]=JSON.parse(JSON.stringify(Ye)))}return ze}catch(Ae){if(delete this._pendingRequest,d.cB(Ae))return{abandoned:!0};throw Ae}})}getData(){return d._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(le){const ue=this.loaded;return ue&&ue[le.uid]?super.reloadTile(le):this.loadTile(le)}loadAndProcessGeoJSON(le,ue){return d._(this,void 0,void 0,function*(){let ye=yield this.loadGeoJSON(le,ue);if(delete this._pendingRequest,typeof ye!="object")throw new Error(`Input data given to '${le.source}' is not a valid GeoJSON object.`);if(R(ye,!0),le.filter){const Ae=d.cW(le.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ae.result==="error")throw new Error(Ae.value.map(Ye=>`${Ye.key}: ${Ye.message}`).join(", "));ye={type:"FeatureCollection",features:ye.features.filter(Ye=>Ae.value.evaluate({zoom:0},Ye))}}return ye})}loadGeoJSON(le,ue){return d._(this,void 0,void 0,function*(){const{promoteId:ye}=le;if(le.request){const Ae=yield d.j(le.request,ue);return this._dataUpdateable=d.cY(Ae.data,ye)?d.cX(Ae.data,ye):void 0,Ae.data}if(typeof le.data=="string")try{const Ae=JSON.parse(le.data);return this._dataUpdateable=d.cY(Ae,ye)?d.cX(Ae,ye):void 0,Ae}catch{throw new Error(`Input data given to '${le.source}' is not a valid GeoJSON object.`)}if(!le.dataDiff)throw new Error(`Input data given to '${le.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${le.source}`);return d.cZ(this._dataUpdateable,le.dataDiff,ye),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(le){return d._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(le){return this._geoJSONIndex.getClusterExpansionZoom(le.clusterId)}getClusterChildren(le){return this._geoJSONIndex.getChildren(le.clusterId)}getClusterLeaves(le){return this._geoJSONIndex.getLeaves(le.clusterId,le.limit,le.offset)}}function Pn(We,le){return le.cluster?new Ie(function({superclusterOptions:ue,clusterProperties:ye}){if(!ye||!ue)return ue;const Ae={},ze={},Ye={accumulated:null,zoom:0},st={properties:null},He=Object.keys(ye);for(const dt of He){const[Pt,yt]=ye[dt],lr=d.cW(yt),Je=d.cW(typeof Pt=="string"?[Pt,["accumulated"],["get",dt]]:Pt);Ae[dt]=lr.value,ze[dt]=Je.value}return ue.map=dt=>{st.properties=dt;const Pt={};for(const yt of He)Pt[yt]=Ae[yt].evaluate(Ye,st);return Pt},ue.reduce=(dt,Pt)=>{st.properties=Pt;for(const yt of He)Ye.accumulated=dt[yt],dt[yt]=ze[yt].evaluate(Ye,st)},ue}(le)).load(We.features):function(ue,ye){return new Ft(ue,ye)}(We,le.geojsonVtOptions)}class zs{constructor(le){this.self=le,this.actor=new d.K(le),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(ue,ye)=>{if(this.externalWorkerSourceTypes[ue])throw new Error(`Worker source with name "${ue}" already registered.`);this.externalWorkerSourceTypes[ue]=ye},this.self.addProtocol=d.cD,this.self.removeProtocol=d.cE,this.self.registerRTLTextPlugin=ue=>{d.c_.setMethods(ue)},this.actor.registerMessageHandler("LDT",(ue,ye)=>this._getDEMWorkerSource(ue,ye.source).loadTile(ye)),this.actor.registerMessageHandler("RDT",(ue,ye)=>d._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ue,ye.source).removeTile(ye)})),this.actor.registerMessageHandler("GCEZ",(ue,ye)=>d._(this,void 0,void 0,function*(){return this._getWorkerSource(ue,ye.type,ye.source).getClusterExpansionZoom(ye)})),this.actor.registerMessageHandler("GCC",(ue,ye)=>d._(this,void 0,void 0,function*(){return this._getWorkerSource(ue,ye.type,ye.source).getClusterChildren(ye)})),this.actor.registerMessageHandler("GCL",(ue,ye)=>d._(this,void 0,void 0,function*(){return this._getWorkerSource(ue,ye.type,ye.source).getClusterLeaves(ye)})),this.actor.registerMessageHandler("LD",(ue,ye)=>this._getWorkerSource(ue,ye.type,ye.source).loadData(ye)),this.actor.registerMessageHandler("GD",(ue,ye)=>this._getWorkerSource(ue,ye.type,ye.source).getData()),this.actor.registerMessageHandler("LT",(ue,ye)=>this._getWorkerSource(ue,ye.type,ye.source).loadTile(ye)),this.actor.registerMessageHandler("RT",(ue,ye)=>this._getWorkerSource(ue,ye.type,ye.source).reloadTile(ye)),this.actor.registerMessageHandler("AT",(ue,ye)=>this._getWorkerSource(ue,ye.type,ye.source).abortTile(ye)),this.actor.registerMessageHandler("RMT",(ue,ye)=>this._getWorkerSource(ue,ye.type,ye.source).removeTile(ye)),this.actor.registerMessageHandler("RS",(ue,ye)=>d._(this,void 0,void 0,function*(){if(!this.workerSources[ue]||!this.workerSources[ue][ye.type]||!this.workerSources[ue][ye.type][ye.source])return;const Ae=this.workerSources[ue][ye.type][ye.source];delete this.workerSources[ue][ye.type][ye.source],Ae.removeSource!==void 0&&Ae.removeSource(ye)})),this.actor.registerMessageHandler("RM",ue=>d._(this,void 0,void 0,function*(){delete this.layerIndexes[ue],delete this.availableImages[ue],delete this.workerSources[ue],delete this.demWorkerSources[ue],this.globalStates.delete(ue)})),this.actor.registerMessageHandler("SR",(ue,ye)=>d._(this,void 0,void 0,function*(){this.referrer=ye})),this.actor.registerMessageHandler("SRPS",(ue,ye)=>this._syncRTLPluginState(ue,ye)),this.actor.registerMessageHandler("IS",(ue,ye)=>d._(this,void 0,void 0,function*(){this.self.importScripts(ye)})),this.actor.registerMessageHandler("SI",(ue,ye)=>this._setImages(ue,ye)),this.actor.registerMessageHandler("UL",(ue,ye)=>d._(this,void 0,void 0,function*(){this._getLayerIndex(ue).update(ye.layers,ye.removedIds,this._getGlobalState(ue))})),this.actor.registerMessageHandler("UGS",(ue,ye)=>d._(this,void 0,void 0,function*(){const Ae=this._getGlobalState(ue);for(const ze in ye)Ae[ze]=ye[ze]})),this.actor.registerMessageHandler("SL",(ue,ye)=>d._(this,void 0,void 0,function*(){this._getLayerIndex(ue).replace(ye,this._getGlobalState(ue))}))}_getGlobalState(le){let ue=this.globalStates.get(le);return ue||(ue={},this.globalStates.set(le,ue)),ue}_setImages(le,ue){return d._(this,void 0,void 0,function*(){this.availableImages[le]=ue;for(const ye in this.workerSources[le]){const Ae=this.workerSources[le][ye];for(const ze in Ae)Ae[ze].availableImages=ue}})}_syncRTLPluginState(le,ue){return d._(this,void 0,void 0,function*(){return yield d.c_.syncState(ue,this.self.importScripts)})}_getAvailableImages(le){let ue=this.availableImages[le];return ue||(ue=[]),ue}_getLayerIndex(le){let ue=this.layerIndexes[le];return ue||(ue=this.layerIndexes[le]=new a),ue}_getWorkerSource(le,ue,ye){if(this.workerSources[le]||(this.workerSources[le]={}),this.workerSources[le][ue]||(this.workerSources[le][ue]={}),!this.workerSources[le][ue][ye]){const Ae={sendAsync:(ze,Ye)=>(ze.targetMapId=le,this.actor.sendAsync(ze,Ye))};switch(ue){case"vector":this.workerSources[le][ue][ye]=new v(Ae,this._getLayerIndex(le),this._getAvailableImages(le));break;case"geojson":this.workerSources[le][ue][ye]=new tn(Ae,this._getLayerIndex(le),this._getAvailableImages(le));break;default:this.workerSources[le][ue][ye]=new this.externalWorkerSourceTypes[ue](Ae,this._getLayerIndex(le),this._getAvailableImages(le))}}return this.workerSources[le][ue][ye]}_getDEMWorkerSource(le,ue){return this.demWorkerSources[le]||(this.demWorkerSources[le]={}),this.demWorkerSources[le][ue]||(this.demWorkerSources[le][ue]=new j),this.demWorkerSources[le][ue]}}return d.i(self)&&(self.worker=new zs(self)),zs}),i("index",["exports","./shared"],function(d,a){var f="5.11.0";function p(){var N=new a.A(4);return a.A!=Float32Array&&(N[1]=0,N[2]=0),N[0]=1,N[3]=1,N}let y,v;const j={frame(N,o,m){const g=requestAnimationFrame(P=>{b(),o(P)}),{unsubscribe:b}=a.s(N.signal,"abort",()=>{b(),cancelAnimationFrame(g),m(a.c())},!1)},frameAsync(N){return new Promise((o,m)=>{this.frame(N,o,m)})},getImageData(N,o=0){return this.getImageCanvasContext(N).getImageData(-o,-o,N.width+2*o,N.height+2*o)},getImageCanvasContext(N){const o=window.document.createElement("canvas"),m=o.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return o.width=N.width,o.height=N.height,m.drawImage(N,0,0,N.width,N.height),m},resolveURL:N=>(y||(y=document.createElement("a")),y.href=N,y.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(v==null&&(v=matchMedia("(prefers-reduced-motion: reduce)")),v.matches)}},w=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(N){this._frozenAt=N}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function k(){return w.getCurrentTime()}class S{static testProp(o){if(!S.docStyle)return o[0];for(let m=0;m<o.length;m++)if(o[m]in S.docStyle)return o[m];return o[0]}static create(o,m,g){const b=window.document.createElement(o);return m!==void 0&&(b.className=m),g&&g.appendChild(b),b}static createNS(o,m){return window.document.createElementNS(o,m)}static disableDrag(){S.docStyle&&S.selectProp&&(S.userSelect=S.docStyle[S.selectProp],S.docStyle[S.selectProp]="none")}static enableDrag(){S.docStyle&&S.selectProp&&(S.docStyle[S.selectProp]=S.userSelect)}static setTransform(o,m){o.style[S.transformProp]=m}static addEventListener(o,m,g,b={}){o.addEventListener(m,g,"passive"in b?b:b.capture)}static removeEventListener(o,m,g,b={}){o.removeEventListener(m,g,"passive"in b?b:b.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",S.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",S.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",S.suppressClickInternal,!0)},0)}static getScale(o){const m=o.getBoundingClientRect();return{x:m.width/o.offsetWidth||1,y:m.height/o.offsetHeight||1,boundingClientRect:m}}static getPoint(o,m,g){const b=m.boundingClientRect;return new a.P((g.clientX-b.left)/m.x-o.clientLeft,(g.clientY-b.top)/m.y-o.clientTop)}static mousePos(o,m){const g=S.getScale(o);return S.getPoint(o,g,m)}static touchPos(o,m){const g=[],b=S.getScale(o);for(let P=0;P<m.length;P++)g.push(S.getPoint(o,b,m[P]));return g}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}static sanitize(o){const m=new DOMParser().parseFromString(o,"text/html").body||document.createElement("body"),g=m.querySelectorAll("script");for(const b of g)b.remove();return S.clean(m),m.innerHTML}static isPossiblyDangerous(o,m){const g=m.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(o)||!g.includes("javascript:")&&!g.includes("data:"))||!!o.startsWith("on")||void 0}static clean(o){const m=o.children;for(const g of m)S.removeAttributes(g),S.clean(g)}static removeAttributes(o){for(const{name:m,value:g}of o.attributes)S.isPossiblyDangerous(m,g)&&o.removeAttribute(m)}}S.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,S.selectProp=S.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),S.transformProp=S.testProp(["transform","WebkitTransform"]);const R={supported:!1,testSupport:function(N){!I&&T&&(L?$(N):D=N)}};let D,T,I=!1,L=!1;function $(N){const o=N.createTexture();N.bindTexture(N.TEXTURE_2D,o);try{if(N.texImage2D(N.TEXTURE_2D,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,T),N.isContextLost())return;R.supported=!0}catch{}N.deleteTexture(o),I=!0}var W;typeof document<"u"&&(T=document.createElement("img"),T.onload=()=>{D&&$(D),D=null,L=!0},T.onerror=()=>{I=!0,D=null},T.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(N){let o,m,g,b;N.resetRequestQueue=()=>{o=[],m=0,g=0,b={}},N.addThrottleControl=B=>{const U=g++;return b[U]=B,U},N.removeThrottleControl=B=>{delete b[B],E()},N.getImage=(B,U,G=!0)=>new Promise((J,Y)=>{R.supported&&(B.headers||(B.headers={}),B.headers.accept="image/webp,*/*"),a.e(B,{type:"image"}),o.push({abortController:U,requestParameters:B,supportImageRefresh:G,state:"queued",onError:ne=>{Y(ne)},onSuccess:ne=>{J(ne)}}),E()});const P=B=>a._(this,void 0,void 0,function*(){B.state="running";const{requestParameters:U,supportImageRefresh:G,onError:J,onSuccess:Y,abortController:ne}=B,fe=G===!1&&!a.i(self)&&!a.g(U.url)&&(!U.headers||Object.keys(U.headers).reduce((Se,Te)=>Se&&Te==="accept",!0));m++;const je=fe?z(U,ne):a.m(U,ne);try{const Se=yield je;delete B.abortController,B.state="completed",Se.data instanceof HTMLImageElement||a.b(Se.data)?Y(Se):Se.data&&Y({data:yield(we=Se.data,typeof createImageBitmap=="function"?a.f(we):a.h(we)),cacheControl:Se.cacheControl,expires:Se.expires})}catch(Se){delete B.abortController,J(Se)}finally{m--,E()}var we}),E=()=>{const B=(()=>{for(const U of Object.keys(b))if(b[U]())return!0;return!1})()?a.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let U=m;U<B&&o.length>0;U++){const G=o.shift();G.abortController.signal.aborted?U--:P(G)}},z=(B,U)=>new Promise((G,J)=>{const Y=new Image,ne=B.url,fe=B.credentials;fe&&fe==="include"?Y.crossOrigin="use-credentials":(fe&&fe==="same-origin"||!a.d(ne))&&(Y.crossOrigin="anonymous"),U.signal.addEventListener("abort",()=>{Y.src="",J(a.c())}),Y.fetchPriority="high",Y.onload=()=>{Y.onerror=Y.onload=null,G({data:Y})},Y.onerror=()=>{Y.onerror=Y.onload=null,U.signal.aborted||J(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},Y.src=ne})}(W||(W={})),W.resetRequestQueue();class Z{constructor(o){this._transformRequestFn=o??null}transformRequest(o,m){return this._transformRequestFn&&this._transformRequestFn(o,m)||{url:o}}setTransformRequest(o){this._transformRequestFn=o}}function oe(N){const o=[];if(typeof N=="string")o.push({id:"default",url:N});else if(N&&N.length>0){const m=[];for(const{id:g,url:b}of N){const P=`${g}${b}`;m.indexOf(P)===-1&&(m.push(P),o.push({id:g,url:b}))}}return o}function te(N,o,m){try{const g=new URL(N);return g.pathname+=`${o}${m}`,g.toString()}catch{throw new Error(`Invalid sprite URL "${N}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function be(N){const{userImage:o}=N;return!!(o&&o.render&&o.render())&&(N.data.replace(new Uint8Array(o.data.buffer)),!0)}class ie extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:m,promiseResolve:g}of this.requestors)g(this._getImagesForIds(m));this.requestors=[]}}getImage(o){const m=this.images[o];if(m&&!m.data&&m.spriteData){const g=m.spriteData;m.data=new a.R({width:g.width,height:g.height},g.context.getImageData(g.x,g.y,g.width,g.height).data),m.spriteData=null}return m}addImage(o,m){if(this.images[o])throw new Error(`Image id ${o} already exist, use updateImage instead`);this._validate(o,m)&&(this.images[o]=m)}_validate(o,m){let g=!0;const b=m.data||m.spriteData;return this._validateStretch(m.stretchX,b&&b.width)||(this.fire(new a.k(new Error(`Image "${o}" has invalid "stretchX" value`))),g=!1),this._validateStretch(m.stretchY,b&&b.height)||(this.fire(new a.k(new Error(`Image "${o}" has invalid "stretchY" value`))),g=!1),this._validateContent(m.content,m)||(this.fire(new a.k(new Error(`Image "${o}" has invalid "content" value`))),g=!1),g}_validateStretch(o,m){if(!o)return!0;let g=0;for(const b of o){if(b[0]<g||b[1]<b[0]||m<b[1])return!1;g=b[1]}return!0}_validateContent(o,m){if(!o)return!0;if(o.length!==4)return!1;const g=m.spriteData,b=g&&g.width||m.data.width,P=g&&g.height||m.data.height;return!(o[0]<0||b<o[0]||o[1]<0||P<o[1]||o[2]<0||b<o[2]||o[3]<0||P<o[3]||o[2]<o[0]||o[3]<o[1])}updateImage(o,m,g=!0){const b=this.getImage(o);if(g&&(b.data.width!==m.data.width||b.data.height!==m.data.height))throw new Error(`size mismatch between old image (${b.data.width}x${b.data.height}) and new image (${m.data.width}x${m.data.height}).`);m.version=b.version+1,this.images[o]=m,this.updatedImages[o]=!0}removeImage(o){const m=this.images[o];delete this.images[o],delete this.patterns[o],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o){return new Promise((m,g)=>{let b=!0;if(!this.isLoaded())for(const P of o)this.images[P]||(b=!1);this.isLoaded()||b?m(this._getImagesForIds(o)):this.requestors.push({ids:o,promiseResolve:m})})}_getImagesForIds(o){const m={};for(const g of o){let b=this.getImage(g);b||(this.fire(new a.l("styleimagemissing",{id:g})),b=this.getImage(g)),b?m[g]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,textFitWidth:b.textFitWidth,textFitHeight:b.textFitHeight,hasRenderCallback:!!(b.userImage&&b.userImage.render)}:a.w(`Image "${g}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return m}getPixelSize(){const{width:o,height:m}=this.atlasImage;return{width:o,height:m}}getPattern(o){const m=this.patterns[o],g=this.getImage(o);if(!g)return null;if(m&&m.position.version===g.version)return m.position;if(m)m.position.version=g.version;else{const b={w:g.data.width+2,h:g.data.height+2,x:0,y:0},P=new a.I(b,g);this.patterns[o]={bin:b,position:P}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const m=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.T(o,this.atlasImage,m.RGBA),this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const P in this.patterns)o.push(this.patterns[P].bin);const{w:m,h:g}=a.p(o),b=this.atlasImage;b.resize({width:m||1,height:g||1});for(const P in this.patterns){const{bin:E}=this.patterns[P],z=E.x+1,B=E.y+1,U=this.getImage(P).data,G=U.width,J=U.height;a.R.copy(U,b,{x:0,y:0},{x:z,y:B},{width:G,height:J}),a.R.copy(U,b,{x:0,y:J-1},{x:z,y:B-1},{width:G,height:1}),a.R.copy(U,b,{x:0,y:0},{x:z,y:B+J},{width:G,height:1}),a.R.copy(U,b,{x:G-1,y:0},{x:z-1,y:B},{width:1,height:J}),a.R.copy(U,b,{x:0,y:0},{x:z+G,y:B},{width:1,height:J})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const m of o){if(this.callbackDispatchedThisFrame[m])continue;this.callbackDispatchedThisFrame[m]=!0;const g=this.getImage(m);g||a.w(`Image with ID: "${m}" was not found`),be(g)&&this.updateImage(m,g)}}}const ge=1e20;function Ie(N,o,m,g,b,P,E,z,B){for(let U=o;U<o+g;U++)Oe(N,m*P+U,P,b,E,z,B);for(let U=m;U<m+b;U++)Oe(N,U*P+o,1,g,E,z,B)}function Oe(N,o,m,g,b,P,E){P[0]=0,E[0]=-ge,E[1]=ge,b[0]=N[o];for(let z=1,B=0,U=0;z<g;z++){b[z]=N[o+z*m];const G=z*z;do{const J=P[B];U=(b[z]-b[J]+G-J*J)/(z-J)/2}while(U<=E[B]&&--B>-1);B++,P[B]=z,E[B]=U,E[B+1]=ge}for(let z=0,B=0;z<g;z++){for(;E[B+1]<z;)B++;const U=P[B],G=z-U;N[o+z*m]=b[U]+G*G}}const Xe=a.v.layout_symbol["text-font"].default.join(",");class Ue{constructor(o,m,g){this.requestManager=o,this.localIdeographFontFamily=m,this.entries={},this.lang=g}setURL(o){this.url=o}getGlyphs(o){return a._(this,void 0,void 0,function*(){const m=[];for(const P in o)for(const E of o[P])m.push(this._getAndCacheGlyphsPromise(P,E));const g=yield Promise.all(m),b={};for(const{stack:P,id:E,glyph:z}of g)b[P]||(b[P]={}),b[P][E]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics};return b})}_getAndCacheGlyphsPromise(o,m){return a._(this,void 0,void 0,function*(){let g=this.entries[o];g||(g=this.entries[o]={glyphs:{},requests:{},ranges:{}});let b=g.glyphs[m];return b!==void 0?{stack:o,id:m,glyph:b}:!this.url||this._charUsesLocalIdeographFontFamily(m)?(b=g.glyphs[m]=this._drawGlyph(g,o,m),{stack:o,id:m,glyph:b}):yield this._downloadAndCacheRangePromise(o,m)})}_downloadAndCacheRangePromise(o,m){return a._(this,void 0,void 0,function*(){const g=Math.floor(m/256);if(256*g>65535)throw new Error("glyphs > 65535 not supported");const b=this.entries[o];if(b.ranges[g])return{stack:o,id:m,glyph:null};if(!b.requests[g]){const P=Ue.loadGlyphRange(o,g,this.url,this.requestManager);b.requests[g]=P}try{const P=yield b.requests[g];for(const E in P)b.glyphs[+E]=P[+E];return b.ranges[g]=!0,{stack:o,id:m,glyph:P[m]||null}}catch(P){const E=b.glyphs[m]=this._drawGlyph(b,o,m);return this._warnOnMissingGlyphRange(E,g,m,P),{stack:o,id:m,glyph:E}}})}_warnOnMissingGlyphRange(o,m,g,b){const P=256*m,E=P+255,z=g.toString(16).padStart(4,"0").toUpperCase();a.w(`Unable to load glyph range ${m}, ${P}-${E}. Rendering codepoint U+${z} locally instead. ${b}`)}_charUsesLocalIdeographFontFamily(o){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(o))||a.u["CJK Unified Ideographs"](o)||a.u["Hangul Syllables"](o)||a.u.Hiragana(o)||a.u.Katakana(o)||a.u["CJK Symbols and Punctuation"](o)||a.u["Halfwidth and Fullwidth Forms"](o))}_drawGlyph(o,m,g){const b=m===Xe&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(g),P=b?"ideographTinySDF":"tinySDF";o[P]||(o[P]=this._createTinySDF(b?this.localIdeographFontFamily:m));const E=o[P].draw(String.fromCharCode(g));return{id:g,bitmap:new a.q({width:E.width||60,height:E.height||60},E.data),metrics:{width:E.glyphWidth/2||24,height:E.glyphHeight/2||24,left:E.glyphLeft/2+.5||0,top:E.glyphTop/2-27.5||-8,advance:E.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(o){const m=o?o.split(","):[];m.push("sans-serif");const g=m.map(b=>/[-\w]+/.test(b)?b:`'${CSS.escape(b)}'`).join(",");return new Ue.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:g,fontWeight:this._fontWeight(m[0]),fontStyle:this._fontStyle(m[0]),lang:this.lang})}_fontStyle(o){return/italic/i.test(o)?"italic":/oblique/i.test(o)?"oblique":"normal"}_fontWeight(o){const m={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let g;for(const[b,P]of Object.entries(m))new RegExp(`\\b${b}\\b`,"i").test(o)&&(g=`${P}`);return g}}Ue.loadGlyphRange=function(N,o,m,g){return a._(this,void 0,void 0,function*(){const b=256*o,P=b+255,E=g.transformRequest(m.replace("{fontstack}",N).replace("{range}",`${b}-${P}`),"Glyphs"),z=yield a.n(E,new AbortController);if(!z||!z.data)throw new Error(`Could not load glyph range. range: ${o}, ${b}-${P}`);const B={};for(const U of a.o(z.data))B[U.id]=U;return B})},Ue.TinySDF=class{constructor({fontSize:N=24,buffer:o=3,radius:m=8,cutoff:g=.25,fontFamily:b="sans-serif",fontWeight:P="normal",fontStyle:E="normal",lang:z=null}={}){this.buffer=o,this.cutoff=g,this.radius=m,this.lang=z;const B=this.size=N+4*o,U=this._createCanvas(B),G=this.ctx=U.getContext("2d",{willReadFrequently:!0});G.font=`${E} ${P} ${N}px ${b}`,G.textBaseline="alphabetic",G.textAlign="left",G.fillStyle="black",this.gridOuter=new Float64Array(B*B),this.gridInner=new Float64Array(B*B),this.f=new Float64Array(B),this.z=new Float64Array(B+1),this.v=new Uint16Array(B)}_createCanvas(N){const o=document.createElement("canvas");return o.width=o.height=N,o}draw(N){const{width:o,actualBoundingBoxAscent:m,actualBoundingBoxDescent:g,actualBoundingBoxLeft:b,actualBoundingBoxRight:P}=this.ctx.measureText(N),E=Math.ceil(m),z=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(P-b))),B=Math.min(this.size-this.buffer,E+Math.ceil(g)),U=z+2*this.buffer,G=B+2*this.buffer,J=Math.max(U*G,0),Y=new Uint8ClampedArray(J),ne={data:Y,width:U,height:G,glyphWidth:z,glyphHeight:B,glyphTop:E,glyphLeft:0,glyphAdvance:o};if(z===0||B===0)return ne;const{ctx:fe,buffer:je,gridInner:we,gridOuter:Se}=this;this.lang&&(fe.lang=this.lang),fe.clearRect(je,je,z,B),fe.fillText(N,je,je+E);const Te=fe.getImageData(je,je,z,B);Se.fill(ge,0,J),we.fill(0,0,J);for(let Le=0;Le<B;Le++)for(let ke=0;ke<z;ke++){const Fe=Te.data[4*(Le*z+ke)+3]/255;if(Fe===0)continue;const Be=(Le+je)*U+ke+je;if(Fe===1)Se[Be]=0,we[Be]=ge;else{const De=.5-Fe;Se[Be]=De>0?De*De:0,we[Be]=De<0?De*De:0}}Ie(Se,0,0,U,G,U,this.f,this.v,this.z),Ie(we,je,je,z,B,U,this.f,this.v,this.z);for(let Le=0;Le<J;Le++){const ke=Math.sqrt(Se[Le])-Math.sqrt(we[Le]);Y[Le]=Math.round(255-255*(ke/this.radius+this.cutoff))}return ne}};class tt{constructor(){this.specification=a.t.light.position}possiblyEvaluate(o,m){return a.C(o.expression.evaluate(m))}interpolate(o,m,g){return{x:a.F.number(o.x,m.x,g),y:a.F.number(o.y,m.y,g),z:a.F.number(o.z,m.z,g)}}}let Ce;class ve extends a.E{constructor(o){super(),Ce=Ce||new a.r({anchor:new a.D(a.t.light.anchor),position:new tt,color:new a.D(a.t.light.color),intensity:new a.D(a.t.light.intensity)}),this._transitionable=new a.x(Ce,void 0),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,m={}){if(!this._validate(a.y,o,m))for(const g in o){const b=o[g];g.endsWith("-transition")?this._transitionable.setTransition(g.slice(0,-11),b):this._transitionable.setValue(g,b)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,m,g){return(!g||g.validate!==!1)&&a.z(this,o.call(a.B,{value:m,style:{glyphs:!0,sprite:!0},styleSpec:a.t}))}}const rt=new a.r({"sky-color":new a.D(a.t.sky["sky-color"]),"horizon-color":new a.D(a.t.sky["horizon-color"]),"fog-color":new a.D(a.t.sky["fog-color"]),"fog-ground-blend":new a.D(a.t.sky["fog-ground-blend"]),"horizon-fog-blend":new a.D(a.t.sky["horizon-fog-blend"]),"sky-horizon-blend":new a.D(a.t.sky["sky-horizon-blend"]),"atmosphere-blend":new a.D(a.t.sky["atmosphere-blend"])});class vt extends a.E{constructor(o){super(),this._transitionable=new a.x(rt,void 0),this.setSky(o),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.G(0))}setSky(o,m={}){if(!this._validate(a.H,o,m)){o||(o={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const g in o){const b=o[g];g.endsWith("-transition")?this._transitionable.setTransition(g.slice(0,-11),b):this._transitionable.setValue(g,b)}}}getSky(){return this._transitionable.serialize()}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,m,g={}){return(g==null?void 0:g.validate)!==!1&&a.z(this,o.call(a.B,a.e({value:m,style:{glyphs:!0,sprite:!0},styleSpec:a.t})))}calculateFogBlendOpacity(o){return o<60?0:o<70?(o-60)/10:1}}class gt{constructor(o,m){this.width=o,this.height=m,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,m){const g=o.join(",")+String(m);return this.dashEntry[g]||(this.dashEntry[g]=this.addDash(o,m)),this.dashEntry[g]}getDashRanges(o,m,g){const b=[];let P=o.length%2==1?-o[o.length-1]*g:0,E=o[0]*g,z=!0;b.push({left:P,right:E,isDash:z,zeroLength:o[0]===0});let B=o[0];for(let U=1;U<o.length;U++){z=!z;const G=o[U];P=B*g,B+=G,E=B*g,b.push({left:P,right:E,isDash:z,zeroLength:G===0})}return b}addRoundDash(o,m,g){const b=m/2;for(let P=-g;P<=g;P++){const E=this.width*(this.nextRow+g+P);let z=0,B=o[z];for(let U=0;U<this.width;U++){U/B.right>1&&(B=o[++z]);const G=Math.abs(U-B.left),J=Math.abs(U-B.right),Y=Math.min(G,J);let ne;const fe=P/g*(b+1);if(B.isDash){const je=b-Math.abs(fe);ne=Math.sqrt(Y*Y+je*je)}else ne=b-Math.sqrt(Y*Y+fe*fe);this.data[E+U]=Math.max(0,Math.min(255,ne+128))}}}addRegularDash(o){for(let z=o.length-1;z>=0;--z){const B=o[z],U=o[z+1];B.zeroLength?o.splice(z,1):U&&U.isDash===B.isDash&&(U.left=B.left,o.splice(z,1))}const m=o[0],g=o[o.length-1];m.isDash===g.isDash&&(m.left=g.left-this.width,g.right=m.right+this.width);const b=this.width*this.nextRow;let P=0,E=o[P];for(let z=0;z<this.width;z++){z/E.right>1&&(E=o[++P]);const B=Math.abs(z-E.left),U=Math.abs(z-E.right),G=Math.min(B,U);this.data[b+z]=Math.max(0,Math.min(255,(E.isDash?G:-G)+128))}}addDash(o,m){const g=m?7:0,b=2*g+1;if(this.nextRow+b>this.height)return a.w("LineAtlas out of space"),null;let P=0;for(let z=0;z<o.length;z++)P+=o[z];if(P!==0){const z=this.width/P,B=this.getDashRanges(o,this.width,z);m?this.addRoundDash(B,z,g):this.addRegularDash(B)}const E={y:this.nextRow+g,height:2*g,width:P};return this.nextRow+=b,this.dirty=!0,E}bind(o){const m=o.gl;this.texture?(m.bindTexture(m.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,m.texSubImage2D(m.TEXTURE_2D,0,0,0,this.width,this.height,m.ALPHA,m.UNSIGNED_BYTE,this.data))):(this.texture=m.createTexture(),m.bindTexture(m.TEXTURE_2D,this.texture),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.REPEAT),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.REPEAT),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR),m.texImage2D(m.TEXTURE_2D,0,m.ALPHA,this.width,this.height,0,m.ALPHA,m.UNSIGNED_BYTE,this.data))}}const Et="maplibre_preloaded_worker_pool";class tr{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<tr.workerCount;)this.workers.push(new Worker(a.a.WORKER_URL));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(m=>{m.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Et]}numActive(){return Object.keys(this.active).length}}const Dr=Math.floor(j.hardwareConcurrency/2);let Pr,It;function _r(){return Pr||(Pr=new tr),Pr}tr.workerCount=a.J(globalThis)?Math.max(Math.min(Dr,3),1):1;class St{constructor(o,m){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=m;const g=this.workerPool.acquire(m);for(let b=0;b<g.length;b++){const P=new a.K(g[b],m);P.name=`Worker ${b}`,this.actors.push(P)}if(!this.actors.length)throw new Error("No actors found")}broadcast(o,m){const g=[];for(const b of this.actors)g.push(b.sendAsync({type:o,data:m}));return Promise.all(g)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(o=!0){this.actors.forEach(m=>{m.remove()}),this.actors=[],o&&this.workerPool.release(this.id)}registerMessageHandler(o,m){for(const g of this.actors)g.registerMessageHandler(o,m)}}function Qt(){return It||(It=new St(_r(),a.L),It.registerMessageHandler("GR",(N,o,m)=>a.m(o,m))),It}function rr(N,o){const m=a.M();return a.N(m,m,[1,1,0]),a.O(m,m,[.5*N.width,.5*N.height,1]),N.calculatePosMatrix?a.Q(m,m,N.calculatePosMatrix(o.toUnwrapped())):m}function pt(N,o,m,g,b,P,E){var z;const B=function(Y,ne,fe){if(Y)for(const je of Y){const we=ne[je];if(we&&we.source===fe&&we.type==="fill-extrusion")return!0}else for(const je in ne){const we=ne[je];if(we.source===fe&&we.type==="fill-extrusion")return!0}return!1}((z=b==null?void 0:b.layers)!==null&&z!==void 0?z:null,o,N.id),U=P.maxPitchScaleFactor(),G=N.tilesIn(g,U,B);G.sort(qr);const J=[];for(const Y of G)J.push({wrappedTileID:Y.tileID.wrapped().key,queryResults:Y.tile.queryRenderedFeatures(o,m,N.getState(),Y.queryGeometry,Y.cameraQueryGeometry,Y.scale,b,P,U,rr(P,Y.tileID),E?(ne,fe)=>E(Y.tileID,ne,fe):void 0)});return function(Y,ne){for(const fe in Y)for(const je of Y[fe])or(je,ne);return Y}(function(Y){const ne={},fe={};for(const je of Y){const we=je.queryResults,Se=je.wrappedTileID,Te=fe[Se]=fe[Se]||{};for(const Le in we){const ke=we[Le],Fe=Te[Le]=Te[Le]||{},Be=ne[Le]=ne[Le]||[];for(const De of ke)Fe[De.featureIndex]||(Fe[De.featureIndex]=!0,Be.push(De))}}return ne}(J),N)}function qr(N,o){const m=N.tileID,g=o.tileID;return m.overscaledZ-g.overscaledZ||m.canonical.y-g.canonical.y||m.wrap-g.wrap||m.canonical.x-g.canonical.x}function or(N,o){const m=N.feature,g=o.getFeatureState(m.layer["source-layer"],m.id);m.source=m.layer.source,m.layer["source-layer"]&&(m.sourceLayer=m.layer["source-layer"]),m.state=g}function en(N,o,m){return a._(this,void 0,void 0,function*(){let g=N;if(N.url?g=(yield a.j(o.transformRequest(N.url,"Source"),m)).data:yield j.frameAsync(m),!g)return null;const b=a.S(a.e(g,N),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in g&&g.vector_layers&&(b.vectorLayerIds=g.vector_layers.map(P=>P.id)),b})}class Lr{constructor(o,m){o&&(m?this.setSouthWest(o).setNorthEast(m):Array.isArray(o)&&(o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1])))}setNorthEast(o){return this._ne=o instanceof a.U?new a.U(o.lng,o.lat):a.U.convert(o),this}setSouthWest(o){return this._sw=o instanceof a.U?new a.U(o.lng,o.lat):a.U.convert(o),this}extend(o){const m=this._sw,g=this._ne;let b,P;if(o instanceof a.U)b=o,P=o;else{if(!(o instanceof Lr))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(Lr.convert(o)):this.extend(a.U.convert(o)):o&&("lng"in o||"lon"in o)&&"lat"in o?this.extend(a.U.convert(o)):this;if(b=o._sw,P=o._ne,!b||!P)return this}return m||g?(m.lng=Math.min(b.lng,m.lng),m.lat=Math.min(b.lat,m.lat),g.lng=Math.max(P.lng,g.lng),g.lat=Math.max(P.lat,g.lat)):(this._sw=new a.U(b.lng,b.lat),this._ne=new a.U(P.lng,P.lat)),this}getCenter(){return new a.U((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.U(this.getWest(),this.getNorth())}getSouthEast(){return new a.U(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:m,lat:g}=a.U.convert(o);let b=this._sw.lng<=m&&m<=this._ne.lng;return this._sw.lng>this._ne.lng&&(b=this._sw.lng>=m&&m>=this._ne.lng),this._sw.lat<=g&&g<=this._ne.lat&&b}intersects(o){if((o=Lr.convert(o)).getNorth()<this.getSouth()||o.getSouth()>this.getNorth())return!1;const m=a.V(this.getWest(),-180,180),g=a.V(this.getEast(),-180,180),b=a.V(o.getWest(),-180,180),P=a.V(o.getEast(),-180,180),E=m>g,z=b>P;return!(!E||!z)||(E?P>=m||b<=g:z?g>=b||m<=P:!(b>g||P<m))}static convert(o){return o instanceof Lr?o:o&&new Lr(o)}static fromLngLat(o,m=0){const g=360*m/40075017,b=g/Math.cos(Math.PI/180*o.lat);return new Lr(new a.U(o.lng-b,o.lat-g),new a.U(o.lng+b,o.lat+g))}adjustAntiMeridian(){const o=new a.U(this._sw.lng,this._sw.lat),m=new a.U(this._ne.lng,this._ne.lat);return new Lr(o,o.lng>m.lng?new a.U(m.lng+360,m.lat):m)}}class En{constructor(o,m,g){this.bounds=Lr.convert(this.validateBounds(o)),this.minzoom=m||0,this.maxzoom=g||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const m=Math.pow(2,o.z),g=Math.floor(a.X(this.bounds.getWest())*m),b=Math.floor(a.W(this.bounds.getNorth())*m),P=Math.ceil(a.X(this.bounds.getEast())*m),E=Math.ceil(a.W(this.bounds.getSouth())*m);return o.x>=g&&o.x<P&&o.y>=b&&o.y<E}}class ks extends a.E{constructor(o,m,g,b){if(super(),this.id=o,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.S(m,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(b)}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield en(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),o&&(a.e(this,o),o.bounds&&(this.tileBounds=new En(o.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})))}catch(o){this._tileJSONRequest=null,this._loaded=!0,this.fire(new a.k(o))}})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.abort(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return a.e({},this._options)}loadTile(o){return a._(this,void 0,void 0,function*(){const m=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g={request:this.map._requestManager.transformRequest(m,"Tile"),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};g.request.collectResourceTiming=this._collectResourceTiming;let b="RT";if(o.actor&&o.state!=="expired"){if(o.state==="loading")return new Promise((P,E)=>{o.reloadPromise={resolve:P,reject:E}})}else o.actor=this.dispatcher.getActor(),b="LT";o.abortController=new AbortController;try{const P=yield o.actor.sendAsync({type:b,data:g},o.abortController);if(delete o.abortController,o.aborted)return;this._afterTileLoadWorkerResponse(o,P)}catch(P){if(delete o.abortController,o.aborted)return;if(P&&P.status!==404)throw P;this._afterTileLoadWorkerResponse(o,null)}})}_afterTileLoadWorkerResponse(o,m){if(m&&m.resourceTiming&&(o.resourceTiming=m.resourceTiming),m&&this.map._refreshExpiredTiles&&o.setExpiryData(m),o.loadVectorData(m,this.map.painter),o.reloadPromise){const g=o.reloadPromise;o.reloadPromise=null,this.loadTile(o).then(g.resolve).catch(g.reject)}}abortTile(o){return a._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController),o.actor&&(yield o.actor.sendAsync({type:"AT",data:{uid:o.uid,type:this.type,source:this.id}}))})}unloadTile(o){return a._(this,void 0,void 0,function*(){o.unloadVectorData(),o.actor&&(yield o.actor.sendAsync({type:"RMT",data:{uid:o.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Yn extends a.E{constructor(o,m,g,b){super(),this.id=o,this.dispatcher=g,this.setEventedParent(b),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},m),a.e(this,a.S(m,["url","scheme","tileSize"]))}load(){return a._(this,arguments,void 0,function*(o=!1){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const m=yield en(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,m&&(a.e(this,m),m.bounds&&(this.tileBounds=new En(m.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:o})))}catch(m){this._tileJSONRequest=null,this._loaded=!0,this.fire(new a.k(m))}})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(o){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),o(),this.load(!0)}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}serialize(){return a.e({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o){return a._(this,void 0,void 0,function*(){const m=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.abortController=new AbortController;try{const g=yield W.getImage(this.map._requestManager.transformRequest(m,"Tile"),o.abortController,this.map._refreshExpiredTiles);if(delete o.abortController,o.aborted)return void(o.state="unloaded");if(g&&g.data){this.map._refreshExpiredTiles&&(g.cacheControl||g.expires)&&o.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const b=this.map.painter.context,P=b.gl,E=g.data;o.texture=this.map.painter.getTileTexture(E.width),o.texture?o.texture.update(E,{useMipmap:!0}):(o.texture=new a.T(b,E,P.RGBA,{useMipmap:!0}),o.texture.bind(P.LINEAR,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST)),o.state="loaded"}}catch(g){if(delete o.abortController,o.aborted)o.state="unloaded";else if(g)throw o.state="errored",g}})}abortTile(o){return a._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController)})}unloadTile(o){return a._(this,void 0,void 0,function*(){o.texture&&this.map.painter.saveTileTexture(o.texture)})}hasTransition(){return!1}}class qe extends Yn{constructor(o,m,g,b){super(o,m,g,b),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},m),this.encoding=m.encoding||"mapbox",this.redFactor=m.redFactor,this.greenFactor=m.greenFactor,this.blueFactor=m.blueFactor,this.baseShift=m.baseShift}loadTile(o){return a._(this,void 0,void 0,function*(){const m=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g=this.map._requestManager.transformRequest(m,"Tile");o.neighboringTiles=this._getNeighboringTiles(o.tileID),o.abortController=new AbortController;try{const b=yield W.getImage(g,o.abortController,this.map._refreshExpiredTiles);if(delete o.abortController,o.aborted)return void(o.state="unloaded");if(b&&b.data){const P=b.data;this.map._refreshExpiredTiles&&(b.cacheControl||b.expires)&&o.setExpiryData({cacheControl:b.cacheControl,expires:b.expires});const E=a.b(P)&&a.Y()?P:yield this.readImageNow(P),z={type:this.type,uid:o.uid,source:this.id,rawImageData:E,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!o.actor||o.state==="expired"){o.actor=this.dispatcher.getActor();const B=yield o.actor.sendAsync({type:"LDT",data:z});o.dem=B,o.needsHillshadePrepare=!0,o.needsTerrainPrepare=!0,o.state="loaded"}}}catch(b){if(delete o.abortController,o.aborted)o.state="unloaded";else if(b)throw o.state="errored",b}})}readImageNow(o){return a._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&a.Z()){const m=o.width+2,g=o.height+2;try{return new a.R({width:m,height:g},yield a.$(o,-1,-1,m,g))}catch{}}return j.getImageData(o,1)})}_getNeighboringTiles(o){const m=o.canonical,g=Math.pow(2,m.z),b=(m.x-1+g)%g,P=m.x===0?o.wrap-1:o.wrap,E=(m.x+1+g)%g,z=m.x+1===g?o.wrap+1:o.wrap,B={};return B[new a.a0(o.overscaledZ,P,m.z,b,m.y).key]={backfilled:!1},B[new a.a0(o.overscaledZ,z,m.z,E,m.y).key]={backfilled:!1},m.y>0&&(B[new a.a0(o.overscaledZ,P,m.z,b,m.y-1).key]={backfilled:!1},B[new a.a0(o.overscaledZ,o.wrap,m.z,m.x,m.y-1).key]={backfilled:!1},B[new a.a0(o.overscaledZ,z,m.z,E,m.y-1).key]={backfilled:!1}),m.y+1<g&&(B[new a.a0(o.overscaledZ,P,m.z,b,m.y+1).key]={backfilled:!1},B[new a.a0(o.overscaledZ,o.wrap,m.z,m.x,m.y+1).key]={backfilled:!1},B[new a.a0(o.overscaledZ,z,m.z,E,m.y+1).key]={backfilled:!1}),B}unloadTile(o){return a._(this,void 0,void 0,function*(){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&(yield o.actor.sendAsync({type:"RDT",data:{type:this.type,uid:o.uid,source:this.id}}))})}}function nt(N){return N.type==="GeometryCollection"?N.geometries.map(o=>o.coordinates).flat(1/0):N.coordinates.flat(1/0)}function xt(N){const o=new Lr;let m;switch(N.type){case"FeatureCollection":m=N.features.map(g=>nt(g.geometry)).flat(1/0);break;case"Feature":m=nt(N.geometry);break;default:m=nt(N)}if(m.length==0)return o;for(let g=0;g<m.length-1;g+=2)o.extend([m[g],m[g+1]]);return o}class Ut extends a.E{constructor(o,m,g,b){super(),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:m.data},this.actor=g.getActor(),this.setEventedParent(b),this._data=m.data,this._options=a.e({},m),this._collectResourceTiming=m.collectResourceTiming,m.maxzoom!==void 0&&(this.maxzoom=m.maxzoom),m.type&&(this.type=m.type),m.attribution&&(this.attribution=m.attribution),this.promoteId=m.promoteId,m.clusterMaxZoom!==void 0&&this.maxzoom<=m.clusterMaxZoom&&a.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${m.clusterMaxZoom}".`),this.workerOptions=a.e({source:this.id,cluster:m.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(m.buffer!==void 0?m.buffer:128),tolerance:this._pixelsToTileUnits(m.tolerance!==void 0?m.tolerance:.375),extent:a.a3,maxZoom:this.maxzoom,lineMetrics:m.lineMetrics||!1,generateId:m.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(m.clusterMaxZoom),minPoints:Math.max(2,m.clusterMinPoints||2),extent:a.a3,radius:this._pixelsToTileUnits(m.clusterRadius||50),log:!1,generateId:m.generateId||!1},clusterProperties:m.clusterProperties,filter:m.filter},m.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(o){return o*(a.a3/this.tileSize)}_getClusterMaxZoom(o){const m=o?Math.round(o):this.maxzoom-1;return Number.isInteger(o)||o===void 0||a.w(`Integer expected for option 'clusterMaxZoom': provided value "${o}" rounded to "${m}"`),m}load(){return a._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._pendingWorkerUpdate={data:o},this._updateWorkerData(),this}updateData(o){return this._pendingWorkerUpdate.diff=a.a4(this._pendingWorkerUpdate.diff,o),this._updateWorkerData(),this}getData(){return a._(this,void 0,void 0,function*(){const o=a.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:o})})}getBounds(){return a._(this,void 0,void 0,function*(){return xt(yield this.getData())})}setClusterOptions(o){return this.workerOptions.cluster=o.cluster,o.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(o.clusterRadius)),o.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(o.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(o){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:o,source:this.id}})}getClusterChildren(o){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:o,source:this.id}})}getClusterLeaves(o,m,g){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:o,limit:m,offset:g}})}_updateWorkerData(){return a._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void a.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:o,diff:m}=this._pendingWorkerUpdate,g=a.e({type:this.type},this.workerOptions);o?(typeof o=="string"?(g.request=this.map._requestManager.transformRequest(j.resolveURL(o),"Source"),g.request.collectResourceTiming=this._collectResourceTiming):g.data=JSON.stringify(o),this._pendingWorkerUpdate.data=void 0):m&&(g.dataDiff=m,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new a.l("dataloading",{dataType:"source"}));try{const b=yield this.actor.sendAsync({type:"LD",data:g});if(this._isUpdatingWorker=!1,this._removed||b.abandoned)return void this.fire(new a.l("dataabort",{dataType:"source"}));this._data=b.data;let P=null;b.resourceTiming&&b.resourceTiming[this.id]&&(P=b.resourceTiming[this.id].slice(0));const E={dataType:"source"};this._collectResourceTiming&&P&&P.length>0&&a.e(E,{resourceTiming:P}),this.fire(new a.l("data",Object.assign(Object.assign({},E),{sourceDataType:"metadata"}))),this.fire(new a.l("data",Object.assign(Object.assign({},E),{sourceDataType:"content",shouldReloadTileOptions:this._getShouldReloadTileOptions(m)})))}catch(b){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new a.l("dataabort",{dataType:"source"}));this.fire(new a.k(b))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}})}_getShouldReloadTileOptions(o){if(!o||o.removeAll)return;const{add:m=[],update:g=[],remove:b=[]}=o||{},P=new Set([...g.map(E=>E.id),...b]);return{nextBounds:[...g.map(E=>E.newGeometry),...m.map(E=>E.geometry)].map(E=>xt(E)),prevIds:P}}shouldReloadTile(o,{nextBounds:m,prevIds:g}){const b=o.latestFeatureIndex.loadVTLayers();for(let B=0;B<o.latestFeatureIndex.featureIndexArray.length;B++){const U=o.latestFeatureIndex.featureIndexArray.get(B),G=b._geojsonTileLayer.feature(U.featureIndex);if(g.has(G.id))return!0}const{buffer:P,extent:E}=this.workerOptions.geojsonVtOptions,z=function({x:B,y:U,z:G},J=0){const Y=a.a1((B-J)/Math.pow(2,G)),ne=a.a2((U+1+J)/Math.pow(2,G)),fe=a.a1((B+1+J)/Math.pow(2,G)),je=a.a2((U-J)/Math.pow(2,G));return new Lr([Y,ne],[fe,je])}(o.tileID.canonical,P/E);for(const B of m)if(z.intersects(B))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(o){return a._(this,void 0,void 0,function*(){const m=o.actor?"RT":"LT";o.actor=this.actor;const g={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};o.abortController=new AbortController;const b=yield this.actor.sendAsync({type:m,data:g},o.abortController);delete o.abortController,o.unloadVectorData(),o.aborted||o.loadVectorData(b,this.map.painter,m==="RT")})}abortTile(o){return a._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController),o.aborted=!0})}unloadTile(o){return a._(this,void 0,void 0,function*(){o.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:o.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return a.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Vt extends a.E{constructor(o,m,g,b){super(),this.flippedWindingOrder=!1,this.id=o,this.dispatcher=g,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(b),this.options=m}load(o){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const m=yield W.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,m&&m.data&&(this.image=m.data,o&&(this.coordinates=o),this._finishLoading())}catch(m){this._request=null,this._loaded=!0,this.fire(new a.k(m))}})}loaded(){return this._loaded}updateImage(o){return o.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=o.url,this.load(o.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(o){this.coordinates=o;const m=o.map(a.a5.fromLngLat);var g;return this.tileID=function(b){const P=a.a6.fromPoints(b),E=P.width(),z=P.height(),B=Math.max(E,z),U=Math.max(0,Math.floor(-Math.log(B)/Math.LN2)),G=Math.pow(2,U);return new a.a8(U,Math.floor((P.minX+P.maxX)/2*G),Math.floor((P.minY+P.maxY)/2*G))}(m),this.terrainTileRanges=this._getOverlappingTileRanges(m),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=m.map(b=>this.tileID.getTilePoint(b)._round()),this.flippedWindingOrder=((g=this.tileCoords)[1].x-g[0].x)*(g[2].y-g[0].y)-(g[1].y-g[0].y)*(g[2].x-g[0].x)<0,this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,m=o.gl;this.texture||(this.texture=new a.T(o,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE));let g=!1;for(const b in this.tiles){const P=this.tiles[b];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture,g=!0)}g&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(o){return a._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={}):o.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(o){const{minX:m,minY:g,maxX:b,maxY:P}=a.a6.fromPoints(o),E={};for(let z=0;z<=a.a7;z++){const B=Math.pow(2,z),U=Math.floor(m*B),G=Math.floor(g*B),J=Math.floor(b*B),Y=Math.floor(P*B);E[z]={minTileX:U,minTileY:G,maxTileX:J,maxTileY:Y}}return E}}class Ft extends Vt{constructor(o,m,g,b){super(o,m,g,b),this.roundZoom=!0,this.type="video",this.options=m}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1;const o=this.options;this.urls=[];for(const m of o.urls)this.urls.push(this.map._requestManager.transformRequest(m,"Source").url);try{const m=yield a.a9(this.urls);if(this._loaded=!0,!m)return;this.video=m,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(m){this.fire(new a.k(m))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const m=this.video.seekable;o<m.start(0)||o>m.end(0)?this.fire(new a.k(new a.aa(`sources.${this.id}`,null,`Playback for this video can be set only between the ${m.start(0)} and ${m.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const o=this.map.painter.context,m=o.gl;this.texture?this.video.paused||(this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE),m.texSubImage2D(m.TEXTURE_2D,0,0,0,m.RGBA,m.UNSIGNED_BYTE,this.video)):(this.texture=new a.T(o,this.video,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE));let g=!1;for(const b in this.tiles){const P=this.tiles[b];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture,g=!0)}g&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class sr extends Vt{constructor(o,m,g,b){super(o,m,g,b),m.coordinates?Array.isArray(m.coordinates)&&m.coordinates.length===4&&!m.coordinates.some(P=>!Array.isArray(P)||P.length!==2||P.some(E=>typeof E!="number"))||this.fire(new a.k(new a.aa(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.k(new a.aa(`sources.${o}`,null,'missing required property "coordinates"'))),m.animate&&typeof m.animate!="boolean"&&this.fire(new a.k(new a.aa(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),m.canvas?typeof m.canvas=="string"||m.canvas instanceof HTMLCanvasElement||this.fire(new a.k(new a.aa(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.k(new a.aa(`sources.${o}`,null,'missing required property "canvas"'))),this.options=m,this.animate=m.animate===void 0||m.animate}load(){return a._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const m=this.map.painter.context,g=m.gl;this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.T(m,this.canvas,g.RGBA,{premultiply:!0});let b=!1;for(const P in this.tiles){const E=this.tiles[P];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,b=!0)}b&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const tn={},Pn=N=>{switch(N){case"geojson":return Ut;case"image":return Vt;case"raster":return Yn;case"raster-dem":return qe;case"vector":return ks;case"video":return Ft;case"canvas":return sr}return tn[N]},zs="RTLPluginLoaded";class We extends a.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Qt()}_syncState(o){return this.status=o,this.dispatcher.broadcast("SRPS",{pluginStatus:o,pluginURL:this.url}).catch(m=>{throw this.status="error",m})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(o){return a._(this,arguments,void 0,function*(m,g=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=j.resolveURL(m),!this.url)throw new Error(`requested url ${m} is invalid`);if(this.status==="unavailable"){if(!g)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return a._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new a.l(zs))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let le=null;function ue(){return le||(le=new We),le}var ye,Ae;(function(N){N[N.Base=0]="Base",N[N.Parent=1]="Parent"})(ye||(ye={})),function(N){N[N.Departing=0]="Departing",N[N.Incoming=1]="Incoming"}(Ae||(Ae={}));class ze{constructor(o,m){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=o,this.uid=a.ab(),this.uses=0,this.tileSize=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(o){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(o||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:o,fadingDirection:m,fadingParentID:g,fadeEndTime:b}){this.resetFadeLogic(),this.fadingRole=o,this.fadingDirection=m,this.fadingParentID=g,this.fadeEndTime=b}setSelfFadeLogic(o){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=o}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=k(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(o){this.demTexture&&o.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(o,m,g){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(b,P){const E={};if(!P)return E;for(const z of b){const B=z.layerIds.map(U=>P.getLayer(U)).filter(Boolean);if(B.length!==0){z.layers=B,z.stateDependentLayerIds&&(z.stateDependentLayers=z.stateDependentLayerIds.map(U=>B.filter(G=>G.id===U)[0]));for(const U of B)E[U.id]=z}}return E}(o.buckets,m==null?void 0:m.style),this.hasSymbolBuckets=!1;for(const b in this.buckets){const P=this.buckets[b];if(P instanceof a.ad){if(this.hasSymbolBuckets=!0,!g)break;P.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const b in this.buckets){const P=this.buckets[b];if(P instanceof a.ad&&P.hasRTLText){this.hasRTLText=!0,ue().lazyLoad();break}}this.queryPadding=0;for(const b in this.buckets){const P=this.buckets[b];this.queryPadding=Math.max(this.queryPadding,m.style.getLayer(b).queryRadius(P))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),this.dashPositions=o.dashPositions}else this.collisionBoxArray=new a.ac}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const g in this.buckets){const b=this.buckets[g];b.uploadPending()&&b.upload(o)}const m=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new a.T(o,this.imageAtlas.image,m.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new a.T(o,this.glyphAtlasImage,m.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,m,g,b,P,E,z,B,U,G,J){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:b,cameraQueryGeometry:P,scale:E,tileSize:this.tileSize,pixelPosMatrix:G,transform:B,params:z,queryPadding:this.queryPadding*U,getElevation:J},o,m,g):{}}querySourceFeatures(o,m){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const b=g.loadVTLayers(),P=m&&m.sourceLayer?m.sourceLayer:"",E=b._geojsonTileLayer||b[P];if(!E)return;const z=a.ae(m==null?void 0:m.filter,m==null?void 0:m.globalState),{z:B,x:U,y:G}=this.tileID.canonical,J={z:B,x:U,y:G};for(let Y=0;Y<E.length;Y++){const ne=E.feature(Y);if(z.needGeometry){const we=a.af(ne,!0);if(!z.filter(new a.G(this.tileID.overscaledZ),we,this.tileID.canonical))continue}else if(!z.filter(new a.G(this.tileID.overscaledZ),ne))continue;const fe=g.getId(ne,P),je=new a.ag(ne,B,U,G,fe);je.tile=J,o.push(je)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const m=this.expirationTime;if(o.cacheControl){const g=a.ah(o.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const g=Date.now();let b=!1;if(this.expirationTime>g)b=!1;else if(m)if(this.expirationTime<m)b=!0;else{const P=this.expirationTime-m;P?this.expirationTime=g+Math.max(P,3e4):b=!0}else b=!0;b?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,m){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0)return;const g=this.latestFeatureIndex.loadVTLayers();for(const b in this.buckets){if(!m.style.hasLayer(b))continue;const P=this.buckets[b],E=P.layers[0].sourceLayer||"_geojsonTileLayer",z=g[E],B=o[E];if(!z||!B||Object.keys(B).length===0)continue;P.update(B,z,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const U=m&&m.style&&m.style.getLayer(b);U&&(this.queryPadding=Math.max(this.queryPadding,U.queryRadius(P)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<k()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(o){this.symbolFadeHoldUntil=k()+o}setDependencies(o,m){const g={};for(const b of m)g[b]=!0;this.dependencies[o]=g}hasDependency(o,m){for(const g of o){const b=this.dependencies[g];if(b){for(const P of m)if(b[P])return!0}}return!1}}class Ye{constructor(o,m){this.max=o,this.onRemove=m,this.reset()}reset(){for(const o in this.data)for(const m of this.data[o])m.timeout&&clearTimeout(m.timeout),this.onRemove(m.value);return this.data={},this.order=[],this}add(o,m,g){const b=o.wrapped().key;this.data[b]===void 0&&(this.data[b]=[]);const P={value:m,timeout:void 0};if(g!==void 0&&(P.timeout=setTimeout(()=>{this.remove(o,P)},g)),this.data[b].push(P),this.order.push(b),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const m=this.data[o].shift();return m.timeout&&clearTimeout(m.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),m.value}getByKey(o){const m=this.data[o];return m?m[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,m){if(!this.has(o))return this;const g=o.wrapped().key,b=m===void 0?0:this.data[g].indexOf(m),P=this.data[g][b];return this.data[g].splice(b,1),P.timeout&&clearTimeout(P.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(P.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}filter(o){const m=[];for(const g in this.data)for(const b of this.data[g])o(b.value)||m.push(b);for(const g of m)this.remove(g.value.tileID,g)}}class st{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,m,g){const b=String(m);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][b]=this.stateChanges[o][b]||{},a.e(this.stateChanges[o][b],g),this.deletedStates[o]===null){this.deletedStates[o]={};for(const P in this.state[o])P!==b&&(this.deletedStates[o][P]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][b]===null){this.deletedStates[o][b]={};for(const P in this.state[o][b])g[P]||(this.deletedStates[o][b][P]=null)}else for(const P in g)this.deletedStates[o]&&this.deletedStates[o][b]&&this.deletedStates[o][b][P]===null&&delete this.deletedStates[o][b][P]}removeFeatureState(o,m,g){if(this.deletedStates[o]===null)return;const b=String(m);if(this.deletedStates[o]=this.deletedStates[o]||{},g&&m!==void 0)this.deletedStates[o][b]!==null&&(this.deletedStates[o][b]=this.deletedStates[o][b]||{},this.deletedStates[o][b][g]=null);else if(m!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][b])for(g in this.deletedStates[o][b]={},this.stateChanges[o][b])this.deletedStates[o][b][g]=null;else this.deletedStates[o][b]=null;else this.deletedStates[o]=null}getState(o,m){const g=String(m),b=a.e({},(this.state[o]||{})[g],(this.stateChanges[o]||{})[g]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const P=this.deletedStates[o][m];if(P===null)return{};for(const E in P)delete b[E]}return b}initializeTileState(o,m){o.setFeatureState(this.state,m)}coalesceChanges(o,m){const g={};for(const b in this.stateChanges){this.state[b]=this.state[b]||{};const P={};for(const E in this.stateChanges[b])this.state[b][E]||(this.state[b][E]={}),a.e(this.state[b][E],this.stateChanges[b][E]),P[E]=this.state[b][E];g[b]=P}for(const b in this.deletedStates){this.state[b]=this.state[b]||{};const P={};if(this.deletedStates[b]===null)for(const E in this.state[b])P[E]={},this.state[b][E]={};else for(const E in this.deletedStates[b]){if(this.deletedStates[b][E]===null)this.state[b][E]={};else for(const z of Object.keys(this.deletedStates[b][E]))delete this.state[b][E][z];P[E]=this.state[b][E]}g[b]=g[b]||{},a.e(g[b],P)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const b in o)o[b].setFeatureState(g,m)}}const He=89.25;function dt(N,o){const m=a.ai(o.lat,-a.aj,a.aj);return new a.P(a.X(o.lng)*N,a.W(m)*N)}function Pt(N,o){return new a.a5(o.x/N,o.y/N).toLngLat()}function yt(N){return N.cameraToCenterDistance*Math.min(.85*Math.tan(a.ak(90-N.pitch)),Math.tan(a.ak(He-N.pitch)))}function lr(N,o){const m=N.canonical,g=o/a.al(m.z),b=m.x+Math.pow(2,m.z)*N.wrap,P=a.am(new Float64Array(16));return a.N(P,P,[b*g,m.y*g,0]),a.O(P,P,[g/a.a3,g/a.a3,1]),P}function Je(N,o,m,g,b){const P=a.a5.fromLngLat(N,o),E=b*a.an(1,N.lat),z=E*Math.cos(a.ak(m)),B=Math.sqrt(E*E-z*z),U=B*Math.sin(a.ak(-g)),G=B*Math.cos(a.ak(-g));return new a.a5(P.x+U,P.y+G,P.z+z)}function Qr(N,o,m){const g=o.intersectsFrustum(N);if(!m||g===0)return g;const b=o.intersectsPlane(m);return b===0?0:g===2&&b===2?2:1}function fr(N,o,m){let g=0;const b=(m-o)/10;for(let P=0;P<10;P++)g+=b*Math.pow(Math.cos(o+(P+.5)/10*(m-o)),N);return g}function Gt(N,o){return function(m,g,b,P,E){const z=2*((N-1)/a.ao(Math.cos(a.ak(He-E))/Math.cos(a.ak(He)))-1),B=Math.acos(b/P),U=2*fr(z-1,0,a.ak(E/2)),G=Math.min(a.ak(He),B+a.ak(E/2)),J=fr(z-1,Math.min(G,B-a.ak(E/2)),G),Y=Math.atan(g/b),ne=Math.hypot(g,b);let fe=m;return fe+=a.ao(P/ne/Math.max(.5,Math.cos(a.ak(E/2)))),fe+=z*a.ao(Math.cos(Y))/2,fe-=a.ao(Math.max(1,J/U/o))/2,fe}}const yr=Gt(9.314,3);function cn(N,o){const m=(o.roundZoom?Math.round:Math.floor)(N.zoom+a.ao(N.tileSize/o.tileSize));return Math.max(0,m)}function Cn(N,o){const m=N.getCameraFrustum(),g=N.getClippingPlane(),b=N.screenPointToMercatorCoordinate(N.getCameraPoint()),P=a.a5.fromLngLat(N.center,N.elevation);b.z=P.z+Math.cos(N.pitchInRadians)*N.cameraToCenterDistance/N.worldSize;const E=N.getCoveringTilesDetailsProvider(),z=E.allowVariableZoom(N,o),B=cn(N,o),U=o.minzoom||0,G=o.maxzoom!==void 0?o.maxzoom:N.maxZoom,J=Math.min(Math.max(0,B),G),Y=Math.pow(2,J),ne=[Y*b.x,Y*b.y,0],fe=[Y*P.x,Y*P.y,0],je=Math.hypot(P.x-b.x,P.y-b.y),we=Math.abs(P.z-b.z),Se=Math.hypot(je,we),Te=Fe=>({zoom:0,x:0,y:0,wrap:Fe,fullyVisible:!1}),Le=[],ke=[];if(N.renderWorldCopies&&E.allowWorldCopies())for(let Fe=1;Fe<=3;Fe++)Le.push(Te(-Fe)),Le.push(Te(Fe));for(Le.push(Te(0));Le.length>0;){const Fe=Le.pop(),Be=Fe.x,De=Fe.y;let Ke=Fe.fullyVisible;const ht={x:Be,y:De,z:Fe.zoom},it=E.getTileBoundingVolume(ht,Fe.wrap,N.elevation,o);if(!Ke){const Mt=Qr(m,it,g);if(Mt===0)continue;Ke=Mt===2}const ot=E.distanceToTile2d(b.x,b.y,ht,it);let mt=B;z&&(mt=(o.calculateTileZoom||yr)(N.zoom+a.ao(N.tileSize/o.tileSize),ot,we,Se,N.fov)),mt=(o.roundZoom?Math.round:Math.floor)(mt),mt=Math.max(0,mt);const Tt=Math.min(mt,G);if(Fe.wrap=E.getWrap(P,ht,Fe.wrap),Fe.zoom>=Tt){if(Fe.zoom<U)continue;const Mt=J-Fe.zoom,bt=ne[0]-.5-(Be<<Mt),ir=ne[1]-.5-(De<<Mt),Wr=o.reparseOverscaled?Math.max(Fe.zoom,mt):Fe.zoom;ke.push({tileID:new a.a0(Fe.zoom===G?Wr:Fe.zoom,Fe.wrap,Fe.zoom,Be,De),distanceSq:a.ap([fe[0]-.5-Be,fe[1]-.5-De]),tileDistanceToCamera:Math.sqrt(bt*bt+ir*ir)})}else for(let Mt=0;Mt<4;Mt++)Le.push({zoom:Fe.zoom+1,x:(Be<<1)+Mt%2,y:(De<<1)+(Mt>>1),wrap:Fe.wrap,fullyVisible:Ke})}return ke.sort((Fe,Be)=>Fe.distanceSq-Be.distanceSq).map(Fe=>Fe.tileID)}const Xn=a.a6.fromPoints([new a.P(0,0),new a.P(a.a3,a.a3)]);class Mn extends a.E{constructor(o,m,g){super(),this.id=o,this.dispatcher=g,this.on("data",b=>this._dataHandler(b)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((b,P,E,z)=>{const B=new(Pn(P.type))(b,P,E,z);if(B.id!==b)throw new Error(`Expected Source id to be ${b} instead of ${B.id}`);return B})(o,m,g,this),this._tiles={},this._cache=new Ye(0,b=>this._unloadTile(b)),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new st,this._didEmitContent=!1,this._updated=!1}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._maxTileCacheZoomLevels=o?o._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const o in this._tiles){const m=this._tiles[o];if(m.state!=="loaded"&&m.state!=="errored")return!1}return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(o,m,g){return a._(this,void 0,void 0,function*(){try{yield this._source.loadTile(o),this._tileLoaded(o,m,g)}catch(b){o.state="errored",b.status!==404?this._source.fire(new a.k(b,{tile:o})):this.update(this.transform,this.terrain)}})}_unloadTile(o){this._source.unloadTile&&this._source.unloadTile(o)}_abortTile(o){this._source.abortTile&&this._source.abortTile(o),this._source.fire(new a.l("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const m in this._tiles){const g=this._tiles[m];g.upload(o),g.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(On).map(o=>o.key)}getRenderableIds(o){const m=[];for(const g in this._tiles)this._isIdRenderable(g,o)&&m.push(this._tiles[g]);return o?m.sort((g,b)=>{const P=g.tileID,E=b.tileID,z=new a.P(P.canonical.x,P.canonical.y)._rotate(-this.transform.bearingInRadians),B=new a.P(E.canonical.x,E.canonical.y)._rotate(-this.transform.bearingInRadians);return P.overscaledZ-E.overscaledZ||B.y-z.y||B.x-z.x}).map(g=>g.tileID.key):m.map(g=>g.tileID).sort(On).map(g=>g.key)}hasRenderableParent(o){const m=o.overscaledZ-1;if(m>=this._source.minzoom){const g=this.getLoadedTile(o.scaledTo(m));if(g)return this._isIdRenderable(g.tileID.key)}return!1}_isIdRenderable(o,m=!1){var g;return(g=this._tiles[o])===null||g===void 0?void 0:g.isRenderable(m)}reload(o,m=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const g in this._tiles)m&&this._source.shouldReloadTile&&!this._source.shouldReloadTile(this._tiles[g],m)||(o?this._reloadTile(g,"expired"):this._tiles[g].state!=="errored"&&this._reloadTile(g,"reloading"))}}_reloadTile(o,m){return a._(this,void 0,void 0,function*(){const g=this._tiles[o];g&&(g.state!=="loading"&&(g.state=m),yield this._loadTile(g,o,m))})}_tileLoaded(o,m,g){o.timeAdded=k(),o.selfFading&&(o.fadeEndTime=o.timeAdded+this._rasterFadeDuration),g==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(m,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new a.l("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const m=this.getRenderableIds();for(let b=0;b<m.length;b++){const P=m[b];if(o.neighboringTiles&&o.neighboringTiles[P]){const E=this.getTileByID(P);g(o,E),g(E,o)}}function g(b,P){b.needsHillshadePrepare=!0,b.needsTerrainPrepare=!0;let E=P.tileID.canonical.x-b.tileID.canonical.x;const z=P.tileID.canonical.y-b.tileID.canonical.y,B=Math.pow(2,b.tileID.canonical.z),U=P.tileID.key;E===0&&z===0||Math.abs(z)>1||(Math.abs(E)>1&&(Math.abs(E+B)===1?E+=B:Math.abs(E-B)===1&&(E-=B)),P.dem&&b.dem&&(b.dem.backfillBorder(P.dem,E,z),b.neighboringTiles&&b.neighboringTiles[U]&&(b.neighboringTiles[U].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,m){const g=Object.values(o),b=this._getLoadedDescendents(g),P={};for(const E of g){const z=b[E.key];if(!(z!=null&&z.length)){P[E.key]=E;continue}const B=E.overscaledZ+Mn.maxUnderzooming,U=z.filter(Y=>Y.tileID.overscaledZ<=B);if(!U.length){P[E.key]=E;continue}const G=Math.min(...U.map(Y=>Y.tileID.overscaledZ)),J=U.filter(Y=>Y.tileID.overscaledZ===G).map(Y=>Y.tileID);for(const Y of J)m[Y.key]=Y;this._areDescendentsComplete(J,G,E.overscaledZ)||(P[E.key]=E)}return P}_getLoadedDescendents(o){var m;const g={};for(const b in this._tiles){const P=this._tiles[b];if(P.hasData())for(const E of o)P.tileID.isChildOf(E)&&(g[m=E.key]||(g[m]=[])).push(P)}return g}_areDescendentsComplete(o,m,g){return o.length===1&&o[0].isOverscaled()?o[0].overscaledZ===m:Math.pow(4,m-g)===o.length}getLoadedTile(o){const m=this._tiles[o.key];return m!=null&&m.hasData()?m:null}updateCacheSize(o){const m=Math.ceil(o.width/this._source.tileSize)+1,g=Math.ceil(o.height/this._source.tileSize)+1,b=Math.floor(m*g*(this._maxTileCacheZoomLevels===null?a.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),P=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,b):b;this._cache.setMaxSize(P)}handleWrapJump(o){const m=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,m){const g={};for(const b in this._tiles){const P=this._tiles[b];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+m),g[P.tileID.key]=P}this._tiles=g,this._resetTileReloadTimers()}}update(o,m){if(!this._sourceLoaded||this._paused)return;let g;this.transform=o,this.terrain=m,this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?g=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(B=>new a.a0(B.canonical.z,B.wrap,B.canonical.z,B.canonical.x,B.canonical.y)):(g=Cn(o,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:m,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(g=g.filter(B=>this._source.hasTile(B)))):g=[],this.usedForTerrain&&(g=this._addTerrainIdealTiles(g));const b=g.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,b&&this.fire(new a.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const P=cn(o,this._source),E=this._updateRetainedTiles(g,P),z=An(this._source.type);z&&this._rasterFadeDuration>0&&!m&&this._updateFadingTiles(g,E),z?this._cleanUpRasterTiles(E):this._cleanUpVectorTiles(E)}_cleanUpRasterTiles(o){for(const m in this._tiles)o[m]||this._removeTile(m)}_cleanUpVectorTiles(o){for(const m in this._tiles){const g=this._tiles[m];o[m]?g.clearSymbolFadeHold():g.hasSymbolBuckets?g.holdingForSymbolFade()?g.symbolFadeFinished()&&this._removeTile(m):g.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(m)}}_addTerrainIdealTiles(o){const m=[];for(const g of o)if(g.canonical.z>this._source.minzoom){const b=g.scaledTo(g.canonical.z-1);m.push(b);const P=g.scaledTo(Math.max(this._source.minzoom,Math.min(g.canonical.z,5)));m.push(P)}return o.concat(m)}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForSymbolFade()&&this._removeTile(o)}_updateRetainedTiles(o,m){var g;const b={},P={},E=Math.max(m-Mn.maxOverzooming,this._source.minzoom);let z={};for(const B of o){const U=this._addTile(B);b[B.key]=B,U.hasData()||(z[B.key]=B)}z=this._retainLoadedChildren(z,b);for(const B in z){const U=z[B];let G=this._tiles[B],J=G==null?void 0:G.wasRequested();for(let Y=U.overscaledZ-1;Y>=E;--Y){const ne=U.scaledTo(Y);if(P[ne.key])break;if(P[ne.key]=!0,G=this.getTile(ne),!G&&J&&(G=this._addTile(ne)),G){const fe=G.hasData();if((fe||!(!((g=this.map)===null||g===void 0)&&g.cancelPendingTileRequestsWhileZooming)||J)&&(b[ne.key]=ne),J=G.wasRequested(),fe)break}}}return b}_updateFadingTiles(o,m){const g=k(),b=a.aq(o);for(const P of o){const E=this._tiles[P.key];E.fadingDirection!==Ae.Departing&&E.fadeOpacity!==0||E.resetFadeLogic(),this._updateFadingAncestor(E,m,g)||this._updateFadingDescendents(E,m,g)||this._updateFadingEdge(E,b,g)||E.resetFadeLogic()}}_updateFadingAncestor(o,m,g){if(!o.hasData())return!1;const{tileID:b,fadingRole:P,fadingDirection:E,fadingParentID:z}=o;if(P===ye.Base&&E===Ae.Incoming&&z)return m[z.key]=z,!0;const B=Math.max(b.overscaledZ-this._maxFadingAncestorLevels,this._source.minzoom);for(let U=b.overscaledZ-1;U>=B;U--){const G=b.scaledTo(U),J=this.getLoadedTile(G);if(J)return o.setCrossFadeLogic({fadingRole:ye.Base,fadingDirection:Ae.Incoming,fadingParentID:J.tileID,fadeEndTime:g+this._rasterFadeDuration}),J.setCrossFadeLogic({fadingRole:ye.Parent,fadingDirection:Ae.Departing,fadeEndTime:g+this._rasterFadeDuration}),m[G.key]=G,!0}return!1}_updateFadingDescendents(o,m,g){if(!o.hasData())return!1;const b=o.tileID.children(this._source.maxzoom);let P=this._updateFadingChildren(o,b,m,g);if(P)return!0;for(const E of b){const z=E.children(this._source.maxzoom);this._updateFadingChildren(o,z,m,g)&&(P=!0)}return P}_updateFadingChildren(o,m,g,b){if(m[0].overscaledZ>=this._source.maxzoom)return!1;let P=!1;for(const E of m){const z=this.getLoadedTile(E);if(!z)continue;const{fadingRole:B,fadingDirection:U,fadingParentID:G}=z;B===ye.Base&&U===Ae.Departing&&G||(z.setCrossFadeLogic({fadingRole:ye.Base,fadingDirection:Ae.Departing,fadingParentID:o.tileID,fadeEndTime:b+this._rasterFadeDuration}),o.setCrossFadeLogic({fadingRole:ye.Parent,fadingDirection:Ae.Incoming,fadeEndTime:b+this._rasterFadeDuration})),g[E.key]=E,P=!0}return P}_updateFadingEdge(o,m,g){const b=o.tileID;return!!o.selfFading||!o.hasData()&&!!m.has(b)&&(o.setSelfFadeLogic(g+this._rasterFadeDuration),!0)}_addTile(o){let m=this._tiles[o.key];if(m)return m;m=this._cache.getAndRemove(o),m&&(m.resetFadeLogic(),this._setTileReloadTimer(o.key,m),m.tileID=o,this._state.initializeTileState(m,this.map?this.map.painter:null));const g=m;return m||(m=new ze(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(m,o.key,m.state)),m.uses++,this._tiles[o.key]=m,g||this._source.fire(new a.l("dataloading",{tile:m,coord:m.tileID,dataType:"source"})),m}_setTileReloadTimer(o,m){this._clearTileReloadTimer(o);const g=m.getExpiryTimeout();g&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},g))}_clearTileReloadTimer(o){const m=this._timers[o];m&&(clearTimeout(m),delete this._timers[o])}_resetTileReloadTimers(){for(const o in this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(const o in this._tiles)this._setTileReloadTimer(o,this._tiles[o])}refreshTiles(o){for(const m in this._tiles)(this._isIdRenderable(m)||this._tiles[m].state=="errored")&&o.some(g=>g.equals(this._tiles[m].tileID.canonical))&&this._reloadTile(m,"expired")}_removeTile(o){const m=this._tiles[o];m&&(m.uses--,delete this._tiles[o],this._clearTileReloadTimer(o),m.uses>0||(m.hasData()&&m.state!=="reloading"?this._cache.add(m.tileID,m,m.getExpiryTimeout()):(m.aborted=!0,this._abortTile(m),this._unloadTile(m))))}_dataHandler(o){o.dataType==="source"&&(o.sourceDataType!=="metadata"?o.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(o.sourceDataChanged,o.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,m,g){const b=[],P=this.transform;if(!P)return b;const E=P.getCoveringTilesDetailsProvider().allowWorldCopies(),z=g?P.getCameraQueryGeometry(o):o,B=ne=>P.screenPointToMercatorCoordinate(ne,this.terrain),U=this.transformBbox(o,B,!E),G=this.transformBbox(z,B,!E),J=this.getIds(),Y=a.a6.fromPoints(G);for(let ne=0;ne<J.length;ne++){const fe=this._tiles[J[ne]];if(fe.holdingForSymbolFade())continue;const je=E?[fe.tileID]:[fe.tileID.unwrapTo(-1),fe.tileID.unwrapTo(0)],we=Math.pow(2,P.zoom-fe.tileID.overscaledZ),Se=m*fe.queryPadding*a.a3/fe.tileSize/we;for(const Te of je){const Le=Y.map(ke=>Te.getTilePoint(new a.a5(ke.x,ke.y)));if(Le.expandBy(Se),Le.intersects(Xn)){const ke=U.map(Be=>Te.getTilePoint(Be)),Fe=G.map(Be=>Te.getTilePoint(Be));b.push({tile:fe,tileID:E?Te:Te.unwrapTo(0),queryGeometry:ke,cameraQueryGeometry:Fe,scale:we})}}}return b}transformBbox(o,m,g){let b=o.map(m);if(g){const P=a.a6.fromPoints(o);P.shrinkBy(.001*Math.min(P.width(),P.height()));const E=P.map(m);a.a6.fromPoints(b).covers(E)||(b=b.map(z=>z.x>.5?new a.a5(z.x-1,z.y,z.z):z))}return b}getVisibleCoordinates(o){const m=this.getRenderableIds(o).map(g=>this._tiles[g].tileID);return this.transform&&this.transform.populateCache(m),m}hasTransition(){if(this._source.hasTransition())return!0;if(An(this._source.type)&&this._rasterFadeDuration>0){const o=k();for(const m in this._tiles)if(this._tiles[m].fadeEndTime>=o)return!0}return!1}setRasterFadeDuration(o){this._rasterFadeDuration=o}setFeatureState(o,m,g){this._state.updateState(o=o||"_geojsonTileLayer",m,g)}removeFeatureState(o,m,g){this._state.removeFeatureState(o=o||"_geojsonTileLayer",m,g)}getFeatureState(o,m){return this._state.getState(o=o||"_geojsonTileLayer",m)}setDependencies(o,m,g){const b=this._tiles[o];b&&b.setDependencies(m,g)}reloadTilesForDependencies(o,m){for(const g in this._tiles)this._tiles[g].hasDependency(o,m)&&this._reloadTile(g,"reloading");this._cache.filter(g=>!g.hasDependency(o,m))}}function On(N,o){const m=Math.abs(2*N.wrap)-+(N.wrap<0),g=Math.abs(2*o.wrap)-+(o.wrap<0);return N.overscaledZ-o.overscaledZ||g-m||o.canonical.y-N.canonical.y||o.canonical.x-N.canonical.x}function An(N){return N==="raster"||N==="image"||N==="video"}Mn.maxOverzooming=10,Mn.maxUnderzooming=3;class vi{constructor(o,m){this.reset(o,m)}reset(o,m){this.points=o||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=a.ai(o,0,1);let m=1,g=this._distances[m];const b=o*this.paddedLength+this.padding;for(;g<b&&m<this._distances.length;)g=this._distances[++m];const P=m-1,E=this._distances[P],z=g-E,B=z>0?(b-E)/z:0;return this.points[P].mult(1-B).add(this.points[m].mult(B))}}function jt(N,o){let m=!0;return N==="always"||N!=="never"&&o!=="never"||(m=!1),m}class $s{constructor(o,m,g){const b=this.boxCells=[],P=this.circleCells=[];this.xCellCount=Math.ceil(o/g),this.yCellCount=Math.ceil(m/g);for(let E=0;E<this.xCellCount*this.yCellCount;E++)b.push([]),P.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=m,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,m,g,b,P){this._forEachCell(m,g,b,P,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(m),this.bboxes.push(g),this.bboxes.push(b),this.bboxes.push(P)}insertCircle(o,m,g,b){this._forEachCell(m-b,g-b,m+b,g+b,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(m),this.circles.push(g),this.circles.push(b)}_insertBoxCell(o,m,g,b,P,E){this.boxCells[P].push(E)}_insertCircleCell(o,m,g,b,P,E){this.circleCells[P].push(E)}_query(o,m,g,b,P,E,z){if(g<0||o>this.width||b<0||m>this.height)return[];const B=[];if(o<=0&&m<=0&&this.width<=g&&this.height<=b){if(P)return[{key:null,x1:o,y1:m,x2:g,y2:b}];for(let U=0;U<this.boxKeys.length;U++)B.push({key:this.boxKeys[U],x1:this.bboxes[4*U],y1:this.bboxes[4*U+1],x2:this.bboxes[4*U+2],y2:this.bboxes[4*U+3]});for(let U=0;U<this.circleKeys.length;U++){const G=this.circles[3*U],J=this.circles[3*U+1],Y=this.circles[3*U+2];B.push({key:this.circleKeys[U],x1:G-Y,y1:J-Y,x2:G+Y,y2:J+Y})}}else this._forEachCell(o,m,g,b,this._queryCell,B,{hitTest:P,overlapMode:E,seenUids:{box:{},circle:{}}},z);return B}query(o,m,g,b){return this._query(o,m,g,b,!1,null)}hitTest(o,m,g,b,P,E){return this._query(o,m,g,b,!0,P,E).length>0}hitTestCircle(o,m,g,b,P){const E=o-g,z=o+g,B=m-g,U=m+g;if(z<0||E>this.width||U<0||B>this.height)return!1;const G=[];return this._forEachCell(E,B,z,U,this._queryCellCircle,G,{hitTest:!0,overlapMode:b,circle:{x:o,y:m,radius:g},seenUids:{box:{},circle:{}}},P),G.length>0}_queryCell(o,m,g,b,P,E,z,B){const{seenUids:U,hitTest:G,overlapMode:J}=z,Y=this.boxCells[P];if(Y!==null){const fe=this.bboxes;for(const je of Y)if(!U.box[je]){U.box[je]=!0;const we=4*je,Se=this.boxKeys[je];if(o<=fe[we+2]&&m<=fe[we+3]&&g>=fe[we+0]&&b>=fe[we+1]&&(!B||B(Se))&&(!G||!jt(J,Se.overlapMode))&&(E.push({key:Se,x1:fe[we],y1:fe[we+1],x2:fe[we+2],y2:fe[we+3]}),G))return!0}}const ne=this.circleCells[P];if(ne!==null){const fe=this.circles;for(const je of ne)if(!U.circle[je]){U.circle[je]=!0;const we=3*je,Se=this.circleKeys[je];if(this._circleAndRectCollide(fe[we],fe[we+1],fe[we+2],o,m,g,b)&&(!B||B(Se))&&(!G||!jt(J,Se.overlapMode))){const Te=fe[we],Le=fe[we+1],ke=fe[we+2];if(E.push({key:Se,x1:Te-ke,y1:Le-ke,x2:Te+ke,y2:Le+ke}),G)return!0}}}return!1}_queryCellCircle(o,m,g,b,P,E,z,B){const{circle:U,seenUids:G,overlapMode:J}=z,Y=this.boxCells[P];if(Y!==null){const fe=this.bboxes;for(const je of Y)if(!G.box[je]){G.box[je]=!0;const we=4*je,Se=this.boxKeys[je];if(this._circleAndRectCollide(U.x,U.y,U.radius,fe[we+0],fe[we+1],fe[we+2],fe[we+3])&&(!B||B(Se))&&!jt(J,Se.overlapMode))return E.push(!0),!0}}const ne=this.circleCells[P];if(ne!==null){const fe=this.circles;for(const je of ne)if(!G.circle[je]){G.circle[je]=!0;const we=3*je,Se=this.circleKeys[je];if(this._circlesCollide(fe[we],fe[we+1],fe[we+2],U.x,U.y,U.radius)&&(!B||B(Se))&&!jt(J,Se.overlapMode))return E.push(!0),!0}}}_forEachCell(o,m,g,b,P,E,z,B){const U=this._convertToXCellCoord(o),G=this._convertToYCellCoord(m),J=this._convertToXCellCoord(g),Y=this._convertToYCellCoord(b);for(let ne=U;ne<=J;ne++)for(let fe=G;fe<=Y;fe++)if(P.call(this,o,m,g,b,this.xCellCount*fe+ne,E,z,B))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,m,g,b,P,E){const z=b-o,B=P-m,U=g+E;return U*U>z*z+B*B}_circleAndRectCollide(o,m,g,b,P,E,z){const B=(E-b)/2,U=Math.abs(o-(b+B));if(U>B+g)return!1;const G=(z-P)/2,J=Math.abs(m-(P+G));if(J>G+g)return!1;if(U<=B||J<=G)return!0;const Y=U-B,ne=J-G;return Y*Y+ne*ne<=g*g}}function ya(N,o,m){const g=a.M();if(!N){const{vecSouth:J,vecEast:Y}=qi(o),ne=p();ne[0]=Y[0],ne[1]=Y[1],ne[2]=J[0],ne[3]=J[1],b=ne,(G=(E=(P=ne)[0])*(U=P[3])-(B=P[2])*(z=P[1]))&&(b[0]=U*(G=1/G),b[1]=-z*G,b[2]=-B*G,b[3]=E*G),g[0]=ne[0],g[1]=ne[1],g[4]=ne[2],g[5]=ne[3]}var b,P,E,z,B,U,G;return a.O(g,g,[1/m,1/m,1]),g}function zu(N,o,m,g){if(N){const b=a.M();if(!o){const{vecSouth:P,vecEast:E}=qi(m);b[0]=E[0],b[1]=E[1],b[4]=P[0],b[5]=P[1]}return a.O(b,b,[g,g,1]),b}return m.pixelsToClipSpaceMatrix}function qi(N){const o=Math.cos(N.rollInRadians),m=Math.sin(N.rollInRadians),g=Math.cos(N.pitchInRadians),b=Math.cos(N.bearingInRadians),P=Math.sin(N.bearingInRadians),E=a.av();E[0]=-b*g*m-P*o,E[1]=-P*g*m+b*o;const z=a.aw(E);z<1e-9?a.ax(E):a.ay(E,E,1/z);const B=a.av();B[0]=b*g*o-P*m,B[1]=P*g*o+b*m;const U=a.aw(B);return U<1e-9?a.ax(B):a.ay(B,B,1/U),{vecEast:B,vecSouth:E}}function qt(N,o,m,g){let b;g?(b=[N,o,g(N,o),1],a.aA(b,b,m)):(b=[N,o,0,1],wd(b,b,m));const P=b[3];return{point:new a.P(b[0]/P,b[1]/P),signedDistanceFromCamera:P,isOccluded:!1}}function Kr(N,o){return .5+N/o*.5}function rn(N,o){return N.x>=-o[0]&&N.x<=o[0]&&N.y>=-o[1]&&N.y<=o[1]}function Lo(N,o,m,g,b,P,E,z,B,U,G,J,Y){const ne=m?N.textSizeData:N.iconSizeData,fe=a.ar(ne,o.transform.zoom),je=[256/o.width*2+1,256/o.height*2+1],we=m?N.text.dynamicLayoutVertexArray:N.icon.dynamicLayoutVertexArray;we.clear();const Se=N.lineVertexArray,Te=m?N.text.placedSymbolArray:N.icon.placedSymbolArray,Le=o.transform.width/o.transform.height;let ke=!1;for(let Fe=0;Fe<Te.length;Fe++){const Be=Te.get(Fe);if(Be.hidden||Be.writingMode===a.as.vertical&&!ke){$u(Be.numGlyphs,we);continue}ke=!1;const De=new a.P(Be.anchorX,Be.anchorY),Ke={getElevation:Y,pitchedLabelPlaneMatrix:g,lineVertexArray:Se,pitchWithMap:P,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:o.transform,tileAnchorPoint:De,unwrappedTileID:B,width:U,height:G,translation:J},ht=Em(Be.anchorX,Be.anchorY,Ke);if(!rn(ht.point,je)){$u(Be.numGlyphs,we);continue}const it=Kr(o.transform.cameraToCenterDistance,ht.signedDistanceFromCamera),ot=a.at(ne,fe,Be),mt=P?ot*o.transform.getPitchedTextCorrection(Be.anchorX,Be.anchorY,B)/it:ot*it,Tt=Xr({projectionContext:Ke,pitchedLabelPlaneMatrixInverse:b,symbol:Be,fontSize:mt,flip:!1,keepUpright:E,glyphOffsetArray:N.glyphOffsetArray,dynamicLayoutVertexArray:we,aspectRatio:Le,rotateToLine:z});ke=Tt.useVertical,(Tt.notEnoughRoom||ke||Tt.needsFlipping&&Xr({projectionContext:Ke,pitchedLabelPlaneMatrixInverse:b,symbol:Be,fontSize:mt,flip:!0,keepUpright:E,glyphOffsetArray:N.glyphOffsetArray,dynamicLayoutVertexArray:we,aspectRatio:Le,rotateToLine:z}).notEnoughRoom)&&$u(Be.numGlyphs,we)}m?N.text.dynamicLayoutVertexBuffer.updateData(we):N.icon.dynamicLayoutVertexBuffer.updateData(we)}function km(N,o,m,g,b,P,E,z){const B=P.glyphStartIndex+P.numGlyphs,U=P.lineStartIndex,G=P.lineStartIndex+P.lineLength,J=o.getoffsetX(P.glyphStartIndex),Y=o.getoffsetX(B-1),ne=na(N*J,m,g,b,P.segment,U,G,z,E);if(!ne)return null;const fe=na(N*Y,m,g,b,P.segment,U,G,z,E);return fe?z.projectionCache.anyProjectionOccluded?null:{first:ne,last:fe}:null}function Oc(N,o,m,g){return N===a.as.horizontal&&Math.abs(m.y-o.y)>Math.abs(m.x-o.x)*g?{useVertical:!0}:(N===a.as.vertical?o.y<m.y:o.x>m.x)?{needsFlipping:!0}:null}function Xr(N){const{projectionContext:o,pitchedLabelPlaneMatrixInverse:m,symbol:g,fontSize:b,flip:P,keepUpright:E,glyphOffsetArray:z,dynamicLayoutVertexArray:B,aspectRatio:U,rotateToLine:G}=N,J=b/24,Y=g.lineOffsetX*J,ne=g.lineOffsetY*J;let fe;if(g.numGlyphs>1){const je=g.glyphStartIndex+g.numGlyphs,we=g.lineStartIndex,Se=g.lineStartIndex+g.lineLength,Te=km(J,z,Y,ne,P,g,G,o);if(!Te)return{notEnoughRoom:!0};const Le=Ic(Te.first.point.x,Te.first.point.y,o,m),ke=Ic(Te.last.point.x,Te.last.point.y,o,m);if(E&&!P){const Fe=Oc(g.writingMode,Le,ke,U);if(Fe)return Fe}fe=[Te.first];for(let Fe=g.glyphStartIndex+1;Fe<je-1;Fe++){const Be=na(J*z.getoffsetX(Fe),Y,ne,P,g.segment,we,Se,o,G);if(!Be)return{notEnoughRoom:!0};fe.push(Be)}fe.push(Te.last)}else{if(E&&!P){const we=hl(o.tileAnchorPoint.x,o.tileAnchorPoint.y,o).point,Se=g.lineStartIndex+g.segment+1,Te=new a.P(o.lineVertexArray.getx(Se),o.lineVertexArray.gety(Se)),Le=hl(Te.x,Te.y,o),ke=Le.signedDistanceFromCamera>0?Le.point:Tm(o.tileAnchorPoint,Te,we,1,o),Fe=Ic(we.x,we.y,o,m),Be=Ic(ke.x,ke.y,o,m),De=Oc(g.writingMode,Fe,Be,U);if(De)return De}const je=na(J*z.getoffsetX(g.glyphStartIndex),Y,ne,P,g.segment,g.lineStartIndex,g.lineStartIndex+g.lineLength,o,G);if(!je||o.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};fe=[je]}for(const je of fe)a.az(B,je.point,je.angle);return{}}function Tm(N,o,m,g,b){const P=N.add(N.sub(o)._unit()),E=hl(P.x,P.y,b).point,z=m.sub(E);return m.add(z._mult(g/z.mag()))}function bd(N,o,m){const g=o.projectionCache;if(g.projections[N])return g.projections[N];const b=new a.P(o.lineVertexArray.getx(N),o.lineVertexArray.gety(N)),P=hl(b.x,b.y,o);if(P.signedDistanceFromCamera>0)return g.projections[N]=P.point,g.anyProjectionOccluded=g.anyProjectionOccluded||P.isOccluded,P.point;const E=N-m.direction;return Tm(m.distanceFromAnchor===0?o.tileAnchorPoint:new a.P(o.lineVertexArray.getx(E),o.lineVertexArray.gety(E)),b,m.previousVertex,m.absOffsetX-m.distanceFromAnchor+1,o)}function hl(N,o,m){const g=N+m.translation[0],b=o+m.translation[1];let P;return m.pitchWithMap?(P=qt(g,b,m.pitchedLabelPlaneMatrix,m.getElevation),P.isOccluded=!1):(P=m.transform.projectTileCoordinates(g,b,m.unwrappedTileID,m.getElevation),P.point.x=(.5*P.point.x+.5)*m.width,P.point.y=(.5*-P.point.y+.5)*m.height),P}function Ic(N,o,m,g){if(m.pitchWithMap){const b=[N,o,0,1];return a.aA(b,b,g),m.transform.projectTileCoordinates(b[0]/b[3],b[1]/b[3],m.unwrappedTileID,m.getElevation).point}return{x:N/m.width*2-1,y:1-o/m.height*2}}function Em(N,o,m){return m.transform.projectTileCoordinates(N,o,m.unwrappedTileID,m.getElevation)}function jd(N,o,m){return N._unit()._perp()._mult(o*m)}function jp(N,o,m,g,b,P,E,z,B){if(z.projectionCache.offsets[N])return z.projectionCache.offsets[N];const U=m.add(o);if(N+B.direction<g||N+B.direction>=b)return z.projectionCache.offsets[N]=U,U;const G=bd(N+B.direction,z,B),J=jd(G.sub(m),E,B.direction),Y=m.add(J),ne=G.add(J);return z.projectionCache.offsets[N]=a.aB(P,U,Y,ne)||U,z.projectionCache.offsets[N]}function na(N,o,m,g,b,P,E,z,B){const U=g?N-o:N+o;let G=U>0?1:-1,J=0;g&&(G*=-1,J=Math.PI),G<0&&(J+=Math.PI);let Y,ne=G>0?P+b:P+b+1;z.projectionCache.cachedAnchorPoint?Y=z.projectionCache.cachedAnchorPoint:(Y=hl(z.tileAnchorPoint.x,z.tileAnchorPoint.y,z).point,z.projectionCache.cachedAnchorPoint=Y);let fe,je,we=Y,Se=Y,Te=0,Le=0;const ke=Math.abs(U),Fe=[];let Be;for(;Te+Le<=ke;){if(ne+=G,ne<P||ne>=E)return null;Te+=Le,Se=we,je=fe;const ht={absOffsetX:ke,direction:G,distanceFromAnchor:Te,previousVertex:Se};if(we=bd(ne,z,ht),m===0)Fe.push(Se),Be=we.sub(Se);else{let it;const ot=we.sub(Se);it=ot.mag()===0?jd(bd(ne+G,z,ht).sub(we),m,G):jd(ot,m,G),je||(je=Se.add(it)),fe=jp(ne,it,we,P,E,je,m,z,ht),Fe.push(je),Be=fe.sub(je)}Le=Be.mag()}const De=Be._mult((ke-Te)/Le)._add(je||Se),Ke=J+Math.atan2(we.y-Se.y,we.x-Se.x);return Fe.push(De),{point:De,angle:B?Ke:0,path:Fe}}const gs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function $u(N,o){for(let m=0;m<N;m++){const g=o.length;o.resize(g+4),o.float32.set(gs,3*g)}}function wd(N,o,m){const g=o[0],b=o[1];return N[0]=m[0]*g+m[4]*b+m[12],N[1]=m[1]*g+m[5]*b+m[13],N[3]=m[3]*g+m[7]*b+m[15],N}const ui=100;class Nd{constructor(o,m=new $s(o.width+200,o.height+200,25),g=new $s(o.width+200,o.height+200,25)){this.transform=o,this.grid=m,this.ignoredGrid=g,this.pitchFactor=Math.cos(o.pitch*Math.PI/180)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+ui,this.screenBottomBoundary=o.height+ui,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(o,m,g,b,P,E,z,B,U,G,J,Y){const ne=this.projectAndGetPerspectiveRatio(o.anchorPointX+B[0],o.anchorPointY+B[1],P,G,Y),fe=g*ne.perspectiveRatio;let je;if(E||z)je=this._projectCollisionBox(o,fe,b,P,E,z,B,ne,G,J,Y);else{const Be=ne.x+(J?J.x*fe:0),De=ne.y+(J?J.y*fe:0);je={allPointsOccluded:!1,box:[Be+o.x1*fe,De+o.y1*fe,Be+o.x2*fe,De+o.y2*fe]}}const[we,Se,Te,Le]=je.box,ke=E?je.allPointsOccluded:ne.isOccluded;let Fe=ke;return Fe||(Fe=ne.perspectiveRatio<this.perspectiveRatioCutoff),Fe||(Fe=!this.isInsideGrid(we,Se,Te,Le)),Fe||m!=="always"&&this.grid.hitTest(we,Se,Te,Le,m,U)?{box:[we,Se,Te,Le],placeable:!1,offscreen:!1,occluded:ke}:{box:[we,Se,Te,Le],placeable:!0,offscreen:this.isOffscreen(we,Se,Te,Le),occluded:ke}}placeCollisionCircles(o,m,g,b,P,E,z,B,U,G,J,Y,ne,fe){const je=[],we=new a.P(m.anchorX,m.anchorY),Se=this.getPerspectiveRatio(we.x,we.y,E,fe),Te=(U?P*this.transform.getPitchedTextCorrection(m.anchorX,m.anchorY,E)/Se:P*Se)/a.aF,Le={getElevation:fe,pitchedLabelPlaneMatrix:z,lineVertexArray:g,pitchWithMap:U,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:we,unwrappedTileID:E,width:this.transform.width,height:this.transform.height,translation:ne},ke=km(Te,b,m.lineOffsetX*Te,m.lineOffsetY*Te,!1,m,!1,Le);let Fe=!1,Be=!1,De=!0;if(ke){const Ke=.5*J*Se+Y,ht=new a.P(-100,-100),it=new a.P(this.screenRightBoundary,this.screenBottomBoundary),ot=new vi,mt=ke.first,Tt=ke.last;let Mt=[];for(let Wr=mt.path.length-1;Wr>=1;Wr--)Mt.push(mt.path[Wr]);for(let Wr=1;Wr<Tt.path.length;Wr++)Mt.push(Tt.path[Wr]);const bt=2.5*Ke;if(U){const Wr=this.projectPathToScreenSpace(Mt,Le);Mt=Wr.some(Rn=>Rn.signedDistanceFromCamera<=0)?[]:Wr.map(Rn=>Rn.point)}let ir=[];if(Mt.length>0){const Wr=Mt[0].clone(),Rn=Mt[0].clone();for(let Hr=1;Hr<Mt.length;Hr++)Wr.x=Math.min(Wr.x,Mt[Hr].x),Wr.y=Math.min(Wr.y,Mt[Hr].y),Rn.x=Math.max(Rn.x,Mt[Hr].x),Rn.y=Math.max(Rn.y,Mt[Hr].y);ir=Wr.x>=ht.x&&Rn.x<=it.x&&Wr.y>=ht.y&&Rn.y<=it.y?[Mt]:Rn.x<ht.x||Wr.x>it.x||Rn.y<ht.y||Wr.y>it.y?[]:a.aC([Mt],ht.x,ht.y,it.x,it.y)}for(const Wr of ir){ot.reset(Wr,.25*Ke);let Rn=0;Rn=ot.length<=.5*Ke?1:Math.ceil(ot.paddedLength/bt)+1;for(let Hr=0;Hr<Rn;Hr++){const Kn=Hr/Math.max(Rn-1,1),_s=ot.lerp(Kn),Qn=_s.x+ui,hi=_s.y+ui;je.push(Qn,hi,Ke,0);const ls=Qn-Ke,Ai=hi-Ke,cs=Qn+Ke,Js=hi+Ke;if(De=De&&this.isOffscreen(ls,Ai,cs,Js),Be=Be||this.isInsideGrid(ls,Ai,cs,Js),o!=="always"&&this.grid.hitTestCircle(Qn,hi,Ke,o,G)&&(Fe=!0,!B))return{circles:[],offscreen:!1,collisionDetected:Fe}}}}return{circles:!B&&Fe||!Be||Se<this.perspectiveRatioCutoff?[]:je,offscreen:De,collisionDetected:Fe}}projectPathToScreenSpace(o,m){const g=function(b,P){const E=a.M();return a.au(E,P.pitchedLabelPlaneMatrix),b.map(z=>{const B=qt(z.x,z.y,E,P.getElevation),U=P.transform.projectTileCoordinates(B.point.x,B.point.y,P.unwrappedTileID,P.getElevation);return U.point.x=(.5*U.point.x+.5)*P.width,U.point.y=(.5*-U.point.y+.5)*P.height,U})}(o,m);return function(b){let P=0,E=0,z=0,B=0;for(let U=0;U<b.length;U++)b[U].isOccluded?(z=U+1,B=0):(B++,B>E&&(E=B,P=z));return b.slice(P,P+E)}(g)}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const m=[],g=new a.a6;for(const J of o){const Y=new a.P(J.x+ui,J.y+ui);g.extend(Y),m.push(Y)}const{minX:b,minY:P,maxX:E,maxY:z}=g,B=this.grid.query(b,P,E,z).concat(this.ignoredGrid.query(b,P,E,z)),U={},G={};for(const J of B){const Y=J.key;if(U[Y.bucketInstanceId]===void 0&&(U[Y.bucketInstanceId]={}),U[Y.bucketInstanceId][Y.featureIndex])continue;const ne=[new a.P(J.x1,J.y1),new a.P(J.x2,J.y1),new a.P(J.x2,J.y2),new a.P(J.x1,J.y2)];a.aD(m,ne)&&(U[Y.bucketInstanceId][Y.featureIndex]=!0,G[Y.bucketInstanceId]===void 0&&(G[Y.bucketInstanceId]=[]),G[Y.bucketInstanceId].push(Y.featureIndex))}return G}insertCollisionBox(o,m,g,b,P,E){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:b,featureIndex:P,collisionGroupID:E,overlapMode:m},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,m,g,b,P,E){const z=g?this.ignoredGrid:this.grid,B={bucketInstanceId:b,featureIndex:P,collisionGroupID:E,overlapMode:m};for(let U=0;U<o.length;U+=4)z.insertCircle(B,o[U],o[U+1],o[U+2])}projectAndGetPerspectiveRatio(o,m,g,b,P){if(P){let E;b?(E=[o,m,b(o,m),1],a.aA(E,E,P)):(E=[o,m,0,1],wd(E,E,P));const z=E[3];return{x:(E[0]/z+1)/2*this.transform.width+ui,y:(-E[1]/z+1)/2*this.transform.height+ui,perspectiveRatio:.5+this.transform.cameraToCenterDistance/z*.5,isOccluded:!1,signedDistanceFromCamera:z}}{const E=this.transform.projectTileCoordinates(o,m,g,b);return{x:(E.point.x+1)/2*this.transform.width+ui,y:(1-E.point.y)/2*this.transform.height+ui,perspectiveRatio:.5+this.transform.cameraToCenterDistance/E.signedDistanceFromCamera*.5,isOccluded:E.isOccluded,signedDistanceFromCamera:E.signedDistanceFromCamera}}}getPerspectiveRatio(o,m,g,b){const P=this.transform.projectTileCoordinates(o,m,g,b);return .5+this.transform.cameraToCenterDistance/P.signedDistanceFromCamera*.5}isOffscreen(o,m,g,b){return g<ui||o>=this.screenRightBoundary||b<ui||m>this.screenBottomBoundary}isInsideGrid(o,m,g,b){return g>=0&&o<this.gridRightBoundary&&b>=0&&m<this.gridBottomBoundary}getViewportMatrix(){const o=a.am([]);return a.N(o,o,[-100,-100,0]),o}_projectCollisionBox(o,m,g,b,P,E,z,B,U,G,J){let Y=1,ne=0,fe=0,je=1;const we=o.anchorPointX+z[0],Se=o.anchorPointY+z[1];if(E&&!P){const Mt=this.projectAndGetPerspectiveRatio(we+1,Se,b,U,J),bt=Mt.x-B.x,ir=Math.atan((Mt.y-B.y)/bt)+(bt<0?Math.PI:0),Wr=Math.sin(ir),Rn=Math.cos(ir);Y=Rn,ne=Wr,fe=-Wr,je=Rn}else if(!E&&P){const Mt=qi(this.transform);Y=Mt.vecEast[0],ne=Mt.vecEast[1],fe=Mt.vecSouth[0],je=Mt.vecSouth[1]}let Te=B.x,Le=B.y,ke=m;P&&(Te=we,Le=Se,ke=Math.pow(2,-(this.transform.zoom-g.overscaledZ)),ke*=this.transform.getPitchedTextCorrection(we,Se,b),G||(ke*=a.ai(.5+B.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),G&&(Te+=Y*G.x*ke+fe*G.y*ke,Le+=ne*G.x*ke+je*G.y*ke);const Fe=o.x1*ke,Be=o.x2*ke,De=(Fe+Be)/2,Ke=o.y1*ke,ht=o.y2*ke,it=(Ke+ht)/2,ot=[{offsetX:Fe,offsetY:Ke},{offsetX:De,offsetY:Ke},{offsetX:Be,offsetY:Ke},{offsetX:Be,offsetY:it},{offsetX:Be,offsetY:ht},{offsetX:De,offsetY:ht},{offsetX:Fe,offsetY:ht},{offsetX:Fe,offsetY:it}];let mt=[];for(const{offsetX:Mt,offsetY:bt}of ot)mt.push(new a.P(Te+Y*Mt+fe*bt,Le+ne*Mt+je*bt));let Tt=!1;if(P){const Mt=mt.map(bt=>this.projectAndGetPerspectiveRatio(bt.x,bt.y,b,U,J));Tt=Mt.some(bt=>!bt.isOccluded),mt=Mt.map(bt=>new a.P(bt.x,bt.y))}else Tt=!0;return{box:a.aE(mt),allPointsOccluded:!Tt}}}class Ul{constructor(o,m,g,b){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?m:-m))):b&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class Bu{constructor(o,m,g,b,P){this.text=new Ul(o?o.text:null,m,g,P),this.icon=new Ul(o?o.icon:null,m,b,P)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class av{constructor(o,m,g){this.text=o,this.icon=m,this.skipFade=g}}class hj{constructor(o,m,g,b,P){this.bucketInstanceId=o,this.featureIndex=m,this.sourceLayerIndex=g,this.bucketIndex=b,this.tileID=P}}class qu{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const m=++this.maxGroupID;this.collisionGroups[o]={ID:m,predicate:g=>g.collisionGroupID===m}}return this.collisionGroups[o]}}function ov(N,o,m,g,b){const{horizontalAlign:P,verticalAlign:E}=a.aL(N);return new a.P(-(P-.5)*o+g[0]*b,-(E-.5)*m+g[1]*b)}class BP{constructor(o,m,g,b,P){this.transform=o.clone(),this.terrain=m,this.collisionIndex=new Nd(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new qu(b),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=P,P&&(P.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(o){const m=this.terrain;return m?(g,b)=>m.getElevation(o,g,b):null}getBucketParts(o,m,g,b){const P=g.getBucket(m),E=g.latestFeatureIndex;if(!P||!E||m.id!==P.layerIds[0])return;const z=g.collisionBoxArray,B=P.layers[0].layout,U=P.layers[0].paint,G=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),J=g.tileSize/a.a3,Y=g.tileID.toUnwrapped(),ne=B.get("text-rotation-alignment")==="map",fe=a.aG(g,1,this.transform.zoom),je=a.aH(this.collisionIndex.transform,g,U.get("text-translate"),U.get("text-translate-anchor")),we=a.aH(this.collisionIndex.transform,g,U.get("icon-translate"),U.get("icon-translate-anchor")),Se=ya(ne,this.transform,fe);this.retainedQueryData[P.bucketInstanceId]=new hj(P.bucketInstanceId,E,P.sourceLayerIndex,P.index,g.tileID);const Te={bucket:P,layout:B,translationText:je,translationIcon:we,unwrappedTileID:Y,pitchedLabelPlaneMatrix:Se,scale:G,textPixelRatio:J,holdingForFade:g.holdingForSymbolFade(),collisionBoxArray:z,partiallyEvaluatedTextSize:a.ar(P.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(P.sourceID)};if(b)for(const Le of P.sortKeyRanges){const{sortKey:ke,symbolInstanceStart:Fe,symbolInstanceEnd:Be}=Le;o.push({sortKey:ke,symbolInstanceStart:Fe,symbolInstanceEnd:Be,parameters:Te})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:P.symbolInstances.length,parameters:Te})}attemptAnchorPlacement(o,m,g,b,P,E,z,B,U,G,J,Y,ne,fe,je,we,Se,Te,Le,ke){const Fe=a.aI[o.textAnchor],Be=[o.textOffset0,o.textOffset1],De=ov(Fe,g,b,Be,P),Ke=this.collisionIndex.placeCollisionBox(m,Y,B,U,G,z,E,we,J.predicate,Le,De,ke);if((!Te||this.collisionIndex.placeCollisionBox(Te,Y,B,U,G,z,E,Se,J.predicate,Le,De,ke).placeable)&&Ke.placeable){let ht;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ne.crossTileID]&&this.prevPlacement.placements[ne.crossTileID]&&this.prevPlacement.placements[ne.crossTileID].text&&(ht=this.prevPlacement.variableOffsets[ne.crossTileID].anchor),ne.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ne.crossTileID]={textOffset:Be,width:g,height:b,anchor:Fe,textBoxScale:P,prevAnchor:ht},this.markUsedJustification(fe,Fe,ne,je),fe.allowVerticalPlacement&&(this.markUsedOrientation(fe,je,ne),this.placedOrientations[ne.crossTileID]=je),{shift:De,placedGlyphBoxes:Ke}}}placeLayerBucketPart(o,m,g){const{bucket:b,layout:P,translationText:E,translationIcon:z,unwrappedTileID:B,pitchedLabelPlaneMatrix:U,textPixelRatio:G,holdingForFade:J,collisionBoxArray:Y,partiallyEvaluatedTextSize:ne,collisionGroup:fe}=o.parameters,je=P.get("text-optional"),we=P.get("icon-optional"),Se=a.aJ(P,"text-overlap","text-allow-overlap"),Te=Se==="always",Le=a.aJ(P,"icon-overlap","icon-allow-overlap"),ke=Le==="always",Fe=P.get("text-rotation-alignment")==="map",Be=P.get("text-pitch-alignment")==="map",De=P.get("icon-text-fit")!=="none",Ke=P.get("symbol-z-order")==="viewport-y",ht=Te&&(ke||!b.hasIconData()||we),it=ke&&(Te||!b.hasTextData()||je);!b.collisionArrays&&Y&&b.deserializeCollisionBoxes(Y);const ot=this.retainedQueryData[b.bucketInstanceId].tileID,mt=this._getTerrainElevationFunc(ot),Tt=this.transform.getFastPathSimpleProjectionMatrix(ot),Mt=(bt,ir,Wr)=>{var Rn,Hr;if(m[bt.crossTileID])return;if(J)return void(this.placements[bt.crossTileID]=new av(!1,!1,!1));let Kn=!1,_s=!1,Qn=!0,hi=null,ls={box:null,placeable:!1,offscreen:null,occluded:!1},Ai={placeable:!1},cs=null,Js=null,ja=null,Bd=0,Jl=0,gl=0;ir.textFeatureIndex?Bd=ir.textFeatureIndex:bt.useRuntimeCollisionCircles&&(Bd=bt.featureIndex),ir.verticalTextFeatureIndex&&(Jl=ir.verticalTextFeatureIndex);const qd=ir.textBox;if(qd){const wa=ei=>{let Vs=a.as.horizontal;if(b.allowVerticalPlacement&&!ei&&this.prevPlacement){const ki=this.prevPlacement.placedOrientations[bt.crossTileID];ki&&(this.placedOrientations[bt.crossTileID]=ki,Vs=ki,this.markUsedOrientation(b,Vs,bt))}return Vs},ec=(ei,Vs)=>{if(b.allowVerticalPlacement&&bt.numVerticalGlyphVertices>0&&ir.verticalTextBox){for(const ki of b.writingModes)if(ki===a.as.vertical?(ls=Vs(),Ai=ls):ls=ei(),ls&&ls.placeable)break}else ls=ei()},$c=bt.textAnchorOffsetStartIndex,af=bt.textAnchorOffsetEndIndex;if(af===$c){const ei=(Vs,ki)=>{const is=this.collisionIndex.placeCollisionBox(Vs,Se,G,ot,B,Be,Fe,E,fe.predicate,mt,void 0,Tt);return is&&is.placeable&&(this.markUsedOrientation(b,ki,bt),this.placedOrientations[bt.crossTileID]=ki),is};ec(()=>ei(qd,a.as.horizontal),()=>{const Vs=ir.verticalTextBox;return b.allowVerticalPlacement&&bt.numVerticalGlyphVertices>0&&Vs?ei(Vs,a.as.vertical):{box:null,offscreen:null}}),wa(ls&&ls.placeable)}else{let ei=a.aI[(Hr=(Rn=this.prevPlacement)===null||Rn===void 0?void 0:Rn.variableOffsets[bt.crossTileID])===null||Hr===void 0?void 0:Hr.anchor];const Vs=(is,Bo,Bc)=>{const fw=is.x2-is.x1,pw=is.y2-is.y1,xw=bt.textBoxScale,Ud=De&&Le==="never"?Bo:null;let Wd=null,e0=Se==="never"?1:2,lx="never";ei&&e0++;for(let t0=0;t0<e0;t0++){for(let tc=$c;tc<af;tc++){const qc=b.textAnchorOffsets.get(tc);if(ei&&qc.textAnchor!==ei)continue;const cx=this.attemptAnchorPlacement(qc,is,fw,pw,xw,Fe,Be,G,ot,B,fe,lx,bt,b,Bc,E,z,Ud,mt);if(cx&&(Wd=cx.placedGlyphBoxes,Wd&&Wd.placeable))return Kn=!0,hi=cx.shift,Wd}ei?ei=null:lx=Se}return g&&!Wd&&(Wd={box:this.collisionIndex.placeCollisionBox(qd,"always",G,ot,B,Be,Fe,E,fe.predicate,mt,void 0,Tt).box,offscreen:!1,placeable:!1,occluded:!1}),Wd};ec(()=>Vs(qd,ir.iconBox,a.as.horizontal),()=>{const is=ir.verticalTextBox;return b.allowVerticalPlacement&&(!ls||!ls.placeable)&&bt.numVerticalGlyphVertices>0&&is?Vs(is,ir.verticalIconBox,a.as.vertical):{box:null,occluded:!0,offscreen:null}}),ls&&(Kn=ls.placeable,Qn=ls.offscreen);const ki=wa(ls&&ls.placeable);if(!Kn&&this.prevPlacement){const is=this.prevPlacement.variableOffsets[bt.crossTileID];is&&(this.variableOffsets[bt.crossTileID]=is,this.markUsedJustification(b,is.anchor,bt,ki))}}}if(cs=ls,Kn=cs&&cs.placeable,Qn=cs&&cs.offscreen,bt.useRuntimeCollisionCircles&&bt.centerJustifiedTextSymbolIndex>=0){const wa=b.text.placedSymbolArray.get(bt.centerJustifiedTextSymbolIndex),ec=a.at(b.textSizeData,ne,wa),$c=P.get("text-padding");Js=this.collisionIndex.placeCollisionCircles(Se,wa,b.lineVertexArray,b.glyphOffsetArray,ec,B,U,g,Be,fe.predicate,bt.collisionCircleDiameter,$c,E,mt),Js.circles.length&&Js.collisionDetected&&!g&&a.w("Collisions detected, but collision boxes are not shown"),Kn=Te||Js.circles.length>0&&!Js.collisionDetected,Qn=Qn&&Js.offscreen}if(ir.iconFeatureIndex&&(gl=ir.iconFeatureIndex),ir.iconBox){const wa=ec=>this.collisionIndex.placeCollisionBox(ec,Le,G,ot,B,Be,Fe,z,fe.predicate,mt,De&&hi?hi:void 0,Tt);Ai&&Ai.placeable&&ir.verticalIconBox?(ja=wa(ir.verticalIconBox),_s=ja.placeable):(ja=wa(ir.iconBox),_s=ja.placeable),Qn=Qn&&ja.offscreen}const oh=je||bt.numHorizontalGlyphVertices===0&&bt.numVerticalGlyphVertices===0,Vd=we||bt.numIconVertices===0;oh||Vd?Vd?oh||(_s=_s&&Kn):Kn=_s&&Kn:_s=Kn=_s&&Kn;const Fa=_s&&ja.placeable;if(Kn&&cs.placeable&&this.collisionIndex.insertCollisionBox(cs.box,Se,P.get("text-ignore-placement"),b.bucketInstanceId,Ai&&Ai.placeable&&Jl?Jl:Bd,fe.ID),Fa&&this.collisionIndex.insertCollisionBox(ja.box,Le,P.get("icon-ignore-placement"),b.bucketInstanceId,gl,fe.ID),Js&&Kn&&this.collisionIndex.insertCollisionCircles(Js.circles,Se,P.get("text-ignore-placement"),b.bucketInstanceId,Bd,fe.ID),g&&this.storeCollisionData(b.bucketInstanceId,Wr,ir,cs,ja,Js),bt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(b.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[bt.crossTileID]=new av((Kn||ht)&&!(cs!=null&&cs.occluded),(_s||it)&&!(ja!=null&&ja.occluded),Qn||b.justReloaded),m[bt.crossTileID]=!0};if(Ke){if(o.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const bt=b.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let ir=bt.length-1;ir>=0;--ir){const Wr=bt[ir];Mt(b.symbolInstances.get(Wr),b.collisionArrays[Wr],Wr)}}else for(let bt=o.symbolInstanceStart;bt<o.symbolInstanceEnd;bt++)Mt(b.symbolInstances.get(bt),b.collisionArrays[bt],bt);b.justReloaded=!1}storeCollisionData(o,m,g,b,P,E){if(g.textBox||g.iconBox){let z,B;this.collisionBoxArrays.has(o)?z=this.collisionBoxArrays.get(o):(z=new Map,this.collisionBoxArrays.set(o,z)),z.has(m)?B=z.get(m):(B={text:null,icon:null},z.set(m,B)),g.textBox&&(B.text=b.box),g.iconBox&&(B.icon=P.box)}if(E){let z=this.collisionCircleArrays[o];z===void 0&&(z=this.collisionCircleArrays[o]=[]);for(let B=0;B<E.circles.length;B+=4)z.push(E.circles[B+0]-ui),z.push(E.circles[B+1]-ui),z.push(E.circles[B+2]),z.push(E.collisionDetected?1:0)}}markUsedJustification(o,m,g,b){let P;P=b===a.as.vertical?g.verticalPlacedTextSymbolIndex:{left:g.leftJustifiedTextSymbolIndex,center:g.centerJustifiedTextSymbolIndex,right:g.rightJustifiedTextSymbolIndex}[a.aK(m)];const E=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex,g.verticalPlacedTextSymbolIndex];for(const z of E)z>=0&&(o.text.placedSymbolArray.get(z).crossTileID=P>=0&&z!==P?0:g.crossTileID)}markUsedOrientation(o,m,g){const b=m===a.as.horizontal||m===a.as.horizontalOnly?m:0,P=m===a.as.vertical?m:0,E=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex];for(const z of E)o.text.placedSymbolArray.get(z).placedOrientation=b;g.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(g.verticalPlacedTextSymbolIndex).placedOrientation=P)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const m=this.prevPlacement;let g=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;const b=m?m.symbolFadeChange(o):1,P=m?m.opacities:{},E=m?m.variableOffsets:{},z=m?m.placedOrientations:{};for(const B in this.placements){const U=this.placements[B],G=P[B];G?(this.opacities[B]=new Bu(G,b,U.text,U.icon),g=g||U.text!==G.text.placed||U.icon!==G.icon.placed):(this.opacities[B]=new Bu(null,b,U.text,U.icon,U.skipFade),g=g||U.text||U.icon)}for(const B in P){const U=P[B];if(!this.opacities[B]){const G=new Bu(U,b,!1,!1);G.isHidden()||(this.opacities[B]=G,g=g||U.text.placed||U.icon.placed)}}for(const B in E)this.variableOffsets[B]||!this.opacities[B]||this.opacities[B].isHidden()||(this.variableOffsets[B]=E[B]);for(const B in z)this.placedOrientations[B]||!this.opacities[B]||this.opacities[B].isHidden()||(this.placedOrientations[B]=z[B]);if(m&&m.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");g?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:o)}updateLayerOpacities(o,m){const g={};for(const b of m){const P=b.getBucket(o);P&&b.latestFeatureIndex&&o.id===P.layerIds[0]&&this.updateBucketOpacities(P,b.tileID,g,b.collisionBoxArray)}}updateBucketOpacities(o,m,g,b){o.hasTextData()&&(o.text.opacityVertexArray.clear(),o.text.hasVisibleVertices=!1),o.hasIconData()&&(o.icon.opacityVertexArray.clear(),o.icon.hasVisibleVertices=!1),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const P=o.layers[0],E=P.layout,z=new Bu(null,0,!1,!1,!0),B=E.get("text-allow-overlap"),U=E.get("icon-allow-overlap"),G=P._unevaluatedLayout.hasValue("text-variable-anchor")||P._unevaluatedLayout.hasValue("text-variable-anchor-offset"),J=E.get("text-rotation-alignment")==="map",Y=E.get("text-pitch-alignment")==="map",ne=E.get("icon-text-fit")!=="none",fe=new Bu(null,0,B&&(U||!o.hasIconData()||E.get("icon-optional")),U&&(B||!o.hasTextData()||E.get("text-optional")),!0);!o.collisionArrays&&b&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(b);const je=(Se,Te,Le)=>{for(let ke=0;ke<Te/4;ke++)Se.opacityVertexArray.emplaceBack(Le);Se.hasVisibleVertices=Se.hasVisibleVertices||Le!==Mm},we=this.collisionBoxArrays.get(o.bucketInstanceId);for(let Se=0;Se<o.symbolInstances.length;Se++){const Te=o.symbolInstances.get(Se),{numHorizontalGlyphVertices:Le,numVerticalGlyphVertices:ke,crossTileID:Fe}=Te;let Be=this.opacities[Fe];g[Fe]?Be=z:Be||(Be=fe,this.opacities[Fe]=Be),g[Fe]=!0;const De=Te.numIconVertices>0,Ke=this.placedOrientations[Te.crossTileID],ht=Ke===a.as.vertical,it=Ke===a.as.horizontal||Ke===a.as.horizontalOnly;if(Le>0||ke>0){const mt=wp(Be.text);je(o.text,Le,ht?Mm:mt),je(o.text,ke,it?Mm:mt);const Tt=Be.text.isHidden();[Te.rightJustifiedTextSymbolIndex,Te.centerJustifiedTextSymbolIndex,Te.leftJustifiedTextSymbolIndex].forEach(ir=>{ir>=0&&(o.text.placedSymbolArray.get(ir).hidden=Tt||ht?1:0)}),Te.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(Te.verticalPlacedTextSymbolIndex).hidden=Tt||it?1:0);const Mt=this.variableOffsets[Te.crossTileID];Mt&&this.markUsedJustification(o,Mt.anchor,Te,Ke);const bt=this.placedOrientations[Te.crossTileID];bt&&(this.markUsedJustification(o,"left",Te,bt),this.markUsedOrientation(o,bt,Te))}if(De){const mt=wp(Be.icon),Tt=!(ne&&Te.verticalPlacedIconSymbolIndex&&ht);Te.placedIconSymbolIndex>=0&&(je(o.icon,Te.numIconVertices,Tt?mt:Mm),o.icon.placedSymbolArray.get(Te.placedIconSymbolIndex).hidden=Be.icon.isHidden()),Te.verticalPlacedIconSymbolIndex>=0&&(je(o.icon,Te.numVerticalIconVertices,Tt?Mm:mt),o.icon.placedSymbolArray.get(Te.verticalPlacedIconSymbolIndex).hidden=Be.icon.isHidden())}const ot=we&&we.has(Se)?we.get(Se):{text:null,icon:null};if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const mt=o.collisionArrays[Se];if(mt){let Tt=new a.P(0,0);if(mt.textBox||mt.verticalTextBox){let Mt=!0;if(G){const bt=this.variableOffsets[Fe];bt?(Tt=ov(bt.anchor,bt.width,bt.height,bt.textOffset,bt.textBoxScale),J&&Tt._rotate(Y?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Mt=!1}if(mt.textBox||mt.verticalTextBox){let bt;mt.textBox&&(bt=ht),mt.verticalTextBox&&(bt=it),mj(o.textCollisionBox.collisionVertexArray,Be.text.placed,!Mt||bt,ot.text,Tt.x,Tt.y)}}if(mt.iconBox||mt.verticalIconBox){const Mt=!!(!it&&mt.verticalIconBox);let bt;mt.iconBox&&(bt=Mt),mt.verticalIconBox&&(bt=!Mt),mj(o.iconCollisionBox.collisionVertexArray,Be.icon.placed,bt,ot.icon,ne?Tt.x:0,ne?Tt.y:0)}}}}if(o.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.text.opacityVertexArray.length!==o.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${o.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${o.text.layoutVertexArray.length}) / 4`);if(o.icon.opacityVertexArray.length!==o.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${o.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${o.icon.layoutVertexArray.length}) / 4`);o.bucketInstanceId in this.collisionCircleArrays&&(o.collisionCircleArray=this.collisionCircleArrays[o.bucketInstanceId],delete this.collisionCircleArrays[o.bucketInstanceId])}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,m){const g=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*g>o}setStale(){this.stale=!0}}function mj(N,o,m,g,b,P){g&&g.length!==0||(g=[0,0,0,0]);const E=g[0]-ui,z=g[1]-ui,B=g[2]-ui,U=g[3]-ui;N.emplaceBack(o?1:0,m?1:0,b||0,P||0,E,z),N.emplaceBack(o?1:0,m?1:0,b||0,P||0,B,z),N.emplaceBack(o?1:0,m?1:0,b||0,P||0,B,U),N.emplaceBack(o?1:0,m?1:0,b||0,P||0,E,U)}const qP=Math.pow(2,25),fj=Math.pow(2,24),pj=Math.pow(2,17),lv=Math.pow(2,16),cv=Math.pow(2,9),xj=Math.pow(2,8),dv=Math.pow(2,1);function wp(N){if(N.opacity===0&&!N.placed)return 0;if(N.opacity===1&&N.placed)return 4294967295;const o=N.placed?1:0,m=Math.floor(127*N.opacity);return m*qP+o*fj+m*pj+o*lv+m*cv+o*xj+m*dv+o}const Mm=0;class Om{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,m,g,b,P){const E=this._bucketParts;for(;this._currentTileIndex<o.length;)if(m.getBucketParts(E,b,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,P())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((z,B)=>z.sortKey-B.sortKey));this._currentPartIndex<E.length;)if(m.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,g),this._currentPartIndex++,P())return!0;return!1}}class Np{constructor(o,m,g,b,P,E,z,B){this.placement=new BP(o,m,E,z,B),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=b,this._showCollisionBoxes=P,this._done=!1}isDone(){return this._done}continuePlacement(o,m,g){const b=k(),P=()=>!this._forceFullPlacement&&k()-b>2;for(;this._currentPlacementIndex>=0;){const E=m[o[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=z)&&(!E.maxzoom||E.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new Om(E)),this._inProgressLayer.continuePlacement(g[E.source],this.placement,this._showCollisionBoxes,E,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const Vu=512/a.a3/2;class Uu{constructor(o,m,g){this.tileID=o,this.bucketInstanceId=g,this._symbolsByKey={};const b=new Map;for(let P=0;P<m.length;P++){const E=m.get(P),z=E.key,B=b.get(z);B?B.push(E):b.set(z,[E])}for(const[P,E]of b){const z={positions:E.map(B=>({x:Math.floor(B.anchorX*Vu),y:Math.floor(B.anchorY*Vu)})),crossTileIDs:E.map(B=>B.crossTileID)};if(z.positions.length>128){const B=new a.aM(z.positions.length,16,Uint16Array);for(const{x:U,y:G}of z.positions)B.add(U,G);B.finish(),delete z.positions,z.index=B}this._symbolsByKey[P]=z}}getScaledCoordinates(o,m){const{x:g,y:b,z:P}=this.tileID.canonical,{x:E,y:z,z:B}=m.canonical,U=Vu/Math.pow(2,B-P),G=(z*a.a3+o.anchorY)*U,J=b*a.a3*Vu;return{x:Math.floor((E*a.a3+o.anchorX)*U-g*a.a3*Vu),y:Math.floor(G-J)}}findMatches(o,m,g){const b=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z);for(let P=0;P<o.length;P++){const E=o.get(P);if(E.crossTileID)continue;const z=this._symbolsByKey[E.key];if(!z)continue;const B=this.getScaledCoordinates(E,m);if(z.index){const U=z.index.range(B.x-b,B.y-b,B.x+b,B.y+b).sort();for(const G of U){const J=z.crossTileIDs[G];if(!g[J]){g[J]=!0,E.crossTileID=J;break}}}else if(z.positions)for(let U=0;U<z.positions.length;U++){const G=z.positions[U],J=z.crossTileIDs[U];if(Math.abs(G.x-B.x)<=b&&Math.abs(G.y-B.y)<=b&&!g[J]){g[J]=!0,E.crossTileID=J;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:o})=>o)}}class gj{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class VP{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const m=Math.round((o-this.lng)/360);if(m!==0)for(const g in this.indexes){const b=this.indexes[g],P={};for(const E in b){const z=b[E];z.tileID=z.tileID.unwrapTo(z.tileID.wrap+m),P[z.tileID.key]=z}this.indexes[g]=P}this.lng=o}addBucket(o,m,g){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let P=0;P<m.symbolInstances.length;P++)m.symbolInstances.get(P).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const b=this.usedCrossTileIDs[o.overscaledZ];for(const P in this.indexes){const E=this.indexes[P];if(Number(P)>o.overscaledZ)for(const z in E){const B=E[z];B.tileID.isChildOf(o)&&B.findMatches(m.symbolInstances,o,b)}else{const z=E[o.scaledTo(Number(P)).key];z&&z.findMatches(m.symbolInstances,o,b)}}for(let P=0;P<m.symbolInstances.length;P++){const E=m.symbolInstances.get(P);E.crossTileID||(E.crossTileID=g.generate(),b[E.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Uu(o,m.symbolInstances,m.bucketInstanceId),!0}removeBucketCrossTileIDs(o,m){for(const g of m.getCrossTileIDsLists())for(const b of g)delete this.usedCrossTileIDs[o][b]}removeStaleBuckets(o){let m=!1;for(const g in this.indexes){const b=this.indexes[g];for(const P in b)o[b[P].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,b[P]),delete b[P],m=!0)}return m}}class Wl{constructor(){this.layerIndexes={},this.crossTileIDs=new gj,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,m,g){let b=this.layerIndexes[o.id];b===void 0&&(b=this.layerIndexes[o.id]=new VP);let P=!1;const E={};b.handleWrapJump(g);for(const z of m){const B=z.getBucket(o);B&&o.id===B.layerIds[0]&&(B.bucketInstanceId||(B.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(z.tileID,B,this.crossTileIDs)&&(P=!0),E[B.bucketInstanceId]=!0)}return b.removeStaleBuckets(E)&&(P=!0),P}pruneUnusedLayers(o){const m={};o.forEach(g=>{m[g]=!0});for(const g in this.layerIndexes)m[g]||delete this.layerIndexes[g]}}var Sd="void main() {fragColor=vec4(1.0);}";const Ur={prelude:un(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:un("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:un("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:un(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:un(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:un(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:un(Sd,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:un(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:un(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:un("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:un("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:un(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:un("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:un(Sd,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:un(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:un(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:un(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:un(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:un(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:un(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:un(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:un(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:un(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:un(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:un(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:un(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:un(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:un(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:un(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:un(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:un(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:un("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:un("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:un("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:un("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:un(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:un("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function un(N,o){const m=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=o.match(/in ([\w]+) ([\w]+)/g),b=N.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=P?P.concat(b):b,z={};return{fragmentSource:N=N.replace(m,(B,U,G,J,Y)=>(z[Y]=!0,U==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
in ${G} ${J} ${Y};
#else
uniform ${G} ${J} u_${Y};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Y}
    ${G} ${J} ${Y} = u_${Y};
#endif
`)),vertexSource:o=o.replace(m,(B,U,G,J,Y)=>{const ne=J==="float"?"vec2":"vec4",fe=Y.match(/color/)?"color":ne;return z[Y]?U==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
in ${G} ${ne} a_${Y};
out ${G} ${J} ${Y};
#else
uniform ${G} ${J} u_${Y};
#endif
`:fe==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = a_${Y};
#else
    ${G} ${J} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = unpack_mix_${fe}(a_${Y}, u_${Y}_t);
#else
    ${G} ${J} ${Y} = u_${Y};
#endif
`:U==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
in ${G} ${ne} a_${Y};
#else
uniform ${G} ${J} u_${Y};
#endif
`:fe==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${G} ${J} ${Y} = a_${Y};
#else
    ${G} ${J} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${G} ${J} ${Y} = unpack_mix_${fe}(a_${Y}, u_${Y}_t);
#else
    ${G} ${J} ${Y} = u_${Y};
#endif
`}),staticAttributes:g,staticUniforms:E}}class Wu{constructor(o,m,g){this.vertexBuffer=o,this.indexBuffer=m,this.segments=g}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var ml=a.aN([{name:"a_pos",type:"Int16",components:2}]);const Da="#define PROJECTION_MERCATOR",sa="mercator";class Vi{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return sa}get shaderDefine(){return Da}get shaderPreludeCode(){return Ur.projectionMercator}get vertexShaderPreludeCode(){return Ur.projectionMercator.vertexSource}get subdivisionGranularity(){return a.aO.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(o){}getMeshFromTileID(o,m,g,b,P){if(this._cachedMesh)return this._cachedMesh;const E=new a.aP;E.emplaceBack(0,0),E.emplaceBack(a.a3,0),E.emplaceBack(0,a.a3),E.emplaceBack(a.a3,a.a3);const z=o.createVertexBuffer(E,ml.members),B=a.aQ.simpleSegment(0,0,4,2),U=new a.aR;U.emplaceBack(1,0,2),U.emplaceBack(1,2,3);const G=o.createIndexBuffer(U);return this._cachedMesh=new Wu(z,G,B),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(o){}}class Qs{constructor(o=0,m=0,g=0,b=0){if(isNaN(o)||o<0||isNaN(m)||m<0||isNaN(g)||g<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=m,this.left=g,this.right=b}interpolate(o,m,g){return m.top!=null&&o.top!=null&&(this.top=a.F.number(o.top,m.top,g)),m.bottom!=null&&o.bottom!=null&&(this.bottom=a.F.number(o.bottom,m.bottom,g)),m.left!=null&&o.left!=null&&(this.left=a.F.number(o.left,m.left,g)),m.right!=null&&o.right!=null&&(this.right=a.F.number(o.right,m.right,g)),this}getCenter(o,m){const g=a.ai((this.left+o-this.right)/2,0,o),b=a.ai((this.top+m-this.bottom)/2,0,m);return new a.P(g,b)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new Qs(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ss(N,o){if(!N.renderWorldCopies||N.lngRange)return;const m=o.lng-N.center.lng;o.lng+=m>180?-360:m<-180?360:0}function yj(N){return Math.max(0,Math.floor(N))}class ia{constructor(o,m){var g;this._callbacks=o,this._tileSize=512,this._renderWorldCopies=(m==null?void 0:m.renderWorldCopies)===void 0||!!(m!=null&&m.renderWorldCopies),this._minZoom=(m==null?void 0:m.minZoom)||0,this._maxZoom=(m==null?void 0:m.maxZoom)||22,this._minPitch=(m==null?void 0:m.minPitch)==null?0:m==null?void 0:m.minPitch,this._maxPitch=(m==null?void 0:m.maxPitch)==null?60:m==null?void 0:m.maxPitch,this._constrain=(g=m==null?void 0:m.constrain)!==null&&g!==void 0?g:this._callbacks.constrain,this.setMaxBounds(),this._width=0,this._height=0,this._center=new a.U(0,0),this._elevation=0,this._zoom=0,this._tileZoom=yj(this._zoom),this._scale=a.al(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Qs,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(o,m,g){this._latRange=o.latRange,this._lngRange=o.lngRange,this._width=o.width,this._height=o.height,this._center=o.center,this._elevation=o.elevation,this._minElevationForCurrentTile=o.minElevationForCurrentTile,this._zoom=o.zoom,this._tileZoom=yj(this._zoom),this._scale=a.al(this._zoom),this._bearingInRadians=o.bearingInRadians,this._fovInRadians=o.fovInRadians,this._pitchInRadians=o.pitchInRadians,this._rollInRadians=o.rollInRadians,this._unmodified=o.unmodified,this._edgeInsets=new Qs(o.padding.top,o.padding.bottom,o.padding.left,o.padding.right),this._minZoom=o.minZoom,this._maxZoom=o.maxZoom,this._minPitch=o.minPitch,this._maxPitch=o.maxPitch,this._renderWorldCopies=o.renderWorldCopies,this._cameraToCenterDistance=o.cameraToCenterDistance,this._nearZ=o.nearZ,this._farZ=o.farZ,this._autoCalculateNearFarZ=!g&&o.autoCalculateNearFarZ,m&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(o){this._minElevationForCurrentTile=o}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(o){this._minZoom!==o&&(this._minZoom=o,this.setZoom(this.constrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.setZoom(this.constrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(o){this._minPitch!==o&&(this._minPitch=o,this.setPitch(Math.max(this.pitch,o)))}get maxPitch(){return this._maxPitch}setMaxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.setPitch(Math.min(this.pitch,o)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get constrain(){return this._constrain}setConstrain(o){o||(o=this._callbacks.constrain),this._constrain=o,this.constrainInternal(),this._calcMatrices()}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(o){const m=a.V(o,-180,180)*Math.PI/180;var g,b,P,E,z,B,U,G,J;this._bearingInRadians!==m&&(this._unmodified=!1,this._bearingInRadians=m,this._calcMatrices(),this._rotationMatrix=p(),g=this._rotationMatrix,P=-this._bearingInRadians,E=(b=this._rotationMatrix)[0],z=b[1],B=b[2],U=b[3],G=Math.sin(P),J=Math.cos(P),g[0]=E*J+B*G,g[1]=z*J+U*G,g[2]=E*-G+B*J,g[3]=z*-G+U*J)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(o){const m=a.ai(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==m&&(this._unmodified=!1,this._pitchInRadians=m,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(o){const m=o/180*Math.PI;this._rollInRadians!==m&&(this._unmodified=!1,this._rollInRadians=m,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return a.aS(this._fovInRadians)}setFov(o){o=a.ai(o,.1,150),this.fov!==o&&(this._unmodified=!1,this._fovInRadians=a.ak(o),this._calcMatrices())}get zoom(){return this._zoom}setZoom(o){const m=this.constrain(this._center,o).zoom;this._zoom!==m&&(this._unmodified=!1,this._zoom=m,this._tileZoom=Math.max(0,Math.floor(m)),this._scale=a.al(m),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(o){o!==this._elevation&&(this._elevation=o,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(o,m){this._autoCalculateNearFarZ=!1,this._nearZ=o,this._farZ=m,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,m,g){this._unmodified=!1,this._edgeInsets.interpolate(o,m,g),this.constrainInternal(),this._calcMatrices()}resize(o,m,g=!0){this._width=o,this._height=m,g&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Lr([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(o){o?(this._lngRange=[o.getWest(),o.getEast()],this._latRange=[o.getSouth(),o.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-a.aj,a.aj])}getCameraQueryGeometry(o,m){if(m.length===1)return[m[0],o];{const{minX:g,minY:b,maxX:P,maxY:E}=a.a6.fromPoints(m).extend(o);return[new a.P(g,b),new a.P(P,b),new a.P(P,E),new a.P(g,E),new a.P(g,b)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const o=this._unmodified,{center:m,zoom:g}=this.constrain(this.center,this.zoom);this.setCenter(m),this.setZoom(g),this._unmodified=o,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let o=a.am(new Float64Array(16));a.O(o,o,[this._width/2,-this._height/2,1]),a.N(o,o,[1,-1,0]),this._clipSpaceToPixelsMatrix=o,o=a.am(new Float64Array(16)),a.O(o,o,[1,-1,1]),a.N(o,o,[-1,-1,0]),a.O(o,o,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=o,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(o,m,g,b){const P=g!==void 0?g:this.bearing,E=b=b!==void 0?b:this.pitch,z=a.a5.fromLngLat(o,m),B=-Math.cos(a.ak(E)),U=Math.sin(a.ak(E)),G=U*Math.sin(a.ak(P)),J=-U*Math.cos(a.ak(P));let Y=this.elevation;const ne=m-Y;let fe;B*ne>=0||Math.abs(B)<.1?(fe=1e4,Y=m+fe*B):fe=-ne/B;let je,we,Se=a.aT(1,z.y),Te=0;do{if(Te+=1,Te>10)break;we=fe/Se,je=new a.a5(z.x+G*we,z.y+J*we),Se=1/je.meterInMercatorCoordinateUnits()}while(Math.abs(fe-we*Se)>1e-12);return{center:je.toLngLat(),elevation:Y,zoom:a.ao(this.height/2/Math.tan(this.fovInRadians/2)/we/this.tileSize)}}recalculateZoomAndCenter(o){if(this.elevation-o==0)return;const m=a.an(1,this.center.lat)*this.worldSize,g=this.cameraToCenterDistance/m,b=a.a5.fromLngLat(this.center,this.elevation),P=Je(this.center,this.elevation,this.pitch,this.bearing,g);this._elevation=o;const E=this.calculateCenterFromCameraLngLatAlt(P.toLngLat(),a.aT(P.z,b.y),this.bearing,this.pitch);this._elevation=E.elevation,this._center=E.center,this.setZoom(E.zoom)}getCameraPoint(){const o=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(o*Math.sin(this.rollInRadians),o*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const o=a.an(1,this.center.lat)*this.worldSize;return Je(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/o).toLngLat()}getMercatorTileCoordinates(o){if(!o)return[0,0,1,1];const m=o.canonical.z>=0?1<<o.canonical.z:Math.pow(2,o.canonical.z);return[o.canonical.x/m,o.canonical.y/m,1/m/a.a3,1/m/a.a3]}}class va{constructor(o,m){this.min=o,this.max=m,this.center=a.aU([],a.aV([],this.min,this.max),.5)}quadrant(o){const m=[o%2==0,o<2],g=a.aW(this.min),b=a.aW(this.max);for(let P=0;P<m.length;P++)g[P]=m[P]?this.min[P]:this.center[P],b[P]=m[P]?this.center[P]:this.max[P];return b[2]=this.max[2],new va(g,b)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersectsFrustum(o){let m=!0;for(let g=0;g<o.planes.length;g++){const b=this.intersectsPlane(o.planes[g]);if(b===0)return 0;b===1&&(m=!1)}return m?2:o.aabb.min[0]>this.max[0]||o.aabb.min[1]>this.max[1]||o.aabb.min[2]>this.max[2]||o.aabb.max[0]<this.min[0]||o.aabb.max[1]<this.min[1]||o.aabb.max[2]<this.min[2]?0:1}intersectsPlane(o){let m=o[3],g=o[3];for(let b=0;b<3;b++)o[b]>0?(m+=o[b]*this.min[b],g+=o[b]*this.max[b]):(g+=o[b]*this.min[b],m+=o[b]*this.max[b]);return m>=0?2:g<0?0:1}}class Ja{distanceToTile2d(o,m,g,b){const P=b.distanceX([o,m]),E=b.distanceY([o,m]);return Math.hypot(P,E)}getWrap(o,m,g){return g}getTileBoundingVolume(o,m,g,b){var P,E;let z=0,B=0;if(b!=null&&b.terrain){const G=new a.a0(o.z,m,o.z,o.x,o.y),J=b.terrain.getMinMaxElevation(G);z=(P=J.minElevation)!==null&&P!==void 0?P:Math.min(0,g),B=(E=J.maxElevation)!==null&&E!==void 0?E:Math.max(0,g)}const U=1<<o.z;return new va([m+o.x/U,o.y/U,z],[m+(o.x+1)/U,(o.y+1)/U,B])}allowVariableZoom(o,m){const g=o.fov*(Math.abs(Math.cos(o.rollInRadians))*o.height+Math.abs(Math.sin(o.rollInRadians))*o.width)/o.height,b=a.ai(78.5-g/2,0,60);return!!m.terrain||o.pitch>b}allowWorldCopies(){return!0}prepareNextFrame(){}}class Im{constructor(o,m,g){this.points=o,this.planes=m,this.aabb=g}static fromInvProjectionMatrix(o,m=1,g=0,b,P){const E=P?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],z=Math.pow(2,g),B=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(Y=>function(ne,fe,je,we){const Se=a.aA([],ne,fe),Te=1/Se[3]/je*we;return a.a$(Se,Se,[Te,Te,1/Se[3],Te])}(Y,o,m,z));b&&function(Y,ne,fe,je){const we=je?4:0,Se=je?0:4;let Te=0;const Le=[],ke=[];for(let De=0;De<4;De++){const Ke=a.aX([],Y[De+Se],Y[De+we]),ht=a.b0(Ke);a.aU(Ke,Ke,1/ht),Le.push(ht),ke.push(Ke)}for(let De=0;De<4;De++){const Ke=a.b1(Y[De+we],ke[De],fe);Te=Ke!==null&&Ke>=0?Math.max(Te,Ke):Math.max(Te,Le[De])}const Fe=function(De,Ke){const ht=a.aX([],De[Ke[0]],De[Ke[1]]),it=a.aX([],De[Ke[2]],De[Ke[1]]),ot=[0,0,0,0];return a.aY(ot,a.aZ([],ht,it)),ot[3]=-a.a_(ot,De[Ke[0]]),ot}(Y,ne),Be=function(De,Ke){const ht=a.b2(De),it=a.b3([],De,1/ht),ot=a.aX([],Ke,a.aU([],it,a.a_(Ke,it))),mt=a.b2(ot);if(mt>0){const Tt=Math.sqrt(1-it[3]*it[3]),Mt=a.aU([],it,-it[3]),bt=a.aV([],Mt,a.aU([],ot,Tt/mt));return a.b4(Ke,bt)}return null}(fe,Fe);if(Be!==null){const De=Be/a.a_(ke[0],Fe);Te=Math.min(Te,De)}for(let De=0;De<4;De++){const Ke=Math.min(Te,Le[De]);Y[De+Se]=[Y[De+we][0]+ke[De][0]*Ke,Y[De+we][1]+ke[De][1]*Ke,Y[De+we][2]+ke[De][2]*Ke,1]}}(B,E[0],b,P);const U=E.map(Y=>{const ne=a.aX([],B[Y[0]],B[Y[1]]),fe=a.aX([],B[Y[2]],B[Y[1]]),je=a.aY([],a.aZ([],ne,fe)),we=-a.a_(je,B[Y[1]]);return je.concat(we)}),G=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],J=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const Y of B)for(let ne=0;ne<3;ne++)G[ne]=Math.min(G[ne],Y[ne]),J[ne]=Math.max(J[ne],Y[ne]);return new Im(B,U,new va(G,J))}}class fl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(o){this._helper.setMinZoom(o)}setMaxZoom(o){this._helper.setMaxZoom(o)}setMinPitch(o){this._helper.setMinPitch(o)}setMaxPitch(o){this._helper.setMaxPitch(o)}setRenderWorldCopies(o){this._helper.setRenderWorldCopies(o)}setBearing(o){this._helper.setBearing(o)}setPitch(o){this._helper.setPitch(o)}setRoll(o){this._helper.setRoll(o)}setFov(o){this._helper.setFov(o)}setZoom(o){this._helper.setZoom(o)}setCenter(o){this._helper.setCenter(o)}setElevation(o){this._helper.setElevation(o)}setMinElevationForCurrentTile(o){this._helper.setMinElevationForCurrentTile(o)}setPadding(o){this._helper.setPadding(o)}interpolatePadding(o,m,g){return this._helper.interpolatePadding(o,m,g)}isPaddingEqual(o){return this._helper.isPaddingEqual(o)}resize(o,m,g=!0){this._helper.resize(o,m,g)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(o){this._helper.setMaxBounds(o)}setConstrain(o){this._helper.setConstrain(o)}overrideNearFarZ(o,m){this._helper.overrideNearFarZ(o,m)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(o){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),o)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrain(){return this._helper.constrain}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(o,m){}constructor(o){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(m,g)=>{g=a.ai(+g,this.minZoom,this.maxZoom);const b={center:new a.U(m.lng,m.lat),zoom:g};let P=this._helper._lngRange;if(!this._helper._renderWorldCopies&&P===null){const ke=179.9999999999;P=[-ke,ke]}const E=this.tileSize*a.al(b.zoom);let z=0,B=E,U=0,G=E,J=0,Y=0;const{x:ne,y:fe}=this.size;if(this._helper._latRange){const ke=this._helper._latRange;z=a.W(ke[1])*E,B=a.W(ke[0])*E,B-z<fe&&(J=fe/(B-z))}P&&(U=a.V(a.X(P[0])*E,0,E),G=a.V(a.X(P[1])*E,0,E),G<U&&(G+=E),G-U<ne&&(Y=ne/(G-U)));const{x:je,y:we}=dt(E,m);let Se,Te;const Le=Math.max(Y||0,J||0);if(Le){const ke=new a.P(Y?(G+U)/2:je,J?(B+z)/2:we);return b.center=Pt(E,ke).wrap(),b.zoom+=a.ao(Le),b}if(this._helper._latRange){const ke=fe/2;we-ke<z&&(Te=z+ke),we+ke>B&&(Te=B-ke)}if(P){const ke=(U+G)/2;let Fe=je;this._helper._renderWorldCopies&&(Fe=a.V(je,ke-E/2,ke+E/2));const Be=ne/2;Fe-Be<U&&(Se=U+Be),Fe+Be>G&&(Se=G-Be)}if(Se!==void 0||Te!==void 0){const ke=new a.P(Se??je,Te??we);b.center=Pt(E,ke).wrap()}return b},this._helper=new ia({calcMatrices:()=>{this._calcMatrices()},constrain:(m,g)=>this.defaultConstrain(m,g)},o),this._coveringTilesDetailsProvider=new Ja}clone(){const o=new fl;return o.apply(this),o}apply(o,m,g){this._helper.apply(o,m,g)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(o){const m=[new a.b5(0,o)];if(this._helper._renderWorldCopies){const g=this.screenPointToMercatorCoordinate(new a.P(0,0)),b=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,0)),P=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,this._helper._height)),E=this.screenPointToMercatorCoordinate(new a.P(0,this._helper._height)),z=Math.floor(Math.min(g.x,b.x,P.x,E.x)),B=Math.floor(Math.max(g.x,b.x,P.x,E.x)),U=1;for(let G=z-U;G<=B+U;G++)G!==0&&m.push(new a.b5(G,o))}return m}getCameraFrustum(){return Im.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(o){const m=this.screenPointToLocation(this.centerPoint,o),g=o?o.getElevationForLngLatZoom(m,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(g)}setLocationAtPoint(o,m){const g=a.an(this.elevation,this.center.lat),b=this.screenPointToMercatorCoordinateAtZ(m,g),P=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,g),E=a.a5.fromLngLat(o),z=new a.a5(E.x-(b.x-P.x),E.y-(b.y-P.y));this.setCenter(z==null?void 0:z.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(o,m){return m?this.coordinatePoint(a.a5.fromLngLat(o),m.getElevationForLngLatZoom(o,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(a.a5.fromLngLat(o))}screenPointToLocation(o,m){var g;return(g=this.screenPointToMercatorCoordinate(o,m))===null||g===void 0?void 0:g.toLngLat()}screenPointToMercatorCoordinate(o,m){if(m){const g=m.pointCoordinate(o);if(g!=null)return g}return this.screenPointToMercatorCoordinateAtZ(o)}screenPointToMercatorCoordinateAtZ(o,m){const g=m||0,b=[o.x,o.y,0,1],P=[o.x,o.y,1,1];a.aA(b,b,this._pixelMatrixInverse),a.aA(P,P,this._pixelMatrixInverse);const E=b[3],z=P[3],B=b[1]/E,U=P[1]/z,G=b[2]/E,J=P[2]/z,Y=G===J?0:(g-G)/(J-G);return new a.a5(a.F.number(b[0]/E,P[0]/z,Y)/this.worldSize,a.F.number(B,U,Y)/this.worldSize,g)}coordinatePoint(o,m=0,g=this._pixelMatrix){const b=[o.x*this.worldSize,o.y*this.worldSize,m,1];return a.aA(b,b,g),new a.P(b[0]/b[3],b[1]/b[3])}getBounds(){const o=Math.max(0,this._helper._height/2-yt(this));return new Lr().extend(this.screenPointToLocation(new a.P(0,o))).extend(this.screenPointToLocation(new a.P(this._helper._width,o))).extend(this.screenPointToLocation(new a.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new a.P(0,this._helper._height)))}isPointOnMapSurface(o,m){return m?m.pointCoordinate(o)!=null:o.y>this.height/2-yt(this)}calculatePosMatrix(o,m=!1,g){var b;const P=(b=o.key)!==null&&b!==void 0?b:a.b6(o.wrap,o.canonical.z,o.canonical.z,o.canonical.x,o.canonical.y),E=m?this._alignedPosMatrixCache:this._posMatrixCache;if(E.has(P)){const U=E.get(P);return g?U.f32:U.f64}const z=lr(o,this.worldSize);a.Q(z,m?this._alignedProjMatrix:this._viewProjMatrix,z);const B={f64:z,f32:new Float32Array(z)};return E.set(P,B),g?B.f32:B.f64}calculateFogMatrix(o){const m=o.key,g=this._fogMatrixCacheF32;if(g.has(m))return g.get(m);const b=lr(o,this.worldSize);return a.Q(b,this._fogMatrix,b),g.set(m,new Float32Array(b)),g.get(m)}calculateCenterFromCameraLngLatAlt(o,m,g,b){return this._helper.calculateCenterFromCameraLngLatAlt(o,m,g,b)}_calculateNearFarZIfNeeded(o,m,g){if(!this._helper.autoCalculateNearFarZ)return;const b=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),P=o-b*this._helper._pixelPerMeter/Math.cos(m),E=b<0?P:o,z=Math.PI/2+this.pitchInRadians,B=a.ak(this.fov)*(Math.abs(Math.cos(a.ak(this.roll)))*this.height+Math.abs(Math.sin(a.ak(this.roll)))*this.width)/this.height*(.5+g.y/this.height),U=Math.sin(B)*E/Math.sin(a.ai(Math.PI-z-B,.01,Math.PI-.01)),G=yt(this),J=Math.atan(G/this._helper.cameraToCenterDistance),Y=a.ak(.75),ne=J>Y?2*J*(.5+g.y/(2*G)):Y,fe=Math.sin(ne)*E/Math.sin(a.ai(Math.PI-z-ne,.01,Math.PI-.01)),je=Math.min(U,fe);this._helper._farZ=1.01*(Math.cos(Math.PI/2-m)*je+E),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const o=this.centerOffset,m=dt(this.worldSize,this.center),g=m.x,b=m.y;this._helper._pixelPerMeter=a.an(1,this.center.lat)*this.worldSize;const P=a.ak(Math.min(this.pitch,He)),E=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(P));let z;this._calculateNearFarZIfNeeded(E,P,o),z=new Float64Array(16),a.b7(z,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),a.au(this._invProjMatrix,z),z[8]=2*-o.x/this._helper._width,z[9]=2*o.y/this._helper._height,this._projectionMatrix=a.b8(z),a.O(z,z,[1,-1,1]),a.N(z,z,[0,0,-this._helper.cameraToCenterDistance]),a.b9(z,z,-this.rollInRadians),a.ba(z,z,this.pitchInRadians),a.b9(z,z,-this.bearingInRadians),a.N(z,z,[-g,-b,0]),this._mercatorMatrix=a.O([],z,[this.worldSize,this.worldSize,this.worldSize]),a.O(z,z,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=a.Q(new Float64Array(16),this.clipSpaceToPixelsMatrix,z),a.N(z,z,[0,0,-this.elevation]),this._viewProjMatrix=z,this._invViewProjMatrix=a.au([],z);const B=[0,0,-1,1];a.aA(B,B,this._invViewProjMatrix),this._cameraPosition=[B[0]/B[3],B[1]/B[3],B[2]/B[3]],this._fogMatrix=new Float64Array(16),a.b7(this._fogMatrix,this.fovInRadians,this.width/this.height,E,this._helper._farZ),this._fogMatrix[8]=2*-o.x/this.width,this._fogMatrix[9]=2*o.y/this.height,a.O(this._fogMatrix,this._fogMatrix,[1,-1,1]),a.N(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),a.b9(this._fogMatrix,this._fogMatrix,-this.rollInRadians),a.ba(this._fogMatrix,this._fogMatrix,this.pitchInRadians),a.b9(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),a.N(this._fogMatrix,this._fogMatrix,[-g,-b,0]),a.O(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),a.N(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=a.Q(new Float64Array(16),this.clipSpaceToPixelsMatrix,z);const U=this._helper._width%2/2,G=this._helper._height%2/2,J=Math.cos(this.bearingInRadians),Y=Math.sin(-this.bearingInRadians),ne=g-Math.round(g)+J*U+Y*G,fe=b-Math.round(b)+J*G+Y*U,je=new Float64Array(z);if(a.N(je,je,[ne>.5?ne-1:ne,fe>.5?fe-1:fe,0]),this._alignedProjMatrix=je,z=a.au(new Float64Array(16),this._pixelMatrix),!z)throw new Error("failed to invert matrix");this._pixelMatrixInverse=z,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const o=this.screenPointToMercatorCoordinate(new a.P(0,0)),m=[o.x*this.worldSize,o.y*this.worldSize,0,1];return a.aA(m,m,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const o=a.an(1,this.center.lat)*this.worldSize;return Je(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/o).toLngLat()}lngLatToCameraDepth(o,m){const g=a.a5.fromLngLat(o),b=[g.x*this.worldSize,g.y*this.worldSize,m,1];return a.aA(b,b,this._viewProjMatrix),b[2]/b[3]}getProjectionData(o){const{overscaledTileID:m,aligned:g,applyTerrainMatrix:b}=o,P=this._helper.getMercatorTileCoordinates(m),E=m?this.calculatePosMatrix(m,g,!0):null;let z;return z=m&&m.terrainRttPosMatrix32f&&b?m.terrainRttPosMatrix32f:E||a.bb(),{mainMatrix:z,tileMercatorCoords:P,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:z}}isLocationOccluded(o){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(o,m,g){return 1}transformLightDirection(o){return a.aW(o)}getRayDirectionFromPixel(o){throw new Error("Not implemented.")}projectTileCoordinates(o,m,g,b){const P=this.calculatePosMatrix(g);let E;b?(E=[o,m,b(o,m),1],a.aA(E,E,P)):(E=[o,m,0,1],wd(E,E,P));const z=E[3];return{point:new a.P(E[0]/z,E[1]/z),signedDistanceFromCamera:z,isOccluded:!1}}populateCache(o){for(const m of o)this.calculatePosMatrix(m)}getMatrixForModel(o,m){const g=a.a5.fromLngLat(o,m),b=g.meterInMercatorCoordinateUnits(),P=a.bc();return a.N(P,P,[g.x,g.y,g.z]),a.b9(P,P,Math.PI),a.ba(P,P,Math.PI/2),a.O(P,P,[-b,b,b]),P}getProjectionDataForCustomLayer(o=!0){const m=new a.a0(0,0,0,0,0),g=this.getProjectionData({overscaledTileID:m,applyGlobeMatrix:o}),b=lr(m,this.worldSize);a.Q(b,this._viewProjMatrix,b),g.tileMercatorCoords=[0,0,1,1];const P=[a.a3,a.a3,this.worldSize/this._helper.pixelsPerMeter],E=a.bd();return a.O(E,b,P),g.fallbackMatrix=E,g.mainMatrix=E,g}getFastPathSimpleProjectionMatrix(o){return this.calculatePosMatrix(o)}}function Bs(){a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Gu(N){if(N.useSlerp)if(N.k<1){const o=a.be(N.startEulerAngles.roll,N.startEulerAngles.pitch,N.startEulerAngles.bearing),m=a.be(N.endEulerAngles.roll,N.endEulerAngles.pitch,N.endEulerAngles.bearing),g=new Float64Array(4);a.bf(g,o,m,N.k);const b=a.bg(g);N.tr.setRoll(b.roll),N.tr.setPitch(b.pitch),N.tr.setBearing(b.bearing)}else N.tr.setRoll(N.endEulerAngles.roll),N.tr.setPitch(N.endEulerAngles.pitch),N.tr.setBearing(N.endEulerAngles.bearing);else N.tr.setRoll(a.F.number(N.startEulerAngles.roll,N.endEulerAngles.roll,N.k)),N.tr.setPitch(a.F.number(N.startEulerAngles.pitch,N.endEulerAngles.pitch,N.k)),N.tr.setBearing(a.F.number(N.startEulerAngles.bearing,N.endEulerAngles.bearing,N.k))}function Dc(N,o,m,g,b){const P=b.padding,E=dt(b.worldSize,m.getNorthWest()),z=dt(b.worldSize,m.getNorthEast()),B=dt(b.worldSize,m.getSouthEast()),U=dt(b.worldSize,m.getSouthWest()),G=a.ak(-g),J=E.rotate(G),Y=z.rotate(G),ne=B.rotate(G),fe=U.rotate(G),je=new a.P(Math.max(J.x,Y.x,fe.x,ne.x),Math.max(J.y,Y.y,fe.y,ne.y)),we=new a.P(Math.min(J.x,Y.x,fe.x,ne.x),Math.min(J.y,Y.y,fe.y,ne.y)),Se=je.sub(we),Te=(b.width-(P.left+P.right+o.left+o.right))/Se.x,Le=(b.height-(P.top+P.bottom+o.top+o.bottom))/Se.y;if(Le<0||Te<0)return void Bs();const ke=Math.min(a.ao(b.scale*Math.min(Te,Le)),N.maxZoom),Fe=a.P.convert(N.offset),Be=new a.P((o.left-o.right)/2,(o.top-o.bottom)/2).rotate(a.ak(g)),De=Fe.add(Be).mult(b.scale/a.al(ke));return{center:Pt(b.worldSize,E.add(B).div(2).sub(De)),zoom:ke,bearing:g}}class Pd{get useGlobeControls(){return!1}handlePanInertia(o,m){const g=o.mag(),b=Math.abs(yt(m));return{easingOffset:o.mult(Math.min(.75*b/g,1)),easingCenter:m.center}}handleMapControlsRollPitchBearingZoom(o,m){o.bearingDelta&&m.setBearing(m.bearing+o.bearingDelta),o.pitchDelta&&m.setPitch(m.pitch+o.pitchDelta),o.rollDelta&&m.setRoll(m.roll+o.rollDelta),o.zoomDelta&&m.setZoom(m.zoom+o.zoomDelta)}handleMapControlsPan(o,m,g){o.around.distSqr(m.centerPoint)<.01||m.setLocationAtPoint(g,o.around)}cameraForBoxAndBearing(o,m,g,b,P){return Dc(o,m,g,b,P)}handleJumpToCenterZoom(o,m){o.zoom!==(m.zoom!==void 0?+m.zoom:o.zoom)&&o.setZoom(+m.zoom),m.center!==void 0&&o.setCenter(a.U.convert(m.center))}handleEaseTo(o,m){const g=o.zoom,b=o.padding,P={roll:o.roll,pitch:o.pitch,bearing:o.bearing},E={roll:m.roll===void 0?o.roll:m.roll,pitch:m.pitch===void 0?o.pitch:m.pitch,bearing:m.bearing===void 0?o.bearing:m.bearing},z=m.zoom!==void 0,B=!o.isPaddingEqual(m.padding);let U=!1;const G=z?+m.zoom:o.zoom;let J=o.centerPoint.add(m.offsetAsPoint);const Y=o.screenPointToLocation(J),{center:ne,zoom:fe}=o.constrain(a.U.convert(m.center||Y),G??g);ss(o,ne);const je=dt(o.worldSize,Y),we=dt(o.worldSize,ne).sub(je),Se=a.al(fe-g);return U=fe!==g,{easeFunc:Te=>{if(U&&o.setZoom(a.F.number(g,fe,Te)),a.bh(P,E)||Gu({startEulerAngles:P,endEulerAngles:E,tr:o,k:Te,useSlerp:P.roll!=E.roll}),B&&(o.interpolatePadding(b,m.padding,Te),J=o.centerPoint.add(m.offsetAsPoint)),m.around)o.setLocationAtPoint(m.around,m.aroundPoint);else{const Le=a.al(o.zoom-g),ke=fe>g?Math.min(2,Se):Math.max(.5,Se),Fe=Math.pow(ke,1-Te),Be=Pt(o.worldSize,je.add(we.mult(Te*Fe)).mult(Le));o.setLocationAtPoint(o.renderWorldCopies?Be.wrap():Be,J)}},isZooming:U,elevationCenter:ne}}handleFlyTo(o,m){const g=m.zoom!==void 0,b=o.zoom,P=o.constrain(a.U.convert(m.center||m.locationAtOffset),g?+m.zoom:b),E=P.center,z=P.zoom;ss(o,E);const B=dt(o.worldSize,m.locationAtOffset),U=dt(o.worldSize,E).sub(B),G=U.mag(),J=a.al(z-b);let Y;if(m.minZoom!==void 0){const ne=Math.min(+m.minZoom,b,z),fe=o.constrain(E,ne).zoom;Y=a.al(fe-b)}return{easeFunc:(ne,fe,je,we)=>{o.setZoom(ne===1?z:b+a.ao(fe));const Se=ne===1?E:Pt(o.worldSize,B.add(U.mult(je)).mult(fe));o.setLocationAtPoint(o.renderWorldCopies?Se.wrap():Se,we)},scaleOfZoom:J,targetCenter:E,scaleOfMinZoom:Y,pixelPathLength:G}}}class jn{constructor(o,m,g){this.blendFunction=o,this.blendColor=m,this.mask=g}}jn.Replace=[1,0],jn.disabled=new jn(jn.Replace,a.bi.transparent,[!1,!1,!1,!1]),jn.unblended=new jn(jn.Replace,a.bi.transparent,[!0,!0,!0,!0]),jn.alphaBlended=new jn([1,771],a.bi.transparent,[!0,!0,!0,!0]);const Sp=2305;class nn{constructor(o,m,g){this.enable=o,this.mode=m,this.frontFace=g}}nn.disabled=new nn(!1,1029,Sp),nn.backCCW=new nn(!0,1029,Sp),nn.frontCCW=new nn(!0,1028,Sp);class Jr{constructor(o,m,g){this.func=o,this.mask=m,this.range=g}}Jr.ReadOnly=!1,Jr.ReadWrite=!0,Jr.disabled=new Jr(519,Jr.ReadOnly,[0,1]);const Pp=7680;class vn{constructor(o,m,g,b,P,E){this.test=o,this.ref=m,this.mask=g,this.fail=b,this.depthFail=P,this.pass=E}}vn.disabled=new vn({func:519,mask:0},0,0,Pp,Pp,Pp);const Ku=new WeakMap;function yo(N){var o;if(Ku.has(N))return Ku.get(N);{const m=(o=N.getParameter(N.VERSION))===null||o===void 0?void 0:o.startsWith("WebGL 2.0");return Ku.set(N,m),m}}class Dm{get awaitingQuery(){return!!this._readbackQueue}constructor(o){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=o;const m=o.context,g=m.gl;this._texFormat=g.RGBA,this._texType=g.UNSIGNED_BYTE;const b=new a.aP;b.emplaceBack(-1,-1),b.emplaceBack(2,-1),b.emplaceBack(-1,2);const P=new a.aR;P.emplaceBack(0,1,2),this._fullscreenTriangle=new Wu(m.createVertexBuffer(b,ml.members),m.createIndexBuffer(P),a.aQ.simpleSegment(0,0,b.length,P.length)),this._resultBuffer=new Uint8Array(4),m.activeTexture.set(g.TEXTURE1);const E=g.createTexture();g.bindTexture(g.TEXTURE_2D,E),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST),g.texImage2D(g.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=m.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(E),yo(g)&&(this._pbo=g.createBuffer(),g.bindBuffer(g.PIXEL_PACK_BUFFER,this._pbo),g.bufferData(g.PIXEL_PACK_BUFFER,4,g.STREAM_READ),g.bindBuffer(g.PIXEL_PACK_BUFFER,null))}destroy(){const o=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),o.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(o,m){const g=this._updateCount;return this._readbackQueue?g>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():g>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(o,m),this._updateCount++,this._measuredError}_bindFramebuffer(){const o=this._cachedRenderContext.context,m=o.gl;o.activeTexture.set(m.TEXTURE1),m.bindTexture(m.TEXTURE_2D,this._fbo.colorAttachment.get()),o.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(o,m){const g=this._cachedRenderContext.context,b=g.gl;if(this._bindFramebuffer(),g.viewport.set([0,0,this._texWidth,this._texHeight]),g.clear({color:a.bi.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(g,b.TRIANGLES,Jr.disabled,vn.disabled,jn.unblended,nn.disabled,((P,E)=>({u_input:P,u_output_expected:E}))(o,m),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&yo(b)){b.bindBuffer(b.PIXEL_PACK_BUFFER,this._pbo),b.readBuffer(b.COLOR_ATTACHMENT0),b.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),b.bindBuffer(b.PIXEL_PACK_BUFFER,null);const P=b.fenceSync(b.SYNC_GPU_COMMANDS_COMPLETE,0);b.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:P}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const o=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&yo(o)){const m=o.clientWaitSync(this._readbackQueue.sync,0,0);if(m===o.WAIT_FAILED)return a.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(m===o.TIMEOUT_EXPIRED)return;o.bindBuffer(o.PIXEL_PACK_BUFFER,this._pbo),o.getBufferSubData(o.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),o.bindBuffer(o.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),o.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Dm._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(o){let m=0;return m+=o[0]/256,m+=o[1]/65536,m+=o[2]/16777216,o[3]<127&&(m=-m),m/128}}const Hu=a.a3/128;function Rm(N,o){const m=N.granularity!==void 0?Math.max(N.granularity,1):1,g=m+(N.generateBorders?2:0),b=m+(N.extendToNorthPole||N.generateBorders?1:0)+(N.extendToSouthPole||N.generateBorders?1:0),P=g+1,E=b+1,z=N.generateBorders?-1:0,B=N.generateBorders||N.extendToNorthPole?-1:0,U=m+(N.generateBorders?1:0),G=m+(N.generateBorders||N.extendToSouthPole?1:0),J=P*E,Y=g*b*6,ne=P*E>65536;if(ne&&o==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const fe=ne||o==="32bit",je=new Int16Array(2*J);let we=0;for(let Le=B;Le<=G;Le++)for(let ke=z;ke<=U;ke++){let Fe=ke/m*a.a3;ke===-1&&(Fe=-Hu),ke===m+1&&(Fe=a.a3+Hu);let Be=Le/m*a.a3;Le===-1&&(Be=N.extendToNorthPole?a.bk:-Hu),Le===m+1&&(Be=N.extendToSouthPole?a.bl:a.a3+Hu),je[we++]=Fe,je[we++]=Be}const Se=fe?new Uint32Array(Y):new Uint16Array(Y);let Te=0;for(let Le=0;Le<b;Le++)for(let ke=0;ke<g;ke++){const Fe=ke+1+Le*P,Be=ke+(Le+1)*P,De=ke+1+(Le+1)*P;Se[Te++]=ke+Le*P,Se[Te++]=Be,Se[Te++]=Fe,Se[Te++]=Fe,Se[Te++]=Be,Se[Te++]=De}return{vertices:je.buffer.slice(0),indices:Se.buffer.slice(0),uses32bitIndices:fe}}const Lm=new a.aO({fill:new a.bm(128,2),line:new a.bm(512,0),tile:new a.bm(128,32),stencil:new a.bm(128,1),circle:3});class Cp{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Ur.projectionGlobe}get vertexShaderPreludeCode(){return Ur.projectionMercator.vertexSource}get subdivisionGranularity(){return Lm}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(o){this._errorMeasurement||(this._errorMeasurement=new Dm(o));const m=a.W(this._errorQueryLatitudeDegrees),g=2*Math.atan(Math.exp(Math.PI-m*Math.PI*2))-.5*Math.PI,b=this._errorMeasurement.updateErrorLoop(m,g),P=k();b!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=b,this._errorMeasurementLastChangeTime=P);const E=Math.min(Math.max((P-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=a.bn(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,a.bo(E))}_getMeshKey(o){return`${o.granularity.toString(36)}_${o.generateBorders?"b":""}${o.extendToNorthPole?"n":""}${o.extendToSouthPole?"s":""}`}getMeshFromTileID(o,m,g,b,P){const E=(P==="stencil"?Lm.stencil:Lm.tile).getGranularityForZoomLevel(m.z);return this._getMesh(o,{granularity:E,generateBorders:g,extendToNorthPole:m.y===0&&b,extendToSouthPole:m.y===(1<<m.z)-1&&b})}_getMesh(o,m){const g=this._getMeshKey(m);if(g in this._tileMeshCache)return this._tileMeshCache[g];const b=function(P,E){const z=Rm(E,"16bit"),B=a.aP.deserialize({arrayBuffer:z.vertices,length:z.vertices.byteLength/2/2}),U=a.aR.deserialize({arrayBuffer:z.indices,length:z.indices.byteLength/2/3});return new Wu(P.createVertexBuffer(B,ml.members),P.createIndexBuffer(U),a.aQ.simpleSegment(0,0,B.length,U.length))}(o,m);return this._tileMeshCache[g]=b,b}recalculate(o){}hasTransition(){const o=k();let m=!1;return m=m||(o-this._errorMeasurementLastChangeTime)/1e3<.7,m=m||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,m}setErrorQueryLatitudeDegrees(o){this._errorQueryLatitudeDegrees=o}}const Ap=new a.r({type:new a.D(a.t.projection.type)});class Fm extends a.E{constructor(o){super(),this._transitionable=new a.x(Ap,void 0),this.setProjection(o),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.G(0)),this._mercatorProjection=new Vi,this._verticalPerspectiveProjection=new Cp}get transitionState(){const o=this.properties.get("type");if(typeof o=="string"&&o==="mercator")return 0;if(typeof o=="string"&&o==="vertical-perspective")return 1;if(o instanceof a.bp){if(o.from==="vertical-perspective"&&o.to==="mercator")return 1-o.transition;if(o.from==="mercator"&&o.to==="vertical-perspective")return o.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(o){this._mercatorProjection.updateGPUdependent(o),this._verticalPerspectiveProjection.updateGPUdependent(o)}getMeshFromTileID(o,m,g,b,P){return this.currentProjection.getMeshFromTileID(o,m,g,b,P)}setProjection(o){this._transitionable.setValue("type",(o==null?void 0:o.type)||"mercator")}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}setErrorQueryLatitudeDegrees(o){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(o),this._mercatorProjection.setErrorQueryLatitudeDegrees(o)}}function Zu(N){const o=zm(N.worldSize,N.center.lat);return 2*Math.PI*o}function Rc(N,o,m,g,b){const P=1/(1<<b),E=o/a.a3*P+g*P,z=a.br((N/a.a3*P+m*P)*Math.PI*2+Math.PI,2*Math.PI),B=2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI,U=Math.cos(B),G=new Float64Array(3);return G[0]=Math.sin(z)*U,G[1]=Math.sin(B),G[2]=Math.cos(z)*U,G}function Ci(N){return function(o,m){const g=Math.cos(m),b=new Float64Array(3);return b[0]=Math.sin(o)*g,b[1]=Math.sin(m),b[2]=Math.cos(o)*g,b}(N.lng*Math.PI/180,N.lat*Math.PI/180)}function zm(N,o){return N/(2*Math.PI)/Math.cos(o*Math.PI/180)}function vj(N){const o=Math.asin(N[1])/Math.PI*180,m=Math.sqrt(N[0]*N[0]+N[2]*N[2]);if(m>1e-6){const g=N[0]/m,b=Math.acos(N[2]/m),P=(g>0?b:-b)/Math.PI*180;return new a.U(a.V(P,-180,180),o)}return new a.U(0,o)}function kp(N){return Math.cos(N*Math.PI/180)}function Dn(N,o){const m=kp(N),g=kp(o);return a.ao(g/m)}function Tp(N,o){const m=N.rotate(o.bearingInRadians),g=o.zoom+Dn(o.center.lat,0),b=a.bn(1/kp(o.center.lat),1/kp(Math.min(Math.abs(o.center.lat),60)),a.bq(g,7,3,0,1)),P=360/Zu({worldSize:o.worldSize,center:{lat:o.center.lat}});return new a.U(o.center.lng-m.x*P*b,a.ai(o.center.lat+m.y*P,-a.aj,a.aj))}function vo(N){const o=.5*N,m=Math.sin(o),g=Math.cos(o);return Math.log(m+g)-Math.log(g-m)}function $m(N,o,m,g){const b=N.lat+m*g;if(Math.abs(m)>1){const P=(Math.sign(N.lat+m)!==Math.sign(N.lat)?-Math.abs(N.lat):Math.abs(N.lat))*Math.PI/180,E=Math.abs(N.lat+m)*Math.PI/180,z=vo(P+g*(E-P)),B=vo(P),U=vo(E);return new a.U(N.lng+o*((z-B)/(U-B)),b)}return new a.U(N.lng+o*g,b)}class _j{constructor(o){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=o}swapBuffers(){if(!this._hadAnyChanges)return;const o=this._cachePrevious;this._cachePrevious=this._cache,this._cache=o,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(o,m,g,b){const P=`${o.z}_${o.x}_${o.y}_${b!=null&&b.terrain?"t":""}`,E=this._cache.get(P);if(E)return E;const z=this._cachePrevious.get(P);if(z)return this._cache.set(P,z),z;const B=this._boundingVolumeFactory(o,m,g,b);return this._cache.set(P,B),this._hadAnyChanges=!0,B}}class Cd{constructor(o,m,g,b){this.min=g,this.max=b,this.points=o,this.planes=m}static fromAabb(o,m){const g=[];for(let b=0;b<8;b++)g.push([1&~b?o[0]:m[0],(b>>1&1)==1?m[1]:o[1],(b>>2&1)==1?m[2]:o[2]]);return new Cd(g,[[-1,0,0,m[0]],[1,0,0,-o[0]],[0,-1,0,m[1]],[0,1,0,-o[1]],[0,0,-1,m[2]],[0,0,1,-o[2]]],o,m)}static fromCenterSizeAngles(o,m,g){const b=a.bu([],g[0],g[1],g[2]),P=a.bv([],[m[0],0,0],b),E=a.bv([],[0,m[1],0],b),z=a.bv([],[0,0,m[2]],b),B=[...o],U=[...o];for(let J=0;J<8;J++)for(let Y=0;Y<3;Y++){const ne=o[Y]+P[Y]*(1&~J?-1:1)+E[Y]*((J>>1&1)==1?1:-1)+z[Y]*((J>>2&1)==1?1:-1);B[Y]=Math.min(B[Y],ne),U[Y]=Math.max(U[Y],ne)}const G=[];for(let J=0;J<8;J++){const Y=[...o];a.aV(Y,Y,a.aU([],P,1&~J?-1:1)),a.aV(Y,Y,a.aU([],E,(J>>1&1)==1?1:-1)),a.aV(Y,Y,a.aU([],z,(J>>2&1)==1?1:-1)),G.push(Y)}return new Cd(G,[[...P,-a.a_(P,G[0])],[...E,-a.a_(E,G[0])],[...z,-a.a_(z,G[0])],[-P[0],-P[1],-P[2],-a.a_(P,G[7])],[-E[0],-E[1],-E[2],-a.a_(E,G[7])],[-z[0],-z[1],-z[2],-a.a_(z,G[7])]],B,U)}intersectsFrustum(o){let m=!0;const g=this.points.length,b=this.planes.length,P=o.planes.length,E=o.points.length;for(let z=0;z<P;z++){const B=o.planes[z];let U=0;for(let G=0;G<g;G++){const J=this.points[G];B[0]*J[0]+B[1]*J[1]+B[2]*J[2]+B[3]>=0&&U++}if(U===0)return 0;U<g&&(m=!1)}if(m)return 2;for(let z=0;z<b;z++){const B=this.planes[z];let U=0;for(let G=0;G<E;G++){const J=o.points[G];B[0]*J[0]+B[1]*J[1]+B[2]*J[2]+B[3]>=0&&U++}if(U===0)return 0}return 1}intersectsPlane(o){const m=this.points.length;let g=0;for(let b=0;b<m;b++){const P=this.points[b];o[0]*P[0]+o[1]*P[1]+o[2]*P[2]+o[3]>=0&&g++}return g===m?2:g===0?0:1}}function Gl(N,o,m){const g=N-o;return g<0?-g:Math.max(0,g-m)}function uv(N,o,m,g,b){const P=N-m;let E;return E=P<0?Math.min(-P,1+P-b):P>1?Math.min(Math.max(P-b,0),1-P):0,Math.max(E,Gl(o,g,b))}class UP{constructor(){this._boundingVolumeCache=new _j(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(o,m,g,b){const P=1<<g.z,E=1/P,z=g.x/P,B=g.y/P;let U=2;return U=Math.min(U,uv(o,m,z,B,E)),U=Math.min(U,uv(o,m,z+.5,-B-E,E)),U=Math.min(U,uv(o,m,z+.5,2-B-E,E)),U}getWrap(o,m,g){const b=1<<m.z,P=1/b,E=m.x/b,z=Gl(o.x,E,P),B=Gl(o.x,E-1,P),U=Gl(o.x,E+1,P),G=Math.min(z,B,U);return G===U?1:G===B?-1:0}allowVariableZoom(o,m){return cn(o,m)>4}allowWorldCopies(){return!1}getTileBoundingVolume(o,m,g,b){return this._boundingVolumeCache.getTileBoundingVolume(o,m,g,b)}_computeTileBoundingVolume(o,m,g,b){var P,E;let z=0,B=0;if(b!=null&&b.terrain){const U=new a.a0(o.z,m,o.z,o.x,o.y),G=b.terrain.getMinMaxElevation(U);z=(P=G.minElevation)!==null&&P!==void 0?P:Math.min(0,g),B=(E=G.maxElevation)!==null&&E!==void 0?E:Math.max(0,g)}if(z/=a.bx,B/=a.bx,z+=1,B+=1,o.z<=0)return Cd.fromAabb([-B,-B,-B],[B,B,B]);if(o.z===1)return Cd.fromAabb([o.x===0?-B:0,o.y===0?0:-B,-B],[o.x===0?0:B,o.y===0?B:0,B]);{const U=[Rc(0,0,o.x,o.y,o.z),Rc(a.a3,0,o.x,o.y,o.z),Rc(a.a3,a.a3,o.x,o.y,o.z),Rc(0,a.a3,o.x,o.y,o.z)],G=[];for(const ot of U)G.push(a.aU([],ot,B));if(B!==z)for(const ot of U)G.push(a.aU([],ot,z));o.y===0&&G.push([0,1,0]),o.y===(1<<o.z)-1&&G.push([0,-1,0]);const J=[1,1,1],Y=[-1,-1,-1];for(const ot of G)for(let mt=0;mt<3;mt++)J[mt]=Math.min(J[mt],ot[mt]),Y[mt]=Math.max(Y[mt],ot[mt]);const ne=Rc(a.a3/2,a.a3/2,o.x,o.y,o.z),fe=a.aZ([],[0,1,0],ne);a.aY(fe,fe);const je=a.aZ([],ne,fe);a.aY(je,je);const we=a.aZ([],U[2],U[1]);a.aY(we,we);const Se=a.aZ([],U[0],U[3]);a.aY(Se,Se),G.push(a.aU([],ne,B)),o.y>=(1<<o.z)/2&&G.push(a.aU([],Rc(a.a3/2,0,o.x,o.y,o.z),B)),o.y<(1<<o.z)/2&&G.push(a.aU([],Rc(a.a3/2,a.a3,o.x,o.y,o.z),B));const Te=bj(ne,G),Le=bj(je,G),ke=[-ne[0],-ne[1],-ne[2],Te.max],Fe=[ne[0],ne[1],ne[2],-Te.min],Be=[-je[0],-je[1],-je[2],Le.max],De=[je[0],je[1],je[2],-Le.min],Ke=[...we,0],ht=[...Se,0],it=[];return o.y===0?it.push(a.bw(ht,Ke,ke),a.bw(ht,Ke,Fe)):it.push(a.bw(Be,Ke,ke),a.bw(Be,Ke,Fe),a.bw(Be,ht,ke),a.bw(Be,ht,Fe)),o.y===(1<<o.z)-1?it.push(a.bw(ht,Ke,ke),a.bw(ht,Ke,Fe)):it.push(a.bw(De,Ke,ke),a.bw(De,Ke,Fe),a.bw(De,ht,ke),a.bw(De,ht,Fe)),new Cd(it,[ke,Fe,Be,De,Ke,ht],J,Y)}}}function bj(N,o){let m=1/0,g=-1/0;for(const b of o){const P=a.a_(N,b);m=Math.min(m,P),g=Math.max(g,P)}return{min:m,max:g}}class Ep{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(o){this._helper.setMinZoom(o)}setMaxZoom(o){this._helper.setMaxZoom(o)}setMinPitch(o){this._helper.setMinPitch(o)}setMaxPitch(o){this._helper.setMaxPitch(o)}setRenderWorldCopies(o){this._helper.setRenderWorldCopies(o)}setBearing(o){this._helper.setBearing(o)}setPitch(o){this._helper.setPitch(o)}setRoll(o){this._helper.setRoll(o)}setFov(o){this._helper.setFov(o)}setZoom(o){this._helper.setZoom(o)}setCenter(o){this._helper.setCenter(o)}setElevation(o){this._helper.setElevation(o)}setMinElevationForCurrentTile(o){this._helper.setMinElevationForCurrentTile(o)}setPadding(o){this._helper.setPadding(o)}interpolatePadding(o,m,g){return this._helper.interpolatePadding(o,m,g)}isPaddingEqual(o){return this._helper.isPaddingEqual(o)}resize(o,m){this._helper.resize(o,m)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(o){this._helper.setMaxBounds(o)}setConstrain(o){this._helper.setConstrain(o)}overrideNearFarZ(o,m){this._helper.overrideNearFarZ(o,m)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(o){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),o)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrain(){return this._helper.constrain}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(o){}constructor(o){this._cachedClippingPlane=a.by(),this._projectionMatrix=a.bc(),this._globeViewProjMatrix32f=a.bb(),this._globeViewProjMatrixNoCorrection=a.bc(),this._globeViewProjMatrixNoCorrectionInverted=a.bc(),this._globeProjMatrixInverted=a.bc(),this._cameraPosition=a.bs(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(m,g)=>{const b=a.ai(m.lat,-a.aj,a.aj),P=a.ai(+g,this.minZoom+Dn(0,b),this.maxZoom);return{center:new a.U(m.lng,b),zoom:P}},this._helper=new ia({calcMatrices:()=>{this._calcMatrices()},constrain:(m,g)=>this.defaultConstrain(m,g)},o),this._coveringTilesDetailsProvider=new UP}clone(){const o=new Ep;return o.apply(this),o}apply(o,m){this._globeLatitudeErrorCorrectionRadians=m||0,this._helper.apply(o)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const o=a.bs();return o[0]=this._cameraPosition[0],o[1]=this._cameraPosition[1],o[2]=this._cameraPosition[2],o}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(o){const{overscaledTileID:m,applyGlobeMatrix:g}=o,b=this._helper.getMercatorTileCoordinates(m);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:b,clippingPlane:this._cachedClippingPlane,projectionTransition:g?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(o){const m=this.pitchInRadians,g=this.cameraToCenterDistance/o,b=Math.sin(m)*g,P=Math.cos(m)*g+1,E=1/Math.sqrt(b*b+P*P)*1;let z=-b,B=P;const U=Math.sqrt(z*z+B*B);z/=U,B/=U;const G=[0,z,B];a.bz(G,G,[0,0,0],-this.bearingInRadians),a.bA(G,G,[0,0,0],-1*this.center.lat*Math.PI/180),a.bB(G,G,[0,0,0],this.center.lng*Math.PI/180);const J=1/a.b0(G);return a.aU(G,G,J),[...G,-E*J]}isLocationOccluded(o){return!this.isSurfacePointVisible(Ci(o))}transformLightDirection(o){const m=this._helper._center.lng*Math.PI/180,g=this._helper._center.lat*Math.PI/180,b=Math.cos(g),P=[Math.sin(m)*b,Math.sin(g),Math.cos(m)*b],E=[P[2],0,-P[0]],z=[0,0,0];a.aZ(z,E,P),a.aY(E,E),a.aY(z,z);const B=[0,0,0];return a.aY(B,[E[0]*o[0]+z[0]*o[1]+P[0]*o[2],E[1]*o[0]+z[1]*o[1]+P[1]*o[2],E[2]*o[0]+z[2]*o[1]+P[2]*o[2]]),B}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(o,m,g){const b=function(z,B,U){const G=1/(1<<U.z);return new a.a5(z/a.a3*G+U.x*G,B/a.a3*G+U.y*G)}(o,m,g.canonical),P=(E=b.y,[a.br(b.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI]);var E;return this.getCircleRadiusCorrection()/Math.cos(P[1])}projectTileCoordinates(o,m,g,b){const P=g.canonical,E=Rc(o,m,P.x,P.y,P.z),z=1+(b?b(o,m):0)/a.bx,B=[E[0]*z,E[1]*z,E[2]*z,1];a.aA(B,B,this._globeViewProjMatrixNoCorrection);const U=this._cachedClippingPlane,G=U[0]*E[0]+U[1]*E[1]+U[2]*E[2]+U[3]<0;return{point:new a.P(B[0]/B[3],B[1]/B[3]),signedDistanceFromCamera:B[3],isOccluded:G}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const o=zm(this.worldSize,this.center.lat),m=a.bd(),g=a.bd();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*o),a.b7(m,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const b=this.centerOffset;m[8]=2*-b.x/this._helper._width,m[9]=2*b.y/this._helper._height,this._projectionMatrix=a.b8(m),this._globeProjMatrixInverted=a.bd(),a.au(this._globeProjMatrixInverted,m),a.N(m,m,[0,0,-this.cameraToCenterDistance]),a.b9(m,m,this.rollInRadians),a.ba(m,m,-this.pitchInRadians),a.b9(m,m,this.bearingInRadians),a.N(m,m,[0,0,-o]);const P=a.bs();P[0]=o,P[1]=o,P[2]=o,a.ba(g,m,this.center.lat*Math.PI/180),a.bC(g,g,-this.center.lng*Math.PI/180),a.O(g,g,P),this._globeViewProjMatrixNoCorrection=g,a.ba(m,m,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),a.bC(m,m,-this.center.lng*Math.PI/180),a.O(m,m,P),this._globeViewProjMatrix32f=new Float32Array(m),this._globeViewProjMatrixNoCorrectionInverted=a.bd(),a.au(this._globeViewProjMatrixNoCorrectionInverted,g);const E=a.bs();this._cameraPosition=a.bs(),this._cameraPosition[2]=this.cameraToCenterDistance/o,a.bz(this._cameraPosition,this._cameraPosition,E,-this.rollInRadians),a.bA(this._cameraPosition,this._cameraPosition,E,this.pitchInRadians),a.bz(this._cameraPosition,this._cameraPosition,E,-this.bearingInRadians),a.aV(this._cameraPosition,this._cameraPosition,[0,0,1]),a.bA(this._cameraPosition,this._cameraPosition,E,-this.center.lat*Math.PI/180),a.bB(this._cameraPosition,this._cameraPosition,E,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(o);const z=a.b8(this._globeViewProjMatrixNoCorrectionInverted);a.O(z,z,[1,1,-1]),this._cachedFrustum=Im.fromInvProjectionMatrix(z,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(o){a.w("calculateFogMatrix is not supported on globe projection.");const m=a.bd();return a.am(m),m}getVisibleUnwrappedCoordinates(o){return[new a.b5(0,o)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(o){o&&a.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(o,m){if(!this._globeViewProjMatrixNoCorrection)return 1;const g=Ci(o);a.aU(g,g,1+m/a.bx);const b=a.by();return a.aA(b,[g[0],g[1],g[2],1],this._globeViewProjMatrixNoCorrection),b[2]/b[3]}populateCache(o){}getBounds(){const o=.5*this.width,m=.5*this.height,g=[new a.P(0,0),new a.P(o,0),new a.P(this.width,0),new a.P(this.width,m),new a.P(this.width,this.height),new a.P(o,this.height),new a.P(0,this.height),new a.P(0,m)],b=[];for(const J of g)b.push(this.unprojectScreenPoint(J));let P=0,E=0,z=0,B=0;const U=this.center;for(const J of b){const Y=a.bD(U.lng,J.lng),ne=a.bD(U.lat,J.lat);Y<E&&(E=Y),Y>P&&(P=Y),ne<B&&(B=ne),ne>z&&(z=ne)}const G=[U.lng+E,U.lat+B,U.lng+P,U.lat+z];return this.isSurfacePointOnScreen([0,1,0])&&(G[3]=90,G[0]=-180,G[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(G[1]=-90,G[0]=-180,G[2]=180),new Lr(G)}calculateCenterFromCameraLngLatAlt(o,m,g,b){return this._helper.calculateCenterFromCameraLngLatAlt(o,m,g,b)}setLocationAtPoint(o,m){const g=Ci(this.unprojectScreenPoint(m)),b=Ci(o),P=a.bs();a.bE(P);const E=a.bs();a.bB(E,g,P,-this.center.lng*Math.PI/180),a.bA(E,E,P,this.center.lat*Math.PI/180);const z=b[0]*b[0]+b[2]*b[2],B=E[0]*E[0];if(z<B)return;const U=Math.sqrt(z-B),G=-U,J=a.bF(b[0],b[2],E[0],U),Y=a.bF(b[0],b[2],E[0],G),ne=a.bs();a.bB(ne,b,P,-J);const fe=a.bF(ne[1],ne[2],E[1],E[2]),je=a.bs();a.bB(je,b,P,-Y);const we=a.bF(je[1],je[2],E[1],E[2]),Se=.5*Math.PI,Te=fe>=-Se&&fe<=Se,Le=we>=-Se&&we<=Se;let ke,Fe;if(Te&&Le){const ht=this.center.lng*Math.PI/180,it=this.center.lat*Math.PI/180;a.bG(J,ht)+a.bG(fe,it)<a.bG(Y,ht)+a.bG(we,it)?(ke=J,Fe=fe):(ke=Y,Fe=we)}else if(Te)ke=J,Fe=fe;else{if(!Le)return;ke=Y,Fe=we}const Be=ke/Math.PI*180,De=Fe/Math.PI*180,Ke=this.center.lat;this.setCenter(new a.U(Be,a.ai(De,-90,90))),this.setZoom(this.zoom+Dn(Ke,this.center.lat))}locationToScreenPoint(o,m){const g=Ci(o);if(m){const b=m.getElevationForLngLatZoom(o,this._helper._tileZoom);a.aU(g,g,1+b/a.bx)}return this._projectSurfacePointToScreen(g)}_projectSurfacePointToScreen(o){const m=a.by();return a.aA(m,[...o,1],this._globeViewProjMatrixNoCorrection),m[0]/=m[3],m[1]/=m[3],new a.P((.5*m[0]+.5)*this.width,(.5*-m[1]+.5)*this.height)}screenPointToMercatorCoordinate(o,m){if(m){const g=m.pointCoordinate(o);if(g)return g}return a.a5.fromLngLat(this.unprojectScreenPoint(o))}screenPointToLocation(o,m){var g;return(g=this.screenPointToMercatorCoordinate(o,m))===null||g===void 0?void 0:g.toLngLat()}isPointOnMapSurface(o,m){const g=this._cameraPosition,b=this.getRayDirectionFromPixel(o);return!!this.rayPlanetIntersection(g,b)}getRayDirectionFromPixel(o){const m=a.by();m[0]=o.x/this.width*2-1,m[1]=-1*(o.y/this.height*2-1),m[2]=1,m[3]=1,a.aA(m,m,this._globeViewProjMatrixNoCorrectionInverted),m[0]/=m[3],m[1]/=m[3],m[2]/=m[3];const g=a.bs();g[0]=m[0]-this._cameraPosition[0],g[1]=m[1]-this._cameraPosition[1],g[2]=m[2]-this._cameraPosition[2];const b=a.bs();return a.aY(b,g),b}isSurfacePointVisible(o){const m=this._cachedClippingPlane;return m[0]*o[0]+m[1]*o[1]+m[2]*o[2]+m[3]>=0}isSurfacePointOnScreen(o){if(!this.isSurfacePointVisible(o))return!1;const m=a.by();return a.aA(m,[...o,1],this._globeViewProjMatrixNoCorrection),m[0]/=m[3],m[1]/=m[3],m[2]/=m[3],m[0]>-1&&m[0]<1&&m[1]>-1&&m[1]<1&&m[2]>-1&&m[2]<1}rayPlanetIntersection(o,m){const g=a.a_(o,m),b=a.bs(),P=a.bs();a.aU(P,m,g),a.aX(b,o,P);const E=1-a.a_(b,b);if(E<0)return null;const z=a.a_(o,o)-1,B=-g+(g<0?1:-1)*Math.sqrt(E),U=z/B,G=B;return{tMin:Math.min(U,G),tMax:Math.max(U,G)}}unprojectScreenPoint(o){const m=this._cameraPosition,g=this.getRayDirectionFromPixel(o),b=this.rayPlanetIntersection(m,g);if(b){const G=a.bs();a.aV(G,m,[g[0]*b.tMin,g[1]*b.tMin,g[2]*b.tMin]);const J=a.bs();return a.aY(J,G),vj(J)}const P=this._cachedClippingPlane,E=P[0]*g[0]+P[1]*g[1]+P[2]*g[2],z=-a.b4(P,m)/E,B=a.bs();if(z>0)a.aV(B,m,[g[0]*z,g[1]*z,g[2]*z]);else{const G=a.bs();a.aV(G,m,[2*g[0],2*g[1],2*g[2]]);const J=a.b4(this._cachedClippingPlane,G);a.aX(B,G,[this._cachedClippingPlane[0]*J,this._cachedClippingPlane[1]*J,this._cachedClippingPlane[2]*J])}const U=function(G){const J=a.bs();return J[0]=G[0]*-G[3],J[1]=G[1]*-G[3],J[2]=G[2]*-G[3],{center:J,radius:Math.sqrt(1-G[3]*G[3])}}(P);return vj(function(G,J,Y){const ne=a.bs();a.aX(ne,Y,G);const fe=a.bs();return a.bt(fe,G,ne,J/a.b2(ne)),fe}(U.center,U.radius,B))}getMatrixForModel(o,m){const g=a.U.convert(o),b=1/a.bx,P=a.bc();return a.bC(P,P,g.lng/180*Math.PI),a.ba(P,P,-g.lat/180*Math.PI),a.N(P,P,[0,0,1+m/a.bx]),a.ba(P,P,.5*Math.PI),a.O(P,P,[b,b,b]),P}getProjectionDataForCustomLayer(o=!0){const m=this.getProjectionData({overscaledTileID:new a.a0(0,0,0,0,0),applyGlobeMatrix:o});return m.tileMercatorCoords=[0,0,1,1],m}getFastPathSimpleProjectionMatrix(o){}}class Mp{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(o){this._helper.setMinZoom(o)}setMaxZoom(o){this._helper.setMaxZoom(o)}setMinPitch(o){this._helper.setMinPitch(o)}setMaxPitch(o){this._helper.setMaxPitch(o)}setRenderWorldCopies(o){this._helper.setRenderWorldCopies(o)}setBearing(o){this._helper.setBearing(o)}setPitch(o){this._helper.setPitch(o)}setRoll(o){this._helper.setRoll(o)}setFov(o){this._helper.setFov(o)}setZoom(o){this._helper.setZoom(o)}setCenter(o){this._helper.setCenter(o)}setElevation(o){this._helper.setElevation(o)}setMinElevationForCurrentTile(o){this._helper.setMinElevationForCurrentTile(o)}setPadding(o){this._helper.setPadding(o)}interpolatePadding(o,m,g){return this._helper.interpolatePadding(o,m,g)}isPaddingEqual(o){return this._helper.isPaddingEqual(o)}resize(o,m,g=!0){this._helper.resize(o,m,g)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(o){this._helper.setMaxBounds(o)}setConstrain(o){this._helper.setConstrain(o)}overrideNearFarZ(o,m){this._helper.overrideNearFarZ(o,m)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(o){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),o)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrain(){return this._helper.constrain}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(o,m){this._globeness=o,this._globeLatitudeErrorCorrectionRadians=m,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(o){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(m,g)=>this.currentTransform.defaultConstrain(m,g),this._helper=new ia({calcMatrices:()=>{this._calcMatrices()},constrain:(m,g)=>this.defaultConstrain(m,g)},o),this._globeness=1,this._mercatorTransform=new fl,this._verticalPerspectiveTransform=new Ep}clone(){const o=new Mp;return o._globeness=this._globeness,o._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,o.apply(this),o}apply(o){this._helper.apply(o),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(o){const m=this._mercatorTransform.getProjectionData(o),g=this._verticalPerspectiveTransform.getProjectionData(o);return{mainMatrix:this.isGlobeRendering?g.mainMatrix:m.mainMatrix,clippingPlane:g.clippingPlane,tileMercatorCoords:g.tileMercatorCoords,projectionTransition:o.applyGlobeMatrix?this._globeness:0,fallbackMatrix:m.fallbackMatrix}}isLocationOccluded(o){return this.currentTransform.isLocationOccluded(o)}transformLightDirection(o){return this.currentTransform.transformLightDirection(o)}getPixelScale(){return a.bn(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return a.bn(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(o,m,g){const b=this._mercatorTransform.getPitchedTextCorrection(o,m,g),P=this._verticalPerspectiveTransform.getPitchedTextCorrection(o,m,g);return a.bn(b,P,this._globeness)}projectTileCoordinates(o,m,g,b){return this.currentTransform.projectTileCoordinates(o,m,g,b)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(o){return this.currentTransform.calculateFogMatrix(o)}getVisibleUnwrappedCoordinates(o){return this.currentTransform.getVisibleUnwrappedCoordinates(o)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(o){this._mercatorTransform.recalculateZoomAndCenter(o),this._verticalPerspectiveTransform.recalculateZoomAndCenter(o)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(o,m){return this.currentTransform.lngLatToCameraDepth(o,m)}populateCache(o){this._mercatorTransform.populateCache(o),this._verticalPerspectiveTransform.populateCache(o)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(o,m,g,b){return this._helper.calculateCenterFromCameraLngLatAlt(o,m,g,b)}setLocationAtPoint(o,m){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(o,m),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(o,m),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(o,m){return this.currentTransform.locationToScreenPoint(o,m)}screenPointToMercatorCoordinate(o,m){return this.currentTransform.screenPointToMercatorCoordinate(o,m)}screenPointToLocation(o,m){return this.currentTransform.screenPointToLocation(o,m)}isPointOnMapSurface(o,m){return this.currentTransform.isPointOnMapSurface(o,m)}getRayDirectionFromPixel(o){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(o)}getMatrixForModel(o,m){return this.currentTransform.getMatrixForModel(o,m)}getProjectionDataForCustomLayer(o=!0){const m=this._mercatorTransform.getProjectionDataForCustomLayer(o);if(!this.isGlobeRendering)return m;const g=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(o);return g.fallbackMatrix=m.mainMatrix,g}getFastPathSimpleProjectionMatrix(o){return this.currentTransform.getFastPathSimpleProjectionMatrix(o)}}class Fo{get useGlobeControls(){return!0}handlePanInertia(o,m){const g=Tp(o,m);return Math.abs(g.lng-m.center.lng)>180&&(g.lng=m.center.lng+179.5*Math.sign(g.lng-m.center.lng)),{easingCenter:g,easingOffset:new a.P(0,0)}}handleMapControlsRollPitchBearingZoom(o,m){const g=o.around,b=m.screenPointToLocation(g);o.bearingDelta&&m.setBearing(m.bearing+o.bearingDelta),o.pitchDelta&&m.setPitch(m.pitch+o.pitchDelta),o.rollDelta&&m.setRoll(m.roll+o.rollDelta);const P=m.zoom;o.zoomDelta&&m.setZoom(m.zoom+o.zoomDelta);const E=m.zoom-P;if(E===0)return;const z=a.bD(m.center.lng,b.lng),B=z/(Math.abs(z/180)+1),U=a.bD(m.center.lat,b.lat),G=m.getRayDirectionFromPixel(g),J=m.cameraPosition,Y=-1*a.a_(J,G),ne=a.bs();a.aV(ne,J,[G[0]*Y,G[1]*Y,G[2]*Y]);const fe=a.b0(ne)-1,je=Math.exp(.5*-Math.max(fe-.3,0)),we=zm(m.worldSize,m.center.lat)/Math.min(m.width,m.height),Se=a.bq(we,.9,.5,1,.25),Te=(1-a.al(-E))*Math.min(je,Se),Le=m.center.lat,ke=m.zoom,Fe=new a.U(m.center.lng+B*Te,a.ai(m.center.lat+U*Te,-a.aj,a.aj));m.setLocationAtPoint(b,g);const Be=m.center,De=a.bq(Math.abs(z),45,85,0,1),Ke=a.bq(we,.75,.35,0,1),ht=Math.pow(Math.max(De,Ke),.25),it=a.bD(Be.lng,Fe.lng),ot=a.bD(Be.lat,Fe.lat);m.setCenter(new a.U(Be.lng+it*ht,Be.lat+ot*ht).wrap()),m.setZoom(ke+Dn(Le,m.center.lat))}handleMapControlsPan(o,m,g){if(!o.panDelta)return;const b=m.center.lat,P=m.zoom;m.setCenter(Tp(o.panDelta,m).wrap()),m.setZoom(P+Dn(b,m.center.lat))}cameraForBoxAndBearing(o,m,g,b,P){const E=Dc(o,m,g,b,P),z=m.left/P.width*2-1,B=(P.width-m.right)/P.width*2-1,U=m.top/P.height*-2+1,G=(P.height-m.bottom)/P.height*-2+1,J=a.bD(g.getWest(),g.getEast())<0,Y=J?g.getEast():g.getWest(),ne=J?g.getWest():g.getEast(),fe=Math.max(g.getNorth(),g.getSouth()),je=Math.min(g.getNorth(),g.getSouth()),we=Y+.5*a.bD(Y,ne),Se=fe+.5*a.bD(fe,je),Te=P.clone();Te.setCenter(E.center),Te.setBearing(E.bearing),Te.setPitch(0),Te.setRoll(0),Te.setZoom(E.zoom);const Le=Te.modelViewProjectionMatrix,ke=[Ci(g.getNorthWest()),Ci(g.getNorthEast()),Ci(g.getSouthWest()),Ci(g.getSouthEast()),Ci(new a.U(ne,Se)),Ci(new a.U(Y,Se)),Ci(new a.U(we,fe)),Ci(new a.U(we,je))],Fe=Ci(E.center);let Be=Number.POSITIVE_INFINITY;for(const De of ke)z<0&&(Be=Fo.getLesserNonNegativeNonNull(Be,Fo.solveVectorScale(De,Fe,Le,"x",z))),B>0&&(Be=Fo.getLesserNonNegativeNonNull(Be,Fo.solveVectorScale(De,Fe,Le,"x",B))),U>0&&(Be=Fo.getLesserNonNegativeNonNull(Be,Fo.solveVectorScale(De,Fe,Le,"y",U))),G<0&&(Be=Fo.getLesserNonNegativeNonNull(Be,Fo.solveVectorScale(De,Fe,Le,"y",G)));if(Number.isFinite(Be)&&Be!==0)return E.zoom=Te.zoom+a.ao(Be),E;Bs()}handleJumpToCenterZoom(o,m){const g=o.center.lat,b=o.constrain(m.center?a.U.convert(m.center):o.center,o.zoom).center;o.setCenter(b.wrap());const P=m.zoom!==void 0?+m.zoom:o.zoom+Dn(g,b.lat);o.zoom!==P&&o.setZoom(P)}handleEaseTo(o,m){const g=o.zoom,b=o.center,P=o.padding,E={roll:o.roll,pitch:o.pitch,bearing:o.bearing},z={roll:m.roll===void 0?o.roll:m.roll,pitch:m.pitch===void 0?o.pitch:m.pitch,bearing:m.bearing===void 0?o.bearing:m.bearing},B=m.zoom!==void 0,U=!o.isPaddingEqual(m.padding);let G=!1;const J=m.center?a.U.convert(m.center):b,Y=o.constrain(J,g).center;ss(o,Y);const ne=o.clone();ne.setCenter(Y),ne.setZoom(B?+m.zoom:g+Dn(b.lat,J.lat)),ne.setBearing(m.bearing);const fe=new a.P(a.ai(o.centerPoint.x+m.offsetAsPoint.x,0,o.width),a.ai(o.centerPoint.y+m.offsetAsPoint.y,0,o.height));ne.setLocationAtPoint(Y,fe);const je=(m.offset&&m.offsetAsPoint.mag())>0?ne.center:Y,we=B?+m.zoom:g+Dn(b.lat,je.lat),Se=g+Dn(b.lat,0),Te=we+Dn(je.lat,0),Le=a.bD(b.lng,je.lng),ke=a.bD(b.lat,je.lat),Fe=a.al(Te-Se);return G=we!==g,{easeFunc:Be=>{if(a.bh(E,z)||Gu({startEulerAngles:E,endEulerAngles:z,tr:o,k:Be,useSlerp:E.roll!=z.roll}),U&&o.interpolatePadding(P,m.padding,Be),m.around)a.w("Easing around a point is not supported under globe projection."),o.setLocationAtPoint(m.around,m.aroundPoint);else{const De=Te>Se?Math.min(2,Fe):Math.max(.5,Fe),Ke=Math.pow(De,1-Be),ht=$m(b,Le,ke,Be*Ke);o.setCenter(ht.wrap())}if(G){const De=a.F.number(Se,Te,Be)+Dn(0,o.center.lat);o.setZoom(De)}},isZooming:G,elevationCenter:je}}handleFlyTo(o,m){const g=m.zoom!==void 0,b=o.center,P=o.zoom,E=o.padding,z=!o.isPaddingEqual(m.padding),B=o.constrain(a.U.convert(m.center||m.locationAtOffset),P).center,U=g?+m.zoom:o.zoom+Dn(o.center.lat,B.lat),G=o.clone();G.setCenter(B),G.setZoom(U),G.setBearing(m.bearing);const J=new a.P(a.ai(o.centerPoint.x+m.offsetAsPoint.x,0,o.width),a.ai(o.centerPoint.y+m.offsetAsPoint.y,0,o.height));G.setLocationAtPoint(B,J);const Y=G.center;ss(o,Y);const ne=function(ke,Fe,Be){const De=Ci(Fe),Ke=Ci(Be),ht=a.a_(De,Ke),it=Math.acos(ht),ot=Zu(ke);return it/(2*Math.PI)*ot}(o,b,Y),fe=P+Dn(b.lat,0),je=U+Dn(Y.lat,0),we=a.al(je-fe);let Se;if(typeof m.minZoom=="number"){const ke=+m.minZoom+Dn(Y.lat,0),Fe=Math.min(ke,fe,je)+Dn(0,Y.lat),Be=o.constrain(Y,Fe).zoom+Dn(Y.lat,0);Se=a.al(Be-fe)}const Te=a.bD(b.lng,Y.lng),Le=a.bD(b.lat,Y.lat);return{easeFunc:(ke,Fe,Be,De)=>{const Ke=$m(b,Te,Le,Be);z&&o.interpolatePadding(E,m.padding,ke);const ht=ke===1?Y:Ke;o.setCenter(ht.wrap());const it=fe+a.ao(Fe);o.setZoom(ke===1?U:it+Dn(0,ht.lat))},scaleOfZoom:we,targetCenter:Y,scaleOfMinZoom:Se,pixelPathLength:ne}}static solveVectorScale(o,m,g,b,P){const E=b==="x"?[g[0],g[4],g[8],g[12]]:[g[1],g[5],g[9],g[13]],z=[g[3],g[7],g[11],g[15]],B=o[0]*E[0]+o[1]*E[1]+o[2]*E[2],U=o[0]*z[0]+o[1]*z[1]+o[2]*z[2],G=m[0]*E[0]+m[1]*E[1]+m[2]*E[2],J=m[0]*z[0]+m[1]*z[1]+m[2]*z[2];return G+P*U===B+P*J||z[3]*(B-G)+E[3]*(J-U)+B*J==G*U?null:(G+E[3]-P*J-P*z[3])/(G-B-P*J+P*U)}static getLesserNonNegativeNonNull(o,m){return m!==null&&m>=0&&m<o?m:o}}class Bm{constructor(o){this._globe=o,this._mercatorCameraHelper=new Pd,this._verticalPerspectiveCameraHelper=new Fo}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(o,m){return this.currentHelper.handlePanInertia(o,m)}handleMapControlsRollPitchBearingZoom(o,m){return this.currentHelper.handleMapControlsRollPitchBearingZoom(o,m)}handleMapControlsPan(o,m,g){this.currentHelper.handleMapControlsPan(o,m,g)}cameraForBoxAndBearing(o,m,g,b,P){return this.currentHelper.cameraForBoxAndBearing(o,m,g,b,P)}handleJumpToCenterZoom(o,m){this.currentHelper.handleJumpToCenterZoom(o,m)}handleEaseTo(o,m){return this.currentHelper.handleEaseTo(o,m)}handleFlyTo(o,m){return this.currentHelper.handleFlyTo(o,m)}}const Yu=(N,o)=>a.z(N,o&&o.filter(m=>m.identifier!=="source.canvas")),Op=a.bH();class qm extends a.E{constructor(o,m={}){var g,b;super(),this._rtlPluginLoaded=()=>{for(const E in this.tileManagers){const z=this.tileManagers[E].getSource().type;z!=="vector"&&z!=="geojson"||this.tileManagers[E].reload()}},this.map=o,this.dispatcher=new St(_r(),o._getMapId()),this.dispatcher.registerMessageHandler("GG",(E,z)=>this.getGlyphs(E,z)),this.dispatcher.registerMessageHandler("GI",(E,z)=>this.getImages(E,z)),this.dispatcher.registerMessageHandler("GDA",(E,z)=>this.getDashes(E,z)),this.imageManager=new ie,this.imageManager.setEventedParent(this);const P=((g=o._container)===null||g===void 0?void 0:g.lang)||typeof document<"u"&&((b=document.documentElement)===null||b===void 0?void 0:b.lang)||void 0;this.glyphManager=new Ue(o._requestManager,m.localIdeographFontFamily,P),this.lineAtlas=new gt(256,512),this.crossTileSymbolIndex=new Wl,this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new a.bI,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",a.bJ()),ue().on(zs,this._rtlPluginLoaded),this.on("data",E=>{if(E.dataType!=="source"||E.sourceDataType!=="metadata")return;const z=this.tileManagers[E.sourceId];if(!z)return;const B=z.getSource();if(B&&B.vectorLayerIds)for(const U in this._layers){const G=this._layers[U];G.source===B.id&&this._validateLayer(G)}})}setGlobalStateProperty(o,m){var g,b,P;this._checkLoaded();const E=m===null?(P=(b=(g=this.stylesheet.state)===null||g===void 0?void 0:g[o])===null||b===void 0?void 0:b.default)!==null&&P!==void 0?P:null:m;if(a.bK(E,this._globalState[o]))return this;this._globalState[o]=E,this._applyGlobalStateChanges([o])}getGlobalState(){return this._globalState}setGlobalState(o){this._checkLoaded();const m=[];for(const g in o)!a.bK(this._globalState[g],o[g].default)&&(m.push(g),this._globalState[g]=o[g].default);this._applyGlobalStateChanges(m)}_applyGlobalStateChanges(o){if(o.length===0)return;const m=new Set,g={};for(const b of o){g[b]=this._globalState[b];for(const P in this._layers){const E=this._layers[P],z=E.getLayoutAffectingGlobalStateRefs(),B=E.getPaintAffectingGlobalStateRefs();if(z.has(b)&&m.add(E.source),B.has(b))for(const{name:U,value:G}of B.get(b))this._updatePaintProperty(E,U,G)}}this.dispatcher.broadcast("UGS",g);for(const b in this.tileManagers)m.has(b)&&(this._reloadSource(b),this._changed=!0)}loadURL(o,m={},g){this.fire(new a.l("dataloading",{dataType:"style"})),m.validate=typeof m.validate!="boolean"||m.validate;const b=this.map._requestManager.transformRequest(o,"Style");this._loadStyleRequest=new AbortController;const P=this._loadStyleRequest;a.j(b,this._loadStyleRequest).then(E=>{this._loadStyleRequest=null,this._load(E.data,m,g)}).catch(E=>{this._loadStyleRequest=null,E&&!P.signal.aborted&&this.fire(new a.k(E))})}loadJSON(o,m={},g){this.fire(new a.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,j.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,m.validate=m.validate!==!1,this._load(o,m,g)}).catch(()=>{})}loadEmpty(){this.fire(new a.l("dataloading",{dataType:"style"})),this._load(Op,{validate:!1})}_load(o,m,g){var b,P;let E=m.transformStyle?m.transformStyle(g,o):o;if(!m.validate||!Yu(this,a.B(E))){E=Object.assign({},E),this._loaded=!0,this.stylesheet=E;for(const z in E.sources)this.addSource(z,E.sources[z],{validate:!1});E.sprite?this._loadSprite(E.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(E.glyphs),this._createLayers(),this.light=new ve(this.stylesheet.light),this._setProjectionInternal(((b=this.stylesheet.projection)===null||b===void 0?void 0:b.type)||"mercator"),this.sky=new vt(this.stylesheet.sky),this.map.setTerrain((P=this.stylesheet.terrain)!==null&&P!==void 0?P:null),this.fire(new a.l("data",{dataType:"style"})),this.fire(new a.l("style.load"))}}_createLayers(){var o,m,g;const b=a.bL(this.stylesheet.layers);this.setGlobalState((o=this.stylesheet.state)!==null&&o!==void 0?o:null),this.dispatcher.broadcast("SL",b),this._order=b.map(P=>P.id),this._layers={},this._serializedLayers=null;for(const P of b){const E=a.bM(P,this._globalState);if(E.setEventedParent(this,{layer:{id:P.id}}),this._layers[P.id]=E,a.bN(E)&&this.tileManagers[E.source]){const z=(g=(m=P.paint)===null||m===void 0?void 0:m["raster-fade-duration"])!==null&&g!==void 0?g:E.paint.get("raster-fade-duration");this.tileManagers[E.source].setRasterFadeDuration(z)}}}_loadSprite(o,m=!1,g=void 0){let b;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(P,E,z,B){return a._(this,void 0,void 0,function*(){const U=oe(P),G=z>1?"@2x":"",J={},Y={};for(const{id:ne,url:fe}of U){const je=E.transformRequest(te(fe,G,".json"),"SpriteJSON");J[ne]=a.j(je,B);const we=E.transformRequest(te(fe,G,".png"),"SpriteImage");Y[ne]=W.getImage(we,B)}return yield Promise.all([...Object.values(J),...Object.values(Y)]),function(ne,fe){return a._(this,void 0,void 0,function*(){const je={};for(const we in ne){je[we]={};const Se=j.getImageCanvasContext((yield fe[we]).data),Te=(yield ne[we]).data;for(const Le in Te){const{width:ke,height:Fe,x:Be,y:De,sdf:Ke,pixelRatio:ht,stretchX:it,stretchY:ot,content:mt,textFitWidth:Tt,textFitHeight:Mt}=Te[Le];je[we][Le]={data:null,pixelRatio:ht,sdf:Ke,stretchX:it,stretchY:ot,content:mt,textFitWidth:Tt,textFitHeight:Mt,spriteData:{width:ke,height:Fe,x:Be,y:De,context:Se}}}}return je})}(J,Y)})}(o,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(P=>{if(this._spriteRequest=null,P)for(const E in P){this._spritesImagesIds[E]=[];const z=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter(B=>!(B in P)):[];for(const B of z)this.imageManager.removeImage(B),this._changedImages[B]=!0;for(const B in P[E]){const U=E==="default"?B:`${E}:${B}`;this._spritesImagesIds[E].push(U),U in this.imageManager.images?this.imageManager.updateImage(U,P[E][B],!1):this.imageManager.addImage(U,P[E][B]),m&&(this._changedImages[U]=!0)}}}).catch(P=>{this._spriteRequest=null,b=P,this.fire(new a.k(b))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),m&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"})),g&&g(b)})}_unloadSprite(){for(const o of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(o),this._changedImages[o]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}_validateLayer(o){const m=this.tileManagers[o.source];if(!m)return;const g=o.sourceLayer;if(!g)return;const b=m.getSource();(b.type==="geojson"||b.vectorLayerIds&&b.vectorLayerIds.indexOf(g)===-1)&&this.fire(new a.k(new Error(`Source layer "${g}" does not exist on source "${b.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.tileManagers)if(!this.tileManagers[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(o,m=!1){const g=this._serializedAllLayers();if(!o||o.length===0)return Object.values(m?a.bO(g):g);const b=[];for(const P of o)if(g[P]){const E=m?a.bO(g[P]):g[P];b.push(E)}return b}_serializedAllLayers(){let o=this._serializedLayers;if(o)return o;o=this._serializedLayers={};const m=Object.keys(this._layers);for(const g of m){const b=this._layers[g];b.type!=="custom"&&(o[g]=b.serialize())}return o}hasTransitions(){var o,m,g;if(!((o=this.light)===null||o===void 0)&&o.hasTransition()||!((m=this.sky)===null||m===void 0)&&m.hasTransition()||!((g=this.projection)===null||g===void 0)&&g.hasTransition())return!0;for(const b in this.tileManagers)if(this.tileManagers[b].hasTransition())return!0;for(const b in this._layers)if(this._layers[b].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const m=this._changed;if(m){const b=Object.keys(this._updatedLayers),P=Object.keys(this._removedLayers);(b.length||P.length)&&this._updateWorkerLayers(b,P);for(const E in this._updatedSources){const z=this._updatedSources[E];if(z==="reload")this._reloadSource(E);else{if(z!=="clear")throw new Error(`Invalid action ${z}`);this._clearSource(E)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(o);this.light.updateTransitions(o),this.sky.updateTransitions(o),this._resetUpdates()}const g={};for(const b in this.tileManagers){const P=this.tileManagers[b];g[b]=P.used,P.used=!1}for(const b of this._order){const P=this._layers[b];P.recalculate(o,this._availableImages),!P.isHidden(o.zoom)&&P.source&&(this.tileManagers[P.source].used=!0)}for(const b in g){const P=this.tileManagers[b];!!g[b]!=!!P.used&&P.fire(new a.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:b}))}this.light.recalculate(o),this.sky.recalculate(o),this.projection.recalculate(o),this.z=o.zoom,m&&this.fire(new a.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const m in this.tileManagers)this.tileManagers[m].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const o in this.tileManagers)this.tileManagers[o].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(o,m){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(o,!1),removedIds:m})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(o,m={}){var g;this._checkLoaded();const b=this.serialize();if(o=m.transformStyle?m.transformStyle(b,o):o,((g=m.validate)===null||g===void 0||g)&&Yu(this,a.B(o)))return!1;(o=a.bO(o)).layers=a.bL(o.layers);const P=a.bP(b,o),E=this._getOperationsToPerform(P);if(E.unimplemented.length>0)throw new Error(`Unimplemented: ${E.unimplemented.join(", ")}.`);if(E.operations.length===0)return!1;for(const z of E.operations)z();return this.stylesheet=o,this._serializedLayers=null,!0}_getOperationsToPerform(o){const m=[],g=[];for(const b of o)switch(b.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":m.push(()=>this.addLayer.apply(this,b.args));break;case"removeLayer":m.push(()=>this.removeLayer.apply(this,b.args));break;case"setPaintProperty":m.push(()=>this.setPaintProperty.apply(this,b.args));break;case"setLayoutProperty":m.push(()=>this.setLayoutProperty.apply(this,b.args));break;case"setFilter":m.push(()=>this.setFilter.apply(this,b.args));break;case"addSource":m.push(()=>this.addSource.apply(this,b.args));break;case"removeSource":m.push(()=>this.removeSource.apply(this,b.args));break;case"setLayerZoomRange":m.push(()=>this.setLayerZoomRange.apply(this,b.args));break;case"setLight":m.push(()=>this.setLight.apply(this,b.args));break;case"setGeoJSONSourceData":m.push(()=>this.setGeoJSONSourceData.apply(this,b.args));break;case"setGlyphs":m.push(()=>this.setGlyphs.apply(this,b.args));break;case"setSprite":m.push(()=>this.setSprite.apply(this,b.args));break;case"setTerrain":m.push(()=>this.map.setTerrain.apply(this,b.args));break;case"setSky":m.push(()=>this.setSky.apply(this,b.args));break;case"setProjection":this.setProjection.apply(this,b.args);break;case"setGlobalState":m.push(()=>this.setGlobalState.apply(this,b.args));break;case"setTransition":m.push(()=>{});break;default:g.push(b.command)}return{operations:m,unimplemented:g}}addImage(o,m){if(this.getImage(o))return this.fire(new a.k(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,m),this._afterImageUpdated(o)}updateImage(o,m){this.imageManager.updateImage(o,m)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new a.k(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,m,g={}){if(this._checkLoaded(),this.tileManagers[o]!==void 0)throw new Error(`Source "${o}" already exists.`);if(!m.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(m).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(a.B.source,`sources.${o}`,m,null,g))return;this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);const b=this.tileManagers[o]=new Mn(o,m,this.dispatcher);b.style=this,b.setEventedParent(this,()=>({isSourceLoaded:b.loaded(),source:b.serialize(),sourceId:o})),b.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),this.tileManagers[o]===void 0)throw new Error("There is no source with this ID");for(const g in this._layers)if(this._layers[g].source===o)return this.fire(new a.k(new Error(`Source "${o}" cannot be removed while layer "${g}" is using it.`)));const m=this.tileManagers[o];delete this.tileManagers[o],delete this._updatedSources[o],m.fire(new a.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),m.setEventedParent(null),m.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,m){if(this._checkLoaded(),this.tileManagers[o]===void 0)throw new Error(`There is no source with this ID=${o}`);const g=this.tileManagers[o].getSource();if(g.type!=="geojson")throw new Error(`geojsonSource.type is ${g.type}, which is !== 'geojson`);g.setData(m),this._changed=!0}getSource(o){return this.tileManagers[o]&&this.tileManagers[o].getSource()}addLayer(o,m,g={}){this._checkLoaded();const b=o.id;if(this.getLayer(b))return void this.fire(new a.k(new Error(`Layer "${b}" already exists on this map.`)));let P;if(o.type==="custom"){if(Yu(this,a.bQ(o)))return;P=a.bM(o,this._globalState)}else{if("source"in o&&typeof o.source=="object"&&(this.addSource(b,o.source),o=a.bO(o),o=a.e(o,{source:b})),this._validate(a.B.layer,`layers.${b}`,o,{arrayIndex:-1},g))return;P=a.bM(o,this._globalState),this._validateLayer(P),P.setEventedParent(this,{layer:{id:b}})}const E=m?this._order.indexOf(m):this._order.length;if(m&&E===-1)this.fire(new a.k(new Error(`Cannot add layer "${b}" before non-existing layer "${m}".`)));else{if(this._order.splice(E,0,b),this._layerOrderChanged=!0,this._layers[b]=P,this._removedLayers[b]&&P.source&&P.type!=="custom"){const z=this._removedLayers[b];delete this._removedLayers[b],z.type!==P.type?this._updatedSources[P.source]="clear":(this._updatedSources[P.source]="reload",this.tileManagers[P.source].pause())}this._updateLayer(P),P.onAdd&&P.onAdd(this.map)}}moveLayer(o,m){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new a.k(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===m)return;const g=this._order.indexOf(o);this._order.splice(g,1);const b=m?this._order.indexOf(m):this._order.length;m&&b===-1?this.fire(new a.k(new Error(`Cannot move layer "${o}" before non-existing layer "${m}".`))):(this._order.splice(b,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const m=this._layers[o];if(!m)return void this.fire(new a.k(new Error(`Cannot remove non-existing layer "${o}".`)));m.setEventedParent(null);const g=this._order.indexOf(o);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=m,delete this._layers[o],this._serializedLayers&&delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],m.onRemove&&m.onRemove(this.map)}getLayer(o){return this._layers[o]}getLayersOrder(){return[...this._order]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,m,g){this._checkLoaded();const b=this.getLayer(o);b?b.minzoom===m&&b.maxzoom===g||(m!=null&&(b.minzoom=m),g!=null&&(b.maxzoom=g),this._updateLayer(b)):this.fire(new a.k(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,m,g={}){this._checkLoaded();const b=this.getLayer(o);if(b){if(!a.bK(b.filter,m))return m==null?(b.setFilter(void 0),void this._updateLayer(b)):void(this._validate(a.B.filter,`layers.${b.id}.filter`,m,null,g)||(b.setFilter(a.bO(m)),this._updateLayer(b)))}else this.fire(new a.k(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return a.bO(this.getLayer(o).filter)}setLayoutProperty(o,m,g,b={}){this._checkLoaded();const P=this.getLayer(o);P?a.bK(P.getLayoutProperty(m),g)||(P.setLayoutProperty(m,g,b),this._updateLayer(P)):this.fire(new a.k(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,m){const g=this.getLayer(o);if(g)return g.getLayoutProperty(m);this.fire(new a.k(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,m,g,b={}){this._checkLoaded();const P=this.getLayer(o);P?a.bK(P.getPaintProperty(m),g)||this._updatePaintProperty(P,m,g,b):this.fire(new a.k(new Error(`Cannot style non-existing layer "${o}".`)))}_updatePaintProperty(o,m,g,b={}){o.setPaintProperty(m,g,b)&&this._updateLayer(o),a.bN(o)&&m==="raster-fade-duration"&&this.tileManagers[o.source].setRasterFadeDuration(g),this._changed=!0,this._updatedPaintProps[o.id]=!0,this._serializedLayers=null}getPaintProperty(o,m){return this.getLayer(o).getPaintProperty(m)}setFeatureState(o,m){this._checkLoaded();const g=o.source,b=o.sourceLayer,P=this.tileManagers[g];if(P===void 0)return void this.fire(new a.k(new Error(`The source '${g}' does not exist in the map's style.`)));const E=P.getSource().type;E==="geojson"&&b?this.fire(new a.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||b?(o.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),P.setFeatureState(b,o.id,m)):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,m){this._checkLoaded();const g=o.source,b=this.tileManagers[g];if(b===void 0)return void this.fire(new a.k(new Error(`The source '${g}' does not exist in the map's style.`)));const P=b.getSource().type,E=P==="vector"?o.sourceLayer:void 0;P!=="vector"||E?m&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new a.k(new Error("A feature id is required to remove its specific state property."))):b.removeFeatureState(E,o.id,m):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const m=o.source,g=o.sourceLayer,b=this.tileManagers[m];if(b!==void 0)return b.getSource().type!=="vector"||g?(o.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),b.getFeatureState(g,o.id)):void this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.k(new Error(`The source '${m}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const o=a.bR(this.tileManagers,P=>P.serialize()),m=this._serializeByIds(this._order,!0),g=this.map.getTerrain()||void 0,b=this.stylesheet;return a.bS({version:b.version,name:b.name,metadata:b.metadata,light:b.light,sky:b.sky,center:b.center,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch,sprite:b.sprite,glyphs:b.glyphs,transition:b.transition,projection:b.projection,sources:o,layers:m,terrain:g},P=>P!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.tileManagers[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.tileManagers[o.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(o){const m=E=>this._layers[E].type==="fill-extrusion",g={},b=[];for(let E=this._order.length-1;E>=0;E--){const z=this._order[E];if(m(z)){g[z]=E;for(const B of o){const U=B[z];if(U)for(const G of U)b.push(G)}}}b.sort((E,z)=>z.intersectionZ-E.intersectionZ);const P=[];for(let E=this._order.length-1;E>=0;E--){const z=this._order[E];if(m(z))for(let B=b.length-1;B>=0;B--){const U=b[B].feature;if(g[U.layer.id]<E)break;P.push(U),b.pop()}else for(const B of o){const U=B[z];if(U)for(const G of U)P.push(G.feature)}}return P}queryRenderedFeatures(o,m,g){m&&m.filter&&this._validate(a.B.filter,"queryRenderedFeatures.filter",m.filter,null,m);const b={};if(m&&m.layers){if(!(Array.isArray(m.layers)||m.layers instanceof Set))return this.fire(new a.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const U of m.layers){const G=this._layers[U];if(!G)return this.fire(new a.k(new Error(`The layer '${U}' does not exist in the map's style and cannot be queried for features.`))),[];b[G.source]=!0}}const P=[];m.availableImages=this._availableImages;const E=this._serializedAllLayers(),z=m.layers instanceof Set?m.layers:Array.isArray(m.layers)?new Set(m.layers):null,B=Object.assign(Object.assign({},m),{layers:z,globalState:this._globalState});for(const U in this.tileManagers)m.layers&&!b[U]||P.push(pt(this.tileManagers[U],this._layers,E,o,B,g,this.map.terrain?(G,J,Y)=>this.map.terrain.getElevation(G,J,Y):void 0));return this.placement&&P.push(function(U,G,J,Y,ne,fe,je){const we={},Se=fe.queryRenderedSymbols(Y),Te=[];for(const Le of Object.keys(Se).map(Number))Te.push(je[Le]);Te.sort(qr);for(const Le of Te){const ke=Le.featureIndex.lookupSymbolFeatures(Se[Le.bucketInstanceId],G,Le.bucketIndex,Le.sourceLayerIndex,{filterSpec:ne.filter,globalState:ne.globalState},ne.layers,ne.availableImages,U);for(const Fe in ke){const Be=we[Fe]=we[Fe]||[],De=ke[Fe];De.sort((Ke,ht)=>{const it=Le.featureSortOrder;if(it){const ot=it.indexOf(Ke.featureIndex);return it.indexOf(ht.featureIndex)-ot}return ht.featureIndex-Ke.featureIndex});for(const Ke of De)Be.push(Ke)}}return function(Le,ke,Fe){for(const Be in Le)for(const De of Le[Be])or(De,Fe[ke[Be].source]);return Le}(we,U,J)}(this._layers,E,this.tileManagers,o,B,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(P)}querySourceFeatures(o,m){m!=null&&m.filter&&this._validate(a.B.filter,"querySourceFeatures.filter",m.filter,null,m);const g=this.tileManagers[o];return g?function(b,P){const E=b.getRenderableIds().map(U=>b.getTileByID(U)),z=[],B={};for(let U=0;U<E.length;U++){const G=E[U],J=G.tileID.canonical.key;B[J]||(B[J]=!0,G.querySourceFeatures(z,P))}return z}(g,m?Object.assign(Object.assign({},m),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(o,m={}){this._checkLoaded();const g=this.light.getLight();let b=!1;for(const E in o)if(!a.bK(o[E],g[E])){b=!0;break}if(!b)return;const P={now:k(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,m),this.light.updateTransitions(P)}getProjection(){var o;return(o=this.stylesheet)===null||o===void 0?void 0:o.projection}setProjection(o){if(this._checkLoaded(),this.projection){if(this.projection.name===o.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=o,this._setProjectionInternal(o.type)}getSky(){var o;return(o=this.stylesheet)===null||o===void 0?void 0:o.sky}setSky(o,m={}){this._checkLoaded();const g=this.getSky();let b=!1;if(!o&&!g)return;if(o&&!g)b=!0;else if(!o&&g)b=!0;else for(const E in o)if(!a.bK(o[E],g[E])){b=!0;break}if(!b)return;const P={now:k(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=o,this.sky.setSky(o,m),this.sky.updateTransitions(P)}_setProjectionInternal(o){const m=function(g,b){const P={constrain:b};if(Array.isArray(g)){const E=new Fm({type:g});return{projection:E,transform:new Mp(P),cameraHelper:new Bm(E)}}switch(g){case"mercator":return{projection:new Vi,transform:new fl(P),cameraHelper:new Pd};case"globe":{const E=new Fm({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:E,transform:new Mp(P),cameraHelper:new Bm(E)}}case"vertical-perspective":return{projection:new Cp,transform:new Ep(P),cameraHelper:new Fo};default:return a.w(`Unknown projection name: ${g}. Falling back to mercator projection.`),{projection:new Vi,transform:new fl(P),cameraHelper:new Pd}}}(o,this.map.transformConstrain);this.projection=m.projection,this.map.migrateProjection(m.transform,m.cameraHelper);for(const g in this.tileManagers)this.tileManagers[g].reload()}_validate(o,m,g,b,P={}){return(!P||P.validate!==!1)&&Yu(this,o.call(a.B,a.e({key:m,style:this.serialize(),value:g,styleSpec:a.t},b)))}_remove(o=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ue().off(zs,this._rtlPluginLoaded);for(const m in this._layers)this._layers[m].setEventedParent(null);for(const m in this.tileManagers){const g=this.tileManagers[m];g.setEventedParent(null),g.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),o&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(o)}_clearSource(o){this.tileManagers[o].clearTiles()}_reloadSource(o){this.tileManagers[o].resume(),this.tileManagers[o].reload()}_updateSources(o){for(const m in this.tileManagers)this.tileManagers[m].update(o,this.map.terrain)}_generateCollisionBoxes(){for(const o in this.tileManagers)this._reloadSource(o)}_updatePlacement(o,m,g,b,P=!1){let E=!1,z=!1;const B={};for(const U of this._order){const G=this._layers[U];if(G.type!=="symbol")continue;if(!B[G.source]){const Y=this.tileManagers[G.source];B[G.source]=Y.getRenderableIds(!0).map(ne=>Y.getTileByID(ne)).sort((ne,fe)=>fe.tileID.overscaledZ-ne.tileID.overscaledZ||(ne.tileID.isLessThan(fe.tileID)?-1:1))}const J=this.crossTileSymbolIndex.addLayer(G,B[G.source],o.center.lng);E=E||J}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((P=P||this._layerOrderChanged||g===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(k(),o.zoom))&&(this.pauseablePlacement=new Np(o,this.map.terrain,this._order,P,m,g,b,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,B),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(k()),z=!0),E&&this.pauseablePlacement.placement.setStale()),z||E)for(const U of this._order){const G=this._layers[U];G.type==="symbol"&&this.placement.updateLayerOpacities(G,B[G.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(k())}_releaseSymbolFadeTiles(){for(const o in this.tileManagers)this.tileManagers[o].releaseSymbolFadeTiles()}getImages(o,m){return a._(this,void 0,void 0,function*(){const g=yield this.imageManager.getImages(m.icons);this._updateTilesForChangedImages();const b=this.tileManagers[m.source];return b&&b.setDependencies(m.tileID.key,m.type,m.icons),g})}getGlyphs(o,m){return a._(this,void 0,void 0,function*(){const g=yield this.glyphManager.getGlyphs(m.stacks),b=this.tileManagers[m.source];return b&&b.setDependencies(m.tileID.key,m.type,[""]),g})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(o,m={}){this._checkLoaded(),o&&this._validate(a.B.glyphs,"glyphs",o,null,m)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=o,this.glyphManager.entries={},this.glyphManager.setURL(o))}getDashes(o,m){return a._(this,void 0,void 0,function*(){const g={};for(const[b,P]of Object.entries(m.dashes))g[b]=this.lineAtlas.getDash(P.dasharray,P.round);return g})}addSprite(o,m,g={},b){this._checkLoaded();const P=[{id:o,url:m}],E=[...oe(this.stylesheet.sprite),...P];this._validate(a.B.sprite,"sprite",E,null,g)||(this.stylesheet.sprite=E,this._loadSprite(P,!0,b))}removeSprite(o){this._checkLoaded();const m=oe(this.stylesheet.sprite);if(m.find(g=>g.id===o)){if(this._spritesImagesIds[o])for(const g of this._spritesImagesIds[o])this.imageManager.removeImage(g),this._changedImages[g]=!0;m.splice(m.findIndex(g=>g.id===o),1),this.stylesheet.sprite=m.length>0?m:void 0,delete this._spritesImagesIds[o],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}else this.fire(new a.k(new Error(`Sprite "${o}" doesn't exists on this map.`)))}getSprite(){return oe(this.stylesheet.sprite)}setSprite(o,m={},g){this._checkLoaded(),o&&this._validate(a.B.sprite,"sprite",o,null,m)||(this.stylesheet.sprite=o,o?this._loadSprite(o,!0,g):(this._unloadSprite(),g&&g(null)))}}var hv=a.aN([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class pl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,m,g,b,P,E,z,B,U){this.context=o;let G=this.boundPaintVertexBuffers.length!==b.length;for(let J=0;!G&&J<b.length;J++)this.boundPaintVertexBuffers[J]!==b[J]&&(G=!0);!this.vao||this.boundProgram!==m||this.boundLayoutVertexBuffer!==g||G||this.boundIndexBuffer!==P||this.boundVertexOffset!==E||this.boundDynamicVertexBuffer!==z||this.boundDynamicVertexBuffer2!==B||this.boundDynamicVertexBuffer3!==U?this.freshBind(m,g,b,P,E,z,B,U):(o.bindVertexArray.set(this.vao),z&&z.bind(),P&&P.dynamicDraw&&P.bind(),B&&B.bind(),U&&U.bind())}freshBind(o,m,g,b,P,E,z,B){const U=o.numAttributes,G=this.context,J=G.gl;this.vao&&this.destroy(),this.vao=G.createVertexArray(),G.bindVertexArray.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=b,this.boundVertexOffset=P,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=z,this.boundDynamicVertexBuffer3=B,m.enableAttributes(J,o);for(const Y of g)Y.enableAttributes(J,o);E&&E.enableAttributes(J,o),z&&z.enableAttributes(J,o),B&&B.enableAttributes(J,o),m.bind(),m.setVertexAttribPointers(J,o,P);for(const Y of g)Y.bind(),Y.setVertexAttribPointers(J,o,P);E&&(E.bind(),E.setVertexAttribPointers(J,o,P)),b&&b.bind(),z&&(z.bind(),z.setVertexAttribPointers(J,o,P)),B&&(B.bind(),B.setVertexAttribPointers(J,o,P)),G.currentNumAttributes=U}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const WP=(N,o,m,g,b)=>({u_texture:0,u_ele_delta:N,u_fog_matrix:o,u_fog_color:m?m.properties.get("fog-color"):a.bi.white,u_fog_ground_blend:m?m.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:b?0:m?m.calculateFogBlendOpacity(g):0,u_horizon_color:m?m.properties.get("horizon-color"):a.bi.white,u_horizon_fog_blend:m?m.properties.get("horizon-fog-blend"):1,u_is_globe_mode:b?1:0}),mv={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Lc(N){const o=[];for(let m=0;m<N.length;m++){if(N[m]===null)continue;const g=N[m].split(" ");o.push(g.pop())}return o}class Vm{constructor(o,m,g,b,P,E,z,B,U=[]){const G=o.gl;this.program=G.createProgram();const J=Lc(m.staticAttributes),Y=g?g.getBinderAttributes():[],ne=J.concat(Y),fe=Ur.prelude.staticUniforms?Lc(Ur.prelude.staticUniforms):[],je=z.staticUniforms?Lc(z.staticUniforms):[],we=m.staticUniforms?Lc(m.staticUniforms):[],Se=g?g.getBinderUniforms():[],Te=fe.concat(je).concat(we).concat(Se),Le=[];for(const it of Te)Le.indexOf(it)<0&&Le.push(it);const ke=g?g.defines():[];yo(G)&&ke.unshift("#version 300 es"),P&&ke.push("#define OVERDRAW_INSPECTOR;"),E&&ke.push("#define TERRAIN3D;"),B&&ke.push(B),U&&ke.push(...U);let Fe=ke.concat(Ur.prelude.fragmentSource,z.fragmentSource,m.fragmentSource).join(`
`),Be=ke.concat(Ur.prelude.vertexSource,z.vertexSource,m.vertexSource).join(`
`);yo(G)||(Fe=function(it){return it.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Fe),Be=function(it){return it.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Be));const De=G.createShader(G.FRAGMENT_SHADER);if(G.isContextLost())return void(this.failedToCreate=!0);if(G.shaderSource(De,Fe),G.compileShader(De),!G.getShaderParameter(De,G.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${G.getShaderInfoLog(De)}`);G.attachShader(this.program,De);const Ke=G.createShader(G.VERTEX_SHADER);if(G.isContextLost())return void(this.failedToCreate=!0);if(G.shaderSource(Ke,Be),G.compileShader(Ke),!G.getShaderParameter(Ke,G.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${G.getShaderInfoLog(Ke)}`);G.attachShader(this.program,Ke),this.attributes={};const ht={};this.numAttributes=ne.length;for(let it=0;it<this.numAttributes;it++)ne[it]&&(G.bindAttribLocation(this.program,it,ne[it]),this.attributes[ne[it]]=it);if(G.linkProgram(this.program),!G.getProgramParameter(this.program,G.LINK_STATUS))throw new Error(`Program failed to link: ${G.getProgramInfoLog(this.program)}`);G.deleteShader(Ke),G.deleteShader(De);for(let it=0;it<Le.length;it++){const ot=Le[it];if(ot&&!ht[ot]){const mt=G.getUniformLocation(this.program,ot);mt&&(ht[ot]=mt)}}this.fixedUniforms=b(o,ht),this.terrainUniforms=((it,ot)=>({u_depth:new a.bT(it,ot.u_depth),u_terrain:new a.bT(it,ot.u_terrain),u_terrain_dim:new a.bj(it,ot.u_terrain_dim),u_terrain_matrix:new a.bV(it,ot.u_terrain_matrix),u_terrain_unpack:new a.bW(it,ot.u_terrain_unpack),u_terrain_exaggeration:new a.bj(it,ot.u_terrain_exaggeration)}))(o,ht),this.projectionUniforms=((it,ot)=>({u_projection_matrix:new a.bV(it,ot.u_projection_matrix),u_projection_tile_mercator_coords:new a.bW(it,ot.u_projection_tile_mercator_coords),u_projection_clipping_plane:new a.bW(it,ot.u_projection_clipping_plane),u_projection_transition:new a.bj(it,ot.u_projection_transition),u_projection_fallback_matrix:new a.bV(it,ot.u_projection_fallback_matrix)}))(o,ht),this.binderUniforms=g?g.getUniforms(o,ht):[]}draw(o,m,g,b,P,E,z,B,U,G,J,Y,ne,fe,je,we,Se,Te,Le){const ke=o.gl;if(this.failedToCreate)return;if(o.program.set(this.program),o.setDepthMode(g),o.setStencilMode(b),o.setColorMode(P),o.setCullFace(E),B){o.activeTexture.set(ke.TEXTURE2),ke.bindTexture(ke.TEXTURE_2D,B.depthTexture),o.activeTexture.set(ke.TEXTURE3),ke.bindTexture(ke.TEXTURE_2D,B.texture);for(const Be in this.terrainUniforms)this.terrainUniforms[Be].set(B[Be])}if(U)for(const Be in U)this.projectionUniforms[mv[Be]].set(U[Be]);if(z)for(const Be in this.fixedUniforms)this.fixedUniforms[Be].set(z[Be]);we&&we.setUniforms(o,this.binderUniforms,fe,{zoom:je});let Fe=0;switch(m){case ke.LINES:Fe=2;break;case ke.TRIANGLES:Fe=3;break;case ke.LINE_STRIP:Fe=1}for(const Be of ne.get()){const De=Be.vaos||(Be.vaos={});(De[G]||(De[G]=new pl)).bind(o,this,J,we?we.getPaintVertexBuffers():[],Y,Be.vertexOffset,Se,Te,Le),ke.drawElements(m,Be.primitiveLength*Fe,ke.UNSIGNED_SHORT,Be.primitiveOffset*Fe*2)}}}function jj(N,o,m){const g=1/a.aG(m,1,o.transform.tileZoom),b=Math.pow(2,m.tileID.overscaledZ),P=m.tileSize*Math.pow(2,o.transform.tileZoom)/b,E=P*(m.tileID.canonical.x+m.tileID.wrap*b),z=P*m.tileID.canonical.y;return{u_image:0,u_texsize:m.imageAtlasTexture.size,u_scale:[g,N.fromScale,N.toScale],u_fade:N.t,u_pixel_coord_upper:[E>>16,z>>16],u_pixel_coord_lower:[65535&E,65535&z]}}const Um=(N,o,m,g)=>{const b=N.style.light,P=b.properties.get("position"),E=[P.x,P.y,P.z],z=a.bZ();b.properties.get("anchor")==="viewport"&&a.b_(z,N.transform.bearingInRadians),a.b$(E,E,z);const B=N.transform.transformLightDirection(E),U=b.properties.get("color");return{u_lightpos:E,u_lightpos_globe:B,u_lightintensity:b.properties.get("intensity"),u_lightcolor:[U.r,U.g,U.b],u_vertical_gradient:+o,u_opacity:m,u_fill_translate:g}},GP=(N,o,m,g,b,P,E)=>a.e(Um(N,o,m,g),jj(P,N,E),{u_height_factor:-Math.pow(2,b.overscaledZ)/E.tileSize/8}),Ad=(N,o,m,g)=>a.e(jj(o,N,m),{u_fill_translate:g}),KP=(N,o)=>({u_world:N,u_fill_translate:o}),wj=(N,o,m,g,b)=>a.e(Ad(N,o,m,b),{u_world:g}),HP=(N,o,m,g,b)=>{const P=N.transform;let E,z,B=0;if(m.paint.get("circle-pitch-alignment")==="map"){const U=a.aG(o,1,P.zoom);E=!0,z=[U,U],B=U/(a.a3*Math.pow(2,o.tileID.overscaledZ))*2*Math.PI*b}else E=!1,z=P.pixelsToGLUnits;return{u_camera_to_center_distance:P.cameraToCenterDistance,u_scale_with_map:+(m.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+E,u_device_pixel_ratio:N.pixelRatio,u_extrude_scale:z,u_globe_extrude_scale:B,u_translate:g}},Nj=N=>({u_pixel_extrude_scale:[1/N.width,1/N.height]}),fv=N=>({u_viewport_size:[N.width,N.height]}),pv=(N,o=1)=>({u_color:N,u_overlay:0,u_overlay_scale:o}),xv=(N,o,m,g)=>{const b=a.aG(N,1,o)/(a.a3*Math.pow(2,N.tileID.overscaledZ))*2*Math.PI*g;return{u_extrude_scale:a.aG(N,1,o),u_intensity:m,u_globe_extrude_scale:b}},gv=(N,o,m,g)=>{const b=a.M();a.c0(b,0,N.width,N.height,0,0,1);const P=N.context.gl;return{u_matrix:b,u_world:[P.drawingBufferWidth,P.drawingBufferHeight],u_image:m,u_color_ramp:g,u_opacity:o.paint.get("heatmap-opacity")}},Sj=(N,o,m)=>{const g=m.paint.get("hillshade-accent-color");let b;switch(m.paint.get("hillshade-method")){case"basic":b=4;break;case"combined":b=1;break;case"igor":b=2;break;case"multidirectional":b=3;break;default:b=0}const P=m.getIlluminationProperties();for(let E=0;E<P.directionRadians.length;E++)m.paint.get("hillshade-illumination-anchor")==="viewport"&&(P.directionRadians[E]+=N.transform.bearingInRadians);return{u_image:0,u_latrange:Pj(0,o.tileID),u_exaggeration:m.paint.get("hillshade-exaggeration"),u_altitudes:P.altitudeRadians,u_azimuths:P.directionRadians,u_accent:g,u_method:b,u_highlights:P.highlightColor,u_shadows:P.shadowColor}},kd=(N,o)=>{const m=o.stride,g=a.M();return a.c0(g,0,a.a3,-a.a3,0,0,1),a.N(g,g,[0,-a.a3,0]),{u_matrix:g,u_image:1,u_dimension:[m,m],u_zoom:N.overscaledZ,u_unpack:o.getUnpackVector()}};function Pj(N,o){const m=Math.pow(2,o.canonical.z),g=o.canonical.y;return[new a.a5(0,g/m).toLngLat().lat,new a.a5(0,(g+1)/m).toLngLat().lat]}const Cj=(N,o,m=0)=>({u_image:0,u_unpack:o.getUnpackVector(),u_dimension:[o.stride,o.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:m,u_opacity:N.paint.get("color-relief-opacity")}),Fc=(N,o,m,g)=>{const b=N.transform;return{u_translation:yv(N,o,m),u_ratio:g/a.aG(o,1,b.zoom),u_device_pixel_ratio:N.pixelRatio,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},ZP=(N,o,m,g,b)=>a.e(Fc(N,o,m,g),{u_image:0,u_image_height:b}),Ip=(N,o,m,g,b)=>{const P=N.transform,E=Dp(o,P);return{u_translation:yv(N,o,m),u_texsize:o.imageAtlasTexture.size,u_ratio:g/a.aG(o,1,P.zoom),u_device_pixel_ratio:N.pixelRatio,u_image:0,u_scale:[E,b.fromScale,b.toScale],u_fade:b.t,u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]]}},YP=(N,o,m,g,b)=>{const P=Dp(o,N.transform);return a.e(Fc(N,o,m,g),{u_tileratio:P,u_crossfade_from:b.fromScale,u_crossfade_to:b.toScale,u_image:0,u_mix:b.t,u_lineatlas_width:N.lineAtlas.width,u_lineatlas_height:N.lineAtlas.height})},XP=(N,o,m,g,b,P)=>{const E=Dp(o,N.transform);return a.e(Fc(N,o,m,g),{u_image:0,u_image_height:P,u_tileratio:E,u_crossfade_from:b.fromScale,u_crossfade_to:b.toScale,u_image_dash:1,u_mix:b.t,u_lineatlas_width:N.lineAtlas.width,u_lineatlas_height:N.lineAtlas.height})};function Dp(N,o){return 1/a.aG(N,1,o.tileZoom)}function yv(N,o,m){return a.aH(N.transform,o,m.paint.get("line-translate"),m.paint.get("line-translate-anchor"))}const Aj=(N,o,m,g,b)=>{return{u_tl_parent:N,u_scale_parent:o,u_buffer_scale:1,u_fade_t:m.mix,u_opacity:m.opacity*g.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:g.paint.get("raster-brightness-min"),u_brightness_high:g.paint.get("raster-brightness-max"),u_saturation_factor:(E=g.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(P=g.paint.get("raster-contrast"),P>0?1/(1-P):1+P),u_spin_weights:vv(g.paint.get("raster-hue-rotate")),u_coords_top:[b[0].x,b[0].y,b[1].x,b[1].y],u_coords_bottom:[b[3].x,b[3].y,b[2].x,b[2].y]};var P,E};function vv(N){N*=Math.PI/180;const o=Math.sin(N),m=Math.cos(N);return[(2*m+1)/3,(-Math.sqrt(3)*o-m+1)/3,(Math.sqrt(3)*o-m+1)/3]}const _v=(N,o,m,g,b,P,E,z,B,U,G,J,Y)=>{const ne=E.transform;return{u_is_size_zoom_constant:+(N==="constant"||N==="source"),u_is_size_feature_constant:+(N==="constant"||N==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:ne.cameraToCenterDistance,u_pitch:ne.pitch/360*2*Math.PI,u_rotate_symbol:+m,u_aspect_ratio:ne.width/ne.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_label_plane_matrix:z,u_coord_matrix:B,u_is_text:+G,u_pitch_with_map:+g,u_is_along_line:b,u_is_variable_anchor:P,u_texsize:J,u_texture:0,u_translation:U,u_pitched_scale:Y}},Wm=(N,o,m,g,b,P,E,z,B,U,G,J,Y,ne)=>{const fe=E.transform;return a.e(_v(N,o,m,g,b,P,E,z,B,U,G,J,ne),{u_gamma_scale:g?Math.cos(fe.pitch*Math.PI/180)*fe.cameraToCenterDistance:1,u_device_pixel_ratio:E.pixelRatio,u_is_halo:1})},Kl=(N,o,m,g,b,P,E,z,B,U,G,J,Y)=>a.e(Wm(N,o,m,g,b,P,E,z,B,U,!0,G,0,Y),{u_texsize_icon:J,u_texture_icon:1}),bv=(N,o)=>({u_opacity:N,u_color:o}),jv=(N,o,m,g,b)=>a.e(function(P,E,z,B){const U=z.imageManager.getPattern(P.from.toString()),G=z.imageManager.getPattern(P.to.toString()),{width:J,height:Y}=z.imageManager.getPixelSize(),ne=Math.pow(2,B.tileID.overscaledZ),fe=B.tileSize*Math.pow(2,z.transform.tileZoom)/ne,je=fe*(B.tileID.canonical.x+B.tileID.wrap*ne),we=fe*B.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:U.tl,u_pattern_br_a:U.br,u_pattern_tl_b:G.tl,u_pattern_br_b:G.br,u_texsize:[J,Y],u_mix:E.t,u_pattern_size_a:U.displaySize,u_pattern_size_b:G.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/a.aG(B,1,z.transform.tileZoom),u_pixel_coord_upper:[je>>16,we>>16],u_pixel_coord_lower:[65535&je,65535&we]}}(m,b,o,g),{u_opacity:N}),Rp=(N,o)=>{},kj={fillExtrusion:(N,o)=>({u_lightpos:new a.bX(N,o.u_lightpos),u_lightpos_globe:new a.bX(N,o.u_lightpos_globe),u_lightintensity:new a.bj(N,o.u_lightintensity),u_lightcolor:new a.bX(N,o.u_lightcolor),u_vertical_gradient:new a.bj(N,o.u_vertical_gradient),u_opacity:new a.bj(N,o.u_opacity),u_fill_translate:new a.bY(N,o.u_fill_translate)}),fillExtrusionPattern:(N,o)=>({u_lightpos:new a.bX(N,o.u_lightpos),u_lightpos_globe:new a.bX(N,o.u_lightpos_globe),u_lightintensity:new a.bj(N,o.u_lightintensity),u_lightcolor:new a.bX(N,o.u_lightcolor),u_vertical_gradient:new a.bj(N,o.u_vertical_gradient),u_height_factor:new a.bj(N,o.u_height_factor),u_opacity:new a.bj(N,o.u_opacity),u_fill_translate:new a.bY(N,o.u_fill_translate),u_image:new a.bT(N,o.u_image),u_texsize:new a.bY(N,o.u_texsize),u_pixel_coord_upper:new a.bY(N,o.u_pixel_coord_upper),u_pixel_coord_lower:new a.bY(N,o.u_pixel_coord_lower),u_scale:new a.bX(N,o.u_scale),u_fade:new a.bj(N,o.u_fade)}),fill:(N,o)=>({u_fill_translate:new a.bY(N,o.u_fill_translate)}),fillPattern:(N,o)=>({u_image:new a.bT(N,o.u_image),u_texsize:new a.bY(N,o.u_texsize),u_pixel_coord_upper:new a.bY(N,o.u_pixel_coord_upper),u_pixel_coord_lower:new a.bY(N,o.u_pixel_coord_lower),u_scale:new a.bX(N,o.u_scale),u_fade:new a.bj(N,o.u_fade),u_fill_translate:new a.bY(N,o.u_fill_translate)}),fillOutline:(N,o)=>({u_world:new a.bY(N,o.u_world),u_fill_translate:new a.bY(N,o.u_fill_translate)}),fillOutlinePattern:(N,o)=>({u_world:new a.bY(N,o.u_world),u_image:new a.bT(N,o.u_image),u_texsize:new a.bY(N,o.u_texsize),u_pixel_coord_upper:new a.bY(N,o.u_pixel_coord_upper),u_pixel_coord_lower:new a.bY(N,o.u_pixel_coord_lower),u_scale:new a.bX(N,o.u_scale),u_fade:new a.bj(N,o.u_fade),u_fill_translate:new a.bY(N,o.u_fill_translate)}),circle:(N,o)=>({u_camera_to_center_distance:new a.bj(N,o.u_camera_to_center_distance),u_scale_with_map:new a.bT(N,o.u_scale_with_map),u_pitch_with_map:new a.bT(N,o.u_pitch_with_map),u_extrude_scale:new a.bY(N,o.u_extrude_scale),u_device_pixel_ratio:new a.bj(N,o.u_device_pixel_ratio),u_globe_extrude_scale:new a.bj(N,o.u_globe_extrude_scale),u_translate:new a.bY(N,o.u_translate)}),collisionBox:(N,o)=>({u_pixel_extrude_scale:new a.bY(N,o.u_pixel_extrude_scale)}),collisionCircle:(N,o)=>({u_viewport_size:new a.bY(N,o.u_viewport_size)}),debug:(N,o)=>({u_color:new a.bU(N,o.u_color),u_overlay:new a.bT(N,o.u_overlay),u_overlay_scale:new a.bj(N,o.u_overlay_scale)}),depth:Rp,clippingMask:Rp,heatmap:(N,o)=>({u_extrude_scale:new a.bj(N,o.u_extrude_scale),u_intensity:new a.bj(N,o.u_intensity),u_globe_extrude_scale:new a.bj(N,o.u_globe_extrude_scale)}),heatmapTexture:(N,o)=>({u_matrix:new a.bV(N,o.u_matrix),u_world:new a.bY(N,o.u_world),u_image:new a.bT(N,o.u_image),u_color_ramp:new a.bT(N,o.u_color_ramp),u_opacity:new a.bj(N,o.u_opacity)}),hillshade:(N,o)=>({u_image:new a.bT(N,o.u_image),u_latrange:new a.bY(N,o.u_latrange),u_exaggeration:new a.bj(N,o.u_exaggeration),u_altitudes:new a.c2(N,o.u_altitudes),u_azimuths:new a.c2(N,o.u_azimuths),u_accent:new a.bU(N,o.u_accent),u_method:new a.bT(N,o.u_method),u_shadows:new a.c1(N,o.u_shadows),u_highlights:new a.c1(N,o.u_highlights)}),hillshadePrepare:(N,o)=>({u_matrix:new a.bV(N,o.u_matrix),u_image:new a.bT(N,o.u_image),u_dimension:new a.bY(N,o.u_dimension),u_zoom:new a.bj(N,o.u_zoom),u_unpack:new a.bW(N,o.u_unpack)}),colorRelief:(N,o)=>({u_image:new a.bT(N,o.u_image),u_unpack:new a.bW(N,o.u_unpack),u_dimension:new a.bY(N,o.u_dimension),u_elevation_stops:new a.bT(N,o.u_elevation_stops),u_color_stops:new a.bT(N,o.u_color_stops),u_color_ramp_size:new a.bT(N,o.u_color_ramp_size),u_opacity:new a.bj(N,o.u_opacity)}),line:(N,o)=>({u_translation:new a.bY(N,o.u_translation),u_ratio:new a.bj(N,o.u_ratio),u_device_pixel_ratio:new a.bj(N,o.u_device_pixel_ratio),u_units_to_pixels:new a.bY(N,o.u_units_to_pixels)}),lineGradient:(N,o)=>({u_translation:new a.bY(N,o.u_translation),u_ratio:new a.bj(N,o.u_ratio),u_device_pixel_ratio:new a.bj(N,o.u_device_pixel_ratio),u_units_to_pixels:new a.bY(N,o.u_units_to_pixels),u_image:new a.bT(N,o.u_image),u_image_height:new a.bj(N,o.u_image_height)}),linePattern:(N,o)=>({u_translation:new a.bY(N,o.u_translation),u_texsize:new a.bY(N,o.u_texsize),u_ratio:new a.bj(N,o.u_ratio),u_device_pixel_ratio:new a.bj(N,o.u_device_pixel_ratio),u_image:new a.bT(N,o.u_image),u_units_to_pixels:new a.bY(N,o.u_units_to_pixels),u_scale:new a.bX(N,o.u_scale),u_fade:new a.bj(N,o.u_fade)}),lineSDF:(N,o)=>({u_translation:new a.bY(N,o.u_translation),u_ratio:new a.bj(N,o.u_ratio),u_device_pixel_ratio:new a.bj(N,o.u_device_pixel_ratio),u_units_to_pixels:new a.bY(N,o.u_units_to_pixels),u_image:new a.bT(N,o.u_image),u_mix:new a.bj(N,o.u_mix),u_tileratio:new a.bj(N,o.u_tileratio),u_crossfade_from:new a.bj(N,o.u_crossfade_from),u_crossfade_to:new a.bj(N,o.u_crossfade_to),u_lineatlas_width:new a.bj(N,o.u_lineatlas_width),u_lineatlas_height:new a.bj(N,o.u_lineatlas_height)}),lineGradientSDF:(N,o)=>({u_translation:new a.bY(N,o.u_translation),u_ratio:new a.bj(N,o.u_ratio),u_device_pixel_ratio:new a.bj(N,o.u_device_pixel_ratio),u_units_to_pixels:new a.bY(N,o.u_units_to_pixels),u_image:new a.bT(N,o.u_image),u_image_height:new a.bj(N,o.u_image_height),u_tileratio:new a.bj(N,o.u_tileratio),u_crossfade_from:new a.bj(N,o.u_crossfade_from),u_crossfade_to:new a.bj(N,o.u_crossfade_to),u_image_dash:new a.bT(N,o.u_image_dash),u_mix:new a.bj(N,o.u_mix),u_lineatlas_width:new a.bj(N,o.u_lineatlas_width),u_lineatlas_height:new a.bj(N,o.u_lineatlas_height)}),raster:(N,o)=>({u_tl_parent:new a.bY(N,o.u_tl_parent),u_scale_parent:new a.bj(N,o.u_scale_parent),u_buffer_scale:new a.bj(N,o.u_buffer_scale),u_fade_t:new a.bj(N,o.u_fade_t),u_opacity:new a.bj(N,o.u_opacity),u_image0:new a.bT(N,o.u_image0),u_image1:new a.bT(N,o.u_image1),u_brightness_low:new a.bj(N,o.u_brightness_low),u_brightness_high:new a.bj(N,o.u_brightness_high),u_saturation_factor:new a.bj(N,o.u_saturation_factor),u_contrast_factor:new a.bj(N,o.u_contrast_factor),u_spin_weights:new a.bX(N,o.u_spin_weights),u_coords_top:new a.bW(N,o.u_coords_top),u_coords_bottom:new a.bW(N,o.u_coords_bottom)}),symbolIcon:(N,o)=>({u_is_size_zoom_constant:new a.bT(N,o.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bT(N,o.u_is_size_feature_constant),u_size_t:new a.bj(N,o.u_size_t),u_size:new a.bj(N,o.u_size),u_camera_to_center_distance:new a.bj(N,o.u_camera_to_center_distance),u_pitch:new a.bj(N,o.u_pitch),u_rotate_symbol:new a.bT(N,o.u_rotate_symbol),u_aspect_ratio:new a.bj(N,o.u_aspect_ratio),u_fade_change:new a.bj(N,o.u_fade_change),u_label_plane_matrix:new a.bV(N,o.u_label_plane_matrix),u_coord_matrix:new a.bV(N,o.u_coord_matrix),u_is_text:new a.bT(N,o.u_is_text),u_pitch_with_map:new a.bT(N,o.u_pitch_with_map),u_is_along_line:new a.bT(N,o.u_is_along_line),u_is_variable_anchor:new a.bT(N,o.u_is_variable_anchor),u_texsize:new a.bY(N,o.u_texsize),u_texture:new a.bT(N,o.u_texture),u_translation:new a.bY(N,o.u_translation),u_pitched_scale:new a.bj(N,o.u_pitched_scale)}),symbolSDF:(N,o)=>({u_is_size_zoom_constant:new a.bT(N,o.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bT(N,o.u_is_size_feature_constant),u_size_t:new a.bj(N,o.u_size_t),u_size:new a.bj(N,o.u_size),u_camera_to_center_distance:new a.bj(N,o.u_camera_to_center_distance),u_pitch:new a.bj(N,o.u_pitch),u_rotate_symbol:new a.bT(N,o.u_rotate_symbol),u_aspect_ratio:new a.bj(N,o.u_aspect_ratio),u_fade_change:new a.bj(N,o.u_fade_change),u_label_plane_matrix:new a.bV(N,o.u_label_plane_matrix),u_coord_matrix:new a.bV(N,o.u_coord_matrix),u_is_text:new a.bT(N,o.u_is_text),u_pitch_with_map:new a.bT(N,o.u_pitch_with_map),u_is_along_line:new a.bT(N,o.u_is_along_line),u_is_variable_anchor:new a.bT(N,o.u_is_variable_anchor),u_texsize:new a.bY(N,o.u_texsize),u_texture:new a.bT(N,o.u_texture),u_gamma_scale:new a.bj(N,o.u_gamma_scale),u_device_pixel_ratio:new a.bj(N,o.u_device_pixel_ratio),u_is_halo:new a.bT(N,o.u_is_halo),u_translation:new a.bY(N,o.u_translation),u_pitched_scale:new a.bj(N,o.u_pitched_scale)}),symbolTextAndIcon:(N,o)=>({u_is_size_zoom_constant:new a.bT(N,o.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bT(N,o.u_is_size_feature_constant),u_size_t:new a.bj(N,o.u_size_t),u_size:new a.bj(N,o.u_size),u_camera_to_center_distance:new a.bj(N,o.u_camera_to_center_distance),u_pitch:new a.bj(N,o.u_pitch),u_rotate_symbol:new a.bT(N,o.u_rotate_symbol),u_aspect_ratio:new a.bj(N,o.u_aspect_ratio),u_fade_change:new a.bj(N,o.u_fade_change),u_label_plane_matrix:new a.bV(N,o.u_label_plane_matrix),u_coord_matrix:new a.bV(N,o.u_coord_matrix),u_is_text:new a.bT(N,o.u_is_text),u_pitch_with_map:new a.bT(N,o.u_pitch_with_map),u_is_along_line:new a.bT(N,o.u_is_along_line),u_is_variable_anchor:new a.bT(N,o.u_is_variable_anchor),u_texsize:new a.bY(N,o.u_texsize),u_texsize_icon:new a.bY(N,o.u_texsize_icon),u_texture:new a.bT(N,o.u_texture),u_texture_icon:new a.bT(N,o.u_texture_icon),u_gamma_scale:new a.bj(N,o.u_gamma_scale),u_device_pixel_ratio:new a.bj(N,o.u_device_pixel_ratio),u_is_halo:new a.bT(N,o.u_is_halo),u_translation:new a.bY(N,o.u_translation),u_pitched_scale:new a.bj(N,o.u_pitched_scale)}),background:(N,o)=>({u_opacity:new a.bj(N,o.u_opacity),u_color:new a.bU(N,o.u_color)}),backgroundPattern:(N,o)=>({u_opacity:new a.bj(N,o.u_opacity),u_image:new a.bT(N,o.u_image),u_pattern_tl_a:new a.bY(N,o.u_pattern_tl_a),u_pattern_br_a:new a.bY(N,o.u_pattern_br_a),u_pattern_tl_b:new a.bY(N,o.u_pattern_tl_b),u_pattern_br_b:new a.bY(N,o.u_pattern_br_b),u_texsize:new a.bY(N,o.u_texsize),u_mix:new a.bj(N,o.u_mix),u_pattern_size_a:new a.bY(N,o.u_pattern_size_a),u_pattern_size_b:new a.bY(N,o.u_pattern_size_b),u_scale_a:new a.bj(N,o.u_scale_a),u_scale_b:new a.bj(N,o.u_scale_b),u_pixel_coord_upper:new a.bY(N,o.u_pixel_coord_upper),u_pixel_coord_lower:new a.bY(N,o.u_pixel_coord_lower),u_tile_units_to_pixels:new a.bj(N,o.u_tile_units_to_pixels)}),terrain:(N,o)=>({u_texture:new a.bT(N,o.u_texture),u_ele_delta:new a.bj(N,o.u_ele_delta),u_fog_matrix:new a.bV(N,o.u_fog_matrix),u_fog_color:new a.bU(N,o.u_fog_color),u_fog_ground_blend:new a.bj(N,o.u_fog_ground_blend),u_fog_ground_blend_opacity:new a.bj(N,o.u_fog_ground_blend_opacity),u_horizon_color:new a.bU(N,o.u_horizon_color),u_horizon_fog_blend:new a.bj(N,o.u_horizon_fog_blend),u_is_globe_mode:new a.bj(N,o.u_is_globe_mode)}),terrainDepth:(N,o)=>({u_ele_delta:new a.bj(N,o.u_ele_delta)}),terrainCoords:(N,o)=>({u_texture:new a.bT(N,o.u_texture),u_terrain_coords_id:new a.bj(N,o.u_terrain_coords_id),u_ele_delta:new a.bj(N,o.u_ele_delta)}),projectionErrorMeasurement:(N,o)=>({u_input:new a.bj(N,o.u_input),u_output_expected:new a.bj(N,o.u_output_expected)}),atmosphere:(N,o)=>({u_sun_pos:new a.bX(N,o.u_sun_pos),u_atmosphere_blend:new a.bj(N,o.u_atmosphere_blend),u_globe_position:new a.bX(N,o.u_globe_position),u_globe_radius:new a.bj(N,o.u_globe_radius),u_inv_proj_matrix:new a.bV(N,o.u_inv_proj_matrix)}),sky:(N,o)=>({u_sky_color:new a.bU(N,o.u_sky_color),u_horizon_color:new a.bU(N,o.u_horizon_color),u_horizon:new a.bY(N,o.u_horizon),u_horizon_normal:new a.bY(N,o.u_horizon_normal),u_sky_horizon_blend:new a.bj(N,o.u_sky_horizon_blend),u_sky_blend:new a.bj(N,o.u_sky_blend)})};class wv{constructor(o,m,g){this.context=o;const b=o.gl;this.buffer=b.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete m.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const m=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Td={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Nv{constructor(o,m,g,b){this.length=m.length,this.attributes=g,this.itemSize=m.bytesPerElement,this.dynamicDraw=b,this.context=o;const P=o.gl;this.buffer=P.createBuffer(),o.bindVertexBuffer.set(this.buffer),P.bufferData(P.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||delete m.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){if(o.length!==this.length)throw new Error(`Length of new data is ${o.length}, which doesn't match current length of ${this.length}`);const m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,m){for(let g=0;g<this.attributes.length;g++){const b=m.attributes[this.attributes[g].name];b!==void 0&&o.enableVertexAttribArray(b)}}setVertexAttribPointers(o,m,g){for(let b=0;b<this.attributes.length;b++){const P=this.attributes[b],E=m.attributes[P.name];E!==void 0&&o.vertexAttribPointer(E,P.components,o[Td[P.type]],!1,this.itemSize,P.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class In{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class QP extends In{getDefault(){return a.bi.transparent}set(o){const m=this.current;(o.r!==m.r||o.g!==m.g||o.b!==m.b||o.a!==m.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class JP extends In{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class eC extends In{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class Tj extends In{getDefault(){return[!0,!0,!0,!0]}set(o){const m=this.current;(o[0]!==m[0]||o[1]!==m[1]||o[2]!==m[2]||o[3]!==m[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class tC extends In{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Ej extends In{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Lp extends In{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const m=this.current;(o.func!==m.func||o.ref!==m.ref||o.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Fp extends In{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const m=this.current;(o[0]!==m[0]||o[1]!==m[1]||o[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class zp extends In{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const m=this.gl;o?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=o,this.dirty=!1}}class Sv extends In{getDefault(){return[0,1]}set(o){const m=this.current;(o[0]!==m[0]||o[1]!==m[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class Ed extends In{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const m=this.gl;o?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=o,this.dirty=!1}}class Gm extends In{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Xu extends In{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const m=this.gl;o?m.enable(m.BLEND):m.disable(m.BLEND),this.current=o,this.dirty=!1}}class _o extends In{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const m=this.current;(o[0]!==m[0]||o[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class Mj extends In{getDefault(){return a.bi.transparent}set(o){const m=this.current;(o.r!==m.r||o.g!==m.g||o.b!==m.b||o.a!==m.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Oj extends In{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class Pv extends In{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const m=this.gl;o?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=o,this.dirty=!1}}class Md extends In{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class $p extends In{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class Bp extends In{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class Km extends In{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class qp extends In{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const m=this.current;(o[0]!==m[0]||o[1]!==m[1]||o[2]!==m[2]||o[3]!==m[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Ij extends In{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Qu extends In{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Ju extends In{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const m=this.gl;m.bindTexture(m.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Dj extends In{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Cv extends In{getDefault(){return null}set(o){const m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class dn extends In{getDefault(){return null}set(o){var m;if(o===this.current&&!this.dirty)return;const g=this.gl;yo(g)?g.bindVertexArray(o):(m=g.getExtension("OES_vertex_array_object"))===null||m===void 0||m.bindVertexArrayOES(o),this.current=o,this.dirty=!1}}class Vp extends In{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class rC extends In{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Rj extends In{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Od extends In{constructor(o,m){super(o),this.context=o,this.parent=m}getDefault(){return null}}class nC extends Od{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class sC extends Od{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Lj extends Od{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_STENCIL_ATTACHMENT,m.RENDERBUFFER,o),this.current=o,this.dirty=!1}}const Fj="Framebuffer is not complete";class Av{constructor(o,m,g,b,P){this.context=o,this.width=m,this.height=g;const E=o.gl,z=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new nC(o,z),b)this.depthAttachment=P?new Lj(o,z):new sC(o,z);else if(P)throw new Error("Stencil cannot be set without depth");if(E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error(Fj)}destroy(){const o=this.context.gl,m=this.colorAttachment.get();if(m&&o.deleteTexture(m),this.depthAttachment){const g=this.depthAttachment.get();g&&o.deleteRenderbuffer(g)}o.deleteFramebuffer(this.framebuffer)}}class Up{constructor(o){var m,g;if(this.gl=o,this.clearColor=new QP(this),this.clearDepth=new JP(this),this.clearStencil=new eC(this),this.colorMask=new Tj(this),this.depthMask=new tC(this),this.stencilMask=new Ej(this),this.stencilFunc=new Lp(this),this.stencilOp=new Fp(this),this.stencilTest=new zp(this),this.depthRange=new Sv(this),this.depthTest=new Ed(this),this.depthFunc=new Gm(this),this.blend=new Xu(this),this.blendFunc=new _o(this),this.blendColor=new Mj(this),this.blendEquation=new Oj(this),this.cullFace=new Pv(this),this.cullFaceSide=new Md(this),this.frontFace=new $p(this),this.program=new Bp(this),this.activeTexture=new Km(this),this.viewport=new qp(this),this.bindFramebuffer=new Ij(this),this.bindRenderbuffer=new Qu(this),this.bindTexture=new Ju(this),this.bindVertexBuffer=new Dj(this),this.bindElementBuffer=new Cv(this),this.bindVertexArray=new dn(this),this.pixelStoreUnpack=new Vp(this),this.pixelStoreUnpackPremultiplyAlpha=new rC(this),this.pixelStoreUnpackFlipY=new Rj(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),yo(o)){this.HALF_FLOAT=o.HALF_FLOAT;const b=o.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(m=o.RGBA16F)!==null&&m!==void 0?m:b==null?void 0:b.RGBA16F_EXT,this.RGB16F=(g=o.RGB16F)!==null&&g!==void 0?g:b==null?void 0:b.RGB16F_EXT,o.getExtension("EXT_color_buffer_float")}else{o.getExtension("EXT_color_buffer_half_float"),o.getExtension("OES_texture_half_float_linear");const b=o.getExtension("OES_texture_half_float");this.HALF_FLOAT=b==null?void 0:b.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,m){return new wv(this,o,m)}createVertexBuffer(o,m,g){return new Nv(this,o,m,g)}createRenderbuffer(o,m,g){const b=this.gl,P=b.createRenderbuffer();return this.bindRenderbuffer.set(P),b.renderbufferStorage(b.RENDERBUFFER,o,m,g),this.bindRenderbuffer.set(null),P}createFramebuffer(o,m,g,b){return new Av(this,o,m,g,b)}clear({color:o,depth:m,stencil:g}){const b=this.gl;let P=0;o&&(P|=b.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),m!==void 0&&(P|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(m),this.depthMask.set(!0)),g!==void 0&&(P|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),b.clear(P)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){a.bK(o.blendFunction,jn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}createVertexArray(){var o;return yo(this.gl)?this.gl.createVertexArray():(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.createVertexArrayOES()}deleteVertexArray(o){var m;return yo(this.gl)?this.gl.deleteVertexArray(o):(m=this.gl.getExtension("OES_vertex_array_object"))===null||m===void 0?void 0:m.deleteVertexArrayOES(o)}unbindVAO(){this.bindVertexArray.set(null)}}let Id;function Hm(N,o,m,g,b){const P=N.context,E=N.transform,z=P.gl,B=N.useProgram("collisionBox"),U=[];let G=0,J=0;for(let Se=0;Se<g.length;Se++){const Te=g[Se],Le=o.getTile(Te).getBucket(m);if(!Le)continue;const ke=b?Le.textCollisionBox:Le.iconCollisionBox,Fe=Le.collisionCircleArray;Fe.length>0&&(U.push({circleArray:Fe,circleOffset:J,coord:Te}),G+=Fe.length/4,J=G),ke&&B.draw(P,z.LINES,Jr.disabled,vn.disabled,N.colorModeForRenderPass(),nn.disabled,Nj(N.transform),N.style.map.terrain&&N.style.map.terrain.getTerrainData(Te),E.getProjectionData({overscaledTileID:Te,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),m.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,null,N.transform.zoom,null,null,ke.collisionVertexBuffer)}if(!b||!U.length)return;const Y=N.useProgram("collisionCircle"),ne=new a.c3;ne.resize(4*G),ne._trim();let fe=0;for(const Se of U)for(let Te=0;Te<Se.circleArray.length/4;Te++){const Le=4*Te,ke=Se.circleArray[Le+0],Fe=Se.circleArray[Le+1],Be=Se.circleArray[Le+2],De=Se.circleArray[Le+3];ne.emplace(fe++,ke,Fe,Be,De,0),ne.emplace(fe++,ke,Fe,Be,De,1),ne.emplace(fe++,ke,Fe,Be,De,2),ne.emplace(fe++,ke,Fe,Be,De,3)}(!Id||Id.length<2*G)&&(Id=function(Se){const Te=2*Se,Le=new a.c5;Le.resize(Te),Le._trim();for(let ke=0;ke<Te;ke++){const Fe=6*ke;Le.uint16[Fe+0]=4*ke+0,Le.uint16[Fe+1]=4*ke+1,Le.uint16[Fe+2]=4*ke+2,Le.uint16[Fe+3]=4*ke+2,Le.uint16[Fe+4]=4*ke+3,Le.uint16[Fe+5]=4*ke+0}return Le}(G));const je=P.createIndexBuffer(Id,!0),we=P.createVertexBuffer(ne,a.c4.members,!0);for(const Se of U){const Te=fv(N.transform);Y.draw(P,z.TRIANGLES,Jr.disabled,vn.disabled,N.colorModeForRenderPass(),nn.disabled,Te,N.style.map.terrain&&N.style.map.terrain.getTerrainData(Se.coord),null,m.id,we,je,a.aQ.simpleSegment(0,2*Se.circleOffset,Se.circleArray.length,Se.circleArray.length/2),null,N.transform.zoom,null,null,null)}we.destroy(),je.destroy()}const kv=a.am(new Float32Array(16));function zj(N,o,m,g,b,P){const{horizontalAlign:E,verticalAlign:z}=a.aL(N);return new a.P((-(E-.5)*o/b+g[0])*P,(-(z-.5)*m/b+g[1])*P)}function Wp(N,o,m,g,b,P){const E=o.tileAnchorPoint.add(new a.P(o.translation[0],o.translation[1]));if(o.pitchWithMap){let z=g.mult(P);m||(z=z.rotate(-b));const B=E.add(z);return qt(B.x,B.y,o.pitchedLabelPlaneMatrix,o.getElevation).point}if(m){const z=hl(o.tileAnchorPoint.x+1,o.tileAnchorPoint.y,o).point.sub(N),B=Math.atan(z.y/z.x)+(z.x<0?Math.PI:0);return N.add(g.rotate(B))}return N.add(g)}function Gp(N,o,m,g,b,P,E,z,B,U,G,J){const Y=N.text.placedSymbolArray,ne=N.text.dynamicLayoutVertexArray,fe=N.icon.dynamicLayoutVertexArray,je={};ne.clear();for(let we=0;we<Y.length;we++){const Se=Y.get(we),Te=Se.hidden||!Se.crossTileID||N.allowVerticalPlacement&&!Se.placedOrientation?null:g[Se.crossTileID];if(Te){const Le=new a.P(Se.anchorX,Se.anchorY),ke={getElevation:J,width:b.width,height:b.height,pitchedLabelPlaneMatrix:P,pitchWithMap:m,transform:b,tileAnchorPoint:Le,translation:U,unwrappedTileID:G},Fe=m?Em(Le.x,Le.y,ke):hl(Le.x,Le.y,ke),Be=Kr(b.cameraToCenterDistance,Fe.signedDistanceFromCamera);let De=a.at(N.textSizeData,z,Se)*Be/a.aF;m&&(De*=N.tilePixelRatio/E);const{width:Ke,height:ht,anchor:it,textOffset:ot,textBoxScale:mt}=Te,Tt=zj(it,Ke,ht,ot,mt,De),Mt=b.getPitchedTextCorrection(Le.x+U[0],Le.y+U[1],G),bt=Wp(Fe.point,ke,o,Tt,-b.bearingInRadians,Mt),ir=N.allowVerticalPlacement&&Se.placedOrientation===a.as.vertical?Math.PI/2:0;for(let Wr=0;Wr<Se.numGlyphs;Wr++)a.az(ne,bt,ir);B&&Se.associatedIconIndex>=0&&(je[Se.associatedIconIndex]={shiftedAnchor:bt,angle:ir})}else $u(Se.numGlyphs,ne)}if(B){fe.clear();const we=N.icon.placedSymbolArray;for(let Se=0;Se<we.length;Se++){const Te=we.get(Se);if(Te.hidden)$u(Te.numGlyphs,fe);else{const Le=je[Se];if(Le)for(let ke=0;ke<Te.numGlyphs;ke++)a.az(fe,Le.shiftedAnchor,Le.angle);else $u(Te.numGlyphs,fe)}}N.icon.dynamicLayoutVertexBuffer.updateData(fe)}N.text.dynamicLayoutVertexBuffer.updateData(ne)}function Kp(N,o,m){return m.iconsInText&&o?"symbolTextAndIcon":N?"symbolSDF":"symbolIcon"}function Dd(N,o,m,g,b,P,E,z,B,U,G,J,Y){const ne=N.context,fe=ne.gl,je=N.transform,we=z==="map",Se=B==="map",Te=z!=="viewport"&&m.layout.get("symbol-placement")!=="point",Le=we&&!Se&&!Te,ke=!m.layout.get("symbol-sort-key").isConstant();let Fe=!1;const Be=N.getDepthModeForSublayer(0,Jr.ReadOnly),De=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ke=[],ht=je.getCircleRadiusCorrection();for(const it of g){const ot=o.getTile(it),mt=ot.getBucket(m);if(!mt)continue;const Tt=b?mt.text:mt.icon;if(!Tt||!Tt.segments.get().length||!Tt.hasVisibleVertices)continue;const Mt=Tt.programConfigurations.get(m.id),bt=b||mt.sdfIcons,ir=b?mt.textSizeData:mt.iconSizeData,Wr=Se||je.pitch!==0,Rn=N.useProgram(Kp(bt,b,mt),Mt),Hr=a.ar(ir,je.zoom),Kn=N.style.map.terrain&&N.style.map.terrain.getTerrainData(it);let _s,Qn,hi,ls,Ai=[0,0],cs=null;if(b)Qn=ot.glyphAtlasTexture,hi=fe.LINEAR,_s=ot.glyphAtlasTexture.size,mt.iconsInText&&(Ai=ot.imageAtlasTexture.size,cs=ot.imageAtlasTexture,ls=Wr||N.options.rotating||N.options.zooming||ir.kind==="composite"||ir.kind==="camera"?fe.LINEAR:fe.NEAREST);else{const ei=m.layout.get("icon-size").constantOr(0)!==1||mt.iconsNeedLinear;Qn=ot.imageAtlasTexture,hi=bt||N.options.rotating||N.options.zooming||ei||Wr?fe.LINEAR:fe.NEAREST,_s=ot.imageAtlasTexture.size}const Js=a.aG(ot,1,N.transform.zoom),ja=ya(we,N.transform,Js),Bd=a.M();a.au(Bd,ja);const Jl=zu(Se,we,N.transform,Js),gl=a.aH(je,ot,P,E),qd=je.getProjectionData({overscaledTileID:it,applyGlobeMatrix:!Y,applyTerrainMatrix:!0}),oh=De&&mt.hasTextData(),Vd=m.layout.get("icon-text-fit")!=="none"&&oh&&mt.hasIconData();if(Te){const ei=N.style.map.terrain?(ki,is)=>N.style.map.terrain.getElevation(it,ki,is):null,Vs=m.layout.get("text-rotation-alignment")==="map";Lo(mt,N,b,ja,Bd,Se,U,Vs,it.toUnwrapped(),je.width,je.height,gl,ei)}const Fa=b&&De||Vd,wa=Te||Fa?kv:Se?ja:N.transform.clipSpaceToPixelsMatrix,ec=bt&&m.paint.get(b?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let $c;$c=bt?mt.iconsInText?Kl(ir.kind,Hr,Le,Se,Te,Fa,N,wa,Jl,gl,_s,Ai,ht):Wm(ir.kind,Hr,Le,Se,Te,Fa,N,wa,Jl,gl,b,_s,0,ht):_v(ir.kind,Hr,Le,Se,Te,Fa,N,wa,Jl,gl,b,_s,ht);const af={program:Rn,buffers:Tt,uniformValues:$c,projectionData:qd,atlasTexture:Qn,atlasTextureIcon:cs,atlasInterpolation:hi,atlasInterpolationIcon:ls,isSDF:bt,hasHalo:ec};if(ke&&mt.canOverlap){Fe=!0;const ei=Tt.segments.get();for(const Vs of ei)Ke.push({segments:new a.aQ([Vs]),sortKey:Vs.sortKey,state:af,terrainData:Kn})}else Ke.push({segments:Tt.segments,sortKey:0,state:af,terrainData:Kn})}Fe&&Ke.sort((it,ot)=>it.sortKey-ot.sortKey);for(const it of Ke){const ot=it.state;if(ne.activeTexture.set(fe.TEXTURE0),ot.atlasTexture.bind(ot.atlasInterpolation,fe.CLAMP_TO_EDGE),ot.atlasTextureIcon&&(ne.activeTexture.set(fe.TEXTURE1),ot.atlasTextureIcon&&ot.atlasTextureIcon.bind(ot.atlasInterpolationIcon,fe.CLAMP_TO_EDGE)),ot.isSDF){const mt=ot.uniformValues;ot.hasHalo&&(mt.u_is_halo=1,Hp(ot.buffers,it.segments,m,N,ot.program,Be,G,J,mt,ot.projectionData,it.terrainData)),mt.u_is_halo=0}Hp(ot.buffers,it.segments,m,N,ot.program,Be,G,J,ot.uniformValues,ot.projectionData,it.terrainData)}}function Hp(N,o,m,g,b,P,E,z,B,U,G){const J=g.context;b.draw(J,J.gl.TRIANGLES,P,E,z,nn.backCCW,B,G,U,m.id,N.layoutVertexBuffer,N.indexBuffer,o,m.paint,g.transform.zoom,N.programConfigurations.get(m.id),N.dynamicLayoutVertexBuffer,N.opacityVertexBuffer)}function iC(N,o,m,g,b){const P=N.context,E=P.gl,z=vn.disabled,B=new jn([E.ONE,E.ONE],a.bi.transparent,[!0,!0,!0,!0]),U=o.getBucket(m);if(!U)return;const G=g.key;let J=m.heatmapFbos.get(G);J||(J=$j(P,o.tileSize,o.tileSize),m.heatmapFbos.set(G,J)),P.bindFramebuffer.set(J.framebuffer),P.viewport.set([0,0,o.tileSize,o.tileSize]),P.clear({color:a.bi.transparent});const Y=U.programConfigurations.get(m.id),ne=N.useProgram("heatmap",Y,!b),fe=N.transform.getProjectionData({overscaledTileID:o.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),je=N.style.map.terrain.getTerrainData(g);ne.draw(P,E.TRIANGLES,Jr.disabled,z,B,nn.disabled,xv(o,N.transform.zoom,m.paint.get("heatmap-intensity"),1),je,fe,m.id,U.layoutVertexBuffer,U.indexBuffer,U.segments,m.paint,N.transform.zoom,Y)}function Zm(N,o,m,g,b){const P=N.context,E=P.gl,z=N.transform;P.setColorMode(N.colorModeForRenderPass());const B=Tv(P,o),U=m.key,G=o.heatmapFbos.get(U);if(!G)return;P.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,G.colorAttachment.get()),P.activeTexture.set(E.TEXTURE1),B.bind(E.LINEAR,E.CLAMP_TO_EDGE);const J=z.getProjectionData({overscaledTileID:m,applyTerrainMatrix:b,applyGlobeMatrix:!g});N.useProgram("heatmapTexture").draw(P,E.TRIANGLES,Jr.disabled,vn.disabled,N.colorModeForRenderPass(),nn.disabled,gv(N,o,0,1),null,J,o.id,N.rasterBoundsBuffer,N.quadTriangleIndexBuffer,N.rasterBoundsSegments,o.paint,z.zoom),G.destroy(),o.heatmapFbos.delete(U)}function $j(N,o,m){var g,b;const P=N.gl,E=P.createTexture();P.bindTexture(P.TEXTURE_2D,E),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_S,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_T,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MIN_FILTER,P.LINEAR),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MAG_FILTER,P.LINEAR);const z=(g=N.HALF_FLOAT)!==null&&g!==void 0?g:P.UNSIGNED_BYTE,B=(b=N.RGBA16F)!==null&&b!==void 0?b:P.RGBA;P.texImage2D(P.TEXTURE_2D,0,B,o,m,0,P.RGBA,z,null);const U=N.createFramebuffer(o,m,!1,!1);return U.colorAttachment.set(E),U}function Tv(N,o){return o.colorRampTexture||(o.colorRampTexture=new a.T(N,o.colorRamp,N.gl.RGBA)),o.colorRampTexture}function Ym(N,o,m,g,b,P,E,z){let B=256;if(b.stepInterpolant){const U=o.getSource().maxzoom,G=E.canonical.z===U?Math.ceil(1<<N.transform.maxZoom-E.canonical.z):1;B=a.ai(a.c7(P.maxLineLength/a.a3*1024*G),256,m.maxTextureSize)}return z.gradient=a.c8({expression:b.gradientExpression(),evaluationKey:"lineProgress",resolution:B,image:z.gradient||void 0,clips:P.lineClipsArray}),z.texture?z.texture.update(z.gradient):z.texture=new a.T(m,z.gradient,g.RGBA),z.version=b.gradientVersion,z.texture}function Ev(N,o,m,g,b){N.activeTexture.set(o.TEXTURE0),m.imageAtlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE),g.updatePaintBuffers(b)}function Bj(N,o,m,g,b,P){(b||N.lineAtlas.dirty)&&(o.activeTexture.set(m.TEXTURE0),N.lineAtlas.bind(o)),g.updatePaintBuffers(P)}function qj(N,o,m,g,b,P,E){const z=P.gradients[b.id];let B=z.texture;b.gradientVersion!==z.version&&(B=Ym(N,o,m,g,b,P,E,z)),m.activeTexture.set(g.TEXTURE0),B.bind(b.stepInterpolant?g.NEAREST:g.LINEAR,g.CLAMP_TO_EDGE)}function Zp(N,o,m,g,b,P,E,z,B){const U=P.gradients[b.id];let G=U.texture;b.gradientVersion!==U.version&&(G=Ym(N,o,m,g,b,P,E,U)),m.activeTexture.set(g.TEXTURE0),G.bind(b.stepInterpolant?g.NEAREST:g.LINEAR,g.CLAMP_TO_EDGE),m.activeTexture.set(g.TEXTURE1),N.lineAtlas.bind(m),z.updatePaintBuffers(B)}function Yp(N,o,m,g,b){if(!m||!g||!g.imageAtlas)return;const P=g.imageAtlas.patternPositions;let E=P[m.to.toString()],z=P[m.from.toString()];if(!E&&z&&(E=z),!z&&E&&(z=E),!E||!z){const B=b.getPaintProperty(o);E=P[B],z=P[B]}E&&z&&N.setConstantPatternPositions(E,z)}function Vj(N,o,m,g,b,P,E,z){const B=N.context.gl,U="fill-pattern",G=m.paint.get(U),J=G&&G.constantOr(1),Y=m.getCrossfadeParameters();let ne,fe,je,we,Se;const Te=N.transform,Le=m.paint.get("fill-translate"),ke=m.paint.get("fill-translate-anchor");E?(fe=J&&!m.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ne=B.LINES):(fe=J?"fillPattern":"fill",ne=B.TRIANGLES);const Fe=G.constantOr(null);for(const Be of g){const De=o.getTile(Be);if(J&&!De.patternsLoaded())continue;const Ke=De.getBucket(m);if(!Ke)continue;const ht=Ke.programConfigurations.get(m.id),it=N.useProgram(fe,ht),ot=N.style.map.terrain&&N.style.map.terrain.getTerrainData(Be);J&&(N.context.activeTexture.set(B.TEXTURE0),De.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),ht.updatePaintBuffers(Y)),Yp(ht,U,Fe,De,m);const mt=Te.getProjectionData({overscaledTileID:Be,applyGlobeMatrix:!z,applyTerrainMatrix:!0}),Tt=a.aH(Te,De,Le,ke);if(E){we=Ke.indexBuffer2,Se=Ke.segments2;const bt=[B.drawingBufferWidth,B.drawingBufferHeight];je=fe==="fillOutlinePattern"&&J?wj(N,Y,De,bt,Tt):KP(bt,Tt)}else we=Ke.indexBuffer,Se=Ke.segments,je=J?Ad(N,Y,De,Tt):{u_fill_translate:Tt};const Mt=N.stencilModeForClipping(Be);it.draw(N.context,ne,b,Mt,P,nn.backCCW,je,ot,mt,m.id,Ke.layoutVertexBuffer,we,Se,m.paint,N.transform.zoom,ht)}}function Xp(N,o,m,g,b,P,E,z){const B=N.context,U=B.gl,G="fill-extrusion-pattern",J=m.paint.get(G),Y=J.constantOr(1),ne=m.getCrossfadeParameters(),fe=m.paint.get("fill-extrusion-opacity"),je=J.constantOr(null),we=N.transform;for(const Se of g){const Te=o.getTile(Se),Le=Te.getBucket(m);if(!Le)continue;const ke=N.style.map.terrain&&N.style.map.terrain.getTerrainData(Se),Fe=Le.programConfigurations.get(m.id),Be=N.useProgram(Y?"fillExtrusionPattern":"fillExtrusion",Fe);Y&&(N.context.activeTexture.set(U.TEXTURE0),Te.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Fe.updatePaintBuffers(ne));const De=we.getProjectionData({overscaledTileID:Se,applyGlobeMatrix:!z,applyTerrainMatrix:!0});Yp(Fe,G,je,Te,m);const Ke=a.aH(we,Te,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),ht=m.paint.get("fill-extrusion-vertical-gradient"),it=Y?GP(N,ht,fe,Ke,Se,ne,Te):Um(N,ht,fe,Ke);Be.draw(B,B.gl.TRIANGLES,b,P,E,nn.backCCW,it,ke,De,m.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,m.paint,N.transform.zoom,Fe,N.style.map.terrain&&Le.centroidVertexBuffer)}}function ys(N,o,m,g,b,P,E,z,B){var U;const G=N.style.projection,J=N.context,Y=N.transform,ne=J.gl,fe=[`#define NUM_ILLUMINATION_SOURCES ${m.paint.get("hillshade-highlight-color").values.length}`],je=N.useProgram("hillshade",null,!1,fe),we=!N.options.moving;for(const Se of g){const Te=o.getTile(Se),Le=Te.fbo;if(!Le)continue;const ke=G.getMeshFromTileID(J,Se.canonical,z,!0,"raster"),Fe=(U=N.style.map.terrain)===null||U===void 0?void 0:U.getTerrainData(Se);J.activeTexture.set(ne.TEXTURE0),ne.bindTexture(ne.TEXTURE_2D,Le.colorAttachment.get());const Be=Y.getProjectionData({overscaledTileID:Se,aligned:we,applyGlobeMatrix:!B,applyTerrainMatrix:!0});je.draw(J,ne.TRIANGLES,P,b[Se.overscaledZ],E,nn.backCCW,Sj(N,Te,m),Fe,Be,m.id,ke.vertexBuffer,ke.indexBuffer,ke.segments)}}function Hl(N,o,m,g,b,P,E,z,B){var U;const G=N.style.projection,J=N.context,Y=N.transform,ne=J.gl,fe=N.useProgram("colorRelief"),je=!N.options.moving;let we=!0,Se=0;for(const Te of g){const Le=o.getTile(Te),ke=Le.dem;if(we){const it=ne.getParameter(ne.MAX_TEXTURE_SIZE),{elevationTexture:ot,colorTexture:mt}=m.getColorRampTextures(J,it,ke.getUnpackVector());J.activeTexture.set(ne.TEXTURE1),ot.bind(ne.NEAREST,ne.CLAMP_TO_EDGE),J.activeTexture.set(ne.TEXTURE4),mt.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),we=!1,Se=ot.size[0]}if(!ke||!ke.data)continue;const Fe=ke.stride,Be=ke.getPixels();if(J.activeTexture.set(ne.TEXTURE0),J.pixelStoreUnpackPremultiplyAlpha.set(!1),Le.demTexture=Le.demTexture||N.getTileTexture(Fe),Le.demTexture){const it=Le.demTexture;it.update(Be,{premultiply:!1}),it.bind(ne.LINEAR,ne.CLAMP_TO_EDGE)}else Le.demTexture=new a.T(J,Be,ne.RGBA,{premultiply:!1}),Le.demTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE);const De=G.getMeshFromTileID(J,Te.canonical,z,!0,"raster"),Ke=(U=N.style.map.terrain)===null||U===void 0?void 0:U.getTerrainData(Te),ht=Y.getProjectionData({overscaledTileID:Te,aligned:je,applyGlobeMatrix:!B,applyTerrainMatrix:!0});fe.draw(J,ne.TRIANGLES,P,b[Te.overscaledZ],E,nn.backCCW,Cj(m,Le.dem,Se),Ke,ht,m.id,De.vertexBuffer,De.indexBuffer,De.segments)}}const Ra=[new a.P(0,0),new a.P(a.a3,0),new a.P(a.a3,a.a3),new a.P(0,a.a3)];function eh(N,o,m,g,b,P,E,z,B=!1,U=!1){const G=g[g.length-1].overscaledZ,J=N.context,Y=J.gl,ne=N.useProgram("raster"),fe=N.transform,je=N.style.projection,we=N.colorModeForRenderPass(),Se=!N.options.moving,Te=m.paint.get("raster-opacity"),Le=m.paint.get("raster-resampling"),ke=m.paint.get("raster-fade-duration"),Fe=!!N.style.map.terrain;for(const Be of g){const De=N.getDepthModeForSublayer(Be.overscaledZ-G,Te===1?Jr.ReadWrite:Jr.ReadOnly,Y.LESS),Ke=o.getTile(Be),ht=Le==="nearest"?Y.NEAREST:Y.LINEAR;J.activeTexture.set(Y.TEXTURE0),Ke.texture.bind(ht,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST),J.activeTexture.set(Y.TEXTURE1);const{parentTile:it,parentScaleBy:ot,parentTopLeft:mt,fadeValues:Tt}=Qp(Ke,o,ke,Fe);Ke.fadeOpacity=Tt.tileOpacity,it?(it.fadeOpacity=Tt.parentTileOpacity,it.texture.bind(ht,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST)):Ke.texture.bind(ht,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST),Ke.texture.useMipmap&&J.extTextureFilterAnisotropic&&N.transform.pitch>20&&Y.texParameterf(Y.TEXTURE_2D,J.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,J.extTextureFilterAnisotropicMax);const Mt=N.style.map.terrain&&N.style.map.terrain.getTerrainData(Be),bt=fe.getProjectionData({overscaledTileID:Be,aligned:Se,applyGlobeMatrix:!U,applyTerrainMatrix:!0}),ir=Aj(mt,ot,Tt.fadeMix,m,z),Wr=je.getMeshFromTileID(J,Be.canonical,P,E,"raster");ne.draw(J,Y.TRIANGLES,De,b?b[Be.overscaledZ]:vn.disabled,we,B?nn.frontCCW:nn.backCCW,ir,Mt,bt,m.id,Wr.vertexBuffer,Wr.indexBuffer,Wr.segments)}}function Qp(N,o,m,g){const b={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(m===0||g)return b;if(N.fadingParentID){const P=o.getLoadedTile(N.fadingParentID);if(!P)return b;const E=Math.pow(2,P.tileID.overscaledZ-N.tileID.overscaledZ),z=[N.tileID.canonical.x*E%1,N.tileID.canonical.y*E%1],B=function(U,G,J){const Y=k(),ne=(Y-G.timeAdded)/J,fe=U.fadingDirection===Ae.Incoming,je=a.ai((Y-U.timeAdded)/J,0,1),we=a.ai(1-ne,0,1),Se=fe?je:we;return{tileOpacity:Se,parentTileOpacity:fe?we:je,fadeMix:{opacity:1,mix:1-Se}}}(N,P,m);return{parentTile:P,parentScaleBy:E,parentTopLeft:z,fadeValues:B}}if(N.selfFading){const P=function(E,z){const B=(k()-E.timeAdded)/z,U=a.ai(B,0,1);return{tileOpacity:U,fadeMix:{opacity:U,mix:0}}}(N,m);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:P}}return b}const Uj=new a.bi(1,0,0,1),th=new a.bi(0,1,0,1),Mv=new a.bi(0,0,1,1),Xm=new a.bi(1,0,1,1),Ov=new a.bi(0,1,1,1);function Iv(N,o,m,g){Qm(N,0,o+m/2,N.transform.width,m,g)}function Dv(N,o,m,g){Qm(N,o-m/2,0,m,N.transform.height,g)}function Qm(N,o,m,g,b,P){const E=N.context,z=E.gl;z.enable(z.SCISSOR_TEST),z.scissor(o*N.pixelRatio,m*N.pixelRatio,g*N.pixelRatio,b*N.pixelRatio),E.clear({color:P}),z.disable(z.SCISSOR_TEST)}function Wj(N,o,m){const g=N.context,b=g.gl,P=N.useProgram("debug"),E=Jr.disabled,z=vn.disabled,B=N.colorModeForRenderPass(),U="$debug",G=N.style.map.terrain&&N.style.map.terrain.getTerrainData(m);g.activeTexture.set(b.TEXTURE0);const J=o.getTileByID(m.key).latestRawTileData,Y=Math.floor((J&&J.byteLength||0)/1024),ne=o.getTile(m).tileSize,fe=512/Math.min(ne,512)*(m.overscaledZ/N.transform.zoom)*.5;let je=m.canonical.toString();m.overscaledZ!==m.canonical.z&&(je+=` => ${m.overscaledZ}`),function(Se,Te){Se.initDebugOverlayCanvas();const Le=Se.debugOverlayCanvas,ke=Se.context.gl,Fe=Se.debugOverlayCanvas.getContext("2d");Fe.clearRect(0,0,Le.width,Le.height),Fe.shadowColor="white",Fe.shadowBlur=2,Fe.lineWidth=1.5,Fe.strokeStyle="white",Fe.textBaseline="top",Fe.font="bold 36px Open Sans, sans-serif",Fe.fillText(Te,5,5),Fe.strokeText(Te,5,5),Se.debugOverlayTexture.update(Le),Se.debugOverlayTexture.bind(ke.LINEAR,ke.CLAMP_TO_EDGE)}(N,`${je} ${Y}kB`);const we=N.transform.getProjectionData({overscaledTileID:m,applyGlobeMatrix:!0,applyTerrainMatrix:!0});P.draw(g,b.TRIANGLES,E,z,jn.alphaBlended,nn.disabled,pv(a.bi.transparent,fe),null,we,U,N.debugBuffer,N.quadTriangleIndexBuffer,N.debugSegments),P.draw(g,b.LINE_STRIP,E,z,B,nn.disabled,pv(a.bi.red),G,we,U,N.debugBuffer,N.tileBorderIndexBuffer,N.debugSegments)}function Rv(N,o,m,g){const{isRenderingGlobe:b}=g,P=N.context,E=P.gl,z=N.transform,B=N.colorModeForRenderPass(),U=N.getDepthModeFor3D(),G=N.useProgram("terrain");P.bindFramebuffer.set(null),P.viewport.set([0,0,N.width,N.height]);for(const J of m){const Y=o.getTerrainMesh(J.tileID),ne=N.renderToTexture.getTexture(J),fe=o.getTerrainData(J.tileID);P.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,ne.texture);const je=o.getMeshFrameDelta(z.zoom),we=z.calculateFogMatrix(J.tileID.toUnwrapped()),Se=WP(je,we,N.style.sky,z.pitch,b),Te=z.getProjectionData({overscaledTileID:J.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});G.draw(P,E.TRIANGLES,U,vn.disabled,B,nn.backCCW,Se,fe,Te,"terrain",Y.vertexBuffer,Y.indexBuffer,Y.segments)}}function zc(N,o){if(!o.mesh){const m=new a.aP;m.emplaceBack(-1,-1),m.emplaceBack(1,-1),m.emplaceBack(1,1),m.emplaceBack(-1,1);const g=new a.aR;g.emplaceBack(0,1,2),g.emplaceBack(0,2,3),o.mesh=new Wu(N.createVertexBuffer(m,ml.members),N.createIndexBuffer(g),a.aQ.simpleSegment(0,0,m.length,g.length))}return o.mesh}class Gj{constructor(o,m){this.context=new Up(o),this.transform=m,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.am(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Mn.maxUnderzooming+Mn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Wl}resize(o,m,g){if(this.width=Math.floor(o*g),this.height=Math.floor(m*g),this.pixelRatio=g,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const b of this.style._order)this.style._layers[b].resize()}setup(){const o=this.context,m=new a.aP;m.emplaceBack(0,0),m.emplaceBack(a.a3,0),m.emplaceBack(0,a.a3),m.emplaceBack(a.a3,a.a3),this.tileExtentBuffer=o.createVertexBuffer(m,ml.members),this.tileExtentSegments=a.aQ.simpleSegment(0,0,4,2);const g=new a.aP;g.emplaceBack(0,0),g.emplaceBack(a.a3,0),g.emplaceBack(0,a.a3),g.emplaceBack(a.a3,a.a3),this.debugBuffer=o.createVertexBuffer(g,ml.members),this.debugSegments=a.aQ.simpleSegment(0,0,4,5);const b=new a.ca;b.emplaceBack(0,0,0,0),b.emplaceBack(a.a3,0,a.a3,0),b.emplaceBack(0,a.a3,0,a.a3),b.emplaceBack(a.a3,a.a3,a.a3,a.a3),this.rasterBoundsBuffer=o.createVertexBuffer(b,hv.members),this.rasterBoundsSegments=a.aQ.simpleSegment(0,0,4,2);const P=new a.aP;P.emplaceBack(0,0),P.emplaceBack(a.a3,0),P.emplaceBack(0,a.a3),P.emplaceBack(a.a3,a.a3),this.rasterBoundsBufferPosOnly=o.createVertexBuffer(P,ml.members),this.rasterBoundsSegmentsPosOnly=a.aQ.simpleSegment(0,0,4,5);const E=new a.aP;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(E,ml.members),this.viewportSegments=a.aQ.simpleSegment(0,0,4,2);const z=new a.cb;z.emplaceBack(0),z.emplaceBack(1),z.emplaceBack(3),z.emplaceBack(2),z.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(z);const B=new a.aR;B.emplaceBack(1,0,2),B.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(B);const U=this.context.gl;this.stencilClearMode=new vn({func:U.ALWAYS,mask:0},0,255,U.ZERO,U.ZERO,U.ZERO),this.tileExtentMesh=new Wu(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const o=this.context,m=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const g=a.M();a.c0(g,0,this.width,this.height,0,0,1),a.O(g,g,[m.drawingBufferWidth,m.drawingBufferHeight,0]);const b={mainMatrix:g,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:g};this.useProgram("clippingMask",null,!0).draw(o,m.TRIANGLES,Jr.disabled,this.stencilClearMode,jn.disabled,nn.disabled,null,null,b,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,m,g){if(this.currentStencilSource===o.source||!o.isTileClipped()||!m||!m.length)return;this.currentStencilSource=o.source,this.nextStencilID+m.length>256&&this.clearStencil();const b=this.context;b.setColorMode(jn.disabled),b.setDepthMode(Jr.disabled);const P={};for(const E of m)P[E.key]=this.nextStencilID++;this._renderTileMasks(P,m,g,!0),this._renderTileMasks(P,m,g,!1),this._tileClippingMaskIDs=P}_renderTileMasks(o,m,g,b){const P=this.context,E=P.gl,z=this.style.projection,B=this.transform,U=this.useProgram("clippingMask");for(const G of m){const J=o[G.key],Y=this.style.map.terrain&&this.style.map.terrain.getTerrainData(G),ne=z.getMeshFromTileID(this.context,G.canonical,b,!0,"stencil"),fe=B.getProjectionData({overscaledTileID:G,applyGlobeMatrix:!g,applyTerrainMatrix:!0});U.draw(P,E.TRIANGLES,Jr.disabled,new vn({func:E.ALWAYS,mask:0},J,255,E.KEEP,E.KEEP,E.REPLACE),jn.disabled,g?nn.disabled:nn.backCCW,null,Y,fe,"$clipping",ne.vertexBuffer,ne.indexBuffer,ne.segments)}}_renderTilesDepthBuffer(){const o=this.context,m=o.gl,g=this.style.projection,b=this.transform,P=this.useProgram("depth"),E=this.getDepthModeFor3D(),z=Cn(b,{tileSize:b.tileSize});for(const B of z){const U=this.style.map.terrain&&this.style.map.terrain.getTerrainData(B),G=g.getMeshFromTileID(this.context,B.canonical,!0,!0,"raster"),J=b.getProjectionData({overscaledTileID:B,applyGlobeMatrix:!0,applyTerrainMatrix:!0});P.draw(o,m.TRIANGLES,E,vn.disabled,jn.disabled,nn.backCCW,null,U,J,"$clipping",G.vertexBuffer,G.indexBuffer,G.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,m=this.context.gl;return new vn({func:m.NOTEQUAL,mask:255},o,255,m.KEEP,m.KEEP,m.REPLACE)}stencilModeForClipping(o){const m=this.context.gl;return new vn({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,m.KEEP,m.KEEP,m.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(o){const m=this.context.gl,g=o.sort((E,z)=>z.overscaledZ-E.overscaledZ),b=g[g.length-1].overscaledZ,P=g[0].overscaledZ-b+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();const E={};for(let z=0;z<P;z++)E[z+b]=new vn({func:m.GEQUAL,mask:255},z+this.nextStencilID,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID+=P,[E,g]}return[{[b]:vn.disabled},g]}stencilConfigForOverlapTwoPass(o){const m=this.context.gl,g=o.sort((E,z)=>z.overscaledZ-E.overscaledZ),b=g[g.length-1].overscaledZ,P=g[0].overscaledZ-b+1;if(this.clearStencil(),P>1){const E={},z={};for(let B=0;B<P;B++)E[B+b]=new vn({func:m.GREATER,mask:255},P+1+B,255,m.KEEP,m.KEEP,m.REPLACE),z[B+b]=new vn({func:m.GREATER,mask:255},1+B,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID=2*P+1,[E,z,g]}return this.nextStencilID=3,[{[b]:new vn({func:m.GREATER,mask:255},2,255,m.KEEP,m.KEEP,m.REPLACE)},{[b]:new vn({func:m.GREATER,mask:255},1,255,m.KEEP,m.KEEP,m.REPLACE)},g]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new jn([o.CONSTANT_COLOR,o.ONE],new a.bi(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?jn.unblended:jn.alphaBlended}getDepthModeForSublayer(o,m,g){if(!this.opaquePassEnabledForLayer())return Jr.disabled;const b=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new Jr(g||this.context.gl.LEQUAL,m,[b,b])}getDepthModeFor3D(){return new Jr(this.context.gl.LEQUAL,Jr.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,m){var g,b;this.style=o,this.options=m,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(k()),this.imageManager.beginFrame();const P=this.style._order,E=this.style.tileManagers,z={},B={},U={},G={isRenderingToTexture:!1,isRenderingGlobe:((g=o.projection)===null||g===void 0?void 0:g.transitionState)>0};for(const Y in E){const ne=E[Y];ne.used&&ne.prepare(this.context),z[Y]=ne.getVisibleCoordinates(!1),B[Y]=z[Y].slice().reverse(),U[Y]=ne.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Y=0;Y<P.length;Y++)if(this.style._layers[P[Y]].is3D()){this.opaquePassCutoff=Y;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const Y of P){const ne=this.style._layers[Y];if(!ne.hasOffscreenPass()||ne.isHidden(this.transform.zoom))continue;const fe=B[ne.source];(ne.type==="custom"||fe.length)&&this.renderLayer(this,E[ne.source],ne,fe,G)}if((b=this.style.projection)===null||b===void 0||b.updateGPUdependent({context:this.context,useProgram:Y=>this.useProgram(Y)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:m.showOverdrawInspector?a.bi.black:a.bi.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(Y,ne){const fe=Y.context,je=fe.gl,we=((Be,De,Ke)=>{const ht=Math.cos(De.rollInRadians),it=Math.sin(De.rollInRadians),ot=yt(De),mt=De.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Be.properties.get("sky-color"),u_horizon_color:Be.properties.get("horizon-color"),u_horizon:[(De.width/2-ot*it)*Ke,(De.height/2+ot*ht)*Ke],u_horizon_normal:[-it,ht],u_sky_horizon_blend:Be.properties.get("sky-horizon-blend")*De.height/2*Ke,u_sky_blend:mt}})(ne,Y.style.map.transform,Y.pixelRatio),Se=new Jr(je.LEQUAL,Jr.ReadWrite,[0,1]),Te=vn.disabled,Le=Y.colorModeForRenderPass(),ke=Y.useProgram("sky"),Fe=zc(fe,ne);ke.draw(fe,je.TRIANGLES,Se,Te,Le,nn.disabled,we,null,void 0,"sky",Fe.vertexBuffer,Fe.indexBuffer,Fe.segments)}(this,this.style.sky),this._showOverdrawInspector=m.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=P.length-1;this.currentLayer>=0;this.currentLayer--){const Y=this.style._layers[P[this.currentLayer]],ne=E[Y.source],fe=z[Y.source];this._renderTileClippingMasks(Y,fe,!1),this.renderLayer(this,ne,Y,fe,G)}this.renderPass="translucent";let J=!1;for(this.currentLayer=0;this.currentLayer<P.length;this.currentLayer++){const Y=this.style._layers[P[this.currentLayer]],ne=E[Y.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(Y,G))continue;this.opaquePassEnabledForLayer()||J||(J=!0,G.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const fe=(Y.type==="symbol"?U:B)[Y.source];this._renderTileClippingMasks(Y,z[Y.source],!!this.renderToTexture),this.renderLayer(this,ne,Y,fe,G)}if(G.isRenderingGlobe&&function(Y,ne,fe){const je=Y.context,we=je.gl,Se=Y.useProgram("atmosphere"),Te=new Jr(we.LEQUAL,Jr.ReadOnly,[0,1]),Le=Y.transform,ke=function(mt,Tt){const Mt=mt.properties.get("position"),bt=[-Mt.x,-Mt.y,-Mt.z],ir=a.am(new Float64Array(16));return mt.properties.get("anchor")==="map"&&(a.b9(ir,ir,Tt.rollInRadians),a.ba(ir,ir,-Tt.pitchInRadians),a.b9(ir,ir,Tt.bearingInRadians),a.ba(ir,ir,Tt.center.lat*Math.PI/180),a.bC(ir,ir,-Tt.center.lng*Math.PI/180)),a.c9(bt,bt,ir),bt}(fe,Y.transform),Fe=Le.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Be=ne.properties.get("atmosphere-blend")*Fe.projectionTransition;if(Be===0)return;const De=zm(Le.worldSize,Le.center.lat),Ke=Le.inverseProjectionMatrix,ht=new Float64Array(4);ht[3]=1,a.aA(ht,ht,Le.modelViewProjectionMatrix),ht[0]/=ht[3],ht[1]/=ht[3],ht[2]/=ht[3],ht[3]=1,a.aA(ht,ht,Ke),ht[0]/=ht[3],ht[1]/=ht[3],ht[2]/=ht[3],ht[3]=1;const it=((mt,Tt,Mt,bt,ir)=>({u_sun_pos:mt,u_atmosphere_blend:Tt,u_globe_position:Mt,u_globe_radius:bt,u_inv_proj_matrix:ir}))(ke,Be,[ht[0],ht[1],ht[2]],De,Ke),ot=zc(je,ne);Se.draw(je,we.TRIANGLES,Te,vn.disabled,jn.alphaBlended,nn.disabled,it,null,null,"atmosphere",ot.vertexBuffer,ot.indexBuffer,ot.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const Y=function(ne,fe){let je=null;const we=Object.values(ne._layers).flatMap(ke=>ke.source&&!ke.isHidden(fe)?[ne.tileManagers[ke.source]]:[]),Se=we.filter(ke=>ke.getSource().type==="vector"),Te=we.filter(ke=>ke.getSource().type!=="vector"),Le=ke=>{(!je||je.getSource().maxzoom<ke.getSource().maxzoom)&&(je=ke)};return Se.forEach(ke=>Le(ke)),je||Te.forEach(ke=>Le(ke)),je}(this.style,this.transform.zoom);Y&&function(ne,fe,je){for(let we=0;we<je.length;we++)Wj(ne,fe,je[we])}(this,Y,Y.getVisibleCoordinates())}this.options.showPadding&&function(Y){const ne=Y.transform.padding;Iv(Y,Y.transform.height-(ne.top||0),3,Uj),Iv(Y,ne.bottom||0,3,th),Dv(Y,ne.left||0,3,Mv),Dv(Y,Y.transform.width-(ne.right||0),3,Xm);const fe=Y.transform.centerPoint;(function(je,we,Se,Te){Qm(je,we-1,Se-10,2,20,Te),Qm(je,we-10,Se-1,20,2,Te)})(Y,fe.x,Y.transform.height-fe.y,Ov)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(o){if(!this.style||!this.style.map||!this.style.map.terrain)return;const m=this.terrainFacilitator.matrix,g=this.transform.modelViewProjectionMatrix;let b=this.terrainFacilitator.dirty;b||(b=o?!a.cc(m,g):!a.cd(m,g)),b||(b=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),b&&(a.ce(m,g),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(P,E){const z=P.context,B=z.gl,U=P.transform,G=jn.unblended,J=new Jr(B.LEQUAL,Jr.ReadWrite,[0,1]),Y=E.tileManager.getRenderableTiles(),ne=P.useProgram("terrainDepth");z.bindFramebuffer.set(E.getFramebuffer("depth").framebuffer),z.viewport.set([0,0,P.width/devicePixelRatio,P.height/devicePixelRatio]),z.clear({color:a.bi.transparent,depth:1});for(const fe of Y){const je=E.getTerrainMesh(fe.tileID),we=E.getTerrainData(fe.tileID),Se=U.getProjectionData({overscaledTileID:fe.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),Te={u_ele_delta:E.getMeshFrameDelta(U.zoom)};ne.draw(z,B.TRIANGLES,J,vn.disabled,G,nn.backCCW,Te,we,Se,"terrain",je.vertexBuffer,je.indexBuffer,je.segments)}z.bindFramebuffer.set(null),z.viewport.set([0,0,P.width,P.height])}(this,this.style.map.terrain),function(P,E){const z=P.context,B=z.gl,U=P.transform,G=jn.unblended,J=new Jr(B.LEQUAL,Jr.ReadWrite,[0,1]),Y=E.getCoordsTexture(),ne=E.tileManager.getRenderableTiles(),fe=P.useProgram("terrainCoords");z.bindFramebuffer.set(E.getFramebuffer("coords").framebuffer),z.viewport.set([0,0,P.width/devicePixelRatio,P.height/devicePixelRatio]),z.clear({color:a.bi.transparent,depth:1}),E.coordsIndex=[];for(const je of ne){const we=E.getTerrainMesh(je.tileID),Se=E.getTerrainData(je.tileID);z.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,Y.texture);const Te={u_terrain_coords_id:(255-E.coordsIndex.length)/255,u_texture:0,u_ele_delta:E.getMeshFrameDelta(U.zoom)},Le=U.getProjectionData({overscaledTileID:je.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});fe.draw(z,B.TRIANGLES,J,vn.disabled,G,nn.backCCW,Te,Se,Le,"terrain",we.vertexBuffer,we.indexBuffer,we.segments),E.coordsIndex.push(je.tileID.key)}z.bindFramebuffer.set(null),z.viewport.set([0,0,P.width,P.height])}(this,this.style.map.terrain))}renderLayer(o,m,g,b,P){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="custom"||(b||[]).length)&&(this.id=g.id,a.cf(g)?function(E,z,B,U,G,J){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:Y}=J,ne=vn.disabled,fe=E.colorModeForRenderPass();(B._unevaluatedLayout.hasValue("text-variable-anchor")||B._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(je,we,Se,Te,Le,ke,Fe,Be,De){const Ke=we.transform,ht=we.style.map.terrain,it=Le==="map",ot=ke==="map";for(const mt of je){const Tt=Te.getTile(mt),Mt=Tt.getBucket(Se);if(!Mt||!Mt.text||!Mt.text.segments.get().length)continue;const bt=a.ar(Mt.textSizeData,Ke.zoom),ir=a.aG(Tt,1,we.transform.zoom),Wr=ya(it,we.transform,ir),Rn=Se.layout.get("icon-text-fit")!=="none"&&Mt.hasIconData();if(bt){const Hr=Math.pow(2,Ke.zoom-Tt.tileID.overscaledZ),Kn=ht?(_s,Qn)=>ht.getElevation(mt,_s,Qn):null;Gp(Mt,it,ot,De,Ke,Wr,Hr,bt,Rn,a.aH(Ke,Tt,Fe,Be),mt.toUnwrapped(),Kn)}}}(U,E,B,z,B.layout.get("text-rotation-alignment"),B.layout.get("text-pitch-alignment"),B.paint.get("text-translate"),B.paint.get("text-translate-anchor"),G),B.paint.get("icon-opacity").constantOr(1)!==0&&Dd(E,z,B,U,!1,B.paint.get("icon-translate"),B.paint.get("icon-translate-anchor"),B.layout.get("icon-rotation-alignment"),B.layout.get("icon-pitch-alignment"),B.layout.get("icon-keep-upright"),ne,fe,Y),B.paint.get("text-opacity").constantOr(1)!==0&&Dd(E,z,B,U,!0,B.paint.get("text-translate"),B.paint.get("text-translate-anchor"),B.layout.get("text-rotation-alignment"),B.layout.get("text-pitch-alignment"),B.layout.get("text-keep-upright"),ne,fe,Y),z.map.showCollisionBoxes&&(Hm(E,z,B,U,!0),Hm(E,z,B,U,!1))}(o,m,g,b,this.style.placement.variableOffsets,P):a.cg(g)?function(E,z,B,U,G){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:J}=G,Y=B.paint.get("circle-opacity"),ne=B.paint.get("circle-stroke-width"),fe=B.paint.get("circle-stroke-opacity"),je=!B.layout.get("circle-sort-key").isConstant();if(Y.constantOr(1)===0&&(ne.constantOr(1)===0||fe.constantOr(1)===0))return;const we=E.context,Se=we.gl,Te=E.transform,Le=E.getDepthModeForSublayer(0,Jr.ReadOnly),ke=vn.disabled,Fe=E.colorModeForRenderPass(),Be=[],De=Te.getCircleRadiusCorrection();for(let Ke=0;Ke<U.length;Ke++){const ht=U[Ke],it=z.getTile(ht),ot=it.getBucket(B);if(!ot)continue;const mt=B.paint.get("circle-translate"),Tt=B.paint.get("circle-translate-anchor"),Mt=a.aH(Te,it,mt,Tt),bt=ot.programConfigurations.get(B.id),ir=E.useProgram("circle",bt),Wr=ot.layoutVertexBuffer,Rn=ot.indexBuffer,Hr=E.style.map.terrain&&E.style.map.terrain.getTerrainData(ht),Kn={programConfiguration:bt,program:ir,layoutVertexBuffer:Wr,indexBuffer:Rn,uniformValues:HP(E,it,B,Mt,De),terrainData:Hr,projectionData:Te.getProjectionData({overscaledTileID:ht,applyGlobeMatrix:!J,applyTerrainMatrix:!0})};if(je){const _s=ot.segments.get();for(const Qn of _s)Be.push({segments:new a.aQ([Qn]),sortKey:Qn.sortKey,state:Kn})}else Be.push({segments:ot.segments,sortKey:0,state:Kn})}je&&Be.sort((Ke,ht)=>Ke.sortKey-ht.sortKey);for(const Ke of Be){const{programConfiguration:ht,program:it,layoutVertexBuffer:ot,indexBuffer:mt,uniformValues:Tt,terrainData:Mt,projectionData:bt}=Ke.state;it.draw(we,Se.TRIANGLES,Le,ke,Fe,nn.backCCW,Tt,Mt,bt,B.id,ot,mt,Ke.segments,B.paint,E.transform.zoom,ht)}}(o,m,g,b,P):a.ch(g)?function(E,z,B,U,G){if(B.paint.get("heatmap-opacity")===0)return;const J=E.context,{isRenderingToTexture:Y,isRenderingGlobe:ne}=G;if(E.style.map.terrain){for(const fe of U){const je=z.getTile(fe);z.hasRenderableParent(fe)||(E.renderPass==="offscreen"?iC(E,je,B,fe,ne):E.renderPass==="translucent"&&Zm(E,B,fe,Y,ne))}J.viewport.set([0,0,E.width,E.height])}else E.renderPass==="offscreen"?function(fe,je,we,Se){const Te=fe.context,Le=Te.gl,ke=fe.transform,Fe=vn.disabled,Be=new jn([Le.ONE,Le.ONE],a.bi.transparent,[!0,!0,!0,!0]);(function(De,Ke,ht){const it=De.gl;De.activeTexture.set(it.TEXTURE1),De.viewport.set([0,0,Ke.width/4,Ke.height/4]);let ot=ht.heatmapFbos.get(a.c6);ot?(it.bindTexture(it.TEXTURE_2D,ot.colorAttachment.get()),De.bindFramebuffer.set(ot.framebuffer)):(ot=$j(De,Ke.width/4,Ke.height/4),ht.heatmapFbos.set(a.c6,ot))})(Te,fe,we),Te.clear({color:a.bi.transparent});for(let De=0;De<Se.length;De++){const Ke=Se[De];if(je.hasRenderableParent(Ke))continue;const ht=je.getTile(Ke),it=ht.getBucket(we);if(!it)continue;const ot=it.programConfigurations.get(we.id),mt=fe.useProgram("heatmap",ot),Tt=ke.getProjectionData({overscaledTileID:Ke,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Mt=ke.getCircleRadiusCorrection();mt.draw(Te,Le.TRIANGLES,Jr.disabled,Fe,Be,nn.backCCW,xv(ht,ke.zoom,we.paint.get("heatmap-intensity"),Mt),null,Tt,we.id,it.layoutVertexBuffer,it.indexBuffer,it.segments,we.paint,ke.zoom,ot)}Te.viewport.set([0,0,fe.width,fe.height])}(E,z,B,U):E.renderPass==="translucent"&&function(fe,je){const we=fe.context,Se=we.gl;we.setColorMode(fe.colorModeForRenderPass());const Te=je.heatmapFbos.get(a.c6);Te&&(we.activeTexture.set(Se.TEXTURE0),Se.bindTexture(Se.TEXTURE_2D,Te.colorAttachment.get()),we.activeTexture.set(Se.TEXTURE1),Tv(we,je).bind(Se.LINEAR,Se.CLAMP_TO_EDGE),fe.useProgram("heatmapTexture").draw(we,Se.TRIANGLES,Jr.disabled,vn.disabled,fe.colorModeForRenderPass(),nn.disabled,gv(fe,je,0,1),null,null,je.id,fe.viewportBuffer,fe.quadTriangleIndexBuffer,fe.viewportSegments,je.paint,fe.transform.zoom))}(E,B)}(o,m,g,b,P):a.ci(g)?function(E,z,B,U,G){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:J}=G,Y=B.paint.get("line-opacity"),ne=B.paint.get("line-width");if(Y.constantOr(1)===0||ne.constantOr(1)===0)return;const fe=E.getDepthModeForSublayer(0,Jr.ReadOnly),je=E.colorModeForRenderPass(),we=B.paint.get("line-dasharray"),Se=we.constantOr(1),Te=B.paint.get("line-pattern"),Le=Te.constantOr(1),ke=B.paint.get("line-gradient"),Fe=B.getCrossfadeParameters();let Be;Be=Le?"linePattern":Se&&ke?"lineGradientSDF":Se?"lineSDF":ke?"lineGradient":"line";const De=E.context,Ke=De.gl,ht=E.transform;let it=!0;for(const ot of U){const mt=z.getTile(ot);if(Le&&!mt.patternsLoaded())continue;const Tt=mt.getBucket(B);if(!Tt)continue;const Mt=Tt.programConfigurations.get(B.id),bt=E.context.program.get(),ir=E.useProgram(Be,Mt),Wr=it||ir.program!==bt,Rn=E.style.map.terrain&&E.style.map.terrain.getTerrainData(ot),Hr=Te.constantOr(null),Kn=we&&we.constantOr(null);if(Hr&&mt.imageAtlas){const Ai=mt.imageAtlas,cs=Ai.patternPositions[Hr.to.toString()],Js=Ai.patternPositions[Hr.from.toString()];cs&&Js&&Mt.setConstantPatternPositions(cs,Js)}else if(Kn){const Ai=B.layout.get("line-cap")==="round",cs=E.lineAtlas.getDash(Kn.to,Ai),Js=E.lineAtlas.getDash(Kn.from,Ai);Mt.setConstantDashPositions(cs,Js)}const _s=ht.getProjectionData({overscaledTileID:ot,applyGlobeMatrix:!J,applyTerrainMatrix:!0}),Qn=ht.getPixelScale();let hi;Le?(hi=Ip(E,mt,B,Qn,Fe),Ev(De,Ke,mt,Mt,Fe)):Se&&ke?(hi=XP(E,mt,B,Qn,Fe,Tt.lineClipsArray.length),Zp(E,z,De,Ke,B,Tt,ot,Mt,Fe)):Se?(hi=YP(E,mt,B,Qn,Fe),Bj(E,De,Ke,Mt,Wr,Fe)):ke?(hi=ZP(E,mt,B,Qn,Tt.lineClipsArray.length),qj(E,z,De,Ke,B,Tt,ot)):hi=Fc(E,mt,B,Qn);const ls=E.stencilModeForClipping(ot);ir.draw(De,Ke.TRIANGLES,fe,ls,je,nn.disabled,hi,Rn,_s,B.id,Tt.layoutVertexBuffer,Tt.indexBuffer,Tt.segments,B.paint,E.transform.zoom,Mt,Tt.layoutVertexBuffer2),it=!1}}(o,m,g,b,P):a.cj(g)?function(E,z,B,U,G){const J=B.paint.get("fill-color"),Y=B.paint.get("fill-opacity");if(Y.constantOr(1)===0)return;const{isRenderingToTexture:ne}=G,fe=E.colorModeForRenderPass(),je=B.paint.get("fill-pattern"),we=E.opaquePassEnabledForLayer()&&!je.constantOr(1)&&J.constantOr(a.bi.transparent).a===1&&Y.constantOr(0)===1?"opaque":"translucent";if(E.renderPass===we){const Se=E.getDepthModeForSublayer(1,E.renderPass==="opaque"?Jr.ReadWrite:Jr.ReadOnly);Vj(E,z,B,U,Se,fe,!1,ne)}if(E.renderPass==="translucent"&&B.paint.get("fill-antialias")){const Se=E.getDepthModeForSublayer(B.getPaintProperty("fill-outline-color")?2:0,Jr.ReadOnly);Vj(E,z,B,U,Se,fe,!0,ne)}}(o,m,g,b,P):a.ck(g)?function(E,z,B,U,G){const J=B.paint.get("fill-extrusion-opacity");if(J===0)return;const{isRenderingToTexture:Y}=G;if(E.renderPass==="translucent"){const ne=new Jr(E.context.gl.LEQUAL,Jr.ReadWrite,E.depthRangeFor3D);if(J!==1||B.paint.get("fill-extrusion-pattern").constantOr(1))Xp(E,z,B,U,ne,vn.disabled,jn.disabled,Y),Xp(E,z,B,U,ne,E.stencilModeFor3D(),E.colorModeForRenderPass(),Y);else{const fe=E.colorModeForRenderPass();Xp(E,z,B,U,ne,vn.disabled,fe,Y)}}}(o,m,g,b,P):a.cl(g)?function(E,z,B,U,G){if(E.renderPass!=="offscreen"&&E.renderPass!=="translucent")return;const{isRenderingToTexture:J}=G,Y=E.context,ne=E.style.projection.useSubdivision,fe=E.getDepthModeForSublayer(0,Jr.ReadOnly),je=E.colorModeForRenderPass();if(E.renderPass==="offscreen")(function(we,Se,Te,Le,ke,Fe,Be){const De=we.context,Ke=De.gl;for(const ht of Te){const it=Se.getTile(ht),ot=it.dem;if(!ot||!ot.data||!it.needsHillshadePrepare)continue;const mt=ot.dim,Tt=ot.stride,Mt=ot.getPixels();if(De.activeTexture.set(Ke.TEXTURE1),De.pixelStoreUnpackPremultiplyAlpha.set(!1),it.demTexture=it.demTexture||we.getTileTexture(Tt),it.demTexture){const ir=it.demTexture;ir.update(Mt,{premultiply:!1}),ir.bind(Ke.NEAREST,Ke.CLAMP_TO_EDGE)}else it.demTexture=new a.T(De,Mt,Ke.RGBA,{premultiply:!1}),it.demTexture.bind(Ke.NEAREST,Ke.CLAMP_TO_EDGE);De.activeTexture.set(Ke.TEXTURE0);let bt=it.fbo;if(!bt){const ir=new a.T(De,{width:mt,height:mt,data:null},Ke.RGBA);ir.bind(Ke.LINEAR,Ke.CLAMP_TO_EDGE),bt=it.fbo=De.createFramebuffer(mt,mt,!0,!1),bt.colorAttachment.set(ir.texture)}De.bindFramebuffer.set(bt.framebuffer),De.viewport.set([0,0,mt,mt]),we.useProgram("hillshadePrepare").draw(De,Ke.TRIANGLES,ke,Fe,Be,nn.disabled,kd(it.tileID,ot),null,null,Le.id,we.rasterBoundsBuffer,we.quadTriangleIndexBuffer,we.rasterBoundsSegments),it.needsHillshadePrepare=!1}})(E,z,U,B,fe,vn.disabled,je),Y.viewport.set([0,0,E.width,E.height]);else if(E.renderPass==="translucent")if(ne){const[we,Se,Te]=E.stencilConfigForOverlapTwoPass(U);ys(E,z,B,Te,we,fe,je,!1,J),ys(E,z,B,Te,Se,fe,je,!0,J)}else{const[we,Se]=E.getStencilConfigForOverlapAndUpdateStencilID(U);ys(E,z,B,Se,we,fe,je,!1,J)}}(o,m,g,b,P):a.cm(g)?function(E,z,B,U,G){if(E.renderPass!=="translucent"||!U.length)return;const{isRenderingToTexture:J}=G,Y=E.style.projection.useSubdivision,ne=E.getDepthModeForSublayer(0,Jr.ReadOnly),fe=E.colorModeForRenderPass();if(Y){const[je,we,Se]=E.stencilConfigForOverlapTwoPass(U);Hl(E,z,B,Se,je,ne,fe,!1,J),Hl(E,z,B,Se,we,ne,fe,!0,J)}else{const[je,we]=E.getStencilConfigForOverlapAndUpdateStencilID(U);Hl(E,z,B,we,je,ne,fe,!1,J)}}(o,m,g,b,P):a.bN(g)?function(E,z,B,U,G){if(E.renderPass!=="translucent"||B.paint.get("raster-opacity")===0||!U.length)return;const{isRenderingToTexture:J}=G,Y=z.getSource(),ne=E.style.projection.useSubdivision;if(Y instanceof Vt)eh(E,z,B,U,null,!1,!1,Y.tileCoords,Y.flippedWindingOrder,J);else if(ne){const[fe,je,we]=E.stencilConfigForOverlapTwoPass(U);eh(E,z,B,we,fe,!1,!0,Ra,!1,J),eh(E,z,B,we,je,!0,!0,Ra,!1,J)}else{const[fe,je]=E.getStencilConfigForOverlapAndUpdateStencilID(U);eh(E,z,B,je,fe,!1,!0,Ra,!1,J)}}(o,m,g,b,P):a.cn(g)?function(E,z,B,U,G){const J=B.paint.get("background-color"),Y=B.paint.get("background-opacity");if(Y===0)return;const{isRenderingToTexture:ne}=G,fe=E.context,je=fe.gl,we=E.style.projection,Se=E.transform,Te=Se.tileSize,Le=B.paint.get("background-pattern");if(E.isPatternMissing(Le))return;const ke=!Le&&J.a===1&&Y===1&&E.opaquePassEnabledForLayer()?"opaque":"translucent";if(E.renderPass!==ke)return;const Fe=vn.disabled,Be=E.getDepthModeForSublayer(0,ke==="opaque"?Jr.ReadWrite:Jr.ReadOnly),De=E.colorModeForRenderPass(),Ke=E.useProgram(Le?"backgroundPattern":"background"),ht=U||Cn(Se,{tileSize:Te,terrain:E.style.map.terrain});Le&&(fe.activeTexture.set(je.TEXTURE0),E.imageManager.bind(E.context));const it=B.getCrossfadeParameters();for(const ot of ht){const mt=Se.getProjectionData({overscaledTileID:ot,applyGlobeMatrix:!ne,applyTerrainMatrix:!0}),Tt=Le?jv(Y,E,Le,{tileID:ot,tileSize:Te},it):bv(Y,J),Mt=E.style.map.terrain&&E.style.map.terrain.getTerrainData(ot),bt=we.getMeshFromTileID(fe,ot.canonical,!1,!0,"raster");Ke.draw(fe,je.TRIANGLES,Be,Fe,De,nn.backCCW,Tt,Mt,mt,B.id,bt.vertexBuffer,bt.indexBuffer,bt.segments)}}(o,0,g,b,P):a.co(g)&&function(E,z,B,U){const{isRenderingGlobe:G}=U,J=E.context,Y=B.implementation,ne=E.style.projection,fe=E.transform,je=fe.getProjectionDataForCustomLayer(G),we={farZ:fe.farZ,nearZ:fe.nearZ,fov:fe.fov*Math.PI/180,modelViewProjectionMatrix:fe.modelViewProjectionMatrix,projectionMatrix:fe.projectionMatrix,shaderData:{variantName:ne.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${ne.shaderPreludeCode.vertexSource}`,define:ne.shaderDefine},defaultProjectionData:je},Se=Y.renderingMode?Y.renderingMode:"2d";if(E.renderPass==="offscreen"){const Te=Y.prerender;Te&&(E.setCustomLayerDefaults(),J.setColorMode(E.colorModeForRenderPass()),Te.call(Y,J.gl,we),J.setDirty(),E.setBaseState())}else if(E.renderPass==="translucent"){E.setCustomLayerDefaults(),J.setColorMode(E.colorModeForRenderPass()),J.setStencilMode(vn.disabled);const Te=Se==="3d"?E.getDepthModeFor3D():E.getDepthModeForSublayer(0,Jr.ReadOnly);J.setDepthMode(Te),Y.render(J.gl,we),J.setDirty(),E.setBaseState(),J.bindFramebuffer.set(null)}}(o,0,g,P))}saveTileTexture(o){const m=this._tileTextures[o.size[0]];m?m.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const m=this._tileTextures[o];return m&&m.length>0?m.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const m=this.imageManager.getPattern(o.from.toString()),g=this.imageManager.getPattern(o.to.toString());return!m||!g}useProgram(o,m,g=!1,b=[]){this.cache=this.cache||{};const P=!!this.style.map.terrain,E=this.style.projection,z=g?Ur.projectionMercator:E.shaderPreludeCode,B=g?Da:E.shaderDefine,U=o+(m?m.cacheKey:"")+`/${g?sa:E.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(P?"/terrain":"")+(b?`/${b.join("/")}`:"");return this.cache[U]||(this.cache[U]=new Vm(this.context,Ur[o],m,kj[o],this._showOverdrawInspector,P,z,B,b)),this.cache[U]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:o,drawingBufferHeight:m}=this.context.gl;return this.width!==o||this.height!==m}}function Lv(N,o){let m,g=!1,b=null,P=null;const E=()=>{b=null,g&&(N.apply(P,m),b=setTimeout(E,o),g=!1)};return(...z)=>(g=!0,P=this,m=z,b||E(),b)}class Fv{constructor(o){this._getCurrentHash=()=>{const m=window.location.hash.replace("#","");if(this._hashName){let g;return m.split("&").map(b=>b.split("=")).forEach(b=>{b[0]===this._hashName&&(g=b)}),(g&&g[1]||"").split("/")}return m.split("/")},this._onHashChange=()=>{const m=this._getCurrentHash();if(!this._isValidHash(m))return!1;const g=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(m[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+m[2],+m[1]],zoom:+m[0],bearing:g,pitch:+(m[4]||0)}),!0},this._updateHashUnthrottled=()=>{const m=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,m)},this._removeHash=()=>{const m=this._getCurrentHash();if(m.length===0)return;const g=m.join("/");let b=g;b.split("&").length>0&&(b=b.split("&")[0]),this._hashName&&(b=`${this._hashName}=${g}`);let P=window.location.hash.replace(b,"");P.startsWith("#&")?P=P.slice(0,1)+P.slice(2):P==="#"&&(P="");let E=window.location.href.replace(/(#.+)?$/,P);E=E.replace("&&","&"),window.history.replaceState(window.history.state,null,E)},this._updateHash=Lv(this._updateHashUnthrottled,300),this._hashName=o&&encodeURIComponent(o)}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(o){const m=this._map.getCenter(),g=Math.round(100*this._map.getZoom())/100,b=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),P=Math.pow(10,b),E=Math.round(m.lng*P)/P,z=Math.round(m.lat*P)/P,B=this._map.getBearing(),U=this._map.getPitch();let G="";if(G+=o?`/${E}/${z}/${g}`:`${g}/${z}/${E}`,(B||U)&&(G+="/"+Math.round(10*B)/10),U&&(G+=`/${Math.round(U)}`),this._hashName){const J=this._hashName;let Y=!1;const ne=window.location.hash.slice(1).split("&").map(fe=>{const je=fe.split("=")[0];return je===J?(Y=!0,`${je}=${G}`):fe}).filter(fe=>fe);return Y||ne.push(`${J}=${G}`),`#${ne.join("&")}`}return`#${G}`}_isValidHash(o){if(o.length<3||o.some(isNaN))return!1;try{new a.U(+o[2],+o[1])}catch{return!1}const m=+o[0],g=+(o[3]||0),b=+(o[4]||0);return m>=this._map.getMinZoom()&&m<=this._map.getMaxZoom()&&g>=-180&&g<=180&&b>=this._map.getMinPitch()&&b<=this._map.getMaxPitch()}}const rh={linearity:.3,easing:a.cp(0,0,.3,1)},Kj=a.e({deceleration:2500,maxSpeed:1400},rh),Hj=a.e({deceleration:20,maxSpeed:1400},rh),Zj=a.e({deceleration:1e3,maxSpeed:360},rh),Yj=a.e({deceleration:1e3,maxSpeed:90},rh),Jp=a.e({deceleration:1e3,maxSpeed:360},rh);class Xj{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:k(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,m=k();for(;o.length>0&&m-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const m={zoom:0,bearing:0,pitch:0,roll:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:P}of this._inertiaBuffer)m.zoom+=P.zoomDelta||0,m.bearing+=P.bearingDelta||0,m.pitch+=P.pitchDelta||0,m.roll+=P.rollDelta||0,P.panDelta&&m.pan._add(P.panDelta),P.around&&(m.around=P.around),P.pinchAround&&(m.pinchAround=P.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,b={};if(m.pan.mag()){const P=_a(m.pan.mag(),g,a.e({},Kj,o||{})),E=m.pan.mult(P.amount/m.pan.mag()),z=this._map.cameraHelper.handlePanInertia(E,this._map.transform);b.center=z.easingCenter,b.offset=z.easingOffset,aa(b,P)}if(m.zoom){const P=_a(m.zoom,g,Hj);b.zoom=this._map.transform.zoom+P.amount,aa(b,P)}if(m.bearing){const P=_a(m.bearing,g,Zj);b.bearing=this._map.transform.bearing+a.ai(P.amount,-179,179),aa(b,P)}if(m.pitch){const P=_a(m.pitch,g,Yj);b.pitch=this._map.transform.pitch+P.amount,aa(b,P)}if(m.roll){const P=_a(m.roll,g,Jp);b.roll=this._map.transform.roll+a.ai(P.amount,-179,179),aa(b,P)}if(b.zoom||b.bearing){const P=m.pinchAround===void 0?m.around:m.pinchAround;b.around=P?this._map.unproject(P):this._map.getCenter()}return this.clear(),a.e(b,{noMoveStart:!0})}}function aa(N,o){(!N.duration||N.duration<o.duration)&&(N.duration=o.duration,N.easing=o.easing)}function _a(N,o,m){const{maxSpeed:g,linearity:b,deceleration:P}=m,E=a.ai(N*b/(o/1e3),-g,g),z=Math.abs(E)/(P*b);return{easing:m.easing,duration:1e3*z,amount:E*(z/2)}}class La extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,m,g,b={}){g=g instanceof MouseEvent?g:new MouseEvent(o,g);const P=S.mousePos(m.getCanvas(),g),E=m.unproject(P);super(o,a.e({point:P,lngLat:E,originalEvent:g},b)),this._defaultPrevented=!1,this.target=m}}class ba extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,m,g){const b=o==="touchend"?g.changedTouches:g.touches,P=S.touchPos(m.getCanvasContainer(),b),E=P.map(B=>m.unproject(B)),z=P.reduce((B,U,G,J)=>B.add(U.div(J.length)),new a.P(0,0));super(o,{points:P,point:z,lngLats:E,lngLat:m.unproject(z),originalEvent:g}),this._defaultPrevented=!1}}class Qj extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,m,g){super(o,{originalEvent:g}),this._defaultPrevented=!1}}class nh{constructor(o,m){this._map=o,this._clickTolerance=m.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new Qj(o.type,this._map,o))}mousedown(o,m){return this._mousedownPos=m,this._firePreventable(new La(o.type,this._map,o))}mouseup(o){this._map.fire(new La(o.type,this._map,o))}click(o,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||this._map.fire(new La(o.type,this._map,o))}dblclick(o){return this._firePreventable(new La(o.type,this._map,o))}mouseover(o){this._map.fire(new La(o.type,this._map,o))}mouseout(o){this._map.fire(new La(o.type,this._map,o))}touchstart(o){return this._firePreventable(new ba(o.type,this._map,o))}touchmove(o){this._map.fire(new ba(o.type,this._map,o))}touchend(o){this._map.fire(new ba(o.type,this._map,o))}touchcancel(o){this._map.fire(new ba(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class aC{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(o){this._map.fire(new La(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new La("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._ignoreContextMenu||this._map.fire(new La(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Jm{constructor(o){this._map=o}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(o){return this.transform.screenPointToLocation(a.P.convert(o),this._map.terrain)}}class Jj{constructor(o,m){this._map=o,this._tr=new Jm(o),this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=m.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,m){this.isEnabled()&&o.shiftKey&&o.button===0&&(S.disableDrag(),this._startPos=this._lastPos=m,this._active=!0)}mousemoveWindow(o,m){if(!this._active)return;const g=m;if(this._lastPos.equals(g)||!this._box&&g.dist(this._startPos)<this._clickTolerance)return;const b=this._startPos;this._lastPos=g,this._box||(this._box=S.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",o));const P=Math.min(b.x,g.x),E=Math.max(b.x,g.x),z=Math.min(b.y,g.y),B=Math.max(b.y,g.y);S.setTransform(this._box,`translate(${P}px,${z}px)`),this._box.style.width=E-P+"px",this._box.style.height=B-z+"px"}mouseupWindow(o,m){if(!this._active||o.button!==0)return;const g=this._startPos,b=m;if(this.reset(),S.suppressClick(),g.x!==b.x||g.y!==b.y)return this._map.fire(new a.l("boxzoomend",{originalEvent:o})),{cameraAnimation:P=>P.fitScreenCoordinates(g,b,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(S.remove(this._box),this._box=null),S.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,m){return this._map.fire(new a.l(o,{originalEvent:m}))}}function zv(N,o){if(N.length!==o.length)throw new Error(`The number of touches and points are not equal - touches ${N.length}, points ${o.length}`);const m={};for(let g=0;g<N.length;g++)m[N[g].identifier]=o[g];return m}class ew{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,m,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=o.timeStamp),g.length===this.numTouches&&(this.centroid=function(b){const P=new a.P(0,0);for(const E of b)P._add(E);return P.div(b.length)}(m),this.touches=zv(g,m)))}touchmove(o,m,g){if(this.aborted||!this.centroid)return;const b=zv(g,m);for(const P in this.touches){const E=b[P];(!E||E.dist(this.touches[P])>30)&&(this.aborted=!0)}}touchend(o,m,g){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const b=!this.aborted&&this.centroid;if(this.reset(),b)return b}}}class Rd{constructor(o){this.singleTap=new ew(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,m,g){this.singleTap.touchstart(o,m,g)}touchmove(o,m,g){this.singleTap.touchmove(o,m,g)}touchend(o,m,g){const b=this.singleTap.touchend(o,m,g);if(b){const P=o.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(b)<30;if(P&&E||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=b,this.count===this.numTaps)return this.reset(),b}}}class Zl{constructor(o){this._tr=new Jm(o),this._zoomIn=new Rd({numTouches:1,numTaps:2}),this._zoomOut=new Rd({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,m,g){this._zoomIn.touchstart(o,m,g),this._zoomOut.touchstart(o,m,g)}touchmove(o,m,g){this._zoomIn.touchmove(o,m,g),this._zoomOut.touchmove(o,m,g)}touchend(o,m,g){const b=this._zoomIn.touchend(o,m,g),P=this._zoomOut.touchend(o,m,g),E=this._tr;return b?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:E.zoom+1,around:E.unproject(b)},{originalEvent:o})}):P?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:E.zoom-1,around:E.unproject(P)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class er{constructor(o){this._enabled=!!o.enable,this._moveStateManager=o.moveStateManager,this._clickTolerance=o.clickTolerance||1,this._moveFunction=o.move,this._activateOnStart=!!o.activateOnStart,o.assignEvents(this),this.reset()}reset(o){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(o)}_move(...o){const m=this._moveFunction(...o);if(m.bearingDelta||m.pitchDelta||m.rollDelta||m.around||m.panDelta)return this._active=!0,m}dragStart(o,m){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(o)&&(this._moveStateManager.startMove(o),this._lastPoint=Array.isArray(m)?m[0]:m,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(o,m){if(!this.isEnabled())return;const g=this._lastPoint;if(!g)return;if(o.preventDefault(),!this._moveStateManager.isValidMoveEvent(o))return void this.reset(o);const b=Array.isArray(m)?m[0]:m;return!this._moved&&b.dist(g)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=b,this._move(g,b))}dragEnd(o){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(o)&&(this._moved&&S.suppressClick(),this.reset(o))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const tw=0,$v=2,rw={[tw]:1,[$v]:2};class Yl{constructor(o){this._correctEvent=o.checkCorrectEvent}startMove(o){const m=S.mouseButton(o);this._eventButton=m}endMove(o){delete this._eventButton}isValidStartEvent(o){return this._correctEvent(o)}isValidMoveEvent(o){return!function(m,g){const b=rw[g];return m.buttons===void 0||(m.buttons&b)!==b}(o,this._eventButton)}isValidEndEvent(o){return S.mouseButton(o)===this._eventButton}}class ef{constructor(){this._firstTouch=void 0}_isOneFingerTouch(o){return o.targetTouches.length===1}_isSameTouchEvent(o){return o.targetTouches[0].identifier===this._firstTouch}startMove(o){this._firstTouch=o.targetTouches[0].identifier}endMove(o){delete this._firstTouch}isValidStartEvent(o){return this._isOneFingerTouch(o)}isValidMoveEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}isValidEndEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}}class Bv{constructor(o=new Yl({checkCorrectEvent:()=>!0}),m=new ef){this.mouseMoveStateManager=o,this.oneFingerTouchMoveStateManager=m}_executeRelevantHandler(o,m,g){return o instanceof MouseEvent?m(o):typeof TouchEvent<"u"&&o instanceof TouchEvent?g(o):void 0}startMove(o){this._executeRelevantHandler(o,m=>this.mouseMoveStateManager.startMove(m),m=>this.oneFingerTouchMoveStateManager.startMove(m))}endMove(o){this._executeRelevantHandler(o,m=>this.mouseMoveStateManager.endMove(m),m=>this.oneFingerTouchMoveStateManager.endMove(m))}isValidStartEvent(o){return this._executeRelevantHandler(o,m=>this.mouseMoveStateManager.isValidStartEvent(m),m=>this.oneFingerTouchMoveStateManager.isValidStartEvent(m))}isValidMoveEvent(o){return this._executeRelevantHandler(o,m=>this.mouseMoveStateManager.isValidMoveEvent(m),m=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(m))}isValidEndEvent(o){return this._executeRelevantHandler(o,m=>this.mouseMoveStateManager.isValidEndEvent(m),m=>this.oneFingerTouchMoveStateManager.isValidEndEvent(m))}}const sn=N=>{N.mousedown=N.dragStart,N.mousemoveWindow=N.dragMove,N.mouseup=N.dragEnd,N.contextmenu=o=>{o.preventDefault()}};class qv{constructor(o,m){this._clickTolerance=o.clickTolerance||1,this._map=m,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}_shouldBePrevented(o){return o<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(o,m,g){return this._calculateTransform(o,m,g)}touchmove(o,m,g){if(this._active){if(!this._shouldBePrevented(g.length))return o.preventDefault(),this._calculateTransform(o,m,g);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",o)}}touchend(o,m,g){this._calculateTransform(o,m,g),this._active&&this._shouldBePrevented(g.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,m,g){g.length>0&&(this._active=!0);const b=zv(g,m),P=new a.P(0,0),E=new a.P(0,0);let z=0;for(const U in b){const G=b[U],J=this._touches[U];J&&(P._add(G),E._add(G.sub(J)),z++,b[U]=G)}if(this._touches=b,this._shouldBePrevented(z)||!E.mag())return;const B=E.div(z);return this._sum._add(B),this._sum.mag()<this._clickTolerance?void 0:{around:P.div(z),panDelta:B}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vv{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(o,m,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([m[0],m[1]]))}touchmove(o,m,g){if(!this._firstTwoTouches)return;o.preventDefault();const[b,P]=this._firstTwoTouches,E=sh(g,m,b),z=sh(g,m,P);if(!E||!z)return;const B=this._aroundCenter?null:E.add(z).div(2);return this._move([E,z],B,o)}touchend(o,m,g){if(!this._firstTwoTouches)return;const[b,P]=this._firstTwoTouches,E=sh(g,m,b),z=sh(g,m,P);E&&z||(this._active&&S.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function sh(N,o,m){for(let g=0;g<N.length;g++)if(N[g].identifier===m)return o[g]}function nw(N,o){return Math.log(N/o)/Math.LN2}class sw extends Vv{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,m){const g=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(nw(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:nw(this._distance,g),pinchAround:m}}}function Uv(N,o){return 180*N.angleWith(o)/Math.PI}class ex extends Vv{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,m,g){const b=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Uv(this._vector,b),pinchAround:m}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const m=25/(Math.PI*this._minDiameter)*360,g=Uv(o,this._startVector);return Math.abs(g)<m}}function tx(N){return Math.abs(N.y)>Math.abs(N.x)}class iw extends Vv{constructor(o){super(),this._currentTouchCount=0,this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(o,m,g){super.touchstart(o,m,g),this._currentTouchCount=g.length}_start(o){this._lastPoints=o,tx(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,m,g){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const b=o[0].sub(this._lastPoints[0]),P=o[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(b,P,g.timeStamp),this._valid?(this._lastPoints=o,this._active=!0,{pitchDelta:(b.y+P.y)/2*-.5}):void 0}gestureBeginsVertically(o,m,g){if(this._valid!==void 0)return this._valid;const b=o.mag()>=2,P=m.mag()>=2;if(!b&&!P)return;if(!b||!P)return this._firstMove===void 0&&(this._firstMove=g),g-this._firstMove<100&&void 0;const E=o.y>0==m.y>0;return tx(o)&&tx(m)&&E}}const aw={panStep:100,bearingStep:15,pitchStep:10};class ow{constructor(o){this._tr=new Jm(o);const m=aw;this._panStep=m.panStep,this._bearingStep=m.bearingStep,this._pitchStep=m.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let m=0,g=0,b=0,P=0,E=0;switch(o.keyCode){case 61:case 107:case 171:case 187:m=1;break;case 189:case 109:case 173:m=-1;break;case 37:o.shiftKey?g=-1:(o.preventDefault(),P=-1);break;case 39:o.shiftKey?g=1:(o.preventDefault(),P=1);break;case 38:o.shiftKey?b=1:(o.preventDefault(),E=-1);break;case 40:o.shiftKey?b=-1:(o.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(g=0,b=0),{cameraAnimation:z=>{const B=this._tr;z.easeTo({duration:300,easeId:"keyboardHandler",easing:oC,zoom:m?Math.round(B.zoom)+m*(o.shiftKey?2:1):B.zoom,bearing:B.bearing+g*this._bearingStep,pitch:B.pitch+b*this._pitchStep,offset:[-P*this._panStep,-E*this._panStep],center:B.center},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function oC(N){return N*(2-N)}const Xl=4.000244140625,Gn=1/450;class lw{constructor(o,m){this._onTimeout=g=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(g)},this._map=o,this._tr=new Jm(o),this._triggerRenderFrame=m,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Gn}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(o){return!!this._map.cooperativeGestures.isEnabled()&&!(o.ctrlKey||this._map.cooperativeGestures.isBypassed(o))}wheel(o){if(!this.isEnabled())return;if(this._shouldBePrevented(o))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",o);let m=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const g=k(),b=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,m!==0&&m%Xl==0?this._type="wheel":m!==0&&Math.abs(m)<4?this._type="trackpad":b>400?(this._type=null,this._lastValue=m,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(b*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),o.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=o,this._delta-=m,this._active||this._start(o)),o.preventDefault()}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const m=S.mousePos(this._map.getCanvas(),o),g=this._tr;this._aroundPoint=this._aroundCenter?g.transform.locationToScreenPoint(a.U.convert(g.center)):m,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const z=o.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=z),typeof this._targetZoom=="number"&&(this._targetZoom+=z)}if(this._delta!==0){const z=this._type==="wheel"&&Math.abs(this._delta)>Xl?this._wheelZoomRate:this._defaultZoomRate;let B=2/(1+Math.exp(-Math.abs(this._delta*z)));this._delta<0&&B!==0&&(B=1/B);const U=typeof this._targetZoom!="number"?o.scale:a.al(this._targetZoom);this._targetZoom=o.constrain(o.getCameraLngLat(),a.ao(U*B)).zoom,this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const m=typeof this._targetZoom!="number"?o.zoom:this._targetZoom,g=this._startZoom,b=this._easing;let P,E=!1;if(this._type==="wheel"&&g&&b){const z=k()-this._lastWheelEventTime,B=Math.min((z+5)/200,1),U=b(B);P=a.F.number(g,m,U),B<1?this._frameId||(this._frameId=!0):E=!0}else P=m,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=P,{noInertia:!0,needsRenderFrame:!E,zoomDelta:P-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let m=a.cr;if(this._prevEase){const g=this._prevEase,b=(k()-g.start)/g.duration,P=g.easing(b+.01)-g.easing(b),E=.27/Math.sqrt(P*P+1e-4)*.01,z=Math.sqrt(.0729-E*E);m=a.cp(E,z,.25,1)}return this._prevEase={start:k(),duration:o,easing:m},m}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class tf{constructor(o,m){this._clickZoom=o,this._tapZoom=m}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Wv{constructor(o){this._tr=new Jm(o),this.reset()}reset(){this._active=!1}dblclick(o,m){return o.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:this._tr.zoom+(o.shiftKey?-1:1),around:this._tr.unproject(m)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cw{constructor(){this._tap=new Rd({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(o,m,g){if(!this._swipePoint)if(this._tapTime){const b=m[0],P=o.timeStamp-this._tapTime<500,E=this._tapPoint.dist(b)<30;P&&E?g.length>0&&(this._swipePoint=b,this._swipeTouch=g[0].identifier):this.reset()}else this._tap.touchstart(o,m,g)}touchmove(o,m,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const b=m[0],P=b.y-this._swipePoint.y;return this._swipePoint=b,o.preventDefault(),this._active=!0,{zoomDelta:P/128}}}else this._tap.touchmove(o,m,g)}touchend(o,m,g){if(this._tapTime)this._swipePoint&&g.length===0&&this.reset();else{const b=this._tap.touchend(o,m,g);b&&(this._tapTime=o.timeStamp,this._tapPoint=b)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gv{constructor(o,m,g){this._el=o,this._mousePan=m,this._touchPan=g}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Kv{constructor(o,m,g,b){this._pitchWithRotate=o.pitchWithRotate,this._rollEnabled=o.rollEnabled,this._mouseRotate=m,this._mousePitch=g,this._mouseRoll=b}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class dw{constructor(o,m,g,b){this._el=o,this._touchZoom=m,this._touchRotate=g,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class zo{constructor(o,m){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=o,this._options=m,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const o=this._map.getCanvasContainer();o.classList.add("maplibregl-cooperative-gestures"),this._container=S.create("div","maplibregl-cooperative-gesture-screen",o);let m=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(m=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const g=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),b=document.createElement("div");b.className="maplibregl-desktop-message",b.textContent=m,this._container.appendChild(b);const P=document.createElement("div");P.className="maplibregl-mobile-message",P.textContent=g,this._container.appendChild(P),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(S.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(o){return o[this._bypassKey]}notifyGestureBlocked(o,m){this._enabled&&(this._map.fire(new a.l("cooperativegestureprevented",{gestureType:o,originalEvent:m})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Ld=N=>N.zoom||N.drag||N.roll||N.pitch||N.rotate;class pr extends a.l{}function Ir(N){return N.panDelta&&N.panDelta.mag()||N.zoomDelta||N.bearingDelta||N.pitchDelta||N.rollDelta}class rf{constructor(o,m){this.handleWindowEvent=b=>{this.handleEvent(b,`${b.type}Window`)},this.handleEvent=(b,P)=>{if(b.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const E=b.type==="renderFrame"?void 0:b,z={needsRenderFrame:!1},B={},U={};for(const{handlerName:Y,handler:ne,allowed:fe}of this._handlers){if(!ne.isEnabled())continue;let je;if(this._blockedByActive(U,fe,Y))ne.reset();else if(ne[P||b.type]){if(a.cs(b,P||b.type)){const we=S.mousePos(this._map.getCanvas(),b);je=ne[P||b.type](b,we)}else if(a.ct(b,P||b.type)){const we=this._getMapTouches(b.touches),Se=S.touchPos(this._map.getCanvas(),we);je=ne[P||b.type](b,Se,we)}else a.cu(P||b.type)||(je=ne[P||b.type](b));this.mergeHandlerResult(z,B,je,Y,E),je&&je.needsRenderFrame&&this._triggerRenderFrame()}(je||ne.isActive())&&(U[Y]=ne)}const G={};for(const Y in this._previousActiveHandlers)U[Y]||(G[Y]=E);this._previousActiveHandlers=U,(Object.keys(G).length||Ir(z))&&(this._changes.push([z,B,G]),this._triggerRenderFrame()),(Object.keys(U).length||Ir(z))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:J}=z;J&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],J(this._map))},this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Xj(o),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(m);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[b,P,E]of this._listeners)S.addEventListener(b,P,b===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[o,m,g]of this._listeners)S.removeEventListener(o,m,o===document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(o){const m=this._map,g=m.getCanvasContainer();this._add("mapEvent",new nh(m,o));const b=m.boxZoom=new Jj(m,o);this._add("boxZoom",b),o.interactive&&o.boxZoom&&b.enable();const P=m.cooperativeGestures=new zo(m,o.cooperativeGestures);this._add("cooperativeGestures",P),o.cooperativeGestures&&P.enable();const E=new Zl(m),z=new Wv(m);m.doubleClickZoom=new tf(z,E),this._add("tapZoom",E),this._add("clickZoom",z),o.interactive&&o.doubleClickZoom&&m.doubleClickZoom.enable();const B=new cw;this._add("tapDragZoom",B);const U=m.touchPitch=new iw(m);this._add("touchPitch",U),o.interactive&&o.touchPitch&&m.touchPitch.enable(o.touchPitch);const G=()=>m.project(m.getCenter()),J=function({enable:ke,clickTolerance:Fe,aroundCenter:Be=!0,minPixelCenterThreshold:De=100,rotateDegreesPerPixelMoved:Ke=.8},ht){const it=new Yl({checkCorrectEvent:ot=>S.mouseButton(ot)===0&&ot.ctrlKey||S.mouseButton(ot)===2&&!ot.ctrlKey});return new er({clickTolerance:Fe,move:(ot,mt)=>{const Tt=ht();if(Be&&Math.abs(Tt.y-ot.y)>De)return{bearingDelta:a.cq(new a.P(ot.x,mt.y),mt,Tt)};let Mt=(mt.x-ot.x)*Ke;return Be&&mt.y<Tt.y&&(Mt=-Mt),{bearingDelta:Mt}},moveStateManager:it,enable:ke,assignEvents:sn})}(o,G),Y=function({enable:ke,clickTolerance:Fe,pitchDegreesPerPixelMoved:Be=-.5}){const De=new Yl({checkCorrectEvent:Ke=>S.mouseButton(Ke)===0&&Ke.ctrlKey||S.mouseButton(Ke)===2});return new er({clickTolerance:Fe,move:(Ke,ht)=>({pitchDelta:(ht.y-Ke.y)*Be}),moveStateManager:De,enable:ke,assignEvents:sn})}(o),ne=function({enable:ke,clickTolerance:Fe,rollDegreesPerPixelMoved:Be=.3},De){const Ke=new Yl({checkCorrectEvent:ht=>S.mouseButton(ht)===2&&ht.ctrlKey});return new er({clickTolerance:Fe,move:(ht,it)=>{const ot=De();let mt=(it.x-ht.x)*Be;return it.y<ot.y&&(mt=-mt),{rollDelta:mt}},moveStateManager:Ke,enable:ke,assignEvents:sn})}(o,G);m.dragRotate=new Kv(o,J,Y,ne),this._add("mouseRotate",J,["mousePitch"]),this._add("mousePitch",Y,["mouseRotate","mouseRoll"]),this._add("mouseRoll",ne,["mousePitch"]),o.interactive&&o.dragRotate&&m.dragRotate.enable();const fe=function({enable:ke,clickTolerance:Fe}){const Be=new Yl({checkCorrectEvent:De=>S.mouseButton(De)===0&&!De.ctrlKey});return new er({clickTolerance:Fe,move:(De,Ke)=>({around:Ke,panDelta:Ke.sub(De)}),activateOnStart:!0,moveStateManager:Be,enable:ke,assignEvents:sn})}(o),je=new qv(o,m);m.dragPan=new Gv(g,fe,je),this._add("mousePan",fe),this._add("touchPan",je,["touchZoom","touchRotate"]),o.interactive&&o.dragPan&&m.dragPan.enable(o.dragPan);const we=new ex,Se=new sw;m.touchZoomRotate=new dw(g,Se,we,B),this._add("touchRotate",we,["touchPan","touchZoom"]),this._add("touchZoom",Se,["touchPan","touchRotate"]),o.interactive&&o.touchZoomRotate&&m.touchZoomRotate.enable(o.touchZoomRotate),this._add("blockableMapEvent",new aC(m));const Te=m.scrollZoom=new lw(m,()=>this._triggerRenderFrame());this._add("scrollZoom",Te,["mousePan"]),o.interactive&&o.scrollZoom&&m.scrollZoom.enable(o.scrollZoom);const Le=m.keyboard=new ow(m);this._add("keyboard",Le),o.interactive&&o.keyboard&&m.keyboard.enable()}_add(o,m,g){this._handlers.push({handlerName:o,handler:m,allowed:g}),this._handlersById[o]=m}stop(o){if(!this._updatingCamera){for(const{handler:m}of this._handlers)m.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ld(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,m,g){for(const b in o)if(b!==g&&(!m||m.indexOf(b)<0))return!0;return!1}_getMapTouches(o){const m=[];for(const g of o)this._el.contains(g.target)&&m.push(g);return m}mergeHandlerResult(o,m,g,b,P){if(!g)return;a.e(o,g);const E={handlerName:b,originalEvent:g.originalEvent||P};g.zoomDelta!==void 0&&(m.zoom=E),g.panDelta!==void 0&&(m.drag=E),g.rollDelta!==void 0&&(m.roll=E),g.pitchDelta!==void 0&&(m.pitch=E),g.bearingDelta!==void 0&&(m.rotate=E)}_applyChanges(){const o={},m={},g={};for(const[b,P,E]of this._changes)b.panDelta&&(o.panDelta=(o.panDelta||new a.P(0,0))._add(b.panDelta)),b.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+b.zoomDelta),b.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+b.bearingDelta),b.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+b.pitchDelta),b.rollDelta&&(o.rollDelta=(o.rollDelta||0)+b.rollDelta),b.around!==void 0&&(o.around=b.around),b.pinchAround!==void 0&&(o.pinchAround=b.pinchAround),b.noInertia&&(o.noInertia=b.noInertia),a.e(m,P),a.e(g,E);this._updateMapTransform(o,m,g),this._changes=[]}_updateMapTransform(o,m,g){const b=this._map,P=b._getTransformForUpdate(),E=b.terrain;if(!(Ir(o)||E&&this._terrainMovement))return this._fireEvents(m,g,!0);b._stop(!0);let{panDelta:z,zoomDelta:B,bearingDelta:U,pitchDelta:G,rollDelta:J,around:Y,pinchAround:ne}=o;ne!==void 0&&(Y=ne),Y=Y||b.transform.centerPoint,E&&!P.isPointOnMapSurface(Y)&&(Y=P.centerPoint);const fe={panDelta:z,zoomDelta:B,rollDelta:J,pitchDelta:G,bearingDelta:U,around:Y};this._map.cameraHelper.useGlobeControls&&!P.isPointOnMapSurface(Y)&&(Y=P.centerPoint);const je=Y.distSqr(P.centerPoint)<.01?P.center:P.screenPointToLocation(z?Y.sub(z):Y);this._handleMapControls({terrain:E,tr:P,deltasForHelper:fe,preZoomAroundLoc:je,combinedEventsInProgress:m,panDelta:z}),b._applyUpdatedTransform(P),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(m,g,!0)}_handleMapControls({terrain:o,tr:m,deltasForHelper:g,preZoomAroundLoc:b,combinedEventsInProgress:P,panDelta:E}){const z=this._map.cameraHelper;if(z.handleMapControlsRollPitchBearingZoom(g,m),o)return z.useGlobeControls?(this._terrainMovement||!P.drag&&!P.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void z.handleMapControlsPan(g,m,b)):this._terrainMovement||!P.drag&&!P.zoom?void(P.drag&&this._terrainMovement&&E?m.setCenter(m.screenPointToLocation(m.centerPoint.sub(E))):z.handleMapControlsPan(g,m,b)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void z.handleMapControlsPan(g,m,b));z.handleMapControlsPan(g,m,b)}_fireEvents(o,m,g){const b=Ld(this._eventsInProgress),P=Ld(o),E={};for(const J in o){const{originalEvent:Y}=o[J];this._eventsInProgress[J]||(E[`${J}start`]=Y),this._eventsInProgress[J]=o[J]}!b&&P&&this._fireEvent("movestart",P.originalEvent);for(const J in E)this._fireEvent(J,E[J]);P&&this._fireEvent("move",P.originalEvent);for(const J in o){const{originalEvent:Y}=o[J];this._fireEvent(J,Y)}const z={};let B;for(const J in this._eventsInProgress){const{handlerName:Y,originalEvent:ne}=this._eventsInProgress[J];this._handlersById[Y].isActive()||(delete this._eventsInProgress[J],B=m[Y]||ne,z[`${J}end`]=B)}for(const J in z)this._fireEvent(J,z[J]);const U=Ld(this._eventsInProgress),G=(b||P)&&!U;if(G&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const J=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&J.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(J)}if(g&&G){this._updatingCamera=!0;const J=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Y=ne=>ne!==0&&-this._bearingSnap<ne&&ne<this._bearingSnap;!J||!J.essential&&j.prefersReducedMotion?(this._map.fire(new a.l("moveend",{originalEvent:B})),Y(this._map.getBearing())&&this._map.resetNorth()):(Y(J.bearing||this._map.getBearing())&&(J.bearing=0),J.freezeElevation=!0,this._map.easeTo(J,{originalEvent:B})),this._updatingCamera=!1}}_fireEvent(o,m){this._map.fire(new a.l(o,m?{originalEvent:m}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new pr("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class uw extends a.E{constructor(o,m,g){super(),this._renderFrameCallback=()=>{const b=Math.min((k()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(b)),b<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=g.bearingSnap,this.cameraHelper=m,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(o,m){o.apply(this.transform),this.transform=o,this.cameraHelper=m}getCenter(){return new a.U(this.transform.center.lng,this.transform.center.lat)}setCenter(o,m){return this.jumpTo({center:o},m)}getCenterElevation(){return this.transform.elevation}setCenterElevation(o,m){return this.jumpTo({elevation:o},m),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(o){this._centerClampedToGround=o}panBy(o,m,g){return o=a.P.convert(o).mult(-1),this.panTo(this.transform.center,a.e({offset:o},m),g)}panTo(o,m,g){return this.easeTo(a.e({center:o},m),g)}getZoom(){return this.transform.zoom}setZoom(o,m){return this.jumpTo({zoom:o},m),this}zoomTo(o,m,g){return this.easeTo(a.e({zoom:o},m),g)}zoomIn(o,m){return this.zoomTo(this.getZoom()+1,o,m),this}zoomOut(o,m){return this.zoomTo(this.getZoom()-1,o,m),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(o,m){return o!=this.transform.fov&&(this.transform.setFov(o),this.fire(new a.l("movestart",m)).fire(new a.l("move",m)).fire(new a.l("moveend",m))),this}getBearing(){return this.transform.bearing}setBearing(o,m){return this.jumpTo({bearing:o},m),this}getPadding(){return this.transform.padding}setPadding(o,m){return this.jumpTo({padding:o},m),this}rotateTo(o,m,g){return this.easeTo(a.e({bearing:o},m),g)}resetNorth(o,m){return this.rotateTo(0,a.e({duration:1e3},o),m),this}resetNorthPitch(o,m){return this.easeTo(a.e({bearing:0,pitch:0,roll:0,duration:1e3},o),m),this}snapToNorth(o,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,m):this}getPitch(){return this.transform.pitch}setPitch(o,m){return this.jumpTo({pitch:o},m),this}getRoll(){return this.transform.roll}setRoll(o,m){return this.jumpTo({roll:o},m),this}cameraForBounds(o,m){o=Lr.convert(o).adjustAntiMeridian();const g=m&&m.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),g,m)}_cameraForBoxAndBearing(o,m,g,b){const P={top:0,bottom:0,right:0,left:0};if(typeof(b=a.e({padding:P,offset:[0,0],maxZoom:this.transform.maxZoom},b)).padding=="number"){const U=b.padding;b.padding={top:U,bottom:U,right:U,left:U}}const E=a.e(P,b.padding);b.padding=E;const z=this.transform,B=new Lr(o,m);return this.cameraHelper.cameraForBoxAndBearing(b,E,B,g,z)}fitBounds(o,m,g){return this._fitInternal(this.cameraForBounds(o,m),m,g)}fitScreenCoordinates(o,m,g,b,P){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(a.P.convert(o)),this.transform.screenPointToLocation(a.P.convert(m)),g,b),b,P)}_fitInternal(o,m,g){return o?(delete(m=a.e(o,m)).padding,m.linear?this.easeTo(m,g):this.flyTo(m,g)):this}jumpTo(o,m){this.stop();const g=this._getTransformForUpdate();let b=!1,P=!1,E=!1;const z=g.zoom;this.cameraHelper.handleJumpToCenterZoom(g,o);const B=g.zoom!==z;return"elevation"in o&&g.elevation!==+o.elevation&&g.setElevation(+o.elevation),"bearing"in o&&g.bearing!==+o.bearing&&(b=!0,g.setBearing(+o.bearing)),"pitch"in o&&g.pitch!==+o.pitch&&(P=!0,g.setPitch(+o.pitch)),"roll"in o&&g.roll!==+o.roll&&(E=!0,g.setRoll(+o.roll)),o.padding==null||g.isPaddingEqual(o.padding)||g.setPadding(o.padding),this._applyUpdatedTransform(g),this.fire(new a.l("movestart",m)).fire(new a.l("move",m)),B&&this.fire(new a.l("zoomstart",m)).fire(new a.l("zoom",m)).fire(new a.l("zoomend",m)),b&&this.fire(new a.l("rotatestart",m)).fire(new a.l("rotate",m)).fire(new a.l("rotateend",m)),P&&this.fire(new a.l("pitchstart",m)).fire(new a.l("pitch",m)).fire(new a.l("pitchend",m)),E&&this.fire(new a.l("rollstart",m)).fire(new a.l("roll",m)).fire(new a.l("rollend",m)),this.fire(new a.l("moveend",m))}calculateCameraOptionsFromTo(o,m,g,b=0){const P=a.a5.fromLngLat(o,m),E=a.a5.fromLngLat(g,b),z=E.x-P.x,B=E.y-P.y,U=E.z-P.z,G=Math.hypot(z,B,U);if(G===0)throw new Error("Can't calculate camera options with same From and To");const J=Math.hypot(z,B),Y=a.ao(this.transform.cameraToCenterDistance/G/this.transform.tileSize),ne=180*Math.atan2(z,-B)/Math.PI;let fe=180*Math.acos(J/G)/Math.PI;return fe=U<0?90-fe:90+fe,{center:E.toLngLat(),elevation:b,zoom:Y,pitch:fe,bearing:ne}}calculateCameraOptionsFromCameraLngLatAltRotation(o,m,g,b,P){const E=this.transform.calculateCenterFromCameraLngLatAlt(o,m,g,b);return{center:E.center,elevation:E.elevation,zoom:E.zoom,bearing:g,pitch:b,roll:P}}easeTo(o,m){this._stop(!1,o.easeId),((o=a.e({offset:[0,0],duration:500,easing:a.cr},o)).animate===!1||!o.essential&&j.prefersReducedMotion)&&(o.duration=0);const g=this._getTransformForUpdate(),b=this.getBearing(),P=g.pitch,E=g.roll,z="bearing"in o?this._normalizeBearing(o.bearing,b):b,B="pitch"in o?+o.pitch:P,U="roll"in o?this._normalizeBearing(o.roll,E):E,G="padding"in o?o.padding:g.padding,J=a.P.convert(o.offset);let Y,ne;o.around&&(Y=a.U.convert(o.around),ne=g.locationToScreenPoint(Y));const fe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},je=this.cameraHelper.handleEaseTo(g,{bearing:z,pitch:B,roll:U,padding:G,around:Y,aroundPoint:ne,offsetAsPoint:J,offset:o.offset,zoom:o.zoom,center:o.center});return this._rotating=this._rotating||b!==z,this._pitching=this._pitching||B!==P,this._rolling=this._rolling||U!==E,this._padding=!g.isPaddingEqual(G),this._zooming=this._zooming||je.isZooming,this._easeId=o.easeId,this._prepareEase(m,o.noMoveStart,fe),this.terrain&&this._prepareElevation(je.elevationCenter),this._ease(we=>{je.easeFunc(we),this.terrain&&!o.freezeElevation&&this._updateElevation(we),this._applyUpdatedTransform(g),this._fireMoveEvents(m)},we=>{this.terrain&&o.freezeElevation&&this._finalizeElevation(),this._afterEase(m,we)},o),this}_prepareEase(o,m,g={}){this._moving=!0,m||g.moving||this.fire(new a.l("movestart",o)),this._zooming&&!g.zooming&&this.fire(new a.l("zoomstart",o)),this._rotating&&!g.rotating&&this.fire(new a.l("rotatestart",o)),this._pitching&&!g.pitching&&this.fire(new a.l("pitchstart",o)),this._rolling&&!g.rolling&&this.fire(new a.l("rollstart",o))}_prepareElevation(o){this._elevationCenter=o,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(o){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const m=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(o<1&&m!==this._elevationTarget){const g=this._elevationTarget-this._elevationStart;this._elevationStart+=o*(g-(m-(g*o+this._elevationStart))/(1-o)),this._elevationTarget=m}this.transform.setElevation(a.F.number(this._elevationStart,this._elevationTarget,o))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(o){if(!this.terrain&&o.elevation>=0&&o.pitch<=90)return{};const m=o.getCameraLngLat(),g=o.getCameraAltitude(),b=this.terrain?this.terrain.getElevationForLngLatZoom(m,o.zoom):0;if(g<b){const P=this.calculateCameraOptionsFromTo(m,b,o.center,o.elevation);return{pitch:P.pitch,zoom:P.zoom}}return{}}_applyUpdatedTransform(o){const m=[];if(m.push(b=>this._elevateCameraIfInsideTerrain(b)),this.transformCameraUpdate&&m.push(b=>this.transformCameraUpdate(b)),!m.length)return;const g=o.clone();for(const b of m){const P=g.clone(),{center:E,zoom:z,roll:B,pitch:U,bearing:G,elevation:J}=b(P);E&&P.setCenter(E),J!==void 0&&P.setElevation(J),z!==void 0&&P.setZoom(z),B!==void 0&&P.setRoll(B),U!==void 0&&P.setPitch(U),G!==void 0&&P.setBearing(G),g.apply(P)}this.transform.apply(g)}_fireMoveEvents(o){this.fire(new a.l("move",o)),this._zooming&&this.fire(new a.l("zoom",o)),this._rotating&&this.fire(new a.l("rotate",o)),this._pitching&&this.fire(new a.l("pitch",o)),this._rolling&&this.fire(new a.l("roll",o))}_afterEase(o,m){if(this._easeId&&m&&this._easeId===m)return;delete this._easeId;const g=this._zooming,b=this._rotating,P=this._pitching,E=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,g&&this.fire(new a.l("zoomend",o)),b&&this.fire(new a.l("rotateend",o)),P&&this.fire(new a.l("pitchend",o)),E&&this.fire(new a.l("rollend",o)),this.fire(new a.l("moveend",o))}flyTo(o,m){if(!o.essential&&j.prefersReducedMotion){const mt=a.S(o,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(mt,m)}this.stop(),o=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.cr},o);const g=this._getTransformForUpdate(),b=g.bearing,P=g.pitch,E=g.roll,z=g.padding,B="bearing"in o?this._normalizeBearing(o.bearing,b):b,U="pitch"in o?+o.pitch:P,G="roll"in o?this._normalizeBearing(o.roll,E):E,J="padding"in o?o.padding:g.padding,Y=a.P.convert(o.offset);let ne=g.centerPoint.add(Y);const fe=g.screenPointToLocation(ne),je=this.cameraHelper.handleFlyTo(g,{bearing:B,pitch:U,roll:G,padding:J,locationAtOffset:fe,offsetAsPoint:Y,center:o.center,minZoom:o.minZoom,zoom:o.zoom});let we=o.curve;const Se=Math.max(g.width,g.height),Te=Se/je.scaleOfZoom,Le=je.pixelPathLength;typeof je.scaleOfMinZoom=="number"&&(we=Math.sqrt(Se/je.scaleOfMinZoom/Le*2));const ke=we*we;function Fe(mt){const Tt=(Te*Te-Se*Se+(mt?-1:1)*ke*ke*Le*Le)/(2*(mt?Te:Se)*ke*Le);return Math.log(Math.sqrt(Tt*Tt+1)-Tt)}function Be(mt){return(Math.exp(mt)-Math.exp(-mt))/2}function De(mt){return(Math.exp(mt)+Math.exp(-mt))/2}const Ke=Fe(!1);let ht=function(mt){return De(Ke)/De(Ke+we*mt)},it=function(mt){return Se*((De(Ke)*(Be(Tt=Ke+we*mt)/De(Tt))-Be(Ke))/ke)/Le;var Tt},ot=(Fe(!0)-Ke)/we;if(Math.abs(Le)<2e-6||!isFinite(ot)){if(Math.abs(Se-Te)<1e-6)return this.easeTo(o,m);const mt=Te<Se?-1:1;ot=Math.abs(Math.log(Te/Se))/we,it=()=>0,ht=Tt=>Math.exp(mt*we*Tt)}return o.duration="duration"in o?+o.duration:1e3*ot/("screenSpeed"in o?+o.screenSpeed/we:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=b!==B,this._pitching=U!==P,this._rolling=G!==E,this._padding=!g.isPaddingEqual(J),this._prepareEase(m,!1),this.terrain&&this._prepareElevation(je.targetCenter),this._ease(mt=>{const Tt=mt*ot,Mt=1/ht(Tt),bt=it(Tt);this._rotating&&g.setBearing(a.F.number(b,B,mt)),this._pitching&&g.setPitch(a.F.number(P,U,mt)),this._rolling&&g.setRoll(a.F.number(E,G,mt)),this._padding&&(g.interpolatePadding(z,J,mt),ne=g.centerPoint.add(Y)),je.easeFunc(mt,Mt,bt,ne),this.terrain&&!o.freezeElevation&&this._updateElevation(mt),this._applyUpdatedTransform(g),this._fireMoveEvents(m)},()=>{this.terrain&&o.freezeElevation&&this._finalizeElevation(),this._afterEase(m)},o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,m){var g;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const b=this._onEaseEnd;delete this._onEaseEnd,b.call(this,m)}return o||(g=this.handlers)===null||g===void 0||g.stop(!1),this}_ease(o,m,g){g.animate===!1||g.duration===0?(o(1),m()):(this._easeStart=k(),this._easeOptions=g,this._onEaseFrame=o,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(o,m){o=a.V(o,-180,180);const g=Math.abs(o-m);return Math.abs(o-360-m)<g&&(o-=360),Math.abs(o+360-m)<g&&(o+=360),o}queryTerrainElevation(o){return this.terrain?this.terrain.getElevationForLngLatZoom(a.U.convert(o),this.transform.tileZoom):null}}const nf={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class oa{constructor(o=nf){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=m=>{!m||m.sourceDataType!=="metadata"&&m.sourceDataType!=="visibility"&&m.dataType!=="style"&&m.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=o}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options.compact,this._container=S.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=S.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=S.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){S.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,m){const g=this._map._getUIString(`AttributionControl.${m}`);o.title=g,o.setAttribute("aria-label",g)}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(b=>typeof b!="string"?"":b)):typeof this.options.customAttribution=="string"&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}const m=this._map.style.tileManagers;for(const b in m){const P=m[b];if(P.used||P.usedForTerrain){const E=P.getSource();E.attribution&&o.indexOf(E.attribution)<0&&o.push(E.attribution)}}o=o.filter(b=>String(b).trim()),o.sort((b,P)=>b.length-P.length),o=o.filter((b,P)=>{for(let E=P+1;E<o.length;E++)if(o[E].indexOf(b)>=0)return!1;return!0});const g=o.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,o.length?(this._innerContainer.innerHTML=S.sanitize(g),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Hv{constructor(o={}){this._updateCompact=()=>{const m=this._container.children;if(m.length){const g=m[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&g.classList.add("maplibregl-compact"):g.classList.remove("maplibregl-compact")}},this.options=o}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=S.create("div","maplibregl-ctrl");const m=S.create("a","maplibregl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://maplibre.org/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){S.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class $o{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const m=++this._id;return this._queue.push({callback:o,id:m,cancelled:!1}),m}remove(o){const m=this._currentlyRunning,g=m?this._queue.concat(m):this._queue;for(const b of g)if(b.id===o)return void(b.cancelled=!0)}run(o=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const m=this._currentlyRunning=this._queue;this._queue=[];for(const g of m)if(!g.cancelled&&(g.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var hw=a.aN([{name:"a_pos3d",type:"Int16",components:3}]);class lC extends a.E{constructor(o){super(),this._lastTilesetChange=k(),this.tileManager=o,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=o._source.tileSize*2**this.deltaZoom,o.usedForTerrain=!0,o.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(o,m){this.tileManager.update(o,m),this._renderableTilesKeys=[];const g={};for(const b of Cn(o,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:m,calculateTileZoom:this.tileManager._source.calculateTileZoom}))g[b.key]=!0,this._renderableTilesKeys.push(b.key),this._tiles[b.key]||(b.terrainRttPosMatrix32f=new Float64Array(16),a.c0(b.terrainRttPosMatrix32f,0,a.a3,a.a3,0,0,1),this._tiles[b.key]=new ze(b,this.tileSize),this._lastTilesetChange=k());for(const b in this._tiles)g[b]||delete this._tiles[b]}freeRtt(o){for(const m in this._tiles){const g=this._tiles[m];(!o||g.tileID.equals(o)||g.tileID.isChildOf(o)||o.isChildOf(g.tileID))&&(g.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(o=>this.getTileByID(o))}getTileByID(o){return this._tiles[o]}getTerrainCoords(o,m){return m?this._getTerrainCoordsForTileRanges(o,m):this._getTerrainCoordsForRegularTile(o)}_getTerrainCoordsForRegularTile(o){const m={};for(const g of this._renderableTilesKeys){const b=this._tiles[g].tileID,P=o.clone(),E=a.bd();if(b.canonical.equals(o.canonical))a.c0(E,0,a.a3,a.a3,0,0,1);else if(b.canonical.isChildOf(o.canonical)){const z=b.canonical.z-o.canonical.z,B=b.canonical.x-(b.canonical.x>>z<<z),U=b.canonical.y-(b.canonical.y>>z<<z),G=a.a3>>z;a.c0(E,0,G,G,0,0,1),a.N(E,E,[-B*G,-U*G,0])}else{if(!o.canonical.isChildOf(b.canonical))continue;{const z=o.canonical.z-b.canonical.z,B=o.canonical.x-(o.canonical.x>>z<<z),U=o.canonical.y-(o.canonical.y>>z<<z),G=a.a3>>z;a.c0(E,0,a.a3,a.a3,0,0,1),a.N(E,E,[B*G,U*G,0]),a.O(E,E,[1/2**z,1/2**z,0])}}P.terrainRttPosMatrix32f=new Float32Array(E),m[g]=P}return m}_getTerrainCoordsForTileRanges(o,m){const g={};for(const b of this._renderableTilesKeys){const P=this._tiles[b].tileID;if(!this._isWithinTileRanges(P,m))continue;const E=o.clone(),z=a.bd();if(P.canonical.z===o.canonical.z){const B=o.canonical.x-P.canonical.x,U=o.canonical.y-P.canonical.y;a.c0(z,0,a.a3,a.a3,0,0,1),a.N(z,z,[B*a.a3,U*a.a3,0])}else if(P.canonical.z>o.canonical.z){const B=P.canonical.z-o.canonical.z,U=P.canonical.x-(P.canonical.x>>B<<B),G=P.canonical.y-(P.canonical.y>>B<<B),J=o.canonical.x-(P.canonical.x>>B),Y=o.canonical.y-(P.canonical.y>>B),ne=a.a3>>B;a.c0(z,0,ne,ne,0,0,1),a.N(z,z,[-U*ne+J*a.a3,-G*ne+Y*a.a3,0])}else{const B=o.canonical.z-P.canonical.z,U=o.canonical.x-(o.canonical.x>>B<<B),G=o.canonical.y-(o.canonical.y>>B<<B),J=(o.canonical.x>>B)-P.canonical.x,Y=(o.canonical.y>>B)-P.canonical.y,ne=a.a3<<B;a.c0(z,0,ne,ne,0,0,1),a.N(z,z,[U*a.a3+J*ne,G*a.a3+Y*ne,0])}E.terrainRttPosMatrix32f=new Float32Array(z),g[b]=E}return g}getSourceTile(o,m){const g=this.tileManager._source;let b=o.overscaledZ-this.deltaZoom;if(b>g.maxzoom&&(b=g.maxzoom),b<g.minzoom)return null;this._sourceTileCache[o.key]||(this._sourceTileCache[o.key]=o.scaledTo(b).key);let P=this.tileManager.getTileByID(this._sourceTileCache[o.key]);if((!P||!P.dem)&&m)for(;b>=g.minzoom&&(!P||!P.dem);)P=this.tileManager.getTileByID(o.scaledTo(b--).key);return P}anyTilesAfterTime(o=Date.now()){return this._lastTilesetChange>=o}_isWithinTileRanges(o,m){return m[o.canonical.z]&&o.canonical.x>=m[o.canonical.z].minTileX&&o.canonical.x<=m[o.canonical.z].maxTileX&&o.canonical.y>=m[o.canonical.z].minTileY&&o.canonical.y<=m[o.canonical.z].maxTileY}}class cC{constructor(o,m,g){this._meshCache={},this.painter=o,this.tileManager=new lC(m),this.options=g,this.exaggeration=typeof g.exaggeration=="number"?g.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(o,m,g,b=a.a3){var P;if(!(m>=0&&m<b&&g>=0&&g<b))return 0;const E=this.getTerrainData(o),z=(P=E.tile)===null||P===void 0?void 0:P.dem;if(!z)return 0;const B=a.cv([],[m/b*a.a3,g/b*a.a3],E.u_terrain_matrix),U=[B[0]*z.dim,B[1]*z.dim],G=Math.floor(U[0]),J=Math.floor(U[1]),Y=U[0]-G,ne=U[1]-J;return z.get(G,J)*(1-Y)*(1-ne)+z.get(G+1,J)*Y*(1-ne)+z.get(G,J+1)*(1-Y)*ne+z.get(G+1,J+1)*Y*ne}getElevationForLngLatZoom(o,m){if(!a.cw(m,o.wrap()))return 0;const{tileID:g,mercatorX:b,mercatorY:P}=this._getOverscaledTileIDFromLngLatZoom(o,m);return this.getElevation(g,b%a.a3,P%a.a3,a.a3)}getElevation(o,m,g,b=a.a3){return this.getDEMElevation(o,m,g,b)*this.exaggeration}getTerrainData(o){if(!this._emptyDemTexture){const b=this.painter.context,P=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new a.T(b,P,b.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new a.T(b,new a.R({width:1,height:1}),b.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(b.gl.NEAREST,b.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.am([])}const m=this.tileManager.getSourceTile(o,!0);if(m&&m.dem&&(!m.demTexture||m.needsTerrainPrepare)){const b=this.painter.context;m.demTexture=this.painter.getTileTexture(m.dem.stride),m.demTexture?m.demTexture.update(m.dem.getPixels(),{premultiply:!1}):m.demTexture=new a.T(b,m.dem.getPixels(),b.gl.RGBA,{premultiply:!1}),m.demTexture.bind(b.gl.NEAREST,b.gl.CLAMP_TO_EDGE),m.needsTerrainPrepare=!1}const g=m&&m+m.tileID.key+o.key;if(g&&!this._demMatrixCache[g]){const b=this.tileManager.getSource().maxzoom;let P=o.canonical.z-m.tileID.canonical.z;o.overscaledZ>o.canonical.z&&(o.canonical.z>=b?P=o.canonical.z-b:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=o.canonical.x-(o.canonical.x>>P<<P),z=o.canonical.y-(o.canonical.y>>P<<P),B=a.cx(new Float64Array(16),[1/(a.a3<<P),1/(a.a3<<P),0]);a.N(B,B,[E*a.a3,z*a.a3,0]),this._demMatrixCache[o.key]={matrix:B,coord:o}}return{u_depth:2,u_terrain:3,u_terrain_dim:m&&m.dem&&m.dem.dim||1,u_terrain_matrix:g?this._demMatrixCache[o.key].matrix:this._emptyDemMatrix,u_terrain_unpack:m&&m.dem&&m.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(m&&m.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:m}}getFramebuffer(o){const m=this.painter,g=m.width/devicePixelRatio,b=m.height/devicePixelRatio;return!this._fbo||this._fbo.width===g&&this._fbo.height===b||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new a.T(m.context,{width:g,height:b,data:null},m.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(m.context.gl.NEAREST,m.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new a.T(m.context,{width:g,height:b,data:null},m.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(m.context.gl.NEAREST,m.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=m.context.createFramebuffer(g,b,!0,!1),this._fbo.depthAttachment.set(m.context.createRenderbuffer(m.context.gl.DEPTH_COMPONENT16,g,b))),this._fbo.colorAttachment.set(o==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const o=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const m=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let P=0,E=0;P<this._coordsTextureSize;P++)for(let z=0;z<this._coordsTextureSize;z++,E+=4)m[E+0]=255&z,m[E+1]=255&P,m[E+2]=z>>8<<4|P>>8,m[E+3]=0;const g=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(m.buffer)),b=new a.T(o,g,o.gl.RGBA,{premultiply:!1});return b.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),this._coordsTexture=b,b}pointCoordinate(o){this.painter.maybeDrawDepthAndCoords(!0);const m=new Uint8Array(4),g=this.painter.context,b=g.gl,P=Math.round(o.x*this.painter.pixelRatio/devicePixelRatio),E=Math.round(o.y*this.painter.pixelRatio/devicePixelRatio),z=Math.round(this.painter.height/devicePixelRatio);g.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),b.readPixels(P,z-E-1,1,1,b.RGBA,b.UNSIGNED_BYTE,m),g.bindFramebuffer.set(null);const B=m[0]+(m[2]>>4<<8),U=m[1]+((15&m[2])<<8),G=this.coordsIndex[255-m[3]],J=G&&this.tileManager.getTileByID(G);if(!J)return null;const Y=this._coordsTextureSize,ne=(1<<J.tileID.canonical.z)*Y;return new a.a5((J.tileID.canonical.x*Y+B)/ne+J.tileID.wrap,(J.tileID.canonical.y*Y+U)/ne,this.getElevation(J.tileID,B,U,Y))}depthAtPoint(o){const m=new Uint8Array(4),g=this.painter.context,b=g.gl;return g.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),b.readPixels(o.x,this.painter.height/devicePixelRatio-o.y-1,1,1,b.RGBA,b.UNSIGNED_BYTE,m),g.bindFramebuffer.set(null),(m[0]/16777216+m[1]/65536+m[2]/256+m[3])/256}getTerrainMesh(o){var m;const g=((m=this.painter.style.projection)===null||m===void 0?void 0:m.transitionState)>0,b=g&&o.canonical.y===0,P=g&&o.canonical.y===(1<<o.canonical.z)-1,E=`m_${b?"n":""}_${P?"s":""}`;if(this._meshCache[E])return this._meshCache[E];const z=this.painter.context,B=new a.cy,U=new a.aR,G=this.meshSize,J=a.a3/G,Y=G*G;for(let De=0;De<=G;De++)for(let Ke=0;Ke<=G;Ke++)B.emplaceBack(Ke*J,De*J,0);for(let De=0;De<Y;De+=G+1)for(let Ke=0;Ke<G;Ke++)U.emplaceBack(Ke+De,G+Ke+De+1,G+Ke+De+2),U.emplaceBack(Ke+De,G+Ke+De+2,Ke+De+1);const ne=B.length,fe=ne+(G+1),je=(G+1)*G,we=b?a.bk:0,Se=b?0:1,Te=P?a.bl:a.a3,Le=P?0:1;for(let De=0;De<=G;De++)B.emplaceBack(De*J,we,Se);for(let De=0;De<=G;De++)B.emplaceBack(De*J,Te,Le);for(let De=0;De<G;De++)U.emplaceBack(je+De,fe+De,fe+De+1),U.emplaceBack(je+De,fe+De+1,je+De+1),U.emplaceBack(0+De,ne+De+1,ne+De),U.emplaceBack(0+De,0+De+1,ne+De+1);const ke=B.length,Fe=ke+2*(G+1);for(const De of[0,1])for(let Ke=0;Ke<=G;Ke++)for(const ht of[0,1])B.emplaceBack(De*a.a3,Ke*J,ht);for(let De=0;De<2*G;De+=2)U.emplaceBack(ke+De,ke+De+1,ke+De+3),U.emplaceBack(ke+De,ke+De+3,ke+De+2),U.emplaceBack(Fe+De,Fe+De+3,Fe+De+1),U.emplaceBack(Fe+De,Fe+De+2,Fe+De+3);const Be=new Wu(z.createVertexBuffer(B,hw.members),z.createIndexBuffer(U),a.aQ.simpleSegment(0,0,B.length,U.length));return this._meshCache[E]=Be,Be}getMeshFrameDelta(o){return 2*Math.PI*a.bx/Math.pow(2,Math.max(o,0))/5}getMinTileElevationForLngLatZoom(o,m){var g;const{tileID:b}=this._getOverscaledTileIDFromLngLatZoom(o,m);return(g=this.getMinMaxElevation(b).minElevation)!==null&&g!==void 0?g:0}getMinMaxElevation(o){const m=this.getTerrainData(o).tile,g={minElevation:null,maxElevation:null};return m&&m.dem&&(g.minElevation=m.dem.min*this.exaggeration,g.maxElevation=m.dem.max*this.exaggeration),g}_getOverscaledTileIDFromLngLatZoom(o,m){const g=a.a5.fromLngLat(o.wrap()),b=(1<<m)*a.a3,P=g.x*b,E=g.y*b,z=Math.floor(P/a.a3),B=Math.floor(E/a.a3);return{tileID:new a.a0(m,0,m,z,B),mercatorX:P,mercatorY:E}}}class dC{constructor(o,m,g){this._context=o,this._size=m,this._tileSize=g,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const o of this._objects)o.texture.destroy(),o.fbo.destroy()}_createObject(o){const m=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),g=new a.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return g.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),m.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),m.colorAttachment.set(g.texture),{id:o,fbo:m,texture:g,stamp:-1,inUse:!1}}getObjectForId(o){return this._objects[o]}useObject(o){o.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(m=>o.id!==m),this._recentlyUsed.push(o.id)}stampObject(o){o.stamp=++this._stamp}getOrCreateFreeObject(){for(const m of this._recentlyUsed)if(!this._objects[m].inUse)return this._objects[m];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const o=this._createObject(this._objects.length);return this._objects.push(o),o}freeObject(o){o.inUse=!1}freeAllObjects(){for(const o of this._objects)this.freeObject(o)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(o=>!o.inUse)===!1}}const xl={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class vs{constructor(o,m){this.painter=o,this.terrain=m,this.pool=new dC(o.context,30,m.tileManager.tileSize*m.qualityFactor)}destruct(){this.pool.destruct()}getTexture(o){return this.pool.getObjectForId(o.rtt[this._stacks.length-1].id).texture}prepareForRender(o,m){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=o._order.filter(g=>!o._layers[g].isHidden(m)),this._coordsAscending={};for(const g in o.tileManagers){this._coordsAscending[g]={};const b=o.tileManagers[g].getVisibleCoordinates(),P=o.tileManagers[g].getSource(),E=P instanceof Vt?P.terrainTileRanges:null;for(const z of b){const B=this.terrain.tileManager.getTerrainCoords(z,E);for(const U in B)this._coordsAscending[g][U]||(this._coordsAscending[g][U]=[]),this._coordsAscending[g][U].push(B[U])}}this._coordsAscendingStr={};for(const g of o._order){const b=o._layers[g],P=b.source;if(xl[b.type]&&!this._coordsAscendingStr[P]){this._coordsAscendingStr[P]={};for(const E in this._coordsAscending[P])this._coordsAscendingStr[P][E]=this._coordsAscending[P][E].map(z=>z.key).sort().join()}}for(const g of this._renderableTiles)for(const b in this._coordsAscendingStr){const P=this._coordsAscendingStr[b][g.tileID.key];P&&P!==g.rttCoords[b]&&(g.rtt=[])}}renderLayer(o,m){if(o.isHidden(this.painter.transform.zoom))return!1;const g=Object.assign(Object.assign({},m),{isRenderingToTexture:!0}),b=o.type,P=this.painter,E=this._renderableLayerIds[this._renderableLayerIds.length-1]===o.id;if(xl[b]&&(this._prevType&&xl[this._prevType]||this._stacks.push([]),this._prevType=b,this._stacks[this._stacks.length-1].push(o.id),!E))return!0;if(xl[this._prevType]||xl[b]&&E){this._prevType=b;const z=this._stacks.length-1,B=this._stacks[z]||[];for(const U of this._renderableTiles){if(this.pool.isFull()&&(Rv(this.painter,this.terrain,this._rttTiles,g),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(U),U.rtt[z]){const J=this.pool.getObjectForId(U.rtt[z].id);if(J.stamp===U.rtt[z].stamp){this.pool.useObject(J);continue}}const G=this.pool.getOrCreateFreeObject();this.pool.useObject(G),this.pool.stampObject(G),U.rtt[z]={id:G.id,stamp:G.stamp},P.context.bindFramebuffer.set(G.fbo.framebuffer),P.context.clear({color:a.bi.transparent,stencil:0}),P.currentStencilSource=void 0;for(let J=0;J<B.length;J++){const Y=P.style._layers[B[J]],ne=Y.source?this._coordsAscending[Y.source][U.tileID.key]:[U.tileID];P.context.viewport.set([0,0,G.fbo.width,G.fbo.height]),P._renderTileClippingMasks(Y,ne,!0),P.renderLayer(P,P.style.tileManagers[Y.source],Y,ne,g),Y.source&&(U.rttCoords[Y.source]=this._coordsAscendingStr[Y.source][U.tileID.key])}}return Rv(this.painter,this.terrain,this._rttTiles,g),this._rttTiles=[],this.pool.freeAllObjects(),xl[b]}return!1}}const qs={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},mw=f,ih={hash:!1,interactive:!0,bearingSnap:7,attributionControl:nf,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},rx={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Zv{constructor(o,m,g=!1){this.mousedown=P=>{this.startMove(P,S.mousePos(this.element,P)),S.addEventListener(window,"mousemove",this.mousemove),S.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=P=>{this.move(P,S.mousePos(this.element,P))},this.mouseup=P=>{this._rotatePitchHandler.dragEnd(P),this.offTemp()},this.touchstart=P=>{P.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=S.touchPos(this.element,P.targetTouches)[0],this.startMove(P,this._startPos),S.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),S.addEventListener(window,"touchend",this.touchend))},this.touchmove=P=>{P.targetTouches.length!==1?this.reset():(this._lastPos=S.touchPos(this.element,P.targetTouches)[0],this.move(P,this._lastPos))},this.touchend=P=>{P.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=m;const b=new Bv;this._rotatePitchHandler=new er({clickTolerance:3,move:(P,E)=>{const z=m.getBoundingClientRect(),B=new a.P((z.bottom-z.top)/2,(z.right-z.left)/2);return{bearingDelta:a.cq(new a.P(P.x,E.y),E,B),pitchDelta:g?-.5*(E.y-P.y):void 0}},moveStateManager:b,enable:!0,assignEvents:()=>{}}),this.map=o,S.addEventListener(m,"mousedown",this.mousedown),S.addEventListener(m,"touchstart",this.touchstart,{passive:!1}),S.addEventListener(m,"touchcancel",this.reset)}startMove(o,m){this._rotatePitchHandler.dragStart(o,m),S.disableDrag()}move(o,m){const g=this.map,{bearingDelta:b,pitchDelta:P}=this._rotatePitchHandler.dragMove(o,m)||{};b&&g.setBearing(g.getBearing()+b),P&&g.setPitch(g.getPitch()+P)}off(){const o=this.element;S.removeEventListener(o,"mousedown",this.mousedown),S.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),S.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),S.removeEventListener(window,"touchend",this.touchend),S.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){S.enableDrag(),S.removeEventListener(window,"mousemove",this.mousemove),S.removeEventListener(window,"mouseup",this.mouseup),S.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),S.removeEventListener(window,"touchend",this.touchend)}}let Ql;function nx(N,o,m,g=!1){if(g||!m.getCoveringTilesDetailsProvider().allowWorldCopies())return N==null?void 0:N.wrap();const b=new a.U(N.lng,N.lat);if(N=new a.U(N.lng,N.lat),o){const P=new a.U(N.lng-360,N.lat),E=new a.U(N.lng+360,N.lat),z=m.locationToScreenPoint(N).distSqr(o);m.locationToScreenPoint(P).distSqr(o)<z?N=P:m.locationToScreenPoint(E).distSqr(o)<z&&(N=E)}for(;Math.abs(N.lng-m.center.lng)>180;){const P=m.locationToScreenPoint(N);if(P.x>=0&&P.y>=0&&P.x<=m.width&&P.y<=m.height)break;N.lng>m.center.lng?N.lng-=360:N.lng+=360}return N.lng!==b.lng&&m.isPointOnMapSurface(m.locationToScreenPoint(N))?N:b}const Fd={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function sx(N,o,m){const g=N.classList;for(const b in Fd)g.remove(`maplibregl-${m}-anchor-${b}`);g.add(`maplibregl-${m}-anchor-${o}`)}class sf extends a.E{constructor(o){if(super(),this._onKeyPress=m=>{const g=m.code,b=m.charCode||m.keyCode;g!=="Space"&&g!=="Enter"&&b!==32&&b!==13||this.togglePopup()},this._onMapClick=m=>{const g=m.originalEvent.target,b=this._element;this._popup&&(g===b||b.contains(g))&&this.togglePopup()},this._update=m=>{if(!this._map)return;const g=this._map.loaded()&&!this._map.isMoving();((m==null?void 0:m.type)==="terrain"||(m==null?void 0:m.type)==="render"&&!g)&&this._map.once("render",this._update),this._lngLat=nx(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let b="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?b=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(b=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let P="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?P="rotateX(0deg)":this._pitchAlignment==="map"&&(P=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||m&&m.type!=="moveend"||(this._pos=this._pos.round()),S.setTransform(this._element,`${Fd[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${P} ${b}`),j.frameAsync(new AbortController).then(()=>{this._updateOpacity(m&&m.type==="moveend")}).catch(()=>{})},this._onMove=m=>{if(!this._isDragging){const g=this._clickTolerance||this._map._clickTolerance;this._isDragging=m.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=m.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.l("dragstart"))),this.fire(new a.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.l("dragend")),this._state="inactive"},this._addDragHandler=m=>{this._element.contains(m.originalEvent.target)&&(m.preventDefault(),this._positionDelta=m.point.sub(this._pos).add(this._offset),this._pointerdownPos=m.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._subpixelPositioning=o&&o.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,this.setOpacity(o==null?void 0:o.opacity,o==null?void 0:o.opacityWhenCovered),o&&o.element)this._element=o.element,this._offset=a.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=S.create("div");const m=S.createNS("http://www.w3.org/2000/svg","svg"),g=41,b=27;m.setAttributeNS(null,"display","block"),m.setAttributeNS(null,"height",`${g}px`),m.setAttributeNS(null,"width",`${b}px`),m.setAttributeNS(null,"viewBox",`0 0 ${b} ${g}`);const P=S.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"stroke","none"),P.setAttributeNS(null,"stroke-width","1"),P.setAttributeNS(null,"fill","none"),P.setAttributeNS(null,"fill-rule","evenodd");const E=S.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const z=S.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"transform","translate(3.0, 29.0)"),z.setAttributeNS(null,"fill","#000000");const B=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Se of B){const Te=S.createNS("http://www.w3.org/2000/svg","ellipse");Te.setAttributeNS(null,"opacity","0.04"),Te.setAttributeNS(null,"cx","10.5"),Te.setAttributeNS(null,"cy","5.80029008"),Te.setAttributeNS(null,"rx",Se.rx),Te.setAttributeNS(null,"ry",Se.ry),z.appendChild(Te)}const U=S.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"fill",this._color);const G=S.createNS("http://www.w3.org/2000/svg","path");G.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),U.appendChild(G);const J=S.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"opacity","0.25"),J.setAttributeNS(null,"fill","#000000");const Y=S.createNS("http://www.w3.org/2000/svg","path");Y.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),J.appendChild(Y);const ne=S.createNS("http://www.w3.org/2000/svg","g");ne.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ne.setAttributeNS(null,"fill","#FFFFFF");const fe=S.createNS("http://www.w3.org/2000/svg","g");fe.setAttributeNS(null,"transform","translate(8.0, 8.0)");const je=S.createNS("http://www.w3.org/2000/svg","circle");je.setAttributeNS(null,"fill","#000000"),je.setAttributeNS(null,"opacity","0.25"),je.setAttributeNS(null,"cx","5.5"),je.setAttributeNS(null,"cy","5.5"),je.setAttributeNS(null,"r","5.4999962");const we=S.createNS("http://www.w3.org/2000/svg","circle");we.setAttributeNS(null,"fill","#FFFFFF"),we.setAttributeNS(null,"cx","5.5"),we.setAttributeNS(null,"cy","5.5"),we.setAttributeNS(null,"r","5.4999962"),fe.appendChild(je),fe.appendChild(we),E.appendChild(z),E.appendChild(U),E.appendChild(J),E.appendChild(ne),E.appendChild(fe),m.appendChild(E),m.setAttributeNS(null,"height",g*this._scale+"px"),m.setAttributeNS(null,"width",b*this._scale+"px"),this._element.appendChild(m),this._offset=a.P.convert(o&&o.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",m=>{m.preventDefault()}),this._element.addEventListener("mousedown",m=>{m.preventDefault()}),sx(this._element,this._anchor,"marker"),o&&o.className)for(const m of o.className.split(" "))this._element.classList.add(m);this._popup=null}addTo(o){return this.remove(),this._map=o,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",o._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),o.on("terrain",this._update),o.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),S.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=a.U.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const b=Math.abs(13.5)/Math.SQRT2;o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(38.1-13.5+b)],"bottom-right":[-b,-1*(38.1-13.5+b)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(o){return this._subpixelPositioning=o,this}getPopup(){return this._popup}togglePopup(){const o=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:o?(o.isOpen()?o.remove():(o.setLngLat(this._lngLat),o.addTo(this._map)),this):this}_updateOpacity(o=!1){var m,g;const b=(m=this._map)===null||m===void 0?void 0:m.terrain,P=this._map.transform.isLocationOccluded(this._lngLat);if(!b||P){const ne=P?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==ne&&(this._element.style.opacity=ne))}if(o)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const E=this._map,z=E.terrain.depthAtPoint(this._pos),B=E.terrain.getElevationForLngLatZoom(this._lngLat,E.transform.tileZoom);if(E.transform.lngLatToCameraDepth(this._lngLat,B)-z<.006)return void(this._element.style.opacity=this._opacity);const U=-this._offset.y/E.transform.pixelsPerMeter,G=Math.sin(E.getPitch()*Math.PI/180)*U,J=E.terrain.depthAtPoint(new a.P(this._pos.x,this._pos.y-this._offset.y)),Y=E.transform.lngLatToCameraDepth(this._lngLat,B+G)-J>.006;!((g=this._popup)===null||g===void 0)&&g.isOpen()&&Y&&this._popup.remove(),this._element.style.opacity=Y?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(o){return this._offset=a.P.convert(o),this._update(),this}addClassName(o){this._element.classList.add(o)}removeClassName(o){this._element.classList.remove(o)}toggleClassName(o){return this._element.classList.toggle(o)}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(o,m){return(this._opacity===void 0||o===void 0&&m===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),o!==void 0&&(this._opacity=o),m!==void 0&&(this._opacityWhenCovered=m),this._map&&this._updateOpacity(!0),this}}const Yv={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ah=0,zd=!1;const Xv={maxWidth:100,unit:"metric"};function ix(N,o,m){const g=m&&m.maxWidth||100,b=N._container.clientHeight/2,P=N._container.clientWidth/2,E=N.unproject([P-g/2,b]),z=N.unproject([P+g/2,b]),B=Math.round(N.project(z).x-N.project(E).x),U=Math.min(g,B,N._container.clientWidth),G=E.distanceTo(z);if(m&&m.unit==="imperial"){const J=3.2808*G;J>5280?$d(o,U,J/5280,N._getUIString("ScaleControl.Miles")):$d(o,U,J,N._getUIString("ScaleControl.Feet"))}else m&&m.unit==="nautical"?$d(o,U,G/1852,N._getUIString("ScaleControl.NauticalMiles")):G>=1e3?$d(o,U,G/1e3,N._getUIString("ScaleControl.Kilometers")):$d(o,U,G,N._getUIString("ScaleControl.Meters"))}function $d(N,o,m,g){const b=function(P){const E=Math.pow(10,`${Math.floor(P)}`.length-1);let z=P/E;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:z>=1?1:function(B){const U=Math.pow(10,Math.ceil(-Math.log(B)/Math.LN10));return Math.round(B*U)/U}(z),E*z}(m);N.style.width=o*(b/m)+"px",N.innerHTML=`${b}&nbsp;${g}`}const Qv={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},ax=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ox(N){if(N){if(typeof N=="number"){const o=Math.round(Math.abs(N)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,N),"top-left":new a.P(o,o),"top-right":new a.P(-o,o),bottom:new a.P(0,-N),"bottom-left":new a.P(o,-o),"bottom-right":new a.P(-o,-o),left:new a.P(N,0),right:new a.P(-N,0)}}if(N instanceof a.P||Array.isArray(N)){const o=a.P.convert(N);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:a.P.convert(N.center||[0,0]),top:a.P.convert(N.top||[0,0]),"top-left":a.P.convert(N["top-left"]||[0,0]),"top-right":a.P.convert(N["top-right"]||[0,0]),bottom:a.P.convert(N.bottom||[0,0]),"bottom-left":a.P.convert(N["bottom-left"]||[0,0]),"bottom-right":a.P.convert(N["bottom-right"]||[0,0]),left:a.P.convert(N.left||[0,0]),right:a.P.convert(N.right||[0,0])}}return ox(new a.P(0,0))}const Jv=f;d.AJAXError=a.cC,d.Event=a.l,d.Evented=a.E,d.LngLat=a.U,d.MercatorCoordinate=a.a5,d.Point=a.P,d.addProtocol=a.cD,d.config=a.a,d.removeProtocol=a.cE,d.AttributionControl=oa,d.BoxZoomHandler=Jj,d.CanvasSource=sr,d.CooperativeGesturesHandler=zo,d.DoubleClickZoomHandler=tf,d.DragPanHandler=Gv,d.DragRotateHandler=Kv,d.EdgeInsets=Qs,d.FullscreenControl=class extends a.E{constructor(N={}){super(),this._onFullscreenChange=()=>{var o;let m=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((o=m==null?void 0:m.shadowRoot)===null||o===void 0)&&o.fullscreenElement;)m=m.shadowRoot.fullscreenElement;m===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,N&&N.container&&(N.container instanceof HTMLElement?this._container=N.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(N){return this._map=N,this._container||(this._container=this._map.getContainer()),this._controlContainer=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){S.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const N=this._fullscreenButton=S.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);S.create("span","maplibregl-ctrl-icon",N).setAttribute("aria-hidden","true"),N.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const N=this._getTitle();this._fullscreenButton.setAttribute("aria-label",N),this._fullscreenButton.title=N}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new a.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},d.GeoJSONSource=Ut,d.GeolocateControl=class extends a.E{constructor(N){super(),this._onSuccess=o=>{if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new a.l("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.l("geolocate",o)),this._finish()}},this._updateCamera=o=>{const m=new a.U(o.coords.longitude,o.coords.latitude),g=o.coords.accuracy,b=this._map.getBearing(),P=a.e({bearing:b},this.options.fitBoundsOptions),E=Lr.fromLngLat(m,g);this._map.fitBounds(E,P,{geolocateSource:!0})},this._updateMarker=o=>{if(o){const m=new a.U(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(m).addTo(this._map),this._userLocationDotMarker.setLngLat(m).addTo(this._map),this._accuracy=o.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=o=>{if(this._map){if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&zd)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.l("error",o)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=S.create("button","maplibregl-ctrl-geolocate",this._container),S.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=o=>{if(this._map){if(o===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}else{const m=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=S.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new sf({element:this._dotElement}),this._circleElement=S.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new sf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",m=>{const g=(m==null?void 0:m[0])instanceof ResizeObserverEntry;m.geolocateSource||this._watchState!=="ACTIVE_LOCK"||g||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.l("trackuserlocationend")),this.fire(new a.l("userlocationlostfocus")))})}},this.options=a.e({},Yv,N)}onAdd(N){return this._map=N,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return a._(this,arguments,void 0,function*(o=!1){if(Ql!==void 0&&!o)return Ql;if(window.navigator.permissions===void 0)return Ql=!!window.navigator.geolocation,Ql;try{Ql=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Ql=!!window.navigator.geolocation}return Ql})}().then(o=>this._finishSetupUI(o)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),S.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,ah=0,zd=!1}_isOutOfMapMaxBounds(N){const o=this._map.getMaxBounds(),m=N.coords;return o&&(m.longitude<o.getWest()||m.longitude>o.getEast()||m.latitude<o.getSouth()||m.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const N=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&N))return;const o=this._map.project(N),m=this._map.unproject([o.x+100,o.y]),g=N.distanceTo(m)/100,b=2*this._accuracy/g;this._circleElement.style.width=`${b.toFixed(2)}px`,this._circleElement.style.height=`${b.toFixed(2)}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ah--,zd=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.l("trackuserlocationstart")),this.fire(new a.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let N;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ah++,ah>1?(N={maximumAge:6e5,timeout:0},zd=!0):(N=this.options.positionOptions,zd=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,N)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},d.GlobeControl=class{constructor(){this._toggleProjection=()=>{var N;const o=(N=this._map.getProjection())===null||N===void 0?void 0:N.type;this._map.setProjection(o!=="mercator"&&o?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var N;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((N=this._map.getProjection())===null||N===void 0?void 0:N.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(N){return this._map=N,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=S.create("button","maplibregl-ctrl-globe",this._container),S.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){S.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},d.Hash=Fv,d.ImageSource=Vt,d.KeyboardHandler=ow,d.LngLatBounds=Lr,d.LogoControl=Hv,d.Map=class extends uw{constructor(N){var o,m;a.cz.mark(a.cA.create);const g=Object.assign(Object.assign(Object.assign({},ih),N),{canvasContextAttributes:Object.assign(Object.assign({},ih.canvasContextAttributes),N.canvasContextAttributes)});if(g.minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const b=new fl,P=new Pd;if(g.minZoom!==void 0&&b.setMinZoom(g.minZoom),g.maxZoom!==void 0&&b.setMaxZoom(g.maxZoom),g.minPitch!==void 0&&b.setMinPitch(g.minPitch),g.maxPitch!==void 0&&b.setMaxPitch(g.maxPitch),g.renderWorldCopies!==void 0&&b.setRenderWorldCopies(g.renderWorldCopies),g.transformConstrain!==null&&b.setConstrain(g.transformConstrain),super(b,P,{bearingSnap:g.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new $o,this._controls=[],this._mapId=a.ab(),this._contextLost=z=>{z.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new a.l("webglcontextlost",{originalEvent:z}))},this._contextRestored=z=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.l("webglcontextrestored",{originalEvent:z}))},this._onMapScroll=z=>{if(z.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=g.interactive,this._maxTileCacheSize=g.maxTileCacheSize,this._maxTileCacheZoomLevels=g.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},g.canvasContextAttributes),this._trackResize=g.trackResize===!0,this._bearingSnap=g.bearingSnap,this._centerClampedToGround=g.centerClampedToGround,this._refreshExpiredTiles=g.refreshExpiredTiles===!0,this._fadeDuration=g.fadeDuration,this._crossSourceCollisions=g.crossSourceCollisions===!0,this._collectResourceTiming=g.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},qs),g.locale),this._clickTolerance=g.clickTolerance,this._overridePixelRatio=g.pixelRatio,this._maxCanvasSize=g.maxCanvasSize,this.transformCameraUpdate=g.transformCameraUpdate,this.transformConstrain=g.transformConstrain,this.cancelPendingTileRequestsWhileZooming=g.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=W.addThrottleControl(()=>this.isMoving()),this._requestManager=new Z(g.transformRequest),typeof g.container=="string"){if(this._container=document.getElementById(g.container),!this._container)throw new Error(`Container '${g.container}' not found.`)}else{if(!(g.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(g.maxBounds&&this.setMaxBounds(g.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let z=!1;const B=Lv(U=>{this._trackResize&&!this._removed&&(this.resize(U),this.redraw())},50);this._resizeObserver=new ResizeObserver(U=>{z?B(U):z=!0}),this._resizeObserver.observe(this._container)}this.handlers=new rf(this,g),this._hash=g.hash&&new Fv(typeof g.hash=="string"&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,elevation:g.elevation,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch,roll:g.roll}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,a.e({},g.fitBoundsOptions,{duration:0}))));const E=typeof g.style=="string"||((m=(o=g.style)===null||o===void 0?void 0:o.projection)===null||m===void 0?void 0:m.type)!=="globe";this.resize(null,E),this._localIdeographFontFamily=g.localIdeographFontFamily,this._validateStyle=g.validateStyle,g.style&&this.setStyle(g.style,{localIdeographFontFamily:g.localIdeographFontFamily}),g.attributionControl&&this.addControl(new oa(typeof g.attributionControl=="boolean"?void 0:g.attributionControl)),g.maplibreLogo&&this.addControl(new Hv,g.logoPosition),this.on("style.load",()=>{if(E||this._resizeTransform(),this.transform.unmodified){const z=a.S(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(z)}}),this.on("data",z=>{this._update(z.dataType==="style"),this.fire(new a.l(`${z.dataType}data`,z))}),this.on("dataloading",z=>{this.fire(new a.l(`${z.dataType}dataloading`,z))}),this.on("dataabort",z=>{this.fire(new a.l("sourcedataabort",z))})}_getMapId(){return this._mapId}setGlobalStateProperty(N,o){return this.style.setGlobalStateProperty(N,o),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(N,o){if(o===void 0&&(o=N.getDefaultPosition?N.getDefaultPosition():"top-right"),!N||!N.onAdd)return this.fire(new a.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const m=N.onAdd(this);this._controls.push(N);const g=this._controlPositions[o];return o.indexOf("bottom")!==-1?g.insertBefore(m,g.firstChild):g.appendChild(m),this}removeControl(N){if(!N||!N.onRemove)return this.fire(new a.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(N);return o>-1&&this._controls.splice(o,1),N.onRemove(this),this}hasControl(N){return this._controls.indexOf(N)>-1}coveringTiles(N){return Cn(this.transform,N)}calculateCameraOptionsFromTo(N,o,m,g){return g==null&&this.terrain&&(g=this.terrain.getElevationForLngLatZoom(m,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(N,o,m,g)}resize(N,o=!0){const[m,g]=this._containerDimensions(),b=this._getClampedPixelRatio(m,g);if(this._resizeCanvas(m,g,b),this.painter.resize(m,g,b),this.painter.overLimit()){const E=this.painter.context.gl;this._maxCanvasSize=[E.drawingBufferWidth,E.drawingBufferHeight];const z=this._getClampedPixelRatio(m,g);this._resizeCanvas(m,g,z),this.painter.resize(m,g,z)}this._resizeTransform(o);const P=!this._moving;return P&&(this.stop(),this.fire(new a.l("movestart",N)).fire(new a.l("move",N))),this.fire(new a.l("resize",N)),P&&this.fire(new a.l("moveend",N)),this}_resizeTransform(N=!0){var o;const[m,g]=this._containerDimensions();this.transform.resize(m,g,N),(o=this._requestedCameraState)===null||o===void 0||o.resize(m,g,N)}_getClampedPixelRatio(N,o){const{0:m,1:g}=this._maxCanvasSize,b=this.getPixelRatio(),P=N*b,E=o*b;return Math.min(P>m?m/P:1,E>g?g/E:1)*b}getPixelRatio(){var N;return(N=this._overridePixelRatio)!==null&&N!==void 0?N:devicePixelRatio}setPixelRatio(N){this._overridePixelRatio=N,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(N){return this.transform.setMaxBounds(Lr.convert(N)),this._update()}setMinZoom(N){if((N=N??-2)>=-2&&N<=this.transform.maxZoom)return this.transform.setMinZoom(N),this._update(),this.getZoom()<N&&this.setZoom(N),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(N){if((N=N??22)>=this.transform.minZoom)return this.transform.setMaxZoom(N),this._update(),this.getZoom()>N&&this.setZoom(N),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(N){if((N=N??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(N>=0&&N<=this.transform.maxPitch)return this.transform.setMinPitch(N),this._update(),this.getPitch()<N&&this.setPitch(N),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(N){if((N=N??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(N>=this.transform.minPitch)return this.transform.setMaxPitch(N),this._update(),this.getPitch()>N&&this.setPitch(N),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(N){return this.transform.setRenderWorldCopies(N),this._update()}setTransformConstrain(N){return this.transform.setConstrain(N),this._update()}project(N){return this.transform.locationToScreenPoint(a.U.convert(N),this.style&&this.terrain)}unproject(N){return this.transform.screenPointToLocation(a.P.convert(N),this.terrain)}isMoving(){var N;return this._moving||((N=this.handlers)===null||N===void 0?void 0:N.isMoving())}isZooming(){var N;return this._zooming||((N=this.handlers)===null||N===void 0?void 0:N.isZooming())}isRotating(){var N;return this._rotating||((N=this.handlers)===null||N===void 0?void 0:N.isRotating())}_createDelegatedListener(N,o,m){if(N==="mouseenter"||N==="mouseover"){let g=!1;return{layers:o,listener:m,delegates:{mousemove:P=>{const E=o.filter(B=>this.getLayer(B)),z=E.length!==0?this.queryRenderedFeatures(P.point,{layers:E}):[];z.length?g||(g=!0,m.call(this,new La(N,this,P.originalEvent,{features:z}))):g=!1},mouseout:()=>{g=!1}}}}if(N==="mouseleave"||N==="mouseout"){let g=!1;return{layers:o,listener:m,delegates:{mousemove:E=>{const z=o.filter(B=>this.getLayer(B));(z.length!==0?this.queryRenderedFeatures(E.point,{layers:z}):[]).length?g=!0:g&&(g=!1,m.call(this,new La(N,this,E.originalEvent)))},mouseout:E=>{g&&(g=!1,m.call(this,new La(N,this,E.originalEvent)))}}}}{const g=b=>{const P=o.filter(z=>this.getLayer(z)),E=P.length!==0?this.queryRenderedFeatures(b.point,{layers:P}):[];E.length&&(b.features=E,m.call(this,b),delete b.features)};return{layers:o,listener:m,delegates:{[N]:g}}}}_saveDelegatedListener(N,o){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[N]=this._delegatedListeners[N]||[],this._delegatedListeners[N].push(o)}_removeDelegatedListener(N,o,m){if(!this._delegatedListeners||!this._delegatedListeners[N])return;const g=this._delegatedListeners[N];for(let b=0;b<g.length;b++){const P=g[b];if(P.listener===m&&P.layers.length===o.length&&P.layers.every(E=>o.includes(E))){for(const E in P.delegates)this.off(E,P.delegates[E]);return void g.splice(b,1)}}}on(N,o,m){if(m===void 0)return super.on(N,o);const g=typeof o=="string"?[o]:o,b=this._createDelegatedListener(N,g,m);this._saveDelegatedListener(N,b);for(const P in b.delegates)this.on(P,b.delegates[P]);return{unsubscribe:()=>{this._removeDelegatedListener(N,g,m)}}}once(N,o,m){if(m===void 0)return super.once(N,o);const g=typeof o=="string"?[o]:o,b=this._createDelegatedListener(N,g,m);for(const P in b.delegates){const E=b.delegates[P];b.delegates[P]=(...z)=>{this._removeDelegatedListener(N,g,m),E(...z)}}this._saveDelegatedListener(N,b);for(const P in b.delegates)this.once(P,b.delegates[P]);return this}off(N,o,m){return m===void 0?super.off(N,o):(this._removeDelegatedListener(N,typeof o=="string"?[o]:o,m),this)}queryRenderedFeatures(N,o){if(!this.style)return[];let m;const g=N instanceof a.P||Array.isArray(N),b=g?N:[[0,0],[this.transform.width,this.transform.height]];if(o=o||(g?{}:N)||{},b instanceof a.P||typeof b[0]=="number")m=[a.P.convert(b)];else{const P=a.P.convert(b[0]),E=a.P.convert(b[1]);m=[P,new a.P(E.x,P.y),E,new a.P(P.x,E.y),P]}return this.style.queryRenderedFeatures(m,o,this.transform)}querySourceFeatures(N,o){return this.style.querySourceFeatures(N,o)}setStyle(N,o){return(o=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&N?(this._diffStyle(N,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(N,o))}setTransformRequest(N){return this._requestManager.setTransformRequest(N),this}_getUIString(N){const o=this._locale[N];if(o==null)throw new Error(`Missing UI string '${N}'`);return o}_updateStyle(N,o){var m,g;if(o.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(N,o));const b=this.style&&o.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!N)),N?(this.style=new qm(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof N=="string"?this.style.loadURL(N,o,b):this.style.loadJSON(N,o,b),this):((g=(m=this.style)===null||m===void 0?void 0:m.projection)===null||g===void 0||g.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new qm(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(N,o){if(typeof N=="string"){const m=this._requestManager.transformRequest(N,"Style");a.j(m,new AbortController).then(g=>{this._updateDiff(g.data,o)}).catch(g=>{g&&this.fire(new a.k(g))})}else typeof N=="object"&&this._updateDiff(N,o)}_updateDiff(N,o){try{this.style.setState(N,o)&&this._update(!0)}catch(m){a.w(`Unable to perform style diff: ${m.message||m.error||m}.  Rebuilding the style from scratch.`),this._updateStyle(N,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(N,o){return this._lazyInitEmptyStyle(),this.style.addSource(N,o),this._update(!0)}isSourceLoaded(N){const o=this.style&&this.style.tileManagers[N];if(o!==void 0)return o.loaded();this.fire(new a.k(new Error(`There is no tile manager with ID '${N}'`)))}setTerrain(N){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),N){const o=this.style.tileManagers[N.source];if(!o)throw new Error(`cannot load terrain, because there exists no source with ID: ${N.source}`);this.terrain===null&&o.reload();for(const m in this.style._layers){const g=this.style._layers[m];g.type==="hillshade"&&g.source===N.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),g.type==="color-relief"&&g.source===N.source&&a.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new cC(this.painter,o,N),this.painter.renderToTexture=new vs(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=m=>{var g;m.dataType==="style"?this.terrain.tileManager.freeRtt():m.dataType==="source"&&m.tile&&(m.sourceId!==N.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((g=m.source)===null||g===void 0?void 0:g.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(m.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new a.l("terrain",{terrain:N})),this}getTerrain(){var N,o;return(o=(N=this.terrain)===null||N===void 0?void 0:N.options)!==null&&o!==void 0?o:null}areTilesLoaded(){const N=this.style&&this.style.tileManagers;for(const o in N){const m=N[o]._tiles;for(const g in m){const b=m[g];if(b.state!=="loaded"&&b.state!=="errored")return!1}}return!0}removeSource(N){return this.style.removeSource(N),this._update(!0)}getSource(N){return this.style.getSource(N)}setSourceTileLodParams(N,o,m){if(m){const g=this.getSource(m);if(!g)throw new Error(`There is no source with ID "${m}", cannot set LOD parameters`);g.calculateTileZoom=Gt(Math.max(1,N),Math.max(1,o))}else for(const g in this.style.tileManagers)this.style.tileManagers[g].getSource().calculateTileZoom=Gt(Math.max(1,N),Math.max(1,o));return this._update(!0),this}refreshTiles(N,o){const m=this.style.tileManagers[N];if(!m)throw new Error(`There is no tile manager with ID "${N}", cannot refresh tile`);o===void 0?m.reload(!0):m.refreshTiles(o.map(g=>new a.a8(g.z,g.x,g.y)))}addImage(N,o,m={}){const{pixelRatio:g=1,sdf:b=!1,stretchX:P,stretchY:E,content:z,textFitWidth:B,textFitHeight:U}=m;if(this._lazyInitEmptyStyle(),!(o instanceof HTMLImageElement||a.b(o))){if(o.width===void 0||o.height===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:G,height:J,data:Y}=o,ne=o;return this.style.addImage(N,{data:new a.R({width:G,height:J},new Uint8Array(Y)),pixelRatio:g,stretchX:P,stretchY:E,content:z,textFitWidth:B,textFitHeight:U,sdf:b,version:0,userImage:ne}),ne.onAdd&&ne.onAdd(this,N),this}}{const{width:G,height:J,data:Y}=j.getImageData(o);this.style.addImage(N,{data:new a.R({width:G,height:J},Y),pixelRatio:g,stretchX:P,stretchY:E,content:z,textFitWidth:B,textFitHeight:U,sdf:b,version:0})}}updateImage(N,o){const m=this.style.getImage(N);if(!m)return this.fire(new a.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=o instanceof HTMLImageElement||a.b(o)?j.getImageData(o):o,{width:b,height:P,data:E}=g;if(b===void 0||P===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(b!==m.data.width||P!==m.data.height)return this.fire(new a.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const z=!(o instanceof HTMLImageElement||a.b(o));return m.data.replace(E,z),this.style.updateImage(N,m),this}getImage(N){return this.style.getImage(N)}hasImage(N){return N?!!this.style.getImage(N):(this.fire(new a.k(new Error("Missing required image id"))),!1)}removeImage(N){this.style.removeImage(N)}loadImage(N){return W.getImage(this._requestManager.transformRequest(N,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(N,o){return this._lazyInitEmptyStyle(),this.style.addLayer(N,o),this._update(!0)}moveLayer(N,o){return this.style.moveLayer(N,o),this._update(!0)}removeLayer(N){return this.style.removeLayer(N),this._update(!0)}getLayer(N){return this.style.getLayer(N)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(N,o,m){return this.style.setLayerZoomRange(N,o,m),this._update(!0)}setFilter(N,o,m={}){return this.style.setFilter(N,o,m),this._update(!0)}getFilter(N){return this.style.getFilter(N)}setPaintProperty(N,o,m,g={}){return this.style.setPaintProperty(N,o,m,g),this._update(!0)}getPaintProperty(N,o){return this.style.getPaintProperty(N,o)}setLayoutProperty(N,o,m,g={}){return this.style.setLayoutProperty(N,o,m,g),this._update(!0)}getLayoutProperty(N,o){return this.style.getLayoutProperty(N,o)}setGlyphs(N,o={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(N,o),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(N,o,m={}){return this._lazyInitEmptyStyle(),this.style.addSprite(N,o,m,g=>{g||this._update(!0)}),this}removeSprite(N){return this._lazyInitEmptyStyle(),this.style.removeSprite(N),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(N,o={}){return this._lazyInitEmptyStyle(),this.style.setSprite(N,o,m=>{m||this._update(!0)}),this}setLight(N,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(N,o),this._update(!0)}getLight(){return this.style.getLight()}setSky(N,o={}){return this._lazyInitEmptyStyle(),this.style.setSky(N,o),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(N,o){return this.style.setFeatureState(N,o),this._update()}removeFeatureState(N,o){return this.style.removeFeatureState(N,o),this._update()}getFeatureState(N){return this.style.getFeatureState(N)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let N=0,o=0;return this._container&&(N=this._container.clientWidth||400,o=this._container.clientHeight||300),[N,o]}_setupContainer(){const N=this._container;N.classList.add("maplibregl-map");const o=this._canvasContainer=S.create("div","maplibregl-canvas-container",N);this._interactive&&o.classList.add("maplibregl-interactive"),this._canvas=S.create("canvas","maplibregl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const m=this._containerDimensions(),g=this._getClampedPixelRatio(m[0],m[1]);this._resizeCanvas(m[0],m[1],g);const b=this._controlContainer=S.create("div","maplibregl-control-container",N),P=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{P[E]=S.create("div",`maplibregl-ctrl-${E} `,b)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(N,o,m){this._canvas.width=Math.floor(m*N),this._canvas.height=Math.floor(m*o),this._canvas.style.width=`${N}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const N=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let o=null;this._canvas.addEventListener("webglcontextcreationerror",g=>{o={requestedAttributes:N},g&&(o.statusMessage=g.statusMessage,o.type=g.type)},{once:!0});let m=null;if(m=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,N):this._canvas.getContext("webgl2",N)||this._canvas.getContext("webgl",N),!m){const g="Failed to initialize WebGL";throw o?(o.message=g,new Error(JSON.stringify(o))):new Error(g)}this.painter=new Gj(m,this.transform),R.testSupport(m)}migrateProjection(N,o){super.migrateProjection(N,o),this.painter.transform=N,this.fire(new a.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(N){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||N,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(N){return this._update(),this._renderTaskQueue.add(N)}_cancelRenderFrame(N){this._renderTaskQueue.remove(N)}_render(N){var o,m,g,b,P;const E=this._idleTriggered?this._fadeDuration:0,z=((o=this.style.projection)===null||o===void 0?void 0:o.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(N),this._removed)return;let B=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const J=this.transform.zoom,Y=k();this.style.zoomHistory.update(J,Y);const ne=new a.G(J,{now:Y,fadeDuration:E,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),fe=ne.crossFadingFactor();fe===1&&fe===this._crossFadingFactor||(B=!0,this._crossFadingFactor=fe),this.style.update(ne)}const U=((m=this.style.projection)===null||m===void 0?void 0:m.transitionState)>0!==z;(g=this.style.projection)===null||g===void 0||g.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((b=this.style.projection)===null||b===void 0?void 0:b.transitionState,(P=this.style.projection)===null||P===void 0?void 0:P.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||U)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,E,this._crossSourceCollisions,U),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,showPadding:this.showPadding}),this.fire(new a.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.cz.mark(a.cA.load),this.fire(new a.l("load"))),this.style&&(this.style.hasTransitions()||B)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const G=this._sourcesDirty||this._styleDirty||this._placementDirty;return G||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.l("idle")),!this._loaded||this._fullyLoaded||G||(this._fullyLoaded=!0,a.cz.mark(a.cA.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var N;this._hash&&this._hash.remove();for(const m of this._controls)m.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),W.removeThrottleControl(this._imageQueueHandle),(N=this._resizeObserver)===null||N===void 0||N.disconnect();const o=this.painter.context.gl.getExtension("WEBGL_lose_context");o!=null&&o.loseContext&&o.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),S.remove(this._canvasContainer),S.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),a.cz.clearMetrics(),this._removed=!0,this.fire(new a.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,j.frame(this._frameRequest,N=>{a.cz.frame(N),this._frameRequest=null;try{this._render(N)}catch(o){if(!a.cB(o)&&!function(m){return m.message===Fj}(o))throw o}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(N){this._showTileBoundaries!==N&&(this._showTileBoundaries=N,this._update())}get showPadding(){return!!this._showPadding}set showPadding(N){this._showPadding!==N&&(this._showPadding=N,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(N){this._showCollisionBoxes!==N&&(this._showCollisionBoxes=N,N?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(N){this._showOverdrawInspector!==N&&(this._showOverdrawInspector=N,this._update())}get repaint(){return!!this._repaint}set repaint(N){this._repaint!==N&&(this._repaint=N,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(N){this._vertices=N,this._update()}get version(){return mw}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(N){return this._lazyInitEmptyStyle(),this.style.setProjection(N),this._update(!0)}},d.MapMouseEvent=La,d.MapTouchEvent=ba,d.MapWheelEvent=Qj,d.Marker=sf,d.NavigationControl=class{constructor(N){this._updateZoomButtons=()=>{const o=this._map.getZoom(),m=o===this._map.getMaxZoom(),g=o===this._map.getMinZoom();this._zoomInButton.disabled=m,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",m.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(o,m)=>{const g=this._map._getUIString(`NavigationControl.${m}`);o.title=g,o.setAttribute("aria-label",g)},this.options=a.e({},rx,N),this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),S.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),S.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=S.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(N){return this._map=N,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Zv(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){S.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(N,o){const m=S.create("button",N,this._container);return m.type="button",m.addEventListener("click",o),m}},d.Popup=class extends a.E{constructor(N){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&S.remove(this._content),this._container&&(S.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new a.l("close"))),this),this._onMouseUp=o=>{this._update(o.point)},this._onMouseMove=o=>{this._update(o.point)},this._onDrag=o=>{this._update(o.point)},this._update=o=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=S.create("div","maplibregl-popup",this._map.getContainer()),this._tip=S.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const E of this.options.className.split(" "))this._container.classList.add(E);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=nx(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!o)return;const m=this._flatPos=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&o?o:this._map.transform.locationToScreenPoint(this._lngLat));let g=this.options.anchor;const b=ox(this.options.offset);if(!g){const E=this._container.offsetWidth,z=this._container.offsetHeight;let B;B=m.y+b.bottom.y<z?["top"]:m.y>this._map.transform.height-z?["bottom"]:[],m.x<E/2?B.push("left"):m.x>this._map.transform.width-E/2&&B.push("right"),g=B.length===0?"bottom":B.join("-")}let P=m.add(b[g]);this.options.subpixelPositioning||(P=P.round()),S.setTransform(this._container,`${Fd[g]} translate(${P.x}px,${P.y}px)`),sx(this._container,g,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(Qv),N)}addTo(N){return this._map&&this.remove(),this._map=N,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(N){return this._lngLat=a.U.convert(N),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(N){return this.setDOMContent(document.createTextNode(N))}setHTML(N){const o=document.createDocumentFragment(),m=document.createElement("body");let g;for(m.innerHTML=N;g=m.firstChild,g;)o.appendChild(g);return this.setDOMContent(o)}getMaxWidth(){var N;return(N=this._container)===null||N===void 0?void 0:N.style.maxWidth}setMaxWidth(N){return this.options.maxWidth=N,this._update(),this}setDOMContent(N){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=S.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(N),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(N){return this._container&&this._container.classList.add(N),this}removeClassName(N){return this._container&&this._container.classList.remove(N),this}setOffset(N){return this.options.offset=N,this._update(),this}toggleClassName(N){if(this._container)return this._container.classList.toggle(N)}setSubpixelPositioning(N){this.options.subpixelPositioning=N}_createCloseButton(){this.options.closeButton&&(this._closeButton=S.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const N=this._container.querySelector(ax);N&&N.focus()}},d.RasterDEMTileSource=qe,d.RasterTileSource=Yn,d.ScaleControl=class{constructor(N){this._onMove=()=>{ix(this._map,this._container,this.options)},this.setUnit=o=>{this.options.unit=o,ix(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Xv),N)}getDefaultPosition(){return"bottom-left"}onAdd(N){return this._map=N,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-scale",N.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){S.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},d.ScrollZoomHandler=lw,d.Style=qm,d.TerrainControl=class{constructor(N){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=N}onAdd(N){return this._map=N,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=S.create("button","maplibregl-ctrl-terrain",this._container),S.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){S.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},d.TwoFingersTouchPitchHandler=iw,d.TwoFingersTouchRotateHandler=ex,d.TwoFingersTouchZoomHandler=sw,d.TwoFingersTouchZoomRotateHandler=dw,d.VectorTileSource=ks,d.VideoSource=Ft,d.addSourceType=(N,o)=>a._(void 0,void 0,void 0,function*(){if(Pn(N))throw new Error(`A source type called "${N}" already exists.`);((m,g)=>{tn[m]=g})(N,o)}),d.clearPrewarmedResources=function(){const N=Pr;N&&(N.isPreloaded()&&N.numActive()===1?(N.release(Et),Pr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},d.createTileMesh=Rm,d.getMaxParallelImageRequests=function(){return a.a.MAX_PARALLEL_IMAGE_REQUESTS},d.getRTLTextPluginStatus=function(){return ue().getRTLTextPluginStatus()},d.getVersion=function(){return Jv},d.getWorkerCount=function(){return tr.workerCount},d.getWorkerUrl=function(){return a.a.WORKER_URL},d.importScriptInWorkers=function(N){return Qt().broadcast("IS",N)},d.isTimeFrozen=function(){return w.isFrozen()},d.now=k,d.prewarm=function(){_r().acquire(Et)},d.restoreNow=function(){w.restoreNow()},d.setMaxParallelImageRequests=function(N){a.a.MAX_PARALLEL_IMAGE_REQUESTS=N},d.setNow=function(N){w.setNow(N)},d.setRTLTextPlugin=function(N,o){return ue().setRTLTextPlugin(N,o)},d.setWorkerCount=function(N){tr.workerCount=N},d.setWorkerUrl=function(N){a.a.WORKER_URL=N}});var l=n;return l})})(qW);var UW=qW.exports;const Pl=Vn(UW),Rue=xB({__proto__:null,default:Pl},[UW]),E0={active:"#22c55e",inactive:"#9ca3af",retired:"#ef4444",under_maintenance:"#eab308"};function Lue(){var l;const e=O.useRef(null),r=O.useRef(null),[n,s]=O.useState(null),{data:i}=ct({queryKey:["assets-with-geom"],queryFn:()=>jc.getAssets({per_page:1e3})});return O.useEffect(()=>{if(!(!e.current||r.current))return r.current=new Pl.Map({container:e.current,style:{version:8,sources:{"osm-tiles":{type:"raster",tiles:["https://tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:"&copy; OpenStreetMap contributors"}},layers:[{id:"osm-tiles",type:"raster",source:"osm-tiles",minzoom:0,maxzoom:19}]},center:[0,0],zoom:2}),r.current.addControl(new Pl.NavigationControl,"top-right"),r.current.addControl(new Pl.ScaleControl,"bottom-left"),()=>{var d;(d=r.current)==null||d.remove(),r.current=null}},[]),O.useEffect(()=>{if(!r.current||!(i!=null&&i.data))return;const d=i.data.filter(a=>a.geom);if(d.length!==0&&(d.forEach(a=>{if(!a.geom)return;const f=document.createElement("div");f.className="asset-marker",f.style.width="24px",f.style.height="24px",f.style.borderRadius="50%",f.style.backgroundColor=E0[a.status],f.style.border="2px solid white",f.style.boxShadow="0 2px 4px rgba(0,0,0,0.2)",f.style.cursor="pointer",new Pl.Marker({element:f}).setLngLat(a.geom.coordinates).addTo(r.current),f.addEventListener("click",()=>{var p;s(a),(p=r.current)==null||p.flyTo({center:a.geom.coordinates,zoom:14,duration:1e3})})}),d.length>0)){const a=new Pl.LngLatBounds;d.forEach(f=>{f.geom&&a.extend(f.geom.coordinates)}),r.current.fitBounds(a,{padding:50})}},[i]),t.jsxs("div",{className:"relative h-[calc(100vh-8rem)]",children:[t.jsx("div",{className:"absolute top-4 left-4 z-10 space-y-2",children:t.jsx(H,{children:t.jsxs(Q,{className:"p-4",children:[t.jsx("h2",{className:"text-lg font-bold mb-2",children:"Assets Map"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:E0.active}}),t.jsx("span",{className:"text-sm",children:"Active"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:E0.inactive}}),t.jsx("span",{className:"text-sm",children:"Inactive"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:E0.under_maintenance}}),t.jsx("span",{className:"text-sm",children:"Under Maintenance"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:E0.retired}}),t.jsx("span",{className:"text-sm",children:"Retired"})]})]}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-3",children:[(i==null?void 0:i.data.filter(d=>d.geom).length)||0," assets with location data"]})]})})}),n&&t.jsx("div",{className:"absolute top-4 right-4 z-10 w-80",children:t.jsx(H,{children:t.jsxs(Q,{className:"p-4",children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold",children:n.name}),t.jsx("p",{className:"text-sm text-muted-foreground",children:n.code})]}),t.jsx(X,{variant:"ghost",size:"sm",onClick:()=>s(null),children:t.jsx(bm,{className:"h-4 w-4"})})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"Status"}),t.jsx(Ee,{className:`bg-${n.status==="active"?"green":n.status==="retired"?"red":"gray"}-100 text-${n.status==="active"?"green":n.status==="retired"?"red":"gray"}-800`,children:n.status.replace("_"," ")})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"Asset Class"}),t.jsx("p",{className:"text-sm font-medium",children:((l=n.asset_class)==null?void 0:l.name)||"Unknown"})]}),n.manufacturer&&t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"Manufacturer"}),t.jsx("p",{className:"text-sm",children:n.manufacturer})]}),n.model&&t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"Model"}),t.jsx("p",{className:"text-sm",children:n.model})]}),n.geom&&t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"Location"}),t.jsxs("p",{className:"text-sm flex items-center gap-1",children:[t.jsx(Ma,{className:"h-3 w-3"}),n.geom.coordinates[1].toFixed(6),", ",n.geom.coordinates[0].toFixed(6)]})]}),t.jsx(X,{className:"w-full mt-3",size:"sm",asChild:!0,children:t.jsx("a",{href:`/cmms/assets/${n.id}`,children:"View Details"})})]})]})})}),t.jsx("div",{ref:e,className:"w-full h-full"})]})}const jr="/cmms",M0={getJobPlans:e=>{const r={};return e!=null&&e.search&&(r.search=e.search),e!=null&&e.status&&(r.status=e.status),e!=null&&e.page&&(r.page=e.page.toString()),e!=null&&e.per_page&&(r.per_page=e.per_page.toString()),xe.get(`${jr}/job-plans`,r)},getJobPlan:e=>xe.get(`${jr}/job-plans/${e}`),createJobPlan:e=>xe.post(`${jr}/job-plans`,e),updateJobPlan:(e,r)=>xe.put(`${jr}/job-plans/${e}`,r),deleteJobPlan:e=>xe.delete(`${jr}/job-plans/${e}`),createVersion:e=>xe.post(`${jr}/job-plans/${e}/version`),activate:e=>xe.post(`${jr}/job-plans/${e}/activate`)},c1={getTemplates:e=>{const r={};return e!=null&&e.asset_class_id&&(r.asset_class_id=e.asset_class_id.toString()),(e==null?void 0:e.is_active)!==void 0&&(r.is_active=e.is_active.toString()),e!=null&&e.page&&(r.page=e.page.toString()),e!=null&&e.per_page&&(r.per_page=e.per_page.toString()),xe.get(`${jr}/pm/templates`,r)},getTemplate:e=>xe.get(`${jr}/pm/templates/${e}`),createTemplate:e=>xe.post(`${jr}/pm/templates`,e),updateTemplate:(e,r)=>xe.put(`${jr}/pm/templates/${e}`,r),deleteTemplate:e=>xe.delete(`${jr}/pm/templates/${e}`),generateWorkOrders:e=>xe.post(`${jr}/pm/generate`,e),deferPm:(e,r)=>xe.post(`${jr}/pm/logs/${e}/defer`,r),getCompliance:e=>{const r={};return e!=null&&e.period_start&&(r.period_start=e.period_start),e!=null&&e.period_end&&(r.period_end=e.period_end),xe.get(`${jr}/pm/compliance`,r)}},ZA={getTags:e=>{const r={};return e!=null&&e.asset_id&&(r.asset_id=e.asset_id.toString()),(e==null?void 0:e.is_active)!==void 0&&(r.is_active=e.is_active.toString()),e!=null&&e.page&&(r.page=e.page.toString()),e!=null&&e.per_page&&(r.per_page=e.per_page.toString()),xe.get(`${jr}/condition-monitoring/tags`,r)},getTag:e=>xe.get(`${jr}/condition-monitoring/tags/${e}`),createTag:e=>xe.post(`${jr}/condition-monitoring/tags`,e),updateTag:(e,r)=>xe.put(`${jr}/condition-monitoring/tags/${e}`,r),deleteTag:e=>xe.delete(`${jr}/condition-monitoring/tags/${e}`),ingestReading:(e,r)=>xe.post(`${jr}/condition-monitoring/tags/${e}/readings`,r),acknowledgeAlarm:(e,r)=>xe.post(`${jr}/condition-monitoring/alarms/${e}/acknowledge`,r),clearAlarm:e=>xe.post(`${jr}/condition-monitoring/alarms/${e}/clear`),getAssetHealth:e=>xe.get(`${jr}/condition-monitoring/assets/${e}/health`),evaluateRules:()=>xe.post(`${jr}/condition-monitoring/rules/evaluate`)},d1={getStores:e=>{const r={};return e!=null&&e.type&&(r.type=e.type),e!=null&&e.page&&(r.page=e.page.toString()),e!=null&&e.per_page&&(r.per_page=e.per_page.toString()),xe.get(`${jr}/stores`,r)},getStore:e=>xe.get(`${jr}/stores/${e}`),createStore:e=>xe.post(`${jr}/stores`,e),updateStore:(e,r)=>xe.put(`${jr}/stores/${e}`,r),createBin:(e,r)=>xe.post(`${jr}/stores/${e}/bins`,r),receiveStock:e=>xe.post(`${jr}/stores/receive`,e),issueStock:e=>xe.post(`${jr}/stores/issue`,e),getValuation:()=>xe.get(`${jr}/stores/valuation`),getLowStock:()=>xe.get(`${jr}/stores/low-stock`)},u1={getFleetAssets:e=>{const r={};return e!=null&&e.type&&(r.type=e.type),e!=null&&e.status&&(r.status=e.status),e!=null&&e.page&&(r.page=e.page.toString()),e!=null&&e.per_page&&(r.per_page=e.per_page.toString()),xe.get(`${jr}/fleet`,r)},getFleetAsset:e=>xe.get(`${jr}/fleet/${e}`),createFleetAsset:e=>xe.post(`${jr}/fleet`,e),updateFleetAsset:(e,r)=>xe.put(`${jr}/fleet/${e}`,r),createServiceSchedule:(e,r)=>xe.post(`${jr}/fleet/${e}/service-schedules`,r),logFuel:(e,r)=>xe.post(`${jr}/fleet/${e}/fuel-logs`,r),logUptime:(e,r)=>xe.post(`${jr}/fleet/${e}/uptime-logs`,r),getUtilization:e=>{const r={};return e!=null&&e.from_date&&(r.from_date=e.from_date),e!=null&&e.to_date&&(r.to_date=e.to_date),xe.get(`${jr}/fleet/utilization`,r)},getFuelEfficiency:(e,r)=>{const n={};return r!=null&&r.from_date&&(n.from_date=r.from_date),r!=null&&r.to_date&&(n.to_date=r.to_date),xe.get(`${jr}/fleet/${e}/fuel-efficiency`,n)}},O0={getContracts:e=>{const r={};return e!=null&&e.status&&(r.status=e.status),e!=null&&e.type&&(r.type=e.type),e!=null&&e.page&&(r.page=e.page.toString()),e!=null&&e.per_page&&(r.per_page=e.per_page.toString()),xe.get(`${jr}/contractors/contracts`,r)},getContract:e=>xe.get(`${jr}/contractors/contracts/${e}`),createContract:e=>xe.post(`${jr}/contractors/contracts`,e),updateContract:(e,r)=>xe.put(`${jr}/contractors/contracts/${e}`,r),recordViolation:(e,r)=>xe.post(`${jr}/contractors/contracts/${e}/violations`,r),recordPayment:(e,r)=>xe.post(`${jr}/contractors/contracts/${e}/payments`,r),getVendorScore:e=>{const r={};return e!=null&&e.vendor_name&&(r.vendor_name=e.vendor_name),e!=null&&e.period_start&&(r.period_start=e.period_start),e!=null&&e.period_end&&(r.period_end=e.period_end),xe.get(`${jr}/contractors/vendor-score`,r)},getActiveContracts:()=>xe.get(`${jr}/contractors/active`),getExpiringContracts:e=>{const r={};return e!=null&&e.days&&(r.days=e.days.toString()),xe.get(`${jr}/contractors/expiring`,r)}},mf={getPermits:e=>{const r={};return e!=null&&e.status&&(r.status=e.status),e!=null&&e.permit_type&&(r.permit_type=e.permit_type),e!=null&&e.page&&(r.page=e.page.toString()),e!=null&&e.per_page&&(r.per_page=e.per_page.toString()),xe.get(`${jr}/hse/permits`,r)},getPermit:e=>xe.get(`${jr}/hse/permits/${e}`),createPermit:e=>xe.post(`${jr}/hse/permits`,e),approvePermit:(e,r)=>xe.post(`${jr}/hse/permits/${e}/approve`,r||{}),closePermit:e=>xe.post(`${jr}/hse/permits/${e}/close`),createRiskAssessment:e=>xe.post(`${jr}/hse/risk-assessments`,e),updateRiskAssessment:(e,r)=>xe.put(`${jr}/hse/risk-assessments/${e}`,r),getIncidents:e=>{const r={};return e!=null&&e.category&&(r.category=e.category),e!=null&&e.severity&&(r.severity=e.severity),e!=null&&e.status&&(r.status=e.status),e!=null&&e.page&&(r.page=e.page.toString()),e!=null&&e.per_page&&(r.per_page=e.per_page.toString()),xe.get(`${jr}/hse/incidents`,r)},createIncident:e=>xe.post(`${jr}/hse/incidents`,e),investigateIncident:(e,r)=>xe.post(`${jr}/hse/incidents/${e}/investigate`,r),closeIncident:e=>xe.post(`${jr}/hse/incidents/${e}/close`),getIncidentStats:e=>{const r={};return e!=null&&e.from_date&&(r.from_date=e.from_date),e!=null&&e.to_date&&(r.to_date=e.to_date),xe.get(`${jr}/hse/incidents/stats`,r)},getCapas:e=>{const r={};return e!=null&&e.status&&(r.status=e.status),e!=null&&e.page&&(r.page=e.page.toString()),e!=null&&e.per_page&&(r.per_page=e.per_page.toString()),xe.get(`${jr}/hse/capas`,r)},createCapa:e=>xe.post(`${jr}/hse/capas`,e),completeCapa:(e,r)=>xe.post(`${jr}/hse/capas/${e}/complete`,r)},Fue={draft:"bg-gray-100 text-gray-800",active:"bg-green-100 text-green-800",archived:"bg-orange-100 text-orange-800"};function zue(){var k;const[e,r]=O.useState({page:1,per_page:15,search:"",status:"all"}),[n,s]=O.useState(!1),[i,l]=O.useState(null),d=Sr(),{data:a,isLoading:f}=ct({queryKey:["job-plans",e],queryFn:()=>M0.getJobPlans(e)}),p=Nt({mutationFn:M0.createJobPlan,onSuccess:()=>{d.invalidateQueries({queryKey:["job-plans"]}),s(!1),Ge.success("Job plan created successfully")}}),y=Nt({mutationFn:({id:S,data:R})=>M0.updateJobPlan(S,R),onSuccess:()=>{d.invalidateQueries({queryKey:["job-plans"]}),s(!1),l(null),Ge.success("Job plan updated successfully")}}),v=Nt({mutationFn:M0.activate,onSuccess:()=>{d.invalidateQueries({queryKey:["job-plans"]}),Ge.success("Job plan activated")}}),j=Nt({mutationFn:M0.createVersion,onSuccess:()=>{d.invalidateQueries({queryKey:["job-plans"]}),Ge.success("New version created")}}),w=S=>{S.preventDefault();const R=new FormData(S.currentTarget),D={code:R.get("code"),name:R.get("name"),description:R.get("description"),sop:R.get("sop"),estimated_hours:parseFloat(R.get("estimated_hours")),status:R.get("status")||"draft"};i?y.mutate({id:i.id,data:D}):p.mutate(D)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Job Plans"}),t.jsx("p",{className:"text-muted-foreground",children:"Standardized work procedures and checklists"})]}),t.jsxs(Or,{open:n,onOpenChange:s,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{onClick:()=>l(null),children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"New Job Plan"]})}),t.jsxs(kr,{className:"max-w-2xl",children:[t.jsx(Tr,{children:t.jsx(Er,{children:i?"Edit Job Plan":"Create Job Plan"})}),t.jsxs("form",{onSubmit:w,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"code",children:"Job Plan Code"}),t.jsx(Ve,{id:"code",name:"code",defaultValue:i==null?void 0:i.code,required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"status",children:"Status"}),t.jsxs($t,{name:"status",defaultValue:(i==null?void 0:i.status)||"draft",children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"draft",children:"Draft"}),t.jsx(Ne,{value:"active",children:"Active"}),t.jsx(Ne,{value:"archived",children:"Archived"})]})]})]})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"name",children:"Name"}),t.jsx(Ve,{id:"name",name:"name",defaultValue:i==null?void 0:i.name,required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"description",children:"Description"}),t.jsx(ts,{id:"description",name:"description",defaultValue:i==null?void 0:i.description,rows:3})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"sop",children:"Standard Operating Procedure"}),t.jsx(ts,{id:"sop",name:"sop",defaultValue:i==null?void 0:i.sop,rows:5,placeholder:"Step-by-step procedure..."})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"estimated_hours",children:"Estimated Hours"}),t.jsx(Ve,{id:"estimated_hours",name:"estimated_hours",type:"number",step:"0.5",defaultValue:i==null?void 0:i.estimated_hours})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:p.isPending||y.isPending,children:i?"Update":"Create"})]})]})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx(di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),t.jsx(Ve,{placeholder:"Search job plans...",value:e.search,onChange:S=>r({...e,search:S.target.value,page:1}),className:"pl-10"})]}),t.jsxs($t,{value:e.status,onValueChange:S=>r({...e,status:S,page:1}),children:[t.jsx(Rt,{className:"w-[200px]",children:t.jsx(Bt,{placeholder:"All Statuses"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All Statuses"}),t.jsx(Ne,{value:"draft",children:"Draft"}),t.jsx(Ne,{value:"active",children:"Active"}),t.jsx(Ne,{value:"archived",children:"Archived"})]})]})]})}),t.jsx(Q,{children:f?t.jsx("div",{className:"text-center py-8",children:"Loading..."}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Code"}),t.jsx(ce,{children:"Name"}),t.jsx(ce,{children:"Version"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Est. Hours"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:(k=a==null?void 0:a.data)==null?void 0:k.map(S=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-mono",children:S.code}),t.jsx(se,{className:"font-medium",children:S.name}),t.jsxs(se,{children:["v",S.version]}),t.jsx(se,{children:t.jsx(Ee,{className:Fue[S.status],children:S.status})}),t.jsxs(se,{children:[S.estimated_hours||"","h"]}),t.jsx(se,{children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{size:"sm",variant:"outline",onClick:()=>{l(S),s(!0)},children:t.jsx(Dl,{className:"h-4 w-4"})}),S.status==="draft"&&t.jsxs(X,{size:"sm",variant:"outline",onClick:()=>v.mutate(S.id),children:[t.jsx(Fs,{className:"h-4 w-4 mr-1"}),"Activate"]}),S.status==="active"&&t.jsxs(X,{size:"sm",variant:"outline",onClick:()=>j.mutate(S.id),children:[t.jsx($n,{className:"h-4 w-4 mr-1"}),"New Version"]})]})})]},S.id))})]})})]})]})}function $ue(){var S,R;const[e,r]=O.useState({page:1,per_page:15}),[n,s]=O.useState(!1),[i,l]=O.useState(null),d=Sr(),{data:a,isLoading:f}=ct({queryKey:["pm-templates",e],queryFn:()=>c1.getTemplates(e)}),{data:p}=ct({queryKey:["pm-compliance"],queryFn:()=>c1.getCompliance({})}),y=Nt({mutationFn:c1.createTemplate,onSuccess:()=>{d.invalidateQueries({queryKey:["pm-templates"]}),s(!1),Ge.success("PM template created successfully")}}),v=Nt({mutationFn:c1.generateWorkOrders,onSuccess:D=>{Ge.success(`Generated ${D.generated} work orders`)}}),j=D=>{D.preventDefault();const T=new FormData(D.currentTarget),I={name:T.get("name"),description:T.get("description"),trigger_type:T.get("trigger_type"),frequency_days:parseInt(T.get("frequency_days")),tolerance_days:parseInt(T.get("tolerance_days")),is_active:!0};y.mutate(I)},w=p==null?void 0:p[0],k=(w==null?void 0:w.compliance_pct)||0;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Preventive Maintenance"}),t.jsx("p",{className:"text-muted-foreground",children:"Schedule and track preventive maintenance"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(X,{variant:"outline",onClick:()=>v.mutate({}),disabled:v.isPending,children:[t.jsx(El,{className:"mr-2 h-4 w-4"}),"Generate Work Orders"]}),t.jsxs(Or,{open:n,onOpenChange:s,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{onClick:()=>l(null),children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"New PM Template"]})}),t.jsxs(kr,{className:"max-w-2xl",children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Create PM Template"})}),t.jsxs("form",{onSubmit:j,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"name",children:"Template Name"}),t.jsx(Ve,{id:"name",name:"name",required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"description",children:"Description"}),t.jsx(ts,{id:"description",name:"description",rows:3})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"trigger_type",children:"Trigger Type"}),t.jsxs($t,{name:"trigger_type",defaultValue:"time_based",children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"time_based",children:"Time Based"}),t.jsx(Ne,{value:"usage_based",children:"Usage Based"}),t.jsx(Ne,{value:"combined",children:"Combined"})]})]})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"frequency_days",children:"Frequency (days)"}),t.jsx(Ve,{id:"frequency_days",name:"frequency_days",type:"number",defaultValue:"30",required:!0})]})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"tolerance_days",children:"Tolerance (days)"}),t.jsx(Ve,{id:"tolerance_days",name:"tolerance_days",type:"number",defaultValue:"7"})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:y.isPending,children:"Create Template"})]})]})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{className:"pb-2",children:t.jsx(he,{className:"text-sm font-medium",children:"PM Compliance"})}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[k.toFixed(1),"%"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"On-time completion"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-2",children:t.jsx(he,{className:"text-sm font-medium",children:"Scheduled"})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:(w==null?void 0:w.pm_scheduled)||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"This period"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-2",children:t.jsx(he,{className:"text-sm font-medium",children:"Completed"})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:((w==null?void 0:w.pm_completed_on_time)||0)+((w==null?void 0:w.pm_completed_late)||0)}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Total completed"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-2",children:t.jsx(he,{className:"text-sm font-medium",children:"PM/CM Ratio"})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:((S=w==null?void 0:w.pm_breakdown_ratio)==null?void 0:S.toFixed(2))||""}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Target: > 4.0"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"PM Templates"})}),t.jsx(Q,{children:f?t.jsx("div",{className:"text-center py-8",children:"Loading..."}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Name"}),t.jsx(ce,{children:"Trigger Type"}),t.jsx(ce,{children:"Frequency"}),t.jsx(ce,{children:"Next Gen"}),t.jsx(ce,{children:"Status"})]})}),t.jsx(mr,{children:(R=a==null?void 0:a.data)==null?void 0:R.map(D=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:D.name}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:D.trigger_type})}),t.jsxs(se,{children:[D.frequency_days," days"]}),t.jsx(se,{children:D.next_gen_date?new Date(D.next_gen_date).toLocaleDateString():""}),t.jsx(se,{children:t.jsx(Ee,{variant:D.is_active?"default":"secondary",children:D.is_active?"Active":"Inactive"})})]},D.id))})]})})]})]})}const jF=(e,r,n)=>{if(e&&"reportValidity"in e){const s=nr(n,r);e.setCustomValidity(s&&s.message||""),e.reportValidity()}},fE=(e,r)=>{for(const n in r.fields){const s=r.fields[n];s&&s.ref&&"reportValidity"in s.ref?jF(s.ref,n,e):s&&s.refs&&s.refs.forEach(i=>jF(i,n,e))}},wF=(e,r)=>{r.shouldUseNativeValidation&&fE(e,r);const n={};for(const s in e){const i=nr(r.fields,s),l=Object.assign(e[s]||{},{ref:i&&i.ref});if(Bue(r.names||Object.keys(e),s)){const d=Object.assign({},nr(n,s));Un(d,"root",l),Un(n,s,d)}else Un(n,s,l)}return n},Bue=(e,r)=>{const n=NF(r);return e.some(s=>NF(s).match(`^${n}\\.\\d+`))};function NF(e){return e.replace(/\]|\[/g,"")}function WW(e,r,n){function s(a,f){var p;Object.defineProperty(a,"_zod",{value:a._zod??{},enumerable:!1}),(p=a._zod).traits??(p.traits=new Set),a._zod.traits.add(e),r(a,f);for(const y in d.prototype)y in a||Object.defineProperty(a,y,{value:d.prototype[y].bind(a)});a._zod.constr=d,a._zod.def=f}const i=(n==null?void 0:n.Parent)??Object;class l extends i{}Object.defineProperty(l,"name",{value:e});function d(a){var f;const p=n!=null&&n.Parent?new l:this;s(p,a),(f=p._zod).deferred??(f.deferred=[]);for(const y of p._zod.deferred)y();return p}return Object.defineProperty(d,"init",{value:s}),Object.defineProperty(d,Symbol.hasInstance,{value:a=>{var f,p;return n!=null&&n.Parent&&a instanceof n.Parent?!0:(p=(f=a==null?void 0:a._zod)==null?void 0:f.traits)==null?void 0:p.has(e)}}),Object.defineProperty(d,"name",{value:e}),d}class que extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const Vue={};function GW(e){return Vue}function Uue(e,r){return typeof r=="bigint"?r.toString():r}const KW=Error.captureStackTrace?Error.captureStackTrace:(...e)=>{};function h1(e){return typeof e=="string"?e:e==null?void 0:e.message}function HW(e,r,n){var i,l,d,a,f,p;const s={...e,path:e.path??[]};if(!e.message){const y=h1((d=(l=(i=e.inst)==null?void 0:i._zod.def)==null?void 0:l.error)==null?void 0:d.call(l,e))??h1((a=r==null?void 0:r.error)==null?void 0:a.call(r,e))??h1((f=n.customError)==null?void 0:f.call(n,e))??h1((p=n.localeError)==null?void 0:p.call(n,e))??"Invalid input";s.message=y}return delete s.inst,delete s.continue,r!=null&&r.reportInput||delete s.input,s}const ZW=(e,r)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:r,enumerable:!1}),Object.defineProperty(e,"message",{get(){return JSON.stringify(r,Uue,2)},enumerable:!0}),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},Wue=WW("$ZodError",ZW),YW=WW("$ZodError",ZW,{Parent:Error}),Gue=e=>(r,n,s,i)=>{const l=s?Object.assign(s,{async:!1}):{async:!1},d=r._zod.run({value:n,issues:[]},l);if(d instanceof Promise)throw new que;if(d.issues.length){const a=new((i==null?void 0:i.Err)??e)(d.issues.map(f=>HW(f,l,GW())));throw KW(a,i==null?void 0:i.callee),a}return d.value},Kue=Gue(YW),Hue=e=>async(r,n,s,i)=>{const l=s?Object.assign(s,{async:!0}):{async:!0};let d=r._zod.run({value:n,issues:[]},l);if(d instanceof Promise&&(d=await d),d.issues.length){const a=new((i==null?void 0:i.Err)??e)(d.issues.map(f=>HW(f,l,GW())));throw KW(a,i==null?void 0:i.callee),a}return d.value},Zue=Hue(YW);function SF(e,r){try{var n=e()}catch(s){return r(s)}return n&&n.then?n.then(void 0,r):n}function Yue(e,r){for(var n={};e.length;){var s=e[0],i=s.code,l=s.message,d=s.path.join(".");if(!n[d])if("unionErrors"in s){var a=s.unionErrors[0].errors[0];n[d]={message:a.message,type:a.code}}else n[d]={message:l,type:i};if("unionErrors"in s&&s.unionErrors.forEach(function(y){return y.errors.forEach(function(v){return e.push(v)})}),r){var f=n[d].types,p=f&&f[s.code];n[d]=DI(d,r,n,i,p?[].concat(p,s.message):s.message)}e.shift()}return n}function Xue(e,r){for(var n={};e.length;){var s=e[0],i=s.code,l=s.message,d=s.path.join(".");if(!n[d])if(s.code==="invalid_union"&&s.errors.length>0){var a=s.errors[0][0];n[d]={message:a.message,type:a.code}}else n[d]={message:l,type:i};if(s.code==="invalid_union"&&s.errors.forEach(function(y){return y.forEach(function(v){return e.push(v)})}),r){var f=n[d].types,p=f&&f[s.code];n[d]=DI(d,r,n,i,p?[].concat(p,s.message):s.message)}e.shift()}return n}function Rl(e,r,n){if(n===void 0&&(n={}),function(s){return"_def"in s&&typeof s._def=="object"&&"typeName"in s._def}(e))return function(s,i,l){try{return Promise.resolve(SF(function(){return Promise.resolve(e[n.mode==="sync"?"parse":"parseAsync"](s,r)).then(function(d){return l.shouldUseNativeValidation&&fE({},l),{errors:{},values:n.raw?Object.assign({},s):d}})},function(d){if(function(a){return Array.isArray(a==null?void 0:a.issues)}(d))return{values:{},errors:wF(Yue(d.errors,!l.shouldUseNativeValidation&&l.criteriaMode==="all"),l)};throw d}))}catch(d){return Promise.reject(d)}};if(function(s){return"_zod"in s&&typeof s._zod=="object"}(e))return function(s,i,l){try{return Promise.resolve(SF(function(){return Promise.resolve((n.mode==="sync"?Kue:Zue)(e,s,r)).then(function(d){return l.shouldUseNativeValidation&&fE({},l),{errors:{},values:n.raw?Object.assign({},s):d}})},function(d){if(function(a){return a instanceof Wue}(d))return{values:{},errors:wF(Xue(d.issues,!l.shouldUseNativeValidation&&l.criteriaMode==="all"),l)};throw d}))}catch(d){return Promise.reject(d)}};throw new Error("Invalid input: not a Zod schema")}var Bn;(function(e){e.assertEqual=i=>{};function r(i){}e.assertIs=r;function n(i){throw new Error}e.assertNever=n,e.arrayToEnum=i=>{const l={};for(const d of i)l[d]=d;return l},e.getValidEnumValues=i=>{const l=e.objectKeys(i).filter(a=>typeof i[i[a]]!="number"),d={};for(const a of l)d[a]=i[a];return e.objectValues(d)},e.objectValues=i=>e.objectKeys(i).map(function(l){return i[l]}),e.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const l=[];for(const d in i)Object.prototype.hasOwnProperty.call(i,d)&&l.push(d);return l},e.find=(i,l)=>{for(const d of i)if(l(d))return d},e.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function s(i,l=" | "){return i.map(d=>typeof d=="string"?`'${d}'`:d).join(l)}e.joinValues=s,e.jsonStringifyReplacer=(i,l)=>typeof l=="bigint"?l.toString():l})(Bn||(Bn={}));var PF;(function(e){e.mergeShapes=(r,n)=>({...r,...n})})(PF||(PF={}));const Mr=Bn.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Nh=e=>{switch(typeof e){case"undefined":return Mr.undefined;case"string":return Mr.string;case"number":return Number.isNaN(e)?Mr.nan:Mr.number;case"boolean":return Mr.boolean;case"function":return Mr.function;case"bigint":return Mr.bigint;case"symbol":return Mr.symbol;case"object":return Array.isArray(e)?Mr.array:e===null?Mr.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?Mr.promise:typeof Map<"u"&&e instanceof Map?Mr.map:typeof Set<"u"&&e instanceof Set?Mr.set:typeof Date<"u"&&e instanceof Date?Mr.date:Mr.object;default:return Mr.unknown}},Jt=Bn.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Su extends Error{get errors(){return this.issues}constructor(r){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=r}format(r){const n=r||function(l){return l.message},s={_errors:[]},i=l=>{for(const d of l.issues)if(d.code==="invalid_union")d.unionErrors.map(i);else if(d.code==="invalid_return_type")i(d.returnTypeError);else if(d.code==="invalid_arguments")i(d.argumentsError);else if(d.path.length===0)s._errors.push(n(d));else{let a=s,f=0;for(;f<d.path.length;){const p=d.path[f];f===d.path.length-1?(a[p]=a[p]||{_errors:[]},a[p]._errors.push(n(d))):a[p]=a[p]||{_errors:[]},a=a[p],f++}}};return i(this),s}static assert(r){if(!(r instanceof Su))throw new Error(`Not a ZodError: ${r}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Bn.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(r=n=>n.message){const n={},s=[];for(const i of this.issues)if(i.path.length>0){const l=i.path[0];n[l]=n[l]||[],n[l].push(r(i))}else s.push(r(i));return{formErrors:s,fieldErrors:n}}get formErrors(){return this.flatten()}}Su.create=e=>new Su(e);const pE=(e,r)=>{let n;switch(e.code){case Jt.invalid_type:e.received===Mr.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Jt.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Bn.jsonStringifyReplacer)}`;break;case Jt.unrecognized_keys:n=`Unrecognized key(s) in object: ${Bn.joinValues(e.keys,", ")}`;break;case Jt.invalid_union:n="Invalid input";break;case Jt.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Bn.joinValues(e.options)}`;break;case Jt.invalid_enum_value:n=`Invalid enum value. Expected ${Bn.joinValues(e.options)}, received '${e.received}'`;break;case Jt.invalid_arguments:n="Invalid function arguments";break;case Jt.invalid_return_type:n="Invalid function return type";break;case Jt.invalid_date:n="Invalid date";break;case Jt.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Bn.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Jt.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Jt.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Jt.custom:n="Invalid input";break;case Jt.invalid_intersection_types:n="Intersection results could not be merged";break;case Jt.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Jt.not_finite:n="Number must be finite";break;default:n=r.defaultError,Bn.assertNever(e)}return{message:n}};let Que=pE;function Jue(){return Que}const ehe=e=>{const{data:r,path:n,errorMaps:s,issueData:i}=e,l=[...n,...i.path||[]],d={...i,path:l};if(i.message!==void 0)return{...i,path:l,message:i.message};let a="";const f=s.filter(p=>!!p).slice().reverse();for(const p of f)a=p(d,{data:r,defaultError:a}).message;return{...i,path:l,message:a}};function xr(e,r){const n=Jue(),s=ehe({issueData:r,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===pE?void 0:pE].filter(i=>!!i)});e.common.issues.push(s)}class ll{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(r,n){const s=[];for(const i of n){if(i.status==="aborted")return on;i.status==="dirty"&&r.dirty(),s.push(i.value)}return{status:r.value,value:s}}static async mergeObjectAsync(r,n){const s=[];for(const i of n){const l=await i.key,d=await i.value;s.push({key:l,value:d})}return ll.mergeObjectSync(r,s)}static mergeObjectSync(r,n){const s={};for(const i of n){const{key:l,value:d}=i;if(l.status==="aborted"||d.status==="aborted")return on;l.status==="dirty"&&r.dirty(),d.status==="dirty"&&r.dirty(),l.value!=="__proto__"&&(typeof d.value<"u"||i.alwaysSet)&&(s[l.value]=d.value)}return{status:r.value,value:s}}}const on=Object.freeze({status:"aborted"}),Q0=e=>({status:"dirty",value:e}),$l=e=>({status:"valid",value:e}),CF=e=>e.status==="aborted",AF=e=>e.status==="dirty",Gg=e=>e.status==="valid",FN=e=>typeof Promise<"u"&&e instanceof Promise;var Rr;(function(e){e.errToObj=r=>typeof r=="string"?{message:r}:r||{},e.toString=r=>typeof r=="string"?r:r==null?void 0:r.message})(Rr||(Rr={}));class fm{constructor(r,n,s,i){this._cachedPath=[],this.parent=r,this.data=n,this._path=s,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const kF=(e,r)=>{if(Gg(r))return{success:!0,data:r.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Su(e.common.issues);return this._error=n,this._error}}};function _n(e){if(!e)return{};const{errorMap:r,invalid_type_error:n,required_error:s,description:i}=e;if(r&&(n||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return r?{errorMap:r,description:i}:{errorMap:(d,a)=>{const{message:f}=e;return d.code==="invalid_enum_value"?{message:f??a.defaultError}:typeof a.data>"u"?{message:f??s??a.defaultError}:d.code!=="invalid_type"?{message:a.defaultError}:{message:f??n??a.defaultError}},description:i}}class zn{get description(){return this._def.description}_getType(r){return Nh(r.data)}_getOrReturnCtx(r,n){return n||{common:r.parent.common,data:r.data,parsedType:Nh(r.data),schemaErrorMap:this._def.errorMap,path:r.path,parent:r.parent}}_processInputParams(r){return{status:new ll,ctx:{common:r.parent.common,data:r.data,parsedType:Nh(r.data),schemaErrorMap:this._def.errorMap,path:r.path,parent:r.parent}}}_parseSync(r){const n=this._parse(r);if(FN(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(r){const n=this._parse(r);return Promise.resolve(n)}parse(r,n){const s=this.safeParse(r,n);if(s.success)return s.data;throw s.error}safeParse(r,n){const s={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:r,parsedType:Nh(r)},i=this._parseSync({data:r,path:s.path,parent:s});return kF(s,i)}"~validate"(r){var s,i;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:r,parsedType:Nh(r)};if(!this["~standard"].async)try{const l=this._parseSync({data:r,path:[],parent:n});return Gg(l)?{value:l.value}:{issues:n.common.issues}}catch(l){(i=(s=l==null?void 0:l.message)==null?void 0:s.toLowerCase())!=null&&i.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:r,path:[],parent:n}).then(l=>Gg(l)?{value:l.value}:{issues:n.common.issues})}async parseAsync(r,n){const s=await this.safeParseAsync(r,n);if(s.success)return s.data;throw s.error}async safeParseAsync(r,n){const s={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:r,parsedType:Nh(r)},i=this._parse({data:r,path:s.path,parent:s}),l=await(FN(i)?i:Promise.resolve(i));return kF(s,l)}refine(r,n){const s=i=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(i):n;return this._refinement((i,l)=>{const d=r(i),a=()=>l.addIssue({code:Jt.custom,...s(i)});return typeof Promise<"u"&&d instanceof Promise?d.then(f=>f?!0:(a(),!1)):d?!0:(a(),!1)})}refinement(r,n){return this._refinement((s,i)=>r(s)?!0:(i.addIssue(typeof n=="function"?n(s,i):n),!1))}_refinement(r){return new Zg({schema:this,typeName:ln.ZodEffects,effect:{type:"refinement",refinement:r}})}superRefine(r){return this._refinement(r)}constructor(r){this.spa=this.safeParseAsync,this._def=r,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return rm.create(this,this._def)}nullable(){return Yg.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ld.create(this)}promise(){return qN.create(this,this._def)}or(r){return $N.create([this,r],this._def)}and(r){return BN.create(this,r,this._def)}transform(r){return new Zg({..._n(this._def),schema:this,typeName:ln.ZodEffects,effect:{type:"transform",transform:r}})}default(r){const n=typeof r=="function"?r:()=>r;return new gE({..._n(this._def),innerType:this,defaultValue:n,typeName:ln.ZodDefault})}brand(){return new whe({typeName:ln.ZodBranded,type:this,..._n(this._def)})}catch(r){const n=typeof r=="function"?r:()=>r;return new yE({..._n(this._def),innerType:this,catchValue:n,typeName:ln.ZodCatch})}describe(r){const n=this.constructor;return new n({...this._def,description:r})}pipe(r){return zI.create(this,r)}readonly(){return vE.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const the=/^c[^\s-]{8,}$/i,rhe=/^[0-9a-z]+$/,nhe=/^[0-9A-HJKMNP-TV-Z]{26}$/i,she=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,ihe=/^[a-z0-9_-]{21}$/i,ahe=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,ohe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,lhe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,che="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let YA;const dhe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,uhe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,hhe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,mhe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,fhe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,phe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,XW="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",xhe=new RegExp(`^${XW}$`);function QW(e){let r="[0-5]\\d";e.precision?r=`${r}\\.\\d{${e.precision}}`:e.precision==null&&(r=`${r}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${r})${n}`}function ghe(e){return new RegExp(`^${QW(e)}$`)}function yhe(e){let r=`${XW}T${QW(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),r=`${r}(${n.join("|")})`,new RegExp(`^${r}$`)}function vhe(e,r){return!!((r==="v4"||!r)&&dhe.test(e)||(r==="v6"||!r)&&hhe.test(e))}function _he(e,r){if(!ahe.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const s=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),i=JSON.parse(atob(s));return!(typeof i!="object"||i===null||"typ"in i&&(i==null?void 0:i.typ)!=="JWT"||!i.alg||r&&i.alg!==r)}catch{return!1}}function bhe(e,r){return!!((r==="v4"||!r)&&uhe.test(e)||(r==="v6"||!r)&&mhe.test(e))}class Vh extends zn{_parse(r){if(this._def.coerce&&(r.data=String(r.data)),this._getType(r)!==Mr.string){const l=this._getOrReturnCtx(r);return xr(l,{code:Jt.invalid_type,expected:Mr.string,received:l.parsedType}),on}const s=new ll;let i;for(const l of this._def.checks)if(l.kind==="min")r.data.length<l.value&&(i=this._getOrReturnCtx(r,i),xr(i,{code:Jt.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),s.dirty());else if(l.kind==="max")r.data.length>l.value&&(i=this._getOrReturnCtx(r,i),xr(i,{code:Jt.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),s.dirty());else if(l.kind==="length"){const d=r.data.length>l.value,a=r.data.length<l.value;(d||a)&&(i=this._getOrReturnCtx(r,i),d?xr(i,{code:Jt.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):a&&xr(i,{code:Jt.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),s.dirty())}else if(l.kind==="email")lhe.test(r.data)||(i=this._getOrReturnCtx(r,i),xr(i,{validation:"email",code:Jt.invalid_string,message:l.message}),s.dirty());else if(l.kind==="emoji")YA||(YA=new RegExp(che,"u")),YA.test(r.data)||(i=this._getOrReturnCtx(r,i),xr(i,{validation:"emoji",code:Jt.invalid_string,message:l.message}),s.dirty());else if(l.kind==="uuid")she.test(r.data)||(i=this._getOrReturnCtx(r,i),xr(i,{validation:"uuid",code:Jt.invalid_string,message:l.message}),s.dirty());else if(l.kind==="nanoid")ihe.test(r.data)||(i=this._getOrReturnCtx(r,i),xr(i,{validation:"nanoid",code:Jt.invalid_string,message:l.message}),s.dirty());else if(l.kind==="cuid")the.test(r.data)||(i=this._getOrReturnCtx(r,i),xr(i,{validation:"cuid",code:Jt.invalid_string,message:l.message}),s.dirty());else if(l.kind==="cuid2")rhe.test(r.data)||(i=this._getOrReturnCtx(r,i),xr(i,{validation:"cuid2",code:Jt.invalid_string,message:l.message}),s.dirty());else if(l.kind==="ulid")nhe.test(r.data)||(i=this._getOrReturnCtx(r,i),xr(i,{validation:"ulid",code:Jt.invalid_string,message:l.message}),s.dirty());else if(l.kind==="url")try{new URL(r.data)}catch{i=this._getOrReturnCtx(r,i),xr(i,{validation:"url",code:Jt.invalid_string,message:l.message}),s.dirty()}else l.kind==="regex"?(l.regex.lastIndex=0,l.regex.test(r.data)||(i=this._getOrReturnCtx(r,i),xr(i,{validation:"regex",code:Jt.invalid_string,message:l.message}),s.dirty())):l.kind==="trim"?r.data=r.data.trim():l.kind==="includes"?r.data.includes(l.value,l.position)||(i=this._getOrReturnCtx(r,i),xr(i,{code:Jt.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),s.dirty()):l.kind==="toLowerCase"?r.data=r.data.toLowerCase():l.kind==="toUpperCase"?r.data=r.data.toUpperCase():l.kind==="startsWith"?r.data.startsWith(l.value)||(i=this._getOrReturnCtx(r,i),xr(i,{code:Jt.invalid_string,validation:{startsWith:l.value},message:l.message}),s.dirty()):l.kind==="endsWith"?r.data.endsWith(l.value)||(i=this._getOrReturnCtx(r,i),xr(i,{code:Jt.invalid_string,validation:{endsWith:l.value},message:l.message}),s.dirty()):l.kind==="datetime"?yhe(l).test(r.data)||(i=this._getOrReturnCtx(r,i),xr(i,{code:Jt.invalid_string,validation:"datetime",message:l.message}),s.dirty()):l.kind==="date"?xhe.test(r.data)||(i=this._getOrReturnCtx(r,i),xr(i,{code:Jt.invalid_string,validation:"date",message:l.message}),s.dirty()):l.kind==="time"?ghe(l).test(r.data)||(i=this._getOrReturnCtx(r,i),xr(i,{code:Jt.invalid_string,validation:"time",message:l.message}),s.dirty()):l.kind==="duration"?ohe.test(r.data)||(i=this._getOrReturnCtx(r,i),xr(i,{validation:"duration",code:Jt.invalid_string,message:l.message}),s.dirty()):l.kind==="ip"?vhe(r.data,l.version)||(i=this._getOrReturnCtx(r,i),xr(i,{validation:"ip",code:Jt.invalid_string,message:l.message}),s.dirty()):l.kind==="jwt"?_he(r.data,l.alg)||(i=this._getOrReturnCtx(r,i),xr(i,{validation:"jwt",code:Jt.invalid_string,message:l.message}),s.dirty()):l.kind==="cidr"?bhe(r.data,l.version)||(i=this._getOrReturnCtx(r,i),xr(i,{validation:"cidr",code:Jt.invalid_string,message:l.message}),s.dirty()):l.kind==="base64"?fhe.test(r.data)||(i=this._getOrReturnCtx(r,i),xr(i,{validation:"base64",code:Jt.invalid_string,message:l.message}),s.dirty()):l.kind==="base64url"?phe.test(r.data)||(i=this._getOrReturnCtx(r,i),xr(i,{validation:"base64url",code:Jt.invalid_string,message:l.message}),s.dirty()):Bn.assertNever(l);return{status:s.value,value:r.data}}_regex(r,n,s){return this.refinement(i=>r.test(i),{validation:n,code:Jt.invalid_string,...Rr.errToObj(s)})}_addCheck(r){return new Vh({...this._def,checks:[...this._def.checks,r]})}email(r){return this._addCheck({kind:"email",...Rr.errToObj(r)})}url(r){return this._addCheck({kind:"url",...Rr.errToObj(r)})}emoji(r){return this._addCheck({kind:"emoji",...Rr.errToObj(r)})}uuid(r){return this._addCheck({kind:"uuid",...Rr.errToObj(r)})}nanoid(r){return this._addCheck({kind:"nanoid",...Rr.errToObj(r)})}cuid(r){return this._addCheck({kind:"cuid",...Rr.errToObj(r)})}cuid2(r){return this._addCheck({kind:"cuid2",...Rr.errToObj(r)})}ulid(r){return this._addCheck({kind:"ulid",...Rr.errToObj(r)})}base64(r){return this._addCheck({kind:"base64",...Rr.errToObj(r)})}base64url(r){return this._addCheck({kind:"base64url",...Rr.errToObj(r)})}jwt(r){return this._addCheck({kind:"jwt",...Rr.errToObj(r)})}ip(r){return this._addCheck({kind:"ip",...Rr.errToObj(r)})}cidr(r){return this._addCheck({kind:"cidr",...Rr.errToObj(r)})}datetime(r){return typeof r=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:r}):this._addCheck({kind:"datetime",precision:typeof(r==null?void 0:r.precision)>"u"?null:r==null?void 0:r.precision,offset:(r==null?void 0:r.offset)??!1,local:(r==null?void 0:r.local)??!1,...Rr.errToObj(r==null?void 0:r.message)})}date(r){return this._addCheck({kind:"date",message:r})}time(r){return typeof r=="string"?this._addCheck({kind:"time",precision:null,message:r}):this._addCheck({kind:"time",precision:typeof(r==null?void 0:r.precision)>"u"?null:r==null?void 0:r.precision,...Rr.errToObj(r==null?void 0:r.message)})}duration(r){return this._addCheck({kind:"duration",...Rr.errToObj(r)})}regex(r,n){return this._addCheck({kind:"regex",regex:r,...Rr.errToObj(n)})}includes(r,n){return this._addCheck({kind:"includes",value:r,position:n==null?void 0:n.position,...Rr.errToObj(n==null?void 0:n.message)})}startsWith(r,n){return this._addCheck({kind:"startsWith",value:r,...Rr.errToObj(n)})}endsWith(r,n){return this._addCheck({kind:"endsWith",value:r,...Rr.errToObj(n)})}min(r,n){return this._addCheck({kind:"min",value:r,...Rr.errToObj(n)})}max(r,n){return this._addCheck({kind:"max",value:r,...Rr.errToObj(n)})}length(r,n){return this._addCheck({kind:"length",value:r,...Rr.errToObj(n)})}nonempty(r){return this.min(1,Rr.errToObj(r))}trim(){return new Vh({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Vh({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Vh({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(r=>r.kind==="datetime")}get isDate(){return!!this._def.checks.find(r=>r.kind==="date")}get isTime(){return!!this._def.checks.find(r=>r.kind==="time")}get isDuration(){return!!this._def.checks.find(r=>r.kind==="duration")}get isEmail(){return!!this._def.checks.find(r=>r.kind==="email")}get isURL(){return!!this._def.checks.find(r=>r.kind==="url")}get isEmoji(){return!!this._def.checks.find(r=>r.kind==="emoji")}get isUUID(){return!!this._def.checks.find(r=>r.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(r=>r.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(r=>r.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(r=>r.kind==="cuid2")}get isULID(){return!!this._def.checks.find(r=>r.kind==="ulid")}get isIP(){return!!this._def.checks.find(r=>r.kind==="ip")}get isCIDR(){return!!this._def.checks.find(r=>r.kind==="cidr")}get isBase64(){return!!this._def.checks.find(r=>r.kind==="base64")}get isBase64url(){return!!this._def.checks.find(r=>r.kind==="base64url")}get minLength(){let r=null;for(const n of this._def.checks)n.kind==="min"&&(r===null||n.value>r)&&(r=n.value);return r}get maxLength(){let r=null;for(const n of this._def.checks)n.kind==="max"&&(r===null||n.value<r)&&(r=n.value);return r}}Vh.create=e=>new Vh({checks:[],typeName:ln.ZodString,coerce:(e==null?void 0:e.coerce)??!1,..._n(e)});function jhe(e,r){const n=(e.toString().split(".")[1]||"").length,s=(r.toString().split(".")[1]||"").length,i=n>s?n:s,l=Number.parseInt(e.toFixed(i).replace(".","")),d=Number.parseInt(r.toFixed(i).replace(".",""));return l%d/10**i}class Kg extends zn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(r){if(this._def.coerce&&(r.data=Number(r.data)),this._getType(r)!==Mr.number){const l=this._getOrReturnCtx(r);return xr(l,{code:Jt.invalid_type,expected:Mr.number,received:l.parsedType}),on}let s;const i=new ll;for(const l of this._def.checks)l.kind==="int"?Bn.isInteger(r.data)||(s=this._getOrReturnCtx(r,s),xr(s,{code:Jt.invalid_type,expected:"integer",received:"float",message:l.message}),i.dirty()):l.kind==="min"?(l.inclusive?r.data<l.value:r.data<=l.value)&&(s=this._getOrReturnCtx(r,s),xr(s,{code:Jt.too_small,minimum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),i.dirty()):l.kind==="max"?(l.inclusive?r.data>l.value:r.data>=l.value)&&(s=this._getOrReturnCtx(r,s),xr(s,{code:Jt.too_big,maximum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),i.dirty()):l.kind==="multipleOf"?jhe(r.data,l.value)!==0&&(s=this._getOrReturnCtx(r,s),xr(s,{code:Jt.not_multiple_of,multipleOf:l.value,message:l.message}),i.dirty()):l.kind==="finite"?Number.isFinite(r.data)||(s=this._getOrReturnCtx(r,s),xr(s,{code:Jt.not_finite,message:l.message}),i.dirty()):Bn.assertNever(l);return{status:i.value,value:r.data}}gte(r,n){return this.setLimit("min",r,!0,Rr.toString(n))}gt(r,n){return this.setLimit("min",r,!1,Rr.toString(n))}lte(r,n){return this.setLimit("max",r,!0,Rr.toString(n))}lt(r,n){return this.setLimit("max",r,!1,Rr.toString(n))}setLimit(r,n,s,i){return new Kg({...this._def,checks:[...this._def.checks,{kind:r,value:n,inclusive:s,message:Rr.toString(i)}]})}_addCheck(r){return new Kg({...this._def,checks:[...this._def.checks,r]})}int(r){return this._addCheck({kind:"int",message:Rr.toString(r)})}positive(r){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Rr.toString(r)})}negative(r){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Rr.toString(r)})}nonpositive(r){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Rr.toString(r)})}nonnegative(r){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Rr.toString(r)})}multipleOf(r,n){return this._addCheck({kind:"multipleOf",value:r,message:Rr.toString(n)})}finite(r){return this._addCheck({kind:"finite",message:Rr.toString(r)})}safe(r){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Rr.toString(r)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Rr.toString(r)})}get minValue(){let r=null;for(const n of this._def.checks)n.kind==="min"&&(r===null||n.value>r)&&(r=n.value);return r}get maxValue(){let r=null;for(const n of this._def.checks)n.kind==="max"&&(r===null||n.value<r)&&(r=n.value);return r}get isInt(){return!!this._def.checks.find(r=>r.kind==="int"||r.kind==="multipleOf"&&Bn.isInteger(r.value))}get isFinite(){let r=null,n=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(n===null||s.value>n)&&(n=s.value):s.kind==="max"&&(r===null||s.value<r)&&(r=s.value)}return Number.isFinite(n)&&Number.isFinite(r)}}Kg.create=e=>new Kg({checks:[],typeName:ln.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,..._n(e)});class K_ extends zn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(r){if(this._def.coerce)try{r.data=BigInt(r.data)}catch{return this._getInvalidInput(r)}if(this._getType(r)!==Mr.bigint)return this._getInvalidInput(r);let s;const i=new ll;for(const l of this._def.checks)l.kind==="min"?(l.inclusive?r.data<l.value:r.data<=l.value)&&(s=this._getOrReturnCtx(r,s),xr(s,{code:Jt.too_small,type:"bigint",minimum:l.value,inclusive:l.inclusive,message:l.message}),i.dirty()):l.kind==="max"?(l.inclusive?r.data>l.value:r.data>=l.value)&&(s=this._getOrReturnCtx(r,s),xr(s,{code:Jt.too_big,type:"bigint",maximum:l.value,inclusive:l.inclusive,message:l.message}),i.dirty()):l.kind==="multipleOf"?r.data%l.value!==BigInt(0)&&(s=this._getOrReturnCtx(r,s),xr(s,{code:Jt.not_multiple_of,multipleOf:l.value,message:l.message}),i.dirty()):Bn.assertNever(l);return{status:i.value,value:r.data}}_getInvalidInput(r){const n=this._getOrReturnCtx(r);return xr(n,{code:Jt.invalid_type,expected:Mr.bigint,received:n.parsedType}),on}gte(r,n){return this.setLimit("min",r,!0,Rr.toString(n))}gt(r,n){return this.setLimit("min",r,!1,Rr.toString(n))}lte(r,n){return this.setLimit("max",r,!0,Rr.toString(n))}lt(r,n){return this.setLimit("max",r,!1,Rr.toString(n))}setLimit(r,n,s,i){return new K_({...this._def,checks:[...this._def.checks,{kind:r,value:n,inclusive:s,message:Rr.toString(i)}]})}_addCheck(r){return new K_({...this._def,checks:[...this._def.checks,r]})}positive(r){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Rr.toString(r)})}negative(r){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Rr.toString(r)})}nonpositive(r){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Rr.toString(r)})}nonnegative(r){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Rr.toString(r)})}multipleOf(r,n){return this._addCheck({kind:"multipleOf",value:r,message:Rr.toString(n)})}get minValue(){let r=null;for(const n of this._def.checks)n.kind==="min"&&(r===null||n.value>r)&&(r=n.value);return r}get maxValue(){let r=null;for(const n of this._def.checks)n.kind==="max"&&(r===null||n.value<r)&&(r=n.value);return r}}K_.create=e=>new K_({checks:[],typeName:ln.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,..._n(e)});class TF extends zn{_parse(r){if(this._def.coerce&&(r.data=!!r.data),this._getType(r)!==Mr.boolean){const s=this._getOrReturnCtx(r);return xr(s,{code:Jt.invalid_type,expected:Mr.boolean,received:s.parsedType}),on}return $l(r.data)}}TF.create=e=>new TF({typeName:ln.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,..._n(e)});class zN extends zn{_parse(r){if(this._def.coerce&&(r.data=new Date(r.data)),this._getType(r)!==Mr.date){const l=this._getOrReturnCtx(r);return xr(l,{code:Jt.invalid_type,expected:Mr.date,received:l.parsedType}),on}if(Number.isNaN(r.data.getTime())){const l=this._getOrReturnCtx(r);return xr(l,{code:Jt.invalid_date}),on}const s=new ll;let i;for(const l of this._def.checks)l.kind==="min"?r.data.getTime()<l.value&&(i=this._getOrReturnCtx(r,i),xr(i,{code:Jt.too_small,message:l.message,inclusive:!0,exact:!1,minimum:l.value,type:"date"}),s.dirty()):l.kind==="max"?r.data.getTime()>l.value&&(i=this._getOrReturnCtx(r,i),xr(i,{code:Jt.too_big,message:l.message,inclusive:!0,exact:!1,maximum:l.value,type:"date"}),s.dirty()):Bn.assertNever(l);return{status:s.value,value:new Date(r.data.getTime())}}_addCheck(r){return new zN({...this._def,checks:[...this._def.checks,r]})}min(r,n){return this._addCheck({kind:"min",value:r.getTime(),message:Rr.toString(n)})}max(r,n){return this._addCheck({kind:"max",value:r.getTime(),message:Rr.toString(n)})}get minDate(){let r=null;for(const n of this._def.checks)n.kind==="min"&&(r===null||n.value>r)&&(r=n.value);return r!=null?new Date(r):null}get maxDate(){let r=null;for(const n of this._def.checks)n.kind==="max"&&(r===null||n.value<r)&&(r=n.value);return r!=null?new Date(r):null}}zN.create=e=>new zN({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:ln.ZodDate,..._n(e)});class EF extends zn{_parse(r){if(this._getType(r)!==Mr.symbol){const s=this._getOrReturnCtx(r);return xr(s,{code:Jt.invalid_type,expected:Mr.symbol,received:s.parsedType}),on}return $l(r.data)}}EF.create=e=>new EF({typeName:ln.ZodSymbol,..._n(e)});class MF extends zn{_parse(r){if(this._getType(r)!==Mr.undefined){const s=this._getOrReturnCtx(r);return xr(s,{code:Jt.invalid_type,expected:Mr.undefined,received:s.parsedType}),on}return $l(r.data)}}MF.create=e=>new MF({typeName:ln.ZodUndefined,..._n(e)});class OF extends zn{_parse(r){if(this._getType(r)!==Mr.null){const s=this._getOrReturnCtx(r);return xr(s,{code:Jt.invalid_type,expected:Mr.null,received:s.parsedType}),on}return $l(r.data)}}OF.create=e=>new OF({typeName:ln.ZodNull,..._n(e)});class IF extends zn{constructor(){super(...arguments),this._any=!0}_parse(r){return $l(r.data)}}IF.create=e=>new IF({typeName:ln.ZodAny,..._n(e)});class DF extends zn{constructor(){super(...arguments),this._unknown=!0}_parse(r){return $l(r.data)}}DF.create=e=>new DF({typeName:ln.ZodUnknown,..._n(e)});class pm extends zn{_parse(r){const n=this._getOrReturnCtx(r);return xr(n,{code:Jt.invalid_type,expected:Mr.never,received:n.parsedType}),on}}pm.create=e=>new pm({typeName:ln.ZodNever,..._n(e)});class RF extends zn{_parse(r){if(this._getType(r)!==Mr.undefined){const s=this._getOrReturnCtx(r);return xr(s,{code:Jt.invalid_type,expected:Mr.void,received:s.parsedType}),on}return $l(r.data)}}RF.create=e=>new RF({typeName:ln.ZodVoid,..._n(e)});class ld extends zn{_parse(r){const{ctx:n,status:s}=this._processInputParams(r),i=this._def;if(n.parsedType!==Mr.array)return xr(n,{code:Jt.invalid_type,expected:Mr.array,received:n.parsedType}),on;if(i.exactLength!==null){const d=n.data.length>i.exactLength.value,a=n.data.length<i.exactLength.value;(d||a)&&(xr(n,{code:d?Jt.too_big:Jt.too_small,minimum:a?i.exactLength.value:void 0,maximum:d?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),s.dirty())}if(i.minLength!==null&&n.data.length<i.minLength.value&&(xr(n,{code:Jt.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),s.dirty()),i.maxLength!==null&&n.data.length>i.maxLength.value&&(xr(n,{code:Jt.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),s.dirty()),n.common.async)return Promise.all([...n.data].map((d,a)=>i.type._parseAsync(new fm(n,d,n.path,a)))).then(d=>ll.mergeArray(s,d));const l=[...n.data].map((d,a)=>i.type._parseSync(new fm(n,d,n.path,a)));return ll.mergeArray(s,l)}get element(){return this._def.type}min(r,n){return new ld({...this._def,minLength:{value:r,message:Rr.toString(n)}})}max(r,n){return new ld({...this._def,maxLength:{value:r,message:Rr.toString(n)}})}length(r,n){return new ld({...this._def,exactLength:{value:r,message:Rr.toString(n)}})}nonempty(r){return this.min(1,r)}}ld.create=(e,r)=>new ld({type:e,minLength:null,maxLength:null,exactLength:null,typeName:ln.ZodArray,..._n(r)});function zx(e){if(e instanceof Li){const r={};for(const n in e.shape){const s=e.shape[n];r[n]=rm.create(zx(s))}return new Li({...e._def,shape:()=>r})}else return e instanceof ld?new ld({...e._def,type:zx(e.element)}):e instanceof rm?rm.create(zx(e.unwrap())):e instanceof Yg?Yg.create(zx(e.unwrap())):e instanceof ip?ip.create(e.items.map(r=>zx(r))):e}class Li extends zn{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const r=this._def.shape(),n=Bn.objectKeys(r);return this._cached={shape:r,keys:n},this._cached}_parse(r){if(this._getType(r)!==Mr.object){const p=this._getOrReturnCtx(r);return xr(p,{code:Jt.invalid_type,expected:Mr.object,received:p.parsedType}),on}const{status:s,ctx:i}=this._processInputParams(r),{shape:l,keys:d}=this._getCached(),a=[];if(!(this._def.catchall instanceof pm&&this._def.unknownKeys==="strip"))for(const p in i.data)d.includes(p)||a.push(p);const f=[];for(const p of d){const y=l[p],v=i.data[p];f.push({key:{status:"valid",value:p},value:y._parse(new fm(i,v,i.path,p)),alwaysSet:p in i.data})}if(this._def.catchall instanceof pm){const p=this._def.unknownKeys;if(p==="passthrough")for(const y of a)f.push({key:{status:"valid",value:y},value:{status:"valid",value:i.data[y]}});else if(p==="strict")a.length>0&&(xr(i,{code:Jt.unrecognized_keys,keys:a}),s.dirty());else if(p!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const p=this._def.catchall;for(const y of a){const v=i.data[y];f.push({key:{status:"valid",value:y},value:p._parse(new fm(i,v,i.path,y)),alwaysSet:y in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const p=[];for(const y of f){const v=await y.key,j=await y.value;p.push({key:v,value:j,alwaysSet:y.alwaysSet})}return p}).then(p=>ll.mergeObjectSync(s,p)):ll.mergeObjectSync(s,f)}get shape(){return this._def.shape()}strict(r){return Rr.errToObj,new Li({...this._def,unknownKeys:"strict",...r!==void 0?{errorMap:(n,s)=>{var l,d;const i=((d=(l=this._def).errorMap)==null?void 0:d.call(l,n,s).message)??s.defaultError;return n.code==="unrecognized_keys"?{message:Rr.errToObj(r).message??i}:{message:i}}}:{}})}strip(){return new Li({...this._def,unknownKeys:"strip"})}passthrough(){return new Li({...this._def,unknownKeys:"passthrough"})}extend(r){return new Li({...this._def,shape:()=>({...this._def.shape(),...r})})}merge(r){return new Li({unknownKeys:r._def.unknownKeys,catchall:r._def.catchall,shape:()=>({...this._def.shape(),...r._def.shape()}),typeName:ln.ZodObject})}setKey(r,n){return this.augment({[r]:n})}catchall(r){return new Li({...this._def,catchall:r})}pick(r){const n={};for(const s of Bn.objectKeys(r))r[s]&&this.shape[s]&&(n[s]=this.shape[s]);return new Li({...this._def,shape:()=>n})}omit(r){const n={};for(const s of Bn.objectKeys(this.shape))r[s]||(n[s]=this.shape[s]);return new Li({...this._def,shape:()=>n})}deepPartial(){return zx(this)}partial(r){const n={};for(const s of Bn.objectKeys(this.shape)){const i=this.shape[s];r&&!r[s]?n[s]=i:n[s]=i.optional()}return new Li({...this._def,shape:()=>n})}required(r){const n={};for(const s of Bn.objectKeys(this.shape))if(r&&!r[s])n[s]=this.shape[s];else{let l=this.shape[s];for(;l instanceof rm;)l=l._def.innerType;n[s]=l}return new Li({...this._def,shape:()=>n})}keyof(){return JW(Bn.objectKeys(this.shape))}}Li.create=(e,r)=>new Li({shape:()=>e,unknownKeys:"strip",catchall:pm.create(),typeName:ln.ZodObject,..._n(r)});Li.strictCreate=(e,r)=>new Li({shape:()=>e,unknownKeys:"strict",catchall:pm.create(),typeName:ln.ZodObject,..._n(r)});Li.lazycreate=(e,r)=>new Li({shape:e,unknownKeys:"strip",catchall:pm.create(),typeName:ln.ZodObject,..._n(r)});class $N extends zn{_parse(r){const{ctx:n}=this._processInputParams(r),s=this._def.options;function i(l){for(const a of l)if(a.result.status==="valid")return a.result;for(const a of l)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const d=l.map(a=>new Su(a.ctx.common.issues));return xr(n,{code:Jt.invalid_union,unionErrors:d}),on}if(n.common.async)return Promise.all(s.map(async l=>{const d={...n,common:{...n.common,issues:[]},parent:null};return{result:await l._parseAsync({data:n.data,path:n.path,parent:d}),ctx:d}})).then(i);{let l;const d=[];for(const f of s){const p={...n,common:{...n.common,issues:[]},parent:null},y=f._parseSync({data:n.data,path:n.path,parent:p});if(y.status==="valid")return y;y.status==="dirty"&&!l&&(l={result:y,ctx:p}),p.common.issues.length&&d.push(p.common.issues)}if(l)return n.common.issues.push(...l.ctx.common.issues),l.result;const a=d.map(f=>new Su(f));return xr(n,{code:Jt.invalid_union,unionErrors:a}),on}}get options(){return this._def.options}}$N.create=(e,r)=>new $N({options:e,typeName:ln.ZodUnion,..._n(r)});function xE(e,r){const n=Nh(e),s=Nh(r);if(e===r)return{valid:!0,data:e};if(n===Mr.object&&s===Mr.object){const i=Bn.objectKeys(r),l=Bn.objectKeys(e).filter(a=>i.indexOf(a)!==-1),d={...e,...r};for(const a of l){const f=xE(e[a],r[a]);if(!f.valid)return{valid:!1};d[a]=f.data}return{valid:!0,data:d}}else if(n===Mr.array&&s===Mr.array){if(e.length!==r.length)return{valid:!1};const i=[];for(let l=0;l<e.length;l++){const d=e[l],a=r[l],f=xE(d,a);if(!f.valid)return{valid:!1};i.push(f.data)}return{valid:!0,data:i}}else return n===Mr.date&&s===Mr.date&&+e==+r?{valid:!0,data:e}:{valid:!1}}class BN extends zn{_parse(r){const{status:n,ctx:s}=this._processInputParams(r),i=(l,d)=>{if(CF(l)||CF(d))return on;const a=xE(l.value,d.value);return a.valid?((AF(l)||AF(d))&&n.dirty(),{status:n.value,value:a.data}):(xr(s,{code:Jt.invalid_intersection_types}),on)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([l,d])=>i(l,d)):i(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}BN.create=(e,r,n)=>new BN({left:e,right:r,typeName:ln.ZodIntersection,..._n(n)});class ip extends zn{_parse(r){const{status:n,ctx:s}=this._processInputParams(r);if(s.parsedType!==Mr.array)return xr(s,{code:Jt.invalid_type,expected:Mr.array,received:s.parsedType}),on;if(s.data.length<this._def.items.length)return xr(s,{code:Jt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),on;!this._def.rest&&s.data.length>this._def.items.length&&(xr(s,{code:Jt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const l=[...s.data].map((d,a)=>{const f=this._def.items[a]||this._def.rest;return f?f._parse(new fm(s,d,s.path,a)):null}).filter(d=>!!d);return s.common.async?Promise.all(l).then(d=>ll.mergeArray(n,d)):ll.mergeArray(n,l)}get items(){return this._def.items}rest(r){return new ip({...this._def,rest:r})}}ip.create=(e,r)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ip({items:e,typeName:ln.ZodTuple,rest:null,..._n(r)})};class LF extends zn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(r){const{status:n,ctx:s}=this._processInputParams(r);if(s.parsedType!==Mr.map)return xr(s,{code:Jt.invalid_type,expected:Mr.map,received:s.parsedType}),on;const i=this._def.keyType,l=this._def.valueType,d=[...s.data.entries()].map(([a,f],p)=>({key:i._parse(new fm(s,a,s.path,[p,"key"])),value:l._parse(new fm(s,f,s.path,[p,"value"]))}));if(s.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const f of d){const p=await f.key,y=await f.value;if(p.status==="aborted"||y.status==="aborted")return on;(p.status==="dirty"||y.status==="dirty")&&n.dirty(),a.set(p.value,y.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const f of d){const p=f.key,y=f.value;if(p.status==="aborted"||y.status==="aborted")return on;(p.status==="dirty"||y.status==="dirty")&&n.dirty(),a.set(p.value,y.value)}return{status:n.value,value:a}}}}LF.create=(e,r,n)=>new LF({valueType:r,keyType:e,typeName:ln.ZodMap,..._n(n)});class H_ extends zn{_parse(r){const{status:n,ctx:s}=this._processInputParams(r);if(s.parsedType!==Mr.set)return xr(s,{code:Jt.invalid_type,expected:Mr.set,received:s.parsedType}),on;const i=this._def;i.minSize!==null&&s.data.size<i.minSize.value&&(xr(s,{code:Jt.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),i.maxSize!==null&&s.data.size>i.maxSize.value&&(xr(s,{code:Jt.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());const l=this._def.valueType;function d(f){const p=new Set;for(const y of f){if(y.status==="aborted")return on;y.status==="dirty"&&n.dirty(),p.add(y.value)}return{status:n.value,value:p}}const a=[...s.data.values()].map((f,p)=>l._parse(new fm(s,f,s.path,p)));return s.common.async?Promise.all(a).then(f=>d(f)):d(a)}min(r,n){return new H_({...this._def,minSize:{value:r,message:Rr.toString(n)}})}max(r,n){return new H_({...this._def,maxSize:{value:r,message:Rr.toString(n)}})}size(r,n){return this.min(r,n).max(r,n)}nonempty(r){return this.min(1,r)}}H_.create=(e,r)=>new H_({valueType:e,minSize:null,maxSize:null,typeName:ln.ZodSet,..._n(r)});class FF extends zn{get schema(){return this._def.getter()}_parse(r){const{ctx:n}=this._processInputParams(r);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}FF.create=(e,r)=>new FF({getter:e,typeName:ln.ZodLazy,..._n(r)});class zF extends zn{_parse(r){if(r.data!==this._def.value){const n=this._getOrReturnCtx(r);return xr(n,{received:n.data,code:Jt.invalid_literal,expected:this._def.value}),on}return{status:"valid",value:r.data}}get value(){return this._def.value}}zF.create=(e,r)=>new zF({value:e,typeName:ln.ZodLiteral,..._n(r)});function JW(e,r){return new Hg({values:e,typeName:ln.ZodEnum,..._n(r)})}class Hg extends zn{_parse(r){if(typeof r.data!="string"){const n=this._getOrReturnCtx(r),s=this._def.values;return xr(n,{expected:Bn.joinValues(s),received:n.parsedType,code:Jt.invalid_type}),on}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(r.data)){const n=this._getOrReturnCtx(r),s=this._def.values;return xr(n,{received:n.data,code:Jt.invalid_enum_value,options:s}),on}return $l(r.data)}get options(){return this._def.values}get enum(){const r={};for(const n of this._def.values)r[n]=n;return r}get Values(){const r={};for(const n of this._def.values)r[n]=n;return r}get Enum(){const r={};for(const n of this._def.values)r[n]=n;return r}extract(r,n=this._def){return Hg.create(r,{...this._def,...n})}exclude(r,n=this._def){return Hg.create(this.options.filter(s=>!r.includes(s)),{...this._def,...n})}}Hg.create=JW;class $F extends zn{_parse(r){const n=Bn.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(r);if(s.parsedType!==Mr.string&&s.parsedType!==Mr.number){const i=Bn.objectValues(n);return xr(s,{expected:Bn.joinValues(i),received:s.parsedType,code:Jt.invalid_type}),on}if(this._cache||(this._cache=new Set(Bn.getValidEnumValues(this._def.values))),!this._cache.has(r.data)){const i=Bn.objectValues(n);return xr(s,{received:s.data,code:Jt.invalid_enum_value,options:i}),on}return $l(r.data)}get enum(){return this._def.values}}$F.create=(e,r)=>new $F({values:e,typeName:ln.ZodNativeEnum,..._n(r)});class qN extends zn{unwrap(){return this._def.type}_parse(r){const{ctx:n}=this._processInputParams(r);if(n.parsedType!==Mr.promise&&n.common.async===!1)return xr(n,{code:Jt.invalid_type,expected:Mr.promise,received:n.parsedType}),on;const s=n.parsedType===Mr.promise?n.data:Promise.resolve(n.data);return $l(s.then(i=>this._def.type.parseAsync(i,{path:n.path,errorMap:n.common.contextualErrorMap})))}}qN.create=(e,r)=>new qN({type:e,typeName:ln.ZodPromise,..._n(r)});class Zg extends zn{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ln.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(r){const{status:n,ctx:s}=this._processInputParams(r),i=this._def.effect||null,l={addIssue:d=>{xr(s,d),d.fatal?n.abort():n.dirty()},get path(){return s.path}};if(l.addIssue=l.addIssue.bind(l),i.type==="preprocess"){const d=i.transform(s.data,l);if(s.common.async)return Promise.resolve(d).then(async a=>{if(n.value==="aborted")return on;const f=await this._def.schema._parseAsync({data:a,path:s.path,parent:s});return f.status==="aborted"?on:f.status==="dirty"||n.value==="dirty"?Q0(f.value):f});{if(n.value==="aborted")return on;const a=this._def.schema._parseSync({data:d,path:s.path,parent:s});return a.status==="aborted"?on:a.status==="dirty"||n.value==="dirty"?Q0(a.value):a}}if(i.type==="refinement"){const d=a=>{const f=i.refinement(a,l);if(s.common.async)return Promise.resolve(f);if(f instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(s.common.async===!1){const a=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return a.status==="aborted"?on:(a.status==="dirty"&&n.dirty(),d(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(a=>a.status==="aborted"?on:(a.status==="dirty"&&n.dirty(),d(a.value).then(()=>({status:n.value,value:a.value}))))}if(i.type==="transform")if(s.common.async===!1){const d=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!Gg(d))return on;const a=i.transform(d.value,l);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(d=>Gg(d)?Promise.resolve(i.transform(d.value,l)).then(a=>({status:n.value,value:a})):on);Bn.assertNever(i)}}Zg.create=(e,r,n)=>new Zg({schema:e,typeName:ln.ZodEffects,effect:r,..._n(n)});Zg.createWithPreprocess=(e,r,n)=>new Zg({schema:r,effect:{type:"preprocess",transform:e},typeName:ln.ZodEffects,..._n(n)});class rm extends zn{_parse(r){return this._getType(r)===Mr.undefined?$l(void 0):this._def.innerType._parse(r)}unwrap(){return this._def.innerType}}rm.create=(e,r)=>new rm({innerType:e,typeName:ln.ZodOptional,..._n(r)});class Yg extends zn{_parse(r){return this._getType(r)===Mr.null?$l(null):this._def.innerType._parse(r)}unwrap(){return this._def.innerType}}Yg.create=(e,r)=>new Yg({innerType:e,typeName:ln.ZodNullable,..._n(r)});class gE extends zn{_parse(r){const{ctx:n}=this._processInputParams(r);let s=n.data;return n.parsedType===Mr.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}gE.create=(e,r)=>new gE({innerType:e,typeName:ln.ZodDefault,defaultValue:typeof r.default=="function"?r.default:()=>r.default,..._n(r)});class yE extends zn{_parse(r){const{ctx:n}=this._processInputParams(r),s={...n,common:{...n.common,issues:[]}},i=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return FN(i)?i.then(l=>({status:"valid",value:l.status==="valid"?l.value:this._def.catchValue({get error(){return new Su(s.common.issues)},input:s.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Su(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}yE.create=(e,r)=>new yE({innerType:e,typeName:ln.ZodCatch,catchValue:typeof r.catch=="function"?r.catch:()=>r.catch,..._n(r)});class BF extends zn{_parse(r){if(this._getType(r)!==Mr.nan){const s=this._getOrReturnCtx(r);return xr(s,{code:Jt.invalid_type,expected:Mr.nan,received:s.parsedType}),on}return{status:"valid",value:r.data}}}BF.create=e=>new BF({typeName:ln.ZodNaN,..._n(e)});class whe extends zn{_parse(r){const{ctx:n}=this._processInputParams(r),s=n.data;return this._def.type._parse({data:s,path:n.path,parent:n})}unwrap(){return this._def.type}}class zI extends zn{_parse(r){const{status:n,ctx:s}=this._processInputParams(r);if(s.common.async)return(async()=>{const l=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return l.status==="aborted"?on:l.status==="dirty"?(n.dirty(),Q0(l.value)):this._def.out._parseAsync({data:l.value,path:s.path,parent:s})})();{const i=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?on:i.status==="dirty"?(n.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:s.path,parent:s})}}static create(r,n){return new zI({in:r,out:n,typeName:ln.ZodPipeline})}}class vE extends zn{_parse(r){const n=this._def.innerType._parse(r),s=i=>(Gg(i)&&(i.value=Object.freeze(i.value)),i);return FN(n)?n.then(i=>s(i)):s(n)}unwrap(){return this._def.innerType}}vE.create=(e,r)=>new vE({innerType:e,typeName:ln.ZodReadonly,..._n(r)});var ln;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(ln||(ln={}));const kn=Vh.create,Aa=Kg.create;pm.create;ld.create;const Bl=Li.create;$N.create;BN.create;ip.create;const nm=Hg.create;qN.create;rm.create;Yg.create;function Rs({control:e,name:r,label:n,type:s="text",placeholder:i,required:l=!1,error:d,step:a}){return t.jsxs("div",{className:"space-y-2",children:[t.jsxs(Me,{htmlFor:r,children:[n,l&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx(K2,{control:e,name:r,render:({field:{value:f,onChange:p,...y}})=>t.jsx(Ve,{...y,id:r,type:s,placeholder:i,step:a,className:d?"border-red-500":"",value:f??"",onChange:v=>{const j=v.target.value;p(s==="number"&&j===""?void 0:j)},onBlur:v=>{if(s==="number"&&v.target.value!==""){const j=parseFloat(v.target.value);p(isNaN(j)?v.target.value:j)}y.onBlur()}})}),d&&t.jsx("p",{className:"text-sm text-red-500",children:d})]})}const Nhe={normal:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",alarm:"bg-yellow-100 text-yellow-800",critical:"bg-red-100 text-red-800"},She=Bl({tag:kn().min(1,"Tag is required"),parameter:kn().min(1,"Parameter is required"),unit:kn().min(1,"Unit is required"),asset_id:Aa().int().positive("Asset ID is required")}),Phe=Bl({value:Aa(),source:kn().optional()});function Che(){var $,W,Z,oe,te,be,ie,ge,Ie;const[e,r]=O.useState({page:1,per_page:15}),[n,s]=O.useState(!1),[i,l]=O.useState(!1),[d,a]=O.useState(null),f=Sr(),p=yi({resolver:Rl(She),defaultValues:{tag:"",parameter:"",unit:"",asset_id:1}}),y=yi({resolver:Rl(Phe),defaultValues:{value:0,source:"manual"}});O.useEffect(()=>{n||p.reset()},[n,p]),O.useEffect(()=>{i||(y.reset(),a(null))},[i,y]);const{data:v,isLoading:j,error:w}=ct({queryKey:["monitoring-tags",e],queryFn:()=>ZA.getTags(e)}),k=Nt({mutationFn:ZA.createTag,onSuccess:()=>{f.invalidateQueries({queryKey:["monitoring-tags"]}),s(!1),Ge.success("Tag created successfully")},onError:()=>Ge.error("Failed to create tag")}),S=Nt({mutationFn:({tagId:Oe,data:Xe})=>ZA.ingestReading(Oe,Xe),onSuccess:()=>{f.invalidateQueries({queryKey:["monitoring-tags"]}),l(!1),Ge.success("Reading recorded successfully")},onError:()=>Ge.error("Failed to record reading")}),R=Oe=>{k.mutate(Oe)},D=Oe=>{if(!d){Ge.error("No tag selected");return}S.mutate({tagId:d.id,data:{value:Oe.value,source:Oe.source||"manual",read_at:new Date().toISOString()}})},T=(($=v==null?void 0:v.data)==null?void 0:$.filter(Oe=>Oe.health_status==="normal").length)||0,I=((W=v==null?void 0:v.data)==null?void 0:W.filter(Oe=>Oe.health_status==="warning").length)||0,L=((Z=v==null?void 0:v.data)==null?void 0:Z.filter(Oe=>Oe.health_status==="critical"||Oe.health_status==="alarm").length)||0;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Condition Monitoring"}),t.jsx("p",{className:"text-muted-foreground",children:"Track parameter trends and set alarms"})]}),t.jsxs(X,{onClick:()=>s(!0),children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"New Tag"]})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{className:"pb-2",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(Ka,{className:"h-4 w-4"}),"Total Tags"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:(v==null?void 0:v.total)||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Monitored parameters"})]})]}),t.jsxs(H,{className:"border-green-200 bg-green-50",children:[t.jsx(de,{className:"pb-2",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(xs,{className:"h-4 w-4 text-green-600"}),"Normal"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:T}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Within limits"})]})]}),t.jsxs(H,{className:"border-yellow-200 bg-yellow-50",children:[t.jsx(de,{className:"pb-2",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(Rne,{className:"h-4 w-4 text-yellow-600"}),"Warning"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:I}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Near limits"})]})]}),t.jsxs(H,{className:"border-red-200 bg-red-50",children:[t.jsx(de,{className:"pb-2",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(an,{className:"h-4 w-4 text-red-600"}),"Critical"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold text-red-600",children:L}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Out of limits"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Monitoring Tags"})}),t.jsx(Q,{children:j?t.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(v!=null&&v.data)||v.data.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No monitoring tags configured. Create your first tag to start tracking parameters."}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Tag"}),t.jsx(ce,{children:"Parameter"}),t.jsx(ce,{children:"Current Value"}),t.jsx(ce,{children:"Limits"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Last Reading"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:v.data.map(Oe=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-mono font-medium",children:Oe.tag}),t.jsx(se,{children:Oe.parameter}),t.jsx(se,{children:Oe.last_value!==null?`${Oe.last_value} ${Oe.unit}`:""}),t.jsx(se,{className:"text-xs",children:"Thresholds configured"}),t.jsx(se,{children:t.jsx(Ee,{className:Nhe[Oe.health_status],children:Oe.health_status})}),t.jsx(se,{className:"text-sm text-muted-foreground",children:Oe.last_reading_at?new Date(Oe.last_reading_at).toLocaleString():"Never"}),t.jsx(se,{children:t.jsxs(X,{size:"sm",variant:"outline",onClick:()=>{a(Oe),l(!0)},children:[t.jsx(Ka,{className:"h-4 w-4 mr-1"}),"Record"]})})]},Oe.id))})]})})]}),t.jsx(Or,{open:n,onOpenChange:s,children:t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Create Monitoring Tag"})}),t.jsxs("form",{onSubmit:p.handleSubmit(R),className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(Rs,{control:p.control,name:"tag",label:"Tag ID",placeholder:"e.g., P-101-FLOW",required:!0,error:(oe=p.formState.errors.tag)==null?void 0:oe.message}),t.jsx(Rs,{control:p.control,name:"parameter",label:"Parameter",placeholder:"e.g., Flow Rate",required:!0,error:(te=p.formState.errors.parameter)==null?void 0:te.message})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(Rs,{control:p.control,name:"unit",label:"Unit",placeholder:"e.g., m/h",required:!0,error:(be=p.formState.errors.unit)==null?void 0:be.message}),t.jsx(Rs,{control:p.control,name:"asset_id",label:"Asset ID",type:"number",required:!0,error:(ie=p.formState.errors.asset_id)==null?void 0:ie.message})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:k.isPending||!p.formState.isValid,children:"Create Tag"})]})]})]})}),t.jsx(Or,{open:i,onOpenChange:l,children:t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsxs(Er,{children:["Record Reading: ",d==null?void 0:d.tag]})}),t.jsxs("form",{onSubmit:y.handleSubmit(D),className:"space-y-4",children:[t.jsxs("div",{className:"bg-muted p-4 rounded-md",children:[t.jsx("p",{className:"text-sm font-medium",children:d==null?void 0:d.parameter}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:["Tag: ",d==null?void 0:d.tag," | Unit: ",d==null?void 0:d.unit]})]}),t.jsx(Rs,{control:y.control,name:"value",label:`Value (${d==null?void 0:d.unit})`,type:"number",step:"0.01",required:!0,error:(ge=y.formState.errors.value)==null?void 0:ge.message}),t.jsx(Rs,{control:y.control,name:"source",label:"Source",placeholder:"e.g., manual, sensor",error:(Ie=y.formState.errors.source)==null?void 0:Ie.message}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:S.isPending||!y.formState.isValid,children:"Record Reading"})]})]})]})})]})}function Z_({control:e,name:r,label:n,placeholder:s,required:i=!1,error:l,rows:d=3}){return t.jsxs("div",{className:"space-y-2",children:[t.jsxs(Me,{htmlFor:r,children:[n,i&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx(K2,{control:e,name:r,render:({field:a})=>t.jsx(ts,{...a,id:r,placeholder:s,rows:d,className:l?"border-red-500":"",value:a.value??""})}),l&&t.jsx("p",{className:"text-sm text-red-500",children:l})]})}const Ahe=Bl({part_id:Aa().int().positive("Part ID is required"),bin_id:Aa().int().positive("Bin ID is required"),qty:Aa().positive("Quantity must be positive"),unit_cost:Aa().positive("Unit cost must be positive"),notes:kn().optional()}),khe=Bl({part_id:Aa().int().positive("Part ID is required"),bin_id:Aa().int().positive("Bin ID is required"),qty:Aa().positive("Quantity must be positive"),work_order_id:Aa().int().positive().optional(),notes:kn().optional()});function The(){var I,L,$,W,Z,oe,te,be,ie,ge;const[e,r]=O.useState({page:1,per_page:15}),[n,s]=O.useState(!1),[i,l]=O.useState(!1),d=Sr(),a=yi({resolver:Rl(Ahe),defaultValues:{part_id:0,bin_id:1,qty:0,unit_cost:0,notes:""}}),f=yi({resolver:Rl(khe),defaultValues:{part_id:0,bin_id:1,qty:0,notes:""}});O.useEffect(()=>{n||a.reset()},[n,a]),O.useEffect(()=>{i||f.reset()},[i,f]);const{data:p,isLoading:y,error:v}=ct({queryKey:["stores",e],queryFn:()=>d1.getStores(e)}),{data:j}=ct({queryKey:["low-stock"],queryFn:()=>d1.getLowStock()}),w=Nt({mutationFn:d1.receiveStock,onSuccess:()=>{d.invalidateQueries({queryKey:["stores"]}),d.invalidateQueries({queryKey:["low-stock"]}),s(!1),Ge.success("Stock received successfully")},onError:()=>Ge.error("Failed to receive stock")}),k=Nt({mutationFn:d1.issueStock,onSuccess:()=>{d.invalidateQueries({queryKey:["stores"]}),d.invalidateQueries({queryKey:["low-stock"]}),l(!1),Ge.success("Stock issued successfully")},onError:()=>Ge.error("Failed to issue stock")}),S=Ie=>{w.mutate(Ie)},R=Ie=>{k.mutate(Ie)},D=0,T=(j==null?void 0:j.length)||0;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Stores & Inventory"}),t.jsx("p",{className:"text-muted-foreground",children:"Spare parts, tools, and consumables"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(X,{onClick:()=>s(!0),children:[t.jsx(xne,{className:"h-4 w-4 mr-2"}),"Receive Stock"]}),t.jsxs(X,{variant:"outline",onClick:()=>l(!0),children:[t.jsx(gne,{className:"h-4 w-4 mr-2"}),"Issue Stock"]})]})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{className:"pb-2",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(id,{className:"h-4 w-4"}),"Total Items"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:(p==null?void 0:p.total)||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"SKUs in stock"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-2",children:t.jsx(he,{className:"text-sm font-medium",children:"Inventory Value"})}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:["$",D.toFixed(2)]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Total cost"})]})]}),t.jsxs(H,{className:"border-yellow-200 bg-yellow-50",children:[t.jsx(de,{className:"pb-2",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(Xa,{className:"h-4 w-4 text-yellow-600"}),"Low Stock"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:T}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Items < 10 units"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-2",children:t.jsx(he,{className:"text-sm font-medium",children:"Total Stores"})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:(p==null?void 0:p.total)||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Locations"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Stores"})}),t.jsx(Q,{children:y?t.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(p!=null&&p.data)||p.data.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No stores configured. Create a store to manage inventory."}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Store Name"}),t.jsx(ce,{children:"Type"}),t.jsx(ce,{children:"Location"}),t.jsx(ce,{children:"Status"})]})}),t.jsx(mr,{children:p.data.map(Ie=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:Ie.name}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:Ie.type||"General"})}),t.jsx(se,{className:"text-sm text-muted-foreground",children:Ie.location||""}),t.jsx(se,{children:t.jsx(Ee,{className:"bg-green-100 text-green-800",children:"Active"})})]},Ie.id))})]})})]}),t.jsx(Or,{open:n,onOpenChange:s,children:t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Receive Stock"})}),t.jsxs("form",{onSubmit:a.handleSubmit(S),className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(Rs,{control:a.control,name:"part_id",label:"Part ID",type:"number",required:!0,error:(I=a.formState.errors.part_id)==null?void 0:I.message}),t.jsx(Rs,{control:a.control,name:"bin_id",label:"Bin ID",type:"number",required:!0,error:(L=a.formState.errors.bin_id)==null?void 0:L.message})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(Rs,{control:a.control,name:"qty",label:"Quantity",type:"number",step:"0.01",required:!0,error:($=a.formState.errors.qty)==null?void 0:$.message}),t.jsx(Rs,{control:a.control,name:"unit_cost",label:"Unit Cost",type:"number",step:"0.01",required:!0,error:(W=a.formState.errors.unit_cost)==null?void 0:W.message})]}),t.jsx(Z_,{control:a.control,name:"notes",label:"Notes",rows:3,error:(Z=a.formState.errors.notes)==null?void 0:Z.message}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:w.isPending||!a.formState.isValid,children:"Receive Stock"})]})]})]})}),t.jsx(Or,{open:i,onOpenChange:l,children:t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Issue Stock"})}),t.jsxs("form",{onSubmit:f.handleSubmit(R),className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(Rs,{control:f.control,name:"part_id",label:"Part ID",type:"number",required:!0,error:(oe=f.formState.errors.part_id)==null?void 0:oe.message}),t.jsx(Rs,{control:f.control,name:"bin_id",label:"Bin ID",type:"number",required:!0,error:(te=f.formState.errors.bin_id)==null?void 0:te.message})]}),t.jsx(Rs,{control:f.control,name:"qty",label:"Quantity",type:"number",step:"0.01",required:!0,error:(be=f.formState.errors.qty)==null?void 0:be.message}),t.jsx(Rs,{control:f.control,name:"work_order_id",label:"Work Order ID (optional)",type:"number",error:(ie=f.formState.errors.work_order_id)==null?void 0:ie.message}),t.jsx(Z_,{control:f.control,name:"notes",label:"Notes",rows:3,error:(ge=f.formState.errors.notes)==null?void 0:ge.message}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:k.isPending||!f.formState.isValid,children:"Issue Stock"})]})]})]})})]})}function e7({control:e,name:r,label:n,options:s,placeholder:i="Select...",required:l=!1,error:d}){return t.jsxs("div",{className:"space-y-2",children:[t.jsxs(Me,{htmlFor:r,children:[n,l&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx(K2,{control:e,name:r,render:({field:a})=>t.jsxs($t,{onValueChange:a.onChange,value:a.value,children:[t.jsx(Rt,{className:d?"border-red-500":"",children:t.jsx(Bt,{placeholder:i})}),t.jsx(Lt,{children:s.map(f=>t.jsx(Ne,{value:f.value,children:f.label},f.value))})]})}),d&&t.jsx("p",{className:"text-sm text-red-500",children:d})]})}const Ehe={active:"bg-green-100 text-green-800",maintenance:"bg-yellow-100 text-yellow-800",retired:"bg-gray-100 text-gray-800"},Mhe=Bl({service_type:kn().min(1,"Service type is required"),cost:Aa().positive("Cost must be positive"),odometer_reading:Aa().optional(),notes:kn().optional()}),Ohe=Bl({liters:Aa().positive("Liters must be positive"),cost:Aa().positive("Cost must be positive"),odometer_reading:Aa().positive("Odometer reading is required")});function Ihe(){var $,W,Z,oe,te,be,ie,ge,Ie;const[e,r]=O.useState({page:1,per_page:15,status:"all"}),[n,s]=O.useState(!1),[i,l]=O.useState(!1),[d,a]=O.useState(null),f=Sr(),p=yi({resolver:Rl(Mhe),defaultValues:{service_type:"",cost:0,notes:""}}),y=yi({resolver:Rl(Ohe),defaultValues:{liters:0,cost:0,odometer_reading:0}});O.useEffect(()=>{n||(p.reset(),a(null))},[n,p]),O.useEffect(()=>{i||(y.reset(),a(null))},[i,y]);const{data:v,isLoading:j,error:w}=ct({queryKey:["fleet-assets",e],queryFn:()=>u1.getFleetAssets(e)}),{data:k}=ct({queryKey:["fleet-utilization"],queryFn:()=>u1.getUtilization({})}),S=Nt({mutationFn:({fleet_asset_id:Oe,service_type:Xe,performed_at:Ue,notes:tt,cost:Ce,odometer_reading:ve})=>u1.createServiceSchedule(Oe,{service_type:Xe,performed_at:Ue,notes:tt,cost:Ce,odometer_reading:ve}),onSuccess:()=>{f.invalidateQueries({queryKey:["fleet-assets"]}),f.invalidateQueries({queryKey:["fleet-utilization"]}),s(!1),Ge.success("Service logged successfully")},onError:()=>Ge.error("Failed to log service")}),R=Nt({mutationFn:({fleet_asset_id:Oe,liters:Xe,cost:Ue,odometer_reading:tt,filled_at:Ce})=>u1.logFuel(Oe,{odometer:tt,liters:Xe,cost:Ue,filled_at:Ce}),onSuccess:()=>{f.invalidateQueries({queryKey:["fleet-assets"]}),l(!1),Ge.success("Fuel logged successfully")},onError:()=>Ge.error("Failed to log fuel")}),D=Oe=>{if(!d){Ge.error("No vehicle selected");return}S.mutate({fleet_asset_id:d.id,service_type:Oe.service_type,performed_at:new Date().toISOString(),notes:Oe.notes||"",cost:Oe.cost,odometer_reading:Oe.odometer_reading})},T=Oe=>{if(!d){Ge.error("No vehicle selected");return}R.mutate({fleet_asset_id:d.id,liters:Oe.liters,cost:Oe.cost,odometer_reading:Oe.odometer_reading,filled_at:new Date().toISOString()})},I=(($=v==null?void 0:v.data)==null?void 0:$.filter(Oe=>Oe.status==="active").length)||0,L=((W=v==null?void 0:v.data)==null?void 0:W.filter(Oe=>Oe.status==="maintenance").length)||0;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Fleet Management"}),t.jsx("p",{className:"text-muted-foreground",children:"Vehicles, generators, and mobile equipment"})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{className:"pb-2",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(B_,{className:"h-4 w-4"}),"Total Fleet"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:(v==null?void 0:v.total)||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Registered assets"})]})]}),t.jsxs(H,{className:"border-green-200 bg-green-50",children:[t.jsx(de,{className:"pb-2",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(xs,{className:"h-4 w-4 text-green-600"}),"Active"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:I}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"In service"})]})]}),t.jsxs(H,{className:"border-yellow-200 bg-yellow-50",children:[t.jsx(de,{className:"pb-2",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(Jf,{className:"h-4 w-4 text-yellow-600"}),"Maintenance"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:L}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Under repair"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-2",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(pL,{className:"h-4 w-4"}),"Avg Utilization"]})}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[k&&k.length>0?(k.reduce((Oe,Xe)=>Oe+(Xe.utilization_pct||0),0)/k.length).toFixed(1):0,"%"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Fleet uptime"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(he,{children:"Fleet Assets"}),t.jsxs($t,{value:e.status,onValueChange:Oe=>r({...e,status:Oe,page:1}),children:[t.jsx(Rt,{className:"w-[200px]",children:t.jsx(Bt,{placeholder:"All Statuses"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All Statuses"}),t.jsx(Ne,{value:"active",children:"Active"}),t.jsx(Ne,{value:"maintenance",children:"Maintenance"}),t.jsx(Ne,{value:"retired",children:"Retired"})]})]})]})}),t.jsx(Q,{children:j?t.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(v!=null&&v.data)||v.data.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No fleet assets registered"}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Registration"}),t.jsx(ce,{children:"Type"}),t.jsx(ce,{children:"Make/Model"}),t.jsx(ce,{children:"Odometer"}),t.jsx(ce,{children:"Operator"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:v.data.map(Oe=>{var Xe;return t.jsxs(ut,{children:[t.jsx(se,{className:"font-mono font-medium",children:Oe.registration}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:Oe.type})}),t.jsxs(se,{children:[Oe.make," ",Oe.model]}),t.jsx(se,{children:Oe.odometer?`${Oe.odometer.toLocaleString()} km`:""}),t.jsx(se,{children:((Xe=Oe.operator)==null?void 0:Xe.name)||"Unassigned"}),t.jsx(se,{children:t.jsx(Ee,{className:Ehe[Oe.status],children:Oe.status})}),t.jsx(se,{children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{size:"sm",variant:"outline",onClick:()=>{a(Oe),s(!0)},children:t.jsx(Jf,{className:"h-4 w-4"})}),t.jsx(X,{size:"sm",variant:"outline",onClick:()=>{a(Oe),l(!0)},children:t.jsx(pL,{className:"h-4 w-4"})})]})})]},Oe.id)})})]})})]}),t.jsx(Or,{open:n,onOpenChange:s,children:t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsxs(Er,{children:["Log Service: ",d==null?void 0:d.registration]})}),t.jsxs("form",{onSubmit:p.handleSubmit(D),className:"space-y-4",children:[t.jsx(e7,{control:p.control,name:"service_type",label:"Service Type",required:!0,options:[{value:"routine",label:"Routine Maintenance"},{value:"repair",label:"Repair"},{value:"inspection",label:"Inspection"},{value:"other",label:"Other"}],error:(Z=p.formState.errors.service_type)==null?void 0:Z.message}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(Rs,{control:p.control,name:"cost",label:"Cost",type:"number",step:"0.01",required:!0,error:(oe=p.formState.errors.cost)==null?void 0:oe.message}),t.jsx(Rs,{control:p.control,name:"odometer_reading",label:"Odometer (km)",type:"number",step:"1",error:(te=p.formState.errors.odometer_reading)==null?void 0:te.message})]}),t.jsx(Z_,{control:p.control,name:"notes",label:"Notes",rows:3,error:(be=p.formState.errors.notes)==null?void 0:be.message}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:S.isPending||!p.formState.isValid,children:"Log Service"})]})]})]})}),t.jsx(Or,{open:i,onOpenChange:l,children:t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsxs(Er,{children:["Log Fuel: ",d==null?void 0:d.registration]})}),t.jsxs("form",{onSubmit:y.handleSubmit(T),className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(Rs,{control:y.control,name:"liters",label:"Liters",type:"number",step:"0.01",required:!0,error:(ie=y.formState.errors.liters)==null?void 0:ie.message}),t.jsx(Rs,{control:y.control,name:"cost",label:"Cost",type:"number",step:"0.01",required:!0,error:(ge=y.formState.errors.cost)==null?void 0:ge.message})]}),t.jsx(Rs,{control:y.control,name:"odometer_reading",label:"Odometer (km)",type:"number",step:"1",required:!0,error:(Ie=y.formState.errors.odometer_reading)==null?void 0:Ie.message}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:R.isPending||!y.formState.isValid,children:"Log Fuel"})]})]})]})})]})}function Dhe(e,r=[]){let n=[];function s(l,d){const a=O.createContext(d),f=n.length;n=[...n,d];function p(v){const{scope:j,children:w,...k}=v,S=(j==null?void 0:j[e][f])||a,R=O.useMemo(()=>k,Object.values(k));return t.jsx(S.Provider,{value:R,children:w})}function y(v,j){const w=(j==null?void 0:j[e][f])||a,k=O.useContext(w);if(k)return k;if(d!==void 0)return d;throw new Error(`\`${v}\` must be used within \`${l}\``)}return p.displayName=l+"Provider",[p,y]}const i=()=>{const l=n.map(d=>O.createContext(d));return function(a){const f=(a==null?void 0:a[e])||l;return O.useMemo(()=>({[`__scope${e}`]:{...a,[e]:f}}),[a,f])}};return i.scopeName=e,[s,Rhe(i,...r)]}function Rhe(...e){const r=e[0];if(e.length===1)return r;const n=()=>{const s=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(l){const d=s.reduce((a,{useScope:f,scopeName:p})=>{const v=f(l)[`__scope${p}`];return{...a,...v}},{});return O.useMemo(()=>({[`__scope${r.scopeName}`]:d}),[d])}};return n.scopeName=r.scopeName,n}var $I="Progress",BI=100,[Lhe]=Dhe($I),[Fhe,zhe]=Lhe($I),t7=O.forwardRef((e,r)=>{const{__scopeProgress:n,value:s=null,max:i,getValueLabel:l=$he,...d}=e;(i||i===0)&&!qF(i)&&console.error(Bhe(`${i}`,"Progress"));const a=qF(i)?i:BI;s!==null&&!VF(s,a)&&console.error(qhe(`${s}`,"Progress"));const f=VF(s,a)?s:null,p=VN(f)?l(f,a):void 0;return t.jsx(Fhe,{scope:n,value:f,max:a,children:t.jsx(zr.div,{"aria-valuemax":a,"aria-valuemin":0,"aria-valuenow":VN(f)?f:void 0,"aria-valuetext":p,role:"progressbar","data-state":s7(f,a),"data-value":f??void 0,"data-max":a,...d,ref:r})})});t7.displayName=$I;var r7="ProgressIndicator",n7=O.forwardRef((e,r)=>{const{__scopeProgress:n,...s}=e,i=zhe(r7,n);return t.jsx(zr.div,{"data-state":s7(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...s,ref:r})});n7.displayName=r7;function $he(e,r){return`${Math.round(e/r*100)}%`}function s7(e,r){return e==null?"indeterminate":e===r?"complete":"loading"}function VN(e){return typeof e=="number"}function qF(e){return VN(e)&&!isNaN(e)&&e>0}function VF(e,r){return VN(e)&&!isNaN(e)&&e<=r&&e>=0}function Bhe(e,r){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${r}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${BI}\`.`}function qhe(e,r){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${r}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${BI} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var i7=t7,Vhe=n7;const du=O.forwardRef(({className:e,value:r,...n},s)=>t.jsx(i7,{ref:s,className:gr("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",e),...n,children:t.jsx(Vhe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(r||0)}%)`}})}));du.displayName=i7.displayName;const Uhe={draft:"bg-gray-100 text-gray-800",active:"bg-green-100 text-green-800",completed:"bg-blue-100 text-blue-800",terminated:"bg-red-100 text-red-800"},Whe=Bl({contract_num:kn().min(1,"Contract number is required"),vendor_name:kn().min(1,"Vendor name is required"),type:nm(["maintenance","construction","supply","consulting"]),value:Aa().positive("Contract value must be positive"),start_date:kn().min(1,"Start date is required"),end_date:kn().min(1,"End date is required"),description:kn().optional()}),Ghe=Bl({description:kn().min(1,"Description is required"),penalty_amount:Aa().positive("Penalty amount must be positive")});function Khe(){var W,Z,oe,te,be,ie,ge,Ie,Oe,Xe,Ue,tt;const[e,r]=O.useState({page:1,per_page:15,status:"active"}),[n,s]=O.useState(!1),[i,l]=O.useState(!1),[d,a]=O.useState(null),f=Sr(),p=yi({resolver:Rl(Whe),defaultValues:{contract_num:"",vendor_name:"",type:"maintenance",value:0,start_date:"",end_date:"",description:""}}),y=yi({resolver:Rl(Ghe),defaultValues:{description:"",penalty_amount:0}});O.useEffect(()=>{n||p.reset()},[n,p]),O.useEffect(()=>{i||(y.reset(),a(null))},[i,y]);const{data:v,isLoading:j,error:w}=ct({queryKey:["service-contracts",e],queryFn:()=>O0.getContracts(e)}),{data:k}=ct({queryKey:["vendor-scores"],queryFn:()=>O0.getVendorScore({})}),{data:S}=ct({queryKey:["expiring-contracts"],queryFn:()=>O0.getExpiringContracts({days:90})}),R=Nt({mutationFn:O0.createContract,onSuccess:()=>{f.invalidateQueries({queryKey:["service-contracts"]}),s(!1),Ge.success("Contract created successfully")},onError:()=>Ge.error("Failed to create contract")}),D=Nt({mutationFn:({contractId:Ce,data:ve})=>O0.recordViolation(Ce,ve),onSuccess:()=>{f.invalidateQueries({queryKey:["service-contracts"]}),l(!1),Ge.success("SLA violation recorded")},onError:()=>Ge.error("Failed to record violation")}),T=Ce=>{R.mutate({...Ce,status:"active"})},I=Ce=>{if(!d){Ge.error("No contract selected");return}D.mutate({contractId:d.id,data:{description:Ce.description,penalty_amount:Ce.penalty_amount,occurred_at:new Date().toISOString()}})},L=((W=v==null?void 0:v.data)==null?void 0:W.filter(Ce=>Ce.status==="active").length)||0,$=((Z=v==null?void 0:v.data)==null?void 0:Z.reduce((Ce,ve)=>Ce+(ve.value||0),0))||0;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Contractor & SLA Management"}),t.jsx("p",{className:"text-muted-foreground",children:"Service contracts and vendor performance tracking"})]}),t.jsxs(Or,{open:n,onOpenChange:s,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"New Contract"]})}),t.jsxs(kr,{className:"max-w-2xl",children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Create Service Contract"})}),t.jsxs("form",{onSubmit:p.handleSubmit(T),className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(Rs,{control:p.control,name:"contract_num",label:"Contract Number",required:!0,error:(oe=p.formState.errors.contract_num)==null?void 0:oe.message}),t.jsx(Rs,{control:p.control,name:"vendor_name",label:"Vendor Name",required:!0,error:(te=p.formState.errors.vendor_name)==null?void 0:te.message})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(e7,{control:p.control,name:"type",label:"Contract Type",required:!0,options:[{value:"maintenance",label:"Maintenance"},{value:"construction",label:"Construction"},{value:"supply",label:"Supply"},{value:"consulting",label:"Consulting"}],error:(be=p.formState.errors.type)==null?void 0:be.message}),t.jsx(Rs,{control:p.control,name:"value",label:"Contract Value",type:"number",step:"0.01",required:!0,error:(ie=p.formState.errors.value)==null?void 0:ie.message})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(Rs,{control:p.control,name:"start_date",label:"Start Date",type:"date",required:!0,error:(ge=p.formState.errors.start_date)==null?void 0:ge.message}),t.jsx(Rs,{control:p.control,name:"end_date",label:"End Date",type:"date",required:!0,error:(Ie=p.formState.errors.end_date)==null?void 0:Ie.message})]}),t.jsx(Z_,{control:p.control,name:"description",label:"Description",rows:3,error:(Oe=p.formState.errors.description)==null?void 0:Oe.message}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:R.isPending||!p.formState.isValid,children:"Create"})]})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{className:"pb-2",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx($n,{className:"h-4 w-4"}),"Active Contracts"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:L}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Total contracts"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-2",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(xs,{className:"h-4 w-4"}),"Contract Value"]})}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:["$",$.toLocaleString()]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Total active value"})]})]}),t.jsxs(H,{className:"border-orange-200 bg-orange-50",children:[t.jsx(de,{className:"pb-2",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(Xs,{className:"h-4 w-4 text-orange-600"}),"Expiring Soon"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold text-orange-600",children:(S==null?void 0:S.length)||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Next 90 days"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-2",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(ps,{className:"h-4 w-4"}),"SLA Violations"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:((Xe=v==null?void 0:v.data)==null?void 0:Xe.reduce((Ce,ve)=>{var rt;return Ce+(((rt=ve.violations)==null?void 0:rt.length)||0)},0))||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"This period"})]})]})]}),t.jsxs(Sn,{defaultValue:"contracts",className:"space-y-4",children:[t.jsxs(bn,{children:[t.jsx(kt,{value:"contracts",children:"Contracts"}),t.jsx(kt,{value:"vendors",children:"Vendor Scorecards"}),t.jsx(kt,{value:"expiring",children:"Expiring"})]}),t.jsx(Dt,{value:"contracts",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(he,{children:"Service Contracts"}),t.jsxs($t,{value:e.status||"all",onValueChange:Ce=>{const{status:ve,...rt}=e;r(Ce==="all"?{...rt,page:1}:{...rt,status:Ce,page:1})},children:[t.jsx(Rt,{className:"w-[200px]",children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All Statuses"}),t.jsx(Ne,{value:"active",children:"Active"}),t.jsx(Ne,{value:"completed",children:"Completed"}),t.jsx(Ne,{value:"terminated",children:"Terminated"})]})]})]})}),t.jsx(Q,{children:j?t.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(v!=null&&v.data)||v.data.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No contracts found"}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Contract #"}),t.jsx(ce,{children:"Vendor"}),t.jsx(ce,{children:"Type"}),t.jsx(ce,{children:"Value"}),t.jsx(ce,{children:"Period"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:v.data.map(Ce=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-mono",children:Ce.contract_num}),t.jsx(se,{className:"font-medium",children:Ce.vendor_name}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:Ce.type})}),t.jsxs(se,{children:["$",Ce.value.toLocaleString()]}),t.jsxs(se,{className:"text-sm",children:[new Date(Ce.start_date).toLocaleDateString()," -",t.jsx("br",{}),new Date(Ce.end_date).toLocaleDateString()]}),t.jsx(se,{children:t.jsx(Ee,{className:Uhe[Ce.status],children:Ce.status})}),t.jsx(se,{children:t.jsx(X,{size:"sm",variant:"outline",onClick:()=>{a(Ce),l(!0)},children:"Log Violation"})})]},Ce.id))})]})})]})}),t.jsx(Dt,{value:"vendors",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Vendor Performance Scorecards"})}),t.jsx(Q,{children:k&&k.length>0?t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Vendor"}),t.jsx(ce,{children:"Quality"}),t.jsx(ce,{children:"Timeliness"}),t.jsx(ce,{children:"Compliance"}),t.jsx(ce,{children:"Overall Score"})]})}),t.jsx(mr,{children:k.map(Ce=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:Ce.vendor_name}),t.jsx(se,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(du,{value:Ce.quality_score,className:"w-24"}),t.jsxs("span",{className:"text-sm",children:[Ce.quality_score,"%"]})]})}),t.jsx(se,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(du,{value:Ce.timeliness_score,className:"w-24"}),t.jsxs("span",{className:"text-sm",children:[Ce.timeliness_score,"%"]})]})}),t.jsx(se,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(du,{value:Ce.compliance_score,className:"w-24"}),t.jsxs("span",{className:"text-sm",children:[Ce.compliance_score,"%"]})]})}),t.jsx(se,{children:t.jsxs(Ee,{variant:Ce.overall_score>=80?"default":"secondary",children:[Ce.overall_score,"%"]})})]},Ce.id))})]}):t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No vendor scorecards available"})})]})}),t.jsx(Dt,{value:"expiring",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Contracts Expiring Soon"})}),t.jsx(Q,{children:S&&S.length>0?t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Contract #"}),t.jsx(ce,{children:"Vendor"}),t.jsx(ce,{children:"End Date"}),t.jsx(ce,{children:"Days Left"}),t.jsx(ce,{children:"Value"})]})}),t.jsx(mr,{children:S.map(Ce=>{const ve=Math.ceil((new Date(Ce.end_date).getTime()-Date.now())/864e5);return t.jsxs(ut,{children:[t.jsx(se,{className:"font-mono",children:Ce.contract_num}),t.jsx(se,{className:"font-medium",children:Ce.vendor_name}),t.jsx(se,{children:new Date(Ce.end_date).toLocaleDateString()}),t.jsx(se,{children:t.jsxs(Ee,{variant:ve<=30?"destructive":"secondary",children:[ve," days"]})}),t.jsxs(se,{children:["$",Ce.value.toLocaleString()]})]},Ce.id)})})]}):t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No contracts expiring soon"})})]})})]}),t.jsx(Or,{open:i,onOpenChange:l,children:t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Record SLA Violation"})}),t.jsxs("form",{onSubmit:y.handleSubmit(I),className:"space-y-4",children:[t.jsxs("div",{className:"bg-muted p-3 rounded-md text-sm",children:[t.jsx("strong",{children:"Contract:"})," ",d==null?void 0:d.contract_num," - ",d==null?void 0:d.vendor_name]}),t.jsx(Z_,{control:y.control,name:"description",label:"Violation Description",placeholder:"Describe the SLA breach...",rows:3,required:!0,error:(Ue=y.formState.errors.description)==null?void 0:Ue.message}),t.jsx(Rs,{control:y.control,name:"penalty_amount",label:"Penalty Amount",type:"number",step:"0.01",required:!0,error:(tt=y.formState.errors.penalty_amount)==null?void 0:tt.message}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:D.isPending||!y.formState.isValid,children:"Record Violation"})]})]})]})})]})}const Hhe={pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",closed:"bg-gray-100 text-gray-800"},Zhe={minor:"bg-blue-100 text-blue-800",moderate:"bg-yellow-100 text-yellow-800",serious:"bg-orange-100 text-orange-800",fatal:"bg-red-100 text-red-800"};function Yhe(){var Ue,tt,Ce;const[e,r]=O.useState({page:1,per_page:15,status:"all"}),[n,s]=O.useState({page:1,per_page:15,status:"open"}),[i,l]=O.useState({page:1,per_page:15,status:"open"}),[d,a]=O.useState(!1),[f,p]=O.useState(!1),[y,v]=O.useState(!1),j=Sr(),{data:w,isLoading:k,error:S}=ct({queryKey:["hse-permits",e],queryFn:()=>mf.getPermits(e)}),{data:R,isLoading:D,error:T}=ct({queryKey:["hse-incidents",n],queryFn:()=>mf.getIncidents(n)}),{data:I,isLoading:L,error:$}=ct({queryKey:["hse-capas",i],queryFn:()=>mf.getCapas(i)}),{data:W}=ct({queryKey:["incident-stats"],queryFn:()=>mf.getIncidentStats({})}),Z=Nt({mutationFn:mf.createPermit,onSuccess:()=>{j.invalidateQueries({queryKey:["hse-permits"]}),a(!1),Ge.success("Permit request created successfully")},onError:()=>Ge.error("Failed to create permit")}),oe=Nt({mutationFn:mf.createIncident,onSuccess:()=>{j.invalidateQueries({queryKey:["hse-incidents"]}),j.invalidateQueries({queryKey:["incident-stats"]}),p(!1),Ge.success("Incident reported successfully")},onError:()=>Ge.error("Failed to report incident")}),te=Nt({mutationFn:mf.createCapa,onSuccess:()=>{j.invalidateQueries({queryKey:["hse-capas"]}),v(!1),Ge.success("CAPA created successfully")},onError:()=>Ge.error("Failed to create CAPA")}),be=ve=>{ve.preventDefault();const rt=new FormData(ve.currentTarget),vt={permit_type:rt.get("permit_type"),description:rt.get("description"),location:rt.get("location"),valid_from:rt.get("valid_from"),valid_until:rt.get("valid_until"),status:"pending"};Z.mutate(vt)},ie=ve=>{ve.preventDefault();const rt=new FormData(ve.currentTarget),vt={category:rt.get("category"),severity:rt.get("severity"),description:rt.get("description"),location:rt.get("location"),occurred_at:rt.get("occurred_at"),status:"open"};oe.mutate(vt)},ge=ve=>{ve.preventDefault();const rt=new FormData(ve.currentTarget),vt=rt.get("assigned_to");if(!vt){Ge.error("Please enter a user ID"),ve.currentTarget.reset();return}const gt={type:rt.get("type"),description:rt.get("description"),due_date:rt.get("due_date"),assigned_to:vt,status:"open"};te.mutate(gt)},Ie=((Ue=w==null?void 0:w.data)==null?void 0:Ue.filter(ve=>ve.status==="pending").length)||0,Oe=((tt=R==null?void 0:R.data)==null?void 0:tt.filter(ve=>ve.status==="open").length)||0,Xe=((Ce=I==null?void 0:I.data)==null?void 0:Ce.filter(ve=>ve.status==="open").length)||0;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"HSE Safety Management"}),t.jsx("p",{className:"text-muted-foreground",children:"Health, Safety, and Environment compliance"})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(H,{className:"border-yellow-200 bg-yellow-50",children:[t.jsx(de,{className:"pb-2",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(wne,{className:"h-4 w-4 text-yellow-600"}),"Pending Permits"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:Ie}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting approval"})]})]}),t.jsxs(H,{className:"border-red-200 bg-red-50",children:[t.jsx(de,{className:"pb-2",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(an,{className:"h-4 w-4 text-red-600"}),"Open Incidents"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold text-red-600",children:Oe}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Under investigation"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-2",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(vne,{className:"h-4 w-4"}),"Open CAPAs"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:Xe}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Actions pending"})]})]}),t.jsxs(H,{className:"border-green-200 bg-green-50",children:[t.jsx(de,{className:"pb-2",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(wi,{className:"h-4 w-4 text-green-600"}),"Days Since LTI"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:(W==null?void 0:W.days_since_lti)||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Lost-time injury free"})]})]})]}),t.jsxs(Sn,{defaultValue:"permits",className:"space-y-4",children:[t.jsxs(bn,{children:[t.jsx(kt,{value:"permits",children:"Work Permits"}),t.jsx(kt,{value:"incidents",children:"Incidents"}),t.jsx(kt,{value:"capas",children:"CAPAs"})]}),t.jsx(Dt,{value:"permits",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(he,{children:"Work Permits"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs($t,{value:e.status,onValueChange:ve=>r({...e,status:ve,page:1}),children:[t.jsx(Rt,{className:"w-[200px]",children:t.jsx(Bt,{placeholder:"All Statuses"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All Statuses"}),t.jsx(Ne,{value:"pending",children:"Pending"}),t.jsx(Ne,{value:"approved",children:"Approved"}),t.jsx(Ne,{value:"rejected",children:"Rejected"}),t.jsx(Ne,{value:"closed",children:"Closed"})]})]}),t.jsxs(Or,{open:d,onOpenChange:a,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Request Permit"]})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Request Work Permit"})}),t.jsxs("form",{onSubmit:be,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"permit_type",children:"Permit Type"}),t.jsxs($t,{name:"permit_type",required:!0,children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"hot_work",children:"Hot Work"}),t.jsx(Ne,{value:"confined_space",children:"Confined Space"}),t.jsx(Ne,{value:"working_at_height",children:"Working at Height"}),t.jsx(Ne,{value:"loto",children:"LOTO"}),t.jsx(Ne,{value:"excavation",children:"Excavation"})]})]})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"location",children:"Location"}),t.jsx(Ve,{id:"location",name:"location",required:!0})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"valid_from",children:"Valid From"}),t.jsx(Ve,{id:"valid_from",name:"valid_from",type:"datetime-local",required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"valid_until",children:"Valid Until"}),t.jsx(Ve,{id:"valid_until",name:"valid_until",type:"datetime-local",required:!0})]})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"description",children:"Description"}),t.jsx(ts,{id:"description",name:"description",rows:3,required:!0})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:Z.isPending,children:"Submit Request"})]})]})]})]})]})]})}),t.jsx(Q,{children:k?t.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(w!=null&&w.data)||w.data.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No work permits"}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Permit Type"}),t.jsx(ce,{children:"Description"}),t.jsx(ce,{children:"Valid Period"}),t.jsx(ce,{children:"Requested By"}),t.jsx(ce,{children:"Status"})]})}),t.jsx(mr,{children:w.data.map(ve=>{var rt;return t.jsxs(ut,{children:[t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:ve.permit_type})}),t.jsx(se,{className:"max-w-md truncate",children:ve.description}),t.jsxs(se,{className:"text-sm",children:[new Date(ve.valid_from).toLocaleDateString()," -",t.jsx("br",{}),new Date(ve.valid_until).toLocaleDateString()]}),t.jsx(se,{children:((rt=ve.requested_by_user)==null?void 0:rt.name)||"Unknown"}),t.jsx(se,{children:t.jsx(Ee,{className:Hhe[ve.status],children:ve.status})})]},ve.id)})})]})})]})}),t.jsx(Dt,{value:"incidents",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(he,{children:"Safety Incidents"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs($t,{value:n.status,onValueChange:ve=>s({...n,status:ve,page:1}),children:[t.jsx(Rt,{className:"w-[200px]",children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All Statuses"}),t.jsx(Ne,{value:"open",children:"Open"}),t.jsx(Ne,{value:"investigated",children:"Investigated"}),t.jsx(Ne,{value:"closed",children:"Closed"})]})]}),t.jsxs(Or,{open:f,onOpenChange:p,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Report Incident"]})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Report Safety Incident"})}),t.jsxs("form",{onSubmit:ie,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"category",children:"Category"}),t.jsxs($t,{name:"category",required:!0,children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"injury",children:"Injury"}),t.jsx(Ne,{value:"property_damage",children:"Property Damage"}),t.jsx(Ne,{value:"environmental",children:"Environmental"}),t.jsx(Ne,{value:"near_miss",children:"Near Miss"}),t.jsx(Ne,{value:"other",children:"Other"})]})]})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"severity",children:"Severity"}),t.jsxs($t,{name:"severity",required:!0,children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"minor",children:"Minor"}),t.jsx(Ne,{value:"moderate",children:"Moderate"}),t.jsx(Ne,{value:"serious",children:"Serious"}),t.jsx(Ne,{value:"fatal",children:"Fatal"})]})]})]})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"location",children:"Location"}),t.jsx(Ve,{id:"location",name:"location",required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"occurred_at",children:"Occurred At"}),t.jsx(Ve,{id:"occurred_at",name:"occurred_at",type:"datetime-local",required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"description",children:"Description"}),t.jsx(ts,{id:"description",name:"description",rows:4,required:!0})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>p(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:oe.isPending,children:"Report Incident"})]})]})]})]})]})]})}),t.jsx(Q,{children:D?t.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(R!=null&&R.data)||R.data.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No incidents reported"}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Occurred At"}),t.jsx(ce,{children:"Category"}),t.jsx(ce,{children:"Severity"}),t.jsx(ce,{children:"Location"}),t.jsx(ce,{children:"Reported By"}),t.jsx(ce,{children:"Status"})]})}),t.jsx(mr,{children:R.data.map(ve=>{var rt;return t.jsxs(ut,{children:[t.jsx(se,{children:new Date(ve.occurred_at).toLocaleString()}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:ve.category})}),t.jsx(se,{children:t.jsx(Ee,{className:Zhe[ve.severity],children:ve.severity})}),t.jsx(se,{children:ve.location}),t.jsx(se,{children:((rt=ve.reported_by_user)==null?void 0:rt.name)||"Unknown"}),t.jsx(se,{children:t.jsx(Ee,{variant:ve.status==="closed"?"default":"secondary",children:ve.status})})]},ve.id)})})]})})]})}),t.jsx(Dt,{value:"capas",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(he,{children:"Corrective & Preventive Actions"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs($t,{value:i.status,onValueChange:ve=>l({...i,status:ve,page:1}),children:[t.jsx(Rt,{className:"w-[200px]",children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All Statuses"}),t.jsx(Ne,{value:"open",children:"Open"}),t.jsx(Ne,{value:"completed",children:"Completed"})]})]}),t.jsxs(Or,{open:y,onOpenChange:v,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Create CAPA"]})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Create CAPA"})}),t.jsxs("form",{onSubmit:ge,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"type",children:"Type"}),t.jsxs($t,{name:"type",required:!0,children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"corrective",children:"Corrective Action"}),t.jsx(Ne,{value:"preventive",children:"Preventive Action"})]})]})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"description",children:"Description"}),t.jsx(ts,{id:"description",name:"description",rows:4,required:!0})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"assigned_to",children:"Assign To (User ID)"}),t.jsx(Ve,{id:"assigned_to",name:"assigned_to",type:"number",required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"due_date",children:"Due Date"}),t.jsx(Ve,{id:"due_date",name:"due_date",type:"date",required:!0})]})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>v(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:te.isPending,children:"Create CAPA"})]})]})]})]})]})]})}),t.jsx(Q,{children:L?t.jsx("div",{className:"text-center py-8",children:"Loading..."}):!(I!=null&&I.data)||I.data.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No CAPAs created"}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Type"}),t.jsx(ce,{children:"Description"}),t.jsx(ce,{children:"Assigned To"}),t.jsx(ce,{children:"Due Date"}),t.jsx(ce,{children:"Status"})]})}),t.jsx(mr,{children:I.data.map(ve=>{var vt;const rt=ve.status==="open"&&new Date(ve.due_date)<new Date;return t.jsxs(ut,{children:[t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:ve.type})}),t.jsx(se,{className:"max-w-md truncate",children:ve.description}),t.jsx(se,{children:((vt=ve.assigned_to_user)==null?void 0:vt.name)||"Unassigned"}),t.jsx(se,{children:t.jsxs("span",{className:rt?"text-red-600 font-semibold":"",children:[new Date(ve.due_date).toLocaleDateString(),rt&&" (Overdue)"]})}),t.jsx(se,{children:t.jsx(Ee,{variant:ve.status==="completed"?"default":"secondary",children:ve.status})})]},ve.id)})})]})})]})})]})]})}function Xhe(){return t.jsxs("div",{className:"flex min-h-screen",children:[t.jsx(Ia,{}),t.jsx("main",{className:"flex-1 p-8 overflow-auto",children:t.jsx(Oa,{})})]})}function Qhe({open:e,onOpenChange:r,parameter:n}){const s=Sr(),i=!!n,{register:l,handleSubmit:d,reset:a,setValue:f,formState:{errors:p}}=yi({defaultValues:n||{category:"physical"}}),y=Nt({mutationFn:w=>xe.post("/v1/water-quality/parameters",w),onSuccess:()=>{s.invalidateQueries({queryKey:["water-quality-parameters"]}),Ge.success("Parameter created successfully"),r(!1),a()},onError:w=>{Ge.error(w.message||"Failed to create parameter")}}),v=Nt({mutationFn:w=>xe.patch(`/v1/water-quality/parameters/${n.id}`,w),onSuccess:()=>{s.invalidateQueries({queryKey:["water-quality-parameters"]}),Ge.success("Parameter updated successfully"),r(!1)},onError:w=>{Ge.error(w.message||"Failed to update parameter")}}),j=w=>{const k={...w,who_limit:w.who_limit||void 0,wasreb_limit:w.wasreb_limit||void 0,local_limit:w.local_limit||void 0,lod:w.lod||void 0,precision:w.precision||void 0};i?v.mutate(k):y.mutate(k)};return O.useEffect(()=>{a(n||{category:"physical"})},[n,a]),t.jsx(Or,{open:e,onOpenChange:r,children:t.jsxs(kr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:i?"Edit Parameter":"Create New Parameter"}),t.jsx(Pi,{children:i?"Update water quality parameter":"Add a new water quality parameter"})]}),t.jsxs("form",{onSubmit:d(j),className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"name",children:"Parameter Name *"}),t.jsx(Ve,{id:"name",...l("name",{required:!0}),placeholder:"e.g., pH"}),p.name&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"code",children:"Code *"}),t.jsx(Ve,{id:"code",...l("code",{required:!0}),placeholder:"e.g., PH"}),p.code&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"category",children:"Category *"}),t.jsxs($t,{onValueChange:w=>f("category",w),defaultValue:(n==null?void 0:n.category)||"physical",children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select category"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"physical",children:"Physical"}),t.jsx(Ne,{value:"chemical",children:"Chemical"}),t.jsx(Ne,{value:"biological",children:"Biological"}),t.jsx(Ne,{value:"radiological",children:"Radiological"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"unit",children:"Unit *"}),t.jsx(Ve,{id:"unit",...l("unit",{required:!0}),placeholder:"e.g., mg/L, CFU/100mL, pH units"}),p.unit&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"who_limit",children:"WHO Limit"}),t.jsx(Ve,{id:"who_limit",type:"number",step:"any",...l("who_limit"),placeholder:"Optional"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"wasreb_limit",children:"WASREB Limit"}),t.jsx(Ve,{id:"wasreb_limit",type:"number",step:"any",...l("wasreb_limit"),placeholder:"Optional"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"local_limit",children:"Local Limit"}),t.jsx(Ve,{id:"local_limit",type:"number",step:"any",...l("local_limit"),placeholder:"Optional"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"lod",children:"Limit of Detection (LOD)"}),t.jsx(Ve,{id:"lod",type:"number",step:"any",...l("lod"),placeholder:"Optional"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"precision",children:"Precision"}),t.jsx(Ve,{id:"precision",type:"number",step:"1",...l("precision"),placeholder:"Decimal places (e.g., 2)"})]})]}),t.jsxs(Ji,{children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:y.isPending||v.isPending,children:y.isPending||v.isPending?"Saving...":i?"Update":"Create"})]})]})]})})}function Jhe(){var w;const[e,r]=O.useState(1),[n,s]=O.useState(!1),[i,l]=O.useState(void 0),d=Sr(),{data:a,isLoading:f}=ct({queryKey:["water-quality-parameters",e],queryFn:async()=>xe.get("/v1/water-quality/parameters",{page:e,per_page:20})}),p=Nt({mutationFn:k=>xe.delete(`/v1/water-quality/parameters/${k}`),onSuccess:()=>{d.invalidateQueries({queryKey:["water-quality-parameters"]}),Ge.success("Parameter deleted successfully")},onError:k=>{Ge.error(k.message||"Failed to delete parameter")}}),y=k=>{l(k),s(!0)},v=k=>{confirm("Are you sure you want to delete this parameter?")&&p.mutate(k)},j=()=>{l(void 0),s(!0)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Water Quality Parameters"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage physical, chemical, and biological parameters for water quality testing"})]}),t.jsxs(X,{onClick:j,children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Add Parameter"]})]}),t.jsx(Qhe,{open:n,onOpenChange:s,parameter:i}),f?t.jsx("div",{className:"text-center py-12",children:"Loading parameters..."}):t.jsx("div",{className:"grid gap-4",children:(w=a==null?void 0:a.data)==null?void 0:w.map(k=>t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(he,{className:"text-xl",children:k.name}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Ee,{variant:"outline",children:k.category||"physical"}),t.jsx(Ee,{variant:"secondary",children:k.unit})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{variant:"ghost",size:"sm",onClick:()=>y(k),children:t.jsx(NV,{className:"h-4 w-4"})}),t.jsx(X,{variant:"ghost",size:"sm",onClick:()=>v(k.id),children:t.jsx(As,{className:"h-4 w-4"})})]})]})}),t.jsx(Q,{children:t.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"WHO Limit:"}),t.jsx("p",{className:"font-medium",children:k.who_limit?`${k.who_limit} ${k.unit}`:"N/A"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"WASREB Limit:"}),t.jsx("p",{className:"font-medium",children:k.wasreb_limit?`${k.wasreb_limit} ${k.unit}`:"N/A"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Local Limit:"}),t.jsx("p",{className:"font-medium",children:k.local_limit?`${k.local_limit} ${k.unit}`:"N/A"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"LOD:"}),t.jsx("p",{className:"font-medium",children:k.lod?`${k.lod} ${k.unit}`:"N/A"})]})]})})]},k.id))}),(a==null?void 0:a.meta)&&t.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",a.meta.from," to ",a.meta.to," of ",a.meta.total," parameters"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{variant:"outline",size:"sm",disabled:e===1,onClick:()=>r(k=>k-1),children:"Previous"}),t.jsx(X,{variant:"outline",size:"sm",disabled:e>=a.meta.last_page,onClick:()=>r(k=>k+1),children:"Next"})]})]})]})}var qI="Checkbox",[eme]=Ou(qI),[tme,rme]=eme(qI),a7=O.forwardRef((e,r)=>{const{__scopeCheckbox:n,name:s,checked:i,defaultChecked:l,required:d,disabled:a,value:f="on",onCheckedChange:p,form:y,...v}=e,[j,w]=O.useState(null),k=yn(r,L=>w(L)),S=O.useRef(!1),R=j?y||!!j.closest("form"):!0,[D=!1,T]=Nu({prop:i,defaultProp:l,onChange:p}),I=O.useRef(D);return O.useEffect(()=>{const L=j==null?void 0:j.form;if(L){const $=()=>T(I.current);return L.addEventListener("reset",$),()=>L.removeEventListener("reset",$)}},[j,T]),t.jsxs(tme,{scope:n,state:D,disabled:a,children:[t.jsx(zr.button,{type:"button",role:"checkbox","aria-checked":sm(D)?"mixed":D,"aria-required":d,"data-state":c7(D),"data-disabled":a?"":void 0,disabled:a,value:f,...v,ref:k,onKeyDown:ar(e.onKeyDown,L=>{L.key==="Enter"&&L.preventDefault()}),onClick:ar(e.onClick,L=>{T($=>sm($)?!0:!$),R&&(S.current=L.isPropagationStopped(),S.current||L.stopPropagation())})}),R&&t.jsx(nme,{control:j,bubbles:!S.current,name:s,value:f,checked:D,required:d,disabled:a,form:y,style:{transform:"translateX(-100%)"},defaultChecked:sm(l)?!1:l})]})});a7.displayName=qI;var o7="CheckboxIndicator",l7=O.forwardRef((e,r)=>{const{__scopeCheckbox:n,forceMount:s,...i}=e,l=rme(o7,n);return t.jsx(Do,{present:s||sm(l.state)||l.state===!0,children:t.jsx(zr.span,{"data-state":c7(l.state),"data-disabled":l.disabled?"":void 0,...i,ref:r,style:{pointerEvents:"none",...e.style}})})});l7.displayName=o7;var nme=e=>{const{control:r,checked:n,bubbles:s=!0,defaultChecked:i,...l}=e,d=O.useRef(null),a=A2(n),f=S2(r);O.useEffect(()=>{const y=d.current,v=window.HTMLInputElement.prototype,w=Object.getOwnPropertyDescriptor(v,"checked").set;if(a!==n&&w){const k=new Event("click",{bubbles:s});y.indeterminate=sm(n),w.call(y,sm(n)?!1:n),y.dispatchEvent(k)}},[a,n,s]);const p=O.useRef(sm(n)?!1:n);return t.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i??p.current,...l,tabIndex:-1,ref:d,style:{...e.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function sm(e){return e==="indeterminate"}function c7(e){return sm(e)?"indeterminate":e?"checked":"unchecked"}var d7=a7,sme=l7;const Nm=O.forwardRef(({className:e,...r},n)=>t.jsx(d7,{ref:n,className:gr("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...r,children:t.jsx(sme,{className:gr("flex items-center justify-center text-current"),children:t.jsx(_u,{className:"h-4 w-4"})})}));Nm.displayName=d7.displayName;function ime({open:e,onOpenChange:r,point:n}){var S,R,D,T,I,L;const s=Sr(),i=!!n,{register:l,handleSubmit:d,reset:a,setValue:f,watch:p,formState:{errors:y}}=yi({defaultValues:n?{...n,latitude:(R=(S=n.location)==null?void 0:S.coordinates)==null?void 0:R[1],longitude:(T=(D=n.location)==null?void 0:D.coordinates)==null?void 0:T[0]}:{kind:"source",is_active:!0}}),{data:v}=ct({queryKey:["schemes-for-sampling-point"],queryFn:async()=>xe.get("/v1/schemes",{per_page:200})}),j=Nt({mutationFn:$=>xe.post("/v1/water-quality/sampling-points",$),onSuccess:()=>{s.invalidateQueries({queryKey:["water-quality-sampling-points"]}),Ge.success("Sampling point created successfully"),r(!1),a()},onError:$=>{Ge.error($.message||"Failed to create sampling point")}}),w=Nt({mutationFn:$=>xe.patch(`/v1/water-quality/sampling-points/${n.id}`,$),onSuccess:()=>{s.invalidateQueries({queryKey:["water-quality-sampling-points"]}),Ge.success("Sampling point updated successfully"),r(!1)},onError:$=>{Ge.error($.message||"Failed to update sampling point")}}),k=$=>{const W={name:$.name,code:$.code,kind:$.kind,scheme_id:$.scheme_id||void 0,latitude:parseFloat($.latitude),longitude:parseFloat($.longitude),elevation_m:$.elevation_m?parseFloat($.elevation_m):void 0,is_active:$.is_active};i?w.mutate(W):j.mutate(W)};return O.useEffect(()=>{var $,W,Z,oe;a(n?{...n,latitude:(W=($=n.location)==null?void 0:$.coordinates)==null?void 0:W[1],longitude:(oe=(Z=n.location)==null?void 0:Z.coordinates)==null?void 0:oe[0]}:{kind:"source",is_active:!0})},[n,a]),t.jsx(Or,{open:e,onOpenChange:r,children:t.jsxs(kr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:i?"Edit Sampling Point":"Create New Sampling Point"}),t.jsx(Pi,{children:i?"Update sampling point information":"Add a new sampling point with GPS location"})]}),t.jsxs("form",{onSubmit:d(k),className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"name",children:"Point Name *"}),t.jsx(Ve,{id:"name",...l("name",{required:!0}),placeholder:"e.g., Borehole #1"}),y.name&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"code",children:"Code *"}),t.jsx(Ve,{id:"code",...l("code",{required:!0}),placeholder:"e.g., BH-001"}),y.code&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"kind",children:"Point Kind *"}),t.jsxs($t,{onValueChange:$=>f("kind",$),defaultValue:(n==null?void 0:n.kind)||"source",children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select kind"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"source",children:"Source"}),t.jsx(Ne,{value:"treatment",children:"Treatment"}),t.jsx(Ne,{value:"reservoir",children:"Reservoir"}),t.jsx(Ne,{value:"distribution",children:"Distribution"}),t.jsx(Ne,{value:"kiosk",children:"Kiosk"}),t.jsx(Ne,{value:"household",children:"Household"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"scheme_id",children:"Scheme"}),t.jsxs($t,{onValueChange:$=>f("scheme_id",$&&$!=="none"?Number($):void 0),defaultValue:((I=n==null?void 0:n.scheme_id)==null?void 0:I.toString())||"none",children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select scheme"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"none",children:"None"}),(L=v==null?void 0:v.data)==null?void 0:L.map($=>t.jsx(Ne,{value:$.id.toString(),children:$.name},$.id))]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"latitude",children:"Latitude *"}),t.jsx(Ve,{id:"latitude",type:"number",step:"any",...l("latitude",{required:!0}),placeholder:"e.g., -1.2921"}),y.latitude&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"longitude",children:"Longitude *"}),t.jsx(Ve,{id:"longitude",type:"number",step:"any",...l("longitude",{required:!0}),placeholder:"e.g., 36.8219"}),y.longitude&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"elevation_m",children:"Elevation (m)"}),t.jsx(Ve,{id:"elevation_m",type:"number",step:"any",...l("elevation_m"),placeholder:"Optional"})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Nm,{id:"is_active",checked:p("is_active"),onCheckedChange:$=>f("is_active",$)}),t.jsx(Me,{htmlFor:"is_active",className:"cursor-pointer",children:"Active sampling point"})]}),t.jsxs(Ji,{children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:j.isPending||w.isPending,children:j.isPending||w.isPending?"Saving...":i?"Update":"Create"})]})]})]})})}const UF={source:"#3b82f6",treatment:"#8b5cf6",reservoir:"#10b981",distribution:"#eab308",kiosk:"#f97316",household:"#ec4899"};function ame({points:e,onPointSelect:r}){const n=O.useRef(null),s=O.useRef(null),i=O.useRef([]),[l,d]=O.useState(null);O.useEffect(()=>{if(!(!n.current||s.current))return s.current=new Pl.Map({container:n.current,style:{version:8,sources:{"osm-tiles":{type:"raster",tiles:["https://tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:"&copy; OpenStreetMap contributors"}},layers:[{id:"osm-tiles",type:"raster",source:"osm-tiles",minzoom:0,maxzoom:19}]},center:[36.8219,-1.2921],zoom:8}),s.current.addControl(new Pl.NavigationControl,"top-right"),s.current.addControl(new Pl.ScaleControl,"bottom-left"),()=>{var f;i.current.forEach(p=>p.remove()),i.current=[],(f=s.current)==null||f.remove(),s.current=null}},[]),O.useEffect(()=>{if(!s.current||!(e!=null&&e.length))return;i.current.forEach(p=>p.remove()),i.current=[];const f=e.filter(p=>{var y;return(y=p.location)==null?void 0:y.coordinates});if(f.length!==0&&(f.forEach(p=>{var j;if(!((j=p.location)!=null&&j.coordinates))return;const y=document.createElement("div");y.className="sampling-point-marker",y.style.width="28px",y.style.height="28px",y.style.borderRadius="50%",y.style.backgroundColor=UF[p.kind]||"#6b7280",y.style.border=p.is_active?"3px solid white":"3px solid #ef4444",y.style.boxShadow="0 2px 6px rgba(0,0,0,0.3)",y.style.cursor="pointer",y.style.opacity=p.is_active?"1":"0.6";const v=new Pl.Marker({element:y}).setLngLat(p.location.coordinates).addTo(s.current);i.current.push(v),y.addEventListener("click",()=>{var w;d(p),r==null||r(p),(w=s.current)==null||w.flyTo({center:p.location.coordinates,zoom:14,duration:1e3})})}),f.length>0)){const p=new Pl.LngLatBounds;f.forEach(y=>{var v;(v=y.location)!=null&&v.coordinates&&p.extend(y.location.coordinates)}),s.current.fitBounds(p,{padding:50,maxZoom:14})}},[e,r]);const a=()=>{d(null),r==null||r(null)};return t.jsxs("div",{className:"relative h-96 w-full",children:[t.jsx("div",{className:"absolute top-4 left-4 z-10",children:t.jsx(H,{className:"max-w-xs",children:t.jsxs(Q,{className:"p-4",children:[t.jsx("h3",{className:"text-sm font-bold mb-3",children:"Sampling Point Types"}),t.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(UF).map(([f,p])=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:p,border:"2px solid white"}}),t.jsx("span",{className:"text-xs capitalize",children:f})]},f))}),t.jsxs("div",{className:"mt-3 pt-3 border-t",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-400",style:{border:"2px solid white"}}),t.jsx("span",{className:"text-xs",children:"Active"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-400 opacity-60",style:{border:"2px solid #ef4444"}}),t.jsx("span",{className:"text-xs",children:"Inactive"})]})]})]})})}),l&&t.jsx("div",{className:"absolute top-4 right-4 z-10 w-80",children:t.jsx(H,{children:t.jsxs(Q,{className:"p-4",children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{className:"space-y-1 flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("h3",{className:"font-bold",children:l.name}),t.jsx(Ee,{variant:l.is_active?"default":"destructive",className:"text-xs",children:l.is_active?"Active":"Inactive"})]}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Code: ",l.code]})]}),t.jsx(X,{variant:"ghost",size:"sm",onClick:a,children:t.jsx(bm,{className:"h-4 w-4"})})]}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsx(Ee,{className:"capitalize",variant:"outline",children:l.kind})}),t.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[t.jsx(Ma,{className:"h-4 w-4"}),t.jsxs("span",{children:[l.location.coordinates[1].toFixed(6),", ",l.location.coordinates[0].toFixed(6)]})]}),l.elevation_m&&t.jsxs("div",{className:"text-muted-foreground",children:[t.jsx("span",{className:"font-medium",children:"Elevation:"})," ",l.elevation_m,"m"]}),l.scheme&&t.jsxs("div",{className:"text-muted-foreground",children:[t.jsx("span",{className:"font-medium",children:"Scheme:"})," ",l.scheme.name]})]})]})})}),t.jsx("div",{ref:n,className:"h-full w-full rounded-lg"})]})}function ome(){var R;const[e,r]=O.useState(1),[n,s]=O.useState(!1),[i,l]=O.useState(!1),[d,a]=O.useState(void 0),f=Sr(),{data:p,isLoading:y}=ct({queryKey:["water-quality-sampling-points",e],queryFn:async()=>xe.get("/v1/water-quality/sampling-points",{page:e,per_page:20})}),v={source:"bg-blue-100 text-blue-800",treatment:"bg-purple-100 text-purple-800",reservoir:"bg-green-100 text-green-800",distribution:"bg-yellow-100 text-yellow-800",kiosk:"bg-orange-100 text-orange-800",household:"bg-pink-100 text-pink-800"},j=Nt({mutationFn:D=>xe.delete(`/v1/water-quality/sampling-points/${D}`),onSuccess:()=>{f.invalidateQueries({queryKey:["water-quality-sampling-points"]}),Ge.success("Sampling point deleted successfully")},onError:D=>{Ge.error(D.message||"Failed to delete sampling point")}}),w=D=>{a(D),l(!0)},k=D=>{confirm("Are you sure you want to delete this sampling point?")&&j.mutate(D)},S=()=>{a(void 0),l(!0)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Sampling Points"}),t.jsx("p",{className:"text-muted-foreground",children:"Geographic locations where water samples are collected"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(X,{variant:"outline",onClick:()=>s(!n),children:[t.jsx(iu,{className:"h-4 w-4 mr-2"}),n?"Hide Map":"Show Map"]}),t.jsxs(X,{onClick:S,children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Add Sampling Point"]})]})]}),t.jsx(ime,{open:i,onOpenChange:l,point:d}),n&&t.jsx(H,{children:t.jsx(Q,{className:"p-0",children:t.jsx(ame,{points:(p==null?void 0:p.data)||[],onPointSelect:D=>{D&&console.log("Selected point:",D)}})})}),y?t.jsx("div",{className:"text-center py-12",children:"Loading sampling points..."}):t.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:(R=p==null?void 0:p.data)==null?void 0:R.map(D=>{var T,I,L,$;return t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(he,{className:"text-lg",children:D.name}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Code: ",D.code]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{variant:"ghost",size:"sm",onClick:()=>w(D),children:t.jsx(NV,{className:"h-4 w-4"})}),t.jsx(X,{variant:"ghost",size:"sm",onClick:()=>k(D.id),children:t.jsx(As,{className:"h-4 w-4"})})]})]})}),t.jsxs(Q,{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ee,{className:v[D.kind]||"bg-gray-100 text-gray-800",children:D.kind}),!D.is_active&&t.jsx(Ee,{variant:"destructive",children:"Inactive"})]}),D.location&&t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[t.jsx(Ma,{className:"h-4 w-4"}),t.jsxs("span",{children:[(I=(T=D.location.coordinates)==null?void 0:T[1])==null?void 0:I.toFixed(4),", ",($=(L=D.location.coordinates)==null?void 0:L[0])==null?void 0:$.toFixed(4)]})]}),D.elevation_m&&t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Elevation: ",D.elevation_m,"m"]}),D.scheme&&t.jsxs("p",{className:"text-sm",children:[t.jsx("span",{className:"text-muted-foreground",children:"Scheme:"})," ",D.scheme.name]})]})]},D.id)})}),(p==null?void 0:p.meta)&&t.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",p.meta.from," to ",p.meta.to," of ",p.meta.total," sampling points"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{variant:"outline",size:"sm",disabled:e===1,onClick:()=>r(D=>D-1),children:"Previous"}),t.jsx(X,{variant:"outline",size:"sm",disabled:e>=p.meta.last_page,onClick:()=>r(D=>D+1),children:"Next"})]})]})]})}function lme({open:e,onOpenChange:r,plan:n}){const s=Sr(),i=!!n,{register:l,handleSubmit:d,reset:a,setValue:f,watch:p,formState:{errors:y}}=yi({defaultValues:n||{frequency:"monthly",is_active:!1}}),v=Nt({mutationFn:k=>xe.post("/v1/water-quality/plans",k),onSuccess:()=>{s.invalidateQueries({queryKey:["water-quality-plans"]}),Ge.success("Sampling plan created successfully"),r(!1),a()},onError:k=>{Ge.error(k.message||"Failed to create plan")}}),j=Nt({mutationFn:k=>xe.patch(`/v1/water-quality/plans/${n.id}`,k),onSuccess:()=>{s.invalidateQueries({queryKey:["water-quality-plans"]}),Ge.success("Sampling plan updated successfully"),r(!1)},onError:k=>{Ge.error(k.message||"Failed to update plan")}}),w=k=>{const S={...k,end_date:k.end_date||void 0};i?j.mutate(S):v.mutate(S)};return O.useEffect(()=>{var k,S;a(n?{...n,start_date:(k=n.start_date)==null?void 0:k.split("T")[0],end_date:(S=n.end_date)==null?void 0:S.split("T")[0]}:{frequency:"monthly",is_active:!1})},[n,a]),t.jsx(Or,{open:e,onOpenChange:r,children:t.jsxs(kr,{className:"max-w-lg",children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:i?"Edit Plan":"Create New Plan"}),t.jsx(Pi,{children:i?"Update sampling plan details":"Create a new water quality sampling plan"})]}),t.jsxs("form",{onSubmit:d(w),className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"name",children:"Plan Name *"}),t.jsx(Ve,{id:"name",...l("name",{required:!0}),placeholder:"e.g., Q1 2024 Monitoring"}),y.name&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"frequency",children:"Sampling Frequency *"}),t.jsxs($t,{onValueChange:k=>f("frequency",k),defaultValue:(n==null?void 0:n.frequency)||"monthly",children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select frequency"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"daily",children:"Daily"}),t.jsx(Ne,{value:"weekly",children:"Weekly"}),t.jsx(Ne,{value:"monthly",children:"Monthly"}),t.jsx(Ne,{value:"quarterly",children:"Quarterly"}),t.jsx(Ne,{value:"annual",children:"Annual"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"start_date",children:"Start Date *"}),t.jsx(Ve,{id:"start_date",type:"date",...l("start_date",{required:!0})}),y.start_date&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"end_date",children:"End Date"}),t.jsx(Ve,{id:"end_date",type:"date",...l("end_date")})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Nm,{id:"is_active",checked:p("is_active"),onCheckedChange:k=>f("is_active",k)}),t.jsx(Me,{htmlFor:"is_active",className:"cursor-pointer",children:"Activate plan immediately"})]}),t.jsxs(Ji,{children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:v.isPending||j.isPending,children:v.isPending||j.isPending?"Saving...":i?"Update":"Create"})]})]})]})})}function cme(){var k;const[e,r]=O.useState(1),[n,s]=O.useState(!1),[i,l]=O.useState(void 0),d=Sr(),{data:a,isLoading:f}=ct({queryKey:["water-quality-plans",e],queryFn:async()=>xe.get("/v1/water-quality/plans",{page:e,per_page:20})}),p=Nt({mutationFn:S=>xe.post(`/v1/water-quality/plans/${S}/activate`,{}),onSuccess:()=>{d.invalidateQueries({queryKey:["water-quality-plans"]}),Ge.success("Plan activated successfully")},onError:S=>{Ge.error(S.message||"Failed to activate plan")}}),y=Nt({mutationFn:S=>xe.post(`/v1/water-quality/plans/${S}/generate-samples`,{}),onSuccess:S=>{d.invalidateQueries({queryKey:["water-quality-samples"]}),Ge.success(`Generated ${S.generated||0} samples successfully`)},onError:S=>{Ge.error(S.message||"Failed to generate samples")}}),v=S=>{p.mutate(S)},j=S=>{y.mutate(S)},w=()=>{l(void 0),s(!0)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Sampling Plans"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage quarterly and annual water quality monitoring plans"})]}),t.jsxs(X,{onClick:w,children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Create Plan"]})]}),t.jsx(lme,{open:n,onOpenChange:s,plan:i}),f?t.jsx("div",{className:"text-center py-12",children:"Loading plans..."}):t.jsx("div",{className:"grid gap-4",children:(k=a==null?void 0:a.data)==null?void 0:k.map(S=>t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Oo,{className:"h-5 w-5 text-muted-foreground"}),t.jsx(he,{className:"text-xl",children:S.name})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Ee,{variant:S.is_active?"default":"secondary",children:S.is_active?"Active":"Inactive"}),t.jsx(Ee,{variant:"outline",children:S.frequency||"quarterly"})]})]}),t.jsxs("div",{className:"flex gap-2",children:[!S.is_active&&t.jsxs(X,{size:"sm",variant:"default",onClick:()=>v(S.id),disabled:p.isPending,children:[t.jsx(yne,{className:"h-4 w-4 mr-1"}),"Activate"]}),t.jsx(X,{size:"sm",variant:"outline",onClick:()=>j(S.id),disabled:y.isPending,children:"Generate Samples"})]})]})}),t.jsxs(Q,{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Start Date:"}),t.jsx("p",{className:"font-medium",children:S.start_date?wn(new Date(S.start_date),"PP"):"N/A"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"End Date:"}),t.jsx("p",{className:"font-medium",children:S.end_date?wn(new Date(S.end_date),"PP"):"N/A"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Rules:"}),t.jsxs("p",{className:"font-medium",children:[S.rules_count||0," defined"]})]})]}),S.description&&t.jsx("p",{className:"text-sm text-muted-foreground",children:S.description})]})]},S.id))}),(a==null?void 0:a.meta)&&t.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",a.meta.from," to ",a.meta.to," of ",a.meta.total," plans"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{variant:"outline",size:"sm",disabled:e===1,onClick:()=>r(S=>S-1),children:"Previous"}),t.jsx(X,{variant:"outline",size:"sm",disabled:e>=a.meta.last_page,onClick:()=>r(S=>S+1),children:"Next"})]})]})]})}function dme({open:e,onOpenChange:r,sample:n}){const s=Sr(),{register:i,handleSubmit:l,reset:d,formState:{errors:a}}=yi(),f=Nt({mutationFn:y=>xe.post(`/v1/water-quality/samples/${n.id}/collect`,y),onSuccess:()=>{s.invalidateQueries({queryKey:["water-quality-samples"]}),Ge.success("Sample collected successfully"),r(!1),d()},onError:y=>{Ge.error(y.message||"Failed to collect sample")}}),p=y=>{f.mutate({...y,field_temp:y.field_temp?parseFloat(y.field_temp):void 0,field_ph:y.field_ph?parseFloat(y.field_ph):void 0,field_chlorine:y.field_chlorine?parseFloat(y.field_chlorine):void 0})};return t.jsx(Or,{open:e,onOpenChange:r,children:t.jsxs(kr,{className:"max-w-lg",children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:"Collect Sample"}),t.jsxs(Pi,{children:["Record field collection details for ",n==null?void 0:n.barcode]})]}),t.jsxs("form",{onSubmit:l(p),className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"collected_by",children:"Collected By *"}),t.jsx(Ve,{id:"collected_by",...i("collected_by",{required:!0}),placeholder:"Field officer name"}),a.collected_by&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"field_temp",children:"Temp (C)"}),t.jsx(Ve,{id:"field_temp",type:"number",step:"0.1",...i("field_temp"),placeholder:"Optional"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"field_ph",children:"pH"}),t.jsx(Ve,{id:"field_ph",type:"number",step:"0.1",...i("field_ph"),placeholder:"Optional"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"field_chlorine",children:"Cl (mg/L)"}),t.jsx(Ve,{id:"field_chlorine",type:"number",step:"0.01",...i("field_chlorine"),placeholder:"Optional"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"field_notes",children:"Field Notes"}),t.jsx(ts,{id:"field_notes",...i("field_notes"),placeholder:"Any observations during collection...",rows:3})]}),t.jsxs(Ji,{children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:f.isPending,children:f.isPending?"Collecting...":"Collect Sample"})]})]})]})})}function ume({open:e,onOpenChange:r,sample:n}){const s=Sr(),{register:i,handleSubmit:l,reset:d,formState:{errors:a}}=yi(),f=Nt({mutationFn:y=>xe.post(`/v1/water-quality/samples/${n.id}/receive-lab`,y),onSuccess:()=>{s.invalidateQueries({queryKey:["water-quality-samples"]}),Ge.success("Sample received in lab successfully"),r(!1),d()},onError:y=>{Ge.error(y.message||"Failed to receive sample")}}),p=y=>{f.mutate(y)};return t.jsx(Or,{open:e,onOpenChange:r,children:t.jsxs(kr,{className:"max-w-lg",children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:"Receive Sample in Lab"}),t.jsxs(Pi,{children:["Record lab receipt details for ",n==null?void 0:n.barcode]})]}),t.jsxs("form",{onSubmit:l(p),className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"received_by",children:"Received By *"}),t.jsx(Ve,{id:"received_by",...i("received_by",{required:!0}),placeholder:"Lab technician name"}),a.received_by&&t.jsx("p",{className:"text-sm text-red-500",children:"Required"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"container_condition",children:"Container Condition"}),t.jsx(Ve,{id:"container_condition",...i("container_condition"),placeholder:"e.g., Good, Intact, No leaks"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"preservation_check",children:"Preservation Check"}),t.jsx(Ve,{id:"preservation_check",...i("preservation_check"),placeholder:"e.g., Properly preserved, Ice pack present"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"lab_notes",children:"Lab Notes"}),t.jsx(ts,{id:"lab_notes",...i("lab_notes"),placeholder:"Any observations upon receipt...",rows:3})]}),t.jsxs(Ji,{children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:f.isPending,children:f.isPending?"Receiving...":"Receive Sample"})]})]})]})})}function hme(){var k;const[e,r]=O.useState(1),[n,s]=O.useState(""),[i,l]=O.useState(!1),[d,a]=O.useState(!1),[f,p]=O.useState(null),{data:y,isLoading:v}=ct({queryKey:["water-quality-samples",e],queryFn:async()=>xe.get("/v1/water-quality/samples",{page:e,per_page:20})}),j={scheduled:"bg-gray-100 text-gray-800",collected:"bg-blue-100 text-blue-800",received_lab:"bg-purple-100 text-purple-800",in_analysis:"bg-yellow-100 text-yellow-800",reported:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"},w=S=>{p(S),a(!0)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Samples"}),t.jsx("p",{className:"text-muted-foreground",children:"Track water samples from field collection to lab reporting"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Create Sample"]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-lg",children:"Search by Barcode"})}),t.jsx(Q,{children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Ve,{placeholder:"Enter barcode (e.g., WQ20240101-ABC123)",value:n,onChange:S=>s(S.target.value)}),t.jsxs(X,{children:[t.jsx(di,{className:"h-4 w-4 mr-2"}),"Search"]})]})})]}),v?t.jsx("div",{className:"text-center py-12",children:"Loading samples..."}):t.jsx("div",{className:"grid gap-4",children:(k=y==null?void 0:y.data)==null?void 0:k.map(S=>{var R,D;return t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(gc,{className:"h-5 w-5 text-blue-500"}),t.jsx(he,{className:"text-lg",children:((R=S.sampling_point)==null?void 0:R.name)||"Unknown Point"})]}),t.jsx("p",{className:"text-sm text-muted-foreground font-mono",children:S.barcode})]}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx(Ee,{className:j[S.custody_state]||"bg-gray-100",children:((D=S.custody_state)==null?void 0:D.replace("_"," "))||"scheduled"}),S.custody_state==="collected"&&t.jsxs(X,{size:"sm",variant:"outline",onClick:()=>w(S),children:[t.jsx(Pne,{className:"h-4 w-4 mr-1"}),"Receive in Lab"]})]})]})}),t.jsxs(Q,{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Scheduled:"}),t.jsx("p",{className:"font-medium",children:S.scheduled_at?wn(new Date(S.scheduled_at),"PP"):"N/A"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Collected:"}),t.jsx("p",{className:"font-medium",children:S.collected_at?wn(new Date(S.collected_at),"PP"):"Pending"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Parameters:"}),t.jsxs("p",{className:"font-medium",children:[S.parameters_count||0," tests"]})]})]}),S.collected_by&&t.jsxs("p",{className:"text-sm",children:[t.jsx("span",{className:"text-muted-foreground",children:"Collected by:"})," ",S.collected_by]}),S.custody_chain&&S.custody_chain.length>0&&t.jsxs("div",{className:"text-sm",children:[t.jsx("p",{className:"text-muted-foreground mb-1",children:"Custody Chain:"}),t.jsxs("div",{className:"bg-muted p-2 rounded text-xs font-mono",children:[S.custody_chain.length," transfer(s) recorded"]})]})]})]},S.id)})}),(y==null?void 0:y.meta)&&t.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",y.meta.from," to ",y.meta.to," of ",y.meta.total," samples"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{variant:"outline",size:"sm",disabled:e===1,onClick:()=>r(S=>S-1),children:"Previous"}),t.jsx(X,{variant:"outline",size:"sm",disabled:e>=y.meta.last_page,onClick:()=>r(S=>S+1),children:"Next"})]})]}),f&&t.jsxs(t.Fragment,{children:[t.jsx(dme,{open:i,onOpenChange:l,sample:f}),t.jsx(ume,{open:d,onOpenChange:a,sample:f})]})]})}function mme({open:e,onOpenChange:r}){const n=Sr(),s=O.useRef(null),[i,l]=O.useState(null),[d,a]=O.useState(null),f=Nt({mutationFn:async j=>{const w=new FormData;w.append("file",j);const S=await fetch("/api/v1/v1/water-quality/results/import-csv",{method:"POST",body:w,credentials:"include"});if(!S.ok){const R=await S.json().catch(()=>({message:"Import failed"}));throw new Error(R.message||"Import failed")}return S.json()},onSuccess:j=>{n.invalidateQueries({queryKey:["water-quality-results"]}),a(j),Ge.success(`Successfully imported ${j.imported||0} results`)},onError:j=>{var w,k;Ge.error(j.message||"Failed to import CSV file"),a({errors:((k=(w=j.response)==null?void 0:w.data)==null?void 0:k.errors)||["Import failed"]})}}),p=j=>{var k;const w=(k=j.target.files)==null?void 0:k[0];if(w){if(w.type!=="text/csv"&&!w.name.endsWith(".csv")){Ge.error("Please select a CSV file");return}if(w.size>5*1024*1024){Ge.error("File size must be less than 5MB");return}l(w),a(null)}},y=()=>{if(!i){Ge.error("Please select a file first");return}f.mutate(i)},v=()=>{l(null),a(null),s.current&&(s.current.value=""),r(!1)};return t.jsx(Or,{open:e,onOpenChange:v,children:t.jsxs(kr,{className:"max-w-lg",children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:"Import Lab Results from CSV"}),t.jsx(Pi,{children:"Upload a CSV file containing lab test results. File must include columns: sample_barcode, parameter_code, value, uncertainty, method, analyst, analyzed_at"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"csv-file",children:"CSV File"}),t.jsx(Ve,{ref:s,id:"csv-file",type:"file",accept:".csv",onChange:p}),i&&t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mt-2",children:[t.jsx($n,{className:"h-4 w-4"}),t.jsxs("span",{children:[i.name," (",(i.size/1024).toFixed(1)," KB)"]})]})]}),d&&t.jsx(fa,{variant:d.errors?"destructive":"default",children:d.errors?t.jsxs(t.Fragment,{children:[t.jsx(ps,{className:"h-4 w-4"}),t.jsxs(ta,{children:[t.jsx("p",{className:"font-semibold mb-2",children:"Import Errors:"}),t.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[d.errors.slice(0,5).map((j,w)=>t.jsx("li",{className:"text-sm",children:j},w)),d.errors.length>5&&t.jsxs("li",{className:"text-sm",children:["... and ",d.errors.length-5," more"]})]})]})]}):t.jsxs(t.Fragment,{children:[t.jsx(Fs,{className:"h-4 w-4"}),t.jsxs(ta,{children:[t.jsx("p",{className:"font-semibold",children:"Import Successful!"}),t.jsxs("p",{className:"text-sm mt-1",children:["Imported ",d.imported||0," results.",d.skipped>0&&` Skipped ${d.skipped} duplicates.`]})]})]})}),t.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[t.jsx("h4",{className:"text-sm font-semibold mb-2",children:"CSV Format Example:"}),t.jsx("pre",{className:"text-xs font-mono overflow-x-auto",children:`sample_barcode,parameter_code,value,uncertainty,method,analyst,analyzed_at
WQ20240101-ABC123,PH,7.2,0.1,SM 4500-H,John Doe,2024-01-15
WQ20240101-ABC123,TURB,1.5,0.2,SM 2130-B,Jane Smith,2024-01-15`})]})]}),t.jsxs(Ji,{children:[t.jsx(X,{type:"button",variant:"outline",onClick:v,children:d?"Close":"Cancel"}),!d&&t.jsx(X,{onClick:y,disabled:!i||f.isPending,children:f.isPending?t.jsx(t.Fragment,{children:"Importing..."}):t.jsxs(t.Fragment,{children:[t.jsx(bc,{className:"h-4 w-4 mr-2"}),"Import CSV"]})})]})]})})}function fme(){var a;const[e,r]=O.useState(1),[n,s]=O.useState(!1),{data:i,isLoading:l}=ct({queryKey:["water-quality-results",e],queryFn:async()=>xe.get("/v1/water-quality/results",{page:e,per_page:20})}),d={below_lod:"bg-gray-100 text-gray-800",exceeds_who_limit:"bg-orange-100 text-orange-800",exceeds_wasreb_limit:"bg-red-100 text-red-800",exceeds_local_limit:"bg-red-100 text-red-800",high_uncertainty:"bg-yellow-100 text-yellow-800"};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Lab Results"}),t.jsx("p",{className:"text-muted-foreground",children:"Enter and review lab analysis results with automatic QC flagging"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(X,{variant:"outline",onClick:()=>s(!0),children:[t.jsx(bc,{className:"h-4 w-4 mr-2"}),"Import CSV"]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Add Result"]})]})]}),t.jsx(mme,{open:n,onOpenChange:s}),l?t.jsx("div",{className:"text-center py-12",children:"Loading results..."}):t.jsx("div",{className:"grid gap-4",children:(a=i==null?void 0:i.data)==null?void 0:a.map(f=>{var v,j,w,k,S,R,D,T,I,L,$,W;const p=f.qc_flags&&f.qc_flags.length>0,y=(v=f.qc_flags)==null?void 0:v.some(Z=>Z.includes("exceeds_wasreb")||Z.includes("exceeds_local"));return t.jsxs(H,{className:y?"border-red-200":"",children:[t.jsx(de,{className:"pb-3",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(he,{className:"text-lg",children:((w=(j=f.sample_param)==null?void 0:j.parameter)==null?void 0:w.name)||"Unknown Parameter"}),p&&t.jsx(an,{className:`h-5 w-5 ${y?"text-red-500":"text-yellow-500"}`})]}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Sample: ",(S=(k=f.sample_param)==null?void 0:k.sample)==null?void 0:S.barcode]})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("p",{className:"text-2xl font-bold",children:[f.value_qualifier&&t.jsx("span",{className:"text-muted-foreground",children:f.value_qualifier}),(R=f.value)==null?void 0:R.toFixed(2)," ",(T=(D=f.sample_param)==null?void 0:D.parameter)==null?void 0:T.unit]}),f.uncertainty&&t.jsxs("p",{className:"text-sm text-muted-foreground",children:[" ",f.uncertainty," ",(L=(I=f.sample_param)==null?void 0:I.parameter)==null?void 0:L.unit]})]})]})}),t.jsxs(Q,{className:"space-y-3",children:[p&&t.jsx("div",{className:"flex flex-wrap gap-2",children:f.qc_flags.map(Z=>t.jsx(Ee,{className:d[Z]||"bg-gray-100",children:Z.replace(/_/g," ")},Z))}),t.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Analyzed:"}),t.jsx("p",{className:"font-medium",children:f.analyzed_at?wn(new Date(f.analyzed_at),"PP"):"N/A"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Method:"}),t.jsx("p",{className:"font-medium",children:f.method||"N/A"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"LOD:"}),t.jsx("p",{className:"font-medium",children:f.lod?`${f.lod} ${(W=($=f.sample_param)==null?void 0:$.parameter)==null?void 0:W.unit}`:"N/A"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Analyst:"}),t.jsx("p",{className:"font-medium",children:f.analyst||"N/A"})]})]}),f.remarks&&t.jsx("p",{className:"text-sm text-muted-foreground italic",children:f.remarks})]})]},f.id)})}),(i==null?void 0:i.meta)&&t.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",i.meta.from," to ",i.meta.to," of ",i.meta.total," results"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{variant:"outline",size:"sm",disabled:e===1,onClick:()=>r(f=>f-1),children:"Previous"}),t.jsx(X,{variant:"outline",size:"sm",disabled:e>=i.meta.last_page,onClick:()=>r(f=>f+1),children:"Next"})]})]})]})}function pme(){var i,l;const{data:e,isLoading:r}=ct({queryKey:["water-quality-compliance-summary"],queryFn:async()=>xe.get("/v1/water-quality/compliance/summary")}),{data:n,isLoading:s}=ct({queryKey:["water-quality-compliance"],queryFn:async()=>xe.get("/v1/water-quality/compliance",{per_page:50})});return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Compliance Dashboard"}),t.jsx("p",{className:"text-muted-foreground",children:"Monitor regulatory compliance with WHO and WASREB water quality standards"})]}),t.jsxs(X,{children:[t.jsx(xs,{className:"h-4 w-4 mr-2"}),"Generate Report"]})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Overall Compliance"}),t.jsx(sd,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:r?"...":`${((i=e==null?void 0:e.overall_compliance_rate)==null?void 0:i.toFixed(1))||0}%`}),t.jsx(du,{value:(e==null?void 0:e.overall_compliance_rate)||0,className:"mt-2"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Compliant Points"}),t.jsx(Fs,{className:"h-4 w-4 text-green-500"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:r?"...":(e==null?void 0:e.compliant_points)||0}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["of ",(e==null?void 0:e.total_points)||0," sampling points"]})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Non-Compliant"}),t.jsx(ps,{className:"h-4 w-4 text-red-500"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold text-red-600",children:r?"...":(e==null?void 0:e.non_compliant_points)||0}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"require immediate action"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Tests This Period"}),t.jsx(sd,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:r?"...":(e==null?void 0:e.total_tests)||0}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[(e==null?void 0:e.failed_tests)||0," failed tests"]})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Compliance by Parameter & Location"})}),t.jsx(Q,{children:s?t.jsx("div",{className:"text-center py-8",children:"Loading compliance data..."}):t.jsx("div",{className:"space-y-4",children:(l=n==null?void 0:n.data)==null?void 0:l.map(d=>{var p,y,v;const a=d.compliant_samples/d.total_samples*100,f=a>=95;return t.jsxs("div",{className:"border rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold",children:((p=d.parameter)==null?void 0:p.name)||"Unknown"}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[((y=d.sampling_point)==null?void 0:y.name)||"All Points","  ",d.period||"Current Period"]})]}),t.jsxs(Ee,{variant:f?"default":"destructive",children:[a.toFixed(1),"% Compliant"]})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm mb-2",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Total Samples:"}),t.jsx("p",{className:"font-medium",children:d.total_samples})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Compliant:"}),t.jsx("p",{className:"font-medium text-green-600",children:d.compliant_samples})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Non-Compliant:"}),t.jsx("p",{className:"font-medium text-red-600",children:d.non_compliant_samples})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Limit Applied:"}),t.jsx("p",{className:"font-medium",children:((v=d.limit_type)==null?void 0:v.toUpperCase())||"N/A"})]})]}),t.jsx(du,{value:a,className:"h-2"})]},d.id)})})})]})]})}function xme(){return t.jsxs("div",{className:"flex min-h-screen",children:[t.jsx(Ia,{}),t.jsx("main",{className:"flex-1 p-8 overflow-auto",children:t.jsx(Oa,{})})]})}const Jn="/crm",Ws={getCustomers:e=>{const r={};return e!=null&&e.search&&(r.search=e.search),e!=null&&e.per_page&&(r.per_page=e.per_page.toString()),xe.get(`${Jn}/customers`,r)},getCustomer:e=>xe.get(`${Jn}/customers/${e}`),createCustomer:e=>xe.post(`${Jn}/customers`,e),updateCustomer:(e,r)=>xe.put(`${Jn}/customers/${e}`,r),getPremises:e=>{const r={};return e!=null&&e.search&&(r.search=e.search),e!=null&&e.scheme_id&&(r.scheme_id=e.scheme_id.toString()),e!=null&&e.category&&(r.category=e.category),xe.get(`${Jn}/premises`,r)},getPremise:e=>xe.get(`${Jn}/premises/${e}`),getAccountOverview:e=>xe.get(`${Jn}/accounts/${e}/overview`),getBillingHistory:(e,r)=>{const n={};return r&&(n.months=r.toString()),xe.get(`${Jn}/accounts/${e}/billing`,n)},getConsumptionAnalytics:(e,r)=>{const n={};return r&&(n.months=r.toString()),xe.get(`${Jn}/accounts/${e}/analytics`,n)},getRaCases:e=>{const r={};return e&&(r.status=e),xe.get(`${Jn}/ra/cases`,r)},getHighPriorityCases:(e=20)=>{const r={limit:e.toString()};return xe.get(`${Jn}/ra/cases/high-priority`,r)},triageCase:(e,r)=>xe.post(`${Jn}/ra/cases/${e}/triage`,r),getAgingReport:()=>xe.get(`${Jn}/dunning/aging`),getDisconnectionList:()=>xe.get(`${Jn}/dunning/disconnection-list`),generateDunningNotices:e=>xe.post(`${Jn}/dunning/notices`,{aging_bucket:e}),importBilling:e=>{const r=new FormData;return r.append("file",e),xe.post(`${Jn}/import/billing`,r)},importMpesa:e=>{const r=new FormData;return r.append("file",e),xe.post(`${Jn}/import/mpesa`,r)},getComplaints:e=>{const r={};return e!=null&&e.status&&(r.status=e.status),e!=null&&e.category&&(r.category=e.category),e!=null&&e.priority&&(r.priority=e.priority),e!=null&&e.account_no&&(r.account_no=e.account_no),xe.get(`${Jn}/complaints`,r)},getComplaint:e=>xe.get(`${Jn}/complaints/${e}`),createComplaint:e=>xe.post(`${Jn}/complaints`,e),updateComplaint:(e,r)=>xe.patch(`${Jn}/complaints/${e}`,r),getInteractions:e=>{const r={};return e!=null&&e.channel&&(r.channel=e.channel),e!=null&&e.account_no&&(r.account_no=e.account_no),xe.get(`${Jn}/interactions`,r)},getInteraction:e=>xe.get(`${Jn}/interactions/${e}`),createInteraction:e=>xe.post(`${Jn}/interactions`,e),getNotes:e=>{const r={};return e!=null&&e.account_no&&(r.account_no=e.account_no),e!=null&&e.customer_id&&(r.customer_id=e.customer_id.toString()),xe.get(`${Jn}/notes`,r)},getNote:e=>xe.get(`${Jn}/notes/${e}`),createNote:e=>xe.post(`${Jn}/notes`,e),updateNote:(e,r)=>xe.patch(`${Jn}/notes/${e}`,r),deleteNote:e=>xe.delete(`${Jn}/notes/${e}`)},gme={residential:"bg-blue-100 text-blue-800",commercial:"bg-purple-100 text-purple-800",industrial:"bg-orange-100 text-orange-800",public:"bg-green-100 text-green-800"};function yme(){const[e,r]=O.useState(""),{data:n,isLoading:s,error:i}=ct({queryKey:["customers",e],queryFn:()=>Ws.getCustomers({search:e,per_page:50})}),l=(n==null?void 0:n.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Customers"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage customer accounts and information"})]}),t.jsxs(X,{children:[t.jsx(zne,{className:"mr-2 h-4 w-4"}),"Add Customer"]})]}),s&&!n?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading customers..."})}):i?t.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:t.jsxs("p",{className:"text-lg text-destructive",children:["Error loading customers: ",i.message]})}):t.jsx(t.Fragment,{children:t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("div",{className:"flex gap-4 mb-6",children:t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"relative",children:[t.jsx(di,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Search by name, ID, phone, or email...",className:"pl-9",value:e,onChange:d=>r(d.target.value)})]})})}),t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Name"}),t.jsx(ce,{children:"ID Number"}),t.jsx(ce,{children:"Phone"}),t.jsx(ce,{children:"Email"}),t.jsx(ce,{children:"Type"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:l.length===0?t.jsx(ut,{children:t.jsx(se,{colSpan:6,className:"text-center text-muted-foreground",children:"No customers found"})}):l.map(d=>t.jsxs(ut,{children:[t.jsxs(se,{className:"font-medium",children:[d.first_name," ",d.last_name]}),t.jsx(se,{children:d.id_number}),t.jsx(se,{children:d.phone}),t.jsx(se,{children:d.email||"-"}),t.jsx(se,{children:t.jsx(Ee,{className:gme[d.customer_type],children:d.customer_type})}),t.jsx(se,{children:d.service_connections&&d.service_connections.length>0?t.jsx(X,{variant:"ghost",size:"sm",asChild:!0,children:t.jsx(nd,{to:`/crm/accounts/${d.service_connections[0].account_no}`,children:t.jsx(ud,{className:"h-4 w-4"})})}):t.jsx(X,{variant:"ghost",size:"sm",disabled:!0,children:t.jsx(ud,{className:"h-4 w-4"})})})]},d.id))})]}),t.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:["Showing ",l.length," customer(s)"]})]})})})]})}var vme=Array.isArray,Ro=vme,_me=typeof U0=="object"&&U0&&U0.Object===Object&&U0,u7=_me,bme=u7,jme=typeof self=="object"&&self&&self.Object===Object&&self,wme=bme||jme||Function("return this")(),vd=wme,Nme=vd,Sme=Nme.Symbol,Qb=Sme,WF=Qb,h7=Object.prototype,Pme=h7.hasOwnProperty,Cme=h7.toString,I0=WF?WF.toStringTag:void 0;function Ame(e){var r=Pme.call(e,I0),n=e[I0];try{e[I0]=void 0;var s=!0}catch{}var i=Cme.call(e);return s&&(r?e[I0]=n:delete e[I0]),i}var kme=Ame,Tme=Object.prototype,Eme=Tme.toString;function Mme(e){return Eme.call(e)}var Ome=Mme,GF=Qb,Ime=kme,Dme=Ome,Rme="[object Null]",Lme="[object Undefined]",KF=GF?GF.toStringTag:void 0;function Fme(e){return e==null?e===void 0?Lme:Rme:KF&&KF in Object(e)?Ime(e):Dme(e)}var Du=Fme;function zme(e){return e!=null&&typeof e=="object"}var Ru=zme,$me=Du,Bme=Ru,qme="[object Symbol]";function Vme(e){return typeof e=="symbol"||Bme(e)&&$me(e)==qme}var qy=Vme,Ume=Ro,Wme=qy,Gme=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Kme=/^\w*$/;function Hme(e,r){if(Ume(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||Wme(e)?!0:Kme.test(e)||!Gme.test(e)||r!=null&&e in Object(r)}var VI=Hme;function Zme(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}var Sm=Zme;const Vy=Vn(Sm);var Yme=Du,Xme=Sm,Qme="[object AsyncFunction]",Jme="[object Function]",efe="[object GeneratorFunction]",tfe="[object Proxy]";function rfe(e){if(!Xme(e))return!1;var r=Yme(e);return r==Jme||r==efe||r==Qme||r==tfe}var UI=rfe;const Br=Vn(UI);var nfe=vd,sfe=nfe["__core-js_shared__"],ife=sfe,XA=ife,HF=function(){var e=/[^.]+$/.exec(XA&&XA.keys&&XA.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function afe(e){return!!HF&&HF in e}var ofe=afe,lfe=Function.prototype,cfe=lfe.toString;function dfe(e){if(e!=null){try{return cfe.call(e)}catch{}try{return e+""}catch{}}return""}var m7=dfe,ufe=UI,hfe=ofe,mfe=Sm,ffe=m7,pfe=/[\\^$.*+?()[\]{}|]/g,xfe=/^\[object .+?Constructor\]$/,gfe=Function.prototype,yfe=Object.prototype,vfe=gfe.toString,_fe=yfe.hasOwnProperty,bfe=RegExp("^"+vfe.call(_fe).replace(pfe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function jfe(e){if(!mfe(e)||hfe(e))return!1;var r=ufe(e)?bfe:xfe;return r.test(ffe(e))}var wfe=jfe;function Nfe(e,r){return e==null?void 0:e[r]}var Sfe=Nfe,Pfe=wfe,Cfe=Sfe;function Afe(e,r){var n=Cfe(e,r);return Pfe(n)?n:void 0}var xp=Afe,kfe=xp,Tfe=kfe(Object,"create"),H2=Tfe,ZF=H2;function Efe(){this.__data__=ZF?ZF(null):{},this.size=0}var Mfe=Efe;function Ofe(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}var Ife=Ofe,Dfe=H2,Rfe="__lodash_hash_undefined__",Lfe=Object.prototype,Ffe=Lfe.hasOwnProperty;function zfe(e){var r=this.__data__;if(Dfe){var n=r[e];return n===Rfe?void 0:n}return Ffe.call(r,e)?r[e]:void 0}var $fe=zfe,Bfe=H2,qfe=Object.prototype,Vfe=qfe.hasOwnProperty;function Ufe(e){var r=this.__data__;return Bfe?r[e]!==void 0:Vfe.call(r,e)}var Wfe=Ufe,Gfe=H2,Kfe="__lodash_hash_undefined__";function Hfe(e,r){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Gfe&&r===void 0?Kfe:r,this}var Zfe=Hfe,Yfe=Mfe,Xfe=Ife,Qfe=$fe,Jfe=Wfe,epe=Zfe;function Uy(e){var r=-1,n=e==null?0:e.length;for(this.clear();++r<n;){var s=e[r];this.set(s[0],s[1])}}Uy.prototype.clear=Yfe;Uy.prototype.delete=Xfe;Uy.prototype.get=Qfe;Uy.prototype.has=Jfe;Uy.prototype.set=epe;var tpe=Uy;function rpe(){this.__data__=[],this.size=0}var npe=rpe;function spe(e,r){return e===r||e!==e&&r!==r}var WI=spe,ipe=WI;function ape(e,r){for(var n=e.length;n--;)if(ipe(e[n][0],r))return n;return-1}var Z2=ape,ope=Z2,lpe=Array.prototype,cpe=lpe.splice;function dpe(e){var r=this.__data__,n=ope(r,e);if(n<0)return!1;var s=r.length-1;return n==s?r.pop():cpe.call(r,n,1),--this.size,!0}var upe=dpe,hpe=Z2;function mpe(e){var r=this.__data__,n=hpe(r,e);return n<0?void 0:r[n][1]}var fpe=mpe,ppe=Z2;function xpe(e){return ppe(this.__data__,e)>-1}var gpe=xpe,ype=Z2;function vpe(e,r){var n=this.__data__,s=ype(n,e);return s<0?(++this.size,n.push([e,r])):n[s][1]=r,this}var _pe=vpe,bpe=npe,jpe=upe,wpe=fpe,Npe=gpe,Spe=_pe;function Wy(e){var r=-1,n=e==null?0:e.length;for(this.clear();++r<n;){var s=e[r];this.set(s[0],s[1])}}Wy.prototype.clear=bpe;Wy.prototype.delete=jpe;Wy.prototype.get=wpe;Wy.prototype.has=Npe;Wy.prototype.set=Spe;var Y2=Wy,Ppe=xp,Cpe=vd,Ape=Ppe(Cpe,"Map"),GI=Ape,YF=tpe,kpe=Y2,Tpe=GI;function Epe(){this.size=0,this.__data__={hash:new YF,map:new(Tpe||kpe),string:new YF}}var Mpe=Epe;function Ope(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}var Ipe=Ope,Dpe=Ipe;function Rpe(e,r){var n=e.__data__;return Dpe(r)?n[typeof r=="string"?"string":"hash"]:n.map}var X2=Rpe,Lpe=X2;function Fpe(e){var r=Lpe(this,e).delete(e);return this.size-=r?1:0,r}var zpe=Fpe,$pe=X2;function Bpe(e){return $pe(this,e).get(e)}var qpe=Bpe,Vpe=X2;function Upe(e){return Vpe(this,e).has(e)}var Wpe=Upe,Gpe=X2;function Kpe(e,r){var n=Gpe(this,e),s=n.size;return n.set(e,r),this.size+=n.size==s?0:1,this}var Hpe=Kpe,Zpe=Mpe,Ype=zpe,Xpe=qpe,Qpe=Wpe,Jpe=Hpe;function Gy(e){var r=-1,n=e==null?0:e.length;for(this.clear();++r<n;){var s=e[r];this.set(s[0],s[1])}}Gy.prototype.clear=Zpe;Gy.prototype.delete=Ype;Gy.prototype.get=Xpe;Gy.prototype.has=Qpe;Gy.prototype.set=Jpe;var KI=Gy,f7=KI,exe="Expected a function";function HI(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new TypeError(exe);var n=function(){var s=arguments,i=r?r.apply(this,s):s[0],l=n.cache;if(l.has(i))return l.get(i);var d=e.apply(this,s);return n.cache=l.set(i,d)||l,d};return n.cache=new(HI.Cache||f7),n}HI.Cache=f7;var p7=HI;const txe=Vn(p7);var rxe=p7,nxe=500;function sxe(e){var r=rxe(e,function(s){return n.size===nxe&&n.clear(),s}),n=r.cache;return r}var ixe=sxe,axe=ixe,oxe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,lxe=/\\(\\)?/g,cxe=axe(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(oxe,function(n,s,i,l){r.push(i?l.replace(lxe,"$1"):s||n)}),r}),dxe=cxe;function uxe(e,r){for(var n=-1,s=e==null?0:e.length,i=Array(s);++n<s;)i[n]=r(e[n],n,e);return i}var ZI=uxe,XF=Qb,hxe=ZI,mxe=Ro,fxe=qy,QF=XF?XF.prototype:void 0,JF=QF?QF.toString:void 0;function x7(e){if(typeof e=="string")return e;if(mxe(e))return hxe(e,x7)+"";if(fxe(e))return JF?JF.call(e):"";var r=e+"";return r=="0"&&1/e==-1/0?"-0":r}var pxe=x7,xxe=pxe;function gxe(e){return e==null?"":xxe(e)}var g7=gxe,yxe=Ro,vxe=VI,_xe=dxe,bxe=g7;function jxe(e,r){return yxe(e)?e:vxe(e,r)?[e]:_xe(bxe(e))}var y7=jxe,wxe=qy;function Nxe(e){if(typeof e=="string"||wxe(e))return e;var r=e+"";return r=="0"&&1/e==-1/0?"-0":r}var Q2=Nxe,Sxe=y7,Pxe=Q2;function Cxe(e,r){r=Sxe(r,e);for(var n=0,s=r.length;e!=null&&n<s;)e=e[Pxe(r[n++])];return n&&n==s?e:void 0}var YI=Cxe,Axe=YI;function kxe(e,r,n){var s=e==null?void 0:Axe(e,r);return s===void 0?n:s}var v7=kxe;const sl=Vn(v7);function Txe(e){return e==null}var Exe=Txe;const Zr=Vn(Exe);var Mxe=Du,Oxe=Ro,Ixe=Ru,Dxe="[object String]";function Rxe(e){return typeof e=="string"||!Oxe(e)&&Ixe(e)&&Mxe(e)==Dxe}var Lxe=Rxe;const Jb=Vn(Lxe);var _7={exports:{}},ns={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XI=Symbol.for("react.element"),QI=Symbol.for("react.portal"),J2=Symbol.for("react.fragment"),eP=Symbol.for("react.strict_mode"),tP=Symbol.for("react.profiler"),rP=Symbol.for("react.provider"),nP=Symbol.for("react.context"),Fxe=Symbol.for("react.server_context"),sP=Symbol.for("react.forward_ref"),iP=Symbol.for("react.suspense"),aP=Symbol.for("react.suspense_list"),oP=Symbol.for("react.memo"),lP=Symbol.for("react.lazy"),zxe=Symbol.for("react.offscreen"),b7;b7=Symbol.for("react.module.reference");function ql(e){if(typeof e=="object"&&e!==null){var r=e.$$typeof;switch(r){case XI:switch(e=e.type,e){case J2:case tP:case eP:case iP:case aP:return e;default:switch(e=e&&e.$$typeof,e){case Fxe:case nP:case sP:case lP:case oP:case rP:return e;default:return r}}case QI:return r}}}ns.ContextConsumer=nP;ns.ContextProvider=rP;ns.Element=XI;ns.ForwardRef=sP;ns.Fragment=J2;ns.Lazy=lP;ns.Memo=oP;ns.Portal=QI;ns.Profiler=tP;ns.StrictMode=eP;ns.Suspense=iP;ns.SuspenseList=aP;ns.isAsyncMode=function(){return!1};ns.isConcurrentMode=function(){return!1};ns.isContextConsumer=function(e){return ql(e)===nP};ns.isContextProvider=function(e){return ql(e)===rP};ns.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===XI};ns.isForwardRef=function(e){return ql(e)===sP};ns.isFragment=function(e){return ql(e)===J2};ns.isLazy=function(e){return ql(e)===lP};ns.isMemo=function(e){return ql(e)===oP};ns.isPortal=function(e){return ql(e)===QI};ns.isProfiler=function(e){return ql(e)===tP};ns.isStrictMode=function(e){return ql(e)===eP};ns.isSuspense=function(e){return ql(e)===iP};ns.isSuspenseList=function(e){return ql(e)===aP};ns.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===J2||e===tP||e===eP||e===iP||e===aP||e===zxe||typeof e=="object"&&e!==null&&(e.$$typeof===lP||e.$$typeof===oP||e.$$typeof===rP||e.$$typeof===nP||e.$$typeof===sP||e.$$typeof===b7||e.getModuleId!==void 0)};ns.typeOf=ql;_7.exports=ns;var $xe=_7.exports,Bxe=Du,qxe=Ru,Vxe="[object Number]";function Uxe(e){return typeof e=="number"||qxe(e)&&Bxe(e)==Vxe}var j7=Uxe;const Wxe=Vn(j7);var Gxe=j7;function Kxe(e){return Gxe(e)&&e!=+e}var Hxe=Kxe;const Ky=Vn(Hxe);var uo=function(r){return r===0?0:r>0?1:-1},Af=function(r){return Jb(r)&&r.indexOf("%")===r.length-1},Xt=function(r){return Wxe(r)&&!Ky(r)},ea=function(r){return Xt(r)||Jb(r)},Zxe=0,gp=function(r){var n=++Zxe;return"".concat(r||"").concat(n)},ho=function(r,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Xt(r)&&!Jb(r))return s;var l;if(Af(r)){var d=r.indexOf("%");l=n*parseFloat(r.slice(0,d))/100}else l=+r;return Ky(l)&&(l=s),i&&l>n&&(l=n),l},Ah=function(r){if(!r)return null;var n=Object.keys(r);return n&&n.length?r[n[0]]:null},Yxe=function(r){if(!Array.isArray(r))return!1;for(var n=r.length,s={},i=0;i<n;i++)if(!s[r[i]])s[r[i]]=!0;else return!0;return!1},si=function(r,n){return Xt(r)&&Xt(n)?function(s){return r+s*(n-r)}:function(){return n}};function UN(e,r,n){return!e||!e.length?null:e.find(function(s){return s&&(typeof r=="function"?r(s):sl(s,r))===n})}function gg(e,r){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(r,n)||e[n]!==r[n]))return!1;for(var s in r)if({}.hasOwnProperty.call(r,s)&&!{}.hasOwnProperty.call(e,s))return!1;return!0}function _E(e){"@babel/helpers - typeof";return _E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_E(e)}var Xxe=["viewBox","children"],Qxe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],e5=["points","pathLength"],QA={svg:Xxe,polygon:e5,polyline:e5},JI=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],WN=function(r,n){if(!r||typeof r=="function"||typeof r=="boolean")return null;var s=r;if(O.isValidElement(r)&&(s=r.props),!Vy(s))return null;var i={};return Object.keys(s).forEach(function(l){JI.includes(l)&&(i[l]=n||function(d){return s[l](s,d)})}),i},Jxe=function(r,n,s){return function(i){return r(n,s,i),null}},ap=function(r,n,s){if(!Vy(r)||_E(r)!=="object")return null;var i=null;return Object.keys(r).forEach(function(l){var d=r[l];JI.includes(l)&&typeof d=="function"&&(i||(i={}),i[l]=Jxe(d,n,s))}),i},ege=["children"],tge=["children"];function t5(e,r){if(e==null)return{};var n=rge(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function rge(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}function bE(e){"@babel/helpers - typeof";return bE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},bE(e)}var r5={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},uu=function(r){return typeof r=="string"?r:r?r.displayName||r.name||"Component":""},n5=null,JA=null,e4=function e(r){if(r===n5&&Array.isArray(JA))return JA;var n=[];return O.Children.forEach(r,function(s){Zr(s)||($xe.isFragment(s)?n=n.concat(e(s.props.children)):n.push(s))}),JA=n,n5=r,n};function il(e,r){var n=[],s=[];return Array.isArray(r)?s=r.map(function(i){return uu(i)}):s=[uu(r)],e4(e).forEach(function(i){var l=sl(i,"type.displayName")||sl(i,"type.name");s.indexOf(l)!==-1&&n.push(i)}),n}function Yo(e,r){var n=il(e,r);return n&&n[0]}var s5=function(r){if(!r||!r.props)return!1;var n=r.props,s=n.width,i=n.height;return!(!Xt(s)||s<=0||!Xt(i)||i<=0)},nge=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],sge=function(r){return r&&r.type&&Jb(r.type)&&nge.indexOf(r.type)>=0},w7=function(r){return r&&bE(r)==="object"&&"clipDot"in r},ige=function(r,n,s,i){var l,d=(l=QA==null?void 0:QA[i])!==null&&l!==void 0?l:[];return!Br(r)&&(i&&d.includes(n)||Qxe.includes(n))||s&&JI.includes(n)},Cr=function(r,n,s){if(!r||typeof r=="function"||typeof r=="boolean")return null;var i=r;if(O.isValidElement(r)&&(i=r.props),!Vy(i))return null;var l={};return Object.keys(i).forEach(function(d){var a;ige((a=i)===null||a===void 0?void 0:a[d],d,n,s)&&(l[d]=i[d])}),l},jE=function e(r,n){if(r===n)return!0;var s=O.Children.count(r);if(s!==O.Children.count(n))return!1;if(s===0)return!0;if(s===1)return i5(Array.isArray(r)?r[0]:r,Array.isArray(n)?n[0]:n);for(var i=0;i<s;i++){var l=r[i],d=n[i];if(Array.isArray(l)||Array.isArray(d)){if(!e(l,d))return!1}else if(!i5(l,d))return!1}return!0},i5=function(r,n){if(Zr(r)&&Zr(n))return!0;if(!Zr(r)&&!Zr(n)){var s=r.props||{},i=s.children,l=t5(s,ege),d=n.props||{},a=d.children,f=t5(d,tge);return i&&a?gg(l,f)&&jE(i,a):!i&&!a?gg(l,f):!1}return!1},a5=function(r,n){var s=[],i={};return e4(r).forEach(function(l,d){if(sge(l))s.push(l);else if(l){var a=uu(l.type),f=n[a]||{},p=f.handler,y=f.once;if(p&&(!y||!i[a])){var v=p(l,a,d);s.push(v),i[a]=!0}}}),s},age=function(r){var n=r&&r.type;return n&&r5[n]?r5[n]:null},oge=function(r,n){return e4(n).indexOf(r)},lge=["children","width","height","viewBox","className","style","title","desc"];function wE(){return wE=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},wE.apply(this,arguments)}function cge(e,r){if(e==null)return{};var n=dge(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function dge(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}function NE(e){var r=e.children,n=e.width,s=e.height,i=e.viewBox,l=e.className,d=e.style,a=e.title,f=e.desc,p=cge(e,lge),y=i||{width:n,height:s,x:0,y:0},v=Yr("recharts-surface",l);return me.createElement("svg",wE({},Cr(p,!0,"svg"),{className:v,width:n,height:s,style:d,viewBox:"".concat(y.x," ").concat(y.y," ").concat(y.width," ").concat(y.height)}),me.createElement("title",null,a),me.createElement("desc",null,f),r)}var uge=["children","className"];function SE(){return SE=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},SE.apply(this,arguments)}function hge(e,r){if(e==null)return{};var n=mge(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function mge(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}var gn=me.forwardRef(function(e,r){var n=e.children,s=e.className,i=hge(e,uge),l=Yr("recharts-layer",s);return me.createElement("g",SE({className:l},Cr(i,!0),{ref:r}),n)}),Pc=function(r,n){for(var s=arguments.length,i=new Array(s>2?s-2:0),l=2;l<s;l++)i[l-2]=arguments[l]};function fge(e,r,n){var s=-1,i=e.length;r<0&&(r=-r>i?0:i+r),n=n>i?i:n,n<0&&(n+=i),i=r>n?0:n-r>>>0,r>>>=0;for(var l=Array(i);++s<i;)l[s]=e[s+r];return l}var pge=fge,xge=pge;function gge(e,r,n){var s=e.length;return n=n===void 0?s:n,!r&&n>=s?e:xge(e,r,n)}var yge=gge,vge="\\ud800-\\udfff",_ge="\\u0300-\\u036f",bge="\\ufe20-\\ufe2f",jge="\\u20d0-\\u20ff",wge=_ge+bge+jge,Nge="\\ufe0e\\ufe0f",Sge="\\u200d",Pge=RegExp("["+Sge+vge+wge+Nge+"]");function Cge(e){return Pge.test(e)}var N7=Cge;function Age(e){return e.split("")}var kge=Age,S7="\\ud800-\\udfff",Tge="\\u0300-\\u036f",Ege="\\ufe20-\\ufe2f",Mge="\\u20d0-\\u20ff",Oge=Tge+Ege+Mge,Ige="\\ufe0e\\ufe0f",Dge="["+S7+"]",PE="["+Oge+"]",CE="\\ud83c[\\udffb-\\udfff]",Rge="(?:"+PE+"|"+CE+")",P7="[^"+S7+"]",C7="(?:\\ud83c[\\udde6-\\uddff]){2}",A7="[\\ud800-\\udbff][\\udc00-\\udfff]",Lge="\\u200d",k7=Rge+"?",T7="["+Ige+"]?",Fge="(?:"+Lge+"(?:"+[P7,C7,A7].join("|")+")"+T7+k7+")*",zge=T7+k7+Fge,$ge="(?:"+[P7+PE+"?",PE,C7,A7,Dge].join("|")+")",Bge=RegExp(CE+"(?="+CE+")|"+$ge+zge,"g");function qge(e){return e.match(Bge)||[]}var Vge=qge,Uge=kge,Wge=N7,Gge=Vge;function Kge(e){return Wge(e)?Gge(e):Uge(e)}var Hge=Kge,Zge=yge,Yge=N7,Xge=Hge,Qge=g7;function Jge(e){return function(r){r=Qge(r);var n=Yge(r)?Xge(r):void 0,s=n?n[0]:r.charAt(0),i=n?Zge(n,1).join(""):r.slice(1);return s[e]()+i}}var eye=Jge,tye=eye,rye=tye("toUpperCase"),nye=rye;const cP=Vn(nye);function ws(e){return function(){return e}}const E7=Math.cos,GN=Math.sin,Mc=Math.sqrt,KN=Math.PI,dP=2*KN,AE=Math.PI,kE=2*AE,_f=1e-6,sye=kE-_f;function M7(e){this._+=e[0];for(let r=1,n=e.length;r<n;++r)this._+=arguments[r]+e[r]}function iye(e){let r=Math.floor(e);if(!(r>=0))throw new Error(`invalid digits: ${e}`);if(r>15)return M7;const n=10**r;return function(s){this._+=s[0];for(let i=1,l=s.length;i<l;++i)this._+=Math.round(arguments[i]*n)/n+s[i]}}class aye{constructor(r){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=r==null?M7:iye(r)}moveTo(r,n){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(r,n){this._append`L${this._x1=+r},${this._y1=+n}`}quadraticCurveTo(r,n,s,i){this._append`Q${+r},${+n},${this._x1=+s},${this._y1=+i}`}bezierCurveTo(r,n,s,i,l,d){this._append`C${+r},${+n},${+s},${+i},${this._x1=+l},${this._y1=+d}`}arcTo(r,n,s,i,l){if(r=+r,n=+n,s=+s,i=+i,l=+l,l<0)throw new Error(`negative radius: ${l}`);let d=this._x1,a=this._y1,f=s-r,p=i-n,y=d-r,v=a-n,j=y*y+v*v;if(this._x1===null)this._append`M${this._x1=r},${this._y1=n}`;else if(j>_f)if(!(Math.abs(v*f-p*y)>_f)||!l)this._append`L${this._x1=r},${this._y1=n}`;else{let w=s-d,k=i-a,S=f*f+p*p,R=w*w+k*k,D=Math.sqrt(S),T=Math.sqrt(j),I=l*Math.tan((AE-Math.acos((S+j-R)/(2*D*T)))/2),L=I/T,$=I/D;Math.abs(L-1)>_f&&this._append`L${r+L*y},${n+L*v}`,this._append`A${l},${l},0,0,${+(v*w>y*k)},${this._x1=r+$*f},${this._y1=n+$*p}`}}arc(r,n,s,i,l,d){if(r=+r,n=+n,s=+s,d=!!d,s<0)throw new Error(`negative radius: ${s}`);let a=s*Math.cos(i),f=s*Math.sin(i),p=r+a,y=n+f,v=1^d,j=d?i-l:l-i;this._x1===null?this._append`M${p},${y}`:(Math.abs(this._x1-p)>_f||Math.abs(this._y1-y)>_f)&&this._append`L${p},${y}`,s&&(j<0&&(j=j%kE+kE),j>sye?this._append`A${s},${s},0,1,${v},${r-a},${n-f}A${s},${s},0,1,${v},${this._x1=p},${this._y1=y}`:j>_f&&this._append`A${s},${s},0,${+(j>=AE)},${v},${this._x1=r+s*Math.cos(l)},${this._y1=n+s*Math.sin(l)}`)}rect(r,n,s,i){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+n}h${s=+s}v${+i}h${-s}Z`}toString(){return this._}}function t4(e){let r=3;return e.digits=function(n){if(!arguments.length)return r;if(n==null)r=null;else{const s=Math.floor(n);if(!(s>=0))throw new RangeError(`invalid digits: ${n}`);r=s}return e},()=>new aye(r)}function r4(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function O7(e){this._context=e}O7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;default:this._context.lineTo(e,r);break}}};function uP(e){return new O7(e)}function I7(e){return e[0]}function D7(e){return e[1]}function R7(e,r){var n=ws(!0),s=null,i=uP,l=null,d=t4(a);e=typeof e=="function"?e:e===void 0?I7:ws(e),r=typeof r=="function"?r:r===void 0?D7:ws(r);function a(f){var p,y=(f=r4(f)).length,v,j=!1,w;for(s==null&&(l=i(w=d())),p=0;p<=y;++p)!(p<y&&n(v=f[p],p,f))===j&&((j=!j)?l.lineStart():l.lineEnd()),j&&l.point(+e(v,p,f),+r(v,p,f));if(w)return l=null,w+""||null}return a.x=function(f){return arguments.length?(e=typeof f=="function"?f:ws(+f),a):e},a.y=function(f){return arguments.length?(r=typeof f=="function"?f:ws(+f),a):r},a.defined=function(f){return arguments.length?(n=typeof f=="function"?f:ws(!!f),a):n},a.curve=function(f){return arguments.length?(i=f,s!=null&&(l=i(s)),a):i},a.context=function(f){return arguments.length?(f==null?s=l=null:l=i(s=f),a):s},a}function m1(e,r,n){var s=null,i=ws(!0),l=null,d=uP,a=null,f=t4(p);e=typeof e=="function"?e:e===void 0?I7:ws(+e),r=typeof r=="function"?r:ws(r===void 0?0:+r),n=typeof n=="function"?n:n===void 0?D7:ws(+n);function p(v){var j,w,k,S=(v=r4(v)).length,R,D=!1,T,I=new Array(S),L=new Array(S);for(l==null&&(a=d(T=f())),j=0;j<=S;++j){if(!(j<S&&i(R=v[j],j,v))===D)if(D=!D)w=j,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),k=j-1;k>=w;--k)a.point(I[k],L[k]);a.lineEnd(),a.areaEnd()}D&&(I[j]=+e(R,j,v),L[j]=+r(R,j,v),a.point(s?+s(R,j,v):I[j],n?+n(R,j,v):L[j]))}if(T)return a=null,T+""||null}function y(){return R7().defined(i).curve(d).context(l)}return p.x=function(v){return arguments.length?(e=typeof v=="function"?v:ws(+v),s=null,p):e},p.x0=function(v){return arguments.length?(e=typeof v=="function"?v:ws(+v),p):e},p.x1=function(v){return arguments.length?(s=v==null?null:typeof v=="function"?v:ws(+v),p):s},p.y=function(v){return arguments.length?(r=typeof v=="function"?v:ws(+v),n=null,p):r},p.y0=function(v){return arguments.length?(r=typeof v=="function"?v:ws(+v),p):r},p.y1=function(v){return arguments.length?(n=v==null?null:typeof v=="function"?v:ws(+v),p):n},p.lineX0=p.lineY0=function(){return y().x(e).y(r)},p.lineY1=function(){return y().x(e).y(n)},p.lineX1=function(){return y().x(s).y(r)},p.defined=function(v){return arguments.length?(i=typeof v=="function"?v:ws(!!v),p):i},p.curve=function(v){return arguments.length?(d=v,l!=null&&(a=d(l)),p):d},p.context=function(v){return arguments.length?(v==null?l=a=null:a=d(l=v),p):l},p}class L7{constructor(r,n){this._context=r,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(r,n){switch(r=+r,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+r)/2,this._y0,this._x0,n,r,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,r,this._y0,r,n);break}}this._x0=r,this._y0=n}}function oye(e){return new L7(e,!0)}function lye(e){return new L7(e,!1)}const n4={draw(e,r){const n=Mc(r/KN);e.moveTo(n,0),e.arc(0,0,n,0,dP)}},cye={draw(e,r){const n=Mc(r/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},F7=Mc(1/3),dye=F7*2,uye={draw(e,r){const n=Mc(r/dye),s=n*F7;e.moveTo(0,-n),e.lineTo(s,0),e.lineTo(0,n),e.lineTo(-s,0),e.closePath()}},hye={draw(e,r){const n=Mc(r),s=-n/2;e.rect(s,s,n,n)}},mye=.8908130915292852,z7=GN(KN/10)/GN(7*KN/10),fye=GN(dP/10)*z7,pye=-E7(dP/10)*z7,xye={draw(e,r){const n=Mc(r*mye),s=fye*n,i=pye*n;e.moveTo(0,-n),e.lineTo(s,i);for(let l=1;l<5;++l){const d=dP*l/5,a=E7(d),f=GN(d);e.lineTo(f*n,-a*n),e.lineTo(a*s-f*i,f*s+a*i)}e.closePath()}},ek=Mc(3),gye={draw(e,r){const n=-Mc(r/(ek*3));e.moveTo(0,n*2),e.lineTo(-ek*n,-n),e.lineTo(ek*n,-n),e.closePath()}},yl=-.5,vl=Mc(3)/2,TE=1/Mc(12),yye=(TE/2+1)*3,vye={draw(e,r){const n=Mc(r/yye),s=n/2,i=n*TE,l=s,d=n*TE+n,a=-l,f=d;e.moveTo(s,i),e.lineTo(l,d),e.lineTo(a,f),e.lineTo(yl*s-vl*i,vl*s+yl*i),e.lineTo(yl*l-vl*d,vl*l+yl*d),e.lineTo(yl*a-vl*f,vl*a+yl*f),e.lineTo(yl*s+vl*i,yl*i-vl*s),e.lineTo(yl*l+vl*d,yl*d-vl*l),e.lineTo(yl*a+vl*f,yl*f-vl*a),e.closePath()}};function _ye(e,r){let n=null,s=t4(i);e=typeof e=="function"?e:ws(e||n4),r=typeof r=="function"?r:ws(r===void 0?64:+r);function i(){let l;if(n||(n=l=s()),e.apply(this,arguments).draw(n,+r.apply(this,arguments)),l)return n=null,l+""||null}return i.type=function(l){return arguments.length?(e=typeof l=="function"?l:ws(l),i):e},i.size=function(l){return arguments.length?(r=typeof l=="function"?l:ws(+l),i):r},i.context=function(l){return arguments.length?(n=l??null,i):n},i}function HN(){}function ZN(e,r,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+r)/6,(e._y0+4*e._y1+n)/6)}function $7(e){this._context=e}$7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ZN(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ZN(this,e,r);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r}};function bye(e){return new $7(e)}function B7(e){this._context=e}B7.prototype={areaStart:HN,areaEnd:HN,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._x2=e,this._y2=r;break;case 1:this._point=2,this._x3=e,this._y3=r;break;case 2:this._point=3,this._x4=e,this._y4=r,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+r)/6);break;default:ZN(this,e,r);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r}};function jye(e){return new B7(e)}function q7(e){this._context=e}q7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,s=(this._y0+4*this._y1+r)/6;this._line?this._context.lineTo(n,s):this._context.moveTo(n,s);break;case 3:this._point=4;default:ZN(this,e,r);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r}};function wye(e){return new q7(e)}function V7(e){this._context=e}V7.prototype={areaStart:HN,areaEnd:HN,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,r){e=+e,r=+r,this._point?this._context.lineTo(e,r):(this._point=1,this._context.moveTo(e,r))}};function Nye(e){return new V7(e)}function o5(e){return e<0?-1:1}function l5(e,r,n){var s=e._x1-e._x0,i=r-e._x1,l=(e._y1-e._y0)/(s||i<0&&-0),d=(n-e._y1)/(i||s<0&&-0),a=(l*i+d*s)/(s+i);return(o5(l)+o5(d))*Math.min(Math.abs(l),Math.abs(d),.5*Math.abs(a))||0}function c5(e,r){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-r)/2:r}function tk(e,r,n){var s=e._x0,i=e._y0,l=e._x1,d=e._y1,a=(l-s)/3;e._context.bezierCurveTo(s+a,i+a*r,l-a,d-a*n,l,d)}function YN(e){this._context=e}YN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:tk(this,this._t0,c5(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){var n=NaN;if(e=+e,r=+r,!(e===this._x1&&r===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;break;case 2:this._point=3,tk(this,c5(this,n=l5(this,e,r)),n);break;default:tk(this,this._t0,n=l5(this,e,r));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r,this._t0=n}}};function U7(e){this._context=new W7(e)}(U7.prototype=Object.create(YN.prototype)).point=function(e,r){YN.prototype.point.call(this,r,e)};function W7(e){this._context=e}W7.prototype={moveTo:function(e,r){this._context.moveTo(r,e)},closePath:function(){this._context.closePath()},lineTo:function(e,r){this._context.lineTo(r,e)},bezierCurveTo:function(e,r,n,s,i,l){this._context.bezierCurveTo(r,e,s,n,l,i)}};function Sye(e){return new YN(e)}function Pye(e){return new U7(e)}function G7(e){this._context=e}G7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,r=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],r[0]):this._context.moveTo(e[0],r[0]),n===2)this._context.lineTo(e[1],r[1]);else for(var s=d5(e),i=d5(r),l=0,d=1;d<n;++l,++d)this._context.bezierCurveTo(s[0][l],i[0][l],s[1][l],i[1][l],e[d],r[d]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,r){this._x.push(+e),this._y.push(+r)}};function d5(e){var r,n=e.length-1,s,i=new Array(n),l=new Array(n),d=new Array(n);for(i[0]=0,l[0]=2,d[0]=e[0]+2*e[1],r=1;r<n-1;++r)i[r]=1,l[r]=4,d[r]=4*e[r]+2*e[r+1];for(i[n-1]=2,l[n-1]=7,d[n-1]=8*e[n-1]+e[n],r=1;r<n;++r)s=i[r]/l[r-1],l[r]-=s,d[r]-=s*d[r-1];for(i[n-1]=d[n-1]/l[n-1],r=n-2;r>=0;--r)i[r]=(d[r]-i[r+1])/l[r];for(l[n-1]=(e[n]+i[n-1])/2,r=0;r<n-1;++r)l[r]=2*e[r+1]-i[r+1];return[i,l]}function Cye(e){return new G7(e)}function hP(e,r){this._context=e,this._t=r}hP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,r),this._context.lineTo(e,r);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,r)}break}}this._x=e,this._y=r}};function Aye(e){return new hP(e,.5)}function kye(e){return new hP(e,0)}function Tye(e){return new hP(e,1)}function Xg(e,r){if((d=e.length)>1)for(var n=1,s,i,l=e[r[0]],d,a=l.length;n<d;++n)for(i=l,l=e[r[n]],s=0;s<a;++s)l[s][1]+=l[s][0]=isNaN(i[s][1])?i[s][0]:i[s][1]}function EE(e){for(var r=e.length,n=new Array(r);--r>=0;)n[r]=r;return n}function Eye(e,r){return e[r]}function Mye(e){const r=[];return r.key=e,r}function Oye(){var e=ws([]),r=EE,n=Xg,s=Eye;function i(l){var d=Array.from(e.apply(this,arguments),Mye),a,f=d.length,p=-1,y;for(const v of l)for(a=0,++p;a<f;++a)(d[a][p]=[0,+s(v,d[a].key,p,l)]).data=v;for(a=0,y=r4(r(d));a<f;++a)d[y[a]].index=a;return n(d,y),d}return i.keys=function(l){return arguments.length?(e=typeof l=="function"?l:ws(Array.from(l)),i):e},i.value=function(l){return arguments.length?(s=typeof l=="function"?l:ws(+l),i):s},i.order=function(l){return arguments.length?(r=l==null?EE:typeof l=="function"?l:ws(Array.from(l)),i):r},i.offset=function(l){return arguments.length?(n=l??Xg,i):n},i}function Iye(e,r){if((s=e.length)>0){for(var n,s,i=0,l=e[0].length,d;i<l;++i){for(d=n=0;n<s;++n)d+=e[n][i][1]||0;if(d)for(n=0;n<s;++n)e[n][i][1]/=d}Xg(e,r)}}function Dye(e,r){if((i=e.length)>0){for(var n=0,s=e[r[0]],i,l=s.length;n<l;++n){for(var d=0,a=0;d<i;++d)a+=e[d][n][1]||0;s[n][1]+=s[n][0]=-a/2}Xg(e,r)}}function Rye(e,r){if(!(!((d=e.length)>0)||!((l=(i=e[r[0]]).length)>0))){for(var n=0,s=1,i,l,d;s<l;++s){for(var a=0,f=0,p=0;a<d;++a){for(var y=e[r[a]],v=y[s][1]||0,j=y[s-1][1]||0,w=(v-j)/2,k=0;k<a;++k){var S=e[r[k]],R=S[s][1]||0,D=S[s-1][1]||0;w+=R-D}f+=v,p+=w*v}i[s-1][1]+=i[s-1][0]=n,f&&(n-=p/f)}i[s-1][1]+=i[s-1][0]=n,Xg(e,r)}}function Y_(e){"@babel/helpers - typeof";return Y_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Y_(e)}var Lye=["type","size","sizeType"];function ME(){return ME=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},ME.apply(this,arguments)}function u5(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function h5(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?u5(Object(n),!0).forEach(function(s){Fye(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Fye(e,r,n){return r=zye(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function zye(e){var r=$ye(e,"string");return Y_(r)=="symbol"?r:r+""}function $ye(e,r){if(Y_(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(Y_(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Bye(e,r){if(e==null)return{};var n=qye(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function qye(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}var K7={symbolCircle:n4,symbolCross:cye,symbolDiamond:uye,symbolSquare:hye,symbolStar:xye,symbolTriangle:gye,symbolWye:vye},Vye=Math.PI/180,Uye=function(r){var n="symbol".concat(cP(r));return K7[n]||n4},Wye=function(r,n,s){if(n==="area")return r;switch(s){case"cross":return 5*r*r/9;case"diamond":return .5*r*r/Math.sqrt(3);case"square":return r*r;case"star":{var i=18*Vye;return 1.25*r*r*(Math.tan(i)-Math.tan(i*2)*Math.pow(Math.tan(i),2))}case"triangle":return Math.sqrt(3)*r*r/4;case"wye":return(21-10*Math.sqrt(3))*r*r/8;default:return Math.PI*r*r/4}},Gye=function(r,n){K7["symbol".concat(cP(r))]=n},s4=function(r){var n=r.type,s=n===void 0?"circle":n,i=r.size,l=i===void 0?64:i,d=r.sizeType,a=d===void 0?"area":d,f=Bye(r,Lye),p=h5(h5({},f),{},{type:s,size:l,sizeType:a}),y=function(){var R=Uye(s),D=_ye().type(R).size(Wye(l,a,s));return D()},v=p.className,j=p.cx,w=p.cy,k=Cr(p,!0);return j===+j&&w===+w&&l===+l?me.createElement("path",ME({},k,{className:Yr("recharts-symbols",v),transform:"translate(".concat(j,", ").concat(w,")"),d:y()})):null};s4.registerSymbol=Gye;function Qg(e){"@babel/helpers - typeof";return Qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Qg(e)}function OE(){return OE=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},OE.apply(this,arguments)}function m5(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Kye(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?m5(Object(n),!0).forEach(function(s){X_(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Hye(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Zye(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,Z7(s.key),s)}}function Yye(e,r,n){return r&&Zye(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xye(e,r,n){return r=XN(r),Qye(e,H7()?Reflect.construct(r,n||[],XN(e).constructor):r.apply(e,n))}function Qye(e,r){if(r&&(Qg(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jye(e)}function Jye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function H7(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(H7=function(){return!!e})()}function XN(e){return XN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},XN(e)}function eve(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&IE(e,r)}function IE(e,r){return IE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},IE(e,r)}function X_(e,r,n){return r=Z7(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function Z7(e){var r=tve(e,"string");return Qg(r)=="symbol"?r:r+""}function tve(e,r){if(Qg(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(Qg(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var _l=32,i4=function(e){function r(){return Hye(this,r),Xye(this,r,arguments)}return eve(r,e),Yye(r,[{key:"renderIcon",value:function(s){var i=this.props.inactiveColor,l=_l/2,d=_l/6,a=_l/3,f=s.inactive?i:s.color;if(s.type==="plainline")return me.createElement("line",{strokeWidth:4,fill:"none",stroke:f,strokeDasharray:s.payload.strokeDasharray,x1:0,y1:l,x2:_l,y2:l,className:"recharts-legend-icon"});if(s.type==="line")return me.createElement("path",{strokeWidth:4,fill:"none",stroke:f,d:"M0,".concat(l,"h").concat(a,`
            A`).concat(d,",").concat(d,",0,1,1,").concat(2*a,",").concat(l,`
            H`).concat(_l,"M").concat(2*a,",").concat(l,`
            A`).concat(d,",").concat(d,",0,1,1,").concat(a,",").concat(l),className:"recharts-legend-icon"});if(s.type==="rect")return me.createElement("path",{stroke:"none",fill:f,d:"M0,".concat(_l/8,"h").concat(_l,"v").concat(_l*3/4,"h").concat(-_l,"z"),className:"recharts-legend-icon"});if(me.isValidElement(s.legendIcon)){var p=Kye({},s);return delete p.legendIcon,me.cloneElement(s.legendIcon,p)}return me.createElement(s4,{fill:f,cx:l,cy:l,size:_l,sizeType:"diameter",type:s.type})}},{key:"renderItems",value:function(){var s=this,i=this.props,l=i.payload,d=i.iconSize,a=i.layout,f=i.formatter,p=i.inactiveColor,y={x:0,y:0,width:_l,height:_l},v={display:a==="horizontal"?"inline-block":"block",marginRight:10},j={display:"inline-block",verticalAlign:"middle",marginRight:4};return l.map(function(w,k){var S=w.formatter||f,R=Yr(X_(X_({"recharts-legend-item":!0},"legend-item-".concat(k),!0),"inactive",w.inactive));if(w.type==="none")return null;var D=Br(w.value)?null:w.value;Pc(!Br(w.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var T=w.inactive?p:w.color;return me.createElement("li",OE({className:R,style:v,key:"legend-item-".concat(k)},ap(s.props,w,k)),me.createElement(NE,{width:d,height:d,viewBox:y,style:j},s.renderIcon(w)),me.createElement("span",{className:"recharts-legend-item-text",style:{color:T}},S?S(D,w,k):D))})}},{key:"render",value:function(){var s=this.props,i=s.payload,l=s.layout,d=s.align;if(!i||!i.length)return null;var a={padding:0,margin:0,textAlign:l==="horizontal"?d:"left"};return me.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}])}(O.PureComponent);X_(i4,"displayName","Legend");X_(i4,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var rve=Y2;function nve(){this.__data__=new rve,this.size=0}var sve=nve;function ive(e){var r=this.__data__,n=r.delete(e);return this.size=r.size,n}var ave=ive;function ove(e){return this.__data__.get(e)}var lve=ove;function cve(e){return this.__data__.has(e)}var dve=cve,uve=Y2,hve=GI,mve=KI,fve=200;function pve(e,r){var n=this.__data__;if(n instanceof uve){var s=n.__data__;if(!hve||s.length<fve-1)return s.push([e,r]),this.size=++n.size,this;n=this.__data__=new mve(s)}return n.set(e,r),this.size=n.size,this}var xve=pve,gve=Y2,yve=sve,vve=ave,_ve=lve,bve=dve,jve=xve;function Hy(e){var r=this.__data__=new gve(e);this.size=r.size}Hy.prototype.clear=yve;Hy.prototype.delete=vve;Hy.prototype.get=_ve;Hy.prototype.has=bve;Hy.prototype.set=jve;var Y7=Hy,wve="__lodash_hash_undefined__";function Nve(e){return this.__data__.set(e,wve),this}var Sve=Nve;function Pve(e){return this.__data__.has(e)}var Cve=Pve,Ave=KI,kve=Sve,Tve=Cve;function QN(e){var r=-1,n=e==null?0:e.length;for(this.__data__=new Ave;++r<n;)this.add(e[r])}QN.prototype.add=QN.prototype.push=kve;QN.prototype.has=Tve;var X7=QN;function Eve(e,r){for(var n=-1,s=e==null?0:e.length;++n<s;)if(r(e[n],n,e))return!0;return!1}var Q7=Eve;function Mve(e,r){return e.has(r)}var J7=Mve,Ove=X7,Ive=Q7,Dve=J7,Rve=1,Lve=2;function Fve(e,r,n,s,i,l){var d=n&Rve,a=e.length,f=r.length;if(a!=f&&!(d&&f>a))return!1;var p=l.get(e),y=l.get(r);if(p&&y)return p==r&&y==e;var v=-1,j=!0,w=n&Lve?new Ove:void 0;for(l.set(e,r),l.set(r,e);++v<a;){var k=e[v],S=r[v];if(s)var R=d?s(S,k,v,r,e,l):s(k,S,v,e,r,l);if(R!==void 0){if(R)continue;j=!1;break}if(w){if(!Ive(r,function(D,T){if(!Dve(w,T)&&(k===D||i(k,D,n,s,l)))return w.push(T)})){j=!1;break}}else if(!(k===S||i(k,S,n,s,l))){j=!1;break}}return l.delete(e),l.delete(r),j}var eG=Fve,zve=vd,$ve=zve.Uint8Array,Bve=$ve;function qve(e){var r=-1,n=Array(e.size);return e.forEach(function(s,i){n[++r]=[i,s]}),n}var Vve=qve;function Uve(e){var r=-1,n=Array(e.size);return e.forEach(function(s){n[++r]=s}),n}var a4=Uve,f5=Qb,p5=Bve,Wve=WI,Gve=eG,Kve=Vve,Hve=a4,Zve=1,Yve=2,Xve="[object Boolean]",Qve="[object Date]",Jve="[object Error]",e0e="[object Map]",t0e="[object Number]",r0e="[object RegExp]",n0e="[object Set]",s0e="[object String]",i0e="[object Symbol]",a0e="[object ArrayBuffer]",o0e="[object DataView]",x5=f5?f5.prototype:void 0,rk=x5?x5.valueOf:void 0;function l0e(e,r,n,s,i,l,d){switch(n){case o0e:if(e.byteLength!=r.byteLength||e.byteOffset!=r.byteOffset)return!1;e=e.buffer,r=r.buffer;case a0e:return!(e.byteLength!=r.byteLength||!l(new p5(e),new p5(r)));case Xve:case Qve:case t0e:return Wve(+e,+r);case Jve:return e.name==r.name&&e.message==r.message;case r0e:case s0e:return e==r+"";case e0e:var a=Kve;case n0e:var f=s&Zve;if(a||(a=Hve),e.size!=r.size&&!f)return!1;var p=d.get(e);if(p)return p==r;s|=Yve,d.set(e,r);var y=Gve(a(e),a(r),s,i,l,d);return d.delete(e),y;case i0e:if(rk)return rk.call(e)==rk.call(r)}return!1}var c0e=l0e;function d0e(e,r){for(var n=-1,s=r.length,i=e.length;++n<s;)e[i+n]=r[n];return e}var tG=d0e,u0e=tG,h0e=Ro;function m0e(e,r,n){var s=r(e);return h0e(e)?s:u0e(s,n(e))}var f0e=m0e;function p0e(e,r){for(var n=-1,s=e==null?0:e.length,i=0,l=[];++n<s;){var d=e[n];r(d,n,e)&&(l[i++]=d)}return l}var x0e=p0e;function g0e(){return[]}var y0e=g0e,v0e=x0e,_0e=y0e,b0e=Object.prototype,j0e=b0e.propertyIsEnumerable,g5=Object.getOwnPropertySymbols,w0e=g5?function(e){return e==null?[]:(e=Object(e),v0e(g5(e),function(r){return j0e.call(e,r)}))}:_0e,N0e=w0e;function S0e(e,r){for(var n=-1,s=Array(e);++n<e;)s[n]=r(n);return s}var P0e=S0e,C0e=Du,A0e=Ru,k0e="[object Arguments]";function T0e(e){return A0e(e)&&C0e(e)==k0e}var E0e=T0e,y5=E0e,M0e=Ru,rG=Object.prototype,O0e=rG.hasOwnProperty,I0e=rG.propertyIsEnumerable,D0e=y5(function(){return arguments}())?y5:function(e){return M0e(e)&&O0e.call(e,"callee")&&!I0e.call(e,"callee")},o4=D0e,JN={exports:{}};function R0e(){return!1}var L0e=R0e;JN.exports;(function(e,r){var n=vd,s=L0e,i=r&&!r.nodeType&&r,l=i&&!0&&e&&!e.nodeType&&e,d=l&&l.exports===i,a=d?n.Buffer:void 0,f=a?a.isBuffer:void 0,p=f||s;e.exports=p})(JN,JN.exports);var nG=JN.exports,F0e=9007199254740991,z0e=/^(?:0|[1-9]\d*)$/;function $0e(e,r){var n=typeof e;return r=r??F0e,!!r&&(n=="number"||n!="symbol"&&z0e.test(e))&&e>-1&&e%1==0&&e<r}var l4=$0e,B0e=9007199254740991;function q0e(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=B0e}var c4=q0e,V0e=Du,U0e=c4,W0e=Ru,G0e="[object Arguments]",K0e="[object Array]",H0e="[object Boolean]",Z0e="[object Date]",Y0e="[object Error]",X0e="[object Function]",Q0e="[object Map]",J0e="[object Number]",e_e="[object Object]",t_e="[object RegExp]",r_e="[object Set]",n_e="[object String]",s_e="[object WeakMap]",i_e="[object ArrayBuffer]",a_e="[object DataView]",o_e="[object Float32Array]",l_e="[object Float64Array]",c_e="[object Int8Array]",d_e="[object Int16Array]",u_e="[object Int32Array]",h_e="[object Uint8Array]",m_e="[object Uint8ClampedArray]",f_e="[object Uint16Array]",p_e="[object Uint32Array]",Is={};Is[o_e]=Is[l_e]=Is[c_e]=Is[d_e]=Is[u_e]=Is[h_e]=Is[m_e]=Is[f_e]=Is[p_e]=!0;Is[G0e]=Is[K0e]=Is[i_e]=Is[H0e]=Is[a_e]=Is[Z0e]=Is[Y0e]=Is[X0e]=Is[Q0e]=Is[J0e]=Is[e_e]=Is[t_e]=Is[r_e]=Is[n_e]=Is[s_e]=!1;function x_e(e){return W0e(e)&&U0e(e.length)&&!!Is[V0e(e)]}var g_e=x_e;function y_e(e){return function(r){return e(r)}}var sG=y_e,eS={exports:{}};eS.exports;(function(e,r){var n=u7,s=r&&!r.nodeType&&r,i=s&&!0&&e&&!e.nodeType&&e,l=i&&i.exports===s,d=l&&n.process,a=function(){try{var f=i&&i.require&&i.require("util").types;return f||d&&d.binding&&d.binding("util")}catch{}}();e.exports=a})(eS,eS.exports);var v_e=eS.exports,__e=g_e,b_e=sG,v5=v_e,_5=v5&&v5.isTypedArray,j_e=_5?b_e(_5):__e,iG=j_e,w_e=P0e,N_e=o4,S_e=Ro,P_e=nG,C_e=l4,A_e=iG,k_e=Object.prototype,T_e=k_e.hasOwnProperty;function E_e(e,r){var n=S_e(e),s=!n&&N_e(e),i=!n&&!s&&P_e(e),l=!n&&!s&&!i&&A_e(e),d=n||s||i||l,a=d?w_e(e.length,String):[],f=a.length;for(var p in e)(r||T_e.call(e,p))&&!(d&&(p=="length"||i&&(p=="offset"||p=="parent")||l&&(p=="buffer"||p=="byteLength"||p=="byteOffset")||C_e(p,f)))&&a.push(p);return a}var M_e=E_e,O_e=Object.prototype;function I_e(e){var r=e&&e.constructor,n=typeof r=="function"&&r.prototype||O_e;return e===n}var D_e=I_e;function R_e(e,r){return function(n){return e(r(n))}}var aG=R_e,L_e=aG,F_e=L_e(Object.keys,Object),z_e=F_e,$_e=D_e,B_e=z_e,q_e=Object.prototype,V_e=q_e.hasOwnProperty;function U_e(e){if(!$_e(e))return B_e(e);var r=[];for(var n in Object(e))V_e.call(e,n)&&n!="constructor"&&r.push(n);return r}var W_e=U_e,G_e=UI,K_e=c4;function H_e(e){return e!=null&&K_e(e.length)&&!G_e(e)}var ej=H_e,Z_e=M_e,Y_e=W_e,X_e=ej;function Q_e(e){return X_e(e)?Z_e(e):Y_e(e)}var mP=Q_e,J_e=f0e,ebe=N0e,tbe=mP;function rbe(e){return J_e(e,tbe,ebe)}var nbe=rbe,b5=nbe,sbe=1,ibe=Object.prototype,abe=ibe.hasOwnProperty;function obe(e,r,n,s,i,l){var d=n&sbe,a=b5(e),f=a.length,p=b5(r),y=p.length;if(f!=y&&!d)return!1;for(var v=f;v--;){var j=a[v];if(!(d?j in r:abe.call(r,j)))return!1}var w=l.get(e),k=l.get(r);if(w&&k)return w==r&&k==e;var S=!0;l.set(e,r),l.set(r,e);for(var R=d;++v<f;){j=a[v];var D=e[j],T=r[j];if(s)var I=d?s(T,D,j,r,e,l):s(D,T,j,e,r,l);if(!(I===void 0?D===T||i(D,T,n,s,l):I)){S=!1;break}R||(R=j=="constructor")}if(S&&!R){var L=e.constructor,$=r.constructor;L!=$&&"constructor"in e&&"constructor"in r&&!(typeof L=="function"&&L instanceof L&&typeof $=="function"&&$ instanceof $)&&(S=!1)}return l.delete(e),l.delete(r),S}var lbe=obe,cbe=xp,dbe=vd,ube=cbe(dbe,"DataView"),hbe=ube,mbe=xp,fbe=vd,pbe=mbe(fbe,"Promise"),xbe=pbe,gbe=xp,ybe=vd,vbe=gbe(ybe,"Set"),oG=vbe,_be=xp,bbe=vd,jbe=_be(bbe,"WeakMap"),wbe=jbe,DE=hbe,RE=GI,LE=xbe,FE=oG,zE=wbe,lG=Du,Zy=m7,j5="[object Map]",Nbe="[object Object]",w5="[object Promise]",N5="[object Set]",S5="[object WeakMap]",P5="[object DataView]",Sbe=Zy(DE),Pbe=Zy(RE),Cbe=Zy(LE),Abe=Zy(FE),kbe=Zy(zE),bf=lG;(DE&&bf(new DE(new ArrayBuffer(1)))!=P5||RE&&bf(new RE)!=j5||LE&&bf(LE.resolve())!=w5||FE&&bf(new FE)!=N5||zE&&bf(new zE)!=S5)&&(bf=function(e){var r=lG(e),n=r==Nbe?e.constructor:void 0,s=n?Zy(n):"";if(s)switch(s){case Sbe:return P5;case Pbe:return j5;case Cbe:return w5;case Abe:return N5;case kbe:return S5}return r});var Tbe=bf,nk=Y7,Ebe=eG,Mbe=c0e,Obe=lbe,C5=Tbe,A5=Ro,k5=nG,Ibe=iG,Dbe=1,T5="[object Arguments]",E5="[object Array]",f1="[object Object]",Rbe=Object.prototype,M5=Rbe.hasOwnProperty;function Lbe(e,r,n,s,i,l){var d=A5(e),a=A5(r),f=d?E5:C5(e),p=a?E5:C5(r);f=f==T5?f1:f,p=p==T5?f1:p;var y=f==f1,v=p==f1,j=f==p;if(j&&k5(e)){if(!k5(r))return!1;d=!0,y=!1}if(j&&!y)return l||(l=new nk),d||Ibe(e)?Ebe(e,r,n,s,i,l):Mbe(e,r,f,n,s,i,l);if(!(n&Dbe)){var w=y&&M5.call(e,"__wrapped__"),k=v&&M5.call(r,"__wrapped__");if(w||k){var S=w?e.value():e,R=k?r.value():r;return l||(l=new nk),i(S,R,n,s,l)}}return j?(l||(l=new nk),Obe(e,r,n,s,i,l)):!1}var Fbe=Lbe,zbe=Fbe,O5=Ru;function cG(e,r,n,s,i){return e===r?!0:e==null||r==null||!O5(e)&&!O5(r)?e!==e&&r!==r:zbe(e,r,n,s,cG,i)}var d4=cG,$be=Y7,Bbe=d4,qbe=1,Vbe=2;function Ube(e,r,n,s){var i=n.length,l=i,d=!s;if(e==null)return!l;for(e=Object(e);i--;){var a=n[i];if(d&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<l;){a=n[i];var f=a[0],p=e[f],y=a[1];if(d&&a[2]){if(p===void 0&&!(f in e))return!1}else{var v=new $be;if(s)var j=s(p,y,f,e,r,v);if(!(j===void 0?Bbe(y,p,qbe|Vbe,s,v):j))return!1}}return!0}var Wbe=Ube,Gbe=Sm;function Kbe(e){return e===e&&!Gbe(e)}var dG=Kbe,Hbe=dG,Zbe=mP;function Ybe(e){for(var r=Zbe(e),n=r.length;n--;){var s=r[n],i=e[s];r[n]=[s,i,Hbe(i)]}return r}var Xbe=Ybe;function Qbe(e,r){return function(n){return n==null?!1:n[e]===r&&(r!==void 0||e in Object(n))}}var uG=Qbe,Jbe=Wbe,eje=Xbe,tje=uG;function rje(e){var r=eje(e);return r.length==1&&r[0][2]?tje(r[0][0],r[0][1]):function(n){return n===e||Jbe(n,e,r)}}var nje=rje;function sje(e,r){return e!=null&&r in Object(e)}var ije=sje,aje=y7,oje=o4,lje=Ro,cje=l4,dje=c4,uje=Q2;function hje(e,r,n){r=aje(r,e);for(var s=-1,i=r.length,l=!1;++s<i;){var d=uje(r[s]);if(!(l=e!=null&&n(e,d)))break;e=e[d]}return l||++s!=i?l:(i=e==null?0:e.length,!!i&&dje(i)&&cje(d,i)&&(lje(e)||oje(e)))}var mje=hje,fje=ije,pje=mje;function xje(e,r){return e!=null&&pje(e,r,fje)}var gje=xje,yje=d4,vje=v7,_je=gje,bje=VI,jje=dG,wje=uG,Nje=Q2,Sje=1,Pje=2;function Cje(e,r){return bje(e)&&jje(r)?wje(Nje(e),r):function(n){var s=vje(n,e);return s===void 0&&s===r?_je(n,e):yje(r,s,Sje|Pje)}}var Aje=Cje;function kje(e){return e}var Yy=kje;function Tje(e){return function(r){return r==null?void 0:r[e]}}var Eje=Tje,Mje=YI;function Oje(e){return function(r){return Mje(r,e)}}var Ije=Oje,Dje=Eje,Rje=Ije,Lje=VI,Fje=Q2;function zje(e){return Lje(e)?Dje(Fje(e)):Rje(e)}var $je=zje,Bje=nje,qje=Aje,Vje=Yy,Uje=Ro,Wje=$je;function Gje(e){return typeof e=="function"?e:e==null?Vje:typeof e=="object"?Uje(e)?qje(e[0],e[1]):Bje(e):Wje(e)}var _d=Gje;function Kje(e,r,n,s){for(var i=e.length,l=n+(s?1:-1);s?l--:++l<i;)if(r(e[l],l,e))return l;return-1}var hG=Kje;function Hje(e){return e!==e}var Zje=Hje;function Yje(e,r,n){for(var s=n-1,i=e.length;++s<i;)if(e[s]===r)return s;return-1}var Xje=Yje,Qje=hG,Jje=Zje,ewe=Xje;function twe(e,r,n){return r===r?ewe(e,r,n):Qje(e,Jje,n)}var rwe=twe,nwe=rwe;function swe(e,r){var n=e==null?0:e.length;return!!n&&nwe(e,r,0)>-1}var iwe=swe;function awe(e,r,n){for(var s=-1,i=e==null?0:e.length;++s<i;)if(n(r,e[s]))return!0;return!1}var owe=awe;function lwe(){}var cwe=lwe,sk=oG,dwe=cwe,uwe=a4,hwe=1/0,mwe=sk&&1/uwe(new sk([,-0]))[1]==hwe?function(e){return new sk(e)}:dwe,fwe=mwe,pwe=X7,xwe=iwe,gwe=owe,ywe=J7,vwe=fwe,_we=a4,bwe=200;function jwe(e,r,n){var s=-1,i=xwe,l=e.length,d=!0,a=[],f=a;if(n)d=!1,i=gwe;else if(l>=bwe){var p=r?null:vwe(e);if(p)return _we(p);d=!1,i=ywe,f=new pwe}else f=r?[]:a;e:for(;++s<l;){var y=e[s],v=r?r(y):y;if(y=n||y!==0?y:0,d&&v===v){for(var j=f.length;j--;)if(f[j]===v)continue e;r&&f.push(v),a.push(y)}else i(f,v,n)||(f!==a&&f.push(v),a.push(y))}return a}var wwe=jwe,Nwe=_d,Swe=wwe;function Pwe(e,r){return e&&e.length?Swe(e,Nwe(r)):[]}var Cwe=Pwe;const I5=Vn(Cwe);function mG(e,r,n){return r===!0?I5(e,n):Br(r)?I5(e,r):e}function Jg(e){"@babel/helpers - typeof";return Jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Jg(e)}var Awe=["ref"];function D5(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Yd(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?D5(Object(n),!0).forEach(function(s){fP(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function kwe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function R5(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,pG(s.key),s)}}function Twe(e,r,n){return r&&R5(e.prototype,r),n&&R5(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ewe(e,r,n){return r=tS(r),Mwe(e,fG()?Reflect.construct(r,n||[],tS(e).constructor):r.apply(e,n))}function Mwe(e,r){if(r&&(Jg(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Owe(e)}function Owe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fG=function(){return!!e})()}function tS(e){return tS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},tS(e)}function Iwe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&$E(e,r)}function $E(e,r){return $E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},$E(e,r)}function fP(e,r,n){return r=pG(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function pG(e){var r=Dwe(e,"string");return Jg(r)=="symbol"?r:r+""}function Dwe(e,r){if(Jg(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(Jg(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Rwe(e,r){if(e==null)return{};var n=Lwe(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Lwe(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}function Fwe(e){return e.value}function zwe(e,r){if(me.isValidElement(e))return me.cloneElement(e,r);if(typeof e=="function")return me.createElement(e,r);r.ref;var n=Rwe(r,Awe);return me.createElement(i4,n)}var L5=1,pa=function(e){function r(){var n;kwe(this,r);for(var s=arguments.length,i=new Array(s),l=0;l<s;l++)i[l]=arguments[l];return n=Ewe(this,r,[].concat(i)),fP(n,"lastBoundingBox",{width:-1,height:-1}),n}return Iwe(r,e),Twe(r,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var s=this.wrapperNode.getBoundingClientRect();return s.height=this.wrapperNode.offsetHeight,s.width=this.wrapperNode.offsetWidth,s}return null}},{key:"updateBBox",value:function(){var s=this.props.onBBoxUpdate,i=this.getBBox();i?(Math.abs(i.width-this.lastBoundingBox.width)>L5||Math.abs(i.height-this.lastBoundingBox.height)>L5)&&(this.lastBoundingBox.width=i.width,this.lastBoundingBox.height=i.height,s&&s(i)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,s&&s(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Yd({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(s){var i=this.props,l=i.layout,d=i.align,a=i.verticalAlign,f=i.margin,p=i.chartWidth,y=i.chartHeight,v,j;if(!s||(s.left===void 0||s.left===null)&&(s.right===void 0||s.right===null))if(d==="center"&&l==="vertical"){var w=this.getBBoxSnapshot();v={left:((p||0)-w.width)/2}}else v=d==="right"?{right:f&&f.right||0}:{left:f&&f.left||0};if(!s||(s.top===void 0||s.top===null)&&(s.bottom===void 0||s.bottom===null))if(a==="middle"){var k=this.getBBoxSnapshot();j={top:((y||0)-k.height)/2}}else j=a==="bottom"?{bottom:f&&f.bottom||0}:{top:f&&f.top||0};return Yd(Yd({},v),j)}},{key:"render",value:function(){var s=this,i=this.props,l=i.content,d=i.width,a=i.height,f=i.wrapperStyle,p=i.payloadUniqBy,y=i.payload,v=Yd(Yd({position:"absolute",width:d||"auto",height:a||"auto"},this.getDefaultPosition(f)),f);return me.createElement("div",{className:"recharts-legend-wrapper",style:v,ref:function(w){s.wrapperNode=w}},zwe(l,Yd(Yd({},this.props),{},{payload:mG(y,p,Fwe)})))}}],[{key:"getWithHeight",value:function(s,i){var l=Yd(Yd({},this.defaultProps),s.props),d=l.layout;return d==="vertical"&&Xt(s.props.height)?{height:s.props.height}:d==="horizontal"?{width:s.props.width||i}:null}}])}(O.PureComponent);fP(pa,"displayName","Legend");fP(pa,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var F5=Qb,$we=o4,Bwe=Ro,z5=F5?F5.isConcatSpreadable:void 0;function qwe(e){return Bwe(e)||$we(e)||!!(z5&&e&&e[z5])}var Vwe=qwe,Uwe=tG,Wwe=Vwe;function xG(e,r,n,s,i){var l=-1,d=e.length;for(n||(n=Wwe),i||(i=[]);++l<d;){var a=e[l];r>0&&n(a)?r>1?xG(a,r-1,n,s,i):Uwe(i,a):s||(i[i.length]=a)}return i}var gG=xG;function Gwe(e){return function(r,n,s){for(var i=-1,l=Object(r),d=s(r),a=d.length;a--;){var f=d[e?a:++i];if(n(l[f],f,l)===!1)break}return r}}var Kwe=Gwe,Hwe=Kwe,Zwe=Hwe(),Ywe=Zwe,Xwe=Ywe,Qwe=mP;function Jwe(e,r){return e&&Xwe(e,r,Qwe)}var yG=Jwe,e1e=ej;function t1e(e,r){return function(n,s){if(n==null)return n;if(!e1e(n))return e(n,s);for(var i=n.length,l=r?i:-1,d=Object(n);(r?l--:++l<i)&&s(d[l],l,d)!==!1;);return n}}var r1e=t1e,n1e=yG,s1e=r1e,i1e=s1e(n1e),u4=i1e,a1e=u4,o1e=ej;function l1e(e,r){var n=-1,s=o1e(e)?Array(e.length):[];return a1e(e,function(i,l,d){s[++n]=r(i,l,d)}),s}var vG=l1e;function c1e(e,r){var n=e.length;for(e.sort(r);n--;)e[n]=e[n].value;return e}var d1e=c1e,$5=qy;function u1e(e,r){if(e!==r){var n=e!==void 0,s=e===null,i=e===e,l=$5(e),d=r!==void 0,a=r===null,f=r===r,p=$5(r);if(!a&&!p&&!l&&e>r||l&&d&&f&&!a&&!p||s&&d&&f||!n&&f||!i)return 1;if(!s&&!l&&!p&&e<r||p&&n&&i&&!s&&!l||a&&n&&i||!d&&i||!f)return-1}return 0}var h1e=u1e,m1e=h1e;function f1e(e,r,n){for(var s=-1,i=e.criteria,l=r.criteria,d=i.length,a=n.length;++s<d;){var f=m1e(i[s],l[s]);if(f){if(s>=a)return f;var p=n[s];return f*(p=="desc"?-1:1)}}return e.index-r.index}var p1e=f1e,ik=ZI,x1e=YI,g1e=_d,y1e=vG,v1e=d1e,_1e=sG,b1e=p1e,j1e=Yy,w1e=Ro;function N1e(e,r,n){r.length?r=ik(r,function(l){return w1e(l)?function(d){return x1e(d,l.length===1?l[0]:l)}:l}):r=[j1e];var s=-1;r=ik(r,_1e(g1e));var i=y1e(e,function(l,d,a){var f=ik(r,function(p){return p(l)});return{criteria:f,index:++s,value:l}});return v1e(i,function(l,d){return b1e(l,d,n)})}var S1e=N1e;function P1e(e,r,n){switch(n.length){case 0:return e.call(r);case 1:return e.call(r,n[0]);case 2:return e.call(r,n[0],n[1]);case 3:return e.call(r,n[0],n[1],n[2])}return e.apply(r,n)}var C1e=P1e,A1e=C1e,B5=Math.max;function k1e(e,r,n){return r=B5(r===void 0?e.length-1:r,0),function(){for(var s=arguments,i=-1,l=B5(s.length-r,0),d=Array(l);++i<l;)d[i]=s[r+i];i=-1;for(var a=Array(r+1);++i<r;)a[i]=s[i];return a[r]=n(d),A1e(e,this,a)}}var T1e=k1e;function E1e(e){return function(){return e}}var M1e=E1e,O1e=xp,I1e=function(){try{var e=O1e(Object,"defineProperty");return e({},"",{}),e}catch{}}(),_G=I1e,D1e=M1e,q5=_G,R1e=Yy,L1e=q5?function(e,r){return q5(e,"toString",{configurable:!0,enumerable:!1,value:D1e(r),writable:!0})}:R1e,F1e=L1e,z1e=800,$1e=16,B1e=Date.now;function q1e(e){var r=0,n=0;return function(){var s=B1e(),i=$1e-(s-n);if(n=s,i>0){if(++r>=z1e)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}var V1e=q1e,U1e=F1e,W1e=V1e,G1e=W1e(U1e),K1e=G1e,H1e=Yy,Z1e=T1e,Y1e=K1e;function X1e(e,r){return Y1e(Z1e(e,r,H1e),e+"")}var Q1e=X1e,J1e=WI,eNe=ej,tNe=l4,rNe=Sm;function nNe(e,r,n){if(!rNe(n))return!1;var s=typeof r;return(s=="number"?eNe(n)&&tNe(r,n.length):s=="string"&&r in n)?J1e(n[r],e):!1}var pP=nNe,sNe=gG,iNe=S1e,aNe=Q1e,V5=pP,oNe=aNe(function(e,r){if(e==null)return[];var n=r.length;return n>1&&V5(e,r[0],r[1])?r=[]:n>2&&V5(r[0],r[1],r[2])&&(r=[r[0]]),iNe(e,sNe(r,1),[])}),lNe=oNe;const h4=Vn(lNe);function Q_(e){"@babel/helpers - typeof";return Q_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Q_(e)}function BE(){return BE=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},BE.apply(this,arguments)}function cNe(e,r){return mNe(e)||hNe(e,r)||uNe(e,r)||dNe()}function dNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uNe(e,r){if(e){if(typeof e=="string")return U5(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U5(e,r)}}function U5(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}function hNe(e,r){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,l,d,a=[],f=!0,p=!1;try{if(l=(n=n.call(e)).next,r!==0)for(;!(f=(s=l.call(n)).done)&&(a.push(s.value),a.length!==r);f=!0);}catch(y){p=!0,i=y}finally{try{if(!f&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(p)throw i}}return a}}function mNe(e){if(Array.isArray(e))return e}function W5(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function ak(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?W5(Object(n),!0).forEach(function(s){fNe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function fNe(e,r,n){return r=pNe(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function pNe(e){var r=xNe(e,"string");return Q_(r)=="symbol"?r:r+""}function xNe(e,r){if(Q_(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(Q_(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function gNe(e){return Array.isArray(e)&&ea(e[0])&&ea(e[1])?e.join(" ~ "):e}var yNe=function(r){var n=r.separator,s=n===void 0?" : ":n,i=r.contentStyle,l=i===void 0?{}:i,d=r.itemStyle,a=d===void 0?{}:d,f=r.labelStyle,p=f===void 0?{}:f,y=r.payload,v=r.formatter,j=r.itemSorter,w=r.wrapperClassName,k=r.labelClassName,S=r.label,R=r.labelFormatter,D=r.accessibilityLayer,T=D===void 0?!1:D,I=function(){if(y&&y.length){var ge={padding:0,margin:0},Ie=(j?h4(y,j):y).map(function(Oe,Xe){if(Oe.type==="none")return null;var Ue=ak({display:"block",paddingTop:4,paddingBottom:4,color:Oe.color||"#000"},a),tt=Oe.formatter||v||gNe,Ce=Oe.value,ve=Oe.name,rt=Ce,vt=ve;if(tt&&rt!=null&&vt!=null){var gt=tt(Ce,ve,Oe,Xe,y);if(Array.isArray(gt)){var Et=cNe(gt,2);rt=Et[0],vt=Et[1]}else rt=gt}return me.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(Xe),style:Ue},ea(vt)?me.createElement("span",{className:"recharts-tooltip-item-name"},vt):null,ea(vt)?me.createElement("span",{className:"recharts-tooltip-item-separator"},s):null,me.createElement("span",{className:"recharts-tooltip-item-value"},rt),me.createElement("span",{className:"recharts-tooltip-item-unit"},Oe.unit||""))});return me.createElement("ul",{className:"recharts-tooltip-item-list",style:ge},Ie)}return null},L=ak({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},l),$=ak({margin:0},p),W=!Zr(S),Z=W?S:"",oe=Yr("recharts-default-tooltip",w),te=Yr("recharts-tooltip-label",k);W&&R&&y!==void 0&&y!==null&&(Z=R(S,y));var be=T?{role:"status","aria-live":"assertive"}:{};return me.createElement("div",BE({className:oe,style:L},be),me.createElement("p",{className:te,style:$},me.isValidElement(Z)?Z:"".concat(Z)),I())};function J_(e){"@babel/helpers - typeof";return J_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},J_(e)}function p1(e,r,n){return r=vNe(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function vNe(e){var r=_Ne(e,"string");return J_(r)=="symbol"?r:r+""}function _Ne(e,r){if(J_(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(J_(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var D0="recharts-tooltip-wrapper",bNe={visibility:"hidden"};function jNe(e){var r=e.coordinate,n=e.translateX,s=e.translateY;return Yr(D0,p1(p1(p1(p1({},"".concat(D0,"-right"),Xt(n)&&r&&Xt(r.x)&&n>=r.x),"".concat(D0,"-left"),Xt(n)&&r&&Xt(r.x)&&n<r.x),"".concat(D0,"-bottom"),Xt(s)&&r&&Xt(r.y)&&s>=r.y),"".concat(D0,"-top"),Xt(s)&&r&&Xt(r.y)&&s<r.y))}function G5(e){var r=e.allowEscapeViewBox,n=e.coordinate,s=e.key,i=e.offsetTopLeft,l=e.position,d=e.reverseDirection,a=e.tooltipDimension,f=e.viewBox,p=e.viewBoxDimension;if(l&&Xt(l[s]))return l[s];var y=n[s]-a-i,v=n[s]+i;if(r[s])return d[s]?y:v;if(d[s]){var j=y,w=f[s];return j<w?Math.max(v,f[s]):Math.max(y,f[s])}var k=v+a,S=f[s]+p;return k>S?Math.max(y,f[s]):Math.max(v,f[s])}function wNe(e){var r=e.translateX,n=e.translateY,s=e.useTranslate3d;return{transform:s?"translate3d(".concat(r,"px, ").concat(n,"px, 0)"):"translate(".concat(r,"px, ").concat(n,"px)")}}function NNe(e){var r=e.allowEscapeViewBox,n=e.coordinate,s=e.offsetTopLeft,i=e.position,l=e.reverseDirection,d=e.tooltipBox,a=e.useTranslate3d,f=e.viewBox,p,y,v;return d.height>0&&d.width>0&&n?(y=G5({allowEscapeViewBox:r,coordinate:n,key:"x",offsetTopLeft:s,position:i,reverseDirection:l,tooltipDimension:d.width,viewBox:f,viewBoxDimension:f.width}),v=G5({allowEscapeViewBox:r,coordinate:n,key:"y",offsetTopLeft:s,position:i,reverseDirection:l,tooltipDimension:d.height,viewBox:f,viewBoxDimension:f.height}),p=wNe({translateX:y,translateY:v,useTranslate3d:a})):p=bNe,{cssProperties:p,cssClasses:jNe({translateX:y,translateY:v,coordinate:n})}}function ey(e){"@babel/helpers - typeof";return ey=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ey(e)}function K5(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function H5(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?K5(Object(n),!0).forEach(function(s){VE(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function SNe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function PNe(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,jG(s.key),s)}}function CNe(e,r,n){return r&&PNe(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ANe(e,r,n){return r=rS(r),kNe(e,bG()?Reflect.construct(r,n||[],rS(e).constructor):r.apply(e,n))}function kNe(e,r){if(r&&(ey(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TNe(e)}function TNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bG=function(){return!!e})()}function rS(e){return rS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},rS(e)}function ENe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&qE(e,r)}function qE(e,r){return qE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},qE(e,r)}function VE(e,r,n){return r=jG(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function jG(e){var r=MNe(e,"string");return ey(r)=="symbol"?r:r+""}function MNe(e,r){if(ey(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(ey(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Z5=1,ONe=function(e){function r(){var n;SNe(this,r);for(var s=arguments.length,i=new Array(s),l=0;l<s;l++)i[l]=arguments[l];return n=ANe(this,r,[].concat(i)),VE(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),VE(n,"handleKeyDown",function(d){if(d.key==="Escape"){var a,f,p,y;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(a=(f=n.props.coordinate)===null||f===void 0?void 0:f.x)!==null&&a!==void 0?a:0,y:(p=(y=n.props.coordinate)===null||y===void 0?void 0:y.y)!==null&&p!==void 0?p:0}})}}),n}return ENe(r,e),CNe(r,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var s=this.wrapperNode.getBoundingClientRect();(Math.abs(s.width-this.state.lastBoundingBox.width)>Z5||Math.abs(s.height-this.state.lastBoundingBox.height)>Z5)&&this.setState({lastBoundingBox:{width:s.width,height:s.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var s,i;this.props.active&&this.updateBBox(),this.state.dismissed&&(((s=this.props.coordinate)===null||s===void 0?void 0:s.x)!==this.state.dismissedAtCoordinate.x||((i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var s=this,i=this.props,l=i.active,d=i.allowEscapeViewBox,a=i.animationDuration,f=i.animationEasing,p=i.children,y=i.coordinate,v=i.hasPayload,j=i.isAnimationActive,w=i.offset,k=i.position,S=i.reverseDirection,R=i.useTranslate3d,D=i.viewBox,T=i.wrapperStyle,I=NNe({allowEscapeViewBox:d,coordinate:y,offsetTopLeft:w,position:k,reverseDirection:S,tooltipBox:this.state.lastBoundingBox,useTranslate3d:R,viewBox:D}),L=I.cssClasses,$=I.cssProperties,W=H5(H5({transition:j&&l?"transform ".concat(a,"ms ").concat(f):void 0},$),{},{pointerEvents:"none",visibility:!this.state.dismissed&&l&&v?"visible":"hidden",position:"absolute",top:0,left:0},T);return me.createElement("div",{tabIndex:-1,className:L,style:W,ref:function(oe){s.wrapperNode=oe}},p)}}])}(O.PureComponent),INe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Lu={isSsr:INe()};function ty(e){"@babel/helpers - typeof";return ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ty(e)}function Y5(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function X5(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Y5(Object(n),!0).forEach(function(s){m4(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y5(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function DNe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function RNe(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,NG(s.key),s)}}function LNe(e,r,n){return r&&RNe(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FNe(e,r,n){return r=nS(r),zNe(e,wG()?Reflect.construct(r,n||[],nS(e).constructor):r.apply(e,n))}function zNe(e,r){if(r&&(ty(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Ne(e)}function $Ne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wG=function(){return!!e})()}function nS(e){return nS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},nS(e)}function BNe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&UE(e,r)}function UE(e,r){return UE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},UE(e,r)}function m4(e,r,n){return r=NG(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function NG(e){var r=qNe(e,"string");return ty(r)=="symbol"?r:r+""}function qNe(e,r){if(ty(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(ty(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function VNe(e){return e.dataKey}function UNe(e,r){return me.isValidElement(e)?me.cloneElement(e,r):typeof e=="function"?me.createElement(e,r):me.createElement(yNe,r)}var Gs=function(e){function r(){return DNe(this,r),FNe(this,r,arguments)}return BNe(r,e),LNe(r,[{key:"render",value:function(){var s=this,i=this.props,l=i.active,d=i.allowEscapeViewBox,a=i.animationDuration,f=i.animationEasing,p=i.content,y=i.coordinate,v=i.filterNull,j=i.isAnimationActive,w=i.offset,k=i.payload,S=i.payloadUniqBy,R=i.position,D=i.reverseDirection,T=i.useTranslate3d,I=i.viewBox,L=i.wrapperStyle,$=k??[];v&&$.length&&($=mG(k.filter(function(Z){return Z.value!=null&&(Z.hide!==!0||s.props.includeHidden)}),S,VNe));var W=$.length>0;return me.createElement(ONe,{allowEscapeViewBox:d,animationDuration:a,animationEasing:f,isAnimationActive:j,active:l,coordinate:y,hasPayload:W,offset:w,position:R,reverseDirection:D,useTranslate3d:T,viewBox:I,wrapperStyle:L},UNe(p,X5(X5({},this.props),{},{payload:$})))}}])}(O.PureComponent);m4(Gs,"displayName","Tooltip");m4(Gs,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Lu.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var WNe=vd,GNe=function(){return WNe.Date.now()},KNe=GNe,HNe=/\s/;function ZNe(e){for(var r=e.length;r--&&HNe.test(e.charAt(r)););return r}var YNe=ZNe,XNe=YNe,QNe=/^\s+/;function JNe(e){return e&&e.slice(0,XNe(e)+1).replace(QNe,"")}var eSe=JNe,tSe=eSe,Q5=Sm,rSe=qy,J5=NaN,nSe=/^[-+]0x[0-9a-f]+$/i,sSe=/^0b[01]+$/i,iSe=/^0o[0-7]+$/i,aSe=parseInt;function oSe(e){if(typeof e=="number")return e;if(rSe(e))return J5;if(Q5(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=Q5(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=tSe(e);var n=sSe.test(e);return n||iSe.test(e)?aSe(e.slice(2),n?2:8):nSe.test(e)?J5:+e}var SG=oSe,lSe=Sm,ok=KNe,ez=SG,cSe="Expected a function",dSe=Math.max,uSe=Math.min;function hSe(e,r,n){var s,i,l,d,a,f,p=0,y=!1,v=!1,j=!0;if(typeof e!="function")throw new TypeError(cSe);r=ez(r)||0,lSe(n)&&(y=!!n.leading,v="maxWait"in n,l=v?dSe(ez(n.maxWait)||0,r):l,j="trailing"in n?!!n.trailing:j);function w(W){var Z=s,oe=i;return s=i=void 0,p=W,d=e.apply(oe,Z),d}function k(W){return p=W,a=setTimeout(D,r),y?w(W):d}function S(W){var Z=W-f,oe=W-p,te=r-Z;return v?uSe(te,l-oe):te}function R(W){var Z=W-f,oe=W-p;return f===void 0||Z>=r||Z<0||v&&oe>=l}function D(){var W=ok();if(R(W))return T(W);a=setTimeout(D,S(W))}function T(W){return a=void 0,j&&s?w(W):(s=i=void 0,d)}function I(){a!==void 0&&clearTimeout(a),p=0,s=f=i=a=void 0}function L(){return a===void 0?d:T(ok())}function $(){var W=ok(),Z=R(W);if(s=arguments,i=this,f=W,Z){if(a===void 0)return k(f);if(v)return clearTimeout(a),a=setTimeout(D,r),w(f)}return a===void 0&&(a=setTimeout(D,r)),d}return $.cancel=I,$.flush=L,$}var mSe=hSe,fSe=mSe,pSe=Sm,xSe="Expected a function";function gSe(e,r,n){var s=!0,i=!0;if(typeof e!="function")throw new TypeError(xSe);return pSe(n)&&(s="leading"in n?!!n.leading:s,i="trailing"in n?!!n.trailing:i),fSe(e,r,{leading:s,maxWait:r,trailing:i})}var ySe=gSe;const PG=Vn(ySe);function eb(e){"@babel/helpers - typeof";return eb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},eb(e)}function tz(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function x1(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?tz(Object(n),!0).forEach(function(s){vSe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tz(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function vSe(e,r,n){return r=_Se(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function _Se(e){var r=bSe(e,"string");return eb(r)=="symbol"?r:r+""}function bSe(e,r){if(eb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(eb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function jSe(e,r){return PSe(e)||SSe(e,r)||NSe(e,r)||wSe()}function wSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NSe(e,r){if(e){if(typeof e=="string")return rz(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rz(e,r)}}function rz(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}function SSe(e,r){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,l,d,a=[],f=!0,p=!1;try{if(l=(n=n.call(e)).next,r!==0)for(;!(f=(s=l.call(n)).done)&&(a.push(s.value),a.length!==r);f=!0);}catch(y){p=!0,i=y}finally{try{if(!f&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(p)throw i}}return a}}function PSe(e){if(Array.isArray(e))return e}var Za=O.forwardRef(function(e,r){var n=e.aspect,s=e.initialDimension,i=s===void 0?{width:-1,height:-1}:s,l=e.width,d=l===void 0?"100%":l,a=e.height,f=a===void 0?"100%":a,p=e.minWidth,y=p===void 0?0:p,v=e.minHeight,j=e.maxHeight,w=e.children,k=e.debounce,S=k===void 0?0:k,R=e.id,D=e.className,T=e.onResize,I=e.style,L=I===void 0?{}:I,$=O.useRef(null),W=O.useRef();W.current=T,O.useImperativeHandle(r,function(){return Object.defineProperty($.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),$.current},configurable:!0})});var Z=O.useState({containerWidth:i.width,containerHeight:i.height}),oe=jSe(Z,2),te=oe[0],be=oe[1],ie=O.useCallback(function(Ie,Oe){be(function(Xe){var Ue=Math.round(Ie),tt=Math.round(Oe);return Xe.containerWidth===Ue&&Xe.containerHeight===tt?Xe:{containerWidth:Ue,containerHeight:tt}})},[]);O.useEffect(function(){var Ie=function(ve){var rt,vt=ve[0].contentRect,gt=vt.width,Et=vt.height;ie(gt,Et),(rt=W.current)===null||rt===void 0||rt.call(W,gt,Et)};S>0&&(Ie=PG(Ie,S,{trailing:!0,leading:!1}));var Oe=new ResizeObserver(Ie),Xe=$.current.getBoundingClientRect(),Ue=Xe.width,tt=Xe.height;return ie(Ue,tt),Oe.observe($.current),function(){Oe.disconnect()}},[ie,S]);var ge=O.useMemo(function(){var Ie=te.containerWidth,Oe=te.containerHeight;if(Ie<0||Oe<0)return null;Pc(Af(d)||Af(f),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,d,f),Pc(!n||n>0,"The aspect(%s) must be greater than zero.",n);var Xe=Af(d)?Ie:d,Ue=Af(f)?Oe:f;n&&n>0&&(Xe?Ue=Xe/n:Ue&&(Xe=Ue*n),j&&Ue>j&&(Ue=j)),Pc(Xe>0||Ue>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,Xe,Ue,d,f,y,v,n);var tt=!Array.isArray(w)&&uu(w.type).endsWith("Chart");return me.Children.map(w,function(Ce){return me.isValidElement(Ce)?O.cloneElement(Ce,x1({width:Xe,height:Ue},tt?{style:x1({height:"100%",width:"100%",maxHeight:Ue,maxWidth:Xe},Ce.props.style)}:{})):Ce})},[n,w,f,j,v,y,te,d]);return me.createElement("div",{id:R?"".concat(R):void 0,className:Yr("recharts-responsive-container",D),style:x1(x1({},L),{},{width:d,height:f,minWidth:y,minHeight:v,maxHeight:j}),ref:$},ge)}),tb=function(r){return null};tb.displayName="Cell";function rb(e){"@babel/helpers - typeof";return rb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},rb(e)}function nz(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function WE(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?nz(Object(n),!0).forEach(function(s){CSe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nz(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function CSe(e,r,n){return r=ASe(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function ASe(e){var r=kSe(e,"string");return rb(r)=="symbol"?r:r+""}function kSe(e,r){if(rb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(rb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Ox={widthCache:{},cacheCount:0},TSe=2e3,ESe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},sz="recharts_measurement_span";function MSe(e){var r=WE({},e);return Object.keys(r).forEach(function(n){r[n]||delete r[n]}),r}var u_=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r==null||Lu.isSsr)return{width:0,height:0};var s=MSe(n),i=JSON.stringify({text:r,copyStyle:s});if(Ox.widthCache[i])return Ox.widthCache[i];try{var l=document.getElementById(sz);l||(l=document.createElement("span"),l.setAttribute("id",sz),l.setAttribute("aria-hidden","true"),document.body.appendChild(l));var d=WE(WE({},ESe),s);Object.assign(l.style,d),l.textContent="".concat(r);var a=l.getBoundingClientRect(),f={width:a.width,height:a.height};return Ox.widthCache[i]=f,++Ox.cacheCount>TSe&&(Ox.cacheCount=0,Ox.widthCache={}),f}catch{return{width:0,height:0}}},OSe=function(r){return{top:r.top+window.scrollY-document.documentElement.clientTop,left:r.left+window.scrollX-document.documentElement.clientLeft}};function nb(e){"@babel/helpers - typeof";return nb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},nb(e)}function sS(e,r){return LSe(e)||RSe(e,r)||DSe(e,r)||ISe()}function ISe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DSe(e,r){if(e){if(typeof e=="string")return iz(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iz(e,r)}}function iz(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}function RSe(e,r){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,l,d,a=[],f=!0,p=!1;try{if(l=(n=n.call(e)).next,r===0){if(Object(n)!==n)return;f=!1}else for(;!(f=(s=l.call(n)).done)&&(a.push(s.value),a.length!==r);f=!0);}catch(y){p=!0,i=y}finally{try{if(!f&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(p)throw i}}return a}}function LSe(e){if(Array.isArray(e))return e}function FSe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function az(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,$Se(s.key),s)}}function zSe(e,r,n){return r&&az(e.prototype,r),n&&az(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Se(e){var r=BSe(e,"string");return nb(r)=="symbol"?r:r+""}function BSe(e,r){if(nb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(nb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var oz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,lz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,qSe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,VSe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,CG={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},USe=Object.keys(CG),Jx="NaN";function WSe(e,r){return e*CG[r]}var g1=function(){function e(r,n){FSe(this,e),this.num=r,this.unit=n,this.num=r,this.unit=n,Number.isNaN(r)&&(this.unit=""),n!==""&&!qSe.test(n)&&(this.num=NaN,this.unit=""),USe.includes(n)&&(this.num=WSe(r,n),this.unit="px")}return zSe(e,[{key:"add",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var s,i=(s=VSe.exec(n))!==null&&s!==void 0?s:[],l=sS(i,3),d=l[1],a=l[2];return new e(parseFloat(d),a??"")}}])}();function AG(e){if(e.includes(Jx))return Jx;for(var r=e;r.includes("*")||r.includes("/");){var n,s=(n=oz.exec(r))!==null&&n!==void 0?n:[],i=sS(s,4),l=i[1],d=i[2],a=i[3],f=g1.parse(l??""),p=g1.parse(a??""),y=d==="*"?f.multiply(p):f.divide(p);if(y.isNaN())return Jx;r=r.replace(oz,y.toString())}for(;r.includes("+")||/.-\d+(?:\.\d+)?/.test(r);){var v,j=(v=lz.exec(r))!==null&&v!==void 0?v:[],w=sS(j,4),k=w[1],S=w[2],R=w[3],D=g1.parse(k??""),T=g1.parse(R??""),I=S==="+"?D.add(T):D.subtract(T);if(I.isNaN())return Jx;r=r.replace(lz,I.toString())}return r}var cz=/\(([^()]*)\)/;function GSe(e){for(var r=e;r.includes("(");){var n=cz.exec(r),s=sS(n,2),i=s[1];r=r.replace(cz,AG(i))}return r}function KSe(e){var r=e.replace(/\s+/g,"");return r=GSe(r),r=AG(r),r}function HSe(e){try{return KSe(e)}catch{return Jx}}function lk(e){var r=HSe(e.slice(5,-1));return r===Jx?"":r}var ZSe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],YSe=["dx","dy","angle","className","breakAll"];function GE(){return GE=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},GE.apply(this,arguments)}function dz(e,r){if(e==null)return{};var n=XSe(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function XSe(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}function uz(e,r){return t2e(e)||e2e(e,r)||JSe(e,r)||QSe()}function QSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JSe(e,r){if(e){if(typeof e=="string")return hz(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hz(e,r)}}function hz(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}function e2e(e,r){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,l,d,a=[],f=!0,p=!1;try{if(l=(n=n.call(e)).next,r===0){if(Object(n)!==n)return;f=!1}else for(;!(f=(s=l.call(n)).done)&&(a.push(s.value),a.length!==r);f=!0);}catch(y){p=!0,i=y}finally{try{if(!f&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(p)throw i}}return a}}function t2e(e){if(Array.isArray(e))return e}var kG=/[ \f\n\r\t\v\u2028\u2029]+/,TG=function(r){var n=r.children,s=r.breakAll,i=r.style;try{var l=[];Zr(n)||(s?l=n.toString().split(""):l=n.toString().split(kG));var d=l.map(function(f){return{word:f,width:u_(f,i).width}}),a=s?0:u_("",i).width;return{wordsWithComputedWidth:d,spaceWidth:a}}catch{return null}},r2e=function(r,n,s,i,l){var d=r.maxLines,a=r.children,f=r.style,p=r.breakAll,y=Xt(d),v=a,j=function(){var Xe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Xe.reduce(function(Ue,tt){var Ce=tt.word,ve=tt.width,rt=Ue[Ue.length-1];if(rt&&(i==null||l||rt.width+ve+s<Number(i)))rt.words.push(Ce),rt.width+=ve+s;else{var vt={words:[Ce],width:ve};Ue.push(vt)}return Ue},[])},w=j(n),k=function(Xe){return Xe.reduce(function(Ue,tt){return Ue.width>tt.width?Ue:tt})};if(!y)return w;for(var S="",R=function(Xe){var Ue=v.slice(0,Xe),tt=TG({breakAll:p,style:f,children:Ue+S}).wordsWithComputedWidth,Ce=j(tt),ve=Ce.length>d||k(Ce).width>Number(i);return[ve,Ce]},D=0,T=v.length-1,I=0,L;D<=T&&I<=v.length-1;){var $=Math.floor((D+T)/2),W=$-1,Z=R(W),oe=uz(Z,2),te=oe[0],be=oe[1],ie=R($),ge=uz(ie,1),Ie=ge[0];if(!te&&!Ie&&(D=$+1),te&&Ie&&(T=$-1),!te&&Ie){L=be;break}I++}return L||w},mz=function(r){var n=Zr(r)?[]:r.toString().split(kG);return[{words:n}]},n2e=function(r){var n=r.width,s=r.scaleToFit,i=r.children,l=r.style,d=r.breakAll,a=r.maxLines;if((n||s)&&!Lu.isSsr){var f,p,y=TG({breakAll:d,children:i,style:l});if(y){var v=y.wordsWithComputedWidth,j=y.spaceWidth;f=v,p=j}else return mz(i);return r2e({breakAll:d,children:i,maxLines:a,style:l},f,p,n,s)}return mz(i)},fz="#808080",op=function(r){var n=r.x,s=n===void 0?0:n,i=r.y,l=i===void 0?0:i,d=r.lineHeight,a=d===void 0?"1em":d,f=r.capHeight,p=f===void 0?"0.71em":f,y=r.scaleToFit,v=y===void 0?!1:y,j=r.textAnchor,w=j===void 0?"start":j,k=r.verticalAnchor,S=k===void 0?"end":k,R=r.fill,D=R===void 0?fz:R,T=dz(r,ZSe),I=O.useMemo(function(){return n2e({breakAll:T.breakAll,children:T.children,maxLines:T.maxLines,scaleToFit:v,style:T.style,width:T.width})},[T.breakAll,T.children,T.maxLines,v,T.style,T.width]),L=T.dx,$=T.dy,W=T.angle,Z=T.className,oe=T.breakAll,te=dz(T,YSe);if(!ea(s)||!ea(l))return null;var be=s+(Xt(L)?L:0),ie=l+(Xt($)?$:0),ge;switch(S){case"start":ge=lk("calc(".concat(p,")"));break;case"middle":ge=lk("calc(".concat((I.length-1)/2," * -").concat(a," + (").concat(p," / 2))"));break;default:ge=lk("calc(".concat(I.length-1," * -").concat(a,")"));break}var Ie=[];if(v){var Oe=I[0].width,Xe=T.width;Ie.push("scale(".concat((Xt(Xe)?Xe/Oe:1)/Oe,")"))}return W&&Ie.push("rotate(".concat(W,", ").concat(be,", ").concat(ie,")")),Ie.length&&(te.transform=Ie.join(" ")),me.createElement("text",GE({},Cr(te,!0),{x:be,y:ie,className:Yr("recharts-text",Z),textAnchor:w,fill:D.includes("url")?fz:D}),I.map(function(Ue,tt){var Ce=Ue.words.join(oe?"":" ");return me.createElement("tspan",{x:be,dy:tt===0?ge:a,key:"".concat(Ce,"-").concat(tt)},Ce)}))};function im(e,r){return e==null||r==null?NaN:e<r?-1:e>r?1:e>=r?0:NaN}function s2e(e,r){return e==null||r==null?NaN:r<e?-1:r>e?1:r>=e?0:NaN}function f4(e){let r,n,s;e.length!==2?(r=im,n=(a,f)=>im(e(a),f),s=(a,f)=>e(a)-f):(r=e===im||e===s2e?e:i2e,n=e,s=e);function i(a,f,p=0,y=a.length){if(p<y){if(r(f,f)!==0)return y;do{const v=p+y>>>1;n(a[v],f)<0?p=v+1:y=v}while(p<y)}return p}function l(a,f,p=0,y=a.length){if(p<y){if(r(f,f)!==0)return y;do{const v=p+y>>>1;n(a[v],f)<=0?p=v+1:y=v}while(p<y)}return p}function d(a,f,p=0,y=a.length){const v=i(a,f,p,y-1);return v>p&&s(a[v-1],f)>-s(a[v],f)?v-1:v}return{left:i,center:d,right:l}}function i2e(){return 0}function EG(e){return e===null?NaN:+e}function*a2e(e,r){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const o2e=f4(im),tj=o2e.right;f4(EG).center;class pz extends Map{constructor(r,n=d2e){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),r!=null)for(const[s,i]of r)this.set(s,i)}get(r){return super.get(xz(this,r))}has(r){return super.has(xz(this,r))}set(r,n){return super.set(l2e(this,r),n)}delete(r){return super.delete(c2e(this,r))}}function xz({_intern:e,_key:r},n){const s=r(n);return e.has(s)?e.get(s):n}function l2e({_intern:e,_key:r},n){const s=r(n);return e.has(s)?e.get(s):(e.set(s,n),n)}function c2e({_intern:e,_key:r},n){const s=r(n);return e.has(s)&&(n=e.get(s),e.delete(s)),n}function d2e(e){return e!==null&&typeof e=="object"?e.valueOf():e}function u2e(e=im){if(e===im)return MG;if(typeof e!="function")throw new TypeError("compare is not a function");return(r,n)=>{const s=e(r,n);return s||s===0?s:(e(n,n)===0)-(e(r,r)===0)}}function MG(e,r){return(e==null||!(e>=e))-(r==null||!(r>=r))||(e<r?-1:e>r?1:0)}const h2e=Math.sqrt(50),m2e=Math.sqrt(10),f2e=Math.sqrt(2);function iS(e,r,n){const s=(r-e)/Math.max(0,n),i=Math.floor(Math.log10(s)),l=s/Math.pow(10,i),d=l>=h2e?10:l>=m2e?5:l>=f2e?2:1;let a,f,p;return i<0?(p=Math.pow(10,-i)/d,a=Math.round(e*p),f=Math.round(r*p),a/p<e&&++a,f/p>r&&--f,p=-p):(p=Math.pow(10,i)*d,a=Math.round(e/p),f=Math.round(r/p),a*p<e&&++a,f*p>r&&--f),f<a&&.5<=n&&n<2?iS(e,r,n*2):[a,f,p]}function KE(e,r,n){if(r=+r,e=+e,n=+n,!(n>0))return[];if(e===r)return[e];const s=r<e,[i,l,d]=s?iS(r,e,n):iS(e,r,n);if(!(l>=i))return[];const a=l-i+1,f=new Array(a);if(s)if(d<0)for(let p=0;p<a;++p)f[p]=(l-p)/-d;else for(let p=0;p<a;++p)f[p]=(l-p)*d;else if(d<0)for(let p=0;p<a;++p)f[p]=(i+p)/-d;else for(let p=0;p<a;++p)f[p]=(i+p)*d;return f}function HE(e,r,n){return r=+r,e=+e,n=+n,iS(e,r,n)[2]}function ZE(e,r,n){r=+r,e=+e,n=+n;const s=r<e,i=s?HE(r,e,n):HE(e,r,n);return(s?-1:1)*(i<0?1/-i:i)}function gz(e,r){let n;for(const s of e)s!=null&&(n<s||n===void 0&&s>=s)&&(n=s);return n}function yz(e,r){let n;for(const s of e)s!=null&&(n>s||n===void 0&&s>=s)&&(n=s);return n}function OG(e,r,n=0,s=1/0,i){if(r=Math.floor(r),n=Math.floor(Math.max(0,n)),s=Math.floor(Math.min(e.length-1,s)),!(n<=r&&r<=s))return e;for(i=i===void 0?MG:u2e(i);s>n;){if(s-n>600){const f=s-n+1,p=r-n+1,y=Math.log(f),v=.5*Math.exp(2*y/3),j=.5*Math.sqrt(y*v*(f-v)/f)*(p-f/2<0?-1:1),w=Math.max(n,Math.floor(r-p*v/f+j)),k=Math.min(s,Math.floor(r+(f-p)*v/f+j));OG(e,r,w,k,i)}const l=e[r];let d=n,a=s;for(R0(e,n,r),i(e[s],l)>0&&R0(e,n,s);d<a;){for(R0(e,d,a),++d,--a;i(e[d],l)<0;)++d;for(;i(e[a],l)>0;)--a}i(e[n],l)===0?R0(e,n,a):(++a,R0(e,a,s)),a<=r&&(n=a+1),r<=a&&(s=a-1)}return e}function R0(e,r,n){const s=e[r];e[r]=e[n],e[n]=s}function p2e(e,r,n){if(e=Float64Array.from(a2e(e)),!(!(s=e.length)||isNaN(r=+r))){if(r<=0||s<2)return yz(e);if(r>=1)return gz(e);var s,i=(s-1)*r,l=Math.floor(i),d=gz(OG(e,l).subarray(0,l+1)),a=yz(e.subarray(l+1));return d+(a-d)*(i-l)}}function x2e(e,r,n=EG){if(!(!(s=e.length)||isNaN(r=+r))){if(r<=0||s<2)return+n(e[0],0,e);if(r>=1)return+n(e[s-1],s-1,e);var s,i=(s-1)*r,l=Math.floor(i),d=+n(e[l],l,e),a=+n(e[l+1],l+1,e);return d+(a-d)*(i-l)}}function g2e(e,r,n){e=+e,r=+r,n=(i=arguments.length)<2?(r=e,e=0,1):i<3?1:+n;for(var s=-1,i=Math.max(0,Math.ceil((r-e)/n))|0,l=new Array(i);++s<i;)l[s]=e+s*n;return l}function Vl(e,r){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(r).domain(e);break}return this}function Fu(e,r){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof r=="function"?this.interpolator(r):this.range(r);break}}return this}const YE=Symbol("implicit");function p4(){var e=new pz,r=[],n=[],s=YE;function i(l){let d=e.get(l);if(d===void 0){if(s!==YE)return s;e.set(l,d=r.push(l)-1)}return n[d%n.length]}return i.domain=function(l){if(!arguments.length)return r.slice();r=[],e=new pz;for(const d of l)e.has(d)||e.set(d,r.push(d)-1);return i},i.range=function(l){return arguments.length?(n=Array.from(l),i):n.slice()},i.unknown=function(l){return arguments.length?(s=l,i):s},i.copy=function(){return p4(r,n).unknown(s)},Vl.apply(i,arguments),i}function sb(){var e=p4().unknown(void 0),r=e.domain,n=e.range,s=0,i=1,l,d,a=!1,f=0,p=0,y=.5;delete e.unknown;function v(){var j=r().length,w=i<s,k=w?i:s,S=w?s:i;l=(S-k)/Math.max(1,j-f+p*2),a&&(l=Math.floor(l)),k+=(S-k-l*(j-f))*y,d=l*(1-f),a&&(k=Math.round(k),d=Math.round(d));var R=g2e(j).map(function(D){return k+l*D});return n(w?R.reverse():R)}return e.domain=function(j){return arguments.length?(r(j),v()):r()},e.range=function(j){return arguments.length?([s,i]=j,s=+s,i=+i,v()):[s,i]},e.rangeRound=function(j){return[s,i]=j,s=+s,i=+i,a=!0,v()},e.bandwidth=function(){return d},e.step=function(){return l},e.round=function(j){return arguments.length?(a=!!j,v()):a},e.padding=function(j){return arguments.length?(f=Math.min(1,p=+j),v()):f},e.paddingInner=function(j){return arguments.length?(f=Math.min(1,j),v()):f},e.paddingOuter=function(j){return arguments.length?(p=+j,v()):p},e.align=function(j){return arguments.length?(y=Math.max(0,Math.min(1,j)),v()):y},e.copy=function(){return sb(r(),[s,i]).round(a).paddingInner(f).paddingOuter(p).align(y)},Vl.apply(v(),arguments)}function IG(e){var r=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return IG(r())},e}function h_(){return IG(sb.apply(null,arguments).paddingInner(1))}function x4(e,r,n){e.prototype=r.prototype=n,n.constructor=e}function DG(e,r){var n=Object.create(e.prototype);for(var s in r)n[s]=r[s];return n}function rj(){}var ib=.7,aS=1/ib,yg="\\s*([+-]?\\d+)\\s*",ab="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",cd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",y2e=/^#([0-9a-f]{3,8})$/,v2e=new RegExp(`^rgb\\(${yg},${yg},${yg}\\)$`),_2e=new RegExp(`^rgb\\(${cd},${cd},${cd}\\)$`),b2e=new RegExp(`^rgba\\(${yg},${yg},${yg},${ab}\\)$`),j2e=new RegExp(`^rgba\\(${cd},${cd},${cd},${ab}\\)$`),w2e=new RegExp(`^hsl\\(${ab},${cd},${cd}\\)$`),N2e=new RegExp(`^hsla\\(${ab},${cd},${cd},${ab}\\)$`),vz={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};x4(rj,ob,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:_z,formatHex:_z,formatHex8:S2e,formatHsl:P2e,formatRgb:bz,toString:bz});function _z(){return this.rgb().formatHex()}function S2e(){return this.rgb().formatHex8()}function P2e(){return RG(this).formatHsl()}function bz(){return this.rgb().formatRgb()}function ob(e){var r,n;return e=(e+"").trim().toLowerCase(),(r=y2e.exec(e))?(n=r[1].length,r=parseInt(r[1],16),n===6?jz(r):n===3?new ko(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):n===8?y1(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):n===4?y1(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=v2e.exec(e))?new ko(r[1],r[2],r[3],1):(r=_2e.exec(e))?new ko(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=b2e.exec(e))?y1(r[1],r[2],r[3],r[4]):(r=j2e.exec(e))?y1(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=w2e.exec(e))?Sz(r[1],r[2]/100,r[3]/100,1):(r=N2e.exec(e))?Sz(r[1],r[2]/100,r[3]/100,r[4]):vz.hasOwnProperty(e)?jz(vz[e]):e==="transparent"?new ko(NaN,NaN,NaN,0):null}function jz(e){return new ko(e>>16&255,e>>8&255,e&255,1)}function y1(e,r,n,s){return s<=0&&(e=r=n=NaN),new ko(e,r,n,s)}function C2e(e){return e instanceof rj||(e=ob(e)),e?(e=e.rgb(),new ko(e.r,e.g,e.b,e.opacity)):new ko}function XE(e,r,n,s){return arguments.length===1?C2e(e):new ko(e,r,n,s??1)}function ko(e,r,n,s){this.r=+e,this.g=+r,this.b=+n,this.opacity=+s}x4(ko,XE,DG(rj,{brighter(e){return e=e==null?aS:Math.pow(aS,e),new ko(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ib:Math.pow(ib,e),new ko(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ko(qf(this.r),qf(this.g),qf(this.b),oS(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:wz,formatHex:wz,formatHex8:A2e,formatRgb:Nz,toString:Nz}));function wz(){return`#${kf(this.r)}${kf(this.g)}${kf(this.b)}`}function A2e(){return`#${kf(this.r)}${kf(this.g)}${kf(this.b)}${kf((isNaN(this.opacity)?1:this.opacity)*255)}`}function Nz(){const e=oS(this.opacity);return`${e===1?"rgb(":"rgba("}${qf(this.r)}, ${qf(this.g)}, ${qf(this.b)}${e===1?")":`, ${e})`}`}function oS(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function qf(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function kf(e){return e=qf(e),(e<16?"0":"")+e.toString(16)}function Sz(e,r,n,s){return s<=0?e=r=n=NaN:n<=0||n>=1?e=r=NaN:r<=0&&(e=NaN),new _c(e,r,n,s)}function RG(e){if(e instanceof _c)return new _c(e.h,e.s,e.l,e.opacity);if(e instanceof rj||(e=ob(e)),!e)return new _c;if(e instanceof _c)return e;e=e.rgb();var r=e.r/255,n=e.g/255,s=e.b/255,i=Math.min(r,n,s),l=Math.max(r,n,s),d=NaN,a=l-i,f=(l+i)/2;return a?(r===l?d=(n-s)/a+(n<s)*6:n===l?d=(s-r)/a+2:d=(r-n)/a+4,a/=f<.5?l+i:2-l-i,d*=60):a=f>0&&f<1?0:d,new _c(d,a,f,e.opacity)}function k2e(e,r,n,s){return arguments.length===1?RG(e):new _c(e,r,n,s??1)}function _c(e,r,n,s){this.h=+e,this.s=+r,this.l=+n,this.opacity=+s}x4(_c,k2e,DG(rj,{brighter(e){return e=e==null?aS:Math.pow(aS,e),new _c(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ib:Math.pow(ib,e),new _c(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,r=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,s=n+(n<.5?n:1-n)*r,i=2*n-s;return new ko(ck(e>=240?e-240:e+120,i,s),ck(e,i,s),ck(e<120?e+240:e-120,i,s),this.opacity)},clamp(){return new _c(Pz(this.h),v1(this.s),v1(this.l),oS(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=oS(this.opacity);return`${e===1?"hsl(":"hsla("}${Pz(this.h)}, ${v1(this.s)*100}%, ${v1(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Pz(e){return e=(e||0)%360,e<0?e+360:e}function v1(e){return Math.max(0,Math.min(1,e||0))}function ck(e,r,n){return(e<60?r+(n-r)*e/60:e<180?n:e<240?r+(n-r)*(240-e)/60:r)*255}const g4=e=>()=>e;function T2e(e,r){return function(n){return e+n*r}}function E2e(e,r,n){return e=Math.pow(e,n),r=Math.pow(r,n)-e,n=1/n,function(s){return Math.pow(e+s*r,n)}}function M2e(e){return(e=+e)==1?LG:function(r,n){return n-r?E2e(r,n,e):g4(isNaN(r)?n:r)}}function LG(e,r){var n=r-e;return n?T2e(e,n):g4(isNaN(e)?r:e)}const Cz=function e(r){var n=M2e(r);function s(i,l){var d=n((i=XE(i)).r,(l=XE(l)).r),a=n(i.g,l.g),f=n(i.b,l.b),p=LG(i.opacity,l.opacity);return function(y){return i.r=d(y),i.g=a(y),i.b=f(y),i.opacity=p(y),i+""}}return s.gamma=e,s}(1);function O2e(e,r){r||(r=[]);var n=e?Math.min(r.length,e.length):0,s=r.slice(),i;return function(l){for(i=0;i<n;++i)s[i]=e[i]*(1-l)+r[i]*l;return s}}function I2e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function D2e(e,r){var n=r?r.length:0,s=e?Math.min(n,e.length):0,i=new Array(s),l=new Array(n),d;for(d=0;d<s;++d)i[d]=Xy(e[d],r[d]);for(;d<n;++d)l[d]=r[d];return function(a){for(d=0;d<s;++d)l[d]=i[d](a);return l}}function R2e(e,r){var n=new Date;return e=+e,r=+r,function(s){return n.setTime(e*(1-s)+r*s),n}}function lS(e,r){return e=+e,r=+r,function(n){return e*(1-n)+r*n}}function L2e(e,r){var n={},s={},i;(e===null||typeof e!="object")&&(e={}),(r===null||typeof r!="object")&&(r={});for(i in r)i in e?n[i]=Xy(e[i],r[i]):s[i]=r[i];return function(l){for(i in n)s[i]=n[i](l);return s}}var QE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,dk=new RegExp(QE.source,"g");function F2e(e){return function(){return e}}function z2e(e){return function(r){return e(r)+""}}function $2e(e,r){var n=QE.lastIndex=dk.lastIndex=0,s,i,l,d=-1,a=[],f=[];for(e=e+"",r=r+"";(s=QE.exec(e))&&(i=dk.exec(r));)(l=i.index)>n&&(l=r.slice(n,l),a[d]?a[d]+=l:a[++d]=l),(s=s[0])===(i=i[0])?a[d]?a[d]+=i:a[++d]=i:(a[++d]=null,f.push({i:d,x:lS(s,i)})),n=dk.lastIndex;return n<r.length&&(l=r.slice(n),a[d]?a[d]+=l:a[++d]=l),a.length<2?f[0]?z2e(f[0].x):F2e(r):(r=f.length,function(p){for(var y=0,v;y<r;++y)a[(v=f[y]).i]=v.x(p);return a.join("")})}function Xy(e,r){var n=typeof r,s;return r==null||n==="boolean"?g4(r):(n==="number"?lS:n==="string"?(s=ob(r))?(r=s,Cz):$2e:r instanceof ob?Cz:r instanceof Date?R2e:I2e(r)?O2e:Array.isArray(r)?D2e:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?L2e:lS)(e,r)}function y4(e,r){return e=+e,r=+r,function(n){return Math.round(e*(1-n)+r*n)}}function B2e(e,r){r===void 0&&(r=e,e=Xy);for(var n=0,s=r.length-1,i=r[0],l=new Array(s<0?0:s);n<s;)l[n]=e(i,i=r[++n]);return function(d){var a=Math.max(0,Math.min(s-1,Math.floor(d*=s)));return l[a](d-a)}}function q2e(e){return function(){return e}}function cS(e){return+e}var Az=[0,1];function mo(e){return e}function JE(e,r){return(r-=e=+e)?function(n){return(n-e)/r}:q2e(isNaN(r)?NaN:.5)}function V2e(e,r){var n;return e>r&&(n=e,e=r,r=n),function(s){return Math.max(e,Math.min(r,s))}}function U2e(e,r,n){var s=e[0],i=e[1],l=r[0],d=r[1];return i<s?(s=JE(i,s),l=n(d,l)):(s=JE(s,i),l=n(l,d)),function(a){return l(s(a))}}function W2e(e,r,n){var s=Math.min(e.length,r.length)-1,i=new Array(s),l=new Array(s),d=-1;for(e[s]<e[0]&&(e=e.slice().reverse(),r=r.slice().reverse());++d<s;)i[d]=JE(e[d],e[d+1]),l[d]=n(r[d],r[d+1]);return function(a){var f=tj(e,a,1,s)-1;return l[f](i[f](a))}}function nj(e,r){return r.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function xP(){var e=Az,r=Az,n=Xy,s,i,l,d=mo,a,f,p;function y(){var j=Math.min(e.length,r.length);return d!==mo&&(d=V2e(e[0],e[j-1])),a=j>2?W2e:U2e,f=p=null,v}function v(j){return j==null||isNaN(j=+j)?l:(f||(f=a(e.map(s),r,n)))(s(d(j)))}return v.invert=function(j){return d(i((p||(p=a(r,e.map(s),lS)))(j)))},v.domain=function(j){return arguments.length?(e=Array.from(j,cS),y()):e.slice()},v.range=function(j){return arguments.length?(r=Array.from(j),y()):r.slice()},v.rangeRound=function(j){return r=Array.from(j),n=y4,y()},v.clamp=function(j){return arguments.length?(d=j?!0:mo,y()):d!==mo},v.interpolate=function(j){return arguments.length?(n=j,y()):n},v.unknown=function(j){return arguments.length?(l=j,v):l},function(j,w){return s=j,i=w,y()}}function v4(){return xP()(mo,mo)}function G2e(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function dS(e,r){if((n=(e=r?e.toExponential(r-1):e.toExponential()).indexOf("e"))<0)return null;var n,s=e.slice(0,n);return[s.length>1?s[0]+s.slice(2):s,+e.slice(n+1)]}function ry(e){return e=dS(Math.abs(e)),e?e[1]:NaN}function K2e(e,r){return function(n,s){for(var i=n.length,l=[],d=0,a=e[0],f=0;i>0&&a>0&&(f+a+1>s&&(a=Math.max(1,s-f)),l.push(n.substring(i-=a,i+a)),!((f+=a+1)>s));)a=e[d=(d+1)%e.length];return l.reverse().join(r)}}function H2e(e){return function(r){return r.replace(/[0-9]/g,function(n){return e[+n]})}}var Z2e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function lb(e){if(!(r=Z2e.exec(e)))throw new Error("invalid format: "+e);var r;return new _4({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}lb.prototype=_4.prototype;function _4(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}_4.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Y2e(e){e:for(var r=e.length,n=1,s=-1,i;n<r;++n)switch(e[n]){case".":s=i=n;break;case"0":s===0&&(s=n),i=n;break;default:if(!+e[n])break e;s>0&&(s=0);break}return s>0?e.slice(0,s)+e.slice(i+1):e}var FG;function X2e(e,r){var n=dS(e,r);if(!n)return e+"";var s=n[0],i=n[1],l=i-(FG=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,d=s.length;return l===d?s:l>d?s+new Array(l-d+1).join("0"):l>0?s.slice(0,l)+"."+s.slice(l):"0."+new Array(1-l).join("0")+dS(e,Math.max(0,r+l-1))[0]}function kz(e,r){var n=dS(e,r);if(!n)return e+"";var s=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+s:s.length>i+1?s.slice(0,i+1)+"."+s.slice(i+1):s+new Array(i-s.length+2).join("0")}const Tz={"%":(e,r)=>(e*100).toFixed(r),b:e=>Math.round(e).toString(2),c:e=>e+"",d:G2e,e:(e,r)=>e.toExponential(r),f:(e,r)=>e.toFixed(r),g:(e,r)=>e.toPrecision(r),o:e=>Math.round(e).toString(8),p:(e,r)=>kz(e*100,r),r:kz,s:X2e,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Ez(e){return e}var Mz=Array.prototype.map,Oz=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Q2e(e){var r=e.grouping===void 0||e.thousands===void 0?Ez:K2e(Mz.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",s=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",l=e.numerals===void 0?Ez:H2e(Mz.call(e.numerals,String)),d=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"":e.minus+"",f=e.nan===void 0?"NaN":e.nan+"";function p(v){v=lb(v);var j=v.fill,w=v.align,k=v.sign,S=v.symbol,R=v.zero,D=v.width,T=v.comma,I=v.precision,L=v.trim,$=v.type;$==="n"?(T=!0,$="g"):Tz[$]||(I===void 0&&(I=12),L=!0,$="g"),(R||j==="0"&&w==="=")&&(R=!0,j="0",w="=");var W=S==="$"?n:S==="#"&&/[boxX]/.test($)?"0"+$.toLowerCase():"",Z=S==="$"?s:/[%p]/.test($)?d:"",oe=Tz[$],te=/[defgprs%]/.test($);I=I===void 0?6:/[gprs]/.test($)?Math.max(1,Math.min(21,I)):Math.max(0,Math.min(20,I));function be(ie){var ge=W,Ie=Z,Oe,Xe,Ue;if($==="c")Ie=oe(ie)+Ie,ie="";else{ie=+ie;var tt=ie<0||1/ie<0;if(ie=isNaN(ie)?f:oe(Math.abs(ie),I),L&&(ie=Y2e(ie)),tt&&+ie==0&&k!=="+"&&(tt=!1),ge=(tt?k==="("?k:a:k==="-"||k==="("?"":k)+ge,Ie=($==="s"?Oz[8+FG/3]:"")+Ie+(tt&&k==="("?")":""),te){for(Oe=-1,Xe=ie.length;++Oe<Xe;)if(Ue=ie.charCodeAt(Oe),48>Ue||Ue>57){Ie=(Ue===46?i+ie.slice(Oe+1):ie.slice(Oe))+Ie,ie=ie.slice(0,Oe);break}}}T&&!R&&(ie=r(ie,1/0));var Ce=ge.length+ie.length+Ie.length,ve=Ce<D?new Array(D-Ce+1).join(j):"";switch(T&&R&&(ie=r(ve+ie,ve.length?D-Ie.length:1/0),ve=""),w){case"<":ie=ge+ie+Ie+ve;break;case"=":ie=ge+ve+ie+Ie;break;case"^":ie=ve.slice(0,Ce=ve.length>>1)+ge+ie+Ie+ve.slice(Ce);break;default:ie=ve+ge+ie+Ie;break}return l(ie)}return be.toString=function(){return v+""},be}function y(v,j){var w=p((v=lb(v),v.type="f",v)),k=Math.max(-8,Math.min(8,Math.floor(ry(j)/3)))*3,S=Math.pow(10,-k),R=Oz[8+k/3];return function(D){return w(S*D)+R}}return{format:p,formatPrefix:y}}var _1,b4,zG;J2e({thousands:",",grouping:[3],currency:["$",""]});function J2e(e){return _1=Q2e(e),b4=_1.format,zG=_1.formatPrefix,_1}function ePe(e){return Math.max(0,-ry(Math.abs(e)))}function tPe(e,r){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ry(r)/3)))*3-ry(Math.abs(e)))}function rPe(e,r){return e=Math.abs(e),r=Math.abs(r)-e,Math.max(0,ry(r)-ry(e))+1}function $G(e,r,n,s){var i=ZE(e,r,n),l;switch(s=lb(s??",f"),s.type){case"s":{var d=Math.max(Math.abs(e),Math.abs(r));return s.precision==null&&!isNaN(l=tPe(i,d))&&(s.precision=l),zG(s,d)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(l=rPe(i,Math.max(Math.abs(e),Math.abs(r))))&&(s.precision=l-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(l=ePe(i))&&(s.precision=l-(s.type==="%")*2);break}}return b4(s)}function Pm(e){var r=e.domain;return e.ticks=function(n){var s=r();return KE(s[0],s[s.length-1],n??10)},e.tickFormat=function(n,s){var i=r();return $G(i[0],i[i.length-1],n??10,s)},e.nice=function(n){n==null&&(n=10);var s=r(),i=0,l=s.length-1,d=s[i],a=s[l],f,p,y=10;for(a<d&&(p=d,d=a,a=p,p=i,i=l,l=p);y-- >0;){if(p=HE(d,a,n),p===f)return s[i]=d,s[l]=a,r(s);if(p>0)d=Math.floor(d/p)*p,a=Math.ceil(a/p)*p;else if(p<0)d=Math.ceil(d*p)/p,a=Math.floor(a*p)/p;else break;f=p}return e},e}function uS(){var e=v4();return e.copy=function(){return nj(e,uS())},Vl.apply(e,arguments),Pm(e)}function BG(e){var r;function n(s){return s==null||isNaN(s=+s)?r:s}return n.invert=n,n.domain=n.range=function(s){return arguments.length?(e=Array.from(s,cS),n):e.slice()},n.unknown=function(s){return arguments.length?(r=s,n):r},n.copy=function(){return BG(e).unknown(r)},e=arguments.length?Array.from(e,cS):[0,1],Pm(n)}function qG(e,r){e=e.slice();var n=0,s=e.length-1,i=e[n],l=e[s],d;return l<i&&(d=n,n=s,s=d,d=i,i=l,l=d),e[n]=r.floor(i),e[s]=r.ceil(l),e}function Iz(e){return Math.log(e)}function Dz(e){return Math.exp(e)}function nPe(e){return-Math.log(-e)}function sPe(e){return-Math.exp(-e)}function iPe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function aPe(e){return e===10?iPe:e===Math.E?Math.exp:r=>Math.pow(e,r)}function oPe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),r=>Math.log(r)/e)}function Rz(e){return(r,n)=>-e(-r,n)}function j4(e){const r=e(Iz,Dz),n=r.domain;let s=10,i,l;function d(){return i=oPe(s),l=aPe(s),n()[0]<0?(i=Rz(i),l=Rz(l),e(nPe,sPe)):e(Iz,Dz),r}return r.base=function(a){return arguments.length?(s=+a,d()):s},r.domain=function(a){return arguments.length?(n(a),d()):n()},r.ticks=a=>{const f=n();let p=f[0],y=f[f.length-1];const v=y<p;v&&([p,y]=[y,p]);let j=i(p),w=i(y),k,S;const R=a==null?10:+a;let D=[];if(!(s%1)&&w-j<R){if(j=Math.floor(j),w=Math.ceil(w),p>0){for(;j<=w;++j)for(k=1;k<s;++k)if(S=j<0?k/l(-j):k*l(j),!(S<p)){if(S>y)break;D.push(S)}}else for(;j<=w;++j)for(k=s-1;k>=1;--k)if(S=j>0?k/l(-j):k*l(j),!(S<p)){if(S>y)break;D.push(S)}D.length*2<R&&(D=KE(p,y,R))}else D=KE(j,w,Math.min(w-j,R)).map(l);return v?D.reverse():D},r.tickFormat=(a,f)=>{if(a==null&&(a=10),f==null&&(f=s===10?"s":","),typeof f!="function"&&(!(s%1)&&(f=lb(f)).precision==null&&(f.trim=!0),f=b4(f)),a===1/0)return f;const p=Math.max(1,s*a/r.ticks().length);return y=>{let v=y/l(Math.round(i(y)));return v*s<s-.5&&(v*=s),v<=p?f(y):""}},r.nice=()=>n(qG(n(),{floor:a=>l(Math.floor(i(a))),ceil:a=>l(Math.ceil(i(a)))})),r}function VG(){const e=j4(xP()).domain([1,10]);return e.copy=()=>nj(e,VG()).base(e.base()),Vl.apply(e,arguments),e}function Lz(e){return function(r){return Math.sign(r)*Math.log1p(Math.abs(r/e))}}function Fz(e){return function(r){return Math.sign(r)*Math.expm1(Math.abs(r))*e}}function w4(e){var r=1,n=e(Lz(r),Fz(r));return n.constant=function(s){return arguments.length?e(Lz(r=+s),Fz(r)):r},Pm(n)}function UG(){var e=w4(xP());return e.copy=function(){return nj(e,UG()).constant(e.constant())},Vl.apply(e,arguments)}function zz(e){return function(r){return r<0?-Math.pow(-r,e):Math.pow(r,e)}}function lPe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function cPe(e){return e<0?-e*e:e*e}function N4(e){var r=e(mo,mo),n=1;function s(){return n===1?e(mo,mo):n===.5?e(lPe,cPe):e(zz(n),zz(1/n))}return r.exponent=function(i){return arguments.length?(n=+i,s()):n},Pm(r)}function S4(){var e=N4(xP());return e.copy=function(){return nj(e,S4()).exponent(e.exponent())},Vl.apply(e,arguments),e}function dPe(){return S4.apply(null,arguments).exponent(.5)}function $z(e){return Math.sign(e)*e*e}function uPe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function WG(){var e=v4(),r=[0,1],n=!1,s;function i(l){var d=uPe(e(l));return isNaN(d)?s:n?Math.round(d):d}return i.invert=function(l){return e.invert($z(l))},i.domain=function(l){return arguments.length?(e.domain(l),i):e.domain()},i.range=function(l){return arguments.length?(e.range((r=Array.from(l,cS)).map($z)),i):r.slice()},i.rangeRound=function(l){return i.range(l).round(!0)},i.round=function(l){return arguments.length?(n=!!l,i):n},i.clamp=function(l){return arguments.length?(e.clamp(l),i):e.clamp()},i.unknown=function(l){return arguments.length?(s=l,i):s},i.copy=function(){return WG(e.domain(),r).round(n).clamp(e.clamp()).unknown(s)},Vl.apply(i,arguments),Pm(i)}function GG(){var e=[],r=[],n=[],s;function i(){var d=0,a=Math.max(1,r.length);for(n=new Array(a-1);++d<a;)n[d-1]=x2e(e,d/a);return l}function l(d){return d==null||isNaN(d=+d)?s:r[tj(n,d)]}return l.invertExtent=function(d){var a=r.indexOf(d);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},l.domain=function(d){if(!arguments.length)return e.slice();e=[];for(let a of d)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(im),i()},l.range=function(d){return arguments.length?(r=Array.from(d),i()):r.slice()},l.unknown=function(d){return arguments.length?(s=d,l):s},l.quantiles=function(){return n.slice()},l.copy=function(){return GG().domain(e).range(r).unknown(s)},Vl.apply(l,arguments)}function KG(){var e=0,r=1,n=1,s=[.5],i=[0,1],l;function d(f){return f!=null&&f<=f?i[tj(s,f,0,n)]:l}function a(){var f=-1;for(s=new Array(n);++f<n;)s[f]=((f+1)*r-(f-n)*e)/(n+1);return d}return d.domain=function(f){return arguments.length?([e,r]=f,e=+e,r=+r,a()):[e,r]},d.range=function(f){return arguments.length?(n=(i=Array.from(f)).length-1,a()):i.slice()},d.invertExtent=function(f){var p=i.indexOf(f);return p<0?[NaN,NaN]:p<1?[e,s[0]]:p>=n?[s[n-1],r]:[s[p-1],s[p]]},d.unknown=function(f){return arguments.length&&(l=f),d},d.thresholds=function(){return s.slice()},d.copy=function(){return KG().domain([e,r]).range(i).unknown(l)},Vl.apply(Pm(d),arguments)}function HG(){var e=[.5],r=[0,1],n,s=1;function i(l){return l!=null&&l<=l?r[tj(e,l,0,s)]:n}return i.domain=function(l){return arguments.length?(e=Array.from(l),s=Math.min(e.length,r.length-1),i):e.slice()},i.range=function(l){return arguments.length?(r=Array.from(l),s=Math.min(e.length,r.length-1),i):r.slice()},i.invertExtent=function(l){var d=r.indexOf(l);return[e[d-1],e[d]]},i.unknown=function(l){return arguments.length?(n=l,i):n},i.copy=function(){return HG().domain(e).range(r).unknown(n)},Vl.apply(i,arguments)}const uk=new Date,hk=new Date;function ra(e,r,n,s){function i(l){return e(l=arguments.length===0?new Date:new Date(+l)),l}return i.floor=l=>(e(l=new Date(+l)),l),i.ceil=l=>(e(l=new Date(l-1)),r(l,1),e(l),l),i.round=l=>{const d=i(l),a=i.ceil(l);return l-d<a-l?d:a},i.offset=(l,d)=>(r(l=new Date(+l),d==null?1:Math.floor(d)),l),i.range=(l,d,a)=>{const f=[];if(l=i.ceil(l),a=a==null?1:Math.floor(a),!(l<d)||!(a>0))return f;let p;do f.push(p=new Date(+l)),r(l,a),e(l);while(p<l&&l<d);return f},i.filter=l=>ra(d=>{if(d>=d)for(;e(d),!l(d);)d.setTime(d-1)},(d,a)=>{if(d>=d)if(a<0)for(;++a<=0;)for(;r(d,-1),!l(d););else for(;--a>=0;)for(;r(d,1),!l(d););}),n&&(i.count=(l,d)=>(uk.setTime(+l),hk.setTime(+d),e(uk),e(hk),Math.floor(n(uk,hk))),i.every=l=>(l=Math.floor(l),!isFinite(l)||!(l>0)?null:l>1?i.filter(s?d=>s(d)%l===0:d=>i.count(0,d)%l===0):i)),i}const hS=ra(()=>{},(e,r)=>{e.setTime(+e+r)},(e,r)=>r-e);hS.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ra(r=>{r.setTime(Math.floor(r/e)*e)},(r,n)=>{r.setTime(+r+n*e)},(r,n)=>(n-r)/e):hS);hS.range;const au=1e3,kl=au*60,ou=kl*60,Pu=ou*24,P4=Pu*7,Bz=Pu*30,mk=Pu*365,Tf=ra(e=>{e.setTime(e-e.getMilliseconds())},(e,r)=>{e.setTime(+e+r*au)},(e,r)=>(r-e)/au,e=>e.getUTCSeconds());Tf.range;const C4=ra(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*au)},(e,r)=>{e.setTime(+e+r*kl)},(e,r)=>(r-e)/kl,e=>e.getMinutes());C4.range;const A4=ra(e=>{e.setUTCSeconds(0,0)},(e,r)=>{e.setTime(+e+r*kl)},(e,r)=>(r-e)/kl,e=>e.getUTCMinutes());A4.range;const k4=ra(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*au-e.getMinutes()*kl)},(e,r)=>{e.setTime(+e+r*ou)},(e,r)=>(r-e)/ou,e=>e.getHours());k4.range;const T4=ra(e=>{e.setUTCMinutes(0,0,0)},(e,r)=>{e.setTime(+e+r*ou)},(e,r)=>(r-e)/ou,e=>e.getUTCHours());T4.range;const sj=ra(e=>e.setHours(0,0,0,0),(e,r)=>e.setDate(e.getDate()+r),(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*kl)/Pu,e=>e.getDate()-1);sj.range;const gP=ra(e=>{e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r)},(e,r)=>(r-e)/Pu,e=>e.getUTCDate()-1);gP.range;const ZG=ra(e=>{e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r)},(e,r)=>(r-e)/Pu,e=>Math.floor(e/Pu));ZG.range;function yp(e){return ra(r=>{r.setDate(r.getDate()-(r.getDay()+7-e)%7),r.setHours(0,0,0,0)},(r,n)=>{r.setDate(r.getDate()+n*7)},(r,n)=>(n-r-(n.getTimezoneOffset()-r.getTimezoneOffset())*kl)/P4)}const yP=yp(0),mS=yp(1),hPe=yp(2),mPe=yp(3),ny=yp(4),fPe=yp(5),pPe=yp(6);yP.range;mS.range;hPe.range;mPe.range;ny.range;fPe.range;pPe.range;function vp(e){return ra(r=>{r.setUTCDate(r.getUTCDate()-(r.getUTCDay()+7-e)%7),r.setUTCHours(0,0,0,0)},(r,n)=>{r.setUTCDate(r.getUTCDate()+n*7)},(r,n)=>(n-r)/P4)}const vP=vp(0),fS=vp(1),xPe=vp(2),gPe=vp(3),sy=vp(4),yPe=vp(5),vPe=vp(6);vP.range;fS.range;xPe.range;gPe.range;sy.range;yPe.range;vPe.range;const E4=ra(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,r)=>{e.setMonth(e.getMonth()+r)},(e,r)=>r.getMonth()-e.getMonth()+(r.getFullYear()-e.getFullYear())*12,e=>e.getMonth());E4.range;const M4=ra(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCMonth(e.getUTCMonth()+r)},(e,r)=>r.getUTCMonth()-e.getUTCMonth()+(r.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());M4.range;const Cu=ra(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r)},(e,r)=>r.getFullYear()-e.getFullYear(),e=>e.getFullYear());Cu.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ra(r=>{r.setFullYear(Math.floor(r.getFullYear()/e)*e),r.setMonth(0,1),r.setHours(0,0,0,0)},(r,n)=>{r.setFullYear(r.getFullYear()+n*e)});Cu.range;const Au=ra(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r)},(e,r)=>r.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Au.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ra(r=>{r.setUTCFullYear(Math.floor(r.getUTCFullYear()/e)*e),r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},(r,n)=>{r.setUTCFullYear(r.getUTCFullYear()+n*e)});Au.range;function YG(e,r,n,s,i,l){const d=[[Tf,1,au],[Tf,5,5*au],[Tf,15,15*au],[Tf,30,30*au],[l,1,kl],[l,5,5*kl],[l,15,15*kl],[l,30,30*kl],[i,1,ou],[i,3,3*ou],[i,6,6*ou],[i,12,12*ou],[s,1,Pu],[s,2,2*Pu],[n,1,P4],[r,1,Bz],[r,3,3*Bz],[e,1,mk]];function a(p,y,v){const j=y<p;j&&([p,y]=[y,p]);const w=v&&typeof v.range=="function"?v:f(p,y,v),k=w?w.range(p,+y+1):[];return j?k.reverse():k}function f(p,y,v){const j=Math.abs(y-p)/v,w=f4(([,,R])=>R).right(d,j);if(w===d.length)return e.every(ZE(p/mk,y/mk,v));if(w===0)return hS.every(Math.max(ZE(p,y,v),1));const[k,S]=d[j/d[w-1][2]<d[w][2]/j?w-1:w];return k.every(S)}return[a,f]}const[_Pe,bPe]=YG(Au,M4,vP,ZG,T4,A4),[jPe,wPe]=YG(Cu,E4,yP,sj,k4,C4);function fk(e){if(0<=e.y&&e.y<100){var r=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return r.setFullYear(e.y),r}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function pk(e){if(0<=e.y&&e.y<100){var r=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return r.setUTCFullYear(e.y),r}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function L0(e,r,n){return{y:e,m:r,d:n,H:0,M:0,S:0,L:0}}function NPe(e){var r=e.dateTime,n=e.date,s=e.time,i=e.periods,l=e.days,d=e.shortDays,a=e.months,f=e.shortMonths,p=F0(i),y=z0(i),v=F0(l),j=z0(l),w=F0(d),k=z0(d),S=F0(a),R=z0(a),D=F0(f),T=z0(f),I={a:tt,A:Ce,b:ve,B:rt,c:null,d:Kz,e:Kz,f:KPe,g:nCe,G:iCe,H:UPe,I:WPe,j:GPe,L:XG,m:HPe,M:ZPe,p:vt,q:gt,Q:Yz,s:Xz,S:YPe,u:XPe,U:QPe,V:JPe,w:eCe,W:tCe,x:null,X:null,y:rCe,Y:sCe,Z:aCe,"%":Zz},L={a:Et,A:tr,b:Dr,B:Pr,c:null,d:Hz,e:Hz,f:dCe,g:_Ce,G:jCe,H:oCe,I:lCe,j:cCe,L:JG,m:uCe,M:hCe,p:It,q:_r,Q:Yz,s:Xz,S:mCe,u:fCe,U:pCe,V:xCe,w:gCe,W:yCe,x:null,X:null,y:vCe,Y:bCe,Z:wCe,"%":Zz},$={a:be,A:ie,b:ge,B:Ie,c:Oe,d:Wz,e:Wz,f:$Pe,g:Uz,G:Vz,H:Gz,I:Gz,j:RPe,L:zPe,m:DPe,M:LPe,p:te,q:IPe,Q:qPe,s:VPe,S:FPe,u:kPe,U:TPe,V:EPe,w:APe,W:MPe,x:Xe,X:Ue,y:Uz,Y:Vz,Z:OPe,"%":BPe};I.x=W(n,I),I.X=W(s,I),I.c=W(r,I),L.x=W(n,L),L.X=W(s,L),L.c=W(r,L);function W(St,Qt){return function(rr){var pt=[],qr=-1,or=0,en=St.length,Lr,En,ks;for(rr instanceof Date||(rr=new Date(+rr));++qr<en;)St.charCodeAt(qr)===37&&(pt.push(St.slice(or,qr)),(En=qz[Lr=St.charAt(++qr)])!=null?Lr=St.charAt(++qr):En=Lr==="e"?" ":"0",(ks=Qt[Lr])&&(Lr=ks(rr,En)),pt.push(Lr),or=qr+1);return pt.push(St.slice(or,qr)),pt.join("")}}function Z(St,Qt){return function(rr){var pt=L0(1900,void 0,1),qr=oe(pt,St,rr+="",0),or,en;if(qr!=rr.length)return null;if("Q"in pt)return new Date(pt.Q);if("s"in pt)return new Date(pt.s*1e3+("L"in pt?pt.L:0));if(Qt&&!("Z"in pt)&&(pt.Z=0),"p"in pt&&(pt.H=pt.H%12+pt.p*12),pt.m===void 0&&(pt.m="q"in pt?pt.q:0),"V"in pt){if(pt.V<1||pt.V>53)return null;"w"in pt||(pt.w=1),"Z"in pt?(or=pk(L0(pt.y,0,1)),en=or.getUTCDay(),or=en>4||en===0?fS.ceil(or):fS(or),or=gP.offset(or,(pt.V-1)*7),pt.y=or.getUTCFullYear(),pt.m=or.getUTCMonth(),pt.d=or.getUTCDate()+(pt.w+6)%7):(or=fk(L0(pt.y,0,1)),en=or.getDay(),or=en>4||en===0?mS.ceil(or):mS(or),or=sj.offset(or,(pt.V-1)*7),pt.y=or.getFullYear(),pt.m=or.getMonth(),pt.d=or.getDate()+(pt.w+6)%7)}else("W"in pt||"U"in pt)&&("w"in pt||(pt.w="u"in pt?pt.u%7:"W"in pt?1:0),en="Z"in pt?pk(L0(pt.y,0,1)).getUTCDay():fk(L0(pt.y,0,1)).getDay(),pt.m=0,pt.d="W"in pt?(pt.w+6)%7+pt.W*7-(en+5)%7:pt.w+pt.U*7-(en+6)%7);return"Z"in pt?(pt.H+=pt.Z/100|0,pt.M+=pt.Z%100,pk(pt)):fk(pt)}}function oe(St,Qt,rr,pt){for(var qr=0,or=Qt.length,en=rr.length,Lr,En;qr<or;){if(pt>=en)return-1;if(Lr=Qt.charCodeAt(qr++),Lr===37){if(Lr=Qt.charAt(qr++),En=$[Lr in qz?Qt.charAt(qr++):Lr],!En||(pt=En(St,rr,pt))<0)return-1}else if(Lr!=rr.charCodeAt(pt++))return-1}return pt}function te(St,Qt,rr){var pt=p.exec(Qt.slice(rr));return pt?(St.p=y.get(pt[0].toLowerCase()),rr+pt[0].length):-1}function be(St,Qt,rr){var pt=w.exec(Qt.slice(rr));return pt?(St.w=k.get(pt[0].toLowerCase()),rr+pt[0].length):-1}function ie(St,Qt,rr){var pt=v.exec(Qt.slice(rr));return pt?(St.w=j.get(pt[0].toLowerCase()),rr+pt[0].length):-1}function ge(St,Qt,rr){var pt=D.exec(Qt.slice(rr));return pt?(St.m=T.get(pt[0].toLowerCase()),rr+pt[0].length):-1}function Ie(St,Qt,rr){var pt=S.exec(Qt.slice(rr));return pt?(St.m=R.get(pt[0].toLowerCase()),rr+pt[0].length):-1}function Oe(St,Qt,rr){return oe(St,r,Qt,rr)}function Xe(St,Qt,rr){return oe(St,n,Qt,rr)}function Ue(St,Qt,rr){return oe(St,s,Qt,rr)}function tt(St){return d[St.getDay()]}function Ce(St){return l[St.getDay()]}function ve(St){return f[St.getMonth()]}function rt(St){return a[St.getMonth()]}function vt(St){return i[+(St.getHours()>=12)]}function gt(St){return 1+~~(St.getMonth()/3)}function Et(St){return d[St.getUTCDay()]}function tr(St){return l[St.getUTCDay()]}function Dr(St){return f[St.getUTCMonth()]}function Pr(St){return a[St.getUTCMonth()]}function It(St){return i[+(St.getUTCHours()>=12)]}function _r(St){return 1+~~(St.getUTCMonth()/3)}return{format:function(St){var Qt=W(St+="",I);return Qt.toString=function(){return St},Qt},parse:function(St){var Qt=Z(St+="",!1);return Qt.toString=function(){return St},Qt},utcFormat:function(St){var Qt=W(St+="",L);return Qt.toString=function(){return St},Qt},utcParse:function(St){var Qt=Z(St+="",!0);return Qt.toString=function(){return St},Qt}}}var qz={"-":"",_:" ",0:"0"},ga=/^\s*\d+/,SPe=/^%/,PPe=/[\\^$*+?|[\]().{}]/g;function qn(e,r,n){var s=e<0?"-":"",i=(s?-e:e)+"",l=i.length;return s+(l<n?new Array(n-l+1).join(r)+i:i)}function CPe(e){return e.replace(PPe,"\\$&")}function F0(e){return new RegExp("^(?:"+e.map(CPe).join("|")+")","i")}function z0(e){return new Map(e.map((r,n)=>[r.toLowerCase(),n]))}function APe(e,r,n){var s=ga.exec(r.slice(n,n+1));return s?(e.w=+s[0],n+s[0].length):-1}function kPe(e,r,n){var s=ga.exec(r.slice(n,n+1));return s?(e.u=+s[0],n+s[0].length):-1}function TPe(e,r,n){var s=ga.exec(r.slice(n,n+2));return s?(e.U=+s[0],n+s[0].length):-1}function EPe(e,r,n){var s=ga.exec(r.slice(n,n+2));return s?(e.V=+s[0],n+s[0].length):-1}function MPe(e,r,n){var s=ga.exec(r.slice(n,n+2));return s?(e.W=+s[0],n+s[0].length):-1}function Vz(e,r,n){var s=ga.exec(r.slice(n,n+4));return s?(e.y=+s[0],n+s[0].length):-1}function Uz(e,r,n){var s=ga.exec(r.slice(n,n+2));return s?(e.y=+s[0]+(+s[0]>68?1900:2e3),n+s[0].length):-1}function OPe(e,r,n){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(r.slice(n,n+6));return s?(e.Z=s[1]?0:-(s[2]+(s[3]||"00")),n+s[0].length):-1}function IPe(e,r,n){var s=ga.exec(r.slice(n,n+1));return s?(e.q=s[0]*3-3,n+s[0].length):-1}function DPe(e,r,n){var s=ga.exec(r.slice(n,n+2));return s?(e.m=s[0]-1,n+s[0].length):-1}function Wz(e,r,n){var s=ga.exec(r.slice(n,n+2));return s?(e.d=+s[0],n+s[0].length):-1}function RPe(e,r,n){var s=ga.exec(r.slice(n,n+3));return s?(e.m=0,e.d=+s[0],n+s[0].length):-1}function Gz(e,r,n){var s=ga.exec(r.slice(n,n+2));return s?(e.H=+s[0],n+s[0].length):-1}function LPe(e,r,n){var s=ga.exec(r.slice(n,n+2));return s?(e.M=+s[0],n+s[0].length):-1}function FPe(e,r,n){var s=ga.exec(r.slice(n,n+2));return s?(e.S=+s[0],n+s[0].length):-1}function zPe(e,r,n){var s=ga.exec(r.slice(n,n+3));return s?(e.L=+s[0],n+s[0].length):-1}function $Pe(e,r,n){var s=ga.exec(r.slice(n,n+6));return s?(e.L=Math.floor(s[0]/1e3),n+s[0].length):-1}function BPe(e,r,n){var s=SPe.exec(r.slice(n,n+1));return s?n+s[0].length:-1}function qPe(e,r,n){var s=ga.exec(r.slice(n));return s?(e.Q=+s[0],n+s[0].length):-1}function VPe(e,r,n){var s=ga.exec(r.slice(n));return s?(e.s=+s[0],n+s[0].length):-1}function Kz(e,r){return qn(e.getDate(),r,2)}function UPe(e,r){return qn(e.getHours(),r,2)}function WPe(e,r){return qn(e.getHours()%12||12,r,2)}function GPe(e,r){return qn(1+sj.count(Cu(e),e),r,3)}function XG(e,r){return qn(e.getMilliseconds(),r,3)}function KPe(e,r){return XG(e,r)+"000"}function HPe(e,r){return qn(e.getMonth()+1,r,2)}function ZPe(e,r){return qn(e.getMinutes(),r,2)}function YPe(e,r){return qn(e.getSeconds(),r,2)}function XPe(e){var r=e.getDay();return r===0?7:r}function QPe(e,r){return qn(yP.count(Cu(e)-1,e),r,2)}function QG(e){var r=e.getDay();return r>=4||r===0?ny(e):ny.ceil(e)}function JPe(e,r){return e=QG(e),qn(ny.count(Cu(e),e)+(Cu(e).getDay()===4),r,2)}function eCe(e){return e.getDay()}function tCe(e,r){return qn(mS.count(Cu(e)-1,e),r,2)}function rCe(e,r){return qn(e.getFullYear()%100,r,2)}function nCe(e,r){return e=QG(e),qn(e.getFullYear()%100,r,2)}function sCe(e,r){return qn(e.getFullYear()%1e4,r,4)}function iCe(e,r){var n=e.getDay();return e=n>=4||n===0?ny(e):ny.ceil(e),qn(e.getFullYear()%1e4,r,4)}function aCe(e){var r=e.getTimezoneOffset();return(r>0?"-":(r*=-1,"+"))+qn(r/60|0,"0",2)+qn(r%60,"0",2)}function Hz(e,r){return qn(e.getUTCDate(),r,2)}function oCe(e,r){return qn(e.getUTCHours(),r,2)}function lCe(e,r){return qn(e.getUTCHours()%12||12,r,2)}function cCe(e,r){return qn(1+gP.count(Au(e),e),r,3)}function JG(e,r){return qn(e.getUTCMilliseconds(),r,3)}function dCe(e,r){return JG(e,r)+"000"}function uCe(e,r){return qn(e.getUTCMonth()+1,r,2)}function hCe(e,r){return qn(e.getUTCMinutes(),r,2)}function mCe(e,r){return qn(e.getUTCSeconds(),r,2)}function fCe(e){var r=e.getUTCDay();return r===0?7:r}function pCe(e,r){return qn(vP.count(Au(e)-1,e),r,2)}function eK(e){var r=e.getUTCDay();return r>=4||r===0?sy(e):sy.ceil(e)}function xCe(e,r){return e=eK(e),qn(sy.count(Au(e),e)+(Au(e).getUTCDay()===4),r,2)}function gCe(e){return e.getUTCDay()}function yCe(e,r){return qn(fS.count(Au(e)-1,e),r,2)}function vCe(e,r){return qn(e.getUTCFullYear()%100,r,2)}function _Ce(e,r){return e=eK(e),qn(e.getUTCFullYear()%100,r,2)}function bCe(e,r){return qn(e.getUTCFullYear()%1e4,r,4)}function jCe(e,r){var n=e.getUTCDay();return e=n>=4||n===0?sy(e):sy.ceil(e),qn(e.getUTCFullYear()%1e4,r,4)}function wCe(){return"+0000"}function Zz(){return"%"}function Yz(e){return+e}function Xz(e){return Math.floor(+e/1e3)}var Ix,tK,rK;NCe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function NCe(e){return Ix=NPe(e),tK=Ix.format,Ix.parse,rK=Ix.utcFormat,Ix.utcParse,Ix}function SCe(e){return new Date(e)}function PCe(e){return e instanceof Date?+e:+new Date(+e)}function O4(e,r,n,s,i,l,d,a,f,p){var y=v4(),v=y.invert,j=y.domain,w=p(".%L"),k=p(":%S"),S=p("%I:%M"),R=p("%I %p"),D=p("%a %d"),T=p("%b %d"),I=p("%B"),L=p("%Y");function $(W){return(f(W)<W?w:a(W)<W?k:d(W)<W?S:l(W)<W?R:s(W)<W?i(W)<W?D:T:n(W)<W?I:L)(W)}return y.invert=function(W){return new Date(v(W))},y.domain=function(W){return arguments.length?j(Array.from(W,PCe)):j().map(SCe)},y.ticks=function(W){var Z=j();return e(Z[0],Z[Z.length-1],W??10)},y.tickFormat=function(W,Z){return Z==null?$:p(Z)},y.nice=function(W){var Z=j();return(!W||typeof W.range!="function")&&(W=r(Z[0],Z[Z.length-1],W??10)),W?j(qG(Z,W)):y},y.copy=function(){return nj(y,O4(e,r,n,s,i,l,d,a,f,p))},y}function CCe(){return Vl.apply(O4(jPe,wPe,Cu,E4,yP,sj,k4,C4,Tf,tK).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function ACe(){return Vl.apply(O4(_Pe,bPe,Au,M4,vP,gP,T4,A4,Tf,rK).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function _P(){var e=0,r=1,n,s,i,l,d=mo,a=!1,f;function p(v){return v==null||isNaN(v=+v)?f:d(i===0?.5:(v=(l(v)-n)*i,a?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,r]=v,n=l(e=+e),s=l(r=+r),i=n===s?0:1/(s-n),p):[e,r]},p.clamp=function(v){return arguments.length?(a=!!v,p):a},p.interpolator=function(v){return arguments.length?(d=v,p):d};function y(v){return function(j){var w,k;return arguments.length?([w,k]=j,d=v(w,k),p):[d(0),d(1)]}}return p.range=y(Xy),p.rangeRound=y(y4),p.unknown=function(v){return arguments.length?(f=v,p):f},function(v){return l=v,n=v(e),s=v(r),i=n===s?0:1/(s-n),p}}function Cm(e,r){return r.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function nK(){var e=Pm(_P()(mo));return e.copy=function(){return Cm(e,nK())},Fu.apply(e,arguments)}function sK(){var e=j4(_P()).domain([1,10]);return e.copy=function(){return Cm(e,sK()).base(e.base())},Fu.apply(e,arguments)}function iK(){var e=w4(_P());return e.copy=function(){return Cm(e,iK()).constant(e.constant())},Fu.apply(e,arguments)}function I4(){var e=N4(_P());return e.copy=function(){return Cm(e,I4()).exponent(e.exponent())},Fu.apply(e,arguments)}function kCe(){return I4.apply(null,arguments).exponent(.5)}function aK(){var e=[],r=mo;function n(s){if(s!=null&&!isNaN(s=+s))return r((tj(e,s,1)-1)/(e.length-1))}return n.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let i of s)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(im),n},n.interpolator=function(s){return arguments.length?(r=s,n):r},n.range=function(){return e.map((s,i)=>r(i/(e.length-1)))},n.quantiles=function(s){return Array.from({length:s+1},(i,l)=>p2e(e,l/s))},n.copy=function(){return aK(r).domain(e)},Fu.apply(n,arguments)}function bP(){var e=0,r=.5,n=1,s=1,i,l,d,a,f,p=mo,y,v=!1,j;function w(S){return isNaN(S=+S)?j:(S=.5+((S=+y(S))-l)*(s*S<s*l?a:f),p(v?Math.max(0,Math.min(1,S)):S))}w.domain=function(S){return arguments.length?([e,r,n]=S,i=y(e=+e),l=y(r=+r),d=y(n=+n),a=i===l?0:.5/(l-i),f=l===d?0:.5/(d-l),s=l<i?-1:1,w):[e,r,n]},w.clamp=function(S){return arguments.length?(v=!!S,w):v},w.interpolator=function(S){return arguments.length?(p=S,w):p};function k(S){return function(R){var D,T,I;return arguments.length?([D,T,I]=R,p=B2e(S,[D,T,I]),w):[p(0),p(.5),p(1)]}}return w.range=k(Xy),w.rangeRound=k(y4),w.unknown=function(S){return arguments.length?(j=S,w):j},function(S){return y=S,i=S(e),l=S(r),d=S(n),a=i===l?0:.5/(l-i),f=l===d?0:.5/(d-l),s=l<i?-1:1,w}}function oK(){var e=Pm(bP()(mo));return e.copy=function(){return Cm(e,oK())},Fu.apply(e,arguments)}function lK(){var e=j4(bP()).domain([.1,1,10]);return e.copy=function(){return Cm(e,lK()).base(e.base())},Fu.apply(e,arguments)}function cK(){var e=w4(bP());return e.copy=function(){return Cm(e,cK()).constant(e.constant())},Fu.apply(e,arguments)}function D4(){var e=N4(bP());return e.copy=function(){return Cm(e,D4()).exponent(e.exponent())},Fu.apply(e,arguments)}function TCe(){return D4.apply(null,arguments).exponent(.5)}const Qz=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:sb,scaleDiverging:oK,scaleDivergingLog:lK,scaleDivergingPow:D4,scaleDivergingSqrt:TCe,scaleDivergingSymlog:cK,scaleIdentity:BG,scaleImplicit:YE,scaleLinear:uS,scaleLog:VG,scaleOrdinal:p4,scalePoint:h_,scalePow:S4,scaleQuantile:GG,scaleQuantize:KG,scaleRadial:WG,scaleSequential:nK,scaleSequentialLog:sK,scaleSequentialPow:I4,scaleSequentialQuantile:aK,scaleSequentialSqrt:kCe,scaleSequentialSymlog:iK,scaleSqrt:dPe,scaleSymlog:UG,scaleThreshold:HG,scaleTime:CCe,scaleUtc:ACe,tickFormat:$G},Symbol.toStringTag,{value:"Module"}));var ECe=qy;function MCe(e,r,n){for(var s=-1,i=e.length;++s<i;){var l=e[s],d=r(l);if(d!=null&&(a===void 0?d===d&&!ECe(d):n(d,a)))var a=d,f=l}return f}var jP=MCe;function OCe(e,r){return e>r}var dK=OCe,ICe=jP,DCe=dK,RCe=Yy;function LCe(e){return e&&e.length?ICe(e,RCe,DCe):void 0}var FCe=LCe;const Uh=Vn(FCe);function zCe(e,r){return e<r}var uK=zCe,$Ce=jP,BCe=uK,qCe=Yy;function VCe(e){return e&&e.length?$Ce(e,qCe,BCe):void 0}var UCe=VCe;const wP=Vn(UCe);var WCe=ZI,GCe=_d,KCe=vG,HCe=Ro;function ZCe(e,r){var n=HCe(e)?WCe:KCe;return n(e,GCe(r))}var YCe=ZCe,XCe=gG,QCe=YCe;function JCe(e,r){return XCe(QCe(e,r),1)}var eAe=JCe;const tAe=Vn(eAe);var rAe=d4;function nAe(e,r){return rAe(e,r)}var sAe=nAe;const xm=Vn(sAe);var Qy=1e9,iAe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},L4,Ys=!0,Ll="[DecimalError] ",Vf=Ll+"Invalid argument: ",R4=Ll+"Exponent out of range: ",Jy=Math.floor,jf=Math.pow,aAe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,el,da=1e7,Ds=7,hK=9007199254740991,pS=Jy(hK/Ds),Nr={};Nr.absoluteValue=Nr.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Nr.comparedTo=Nr.cmp=function(e){var r,n,s,i,l=this;if(e=new l.constructor(e),l.s!==e.s)return l.s||-e.s;if(l.e!==e.e)return l.e>e.e^l.s<0?1:-1;for(s=l.d.length,i=e.d.length,r=0,n=s<i?s:i;r<n;++r)if(l.d[r]!==e.d[r])return l.d[r]>e.d[r]^l.s<0?1:-1;return s===i?0:s>i^l.s<0?1:-1};Nr.decimalPlaces=Nr.dp=function(){var e=this,r=e.d.length-1,n=(r-e.e)*Ds;if(r=e.d[r],r)for(;r%10==0;r/=10)n--;return n<0?0:n};Nr.dividedBy=Nr.div=function(e){return hu(this,new this.constructor(e))};Nr.dividedToIntegerBy=Nr.idiv=function(e){var r=this,n=r.constructor;return fs(hu(r,new n(e),0,1),n.precision)};Nr.equals=Nr.eq=function(e){return!this.cmp(e)};Nr.exponent=function(){return $i(this)};Nr.greaterThan=Nr.gt=function(e){return this.cmp(e)>0};Nr.greaterThanOrEqualTo=Nr.gte=function(e){return this.cmp(e)>=0};Nr.isInteger=Nr.isint=function(){return this.e>this.d.length-2};Nr.isNegative=Nr.isneg=function(){return this.s<0};Nr.isPositive=Nr.ispos=function(){return this.s>0};Nr.isZero=function(){return this.s===0};Nr.lessThan=Nr.lt=function(e){return this.cmp(e)<0};Nr.lessThanOrEqualTo=Nr.lte=function(e){return this.cmp(e)<1};Nr.logarithm=Nr.log=function(e){var r,n=this,s=n.constructor,i=s.precision,l=i+5;if(e===void 0)e=new s(10);else if(e=new s(e),e.s<1||e.eq(el))throw Error(Ll+"NaN");if(n.s<1)throw Error(Ll+(n.s?"NaN":"-Infinity"));return n.eq(el)?new s(0):(Ys=!1,r=hu(cb(n,l),cb(e,l),l),Ys=!0,fs(r,i))};Nr.minus=Nr.sub=function(e){var r=this;return e=new r.constructor(e),r.s==e.s?pK(r,e):mK(r,(e.s=-e.s,e))};Nr.modulo=Nr.mod=function(e){var r,n=this,s=n.constructor,i=s.precision;if(e=new s(e),!e.s)throw Error(Ll+"NaN");return n.s?(Ys=!1,r=hu(n,e,0,1).times(e),Ys=!0,n.minus(r)):fs(new s(n),i)};Nr.naturalExponential=Nr.exp=function(){return fK(this)};Nr.naturalLogarithm=Nr.ln=function(){return cb(this)};Nr.negated=Nr.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Nr.plus=Nr.add=function(e){var r=this;return e=new r.constructor(e),r.s==e.s?mK(r,e):pK(r,(e.s=-e.s,e))};Nr.precision=Nr.sd=function(e){var r,n,s,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Vf+e);if(r=$i(i)+1,s=i.d.length-1,n=s*Ds+1,s=i.d[s],s){for(;s%10==0;s/=10)n--;for(s=i.d[0];s>=10;s/=10)n++}return e&&r>n?r:n};Nr.squareRoot=Nr.sqrt=function(){var e,r,n,s,i,l,d,a=this,f=a.constructor;if(a.s<1){if(!a.s)return new f(0);throw Error(Ll+"NaN")}for(e=$i(a),Ys=!1,i=Math.sqrt(+a),i==0||i==1/0?(r=Jc(a.d),(r.length+e)%2==0&&(r+="0"),i=Math.sqrt(r),e=Jy((e+1)/2)-(e<0||e%2),i==1/0?r="5e"+e:(r=i.toExponential(),r=r.slice(0,r.indexOf("e")+1)+e),s=new f(r)):s=new f(i.toString()),n=f.precision,i=d=n+3;;)if(l=s,s=l.plus(hu(a,l,d+2)).times(.5),Jc(l.d).slice(0,d)===(r=Jc(s.d)).slice(0,d)){if(r=r.slice(d-3,d+1),i==d&&r=="4999"){if(fs(l,n+1,0),l.times(l).eq(a)){s=l;break}}else if(r!="9999")break;d+=4}return Ys=!0,fs(s,n)};Nr.times=Nr.mul=function(e){var r,n,s,i,l,d,a,f,p,y=this,v=y.constructor,j=y.d,w=(e=new v(e)).d;if(!y.s||!e.s)return new v(0);for(e.s*=y.s,n=y.e+e.e,f=j.length,p=w.length,f<p&&(l=j,j=w,w=l,d=f,f=p,p=d),l=[],d=f+p,s=d;s--;)l.push(0);for(s=p;--s>=0;){for(r=0,i=f+s;i>s;)a=l[i]+w[s]*j[i-s-1]+r,l[i--]=a%da|0,r=a/da|0;l[i]=(l[i]+r)%da|0}for(;!l[--d];)l.pop();return r?++n:l.shift(),e.d=l,e.e=n,Ys?fs(e,v.precision):e};Nr.toDecimalPlaces=Nr.todp=function(e,r){var n=this,s=n.constructor;return n=new s(n),e===void 0?n:(md(e,0,Qy),r===void 0?r=s.rounding:md(r,0,8),fs(n,e+$i(n)+1,r))};Nr.toExponential=function(e,r){var n,s=this,i=s.constructor;return e===void 0?n=lp(s,!0):(md(e,0,Qy),r===void 0?r=i.rounding:md(r,0,8),s=fs(new i(s),e+1,r),n=lp(s,!0,e+1)),n};Nr.toFixed=function(e,r){var n,s,i=this,l=i.constructor;return e===void 0?lp(i):(md(e,0,Qy),r===void 0?r=l.rounding:md(r,0,8),s=fs(new l(i),e+$i(i)+1,r),n=lp(s.abs(),!1,e+$i(s)+1),i.isneg()&&!i.isZero()?"-"+n:n)};Nr.toInteger=Nr.toint=function(){var e=this,r=e.constructor;return fs(new r(e),$i(e)+1,r.rounding)};Nr.toNumber=function(){return+this};Nr.toPower=Nr.pow=function(e){var r,n,s,i,l,d,a=this,f=a.constructor,p=12,y=+(e=new f(e));if(!e.s)return new f(el);if(a=new f(a),!a.s){if(e.s<1)throw Error(Ll+"Infinity");return a}if(a.eq(el))return a;if(s=f.precision,e.eq(el))return fs(a,s);if(r=e.e,n=e.d.length-1,d=r>=n,l=a.s,d){if((n=y<0?-y:y)<=hK){for(i=new f(el),r=Math.ceil(s/Ds+4),Ys=!1;n%2&&(i=i.times(a),e$(i.d,r)),n=Jy(n/2),n!==0;)a=a.times(a),e$(a.d,r);return Ys=!0,e.s<0?new f(el).div(i):fs(i,s)}}else if(l<0)throw Error(Ll+"NaN");return l=l<0&&e.d[Math.max(r,n)]&1?-1:1,a.s=1,Ys=!1,i=e.times(cb(a,s+p)),Ys=!0,i=fK(i),i.s=l,i};Nr.toPrecision=function(e,r){var n,s,i=this,l=i.constructor;return e===void 0?(n=$i(i),s=lp(i,n<=l.toExpNeg||n>=l.toExpPos)):(md(e,1,Qy),r===void 0?r=l.rounding:md(r,0,8),i=fs(new l(i),e,r),n=$i(i),s=lp(i,e<=n||n<=l.toExpNeg,e)),s};Nr.toSignificantDigits=Nr.tosd=function(e,r){var n=this,s=n.constructor;return e===void 0?(e=s.precision,r=s.rounding):(md(e,1,Qy),r===void 0?r=s.rounding:md(r,0,8)),fs(new s(n),e,r)};Nr.toString=Nr.valueOf=Nr.val=Nr.toJSON=Nr[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,r=$i(e),n=e.constructor;return lp(e,r<=n.toExpNeg||r>=n.toExpPos)};function mK(e,r){var n,s,i,l,d,a,f,p,y=e.constructor,v=y.precision;if(!e.s||!r.s)return r.s||(r=new y(e)),Ys?fs(r,v):r;if(f=e.d,p=r.d,d=e.e,i=r.e,f=f.slice(),l=d-i,l){for(l<0?(s=f,l=-l,a=p.length):(s=p,i=d,a=f.length),d=Math.ceil(v/Ds),a=d>a?d+1:a+1,l>a&&(l=a,s.length=1),s.reverse();l--;)s.push(0);s.reverse()}for(a=f.length,l=p.length,a-l<0&&(l=a,s=p,p=f,f=s),n=0;l;)n=(f[--l]=f[l]+p[l]+n)/da|0,f[l]%=da;for(n&&(f.unshift(n),++i),a=f.length;f[--a]==0;)f.pop();return r.d=f,r.e=i,Ys?fs(r,v):r}function md(e,r,n){if(e!==~~e||e<r||e>n)throw Error(Vf+e)}function Jc(e){var r,n,s,i=e.length-1,l="",d=e[0];if(i>0){for(l+=d,r=1;r<i;r++)s=e[r]+"",n=Ds-s.length,n&&(l+=Sh(n)),l+=s;d=e[r],s=d+"",n=Ds-s.length,n&&(l+=Sh(n))}else if(d===0)return"0";for(;d%10===0;)d/=10;return l+d}var hu=function(){function e(s,i){var l,d=0,a=s.length;for(s=s.slice();a--;)l=s[a]*i+d,s[a]=l%da|0,d=l/da|0;return d&&s.unshift(d),s}function r(s,i,l,d){var a,f;if(l!=d)f=l>d?1:-1;else for(a=f=0;a<l;a++)if(s[a]!=i[a]){f=s[a]>i[a]?1:-1;break}return f}function n(s,i,l){for(var d=0;l--;)s[l]-=d,d=s[l]<i[l]?1:0,s[l]=d*da+s[l]-i[l];for(;!s[0]&&s.length>1;)s.shift()}return function(s,i,l,d){var a,f,p,y,v,j,w,k,S,R,D,T,I,L,$,W,Z,oe,te=s.constructor,be=s.s==i.s?1:-1,ie=s.d,ge=i.d;if(!s.s)return new te(s);if(!i.s)throw Error(Ll+"Division by zero");for(f=s.e-i.e,Z=ge.length,$=ie.length,w=new te(be),k=w.d=[],p=0;ge[p]==(ie[p]||0);)++p;if(ge[p]>(ie[p]||0)&&--f,l==null?T=l=te.precision:d?T=l+($i(s)-$i(i))+1:T=l,T<0)return new te(0);if(T=T/Ds+2|0,p=0,Z==1)for(y=0,ge=ge[0],T++;(p<$||y)&&T--;p++)I=y*da+(ie[p]||0),k[p]=I/ge|0,y=I%ge|0;else{for(y=da/(ge[0]+1)|0,y>1&&(ge=e(ge,y),ie=e(ie,y),Z=ge.length,$=ie.length),L=Z,S=ie.slice(0,Z),R=S.length;R<Z;)S[R++]=0;oe=ge.slice(),oe.unshift(0),W=ge[0],ge[1]>=da/2&&++W;do y=0,a=r(ge,S,Z,R),a<0?(D=S[0],Z!=R&&(D=D*da+(S[1]||0)),y=D/W|0,y>1?(y>=da&&(y=da-1),v=e(ge,y),j=v.length,R=S.length,a=r(v,S,j,R),a==1&&(y--,n(v,Z<j?oe:ge,j))):(y==0&&(a=y=1),v=ge.slice()),j=v.length,j<R&&v.unshift(0),n(S,v,R),a==-1&&(R=S.length,a=r(ge,S,Z,R),a<1&&(y++,n(S,Z<R?oe:ge,R))),R=S.length):a===0&&(y++,S=[0]),k[p++]=y,a&&S[0]?S[R++]=ie[L]||0:(S=[ie[L]],R=1);while((L++<$||S[0]!==void 0)&&T--)}return k[0]||k.shift(),w.e=f,fs(w,d?l+$i(w)+1:l)}}();function fK(e,r){var n,s,i,l,d,a,f=0,p=0,y=e.constructor,v=y.precision;if($i(e)>16)throw Error(R4+$i(e));if(!e.s)return new y(el);for(Ys=!1,a=v,d=new y(.03125);e.abs().gte(.1);)e=e.times(d),p+=5;for(s=Math.log(jf(2,p))/Math.LN10*2+5|0,a+=s,n=i=l=new y(el),y.precision=a;;){if(i=fs(i.times(e),a),n=n.times(++f),d=l.plus(hu(i,n,a)),Jc(d.d).slice(0,a)===Jc(l.d).slice(0,a)){for(;p--;)l=fs(l.times(l),a);return y.precision=v,r==null?(Ys=!0,fs(l,v)):l}l=d}}function $i(e){for(var r=e.e*Ds,n=e.d[0];n>=10;n/=10)r++;return r}function xk(e,r,n){if(r>e.LN10.sd())throw Ys=!0,n&&(e.precision=n),Error(Ll+"LN10 precision limit exceeded");return fs(new e(e.LN10),r)}function Sh(e){for(var r="";e--;)r+="0";return r}function cb(e,r){var n,s,i,l,d,a,f,p,y,v=1,j=10,w=e,k=w.d,S=w.constructor,R=S.precision;if(w.s<1)throw Error(Ll+(w.s?"NaN":"-Infinity"));if(w.eq(el))return new S(0);if(r==null?(Ys=!1,p=R):p=r,w.eq(10))return r==null&&(Ys=!0),xk(S,p);if(p+=j,S.precision=p,n=Jc(k),s=n.charAt(0),l=$i(w),Math.abs(l)<15e14){for(;s<7&&s!=1||s==1&&n.charAt(1)>3;)w=w.times(e),n=Jc(w.d),s=n.charAt(0),v++;l=$i(w),s>1?(w=new S("0."+n),l++):w=new S(s+"."+n.slice(1))}else return f=xk(S,p+2,R).times(l+""),w=cb(new S(s+"."+n.slice(1)),p-j).plus(f),S.precision=R,r==null?(Ys=!0,fs(w,R)):w;for(a=d=w=hu(w.minus(el),w.plus(el),p),y=fs(w.times(w),p),i=3;;){if(d=fs(d.times(y),p),f=a.plus(hu(d,new S(i),p)),Jc(f.d).slice(0,p)===Jc(a.d).slice(0,p))return a=a.times(2),l!==0&&(a=a.plus(xk(S,p+2,R).times(l+""))),a=hu(a,new S(v),p),S.precision=R,r==null?(Ys=!0,fs(a,R)):a;a=f,i+=2}}function Jz(e,r){var n,s,i;for((n=r.indexOf("."))>-1&&(r=r.replace(".","")),(s=r.search(/e/i))>0?(n<0&&(n=s),n+=+r.slice(s+1),r=r.substring(0,s)):n<0&&(n=r.length),s=0;r.charCodeAt(s)===48;)++s;for(i=r.length;r.charCodeAt(i-1)===48;)--i;if(r=r.slice(s,i),r){if(i-=s,n=n-s-1,e.e=Jy(n/Ds),e.d=[],s=(n+1)%Ds,n<0&&(s+=Ds),s<i){for(s&&e.d.push(+r.slice(0,s)),i-=Ds;s<i;)e.d.push(+r.slice(s,s+=Ds));r=r.slice(s),s=Ds-r.length}else s-=i;for(;s--;)r+="0";if(e.d.push(+r),Ys&&(e.e>pS||e.e<-pS))throw Error(R4+n)}else e.s=0,e.e=0,e.d=[0];return e}function fs(e,r,n){var s,i,l,d,a,f,p,y,v=e.d;for(d=1,l=v[0];l>=10;l/=10)d++;if(s=r-d,s<0)s+=Ds,i=r,p=v[y=0];else{if(y=Math.ceil((s+1)/Ds),l=v.length,y>=l)return e;for(p=l=v[y],d=1;l>=10;l/=10)d++;s%=Ds,i=s-Ds+d}if(n!==void 0&&(l=jf(10,d-i-1),a=p/l%10|0,f=r<0||v[y+1]!==void 0||p%l,f=n<4?(a||f)&&(n==0||n==(e.s<0?3:2)):a>5||a==5&&(n==4||f||n==6&&(s>0?i>0?p/jf(10,d-i):0:v[y-1])%10&1||n==(e.s<0?8:7))),r<1||!v[0])return f?(l=$i(e),v.length=1,r=r-l-1,v[0]=jf(10,(Ds-r%Ds)%Ds),e.e=Jy(-r/Ds)||0):(v.length=1,v[0]=e.e=e.s=0),e;if(s==0?(v.length=y,l=1,y--):(v.length=y+1,l=jf(10,Ds-s),v[y]=i>0?(p/jf(10,d-i)%jf(10,i)|0)*l:0),f)for(;;)if(y==0){(v[0]+=l)==da&&(v[0]=1,++e.e);break}else{if(v[y]+=l,v[y]!=da)break;v[y--]=0,l=1}for(s=v.length;v[--s]===0;)v.pop();if(Ys&&(e.e>pS||e.e<-pS))throw Error(R4+$i(e));return e}function pK(e,r){var n,s,i,l,d,a,f,p,y,v,j=e.constructor,w=j.precision;if(!e.s||!r.s)return r.s?r.s=-r.s:r=new j(e),Ys?fs(r,w):r;if(f=e.d,v=r.d,s=r.e,p=e.e,f=f.slice(),d=p-s,d){for(y=d<0,y?(n=f,d=-d,a=v.length):(n=v,s=p,a=f.length),i=Math.max(Math.ceil(w/Ds),a)+2,d>i&&(d=i,n.length=1),n.reverse(),i=d;i--;)n.push(0);n.reverse()}else{for(i=f.length,a=v.length,y=i<a,y&&(a=i),i=0;i<a;i++)if(f[i]!=v[i]){y=f[i]<v[i];break}d=0}for(y&&(n=f,f=v,v=n,r.s=-r.s),a=f.length,i=v.length-a;i>0;--i)f[a++]=0;for(i=v.length;i>d;){if(f[--i]<v[i]){for(l=i;l&&f[--l]===0;)f[l]=da-1;--f[l],f[i]+=da}f[i]-=v[i]}for(;f[--a]===0;)f.pop();for(;f[0]===0;f.shift())--s;return f[0]?(r.d=f,r.e=s,Ys?fs(r,w):r):new j(0)}function lp(e,r,n){var s,i=$i(e),l=Jc(e.d),d=l.length;return r?(n&&(s=n-d)>0?l=l.charAt(0)+"."+l.slice(1)+Sh(s):d>1&&(l=l.charAt(0)+"."+l.slice(1)),l=l+(i<0?"e":"e+")+i):i<0?(l="0."+Sh(-i-1)+l,n&&(s=n-d)>0&&(l+=Sh(s))):i>=d?(l+=Sh(i+1-d),n&&(s=n-i-1)>0&&(l=l+"."+Sh(s))):((s=i+1)<d&&(l=l.slice(0,s)+"."+l.slice(s)),n&&(s=n-d)>0&&(i+1===d&&(l+="."),l+=Sh(s))),e.s<0?"-"+l:l}function e$(e,r){if(e.length>r)return e.length=r,!0}function xK(e){var r,n,s;function i(l){var d=this;if(!(d instanceof i))return new i(l);if(d.constructor=i,l instanceof i){d.s=l.s,d.e=l.e,d.d=(l=l.d)?l.slice():l;return}if(typeof l=="number"){if(l*0!==0)throw Error(Vf+l);if(l>0)d.s=1;else if(l<0)l=-l,d.s=-1;else{d.s=0,d.e=0,d.d=[0];return}if(l===~~l&&l<1e7){d.e=0,d.d=[l];return}return Jz(d,l.toString())}else if(typeof l!="string")throw Error(Vf+l);if(l.charCodeAt(0)===45?(l=l.slice(1),d.s=-1):d.s=1,aAe.test(l))Jz(d,l);else throw Error(Vf+l)}if(i.prototype=Nr,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=xK,i.config=i.set=oAe,e===void 0&&(e={}),e)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],r=0;r<s.length;)e.hasOwnProperty(n=s[r++])||(e[n]=this[n]);return i.config(e),i}function oAe(e){if(!e||typeof e!="object")throw Error(Ll+"Object expected");var r,n,s,i=["precision",1,Qy,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(r=0;r<i.length;r+=3)if((s=e[n=i[r]])!==void 0)if(Jy(s)===s&&s>=i[r+1]&&s<=i[r+2])this[n]=s;else throw Error(Vf+n+": "+s);if((s=e[n="LN10"])!==void 0)if(s==Math.LN10)this[n]=new this(s);else throw Error(Vf+n+": "+s);return this}var L4=xK(iAe);el=new L4(1);const os=L4;function lAe(e){return hAe(e)||uAe(e)||dAe(e)||cAe()}function cAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dAe(e,r){if(e){if(typeof e=="string")return eM(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eM(e,r)}}function uAe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function hAe(e){if(Array.isArray(e))return eM(e)}function eM(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}var mAe=function(r){return r},gK={},yK=function(r){return r===gK},t$=function(r){return function n(){return arguments.length===0||arguments.length===1&&yK(arguments.length<=0?void 0:arguments[0])?n:r.apply(void 0,arguments)}},fAe=function e(r,n){return r===1?n:t$(function(){for(var s=arguments.length,i=new Array(s),l=0;l<s;l++)i[l]=arguments[l];var d=i.filter(function(a){return a!==gK}).length;return d>=r?n.apply(void 0,i):e(r-d,t$(function(){for(var a=arguments.length,f=new Array(a),p=0;p<a;p++)f[p]=arguments[p];var y=i.map(function(v){return yK(v)?f.shift():v});return n.apply(void 0,lAe(y).concat(f))}))})},NP=function(r){return fAe(r.length,r)},tM=function(r,n){for(var s=[],i=r;i<n;++i)s[i-r]=i;return s},pAe=NP(function(e,r){return Array.isArray(r)?r.map(e):Object.keys(r).map(function(n){return r[n]}).map(e)}),xAe=function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];if(!n.length)return mAe;var i=n.reverse(),l=i[0],d=i.slice(1);return function(){return d.reduce(function(a,f){return f(a)},l.apply(void 0,arguments))}},rM=function(r){return Array.isArray(r)?r.reverse():r.split("").reverse.join("")},vK=function(r){var n=null,s=null;return function(){for(var i=arguments.length,l=new Array(i),d=0;d<i;d++)l[d]=arguments[d];return n&&l.every(function(a,f){return a===n[f]})||(n=l,s=r.apply(void 0,l)),s}};function gAe(e){var r;return e===0?r=1:r=Math.floor(new os(e).abs().log(10).toNumber())+1,r}function yAe(e,r,n){for(var s=new os(e),i=0,l=[];s.lt(r)&&i<1e5;)l.push(s.toNumber()),s=s.add(n),i++;return l}var vAe=NP(function(e,r,n){var s=+e,i=+r;return s+n*(i-s)}),_Ae=NP(function(e,r,n){var s=r-+e;return s=s||1/0,(n-e)/s}),bAe=NP(function(e,r,n){var s=r-+e;return s=s||1/0,Math.max(0,Math.min(1,(n-e)/s))});const SP={rangeStep:yAe,getDigitCount:gAe,interpolateNumber:vAe,uninterpolateNumber:_Ae,uninterpolateTruncation:bAe};function nM(e){return NAe(e)||wAe(e)||_K(e)||jAe()}function jAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wAe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function NAe(e){if(Array.isArray(e))return sM(e)}function db(e,r){return CAe(e)||PAe(e,r)||_K(e,r)||SAe()}function SAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _K(e,r){if(e){if(typeof e=="string")return sM(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sM(e,r)}}function sM(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}function PAe(e,r){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],s=!0,i=!1,l=void 0;try{for(var d=e[Symbol.iterator](),a;!(s=(a=d.next()).done)&&(n.push(a.value),!(r&&n.length===r));s=!0);}catch(f){i=!0,l=f}finally{try{!s&&d.return!=null&&d.return()}finally{if(i)throw l}}return n}}function CAe(e){if(Array.isArray(e))return e}function bK(e){var r=db(e,2),n=r[0],s=r[1],i=n,l=s;return n>s&&(i=s,l=n),[i,l]}function jK(e,r,n){if(e.lte(0))return new os(0);var s=SP.getDigitCount(e.toNumber()),i=new os(10).pow(s),l=e.div(i),d=s!==1?.05:.1,a=new os(Math.ceil(l.div(d).toNumber())).add(n).mul(d),f=a.mul(i);return r?f:new os(Math.ceil(f))}function AAe(e,r,n){var s=1,i=new os(e);if(!i.isint()&&n){var l=Math.abs(e);l<1?(s=new os(10).pow(SP.getDigitCount(e)-1),i=new os(Math.floor(i.div(s).toNumber())).mul(s)):l>1&&(i=new os(Math.floor(e)))}else e===0?i=new os(Math.floor((r-1)/2)):n||(i=new os(Math.floor(e)));var d=Math.floor((r-1)/2),a=xAe(pAe(function(f){return i.add(new os(f-d).mul(s)).toNumber()}),tM);return a(0,r)}function wK(e,r,n,s){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-e)/(n-1)))return{step:new os(0),tickMin:new os(0),tickMax:new os(0)};var l=jK(new os(r).sub(e).div(n-1),s,i),d;e<=0&&r>=0?d=new os(0):(d=new os(e).add(r).div(2),d=d.sub(new os(d).mod(l)));var a=Math.ceil(d.sub(e).div(l).toNumber()),f=Math.ceil(new os(r).sub(d).div(l).toNumber()),p=a+f+1;return p>n?wK(e,r,n,s,i+1):(p<n&&(f=r>0?f+(n-p):f,a=r>0?a:a+(n-p)),{step:l,tickMin:d.sub(new os(a).mul(l)),tickMax:d.add(new os(f).mul(l))})}function kAe(e){var r=db(e,2),n=r[0],s=r[1],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,d=Math.max(i,2),a=bK([n,s]),f=db(a,2),p=f[0],y=f[1];if(p===-1/0||y===1/0){var v=y===1/0?[p].concat(nM(tM(0,i-1).map(function(){return 1/0}))):[].concat(nM(tM(0,i-1).map(function(){return-1/0})),[y]);return n>s?rM(v):v}if(p===y)return AAe(p,i,l);var j=wK(p,y,d,l),w=j.step,k=j.tickMin,S=j.tickMax,R=SP.rangeStep(k,S.add(new os(.1).mul(w)),w);return n>s?rM(R):R}function TAe(e,r){var n=db(e,2),s=n[0],i=n[1],l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,d=bK([s,i]),a=db(d,2),f=a[0],p=a[1];if(f===-1/0||p===1/0)return[s,i];if(f===p)return[f];var y=Math.max(r,2),v=jK(new os(p).sub(f).div(y-1),l,0),j=[].concat(nM(SP.rangeStep(new os(f),new os(p).sub(new os(.99).mul(v)),v)),[p]);return s>i?rM(j):j}var EAe=vK(kAe),MAe=vK(TAe),OAe="Invariant failed";function cp(e,r){throw new Error(OAe)}var IAe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function iy(e){"@babel/helpers - typeof";return iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},iy(e)}function xS(){return xS=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},xS.apply(this,arguments)}function DAe(e,r){return zAe(e)||FAe(e,r)||LAe(e,r)||RAe()}function RAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LAe(e,r){if(e){if(typeof e=="string")return r$(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r$(e,r)}}function r$(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}function FAe(e,r){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,l,d,a=[],f=!0,p=!1;try{if(l=(n=n.call(e)).next,r!==0)for(;!(f=(s=l.call(n)).done)&&(a.push(s.value),a.length!==r);f=!0);}catch(y){p=!0,i=y}finally{try{if(!f&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(p)throw i}}return a}}function zAe(e){if(Array.isArray(e))return e}function $Ae(e,r){if(e==null)return{};var n=BAe(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function BAe(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}function qAe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function VAe(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,PK(s.key),s)}}function UAe(e,r,n){return r&&VAe(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WAe(e,r,n){return r=gS(r),GAe(e,NK()?Reflect.construct(r,n||[],gS(e).constructor):r.apply(e,n))}function GAe(e,r){if(r&&(iy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KAe(e)}function KAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NK=function(){return!!e})()}function gS(e){return gS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},gS(e)}function HAe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&iM(e,r)}function iM(e,r){return iM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},iM(e,r)}function SK(e,r,n){return r=PK(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function PK(e){var r=ZAe(e,"string");return iy(r)=="symbol"?r:r+""}function ZAe(e,r){if(iy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(iy(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ij=function(e){function r(){return qAe(this,r),WAe(this,r,arguments)}return HAe(r,e),UAe(r,[{key:"render",value:function(){var s=this.props,i=s.offset,l=s.layout,d=s.width,a=s.dataKey,f=s.data,p=s.dataPointFormatter,y=s.xAxis,v=s.yAxis,j=$Ae(s,IAe),w=Cr(j,!1);this.props.direction==="x"&&y.type!=="number"&&cp();var k=f.map(function(S){var R=p(S,a),D=R.x,T=R.y,I=R.value,L=R.errorVal;if(!L)return null;var $=[],W,Z;if(Array.isArray(L)){var oe=DAe(L,2);W=oe[0],Z=oe[1]}else W=Z=L;if(l==="vertical"){var te=y.scale,be=T+i,ie=be+d,ge=be-d,Ie=te(I-W),Oe=te(I+Z);$.push({x1:Oe,y1:ie,x2:Oe,y2:ge}),$.push({x1:Ie,y1:be,x2:Oe,y2:be}),$.push({x1:Ie,y1:ie,x2:Ie,y2:ge})}else if(l==="horizontal"){var Xe=v.scale,Ue=D+i,tt=Ue-d,Ce=Ue+d,ve=Xe(I-W),rt=Xe(I+Z);$.push({x1:tt,y1:rt,x2:Ce,y2:rt}),$.push({x1:Ue,y1:ve,x2:Ue,y2:rt}),$.push({x1:tt,y1:ve,x2:Ce,y2:ve})}return me.createElement(gn,xS({className:"recharts-errorBar",key:"bar-".concat($.map(function(vt){return"".concat(vt.x1,"-").concat(vt.x2,"-").concat(vt.y1,"-").concat(vt.y2)}))},w),$.map(function(vt){return me.createElement("line",xS({},vt,{key:"line-".concat(vt.x1,"-").concat(vt.x2,"-").concat(vt.y1,"-").concat(vt.y2)}))}))});return me.createElement(gn,{className:"recharts-errorBars"},k)}}])}(me.Component);SK(ij,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});SK(ij,"displayName","ErrorBar");function ub(e){"@babel/helpers - typeof";return ub=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ub(e)}function n$(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function ff(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?n$(Object(n),!0).forEach(function(s){YAe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):n$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function YAe(e,r,n){return r=XAe(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function XAe(e){var r=QAe(e,"string");return ub(r)=="symbol"?r:r+""}function QAe(e,r){if(ub(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(ub(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var CK=function(r){var n=r.children,s=r.formattedGraphicalItems,i=r.legendWidth,l=r.legendContent,d=Yo(n,pa);if(!d)return null;var a=pa.defaultProps,f=a!==void 0?ff(ff({},a),d.props):{},p;return d.props&&d.props.payload?p=d.props&&d.props.payload:l==="children"?p=(s||[]).reduce(function(y,v){var j=v.item,w=v.props,k=w.sectors||w.data||[];return y.concat(k.map(function(S){return{type:d.props.iconType||j.props.legendType,value:S.name,color:S.fill,payload:S}}))},[]):p=(s||[]).map(function(y){var v=y.item,j=v.type.defaultProps,w=j!==void 0?ff(ff({},j),v.props):{},k=w.dataKey,S=w.name,R=w.legendType,D=w.hide;return{inactive:D,dataKey:k,type:f.iconType||R||"square",color:F4(v),value:S||k,payload:w}}),ff(ff(ff({},f),pa.getWithHeight(d,i)),{},{payload:p,item:d})};function hb(e){"@babel/helpers - typeof";return hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},hb(e)}function s$(e){return rke(e)||tke(e)||eke(e)||JAe()}function JAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eke(e,r){if(e){if(typeof e=="string")return aM(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return aM(e,r)}}function tke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rke(e){if(Array.isArray(e))return aM(e)}function aM(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}function i$(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function gi(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?i$(Object(n),!0).forEach(function(s){vg(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function vg(e,r,n){return r=nke(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function nke(e){var r=ske(e,"string");return hb(r)=="symbol"?r:r+""}function ske(e,r){if(hb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(hb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function ii(e,r,n){return Zr(e)||Zr(r)?n:ea(r)?sl(e,r,n):Br(r)?r(e):n}function m_(e,r,n,s){var i=tAe(e,function(a){return ii(a,r)});if(n==="number"){var l=i.filter(function(a){return Xt(a)||parseFloat(a)});return l.length?[wP(l),Uh(l)]:[1/0,-1/0]}var d=s?i.filter(function(a){return!Zr(a)}):i;return d.map(function(a){return ea(a)||a instanceof Date?a:""})}var ike=function(r){var n,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,d=-1,a=(n=s==null?void 0:s.length)!==null&&n!==void 0?n:0;if(a<=1)return 0;if(l&&l.axisType==="angleAxis"&&Math.abs(Math.abs(l.range[1]-l.range[0])-360)<=1e-6)for(var f=l.range,p=0;p<a;p++){var y=p>0?i[p-1].coordinate:i[a-1].coordinate,v=i[p].coordinate,j=p>=a-1?i[0].coordinate:i[p+1].coordinate,w=void 0;if(uo(v-y)!==uo(j-v)){var k=[];if(uo(j-v)===uo(f[1]-f[0])){w=j;var S=v+f[1]-f[0];k[0]=Math.min(S,(S+y)/2),k[1]=Math.max(S,(S+y)/2)}else{w=y;var R=j+f[1]-f[0];k[0]=Math.min(v,(R+v)/2),k[1]=Math.max(v,(R+v)/2)}var D=[Math.min(v,(w+v)/2),Math.max(v,(w+v)/2)];if(r>D[0]&&r<=D[1]||r>=k[0]&&r<=k[1]){d=i[p].index;break}}else{var T=Math.min(y,j),I=Math.max(y,j);if(r>(T+v)/2&&r<=(I+v)/2){d=i[p].index;break}}}else for(var L=0;L<a;L++)if(L===0&&r<=(s[L].coordinate+s[L+1].coordinate)/2||L>0&&L<a-1&&r>(s[L].coordinate+s[L-1].coordinate)/2&&r<=(s[L].coordinate+s[L+1].coordinate)/2||L===a-1&&r>(s[L].coordinate+s[L-1].coordinate)/2){d=s[L].index;break}return d},F4=function(r){var n,s=r,i=s.type.displayName,l=(n=r.type)!==null&&n!==void 0&&n.defaultProps?gi(gi({},r.type.defaultProps),r.props):r.props,d=l.stroke,a=l.fill,f;switch(i){case"Line":f=d;break;case"Area":case"Radar":f=d&&d!=="none"?d:a;break;default:f=a;break}return f},ake=function(r){var n=r.barSize,s=r.totalSize,i=r.stackGroups,l=i===void 0?{}:i;if(!l)return{};for(var d={},a=Object.keys(l),f=0,p=a.length;f<p;f++)for(var y=l[a[f]].stackGroups,v=Object.keys(y),j=0,w=v.length;j<w;j++){var k=y[v[j]],S=k.items,R=k.cateAxisId,D=S.filter(function(Z){return uu(Z.type).indexOf("Bar")>=0});if(D&&D.length){var T=D[0].type.defaultProps,I=T!==void 0?gi(gi({},T),D[0].props):D[0].props,L=I.barSize,$=I[R];d[$]||(d[$]=[]);var W=Zr(L)?n:L;d[$].push({item:D[0],stackList:D.slice(1),barSize:Zr(W)?void 0:ho(W,s,0)})}}return d},oke=function(r){var n=r.barGap,s=r.barCategoryGap,i=r.bandSize,l=r.sizeList,d=l===void 0?[]:l,a=r.maxBarSize,f=d.length;if(f<1)return null;var p=ho(n,i,0,!0),y,v=[];if(d[0].barSize===+d[0].barSize){var j=!1,w=i/f,k=d.reduce(function(L,$){return L+$.barSize||0},0);k+=(f-1)*p,k>=i&&(k-=(f-1)*p,p=0),k>=i&&w>0&&(j=!0,w*=.9,k=f*w);var S=(i-k)/2>>0,R={offset:S-p,size:0};y=d.reduce(function(L,$){var W={item:$.item,position:{offset:R.offset+R.size+p,size:j?w:$.barSize}},Z=[].concat(s$(L),[W]);return R=Z[Z.length-1].position,$.stackList&&$.stackList.length&&$.stackList.forEach(function(oe){Z.push({item:oe,position:R})}),Z},v)}else{var D=ho(s,i,0,!0);i-2*D-(f-1)*p<=0&&(p=0);var T=(i-2*D-(f-1)*p)/f;T>1&&(T>>=0);var I=a===+a?Math.min(T,a):T;y=d.reduce(function(L,$,W){var Z=[].concat(s$(L),[{item:$.item,position:{offset:D+(T+p)*W+(T-I)/2,size:I}}]);return $.stackList&&$.stackList.length&&$.stackList.forEach(function(oe){Z.push({item:oe,position:Z[Z.length-1].position})}),Z},v)}return y},lke=function(r,n,s,i){var l=s.children,d=s.width,a=s.margin,f=d-(a.left||0)-(a.right||0),p=CK({children:l,legendWidth:f});if(p){var y=i||{},v=y.width,j=y.height,w=p.align,k=p.verticalAlign,S=p.layout;if((S==="vertical"||S==="horizontal"&&k==="middle")&&w!=="center"&&Xt(r[w]))return gi(gi({},r),{},vg({},w,r[w]+(v||0)));if((S==="horizontal"||S==="vertical"&&w==="center")&&k!=="middle"&&Xt(r[k]))return gi(gi({},r),{},vg({},k,r[k]+(j||0)))}return r},cke=function(r,n,s){return Zr(n)?!0:r==="horizontal"?n==="yAxis":r==="vertical"||s==="x"?n==="xAxis":s==="y"?n==="yAxis":!0},AK=function(r,n,s,i,l){var d=n.props.children,a=il(d,ij).filter(function(p){return cke(i,l,p.props.direction)});if(a&&a.length){var f=a.map(function(p){return p.props.dataKey});return r.reduce(function(p,y){var v=ii(y,s);if(Zr(v))return p;var j=Array.isArray(v)?[wP(v),Uh(v)]:[v,v],w=f.reduce(function(k,S){var R=ii(y,S,0),D=j[0]-Math.abs(Array.isArray(R)?R[0]:R),T=j[1]+Math.abs(Array.isArray(R)?R[1]:R);return[Math.min(D,k[0]),Math.max(T,k[1])]},[1/0,-1/0]);return[Math.min(w[0],p[0]),Math.max(w[1],p[1])]},[1/0,-1/0])}return null},dke=function(r,n,s,i,l){var d=n.map(function(a){return AK(r,a,s,l,i)}).filter(function(a){return!Zr(a)});return d&&d.length?d.reduce(function(a,f){return[Math.min(a[0],f[0]),Math.max(a[1],f[1])]},[1/0,-1/0]):null},kK=function(r,n,s,i,l){var d=n.map(function(f){var p=f.props.dataKey;return s==="number"&&p&&AK(r,f,p,i)||m_(r,p,s,l)});if(s==="number")return d.reduce(function(f,p){return[Math.min(f[0],p[0]),Math.max(f[1],p[1])]},[1/0,-1/0]);var a={};return d.reduce(function(f,p){for(var y=0,v=p.length;y<v;y++)a[p[y]]||(a[p[y]]=!0,f.push(p[y]));return f},[])},TK=function(r,n){return r==="horizontal"&&n==="xAxis"||r==="vertical"&&n==="yAxis"||r==="centric"&&n==="angleAxis"||r==="radial"&&n==="radiusAxis"},EK=function(r,n,s,i){if(i)return r.map(function(f){return f.coordinate});var l,d,a=r.map(function(f){return f.coordinate===n&&(l=!0),f.coordinate===s&&(d=!0),f.coordinate});return l||a.push(n),d||a.push(s),a},lu=function(r,n,s){if(!r)return null;var i=r.scale,l=r.duplicateDomain,d=r.type,a=r.range,f=r.realScaleType==="scaleBand"?i.bandwidth()/2:2,p=(n||s)&&d==="category"&&i.bandwidth?i.bandwidth()/f:0;if(p=r.axisType==="angleAxis"&&(a==null?void 0:a.length)>=2?uo(a[0]-a[1])*2*p:p,n&&(r.ticks||r.niceTicks)){var y=(r.ticks||r.niceTicks).map(function(v){var j=l?l.indexOf(v):v;return{coordinate:i(j)+p,value:v,offset:p}});return y.filter(function(v){return!Ky(v.coordinate)})}return r.isCategorical&&r.categoricalDomain?r.categoricalDomain.map(function(v,j){return{coordinate:i(v)+p,value:v,index:j,offset:p}}):i.ticks&&!s?i.ticks(r.tickCount).map(function(v){return{coordinate:i(v)+p,value:v,offset:p}}):i.domain().map(function(v,j){return{coordinate:i(v)+p,value:l?l[v]:v,index:j,offset:p}})},gk=new WeakMap,b1=function(r,n){if(typeof n!="function")return r;gk.has(r)||gk.set(r,new WeakMap);var s=gk.get(r);if(s.has(n))return s.get(n);var i=function(){r.apply(void 0,arguments),n.apply(void 0,arguments)};return s.set(n,i),i},MK=function(r,n,s){var i=r.scale,l=r.type,d=r.layout,a=r.axisType;if(i==="auto")return d==="radial"&&a==="radiusAxis"?{scale:sb(),realScaleType:"band"}:d==="radial"&&a==="angleAxis"?{scale:uS(),realScaleType:"linear"}:l==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!s)?{scale:h_(),realScaleType:"point"}:l==="category"?{scale:sb(),realScaleType:"band"}:{scale:uS(),realScaleType:"linear"};if(Jb(i)){var f="scale".concat(cP(i));return{scale:(Qz[f]||h_)(),realScaleType:Qz[f]?f:"point"}}return Br(i)?{scale:i}:{scale:h_(),realScaleType:"point"}},a$=1e-4,OK=function(r){var n=r.domain();if(!(!n||n.length<=2)){var s=n.length,i=r.range(),l=Math.min(i[0],i[1])-a$,d=Math.max(i[0],i[1])+a$,a=r(n[0]),f=r(n[s-1]);(a<l||a>d||f<l||f>d)&&r.domain([n[0],n[s-1]])}},uke=function(r,n){if(!r)return null;for(var s=0,i=r.length;s<i;s++)if(r[s].item===n)return r[s].position;return null},hke=function(r,n){if(!n||n.length!==2||!Xt(n[0])||!Xt(n[1]))return r;var s=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]),l=[r[0],r[1]];return(!Xt(r[0])||r[0]<s)&&(l[0]=s),(!Xt(r[1])||r[1]>i)&&(l[1]=i),l[0]>i&&(l[0]=i),l[1]<s&&(l[1]=s),l},mke=function(r){var n=r.length;if(!(n<=0))for(var s=0,i=r[0].length;s<i;++s)for(var l=0,d=0,a=0;a<n;++a){var f=Ky(r[a][s][1])?r[a][s][0]:r[a][s][1];f>=0?(r[a][s][0]=l,r[a][s][1]=l+f,l=r[a][s][1]):(r[a][s][0]=d,r[a][s][1]=d+f,d=r[a][s][1])}},fke=function(r){var n=r.length;if(!(n<=0))for(var s=0,i=r[0].length;s<i;++s)for(var l=0,d=0;d<n;++d){var a=Ky(r[d][s][1])?r[d][s][0]:r[d][s][1];a>=0?(r[d][s][0]=l,r[d][s][1]=l+a,l=r[d][s][1]):(r[d][s][0]=0,r[d][s][1]=0)}},pke={sign:mke,expand:Iye,none:Xg,silhouette:Dye,wiggle:Rye,positive:fke},xke=function(r,n,s){var i=n.map(function(a){return a.props.dataKey}),l=pke[s],d=Oye().keys(i).value(function(a,f){return+ii(a,f,0)}).order(EE).offset(l);return d(r)},gke=function(r,n,s,i,l,d){if(!r)return null;var a=d?n.reverse():n,f={},p=a.reduce(function(v,j){var w,k=(w=j.type)!==null&&w!==void 0&&w.defaultProps?gi(gi({},j.type.defaultProps),j.props):j.props,S=k.stackId,R=k.hide;if(R)return v;var D=k[s],T=v[D]||{hasStack:!1,stackGroups:{}};if(ea(S)){var I=T.stackGroups[S]||{numericAxisId:s,cateAxisId:i,items:[]};I.items.push(j),T.hasStack=!0,T.stackGroups[S]=I}else T.stackGroups[gp("_stackId_")]={numericAxisId:s,cateAxisId:i,items:[j]};return gi(gi({},v),{},vg({},D,T))},f),y={};return Object.keys(p).reduce(function(v,j){var w=p[j];if(w.hasStack){var k={};w.stackGroups=Object.keys(w.stackGroups).reduce(function(S,R){var D=w.stackGroups[R];return gi(gi({},S),{},vg({},R,{numericAxisId:s,cateAxisId:i,items:D.items,stackedData:xke(r,D.items,l)}))},k)}return gi(gi({},v),{},vg({},j,w))},y)},IK=function(r,n){var s=n.realScaleType,i=n.type,l=n.tickCount,d=n.originalDomain,a=n.allowDecimals,f=s||n.scale;if(f!=="auto"&&f!=="linear")return null;if(l&&i==="number"&&d&&(d[0]==="auto"||d[1]==="auto")){var p=r.domain();if(!p.length)return null;var y=EAe(p,l,a);return r.domain([wP(y),Uh(y)]),{niceTicks:y}}if(l&&i==="number"){var v=r.domain(),j=MAe(v,l,a);return{niceTicks:j}}return null};function yS(e){var r=e.axis,n=e.ticks,s=e.bandSize,i=e.entry,l=e.index,d=e.dataKey;if(r.type==="category"){if(!r.allowDuplicatedCategory&&r.dataKey&&!Zr(i[r.dataKey])){var a=UN(n,"value",i[r.dataKey]);if(a)return a.coordinate+s/2}return n[l]?n[l].coordinate+s/2:null}var f=ii(i,Zr(d)?r.dataKey:d);return Zr(f)?null:r.scale(f)}var o$=function(r){var n=r.axis,s=r.ticks,i=r.offset,l=r.bandSize,d=r.entry,a=r.index;if(n.type==="category")return s[a]?s[a].coordinate+i:null;var f=ii(d,n.dataKey,n.domain[a]);return Zr(f)?null:n.scale(f)-l/2+i},yke=function(r){var n=r.numericAxis,s=n.scale.domain();if(n.type==="number"){var i=Math.min(s[0],s[1]),l=Math.max(s[0],s[1]);return i<=0&&l>=0?0:l<0?l:i}return s[0]},vke=function(r,n){var s,i=(s=r.type)!==null&&s!==void 0&&s.defaultProps?gi(gi({},r.type.defaultProps),r.props):r.props,l=i.stackId;if(ea(l)){var d=n[l];if(d){var a=d.items.indexOf(r);return a>=0?d.stackedData[a]:null}}return null},_ke=function(r){return r.reduce(function(n,s){return[wP(s.concat([n[0]]).filter(Xt)),Uh(s.concat([n[1]]).filter(Xt))]},[1/0,-1/0])},DK=function(r,n,s){return Object.keys(r).reduce(function(i,l){var d=r[l],a=d.stackedData,f=a.reduce(function(p,y){var v=_ke(y.slice(n,s+1));return[Math.min(p[0],v[0]),Math.max(p[1],v[1])]},[1/0,-1/0]);return[Math.min(f[0],i[0]),Math.max(f[1],i[1])]},[1/0,-1/0]).map(function(i){return i===1/0||i===-1/0?0:i})},l$=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,c$=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,oM=function(r,n,s){if(Br(r))return r(n,s);if(!Array.isArray(r))return n;var i=[];if(Xt(r[0]))i[0]=s?r[0]:Math.min(r[0],n[0]);else if(l$.test(r[0])){var l=+l$.exec(r[0])[1];i[0]=n[0]-l}else Br(r[0])?i[0]=r[0](n[0]):i[0]=n[0];if(Xt(r[1]))i[1]=s?r[1]:Math.max(r[1],n[1]);else if(c$.test(r[1])){var d=+c$.exec(r[1])[1];i[1]=n[1]+d}else Br(r[1])?i[1]=r[1](n[1]):i[1]=n[1];return i},vS=function(r,n,s){if(r&&r.scale&&r.scale.bandwidth){var i=r.scale.bandwidth();if(!s||i>0)return i}if(r&&n&&n.length>=2){for(var l=h4(n,function(v){return v.coordinate}),d=1/0,a=1,f=l.length;a<f;a++){var p=l[a],y=l[a-1];d=Math.min((p.coordinate||0)-(y.coordinate||0),d)}return d===1/0?0:d}return s?void 0:0},d$=function(r,n,s){return!r||!r.length||xm(r,sl(s,"type.defaultProps.domain"))?n:r},RK=function(r,n){var s=r.type.defaultProps?gi(gi({},r.type.defaultProps),r.props):r.props,i=s.dataKey,l=s.name,d=s.unit,a=s.formatter,f=s.tooltipType,p=s.chartType,y=s.hide;return gi(gi({},Cr(r,!1)),{},{dataKey:i,unit:d,formatter:a,name:l||i,color:F4(r),value:ii(n,i),type:f,payload:n,chartType:p,hide:y})};function mb(e){"@babel/helpers - typeof";return mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},mb(e)}function u$(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Jd(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?u$(Object(n),!0).forEach(function(s){LK(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function LK(e,r,n){return r=bke(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function bke(e){var r=jke(e,"string");return mb(r)=="symbol"?r:r+""}function jke(e,r){if(mb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(mb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function wke(e,r){return Cke(e)||Pke(e,r)||Ske(e,r)||Nke()}function Nke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ske(e,r){if(e){if(typeof e=="string")return h$(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h$(e,r)}}function h$(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}function Pke(e,r){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,l,d,a=[],f=!0,p=!1;try{if(l=(n=n.call(e)).next,r!==0)for(;!(f=(s=l.call(n)).done)&&(a.push(s.value),a.length!==r);f=!0);}catch(y){p=!0,i=y}finally{try{if(!f&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(p)throw i}}return a}}function Cke(e){if(Array.isArray(e))return e}var _S=Math.PI/180,Ake=function(r){return r*180/Math.PI},Wn=function(r,n,s,i){return{x:r+Math.cos(-_S*i)*s,y:n+Math.sin(-_S*i)*s}},FK=function(r,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(r-(s.left||0)-(s.right||0)),Math.abs(n-(s.top||0)-(s.bottom||0)))/2},zK=function(r,n,s,i,l){var d=r.width,a=r.height,f=r.startAngle,p=r.endAngle,y=ho(r.cx,d,d/2),v=ho(r.cy,a,a/2),j=FK(d,a,s),w=ho(r.innerRadius,j,0),k=ho(r.outerRadius,j,j*.8),S=Object.keys(n);return S.reduce(function(R,D){var T=n[D],I=T.domain,L=T.reversed,$;if(Zr(T.range))i==="angleAxis"?$=[f,p]:i==="radiusAxis"&&($=[w,k]),L&&($=[$[1],$[0]]);else{$=T.range;var W=$,Z=wke(W,2);f=Z[0],p=Z[1]}var oe=MK(T,l),te=oe.realScaleType,be=oe.scale;be.domain(I).range($),OK(be);var ie=IK(be,Jd(Jd({},T),{},{realScaleType:te})),ge=Jd(Jd(Jd({},T),ie),{},{range:$,radius:k,realScaleType:te,scale:be,cx:y,cy:v,innerRadius:w,outerRadius:k,startAngle:f,endAngle:p});return Jd(Jd({},R),{},LK({},D,ge))},{})},kke=function(r,n){var s=r.x,i=r.y,l=n.x,d=n.y;return Math.sqrt(Math.pow(s-l,2)+Math.pow(i-d,2))},Tke=function(r,n){var s=r.x,i=r.y,l=n.cx,d=n.cy,a=kke({x:s,y:i},{x:l,y:d});if(a<=0)return{radius:a};var f=(s-l)/a,p=Math.acos(f);return i>d&&(p=2*Math.PI-p),{radius:a,angle:Ake(p),angleInRadian:p}},Eke=function(r){var n=r.startAngle,s=r.endAngle,i=Math.floor(n/360),l=Math.floor(s/360),d=Math.min(i,l);return{startAngle:n-d*360,endAngle:s-d*360}},Mke=function(r,n){var s=n.startAngle,i=n.endAngle,l=Math.floor(s/360),d=Math.floor(i/360),a=Math.min(l,d);return r+a*360},m$=function(r,n){var s=r.x,i=r.y,l=Tke({x:s,y:i},n),d=l.radius,a=l.angle,f=n.innerRadius,p=n.outerRadius;if(d<f||d>p)return!1;if(d===0)return!0;var y=Eke(n),v=y.startAngle,j=y.endAngle,w=a,k;if(v<=j){for(;w>j;)w-=360;for(;w<v;)w+=360;k=w>=v&&w<=j}else{for(;w>v;)w-=360;for(;w<j;)w+=360;k=w>=j&&w<=v}return k?Jd(Jd({},n),{},{radius:d,angle:Mke(w,n)}):null},$K=function(r){return!O.isValidElement(r)&&!Br(r)&&typeof r!="boolean"?r.className:""};function fb(e){"@babel/helpers - typeof";return fb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},fb(e)}var Oke=["offset"];function Ike(e){return Fke(e)||Lke(e)||Rke(e)||Dke()}function Dke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rke(e,r){if(e){if(typeof e=="string")return lM(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lM(e,r)}}function Lke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Fke(e){if(Array.isArray(e))return lM(e)}function lM(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}function zke(e,r){if(e==null)return{};var n=$ke(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function $ke(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}function f$(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Hi(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?f$(Object(n),!0).forEach(function(s){Bke(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Bke(e,r,n){return r=qke(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function qke(e){var r=Vke(e,"string");return fb(r)=="symbol"?r:r+""}function Vke(e,r){if(fb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(fb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function pb(){return pb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},pb.apply(this,arguments)}var Uke=function(r){var n=r.value,s=r.formatter,i=Zr(r.children)?n:r.children;return Br(s)?s(i):i},Wke=function(r,n){var s=uo(n-r),i=Math.min(Math.abs(n-r),360);return s*i},Gke=function(r,n,s){var i=r.position,l=r.viewBox,d=r.offset,a=r.className,f=l,p=f.cx,y=f.cy,v=f.innerRadius,j=f.outerRadius,w=f.startAngle,k=f.endAngle,S=f.clockWise,R=(v+j)/2,D=Wke(w,k),T=D>=0?1:-1,I,L;i==="insideStart"?(I=w+T*d,L=S):i==="insideEnd"?(I=k-T*d,L=!S):i==="end"&&(I=k+T*d,L=S),L=D<=0?L:!L;var $=Wn(p,y,R,I),W=Wn(p,y,R,I+(L?1:-1)*359),Z="M".concat($.x,",").concat($.y,`
    A`).concat(R,",").concat(R,",0,1,").concat(L?0:1,`,
    `).concat(W.x,",").concat(W.y),oe=Zr(r.id)?gp("recharts-radial-line-"):r.id;return me.createElement("text",pb({},s,{dominantBaseline:"central",className:Yr("recharts-radial-bar-label",a)}),me.createElement("defs",null,me.createElement("path",{id:oe,d:Z})),me.createElement("textPath",{xlinkHref:"#".concat(oe)},n))},Kke=function(r){var n=r.viewBox,s=r.offset,i=r.position,l=n,d=l.cx,a=l.cy,f=l.innerRadius,p=l.outerRadius,y=l.startAngle,v=l.endAngle,j=(y+v)/2;if(i==="outside"){var w=Wn(d,a,p+s,j),k=w.x,S=w.y;return{x:k,y:S,textAnchor:k>=d?"start":"end",verticalAnchor:"middle"}}if(i==="center")return{x:d,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(i==="centerTop")return{x:d,y:a,textAnchor:"middle",verticalAnchor:"start"};if(i==="centerBottom")return{x:d,y:a,textAnchor:"middle",verticalAnchor:"end"};var R=(f+p)/2,D=Wn(d,a,R,j),T=D.x,I=D.y;return{x:T,y:I,textAnchor:"middle",verticalAnchor:"middle"}},Hke=function(r){var n=r.viewBox,s=r.parentViewBox,i=r.offset,l=r.position,d=n,a=d.x,f=d.y,p=d.width,y=d.height,v=y>=0?1:-1,j=v*i,w=v>0?"end":"start",k=v>0?"start":"end",S=p>=0?1:-1,R=S*i,D=S>0?"end":"start",T=S>0?"start":"end";if(l==="top"){var I={x:a+p/2,y:f-v*i,textAnchor:"middle",verticalAnchor:w};return Hi(Hi({},I),s?{height:Math.max(f-s.y,0),width:p}:{})}if(l==="bottom"){var L={x:a+p/2,y:f+y+j,textAnchor:"middle",verticalAnchor:k};return Hi(Hi({},L),s?{height:Math.max(s.y+s.height-(f+y),0),width:p}:{})}if(l==="left"){var $={x:a-R,y:f+y/2,textAnchor:D,verticalAnchor:"middle"};return Hi(Hi({},$),s?{width:Math.max($.x-s.x,0),height:y}:{})}if(l==="right"){var W={x:a+p+R,y:f+y/2,textAnchor:T,verticalAnchor:"middle"};return Hi(Hi({},W),s?{width:Math.max(s.x+s.width-W.x,0),height:y}:{})}var Z=s?{width:p,height:y}:{};return l==="insideLeft"?Hi({x:a+R,y:f+y/2,textAnchor:T,verticalAnchor:"middle"},Z):l==="insideRight"?Hi({x:a+p-R,y:f+y/2,textAnchor:D,verticalAnchor:"middle"},Z):l==="insideTop"?Hi({x:a+p/2,y:f+j,textAnchor:"middle",verticalAnchor:k},Z):l==="insideBottom"?Hi({x:a+p/2,y:f+y-j,textAnchor:"middle",verticalAnchor:w},Z):l==="insideTopLeft"?Hi({x:a+R,y:f+j,textAnchor:T,verticalAnchor:k},Z):l==="insideTopRight"?Hi({x:a+p-R,y:f+j,textAnchor:D,verticalAnchor:k},Z):l==="insideBottomLeft"?Hi({x:a+R,y:f+y-j,textAnchor:T,verticalAnchor:w},Z):l==="insideBottomRight"?Hi({x:a+p-R,y:f+y-j,textAnchor:D,verticalAnchor:w},Z):Vy(l)&&(Xt(l.x)||Af(l.x))&&(Xt(l.y)||Af(l.y))?Hi({x:a+ho(l.x,p),y:f+ho(l.y,y),textAnchor:"end",verticalAnchor:"end"},Z):Hi({x:a+p/2,y:f+y/2,textAnchor:"middle",verticalAnchor:"middle"},Z)},Zke=function(r){return"cx"in r&&Xt(r.cx)};function ha(e){var r=e.offset,n=r===void 0?5:r,s=zke(e,Oke),i=Hi({offset:n},s),l=i.viewBox,d=i.position,a=i.value,f=i.children,p=i.content,y=i.className,v=y===void 0?"":y,j=i.textBreakAll;if(!l||Zr(a)&&Zr(f)&&!O.isValidElement(p)&&!Br(p))return null;if(O.isValidElement(p))return O.cloneElement(p,i);var w;if(Br(p)){if(w=O.createElement(p,i),O.isValidElement(w))return w}else w=Uke(i);var k=Zke(l),S=Cr(i,!0);if(k&&(d==="insideStart"||d==="insideEnd"||d==="end"))return Gke(i,w,S);var R=k?Kke(i):Hke(i);return me.createElement(op,pb({className:Yr("recharts-label",v)},S,R,{breakAll:j}),w)}ha.displayName="Label";var BK=function(r){var n=r.cx,s=r.cy,i=r.angle,l=r.startAngle,d=r.endAngle,a=r.r,f=r.radius,p=r.innerRadius,y=r.outerRadius,v=r.x,j=r.y,w=r.top,k=r.left,S=r.width,R=r.height,D=r.clockWise,T=r.labelViewBox;if(T)return T;if(Xt(S)&&Xt(R)){if(Xt(v)&&Xt(j))return{x:v,y:j,width:S,height:R};if(Xt(w)&&Xt(k))return{x:w,y:k,width:S,height:R}}return Xt(v)&&Xt(j)?{x:v,y:j,width:0,height:0}:Xt(n)&&Xt(s)?{cx:n,cy:s,startAngle:l||i||0,endAngle:d||i||0,innerRadius:p||0,outerRadius:y||f||a||0,clockWise:D}:r.viewBox?r.viewBox:{}},Yke=function(r,n){return r?r===!0?me.createElement(ha,{key:"label-implicit",viewBox:n}):ea(r)?me.createElement(ha,{key:"label-implicit",viewBox:n,value:r}):O.isValidElement(r)?r.type===ha?O.cloneElement(r,{key:"label-implicit",viewBox:n}):me.createElement(ha,{key:"label-implicit",content:r,viewBox:n}):Br(r)?me.createElement(ha,{key:"label-implicit",content:r,viewBox:n}):Vy(r)?me.createElement(ha,pb({viewBox:n},r,{key:"label-implicit"})):null:null},Xke=function(r,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!r||!r.children&&s&&!r.label)return null;var i=r.children,l=BK(r),d=il(i,ha).map(function(f,p){return O.cloneElement(f,{viewBox:n||l,key:"label-".concat(p)})});if(!s)return d;var a=Yke(r.label,n||l);return[a].concat(Ike(d))};ha.parseViewBox=BK;ha.renderCallByParent=Xke;function Qke(e){var r=e==null?0:e.length;return r?e[r-1]:void 0}var Jke=Qke;const qK=Vn(Jke);function xb(e){"@babel/helpers - typeof";return xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},xb(e)}var eTe=["valueAccessor"],tTe=["data","dataKey","clockWise","id","textBreakAll"];function rTe(e){return aTe(e)||iTe(e)||sTe(e)||nTe()}function nTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sTe(e,r){if(e){if(typeof e=="string")return cM(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cM(e,r)}}function iTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aTe(e){if(Array.isArray(e))return cM(e)}function cM(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}function bS(){return bS=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},bS.apply(this,arguments)}function p$(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function x$(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?p$(Object(n),!0).forEach(function(s){oTe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function oTe(e,r,n){return r=lTe(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function lTe(e){var r=cTe(e,"string");return xb(r)=="symbol"?r:r+""}function cTe(e,r){if(xb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(xb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function g$(e,r){if(e==null)return{};var n=dTe(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function dTe(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}var uTe=function(r){return Array.isArray(r.value)?qK(r.value):r.value};function Cc(e){var r=e.valueAccessor,n=r===void 0?uTe:r,s=g$(e,eTe),i=s.data,l=s.dataKey,d=s.clockWise,a=s.id,f=s.textBreakAll,p=g$(s,tTe);return!i||!i.length?null:me.createElement(gn,{className:"recharts-label-list"},i.map(function(y,v){var j=Zr(l)?n(y,v):ii(y&&y.payload,l),w=Zr(a)?{}:{id:"".concat(a,"-").concat(v)};return me.createElement(ha,bS({},Cr(y,!0),p,w,{parentViewBox:y.parentViewBox,value:j,textBreakAll:f,viewBox:ha.parseViewBox(Zr(d)?y:x$(x$({},y),{},{clockWise:d})),key:"label-".concat(v),index:v}))}))}Cc.displayName="LabelList";function hTe(e,r){return e?e===!0?me.createElement(Cc,{key:"labelList-implicit",data:r}):me.isValidElement(e)||Br(e)?me.createElement(Cc,{key:"labelList-implicit",data:r,content:e}):Vy(e)?me.createElement(Cc,bS({data:r},e,{key:"labelList-implicit"})):null:null}function mTe(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var s=e.children,i=il(s,Cc).map(function(d,a){return O.cloneElement(d,{data:r,key:"labelList-".concat(a)})});if(!n)return i;var l=hTe(e.label,r);return[l].concat(rTe(i))}Cc.renderCallByParent=mTe;function gb(e){"@babel/helpers - typeof";return gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},gb(e)}function dM(){return dM=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},dM.apply(this,arguments)}function y$(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function v$(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?y$(Object(n),!0).forEach(function(s){fTe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function fTe(e,r,n){return r=pTe(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function pTe(e){var r=xTe(e,"string");return gb(r)=="symbol"?r:r+""}function xTe(e,r){if(gb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(gb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var gTe=function(r,n){var s=uo(n-r),i=Math.min(Math.abs(n-r),359.999);return s*i},j1=function(r){var n=r.cx,s=r.cy,i=r.radius,l=r.angle,d=r.sign,a=r.isExternal,f=r.cornerRadius,p=r.cornerIsExternal,y=f*(a?1:-1)+i,v=Math.asin(f/y)/_S,j=p?l:l+d*v,w=Wn(n,s,y,j),k=Wn(n,s,i,j),S=p?l-d*v:l,R=Wn(n,s,y*Math.cos(v*_S),S);return{center:w,circleTangency:k,lineTangency:R,theta:v}},VK=function(r){var n=r.cx,s=r.cy,i=r.innerRadius,l=r.outerRadius,d=r.startAngle,a=r.endAngle,f=gTe(d,a),p=d+f,y=Wn(n,s,l,d),v=Wn(n,s,l,p),j="M ".concat(y.x,",").concat(y.y,`
    A `).concat(l,",").concat(l,`,0,
    `).concat(+(Math.abs(f)>180),",").concat(+(d>p),`,
    `).concat(v.x,",").concat(v.y,`
  `);if(i>0){var w=Wn(n,s,i,d),k=Wn(n,s,i,p);j+="L ".concat(k.x,",").concat(k.y,`
            A `).concat(i,",").concat(i,`,0,
            `).concat(+(Math.abs(f)>180),",").concat(+(d<=p),`,
            `).concat(w.x,",").concat(w.y," Z")}else j+="L ".concat(n,",").concat(s," Z");return j},yTe=function(r){var n=r.cx,s=r.cy,i=r.innerRadius,l=r.outerRadius,d=r.cornerRadius,a=r.forceCornerRadius,f=r.cornerIsExternal,p=r.startAngle,y=r.endAngle,v=uo(y-p),j=j1({cx:n,cy:s,radius:l,angle:p,sign:v,cornerRadius:d,cornerIsExternal:f}),w=j.circleTangency,k=j.lineTangency,S=j.theta,R=j1({cx:n,cy:s,radius:l,angle:y,sign:-v,cornerRadius:d,cornerIsExternal:f}),D=R.circleTangency,T=R.lineTangency,I=R.theta,L=f?Math.abs(p-y):Math.abs(p-y)-S-I;if(L<0)return a?"M ".concat(k.x,",").concat(k.y,`
        a`).concat(d,",").concat(d,",0,0,1,").concat(d*2,`,0
        a`).concat(d,",").concat(d,",0,0,1,").concat(-d*2,`,0
      `):VK({cx:n,cy:s,innerRadius:i,outerRadius:l,startAngle:p,endAngle:y});var $="M ".concat(k.x,",").concat(k.y,`
    A`).concat(d,",").concat(d,",0,0,").concat(+(v<0),",").concat(w.x,",").concat(w.y,`
    A`).concat(l,",").concat(l,",0,").concat(+(L>180),",").concat(+(v<0),",").concat(D.x,",").concat(D.y,`
    A`).concat(d,",").concat(d,",0,0,").concat(+(v<0),",").concat(T.x,",").concat(T.y,`
  `);if(i>0){var W=j1({cx:n,cy:s,radius:i,angle:p,sign:v,isExternal:!0,cornerRadius:d,cornerIsExternal:f}),Z=W.circleTangency,oe=W.lineTangency,te=W.theta,be=j1({cx:n,cy:s,radius:i,angle:y,sign:-v,isExternal:!0,cornerRadius:d,cornerIsExternal:f}),ie=be.circleTangency,ge=be.lineTangency,Ie=be.theta,Oe=f?Math.abs(p-y):Math.abs(p-y)-te-Ie;if(Oe<0&&d===0)return"".concat($,"L").concat(n,",").concat(s,"Z");$+="L".concat(ge.x,",").concat(ge.y,`
      A`).concat(d,",").concat(d,",0,0,").concat(+(v<0),",").concat(ie.x,",").concat(ie.y,`
      A`).concat(i,",").concat(i,",0,").concat(+(Oe>180),",").concat(+(v>0),",").concat(Z.x,",").concat(Z.y,`
      A`).concat(d,",").concat(d,",0,0,").concat(+(v<0),",").concat(oe.x,",").concat(oe.y,"Z")}else $+="L".concat(n,",").concat(s,"Z");return $},vTe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},UK=function(r){var n=v$(v$({},vTe),r),s=n.cx,i=n.cy,l=n.innerRadius,d=n.outerRadius,a=n.cornerRadius,f=n.forceCornerRadius,p=n.cornerIsExternal,y=n.startAngle,v=n.endAngle,j=n.className;if(d<l||y===v)return null;var w=Yr("recharts-sector",j),k=d-l,S=ho(a,k,0,!0),R;return S>0&&Math.abs(y-v)<360?R=yTe({cx:s,cy:i,innerRadius:l,outerRadius:d,cornerRadius:Math.min(S,k/2),forceCornerRadius:f,cornerIsExternal:p,startAngle:y,endAngle:v}):R=VK({cx:s,cy:i,innerRadius:l,outerRadius:d,startAngle:y,endAngle:v}),me.createElement("path",dM({},Cr(n,!0),{className:w,d:R,role:"img"}))};function yb(e){"@babel/helpers - typeof";return yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},yb(e)}function uM(){return uM=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},uM.apply(this,arguments)}function _$(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function b$(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?_$(Object(n),!0).forEach(function(s){_Te(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function _Te(e,r,n){return r=bTe(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function bTe(e){var r=jTe(e,"string");return yb(r)=="symbol"?r:r+""}function jTe(e,r){if(yb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(yb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var j$={curveBasisClosed:jye,curveBasisOpen:wye,curveBasis:bye,curveBumpX:oye,curveBumpY:lye,curveLinearClosed:Nye,curveLinear:uP,curveMonotoneX:Sye,curveMonotoneY:Pye,curveNatural:Cye,curveStep:Aye,curveStepAfter:Tye,curveStepBefore:kye},w1=function(r){return r.x===+r.x&&r.y===+r.y},$0=function(r){return r.x},B0=function(r){return r.y},wTe=function(r,n){if(Br(r))return r;var s="curve".concat(cP(r));return(s==="curveMonotone"||s==="curveBump")&&n?j$["".concat(s).concat(n==="vertical"?"Y":"X")]:j$[s]||uP},NTe=function(r){var n=r.type,s=n===void 0?"linear":n,i=r.points,l=i===void 0?[]:i,d=r.baseLine,a=r.layout,f=r.connectNulls,p=f===void 0?!1:f,y=wTe(s,a),v=p?l.filter(function(S){return w1(S)}):l,j;if(Array.isArray(d)){var w=p?d.filter(function(S){return w1(S)}):d,k=v.map(function(S,R){return b$(b$({},S),{},{base:w[R]})});return a==="vertical"?j=m1().y(B0).x1($0).x0(function(S){return S.base.x}):j=m1().x($0).y1(B0).y0(function(S){return S.base.y}),j.defined(w1).curve(y),j(k)}return a==="vertical"&&Xt(d)?j=m1().y(B0).x1($0).x0(d):Xt(d)?j=m1().x($0).y1(B0).y0(d):j=R7().x($0).y(B0),j.defined(w1).curve(y),j(v)},Uf=function(r){var n=r.className,s=r.points,i=r.path,l=r.pathRef;if((!s||!s.length)&&!i)return null;var d=s&&s.length?NTe(r):i;return me.createElement("path",uM({},Cr(r,!1),WN(r),{className:Yr("recharts-curve",n),d,ref:l}))},WK={exports:{}},STe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",PTe=STe,CTe=PTe;function GK(){}function KK(){}KK.resetWarningCache=GK;var ATe=function(){function e(s,i,l,d,a,f){if(f!==CTe){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}e.isRequired=e;function r(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:r,element:e,elementType:e,instanceOf:r,node:e,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:KK,resetWarningCache:GK};return n.PropTypes=n,n};WK.exports=ATe();var kTe=WK.exports;const fn=Vn(kTe);var TTe=Object.getOwnPropertyNames,ETe=Object.getOwnPropertySymbols,MTe=Object.prototype.hasOwnProperty;function w$(e,r){return function(s,i,l){return e(s,i,l)&&r(s,i,l)}}function N1(e){return function(n,s,i){if(!n||!s||typeof n!="object"||typeof s!="object")return e(n,s,i);var l=i.cache,d=l.get(n),a=l.get(s);if(d&&a)return d===s&&a===n;l.set(n,s),l.set(s,n);var f=e(n,s,i);return l.delete(n),l.delete(s),f}}function N$(e){return TTe(e).concat(ETe(e))}var HK=Object.hasOwn||function(e,r){return MTe.call(e,r)};function ev(e,r){return e||r?e===r:e===r||e!==e&&r!==r}var ZK="_owner",S$=Object.getOwnPropertyDescriptor,P$=Object.keys;function OTe(e,r,n){var s=e.length;if(r.length!==s)return!1;for(;s-- >0;)if(!n.equals(e[s],r[s],s,s,e,r,n))return!1;return!0}function ITe(e,r){return ev(e.getTime(),r.getTime())}function C$(e,r,n){if(e.size!==r.size)return!1;for(var s={},i=e.entries(),l=0,d,a;(d=i.next())&&!d.done;){for(var f=r.entries(),p=!1,y=0;(a=f.next())&&!a.done;){var v=d.value,j=v[0],w=v[1],k=a.value,S=k[0],R=k[1];!p&&!s[y]&&(p=n.equals(j,S,l,y,e,r,n)&&n.equals(w,R,j,S,e,r,n))&&(s[y]=!0),y++}if(!p)return!1;l++}return!0}function DTe(e,r,n){var s=P$(e),i=s.length;if(P$(r).length!==i)return!1;for(var l;i-- >0;)if(l=s[i],l===ZK&&(e.$$typeof||r.$$typeof)&&e.$$typeof!==r.$$typeof||!HK(r,l)||!n.equals(e[l],r[l],l,l,e,r,n))return!1;return!0}function q0(e,r,n){var s=N$(e),i=s.length;if(N$(r).length!==i)return!1;for(var l,d,a;i-- >0;)if(l=s[i],l===ZK&&(e.$$typeof||r.$$typeof)&&e.$$typeof!==r.$$typeof||!HK(r,l)||!n.equals(e[l],r[l],l,l,e,r,n)||(d=S$(e,l),a=S$(r,l),(d||a)&&(!d||!a||d.configurable!==a.configurable||d.enumerable!==a.enumerable||d.writable!==a.writable)))return!1;return!0}function RTe(e,r){return ev(e.valueOf(),r.valueOf())}function LTe(e,r){return e.source===r.source&&e.flags===r.flags}function A$(e,r,n){if(e.size!==r.size)return!1;for(var s={},i=e.values(),l,d;(l=i.next())&&!l.done;){for(var a=r.values(),f=!1,p=0;(d=a.next())&&!d.done;)!f&&!s[p]&&(f=n.equals(l.value,d.value,l.value,d.value,e,r,n))&&(s[p]=!0),p++;if(!f)return!1}return!0}function FTe(e,r){var n=e.length;if(r.length!==n)return!1;for(;n-- >0;)if(e[n]!==r[n])return!1;return!0}var zTe="[object Arguments]",$Te="[object Boolean]",BTe="[object Date]",qTe="[object Map]",VTe="[object Number]",UTe="[object Object]",WTe="[object RegExp]",GTe="[object Set]",KTe="[object String]",HTe=Array.isArray,k$=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,T$=Object.assign,ZTe=Object.prototype.toString.call.bind(Object.prototype.toString);function YTe(e){var r=e.areArraysEqual,n=e.areDatesEqual,s=e.areMapsEqual,i=e.areObjectsEqual,l=e.arePrimitiveWrappersEqual,d=e.areRegExpsEqual,a=e.areSetsEqual,f=e.areTypedArraysEqual;return function(y,v,j){if(y===v)return!0;if(y==null||v==null||typeof y!="object"||typeof v!="object")return y!==y&&v!==v;var w=y.constructor;if(w!==v.constructor)return!1;if(w===Object)return i(y,v,j);if(HTe(y))return r(y,v,j);if(k$!=null&&k$(y))return f(y,v,j);if(w===Date)return n(y,v,j);if(w===RegExp)return d(y,v,j);if(w===Map)return s(y,v,j);if(w===Set)return a(y,v,j);var k=ZTe(y);return k===BTe?n(y,v,j):k===WTe?d(y,v,j):k===qTe?s(y,v,j):k===GTe?a(y,v,j):k===UTe?typeof y.then!="function"&&typeof v.then!="function"&&i(y,v,j):k===zTe?i(y,v,j):k===$Te||k===VTe||k===KTe?l(y,v,j):!1}}function XTe(e){var r=e.circular,n=e.createCustomConfig,s=e.strict,i={areArraysEqual:s?q0:OTe,areDatesEqual:ITe,areMapsEqual:s?w$(C$,q0):C$,areObjectsEqual:s?q0:DTe,arePrimitiveWrappersEqual:RTe,areRegExpsEqual:LTe,areSetsEqual:s?w$(A$,q0):A$,areTypedArraysEqual:s?q0:FTe};if(n&&(i=T$({},i,n(i))),r){var l=N1(i.areArraysEqual),d=N1(i.areMapsEqual),a=N1(i.areObjectsEqual),f=N1(i.areSetsEqual);i=T$({},i,{areArraysEqual:l,areMapsEqual:d,areObjectsEqual:a,areSetsEqual:f})}return i}function QTe(e){return function(r,n,s,i,l,d,a){return e(r,n,a)}}function JTe(e){var r=e.circular,n=e.comparator,s=e.createState,i=e.equals,l=e.strict;if(s)return function(f,p){var y=s(),v=y.cache,j=v===void 0?r?new WeakMap:void 0:v,w=y.meta;return n(f,p,{cache:j,equals:i,meta:w,strict:l})};if(r)return function(f,p){return n(f,p,{cache:new WeakMap,equals:i,meta:void 0,strict:l})};var d={cache:void 0,equals:i,meta:void 0,strict:l};return function(f,p){return n(f,p,d)}}var eEe=Am();Am({strict:!0});Am({circular:!0});Am({circular:!0,strict:!0});Am({createInternalComparator:function(){return ev}});Am({strict:!0,createInternalComparator:function(){return ev}});Am({circular:!0,createInternalComparator:function(){return ev}});Am({circular:!0,createInternalComparator:function(){return ev},strict:!0});function Am(e){e===void 0&&(e={});var r=e.circular,n=r===void 0?!1:r,s=e.createInternalComparator,i=e.createState,l=e.strict,d=l===void 0?!1:l,a=XTe(e),f=YTe(a),p=s?s(f):QTe(f);return JTe({circular:n,comparator:f,createState:i,equals:p,strict:d})}function tEe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function E$(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,s=function i(l){n<0&&(n=l),l-n>r?(e(l),n=-1):tEe(i)};requestAnimationFrame(s)}function hM(e){"@babel/helpers - typeof";return hM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},hM(e)}function rEe(e){return aEe(e)||iEe(e)||sEe(e)||nEe()}function nEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sEe(e,r){if(e){if(typeof e=="string")return M$(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M$(e,r)}}function M$(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}function iEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aEe(e){if(Array.isArray(e))return e}function oEe(){var e={},r=function(){return null},n=!1,s=function i(l){if(!n){if(Array.isArray(l)){if(!l.length)return;var d=l,a=rEe(d),f=a[0],p=a.slice(1);if(typeof f=="number"){E$(i.bind(null,p),f);return}i(f),E$(i.bind(null,p));return}hM(l)==="object"&&(e=l,r(e)),typeof l=="function"&&l()}};return{stop:function(){n=!0},start:function(l){n=!1,s(l)},subscribe:function(l){return r=l,function(){r=function(){return null}}}}}function vb(e){"@babel/helpers - typeof";return vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},vb(e)}function O$(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function I$(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?O$(Object(n),!0).forEach(function(s){YK(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function YK(e,r,n){return r=lEe(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function lEe(e){var r=cEe(e,"string");return vb(r)==="symbol"?r:String(r)}function cEe(e,r){if(vb(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(vb(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var dEe=function(r,n){return[Object.keys(r),Object.keys(n)].reduce(function(s,i){return s.filter(function(l){return i.includes(l)})})},uEe=function(r){return r},hEe=function(r){return r.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},f_=function(r,n){return Object.keys(n).reduce(function(s,i){return I$(I$({},s),{},YK({},i,r(i,n[i])))},{})},D$=function(r,n,s){return r.map(function(i){return"".concat(hEe(i)," ").concat(n,"ms ").concat(s)}).join(",")};function mEe(e,r){return xEe(e)||pEe(e,r)||XK(e,r)||fEe()}function fEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pEe(e,r){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,l,d,a=[],f=!0,p=!1;try{if(l=(n=n.call(e)).next,r!==0)for(;!(f=(s=l.call(n)).done)&&(a.push(s.value),a.length!==r);f=!0);}catch(y){p=!0,i=y}finally{try{if(!f&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(p)throw i}}return a}}function xEe(e){if(Array.isArray(e))return e}function gEe(e){return _Ee(e)||vEe(e)||XK(e)||yEe()}function yEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XK(e,r){if(e){if(typeof e=="string")return mM(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mM(e,r)}}function vEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _Ee(e){if(Array.isArray(e))return mM(e)}function mM(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}var jS=1e-4,QK=function(r,n){return[0,3*r,3*n-6*r,3*r-3*n+1]},JK=function(r,n){return r.map(function(s,i){return s*Math.pow(n,i)}).reduce(function(s,i){return s+i})},R$=function(r,n){return function(s){var i=QK(r,n);return JK(i,s)}},bEe=function(r,n){return function(s){var i=QK(r,n),l=[].concat(gEe(i.map(function(d,a){return d*a}).slice(1)),[0]);return JK(l,s)}},L$=function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];var i=n[0],l=n[1],d=n[2],a=n[3];if(n.length===1)switch(n[0]){case"linear":i=0,l=0,d=1,a=1;break;case"ease":i=.25,l=.1,d=.25,a=1;break;case"ease-in":i=.42,l=0,d=1,a=1;break;case"ease-out":i=.42,l=0,d=.58,a=1;break;case"ease-in-out":i=0,l=0,d=.58,a=1;break;default:{var f=n[0].split("(");if(f[0]==="cubic-bezier"&&f[1].split(")")[0].split(",").length===4){var p=f[1].split(")")[0].split(",").map(function(R){return parseFloat(R)}),y=mEe(p,4);i=y[0],l=y[1],d=y[2],a=y[3]}}}var v=R$(i,d),j=R$(l,a),w=bEe(i,d),k=function(D){return D>1?1:D<0?0:D},S=function(D){for(var T=D>1?1:D,I=T,L=0;L<8;++L){var $=v(I)-T,W=w(I);if(Math.abs($-T)<jS||W<jS)return j(I);I=k(I-$/W)}return j(I)};return S.isStepper=!1,S},jEe=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.stiff,s=n===void 0?100:n,i=r.damping,l=i===void 0?8:i,d=r.dt,a=d===void 0?17:d,f=function(y,v,j){var w=-(y-v)*s,k=j*l,S=j+(w-k)*a/1e3,R=j*a/1e3+y;return Math.abs(R-v)<jS&&Math.abs(S)<jS?[v,0]:[R,S]};return f.isStepper=!0,f.dt=a,f},wEe=function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];var i=n[0];if(typeof i=="string")switch(i){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return L$(i);case"spring":return jEe();default:if(i.split("(")[0]==="cubic-bezier")return L$(i)}return typeof i=="function"?i:null};function _b(e){"@babel/helpers - typeof";return _b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_b(e)}function F$(e){return PEe(e)||SEe(e)||eH(e)||NEe()}function NEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function PEe(e){if(Array.isArray(e))return pM(e)}function z$(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Pa(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?z$(Object(n),!0).forEach(function(s){fM(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function fM(e,r,n){return r=CEe(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function CEe(e){var r=AEe(e,"string");return _b(r)==="symbol"?r:String(r)}function AEe(e,r){if(_b(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(_b(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function kEe(e,r){return MEe(e)||EEe(e,r)||eH(e,r)||TEe()}function TEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eH(e,r){if(e){if(typeof e=="string")return pM(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pM(e,r)}}function pM(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}function EEe(e,r){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,l,d,a=[],f=!0,p=!1;try{if(l=(n=n.call(e)).next,r!==0)for(;!(f=(s=l.call(n)).done)&&(a.push(s.value),a.length!==r);f=!0);}catch(y){p=!0,i=y}finally{try{if(!f&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(p)throw i}}return a}}function MEe(e){if(Array.isArray(e))return e}var wS=function(r,n,s){return r+(n-r)*s},xM=function(r){var n=r.from,s=r.to;return n!==s},OEe=function e(r,n,s){var i=f_(function(l,d){if(xM(d)){var a=r(d.from,d.to,d.velocity),f=kEe(a,2),p=f[0],y=f[1];return Pa(Pa({},d),{},{from:p,velocity:y})}return d},n);return s<1?f_(function(l,d){return xM(d)?Pa(Pa({},d),{},{velocity:wS(d.velocity,i[l].velocity,s),from:wS(d.from,i[l].from,s)}):d},n):e(r,i,s-1)};const IEe=function(e,r,n,s,i){var l=dEe(e,r),d=l.reduce(function(R,D){return Pa(Pa({},R),{},fM({},D,[e[D],r[D]]))},{}),a=l.reduce(function(R,D){return Pa(Pa({},R),{},fM({},D,{from:e[D],velocity:0,to:r[D]}))},{}),f=-1,p,y,v=function(){return null},j=function(){return f_(function(D,T){return T.from},a)},w=function(){return!Object.values(a).filter(xM).length},k=function(D){p||(p=D);var T=D-p,I=T/n.dt;a=OEe(n,a,I),i(Pa(Pa(Pa({},e),r),j())),p=D,w()||(f=requestAnimationFrame(v))},S=function(D){y||(y=D);var T=(D-y)/s,I=f_(function($,W){return wS.apply(void 0,F$(W).concat([n(T)]))},d);if(i(Pa(Pa(Pa({},e),r),I)),T<1)f=requestAnimationFrame(v);else{var L=f_(function($,W){return wS.apply(void 0,F$(W).concat([n(1)]))},d);i(Pa(Pa(Pa({},e),r),L))}};return v=n.isStepper?k:S,function(){return requestAnimationFrame(v),function(){cancelAnimationFrame(f)}}};function ay(e){"@babel/helpers - typeof";return ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ay(e)}var DEe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function REe(e,r){if(e==null)return{};var n=LEe(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function LEe(e,r){if(e==null)return{};var n={},s=Object.keys(e),i,l;for(l=0;l<s.length;l++)i=s[l],!(r.indexOf(i)>=0)&&(n[i]=e[i]);return n}function yk(e){return BEe(e)||$Ee(e)||zEe(e)||FEe()}function FEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zEe(e,r){if(e){if(typeof e=="string")return gM(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gM(e,r)}}function $Ee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function BEe(e){if(Array.isArray(e))return gM(e)}function gM(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}function $$(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function lc(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?$$(Object(n),!0).forEach(function(s){J0(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function J0(e,r,n){return r=tH(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function qEe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function VEe(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,tH(s.key),s)}}function UEe(e,r,n){return r&&VEe(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tH(e){var r=WEe(e,"string");return ay(r)==="symbol"?r:String(r)}function WEe(e,r){if(ay(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(ay(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function GEe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&yM(e,r)}function yM(e,r){return yM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},yM(e,r)}function KEe(e){var r=HEe();return function(){var s=NS(e),i;if(r){var l=NS(this).constructor;i=Reflect.construct(s,arguments,l)}else i=s.apply(this,arguments);return vM(this,i)}}function vM(e,r){if(r&&(ay(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _M(e)}function _M(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function NS(e){return NS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},NS(e)}var Fl=function(e){GEe(n,e);var r=KEe(n);function n(s,i){var l;qEe(this,n),l=r.call(this,s,i);var d=l.props,a=d.isActive,f=d.attributeName,p=d.from,y=d.to,v=d.steps,j=d.children,w=d.duration;if(l.handleStyleChange=l.handleStyleChange.bind(_M(l)),l.changeStyle=l.changeStyle.bind(_M(l)),!a||w<=0)return l.state={style:{}},typeof j=="function"&&(l.state={style:y}),vM(l);if(v&&v.length)l.state={style:v[0].style};else if(p){if(typeof j=="function")return l.state={style:p},vM(l);l.state={style:f?J0({},f,p):p}}else l.state={style:{}};return l}return UEe(n,[{key:"componentDidMount",value:function(){var i=this.props,l=i.isActive,d=i.canBegin;this.mounted=!0,!(!l||!d)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(i){var l=this.props,d=l.isActive,a=l.canBegin,f=l.attributeName,p=l.shouldReAnimate,y=l.to,v=l.from,j=this.state.style;if(a){if(!d){var w={style:f?J0({},f,y):y};this.state&&j&&(f&&j[f]!==y||!f&&j!==y)&&this.setState(w);return}if(!(eEe(i.to,y)&&i.canBegin&&i.isActive)){var k=!i.canBegin||!i.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var S=k||p?v:i.to;if(this.state&&j){var R={style:f?J0({},f,S):S};(f&&j[f]!==S||!f&&j!==S)&&this.setState(R)}this.runAnimation(lc(lc({},this.props),{},{from:S,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var i=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),i&&i()}},{key:"handleStyleChange",value:function(i){this.changeStyle(i)}},{key:"changeStyle",value:function(i){this.mounted&&this.setState({style:i})}},{key:"runJSAnimation",value:function(i){var l=this,d=i.from,a=i.to,f=i.duration,p=i.easing,y=i.begin,v=i.onAnimationEnd,j=i.onAnimationStart,w=IEe(d,a,wEe(p),f,this.changeStyle),k=function(){l.stopJSAnimation=w()};this.manager.start([j,y,k,f,v])}},{key:"runStepAnimation",value:function(i){var l=this,d=i.steps,a=i.begin,f=i.onAnimationStart,p=d[0],y=p.style,v=p.duration,j=v===void 0?0:v,w=function(S,R,D){if(D===0)return S;var T=R.duration,I=R.easing,L=I===void 0?"ease":I,$=R.style,W=R.properties,Z=R.onAnimationEnd,oe=D>0?d[D-1]:R,te=W||Object.keys($);if(typeof L=="function"||L==="spring")return[].concat(yk(S),[l.runJSAnimation.bind(l,{from:oe.style,to:$,duration:T,easing:L}),T]);var be=D$(te,T,L),ie=lc(lc(lc({},oe.style),$),{},{transition:be});return[].concat(yk(S),[ie,T,Z]).filter(uEe)};return this.manager.start([f].concat(yk(d.reduce(w,[y,Math.max(j,a)])),[i.onAnimationEnd]))}},{key:"runAnimation",value:function(i){this.manager||(this.manager=oEe());var l=i.begin,d=i.duration,a=i.attributeName,f=i.to,p=i.easing,y=i.onAnimationStart,v=i.onAnimationEnd,j=i.steps,w=i.children,k=this.manager;if(this.unSubscribe=k.subscribe(this.handleStyleChange),typeof p=="function"||typeof w=="function"||p==="spring"){this.runJSAnimation(i);return}if(j.length>1){this.runStepAnimation(i);return}var S=a?J0({},a,f):f,R=D$(Object.keys(S),d,p);k.start([y,l,lc(lc({},S),{},{transition:R}),d,v])}},{key:"render",value:function(){var i=this.props,l=i.children;i.begin;var d=i.duration;i.attributeName,i.easing;var a=i.isActive;i.steps,i.from,i.to,i.canBegin,i.onAnimationEnd,i.shouldReAnimate,i.onAnimationReStart;var f=REe(i,DEe),p=O.Children.count(l),y=this.state.style;if(typeof l=="function")return l(y);if(!a||p===0||d<=0)return l;var v=function(w){var k=w.props,S=k.style,R=S===void 0?{}:S,D=k.className,T=O.cloneElement(w,lc(lc({},f),{},{style:lc(lc({},R),y),className:D}));return T};return p===1?v(O.Children.only(l)):me.createElement("div",null,O.Children.map(l,function(j){return v(j)}))}}]),n}(O.PureComponent);Fl.displayName="Animate";Fl.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Fl.propTypes={from:fn.oneOfType([fn.object,fn.string]),to:fn.oneOfType([fn.object,fn.string]),attributeName:fn.string,duration:fn.number,begin:fn.number,easing:fn.oneOfType([fn.string,fn.func]),steps:fn.arrayOf(fn.shape({duration:fn.number.isRequired,style:fn.object.isRequired,easing:fn.oneOfType([fn.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),fn.func]),properties:fn.arrayOf("string"),onAnimationEnd:fn.func})),children:fn.oneOfType([fn.node,fn.func]),isActive:fn.bool,canBegin:fn.bool,onAnimationEnd:fn.func,shouldReAnimate:fn.bool,onAnimationStart:fn.func,onAnimationReStart:fn.func};fn.object,fn.object,fn.object,fn.element;fn.object,fn.object,fn.object,fn.oneOfType([fn.array,fn.element]),fn.any;function bb(e){"@babel/helpers - typeof";return bb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},bb(e)}function SS(){return SS=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},SS.apply(this,arguments)}function ZEe(e,r){return JEe(e)||QEe(e,r)||XEe(e,r)||YEe()}function YEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XEe(e,r){if(e){if(typeof e=="string")return B$(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B$(e,r)}}function B$(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}function QEe(e,r){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,l,d,a=[],f=!0,p=!1;try{if(l=(n=n.call(e)).next,r!==0)for(;!(f=(s=l.call(n)).done)&&(a.push(s.value),a.length!==r);f=!0);}catch(y){p=!0,i=y}finally{try{if(!f&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(p)throw i}}return a}}function JEe(e){if(Array.isArray(e))return e}function q$(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function V$(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?q$(Object(n),!0).forEach(function(s){eMe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function eMe(e,r,n){return r=tMe(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function tMe(e){var r=rMe(e,"string");return bb(r)=="symbol"?r:r+""}function rMe(e,r){if(bb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(bb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var U$=function(r,n,s,i,l){var d=Math.min(Math.abs(s)/2,Math.abs(i)/2),a=i>=0?1:-1,f=s>=0?1:-1,p=i>=0&&s>=0||i<0&&s<0?1:0,y;if(d>0&&l instanceof Array){for(var v=[0,0,0,0],j=0,w=4;j<w;j++)v[j]=l[j]>d?d:l[j];y="M".concat(r,",").concat(n+a*v[0]),v[0]>0&&(y+="A ".concat(v[0],",").concat(v[0],",0,0,").concat(p,",").concat(r+f*v[0],",").concat(n)),y+="L ".concat(r+s-f*v[1],",").concat(n),v[1]>0&&(y+="A ".concat(v[1],",").concat(v[1],",0,0,").concat(p,`,
        `).concat(r+s,",").concat(n+a*v[1])),y+="L ".concat(r+s,",").concat(n+i-a*v[2]),v[2]>0&&(y+="A ".concat(v[2],",").concat(v[2],",0,0,").concat(p,`,
        `).concat(r+s-f*v[2],",").concat(n+i)),y+="L ".concat(r+f*v[3],",").concat(n+i),v[3]>0&&(y+="A ".concat(v[3],",").concat(v[3],",0,0,").concat(p,`,
        `).concat(r,",").concat(n+i-a*v[3])),y+="Z"}else if(d>0&&l===+l&&l>0){var k=Math.min(d,l);y="M ".concat(r,",").concat(n+a*k,`
            A `).concat(k,",").concat(k,",0,0,").concat(p,",").concat(r+f*k,",").concat(n,`
            L `).concat(r+s-f*k,",").concat(n,`
            A `).concat(k,",").concat(k,",0,0,").concat(p,",").concat(r+s,",").concat(n+a*k,`
            L `).concat(r+s,",").concat(n+i-a*k,`
            A `).concat(k,",").concat(k,",0,0,").concat(p,",").concat(r+s-f*k,",").concat(n+i,`
            L `).concat(r+f*k,",").concat(n+i,`
            A `).concat(k,",").concat(k,",0,0,").concat(p,",").concat(r,",").concat(n+i-a*k," Z")}else y="M ".concat(r,",").concat(n," h ").concat(s," v ").concat(i," h ").concat(-s," Z");return y},nMe=function(r,n){if(!r||!n)return!1;var s=r.x,i=r.y,l=n.x,d=n.y,a=n.width,f=n.height;if(Math.abs(a)>0&&Math.abs(f)>0){var p=Math.min(l,l+a),y=Math.max(l,l+a),v=Math.min(d,d+f),j=Math.max(d,d+f);return s>=p&&s<=y&&i>=v&&i<=j}return!1},sMe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},z4=function(r){var n=V$(V$({},sMe),r),s=O.useRef(),i=O.useState(-1),l=ZEe(i,2),d=l[0],a=l[1];O.useEffect(function(){if(s.current&&s.current.getTotalLength)try{var L=s.current.getTotalLength();L&&a(L)}catch{}},[]);var f=n.x,p=n.y,y=n.width,v=n.height,j=n.radius,w=n.className,k=n.animationEasing,S=n.animationDuration,R=n.animationBegin,D=n.isAnimationActive,T=n.isUpdateAnimationActive;if(f!==+f||p!==+p||y!==+y||v!==+v||y===0||v===0)return null;var I=Yr("recharts-rectangle",w);return T?me.createElement(Fl,{canBegin:d>0,from:{width:y,height:v,x:f,y:p},to:{width:y,height:v,x:f,y:p},duration:S,animationEasing:k,isActive:T},function(L){var $=L.width,W=L.height,Z=L.x,oe=L.y;return me.createElement(Fl,{canBegin:d>0,from:"0px ".concat(d===-1?1:d,"px"),to:"".concat(d,"px 0px"),attributeName:"strokeDasharray",begin:R,duration:S,isActive:D,easing:k},me.createElement("path",SS({},Cr(n,!0),{className:I,d:U$(Z,oe,$,W,j),ref:s})))}):me.createElement("path",SS({},Cr(n,!0),{className:I,d:U$(f,p,y,v,j)}))},iMe=["points","className","baseLinePoints","connectNulls"];function eg(){return eg=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},eg.apply(this,arguments)}function aMe(e,r){if(e==null)return{};var n=oMe(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function oMe(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}function W$(e){return uMe(e)||dMe(e)||cMe(e)||lMe()}function lMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cMe(e,r){if(e){if(typeof e=="string")return bM(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bM(e,r)}}function dMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uMe(e){if(Array.isArray(e))return bM(e)}function bM(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}var G$=function(r){return r&&r.x===+r.x&&r.y===+r.y},hMe=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[[]];return r.forEach(function(s){G$(s)?n[n.length-1].push(s):n[n.length-1].length>0&&n.push([])}),G$(r[0])&&n[n.length-1].push(r[0]),n[n.length-1].length<=0&&(n=n.slice(0,-1)),n},p_=function(r,n){var s=hMe(r);n&&(s=[s.reduce(function(l,d){return[].concat(W$(l),W$(d))},[])]);var i=s.map(function(l){return l.reduce(function(d,a,f){return"".concat(d).concat(f===0?"M":"L").concat(a.x,",").concat(a.y)},"")}).join("");return s.length===1?"".concat(i,"Z"):i},mMe=function(r,n,s){var i=p_(r,s);return"".concat(i.slice(-1)==="Z"?i.slice(0,-1):i,"L").concat(p_(n.reverse(),s).slice(1))},rH=function(r){var n=r.points,s=r.className,i=r.baseLinePoints,l=r.connectNulls,d=aMe(r,iMe);if(!n||!n.length)return null;var a=Yr("recharts-polygon",s);if(i&&i.length){var f=d.stroke&&d.stroke!=="none",p=mMe(n,i,l);return me.createElement("g",{className:a},me.createElement("path",eg({},Cr(d,!0),{fill:p.slice(-1)==="Z"?d.fill:"none",stroke:"none",d:p})),f?me.createElement("path",eg({},Cr(d,!0),{fill:"none",d:p_(n,l)})):null,f?me.createElement("path",eg({},Cr(d,!0),{fill:"none",d:p_(i,l)})):null)}var y=p_(n,l);return me.createElement("path",eg({},Cr(d,!0),{fill:y.slice(-1)==="Z"?d.fill:"none",className:a,d:y}))};function jM(){return jM=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},jM.apply(this,arguments)}var tv=function(r){var n=r.cx,s=r.cy,i=r.r,l=r.className,d=Yr("recharts-dot",l);return n===+n&&s===+s&&i===+i?me.createElement("circle",jM({},Cr(r,!1),WN(r),{className:d,cx:n,cy:s,r:i})):null};function jb(e){"@babel/helpers - typeof";return jb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},jb(e)}var fMe=["x","y","top","left","width","height","className"];function wM(){return wM=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},wM.apply(this,arguments)}function K$(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function pMe(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?K$(Object(n),!0).forEach(function(s){xMe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function xMe(e,r,n){return r=gMe(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function gMe(e){var r=yMe(e,"string");return jb(r)=="symbol"?r:r+""}function yMe(e,r){if(jb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(jb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function vMe(e,r){if(e==null)return{};var n=_Me(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function _Me(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}var bMe=function(r,n,s,i,l,d){return"M".concat(r,",").concat(l,"v").concat(i,"M").concat(d,",").concat(n,"h").concat(s)},jMe=function(r){var n=r.x,s=n===void 0?0:n,i=r.y,l=i===void 0?0:i,d=r.top,a=d===void 0?0:d,f=r.left,p=f===void 0?0:f,y=r.width,v=y===void 0?0:y,j=r.height,w=j===void 0?0:j,k=r.className,S=vMe(r,fMe),R=pMe({x:s,y:l,top:a,left:p,width:v,height:w},S);return!Xt(s)||!Xt(l)||!Xt(v)||!Xt(w)||!Xt(a)||!Xt(p)?null:me.createElement("path",wM({},Cr(R,!0),{className:Yr("recharts-cross",k),d:bMe(s,l,v,w,a,p)}))},wMe=["cx","cy","innerRadius","outerRadius","gridType","radialLines"];function wb(e){"@babel/helpers - typeof";return wb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},wb(e)}function NMe(e,r){if(e==null)return{};var n=SMe(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function SMe(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}function ku(){return ku=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},ku.apply(this,arguments)}function H$(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Nb(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?H$(Object(n),!0).forEach(function(s){PMe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function PMe(e,r,n){return r=CMe(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function CMe(e){var r=AMe(e,"string");return wb(r)=="symbol"?r:r+""}function AMe(e,r){if(wb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(wb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var kMe=function(r,n,s,i){var l="";return i.forEach(function(d,a){var f=Wn(n,s,r,d);a?l+="L ".concat(f.x,",").concat(f.y):l+="M ".concat(f.x,",").concat(f.y)}),l+="Z",l},TMe=function(r){var n=r.cx,s=r.cy,i=r.innerRadius,l=r.outerRadius,d=r.polarAngles,a=r.radialLines;if(!d||!d.length||!a)return null;var f=Nb({stroke:"#ccc"},Cr(r,!1));return me.createElement("g",{className:"recharts-polar-grid-angle"},d.map(function(p){var y=Wn(n,s,i,p),v=Wn(n,s,l,p);return me.createElement("line",ku({},f,{key:"line-".concat(p),x1:y.x,y1:y.y,x2:v.x,y2:v.y}))}))},EMe=function(r){var n=r.cx,s=r.cy,i=r.radius,l=r.index,d=Nb(Nb({stroke:"#ccc"},Cr(r,!1)),{},{fill:"none"});return me.createElement("circle",ku({},d,{className:Yr("recharts-polar-grid-concentric-circle",r.className),key:"circle-".concat(l),cx:n,cy:s,r:i}))},MMe=function(r){var n=r.radius,s=r.index,i=Nb(Nb({stroke:"#ccc"},Cr(r,!1)),{},{fill:"none"});return me.createElement("path",ku({},i,{className:Yr("recharts-polar-grid-concentric-polygon",r.className),key:"path-".concat(s),d:kMe(n,r.cx,r.cy,r.polarAngles)}))},OMe=function(r){var n=r.polarRadius,s=r.gridType;return!n||!n.length?null:me.createElement("g",{className:"recharts-polar-grid-concentric"},n.map(function(i,l){var d=l;return s==="circle"?me.createElement(EMe,ku({key:d},r,{radius:i,index:l})):me.createElement(MMe,ku({key:d},r,{radius:i,index:l}))}))},nH=function(r){var n=r.cx,s=n===void 0?0:n,i=r.cy,l=i===void 0?0:i,d=r.innerRadius,a=d===void 0?0:d,f=r.outerRadius,p=f===void 0?0:f,y=r.gridType,v=y===void 0?"polygon":y,j=r.radialLines,w=j===void 0?!0:j,k=NMe(r,wMe);return p<=0?null:me.createElement("g",{className:"recharts-polar-grid"},me.createElement(TMe,ku({cx:s,cy:l,innerRadius:a,outerRadius:p,gridType:v,radialLines:w},k)),me.createElement(OMe,ku({cx:s,cy:l,innerRadius:a,outerRadius:p,gridType:v,radialLines:w},k)))};nH.displayName="PolarGrid";var IMe=jP,DMe=dK,RMe=_d;function LMe(e,r){return e&&e.length?IMe(e,RMe(r),DMe):void 0}var FMe=LMe;const zMe=Vn(FMe);var $Me=jP,BMe=_d,qMe=uK;function VMe(e,r){return e&&e.length?$Me(e,BMe(r),qMe):void 0}var UMe=VMe;const WMe=Vn(UMe);var GMe=["cx","cy","angle","ticks","axisLine"],KMe=["ticks","tick","angle","tickFormatter","stroke"];function oy(e){"@babel/helpers - typeof";return oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},oy(e)}function x_(){return x_=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},x_.apply(this,arguments)}function Z$(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function pf(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Z$(Object(n),!0).forEach(function(s){PP(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Y$(e,r){if(e==null)return{};var n=HMe(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function HMe(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}function ZMe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function X$(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,iH(s.key),s)}}function YMe(e,r,n){return r&&X$(e.prototype,r),n&&X$(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function XMe(e,r,n){return r=PS(r),QMe(e,sH()?Reflect.construct(r,n||[],PS(e).constructor):r.apply(e,n))}function QMe(e,r){if(r&&(oy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JMe(e)}function JMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sH=function(){return!!e})()}function PS(e){return PS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},PS(e)}function eOe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&NM(e,r)}function NM(e,r){return NM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},NM(e,r)}function PP(e,r,n){return r=iH(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function iH(e){var r=tOe(e,"string");return oy(r)=="symbol"?r:r+""}function tOe(e,r){if(oy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(oy(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var rv=function(e){function r(){return ZMe(this,r),XMe(this,r,arguments)}return eOe(r,e),YMe(r,[{key:"getTickValueCoord",value:function(s){var i=s.coordinate,l=this.props,d=l.angle,a=l.cx,f=l.cy;return Wn(a,f,i,d)}},{key:"getTickTextAnchor",value:function(){var s=this.props.orientation,i;switch(s){case"left":i="end";break;case"right":i="start";break;default:i="middle";break}return i}},{key:"getViewBox",value:function(){var s=this.props,i=s.cx,l=s.cy,d=s.angle,a=s.ticks,f=zMe(a,function(y){return y.coordinate||0}),p=WMe(a,function(y){return y.coordinate||0});return{cx:i,cy:l,startAngle:d,endAngle:d,innerRadius:p.coordinate||0,outerRadius:f.coordinate||0}}},{key:"renderAxisLine",value:function(){var s=this.props,i=s.cx,l=s.cy,d=s.angle,a=s.ticks,f=s.axisLine,p=Y$(s,GMe),y=a.reduce(function(k,S){return[Math.min(k[0],S.coordinate),Math.max(k[1],S.coordinate)]},[1/0,-1/0]),v=Wn(i,l,y[0],d),j=Wn(i,l,y[1],d),w=pf(pf(pf({},Cr(p,!1)),{},{fill:"none"},Cr(f,!1)),{},{x1:v.x,y1:v.y,x2:j.x,y2:j.y});return me.createElement("line",x_({className:"recharts-polar-radius-axis-line"},w))}},{key:"renderTicks",value:function(){var s=this,i=this.props,l=i.ticks,d=i.tick,a=i.angle,f=i.tickFormatter,p=i.stroke,y=Y$(i,KMe),v=this.getTickTextAnchor(),j=Cr(y,!1),w=Cr(d,!1),k=l.map(function(S,R){var D=s.getTickValueCoord(S),T=pf(pf(pf(pf({textAnchor:v,transform:"rotate(".concat(90-a,", ").concat(D.x,", ").concat(D.y,")")},j),{},{stroke:"none",fill:p},w),{},{index:R},D),{},{payload:S});return me.createElement(gn,x_({className:Yr("recharts-polar-radius-axis-tick",$K(d)),key:"tick-".concat(S.coordinate)},ap(s.props,S,R)),r.renderTickItem(d,T,f?f(S.value,R):S.value))});return me.createElement(gn,{className:"recharts-polar-radius-axis-ticks"},k)}},{key:"render",value:function(){var s=this.props,i=s.ticks,l=s.axisLine,d=s.tick;return!i||!i.length?null:me.createElement(gn,{className:Yr("recharts-polar-radius-axis",this.props.className)},l&&this.renderAxisLine(),d&&this.renderTicks(),ha.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(s,i,l){var d;return me.isValidElement(s)?d=me.cloneElement(s,i):Br(s)?d=s(i):d=me.createElement(op,x_({},i,{className:"recharts-polar-radius-axis-tick-value"}),l),d}}])}(O.PureComponent);PP(rv,"displayName","PolarRadiusAxis");PP(rv,"axisType","radiusAxis");PP(rv,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function ly(e){"@babel/helpers - typeof";return ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ly(e)}function wf(){return wf=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},wf.apply(this,arguments)}function Q$(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function xf(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Q$(Object(n),!0).forEach(function(s){CP(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q$(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function rOe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function J$(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,oH(s.key),s)}}function nOe(e,r,n){return r&&J$(e.prototype,r),n&&J$(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function sOe(e,r,n){return r=CS(r),iOe(e,aH()?Reflect.construct(r,n||[],CS(e).constructor):r.apply(e,n))}function iOe(e,r){if(r&&(ly(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aOe(e)}function aOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aH=function(){return!!e})()}function CS(e){return CS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},CS(e)}function oOe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&SM(e,r)}function SM(e,r){return SM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},SM(e,r)}function CP(e,r,n){return r=oH(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function oH(e){var r=lOe(e,"string");return ly(r)=="symbol"?r:r+""}function lOe(e,r){if(ly(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(ly(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var cOe=Math.PI/180,e6=1e-5,nv=function(e){function r(){return rOe(this,r),sOe(this,r,arguments)}return oOe(r,e),nOe(r,[{key:"getTickLineCoord",value:function(s){var i=this.props,l=i.cx,d=i.cy,a=i.radius,f=i.orientation,p=i.tickSize,y=p||8,v=Wn(l,d,a,s.coordinate),j=Wn(l,d,a+(f==="inner"?-1:1)*y,s.coordinate);return{x1:v.x,y1:v.y,x2:j.x,y2:j.y}}},{key:"getTickTextAnchor",value:function(s){var i=this.props.orientation,l=Math.cos(-s.coordinate*cOe),d;return l>e6?d=i==="outer"?"start":"end":l<-e6?d=i==="outer"?"end":"start":d="middle",d}},{key:"renderAxisLine",value:function(){var s=this.props,i=s.cx,l=s.cy,d=s.radius,a=s.axisLine,f=s.axisLineType,p=xf(xf({},Cr(this.props,!1)),{},{fill:"none"},Cr(a,!1));if(f==="circle")return me.createElement(tv,wf({className:"recharts-polar-angle-axis-line"},p,{cx:i,cy:l,r:d}));var y=this.props.ticks,v=y.map(function(j){return Wn(i,l,d,j.coordinate)});return me.createElement(rH,wf({className:"recharts-polar-angle-axis-line"},p,{points:v}))}},{key:"renderTicks",value:function(){var s=this,i=this.props,l=i.ticks,d=i.tick,a=i.tickLine,f=i.tickFormatter,p=i.stroke,y=Cr(this.props,!1),v=Cr(d,!1),j=xf(xf({},y),{},{fill:"none"},Cr(a,!1)),w=l.map(function(k,S){var R=s.getTickLineCoord(k),D=s.getTickTextAnchor(k),T=xf(xf(xf({textAnchor:D},y),{},{stroke:"none",fill:p},v),{},{index:S,payload:k,x:R.x2,y:R.y2});return me.createElement(gn,wf({className:Yr("recharts-polar-angle-axis-tick",$K(d)),key:"tick-".concat(k.coordinate)},ap(s.props,k,S)),a&&me.createElement("line",wf({className:"recharts-polar-angle-axis-tick-line"},j,R)),d&&r.renderTickItem(d,T,f?f(k.value,S):k.value))});return me.createElement(gn,{className:"recharts-polar-angle-axis-ticks"},w)}},{key:"render",value:function(){var s=this.props,i=s.ticks,l=s.radius,d=s.axisLine;return l<=0||!i||!i.length?null:me.createElement(gn,{className:Yr("recharts-polar-angle-axis",this.props.className)},d&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(s,i,l){var d;return me.isValidElement(s)?d=me.cloneElement(s,i):Br(s)?d=s(i):d=me.createElement(op,wf({},i,{className:"recharts-polar-angle-axis-tick-value"}),l),d}}])}(O.PureComponent);CP(nv,"displayName","PolarAngleAxis");CP(nv,"axisType","angleAxis");CP(nv,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var dOe=aG,uOe=dOe(Object.getPrototypeOf,Object),hOe=uOe,mOe=Du,fOe=hOe,pOe=Ru,xOe="[object Object]",gOe=Function.prototype,yOe=Object.prototype,lH=gOe.toString,vOe=yOe.hasOwnProperty,_Oe=lH.call(Object);function bOe(e){if(!pOe(e)||mOe(e)!=xOe)return!1;var r=fOe(e);if(r===null)return!0;var n=vOe.call(r,"constructor")&&r.constructor;return typeof n=="function"&&n instanceof n&&lH.call(n)==_Oe}var jOe=bOe;const wOe=Vn(jOe);var NOe=Du,SOe=Ru,POe="[object Boolean]";function COe(e){return e===!0||e===!1||SOe(e)&&NOe(e)==POe}var AOe=COe;const kOe=Vn(AOe);function Sb(e){"@babel/helpers - typeof";return Sb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Sb(e)}function AS(){return AS=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},AS.apply(this,arguments)}function TOe(e,r){return IOe(e)||OOe(e,r)||MOe(e,r)||EOe()}function EOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MOe(e,r){if(e){if(typeof e=="string")return t6(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t6(e,r)}}function t6(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}function OOe(e,r){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,l,d,a=[],f=!0,p=!1;try{if(l=(n=n.call(e)).next,r!==0)for(;!(f=(s=l.call(n)).done)&&(a.push(s.value),a.length!==r);f=!0);}catch(y){p=!0,i=y}finally{try{if(!f&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(p)throw i}}return a}}function IOe(e){if(Array.isArray(e))return e}function r6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function n6(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?r6(Object(n),!0).forEach(function(s){DOe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function DOe(e,r,n){return r=ROe(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function ROe(e){var r=LOe(e,"string");return Sb(r)=="symbol"?r:r+""}function LOe(e,r){if(Sb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(Sb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var s6=function(r,n,s,i,l){var d=s-i,a;return a="M ".concat(r,",").concat(n),a+="L ".concat(r+s,",").concat(n),a+="L ".concat(r+s-d/2,",").concat(n+l),a+="L ".concat(r+s-d/2-i,",").concat(n+l),a+="L ".concat(r,",").concat(n," Z"),a},FOe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},zOe=function(r){var n=n6(n6({},FOe),r),s=O.useRef(),i=O.useState(-1),l=TOe(i,2),d=l[0],a=l[1];O.useEffect(function(){if(s.current&&s.current.getTotalLength)try{var I=s.current.getTotalLength();I&&a(I)}catch{}},[]);var f=n.x,p=n.y,y=n.upperWidth,v=n.lowerWidth,j=n.height,w=n.className,k=n.animationEasing,S=n.animationDuration,R=n.animationBegin,D=n.isUpdateAnimationActive;if(f!==+f||p!==+p||y!==+y||v!==+v||j!==+j||y===0&&v===0||j===0)return null;var T=Yr("recharts-trapezoid",w);return D?me.createElement(Fl,{canBegin:d>0,from:{upperWidth:0,lowerWidth:0,height:j,x:f,y:p},to:{upperWidth:y,lowerWidth:v,height:j,x:f,y:p},duration:S,animationEasing:k,isActive:D},function(I){var L=I.upperWidth,$=I.lowerWidth,W=I.height,Z=I.x,oe=I.y;return me.createElement(Fl,{canBegin:d>0,from:"0px ".concat(d===-1?1:d,"px"),to:"".concat(d,"px 0px"),attributeName:"strokeDasharray",begin:R,duration:S,easing:k},me.createElement("path",AS({},Cr(n,!0),{className:T,d:s6(Z,oe,L,$,W),ref:s})))}):me.createElement("g",null,me.createElement("path",AS({},Cr(n,!0),{className:T,d:s6(f,p,y,v,j)})))},$Oe=["option","shapeType","propTransformer","activeClassName","isActive"];function Pb(e){"@babel/helpers - typeof";return Pb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Pb(e)}function BOe(e,r){if(e==null)return{};var n=qOe(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function qOe(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}function i6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function kS(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?i6(Object(n),!0).forEach(function(s){VOe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function VOe(e,r,n){return r=UOe(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function UOe(e){var r=WOe(e,"string");return Pb(r)=="symbol"?r:r+""}function WOe(e,r){if(Pb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(Pb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function GOe(e,r){return kS(kS({},r),e)}function KOe(e,r){return e==="symbols"}function a6(e){var r=e.shapeType,n=e.elementProps;switch(r){case"rectangle":return me.createElement(z4,n);case"trapezoid":return me.createElement(zOe,n);case"sector":return me.createElement(UK,n);case"symbols":if(KOe(r))return me.createElement(s4,n);break;default:return null}}function HOe(e){return O.isValidElement(e)?e.props:e}function cH(e){var r=e.option,n=e.shapeType,s=e.propTransformer,i=s===void 0?GOe:s,l=e.activeClassName,d=l===void 0?"recharts-active-shape":l,a=e.isActive,f=BOe(e,$Oe),p;if(O.isValidElement(r))p=O.cloneElement(r,kS(kS({},f),HOe(r)));else if(Br(r))p=r(f);else if(wOe(r)&&!kOe(r)){var y=i(r,f);p=me.createElement(a6,{shapeType:n,elementProps:y})}else{var v=f;p=me.createElement(a6,{shapeType:n,elementProps:v})}return a?me.createElement(gn,{className:d},p):p}function AP(e,r){return r!=null&&"trapezoids"in e.props}function kP(e,r){return r!=null&&"sectors"in e.props}function Cb(e,r){return r!=null&&"points"in e.props}function ZOe(e,r){var n,s,i=e.x===(r==null||(n=r.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===r.x,l=e.y===(r==null||(s=r.labelViewBox)===null||s===void 0?void 0:s.y)||e.y===r.y;return i&&l}function YOe(e,r){var n=e.endAngle===r.endAngle,s=e.startAngle===r.startAngle;return n&&s}function XOe(e,r){var n=e.x===r.x,s=e.y===r.y,i=e.z===r.z;return n&&s&&i}function QOe(e,r){var n;return AP(e,r)?n=ZOe:kP(e,r)?n=YOe:Cb(e,r)&&(n=XOe),n}function JOe(e,r){var n;return AP(e,r)?n="trapezoids":kP(e,r)?n="sectors":Cb(e,r)&&(n="points"),n}function eIe(e,r){if(AP(e,r)){var n;return(n=r.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(kP(e,r)){var s;return(s=r.tooltipPayload)===null||s===void 0||(s=s[0])===null||s===void 0||(s=s.payload)===null||s===void 0?void 0:s.payload}return Cb(e,r)?r.payload:{}}function tIe(e){var r=e.activeTooltipItem,n=e.graphicalItem,s=e.itemData,i=JOe(n,r),l=eIe(n,r),d=s.filter(function(f,p){var y=xm(l,f),v=n.props[i].filter(function(k){var S=QOe(n,r);return S(k,r)}),j=n.props[i].indexOf(v[v.length-1]),w=p===j;return y&&w}),a=s.indexOf(d[d.length-1]);return a}var W1;function cy(e){"@babel/helpers - typeof";return cy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},cy(e)}function tg(){return tg=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},tg.apply(this,arguments)}function o6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function js(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?o6(Object(n),!0).forEach(function(s){Cl(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function rIe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function l6(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,uH(s.key),s)}}function nIe(e,r,n){return r&&l6(e.prototype,r),n&&l6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function sIe(e,r,n){return r=TS(r),iIe(e,dH()?Reflect.construct(r,n||[],TS(e).constructor):r.apply(e,n))}function iIe(e,r){if(r&&(cy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aIe(e)}function aIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dH=function(){return!!e})()}function TS(e){return TS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},TS(e)}function oIe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&PM(e,r)}function PM(e,r){return PM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},PM(e,r)}function Cl(e,r,n){return r=uH(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function uH(e){var r=lIe(e,"string");return cy(r)=="symbol"?r:r+""}function lIe(e,r){if(cy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(cy(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var fd=function(e){function r(n){var s;return rIe(this,r),s=sIe(this,r,[n]),Cl(s,"pieRef",null),Cl(s,"sectorRefs",[]),Cl(s,"id",gp("recharts-pie-")),Cl(s,"handleAnimationEnd",function(){var i=s.props.onAnimationEnd;s.setState({isAnimationFinished:!0}),Br(i)&&i()}),Cl(s,"handleAnimationStart",function(){var i=s.props.onAnimationStart;s.setState({isAnimationFinished:!1}),Br(i)&&i()}),s.state={isAnimationFinished:!n.isAnimationActive,prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,sectorToFocus:0},s}return oIe(r,e),nIe(r,[{key:"isActiveIndex",value:function(s){var i=this.props.activeIndex;return Array.isArray(i)?i.indexOf(s)!==-1:s===i}},{key:"hasActiveIndex",value:function(){var s=this.props.activeIndex;return Array.isArray(s)?s.length!==0:s||s===0}},{key:"renderLabels",value:function(s){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var l=this.props,d=l.label,a=l.labelLine,f=l.dataKey,p=l.valueKey,y=Cr(this.props,!1),v=Cr(d,!1),j=Cr(a,!1),w=d&&d.offsetRadius||20,k=s.map(function(S,R){var D=(S.startAngle+S.endAngle)/2,T=Wn(S.cx,S.cy,S.outerRadius+w,D),I=js(js(js(js({},y),S),{},{stroke:"none"},v),{},{index:R,textAnchor:r.getTextAnchor(T.x,S.cx)},T),L=js(js(js(js({},y),S),{},{fill:"none",stroke:S.fill},j),{},{index:R,points:[Wn(S.cx,S.cy,S.outerRadius,D),T]}),$=f;return Zr(f)&&Zr(p)?$="value":Zr(f)&&($=p),me.createElement(gn,{key:"label-".concat(S.startAngle,"-").concat(S.endAngle,"-").concat(S.midAngle,"-").concat(R)},a&&r.renderLabelLineItem(a,L,"line"),r.renderLabelItem(d,I,ii(S,$)))});return me.createElement(gn,{className:"recharts-pie-labels"},k)}},{key:"renderSectorsStatically",value:function(s){var i=this,l=this.props,d=l.activeShape,a=l.blendStroke,f=l.inactiveShape;return s.map(function(p,y){if((p==null?void 0:p.startAngle)===0&&(p==null?void 0:p.endAngle)===0&&s.length!==1)return null;var v=i.isActiveIndex(y),j=f&&i.hasActiveIndex()?f:null,w=v?d:j,k=js(js({},p),{},{stroke:a?p.fill:p.stroke,tabIndex:-1});return me.createElement(gn,tg({ref:function(R){R&&!i.sectorRefs.includes(R)&&i.sectorRefs.push(R)},tabIndex:-1,className:"recharts-pie-sector"},ap(i.props,p,y),{key:"sector-".concat(p==null?void 0:p.startAngle,"-").concat(p==null?void 0:p.endAngle,"-").concat(p.midAngle,"-").concat(y)}),me.createElement(cH,tg({option:w,isActive:v,shapeType:"sector"},k)))})}},{key:"renderSectorsWithAnimation",value:function(){var s=this,i=this.props,l=i.sectors,d=i.isAnimationActive,a=i.animationBegin,f=i.animationDuration,p=i.animationEasing,y=i.animationId,v=this.state,j=v.prevSectors,w=v.prevIsAnimationActive;return me.createElement(Fl,{begin:a,duration:f,isActive:d,easing:p,from:{t:0},to:{t:1},key:"pie-".concat(y,"-").concat(w),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(k){var S=k.t,R=[],D=l&&l[0],T=D.startAngle;return l.forEach(function(I,L){var $=j&&j[L],W=L>0?sl(I,"paddingAngle",0):0;if($){var Z=si($.endAngle-$.startAngle,I.endAngle-I.startAngle),oe=js(js({},I),{},{startAngle:T+W,endAngle:T+Z(S)+W});R.push(oe),T=oe.endAngle}else{var te=I.endAngle,be=I.startAngle,ie=si(0,te-be),ge=ie(S),Ie=js(js({},I),{},{startAngle:T+W,endAngle:T+ge+W});R.push(Ie),T=Ie.endAngle}}),me.createElement(gn,null,s.renderSectorsStatically(R))})}},{key:"attachKeyboardHandlers",value:function(s){var i=this;s.onkeydown=function(l){if(!l.altKey)switch(l.key){case"ArrowLeft":{var d=++i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[d].focus(),i.setState({sectorToFocus:d});break}case"ArrowRight":{var a=--i.state.sectorToFocus<0?i.sectorRefs.length-1:i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[a].focus(),i.setState({sectorToFocus:a});break}case"Escape":{i.sectorRefs[i.state.sectorToFocus].blur(),i.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var s=this.props,i=s.sectors,l=s.isAnimationActive,d=this.state.prevSectors;return l&&i&&i.length&&(!d||!xm(d,i))?this.renderSectorsWithAnimation():this.renderSectorsStatically(i)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var s=this,i=this.props,l=i.hide,d=i.sectors,a=i.className,f=i.label,p=i.cx,y=i.cy,v=i.innerRadius,j=i.outerRadius,w=i.isAnimationActive,k=this.state.isAnimationFinished;if(l||!d||!d.length||!Xt(p)||!Xt(y)||!Xt(v)||!Xt(j))return null;var S=Yr("recharts-pie",a);return me.createElement(gn,{tabIndex:this.props.rootTabIndex,className:S,ref:function(D){s.pieRef=D}},this.renderSectors(),f&&this.renderLabels(d),ha.renderCallByParent(this.props,null,!1),(!w||k)&&Cc.renderCallByParent(this.props,d,!1))}}],[{key:"getDerivedStateFromProps",value:function(s,i){return i.prevIsAnimationActive!==s.isAnimationActive?{prevIsAnimationActive:s.isAnimationActive,prevAnimationId:s.animationId,curSectors:s.sectors,prevSectors:[],isAnimationFinished:!0}:s.isAnimationActive&&s.animationId!==i.prevAnimationId?{prevAnimationId:s.animationId,curSectors:s.sectors,prevSectors:i.curSectors,isAnimationFinished:!0}:s.sectors!==i.curSectors?{curSectors:s.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(s,i){return s>i?"start":s<i?"end":"middle"}},{key:"renderLabelLineItem",value:function(s,i,l){if(me.isValidElement(s))return me.cloneElement(s,i);if(Br(s))return s(i);var d=Yr("recharts-pie-label-line",typeof s!="boolean"?s.className:"");return me.createElement(Uf,tg({},i,{key:l,type:"linear",className:d}))}},{key:"renderLabelItem",value:function(s,i,l){if(me.isValidElement(s))return me.cloneElement(s,i);var d=l;if(Br(s)&&(d=s(i),me.isValidElement(d)))return d;var a=Yr("recharts-pie-label-text",typeof s!="boolean"&&!Br(s)?s.className:"");return me.createElement(op,tg({},i,{alignmentBaseline:"middle",className:a}),d)}}])}(O.PureComponent);W1=fd;Cl(fd,"displayName","Pie");Cl(fd,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Lu.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Cl(fd,"parseDeltaAngle",function(e,r){var n=uo(r-e),s=Math.min(Math.abs(r-e),360);return n*s});Cl(fd,"getRealPieData",function(e){var r=e.data,n=e.children,s=Cr(e,!1),i=il(n,tb);return r&&r.length?r.map(function(l,d){return js(js(js({payload:l},s),l),i&&i[d]&&i[d].props)}):i&&i.length?i.map(function(l){return js(js({},s),l.props)}):[]});Cl(fd,"parseCoordinateOfPie",function(e,r){var n=r.top,s=r.left,i=r.width,l=r.height,d=FK(i,l),a=s+ho(e.cx,i,i/2),f=n+ho(e.cy,l,l/2),p=ho(e.innerRadius,d,0),y=ho(e.outerRadius,d,d*.8),v=e.maxRadius||Math.sqrt(i*i+l*l)/2;return{cx:a,cy:f,innerRadius:p,outerRadius:y,maxRadius:v}});Cl(fd,"getComposedData",function(e){var r=e.item,n=e.offset,s=r.type.defaultProps!==void 0?js(js({},r.type.defaultProps),r.props):r.props,i=W1.getRealPieData(s);if(!i||!i.length)return null;var l=s.cornerRadius,d=s.startAngle,a=s.endAngle,f=s.paddingAngle,p=s.dataKey,y=s.nameKey,v=s.valueKey,j=s.tooltipType,w=Math.abs(s.minAngle),k=W1.parseCoordinateOfPie(s,n),S=W1.parseDeltaAngle(d,a),R=Math.abs(S),D=p;Zr(p)&&Zr(v)?(Pc(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),D="value"):Zr(p)&&(Pc(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),D=v);var T=i.filter(function(oe){return ii(oe,D,0)!==0}).length,I=(R>=360?T:T-1)*f,L=R-T*w-I,$=i.reduce(function(oe,te){var be=ii(te,D,0);return oe+(Xt(be)?be:0)},0),W;if($>0){var Z;W=i.map(function(oe,te){var be=ii(oe,D,0),ie=ii(oe,y,te),ge=(Xt(be)?be:0)/$,Ie;te?Ie=Z.endAngle+uo(S)*f*(be!==0?1:0):Ie=d;var Oe=Ie+uo(S)*((be!==0?w:0)+ge*L),Xe=(Ie+Oe)/2,Ue=(k.innerRadius+k.outerRadius)/2,tt=[{name:ie,value:be,payload:oe,dataKey:D,type:j}],Ce=Wn(k.cx,k.cy,Ue,Xe);return Z=js(js(js({percent:ge,cornerRadius:l,name:ie,tooltipPayload:tt,midAngle:Xe,middleRadius:Ue,tooltipPosition:Ce},oe),k),{},{value:ii(oe,D),startAngle:Ie,endAngle:Oe,payload:oe,paddingAngle:uo(S)*f}),Z})}return js(js({},k),{},{sectors:W,data:i})});function cIe(e){return e&&e.length?e[0]:void 0}var dIe=cIe,uIe=dIe;const hIe=Vn(uIe);var mIe=["key"];function dy(e){"@babel/helpers - typeof";return dy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},dy(e)}function fIe(e,r){if(e==null)return{};var n=pIe(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function pIe(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}function ES(){return ES=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},ES.apply(this,arguments)}function c6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function ao(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?c6(Object(n),!0).forEach(function(s){ru(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function xIe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function d6(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,mH(s.key),s)}}function gIe(e,r,n){return r&&d6(e.prototype,r),n&&d6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function yIe(e,r,n){return r=MS(r),vIe(e,hH()?Reflect.construct(r,n||[],MS(e).constructor):r.apply(e,n))}function vIe(e,r){if(r&&(dy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Ie(e)}function _Ie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hH=function(){return!!e})()}function MS(e){return MS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},MS(e)}function bIe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&CM(e,r)}function CM(e,r){return CM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},CM(e,r)}function ru(e,r,n){return r=mH(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function mH(e){var r=jIe(e,"string");return dy(r)=="symbol"?r:r+""}function jIe(e,r){if(dy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(dy(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var aj=function(e){function r(){var n;xIe(this,r);for(var s=arguments.length,i=new Array(s),l=0;l<s;l++)i[l]=arguments[l];return n=yIe(this,r,[].concat(i)),ru(n,"state",{isAnimationFinished:!1}),ru(n,"handleAnimationEnd",function(){var d=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Br(d)&&d()}),ru(n,"handleAnimationStart",function(){var d=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Br(d)&&d()}),ru(n,"handleMouseEnter",function(d){var a=n.props.onMouseEnter;a&&a(n.props,d)}),ru(n,"handleMouseLeave",function(d){var a=n.props.onMouseLeave;a&&a(n.props,d)}),n}return bIe(r,e),gIe(r,[{key:"renderDots",value:function(s){var i=this.props,l=i.dot,d=i.dataKey,a=Cr(this.props,!1),f=Cr(l,!0),p=s.map(function(y,v){var j=ao(ao(ao({key:"dot-".concat(v),r:3},a),f),{},{dataKey:d,cx:y.x,cy:y.y,index:v,payload:y});return r.renderDotItem(l,j)});return me.createElement(gn,{className:"recharts-radar-dots"},p)}},{key:"renderPolygonStatically",value:function(s){var i=this.props,l=i.shape,d=i.dot,a=i.isRange,f=i.baseLinePoints,p=i.connectNulls,y;return me.isValidElement(l)?y=me.cloneElement(l,ao(ao({},this.props),{},{points:s})):Br(l)?y=l(ao(ao({},this.props),{},{points:s})):y=me.createElement(rH,ES({},Cr(this.props,!0),{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,points:s,baseLinePoints:a?f:null,connectNulls:p})),me.createElement(gn,{className:"recharts-radar-polygon"},y,d?this.renderDots(s):null)}},{key:"renderPolygonWithAnimation",value:function(){var s=this,i=this.props,l=i.points,d=i.isAnimationActive,a=i.animationBegin,f=i.animationDuration,p=i.animationEasing,y=i.animationId,v=this.state.prevPoints;return me.createElement(Fl,{begin:a,duration:f,isActive:d,easing:p,from:{t:0},to:{t:1},key:"radar-".concat(y),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(j){var w=j.t,k=v&&v.length/l.length,S=l.map(function(R,D){var T=v&&v[Math.floor(D*k)];if(T){var I=si(T.x,R.x),L=si(T.y,R.y);return ao(ao({},R),{},{x:I(w),y:L(w)})}var $=si(R.cx,R.x),W=si(R.cy,R.y);return ao(ao({},R),{},{x:$(w),y:W(w)})});return s.renderPolygonStatically(S)})}},{key:"renderPolygon",value:function(){var s=this.props,i=s.points,l=s.isAnimationActive,d=s.isRange,a=this.state.prevPoints;return l&&i&&i.length&&!d&&(!a||!xm(a,i))?this.renderPolygonWithAnimation():this.renderPolygonStatically(i)}},{key:"render",value:function(){var s=this.props,i=s.hide,l=s.className,d=s.points,a=s.isAnimationActive;if(i||!d||!d.length)return null;var f=this.state.isAnimationFinished,p=Yr("recharts-radar",l);return me.createElement(gn,{className:p},this.renderPolygon(),(!a||f)&&Cc.renderCallByParent(this.props,d))}}],[{key:"getDerivedStateFromProps",value:function(s,i){return s.animationId!==i.prevAnimationId?{prevAnimationId:s.animationId,curPoints:s.points,prevPoints:i.curPoints}:s.points!==i.curPoints?{curPoints:s.points}:null}},{key:"renderDotItem",value:function(s,i){var l;if(me.isValidElement(s))l=me.cloneElement(s,i);else if(Br(s))l=s(i);else{var d=i.key,a=fIe(i,mIe);l=me.createElement(tv,ES({},a,{key:d,className:Yr("recharts-radar-dot",typeof s!="boolean"?s.className:"")}))}return l}}])}(O.PureComponent);ru(aj,"displayName","Radar");ru(aj,"defaultProps",{angleAxisId:0,radiusAxisId:0,hide:!1,activeDot:!0,dot:!1,legendType:"rect",isAnimationActive:!Lu.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});ru(aj,"getComposedData",function(e){var r=e.radiusAxis,n=e.angleAxis,s=e.displayedData,i=e.dataKey,l=e.bandSize,d=n.cx,a=n.cy,f=!1,p=[],y=n.type!=="number"?l??0:0;s.forEach(function(j,w){var k=ii(j,n.dataKey,w),S=ii(j,i),R=n.scale(k)+y,D=Array.isArray(S)?qK(S):S,T=Zr(D)?void 0:r.scale(D);Array.isArray(S)&&S.length>=2&&(f=!0),p.push(ao(ao({},Wn(d,a,T,R)),{},{name:k,value:S,cx:d,cy:a,radius:T,angle:R,payload:j}))});var v=[];return f&&p.forEach(function(j){if(Array.isArray(j.value)){var w=hIe(j.value),k=Zr(w)?void 0:r.scale(w);v.push(ao(ao({},j),{},{radius:k},Wn(d,a,k,j.angle)))}else v.push(j)}),{points:p,isRange:f,baseLinePoints:v}});var wIe=Math.ceil,NIe=Math.max;function SIe(e,r,n,s){for(var i=-1,l=NIe(wIe((r-e)/(n||1)),0),d=Array(l);l--;)d[s?l:++i]=e,e+=n;return d}var PIe=SIe,CIe=SG,u6=1/0,AIe=17976931348623157e292;function kIe(e){if(!e)return e===0?e:0;if(e=CIe(e),e===u6||e===-u6){var r=e<0?-1:1;return r*AIe}return e===e?e:0}var fH=kIe,TIe=PIe,EIe=pP,vk=fH;function MIe(e){return function(r,n,s){return s&&typeof s!="number"&&EIe(r,n,s)&&(n=s=void 0),r=vk(r),n===void 0?(n=r,r=0):n=vk(n),s=s===void 0?r<n?1:-1:vk(s),TIe(r,n,s,e)}}var OIe=MIe,IIe=OIe,DIe=IIe(),RIe=DIe;const OS=Vn(RIe);function Ab(e){"@babel/helpers - typeof";return Ab=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ab(e)}function h6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function m6(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?h6(Object(n),!0).forEach(function(s){pH(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function pH(e,r,n){return r=LIe(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function LIe(e){var r=FIe(e,"string");return Ab(r)=="symbol"?r:r+""}function FIe(e,r){if(Ab(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(Ab(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var zIe=["Webkit","Moz","O","ms"],$Ie=function(r,n){var s=r.replace(/(\w)/,function(l){return l.toUpperCase()}),i=zIe.reduce(function(l,d){return m6(m6({},l),{},pH({},d+s,n))},{});return i[r]=n,i};function uy(e){"@babel/helpers - typeof";return uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},uy(e)}function IS(){return IS=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},IS.apply(this,arguments)}function f6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function _k(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?f6(Object(n),!0).forEach(function(s){Ko(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function BIe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function p6(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,gH(s.key),s)}}function qIe(e,r,n){return r&&p6(e.prototype,r),n&&p6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function VIe(e,r,n){return r=DS(r),UIe(e,xH()?Reflect.construct(r,n||[],DS(e).constructor):r.apply(e,n))}function UIe(e,r){if(r&&(uy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WIe(e)}function WIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xH=function(){return!!e})()}function DS(e){return DS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},DS(e)}function GIe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&AM(e,r)}function AM(e,r){return AM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},AM(e,r)}function Ko(e,r,n){return r=gH(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function gH(e){var r=KIe(e,"string");return uy(r)=="symbol"?r:r+""}function KIe(e,r){if(uy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(uy(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var HIe=function(r){var n=r.data,s=r.startIndex,i=r.endIndex,l=r.x,d=r.width,a=r.travellerWidth;if(!n||!n.length)return{};var f=n.length,p=h_().domain(OS(0,f)).range([l,l+d-a]),y=p.domain().map(function(v){return p(v)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:p(s),endX:p(i),scale:p,scaleValues:y}},x6=function(r){return r.changedTouches&&!!r.changedTouches.length},hy=function(e){function r(n){var s;return BIe(this,r),s=VIe(this,r,[n]),Ko(s,"handleDrag",function(i){s.leaveTimer&&(clearTimeout(s.leaveTimer),s.leaveTimer=null),s.state.isTravellerMoving?s.handleTravellerMove(i):s.state.isSlideMoving&&s.handleSlideDrag(i)}),Ko(s,"handleTouchMove",function(i){i.changedTouches!=null&&i.changedTouches.length>0&&s.handleDrag(i.changedTouches[0])}),Ko(s,"handleDragEnd",function(){s.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var i=s.props,l=i.endIndex,d=i.onDragEnd,a=i.startIndex;d==null||d({endIndex:l,startIndex:a})}),s.detachDragEndListener()}),Ko(s,"handleLeaveWrapper",function(){(s.state.isTravellerMoving||s.state.isSlideMoving)&&(s.leaveTimer=window.setTimeout(s.handleDragEnd,s.props.leaveTimeOut))}),Ko(s,"handleEnterSlideOrTraveller",function(){s.setState({isTextActive:!0})}),Ko(s,"handleLeaveSlideOrTraveller",function(){s.setState({isTextActive:!1})}),Ko(s,"handleSlideDragStart",function(i){var l=x6(i)?i.changedTouches[0]:i;s.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:l.pageX}),s.attachDragEndListener()}),s.travellerDragStartHandlers={startX:s.handleTravellerDragStart.bind(s,"startX"),endX:s.handleTravellerDragStart.bind(s,"endX")},s.state={},s}return GIe(r,e),qIe(r,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(s){var i=s.startX,l=s.endX,d=this.state.scaleValues,a=this.props,f=a.gap,p=a.data,y=p.length-1,v=Math.min(i,l),j=Math.max(i,l),w=r.getIndexInRange(d,v),k=r.getIndexInRange(d,j);return{startIndex:w-w%f,endIndex:k===y?y:k-k%f}}},{key:"getTextOfTick",value:function(s){var i=this.props,l=i.data,d=i.tickFormatter,a=i.dataKey,f=ii(l[s],a,s);return Br(d)?d(f,s):f}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(s){var i=this.state,l=i.slideMoveStartX,d=i.startX,a=i.endX,f=this.props,p=f.x,y=f.width,v=f.travellerWidth,j=f.startIndex,w=f.endIndex,k=f.onChange,S=s.pageX-l;S>0?S=Math.min(S,p+y-v-a,p+y-v-d):S<0&&(S=Math.max(S,p-d,p-a));var R=this.getIndex({startX:d+S,endX:a+S});(R.startIndex!==j||R.endIndex!==w)&&k&&k(R),this.setState({startX:d+S,endX:a+S,slideMoveStartX:s.pageX})}},{key:"handleTravellerDragStart",value:function(s,i){var l=x6(i)?i.changedTouches[0]:i;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:s,brushMoveStartX:l.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(s){var i=this.state,l=i.brushMoveStartX,d=i.movingTravellerId,a=i.endX,f=i.startX,p=this.state[d],y=this.props,v=y.x,j=y.width,w=y.travellerWidth,k=y.onChange,S=y.gap,R=y.data,D={startX:this.state.startX,endX:this.state.endX},T=s.pageX-l;T>0?T=Math.min(T,v+j-w-p):T<0&&(T=Math.max(T,v-p)),D[d]=p+T;var I=this.getIndex(D),L=I.startIndex,$=I.endIndex,W=function(){var oe=R.length-1;return d==="startX"&&(a>f?L%S===0:$%S===0)||a<f&&$===oe||d==="endX"&&(a>f?$%S===0:L%S===0)||a>f&&$===oe};this.setState(Ko(Ko({},d,p+T),"brushMoveStartX",s.pageX),function(){k&&W()&&k(I)})}},{key:"handleTravellerMoveKeyboard",value:function(s,i){var l=this,d=this.state,a=d.scaleValues,f=d.startX,p=d.endX,y=this.state[i],v=a.indexOf(y);if(v!==-1){var j=v+s;if(!(j===-1||j>=a.length)){var w=a[j];i==="startX"&&w>=p||i==="endX"&&w<=f||this.setState(Ko({},i,w),function(){l.props.onChange(l.getIndex({startX:l.state.startX,endX:l.state.endX}))})}}}},{key:"renderBackground",value:function(){var s=this.props,i=s.x,l=s.y,d=s.width,a=s.height,f=s.fill,p=s.stroke;return me.createElement("rect",{stroke:p,fill:f,x:i,y:l,width:d,height:a})}},{key:"renderPanorama",value:function(){var s=this.props,i=s.x,l=s.y,d=s.width,a=s.height,f=s.data,p=s.children,y=s.padding,v=O.Children.only(p);return v?me.cloneElement(v,{x:i,y:l,width:d,height:a,margin:y,compact:!0,data:f}):null}},{key:"renderTravellerLayer",value:function(s,i){var l,d,a=this,f=this.props,p=f.y,y=f.travellerWidth,v=f.height,j=f.traveller,w=f.ariaLabel,k=f.data,S=f.startIndex,R=f.endIndex,D=Math.max(s,this.props.x),T=_k(_k({},Cr(this.props,!1)),{},{x:D,y:p,width:y,height:v}),I=w||"Min value: ".concat((l=k[S])===null||l===void 0?void 0:l.name,", Max value: ").concat((d=k[R])===null||d===void 0?void 0:d.name);return me.createElement(gn,{tabIndex:0,role:"slider","aria-label":I,"aria-valuenow":s,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[i],onTouchStart:this.travellerDragStartHandlers[i],onKeyDown:function($){["ArrowLeft","ArrowRight"].includes($.key)&&($.preventDefault(),$.stopPropagation(),a.handleTravellerMoveKeyboard($.key==="ArrowRight"?1:-1,i))},onFocus:function(){a.setState({isTravellerFocused:!0})},onBlur:function(){a.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},r.renderTraveller(j,T))}},{key:"renderSlide",value:function(s,i){var l=this.props,d=l.y,a=l.height,f=l.stroke,p=l.travellerWidth,y=Math.min(s,i)+p,v=Math.max(Math.abs(i-s)-p,0);return me.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:f,fillOpacity:.2,x:y,y:d,width:v,height:a})}},{key:"renderText",value:function(){var s=this.props,i=s.startIndex,l=s.endIndex,d=s.y,a=s.height,f=s.travellerWidth,p=s.stroke,y=this.state,v=y.startX,j=y.endX,w=5,k={pointerEvents:"none",fill:p};return me.createElement(gn,{className:"recharts-brush-texts"},me.createElement(op,IS({textAnchor:"end",verticalAnchor:"middle",x:Math.min(v,j)-w,y:d+a/2},k),this.getTextOfTick(i)),me.createElement(op,IS({textAnchor:"start",verticalAnchor:"middle",x:Math.max(v,j)+f+w,y:d+a/2},k),this.getTextOfTick(l)))}},{key:"render",value:function(){var s=this.props,i=s.data,l=s.className,d=s.children,a=s.x,f=s.y,p=s.width,y=s.height,v=s.alwaysShowText,j=this.state,w=j.startX,k=j.endX,S=j.isTextActive,R=j.isSlideMoving,D=j.isTravellerMoving,T=j.isTravellerFocused;if(!i||!i.length||!Xt(a)||!Xt(f)||!Xt(p)||!Xt(y)||p<=0||y<=0)return null;var I=Yr("recharts-brush",l),L=me.Children.count(d)===1,$=$Ie("userSelect","none");return me.createElement(gn,{className:I,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:$},this.renderBackground(),L&&this.renderPanorama(),this.renderSlide(w,k),this.renderTravellerLayer(w,"startX"),this.renderTravellerLayer(k,"endX"),(S||R||D||T||v)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(s){var i=s.x,l=s.y,d=s.width,a=s.height,f=s.stroke,p=Math.floor(l+a/2)-1;return me.createElement(me.Fragment,null,me.createElement("rect",{x:i,y:l,width:d,height:a,fill:f,stroke:"none"}),me.createElement("line",{x1:i+1,y1:p,x2:i+d-1,y2:p,fill:"none",stroke:"#fff"}),me.createElement("line",{x1:i+1,y1:p+2,x2:i+d-1,y2:p+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(s,i){var l;return me.isValidElement(s)?l=me.cloneElement(s,i):Br(s)?l=s(i):l=r.renderDefaultTraveller(i),l}},{key:"getDerivedStateFromProps",value:function(s,i){var l=s.data,d=s.width,a=s.x,f=s.travellerWidth,p=s.updateId,y=s.startIndex,v=s.endIndex;if(l!==i.prevData||p!==i.prevUpdateId)return _k({prevData:l,prevTravellerWidth:f,prevUpdateId:p,prevX:a,prevWidth:d},l&&l.length?HIe({data:l,width:d,x:a,travellerWidth:f,startIndex:y,endIndex:v}):{scale:null,scaleValues:null});if(i.scale&&(d!==i.prevWidth||a!==i.prevX||f!==i.prevTravellerWidth)){i.scale.range([a,a+d-f]);var j=i.scale.domain().map(function(w){return i.scale(w)});return{prevData:l,prevTravellerWidth:f,prevUpdateId:p,prevX:a,prevWidth:d,startX:i.scale(s.startIndex),endX:i.scale(s.endIndex),scaleValues:j}}return null}},{key:"getIndexInRange",value:function(s,i){for(var l=s.length,d=0,a=l-1;a-d>1;){var f=Math.floor((d+a)/2);s[f]>i?a=f:d=f}return i>=s[a]?a:d}}])}(O.PureComponent);Ko(hy,"displayName","Brush");Ko(hy,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var ZIe=u4;function YIe(e,r){var n;return ZIe(e,function(s,i,l){return n=r(s,i,l),!n}),!!n}var XIe=YIe,QIe=Q7,JIe=_d,e4e=XIe,t4e=Ro,r4e=pP;function n4e(e,r,n){var s=t4e(e)?QIe:e4e;return n&&r4e(e,r,n)&&(r=void 0),s(e,JIe(r))}var s4e=n4e;const i4e=Vn(s4e);var dd=function(r,n){var s=r.alwaysShow,i=r.ifOverflow;return s&&(i="extendDomain"),i===n},g6=_G;function a4e(e,r,n){r=="__proto__"&&g6?g6(e,r,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[r]=n}var o4e=a4e,l4e=o4e,c4e=yG,d4e=_d;function u4e(e,r){var n={};return r=d4e(r),c4e(e,function(s,i,l){l4e(n,i,r(s,i,l))}),n}var h4e=u4e;const m4e=Vn(h4e);function f4e(e,r){for(var n=-1,s=e==null?0:e.length;++n<s;)if(!r(e[n],n,e))return!1;return!0}var p4e=f4e,x4e=u4;function g4e(e,r){var n=!0;return x4e(e,function(s,i,l){return n=!!r(s,i,l),n}),n}var y4e=g4e,v4e=p4e,_4e=y4e,b4e=_d,j4e=Ro,w4e=pP;function N4e(e,r,n){var s=j4e(e)?v4e:_4e;return n&&w4e(e,r,n)&&(r=void 0),s(e,b4e(r))}var S4e=N4e;const yH=Vn(S4e);var P4e=["x","y"];function kb(e){"@babel/helpers - typeof";return kb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},kb(e)}function kM(){return kM=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},kM.apply(this,arguments)}function y6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function V0(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?y6(Object(n),!0).forEach(function(s){C4e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function C4e(e,r,n){return r=A4e(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function A4e(e){var r=k4e(e,"string");return kb(r)=="symbol"?r:r+""}function k4e(e,r){if(kb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(kb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function T4e(e,r){if(e==null)return{};var n=E4e(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function E4e(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}function M4e(e,r){var n=e.x,s=e.y,i=T4e(e,P4e),l="".concat(n),d=parseInt(l,10),a="".concat(s),f=parseInt(a,10),p="".concat(r.height||i.height),y=parseInt(p,10),v="".concat(r.width||i.width),j=parseInt(v,10);return V0(V0(V0(V0(V0({},r),i),d?{x:d}:{}),f?{y:f}:{}),{},{height:y,width:j,name:r.name,radius:r.radius})}function v6(e){return me.createElement(cH,kM({shapeType:"rectangle",propTransformer:M4e,activeClassName:"recharts-active-bar"},e))}var O4e=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(s,i){if(typeof r=="number")return r;var l=typeof s=="number";return l?r(s,i):(l||cp(),n)}},I4e=["value","background"],vH;function my(e){"@babel/helpers - typeof";return my=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},my(e)}function D4e(e,r){if(e==null)return{};var n=R4e(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function R4e(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}function RS(){return RS=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},RS.apply(this,arguments)}function _6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Ri(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?_6(Object(n),!0).forEach(function(s){Wh(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function L4e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function b6(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,bH(s.key),s)}}function F4e(e,r,n){return r&&b6(e.prototype,r),n&&b6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function z4e(e,r,n){return r=LS(r),$4e(e,_H()?Reflect.construct(r,n||[],LS(e).constructor):r.apply(e,n))}function $4e(e,r){if(r&&(my(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return B4e(e)}function B4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _H(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_H=function(){return!!e})()}function LS(e){return LS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},LS(e)}function q4e(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&TM(e,r)}function TM(e,r){return TM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},TM(e,r)}function Wh(e,r,n){return r=bH(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function bH(e){var r=V4e(e,"string");return my(r)=="symbol"?r:r+""}function V4e(e,r){if(my(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(my(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ha=function(e){function r(){var n;L4e(this,r);for(var s=arguments.length,i=new Array(s),l=0;l<s;l++)i[l]=arguments[l];return n=z4e(this,r,[].concat(i)),Wh(n,"state",{isAnimationFinished:!1}),Wh(n,"id",gp("recharts-bar-")),Wh(n,"handleAnimationEnd",function(){var d=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),d&&d()}),Wh(n,"handleAnimationStart",function(){var d=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),d&&d()}),n}return q4e(r,e),F4e(r,[{key:"renderRectanglesStatically",value:function(s){var i=this,l=this.props,d=l.shape,a=l.dataKey,f=l.activeIndex,p=l.activeBar,y=Cr(this.props,!1);return s&&s.map(function(v,j){var w=j===f,k=w?p:d,S=Ri(Ri(Ri({},y),v),{},{isActive:w,option:k,index:j,dataKey:a,onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd});return me.createElement(gn,RS({className:"recharts-bar-rectangle"},ap(i.props,v,j),{key:"rectangle-".concat(v==null?void 0:v.x,"-").concat(v==null?void 0:v.y,"-").concat(v==null?void 0:v.value)}),me.createElement(v6,S))})}},{key:"renderRectanglesWithAnimation",value:function(){var s=this,i=this.props,l=i.data,d=i.layout,a=i.isAnimationActive,f=i.animationBegin,p=i.animationDuration,y=i.animationEasing,v=i.animationId,j=this.state.prevData;return me.createElement(Fl,{begin:f,duration:p,isActive:a,easing:y,from:{t:0},to:{t:1},key:"bar-".concat(v),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(w){var k=w.t,S=l.map(function(R,D){var T=j&&j[D];if(T){var I=si(T.x,R.x),L=si(T.y,R.y),$=si(T.width,R.width),W=si(T.height,R.height);return Ri(Ri({},R),{},{x:I(k),y:L(k),width:$(k),height:W(k)})}if(d==="horizontal"){var Z=si(0,R.height),oe=Z(k);return Ri(Ri({},R),{},{y:R.y+R.height-oe,height:oe})}var te=si(0,R.width),be=te(k);return Ri(Ri({},R),{},{width:be})});return me.createElement(gn,null,s.renderRectanglesStatically(S))})}},{key:"renderRectangles",value:function(){var s=this.props,i=s.data,l=s.isAnimationActive,d=this.state.prevData;return l&&i&&i.length&&(!d||!xm(d,i))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(i)}},{key:"renderBackground",value:function(){var s=this,i=this.props,l=i.data,d=i.dataKey,a=i.activeIndex,f=Cr(this.props.background,!1);return l.map(function(p,y){p.value;var v=p.background,j=D4e(p,I4e);if(!v)return null;var w=Ri(Ri(Ri(Ri(Ri({},j),{},{fill:"#eee"},v),f),ap(s.props,p,y)),{},{onAnimationStart:s.handleAnimationStart,onAnimationEnd:s.handleAnimationEnd,dataKey:d,index:y,className:"recharts-bar-background-rectangle"});return me.createElement(v6,RS({key:"background-bar-".concat(y),option:s.props.background,isActive:y===a},w))})}},{key:"renderErrorBar",value:function(s,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var l=this.props,d=l.data,a=l.xAxis,f=l.yAxis,p=l.layout,y=l.children,v=il(y,ij);if(!v)return null;var j=p==="vertical"?d[0].height/2:d[0].width/2,w=function(R,D){var T=Array.isArray(R.value)?R.value[1]:R.value;return{x:R.x,y:R.y,value:T,errorVal:ii(R,D)}},k={clipPath:s?"url(#clipPath-".concat(i,")"):null};return me.createElement(gn,k,v.map(function(S){return me.cloneElement(S,{key:"error-bar-".concat(i,"-").concat(S.props.dataKey),data:d,xAxis:a,yAxis:f,layout:p,offset:j,dataPointFormatter:w})}))}},{key:"render",value:function(){var s=this.props,i=s.hide,l=s.data,d=s.className,a=s.xAxis,f=s.yAxis,p=s.left,y=s.top,v=s.width,j=s.height,w=s.isAnimationActive,k=s.background,S=s.id;if(i||!l||!l.length)return null;var R=this.state.isAnimationFinished,D=Yr("recharts-bar",d),T=a&&a.allowDataOverflow,I=f&&f.allowDataOverflow,L=T||I,$=Zr(S)?this.id:S;return me.createElement(gn,{className:D},T||I?me.createElement("defs",null,me.createElement("clipPath",{id:"clipPath-".concat($)},me.createElement("rect",{x:T?p:p-v/2,y:I?y:y-j/2,width:T?v:v*2,height:I?j:j*2}))):null,me.createElement(gn,{className:"recharts-bar-rectangles",clipPath:L?"url(#clipPath-".concat($,")"):null},k?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(L,$),(!w||R)&&Cc.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(s,i){return s.animationId!==i.prevAnimationId?{prevAnimationId:s.animationId,curData:s.data,prevData:i.curData}:s.data!==i.curData?{curData:s.data}:null}}])}(O.PureComponent);vH=Ha;Wh(Ha,"displayName","Bar");Wh(Ha,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Lu.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Wh(Ha,"getComposedData",function(e){var r=e.props,n=e.item,s=e.barPosition,i=e.bandSize,l=e.xAxis,d=e.yAxis,a=e.xAxisTicks,f=e.yAxisTicks,p=e.stackedData,y=e.dataStartIndex,v=e.displayedData,j=e.offset,w=uke(s,n);if(!w)return null;var k=r.layout,S=n.type.defaultProps,R=S!==void 0?Ri(Ri({},S),n.props):n.props,D=R.dataKey,T=R.children,I=R.minPointSize,L=k==="horizontal"?d:l,$=p?L.scale.domain():null,W=yke({numericAxis:L}),Z=il(T,tb),oe=v.map(function(te,be){var ie,ge,Ie,Oe,Xe,Ue;p?ie=hke(p[y+be],$):(ie=ii(te,D),Array.isArray(ie)||(ie=[W,ie]));var tt=O4e(I,vH.defaultProps.minPointSize)(ie[1],be);if(k==="horizontal"){var Ce,ve=[d.scale(ie[0]),d.scale(ie[1])],rt=ve[0],vt=ve[1];ge=o$({axis:l,ticks:a,bandSize:i,offset:w.offset,entry:te,index:be}),Ie=(Ce=vt??rt)!==null&&Ce!==void 0?Ce:void 0,Oe=w.size;var gt=rt-vt;if(Xe=Number.isNaN(gt)?0:gt,Ue={x:ge,y:d.y,width:Oe,height:d.height},Math.abs(tt)>0&&Math.abs(Xe)<Math.abs(tt)){var Et=uo(Xe||tt)*(Math.abs(tt)-Math.abs(Xe));Ie-=Et,Xe+=Et}}else{var tr=[l.scale(ie[0]),l.scale(ie[1])],Dr=tr[0],Pr=tr[1];if(ge=Dr,Ie=o$({axis:d,ticks:f,bandSize:i,offset:w.offset,entry:te,index:be}),Oe=Pr-Dr,Xe=w.size,Ue={x:l.x,y:Ie,width:l.width,height:Xe},Math.abs(tt)>0&&Math.abs(Oe)<Math.abs(tt)){var It=uo(Oe||tt)*(Math.abs(tt)-Math.abs(Oe));Oe+=It}}return Ri(Ri(Ri({},te),{},{x:ge,y:Ie,width:Oe,height:Xe,value:p?ie:ie[1],payload:te,background:Ue},Z&&Z[be]&&Z[be].props),{},{tooltipPayload:[RK(n,te)],tooltipPosition:{x:ge+Oe/2,y:Ie+Xe/2}})});return Ri({data:oe,layout:k},j)});function Tb(e){"@babel/helpers - typeof";return Tb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Tb(e)}function U4e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function j6(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,jH(s.key),s)}}function W4e(e,r,n){return r&&j6(e.prototype,r),n&&j6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function w6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function mc(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?w6(Object(n),!0).forEach(function(s){TP(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function TP(e,r,n){return r=jH(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function jH(e){var r=G4e(e,"string");return Tb(r)=="symbol"?r:r+""}function G4e(e,r){if(Tb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(Tb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var $4=function(r,n,s,i,l){var d=r.width,a=r.height,f=r.layout,p=r.children,y=Object.keys(n),v={left:s.left,leftMirror:s.left,right:d-s.right,rightMirror:d-s.right,top:s.top,topMirror:s.top,bottom:a-s.bottom,bottomMirror:a-s.bottom},j=!!Yo(p,Ha);return y.reduce(function(w,k){var S=n[k],R=S.orientation,D=S.domain,T=S.padding,I=T===void 0?{}:T,L=S.mirror,$=S.reversed,W="".concat(R).concat(L?"Mirror":""),Z,oe,te,be,ie;if(S.type==="number"&&(S.padding==="gap"||S.padding==="no-gap")){var ge=D[1]-D[0],Ie=1/0,Oe=S.categoricalDomain.sort();if(Oe.forEach(function(tr,Dr){Dr>0&&(Ie=Math.min((tr||0)-(Oe[Dr-1]||0),Ie))}),Number.isFinite(Ie)){var Xe=Ie/ge,Ue=S.layout==="vertical"?s.height:s.width;if(S.padding==="gap"&&(Z=Xe*Ue/2),S.padding==="no-gap"){var tt=ho(r.barCategoryGap,Xe*Ue),Ce=Xe*Ue/2;Z=Ce-tt-(Ce-tt)/Ue*tt}}}i==="xAxis"?oe=[s.left+(I.left||0)+(Z||0),s.left+s.width-(I.right||0)-(Z||0)]:i==="yAxis"?oe=f==="horizontal"?[s.top+s.height-(I.bottom||0),s.top+(I.top||0)]:[s.top+(I.top||0)+(Z||0),s.top+s.height-(I.bottom||0)-(Z||0)]:oe=S.range,$&&(oe=[oe[1],oe[0]]);var ve=MK(S,l,j),rt=ve.scale,vt=ve.realScaleType;rt.domain(D).range(oe),OK(rt);var gt=IK(rt,mc(mc({},S),{},{realScaleType:vt}));i==="xAxis"?(ie=R==="top"&&!L||R==="bottom"&&L,te=s.left,be=v[W]-ie*S.height):i==="yAxis"&&(ie=R==="left"&&!L||R==="right"&&L,te=v[W]-ie*S.width,be=s.top);var Et=mc(mc(mc({},S),gt),{},{realScaleType:vt,x:te,y:be,scale:rt,width:i==="xAxis"?s.width:S.width,height:i==="yAxis"?s.height:S.height});return Et.bandSize=vS(Et,gt),!S.hide&&i==="xAxis"?v[W]+=(ie?-1:1)*Et.height:S.hide||(v[W]+=(ie?-1:1)*Et.width),mc(mc({},w),{},TP({},k,Et))},{})},wH=function(r,n){var s=r.x,i=r.y,l=n.x,d=n.y;return{x:Math.min(s,l),y:Math.min(i,d),width:Math.abs(l-s),height:Math.abs(d-i)}},K4e=function(r){var n=r.x1,s=r.y1,i=r.x2,l=r.y2;return wH({x:n,y:s},{x:i,y:l})},NH=function(){function e(r){U4e(this,e),this.scale=r}return W4e(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=s.bandAware,l=s.position;if(n!==void 0){if(l)switch(l){case"start":return this.scale(n);case"middle":{var d=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+d}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(n)+a}default:return this.scale(n)}if(i){var f=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+f}return this.scale(n)}}},{key:"isInRange",value:function(n){var s=this.range(),i=s[0],l=s[s.length-1];return i<=l?n>=i&&n<=l:n>=l&&n<=i}}],[{key:"create",value:function(n){return new e(n)}}])}();TP(NH,"EPS",1e-4);var B4=function(r){var n=Object.keys(r).reduce(function(s,i){return mc(mc({},s),{},TP({},i,NH.create(r[i])))},{});return mc(mc({},n),{},{apply:function(i){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=l.bandAware,a=l.position;return m4e(i,function(f,p){return n[p].apply(f,{bandAware:d,position:a})})},isInRange:function(i){return yH(i,function(l,d){return n[d].isInRange(l)})}})};function H4e(e){return(e%180+180)%180}var Z4e=function(r){var n=r.width,s=r.height,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=H4e(i),d=l*Math.PI/180,a=Math.atan(s/n),f=d>a&&d<Math.PI-a?s/Math.sin(d):n/Math.cos(d);return Math.abs(f)},Y4e=_d,X4e=ej,Q4e=mP;function J4e(e){return function(r,n,s){var i=Object(r);if(!X4e(r)){var l=Y4e(n);r=Q4e(r),n=function(a){return l(i[a],a,i)}}var d=e(r,n,s);return d>-1?i[l?r[d]:d]:void 0}}var eDe=J4e,tDe=fH;function rDe(e){var r=tDe(e),n=r%1;return r===r?n?r-n:r:0}var nDe=rDe,sDe=hG,iDe=_d,aDe=nDe,oDe=Math.max;function lDe(e,r,n){var s=e==null?0:e.length;if(!s)return-1;var i=n==null?0:aDe(n);return i<0&&(i=oDe(s+i,0)),sDe(e,iDe(r),i)}var cDe=lDe,dDe=eDe,uDe=cDe,hDe=dDe(uDe),mDe=hDe;const fDe=Vn(mDe);var pDe=txe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),q4=O.createContext(void 0),V4=O.createContext(void 0),SH=O.createContext(void 0),PH=O.createContext({}),CH=O.createContext(void 0),AH=O.createContext(0),kH=O.createContext(0),N6=function(r){var n=r.state,s=n.xAxisMap,i=n.yAxisMap,l=n.offset,d=r.clipPathId,a=r.children,f=r.width,p=r.height,y=pDe(l);return me.createElement(q4.Provider,{value:s},me.createElement(V4.Provider,{value:i},me.createElement(PH.Provider,{value:l},me.createElement(SH.Provider,{value:y},me.createElement(CH.Provider,{value:d},me.createElement(AH.Provider,{value:p},me.createElement(kH.Provider,{value:f},a)))))))},xDe=function(){return O.useContext(CH)},TH=function(r){var n=O.useContext(q4);n==null&&cp();var s=n[r];return s==null&&cp(),s},gDe=function(){var r=O.useContext(q4);return Ah(r)},yDe=function(){var r=O.useContext(V4),n=fDe(r,function(s){return yH(s.domain,Number.isFinite)});return n||Ah(r)},EH=function(r){var n=O.useContext(V4);n==null&&cp();var s=n[r];return s==null&&cp(),s},vDe=function(){var r=O.useContext(SH);return r},_De=function(){return O.useContext(PH)},U4=function(){return O.useContext(kH)},W4=function(){return O.useContext(AH)};function fy(e){"@babel/helpers - typeof";return fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},fy(e)}function bDe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function jDe(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,OH(s.key),s)}}function wDe(e,r,n){return r&&jDe(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NDe(e,r,n){return r=FS(r),SDe(e,MH()?Reflect.construct(r,n||[],FS(e).constructor):r.apply(e,n))}function SDe(e,r){if(r&&(fy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PDe(e)}function PDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MH=function(){return!!e})()}function FS(e){return FS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},FS(e)}function CDe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&EM(e,r)}function EM(e,r){return EM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},EM(e,r)}function S6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function P6(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?S6(Object(n),!0).forEach(function(s){G4(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function G4(e,r,n){return r=OH(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function OH(e){var r=ADe(e,"string");return fy(r)=="symbol"?r:r+""}function ADe(e,r){if(fy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(fy(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function kDe(e,r){return ODe(e)||MDe(e,r)||EDe(e,r)||TDe()}function TDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EDe(e,r){if(e){if(typeof e=="string")return C6(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C6(e,r)}}function C6(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}function MDe(e,r){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,l,d,a=[],f=!0,p=!1;try{if(l=(n=n.call(e)).next,r!==0)for(;!(f=(s=l.call(n)).done)&&(a.push(s.value),a.length!==r);f=!0);}catch(y){p=!0,i=y}finally{try{if(!f&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(p)throw i}}return a}}function ODe(e){if(Array.isArray(e))return e}function MM(){return MM=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},MM.apply(this,arguments)}var IDe=function(r,n){var s;return me.isValidElement(r)?s=me.cloneElement(r,n):Br(r)?s=r(n):s=me.createElement("line",MM({},n,{className:"recharts-reference-line-line"})),s},DDe=function(r,n,s,i,l,d,a,f,p){var y=l.x,v=l.y,j=l.width,w=l.height;if(s){var k=p.y,S=r.y.apply(k,{position:d});if(dd(p,"discard")&&!r.y.isInRange(S))return null;var R=[{x:y+j,y:S},{x:y,y:S}];return f==="left"?R.reverse():R}if(n){var D=p.x,T=r.x.apply(D,{position:d});if(dd(p,"discard")&&!r.x.isInRange(T))return null;var I=[{x:T,y:v+w},{x:T,y:v}];return a==="top"?I.reverse():I}if(i){var L=p.segment,$=L.map(function(W){return r.apply(W,{position:d})});return dd(p,"discard")&&i4e($,function(W){return!r.isInRange(W)})?null:$}return null};function RDe(e){var r=e.x,n=e.y,s=e.segment,i=e.xAxisId,l=e.yAxisId,d=e.shape,a=e.className,f=e.alwaysShow,p=xDe(),y=TH(i),v=EH(l),j=vDe();if(!p||!j)return null;Pc(f===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var w=B4({x:y.scale,y:v.scale}),k=ea(r),S=ea(n),R=s&&s.length===2,D=DDe(w,k,S,R,j,e.position,y.orientation,v.orientation,e);if(!D)return null;var T=kDe(D,2),I=T[0],L=I.x,$=I.y,W=T[1],Z=W.x,oe=W.y,te=dd(e,"hidden")?"url(#".concat(p,")"):void 0,be=P6(P6({clipPath:te},Cr(e,!0)),{},{x1:L,y1:$,x2:Z,y2:oe});return me.createElement(gn,{className:Yr("recharts-reference-line",a)},IDe(d,be),ha.renderCallByParent(e,K4e({x1:L,y1:$,x2:Z,y2:oe})))}var EP=function(e){function r(){return bDe(this,r),NDe(this,r,arguments)}return CDe(r,e),wDe(r,[{key:"render",value:function(){return me.createElement(RDe,this.props)}}])}(me.Component);G4(EP,"displayName","ReferenceLine");G4(EP,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function OM(){return OM=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},OM.apply(this,arguments)}function py(e){"@babel/helpers - typeof";return py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},py(e)}function A6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function k6(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?A6(Object(n),!0).forEach(function(s){MP(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function LDe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function FDe(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,DH(s.key),s)}}function zDe(e,r,n){return r&&FDe(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $De(e,r,n){return r=zS(r),BDe(e,IH()?Reflect.construct(r,n||[],zS(e).constructor):r.apply(e,n))}function BDe(e,r){if(r&&(py(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qDe(e)}function qDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(IH=function(){return!!e})()}function zS(e){return zS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},zS(e)}function VDe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&IM(e,r)}function IM(e,r){return IM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},IM(e,r)}function MP(e,r,n){return r=DH(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function DH(e){var r=UDe(e,"string");return py(r)=="symbol"?r:r+""}function UDe(e,r){if(py(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(py(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var WDe=function(r){var n=r.x,s=r.y,i=r.xAxis,l=r.yAxis,d=B4({x:i.scale,y:l.scale}),a=d.apply({x:n,y:s},{bandAware:!0});return dd(r,"discard")&&!d.isInRange(a)?null:a},OP=function(e){function r(){return LDe(this,r),$De(this,r,arguments)}return VDe(r,e),zDe(r,[{key:"render",value:function(){var s=this.props,i=s.x,l=s.y,d=s.r,a=s.alwaysShow,f=s.clipPathId,p=ea(i),y=ea(l);if(Pc(a===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!p||!y)return null;var v=WDe(this.props);if(!v)return null;var j=v.x,w=v.y,k=this.props,S=k.shape,R=k.className,D=dd(this.props,"hidden")?"url(#".concat(f,")"):void 0,T=k6(k6({clipPath:D},Cr(this.props,!0)),{},{cx:j,cy:w});return me.createElement(gn,{className:Yr("recharts-reference-dot",R)},r.renderDot(S,T),ha.renderCallByParent(this.props,{x:j-d,y:w-d,width:2*d,height:2*d}))}}])}(me.Component);MP(OP,"displayName","ReferenceDot");MP(OP,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});MP(OP,"renderDot",function(e,r){var n;return me.isValidElement(e)?n=me.cloneElement(e,r):Br(e)?n=e(r):n=me.createElement(tv,OM({},r,{cx:r.cx,cy:r.cy,className:"recharts-reference-dot-dot"})),n});function DM(){return DM=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},DM.apply(this,arguments)}function xy(e){"@babel/helpers - typeof";return xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},xy(e)}function T6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function E6(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?T6(Object(n),!0).forEach(function(s){IP(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function GDe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function KDe(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,LH(s.key),s)}}function HDe(e,r,n){return r&&KDe(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZDe(e,r,n){return r=$S(r),YDe(e,RH()?Reflect.construct(r,n||[],$S(e).constructor):r.apply(e,n))}function YDe(e,r){if(r&&(xy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XDe(e)}function XDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(RH=function(){return!!e})()}function $S(e){return $S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},$S(e)}function QDe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&RM(e,r)}function RM(e,r){return RM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},RM(e,r)}function IP(e,r,n){return r=LH(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function LH(e){var r=JDe(e,"string");return xy(r)=="symbol"?r:r+""}function JDe(e,r){if(xy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(xy(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var eRe=function(r,n,s,i,l){var d=l.x1,a=l.x2,f=l.y1,p=l.y2,y=l.xAxis,v=l.yAxis;if(!y||!v)return null;var j=B4({x:y.scale,y:v.scale}),w={x:r?j.x.apply(d,{position:"start"}):j.x.rangeMin,y:s?j.y.apply(f,{position:"start"}):j.y.rangeMin},k={x:n?j.x.apply(a,{position:"end"}):j.x.rangeMax,y:i?j.y.apply(p,{position:"end"}):j.y.rangeMax};return dd(l,"discard")&&(!j.isInRange(w)||!j.isInRange(k))?null:wH(w,k)},DP=function(e){function r(){return GDe(this,r),ZDe(this,r,arguments)}return QDe(r,e),HDe(r,[{key:"render",value:function(){var s=this.props,i=s.x1,l=s.x2,d=s.y1,a=s.y2,f=s.className,p=s.alwaysShow,y=s.clipPathId;Pc(p===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var v=ea(i),j=ea(l),w=ea(d),k=ea(a),S=this.props.shape;if(!v&&!j&&!w&&!k&&!S)return null;var R=eRe(v,j,w,k,this.props);if(!R&&!S)return null;var D=dd(this.props,"hidden")?"url(#".concat(y,")"):void 0;return me.createElement(gn,{className:Yr("recharts-reference-area",f)},r.renderRect(S,E6(E6({clipPath:D},Cr(this.props,!0)),R)),ha.renderCallByParent(this.props,R))}}])}(me.Component);IP(DP,"displayName","ReferenceArea");IP(DP,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});IP(DP,"renderRect",function(e,r){var n;return me.isValidElement(e)?n=me.cloneElement(e,r):Br(e)?n=e(r):n=me.createElement(z4,DM({},r,{className:"recharts-reference-area-rect"})),n});function FH(e,r,n){if(r<1)return[];if(r===1&&n===void 0)return e;for(var s=[],i=0;i<e.length;i+=r)s.push(e[i]);return s}function tRe(e,r,n){var s={width:e.width+r.width,height:e.height+r.height};return Z4e(s,n)}function rRe(e,r,n){var s=n==="width",i=e.x,l=e.y,d=e.width,a=e.height;return r===1?{start:s?i:l,end:s?i+d:l+a}:{start:s?i+d:l+a,end:s?i:l}}function BS(e,r,n,s,i){if(e*r<e*s||e*r>e*i)return!1;var l=n();return e*(r-e*l/2-s)>=0&&e*(r+e*l/2-i)<=0}function nRe(e,r){return FH(e,r+1)}function sRe(e,r,n,s,i){for(var l=(s||[]).slice(),d=r.start,a=r.end,f=0,p=1,y=d,v=function(){var k=s==null?void 0:s[f];if(k===void 0)return{v:FH(s,p)};var S=f,R,D=function(){return R===void 0&&(R=n(k,S)),R},T=k.coordinate,I=f===0||BS(e,T,D,y,a);I||(f=0,y=d,p+=1),I&&(y=T+e*(D()/2+i),f+=p)},j;p<=l.length;)if(j=v(),j)return j.v;return[]}function Eb(e){"@babel/helpers - typeof";return Eb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Eb(e)}function M6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Ua(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?M6(Object(n),!0).forEach(function(s){iRe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function iRe(e,r,n){return r=aRe(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function aRe(e){var r=oRe(e,"string");return Eb(r)=="symbol"?r:r+""}function oRe(e,r){if(Eb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(Eb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function lRe(e,r,n,s,i){for(var l=(s||[]).slice(),d=l.length,a=r.start,f=r.end,p=function(j){var w=l[j],k,S=function(){return k===void 0&&(k=n(w,j)),k};if(j===d-1){var R=e*(w.coordinate+e*S()/2-f);l[j]=w=Ua(Ua({},w),{},{tickCoord:R>0?w.coordinate-R*e:w.coordinate})}else l[j]=w=Ua(Ua({},w),{},{tickCoord:w.coordinate});var D=BS(e,w.tickCoord,S,a,f);D&&(f=w.tickCoord-e*(S()/2+i),l[j]=Ua(Ua({},w),{},{isShow:!0}))},y=d-1;y>=0;y--)p(y);return l}function cRe(e,r,n,s,i,l){var d=(s||[]).slice(),a=d.length,f=r.start,p=r.end;if(l){var y=s[a-1],v=n(y,a-1),j=e*(y.coordinate+e*v/2-p);d[a-1]=y=Ua(Ua({},y),{},{tickCoord:j>0?y.coordinate-j*e:y.coordinate});var w=BS(e,y.tickCoord,function(){return v},f,p);w&&(p=y.tickCoord-e*(v/2+i),d[a-1]=Ua(Ua({},y),{},{isShow:!0}))}for(var k=l?a-1:a,S=function(T){var I=d[T],L,$=function(){return L===void 0&&(L=n(I,T)),L};if(T===0){var W=e*(I.coordinate-e*$()/2-f);d[T]=I=Ua(Ua({},I),{},{tickCoord:W<0?I.coordinate-W*e:I.coordinate})}else d[T]=I=Ua(Ua({},I),{},{tickCoord:I.coordinate});var Z=BS(e,I.tickCoord,$,f,p);Z&&(f=I.tickCoord+e*($()/2+i),d[T]=Ua(Ua({},I),{},{isShow:!0}))},R=0;R<k;R++)S(R);return d}function K4(e,r,n){var s=e.tick,i=e.ticks,l=e.viewBox,d=e.minTickGap,a=e.orientation,f=e.interval,p=e.tickFormatter,y=e.unit,v=e.angle;if(!i||!i.length||!s)return[];if(Xt(f)||Lu.isSsr)return nRe(i,typeof f=="number"&&Xt(f)?f:0);var j=[],w=a==="top"||a==="bottom"?"width":"height",k=y&&w==="width"?u_(y,{fontSize:r,letterSpacing:n}):{width:0,height:0},S=function(I,L){var $=Br(p)?p(I.value,L):I.value;return w==="width"?tRe(u_($,{fontSize:r,letterSpacing:n}),k,v):u_($,{fontSize:r,letterSpacing:n})[w]},R=i.length>=2?uo(i[1].coordinate-i[0].coordinate):1,D=rRe(l,R,w);return f==="equidistantPreserveStart"?sRe(R,D,S,i,d):(f==="preserveStart"||f==="preserveStartEnd"?j=cRe(R,D,S,i,d,f==="preserveStartEnd"):j=lRe(R,D,S,i,d),j.filter(function(T){return T.isShow}))}var dRe=["viewBox"],uRe=["viewBox"],hRe=["ticks"];function gy(e){"@babel/helpers - typeof";return gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},gy(e)}function rg(){return rg=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},rg.apply(this,arguments)}function O6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function no(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?O6(Object(n),!0).forEach(function(s){H4(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function bk(e,r){if(e==null)return{};var n=mRe(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function mRe(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}function fRe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function I6(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,$H(s.key),s)}}function pRe(e,r,n){return r&&I6(e.prototype,r),n&&I6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function xRe(e,r,n){return r=qS(r),gRe(e,zH()?Reflect.construct(r,n||[],qS(e).constructor):r.apply(e,n))}function gRe(e,r){if(r&&(gy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yRe(e)}function yRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zH=function(){return!!e})()}function qS(e){return qS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},qS(e)}function vRe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&LM(e,r)}function LM(e,r){return LM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},LM(e,r)}function H4(e,r,n){return r=$H(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function $H(e){var r=_Re(e,"string");return gy(r)=="symbol"?r:r+""}function _Re(e,r){if(gy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(gy(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var sv=function(e){function r(n){var s;return fRe(this,r),s=xRe(this,r,[n]),s.state={fontSize:"",letterSpacing:""},s}return vRe(r,e),pRe(r,[{key:"shouldComponentUpdate",value:function(s,i){var l=s.viewBox,d=bk(s,dRe),a=this.props,f=a.viewBox,p=bk(a,uRe);return!gg(l,f)||!gg(d,p)||!gg(i,this.state)}},{key:"componentDidMount",value:function(){var s=this.layerReference;if(s){var i=s.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];i&&this.setState({fontSize:window.getComputedStyle(i).fontSize,letterSpacing:window.getComputedStyle(i).letterSpacing})}}},{key:"getTickLineCoord",value:function(s){var i=this.props,l=i.x,d=i.y,a=i.width,f=i.height,p=i.orientation,y=i.tickSize,v=i.mirror,j=i.tickMargin,w,k,S,R,D,T,I=v?-1:1,L=s.tickSize||y,$=Xt(s.tickCoord)?s.tickCoord:s.coordinate;switch(p){case"top":w=k=s.coordinate,R=d+ +!v*f,S=R-I*L,T=S-I*j,D=$;break;case"left":S=R=s.coordinate,k=l+ +!v*a,w=k-I*L,D=w-I*j,T=$;break;case"right":S=R=s.coordinate,k=l+ +v*a,w=k+I*L,D=w+I*j,T=$;break;default:w=k=s.coordinate,R=d+ +v*f,S=R+I*L,T=S+I*j,D=$;break}return{line:{x1:w,y1:S,x2:k,y2:R},tick:{x:D,y:T}}}},{key:"getTickTextAnchor",value:function(){var s=this.props,i=s.orientation,l=s.mirror,d;switch(i){case"left":d=l?"start":"end";break;case"right":d=l?"end":"start";break;default:d="middle";break}return d}},{key:"getTickVerticalAnchor",value:function(){var s=this.props,i=s.orientation,l=s.mirror,d="end";switch(i){case"left":case"right":d="middle";break;case"top":d=l?"start":"end";break;default:d=l?"end":"start";break}return d}},{key:"renderAxisLine",value:function(){var s=this.props,i=s.x,l=s.y,d=s.width,a=s.height,f=s.orientation,p=s.mirror,y=s.axisLine,v=no(no(no({},Cr(this.props,!1)),Cr(y,!1)),{},{fill:"none"});if(f==="top"||f==="bottom"){var j=+(f==="top"&&!p||f==="bottom"&&p);v=no(no({},v),{},{x1:i,y1:l+j*a,x2:i+d,y2:l+j*a})}else{var w=+(f==="left"&&!p||f==="right"&&p);v=no(no({},v),{},{x1:i+w*d,y1:l,x2:i+w*d,y2:l+a})}return me.createElement("line",rg({},v,{className:Yr("recharts-cartesian-axis-line",sl(y,"className"))}))}},{key:"renderTicks",value:function(s,i,l){var d=this,a=this.props,f=a.tickLine,p=a.stroke,y=a.tick,v=a.tickFormatter,j=a.unit,w=K4(no(no({},this.props),{},{ticks:s}),i,l),k=this.getTickTextAnchor(),S=this.getTickVerticalAnchor(),R=Cr(this.props,!1),D=Cr(y,!1),T=no(no({},R),{},{fill:"none"},Cr(f,!1)),I=w.map(function(L,$){var W=d.getTickLineCoord(L),Z=W.line,oe=W.tick,te=no(no(no(no({textAnchor:k,verticalAnchor:S},R),{},{stroke:"none",fill:p},D),oe),{},{index:$,payload:L,visibleTicksCount:w.length,tickFormatter:v});return me.createElement(gn,rg({className:"recharts-cartesian-axis-tick",key:"tick-".concat(L.value,"-").concat(L.coordinate,"-").concat(L.tickCoord)},ap(d.props,L,$)),f&&me.createElement("line",rg({},T,Z,{className:Yr("recharts-cartesian-axis-tick-line",sl(f,"className"))})),y&&r.renderTickItem(y,te,"".concat(Br(v)?v(L.value,$):L.value).concat(j||"")))});return me.createElement("g",{className:"recharts-cartesian-axis-ticks"},I)}},{key:"render",value:function(){var s=this,i=this.props,l=i.axisLine,d=i.width,a=i.height,f=i.ticksGenerator,p=i.className,y=i.hide;if(y)return null;var v=this.props,j=v.ticks,w=bk(v,hRe),k=j;return Br(f)&&(k=j&&j.length>0?f(this.props):f(w)),d<=0||a<=0||!k||!k.length?null:me.createElement(gn,{className:Yr("recharts-cartesian-axis",p),ref:function(R){s.layerReference=R}},l&&this.renderAxisLine(),this.renderTicks(k,this.state.fontSize,this.state.letterSpacing),ha.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(s,i,l){var d;return me.isValidElement(s)?d=me.cloneElement(s,i):Br(s)?d=s(i):d=me.createElement(op,rg({},i,{className:"recharts-cartesian-axis-tick-value"}),l),d}}])}(O.Component);H4(sv,"displayName","CartesianAxis");H4(sv,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var bRe=["x1","y1","x2","y2","key"],jRe=["offset"];function dp(e){"@babel/helpers - typeof";return dp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},dp(e)}function D6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Ga(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?D6(Object(n),!0).forEach(function(s){wRe(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function wRe(e,r,n){return r=NRe(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function NRe(e){var r=SRe(e,"string");return dp(r)=="symbol"?r:r+""}function SRe(e,r){if(dp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(dp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Ef(){return Ef=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Ef.apply(this,arguments)}function R6(e,r){if(e==null)return{};var n=PRe(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function PRe(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}var CRe=function(r){var n=r.fill;if(!n||n==="none")return null;var s=r.fillOpacity,i=r.x,l=r.y,d=r.width,a=r.height,f=r.ry;return me.createElement("rect",{x:i,y:l,ry:f,width:d,height:a,stroke:"none",fill:n,fillOpacity:s,className:"recharts-cartesian-grid-bg"})};function BH(e,r){var n;if(me.isValidElement(e))n=me.cloneElement(e,r);else if(Br(e))n=e(r);else{var s=r.x1,i=r.y1,l=r.x2,d=r.y2,a=r.key,f=R6(r,bRe),p=Cr(f,!1);p.offset;var y=R6(p,jRe);n=me.createElement("line",Ef({},y,{x1:s,y1:i,x2:l,y2:d,fill:"none",key:a}))}return n}function ARe(e){var r=e.x,n=e.width,s=e.horizontal,i=s===void 0?!0:s,l=e.horizontalPoints;if(!i||!l||!l.length)return null;var d=l.map(function(a,f){var p=Ga(Ga({},e),{},{x1:r,y1:a,x2:r+n,y2:a,key:"line-".concat(f),index:f});return BH(i,p)});return me.createElement("g",{className:"recharts-cartesian-grid-horizontal"},d)}function kRe(e){var r=e.y,n=e.height,s=e.vertical,i=s===void 0?!0:s,l=e.verticalPoints;if(!i||!l||!l.length)return null;var d=l.map(function(a,f){var p=Ga(Ga({},e),{},{x1:a,y1:r,x2:a,y2:r+n,key:"line-".concat(f),index:f});return BH(i,p)});return me.createElement("g",{className:"recharts-cartesian-grid-vertical"},d)}function TRe(e){var r=e.horizontalFill,n=e.fillOpacity,s=e.x,i=e.y,l=e.width,d=e.height,a=e.horizontalPoints,f=e.horizontal,p=f===void 0?!0:f;if(!p||!r||!r.length)return null;var y=a.map(function(j){return Math.round(j+i-i)}).sort(function(j,w){return j-w});i!==y[0]&&y.unshift(0);var v=y.map(function(j,w){var k=!y[w+1],S=k?i+d-j:y[w+1]-j;if(S<=0)return null;var R=w%r.length;return me.createElement("rect",{key:"react-".concat(w),y:j,x:s,height:S,width:l,stroke:"none",fill:r[R],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return me.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},v)}function ERe(e){var r=e.vertical,n=r===void 0?!0:r,s=e.verticalFill,i=e.fillOpacity,l=e.x,d=e.y,a=e.width,f=e.height,p=e.verticalPoints;if(!n||!s||!s.length)return null;var y=p.map(function(j){return Math.round(j+l-l)}).sort(function(j,w){return j-w});l!==y[0]&&y.unshift(0);var v=y.map(function(j,w){var k=!y[w+1],S=k?l+a-j:y[w+1]-j;if(S<=0)return null;var R=w%s.length;return me.createElement("rect",{key:"react-".concat(w),x:j,y:d,width:S,height:f,stroke:"none",fill:s[R],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return me.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},v)}var MRe=function(r,n){var s=r.xAxis,i=r.width,l=r.height,d=r.offset;return EK(K4(Ga(Ga(Ga({},sv.defaultProps),s),{},{ticks:lu(s,!0),viewBox:{x:0,y:0,width:i,height:l}})),d.left,d.left+d.width,n)},ORe=function(r,n){var s=r.yAxis,i=r.width,l=r.height,d=r.offset;return EK(K4(Ga(Ga(Ga({},sv.defaultProps),s),{},{ticks:lu(s,!0),viewBox:{x:0,y:0,width:i,height:l}})),d.top,d.top+d.height,n)},Dx={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Io(e){var r,n,s,i,l,d,a=U4(),f=W4(),p=_De(),y=Ga(Ga({},e),{},{stroke:(r=e.stroke)!==null&&r!==void 0?r:Dx.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:Dx.fill,horizontal:(s=e.horizontal)!==null&&s!==void 0?s:Dx.horizontal,horizontalFill:(i=e.horizontalFill)!==null&&i!==void 0?i:Dx.horizontalFill,vertical:(l=e.vertical)!==null&&l!==void 0?l:Dx.vertical,verticalFill:(d=e.verticalFill)!==null&&d!==void 0?d:Dx.verticalFill,x:Xt(e.x)?e.x:p.left,y:Xt(e.y)?e.y:p.top,width:Xt(e.width)?e.width:p.width,height:Xt(e.height)?e.height:p.height}),v=y.x,j=y.y,w=y.width,k=y.height,S=y.syncWithTicks,R=y.horizontalValues,D=y.verticalValues,T=gDe(),I=yDe();if(!Xt(w)||w<=0||!Xt(k)||k<=0||!Xt(v)||v!==+v||!Xt(j)||j!==+j)return null;var L=y.verticalCoordinatesGenerator||MRe,$=y.horizontalCoordinatesGenerator||ORe,W=y.horizontalPoints,Z=y.verticalPoints;if((!W||!W.length)&&Br($)){var oe=R&&R.length,te=$({yAxis:I?Ga(Ga({},I),{},{ticks:oe?R:I.ticks}):void 0,width:a,height:f,offset:p},oe?!0:S);Pc(Array.isArray(te),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(dp(te),"]")),Array.isArray(te)&&(W=te)}if((!Z||!Z.length)&&Br(L)){var be=D&&D.length,ie=L({xAxis:T?Ga(Ga({},T),{},{ticks:be?D:T.ticks}):void 0,width:a,height:f,offset:p},be?!0:S);Pc(Array.isArray(ie),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(dp(ie),"]")),Array.isArray(ie)&&(Z=ie)}return me.createElement("g",{className:"recharts-cartesian-grid"},me.createElement(CRe,{fill:y.fill,fillOpacity:y.fillOpacity,x:y.x,y:y.y,width:y.width,height:y.height,ry:y.ry}),me.createElement(ARe,Ef({},y,{offset:p,horizontalPoints:W,xAxis:T,yAxis:I})),me.createElement(kRe,Ef({},y,{offset:p,verticalPoints:Z,xAxis:T,yAxis:I})),me.createElement(TRe,Ef({},y,{horizontalPoints:W})),me.createElement(ERe,Ef({},y,{verticalPoints:Z})))}Io.displayName="CartesianGrid";var IRe=["type","layout","connectNulls","ref"],DRe=["key"];function yy(e){"@babel/helpers - typeof";return yy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},yy(e)}function L6(e,r){if(e==null)return{};var n=RRe(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function RRe(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}function g_(){return g_=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},g_.apply(this,arguments)}function F6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Go(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?F6(Object(n),!0).forEach(function(s){fc(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Rx(e){return $Re(e)||zRe(e)||FRe(e)||LRe()}function LRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FRe(e,r){if(e){if(typeof e=="string")return FM(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return FM(e,r)}}function zRe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $Re(e){if(Array.isArray(e))return FM(e)}function FM(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}function BRe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function z6(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,VH(s.key),s)}}function qRe(e,r,n){return r&&z6(e.prototype,r),n&&z6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function VRe(e,r,n){return r=VS(r),URe(e,qH()?Reflect.construct(r,n||[],VS(e).constructor):r.apply(e,n))}function URe(e,r){if(r&&(yy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WRe(e)}function WRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qH=function(){return!!e})()}function VS(e){return VS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},VS(e)}function GRe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&zM(e,r)}function zM(e,r){return zM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},zM(e,r)}function fc(e,r,n){return r=VH(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function VH(e){var r=KRe(e,"string");return yy(r)=="symbol"?r:r+""}function KRe(e,r){if(yy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(yy(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var al=function(e){function r(){var n;BRe(this,r);for(var s=arguments.length,i=new Array(s),l=0;l<s;l++)i[l]=arguments[l];return n=VRe(this,r,[].concat(i)),fc(n,"state",{isAnimationFinished:!0,totalLength:0}),fc(n,"generateSimpleStrokeDasharray",function(d,a){return"".concat(a,"px ").concat(d-a,"px")}),fc(n,"getStrokeDasharray",function(d,a,f){var p=f.reduce(function(D,T){return D+T});if(!p)return n.generateSimpleStrokeDasharray(a,d);for(var y=Math.floor(d/p),v=d%p,j=a-d,w=[],k=0,S=0;k<f.length;S+=f[k],++k)if(S+f[k]>v){w=[].concat(Rx(f.slice(0,k)),[v-S]);break}var R=w.length%2===0?[0,j]:[j];return[].concat(Rx(r.repeat(f,y)),Rx(w),R).map(function(D){return"".concat(D,"px")}).join(", ")}),fc(n,"id",gp("recharts-line-")),fc(n,"pathRef",function(d){n.mainCurve=d}),fc(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),fc(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return GRe(r,e),qRe(r,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var s=this.getTotalLength();this.setState({totalLength:s})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var s=this.getTotalLength();s!==this.state.totalLength&&this.setState({totalLength:s})}}},{key:"getTotalLength",value:function(){var s=this.mainCurve;try{return s&&s.getTotalLength&&s.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(s,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var l=this.props,d=l.points,a=l.xAxis,f=l.yAxis,p=l.layout,y=l.children,v=il(y,ij);if(!v)return null;var j=function(S,R){return{x:S.x,y:S.y,value:S.value,errorVal:ii(S.payload,R)}},w={clipPath:s?"url(#clipPath-".concat(i,")"):null};return me.createElement(gn,w,v.map(function(k){return me.cloneElement(k,{key:"bar-".concat(k.props.dataKey),data:d,xAxis:a,yAxis:f,layout:p,dataPointFormatter:j})}))}},{key:"renderDots",value:function(s,i,l){var d=this.props.isAnimationActive;if(d&&!this.state.isAnimationFinished)return null;var a=this.props,f=a.dot,p=a.points,y=a.dataKey,v=Cr(this.props,!1),j=Cr(f,!0),w=p.map(function(S,R){var D=Go(Go(Go({key:"dot-".concat(R),r:3},v),j),{},{value:S.value,dataKey:y,cx:S.x,cy:S.y,index:R,payload:S.payload});return r.renderDotItem(f,D)}),k={clipPath:s?"url(#clipPath-".concat(i?"":"dots-").concat(l,")"):null};return me.createElement(gn,g_({className:"recharts-line-dots",key:"dots"},k),w)}},{key:"renderCurveStatically",value:function(s,i,l,d){var a=this.props,f=a.type,p=a.layout,y=a.connectNulls;a.ref;var v=L6(a,IRe),j=Go(Go(Go({},Cr(v,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(l,")"):null,points:s},d),{},{type:f,layout:p,connectNulls:y});return me.createElement(Uf,g_({},j,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(s,i){var l=this,d=this.props,a=d.points,f=d.strokeDasharray,p=d.isAnimationActive,y=d.animationBegin,v=d.animationDuration,j=d.animationEasing,w=d.animationId,k=d.animateNewValues,S=d.width,R=d.height,D=this.state,T=D.prevPoints,I=D.totalLength;return me.createElement(Fl,{begin:y,duration:v,isActive:p,easing:j,from:{t:0},to:{t:1},key:"line-".concat(w),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(L){var $=L.t;if(T){var W=T.length/a.length,Z=a.map(function(ge,Ie){var Oe=Math.floor(Ie*W);if(T[Oe]){var Xe=T[Oe],Ue=si(Xe.x,ge.x),tt=si(Xe.y,ge.y);return Go(Go({},ge),{},{x:Ue($),y:tt($)})}if(k){var Ce=si(S*2,ge.x),ve=si(R/2,ge.y);return Go(Go({},ge),{},{x:Ce($),y:ve($)})}return Go(Go({},ge),{},{x:ge.x,y:ge.y})});return l.renderCurveStatically(Z,s,i)}var oe=si(0,I),te=oe($),be;if(f){var ie="".concat(f).split(/[,\s]+/gim).map(function(ge){return parseFloat(ge)});be=l.getStrokeDasharray(te,I,ie)}else be=l.generateSimpleStrokeDasharray(I,te);return l.renderCurveStatically(a,s,i,{strokeDasharray:be})})}},{key:"renderCurve",value:function(s,i){var l=this.props,d=l.points,a=l.isAnimationActive,f=this.state,p=f.prevPoints,y=f.totalLength;return a&&d&&d.length&&(!p&&y>0||!xm(p,d))?this.renderCurveWithAnimation(s,i):this.renderCurveStatically(d,s,i)}},{key:"render",value:function(){var s,i=this.props,l=i.hide,d=i.dot,a=i.points,f=i.className,p=i.xAxis,y=i.yAxis,v=i.top,j=i.left,w=i.width,k=i.height,S=i.isAnimationActive,R=i.id;if(l||!a||!a.length)return null;var D=this.state.isAnimationFinished,T=a.length===1,I=Yr("recharts-line",f),L=p&&p.allowDataOverflow,$=y&&y.allowDataOverflow,W=L||$,Z=Zr(R)?this.id:R,oe=(s=Cr(d,!1))!==null&&s!==void 0?s:{r:3,strokeWidth:2},te=oe.r,be=te===void 0?3:te,ie=oe.strokeWidth,ge=ie===void 0?2:ie,Ie=w7(d)?d:{},Oe=Ie.clipDot,Xe=Oe===void 0?!0:Oe,Ue=be*2+ge;return me.createElement(gn,{className:I},L||$?me.createElement("defs",null,me.createElement("clipPath",{id:"clipPath-".concat(Z)},me.createElement("rect",{x:L?j:j-w/2,y:$?v:v-k/2,width:L?w:w*2,height:$?k:k*2})),!Xe&&me.createElement("clipPath",{id:"clipPath-dots-".concat(Z)},me.createElement("rect",{x:j-Ue/2,y:v-Ue/2,width:w+Ue,height:k+Ue}))):null,!T&&this.renderCurve(W,Z),this.renderErrorBar(W,Z),(T||d)&&this.renderDots(W,Xe,Z),(!S||D)&&Cc.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(s,i){return s.animationId!==i.prevAnimationId?{prevAnimationId:s.animationId,curPoints:s.points,prevPoints:i.curPoints}:s.points!==i.curPoints?{curPoints:s.points}:null}},{key:"repeat",value:function(s,i){for(var l=s.length%2!==0?[].concat(Rx(s),[0]):s,d=[],a=0;a<i;++a)d=[].concat(Rx(d),Rx(l));return d}},{key:"renderDotItem",value:function(s,i){var l;if(me.isValidElement(s))l=me.cloneElement(s,i);else if(Br(s))l=s(i);else{var d=i.key,a=L6(i,DRe),f=Yr("recharts-line-dot",typeof s!="boolean"?s.className:"");l=me.createElement(tv,g_({key:d},a,{className:f}))}return l}}])}(O.PureComponent);fc(al,"displayName","Line");fc(al,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Lu.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});fc(al,"getComposedData",function(e){var r=e.props,n=e.xAxis,s=e.yAxis,i=e.xAxisTicks,l=e.yAxisTicks,d=e.dataKey,a=e.bandSize,f=e.displayedData,p=e.offset,y=r.layout,v=f.map(function(j,w){var k=ii(j,d);return y==="horizontal"?{x:yS({axis:n,ticks:i,bandSize:a,entry:j,index:w}),y:Zr(k)?null:s.scale(k),value:k,payload:j}:{x:Zr(k)?null:n.scale(k),y:yS({axis:s,ticks:l,bandSize:a,entry:j,index:w}),value:k,payload:j}});return Go({points:v,layout:y},p)});var HRe=["layout","type","stroke","connectNulls","isRange","ref"],ZRe=["key"],UH;function vy(e){"@babel/helpers - typeof";return vy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},vy(e)}function WH(e,r){if(e==null)return{};var n=YRe(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function YRe(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}function Mf(){return Mf=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Mf.apply(this,arguments)}function $6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function bh(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?$6(Object(n),!0).forEach(function(s){ed(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function XRe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function B6(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,KH(s.key),s)}}function QRe(e,r,n){return r&&B6(e.prototype,r),n&&B6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function JRe(e,r,n){return r=US(r),e3e(e,GH()?Reflect.construct(r,n||[],US(e).constructor):r.apply(e,n))}function e3e(e,r){if(r&&(vy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t3e(e)}function t3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(GH=function(){return!!e})()}function US(e){return US=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},US(e)}function r3e(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&$M(e,r)}function $M(e,r){return $M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},$M(e,r)}function ed(e,r,n){return r=KH(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function KH(e){var r=n3e(e,"string");return vy(r)=="symbol"?r:r+""}function n3e(e,r){if(vy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(vy(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var pd=function(e){function r(){var n;XRe(this,r);for(var s=arguments.length,i=new Array(s),l=0;l<s;l++)i[l]=arguments[l];return n=JRe(this,r,[].concat(i)),ed(n,"state",{isAnimationFinished:!0}),ed(n,"id",gp("recharts-area-")),ed(n,"handleAnimationEnd",function(){var d=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Br(d)&&d()}),ed(n,"handleAnimationStart",function(){var d=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Br(d)&&d()}),n}return r3e(r,e),QRe(r,[{key:"renderDots",value:function(s,i,l){var d=this.props.isAnimationActive,a=this.state.isAnimationFinished;if(d&&!a)return null;var f=this.props,p=f.dot,y=f.points,v=f.dataKey,j=Cr(this.props,!1),w=Cr(p,!0),k=y.map(function(R,D){var T=bh(bh(bh({key:"dot-".concat(D),r:3},j),w),{},{index:D,cx:R.x,cy:R.y,dataKey:v,value:R.value,payload:R.payload,points:y});return r.renderDotItem(p,T)}),S={clipPath:s?"url(#clipPath-".concat(i?"":"dots-").concat(l,")"):null};return me.createElement(gn,Mf({className:"recharts-area-dots"},S),k)}},{key:"renderHorizontalRect",value:function(s){var i=this.props,l=i.baseLine,d=i.points,a=i.strokeWidth,f=d[0].x,p=d[d.length-1].x,y=s*Math.abs(f-p),v=Uh(d.map(function(j){return j.y||0}));return Xt(l)&&typeof l=="number"?v=Math.max(l,v):l&&Array.isArray(l)&&l.length&&(v=Math.max(Uh(l.map(function(j){return j.y||0})),v)),Xt(v)?me.createElement("rect",{x:f<p?f:f-y,y:0,width:y,height:Math.floor(v+(a?parseInt("".concat(a),10):1))}):null}},{key:"renderVerticalRect",value:function(s){var i=this.props,l=i.baseLine,d=i.points,a=i.strokeWidth,f=d[0].y,p=d[d.length-1].y,y=s*Math.abs(f-p),v=Uh(d.map(function(j){return j.x||0}));return Xt(l)&&typeof l=="number"?v=Math.max(l,v):l&&Array.isArray(l)&&l.length&&(v=Math.max(Uh(l.map(function(j){return j.x||0})),v)),Xt(v)?me.createElement("rect",{x:0,y:f<p?f:f-y,width:v+(a?parseInt("".concat(a),10):1),height:Math.floor(y)}):null}},{key:"renderClipRect",value:function(s){var i=this.props.layout;return i==="vertical"?this.renderVerticalRect(s):this.renderHorizontalRect(s)}},{key:"renderAreaStatically",value:function(s,i,l,d){var a=this.props,f=a.layout,p=a.type,y=a.stroke,v=a.connectNulls,j=a.isRange;a.ref;var w=WH(a,HRe);return me.createElement(gn,{clipPath:l?"url(#clipPath-".concat(d,")"):null},me.createElement(Uf,Mf({},Cr(w,!0),{points:s,connectNulls:v,type:p,baseLine:i,layout:f,stroke:"none",className:"recharts-area-area"})),y!=="none"&&me.createElement(Uf,Mf({},Cr(this.props,!1),{className:"recharts-area-curve",layout:f,type:p,connectNulls:v,fill:"none",points:s})),y!=="none"&&j&&me.createElement(Uf,Mf({},Cr(this.props,!1),{className:"recharts-area-curve",layout:f,type:p,connectNulls:v,fill:"none",points:i})))}},{key:"renderAreaWithAnimation",value:function(s,i){var l=this,d=this.props,a=d.points,f=d.baseLine,p=d.isAnimationActive,y=d.animationBegin,v=d.animationDuration,j=d.animationEasing,w=d.animationId,k=this.state,S=k.prevPoints,R=k.prevBaseLine;return me.createElement(Fl,{begin:y,duration:v,isActive:p,easing:j,from:{t:0},to:{t:1},key:"area-".concat(w),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(D){var T=D.t;if(S){var I=S.length/a.length,L=a.map(function(oe,te){var be=Math.floor(te*I);if(S[be]){var ie=S[be],ge=si(ie.x,oe.x),Ie=si(ie.y,oe.y);return bh(bh({},oe),{},{x:ge(T),y:Ie(T)})}return oe}),$;if(Xt(f)&&typeof f=="number"){var W=si(R,f);$=W(T)}else if(Zr(f)||Ky(f)){var Z=si(R,0);$=Z(T)}else $=f.map(function(oe,te){var be=Math.floor(te*I);if(R[be]){var ie=R[be],ge=si(ie.x,oe.x),Ie=si(ie.y,oe.y);return bh(bh({},oe),{},{x:ge(T),y:Ie(T)})}return oe});return l.renderAreaStatically(L,$,s,i)}return me.createElement(gn,null,me.createElement("defs",null,me.createElement("clipPath",{id:"animationClipPath-".concat(i)},l.renderClipRect(T))),me.createElement(gn,{clipPath:"url(#animationClipPath-".concat(i,")")},l.renderAreaStatically(a,f,s,i)))})}},{key:"renderArea",value:function(s,i){var l=this.props,d=l.points,a=l.baseLine,f=l.isAnimationActive,p=this.state,y=p.prevPoints,v=p.prevBaseLine,j=p.totalLength;return f&&d&&d.length&&(!y&&j>0||!xm(y,d)||!xm(v,a))?this.renderAreaWithAnimation(s,i):this.renderAreaStatically(d,a,s,i)}},{key:"render",value:function(){var s,i=this.props,l=i.hide,d=i.dot,a=i.points,f=i.className,p=i.top,y=i.left,v=i.xAxis,j=i.yAxis,w=i.width,k=i.height,S=i.isAnimationActive,R=i.id;if(l||!a||!a.length)return null;var D=this.state.isAnimationFinished,T=a.length===1,I=Yr("recharts-area",f),L=v&&v.allowDataOverflow,$=j&&j.allowDataOverflow,W=L||$,Z=Zr(R)?this.id:R,oe=(s=Cr(d,!1))!==null&&s!==void 0?s:{r:3,strokeWidth:2},te=oe.r,be=te===void 0?3:te,ie=oe.strokeWidth,ge=ie===void 0?2:ie,Ie=w7(d)?d:{},Oe=Ie.clipDot,Xe=Oe===void 0?!0:Oe,Ue=be*2+ge;return me.createElement(gn,{className:I},L||$?me.createElement("defs",null,me.createElement("clipPath",{id:"clipPath-".concat(Z)},me.createElement("rect",{x:L?y:y-w/2,y:$?p:p-k/2,width:L?w:w*2,height:$?k:k*2})),!Xe&&me.createElement("clipPath",{id:"clipPath-dots-".concat(Z)},me.createElement("rect",{x:y-Ue/2,y:p-Ue/2,width:w+Ue,height:k+Ue}))):null,T?null:this.renderArea(W,Z),(d||T)&&this.renderDots(W,Xe,Z),(!S||D)&&Cc.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(s,i){return s.animationId!==i.prevAnimationId?{prevAnimationId:s.animationId,curPoints:s.points,curBaseLine:s.baseLine,prevPoints:i.curPoints,prevBaseLine:i.curBaseLine}:s.points!==i.curPoints||s.baseLine!==i.curBaseLine?{curPoints:s.points,curBaseLine:s.baseLine}:null}}])}(O.PureComponent);UH=pd;ed(pd,"displayName","Area");ed(pd,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Lu.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});ed(pd,"getBaseValue",function(e,r,n,s){var i=e.layout,l=e.baseValue,d=r.props.baseValue,a=d??l;if(Xt(a)&&typeof a=="number")return a;var f=i==="horizontal"?s:n,p=f.scale.domain();if(f.type==="number"){var y=Math.max(p[0],p[1]),v=Math.min(p[0],p[1]);return a==="dataMin"?v:a==="dataMax"||y<0?y:Math.max(Math.min(p[0],p[1]),0)}return a==="dataMin"?p[0]:a==="dataMax"?p[1]:p[0]});ed(pd,"getComposedData",function(e){var r=e.props,n=e.item,s=e.xAxis,i=e.yAxis,l=e.xAxisTicks,d=e.yAxisTicks,a=e.bandSize,f=e.dataKey,p=e.stackedData,y=e.dataStartIndex,v=e.displayedData,j=e.offset,w=r.layout,k=p&&p.length,S=UH.getBaseValue(r,n,s,i),R=w==="horizontal",D=!1,T=v.map(function(L,$){var W;k?W=p[y+$]:(W=ii(L,f),Array.isArray(W)?D=!0:W=[S,W]);var Z=W[1]==null||k&&ii(L,f)==null;return R?{x:yS({axis:s,ticks:l,bandSize:a,entry:L,index:$}),y:Z?null:i.scale(W[1]),value:W,payload:L}:{x:Z?null:s.scale(W[1]),y:yS({axis:i,ticks:d,bandSize:a,entry:L,index:$}),value:W,payload:L}}),I;return k||D?I=T.map(function(L){var $=Array.isArray(L.value)?L.value[0]:null;return R?{x:L.x,y:$!=null&&L.y!=null?i.scale($):null}:{x:$!=null?s.scale($):null,y:L.y}}):I=R?i.scale(S):s.scale(S),bh({points:T,baseLine:I,layout:w,isRange:D},j)});ed(pd,"renderDotItem",function(e,r){var n;if(me.isValidElement(e))n=me.cloneElement(e,r);else if(Br(e))n=e(r);else{var s=Yr("recharts-area-dot",typeof e!="boolean"?e.className:""),i=r.key,l=WH(r,ZRe);n=me.createElement(tv,Mf({},l,{key:i,className:s}))}return n});function _y(e){"@babel/helpers - typeof";return _y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_y(e)}function s3e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function i3e(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,YH(s.key),s)}}function a3e(e,r,n){return r&&i3e(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function o3e(e,r,n){return r=WS(r),l3e(e,HH()?Reflect.construct(r,n||[],WS(e).constructor):r.apply(e,n))}function l3e(e,r){if(r&&(_y(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c3e(e)}function c3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(HH=function(){return!!e})()}function WS(e){return WS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},WS(e)}function d3e(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&BM(e,r)}function BM(e,r){return BM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},BM(e,r)}function ZH(e,r,n){return r=YH(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function YH(e){var r=u3e(e,"string");return _y(r)=="symbol"?r:r+""}function u3e(e,r){if(_y(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(_y(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function qM(){return qM=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},qM.apply(this,arguments)}function h3e(e){var r=e.xAxisId,n=U4(),s=W4(),i=TH(r);return i==null?null:me.createElement(sv,qM({},i,{className:Yr("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:s},ticksGenerator:function(d){return lu(d,!0)}}))}var xa=function(e){function r(){return s3e(this,r),o3e(this,r,arguments)}return d3e(r,e),a3e(r,[{key:"render",value:function(){return me.createElement(h3e,this.props)}}])}(me.Component);ZH(xa,"displayName","XAxis");ZH(xa,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function by(e){"@babel/helpers - typeof";return by=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},by(e)}function m3e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function f3e(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,JH(s.key),s)}}function p3e(e,r,n){return r&&f3e(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function x3e(e,r,n){return r=GS(r),g3e(e,XH()?Reflect.construct(r,n||[],GS(e).constructor):r.apply(e,n))}function g3e(e,r){if(r&&(by(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y3e(e)}function y3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(XH=function(){return!!e})()}function GS(e){return GS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},GS(e)}function v3e(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&VM(e,r)}function VM(e,r){return VM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},VM(e,r)}function QH(e,r,n){return r=JH(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function JH(e){var r=_3e(e,"string");return by(r)=="symbol"?r:r+""}function _3e(e,r){if(by(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(by(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function UM(){return UM=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},UM.apply(this,arguments)}var b3e=function(r){var n=r.yAxisId,s=U4(),i=W4(),l=EH(n);return l==null?null:me.createElement(sv,UM({},l,{className:Yr("recharts-".concat(l.axisType," ").concat(l.axisType),l.className),viewBox:{x:0,y:0,width:s,height:i},ticksGenerator:function(a){return lu(a,!0)}}))},Bi=function(e){function r(){return m3e(this,r),x3e(this,r,arguments)}return v3e(r,e),p3e(r,[{key:"render",value:function(){return me.createElement(b3e,this.props)}}])}(me.Component);QH(Bi,"displayName","YAxis");QH(Bi,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function q6(e){return S3e(e)||N3e(e)||w3e(e)||j3e()}function j3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w3e(e,r){if(e){if(typeof e=="string")return WM(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return WM(e,r)}}function N3e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function S3e(e){if(Array.isArray(e))return WM(e)}function WM(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}var GM=function(r,n,s,i,l){var d=il(r,EP),a=il(r,OP),f=[].concat(q6(d),q6(a)),p=il(r,DP),y="".concat(i,"Id"),v=i[0],j=n;if(f.length&&(j=f.reduce(function(S,R){if(R.props[y]===s&&dd(R.props,"extendDomain")&&Xt(R.props[v])){var D=R.props[v];return[Math.min(S[0],D),Math.max(S[1],D)]}return S},j)),p.length){var w="".concat(v,"1"),k="".concat(v,"2");j=p.reduce(function(S,R){if(R.props[y]===s&&dd(R.props,"extendDomain")&&Xt(R.props[w])&&Xt(R.props[k])){var D=R.props[w],T=R.props[k];return[Math.min(S[0],D,T),Math.max(S[1],D,T)]}return S},j)}return l&&l.length&&(j=l.reduce(function(S,R){return Xt(R)?[Math.min(S[0],R),Math.max(S[1],R)]:S},j)),j},eZ={exports:{}};(function(e){var r=Object.prototype.hasOwnProperty,n="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(n=!1));function i(f,p,y){this.fn=f,this.context=p,this.once=y||!1}function l(f,p,y,v,j){if(typeof y!="function")throw new TypeError("The listener must be a function");var w=new i(y,v||f,j),k=n?n+p:p;return f._events[k]?f._events[k].fn?f._events[k]=[f._events[k],w]:f._events[k].push(w):(f._events[k]=w,f._eventsCount++),f}function d(f,p){--f._eventsCount===0?f._events=new s:delete f._events[p]}function a(){this._events=new s,this._eventsCount=0}a.prototype.eventNames=function(){var p=[],y,v;if(this._eventsCount===0)return p;for(v in y=this._events)r.call(y,v)&&p.push(n?v.slice(1):v);return Object.getOwnPropertySymbols?p.concat(Object.getOwnPropertySymbols(y)):p},a.prototype.listeners=function(p){var y=n?n+p:p,v=this._events[y];if(!v)return[];if(v.fn)return[v.fn];for(var j=0,w=v.length,k=new Array(w);j<w;j++)k[j]=v[j].fn;return k},a.prototype.listenerCount=function(p){var y=n?n+p:p,v=this._events[y];return v?v.fn?1:v.length:0},a.prototype.emit=function(p,y,v,j,w,k){var S=n?n+p:p;if(!this._events[S])return!1;var R=this._events[S],D=arguments.length,T,I;if(R.fn){switch(R.once&&this.removeListener(p,R.fn,void 0,!0),D){case 1:return R.fn.call(R.context),!0;case 2:return R.fn.call(R.context,y),!0;case 3:return R.fn.call(R.context,y,v),!0;case 4:return R.fn.call(R.context,y,v,j),!0;case 5:return R.fn.call(R.context,y,v,j,w),!0;case 6:return R.fn.call(R.context,y,v,j,w,k),!0}for(I=1,T=new Array(D-1);I<D;I++)T[I-1]=arguments[I];R.fn.apply(R.context,T)}else{var L=R.length,$;for(I=0;I<L;I++)switch(R[I].once&&this.removeListener(p,R[I].fn,void 0,!0),D){case 1:R[I].fn.call(R[I].context);break;case 2:R[I].fn.call(R[I].context,y);break;case 3:R[I].fn.call(R[I].context,y,v);break;case 4:R[I].fn.call(R[I].context,y,v,j);break;default:if(!T)for($=1,T=new Array(D-1);$<D;$++)T[$-1]=arguments[$];R[I].fn.apply(R[I].context,T)}}return!0},a.prototype.on=function(p,y,v){return l(this,p,y,v,!1)},a.prototype.once=function(p,y,v){return l(this,p,y,v,!0)},a.prototype.removeListener=function(p,y,v,j){var w=n?n+p:p;if(!this._events[w])return this;if(!y)return d(this,w),this;var k=this._events[w];if(k.fn)k.fn===y&&(!j||k.once)&&(!v||k.context===v)&&d(this,w);else{for(var S=0,R=[],D=k.length;S<D;S++)(k[S].fn!==y||j&&!k[S].once||v&&k[S].context!==v)&&R.push(k[S]);R.length?this._events[w]=R.length===1?R[0]:R:d(this,w)}return this},a.prototype.removeAllListeners=function(p){var y;return p?(y=n?n+p:p,this._events[y]&&d(this,y)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a})(eZ);var P3e=eZ.exports;const C3e=Vn(P3e);var jk=new C3e,wk="recharts.syncMouseEvents";function Mb(e){"@babel/helpers - typeof";return Mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Mb(e)}function A3e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function k3e(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,tZ(s.key),s)}}function T3e(e,r,n){return r&&k3e(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nk(e,r,n){return r=tZ(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function tZ(e){var r=E3e(e,"string");return Mb(r)=="symbol"?r:r+""}function E3e(e,r){if(Mb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(Mb(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var M3e=function(){function e(){A3e(this,e),Nk(this,"activeIndex",0),Nk(this,"coordinateList",[]),Nk(this,"layout","horizontal")}return T3e(e,[{key:"setDetails",value:function(n){var s,i=n.coordinateList,l=i===void 0?null:i,d=n.container,a=d===void 0?null:d,f=n.layout,p=f===void 0?null:f,y=n.offset,v=y===void 0?null:y,j=n.mouseHandlerCallback,w=j===void 0?null:j;this.coordinateList=(s=l??this.coordinateList)!==null&&s!==void 0?s:[],this.container=a??this.container,this.layout=p??this.layout,this.offset=v??this.offset,this.mouseHandlerCallback=w??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,s;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var i=this.container.getBoundingClientRect(),l=i.x,d=i.y,a=i.height,f=this.coordinateList[this.activeIndex].coordinate,p=((n=window)===null||n===void 0?void 0:n.scrollX)||0,y=((s=window)===null||s===void 0?void 0:s.scrollY)||0,v=l+f+p,j=d+this.offset.top+a/2+y;this.mouseHandlerCallback({pageX:v,pageY:j})}}}])}();function O3e(e,r,n){if(n==="number"&&r===!0&&Array.isArray(e)){var s=e==null?void 0:e[0],i=e==null?void 0:e[1];if(s&&i&&Xt(s)&&Xt(i))return!0}return!1}function I3e(e,r,n,s){var i=s/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?r.x-i:n.left+.5,y:e==="horizontal"?n.top+.5:r.y-i,width:e==="horizontal"?s:n.width-1,height:e==="horizontal"?n.height-1:s}}function rZ(e){var r=e.cx,n=e.cy,s=e.radius,i=e.startAngle,l=e.endAngle,d=Wn(r,n,s,i),a=Wn(r,n,s,l);return{points:[d,a],cx:r,cy:n,radius:s,startAngle:i,endAngle:l}}function D3e(e,r,n){var s,i,l,d;if(e==="horizontal")s=r.x,l=s,i=n.top,d=n.top+n.height;else if(e==="vertical")i=r.y,d=i,s=n.left,l=n.left+n.width;else if(r.cx!=null&&r.cy!=null)if(e==="centric"){var a=r.cx,f=r.cy,p=r.innerRadius,y=r.outerRadius,v=r.angle,j=Wn(a,f,p,v),w=Wn(a,f,y,v);s=j.x,i=j.y,l=w.x,d=w.y}else return rZ(r);return[{x:s,y:i},{x:l,y:d}]}function Ob(e){"@babel/helpers - typeof";return Ob=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ob(e)}function V6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function S1(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?V6(Object(n),!0).forEach(function(s){R3e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function R3e(e,r,n){return r=L3e(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function L3e(e){var r=F3e(e,"string");return Ob(r)=="symbol"?r:r+""}function F3e(e,r){if(Ob(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(Ob(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function z3e(e){var r,n,s=e.element,i=e.tooltipEventType,l=e.isActive,d=e.activeCoordinate,a=e.activePayload,f=e.offset,p=e.activeTooltipIndex,y=e.tooltipAxisBandSize,v=e.layout,j=e.chartName,w=(r=s.props.cursor)!==null&&r!==void 0?r:(n=s.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!s||!w||!l||!d||j!=="ScatterChart"&&i!=="axis")return null;var k,S=Uf;if(j==="ScatterChart")k=d,S=jMe;else if(j==="BarChart")k=I3e(v,d,f,y),S=z4;else if(v==="radial"){var R=rZ(d),D=R.cx,T=R.cy,I=R.radius,L=R.startAngle,$=R.endAngle;k={cx:D,cy:T,startAngle:L,endAngle:$,innerRadius:I,outerRadius:I},S=UK}else k={points:D3e(v,d,f)},S=Uf;var W=S1(S1(S1(S1({stroke:"#ccc",pointerEvents:"none"},f),k),Cr(w,!1)),{},{payload:a,payloadIndex:p,className:Yr("recharts-tooltip-cursor",w.className)});return O.isValidElement(w)?O.cloneElement(w,W):O.createElement(S,W)}var $3e=["item"],B3e=["children","className","width","height","style","compact","title","desc"];function jy(e){"@babel/helpers - typeof";return jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},jy(e)}function ng(){return ng=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},ng.apply(this,arguments)}function U6(e,r){return U3e(e)||V3e(e,r)||sZ(e,r)||q3e()}function q3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function V3e(e,r){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,l,d,a=[],f=!0,p=!1;try{if(l=(n=n.call(e)).next,r!==0)for(;!(f=(s=l.call(n)).done)&&(a.push(s.value),a.length!==r);f=!0);}catch(y){p=!0,i=y}finally{try{if(!f&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(p)throw i}}return a}}function U3e(e){if(Array.isArray(e))return e}function W6(e,r){if(e==null)return{};var n=W3e(e,r),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function W3e(e,r){if(e==null)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(r.indexOf(s)>=0)continue;n[s]=e[s]}return n}function G3e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function K3e(e,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,iZ(s.key),s)}}function H3e(e,r,n){return r&&K3e(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Z3e(e,r,n){return r=KS(r),Y3e(e,nZ()?Reflect.construct(r,n||[],KS(e).constructor):r.apply(e,n))}function Y3e(e,r){if(r&&(jy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return X3e(e)}function X3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nZ=function(){return!!e})()}function KS(e){return KS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},KS(e)}function Q3e(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&KM(e,r)}function KM(e,r){return KM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},KM(e,r)}function wy(e){return tLe(e)||eLe(e)||sZ(e)||J3e()}function J3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sZ(e,r){if(e){if(typeof e=="string")return HM(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return HM(e,r)}}function eLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tLe(e){if(Array.isArray(e))return HM(e)}function HM(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=new Array(r);n<r;n++)s[n]=e[n];return s}function G6(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function wt(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?G6(Object(n),!0).forEach(function(s){Gr(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G6(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Gr(e,r,n){return r=iZ(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function iZ(e){var r=rLe(e,"string");return jy(r)=="symbol"?r:r+""}function rLe(e,r){if(jy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(jy(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var nLe={xAxis:["bottom","top"],yAxis:["left","right"]},sLe={width:"100%",height:"100%"},aZ={x:0,y:0};function P1(e){return e}var iLe=function(r,n){return n==="horizontal"?r.x:n==="vertical"?r.y:n==="centric"?r.angle:r.radius},aLe=function(r,n,s,i){var l=n.find(function(y){return y&&y.index===s});if(l){if(r==="horizontal")return{x:l.coordinate,y:i.y};if(r==="vertical")return{x:i.x,y:l.coordinate};if(r==="centric"){var d=l.coordinate,a=i.radius;return wt(wt(wt({},i),Wn(i.cx,i.cy,a,d)),{},{angle:d,radius:a})}var f=l.coordinate,p=i.angle;return wt(wt(wt({},i),Wn(i.cx,i.cy,f,p)),{},{angle:p,radius:f})}return aZ},RP=function(r,n){var s=n.graphicalItems,i=n.dataStartIndex,l=n.dataEndIndex,d=(s??[]).reduce(function(a,f){var p=f.props.data;return p&&p.length?[].concat(wy(a),wy(p)):a},[]);return d.length>0?d:r&&r.length&&Xt(i)&&Xt(l)?r.slice(i,l+1):[]};function oZ(e){return e==="number"?[0,"auto"]:void 0}var ZM=function(r,n,s,i){var l=r.graphicalItems,d=r.tooltipAxis,a=RP(n,r);return s<0||!l||!l.length||s>=a.length?null:l.reduce(function(f,p){var y,v=(y=p.props.data)!==null&&y!==void 0?y:n;v&&r.dataStartIndex+r.dataEndIndex!==0&&r.dataEndIndex-r.dataStartIndex>=s&&(v=v.slice(r.dataStartIndex,r.dataEndIndex+1));var j;if(d.dataKey&&!d.allowDuplicatedCategory){var w=v===void 0?a:v;j=UN(w,d.dataKey,i)}else j=v&&v[s]||a[s];return j?[].concat(wy(f),[RK(p,j)]):f},[])},K6=function(r,n,s,i){var l=i||{x:r.chartX,y:r.chartY},d=iLe(l,s),a=r.orderedTooltipTicks,f=r.tooltipAxis,p=r.tooltipTicks,y=ike(d,a,p,f);if(y>=0&&p){var v=p[y]&&p[y].value,j=ZM(r,n,y,v),w=aLe(s,a,y,l);return{activeTooltipIndex:y,activeLabel:v,activePayload:j,activeCoordinate:w}}return null},oLe=function(r,n){var s=n.axes,i=n.graphicalItems,l=n.axisType,d=n.axisIdKey,a=n.stackGroups,f=n.dataStartIndex,p=n.dataEndIndex,y=r.layout,v=r.children,j=r.stackOffset,w=TK(y,l);return s.reduce(function(k,S){var R,D=S.type.defaultProps!==void 0?wt(wt({},S.type.defaultProps),S.props):S.props,T=D.type,I=D.dataKey,L=D.allowDataOverflow,$=D.allowDuplicatedCategory,W=D.scale,Z=D.ticks,oe=D.includeHidden,te=D[d];if(k[te])return k;var be=RP(r.data,{graphicalItems:i.filter(function(gt){var Et,tr=d in gt.props?gt.props[d]:(Et=gt.type.defaultProps)===null||Et===void 0?void 0:Et[d];return tr===te}),dataStartIndex:f,dataEndIndex:p}),ie=be.length,ge,Ie,Oe;O3e(D.domain,L,T)&&(ge=oM(D.domain,null,L),w&&(T==="number"||W!=="auto")&&(Oe=m_(be,I,"category")));var Xe=oZ(T);if(!ge||ge.length===0){var Ue,tt=(Ue=D.domain)!==null&&Ue!==void 0?Ue:Xe;if(I){if(ge=m_(be,I,T),T==="category"&&w){var Ce=Yxe(ge);$&&Ce?(Ie=ge,ge=OS(0,ie)):$||(ge=d$(tt,ge,S).reduce(function(gt,Et){return gt.indexOf(Et)>=0?gt:[].concat(wy(gt),[Et])},[]))}else if(T==="category")$?ge=ge.filter(function(gt){return gt!==""&&!Zr(gt)}):ge=d$(tt,ge,S).reduce(function(gt,Et){return gt.indexOf(Et)>=0||Et===""||Zr(Et)?gt:[].concat(wy(gt),[Et])},[]);else if(T==="number"){var ve=dke(be,i.filter(function(gt){var Et,tr,Dr=d in gt.props?gt.props[d]:(Et=gt.type.defaultProps)===null||Et===void 0?void 0:Et[d],Pr="hide"in gt.props?gt.props.hide:(tr=gt.type.defaultProps)===null||tr===void 0?void 0:tr.hide;return Dr===te&&(oe||!Pr)}),I,l,y);ve&&(ge=ve)}w&&(T==="number"||W!=="auto")&&(Oe=m_(be,I,"category"))}else w?ge=OS(0,ie):a&&a[te]&&a[te].hasStack&&T==="number"?ge=j==="expand"?[0,1]:DK(a[te].stackGroups,f,p):ge=kK(be,i.filter(function(gt){var Et=d in gt.props?gt.props[d]:gt.type.defaultProps[d],tr="hide"in gt.props?gt.props.hide:gt.type.defaultProps.hide;return Et===te&&(oe||!tr)}),T,y,!0);if(T==="number")ge=GM(v,ge,te,l,Z),tt&&(ge=oM(tt,ge,L));else if(T==="category"&&tt){var rt=tt,vt=ge.every(function(gt){return rt.indexOf(gt)>=0});vt&&(ge=rt)}}return wt(wt({},k),{},Gr({},te,wt(wt({},D),{},{axisType:l,domain:ge,categoricalDomain:Oe,duplicateDomain:Ie,originalDomain:(R=D.domain)!==null&&R!==void 0?R:Xe,isCategorical:w,layout:y})))},{})},lLe=function(r,n){var s=n.graphicalItems,i=n.Axis,l=n.axisType,d=n.axisIdKey,a=n.stackGroups,f=n.dataStartIndex,p=n.dataEndIndex,y=r.layout,v=r.children,j=RP(r.data,{graphicalItems:s,dataStartIndex:f,dataEndIndex:p}),w=j.length,k=TK(y,l),S=-1;return s.reduce(function(R,D){var T=D.type.defaultProps!==void 0?wt(wt({},D.type.defaultProps),D.props):D.props,I=T[d],L=oZ("number");if(!R[I]){S++;var $;return k?$=OS(0,w):a&&a[I]&&a[I].hasStack?($=DK(a[I].stackGroups,f,p),$=GM(v,$,I,l)):($=oM(L,kK(j,s.filter(function(W){var Z,oe,te=d in W.props?W.props[d]:(Z=W.type.defaultProps)===null||Z===void 0?void 0:Z[d],be="hide"in W.props?W.props.hide:(oe=W.type.defaultProps)===null||oe===void 0?void 0:oe.hide;return te===I&&!be}),"number",y),i.defaultProps.allowDataOverflow),$=GM(v,$,I,l)),wt(wt({},R),{},Gr({},I,wt(wt({axisType:l},i.defaultProps),{},{hide:!0,orientation:sl(nLe,"".concat(l,".").concat(S%2),null),domain:$,originalDomain:L,isCategorical:k,layout:y})))}return R},{})},cLe=function(r,n){var s=n.axisType,i=s===void 0?"xAxis":s,l=n.AxisComp,d=n.graphicalItems,a=n.stackGroups,f=n.dataStartIndex,p=n.dataEndIndex,y=r.children,v="".concat(i,"Id"),j=il(y,l),w={};return j&&j.length?w=oLe(r,{axes:j,graphicalItems:d,axisType:i,axisIdKey:v,stackGroups:a,dataStartIndex:f,dataEndIndex:p}):d&&d.length&&(w=lLe(r,{Axis:l,graphicalItems:d,axisType:i,axisIdKey:v,stackGroups:a,dataStartIndex:f,dataEndIndex:p})),w},dLe=function(r){var n=Ah(r),s=lu(n,!1,!0);return{tooltipTicks:s,orderedTooltipTicks:h4(s,function(i){return i.coordinate}),tooltipAxis:n,tooltipAxisBandSize:vS(n,s)}},H6=function(r){var n=r.children,s=r.defaultShowTooltip,i=Yo(n,hy),l=0,d=0;return r.data&&r.data.length!==0&&(d=r.data.length-1),i&&i.props&&(i.props.startIndex>=0&&(l=i.props.startIndex),i.props.endIndex>=0&&(d=i.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:l,dataEndIndex:d,activeTooltipIndex:-1,isTooltipActive:!!s}},uLe=function(r){return!r||!r.length?!1:r.some(function(n){var s=uu(n&&n.type);return s&&s.indexOf("Bar")>=0})},Z6=function(r){return r==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:r==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:r==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},hLe=function(r,n){var s=r.props,i=r.graphicalItems,l=r.xAxisMap,d=l===void 0?{}:l,a=r.yAxisMap,f=a===void 0?{}:a,p=s.width,y=s.height,v=s.children,j=s.margin||{},w=Yo(v,hy),k=Yo(v,pa),S=Object.keys(f).reduce(function($,W){var Z=f[W],oe=Z.orientation;return!Z.mirror&&!Z.hide?wt(wt({},$),{},Gr({},oe,$[oe]+Z.width)):$},{left:j.left||0,right:j.right||0}),R=Object.keys(d).reduce(function($,W){var Z=d[W],oe=Z.orientation;return!Z.mirror&&!Z.hide?wt(wt({},$),{},Gr({},oe,sl($,"".concat(oe))+Z.height)):$},{top:j.top||0,bottom:j.bottom||0}),D=wt(wt({},R),S),T=D.bottom;w&&(D.bottom+=w.props.height||hy.defaultProps.height),k&&n&&(D=lke(D,i,s,n));var I=p-D.left-D.right,L=y-D.top-D.bottom;return wt(wt({brushBottom:T},D),{},{width:Math.max(I,0),height:Math.max(L,0)})},mLe=function(r,n){if(n==="xAxis")return r[n].width;if(n==="yAxis")return r[n].height},oj=function(r){var n=r.chartName,s=r.GraphicalChild,i=r.defaultTooltipEventType,l=i===void 0?"axis":i,d=r.validateTooltipEventTypes,a=d===void 0?["axis"]:d,f=r.axisComponents,p=r.legendContent,y=r.formatAxisMap,v=r.defaultProps,j=function(D,T){var I=T.graphicalItems,L=T.stackGroups,$=T.offset,W=T.updateId,Z=T.dataStartIndex,oe=T.dataEndIndex,te=D.barSize,be=D.layout,ie=D.barGap,ge=D.barCategoryGap,Ie=D.maxBarSize,Oe=Z6(be),Xe=Oe.numericAxisName,Ue=Oe.cateAxisName,tt=uLe(I),Ce=[];return I.forEach(function(ve,rt){var vt=RP(D.data,{graphicalItems:[ve],dataStartIndex:Z,dataEndIndex:oe}),gt=ve.type.defaultProps!==void 0?wt(wt({},ve.type.defaultProps),ve.props):ve.props,Et=gt.dataKey,tr=gt.maxBarSize,Dr=gt["".concat(Xe,"Id")],Pr=gt["".concat(Ue,"Id")],It={},_r=f.reduce(function(nt,xt){var Ut=T["".concat(xt.axisType,"Map")],Vt=gt["".concat(xt.axisType,"Id")];Ut&&Ut[Vt]||xt.axisType==="zAxis"||cp();var Ft=Ut[Vt];return wt(wt({},nt),{},Gr(Gr({},xt.axisType,Ft),"".concat(xt.axisType,"Ticks"),lu(Ft)))},It),St=_r[Ue],Qt=_r["".concat(Ue,"Ticks")],rr=L&&L[Dr]&&L[Dr].hasStack&&vke(ve,L[Dr].stackGroups),pt=uu(ve.type).indexOf("Bar")>=0,qr=vS(St,Qt),or=[],en=tt&&ake({barSize:te,stackGroups:L,totalSize:mLe(_r,Ue)});if(pt){var Lr,En,ks=Zr(tr)?Ie:tr,Yn=(Lr=(En=vS(St,Qt,!0))!==null&&En!==void 0?En:ks)!==null&&Lr!==void 0?Lr:0;or=oke({barGap:ie,barCategoryGap:ge,bandSize:Yn!==qr?Yn:qr,sizeList:en[Pr],maxBarSize:ks}),Yn!==qr&&(or=or.map(function(nt){return wt(wt({},nt),{},{position:wt(wt({},nt.position),{},{offset:nt.position.offset-Yn/2})})}))}var qe=ve&&ve.type&&ve.type.getComposedData;qe&&Ce.push({props:wt(wt({},qe(wt(wt({},_r),{},{displayedData:vt,props:D,dataKey:Et,item:ve,bandSize:qr,barPosition:or,offset:$,stackedData:rr,layout:be,dataStartIndex:Z,dataEndIndex:oe}))),{},Gr(Gr(Gr({key:ve.key||"item-".concat(rt)},Xe,_r[Xe]),Ue,_r[Ue]),"animationId",W)),childIndex:oge(ve,D.children),item:ve})}),Ce},w=function(D,T){var I=D.props,L=D.dataStartIndex,$=D.dataEndIndex,W=D.updateId;if(!s5({props:I}))return null;var Z=I.children,oe=I.layout,te=I.stackOffset,be=I.data,ie=I.reverseStackOrder,ge=Z6(oe),Ie=ge.numericAxisName,Oe=ge.cateAxisName,Xe=il(Z,s),Ue=gke(be,Xe,"".concat(Ie,"Id"),"".concat(Oe,"Id"),te,ie),tt=f.reduce(function(gt,Et){var tr="".concat(Et.axisType,"Map");return wt(wt({},gt),{},Gr({},tr,cLe(I,wt(wt({},Et),{},{graphicalItems:Xe,stackGroups:Et.axisType===Ie&&Ue,dataStartIndex:L,dataEndIndex:$}))))},{}),Ce=hLe(wt(wt({},tt),{},{props:I,graphicalItems:Xe}),T==null?void 0:T.legendBBox);Object.keys(tt).forEach(function(gt){tt[gt]=y(I,tt[gt],Ce,gt.replace("Map",""),n)});var ve=tt["".concat(Oe,"Map")],rt=dLe(ve),vt=j(I,wt(wt({},tt),{},{dataStartIndex:L,dataEndIndex:$,updateId:W,graphicalItems:Xe,stackGroups:Ue,offset:Ce}));return wt(wt({formattedGraphicalItems:vt,graphicalItems:Xe,offset:Ce,stackGroups:Ue},rt),tt)},k=function(R){function D(T){var I,L,$;return G3e(this,D),$=Z3e(this,D,[T]),Gr($,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Gr($,"accessibilityManager",new M3e),Gr($,"handleLegendBBoxUpdate",function(W){if(W){var Z=$.state,oe=Z.dataStartIndex,te=Z.dataEndIndex,be=Z.updateId;$.setState(wt({legendBBox:W},w({props:$.props,dataStartIndex:oe,dataEndIndex:te,updateId:be},wt(wt({},$.state),{},{legendBBox:W}))))}}),Gr($,"handleReceiveSyncEvent",function(W,Z,oe){if($.props.syncId===W){if(oe===$.eventEmitterSymbol&&typeof $.props.syncMethod!="function")return;$.applySyncEvent(Z)}}),Gr($,"handleBrushChange",function(W){var Z=W.startIndex,oe=W.endIndex;if(Z!==$.state.dataStartIndex||oe!==$.state.dataEndIndex){var te=$.state.updateId;$.setState(function(){return wt({dataStartIndex:Z,dataEndIndex:oe},w({props:$.props,dataStartIndex:Z,dataEndIndex:oe,updateId:te},$.state))}),$.triggerSyncEvent({dataStartIndex:Z,dataEndIndex:oe})}}),Gr($,"handleMouseEnter",function(W){var Z=$.getMouseInfo(W);if(Z){var oe=wt(wt({},Z),{},{isTooltipActive:!0});$.setState(oe),$.triggerSyncEvent(oe);var te=$.props.onMouseEnter;Br(te)&&te(oe,W)}}),Gr($,"triggeredAfterMouseMove",function(W){var Z=$.getMouseInfo(W),oe=Z?wt(wt({},Z),{},{isTooltipActive:!0}):{isTooltipActive:!1};$.setState(oe),$.triggerSyncEvent(oe);var te=$.props.onMouseMove;Br(te)&&te(oe,W)}),Gr($,"handleItemMouseEnter",function(W){$.setState(function(){return{isTooltipActive:!0,activeItem:W,activePayload:W.tooltipPayload,activeCoordinate:W.tooltipPosition||{x:W.cx,y:W.cy}}})}),Gr($,"handleItemMouseLeave",function(){$.setState(function(){return{isTooltipActive:!1}})}),Gr($,"handleMouseMove",function(W){W.persist(),$.throttleTriggeredAfterMouseMove(W)}),Gr($,"handleMouseLeave",function(W){$.throttleTriggeredAfterMouseMove.cancel();var Z={isTooltipActive:!1};$.setState(Z),$.triggerSyncEvent(Z);var oe=$.props.onMouseLeave;Br(oe)&&oe(Z,W)}),Gr($,"handleOuterEvent",function(W){var Z=age(W),oe=sl($.props,"".concat(Z));if(Z&&Br(oe)){var te,be;/.*touch.*/i.test(Z)?be=$.getMouseInfo(W.changedTouches[0]):be=$.getMouseInfo(W),oe((te=be)!==null&&te!==void 0?te:{},W)}}),Gr($,"handleClick",function(W){var Z=$.getMouseInfo(W);if(Z){var oe=wt(wt({},Z),{},{isTooltipActive:!0});$.setState(oe),$.triggerSyncEvent(oe);var te=$.props.onClick;Br(te)&&te(oe,W)}}),Gr($,"handleMouseDown",function(W){var Z=$.props.onMouseDown;if(Br(Z)){var oe=$.getMouseInfo(W);Z(oe,W)}}),Gr($,"handleMouseUp",function(W){var Z=$.props.onMouseUp;if(Br(Z)){var oe=$.getMouseInfo(W);Z(oe,W)}}),Gr($,"handleTouchMove",function(W){W.changedTouches!=null&&W.changedTouches.length>0&&$.throttleTriggeredAfterMouseMove(W.changedTouches[0])}),Gr($,"handleTouchStart",function(W){W.changedTouches!=null&&W.changedTouches.length>0&&$.handleMouseDown(W.changedTouches[0])}),Gr($,"handleTouchEnd",function(W){W.changedTouches!=null&&W.changedTouches.length>0&&$.handleMouseUp(W.changedTouches[0])}),Gr($,"triggerSyncEvent",function(W){$.props.syncId!==void 0&&jk.emit(wk,$.props.syncId,W,$.eventEmitterSymbol)}),Gr($,"applySyncEvent",function(W){var Z=$.props,oe=Z.layout,te=Z.syncMethod,be=$.state.updateId,ie=W.dataStartIndex,ge=W.dataEndIndex;if(W.dataStartIndex!==void 0||W.dataEndIndex!==void 0)$.setState(wt({dataStartIndex:ie,dataEndIndex:ge},w({props:$.props,dataStartIndex:ie,dataEndIndex:ge,updateId:be},$.state)));else if(W.activeTooltipIndex!==void 0){var Ie=W.chartX,Oe=W.chartY,Xe=W.activeTooltipIndex,Ue=$.state,tt=Ue.offset,Ce=Ue.tooltipTicks;if(!tt)return;if(typeof te=="function")Xe=te(Ce,W);else if(te==="value"){Xe=-1;for(var ve=0;ve<Ce.length;ve++)if(Ce[ve].value===W.activeLabel){Xe=ve;break}}var rt=wt(wt({},tt),{},{x:tt.left,y:tt.top}),vt=Math.min(Ie,rt.x+rt.width),gt=Math.min(Oe,rt.y+rt.height),Et=Ce[Xe]&&Ce[Xe].value,tr=ZM($.state,$.props.data,Xe),Dr=Ce[Xe]?{x:oe==="horizontal"?Ce[Xe].coordinate:vt,y:oe==="horizontal"?gt:Ce[Xe].coordinate}:aZ;$.setState(wt(wt({},W),{},{activeLabel:Et,activeCoordinate:Dr,activePayload:tr,activeTooltipIndex:Xe}))}else $.setState(W)}),Gr($,"renderCursor",function(W){var Z,oe=$.state,te=oe.isTooltipActive,be=oe.activeCoordinate,ie=oe.activePayload,ge=oe.offset,Ie=oe.activeTooltipIndex,Oe=oe.tooltipAxisBandSize,Xe=$.getTooltipEventType(),Ue=(Z=W.props.active)!==null&&Z!==void 0?Z:te,tt=$.props.layout,Ce=W.key||"_recharts-cursor";return me.createElement(z3e,{key:Ce,activeCoordinate:be,activePayload:ie,activeTooltipIndex:Ie,chartName:n,element:W,isActive:Ue,layout:tt,offset:ge,tooltipAxisBandSize:Oe,tooltipEventType:Xe})}),Gr($,"renderPolarAxis",function(W,Z,oe){var te=sl(W,"type.axisType"),be=sl($.state,"".concat(te,"Map")),ie=W.type.defaultProps,ge=ie!==void 0?wt(wt({},ie),W.props):W.props,Ie=be&&be[ge["".concat(te,"Id")]];return O.cloneElement(W,wt(wt({},Ie),{},{className:Yr(te,Ie.className),key:W.key||"".concat(Z,"-").concat(oe),ticks:lu(Ie,!0)}))}),Gr($,"renderPolarGrid",function(W){var Z=W.props,oe=Z.radialLines,te=Z.polarAngles,be=Z.polarRadius,ie=$.state,ge=ie.radiusAxisMap,Ie=ie.angleAxisMap,Oe=Ah(ge),Xe=Ah(Ie),Ue=Xe.cx,tt=Xe.cy,Ce=Xe.innerRadius,ve=Xe.outerRadius;return O.cloneElement(W,{polarAngles:Array.isArray(te)?te:lu(Xe,!0).map(function(rt){return rt.coordinate}),polarRadius:Array.isArray(be)?be:lu(Oe,!0).map(function(rt){return rt.coordinate}),cx:Ue,cy:tt,innerRadius:Ce,outerRadius:ve,key:W.key||"polar-grid",radialLines:oe})}),Gr($,"renderLegend",function(){var W=$.state.formattedGraphicalItems,Z=$.props,oe=Z.children,te=Z.width,be=Z.height,ie=$.props.margin||{},ge=te-(ie.left||0)-(ie.right||0),Ie=CK({children:oe,formattedGraphicalItems:W,legendWidth:ge,legendContent:p});if(!Ie)return null;var Oe=Ie.item,Xe=W6(Ie,$3e);return O.cloneElement(Oe,wt(wt({},Xe),{},{chartWidth:te,chartHeight:be,margin:ie,onBBoxUpdate:$.handleLegendBBoxUpdate}))}),Gr($,"renderTooltip",function(){var W,Z=$.props,oe=Z.children,te=Z.accessibilityLayer,be=Yo(oe,Gs);if(!be)return null;var ie=$.state,ge=ie.isTooltipActive,Ie=ie.activeCoordinate,Oe=ie.activePayload,Xe=ie.activeLabel,Ue=ie.offset,tt=(W=be.props.active)!==null&&W!==void 0?W:ge;return O.cloneElement(be,{viewBox:wt(wt({},Ue),{},{x:Ue.left,y:Ue.top}),active:tt,label:Xe,payload:tt?Oe:[],coordinate:Ie,accessibilityLayer:te})}),Gr($,"renderBrush",function(W){var Z=$.props,oe=Z.margin,te=Z.data,be=$.state,ie=be.offset,ge=be.dataStartIndex,Ie=be.dataEndIndex,Oe=be.updateId;return O.cloneElement(W,{key:W.key||"_recharts-brush",onChange:b1($.handleBrushChange,W.props.onChange),data:te,x:Xt(W.props.x)?W.props.x:ie.left,y:Xt(W.props.y)?W.props.y:ie.top+ie.height+ie.brushBottom-(oe.bottom||0),width:Xt(W.props.width)?W.props.width:ie.width,startIndex:ge,endIndex:Ie,updateId:"brush-".concat(Oe)})}),Gr($,"renderReferenceElement",function(W,Z,oe){if(!W)return null;var te=$,be=te.clipPathId,ie=$.state,ge=ie.xAxisMap,Ie=ie.yAxisMap,Oe=ie.offset,Xe=W.type.defaultProps||{},Ue=W.props,tt=Ue.xAxisId,Ce=tt===void 0?Xe.xAxisId:tt,ve=Ue.yAxisId,rt=ve===void 0?Xe.yAxisId:ve;return O.cloneElement(W,{key:W.key||"".concat(Z,"-").concat(oe),xAxis:ge[Ce],yAxis:Ie[rt],viewBox:{x:Oe.left,y:Oe.top,width:Oe.width,height:Oe.height},clipPathId:be})}),Gr($,"renderActivePoints",function(W){var Z=W.item,oe=W.activePoint,te=W.basePoint,be=W.childIndex,ie=W.isRange,ge=[],Ie=Z.props.key,Oe=Z.item.type.defaultProps!==void 0?wt(wt({},Z.item.type.defaultProps),Z.item.props):Z.item.props,Xe=Oe.activeDot,Ue=Oe.dataKey,tt=wt(wt({index:be,dataKey:Ue,cx:oe.x,cy:oe.y,r:4,fill:F4(Z.item),strokeWidth:2,stroke:"#fff",payload:oe.payload,value:oe.value},Cr(Xe,!1)),WN(Xe));return ge.push(D.renderActiveDot(Xe,tt,"".concat(Ie,"-activePoint-").concat(be))),te?ge.push(D.renderActiveDot(Xe,wt(wt({},tt),{},{cx:te.x,cy:te.y}),"".concat(Ie,"-basePoint-").concat(be))):ie&&ge.push(null),ge}),Gr($,"renderGraphicChild",function(W,Z,oe){var te=$.filterFormatItem(W,Z,oe);if(!te)return null;var be=$.getTooltipEventType(),ie=$.state,ge=ie.isTooltipActive,Ie=ie.tooltipAxis,Oe=ie.activeTooltipIndex,Xe=ie.activeLabel,Ue=$.props.children,tt=Yo(Ue,Gs),Ce=te.props,ve=Ce.points,rt=Ce.isRange,vt=Ce.baseLine,gt=te.item.type.defaultProps!==void 0?wt(wt({},te.item.type.defaultProps),te.item.props):te.item.props,Et=gt.activeDot,tr=gt.hide,Dr=gt.activeBar,Pr=gt.activeShape,It=!!(!tr&&ge&&tt&&(Et||Dr||Pr)),_r={};be!=="axis"&&tt&&tt.props.trigger==="click"?_r={onClick:b1($.handleItemMouseEnter,W.props.onClick)}:be!=="axis"&&(_r={onMouseLeave:b1($.handleItemMouseLeave,W.props.onMouseLeave),onMouseEnter:b1($.handleItemMouseEnter,W.props.onMouseEnter)});var St=O.cloneElement(W,wt(wt({},te.props),_r));function Qt(xt){return typeof Ie.dataKey=="function"?Ie.dataKey(xt.payload):null}if(It)if(Oe>=0){var rr,pt;if(Ie.dataKey&&!Ie.allowDuplicatedCategory){var qr=typeof Ie.dataKey=="function"?Qt:"payload.".concat(Ie.dataKey.toString());rr=UN(ve,qr,Xe),pt=rt&&vt&&UN(vt,qr,Xe)}else rr=ve==null?void 0:ve[Oe],pt=rt&&vt&&vt[Oe];if(Pr||Dr){var or=W.props.activeIndex!==void 0?W.props.activeIndex:Oe;return[O.cloneElement(W,wt(wt(wt({},te.props),_r),{},{activeIndex:or})),null,null]}if(!Zr(rr))return[St].concat(wy($.renderActivePoints({item:te,activePoint:rr,basePoint:pt,childIndex:Oe,isRange:rt})))}else{var en,Lr=(en=$.getItemByXY($.state.activeCoordinate))!==null&&en!==void 0?en:{graphicalItem:St},En=Lr.graphicalItem,ks=En.item,Yn=ks===void 0?W:ks,qe=En.childIndex,nt=wt(wt(wt({},te.props),_r),{},{activeIndex:qe});return[O.cloneElement(Yn,nt),null,null]}return rt?[St,null,null]:[St,null]}),Gr($,"renderCustomized",function(W,Z,oe){return O.cloneElement(W,wt(wt({key:"recharts-customized-".concat(oe)},$.props),$.state))}),Gr($,"renderMap",{CartesianGrid:{handler:P1,once:!0},ReferenceArea:{handler:$.renderReferenceElement},ReferenceLine:{handler:P1},ReferenceDot:{handler:$.renderReferenceElement},XAxis:{handler:P1},YAxis:{handler:P1},Brush:{handler:$.renderBrush,once:!0},Bar:{handler:$.renderGraphicChild},Line:{handler:$.renderGraphicChild},Area:{handler:$.renderGraphicChild},Radar:{handler:$.renderGraphicChild},RadialBar:{handler:$.renderGraphicChild},Scatter:{handler:$.renderGraphicChild},Pie:{handler:$.renderGraphicChild},Funnel:{handler:$.renderGraphicChild},Tooltip:{handler:$.renderCursor,once:!0},PolarGrid:{handler:$.renderPolarGrid,once:!0},PolarAngleAxis:{handler:$.renderPolarAxis},PolarRadiusAxis:{handler:$.renderPolarAxis},Customized:{handler:$.renderCustomized}}),$.clipPathId="".concat((I=T.id)!==null&&I!==void 0?I:gp("recharts"),"-clip"),$.throttleTriggeredAfterMouseMove=PG($.triggeredAfterMouseMove,(L=T.throttleDelay)!==null&&L!==void 0?L:1e3/60),$.state={},$}return Q3e(D,R),H3e(D,[{key:"componentDidMount",value:function(){var I,L;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(I=this.props.margin.left)!==null&&I!==void 0?I:0,top:(L=this.props.margin.top)!==null&&L!==void 0?L:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var I=this.props,L=I.children,$=I.data,W=I.height,Z=I.layout,oe=Yo(L,Gs);if(oe){var te=oe.props.defaultIndex;if(!(typeof te!="number"||te<0||te>this.state.tooltipTicks.length-1)){var be=this.state.tooltipTicks[te]&&this.state.tooltipTicks[te].value,ie=ZM(this.state,$,te,be),ge=this.state.tooltipTicks[te].coordinate,Ie=(this.state.offset.top+W)/2,Oe=Z==="horizontal",Xe=Oe?{x:ge,y:Ie}:{y:ge,x:Ie},Ue=this.state.formattedGraphicalItems.find(function(Ce){var ve=Ce.item;return ve.type.name==="Scatter"});Ue&&(Xe=wt(wt({},Xe),Ue.props.points[te].tooltipPosition),ie=Ue.props.points[te].tooltipPayload);var tt={activeTooltipIndex:te,isTooltipActive:!0,activeLabel:be,activePayload:ie,activeCoordinate:Xe};this.setState(tt),this.renderCursor(oe),this.accessibilityManager.setIndex(te)}}}},{key:"getSnapshotBeforeUpdate",value:function(I,L){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==L.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==I.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==I.margin){var $,W;this.accessibilityManager.setDetails({offset:{left:($=this.props.margin.left)!==null&&$!==void 0?$:0,top:(W=this.props.margin.top)!==null&&W!==void 0?W:0}})}return null}},{key:"componentDidUpdate",value:function(I){jE([Yo(I.children,Gs)],[Yo(this.props.children,Gs)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var I=Yo(this.props.children,Gs);if(I&&typeof I.props.shared=="boolean"){var L=I.props.shared?"axis":"item";return a.indexOf(L)>=0?L:l}return l}},{key:"getMouseInfo",value:function(I){if(!this.container)return null;var L=this.container,$=L.getBoundingClientRect(),W=OSe($),Z={chartX:Math.round(I.pageX-W.left),chartY:Math.round(I.pageY-W.top)},oe=$.width/L.offsetWidth||1,te=this.inRange(Z.chartX,Z.chartY,oe);if(!te)return null;var be=this.state,ie=be.xAxisMap,ge=be.yAxisMap,Ie=this.getTooltipEventType();if(Ie!=="axis"&&ie&&ge){var Oe=Ah(ie).scale,Xe=Ah(ge).scale,Ue=Oe&&Oe.invert?Oe.invert(Z.chartX):null,tt=Xe&&Xe.invert?Xe.invert(Z.chartY):null;return wt(wt({},Z),{},{xValue:Ue,yValue:tt})}var Ce=K6(this.state,this.props.data,this.props.layout,te);return Ce?wt(wt({},Z),Ce):null}},{key:"inRange",value:function(I,L){var $=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,W=this.props.layout,Z=I/$,oe=L/$;if(W==="horizontal"||W==="vertical"){var te=this.state.offset,be=Z>=te.left&&Z<=te.left+te.width&&oe>=te.top&&oe<=te.top+te.height;return be?{x:Z,y:oe}:null}var ie=this.state,ge=ie.angleAxisMap,Ie=ie.radiusAxisMap;if(ge&&Ie){var Oe=Ah(ge);return m$({x:Z,y:oe},Oe)}return null}},{key:"parseEventsOfWrapper",value:function(){var I=this.props.children,L=this.getTooltipEventType(),$=Yo(I,Gs),W={};$&&L==="axis"&&($.props.trigger==="click"?W={onClick:this.handleClick}:W={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var Z=WN(this.props,this.handleOuterEvent);return wt(wt({},Z),W)}},{key:"addListener",value:function(){jk.on(wk,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){jk.removeListener(wk,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(I,L,$){for(var W=this.state.formattedGraphicalItems,Z=0,oe=W.length;Z<oe;Z++){var te=W[Z];if(te.item===I||te.props.key===I.key||L===uu(te.item.type)&&$===te.childIndex)return te}return null}},{key:"renderClipPath",value:function(){var I=this.clipPathId,L=this.state.offset,$=L.left,W=L.top,Z=L.height,oe=L.width;return me.createElement("defs",null,me.createElement("clipPath",{id:I},me.createElement("rect",{x:$,y:W,height:Z,width:oe})))}},{key:"getXScales",value:function(){var I=this.state.xAxisMap;return I?Object.entries(I).reduce(function(L,$){var W=U6($,2),Z=W[0],oe=W[1];return wt(wt({},L),{},Gr({},Z,oe.scale))},{}):null}},{key:"getYScales",value:function(){var I=this.state.yAxisMap;return I?Object.entries(I).reduce(function(L,$){var W=U6($,2),Z=W[0],oe=W[1];return wt(wt({},L),{},Gr({},Z,oe.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(I){var L;return(L=this.state.xAxisMap)===null||L===void 0||(L=L[I])===null||L===void 0?void 0:L.scale}},{key:"getYScaleByAxisId",value:function(I){var L;return(L=this.state.yAxisMap)===null||L===void 0||(L=L[I])===null||L===void 0?void 0:L.scale}},{key:"getItemByXY",value:function(I){var L=this.state,$=L.formattedGraphicalItems,W=L.activeItem;if($&&$.length)for(var Z=0,oe=$.length;Z<oe;Z++){var te=$[Z],be=te.props,ie=te.item,ge=ie.type.defaultProps!==void 0?wt(wt({},ie.type.defaultProps),ie.props):ie.props,Ie=uu(ie.type);if(Ie==="Bar"){var Oe=(be.data||[]).find(function(Ce){return nMe(I,Ce)});if(Oe)return{graphicalItem:te,payload:Oe}}else if(Ie==="RadialBar"){var Xe=(be.data||[]).find(function(Ce){return m$(I,Ce)});if(Xe)return{graphicalItem:te,payload:Xe}}else if(AP(te,W)||kP(te,W)||Cb(te,W)){var Ue=tIe({graphicalItem:te,activeTooltipItem:W,itemData:ge.data}),tt=ge.activeIndex===void 0?Ue:ge.activeIndex;return{graphicalItem:wt(wt({},te),{},{childIndex:tt}),payload:Cb(te,W)?ge.data[Ue]:te.props.data[Ue]}}}return null}},{key:"render",value:function(){var I=this;if(!s5(this))return null;var L=this.props,$=L.children,W=L.className,Z=L.width,oe=L.height,te=L.style,be=L.compact,ie=L.title,ge=L.desc,Ie=W6(L,B3e),Oe=Cr(Ie,!1);if(be)return me.createElement(N6,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},me.createElement(NE,ng({},Oe,{width:Z,height:oe,title:ie,desc:ge}),this.renderClipPath(),a5($,this.renderMap)));if(this.props.accessibilityLayer){var Xe,Ue;Oe.tabIndex=(Xe=this.props.tabIndex)!==null&&Xe!==void 0?Xe:0,Oe.role=(Ue=this.props.role)!==null&&Ue!==void 0?Ue:"application",Oe.onKeyDown=function(Ce){I.accessibilityManager.keyboardEvent(Ce)},Oe.onFocus=function(){I.accessibilityManager.focus()}}var tt=this.parseEventsOfWrapper();return me.createElement(N6,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},me.createElement("div",ng({className:Yr("recharts-wrapper",W),style:wt({position:"relative",cursor:"default",width:Z,height:oe},te)},tt,{ref:function(ve){I.container=ve}}),me.createElement(NE,ng({},Oe,{width:Z,height:oe,title:ie,desc:ge,style:sLe}),this.renderClipPath(),a5($,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(O.Component);Gr(k,"displayName",n),Gr(k,"defaultProps",wt({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},v)),Gr(k,"getDerivedStateFromProps",function(R,D){var T=R.dataKey,I=R.data,L=R.children,$=R.width,W=R.height,Z=R.layout,oe=R.stackOffset,te=R.margin,be=D.dataStartIndex,ie=D.dataEndIndex;if(D.updateId===void 0){var ge=H6(R);return wt(wt(wt({},ge),{},{updateId:0},w(wt(wt({props:R},ge),{},{updateId:0}),D)),{},{prevDataKey:T,prevData:I,prevWidth:$,prevHeight:W,prevLayout:Z,prevStackOffset:oe,prevMargin:te,prevChildren:L})}if(T!==D.prevDataKey||I!==D.prevData||$!==D.prevWidth||W!==D.prevHeight||Z!==D.prevLayout||oe!==D.prevStackOffset||!gg(te,D.prevMargin)){var Ie=H6(R),Oe={chartX:D.chartX,chartY:D.chartY,isTooltipActive:D.isTooltipActive},Xe=wt(wt({},K6(D,I,Z)),{},{updateId:D.updateId+1}),Ue=wt(wt(wt({},Ie),Oe),Xe);return wt(wt(wt({},Ue),w(wt({props:R},Ue),D)),{},{prevDataKey:T,prevData:I,prevWidth:$,prevHeight:W,prevLayout:Z,prevStackOffset:oe,prevMargin:te,prevChildren:L})}if(!jE(L,D.prevChildren)){var tt,Ce,ve,rt,vt=Yo(L,hy),gt=vt&&(tt=(Ce=vt.props)===null||Ce===void 0?void 0:Ce.startIndex)!==null&&tt!==void 0?tt:be,Et=vt&&(ve=(rt=vt.props)===null||rt===void 0?void 0:rt.endIndex)!==null&&ve!==void 0?ve:ie,tr=gt!==be||Et!==ie,Dr=!Zr(I),Pr=Dr&&!tr?D.updateId:D.updateId+1;return wt(wt({updateId:Pr},w(wt(wt({props:R},D),{},{updateId:Pr,dataStartIndex:gt,dataEndIndex:Et}),D)),{},{prevChildren:L,dataStartIndex:gt,dataEndIndex:Et})}return null}),Gr(k,"renderActiveDot",function(R,D,T){var I;return O.isValidElement(R)?I=O.cloneElement(R,D):Br(R)?I=R(D):I=me.createElement(tv,D),me.createElement(gn,{className:"recharts-active-dot",key:T},I)});var S=O.forwardRef(function(D,T){return me.createElement(k,ng({},D,{ref:T}))});return S.displayName=k.displayName,S},lj=oj({chartName:"LineChart",GraphicalChild:al,axisComponents:[{axisType:"xAxis",AxisComp:xa},{axisType:"yAxis",AxisComp:Bi}],formatAxisMap:$4}),Ny=oj({chartName:"BarChart",GraphicalChild:Ha,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:xa},{axisType:"yAxis",AxisComp:Bi}],formatAxisMap:$4}),Y6=oj({chartName:"PieChart",GraphicalChild:fd,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:nv},{axisType:"radiusAxis",AxisComp:rv}],formatAxisMap:zK,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),fLe=oj({chartName:"RadarChart",GraphicalChild:aj,axisComponents:[{axisType:"angleAxis",AxisComp:nv},{axisType:"radiusAxis",AxisComp:rv}],formatAxisMap:zK,defaultProps:{layout:"centric",startAngle:90,endAngle:-270,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),lZ=oj({chartName:"AreaChart",GraphicalChild:pd,axisComponents:[{axisType:"xAxis",AxisComp:xa},{axisType:"yAxis",AxisComp:Bi}],formatAxisMap:$4});function pLe(){var te,be;const{accountNo:e}=XO(),r=Sr(),[n,s]=O.useState(!1),[i,l]=O.useState({category:"billing",priority:"medium",status:"open"}),[d,a]=O.useState(!1),[f,p]=O.useState(null),[y,v]=O.useState(""),{data:j,isLoading:w}=ct({queryKey:["account-overview",e],queryFn:()=>Ws.getAccountOverview(e),enabled:!!e}),{data:k}=ct({queryKey:["account-billing",e],queryFn:()=>Ws.getBillingHistory(e,12),enabled:!!e}),{data:S}=ct({queryKey:["account-analytics",e],queryFn:()=>Ws.getConsumptionAnalytics(e,12),enabled:!!e}),{data:R}=ct({queryKey:["account-complaints",e],queryFn:()=>Ws.getComplaints({account_no:e}),enabled:!!e}),{data:D}=ct({queryKey:["account-notes",e],queryFn:()=>Ws.getNotes({account_no:e}),enabled:!!e}),T=Nt({mutationFn:ie=>Ws.createComplaint(ie),onSuccess:()=>{r.invalidateQueries({queryKey:["account-complaints",e]}),r.invalidateQueries({queryKey:["account-overview",e]}),s(!1),l({category:"billing",priority:"medium",status:"open"}),Ge.success("Complaint created successfully")},onError:ie=>{Ge.error(ie.message||"Failed to create complaint")}}),I=Nt({mutationFn:({id:ie,data:ge})=>Ws.updateComplaint(ie,ge),onSuccess:()=>{r.invalidateQueries({queryKey:["account-complaints",e]}),r.invalidateQueries({queryKey:["account-overview",e]}),Ge.success("Complaint updated successfully")},onError:ie=>{Ge.error(ie.message||"Failed to update complaint")}}),L=Nt({mutationFn:ie=>Ws.createNote(ie),onSuccess:()=>{r.invalidateQueries({queryKey:["account-notes",e]}),a(!1),v(""),Ge.success("Note created successfully")},onError:ie=>{Ge.error(ie.message||"Failed to create note")}}),$=Nt({mutationFn:({id:ie,data:ge})=>Ws.updateNote(ie,ge),onSuccess:()=>{r.invalidateQueries({queryKey:["account-notes",e]}),a(!1),p(null),v(""),Ge.success("Note updated successfully")},onError:ie=>{Ge.error(ie.message||"Failed to update note")}}),W=Nt({mutationFn:ie=>Ws.deleteNote(ie),onSuccess:()=>{r.invalidateQueries({queryKey:["account-notes",e]}),Ge.success("Note deleted successfully")},onError:ie=>{Ge.error(ie.message||"Failed to delete note")}});if(w)return t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("p",{className:"text-lg",children:"Loading account details..."})});if(!j)return t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("p",{className:"text-lg text-red-600",children:"Account not found"})});const Z=((te=j.balance)==null?void 0:te.balance)||0,oe=(S==null?void 0:S.trend)==="increasing"?t.jsx(xs,{className:"h-4 w-4 text-orange-600"}):(S==null?void 0:S.trend)==="decreasing"?t.jsx(Xa,{className:"h-4 w-4 text-green-600"}):t.jsx(gL,{className:"h-4 w-4 text-gray-600"});return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-3xl font-bold",children:["Account ",e]}),t.jsxs("p",{className:"text-muted-foreground",children:[j.customer.first_name," ",j.customer.last_name]})]}),t.jsx(Ee,{variant:j.connection.status==="active"?"default":"destructive",children:j.connection.status})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Current Balance"}),t.jsx(nI,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:["KES ",Z.toLocaleString()]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:Z>0?"Outstanding":"Paid up"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Avg. Consumption"}),oe]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[(S==null?void 0:S.average)||0," m"]}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1 capitalize",children:["Trend: ",((be=S==null?void 0:S.trend)==null?void 0:be.replace("_"," "))||"N/A"]})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Open Cases"}),t.jsx(ps,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:j.active_cases_count}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Revenue Assurance"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Complaints"}),t.jsx($ne,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:j.open_complaints_count}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Open issues"})]})]})]}),t.jsxs(Sn,{defaultValue:"summary",className:"w-full",children:[t.jsxs(bn,{children:[t.jsx(kt,{value:"summary",children:"Summary"}),t.jsx(kt,{value:"billing",children:"Billing"}),t.jsx(kt,{value:"payments",children:"Payments"}),t.jsx(kt,{value:"reads",children:"Meter Reads"}),t.jsx(kt,{value:"complaints",children:"Complaints"}),t.jsx(kt,{value:"notes",children:"Notes"}),t.jsx(kt,{value:"cases",children:"RA Cases"})]}),t.jsxs(Dt,{value:"summary",className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Customer Information"})}),t.jsxs(Q,{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:"Name:"}),t.jsxs("span",{className:"text-sm",children:[j.customer.first_name," ",j.customer.last_name]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:"ID Number:"}),t.jsx("span",{className:"text-sm",children:j.customer.id_number})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:"Phone:"}),t.jsx("span",{className:"text-sm",children:j.customer.phone})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:"Email:"}),t.jsx("span",{className:"text-sm",children:j.customer.email||"N/A"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:"Type:"}),t.jsx(Ee,{variant:"outline",children:j.customer.customer_type})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Premise Details"})}),t.jsxs(Q,{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:"Address:"}),t.jsx("span",{className:"text-sm",children:j.premise.address})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:"Category:"}),t.jsx(Ee,{variant:"outline",children:j.premise.category})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:"Connection Date:"}),t.jsx("span",{className:"text-sm",children:new Date(j.connection.connected_at).toLocaleDateString()})]}),j.latest_meter&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:"Meter No:"}),t.jsx("span",{className:"text-sm",children:j.latest_meter.meter_no})]})]})]})]}),j.balance&&j.balance.balance>0&&t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Balance Aging"})}),t.jsx(Q,{children:t.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Current"}),t.jsxs("p",{className:"text-lg font-bold",children:["KES ",j.balance.current.toLocaleString()]})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"1-30 Days"}),t.jsxs("p",{className:"text-lg font-bold",children:["KES ",j.balance.days_30.toLocaleString()]})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"31-60 Days"}),t.jsxs("p",{className:"text-lg font-bold",children:["KES ",j.balance.days_60.toLocaleString()]})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"61-90 Days"}),t.jsxs("p",{className:"text-lg font-bold",children:["KES ",j.balance.days_90.toLocaleString()]})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Over 90 Days"}),t.jsxs("p",{className:"text-lg font-bold text-red-600",children:["KES ",j.balance.over_90.toLocaleString()]})]})]})})]}),S&&S.consumption.length>0&&t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(sd,{className:"h-5 w-5"}),"Consumption Trends (Last 12 Months)"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"h-[300px]",children:t.jsx(Za,{width:"100%",height:"100%",children:t.jsxs(lj,{data:S.consumption.map(ie=>({month:new Date(ie.period_start).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),consumption:ie.consumption})),margin:{top:5,right:20,bottom:5,left:0},children:[t.jsx(Io,{strokeDasharray:"3 3",className:"stroke-muted"}),t.jsx(xa,{dataKey:"month",className:"text-xs",tick:{fill:"hsl(var(--muted-foreground))"}}),t.jsx(Bi,{className:"text-xs",tick:{fill:"hsl(var(--muted-foreground))"},label:{value:"m",angle:-90,position:"insideLeft",fill:"hsl(var(--muted-foreground))"}}),t.jsx(Gs,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"6px"},labelStyle:{color:"hsl(var(--foreground))"}}),t.jsx(al,{type:"monotone",dataKey:"consumption",stroke:"hsl(var(--primary))",strokeWidth:2,dot:{fill:"hsl(var(--primary))",r:4},activeDot:{r:6}})]})})}),t.jsxs("div",{className:"mt-4 flex items-center justify-between text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-muted-foreground",children:"Average:"}),t.jsxs("span",{className:"font-semibold",children:[S.average," m/month"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-muted-foreground",children:"Trend:"}),t.jsxs(Ee,{variant:S.trend==="increasing"?"destructive":S.trend==="decreasing"?"default":"secondary",children:[S.trend==="increasing"&&t.jsx(xs,{className:"h-3 w-3 mr-1"}),S.trend==="decreasing"&&t.jsx(Xa,{className:"h-3 w-3 mr-1"}),S.trend==="stable"&&t.jsx(gL,{className:"h-3 w-3 mr-1"}),S.trend.replace("_"," ")]})]})]})]})]})]}),t.jsx(Dt,{value:"billing",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Recent Invoices"})}),t.jsx(Q,{children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Period"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Amount"}),t.jsx(ce,{children:"Due Date"})]})}),t.jsx(mr,{children:k==null?void 0:k.invoices.map(ie=>t.jsxs(ut,{children:[t.jsxs(se,{children:[new Date(ie.period_start).toLocaleDateString()," -"," ",new Date(ie.period_end).toLocaleDateString()]}),t.jsx(se,{children:t.jsx(Ee,{variant:ie.status==="paid"?"default":"secondary",children:ie.status})}),t.jsxs(se,{children:["KES ",ie.total_amount.toLocaleString()]}),t.jsx(se,{children:new Date(ie.due_at).toLocaleDateString()})]},ie.id))})]})})]})}),t.jsx(Dt,{value:"payments",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Payment History"})}),t.jsx(Q,{children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Date"}),t.jsx(ce,{children:"Amount"}),t.jsx(ce,{children:"Channel"}),t.jsx(ce,{children:"Reference"})]})}),t.jsx(mr,{children:k==null?void 0:k.payments.map(ie=>t.jsxs(ut,{children:[t.jsx(se,{children:new Date(ie.paid_at).toLocaleDateString()}),t.jsxs(se,{children:["KES ",ie.amount.toLocaleString()]}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:ie.channel})}),t.jsx(se,{className:"font-mono text-sm",children:ie.reference})]},ie.id))})]})})]})}),t.jsx(Dt,{value:"reads",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Recent Meter Reads"})}),t.jsx(Q,{children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Date"}),t.jsx(ce,{children:"Reading"}),t.jsx(ce,{children:"Consumption"}),t.jsx(ce,{children:"Quality"}),t.jsx(ce,{children:"Source"})]})}),t.jsx(mr,{children:j.recent_reads.map((ie,ge)=>{const Ie=ge>0?j.recent_reads[ge-1]:null,Oe=Ie?ie.value-Ie.value:null;return t.jsxs(ut,{children:[t.jsx(se,{children:new Date(ie.read_at).toLocaleDateString()}),t.jsxs(se,{children:[ie.value," m"]}),t.jsx(se,{children:Oe!==null?`${Oe} m`:"-"}),t.jsx(se,{children:t.jsx(Ee,{variant:ie.quality==="good"?"default":"secondary",children:ie.quality})}),t.jsx(se,{children:ie.source})]},ie.id)})})]})})]})}),t.jsx(Dt,{value:"complaints",children:t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between",children:[t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(lm,{className:"h-5 w-5"}),"Customer Complaints"]}),t.jsxs(Or,{open:n,onOpenChange:s,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{size:"sm",children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Log Complaint"]})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Log New Complaint"})}),t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{children:"Category"}),t.jsxs($t,{value:i.category,onValueChange:ie=>l({...i,category:ie}),children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"billing",children:"Billing"}),t.jsx(Ne,{value:"water_quality",children:"Water Quality"}),t.jsx(Ne,{value:"supply",children:"Supply Issue"}),t.jsx(Ne,{value:"meter",children:"Meter Problem"}),t.jsx(Ne,{value:"leak",children:"Leak Report"}),t.jsx(Ne,{value:"customer_service",children:"Customer Service"}),t.jsx(Ne,{value:"other",children:"Other"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{children:"Priority"}),t.jsxs($t,{value:i.priority,onValueChange:ie=>l({...i,priority:ie}),children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"low",children:"Low"}),t.jsx(Ne,{value:"medium",children:"Medium"}),t.jsx(Ne,{value:"high",children:"High"}),t.jsx(Ne,{value:"critical",children:"Critical"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{children:"Description"}),t.jsx(ts,{placeholder:"Describe the issue...",value:i.description||"",onChange:ie=>l({...i,description:ie.target.value}),rows:4})]})]}),t.jsxs(Ji,{children:[t.jsx(X,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),t.jsx(X,{onClick:()=>{T.mutate({...i,account_no:e,customer_id:j==null?void 0:j.customer.id})},disabled:!i.description||T.isPending,children:T.isPending?"Creating...":"Create Complaint"})]})]})]})]}),t.jsx(Q,{children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"ID"}),t.jsx(ce,{children:"Category"}),t.jsx(ce,{children:"Priority"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Created"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:R!=null&&R.data&&R.data.length>0?R.data.map(ie=>t.jsxs(ut,{children:[t.jsxs(se,{className:"font-mono text-sm",children:["#",ie.id]}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:ie.category.replace("_"," ")})}),t.jsx(se,{children:t.jsx(Ee,{variant:ie.priority==="critical"?"destructive":ie.priority==="high"?"default":"secondary",children:ie.priority})}),t.jsx(se,{children:t.jsx(Ee,{variant:ie.status==="resolved"||ie.status==="closed"?"default":"secondary",children:ie.status})}),t.jsx(se,{children:new Date(ie.created_at).toLocaleDateString()}),t.jsx(se,{children:ie.status==="open"&&t.jsx(X,{size:"sm",variant:"outline",onClick:()=>I.mutate({id:ie.id,data:{status:"triage"}}),children:"Triage"})})]},ie.id)):t.jsx(ut,{children:t.jsx(se,{colSpan:6,className:"text-center text-muted-foreground",children:"No complaints found for this account"})})})]})})]})}),t.jsx(Dt,{value:"notes",children:t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between",children:[t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx($n,{className:"h-5 w-5"}),"Account Notes"]}),t.jsxs(Or,{open:d,onOpenChange:ie=>{a(ie),ie||(p(null),v(""))},children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{size:"sm",children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Add Note"]})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:f?"Edit Note":"Add New Note"})}),t.jsx("div",{className:"space-y-4 py-4",children:t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{children:"Note Content"}),t.jsx(ts,{placeholder:"Enter your note here...",value:y,onChange:ie=>v(ie.target.value),rows:6})]})}),t.jsxs(Ji,{children:[t.jsx(X,{variant:"outline",onClick:()=>{a(!1),p(null),v("")},children:"Cancel"}),t.jsx(X,{onClick:()=>{f?$.mutate({id:f.id,data:{content:y}}):L.mutate({account_no:e,customer_id:j==null?void 0:j.customer.id,content:y})},disabled:!y.trim()||L.isPending||$.isPending,children:L.isPending||$.isPending?"Saving...":f?"Update Note":"Add Note"})]})]})]})]}),t.jsx(Q,{children:t.jsx("div",{className:"space-y-4",children:D!=null&&D.data&&D.data.length>0?D.data.map(ie=>{var ge;return t.jsx("div",{className:"border rounded-lg p-4 space-y-2 hover:bg-muted/50 transition-colors",children:t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{className:"flex-1 space-y-1",children:[t.jsx("p",{className:"text-sm whitespace-pre-wrap",children:ie.content}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[t.jsx("span",{children:((ge=ie.createdBy)==null?void 0:ge.name)||"Unknown"}),t.jsx("span",{children:""}),t.jsx("span",{children:new Date(ie.created_at).toLocaleString()}),ie.updated_at!==ie.created_at&&t.jsxs(t.Fragment,{children:[t.jsx("span",{children:""}),t.jsx("span",{className:"italic",children:"edited"})]})]})]}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx(X,{size:"sm",variant:"ghost",onClick:()=>{p(ie),v(ie.content),a(!0)},children:t.jsx(g2,{className:"h-3 w-3"})}),t.jsx(X,{size:"sm",variant:"ghost",onClick:()=>{window.confirm("Are you sure you want to delete this note?")&&W.mutate(ie.id)},disabled:W.isPending,children:t.jsx(As,{className:"h-3 w-3"})})]})]})},ie.id)}):t.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[t.jsx($n,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),t.jsx("p",{children:"No notes found for this account"}),t.jsx("p",{className:"text-sm",children:"Add a note to keep track of important information"})]})})})]})}),t.jsx(Dt,{value:"cases",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Revenue Assurance Cases"})}),t.jsx(Q,{children:t.jsxs("p",{className:"text-sm text-muted-foreground",children:[j.active_cases_count," active case(s) for this account"]})})]})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs(Or,{children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{variant:"outline",className:"w-full",children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Move-In"]})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Process Move-In"})}),t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{children:"Move-In Date"}),t.jsx("input",{type:"date",className:"w-full border rounded px-3 py-2"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{children:"Initial Meter Reading (m)"}),t.jsx("input",{type:"number",placeholder:"0.00",className:"w-full border rounded px-3 py-2"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{children:"Notes"}),t.jsx(ts,{placeholder:"Any special notes...",rows:3})]})]}),t.jsxs(Ji,{children:[t.jsx(X,{variant:"outline",children:"Cancel"}),t.jsx(X,{onClick:()=>Ge.success("Move-in processed successfully"),children:"Complete Move-In"})]})]})]}),t.jsxs(Or,{children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{variant:"outline",className:"w-full",children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Move-Out"]})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Process Move-Out"})}),t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{children:"Move-Out Date"}),t.jsx("input",{type:"date",className:"w-full border rounded px-3 py-2"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{children:"Final Meter Reading (m)"}),t.jsx("input",{type:"number",placeholder:"0.00",className:"w-full border rounded px-3 py-2"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{children:"Account Status After Move-Out"}),t.jsxs("select",{className:"w-full border rounded px-3 py-2",children:[t.jsx("option",{children:"Disconnected"}),t.jsx("option",{children:"Suspended"}),t.jsx("option",{children:"Closed"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{children:"Notes"}),t.jsx(ts,{placeholder:"Outstanding balance notes, forwarding address, etc...",rows:3})]})]}),t.jsxs(Ji,{children:[t.jsx(X,{variant:"outline",children:"Cancel"}),t.jsx(X,{onClick:()=>Ge.success("Move-out processed successfully"),className:"bg-orange-600 hover:bg-orange-700",children:"Complete Move-Out"})]})]})]})]})]})}function xLe(){const[e,r]=O.useState(""),n=Ey(),s=i=>{i.preventDefault(),e.trim()&&n(`/crm/accounts/${e.trim()}`)};return t.jsx("div",{className:"max-w-2xl mx-auto mt-16",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Account 360 Search"})}),t.jsx(Q,{children:t.jsxs("form",{onSubmit:s,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Enter Account Number"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Ve,{placeholder:"e.g., ACC-001",value:e,onChange:i=>r(i.target.value),className:"flex-1"}),t.jsxs(X,{type:"submit",disabled:!e.trim(),children:[t.jsx(di,{className:"h-4 w-4 mr-2"}),"Search"]})]})]}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter a customer account number to view complete account details, billing history, consumption analytics, and revenue assurance cases."})]})})]})})}const gLe=["all","open","triage","field","resolved","closed"],yLe=["all","low","medium","high","critical"],vLe=["all","billing","water_quality","supply","meter","leak","customer_service","other"];function _Le(){const e=Sr(),[r,n]=O.useState(""),[s,i]=O.useState("all"),[l,d]=O.useState("all"),[a,f]=O.useState("all"),[p,y]=O.useState("list"),{data:v,isLoading:j,isError:w,error:k}=ct({queryKey:["complaints",r,s,l,a],queryFn:()=>{const L={};return r&&(L.search=r),s!=="all"&&(L.status=s),l!=="all"&&(L.priority=l),a!=="all"&&(L.category=a),Ws.getComplaints(L)}}),S=Nt({mutationFn:({id:L,data:$})=>Ws.updateComplaint(L,$),onSuccess:()=>{e.invalidateQueries({queryKey:["complaints"]}),Ge.success("Complaint updated successfully")},onError:L=>{Ge.error(L.message||"Failed to update complaint")}}),R=(v==null?void 0:v.data)||[],D=L=>L==="resolved"||L==="closed"?"default":L==="field"?"secondary":"outline",T=L=>L==="critical"?"destructive":L==="high"?"default":"secondary",I=R.reduce((L,$)=>(L[$.status]||(L[$.status]=[]),L[$.status].push($),L),{});return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Customer Complaints"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage and track customer service complaints"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{variant:p==="list"?"default":"outline",onClick:()=>y("list"),size:"sm",children:"List View"}),t.jsx(X,{variant:p==="kanban"?"default":"outline",onClick:()=>y("kanban"),size:"sm",children:"Kanban Board"})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx(di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Search complaints by account, description...",value:r,onChange:L=>n(L.target.value),className:"pl-10"})]}),t.jsxs("div",{className:"flex gap-2 flex-wrap",children:[t.jsxs($t,{value:s,onValueChange:L=>i(L),children:[t.jsx(Rt,{className:"w-[150px]",children:t.jsx(Bt,{placeholder:"Status"})}),t.jsx(Lt,{children:gLe.map(L=>t.jsx(Ne,{value:L,children:L==="all"?"All Status":L.replace("_"," ")},L))})]}),t.jsxs($t,{value:l,onValueChange:L=>d(L),children:[t.jsx(Rt,{className:"w-[150px]",children:t.jsx(Bt,{placeholder:"Priority"})}),t.jsx(Lt,{children:yLe.map(L=>t.jsx(Ne,{value:L,children:L==="all"?"All Priority":L},L))})]}),t.jsxs($t,{value:a,onValueChange:L=>f(L),children:[t.jsx(Rt,{className:"w-[180px]",children:t.jsx(Bt,{placeholder:"Category"})}),t.jsx(Lt,{children:vLe.map(L=>t.jsx(Ne,{value:L,children:L==="all"?"All Categories":L.replace("_"," ")},L))})]})]})]})}),t.jsx(Q,{children:j?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading complaints..."}):w?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(ps,{className:"h-12 w-12 mx-auto mb-2 text-destructive opacity-50"}),t.jsx("p",{className:"text-destructive font-semibold",children:"Failed to load complaints"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:(k==null?void 0:k.message)||"An error occurred while fetching complaints"})]}):p==="list"?t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"ID"}),t.jsx(ce,{children:"Account"}),t.jsx(ce,{children:"Category"}),t.jsx(ce,{children:"Priority"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Created"}),t.jsx(ce,{children:"Description"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:R.length>0?R.map(L=>t.jsxs(ut,{children:[t.jsxs(se,{className:"font-mono text-sm",children:["#",L.id]}),t.jsx(se,{children:t.jsxs(nd,{to:`/crm/accounts/${L.account_no}`,className:"text-blue-600 hover:underline flex items-center gap-1",children:[L.account_no,t.jsx(vV,{className:"h-3 w-3"})]})}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:L.category.replace("_"," ")})}),t.jsx(se,{children:t.jsx(Ee,{variant:T(L.priority),children:L.priority})}),t.jsx(se,{children:t.jsx(Ee,{variant:D(L.status),children:L.status})}),t.jsx(se,{className:"text-sm",children:new Date(L.created_at).toLocaleDateString()}),t.jsx(se,{className:"max-w-xs truncate",children:L.description}),t.jsxs(se,{children:[L.status==="open"&&t.jsx(X,{size:"sm",variant:"outline",disabled:S.isPending,onClick:()=>S.mutate({id:L.id,data:{status:"triage"}}),children:S.isPending?"Updating...":"Triage"}),L.status==="triage"&&t.jsx(X,{size:"sm",variant:"outline",disabled:S.isPending,onClick:()=>S.mutate({id:L.id,data:{status:"field"}}),children:S.isPending?"Updating...":"Send to Field"})]})]},L.id)):t.jsx(ut,{children:t.jsx(se,{colSpan:8,className:"text-center text-muted-foreground",children:"No complaints found"})})})]}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:["open","triage","field","resolved","closed"].map(L=>{var $,W;return t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"font-semibold capitalize",children:L.replace("_"," ")}),t.jsx(Ee,{variant:"secondary",children:(($=I[L])==null?void 0:$.length)||0})]}),t.jsx("div",{className:"space-y-2",children:((W=I[L])==null?void 0:W.map(Z=>t.jsx(H,{className:"p-3 hover:shadow-md transition-shadow",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("span",{className:"text-xs font-mono text-muted-foreground",children:["#",Z.id]}),t.jsx(Ee,{variant:T(Z.priority),className:"text-xs",children:Z.priority})]}),t.jsx(nd,{to:`/crm/accounts/${Z.account_no}`,className:"text-sm font-medium hover:underline block",children:Z.account_no}),t.jsx(Ee,{variant:"outline",className:"text-xs",children:Z.category.replace("_"," ")}),t.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:Z.description}),t.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(Z.created_at).toLocaleDateString()})]})},Z.id)))||t.jsx("div",{className:"text-center text-sm text-muted-foreground py-4",children:"No complaints"})})]},L)})})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Summary"})}),t.jsx(Q,{children:t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Complaints"}),t.jsx("p",{className:"text-2xl font-bold",children:R.length})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Open"}),t.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:R.filter(L=>L.status==="open").length})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"In Progress"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600",children:R.filter(L=>["triage","field"].includes(L.status)).length})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Resolved"}),t.jsx("p",{className:"text-2xl font-bold text-green-600",children:R.filter(L=>["resolved","closed"].includes(L.status)).length})]})]})})]})]})}const Sk=["phone","email","sms","web_portal","walk_in","field_visit"],bLe={phone:wN,email:sI,sms:oI,web_portal:Qf,walk_in:Ma,field_visit:Ma};function jLe(){const e=Sr(),[r,n]=O.useState(""),[s,i]=O.useState("all"),[l,d]=O.useState(!1),[a,f]=O.useState({account_no:"",channel:"phone",subject:"",message:""}),{data:p,isLoading:y}=ct({queryKey:["interactions",r,s],queryFn:()=>{const S={per_page:100};return r&&(S.search=r),s!=="all"&&(S.channel=s),Ws.getInteractions(S)}}),v=Nt({mutationFn:S=>Ws.createInteraction(S),onSuccess:()=>{e.invalidateQueries({queryKey:["interactions"]}),d(!1),f({account_no:"",channel:"phone",subject:"",message:""}),Ge.success("Interaction logged successfully")},onError:S=>{Ge.error(S.message||"Failed to log interaction")}}),j=(p==null?void 0:p.data)||[],w=S=>{const R=bLe[S]||lm;return t.jsx(R,{className:"h-4 w-4"})},k=S=>({phone:"bg-blue-100 text-blue-800",email:"bg-purple-100 text-purple-800",sms:"bg-green-100 text-green-800",web_portal:"bg-orange-100 text-orange-800",walk_in:"bg-yellow-100 text-yellow-800",field_visit:"bg-red-100 text-red-800"})[S]||"bg-gray-100 text-gray-800";return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Customer Interactions"}),t.jsx("p",{className:"text-muted-foreground",children:"Log and track all customer touchpoints"})]}),t.jsxs(Or,{open:l,onOpenChange:d,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Log Interaction"]})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Log New Interaction"})}),t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{children:"Account Number"}),t.jsx(Ve,{placeholder:"e.g., ACC-12345",value:a.account_no,onChange:S=>f({...a,account_no:S.target.value})})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{children:"Channel"}),t.jsxs($t,{value:a.channel,onValueChange:S=>f({...a,channel:S}),children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsx(Lt,{children:Sk.map(S=>t.jsx(Ne,{value:S,children:S.replace("_"," ")},S))})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{children:"Subject"}),t.jsx(Ve,{placeholder:"Brief subject",value:a.subject,onChange:S=>f({...a,subject:S.target.value})})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{children:"Message"}),t.jsx(ts,{placeholder:"Interaction details",value:a.message,onChange:S=>f({...a,message:S.target.value}),rows:4})]})]}),t.jsxs(Ji,{children:[t.jsx(X,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),t.jsx(X,{onClick:()=>v.mutate(a),disabled:!a.account_no||!a.subject||!a.message||v.isPending,children:v.isPending?"Logging...":"Log Interaction"})]})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx(di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Search by account number or subject...",value:r,onChange:S=>n(S.target.value),className:"pl-10"})]}),t.jsxs($t,{value:s,onValueChange:S=>i(S),children:[t.jsx(Rt,{className:"w-[150px]",children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All Channels"}),Sk.map(S=>t.jsx(Ne,{value:S,children:S.replace("_"," ")},S))]})]})]})}),t.jsx(Q,{children:y?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading interactions..."}):j.length>0?t.jsx("div",{className:"space-y-3",children:j.map(S=>t.jsx("div",{className:"border rounded-lg p-4 hover:bg-muted/50 transition-colors",children:t.jsx("div",{className:"flex items-start justify-between gap-4",children:t.jsxs("div",{className:"flex-1 space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`p-2 rounded-lg ${k(S.channel)}`,children:w(S.channel)}),t.jsxs("div",{children:[t.jsx(nd,{to:`/crm/accounts/${S.account_no}`,className:"font-semibold hover:underline text-blue-600",children:S.account_no}),t.jsx("p",{className:"text-sm text-muted-foreground",children:S.subject})]})]}),t.jsx("p",{className:"text-sm leading-relaxed",children:S.message}),t.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[t.jsx(Ee,{variant:"outline",className:"text-xs",children:S.channel.replace("_"," ")}),t.jsx("span",{children:new Date(S.created_at).toLocaleString()})]})]})})},S.id))}):t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(lm,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),t.jsx("p",{children:"No interactions found"})]})})]}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:Sk.map(S=>t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsx("div",{className:`p-3 rounded-lg ${k(S)}`,children:w(S)}),t.jsx("p",{className:"text-sm font-medium capitalize",children:S.replace("_"," ")}),t.jsx("p",{className:"text-2xl font-bold",children:j.filter(R=>R.channel===S).length})]})})},S))})]})}function wLe(){const[e,r]=O.useState({residential:!1,commercial:!1,industrial:!1,public:!1}),[n,s]=O.useState({min:0,max:1e5}),[i,l]=O.useState({min:0,max:1e4}),[d,a]=O.useState("active"),[f,p]=O.useState(""),{data:y}=ct({queryKey:["customers",{per_page:1e3}],queryFn:()=>Ws.getCustomers({per_page:1e3})}),v=(y==null?void 0:y.data)||[],j=v.filter(R=>Object.values(e).some(T=>T)===!1||e[R.customer_type]),w=[{id:"residential",label:"Residential",count:v.filter(R=>R.customer_type==="residential").length,color:"bg-blue-100 text-blue-800"},{id:"commercial",label:"Commercial",count:v.filter(R=>R.customer_type==="commercial").length,color:"bg-purple-100 text-purple-800"},{id:"industrial",label:"Industrial",count:v.filter(R=>R.customer_type==="industrial").length,color:"bg-orange-100 text-orange-800"},{id:"public",label:"Public",count:v.filter(R=>R.customer_type==="public").length,color:"bg-green-100 text-green-800"}],k=()=>{if(!f.trim()){Ge.error("Please enter a segment name");return}Ge.success(`Segment "${f}" created with ${j.length} customers`),p("")},S=()=>{const R=[["Account","Name","Type","Phone","Email"],...j.map(L=>[L.id,`${L.first_name} ${L.last_name}`,L.customer_type,L.phone,L.email||""])].map(L=>L.map($=>`"${$}"`).join(",")).join(`
`),D=new Blob([R],{type:"text/csv"}),T=window.URL.createObjectURL(D),I=document.createElement("a");I.href=T,I.download=`segment-${Date.now()}.csv`,I.click(),Ge.success("Segment exported successfully")};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Customer Segmentation"}),t.jsx("p",{className:"text-muted-foreground",children:"Create and manage customer segments for targeted campaigns"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx("div",{className:"lg:col-span-1",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(Sne,{className:"h-5 w-5"}),"Segment Filters"]})}),t.jsxs(Q,{className:"space-y-6",children:[t.jsxs("div",{className:"space-y-3",children:[t.jsx("h3",{className:"font-semibold",children:"Customer Type"}),w.map(R=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Nm,{id:R.id,checked:e[R.id],onCheckedChange:D=>r({...e,[R.id]:D===!0})}),t.jsx(Me,{htmlFor:R.id,className:"cursor-pointer flex-1",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{children:R.label}),t.jsx(Ee,{variant:"secondary",children:R.count})]})})]},R.id))]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("h3",{className:"font-semibold",children:"Status"}),t.jsxs($t,{value:d,onValueChange:a,children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All Statuses"}),t.jsx(Ne,{value:"active",children:"Active"}),t.jsx(Ne,{value:"suspended",children:"Suspended"}),t.jsx(Ne,{value:"disconnected",children:"Disconnected"})]})]})]}),t.jsx("div",{className:"space-y-3",children:t.jsxs("div",{children:[t.jsx(Me,{children:"Balance Range (KES)"}),t.jsxs("div",{className:"flex gap-2 mt-2",children:[t.jsx(Ve,{type:"number",placeholder:"Min",value:n.min,onChange:R=>s({...n,min:Number(R.target.value)})}),t.jsx(Ve,{type:"number",placeholder:"Max",value:n.max,onChange:R=>s({...n,max:Number(R.target.value)})})]})]})}),t.jsx("div",{className:"space-y-3",children:t.jsxs("div",{children:[t.jsx(Me,{children:"Segment Name"}),t.jsx(Ve,{placeholder:"e.g., High-Value Residential",value:f,onChange:R=>p(R.target.value),className:"mt-2"})]})}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs(X,{onClick:k,className:"w-full",children:[t.jsx(iI,{className:"h-4 w-4 mr-2"}),"Save Segment"]}),t.jsxs(X,{onClick:S,variant:"outline",className:"w-full",children:[t.jsx(Ta,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})]})]})}),t.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center justify-between",children:[t.jsx("span",{children:"Segment Overview"}),t.jsxs(Ee,{children:[j.length," customers"]})]})}),t.jsx(Q,{children:t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:w.map(R=>t.jsxs("div",{className:`p-4 rounded-lg ${R.color}`,children:[t.jsx("p",{className:"text-sm font-medium opacity-80",children:R.label}),t.jsx("p",{className:"text-2xl font-bold mt-1",children:j.filter(D=>D.customer_type===R.id).length})]},R.id))})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(sd,{className:"h-5 w-5"}),"Segment Statistics"]})}),t.jsx(Q,{className:"space-y-4",children:t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Customers"}),t.jsx("p",{className:"text-3xl font-bold",children:j.length})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Percentage of All"}),t.jsxs("p",{className:"text-3xl font-bold",children:[v.length>0?(j.length/v.length*100).toFixed(1):0,"%"]})]})]})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Sample Customers in Segment"})}),t.jsx(Q,{children:t.jsxs("div",{className:"space-y-2 max-h-80 overflow-y-auto",children:[j.slice(0,10).map(R=>t.jsxs("div",{className:"border rounded p-2 text-sm",children:[t.jsxs("p",{className:"font-medium",children:[R.first_name," ",R.last_name]}),t.jsx("p",{className:"text-muted-foreground",children:R.phone})]},R.id)),j.length>10&&t.jsxs("p",{className:"text-sm text-muted-foreground pt-2",children:["+",j.length-10," more customers"]})]})})]})]})]})]})}const cZ={low:"bg-gray-100 text-gray-800",medium:"bg-blue-100 text-blue-800",high:"bg-orange-100 text-orange-800",critical:"bg-red-100 text-red-800"},dZ={new:"bg-purple-100 text-purple-800",triage:"bg-blue-100 text-blue-800",field:"bg-orange-100 text-orange-800",resolved:"bg-green-100 text-green-800",closed_valid:"bg-gray-100 text-gray-800",closed_false_positive:"bg-gray-100 text-gray-800"};function NLe(){const[e,r]=O.useState(null),[n,s]=O.useState(""),[i,l]=O.useState(null),d=Sr(),{data:a,isLoading:f}=ct({queryKey:["ra-high-priority"],queryFn:()=>Ws.getHighPriorityCases(10)}),{data:p,isLoading:y}=ct({queryKey:["ra-cases"],queryFn:()=>Ws.getRaCases()}),v=Nt({mutationFn:({caseId:T,decision:I,notes:L})=>Ws.triageCase(T,{decision:I,notes:L}),onSuccess:()=>{d.invalidateQueries({queryKey:["ra-cases"]}),d.invalidateQueries({queryKey:["ra-high-priority"]}),Ge.success("Case triaged successfully"),r(null),s(""),l(null)},onError:T=>{Ge.error(`Triage failed: ${T.message}`)}}),j=()=>{!e||!i||v.mutate({caseId:e.id,decision:i,notes:n})},w=T=>{r(T),s(""),l(null)};if(y)return t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("p",{className:"text-lg",children:"Loading RA cases..."})});const k=(p==null?void 0:p.data)||[],S=k.filter(T=>T.status==="new"),R=k.filter(T=>T.status==="triage"),D=k.filter(T=>T.status==="field");return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Revenue Assurance Console"}),t.jsx("p",{className:"text-muted-foreground",children:"Monitor and triage revenue leakage cases"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"New Cases"}),t.jsx(an,{className:"h-4 w-4 text-orange-600"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:S.length}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting triage"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"In Triage"}),t.jsx(Xs,{className:"h-4 w-4 text-blue-600"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:R.length}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Under review"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Field Investigation"}),t.jsx(xs,{className:"h-4 w-4 text-purple-600"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:D.length}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Active investigations"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Total Active"}),t.jsx(an,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:k.length}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"All cases"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"High Priority Cases"})}),t.jsx(Q,{children:f?t.jsx("p",{className:"text-muted-foreground",children:"Loading..."}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Account"}),t.jsx(ce,{children:"Priority"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Detected"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:(a==null?void 0:a.data.length)===0?t.jsx(ut,{children:t.jsx(se,{colSpan:5,className:"text-center text-muted-foreground",children:"No high-priority cases"})}):a==null?void 0:a.data.map(T=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:T.account_no}),t.jsx(se,{children:t.jsx(Ee,{className:cZ[T.priority],children:T.priority})}),t.jsx(se,{children:t.jsx(Ee,{className:dZ[T.status],children:T.status})}),t.jsx(se,{children:new Date(T.detected_at).toLocaleDateString()}),t.jsx(se,{children:T.status==="new"&&t.jsx(X,{variant:"outline",size:"sm",onClick:()=>w(T),disabled:v.isPending,children:v.isPending?"Processing...":"Triage"})})]},T.id))})]})})]}),t.jsxs(Sn,{defaultValue:"all",children:[t.jsxs(bn,{children:[t.jsxs(kt,{value:"all",children:["All Cases (",k.length,")"]}),t.jsxs(kt,{value:"new",children:["New (",S.length,")"]}),t.jsxs(kt,{value:"triage",children:["Triage (",R.length,")"]}),t.jsxs(kt,{value:"field",children:["Field (",D.length,")"]})]}),t.jsx(Dt,{value:"all",children:t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:y?t.jsx("p",{className:"text-muted-foreground",children:"Loading cases..."}):t.jsx(C1,{cases:k,onTriage:w})})})}),t.jsx(Dt,{value:"new",children:t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsx(C1,{cases:S,onTriage:w})})})}),t.jsx(Dt,{value:"triage",children:t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsx(C1,{cases:R,onTriage:w})})})}),t.jsx(Dt,{value:"field",children:t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsx(C1,{cases:D,onTriage:w})})})})]}),t.jsx(Or,{open:!!e,onOpenChange:()=>r(null),children:t.jsxs(kr,{children:[t.jsxs(Tr,{children:[t.jsxs(Er,{children:["Triage Case #",e==null?void 0:e.id]}),t.jsxs(Pi,{children:["Account: ",e==null?void 0:e.account_no]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Me,{children:"Evidence"}),t.jsx("pre",{className:"mt-2 p-3 bg-muted rounded text-xs overflow-auto max-h-40",children:JSON.stringify(e==null?void 0:e.evidence,null,2)})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Decision"}),t.jsxs("div",{className:"flex gap-2 mt-2",children:[t.jsxs(X,{variant:i==="field"?"default":"outline",onClick:()=>l("field"),children:[t.jsx(Fs,{className:"h-4 w-4 mr-2"}),"Send to Field"]}),t.jsxs(X,{variant:i==="false_positive"?"default":"outline",onClick:()=>l("false_positive"),children:[t.jsx(Mu,{className:"h-4 w-4 mr-2"}),"False Positive"]})]})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"notes",children:"Notes"}),t.jsx(ts,{id:"notes",value:n,onChange:T=>s(T.target.value),placeholder:"Add notes about this decision...",rows:4})]})]}),t.jsxs(Ji,{children:[t.jsx(X,{variant:"outline",onClick:()=>r(null),children:"Cancel"}),t.jsx(X,{onClick:j,disabled:!i||v.isPending,children:v.isPending?"Submitting...":"Submit Triage"})]})]})})]})}function C1({cases:e,onTriage:r}){return e.length===0?t.jsx("p",{className:"text-center text-muted-foreground",children:"No cases found"}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"ID"}),t.jsx(ce,{children:"Account"}),t.jsx(ce,{children:"Priority"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Detected"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:e.map(n=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-mono text-sm",children:n.id}),t.jsx(se,{className:"font-medium",children:n.account_no}),t.jsx(se,{children:t.jsx(Ee,{className:cZ[n.priority],children:n.priority})}),t.jsx(se,{children:t.jsx(Ee,{className:dZ[n.status],children:n.status})}),t.jsx(se,{children:new Date(n.detected_at).toLocaleDateString()}),t.jsx(se,{children:n.status==="new"&&t.jsx(X,{variant:"outline",size:"sm",onClick:()=>r(n),children:"Triage"})})]},n.id))})]})}function SLe(){var v,j,w,k,S,R,D;const[e,r]=O.useState(new Set),n=Sr(),{data:s,isLoading:i}=ct({queryKey:["aging-report"],queryFn:()=>Ws.getAgingReport()}),{data:l,isLoading:d}=ct({queryKey:["disconnection-list"],queryFn:()=>Ws.getDisconnectionList()}),a=Nt({mutationFn:T=>Ws.generateDunningNotices(T),onMutate:T=>{r(I=>new Set(I).add(T))},onSuccess:(T,I)=>{r(L=>{const $=new Set(L);return $.delete(I),$}),n.invalidateQueries({queryKey:["aging-report"]}),Ge.success("Dunning notices generated successfully")},onError:(T,I)=>{r(L=>{const $=new Set(L);return $.delete(I),$}),Ge.error(`Failed to generate notices: ${T.message}`)}}),f=T=>{window.confirm(`Generate dunning notices for ${T} accounts?`)&&a.mutate(T)},p={total_balance:((v=s==null?void 0:s.summary)==null?void 0:v.total_balance)??0,total_accounts:((j=s==null?void 0:s.summary)==null?void 0:j.total_accounts)??0,current:((w=s==null?void 0:s.summary)==null?void 0:w.current)??0,days_30:((k=s==null?void 0:s.summary)==null?void 0:k.days_30)??0,days_60:((S=s==null?void 0:s.summary)==null?void 0:S.days_60)??0,days_90:((R=s==null?void 0:s.summary)==null?void 0:R.days_90)??0,over_90:((D=s==null?void 0:s.summary)==null?void 0:D.over_90)??0},y=(s==null?void 0:s.by_category)||{};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Dunning & Collections"}),t.jsx("p",{className:"text-muted-foreground",children:"Monitor overdue accounts and manage collections"})]}),i?t.jsx("p",{className:"text-muted-foreground",children:"Loading aging report..."}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Total Balance"}),t.jsx(co,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:["KES ",p.total_balance.toLocaleString()]}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[p.total_accounts," accounts"]})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Current"}),t.jsx(Hs,{className:"h-4 w-4 text-green-600"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:["KES ",p.current.toLocaleString()]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Not overdue"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"1-90 Days"}),t.jsx(an,{className:"h-4 w-4 text-orange-600"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:["KES ",(p.days_30+p.days_60+p.days_90).toLocaleString()]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Overdue"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Over 90 Days"}),t.jsx(Xa,{className:"h-4 w-4 text-red-600"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold text-red-600",children:["KES ",p.over_90.toLocaleString()]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Critical"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Balance Aging Breakdown"})}),t.jsx(Q,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-6 gap-4 text-sm font-medium text-muted-foreground",children:[t.jsx("div",{children:"Bucket"}),t.jsx("div",{children:"Amount"}),t.jsx("div",{children:"% of Total"}),t.jsx("div",{children:"Count"}),t.jsx("div",{children:"Actions"})]}),t.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-t",children:[t.jsx("div",{className:"font-medium",children:"Current"}),t.jsxs("div",{children:["KES ",p==null?void 0:p.current.toLocaleString()]}),t.jsxs("div",{children:[p!=null&&p.total_balance?(p.current/p.total_balance*100).toFixed(1):0,"%"]}),t.jsx("div",{children:"-"}),t.jsx("div",{children:t.jsx(Ee,{variant:"outline",children:"No Action"})})]}),t.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-t",children:[t.jsx("div",{className:"font-medium",children:"1-30 Days"}),t.jsxs("div",{children:["KES ",p==null?void 0:p.days_30.toLocaleString()]}),t.jsxs("div",{children:[p!=null&&p.total_balance?(p.days_30/p.total_balance*100).toFixed(1):0,"%"]}),t.jsx("div",{children:"-"}),t.jsx("div",{children:t.jsx(X,{size:"sm",variant:"outline",onClick:()=>f("days_30"),disabled:e.has("days_30"),children:e.has("days_30")?"Generating...":"Reminder Notice"})})]}),t.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-t",children:[t.jsx("div",{className:"font-medium",children:"31-60 Days"}),t.jsxs("div",{children:["KES ",p==null?void 0:p.days_60.toLocaleString()]}),t.jsxs("div",{children:[p!=null&&p.total_balance?(p.days_60/p.total_balance*100).toFixed(1):0,"%"]}),t.jsx("div",{children:"-"}),t.jsx("div",{children:t.jsx(X,{size:"sm",variant:"outline",onClick:()=>f("days_60"),disabled:e.has("days_60"),children:e.has("days_60")?"Generating...":"Warning Notice"})})]}),t.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-t",children:[t.jsx("div",{className:"font-medium",children:"61-90 Days"}),t.jsxs("div",{children:["KES ",p==null?void 0:p.days_90.toLocaleString()]}),t.jsxs("div",{children:[p!=null&&p.total_balance?(p.days_90/p.total_balance*100).toFixed(1):0,"%"]}),t.jsx("div",{children:"-"}),t.jsx("div",{children:t.jsx(X,{size:"sm",variant:"destructive",onClick:()=>f("days_90"),disabled:e.has("days_90"),children:e.has("days_90")?"Generating...":"Final Notice"})})]}),t.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-t",children:[t.jsx("div",{className:"font-medium text-red-600",children:"Over 90 Days"}),t.jsxs("div",{className:"text-red-600 font-bold",children:["KES ",p==null?void 0:p.over_90.toLocaleString()]}),t.jsxs("div",{className:"text-red-600",children:[p!=null&&p.total_balance?(p.over_90/p.total_balance*100).toFixed(1):0,"%"]}),t.jsx("div",{children:"-"}),t.jsx("div",{children:t.jsx(X,{size:"sm",variant:"destructive",onClick:()=>f("over_90"),disabled:e.has("over_90"),children:e.has("over_90")?"Generating...":"Disconnection Notice"})})]})]})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Accounts by Category"})}),t.jsx(Q,{children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Category"}),t.jsx(ce,{children:"Total Balance"}),t.jsx(ce,{children:"Account Count"}),t.jsx(ce,{children:"Avg Balance"})]})}),t.jsx(mr,{children:Object.entries(y).length===0?t.jsx(ut,{children:t.jsx(se,{colSpan:4,className:"text-center text-muted-foreground",children:"No data available"})}):Object.entries(y).map(([T,I])=>{var L;return t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium capitalize",children:T}),t.jsxs(se,{children:["KES ",((L=I.total_balance)==null?void 0:L.toLocaleString())||0]}),t.jsx(se,{children:I.count||0}),t.jsxs(se,{children:["KES"," ",I.count?((I.total_balance||0)/I.count).toLocaleString():0]})]},T)})})]})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Disconnection List (Over 90 Days)"})}),t.jsx(Q,{children:d?t.jsx("p",{className:"text-muted-foreground",children:"Loading disconnection list..."}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Account No"}),t.jsx(ce,{children:"Customer"}),t.jsx(ce,{children:"Balance"}),t.jsx(ce,{children:"Days Overdue"}),t.jsx(ce,{children:"Last Payment"})]})}),t.jsx(mr,{children:(l==null?void 0:l.length)===0?t.jsx(ut,{children:t.jsx(se,{colSpan:5,className:"text-center text-muted-foreground",children:"No accounts for disconnection"})}):l==null?void 0:l.map(T=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:T.account_no}),t.jsx(se,{children:T.customer_name}),t.jsxs(se,{className:"text-red-600 font-bold",children:["KES ",T.balance.toLocaleString()]}),t.jsx(se,{children:T.days_overdue}),t.jsx(se,{children:T.last_payment_date?new Date(T.last_payment_date).toLocaleDateString():"Never"})]},T.account_no))})]})})]})]})]})}function PLe(){const[e,r]=O.useState(null),[n,s]=O.useState(null),[i,l]=O.useState(null),d=O.useRef(null),a=O.useRef(null),f=Nt({mutationFn:k=>Ws.importBilling(k),onSuccess:k=>{l(k),Ge.success("Billing import completed"),r(null),d.current&&(d.current.value="")},onError:k=>{Ge.error(`Billing import failed: ${k.message}`),l({error:k.message})}}),p=Nt({mutationFn:k=>Ws.importMpesa(k),onSuccess:k=>{l(k),Ge.success("M-Pesa import completed"),s(null),a.current&&(a.current.value="")},onError:k=>{Ge.error(`M-Pesa import failed: ${k.message}`),l({error:k.message})}}),y=k=>{r(k),l(null)},v=k=>{s(k),l(null)},j=()=>{e&&f.mutate(e)},w=()=>{n&&p.mutate(n)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Import Center"}),t.jsx("p",{className:"text-muted-foreground",children:"Bulk import billing invoices and M-Pesa payment transactions"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx($n,{className:"h-5 w-5"}),"Billing Invoices"]}),t.jsx(cr,{children:"Upload CSV file containing billing invoices with consumption and charges"})]}),t.jsxs(Q,{className:"space-y-4",children:[t.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center",children:[t.jsx(bc,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),t.jsx("input",{ref:d,type:"file",accept:".csv",onChange:k=>{var S;return y(((S=k.target.files)==null?void 0:S[0])||null)},className:"hidden",id:"billing-upload"}),t.jsx("label",{htmlFor:"billing-upload",children:t.jsx(X,{variant:"outline",asChild:!0,children:t.jsx("span",{children:"Select Billing CSV"})})}),e&&t.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:e.name})]}),e&&t.jsx(X,{onClick:j,disabled:f.isPending,className:"w-full",children:f.isPending?t.jsxs(t.Fragment,{children:[t.jsx(tm,{className:"mr-2 h-4 w-4 animate-spin"}),"Importing..."]}):t.jsxs(t.Fragment,{children:[t.jsx(bc,{className:"mr-2 h-4 w-4"}),"Import Billing Data"]})}),t.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[t.jsx("p",{className:"font-medium",children:"Expected CSV Format:"}),t.jsx("code",{className:"block bg-muted p-2 rounded",children:"account_no,period_start,period_end,consumption,total_amount"})]})]})]}),t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx($n,{className:"h-5 w-5 text-green-600"}),"M-Pesa Transactions"]}),t.jsx(cr,{children:"Upload CSV file containing M-Pesa payment transactions"})]}),t.jsxs(Q,{className:"space-y-4",children:[t.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center",children:[t.jsx(bc,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),t.jsx("input",{ref:a,type:"file",accept:".csv",onChange:k=>{var S;return v(((S=k.target.files)==null?void 0:S[0])||null)},className:"hidden",id:"mpesa-upload"}),t.jsx("label",{htmlFor:"mpesa-upload",children:t.jsx(X,{variant:"outline",asChild:!0,children:t.jsx("span",{children:"Select M-Pesa CSV"})})}),n&&t.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:n.name})]}),n&&t.jsx(X,{onClick:w,disabled:p.isPending,className:"w-full",children:p.isPending?t.jsxs(t.Fragment,{children:[t.jsx(tm,{className:"mr-2 h-4 w-4 animate-spin"}),"Importing..."]}):t.jsxs(t.Fragment,{children:[t.jsx(bc,{className:"mr-2 h-4 w-4"}),"Import M-Pesa Payments"]})}),t.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[t.jsx("p",{className:"font-medium",children:"Expected CSV Format:"}),t.jsx("code",{className:"block bg-muted p-2 rounded",children:"transaction_id,phone,amount,paid_at,account_no"})]})]})]})]}),i&&t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"flex items-center gap-2",children:i.error?t.jsxs(t.Fragment,{children:[t.jsx(Mu,{className:"h-5 w-5 text-red-600"}),"Import Failed"]}):t.jsxs(t.Fragment,{children:[t.jsx(Fs,{className:"h-5 w-5 text-green-600"}),"Import Results"]})})}),t.jsx(Q,{children:i.error?t.jsx("p",{className:"text-red-600",children:i.error}):t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:"Total Records:"}),t.jsx("span",{className:"text-sm",children:i.total||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium text-green-600",children:"Successful:"}),t.jsx("span",{className:"text-sm text-green-600",children:i.success||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium text-red-600",children:"Failed:"}),t.jsx("span",{className:"text-sm text-red-600",children:i.failed||0})]}),(i.duplicates??0)>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm font-medium text-orange-600",children:"Duplicates Skipped:"}),t.jsx("span",{className:"text-sm text-orange-600",children:i.duplicates})]}),i.errors&&i.errors.length>0&&t.jsxs("div",{className:"mt-4",children:[t.jsx("p",{className:"text-sm font-medium mb-2",children:"Errors:"}),t.jsxs("ul",{className:"text-xs text-red-600 space-y-1 max-h-40 overflow-auto",children:[i.errors.slice(0,10).map((k,S)=>t.jsxs("li",{children:[" ",k]},S)),i.errors.length>10&&t.jsxs("li",{children:["... and ",i.errors.length-10," more"]})]})]})]})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Import Guidelines"})}),t.jsxs(Q,{className:"text-sm space-y-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium mb-1",children:"Billing Invoices:"}),t.jsxs("ul",{className:"list-disc list-inside text-muted-foreground space-y-1",children:[t.jsx("li",{children:"CSV format with headers: account_no, period_start, period_end, consumption, total_amount"}),t.jsx("li",{children:"Dates in YYYY-MM-DD format"}),t.jsx("li",{children:"Consumption in cubic meters (m)"}),t.jsx("li",{children:"Amount in KES (no currency symbols)"}),t.jsx("li",{children:"Duplicate invoices for same period will be skipped"})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium mb-1",children:"M-Pesa Payments:"}),t.jsxs("ul",{className:"list-disc list-inside text-muted-foreground space-y-1",children:[t.jsx("li",{children:"CSV format with headers: transaction_id, phone, amount, paid_at, account_no"}),t.jsx("li",{children:"Transaction ID must be unique (duplicates skipped)"}),t.jsx("li",{children:"Phone number in format 254XXXXXXXXX"}),t.jsx("li",{children:"Date in YYYY-MM-DD HH:MM:SS format"}),t.jsx("li",{children:"Account number must exist in the system"})]})]})]})]})]})}const ri="/hydromet",ul={getSources:e=>{const r={};return e!=null&&e.scheme_id&&(r.scheme_id=e.scheme_id),e!=null&&e.kind_id&&(r.kind_id=e.kind_id.toString()),e!=null&&e.status_id&&(r.status_id=e.status_id.toString()),e!=null&&e.search&&(r.search=e.search),e!=null&&e.per_page&&(r.per_page=e.per_page.toString()),xe.get(`${ri}/sources`,r)},getSource:e=>xe.get(`${ri}/sources/${e}`),createSource:e=>xe.post(`${ri}/sources`,e),updateSource:(e,r)=>xe.put(`${ri}/sources/${e}`,r),deleteSource:e=>xe.delete(`${ri}/sources/${e}`),getSourcesNearby:e=>{const r={lat:e.lat.toString(),lon:e.lon.toString()};return e.radius&&(r.radius=e.radius.toString()),xe.get(`${ri}/sources/nearby`,r)},getSourcesInBounds:e=>{const r={min_lat:e.min_lat.toString(),min_lon:e.min_lon.toString(),max_lat:e.max_lat.toString(),max_lon:e.max_lon.toString()};return xe.get(`${ri}/sources/in-bounds`,r)},logAbstraction:(e,r)=>xe.post(`${ri}/sources/${e}/abstraction`,r),getAbstractionHistory:(e,r,n)=>{const s={};return r&&(s.start_date=r),n&&(s.end_date=n),xe.get(`${ri}/sources/${e}/abstraction/history`,s)},getTotalAbstraction:(e,r,n)=>{const s={};return r&&(s.start_date=r),n&&(s.end_date=n),xe.get(`${ri}/sources/${e}/abstraction/total`,s)},getStations:e=>{const r={};return e!=null&&e.scheme_id&&(r.scheme_id=e.scheme_id),e!=null&&e.station_type_id&&(r.station_type_id=e.station_type_id.toString()),(e==null?void 0:e.active)!==void 0&&(r.active=e.active.toString()),e!=null&&e.search&&(r.search=e.search),e!=null&&e.per_page&&(r.per_page=e.per_page.toString()),xe.get(`${ri}/stations`,r)},getStation:e=>xe.get(`${ri}/stations/${e}`),createStation:e=>xe.post(`${ri}/stations`,e),updateStation:(e,r)=>xe.put(`${ri}/stations/${e}`,r),deleteStation:e=>xe.delete(`${ri}/stations/${e}`),getStationsNearby:e=>{const r={lat:e.lat.toString(),lon:e.lon.toString()};return e.radius&&(r.radius=e.radius.toString()),xe.get(`${ri}/stations/nearby`,r)},getStationsInBounds:e=>{const r={min_lat:e.min_lat.toString(),min_lon:e.min_lon.toString(),max_lat:e.max_lat.toString(),max_lon:e.max_lon.toString()};return xe.get(`${ri}/stations/in-bounds`,r)},activateStation:e=>xe.post(`${ri}/stations/${e}/activate`,{}),deactivateStation:e=>xe.post(`${ri}/stations/${e}/deactivate`,{}),getSensors:(e,r)=>{const n={};return r!==void 0&&(n.active=r.toString()),xe.get(`${ri}/stations/${e}/sensors`,n)},createSensor:(e,r)=>xe.post(`${ri}/stations/${e}/sensors`,r),updateSensor:(e,r,n)=>xe.put(`${ri}/stations/${e}/sensors/${r}`,n),deleteSensor:(e,r)=>xe.delete(`${ri}/stations/${e}/sensors/${r}`)},CLe=(e,r)=>ct({queryKey:["hydromet","sources",e],queryFn:()=>ul.getSources(e),...r}),ALe=()=>{const e=Sr();return Nt({mutationFn:r=>ul.createSource(r),onSuccess:()=>{e.invalidateQueries({queryKey:["hydromet","sources"]})}})},kLe=()=>{const e=Sr();return Nt({mutationFn:({id:r,data:n})=>ul.updateSource(r,n),onSuccess:(r,n)=>{e.invalidateQueries({queryKey:["hydromet","sources"]}),e.invalidateQueries({queryKey:["hydromet","sources",n.id]})}})},TLe=()=>{const e=Sr();return Nt({mutationFn:r=>ul.deleteSource(r),onSuccess:()=>{e.invalidateQueries({queryKey:["hydromet","sources"]})}})},ELe=(e,r)=>ct({queryKey:["hydromet","stations",e],queryFn:()=>ul.getStations(e),...r}),MLe=()=>{const e=Sr();return Nt({mutationFn:r=>ul.createStation(r),onSuccess:()=>{e.invalidateQueries({queryKey:["hydromet","stations"]})}})},OLe=()=>{const e=Sr();return Nt({mutationFn:({id:r,data:n})=>ul.updateStation(r,n),onSuccess:(r,n)=>{e.invalidateQueries({queryKey:["hydromet","stations"]}),e.invalidateQueries({queryKey:["hydromet","stations",n.id]})}})},ILe=()=>{const e=Sr();return Nt({mutationFn:r=>ul.deleteStation(r),onSuccess:()=>{e.invalidateQueries({queryKey:["hydromet","stations"]})}})},DLe=()=>{const e=Sr();return Nt({mutationFn:r=>ul.activateStation(r),onSuccess:(r,n)=>{e.invalidateQueries({queryKey:["hydromet","stations"]}),e.invalidateQueries({queryKey:["hydromet","stations",n]})}})},RLe=()=>{const e=Sr();return Nt({mutationFn:r=>ul.deactivateStation(r),onSuccess:(r,n)=>{e.invalidateQueries({queryKey:["hydromet","stations"]}),e.invalidateQueries({queryKey:["hydromet","stations",n]})}})},LLe=(e,r,n)=>ct({queryKey:["hydromet","stations",e,"sensors",r],queryFn:()=>ul.getSensors(e,r),enabled:e!=null,...n}),FLe=()=>{const e=Sr();return Nt({mutationFn:({stationId:r,data:n})=>ul.createSensor(r,n),onSuccess:(r,n)=>{e.invalidateQueries({queryKey:["hydromet","stations",n.stationId,"sensors"]}),e.invalidateQueries({queryKey:["hydromet","stations",n.stationId]})}})},zLe=()=>{const e=Sr();return Nt({mutationFn:({stationId:r,sensorId:n})=>ul.deleteSensor(r,n),onSuccess:(r,n)=>{e.invalidateQueries({queryKey:["hydromet","stations",n.stationId,"sensors"]}),e.invalidateQueries({queryKey:["hydromet","stations",n.stationId]})}})};var YM=["Enter"," "],$Le=["ArrowDown","PageUp","Home"],uZ=["ArrowUp","PageDown","End"],BLe=[...$Le,...uZ],qLe={ltr:[...YM,"ArrowRight"],rtl:[...YM,"ArrowLeft"]},VLe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},cj="Menu",[Ib,ULe,WLe]=v2(cj),[_p,hZ]=Ou(cj,[WLe,P2,B2]),LP=P2(),mZ=B2(),[GLe,bp]=_p(cj),[KLe,dj]=_p(cj),fZ=e=>{const{__scopeMenu:r,open:n=!1,children:s,dir:i,onOpenChange:l,modal:d=!0}=e,a=LP(r),[f,p]=O.useState(null),y=O.useRef(!1),v=Xi(l),j=Iy(i);return O.useEffect(()=>{const w=()=>{y.current=!0,document.addEventListener("pointerdown",k,{capture:!0,once:!0}),document.addEventListener("pointermove",k,{capture:!0,once:!0})},k=()=>y.current=!1;return document.addEventListener("keydown",w,{capture:!0}),()=>{document.removeEventListener("keydown",w,{capture:!0}),document.removeEventListener("pointerdown",k,{capture:!0}),document.removeEventListener("pointermove",k,{capture:!0})}},[]),t.jsx(QV,{...a,children:t.jsx(GLe,{scope:r,open:n,onOpenChange:v,content:f,onContentChange:p,children:t.jsx(KLe,{scope:r,onClose:O.useCallback(()=>v(!1),[v]),isUsingKeyboardRef:y,dir:j,modal:d,children:s})})})};fZ.displayName=cj;var HLe="MenuAnchor",Z4=O.forwardRef((e,r)=>{const{__scopeMenu:n,...s}=e,i=LP(n);return t.jsx(JV,{...i,...s,ref:r})});Z4.displayName=HLe;var Y4="MenuPortal",[ZLe,pZ]=_p(Y4,{forceMount:void 0}),xZ=e=>{const{__scopeMenu:r,forceMount:n,children:s,container:i}=e,l=bp(Y4,r);return t.jsx(ZLe,{scope:r,forceMount:n,children:t.jsx(Do,{present:n||l.open,children:t.jsx(C2,{asChild:!0,container:i,children:s})})})};xZ.displayName=Y4;var Ml="MenuContent",[YLe,X4]=_p(Ml),gZ=O.forwardRef((e,r)=>{const n=pZ(Ml,e.__scopeMenu),{forceMount:s=n.forceMount,...i}=e,l=bp(Ml,e.__scopeMenu),d=dj(Ml,e.__scopeMenu);return t.jsx(Ib.Provider,{scope:e.__scopeMenu,children:t.jsx(Do,{present:s||l.open,children:t.jsx(Ib.Slot,{scope:e.__scopeMenu,children:d.modal?t.jsx(XLe,{...i,ref:r}):t.jsx(QLe,{...i,ref:r})})})})}),XLe=O.forwardRef((e,r)=>{const n=bp(Ml,e.__scopeMenu),s=O.useRef(null),i=yn(r,s);return O.useEffect(()=>{const l=s.current;if(l)return yI(l)},[]),t.jsx(Q4,{...e,ref:i,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ar(e.onFocusOutside,l=>l.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),QLe=O.forwardRef((e,r)=>{const n=bp(Ml,e.__scopeMenu);return t.jsx(Q4,{...e,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Q4=O.forwardRef((e,r)=>{const{__scopeMenu:n,loop:s=!1,trapFocus:i,onOpenAutoFocus:l,onCloseAutoFocus:d,disableOutsidePointerEvents:a,onEntryFocus:f,onEscapeKeyDown:p,onPointerDownOutside:y,onFocusOutside:v,onInteractOutside:j,onDismiss:w,disableOutsideScroll:k,...S}=e,R=bp(Ml,n),D=dj(Ml,n),T=LP(n),I=mZ(n),L=ULe(n),[$,W]=O.useState(null),Z=O.useRef(null),oe=yn(r,Z,R.onContentChange),te=O.useRef(0),be=O.useRef(""),ie=O.useRef(0),ge=O.useRef(null),Ie=O.useRef("right"),Oe=O.useRef(0),Xe=k?T2:O.Fragment,Ue=k?{as:yu,allowPinchZoom:!0}:void 0,tt=ve=>{var It,_r;const rt=be.current+ve,vt=L().filter(St=>!St.disabled),gt=document.activeElement,Et=(It=vt.find(St=>St.ref.current===gt))==null?void 0:It.textValue,tr=vt.map(St=>St.textValue),Dr=dFe(tr,rt,Et),Pr=(_r=vt.find(St=>St.textValue===Dr))==null?void 0:_r.ref.current;(function St(Qt){be.current=Qt,window.clearTimeout(te.current),Qt!==""&&(te.current=window.setTimeout(()=>St(""),1e3))})(rt),Pr&&setTimeout(()=>Pr.focus())};O.useEffect(()=>()=>window.clearTimeout(te.current),[]),lI();const Ce=O.useCallback(ve=>{var vt,gt;return Ie.current===((vt=ge.current)==null?void 0:vt.side)&&hFe(ve,(gt=ge.current)==null?void 0:gt.area)},[]);return t.jsx(YLe,{scope:n,searchRef:be,onItemEnter:O.useCallback(ve=>{Ce(ve)&&ve.preventDefault()},[Ce]),onItemLeave:O.useCallback(ve=>{var rt;Ce(ve)||((rt=Z.current)==null||rt.focus(),W(null))},[Ce]),onTriggerLeave:O.useCallback(ve=>{Ce(ve)&&ve.preventDefault()},[Ce]),pointerGraceTimerRef:ie,onPointerGraceIntentChange:O.useCallback(ve=>{ge.current=ve},[]),children:t.jsx(Xe,{...Ue,children:t.jsx(b2,{asChild:!0,trapped:i,onMountAutoFocus:ar(l,ve=>{var rt;ve.preventDefault(),(rt=Z.current)==null||rt.focus({preventScroll:!0})}),onUnmountAutoFocus:d,children:t.jsx(_2,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:p,onPointerDownOutside:y,onFocusOutside:v,onInteractOutside:j,onDismiss:w,children:t.jsx(tW,{asChild:!0,...I,dir:D.dir,orientation:"vertical",loop:s,currentTabStopId:$,onCurrentTabStopIdChange:W,onEntryFocus:ar(f,ve=>{D.isUsingKeyboardRef.current||ve.preventDefault()}),preventScrollOnEntryFocus:!0,children:t.jsx(eU,{role:"menu","aria-orientation":"vertical","data-state":OZ(R.open),"data-radix-menu-content":"",dir:D.dir,...T,...S,ref:oe,style:{outline:"none",...S.style},onKeyDown:ar(S.onKeyDown,ve=>{const vt=ve.target.closest("[data-radix-menu-content]")===ve.currentTarget,gt=ve.ctrlKey||ve.altKey||ve.metaKey,Et=ve.key.length===1;vt&&(ve.key==="Tab"&&ve.preventDefault(),!gt&&Et&&tt(ve.key));const tr=Z.current;if(ve.target!==tr||!BLe.includes(ve.key))return;ve.preventDefault();const Pr=L().filter(It=>!It.disabled).map(It=>It.ref.current);uZ.includes(ve.key)&&Pr.reverse(),lFe(Pr)}),onBlur:ar(e.onBlur,ve=>{ve.currentTarget.contains(ve.target)||(window.clearTimeout(te.current),be.current="")}),onPointerMove:ar(e.onPointerMove,Db(ve=>{const rt=ve.target,vt=Oe.current!==ve.clientX;if(ve.currentTarget.contains(rt)&&vt){const gt=ve.clientX>Oe.current?"right":"left";Ie.current=gt,Oe.current=ve.clientX}}))})})})})})})});gZ.displayName=Ml;var JLe="MenuGroup",J4=O.forwardRef((e,r)=>{const{__scopeMenu:n,...s}=e;return t.jsx(zr.div,{role:"group",...s,ref:r})});J4.displayName=JLe;var eFe="MenuLabel",yZ=O.forwardRef((e,r)=>{const{__scopeMenu:n,...s}=e;return t.jsx(zr.div,{...s,ref:r})});yZ.displayName=eFe;var HS="MenuItem",X6="menu.itemSelect",FP=O.forwardRef((e,r)=>{const{disabled:n=!1,onSelect:s,...i}=e,l=O.useRef(null),d=dj(HS,e.__scopeMenu),a=X4(HS,e.__scopeMenu),f=yn(r,l),p=O.useRef(!1),y=()=>{const v=l.current;if(!n&&v){const j=new CustomEvent(X6,{bubbles:!0,cancelable:!0});v.addEventListener(X6,w=>s==null?void 0:s(w),{once:!0}),dV(v,j),j.defaultPrevented?p.current=!1:d.onClose()}};return t.jsx(vZ,{...i,ref:f,disabled:n,onClick:ar(e.onClick,y),onPointerDown:v=>{var j;(j=e.onPointerDown)==null||j.call(e,v),p.current=!0},onPointerUp:ar(e.onPointerUp,v=>{var j;p.current||(j=v.currentTarget)==null||j.click()}),onKeyDown:ar(e.onKeyDown,v=>{const j=a.searchRef.current!=="";n||j&&v.key===" "||YM.includes(v.key)&&(v.currentTarget.click(),v.preventDefault())})})});FP.displayName=HS;var vZ=O.forwardRef((e,r)=>{const{__scopeMenu:n,disabled:s=!1,textValue:i,...l}=e,d=X4(HS,n),a=mZ(n),f=O.useRef(null),p=yn(r,f),[y,v]=O.useState(!1),[j,w]=O.useState("");return O.useEffect(()=>{const k=f.current;k&&w((k.textContent??"").trim())},[l.children]),t.jsx(Ib.ItemSlot,{scope:n,disabled:s,textValue:i??j,children:t.jsx(rW,{asChild:!0,...a,focusable:!s,children:t.jsx(zr.div,{role:"menuitem","data-highlighted":y?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...l,ref:p,onPointerMove:ar(e.onPointerMove,Db(k=>{s?d.onItemLeave(k):(d.onItemEnter(k),k.defaultPrevented||k.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ar(e.onPointerLeave,Db(k=>d.onItemLeave(k))),onFocus:ar(e.onFocus,()=>v(!0)),onBlur:ar(e.onBlur,()=>v(!1))})})})}),tFe="MenuCheckboxItem",_Z=O.forwardRef((e,r)=>{const{checked:n=!1,onCheckedChange:s,...i}=e;return t.jsx(SZ,{scope:e.__scopeMenu,checked:n,children:t.jsx(FP,{role:"menuitemcheckbox","aria-checked":ZS(n)?"mixed":n,...i,ref:r,"data-state":tD(n),onSelect:ar(i.onSelect,()=>s==null?void 0:s(ZS(n)?!0:!n),{checkForDefaultPrevented:!1})})})});_Z.displayName=tFe;var bZ="MenuRadioGroup",[rFe,nFe]=_p(bZ,{value:void 0,onValueChange:()=>{}}),jZ=O.forwardRef((e,r)=>{const{value:n,onValueChange:s,...i}=e,l=Xi(s);return t.jsx(rFe,{scope:e.__scopeMenu,value:n,onValueChange:l,children:t.jsx(J4,{...i,ref:r})})});jZ.displayName=bZ;var wZ="MenuRadioItem",NZ=O.forwardRef((e,r)=>{const{value:n,...s}=e,i=nFe(wZ,e.__scopeMenu),l=n===i.value;return t.jsx(SZ,{scope:e.__scopeMenu,checked:l,children:t.jsx(FP,{role:"menuitemradio","aria-checked":l,...s,ref:r,"data-state":tD(l),onSelect:ar(s.onSelect,()=>{var d;return(d=i.onValueChange)==null?void 0:d.call(i,n)},{checkForDefaultPrevented:!1})})})});NZ.displayName=wZ;var eD="MenuItemIndicator",[SZ,sFe]=_p(eD,{checked:!1}),PZ=O.forwardRef((e,r)=>{const{__scopeMenu:n,forceMount:s,...i}=e,l=sFe(eD,n);return t.jsx(Do,{present:s||ZS(l.checked)||l.checked===!0,children:t.jsx(zr.span,{...i,ref:r,"data-state":tD(l.checked)})})});PZ.displayName=eD;var iFe="MenuSeparator",CZ=O.forwardRef((e,r)=>{const{__scopeMenu:n,...s}=e;return t.jsx(zr.div,{role:"separator","aria-orientation":"horizontal",...s,ref:r})});CZ.displayName=iFe;var aFe="MenuArrow",AZ=O.forwardRef((e,r)=>{const{__scopeMenu:n,...s}=e,i=LP(n);return t.jsx(tU,{...i,...s,ref:r})});AZ.displayName=aFe;var oFe="MenuSub",[o6e,kZ]=_p(oFe),e_="MenuSubTrigger",TZ=O.forwardRef((e,r)=>{const n=bp(e_,e.__scopeMenu),s=dj(e_,e.__scopeMenu),i=kZ(e_,e.__scopeMenu),l=X4(e_,e.__scopeMenu),d=O.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:f}=l,p={__scopeMenu:e.__scopeMenu},y=O.useCallback(()=>{d.current&&window.clearTimeout(d.current),d.current=null},[]);return O.useEffect(()=>y,[y]),O.useEffect(()=>{const v=a.current;return()=>{window.clearTimeout(v),f(null)}},[a,f]),t.jsx(Z4,{asChild:!0,...p,children:t.jsx(vZ,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":i.contentId,"data-state":OZ(n.open),...e,ref:p2(r,i.onTriggerChange),onClick:v=>{var j;(j=e.onClick)==null||j.call(e,v),!(e.disabled||v.defaultPrevented)&&(v.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ar(e.onPointerMove,Db(v=>{l.onItemEnter(v),!v.defaultPrevented&&!e.disabled&&!n.open&&!d.current&&(l.onPointerGraceIntentChange(null),d.current=window.setTimeout(()=>{n.onOpenChange(!0),y()},100))})),onPointerLeave:ar(e.onPointerLeave,Db(v=>{var w,k;y();const j=(w=n.content)==null?void 0:w.getBoundingClientRect();if(j){const S=(k=n.content)==null?void 0:k.dataset.side,R=S==="right",D=R?-5:5,T=j[R?"left":"right"],I=j[R?"right":"left"];l.onPointerGraceIntentChange({area:[{x:v.clientX+D,y:v.clientY},{x:T,y:j.top},{x:I,y:j.top},{x:I,y:j.bottom},{x:T,y:j.bottom}],side:S}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>l.onPointerGraceIntentChange(null),300)}else{if(l.onTriggerLeave(v),v.defaultPrevented)return;l.onPointerGraceIntentChange(null)}})),onKeyDown:ar(e.onKeyDown,v=>{var w;const j=l.searchRef.current!=="";e.disabled||j&&v.key===" "||qLe[s.dir].includes(v.key)&&(n.onOpenChange(!0),(w=n.content)==null||w.focus(),v.preventDefault())})})})});TZ.displayName=e_;var EZ="MenuSubContent",MZ=O.forwardRef((e,r)=>{const n=pZ(Ml,e.__scopeMenu),{forceMount:s=n.forceMount,...i}=e,l=bp(Ml,e.__scopeMenu),d=dj(Ml,e.__scopeMenu),a=kZ(EZ,e.__scopeMenu),f=O.useRef(null),p=yn(r,f);return t.jsx(Ib.Provider,{scope:e.__scopeMenu,children:t.jsx(Do,{present:s||l.open,children:t.jsx(Ib.Slot,{scope:e.__scopeMenu,children:t.jsx(Q4,{id:a.contentId,"aria-labelledby":a.triggerId,...i,ref:p,align:"start",side:d.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:y=>{var v;d.isUsingKeyboardRef.current&&((v=f.current)==null||v.focus()),y.preventDefault()},onCloseAutoFocus:y=>y.preventDefault(),onFocusOutside:ar(e.onFocusOutside,y=>{y.target!==a.trigger&&l.onOpenChange(!1)}),onEscapeKeyDown:ar(e.onEscapeKeyDown,y=>{d.onClose(),y.preventDefault()}),onKeyDown:ar(e.onKeyDown,y=>{var w;const v=y.currentTarget.contains(y.target),j=VLe[d.dir].includes(y.key);v&&j&&(l.onOpenChange(!1),(w=a.trigger)==null||w.focus(),y.preventDefault())})})})})})});MZ.displayName=EZ;function OZ(e){return e?"open":"closed"}function ZS(e){return e==="indeterminate"}function tD(e){return ZS(e)?"indeterminate":e?"checked":"unchecked"}function lFe(e){const r=document.activeElement;for(const n of e)if(n===r||(n.focus(),document.activeElement!==r))return}function cFe(e,r){return e.map((n,s)=>e[(r+s)%e.length])}function dFe(e,r,n){const i=r.length>1&&Array.from(r).every(p=>p===r[0])?r[0]:r,l=n?e.indexOf(n):-1;let d=cFe(e,Math.max(l,0));i.length===1&&(d=d.filter(p=>p!==n));const f=d.find(p=>p.toLowerCase().startsWith(i.toLowerCase()));return f!==n?f:void 0}function uFe(e,r){const{x:n,y:s}=e;let i=!1;for(let l=0,d=r.length-1;l<r.length;d=l++){const a=r[l].x,f=r[l].y,p=r[d].x,y=r[d].y;f>s!=y>s&&n<(p-a)*(s-f)/(y-f)+a&&(i=!i)}return i}function hFe(e,r){if(!r)return!1;const n={x:e.clientX,y:e.clientY};return uFe(n,r)}function Db(e){return r=>r.pointerType==="mouse"?e(r):void 0}var mFe=fZ,fFe=Z4,pFe=xZ,xFe=gZ,gFe=J4,yFe=yZ,vFe=FP,_Fe=_Z,bFe=jZ,jFe=NZ,wFe=PZ,NFe=CZ,SFe=AZ,PFe=TZ,CFe=MZ,rD="DropdownMenu",[AFe]=Ou(rD,[hZ]),go=hZ(),[kFe,IZ]=AFe(rD),DZ=e=>{const{__scopeDropdownMenu:r,children:n,dir:s,open:i,defaultOpen:l,onOpenChange:d,modal:a=!0}=e,f=go(r),p=O.useRef(null),[y=!1,v]=Nu({prop:i,defaultProp:l,onChange:d});return t.jsx(kFe,{scope:r,triggerId:ad(),triggerRef:p,contentId:ad(),open:y,onOpenChange:v,onOpenToggle:O.useCallback(()=>v(j=>!j),[v]),modal:a,children:t.jsx(mFe,{...f,open:y,onOpenChange:v,dir:s,modal:a,children:n})})};DZ.displayName=rD;var RZ="DropdownMenuTrigger",LZ=O.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,disabled:s=!1,...i}=e,l=IZ(RZ,n),d=go(n);return t.jsx(fFe,{asChild:!0,...d,children:t.jsx(zr.button,{type:"button",id:l.triggerId,"aria-haspopup":"menu","aria-expanded":l.open,"aria-controls":l.open?l.contentId:void 0,"data-state":l.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...i,ref:p2(r,l.triggerRef),onPointerDown:ar(e.onPointerDown,a=>{!s&&a.button===0&&a.ctrlKey===!1&&(l.onOpenToggle(),l.open||a.preventDefault())}),onKeyDown:ar(e.onKeyDown,a=>{s||(["Enter"," "].includes(a.key)&&l.onOpenToggle(),a.key==="ArrowDown"&&l.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});LZ.displayName=RZ;var TFe="DropdownMenuPortal",FZ=e=>{const{__scopeDropdownMenu:r,...n}=e,s=go(r);return t.jsx(pFe,{...s,...n})};FZ.displayName=TFe;var zZ="DropdownMenuContent",$Z=O.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...s}=e,i=IZ(zZ,n),l=go(n),d=O.useRef(!1);return t.jsx(xFe,{id:i.contentId,"aria-labelledby":i.triggerId,...l,...s,ref:r,onCloseAutoFocus:ar(e.onCloseAutoFocus,a=>{var f;d.current||(f=i.triggerRef.current)==null||f.focus(),d.current=!1,a.preventDefault()}),onInteractOutside:ar(e.onInteractOutside,a=>{const f=a.detail.originalEvent,p=f.button===0&&f.ctrlKey===!0,y=f.button===2||p;(!i.modal||y)&&(d.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});$Z.displayName=zZ;var EFe="DropdownMenuGroup",MFe=O.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...s}=e,i=go(n);return t.jsx(gFe,{...i,...s,ref:r})});MFe.displayName=EFe;var OFe="DropdownMenuLabel",BZ=O.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...s}=e,i=go(n);return t.jsx(yFe,{...i,...s,ref:r})});BZ.displayName=OFe;var IFe="DropdownMenuItem",qZ=O.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...s}=e,i=go(n);return t.jsx(vFe,{...i,...s,ref:r})});qZ.displayName=IFe;var DFe="DropdownMenuCheckboxItem",VZ=O.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...s}=e,i=go(n);return t.jsx(_Fe,{...i,...s,ref:r})});VZ.displayName=DFe;var RFe="DropdownMenuRadioGroup",LFe=O.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...s}=e,i=go(n);return t.jsx(bFe,{...i,...s,ref:r})});LFe.displayName=RFe;var FFe="DropdownMenuRadioItem",UZ=O.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...s}=e,i=go(n);return t.jsx(jFe,{...i,...s,ref:r})});UZ.displayName=FFe;var zFe="DropdownMenuItemIndicator",WZ=O.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...s}=e,i=go(n);return t.jsx(wFe,{...i,...s,ref:r})});WZ.displayName=zFe;var $Fe="DropdownMenuSeparator",GZ=O.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...s}=e,i=go(n);return t.jsx(NFe,{...i,...s,ref:r})});GZ.displayName=$Fe;var BFe="DropdownMenuArrow",qFe=O.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...s}=e,i=go(n);return t.jsx(SFe,{...i,...s,ref:r})});qFe.displayName=BFe;var VFe="DropdownMenuSubTrigger",KZ=O.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...s}=e,i=go(n);return t.jsx(PFe,{...i,...s,ref:r})});KZ.displayName=VFe;var UFe="DropdownMenuSubContent",HZ=O.forwardRef((e,r)=>{const{__scopeDropdownMenu:n,...s}=e,i=go(n);return t.jsx(CFe,{...i,...s,ref:r,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});HZ.displayName=UFe;var WFe=DZ,GFe=LZ,KFe=FZ,ZZ=$Z,YZ=BZ,XZ=qZ,QZ=VZ,JZ=UZ,eY=WZ,tY=GZ,rY=KZ,nY=HZ;const sY=WFe,iY=GFe,HFe=O.forwardRef(({className:e,inset:r,children:n,...s},i)=>t.jsxs(rY,{ref:i,className:gr("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",e),...s,children:[n,t.jsx(Oy,{className:"ml-auto"})]}));HFe.displayName=rY.displayName;const ZFe=O.forwardRef(({className:e,...r},n)=>t.jsx(nY,{ref:n,className:gr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));ZFe.displayName=nY.displayName;const nD=O.forwardRef(({className:e,sideOffset:r=4,...n},s)=>t.jsx(KFe,{children:t.jsx(ZZ,{ref:s,sideOffset:r,className:gr("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));nD.displayName=ZZ.displayName;const kh=O.forwardRef(({className:e,inset:r,...n},s)=>t.jsx(XZ,{ref:s,className:gr("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",r&&"pl-8",e),...n}));kh.displayName=XZ.displayName;const YFe=O.forwardRef(({className:e,children:r,checked:n,...s},i)=>t.jsxs(QZ,{ref:i,className:gr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...s,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(eY,{children:t.jsx(_u,{className:"h-4 w-4"})})}),r]}));YFe.displayName=QZ.displayName;const XFe=O.forwardRef(({className:e,children:r,...n},s)=>t.jsxs(JZ,{ref:s,className:gr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(eY,{children:t.jsx(BT,{className:"h-2 w-2 fill-current"})})}),r]}));XFe.displayName=JZ.displayName;const QFe=O.forwardRef(({className:e,inset:r,...n},s)=>t.jsx(YZ,{ref:s,className:gr("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",e),...n}));QFe.displayName=YZ.displayName;const JFe=O.forwardRef(({className:e,...r},n)=>t.jsx(tY,{ref:n,className:gr("-mx-1 my-1 h-px bg-muted",e),...r}));JFe.displayName=tY.displayName;function aY({latitude:e,longitude:r,onLocationChange:n}){const[s,i]=O.useState({longitude:r!==void 0?r:36.8219,latitude:e!==void 0?e:-1.2921,zoom:10}),[l,d]=O.useState(e!==void 0&&r!==void 0?{lat:e,lon:r}:null),[a,f]=O.useState(e!==void 0?e.toString():""),[p,y]=O.useState(r!==void 0?r.toString():"");O.useEffect(()=>{e!==void 0&&r!==void 0&&(d({lat:e,lon:r}),i(k=>({...k,latitude:e,longitude:r})),f(e.toString()),y(r.toString()))},[e,r]);const v=O.useCallback(k=>{const{lng:S,lat:R}=k.lngLat;d({lat:R,lon:S}),f(R.toFixed(6)),y(S.toFixed(6)),n(R,S)},[n]),j=O.useCallback(()=>{const k=parseFloat(a),S=parseFloat(p);!isNaN(k)&&!isNaN(S)&&k>=-90&&k<=90&&S>=-180&&S<=180&&(d({lat:k,lon:S}),i(R=>({...R,latitude:k,longitude:S})),n(k,S))},[a,p,n]),w=O.useCallback(()=>{d(null),f(""),y(""),n(void 0,void 0)},[n]);return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"manual-lat",children:"Latitude"}),t.jsx(Ve,{id:"manual-lat",type:"number",step:"0.000001",value:a,onChange:k=>f(k.target.value),placeholder:"-1.286389"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"manual-lon",children:"Longitude"}),t.jsx(Ve,{id:"manual-lon",type:"number",step:"0.000001",value:p,onChange:k=>y(k.target.value),placeholder:"36.817223"})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{type:"button",variant:"outline",size:"sm",onClick:j,children:"Update from Coordinates"}),t.jsx(X,{type:"button",variant:"outline",size:"sm",onClick:w,children:"Clear Location"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{children:"Click map to set location"}),t.jsx("div",{style:{height:"300px",width:"100%"},className:"rounded-lg overflow-hidden border",children:t.jsxs(Hb,{...s,onMove:k=>i(k.viewState),onClick:v,mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",style:{width:"100%",height:"100%"},cursor:"crosshair",children:[t.jsx(Zb,{position:"top-right"}),t.jsx(Yb,{position:"bottom-left"}),l&&t.jsx(Nce,{longitude:l.lon,latitude:l.lat,anchor:"bottom",children:t.jsx(Ma,{className:"h-8 w-8 text-red-500",fill:"currentColor"})})]})})]})]})}function e5e({open:e,onClose:r,source:n,isCreating:s}){var y,v;const i=ALe(),l=kLe(),[d,a]=O.useState({name:"",code:"",kind_id:void 0,status_id:void 0,catchment:"",elevation_m:void 0,depth_m:void 0,capacity_m3_per_day:void 0,permit_no:"",latitude:void 0,longitude:void 0});O.useEffect(()=>{var j,w;n&&!s?a({name:n.name,code:n.code,kind_id:n.kind_id,status_id:n.status_id,catchment:n.catchment||"",elevation_m:n.elevation_m||void 0,depth_m:n.depth_m||void 0,capacity_m3_per_day:n.capacity_m3_per_day||void 0,permit_no:n.permit_no||"",latitude:(j=n.location)==null?void 0:j.coordinates[1],longitude:(w=n.location)==null?void 0:w.coordinates[0]}):s&&a({name:"",code:"",kind_id:void 0,status_id:void 0,catchment:"",elevation_m:void 0,depth_m:void 0,capacity_m3_per_day:void 0,permit_no:"",latitude:void 0,longitude:void 0})},[n,s,e]);const f=async j=>{if(j.preventDefault(),!d.name||!d.code||!d.kind_id||!d.status_id){Ge.error("Please fill in all required fields");return}try{s?(await i.mutateAsync(d),Ge.success("Source created successfully")):n&&(await l.mutateAsync({id:n.id,data:d}),Ge.success("Source updated successfully")),r()}catch(w){Ge.error(w.message||`Failed to ${s?"create":"update"} source`)}},p=i.isPending||l.isPending;return t.jsx(Or,{open:e,onOpenChange:r,children:t.jsxs(kr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[t.jsx(Tr,{children:t.jsx(Er,{children:s?"Add New Source":"Edit Source"})}),t.jsxs("form",{onSubmit:f,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"code",children:"Source Code *"}),t.jsx(Ve,{id:"code",value:d.code,onChange:j=>a({...d,code:j.target.value}),placeholder:"e.g., SRC-001",required:!0})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"name",children:"Source Name *"}),t.jsx(Ve,{id:"name",value:d.name,onChange:j=>a({...d,name:j.target.value}),placeholder:"e.g., Kikuyu Borehole",required:!0})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"kind_id",children:"Source Type *"}),t.jsxs($t,{value:(y=d.kind_id)==null?void 0:y.toString(),onValueChange:j=>a({...d,kind_id:parseInt(j)}),children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select type"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"1",children:"Borehole"}),t.jsx(Ne,{value:"2",children:"Spring"}),t.jsx(Ne,{value:"3",children:"River"}),t.jsx(Ne,{value:"4",children:"Dam"}),t.jsx(Ne,{value:"5",children:"Well"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"status_id",children:"Status *"}),t.jsxs($t,{value:(v=d.status_id)==null?void 0:v.toString(),onValueChange:j=>a({...d,status_id:parseInt(j)}),children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select status"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"1",children:"Active"}),t.jsx(Ne,{value:"2",children:"Inactive"}),t.jsx(Ne,{value:"3",children:"Abandoned"})]})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"catchment",children:"Catchment Area"}),t.jsx(Ve,{id:"catchment",value:d.catchment,onChange:j=>a({...d,catchment:j.target.value}),placeholder:"e.g., Tana Basin"})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"elevation_m",children:"Elevation (m)"}),t.jsx(Ve,{id:"elevation_m",type:"number",step:"0.1",value:d.elevation_m||"",onChange:j=>a({...d,elevation_m:j.target.value?parseFloat(j.target.value):void 0}),placeholder:"1500"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"depth_m",children:"Depth (m)"}),t.jsx(Ve,{id:"depth_m",type:"number",step:"0.1",value:d.depth_m||"",onChange:j=>a({...d,depth_m:j.target.value?parseFloat(j.target.value):void 0}),placeholder:"120"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"capacity_m3_per_day",children:"Capacity (m/day)"}),t.jsx(Ve,{id:"capacity_m3_per_day",type:"number",step:"0.1",value:d.capacity_m3_per_day||"",onChange:j=>a({...d,capacity_m3_per_day:j.target.value?parseFloat(j.target.value):void 0}),placeholder:"500"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"permit_no",children:"Permit Number"}),t.jsx(Ve,{id:"permit_no",value:d.permit_no,onChange:j=>a({...d,permit_no:j.target.value}),placeholder:"e.g., WRUA/2023/001"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{children:"Location (PostGIS)"}),t.jsx(aY,{latitude:d.latitude,longitude:d.longitude,onLocationChange:(j,w)=>a({...d,latitude:j,longitude:w})})]}),t.jsxs(Ji,{children:[t.jsx(X,{type:"button",variant:"outline",onClick:r,disabled:p,children:"Cancel"}),t.jsx(X,{type:"submit",disabled:p,children:p?"Saving...":s?"Create Source":"Update Source"})]})]})]})})}function oY({sources:e,stations:r,selectedId:n,onSelect:s,height:i="400px"}){const[l,d]=O.useState({longitude:36.8219,latitude:-1.2921,zoom:8}),a=O.useMemo(()=>e?{type:"FeatureCollection",features:e.filter(y=>y.location).map(y=>{var v,j;return{type:"Feature",id:y.id,geometry:y.location,properties:{id:y.id,name:y.name,code:y.code,kind:((v=y.kind)==null?void 0:v.name)||"Unknown",status:((j=y.status)==null?void 0:j.name)||"Unknown"}}})}:null,[e]),f=O.useMemo(()=>r?{type:"FeatureCollection",features:r.filter(y=>y.location).map(y=>{var v;return{type:"Feature",id:y.id,geometry:y.location,properties:{id:y.id,name:y.name,code:y.code,type:((v=y.station_type)==null?void 0:v.name)||"Unknown",active:y.active}}})}:null,[r]),p=O.useCallback(y=>{const v=y.features;if(v&&v.length>0){const j=v[0],w=j.properties.id,k=j.layer.id;s&&s(w,k==="sources-layer"?"source":"station")}},[s]);return t.jsx("div",{style:{height:i,width:"100%"},className:"rounded-lg overflow-hidden border",children:t.jsxs(Hb,{...l,onMove:y=>d(y.viewState),mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",style:{width:"100%",height:"100%"},interactiveLayerIds:["sources-layer","stations-layer"],onClick:p,children:[t.jsx(Zb,{position:"top-right"}),t.jsx(Yb,{position:"bottom-left"}),a&&t.jsx(W_,{id:"sources",type:"geojson",data:a,children:t.jsx(G_,{id:"sources-layer",type:"circle",paint:{"circle-radius":["case",["==",["get","id"],n],10,6],"circle-color":["match",["get","status"],"Active","#22c55e","Inactive","#94a3b8","Abandoned","#ef4444","#6b7280"],"circle-stroke-width":2,"circle-stroke-color":["case",["==",["get","id"],n],"#000000","#ffffff"]}})}),f&&t.jsx(W_,{id:"stations",type:"geojson",data:f,children:t.jsx(G_,{id:"stations-layer",type:"circle",paint:{"circle-radius":["case",["==",["get","id"],n],10,6],"circle-color":["case",["get","active"],"#3b82f6","#94a3b8"],"circle-stroke-width":2,"circle-stroke-color":["case",["==",["get","id"],n],"#000000","#ffffff"]}})})]})})}function t5e(){const[e,r]=O.useState(""),[n,s]=O.useState(null),[i,l]=O.useState(!1),[d,a]=O.useState(!1),[f,p]=O.useState(!0),{data:y,isLoading:v}=CLe({search:e,per_page:100}),j=TLe(),w=(y==null?void 0:y.data)||[],k=()=>{s(null),a(!0),l(!0)},S=L=>{s(L),a(!1),l(!0)},R=async L=>{if(window.confirm(`Are you sure you want to delete source "${L.name}"?`))try{await j.mutateAsync(L.id),Ge.success("Source deleted successfully")}catch($){Ge.error($.message||"Failed to delete source")}},D=()=>{l(!1),s(null),a(!1)},T=L=>{if(!L)return"secondary";switch(L.name.toLowerCase()){case"active":return"default";case"inactive":return"secondary";case"abandoned":return"destructive";default:return"secondary"}},I=L=>{if(!L)return"secondary";switch(L.name.toLowerCase()){case"low":return"default";case"medium":return"secondary";case"high":return"destructive";default:return"secondary"}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Water Sources Registry"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage water sources and abstraction points"})]}),t.jsxs(X,{onClick:k,children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Add Source"]})]}),f&&w.length>0&&t.jsxs(H,{className:"mb-6",children:[t.jsx(de,{children:t.jsx(he,{children:"Sources Map"})}),t.jsx(Q,{children:t.jsx(oY,{sources:w,selectedId:n==null?void 0:n.id,onSelect:L=>{const $=w.find(W=>W.id===L);$&&s($)},height:"400px"})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx(di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Search sources by name or code...",value:e,onChange:L=>r(L.target.value),className:"pl-10"})]}),t.jsxs(X,{variant:"outline",size:"sm",onClick:()=>p(!f),children:[t.jsx(iu,{className:"mr-2 h-4 w-4"}),f?"Hide":"Show"," Map"]})]})}),t.jsx(Q,{children:v?t.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Loading sources..."}):w.length===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx(Sc,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),t.jsx("p",{className:"text-muted-foreground",children:"No sources found"}),t.jsxs(X,{onClick:k,variant:"outline",className:"mt-4",children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Add your first source"]})]}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Code"}),t.jsx(ce,{children:"Name"}),t.jsx(ce,{children:"Type"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Catchment"}),t.jsx(ce,{children:"Capacity (m/day)"}),t.jsx(ce,{children:"Quality Risk"}),t.jsx(ce,{children:"Location"}),t.jsx(ce,{className:"text-right",children:"Actions"})]})}),t.jsx(mr,{children:w.map(L=>{var $,W,Z;return t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:L.code}),t.jsx(se,{children:L.name}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:(($=L.kind)==null?void 0:$.name)||"N/A"})}),t.jsx(se,{children:t.jsx(Ee,{variant:T(L.status),children:((W=L.status)==null?void 0:W.name)||"Unknown"})}),t.jsx(se,{className:"text-muted-foreground",children:L.catchment||"N/A"}),t.jsx(se,{className:"text-right",children:((Z=L.capacity_m3_per_day)==null?void 0:Z.toLocaleString())||"N/A"}),t.jsx(se,{children:L.quality_risk?t.jsx(Ee,{variant:I(L.quality_risk),children:L.quality_risk.name}):t.jsx("span",{className:"text-muted-foreground",children:"N/A"})}),t.jsx(se,{children:L.location?t.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[t.jsx(Ma,{className:"h-3 w-3"}),t.jsxs("span",{children:[L.location.coordinates[1].toFixed(4),", ",L.location.coordinates[0].toFixed(4)]})]}):t.jsx("span",{className:"text-muted-foreground",children:"N/A"})}),t.jsx(se,{className:"text-right",children:t.jsxs(sY,{children:[t.jsx(iY,{asChild:!0,children:t.jsx(X,{variant:"ghost",size:"sm",children:t.jsx(yV,{className:"h-4 w-4"})})}),t.jsxs(nD,{align:"end",children:[t.jsxs(kh,{onClick:()=>S(L),children:[t.jsx(Dl,{className:"mr-2 h-4 w-4"}),"Edit"]}),t.jsxs(kh,{onClick:()=>R(L),className:"text-destructive",children:[t.jsx(As,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},L.id)})})]})})]}),t.jsx(e5e,{open:i,onClose:D,source:n,isCreating:d})]})}function r5e({open:e,onClose:r,station:n,isCreating:s}){var y,v;const i=MLe(),l=OLe(),[d,a]=O.useState({name:"",code:"",station_type_id:void 0,datasource_id:1,elevation_m:void 0,active:!0,latitude:void 0,longitude:void 0});O.useEffect(()=>{var j,w;n&&!s?a({name:n.name,code:n.code,station_type_id:n.station_type_id,datasource_id:n.datasource_id,elevation_m:n.elevation_m||void 0,active:n.active,latitude:(j=n.location)==null?void 0:j.coordinates[1],longitude:(w=n.location)==null?void 0:w.coordinates[0]}):s&&a({name:"",code:"",station_type_id:void 0,datasource_id:1,elevation_m:void 0,active:!0,latitude:void 0,longitude:void 0})},[n,s,e]);const f=async j=>{if(j.preventDefault(),!d.name||!d.code||!d.station_type_id||!d.datasource_id){Ge.error("Please fill in all required fields");return}try{s?(await i.mutateAsync(d),Ge.success("Station created successfully")):n&&(await l.mutateAsync({id:n.id,data:d}),Ge.success("Station updated successfully")),r()}catch(w){Ge.error(w.message||`Failed to ${s?"create":"update"} station`)}},p=i.isPending||l.isPending;return t.jsx(Or,{open:e,onOpenChange:r,children:t.jsxs(kr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[t.jsx(Tr,{children:t.jsx(Er,{children:s?"Add New Station":"Edit Station"})}),t.jsxs("form",{onSubmit:f,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"code",children:"Station Code *"}),t.jsx(Ve,{id:"code",value:d.code,onChange:j=>a({...d,code:j.target.value}),placeholder:"e.g., HMS-001",required:!0})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"name",children:"Station Name *"}),t.jsx(Ve,{id:"name",value:d.name,onChange:j=>a({...d,name:j.target.value}),placeholder:"e.g., Tana River Flow Station",required:!0})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"station_type_id",children:"Station Type *"}),t.jsxs($t,{value:(y=d.station_type_id)==null?void 0:y.toString(),onValueChange:j=>a({...d,station_type_id:parseInt(j)}),children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select type"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"1",children:"Weather"}),t.jsx(Ne,{value:"2",children:"Hydrological"}),t.jsx(Ne,{value:"3",children:"Rain Gauge"}),t.jsx(Ne,{value:"4",children:"Stream Gauge"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"datasource_id",children:"Data Source *"}),t.jsxs($t,{value:(v=d.datasource_id)==null?void 0:v.toString(),onValueChange:j=>a({...d,datasource_id:parseInt(j)}),children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select source"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"1",children:"Manual Reading"}),t.jsx(Ne,{value:"2",children:"Telemetry"}),t.jsx(Ne,{value:"3",children:"SCADA"})]})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"elevation_m",children:"Elevation (m)"}),t.jsx(Ve,{id:"elevation_m",type:"number",step:"0.1",value:d.elevation_m||"",onChange:j=>a({...d,elevation_m:j.target.value?parseFloat(j.target.value):void 0}),placeholder:"1500"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{children:"Location (PostGIS)"}),t.jsx(aY,{latitude:d.latitude,longitude:d.longitude,onLocationChange:(j,w)=>a({...d,latitude:j,longitude:w})})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Nm,{id:"active",checked:d.active,onCheckedChange:j=>a({...d,active:j})}),t.jsx(Me,{htmlFor:"active",className:"cursor-pointer",children:"Station is active"})]}),t.jsxs(Ji,{children:[t.jsx(X,{type:"button",variant:"outline",onClick:r,disabled:p,children:"Cancel"}),t.jsx(X,{type:"submit",disabled:p,children:p?"Saving...":s?"Create Station":"Update Station"})]})]})]})})}function n5e({station:e,onClose:r}){var w;const[n,s]=O.useState(!1),[i,l]=O.useState({parameter_id:void 0,make:"",model:"",serial_number:""}),{data:d,isLoading:a}=LLe((e==null?void 0:e.id)||null),f=FLe(),p=zLe(),y=async k=>{if(k.preventDefault(),!e||!i.parameter_id){Ge.error("Please select a parameter");return}try{await f.mutateAsync({stationId:e.id,data:i}),Ge.success("Sensor added successfully"),s(!1),l({parameter_id:void 0,make:"",model:"",serial_number:""})}catch(S){Ge.error(S.message||"Failed to add sensor")}},v=async k=>{if(e&&window.confirm("Are you sure you want to delete this sensor?"))try{await p.mutateAsync({stationId:e.id,sensorId:k}),Ge.success("Sensor deleted successfully")}catch(S){Ge.error(S.message||"Failed to delete sensor")}},j=f.isPending;return t.jsx(Or,{open:e!==null,onOpenChange:r,children:t.jsxs(kr,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[t.jsx(Tr,{children:t.jsxs(Er,{children:["Manage Sensors - ",e==null?void 0:e.name]})}),t.jsxs("div",{className:"space-y-4",children:[a?t.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Loading sensors..."}):d&&d.length>0?t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Parameter"}),t.jsx(ce,{children:"Make"}),t.jsx(ce,{children:"Model"}),t.jsx(ce,{children:"Serial Number"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Installed"}),t.jsx(ce,{className:"text-right",children:"Actions"})]})}),t.jsx(mr,{children:d.map(k=>t.jsxs(ut,{children:[t.jsxs(se,{className:"font-medium",children:["Parameter #",k.parameter_id]}),t.jsx(se,{children:k.make||"N/A"}),t.jsx(se,{children:k.model||"N/A"}),t.jsx(se,{className:"font-mono text-sm",children:k.serial_number||"N/A"}),t.jsx(se,{children:t.jsx(Ee,{variant:k.active?"default":"secondary",children:k.active?"Active":"Inactive"})}),t.jsx(se,{className:"text-sm text-muted-foreground",children:k.installed_at?new Date(k.installed_at).toLocaleDateString():"N/A"}),t.jsx(se,{className:"text-right",children:t.jsx(X,{variant:"ghost",size:"sm",onClick:()=>v(k.id),children:t.jsx(As,{className:"h-4 w-4 text-destructive"})})})]},k.id))})]}):t.jsxs("div",{className:"text-center py-8",children:[t.jsx(WT,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),t.jsx("p",{className:"text-muted-foreground",children:"No sensors configured"})]}),n?t.jsxs("form",{onSubmit:y,className:"space-y-4 border rounded-lg p-4",children:[t.jsx("h3",{className:"font-semibold",children:"Add New Sensor"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"parameter_id",children:"Parameter *"}),t.jsxs($t,{value:(w=i.parameter_id)==null?void 0:w.toString(),onValueChange:k=>l({...i,parameter_id:parseInt(k)}),children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select parameter"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"1",children:"Temperature"}),t.jsx(Ne,{value:"2",children:"Rainfall"}),t.jsx(Ne,{value:"3",children:"Water Level"}),t.jsx(Ne,{value:"4",children:"Flow Rate"}),t.jsx(Ne,{value:"5",children:"Humidity"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"make",children:"Make"}),t.jsx(Ve,{id:"make",value:i.make,onChange:k=>l({...i,make:k.target.value}),placeholder:"e.g., Campbell Scientific"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"model",children:"Model"}),t.jsx(Ve,{id:"model",value:i.model,onChange:k=>l({...i,model:k.target.value}),placeholder:"e.g., CS215"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"serial_number",children:"Serial Number"}),t.jsx(Ve,{id:"serial_number",value:i.serial_number,onChange:k=>l({...i,serial_number:k.target.value}),placeholder:"e.g., SN12345"})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{type:"submit",disabled:j,children:j?"Adding...":"Add Sensor"}),t.jsx(X,{type:"button",variant:"outline",onClick:()=>{s(!1),l({parameter_id:void 0,make:"",model:"",serial_number:""})},disabled:j,children:"Cancel"})]})]}):t.jsxs(X,{onClick:()=>s(!0),className:"w-full",children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Add Sensor"]})]})]})})}function s5e(){const[e,r]=O.useState(""),[n,s]=O.useState(null),[i,l]=O.useState(!1),[d,a]=O.useState(!1),[f,p]=O.useState(null),[y,v]=O.useState(!0),{data:j,isLoading:w}=ELe({search:e,per_page:100}),k=ILe(),S=DLe(),R=RLe(),D=(j==null?void 0:j.data)||[],T=()=>{s(null),a(!0),l(!0)},I=te=>{s(te),a(!1),l(!0)},L=async te=>{if(window.confirm(`Are you sure you want to delete station "${te.name}"?`))try{await k.mutateAsync(te.id),Ge.success("Station deleted successfully")}catch(be){Ge.error(be.message||"Failed to delete station")}},$=async te=>{try{await S.mutateAsync(te.id),Ge.success("Station activated successfully")}catch(be){Ge.error(be.message||"Failed to activate station")}},W=async te=>{try{await R.mutateAsync(te.id),Ge.success("Station deactivated successfully")}catch(be){Ge.error(be.message||"Failed to deactivate station")}},Z=te=>{p(te)},oe=()=>{l(!1),s(null),a(!1)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Hydro-Met Stations Registry"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage monitoring stations and sensor networks"})]}),t.jsxs(X,{onClick:T,children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Add Station"]})]}),y&&D.length>0&&t.jsxs(H,{className:"mb-6",children:[t.jsx(de,{children:t.jsx(CardTitle,{children:"Stations Map"})}),t.jsx(Q,{children:t.jsx(oY,{stations:D,selectedId:n==null?void 0:n.id,onSelect:te=>{const be=D.find(ie=>ie.id===te);be&&s(be)},height:"400px"})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx(di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Search stations by name or code...",value:e,onChange:te=>r(te.target.value),className:"pl-10"})]}),t.jsxs(X,{variant:"outline",size:"sm",onClick:()=>v(!y),children:[t.jsx(iu,{className:"mr-2 h-4 w-4"}),y?"Hide":"Show"," Map"]})]})}),t.jsx(Q,{children:w?t.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Loading stations..."}):D.length===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx(WT,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),t.jsx("p",{className:"text-muted-foreground",children:"No stations found"}),t.jsxs(X,{onClick:T,variant:"outline",className:"mt-4",children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Add your first station"]})]}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Code"}),t.jsx(ce,{children:"Name"}),t.jsx(ce,{children:"Type"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Elevation (m)"}),t.jsx(ce,{children:"Sensors"}),t.jsx(ce,{children:"Location"}),t.jsx(ce,{className:"text-right",children:"Actions"})]})}),t.jsx(mr,{children:D.map(te=>{var be,ie,ge;return t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:te.code}),t.jsx(se,{children:te.name}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:((be=te.station_type)==null?void 0:be.name)||"N/A"})}),t.jsx(se,{children:t.jsx(Ee,{variant:te.active?"default":"secondary",children:te.active?"Active":"Inactive"})}),t.jsx(se,{className:"text-right",children:((ie=te.elevation_m)==null?void 0:ie.toFixed(1))||"N/A"}),t.jsx(se,{children:t.jsxs(X,{variant:"ghost",size:"sm",onClick:()=>Z(te),children:[((ge=te.sensors)==null?void 0:ge.length)||0," sensors"]})}),t.jsx(se,{children:te.location?t.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[t.jsx(Ma,{className:"h-3 w-3"}),t.jsxs("span",{children:[te.location.coordinates[1].toFixed(4),", ",te.location.coordinates[0].toFixed(4)]})]}):t.jsx("span",{className:"text-muted-foreground",children:"N/A"})}),t.jsx(se,{className:"text-right",children:t.jsxs(sY,{children:[t.jsx(iY,{asChild:!0,children:t.jsx(X,{variant:"ghost",size:"sm",children:t.jsx(yV,{className:"h-4 w-4"})})}),t.jsxs(nD,{align:"end",children:[t.jsxs(kh,{onClick:()=>I(te),children:[t.jsx(Dl,{className:"mr-2 h-4 w-4"}),"Edit"]}),t.jsxs(kh,{onClick:()=>Z(te),children:[t.jsx(WT,{className:"mr-2 h-4 w-4"}),"Manage Sensors"]}),te.active?t.jsxs(kh,{onClick:()=>W(te),children:[t.jsx(Mne,{className:"mr-2 h-4 w-4"}),"Deactivate"]}):t.jsxs(kh,{onClick:()=>$(te),children:[t.jsx($_,{className:"mr-2 h-4 w-4"}),"Activate"]}),t.jsxs(kh,{onClick:()=>L(te),className:"text-destructive",children:[t.jsx(As,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},te.id)})})]})})]}),t.jsx(r5e,{open:i,onClose:oe,station:n,isCreating:d}),t.jsx(n5e,{station:f,onClose:()=>p(null)})]})}function Q6(){return t.jsxs("div",{className:"flex min-h-screen",children:[t.jsx(Ia,{}),t.jsx("main",{className:"flex-1 p-8 overflow-auto",children:t.jsx(Oa,{})})]})}const fi="/costing",iv={getBudgetVersions:e=>{const r={};return e!=null&&e.fiscal_year&&(r.fiscal_year=e.fiscal_year.toString()),e!=null&&e.status&&(r.status=e.status),xe.get(`${fi}/budgets`,r)},getBudgetVersion:(e,r=!0)=>{const n={};return r!==void 0&&(n.include_lines=r.toString()),xe.get(`${fi}/budgets/${e}`,n)},createBudgetVersion:e=>xe.post(`${fi}/budgets`,e),updateBudgetVersion:(e,r)=>xe.patch(`${fi}/budgets/${e}`,r),deleteBudgetVersion:e=>xe.delete(`${fi}/budgets/${e}`),approveBudgetVersion:e=>xe.post(`${fi}/budgets/${e}/approve`),getBudgetLines:(e,r)=>{const n={};return r!=null&&r.cost_center_id&&(n.cost_center_id=r.cost_center_id.toString()),r!=null&&r.gl_account_id&&(n.gl_account_id=r.gl_account_id.toString()),r!=null&&r.period_from&&(n.period_from=r.period_from),r!=null&&r.period_to&&(n.period_to=r.period_to),xe.get(`${fi}/budgets/${e}/lines`,n)},upsertBudgetLines:(e,r)=>xe.post(`${fi}/budgets/${e}/lines`,{lines:r}),getBudgetSummary:e=>xe.get(`${fi}/budgets/${e}/summary`),getAllocationRules:e=>{const r={};return(e==null?void 0:e.active)!==void 0&&(r.active=e.active.toString()),xe.get(`${fi}/allocation-rules`,r)},createAllocationRule:e=>xe.post(`${fi}/allocation-rules`,e),updateAllocationRule:(e,r)=>xe.patch(`${fi}/allocation-rules/${e}`,r),deleteAllocationRule:e=>xe.delete(`${fi}/allocation-rules/${e}`),getAllocationRuns:e=>{const r={};return e!=null&&e.status&&(r.status=e.status),e!=null&&e.period_from&&(r.period_from=e.period_from),xe.get(`${fi}/allocation-runs`,r)},getAllocationRun:(e,r=!0)=>{const n={};return r!==void 0&&(n.include_results=r.toString()),xe.get(`${fi}/allocation-runs/${e}`,n)},executeAllocationRun:e=>xe.post(`${fi}/allocation-runs`,e),deleteAllocationRun:e=>xe.delete(`${fi}/allocation-runs/${e}`),getCostToServeMetrics:e=>{const r={};return e!=null&&e.period_from&&(r.period_from=e.period_from),e!=null&&e.period_to&&(r.period_to=e.period_to),e!=null&&e.scheme_id&&(r.scheme_id=e.scheme_id.toString()),e!=null&&e.dma_id&&(r.dma_id=e.dma_id.toString()),e!=null&&e.class&&(r.class=e.class),xe.get(`${fi}/cost-to-serve`,r)},calculateCostToServe:e=>xe.post(`${fi}/cost-to-serve`,e),getCostToServeSummary:e=>{const r={};return e!=null&&e.period_from&&(r.period_from=e.period_from),e!=null&&e.period_to&&(r.period_to=e.period_to),e!=null&&e.scheme_id&&(r.scheme_id=e.scheme_id.toString()),xe.get(`${fi}/cost-to-serve/summary`,r)},getDmaLeagueTable:e=>xe.get(`${fi}/cost-to-serve/dma-league/${e}`),getCostToServeTrends:e=>{const r={};return e!=null&&e.period_from&&(r.period_from=e.period_from),e!=null&&e.period_to&&(r.period_to=e.period_to),e!=null&&e.scheme_id&&(r.scheme_id=e.scheme_id.toString()),e!=null&&e.dma_id&&(r.dma_id=e.dma_id.toString()),xe.get(`${fi}/cost-to-serve/trends`,r)}},i5e=(e,r)=>ct({queryKey:["costing","budgets",e],queryFn:()=>iv.getBudgetVersions(e),...r}),a5e=(e,r)=>ct({queryKey:["costing","allocation-rules",e],queryFn:()=>iv.getAllocationRules(e),...r}),o5e=(e,r)=>ct({queryKey:["costing","allocation-runs",e],queryFn:()=>iv.getAllocationRuns(e),...r}),l5e=(e,r)=>ct({queryKey:["costing","cost-to-serve",e],queryFn:()=>iv.getCostToServeMetrics(e),...r}),c5e=(e,r)=>ct({queryKey:["costing","cost-to-serve","summary",e],queryFn:()=>iv.getCostToServeSummary(e),...r}),d5e=(e,r)=>ct({queryKey:["costing","cost-to-serve","dma-league",e],queryFn:()=>iv.getDmaLeagueTable(e),enabled:e!=null,...r});function u5e(){const e=Ey(),[r,n]=O.useState(""),[s,i]=O.useState("all"),l=O.useMemo(()=>s==="all"?{}:{fiscal_year:parseInt(s)},[s]),{data:d,isLoading:a,error:f}=i5e(l),p=w=>{const k={draft:{variant:"secondary",icon:$n},submitted:{variant:"outline",icon:Xs},approved:{variant:"default",icon:_u},archived:{variant:"outline",icon:dne}},S=k[w]||k.draft,R=S.icon;return t.jsxs(Ee,{variant:S.variant,className:"gap-1",children:[t.jsx(R,{className:"h-3 w-3"}),w.charAt(0).toUpperCase()+w.slice(1)]})},y=(d==null?void 0:d.data)||[],v=y.filter(w=>w.name.toLowerCase().includes(r.toLowerCase())),j=O.useMemo(()=>{const w=y.length,k=y.filter(D=>D.status==="approved").length,S=y.filter(D=>D.status==="submitted").length,R=y.filter(D=>D.status==="draft").length;return{total:w,approved:k,pending:S,draft:R}},[y]);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Budget Management"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Create and manage annual budgets with approval workflows"})]}),t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"Create Budget"]})]}),t.jsxs(H,{className:"p-6",children:[t.jsxs("div",{className:"flex gap-4 mb-6",children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx(di,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Search budgets...",value:r,onChange:w=>n(w.target.value),className:"pl-10"})]}),t.jsxs("select",{value:s,onChange:w=>i(w.target.value),className:"px-3 py-2 border rounded-md bg-background",children:[t.jsx("option",{value:"all",children:"All Years"}),t.jsx("option",{value:"2026",children:"FY 2026"}),t.jsx("option",{value:"2025",children:"FY 2025"}),t.jsx("option",{value:"2024",children:"FY 2024"})]})]}),f&&t.jsxs("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded-md mb-4",children:["Error loading budgets: ",f instanceof Error?f.message:"Unknown error"]}),a?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx(tm,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Budget Name"}),t.jsx(ce,{children:"Fiscal Year"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Created"}),t.jsx(ce,{})]})}),t.jsx(mr,{children:v.length===0?t.jsx(ut,{children:t.jsx(se,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No budgets found"})}):v.map(w=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:w.name}),t.jsx(se,{children:w.fiscal_year}),t.jsx(se,{children:p(w.status)}),t.jsx(se,{children:new Date(w.created_at).toLocaleDateString()}),t.jsx(se,{children:t.jsx(X,{variant:"ghost",size:"sm",onClick:()=>e(`/costing/budgets/${w.id}`),children:"View Details"})})]},w.id))})]})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(H,{className:"p-6",children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Budgets"}),t.jsx("div",{className:"text-3xl font-bold mt-2",children:j.total})]}),t.jsxs(H,{className:"p-6",children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"Approved"}),t.jsx("div",{className:"text-3xl font-bold mt-2",children:j.approved})]}),t.jsxs(H,{className:"p-6",children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"Pending Approval"}),t.jsx("div",{className:"text-3xl font-bold mt-2",children:j.pending})]}),t.jsxs(H,{className:"p-6",children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"Draft"}),t.jsx("div",{className:"text-3xl font-bold mt-2",children:j.draft})]})]})]})}function h5e(){const{id:e}=XO(),r=Ey(),[n,s]=O.useState(!1),[i,l]=O.useState(""),d={name:"FY 2025 Operating Budget",fiscal_year:2025,status:"submitted",total_amount:25e5,created_at:"2024-09-15",created_by:{name:"John Smith"}},a=[{month:"2025-01",amount:208333,actuals:195e3,variance:-13333,variance_pct:-6.4},{month:"2025-02",amount:208333,actuals:21e4,variance:1667,variance_pct:.8},{month:"2025-03",amount:208333,actuals:198e3,variance:-10333,variance_pct:-5},{month:"2025-04",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-05",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-06",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-07",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-08",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-09",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-10",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-11",amount:208333,actuals:0,variance:0,variance_pct:0},{month:"2025-12",amount:208333,actuals:0,variance:0,variance_pct:0}],f=[{id:1,cost_center:"Operations",gl_account:"5110 - Electricity",amount:12e4,ytd_actual:35e3},{id:2,cost_center:"Operations",gl_account:"5120 - Chemicals",amount:85e3,ytd_actual:22e3},{id:3,cost_center:"Engineering",gl_account:"5200 - Salaries",amount:48e4,ytd_actual:14e4},{id:4,cost_center:"Finance",gl_account:"5300 - Admin",amount:18e4,ytd_actual:48e3}],p=()=>{console.log("Approving budget with notes:",i),s(!1),r("/costing/budgets")},y=v=>{const j={draft:{variant:"secondary",icon:$n},submitted:{variant:"outline",icon:$n},approved:{variant:"default",icon:_u}},w=j[v]||j.draft,k=w.icon;return t.jsxs(Ee,{variant:w.variant,className:"gap-1",children:[t.jsx(k,{className:"h-3 w-3"}),v.charAt(0).toUpperCase()+v.slice(1)]})};return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs(X,{variant:"ghost",size:"sm",onClick:()=>r("/costing/budgets"),children:[t.jsx(pV,{className:"h-4 w-4 mr-2"}),"Back to Budgets"]})}),t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:d.name}),t.jsxs("p",{className:"text-muted-foreground mt-1",children:["Created by ",d.created_by.name," on ",new Date(d.created_at).toLocaleDateString()]})]}),t.jsxs("div",{className:"flex gap-2",children:[y(d.status),t.jsxs(X,{onClick:()=>s(!0),className:"gap-2",children:[t.jsx(_u,{className:"h-4 w-4"}),"Approve Budget"]})]})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(H,{className:"p-6",children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Budget"}),t.jsxs("div",{className:"text-3xl font-bold mt-2",children:["$",(d.total_amount/1e3).toFixed(0),"K"]})]}),t.jsxs(H,{className:"p-6",children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"YTD Actuals"}),t.jsx("div",{className:"text-3xl font-bold mt-2",children:"$603K"}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"24% of budget"})]}),t.jsxs(H,{className:"p-6",children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"YTD Variance"}),t.jsx("div",{className:"text-3xl font-bold mt-2 text-red-600",children:"-$22K"}),t.jsx("p",{className:"text-xs text-red-600 mt-1",children:"-3.5% unfavorable"})]}),t.jsxs(H,{className:"p-6",children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"Fiscal Year"}),t.jsx("div",{className:"text-3xl font-bold mt-2",children:d.fiscal_year})]})]}),t.jsxs(Sn,{defaultValue:"breakdown",children:[t.jsxs(bn,{children:[t.jsx(kt,{value:"breakdown",children:"Monthly Breakdown"}),t.jsx(kt,{value:"lines",children:"Budget Lines"})]}),t.jsx(Dt,{value:"breakdown",className:"mt-6",children:t.jsxs(H,{className:"p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Monthly Budget vs Actuals"}),t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Month"}),t.jsx(ce,{className:"text-right",children:"Budget"}),t.jsx(ce,{className:"text-right",children:"Actuals"}),t.jsx(ce,{className:"text-right",children:"Variance"}),t.jsx(ce,{className:"text-right",children:"Variance %"})]})}),t.jsx(mr,{children:a.map(v=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:v.month}),t.jsxs(se,{className:"text-right font-mono",children:["$",v.amount.toLocaleString()]}),t.jsx(se,{className:"text-right font-mono",children:v.actuals>0?`$${v.actuals.toLocaleString()}`:"-"}),t.jsx(se,{className:`text-right font-mono ${v.variance<0?"text-red-600":v.variance>0?"text-green-600":""}`,children:v.variance!==0?`$${v.variance.toLocaleString()}`:"-"}),t.jsx(se,{className:"text-right",children:v.variance_pct!==0?t.jsxs(Ee,{variant:v.variance_pct<0?"destructive":"default",className:"gap-1",children:[v.variance_pct<0?t.jsx(Xa,{className:"h-3 w-3"}):t.jsx(xs,{className:"h-3 w-3"}),Math.abs(v.variance_pct).toFixed(1),"%"]}):"-"})]},v.month))})]})]})}),t.jsx(Dt,{value:"lines",className:"mt-6",children:t.jsxs(H,{className:"p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Budget Line Items"}),t.jsx(X,{size:"sm",children:"Add Line"})]}),t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Cost Center"}),t.jsx(ce,{children:"GL Account"}),t.jsx(ce,{className:"text-right",children:"Annual Budget"}),t.jsx(ce,{className:"text-right",children:"YTD Actual"}),t.jsx(ce,{className:"text-right",children:"% Utilized"})]})}),t.jsx(mr,{children:f.map(v=>{const j=v.ytd_actual/v.amount*100;return t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:v.cost_center}),t.jsx(se,{className:"text-sm text-muted-foreground",children:v.gl_account}),t.jsxs(se,{className:"text-right font-mono",children:["$",v.amount.toLocaleString()]}),t.jsxs(se,{className:"text-right font-mono",children:["$",v.ytd_actual.toLocaleString()]}),t.jsx(se,{className:"text-right",children:t.jsxs(Ee,{variant:j>100?"destructive":j>75?"outline":"secondary",children:[j.toFixed(0),"%"]})})]},v.id)})})]})]})})]}),t.jsx(Or,{open:n,onOpenChange:s,children:t.jsxs(kr,{children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:"Approve Budget"}),t.jsxs(Pi,{children:['You are about to approve "',d.name,'". This action will lock the budget for the fiscal year.']})]}),t.jsx("div",{className:"space-y-4 py-4",children:t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Approval Notes (optional)"}),t.jsx(ts,{placeholder:"Add any comments or conditions...",value:i,onChange:v=>l(v.target.value),className:"mt-2",rows:4})]})}),t.jsxs(Ji,{children:[t.jsx(X,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),t.jsx(X,{onClick:p,children:"Approve Budget"})]})]})})]})}function m5e(){const[e,r]=O.useState("rules"),{data:n,isLoading:s,error:i}=a5e({active:!0}),{data:l,isLoading:d,error:a}=o5e(),f=(n==null?void 0:n.data)||[],p=(l==null?void 0:l.data)||[],y=v=>{const j={running:{variant:"secondary",icon:Xs},completed:{variant:"default",icon:Fs},failed:{variant:"destructive",icon:Mu}},w=j[v]||j.running,k=w.icon;return t.jsxs(Ee,{variant:w.variant,className:"gap-1",children:[t.jsx(k,{className:"h-3 w-3"}),v.charAt(0).toUpperCase()+v.slice(1)]})};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Allocation Console"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage cost allocation rules and execute allocation runs"})]}),t.jsxs(X,{className:"gap-2",variant:"default",children:[t.jsx(El,{className:"h-4 w-4"}),"Execute Allocation"]})]}),t.jsxs(Sn,{value:e,onValueChange:r,children:[t.jsxs(bn,{children:[t.jsx(kt,{value:"rules",children:"Allocation Rules"}),t.jsx(kt,{value:"runs",children:"Allocation Runs"})]}),t.jsx(Dt,{value:"rules",className:"mt-6",children:t.jsxs(H,{className:"p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Active Allocation Rules"}),t.jsxs(X,{size:"sm",className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Rule"]})]}),i&&t.jsxs("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded-md mb-4",children:["Error loading rules: ",i instanceof Error?i.message:"Unknown error"]}),s?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx(tm,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):f.length===0?t.jsx("div",{className:"text-center text-muted-foreground py-8",children:'No allocation rules configured. Click "New Rule" to create one.'}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Rule Name"}),t.jsx(ce,{children:"Allocation Basis"}),t.jsx(ce,{children:"Driver/Percentage"}),t.jsx(ce,{children:"Applies To"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{})]})}),t.jsx(mr,{children:f.map(v=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:v.name}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:v.basis.charAt(0).toUpperCase()+v.basis.slice(1)})}),t.jsx(se,{children:v.basis==="driver"&&v.driver?`Driver: ${v.driver.name}`:v.basis==="percentage"&&v.percentage?`${v.percentage}%`:"Equal Split"}),t.jsx(se,{className:"text-sm text-muted-foreground",children:v.applies_to}),t.jsx(se,{children:t.jsx(Ee,{variant:v.active?"default":"secondary",children:v.active?"Active":"Inactive"})}),t.jsx(se,{children:t.jsx(X,{variant:"ghost",size:"sm",children:"Edit"})})]},v.id))})]})]})}),t.jsx(Dt,{value:"runs",className:"mt-6",children:t.jsxs(H,{className:"p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Allocation Run History"}),a&&t.jsxs("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded-md mb-4",children:["Error loading runs: ",a instanceof Error?a.message:"Unknown error"]}),d?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx(tm,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):p.length===0?t.jsx("div",{className:"text-center text-muted-foreground py-8",children:'No allocation runs executed yet. Click "Execute Allocation" to run one.'}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Period"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Started At"}),t.jsx(ce,{children:"Completed At"}),t.jsx(ce,{className:"text-right",children:"Results"}),t.jsx(ce,{})]})}),t.jsx(mr,{children:p.map(v=>{var j;return t.jsxs(ut,{children:[t.jsxs(se,{className:"font-medium",children:[v.period_from," to ",v.period_to]}),t.jsx(se,{children:y(v.status)}),t.jsx(se,{className:"text-sm",children:new Date(v.started_at).toLocaleString()}),t.jsx(se,{className:"text-sm",children:v.completed_at?new Date(v.completed_at).toLocaleString():"-"}),t.jsx(se,{className:"text-right font-mono",children:((j=v.meta)==null?void 0:j.results_count)??0}),t.jsxs(se,{children:[v.status==="completed"&&t.jsx(X,{variant:"ghost",size:"sm",children:"View Results"}),v.status==="failed"&&t.jsx(X,{variant:"ghost",size:"sm",children:"View Error"})]})]},v.id)})})]})]})})]})]})}function f5e(){const[e,r]=O.useState("2025-01"),{data:n,isLoading:s,error:i}=d5e(e),{data:l,isLoading:d,error:a}=c5e({period_from:e,period_to:e}),{data:f,isLoading:p}=l5e({period_from:e,period_to:e}),y=(n==null?void 0:n.data)||[],v=l==null?void 0:l.data,j=(f==null?void 0:f.data)||[],w=O.useMemo(()=>j.length===0?0:j.reduce((R,D)=>R+(D.opex_cost||0)+(D.capex_depr||0)+(D.energy_cost||0)+(D.chemical_cost||0)+(D.other_cost||0),0),[j]),k=O.useMemo(()=>{const R={};return j.forEach(D=>{const T=D.class||"Unclassified";R[T]||(R[T]={class:T,connections:0,volume_m3:0,revenue:0,cost:0,margin:0}),R[T].volume_m3+=D.production_m3||0;const I=(D.revenue_per_m3||0)*(D.billed_m3||0),L=(D.opex_cost||0)+(D.capex_depr||0)+(D.energy_cost||0)+(D.chemical_cost||0)+(D.other_cost||0);R[T].revenue+=I,R[T].cost+=L}),Object.values(R).map(D=>({...D,margin:D.revenue>0?Math.round((D.revenue-D.cost)/D.revenue*100):0}))},[j]),S=R=>R===1?t.jsx(Ee,{variant:"default",className:"bg-green-600",children:" Best"}):R<=3?t.jsxs(Ee,{variant:"outline",children:["#",R]}):t.jsxs(Ee,{variant:"secondary",children:["#",R]});return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Cost-to-Serve Analytics"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"DMA profitability, customer class analysis, and cost trends"})]}),t.jsxs("select",{value:e,onChange:R=>r(R.target.value),className:"px-4 py-2 border rounded-md bg-background",children:[t.jsx("option",{value:"2025-01",children:"January 2025"}),t.jsx("option",{value:"2024-12",children:"December 2024"}),t.jsx("option",{value:"2024-11",children:"November 2024"})]})]}),a&&t.jsxs("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded-md mb-4",children:["Error loading summary: ",a instanceof Error?a.message:"Unknown error"]}),d?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx(tm,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):v?t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(H,{className:"p-6",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[t.jsx(gc,{className:"h-4 w-4"}),"Total Volume"]}),t.jsx("div",{className:"text-3xl font-bold mt-2",children:`${(v.total_production_m3/1e3).toFixed(0)}K m`}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Produced this period"})]}),t.jsxs(H,{className:"p-6",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[t.jsx(co,{className:"h-4 w-4"}),"Total Cost"]}),t.jsxs("div",{className:"text-3xl font-bold mt-2",children:["$",(w/1e3).toFixed(1),"K"]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"All cost categories"})]}),t.jsxs(H,{className:"p-6",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[t.jsx(Xa,{className:"h-4 w-4 text-green-600"}),"Avg Cost/m"]}),t.jsxs("div",{className:"text-3xl font-bold mt-2",children:["$",v.avg_cost_per_m3.toFixed(2)]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Blended rate"})]}),t.jsxs(H,{className:"p-6",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[t.jsx(xs,{className:"h-4 w-4"}),"Non-Revenue Water"]}),t.jsxs("div",{className:"text-3xl font-bold mt-2",children:[v.nrw_percentage.toFixed(1),"%"]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"System losses"})]})]}):null,t.jsxs(H,{className:"p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-6",children:"DMA Cost-to-Serve League Table"}),i&&t.jsxs("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded-md mb-4",children:["Error loading DMA data: ",i instanceof Error?i.message:"Unknown error"]}),s?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx(tm,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):y.length===0?t.jsxs("div",{className:"text-center text-muted-foreground py-8",children:["No DMA data available for ",e]}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Rank"}),t.jsx(ce,{children:"DMA"}),t.jsx(ce,{className:"text-right",children:"Volume (m)"}),t.jsx(ce,{className:"text-right",children:"Total Cost"}),t.jsx(ce,{className:"text-right",children:"Cost per m"}),t.jsx(ce,{children:"Efficiency"})]})}),t.jsx(mr,{children:y.map((R,D)=>t.jsxs(ut,{children:[t.jsx(se,{children:S(D+1)}),t.jsxs(se,{className:"font-medium",children:["DMA-",R.dma_id]}),t.jsx(se,{className:"text-right font-mono",children:(R.production_m3||0).toLocaleString()}),t.jsxs(se,{className:"text-right font-mono",children:["$",((R.cost_per_m3||0)*(R.production_m3||0)).toLocaleString()]}),t.jsxs(se,{className:"text-right font-mono font-bold",children:["$",(R.cost_per_m3||0).toFixed(2)]}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:(R.cost_per_m3||0)<.2?"Excellent":(R.cost_per_m3||0)<.3?"Good":"Review"})})]},R.dma_id||D))})]})]}),t.jsxs(H,{className:"p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Customer Class Profitability"}),p?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx(tm,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):k.length===0?t.jsxs("div",{className:"text-center text-muted-foreground py-8",children:["No customer class data available for ",e]}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Customer Class"}),t.jsx(ce,{className:"text-right",children:"Volume (m)"}),t.jsx(ce,{className:"text-right",children:"Revenue"}),t.jsx(ce,{className:"text-right",children:"Cost"}),t.jsx(ce,{className:"text-right",children:"Margin %"})]})}),t.jsx(mr,{children:k.map(R=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:R.class}),t.jsx(se,{className:"text-right font-mono",children:R.volume_m3.toLocaleString()}),t.jsxs(se,{className:"text-right font-mono",children:["$",R.revenue.toLocaleString()]}),t.jsxs(se,{className:"text-right font-mono",children:["$",R.cost.toLocaleString()]}),t.jsx(se,{className:"text-right",children:t.jsxs(Ee,{variant:R.margin>=70?"default":R.margin>=60?"outline":"secondary",children:[R.margin,"%"]})})]},R.class))})]})]})]})}function p5e(){const[e,r]=O.useState(""),[n,s]=O.useState(new Set(["4"])),i=[{id:"1",code:"1000",name:"Assets",type:"asset",level:0,parent_id:null,active:!0,has_children:!0},{id:"2",code:"2000",name:"Liabilities",type:"liability",level:0,parent_id:null,active:!0,has_children:!1},{id:"3",code:"3000",name:"Equity",type:"equity",level:0,parent_id:null,active:!0,has_children:!1},{id:"4",code:"4000",name:"Revenue",type:"revenue",level:0,parent_id:null,active:!0,has_children:!0},{id:"5",code:"4100",name:"Water Sales",type:"revenue",level:1,parent_id:"4",active:!0,has_children:!0},{id:"6",code:"4110",name:"Residential Water Sales",type:"revenue",level:2,parent_id:"5",active:!0,has_children:!1},{id:"7",code:"4120",name:"Commercial Water Sales",type:"revenue",level:2,parent_id:"5",active:!0,has_children:!1},{id:"8",code:"4200",name:"Connection Fees",type:"revenue",level:1,parent_id:"4",active:!0,has_children:!1},{id:"9",code:"5000",name:"Expenses",type:"expense",level:0,parent_id:null,active:!0,has_children:!0},{id:"10",code:"5100",name:"Operations",type:"expense",level:1,parent_id:"9",active:!0,has_children:!0},{id:"11",code:"5110",name:"Electricity",type:"expense",level:2,parent_id:"10",active:!0,has_children:!1},{id:"12",code:"5120",name:"Chemicals",type:"expense",level:2,parent_id:"10",active:!0,has_children:!1}],l=p=>{const y={asset:"bg-blue-100 text-blue-700",liability:"bg-red-100 text-red-700",equity:"bg-purple-100 text-purple-700",revenue:"bg-green-100 text-green-700",expense:"bg-orange-100 text-orange-700"};return t.jsx(Ee,{className:y[p]||"",children:p.charAt(0).toUpperCase()+p.slice(1)})},d=p=>{const y=new Set(n);y.has(p)?y.delete(p):y.add(p),s(y)},a=p=>{if(!p.parent_id)return!0;const y=i.find(v=>v.id===p.parent_id);return y?n.has(p.parent_id)?a(y):!1:!0},f=i.filter(p=>(e===""||p.code.toLowerCase().includes(e.toLowerCase())||p.name.toLowerCase().includes(e.toLowerCase()))&&a(p));return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"GL Accounts"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Chart of accounts with hierarchical structure"})]}),t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Account"]})]}),t.jsxs(H,{className:"p-6",children:[t.jsxs("div",{className:"mb-6 relative",children:[t.jsx(di,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Search by code or name...",value:e,onChange:p=>r(p.target.value),className:"pl-10"})]}),t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Code"}),t.jsx(ce,{children:"Account Name"}),t.jsx(ce,{children:"Type"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{})]})}),t.jsx(mr,{children:f.map(p=>t.jsxs(ut,{className:p.level>0?"bg-muted/30":"",children:[t.jsx(se,{className:"font-mono font-medium",children:t.jsxs("div",{className:"flex items-center gap-2",children:[p.level>0&&t.jsx("span",{className:"text-muted-foreground",style:{marginLeft:`${p.level*20}px`},children:""}),p.has_children&&t.jsx("button",{onClick:()=>d(p.id),className:"hover:bg-muted rounded p-1",children:t.jsx(Oy,{className:`h-4 w-4 transition-transform ${n.has(p.id)?"rotate-90":""}`})}),p.code]})}),t.jsx(se,{className:"font-medium",children:p.name}),t.jsx(se,{children:l(p.type)}),t.jsx(se,{children:t.jsx(Ee,{variant:p.active?"default":"secondary",children:p.active?"Active":"Inactive"})}),t.jsx(se,{children:t.jsx(X,{variant:"ghost",size:"sm",children:"Edit"})})]},p.id))})]})]}),t.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[t.jsxs(H,{className:"p-4",children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:"Assets"}),t.jsx("div",{className:"text-2xl font-bold mt-1",children:"1"})]}),t.jsxs(H,{className:"p-4",children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:"Liabilities"}),t.jsx("div",{className:"text-2xl font-bold mt-1",children:"1"})]}),t.jsxs(H,{className:"p-4",children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:"Equity"}),t.jsx("div",{className:"text-2xl font-bold mt-1",children:"1"})]}),t.jsxs(H,{className:"p-4",children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:"Revenue"}),t.jsx("div",{className:"text-2xl font-bold mt-1",children:"4"})]}),t.jsxs(H,{className:"p-4",children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:"Expenses"}),t.jsx("div",{className:"text-2xl font-bold mt-1",children:"5"})]})]})]})}function x5e(){const[e,r]=O.useState(""),n=[{id:1,code:"CC-100",name:"Operations",owner:"John Smith",active:!0,parent:null},{id:2,code:"CC-101",name:"Water Production",owner:"Jane Doe",active:!0,parent:"Operations"},{id:3,code:"CC-102",name:"Distribution",owner:"Bob Johnson",active:!0,parent:"Operations"},{id:4,code:"CC-200",name:"Engineering",owner:"Alice Williams",active:!0,parent:null},{id:5,code:"CC-201",name:"Design & Planning",owner:"Charlie Brown",active:!0,parent:"Engineering"},{id:6,code:"CC-300",name:"Finance",owner:"Diana Prince",active:!0,parent:null},{id:7,code:"CC-400",name:"Administration",owner:"Eve Adams",active:!0,parent:null},{id:8,code:"CC-500",name:"Customer Service",owner:"Frank Miller",active:!0,parent:null}],s=n.filter(i=>i.code.toLowerCase().includes(e.toLowerCase())||i.name.toLowerCase().includes(e.toLowerCase())||i.owner&&i.owner.toLowerCase().includes(e.toLowerCase()));return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Cost Centers"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Organizational units for cost tracking and allocation"})]}),t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Cost Center"]})]}),t.jsxs(H,{className:"p-6",children:[t.jsxs("div",{className:"mb-6 relative",children:[t.jsx(di,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Search cost centers...",value:e,onChange:i=>r(i.target.value),className:"pl-10"})]}),t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Code"}),t.jsx(ce,{children:"Cost Center Name"}),t.jsx(ce,{children:"Parent"}),t.jsx(ce,{children:"Owner"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{})]})}),t.jsx(mr,{children:s.length===0?t.jsx(ut,{children:t.jsx(se,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No cost centers found"})}):s.map(i=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-mono font-medium",children:i.code}),t.jsx(se,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(eI,{className:"h-4 w-4 text-muted-foreground"}),t.jsx("span",{className:"font-medium",children:i.name})]})}),t.jsx(se,{className:"text-sm text-muted-foreground",children:i.parent||"-"}),t.jsx(se,{className:"text-sm",children:i.owner||"-"}),t.jsx(se,{children:t.jsx(Ee,{variant:i.active?"default":"secondary",children:i.active?"Active":"Inactive"})}),t.jsx(se,{children:t.jsx(X,{variant:"ghost",size:"sm",children:"Edit"})})]},i.id))})]})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(H,{className:"p-6",children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Cost Centers"}),t.jsx("div",{className:"text-3xl font-bold mt-2",children:n.length})]}),t.jsxs(H,{className:"p-6",children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"Active"}),t.jsx("div",{className:"text-3xl font-bold mt-2",children:n.filter(i=>i.active).length})]}),t.jsxs(H,{className:"p-6",children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"With Owner"}),t.jsx("div",{className:"text-3xl font-bold mt-2",children:n.filter(i=>i.owner).length})]}),t.jsxs(H,{className:"p-6",children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"Parent Centers"}),t.jsx("div",{className:"text-3xl font-bold mt-2",children:n.filter(i=>!i.parent).length})]})]})]})}function g5e(){const[e,r]=O.useState(!1),[n,s]=O.useState({name:"",valid_from:"",valid_to:"",peak_rate:"",offpeak_rate:"",demand_charge:"",currency:"KES"}),i=Sr(),{data:l}=ct({queryKey:["energy-tariffs"],queryFn:async()=>(await fetch("/api/v1/costing/energy/tariffs")).json()}),d=Nt({mutationFn:async p=>{const y=await fetch("/api/v1/costing/energy/tariffs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!y.ok)throw new Error("Failed to create tariff");return y.json()},onSuccess:()=>{i.invalidateQueries({queryKey:["energy-tariffs"]}),r(!1),s({name:"",valid_from:"",valid_to:"",peak_rate:"",offpeak_rate:"",demand_charge:"",currency:"KES"})}}),a=p=>{p.preventDefault(),d.mutate(n)},f=p=>{const y=new Date,v=new Date(p.valid_from),j=p.valid_to?new Date(p.valid_to):null;return v<=y&&(!j||j>=y)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Energy Tariff Setup"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage utility tariff rates for energy cost calculations"})]}),t.jsxs(Or,{open:e,onOpenChange:r,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Tariff"]})}),t.jsxs(kr,{className:"max-w-2xl",children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Create Energy Tariff"})}),t.jsxs("form",{onSubmit:a,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"col-span-2",children:[t.jsx(Me,{htmlFor:"name",children:"Tariff Name *"}),t.jsx(Ve,{id:"name",value:n.name,onChange:p=>s({...n,name:p.target.value}),placeholder:"e.g., KPLC Industrial Rate 2025",required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"valid_from",children:"Valid From *"}),t.jsx(Ve,{id:"valid_from",type:"date",value:n.valid_from,onChange:p=>s({...n,valid_from:p.target.value}),required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"valid_to",children:"Valid To"}),t.jsx(Ve,{id:"valid_to",type:"date",value:n.valid_to,onChange:p=>s({...n,valid_to:p.target.value})})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"peak_rate",children:"Peak Rate (per kWh) *"}),t.jsx(Ve,{id:"peak_rate",type:"number",step:"0.0001",value:n.peak_rate,onChange:p=>s({...n,peak_rate:p.target.value}),placeholder:"15.80",required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"offpeak_rate",children:"Off-Peak Rate (per kWh) *"}),t.jsx(Ve,{id:"offpeak_rate",type:"number",step:"0.0001",value:n.offpeak_rate,onChange:p=>s({...n,offpeak_rate:p.target.value}),placeholder:"8.50",required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"demand_charge",children:"Demand Charge (per kVA)"}),t.jsx(Ve,{id:"demand_charge",type:"number",step:"0.0001",value:n.demand_charge,onChange:p=>s({...n,demand_charge:p.target.value}),placeholder:"450.00"})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"currency",children:"Currency"}),t.jsx(Ve,{id:"currency",value:n.currency,onChange:p=>s({...n,currency:p.target.value}),placeholder:"KES",maxLength:3})]})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:d.isPending,children:d.isPending?"Creating...":"Create Tariff"})]})]})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(Si,{className:"h-5 w-5"}),"Tariff Registry"]})}),t.jsx(Q,{children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Tariff Name"}),t.jsx(ce,{children:"Peak Rate"}),t.jsx(ce,{children:"Off-Peak Rate"}),t.jsx(ce,{children:"Demand Charge"}),t.jsx(ce,{children:"Valid Period"}),t.jsx(ce,{children:"Status"})]})}),t.jsx(mr,{children:l!=null&&l.data&&l.data.length>0?l.data.map(p=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:p.name}),t.jsxs(se,{children:[p.currency," ",parseFloat(p.peak_rate).toFixed(2),"/kWh"]}),t.jsxs(se,{children:[p.currency," ",parseFloat(p.offpeak_rate).toFixed(2),"/kWh"]}),t.jsx(se,{children:p.demand_charge?`${p.currency} ${parseFloat(p.demand_charge).toFixed(2)}/kVA`:"N/A"}),t.jsx(se,{children:t.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[t.jsx(Oo,{className:"h-3 w-3"}),new Date(p.valid_from).toLocaleDateString(),p.valid_to&&` - ${new Date(p.valid_to).toLocaleDateString()}`]})}),t.jsx(se,{children:f(p)?t.jsx(Ee,{className:"bg-green-100 text-green-700",children:"Active"}):t.jsx(Ee,{className:"bg-gray-100 text-gray-700",children:"Inactive"})})]},p.id)):t.jsx(ut,{children:t.jsx(se,{colSpan:6,className:"text-center text-muted-foreground",children:"No tariffs configured yet"})})})]})})]})]})}function y5e(){const[e,r]=O.useState(null),[n,s]=O.useState(""),[i,l]=O.useState(null),d=Nt({mutationFn:async f=>{const p=await fetch("/api/v1/costing/energy/readings/upload",{method:"POST",body:f});if(!p.ok)throw new Error("Upload failed");return p.json()},onSuccess:f=>{l(f.data),r(null)}}),a=f=>{if(f.preventDefault(),!e||!n)return;const p=new FormData;p.append("file",e),p.append("period_month",n),d.mutate(p)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Energy Readings Upload"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Bulk import energy consumption data from CSV files"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(bc,{className:"h-5 w-5"}),"Upload CSV File"]})}),t.jsxs(Q,{children:[t.jsxs("form",{onSubmit:a,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"period",children:"Reporting Period *"}),t.jsx(Ve,{id:"period",type:"month",value:n,onChange:f=>s(f.target.value),required:!0}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Month and year for the readings"})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"file",children:"CSV File *"}),t.jsx(Ve,{id:"file",type:"file",accept:".csv",onChange:f=>{var p;return r(((p=f.target.files)==null?void 0:p[0])||null)},required:!0}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Maximum file size: 10MB"})]}),e&&t.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 border border-blue-200 rounded",children:[t.jsx(Nne,{className:"h-4 w-4 text-blue-600"}),t.jsx("span",{className:"text-sm text-blue-900",children:e.name}),t.jsxs("span",{className:"text-xs text-blue-600 ml-auto",children:[(e.size/1024).toFixed(2)," KB"]})]}),t.jsx(X,{type:"submit",className:"w-full",disabled:d.isPending,children:d.isPending?"Uploading...":"Upload & Process"})]}),i&&t.jsxs("div",{className:"mt-6 space-y-3",children:[t.jsxs(fa,{className:"border-green-200 bg-green-50",children:[t.jsx(bu,{className:"h-4 w-4 text-green-600"}),t.jsxs(ta,{className:"text-green-800",children:[t.jsx("strong",{children:"Success!"})," Imported ",i.imported," of ",i.total_rows," records"]})]}),i.errors&&i.errors.length>0&&t.jsxs(fa,{className:"border-orange-200 bg-orange-50",children:[t.jsx(ps,{className:"h-4 w-4 text-orange-600"}),t.jsxs(ta,{className:"text-orange-800",children:[t.jsxs("strong",{children:[i.errors.length," errors:"]}),t.jsx("ul",{className:"mt-2 text-xs space-y-1 max-h-32 overflow-y-auto",children:i.errors.slice(0,10).map((f,p)=>t.jsxs("li",{children:[" ",f]},p))})]})]})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"CSV Format Requirements"})}),t.jsxs(Q,{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-sm mb-2",children:"Required Columns:"}),t.jsxs("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[t.jsxs("li",{children:[" ",t.jsx("code",{className:"bg-muted px-1 py-0.5 rounded",children:"scheme_name"})," - Scheme identifier"]}),t.jsxs("li",{children:[" ",t.jsx("code",{className:"bg-muted px-1 py-0.5 rounded",children:"kwh"})," - Energy consumption in kWh"]}),t.jsxs("li",{children:[" ",t.jsx("code",{className:"bg-muted px-1 py-0.5 rounded",children:"peak_kwh"})," - Peak period consumption"]}),t.jsxs("li",{children:[" ",t.jsx("code",{className:"bg-muted px-1 py-0.5 rounded",children:"offpeak_kwh"})," - Off-peak consumption"]}),t.jsxs("li",{children:[" ",t.jsx("code",{className:"bg-muted px-1 py-0.5 rounded",children:"demand_kva"})," - Maximum demand"]})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-sm mb-2",children:"Sample CSV:"}),t.jsx("pre",{className:"text-xs bg-muted p-3 rounded overflow-x-auto",children:`scheme_name,kwh,peak_kwh,offpeak_kwh,demand_kva
Nairobi Central,125400,75200,50200,850
Mombasa North,98200,58900,39300,720
Kisumu West,45600,27100,18500,390`})]}),t.jsxs(fa,{children:[t.jsx(ps,{className:"h-4 w-4"}),t.jsx(ta,{className:"text-xs",children:"Make sure all numeric values are valid and scheme names match existing records"})]})]})]})]})]})}function v5e(){const{data:e}=ct({queryKey:["energy-dashboard"],queryFn:async()=>(await fetch("/api/v1/costing/energy/dashboard")).json()}),{data:r}=ct({queryKey:["energy-trend"],queryFn:async()=>(await fetch("/api/v1/costing/energy/specific-energy-trend?months=12")).json()}),n=(e==null?void 0:e.data)||{current_tariff:null,total_consumption_kwh:125400,total_cost:1893600,specific_energy_kwh_m3:.42,cost_per_m3:6.35};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Energy Cost Dashboard"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Energy consumption analytics, specific energy trends, and cost optimization"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Total Consumption"}),t.jsx(Si,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[n.total_consumption_kwh.toLocaleString()," kWh"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"This month"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Total Cost"}),t.jsx(co,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:["KES ",n.total_cost.toLocaleString()]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Energy expenditure"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Specific Energy"}),t.jsx(Ka,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[n.specific_energy_kwh_m3," kWh/m"]}),t.jsxs("p",{className:"text-xs text-green-600 flex items-center gap-1",children:[t.jsx(Xa,{className:"h-3 w-3"}),"Improving efficiency"]})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Cost per m"}),t.jsx(co,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:["KES ",n.cost_per_m3]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Energy cost allocation"})]})]})]}),t.jsxs(Sn,{defaultValue:"specific-energy",className:"w-full",children:[t.jsxs(bn,{className:"grid w-full grid-cols-2",children:[t.jsx(kt,{value:"specific-energy",children:"Specific Energy Trend"}),t.jsx(kt,{value:"cost-breakdown",children:"Cost Breakdown"})]}),t.jsx(Dt,{value:"specific-energy",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Specific Energy (kWh/m) - 12 Month Trend"})}),t.jsx(Q,{children:t.jsx(Za,{width:"100%",height:350,children:t.jsxs(lj,{data:(r==null?void 0:r.data)||[],children:[t.jsx(Io,{strokeDasharray:"3 3"}),t.jsx(xa,{dataKey:"month"}),t.jsx(Bi,{}),t.jsx(Gs,{}),t.jsx(pa,{}),t.jsx(al,{type:"monotone",dataKey:"kwh_per_m3",stroke:"#8884d8",name:"kWh/m"})]})})})]})}),t.jsx(Dt,{value:"cost-breakdown",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Energy Cost per m - 12 Month Trend"})}),t.jsx(Q,{children:t.jsx(Za,{width:"100%",height:350,children:t.jsxs(Ny,{data:(r==null?void 0:r.data)||[],children:[t.jsx(Io,{strokeDasharray:"3 3"}),t.jsx(xa,{dataKey:"month"}),t.jsx(Bi,{}),t.jsx(Gs,{}),t.jsx(pa,{}),t.jsx(Ha,{dataKey:"cost_per_m3",fill:"#82ca9d",name:"Cost per m (KES)"})]})})})]})})]}),n.current_tariff&&t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Current Tariff"})}),t.jsx(Q,{children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Tariff Name"}),t.jsx("p",{className:"font-medium",children:n.current_tariff.name})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Peak Rate"}),t.jsxs("p",{className:"font-medium",children:[n.current_tariff.currency," ",n.current_tariff.peak_rate,"/kWh"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Off-Peak Rate"}),t.jsxs("p",{className:"font-medium",children:[n.current_tariff.currency," ",n.current_tariff.offpeak_rate,"/kWh"]})]})]})})]})]})}function _5e(){const[e,r]=O.useState(!1),[n,s]=O.useState(""),[i,l]=O.useState(""),[d,a]=O.useState([{description:"",quantity:"",unit:"",unit_cost_estimate:""}]),f=Sr(),{data:p}=ct({queryKey:["requisitions"],queryFn:async()=>(await fetch("/api/v1/procurement/requisitions")).json()}),y=Nt({mutationFn:async T=>{const I=await fetch("/api/v1/procurement/requisitions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)});if(!I.ok)throw new Error("Failed to create requisition");return I.json()},onSuccess:()=>{f.invalidateQueries({queryKey:["requisitions"]}),r(!1),j()}}),v=Nt({mutationFn:async T=>{const I=await fetch(`/api/v1/procurement/requisitions/${T}/submit`,{method:"POST"});if(!I.ok)throw new Error("Failed to submit");return I.json()},onSuccess:()=>{f.invalidateQueries({queryKey:["requisitions"]})}}),j=()=>{s(""),l(""),a([{description:"",quantity:"",unit:"",unit_cost_estimate:""}])},w=()=>{a([...d,{description:"",quantity:"",unit:"",unit_cost_estimate:""}])},k=T=>{a(d.filter((I,L)=>L!==T))},S=(T,I,L)=>{const $=[...d];$[T][I]=L,a($)},R=T=>{T.preventDefault();const I=d.filter(L=>L.description&&L.quantity&&L.unit&&L.unit_cost_estimate);y.mutate({justification:n,required_date:i||null,items:I})},D=T=>{const I={draft:"bg-gray-100 text-gray-700",submitted:"bg-blue-100 text-blue-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700"};return t.jsx(Ee,{className:I[T],children:T})};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Purchase Requisitions"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Request procurement of goods and services"})]}),t.jsxs(Or,{open:e,onOpenChange:r,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Requisition"]})}),t.jsxs(kr,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Create Purchase Requisition"})}),t.jsxs("form",{onSubmit:R,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"justification",children:"Justification / Purpose *"}),t.jsx(ts,{id:"justification",value:n,onChange:T=>s(T.target.value),placeholder:"Explain why these items are needed...",rows:3,required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"required_date",children:"Required Date"}),t.jsx(Ve,{id:"required_date",type:"date",value:i,onChange:T=>l(T.target.value)})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx(Me,{children:"Items *"}),t.jsxs(X,{type:"button",variant:"outline",size:"sm",onClick:w,children:[t.jsx(Ot,{className:"h-4 w-4 mr-1"}),"Add Item"]})]}),t.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto border rounded-lg p-3",children:d.map((T,I)=>t.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end p-2 bg-muted/30 rounded",children:[t.jsxs("div",{className:"col-span-5",children:[t.jsx(Me,{className:"text-xs",children:"Description"}),t.jsx(Ve,{value:T.description,onChange:L=>S(I,"description",L.target.value),placeholder:"Item description",required:!0})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx(Me,{className:"text-xs",children:"Quantity"}),t.jsx(Ve,{type:"number",step:"0.01",value:T.quantity,onChange:L=>S(I,"quantity",L.target.value),placeholder:"0",required:!0})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx(Me,{className:"text-xs",children:"Unit"}),t.jsx(Ve,{value:T.unit,onChange:L=>S(I,"unit",L.target.value),placeholder:"pcs, kg, etc",required:!0})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx(Me,{className:"text-xs",children:"Unit Cost"}),t.jsx(Ve,{type:"number",step:"0.01",value:T.unit_cost_estimate,onChange:L=>S(I,"unit_cost_estimate",L.target.value),placeholder:"0.00",required:!0})]}),t.jsx("div",{className:"col-span-1 flex items-end",children:d.length>1&&t.jsx(X,{type:"button",variant:"ghost",size:"sm",onClick:()=>k(I),children:t.jsx(bm,{className:"h-4 w-4"})})})]},I))})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:y.isPending,children:y.isPending?"Creating...":"Create Requisition"})]})]})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(aI,{className:"h-5 w-5"}),"Requisition List"]})}),t.jsx(Q,{children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Requisition No"}),t.jsx(ce,{children:"Requestor"}),t.jsx(ce,{children:"Items"}),t.jsx(ce,{children:"Total Estimate"}),t.jsx(ce,{children:"Required Date"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:p!=null&&p.data&&p.data.length>0?p.data.map(T=>{var I,L;return t.jsxs(ut,{children:[t.jsx(se,{className:"font-mono",children:T.requisition_no}),t.jsx(se,{children:((I=T.requestor)==null?void 0:I.name)||"N/A"}),t.jsxs(se,{children:[((L=T.items)==null?void 0:L.length)||0," items"]}),t.jsxs(se,{children:["KES ",parseFloat(T.total_estimate).toLocaleString()]}),t.jsx(se,{children:T.required_date?new Date(T.required_date).toLocaleDateString():"N/A"}),t.jsx(se,{children:D(T.status)}),t.jsx(se,{children:T.status==="draft"&&t.jsxs(X,{size:"sm",variant:"outline",onClick:()=>v.mutate(T.id),disabled:v.isPending,children:[t.jsx(y2,{className:"h-3 w-3 mr-1"}),"Submit"]})})]},T.id)}):t.jsx(ut,{children:t.jsx(se,{colSpan:7,className:"text-center text-muted-foreground",children:"No requisitions yet"})})})]})})]})]})}function b5e(){var S,R,D;const[e,r]=O.useState(!1),[n,s]=O.useState(null),[i,l]=O.useState({title:"",description:"",issue_date:"",submission_deadline:"",items:[{description:"",quantity:"",unit:"",specifications:""}],vendor_ids:[]}),d=Sr(),{data:a}=ct({queryKey:["rfqs"],queryFn:async()=>(await fetch("/api/v1/procurement/rfqs")).json()}),{data:f}=ct({queryKey:["vendors"],queryFn:async()=>(await fetch("/api/v1/procurement/vendors?status=active")).json()}),{data:p}=ct({queryKey:["rfq",n],queryFn:async()=>(await fetch(`/api/v1/procurement/rfqs/${n}`)).json(),enabled:!!n}),{data:y}=ct({queryKey:["rfq-evaluation",n],queryFn:async()=>(await fetch(`/api/v1/procurement/rfqs/${n}/evaluation-matrix`)).json(),enabled:!!n&&((S=p==null?void 0:p.data)==null?void 0:S.status)==="evaluating"}),v=Nt({mutationFn:async T=>{const I=await fetch("/api/v1/procurement/rfqs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)});if(!I.ok)throw new Error("Failed to create RFQ");return I.json()},onSuccess:()=>{d.invalidateQueries({queryKey:["rfqs"]}),r(!1)}}),j=Nt({mutationFn:async T=>{const I=await fetch(`/api/v1/procurement/rfqs/${T}/issue`,{method:"POST"});if(!I.ok)throw new Error("Failed to issue RFQ");return I.json()},onSuccess:()=>{d.invalidateQueries({queryKey:["rfqs"]})}}),w=T=>{T.preventDefault(),v.mutate(i)},k=T=>{const I={draft:"bg-gray-100 text-gray-700",issued:"bg-blue-100 text-blue-700",evaluating:"bg-orange-100 text-orange-700",awarded:"bg-green-100 text-green-700"};return t.jsx(Ee,{className:I[T],children:T})};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"RFQ Management"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Create RFQs, invite vendors, and evaluate bids"})]}),t.jsxs(Or,{open:e,onOpenChange:r,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New RFQ"]})}),t.jsxs(kr,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Create Request for Quotation"})}),t.jsxs("form",{onSubmit:w,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"col-span-2",children:[t.jsx(Me,{htmlFor:"title",children:"RFQ Title *"}),t.jsx(Ve,{id:"title",value:i.title,onChange:T=>l({...i,title:T.target.value}),placeholder:"e.g., Supply of Water Treatment Chemicals",required:!0})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx(Me,{htmlFor:"description",children:"Description"}),t.jsx(ts,{id:"description",value:i.description,onChange:T=>l({...i,description:T.target.value}),rows:3})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"issue_date",children:"Issue Date *"}),t.jsx(Ve,{id:"issue_date",type:"date",value:i.issue_date,onChange:T=>l({...i,issue_date:T.target.value}),required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"deadline",children:"Submission Deadline *"}),t.jsx(Ve,{id:"deadline",type:"date",value:i.submission_deadline,onChange:T=>l({...i,submission_deadline:T.target.value}),required:!0})]})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Invite Vendors"}),t.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2 max-h-32 overflow-y-auto border rounded p-2",children:(R=f==null?void 0:f.data)==null?void 0:R.map(T=>t.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[t.jsx("input",{type:"checkbox",checked:i.vendor_ids.includes(T.id),onChange:I=>{I.target.checked?l({...i,vendor_ids:[...i.vendor_ids,T.id]}):l({...i,vendor_ids:i.vendor_ids.filter(L=>L!==T.id)})}}),T.name]},T.id))})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:v.isPending,children:v.isPending?"Creating...":"Create RFQ"})]})]})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx($n,{className:"h-5 w-5"}),"RFQ List"]})}),t.jsx(Q,{children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"RFQ No"}),t.jsx(ce,{children:"Title"}),t.jsx(ce,{children:"Issue Date"}),t.jsx(ce,{children:"Deadline"}),t.jsx(ce,{children:"Invitations"}),t.jsx(ce,{children:"Bids"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:a!=null&&a.data&&a.data.length>0?a.data.map(T=>t.jsxs(ut,{className:"cursor-pointer",onClick:()=>s(T.id),children:[t.jsx(se,{className:"font-mono",children:T.rfq_no}),t.jsx(se,{className:"font-medium",children:T.title}),t.jsx(se,{children:new Date(T.issue_date).toLocaleDateString()}),t.jsx(se,{children:new Date(T.submission_deadline).toLocaleDateString()}),t.jsx(se,{children:t.jsxs(Ee,{variant:"outline",children:[T.invitations_count||0," vendors"]})}),t.jsx(se,{children:t.jsxs(Ee,{variant:"outline",children:[T.bids_count||0," bids"]})}),t.jsx(se,{children:k(T.status)}),t.jsx(se,{onClick:I=>I.stopPropagation(),children:T.status==="draft"&&t.jsxs(X,{size:"sm",variant:"outline",onClick:()=>j.mutate(T.id),children:[t.jsx(y2,{className:"h-3 w-3 mr-1"}),"Issue"]})})]},T.id)):t.jsx(ut,{children:t.jsx(se,{colSpan:8,className:"text-center text-muted-foreground",children:"No RFQs yet"})})})]})})]}),(p==null?void 0:p.data)&&t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(F_,{className:"h-5 w-5"}),"RFQ Details: ",p.data.rfq_no]})}),t.jsx(Q,{children:t.jsxs(Sn,{defaultValue:"overview",children:[t.jsxs(bn,{children:[t.jsx(kt,{value:"overview",children:"Overview"}),t.jsxs(kt,{value:"bids",children:["Bids (",((D=p.data.bids)==null?void 0:D.length)||0,")"]}),p.data.status==="evaluating"&&t.jsx(kt,{value:"evaluation",children:"Evaluation Matrix"})]}),t.jsxs(Dt,{value:"overview",className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Title"}),t.jsx("p",{className:"font-medium",children:p.data.title})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),k(p.data.status)]})]}),p.data.description&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Description"}),t.jsx("p",{children:p.data.description})]})]}),t.jsx(Dt,{value:"bids",children:p.data.bids&&p.data.bids.length>0?t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Vendor"}),t.jsx(ce,{children:"Bid Amount"}),t.jsx(ce,{children:"Delivery Days"}),t.jsx(ce,{children:"Submitted"})]})}),t.jsx(mr,{children:p.data.bids.map(T=>{var I;return t.jsxs(ut,{children:[t.jsx(se,{children:(I=T.vendor)==null?void 0:I.name}),t.jsxs(se,{children:["KES ",parseFloat(T.total_bid_amount).toLocaleString()]}),t.jsxs(se,{children:[T.delivery_days," days"]}),t.jsx(se,{children:new Date(T.submitted_at).toLocaleString()})]},T.id)})})]}):t.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No bids submitted yet"})}),p.data.status==="evaluating"&&t.jsx(Dt,{value:"evaluation",children:y!=null&&y.data&&y.data.length>0?t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Rank"}),t.jsx(ce,{children:"Vendor"}),t.jsx(ce,{children:"Bid Amount"}),t.jsx(ce,{children:"Weighted Score"}),t.jsx(ce,{children:"Delivery"})]})}),t.jsx(mr,{children:y.data.map(T=>t.jsxs(ut,{children:[t.jsx(se,{children:t.jsxs(Ee,{className:T.rank===1?"bg-green-100 text-green-700":"",children:["#",T.rank]})}),t.jsx(se,{className:"font-medium",children:T.vendor_name}),t.jsxs(se,{children:["KES ",parseFloat(T.bid_amount).toLocaleString()]}),t.jsx(se,{children:t.jsxs("div",{className:"font-bold text-blue-600",children:[T.weighted_total,"/100"]})}),t.jsxs(se,{children:[T.delivery_days," days"]})]},T.vendor_id))})]}):t.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No evaluations yet"})})]})})]})]})}function j5e(){var R;const[e,r]=O.useState(!1),[n,s]=O.useState(""),[i,l]=O.useState(""),[d,a]=O.useState("Standard payment terms: Net 30 days"),f=Sr(),{data:p}=ct({queryKey:["lpos"],queryFn:async()=>(await fetch("/api/v1/procurement/lpos")).json()}),{data:y}=ct({queryKey:["awarded-rfqs"],queryFn:async()=>(await fetch("/api/v1/procurement/rfqs?status=awarded")).json()}),v=Nt({mutationFn:async D=>{const T=await fetch("/api/v1/procurement/lpos/generate-from-rfq",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)});if(!T.ok)throw new Error("Failed to generate LPO");return T.json()},onSuccess:()=>{f.invalidateQueries({queryKey:["lpos"]}),f.invalidateQueries({queryKey:["awarded-rfqs"]}),r(!1),s(""),l("")}}),j=Nt({mutationFn:async D=>{const T=await fetch(`/api/v1/procurement/lpos/${D}/approve`,{method:"POST"});if(!T.ok)throw new Error("Failed to approve");return T.json()},onSuccess:()=>{f.invalidateQueries({queryKey:["lpos"]})}}),w=Nt({mutationFn:async D=>{const T=await fetch(`/api/v1/procurement/lpos/${D}/issue`,{method:"POST"});if(!T.ok)throw new Error("Failed to issue");return T.json()},onSuccess:()=>{f.invalidateQueries({queryKey:["lpos"]})}}),k=D=>{D.preventDefault(),v.mutate({rfq_id:n,delivery_date:i,terms_conditions:d})},S=D=>{const T={draft:"bg-gray-100 text-gray-700",approved:"bg-blue-100 text-blue-700",issued:"bg-green-100 text-green-700",delivered:"bg-purple-100 text-purple-700",cancelled:"bg-red-100 text-red-700"};return t.jsx(Ee,{className:T[D],children:D})};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Local Purchase Orders"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Generate and manage LPOs from awarded RFQs"})]}),t.jsxs(Or,{open:e,onOpenChange:r,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{className:"gap-2",children:[t.jsx($n,{className:"h-4 w-4"}),"Generate from RFQ"]})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Generate LPO from Awarded RFQ"})}),t.jsxs("form",{onSubmit:k,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"rfq",children:"Select Awarded RFQ *"}),t.jsxs("select",{id:"rfq",className:"w-full border rounded-md p-2",value:n,onChange:D=>s(D.target.value),required:!0,children:[t.jsx("option",{value:"",children:"-- Select RFQ --"}),(R=y==null?void 0:y.data)==null?void 0:R.map(D=>{var T;return t.jsxs("option",{value:D.id,children:[D.rfq_no," - ",D.title," (Vendor: ",(T=D.awarded_vendor)==null?void 0:T.name,")"]},D.id)})]})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"delivery_date",children:"Expected Delivery Date *"}),t.jsx(Ve,{id:"delivery_date",type:"date",value:i,onChange:D=>l(D.target.value),required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"terms",children:"Terms & Conditions"}),t.jsx(ts,{id:"terms",value:d,onChange:D=>a(D.target.value),rows:4})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsx(X,{type:"submit",disabled:v.isPending,children:v.isPending?"Generating...":"Generate LPO"})]})]})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx($n,{className:"h-5 w-5"}),"LPO List"]})}),t.jsx(Q,{children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"LPO No"}),t.jsx(ce,{children:"Vendor"}),t.jsx(ce,{children:"RFQ Reference"}),t.jsx(ce,{children:"Order Date"}),t.jsx(ce,{children:"Delivery Date"}),t.jsx(ce,{children:"Total Amount"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:p!=null&&p.data&&p.data.length>0?p.data.map(D=>{var T;return t.jsxs(ut,{children:[t.jsx(se,{className:"font-mono font-medium",children:D.lpo_no}),t.jsx(se,{children:((T=D.vendor)==null?void 0:T.name)||"N/A"}),t.jsx(se,{children:D.rfq?t.jsx("span",{className:"text-sm text-muted-foreground",children:D.rfq.rfq_no}):"Direct"}),t.jsx(se,{children:new Date(D.order_date).toLocaleDateString()}),t.jsx(se,{children:D.delivery_date?new Date(D.delivery_date).toLocaleDateString():"N/A"}),t.jsxs(se,{className:"font-medium",children:["KES ",parseFloat(D.total_amount).toLocaleString()]}),t.jsx(se,{children:S(D.status)}),t.jsx(se,{children:t.jsxs("div",{className:"flex gap-1",children:[D.status==="draft"&&t.jsxs(X,{size:"sm",variant:"outline",onClick:()=>j.mutate(D.id),disabled:j.isPending,children:[t.jsx(Fs,{className:"h-3 w-3 mr-1"}),"Approve"]}),D.status==="approved"&&t.jsxs(X,{size:"sm",variant:"outline",onClick:()=>w.mutate(D.id),disabled:w.isPending,children:[t.jsx(y2,{className:"h-3 w-3 mr-1"}),"Issue"]}),D.status==="issued"&&t.jsxs(X,{size:"sm",variant:"outline",children:[t.jsx(Ta,{className:"h-3 w-3 mr-1"}),"PDF"]})]})})]},D.id)}):t.jsx(ut,{children:t.jsx(se,{colSpan:8,className:"text-center text-muted-foreground",children:"No LPOs yet"})})})]})})]}),t.jsx(H,{className:"bg-blue-50 border-blue-200",children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"LPO Workflow"}),t.jsxs("div",{className:"flex items-center gap-4 text-sm text-blue-700",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-200 flex items-center justify-center font-bold",children:"1"}),t.jsx("span",{children:"Generate from RFQ"})]}),t.jsx("div",{className:"text-blue-400",children:""}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-200 flex items-center justify-center font-bold",children:"2"}),t.jsx("span",{children:"Approve"})]}),t.jsx("div",{className:"text-blue-400",children:""}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-200 flex items-center justify-center font-bold",children:"3"}),t.jsx("span",{children:"Issue to Vendor"})]}),t.jsx("div",{className:"text-blue-400",children:""}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-200 flex items-center justify-center font-bold",children:"4"}),t.jsx("span",{children:"Track Delivery"})]})]})]})})]})}function w5e(){return t.jsxs("div",{className:"flex min-h-screen",children:[t.jsx(Ia,{}),t.jsx("main",{className:"flex-1 p-8 overflow-auto",children:t.jsx(Oa,{})})]})}function N5e(){return t.jsxs("div",{className:"flex min-h-screen",children:[t.jsx(Ia,{}),t.jsx("main",{className:"flex-1 p-8 overflow-auto",children:t.jsx(Oa,{})})]})}function S5e(){return t.jsxs("div",{className:"flex min-h-screen",children:[t.jsx(Ia,{}),t.jsx("main",{className:"flex-1 p-8 overflow-auto",children:t.jsx(Oa,{})})]})}function P5e(){return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Capital Projects"}),t.jsx("p",{className:"text-muted-foreground mt-2",children:"Infrastructure development and capital investment tracking"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"New Project"]})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Active Projects"}),t.jsx(xV,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"12"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"+2 from last month"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Total Budget"}),t.jsx(co,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"KES 45.2M"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all active projects"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Budget Utilization"}),t.jsx(xs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"68.4%"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"+12% from last month"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Due This Month"}),t.jsx(Oo,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"3"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Project milestones"})]})]})]}),t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"Module 9: Projects & Capital Planning"}),t.jsx(cr,{children:"Comprehensive capital project management and financial tracking"})]}),t.jsxs(Q,{className:"space-y-4",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"This module will provide complete infrastructure project lifecycle management including:"}),t.jsxs("ul",{className:"text-sm space-y-2 list-disc list-inside text-muted-foreground",children:[t.jsx("li",{children:"Project registry with status tracking and milestone management"}),t.jsx("li",{children:"Budget planning and allocation with Module 11 integration"}),t.jsx("li",{children:"Procurement tracking and contract management"}),t.jsx("li",{children:"Progress monitoring with financial and physical completion metrics"}),t.jsx("li",{children:"Risk management and issue tracking"}),t.jsx("li",{children:"Document repository and stakeholder communications"}),t.jsx("li",{children:"Geographic project mapping with GIS integration"})]}),t.jsxs("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:[t.jsx("p",{className:"text-sm font-medium",children:"Status: Planning Phase"}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Module 9 integration with Module 11 (Costing) database schema is ready. Frontend pages and API endpoints are scheduled for implementation."})]})]})]})]})}function C5e(){return t.jsxs("div",{className:"flex h-screen bg-background",children:[t.jsx(Ia,{}),t.jsx("main",{className:"flex-1 overflow-auto",children:t.jsx(Oa,{})})]})}function A5e(){return t.jsxs("div",{className:"flex h-screen bg-background",children:[t.jsx(Ia,{}),t.jsx("main",{className:"flex-1 overflow-auto",children:t.jsx(Oa,{})})]})}function k5e(){return t.jsxs("div",{className:"flex h-screen overflow-hidden",children:[t.jsx(Ia,{}),t.jsx("main",{className:"flex-1 overflow-y-auto",children:t.jsx(Oa,{})})]})}function T5e(){return t.jsxs("div",{className:"flex h-screen overflow-hidden",children:[t.jsx(Ia,{}),t.jsx("main",{className:"flex-1 overflow-y-auto",children:t.jsx(Oa,{})})]})}function E5e(){return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Users & Sessions"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage user accounts, roles, 2FA, and active sessions"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Add User"]})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx(di,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Search users by name, email...",className:"pl-10"})]}),t.jsx(X,{variant:"outline",children:"Filters"}),t.jsx(X,{variant:"outline",children:"Export"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Total Users"}),t.jsx(Hs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"0"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all tenants"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Active Sessions"}),t.jsx(jN,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"0"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently logged in"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"2FA Enabled"}),t.jsx(wi,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"0%"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Security coverage"})]})]})]}),t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"User Directory"}),t.jsx(cr,{children:"View and manage user accounts"})]}),t.jsx(Q,{children:t.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[t.jsx(Hs,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),t.jsx("p",{children:"No users found. Run database migrations to create tables."})]})})]})]})}function M5e(){const e=[{id:"admin",name:"Administrator",description:"Full system access and configuration",permissions:"All",color:"bg-red-500"},{id:"manager",name:"Manager",description:"Operational management and oversight",permissions:"Core Registry, Core Ops, CRM, Projects",color:"bg-blue-500"},{id:"operator",name:"Operator",description:"Day-to-day operational tasks",permissions:"Core Ops, CMMS, Water Quality",color:"bg-green-500"},{id:"analyst",name:"Analyst",description:"Data analysis and reporting",permissions:"DSA, M&E, Costing, Analytics",color:"bg-purple-500"},{id:"viewer",name:"Viewer",description:"Read-only access to dashboards",permissions:"Core Registry, M&E, DSA",color:"bg-gray-500"}];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Roles & Permissions Management"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage system roles, permissions, and menu access control"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Create Role"]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map(r=>t.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[t.jsx(de,{className:"pb-3",children:t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`${r.color} text-white p-3 rounded-lg`,children:t.jsx(Hs,{className:"h-5 w-5"})}),t.jsxs("div",{children:[t.jsx(he,{className:"text-lg",children:r.name}),t.jsx("p",{className:"text-sm text-muted-foreground",children:r.description})]})]})})}),t.jsxs(Q,{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-semibold text-muted-foreground mb-2",children:"ACCESSIBLE MODULES:"}),t.jsx("div",{className:"flex flex-wrap gap-1",children:r.permissions.split(", ").map(n=>t.jsx(Ee,{variant:"secondary",className:"text-xs",children:n},n))})]}),t.jsxs("div",{className:"flex gap-2 pt-3",children:[t.jsx(X,{variant:"outline",size:"sm",className:"flex-1",children:"Edit"}),t.jsx(X,{variant:"outline",size:"sm",className:"flex-1",children:"Permissions"})]})]})]},r.id))}),t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(wi,{className:"h-5 w-5"}),"System Roles Overview"]}),t.jsx(cr,{children:"Each role has specific module access and granular permissions"})]}),t.jsx(Q,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"p-4 border rounded-lg",children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Roles"}),t.jsx("p",{className:"text-3xl font-bold mt-2",children:"5"})]}),t.jsxs("div",{className:"p-4 border rounded-lg",children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Users Assigned"}),t.jsx("p",{className:"text-3xl font-bold mt-2",children:"24"})]}),t.jsxs("div",{className:"p-4 border rounded-lg",children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Permissions Configured"}),t.jsx("p",{className:"text-3xl font-bold mt-2",children:"142"})]})]}),t.jsx("p",{className:"text-sm text-muted-foreground",children:'For detailed permission management and role hierarchy, see Roles & Permissions in the Admin menu. Use the "Role & Menu Access" option to control which modules each role can access.'})]})})]})]})}function O5e(){return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Permission Matrix"}),t.jsx("p",{className:"text-muted-foreground",children:"Grid view of roles  permissions with bulk operations"})]}),t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"Roles  Permissions Matrix"}),t.jsx(cr,{children:"Check boxes to grant permissions to roles"})]}),t.jsx(Q,{children:t.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[t.jsx(Us,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),t.jsx("p",{children:"Matrix grid will display here once roles and permissions are seeded."})]})})]})]})}function I5e(){return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Audit Logs"}),t.jsx("p",{className:"text-muted-foreground",children:"Track all system actions, changes, and user activity"})]}),t.jsxs(X,{children:[t.jsx(Ta,{className:"mr-2 h-4 w-4"}),"Export CSV"]})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx(di,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Search by actor, action, entity...",className:"pl-10"})]}),t.jsx(X,{variant:"outline",children:"Date Range"}),t.jsx(X,{variant:"outline",children:"Filters"})]}),t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"Activity Timeline"}),t.jsx(cr,{children:"All actions with before/after diffs"})]}),t.jsx(Q,{children:t.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[t.jsx($n,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),t.jsx("p",{children:"Audit logs will appear here once users start performing actions."})]})})]})]})}function D5e(){const[e,r]=O.useState([{id:1,appName:"SCADA Integration",keyId:"sk_live_abc123xyz",keySecret:"",scopes:["read:telemetry","write:alarms"],rateLimit:5e3,lastUsedAt:"2025-11-24T14:32:00Z",createdAt:"2025-11-01T10:00:00Z",isActive:!0},{id:2,appName:"Billing System",keyId:"sk_live_def456uvw",keySecret:"",scopes:["read:billing","write:payments"],rateLimit:1e3,lastUsedAt:"2025-11-24T16:15:00Z",createdAt:"2025-11-10T08:30:00Z",isActive:!0}]),[n]=O.useState([{id:1,clientName:"Mobile App",clientId:"oauth_mobile_app_001",grantTypes:["authorization_code","refresh_token"],redirectUris:["https://app.example.com/callback"],isActive:!0,createdAt:"2025-11-05T12:00:00Z"}]),[s,i]=O.useState({}),[l,d]=O.useState(""),a=j=>{i(w=>({...w,[j]:!w[j]}))},f=j=>{navigator.clipboard.writeText(j)},p=j=>{r(w=>w.map(k=>k.id===j?{...k,keySecret:"sk_live_"+Math.random().toString(36).substr(2,20)}:k))},y=j=>{r(w=>w.filter(k=>k.id!==j))},v=e.filter(j=>j.appName.toLowerCase().includes(l.toLowerCase())||j.keyId.toLowerCase().includes(l.toLowerCase()));return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"API Catalog & Key Management"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage API keys, OAuth clients, and integration credentials"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold",children:"API Keys"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Server-to-server authentication tokens"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Generate New Key"]})]}),t.jsx(Ve,{placeholder:"Search API keys...",value:l,onChange:j=>d(j.target.value),className:"max-w-xs"}),t.jsx("div",{className:"space-y-2",children:v.map(j=>t.jsx(H,{className:"hover:shadow-sm transition-shadow",children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 items-center",children:[t.jsxs("div",{className:"md:col-span-3",children:[t.jsx("p",{className:"font-medium text-sm",children:j.appName}),t.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:j.keyId})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"SCOPES"}),t.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:j.scopes.map(w=>t.jsx(Ee,{variant:"secondary",className:"text-xs",children:w},w))})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"RATE LIMIT"}),t.jsxs("p",{className:"font-medium",children:[j.rateLimit,"/hr"]})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"LAST USED"}),t.jsx("p",{className:"text-sm",children:j.lastUsedAt?new Date(j.lastUsedAt).toLocaleDateString():"Never"})]}),t.jsxs("div",{className:"md:col-span-3 flex justify-end gap-1",children:[t.jsx(X,{size:"sm",variant:"ghost",onClick:()=>a(j.id),children:s[j.id]?t.jsx(_V,{className:"h-4 w-4"}):t.jsx(ud,{className:"h-4 w-4"})}),t.jsx(X,{size:"sm",variant:"ghost",onClick:()=>f(j.keySecret),children:t.jsx(x2,{className:"h-4 w-4"})}),t.jsx(X,{size:"sm",variant:"ghost",onClick:()=>p(j.id),children:t.jsx(PV,{className:"h-4 w-4"})}),t.jsx(X,{size:"sm",variant:"ghost",className:"text-red-500 hover:text-red-600",onClick:()=>y(j.id),children:t.jsx(As,{className:"h-4 w-4"})})]})]})})},j.id))})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold",children:"OAuth Clients"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Third-party application integrations"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Register OAuth Client"]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map(j=>t.jsxs(H,{children:[t.jsxs(de,{className:"pb-3",children:[t.jsx(he,{className:"text-lg",children:j.clientName}),t.jsx(cr,{className:"font-mono text-xs",children:j.clientId})]}),t.jsxs(Q,{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1",children:"GRANT TYPES"}),t.jsx("div",{className:"flex flex-wrap gap-1",children:j.grantTypes.map(w=>t.jsx(Ee,{variant:"outline",className:"text-xs",children:w},w))})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1",children:"REDIRECT URIs"}),j.redirectUris.map(w=>t.jsx("p",{className:"text-xs font-mono break-all",children:w},w))]}),t.jsxs("div",{className:"pt-2 flex gap-2",children:[t.jsx(X,{size:"sm",variant:"outline",className:"flex-1",children:"Edit"}),t.jsx(X,{size:"sm",variant:"outline",className:"flex-1 text-red-500",children:"Revoke"})]})]})]},j.id))})]}),t.jsxs(H,{className:"bg-blue-50 border-blue-200",children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ps,{className:"h-5 w-5 text-blue-600"}),t.jsx(he,{className:"text-blue-900",children:"API Security Best Practices"})]})}),t.jsxs(Q,{className:"text-sm text-blue-800 space-y-2",children:[t.jsx("p",{children:" Rotate API keys every 90 days"}),t.jsx("p",{children:" Use minimal scopes required for your integration"}),t.jsx("p",{children:" Monitor API audit logs for unusual activity"}),t.jsx("p",{children:" Revoke unused keys immediately"}),t.jsx("p",{children:" Never commit API keys to version control"})]})]})]})}function R5e(){var a;const e=[{label:"Customers",key:"customers",icon:t.jsx(Hs,{className:"h-4 w-4"}),entities:[{id:1,sourceSystem:"CIS",sourceId:"CUST-001234",lastUpdated:"2025-11-24T10:30:00Z",trustScore:92,matchesFound:2},{id:2,sourceSystem:"Field App",sourceId:"FIELD-5678",lastUpdated:"2025-11-23T15:45:00Z",trustScore:78,matchesFound:1}]},{label:"Assets",key:"assets",icon:t.jsx(eI,{className:"h-4 w-4"}),entities:[{id:3,sourceSystem:"CMMS",sourceId:"PUMP-001",lastUpdated:"2025-11-22T08:00:00Z",trustScore:95,matchesFound:0}]},{label:"Locations",key:"locations",icon:t.jsx(Ma,{className:"h-4 w-4"}),entities:[{id:4,sourceSystem:"GIS",sourceId:"LOC-TURKANA-01",lastUpdated:"2025-11-20T12:00:00Z",trustScore:88,matchesFound:3}]},{label:"Vendors",key:"vendors",icon:t.jsx(aI,{className:"h-4 w-4"}),entities:[{id:5,sourceSystem:"Procurement",sourceId:"VEND-042",lastUpdated:"2025-11-24T09:15:00Z",trustScore:72,matchesFound:2}]}],[r,n]=O.useState(null),[s,i]=O.useState("customers"),l=f=>f>=85?"bg-green-100 text-green-800":f>=70?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",d=((a=e.find(f=>f.key===s))==null?void 0:a.entities)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Master Data Management"}),t.jsx("p",{className:"text-muted-foreground",children:"Deduplicate and manage golden records across source systems"})]}),t.jsxs(Sn,{value:s,onValueChange:i,children:[t.jsx(bn,{className:"grid w-full grid-cols-4",children:e.map(f=>t.jsxs(kt,{value:f.key,className:"flex items-center gap-2",children:[f.icon,t.jsx("span",{className:"hidden sm:inline",children:f.label})]},f.key))}),e.map(f=>t.jsxs(Dt,{value:f.key,className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold",children:f.label}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[f.entities.length," entities found"]})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Add ",f.label.slice(0,-1)]})]}),t.jsx("div",{className:"space-y-2",children:d.map(p=>t.jsx(H,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>n(p),children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-center",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-sm",children:p.sourceSystem}),t.jsx("p",{className:"text-xs text-muted-foreground",children:p.sourceId})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"LAST UPDATED"}),t.jsx("p",{className:"text-sm",children:new Date(p.lastUpdated).toLocaleDateString()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"TRUST SCORE"}),t.jsxs("div",{className:`inline-block px-2 py-1 rounded text-xs font-medium ${l(p.trustScore)}`,children:[p.trustScore,"%"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"POTENTIAL MATCHES"}),t.jsxs(Ee,{variant:p.matchesFound>0?"default":"secondary",children:[p.matchesFound," found"]})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[p.matchesFound>0&&t.jsxs(X,{size:"sm",variant:"default",children:[t.jsx(xL,{className:"h-4 w-4 mr-1"}),"Review Matches"]}),t.jsx(X,{size:"sm",variant:"outline",children:"Edit"})]})]})})},p.id))})]},f.key))]}),r&&t.jsxs(H,{className:"border-2 border-blue-200",children:[t.jsxs(de,{children:[t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(xL,{className:"h-5 w-5"}),"Entity Details"]}),t.jsxs(cr,{children:["Source: ",r.sourceSystem," | ID: ",r.sourceId]})]}),t.jsxs(Q,{className:"space-y-4",children:[r.matchesFound>0&&t.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:[t.jsxs("div",{className:"flex items-center gap-2 text-amber-900 text-sm",children:[t.jsx(ps,{className:"h-4 w-4"}),t.jsxs("span",{children:[r.matchesFound," potential duplicate(s) detected"]})]}),t.jsx("p",{className:"text-xs text-amber-700 mt-1",children:'Click "Review Matches" to resolve duplicates using the merge workbench.'})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-semibold text-muted-foreground",children:"TRUST SCORE"}),t.jsxs("div",{className:"mt-1",children:[t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:`h-2 rounded-full ${r.trustScore>=85?"bg-green-500":r.trustScore>=70?"bg-yellow-500":"bg-red-500"}`,style:{width:`${r.trustScore}%`}})}),t.jsxs("p",{className:"text-sm font-medium mt-1",children:[r.trustScore,"%"]})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-semibold text-muted-foreground",children:"SOURCE SYSTEM"}),t.jsx("p",{className:"text-sm font-medium mt-1",children:r.sourceSystem})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"TOTAL ENTITIES"}),t.jsx("p",{className:"text-3xl font-bold mt-1",children:e.reduce((f,p)=>f+p.entities.length,0)})]})}),t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"AVG TRUST SCORE"}),t.jsx("p",{className:"text-3xl font-bold mt-1",children:"82%"})]})}),t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"PENDING MERGES"}),t.jsx("p",{className:"text-3xl font-bold mt-1",children:"4"})]})}),t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"COMPLETED MERGES"}),t.jsx("p",{className:"text-3xl font-bold mt-1",children:"12"})]})})]})]})}function L5e(){const[e]=O.useState([{id:1,name:"Azure AD",type:"oidc",issuer:"https://login.microsoftonline.com/tenant-id/v2.0",status:"active",users:45,lastSync:"2025-11-24T14:30:00Z"},{id:2,name:"Google Workspace",type:"oidc",issuer:"https://accounts.google.com",status:"inactive",users:0,lastSync:null}]),[r]=O.useState({enforcementPolicy:"recommended",allowedMethods:["totp","sms","email"],gracePeriodDays:7}),[n]=O.useState([{id:1,name:"Operator Dashboard Access",effect:"allow",condition:"role=operator AND scheme_id NOT NULL",priority:100},{id:2,name:"Deny Access After Hours",effect:"deny",condition:"time > 18:00 AND time < 06:00 AND role != admin",priority:50}]);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Identity & Access Management"}),t.jsx("p",{className:"text-muted-foreground",children:"Configure SSO, MFA, and attribute-based access control"})]}),t.jsxs(Sn,{defaultValue:"sso",className:"w-full",children:[t.jsxs(bn,{className:"grid w-full grid-cols-3",children:[t.jsxs(kt,{value:"sso",className:"flex items-center gap-2",children:[t.jsx(wi,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:"SSO"})]}),t.jsxs(kt,{value:"mfa",className:"flex items-center gap-2",children:[t.jsx(oI,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:"MFA"})]}),t.jsxs(kt,{value:"abac",className:"flex items-center gap-2",children:[t.jsx(qh,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:"ABAC"})]})]}),t.jsxs(Dt,{value:"sso",className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Single Sign-On (OIDC/SAML)"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Connect identity providers for enterprise authentication"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Add Provider"]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map(s=>t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx(he,{className:"text-lg",children:s.name}),t.jsx(cr,{className:"mt-1",children:s.type.toUpperCase()})]}),t.jsx(Ee,{variant:s.status==="active"?"default":"outline",children:s.status})]})}),t.jsxs(Q,{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"ISSUER"}),t.jsx("p",{className:"text-xs font-mono break-all",children:s.issuer})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"SYNCED USERS"}),t.jsx("p",{className:"text-lg font-bold",children:s.users})]}),s.lastSync&&t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"LAST SYNC"}),t.jsx("p",{className:"text-sm",children:new Date(s.lastSync).toLocaleString()})]}),t.jsxs("div",{className:"flex gap-2 pt-2",children:[t.jsx(X,{size:"sm",variant:"outline",className:"flex-1",children:"Test"}),t.jsx(X,{size:"sm",variant:"outline",className:"flex-1",children:"Edit"}),s.status==="inactive"&&t.jsx(X,{size:"sm",className:"flex-1",children:"Enable"})]})]})]},s.id))}),t.jsxs(H,{className:"bg-blue-50 border-blue-200",children:[t.jsx(de,{children:t.jsx(he,{className:"text-blue-900",children:"Configuration Steps"})}),t.jsxs(Q,{className:"text-sm text-blue-800 space-y-2",children:[t.jsx("p",{children:"1. Register this application with your IdP"}),t.jsx("p",{children:"2. Provide Redirect URI: https://yourdomain.com/auth/callback"}),t.jsx("p",{children:"3. Copy Client ID and Client Secret here"}),t.jsx("p",{children:'4. Click "Test" to verify connectivity'}),t.jsx("p",{children:"5. Enable once testing is successful"})]})]})]}),t.jsxs(Dt,{value:"mfa",className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Multi-Factor Authentication"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Enforce MFA for enhanced security"})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-base",children:"MFA Policy"})}),t.jsxs(Q,{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Enforcement Policy"}),t.jsxs("div",{className:"flex gap-2 mt-2",children:[t.jsx(Ee,{variant:r.enforcementPolicy==="optional"?"default":"outline",children:"Optional"}),t.jsx(Ee,{variant:r.enforcementPolicy==="recommended"?"default":"outline",children:"Recommended"}),t.jsx(Ee,{variant:r.enforcementPolicy==="required"?"default":"outline",children:"Required"})]}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Current: ",r.enforcementPolicy]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Allowed Methods"}),t.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:["totp","sms","email"].map(s=>t.jsx(Ee,{variant:r.allowedMethods.includes(s)?"default":"outline",className:"cursor-pointer",children:s==="totp"?"Authenticator App":s.toUpperCase()},s))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Grace Period"}),t.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[t.jsx(Ve,{type:"number",value:r.gracePeriodDays,className:"w-20",disabled:!0}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"days to enroll"})]})]}),t.jsx(X,{children:"Save MFA Settings"})]})]}),t.jsxs(H,{className:"bg-green-50 border-green-200",children:[t.jsx(de,{children:t.jsx(he,{className:"text-green-900 text-base",children:"MFA Enrollment Status"})}),t.jsxs(Q,{className:"text-sm text-green-800 space-y-1",children:[t.jsx("p",{children:" 38 users with MFA enabled"}),t.jsx("p",{children:" 7 users pending enrollment"}),t.jsx("p",{children:" Grace period expires: 2025-12-01"})]})]})]}),t.jsxs(Dt,{value:"abac",className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Attribute-Based Access Control"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Fine-grained policies based on user attributes"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Add Policy"]})]}),t.jsx("div",{className:"space-y-2",children:n.map(s=>t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-center",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-sm",children:s.name}),t.jsx("p",{className:"text-xs text-muted-foreground font-mono mt-1",children:s.condition})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"EFFECT"}),t.jsx(Ee,{variant:s.effect==="allow"?"default":"destructive",className:"mt-1",children:s.effect.toUpperCase()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"PRIORITY"}),t.jsx("p",{className:"font-medium mt-1",children:s.priority})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{size:"sm",variant:"outline",children:"Edit"}),t.jsx(X,{size:"sm",variant:"outline",className:"text-red-500",children:"Delete"})]})]})})},s.id))}),t.jsxs(H,{className:"bg-amber-50 border-amber-200",children:[t.jsx(de,{children:t.jsx(he,{className:"text-amber-900 text-base",children:"ABAC Attributes Available"})}),t.jsxs(Q,{className:"text-sm text-amber-800 space-y-1",children:[t.jsx("p",{children:" role (admin, manager, operator, analyst, viewer)"}),t.jsx("p",{children:" scheme_id (for location-based access)"}),t.jsx("p",{children:" dma_id (for distribution area control)"}),t.jsx("p",{children:" department (operations, finance, etc.)"}),t.jsx("p",{children:" sensitivity (public, internal, confidential)"}),t.jsx("p",{children:" time (for business hours restrictions)"})]})]})]})]})]})}function F5e(){const[e]=O.useState([{id:1,title:"Water Supply Service Agreement 2025",type:"contract",size:"2.4 MB",status:"active",version:3,createdDate:"2025-11-01",modifiedDate:"2025-11-20",retention:"7 years"},{id:2,title:"Operational Procedures Manual",type:"procedure",size:"5.8 MB",status:"active",version:5,createdDate:"2025-06-15",modifiedDate:"2025-11-18",retention:"5 years"},{id:3,title:"Q3 Financial Audit Report",type:"report",size:"1.2 MB",status:"archived",version:1,createdDate:"2025-10-01",modifiedDate:"2025-10-15",retention:"10 years"}]),[r,n]=O.useState(""),s=l=>{switch(l){case"contract":return"bg-blue-100 text-blue-800";case"report":return"bg-green-100 text-green-800";case"policy":return"bg-purple-100 text-purple-800";case"procedure":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},i=e.filter(l=>l.title.toLowerCase().includes(r.toLowerCase()));return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Electronic Document Records Management"}),t.jsx("p",{className:"text-muted-foreground",children:"Centralized document control with version history and compliance"})]}),t.jsxs(Sn,{defaultValue:"documents",className:"w-full",children:[t.jsxs(bn,{className:"grid w-full grid-cols-2",children:[t.jsx(kt,{value:"documents",children:"Documents"}),t.jsx(kt,{value:"retention",children:"Retention Schedule"})]}),t.jsxs(Dt,{value:"documents",className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Document Library"}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[i.length," documents found"]})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Upload Document"]})]}),t.jsx(Ve,{placeholder:"Search documents...",value:r,onChange:l=>n(l.target.value),className:"max-w-xs"}),t.jsx("div",{className:"space-y-2",children:i.map(l=>t.jsx(H,{className:"hover:shadow-sm transition-shadow",children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 items-center",children:[t.jsx("div",{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx($n,{className:"h-4 w-4 text-blue-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-sm",children:l.title}),t.jsx("p",{className:"text-xs text-muted-foreground",children:l.size})]})]})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"TYPE"}),t.jsx(Ee,{className:`mt-1 ${s(l.type)}`,children:l.type})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"VERSION"}),t.jsxs("p",{className:"font-medium mt-1",children:["v",l.version]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"MODIFIED"}),t.jsx("p",{className:"text-sm mt-1",children:new Date(l.modifiedDate).toLocaleDateString()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"RETENTION"}),t.jsx("p",{className:"text-sm mt-1",children:l.retention})]}),t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsx(X,{size:"sm",variant:"ghost",children:t.jsx(Ta,{className:"h-4 w-4"})}),t.jsx(X,{size:"sm",variant:"ghost",children:t.jsx(kne,{className:"h-4 w-4"})}),t.jsx(X,{size:"sm",variant:"ghost",className:"text-red-500",children:t.jsx(As,{className:"h-4 w-4"})})]})]})})},l.id))})]}),t.jsxs(Dt,{value:"retention",className:"space-y-4",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Retention Schedule"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsx(he,{className:"text-base",children:"Short Term (1-2 Years)"})}),t.jsxs(Q,{className:"space-y-2",children:[t.jsx("p",{className:"text-sm",children:" Meeting minutes"}),t.jsx("p",{className:"text-sm",children:" Internal memos"}),t.jsx("p",{className:"text-sm",children:" Draft documents"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsx(he,{className:"text-base",children:"Medium Term (5-7 Years)"})}),t.jsxs(Q,{className:"space-y-2",children:[t.jsx("p",{className:"text-sm",children:" Contracts"}),t.jsx("p",{className:"text-sm",children:" Procedures"}),t.jsx("p",{className:"text-sm",children:" Operational reports"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsx(he,{className:"text-base",children:"Long Term (10+ Years)"})}),t.jsxs(Q,{className:"space-y-2",children:[t.jsx("p",{className:"text-sm",children:" Financial audits"}),t.jsx("p",{className:"text-sm",children:" Compliance records"}),t.jsx("p",{className:"text-sm",children:" Strategic plans"})]})]})]})]})]})]})}function z5e(){const[e]=O.useState([{id:1,name:"customers_raw",schema:"raw",rows:45230,lastRefresh:"2025-11-24T10:30:00Z",quality:94},{id:2,name:"billing_transactions",schema:"staging",rows:128456,lastRefresh:"2025-11-24T12:00:00Z",quality:97},{id:3,name:"customer_mart",schema:"mart",rows:45230,lastRefresh:"2025-11-24T14:15:00Z",quality:99},{id:4,name:"asset_registry",schema:"raw",rows:8923,lastRefresh:"2025-11-23T16:00:00Z",quality:91}]),[r]=O.useState([{id:1,source:"customers_raw",target:"customer_mart",type:"aggregate"},{id:2,source:"billing_transactions",target:"customer_mart",type:"join"},{id:3,source:"asset_registry",target:"operations_mart",type:"filter"}]);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Data Warehouse & Lineage"}),t.jsx("p",{className:"text-muted-foreground",children:"Monitor data flows, transformations, and quality metrics"})]}),t.jsxs(Sn,{defaultValue:"tables",className:"w-full",children:[t.jsxs(bn,{className:"grid w-full grid-cols-3",children:[t.jsxs(kt,{value:"tables",className:"flex items-center gap-2",children:[t.jsx(lo,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Tables"})]}),t.jsxs(kt,{value:"lineage",className:"flex items-center gap-2",children:[t.jsx(Ine,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Lineage"})]}),t.jsxs(kt,{value:"quality",className:"flex items-center gap-2",children:[t.jsx(xs,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Quality"})]})]}),t.jsxs(Dt,{value:"tables",className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Data Warehouse Tables"}),t.jsxs(X,{size:"sm",children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Add Table"]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map(n=>t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx(he,{className:"text-base",children:n.name}),t.jsxs(cr,{className:"mt-1",children:[n.schema," schema"]})]}),t.jsx(Ee,{variant:"outline",children:n.schema})]})}),t.jsxs(Q,{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"ROWS"}),t.jsx("p",{className:"font-bold",children:n.rows.toLocaleString()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"QUALITY SCORE"}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full",children:t.jsx("div",{className:"h-2 rounded-full bg-green-500",style:{width:`${n.quality}%`}})}),t.jsxs("span",{className:"font-bold text-sm",children:[n.quality,"%"]})]})]})]}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:["Last Refreshed: ",new Date(n.lastRefresh).toLocaleString()]}),t.jsxs("div",{className:"flex gap-2 pt-2",children:[t.jsx(X,{size:"sm",variant:"outline",className:"flex-1",children:"Profile"}),t.jsxs(X,{size:"sm",variant:"outline",className:"flex-1",children:[t.jsx(SV,{className:"h-3 w-3 mr-1"}),"Refresh"]})]})]})]},n.id))})]}),t.jsxs(Dt,{value:"lineage",className:"space-y-4",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Data Lineage & Transformations"}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsx("div",{className:"space-y-4",children:r.map((n,s)=>t.jsxs("div",{className:"flex items-center gap-4 p-3 bg-gray-50 rounded-lg",children:[t.jsx("div",{className:"font-mono text-sm font-medium",children:n.source}),t.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[t.jsx("div",{className:"flex-1 h-0.5 bg-gray-300"}),t.jsx(Ee,{variant:"outline",className:"flex-shrink-0",children:n.type}),t.jsx("div",{className:"flex-1 h-0.5 bg-gray-300"})]}),t.jsx("div",{className:"font-mono text-sm font-medium",children:n.target})]},n.id))})})}),t.jsxs(H,{className:"bg-blue-50 border-blue-200",children:[t.jsx(de,{children:t.jsx(he,{className:"text-blue-900 text-base",children:"Lineage Analysis"})}),t.jsxs(Q,{className:"text-sm text-blue-800 space-y-2",children:[t.jsx("p",{children:" Track data dependencies across all tables"}),t.jsx("p",{children:" Identify transformation bottlenecks"}),t.jsx("p",{children:" Impact analysis for schema changes"})]})]})]}),t.jsxs(Dt,{value:"quality",className:"space-y-4",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Data Quality Metrics"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"COMPLETENESS"}),t.jsx("p",{className:"text-3xl font-bold mt-1",children:"99.2%"}),t.jsx(Ee,{className:"mt-2 bg-green-100 text-green-800",children:"Excellent"})]})}),t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"ACCURACY"}),t.jsx("p",{className:"text-3xl font-bold mt-1",children:"98.7%"}),t.jsx(Ee,{className:"mt-2 bg-green-100 text-green-800",children:"Excellent"})]})}),t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"CONSISTENCY"}),t.jsx("p",{className:"text-3xl font-bold mt-1",children:"97.1%"}),t.jsx(Ee,{className:"mt-2 bg-yellow-100 text-yellow-800",children:"Good"})]})}),t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"TIMELINESS"}),t.jsx("p",{className:"text-3xl font-bold mt-1",children:"100%"}),t.jsx(Ee,{className:"mt-2 bg-green-100 text-green-800",children:"Excellent"})]})})]})]})]})]})}const uj="/api/v1/integration";async function $5e(){return(await fetch(`${uj}/notifications/queue`)).json()}async function B5e(){return(await fetch(`${uj}/devices`)).json()}async function q5e(){return(await fetch(`${uj}/observability/alerts`)).json()}async function V5e(){return(await fetch(`${uj}/observability/dashboard`)).json()}async function U5e(){return(await fetch(`${uj}/secrets/audit-log`)).json()}function W5e(){const[e,r]=O.useState([{id:1,name:"Email Notifications",type:"email",status:"active",config:"SendGrid"},{id:2,name:"SMS Alerts",type:"sms",status:"active",config:"Twilio"},{id:3,name:"Slack Integration",type:"slack",status:"active",config:"Webhook"}]),[n,s]=O.useState([{id:1,key:"alert_system_down",name:"System Alert",subject:"System Downtime Alert",vars:4},{id:2,key:"report_generated",name:"Report Ready",subject:"Your Report is Ready",vars:3},{id:3,key:"payment_received",name:"Payment Confirmation",subject:"Payment Received",vars:5}]),[i,l]=O.useState([{id:1,template:"alert_system_down",recipient:"admin@example.com",status:"sent",channel:"email"},{id:2,template:"report_generated",recipient:"+254712345678",status:"pending",channel:"sms",retry:2},{id:3,template:"payment_received",recipient:"ops-team",status:"sent",channel:"slack"}]);return O.useEffect(()=>{(async()=>{try{const a=await $5e();a.success&&a.queue&&l(a.queue)}catch(a){console.error("Failed to load notification queue:",a)}})()},[]),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Advanced Notifications"}),t.jsx("p",{className:"text-muted-foreground",children:"Multi-channel notification management with templates and delivery tracking"})]}),t.jsxs(Sn,{defaultValue:"channels",className:"w-full",children:[t.jsxs(bn,{className:"grid w-full grid-cols-3",children:[t.jsx(kt,{value:"channels",children:"Channels"}),t.jsx(kt,{value:"templates",children:"Templates"}),t.jsx(kt,{value:"queue",children:"Queue"})]}),t.jsxs(Dt,{value:"channels",className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Notification Channels"}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Add Channel"]})]}),t.jsx("div",{className:"space-y-2",children:e.map(d=>t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-center",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[d.type==="email"&&t.jsx(sI,{className:"h-5 w-5 text-blue-500"}),d.type==="sms"&&t.jsx(lm,{className:"h-5 w-5 text-green-500"}),d.type==="slack"&&t.jsx(kV,{className:"h-5 w-5 text-purple-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:d.name}),t.jsx("p",{className:"text-xs text-muted-foreground",children:d.type.toUpperCase()})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"SERVICE"}),t.jsx("p",{className:"text-sm font-medium mt-1",children:d.config})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"STATUS"}),t.jsx(Ee,{className:"mt-1 bg-green-100 text-green-800",children:d.status})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"MESSAGES/DAY"}),t.jsx("p",{className:"text-sm font-medium mt-1",children:"1,245"})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{size:"sm",variant:"ghost",children:t.jsx(Dl,{className:"h-4 w-4"})}),t.jsx(X,{size:"sm",variant:"ghost",className:"text-red-500",children:t.jsx(As,{className:"h-4 w-4"})})]})]})})},d.id))})]}),t.jsxs(Dt,{value:"templates",className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Notification Templates"}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Create Template"]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map(d=>t.jsxs(H,{children:[t.jsxs(de,{className:"pb-3",children:[t.jsx(he,{className:"text-base",children:d.name}),t.jsx(cr,{className:"font-mono text-xs",children:d.key})]}),t.jsxs(Q,{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium mb-1",children:"Subject Line:"}),t.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded",children:d.subject})]}),t.jsx("div",{children:t.jsxs("p",{className:"text-xs text-muted-foreground",children:["Variables: ",d.vars]})}),t.jsxs("div",{className:"flex gap-2 pt-2",children:[t.jsxs(X,{size:"sm",variant:"outline",className:"flex-1",children:[t.jsx(Dl,{className:"h-3 w-3 mr-1"}),"Edit"]}),t.jsxs(X,{size:"sm",variant:"outline",className:"flex-1",children:[t.jsx(y2,{className:"h-3 w-3 mr-1"}),"Test"]})]})]})]},d.id))})]}),t.jsxs(Dt,{value:"queue",className:"space-y-4",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Delivery Queue"}),t.jsx("div",{className:"space-y-2",children:i.map(d=>t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-center",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium",children:d.template}),t.jsx("p",{className:"text-xs text-muted-foreground",children:d.recipient})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"CHANNEL"}),t.jsx(Ee,{variant:"outline",className:"mt-1",children:d.channel})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"STATUS"}),t.jsx(Ee,{className:`mt-1 ${d.status==="sent"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:d.status})]}),d.retry&&t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"RETRIES"}),t.jsxs("p",{className:"text-sm font-medium mt-1",children:[d.retry,"/3"]})]}),t.jsx("div",{className:"flex justify-end gap-2",children:d.status==="pending"&&t.jsxs(t.Fragment,{children:[t.jsx(X,{size:"sm",variant:"outline",children:"Retry"}),t.jsx(X,{size:"sm",variant:"outline",className:"text-red-500",children:"Cancel"})]})})]})})},d.id))}),t.jsxs(H,{className:"bg-blue-50 border-blue-200",children:[t.jsx(de,{children:t.jsx(he,{className:"text-blue-900 text-base",children:"Queue Stats"})}),t.jsxs(Q,{className:"text-sm text-blue-800 space-y-1",children:[t.jsx("p",{children:" Total Sent Today: 3,421"}),t.jsx("p",{children:" Pending: 8"}),t.jsx("p",{children:" Failed (24h): 2"}),t.jsx("p",{children:" Delivery Rate: 99.94%"})]})]})]})]})]})}function G5e(){const[e,r]=O.useState([{id:1,name:"Field Device-001",type:"mobile",os:"Android 12",status:"active",lastSync:"2025-11-24T10:30:00Z",location:"Turkana County",appVersion:"1.2.3"},{id:2,name:"IoT Sensor-042",type:"iot",os:"Linux ARM",status:"active",lastSync:"2025-11-24T15:20:00Z",location:"Borehole-05",appVersion:"2.1.0"},{id:3,name:"Tablet-Ops",type:"tablet",os:"iPadOS 17",status:"offline",lastSync:"2025-11-20T08:00:00Z",location:"Control Center",appVersion:"1.1.5"}]),[n]=O.useState([{id:1,device:"Field Device-001",operation:"create",entity:"customer",status:"synced"},{id:2,device:"IoT Sensor-042",operation:"update",entity:"reading",status:"pending"},{id:3,device:"Tablet-Ops",operation:"delete",entity:"ticket",status:"conflict"}]);O.useEffect(()=>{(async()=>{try{const l=await B5e();l.success&&l.devices&&r(l.devices)}catch(l){console.error("Failed to load devices:",l)}})()},[]);const s=i=>{switch(i){case"active":return"bg-green-100 text-green-800";case"offline":return"bg-gray-100 text-gray-800";case"inactive":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Device Registry & Offline Sync"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage field devices and synchronization queues"})]}),t.jsxs(Sn,{defaultValue:"devices",className:"w-full",children:[t.jsxs(bn,{className:"grid w-full grid-cols-2",children:[t.jsx(kt,{value:"devices",children:"Devices"}),t.jsx(kt,{value:"sync",children:"Sync Queue"})]}),t.jsxs(Dt,{value:"devices",className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Registered Devices"}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.length," devices registered"]})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Register Device"]})]}),t.jsx("div",{className:"grid grid-cols-1 gap-2",children:e.map(i=>t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 items-center",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(oI,{className:"h-5 w-5 text-blue-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-sm",children:i.name}),t.jsx("p",{className:"text-xs text-muted-foreground",children:i.os})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"STATUS"}),t.jsx(Ee,{className:`mt-1 ${s(i.status)}`,children:i.status==="active"?t.jsxs(t.Fragment,{children:[t.jsx(qne,{className:"h-3 w-3 mr-1"}),i.status]}):t.jsxs(t.Fragment,{children:[t.jsx(Bne,{className:"h-3 w-3 mr-1"}),i.status]})})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"LOCATION"}),t.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[t.jsx(Ma,{className:"h-3 w-3"}),t.jsx("p",{className:"text-sm",children:i.location})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"APP VERSION"}),t.jsxs("p",{className:"text-sm font-medium mt-1",children:["v",i.appVersion]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"LAST SYNC"}),t.jsx("p",{className:"text-sm mt-1",children:new Date(i.lastSync).toLocaleString()})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{size:"sm",variant:"ghost",children:t.jsx(Us,{className:"h-4 w-4"})}),t.jsx(X,{size:"sm",variant:"ghost",className:"text-red-500",children:t.jsx(As,{className:"h-4 w-4"})})]})]})})},i.id))})]}),t.jsxs(Dt,{value:"sync",className:"space-y-4",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Offline Sync Queue"}),t.jsx("div",{className:"space-y-2",children:n.map(i=>t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-center",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium",children:i.device}),t.jsx("p",{className:"text-xs text-muted-foreground font-mono mt-1",children:i.entity})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"OPERATION"}),t.jsx(Ee,{variant:"outline",className:"mt-1",children:i.operation})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"STATUS"}),t.jsx(Ee,{className:`mt-1 ${i.status==="synced"?"bg-green-100 text-green-800":i.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:i.status})]}),t.jsx("div",{}),t.jsxs("div",{className:"flex justify-end gap-2",children:[i.status==="conflict"&&t.jsxs(t.Fragment,{children:[t.jsx(X,{size:"sm",variant:"outline",className:"text-sm",children:"Server"}),t.jsx(X,{size:"sm",variant:"outline",className:"text-sm",children:"Device"})]}),i.status==="pending"&&t.jsx(X,{size:"sm",variant:"outline",children:"Sync Now"})]})]})})},i.id))})]})]})]})}function K5e(){const[e,r]=O.useState([{id:1,name:"High CPU Usage",severity:"critical",condition:"cpu > 85%",status:"open"},{id:2,name:"Database Connection Pool",severity:"warning",condition:"connections > 100",status:"open"},{id:3,name:"API Response Time",severity:"warning",condition:"latency > 2s",status:"active"}]),[n,s]=O.useState([{id:1,policy:"High CPU Usage",severity:"critical",status:"open",firedAt:"2025-11-24T15:32:00Z"},{id:2,policy:"Database Connection Pool",severity:"warning",status:"acknowledged",firedAt:"2025-11-24T14:15:00Z"},{id:3,policy:"API Response Time",severity:"warning",status:"resolved",firedAt:"2025-11-23T10:30:00Z"}]),[i,l]=O.useState(null);return O.useEffect(()=>{(async()=>{try{const[a,f]=await Promise.all([V5e(),q5e()]);a.success&&l(a),f.success&&f.policies&&r(f.policies)}catch(a){console.error("Failed to load observability data:",a)}})()},[]),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Observability & Ops Dashboard"}),t.jsx("p",{className:"text-muted-foreground",children:"System metrics, alerts, and incident management"})]}),t.jsxs(Sn,{defaultValue:"metrics",className:"w-full",children:[t.jsxs(bn,{className:"grid w-full grid-cols-3",children:[t.jsx(kt,{value:"metrics",children:"Metrics"}),t.jsx(kt,{value:"alerts",children:"Alert Policies"}),t.jsx(kt,{value:"incidents",children:"Incidents"})]}),t.jsxs(Dt,{value:"metrics",className:"space-y-4",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"System Metrics"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"CPU USAGE"}),t.jsx("p",{className:"text-3xl font-bold mt-1",children:"42%"}),t.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full mt-2",children:t.jsx("div",{className:"h-2 bg-yellow-500 rounded-full",style:{width:"42%"}})})]})}),t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"MEMORY"}),t.jsx("p",{className:"text-3xl font-bold mt-1",children:"68%"}),t.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full mt-2",children:t.jsx("div",{className:"h-2 bg-orange-500 rounded-full",style:{width:"68%"}})})]})}),t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"API LATENCY"}),t.jsx("p",{className:"text-3xl font-bold mt-1",children:"127ms"}),t.jsx(Ee,{className:"mt-2 bg-green-100 text-green-800",children:"Good"})]})}),t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"ERROR RATE"}),t.jsx("p",{className:"text-3xl font-bold mt-1",children:"0.2%"}),t.jsx(Ee,{className:"mt-2 bg-green-100 text-green-800",children:"Excellent"})]})})]})]}),t.jsxs(Dt,{value:"alerts",className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("h2",{className:"text-lg font-semibold",children:["Alert Policies (",e.length,")"]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Create Alert"]})]}),t.jsx("div",{className:"space-y-2",children:e.map(d=>t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-center",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:d.name}),t.jsx("p",{className:"text-xs text-muted-foreground font-mono mt-1",children:d.condition})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"SEVERITY"}),t.jsx(Ee,{className:`mt-1 ${d.severity==="critical"?"bg-red-100 text-red-800":d.severity==="warning"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:d.severity})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"STATUS"}),t.jsx(Ee,{className:"mt-1 bg-green-100 text-green-800",children:d.status})]}),t.jsx("div",{}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{size:"sm",variant:"outline",children:"Edit"}),t.jsx(X,{size:"sm",variant:"outline",className:"text-red-500",children:"Delete"})]})]})})},d.id))})]}),t.jsxs(Dt,{value:"incidents",className:"space-y-4",children:[t.jsxs("h2",{className:"text-lg font-semibold",children:["Active Incidents (",n.filter(d=>d.status==="open").length,")"]}),t.jsx("div",{className:"space-y-2",children:n.map(d=>t.jsx(H,{className:d.status==="open"?"border-red-200 bg-red-50":"",children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-center",children:[t.jsx("div",{children:t.jsxs("div",{className:"flex items-center gap-2",children:[d.status==="open"&&t.jsx(an,{className:"h-5 w-5 text-red-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:d.policy}),t.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(d.firedAt).toLocaleString()})]})]})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"SEVERITY"}),t.jsx(Ee,{className:`mt-1 ${d.severity==="critical"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:d.severity})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"STATUS"}),t.jsx(Ee,{className:`mt-1 ${d.status==="open"?"bg-red-100 text-red-800":d.status==="acknowledged"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:d.status})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"DURATION"}),t.jsx("p",{className:"text-sm mt-1",children:"45 minutes"})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[d.status==="open"&&t.jsxs(X,{size:"sm",variant:"outline",children:[t.jsx(_u,{className:"h-3 w-3 mr-1"}),"Acknowledge"]}),d.status!=="resolved"&&t.jsx(X,{size:"sm",variant:"outline",children:"Resolve"})]})]})})},d.id))})]})]})]})}function H5e(){const[e]=O.useState([{id:1,name:"Daily Full Backup",type:"full",schedule:"02:00 UTC",retention:"30 days",status:"active"},{id:2,name:"Hourly Incremental",type:"incremental",schedule:"Every hour",retention:"7 days",status:"active"},{id:3,name:"Weekly Snapshot",type:"snapshot",schedule:"Sunday 03:00 UTC",retention:"90 days",status:"active"}]),[r]=O.useState([{id:1,policy:"Daily Full Backup",size:"45.2 GB",status:"completed",date:"2025-11-24T02:15:00Z",duration:"3h 42m"},{id:2,policy:"Daily Full Backup",size:"44.8 GB",status:"completed",date:"2025-11-23T02:10:00Z",duration:"3h 38m"},{id:3,policy:"Hourly Incremental",size:"312 MB",status:"completed",date:"2025-11-24T14:00:00Z",duration:"12m"}]),[n]=O.useState({name:"Primary Site Recovery",rto:15,rpo:5,services:8,lastTested:"2025-11-15T10:30:00Z"});return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Backup & Disaster Recovery"}),t.jsx("p",{className:"text-muted-foreground",children:"Data protection and business continuity management"})]}),t.jsxs(Sn,{defaultValue:"policies",className:"w-full",children:[t.jsxs(bn,{className:"grid w-full grid-cols-3",children:[t.jsx(kt,{value:"policies",children:"Policies"}),t.jsx(kt,{value:"backups",children:"Backup Jobs"}),t.jsx(kt,{value:"drplan",children:"DR Plan"})]}),t.jsxs(Dt,{value:"policies",className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Backup Policies"}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Create Policy"]})]}),t.jsx("div",{className:"space-y-2",children:e.map(s=>t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 items-center",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:s.name}),t.jsx(Ee,{variant:"outline",className:"mt-1",children:s.type})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"SCHEDULE"}),t.jsx("p",{className:"text-sm mt-1",children:s.schedule})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"RETENTION"}),t.jsx("p",{className:"text-sm mt-1",children:s.retention})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"STATUS"}),t.jsx(Ee,{className:"mt-1 bg-green-100 text-green-800",children:s.status})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"NEXT RUN"}),t.jsx("p",{className:"text-sm mt-1",children:"In 8h 23m"})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(X,{size:"sm",variant:"ghost",children:t.jsx(El,{className:"h-4 w-4"})}),t.jsx(X,{size:"sm",variant:"ghost",children:t.jsx(Dl,{className:"h-4 w-4"})}),t.jsx(X,{size:"sm",variant:"ghost",className:"text-red-500",children:t.jsx(As,{className:"h-4 w-4"})})]})]})})},s.id))})]}),t.jsxs(Dt,{value:"backups",className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Recent Backup Jobs"}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.length," backups completed"]})]}),t.jsxs(X,{size:"sm",children:[t.jsx(El,{className:"h-4 w-4 mr-2"}),"Run Backup Now"]})]}),t.jsx("div",{className:"space-y-2",children:r.map(s=>t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 items-center",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-sm",children:s.policy}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(s.date).toLocaleString()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"SIZE"}),t.jsx("p",{className:"font-medium mt-1",children:s.size})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"DURATION"}),t.jsx("p",{className:"text-sm mt-1",children:s.duration})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"STATUS"}),t.jsx(Ee,{className:"mt-1 bg-green-100 text-green-800",children:s.status})]}),t.jsx("div",{}),t.jsx("div",{className:"flex justify-end gap-2",children:t.jsxs(X,{size:"sm",variant:"outline",className:"text-sm",children:[t.jsx(Ta,{className:"h-3 w-3 mr-1"}),"Restore"]})})]})})},s.id))})]}),t.jsxs(Dt,{value:"drplan",className:"space-y-4",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Disaster Recovery Plan"}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:n.name})}),t.jsxs(Q,{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("p",{className:"text-xs text-blue-600 font-semibold",children:"RTO (Recovery Time Objective)"}),t.jsxs("p",{className:"text-3xl font-bold text-blue-900 mt-2",children:[n.rto,"m"]}),t.jsx("p",{className:"text-sm text-blue-700 mt-2",children:"Maximum allowable downtime"})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[t.jsx("p",{className:"text-xs text-green-600 font-semibold",children:"RPO (Recovery Point Objective)"}),t.jsxs("p",{className:"text-3xl font-bold text-green-900 mt-2",children:[n.rpo,"m"]}),t.jsx("p",{className:"text-sm text-green-700 mt-2",children:"Maximum data loss acceptable"})]}),t.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[t.jsx("p",{className:"text-xs text-purple-600 font-semibold",children:"Critical Services"}),t.jsx("p",{className:"text-3xl font-bold text-purple-900 mt-2",children:n.services}),t.jsx("p",{className:"text-sm text-purple-700 mt-2",children:"Protected systems"})]})]}),t.jsx("div",{className:"pt-4 border-t",children:t.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Xs,{className:"h-5 w-5 text-yellow-600"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-sm",children:"Last DR Test"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(n.lastTested).toLocaleString()})]})]}),t.jsxs(X,{size:"sm",children:[t.jsx(El,{className:"h-4 w-4 mr-2"}),"Test DR Plan"]})]})}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold mb-3",children:"Recovery Steps"}),t.jsxs("ol",{className:"space-y-2",children:[t.jsxs("li",{className:"flex gap-3",children:[t.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-blue-100 text-blue-800 text-sm flex items-center justify-center",children:"1"}),t.jsx("span",{className:"text-sm",children:"Notify incident response team"})]}),t.jsxs("li",{className:"flex gap-3",children:[t.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-blue-100 text-blue-800 text-sm flex items-center justify-center",children:"2"}),t.jsx("span",{className:"text-sm",children:"Activate standby infrastructure"})]}),t.jsxs("li",{className:"flex gap-3",children:[t.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-blue-100 text-blue-800 text-sm flex items-center justify-center",children:"3"}),t.jsx("span",{className:"text-sm",children:"Restore databases from latest backup"})]}),t.jsxs("li",{className:"flex gap-3",children:[t.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-blue-100 text-blue-800 text-sm flex items-center justify-center",children:"4"}),t.jsx("span",{className:"text-sm",children:"Verify application functionality"})]}),t.jsxs("li",{className:"flex gap-3",children:[t.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-blue-100 text-blue-800 text-sm flex items-center justify-center",children:"5"}),t.jsx("span",{className:"text-sm",children:"Switch DNS to recovery site"})]})]})]})]})]})]})]})]})}function Z5e(){const[e,r]=O.useState([{id:1,key:"SENDGRID_API_KEY",type:"api_key",owner:"Integrations",expiresIn:"45 days",lastRotated:"2025-10-01"},{id:2,key:"DATABASE_PASSWORD",type:"password",owner:"Database",expiresIn:"Never",lastRotated:"2025-06-15"},{id:3,key:"TWILIO_AUTH_TOKEN",type:"token",owner:"Communications",expiresIn:"30 days",lastRotated:"2025-11-01"},{id:4,key:"SSL_CERTIFICATE",type:"certificate",owner:"Infrastructure",expiresIn:"60 days",lastRotated:"N/A"}]),[n,s]=O.useState([{id:1,secret:"SENDGRID_API_KEY",accessedBy:"admin@example.com",type:"read",timestamp:"2025-11-24T14:32:00Z",ip:"192.168.1.1"},{id:2,secret:"DATABASE_PASSWORD",accessedBy:"backup-service",type:"read",timestamp:"2025-11-24T10:00:00Z",ip:"10.0.0.5"},{id:3,secret:"TWILIO_AUTH_TOKEN",accessedBy:"notifications-service",type:"read",timestamp:"2025-11-24T15:20:00Z",ip:"10.0.1.3"}]);O.useEffect(()=>{(async()=>{try{const w=await U5e();w.success&&w.logs&&s(w.logs)}catch(w){console.error("Failed to load audit log:",w)}})()},[]);const[i,l]=O.useState({}),[d,a]=O.useState(""),f=j=>{l(w=>({...w,[j]:!w[j]}))},p=j=>{navigator.clipboard.writeText(j)},y=j=>{switch(j){case"api_key":return"bg-blue-100 text-blue-800";case"password":return"bg-red-100 text-red-800";case"token":return"bg-green-100 text-green-800";case"certificate":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},v=e.filter(j=>j.key.toLowerCase().includes(d.toLowerCase()));return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Secrets Vault"}),t.jsx("p",{className:"text-muted-foreground",children:"Secure credential storage with encryption and rotation policies"})]}),t.jsxs(Sn,{defaultValue:"secrets",className:"w-full",children:[t.jsxs(bn,{className:"grid w-full grid-cols-2",children:[t.jsx(kt,{value:"secrets",children:"Secrets"}),t.jsx(kt,{value:"audit",children:"Access Audit"})]}),t.jsxs(Dt,{value:"secrets",className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Stored Secrets"}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[v.length," secrets encrypted"]})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Add Secret"]})]}),t.jsx(Ve,{placeholder:"Search secrets...",value:d,onChange:j=>a(j.target.value),className:"max-w-xs"}),t.jsx("div",{className:"space-y-2",children:v.map(j=>t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 items-center",children:[t.jsx("div",{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(qh,{className:"h-4 w-4 text-blue-500"}),t.jsx("p",{className:"font-mono font-medium text-sm",children:j.key})]})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"TYPE"}),t.jsx(Ee,{className:`mt-1 ${y(j.type)}`,children:j.type})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"OWNER"}),t.jsx("p",{className:"text-sm mt-1",children:j.owner})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"EXPIRES IN"}),t.jsx(Ee,{variant:"outline",className:j.expiresIn==="Never"?"":j.expiresIn.includes("30")?"border-yellow-300":"",children:j.expiresIn})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"LAST ROTATED"}),t.jsx("p",{className:"text-sm mt-1",children:j.lastRotated})]}),t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsx(X,{size:"sm",variant:"ghost",onClick:()=>f(j.id),children:i[j.id]?t.jsx(_V,{className:"h-4 w-4"}):t.jsx(ud,{className:"h-4 w-4"})}),t.jsx(X,{size:"sm",variant:"ghost",onClick:()=>p(""),children:t.jsx(x2,{className:"h-4 w-4"})}),t.jsx(X,{size:"sm",variant:"ghost",children:t.jsx(One,{className:"h-4 w-4"})}),t.jsx(X,{size:"sm",variant:"ghost",className:"text-red-500",children:t.jsx(As,{className:"h-4 w-4"})})]})]})})},j.id))}),t.jsxs(H,{className:"bg-amber-50 border-amber-200",children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ps,{className:"h-5 w-5 text-amber-600"}),t.jsx(he,{className:"text-amber-900",children:"Rotation Reminders"})]})}),t.jsxs(Q,{className:"text-sm text-amber-800 space-y-2",children:[t.jsx("p",{children:" SENDGRID_API_KEY - Rotate in 45 days"}),t.jsx("p",{children:" TWILIO_AUTH_TOKEN - Rotate in 30 days"}),t.jsx("p",{children:" DATABASE_PASSWORD - No expiration set"})]})]})]}),t.jsxs(Dt,{value:"audit",className:"space-y-4",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Access Audit Log"}),t.jsx("div",{className:"space-y-2",children:n.map(j=>t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-center",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-mono font-medium text-sm",children:j.secret}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:j.accessedBy})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"ACCESS TYPE"}),t.jsx(Ee,{variant:"outline",className:"mt-1",children:j.type})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"TIMESTAMP"}),t.jsx("p",{className:"text-sm mt-1",children:new Date(j.timestamp).toLocaleString()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"IP ADDRESS"}),t.jsx("p",{className:"font-mono text-sm mt-1",children:j.ip})]}),t.jsx("div",{className:"flex justify-end",children:t.jsx(X,{size:"sm",variant:"outline",children:"Details"})})]})})},j.id))})]})]})]})}function Y5e(){const e=[{name:"SCADA",description:"OPC-UA / MQTT telemetry",status:"available"},{name:"AMI",description:"DLMS / CSV / S3 meter data",status:"available"},{name:"ERP",description:"GL journal integration",status:"available"},{name:"WARIS",description:"Regulator reporting",status:"available"},{name:"NDMA",description:"Early warning feeds",status:"available"},{name:"Payments",description:"M-Pesa / Airtel Money",status:"available"},{name:"Messaging",description:"SMS / WhatsApp / Email",status:"available"},{name:"Custom",description:"Build your own",status:"available"}];return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Connector Gallery"}),t.jsx("p",{className:"text-muted-foreground",children:"Pre-built adapters for SCADA, AMI, ERP, and external systems"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:e.map(r=>t.jsxs(H,{className:"hover:border-primary transition-colors cursor-pointer",children:[t.jsxs(de,{children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(he,{className:"text-base",children:r.name}),t.jsx(Us,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsx(cr,{className:"text-xs",children:r.description})]}),t.jsx(Q,{children:t.jsx(X,{size:"sm",variant:"outline",className:"w-full",children:"Setup Connector"})})]},r.name))})]})}function X5e(){return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Webhook Manager"}),t.jsx("p",{className:"text-muted-foreground",children:"Configure webhooks for event notifications and callbacks"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Create Webhook"]})]}),t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"Active Webhooks"}),t.jsx(cr,{children:"Event subscriptions and delivery logs"})]}),t.jsx(Q,{children:t.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[t.jsx(kV,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),t.jsx("p",{children:"No webhooks configured. Create your first webhook above."})]})})]})]})}function Q5e(){return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"ETL Jobs"}),t.jsx("p",{className:"text-muted-foreground",children:"Extract, Transform, Load jobs for data integration"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Create ETL Job"]})]}),t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"Scheduled Jobs"}),t.jsx(cr,{children:"Import, export, and transformation pipelines"})]}),t.jsx(Q,{children:t.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[t.jsx(lo,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),t.jsx("p",{children:"No ETL jobs defined. Create your first job to start data integration."})]})})]})]})}function J5e(){return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Communication Templates"}),t.jsx("p",{className:"text-muted-foreground",children:"SMS, Email, WhatsApp templates with i18n support"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"}),"Create Template"]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:["SMS","Email","WhatsApp","USSD"].map(e=>t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{className:"text-base",children:e}),t.jsx(cr,{children:"0 templates"})]}),t.jsx(Q,{children:t.jsx(X,{size:"sm",variant:"outline",className:"w-full",children:"New Template"})})]},e))}),t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"Template Library"}),t.jsx(cr,{children:"All communication templates"})]}),t.jsx(Q,{children:t.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[t.jsx(sI,{className:"mx-auto h-12 w-12 mb-4 opacity-50"}),t.jsx("p",{children:"No templates created yet. Create templates for customer notifications."})]})})]})]})}function eze(){const[e,r]=O.useState(!1),{data:n}=ct({queryKey:["kpi-dashboard"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/kpis/dashboard/summary")).json()}),s=(n==null?void 0:n.data)||{water_coverage:78.5,nrw_percent:32.8,staff_efficiency:8.2,collection_efficiency:91.2};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"KPI Dashboard"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"WHO/JMP & WASREB aligned performance indicators"})]}),t.jsxs(X,{onClick:()=>r(!0),className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New KPI"]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Water Coverage"}),t.jsx(Qc,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[s.water_coverage,"%"]}),t.jsxs("div",{className:"flex items-center text-xs text-green-600",children:[t.jsx(xs,{className:"h-3 w-3 mr-1"}),"+2.3% from last quarter"]})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"NRW %"}),t.jsx(Qc,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[s.nrw_percent,"%"]}),t.jsxs("div",{className:"flex items-center text-xs text-green-600",children:[t.jsx(Xa,{className:"h-3 w-3 mr-1"}),"-4.2% improvement"]})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Staff Efficiency"}),t.jsx(Qc,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:s.staff_efficiency}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Connections per staff"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Collection Efficiency"}),t.jsx(Qc,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[s.collection_efficiency,"%"]}),t.jsxs("div",{className:"flex items-center text-xs text-green-600",children:[t.jsx(xs,{className:"h-3 w-3 mr-1"}),"+1.5%"]})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"KPI Catalog & Management"})}),t.jsx(Q,{children:t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx("p",{children:"KPI catalog, data entry, and threshold alerts"}),t.jsx("p",{className:"text-sm mt-2",children:"Production-ready data layer with real API integration"})]})})]})]})}function tze(){const{data:e}=ct({queryKey:["coverage-dashboard"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/coverage/dashboard")).json()}),{data:r}=ct({queryKey:["coverage-by-area"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/coverage/by-area")).json()}),n=(e==null?void 0:e.data)||{total_population:245800,population_served:193100,coverage_percent:78.5};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Coverage & Equity Analytics"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Water and sanitation coverage by area, demographic disaggregation, and equity analysis"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Total Population"}),t.jsx(Hs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:(n.total_population||245800).toLocaleString()}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all wards"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Population Served"}),t.jsx(gc,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:(n.population_served||193100).toLocaleString()}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"With piped connections"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Coverage Rate"}),t.jsx(Qf,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[n.coverage_percent,"%"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Overall water coverage"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Coverage Analytics"})}),t.jsx(Q,{children:t.jsxs(Sn,{defaultValue:"by-ward",className:"w-full",children:[t.jsxs(bn,{className:"grid w-full grid-cols-2",children:[t.jsx(kt,{value:"by-ward",children:"By Ward"}),t.jsx(kt,{value:"equity",children:"Equity Analysis"})]}),t.jsx(Dt,{value:"by-ward",className:"mt-4",children:t.jsxs("div",{className:"space-y-3",children:[t.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Ward-level coverage breakdown"}),r!=null&&r.data&&r.data.length>0?t.jsx("div",{className:"max-h-96 overflow-y-auto",children:r.data.map((s,i)=>{var l;return t.jsx("div",{className:"p-3 border rounded-lg",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"font-medium text-sm",children:s.area_type}),t.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[t.jsxs("span",{children:["Population: ",(s.population_total||0).toLocaleString()]}),t.jsxs("span",{children:["Served: ",(s.population_served||0).toLocaleString()]})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"text-lg font-bold",children:[(l=s.coverage_percent)==null?void 0:l.toFixed(1),"%"]}),t.jsx(xs,{className:"h-3 w-3 text-green-600 mt-1"})]})]})},`${s.area_id}-${i}`)})}):t.jsx("p",{className:"text-sm text-muted-foreground",children:"No coverage data available"})]})}),t.jsx(Dt,{value:"equity",className:"mt-4",children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Gender and income quintile disaggregation analysis"}),t.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[t.jsx("h4",{className:"font-medium text-sm mb-2",children:"Demographic Breakdowns"}),t.jsxs("ul",{className:"text-sm space-y-2 text-muted-foreground",children:[t.jsx("li",{children:" Gender: Male / Female population coverage differential"}),t.jsx("li",{children:" Income Quintiles: Q1-Q5 water access equity metrics"}),t.jsx("li",{children:" Geographic: Urban / Rural coverage disparity"}),t.jsx("li",{children:" Age Groups: Child / Adult / Senior population served"})]})]})]})})]})})]})]})}function rze(){const{data:e}=ct({queryKey:["nrw-dashboard"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/nrw/dashboard")).json()}),{data:r}=ct({queryKey:["nrw-initiatives"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/nrw/initiatives")).json()}),n=(e==null?void 0:e.data)||{current_nrw_percent:32.8,water_saved_m3_day:1850,average_roi_percent:185};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"NRW Program Tracker"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Non-Revenue Water initiatives, savings tracking, and ROI analysis"})]}),t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Initiative"]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Current NRW %"}),t.jsx(gc,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[n.current_nrw_percent,"%"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Down from 37% baseline"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Water Saved"}),t.jsx(Xa,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[n.water_saved_m3_day.toLocaleString()," m/day"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Cumulative savings"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Investment ROI"}),t.jsx(co,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[Math.round(n.average_roi_percent),"%"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Average payback ROI"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Initiative Pipeline"})}),t.jsx(Q,{children:t.jsxs(Sn,{defaultValue:"all",className:"w-full",children:[t.jsxs(bn,{className:"grid w-full grid-cols-4",children:[t.jsx(kt,{value:"all",children:"All"}),t.jsx(kt,{value:"proposed",children:"Proposed"}),t.jsx(kt,{value:"active",children:"Active"}),t.jsx(kt,{value:"verified",children:"Verified"})]}),t.jsx(Dt,{value:"all",className:"mt-4",children:t.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:r!=null&&r.data&&r.data.length>0?r.data.map(s=>t.jsx("div",{className:"p-3 border rounded-lg",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-sm",children:s.name}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Type: ",s.type.replace("_"," ")," | Stage: ",s.stage]}),s.roi_percent&&t.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["ROI: ",s.roi_percent.toFixed(1),"%"]})]}),t.jsxs("span",{className:"text-xs text-muted-foreground",children:["Cost: $",s.cost.toLocaleString()]})]})},s.id)):t.jsx("p",{className:"text-sm text-muted-foreground",children:"No initiatives yet"})})})]})})]})]})}function nze(){const{data:e}=ct({queryKey:["surveys-analytics"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/surveys/analytics/summary")).json()}),{data:r}=ct({queryKey:["surveys"],queryFn:async()=>(await fetch("/api/v1/monitoring-evaluation/surveys")).json()}),n=(e==null?void 0:e.data)||{nps_score:42,csat_avg:4.2,total_responses:1250,active_surveys:3,response_rate_percent:28};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Customer Experience Analytics"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"NPS, CSAT, and CES tracking, survey management, and sentiment analysis"})]}),t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Survey"]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"NPS Score"}),t.jsx(Ka,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:n.nps_score}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Net Promoter Score"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"CSAT"}),t.jsx(CV,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[n.csat_avg.toFixed(1)," / 5"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Customer Satisfaction"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Response Rate"}),t.jsx(AV,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[n.response_rate_percent,"%"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Survey participation"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Total Responses"}),t.jsx(sd,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:n.total_responses.toLocaleString()}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Cumulative feedback"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Active Surveys"}),t.jsx(Ka,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:n.active_surveys}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Running campaigns"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Survey Campaigns"})}),t.jsx(Q,{children:t.jsxs(Sn,{defaultValue:"all",className:"w-full",children:[t.jsxs(bn,{className:"grid w-full grid-cols-3",children:[t.jsx(kt,{value:"all",children:"All"}),t.jsx(kt,{value:"active",children:"Active"}),t.jsx(kt,{value:"closed",children:"Closed"})]}),t.jsx(Dt,{value:"all",className:"mt-4",children:r!=null&&r.data&&r.data.length>0?t.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:r.data.map(s=>t.jsx("div",{className:"p-3 border rounded-lg",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-sm",children:s.name}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Type: ",s.type.toUpperCase()," | Channel: ",s.channel," | Status: ",s.status]})]}),t.jsxs("span",{className:"text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded",children:[s.responses_count||0," responses"]})]})},s.id))}):t.jsx("p",{className:"text-sm text-muted-foreground",children:"No surveys yet"})})]})})]})]})}function sze(){var i;const[e,r]=O.useState(null),{data:n}=ct({queryKey:["indicators",e],queryFn:async()=>{const l=new URL("/api/v1/monitoring-evaluation/indicators",window.location.origin);return e&&l.searchParams.set("level",e),(await fetch(l)).json()}}),s=[{id:"impact",label:"Impact Indicators",color:"bg-red-100 text-red-800"},{id:"outcome",label:"Outcome Indicators",color:"bg-orange-100 text-orange-800"},{id:"output",label:"Output Indicators",color:"bg-blue-100 text-blue-800"},{id:"activity",label:"Activity Indicators",color:"bg-green-100 text-green-800"}];return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Results Framework & Logframe"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Impact, outcome, output, and activity indicators with baseline and target tracking"})]}),t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Indicator"]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:s.map(l=>{var d;return t.jsxs(H,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>r(e===l.id?null:l.id),children:[t.jsx(de,{className:"pb-3",children:t.jsx(he,{className:"text-sm",children:l.label})}),t.jsx(Q,{children:t.jsxs("div",{className:`inline-block px-2 py-1 rounded text-xs font-medium ${l.color}`,children:[((d=n==null?void 0:n.data)==null?void 0:d.filter(a=>a.level===l.id).length)||0," indicators"]})})]},l.id)})}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(hg,{className:"h-5 w-5"}),"Indicator Management"]})}),t.jsx(Q,{children:e?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Displaying ",(i=s.find(l=>l.id===e))==null?void 0:i.label]}),n!=null&&n.data&&n.data.length>0?t.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:n.data.map(l=>t.jsx("div",{className:"p-3 border rounded-lg",children:t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"font-medium text-sm",children:l.name}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:l.code}),l.target_value&&t.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs",children:[t.jsx(xs,{className:"h-3 w-3"}),"Target: ",l.target_value," ",l.unit||""]})]})})},l.id))}):t.jsx("p",{className:"text-sm text-muted-foreground",children:"No indicators for this level yet"})]}):t.jsx("p",{className:"text-muted-foreground",children:"Select a level to view indicators, manage baselines, targets, and track progress data"})})]})]})}const Hn="/crm",Zs={getTariffs:e=>xe.get(`${Hn}/tariffs`,{params:e}),getTariff:e=>xe.get(`${Hn}/tariffs/${e}`),createTariff:e=>xe.post(`${Hn}/tariffs`,e),updateTariff:(e,r)=>xe.patch(`${Hn}/tariffs/${e}`,r),deleteTariff:e=>xe.delete(`${Hn}/tariffs/${e}`),calculateTariff:(e,r)=>xe.post(`${Hn}/tariffs/calculate`,{tariff_id:e,consumption:r}),getBillingRuns:e=>xe.get(`${Hn}/billing/runs`,{params:e}),previewBilling:e=>xe.post(`${Hn}/billing/preview`,e),executeBilling:e=>xe.post(`${Hn}/billing/execute`,e),getPayments:e=>xe.get(`${Hn}/reconciliation/payments`,{params:e}),reconcilePayment:(e,r)=>xe.post(`${Hn}/reconciliation/reconcile`,{payment_id:e,invoice_ids:r}),getAgingReport:()=>xe.get(`${Hn}/reconciliation/aging`),getMeterRoutes:e=>xe.get(`${Hn}/meter-routes`,{params:e}),createMeterRoute:e=>xe.post(`${Hn}/meter-routes`,e),updateMeterRoute:(e,r)=>xe.patch(`${Hn}/meter-routes/${e}`,r),deleteMeterRoute:e=>xe.delete(`${Hn}/meter-routes/${e}`),downloadOfflinePackage:e=>xe.get(`${Hn}/meter-routes/${e}/offline`),uploadMeterReads:(e,r)=>xe.post(`${Hn}/meter-routes/${e}/upload`,{reads:r}),getConnectionApplications:e=>xe.get(`${Hn}/connections/applications`,{params:e}),submitApplication:e=>xe.post(`${Hn}/connections/apply`,e),updateApplication:(e,r)=>xe.patch(`${Hn}/connections/applications/${e}`,r),getDisconnections:e=>xe.get(`${Hn}/connections/disconnections`,{params:e}),requestDisconnection:e=>xe.post(`${Hn}/connections/disconnect`,e),reconnectAccount:e=>xe.post(`${Hn}/connections/reconnect`,e),getKiosks:e=>xe.get(`${Hn}/kiosks`,{params:e}),createKiosk:e=>xe.post(`${Hn}/kiosks`,e),updateKiosk:(e,r)=>xe.patch(`${Hn}/kiosks/${e}`,r),deleteKiosk:e=>xe.delete(`${Hn}/kiosks/${e}`),getKioskSales:(e,r)=>xe.get(`${Hn}/kiosks/${e}/sales`,{params:r}),getTrucks:e=>xe.get(`${Hn}/kiosks/trucks`,{params:e})};function ize(){var T,I;const[e,r]=O.useState(!1),[n,s]=O.useState(null),[i,l]=O.useState("all"),[d,a]=O.useState(""),f=Sr(),{data:p,isLoading:y}=ct({queryKey:["tariffs",i,d],queryFn:()=>Zs.getTariffs({status:i==="all"?void 0:i,search:d||void 0,per_page:50})}),v=Nt({mutationFn:Zs.createTariff,onSuccess:()=>{f.invalidateQueries({queryKey:["tariffs"]}),r(!1),s(null),Ge.success("Tariff created successfully")},onError:L=>{var $,W;Ge.error(((W=($=L.response)==null?void 0:$.data)==null?void 0:W.message)||"Failed to create tariff")}}),j=Nt({mutationFn:({id:L,data:$})=>Zs.updateTariff(L,$),onSuccess:()=>{f.invalidateQueries({queryKey:["tariffs"]}),r(!1),s(null),Ge.success("Tariff updated successfully")},onError:L=>{var $,W;Ge.error(((W=($=L.response)==null?void 0:$.data)==null?void 0:W.message)||"Failed to update tariff")}}),w=Nt({mutationFn:Zs.deleteTariff,onSuccess:()=>{f.invalidateQueries({queryKey:["tariffs"]}),Ge.success("Tariff deleted successfully")},onError:L=>{var $,W;Ge.error(((W=($=L.response)==null?void 0:$.data)==null?void 0:W.message)||"Failed to delete tariff")}}),k=L=>{L.preventDefault();const $=new FormData(L.currentTarget),W=[];let Z=0;for(;$.has(`block_${Z}_min`);)W.push({min:parseFloat($.get(`block_${Z}_min`)),max:$.get(`block_${Z}_max`)?parseFloat($.get(`block_${Z}_max`)):null,rate:parseFloat($.get(`block_${Z}_rate`)),lifeline:$.get(`block_${Z}_lifeline`)==="on"}),Z++;const oe={name:$.get("name"),valid_from:$.get("valid_from"),valid_to:$.get("valid_to")||null,blocks:W,fixed_charge:parseFloat($.get("fixed_charge"))||0,currency:$.get("currency")||"KES"};n?j.mutate({id:n.id,data:oe}):v.mutate(oe)},S=L=>{s(L),r(!0)},R=L=>{confirm("Are you sure you want to delete this tariff?")&&w.mutate(L)},D=L=>{const $=new Date,W=new Date(L.valid_from),Z=L.valid_to?new Date(L.valid_to):null;return W>$?t.jsx(Ee,{variant:"secondary",children:"Future"}):Z&&Z<$?t.jsx(Ee,{variant:"destructive",children:"Expired"}):t.jsx(Ee,{className:"bg-green-600",children:"Active"})};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Customer Tariffs"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Water pricing structures by customer category"})]}),t.jsxs(Or,{open:e,onOpenChange:r,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{onClick:()=>s(null),children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Create Tariff"]})}),t.jsxs(kr,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[t.jsx(Tr,{children:t.jsx(Er,{children:n?"Edit Tariff":"Create New Tariff"})}),t.jsxs("form",{onSubmit:k,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"name",children:"Tariff Name"}),t.jsx(Ve,{id:"name",name:"name",defaultValue:n==null?void 0:n.name,required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"currency",children:"Currency"}),t.jsx(Ve,{id:"currency",name:"currency",defaultValue:(n==null?void 0:n.currency)||"KES",maxLength:3})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"valid_from",children:"Valid From"}),t.jsx(Ve,{id:"valid_from",name:"valid_from",type:"date",defaultValue:n==null?void 0:n.valid_from,required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"valid_to",children:"Valid To (Optional)"}),t.jsx(Ve,{id:"valid_to",name:"valid_to",type:"date",defaultValue:(n==null?void 0:n.valid_to)||""})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx(Me,{htmlFor:"fixed_charge",children:"Fixed Charge"}),t.jsx(Ve,{id:"fixed_charge",name:"fixed_charge",type:"number",step:"0.01",defaultValue:(n==null?void 0:n.fixed_charge)||0})]})]}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsx("h3",{className:"font-semibold mb-3",children:"Rate Blocks"}),((n==null?void 0:n.blocks)||[{min:0,max:10,rate:50,lifeline:!0}]).map((L,$)=>t.jsxs("div",{className:"grid grid-cols-5 gap-2 mb-2",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:`block_${$}_min`,children:"Min (m)"}),t.jsx(Ve,{id:`block_${$}_min`,name:`block_${$}_min`,type:"number",step:"0.01",defaultValue:L.min,required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:`block_${$}_max`,children:"Max (m)"}),t.jsx(Ve,{id:`block_${$}_max`,name:`block_${$}_max`,type:"number",step:"0.01",defaultValue:L.max||"",placeholder:""})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:`block_${$}_rate`,children:"Rate"}),t.jsx(Ve,{id:`block_${$}_rate`,name:`block_${$}_rate`,type:"number",step:"0.01",defaultValue:L.rate,required:!0})]}),t.jsx("div",{className:"flex items-end",children:t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",name:`block_${$}_lifeline`,defaultChecked:L.lifeline}),t.jsx("span",{className:"text-sm",children:"Lifeline"})]})})]},$)),t.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Add more blocks by manually editing after creation"})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsxs(X,{type:"submit",disabled:v.isPending||j.isPending,children:[n?"Update":"Create"," Tariff"]})]})]})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(co,{className:"h-5 w-5"}),"Tariff Management"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Ve,{placeholder:"Search tariffs...",value:d,onChange:L=>a(L.target.value),className:"w-64"}),t.jsxs($t,{value:i,onValueChange:L=>l(L),children:[t.jsx(Rt,{className:"w-32",children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All"}),t.jsx(Ne,{value:"active",children:"Active"}),t.jsx(Ne,{value:"expired",children:"Expired"}),t.jsx(Ne,{value:"future",children:"Future"})]})]})]})]})}),t.jsx(Q,{children:y?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading tariffs..."}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Tariff Name"}),t.jsx(ce,{children:"Valid Period"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Blocks"}),t.jsx(ce,{children:"Fixed Charge"}),t.jsx(ce,{className:"text-right",children:"Actions"})]})}),t.jsxs(mr,{children:[(T=p==null?void 0:p.data)==null?void 0:T.map(L=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:L.name}),t.jsx(se,{children:t.jsxs("div",{className:"text-sm",children:[t.jsxs("div",{children:["From: ",new Date(L.valid_from).toLocaleDateString()]}),L.valid_to&&t.jsxs("div",{children:["To: ",new Date(L.valid_to).toLocaleDateString()]})]})}),t.jsx(se,{children:D(L)}),t.jsxs(se,{children:[L.blocks.length," blocks"]}),t.jsxs(se,{children:[L.currency," ",L.fixed_charge.toFixed(2)]}),t.jsx(se,{className:"text-right",children:t.jsxs("div",{className:"flex gap-2 justify-end",children:[t.jsx(X,{variant:"ghost",size:"sm",onClick:()=>S(L),children:t.jsx(Dl,{className:"h-4 w-4"})}),t.jsx(X,{variant:"ghost",size:"sm",onClick:()=>R(L.id),children:t.jsx(As,{className:"h-4 w-4"})})]})})]},L.id)),((I=p==null?void 0:p.data)==null?void 0:I.length)===0&&t.jsx(ut,{children:t.jsx(se,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No tariffs found. Create your first tariff to get started."})})]})]})})]})]})}function aze(){var w,k;const[e,r]=O.useState(!1),[n,s]=O.useState(null),[i,l]=O.useState(1),d=Sr(),{data:a,isLoading:f}=ct({queryKey:["billing-runs"],queryFn:()=>Zs.getBillingRuns({per_page:50})}),p=Nt({mutationFn:Zs.previewBilling,onSuccess:S=>{s(S),l(2)},onError:S=>{var R,D;Ge.error(((D=(R=S.response)==null?void 0:R.data)==null?void 0:D.message)||"Failed to generate preview")}}),y=Nt({mutationFn:Zs.executeBilling,onSuccess:S=>{d.invalidateQueries({queryKey:["billing-runs"]}),r(!1),l(1),s(null),Ge.success(`Billing run completed: ${S.invoices_created} invoices created`)},onError:S=>{var R,D;Ge.error(((D=(R=S.response)==null?void 0:R.data)==null?void 0:D.message)||"Failed to execute billing run")}}),v=S=>{S.preventDefault();const R=new FormData(S.currentTarget);p.mutate({period_start:R.get("period_start"),period_end:R.get("period_end"),segment:R.get("segment")||void 0,limit:10})},j=()=>{if(!n)return;const S=new FormData(document.querySelector("form"));y.mutate({period_start:S.get("period_start"),period_end:S.get("period_end"),due_date:S.get("due_date"),segment:S.get("segment")||void 0})};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Billing Runs"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Monthly billing execution and invoice generation"})]}),t.jsxs(Or,{open:e,onOpenChange:r,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{onClick:()=>{l(1),s(null)},children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"New Billing Run"]})}),t.jsxs(kr,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[t.jsx(Tr,{children:t.jsx(Er,{children:i===1?"Step 1: Configure Billing Period":"Step 2: Review & Execute"})}),i===1&&t.jsxs("form",{onSubmit:v,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"period_start",children:"Billing Period Start"}),t.jsx(Ve,{id:"period_start",name:"period_start",type:"date",required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"period_end",children:"Billing Period End"}),t.jsx(Ve,{id:"period_end",name:"period_end",type:"date",required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"due_date",children:"Invoice Due Date"}),t.jsx(Ve,{id:"due_date",name:"due_date",type:"date",required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"segment",children:"Customer Segment (Optional)"}),t.jsxs("select",{id:"segment",name:"segment",className:"w-full border rounded-md p-2",children:[t.jsx("option",{value:"",children:"All Customers"}),t.jsx("option",{value:"residential",children:"Residential"}),t.jsx("option",{value:"commercial",children:"Commercial"}),t.jsx("option",{value:"industrial",children:"Industrial"}),t.jsx("option",{value:"public",children:"Public"})]})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsxs(X,{type:"submit",disabled:p.isPending,children:[t.jsx(ud,{className:"h-4 w-4 mr-2"}),"Preview"]})]})]}),i===2&&n&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("div",{className:"text-2xl font-bold",children:n.preview_count}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Accounts"})]})}),t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("div",{className:"text-2xl font-bold",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(n.total_estimated)}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Estimated"})]})}),t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("div",{className:"text-sm font-medium",children:n.period_start}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Period Start"})]})}),t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("div",{className:"text-sm font-medium",children:n.period_end}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Period End"})]})})]}),t.jsx("div",{className:"border rounded-lg",children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Account No"}),t.jsx(ce,{children:"Customer"}),t.jsx(ce,{className:"text-right",children:"Consumption (m)"}),t.jsx(ce,{className:"text-right",children:"Estimated Charge"}),t.jsx(ce,{children:"Tariff"})]})}),t.jsx(mr,{children:n.accounts.map((S,R)=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-mono",children:S.account_no}),t.jsx(se,{children:S.customer_name}),t.jsx(se,{className:"text-right",children:S.consumption.toFixed(2)}),t.jsx(se,{className:"text-right",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(S.estimated_charge)}),t.jsx(se,{children:S.tariff})]},R))})]})}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>l(1),children:"Back"}),t.jsxs(X,{onClick:j,disabled:y.isPending,children:[t.jsx(El,{className:"h-4 w-4 mr-2"}),"Execute Billing Run"]})]})]})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(GT,{className:"h-5 w-5"}),"Billing Run History"]})}),t.jsx(Q,{children:f?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading billing runs..."}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Period"}),t.jsx(ce,{children:"Period Dates"}),t.jsx(ce,{className:"text-right",children:"Invoice Count"}),t.jsx(ce,{className:"text-right",children:"Total Amount"}),t.jsx(ce,{children:"Created At"})]})}),t.jsxs(mr,{children:[(w=a==null?void 0:a.data)==null?void 0:w.map((S,R)=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:S.period}),t.jsx(se,{children:t.jsxs("div",{className:"text-sm",children:[new Date(S.period_start).toLocaleDateString()," - ",new Date(S.period_end).toLocaleDateString()]})}),t.jsx(se,{className:"text-right",children:S.invoice_count.toLocaleString()}),t.jsx(se,{className:"text-right",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(S.total_amount)}),t.jsx(se,{children:new Date(S.created_at).toLocaleString()})]},R)),((k=a==null?void 0:a.data)==null?void 0:k.length)===0&&t.jsx(ut,{children:t.jsx(se,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No billing runs found. Create your first billing run to generate invoices."})})]})]})})]})]})}function oze(){var v,j;const[e,r]=O.useState("all"),[n,s]=O.useState("all"),[i,l]=O.useState(""),d=Sr(),{data:a,isLoading:f}=ct({queryKey:["payments",e,n,i],queryFn:()=>Zs.getPayments({channel:e!=="all"?e:void 0,status:n!=="all"?n:void 0,search:i||void 0,per_page:50})}),{data:p}=ct({queryKey:["aging-report"],queryFn:()=>Zs.getAgingReport()});Nt({mutationFn:({paymentId:w,invoiceIds:k})=>Zs.reconcilePayment(w,k),onSuccess:()=>{d.invalidateQueries({queryKey:["payments"]}),d.invalidateQueries({queryKey:["aging-report"]}),Ge.success("Payment reconciled successfully")},onError:w=>{var k,S;Ge.error(((S=(k=w.response)==null?void 0:k.data)==null?void 0:S.message)||"Failed to reconcile payment")}});const y=w=>{const k={cash:"bg-green-600",bank:"bg-blue-600",mpesa:"bg-purple-600",online:"bg-orange-600",adjustment:"bg-gray-600"};return t.jsx(Ee,{className:k[w]||"bg-gray-600",children:w.toUpperCase()})};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Payment Reconciliation"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Match payments to invoices across all channels"})]}),p&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(Xa,{className:"h-5 w-5"}),"Aging Summary"]})}),t.jsxs(Q,{children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold",children:p.summary.total_accounts.toLocaleString()}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Accounts"})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(p.summary.total_balance)}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Balance"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"text-xl font-semibold",children:[p.dso," days"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"DSO (Days Sales Outstanding)"})]})]}),t.jsx(Za,{width:"100%",height:200,children:t.jsxs(Ny,{data:p.aging_buckets,children:[t.jsx(Io,{strokeDasharray:"3 3"}),t.jsx(xa,{dataKey:"bucket"}),t.jsx(Bi,{}),t.jsx(Gs,{}),t.jsx(Ha,{dataKey:"amount",fill:"#8884d8"})]})})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Top 5 Debtors"})}),t.jsx(Q,{children:t.jsx("div",{className:"space-y-3",children:p.top_debtors.slice(0,5).map((w,k)=>t.jsxs("div",{className:"flex justify-between items-center p-2 border rounded",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:w.customer_name}),t.jsx("div",{className:"text-xs text-muted-foreground",children:w.account_no})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"font-semibold",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(w.balance)}),t.jsxs("div",{className:"text-xs text-muted-foreground",children:["90+: ",new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(w.over_90)]})]})]},k))})})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(nI,{className:"h-5 w-5"}),"Reconciliation Console"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Ve,{placeholder:"Search account or ref...",value:i,onChange:w=>l(w.target.value),className:"w-64"}),t.jsxs($t,{value:e,onValueChange:r,children:[t.jsx(Rt,{className:"w-32",children:t.jsx(Bt,{placeholder:"Channel"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All"}),t.jsx(Ne,{value:"cash",children:"Cash"}),t.jsx(Ne,{value:"bank",children:"Bank"}),t.jsx(Ne,{value:"mpesa",children:"M-Pesa"}),t.jsx(Ne,{value:"online",children:"Online"}),t.jsx(Ne,{value:"adjustment",children:"Adjustment"})]})]}),t.jsxs($t,{value:n,onValueChange:s,children:[t.jsx(Rt,{className:"w-40",children:t.jsx(Bt,{placeholder:"Status"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All"}),t.jsx(Ne,{value:"reconciled",children:"Reconciled"}),t.jsx(Ne,{value:"unreconciled",children:"Unreconciled"})]})]})]})]})}),t.jsx(Q,{children:f?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading payments..."}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Account No"}),t.jsx(ce,{children:"Payment Date"}),t.jsx(ce,{className:"text-right",children:"Amount"}),t.jsx(ce,{children:"Channel"}),t.jsx(ce,{children:"Reference"}),t.jsx(ce,{children:"Customer"}),t.jsx(ce,{className:"text-right",children:"Actions"})]})}),t.jsxs(mr,{children:[(v=a==null?void 0:a.data)==null?void 0:v.map(w=>{var k;return t.jsxs(ut,{children:[t.jsx(se,{className:"font-mono",children:w.account_no}),t.jsx(se,{children:new Date(w.paid_at).toLocaleDateString()}),t.jsx(se,{className:"text-right font-medium",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(w.amount)}),t.jsx(se,{children:y(w.channel)}),t.jsx(se,{className:"font-mono text-xs",children:w.ref||"N/A"}),t.jsx(se,{children:(k=w.connection)!=null&&k.customer?`${w.connection.customer.first_name} ${w.connection.customer.last_name}`:"N/A"}),t.jsx(se,{className:"text-right",children:t.jsx(X,{size:"sm",variant:"outline",onClick:()=>{Ge.info("Manual reconciliation dialog would open here")},children:"Reconcile"})})]},w.id)}),((j=a==null?void 0:a.data)==null?void 0:j.length)===0&&t.jsx(ut,{children:t.jsx(se,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No payments found. Adjust filters to see more results."})})]})]})})]})]})}function lze(){var R,D;const[e,r]=O.useState(!1),[n,s]=O.useState(null),i=Sr(),{data:l,isLoading:d}=ct({queryKey:["meter-routes"],queryFn:()=>Zs.getMeterRoutes({per_page:50})}),a=Nt({mutationFn:Zs.createMeterRoute,onSuccess:()=>{i.invalidateQueries({queryKey:["meter-routes"]}),r(!1),s(null),Ge.success("Route created successfully")},onError:T=>{var I,L;Ge.error(((L=(I=T.response)==null?void 0:I.data)==null?void 0:L.message)||"Failed to create route")}}),f=Nt({mutationFn:({id:T,data:I})=>Zs.updateMeterRoute(T,I),onSuccess:()=>{i.invalidateQueries({queryKey:["meter-routes"]}),r(!1),s(null),Ge.success("Route updated successfully")},onError:T=>{var I,L;Ge.error(((L=(I=T.response)==null?void 0:I.data)==null?void 0:L.message)||"Failed to update route")}}),p=Nt({mutationFn:Zs.deleteMeterRoute,onSuccess:()=>{i.invalidateQueries({queryKey:["meter-routes"]}),Ge.success("Route deleted successfully")},onError:T=>{var I,L;Ge.error(((L=(I=T.response)==null?void 0:I.data)==null?void 0:L.message)||"Failed to delete route")}}),y=Nt({mutationFn:Zs.downloadOfflinePackage,onSuccess:T=>{const I=new Blob([JSON.stringify(T,null,2)],{type:"application/json"}),L=URL.createObjectURL(I),$=document.createElement("a");$.href=L,$.download=`route-${T.route_id}-offline.json`,$.click(),Ge.success("Offline package downloaded")},onError:()=>{Ge.error("Failed to download offline package")}}),v=T=>{T.preventDefault();const I=new FormData(T.currentTarget),L={route_code:I.get("route_code"),area:I.get("area"),assigned_to:I.get("assigned_to")||null,meters_count:parseInt(I.get("meters_count"))};n?f.mutate({id:n.id,data:L}):a.mutate(L)},j=T=>{y.mutate(T)},w=T=>{s(T),r(!0)},k=T=>{confirm("Are you sure you want to delete this route?")&&p.mutate(T)},S=T=>{const I={active:"bg-green-600",unassigned:"bg-yellow-600",inactive:"bg-gray-600"};return t.jsx(Ee,{className:I[T]||"bg-gray-600",children:T.toUpperCase()})};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Meter Reading Routes"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Route planning and reading cycle management"})]}),t.jsxs(Or,{open:e,onOpenChange:r,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{onClick:()=>s(null),children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Create Route"]})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:n?"Edit Route":"Create New Route"})}),t.jsxs("form",{onSubmit:v,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"route_code",children:"Route Code"}),t.jsx(Ve,{id:"route_code",name:"route_code",defaultValue:n==null?void 0:n.route_code,required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"area",children:"Area/Zone"}),t.jsx(Ve,{id:"area",name:"area",defaultValue:n==null?void 0:n.area,required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"assigned_to",children:"Assigned To (Optional)"}),t.jsx(Ve,{id:"assigned_to",name:"assigned_to",defaultValue:(n==null?void 0:n.assigned_to)||""})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"meters_count",children:"Number of Meters"}),t.jsx(Ve,{id:"meters_count",name:"meters_count",type:"number",defaultValue:n==null?void 0:n.meters_count,required:!0})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsxs(X,{type:"submit",disabled:a.isPending||f.isPending,children:[n?"Update":"Create"," Route"]})]})]})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(Ma,{className:"h-5 w-5"}),"Route Management"]})}),t.jsx(Q,{children:d?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading routes..."}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Route Code"}),t.jsx(ce,{children:"Area"}),t.jsx(ce,{children:"Assigned To"}),t.jsx(ce,{className:"text-right",children:"Meters"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Last Read"}),t.jsx(ce,{className:"text-right",children:"Completion"}),t.jsx(ce,{className:"text-right",children:"Actions"})]})}),t.jsxs(mr,{children:[(R=l==null?void 0:l.data)==null?void 0:R.map(T=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:T.route_code}),t.jsx(se,{children:T.area}),t.jsx(se,{children:T.assigned_to||t.jsx("span",{className:"text-muted-foreground",children:"Unassigned"})}),t.jsx(se,{className:"text-right",children:T.meters_count}),t.jsx(se,{children:S(T.status)}),t.jsx(se,{children:T.last_read_date?new Date(T.last_read_date).toLocaleDateString():"Never"}),t.jsxs(se,{className:"text-right",children:[T.completion_rate.toFixed(1),"%"]}),t.jsx(se,{className:"text-right",children:t.jsxs("div",{className:"flex gap-1 justify-end",children:[t.jsx(X,{variant:"ghost",size:"sm",title:"Download offline package",onClick:()=>j(T.id),children:t.jsx(Ta,{className:"h-4 w-4"})}),t.jsx(X,{variant:"ghost",size:"sm",onClick:()=>w(T),children:t.jsx(Dl,{className:"h-4 w-4"})}),t.jsx(X,{variant:"ghost",size:"sm",onClick:()=>k(T.id),children:t.jsx(As,{className:"h-4 w-4"})})]})})]},T.id)),((D=l==null?void 0:l.data)==null?void 0:D.length)===0&&t.jsx(ut,{children:t.jsx(se,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No routes found. Create your first route to organize meter reading."})})]})]})})]})]})}function cze(){return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"CRM Tickets"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Customer support ticket management and SLA tracking"})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(wN,{className:"h-5 w-5"}),"Ticket Queue"]})}),t.jsx(Q,{children:t.jsx("p",{className:"text-muted-foreground",children:"Ticket creation, assignment, and resolution tracking coming soon..."})})]})]})}function dze(){var L,$,W,Z,oe,te,be;const[e,r]=O.useState(!1),[n,s]=O.useState(null),[i,l]=O.useState("all"),[d,a]=O.useState(null),f=Sr(),{data:p,isLoading:y}=ct({queryKey:["kiosks",i],queryFn:()=>Zs.getKiosks({status:i&&i!=="all"?i:void 0,per_page:50})}),{data:v}=ct({queryKey:["kiosk-sales",d],queryFn:()=>d?Zs.getKioskSales(d):null,enabled:!!d}),{data:j}=ct({queryKey:["trucks"],queryFn:()=>Zs.getTrucks()}),w=Nt({mutationFn:Zs.createKiosk,onSuccess:()=>{f.invalidateQueries({queryKey:["kiosks"]}),r(!1),s(null),Ge.success("Kiosk created successfully")},onError:ie=>{var ge,Ie;Ge.error(((Ie=(ge=ie.response)==null?void 0:ge.data)==null?void 0:Ie.message)||"Failed to create kiosk")}}),k=Nt({mutationFn:({id:ie,data:ge})=>Zs.updateKiosk(ie,ge),onSuccess:()=>{f.invalidateQueries({queryKey:["kiosks"]}),r(!1),s(null),Ge.success("Kiosk updated successfully")},onError:ie=>{var ge,Ie;Ge.error(((Ie=(ge=ie.response)==null?void 0:ge.data)==null?void 0:Ie.message)||"Failed to update kiosk")}}),S=Nt({mutationFn:Zs.deleteKiosk,onSuccess:()=>{f.invalidateQueries({queryKey:["kiosks"]}),Ge.success("Kiosk deleted successfully")},onError:ie=>{var ge,Ie;Ge.error(((Ie=(ge=ie.response)==null?void 0:ge.data)==null?void 0:Ie.message)||"Failed to delete kiosk")}}),R=ie=>{ie.preventDefault();const ge=new FormData(ie.currentTarget),Ie={kiosk_code:ge.get("kiosk_code"),vendor_name:ge.get("vendor_name"),vendor_phone:ge.get("vendor_phone"),location:ge.get("location"),coordinates:{lat:parseFloat(ge.get("lat")),lng:parseFloat(ge.get("lng"))},daily_target:parseFloat(ge.get("daily_target"))};n?k.mutate({id:n.id,data:Ie}):w.mutate(Ie)},D=ie=>{s(ie),r(!0)},T=ie=>{confirm("Are you sure you want to delete this kiosk?")&&S.mutate(ie)},I=ie=>{const ge={active:"bg-green-600",suspended:"bg-red-600",inactive:"bg-gray-600"};return t.jsx(Ee,{className:ge[ie]||"bg-gray-600",children:ie.toUpperCase()})};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Water Kiosks & Trucking"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Kiosk registry, vendor management, and sales tracking"})]}),t.jsxs(Or,{open:e,onOpenChange:r,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{onClick:()=>s(null),children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Register Kiosk"]})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:n?"Edit Kiosk":"Register New Kiosk"})}),t.jsxs("form",{onSubmit:R,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"kiosk_code",children:"Kiosk Code"}),t.jsx(Ve,{id:"kiosk_code",name:"kiosk_code",defaultValue:n==null?void 0:n.kiosk_code,required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"vendor_name",children:"Vendor Name"}),t.jsx(Ve,{id:"vendor_name",name:"vendor_name",defaultValue:n==null?void 0:n.vendor_name,required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"vendor_phone",children:"Vendor Phone"}),t.jsx(Ve,{id:"vendor_phone",name:"vendor_phone",type:"tel",defaultValue:n==null?void 0:n.vendor_phone,required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"daily_target",children:"Daily Target (KES)"}),t.jsx(Ve,{id:"daily_target",name:"daily_target",type:"number",defaultValue:n==null?void 0:n.daily_target,required:!0})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx(Me,{htmlFor:"location",children:"Location Description"}),t.jsx(Ve,{id:"location",name:"location",defaultValue:n==null?void 0:n.location,required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"lat",children:"Latitude"}),t.jsx(Ve,{id:"lat",name:"lat",type:"number",step:"any",defaultValue:(n==null?void 0:n.coordinates.lat)||-1.286389,required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"lng",children:"Longitude"}),t.jsx(Ve,{id:"lng",name:"lng",type:"number",step:"any",defaultValue:(n==null?void 0:n.coordinates.lng)||36.817223,required:!0})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),t.jsxs(X,{type:"submit",disabled:w.isPending||k.isPending,children:[n?"Update":"Register"," Kiosk"]})]})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("div",{className:"text-2xl font-bold",children:((L=p==null?void 0:p.summary)==null?void 0:L.total_kiosks)||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Kiosks"})]})}),t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("div",{className:"text-2xl font-bold",children:(($=p==null?void 0:p.summary)==null?void 0:$.active_kiosks)||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Active Kiosks"})]})}),t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("div",{className:"text-2xl font-bold",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(((W=p==null?void 0:p.summary)==null?void 0:W.today_total_sales)||0)}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Today's Sales"})]})}),t.jsx(H,{children:t.jsxs(Q,{className:"pt-6",children:[t.jsx("div",{className:"text-2xl font-bold",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(((Z=p==null?void 0:p.summary)==null?void 0:Z.total_balance)||0)}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Balance"})]})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs(H,{className:"lg:col-span-2",children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(UT,{className:"h-5 w-5"}),"Kiosk Registry"]}),t.jsxs($t,{value:i,onValueChange:l,children:[t.jsx(Rt,{className:"w-32",children:t.jsx(Bt,{placeholder:"Status"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All"}),t.jsx(Ne,{value:"active",children:"Active"}),t.jsx(Ne,{value:"suspended",children:"Suspended"}),t.jsx(Ne,{value:"inactive",children:"Inactive"})]})]})]})}),t.jsx(Q,{children:y?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading kiosks..."}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Code"}),t.jsx(ce,{children:"Vendor"}),t.jsx(ce,{children:"Location"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{className:"text-right",children:"Today's Sales"}),t.jsx(ce,{className:"text-right",children:"Balance"}),t.jsx(ce,{className:"text-right",children:"Actions"})]})}),t.jsxs(mr,{children:[(oe=p==null?void 0:p.data)==null?void 0:oe.map(ie=>t.jsxs(ut,{className:"cursor-pointer",onClick:()=>a(ie.id),children:[t.jsx(se,{className:"font-mono",children:ie.kiosk_code}),t.jsx(se,{children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:ie.vendor_name}),t.jsx("div",{className:"text-xs text-muted-foreground",children:ie.vendor_phone})]})}),t.jsx(se,{children:ie.location}),t.jsx(se,{children:I(ie.status)}),t.jsx(se,{className:"text-right",children:t.jsxs("div",{children:[t.jsx("div",{children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(ie.today_sales)}),t.jsxs("div",{className:"text-xs text-muted-foreground",children:["Target: ",new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(ie.daily_target)]})]})}),t.jsx(se,{className:"text-right",children:t.jsx("span",{className:ie.balance<0?"text-red-600 font-semibold":"",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(ie.balance)})}),t.jsx(se,{className:"text-right",children:t.jsxs("div",{className:"flex gap-1 justify-end",children:[t.jsx(X,{variant:"ghost",size:"sm",onClick:ge=>{ge.stopPropagation(),D(ie)},children:t.jsx(Dl,{className:"h-4 w-4"})}),t.jsx(X,{variant:"ghost",size:"sm",onClick:ge=>{ge.stopPropagation(),T(ie.id)},children:t.jsx(As,{className:"h-4 w-4"})})]})})]},ie.id)),((te=p==null?void 0:p.data)==null?void 0:te.length)===0&&t.jsx(ut,{children:t.jsx(se,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No kiosks found. Register your first kiosk to start tracking."})})]})]})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(sd,{className:"h-5 w-5"}),"Sales Performance"]})}),t.jsx(Q,{children:d&&v?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-muted-foreground",children:"Total Volume"}),t.jsxs("div",{className:"font-semibold",children:[v.total_volume.toFixed(1)," m"]})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-muted-foreground",children:"Avg. Daily"}),t.jsx("div",{className:"font-semibold",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(v.average_daily)})]})]}),t.jsx(Za,{width:"100%",height:200,children:t.jsxs(lj,{data:v.sales,children:[t.jsx(Io,{strokeDasharray:"3 3"}),t.jsx(xa,{dataKey:"date",tick:{fontSize:10}}),t.jsx(Bi,{}),t.jsx(Gs,{}),t.jsx(al,{type:"monotone",dataKey:"amount",stroke:"#8884d8",strokeWidth:2})]})})]}):t.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"Click on a kiosk to view sales performance"})})]})]}),j&&((be=j.data)==null?void 0:be.length)>0&&t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(B_,{className:"h-5 w-5"}),"Water Truck Fleet"]})}),t.jsx(Q,{children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Truck No"}),t.jsx(ce,{children:"Driver"}),t.jsx(ce,{children:"Phone"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{className:"text-right",children:"Capacity (L)"}),t.jsx(ce,{className:"text-right",children:"Trips Today"}),t.jsx(ce,{className:"text-right",children:"Revenue Today"})]})}),t.jsx(mr,{children:j.data.map(ie=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-mono",children:ie.truck_no}),t.jsx(se,{children:ie.driver_name}),t.jsx(se,{children:ie.phone}),t.jsx(se,{children:t.jsx(Ee,{className:ie.status==="in_transit"?"bg-blue-600":"bg-green-600",children:ie.status.replace("_"," ").toUpperCase()})}),t.jsx(se,{className:"text-right",children:ie.capacity.toLocaleString()}),t.jsx(se,{className:"text-right",children:ie.trips_today}),t.jsx(se,{className:"text-right",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(ie.revenue_today)})]},ie.id))})]})})]})]})}function uze(){return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Water Trucking"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Bowser management and trip tracking"})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(B_,{className:"h-5 w-5"}),"Trip Management"]})}),t.jsx(Q,{children:t.jsx("p",{className:"text-muted-foreground",children:"Truck scheduling, route tracking, and delivery verification coming soon..."})})]})]})}function hze(){var R,D;const[e,r]=O.useState(!1),[n,s]=O.useState("all"),[i,l]=O.useState(1),d=Sr(),{data:a,isLoading:f}=ct({queryKey:["connection-applications",n],queryFn:()=>Zs.getConnectionApplications({status:n&&n!=="all"?n:void 0,per_page:50})}),p=Nt({mutationFn:Zs.submitApplication,onSuccess:()=>{d.invalidateQueries({queryKey:["connection-applications"]}),r(!1),l(1),Ge.success("Application submitted successfully")},onError:T=>{var I,L;Ge.error(((L=(I=T.response)==null?void 0:I.data)==null?void 0:L.message)||"Failed to submit application")}}),y=Nt({mutationFn:({id:T,data:I})=>Zs.updateApplication(T,I),onSuccess:()=>{d.invalidateQueries({queryKey:["connection-applications"]}),Ge.success("Application updated successfully")},onError:T=>{var I,L;Ge.error(((L=(I=T.response)==null?void 0:I.data)==null?void 0:L.message)||"Failed to update application")}}),v=T=>{if(T.preventDefault(),i<3){l(i+1);return}const I=new FormData(T.currentTarget),L={applicant_name:I.get("applicant_name"),phone:I.get("phone"),email:I.get("email"),id_number:I.get("id_number"),address:I.get("address"),location:{lat:parseFloat(I.get("lat"))||-1.286389,lng:parseFloat(I.get("lng"))||36.817223},connection_type:I.get("connection_type"),property_type:I.get("property_type")};p.mutate(L)},j=T=>{y.mutate({id:T,data:{status:"approved"}})},w=T=>{y.mutate({id:T,data:{status:"rejected"}})},k=T=>{const I={kyc_pending:{variant:"bg-yellow-600",icon:ps},pending_approval:{variant:"bg-blue-600",icon:ps},approved:{variant:"bg-green-600",icon:Fs},rejected:{variant:"bg-red-600",icon:Mu},connected:{variant:"bg-purple-600",icon:Fs}},{variant:L,icon:$}=I[T]||I.kyc_pending;return t.jsxs(Ee,{className:L,children:[t.jsx($,{className:"h-3 w-3 mr-1"}),T.replace("_"," ").toUpperCase()]})},S=T=>{const I={pending:"bg-yellow-600",verified:"bg-green-600",rejected:"bg-red-600"};return t.jsx(Ee,{className:I[T],children:T.toUpperCase()})};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Connection Applications"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"New service requests and approval workflow"})]}),t.jsxs(Or,{open:e,onOpenChange:r,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{onClick:()=>l(1),children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"New Application"]})}),t.jsxs(kr,{className:"max-w-2xl",children:[t.jsx(Tr,{children:t.jsxs(Er,{children:["Step ",i," of 3: ",i===1?"Applicant Details":i===2?"Property Information":"Confirmation"]})}),t.jsxs("form",{onSubmit:v,className:"space-y-4",children:[i===1&&t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"col-span-2",children:[t.jsx(Me,{htmlFor:"applicant_name",children:"Full Name"}),t.jsx(Ve,{id:"applicant_name",name:"applicant_name",required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"phone",children:"Phone Number"}),t.jsx(Ve,{id:"phone",name:"phone",type:"tel",required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"email",children:"Email (Optional)"}),t.jsx(Ve,{id:"email",name:"email",type:"email"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx(Me,{htmlFor:"id_number",children:"ID/Passport Number"}),t.jsx(Ve,{id:"id_number",name:"id_number",required:!0})]})]}),i===2&&t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"col-span-2",children:[t.jsx(Me,{htmlFor:"address",children:"Property Address"}),t.jsx(Ve,{id:"address",name:"address",required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"connection_type",children:"Connection Type"}),t.jsxs("select",{id:"connection_type",name:"connection_type",className:"w-full border rounded-md p-2",required:!0,children:[t.jsx("option",{value:"new",children:"New Connection"}),t.jsx("option",{value:"upgrade",children:"Upgrade"}),t.jsx("option",{value:"temporary",children:"Temporary"})]})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"property_type",children:"Property Type"}),t.jsxs("select",{id:"property_type",name:"property_type",className:"w-full border rounded-md p-2",required:!0,children:[t.jsx("option",{value:"residential",children:"Residential"}),t.jsx("option",{value:"commercial",children:"Commercial"}),t.jsx("option",{value:"industrial",children:"Industrial"})]})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"lat",children:"Latitude"}),t.jsx(Ve,{id:"lat",name:"lat",type:"number",step:"any",defaultValue:"-1.286389",required:!0})]}),t.jsxs("div",{children:[t.jsx(Me,{htmlFor:"lng",children:"Longitude"}),t.jsx(Ve,{id:"lng",name:"lng",type:"number",step:"any",defaultValue:"36.817223",required:!0})]})]}),i===3&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"text-center py-8",children:[t.jsx(Fs,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-semibold",children:"Review Application"}),t.jsx("p",{className:"text-muted-foreground mt-2",children:"Please review your information before submitting"})]}),t.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-2 text-sm",children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Applicant:"})," Check form data"]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Phone:"})," Check form data"]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Property:"})," Check form data"]})]})]}),t.jsxs("div",{className:"flex justify-between pt-4",children:[t.jsx(X,{type:"button",variant:"outline",onClick:()=>i>1?l(i-1):r(!1),children:i>1?"Previous":"Cancel"}),t.jsx(X,{type:"submit",disabled:p.isPending,children:i<3?"Next":"Submit Application"})]})]})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(id,{className:"h-5 w-5"}),"Application Management"]}),t.jsxs($t,{value:n,onValueChange:s,children:[t.jsx(Rt,{className:"w-48",children:t.jsx(Bt,{placeholder:"Filter by status"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All Applications"}),t.jsx(Ne,{value:"kyc_pending",children:"KYC Pending"}),t.jsx(Ne,{value:"pending_approval",children:"Pending Approval"}),t.jsx(Ne,{value:"approved",children:"Approved"}),t.jsx(Ne,{value:"rejected",children:"Rejected"}),t.jsx(Ne,{value:"connected",children:"Connected"})]})]})]})}),t.jsx(Q,{children:f?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading applications..."}):t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Application No"}),t.jsx(ce,{children:"Applicant"}),t.jsx(ce,{children:"Phone"}),t.jsx(ce,{children:"Address"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"KYC"}),t.jsx(ce,{className:"text-right",children:"Est. Cost"}),t.jsx(ce,{children:"Applied Date"}),t.jsx(ce,{className:"text-right",children:"Actions"})]})}),t.jsxs(mr,{children:[(R=a==null?void 0:a.data)==null?void 0:R.map(T=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-mono",children:T.application_no}),t.jsx(se,{className:"font-medium",children:T.applicant_name}),t.jsx(se,{children:T.phone}),t.jsx(se,{className:"max-w-xs truncate",children:T.address}),t.jsx(se,{children:k(T.status)}),t.jsx(se,{children:S(T.kyc_status)}),t.jsx(se,{className:"text-right",children:new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(T.estimated_cost)}),t.jsx(se,{children:new Date(T.applied_date).toLocaleDateString()}),t.jsx(se,{className:"text-right",children:t.jsx("div",{className:"flex gap-1 justify-end",children:T.status==="pending_approval"&&t.jsxs(t.Fragment,{children:[t.jsx(X,{size:"sm",variant:"outline",onClick:()=>j(T.id),children:"Approve"}),t.jsx(X,{size:"sm",variant:"destructive",onClick:()=>w(T.id),children:"Reject"})]})})})]},T.id)),((D=a==null?void 0:a.data)==null?void 0:D.length)===0&&t.jsx(ut,{children:t.jsx(se,{colSpan:9,className:"text-center py-8 text-muted-foreground",children:"No applications found. Submit a new application to get started."})})]})]})})]})]})}function mze(){return t.jsxs("div",{className:"flex h-screen overflow-hidden",children:[t.jsx(Ia,{}),t.jsx("main",{className:"flex-1 overflow-y-auto",children:t.jsx(Oa,{})})]})}function fze(){const[e,r]=O.useState([]),[n,s]=O.useState("");O.useEffect(()=>{fetch("/api/community/committees").then(l=>l.json()).then(l=>r(l.data||[])).catch(()=>r([{id:"1",name:"Kiambu Water Committee",community:"Kiambu",members:12,complianceScore:92,status:"active"},{id:"2",name:"Kajiado Water Committee",community:"Kajiado",members:10,complianceScore:85,status:"active"},{id:"3",name:"Machakos Water Committee",community:"Machakos",members:14,complianceScore:78,status:"active"}]))},[]);const i=e.filter(l=>l.name.toLowerCase().includes(n.toLowerCase())||l.community.toLowerCase().includes(n.toLowerCase()));return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"RWSS Committees Directory"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Community water committee registry and governance"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"})," New Committee"]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Active Committees"}),t.jsx(Hs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:e.length}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all schemes"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Elections Due"}),t.jsx(Oo,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"3"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Within next 90 days"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Avg Compliance"}),t.jsx(Fs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"85%"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Average governance score"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Committee Registry"})}),t.jsxs(Q,{className:"space-y-4",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Ve,{placeholder:"Search committees...",value:n,onChange:l=>s(l.target.value),className:"flex-1"}),t.jsx(X,{variant:"outline",children:t.jsx(di,{className:"h-4 w-4"})})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b",children:[t.jsx("th",{className:"text-left py-2 px-2",children:"Committee Name"}),t.jsx("th",{className:"text-left py-2 px-2",children:"Community"}),t.jsx("th",{className:"text-left py-2 px-2",children:"Members"}),t.jsx("th",{className:"text-left py-2 px-2",children:"Compliance"}),t.jsx("th",{className:"text-left py-2 px-2",children:"Status"})]})}),t.jsx("tbody",{children:i.map(l=>t.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[t.jsx("td",{className:"py-2 px-2 font-medium",children:l.name}),t.jsx("td",{className:"py-2 px-2",children:l.community}),t.jsx("td",{className:"py-2 px-2",children:l.members}),t.jsxs("td",{className:"py-2 px-2",children:[l.complianceScore,"%"]}),t.jsx("td",{className:"py-2 px-2",children:t.jsx(Ee,{variant:"default",children:l.status})})]},l.id))})]})})]})]})]})}function pze(){return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Kiambu Water Committee"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Term: Jan 2023 - Dec 2025  Compliance Score: 92%"})]}),t.jsxs(Sn,{defaultValue:"overview",className:"w-full",children:[t.jsxs(bn,{children:[t.jsx(kt,{value:"overview",children:"Overview"}),t.jsx(kt,{value:"members",children:"Members"}),t.jsx(kt,{value:"meetings",children:"Meetings"}),t.jsx(kt,{value:"actions",children:"Actions"}),t.jsx(kt,{value:"finance",children:"Finance"}),t.jsx(kt,{value:"audits",children:"Audits"}),t.jsx(kt,{value:"documents",children:"Documents"})]}),t.jsxs(Dt,{value:"overview",className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Members"}),t.jsx(Hs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"12"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"5 officers, 7 members"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Meetings YTD"}),t.jsx(Oo,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"9"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"100% quorum met"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Bank Balance"}),t.jsx(co,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"KES 245K"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Last updated today"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Governance Compliance"})}),t.jsx(Q,{children:t.jsx("p",{className:"text-muted-foreground",children:"Gender quota: 50%  | Meeting frequency: Monthly  | Elections on schedule "})})]})]}),t.jsx(Dt,{value:"members",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Committee Members"})}),t.jsx(Q,{children:t.jsx("p",{className:"text-muted-foreground",children:"Member roster with roles, terms, and contact details coming soon..."})})]})}),t.jsx(Dt,{value:"meetings",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Meeting History"})}),t.jsx(Q,{children:t.jsx("p",{className:"text-muted-foreground",children:"Agendas, attendance, minutes, and resolutions coming soon..."})})]})}),t.jsx(Dt,{value:"actions",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Action Items"})}),t.jsx(Q,{children:t.jsx("p",{className:"text-muted-foreground",children:"Pending actions with owners and due dates coming soon..."})})]})}),t.jsx(Dt,{value:"finance",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Committee Finances"})}),t.jsx(Q,{children:t.jsx("p",{className:"text-muted-foreground",children:"Cashbook entries, bank reconciliations, and financial reports coming soon..."})})]})}),t.jsx(Dt,{value:"audits",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Financial Audits"})}),t.jsx(Q,{children:t.jsx("p",{className:"text-muted-foreground",children:"Audit findings, recommendations, and compliance tracking coming soon..."})})]})}),t.jsx(Dt,{value:"documents",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Committee Documents"})}),t.jsx(Q,{children:t.jsx("p",{className:"text-muted-foreground",children:"Bylaws, meeting minutes, financial reports, and audit documents coming soon..."})})]})})]})]})}function xze(){const[e,r]=O.useState([]),[n]=O.useState(12e5);O.useEffect(()=>{fetch("/api/community/finance/cashbook").then(l=>l.json()).then(l=>r(l.data||[])).catch(()=>r([{id:"1",date:"2025-11-20",refNo:"REC001",particulars:"Monthly tariff",type:"receipt",amount:125e3,status:"approved"},{id:"2",date:"2025-11-19",refNo:"PAY001",particulars:"Operator salary",type:"payment",amount:45e3,status:"approved"}]))},[]);const s=e.filter(l=>l.type==="receipt"),i=e.filter(l=>l.type==="payment");return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Committee Finance & Cashbook"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Community tariff collection, cashbook, and financial audits"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"})," New Entry"]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Total Receipts"}),t.jsx(co,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:["KES ",(s.reduce((l,d)=>l+(d.amount||0),0)/1e3).toFixed(0),"K"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Current period"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Bank Balance"}),t.jsx(xs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:["KES ",(n/1e6).toFixed(1),"M"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Available funds"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Pending Approval"}),t.jsx(ps,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:e.filter(l=>l.status==="pending").length}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting approval"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Cashbook Entries"})}),t.jsx(Q,{children:t.jsxs(Sn,{defaultValue:"all",children:[t.jsxs(bn,{children:[t.jsx(kt,{value:"all",children:"All Entries"}),t.jsx(kt,{value:"receipts",children:"Receipts"}),t.jsx(kt,{value:"payments",children:"Payments"})]}),t.jsx(Dt,{value:"all",className:"mt-4",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b",children:[t.jsx("th",{className:"text-left py-2 px-2",children:"Date"}),t.jsx("th",{className:"text-left py-2 px-2",children:"Ref #"}),t.jsx("th",{className:"text-left py-2 px-2",children:"Particulars"}),t.jsx("th",{className:"text-left py-2 px-2",children:"Type"}),t.jsx("th",{className:"text-right py-2 px-2",children:"Amount"}),t.jsx("th",{className:"text-left py-2 px-2",children:"Status"})]})}),t.jsx("tbody",{children:e.map(l=>t.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[t.jsx("td",{className:"py-2 px-2",children:l.date}),t.jsx("td",{className:"py-2 px-2 font-mono text-xs",children:l.refNo}),t.jsx("td",{className:"py-2 px-2",children:l.particulars}),t.jsx("td",{className:"py-2 px-2",children:t.jsx(Ee,{variant:l.type==="receipt"?"default":"secondary",children:l.type})}),t.jsxs("td",{className:"py-2 px-2 text-right",children:["KES ",(l.amount/1e3).toFixed(0),"K"]}),t.jsx("td",{className:"py-2 px-2",children:t.jsx(Ee,{variant:l.status==="approved"?"default":"outline",children:l.status})})]},l.id))})]})})}),t.jsx(Dt,{value:"receipts",children:t.jsxs("div",{className:"text-sm text-muted-foreground",children:["Receipts: KES ",(s.reduce((l,d)=>l+(d.amount||0),0)/1e3).toFixed(0),"K"]})}),t.jsx(Dt,{value:"payments",children:t.jsxs("div",{className:"text-sm text-muted-foreground",children:["Payments: KES ",(i.reduce((l,d)=>l+(d.amount||0),0)/1e3).toFixed(0),"K"]})})]})})]})]})}function gze(){const[e,r]=O.useState([]);O.useEffect(()=>{fetch("/api/partner/vendors").then(l=>l.json()).then(l=>r(l.data||[])).catch(()=>r([{id:"1",companyName:"WaterTech Solutions",status:"approved",kycStatus:"verified",rating:4.8,otifScore:.94},{id:"2",companyName:"Nairobi Supplies",status:"approved",kycStatus:"verified",rating:4.5,otifScore:.89}]))},[]);const n=e.filter(l=>l.status==="approved").length,s=e.length>0?(e.reduce((l,d)=>l+d.otifScore,0)/e.length*100).toFixed(0):0,i=e.filter(l=>l.kycStatus==="pending").length;return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Vendor & Partner Portal"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Vendor registration, KYC, and performance tracking"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"})," Register Vendor"]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Approved Vendors"}),t.jsx(VT,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:n}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Active in database"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Avg OTIF Score"}),t.jsx(CV,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[s,"%"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"On-time in-full delivery"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Pending KYC"}),t.jsx(xs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:i}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting verification"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Vendor List"})}),t.jsx(Q,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b",children:[t.jsx("th",{className:"text-left py-2 px-2",children:"Company"}),t.jsx("th",{className:"text-left py-2 px-2",children:"Status"}),t.jsx("th",{className:"text-left py-2 px-2",children:"KYC"}),t.jsx("th",{className:"text-left py-2 px-2",children:"Rating"}),t.jsx("th",{className:"text-left py-2 px-2",children:"OTIF"})]})}),t.jsx("tbody",{children:e.map(l=>t.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[t.jsx("td",{className:"py-2 px-2 font-medium",children:l.companyName}),t.jsx("td",{className:"py-2 px-2",children:t.jsx(Ee,{variant:l.status==="approved"?"default":"secondary",children:l.status})}),t.jsx("td",{className:"py-2 px-2",children:t.jsx(Ee,{variant:l.kycStatus==="verified"?"default":"outline",children:l.kycStatus})}),t.jsx("td",{className:"py-2 px-2",children:l.rating>0?`${l.rating}`:"N/A"}),t.jsxs("td",{className:"py-2 px-2",children:[(l.otifScore*100).toFixed(0),"%"]})]},l.id))})]})})})]})]})}function yze(){const[e,r]=O.useState([]);return O.useEffect(()=>{fetch("/api/partner/bids").then(n=>n.json()).then(n=>r(n.data||[])).catch(()=>r([{id:"1",rfqId:"RFQ-001",vendorName:"WaterTech",status:"submitted",priceTotal:85e4,leadTime:14}]))},[]),t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Bids & RFQ Center"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"RFQ management, bid submission, and evaluation"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"})," New RFQ"]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Active RFQs"}),t.jsx($n,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"12"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Open for bidding"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Pending Evaluation"}),t.jsx(Xs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:e.filter(n=>n.status==="submitted").length}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting review"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Total Bids"}),t.jsx(Fs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:e.length}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"All time"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Recent Bids"})}),t.jsx(Q,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b",children:[t.jsx("th",{className:"text-left py-2 px-2",children:"RFQ ID"}),t.jsx("th",{className:"text-left py-2 px-2",children:"Vendor"}),t.jsx("th",{className:"text-left py-2 px-2",children:"Status"}),t.jsx("th",{className:"text-right py-2 px-2",children:"Price"}),t.jsx("th",{className:"text-left py-2 px-2",children:"Lead Time"})]})}),t.jsx("tbody",{children:e.map(n=>t.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[t.jsx("td",{className:"py-2 px-2 font-mono text-xs",children:n.rfqId}),t.jsx("td",{className:"py-2 px-2",children:n.vendorName}),t.jsx("td",{className:"py-2 px-2",children:t.jsx(Ee,{variant:"default",children:n.status})}),t.jsxs("td",{className:"py-2 px-2 text-right",children:["KES ",(n.priceTotal/1e3).toFixed(0),"K"]}),t.jsxs("td",{className:"py-2 px-2",children:[n.leadTime," days"]})]},n.id))})]})})})]})]})}function vze(){return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Vendor Deliveries & Invoices"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Delivery notes, GRN processing, and invoice tracking"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Pending GRN"}),t.jsx(Xs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"8"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting receipt"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Received"}),t.jsx(Fs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"142"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"This month"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Rejected"}),t.jsx(Mu,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"3"}),t.jsx("p",{className:"text-xs text-red-600",children:"Quality issues"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Pending Payment"}),t.jsx(id,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"KES 2.4M"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"28 invoices"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Delivery Management"})}),t.jsx(Q,{children:t.jsx("p",{className:"text-muted-foreground",children:"Delivery note submission, GRN verification, invoice approval, and payment tracking coming soon..."})})]})]})}function _ze(){return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Stakeholder Mapping"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Stakeholder registry, influence/interest analysis, and engagement tracking"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Total Stakeholders"}),t.jsx(Hs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"245"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"All categories"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"High Influence"}),t.jsx(xs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"32"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Key decision makers"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Vulnerable Groups"}),t.jsx(Qf,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"18"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Requiring special attention"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Stakeholder Directory & Analysis"})}),t.jsx(Q,{children:t.jsx("p",{className:"text-muted-foreground",children:"Stakeholder registry, influence/interest matrix, and engagement plans coming soon..."})})]})]})}function bze(){return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Stakeholder Engagement Planner"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Plan and track community meetings, barazas, and consultations"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Upcoming Events"}),t.jsx(Oo,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"8"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Next 30 days"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Total Attendance"}),t.jsx(Hs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"1,245"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"This quarter"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Completed"}),t.jsx(Fs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"42"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Events this year"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Engagement Calendar"})}),t.jsx(Q,{children:t.jsx("p",{className:"text-muted-foreground",children:"Event planning, QR check-in, and attendance tracking coming soon..."})})]})]})}function jze(){const[e,r]=O.useState([]),[n,s]=O.useState({new:12,assigned:8,inProgress:28,resolved:156,overdueSla:3});O.useEffect(()=>{fetch("/api/grm/tickets").then(d=>d.json()).then(d=>{r(d.data||[]),d.stats&&s(d.stats)}).catch(()=>r([{id:"1",ticketNumber:"GRM-001",category:"water-quality",status:"new",severity:"high",location:"Kilimani",details:"Turbid water"},{id:"2",ticketNumber:"GRM-002",category:"billing",status:"assigned",severity:"medium",location:"Westlands",details:"Overcharge"}]))},[]);const i={new:{title:"New",color:"bg-gray-100",tickets:e.filter(d=>d.status==="new")},triaged:{title:"Triaged",color:"bg-blue-50",tickets:e.filter(d=>d.status==="triaged")},assigned:{title:"Assigned",color:"bg-purple-50",tickets:e.filter(d=>d.status==="assigned")},"in-progress":{title:"In Progress",color:"bg-yellow-50",tickets:e.filter(d=>d.status==="in-progress")},resolved:{title:"Resolved",color:"bg-green-50",tickets:e.filter(d=>d.status==="resolved")}},l=d=>{switch(d){case"high":return"destructive";case"medium":return"secondary";default:return"outline"}};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Grievance Redress Mechanism (GRM)"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Multi-channel complaint intake, SLA tracking, and resolution workflow"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"})," New Grievance"]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"New"}),t.jsx(lm,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:n.new}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting triage"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Active"}),t.jsx(Xs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:n.inProgress}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"In resolution"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Overdue SLA"}),t.jsx(an,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold text-red-600",children:n.overdueSla}),t.jsx("p",{className:"text-xs text-red-600",children:"Require escalation"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Resolved (30d)"}),t.jsx(Fs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:n.resolved}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"91% SLA compliance"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Total"}),t.jsx(lm,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:e.length}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"All tickets"})]})]})]}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Kanban Board"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:Object.entries(i).map(([d,a])=>t.jsxs("div",{className:`${a.color} rounded-lg p-4 min-h-96`,children:[t.jsxs("h3",{className:"font-semibold mb-3",children:[a.title," (",a.tickets.length,")"]}),t.jsx("div",{className:"space-y-2",children:a.tickets.map(f=>t.jsx(H,{className:"cursor-pointer hover:shadow-md transition-shadow",children:t.jsxs(Q,{className:"pt-3",children:[t.jsx("div",{className:"text-xs font-mono text-muted-foreground mb-1",children:f.ticketNumber}),t.jsx("p",{className:"text-sm font-medium",children:f.details}),t.jsxs("div",{className:"mt-2 flex gap-1",children:[t.jsx(Ee,{variant:l(f.severity),className:"text-xs",children:f.severity}),t.jsx(Ee,{variant:"outline",className:"text-xs",children:f.category})]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:f.location})]})},f.id))})]},d))})]})]})}const Lx=[{id:"committees",name:"Committee Registry",description:"Water committee locations, membership, and compliance metrics",category:"Governance",records:245,formats:["CSV","JSON","GeoJSON"],updated:"2025-11-20",downloads:342},{id:"water-facilities",name:"Water Facilities",description:"Treatment plants, pump stations, and storage facilities with operational status",category:"Infrastructure",records:1203,formats:["CSV","GeoJSON","Shapefile"],updated:"2025-11-19",downloads:521},{id:"water-kiosks",name:"Water Kiosks & Outlets",description:"Community water points with coverage and daily usage metrics",category:"Services",records:5847,formats:["CSV","GeoJSON"],updated:"2025-11-18",downloads:834},{id:"grievances",name:"Community Grievances",description:"Reported water quality, service interruptions, and billing complaints",category:"Community",records:3421,formats:["CSV","JSON"],updated:"2025-11-20",downloads:189},{id:"vendors",name:"Vendor Directory",description:"Approved service providers with KYC status and performance ratings",category:"Procurement",records:87,formats:["CSV","JSON"],updated:"2025-11-17",downloads:156},{id:"water-quality",name:"Water Quality Data",description:"Monthly testing results for chlorine, pH, turbidity, and contaminants",category:"Quality",records:12456,formats:["CSV","JSON"],updated:"2025-11-20",downloads:421}],wze=[{path:"/api/v1/datasets/committees",method:"GET",description:"Get all committees with metadata",parameters:["limit","offset","status"],example:'curl -H "Authorization: Bearer KEY" /api/v1/datasets/committees?limit=50'},{path:"/api/v1/datasets/facilities",method:"GET",description:"Get water facilities by location or status",parameters:["latitude","longitude","radius","type"],example:"curl /api/v1/datasets/facilities?latitude=-1.29&longitude=36.82&radius=10"},{path:"/api/v1/datasets/grievances",method:"GET",description:"Query grievances by category, severity, or location",parameters:["category","severity","status","startDate","endDate"],example:"curl /api/v1/datasets/grievances?category=water-quality&severity=high"},{path:"/api/v1/datasets/export",method:"POST",description:"Export dataset in requested format",parameters:["datasetId","format","filters"],example:`curl -X POST /api/v1/datasets/export -d '{"datasetId":"committees","format":"csv"}'`},{path:"/api/v1/maps/tiles/{layer}/{z}/{x}/{y}",method:"GET",description:"Vector tile endpoint for map rendering",parameters:["layer","z","x","y"],example:"/api/v1/maps/tiles/facilities/8/140/84"},{path:"/api/v1/datasets/{id}/preview",method:"GET",description:"Get sample records from a dataset",parameters:["id","limit"],example:"curl /api/v1/datasets/water-quality/preview?limit=10"}],Nze=[{id:"story-1",title:"Water Access Gaps in ASAL Counties",description:"Analysis of coverage disparities showing which underserved areas lack reliable water access",insights:["23% of rural population >5km from nearest water point","Average wait time 2.3 hours during dry season","Seasonal variation in service availability"],relatedDatasets:["water-kiosks","water-facilities"],author:"Water Supply Team"},{id:"story-2",title:"Committee Performance & Compliance",description:"Study of governance effectiveness across committees and impact on service delivery",insights:["High-compliance committees have 18% better water quality","87% of compliant committees meet reporting deadlines","Training programs improve compliance by 34%"],relatedDatasets:["committees","water-quality"],author:"Governance Division"},{id:"story-3",title:"Seasonal Water Quality Trends",description:"Temporal patterns in water quality metrics showing seasonal contamination risks",insights:["Peak contamination in rainy season (+45%)","Chlorine residual drops 12% during peak demand","pH varies by 1.2 units across seasons"],relatedDatasets:["water-quality"],author:"Water Quality Lab"},{id:"story-4",title:"Grievance Resolution Effectiveness",description:"Metrics on complaint handling time and resolution rates by complaint type",insights:["Avg resolution time: 12.5 days","Water quality complaints resolved 2x faster","Digital reporting reduced wait time by 40%"],relatedDatasets:["grievances"],author:"Customer Service"}];function Sze(){const[e,r]=O.useState(""),[n,s]=O.useState(null),[i,l]=O.useState("discover"),d=O.useMemo(()=>Lx.filter(y=>{const v=y.name.toLowerCase().includes(e.toLowerCase())||y.description.toLowerCase().includes(e.toLowerCase()),j=!n||y.category===n;return v&&j}),[e,n]),a=O.useMemo(()=>Array.from(new Set(Lx.map(y=>y.category))),[]),f=Lx.reduce((y,v)=>y+v.downloads,0),p=Lx.reduce((y,v)=>y+v.records,0);return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsx("div",{className:"flex justify-between items-start",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Open Data & Transparency"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Public datasets, APIs, maps, and transparency stories"})]})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Public Datasets"}),t.jsx(jV,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:Lx.length}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Available for download"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Total Downloads"}),t.jsx(Ta,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:f.toLocaleString()}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"This month"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"API Calls"}),t.jsx(gV,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"8.4K"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Last 7 days"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Data Points"}),t.jsx(xs,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[(p/1e3).toFixed(1),"K"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Records available"})]})]})]}),t.jsxs(Sn,{value:i,onValueChange:l,className:"space-y-4",children:[t.jsxs(bn,{className:"grid grid-cols-4 w-full max-w-md",children:[t.jsx(kt,{value:"discover",children:"Discover"}),t.jsx(kt,{value:"api",children:"API Docs"}),t.jsx(kt,{value:"stories",children:"Stories"}),t.jsx(kt,{value:"maps",children:"Maps"})]}),t.jsxs(Dt,{value:"discover",className:"space-y-4",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm",children:"Search & Filter"})}),t.jsxs(Q,{className:"space-y-3",children:[t.jsxs("div",{className:"relative",children:[t.jsx(di,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Search datasets...",className:"pl-10",value:e,onChange:y=>r(y.target.value)})]}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsx(X,{size:"sm",variant:n===null?"default":"outline",onClick:()=>s(null),children:"All"}),a.map(y=>t.jsx(X,{size:"sm",variant:n===y?"default":"outline",onClick:()=>s(y),children:y},y))]})]})]}),t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:d.map(y=>t.jsxs(H,{className:"hover:border-primary/50 transition-colors",children:[t.jsx(de,{children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx(he,{className:"text-base",children:y.name}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:y.description})]}),t.jsx(Ee,{variant:"outline",className:"ml-2",children:y.category})]})}),t.jsxs(Q,{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Records:"}),t.jsxs("div",{className:"font-medium",children:[(y.records/1e3).toFixed(1),"K"]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Updated:"}),t.jsx("div",{className:"font-medium",children:y.updated})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Downloads:"}),t.jsx("div",{className:"font-medium",children:y.downloads})]})]}),t.jsx("div",{className:"flex flex-wrap gap-1",children:y.formats.map(v=>t.jsx(Ee,{variant:"secondary",className:"text-xs",children:v},v))}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(X,{size:"sm",variant:"outline",className:"flex-1",children:[t.jsx(Ta,{className:"h-3 w-3 mr-1"})," Download"]}),t.jsxs(X,{size:"sm",variant:"outline",className:"flex-1",children:[t.jsx(bV,{className:"h-3 w-3 mr-1"})," Preview"]})]})]})]},y.id))}),d.length===0&&t.jsx(H,{className:"text-center py-8",children:t.jsx("p",{className:"text-muted-foreground",children:"No datasets match your search"})})]}),t.jsxs(Dt,{value:"api",className:"space-y-4",children:[t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(qT,{className:"h-5 w-5"}),"API Documentation"]}),t.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"RESTful API endpoints for data access"})]}),t.jsx(Q,{className:"space-y-4",children:t.jsxs("div",{className:"bg-muted p-3 rounded font-mono text-xs",children:[t.jsxs("p",{children:[t.jsx("span",{className:"text-blue-600",children:"Base URL:"})," https://api.water-mis.go.ke/v1"]}),t.jsxs("p",{children:[t.jsx("span",{className:"text-blue-600",children:"Auth:"})," Bearer token required for all endpoints"]})]})})]}),t.jsx("div",{className:"space-y-3",children:wze.map((y,v)=>t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ee,{variant:y.method==="GET"?"default":"secondary",children:y.method}),t.jsx("code",{className:"text-sm font-mono flex-1 text-muted-foreground",children:y.path})]}),t.jsx("p",{className:"text-sm mt-2",children:y.description})]}),t.jsxs(Q,{className:"space-y-2",children:[y.parameters&&t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Parameters:"}),t.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:y.parameters.map(j=>t.jsx(Ee,{variant:"outline",className:"text-xs",children:j},j))})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Example:"}),t.jsx("code",{className:"text-xs bg-muted p-2 rounded block mt-1 overflow-auto",children:y.example})]}),t.jsxs(X,{size:"sm",variant:"outline",children:[t.jsx(vV,{className:"h-3 w-3 mr-1"})," Full Docs"]})]})]},v))}),t.jsxs(H,{className:"bg-blue-50 dark:bg-blue-900/20 border-blue-200",children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm",children:"Get API Access"})}),t.jsxs(Q,{children:[t.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Request an API key to integrate data into your applications"}),t.jsx(X,{children:"Request API Key"})]})]})]}),t.jsx(Dt,{value:"stories",className:"space-y-4",children:t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:Nze.map(y=>t.jsxs(H,{className:"hover:border-primary/50 transition-colors",children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(vu,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-1"}),t.jsxs("div",{className:"flex-1",children:[t.jsx(he,{className:"text-base",children:y.title}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:y.description})]})]})}),t.jsxs(Q,{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Key Insights:"}),t.jsx("ul",{className:"space-y-1",children:y.insights.map((v,j)=>t.jsxs("li",{className:"text-xs text-muted-foreground",children:[" ",v]},j))})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Related Datasets:"}),t.jsx("div",{className:"flex flex-wrap gap-1",children:y.relatedDatasets.map(v=>{const j=Lx.find(w=>w.id===v);return j?t.jsx(Ee,{variant:"outline",className:"text-xs",children:j.name},v):null})})]}),t.jsxs("div",{className:"flex justify-between items-center pt-2 border-t",children:[t.jsxs("p",{className:"text-xs text-muted-foreground",children:["By ",y.author]}),t.jsx(X,{size:"sm",variant:"ghost",children:"Read Full Story"})]})]})]},y.id))})}),t.jsx(Dt,{value:"maps",className:"space-y-4",children:t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(Qf,{className:"h-5 w-5"}),"Interactive Public Maps"]})}),t.jsxs(Q,{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs(X,{variant:"outline",className:"h-24 flex flex-col",children:[t.jsx("div",{className:"text-base font-medium",children:"Committee Locations"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"245 committees mapped"})]}),t.jsxs(X,{variant:"outline",className:"h-24 flex flex-col",children:[t.jsx("div",{className:"text-base font-medium",children:"Water Facilities"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"1,203 infrastructure points"})]}),t.jsxs(X,{variant:"outline",className:"h-24 flex flex-col",children:[t.jsx("div",{className:"text-base font-medium",children:"Service Coverage"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Population access areas"})]}),t.jsxs(X,{variant:"outline",className:"h-24 flex flex-col",children:[t.jsx("div",{className:"text-base font-medium",children:"Quality Monitoring"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Test site locations"})]})]}),t.jsx("div",{className:"pt-4 border-t",children:t.jsxs(X,{className:"w-full",size:"lg",children:[t.jsx(Qf,{className:"h-4 w-4 mr-2"})," Open Public Maps"]})})]})]})})]})]})}const Pk=[{id:"committees",name:"Committees",columns:["id","name","community","members","status","complianceScore"]},{id:"vendors",name:"Vendors",columns:["id","companyName","status","kycStatus","rating"]},{id:"grievances",name:"Grievances",columns:["id","category","severity","status","location"]},{id:"meetings",name:"Committee Meetings",columns:["id","committeeId","attendance","status","date"]}],Pze=["count","sum","avg","min","max"],Cze=["=","!=",">","<",">=","<=","contains","startswith"];function Aze(){const[e,r]=O.useState(Pk[0].id),[n,s]=O.useState([]),[i,l]=O.useState(!1),[d,a]=O.useState(!1),[f,p]=O.useState(!1),[y,v]=O.useState(!1),[j,w]=O.useState("daily"),[k,S]=O.useState(""),R=O.useMemo(()=>Pk.find(L=>L.id===e),[e]),D=O.useMemo(()=>e==="committees"?[{id:"1",name:"Kiambu Committee",community:"Kiambu",members:12,status:"active",complianceScore:92},{id:"2",name:"Kajiado Committee",community:"Kajiado",members:10,status:"active",complianceScore:85}]:e==="vendors"?[{id:"1",companyName:"WaterTech",status:"approved",kycStatus:"verified",rating:4.8},{id:"2",companyName:"Nairobi Supplies",status:"approved",kycStatus:"verified",rating:4.5}]:e==="grievances"?[{id:"1",category:"water-quality",severity:"high",status:"new",location:"Kilimani"},{id:"2",category:"billing",severity:"medium",status:"resolved",location:"Westlands"}]:[],[e]),T=(L,$,W)=>{const Z={id:Date.now().toString(),type:L,label:$,config:W};s([...n,Z])},I=L=>{s(n.filter($=>$.id!==L))};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Dataset Builder"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Create and configure public datasets with privacy filters and transformations"})]}),t.jsxs(X,{children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"})," New Dataset"]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(lo,{className:"h-5 w-5"}),"Source Selection"]})}),t.jsxs(Q,{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Select Source Table"}),t.jsxs($t,{value:e,onValueChange:r,children:[t.jsx(Rt,{className:"mt-1",children:t.jsx(Bt,{})}),t.jsx(Lt,{children:Pk.map(L=>t.jsx(Ne,{value:L.id,children:L.name},L.id))})]})]}),t.jsx("div",{className:"flex flex-wrap gap-1",children:R==null?void 0:R.columns.map(L=>t.jsx(Ee,{variant:"outline",className:"text-xs",children:L},L))})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(Us,{className:"h-5 w-5"}),"Transformations"]})}),t.jsxs(Q,{className:"space-y-3",children:[t.jsxs("div",{className:"flex gap-2 flex-wrap",children:[t.jsxs(Or,{open:i,onOpenChange:l,children:[t.jsx(pn,{asChild:!0,children:t.jsx(X,{size:"sm",variant:"outline",children:"+ Filter"})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Add Filter"})}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Column"}),t.jsxs($t,{children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select column"})}),t.jsx(Lt,{children:R==null?void 0:R.columns.map(L=>t.jsx(Ne,{value:L,children:L},L))})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Operator"}),t.jsxs($t,{children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select operator"})}),t.jsx(Lt,{children:Cze.map(L=>t.jsx(Ne,{value:L,children:L},L))})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Value"}),t.jsx(Ve,{placeholder:"Enter value"})]}),t.jsx(X,{className:"w-full",onClick:()=>{T("filter","Filter applied",{}),l(!1)},children:"Add Filter"})]})]})]}),t.jsxs(Or,{open:d,onOpenChange:a,children:[t.jsx(pn,{asChild:!0,children:t.jsx(X,{size:"sm",variant:"outline",children:"+ Group By"})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Group By"})}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Column(s) to Group"}),t.jsxs($t,{children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select columns"})}),t.jsx(Lt,{children:R==null?void 0:R.columns.map(L=>t.jsx(Ne,{value:L,children:L},L))})]})]}),t.jsx(X,{className:"w-full",onClick:()=>{T("group","Group by applied",{}),a(!1)},children:"Apply Group"})]})]})]}),t.jsxs(Or,{open:f,onOpenChange:p,children:[t.jsx(pn,{asChild:!0,children:t.jsx(X,{size:"sm",variant:"outline",children:"+ Aggregate"})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Add Aggregation"})}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Column to Aggregate"}),t.jsxs($t,{children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select column"})}),t.jsx(Lt,{children:R==null?void 0:R.columns.map(L=>t.jsx(Ne,{value:L,children:L},L))})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Function"}),t.jsxs($t,{children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select function"})}),t.jsx(Lt,{children:Pze.map(L=>t.jsx(Ne,{value:L,children:L.toUpperCase()},L))})]})]}),t.jsx(X,{className:"w-full",onClick:()=>{T("aggregate","Aggregation added",{}),p(!1)},children:"Add Aggregation"})]})]})]}),t.jsxs(Or,{open:y,onOpenChange:v,children:[t.jsx(pn,{asChild:!0,children:t.jsx(X,{size:"sm",variant:"outline",children:"+ Computed Field"})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Add Computed Field"})}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Field Name"}),t.jsx(Ve,{placeholder:"e.g., ComplianceRatio"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Expression"}),t.jsx(Ve,{placeholder:"e.g., complianceScore / 100",className:"font-mono text-xs"})]}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:["Available: ",R==null?void 0:R.columns.join(", ")]}),t.jsx(X,{className:"w-full",onClick:()=>{T("compute","Computed field added",{}),v(!1)},children:"Add Field"})]})]})]})]}),n.length>0&&t.jsx("div",{className:"mt-4 space-y-2 border-t pt-4",children:n.map(L=>t.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted rounded",children:[t.jsxs("div",{children:[t.jsx(Ee,{className:"text-xs",children:L.type.toUpperCase()}),t.jsx("span",{className:"text-sm ml-2",children:L.label})]}),t.jsx("button",{onClick:()=>I(L.id),className:"text-muted-foreground hover:text-foreground",children:t.jsx(bm,{className:"h-4 w-4"})})]},L.id))})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(wi,{className:"h-5 w-5"}),"Privacy Filters"]})}),t.jsxs(Q,{className:"space-y-2",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx(X,{variant:"outline",size:"sm",children:"Anonymize IDs"}),t.jsx(X,{variant:"outline",size:"sm",children:"Redact Names"}),t.jsx(X,{variant:"outline",size:"sm",children:"Mask Emails"}),t.jsx(X,{variant:"outline",size:"sm",children:"Aggregate Sensitive"})]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Applied rules will be shown here"})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(Xs,{className:"h-5 w-5"}),"Refresh Schedule"]})}),t.jsx(Q,{children:t.jsxs($t,{value:j,onValueChange:w,children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"never",children:"Never (Manual)"}),t.jsx(Ne,{value:"hourly",children:"Every Hour"}),t.jsx(Ne,{value:"daily",children:"Daily (Midnight)"}),t.jsx(Ne,{value:"weekly",children:"Weekly (Sunday)"}),t.jsx(Ne,{value:"monthly",children:"Monthly (1st)"})]})]})})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm",children:"Dataset Config"})}),t.jsxs(Q,{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Dataset Name"}),t.jsx(Ve,{placeholder:"e.g., Committee Performance",value:k,onChange:L=>S(L.target.value),className:"mt-1"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Source"}),t.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:R==null?void 0:R.name})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Transformations"}),t.jsxs("div",{className:"text-sm text-muted-foreground mt-1",children:[n.length," applied"]})]}),t.jsx(X,{className:"w-full",children:"Save Dataset"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[t.jsx(he,{className:"text-sm",children:"Preview"}),t.jsx(ud,{className:"h-4 w-4"})]}),t.jsx(Q,{children:t.jsxs("div",{className:"text-xs space-y-2",children:[D.slice(0,3).map((L,$)=>t.jsx("div",{className:"p-2 bg-muted rounded",children:Object.entries(L).slice(0,2).map(([W,Z])=>t.jsxs("div",{className:"text-xs",children:[t.jsxs("span",{className:"font-medium",children:[W,":"]})," ",Z]},W))},$)),t.jsxs("p",{className:"text-muted-foreground text-xs italic",children:["+",D.length-1," more rows"]})]})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm",children:"Export"})}),t.jsxs(Q,{className:"space-y-2",children:[t.jsx(X,{variant:"outline",size:"sm",className:"w-full justify-start text-xs",children:"CSV Export"}),t.jsx(X,{variant:"outline",size:"sm",className:"w-full justify-start text-xs",children:"GeoJSON Export"}),t.jsx(X,{variant:"outline",size:"sm",className:"w-full justify-start text-xs",children:"API Key"})]})]})]})]})]})}const J6=[{id:"positron",name:"Light",url:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json"},{id:"voyager",name:"Voyager",url:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json"},{id:"osm",name:"OpenStreetMap",url:"https://tiles.openfreemap.org/styles/liberty"}],kze=[{id:"coverage",name:"Water Coverage Areas",category:"Coverage",visible:!0,color:"#22c55e",description:"Active water supply scheme coverage zones"},{id:"facilities",name:"Water Facilities",category:"Infrastructure",visible:!0,color:"#3b82f6",description:"Treatment plants, pump stations, reservoirs"},{id:"kiosks",name:"Water Kiosks",category:"Infrastructure",visible:!0,color:"#f59e0b",description:"Community water point locations"},{id:"pipelines",name:"Water Pipelines",category:"Network",visible:!0,color:"#8b5cf6",description:"Primary and secondary water distribution lines"},{id:"meters",name:"Service Connections",category:"Network",visible:!1,color:"#06b6d4",description:"Individual household/business meters"},{id:"complaints",name:"Reported Issues",category:"Community",visible:!1,color:"#ef4444",description:"Active grievances and reported problems"}];function Tze(){const[e,r]=O.useState({longitude:36.8219,latitude:-1.2921,zoom:8}),[n,s]=O.useState(J6[0].url),[i,l]=O.useState(kze),[d,a]=O.useState(!1),[f,p]=O.useState(!1),y=O.useCallback(S=>{l(R=>R.map(D=>D.id===S?{...D,visible:!D.visible}:D))},[]),v=O.useMemo(()=>i.filter(S=>S.visible).length,[i]),j=O.useMemo(()=>Array.from(new Set(i.map(S=>S.category))),[]),w=O.useMemo(()=>{const{longitude:S,latitude:R,zoom:D}=e;return`<iframe src="${window.location.origin}${window.location.pathname}?map=${S.toFixed(3)},${R.toFixed(3)},${D}" width="100%" height="600" frameborder="0" style="border:1px solid #ccc;"></iframe>`},[e]),k=()=>{navigator.clipboard.writeText(w),p(!0),setTimeout(()=>p(!1),2e3)};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsx("div",{className:"flex justify-between items-start",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Public Interactive Maps"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Share water infrastructure, coverage, and service data through interactive maps"})]})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Visible Layers"}),t.jsx(wV,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:v}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:["Of ",i.length," total"]})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Total Layers"}),t.jsx(iu,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:j.length}),t.jsx("p",{className:"text-xs text-muted-foreground",children:j.join(", ")})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Downloads"}),t.jsx(Ta,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"542"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"GeoJSON/CSV exports"})]})]}),t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Embeds"}),t.jsx(qT,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:"8"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Active on websites"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[t.jsx("div",{className:"lg:col-span-3",children:t.jsxs(H,{className:"overflow-hidden",children:[t.jsx(de,{children:t.jsx(he,{children:"Interactive Map Viewer"})}),t.jsx(Q,{className:"p-0",children:t.jsx("div",{className:"h-96 relative",children:t.jsxs(Hb,{initialViewState:e,onMove:S=>r(S.viewState),mapStyle:n,children:[t.jsx(Zb,{position:"top-right"}),t.jsx(Yb,{}),t.jsx(C9,{position:"top-right"}),i.filter(S=>S.visible).map(S=>t.jsx(W_,{id:S.id+"-source",type:"geojson",data:{type:"FeatureCollection",features:[]},children:t.jsx(G_,{id:S.id+"-layer",type:"circle",paint:{"circle-color":S.color,"circle-radius":6}})},S.id))]})})})]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm",children:"Basemap Style"})}),t.jsx(Q,{className:"space-y-2",children:J6.map(S=>t.jsx(X,{variant:n===S.url?"default":"outline",onClick:()=>s(S.url),className:"w-full justify-start text-xs",children:S.name},S.id))})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm",children:"Layer Controls"})}),t.jsx(Q,{className:"space-y-3",children:j.map(S=>t.jsxs("div",{children:[t.jsx("h4",{className:"text-xs font-semibold text-muted-foreground mb-2",children:S}),t.jsx("div",{className:"space-y-2",children:i.filter(R=>R.category===S).map(R=>t.jsxs("div",{className:"flex items-start space-x-2",children:[t.jsx(Nm,{id:R.id,checked:R.visible,onCheckedChange:()=>y(R.id),className:"mt-1"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx(Me,{htmlFor:R.id,className:"text-xs cursor-pointer",children:t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:R.color}}),R.name]})}),t.jsx("p",{className:"text-xs text-muted-foreground",children:R.description})]})]},R.id))})]},S))})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm",children:"Share & Export"})}),t.jsxs(Q,{className:"space-y-2",children:[t.jsxs(Or,{open:d,onOpenChange:a,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{variant:"outline",className:"w-full justify-start text-xs",children:[t.jsx(qT,{className:"h-3 w-3 mr-2"})," Generate Embed"]})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Embed Code"})}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Copy and paste this code to embed the map on your website:"}),t.jsx("div",{className:"bg-muted p-3 rounded font-mono text-xs overflow-auto max-h-32 break-all",children:w}),t.jsx(X,{onClick:k,className:"w-full",variant:f?"default":"outline",children:f?t.jsx(t.Fragment,{children:" Copied to clipboard"}):t.jsxs(t.Fragment,{children:[t.jsx(x2,{className:"h-3 w-3 mr-2"})," Copy Embed Code"]})})]})]})]}),t.jsxs(X,{variant:"outline",className:"w-full justify-start text-xs",children:[t.jsx(Ta,{className:"h-3 w-3 mr-2"})," Download GeoJSON"]}),t.jsxs(X,{variant:"outline",className:"w-full justify-start text-xs",children:[t.jsx(Ta,{className:"h-3 w-3 mr-2"})," Download CSV"]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm",children:"Legend"})}),t.jsx(Q,{className:"space-y-2",children:i.map(S=>t.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[t.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:S.color}}),t.jsx("span",{children:S.name})]},S.id))})]})]})]})]})}function Eze(){return t.jsxs("div",{className:"flex h-screen bg-background",children:[t.jsx(Ia,{}),t.jsx("main",{className:"flex-1 overflow-auto",children:t.jsx(Oa,{})})]})}const li={topology:{getNodes:e=>xe.get("/core-ops/network/nodes",e),createNode:e=>xe.post("/core-ops/network/nodes",e),getEdges:e=>xe.get("/core-ops/network/edges",e),createEdge:e=>xe.post("/core-ops/network/edges",e),trace:(e,r)=>xe.post("/core-ops/network/trace",{from_node_id:e,to_node_id:r})},nrw:{getSnapshots:e=>xe.get("/core-ops/nrw/snapshots",e),createSnapshot:e=>xe.post("/core-ops/nrw/snapshots",e),calculateBalance:e=>xe.post(`/core-ops/nrw/calculate/${e}`),getInterventions:e=>xe.get("/core-ops/nrw/interventions",e),createIntervention:e=>xe.post("/core-ops/nrw/interventions",e)},dosing:{getPlans:e=>xe.get("/core-ops/dosing/plans",e),createPlan:e=>xe.post("/core-ops/dosing/plans",e),getStocks:e=>xe.get("/core-ops/dosing/stocks",e),createStock:e=>xe.post("/core-ops/dosing/stocks",e)},scheduling:{getSchedules:e=>xe.get("/core-ops/schedule",e),create:e=>xe.post("/core-ops/schedule",e),update:(e,r)=>xe.patch(`/core-ops/schedule/${e}`,r)},operations:{getDashboard:()=>xe.get("/core-ops/dashboard"),getAlarms:()=>xe.get("/core-ops/alarms")},shifts:{list:e=>xe.get("/operations/shifts",e),create:e=>xe.post("/operations/shifts",e),get:e=>xe.get(`/operations/shifts/${e}`),close:(e,r)=>xe.post(`/operations/shifts/${e}/close`,r),getEntries:(e,r)=>xe.get(`/operations/shifts/${e}/entries`,r),addEntry:(e,r)=>xe.post(`/operations/shifts/${e}/entries`,r)},events:{list:e=>xe.get("/operations/events",e),create:e=>xe.post("/operations/events",e),get:e=>xe.get(`/operations/events/${e}`),acknowledge:(e,r)=>xe.post(`/operations/events/${e}/acknowledge`,r),resolve:(e,r)=>xe.post(`/operations/events/${e}/resolve`,r),link:(e,r)=>xe.post(`/operations/events/${e}/link`,r)},checklists:{list:e=>xe.get("/operations/checklists",e),create:e=>xe.post("/operations/checklists",e),get:e=>xe.get(`/operations/checklists/${e}`),update:(e,r)=>xe.patch(`/operations/checklists/${e}`,r),delete:e=>xe.delete(`/operations/checklists/${e}`),startRun:(e,r)=>xe.post(`/operations/checklists/${e}/start`,r),listRuns:e=>xe.get("/operations/checklist-runs",e),updateRun:(e,r)=>xe.patch(`/operations/checklist-runs/${e}`,r),completeRun:(e,r)=>xe.post(`/operations/checklist-runs/${e}/complete`,r)},playbooks:{list:e=>xe.get("/operations/playbooks",e),create:e=>xe.post("/operations/playbooks",e),get:e=>xe.get(`/operations/playbooks/${e}`),update:(e,r)=>xe.patch(`/operations/playbooks/${e}`,r),delete:e=>xe.delete(`/operations/playbooks/${e}`),findMatching:e=>xe.get("/operations/playbooks/find-matching",e)},escalationPolicies:{list:e=>xe.get("/operations/escalation-policies",e),create:e=>xe.post("/operations/escalation-policies",e),get:e=>xe.get(`/operations/escalation-policies/${e}`),update:(e,r)=>xe.patch(`/operations/escalation-policies/${e}`,r),delete:e=>xe.delete(`/operations/escalation-policies/${e}`)}};function Mze(){const[e,r]=O.useState([]),[n,s]=O.useState(!1),[i,l]=O.useState(!0),{data:d,isLoading:a,error:f}=ct({queryKey:["operations-dashboard"],queryFn:()=>li.operations.getDashboard(),refetchInterval:3e4});O.useEffect(()=>{if(!i)return;let w=null,k=null,S=0;const R=3e4,D=()=>{try{w=new EventSource("/api/v1/console/alarms",{withCredentials:!0}),w.onopen=()=>{s(!0),S=0,console.log("SSE connection established")},w.onmessage=T=>{try{const I=JSON.parse(T.data);r(L=>[I,...L].slice(0,20))}catch(I){console.error("Failed to parse SSE message:",I)}},w.onerror=T=>{if(s(!1),(w==null?void 0:w.readyState)===EventSource.CLOSED){console.error("SSE connection closed by server"),S++;const I=Math.min(1e3*Math.pow(2,S),R);console.log(`Attempting to reconnect in ${I}ms (attempt ${S})`),k=setTimeout(()=>{i&&(w==null?void 0:w.readyState)===EventSource.CLOSED&&D()},I)}}}catch(T){console.error("Failed to create SSE connection:",T),s(!1)}};return D(),()=>{k&&clearTimeout(k),w&&w.close(),s(!1)}},[i]);const p=w=>{switch(w){case"planned":return t.jsx(Oo,{className:"h-4 w-4"});case"fault":return t.jsx(an,{className:"h-4 w-4"});case"power":return t.jsx($_,{className:"h-4 w-4"});case"water_quality":return t.jsx(Sc,{className:"h-4 w-4"});default:return t.jsx(Ka,{className:"h-4 w-4"})}},y=w=>{switch(w){case"live":return"destructive";case"approved":return"default";case"restored":return"secondary";default:return"outline"}},v=w=>{switch(w){case"running":return"default";case"scheduled":return"secondary";case"completed":return"outline";default:return"outline"}},j=w=>{switch(w){case"critical":return t.jsxs(Ee,{variant:"destructive",className:"gap-1",children:[t.jsx(Si,{className:"h-3 w-3"}),"Critical"]});case"warning":return t.jsxs(Ee,{className:"bg-orange-500 gap-1",children:[t.jsx(an,{className:"h-3 w-3"}),"Warning"]});case"info":return t.jsxs(Ee,{variant:"outline",className:"gap-1",children:[t.jsx(z_,{className:"h-3 w-3"}),"Info"]});default:return t.jsx(Ee,{variant:"outline",children:w})}};return t.jsxs("div",{className:"container mx-auto p-6 space-y-6 bg-background",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Operations Console"}),t.jsx("p",{className:"text-muted-foreground",children:"Real-time monitoring and control center"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"flex items-center gap-2 text-sm",children:n?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),t.jsx("span",{className:"text-muted-foreground",children:"Live Feed Active"})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400"}),t.jsx("span",{className:"text-muted-foreground",children:"Disconnected"})]})}),t.jsxs(X,{variant:"outline",size:"sm",onClick:()=>l(!i),children:[i?t.jsx(z_,{className:"h-4 w-4 mr-2"}):t.jsx(une,{className:"h-4 w-4 mr-2"}),i?"Disable":"Enable"," Alarms"]})]})]}),a&&!d?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading operations console..."})}):f?t.jsx(fa,{variant:"destructive",children:t.jsxs(ta,{children:["Error loading operations dashboard: ",f.message]})}):t.jsxs(t.Fragment,{children:[i&&e.length>0&&t.jsxs(H,{className:"border-orange-500 bg-orange-50/50 dark:bg-orange-950/20",children:[t.jsx(de,{children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(Si,{className:"h-5 w-5 text-orange-600"}),"Live Alarms"]}),t.jsx(cr,{children:"Real-time telemetry threshold violations"})]}),t.jsx(X,{variant:"ghost",size:"sm",onClick:()=>r([]),children:"Clear All"})]})}),t.jsx(Q,{children:t.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:e.map(w=>t.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-background border",children:[t.jsx("div",{className:"mt-1",children:j(w.severity)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center justify-between gap-2",children:[t.jsx("div",{className:"font-medium text-sm truncate",children:w.tag_name}),t.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:wn(new Date(w.timestamp),"HH:mm:ss")})]}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:w.message}),t.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs",children:[w.asset_name&&t.jsxs("span",{className:"text-muted-foreground",children:["Asset: ",w.asset_name]}),w.scheme_name&&t.jsxs("span",{className:"text-muted-foreground",children:["Scheme: ",w.scheme_name]}),t.jsxs("span",{className:"font-mono",children:["Value: ",t.jsx("span",{className:"font-semibold",children:w.value})," / Threshold: ",w.threshold]})]})]})]},w.id))})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs(H,{className:"bg-card text-card-foreground",children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Active Outages"}),t.jsx(an,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:(d==null?void 0:d.kpis.outages_count)||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Approved or currently live"})]})]}),t.jsxs(H,{className:"bg-card text-card-foreground",children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Pump Schedules"}),t.jsx(Oo,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:(d==null?void 0:d.kpis.schedules_count)||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Next 24 hours"})]})]}),t.jsxs(H,{className:"bg-card text-card-foreground",children:[t.jsxs(de,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:"Active Dosing Plans"}),t.jsx(Sc,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:(d==null?void 0:d.kpis.dose_plans_count)||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Actively controlling dosing"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(H,{className:"bg-card text-card-foreground",children:[t.jsxs(de,{children:[t.jsx(he,{className:"text-foreground",children:"Active Outages"}),t.jsx(cr,{children:"Current and planned water supply interruptions"})]}),t.jsx(Q,{children:d!=null&&d.active_outages&&d.active_outages.length>0?t.jsx("div",{className:"space-y-4",children:d.active_outages.map(w=>{var k;return t.jsxs("div",{className:"flex items-start gap-4 p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[t.jsx("div",{className:"mt-1",children:p(w.cause)}),t.jsxs("div",{className:"flex-1 space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"font-medium text-foreground",children:[((k=w.scheme)==null?void 0:k.name)||"Unknown Scheme",w.code&&t.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",w.code,")"]})]}),t.jsx(Ee,{variant:y(w.state),children:w.state})]}),w.summary&&t.jsx("p",{className:"text-sm text-muted-foreground",children:w.summary}),t.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[t.jsxs("span",{children:["Start: ",wn(new Date(w.starts_at),"PPp")]}),w.ends_at&&t.jsxs("span",{children:["End: ",wn(new Date(w.ends_at),"PPp")]})]}),w.estimated_customers_affected&&t.jsxs("div",{className:"text-xs text-muted-foreground",children:["~",w.estimated_customers_affected.toLocaleString()," customers affected"]})]})]},w.id)})}):t.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No active outages"})})]}),t.jsxs(H,{className:"bg-card text-card-foreground",children:[t.jsxs(de,{children:[t.jsx(he,{className:"text-foreground",children:"Pump Schedules"}),t.jsx(cr,{children:"Scheduled and running pump operations"})]}),t.jsx(Q,{children:d!=null&&d.active_schedules&&d.active_schedules.length>0?t.jsx("div",{className:"space-y-4",children:d.active_schedules.map(w=>{var k,S,R;return t.jsxs("div",{className:"flex items-start gap-4 p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[t.jsx("div",{className:"mt-1",children:t.jsx($_,{className:"h-4 w-4"})}),t.jsxs("div",{className:"flex-1 space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"font-medium text-foreground",children:((k=w.asset)==null?void 0:k.name)||((S=w.asset)==null?void 0:S.code)||"Unknown Asset"}),t.jsx(Ee,{variant:v(w.status),children:w.status})]}),t.jsx("div",{className:"text-sm text-muted-foreground",children:(R=w.scheme)==null?void 0:R.name}),t.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[t.jsx("span",{children:wn(new Date(w.start_at),"PPp")}),t.jsx("span",{children:""}),t.jsx("span",{children:wn(new Date(w.end_at),"PPp")})]}),w.target_volume_m3&&t.jsxs("div",{className:"text-xs text-muted-foreground",children:["Target: ",w.target_volume_m3.toLocaleString()," m"]})]})]},w.id)})}):t.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No scheduled pumping"})})]})]}),t.jsxs(H,{className:"bg-card text-card-foreground",children:[t.jsxs(de,{children:[t.jsx(he,{className:"text-foreground",children:"Active Dosing Plans"}),t.jsx(cr,{children:"Chemical dosing control currently in effect"})]}),t.jsx(Q,{children:d!=null&&d.active_dose_plans&&d.active_dose_plans.length>0?t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.active_dose_plans.map(w=>{var k,S,R;return t.jsxs("div",{className:"p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(Sc,{className:"h-4 w-4 text-primary"}),t.jsx("div",{className:"font-medium text-foreground",children:((k=w.asset)==null?void 0:k.name)||((S=w.asset)==null?void 0:S.code)||"Unknown Asset"})]}),t.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:(R=w.scheme)==null?void 0:R.name}),w.chemical&&t.jsxs("div",{className:"text-xs text-muted-foreground",children:["Chemical: ",w.chemical]})]},w.id)})}):t.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No active dosing plans"})})]}),t.jsxs(H,{className:"bg-card text-card-foreground",children:[t.jsxs(de,{children:[t.jsx(he,{className:"text-foreground",children:"Alarm Tags"}),t.jsx(cr,{children:"Telemetry tags with threshold monitoring enabled"})]}),t.jsx(Q,{children:d!=null&&d.alarm_tags&&d.alarm_tags.length>0?t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.alarm_tags.map(w=>{var k,S,R;return t.jsxs("div",{className:"p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"font-medium text-foreground",children:w.tag_name}),t.jsx(Ee,{variant:"outline",children:w.data_type})]}),t.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:((k=w.scheme)==null?void 0:k.name)||((S=w.asset)==null?void 0:S.name)||((R=w.facility)==null?void 0:R.name)}),w.unit&&t.jsxs("div",{className:"text-xs text-muted-foreground mb-1",children:["Unit: ",w.unit]}),w.thresholds&&t.jsxs("div",{className:"text-xs text-muted-foreground",children:["Thresholds: ",Object.entries(w.thresholds).map(([D,T])=>`${D}: ${T}`).join(", ")]})]},w.id)})}):t.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No alarm tags configured"})})]})]})]})}function Oze(){const[e,r]=O.useState("nodes"),[n,s]=O.useState(""),{data:i,isLoading:l}=ct({queryKey:["topology-nodes",n],queryFn:()=>li.topology.getNodes({node_type:n||void 0,per_page:50}),enabled:e==="nodes"}),{data:d,isLoading:a}=ct({queryKey:["topology-edges"],queryFn:()=>li.topology.getEdges({per_page:50}),enabled:e==="edges"}),f=p=>({source:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",reservoir:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",treatment:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",pump_station:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",junction:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",customer:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",prv:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",valve:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300",meter:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-300"})[p]||"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";return t.jsxs("div",{className:"container mx-auto p-6 space-y-6 bg-background",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Network Topology"}),t.jsx("p",{className:"text-muted-foreground",children:"Visualize and manage water network infrastructure"})]}),t.jsxs(X,{children:[t.jsx(Ene,{className:"mr-2 h-4 w-4"}),"Add Node"]})]}),t.jsxs(Sn,{value:e,onValueChange:p=>r(p),children:[t.jsxs(bn,{className:"bg-muted",children:[t.jsx(kt,{value:"nodes",children:"Nodes"}),t.jsx(kt,{value:"edges",children:"Edges"})]}),t.jsxs(Dt,{value:"nodes",className:"mt-6 space-y-4",children:[t.jsxs(H,{className:"bg-card text-card-foreground",children:[t.jsx(de,{children:t.jsx(he,{className:"text-foreground",children:"Filters"})}),t.jsx(Q,{children:t.jsxs("div",{className:"flex gap-4 items-end",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Node Type"}),t.jsx(Ve,{placeholder:"Filter by type (source, reservoir, pump_station, etc.)",value:n,onChange:p=>s(p.target.value),className:"bg-background text-foreground"})]}),t.jsx(X,{variant:"outline",onClick:()=>s(""),children:"Reset"})]})})]}),l?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading network nodes..."})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i==null?void 0:i.data.map(p=>t.jsxs(H,{className:"bg-card text-card-foreground hover:shadow-md transition-shadow",children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(BT,{className:"h-4 w-4"}),t.jsxs("div",{children:[t.jsx(he,{className:"text-base text-foreground",children:p.name}),t.jsx(cr,{className:"mt-1",children:p.code})]})]}),t.jsx(Ee,{className:f(p.node_type),children:p.node_type.replace("_"," ")})]})}),t.jsx(Q,{children:p.attributes&&Object.keys(p.attributes).length>0&&t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"text-xs font-medium text-foreground",children:"Attributes"}),t.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs",children:Object.entries(p.attributes).slice(0,4).map(([y,v])=>t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("span",{className:"text-muted-foreground capitalize",children:[y,":"]}),t.jsx("span",{className:"font-medium text-foreground truncate",children:String(v)})]},y))})]})})]},p.id))}),(i==null?void 0:i.data.length)===0&&t.jsx(H,{className:"bg-card text-card-foreground",children:t.jsxs(Q,{className:"flex flex-col items-center justify-center p-12",children:[t.jsx(BT,{className:"h-12 w-12 text-muted-foreground mb-4"}),t.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No network nodes found"}),t.jsx(X,{children:"Add First Node"})]})})]})]}),t.jsx(Dt,{value:"edges",className:"mt-6",children:a?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading network edges..."})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"space-y-4",children:d==null?void 0:d.data.map(p=>t.jsxs(H,{className:"bg-card text-card-foreground hover:shadow-md transition-shadow",children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(bN,{className:"h-4 w-4"}),t.jsxs("div",{children:[t.jsx(he,{className:"text-base text-foreground",children:p.code||`Edge ${p.id.slice(0,8)}`}),t.jsx(cr,{className:"mt-1 capitalize",children:p.edge_type.replace("_"," ")})]})]}),t.jsx(Ee,{variant:"outline",children:p.edge_type})]})}),t.jsx(Q,{children:t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[p.diameter_mm&&t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:"Diameter"}),t.jsxs("div",{className:"font-medium text-foreground",children:[p.diameter_mm," mm"]})]}),p.length_m&&t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:"Length"}),t.jsxs("div",{className:"font-medium text-foreground",children:[p.length_m.toLocaleString()," m"]})]}),p.material&&t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:"Material"}),t.jsx("div",{className:"font-medium text-foreground capitalize",children:p.material})]})]})})]},p.id))}),(d==null?void 0:d.data.length)===0&&t.jsx(H,{className:"bg-card text-card-foreground",children:t.jsxs(Q,{className:"flex flex-col items-center justify-center p-12",children:[t.jsx(bN,{className:"h-12 w-12 text-muted-foreground mb-4"}),t.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No network edges found"}),t.jsx(X,{children:"Add First Edge"})]})})]})})]})]})}function Ize(){const[e,r]=O.useState("snapshots"),{data:n,isLoading:s}=ct({queryKey:["nrw-snapshots"],queryFn:()=>li.nrw.getSnapshots({per_page:50}),enabled:e==="snapshots"}),{data:i,isLoading:l}=ct({queryKey:["nrw-interventions"],queryFn:()=>li.nrw.getInterventions({per_page:50}),enabled:e==="interventions"}),d=f=>f<15?"text-green-600":f<25?"text-yellow-600":f<35?"text-orange-600":"text-red-600",a=f=>{switch(f){case"leak_repair":return t.jsx(Jf,{className:"h-4 w-4"});case"meter_replacement":return t.jsx(Sc,{className:"h-4 w-4"});default:return t.jsx(Xa,{className:"h-4 w-4"})}};return t.jsxs("div",{className:"container mx-auto p-6 space-y-6 bg-background",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"NRW & Water Balance"}),t.jsx("p",{className:"text-muted-foreground",children:"Non-Revenue Water monitoring and intervention tracking"})]}),t.jsxs(X,{children:[t.jsx(Sc,{className:"mr-2 h-4 w-4"}),"Record Snapshot"]})]}),t.jsxs(Sn,{value:e,onValueChange:f=>r(f),children:[t.jsxs(bn,{className:"bg-muted",children:[t.jsx(kt,{value:"snapshots",children:"NRW Snapshots"}),t.jsx(kt,{value:"interventions",children:"Interventions"})]}),t.jsx(Dt,{value:"snapshots",className:"mt-6",children:s?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading NRW snapshots..."})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n==null?void 0:n.data.map(f=>{var p;return t.jsxs(H,{className:"bg-card text-card-foreground hover:shadow-md transition-shadow",children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx(he,{className:"text-base text-foreground",children:((p=f.dma)==null?void 0:p.name)||"Unknown DMA"}),t.jsx(cr,{children:wn(new Date(f.as_of),"PPP")})]}),t.jsxs("div",{className:`text-2xl font-bold ${d(f.nrw_pct)}`,children:[f.nrw_pct.toFixed(1),"%"]})]})}),t.jsxs(Q,{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:"System Input"}),t.jsxs("div",{className:"font-medium text-foreground",children:[f.system_input_volume_m3.toLocaleString()," m"]})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:"NRW Volume"}),t.jsxs("div",{className:"font-medium text-foreground",children:[f.nrw_m3.toLocaleString()," m"]})]})]}),t.jsxs("div",{className:"pt-3 border-t space-y-2",children:[t.jsxs("div",{className:"flex justify-between text-xs",children:[t.jsx("span",{className:"text-muted-foreground",children:"Billed Authorized:"}),t.jsxs("span",{className:"font-medium text-foreground",children:[f.billed_authorized_m3.toLocaleString()," m"]})]}),f.unbilled_authorized_m3&&f.unbilled_authorized_m3>0&&t.jsxs("div",{className:"flex justify-between text-xs",children:[t.jsx("span",{className:"text-muted-foreground",children:"Unbilled Authorized:"}),t.jsxs("span",{className:"font-medium text-foreground",children:[f.unbilled_authorized_m3.toLocaleString()," m"]})]}),f.apparent_losses_m3&&f.apparent_losses_m3>0&&t.jsxs("div",{className:"flex justify-between text-xs",children:[t.jsx("span",{className:"text-muted-foreground",children:"Apparent Losses:"}),t.jsxs("span",{className:"font-medium text-foreground",children:[f.apparent_losses_m3.toLocaleString()," m"]})]}),f.real_losses_m3&&f.real_losses_m3>0&&t.jsxs("div",{className:"flex justify-between text-xs",children:[t.jsx("span",{className:"text-muted-foreground",children:"Real Losses:"}),t.jsxs("span",{className:"font-medium text-foreground",children:[f.real_losses_m3.toLocaleString()," m"]})]})]})]})]},f.id)})}),(n==null?void 0:n.data.length)===0&&t.jsx(H,{className:"bg-card text-card-foreground",children:t.jsxs(Q,{className:"flex flex-col items-center justify-center p-12",children:[t.jsx(Sc,{className:"h-12 w-12 text-muted-foreground mb-4"}),t.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No NRW snapshots recorded"}),t.jsx(X,{children:"Record First Snapshot"})]})})]})}),t.jsx(Dt,{value:"interventions",className:"mt-6",children:l?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading interventions..."})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"space-y-4",children:i==null?void 0:i.data.map(f=>{var p,y;return t.jsxs(H,{className:"bg-card text-card-foreground hover:shadow-md transition-shadow",children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[a(f.type),t.jsxs("div",{children:[t.jsx(he,{className:"text-base text-foreground capitalize",children:f.type.replace("_"," ")}),t.jsx(cr,{children:((p=f.dma)==null?void 0:p.name)||((y=f.asset)==null?void 0:y.name)||"General"})]})]}),t.jsx(Ee,{variant:"outline",children:wn(new Date(f.date),"PP")})]})}),t.jsxs(Q,{children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[f.estimated_savings_m3d&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Xa,{className:"h-4 w-4 text-green-600"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:"Est. Savings"}),t.jsxs("div",{className:"font-medium text-foreground",children:[f.estimated_savings_m3d.toLocaleString()," m/day"]})]})]}),f.cost&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(co,{className:"h-4 w-4 text-muted-foreground"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:"Cost"}),t.jsxs("div",{className:"font-medium text-foreground",children:["$",f.cost.toLocaleString()]})]})]}),f.responsible&&t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:"Responsible"}),t.jsx("div",{className:"font-medium text-foreground",children:f.responsible})]})]}),f.notes&&t.jsx("div",{className:"mt-4 pt-4 border-t",children:t.jsx("div",{className:"text-xs text-muted-foreground",children:f.notes})})]})]},f.id)})}),(i==null?void 0:i.data.length)===0&&t.jsx(H,{className:"bg-card text-card-foreground",children:t.jsxs(Q,{className:"flex flex-col items-center justify-center p-12",children:[t.jsx(Jf,{className:"h-12 w-12 text-muted-foreground mb-4"}),t.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No interventions recorded"}),t.jsx(X,{children:"Record First Intervention"})]})})]})})]})]})}function Dze(){const[e,r]=O.useState("plans"),{data:n,isLoading:s}=ct({queryKey:["dose-plans"],queryFn:()=>li.dosing.getPlans({per_page:50}),enabled:e==="plans"}),{data:i,isLoading:l}=ct({queryKey:["chemical-stocks"],queryFn:()=>li.dosing.getStocks({per_page:50}),enabled:e==="stocks"}),d=a=>a.reorder_level_kg&&a.qty_on_hand_kg<=a.reorder_level_kg;return t.jsxs("div",{className:"container mx-auto p-6 space-y-6 bg-background",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Dosing Control"}),t.jsx("p",{className:"text-muted-foreground",children:"Chemical dosing plans and stock management"})]}),t.jsxs(X,{children:[t.jsx(Sc,{className:"mr-2 h-4 w-4"}),"Create Dose Plan"]})]}),t.jsxs(Sn,{value:e,onValueChange:a=>r(a),children:[t.jsxs(bn,{className:"bg-muted",children:[t.jsx(kt,{value:"plans",children:"Dosing Plans"}),t.jsx(kt,{value:"stocks",children:"Chemical Stock"})]}),t.jsx(Dt,{value:"plans",className:"mt-6",children:s?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading dosing plans..."})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n==null?void 0:n.data.map(a=>{var f,p,y;return t.jsxs(H,{className:`bg-card text-card-foreground ${a.active?"":"opacity-60"}`,children:[t.jsxs(de,{children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Sc,{className:"h-4 w-4 text-primary"}),t.jsx(he,{className:"text-base text-foreground",children:((f=a.asset)==null?void 0:f.name)||((p=a.asset)==null?void 0:p.code)||"Unknown Asset"})]}),t.jsx(Ee,{variant:a.active?"default":"secondary",children:a.active?"Active":"Inactive"})]}),t.jsx(cr,{children:(y=a.scheme)==null?void 0:y.name})]}),t.jsxs(Q,{className:"space-y-3",children:[a.chemical&&t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-muted-foreground",children:"Chemical:"}),t.jsx("span",{className:"font-medium text-foreground",children:a.chemical})]}),a.flow_bands&&t.jsxs("div",{className:"mt-3 pt-3 border-t",children:[t.jsx("div",{className:"text-xs font-medium text-foreground mb-2",children:"Flow Bands"}),t.jsxs("div",{className:"text-xs text-muted-foreground",children:[Object.keys(a.flow_bands).length," band(s) configured"]})]}),a.thresholds&&t.jsxs("div",{className:"mt-3 pt-3 border-t",children:[t.jsx("div",{className:"text-xs font-medium text-foreground mb-2",children:"Thresholds"}),t.jsxs("div",{className:"text-xs text-muted-foreground",children:[Object.keys(a.thresholds).length," threshold(s) configured"]})]})]})]},a.id)})}),(n==null?void 0:n.data.length)===0&&t.jsx(H,{className:"bg-card text-card-foreground",children:t.jsxs(Q,{className:"flex flex-col items-center justify-center p-12",children:[t.jsx(Sc,{className:"h-12 w-12 text-muted-foreground mb-4"}),t.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No dosing plans configured"}),t.jsx(X,{children:"Create First Dosing Plan"})]})})]})}),t.jsx(Dt,{value:"stocks",className:"mt-6",children:l?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading chemical stock..."})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"space-y-4",children:i==null?void 0:i.data.map(a=>{var f,p;return t.jsxs(H,{className:"bg-card text-card-foreground",children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(id,{className:"h-4 w-4"}),t.jsxs("div",{children:[t.jsx(he,{className:"text-base text-foreground",children:a.chemical}),t.jsxs(cr,{children:[(f=a.scheme)==null?void 0:f.name,((p=a.facility)==null?void 0:p.name)&&` - ${a.facility.name}`]})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:"As of"}),t.jsx("div",{className:"text-sm font-medium text-foreground",children:wn(new Date(a.as_of),"PP")})]})]})}),t.jsxs(Q,{children:[d(a)&&t.jsxs(fa,{variant:"destructive",className:"mb-4",children:[t.jsx(an,{className:"h-4 w-4"}),t.jsx(ta,{children:"Stock level is at or below reorder point"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Quantity on Hand"}),t.jsxs("div",{className:`text-2xl font-bold ${d(a)?"text-red-600":"text-foreground"}`,children:[a.qty_on_hand_kg.toLocaleString()," kg"]})]}),a.reorder_level_kg&&t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Reorder Level"}),t.jsxs("div",{className:"text-2xl font-bold text-muted-foreground",children:[a.reorder_level_kg.toLocaleString()," kg"]})]})]})]})]},a.id)})}),(i==null?void 0:i.data.length)===0&&t.jsx(H,{className:"bg-card text-card-foreground",children:t.jsxs(Q,{className:"flex flex-col items-center justify-center p-12",children:[t.jsx(id,{className:"h-12 w-12 text-muted-foreground mb-4"}),t.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No chemical stock records"}),t.jsx(X,{children:"Record Stock Level"})]})})]})})]})]})}function Rze(){const[e,r]=O.useState("calendar"),[n,s]=O.useState("all"),[i,l]=O.useState(np(new Date,{weekStartsOn:1})),[d,a]=O.useState(!1),[f,p]=O.useState(wn(new Date,"yyyy-MM-dd")),[y,v]=O.useState(wn(U1(new Date,7),"yyyy-MM-dd")),[j,w]=O.useState(null),k=Sr(),{data:S,isLoading:R,error:D}=ct({queryKey:["pump-schedules",n],queryFn:()=>li.scheduling.getSchedules({status:n!=="all"?n:void 0,per_page:100})}),T=Nt({mutationFn:async te=>{const be=await fetch("/api/v1/pump-schedules/optimize",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(te)});return be.ok?be.json():{schedules:Lze(te.start_date,te.end_date),estimated_savings:1250.5,peak_hours_avoided:18}},onSuccess:te=>{w(te),Ge.success(`Optimization complete! Estimated savings: $${te.estimated_savings.toFixed(2)}`)},onError:()=>{Ge.error("Optimization failed")}}),I=Nt({mutationFn:async()=>{if(!j)return;const te=await fetch("/api/v1/pump-schedules/batch",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({schedules:j.schedules})});if(!te.ok)throw new Error("Failed to apply schedules");return te.json()},onSuccess:()=>{k.invalidateQueries({queryKey:["pump-schedules"]}),a(!1),w(null),Ge.success("Optimized schedules applied successfully")},onError:()=>{Ge.error("Failed to apply optimized schedules")}}),L=zoe({start:i,end:Boe(i,{weekStartsOn:1})}),$=te=>{switch(te){case"running":return"default";case"scheduled":return"secondary";case"completed":return"outline";case"cancelled":return"destructive";default:return"outline"}},W=te=>te?t.jsx(Ee,{variant:te==="optimizer"?"default":"outline",className:"text-xs",children:te==="optimizer"?t.jsxs(t.Fragment,{children:[t.jsx(Si,{className:"h-3 w-3 mr-1"}),"Optimized"]}):"Manual"}):null,Z=te=>S!=null&&S.data?S.data.filter(be=>{const ie=Vg(_h(be.start_at));return UL(ie,Vg(te))}):[],oe=()=>{T.mutate({start_date:f,end_date:y})};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Pump Scheduling"}),t.jsx("p",{className:"text-muted-foreground",children:"Optimize and manage pump operations to minimize energy costs"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(Or,{open:d,onOpenChange:a,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{children:[t.jsx(Si,{className:"mr-2 h-4 w-4"}),"Optimize Schedule"]})}),t.jsxs(kr,{className:"sm:max-w-[500px]",children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:"Optimize Pump Schedule"}),t.jsx(Pi,{children:"Generate an optimized pumping schedule to minimize peak tariff usage while maintaining storage constraints"})]}),t.jsxs("div",{className:"space-y-4 mt-4",children:[t.jsxs("div",{children:[t.jsx(Me,{children:"Start Date"}),t.jsx(Ve,{type:"date",value:f,onChange:te=>p(te.target.value)})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"End Date"}),t.jsx(Ve,{type:"date",value:y,onChange:te=>v(te.target.value)})]}),t.jsx(X,{onClick:oe,className:"w-full",disabled:T.isPending,children:T.isPending?"Optimizing...":"Run Optimization"}),j&&t.jsxs(H,{className:"border-green-500 bg-green-50 dark:bg-green-950/20",children:[t.jsx(de,{className:"pb-3",children:t.jsx(he,{className:"text-base",children:"Optimization Results"})}),t.jsxs(Q,{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"Estimated Savings"}),t.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",j.estimated_savings.toFixed(2)]})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"Peak Hours Avoided"}),t.jsxs("div",{className:"text-2xl font-bold",children:[j.peak_hours_avoided,"h"]})]})]}),t.jsxs("div",{className:"border-t pt-3",children:[t.jsx("div",{className:"text-sm font-medium mb-2",children:"Proposed Schedule Blocks"}),t.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:j.schedules.map((te,be)=>{var ie;return t.jsxs("div",{className:"text-xs p-2 rounded bg-background border",children:[t.jsx("div",{className:"font-medium",children:((ie=te.asset)==null?void 0:ie.name)||"Pump"}),t.jsxs("div",{className:"text-muted-foreground",children:[wn(_h(te.start_at),"MMM d, HH:mm"),"  ",wn(_h(te.end_at),"HH:mm")]})]},be)})})]}),t.jsx(X,{onClick:()=>I.mutate(),className:"w-full",disabled:I.isPending,children:I.isPending?"Applying...":"Apply Optimization"})]})]})]})]})]}),t.jsxs(X,{variant:"outline",children:[t.jsx(Oo,{className:"mr-2 h-4 w-4"}),"Create Schedule"]})]})]}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"flex gap-4 items-end",children:[t.jsxs("div",{className:"w-48",children:[t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Status Filter"}),t.jsxs($t,{value:n,onValueChange:s,children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All Schedules"}),t.jsx(Ne,{value:"scheduled",children:"Scheduled"}),t.jsx(Ne,{value:"running",children:"Running"}),t.jsx(Ne,{value:"completed",children:"Completed"}),t.jsx(Ne,{value:"cancelled",children:"Cancelled"})]})]})]}),t.jsxs("div",{className:"flex gap-2 ml-auto",children:[t.jsxs(X,{variant:e==="calendar"?"default":"outline",size:"sm",onClick:()=>r("calendar"),children:[t.jsx(Oo,{className:"h-4 w-4 mr-2"}),"Calendar"]}),t.jsxs(X,{variant:e==="list"?"default":"outline",size:"sm",onClick:()=>r("list"),children:[t.jsx(Tne,{className:"h-4 w-4 mr-2"}),"List"]})]})]})})}),R&&!S?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading pump schedules..."})}):D?t.jsx("div",{className:"p-6 bg-destructive/10 border border-destructive rounded-lg",children:t.jsxs("p",{className:"text-lg text-destructive",children:["Error loading schedules: ",D.message]})}):e==="calendar"?t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx(he,{children:"Week View"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{variant:"outline",size:"sm",onClick:()=>l(U1(i,-7)),children:"Previous Week"}),t.jsx(X,{variant:"outline",size:"sm",onClick:()=>l(np(new Date,{weekStartsOn:1})),children:"This Week"}),t.jsx(X,{variant:"outline",size:"sm",onClick:()=>l(U1(i,7)),children:"Next Week"})]})]})}),t.jsx(Q,{children:t.jsx("div",{className:"grid grid-cols-7 gap-2",children:L.map(te=>{const be=Z(te),ie=UL(te,new Date);return t.jsxs("div",{className:`min-h-48 border rounded-lg p-2 ${ie?"border-primary bg-primary/5":"bg-card"}`,children:[t.jsxs("div",{className:"text-sm font-medium mb-2",children:[t.jsx("div",{children:wn(te,"EEE")}),t.jsx("div",{className:`text-2xl ${ie?"text-primary":""}`,children:wn(te,"d")})]}),t.jsx("div",{className:"space-y-1",children:be.map(ge=>{var Ie;return t.jsxs("div",{className:`text-xs p-2 rounded cursor-pointer transition-colors ${ge.status==="running"?"bg-green-100 dark:bg-green-950 border border-green-500":"bg-blue-50 dark:bg-blue-950/30 border"}`,children:[t.jsx("div",{className:"font-medium truncate",children:((Ie=ge.asset)==null?void 0:Ie.name)||"Pump"}),t.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[t.jsx(Xs,{className:"h-3 w-3"}),wn(_h(ge.start_at),"HH:mm")," - ",wn(_h(ge.end_at),"HH:mm")]}),ge.source==="optimizer"&&t.jsxs("div",{className:"flex items-center gap-1 text-green-600 dark:text-green-400 mt-1",children:[t.jsx(Si,{className:"h-3 w-3"}),t.jsx("span",{children:"Optimized"})]})]},ge.id)})})]},te.toString())})})})]}):t.jsxs("div",{className:"space-y-4",children:[S==null?void 0:S.data.map(te=>{var be,ie,ge;return t.jsxs(H,{className:"hover:shadow-md transition-shadow",children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx($_,{className:"h-4 w-4"}),t.jsxs("div",{children:[t.jsx(he,{className:"text-base",children:((be=te.asset)==null?void 0:be.name)||((ie=te.asset)==null?void 0:ie.code)||"Unknown Pump"}),t.jsx(cr,{children:(ge=te.scheme)==null?void 0:ge.name})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Ee,{variant:$(te.status),className:"capitalize",children:te.status}),W(te.source)]})]})}),t.jsxs(Q,{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Start Time"}),t.jsx("div",{className:"font-medium",children:wn(_h(te.start_at),"PPp")})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"End Time"}),t.jsx("div",{className:"font-medium",children:wn(_h(te.end_at),"PPp")})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t",children:[te.target_volume_m3&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(xs,{className:"h-4 w-4 text-muted-foreground"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:"Target Volume"}),t.jsxs("div",{className:"font-medium",children:[te.target_volume_m3.toLocaleString()," m"]})]})]}),te.actual_volume_m3&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(xs,{className:"h-4 w-4 text-primary"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:"Actual Volume"}),t.jsxs("div",{className:"font-medium",children:[te.actual_volume_m3.toLocaleString()," m"]})]})]}),te.energy_cost&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(co,{className:"h-4 w-4 text-muted-foreground"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:"Energy Cost"}),t.jsxs("div",{className:"font-medium",children:["$",te.energy_cost.toLocaleString()]})]})]})]}),te.constraints&&Object.keys(te.constraints).length>0&&t.jsxs("div",{className:"pt-4 border-t",children:[t.jsx("div",{className:"text-xs font-medium mb-2",children:"Constraints"}),t.jsxs("div",{className:"text-xs text-muted-foreground",children:[Object.keys(te.constraints).length," constraint(s) applied"]})]})]})]},te.id)}),(S==null?void 0:S.data.length)===0&&t.jsx(H,{children:t.jsxs(Q,{className:"flex flex-col items-center justify-center p-12",children:[t.jsx($_,{className:"h-12 w-12 text-muted-foreground mb-4"}),t.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No pump schedules found"}),t.jsxs(X,{children:[t.jsx(Oo,{className:"mr-2 h-4 w-4"}),"Create First Schedule"]})]})})]})]})}function Lze(e,r){const n=_h(e),s=[];for(let i=0;i<5;i++){const l=U1(n,i);s.push({id:`opt-${i}`,asset:{name:`Pump ${i+1}`,code:`PMP-00${i+1}`},scheme:{name:"Central Treatment Plant"},start_at:`${wn(l,"yyyy-MM-dd")}T02:00:00Z`,end_at:`${wn(l,"yyyy-MM-dd")}T06:00:00Z`,status:"scheduled",source:"optimizer",target_volume_m3:5e3,constraints:{max_storage:1e4}})}return s}function Fze(){const[e,r]=O.useState(""),[n,s]=O.useState("15"),[i,l]=O.useState("40"),[d,a]=O.useState("25"),[f,p]=O.useState(!1),y=Sr(),{data:v}=ct({queryKey:["dmas"],queryFn:async()=>{const I=await fetch("/api/v1/dmas?per_page=100",{credentials:"include"});if(!I.ok)throw new Error("Failed to fetch DMAs");return(await I.json()).data}}),{data:j}=ct({queryKey:["prv-targets"],queryFn:async()=>{const I=await fetch("/api/v1/prv-targets",{credentials:"include"});return I.ok?I.json():[]}}),{data:w}=ct({queryKey:["leak-suspicions"],queryFn:async()=>{const I=await fetch("/api/v1/leak-suspicions?score_threshold=0.6",{credentials:"include"});return I.ok?I.json():[{id:"1",segment_id:"SEG-001",segment_name:"Main St Pipeline",dma_name:"Central DMA",suspicion_score:.85,pressure_drop_pct:15.2,flow_anomaly_pct:12.5,last_reading:"2025-11-21T08:30:00Z",lat:-1.2921,lng:36.8219},{id:"2",segment_id:"SEG-047",segment_name:"Industrial Zone Feed",dma_name:"East DMA",suspicion_score:.72,pressure_drop_pct:8.3,flow_anomaly_pct:18.7,last_reading:"2025-11-21T08:25:00Z",lat:-1.2835,lng:36.8342},{id:"3",segment_id:"SEG-103",segment_name:"Residential Loop",dma_name:"West DMA",suspicion_score:.68,pressure_drop_pct:11.1,flow_anomaly_pct:9.4,last_reading:"2025-11-21T08:20:00Z",lat:-1.2987,lng:36.8105}]}}),k=Nt({mutationFn:async I=>{const L=await fetch("/api/v1/prv-targets",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(I)});if(!L.ok)throw new Error("Failed to save PRV target");return L.json()},onSuccess:()=>{y.invalidateQueries({queryKey:["prv-targets"]}),p(!1),Ge.success("PRV target saved successfully"),r(""),s("15"),l("40"),a("25")},onError:()=>{Ge.error("Failed to save PRV target")}}),S=Nt({mutationFn:async I=>{const L=w==null?void 0:w.find(W=>W.id===I),$=await fetch("/api/v1/work-orders",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({title:`Leak Investigation - ${L==null?void 0:L.segment_name}`,description:`High leak suspicion detected (score: ${L==null?void 0:L.suspicion_score}).
Pressure drop: ${L==null?void 0:L.pressure_drop_pct}%
Flow anomaly: ${L==null?void 0:L.flow_anomaly_pct}%`,priority:L&&L.suspicion_score>.8?"high":"medium",kind:"corrective",asset_ids:[]})});if(!$.ok)throw new Error("Failed to create work order");return $.json()},onSuccess:()=>{Ge.success("Work order created successfully")},onError:()=>{Ge.error("Failed to create work order")}}),R=()=>{if(!e||!n||!i||!d){Ge.error("Please fill all fields");return}k.mutate({dma_id:e,min_pressure_m:parseFloat(n),max_pressure_m:parseFloat(i),prv_setpoint_m:parseFloat(d)})},D=I=>I>=.8?"#ef4444":I>=.7?"#f59e0b":"#eab308",T={type:"FeatureCollection",features:(w||[]).map(I=>({type:"Feature",geometry:{type:"Point",coordinates:[I.lng,I.lat]},properties:{score:I.suspicion_score}}))};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Pressure & Leak Management"}),t.jsx("p",{className:"text-muted-foreground",children:"Monitor pressure targets and detect potential leaks using ML-based analysis"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs(H,{className:"lg:col-span-1",children:[t.jsxs(de,{children:[t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(Us,{className:"h-5 w-5"}),"PRV Pressure Targets"]}),t.jsx(cr,{children:"Configure pressure reducing valve setpoints by DMA"})]}),t.jsxs(Q,{children:[t.jsxs(Or,{open:f,onOpenChange:p,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{className:"w-full mb-4",children:[t.jsx(Us,{className:"mr-2 h-4 w-4"}),"Add/Edit Target"]})}),t.jsxs(kr,{children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:"PRV Target Configuration"}),t.jsx(Pi,{children:"Set pressure targets for a District Metered Area"})]}),t.jsxs("div",{className:"space-y-4 mt-4",children:[t.jsxs("div",{children:[t.jsx(Me,{children:"DMA"}),t.jsxs($t,{value:e,onValueChange:r,children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select DMA"})}),t.jsx(Lt,{children:v==null?void 0:v.map(I=>t.jsxs(Ne,{value:I.id,children:[I.code," - ",I.name]},I.id))})]})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Minimum Pressure (m)"}),t.jsx(Ve,{type:"number",value:n,onChange:I=>s(I.target.value),placeholder:"15",step:"0.1"})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Maximum Pressure (m)"}),t.jsx(Ve,{type:"number",value:i,onChange:I=>l(I.target.value),placeholder:"40",step:"0.1"})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"PRV Setpoint (m)"}),t.jsx(Ve,{type:"number",value:d,onChange:I=>a(I.target.value),placeholder:"25",step:"0.1"}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Recommended: ",Math.round((parseFloat(n)+parseFloat(i))/2)," m"]})]}),t.jsx(X,{onClick:R,className:"w-full",disabled:k.isPending,children:k.isPending?"Saving...":"Save Target"})]})]})]}),t.jsx("div",{className:"space-y-3",children:j&&j.length>0?j.map(I=>t.jsxs(H,{className:"p-3",children:[t.jsxs("div",{className:"flex justify-between items-start mb-2",children:[t.jsx("div",{className:"font-medium text-sm",children:I.dma_name}),t.jsxs(Ee,{variant:"outline",className:"text-xs",children:["PRV: ",I.prv_setpoint_m,"m"]})]}),t.jsxs("div",{className:"flex gap-4 text-xs text-muted-foreground",children:[t.jsxs("span",{children:["Min: ",I.min_pressure_m,"m"]}),t.jsxs("span",{children:["Max: ",I.max_pressure_m,"m"]})]})]},I.id)):t.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No PRV targets configured"})})]})]}),t.jsxs(H,{className:"lg:col-span-2",children:[t.jsxs(de,{children:[t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(an,{className:"h-5 w-5 text-orange-500"}),"Leak Suspicion Heatmap"]}),t.jsx(cr,{children:"ML-based leak detection using pressure and flow anomalies"})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"h-[400px] rounded-lg overflow-hidden border",children:t.jsxs(Hb,{initialViewState:{longitude:36.8219,latitude:-1.2921,zoom:11},style:{width:"100%",height:"100%"},mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",children:[t.jsx(Zb,{position:"top-right"}),t.jsx(Yb,{}),t.jsx(W_,{id:"leak-heatmap",type:"geojson",data:T,children:t.jsx(G_,{id:"leak-points",type:"circle",paint:{"circle-radius":["interpolate",["linear"],["get","score"],.6,10,.9,25],"circle-color":["interpolate",["linear"],["get","score"],.6,"#eab308",.7,"#f59e0b",.8,"#ef4444"],"circle-opacity":.6,"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}})})]})}),t.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded-full bg-yellow-500"}),t.jsx("span",{className:"text-sm",children:"Moderate (0.6-0.7)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded-full bg-orange-500"}),t.jsx("span",{className:"text-sm",children:"High (0.7-0.8)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded-full bg-red-500"}),t.jsx("span",{className:"text-sm",children:"Critical (0.8+)"})]})]})]})]})]}),t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"High-Suspicion Segments"}),t.jsx(cr,{children:"Network segments with elevated leak probability requiring investigation"})]}),t.jsx(Q,{children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Segment"}),t.jsx(ce,{children:"DMA"}),t.jsx(ce,{children:"Suspicion Score"}),t.jsx(ce,{children:"Pressure Drop"}),t.jsx(ce,{children:"Flow Anomaly"}),t.jsx(ce,{children:"Last Reading"}),t.jsx(ce,{className:"text-right",children:"Actions"})]})}),t.jsx(mr,{children:w&&w.length>0?w.map(I=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:t.jsxs("div",{children:[t.jsx("div",{children:I.segment_name}),t.jsx("div",{className:"text-xs text-muted-foreground",children:I.segment_id})]})}),t.jsx(se,{children:I.dma_name}),t.jsx(se,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:D(I.suspicion_score)}}),t.jsxs("span",{className:"font-mono text-sm",children:[(I.suspicion_score*100).toFixed(0),"%"]})]})}),t.jsx(se,{children:t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Xa,{className:"h-4 w-4 text-red-500"}),t.jsxs("span",{className:"text-sm",children:[I.pressure_drop_pct.toFixed(1),"%"]})]})}),t.jsx(se,{children:t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(xs,{className:"h-4 w-4 text-orange-500"}),t.jsxs("span",{className:"text-sm",children:[I.flow_anomaly_pct.toFixed(1),"%"]})]})}),t.jsx(se,{className:"text-sm text-muted-foreground",children:new Date(I.last_reading).toLocaleString()}),t.jsx(se,{className:"text-right",children:t.jsxs(X,{size:"sm",onClick:()=>S.mutate(I.id),disabled:S.isPending,children:[t.jsx(Jf,{className:"mr-2 h-4 w-4"}),"Create WO"]})})]},I.id)):t.jsx(ut,{children:t.jsx(se,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No high-suspicion segments detected"})})})]})})]})]})}function zze(){var v;const e=Sr(),[r,n]=O.useState(""),[s,i]=O.useState("all"),{data:l,isLoading:d,error:a}=ct({queryKey:["shifts",s],queryFn:()=>li.shifts.list({status:s==="all"?void 0:s,per_page:50})}),f=Nt({mutationFn:j=>li.shifts.close(j,{}),onSuccess:()=>{e.invalidateQueries({queryKey:["shifts"]})}}),p=((v=l==null?void 0:l.data)==null?void 0:v.filter(j=>{var w,k;return j.name.toLowerCase().includes(r.toLowerCase())||((k=(w=j.facility)==null?void 0:w.name)==null?void 0:k.toLowerCase().includes(r.toLowerCase()))}))||[],y=j=>{switch(j){case"active":return"bg-green-100 text-green-800";case"planned":return"bg-blue-100 text-blue-800";case"closed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Shifts Management"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"24/7 shift scheduling and logbook"})]}),t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Shift"]})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx(Ve,{placeholder:"Search by shift name or facility...",value:r,onChange:j=>n(j.target.value),className:"max-w-sm"}),t.jsx("div",{className:"flex gap-2",children:["all","planned","active","closed"].map(j=>t.jsx(X,{variant:s===j?"default":"outline",onClick:()=>i(j),size:"sm",children:j.charAt(0).toUpperCase()+j.slice(1)},j))})]}),d?t.jsx(H,{children:t.jsx(Q,{className:"p-8 text-center text-muted-foreground",children:"Loading shifts..."})}):a?t.jsxs(fa,{variant:"destructive",children:[t.jsx(an,{className:"h-4 w-4"}),t.jsxs(ta,{children:["Error loading shifts: ",a.message]})]}):p.length===0?t.jsx(H,{children:t.jsx(Q,{className:"p-8 text-center text-muted-foreground",children:"No shifts found"})}):t.jsx("div",{className:"grid gap-4",children:p.map(j=>t.jsx(H,{className:"hover:shadow-md transition-shadow",children:t.jsx(Q,{className:"p-6",children:t.jsxs("div",{className:"flex justify-between items-start gap-4",children:[t.jsxs("div",{className:"flex-1 space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("h3",{className:"font-semibold text-lg",children:j.name}),t.jsx(Ee,{className:y(j.status),children:j.status})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[j.facility&&t.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[t.jsx(Ma,{className:"h-4 w-4"}),j.facility.name]}),j.supervisor&&t.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[t.jsx(Hs,{className:"h-4 w-4"}),j.supervisor.name]}),t.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[t.jsx(Xs,{className:"h-4 w-4"}),wn(new Date(j.starts_at),"HH:mm")," - ",wn(new Date(j.ends_at),"HH:mm")]}),j.entries_count!==void 0&&t.jsxs("div",{className:"text-muted-foreground",children:[j.entries_count," entries"]})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{variant:"outline",size:"sm",children:"View"}),j.status==="active"&&t.jsx(X,{size:"sm",variant:"destructive",onClick:()=>f.mutate(j.id),disabled:f.isPending,children:"Close"})]})]})})},j.id))})]})}function $ze(){const e=Sr(),[r,n]=O.useState("all"),[s,i]=O.useState("all"),{data:l,isLoading:d,error:a}=ct({queryKey:["events",r,s],queryFn:()=>li.events.list({severity:r==="all"?void 0:r,status:s==="all"?void 0:s,per_page:50})}),f=Nt({mutationFn:k=>li.events.acknowledge(k,{note:"Acknowledged"}),onSuccess:()=>{e.invalidateQueries({queryKey:["events"]})}}),p=Nt({mutationFn:k=>li.events.resolve(k,{resolution:"Resolved"}),onSuccess:()=>{e.invalidateQueries({queryKey:["events"]})}}),y=k=>{switch(k){case"critical":return"destructive";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"secondary";default:return"outline"}},v=k=>{switch(k){case"critical":return t.jsx(Si,{className:"h-4 w-4"});case"high":return t.jsx(an,{className:"h-4 w-4"});default:return null}},j=k=>{switch(k){case"new":return"bg-red-100 text-red-800";case"ack":return"bg-blue-100 text-blue-800";case"in_progress":return"bg-purple-100 text-purple-800";case"resolved":return"bg-green-100 text-green-800";case"closed":return"bg-gray-100 text-gray-800";default:return"outline"}},w=(l==null?void 0:l.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Events & Alarms"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Monitor, acknowledge, and resolve system events"})]}),t.jsxs("div",{className:"flex flex-wrap gap-3",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx("span",{className:"text-sm font-medium text-muted-foreground py-2",children:"Severity:"}),["all","critical","high","medium","low"].map(k=>t.jsx(X,{variant:r===k?"default":"outline",onClick:()=>n(k),size:"sm",children:k==="all"?"All":k.charAt(0).toUpperCase()+k.slice(1)},k))]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("span",{className:"text-sm font-medium text-muted-foreground py-2",children:"Status:"}),["all","new","ack","resolved"].map(k=>t.jsx(X,{variant:s===k?"default":"outline",onClick:()=>i(k),size:"sm",children:k==="all"?"All":k.charAt(0).toUpperCase()+k.slice(1)},k))]})]}),d?t.jsx(H,{children:t.jsx(Q,{className:"p-8 text-center text-muted-foreground",children:"Loading events..."})}):a?t.jsxs(fa,{variant:"destructive",children:[t.jsx(an,{className:"h-4 w-4"}),t.jsxs(ta,{children:["Error loading events: ",a.message]})]}):w.length===0?t.jsx(H,{children:t.jsx(Q,{className:"p-8 text-center text-muted-foreground",children:"No events found"})}):t.jsx("div",{className:"space-y-3",children:w.map(k=>t.jsx(H,{className:"hover:shadow-md transition-shadow",children:t.jsx(Q,{className:"p-5",children:t.jsxs("div",{className:"flex justify-between items-start gap-4",children:[t.jsxs("div",{className:"flex-1 space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[v(k.severity)&&t.jsx(t.Fragment,{children:v(k.severity)}),t.jsx("h3",{className:"font-semibold",children:k.category}),t.jsx(Ee,{className:y(k.severity),children:k.severity}),t.jsx(Ee,{className:j(k.status),children:k.status})]}),k.description&&t.jsx("p",{className:"text-sm text-muted-foreground",children:k.description}),t.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground pt-2",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Xs,{className:"h-3 w-3"}),wn(new Date(k.detected_at),"Pp")]}),k.facility&&t.jsx("div",{children:k.facility.name}),t.jsx("div",{className:"text-gray-500",children:k.source})]})]}),t.jsxs("div",{className:"flex gap-2",children:[k.status==="new"&&t.jsx(X,{size:"sm",variant:"outline",onClick:()=>f.mutate(k.id),disabled:f.isPending,children:"Acknowledge"}),k.status!=="resolved"&&k.status!=="closed"&&t.jsxs(X,{size:"sm",onClick:()=>p.mutate(k.id),disabled:p.isPending,children:[t.jsx(Fs,{className:"h-4 w-4 mr-1"}),"Resolve"]})]})]})})},k.id))})]})}function Bze({onSchemaChange:e}){var v;const{control:r,register:n,watch:s,formState:{errors:i}}=By(),{fields:l,append:d,remove:a,move:f}=FI({control:r,name:"schema"});s("schema");const p=()=>{d({question:"",type:"boolean",required:!0,options:[]})},y=["boolean","text","number","choice","rating"];return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(Me,{className:"text-base font-semibold",children:"Checklist Questions"}),t.jsxs(X,{type:"button",variant:"outline",size:"sm",onClick:p,children:[t.jsx(Ot,{className:"h-4 w-4 mr-1"}),"Add Question"]})]}),l.length===0?t.jsx(H,{className:"border-dashed",children:t.jsx(Q,{className:"p-8 text-center text-muted-foreground",children:t.jsx("p",{className:"text-sm",children:'No questions yet. Click "Add Question" to get started.'})})}):t.jsx("div",{className:"space-y-3",children:l.map((j,w)=>t.jsx(qze,{fieldIndex:w,onRemove:()=>a(w),onMove:k=>{k==="up"&&w>0&&f(w,w-1),k==="down"&&w<l.length-1&&f(w,w+1)},register:n,fieldTypes:y,watch:s},j.id))}),i.schema&&t.jsx("p",{className:"text-sm text-red-500",children:(v=i.schema)==null?void 0:v.message}),t.jsxs("div",{className:"text-sm text-muted-foreground pt-2",children:[l.length," question",l.length!==1?"s":""," in this checklist"]})]})}function qze({fieldIndex:e,onRemove:r,onMove:n,register:s,fieldTypes:i,watch:l}){const d=l(`schema.${e}`),[a,f]=O.useState((d==null?void 0:d.type)==="choice"),p=l(`schema.${e}.options`),y=(p==null?void 0:p.split(`
`).filter(v=>v.trim()))||[];return t.jsx(H,{className:"border bg-muted/30",children:t.jsx(Q,{className:"p-4 space-y-4",children:t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsxs("div",{className:"flex-1 space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs(Me,{htmlFor:`question-${e}`,className:"text-sm",children:["Question ",e+1]}),t.jsx(Ve,{id:`question-${e}`,placeholder:"Enter your question...",...s(`schema.${e}.question`,{required:"Question is required"})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:`type-${e}`,className:"text-sm",children:"Type"}),t.jsx("select",{id:`type-${e}`,...s(`schema.${e}.type`),onChange:v=>{f(v.target.value==="choice")},className:"w-full rounded border border-input bg-background px-3 py-2 text-sm",children:i.map(v=>t.jsx("option",{value:v,children:v.charAt(0).toUpperCase()+v.slice(1)},v))})]}),t.jsx("div",{className:"space-y-2",children:t.jsxs(Me,{className:"text-sm flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",...s(`schema.${e}.required`),className:"rounded"}),t.jsx("span",{children:"Required"})]})})]}),a&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:`options-${e}`,className:"text-sm",children:"Options (one per line)"}),t.jsx("textarea",{id:`options-${e}`,placeholder:`Option 1
Option 2
Option 3`,rows:3,...s(`schema.${e}.options`),className:"w-full rounded border border-input bg-background px-3 py-2 text-sm font-mono"}),y.length>0&&t.jsx("div",{className:"flex flex-wrap gap-2 pt-2",children:y.map((v,j)=>t.jsx("div",{className:"bg-background rounded px-2 py-1 border text-xs",children:v.trim()},j))})]})]}),t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx(X,{type:"button",variant:"ghost",size:"sm",onClick:()=>n("up"),title:"Move up",className:"text-muted-foreground",children:""}),t.jsx(X,{type:"button",variant:"ghost",size:"sm",onClick:()=>n("down"),title:"Move down",className:"text-muted-foreground",children:""}),t.jsx(X,{type:"button",variant:"ghost",size:"sm",onClick:r,title:"Delete",className:"text-destructive hover:text-destructive",children:t.jsx(As,{className:"h-4 w-4"})})]})]})})})}function eB({initialChecklist:e,onSuccess:r}){const n=yi({defaultValues:{title:(e==null?void 0:e.title)||"",frequency:(e==null?void 0:e.frequency)||"",schema:(e==null?void 0:e.schema)||[{question:"Is the facility operational?",type:"boolean",required:!0,options:[]}]}}),s=Nt({mutationFn:l=>e?li.checklists.update(e.id,l):li.checklists.create(l),onSuccess:()=>{Ge.success(e?"Checklist updated":"Checklist created"),r==null||r()},onError:l=>{Ge.error(l.message)}}),i=l=>{if(!l.schema||l.schema.length===0){Ge.error("Add at least one question");return}if(l.schema.some(f=>{var p;return!((p=f.question)!=null&&p.trim())})){Ge.error("All questions must have text");return}const a=l.schema.map(f=>({...f,options:f.type==="choice"&&f.options?f.options.split(`
`).filter(p=>p.trim()):[]}));s.mutate({...l,schema:a})};return t.jsx(OW,{...n,children:t.jsxs("form",{onSubmit:n.handleSubmit(i),className:"space-y-6",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"title",children:"Checklist Title"}),t.jsx(Ve,{id:"title",placeholder:"e.g., Daily Facility Inspection",...n.register("title",{required:"Title is required"})}),n.formState.errors.title&&t.jsx("p",{className:"text-sm text-red-500",children:n.formState.errors.title.message})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"frequency",children:"Frequency (Optional)"}),t.jsxs("select",{id:"frequency",...n.register("frequency"),className:"w-full rounded border border-input bg-background px-3 py-2 text-sm",children:[t.jsx("option",{value:"",children:"No specific frequency"}),t.jsx("option",{value:"daily",children:"Daily"}),t.jsx("option",{value:"weekly",children:"Weekly"}),t.jsx("option",{value:"monthly",children:"Monthly"}),t.jsx("option",{value:"shift_start",children:"At shift start"}),t.jsx("option",{value:"shift_end",children:"At shift end"}),t.jsx("option",{value:"on_demand",children:"On demand"})]})]}),t.jsx(Bze,{}),t.jsx(X,{type:"submit",disabled:s.isPending,className:"w-full",children:s.isPending?"Saving...":e?"Update Checklist":"Create Checklist"})]})})}function Vze(){const e=Sr(),[r,n]=O.useState("checklists"),[s,i]=O.useState(!1),[l,d]=O.useState(null),{data:a,isLoading:f}=ct({queryKey:["checklists"],queryFn:()=>li.checklists.list({per_page:50})}),{data:p,isLoading:y}=ct({queryKey:["checklist-runs"],queryFn:()=>li.checklists.listRuns({per_page:50})}),v=Nt({mutationFn:k=>li.checklists.delete(k),onSuccess:()=>{Ge.success("Checklist deleted"),e.invalidateQueries({queryKey:["checklists"]})}}),j=(a==null?void 0:a.data)||[],w=(p==null?void 0:p.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Checklists"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Create and manage facility checklists"})]}),t.jsxs(Or,{open:s,onOpenChange:i,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Checklist"]})}),t.jsxs(kr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:"Create Checklist"}),t.jsx(Pi,{children:"Define questions for your facility checklist"})]}),t.jsx(eB,{onSuccess:()=>{i(!1),e.invalidateQueries({queryKey:["checklists"]})}})]})]})]}),t.jsxs(Sn,{value:r,onValueChange:n,children:[t.jsxs(bn,{children:[t.jsx(kt,{value:"checklists",children:"Templates"}),t.jsx(kt,{value:"runs",children:"Runs"})]}),t.jsx(Dt,{value:"checklists",className:"space-y-4",children:f?t.jsx(H,{children:t.jsx(Q,{className:"p-8 text-center text-muted-foreground",children:"Loading checklists..."})}):j.length===0?t.jsx(H,{children:t.jsx(Q,{className:"p-8 text-center text-muted-foreground",children:"No checklists found. Create one to get started!"})}):t.jsx("div",{className:"grid gap-4",children:j.map(k=>{var S,R;return t.jsx(H,{className:"hover:shadow-md transition-shadow",children:t.jsx(Q,{className:"p-6",children:t.jsxs("div",{className:"flex justify-between items-start gap-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("h3",{className:"font-semibold text-lg",children:k.title}),k.frequency&&t.jsx(Ee,{variant:"outline",children:k.frequency})]}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[((S=k.schema)==null?void 0:S.length)||0," questions",((R=k._count)==null?void 0:R.runs)&&`  ${k._count.runs} runs completed`]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(Or,{children:[t.jsx(pn,{asChild:!0,children:t.jsx(X,{variant:"outline",size:"sm",children:"Edit"})}),t.jsxs(kr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Edit Checklist"})}),t.jsx(eB,{initialChecklist:k,onSuccess:()=>{e.invalidateQueries({queryKey:["checklists"]})}})]})]}),t.jsx(X,{size:"sm",children:"Start Run"}),t.jsx(X,{variant:"destructive",size:"sm",onClick:()=>v.mutate(k.id),disabled:v.isPending,children:t.jsx(As,{className:"h-4 w-4"})})]})]})})},k.id)})})}),t.jsx(Dt,{value:"runs",className:"space-y-4",children:y?t.jsx(H,{children:t.jsx(Q,{className:"p-8 text-center text-muted-foreground",children:"Loading runs..."})}):w.length===0?t.jsx(H,{children:t.jsx(Q,{className:"p-8 text-center text-muted-foreground",children:"No checklist runs yet"})}):t.jsx("div",{className:"grid gap-4",children:w.map(k=>t.jsx(H,{className:"hover:shadow-md transition-shadow",children:t.jsx(Q,{className:"p-6",children:t.jsxs("div",{className:"flex justify-between items-start gap-4",children:[t.jsxs("div",{className:"flex-1 space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[k.completed_at?t.jsx(bu,{className:"h-5 w-5 text-green-600"}):t.jsx("div",{className:"h-5 w-5 rounded-full border-2 border-blue-600"}),t.jsx("h3",{className:"font-semibold",children:k.checklist.title}),k.score!==void 0&&t.jsxs(Ee,{className:"bg-green-100 text-green-800",children:[k.score,"%"]})]}),t.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[t.jsxs("div",{children:["Started: ",wn(new Date(k.started_at),"Pp")]}),k.completed_at&&t.jsxs("div",{children:["Completed: ",wn(new Date(k.completed_at),"Pp")]}),k.performed_by&&t.jsxs("div",{children:["By: ",k.performed_by.name]})]})]}),t.jsx(X,{variant:"outline",size:"sm",children:"View Details"})]})})},k.id))})})]})]})}function Uze(){const{data:e,isLoading:r,error:n}=ct({queryKey:["playbooks"],queryFn:()=>li.playbooks.list({per_page:50})}),s=(e==null?void 0:e.data)||[],i=d=>{switch(d){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-gray-100 text-gray-800";default:return"outline"}},l=d=>{switch(d){case"automated":return t.jsx(Si,{className:"h-4 w-4"});case"decision":return t.jsx(vu,{className:"h-4 w-4"});default:return null}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Playbooks"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Event response automation and runbooks"})]}),t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Playbook"]})]}),r?t.jsx(H,{children:t.jsx(Q,{className:"p-8 text-center text-muted-foreground",children:"Loading playbooks..."})}):n?t.jsxs(fa,{variant:"destructive",children:[t.jsx(an,{className:"h-4 w-4"}),t.jsxs(ta,{children:["Error loading playbooks: ",n.message]})]}):s.length===0?t.jsx(H,{children:t.jsx(Q,{className:"p-8 text-center text-muted-foreground",children:"No playbooks found. Create one to automate event responses!"})}):t.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:s.map(d=>{var a,f;return t.jsxs(H,{className:"hover:shadow-md transition-shadow flex flex-col",children:[t.jsx(de,{className:"pb-3",children:t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx(he,{className:"text-lg",children:d.name}),d.for_category&&t.jsxs(cr,{className:"text-xs mt-1",children:["For: ",d.for_category]})]}),d.for_severity&&t.jsx(Ee,{className:i(d.for_severity),children:d.for_severity})]})}),t.jsx(Q,{className:"flex-1 pb-3",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{className:"text-sm text-muted-foreground font-medium",children:[((a=d.steps)==null?void 0:a.length)||0," steps"]}),t.jsx("div",{className:"space-y-1 max-h-32 overflow-y-auto text-xs",children:(f=d.steps)==null?void 0:f.map((p,y)=>t.jsxs("div",{className:"flex items-start gap-2 p-1.5 bg-muted/50 rounded",children:[t.jsxs("span",{className:"text-muted-foreground font-semibold min-w-6",children:[y+1,"."]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"font-medium truncate",children:p.title}),p.type&&t.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground mt-0.5",children:[l(p.type),t.jsx("span",{children:p.type})]})]})]},y))})]})}),t.jsxs("div",{className:"flex gap-2 border-t pt-3",children:[t.jsx(X,{variant:"outline",size:"sm",className:"flex-1",children:"Edit"}),t.jsx(X,{size:"sm",className:"flex-1",children:"Test"})]})]},d.id)})})]})}function tB({initialPolicy:e,onSuccess:r}){const{control:n,register:s,handleSubmit:i,formState:{errors:l}}=yi({defaultValues:{name:(e==null?void 0:e.name)||"",rules:(e==null?void 0:e.rules)||[{severity:"critical",escalate_after_minutes:15,notification_channels:["email"],recipients:[{type:"email",target:""}]}]}}),{fields:d,append:a,remove:f}=FI({control:n,name:"rules"}),p=Nt({mutationFn:v=>e?li.escalationPolicies.update(e.id,v):li.escalationPolicies.create(v),onSuccess:()=>{Ge.success(e?"Policy updated":"Policy created"),r==null||r()},onError:v=>{Ge.error(v.message)}}),y=v=>{if(!v.rules||v.rules.length===0){Ge.error("Add at least one escalation rule");return}p.mutate(v)};return t.jsxs("form",{onSubmit:i(y),className:"space-y-6",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{htmlFor:"name",children:"Policy Name"}),t.jsx(Ve,{id:"name",placeholder:"e.g., Critical Priority Response",...s("name",{required:"Name is required"})}),l.name&&t.jsx("p",{className:"text-sm text-red-500",children:l.name.message})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(Me,{className:"text-base font-semibold",children:"Escalation Rules"}),t.jsxs(X,{type:"button",variant:"outline",size:"sm",onClick:()=>a({severity:"high",escalate_after_minutes:30,notification_channels:["email"],recipients:[{type:"email",target:""}]}),children:[t.jsx(Ot,{className:"h-4 w-4 mr-1"}),"Add Rule"]})]}),t.jsx("div",{className:"space-y-3",children:d.map((v,j)=>t.jsx(Wze,{ruleIndex:j,onRemove:()=>f(j),register:s,control:n},v.id))})]}),t.jsx(X,{type:"submit",disabled:p.isPending,className:"w-full",children:p.isPending?"Saving...":e?"Update Policy":"Create Policy"})]})}function Wze({ruleIndex:e,onRemove:r,register:n,control:s}){const{fields:i,append:l,remove:d}=FI({control:s,name:`rules.${e}.recipients`}),a=["critical","high","medium","low"],f=["email","sms","webhook","push"];return t.jsx(H,{className:"border bg-muted/30",children:t.jsx(Q,{className:"p-4 space-y-4",children:t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{className:"flex-1 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{className:"text-sm",children:"Severity"}),t.jsx("select",{...n(`rules.${e}.severity`),className:"w-full rounded border border-input bg-background px-3 py-2 text-sm",children:a.map(p=>t.jsx("option",{value:p,children:p.charAt(0).toUpperCase()+p.slice(1)},p))})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{className:"text-sm",children:"Escalate After (min)"}),t.jsx(Ve,{type:"number",min:"1",...n(`rules.${e}.escalate_after_minutes`,{required:!0,valueAsNumber:!0})})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{className:"text-sm",children:"Repeat Every (min)"}),t.jsx(Ve,{type:"number",min:"15",placeholder:"Optional",...n(`rules.${e}.repeat_every_minutes`,{valueAsNumber:!0})})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Me,{className:"text-sm",children:"Notification Channels"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:f.map(p=>t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",value:p,...n(`rules.${e}.notification_channels`),className:"rounded"}),t.jsx("span",{className:"text-sm",children:p.charAt(0).toUpperCase()+p.slice(1)})]},p))})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(Me,{className:"text-sm",children:"Recipients"}),t.jsxs(X,{type:"button",variant:"ghost",size:"sm",onClick:()=>l({type:"email",target:""}),children:[t.jsx(Ot,{className:"h-3 w-3 mr-1"}),"Add"]})]}),t.jsx("div",{className:"space-y-2",children:i.map((p,y)=>t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("select",{...n(`rules.${e}.recipients.${y}.type`),className:"w-24 rounded border border-input bg-background px-2 py-1 text-sm",children:[t.jsx("option",{value:"email",children:"Email"}),t.jsx("option",{value:"phone",children:"Phone"}),t.jsx("option",{value:"user",children:"User"}),t.jsx("option",{value:"role",children:"Role"})]}),t.jsx(Ve,{placeholder:"Email, phone, user ID, or role",...n(`rules.${e}.recipients.${y}.target`),className:"flex-1 text-sm"}),t.jsx(X,{type:"button",variant:"ghost",size:"sm",onClick:()=>d(y),children:t.jsx(As,{className:"h-3 w-3"})})]},p.id))})]})]}),t.jsx(X,{type:"button",variant:"ghost",size:"sm",onClick:r,className:"text-destructive hover:text-destructive",children:t.jsx(As,{className:"h-4 w-4"})})]})})})}function Gze(){const e=Sr(),[r,n]=O.useState(""),[s,i]=O.useState(!1),[l,d]=O.useState(null),{data:a,isLoading:f,error:p}=ct({queryKey:["escalation-policies",r],queryFn:()=>li.escalationPolicies.list({search:r||void 0,per_page:50})}),y=Nt({mutationFn:w=>li.escalationPolicies.delete(w),onSuccess:()=>{e.invalidateQueries({queryKey:["escalation-policies"]})}}),v=(a==null?void 0:a.data)||[],j=w=>{switch(w){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-gray-100 text-gray-800";default:return"outline"}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Escalation Policies"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Define SLA escalation rules and notification recipients"})]}),t.jsxs(Or,{open:s,onOpenChange:i,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Policy"]})}),t.jsxs(kr,{className:"max-w-2xl",children:[t.jsxs(Tr,{children:[t.jsx(Er,{children:"Create Escalation Policy"}),t.jsx(Pi,{children:"Define notification rules for event escalation by severity"})]}),t.jsx(tB,{onSuccess:()=>{i(!1),e.invalidateQueries({queryKey:["escalation-policies"]})}})]})]})]}),t.jsx(Ve,{placeholder:"Search policies...",value:r,onChange:w=>n(w.target.value),className:"max-w-sm"}),f?t.jsx(H,{children:t.jsx(Q,{className:"p-8 text-center text-muted-foreground",children:"Loading policies..."})}):p?t.jsxs(fa,{variant:"destructive",children:[t.jsx(an,{className:"h-4 w-4"}),t.jsxs(ta,{children:["Error loading policies: ",p.message]})]}):v.length===0?t.jsx(H,{children:t.jsx(Q,{className:"p-8 text-center text-muted-foreground",children:"No escalation policies found. Create one to get started!"})}):t.jsx("div",{className:"grid gap-4",children:v.map(w=>{var k;return t.jsx(H,{className:"hover:shadow-md transition-shadow",children:t.jsx(Q,{className:"p-6",children:t.jsxs("div",{className:"flex justify-between items-start gap-4",children:[t.jsxs("div",{className:"flex-1 space-y-4",children:[t.jsx("h3",{className:"font-semibold text-lg",children:w.name}),t.jsx("div",{className:"space-y-3",children:(k=w.rules)==null?void 0:k.map((S,R)=>{var D,T;return t.jsx("div",{className:"p-3 rounded-lg bg-muted/50 border border-muted",children:t.jsx("div",{className:"flex items-start justify-between gap-3",children:t.jsxs("div",{className:"flex-1 space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ee,{className:j(S.severity),children:S.severity}),t.jsxs("span",{className:"text-sm text-muted-foreground",children:["Escalate after ",S.escalate_after_minutes," min"]}),S.repeat_every_minutes&&t.jsxs("span",{className:"text-xs text-muted-foreground",children:["(Repeat every ",S.repeat_every_minutes," min)"]})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("div",{className:"text-muted-foreground mb-1",children:"Channels:"}),t.jsx("div",{className:"flex flex-wrap gap-1",children:(D=S.notification_channels)==null?void 0:D.map(I=>t.jsx(Ee,{variant:"outline",className:"text-xs",children:I},I))})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("div",{className:"text-muted-foreground mb-1",children:"Recipients:"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:(T=S.recipients)==null?void 0:T.map((I,L)=>t.jsxs("div",{className:"text-xs bg-background rounded px-2 py-1 border",children:[I.type,": ",I.target]},L))})]})]})})},R)})})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(Or,{children:[t.jsx(pn,{asChild:!0,children:t.jsx(X,{variant:"outline",size:"sm",children:t.jsx(g2,{className:"h-4 w-4"})})}),t.jsxs(kr,{className:"max-w-2xl",children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Edit Escalation Policy"})}),t.jsx(tB,{initialPolicy:w,onSuccess:()=>{e.invalidateQueries({queryKey:["escalation-policies"]})}})]})]}),t.jsx(X,{variant:"destructive",size:"sm",onClick:()=>y.mutate(w.id),disabled:y.isPending,children:t.jsx(As,{className:"h-4 w-4"})})]})]})})},w.id)})})]})}function Kze(){const[e,r]=O.useState("assets"),n=[{assetId:"pump_001",failureProbability:87,daysToFailure:8,confidence:.92,riskLevel:"high",recommendedAction:"schedule_maintenance_today"},{assetId:"pump_003",failureProbability:62,daysToFailure:21,confidence:.85,riskLevel:"medium",recommendedAction:"monitor_closely"},{assetId:"motor_005",failureProbability:45,daysToFailure:35,confidence:.78,riskLevel:"medium",recommendedAction:"plan_maintenance_next_month"}],s=[{dmaId:"dma_001",nrwPercentage:35.2,baselineNrw:28.5,anomalyScore:.87,leakDetected:!0,estimatedLossMc:450,estimatedCostPerDay:2250,urgency:"high"}],i=[{date:"2025-12-01",demand:1200,lower:1050,upper:1350},{date:"2025-12-02",demand:1350,lower:1180,upper:1520},{date:"2025-12-03",demand:1100,lower:950,upper:1250},{date:"2025-12-04",demand:1280,lower:1120,upper:1440}],l=[{pumpId:"pump_001",startTime:"22:00",endTime:"04:00",reason:"off_peak_tariff",estimatedCost:450},{pumpId:"pump_002",startTime:"08:00",endTime:"10:00",reason:"peak_demand",estimatedCost:180}],d={affectedConnections:1240,affectedPopulation:6200,impactScore:72,suggestedTiming:"2025-12-22 midnight (Sunday, lower demand)"},a=p=>p>=80?"text-red-600 bg-red-50":p>=60?"text-orange-600 bg-orange-50":"text-yellow-600 bg-yellow-50",f=p=>{switch(p){case"critical":return"text-red-600 bg-red-50";case"high":return"text-orange-600 bg-orange-50";case"medium":return"text-yellow-600 bg-yellow-50";default:return"text-blue-600 bg-blue-50"}};return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Predictive Analytics"}),t.jsx("p",{className:"text-gray-600 mt-2",children:"AI-powered insights for proactive operations management"})]})}),t.jsxs(Sn,{value:e,onValueChange:p=>r(p),className:"w-full",children:[t.jsxs(bn,{className:"grid w-full grid-cols-5",children:[t.jsxs(kt,{value:"assets",children:[t.jsx(an,{className:"w-4 h-4 mr-2"}),"Asset Health"]}),t.jsxs(kt,{value:"nrw",children:[t.jsx(ps,{className:"w-4 h-4 mr-2"}),"NRW Anomalies"]}),t.jsxs(kt,{value:"demand",children:[t.jsx(xs,{className:"w-4 h-4 mr-2"}),"Demand"]}),t.jsxs(kt,{value:"schedule",children:[t.jsx(Si,{className:"w-4 h-4 mr-2"}),"Schedules"]}),t.jsxs(kt,{value:"outage",children:[t.jsx(ps,{className:"w-4 h-4 mr-2"}),"Outage Impact"]})]}),t.jsx(Dt,{value:"assets",className:"space-y-4",children:t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"Asset Failure Predictions"}),t.jsx(cr,{children:"Predicted pump and equipment failures based on telemetry patterns"})]}),t.jsx(Q,{children:t.jsx("div",{className:"space-y-3",children:n.map(p=>t.jsxs("div",{className:`p-4 rounded-lg border ${a(p.failureProbability)}`,children:[t.jsxs("div",{className:"flex justify-between items-start mb-2",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:p.assetId}),t.jsxs("p",{className:"text-sm opacity-75",children:[p.daysToFailure," days to likely failure"]})]}),t.jsxs("span",{className:"text-xl font-bold",children:[p.failureProbability,"%"]})]}),t.jsxs("p",{className:"text-sm mb-2",children:[t.jsx("span",{className:"font-medium",children:"Action:"})," ",p.recommendedAction]}),t.jsxs("p",{className:"text-xs opacity-75",children:["Confidence: ",Math.round(p.confidence*100),"%"]})]},p.assetId))})})]})}),t.jsx(Dt,{value:"nrw",className:"space-y-4",children:t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"NRW Anomaly Detection"}),t.jsx(cr,{children:"Detected unusual water loss patterns indicating potential leaks"})]}),t.jsx(Q,{children:t.jsx("div",{className:"space-y-3",children:s.map(p=>t.jsxs("div",{className:`p-4 rounded-lg border ${f(p.urgency)}`,children:[t.jsxs("div",{className:"flex justify-between items-start mb-3",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:p.dmaId}),t.jsx("p",{className:"text-sm opacity-75",children:"Leak Detected"})]}),t.jsxs("span",{className:"text-lg font-bold",children:[p.nrwPercentage.toFixed(1),"%"]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-2",children:[t.jsxs("div",{children:[t.jsx("p",{className:"opacity-75",children:"Baseline NRW"}),t.jsxs("p",{className:"font-medium",children:[p.baselineNrw.toFixed(1),"%"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"opacity-75",children:"Loss/Day"}),t.jsxs("p",{className:"font-medium",children:[p.estimatedLossMc," m"]})]})]}),t.jsxs("p",{className:"text-sm font-medium",children:["Cost: KES ",p.estimatedCostPerDay.toLocaleString(),"/day"]})]},p.dmaId))})})]})}),t.jsx(Dt,{value:"demand",className:"space-y-4",children:t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"7-Day Demand Forecast"}),t.jsx(cr,{children:"Predicted water consumption with confidence intervals"})]}),t.jsx(Q,{children:t.jsx("div",{className:"space-y-3",children:i.map(p=>t.jsxs("div",{className:"p-4 rounded-lg border border-blue-200 bg-blue-50",children:[t.jsxs("div",{className:"flex justify-between items-start mb-2",children:[t.jsx("div",{children:t.jsx("h3",{className:"font-semibold text-gray-900",children:p.date})}),t.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[p.demand," m"]})]}),t.jsx("div",{className:"w-full bg-gray-200 h-2 rounded-full relative",children:t.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${(p.demand-p.lower)/(p.upper-p.lower)*100}%`}})}),t.jsxs("p",{className:"text-xs opacity-75 mt-1",children:["Range: ",p.lower," - ",p.upper," m"]})]},p.date))})})]})}),t.jsx(Dt,{value:"schedule",className:"space-y-4",children:t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"Pump Schedule Optimizer"}),t.jsx(cr,{children:"Recommended pump operation times to minimize energy costs"})]}),t.jsx(Q,{children:t.jsx("div",{className:"space-y-3",children:l.map(p=>t.jsxs("div",{className:"p-4 rounded-lg border border-green-200 bg-green-50",children:[t.jsxs("div",{className:"flex justify-between items-start mb-2",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:p.pumpId}),t.jsxs("p",{className:"text-sm opacity-75",children:[p.startTime," - ",p.endTime]})]}),t.jsxs("span",{className:"text-lg font-bold text-green-600",children:["KES ",p.estimatedCost]})]}),t.jsxs("p",{className:"text-sm",children:[t.jsx("span",{className:"font-medium",children:"Reason:"})," ",p.reason]})]},p.pumpId))})})]})}),t.jsx(Dt,{value:"outage",className:"space-y-4",children:t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"Outage Impact Prediction"}),t.jsx(cr,{children:"Predicted customer impact from scheduled outages"})]}),t.jsx(Q,{children:t.jsx("div",{className:"space-y-4",children:t.jsxs("div",{className:"p-4 rounded-lg border border-orange-200 bg-orange-50",children:[t.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Current Outage Plan"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm opacity-75",children:"Affected Connections"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.affectedConnections.toLocaleString()})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm opacity-75",children:"Affected Population"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.affectedPopulation.toLocaleString()})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-sm opacity-75",children:"Impact Score"}),t.jsx("div",{className:"w-full bg-gray-200 h-2 rounded-full mt-1",children:t.jsx("div",{className:"h-full bg-orange-500 rounded-full",style:{width:`${d.impactScore}%`}})}),t.jsxs("p",{className:"text-sm font-medium mt-1",children:[d.impactScore," / 100"]})]}),t.jsxs("div",{className:"p-3 bg-white rounded border border-orange-300",children:[t.jsx("p",{className:"text-sm opacity-75",children:"Suggested Alternative Timing"}),t.jsx("p",{className:"font-semibold text-gray-900",children:d.suggestedTiming})]})]})})})]})})]})]})}function Hze(){const e=Sr(),[r,n]=O.useState(""),[s,i]=O.useState(!1),[l,d]=O.useState({key:"",name:"",spec:""}),{data:a,isLoading:f}=ct({queryKey:["workflow-definitions"],queryFn:()=>xe.get("/workflows/definitions")}),p=Nt({mutationFn:w=>xe.post("/workflows/definitions",w),onSuccess:()=>{Ge.success("Workflow created"),e.invalidateQueries({queryKey:["workflow-definitions"]}),i(!1)}}),y=Nt({mutationFn:w=>xe.post(`/workflows/definitions/${w}/activate`,{}),onSuccess:()=>{e.invalidateQueries({queryKey:["workflow-definitions"]})}}),v=Nt({mutationFn:w=>xe.delete(`/workflows/definitions/${w}`),onSuccess:()=>{e.invalidateQueries({queryKey:["workflow-definitions"]})}}),j=(a==null?void 0:a.data)||[];return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex justify-between items-start mb-6",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Workflow Definitions"}),t.jsx("p",{className:"text-muted-foreground max-w-2xl",children:"Define automated workflows as code to automate business processes. Create state machines that define how work progresses through different states, with automatic actions, SLA tracking, and escalation rules. Templates are available for Work Orders, Incidents, Complaints, Procurement, and more."})]}),t.jsxs(Or,{open:s,onOpenChange:i,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Workflow"]})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Create Workflow Definition"})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Key"}),t.jsx(Ve,{placeholder:"work_order.v1",value:l.key,onChange:w=>d({...l,key:w.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Name"}),t.jsx(Ve,{placeholder:"Work Order Workflow",value:l.name,onChange:w=>d({...l,name:w.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Spec (JSON)"}),t.jsx("textarea",{className:"w-full rounded border p-2 font-mono text-sm",rows:6,placeholder:'{"key":"work_order.v1","states":[{"name":"new"}]}',value:l.spec,onChange:w=>d({...l,spec:w.target.value})})]}),t.jsx(X,{onClick:()=>p.mutate({...l,spec:JSON.parse(l.spec)}),disabled:p.isPending,className:"w-full",children:"Create"})]})]})]})]}),t.jsx(Ve,{placeholder:"Search workflows...",value:r,onChange:w=>n(w.target.value),className:"max-w-sm"}),f?t.jsx("p",{children:"Loading..."}):t.jsx("div",{className:"grid gap-4",children:j.map(w=>t.jsx(H,{children:t.jsx(Q,{className:"p-6",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("h3",{className:"font-semibold text-lg",children:w.name}),w.active?t.jsx(Ee,{className:"bg-green-100 text-green-800",children:"Active"}):t.jsx(Ee,{variant:"outline",children:"Inactive"}),t.jsxs(Ee,{variant:"secondary",children:["v",w.version]})]}),t.jsx("p",{className:"text-sm text-muted-foreground",children:w.key})]}),t.jsxs("div",{className:"flex gap-2",children:[!w.active&&t.jsx(X,{size:"sm",variant:"outline",onClick:()=>y.mutate(w.id),children:t.jsx(Fs,{className:"h-4 w-4"})}),t.jsx(X,{size:"sm",variant:"outline",onClick:()=>window.location.href=`/workflows/definitions/${w.id}`,children:t.jsx(g2,{className:"h-4 w-4"})}),t.jsx(X,{size:"sm",variant:"destructive",onClick:()=>v.mutate(w.id),children:t.jsx(As,{className:"h-4 w-4"})})]})]})})},w.id))})]})}function Zze(){const e=Sr(),[r,n]=O.useState(""),[s,i]=O.useState(""),{data:l,isLoading:d}=ct({queryKey:["workflow-instances",r,s],queryFn:()=>xe.get("/workflows/instances",{state:r||void 0,entity_type:s||void 0})}),a=Nt({mutationFn:y=>xe.post(`/workflows/instances/${y.id}/trigger`,{trigger:y.trigger}),onSuccess:()=>{Ge.success("Triggered successfully"),e.invalidateQueries({queryKey:["workflow-instances"]})}}),f=(l==null?void 0:l.data)||[],p=y=>({new:"bg-blue-100 text-blue-800",assigned:"bg-yellow-100 text-yellow-800",in_progress:"bg-purple-100 text-purple-800",done:"bg-green-100 text-green-800",closed:"bg-gray-100 text-gray-800"})[y]||"outline";return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Workflow Instances"}),t.jsx("p",{className:"text-muted-foreground mt-2 max-w-2xl",children:"Monitor running workflow instances in real-time. Track the progress of Work Orders, Incidents, Complaints, Procurement requests, and other business entities as they move through defined workflow states. Manually trigger transitions, check SLA compliance, and view the complete audit trail of all state changes."})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx(Ve,{placeholder:"Filter by state...",value:r,onChange:y=>n(y.target.value),className:"max-w-sm"}),t.jsx(Ve,{placeholder:"Filter by entity type...",value:s,onChange:y=>i(y.target.value),className:"max-w-sm"})]}),d?t.jsx("p",{children:"Loading..."}):f.length===0?t.jsx(H,{children:t.jsx(Q,{className:"p-8 text-center text-muted-foreground",children:"No instances found"})}):t.jsx("div",{className:"space-y-4",children:f.map(y=>t.jsx(H,{children:t.jsx(Q,{className:"p-6",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsxs("h3",{className:"font-semibold",children:[y.entity_type," #",y.entity_id]}),t.jsx(Ee,{className:p(y.state),children:y.state})]}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Started: ",wn(new Date(y.started_at),"MMM dd, yyyy HH:mm")]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{size:"sm",onClick:()=>a.mutate({id:y.id,trigger:"proceed"}),disabled:a.isPending,children:"Proceed"}),t.jsx(X,{size:"sm",variant:"outline",onClick:()=>window.location.href=`/workflows/instances/${y.id}`,children:"Details"})]})]})})},y.id))})]})}function Yze(){const e=Sr(),[r,n]=O.useState(!1),[s,i]=O.useState({operatorId:"",topic:"operation",score:""}),[l,d]=O.useState(1),a=6,{data:f,isLoading:p}=ct({queryKey:["capacity-assessments",l],queryFn:()=>xe.get("/training/assessments")}),y=Nt({mutationFn:k=>xe.post("/training/assessments",k),onSuccess:()=>{Ge.success("Assessment recorded"),e.invalidateQueries({queryKey:["capacity-assessments"]}),n(!1)}}),v=(f==null?void 0:f.data)||[],j=(k,S)=>k==="pending"?"bg-gray-100 text-gray-800":S?"bg-green-100 text-green-800":"bg-red-100 text-red-800",w={totalOperators:245,certified:189,pendingReview:32,needsTraining:24};return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Operator Capacity Assessment"}),t.jsx("p",{className:"text-muted-foreground",children:"Evaluate and certify water system operators. Track competency assessments, certification validity, and training needs."})]}),t.jsxs(Or,{open:r,onOpenChange:n,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Assessment"]})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Record Assessment"})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Operator ID"}),t.jsx(Ve,{placeholder:"ID or phone number",value:s.operatorId,onChange:k=>i({...s,operatorId:k.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Assessment Topic"}),t.jsxs("select",{className:"w-full rounded border p-2",value:s.topic,onChange:k=>i({...s,topic:k.target.value}),children:[t.jsx("option",{value:"operation",children:"System Operation"}),t.jsx("option",{value:"maintenance",children:"Preventive Maintenance"}),t.jsx("option",{value:"safety",children:"Safety & HSE"}),t.jsx("option",{value:"billing",children:"Tariff & Billing"}),t.jsx("option",{value:"customer",children:"Customer Service"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Score (0-100)"}),t.jsx(Ve,{type:"number",min:"0",max:"100",value:s.score,onChange:k=>i({...s,score:k.target.value})})]}),t.jsx(X,{onClick:()=>y.mutate({operatorId:s.operatorId,topic:s.topic,score:parseInt(s.score)}),disabled:y.isPending,className:"w-full",children:"Record Assessment"})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsx(he,{className:"text-sm font-medium",children:"Total Operators"})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-3xl font-bold",children:w.totalOperators}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Across all schemes"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(bu,{className:"h-4 w-4 text-green-600"})," Certified"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-3xl font-bold text-green-600",children:w.certified}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[Math.round(w.certified/w.totalOperators*100),"% of total"]})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(ps,{className:"h-4 w-4 text-yellow-600"})," Pending"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-3xl font-bold text-yellow-600",children:w.pendingReview}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Under review"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(ps,{className:"h-4 w-4 text-red-600"})," Training Needed"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-3xl font-bold text-red-600",children:w.needsTraining}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Not yet certified"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx(he,{children:"Recent Assessments"}),t.jsxs("span",{className:"text-sm text-muted-foreground",children:[v.length," assessments"]})]})}),t.jsxs(Q,{children:[t.jsx($y,{className:"h-[500px] pr-4",children:t.jsx("div",{className:"space-y-4",children:p?t.jsx("p",{children:"Loading assessments..."}):v.slice((l-1)*a,l*a).map(k=>t.jsxs("div",{className:"p-4 border rounded-lg",children:[t.jsxs("div",{className:"flex justify-between items-start mb-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold",children:k.operatorName}),t.jsx("p",{className:"text-sm text-muted-foreground",children:k.topic})]}),t.jsx(Ee,{className:j(k.status,k.certificationValid),children:k.certificationValid?"CERTIFIED":"PENDING"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsxs("span",{children:["Score: ",k.score,"/",k.maxScore]}),t.jsxs("span",{className:"font-semibold",children:[Math.round(k.score/k.maxScore*100),"%"]})]}),t.jsx(du,{value:k.score/k.maxScore*100})]}),k.validUntil&&t.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Cert valid until: ",k.validUntil]})]},k.id))})}),v.length>a&&t.jsxs("div",{className:"flex justify-between items-center mt-6 pt-4 border-t",children:[t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Page ",l," of ",Math.ceil(v.length/a)]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{variant:"outline",size:"sm",onClick:()=>d(Math.max(1,l-1)),disabled:l===1,children:t.jsx(rI,{className:"h-4 w-4"})}),t.jsx(X,{variant:"outline",size:"sm",onClick:()=>d(Math.min(Math.ceil(v.length/a),l+1)),disabled:l>=Math.ceil(v.length/a),children:t.jsx(Oy,{className:"h-4 w-4"})})]})]})]})]})]})}function Xze(){const e=Sr(),[r,n]=O.useState(!1),[s,i]=O.useState({name:"",safeYield:""}),[l,d]=O.useState(1),a=5,{data:f,isLoading:p}=ct({queryKey:["aquifers",l],queryFn:()=>xe.get("/hydromet/aquifers")}),y=Nt({mutationFn:S=>xe.post("/hydromet/aquifers",S),onSuccess:()=>{Ge.success("Aquifer registered"),e.invalidateQueries({queryKey:["aquifers"]}),n(!1)}}),v=(f==null?void 0:f.data)||[],j=S=>S==="critical"?"bg-red-100 text-red-800":S==="high"?"bg-orange-100 text-orange-800":S==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800",w={totalAquifers:v.length,atRisk:v.filter(S=>S.riskLevel==="high"||S.riskLevel==="critical").length,totalSafeYield:v.reduce((S,R)=>S+(R.safeYieldMcm||0),0),totalCurrent:v.reduce((S,R)=>S+(R.currentYieldMcm||0),0)},k=w.totalSafeYield>0?Math.round(w.totalCurrent/w.totalSafeYield*100):0;return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Aquifer Management"}),t.jsx("p",{className:"text-muted-foreground",children:"Monitor groundwater resources, track sustainable yield, recharge rates, and aquifer health. Manage 7 priority aquifers across ASAL counties."})]}),t.jsxs(Or,{open:r,onOpenChange:n,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"Register Aquifer"]})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Register Aquifer"})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Aquifer Name"}),t.jsx(Ve,{placeholder:"e.g., Elwak Aquifer",value:s.name,onChange:S=>i({...s,name:S.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Safe Yield (MCM/year)"}),t.jsx(Ve,{type:"number",placeholder:"Annual sustainable yield",value:s.safeYield,onChange:S=>i({...s,safeYield:S.target.value})})]}),t.jsx(X,{onClick:()=>y.mutate({name:s.name,safeYieldMcm:parseInt(s.safeYield)}),disabled:y.isPending,className:"w-full",children:"Register"})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsx(he,{className:"text-sm font-medium",children:"Priority Aquifers"})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-3xl font-bold",children:w.totalAquifers}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Under management"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsx(he,{className:"text-sm font-medium",children:"Safe Yield"})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-3xl font-bold",children:w.totalSafeYield}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"MCM/year total"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsx(he,{className:"text-sm font-medium",children:"Current Abstraction"})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-3xl font-bold",children:w.totalCurrent}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[k,"% of safe yield"]})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(an,{className:"h-4 w-4 text-red-600"})," At Risk"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-3xl font-bold text-red-600",children:w.atRisk}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"High/Critical stress"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx(he,{children:"Aquifer Status Overview"}),t.jsxs("span",{className:"text-sm text-muted-foreground",children:[v.length," aquifers total"]})]})}),t.jsxs(Q,{children:[t.jsx($y,{className:"h-[600px] pr-4",children:t.jsx("div",{className:"space-y-6",children:p?t.jsx("p",{children:"Loading aquifers..."}):v.slice((l-1)*a,l*a).map(S=>{var D;const R=S.safeYieldMcm>0?S.currentYieldMcm/S.safeYieldMcm*100:0;return t.jsxs("div",{className:"p-4 border rounded-lg",children:[t.jsxs("div",{className:"flex justify-between items-start mb-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold text-lg",children:S.name}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[S.areaKm2," km"]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Ee,{className:j(S.riskLevel),children:(D=S.riskLevel)==null?void 0:D.toUpperCase()}),t.jsx(Ee,{variant:"outline",children:S.waterQualityStatus})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"Safe Yield"}),t.jsxs("p",{className:"font-semibold",children:[S.safeYieldMcm," MCM/yr"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"Current"}),t.jsxs("p",{className:"font-semibold",children:[S.currentYieldMcm," MCM/yr"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"Recharge"}),t.jsxs("p",{className:"font-semibold",children:[S.rechargeRateMcm," MCM/yr"]})]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-xs mb-2",children:[t.jsx("span",{children:"Utilization Rate"}),t.jsxs("span",{className:"font-semibold",children:[Math.round(R),"%"]})]}),t.jsx(du,{value:Math.min(R,100)}),R>80&&t.jsx("p",{className:"text-xs text-red-600 mt-2",children:" Exceeding safe yield threshold"})]})]},S.id)})})}),v.length>a&&t.jsxs("div",{className:"flex justify-between items-center mt-6 pt-4 border-t",children:[t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Page ",l," of ",Math.ceil(v.length/a)]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{variant:"outline",size:"sm",onClick:()=>d(Math.max(1,l-1)),disabled:l===1,children:t.jsx(rI,{className:"h-4 w-4"})}),t.jsx(X,{variant:"outline",size:"sm",onClick:()=>d(Math.min(Math.ceil(v.length/a),l+1)),disabled:l>=Math.ceil(v.length/a),children:t.jsx(Oy,{className:"h-4 w-4"})})]})]})]})]})]})}function Qze(){var R;const e=Sr(),[r,n]=O.useState(!1),[s,i]=O.useState({name:"",severity:"high"}),[l,d]=O.useState(1),a=4,{data:f,isLoading:p}=ct({queryKey:["drought-events",l],queryFn:()=>xe.get("/core-ops/droughts")}),y=Nt({mutationFn:D=>xe.post("/core-ops/droughts",D),onSuccess:()=>{Ge.success("Drought event declared"),e.invalidateQueries({queryKey:["drought-events"]}),n(!1)}}),v=Nt({mutationFn:D=>xe.post(`/core-ops/droughts/${D}/activate`,{}),onSuccess:()=>{Ge.success("Emergency response activated"),e.invalidateQueries({queryKey:["drought-events"]})}}),j=(f==null?void 0:f.data)||[],w=j.find(D=>D.status==="active"),k=D=>D==="critical"?"bg-red-100 text-red-800 border-red-300":D==="high"?"bg-orange-100 text-orange-800 border-orange-300":"bg-yellow-100 text-yellow-800 border-yellow-300",S={declared:j.filter(D=>D.status==="declared").length,active:j.filter(D=>D.status==="active").length,resolved:j.filter(D=>D.status==="resolved").length,totalPopulation:j.reduce((D,T)=>D+(T.affectedPopulation||0),0)};return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Drought Response Center"}),t.jsx("p",{className:"text-muted-foreground",children:"Rapidly mobilize emergency boreholes and water sources during drought. Coordinate strategic borehole activation, track affected populations, and manage water rationing."})]}),t.jsxs(Or,{open:r,onOpenChange:n,children:[t.jsx(pn,{asChild:!0,children:t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"Declare Drought"]})}),t.jsxs(kr,{children:[t.jsx(Tr,{children:t.jsx(Er,{children:"Declare Drought Event"})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Event Name"}),t.jsx(Ve,{placeholder:"e.g., 2025 ASAL Drought - Jan-Mar",value:s.name,onChange:D=>i({...s,name:D.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Severity Level"}),t.jsxs("select",{className:"w-full rounded border p-2",value:s.severity,onChange:D=>i({...s,severity:D.target.value}),children:[t.jsx("option",{value:"low",children:"Low"}),t.jsx("option",{value:"high",children:"High"}),t.jsx("option",{value:"critical",children:"Critical"})]})]}),t.jsx(X,{onClick:()=>y.mutate({name:s.name,severity:s.severity}),disabled:y.isPending,className:"w-full",children:"Declare Drought"})]})]})]})]}),w&&t.jsxs(fa,{className:`border-2 ${k(w.severity)}`,children:[t.jsx(an,{className:"h-4 w-4"}),t.jsxs(ta,{children:[t.jsx("strong",{children:"Active Drought Event:"})," ",w.name," (",w.severity.toUpperCase(),") - ",(R=w.affectedPopulation)==null?void 0:R.toLocaleString()," people affected."," ",t.jsx("strong",{children:w.activatedBoreholes})," emergency boreholes activated."]})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsx(he,{className:"text-sm font-medium",children:"Drought Events Declared"})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-3xl font-bold",children:S.declared}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"On record"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(Si,{className:"h-4 w-4 text-red-600"})," Active Events"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-3xl font-bold text-red-600",children:S.active}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Ongoing responses"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsx(he,{className:"text-sm font-medium",children:"Affected Population"})}),t.jsxs(Q,{children:[t.jsxs("div",{className:"text-3xl font-bold",children:[(S.totalPopulation/1e3).toFixed(0),"K"]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Across all events"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsx(he,{className:"text-sm font-medium",children:"Resolved Events"})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-3xl font-bold",children:S.resolved}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Completed"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx(he,{children:"Drought Events & Response Status"}),t.jsxs("span",{className:"text-sm text-muted-foreground",children:[j.length," events"]})]})}),t.jsxs(Q,{children:[t.jsx($y,{className:"h-[550px] pr-4",children:t.jsx("div",{className:"space-y-4",children:p?t.jsx("p",{children:"Loading drought events..."}):j.slice((l-1)*a,l*a).map(D=>t.jsxs("div",{className:`p-4 border-2 rounded-lg ${k(D.severity)}`,children:[t.jsxs("div",{className:"flex justify-between items-start mb-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold text-lg",children:D.name}),t.jsxs("p",{className:"text-sm",children:["Started: ",new Date(D.startDate).toLocaleDateString()]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Ee,{children:D.status.toUpperCase()}),D.waterRationing&&t.jsx(Ee,{variant:"destructive",children:"RATIONING"})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"Affected Population"}),t.jsxs("p",{className:"text-2xl font-bold",children:[(D.affectedPopulation/1e3).toFixed(0),"K"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"Emergency Boreholes"}),t.jsx("p",{className:"text-2xl font-bold",children:D.activatedBoreholes})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-muted-foreground",children:"Response Status"}),t.jsx("p",{className:"text-sm font-semibold",children:D.status==="declared"?"Preparing":"Active"})]})]}),D.status==="declared"&&t.jsxs(X,{size:"sm",onClick:()=>v.mutate(D.id),disabled:v.isPending,className:"w-full",children:[t.jsx(Si,{className:"h-4 w-4 mr-2"}),"Activate Emergency Response"]})]},D.id))})}),j.length>a&&t.jsxs("div",{className:"flex justify-between items-center mt-6 pt-4 border-t",children:[t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Page ",l," of ",Math.ceil(j.length/a)]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{variant:"outline",size:"sm",onClick:()=>d(Math.max(1,l-1)),disabled:l===1,children:t.jsx(rI,{className:"h-4 w-4"})}),t.jsx(X,{variant:"outline",size:"sm",onClick:()=>d(Math.min(Math.ceil(j.length/a),l+1)),disabled:l>=Math.ceil(j.length/a),children:t.jsx(Oy,{className:"h-4 w-4"})})]})]})]})]})]})}function Jze(){const{data:e,isLoading:r}=ct({queryKey:["gender-equity"],queryFn:()=>xe.get("/me/gender-equity")}),n=(e==null?void 0:e.data)||[],s={women:n.filter(f=>f.gender==="female").length,men:n.filter(f=>f.gender==="male").length,youth:n.filter(f=>f.gender==="youth").length,elderly:n.filter(f=>f.gender==="elderly").length},i=[{name:"Women",value:s.women},{name:"Men",value:s.men}],l=[{name:"Youth (18-35)",value:s.youth},{name:"Elderly (60+)",value:s.elderly}],d=[{category:"Women","Water Hours/Day":12,"Collection Time (min)":45},{category:"Men","Water Hours/Day":15,"Collection Time (min)":15},{category:"Youth","Water Hours/Day":14,"Collection Time (min)":25}],a=["#ef4444","#f97316","#eab308","#22c55e"];return t.jsx($y,{className:"h-screen",children:t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Gender & Equity Reporting"}),t.jsx("p",{className:"text-muted-foreground max-w-2xl",children:"Track water service access and equity outcomes across gender groups and vulnerable populations. Monitor water availability, collection burden, and satisfaction across different demographics."})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsxs(he,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(Hs,{className:"h-4 w-4"})," Women Served"]})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-3xl font-bold",children:s.women}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Households tracked"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsx(he,{className:"text-sm font-medium",children:"Men Served"})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-3xl font-bold",children:s.men}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Households tracked"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsx(he,{className:"text-sm font-medium",children:"Youth (18-35)"})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-3xl font-bold",children:s.youth}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Beneficiaries"})]})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsx(he,{className:"text-sm font-medium",children:"Elderly (60+)"})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-3xl font-bold",children:s.elderly}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Beneficiaries"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Gender Distribution"})}),t.jsx(Q,{children:t.jsx(Za,{width:"100%",height:300,children:t.jsxs(Y6,{children:[t.jsx(fd,{data:i,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,children:i.map((f,p)=>t.jsx(tb,{fill:a[p]},`cell-${p}`))}),t.jsx(Gs,{}),t.jsx(pa,{})]})})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Vulnerable Groups"})}),t.jsx(Q,{children:t.jsx(Za,{width:"100%",height:300,children:t.jsxs(Y6,{children:[t.jsx(fd,{data:l,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,children:l.map((f,p)=>t.jsx(tb,{fill:a[p+2]},`cell-${p}`))}),t.jsx(Gs,{}),t.jsx(pa,{})]})})})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Water Access & Collection Burden by Gender"})}),t.jsxs(Q,{children:[t.jsx(Za,{width:"100%",height:300,children:t.jsxs(Ny,{data:d,children:[t.jsx(Io,{strokeDasharray:"3 3"}),t.jsx(xa,{dataKey:"category"}),t.jsx(Bi,{yAxisId:"left",label:{value:"Hours/Day",angle:-90,position:"insideLeft"}}),t.jsx(Bi,{yAxisId:"right",orientation:"right",label:{value:"Minutes",angle:90,position:"insideRight"}}),t.jsx(Gs,{}),t.jsx(pa,{}),t.jsx(Ha,{yAxisId:"left",dataKey:"Water Hours/Day",fill:"#3b82f6"}),t.jsx(Ha,{yAxisId:"right",dataKey:"Collection Time (min)",fill:"#ef4444"})]})}),t.jsx("div",{className:"mt-6 p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:t.jsxs("p",{className:"text-sm text-yellow-800",children:[t.jsx("strong",{children:"Key Finding:"})," Women spend 3x longer collecting water compared to men (45 vs 15 minutes). This burden is a barrier to school attendance and economic activity."]})})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Recommendations"})}),t.jsx(Q,{children:t.jsxs("ul",{className:"space-y-3 text-sm",children:[t.jsxs("li",{className:"flex gap-3",children:[t.jsx(xs,{className:"h-4 w-4 text-green-600 flex-shrink-0 mt-0.5"}),t.jsx("span",{children:"Prioritize household connections in high-collection-burden areas to reduce women's water collection time"})]}),t.jsxs("li",{className:"flex gap-3",children:[t.jsx(Si,{className:"h-4 w-4 text-orange-600 flex-shrink-0 mt-0.5"}),t.jsx("span",{children:"Establish water points within 500m of homes to meet WHO accessibility standards"})]}),t.jsxs("li",{className:"flex gap-3",children:[t.jsx(Hs,{className:"h-4 w-4 text-blue-600 flex-shrink-0 mt-0.5"}),t.jsx("span",{children:"Ensure elderly and vulnerable populations have subsidized access and priority queuing"})]})]})})]})]})})}function e$e(){return t.jsxs("div",{className:"flex h-screen bg-background",children:[t.jsx(Ia,{}),t.jsx("main",{className:"flex-1 overflow-y-auto",children:t.jsx(Oa,{})})]})}async function t$e(e,r,n){const s=new URLSearchParams;e&&s.append("domain",e),r&&s.append("level",r),n&&s.append("search",n);const i=await fetch(`/api/v1/training/courses?${s}`,{credentials:"include"});if(!i.ok)throw new Error("Failed to fetch courses");return i.json()}async function r$e(e){const r=await fetch("/api/v1/training/enrollments",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({course_id:e})});if(!r.ok)throw new Error("Failed to enroll");return r.json()}function n$e(){const[e,r]=O.useState(""),[n,s]=O.useState("all"),[i,l]=O.useState("all"),{data:d,isLoading:a}=ct({queryKey:["courses",n,i,e],queryFn:()=>t$e(n!=="all"?n:void 0,i!=="all"?i:void 0,e),staleTime:6e4}),f=async y=>{try{await r$e(y),alert("Successfully enrolled!")}catch{alert("Enrollment failed")}},p=(d==null?void 0:d.data)||[];return t.jsxs("div",{className:"container mx-auto p-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Course Catalog"}),t.jsx("p",{className:"text-muted-foreground",children:"Browse and enroll in training courses"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[t.jsx("div",{className:"md:col-span-2",children:t.jsxs("div",{className:"relative",children:[t.jsx(di,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Search courses...",value:e,onChange:y=>r(y.target.value),className:"pl-10"})]})}),t.jsxs($t,{value:n,onValueChange:s,children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"All Domains"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All Domains"}),t.jsx(Ne,{value:"Ops",children:"Operations"}),t.jsx(Ne,{value:"Lab",children:"Laboratory"}),t.jsx(Ne,{value:"HSE",children:"Health & Safety"}),t.jsx(Ne,{value:"CRM",children:"Customer Relations"}),t.jsx(Ne,{value:"Finance",children:"Finance"})]})]}),t.jsxs($t,{value:i,onValueChange:l,children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"All Levels"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All Levels"}),t.jsx(Ne,{value:"basic",children:"Basic"}),t.jsx(Ne,{value:"intermediate",children:"Intermediate"}),t.jsx(Ne,{value:"advanced",children:"Advanced"})]})]})]}),a?t.jsx("div",{className:"text-center py-12",children:"Loading courses..."}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(y=>t.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[y.thumbnail_url&&t.jsx("img",{src:y.thumbnail_url,alt:y.title,className:"w-full h-48 object-cover rounded-t-lg"}),t.jsxs(de,{children:[t.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[t.jsx(he,{className:"text-lg line-clamp-2",children:y.title}),t.jsx(Ee,{variant:"outline",children:y.domain})]}),t.jsx(cr,{className:"line-clamp-2",children:y.description})]}),t.jsx(Q,{children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Xs,{className:"h-4 w-4"}),t.jsxs("span",{children:[y.duration_min," min"]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(F_,{className:"h-4 w-4"}),t.jsxs("span",{children:[y.credits," credits"]})]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(Ee,{variant:"secondary",className:"capitalize",children:y.level}),t.jsxs("span",{className:"text-sm text-muted-foreground",children:[y.enrollments_count," enrolled"]})]}),t.jsxs(X,{onClick:()=>f(y.id),className:"w-full",size:"sm",children:[t.jsx(vu,{className:"h-4 w-4 mr-2"}),"Enroll Now"]})]})})]},y.id))}),!a&&p.length===0&&t.jsxs(H,{className:"p-12 text-center",children:[t.jsx(vu,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),t.jsx("p",{className:"text-lg font-medium",children:"No courses found"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Try adjusting your filters or search terms"})]})]})}async function s$e(){const e=await fetch("/api/v1/training/my-enrollments",{credentials:"include"});if(!e.ok)throw new Error("Failed to fetch enrollments");return e.json()}function i$e(){const{data:e,isLoading:r}=ct({queryKey:["my-enrollments"],queryFn:s$e,staleTime:3e4});if(r)return t.jsx("div",{className:"container mx-auto p-6",children:"Loading..."});const n=(e==null?void 0:e.in_progress)||[],s=(e==null?void 0:e.enrolled)||[],i=(e==null?void 0:e.completed)||[],l=(e==null?void 0:e.overdue)||[];return t.jsxs("div",{className:"container mx-auto p-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-3xl font-bold",children:"My Learning"}),t.jsx("p",{className:"text-muted-foreground",children:"Track your training progress and certifications"})]}),l.length>0&&t.jsxs(H,{className:"mb-6 border-destructive",children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ps,{className:"h-5 w-5 text-destructive"}),t.jsx(he,{className:"text-destructive",children:"Overdue Courses"})]})}),t.jsx(Q,{children:t.jsx("div",{className:"space-y-3",children:l.map(d=>t.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:d.course.title}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Due: ",new Date(d.due_at).toLocaleDateString()]})]}),t.jsx(X,{size:"sm",variant:"destructive",children:"Continue"})]},d.id))})})]}),t.jsxs(Sn,{defaultValue:"in-progress",className:"space-y-4",children:[t.jsxs(bn,{children:[t.jsxs(kt,{value:"in-progress",children:["In Progress (",n.length,")"]}),t.jsxs(kt,{value:"enrolled",children:["Not Started (",s.length,")"]}),t.jsxs(kt,{value:"completed",children:["Completed (",i.length,")"]})]}),t.jsx(Dt,{value:"in-progress",className:"space-y-4",children:n.length===0?t.jsxs(H,{className:"p-12 text-center",children:[t.jsx(vu,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),t.jsx("p",{className:"text-lg font-medium",children:"No courses in progress"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Start a course from your enrolled list"})]}):n.map(d=>t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx(he,{children:d.course.title}),t.jsxs(cr,{children:[d.course.domain," | ",d.course.code]})]}),t.jsxs(Ee,{variant:"secondary",children:[d.progress_percent,"% Complete"]})]})}),t.jsx(Q,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[t.jsx("span",{className:"text-muted-foreground",children:"Progress"}),t.jsxs("span",{className:"font-medium",children:[d.progress_percent,"%"]})]}),t.jsx(du,{value:d.progress_percent,className:"h-2"})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Xs,{className:"h-4 w-4"}),t.jsxs("span",{children:[d.course.duration_min," min"]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(F_,{className:"h-4 w-4"}),t.jsxs("span",{children:[d.course.credits," credits"]})]})]}),t.jsxs(X,{size:"sm",children:[t.jsx(El,{className:"h-4 w-4 mr-2"}),"Continue Learning"]})]})]})})]},d.id))}),t.jsx(Dt,{value:"enrolled",className:"space-y-4",children:s.length===0?t.jsxs(H,{className:"p-12 text-center",children:[t.jsx(vu,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),t.jsx("p",{className:"text-lg font-medium",children:"No enrolled courses"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Browse the course catalog to enroll"})]}):s.map(d=>t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx(he,{children:d.course.title}),t.jsxs(cr,{children:[d.course.domain," | ",d.course.code]})]}),t.jsx(Ee,{children:"Not Started"})]})}),t.jsx(Q,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Xs,{className:"h-4 w-4"}),t.jsxs("span",{children:[d.course.duration_min," min"]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(F_,{className:"h-4 w-4"}),t.jsxs("span",{children:[d.course.credits," credits"]})]})]}),t.jsxs(X,{size:"sm",children:[t.jsx(El,{className:"h-4 w-4 mr-2"}),"Start Course"]})]})})]},d.id))}),t.jsx(Dt,{value:"completed",className:"space-y-4",children:i.length===0?t.jsxs(H,{className:"p-12 text-center",children:[t.jsx(bu,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),t.jsx("p",{className:"text-lg font-medium",children:"No completed courses"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Complete your enrolled courses to earn certificates"})]}):i.map(d=>t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx(he,{children:d.course.title}),t.jsxs(cr,{children:[d.course.domain," | ",d.course.code]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(Ee,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[t.jsx(bu,{className:"h-3 w-3 mr-1"}),"Completed"]}),d.final_score&&t.jsxs(Ee,{variant:"secondary",children:["Score: ",d.final_score,"%"]})]})]})}),t.jsx(Q,{children:t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("span",{className:"text-muted-foreground",children:["Completed on ",new Date(d.completed_at).toLocaleDateString()]}),t.jsx(X,{size:"sm",variant:"outline",children:"View Certificate"})]})})]},d.id))})]})]})}async function a$e(e,r){const n=new URLSearchParams;e&&n.append("category",e),r&&n.append("search",r);const s=await fetch(`/api/v1/training/kb?${n}`,{credentials:"include"});if(!s.ok)throw new Error("Failed to fetch articles");return s.json()}async function o$e(){const e=await fetch("/api/v1/training/kb/popular",{credentials:"include"});if(!e.ok)throw new Error("Failed to fetch popular articles");return e.json()}function l$e(){const[e,r]=O.useState(""),[n,s]=O.useState(""),{data:i,isLoading:l}=ct({queryKey:["kb-articles",n,e],queryFn:()=>a$e(n,e),staleTime:6e4}),{data:d}=ct({queryKey:["kb-popular"],queryFn:o$e,staleTime:3e5}),a=(i==null?void 0:i.data)||[],f=d||[],p=[{value:"",label:"All Categories"},{value:"Assets",label:"Assets"},{value:"Treatment",label:"Treatment"},{value:"Safety",label:"Safety"},{value:"Customer",label:"Customer"},{value:"Finance",label:"Finance"},{value:"IT",label:"IT"}];return t.jsxs("div",{className:"container mx-auto p-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Knowledge Base"}),t.jsx("p",{className:"text-muted-foreground",children:"Browse articles, guides, and documentation"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[t.jsx("div",{className:"flex gap-4",children:t.jsxs("div",{className:"flex-1 relative",children:[t.jsx(di,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Search knowledge base...",value:e,onChange:y=>r(y.target.value),className:"pl-10"})]})}),t.jsx(Sn,{value:n,onValueChange:s,children:t.jsx(bn,{className:"w-full justify-start overflow-x-auto",children:p.map(y=>t.jsx(kt,{value:y.value,children:y.label},y.value))})}),l?t.jsx("div",{className:"text-center py-12",children:"Loading articles..."}):a.length===0?t.jsxs(H,{className:"p-12 text-center",children:[t.jsx($n,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),t.jsx("p",{className:"text-lg font-medium",children:"No articles found"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Try adjusting your search or category filter"})]}):t.jsx("div",{className:"space-y-4",children:a.map(y=>t.jsxs(H,{className:"hover:shadow-lg transition-shadow cursor-pointer",children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx(he,{className:"text-lg mb-2",children:y.title}),t.jsxs(cr,{children:["By ",y.author.name," "," ",new Date(y.published_at).toLocaleDateString()]})]}),t.jsx(Ee,{variant:"outline",children:y.category})]})}),t.jsx(Q,{children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("p",{className:"text-sm text-muted-foreground line-clamp-2",children:[y.content.substring(0,200),"..."]}),t.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(ud,{className:"h-4 w-4"}),t.jsxs("span",{children:[y.views_count," views"]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(AV,{className:"h-4 w-4"}),t.jsx("span",{children:y.helpful_count})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Lne,{className:"h-4 w-4"}),t.jsx("span",{children:y.not_helpful_count})]})]}),y.tags&&y.tags.length>0&&t.jsx("div",{className:"flex flex-wrap gap-2",children:y.tags.map(v=>t.jsx(Ee,{variant:"secondary",className:"text-xs",children:v},v))})]})})]},y.id))})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(xs,{className:"h-5 w-5"}),"Popular Articles"]})}),t.jsx(Q,{children:t.jsx("div",{className:"space-y-3",children:f.slice(0,5).map(y=>t.jsxs("div",{className:"pb-3 border-b last:border-0 last:pb-0 cursor-pointer hover:bg-muted/50 p-2 rounded-md transition-colors",children:[t.jsx("p",{className:"font-medium text-sm line-clamp-2 mb-1",children:y.title}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[t.jsx(ud,{className:"h-3 w-3"}),t.jsxs("span",{children:[y.views_count," views"]})]})]},y.id))})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Need Help?"})}),t.jsxs(Q,{children:[t.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Can't find what you're looking for?"}),t.jsx(X,{className:"w-full",variant:"outline",children:"Submit a Question"})]})]})]})]})]})}async function c$e(e){const r=new URLSearchParams({status:"published"});e&&r.append("search",e);const n=await fetch(`/api/v1/training/sops?${r}`,{credentials:"include"});if(!n.ok)throw new Error("Failed to fetch SOPs");return n.json()}async function d$e(e){const r=await fetch(`/api/v1/training/sops/${e}/attest`,{method:"POST",credentials:"include"});if(!r.ok)throw new Error("Failed to attest SOP");return r.json()}function u$e(){const[e,r]=O.useState(""),n=Sr(),{data:s,isLoading:i}=ct({queryKey:["sops",e],queryFn:()=>c$e(e),staleTime:6e4}),l=Nt({mutationFn:d$e,onSuccess:()=>{n.invalidateQueries({queryKey:["sops"]})}}),d=(s==null?void 0:s.data)||[],a=(f,p)=>{var y;return((y=f.attestations)==null?void 0:y.some(v=>v.user_id===p))||!1};return t.jsxs("div",{className:"container mx-auto p-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Standard Operating Procedures"}),t.jsx("p",{className:"text-muted-foreground",children:"Access and attest to organizational SOPs"})]}),t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"relative max-w-md",children:[t.jsx(di,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),t.jsx(Ve,{placeholder:"Search SOPs...",value:e,onChange:f=>r(f.target.value),className:"pl-10"})]})}),i?t.jsx("div",{className:"text-center py-12",children:"Loading SOPs..."}):d.length===0?t.jsxs(H,{className:"p-12 text-center",children:[t.jsx($n,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),t.jsx("p",{className:"text-lg font-medium",children:"No SOPs found"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Try adjusting your search terms"})]}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(f=>{const p=f.next_review_due&&new Date(f.next_review_due)<new Date;return t.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[t.jsxs(de,{children:[t.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[t.jsxs("div",{children:[t.jsx(he,{className:"text-lg",children:f.title}),t.jsx(cr,{className:"mt-1",children:f.code})]}),t.jsxs(Ee,{variant:"outline",children:["v",f.version]})]}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsx(Ee,{variant:"secondary",children:f.category}),p&&t.jsxs(Ee,{variant:"destructive",children:[t.jsx(ps,{className:"h-3 w-3 mr-1"}),"Review Due"]})]})]}),t.jsx(Q,{children:t.jsxs("div",{className:"space-y-3",children:[f.published_at&&t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Published: ",new Date(f.published_at).toLocaleDateString()]}),f.next_review_due&&t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Next Review: ",new Date(f.next_review_due).toLocaleDateString()]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(X,{size:"sm",variant:"outline",className:"flex-1",children:[t.jsx(ud,{className:"h-4 w-4 mr-2"}),"View SOP"]}),!a(f,1)&&t.jsxs(X,{size:"sm",onClick:()=>l.mutate(f.id),disabled:l.isPending,children:[t.jsx(Fs,{className:"h-4 w-4 mr-2"}),"Attest"]}),a(f,1)&&t.jsxs(Ee,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[t.jsx(Fs,{className:"h-3 w-3 mr-1"}),"Attested"]})]})]})})]},f.id)})})]})}async function h$e(){const e=await fetch("/api/v1/training/skills/matrix",{credentials:"include"});if(!e.ok)throw new Error("Failed to fetch skills matrix");return e.json()}async function m$e(e){const r=new URLSearchParams,n=await fetch(`/api/v1/training/employee-skills?${r}`,{credentials:"include"});if(!n.ok)throw new Error("Failed to fetch employee skills");return n.json()}function f$e(){const[e,r]=O.useState("matrix"),[n,s]=O.useState("all"),{data:i,isLoading:l}=ct({queryKey:["skills-matrix"],queryFn:h$e,enabled:e==="matrix",staleTime:6e4}),{data:d,isLoading:a}=ct({queryKey:["employee-skills"],queryFn:()=>m$e(),enabled:e==="individual",staleTime:6e4}),f=p=>{const y=["bg-red-100 text-red-800","bg-yellow-100 text-yellow-800","bg-blue-100 text-blue-800","bg-green-100 text-green-800"];return y[p]||y[0]};return t.jsxs("div",{className:"container mx-auto p-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Skills Matrix"}),t.jsx("p",{className:"text-muted-foreground",children:"Track and assess employee competencies"})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(X,{variant:e==="matrix"?"default":"outline",onClick:()=>r("matrix"),children:[t.jsx(Hs,{className:"h-4 w-4 mr-2"}),"Team Matrix"]}),t.jsxs(X,{variant:e==="individual"?"default":"outline",onClick:()=>r("individual"),children:[t.jsx(hg,{className:"h-4 w-4 mr-2"}),"My Skills"]})]}),t.jsxs($t,{value:n,onValueChange:s,children:[t.jsx(Rt,{className:"w-48",children:t.jsx(Bt,{placeholder:"Filter by category"})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All Categories"}),t.jsx(Ne,{value:"technical",children:"Technical"}),t.jsx(Ne,{value:"safety",children:"Safety"}),t.jsx(Ne,{value:"customer",children:"Customer Service"}),t.jsx(Ne,{value:"leadership",children:"Leadership"})]})]})]}),e==="matrix"&&t.jsx(t.Fragment,{children:l?t.jsx("div",{className:"text-center py-12",children:"Loading matrix..."}):t.jsx("div",{className:"space-y-6",children:i==null?void 0:i.map(p=>{const y=p.skill,v=p.employees;return n!=="all"&&y.category!==n?null:t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx(he,{children:y.name}),t.jsx(cr,{children:y.code})]}),t.jsx(Ee,{variant:"outline",children:y.category})]})}),t.jsx(Q,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex gap-2",children:y.levels.map((j,w)=>t.jsx(Ee,{className:f(w),children:j},w))}),v.length>0?t.jsx("div",{className:"space-y-2",children:v.map((j,w)=>t.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-md",children:[t.jsx("span",{className:"font-medium",children:j.user.name}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ee,{className:f(j.level_index),children:j.level_name}),t.jsxs("span",{className:"text-sm text-muted-foreground",children:["Assessed: ",new Date(j.assessed_at).toLocaleDateString()]})]})]},w))}):t.jsx("p",{className:"text-sm text-muted-foreground",children:"No employees assessed for this skill"})]})})]},y.id)})})}),e==="individual"&&t.jsx(t.Fragment,{children:a?t.jsx("div",{className:"text-center py-12",children:"Loading your skills..."}):d&&d.length>0?t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(p=>t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{className:"text-lg",children:p.skill.name}),t.jsx(cr,{children:p.skill.category})]}),t.jsx(Q,{children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Current Level"}),t.jsx(Ee,{className:f(p.level_index),children:p.skill.levels[p.level_index]})]}),t.jsxs("div",{children:[t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Assessed: ",new Date(p.assessed_at).toLocaleDateString()]}),p.assessor&&t.jsxs("p",{className:"text-sm text-muted-foreground",children:["By: ",p.assessor.name]})]})]})})]},p.id))}):t.jsxs(H,{className:"p-12 text-center",children:[t.jsx(hg,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),t.jsx("p",{className:"text-lg font-medium",children:"No skills assessed"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Contact your supervisor to get your skills assessed"})]})})]})}function p$e(){return t.jsxs("div",{className:"container mx-auto p-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-3xl font-bold",children:"My Certificates"}),t.jsx("p",{className:"text-muted-foreground",children:"View and download your training certificates"})]}),t.jsxs(H,{className:"p-12 text-center",children:[t.jsx(F_,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground"}),t.jsx("p",{className:"text-lg font-medium mb-2",children:"Certificates Coming Soon"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Complete courses to earn certificates that will appear here"})]})]})}function x$e(){return t.jsxs("div",{className:"flex min-h-screen",children:[t.jsx(Ia,{}),t.jsx("main",{className:"flex-1 p-8 overflow-auto",children:t.jsx(Oa,{})})]})}function g$e(){var W,Z,oe;const[e,r]=O.useState({entity_type:"scheme",entity_id:"",metric:"production",horizon_days:30,model_family:"auto",seasonality:!0,holdout_pct:20,exogenous_drivers:[]}),[n,s]=O.useState(""),[i,l]=O.useState(null),{data:d,isLoading:a,error:f}=ct({queryKey:["schemes"],queryFn:async()=>(await xe.get("/api/v1/schemes")).data.data}),{data:p,isLoading:y,error:v,refetch:j}=ct({queryKey:["forecast-jobs"],queryFn:async()=>(await xe.get("/api/v1/dsa/forecast")).data.data}),{data:w,isLoading:k,error:S}=ct({queryKey:["forecast-job",i],queryFn:async()=>i?(await xe.get(`/api/v1/dsa/forecast/${i}`)).data:null,enabled:!!i}),R=Nt({mutationFn:async te=>(await xe.post("/api/v1/dsa/forecast",te)).data,onSuccess:te=>{Ge.success("Forecast job started successfully"),l(te.id),j()},onError:()=>{Ge.error("Failed to start forecast job")}}),D=()=>{n.trim()&&!e.exogenous_drivers.includes(n.trim())&&(r({...e,exogenous_drivers:[...e.exogenous_drivers,n.trim()]}),s(""))},T=te=>{r({...e,exogenous_drivers:e.exogenous_drivers.filter(be=>be!==te)})},I=()=>{R.mutate(e)},L=()=>{if(!w)return;const te=[["Date","Type","Value","Lower_80","Upper_80","Lower_95","Upper_95"],...w.historical.map(Ie=>[Ie.date,"Historical",Ie.actual,"","","",""]),...w.forecast.map(Ie=>[Ie.date,"Forecast",Ie.predicted,Ie.lower_80,Ie.upper_80,Ie.lower_95,Ie.upper_95])].map(Ie=>Ie.join(",")).join(`
`),be=new Blob([te],{type:"text/csv"}),ie=URL.createObjectURL(be),ge=document.createElement("a");ge.href=ie,ge.download=`forecast_${i}.csv`,ge.click(),Ge.success("Forecast exported to CSV")},$=p==null?void 0:p.find(te=>te.id===i);return t.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Forecast Studio"}),t.jsx("p",{className:"text-muted-foreground",children:"Time-series forecasting with ML models and confidence intervals"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs(H,{className:"lg:col-span-1",children:[t.jsxs(de,{children:[t.jsx(he,{children:"Forecast Configuration"}),t.jsx(cr,{children:"Define parameters for time-series forecasting"})]}),t.jsxs(Q,{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Me,{children:"Entity Type"}),t.jsxs($t,{value:e.entity_type,onValueChange:te=>r({...e,entity_type:te}),children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"scheme",children:"Scheme"}),t.jsx(Ne,{value:"dma",children:"DMA"}),t.jsx(Ne,{value:"meter_class",children:"Meter Class"}),t.jsx(Ne,{value:"customer_segment",children:"Customer Segment"})]})]})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Entity Selection"}),t.jsxs($t,{value:e.entity_id,onValueChange:te=>r({...e,entity_id:te}),children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select entity..."})}),t.jsx(Lt,{children:d==null?void 0:d.map(te=>t.jsx(Ne,{value:te.id,children:te.name},te.id))})]})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Metric"}),t.jsxs($t,{value:e.metric,onValueChange:te=>r({...e,metric:te}),children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"production",children:"Production Volume"}),t.jsx(Ne,{value:"demand",children:"Demand"}),t.jsx(Ne,{value:"revenue",children:"Revenue"}),t.jsx(Ne,{value:"chemicals",children:"Chemicals Usage"}),t.jsx(Ne,{value:"energy_cost",children:"Energy Cost"})]})]})]}),t.jsxs("div",{children:[t.jsxs(Me,{children:["Forecast Horizon (days): ",e.horizon_days]}),t.jsx(sp,{value:[e.horizon_days],onValueChange:([te])=>r({...e,horizon_days:te}),min:7,max:365,step:1})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Model Family"}),t.jsxs($t,{value:e.model_family,onValueChange:te=>r({...e,model_family:te}),children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"auto",children:"Auto (Best Model)"}),t.jsx(Ne,{value:"arima",children:"ARIMA"}),t.jsx(Ne,{value:"ets",children:"ETS (Exponential Smoothing)"}),t.jsx(Ne,{value:"prophet",children:"Prophet"}),t.jsx(Ne,{value:"lstm",children:"LSTM Neural Network"})]})]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(Me,{children:"Seasonality Detection"}),t.jsx(pp,{checked:e.seasonality,onCheckedChange:te=>r({...e,seasonality:te})})]}),t.jsxs("div",{children:[t.jsxs(Me,{children:["Holdout Set (%): ",e.holdout_pct,"%"]}),t.jsx(sp,{value:[e.holdout_pct],onValueChange:([te])=>r({...e,holdout_pct:te}),min:10,max:30,step:5})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Exogenous Drivers"}),t.jsxs("div",{className:"flex gap-2 mb-2",children:[t.jsx(Ve,{placeholder:"e.g., rainfall, temperature, holidays",value:n,onChange:te=>s(te.target.value),onKeyPress:te=>te.key==="Enter"&&D()}),t.jsx(X,{size:"sm",onClick:D,children:"Add"})]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:e.exogenous_drivers.map(te=>t.jsxs(Ee,{variant:"secondary",className:"flex items-center gap-1",children:[te,t.jsx(bm,{className:"h-3 w-3 cursor-pointer",onClick:()=>T(te)})]},te))})]}),t.jsxs(X,{className:"w-full",onClick:I,disabled:!e.entity_id||R.isPending,children:[t.jsx(El,{className:"h-4 w-4 mr-2"}),R.isPending?"Starting...":"Run Forecast"]})]})]}),t.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Recent Forecast Jobs"})}),t.jsx(Q,{children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Metric"}),t.jsx(ce,{children:"Model"}),t.jsx(ce,{children:"Horizon"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"MAPE"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:p==null?void 0:p.slice(0,10).map(te=>{var be,ie;return t.jsxs(ut,{className:i===te.id?"bg-muted":"",children:[t.jsx(se,{className:"font-medium",children:te.metric}),t.jsx(se,{children:te.model_family.toUpperCase()}),t.jsxs(se,{children:[te.horizon_days,"d"]}),t.jsx(se,{children:t.jsx(Ee,{variant:te.status==="completed"?"default":te.status==="failed"?"destructive":"secondary",children:te.status})}),t.jsxs(se,{children:[(ie=(be=te.scores)==null?void 0:be.mape)==null?void 0:ie.toFixed(2),"%"]}),t.jsx(se,{children:t.jsx(X,{size:"sm",variant:"ghost",onClick:()=>l(te.id),disabled:te.status!=="completed",children:"View"})})]},te.id)})})]})})]}),i&&k&&t.jsx(H,{children:t.jsxs(Q,{className:"py-12 text-center",children:[t.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),t.jsx("p",{className:"text-muted-foreground",children:"Loading forecast results..."})]})}),i&&S&&t.jsx(H,{children:t.jsx(Q,{className:"py-12 text-center text-destructive",children:t.jsxs("p",{children:["Error loading forecast: ",S.message]})})}),$&&w&&w.historical&&w.forecast&&t.jsxs(t.Fragment,{children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx(he,{children:"Forecast Results"}),t.jsxs(cr,{children:[$.metric," forecast for ",$.horizon_days," days"]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(X,{size:"sm",variant:"outline",onClick:L,children:[t.jsx(Ta,{className:"h-4 w-4 mr-2"}),"Export CSV"]}),t.jsxs(X,{size:"sm",variant:"outline",children:[t.jsx(iI,{className:"h-4 w-4 mr-2"}),"Save Baseline"]})]})]})}),t.jsx(Q,{children:t.jsxs(Sn,{defaultValue:"chart",children:[t.jsxs(bn,{children:[t.jsx(kt,{value:"chart",children:"Forecast Chart"}),t.jsx(kt,{value:"errors",children:"Error Metrics"}),t.jsx(kt,{value:"model",children:"Model Card"})]}),t.jsx(Dt,{value:"chart",className:"h-[400px]",children:t.jsx(Za,{width:"100%",height:"100%",children:t.jsxs(lZ,{data:[...w.historical,...w.forecast],children:[t.jsx(Io,{strokeDasharray:"3 3"}),t.jsx(xa,{dataKey:"date"}),t.jsx(Bi,{}),t.jsx(Gs,{}),t.jsx(pa,{}),t.jsx(pd,{type:"monotone",dataKey:"upper_95",stackId:"1",stroke:"transparent",fill:"#e0e7ff",fillOpacity:.3}),t.jsx(pd,{type:"monotone",dataKey:"upper_80",stackId:"2",stroke:"transparent",fill:"#c7d2fe",fillOpacity:.4}),t.jsx(al,{type:"monotone",dataKey:"actual",stroke:"#3b82f6",strokeWidth:2,dot:!1}),t.jsx(al,{type:"monotone",dataKey:"predicted",stroke:"#10b981",strokeWidth:2,strokeDasharray:"5 5",dot:!1})]})})}),t.jsx(Dt,{value:"errors",children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Metric"}),t.jsx(ce,{children:"Value"}),t.jsx(ce,{children:"Interpretation"})]})}),t.jsxs(mr,{children:[t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:"MAE (Mean Absolute Error)"}),t.jsx(se,{children:(W=$.scores)==null?void 0:W.mae.toFixed(2)}),t.jsx(se,{className:"text-sm text-muted-foreground",children:"Average absolute deviation"})]}),t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:"RMSE (Root Mean Squared Error)"}),t.jsx(se,{children:(Z=$.scores)==null?void 0:Z.rmse.toFixed(2)}),t.jsx(se,{className:"text-sm text-muted-foreground",children:"Penalizes larger errors"})]}),t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:"MAPE (Mean Absolute % Error)"}),t.jsxs(se,{children:[(oe=$.scores)==null?void 0:oe.mape.toFixed(2),"%"]}),t.jsx(se,{children:t.jsx(Ee,{variant:$.scores.mape<10?"default":$.scores.mape<20?"secondary":"destructive",children:$.scores.mape<10?"Excellent":$.scores.mape<20?"Good":"Needs Improvement"})})]})]})]})}),t.jsxs(Dt,{value:"model",className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold mb-2",children:"Model Information"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-muted-foreground",children:"Model Name"}),t.jsx("p",{className:"font-medium",children:w.model_card.name})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-muted-foreground",children:"Version"}),t.jsx("p",{className:"font-medium",children:w.model_card.version})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-muted-foreground",children:"Training Window"}),t.jsx("p",{className:"font-medium",children:w.model_card.training_window})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-muted-foreground",children:"Features Used"}),t.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:w.model_card.features_used.map(te=>t.jsx(Ee,{variant:"outline",className:"text-xs",children:te},te))})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold mb-2",children:"Hyperparameters"}),t.jsx("div",{className:"bg-muted p-3 rounded-md",children:t.jsx("pre",{className:"text-xs overflow-auto",children:JSON.stringify(w.model_card.hyperparameters,null,2)})})]})]})]})})]}),$.scores&&$.scores.mape>20&&t.jsxs(fa,{children:[t.jsx(ps,{className:"h-4 w-4"}),t.jsxs(ta,{children:[t.jsx("strong",{children:"Model Accuracy Alert:"})," MAPE is ",$.scores.mape.toFixed(1),"%. Consider adding more exogenous drivers or trying a different model family."]})]})]})]})]})]})}function y$e(){const[e,r]=O.useState({name:"",type:"drought",scheme_id:"",period_start:new Date,period_end:new Date(Date.now()+2592e6),severity:50,monte_carlo_runs:100,params:{}}),[n,s]=O.useState([]),[i,l]=O.useState(null),{data:d,isLoading:a,error:f}=ct({queryKey:["schemes"],queryFn:async()=>(await xe.get("/api/v1/schemes")).data.data}),{data:p,isLoading:y,error:v,refetch:j}=ct({queryKey:["scenarios"],queryFn:async()=>(await xe.get("/api/v1/dsa/scenarios")).data.data}),w=Nt({mutationFn:async $=>(await xe.post(`/api/v1/dsa/scenarios/${$}/run`)).data,onSuccess:()=>{Ge.success("Scenario simulation started"),j()},onError:()=>{Ge.error("Failed to run scenario")}}),k=Nt({mutationFn:async $=>(await xe.post("/api/v1/dsa/scenarios",{...$,playbook:n})).data,onSuccess:()=>{Ge.success("Scenario created successfully"),j(),r({name:"",type:"drought",scheme_id:"",period_start:new Date,period_end:new Date(Date.now()+30*24*60*60*1e3),severity:50,monte_carlo_runs:100,params:{}}),s([])},onError:()=>{Ge.error("Failed to create scenario")}}),S=()=>{s([...n,{action:"",owner:"",trigger:"",lead_time:24,impact:""}])},R=$=>{s(n.filter((W,Z)=>Z!==$))},D=($,W,Z)=>{const oe=[...n];oe[$]={...oe[$],[W]:Z},s(oe)},T=p==null?void 0:p.find($=>$.id===i),I=T!=null&&T.results?[{metric:"Deficit",baseline:0,scenario:T.results.deficit_m3d},{metric:"Continuity",baseline:24,scenario:T.results.continuity_hrs},{metric:"Cost Impact",baseline:100,scenario:100+T.results.cost_impact},{metric:"Service Level",baseline:100,scenario:100-T.results.service_deficit_pct}]:[],L=[{kpi:"Supply",value:85,fullMark:100},{kpi:"Pressure",value:70,fullMark:100},{kpi:"Quality",value:90,fullMark:100},{kpi:"Cost",value:60,fullMark:100},{kpi:"Reliability",value:75,fullMark:100}];return t.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Scenario Workbench"}),t.jsx("p",{className:"text-muted-foreground",children:"Design and simulate stress tests for resilience planning"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs(H,{className:"lg:col-span-1",children:[t.jsxs(de,{children:[t.jsx(he,{children:"Scenario Builder"}),t.jsx(cr,{children:"Define parameters for stress testing"})]}),t.jsxs(Q,{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Me,{children:"Scenario Name"}),t.jsx(Ve,{value:e.name,onChange:$=>r({...e,name:$.target.value}),placeholder:"e.g., Severe Drought 2025"})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Type"}),t.jsxs($t,{value:e.type,onValueChange:$=>r({...e,type:$}),children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"drought",children:"Drought"}),t.jsx(Ne,{value:"demand_spike",children:"Demand Spike"}),t.jsx(Ne,{value:"contamination",children:"Contamination"}),t.jsx(Ne,{value:"power_shock",children:"Power Price Shock"}),t.jsx(Ne,{value:"asset_failure",children:"Asset Failure"}),t.jsx(Ne,{value:"custom",children:"Custom"})]})]})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Scheme"}),t.jsxs($t,{value:e.scheme_id,onValueChange:$=>r({...e,scheme_id:$}),children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select scheme..."})}),t.jsx(Lt,{children:d==null?void 0:d.map($=>t.jsx(Ne,{value:$.id,children:$.name},$.id))})]})]}),t.jsxs("div",{children:[t.jsxs(Me,{children:["Severity: ",e.severity,"%"]}),t.jsx(sp,{value:[e.severity],onValueChange:([$])=>r({...e,severity:$}),min:0,max:100,step:5})]}),t.jsxs("div",{children:[t.jsxs(Me,{children:["Monte Carlo Runs: ",e.monte_carlo_runs]}),t.jsx(sp,{value:[e.monte_carlo_runs],onValueChange:([$])=>r({...e,monte_carlo_runs:$}),min:10,max:1e3,step:10})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Playbook Steps"}),t.jsxs("div",{className:"space-y-2 mt-2",children:[n.map(($,W)=>t.jsxs("div",{className:"p-3 border rounded-md space-y-2",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-sm font-medium",children:["Step ",W+1]}),t.jsx(X,{size:"sm",variant:"ghost",onClick:()=>R(W),children:t.jsx(As,{className:"h-4 w-4"})})]}),t.jsx(Ve,{placeholder:"Action",value:$.action,onChange:Z=>D(W,"action",Z.target.value)}),t.jsx(Ve,{placeholder:"Owner",value:$.owner,onChange:Z=>D(W,"owner",Z.target.value)})]},W)),t.jsx(X,{size:"sm",variant:"outline",onClick:S,className:"w-full",children:"Add Playbook Step"})]})]}),t.jsx(X,{className:"w-full",onClick:()=>k.mutate(e),disabled:!e.name||!e.scheme_id||k.isPending,children:"Create Scenario"})]})]}),t.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Scenario Library"})}),t.jsx(Q,{children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Name"}),t.jsx(ce,{children:"Type"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Deficit (m/d)"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:p==null?void 0:p.map($=>{var W,Z;return t.jsxs(ut,{className:i===$.id?"bg-muted":"",onClick:()=>l($.id),children:[t.jsx(se,{className:"font-medium",children:$.name}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:$.type})}),t.jsx(se,{children:t.jsx(Ee,{variant:$.status==="completed"?"default":$.status==="running"?"secondary":"outline",children:$.status})}),t.jsx(se,{children:((Z=(W=$.results)==null?void 0:W.deficit_m3d)==null?void 0:Z.toFixed(1))||"-"}),t.jsx(se,{children:t.jsx(X,{size:"sm",variant:"ghost",onClick:oe=>{oe.stopPropagation(),w.mutate($.id)},disabled:$.status==="running",children:t.jsx(El,{className:"h-4 w-4"})})})]},$.id)})})]})})]}),T&&T.status==="completed"&&t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{children:["Scenario Results: ",T.name]})}),t.jsx(Q,{children:t.jsxs(Sn,{defaultValue:"kpis",children:[t.jsxs(bn,{children:[t.jsx(kt,{value:"kpis",children:"KPIs"}),t.jsx(kt,{value:"comparison",children:"Comparison"}),t.jsx(kt,{value:"radar",children:"Multi-KPI Radar"})]}),t.jsx(Dt,{value:"kpis",className:"space-y-4",children:t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"p-4 border rounded-md",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Supply Deficit"}),t.jsxs("p",{className:"text-2xl font-bold",children:[T.results.deficit_m3d.toFixed(0)," m/d"]})]}),t.jsxs("div",{className:"p-4 border rounded-md",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Continuity"}),t.jsxs("p",{className:"text-2xl font-bold",children:[T.results.continuity_hrs.toFixed(1)," hrs/day"]})]}),t.jsxs("div",{className:"p-4 border rounded-md",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Cost Impact"}),t.jsxs("p",{className:"text-2xl font-bold",children:[T.results.cost_impact>0?"+":"",T.results.cost_impact.toFixed(0),"%"]})]}),t.jsxs("div",{className:"p-4 border rounded-md",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Service Deficit"}),t.jsxs("p",{className:"text-2xl font-bold",children:[T.results.service_deficit_pct.toFixed(1),"%"]})]})]})}),t.jsx(Dt,{value:"comparison",className:"h-[300px]",children:t.jsx(Za,{width:"100%",height:"100%",children:t.jsxs(Ny,{data:I,children:[t.jsx(Io,{strokeDasharray:"3 3"}),t.jsx(xa,{dataKey:"metric"}),t.jsx(Bi,{}),t.jsx(Gs,{}),t.jsx(pa,{}),t.jsx(Ha,{dataKey:"baseline",fill:"#10b981",name:"Baseline"}),t.jsx(Ha,{dataKey:"scenario",fill:"#ef4444",name:"Scenario"})]})})}),t.jsx(Dt,{value:"radar",className:"h-[300px]",children:t.jsx(Za,{width:"100%",height:"100%",children:t.jsxs(fLe,{data:L,children:[t.jsx(nH,{}),t.jsx(nv,{dataKey:"kpi"}),t.jsx(rv,{angle:90,domain:[0,100]}),t.jsx(aj,{name:"Performance",dataKey:"value",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.6}),t.jsx(pa,{})]})})})]})})]})]})]})]})}function v$e(){var S,R,D;const[e,r]=O.useState("pumps"),[n,s]=O.useState({scheme_id:"",asset_ids:[],target_volume_m3:5e3,objective:"minimize_energy_cost"}),{data:i,isLoading:l,error:d}=ct({queryKey:["schemes"],queryFn:async()=>(await xe.get("/api/v1/schemes")).data.data}),{data:a,isLoading:f}=ct({queryKey:["pumps",n.scheme_id],queryFn:async()=>n.scheme_id?(await xe.get(`/api/v1/assets?scheme_id=${n.scheme_id}&kind=pump`)).data.data:[],enabled:!!n.scheme_id}),{data:p,isLoading:y,error:v,refetch:j}=ct({queryKey:["optim-runs",e],queryFn:async()=>(await xe.get(`/api/v1/dsa/optimize?type=${e}`)).data.data}),w=Nt({mutationFn:async T=>{const I=`/api/v1/dsa/optimize/${e}`;return(await xe.post(I,T)).data},onSuccess:()=>{Ge.success("Optimization started successfully"),j()},onError:()=>{Ge.error("Failed to start optimization")}}),k=Nt({mutationFn:async T=>(await xe.post(`/api/v1/dsa/optimize/${T}/publish`)).data,onSuccess:()=>{Ge.success("Plan published to CoreOps successfully"),j()},onError:()=>{Ge.error("Failed to publish plan")}});return t.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Optimization Console"}),t.jsx("p",{className:"text-muted-foreground",children:"AI-powered optimization for pumps, valves, dosing, and logistics"})]}),t.jsxs(Sn,{value:e,onValueChange:T=>r(T),children:[t.jsxs(bn,{className:"grid w-full grid-cols-4",children:[t.jsx(kt,{value:"pumps",children:"Pump Scheduling"}),t.jsx(kt,{value:"valves",children:"Valve Settings"}),t.jsx(kt,{value:"dosing",children:"Chlorine Dosing"}),t.jsx(kt,{value:"logistics",children:"Logistics"})]}),t.jsx(Dt,{value:"pumps",className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"Configuration"}),t.jsx(cr,{children:"Set optimization parameters"})]}),t.jsxs(Q,{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Me,{children:"Scheme"}),t.jsxs($t,{value:n.scheme_id,onValueChange:T=>s({...n,scheme_id:T}),children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select scheme..."})}),t.jsx(Lt,{children:i==null?void 0:i.map(T=>t.jsx(Ne,{value:T.id,children:T.name},T.id))})]})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Pumps"}),t.jsxs($t,{children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select pumps..."})}),t.jsx(Lt,{children:a==null?void 0:a.map(T=>t.jsx(Ne,{value:T.id,children:T.name},T.id))})]})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Target Volume (m)"}),t.jsx(Ve,{type:"number",value:n.target_volume_m3,onChange:T=>s({...n,target_volume_m3:parseInt(T.target.value)})})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Objective"}),t.jsxs($t,{value:n.objective,onValueChange:T=>s({...n,objective:T}),children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"minimize_energy_cost",children:"Minimize Energy Cost"}),t.jsx(Ne,{value:"minimize_peak_demand",children:"Minimize Peak Demand"}),t.jsx(Ne,{value:"maximize_storage",children:"Maximize Storage"})]})]})]}),t.jsxs(X,{className:"w-full",onClick:()=>w.mutate(n),disabled:!n.scheme_id||w.isPending,children:[t.jsx(El,{className:"h-4 w-4 mr-2"}),"Run Optimization"]})]})]}),t.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Optimization Results"})}),t.jsx(Q,{children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Run"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Savings"}),t.jsx(ce,{children:"Peak Hours Avoided"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:p==null?void 0:p.map(T=>{var I,L;return t.jsxs(ut,{children:[t.jsxs(se,{className:"font-medium",children:["#",T.id.slice(0,8)]}),t.jsx(se,{children:t.jsx(Ee,{variant:T.status==="completed"?"default":T.status==="failed"?"destructive":"secondary",children:T.status})}),t.jsx(se,{children:(I=T.kpis)!=null&&I.savings?`${T.kpis.savings.toFixed(0)}%`:"-"}),t.jsx(se,{children:((L=T.kpis)==null?void 0:L.peak_hours_avoided)||"-"}),t.jsx(se,{children:t.jsxs(X,{size:"sm",variant:"ghost",onClick:()=>k.mutate(T.id),disabled:T.status!=="completed",children:[t.jsx(iI,{className:"h-4 w-4 mr-1"}),"Publish"]})})]},T.id)})})]})})]}),((S=p==null?void 0:p[0])==null?void 0:S.status)==="completed"&&((R=p[0].outputs)==null?void 0:R.windows)&&t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Optimized Schedule (Gantt)"})}),t.jsx(Q,{children:t.jsx("div",{className:"space-y-2",children:p[0].outputs.windows.map((T,I)=>t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"w-20 text-sm",children:[T.start_hour,":00"]}),t.jsxs("div",{className:"h-8 bg-blue-500 rounded flex items-center px-2 text-white text-sm",style:{width:`${T.duration_hours/24*100}%`},children:[T.duration_hours,"h"]}),t.jsxs("div",{className:"text-sm text-muted-foreground",children:[T.volume_m3.toFixed(0)," m"]})]},I))})})]}),((D=p==null?void 0:p[0])==null?void 0:D.status)==="completed"&&p[0].kpis&&t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Xa,{className:"h-5 w-5 text-green-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Cost Savings"}),t.jsxs("p",{className:"text-2xl font-bold",children:[p[0].kpis.savings.toFixed(0),"%"]})]})]})})}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Xs,{className:"h-5 w-5 text-blue-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Peak Hours Avoided"}),t.jsx("p",{className:"text-2xl font-bold",children:p[0].kpis.peak_hours_avoided})]})]})})}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Si,{className:"h-5 w-5 text-yellow-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Efficiency"}),t.jsxs("p",{className:"text-2xl font-bold",children:[p[0].kpis.efficiency.toFixed(0),"%"]})]})]})})})]})]})]})}),t.jsx(Dt,{value:"valves",children:t.jsx(H,{children:t.jsx(Q,{className:"py-12 text-center text-muted-foreground",children:"Valve optimization configuration coming soon"})})}),t.jsx(Dt,{value:"dosing",children:t.jsx(H,{children:t.jsx(Q,{className:"py-12 text-center text-muted-foreground",children:"Chlorine dosing optimization configuration coming soon"})})}),t.jsx(Dt,{value:"logistics",children:t.jsx(H,{children:t.jsx(Q,{className:"py-12 text-center text-muted-foreground",children:"Logistics routing optimization configuration coming soon"})})})]})]})}function _$e(){var R,D;const[e,r]=O.useState({signal:"all",scheme_id:"",score_min:.5,status:"new"}),[n,s]=O.useState(new Set),[i,l]=O.useState(null),{data:d,isLoading:a,error:f,refetch:p}=ct({queryKey:["anomalies",e],queryFn:async()=>{const T=new URLSearchParams;return e.signal!=="all"&&T.append("signal",e.signal),e.scheme_id&&T.append("scheme_id",e.scheme_id),T.append("score_min",e.score_min.toString()),e.status!=="all"&&T.append("status",e.status),(await xe.get(`/api/v1/dsa/anomalies?${T}`)).data.data}}),y=Nt({mutationFn:async({ids:T,status:I})=>(await xe.post("/api/v1/dsa/anomalies/bulk-update",{ids:T,status:I})).data,onSuccess:()=>{Ge.success("Anomalies updated successfully"),s(new Set),p()}}),v=Nt({mutationFn:async T=>(await xe.post(`/api/v1/dsa/anomalies/${T}/create-work-order`)).data,onSuccess:()=>{Ge.success("Work order created successfully"),p()}}),j=T=>{const I=new Set(n);I.has(T)?I.delete(T):I.add(T),s(I)},w=T=>{y.mutate({ids:Array.from(n),status:T})},k=d==null?void 0:d.find(T=>T.id===i),S=k?[{ts:"00:00",value:120,threshold:150},{ts:"04:00",value:125,threshold:150},{ts:"08:00",value:280,threshold:150},{ts:"12:00",value:130,threshold:150},{ts:"16:00",value:135,threshold:150},{ts:"20:00",value:128,threshold:150}]:[];return t.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Anomalies Inbox"}),t.jsx("p",{className:"text-muted-foreground",children:"ML-powered anomaly detection and triage"})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Filters"})}),t.jsx(Q,{children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs($t,{value:e.signal,onValueChange:T=>r({...e,signal:T}),children:[t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Signal type..."})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All Signals"}),t.jsx(Ne,{value:"flow",children:"Flow"}),t.jsx(Ne,{value:"pressure",children:"Pressure"}),t.jsx(Ne,{value:"consumption",children:"Consumption"}),t.jsx(Ne,{value:"quality",children:"Quality"})]})]}),t.jsxs($t,{value:e.status,onValueChange:T=>r({...e,status:T}),children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"all",children:"All Status"}),t.jsx(Ne,{value:"new",children:"New"}),t.jsx(Ne,{value:"acknowledged",children:"Acknowledged"}),t.jsx(Ne,{value:"investigating",children:"Investigating"}),t.jsx(Ne,{value:"resolved",children:"Resolved"}),t.jsx(Ne,{value:"false_positive",children:"False Positive"})]})]}),t.jsx(Ve,{type:"number",placeholder:"Min score (0-1)",value:e.score_min,onChange:T=>r({...e,score_min:parseFloat(T.target.value)}),step:"0.1",min:"0",max:"1"}),n.size>0&&t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(X,{size:"sm",variant:"outline",onClick:()=>w("acknowledged"),children:["Acknowledge (",n.size,")"]}),t.jsx(X,{size:"sm",variant:"outline",onClick:()=>w("false_positive"),children:"Mark False"})]})]})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Detected Anomalies"})}),t.jsx(Q,{children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{className:"w-12"}),t.jsx(ce,{children:"Timestamp"}),t.jsx(ce,{children:"Signal"}),t.jsx(ce,{children:"Score"}),t.jsx(ce,{children:"Pattern"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:d==null?void 0:d.map(T=>t.jsxs(ut,{className:i===T.id?"bg-muted":"",onClick:()=>l(T.id),children:[t.jsx(se,{children:t.jsx(Nm,{checked:n.has(T.id),onCheckedChange:()=>j(T.id),onClick:I=>I.stopPropagation()})}),t.jsx(se,{className:"text-sm",children:new Date(T.ts).toLocaleString()}),t.jsx(se,{children:t.jsx(Ee,{variant:"outline",children:T.signal})}),t.jsx(se,{children:t.jsx(Ee,{variant:T.score>.8?"destructive":T.score>.6?"default":"secondary",children:T.score.toFixed(2)})}),t.jsx(se,{className:"text-sm",children:T.pattern}),t.jsx(se,{children:t.jsx(X,{size:"sm",variant:"ghost",onClick:I=>{I.stopPropagation(),v.mutate(T.id)},children:t.jsx(Jf,{className:"h-4 w-4"})})})]},T.id))})]})})]}),t.jsx("div",{className:"space-y-6",children:k&&t.jsxs(t.Fragment,{children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Signal Explorer"})}),t.jsx(Q,{children:t.jsx("div",{className:"h-[300px]",children:t.jsx(Za,{width:"100%",height:"100%",children:t.jsxs(lj,{data:S,children:[t.jsx(Io,{strokeDasharray:"3 3"}),t.jsx(xa,{dataKey:"ts"}),t.jsx(Bi,{}),t.jsx(Gs,{}),t.jsx(EP,{y:150,stroke:"red",strokeDasharray:"3 3",label:"Threshold"}),t.jsx(al,{type:"monotone",dataKey:"value",stroke:"#3b82f6",strokeWidth:2})]})})})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Triage Information"})}),t.jsxs(Q,{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(an,{className:"h-5 w-5 text-orange-500 mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:"Suspected Cause"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:((R=k.triage)==null?void 0:R.suspected_cause)||"Analyzing..."})]})]}),t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(bu,{className:"h-5 w-5 text-green-500 mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:"Suggested Action"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:((D=k.triage)==null?void 0:D.suggested_action)||"No recommendation"})]})]}),t.jsxs("div",{className:"flex gap-2 pt-4",children:[t.jsx(X,{size:"sm",variant:"outline",onClick:()=>y.mutate({ids:[k.id],status:"acknowledged"}),children:"Acknowledge"}),t.jsx(X,{size:"sm",onClick:()=>v.mutate(k.id),children:"Create Work Order"})]})]})]})]})})]})]})}function b$e(){var S,R;const[e,r]=O.useState(""),[n,s]=O.useState(""),{data:i,isLoading:l,error:d}=ct({queryKey:["schemes"],queryFn:async()=>(await xe.get("/api/v1/schemes")).data.data}),{data:a,isLoading:f,error:p}=ct({queryKey:["hydro-kpis",e],queryFn:async()=>{const D=e?`?scheme_id=${e}`:"";return(await xe.get(`/api/v1/dsa/hydro/aquifers${D}`)).data.data}}),{data:y,isLoading:v}=ct({queryKey:["wellfield",e,n],queryFn:async()=>{const D=new URLSearchParams;return e&&D.append("scheme_id",e),n&&D.append("aquifer",n),(await xe.get(`/api/v1/dsa/hydro/wellfield?${D}`)).data.data},enabled:!!e}),j=[{month:"Jan",recharge:45,abstraction:3200,storage:75},{month:"Feb",recharge:52,abstraction:3150,storage:78},{month:"Mar",recharge:38,abstraction:3300,storage:72},{month:"Apr",recharge:25,abstraction:3450,storage:65},{month:"May",recharge:15,abstraction:3600,storage:58},{month:"Jun",recharge:8,abstraction:3700,storage:52}],w=a==null?void 0:a[0],k=D=>D<.3?t.jsx(Ee,{variant:"default",children:"Low Risk"}):D<.6?t.jsx(Ee,{variant:"secondary",children:"Medium Risk"}):t.jsx(Ee,{variant:"destructive",children:"High Risk"});return t.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Aquifer Dashboard"}),t.jsx("p",{className:"text-muted-foreground",children:"Hydrogeological analytics and groundwater monitoring"})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs($t,{value:e,onValueChange:r,children:[t.jsx(Rt,{className:"w-[250px]",children:t.jsx(Bt,{placeholder:"Select scheme..."})}),t.jsx(Lt,{children:i==null?void 0:i.map(D=>t.jsx(Ne,{value:D.id,children:D.name},D.id))})]}),t.jsxs($t,{value:n,onValueChange:s,children:[t.jsx(Rt,{className:"w-[250px]",children:t.jsx(Bt,{placeholder:"Select aquifer..."})}),t.jsx(Lt,{children:a==null?void 0:a.map(D=>t.jsx(Ne,{value:D.aquifer_name,children:D.aquifer_name},D.aquifer_name))})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(gc,{className:"h-8 w-8 text-blue-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Recharge"}),t.jsxs("p",{className:"text-2xl font-bold",children:[((S=w==null?void 0:w.recharge_mm)==null?void 0:S.toFixed(0))||0," mm"]})]})]})})}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Xa,{className:"h-8 w-8 text-orange-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Abstraction"}),t.jsxs("p",{className:"text-2xl font-bold",children:[((R=w==null?void 0:w.abstraction_m3d)==null?void 0:R.toFixed(0))||0," m/d"]})]})]})})}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ka,{className:"h-8 w-8 text-green-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Storage Index"}),t.jsxs("p",{className:"text-2xl font-bold",children:[(((w==null?void 0:w.storage_index)||0)*100).toFixed(0),"%"]})]})]})})}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ps,{className:"h-8 w-8 text-red-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Risk Score"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("p",{className:"text-2xl font-bold",children:[(((w==null?void 0:w.risk_score)||0)*100).toFixed(0),"%"]}),w&&k(w.risk_score)]})]})]})})})]}),t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"Aquifer Balance Trends"}),t.jsx(cr,{children:"Recharge vs Abstraction over time"})]}),t.jsx(Q,{children:t.jsx("div",{className:"h-[300px]",children:t.jsx(Za,{width:"100%",height:"100%",children:t.jsxs(lZ,{data:j,children:[t.jsx(Io,{strokeDasharray:"3 3"}),t.jsx(xa,{dataKey:"month"}),t.jsx(Bi,{yAxisId:"left"}),t.jsx(Bi,{yAxisId:"right",orientation:"right"}),t.jsx(Gs,{}),t.jsx(pa,{}),t.jsx(pd,{yAxisId:"left",type:"monotone",dataKey:"recharge",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.6,name:"Recharge (mm)"}),t.jsx(al,{yAxisId:"right",type:"monotone",dataKey:"abstraction",stroke:"#ef4444",strokeWidth:2,name:"Abstraction (m/d)"})]})})})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"Wellfield Map"}),t.jsx(cr,{children:"Borehole locations and status"})]}),t.jsx(Q,{children:t.jsx("div",{className:"h-[400px] bg-muted rounded-md flex items-center justify-center",children:t.jsx("p",{className:"text-muted-foreground",children:"Map visualization placeholder"})})})]}),t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"Cross-Section Profile"}),t.jsx(cr,{children:"Groundwater levels across wellfield"})]}),t.jsx(Q,{children:t.jsx("div",{className:"h-[400px]",children:t.jsx(Za,{width:"100%",height:"100%",children:t.jsxs(lj,{data:[{well:"BH-1",wl:45,surface:100},{well:"BH-2",wl:38,surface:95},{well:"BH-3",wl:42,surface:98},{well:"BH-4",wl:35,surface:92},{well:"BH-5",wl:40,surface:97}],children:[t.jsx(Io,{strokeDasharray:"3 3"}),t.jsx(xa,{dataKey:"well"}),t.jsx(Bi,{}),t.jsx(Gs,{}),t.jsx(pa,{}),t.jsx(al,{type:"monotone",dataKey:"surface",stroke:"#94a3b8",strokeWidth:2,name:"Ground Surface"}),t.jsx(al,{type:"monotone",dataKey:"wl",stroke:"#3b82f6",strokeWidth:2,name:"Water Level"})]})})})})]})]})]})}function j$e(){const[e,r]=O.useState({name:"",scheme_id:"",lifeline_enabled:!0,fixed_charge:200,blocks:[{min:0,max:10,rate:25},{min:10,max:30,rate:50},{min:30,max:999,rate:75}],elasticity:.15}),{data:n,isLoading:s,error:i}=ct({queryKey:["schemes"],queryFn:async()=>(await xe.get("/api/v1/schemes")).data.data}),{data:l,isLoading:d,error:a,refetch:f}=ct({queryKey:["tariff-scenarios"],queryFn:async()=>(await xe.get("/api/v1/dsa/tariffs")).data.data}),p=Nt({mutationFn:async k=>(await xe.post("/api/v1/dsa/tariffs",k)).data,onSuccess:()=>{Ge.success("Tariff simulation completed"),f()},onError:()=>{Ge.error("Failed to run simulation")}}),y=(k,S,R)=>{const D=[...e.blocks];D[k]={...D[k],[S]:R},r({...e,blocks:D})},v=()=>{r({...e,blocks:[...e.blocks,{min:0,max:100,rate:50}]})},j=[{quintile:"Q1 (Poorest)",current:8,proposed:6},{quintile:"Q2",current:5,proposed:4},{quintile:"Q3",current:3,proposed:3},{quintile:"Q4",current:2,proposed:2},{quintile:"Q5 (Richest)",current:1,proposed:1.5}],w=[{category:"Residential",current:45e4,proposed:52e4},{category:"Commercial",current:28e4,proposed:295e3},{category:"Industrial",current:18e4,proposed:175e3}];return t.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Tariff Sandbox"}),t.jsx("p",{className:"text-muted-foreground",children:"Design and simulate tariff structures for equity analysis"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs(H,{className:"lg:col-span-1",children:[t.jsxs(de,{children:[t.jsx(he,{children:"Tariff Design"}),t.jsx(cr,{children:"Configure tariff structure"})]}),t.jsxs(Q,{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Me,{children:"Scenario Name"}),t.jsx(Ve,{value:e.name,onChange:k=>r({...e,name:k.target.value}),placeholder:"e.g., Pro-Poor Tariff 2025"})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Fixed Charge (KES)"}),t.jsx(Ve,{type:"number",value:e.fixed_charge,onChange:k=>r({...e,fixed_charge:parseInt(k.target.value)})})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(Me,{children:"Lifeline Tariff"}),t.jsx(pp,{checked:e.lifeline_enabled,onCheckedChange:k=>r({...e,lifeline_enabled:k})})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Block Tariff Structure"}),t.jsxs("div",{className:"space-y-3 mt-2",children:[e.blocks.map((k,S)=>t.jsxs("div",{className:"p-3 border rounded-md space-y-2",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-sm font-medium",children:["Block ",S+1]}),S>0&&t.jsx(X,{size:"sm",variant:"ghost",onClick:()=>r({...e,blocks:e.blocks.filter((R,D)=>D!==S)}),children:"Remove"})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[t.jsxs("div",{children:[t.jsx(Me,{className:"text-xs",children:"Min (m)"}),t.jsx(Ve,{type:"number",value:k.min,onChange:R=>y(S,"min",parseInt(R.target.value))})]}),t.jsxs("div",{children:[t.jsx(Me,{className:"text-xs",children:"Max (m)"}),t.jsx(Ve,{type:"number",value:k.max,onChange:R=>y(S,"max",parseInt(R.target.value))})]}),t.jsxs("div",{children:[t.jsx(Me,{className:"text-xs",children:"Rate (KES)"}),t.jsx(Ve,{type:"number",value:k.rate,onChange:R=>y(S,"rate",parseInt(R.target.value))})]})]})]},S)),t.jsx(X,{size:"sm",variant:"outline",onClick:v,className:"w-full",children:"Add Block"})]})]}),t.jsxs("div",{children:[t.jsxs(Me,{children:["Demand Elasticity: ",e.elasticity]}),t.jsx(sp,{value:[e.elasticity],onValueChange:([k])=>r({...e,elasticity:k}),min:0,max:.5,step:.05})]}),t.jsxs(X,{className:"w-full",onClick:()=>p.mutate(e),disabled:!e.name||p.isPending,children:[t.jsx(El,{className:"h-4 w-4 mr-2"}),"Run Simulation"]})]})]}),t.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Tariff Scenarios"})}),t.jsx(Q,{children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Name"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Revenue Sufficiency"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:l==null?void 0:l.map(k=>{var S;return t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:k.name}),t.jsx(se,{children:t.jsx(Ee,{variant:k.status==="approved"?"default":"secondary",children:k.status})}),t.jsx(se,{children:(S=k.results)!=null&&S.sufficiency_pct?`${k.results.sufficiency_pct.toFixed(0)}%`:"-"}),t.jsx(se,{children:t.jsx(X,{size:"sm",variant:"ghost",children:t.jsx(Ta,{className:"h-4 w-4"})})})]},k.id)})})]})})]}),t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"Affordability by Income Quintile"}),t.jsx(cr,{children:"% of household income spent on water"})]}),t.jsx(Q,{children:t.jsx("div",{className:"h-[300px]",children:t.jsx(Za,{width:"100%",height:"100%",children:t.jsxs(Ny,{data:j,children:[t.jsx(Io,{strokeDasharray:"3 3"}),t.jsx(xa,{dataKey:"quintile"}),t.jsx(Bi,{label:{value:"% of Income",angle:-90,position:"insideLeft"}}),t.jsx(Gs,{}),t.jsx(pa,{}),t.jsx(Ha,{dataKey:"current",fill:"#94a3b8",name:"Current Tariff"}),t.jsx(Ha,{dataKey:"proposed",fill:"#3b82f6",name:"Proposed Tariff"})]})})})})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Revenue Projection by Category"})}),t.jsx(Q,{children:t.jsx("div",{className:"h-[300px]",children:t.jsx(Za,{width:"100%",height:"100%",children:t.jsxs(Ny,{data:w,children:[t.jsx(Io,{strokeDasharray:"3 3"}),t.jsx(xa,{dataKey:"category"}),t.jsx(Bi,{}),t.jsx(Gs,{}),t.jsx(pa,{}),t.jsx(Ha,{dataKey:"current",fill:"#10b981",name:"Current (KES)"}),t.jsx(Ha,{dataKey:"proposed",fill:"#3b82f6",name:"Proposed (KES)"})]})})})})]})]})]})]})}function w$e(){const[e,r]=O.useState("alerts"),[n,s]=O.useState({name:"",description:"",priority:"medium",enabled:!0,signals:[{tag:"",operator:">",threshold:0}],channels:[],quiet_hours_start:null,quiet_hours_end:null}),{data:i,isLoading:l,error:d,refetch:a}=ct({queryKey:["ews-rules"],queryFn:async()=>(await xe.get("/api/v1/dsa/ews/rules")).data.data}),{data:f,isLoading:p,error:y,refetch:v}=ct({queryKey:["ews-alerts"],queryFn:async()=>(await xe.get("/api/v1/dsa/ews/alerts")).data.data}),j=Nt({mutationFn:async T=>(await xe.post("/api/v1/dsa/ews/rules",T)).data,onSuccess:()=>{Ge.success("EWS rule created successfully"),a(),s({name:"",description:"",priority:"medium",enabled:!0,signals:[{tag:"",operator:">",threshold:0}],channels:[],quiet_hours_start:null,quiet_hours_end:null})},onError:()=>{Ge.error("Failed to create EWS rule")}}),w=Nt({mutationFn:async T=>(await xe.post(`/api/v1/dsa/ews/alerts/${T}/acknowledge`)).data,onSuccess:()=>{Ge.success("Alert acknowledged"),v()}}),k=()=>{s({...n,signals:[...n.signals,{tag:"",operator:">",threshold:0}]})},S=(T,I,L)=>{const $=[...n.signals];$[T]={...$[T],[I]:L},s({...n,signals:$})},R=T=>{s({...n,signals:n.signals.filter((I,L)=>L!==T)})},D=T=>{switch(T){case"critical":return"destructive";case"high":return"default";case"medium":return"secondary";case"low":return"outline";default:return"outline"}};return t.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Early Warning System"}),t.jsx("p",{className:"text-muted-foreground",children:"Configure threshold rules and manage alerts"})]}),t.jsxs(Sn,{value:e,onValueChange:T=>r(T),children:[t.jsxs(bn,{children:[t.jsxs(kt,{value:"alerts",children:[t.jsx(z_,{className:"h-4 w-4 mr-2"}),"Alerts",f&&f.filter(T=>T.status==="new").length>0&&t.jsx(Ee,{className:"ml-2",variant:"destructive",children:f.filter(T=>T.status==="new").length})]}),t.jsx(kt,{value:"rules",children:"Rules Builder"})]}),t.jsxs(Dt,{value:"alerts",className:"space-y-6",children:[t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"Active Alerts"}),t.jsx(cr,{children:"Real-time early warning notifications"})]}),t.jsxs(Q,{children:[t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Rule"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Triggered"}),t.jsx(ce,{children:"Response Time"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:f==null?void 0:f.map(T=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:T.rule_name}),t.jsx(se,{children:t.jsx(Ee,{variant:T.status==="new"?"destructive":T.status==="acknowledged"?"secondary":T.status==="resolved"?"default":"outline",children:T.status})}),t.jsx(se,{className:"text-sm",children:new Date(T.created_at).toLocaleString()}),t.jsx(se,{children:T.response_time_minutes?t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Xs,{className:"h-4 w-4"}),t.jsxs("span",{className:"text-sm",children:[T.response_time_minutes,"m"]})]}):"-"}),t.jsx(se,{children:t.jsx(X,{size:"sm",variant:"ghost",onClick:()=>w.mutate(T.id),disabled:T.status!=="new",children:t.jsx(bu,{className:"h-4 w-4"})})})]},T.id))})]}),(!f||f.length===0)&&t.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[t.jsx(an,{className:"h-12 w-12 mx-auto mb-4 opacity-20"}),t.jsx("p",{children:"No active alerts"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"New Alerts"}),t.jsx("p",{className:"text-2xl font-bold",children:(f==null?void 0:f.filter(T=>T.status==="new").length)||0})]}),t.jsx(Ee,{variant:"destructive",className:"h-8 w-8 rounded-full flex items-center justify-center",children:"!"})]})})}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Acknowledged"}),t.jsx("p",{className:"text-2xl font-bold",children:(f==null?void 0:f.filter(T=>T.status==="acknowledged").length)||0})]}),t.jsx(Ee,{variant:"secondary",className:"h-8 w-8 rounded-full flex items-center justify-center",children:""})]})})}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Resolved"}),t.jsx("p",{className:"text-2xl font-bold",children:(f==null?void 0:f.filter(T=>T.status==="resolved").length)||0})]}),t.jsx(Ee,{variant:"default",className:"h-8 w-8 rounded-full flex items-center justify-center",children:""})]})})}),t.jsx(H,{children:t.jsx(Q,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Response"}),t.jsxs("p",{className:"text-2xl font-bold",children:[f&&f.filter(T=>T.response_time_minutes).length>0?Math.round(f.filter(T=>T.response_time_minutes).reduce((T,I)=>T+(I.response_time_minutes||0),0)/f.filter(T=>T.response_time_minutes).length):0,"m"]})]}),t.jsx(Xs,{className:"h-8 w-8 text-muted-foreground"})]})})})]})]}),t.jsx(Dt,{value:"rules",className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"Create Rule"}),t.jsx(cr,{children:"Define threshold-based alert rules"})]}),t.jsxs(Q,{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Me,{children:"Rule Name"}),t.jsx(Ve,{value:n.name,onChange:T=>s({...n,name:T.target.value}),placeholder:"e.g., Critical Pressure Drop"})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Description"}),t.jsx(ts,{value:n.description,onChange:T=>s({...n,description:T.target.value}),placeholder:"Describe when this rule should trigger..."})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Priority"}),t.jsxs($t,{value:n.priority,onValueChange:T=>s({...n,priority:T}),children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"critical",children:"Critical"}),t.jsx(Ne,{value:"high",children:"High"}),t.jsx(Ne,{value:"medium",children:"Medium"}),t.jsx(Ne,{value:"low",children:"Low"})]})]})]}),t.jsxs("div",{children:[t.jsx(Me,{children:"Signal Conditions"}),t.jsxs("div",{className:"space-y-2 mt-2",children:[n.signals.map((T,I)=>t.jsxs("div",{className:"flex gap-2 items-end",children:[t.jsx("div",{className:"flex-1",children:t.jsx(Ve,{placeholder:"Tag name",value:T.tag,onChange:L=>S(I,"tag",L.target.value)})}),t.jsxs($t,{value:T.operator,onValueChange:L=>S(I,"operator",L),children:[t.jsx(Rt,{className:"w-20",children:t.jsx(Bt,{})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:">",children:">"}),t.jsx(Ne,{value:"<",children:"<"}),t.jsx(Ne,{value:">=",children:">="}),t.jsx(Ne,{value:"<=",children:"<="}),t.jsx(Ne,{value:"=",children:"="})]})]}),t.jsx(Ve,{type:"number",className:"w-24",placeholder:"Value",value:T.threshold,onChange:L=>S(I,"threshold",parseFloat(L.target.value))}),n.signals.length>1&&t.jsx(X,{size:"sm",variant:"ghost",onClick:()=>R(I),children:t.jsx(As,{className:"h-4 w-4"})})]},I)),t.jsxs(X,{size:"sm",variant:"outline",onClick:k,className:"w-full",children:[t.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Add Signal"]})]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(Me,{children:"Enabled"}),t.jsx(pp,{checked:n.enabled,onCheckedChange:T=>s({...n,enabled:T})})]}),t.jsx(X,{className:"w-full",onClick:()=>j.mutate(n),disabled:!n.name||n.signals.length===0||j.isPending,children:"Create Rule"})]})]}),t.jsxs(H,{className:"lg:col-span-2",children:[t.jsx(de,{children:t.jsx(he,{children:"Configured Rules"})}),t.jsx(Q,{children:t.jsxs(ur,{children:[t.jsx(hr,{children:t.jsxs(ut,{children:[t.jsx(ce,{children:"Name"}),t.jsx(ce,{children:"Priority"}),t.jsx(ce,{children:"Signals"}),t.jsx(ce,{children:"Status"}),t.jsx(ce,{children:"Actions"})]})}),t.jsx(mr,{children:i==null?void 0:i.map(T=>t.jsxs(ut,{children:[t.jsx(se,{className:"font-medium",children:T.name}),t.jsx(se,{children:t.jsx(Ee,{variant:D(T.priority),children:T.priority})}),t.jsxs(se,{className:"text-sm",children:[T.signals.length," condition",T.signals.length>1?"s":""]}),t.jsx(se,{children:t.jsx(Ee,{variant:T.enabled?"default":"outline",children:T.enabled?"Active":"Disabled"})}),t.jsx(se,{children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(X,{size:"sm",variant:"ghost",children:"Edit"}),t.jsx(X,{size:"sm",variant:"ghost",children:t.jsx(As,{className:"h-4 w-4"})})]})})]},T.id))})]})})]})]})})]})]})}const N$e="http://127.0.0.1:8001/api/v1";async function Ln(e,r){try{const n=await fetch(`${N$e}${e}`,{headers:{"Content-Type":"application/json",Accept:"application/json",...r==null?void 0:r.headers},...r});if(!n.ok)throw new Error(`API error: ${n.status}`);return await n.json()}catch{return console.warn(`Laravel API unavailable (${e}), using fallback`),null}}const _g={list:e=>{const r=new URLSearchParams(e);return Ln(`/schemes${r.toString()?`?${r}`:""}`)},create:e=>Ln("/schemes",{method:"POST",body:JSON.stringify(e)}),get:e=>Ln(`/schemes/${e}`),update:(e,r)=>Ln(`/schemes/${e}`,{method:"PUT",body:JSON.stringify(r)}),delete:e=>Ln(`/schemes/${e}`,{method:"DELETE"})},G1={list:e=>{const r=new URLSearchParams(e);return Ln(`/assets${r.toString()?`?${r}`:""}`)},create:e=>Ln("/assets",{method:"POST",body:JSON.stringify(e)}),get:e=>Ln(`/assets/${e}`),update:(e,r)=>Ln(`/assets/${e}`,{method:"PUT",body:JSON.stringify(r)}),delete:e=>Ln(`/assets/${e}`,{method:"DELETE"}),getByScheme:e=>Ln(`/schemes/${e}/assets`)},rB={tags:e=>{const r=new URLSearchParams(e);return Ln(`/telemetry/tags${r.toString()?`?${r}`:""}`)},createTag:e=>Ln("/telemetry/tags",{method:"POST",body:JSON.stringify(e)}),updateTag:(e,r)=>Ln(`/telemetry/tags/${e}`,{method:"PUT",body:JSON.stringify(r)}),measurements:(e,r)=>{const n=new URLSearchParams(r),s=e?`/telemetry/tags/${e}/measurements`:"/telemetry/measurements";return Ln(`${s}${n.toString()?`?${n}`:""}`)},recordMeasurement:(e,r,n)=>Ln("/telemetry/measurements",{method:"POST",body:JSON.stringify({tag_id:e,value:r,metadata:n})}),recordBatch:e=>Ln("/telemetry/measurements/batch",{method:"POST",body:JSON.stringify({measurements:e})})},nB={list:e=>{const r=new URLSearchParams(e);return Ln(`/outages${r.toString()?`?${r}`:""}`)},create:e=>Ln("/outages",{method:"POST",body:JSON.stringify(e)}),get:e=>Ln(`/outages/${e}`),update:(e,r)=>Ln(`/outages/${e}`,{method:"PUT",body:JSON.stringify(r)}),updateState:(e,r,n)=>Ln(`/outages/${e}/state`,{method:"PATCH",body:JSON.stringify({state:r,notes:n})}),delete:e=>Ln(`/outages/${e}`,{method:"DELETE"})},sB={assetFailures:e=>{const r=new URLSearchParams(e);return Ln(`/predictions/asset-failures${r.toString()?`?${r}`:""}`)},nrwAnomalies:e=>{const r=new URLSearchParams(e);return Ln(`/predictions/nrw-anomalies${r.toString()?`?${r}`:""}`)}},iB={nodes:e=>Ln(`/topology/schemes/${e}/nodes`),createNode:(e,r)=>Ln(`/topology/schemes/${e}/nodes`,{method:"POST",body:JSON.stringify(r)}),updateNode:(e,r,n)=>Ln(`/topology/schemes/${e}/nodes/${r}`,{method:"PUT",body:JSON.stringify(n)}),edges:e=>Ln(`/topology/schemes/${e}/edges`),createEdge:(e,r)=>Ln(`/topology/schemes/${e}/edges`,{method:"POST",body:JSON.stringify(r)}),updateEdge:(e,r,n)=>Ln(`/topology/schemes/${e}/edges/${r}`,{method:"PUT",body:JSON.stringify(n)}),nodesNearby:(e,r,n,s=5)=>Ln(`/topology/schemes/${e}/nodes/nearby?lat=${r}&lon=${n}&radius_km=${s}`),pathBetweenNodes:(e,r,n)=>Ln(`/topology/schemes/${e}/path?from=${r}&to=${n}`)};let Ki=null,Ck=0;const S$e=5,P$e=3e3,t_={connect:(e,r)=>{if((Ki==null?void 0:Ki.readyState)===WebSocket.OPEN)return;const n="ws://127.0.0.1:8001".replace("http","ws")+"/telemetry";Ki=new WebSocket(n),Ki.onopen=()=>{console.log(" Telemetry WebSocket connected"),Ck=0},Ki.onmessage=s=>{try{const i=JSON.parse(s.data);e(i)}catch(i){console.error("Failed to parse WebSocket message:",i)}},Ki.onerror=s=>{console.error("WebSocket error:",s),r&&r(s)},Ki.onclose=()=>{console.warn("Telemetry WebSocket disconnected"),Ck<S$e&&(Ck++,setTimeout(()=>t_.connect(e,r),P$e))}},subscribe:e=>{(Ki==null?void 0:Ki.readyState)===WebSocket.OPEN&&Ki.send(JSON.stringify({action:"subscribe",tag_ids:e}))},unsubscribe:e=>{(Ki==null?void 0:Ki.readyState)===WebSocket.OPEN&&Ki.send(JSON.stringify({action:"unsubscribe",tag_ids:e}))},disconnect:()=>{Ki&&(Ki.close(),Ki=null)}},zP=OW,lY=O.createContext({}),Ns=({...e})=>t.jsx(lY.Provider,{value:{name:e.name},children:t.jsx(K2,{...e})}),$P=()=>{const e=O.useContext(lY),r=O.useContext(cY),{getFieldState:n,formState:s}=By(),i=n(e.name,s);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:l}=r;return{id:l,name:e.name,formItemId:`${l}-form-item`,formDescriptionId:`${l}-form-item-description`,formMessageId:`${l}-form-item-message`,...i}},cY=O.createContext({}),ds=O.forwardRef(({className:e,...r},n)=>{const s=O.useId();return t.jsx(cY.Provider,{value:{id:s},children:t.jsx("div",{ref:n,className:gr("space-y-2",e),...r})})});ds.displayName="FormItem";const us=O.forwardRef(({className:e,...r},n)=>{const{error:s,formItemId:i}=$P();return t.jsx(Me,{ref:n,className:gr(s&&"text-destructive",e),htmlFor:i,...r})});us.displayName="FormLabel";const hs=O.forwardRef(({...e},r)=>{const{error:n,formItemId:s,formDescriptionId:i,formMessageId:l}=$P();return t.jsx(yu,{ref:r,id:s,"aria-describedby":n?`${i} ${l}`:`${i}`,"aria-invalid":!!n,...e})});hs.displayName="FormControl";const C$e=O.forwardRef(({className:e,...r},n)=>{const{formDescriptionId:s}=$P();return t.jsx("p",{ref:n,id:s,className:gr("text-[0.8rem] text-muted-foreground",e),...r})});C$e.displayName="FormDescription";const ms=O.forwardRef(({className:e,children:r,...n},s)=>{const{error:i,formMessageId:l}=$P(),d=i?String((i==null?void 0:i.message)??""):r;return d?t.jsx("p",{ref:s,id:l,className:gr("text-[0.8rem] font-medium text-destructive",e),...n,children:d}):null});ms.displayName="FormMessage";const A$e=Bl({code:kn().min(1,"Code required"),name:kn().min(1,"Name required"),type:nm(["piped","handpump","borehole","spring"]),ownership:nm(["public","private","community"]),county:kn().optional(),populationServed:kn().optional().transform(e=>e?parseInt(e):void 0)});function k$e({onSubmit:e,defaultValues:r,isLoading:n}){const s=yi({resolver:Rl(A$e),defaultValues:r||{}});return t.jsx(zP,{...s,children:t.jsxs("form",{onSubmit:s.handleSubmit(e),className:"space-y-4",children:[t.jsx(Ns,{control:s.control,name:"code",render:({field:i})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Scheme Code"}),t.jsx(hs,{children:t.jsx(Ve,{placeholder:"e.g., TRK_LOD_001",...i})}),t.jsx(ms,{})]})}),t.jsx(Ns,{control:s.control,name:"name",render:({field:i})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Scheme Name"}),t.jsx(hs,{children:t.jsx(Ve,{placeholder:"e.g., Lodwar Water Supply Scheme",...i})}),t.jsx(ms,{})]})}),t.jsx(Ns,{control:s.control,name:"type",render:({field:i})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Type"}),t.jsxs($t,{onValueChange:i.onChange,defaultValue:i.value,children:[t.jsx(hs,{children:t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select type"})})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"piped",children:"Piped"}),t.jsx(Ne,{value:"handpump",children:"Hand Pump"}),t.jsx(Ne,{value:"borehole",children:"Borehole"}),t.jsx(Ne,{value:"spring",children:"Spring"})]})]}),t.jsx(ms,{})]})}),t.jsx(Ns,{control:s.control,name:"ownership",render:({field:i})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Ownership"}),t.jsxs($t,{onValueChange:i.onChange,defaultValue:i.value,children:[t.jsx(hs,{children:t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select ownership"})})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"public",children:"Public"}),t.jsx(Ne,{value:"private",children:"Private"}),t.jsx(Ne,{value:"community",children:"Community"})]})]}),t.jsx(ms,{})]})}),t.jsx(X,{type:"submit",disabled:n,children:n?"Saving...":"Save Scheme"})]})})}function T$e(){var f;const[e,r]=O.useState(!1),[n,s]=O.useState(null),{data:i,isLoading:l,refetch:d}=ct({queryKey:["schemes"],queryFn:async()=>{const p=await _g.list();return p||{data:[{id:1,code:"TRK_LOD_001",name:"Lodwar Water Supply Scheme",type:"piped",status:"active",county:"Turkana",populationServed:28e3,connections:5600}]}}}),a=async p=>{try{n?await _g.update(n,p):await _g.create(p),r(!1),s(null),d()}catch(y){console.error("Error saving scheme:",y)}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Water Schemes Registry"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage water supply schemes and infrastructure"})]}),t.jsxs(X,{onClick:()=>r(!0),className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Scheme"]})]}),(e||n)&&t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:n?"Edit Scheme":"Create New Scheme"})}),t.jsx(Q,{children:t.jsx(k$e,{onSubmit:a,isLoading:!1,defaultValues:n&&(i!=null&&i.data)?i.data.find(p=>p.id===n):void 0})})]}),l?t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading schemes..."}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:(f=i==null?void 0:i.data)==null?void 0:f.map(p=>{var y,v;return t.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsx(he,{className:"text-lg",children:p.name}),t.jsx(X,{variant:"ghost",size:"sm",onClick:()=>s(p.id),children:t.jsx(g2,{className:"h-4 w-4"})})]})}),t.jsxs(Q,{className:"space-y-2",children:[t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"font-semibold",children:"Code:"})," ",p.code]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"font-semibold",children:"Type:"})," ",p.type]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"font-semibold",children:"Status:"})," ",t.jsx(Ee,{className:p.status==="active"?"bg-green-500":"bg-gray-500",children:p.status})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"font-semibold",children:"County:"})," ",p.county]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"font-semibold",children:"Pop. Served:"})," ",(y=p.populationServed)==null?void 0:y.toLocaleString()]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"font-semibold",children:"Connections:"})," ",(v=p.connections)==null?void 0:v.toLocaleString()]})]})]},p.id)})})]})}const E$e=Bl({code:kn().min(1,"Code required"),name:kn().min(1,"Name required"),type:nm(["pump","pipe","reservoir","treatment_plant","meter","valve"]),status:nm(["operational","faulty","maintenance","decommissioned"]),condition:nm(["good","fair","poor","critical"]),schemeId:kn().min(1,"Scheme required"),latitude:kn().optional(),longitude:kn().optional(),specifications:kn().optional(),installationDate:kn().optional()});function M$e({onSubmit:e,defaultValues:r,isLoading:n,schemeOptions:s=[]}){const i=yi({resolver:Rl(E$e),defaultValues:r||{}});return t.jsx(zP,{...i,children:t.jsxs("form",{onSubmit:i.handleSubmit(e),className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(Ns,{control:i.control,name:"code",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Asset Code"}),t.jsx(hs,{children:t.jsx(Ve,{placeholder:"e.g., PUMP_001",...l})}),t.jsx(ms,{})]})}),t.jsx(Ns,{control:i.control,name:"schemeId",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Scheme"}),t.jsxs($t,{onValueChange:l.onChange,defaultValue:l.value,children:[t.jsx(hs,{children:t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select scheme"})})}),t.jsx(Lt,{children:s.map(d=>t.jsx(Ne,{value:d.id.toString(),children:d.name},d.id))})]}),t.jsx(ms,{})]})})]}),t.jsx(Ns,{control:i.control,name:"name",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Asset Name"}),t.jsx(hs,{children:t.jsx(Ve,{placeholder:"e.g., Main Pump Station",...l})}),t.jsx(ms,{})]})}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsx(Ns,{control:i.control,name:"type",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Type"}),t.jsxs($t,{onValueChange:l.onChange,defaultValue:l.value,children:[t.jsx(hs,{children:t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select type"})})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"pump",children:"Pump"}),t.jsx(Ne,{value:"pipe",children:"Pipe"}),t.jsx(Ne,{value:"reservoir",children:"Reservoir"}),t.jsx(Ne,{value:"treatment_plant",children:"Treatment Plant"}),t.jsx(Ne,{value:"meter",children:"Meter"}),t.jsx(Ne,{value:"valve",children:"Valve"})]})]}),t.jsx(ms,{})]})}),t.jsx(Ns,{control:i.control,name:"status",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Status"}),t.jsxs($t,{onValueChange:l.onChange,defaultValue:l.value,children:[t.jsx(hs,{children:t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select status"})})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"operational",children:"Operational"}),t.jsx(Ne,{value:"faulty",children:"Faulty"}),t.jsx(Ne,{value:"maintenance",children:"Maintenance"}),t.jsx(Ne,{value:"decommissioned",children:"Decommissioned"})]})]}),t.jsx(ms,{})]})}),t.jsx(Ns,{control:i.control,name:"condition",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Condition"}),t.jsxs($t,{onValueChange:l.onChange,defaultValue:l.value,children:[t.jsx(hs,{children:t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select condition"})})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"good",children:"Good"}),t.jsx(Ne,{value:"fair",children:"Fair"}),t.jsx(Ne,{value:"poor",children:"Poor"}),t.jsx(Ne,{value:"critical",children:"Critical"})]})]}),t.jsx(ms,{})]})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(Ns,{control:i.control,name:"latitude",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Latitude"}),t.jsx(hs,{children:t.jsx(Ve,{placeholder:"e.g., -0.6850",...l})}),t.jsx(ms,{})]})}),t.jsx(Ns,{control:i.control,name:"longitude",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Longitude"}),t.jsx(hs,{children:t.jsx(Ve,{placeholder:"e.g., 34.7669",...l})}),t.jsx(ms,{})]})})]}),t.jsx(Ns,{control:i.control,name:"specifications",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Specifications (JSON)"}),t.jsx(hs,{children:t.jsx(ts,{placeholder:'{"capacity": "500m3", "model": "..."}',...l})}),t.jsx(ms,{})]})}),t.jsx(X,{type:"submit",disabled:n,className:"w-full",children:n?"Saving...":"Save Asset"})]})})}function O$e(){var n,s;const{data:e}=ct({queryKey:["predictions-failures"],queryFn:sB.assetFailures,staleTime:3e5}),{data:r}=ct({queryKey:["predictions-anomalies"],queryFn:sB.nrwAnomalies,staleTime:5*60*1e3});return!(e!=null&&e.data)&&!(r!=null&&r.data)?null:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(n=e==null?void 0:e.data)==null?void 0:n.map(i=>t.jsxs(H,{className:"border-red-500/30 bg-red-500/5",children:[t.jsx(de,{children:t.jsxs(he,{className:"text-sm flex items-center gap-2",children:[t.jsx(an,{className:"h-4 w-4 text-red-500"}),"Asset Failure Risk"]})}),t.jsxs(Q,{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm font-medium",children:i.assetId}),t.jsxs(Ee,{variant:i.riskLevel==="high"?"destructive":"secondary",children:[i.failureProbability,"% risk"]})]}),t.jsxs("div",{className:"text-xs text-muted-foreground",children:["Failure in ",i.daysToFailure," days (Confidence: ",(i.confidence*100).toFixed(0),"%)"]}),t.jsx("div",{className:"text-xs",children:i.recommendedAction.replace(/_/g," ")})]})]},i.assetId)),(s=r==null?void 0:r.data)==null?void 0:s.map(i=>t.jsxs(H,{className:"border-orange-500/30 bg-orange-500/5",children:[t.jsx(de,{children:t.jsxs(he,{className:"text-sm flex items-center gap-2",children:[t.jsx(Xa,{className:"h-4 w-4 text-orange-500"}),"NRW Anomaly"]})}),t.jsxs(Q,{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm font-medium",children:i.dmaId}),t.jsxs(Ee,{className:"bg-orange-500/30 text-orange-700",children:[i.nrwPercentage,"% NRW"]})]}),t.jsxs("div",{className:"text-xs text-muted-foreground",children:["Loss: ",(i.estimatedLossMc/1e3).toFixed(1),"K m/day | Cost: ",(i.estimatedCostPerDay/1e3).toFixed(0),"K"]})]})]},i.dmaId))]})}function I$e(){var p;const[e,r]=O.useState(!1),[n,s]=O.useState(null),{data:i,refetch:l}=ct({queryKey:["assets"],queryFn:async()=>{const y=await G1.list();return y||{data:[{id:1,code:"PUMP_001",name:"Main Pump",type:"pump",status:"operational",condition:"good"},{id:2,code:"PIPE_001",name:"Primary Pipeline",type:"pipe",status:"operational",condition:"fair"},{id:3,code:"RES_001",name:"Main Reservoir",type:"reservoir",status:"operational",condition:"good"}]}}}),{data:d}=ct({queryKey:["schemes-for-assets"],queryFn:async()=>{const y=await _g.list();return y||{data:[{id:1,name:"Lodwar Water Supply Scheme"}]}}}),a=async y=>{try{n?await G1.update(n,y):await G1.create(y),r(!1),s(null),l()}catch(v){console.error("Error saving asset:",v)}},f=y=>({good:"bg-green-500",fair:"bg-yellow-500",poor:"bg-orange-500",critical:"bg-red-500"})[y]||"bg-gray-500";return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Infrastructure Assets"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage water supply assets with predictive maintenance"})]}),t.jsxs(X,{onClick:()=>r(!0),className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Asset"]})]}),t.jsxs(Sn,{defaultValue:"inventory",className:"w-full",children:[t.jsxs(bn,{children:[t.jsx(kt,{value:"inventory",children:"Inventory"}),t.jsx(kt,{value:"predictions",children:"Predictive Alerts"})]}),t.jsxs(Dt,{value:"inventory",className:"space-y-4",children:[e&&t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Create Asset"})}),t.jsx(Q,{children:t.jsx(M$e,{onSubmit:a,isLoading:!1,schemeOptions:(d==null?void 0:d.data)||[]})})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:(p=i==null?void 0:i.data)==null?void 0:p.map(y=>t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsx(he,{className:"text-lg",children:y.name}),t.jsx(Ee,{className:"text-xs",children:y.type})]})}),t.jsxs(Q,{className:"space-y-2",children:[t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"font-semibold",children:"Code:"})," ",y.code]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"font-semibold",children:"Status:"})," ",t.jsx(Ee,{className:y.status==="operational"?"bg-green-500":"bg-gray-500",children:y.status})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"font-semibold",children:"Condition:"})," ",t.jsx(Ee,{className:f(y.condition),children:y.condition})]})]})]},y.id))})]}),t.jsx(Dt,{value:"predictions",children:t.jsx(O$e,{})})]})]})}const D$e=Bl({tag:kn().min(1,"Tag name required").regex(/^[A-Z_0-9]+$/,"Use uppercase and underscores"),ioType:nm(["AI","DI","AO","DO"]),unit:kn().optional(),assetId:kn().optional(),scale:kn().optional(),thresholds:kn().optional()});function R$e({onSubmit:e,defaultValues:r,isLoading:n,assetOptions:s=[]}){const i=yi({resolver:Rl(D$e),defaultValues:{tag:"",ioType:"AI",unit:"",assetId:"",scale:"",thresholds:"",...r},mode:"onBlur"});return t.jsx(zP,{...i,children:t.jsxs("form",{onSubmit:i.handleSubmit(e),className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(Ns,{control:i.control,name:"tag",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Tag Name"}),t.jsx(hs,{children:t.jsx(Ve,{placeholder:"e.g., PUMP_001_FLOW",...l})}),t.jsx(ms,{})]})}),t.jsx(Ns,{control:i.control,name:"ioType",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"I/O Type"}),t.jsxs($t,{onValueChange:l.onChange,value:l.value||"AI",children:[t.jsx(hs,{children:t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select type"})})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"AI",children:"Analog Input"}),t.jsx(Ne,{value:"DI",children:"Digital Input"}),t.jsx(Ne,{value:"AO",children:"Analog Output"}),t.jsx(Ne,{value:"DO",children:"Digital Output"})]})]}),t.jsx(ms,{})]})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(Ns,{control:i.control,name:"unit",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Unit"}),t.jsx(hs,{children:t.jsx(Ve,{placeholder:"e.g., lpm, bar, C, m3",...l})}),t.jsx(ms,{})]})}),t.jsx(Ns,{control:i.control,name:"assetId",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Asset (Optional)"}),t.jsxs($t,{onValueChange:l.onChange,value:l.value||"",children:[t.jsx(hs,{children:t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select asset"})})}),t.jsx(Lt,{children:s&&s.length>0?s.map(d=>t.jsxs(Ne,{value:d.id.toString(),children:[d.name," (",d.code,")"]},d.id)):t.jsx(Ne,{value:"none",disabled:!0,children:"No assets available"})})]}),t.jsx(ms,{})]})})]}),t.jsx(Ns,{control:i.control,name:"scale",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Scale (JSON)"}),t.jsx(hs,{children:t.jsx(ts,{placeholder:'{"min": 0, "max": 500, "offset": 0}',className:"h-20",...l})}),t.jsx(ms,{})]})}),t.jsx(Ns,{control:i.control,name:"thresholds",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Thresholds (JSON)"}),t.jsx(hs,{children:t.jsx(ts,{placeholder:'{"critical_low": 10, "warning_low": 50, "warning_high": 450, "critical_high": 490}',className:"h-24",...l})}),t.jsx(ms,{})]})}),t.jsx(X,{type:"submit",disabled:n,className:"w-full",children:n?"Saving...":"Save Telemetry Tag"})]})})}function L$e(e=[]){const[r,n]=O.useState({}),[s,i]=O.useState(!1),[l,d]=O.useState(null),a=O.useRef(new Set),f=O.useCallback(y=>{y.type==="measurement"&&y.tag_id&&n(v=>({...v,[y.tag_id]:{tag_id:y.tag_id,tag:y.tag,value:y.value,timestamp:y.timestamp||new Date().toISOString(),unit:y.unit}}))},[]),p=O.useCallback(y=>{d(y),i(!1)},[]);return O.useEffect(()=>(t_.connect(f,p),i(!0),()=>{t_.disconnect()}),[f,p]),O.useEffect(()=>{if(!s||e.length===0)return;const y=e.filter(j=>!a.current.has(j)),v=Array.from(a.current).filter(j=>!e.includes(j));y.length>0&&(t_.subscribe(y),y.forEach(j=>a.current.add(j))),v.length>0&&(t_.unsubscribe(v),v.forEach(j=>a.current.delete(j)))},[e,s]),{measurements:r,isConnected:s,error:l}}function F$e(){var y;const[e,r]=O.useState(!1),[n,s]=O.useState([]),{data:i,refetch:l}=ct({queryKey:["telemetry-tags"],queryFn:async()=>{const v=await rB.tags();return v||{data:[{id:1,tag:"PUMP_001_FLOW",ioType:"AI",unit:"lpm",assetId:1},{id:2,tag:"RES_001_LEVEL",ioType:"AI",unit:"m3",assetId:3},{id:3,tag:"PUMP_001_STATUS",ioType:"DI",unit:"on/off",assetId:1}]}}}),{data:d}=ct({queryKey:["assets-for-telemetry"],queryFn:async()=>{const v=await G1.list();return v||{data:[{id:1,code:"PUMP_001",name:"Main Pump"},{id:3,code:"RES_001",name:"Main Reservoir"}]}}}),{measurements:a,isConnected:f}=L$e(n);O.useEffect(()=>{i!=null&&i.data&&s(i.data.map(v=>v.id))},[i==null?void 0:i.data]);const p=async v=>{try{await rB.createTag(v),r(!1),l()}catch(j){console.error("Error saving tag:",j)}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Telemetry & SCADA"}),t.jsx("p",{className:"text-muted-foreground",children:"Real-time sensor monitoring with WebSocket updates"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Si,{className:`h-4 w-4 ${f?"text-green-500":"text-red-500"}`}),t.jsx("span",{className:"text-sm",children:f?"Connected":"Disconnected"}),t.jsxs(X,{onClick:()=>r(!0),className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Sensor"]})]})]}),t.jsxs(Sn,{defaultValue:"sensors",className:"w-full",children:[t.jsxs(bn,{children:[t.jsx(kt,{value:"sensors",children:"Sensors"}),t.jsx(kt,{value:"measurements",children:"Live Measurements"})]}),t.jsxs(Dt,{value:"sensors",className:"space-y-4",children:[e&&t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Add Telemetry Sensor"})}),t.jsx(Q,{children:t.jsx(R$e,{onSubmit:p,isLoading:!1,assetOptions:(d==null?void 0:d.data)||[]})})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(y=i==null?void 0:i.data)==null?void 0:y.map(v=>t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsx(he,{className:"text-sm font-mono",children:v.tag}),t.jsx(Ee,{children:v.ioType})]})}),t.jsxs(Q,{className:"space-y-2",children:[t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"font-semibold",children:"Type:"})," ",v.ioType]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"font-semibold",children:"Unit:"})," ",v.unit||"-"]}),v.scale&&t.jsx("div",{className:"text-xs text-muted-foreground",children:"Has scaling configured"}),v.thresholds&&t.jsx("div",{className:"text-xs text-muted-foreground",children:"Alarms enabled"})]})]},v.id))})]}),t.jsxs(Dt,{value:"measurements",className:"space-y-4",children:[!f&&t.jsx("div",{className:"p-4 bg-yellow-500/10 border border-yellow-500/30 rounded text-sm text-yellow-700",children:"WebSocket disconnected - showing last recorded values"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(a).map(([v,j])=>t.jsxs(H,{className:"border-green-500/30 bg-green-500/5",children:[t.jsx(de,{children:t.jsxs(he,{className:"text-sm flex items-center gap-2",children:[t.jsx(xs,{className:"h-4 w-4 text-green-500"}),j.tag]})}),t.jsxs(Q,{className:"space-y-1",children:[t.jsxs("div",{className:"text-2xl font-bold",children:[j.value," ",j.unit||""]}),t.jsxs("div",{className:"text-xs text-muted-foreground",children:["Updated: ",new Date(j.timestamp).toLocaleTimeString()]})]})]},v))})]})]})]})}const z$e=Bl({schemeId:kn().min(1,"Scheme required"),cause:nm(["planned","fault","water_quality","power","other"]),reason:kn().min(1,"Reason required"),scheduledStart:kn().min(1,"Start date required"),scheduledEnd:kn().min(1,"End date required"),estimatedAffectedPopulation:kn().optional(),notes:kn().optional()});function $$e({onSubmit:e,defaultValues:r,isLoading:n,schemeOptions:s=[]}){const i=yi({resolver:Rl(z$e),defaultValues:r||{}});return t.jsx(zP,{...i,children:t.jsxs("form",{onSubmit:i.handleSubmit(e),className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(Ns,{control:i.control,name:"schemeId",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Water Scheme"}),t.jsxs($t,{onValueChange:l.onChange,defaultValue:l.value,children:[t.jsx(hs,{children:t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select scheme"})})}),t.jsx(Lt,{children:s.map(d=>t.jsx(Ne,{value:d.id.toString(),children:d.name},d.id))})]}),t.jsx(ms,{})]})}),t.jsx(Ns,{control:i.control,name:"cause",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Cause"}),t.jsxs($t,{onValueChange:l.onChange,defaultValue:l.value,children:[t.jsx(hs,{children:t.jsx(Rt,{children:t.jsx(Bt,{placeholder:"Select cause"})})}),t.jsxs(Lt,{children:[t.jsx(Ne,{value:"planned",children:"Planned Maintenance"}),t.jsx(Ne,{value:"fault",children:"Equipment Fault"}),t.jsx(Ne,{value:"water_quality",children:"Water Quality Issue"}),t.jsx(Ne,{value:"power",children:"Power Outage"}),t.jsx(Ne,{value:"other",children:"Other"})]})]}),t.jsx(ms,{})]})})]}),t.jsx(Ns,{control:i.control,name:"reason",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Detailed Reason"}),t.jsx(hs,{children:t.jsx(ts,{placeholder:"e.g., Annual pump maintenance and system cleaning",...l})}),t.jsx(ms,{})]})}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(Ns,{control:i.control,name:"scheduledStart",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Scheduled Start"}),t.jsx(hs,{children:t.jsx(Ve,{type:"datetime-local",...l})}),t.jsx(ms,{})]})}),t.jsx(Ns,{control:i.control,name:"scheduledEnd",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Scheduled End"}),t.jsx(hs,{children:t.jsx(Ve,{type:"datetime-local",...l})}),t.jsx(ms,{})]})})]}),t.jsx(Ns,{control:i.control,name:"estimatedAffectedPopulation",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Estimated Affected Population"}),t.jsx(hs,{children:t.jsx(Ve,{type:"number",placeholder:"e.g., 25000",...l})}),t.jsx(ms,{})]})}),t.jsx(Ns,{control:i.control,name:"notes",render:({field:l})=>t.jsxs(ds,{children:[t.jsx(us,{children:"Internal Notes"}),t.jsx(hs,{children:t.jsx(ts,{placeholder:"Additional information for staff...",...l})}),t.jsx(ms,{})]})}),t.jsx(X,{type:"submit",disabled:n,className:"w-full",children:n?"Planning Outage...":"Plan Outage"})]})})}const Ak={draft:"bg-gray-500",approved:"bg-blue-500",live:"bg-red-500",restored:"bg-green-500",closed:"bg-gray-600"};function B$e(){var d;const[e,r]=O.useState(!1),{data:n,refetch:s}=ct({queryKey:["outages"],queryFn:async()=>{const a=await nB.list();return a||{data:[{id:1,schemeId:1,cause:"planned",state:"draft",reason:"Pump maintenance",estimatedAffectedPopulation:8900},{id:2,schemeId:1,cause:"fault",state:"live",reason:"Power outage",estimatedAffectedPopulation:4500}]}}}),{data:i}=ct({queryKey:["schemes-for-outages"],queryFn:async()=>{const a=await _g.list();return a||{data:[{id:1,name:"Lodwar Water Supply Scheme"}]}}}),l=async a=>{try{await nB.create(a),r(!1),s()}catch(f){console.error("Error planning outage:",f)}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Outage Planner"}),t.jsx("p",{className:"text-muted-foreground",children:"Plan and manage service interruptions"})]}),t.jsxs(X,{onClick:()=>r(!0),className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"Plan Outage"]})]}),e&&t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Plan Service Outage"})}),t.jsx(Q,{children:t.jsx($$e,{onSubmit:l,isLoading:!1,schemeOptions:(i==null?void 0:i.data)||[]})})]}),t.jsx("div",{className:"space-y-4",children:(d=n==null?void 0:n.data)==null?void 0:d.map(a=>{var f,p,y;return t.jsxs(H,{className:"border-l-4",style:{borderLeftColor:(f=Ak[a.state])!=null&&f.split("-")[1]?"#"+Ak[a.state]:"#gray"},children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsx("div",{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(an,{className:"h-5 w-5"}),a.reason]})}),t.jsx(Ee,{className:Ak[a.state]||"bg-gray-500",children:a.state})]})}),t.jsxs(Q,{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-muted-foreground",children:"Cause"}),t.jsx("div",{className:"font-semibold text-sm",children:(p=a.cause)==null?void 0:p.replace(/_/g," ")})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-muted-foreground",children:"Affected Population"}),t.jsx("div",{className:"font-semibold text-sm",children:(y=a.estimatedAffectedPopulation)==null?void 0:y.toLocaleString()})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-muted-foreground",children:"Scheduled Start"}),t.jsx("div",{className:"font-semibold text-sm",children:a.scheduledStart?new Date(a.scheduledStart).toLocaleDateString():"-"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-muted-foreground",children:"Scheduled End"}),t.jsx("div",{className:"font-semibold text-sm",children:a.scheduledEnd?new Date(a.scheduledEnd).toLocaleDateString():"-"})]})]}),a.notes&&t.jsx("div",{className:"text-sm text-muted-foreground border-t pt-3",children:a.notes})]})]},a.id)})})]})}function q$e({schemeId:e}){var a;const r=O.useRef(null),n=O.useRef(null),[s,i]=O.useState(null),{data:l}=ct({queryKey:["network-nodes",e],queryFn:()=>iB.nodes(e)}),{data:d}=ct({queryKey:["network-edges",e],queryFn:()=>iB.edges(e)});return O.useEffect(()=>{if(r.current)return n.current=new Pl.Map({container:r.current,style:"https://demotiles.maplibre.org/style.json",center:[34.7669,-.685],zoom:10}),n.current.on("load",()=>{n.current&&(n.current.addSource("edges",{type:"geojson",data:{type:"FeatureCollection",features:((d==null?void 0:d.data)||[]).map(f=>({type:"Feature",properties:f,geometry:{type:"LineString",coordinates:[[f.from_lon||34.7669,f.from_lat||-.685],[f.to_lon||34.7669,f.to_lat||-.685]]}}))}}),n.current.addLayer({id:"edges-layer",type:"line",source:"edges",paint:{"line-color":"#3b82f6","line-width":3,"line-opacity":.8}}),n.current.addSource("nodes",{type:"geojson",data:{type:"FeatureCollection",features:((l==null?void 0:l.data)||[]).map(f=>({type:"Feature",properties:f,geometry:{type:"Point",coordinates:[parseFloat(f.longitude)||34.7669,parseFloat(f.latitude)||-.685]}}))}}),n.current.addLayer({id:"nodes-layer",type:"circle",source:"nodes",paint:{"circle-radius":8,"circle-color":["match",["get","node_type"],"source","#3b82f6","reservoir","#06b6d4","junction","#9ca3af","treatment","#10b981","pump_station","#f97316","#999"],"circle-stroke-width":2,"circle-stroke-color":"#fff"}}),n.current.on("click","nodes-layer",f=>{var y,v;const p=(v=(y=f.features)==null?void 0:y[0])==null?void 0:v.properties;p&&i(p)}),n.current.on("mouseenter","nodes-layer",()=>{n.current&&(n.current.getCanvas().style.cursor="pointer")}),n.current.on("mouseleave","nodes-layer",()=>{n.current&&(n.current.getCanvas().style.cursor="")}))}),()=>{n.current&&n.current.remove()}},[l,d]),t.jsxs("div",{className:"space-y-4",children:[t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"text-lg flex items-center gap-2",children:[t.jsx(Ma,{className:"h-5 w-5"}),"Interactive Network Topology Map"]})}),t.jsxs(Q,{children:[t.jsx("div",{ref:r,className:"w-full h-96 rounded-lg border border-gray-700 overflow-hidden"}),t.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),t.jsx("span",{className:"text-xs",children:"Sources"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 bg-cyan-500 rounded-full"}),t.jsx("span",{className:"text-xs",children:"Reservoirs"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),t.jsx("span",{className:"text-xs",children:"Treatment"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full"}),t.jsx("span",{className:"text-xs",children:"Pumps"})]})]})]})]}),s&&t.jsxs(H,{className:"border-blue-500/30 bg-blue-500/5",children:[t.jsx(de,{children:t.jsx(he,{className:"text-sm",children:s.name||s.code})}),t.jsxs(Q,{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm",children:"Type:"}),t.jsx(Ee,{children:(a=s.node_type)==null?void 0:a.replace(/_/g," ")})]}),t.jsxs("div",{className:"text-xs text-muted-foreground",children:[t.jsxs("div",{children:["Code: ",s.code]}),s.latitude&&s.longitude&&t.jsxs("div",{children:["Location: ",s.latitude,", ",s.longitude]}),s.elevation&&t.jsxs("div",{children:["Elevation: ",s.elevation,"m"]})]})]})]})]})}function V$e(){var s;const[e,r]=O.useState(1),{data:n}=ct({queryKey:["schemes-for-map"],queryFn:async()=>{const i=await _g.list();return i||{data:[{id:1,code:"TRK_LOD_001",name:"Lodwar Water Supply Scheme"}]}}});return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Network Topology Map"}),t.jsx("p",{className:"text-muted-foreground",children:"Interactive PostGIS-based network visualization with spatial queries"})]}),t.jsxs("div",{className:"max-w-md",children:[t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Select Scheme"}),t.jsxs($t,{value:e.toString(),onValueChange:i=>r(parseInt(i)),children:[t.jsx(Rt,{children:t.jsx(Bt,{})}),t.jsx(Lt,{children:(s=n==null?void 0:n.data)==null?void 0:s.map(i=>t.jsxs(Ne,{value:i.id.toString(),children:[i.name," (",i.code,")"]},i.id))})]})]}),t.jsx(q$e,{schemeId:e})]})}function U$e(){return t.jsxs("div",{className:"flex min-h-screen",children:[t.jsx(Ia,{}),t.jsx("main",{className:"flex-1 p-8 overflow-auto",children:t.jsx(Oa,{})})]})}function W$e(){const e=[{label:"Active Risks",value:24,icon:an,color:"text-red-500"},{label:"Incidents (Open)",value:8,icon:wi,color:"text-orange-500"},{label:"Controls Effective",value:"92%",icon:bu,color:"text-green-500"},{label:"Audit Findings",value:5,icon:sd,color:"text-yellow-500"},{label:"Policies Published",value:18,icon:$n,color:"text-blue-500"},{label:"Pending Attestations",value:3,icon:Hs,color:"text-purple-500"}];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Risk, Compliance & Governance"}),t.jsx("p",{className:"text-muted-foreground",children:"Enterprise GRC oversight and management"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(r=>{const n=r.icon;return t.jsxs(H,{children:[t.jsxs(de,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(he,{className:"text-sm font-medium",children:r.label}),t.jsx(n,{className:`h-4 w-4 ${r.color}`})]}),t.jsx(Q,{children:t.jsx("div",{className:"text-2xl font-bold",children:r.value})})]},r.label)})})]})}function G$e(){const[e,r]=O.useState(!1),n=[{id:1,title:"Water Quality Contamination",category:"Operational",owner:"John Smith",likelihood:"Medium",impact:"High",residualScore:12,status:"Active"},{id:2,title:"Pump Failure",category:"Operational",owner:"Jane Doe",likelihood:"Low",impact:"High",residualScore:6,status:"Active"},{id:3,title:"Data Breach",category:"IT/Privacy",owner:"Mike Johnson",likelihood:"Low",impact:"Critical",residualScore:8,status:"Monitoring"}];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Risk Register"}),t.jsx("p",{className:"text-muted-foreground",children:"Enterprise, scheme, and process-level risks"})]}),t.jsxs(X,{onClick:()=>r(!0),className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"Register Risk"]})]}),t.jsx("div",{className:"space-y-4",children:n.map(s=>t.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(an,{className:"h-5 w-5 text-orange-500 mt-1"}),t.jsxs("div",{children:[t.jsx(he,{className:"text-lg",children:s.title}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.category})]})]}),t.jsx("span",{className:"px-2 py-1 rounded bg-blue-500/10 text-blue-600 text-xs font-medium",children:s.status})]})}),t.jsx(Q,{className:"space-y-2",children:t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-muted-foreground",children:"Owner"}),t.jsx("p",{className:"font-semibold text-sm",children:s.owner})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-muted-foreground",children:"Likelihood"}),t.jsx("p",{className:"font-semibold text-sm",children:s.likelihood})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-muted-foreground",children:"Impact"}),t.jsx("p",{className:"font-semibold text-sm",children:s.impact})]})]})})]},s.id))})]})}function K$e(){const[e,r]=O.useState(!1),n=[{id:1,title:"Water Quality Issue - High Turbidity",type:"operational",severity:"high",status:"investigating",date:"2025-11-24"},{id:2,title:"Staff Safety - Minor Cut",type:"HSE",severity:"low",status:"closed",date:"2025-11-23"},{id:3,title:"System Access Anomaly",type:"security",severity:"medium",status:"triaged",date:"2025-11-24"}],s={new:"bg-gray-500",triaged:"bg-blue-500",investigating:"bg-orange-500",actioning:"bg-yellow-500",verified:"bg-green-500",closed:"bg-gray-600"},i={low:"bg-green-500",medium:"bg-yellow-500",high:"bg-orange-500",critical:"bg-red-500"};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Incidents & Issues"}),t.jsx("p",{className:"text-muted-foreground",children:"Operational, HSE, privacy and compliance incidents"})]}),t.jsxs(X,{onClick:()=>r(!0),className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"Report Incident"]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(l=>t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{className:"text-base",children:l.title})}),t.jsxs(Q,{className:"space-y-2",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Ee,{className:i[l.severity],children:l.severity}),t.jsx(Ee,{className:s[l.status],children:l.status})]}),t.jsx("p",{className:"text-sm text-muted-foreground",children:l.date})]})]},l.id))})]})}function H$e(){const[e,r]=O.useState(!1),n=[{id:1,code:"BCP_001",process:"Water Treatment",rto:"4 hours",rpo:"1 hour",status:"Active"},{id:2,code:"BCP_002",process:"Distribution Network",rto:"8 hours",rpo:"2 hours",status:"Active"},{id:3,code:"BCP_003",process:"Customer Billing",rto:"24 hours",rpo:"4 hours",status:"Draft"}];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Business Continuity Plans"}),t.jsx("p",{className:"text-muted-foreground",children:"Continuity and emergency response planning"})]}),t.jsxs(X,{onClick:()=>r(!0),className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Plan"]})]}),t.jsx("div",{className:"space-y-3",children:n.map(s=>t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx(he,{className:"text-lg",children:s.process}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.code})]}),t.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${s.status==="Active"?"bg-green-500/10 text-green-600":"bg-yellow-500/10 text-yellow-600"}`,children:s.status})]})}),t.jsxs(Q,{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-muted-foreground",children:"RTO"}),t.jsx("p",{className:"font-semibold",children:s.rto})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-muted-foreground",children:"RPO"}),t.jsx("p",{className:"font-semibold",children:s.rpo})]})]})]},s.id))})]})}function Z$e(){const e=[{id:1,name:"WARIS Annual Report",dueDate:"2025-12-31",status:"in-draft",version:2},{id:2,name:"Asset Management Return",dueDate:"2025-11-30",status:"validation-errors",version:1},{id:3,name:"Financial Performance Report",dueDate:"2026-01-15",status:"submitted",version:1}],r={"in-draft":"bg-yellow-500","validation-errors":"bg-red-500",submitted:"bg-green-500"};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Regulatory Reporting"}),t.jsx("p",{className:"text-muted-foreground",children:"WARIS and other regulatory returns"})]}),t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Return"]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map(n=>t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs(he,{className:"text-lg flex items-center gap-2",children:[t.jsx($n,{className:"h-5 w-5"}),n.name]}),t.jsx(Ee,{className:r[n.status],children:n.status})]})}),t.jsx(Q,{children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-sm text-muted-foreground",children:["Due: ",n.dueDate]}),t.jsxs("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:["v",n.version]})]})})]},n.id))})]})}function Y$e(){const e=[{id:1,code:"POL_001",title:"Information Security Policy",status:"published",version:3,audience:"All Staff",effectiveDate:"2025-01-01"},{id:2,code:"POL_002",title:"Health & Safety Policy",status:"published",version:2,audience:"All Staff",effectiveDate:"2024-06-01"},{id:3,code:"POL_003",title:"Data Privacy & Consent Policy",status:"review",version:1,audience:"Data Handlers",effectiveDate:null}],r={published:"bg-green-500",review:"bg-yellow-500",archived:"bg-gray-500"};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Policies & SOPs"}),t.jsx("p",{className:"text-muted-foreground",children:"Policy lifecycle, attestations, and evidence"})]}),t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Policy"]})]}),t.jsx("div",{className:"space-y-3",children:e.map(n=>t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(vu,{className:"h-5 w-5 text-blue-500"}),t.jsxs("div",{children:[t.jsx(he,{className:"text-lg",children:n.title}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[n.code,"  v",n.version]})]})]}),t.jsx(Ee,{className:r[n.status],children:n.status})]})}),t.jsx(Q,{className:"text-sm",children:t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"text-muted-foreground",children:["Audience: ",n.audience]}),n.effectiveDate&&t.jsxs("span",{className:"text-muted-foreground",children:["Since: ",n.effectiveDate]})]})})]},n.id))})]})}function X$e(){const e=[{id:1,name:"Financial Controls Audit",function:"Finance",status:"in-progress",rating:null,findings:3},{id:2,name:"Water Quality Testing",function:"Operations",status:"completed",rating:"Effective",findings:1},{id:3,name:"IT Security Assessment",function:"IT",status:"planning",rating:null,findings:0}];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Internal Audit"}),t.jsx("p",{className:"text-muted-foreground",children:"Audit plans, engagements, findings and recommendations"})]}),t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"New Engagement"]})]}),t.jsx("div",{className:"space-y-3",children:e.map(r=>t.jsxs(H,{children:[t.jsx(de,{className:"pb-3",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx(he,{className:"text-lg",children:r.name}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:r.function})]}),t.jsx(Ee,{className:r.status==="completed"?"bg-green-500":r.status==="in-progress"?"bg-blue-500":"bg-gray-500",children:r.status})]})}),t.jsxs(Q,{className:"flex justify-between items-center",children:[r.rating&&t.jsx("span",{className:"font-semibold",children:r.rating}),t.jsxs("span",{className:"text-sm text-muted-foreground",children:[r.findings," finding",r.findings!==1?"s":""]})]})]},r.id))})]})}function Q$e(){const e=[{label:"LTIFR",value:"1.2",unit:"per 200k hours",trend:"down"},{label:"TRIR",value:"2.5",unit:"per 200k hours",trend:"up"},{label:"Open CAPAs",value:"5",unit:"actions",trend:"down"},{label:"Near Misses",value:"12",unit:"this quarter",trend:"up"}];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Health, Safety & Environment"}),t.jsx("p",{className:"text-muted-foreground",children:"HSE incidents, inspections, grievances and social safeguards"})]}),t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"Report Incident"]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:e.map(r=>t.jsxs(H,{children:[t.jsx(de,{className:"pb-2",children:t.jsx(he,{className:"text-sm font-medium",children:r.label})}),t.jsxs(Q,{children:[t.jsx("div",{className:"text-2xl font-bold",children:r.value}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:r.unit})]})]},r.label))}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"Recent Incidents"})}),t.jsx(Q,{children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(an,{className:"h-5 w-5 text-orange-500 mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold",children:"Minor Cut - Warehouse"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"2025-11-23  Verified"})]})]}),t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(an,{className:"h-5 w-5 text-yellow-500 mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold",children:"Near Miss - Slippery Floor"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"2025-11-22  Closed"})]})]})]})})]})]})}function J$e(){const e=[{id:1,purpose:"Customer Communication",basis:"Consent",count:2458,status:"Active"},{id:2,purpose:"Marketing",basis:"Consent",count:892,status:"Active"},{id:3,purpose:"Service Delivery",basis:"Contract",count:3205,status:"Active"}];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Data Privacy & Consent"}),t.jsx("p",{className:"text-muted-foreground",children:"Consent registry, data retention, DSAR handling, privacy incidents"})]}),t.jsxs(X,{className:"gap-2",children:[t.jsx(Ot,{className:"h-4 w-4"}),"Record Consent"]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs(H,{children:[t.jsx(de,{className:"pb-2",children:t.jsx(he,{className:"text-sm font-medium",children:"Active Consents"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-2xl font-bold",children:"6,555"})})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-2",children:t.jsx(he,{className:"text-sm font-medium",children:"Pending DSARs"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-2xl font-bold",children:"2"})})]}),t.jsxs(H,{children:[t.jsx(de,{className:"pb-2",children:t.jsx(he,{className:"text-sm font-medium",children:"Privacy Incidents"})}),t.jsx(Q,{children:t.jsx("div",{className:"text-2xl font-bold",children:"0"})})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(qh,{className:"h-5 w-5"}),"Consent By Purpose"]})}),t.jsx(Q,{className:"space-y-3",children:e.map(r=>t.jsxs("div",{className:"flex justify-between items-center pb-3 border-b last:border-0 last:pb-0",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold",children:r.purpose}),t.jsx("p",{className:"text-sm text-muted-foreground",children:r.basis})]}),t.jsx("span",{className:"text-lg font-bold",children:r.count})]},r.id))})]})]})}function e6e(){const[e,r]=O.useState([{key:"core-registry",name:"Core Registry",description:"Schemes, assets, facilities management",enabled:!0,icon:lo},{key:"core-ops",name:"Core Operations",description:"Telemetry, outages, SCADA control",enabled:!0,icon:Ka},{key:"crm",name:"CRM",description:"Customer relationship management",enabled:!0,icon:wi},{key:"cmms",name:"CMMS",description:"Asset maintenance and work orders",enabled:!0,icon:Si},{key:"water-quality",name:"Water Quality",description:"WQ parameters, sampling, compliance",enabled:!0,icon:lo},{key:"hydromet",name:"Hydromet",description:"Hydro-meteorological data",enabled:!0,icon:lo},{key:"costing",name:"Costing & Finance",description:"Budgets, allocations, cost-to-serve",enabled:!0,icon:Si},{key:"procurement",name:"Procurement",description:"RFQs, LPOs, vendor management",enabled:!0,icon:wi},{key:"projects",name:"Projects",description:"Project planning and tracking",enabled:!0,icon:Ka},{key:"community",name:"Community & Stakeholder",description:"Committees, grievances, vendors",enabled:!0,icon:wi},{key:"risk-compliance",name:"Risk, Compliance & Governance",description:"Risk register, incidents, audit",enabled:!0,icon:wi},{key:"dsa",name:"Decision Support & Analytics",description:"Forecasts, scenarios, optimization",enabled:!0,icon:Si},{key:"training",name:"Training & Knowledge",description:"Learning management, certifications",enabled:!0,icon:lo},{key:"me",name:"M&E",description:"Monitoring & evaluation, KPIs",enabled:!0,icon:Ka}]),n=i=>{r(e.map(l=>l.key===i?{...l,enabled:!l.enabled}:l))},s=e.filter(i=>i.enabled).length;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"System Settings"}),t.jsx("p",{className:"text-muted-foreground",children:"Configure and manage system modules"})]}),t.jsxs(H,{children:[t.jsxs(de,{children:[t.jsx(he,{children:"Module Management"}),t.jsx(cr,{children:"Enable or disable modules for this tenant. Disabled modules won't appear in the sidebar."})]}),t.jsxs(Q,{children:[t.jsx("div",{className:"mb-4 p-3 bg-blue-500/10 rounded-lg border border-blue-200",children:t.jsxs("p",{className:"text-sm font-medium text-blue-900",children:["Enabled: ",t.jsxs("strong",{children:[s," of ",e.length]})," modules"]})}),t.jsx("div",{className:"space-y-3",children:e.map(i=>{const l=i.icon;return t.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition",children:[t.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[t.jsx(l,{className:"h-5 w-5 text-muted-foreground mt-1"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-semibold",children:i.name}),t.jsx("p",{className:"text-sm text-muted-foreground",children:i.description})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ee,{variant:i.enabled?"default":"secondary",children:i.enabled?"Enabled":"Disabled"}),t.jsx(pp,{checked:i.enabled,onCheckedChange:()=>n(i.key)})]})]},i.key)})}),t.jsxs("div",{className:"mt-6 flex gap-2 justify-end",children:[t.jsx(X,{variant:"outline",children:"Cancel"}),t.jsx(X,{children:"Save Changes"})]})]})]}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsx(he,{children:"System Configuration"})}),t.jsx(Q,{className:"space-y-4",children:t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"p-4 border rounded-lg",children:[t.jsx("p",{className:"text-sm font-medium",children:"Multi-Tenancy"}),t.jsx("p",{className:"text-2xl font-bold mt-2",children:"Enabled"})]}),t.jsxs("div",{className:"p-4 border rounded-lg",children:[t.jsx("p",{className:"text-sm font-medium",children:"RBAC"}),t.jsx("p",{className:"text-2xl font-bold mt-2",children:"Active"})]}),t.jsxs("div",{className:"p-4 border rounded-lg",children:[t.jsx("p",{className:"text-sm font-medium",children:"Audit Logging"}),t.jsx("p",{className:"text-2xl font-bold mt-2",children:"On"})]}),t.jsxs("div",{className:"p-4 border rounded-lg",children:[t.jsx("p",{className:"text-sm font-medium",children:"API Rate Limiting"}),t.jsx("p",{className:"text-2xl font-bold mt-2",children:"1000/min"})]})]})})]})]})}function t6e(){const e=[{id:"admin",name:"Admin",description:"Full system access",color:"bg-red-500"},{id:"manager",name:"Manager",description:"Operational management",color:"bg-blue-500"},{id:"operator",name:"Operator",description:"Day-to-day operations",color:"bg-green-500"},{id:"analyst",name:"Analyst",description:"Data analysis and reporting",color:"bg-purple-500"},{id:"viewer",name:"Viewer",description:"Read-only access",color:"bg-gray-500"}],r=[{key:"core-registry",name:"Core Registry"},{key:"core-ops",name:"Core Operations"},{key:"crm",name:"CRM"},{key:"cmms",name:"CMMS"},{key:"water-quality",name:"Water Quality"},{key:"hydromet",name:"Hydromet"},{key:"costing",name:"Costing & Finance"},{key:"procurement",name:"Procurement"},{key:"projects",name:"Projects"},{key:"community",name:"Community & Stakeholder"},{key:"risk-compliance",name:"Risk, Compliance & Governance"},{key:"dsa",name:"Decision Support & Analytics"},{key:"training",name:"Training & Knowledge"},{key:"me",name:"M&E"}],[n,s]=O.useState({admin:new Set(r.map(I=>I.key)),manager:new Set(["core-registry","core-ops","crm","cmms","water-quality","projects","costing"]),operator:new Set(["core-ops","cmms","water-quality"]),analyst:new Set(["dsa","me","costing","core-registry"]),viewer:new Set(["core-registry","me","dsa"])}),i=(I,L)=>{const $=new Set(n[I]);$.has(L)?$.delete(L):$.add(L),s({...n,[I]:$})},l=(I,L)=>{var $;return(($=n[I])==null?void 0:$.has(L))||!1},d=I=>{s({...n,[I]:new Set(r.map(L=>L.key))})},a=I=>{s({...n,[I]:new Set})},f=(I,L)=>{s({...n,[L]:new Set(n[I])})},p=()=>{s({admin:new Set(r.map(I=>I.key)),manager:new Set(["core-registry","core-ops","crm","cmms","water-quality","projects","costing"]),operator:new Set(["core-ops","cmms","water-quality"]),analyst:new Set(["dsa","me","costing","core-registry"]),viewer:new Set(["core-registry","me","dsa"])})},y=O.useMemo(()=>e.map(I=>{var L,$;return{roleId:I.id,totalModules:((L=n[I.id])==null?void 0:L.size)||0,percentage:Math.round(((($=n[I.id])==null?void 0:$.size)||0)/r.length*100)}}),[n]),[v,j]=O.useState(""),[w,k]=O.useState(""),[S,R]=O.useState(""),[D,T]=O.useState("");return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Permission Matrix"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage role-based module access with bulk operations"})]}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:e.map(I=>{const L=y.find($=>$.roleId===I.id);return t.jsx(H,{children:t.jsx(Q,{className:"pt-4",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:`${I.color} text-white w-10 h-10 rounded-lg flex items-center justify-center mx-auto mb-2`,children:t.jsx(Hs,{className:"h-5 w-5"})}),t.jsx("p",{className:"text-sm font-medium",children:I.name}),t.jsx("p",{className:"text-2xl font-bold mt-1",children:L==null?void 0:L.totalModules}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[L==null?void 0:L.percentage,"% access"]})]})})},I.id)})}),t.jsxs(H,{children:[t.jsx(de,{children:t.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[t.jsxs("div",{children:[t.jsx(he,{children:"Permission Matrix"}),t.jsx(cr,{children:"Manage role-based module access. Use bulk operations for quick configuration."})]}),t.jsxs(X,{variant:"outline",size:"sm",onClick:p,children:[t.jsx(PV,{className:"h-4 w-4 mr-2"}),"Reset to Defaults"]})]})}),t.jsxs(Q,{className:"space-y-6",children:[t.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg border space-y-4",children:[t.jsxs("p",{className:"font-semibold text-sm flex items-center gap-2",children:[t.jsx(Si,{className:"h-4 w-4"}),"Quick Actions"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-medium mb-2",children:" Grant All Modules"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs($t,{value:w,onValueChange:k,children:[t.jsx(Rt,{className:"h-9",children:t.jsx(Bt,{placeholder:"Select role..."})}),t.jsx(Lt,{children:e.map(I=>t.jsx(Ne,{value:I.id,children:I.name},I.id))})]}),t.jsx(X,{size:"sm",onClick:()=>{w&&d(w)},disabled:!w,className:"w-20",children:t.jsx(_u,{className:"h-4 w-4"})})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-medium mb-2",children:" Revoke All Modules"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs($t,{value:S,onValueChange:R,children:[t.jsx(Rt,{className:"h-9",children:t.jsx(Bt,{placeholder:"Select role..."})}),t.jsx(Lt,{children:e.map(I=>t.jsx(Ne,{value:I.id,children:I.name},I.id))})]}),t.jsx(X,{size:"sm",variant:"destructive",onClick:()=>{S&&a(S)},disabled:!S,className:"w-20",children:t.jsx(bm,{className:"h-4 w-4"})})]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-medium mb-2",children:" Copy Permissions"}),t.jsxs("div",{className:"flex gap-1",children:[t.jsxs($t,{value:v,onValueChange:j,children:[t.jsx(Rt,{className:"h-9 flex-1",children:t.jsx(Bt,{placeholder:"From..."})}),t.jsx(Lt,{children:e.map(I=>t.jsx(Ne,{value:I.id,children:I.name},I.id))})]}),t.jsxs($t,{value:D,onValueChange:T,children:[t.jsx(Rt,{className:"h-9 flex-1",children:t.jsx(Bt,{placeholder:"To..."})}),t.jsx(Lt,{children:e.filter(I=>I.id!==v).map(I=>t.jsx(Ne,{value:I.id,children:I.name},I.id))})]}),t.jsx(X,{size:"sm",onClick:()=>{v&&D&&f(v,D)},disabled:!v||!D,className:"w-12",children:t.jsx(x2,{className:"h-4 w-4"})})]})]})]})]}),t.jsx("div",{className:"overflow-x-auto border rounded-lg",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-muted border-b",children:[t.jsx("th",{className:"text-left py-4 px-4 font-semibold sticky left-0 bg-muted z-10",style:{minWidth:"200px"},children:"Module"}),e.map(I=>{var L;return t.jsx("th",{className:"text-center py-4 px-3",style:{minWidth:"120px"},children:t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsx("div",{className:`${I.color} text-white px-3 py-2 rounded-md text-xs font-semibold`,children:I.name}),t.jsxs("div",{className:"text-xs text-muted-foreground",children:[(L=n[I.id])==null?void 0:L.size,"/",r.length]})]})},I.id)})]})}),t.jsx("tbody",{children:r.map((I,L)=>t.jsxs("tr",{className:L%2===0?"bg-background hover:bg-muted/30":"bg-muted/20 hover:bg-muted/50",children:[t.jsx("td",{className:"py-4 px-4 font-medium sticky left-0 z-10 bg-inherit",children:I.name}),e.map($=>t.jsx("td",{className:"text-center py-4 px-3",children:t.jsx("div",{className:"flex justify-center",children:t.jsx(Nm,{checked:l($.id,I.key),onCheckedChange:()=>i($.id,I.key),"aria-label":`Grant ${$.name} access to ${I.name}`,className:"h-5 w-5"})})},`${$.id}-${I.key}`))]},I.key))})]})}),t.jsxs("div",{className:"flex gap-2 justify-end pt-4 border-t",children:[t.jsx(X,{variant:"outline",children:"Cancel"}),t.jsxs(X,{children:[t.jsx(_u,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]})]})]}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Role Summaries"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(I=>{var L;return t.jsxs(H,{className:"hover:shadow-md transition-shadow",children:[t.jsx(de,{className:"pb-3",children:t.jsxs(he,{className:"text-base flex items-center gap-3",children:[t.jsx("div",{className:`${I.color} text-white p-2 rounded-lg`,children:t.jsx(Hs,{className:"h-4 w-4"})}),t.jsxs("div",{children:[t.jsx("p",{children:I.name}),t.jsx("p",{className:"text-xs text-muted-foreground font-normal mt-1",children:I.description})]})]})}),t.jsx(Q,{children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"bg-muted/50 p-3 rounded-md",children:[t.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"MODULES ASSIGNED"}),t.jsx("p",{className:"text-2xl font-bold",children:((L=n[I.id])==null?void 0:L.size)||0}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["of ",r.length," total"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-semibold text-muted-foreground mb-2",children:"ACCESSIBLE:"}),t.jsx("div",{className:"flex flex-wrap gap-1",children:Array.from(n[I.id]||[]).sort().map($=>r.find(W=>W.key===$)).filter(Boolean).map($=>t.jsx(Ee,{variant:"secondary",className:"text-xs",children:$==null?void 0:$.name},$==null?void 0:$.key))})]})]})})]},I.id)})})]})]})}function r6e(){return t.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:t.jsx(H,{className:"w-full max-w-md mx-4",children:t.jsxs(Q,{className:"pt-6",children:[t.jsxs("div",{className:"flex mb-4 gap-2",children:[t.jsx(ps,{className:"h-8 w-8 text-red-500"}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),t.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}function n6e(){return t.jsx(Zee,{client:mre,children:t.jsx(xre,{children:t.jsx(ire,{children:t.jsx("div",{className:"min-h-screen bg-background",children:t.jsxs(Xte,{children:[t.jsx(et,{path:"/login",element:t.jsx(Vne,{})}),t.jsx(et,{path:"/",element:t.jsx(lt,{children:t.jsx(Sa,{to:"/costing/budgets",replace:!0})})}),t.jsxs(et,{path:"/core",element:t.jsx(lt,{children:t.jsx(w5e,{})}),children:[t.jsx(et,{index:!0,element:t.jsx(Une,{})}),t.jsx(et,{path:"schemes",element:t.jsx(lt,{requiredPermission:"view schemes",children:t.jsx(T$e,{})})}),t.jsx(et,{path:"assets",element:t.jsx(lt,{requiredPermission:"view assets",children:t.jsx(I$e,{})})}),t.jsx(et,{path:"facilities",element:t.jsx(lt,{requiredPermission:"view facilities",children:t.jsx(joe,{})})}),t.jsx(et,{path:"dmas",element:t.jsx(lt,{requiredPermission:"view dmas",children:t.jsx(ice,{})})}),t.jsx(et,{path:"pipelines",element:t.jsx(lt,{requiredPermission:"view pipelines",children:t.jsx(ace,{})})}),t.jsx(et,{path:"zones",element:t.jsx(lt,{requiredPermission:"view zones",children:t.jsx(oce,{})})}),t.jsx(et,{path:"addresses",element:t.jsx(lt,{requiredPermission:"view addresses",children:t.jsx(lce,{})})}),t.jsx(et,{path:"meters",element:t.jsx(lt,{requiredPermission:"view assets",children:t.jsx(tce,{})})})]}),t.jsx(et,{path:"/gis",element:t.jsx(lt,{requiredPermission:"view gis",children:t.jsx(kde,{})})}),t.jsx(et,{path:"/gis/map",element:t.jsx(lt,{requiredPermission:"view schemes",children:t.jsx(hde,{})})}),t.jsxs(et,{path:"/cmms",element:t.jsx(lt,{children:t.jsx(Jde,{})}),children:[t.jsx(et,{index:!0,element:t.jsx(Sa,{to:"/cmms/dashboard",replace:!0})}),t.jsx(et,{path:"dashboard",element:t.jsx(lt,{requiredPermission:"view assets",children:t.jsx(eue,{})})}),t.jsx(et,{path:"assets",element:t.jsx(lt,{requiredPermission:"view assets",children:t.jsx(wue,{})})}),t.jsx(et,{path:"assets/:id",element:t.jsx(lt,{requiredPermission:"view assets",children:t.jsx(Pue,{})})}),t.jsx(et,{path:"work-orders",element:t.jsx(lt,{requiredPermission:"view work orders",children:t.jsx(Oue,{})})}),t.jsx(et,{path:"parts",element:t.jsx(lt,{requiredPermission:"view parts inventory",children:t.jsx(Due,{})})}),t.jsx(et,{path:"map",element:t.jsx(lt,{requiredPermission:"view assets",children:t.jsx(Lue,{})})}),t.jsx(et,{path:"job-plans",element:t.jsx(lt,{requiredPermission:"view assets",children:t.jsx(zue,{})})}),t.jsx(et,{path:"pm",element:t.jsx(lt,{requiredPermission:"view assets",children:t.jsx($ue,{})})}),t.jsx(et,{path:"condition-monitoring",element:t.jsx(lt,{requiredPermission:"view assets",children:t.jsx(Che,{})})}),t.jsx(et,{path:"stores",element:t.jsx(lt,{requiredPermission:"view parts inventory",children:t.jsx(The,{})})}),t.jsx(et,{path:"fleet",element:t.jsx(lt,{requiredPermission:"view assets",children:t.jsx(Ihe,{})})}),t.jsx(et,{path:"contractors",element:t.jsx(lt,{requiredPermission:"view assets",children:t.jsx(Khe,{})})}),t.jsx(et,{path:"hse",element:t.jsx(lt,{requiredPermission:"view assets",children:t.jsx(Yhe,{})})})]}),t.jsxs(et,{path:"/security",element:t.jsx(lt,{children:t.jsx(Ude,{})}),children:[t.jsx(et,{index:!0,element:t.jsx(Sa,{to:"/security/audit",replace:!0})}),t.jsx(et,{path:"audit",element:t.jsx(lt,{requiredPermission:"view audit",children:t.jsx(Wde,{})})}),t.jsx(et,{path:"alerts",element:t.jsx(lt,{requiredPermission:"view security alerts",children:t.jsx(uF,{})})}),t.jsx(et,{path:"roles",element:t.jsx(lt,{requiredPermission:"view roles",children:t.jsx(Gde,{})})}),t.jsx(et,{path:"api-keys",element:t.jsx(lt,{requiredPermission:"view api keys",children:t.jsx(hF,{})})}),t.jsx(et,{path:"dsr",element:t.jsx(lt,{requiredPermission:"view dsr requests",children:t.jsx(Kde,{})})}),t.jsx(et,{path:"consents",element:t.jsx(lt,{requiredPermission:"view consents",children:t.jsx(Hde,{})})}),t.jsx(et,{path:"kms",element:t.jsx(lt,{requiredPermission:"view kms keys",children:t.jsx(Zde,{})})}),t.jsx(et,{path:"retention",element:t.jsx(lt,{requiredPermission:"manage retention policies",children:t.jsx(Yde,{})})}),t.jsx(et,{path:"data-catalog",element:t.jsx(lt,{requiredPermission:"view data catalog",children:t.jsx(Xde,{})})}),t.jsx(et,{path:"2fa",element:t.jsx(lt,{children:t.jsx(Qde,{})})})]}),t.jsxs(et,{path:"/water-quality",element:t.jsx(lt,{children:t.jsx(Xhe,{})}),children:[t.jsx(et,{index:!0,element:t.jsx(Sa,{to:"/water-quality/parameters",replace:!0})}),t.jsx(et,{path:"parameters",element:t.jsx(lt,{requiredPermission:"view wq parameters",children:t.jsx(Jhe,{})})}),t.jsx(et,{path:"sampling-points",element:t.jsx(lt,{requiredPermission:"view wq sampling points",children:t.jsx(ome,{})})}),t.jsx(et,{path:"plans",element:t.jsx(lt,{requiredPermission:"view wq plans",children:t.jsx(cme,{})})}),t.jsx(et,{path:"samples",element:t.jsx(lt,{requiredPermission:"view wq samples",children:t.jsx(hme,{})})}),t.jsx(et,{path:"results",element:t.jsx(lt,{requiredPermission:"view wq results",children:t.jsx(fme,{})})}),t.jsx(et,{path:"compliance",element:t.jsx(lt,{requiredPermission:"view wq compliance",children:t.jsx(pme,{})})})]}),t.jsx(et,{path:"/projects",element:t.jsx(lt,{children:t.jsx(S5e,{})}),children:t.jsx(et,{index:!0,element:t.jsx(lt,{requiredPermission:"view projects",children:t.jsx(P5e,{})})})}),t.jsxs(et,{path:"/crm",element:t.jsx(lt,{children:t.jsx(xme,{})}),children:[t.jsx(et,{index:!0,element:t.jsx(Sa,{to:"/crm/customers",replace:!0})}),t.jsx(et,{path:"customers",element:t.jsx(lt,{requiredPermission:"view customers",children:t.jsx(yme,{})})}),t.jsx(et,{path:"complaints",element:t.jsx(lt,{requiredPermission:"view customers",children:t.jsx(_Le,{})})}),t.jsx(et,{path:"interactions",element:t.jsx(lt,{requiredPermission:"view customers",children:t.jsx(jLe,{})})}),t.jsx(et,{path:"segmentation",element:t.jsx(lt,{requiredPermission:"view customers",children:t.jsx(wLe,{})})}),t.jsx(et,{path:"accounts/search",element:t.jsx(lt,{requiredPermission:"view service connections",children:t.jsx(xLe,{})})}),t.jsx(et,{path:"accounts/:accountNo",element:t.jsx(lt,{requiredPermission:"view service connections",children:t.jsx(pLe,{})})}),t.jsx(et,{path:"ra",element:t.jsx(lt,{requiredPermission:"view ra cases",children:t.jsx(NLe,{})})}),t.jsx(et,{path:"dunning",element:t.jsx(lt,{requiredPermission:"view service connections",children:t.jsx(SLe,{})})}),t.jsx(et,{path:"import",element:t.jsx(lt,{requiredPermission:"manage billing",children:t.jsx(PLe,{})})})]}),t.jsxs(et,{path:"/hydromet",element:t.jsx(lt,{children:t.jsx(N5e,{})}),children:[t.jsx(et,{index:!0,element:t.jsx(Sa,{to:"/hydromet/sources",replace:!0})}),t.jsx(et,{path:"sources",element:t.jsx(lt,{requiredPermission:"view sources",children:t.jsx(t5e,{})})}),t.jsx(et,{path:"stations",element:t.jsx(lt,{requiredPermission:"view stations",children:t.jsx(s5e,{})})}),t.jsx(et,{path:"aquifers",element:t.jsx(lt,{requiredPermission:"view sources",children:t.jsx(Xze,{})})})]}),t.jsxs(et,{path:"/costing",element:t.jsx(lt,{children:t.jsx(Q6,{})}),children:[t.jsx(et,{index:!0,element:t.jsx(Sa,{to:"/costing/budgets",replace:!0})}),t.jsx(et,{path:"budgets",element:t.jsx(lt,{requiredPermission:"view budgets",children:t.jsx(u5e,{})})}),t.jsx(et,{path:"budgets/:id",element:t.jsx(lt,{requiredPermission:"view budgets",children:t.jsx(h5e,{})})}),t.jsx(et,{path:"allocations",element:t.jsx(lt,{requiredPermission:"view allocations",children:t.jsx(m5e,{})})}),t.jsx(et,{path:"cost-to-serve",element:t.jsx(lt,{requiredPermission:"view cost to serve",children:t.jsx(f5e,{})})}),t.jsx(et,{path:"gl-accounts",element:t.jsx(lt,{requiredPermission:"view budgets",children:t.jsx(p5e,{})})}),t.jsx(et,{path:"cost-centers",element:t.jsx(lt,{requiredPermission:"view budgets",children:t.jsx(x5e,{})})}),t.jsx(et,{path:"energy/tariffs",element:t.jsx(lt,{requiredPermission:"view energy tariffs",children:t.jsx(g5e,{})})}),t.jsx(et,{path:"energy/readings",element:t.jsx(lt,{requiredPermission:"upload energy readings",children:t.jsx(y5e,{})})}),t.jsx(et,{path:"energy/dashboard",element:t.jsx(lt,{requiredPermission:"view energy dashboard",children:t.jsx(v5e,{})})})]}),t.jsxs(et,{path:"/procurement",element:t.jsx(lt,{children:t.jsx(Q6,{})}),children:[t.jsx(et,{index:!0,element:t.jsx(Sa,{to:"/procurement/requisitions",replace:!0})}),t.jsx(et,{path:"requisitions",element:t.jsx(lt,{requiredPermission:"view requisitions",children:t.jsx(_5e,{})})}),t.jsx(et,{path:"rfqs",element:t.jsx(lt,{requiredPermission:"view rfqs",children:t.jsx(b5e,{})})}),t.jsx(et,{path:"lpos",element:t.jsx(lt,{requiredPermission:"view lpos",children:t.jsx(j5e,{})})})]}),t.jsxs(et,{path:"/me",element:t.jsx(lt,{children:t.jsx(k5e,{})}),children:[t.jsx(et,{index:!0,element:t.jsx(Sa,{to:"/me/kpis",replace:!0})}),t.jsx(et,{path:"kpis",element:t.jsx(lt,{children:t.jsx(eze,{})})}),t.jsx(et,{path:"coverage",element:t.jsx(lt,{children:t.jsx(tze,{})})}),t.jsx(et,{path:"nrw",element:t.jsx(lt,{children:t.jsx(rze,{})})}),t.jsx(et,{path:"cx",element:t.jsx(lt,{children:t.jsx(nze,{})})}),t.jsx(et,{path:"indicators",element:t.jsx(lt,{children:t.jsx(sze,{})})}),t.jsx(et,{path:"gender-equity",element:t.jsx(lt,{children:t.jsx(Jze,{})})})]}),t.jsxs(et,{path:"/customer",element:t.jsx(lt,{children:t.jsx(T5e,{})}),children:[t.jsx(et,{index:!0,element:t.jsx(Sa,{to:"/customer/tariffs",replace:!0})}),t.jsx(et,{path:"tariffs",element:t.jsx(lt,{children:t.jsx(ize,{})})}),t.jsx(et,{path:"billing",element:t.jsx(lt,{children:t.jsx(aze,{})})}),t.jsx(et,{path:"payments",element:t.jsx(lt,{children:t.jsx(oze,{})})}),t.jsx(et,{path:"meter-routes",element:t.jsx(lt,{children:t.jsx(lze,{})})}),t.jsx(et,{path:"tickets",element:t.jsx(lt,{children:t.jsx(cze,{})})}),t.jsx(et,{path:"kiosks",element:t.jsx(lt,{children:t.jsx(dze,{})})}),t.jsx(et,{path:"trucking",element:t.jsx(lt,{children:t.jsx(uze,{})})}),t.jsx(et,{path:"connections",element:t.jsx(lt,{children:t.jsx(hze,{})})})]}),t.jsxs(et,{path:"/community",element:t.jsx(lt,{children:t.jsx(mze,{})}),children:[t.jsx(et,{index:!0,element:t.jsx(Sa,{to:"/community/committees",replace:!0})}),t.jsx(et,{path:"committees",element:t.jsx(lt,{children:t.jsx(fze,{})})}),t.jsx(et,{path:"committees/:id",element:t.jsx(lt,{children:t.jsx(pze,{})})}),t.jsx(et,{path:"finance",element:t.jsx(lt,{children:t.jsx(xze,{})})}),t.jsx(et,{path:"vendors",element:t.jsx(lt,{children:t.jsx(gze,{})})}),t.jsx(et,{path:"bids",element:t.jsx(lt,{children:t.jsx(yze,{})})}),t.jsx(et,{path:"deliveries",element:t.jsx(lt,{children:t.jsx(vze,{})})}),t.jsx(et,{path:"stakeholders",element:t.jsx(lt,{children:t.jsx(_ze,{})})}),t.jsx(et,{path:"engagements",element:t.jsx(lt,{children:t.jsx(bze,{})})}),t.jsx(et,{path:"grm",element:t.jsx(lt,{children:t.jsx(jze,{})})}),t.jsx(et,{path:"open-data",element:t.jsx(lt,{children:t.jsx(Sze,{})})}),t.jsx(et,{path:"dataset-builder",element:t.jsx(lt,{children:t.jsx(Aze,{})})}),t.jsx(et,{path:"public-maps",element:t.jsx(lt,{children:t.jsx(Tze,{})})})]}),t.jsxs(et,{path:"/core-ops",element:t.jsx(lt,{children:t.jsx(Eze,{})}),children:[t.jsx(et,{index:!0,element:t.jsx(Sa,{to:"/core-ops/console",replace:!0})}),t.jsx(et,{path:"console",element:t.jsx(lt,{requiredPermission:"core_ops.view_operations",children:t.jsx(Mze,{})})}),t.jsx(et,{path:"topology",element:t.jsx(lt,{requiredPermission:"core_ops.view_topology",children:t.jsx(Oze,{})})}),t.jsx(et,{path:"telemetry",element:t.jsx(lt,{requiredPermission:"core_ops.view_telemetry",children:t.jsx(F$e,{})})}),t.jsx(et,{path:"network",element:t.jsx(lt,{requiredPermission:"core_ops.view_topology",children:t.jsx(V$e,{})})}),t.jsx(et,{path:"outages",element:t.jsx(lt,{requiredPermission:"core_ops.view_outages",children:t.jsx(B$e,{})})}),t.jsx(et,{path:"nrw",element:t.jsx(lt,{requiredPermission:"core_ops.view_nrw",children:t.jsx(Ize,{})})}),t.jsx(et,{path:"dosing",element:t.jsx(lt,{requiredPermission:"core_ops.view_dosing",children:t.jsx(Dze,{})})}),t.jsx(et,{path:"scheduling",element:t.jsx(lt,{requiredPermission:"core_ops.view_scheduling",children:t.jsx(Rze,{})})}),t.jsx(et,{path:"pressure-leak",element:t.jsx(lt,{requiredPermission:"core_ops.view_operations",children:t.jsx(Fze,{})})}),t.jsx(et,{path:"shifts",element:t.jsx(lt,{requiredPermission:"operations.view_shifts",children:t.jsx(zze,{})})}),t.jsx(et,{path:"events",element:t.jsx(lt,{requiredPermission:"operations.view_events",children:t.jsx($ze,{})})}),t.jsx(et,{path:"checklists",element:t.jsx(lt,{requiredPermission:"operations.view_checklists",children:t.jsx(Vze,{})})}),t.jsx(et,{path:"playbooks",element:t.jsx(lt,{requiredPermission:"operations.view_playbooks",children:t.jsx(Uze,{})})}),t.jsx(et,{path:"escalation-policies",element:t.jsx(lt,{requiredPermission:"operations.view_escalation_policies",children:t.jsx(Gze,{})})}),t.jsx(et,{path:"predictions",element:t.jsx(lt,{requiredPermission:"core_ops.view_operations",children:t.jsx(Kze,{})})}),t.jsx(et,{path:"workflows/definitions",element:t.jsx(lt,{requiredPermission:"workflows.view",children:t.jsx(Hze,{})})}),t.jsx(et,{path:"workflows/instances",element:t.jsx(lt,{requiredPermission:"workflows.view",children:t.jsx(Zze,{})})}),t.jsx(et,{path:"droughts",element:t.jsx(lt,{requiredPermission:"core_ops.view_operations",children:t.jsx(Qze,{})})})]}),t.jsxs(et,{path:"/risk-compliance",element:t.jsx(lt,{children:t.jsx(U$e,{})}),children:[t.jsx(et,{index:!0,element:t.jsx(Sa,{to:"/risk-compliance/home",replace:!0})}),t.jsx(et,{path:"home",element:t.jsx(lt,{requiredPermission:"risk.view",children:t.jsx(W$e,{})})}),t.jsx(et,{path:"risks",element:t.jsx(lt,{requiredPermission:"risk.view",children:t.jsx(G$e,{})})}),t.jsx(et,{path:"incidents",element:t.jsx(lt,{requiredPermission:"compliance.view",children:t.jsx(K$e,{})})}),t.jsx(et,{path:"bcp",element:t.jsx(lt,{requiredPermission:"compliance.view",children:t.jsx(H$e,{})})}),t.jsx(et,{path:"regulatory-reporting",element:t.jsx(lt,{requiredPermission:"compliance.view",children:t.jsx(Z$e,{})})}),t.jsx(et,{path:"policies",element:t.jsx(lt,{requiredPermission:"compliance.view",children:t.jsx(Y$e,{})})}),t.jsx(et,{path:"audit",element:t.jsx(lt,{requiredPermission:"audit.view",children:t.jsx(X$e,{})})}),t.jsx(et,{path:"hse",element:t.jsx(lt,{requiredPermission:"hse.view",children:t.jsx(Q$e,{})})}),t.jsx(et,{path:"dpo",element:t.jsx(lt,{requiredPermission:"compliance.dpo",children:t.jsx(J$e,{})})})]}),t.jsxs(et,{path:"/admin",element:t.jsx(lt,{children:t.jsx(C5e,{})}),children:[t.jsx(et,{index:!0,element:t.jsx(Sa,{to:"/admin/users",replace:!0})}),t.jsx(et,{path:"users",element:t.jsx(lt,{requiredPermission:"rbac.view",children:t.jsx(E5e,{})})}),t.jsx(et,{path:"rbac/roles",element:t.jsx(lt,{requiredPermission:"rbac.view",children:t.jsx(M5e,{})})}),t.jsx(et,{path:"rbac/matrix",element:t.jsx(lt,{requiredPermission:"rbac.view",children:t.jsx(O5e,{})})}),t.jsx(et,{path:"audit",element:t.jsx(lt,{requiredPermission:"audit.view",children:t.jsx(I5e,{})})}),t.jsx(et,{path:"security/alerts",element:t.jsx(lt,{requiredPermission:"security.view",children:t.jsx(uF,{})})}),t.jsx(et,{path:"security/api-keys",element:t.jsx(lt,{requiredPermission:"security.view",children:t.jsx(hF,{})})}),t.jsx(et,{path:"settings",element:t.jsx(lt,{requiredPermission:"settings.manage",children:t.jsx(e6e,{})})}),t.jsx(et,{path:"rbac/menu-access",element:t.jsx(lt,{requiredPermission:"rbac.manage",children:t.jsx(t6e,{})})})]}),t.jsxs(et,{path:"/integration",element:t.jsx(lt,{children:t.jsx(A5e,{})}),children:[t.jsx(et,{index:!0,element:t.jsx(Sa,{to:"/integration/api",replace:!0})}),t.jsx(et,{path:"api",element:t.jsx(lt,{requiredPermission:"integration.api.view",children:t.jsx(D5e,{})})}),t.jsx(et,{path:"mdm",element:t.jsx(lt,{requiredPermission:"integration.mdm.view",children:t.jsx(R5e,{})})}),t.jsx(et,{path:"sso",element:t.jsx(lt,{requiredPermission:"integration.sso.view",children:t.jsx(L5e,{})})}),t.jsx(et,{path:"edrms",element:t.jsx(lt,{requiredPermission:"integration.edrms.view",children:t.jsx(F5e,{})})}),t.jsx(et,{path:"dw-lineage",element:t.jsx(lt,{requiredPermission:"integration.dw.view",children:t.jsx(z5e,{})})}),t.jsx(et,{path:"notifications",element:t.jsx(lt,{requiredPermission:"integration.notifications.view",children:t.jsx(W5e,{})})}),t.jsx(et,{path:"devices",element:t.jsx(lt,{requiredPermission:"integration.devices.view",children:t.jsx(G5e,{})})}),t.jsx(et,{path:"observability",element:t.jsx(lt,{requiredPermission:"integration.observability.view",children:t.jsx(K5e,{})})}),t.jsx(et,{path:"backup-dr",element:t.jsx(lt,{requiredPermission:"integration.backup.view",children:t.jsx(H5e,{})})}),t.jsx(et,{path:"secrets",element:t.jsx(lt,{requiredPermission:"integration.secrets.view",children:t.jsx(Z5e,{})})}),t.jsx(et,{path:"connectors",element:t.jsx(lt,{requiredPermission:"integration.connectors.view",children:t.jsx(Y5e,{})})}),t.jsx(et,{path:"webhooks",element:t.jsx(lt,{requiredPermission:"integration.webhooks.view",children:t.jsx(X5e,{})})}),t.jsx(et,{path:"etl",element:t.jsx(lt,{requiredPermission:"integration.etl.view",children:t.jsx(Q5e,{})})}),t.jsx(et,{path:"comms",element:t.jsx(lt,{requiredPermission:"integration.comms.view",children:t.jsx(J5e,{})})})]}),t.jsxs(et,{path:"/training",element:t.jsx(lt,{children:t.jsx(e$e,{})}),children:[t.jsx(et,{index:!0,element:t.jsx(Sa,{to:"/training/courses",replace:!0})}),t.jsx(et,{path:"courses",element:t.jsx(n$e,{})}),t.jsx(et,{path:"my-learning",element:t.jsx(i$e,{})}),t.jsx(et,{path:"kb",element:t.jsx(l$e,{})}),t.jsx(et,{path:"sops",element:t.jsx(u$e,{})}),t.jsx(et,{path:"skills",element:t.jsx(f$e,{})}),t.jsx(et,{path:"certificates",element:t.jsx(p$e,{})}),t.jsx(et,{path:"assessments",element:t.jsx(Yze,{})})]}),t.jsxs(et,{path:"/dsa",element:t.jsx(lt,{children:t.jsx(x$e,{})}),children:[t.jsx(et,{index:!0,element:t.jsx(Sa,{to:"/dsa/forecast",replace:!0})}),t.jsx(et,{path:"forecast",element:t.jsx(lt,{requiredPermission:"dsa.view_forecast",children:t.jsx(g$e,{})})}),t.jsx(et,{path:"scenarios",element:t.jsx(lt,{requiredPermission:"dsa.view_scenarios",children:t.jsx(y$e,{})})}),t.jsx(et,{path:"optimize",element:t.jsx(lt,{requiredPermission:"dsa.view_optimization",children:t.jsx(v$e,{})})}),t.jsx(et,{path:"anomalies",element:t.jsx(lt,{requiredPermission:"dsa.view_anomalies",children:t.jsx(_$e,{})})}),t.jsx(et,{path:"aquifer",element:t.jsx(lt,{requiredPermission:"dsa.view_hydro",children:t.jsx(b$e,{})})}),t.jsx(et,{path:"tariffs",element:t.jsx(lt,{requiredPermission:"dsa.view_tariffs",children:t.jsx(j$e,{})})}),t.jsx(et,{path:"ews",element:t.jsx(lt,{requiredPermission:"dsa.view_ews",children:t.jsx(w$e,{})})})]}),t.jsx(et,{path:"*",element:t.jsx(r6e,{})})]})})})})})}Eq(document.getElementById("root")).render(t.jsx(n6e,{}));
